{
    "id": "f6579a73-63b4-4c6b-960f-ff54bd5b9971",
    "created_at": "2022-10-25T16:48:23.08292Z",
    "updated_at": "2025-03-27T02:16:25.753515Z",
    "deleted_at": null,
    "sha1_hash": "9af5be97efbcd8023c4eaf7d48cd028c09f3f30a",
    "title": "",
    "authors": "",
    "file_creation_date": "2015-10-16T17:41:20Z",
    "file_modification_date": "2015-10-16T17:41:20Z",
    "file_size": 2004099,
    "plain_text": "-----\n\nVersion Information\n\n**Version** **Date** **Description**\n**01** 2015-08-18 Initial version.\n**02** 2015-10-14 Minor editing and audience scope.\n**03** 2015-10-15 Public release.\n\nThis report was prepared by AnubisNetworks Labs.\n\n\n© AnubisNetworks, a BitSight Company\n\n\n-----\n\n# Table of Contents\n\n## Contents\nExecutive Summary .............................................................................................................. 3\n\nScope ................................................................................................................................... 4\n\nDridex Overview .................................................................................................................... 5\n\nPeer to Peer Network ............................................................................................................ 6\n\nNetwork Structure .............................................................................................................. 6\n\nNetwork Communications .................................................................................................. 7\n\nNetwork Protocols .......................................................................................................... 7\n\nCommunication Flows .................................................................................................. 11\n\nMessage Formats ........................................................................................................ 15\n\nRunning a Fake Node Inside Dridex Botnets ....................................................................... 25\n\nArchitecture ..................................................................................................................... 26\n\nDeployment ..................................................................................................................... 27\n\nCountermeasures Timeline .............................................................................................. 28\n\nResults ................................................................................................................................ 29\n\nInfection Dispersion ......................................................................................................... 29\n\nTargets ............................................................................................................................ 30\n\nStolen information ........................................................................................................... 32\n\nKeylogger data ............................................................................................................. 32\n\nWeb Inject Data ........................................................................................................... 33\n\nScreenshots ................................................................................................................. 33\n\nIndicators of Compromise ................................................................................................... 34\n\nAnalyzed Samples ........................................................................................................... 34\n\nAbout Cyberfeed ................................................................................................................. 37\n\nHow can AnubisNetworks play a role? ................................................................................ 37\n\n\n© AnubisNetworks, a BitSight Company\n\n\n-----\n\n## Executive Summary\n\nIn March 2015, AnubisNetworks Labs team started analyzing multiple malware samples of\nthe Dridex family in order to:\n\n1. Map the infections of associated botnets;\n2. Understand the complexity of its communication channels;\n3. Enumerate vulnerabilities that could be exploited.\n\nFrom our research we have concluded the following:\n\n1. Dridex deploys a hybrid peer-to-peer network with different layers in order to achieve\n\nresilience against a takedown;\n2. The Dridex ecosystem is constituted by a small number of independent botnets, that\n\nhave different geographies and financial institutions as targets;\n3. Dridex is currently being used to obtain credentials from a large number of online\n\nservices including several banking services of multiple countries;\n4. Dridex P2P network protocols have vulnerabilities that allow interception of bot\n\ncommunications, and may be used to disrupt or takeover the botnet;\n5. By reversing the Dridex communication protocols, we were able to deploy a rogue\n\nnode that can eavesdrop on botnet communications between bots and supernodes\n(admin_nodes), enumerate bots and map the infection dispersion of the botnets\n\n\n© AnubisNetworks, a BitSight Company\n\n\n-----\n\n## Scope\n\nThis paper describes in detail the communication channels of the Dridex malware once it’s\nup and running on the infected systems, namely its P2P network, encryption methods and\nassociated C2 infrastructure. Our intent is to focus on how the malware communicates with\ntheir command and control and to map possible vulnerabilities on the protocols it uses to\nsupport monitoring capabilities.\n\nThere is no intent to document its distribution mechanisms nor the behavior of the malware\non the infected systems in great detail, except for network communications and operations\nthat support those communications (e.g., encryption). Infection dispersion of the many\nbotnets associated with Dridex is also out of scope of this document.\n\nThere are no attribution indicators on this document.\n\n\n© AnubisNetworks, a BitSight Company\n\n\n-----\n\n## Dridex Overview\n\nDridex has been around since November 2014 and is an evolution of the malware families\nknown as Bugat, Geodo, Feodo and Cridex.\n\nThe malware is distributed via email, with a malicious Microsoft Word document as\nattachment, that once opened downloads a second stage payload that infects the system.\n\nPrimarily targeting home banking users, is a malware with various capabilities including man\nin the browser, keylogger, proxy and VNC. Features a peer-to-peer (P2P) network and uses\ncryptography on its communication channels.\n\nThe Dridex ecosystem is constituted by eight (8) botnets, as tagged by their operators. From\nthose botnets, the ones identified as 120, 125, 200, 220 and 320 seem to be the main\nbotnets and 121, 122 and 123 seem to be aliases for botnet 120, or at least segregated from\n120 at a logical level only, since they shared the same command and control systems.\n\nCurrently, botnets 120, 200 and 220 are the most active, with predominant infections in\nEurope, North America and Asia.\n\nDridex botmasters are very active, launching new campaigns against different geographies\nand hardening the botnet infrastructure with new countermeasures and command and\ncontrol systems.\n\nDridex 220 distribution (sampled)\n\n\n© AnubisNetworks, a BitSight Company\n\n\n-----\n\n## Peer to Peer Network\n\nThe botnet uses a hybrid P2P network to communicate. There are different types of nodes\nand different protocols that are used. This section details each of these.\n\n### Network Structure\n\nThe network has the following structure:\n\nIt is composed by the following elements:\n\n      - **bots -** Bots are the most common network element. These are the infected\n\nsystems that are not directly connected to the Internet, have firewall active or\nNAT;\n\n      - **nodes -** Nodes are infected systems that are directly connected to the\n\nInternet have no firewall and no NAT and have been successful promoted to\nthis layer;\n\n    - **admin_nodes -** Admin nodes appear to be composed by compromised\n\nservers. These act as a proxy layer between the C2 backend and Nodes;\n\n    - **servers -** Servers are the initial C2 communication point used by the\n\nmalware. These are hardcoded in the malware files and the malware\ncommunicate with them to obtain an initial list of peers;\n\n    - **c2 backend -** The command and control backend operated by the\n\nbotmasters. Notice that we have not seen this layer of the network so this\ncomponent is speculated to exist.\n\n\n© AnubisNetworks, a BitSight Company\n\n\n-----\n\n### Network Communications\n\nThe network protocols and encryption schemes have changed over time. This document\nonly covers the most recent scheme we are aware of, which has been in use since 30th April\n2015.\n\n#### Network Protocols\n\nDridex uses XML messages for communication between all of its network elements.\nHowever, these messages are wrapped in different encryption protocols that are used\ndepending on the context of the communication. The following protocols are used by Dridex\nwhen sending the XML messages:\n\n  - **Server communication protocol - Used during the infection of a system, to obtain**\n\nthe initial list of nodes in the botnet;\n\n  - **Internode communication protocol - Used when the communication does not**\n\ncontain information relevant to the C2, for instance when messages are used solely\nto maintain the structure of the network;\n\n  - **C2 communication protocol**   - Used when the message needs to reach the C2\n\nbackend, for instance when sending stolen data or requesting new commands.\n\nServer Communication Protocol\n\nThe communication to the servers is transmitted in HTTP over SSL. The body of the HTTP\nrequest contains a 4 byte XOR key and the XOR encrypted XML message. The following\nimage shows the HTTP body structure:\n\n\n© AnubisNetworks, a BitSight Company\n\n\n-----\n\n  - **XOR Key (4 bytes) - The Key used to XOR encrypt the data;**\n\n  - **XORed XMLMSG - The XML Message encrypted through XORing each 4 bytes of**\n\nthe message with the key;\n\nInternode Communication Protocol\n\nThe internode communication is transmitted directly through TCP sockets and uses the\nfollowing structure:\n\n  - **Random data (124 Bytes) - Random data generated using the Windows API**\n\nfunction CryptGenRandom;\n\n  - **Checksum (4 bytes) - A checksum result of the random data. The checksum is the**\n\nreverse of the sum of the 31 4 bytes Integer values contained in the 124 bytes of\nrandom data; The following is an example implementation in python:\n\n```\nstruct.pack(\">I\",-uint32(sum(struct.unpack('<31I',rnd1))))[::-1]\n\n```\n\n\n- **Datalen (N bytes) - The data length in a special format stored in two Signed Short**\n\nInteger (2 byte) numbers. The first short contains the reverse of the length of the data\n\n\n© AnubisNetworks, a BitSight Company\n\n\n-----\n\ndivided by 30000 and the second part contains the reverse of the remainder of the\nsame division. If the result of the division is smaller than one, a random two byte that\nresults in a negative value is used for the first short. Following is an example\nimplementation in Python:\n\n```\ndatalen=len(xoredpayload+xorkey)\nhpart=datalen/30000\nlpart=datalen%30000\nif (hpart):\n  hpartbytes=struct.pack('<h',-hpart)\nelse:\n  hpartbytes=\"\\x00\\x00\"\nif (lpart):\n  lpartbytes=struct.pack('<h',-lpart)\nelse:\n  lpartbytes=\"\\x00\\x00\"\nlenbytes=hpartbytes+lpartbytes\n\n```\n\n\n  - **XOR Key (4 bytes) - The Key used to XOR encrypt the data. This is a random 4 byte**\n\nkey obtained through the Windows API CryptGenRandom function;\n\n  - **XORed GZIPed XMLMSG - The XMLMSG to be sent to the node is compressed**\n\nusing gzip format. Each 4 bytes of the compressed data is then XORed with the XOR\nkey.\n\nC2 Communication Protocol\n\nThe C2 communication is transmitted through HTTP over SSL (the bots do not check the\nvalidity of the SSL certificate provided).\nWhenever a bot sends a message to the C2, the HTTP request contains a special header\nthat identifies the Unique ID of the requesting bot. The following is an example of the HTTP\nheader of a request sent by a bot to the C2:\n\n```\nId: ABCDEFG_12345678901234567890123456789012\n\n```\n\n© AnubisNetworks, a BitSight Company\n\n\n-----\n\nThe HTTP request body contains the XML message encrypted in the following format:\n\n  - **RSA Signature (128 bytes) - The RSA Signature of the remaining of the HTTP**\n\nrequest body using the Bot RSA Private Key that was generated locally;\n\n  - **Microsoft SimpleKey Blob Header (12 bytes) - The header of the Microsoft**\n\nSimpleKey Blob. This is part of the format that Microsoft Crypto Library uses to\nexchange encryption keys. In this case, the following bytes are used:\n\n```\nOx010200000168000000a40000\n\n```\n\n\n       - **RSA Encrypted RC4 Key (128 bytes) - A Random RC4 key is generated for each**\n\nmessage being sent and encrypted using the C2 public key that is hardcoded in the\nmalware files.\n\n       - **RC4 Encrypted Compressed XMLMSG**        - The XMLMSG to be sent to the node is\n\ncompressed using GZIP format. The compressed XML is then encrypted using the\nRC4 Key that was generated for this message;\n\n© AnubisNetworks, a BitSight Company 1\n\n\n-----\n\nInfo Protocol\n\nSome information is base64 encoded and sent inside the XML messages. This is key\ninformation (e.g. software modules, initial node list, Info XML Message contents) which is\ndouble encrypted and signed by the C2 private key. After decoding the base64, it’s contents\nare stored in the following format:\n\n       - **RSA Signature (128 Bytes) - RSA Signature of remaining payload (XOR key and**\n\nXORed payload);\n\n       - **XOR Key (4 bytes) - The key used to XOR encrypt the data, this is a random 4 byte**\n\nkey;\n\n       - **XORed GZIPed data - The data to be sent to the node is compressed using gzip**\n\nformat. Each 4 bytes of the compressed data is then XORed with the XOR key;\n\n#### Communication Flows\n\nThis section describes the typical communication flows that occur when a bot is first infected,\nwhen it tries to escalate to node and after infection while it is periodically beaconing to the\nC2.\n\n© AnubisNetworks, a BitSight Company 1\n\n\n-----\n\nJoining the Network\n\nThe following diagram shows the sequence of communications that occur during the\ninfection of a system until it has fully joined the Dridex peer to peer network.\n\nWhen a new system is infected it performs the following actions (the contents of the different\nXML messages will be detailed in the following section):\n\n1. The first stage, a malicious Microsoft Office document, downloads via a regular\n\nHTTP request the second stage malware from a compromised web server;\n2. The second stage malware connects to its hard coded servers using Dridex Server\n\nprotocol (described earlier in this document) and sends a “loader” XML message,\nrequesting the third stage malware/bot DLL and the initial list of nodes;\n3. The bot connects to one of the nodes in order, from first to last of the list, until one\n\nresponds correctly and sends a “beacon with pub key” XML Message that results in a\nresponse that contains the external IP address of the bot;\n4. The bot sends a “beacon with pub key” XML message using C2 communication\n\nprotocol that contains the IP address received from the node and the bot’s RSA\npublic key;\n\n© AnubisNetworks, a BitSight Company 1\n\n\n-----\n\n5. The bot sends a “beacon with empty hash” XML message to the C2 that shows an\n\nempty config file hash value. In response, the C2 sends the latest config file, the\ncommands it wants the bot to execute, and the most recent list of nodes;\n6. The bot sends a “beacon” XML message to the node. In response, the node replies\n\nwith a list of the available modules;\n7. The bot sends a _“beacon with get_module” XML message requesting some of the_\n\navailable modules from the C2;\n8. The bot sends a _“beacon with get_module” XML message requesting some of the_\n\navailable modules from the node;\n\nEscalate to Node\n\nOnce a bot has registered into the network (after it has successfully sent the public key to\nthe server and received a positive reply) it starts the process of elevation to node, in parallel\nwith the remaining requests related to obtaining the config file and the available modules.\nThis process will allow bots that are not behind a NAT to work as nodes in the P2P network.\nThe following diagram shows the sequence of communications that occur during the\nescalation process:\n\nThe following communications occur during this process:\n\n1. The bot sends a “checkme” XML message to three randomly selected nodes from\n\nthe node list and repeats this process until all of the nodes are tested;\n2. Each node that receives the “checkme” request will try to connect to the bot in the\n\nTCP port listed in the “checkme” XML message and send a “Ping” XML message;\n3. If the node receives a “Pong” XML message, in reply to “Ping” it will send a “beacon\n\nwith newnode” XML message to the C2 warning that a new potential node was\ndetected;\n\n© AnubisNetworks, a BitSight Company 1\n\n\n-----\n\n4. The C2 will respond with an appropriate “Info” XML message to be sent to the new\n\nnode. This message will typically contain the admin_node to be used by the new\nnode;\n\n5. The node will connect to the bot and send the “info” XML message;\n6. The bot will connect directly to the admin_node and send a _“beacon with pub key”_\n\nXML message, without IP, containing the bot’s public key;\n7. Finally, the new node will connect directly to the admin_node and send a “node\n\n_beacon” XML message to the admin containing the type node XML field;_\n\nPeriodic Checkin\n\nAfter a bot successfully registers into the network, tries to escalate to node, downloads the\nconfig file and downloads all the available modules, it periodically checkin to the C2 to:\n\n       - Send any command output results;\n\n       - Send stolen data;\n\n       - Check for updates to config files;\n\n       - Check for updates to the modules.\n\nThe following diagram shows the communications that occur periodically after the infection:\n\nOnce an infected system has registered itself as a new bot, it starts the node escalation\nprocess by performing the following actions:\n\n1. The bot sends a “beacon” XML message to the node. In reply it can receive updated\n\nIP address if the bot IP address has changed and new versions of modules; If a new\nmodule or new version is received the bot will send a message requesting the new\nmodule;\n2. The bot sends a _“beacon” XML message to the C2. This message can contain a_\n\n<data> field containing stolen data, command outputs and debugging messages. The\nreply can contain updated configuration files, additional commands, updated node\nlists or updated admin_nodes list.\n\n© AnubisNetworks, a BitSight Company 1\n\n\n-----\n\n#### Message Formats\n\nDridex uses the protocols described before to transmit and receive a set of XML messages.\nThese messages and their responses take the bots through a set of states that allow the\nbotnet to function. These messages are divided in the following categories:\n\n  - Server messages;\n\n  - Node messages;\n\n  - C2 messages.\n\nMost of these messages share a set of common attributes. The most relevant are:\n\n  - **unique: The bot unique ID, built from the computer name and a hash based on a**\n\nregistry key value, with the following format: <PC-NAME>_<md5 hash>;\n\n  - **botnet: The botnet where the bot belongs to. Each botnet is a separated Dridex P2P**\n\nnetwork with separate configs, modules, bots, nodes and admin nodes.\n\n  - **version: The software version of the bot module;**\n\n  - **system: The operating system version;**\n\n  - **type: The role of the infected system (bot or node).**\n\nServer Messages\n\nThe following messages are sent between the second stage component of a Dridex install\nand one or more of its hardcoded servers. These will use the Server communication\nprotocol, described earlier in this document, for encryption and transmission.\n\n**Loader**\n\nWhen the second stage malware is loaded into the system it connects to a list of hardcoded\nIP addresses (servers) and downloads the bot and the node list.\n\nFollowing are the examples of the request and response:\n\n```\nREQUEST\n\n```\n```\n<loader><get_module unique=\"ABCDEFG_12345678901234567890123456789012\" botnet=\"200\"\nsystem=\"56384\" name=\"bot\" bit=\"32\"/><soft><![CDATA[]]></soft></loader>\n\n```\n```\nRESPONSE\n\n```\n```\n     <root><nodes>T8JR2C+UMVGlsgJ2SRVSz2FgrzM2WMfGK3hR1RiZCs4WsX2+kZtgOC4OHPfIooR9l/mJWW\n     iFeSZDCPB/zrIX5Bw+Y47mhGm8wrSoY5m5BMFzaKevVKkE8rSATmGuNPjAT/vXUAOaz2a91pwYbSxSreap/\n     YF8Ippz3V+TFxl6tcxKIV2qVapVqlWpGCUepFebWel6Lmln8jlB/yawjfhcEuqaTLx5GJ0ZRo2mE4NRzSUg\n     EeqkigvPOjR6c305PVkCxODSXndpHIoUIYyVRWSwvd3JcRI+fT8ZlpDXMS+BRT5XGGLiEw8lfMzBm5BofPW\n\n```\n© AnubisNetworks, a BitSight Company 1\n\n\n-----\n\n```\nETeDw2Ci6hUmjWZlHadA7X5etcVN1dJyqVao=</nodes><module name=\"bot\"\nbit=\"32\">iMAlP+gf5ujehA6EsHVySqflek7YqX3+QCR6xcDb1LPgus4jXEhmT0Z21y2uLLginEA8gKBFFr\nGdXDTSnz3F/qZc0oV2lhf3ul4pb5HVe0spkF0FGohUnvwxXTPW20Az+tk+jHU3XtQMnm6++6jk4P1jFJRVW\nnoGuaFj+VPXxodNWpAAAwAAAAQAAAD//wAAuAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\nAAAAAAAAAADYAAAADh+6DgC0Cc0huAFMzSFUaGlzIHByb2dyYW0gY2Fubm90IGJlIHJ1biBpbiBET1MgbW9\n...SNIP...\n\n```\nThe request sends the bot unique ID, which will be used in all future communications with\nthe botnet and the list of software that is installed in the system.\nThe response contains the nodes and the bot module for the system architecture. Both the\nnode list and the module are encrypted using the Info protocol described earlier.\n\nNode Messages\n\nThe following messages are sent between a bot and a node or between nodes. These will\nuse the Internode communication protocol, described earlier in this document, for encryption\nand transmission.\n\n**Beacon**\n\nThe beacon message will be sent by a bot to a node in the periodic checkin that is made\nevery 20 minutes after the initial infection. It does not include the public key and includes the\nbots last known external IP address. The response will include the nodes known modules\nand the IP address of the bot if it is different from the one sent on the request.\nFollowing are the examples of the request and response:\n\n```\nREQUEST\n\n```\n```\n<root>\n  <unique>ABCDEFG_12345678901234567890123456789012</unique>\n  <botnet>220</botnet>\n  <version>196637</version>\n  <system>64584</system>\n  <type>bot</type>\n  <ip>1.2.3.4</ip>\n</root>\n\n```\n```\nRESPONSE\n\n```\n```\n     <root>\n     <ip>1.2.3.4</ip>\n     <modules>bot_x32:b7365e711500550df99f254feac9d310,bot_x64:31f5073565351e1ba825d6a3b\n     ceac295,socks_x32:4b56a817f184c8536ed812d31bafd61b,socks_x64:da4c598b35d30ac60c3000\n     28be58021d,vnc_x32:863226dc453c35cd5880fcb2a858812e,vnc_x64:3fb6f34d7cf994abbcecb6d\n     679cc76d7</modules>\n     </root>\n\n```\n© AnubisNetworks, a BitSight Company 1\n\n\n-----\n\n**Beacon with pub key**\n\nThe beacon with pub key message is sent by an infected system to a node, the first time a\nbot communicates with a node. This message differs from the regular beacon in that it\ncontains the bot’s public key and it does not contain the bots external IP address.\n\nThis message will result in the following information being sent by the node:\n\n1. The bot current external IP address;\n2. The most recent module list known by the node.\nFollowing are the examples of the request and response:\n\n```\nREQUEST\n\n```\n```\n<root>\n  <unique>ABCDEFG_12345678901234567890123456789012</unique>\n  <botnet>220</botnet>\n  <version>196637</version>\n  <system>64584</system>\n  <type>bot</type>\n  <public>-----BEGIN PUBLIC KEY----MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQCzmIn0VTR06xaUCBc+DAOc1w/c\nr9X9sTdFmhqjIfR6RpmsBnjSyvUml3bUD0F+zJCKjHs0+qfsEg5jbcUWy2pxsRZY\n0P0FkFvbhAcU6XOzxu6+mfil8W7T+eqi8xPk0NlgyoNfNBDrmOTs9V/gS0xWxYRu\njTXX3qOGm+uIsyDeAwIDAQAB\n-----END PUBLIC KEY-----</public>\n</root>\n\n```\n```\nRESPONSE\n\n```\n```\n     <root>\n       <ip>1.2.3.4</ip>\n     <modules>bot_x32:b7365e711500550df99f254feac9d310,bot_x64:31f5073565351e1ba825d6a3b\n     ceac295,socks_x32:4b56a817f184c8536ed812d31bafd61b,socks_x64:da4c598b35d30ac60c3000\n     28be58021d,vnc_x32:863226dc453c35cd5880fcb2a858812e,vnc_x64:3fb6f34d7cf994abbcecb6d\n     679cc76d7</modules>\n     </root>\n\n```\n**Beacon with get_module**\n\nThe beacon with get_module message is used to request a software module from a node.\nThe nodes store and transmit software modules, which allows to avoid excessive load on the\nC2 infrastructure with traffic relating to software module distribution.\n\n© AnubisNetworks, a BitSight Company 1\n\n\n-----\n\nFollowing are the examples of the request and response:\n\n```\nREQUEST\n\n```\n```\n<root>\n  <unique>ABCDEFG_12345678901234567890123456789012</unique>\n  <botnet>220</botnet>\n  <version>196629</version>\n  <system>23128</system>\n  <type>bot</type>\n  <ip>1.2.3.4</ip>\n  <get_module name=\"vnc\" bit=\"32\" />\n</root>\n\n```\n```\nRESPONSE\n\n```\n```\n<root>\n  <ip>1.2.3.4</ip>\n<modules>bot_x32:b7365e711500550df99f254feac9d310,bot_x64:31f5073565351e1ba825d6a3b\nceac295,socks_x32:4b56a817f184c8536ed812d31bafd61b,socks_x64:da4c598b35d30ac60c3000\n28be58021d,vnc_x32:863226dc453c35cd5880fcb2a858812e,vnc_x64:3fb6f34d7cf994abbcecb6d\n679cc76d7</modules><module name=\"bot\"\nbit=\"32\">iMAlP+gf5ujehA6EsHVySqflek7YqX3+QCR6xcDb1LPgus4jXEhmT0Z21y2uLLginEA8gKBFFr\nGdXDTSnz3F/qZc0oV2lhf3ul4pb5HVe0spkF0FGohUnvwxXTPW20Az+tk+jHU3XtQMnm6++6jk4P1jFJRVW\nnoGuaFj+VPXxodNWpAAAwAAAAQAAAD//wAAuAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\nAAAAAAAAAADYAAAADh+6DgC0Cc0huAFMzSFUaGlzIHByb2dyYW0gY2Fubm90IGJlIHJ1biBpbiBET1MgbW9\nkZS4NDQokAAAAAAAAACWTSP5h8iatYfImrWHyJq1GNFutYPImrUY0Xa1j8iatov17rXDyJq1h8ietBvImrW\n\n```\n**Checkme**\n\nThe checkme message is used by a bot, during the escalation to node process, to request\nan existing node to check if it has a direct internet connection (no firewall and no NAT) and is\neligible to become a node.\nFollowing are the examples of the request and response:\n\n```\nREQUEST\n\n```\n```\n<root><checkme name=\"ABCDEFG_12345678901234567890123456789012\" host=\"\"\nport=\"443\"/></root>\n\n```\n```\nRESPONSE\n\n```\n```\n     <404>\n\n```\n© AnubisNetworks, a BitSight Company 1\n\n\n-----\n\n**Ping**\n\nDuring the escalation to node process, after a node receives the checkme request from a\nbot, it will try to send a ping request to the port specified on the checkme message. If it\nreceives a pong message than the bot is eligible to become a node.\n\nFollowing are the examples of the request and response:\n\n```\nREQUEST\n\n```\n```\n<root><ping name=\"ABCDEFG_12345678901234567890123456789012\" /></root>\n\n```\n```\nRESPONSE\n\n```\n```\n<root><pong name=\"ABCDEFG_12345678901234567890123456789012\" /></root>\n\n```\n**Info**\n\nThe info message is sent to new nodes informing them of the admin_nodes they should start\ncontacting.\n\nFollowing are the examples of the request and response:\n\n```\nREQUEST\n\n```\n```\n<root><info>T8JR2C+UMVGlsgJ2SRVSz2FgrzM2WMfGK3hR1RiZCs4WsX2+kZtgOC4OHPfIooR9l/mJWWi\nFeSZDCPB/zrIX5Bw+Y47mhGm8wrSoY5m5BMFzaKevVKkE8rSATmGuNPjAT/vXUAOaz2a91pwYbSxSreap/Y\nF8Ippz3V+TFxl6tcxKIV2qVapVqlWpGCUepFebWel6Lmln8jlB/yawjfhcEuqaTLx5GJ0ZRo2mE4NRzSUgE\neqkigvPOjR6c305PVkCxODSXndpHIoUIYyVRWSwvd3JcRI+fT8ZlpDXMS+BRT5XGGLiEw8lfMzBm5BofPWE\nTeDw2Ci6hUmjWZlHadA7X5etcVN1dJyqVao=</info></root>\n\n```\n```\nRESPONSE\n\n```\n```\n     <200>\n\n```\nThe body inside the info tag is a encoded using the Info protocol described earlier and\ncontains the admin_node to be used by the bot in the following format:\n```\n     <root><admin_node>1.2.3.4:443</admin_node></root>\n\n```\n© AnubisNetworks, a BitSight Company 1\n\n\n-----\n\nC2 Messages\n\nThe following messages are sent between a bot and the C2. These will be sent through a\nnode using HTTPS protocol containing a HTTP header that includes the bot unique ID and\nwill be forwarded by the node to the admin node without being inspected. The body of the\nHTTP requests will be encrypted using the C2 communication protocol described earlier in\nthis document.\n\n**Beacon**\n\nThe key component of messages sent to the C2 is the beacon. After the bot initial infection\nand escalation process, the bots periodically check in to the C2 by sending a beacon as the\nfollowing. If the C2 has a config file with a hash that is different from the hash sent by the\nbot, the new config file will be returned in the response.\n\n```\nREQUEST\n\n```\n```\n<root>\n  <unique>ABCDEFG_12345678901234567890123456789012</unique>\n  <botnet>220</botnet>\n  <version>196629</version>\n  <system>23128</system>\n  <type>bot</type>\n  <ip>1.2.3.4</ip>\n  <hash><![CDATA[37d0d82c2c7b156c82156d3aee6d23bca7faf052]]></hash>\n</root>\n\n```\n```\nRESPONSE\n\n```\n```\n     <root>\n     </root>\n\n```\n**Beacon with pub key**\n\nA bot will send the beacon with pub key message when it first communicates with the C2\nduring the register process. This beacon contains the public key of the bot’s own key pair\nand does not yet contain a config file hash. In response it will receive a public key. However,\nthe received public key does not seem to be used in any communication encryption or\nsignature validation routines.\n\n© AnubisNetworks, a BitSight Company 2\n\n\n-----\n\n```\nREQUEST\n\n```\n```\n<root>\n  <unique>ABCDEFG_12345678901234567890123456789012</unique>\n  <botnet>220</botnet>\n  <version>196629</version>\n  <system>56392</system>\n  <type>bot</type>\n  <ip>1.2.3.4</ip>\n  <public>-----BEGIN PUBLIC KEY----MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQCNsnbaFc+kXX3IDA2tmGZClurw\nHkM3wO7Ea9t6S3QRsQItDdvGvZofyRsNdiUnNdV3bagapJbA0LMcsOWS3LBCIgtH\nSlfw4eYlcOLGMIlPyy7MqVPwQKrtlDprUGflerSpLGkzOdtM8bVqmHRi1Rm2PARy\nnMelCdnmy4fQ8dashQIDAQAB\n-----END PUBLIC KEY-----</public>\n</root>\n\n```\n```\nRESPONSE\n\n```\n```\n<root><public>-----BEGIN PUBLIC KEY----MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQDP5z7lwWHpYZZaBjw3iSzHOFwg\nEg3CiuqbosZqfWqVwWpBIg178X4z+erjdELboFr6u7kEu3MScNHeVrLak9SI/OK7\n39jykbGp92MEgJef+5d/juUEajM5xAqI3e4Su3yvFSOW6zJqWwxQxDN8CF+tVeau\neDb7uPfcLmeGxLjmAQIDAQAB\n-----END PUBLIC KEY----</public></root>\n\n```\n**Beacon with empty hash**\n\nDuring the initial registration of the bot, it will send a beacon containing an empty hash value.\nIn response, the server will send the current configuration file and an initial set of commands\nthat the bot should execute.\n\n```\nREQUEST\n\n```\n```\n     <root>\n       <unique>ABCDEFG_12345678901234567890123456789012</unique>\n       <botnet>220</botnet>\n       <version>196629</version>\n       <system>23128</system>\n       <type>bot</type>\n       <ip>1.2.3.4</ip>\n       <hash><![CDATA[]]></hash>\n     </root>\n\n```\n© AnubisNetworks, a BitSight Company 2\n\n\n-----\n\n```\nRESPONSE\n\n```\n```\n<root><settings hash=\"37d0d82c2c7b156c82156d3aee6d23bca7faf052\"><httpshots><url\ntype=\"deny\" onget=\"1\" onpost=\"1\">\\.(gif|png|jpg|css|swf|ico|js)($|\\?)</url><url\ntype=\"deny\n\" onget=\"1\" onpost=\"1\">(resource\\.axd|yimg\\.com)</url><url type=\"allow\" onget=\"1\"\nonpost=\"1\">^https://www\\.bankline\\.(natwest\\.com|rbs\\.com|ulsterbank\\.(ie|co\\.uk))/\n</url\n><url type=\"allow\" onget=\"1\"\nonpost=\"1\">^https://corporate\\.santander\\.co\\.uk/</url></httpshots><httpinjblock><u\nrl type=\"allow\">(|\\.)alstats\\.com</url>\n...SNIP...\n</pattern><replacement><![CDATA[ce:'4']]></replacement></modify></actions></httpinj\nect></httpinjects></settings><commands><cmd id=\"3343\"\ntype=\"17\"><kl>WinBacs,albacs,Albany.EFT.Corporate.Client,wpc,eSigner,StartStarMoney\n,StarMoney,acsagent,accrdsub,acevents,acCOMpkcs,ac.sharedstore,jp2launcher,cspregto\nol,RegTool,translink,deltaworks,dfsvc,multibit,ArmoryQt,QtBitcoinTrader,Cortex7,OEB\nMCC32,WUB,electrum,DexiaSoft,acCOMcsp,AccessPay,Suite,Entreprise,Enterprise,bitcoin\n,bitcoinqt,Suite,Entreprise,Suite,Enterprise,argenie,argenie64,ARcltsrv,TokenManager,aetcrs\ns1,csdrv32,sllauncher</kl></cmd></commands></root>\n\n```\n**Beacon with get_module**\n\nDuring the initial registration of the bot, or whenever the bot finds that there are new software\nmodules available, it will request some of them from the node and some from the server. In\norder to do so, it will send a beacon containing the get_module tag. In response, the server\nwill send the requested module.\n\n```\nREQUEST\n\n```\n```\n<root>\n  <unique>ABCDEFG_12345678901234567890123456789012</unique>\n  <botnet>220</botnet>\n  <version>196629</version>\n  <system>23128</system>\n  <type>bot</type>\n  <ip>1.2.3.4</ip>\n  <hash><![CDATA[37d0d82c2c7b156c82156d3aee6d23bca7faf052]]></hash>\n  <get_module name=\"vnc\" bit=\"32\" />\n</root>\n\n```\n```\nRESPONSE\n\n```\n```\n     <root>\n\n```\n© AnubisNetworks, a BitSight Company 2\n\n\n-----\n\n```\n<module name=\"bot\"\nbit=\"32\">iMAlP+gf5ujehA6EsHVySqflek7YqX3+QCR6xcDb1LPgus4jXEhmT0Z21y2uLLginEA8gKBFFr\nGdXDTSnz3F/qZc0oV2lhf3ul4pb5HVe0spkF0FGohUnvwxXTPW20Az+tk+jHU3XtQMnm6++6jk4P1jFJRVW\nnoGuaFj+VPXxodNWpAAAwAAAAQAAAD//wAAuAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\nAAAAAAAAAADYAAAADh+6DgC0Cc0huAFMzSFUaGlzIHByb2dyYW0gY2Fubm90IGJlIHJ1biBpbiBET1MgbW9\nkZS4NDQokAAAAAAAAACWTSP5h8iatYfImrWHyJq1GNFutYPImrUY0Xa1j8iatov17rXDyJq1h8ietBvImrW\n\n```\n**Beacon with data**\n\nWhenever the bot has some data to sent to the C2 it will send a beacon with a data tag that\ncontains the data to be sent. The data being sent depends on the way it is collected, but it\ncan be comprised of:\n\n  - Keylogger data\n\n  - Man In The browser data (forms, passwords, etc.)\n\n  - Screen shots\n\n  - Debugging data\n\n  - Other data\n\n```\nREQUEST\n\n```\n```\n     <root>\n       <unique>ABCDEFG_12345678901234567890123456789012</unique>\n       <botnet>220</botnet>\n       <version>196629</version>\n       <system>56392</system>\n       <type>bot</type>\n       <ip>1.2.3.4</ip>\n       <data>\n        <keylog session=\"11972477\" app=\"jp2launcher.exe\" time=\"2015-06-27 04:20:37\"\n     type=\"shot\"><![CDATA[/9j/4AAQSkZJRgABAQEAYABgAAD/2wBDABQODxIPDRQSERIXFhQYHzMhHxwcHz\n     8tLyUzSkFOTUlB\n     SEZSXHZkUldvWEZIZoxob3p9hIWET2ORm4+AmnaBhH//2wBDARYXFx8bHzwhITx/VEhUf39/f39/\n     f39/f39/f39/f39/f39/f39/f39/f39/f39/f39/f39/f39/f39/f39/f3//wAARCAMABVYDASIA\n     AhEBAxEB/8QAHwAAAQUBAQEBAQEAAAAAAAAAAAECAwQFBgcICQoL/8QAtRAAAgEDAwIEAwUFBAQA\n     AAF9AQIDAAQRBRIhMUEGE1FhByJxFDKBkaEII0KxwRVS0fAkM2JyggkKFhcYGRolJicoKSo0NTY3\n     ODk6Q0RFRkdISUpTVFVWV1hZWmNkZWZnaGlqc3R1dnd4eXqDhIWGh4iJipKTlJWWl5iZmqKjpKWm\n     p6ipqrKztLW2t7i5usLDxMXGx8jJytLT1NXW19jZ2uHi4+Tl5ufo6erx8vP09fb3+Pn6/8QAHwEA\n     AwEBAQEBAQEBAQAAAAAAAAECAwQFBgcICQoL/8QAtREAAgECBAQDBAcFBAQAAQJ3AAECAxEEBSEx\n     BhJBUQdhcRMiMoEIFEKRobHBCSMzUvAVYnLRChYkNOEl8RcYGRomJygpKjU2Nzg5OkNERUZHSElK\n     ...SNIP...\n\n```\n© AnubisNetworks, a BitSight Company 2\n\n\n-----\n\n**Node beacon**\n\nThe node beacon is sent by the nodes to the admin node periodically (every 20 minutes) to\nkeep alive its node status. The following is an example node beacon:\n\n```\nREQUEST\n\n```\n```\n     <root>\n       <unique>ABCDEFG_12345678901234567890123456789012</unique>\n       <botnet>220</botnet>\n       <version>196629</version>\n       <system>23128</system>\n       <type>node</type>\n     </root>\n\n```\n© AnubisNetworks, a BitSight Company 2\n\n\n-----\n\n## Running a Fake Node Inside Dridex Botnets\n\nAnubisNetworks main objective while performing the reverse engineering effort that resulted\nin the information described in the previous sections of this document was to research a way\nto monitor the botnet, its infections, configuration files, modules and exfiltrated data in real\ntime.\n\nIn order to understand more about Dridex and its operations, we decided to use the protocol\nknowledge we already had to develop a fake bot in Python with the following capabilities:\n\n       - **Register itself into the botnet**        - This was a necessary first step. The fake bot\n\nneeded to “speak” dridex protocol and be indistinguishable from the remaining bots;\n\n       - **Escalate to node - After escalating to node, we would start receiving connections**\n\nfrom other bots;\n\n       - **Intercept communications - The ability to decrypt connections would allow us to**\n\nunderstand exactly the type of information that was being extracted from the bots and\npossible behaviour patterns of the botmasters;\n\n       - **Receive updated configuration files - This capability was interesting because it**\n\nwould enable us to monitor new targets (e.g. banking institutions) whenever they\nwere added or removed from each of the botnets in real time;\n\n       - **Receive updated software modules - This would allow us to monitor updates to**\n\nexisting modules and the appearance of new modules in the botnet;\n\n       - **Send arbitrary messages between the nodes, and spoof C2 replies - This would**\n\nallow us to further test the botnet and understand its behaviour when manipulated.\n\n© AnubisNetworks, a BitSight Company 2\n\n\n-----\n\n### Architecture\nThe following diagram represents the architecture of the fake node:\n\nThe system is composed by the following components:\n\n       - **Bot module - This module is responsible for registering the bot into the P2P network.**\n\nIt will communicate with the nodes as a regular bot, and after escalation, it will\ncommunicate with the admin_nodes as a node;\n\n       - **Node module - This module is responsible for receiving all incoming connections**\n\nand processing all internode communication. If the incoming connection is not in\nInternode protocol, the module forwards it to the SSL MITM module;\n\n       - **SSL MITM module - This module is responsible for intercepting SSL**\n\ncommunications by presenting a fake certificate to the client and reestablishing the\nSSL connection to the admin server. This module is also responsible for decrypting\nall C2 protocol communications using the C2 private key.\n\n© AnubisNetworks, a BitSight Company 2\n\n\n-----\n\n### Deployment\n\nOur fake node achieved all objectives. Running it revealed to be a challenge due to the high\nactivity level of the botnet operators and the countermeasures they deployed over time, see\nCountermeasures Timeline below.\n\nThe fake node was successfully used to monitor the botnet for a few months, but this\napproach has a high maintenance cost due to the constant evolution of the botnet. However,\nbuilding this software allowed us to better understand the inner workings of the botnet and to\nidentify a few vulnerabilities.\n\nTo track the different Dridex botnets, C2 changes and bot infections over time we have\ndeveloped another application on top of the fake node that was used for collection, storing\nand reporting, called Dridex Tracker. The following image shows the Dridex Tracker GUI:\n\nScreenshot of Dridex Tracker\n\n© AnubisNetworks, a BitSight Company 2\n\n\n-----\n\n### Countermeasures Timeline\n\nThe fake node was run with all capabilities enabled from the end of April to the first half of\nJuly 2015. During this time the botnet and bot modules were updated several times and\nseveral countermeasures were added by the botmasters to prevent rogue nodes from\nentering the network.\n\nThe following is a chronological record of some noteworthy occurrences:\n\n       - **22nd April - Initial efforts to join the botnet were successful. The fake node escalated**\n\nto node and started to receive connections from other bots;\n\n       - **30th April - Dridex protocol changed and we were no longer able to join the botnet.**\n\nThe new protocol was reversed and the fake node code was improved;\n\n       - **20th May - The botmasters started to block rogue nodes by removing them from the**\n\nnode list and disabling the IP address to register into the network. We opted to use\nthe rogue node only for one botnet at a time;\n\n       - **27th May - The botmasters added a feature when blocking a rogue node IP that**\n\nsent 127.0.0.1 as the IP address of the admin nodes and nodes, causing the rogue\nnodes to enter an endless loop;\n\n       - **30th May - The botmasters started to try to disable rogue nodes by sending them a**\n\n“killer module” that erased a system MBR, and caused a reboot;\n\n       - **23rd June - The botmasters started blocking rogue nodes more frequently, several**\n\ntimes a day;\n\n       - **10th July - The node escalation process seems to be controlled manually or in some**\n\nother way that prevents the automated immediate node escalation.\n\n© AnubisNetworks, a BitSight Company 2\n\n\n-----\n\n## Results\n\n### Infection Dispersion\n\nDridex botnets don’t have the same size in terms of infected systems when compared with\nother botnets in the wild but represent a very serious threat. That is unusual, given the high\nrate of email distribution campaigns.\n\nIn April 2015, for the main Dridex botnets we counted the following unique bots:\n\n**Botnet** **Unique Bots**\n\nDridex-120 5850\n\nDridex-200 750\n\nDridex-220 9650\n\nIn July we observed a drop on those numbers. The following counters are related to unique\nbots for the main Dridex botnets that our fake node intercepted in the time window between\n29th June and 10th July 2015.\n\n**Dridex-220**\n\nDridex-220 botnet geo dispersion and top 10 infected countries (unique bots: 3770)\n\n© AnubisNetworks, a BitSight Company 2\n\n|Botnet|Unique Bots|\n|---|---|\n|Dridex-120|5850|\n|Dridex-200|750|\n|Dridex-220|9650|\n\n\n-----\n\n**Dridex-120**\n\nDridex-120 botnet geo dispersion and top 10 infected countries (unique bots: 995)\n\n### Targets\n\nThe main targets of Dridex were banks from several countries. During our analysis, we\ncollected several versions of the config files for the main botnets (120, 200 and 220) in real\ntime as they were updated. The following are the hashes of the config files. The number of\nfiles reflects the number of updates and shows the high level of activity of the botnet\noperators.\n\n**Dridex-120:**\n```\n     a2297e5943b67baea4981492d130e832e477385e\n     46fb662c14139fe9896fac7ae446da1cfec267a4\n     a1f77caef817bf37e9106a0c404a34933c44fbea\n     1f257aa466fafc0fb7ee86500d12971934e56774\n     01af94bec88baf6487c1ad7dd4df1da76a851a86\n     0e4770e4d920bc6d96cebf1790211dc19f0ea79a\n     2bd2401726c43d424628877f4d1d13f94084fad1\n     556b30c88b78e0df7d5a456085c1159ec312cf91\n     68d86c793fe06b5a41a65bd7626750201ec61b18\n     a0a36d2ec157515af30b49e14494be43201c2fcc\n     c44a63e98920e8e2d07e3a2f94c26bbd878bbdb5\n     caba93b3a74620fb747748931834e181aaf6d557\n     aafc829063b25e70e11052e9995095253471586c\n     de85d6246ad7951f1af306bd65a2f82555dc5bc8\n\n```\n© AnubisNetworks, a BitSight Company 3\n\n\n-----\n\n**Dridex-200:**\n```\n     9df3eb9f7a404afc66b7a91877255ca1692959c7\n     cba023ce14c2502a31be47c1e4be1f4a21e730c1\n     1751c8359d81eee60437ef2c9d91b2b53ec1598e\n\n```\n**Dridex-220:**\n```\n     24877bb165bc0d66723be7dca1491b73f533fa1f\n     2a2e3c51d4a05c8e8c5bb76cb756eb87fa6b0dea\n     37d0d82c2c7b156c82156d3aee6d23bca7faf052\n     3c24b82d5e241f520d362d1f6a2713b5ca7011eb\n     44450edfefa88b92e1f5d0ef8e38c7b78cddfce7\n     79f9220f966c0de08e2b5e9d37064ed6ae39ccf3\n     830deb5d060789d353a1e5507669c4fda155ac67\n     8e94867d2ff752a0da55a9ab1f6046a915316908\n     a04ab4391ca6c78871f366198c90e201b40b23e1\n     a4e43c67156ed562b3f08358f520a21b0ae69463\n     a60ba9a229caba4daf591cfed67517e711ed7e22\n     a8fbd1b6fab99d20362edec7d2937cc35eb3248b\n     aa3dc12da7bf2b030a3b1310b38e168298b6c92b\n     bf008392dfdf36f77492a52eb3ab60aec586bcd6\n     bf7201be41ba82d7f7ae521e5171b6e7d2d4b80e\n     c2700de864cc9fb90f0450b6dcda52519389ab4f\n     d1c36a0addb61b31fb52bccf0024a1acf589a6dd\n     e09de57a7e946654d0db8d8911ccc3909d1689a1\n     edcd41096f3678170e38c63968d7a1bec99ebe9e\n     f37ff046e73a532a4064098e8d217a173d947c73\n\n```\nThese config files contained the webinject settings for several hundred URL patterns that\nmostly belonged to online banking applications and other financial related . Besides the\nwebinject data, the bots were also instructed to keylog data from the following applications:\n```\n     WinBacs,albacs,Albany.EFT.Corporate.Client,wpc,eSigner,StartStarMoney,StarMoney,acs\n     agent,accrdsub,acevents,acCOMpkcs,ac.sharedstore,jp2launcher,cspregtool,RegTool,tra\n     nslink,deltaworks,dfsvc,multibit,ArmoryQt,QtBitcoinTrader,Cortex7,OEBMCC32,WUB,elec\n     trum,DexiaSoft,acCOMcsp,AccessPay,Suite,Entreprise,Enterprise,bitcoin,bitcoin     qt,Suite,Entreprise,Suite,Enterprise,argenie,argenie64,ARcltsrv,TokenManager,aetcrs\n     s1,csdrv32,sllauncher\n\n```\nOne interesting fact was that Dridex not only collected information information from banking\nsites but also from many other websites that are not directly included in the config files\nwebinject settings. These included login credentials for corporate extranets, VPN, webmails\n\n© AnubisNetworks, a BitSight Company 3\n\n\n-----\n\nand several online services. While running our fake node on botnet we observed a total of\n2069 unique domains whose information was stolen from user’s browsers transmitted to the\nC2.\n\n### Stolen information\n\nOur fake node was able to decrypt communications as they were being sent from the bots to\nthe C2 Server. This allowed us to gain a better understanding of the type of information that\nwas being harvested, and although there were banking credential being stolen, a large part\nof it was not directly related to online banking. We observed mainly three types of submitted\ndata:\n\n#### Keylogger data\n\nThis included data from a set of applications that were configured to be keylogged. Also\nbecause it included generic software such as jp2launcher.exe (the process for java applets),\nseveral chat applications and other applet based interfaces were being logged. The following\nimage shows an example of a keylogging session being transmitted:\n\nDump of a chat session sent to Dridex C2\n\n© AnubisNetworks, a BitSight Company 3\n\n\n-----\n\n#### Web Inject Data\n\nWeb injects were able to extract specific HTTP submitted data from a large number of\ndifferent domains. Following is an example of a set of credentials for an online application\nbeing sent to the C2:\n\nLogin credentials been sent to Dridex C2\n\n#### Screenshots\n\nScreen shots were also taken for a given set of applications. Following is an example of a\nscreenshot image that was transmitted to the C2:\n\nCaptured screenshot from Dridex infected system sent to C2\n\n© AnubisNetworks, a BitSight Company 3\n\n\n-----\n\n## Indicators of Compromise\n\n### Analyzed Samples\n\nSome of the samples analyzed during our research, referenced by their SHA-256 hashes:\n```\n      00c571f017d487ebe781dcafc469fe6f872c563baccef48a48275a2f3f897bf8\n      03385cbccae28797e0f6b8c1f9b55e767dad487fb652162def9f8eb7a86b29a7\n      044b887de7fcbe126825a16174fe7dd9ef7753f313f4775ca489b92e54be5bf5\n      053f9ea7ad120ae759dd71a1da27cfd8e8cb44496e24e9f11a6ce132dab10294\n      05f5c678ee84532613dc60464eab3ce862f3999eb5dad96d2cb5f47254cffdcb\n      076da91896b0ee6269644a1ab0afa42de278c551bcf2b0933ed92d269b377dd7\n      0791f50d933a90b53b96be52d91aa35e12b31e57dc55e43e4e6131cb94c3bc1a\n      083aa942388416bb9688b1a0520ab15c910448c75b75d90a7b6f404f2e105a38\n      17f5e836f2a817bb0f977dbddfc58b03cb235e0fd27c4865de44fd37f249fb36\n      1c14399e361fd7d3c66d65c9a79d4896e03ce977bed4caf7e68b8741828b00e4\n      201f37cb8c33330b72f73b6a4b5a4699b01d7529f7a2e372dc2ff94e068c2241\n      2069ab8ed9245560ebb2219df37e4b740e6a0ed6931ed71fa31dd580cf0ed834\n      24aff09953c8301e82217137001b9ed45a84a3f3a04d6ce1a875d2d36eb275fb\n      252bfae5a124882c38c7727e25d3e637161bcc9e03f31b9922756f1868466d19\n      253e7b09431c1a9473008b49480cf702baa65eabd79c44d8d7be1560af6017de\n      288e528e15297b2ed1b7850650f9ac72e4fb7ba50412bfc3375af7a2fb092a7e\n      2d95c36352bc110f2c74d7ccc83a3003df0fbf2c62268f446ae4954852db8448\n      34fc383d51cbe08ab998e986e2cf1ee1535a3130bb0165e3b6fa94a67b0be0ec\n      38011cb19ccccad55d331ff725f208eb164fd7fa7418cd50a8ad2c026716112d\n      3a4322466c019d662b33b6e08db1c1e42dce08c80a5b8ffee402e14bb7af8584\n      3acdb80ecb3cb2dd9203691cd59bb9e0750e5d9eecb726e5de1b33cd29609993\n      3f8d6700ee02836dae168b6bda36dde73a43b77eedb722f766e6455204fa126d\n      3ff2a363fd9c3f63b519f3ee51f18cf4b395001bfa5a954ec47d9849e1b050d7\n      4120279ad7d80943896f8e6e15cf9ffc951e78e8f79ebf1d254473faceb8ccec\n      41d14fd287593204b179a90a9d0c83dc78ef2e6dcf90ffc087fbfbdfb3392f95\n      475295a3c2c8e19fa4a24ad66318957c4031d0ef4464ddf0b3665ec9ee23c10e\n      4fdd1e4ec1fe53c5ec347c1956367059a7318bcedea0e0969508923b186afcb8\n      52104187baa76905d8793861d0214f3c60124697c6c85d0bef27815310dc182b\n      53937c1c877f79f5ae1e5d3e7b2c177a6ba36ed1e222430177833cc47bfe524c\n      5ac0c18b4743626c3c49492cd7470c1b4060c553705bb49612a5d1b2be0c2fb5\n      5b35ccc23990f88b412e1b8abc04ba930abc0131a9a23bd43c27a85faf2304d1\n      5cb5ca44a45dcf5c03b26a4b3fbbf52937f78651d5cf51bba3732f17433916d8\n      5daa5dc22bacc1857ff2b17f2572b86de2cbbfbb83016fefb4352e7e497d68e9\n      5e1626e985ef11cae40587e715df23cf6ef048f11b2ce3405da899209beee05a\n      5e98a73e1a377d75a8363672adf3c3f490d0bc01d7a104e8fd28e3cdf6457e44\n      605e2d3f4c0789147e63885eedbf93a5c6ec381170fe00f14ff558c6d7973c83\n      608daddf175bdf12babc4df2bff093b9506c6cd87f800a1bb95cc0005e9f85e5\n      6287776f22b19e409efe6342900d31b499c1077cd36fd8a4d988e3bfe1710d49\n      637dcd114f945c7e25a649023e309f6b0165ba5a2d8e54395b426dad5526ce36\n      66cf9503474113671d048185899933f383ee96b48638b44d6a12796c974aa7cf\n      673e98d480871eece9374a35de386768c4318fb94e93be0da727e7fa0d5523bc\n      69140fdbfd44d30286c188ce3489ba43a606eec8b7803d664e3d054f259ca2f2\n      6b596c71af43f1433de928f454e132eefbb1a0e5ea42d41a629fef08d59247fd\n      6e67206bafe0cea4d7e2229d6014b8cc6824135eddffa6db243f527c93f58486\n      70c5b1ab923037b517236e9d7d901f56bbc9903b5fbe5cb49c94ac24f0146b88\n      78d84f8368b44692b74500f6071788170bc2fef27363586b6d569d745d1cf2a2\n      7907e5919d22fbd25b082cfd33dbb8c99d42fc1258767a4de178388b3eca9679\n      7bcb0abcfbea20ecfe31d8dd65146b8b1ffd0d81479d11dc329b2f99e263bd78\n      7f159c34b8d8e662405dd403df17a03f16a634b454677fb47e0ece7e277e2315\n\n```\n© AnubisNetworks, a BitSight Company 3\n\n\n-----\n\n```\n      803f63c24dc2e9b2a266adcf27950e247d83bb9b2a84065e030e68574cecaf9d\n      818d07c8b0f082dab108dc999265bb2f4f443ac93487efaf54c66a23e00482f2\n      84c9c2d16e31ce35c5ebc8ef2a1d185fe6b365d9a90ffe6ee93c52f9ad0f2911\n      855646fda14da9fbcaad3e92f1f7f84162c6744b5cba55524e21fd651033f159\n      88aaa24a15840ef0e4d3fd73379a455073d1699ba63a74e0faa7b31600521dbc\n      8862de75728637f852fee06dee15258a2f4af6ea12e80f98a9614629c8956d5d\n      8bb1ccc07e79bc6818c865343da2e8bdc33a83cc93c3e1bf1f2c5f69d7a40387\n      8c79bff0c302a0c1762fc59ab7001001a9293506197579213e087868493b756e\n      8e6bb148ffc0e18c0450a89f7b0ba729a28eb22da12fd3f69d18daa85fd09024\n      9014c90c29945043eb94ba1d5119b6961c1595f5af319b2796b9850f6c0c8b4f\n      93242b25aaf2aea8ecef7327cbfc40cb8f8fda0eecd4618674062f81186ed8b2\n      93989989f4811b942491b63f848964237ab135d4c0c53b9039dbd1c5afbf703d\n      939bfb99c45aef07a26e0a3e214bc028f3f4455c9d6f871b033348e51c1e6491\n      93aff0e300e8ec913b9405528506b875f8fe4dc9944c570ab95bdd86160f4574\n      950d3059ddee96b7178b2f360fb0c1ed4454ada78528659ff70dc4b538ccd448\n      96ebf5fef0cbe6c7e5335e35f0c81177c3531393cdd10f33ab30b45f1694c546\n      971403cb96c22acecd030aeb7b25da08fd10af4a85877d8d2c49a8ac26a90796\n      982eda0ae68525e7cb212ff81f59e9887a361df7bce5321f6f110c2210f42cf8\n      9a6dbb718f05748f8e8e6d9ac75748244e41fba4eef6a04f9dfb242012a2cd29\n      9c1394c8bc24313c76e7fe113657875455d009e9b24f30b4208628d93ca9c7fc\n      9f10dc38f9e284ad4993a0579e1f732a2da1eb69d04aba5babcb2d4458b5a7da\n      9f2e357c83fdfb6c560322b3357f394f61ea6d5b1c8a22a7d3e9a6160633b20d\n      9fb3a5b2ef49ee304ae0fb75fcc2d951718d28687d2721a529b592d0719de580\n      a4e8e089097301769e27982f55561fbe5240dc695ca50b9b6a801d4e4b609b50\n      a60bc90e9e8281321bdb8595c8734688a67982864fcce1a20347112a663439ff\n      a7ffc9851184437d694d85e77ef0eebbaaddbd40d40b0a22bb2cb51deee32305\n      ab9cb59a12a10a06a5fede0cebf9184f2a533bd135f14beb9d7c9864001cf20a\n      aca8a777c51c537d23fbe8ca181bb49fa0eb250e0a2e1551ea2e4fad9a746fc7\n      ad7a6f5a99d3678475d136a06fd710da1c4cac00cb4f4109e44e14f574f3ff88\n      c1731a1f5142190cd397057dfa1a0de77025eb2786b8ec1007724ed9fe705084\n      c25f09ac747e1eedf75ca88bb74c4b660b4611c789f2f3030754c8140801ecb8\n      c56a46575f00e527844ea393c50aa58500dda94088c34489559b610200ba756b\n      c577a5ddbdf85ab2a168223d80981cf1d835f15dbf0437cc43b5801cc37010a6\n      c6725b674fc0c20a696e4b6df95ced81c912a7b11dcadfd7f8b81c6106b556cd\n      c6db0d4bfb2a909ce0767269bbe18f9190e75260eccddab8990563ac8b862cac\n      c6e78a167bd5277bca73acf9164ca611cb2999621a63ff380a9ccf440202c31d\n      c94e5b273aa0c65c144e74586de4507f2e807b9f2a0246a76faf8cc9f7f921f6\n      cb77b8792d5d117b420304e3b6e4fc72076550ea4f1c9bb9a13870c8e0699269\n      cd88c3d4a1a8779edae8ff706b7fdad6598c85af8b0b5d87e1f33d93be5c4315\n      d06b515db7f8579da3c5cc21b667c98463bd26b4e77e4d85a1dbf9326f060c63\n      d1b57efcaf5d061e387638ceb1d8fe16729e37c3c2a7bcf8e5131598463d2684\n      d2865aa1193fb32e5604ab03e9cd709dacc0a114b5c611c5b3b5470b1af4f32f\n      d31efa8255e1eb4319f0713a817c8148fa35771a01d47fe009bfc3dff60eab4f\n      d40d05316db62ea3d27830f87892aaeab3ff22b63babadb755aad10dcba85a7d\n      d57dc5d12825f9dacceff29738ce4797bcc68b2bf67baf328c59651ebbdd5f8c\n      d57f99ad25e12386ca27c4a1b621c72243380573d8eab2fb2d9ff08671a926d0\n      d73ded7b08da92491bd2f2564fa070e820912fbe6ae253795245e8f29539398b\n      ddf5a6e438082b8523bf5df34bd885b092eb4f49c91af7fa5a56bb44914a048a\n      de483957fdb99fefcc645c8d116cd4ac3d41bcb8b2060010039cbdaba75f4f93\n      e036c4d6364f94287144a68a815eaadf23e40ad169ac780a7ac7a2aad3b36b32\n      e70d529938102d1fca9a55beb00fe4b33985cc7a6ca9d1ba7f5998954091a3e0\n      e75d9851b45c83b7112546c9006d627326da820c3322002cc66249c4d57abfb1\n      e90cc9975fae547bb31f48c265a54718207df57cf67782576dfee2294ded7ae2\n      e9f72a82d897d57219e1a9a3837f089edec92f58c01c62743c025dfea1be4d17\n      eabc6e91742d9ad251a40c92e7185b10b8ef812311afde5ca551def564485a03\n      eb885ffd162131493af6ec76465045abbb1081f4fee55ad538ab9e4f826e54de\n      ebf680dee76110bff21166800de38b1940f9ee795f190a447d4a4765758aa127\n      ecad6974598a1efb6cc7d4e4012b8aab0259323ef45a9eda24c27de82ed5566d\n\n```\n© AnubisNetworks, a BitSight Company 3\n\n\n-----\n\n```\n      ed23794c19b93c3b62707a8ca8d81256c56f588ea8061c3c990e54a0adf2cc18\n      f2328ad463d584ba06cba3338d73b1ee2ba772401d51cf0c88c51aec53bd3623\n      f3a359c36d63466abb988d8b4aa96dd8fef6fd4450dd09c123c6aa8f513d1bba\n      f3a70107ff94c33e5c5ed76b06a1ddc8d68d04a3f2b8b9027ad2d0d02e54c467\n      f4360ba1a956280eace36bf3b8a9eb1961f269f4c855e89d4d4d490278c7c653\n      fa252e501332b7486a972e7e471cf6915daa681af35c6aa102213921093eb2a3\n      fb0e2bba53ddc68e9f1046de0b5b240669b4f3f83be63d3d0f575c38a7ae80b0\n      fead2bf5b5b9a76c8267c675bb64ad8de5b9f85faf7c87cb72e890aca3253117\n      fecac80db9b28cb2eaa0de509af4f113784d3cab3be3c3751b3330c8b165f043\n      ff87f367bb4ac340964743e8ef4e346f96546cec5fda5c0c9d7956237520b31f\n      5ee065c1ff85512a9219e58cdcd1173e9c8106d860c8752b202db679631f477d\n\n```\n© AnubisNetworks, a BitSight Company 3\n\n\n-----\n\n## About Cyberfeed\n\nThis investigation was developed based on the data provided by Cyberfeed,\nAnubisNetworks Threat Intelligence offer. Cyberfeed provides a unique view in the early\ndetection of cyber-threats. The combination of real-time security monitoring, context, and\n\"smart eyeballs\" empowers organizations and government agencies to have a new and\npowerful approach to fighting cybercrime. What makes Cyberfeed stand out?\n\n       - More than 25 000 events per second collected and streamed to security feeds as\nthey happen.\n\n       - AnubisNetworks' Threat Intelligence offering provides real-time data on cyberattacks, allowing organizations to mitigate risks as they arise.\n\n       - Since the information is processed in real-time, users do not need to invest in data\nstorage, making this a lean and very light service.\n\n       - Turning data into actionable intelligence is the cornerstone of AnubisNetworks'\nThreat Intelligence offering. Events collected from disparate sources, including\nbotnets only tracked by AnubisNetworks, are transformed and enriched into\nmeaningful knowledge to help stop cyber threats and attacks.\n\n       - It dynamically provides full context of what is happening and is not a snapshot of the\npast, enabling cybersecurity analysts to obtain increased visibility into a situation and\nenable informed decision-making.\n\n       - Cyberfeed API flexibility allows customizing and processing data feeds in real-time,\nincluding measuring, filtering and de-duplicating events on the fly. Cybersecurity\nanalysts can slice and dice data to better fit their requirements and build the\nnecessary knowledge to stop threats.\n\n## How can AnubisNetworks play a role? \n\nAnubisNetworks is an IT Security Company specialized in real-time threat Intelligence for\nB2B.\n\nWith an established reputation for delivering innovative and effective solutions,\nAnubisNetworks has worked with multiple service providers, risk and security organizations,\ntelcos, major banks, media groups and large corporations delivering Real Security in RealTime against Real Threats.\n\n© AnubisNetworks, a BitSight Company 3\n\n\n-----\n\n© AnubisNetworks, a BitSight Company 3\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "bf5be533-fa31-4590-ae37-5761c97ffa34",
            "created_at": "2022-10-25T16:13:58.389257Z",
            "updated_at": "2022-10-25T16:13:58.389257Z",
            "deleted_at": null,
            "name": "Malpedia",
            "url": "https://malpedia.caad.fkie.fraunhofer.de",
            "description": "Malpedia is a free service offered by Fraunhofer FKIE",
            "reports": null
        }
    ],
    "references": [
        "https://cdn2.hubspot.net/hubfs/507516/ANB_MIR_Dridex_PRv7_final.pdf"
    ],
    "report_names": [
        "ANB_MIR_Dridex_PRv7_final.pdf"
    ],
    "threat_actors": [
        {
            "id": "a66438a8-ebf6-4397-9ad5-ed07f93330aa",
            "created_at": "2022-10-25T16:47:55.919702Z",
            "updated_at": "2025-03-27T02:05:17.412024Z",
            "deleted_at": null,
            "main_name": "IRON VIKING",
            "aliases": [
                "ATK14 ",
                "BlackEnergy Group",
                "Blue Echidna ",
                "CTG-7263 ",
                "ELECTRUM ",
                "FROZENBARENTS ",
                "Hades/OlympicDestroyer ",
                "IRIDIUM ",
                "Qudedagh ",
                "Sandworm Team ",
                "Seashell Blizzard ",
                "TEMP.Noble ",
                "Telebots ",
                "Voodoo Bear ",
                "APT44 "
            ],
            "source_name": "Secureworks:IRON VIKING",
            "tools": [
                " BlackEnergy",
                " GCat",
                " GreyEnergy",
                " Industroyer",
                " KillDisk",
                " NotPetya",
                " PSCrypt",
                " TeleBot",
                " TeleDoor",
                " xData",
                "BadRabbit"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "b3e954e8-8bbb-46f3-84de-d6f12dc7e1a6",
            "created_at": "2022-10-25T15:50:23.339976Z",
            "updated_at": "2025-03-27T02:00:55.446795Z",
            "deleted_at": null,
            "main_name": "Sandworm Team",
            "aliases": [
                "Sandworm Team",
                "ELECTRUM",
                "Telebots",
                "IRON VIKING",
                "BlackEnergy (Group)",
                "Quedagh",
                "Voodoo Bear",
                "IRIDIUM",
                "Seashell Blizzard",
                "FROZENBARENTS",
                "APT44"
            ],
            "source_name": "MITRE:Sandworm Team",
            "tools": [
                "Bad Rabbit",
                "Mimikatz",
                "Exaramel for Linux",
                "Exaramel for Windows",
                "GreyEnergy",
                "PsExec",
                "Prestige",
                "P.A.S. Webshell",
                "VPNFilter",
                "Cyclops Blink",
                "SDelete",
                "AcidRain",
                "Industroyer",
                "Industroyer2",
                "BlackEnergy",
                "Cobalt Strike",
                "NotPetya",
                "KillDisk",
                "PoshC2",
                "Impacket",
                "Invoke-PSImage",
                "Olympic Destroyer"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "3a0be4ff-9074-4efd-98e4-47c6a62b14ad",
            "created_at": "2022-10-25T16:07:23.590051Z",
            "updated_at": "2025-03-27T02:02:09.878211Z",
            "deleted_at": null,
            "main_name": "Energetic Bear",
            "aliases": [
                "ATK 6",
                "Blue Kraken",
                "Crouching Yeti",
                "Dragonfly",
                "Electrum",
                "Energetic Bear",
                "Ghost Blizzard",
                "Group 24",
                "ITG15",
                "Iron Liberty",
                "Koala Team",
                "TG-4192"
            ],
            "source_name": "ETDA:Energetic Bear",
            "tools": [
                "Backdoor.Oldrea",
                "CRASHOVERRIDE",
                "Commix",
                "CrackMapExec",
                "CrashOverride",
                "Dirsearch",
                "Dorshel",
                "Fertger",
                "Fuerboos",
                "Goodor",
                "Havex",
                "Havex RAT",
                "Hello EK",
                "Heriplor",
                "Impacket",
                "Industroyer",
                "Karagany",
                "Karagny",
                "LightsOut 2.0",
                "LightsOut EK",
                "Listrix",
                "Oldrea",
                "PEACEPIPE",
                "PHPMailer",
                "PsExec",
                "SMBTrap",
                "Subbrute",
                "Sublist3r",
                "Sysmain",
                "Trojan.Karagany",
                "WSO",
                "Webshell by Orb",
                "Win32/Industroyer",
                "Wpscan",
                "nmap",
                "sqlmap",
                "xFrost"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "8941e146-3e7f-4b4e-9b66-c2da052ee6df",
            "created_at": "2023-01-06T13:46:38.402513Z",
            "updated_at": "2025-03-27T02:00:02.824555Z",
            "deleted_at": null,
            "main_name": "Sandworm",
            "aliases": [
                "G0034",
                "IRIDIUM",
                "Blue Echidna",
                "FROZENBARENTS",
                "Seashell Blizzard",
                "IRON VIKING",
                "ELECTRUM",
                "TeleBots",
                "UAC-0113",
                "UAC-0082",
                "APT44",
                "Quedagh",
                "VOODOO BEAR",
                "TEMP.Noble"
            ],
            "source_name": "MISPGALAXY:Sandworm",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "75108fc1-7f6a-450e-b024-10284f3f62bb",
            "created_at": "2024-11-01T02:00:52.756877Z",
            "updated_at": "2025-03-27T02:00:55.544216Z",
            "deleted_at": null,
            "main_name": "Play",
            "aliases": null,
            "source_name": "MITRE:Play",
            "tools": [
                "Nltest",
                "AdFind",
                "PsExec",
                "Wevtutil",
                "Cobalt Strike",
                "Playcrypt",
                "Mimikatz"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1666716503,
    "ts_updated_at": 1743041785,
    "ts_creation_date": 1445017280,
    "ts_modification_date": 1445017280,
    "files": {
        "pdf": "https://archive.orkl.eu/9af5be97efbcd8023c4eaf7d48cd028c09f3f30a.pdf",
        "text": "https://archive.orkl.eu/9af5be97efbcd8023c4eaf7d48cd028c09f3f30a.txt",
        "img": "https://archive.orkl.eu/9af5be97efbcd8023c4eaf7d48cd028c09f3f30a.jpg"
    }
}