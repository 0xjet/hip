{
    "id": "9874fb26-c464-4c40-a9f8-6d2dcb76a8e8",
    "created_at": "2023-01-12T15:09:18.811235Z",
    "updated_at": "2025-03-27T02:05:42.816261Z",
    "deleted_at": null,
    "sha1_hash": "05af53d2804bf43bace407d868f11917e8c792b3",
    "title": "2022-03-15 - Threat Advisory- CaddyWiper",
    "authors": "",
    "file_creation_date": "2022-05-28T21:44:15Z",
    "file_modification_date": "2022-05-28T21:44:15Z",
    "file_size": 524596,
    "plain_text": "# Threat Advisory: CaddyWiper\n\n**[blog.talosintelligence.com/2022/03/threat-advisory-caddywiper.html](https://blog.talosintelligence.com/2022/03/threat-advisory-caddywiper.html)**\n\n**This post is also available in:**\n\n[日本語 (Japanese)](https://gblogs.cisco.com/jp/2022/03/talos-threat-advisory-caddywiper/)\n\n[Українська (Ukrainian)](https://talosintelligence.com/resources/433)\n\n## Overview\n\n[Cybersecurity company ESET disclosed another Ukraine-focused wiper dubbed](https://twitter.com/ESETresearch/status/1503436420886712321)\n\"CaddyWiper\" on March 14. This wiper is relatively smaller than previous wiper attacks we've\n[seen in Ukraine such as \"HermeticWiper\" and \"WhisperGate,\" with a compiled size of just](https://blog.talosintelligence.com/2022/02/threat-advisory-hermeticwiper.html)\n9KB.\n\nThe wiper discovered has the same compilation timestamp day (March 14) and initial reports\nsuggest that it was deployed via GPO.\n\nCisco Talos is actively conducting analysis to confirm the details included in these reports.\n\n## Analysis\n\n\n-----\n\nThe wiper is relatively small in size and dynamically resolves most of the APIs it uses. Our\nanalysis didn't show any indications of persistency, self-propagation or exploitation code.\n\nBefore starting any file destruction, it checks to ensure that the machine is not a domain\ncontroller. If the machine is a domain controller, it stops execution.\n\nPseudo-code: CaddyWiper checking for the Domain Controller role of the machine.\n\nIf the system is not a domain controller, the wiper will destroy files on \"C:\\Users,\" followed by\nwiping of all files in the next drive letter until it reaches the \"Z\" drive. This means that the\n\n\n-----\n\nwiper will also attempt to wipe any network mapped drive attached to the system.\n\nFile in drives with letters from D:\\ overwritten with zeros.\n\nThis ensures that the system will not crash due to the wipe of system files.\n\n### File wiping algorithm\n\nThe file destruction algorithm is composed of two stages: a first stage to overwrite files and\nanother to destroy the physical disk layout and the partition tables along with it. For the file\ndestruction, it takes ownership of the files by modifying their ACL entries after it has obtained\n[the 'SeTakeOwnershipPrivilege'. A file found will then simply be overwritten with zeros.](https://docs.microsoft.com/en-us/windows/win32/secauthz/privilege-constants)\n\n\n-----\n\nA file that is larger than 10,485,760 bytes (0xA00000) in size will simply have the first\n10,485,760 bytes overwritten with zeros.\n\nFile overwritten with a buffer consisting of zeros.\n\nThe wiper will then move on to the next drive on the system beginning with the \"D\" drive. It\nwill recursively gain rights to files on a drive and overwrite them with zeros. This is done for\nthe next 23 drives alphabetically (through \"Z:\\\").\n\nOn the second stage, the wiper attempts to set the drive layout of all the physical drives on\n[the system numbered 9 to 0. This will wipe out all extended information about the physical](https://docs.microsoft.com/en-us/windows/win32/api/winioctl/ns-winioctl-drive_layout_information_ex)\ndrive's partitions including MBR, GPT and partition entries.\n\n\n-----\n\nWiper recursively performing IOCTL_DISK_SET_DRIVE_LAYOUT_EX requests with a\nzeroed out buffer.\n\nDestroying the start of the files and the partitions tables is a common technique seen on\nother wipers, and its highly effective in preventing the file recovery.\n\n## Coverage\n\nWays our customers can detect and block this threat are listed below.\n\n\n-----\n\n[Cisco Secure Endpoint (formerly AMP for Endpoints) is ideally suited to prevent the](https://www.cisco.com/c/en/us/products/security/amp-for-endpoints/index.html)\n[execution of the malware detailed in this post. Try Secure Endpoint for free here.](https://www.cisco.com/c/en/us/products/security/amp-for-endpoints/free-trial.html?utm_medium%3Dweb-referral?utm_source%3Dcisco%26utm_campaign%3Damp-free-trial%26utm_term%3Dpgm-talos-trial%26utm_content%3Damp-free-trial)\n\n[Cisco Secure Web Appliance web scanning prevents access to malicious websites and](https://www.cisco.com/c/en/us/products/security/web-security-appliance/index.html)\ndetects malware used in these attacks.\n\n[Cisco Secure Email (formerly Cisco Email Security) can block malicious emails sent by](https://www.cisco.com/c/en/us/products/security/email-security/index.html)\nthreat actors as part of their campaign. You can try Secure Email for free [here.](https://www.cisco.com/c/en/us/products/security/cloud-mailbox-defense?utm_medium%3Dweb-referral%26utm_source%3Dcisco%26utm_campaign%3Dcmd-free-trial-request%26utm_term%3Dpgm-talos-trial)\n\n[Cisco Secure Firewall (formerly Next-Generation Firewall and Firepower NGFW) appliances](https://www.cisco.com/c/en/us/products/security/firewalls/index.html)\n[such as Firepower Threat Defense (FTD), Firepower Device Manager (FDM),](https://www.cisco.com/c/en/us/products/security/security-management/firepower-device-manager.html) Threat\nDefense Virtual, [Adaptive Security Appliance can detect malicious activity associated with](https://www.cisco.com/c/en/us/products/security/adaptive-security-appliance-asa-software/index.html)\nthis threat.\n\n\n-----\n\n[Cisco Secure Malware Analytics (formerly Threat Grid) identifies malicious binaries and](https://www.cisco.com/c/en/us/products/security/threat-grid/index.html)\nbuilds protection into all Cisco Secure products.\n\n[Cisco Secure Network/Cloud Analytics (Stealthwatch/Stealthwatch Cloud) analyzes network](https://www.cisco.com/c/en/us/products/security/stealthwatch/index.html)\ntraffic automatically and alerts users of potentially unwanted activity on every connected\ndevice.\n\n[For guidance on using Cisco Secure Analytics to respond to this threat, please click here.](https://blogs.cisco.com/security/how-to-respond-to-apache-log4j-using-cisco-secure-analytics)\n\n[Meraki MX appliances can detect malicious activity associated with this threat.](https://meraki.cisco.com/products/appliances)\n\n[Umbrella, Secure Internet Gateway (SIG), blocks users from connecting to malicious](https://umbrella.cisco.com/)\ndomains, IPs and URLs, whether users are on or off the corporate network. Sign up for a\n[free trial of Umbrella here.](https://signup.umbrella.com/?utm_medium%3Dweb-referral?utm_source%3Dcisco%26utm_campaign%3Dumbrella-free-trial%26utm_term%3Dpgm-talos-trial%26utm_content%3Dautomated-free-trial)\n\nAdditional protections with context to your specific environment and threat data are available\nfrom the [Firewall Management Center.](https://www.cisco.com/c/en/us/products/security/firepower-management-center/index.html)\n\n[Cisco Duo provides multi-factor authentication for users to ensure only those authorized are](https://signup.duo.com/?utm_source%3Dtalos%26utm_medium%3Dreferral%26utm_campaign%3Dduo-free-trial)\naccessing your network.\n\nOpen-source Snort Subscriber Rule Set customers can stay up to date by downloading the\n[latest rule pack available for purchase on Snort.org.](https://www.snort.org/products)\n\nSnort SIDs: 59268-59269\n\nThe following ClamAV signatures available for protection against this threat:\n\nWin.Malware.CaddyWiper-9941573-1\n\n## IOCs\n\na294620543334a721a2ae8eaaf9680a0786f4b9a216d75b55cfd28f39e9430ea\n1e87e9b5ee7597bdce796490f3ee09211df48ba1d11f6e2f5b255f05cc0ba176\nea6a416b320f32261da8dafcf2faf088924f99a3a84f7b43b964637ea87aef72\n\nf1e8844dbfc812d39f369e7670545a29efef6764d673038b1c3edd11561d6902\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-03-15 - Threat Advisory- CaddyWiper.pdf"
    ],
    "report_names": [
        "2022-03-15 - Threat Advisory- CaddyWiper.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673536158,
    "ts_updated_at": 1743041142,
    "ts_creation_date": 1653774255,
    "ts_modification_date": 1653774255,
    "files": {
        "pdf": "https://archive.orkl.eu/05af53d2804bf43bace407d868f11917e8c792b3.pdf",
        "text": "https://archive.orkl.eu/05af53d2804bf43bace407d868f11917e8c792b3.txt",
        "img": "https://archive.orkl.eu/05af53d2804bf43bace407d868f11917e8c792b3.jpg"
    }
}