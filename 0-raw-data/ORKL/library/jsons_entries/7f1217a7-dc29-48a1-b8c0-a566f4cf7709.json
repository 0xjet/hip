{
    "id": "7f1217a7-dc29-48a1-b8c0-a566f4cf7709",
    "created_at": "2022-10-25T16:48:15.048705Z",
    "updated_at": "2025-03-27T02:16:26.49911Z",
    "deleted_at": null,
    "sha1_hash": "9767abff87b137695ab8481729ed7130499a0c80",
    "title": "New Cdto: A Sneakernet Trojan Solution",
    "authors": "Fidelis",
    "file_creation_date": "2014-01-15T22:52:33Z",
    "file_modification_date": "2014-01-15T22:52:33Z",
    "file_size": 130835,
    "plain_text": "#### Fidelis \r Threat \r Advisory \r #1011 \r \n\n# “New \r CDTO: \r A \r Sneakernet \r Trojan \r Solution”\n\nJanuary \r 15, \r 2014\n\nDocument \r Status: \r FINAL\nLast \r Revised: \r 2014-­‐01-­‐15\n\n**Executive \r Summary:**\n\nThe \r General \r Dynamics \r Fidelis \r Cybersecurity \r forensics \r team \r analyzed \r several \r related \r malware\nsamples \r that \r together \r provide \r a \r sophisticated \r mechanism \r to \r gather \r data \r from \r individual \r computer\nsystems. \r  \r The \r malware \r appears \r to \r be \r part \r of \r a \r system \r that \r may \r be \r optimized \r for \r use \r by \r an \r insider\nagent \r and/or \r for \r collecting \r data \r from \r disparate \r networks \r or \r air-­‐gapped \r systems. \r  \r The \r malware\nincludes \r features \r to \r clean \r up \r after \r itself \r by \r deleting \r key \r indicators \r that \r it \r was \r present.\n\nThe \r malware \r system \r apparently \r includes \r additional \r components \r that \r have \r not \r been \r identified.\nThese \r components \r would \r potentially \r perform \r additional \r command \r and \r control \r functions \r and\npotentially \r exfiltration \r from \r the \r central \r host. \r  \r The \r sophistication \r of \r the \r malware \r and \r the \r effort\ninvolved \r in \r its \r development \r would \r indicate \r that \r it \r was \r developed \r for \r a \r high \r value \r target. \r  \r However,\nthe \r specific \r targeting \r of \r this \r malware \r is \r not \r clear \r at \r this \r time. \r  \r We \r are \r concerned \r that \r while \r the\nmalware \r system \r was \r probably \r developed \r for \r a \r specific \r target \r or \r family \r of \r targets, \r it \r could \r be\nemployed \r with \r little \r adaptation \r against \r virtually \r any \r target.\n\nThis \r threat \r advisory \r describes \r the \r functionality \r of \r the \r three \r malware \r files \r to \r include \r command\ninputs \r and \r the \r resulting \r behavior \r of \r the \r malware.\n\nThe \r Fidelis \r XPS™ \r advanced \r threat \r defense \r system \r has \r been \r updated \r with \r rules \r to \r detect \r various\ncomponents \r of \r this \r malware \r system. \r  \r However, \r the fact \r there \r are \r still \r unanswered \r questions \r about\nthe \r components \r of \r the \r malware \r system \r and \r its \r intended \r targeting, \r emphasizes \r the \r importance \r of\nemploying \r that \r best \r practices \r such \r as \r denying \r use \r of \r removable \r media \r on \r sensitive \r systems \r and\ndisabling \r autorun! \r  \r This \r is \r particularly \r true \r for \r systems \r that \r are \r not \r protected \r by \r Fidelis \r XPS.\n\nAdditional \r reverse \r engineering \r and \r analysis \r is \r on-­‐going \r at \r this \r time.\n\n**Forensic \r Analysis \r Findings:**\n\nOn \r 8 \r Jan \r 2014, \r The \r Fidelis \r Network \r Defense \r and \r Forensics \r team \r received \r three \r files: \r netsat.exe,\nnetui3.dll \r and \r winmgt.dll. \r All \r three \r files \r were \r 32 \r bit \r executable \r files. \r Preliminary \r analysis \r disclosed\nnetsat.exe \r would \r terminate \r when \r run \r if \r the \r system \r date \r was \r on \r or \r after \r 21 \r Jun \r 2013. \r The \r submitted\nfiles \r appeared \r to \r represent \r two \r parts \r of \r a \r suspected \r data \r collection \r scheme. \r Essentially, \r netsat.exe\nappeared \r to \r operate \r as \r a \r master \r program \r that \r infected \r removable \r media \r connected \r to \r the \r system\nwhereon \r it \r was \r running \r and \r collected \r data \r from \r infected \r drives \r when \r the \r drives \r returned.\nnetsat.exe \r received \r commands \r from \r an \r encrypted \r file \r stored \r on \r the \r local \r system. \r The \r infection \r was\nin \r the \r form \r of \r a \r renamed \r netui3.dll \r or \r winmgt.dll \r file \r along \r with \r an \r Autorun.inf \r file \r set \r to \r run \r the\nrenamed \r netui3.dll/winmgt.dll \r when \r the \r infected \r drive \r was \r connected \r to \r a \r target \r host. \r There \r could\n\n\n-----\n\nbe \r many \r iterations \r of \r netsat.exe \r running \r on \r enterprise \r or \r targeted \r entity \r systems. \r Based \r on\navailable \r analysis \r results, \r netsat.exe \r could \r collect \r surreptitiously \r gathered \r data \r from \r any \r infected\ndrive \r connected \r to \r the \r system \r whereon \r netsat.exe \r was \r running, \r e.g., \r the \r infected \r drive \r would \r not\nhave \r to \r be \r processed \r by \r the \r same \r system \r whereon \r it \r became \r infected. \r Data, \r in \r the \r form \r of \r files,\ndestined \r for \r exfiltration \r may \r be \r obfuscated \r via \r a \r custom \r XOR \r operation. \r The \r gathered \r data \r would\nostensibly \r be \r exfiltrated \r via \r other \r means.\n\nSome \r components \r of \r the \r malware’s \r behavior \r are \r possibly \r remarkable. \r Quickly \r considering \r these\nresults \r in \r cursory \r questions \r reflected \r as \r follows:\n\n  - Command \r and \r Control \r (C2) \r appears \r to \r be \r accomplished \r via \r providing \r commands \r in \r an\nencrypted \r file \r stored \r on \r the \r local \r ‘master’ \r system \r (re: \r netsat.exe). \r This \r C2 \r scheme \r would\nseem \r to \r dictate:\n\n`o` Intruder \r remote \r access \r to \r the \r ‘master’ \r system\n`o` Intruder \r local \r access \r to \r the \r ‘master’ \r system\n`o` a \r C2 \r delivery/retrieval \r component, \r such \r as \r another \r piece \r of \r code \r that \r downloads \r a\n\nC2 \r file\n\n  - Available \r information \r precludes \r determination \r of \r the \r means \r of \r exfiltration. \r netsat.exe’s\ndata \r collection \r functionality \r suggested \r data \r destined \r for \r exfiltration \r might \r be \r collected \r by\nthe \r ‘master’ \r system. \r This \r possibility \r suggests:\n\n`o` Intruder \r remote \r access \r to \r the \r ‘master’ \r system\n`o` Intruder \r local \r access \r to \r the \r ‘master’ \r system\n`o` An \r exfiltration \r mechanism \r in \r the \r form \r of \r another \r piece \r of \r code\n\n**Detection**\n\nScanning \r with \r several \r select \r third \r party \r malware \r detection \r applications \r resulted \r in \r zero\ndetections.\n\nCursory \r online \r research \r disclosed \r a \r file \r named \r netui3.dll \r was \r possibly \r submitted \r to\nVirSCAN.org \r on \r or \r before \r 2 \r Dec \r 2013. \r The \r name \r netui3.dll \r appears \r to \r have \r been \r used \r for\nmalware \r in \r the \r past \r and \r was \r likely \r associated \r with \r a \r backdoor. \r The \r name \r may \r be \r a \r play \r on\nthe \r name \r netui2.dll, \r a \r legitimate \r Windows \r file \r name.\n\n**File \r System \r Artifacts**\n\nFile \r Name: \r  \r netsat.exe\nFile \r Size: \r  \r 43520 \r bytes\nMD5: \r  \r  \r  \r  \r  \r  \r  \r eb8399483b55f416e48a320d68597d72\nSHA1: \r  \r  \r  \r  \r  \r  \r 8a7183b7ceb30517460b6ab614551ca38e915309\nPE \r Time: \r  \r  \r  \r 0x5154F7F2 \r [Fri \r Mar \r 29 \r 02:09:54 \r 2013 \r UTC]\nSections \r (4):\nName \r  \r  \r  \r  \r  \r Entropy \r  \r MD5\n.text \r  \r  \r  \r  \r 6.37 \r  \r  \r  \r  \r df1790813aca1265bc475f3891957512\n.rdata \r  \r  \r  \r 5.19 \r  \r  \r  \r  \r a598dca4a8fe8ee17941fa60be746d31\n\n\n-----\n\n.data \r  \r  \r  \r  \r 0.29 \r  \r  \r  \r  \r b3d1c1a0b1054a082c841ebd1354755f\n.rsrc \r  \r  \r  \r  \r 3.34 \r  \r  \r  \r  \r d4b9539426ff130b80e11efec7465acd\n\nFile \r Name: \r  \r netui3.dll\nFile \r Size: \r  \r 39424 \r bytes\nMD5: \r  \r  \r  \r  \r  \r  \r  \r 68aed7b1f171b928913780d5b21f7617\nSHA1: \r  \r  \r  \r  \r  \r  \r 44e711e95311b81d597a7800d96482b873cb8235\nPE \r Time: \r  \r  \r  \r 0x5152AE99 \r [Wed \r Mar \r 27 \r 08:32:25 \r 2013 \r UTC]\nSections \r (3):\nName \r  \r  \r  \r  \r  \r Entropy \r  \r MD5\n.text \r  \r  \r  \r  \r 6.37 \r  \r  \r  \r  \r b2a939d2ad678201560285287e7dca1d\n.rdata \r  \r  \r  \r 5.32 \r  \r  \r  \r  \r 2cd54a2d2ada8650c9bd9eae69aef3ca\n.data \r  \r  \r  \r  \r 0.58 \r  \r  \r  \r  \r 70a79ca0958afad5b7742641b2cff9ea\n\nFile \r Name: \r  \r winmgt.dll\nFile \r Size: \r  \r 37888 \r bytes\nMD5: \r  \r  \r  \r  \r  \r  \r  \r 54e4a15a68cfbb2314d0aaad455fbfce\nSHA1: \r  \r  \r  \r  \r  \r  \r 49531b098049ae52264ae9b398c2cf59ff5379bc\nPE \r Time: \r  \r  \r  \r 0x50CAEAE4 \r [Fri \r Dec \r 14 \r 09:01:24 \r 2012 \r UTC]\nSections \r (3):\nName \r  \r  \r  \r  \r  \r Entropy \r  \r MD5\n.text \r  \r  \r  \r  \r 6.31 \r  \r  \r  \r  \r 6a0f9499f4ca8e0b2e4f09b9126806e6\n.rdata \r  \r  \r  \r 5.23 \r  \r  \r  \r  \r e49920b9ebad63f0d95bad505ea8fdf7\n.data \r  \r  \r  \r  \r 0.59 \r  \r  \r  \r  \r a583b2c8490a7f0fcaee2f4776e445d8\n\n**Date \r Checking**\n\nAll \r three \r submitted \r files \r compared \r the \r system \r date \r and \r time \r to \r hard \r coded \r dates \r upon\nexecution. \r If \r the \r system \r date \r was \r after \r the \r hard \r coded \r dates, \r the \r malware \r would \r delete \r itself\nand \r terminate. \r The \r following \r table \r illustrates \r the \r hard \r coded \r dates \r in \r relation \r to \r the \r affected\nfiles’ \r PE \r dates:\n\n**File \r Name** **PE \r Timestamp** **Date \r Checked \r Within \r Executable \r Image**\n**Date**\n\nnetsat.exe 29 \r Mar \r 2013 21 \r Jun \r 2013 \r (Deletes \r itself \r and \r associated \r files \r after \r this \r date)\n\nnetui3.dll 27 \r Mar \r 2013 31 \r May \r 2013 \r (Deletes \r itself \r and \r associated \r files \r after \r this\ndate)\n\nwinmgt.dll 14 \r Dec \r  \r 2012 30 \r Dec \r 2012 \r (Deletes \r itself \r and \r associated \r files \r after \r this\ndate)\n\n**Versioning, \r etc.**\n\nThe \r following \r version \r information \r was \r recorded \r in \r the \r netsat.exe \r executable:\n\n|File Name|PE Timestamp Date|Date Checked Within Executable Image|\n|---|---|---|\n|netsat.exe|29 Mar 2013|21 Jun 2013 (Deletes itself and associated files after this date)|\n|netui3.dll|27 Mar 2013|31 May 2013 (Deletes itself and associated files after this date)|\n|winmgt.dll|14 Dec 2012|30 Dec 2012 (Deletes itself and associated files after this date)|\n\n\n-----\n\nChild \r Type: \r  \r  \r  \r  \r  \r  \r  \r  \r StringFileInfo\nLanguage/Code \r Page: \r 1033/1200\nCompanyName: \r  \r  \r  \r  \r  \r  \r  \r Microsoft \r Corporation\nFileDescription: \r  \r  \r  \r Cdto \r Netware \r 2.12 \r Provider\nFileVersion: \r  \r  \r  \r  \r  \r  \r  \r 5.1.2600.0 \r (xpclient.010817-­‐1148)\nInternalName: \r  \r  \r  \r  \r  \r  \r NEWCDTO\nLegalCopyright: \r  \r  \r  \r  \r  \r Microsoft \r Corporation. \r All \r rights \r reserved.\nOriginalFilename: \r  \r  \r cdto.dll\nProductName: \r  \r  \r  \r  \r  \r  \r  \r  \r Microsoft \r Corporation. \r All \r rights \r reserved.\nProductVersion: \r  \r  \r  \r  \r 5, \r 1, \r 2600, \r 0\n\nChild \r Type: \r  \r  \r  \r  \r  \r  \r  \r  \r VarFileInfo\nTranslation: \r  \r  \r  \r  \r  \r  \r  \r 1033/1200\n\nThe \r Language/Code \r Page \r code \r 1033 \r denotes \r U.S. \r English. \r This \r versioning \r information\nappears \r contrived. \r However, \r it \r looks \r convincing \r enough \r to \r pass \r cursory \r inspection, \r i.e.,\nthe \r format \r appears \r legitimate \r and \r the \r appearance \r does \r not \r engender \r suspicion. \r Cursory\nonline \r searches \r failed \r to \r disclose \r what, \r if \r anything \r Cdto \r might \r be \r associated \r with.\n\nScanning \r disclosed \r the \r file \r contained \r a \r function \r possibly \r associated \r with \r TEAN\nencryption. \r This \r appeared \r to \r indicate \r TEA \r (Tiny \r Encryption \r Algorithm) \r involvement.\n(Note: \r The \r encryption \r is \r used \r to \r encrypt \r commands \r stored \r in \r a \r file \r on \r the \r local \r system.)\n\nThe \r submitted \r files \r named \r netui3.dll \r and \r winmgt.dll \r did \r not \r have \r embedded \r versioning\nInformation \r like \r netsat.exe \r did.\n\n**Files \r and \r paths**\n\nThe \r presence \r of \r the \r following \r files \r may \r indicate \r netsat.exe, \r et \r al, \r involvement:\n\nCSIDL_WINDOWS\\msagent\\ \r netui3.dll\nNetui3.dll \r in \r any \r path\nCSIDL_WINDOWS\\msagent\\ \r netwn.drv\nNetwn.drv \r in \r any \r path\nCSIDL_MYPICTURES\\winsSetup35.exe \r in \r any \r path\nSetup23.exe \r in \r any \r path\nCSIDL_NETHOOD\\Microsoft\\Windows\\Help\\set.fl\nCSIDL_LOCAL_APPDATA\\Microsoft\\Windows\\Help\\intr\nCSIDL_NETHOOD\\Microsoft\\Windows\\Chars\\ferf.st\nCSIDL_NETHOOD\\Microsoft\\Windows\\Chars\\fert.st\nCSIDL_LOCAL_APPDATA\\Microsoft\\Windows\\Chars\\intr\nCSIDL_NETHOOD\\Microsoft\\Windows\\message\\\nCSIDL_NETHOOD\\Microsoft\\Windows\\Intel\\\nAct.te \r in \r any \r path\n\n\n-----\n\nu.t \r in \r any \r path\nnetwi.drv \r in \r any \r path\n~FF325I.tmp \r or \r ~FF323D.tmp \r in \r the \r path \r specified \r by \r the \r TMP. \r TEMP. \r or \r USERPROFILE\nenvironment \r variables \r or \r the \r Windows \r directory\n\nThe \r presence \r of \r the \r following, \r specifically \r on \r removable \r media, \r may \r indicate \r netsat.exe, \r et\nal, \r involvement:\n\nAutorun.inf \r file \r containing \r the \r file \r name \r setup35.exe \r or \r possibly \r setup23.exe\nRECYCLER\\RECYCLED\\SYS\nRECYCLED\\RECYCLED\\SYS\nRECYCLED\\RECYCLED\\SYS\\desktop.ini \r (Won't \r be \r visible \r via \r GUI)\nRECYCLER\\RECYCLED\\SYS\\desktop.ini \r (Won't \r be \r visible \r via \r GUI)\n~disk.ini\n\n**Registry**\n\nCursory \r analysis \r did \r not \r disclose \r entrenchment \r data, \r such \r as \r a \r Registry \r entry \r to \r ensure\npersistence.\n\n**Network \r Artifacts:**\n\nThis \r cursory \r analysis \r disclosed \r no \r network \r artifacts \r specific \r to \r the \r malware’s \r operation. \r However,\nevidence \r of \r any \r of \r the \r files \r involved \r (MD5, \r strings, \r file \r names) \r traversing \r the \r network, \r e.g., \r on \r the\nmove, \r may \r be \r indicative \r of \r netsat.exe, \r et \r al \r presence. \r Given \r what \r was \r revealed \r during \r this \r cursory\nanalysis, \r finding \r string \r and \r or \r hash \r artifacts \r in \r SMB \r traffic \r seemed \r the \r most \r likely \r possibility \r with\nregard \r to \r network \r detection.\n\n**Strings:**\n\nnetsat.exe\n\nThe \r following \r interesting \r strings \r were \r noted \r in \r the \r raw \r netsat.exe \r file:\n\nVMProtect \r begin\nVMProtect \r end\n! \r Path \r -­‐-­‐ \r > \r %s \r to \r Added\n! \r Pathlen \r = \r %u\nAddInit \r -­‐> \r ci.DestFile:%s\n!ad \r dri, \r nD=%d\nnetui3.dll\nnetwi.drv\nGlobal\\Mtx_Sp_On_PC_1_2_8\n\n\n-----\n\nCdto \r Netware \r 2.12 \r Provider\n!Cr \r Des\n!Cr \r De.i. \r err=%d\nsetup35.exe\nsetup23.exe\nact.te\nferf.st\nfert.st\nnetwn.drv\nD \r c \r p\nD \r c \r u\nSystemPriClass\n!Cr \r ne \r j\n\nNetui3.dll\n\nThe \r following \r interesting \r strings \r were \r noted \r in \r the \r raw \r netui3.dll \r file:\n\nset.fl\nsetup35.exe\nsetup32.exe\nact.te\nferf.st\nfert.st\nu.t\nsetup23.exe\n%s \r -­‐wu \r %s\n%s \r -­‐ws \r %s\nNo \r j \r n\nMtx_Sp_On_PC_1_2_8\nSystemPriClass\n\nWinmgt.dll\n\nThe \r following \r interesting \r strings \r were \r noted \r in \r the \r raw \r winmgt.dll \r file:\n\nset.fl\nsetup35.exe\nsetup32.exe\nact.te\nferf.st\nfert.st\nu.t\n\n\n-----\n\n%s \r -­‐wu \r %s\nNo \r j \r n\nMtx_Sp_On_PC_1_2_8\n\\wins.log\nSystemPriClass\n\n**Functionality:**\n\nBased \r on \r netsat.exe \r manipulating \r a \r file \r named \r netui3.dll, \r the \r submitted \r netsat.exe \r and\nnetui3.dll \r appeared \r associated. \r Versioning \r is \r possible. \r For \r example, \r the \r submitted \r netui3.dll\nsample \r may \r not \r match \r the \r submitted \r netsat.exe \r sample \r in \r terms \r of \r versioning. \r However,\nanalysis \r assumed, \r for \r the \r sake \r of \r efficiency, \r that \r the \r submitted \r netui3.dll \r and \r submitted\nnetsat.exe \r file \r were \r associated. \r The \r submitted \r winmgt.dll \r file \r appeared \r very \r similar \r to\nnetui3.dll. \r However, \r some \r differences \r suggested \r the \r two \r files \r represented \r disparate \r versions.\n\nAnalysis \r disclosed \r date \r sensitivity \r built \r into \r the \r submitted \r files. \r If \r the \r sample \r was \r run \r after \r a\nparticular \r date, \r it \r would \r effectively \r terminate \r and \r delete \r itself:\n\n**File \r Name** **PE \r Timestamp** **Date \r Checked \r Within \r Executable \r Image**\n**Date**\n\nnetsat.exe 29 \r Mar \r 2013 21 \r Jun \r 2013 \r (Deletes \r itself \r and \r associated \r files \r after \r this \r date)\n\nnetui3.dll 27 \r Mar \r 2013 31 \r May \r 2013 \r (Deletes \r itself \r and \r associated \r files \r after \r this\ndate)\n\nwinmgt.dll 14 \r Dec \r  \r 2012 30 \r Dec \r 2012 \r (Deletes \r itself \r and \r associated \r files \r after \r this\ndate)\n\nAnalysis \r disclosed \r netsat.exe \r probably \r serves \r as \r the \r headquarters \r of \r malicious \r activity \r by:\n\n    - Running \r on \r a \r possibly \r compromised \r system\n\n    - Logging \r some \r activity \r and \r errors \r to \r a \r file\n\n    - Receiving \r commands \r via \r an \r encrypted \r file \r on \r the \r local \r system \r (possible \r C2)\n\n    - Listening \r for \r drive \r connections\n\n    - Infecting \r connected \r drives \r with \r netui3.dll/winmgt.dll \r (setup32.exe \r + \r Autorun.inf)\n\n    - Collecting \r data \r gathered \r by \r any \r infected \r drives, \r ostensibly \r upon \r their \r return \r from \r being\nconnected \r to \r other \r systems\n\nAnalysis \r disclosed \r netui3.dll/winmgt.dll \r probably \r serve \r as \r the \r field \r units \r of \r malicious \r activity\nby:\n\n|File Name|PE Timestamp Date|Date Checked Within Executable Image|\n|---|---|---|\n|netsat.exe|29 Mar 2013|21 Jun 2013 (Deletes itself and associated files after this date)|\n|netui3.dll|27 Mar 2013|31 May 2013 (Deletes itself and associated files after this date)|\n|winmgt.dll|14 Dec 2012|30 Dec 2012 (Deletes itself and associated files after this date)|\n\n\n-----\n\n- Collecting \r information \r about \r systems \r it \r comes \r into \r contact \r with \r through \r connection \r to\nthe \r targeted \r systems \r with \r the \r drive \r whereon \r the \r malware \r resides\n\n`o` _IP_\n`o` _Platform_\n`o` _Name_\n`o` _Version_\n`o` _Type_\n`o` _Primary \r or \r Backup \r Domain \r Controller \r (PDC \r or \r BDC)_\n`o` _Determines \r network \r join \r status \r (none, \r workgroup, \r domain) \r via_\n\n_NetGetJoinInformation \r API_\n`o` _Detailed \r OS \r version_\n`o` _Running \r Time_\n`o` _Computer \r Name_\n`o` _User \r Name_\n`o` _System \r Directory_\n`o` _Current \r Date \r and \r Time_\n`o` _Locale \r Information \r (Country \r and \r Language)_\n`o` _Drive \r info \r (total/free \r size, \r type, \r etc.)_\n`o` _Network \r Adapter \r description_\n`o` _IP \r Address_\n`o` _IP \r Mask_\n`o` _Gateway \r IP_\n`o` _Recursive \r directory \r listings_\n`o` _Enumerates \r normal \r user \r account \r names_\n\n- Collecting \r file \r listings \r from \r local \r and \r share \r connected \r drives\n\n- Discovering \r and \r connecting \r to \r shared \r drives \r visible \r to \r the \r local \r targeted \r system\n\n- Copying \r and \r writing \r files \r to/from \r drives \r visible \r to \r the \r local \r targeted \r system\n\n**Commands**\n\nThe \r following \r commands \r and \r their \r descriptions, \r listed \r by \r executable \r file, \r illustrate \r the\nsubmitted \r malware’s \r functionality:\n\n|netsat.exe Command Description|Col2|\n|---|---|\n|Cpd|copies directories and contents|\n|Cpr|copies files with size checking|\n|Der|deletes files and records activity in log|\n|Dir|obtains a directory listing|\n\n\n-----\n\niteratively \r copies \r files \r from \r RECYCLED/RECYCLER \r directory\non \r target\ndrive, \r deletes \r from \r source \r after \r copy \r -­‐ \r source \r is \r assumed \r to\nbe\ndrive used to collect data from one or more systems\n\n|netsat.exe Command Description|Col2|\n|---|---|\n|Ferry|writes malicious files to a hidden RECYCLED or RECYCLER directory Files: setup35.exe (renamed netui3.dll), Autorun.inf, ~disk.ini (renamed netwi.drv), act.te|\n|Getres|iteratively copies files from RECYCLED/RECYCLER directory on target drive, deletes from source after copy -­‐ source is assumed to be drive used to collect data from one or more systems|\n\n|netui3.dll (setup35.exe) Command Description|Col2|\n|---|---|\n|Cp|copies files from one location to another|\n|Cpu|copies files from one location to another setting copied files as hidden|\n|Cptur|creates a directory and copies file to that directory|\n|Ddr|silently deletes directory (performs an FO_DELETE shell file operation on a directory with the FOF_NOERRORUI, FOF_NOCONFIRMATION, and FOF_SILENT flags set)|\n|Del|deletes a file|\n|Delu|deletes a file after setting attributes to normal|\n|Gd|recursively writes and reads encoded data to/from a directory|\n|Gdir|prints directory listings to ~FF323D.tmp; data gets encoded; original ~FF323D.tmp file is deleted|\n|Gf|writes and reads encoded data to/from a file|\n|Gfover|determines if it has access to a file; may be a temp file creation/rename involved|\n|Gi|collects system related and possibly network related information such as, domains, system information|\n|Ndr|creates a directory|\n|Newend|closes a file that was opened for writing|\n|Newstar|sets normal attributes on a targeted file, deletes the file, opens the same file name as a binary file|\n|Wr|writes a string to a new file opened by the newstar command.|\n|Runb|try to run a targeted executable and then checks for the existence of that file every second for the next 15 minutes as long as it exists|\n\n\n-----\n\nuses \r NetUseAdd \r to \r connect \r to \r ipc$ \r share \r of \r a \r target \r host, \r creates \r a\nlisting \r of \r files \r in \r the \r c$ \r -­‐ \r z$ \r shares \r of \r the \r target \r host,\ncopies \r the \r files \r to \r a \r new \r location, \r deletes \r the \r share \r connection \r added\n\nSrmf using NetuseAdd\n\nNote: \r rows \r highlighted \r in \r grey \r denote \r a \r best \r guess \r on \r functionality; \r more \r analysis\nwas pending at the time of this report\n\n**Conclusions:**\n\nThis \r advisory \r is \r based \r on \r preliminary \r information. \r  \r It \r is \r important \r to \r note \r that \r reverse \r engineering\nand \r analysis \r of \r the \r malware \r system \r is \r still \r underway. \r  \r We \r expect \r to \r provide \r additional \r data, \r and\nsome \r of \r this \r information \r may \r change \r as \r a \r result \r of \r continued \r research.\n\nHowever, \r due \r to \r the \r unique \r functionality \r of \r malware \r system \r and \r its \r potential \r for \r employment\nagainst \r targets \r beyond \r the \r initially \r intended \r victim, \r the \r network \r security \r community \r should \r be\nconcerned \r and \r track \r this \r malware \r closely.\n\nWhile \r we \r have \r updated \r the \r Fidelis \r XPS \r system \r to \r detect \r known \r components \r of \r the \r malware \r family,\nthis \r package \r reemphasizes \r the \r importance \r of \r employing \r good \r basic \r network \r security \r practices \r such\nas \r denying \r use \r of \r removable \r media \r on \r sensitive \r systems \r and \r disabling \r autorun!\n\n|netui3.dll (setup35.exe) Command Description|Col2|\n|---|---|\n|Rune|try to run a targeted executable one time|\n|Slf|generates a targeted file listing, e.g., dir, then copies the files in the list one by one|\n|Srf|copies files in a list one by one|\n|Srmf|uses NetUseAdd to connect to ipc$ share of a target host, creates a listing of files in the c$ -­‐ z$ shares of the target host, copies the files to a new location, deletes the share connection added using NetuseAdd|\n|Note: rows highlighted in grey denote a best guess on functionality; more analysis was pending at the time of this report||\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "d63ae2b7-445f-460d-965d-2676dacdb6de",
            "created_at": "2022-10-25T15:59:19.552139Z",
            "updated_at": "2022-10-25T15:59:19.552139Z",
            "deleted_at": null,
            "name": "APTnotes",
            "url": "https://github.com/aptnotes/data",
            "description": "APTnotes data",
            "reports": null
        },
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        }
    ],
    "references": [
        "https://app.box.com/s/63rg0wfr0ki2xvtt7ja1b7lmn7dspcdc",
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2014/2014.01.15.Sneakernet_Trojan/FTA%201001%20FINAL%201.15.14.pdf"
    ],
    "report_names": [
        "FTA 1001 FINAL 1.15.14"
    ],
    "threat_actors": [
        {
            "id": "67bf0462-41a3-4da5-b876-187e9ef7c375",
            "created_at": "2022-10-25T16:07:23.44832Z",
            "updated_at": "2025-03-27T02:02:09.806007Z",
            "deleted_at": null,
            "main_name": "Careto",
            "aliases": [
                "Careto",
                "The Mask",
                "Ugly Face"
            ],
            "source_name": "ETDA:Careto",
            "tools": [
                "Careto"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "75108fc1-7f6a-450e-b024-10284f3f62bb",
            "created_at": "2024-11-01T02:00:52.756877Z",
            "updated_at": "2025-03-27T02:00:55.544216Z",
            "deleted_at": null,
            "main_name": "Play",
            "aliases": null,
            "source_name": "MITRE:Play",
            "tools": [
                "Nltest",
                "AdFind",
                "PsExec",
                "Wevtutil",
                "Cobalt Strike",
                "Playcrypt",
                "Mimikatz"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1666716495,
    "ts_updated_at": 1743041786,
    "ts_creation_date": 1389826353,
    "ts_modification_date": 1389826353,
    "files": {
        "pdf": "https://archive.orkl.eu/9767abff87b137695ab8481729ed7130499a0c80.pdf",
        "text": "https://archive.orkl.eu/9767abff87b137695ab8481729ed7130499a0c80.txt",
        "img": "https://archive.orkl.eu/9767abff87b137695ab8481729ed7130499a0c80.jpg"
    }
}