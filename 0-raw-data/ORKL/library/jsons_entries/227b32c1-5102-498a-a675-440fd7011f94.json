{
    "id": "227b32c1-5102-498a-a675-440fd7011f94",
    "created_at": "2022-10-25T16:48:19.560497Z",
    "updated_at": "2025-03-27T02:16:05.800229Z",
    "deleted_at": null,
    "sha1_hash": "0b53ce14766ad66118edce7cbe62ff2926fbd281",
    "title": "Evidence Aurora Operation Still Active: Supply Chain Attack Through CCleaner part2",
    "authors": "Intezer",
    "file_creation_date": "2017-10-08T17:07:18Z",
    "file_modification_date": "0001-01-01T00:00:00Z",
    "file_size": 1073309,
    "plain_text": "# p Uncovered Between CCleaner Hack & Chinese Hackers\n\n**[intezer.com /evidence-aurora-operation-still-active-part-2-more-ties-uncovered-between-ccleaner-hack-chinese-](http://www.intezer.com/evidence-aurora-operation-still-active-part-2-more-ties-uncovered-between-ccleaner-hack-chinese-hackers/)**\nhackers/\n\n10/2/2017\n\n[Since my last post, we have found new evidence in the next stage payloads of the CCleaner supply chain attack that](http://www.intezer.com/evidence-aurora-operation-still-active-supply-chain-attack-through-ccleaner/)\nprovide a stronger link between this attack and the Axiom group.\n\nFirst of all, our researchers would like to thank the entire team at Cisco Talos for their excellent work on this attack\n[(their post regarding stage 2 can be found here) as well as their cooperation by allowing us access to the stage 2](http://blog.talosintelligence.com/2017/09/ccleaner-c2-concern.html)\npayload. Also, we would like to give a special thanks to Kaspersky Labs for their collaboration.\n\n## The Next Connection\n\nStarting from the stage 2 payload, I reverse engineered the module, extracting other hidden shellcode and binaries\n[within. After uploading the different binaries to Intezer Analyze™](http://www.intezer.com/intezer-analyze/), the final payload (that I have access to) had a\nmatch with a binary relating to the Axiom group.\n\n\n-----\n\nAt first glance, I believed it was going to be the same custom base64 function as mentioned in my previous blog\npost. A deeper look in the shared code proved otherwise.\n\nBinary in screenshot:\n\nf0d1f88c59a005312faad902528d60acbf9cd5a7b36093db8ca811f763e1292a\n\nRelated APT17 samples:\n\n07f93e49c7015b68e2542fc591ad2b4a1bc01349f79d48db67c53938ad4b525d\n\n0375b4216334c85a4b29441a3d37e61d7797c2e1cb94b14cf6292449fb25c7b2\n\n20cd49fd0f244944a8f5ba1d7656af3026e67d170133c1b3546c8b2de38d4f27\n\nee362a8161bd442073775363bf5fa1305abac2ce39b903d63df0d7121ba60550\n\n\n-----\n\nNot only did the first payload have shared code between the Axiom group and CCBkdr, but the second did as well.\nThe above photo shows the same function between two binaries. Let me put this into better context for you: out of all\nthe billions and billions of pieces of code (both trusted and malicious) contained in the Intezer Code Genome\nDatabase, we found this code in only these APTs . It is also worth noting that this isn’t a standard method one would\nuse to call an API. The attacker used the simple technique of employing an array to hide a string from being in clear\nsight of those analyzing the binary (although to those who are more experienced, it is obvious) and remain\nundetected from antivirus signatures. The author probably copied and pasted the code, which is what often happens\nto avoid duplicative efforts: rewriting the same code for the same functionality twice.\n\nD t th i f th h d d t l l d d th t th d itt b th tt k\n\n\n-----\n\n## Technical Analysis:\n\nThe stage two payload that was analyzed in this report\n(dc9b5e8aa6ec86db8af0a7aa897ca61db3e5f3d2e0942e319074db1aaccfdc83), after launching the infected version\nof CCleaner, was dropped to only a selective group of targets, as reported by Talos. Although there is an x64\nversion, the following analysis will only include the x86 version because they are nearly identical. I will not be going\ntoo far in depth as full comprehension of the technical analysis will require an understanding of reverse engineering.\n\nInstead of using the typical API (VirtualAlloc) to allocate memory, the attackers allocated memory on the heap using\nLocalAlloc, and then copied a compressed payload to the allocated memory.\n\n\n-----\n\nIt looks like the attackers used version 1.1.4 of zlib to decompress the payload into this allocated memory region.\n\n\n-----\n\nDepending on if you’re running x86 or x64 Windows, it will drop a different module. (32-bit\n07fb252d2e853a9b1b32f30ede411f2efbb9f01e4a7782db5eacf3f55cf34902, 64-bit\n128aca58be325174f0220bd7ca6030e4e206b4378796e82da460055733bb6f4f) Both modules are actually legitimate\nsoftware with additional code and a modified execution flow.\n\n\n-----\n\nThe last modified time on the modules is changed to match that of the msvcrt.dll that is located in your system32\nfolder–a technique to stay under the radar by not being able to check last modified files.\n\n\n-----\n\nSome shellcode and another module are written to the registry.\n\n\n-----\n\n-----\n\nAfter the module is successfully dropped, a service is created under the name Spooler or SessionEnv, depending\nupon your environment, which then loads the newly dropped module.\n\nThe new module being run by the service allocates memory, reads the registry where the other payload is located,\nand then copies it to memory.\n\n\n-----\n\n-----\n\nThe next payload is executed, which decrypts another module and loads it. If we look at the memory of the next\ndecrypted payload, we can see something that looks like a PE header without the MZ signature. From here, it is as\nsimple as modifying the first two bytes to represent MZ and we have a valid PE file.\n(f0d1f88c59a005312faad902528d60acbf9cd5a7b36093db8ca811f763e1292a)\n\n\n-----\n\nThe next module is a essentially another backdoor that connects to a few domains; before revealing the true IP, it\nwill connect to for the next stage payload.\n\n\n-----\n\nIt starts by ensuring it receives the correct response from [https://www.microsoft.com and](https://www.microsoft.com/)\n[https://update.microsoft.com.](https://update.micrsoft.com/)\n\n\n-----\n\nThe malware proceeds to decrypt two more URLs.\n\nThe malware authors used steganography to store the IP address in a ptoken field of the HTML.\n\nHere you can see the GitHub page with the ptoken field.\n\n\n-----\n\nThe value is then XOR decrypted by 0x31415926 which gives you 0x5A093B0D or the IP address: 13.59.9.90\n\n## Conclusion:\n\nThe complexity and quality of this particular attack has led our team to conclude that it was most likely statesponsored. Considering this new evidence, the malware can be attributed to the Axiom group due to both the nature\nof the attack itself and the specific code reuse throughout that our technology was able to uncover.\n\n## IOCs:\n\nStage 2 Payload: dc9b5e8aa6ec86db8af0a7aa897ca61db3e5f3d2e0942e319074db1aaccfdc83\n\nx86 Trojanized Binary: 07fb252d2e853a9b1b32f30ede411f2efbb9f01e4a7782db5eacf3f55cf34902\n\nx86 Registry Payload: f0d1f88c59a005312faad902528d60acbf9cd5a7b36093db8ca811f763e1292a\n\nx64 Trojanized Binary: 128aca58be325174f0220bd7ca6030e4e206b4378796e82da460055733bb6f4f\n\n\n-----\n\nRegistry Keys:\n\nHKLM\\Software\\Microsoft\\Windows NT\\CurrentVersion\\WbemPerf\\001\n\nHKLM\\Software\\Microsoft\\Windows NT\\CurrentVersion\\WbemPerf\\002\n\nHKLM\\Software\\Microsoft\\Windows NT\\CurrentVersion\\WbemPerf\\003\n\nHKLM\\Software\\Microsoft\\Windows NT\\CurrentVersion\\WbemPerf\\004\n\nHKLM\\Software\\Microsoft\\Windows NT\\CurrentVersion\\WbemPerf\\HBP\n\n## About Intezer:\n\nThrough its ‘DNA mapping’ approach to code, Intezer provides enterprises with unparalleled threat detection that\naccelerates incident response and eliminates false positives, while protecting against fileless malware, APTs, code\ntampering and vulnerable software.\n\n_Curious to learn what’s next for Intezer? Join us on our journey toward achieving these endeavors here on the blog_\n_[or request a community free edition invite](https://intezer.viewpage.co/free-community-edition)_\n\nBy Jay Rosenberg\n\nJay Rosenberg is a self-taught reverse engineer from a very young age (12 years old), specializing in\nReverse Engineering and Malware Analysis. Currently working as a Senior Security Researcher in\nIntezer.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "d63ae2b7-445f-460d-965d-2676dacdb6de",
            "created_at": "2022-10-25T15:59:19.552139Z",
            "updated_at": "2022-10-25T15:59:19.552139Z",
            "deleted_at": null,
            "name": "APTnotes",
            "url": "https://github.com/aptnotes/data",
            "description": "APTnotes data",
            "reports": null
        }
    ],
    "references": [
        "https://app.box.com/s/pszqtsxza5quthzuz31pqwypaf6idzum"
    ],
    "report_names": [
        "Intezer_Evidence-Aurora-Supply-Chain-Attack-CCleaner-Part2(10-02-2017)"
    ],
    "threat_actors": [
        {
            "id": "cea5ceec-0f14-4e34-bd0e-4074bc1a707d",
            "created_at": "2022-10-25T15:50:23.629983Z",
            "updated_at": "2025-03-27T02:00:55.509459Z",
            "deleted_at": null,
            "main_name": "Axiom",
            "aliases": [
                "Group 72"
            ],
            "source_name": "MITRE:Axiom",
            "tools": [
                "ZxShell",
                "gh0st RAT",
                "Zox",
                "PlugX",
                "Hikit",
                "PoisonIvy",
                "Derusbi",
                "Hydraq"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "2150d1ac-edf0-46d4-a78a-a8899e45b2b5",
            "created_at": "2022-10-25T15:50:23.269339Z",
            "updated_at": "2025-03-27T02:00:55.416524Z",
            "deleted_at": null,
            "main_name": "APT17",
            "aliases": [
                "APT17",
                "Deputy Dog"
            ],
            "source_name": "MITRE:APT17",
            "tools": [
                "BLACKCOFFEE"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "5c74936a-79d1-41b8-81eb-01d03c90a26b",
            "created_at": "2022-10-25T16:07:23.371052Z",
            "updated_at": "2025-03-27T02:02:09.766782Z",
            "deleted_at": null,
            "main_name": "Axiom",
            "aliases": [
                "Group 72",
                "Operation SMN"
            ],
            "source_name": "ETDA:Axiom",
            "tools": [
                "9002 RAT",
                "Agent.dhwf",
                "AngryRebel",
                "BlackCoffee",
                "BleDoor",
                "Chymine",
                "Darkmoon",
                "DeputyDog",
                "Derusbi",
                "Destroy RAT",
                "DestroyRAT",
                "Farfli",
                "Fexel",
                "Gen:Trojan.Heur.PT",
                "Gh0st RAT",
                "Ghost RAT",
                "Gresim",
                "HOMEUNIX",
                "HiKit",
                "HidraQ",
                "Homux",
                "Hydraq",
                "Kaba",
                "Korplug",
                "McRAT",
                "MdmBot",
                "Moudour",
                "Mydoor",
                "PCRat",
                "PNGRAT",
                "PlugX",
                "Poison Ivy",
                "RbDoor",
                "RedDelta",
                "RibDoor",
                "Roarur",
                "SPIVY",
                "Sensocode",
                "Sogu",
                "TIGERPLUG",
                "TVT",
                "Thoper",
                "Winnti",
                "Xamtrav",
                "ZXShell",
                "Zox",
                "ZoxPNG",
                "ZoxRPC",
                "gresim",
                "pivy",
                "poisonivy"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "a7aefdda-98f1-4790-a32d-14cc99de2d60",
            "created_at": "2023-01-06T13:46:38.281844Z",
            "updated_at": "2025-03-27T02:00:02.792526Z",
            "deleted_at": null,
            "main_name": "APT17",
            "aliases": [
                "G0025",
                "AURORA PANDA",
                "Group 72",
                "G0001",
                "HELIUM",
                "Group 8",
                "Hidden Lynx",
                "Tailgater Team",
                "BRONZE KEYSTONE"
            ],
            "source_name": "MISPGALAXY:APT17",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "4c68ccd0-caba-4189-9ead-86ac4c2d9b70",
            "created_at": "2024-05-01T02:03:07.930196Z",
            "updated_at": "2025-03-27T02:05:17.251237Z",
            "deleted_at": null,
            "main_name": "BRONZE ATLAS",
            "aliases": [
                "Axiom",
                "BARIUM ",
                "Blackfly ",
                "CTG-2633",
                "GREF",
                "Group 72 ",
                "Red Kelpie ",
                "TG-2633 ",
                "Wicked Panda ",
                "Winnti",
                "APT41 "
            ],
            "source_name": "Secureworks:BRONZE ATLAS",
            "tools": [
                " CCleaner v5.33 backdoor",
                " ChinaChopper",
                " Cobalt Strike",
                " Dicey MSDN",
                " ForkPlayground",
                " HUC Proxy Malware (Htran)",
                " Mimikatz",
                " PipeMon",
                " PlugX",
                " PortReuse",
                " Powershell Empire",
                " RCMD",
                " RbDoor",
                " SPEEDBOAT",
                " ShadowPad",
                " Sidewalk",
                " Speculoos",
                " TeamViewer",
                " Winnkit",
                " Winnti",
                " reg save",
                " vssadmin",
                "Acehash"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "1edcac0b-efd9-47b1-9aca-33827d5bd085",
            "created_at": "2024-05-01T02:03:07.964773Z",
            "updated_at": "2025-03-27T02:05:17.273595Z",
            "deleted_at": null,
            "main_name": "BRONZE KEYSTONE",
            "aliases": [
                "Aurora Panda ",
                "DeputyDog ",
                "Group 72 ",
                "Hidden Lynx ",
                "Shell Crew",
                "TG-8153 ",
                "Tailgater Team",
                "APT17 "
            ],
            "source_name": "Secureworks:BRONZE KEYSTONE",
            "tools": [
                " BlackCoffee",
                " DeputyDog",
                " Derusbi",
                " Gh0stHTTPSDropper",
                " HiKit",
                " InternalCMD",
                " PlugX",
                " PoisonIvy",
                " ZxShell",
                "9002"
            ],
            "source_id": "Secureworks",
            "reports": null
        }
    ],
    "ts_created_at": 1666716499,
    "ts_updated_at": 1743041765,
    "ts_creation_date": 1507482438,
    "ts_modification_date": 0,
    "files": {
        "pdf": "https://archive.orkl.eu/0b53ce14766ad66118edce7cbe62ff2926fbd281.pdf",
        "text": "https://archive.orkl.eu/0b53ce14766ad66118edce7cbe62ff2926fbd281.txt",
        "img": "https://archive.orkl.eu/0b53ce14766ad66118edce7cbe62ff2926fbd281.jpg"
    }
}