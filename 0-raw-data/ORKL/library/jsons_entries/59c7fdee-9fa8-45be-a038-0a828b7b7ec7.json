{
    "id": "59c7fdee-9fa8-45be-a038-0a828b7b7ec7",
    "created_at": "2023-01-12T15:07:14.767788Z",
    "updated_at": "2025-03-27T02:14:02.473053Z",
    "deleted_at": null,
    "sha1_hash": "e145677abc89e1f985cfed2742d06c50cd57eb39",
    "title": "2017-03-22 - Winnti Abuses GitHub for C&C Communications",
    "authors": "",
    "file_creation_date": "2022-05-28T17:34:27Z",
    "file_modification_date": "2022-05-28T17:34:27Z",
    "file_size": 193216,
    "plain_text": "# Winnti Abuses GitHub for C&C Communications\n\n**[blog.trendmicro.com/trendlabs-security-intelligence/winnti-abuses-github/](http://blog.trendmicro.com/trendlabs-security-intelligence/winnti-abuses-github/)**\n\nAPT & Targeted Attacks\n\n\nMarch 22, 2017\n\n\nThe Winnti group, a threat actor with a past of traditional cybercrime — particularly with\nfinancial fraud, has been seen abusing GitHub by turning it into a conduit for the C&C\ncommunications of their seemingly new backdoor.\n\nBy: Trend Micro March 22, 2017 Read time: ( words)\n\n**_With additional analysis from Cyber Safety Solutions Team_**\n\nDevelopers constantly need to modify and rework their source codes when releasing new\nversions of applications or coding projects they create and maintain. This is what makes\nGitHub—an online repository hosting service that provides version control management—\npopular. In many ways, it’s like a social networking site for programmers and developers, one\nthat provides a valuable platform for code management, sharing, collaboration, and\nintegration.\n\nGitHub is no stranger to misuse, however. Open-source ransomware projects EDA2 and\nHidden Tear—supposedly created for educational purposes—were hosted on GitHub, and\nhave since spawned various offshoots that have been found targeting enterprises. Tools that\n[exploited vulnerabilities in Internet of Things (IoT) devices were also made available on](http://blog.trendmicro.com/trendlabs-security-intelligence/another-challenge-iot-open-backdoors/)\nGitHub. Even the [Limitless Keylogger, which was used in targeted attacks, was linked to a](http://blog.trendmicro.com/trendlabs-security-intelligence/not-limitless-trend-micro-ftr-assists-arrest-limitless-author/)\nGitHub project.\n\n\n-----\n\nRecently, the Winnti group, a threat actor with a past of traditional cybercrime -particularly\nwith financial fraud, has been seen abusing GitHub by turning it into a conduit for the\ncommand and control (C&C) communications of their seemingly new backdoor (detected by\nTrend Micro as BKDR64_WINNTI.ONM).\n\nOur research also showed that the group still uses some of the infamous PlugX malware\nvariants—a staple in Winnti’s arsenal—to handle targeted attack operations via the GitHub\naccount we identified.\n\n**_Malware Analysis_**\n\nThe malware we analyzed is separated in two files: a loader, and the payload.\n\nThe loader, named loadperf.dll, is a modified version of its legitimate, similarly named\ncounterpart—a Microsoft file which helps manipulate the performance registry. An extra\ncomponent has been added to its sections. It copies itself on %WINDIR%\\system32\\wbem\\\nand replaces the original DLL. It leverages the WMI performance adapter service\n(wmiAPSrv), a legitimate file in Windows that collects information related to system\nperformance, to import the loader via services.exe. The system also imports all related DLL\nfiles and includes the payload “loadoerf.ini”. The infection chain includes an additional (albeit\nempty) function imported from loadoerf.ini, gzwrite64, which works as a fake Application\nProgram Interface (API) that serves as the payload’s entry point. Although gzwrite64 is\nimported by loadperf.dll, the payload’s main function is actually located in the DLLMain of\n“loadoerf.ini”.\n\n_Figure 1: Extra section .idata added to the original loadperf.dll_\n\n_Figure 2: Extra imported function gzwrite64_\n\nThe payload is a file named loadoerf.ini that contains decryption, run, and code injection\nfunctions. When it is loaded by the system, DLLMain decrypts the payload via\n_CryptUnprotectData. Since the function highly depends on the actual “machine ID”,_\ndecryption on another machine that isn’t the original infected host is not viable, making\nmalware analysis more difficult.\n\n_Figure 3: Part of the decryption function used in the payload_\n\nAfter decryption, partial code is run on the machine, which is then injected to svchost.exe (a\nkey Windows component); payload is then loaded into memory.\n\n_Figure 4: Execution/infection flow of loadoerf.ini_\n\nHow is GitHub abused? Upon successful infection, the malware starts communicating with\nan HTML page from a repository stored in a GitHub project.\n\n\n-----\n\n_Figure 5: GitHub account hosting an HTML page used for C&C communication_\n\nAny malware threat analyst will immediately recognize Line 3 in the image above as a\n[potential PlugX-encrypted line. The beginning and end markers, DZKS and DZJS, are typical](https://airbus-cyber-security.com/plugx-some-uncovered-points/)\nin PlugX. A closer look, however, shows that the decryption algorithm is different from PlugX.\nIn this case, decrypting them reveals references to its actual command and control (C&C)\nserver: an IP address and a port number the malware will connect to.\n\nWinnti currently uses different encryption algorithms to store those C&C references in the\nfiles they stored on Github. Among them is an algorithm utilized by PlugX. In fact, we found\nreferences to PlugX in the C&C strings we analyzed, indicating that the group may also be\nusing the same backdoor in this particular campaign. Although we were unable to find a\nPlugX sample through that particular GitHub, we surmise some PlugX variants in the wild\nuse this GitHub repository to get their C&C information.\n\nNearly all the other algorithms used in this GitHub campaign are derived from the original\nPlugX algorithm:\n\nPlugX style + shift string + Base64\nPlugX style + shift string + Base64 + XOR\nPlugX style + Base64 + XOR\n\nOne algorithm is also built in mark strings + shift string + Base64 encoding.\n\n**_Following Winnti's Trails_**\n\nThe GitHub account used by the threat actor was created in May 2016. It created one\nlegitimate project/repository (mobile-phone-project) in June 2016, derived from another\ngeneric GitHub page.\n\nThe repository for Winnti’s C&C communications was created on August 2016. We surmise\nthat the GitHub account was not compromised, and instead created by Winnti. By March\n2017, the repository already contained 14 different HTML pages created at various times.\n\n**_Timeline of the Campaign_**\n\nWe mapped Winnti’s activities for this campaign by analyzing the dates exposed in GitHub.\nFor each file, GitHub stores first-and-last commit timestamps; these enabled us to create a\ntimeline of the first use of the group’s many C&C servers.\n\nWe monitored the period during which IP addresses were found connecting to Winnti’s C&C\nservers and found that they started their operations in the afternoon up to late evening. The\ntimetable resembles traditional working hours for cybercriminals, compared to those with less\n\n\n-----\n\nstructure who prefer starting their days late, but also working until very late hours. In fact, we\nonly observed one instance of activity during the weekend, where a new HTML file was\ncreated.\n\nThe earliest activity we tracked on the GitHub account was from August 17, 2016, with the\nmost recent in March 12, 2017.\n\nHere is a timeline of when the C&C server’s IP addresses were first used, based on our\nmonitoring:\n\n_Figure 6: Timeline of the C&C server’s IP addresses_\n\n**_C&C Servers_**\n\nThe GitHub account used by Winnti shows 12 different IP addresses, with various port\nnumbers used for them. All communication to these C&C servers are done on three different\nport numbers: 53 (DNS), 80 (HTTP), and 443 (HTTPS). These are typical techniques PlugX\nand Winnti malware variants use to communicate between compromised machines and their\nC&C servers. Nearly all the C&C servers are hosted in the U.S., while two are located in\nJapan.\n\n**C&C Server's IP Address** **Port Number**\n\n160[.]16[.]243[.]129 443 (HTTPS)\n\n160[.]16[.]243[.]129 53 (DNS)\n\n160[.]16[.]243[.]129 80 (HTTP)\n\n174[.]139[.]203[.]18 443 (HTTPS)\n\n174[.]139[.]203[.]18 53 (DNS)\n\n174[.]139[.]203[.]20 53 (DNS)\n\n174[.]139[.]203[.]22 443 (HTTPS)\n\n174[.]139[.]203[.]22 53 (DNS)\n\n174[.]139[.]203[.]27 53 (DNS)\n\n174[.]139[.]203[.]34 53 (DNS)\n\n174[.]139[.]62[.]58 80 (HTTP)\n\n174[.]139[.]62[.]60 443 (HTTPS)\n\n174[.]139[.]62[.]60 53 (DNS)\n\n\n-----\n\n174[.]139[.]62[.]60 80 (HTTP)\n\n174[.]139[.]62[.]61 443 (HTTPS)\n\n61[.]195[.]98[.]245 443 (HTTPS)\n\n61[.]195[.]98[.]245 53 (DNS)\n\n61[.]195[.]98[.]245 80 (HTTP)\n\n67[.]198[.]161[.]250 443 (HTTPS)\n\n67[.]198[.]161[.]250 53 (DNS)\n\n67[.]198[.]161[.]251 443 (HTTPS)\n\n67[.]198[.]161[.]252 443 (HTTPS)\n\n_Figure 6: IP addresses used for C&C communication, and the port numbers they use_\n\nWe have privately disclosed our findings to GitHub prior to this publication and are\nproactively working with them about this threat.\n\n**_Conclusion_**\n\nAbusing popular platforms like GitHub enables threat actors like Winnti to maintain network\npersistence between compromised computers and their servers, while staying under the\nradar. Although Winnti may still be employing traditional malware, its use of a relatively\nunique tactic to stay ahead of the threat landscape’s curve reflects the increased\nsophistication that threat actors are projected to employ.\n\n**_Related Hashes (SHA256) detected as BKDR64_WINNTI.ONM:_**\n\n06b077e31a6f339c4f3b1f61ba9a6a6ba827afe52ed5bed6a6bf56bf18a279ba — cryptbase.dll\n1e63a7186886deea6c4e5c2a329eab76a60be3a65bca1ba9ed6e71f9a46b7e9d – loadperf.dll\n7c37ebb96c54d5d8ea232951ccf56cb1d029facdd6b730f80ca2ad566f6c5d9b – loadoerf.ini\n9d04ef8708cf030b9688bf3e8287c1790023a76374e43bd332178e212420f9fb —\n_wbemcomn.ini_\nb1a0d0508ee932bbf91625330d2136f33344ed70cb25f7e64be0620d32c4b9e2 —\n_cryptbase.ini_\ne5273b72c853f12b77a11e9c08ae6432fabbb32238ac487af2fb959a6cc26089 —\n_wbemcomn.dll_\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2017/2017-03-22 - Winnti Abuses GitHub for C&C Communications.pdf"
    ],
    "report_names": [
        "2017-03-22 - Winnti Abuses GitHub for C&C Communications.pdf"
    ],
    "threat_actors": [
        {
            "id": "caf95a6f-2705-4293-9ee1-6b7ed9d9eb4c",
            "created_at": "2022-10-25T15:50:23.472432Z",
            "updated_at": "2025-03-27T02:00:55.479021Z",
            "deleted_at": null,
            "main_name": "Confucius",
            "aliases": [
                "Confucius",
                "Confucius APT"
            ],
            "source_name": "MITRE:Confucius",
            "tools": [
                "WarzoneRAT"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "732bfd4b-8c15-42a5-ac4b-14a9a4b902e9",
            "created_at": "2022-10-25T16:07:23.38079Z",
            "updated_at": "2025-03-27T02:02:09.771357Z",
            "deleted_at": null,
            "main_name": "Bahamut",
            "aliases": [],
            "source_name": "ETDA:Bahamut",
            "tools": [
                "Bahamut",
                "DownPaper"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "37714790-40c0-4b6b-8e49-1c8f45a0463f",
            "created_at": "2022-10-25T16:07:24.37091Z",
            "updated_at": "2025-03-27T02:02:10.196909Z",
            "deleted_at": null,
            "main_name": "Urpage",
            "aliases": [],
            "source_name": "ETDA:Urpage",
            "tools": [],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "f99641e0-2688-47b0-97bc-7410659d49a0",
            "created_at": "2023-01-06T13:46:38.802141Z",
            "updated_at": "2025-03-27T02:00:02.922907Z",
            "deleted_at": null,
            "main_name": "Bahamut",
            "aliases": [],
            "source_name": "MISPGALAXY:Bahamut",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "ada9e5d3-1cb2-4b70-a3c8-96808c304ac8",
            "created_at": "2022-10-25T15:50:23.6515Z",
            "updated_at": "2025-03-27T02:00:55.513513Z",
            "deleted_at": null,
            "main_name": "Windshift",
            "aliases": [
                "Windshift",
                "Bahamut"
            ],
            "source_name": "MITRE:Windshift",
            "tools": [
                "WindTail"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "5bbced13-72f7-40dc-8c41-dcce75bf885e",
            "created_at": "2022-10-25T15:50:23.695735Z",
            "updated_at": "2025-03-27T02:00:55.525839Z",
            "deleted_at": null,
            "main_name": "Winnti Group",
            "aliases": [
                "Winnti Group"
            ],
            "source_name": "MITRE:Winnti Group",
            "tools": [
                "PipeMon",
                "Winnti for Windows",
                "PlugX"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "7a8dbc5e-51a8-437a-8540-7dcb1cc110b8",
            "created_at": "2022-10-25T16:07:23.482856Z",
            "updated_at": "2025-03-27T02:02:09.827887Z",
            "deleted_at": null,
            "main_name": "Confucius",
            "aliases": [],
            "source_name": "ETDA:Confucius",
            "tools": [
                "ApacheStealer",
                "ByeByeShell",
                "ChatSpy",
                "Confucius",
                "MY24",
                "Sneepy",
                "remote-access-c3",
                "sctrls",
                "sip_telephone",
                "swissknife2"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "945a572f-ebe3-4e2f-a288-512fe751cfa8",
            "created_at": "2022-10-25T16:07:24.413971Z",
            "updated_at": "2025-03-27T02:02:10.212853Z",
            "deleted_at": null,
            "main_name": "Winnti Group",
            "aliases": [
                "Wicked Panda",
                "Winnti Group"
            ],
            "source_name": "ETDA:Winnti Group",
            "tools": [
                "Agentemis",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "FunnySwitch",
                "RbDoor",
                "RibDoor",
                "RouterGod",
                "Winnti",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "7ea1e0de-53b9-4059-802f-485884180701",
            "created_at": "2022-10-25T16:07:24.04846Z",
            "updated_at": "2025-03-27T02:02:10.090459Z",
            "deleted_at": null,
            "main_name": "Patchwork",
            "aliases": [
                "APT-C-09",
                "ATK 11",
                "Capricorn Organisation",
                "Chinastrats",
                "Dropping Elephant",
                "Maha Grass",
                "Quilted Tiger",
                "TG-4410",
                "Thirsty Gemini",
                "Zinc Emerson"
            ],
            "source_name": "ETDA:Patchwork",
            "tools": [
                "AndroRAT",
                "Artra Downloader",
                "ArtraDownloader",
                "AutoIt backdoor",
                "BADNEWS",
                "BIRDDOG",
                "Bahamut",
                "Bozok",
                "Bozok RAT",
                "Brute Ratel",
                "Brute Ratel C4",
                "CinaRAT",
                "Crypta",
                "ForeIT",
                "JakyllHyde",
                "Loki",
                "Loki.Rat",
                "LokiBot",
                "LokiPWS",
                "NDiskMonitor",
                "Nadrac",
                "PGoShell",
                "PowerSploit",
                "PubFantacy",
                "Quasar RAT",
                "QuasarRAT",
                "Ragnatela",
                "Ragnatela RAT",
                "SocksBot",
                "TINYTYPHON",
                "Unknown Logger",
                "WSCSPL",
                "Yggdrasil"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "4c68ccd0-caba-4189-9ead-86ac4c2d9b70",
            "created_at": "2024-05-01T02:03:07.930196Z",
            "updated_at": "2025-03-27T02:05:17.251237Z",
            "deleted_at": null,
            "main_name": "BRONZE ATLAS",
            "aliases": [
                "Axiom",
                "BARIUM ",
                "Blackfly ",
                "CTG-2633",
                "GREF",
                "Group 72 ",
                "Red Kelpie ",
                "TG-2633 ",
                "Wicked Panda ",
                "Winnti",
                "APT41 "
            ],
            "source_name": "Secureworks:BRONZE ATLAS",
            "tools": [
                " CCleaner v5.33 backdoor",
                " ChinaChopper",
                " Cobalt Strike",
                " Dicey MSDN",
                " ForkPlayground",
                " HUC Proxy Malware (Htran)",
                " Mimikatz",
                " PipeMon",
                " PlugX",
                " PortReuse",
                " Powershell Empire",
                " RCMD",
                " RbDoor",
                " SPEEDBOAT",
                " ShadowPad",
                " Sidewalk",
                " Speculoos",
                " TeamViewer",
                " Winnkit",
                " Winnti",
                " reg save",
                " vssadmin",
                "Acehash"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "c81067e0-9dcb-4e3f-abb0-80126519c5b6",
            "created_at": "2022-10-25T15:50:23.285448Z",
            "updated_at": "2025-03-27T02:00:55.42906Z",
            "deleted_at": null,
            "main_name": "Patchwork",
            "aliases": [
                "Hangover Group",
                "Dropping Elephant",
                "Chinastrats",
                "Operation Hangover"
            ],
            "source_name": "MITRE:Patchwork",
            "tools": [
                "NDiskMonitor",
                "QuasarRAT",
                "BackConfig",
                "TINYTYPHON",
                "AutoIt backdoor",
                "PowerSploit",
                "BADNEWS",
                "Unknown Logger",
                "Socksbot"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1673536034,
    "ts_updated_at": 1743041642,
    "ts_creation_date": 1653759267,
    "ts_modification_date": 1653759267,
    "files": {
        "pdf": "https://archive.orkl.eu/e145677abc89e1f985cfed2742d06c50cd57eb39.pdf",
        "text": "https://archive.orkl.eu/e145677abc89e1f985cfed2742d06c50cd57eb39.txt",
        "img": "https://archive.orkl.eu/e145677abc89e1f985cfed2742d06c50cd57eb39.jpg"
    }
}