{
    "id": "9facfc9f-98c4-4c6d-a43c-fc509c48d04e",
    "created_at": "2023-01-12T15:07:21.60804Z",
    "updated_at": "2025-03-27T02:05:33.265832Z",
    "deleted_at": null,
    "sha1_hash": "f8e29198931edf2381ff1d7602f2ae1a8db0ab9d",
    "title": "2021-02-16 - Latin American Javali trojan weaponizing Avira antivirus legitimate injector to implant malware",
    "authors": "",
    "file_creation_date": "2022-05-28T21:47:55Z",
    "file_modification_date": "2022-05-28T21:47:55Z",
    "file_size": 14217038,
    "plain_text": "# Latin American Javali trojan weaponizing Avira antivirus legitimate injector to implant malware\n\n**seguranca-informatica.pt/latin-american-javali-trojan-weaponizing-avira-antivirus-legitimate-injector-to-implant-**\nmalware/\n\nFebruary 16, 2021\n\n**Latin American Javali trojan weaponizing Avira antivirus legitimate injector to implant**\n**malware.**\nIn the last few years, many banking trojans developed by Latin American criminals have\nincreased in volume and sophistication. Although exists a strong adoption of technologies\nwith the goal of protecting the final user such as plugins, tokens, e-tokens, two-factorauthentication mechanisms, CHIP, PIN cards, and so on, online fraud is still on the rise and\nevery day implementing new tactics, techniques, and procedures (TTP) to evade antivirus\nand Endpoint Detection & Response systems.\n\nIn this article, we will into the details of the Javali trojan banker, **introduced and tracked by**\n**the Kaspersky Team, and targeting Latin American countries, including Brazil and Mexico**\nbanking and financial organizations.\n\n## Background of Latin American Trojans\n\nJavali trojan is active since November 2017 and targets users of financial and banking\norganizations geolocated in Brazil and Mexico. By analyzing this piece of malware, we found\nthat Javali is using the same routines and calls often observed on other Latin American\n[trojans, such as Grandoreiro,](https://seguranca-informatica.pt/the-updated-grandoreiro-malware-equipped-with-latenbot-c2-features-in-q2-2020-now-extended-to-portuguese-banks/) **[URSA aka Mispadu, Lampion,](https://seguranca-informatica.pt/threat-analysis-the-emergent-ursa-trojan-impacts-many-countries-using-a-sophisticated-loader)** **[Vadokrist,](https://www.welivesecurity.com/2021/01/21/vadokrist-wolf-sheeps-clothing/)** **[Amavaldo,](https://www.welivesecurity.com/2019/08/01/banking-trojans-amavaldo/)**\n**[Casbaneiro aka Metamorpho and Mekotio.](https://www.welivesecurity.com/2019/10/03/casbaneiro-trojan-dangerous-cooking/)**\n\n\n-----\n\n**_Figure 1: The most popular and dangerous Latin American trojans._**\n\nIn short, part of these trojan families are using padding to enlarge the binary; empty sections\n[or even BPM images attached as a resource as described in this article related to the](https://seguranca-informatica.pt/the-updated-grandoreiro-malware-equipped-with-latenbot-c2-features-in-q2-2020-now-extended-to-portuguese-banks/#.YCMNomj7QuV)\n**[Grandoreiro trojan. Other trojans use this technique as it allows to evade detection and](https://seguranca-informatica.pt/the-updated-grandoreiro-malware-equipped-with-latenbot-c2-features-in-q2-2020-now-extended-to-portuguese-banks/#.YCMNomj7QuV)**\nexecute the malicious code on the target machines bypassing detection based on static file\nsignatures.\n\nLatin American trojans share the same modus operandi and even modules and blocks of\ncode observed during the analysis of several malware samples. The following schema is an\neffort to present in a single high-level diagram the workflow of the most popular Latin\nAmerican trojans.\n\n**_Figure 2: High-level diagram of the modus operandi of the most popular Latin American_**\n_banking trojans._\n\nThe malicious activity starts with a phishing email sent to the target victims in Latin American\n– Brazil, Mexico, Chile, and Peru – and Europe – Spain and Portugal. The initial stage of\nthese trojans is generally the execution of a dropper in a form of a VBS, JScript, or MSI file\nthat downloads from the Cloud (AWS, Google, etc.) the trojan loader/injector. After this step,\nthe trojan itself – developed in Delphi – is executed into the memory manly using the DLL\nside loading technique or DLL injection, creating persistence using a .lnk file on the Windows\nStartup folder, or adding a new key in the machine registry\n(HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run) with the name\nand path of the .lnk file to guarantee the malware is executed every time the infected\nmachine starts.\n\nThe steps 7 and 8 from Figure 2, the malware obtains some details from the infected\nmachine and report them to the C2 server, including the version of the Operating System\n(OS), architecture, the name of the installed antivirus and EDRs, computer name, and the\nvictim’s geolocation.\n\n\n-----\n\nFrom here, the malware executes a new thread when specific and hardcoded web-browsers\nare opened. The title of the accessed web-pages are collected and compared with the target\norganizations and services hardcoded and defined by crooks, generally the name of the\nbanking portals, cryptocurrency portals, and financial firms. If these conditions match, the\nwindows overlay process starts launching fake windows to lure victims.\n\nMore details and comparisons between several threads and used TTPs can be found below\n[and by accessing the publication from ESET.](https://www.welivesecurity.com/wp-content/uploads/2020/09/ESET_LATAM_financial_cybercrime.pdf)\n\n\n-----\n\n-----\n\n**_Figure 3: MITRE ATT&CK table illustrating the features that Latin American banking trojans_**\n[share (full table and more details here).](https://www.welivesecurity.com/2020/10/01/latam-financial-cybercrime-competitors-crime-sharing-ttps/)\n\nAs observed during the last few years, several threats share a lot of TTP and code, and that\nis a clear signal of cooperation between malicious groups.\n\n## Discovering Javali trojan banker\n\nThese days, the Javali trojan banker is one of the most popular trojan banker families in the\n[wild. According to the Kaspersky publication:](https://securelist.com/the-tetrade-brazilian-banking-malware/97779/)\n\n\n-----\n\n**_Javali targets Portuguese- and Spanish-speaking countries, active since November_**\n**_2017 and primarily focusing on the customers of financial institutions located in Brazil_**\n**_and Mexico_**\n\nSince the details online about this threat are scarce, after a tweet of the malware hunter\n**[@JAMESWT_MHT on Twitter, we decided to go through the details of this specific trojan.](https://twitter.com/JAMESWT_MHT)**\n\n[#Spy](https://twitter.com/hashtag/Spy?src=hash&ref_src=twsrc%5Etfw) [#Ousaban](https://twitter.com/hashtag/Ousaban?src=hash&ref_src=twsrc%5Etfw)\nI Found old sample\nthat work in same way of mentioned tweet\n[Referencehttps://t.co/NMjVNRHPjg](https://t.co/NMjVNRHPjg)\n[Run https://t.co/Biq98qBrhH](https://t.co/Biq98qBrhH)\ncc [@ffforward](https://twitter.com/ffforward?ref_src=twsrc%5Etfw) [@lazyactivist192](https://twitter.com/lazyactivist192?ref_src=twsrc%5Etfw) [@sirpedrotavares@sugimu_sec](https://twitter.com/sirpedrotavares?ref_src=twsrc%5Etfw)\n[@verovaleros@Jan0fficial](https://twitter.com/verovaleros?ref_src=twsrc%5Etfw) [@guelfoweb@1ZRR4H](https://twitter.com/guelfoweb?ref_src=twsrc%5Etfw) [@__4ndr3y](https://twitter.com/__4ndr3y?ref_src=twsrc%5Etfw)\n[https://t.co/cpzQA4SpNU](https://t.co/cpzQA4SpNU) [pic.twitter.com/szw5ngFr6z](https://t.co/szw5ngFr6z)\n\n— JAMESWT (@JAMESWT_MHT) [February 3, 2021](https://twitter.com/JAMESWT_MHT/status/1356993036874563586?ref_src=twsrc%5Etfw)\n\nAs observed in another Latin American banking trojans from Figure 3, part of the most\npopular trojans are disseminated using the most dangerous vehicle of threat’s proliferation:\nemail protocol. As this protocol relies on a strong and complex “mesh” around him to catch\nthe fish, the end-user is every time the final decision maker: open or not open the fresh\nemail. Next, an email template used by Javali to lure victims is presented.\n\n\n-----\n\n**_Figure 4: Email template used by Javali banking trojan._**\n\nThe Javalis’ modus operandi is based on the workflow previously explained in Figure 2 and\n[related to other threats such as Vadokrist,](https://www.welivesecurity.com/2021/01/21/vadokrist-wolf-sheeps-clothing/) **[Lampion,](https://seguranca-informatica.pt/lampion-trojan-disseminated-in-portugal-using-covid-19-template/#.YCvft2j7RPY)** **[URSA,](https://seguranca-informatica.pt/threat-analysis-the-emergent-ursa-trojan-impacts-many-countries-using-a-sophisticated-loader)** **[Amavaldo, and](https://www.welivesecurity.com/2019/08/01/banking-trojans-amavaldo/)** **[Casbaneiro.](https://www.welivesecurity.com/2019/10/03/casbaneiro-trojan-dangerous-cooking/)**\nAfter opening the URL distributed on the email body, a ZIP file is then downloaded from the\nInternet. For this, Cloud services are often used by crooks including Google, S3 Buckets\nfrom AWS, and MediaFire file sharing service. The next diagram demonstrates how Javali\ntrojan banker works.\n\n\n-----\n\n**_Figure 5: High-level diagram of Javali trojan banker._**\n\nAs mentioned, in general, this trojan was developed using the same architecture of other\nLatin American trojans, and the main steps of the infection chain are described below and\nanalyzed in-depth during the next sections of this article.\n\nIn short, the phishing email is received by victims. By opening an URL it downloads from the\nInternet (Cloud services) a ZIP file with an MSI executable inside (1, 2). The MSI file contains\na JavaScript payload hardcoded, then executed via wscript.exe (3) that will create\npersistence on the infected machine (4) and also download the final files from an AWS S3\nbucket (5).\n\nThe Avira.exe file, a legitimate PE file from the Avira Antivirus firm, is then used as an\ninjector to take advantage of a technique dubbed DLL side-loading and loading into the\nmemory a huge DLL “Avira.OE.NativeCore.dll” (6) as a child of a legitimate Parent Process\nID (PPID).\n\nWhen executed, the Javali trojan starts its operation and immediately gets the malware\nconfiguration from doc files available on Google Cloud (7).\n\nNext, the trojan collects information from web-browsers (8) searching for target tabs opened\nrelated to hardcoded banking/financing portals and starts the malicious overlay activity\npresenting fake windows to victims (9, 10, 11, 12, and 13).\n\n\n-----\n\n## MSI file – The Javali Dropper\n\n**Filename: FT.FATURA.EKFUHLWS+LUVPBC0DGZUWISOAPDK.msi**\n**MD5: 70aa68c29622df360dea76daa4255835**\n**Creation time: 2/5/2021 7:10:49 AM**\n\nThe MSI file has hardcoded a JavaScript payload inside as observed in Figure 6. This stage\nwill be executed and download next step.\n\n**_Figure 6: JScript file hardcoded inside the MSI file and then executed via wscript.exe on the_**\n_target machine._\n\nAfter some rounds of deobfuscation, we found some interesting strings and the blocks of\ncode responsible for creating persistence on the machine and also downloading a ZIP file\nfrom an AWS S3 bucket dropped into the User’s public folder:\n_C:\\Users\\Public\\Documents\\random_name._\n\n\n-----\n\n**_Figure 7: JScript file partially deobfuscated._**\n\nAlthough some parts of the code still obfuscated, we can understand the basic operation of\nthis piece of malware by debugging it on a debugger. This is a trick valid for other Jscript files\nexecuted via wscript.exe. By debugging it and adding a breakpoint on the\n“ws2_32.GetAddrInfoW” call, we can observe the moment the malware downloads the next\nstage from the Internet (AWS S3 bucket).\n\n\n-----\n\n**_Figure 8: Getting the AWS S3 bucket address by debugging the JScript payload._**\n\nThe downloaded ZIP file is stored into the “C:\\Users\\Public\\Documents” directory, inside a\nrandom folder created during the dropper execution. After that, the following files are\nextracted, namely:\n\n**Avira.exe: Legitimate injector from Avira Antivirus.**\n**Avira.OE.NativeCore.dll: malicious DLL used during the DLL side-loading process.**\n**msvcp120.dll: Windows legitimate DLL for runtime dependencies – MICROSOFT® C**\nRUNTIME LIBRARY.\n**msvcr120.dll: Windows legitimate DLL for runtime dependencies – MICROSOFT® C**\nRUNTIME LIBRARY.\n**rundll32.dll: Copy of the Avira.exe injector used to start the trojan when the Jscript**\nterminates its execution.\n\n\n-----\n\n```\nAvira.exe\n8CBB75FEBFB4B0B7C3B6D3613386220C\nAvira.OE.NativeCore.dll\n83c49ccc03e4abfad28e278ce98b4537\nmsvcp120.dll\nFD5CABBE52272BD76007B68186EBAF00\nmsvcr120.dll\n034CCADC1C073E4216E9466B720F9849\nrundll32.exe\n8CBB75FEBFB4B0B7C3B6D3613386220C\n\n```\n**_Figure 9: Javali trojan and all the files used during the infection chain._**\n\nPersistence is achieved by creating a .lnk file in the Windows startup folder and also a\nregistry key pointing to this .lnk file.\n```\n[HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run]\ncreated: CREATED\ndevice: DISK_FILE_SYSTEM\nname: C:\\Users\\xxxxx\\AppData\\Roaming\\Microsoft\\Windows\\Start\nMenu\\Programs\\Startup\\JAAMKHQWFW.lnk\nobject: FILE\noperation: CREATE\nstatus: 0x00000000\ntime: 10453 ms\n\n```\n\n-----\n\n**_Figure 10: Javali trojan persistence technique (Windows startup folder + registry_**\n_CurrentVersion\\Run)._\n\n## Javali injector – Weaponizing Avira legitimate executable\n\n**Filename: Avira.exe / rundll32.exe**\n\n**MD5: 8CBB75FEBFB4B0B7C3B6D3613386220C**\n\n**Creation time: 1/25/2021 4:38:25 AM**\n\nJavali trojan takes advantage of a legitimate executable from Avira Antivirus firm to inject into\nthe memory a malicious DLL that impersonates the legitimate DLL:\n**_Avira.OE.NativeCore.dll. This technique is known as DLL side-loading aka DLL hijacking by_**\nabusing of vulnerabilities specifically occur when Windows Side-by-Side (WinSxS) manifests\n[are not explicit enough about characteristics of the DLL to be loaded (T1574).](https://attack.mitre.org/techniques/T1574)\n\nAs observed below, the injector is a legitimate file and with a valid digital signature from\n**Avira Operations GmbH & Co. KG.**\n\n\n-----\n\n**_Figure 11: Javali uses as injector a legitimate executable from Avira antivirus._**\n\nDLL side-loading is used as the favored execution method by Latin American threat groups\nand 22 different binaries have been abused to load into the memory malicious code. In a\n**[publication from ESET, some products were described, including binaries from Microsoft,](https://www.welivesecurity.com/wp-content/uploads/2020/09/ESET_LATAM_financial_cybercrime.pdf)**\nOracle, several security companies, NVIDIA, VMWare, Avira, and others used as injectors in\nAmavaldo, Casbaneiro, Mekotio, Vadokrist, and Javali trojans.\n\n|Product|Filename|DLL name|\n|---|---|---|\n|Microsoft Corporation CTF Loader|ctfmon.exe|MsCtfMonitor.dll; AppGetLoader.dll; CryptUI.dll|\n|Microsoft Corporation OLE/COM Object Viewer|OLEView.exe|IViewers.dll|\n|Microsoft ECM Certificate Manager|CertMgr.exe|CryptUI.dll|\n|Microsoft Office Picture Manager|Ois.exe|MSOCF.dll|\n\n\n-----\n\n|Product|Filename|DLL name|\n|---|---|---|\n|Java(TM) Platform SE 8 (cmd-line launcher)|jjs.exe|jli.dll|\n|Java(TM) Platform SE 8 (Remote Method Invocation)|java-rmi.exe|jli.dll|\n|Java(TM) Platform SE 8 (Kerberos)|kinit.exe|jli.dll|\n|Avira|Avira.SysTrayStartTrigger.exe|Avira.OE.NativeCode.dll|\n|Avast Dump Process|avDump32.exe|Dbghelp.dll|\n|AVG Dump Process|avDump32.exe|Dbghelp.dll|\n|G DATA Personal Firewall|GDFwAdmin.exe|GDFwAdmin.dll|\n|G DATA Security Software|AVK.exe|Avk.dll|\n|COMODO Internet Security|CisTray.exe|Cmdres.dll|\n|NVIDIA 3D Vision Test Application|Nvsttest.exe|D3d8.dll|\n|NVIDIA Smart Maximise Helper Host|NvSmartMaxApp.exe|NvSmartMax.dll|\n|VirtualBox Guest Additions Tray Application|VBoxTray.exe|Mpr.dll|\n|VMware NAT Service|Vmnat.exe|Shfolder.dll|\n|WinGup for Notepad++|Gup.exe|Libcurl.dll|\n|Disc Soft Bus Service Pro (DAEMON Tools Pro)|DiscSoftBusService.exe|Imgengine.dl|\n|Bartels Media GmbH Macro Recorder|MacroRecorder.exe|Mrkey.dll|\n|Stonesoft VPN Client Service|Sgvpn.exe|Wtsapi32.dll|\n|OOO Lightshot Starter Module|Lightshot.exe|Lightshot.dll|\n\n\n-----\n\n[Also, BitDefender published an article in reference to this vulnerability used by Casbaneiro](https://www.bitdefender.com/files/News/CaseStudies/study/333/Bitdefender-PR-Whitepaper-Metamorfo-creat4500-en-EN-GenericUse.pdf)\naka Metamorfo trojan to execute the malware as a child of a trusted process. In fact,\nlegitimate applications are digitally signed with an Authenticode (code-signing) certificate.\nThis is the proof and seen as a token of trust, as an Authenticode-signed executable file\nlooks less alarming to users when requesting elevated privileges.\n\nIn this way, if the User Account Control (UAC) prompts the victim that the antivirus engine\nwants to make changes on the system, well, users probably will not question it. On the other\nhand, many antivirus and Endpoint Detection & Response systems can be avoided using this\nvulnerability, as the injector is legitimate, code-signed, authentic, and comes from a wellknown security firm – Avira.\n\n**_Figure 12: Legitimate injector from Avira – digitally signed, authentic, and trusted during the_**\n_injection process allowing to bypass security engines such as AV and EDR._\n\n## Avira injector – Digging into the details\n\nThere is a lot of methods to take advantage of DLL side-loading vulnerability by examining\nthe DLL imports. Figure 13 shows the Avira.exe DLL Import Table Address (IAT) which\nincludes the functions:\n\n**MakeTrayIconVisible**\n**Avira::OE::NativeCore::OeProductInfo::GetLanguage(void)const**\n\n\n-----\n\n**_Figure 13: Calls loaded from a legitimate external DLL (Avira.OE.NativeCore.dll)._**\n\nValidating the external DLLs and calls must involve more than checking for the correct\nfilename and calls names. In this way, every time a DLL is loaded from the side-by-side\ndirectory and adjacent to the primary PE file needs to be validated for these functions.\nUsually, executables using the side-by-side feature will have these resources located in the\nembedded manifest file.\n\nIn detail, the name passed to LoadLibrary() / LoadLibraryEx() call not need specify a specific\npath. If a path is passed, then the library is only loaded from the specific path. Otherwise, the\nfollowing Windows default DLL search order is used:\n\n1. The current process image file directory – the application directory.\n2. The system directory (e.g. system32 folder).\n3. The 16-bit system directory.\n4. The windows directory.\n5. The current working directory.\n6. The directories listed in the PATH environment variable.\n\nAfter analyzing the legitimate injector, we can see that the CreateFile() and ReadFile()\nfunctions are used to load into the memory the external DLL from the current process image\nfile directory.\n\n\n-----\n\n**_Figure 14: Avira.exe injector vulnerable to DLL side-loading attack abused by Javali trojan._**\n\nIn sum, we recommend the following strategy should be kept in mind to ensure secure\nloading of libraries:\n\n**Use proper DLL search order.**\n**Make use of code signing infrastructure or AppLocker.**\n**Ensure that the full path is hardcoded avoiding relative paths for any resources.**\n**Confirm that the imported DLL actually exists.**\n**Ensure that all the imported functions are valid and not empty.**\n**Utilize DLL redirection or a manifest.**\n**Code-signing – Microsoft Authenticode technology.**\n\n## Final stage – Javali trojan banker\n\n**Filename: Avira.OE.NativeCore.dll**\n\n**MD5: 83c49ccc03e4abfad28e278ce98b4537**\n\n**Creation time: 2/2/2021 3:47:39 AM**\n\n**_Code-signing (Microsoft Authenticode technology) can be used to sign the DLL, which is_**\nto attach digital signatures to the DLL to guarantee its authenticity and integrity.\n\n\n-----\n\nBy comparing the legitimate and malicious DLL, we can see that the malicious one is not\nsigned in contrast to the legitimate one (Figure 15). Also, the External Address Table (EAT) is\nmaintained including the two required calls that are invoked, otherwise, the injector could\ncrash during its execution (Figure 16). Below, we can see that the “spoofed” DLL is not\ndigitally signed, and even the size of the file is bigger than the original from Avira.\n\n**_Figure 15: Malicious (spoofed) DLL without digital signature and the file was enlarged to_**\n_bypass detection. Otherwise, the original DDL from the Avira firm is digitally signed._\n\nAs observed in Figure 16, the exported calls on the right-side (malicious DLL) don’t have a\nname – the sections’ names are empty – and the OEP is pointing to the .data section. At the\nfirst glance, this is a clear signal that something is wrong, even looking at the EAT, we can\nfind many strange and empty sections to enlarge the DLL size.\n\nAlso, the original file name and compilation date are different between the legitimate (leftside) and the malicious DLL (right-side). Although the ordinals are different, the base calls of\nthe legitimate DLL were maintained, and only the main calls were overwritten with the\nmalicious code.\n```\n---overwritten functions--MakeTrayIconVisible\nAvira::OE::NativeCore::OeProductInfo::GetLanguage(void)const\n\n```\n\n-----\n\n**_Figure 16: Principal differences between the Legitimate DLL from Avira versus the malicious_**\n_DLL._\n\nThe Javali DLL is packed and enlarged with junk – a well-known technique used by Latin\nAmerican trojans such as Grandoreiro and Lampion in order to evade detection.\n\nWhen executed in memory, the malware is unpacked by blocks using the virtualization code\nof the **[Enigma protector.](https://enigmaprotector.com/)**\n\n**_The unique technology which allows combining the files used by your application into_**\n**_a single module without loss of efficiency. This function supports all kinds of files,_**\n**_including dll, ocx, mp3, avi, etc. Virtual Box will protect your files and prevent them_**\n**_from being copied and used in third-party products._**\n\nAfter bypassing this initial restriction, we can see below (right-side) the Javali trojan DLL\npartially unpacked.\n\n\n-----\n\n**_Figure 17: Javali trojan – Enigma packed DLL vs partially unpacked DLL._**\n\nThe malicious DLL has a size of 570 MB in disk because it was compiled with empty\nsessions. When it is executed into the memory, unpacked and the empty sessions are\ncleaned, the library is a binary of 30 MB.\n\n\n-----\n\n**_Figure 18: Unpacked DLL – 30 MB versus packed DLL – 570 MB._**\n\nOnce the binary is unpacked, at this time it’s possible to obtain the images that are used\nduring the windows overlay process. As observed below, this time the resources are\nunpacked and can be analyzed.\n\n**_Figure 19: Packed resources vs unpacked resources._**\n\nAt this point, internal capabilities and implemented TTP can be analyzed by reversing the\nDelphi code as well\n\n\n-----\n\n**_Figure 20: Javali trojan – Delphi forms._**\n\n## Javali configuration obtained from Google Docs\n\nJavali trojan communicates with Google Docs files to obtain its configuration, including the\naddress of the C2 server. If it is not able to connect to the address, it uses a hardcoded one.\nJavali checks for connectivity by sending a web request to the ipinfo.io service.\n```\n6EEE36B7,\"mov eax,avira.oe.nativecore.6EF188B4\",\"&L\"\"Windows 7 Ultimate\"\"\"\n6EEE36CB,\"mov\neax,avira.oe.nativecore.6EF0E4C0\",\"&L\"\"BAUdGYGlgX3wUY4XrGGt9z6CrGnnlmpgCaEIjtxxxxxxxxx\n6EEE36DF,\"mov eax,avira.oe.nativecore.6EF188BC\",\"&L\"\"TUBA-01\"\"\"\n6EEE3757,\"mov eax,avira.oe.nativecore.6EF18900\",\"&L\"\"1724526122\"\"\"\n6EEE376B,\"mov eax,avira.oe.nativecore.6EF1891C\",\"&L\"\"Windows 7\"\"\"\n6EEE3789,\"mov eax,avira.oe.nativecore.6EF18930\",\"&L\"\"http://ipinfo.io/json\"\"\"\n6EEE3793,\"mov eax,avira.oe.nativecore.6EF18934\",\"&L\"\"xx.46.179.xx\"\"\"\n6EEE37CF,\"mov\neax,avira.oe.nativecore.6EF1894C\",\"&L\"\"hxxps://docs.google.]com/document/d/15dKy9iPdfK\n6EEE37D9,\"mov\neax,avira.oe.nativecore.6EF18950\",\"&L\"\"hxxps://docs.google.]com/document/d/16OdxMD6j6d\n6EEE37E3,\"mov\neax,avira.oe.nativecore.6EF18954\",\"&L\"\"hxxps://claricepss.webcindario.]com/pgl/index.p\n6EEE380B,\"mov eax,avira.oe.nativecore.6EF18970\",\"&L\"\"191.232.170.12\"\"\"\n6EEE3815,\"mov eax,avira.oe.nativecore.6EF18974\",\"&L\"\"25325\"\"\"\n\n```\n\n-----\n\n**_Figure 20: Javali process of getting config from Google Docs and communication with C2_**\n_server._\n\nThe list of Google docs hardcoded inside the Javali file is presented below:\n```\nhxxps://docs.google].com/document/d/15dKy9iPdfKKUyI5JEn6lyhxramzevtn0siixKmnfNB0/edit\nhxxps://docs.google].com/document/d/15i3BIlOzTNOF3cIgA-o8YYa-u24q-DdcalWi5JMyxeU/edit\nhxxps://docs.google].com/document/d/18dBH_hLqlszwezEZkeFfACFo-nhCHHoCwc6qyxdoA2Y/edit\nhxxps://docs.google].com/document/d/18qfnad3gLJeUsZxZo-iRkYShxp72q5Ct4sUvCXxl0Ng/edit\nhxxps://docs.google].com/document/d/1E3RFnE4dlzD_wL96hMzNBlZZ8vNS-mM_Q48lDUFzwFA/edit\nhxxps://docs.google].com/document/d/1IM9fNp--iWLQPUVKjHBZUOwfi9Yv_BuUSojQTCidU3U/edit\nhxxps://docs.google].com/document/d/1MezQvI_dk_5R4zn_i5dhfSd86KULlFPCsNIUPEu-ZR8/edit\nhxxps://docs.google].com/document/d/1OetWS-gLaMbPBcxDQaVbNcYXb7hL4BsR8X_ouI-hz1g/edit\nhxxps://docs.google].com/document/d/1T-hcyJWouUdAIZ19DZ_guh723zgpL2H2c4kpcBL0Tqg/edit\nhxxps://docs.google].com/document/d/1UwICJoIrrey05PhmMpKVB2g3tMf9PYk4A-UeFHEOIsw/edit\nhxxps://docs.google].com/document/d/1W2GHf0vyCLNhVIDxF126mvbKFS9VC2RqU4n-5EXMZLA/edit\nhxxps://docs.google].com/document/d/1YTBuav90AWfG24KrZ25h41GnVXIzh3cSapf0sF5n8QI/edit\nhxxps://docs.google].com/document/d/1bGyEiUhvY1HvEkbIS7pNPWCODIRrfTyvK2TJLwEFgrw/edit\nhxxps://docs.google].com/document/d/1fUCxFdZGv3BUIMtba8tItJAJA3SY4ZR8UHPW0loT80Y/edit\nhxxps://docs.google].com/document/d/1iN1UvBtln4jXxMgNpGqGl3NF_YN1lhE_Ei11E2odFdo/edit\nhxxps://docs.google].com/document/d/1jR8nCxVdi4vnNUlLCpKz3LbpPK9RMzW3_hWGNgpe2nY/edit\nhxxps://docs.google].com/document/d/1o-b6lH-aadYKV1jr7imBgUiXgIFNwrkI-9aHlVAa4JQ/edit\nhxxps://docs.google].com/document/d/1ogLFEFF4G0PHJM2LBjd3dKFB4tAGiaTiUb2BA0ouuac/edit\nhxxps://docs.google].com/document/d/1pCA24HnsioJ0HqApuc9Zf5hGcgJjxskpImUAmarbtfU/edit\nhxxps://docs.google].com/document/d/1phEs-b8IHsTy84f670zIzyQFgRKsqQGOofFAcH3CdkI/edit\nhxxps://docs.google].com/document/d/1qcT11IVn26rKBJAA4gPpUcHFwIP4i4wGF2QBgIVquwM/edit\nhxxps://docs.google].com/document/d/1tRSWPhiV-KIYTOJaR-Dd1MLvYRsPmBsU5Hzxu8tg4-E/edit\nhxxps://docs.google].com/document/d/1wG-npl-Rx1WT00cYpjvrE_V_PzzxuavKLkpvYReLjvw/edit\n\n```\n\n-----\n\n**_Figure 21: Javali configuration obtained from Google Docs._**\n\nThe strings of the Google Docs files are encrypted and the algorithm used to encrypt strings\n[comes from the “Mestres da Espionagem Digital” book also used in another Latin](https://books.google.pt/books?id=0PdDnywBKl0C&printsec=frontcover&redir_esc=y#v=onepage&q&f=false)\n[American banking trojan such as Casbaneiro.](https://www.welivesecurity.com/2019/10/03/casbaneiro-trojan-dangerous-cooking/)\n\nCriminals also used a public library called DCPCrypt – a library responsible for encrypting\nbuffers with various algorithms. As observed in Figure 22, each of these algorithm classes\nhave string identifiers beginning with DCP string such as DCPPcrypt2, DCPsha512,\n_DCP_blockcipher128, etc. This library is used to facilitate the encryption communication_\nbetween the compromised machine and the C2 server via HTTPS protocol.\n\n\n-----\n\n**_Figure 23: Classe names of cryptographic algorithms used by Javali trojan._**\n\nOn the other side, the host information retrieved from Google Docs is obfuscated for obvious\n[reasons. Javali also adopts another third-party library named IndyProject for communication](https://www.indyproject.org/)\nwith the C2.\n\n**_Indy is an open-source client/server communications library that supports_**\n**_TCP/UDP/RAW sockets, as well as over 100 higher level protocols including SMTP,_**\n**_POP3, IMAP, NNTP, HTTP, FTP, and many more. Indy is written in Delphi but is also_**\n**_available for C++Builder and FreePascal._**\n\n\n-----\n\n**_Figure 24: IndyProject third-party library used by Javali._**\n\nFrom the analysis of Javali’s sample, information about C2 where extracted. By comparing\nthe first URL “claricepss.webcindario.]com” with other subdomains from “webcindario.]com”\nwhich translates to IP 5.57.226.]202, we can found that the domain has been used for a long\ntime by Brazilian criminals in campaigns this line.\n```\n6EEE37E3,\"mov\neax,avira.oe.nativecore.6EF18954\",\"&L\"\"hxxps://claricepss.webcindario.]com/pgl/index.p\n6EEE380B,\"mov eax,avira.oe.nativecore.6EF18970\",\"&L\"\"191.232.170.]12\"\"\" \n6EEE3815,\"mov eax,avira.oe.nativecore.6EF18974\",\"&L\"\"25325\"\"\"\n51.103.136.]92/nave/index.php\n\n```\nFor example, other directories were found upon the subdomain “claricepss” as observed\nbelow with malicious landing pages related to banking organizations available and used to\ncapture the victims’ credentials.\n```\n[13:38:54] 301 -  6KB - /bb -> https://claricepss.webcindario.]com/bb/\n[13:39:05] 301 -  6KB - /cadastro -> \nhttps://claricepss.webcindario.]com/cadastro/\n[13:39:18] 301 -  6KB - /chrome -> https://claricepss.webcindario.]com/chrome/\n[13:39:20] 301 -  6KB - /black -> https://claricepss.webcindario.]com/black/\n[13:39:21] 301 -  6KB - /imap -> https://claricepss.webcindario.]com/imap/\n[13:39:23] 301 -  6KB - /casa -> https://claricepss.webcindario.]com/casa/\n[13:39:30] 301 -  6KB - /pgl -> https://claricepss.webcindario.]com/pgl/\n[13:39:57] 301 -  6KB - /deco -> https://claricepss.webcindario.]com/deco/\n[13:40:52] 301 -  6KB - /xy -> https://claricepss.webcindario.]com/xy/\n\n```\n\n-----\n\n**_Figure 25: Banking landing-page used to collect credentials and lure victims during the_**\n_infection process._\n\nNext, we can observe the output from the C2 server of Javali trojan banker, with the last\ninfected victims and their geolocation, and also extracted passwords from online services\nhardcoded inside the malware such as:\n\n**kinghost.]com].br**\n**uolhost.]com.]br**\n**terra.]com.]br**\n\n\n-----\n\n-----\n\n**_Figure 26: C2 dashboard with last infections and victims’ credentials._**\n\nIn detail, these fake pages are shown during the infection chain in order to collect\ncredentials. Criminals control all the workflow and victims’ navigation in the background and\n[in real-time as detailed in this article related to a huge phishing campaign this nature –](https://seguranca-informatica.pt/the-evolution-of-phishing-infrastructure-a-large-scale-campaign-called-anubis-that-targets-brazilian-and-portuguese-internet-users/#.YCqRAWj7QuU)\n**[Anubis Phishing Network.](https://seguranca-informatica.pt/the-evolution-of-phishing-infrastructure-a-large-scale-campaign-called-anubis-that-targets-brazilian-and-portuguese-internet-users/#.YCujimj7RPY)**\n\n## Window overlay process\n\n\n-----\n\nWhen victims access a specific banking or financial portal, the malware triggers a new thread\nto launch the overlay windows. If the accessed portal matches the hardcoded banking\norganizations, Javali sends to the C2 a simple request with information about the infected\nmachine separated by markers such as “|” and “<“.\n\nFull list of hardcoded banking and financial organizations:\n\n\n-----\n\n```\nx2ddad8c (16): CrediSiS\n0x2ddadb4 (16): Viacredi\n0x2ddaddc (16): CIDETRAN\n0x2ddae04 (16): Daycoval\n0x2ddae2c (22): BRB Banknet\n0x2ddae54 (20): Banco Alfa\n0x2ddae7c (16): NBC BANK\n0x2ddaea4 (22): Pine Online\n0x2ddaecc (22): Banco Safra\n0x2ddaef4 (16): Banestes\n0x2ddaf1c (22): Banco Inter\n0x2ddaf44 (18): Banco BNB\n0x2ddaf6c (18): Mercantil\n0x2ddaf94 (18): Santander\n0x2ddafbc (16): Banco It\n0x2ddafe4 (18): Bradesco \n0x2ddb00c (22): [bb.com.br]\n0x2ddb034 (16): R4pp0rt \n0x2ddb05c (16): core.exe\n0x2ddb084 (22): SunAwtFrame\n0x2ddb0ac (16): Cursor_1\n0x2ddb0d4 (20): DWMAPI.dll\n0x2ddb0fc (18): Banco Ita\n0x2ddb124 (16): BL-0.ini\n0x2ddb14c (22): default_set\n0x2ddb174 (22): \\ConfXTheme\n0x2ddb19c (18): Microsoft\n0x2ddb1c4 (16): KingHost\n0x2ddb1ec (16): Locamail\n0x2ddb214 (20): Terra Mail\n0x2ddb23c (20): E-mail UOL\nAplicativo Itaú\nitauaplicativo.exe\nBanco Itaú\nAplicativo sicoob\nsicoob\nAplicativoBradesco.exe\nNavegadorExclusivoBradesco.exe\nAplicativo bradesco\nBanco Bradesco\nBanco do Brasil\nBanco Bradesco | Pessoa Física, Exclusive, Prime e Private\nBradesco \nPessoa jurídica | Bradesco\nBradesco JuJu\nBanco Itáu\nSantander\nBanco Santander\nSicredi\nBanco Sicredi\nMercantil\nBanco Mercantil\ninternetbanking\nCaixa Economica\nBanco Sicoob\n\n```\n\n-----\n\n```\nUnicred Portal\nBanco Unicred\nInternet Banking BNB\nBanco BNB\nBanco Inter\nBanco Intermedium\nBanco MUFG Brasil S.A.\nBanestes - Internet Banking\nBanestes\nInternet Banking\nBanpará\nCetelem | Login\nCooperativa de Crédito\nNova Home | Internet\nBanco Safra\nBANCO PAULISTA\nUNICRED\nUniprimeCentral\nBem vindo ao seu BMG\nPortal - Banco Votorantim\nPine Online\nNBC BANK\nTribanco Online\nBanco Alfa\nBanco Indusval & Partners\nPortal Internet Banrisul\nBanco Original\nAcesse sua conta Celcoin\nLogin - Nubank\nBRB Banknet\nBanco de Brasília\nBanco da Amazônia\nBanese\nBancoTopazioInternetBanking\nBancoIndustrial\nBanco Industrial\nDaycoval\nCIDETRAN\nViacredi\nMercado Pago\nCrediSiS\n\n```\nAs described, Javali is monitoring the accessed web-pages on the victim side. When a\nmatch is achieved, the communication with the C2 servers starts. The C2 server is\ngeolocated in Brazil, and a new port is generated dynamically each execution between a\nwell-defined range. Socket communication is established using the IndyProject library.\n\n\n-----\n\n**_Figure 27: Communication with the C2 server during the windows overlay process._**\n\n\n-----\n\nAs mentioned several times during this analysis, code sharing has been seen in different\nLatin American trojans. This kind of socket communication can be also observed during the\n**[Lampion trojan activity.](https://seguranca-informatica.pt/lampion-trojan-disseminated-in-portugal-using-covid-19-template/#.YCul9Gj7RPY)**\n\nMore, hardcoded C2 endpoints inside the Javali can be related to Grandoreiro activity as\n**[described in this article.](https://seguranca-informatica.pt/the-updated-grandoreiro-malware-equipped-with-latenbot-c2-features-in-q2-2020-now-extended-to-portuguese-banks/#.YCumL2j7RPY)**\n\n**Javali C2 endpoints hardcoded**\n\n**Grandoreiro C2 endpoints (right-side)**\n\n**_Figure 28: Grandoreiro C2 endpoints found hardcoded in the Javali sample._**\n\n\n-----\n\nAs with many other banking trojans, Javali supports several backdoor commands. The\ncapabilities of these commands include:\n\n**Obtaining screenshots with the help of the Windows Magnifying API, imported**\n**from Magnification.dll.**\n**Logging keystrokes**\n**Downloading and executing further payloads**\n**Restricting access to various banking websites**\n**Mouse and keyboard simulation**\n**Blocking the access to several Windows applications during the malware**\n**execution (such as Task Manager)**\n**Self-updating**\n**Stealing credentials from several email services, and banking/financial portals.**\n\n## Final Thoughts\n\nJavali is a potent piece of malware, whose primary capability is theft of banking information\nand other personal information from the user machine and sends it to the C2 server. This\ntrojan abuses a legitimate injector from Avira Firm to create a child process and loads into\nthe memory a protected DLL with the trojan operations. With this technique in place,\nbypassing some AV and EDR is possible and the trojan-activity can be masqueraded for a\nlong time.\n\nFrom Javali’s analysis, we can conclude that Latin American operators are sharing code\nbetween different trojans such as **[Lampion,](https://seguranca-informatica.pt/lampion-trojan-disseminated-in-portugal-using-covid-19-template/#.YCvft2j7RPY)** **[URSA,](https://seguranca-informatica.pt/threat-analysis-the-emergent-ursa-trojan-impacts-many-countries-using-a-sophisticated-loader/#.YCvk6Wj7RPY)** **[Grandoreiro,](https://seguranca-informatica.pt/the-updated-grandoreiro-malware-equipped-with-latenbot-c2-features-in-q2-2020-now-extended-to-portuguese-banks/)** **[Casbaneiro, and so on.](https://www.welivesecurity.com/2019/10/03/casbaneiro-trojan-dangerous-cooking/)**\n\nFinally, the trojan is a dangerous weapon, with the capabilities to self-update itself, capture\nkeystrokes and mouse movements, take screenshots, block access the several Windowsbased applications and banking and financial portals, and starting the windows overlay\nprocess when a legitimate portal is accessed.\n\nScreenshots of the windows launched by Javali, Mitre Att&ck Matrix, and other IOCs are\npresented below.\n\n## Windows overlay extracted from Javali trojan\n\n\n-----\n\n-----\n\n## Mitre Att&ck Matrix\n\n**Tactic** **ID** **Name** **Description**\n\n\n**Initial**\n**Access**\n\n\n[T1192](https://attack.mitre.org/techniques/T1192/) Spearphishing Link Javali campaigns start with\na spear-phishing email.\n\n\n[T1193](https://attack.mitre.org/techniques/T1193/) Spearphishing\nAttachment\n\n\nJava campaigns start with a\nmalicious email attachment\n(.zip file).\n\n\n**Execution** [T1073](https://attack.mitre.org/techniques/T1073/) DLL Side-Loading Javali campaigns are using\na legitimate executable from\nAvira Firm to inject into the\nmemory a malicious DLL.\n\n\n**Persistence** [T1060](https://attack.mitre.org/techniques/T1060/) Registry Run Keys / Startup\nFolder\n\n\nJavali gets persistence via\nRun key.\n\nJavali uses encrypted\nremote configuration from\nGoogle Docs and its\ncommands are also\nencrypted.\n\n\n**Defense**\n**Evasion**\n\n\n[T1140](https://attack.mitre.org/techniques/T1140/) Deobfuscate/Decode Files\nor Information\n\n\n[T1036](https://attack.mitre.org/techniques/T1036/) Masquerading Javali masquerades itself\nwith a legitimate application\n(Avira antivirus).\n\n\n-----\n\n[T1064](https://attack.mitre.org/techniques/T1064/) Scripting PowerShell and JavaScript\nare used in Javali\ndistribution chain.\n\n\n**Credential**\n**Access**\n\n\n[T1056](https://attack.mitre.org/techniques/T1056/) Input Capture Javali contains a command\nto execute a keylogger. It\nalso steals contents from\nfake windows overlay.\n\n\n**Discovery** [T1083](https://attack.mitre.org/techniques/T1083/) File and Directory\nDiscovery\n\n\nJavali searches for various\nfilesystem paths in order to\ndetermine what applications\nare installed on the victim’s\nmachine.\n\n\n[T1057](https://attack.mitre.org/techniques/T1057/) Process\nDiscovery\n\n[T1063](https://attack.mitre.org/techniques/T1063/) Security\nSoftware\nDiscovery\n\n[T1082](https://attack.mitre.org/techniques/T1082/) System\nInformation\nDiscovery\n\n\nJavali searches for various\nprocess names in order to\ndetermine what\napplications are running on\nthe victim’s machine.\n\nJavali scans the system for\ninstalled security software.\n\nJavali extracts the version\nof the operating system.\n\n\n**Collection** [T1113](https://attack.mitre.org/techniques/T1113/) Screen Capture Javali contains a command\nto take screenshots via\nWindows API.\n\n\n**Command**\n**and Control**\n\n\n[T1024](https://attack.mitre.org/techniques/T1024/) Custom Cryptographic\nProtocol\n\n\n**Exfiltration** [T1041](https://attack.mitre.org/techniques/T1041/) Exfiltration Over Command\nand Control Channel\n\n## Indicators of Compromise (IOCs)\n\n\nJavali uses cryptographic\nprotocols to communicate\nwith C2 server.\n\nJavali sends the data it\ncollects to its C&C server.\n\n\n-----\n\n```\n samples\nFT.FATURA.EKFUHLWS+LUVPBC0DGZUWISOAPDK.msi\nMD5: 70aa68c29622df360dea76daa4255835\nAvira.exe\nMD5: 8CBB75FEBFB4B0B7C3B6D3613386220C\nAvira.OE.NativeCore.dll\nMD5: 83c49ccc03e4abfad28e278ce98b4537\nmsvcp120.dll\nMD5: FD5CABBE52272BD76007B68186EBAF00\nmsvcr120.dll\nMD5: 034CCADC1C073E4216E9466B720F9849\nrundll32.exe\nMD5: 8CBB75FEBFB4B0B7C3B6D3613386220C\n--AWS S3 bucket-hxxps://hipermercado.s3-sa-east-1.amazonaws.]com/bretas.]png\n--C2 server-191.232.170.]12\n191.232.170.]12:35730\n191.232.170.]1\n191.232.177.]237\n--banking overlay fake pages-51.103.136.]92/nave/index.php\nhttps://claricepss.]webcindario.]com/pgl/index.php\nhxxps://claricepss.webcindario.]com/bb/ \nhxxps://claricepss.webcindario.]com/cadastro/ \nhxxps://claricepss.webcindario.]com/chrome/ \nhxxps://claricepss.webcindario.]com/black/ \nhxxps://claricepss.webcindario.]com/imap/ \nhxxps://claricepss.webcindario.]com/casa/ \nhxxps://claricepss.webcindario.]com/pgl/ \nhxxps://claricepss.webcindario.]com/deco/ \nhxxps://claricepss.webcindario.]com/xy/\n--Google Docs files w/ config-hxxps://docs.google].com/document/d/15dKy9iPdfKKUyI5JEn6lyhxramzevtn0siixKmnfNB0/edit\nhxxps://docs.google].com/document/d/15i3BIlOzTNOF3cIgA-o8YYa-u24q-DdcalWi5JMyxeU/edit\nhxxps://docs.google].com/document/d/18dBH_hLqlszwezEZkeFfACFo-nhCHHoCwc6qyxdoA2Y/edit\nhxxps://docs.google].com/document/d/18qfnad3gLJeUsZxZo-iRkYShxp72q5Ct4sUvCXxl0Ng/edit\nhxxps://docs.google].com/document/d/1E3RFnE4dlzD_wL96hMzNBlZZ8vNS-mM_Q48lDUFzwFA/edit\nhxxps://docs.google].com/document/d/1IM9fNp--iWLQPUVKjHBZUOwfi9Yv_BuUSojQTCidU3U/edit\nhxxps://docs.google].com/document/d/1MezQvI_dk_5R4zn_i5dhfSd86KULlFPCsNIUPEu-ZR8/edit\nhxxps://docs.google].com/document/d/1OetWS-gLaMbPBcxDQaVbNcYXb7hL4BsR8X_ouI-hz1g/edit\nhxxps://docs.google].com/document/d/1T-hcyJWouUdAIZ19DZ_guh723zgpL2H2c4kpcBL0Tqg/edit\nhxxps://docs.google].com/document/d/1UwICJoIrrey05PhmMpKVB2g3tMf9PYk4A-UeFHEOIsw/edit\nhxxps://docs.google].com/document/d/1W2GHf0vyCLNhVIDxF126mvbKFS9VC2RqU4n-5EXMZLA/edit\nhxxps://docs.google].com/document/d/1YTBuav90AWfG24KrZ25h41GnVXIzh3cSapf0sF5n8QI/edit\n\n```\n\n-----\n\n```\nhxxps://docs.google].com/document/d/1bGyEiUhvY1HvEkbIS7pNPWCODIRrfTyvK2TJLwEFgrw/edit\nhxxps://docs.google].com/document/d/1fUCxFdZGv3BUIMtba8tItJAJA3SY4ZR8UHPW0loT80Y/edit\nhxxps://docs.google].com/document/d/1iN1UvBtln4jXxMgNpGqGl3NF_YN1lhE_Ei11E2odFdo/edit\nhxxps://docs.google].com/document/d/1jR8nCxVdi4vnNUlLCpKz3LbpPK9RMzW3_hWGNgpe2nY/edit\nhxxps://docs.google].com/document/d/1o-b6lH-aadYKV1jr7imBgUiXgIFNwrkI-9aHlVAa4JQ/edit\nhxxps://docs.google].com/document/d/1ogLFEFF4G0PHJM2LBjd3dKFB4tAGiaTiUb2BA0ouuac/edit\nhxxps://docs.google].com/document/d/1pCA24HnsioJ0HqApuc9Zf5hGcgJjxskpImUAmarbtfU/edit\nhxxps://docs.google].com/document/d/1phEs-b8IHsTy84f670zIzyQFgRKsqQGOofFAcH3CdkI/edit\nhxxps://docs.google].com/document/d/1qcT11IVn26rKBJAA4gPpUcHFwIP4i4wGF2QBgIVquwM/edit\nhxxps://docs.google].com/document/d/1tRSWPhiV-KIYTOJaR-Dd1MLvYRsPmBsU5Hzxu8tg4-E/edit\nhxxps://docs.google].com/document/d/1wG-npl-Rx1WT00cYpjvrE_V_PzzxuavKLkpvYReLjvw/edit\n\n## Online Sandbox URLs\n\n```\n**FATURA.EKFUHLWS+LUVPBC0DGZUWISOAPDK.msi:**\n\nhttps://www.virustotal.com/gui/file/3c02cff7aa1784336ec96fce16cac267c812ce98ab6a7497c\n8b7f8c44c54a1e9/detection\n\n**Avira.exe:**\n\nhttps://www.virustotal.com/gui/file/f495d7c5c98457febc42ec96a959293788f6915e4245899d\n3bb1808ab84f0d9a/detection\n\n**Avira.OE.NativeCore.dll:**\nhttps://www.virustotal.com/gui/file/bdfa6dbba717b8faf4e0a049e90c6451b1980695f12b59d3d\n8d2ee6ef22e4da6/details\n\n## Yara rule\n```\nimport \"pe\"\nrule Javali_february_2021 {\nmeta:\n  description = \"Yara rule for Javali trojan - February version\"\n  author = \"SI-LAB - https://seguranca-informatica.pt\"\n  last_updated = \"2021-02-16\"\n  tlp = \"white\"\n  category = \"informational\"\n  condition:\n    filesize > 1000KB\n    and pe.characteristics & pe.DLL\n    and pe.exports(\"IsAviraSignedFile\") and pe.exports(\"MakeTrayIconVisible\")\n}\n\n```\n[Yara rule can be found on GitHub.](https://github.com/sirpedrotavares/SI-LAB-Yara_rules/blob/master/javali_trojan)\n\n[Pedro Tavares](https://seguranca-informatica.pt/author/pipocaz/)\n\n\n-----\n\n**[Pedro Tavares is a professional in the field of information security working as an Ethical](https://www.linkedin.com/in/sirpedrotavares/)**\nHacker/Pentester, Malware Researcher and also a Security Evangelist. He is also a founding\nmember at CSIRT.UBI and Editor-in-Chief of the security computer blog segurancainformatica.pt.\n\nIn recent years he has invested in the field of information security, exploring and analyzing a\nwide range of topics, such as pentesting (Kali Linux), malware, exploitation, hacking, IoT and\nsecurity in Active Directory networks. He is also Freelance Writer (Infosec. Resources\n[Institute and Cyber Defense Magazine) and developer of the 0xSI_f33d – a feed that](https://feed.seguranca-informatica.pt/)\ncompiles phishing and malware campaigns targeting Portuguese citizens.\n\n[Read more here.](https://seguranca-informatica.pt/contacto/)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-02-16 - Latin American Javali trojan weaponizing Avira antivirus legitimate injector to implant malware.pdf"
    ],
    "report_names": [
        "2021-02-16 - Latin American Javali trojan weaponizing Avira antivirus legitimate injector to implant malware.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673536041,
    "ts_updated_at": 1743041133,
    "ts_creation_date": 1653774475,
    "ts_modification_date": 1653774475,
    "files": {
        "pdf": "https://archive.orkl.eu/f8e29198931edf2381ff1d7602f2ae1a8db0ab9d.pdf",
        "text": "https://archive.orkl.eu/f8e29198931edf2381ff1d7602f2ae1a8db0ab9d.txt",
        "img": "https://archive.orkl.eu/f8e29198931edf2381ff1d7602f2ae1a8db0ab9d.jpg"
    }
}