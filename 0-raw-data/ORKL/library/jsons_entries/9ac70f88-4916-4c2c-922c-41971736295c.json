{
    "id": "9ac70f88-4916-4c2c-922c-41971736295c",
    "created_at": "2022-10-25T16:48:24.207154Z",
    "updated_at": "2025-03-27T02:10:40.118819Z",
    "deleted_at": null,
    "sha1_hash": "da87ca80af9057fe2d153e11f3f4a372a86fc314",
    "title": "BlackEnergy by the SSHBearDoor: attacks against Ukrainian news media and electric industry",
    "authors": "",
    "file_creation_date": "2016-01-06T10:42:59Z",
    "file_modification_date": "0001-01-01T00:00:00Z",
    "file_size": 397672,
    "plain_text": "|Type your keyword...|Col2|\n|---|---|\n\n\n**The cybercriminal group behind BlackEnergy, the malware family that has been around since 2007 and has**\n**made a comeback in 2014 (see our previous blog posts on Back in BlackEnergy *: 2014 Targeted Attacks**\n\n\n-----\n\n**ESET has recently discovered that the BlackEnergy trojan was recently used as a backdoor to deliver a**\n**destructive KillDisk component in attacks against Ukrainian news media companies and against the**\n**electrical power industry. In this blog, we provide details on the BlackEnergy samples ESET has detected in**\n**2015, as well as the KillDisk components used in the attacks. Furthermore, we examine a previously**\n**unknown SSH backdoor that was also used as another channel of accessing the infected systems, in**\n**addition to BlackEnergy.**\n\n**We continue to monitor the BlackEnergy malware operations for future developments. For any inquiries or**\n**[to make sample submissions related to the subject, contact us at: threatintel@eset.com](mailto:threatintel@eset.com)**\n\n## BlackEnergy evolution in 2015\n\n**Once activated, variants of BlackEnergy Lite allow a malware operator to check specific criteria in order to�**\n**assess whether the infected computer truly belongs to the intended target. If that is the case, the dropper**\n**of a regular BlackEnergy variant is pushed to the system. The exact mechanism of infection by**\n**[BlackEnergy is described in our Virus Bulletin presentation and this whitepaper by F-Secure.](https://www.virusbtn.com/conference/vb2014/abstracts/LM3-LipovskyCherepanov.xml)**\n\n**The BlackEnergy malware stores XML configuration data embedded in the binary of DLL payload.�**\n\n\n**Figure 1 – The BlackEnergy configuration example used in 2015�**\n\n\n**Apart from a list of C&C servers, the BlackEnergy config contains a value called build_id. This value is a�**\n**unique text string used to identify individual infections or infection attempts by the BlackEnergy malware**\n**operators. The combinations of letters and numbers used can sometimes reveal information about the**\n**campaign and targets.**\n\n**Here is the list of Build ID values that we identified in 2015:�**\n\n**2015en**\n\n**khm10**\n\n**khelm**\n\n**2015telsmi**\n\n\n-----\n\n**kiev_o**\n\n**brd2015**\n\n**11131526kbp**\n\n**02260517ee**\n\n**03150618aaa**\n\n**11131526trk**\n\n**We can speculate that some of them have a special meaning. For example 2015telsmi could contain the**\n**[Russian acronym SMI – Sredstva Massovoj Informacii, 2015en could mean Energy, and there’s also the](https://en.wiktionary.org/wiki/%D0%A1%D0%9C%D0%98)**\n**obvious “Kiev”.**\n\n## KillDisk component\n\n**In 2014 some variants of the BlackEnergy trojan contained a plugin designed for the destruction of the**\n**infected system, named dstr.**\n\n**In 2015 the BlackEnergy group started to use a new destructive BlackEnergy component detected by ESET**\n**products as Win32/KillDisk.NBB, Win32/KillDisk.NBC and Win32/KillDisk.NBD trojan variants.**\n\n**The main purpose of this component is to do damage to data stored on the computer: it overwrites**\n**documents with random data and makes the OS unbootable.**\n\n**The first known case where the KillDisk component of BlackEnergy was used was �documented by CERT-**\n**UA in November 2015. In that instance, a number of news media companies were attacked at the time of**\n**the 2015 Ukrainian local elections. The report claims that a large number of video materials and various**\n**documents were destroyed as a result of the attack.**\n\n**It should be noted that the Win32/KillDisk.NBB variant used against media companies is more focused on**\n**destroying various types of files and documents. It has a long list of file extensions that it tries to overwrite�**\n**and delete. The complete list contains more than 4000 file extensions.�**\n\n\n**Figure 2 – A partial list of file extensions targeted for destruction by KillDisk.NBB�**\n\n\n**The KillDisk component used in attacks against energy companies in Ukraine was slightly different. Our�**\n**analysis of the samples shows that the main changes made in the newest version are:**\n\n\n-----\n\n**should activate.**\n\n**It also deletes Windows Event Logs : Application, Security, Setup, System.**\n\n**It is less focused on deleting documents. Only 35 file extensions are targeted.�**\n\n\n**Figure 3 – A list of file extensions targeted for destruction by new variant of KillDisk component�**\n\n\n**As well as being able to delete system files to make the system unbootable – functionality typical for such�**\n**destructive trojans – the KillDisk variant detected in the electricity distribution companies also appears to**\n**contain some additional functionality specifically intended to sabotage industrial systems.�**\n\n**Once activated, this variant of the KillDisk component looks for and terminates two non-standard**\n**processes with the following names:**\n\n**komut.exe**\n\n**sec_service.exe**\n\n**We didn’t manage to find any information regarding the name of the first process (komut.exe).�**\n\n**The second process name may belong to software called ASEM Ubiquity, a software platform that is often**\n**used in Industrial control systems (ICS), or to ELTIMA Serial to Ethernet Connector. In case the process**\n**is found, the malware does not just terminate it, but also overwrites the executable file with random data.�**\n\n## Backdoored SSH server\n\n**In addition to the malware families already mentioned, we have discovered an interesting sample used by**\n**the BlackEnergy group. During our investigation of one of the compromised servers we found an**\n**[application that, at first glance, appeared to be a legitimate SSH server called �Dropbear SSH.](https://matt.ucc.asn.au/dropbear/dropbear.html)**\n\n**In the order to run the SSH server, the attackers created a VBS file with the following content:�**\n\n**Set WshShell = CreateObject(“WScript.Shell”)**\n**WshShell.CurrentDirectory = “C:\\WINDOWS\\TEMP\\Dropbear\\”**\n\n**WshShell.Run “dropbear.exe -r rsa -d dss -a -p 6789″, 0, false**\n\n**As is evident here, the SSH server will accept connections on port number 6789. By running SSH on the**\n**server in a compromised network, attackers can come back to the network whenever they want.**\n\n**However, for some reason this was not enough for them. After detailed analysis we discovered that the**\n**binary of the SSH server actually contains a backdoor.**\n\n\n-----\n\n**Figure 4 – Backdoored authentication function in SSH server**\n\n\n**As you can see in Figure 4, this version of Dropbear SSH will authenticate the user if the password**\n**passDs5Bu9Te7 was entered. The same situation applies to authentication by key pair – the server**\n**contains a pre-defined constant public key and it allows authentication only if a particular private key is�**\n**used.**\n\n\n**Figure 5 – The embedded RSA public key in SSH server**\n\n\n**ESET security solutions detect this threat as Win32/SSHBearDoor.A trojan.**\n\n## Indicators of Compromise (IoC)\n\n**IP addresses of BlackEnergy C2-servers:**\n\n**5.149.254.114**\n\n**5.9.32.230**\n**31.210.111.154**\n**88.198.25.92**\n\n**146.0.74.7**\n**188.40.8.72**\n\n**XLS document with malicious macro SHA-1:**\n\n**AA67CA4FB712374F5301D1D2BAB0AC66107A4DF1**\n\n**BlackEnergy Lite dropper SHA-1:**\n\n**4C424D5C8CFEDF8D2164B9F833F7C631F94C5A4C**\n\n\n-----\n\n**896FCACFF6310BBE5335677E99E4C3D370F73D96**\n\n**BlackEnergy drivers SHA-1:**\n\n**069163E1FB606C6178E23066E0AC7B7F0E18506B**\n**0B4BE96ADA3B54453BD37130087618EA90168D72**\n\n**1A716BF5532C13FA0DC407D00ACDC4A457FA87CD**\n**1A86F7EF10849DA7D36CA27D0C9B1D686768E177**\n**1CBE4E22B034EE8EA8567E3F8EB9426B30D4AFFE**\n**20901CC767055F29CA3B676550164A66F85E2A42**\n**2C1260FD5CEAEF3B5CB11D702EDC4CDD1610C2ED**\n\n**2D805BCA41AA0EB1FC7EC3BD944EFD7DBA686AE1**\n**4BC2BBD1809C8B66EECD7C28AC319B948577DE7B**\n**502BD7662A553397BBDCFA27B585D740A20C49FC**\n**672F5F332A6303080D807200A7F258C8155C54AF**\n**84248BC0AC1F2F42A41CFFFA70B21B347DDC70E9**\n**A427B264C1BD2712D1178912753BAC051A7A2F6C**\n**A9ACA6F541555619159640D3EBC570CDCDCE0A0D**\n\n**B05E577E002C510E7AB11B996A1CD8FE8FDADA0C**\n**BD87CF5B66E36506F1D6774FD40C2C92A196E278**\n**BE319672A87D0DD1F055AD1221B6FFD8C226A6E2**\n**C7E919622D6D8EA2491ED392A0F8457E4483EAE9**\n**CD07036416B3A344A34F4571CE6A1DF3CBB5783F**\n**D91E6BB091551E773B3933BE5985F91711D6AC3B**\n**E1C2B28E6A35AEADB508C60A9D09AB7B1041AFB8**\n\n**E40F0D402FDCBA6DD7467C1366D040B02A44628C**\n**E5A2204F085C07250DA07D71CB4E48769328D7DC**\n\n**KillDisk-components SHA-1:**\n\n**16F44FAC7E8BC94ECCD7AD9692E6665EF540EEC4**\n**8AD6F88C5813C2B4CD7ABAB1D6C056D95D6AC569**\n**6D6BA221DA5B1AE1E910BBEAA07BD44AFF26A7C0**\n**F3E41EB94C4D72A98CD743BBB02D248F510AD925**\n\n**VBS/Agent.AD trojan SHA-1:**\n\n**72D0B326410E1D0705281FDE83CB7C33C67BC8CA**\n\n**Win32/SSHBearDoor.A trojan SHA-1:**\n\n**166D71C63D0EB609C4F77499112965DB7D9A51BB**\n\n**[Picture credits: ©flickr/tanozzo�](https://www.flickr.com/photos/tanozzo/4778327737/in/photolist-8hfbmZ-bDuZYz-hDMaip-5VBPny-nTpobM-bjnSt8-obiT2T-6dLNys-ijocCK-b4MfsH-oKUfSr-xmzJEz-kXBnVr-kRUAw-6QwkKt-oaKuyv-itcRjN-5XJ5vs-4NWXby-eqCMfw-Uykkj-ozd6wq-84iqKk-YHqSi-x8SLP-b8Berg-9ZQbLV-kXBhDV-wazGaq-5UGzx1-hJd44C-gtMnyH-rgen12-rK8mhU-aryyDA-9mZLcv-m9CBct-kLyvjg-bf2wBz-8ZAdkB-4MVwFt-arJhqe-dp9nky-dUXpjv-Bd7HW-AXDksz-c3Z5dA-c3Z4Cs-c3Z3GC-c3YZU1)**\n\n**Whats app**\n\n\n-----\n\n**BlackEnergy trojan strikes again: Attacks Ukrainian electric**\n**power industry**\n\n**Moonfruit takes customers' sites offline, as it prepares for DDoS�**\n**attack**\n\n### Follow us\n\n**Sign up to our newsletter**\n\n\n**[5 things you need to know about social engineering](http://www.welivesecurity.com/2015/12/30/5-things-need-know-social-engineering/)**\n\n**[Europol makes 12 arrests in Remote Access Trojan crackdown](http://www.welivesecurity.com/2015/12/15/europol-makes-12-arrests-remote-access-trojan-crackdown/)**\n\n\n-----\n\n**Email...** **Submit**\n\n\n**Email...**\n\n\n**[About Us](http://www.welivesecurity.com/about-us/)**\n\n**[Contact Us](http://www.welivesecurity.com/contact-us/)**\n\n**[Home](http://www.welivesecurity.com/)**\n\n**[How To](http://www.welivesecurity.com/category/how-to/)**\n\n**[Expert Opinion](http://www.welivesecurity.com/category/opinion-2/)**\n\n**[Videos](http://www.welivesecurity.com/media/videos/)**\n\n**[Papers](http://www.welivesecurity.com/papers/conference-papers/)**\n\n**[Our Experts](http://www.welivesecurity.com/our-experts/)**\n\n**[Virus Radar](http://www.virusradar.com/)**\n\n**[Sitemap](http://www.welivesecurity.com/sitemap/)**\n\n**[Privacy](http://www.welivesecurity.com/privacy/)**\n\n**[Legal Information](http://www.welivesecurity.com/legal-information/)**\n\n**COPYRIGHT © 2016 ESET, ALL RIGHTS RESERVED.**\n\n\n**Submit**\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        }
    ],
    "references": [
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2016/2016.01.03.BlackEnergy_Ukrainian/blackenergy-sshbeardoor-details-2015-attacks-ukrainian-news-media-electric-industry.pdf"
    ],
    "report_names": [
        "blackenergy-sshbeardoor-details-2015-attacks-ukrainian-news-media-electric-industry"
    ],
    "threat_actors": [
        {
            "id": "a66438a8-ebf6-4397-9ad5-ed07f93330aa",
            "created_at": "2022-10-25T16:47:55.919702Z",
            "updated_at": "2025-03-27T02:05:17.412024Z",
            "deleted_at": null,
            "main_name": "IRON VIKING",
            "aliases": [
                "ATK14 ",
                "BlackEnergy Group",
                "Blue Echidna ",
                "CTG-7263 ",
                "ELECTRUM ",
                "FROZENBARENTS ",
                "Hades/OlympicDestroyer ",
                "IRIDIUM ",
                "Qudedagh ",
                "Sandworm Team ",
                "Seashell Blizzard ",
                "TEMP.Noble ",
                "Telebots ",
                "Voodoo Bear ",
                "APT44 "
            ],
            "source_name": "Secureworks:IRON VIKING",
            "tools": [
                " BlackEnergy",
                " GCat",
                " GreyEnergy",
                " Industroyer",
                " KillDisk",
                " NotPetya",
                " PSCrypt",
                " TeleBot",
                " TeleDoor",
                " xData",
                "BadRabbit"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "b3e954e8-8bbb-46f3-84de-d6f12dc7e1a6",
            "created_at": "2022-10-25T15:50:23.339976Z",
            "updated_at": "2025-03-27T02:00:55.446795Z",
            "deleted_at": null,
            "main_name": "Sandworm Team",
            "aliases": [
                "Sandworm Team",
                "ELECTRUM",
                "Telebots",
                "IRON VIKING",
                "BlackEnergy (Group)",
                "Quedagh",
                "Voodoo Bear",
                "IRIDIUM",
                "Seashell Blizzard",
                "FROZENBARENTS",
                "APT44"
            ],
            "source_name": "MITRE:Sandworm Team",
            "tools": [
                "Bad Rabbit",
                "Mimikatz",
                "Exaramel for Linux",
                "Exaramel for Windows",
                "GreyEnergy",
                "PsExec",
                "Prestige",
                "P.A.S. Webshell",
                "VPNFilter",
                "Cyclops Blink",
                "SDelete",
                "AcidRain",
                "Industroyer",
                "Industroyer2",
                "BlackEnergy",
                "Cobalt Strike",
                "NotPetya",
                "KillDisk",
                "PoshC2",
                "Impacket",
                "Invoke-PSImage",
                "Olympic Destroyer"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1666716504,
    "ts_updated_at": 1743041440,
    "ts_creation_date": 1452076979,
    "ts_modification_date": 0,
    "files": {
        "pdf": "https://archive.orkl.eu/da87ca80af9057fe2d153e11f3f4a372a86fc314.pdf",
        "text": "https://archive.orkl.eu/da87ca80af9057fe2d153e11f3f4a372a86fc314.txt",
        "img": "https://archive.orkl.eu/da87ca80af9057fe2d153e11f3f4a372a86fc314.jpg"
    }
}