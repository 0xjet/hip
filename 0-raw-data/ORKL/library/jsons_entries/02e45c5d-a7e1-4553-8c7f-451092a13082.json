{
    "id": "02e45c5d-a7e1-4553-8c7f-451092a13082",
    "created_at": "2023-01-12T15:00:50.273792Z",
    "updated_at": "2025-03-27T02:17:05.634715Z",
    "deleted_at": null,
    "sha1_hash": "228d203530c5052d9eca19b472d5ebc696ecf645",
    "title": "2022-05-12 - KurayStealer- A Bandit Using Discord Webhooks",
    "authors": "",
    "file_creation_date": "2022-05-28T18:16:04Z",
    "file_modification_date": "2022-05-28T18:16:04Z",
    "file_size": 1308184,
    "plain_text": "# KurayStealer: A Bandit Using Discord Webhooks\n\n**[uptycs.com/blog/kuraystealer-a-bandit-using-discord-webhooks](https://www.uptycs.com/blog/kuraystealer-a-bandit-using-discord-webhooks)**\n\n_Research by: Ashwin Vamshi and Shilpesh Trivedi_\n\nUptycs' threat research team has recently discovered a new malware builder—a tool sold to\ncriminals to make it easier to build malware—we have named KurayStealer that has\npassword stealing and screenshot capabilities. KurayStealer is a builder written in Python\nwhich harvests the passwords and screenshots and sends them to the attackers’ Discord\nchannel via webhooks. It is available as a free and commercial (VIP) software. This was\ndiscovered through the intelligence monitoring rules in our threat intelligence systems. Based\non the source code and the OSINT intelligence, we have evidence that the creator of this\nbuilder is of Spanish origin and has also started selling paid versions of password stealers\nwith added functionalities.\n\nThis blog post details the working of the KurayStealer and also shares insights into the\nauthor behind this malware.\n\n## Discovery of KurayStealer\n\nUptycs threat intelligence systems detected the first sample of KurayStealer on 27 April\n2022. Based on our OSINT research, this builder was first advertised on 23 April 2022 via\nthe Youtube and Discord handle carrying the name “Portu.”\n\n## KurayStealer Operation\n\nThe builder KurayStealer was identified in our intelligence systems on 27 April 2022 (hash 8535c08d7e637219470c701599b5de4b85f082c446b4d12c718fa780e7535f07) with filename\n**c2.py.**\n\nThe builder was written in Python and works in Python 3.0 (a.k.a. \"Python 3000\" or \"Py3k\").\n\nUpon execution, the builder checks for the universally unique identifier (UUID) using the\ncommand “wmic csproduct get UUID” (see Figure 1).\n\n_Figure 1: KurayStealer UUID check_\n\n\n-----\n\nThis check is performed to verify the generated UUID matches the list of UUIDs in the\nhttps://pastebin[.]com/raw/Hc9W90Ld to determine if the user is a free or VIP user (see\nFigure 2 ).\n\n_Figure 2: Builder asking to enter the user type and Discord Webhook_\n\nBased on the free or VIP user and the input of the webhook, a file named DualMTS.py,\nDualMTS_VIP.py is dropped in the machine. We have used the free version of the module for\ndemonstrating the functionality of the builder.\n\nDualMTS.py attempts to replace the string “api/webhooks” with “Kisses” in BetterDiscord in\nan attempt to bypass the protection and send webhooks seamlessly (see Figure 3).\n\n_Figure 3: Bypassing BetterDiscord protections_\n\n\n-----\n\nThe file DualMTS.py then attempts to take the screenshot of the machine using the python\nmodule “pyautogui”. Alongside this, it also takes the geo-location of the machine. The\nsnippet of this operation is shown in the figure below (see Figure 4).\n\n_Figure 4: Screenshot and geo-location in the builder_\n\nIt also harvests the passwords and tokens from a list of 21 software packages as follows:\nDiscord, Lightcord, Discord PTB, Opera, Opera GX, Amigo, Torch, Kometa, Orbitum,\nCentBrowser, 7Star, Sputnik, Vivaldi, Chrome SxS, Chrome, Epic Privacy Browser, Microsoft\nEdge, Uran, Yandex, Brave, Iridium\n\nThe harvested information including computername, geo-location, ipaddress, credentials and\nthe screenshot of the victim machine is sent over to the Discord channel via webhooks (see\nFigure 5).\n\n\n-----\n\n_Figure 5 : Credentials sent over Discord webhook_\n\nUptycs EDR armed with YARA process scanning detected the KurayStealer with a threat\nscore of 10/10 (see Figure 6).\n\n\n-----\n\n_Figure 6: Uptycs EDR detection of KurayStealer_\n\nAdditionally, Uptycs EDR contextual detection provides l details about the detected malware.\nUsers can navigate to the advanced threat section and click on the icon to learn about the\nbehavior and the operation of the malware.\n\n## KurayStealer OSINT\n\nUpon analyzing the builder code, we identified a snippet claiming the module was written\n“Suleymansha & Portu.” While the builder claims to be written by Suleymansha & Portu, we\nhave seen several other similar versions floating around in public repositories like github.\nBased on the working and implementation, the KurayStelaer builder has several components\nof different password stealers using Discord tokens as command and control (C2) channels\nfor harvesting victim data.\n\nThe builder code also contained the Discord channel invite link\nhttps://Discord[.]gg/AHR84u767J belonging to the creators behind this builder. The channel\nmentions a post of the commercial version of this builder at different pricing options (see\nFigure 7).\n\n\n-----\n\n_Figure 7 : Commercial versions_\n\nUpon looking into the channel, we found that the profile for the Discord user “portu” contains\na Discord channel name, Shoppy link, and YouTube link (see Figure 8).\n\n\n-----\n\n_Figure 8: Discord profile Portu_\n\nWe visited the YouTube link and identified the location of the user in Spain and found a video\ndemonstrating KurayStealer (see Figure 9).\n\n\n-----\n\n_Figure 9: Portu’s YouTube channel and demo video for KurayStealer_\n\nAlongside this, the shoppy profile link of “Portu” contained several other tools the author\nplanned to create and their commercial offerings (see Figure 10).\n\n\n-----\n\n_Figure 10: Portu Shoppy profile and offerings_\n\nAt the time of this writing, the author has deleted the YouTube video from his channel. The\nDiscord channel of the authors also had an announcement on 26 April 2022 of a\nransomware in the making. Based on the announcement and the observations, we believe\nthat the authors might come up with newer versions of password stealers and other malware.\n\n## Conclusion\n\nOur research on KurayStealer backed with OSINT highlights the rise in prevalence of\npassword stealers using Discord tokens as a C2 for harvesting the victims’ credentials.\nEnterprises must have tight security controls and multi-layered visibility and security\nsolutions to identify and detect such attacks. Uptycs’ EDR correlation engine detected the\nKurayStealer activity by correlating generic behavioral rules and YARA process scanning\ncapabilities.\n\n## IOCS\n\n### Hashes\n\n1. 8535c08d7e637219470c701599b5de4b85f082c446b4d12c718fa780e7535f07 (c2.py)\n2. 09844d550c91a834badeb1211383859214e65f93d54d6cb36161d58c84c49fab\n\n(DualMTS.py)\n3. 30b61be0f8d2a8d32a38b8dfdc795acc0fac4c60efd0459cb3a5a8e7ddb2a1c0 (C2.exe)\n\n## To learn more about the latest threat research conducted by the Uptycs Team, check out our most recent threat bulletin below.\n\n\n-----\n\nTag(s): [threat hunting,](https://www.uptycs.com/blog/tag/threat-hunting) [threat intelligence,](https://www.uptycs.com/blog/tag/threat-intelligence) [threat research,](https://www.uptycs.com/blog/tag/threat-research) [Featured](https://www.uptycs.com/blog/tag/featured)\n\n## Uptycs Threat Research\n\nResearch and updates from the Uptycs Threat Research team.\n\nConnect with the author\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-05-12 - KurayStealer- A Bandit Using Discord Webhooks.pdf"
    ],
    "report_names": [
        "2022-05-12 - KurayStealer- A Bandit Using Discord Webhooks.pdf"
    ],
    "threat_actors": [
        {
            "id": "75455540-2f6e-467c-9225-8fe670e50c47",
            "created_at": "2022-10-25T16:07:23.740266Z",
            "updated_at": "2025-03-27T02:02:09.955585Z",
            "deleted_at": null,
            "main_name": "Iridium",
            "aliases": [],
            "source_name": "ETDA:Iridium",
            "tools": [
                "CHINACHOPPER",
                "China Chopper",
                "LazyCat",
                "Powerkatz",
                "SinoChopper",
                "reGeorg"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "0661a292-80f3-420b-9951-a50e03c831c0",
            "created_at": "2023-01-06T13:46:38.928796Z",
            "updated_at": "2025-03-27T02:00:02.953963Z",
            "deleted_at": null,
            "main_name": "IRIDIUM",
            "aliases": [],
            "source_name": "MISPGALAXY:IRIDIUM",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "a66438a8-ebf6-4397-9ad5-ed07f93330aa",
            "created_at": "2022-10-25T16:47:55.919702Z",
            "updated_at": "2025-03-27T02:05:17.412024Z",
            "deleted_at": null,
            "main_name": "IRON VIKING",
            "aliases": [
                "ATK14 ",
                "BlackEnergy Group",
                "Blue Echidna ",
                "CTG-7263 ",
                "ELECTRUM ",
                "FROZENBARENTS ",
                "Hades/OlympicDestroyer ",
                "IRIDIUM ",
                "Qudedagh ",
                "Sandworm Team ",
                "Seashell Blizzard ",
                "TEMP.Noble ",
                "Telebots ",
                "Voodoo Bear ",
                "APT44 "
            ],
            "source_name": "Secureworks:IRON VIKING",
            "tools": [
                " BlackEnergy",
                " GCat",
                " GreyEnergy",
                " Industroyer",
                " KillDisk",
                " NotPetya",
                " PSCrypt",
                " TeleBot",
                " TeleDoor",
                " xData",
                "BadRabbit"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "b3e954e8-8bbb-46f3-84de-d6f12dc7e1a6",
            "created_at": "2022-10-25T15:50:23.339976Z",
            "updated_at": "2025-03-27T02:00:55.446795Z",
            "deleted_at": null,
            "main_name": "Sandworm Team",
            "aliases": [
                "Sandworm Team",
                "ELECTRUM",
                "Telebots",
                "IRON VIKING",
                "BlackEnergy (Group)",
                "Quedagh",
                "Voodoo Bear",
                "IRIDIUM",
                "Seashell Blizzard",
                "FROZENBARENTS",
                "APT44"
            ],
            "source_name": "MITRE:Sandworm Team",
            "tools": [
                "Bad Rabbit",
                "Mimikatz",
                "Exaramel for Linux",
                "Exaramel for Windows",
                "GreyEnergy",
                "PsExec",
                "Prestige",
                "P.A.S. Webshell",
                "VPNFilter",
                "Cyclops Blink",
                "SDelete",
                "AcidRain",
                "Industroyer",
                "Industroyer2",
                "BlackEnergy",
                "Cobalt Strike",
                "NotPetya",
                "KillDisk",
                "PoshC2",
                "Impacket",
                "Invoke-PSImage",
                "Olympic Destroyer"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "8941e146-3e7f-4b4e-9b66-c2da052ee6df",
            "created_at": "2023-01-06T13:46:38.402513Z",
            "updated_at": "2025-03-27T02:00:02.824555Z",
            "deleted_at": null,
            "main_name": "Sandworm",
            "aliases": [
                "G0034",
                "IRIDIUM",
                "Blue Echidna",
                "FROZENBARENTS",
                "Seashell Blizzard",
                "IRON VIKING",
                "ELECTRUM",
                "TeleBots",
                "UAC-0113",
                "UAC-0082",
                "APT44",
                "Quedagh",
                "VOODOO BEAR",
                "TEMP.Noble"
            ],
            "source_name": "MISPGALAXY:Sandworm",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "7bd810cb-d674-4763-86eb-2cc182d24ea0",
            "created_at": "2022-10-25T16:07:24.1537Z",
            "updated_at": "2025-03-27T02:02:10.126127Z",
            "deleted_at": null,
            "main_name": "Sandworm Team",
            "aliases": [
                "APT 44",
                "ATK 14",
                "BE2",
                "Blue Echidna",
                "CTG-7263",
                "FROZENBARENTS",
                "IRIDIUM",
                "Iron Viking",
                "Quedagh",
                "Sandworm",
                "Sandworm Team",
                "Seashell Blizzard",
                "TEMP.Noble",
                "UAC-0082",
                "UAC-0113",
                "UAC-0125",
                "UAC-0133",
                "Voodoo Bear"
            ],
            "source_name": "ETDA:Sandworm Team",
            "tools": [
                "AWFULSHRED",
                "ArguePatch",
                "BIASBOAT",
                "Black Energy",
                "BlackEnergy",
                "CaddyWiper",
                "Colibri Loader",
                "Cyclops Blink",
                "CyclopsBlink",
                "DCRat",
                "DarkCrystal RAT",
                "Fobushell",
                "GOSSIPFLOW",
                "Gcat",
                "IcyWell",
                "Industroyer2",
                "JaguarBlade",
                "JuicyPotato",
                "Kapeka",
                "KillDisk.NCX",
                "LOADGRIP",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "ORCSHRED",
                "P.A.S.",
                "PassKillDisk",
                "Pitvotnacci",
                "PsList",
                "QUEUESEED",
                "RansomBoggs",
                "RottenPotato",
                "SOLOSHRED",
                "SwiftSlicer",
                "VPNFilter",
                "Warzone",
                "Warzone RAT",
                "Weevly"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535650,
    "ts_updated_at": 1743041825,
    "ts_creation_date": 1653761764,
    "ts_modification_date": 1653761764,
    "files": {
        "pdf": "https://archive.orkl.eu/228d203530c5052d9eca19b472d5ebc696ecf645.pdf",
        "text": "https://archive.orkl.eu/228d203530c5052d9eca19b472d5ebc696ecf645.txt",
        "img": "https://archive.orkl.eu/228d203530c5052d9eca19b472d5ebc696ecf645.jpg"
    }
}