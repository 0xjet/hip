{
    "id": "77996444-7308-4792-9eaa-42a79be84474",
    "created_at": "2023-03-04T02:05:54.428246Z",
    "updated_at": "2025-03-27T02:16:47.059753Z",
    "deleted_at": null,
    "sha1_hash": "f9dc47847698fb913f004b17525a16d37a7c711c",
    "title": "Mustang Panda APT Group Uses European Commission-Themed Lure to Deliver PlugX Malware",
    "authors": "Eclecticiq",
    "file_creation_date": "2023-03-03T03:15:32Z",
    "file_modification_date": "2023-03-03T03:15:32Z",
    "file_size": 3576473,
    "plain_text": "# Mustang Panda APT Group Uses European Commission- Themed Lure to Deliver PlugX Malware\n\n**[blog.eclecticiq.com/mustang-panda-apt-group-uses-european-commission-themed-lure-to-deliver-plugx-malware](https://blog.eclecticiq.com/mustang-panda-apt-group-uses-european-commission-themed-lure-to-deliver-plugx-malware)**\n\n## EXECUTIVE SUMMARY\n\nSince at least 2019, the Mustang Panda threat actor group has targeted government and public\nsector organizations across Asia and Europe [3] with long-term cyberespionage campaigns in\nline with strategic interests of the Chinese government.\nIn November 2022, Mustang Panda shifted from using archive files to using malicious optical\ndisc image (ISO) files containing a shortcut (LNK) file to deliver the modified version of PlugX\nmalware. This switch increases the evasion against anti-malware solutions [2].\nThe Mustang Panda APT group loads the PlugX malware in the memory of legitimate software\nby employing a four-stage infection chain which leverages malicious shortcut (LNK) files,\ntriggering execution via dynamic-link library (DLL) search-order-hijacking.\n\n## PLUGX MALWARE EXECUTION FLOW\n\nFigure 1 – Execution flow of PlugX malware.\n\n\n-----\n\n**First Stage: PlugX Malware Delivered by ISO Image**\n\nIn the first stage of the infection chain, EclecticIQ researchers assess that the malware was almost\ncertainly delivered by a malicious email with an ISO image attachment. The ISO image contains a\nshortcut (LNK) file, but it decoyed as a DOC file called “draft letter to European Commission\nRUSSIAN OIL PRICE CAP sg de.doc”.\n\nThe malicious LNK file contains a command line argument that can be executed by user execution to\nstart the PlugX malware execution chain.\n\nThe command line argument of “draft letter to European Commission RUSSIAN OIL PRICE CAP sg\nde.doc” is shown below:\n\nC:\\Windows\\System32\\cmd.exe /q /c \"System Volume Information\\ \\test2022.ucp\"\n\nThe test2022.ucp portion of the command line argument is a renamed legitimate software which is\noriginally called LMIGuardianSvc.exe. This executable is abused to perform DLL hijacking and to load\nthe initial PlugX loader called LMIGuardianDll.dll. The legitimate and malicious executables are\nplaced on the same file path (System Volume Information) to perform DLL Hijacking.\n\nFigure 2 – Command line argument of malicious shortcut (LNK) file.\n\n\n-----\n\nFigure 3 -PlugX malware loader execution file path.\n\n**Second Stage: DLL Hijacking Execution Chain to Load PlugX Malware**\n\nWhen a victim clicks on the shortcut file, it executes the command line argument mentioned in first\nstage, which is a technique called DLL hijacking (after the execution of LMIGuardianSvc.exe, it loads\nLMIGuardianDll.dll aka PlugX loader automatically). Upon execution of the PlugX loader a Microsoft\nOffice Word document opens. The document is named “draft letter to European Commission\nRUSSIAN OIL PRICE CAP sg de.docx”. This is a decoy document to trick the user into thinking there\nis no malicious activity.\n\nOne example of the Word document can be seen in the image below:\n\n\n-----\n\nFigure 4 – A decoy Word document is used for social engineering. The victim sees a real Word\ndocument open after clicking on a shortcut (LNK) file that has a Word document icon.\n\nThe process tree below shows the execution of the legitimate application LMIGuardianSvc.exe, which\nis executed twice under a new directory (\\AppData\\Roaming\\SamsungDriver) created by the\nmalware and used for persistence access on infected device.\n\nFigure 5 – Captured process tree during the execution of malicious shortcut (LNK) file which\nmasquerades as a word document.\n\nEncrypted shellcode named LMIGuardianDat.dat contains PlugX malware:\n\nFigure 6 - Encrypted PlugX shellcode in Hex editor.\n\nThe PlugX Malware loader decrypts and loads the encrypted shellcode (LMIGuardianDat.dat) inside\nthe LMIGuardianSvc.exe. Injected memory space can be extracted to perform further analysis of\ndecrypted PlugX Malware.\n\n\n-----\n\nFigure 7 – Memory map of LMIGuardianSvc.exe.\n\nLMIGuardianDLL.dll (PlugX Loader) decrypts the LMIGuardianDAT.dat and loads it in memory of\nthe legitimate process.\n\nFigure 8 – Decompiled PlugX loader contains decryption function.\n\nDuring static analysis, EclecticIQ analysts identified that the PlugX malware loader used a simple\nXOR algorithm to decrypt the LMIGuardianDAT.dat (XOR encrypted PlugX shellcode) to avoid\nsignature-based detection from antimalware solutions.\n\n\n-----\n\nFigure 9 – XOR key is stored statically to perform decryption during execution time of PlugX loader.\n\nPlugX loader used a static XOR key “0x47F”, to decrypt the PlugX shellcode. The below image shows a\nPython script being used to decrypt the LMIGuardianDAT.dat.\n\nFigure 10 – Decrypted PlugX shellcode.\n\nOnce the PlugX malware has been executed in-memory, the C2 config is decrypted. The C2 IP address\n217[.]12[.]206[.]116 and the campaign ID of “test2022” are seen in the figures below:\n\n\n-----\n\nFigure 11 – Decompiled PlugX malware contains campaign ID as a fingerprint of the attack to\ncategorize the victims.\n\nFigure 12 - Decompiled PlugX malware contains command and control (C2) IP address as static.\n\n**Third Stage: Registry Run Key Persistence**\n\nMustang Panda abuses Windows registry run keys to gain persistence on the infected system. On\nWindows operating systems the run registry keys execute the specified program when a user logs on\nto the device.\n\nThe PlugX malware created a new run key called as LMIGuardian Update, shown in the image below.\n\nFigure 13 – Persistence established by malware after writing a new Run key.\n\nEvery logon will cause the Windows registry run key to execute the LMIGuardianSvc.exe, triggering\nthe DLL Hijacking that leads to PlugX malware execution.\n\n\n-----\n\nFigure 14 – Written registry key.\n\nThe malware creates a new file path which is being used by the persistence mechanism (Run key) to\nexecute the LMIGuardianSvc.exe on this specific file path:\n\nFigure 15 – New file path created for persistence execution of PlugX malware.\n\n**Fourth Stage: Command and Control Connection**\n\nAfter a successful execution of PlugX malware, it connects to a remote C2 server which is used to send\ncommands to compromised systems via the PlugX malware and to receive exfiltrated data from a\ntarget network.\n\n\n-----\n\nFigure 16 – Request headers and server response observed in Mustang Panda’s customized PlugX\nvariant.\n\nOnce the device is infected, an attacker can remotely execute several kinds of commands on the\naffected system. ‘Sec-Dest’ and ‘Sec-Site’ HTTP sections contain encrypted data of victim machine\ninformation sent to attackers.\n\nFigure 17 - Network capture during the TCP request to remote C2 server over port 443.\n\nThe C2 IP address 217[.]12[.]206[.]116 was seen hosting another service on port 8088 with a unique\nSSL certificate that is itself issued to the IP address 45[.]134[.]83[.]29, which is identified as\nadditional Mustang Panda’s infrastructure, according to the BlackBerry Research & Intelligence Team\n\n[1].\n\n\n-----\n\nFigure 18 – Issued SSL certificate contains another IP address, which was used by Mustang Panda\nAPT group for previous attacks. [1]\n\n## Conclusion\n\nEclecticIQ analysts assess it is almost certain the APT group Musta Panda was responsible for this\nattack. Mustang Panda has leveraged PlugX malware in previous campaigns targeting the Ukraine\nand has used similar TTPs like DLL hijacking. The group previously used Windows shortcut (LNK)\nfiles disguised using double extensions (such as .doc.lnk) with a Microsoft Word icon and has abused\nregistry run keys for persistence. The SSL certificated used in this attack overlaps with previous\nMustang Panda activity targeting the Ukraine.\n\nFigure 19 – Example of LNK Phishing lure used by Mustang Panda APT group in their previous\nattacks. [2]\n\nEclecticIQ analysts assess it is probable the target for this lure document was a European entity. The\nphishing lure used in the campaign discusses the effect EU sanctions against Russia will have on the\nEuropean Union. Mustang Panda has targeted European organizations before in a similar campaign\nin 2022-10-26 [Figure 19]. Mustang Panda APT group continues to be a highly active threat group\nconducting cyber operations targeting organizations across Europe [2]. EclecticIQ analysts have\n\n\n-----\n\nidentified Mustang Panda operators adding new evasion techniques, like using a custom malware\nloader to execute an encrypted PlugX sample for the purpose of increasing infection rates and staying\nunder the radar while performing cyber espionage activates against victims.\n\nEclecticIQ analysts assess that it is probable Mustang Panda will increase their activity and continue\nto use similar TTPs in response to geopolitical developments in Ukraine and Europe, based on an\nexamination of the group’s previous cyberespionage activity. Analysts should continue to track\nMustang Panda using the TTPs and infrastructure highlighted in the report and the YARA rules\nprovided below.\n\n## Mitigations \n\nImplement basic incident response and detection deployments and controls like network IDS,\nnetflow collection, host-logging, and web proxy, alongside human monitoring of detection\nsources.\nEmploy host-based controls.\nFilter email correspondence and monitor for malicious attachments.\nIdentify critical data and implement additional network segmentation and special protections\nfor sensitive information, such as multifactor authentication, highly restricted access, and\nstorage systems only accessible via an internal network.\nCreate alerts for disk image file types, such as ISO, and shortcut files, which have been\nincreasingly abused by different threat actors. Furthermore, organizations should consider\ndisabling auto-mounting of ISO or VHD files.\nConfigure intrusion detection systems (IDS), intrusion prevention systems (IPS), or any\nnetwork defence mechanisms in place to alert on and upon review, consider blocking connection\nattempts from unrecognized external IP addresses and domains.\n\n## MITRE ATT&CK\n\n**Tactic: Technique** **ATT&CK**\n**Code**\n\nExecution: User Execution Malicious File T1204\n\nDefense Evasion: Hijack Execution Flow DLL Search Order Hijacking T1574.001\n\nDefense Evasion: Deobfuscate/Decode Files or Information T1140\n\nDefense Evasion: Masquerading Double File Extension T1036.007\n\nCommand-and-Control: Encrypted Channel Symmetric Cryptography T1573.001\n\nCommand-and-Control: Data Encoding Standard Encoding T1132.001\n\n\n-----\n\nPersistence: Boot or Logon Autostart Execution: Registry Run Keys / Startup\nFolder\n\n## INDICATORS OF COMPROMISE\n\n\nT1547.001\n\n\n**Sample File**\n**Name(s)**\n\n\n**SHA-256 Hash**\n\n\nLMIGuardianDll.dll ee2c8909089f53aafc421d9853c01856b0a9015eba12aa0382e98417d28aef3f\n\nLMIGuardianDat.dat 8c4926dd32204b6a666b274a78ccfb16fe84bbd7d6bc218a5310970c4c5d9450\n\n\ndraft letter to\nEuropean\nCommission\nRUSSIAN OIL\nPRICE CAP sg\nde.iso\n\ndraft letter to\nEuropean\nCommission\nRUSSIAN OIL\nPRICE CAP sg\nde.doc.lnk\n\nLMIGuardianSvc.exe\nrenamed\n(test2022.ucp)\n\n\n723d804cfc334cad788f86c39c7fb58b42f452a72191f7f39400cf05d980b4f3\n\n2c0273394cda1b07680913edd70d3438a098bb4468f16eebf2f50d060cdf4e96\n\n26c855264896db95ed46e502f2d318e5f2ad25b59bdc47bd7ffe92646102ae0d\n\n\n**Command and Control Servers**\n\n217[.]12[.]206[.]116\n\n45[.]134[.]83[.]29\n\n## Hunting Resources: Live Queries & Yara Rules\n\n About EclecticIQ Intelligence & Research Team\n\n\n-----\n\nEclecticIQ is a global provider of threat intelligence, hunting, and response technology and services.\n[Headquartered in Amsterdam, the EclecticIQ Intelligence & Research Team is made up of experts](https://www.eclecticiq.com/eclecticiq-intelligence-research-team)\nfrom Europe and the U.S. with decades of experience in cyber security and intelligence in industry\nand government.\n\nWe would love to hear from you. Please send us your feedback by emailing us\n[at research@eclecticiq.com.](mailto:research@eclecticiq.com)\n\n## You might also be interested in:\n\n[QakBot Malware Used Unpatched Vulnerability to Bypass Windows OS Security Feature](https://blog.eclecticiq.com/qakbot-malware-used-unpatched-vulnerability-to-bypass-windows-os-security-feature)\n\n[ChatGPT Makes Waves Inside and Outside of the Tech Industry](https://blog.eclecticiq.com/chatgpt-makes-waves-inside-and-outside-of-the-tech-industry)\n\n[The Godfather Banking Trojan Expands Application Targeting to Affect More Europe-Based Victims](https://blog.eclecticiq.com/the-godfather-banking-trojan-expands-application-targeting-to-affect-more-europe-based-victims)\n\n## Appendix\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "d63ae2b7-445f-460d-965d-2676dacdb6de",
            "created_at": "2022-10-25T15:59:19.552139Z",
            "updated_at": "2022-10-25T15:59:19.552139Z",
            "deleted_at": null,
            "name": "APTnotes",
            "url": "https://github.com/aptnotes/data",
            "description": "APTnotes data",
            "reports": null
        }
    ],
    "references": [
        "https://app.box.com/s/3r1jwpewyxlnj8efx3tr6ctw9d2xghsf"
    ],
    "report_names": [
        "Eclecticiq_MustangPandaAPT-EUThemed-Lure-PlugX(02-02-2023)"
    ],
    "threat_actors": [
        {
            "id": "1691c25f-1aa4-4168-8ce2-7aa8f23246e7",
            "created_at": "2024-06-04T02:03:07.724221Z",
            "updated_at": "2025-03-27T02:05:17.284601Z",
            "deleted_at": null,
            "main_name": "BRONZE PRESIDENT",
            "aliases": [
                "Mustang Panda ",
                "Red Lich ",
                "Temp.Hex ",
                "HoneyMyte "
            ],
            "source_name": "Secureworks:BRONZE PRESIDENT",
            "tools": [
                " Cobalt Strike",
                " ORat",
                " PlugX",
                " RCSession",
                "China Chopper"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "b69037ec-2605-4de4-bb32-a20d780a8406",
            "created_at": "2023-01-06T13:46:38.790766Z",
            "updated_at": "2025-03-27T02:00:02.919758Z",
            "deleted_at": null,
            "main_name": "MUSTANG PANDA",
            "aliases": [
                "TEMP.HEX",
                "TA416",
                "TANTALUM",
                "Twill Typhoon",
                "Earth Preta",
                "Stately Taurus",
                "LuminousMoth",
                "Polaris",
                "BRONZE PRESIDENT",
                "HoneyMyte",
                "Red Lich"
            ],
            "source_name": "MISPGALAXY:MUSTANG PANDA",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "9baa7519-772a-4862-b412-6f0463691b89",
            "created_at": "2022-10-25T15:50:23.354429Z",
            "updated_at": "2025-03-27T02:00:55.45162Z",
            "deleted_at": null,
            "main_name": "Mustang Panda",
            "aliases": [
                "Mustang Panda",
                "TA416",
                "RedDelta",
                "BRONZE PRESIDENT"
            ],
            "source_name": "MITRE:Mustang Panda",
            "tools": [
                "Cobalt Strike",
                "RCSession",
                "NBTscan",
                "PoisonIvy",
                "PlugX"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "2ee03999-5432-4a65-a850-c543b4fefc3d",
            "created_at": "2022-10-25T16:07:23.882813Z",
            "updated_at": "2025-03-27T02:02:10.0116Z",
            "deleted_at": null,
            "main_name": "Mustang Panda",
            "aliases": [
                "Bronze President",
                "Camaro Dragon",
                "Earth Preta",
                "HoneyMyte",
                "Mustang Panda",
                "Operation SMUGX",
                "Operation SmugX",
                "PKPLUG",
                "Red Lich",
                "Stately Taurus",
                "TEMP.Hex"
            ],
            "source_name": "ETDA:Mustang Panda",
            "tools": [
                "9002 RAT",
                "AdFind",
                "Agent.dhwf",
                "Agentemis",
                "CHINACHOPPER",
                "China Chopper",
                "Chymine",
                "ClaimLoader",
                "Cobalt Strike",
                "CobaltStrike",
                "DCSync",
                "DOPLUGS",
                "Darkmoon",
                "Destroy RAT",
                "DestroyRAT",
                "Farseer",
                "Gen:Trojan.Heur.PT",
                "HOMEUNIX",
                "Hdump",
                "HenBox",
                "HidraQ",
                "Hodur",
                "Homux",
                "HopperTick",
                "Hydraq",
                "Impacket",
                "Kaba",
                "Korplug",
                "LadonGo",
                "MQsTTang",
                "McRAT",
                "MdmBot",
                "Mimikatz",
                "NBTscan",
                "NetSess",
                "Netview",
                "Orat",
                "POISONPLUG.SHADOW",
                "PUBLOAD",
                "PVE Find AD Users",
                "PlugX",
                "Poison Ivy",
                "PowerView",
                "QMAGENT",
                "RCSession",
                "RedDelta",
                "Roarur",
                "SPIVY",
                "ShadowPad Winnti",
                "SinoChopper",
                "Sogu",
                "TIGERPLUG",
                "TONEINS",
                "TONESHELL",
                "TVT",
                "TeamViewer",
                "Thoper",
                "TinyNote",
                "WispRider",
                "WmiExec",
                "XShellGhost",
                "Xamtrav",
                "Zupdax",
                "cobeacon",
                "nbtscan",
                "nmap",
                "pivy",
                "poisonivy"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1677895554,
    "ts_updated_at": 1743041807,
    "ts_creation_date": 1677813332,
    "ts_modification_date": 1677813332,
    "files": {
        "pdf": "https://archive.orkl.eu/f9dc47847698fb913f004b17525a16d37a7c711c.pdf",
        "text": "https://archive.orkl.eu/f9dc47847698fb913f004b17525a16d37a7c711c.txt",
        "img": "https://archive.orkl.eu/f9dc47847698fb913f004b17525a16d37a7c711c.jpg"
    }
}