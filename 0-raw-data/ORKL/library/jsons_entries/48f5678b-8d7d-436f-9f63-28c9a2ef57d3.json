{
    "id": "48f5678b-8d7d-436f-9f63-28c9a2ef57d3",
    "created_at": "2023-01-12T15:08:05.254988Z",
    "updated_at": "2025-03-27T02:06:02.166923Z",
    "deleted_at": null,
    "sha1_hash": "41f80c0b87c79f78ab58c4161ef221dcdcc5b674",
    "title": "2020-01-16 - FTCODE Ransomware - New Version Includes Stealing Capabilities",
    "authors": "",
    "file_creation_date": "2022-05-27T23:21:31Z",
    "file_modification_date": "2022-05-27T23:21:31Z",
    "file_size": 2355501,
    "plain_text": "# FTCODE Ransomware — New Version Includes Stealing Capabilities\n\n**[zscaler.com/blogs/research/ftcode-ransomware--new-version-includes-stealing-capabilities](https://www.zscaler.com/blogs/research/ftcode-ransomware--new-version-includes-stealing-capabilities)**\n\nRecently, the Zscaler ThreatLabZ team came across PowerShell-based ransomware called “FTCODE,”\nwhich targets Italian-language users. An earlier version of FTCODE ransomware was being downloaded\nusing a document file that contained malicious macros. In the recent campaign, the ransomware is being\ndownloaded using VBScript.\n\n_Figure 1: FTCODE downloaders observed in the Zscaler cloud (Office documents in red and VBScripts_\n_in yellow)_\n\nThe latest version we’ve seen in the Zscaler cloud contains version number 1117.1. We also came\nacross this malware with version numbers from 1001.7 to 1117.1. In this blog, we’ll describe the infection\nmethod and its techniques for stealing credentials.\n\n\n-----\n\n## Technical details\n\nInfection starts with spam emails containing malicious macro documents and, more recently, containing\nlinks to VBScripts that further download a PowerShell script known as FTCODE ransomware. Once a\nuser executes the VBScript, it executes the PowerShell script shown in the screenshot below.\n\n_Figure 2: PowerShell script to download a decoy image and the ransomware_\n\nThe script first downloads a decoy image into the %temp% folder and opens it trying to trick users into\nbelieving that they simply received an image, but in the background, it downloads and runs the\nransomware.\n\n_Figure 3: Decoy image_\n\nThe downloaded script is saved in %Public%\\Libraries\\WindowsIndexingService.vbs. The screenshot\nbelow displays the command-and-control (C&C) request for downloading the VBScript.\n\n\n-----\n\n_Figure 4: C&C communication request to download VBScript_\n\n## Persistence\n\nFurther, the malware creates a shortcut file called windowsIndexingService.lnk in the victim’s startup\nfolder, so it will execute at every reboot. The shortcut file executes the\n_%Public%\\Libraries\\WindowsIndexingService.vbs. It also creates a scheduled task named_\n_WindowsApplicationService for executing the WindowsIndexingService.vbs file._\n\nFTCODE checks if the file \\%temp%\\quanto00.tmp exists. If the file exists and was created more than 30\nminutes ago, FTCODE will write the current time in the file; otherwise, it will exit the script. It also checks\nfor the file %public%\\OracleKit\\w00log03.tmp that contains GUID; if it doesn’t find the file, it writes GUID\ninto the file w00log03.tmp and changes the file attribute to hidden.\n\n## C&C communication\n\nThe malware sends information to its C&C as shown in the screenshot below.\n\n\n-----\n\n_Figure 5: Sending data to the C&C_\n\nver = 1117.1 version\nvid = vb5, specific campaign identifier\nguid = GUID\next = first 6 characters of newly generated GUID (Extension of encrypted file)\nr1 = base 64 encoded (base 64 encode(encrypted (8 character GUID + 42 random characters));\nBase 64 encoded(encrypted((Random 23 + Random 11))))\n\nThe malware creates random characters and is encrypted using the RSA algorithm. The RSA key is\nhardcoded in the script. Those randomly generated strings are used to generate a password.\n\nAfter getting a response from the server, the malware writes the current date-time\ninto /%temp%/quanto00.tmp. If it doesn’t get any response, it will terminate itself. After that, it sends\nanother post request to the C&C server with the &status=start parameter as shown below and starts the\nencryption process.\n\n_Figure 6: Sending status update to C&C_\n\n## Encryption\n\n\n-----\n\nThe malware searches for all drives with at least 50kb of free space and starts encrypting the files with\nthe extensions below.\n\n_Figure 7: Extension list for encryption_\n\nFTCODE generates a password using GUID and a random character set generated earlier. It uses\nRijndael symmetric key encryption to encrypt the 40960 bytes of each of the above extension files. The\ninitialization vector is based on 11 randomly generated characters.\n\n_Figure 8: Encryption code_\n\nAfter encrypting files, FTCODE appends the extension to the “first 6 characters of newly generated\nGUID” and drops the ransom note \"READ_ME_NOW.htm\" in the directory that contains the encrypted\nfiles. The personal ID in the ransom note is the newly generated GUID.\n\n\n-----\n\n_Figure 9: Ransom note_\n\nThe earlier FTCODE version’s encryption key was generated based on a hardcoded string \"BXCODE\nhack your system\" and randomly generated key. The earlier version’s initialization vector was based on\nthe hardcoded string \"BXCODE INIT.\" The earlier version (1001.1) of FTCODE adds the .FTCODE\nextension after encryption. All versions use the same ransom note.\n\n## Stealer capability\n\nThe latest version of FTCODE added stealing functionality which was absent in earlier versions. It steals\ncredentials from the browsers below as well as email clients.\n\nInternet Explorer\nMozilla Firefox\nMozilla Thunderbird\nGoogle Chrome\nMicrosoft Outlook\n\n**Internet Explorer**\n\n\n-----\n\nThe script steals the stored credentials from the Internet Explorer web browser and gets the history\nfolder using $shell.NameSpace(34). It takes history details and decrypts the stored credentials from\ninformation in the registry HKCU:\\Software\\Microsoft\\Internet Explorer\\IntelliForms\\Storage2. It also\nchecks to see if the operating system is above Windows 7, then it fetches credentials from the vault as\nshown in the code below.\n\n_Figure 10: Code to steal credentials from vault_\n\n**Mozilla Firefox and Mozilla Thunderbird**\n\nThe script checks the below paths and fetches the credentials from the Mozilla Firefox browser and the\nMozilla Thunderbird email client.\n\nSystemDrive\\Program Files\\Mozilla Firefox\nSystemDrive\\Program Files\\Mozilla Thunderbird\nSystemDrive\\Program Files (x86)\\Mozilla Firefox\nSystemDrive\\Program Files (x86)\\Mozilla Thunderbird\n\n**Google Chrome**\n\nThe script steals credentials from the Google Chrome browser from the file\n_\\%UserProfile%\\AppData\\Local\\Google\\Chrome\\User Data\\*\\Login Data._\n\n\n-----\n\n_Figure 11: Code to steal credentials from the Google Chrome browser_\n\n**Microsoft Outlook**\n\nThe script steals saved credentials by accessing the following registry key.\n\nHKCU:\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Windows Messaging\nSubsystem\\Profiles\\*\\9375CFF0413111d3B88A00104B2A6676\\*\nHKCU:\\Software\\Microsoft\\Office\\1[56].0\\Outlook\\Profiles\\*\\9375CFF0413111d3B88A00104B2A6676\\*\n\nNext, it sends a post request with the guid=temp_1235266078&crederror=start chooseArch data\nto kind.its1ofakind[.]com. Further, it sends the stolen data to its C&C as shown in the below screenshot.\n\n_Figure 12: Sending stolen credentials to C&C_\n\nguid = hardcoded in script\n\n\n-----\n\ncred = stolen credentials\n\nThe stolen credentials are in the below format. Username and password are Base64 encoded.\n\nFormat: {\"URL\":[{\"Username\":\"Password\"},{\"Username\":\"Password\"}]\n\nFinally, after sending data, it sends a post request with guid=temp_1235266078&crederror=SUCCESS.\n\n## Conclusion\n\nThe FTCODE ransomware campaign is rapidly changing. Due to the scripting language it was written in,\nit offers multiple advantages to threat actors, enabling them to easily add or remove features or make\ntweaks much more easily than is possible with traditionally compiled malware. The Zscaler ThreatLabZ\nteam continues to monitor this threat and others to ensure that Zscaler customers are protected.\n\n**IOCs:**\n\n**Md5**\n\nd597ea78067725ae05a3432a9088caae\nc8a214f432fc9d74c913c02e7918fc0\nf96253923e833362ecac97729d528f8c\ncc0f64afa3101809b549cc5630bbd948\n328ce454698307f976baa909e5c646c7\n71a8d8c0543a99b8791e1cfaeeeb9211\nf0aa45bb9dd09cfac9d93427a8f5c72c\nd6da191bfc5966dd4262376603d4e8c1\ncc5946ce893ff37ace8de210923467a2\n7f5bb4529b95a872a916cc24b155c4cc\nedd5fbe846fa51f3b555185627d0d6c5\na2e88f9486cc838eae038a8ba32352f3\neab63ee2434417bc46466df07dc6b5b5\nfd46c05b99d00e11d34b93eae2c7ff2b\n98d2221445c2c8528cef06e4ef3c9e36\n\n**URLs:**\n\nluigicafagna[.]it\nhome[.]southerntransitions[.]net\nnomi[.]tugnutz[.]com\nhome[.]ktxhome[.]com\ndhol[.]rkeindustries[.]net\nway[.]securewebgateway[.]com\nstats[.]thomasmargiotti[.]com\npups[.]pupusas[.]net\nprint[.]impressnaples[.]com\nprint[.]impress-screen-printing[.]com\npower[.]hagertyquote[.]com\nmen[ ]unifiedthreatmanagementutm[ ]com\n\n\n-----\n\nkind[.]its1ofakind[.]com\nese[.]emarv[.]com\nehuxmtkxmdqy[.]top\nconnect[.]simplebutmatters[.]com\nconnect[.]heritageagencies[.]com\nceco[.]heritageins[.]co\ncdn[.]danielrmurray[.]com\nbxfmmtkxmdqy[.]top\nbiz[.]lotsofbiz[.]com\namq1mtkxmdqy[.]top\nahmwmtkxmdqy[.]top\nagvlmtkxmtq4[.]top\nagvlmtkxmdqy[.]top\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2020/2020-01-16 - FTCODE Ransomware - New Version Includes Stealing Capabilities.pdf"
    ],
    "report_names": [
        "2020-01-16 - FTCODE Ransomware - New Version Includes Stealing Capabilities.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673536085,
    "ts_updated_at": 1743041162,
    "ts_creation_date": 1653693691,
    "ts_modification_date": 1653693691,
    "files": {
        "pdf": "https://archive.orkl.eu/41f80c0b87c79f78ab58c4161ef221dcdcc5b674.pdf",
        "text": "https://archive.orkl.eu/41f80c0b87c79f78ab58c4161ef221dcdcc5b674.txt",
        "img": "https://archive.orkl.eu/41f80c0b87c79f78ab58c4161ef221dcdcc5b674.jpg"
    }
}