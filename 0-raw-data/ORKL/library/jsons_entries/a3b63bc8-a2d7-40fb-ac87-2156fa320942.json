{
    "id": "a3b63bc8-a2d7-40fb-ac87-2156fa320942",
    "created_at": "2023-01-12T15:10:47.092797Z",
    "updated_at": "2025-03-27T02:05:27.223627Z",
    "deleted_at": null,
    "sha1_hash": "cb2125428619290ec3c7e9ff07856b706dee3c55",
    "title": "2018-07-29 - Let's Learn- In-Depth Reversing of Qakbot -qbot- Banker Part 1",
    "authors": "",
    "file_creation_date": "2022-05-28T04:12:41Z",
    "file_modification_date": "2022-05-28T04:12:41Z",
    "file_size": 791483,
    "plain_text": "# Let's Learn: In-Depth Reversing of Qakbot \"qbot\" Banker Part 1\n\n**vkremez.com/2018/07/lets-learn-in-depth-reversing-of-qakbot.html**\n\n## Goal: Reverse engineer and analyze the Qakbot banker with the focus on its core functionality, new configuration, and decoded template.\n\n #Emotet and #Qakbot\n Invoice-75301.doc [Old Template]\n 5f894602e88263e34dcdbb2eb2da3078\n\n polysorce,com/newsletter/En_us/Invoice/Invoice-75301\n\n Payload download exe\"png\" files, signed by thawte, Inc\n\n Use Invoke-DOSfuscation pic.twitter.com/TGkaQzAUBR — \\_(ʘ_ʘ)_/ (@pollo290987) July 25, 2018\n\n Malware Sources:\n Invoice-75301.doc(5f894602e88263e34dcdbb2eb2da3078)\n Original Signed Packed Qakbot Banker\n (805f48f1295e28cc82c180844e3165d6)\n Unpacked Qakbot Core x86 (95ec8de64002fc5de7c04ceba04702da)\n Qbot Communicator Dll x86 (7dad18c4d149849c727fe39eee184fe8) Qbot Inject Dll x64 (03e78339b09aa5e9885c24b2e8af84f4) Qbot persistence script (c4eaff27f786204627c5b2b915e9c801)\n\n Background While investigating one notable infection chain distribution (thanks to @pollo290987), linked to both Emotet Loader and Qakbot Banker, I decided to take a deeper dive into the QakBot binary and its related component with the focus on core functionality. Qakbot is one of the oldest but yet-still-active bankers on the financial malware landscape operating since 2009. Qbot is a credential-stealing financial malware known to target customers of financial institutions for account takeover fraud (ATO). The malware has worm capabilities to self-replicate through shared networks, drives, and removable media, and is notable for active directory bruteforcing as detailed by IBM X-Force.\n Outline: The following functions of interest will be analyzed:\n```\nI. Packed Digitally Signed Qakbot Loader \nII. Unpacked Core qbot\nA. Decryption XOR Routine \nIII. \"Explorer\" Process Injection\nIV. Qakbot Configuration\nV. Anti-Analysis\nVI. Persistency Mechanism\nVII. Yara Signature\nA. Qakbot Unpacked Core\nB. Qakbot Communicator DLL\nC. Qakbot Inject DLL\nVIII. Indicators of Compromise\nIX. Addendum: Full Decoded First-Layer Template\n\n I. Packed Digitally Signed Qakbot Loader\n The malware initial packed loader is digitally signed with Thawte in order to bypass possible trust-based detection with the following company \"A&W Global Ltd.\"\nCN = A&W Global Ltd\nO = A&W Global Ltd\nL = St. Helens\nS = Merseyside\nC = GB\n\n```\n\n-----\n\n## The initial loader simply self-injects and unpacks the core malware in memory. The module can be retrieved vis scanning mapped memory region and dumping the unmapped executable, which would be the Qakbot core component. One of the notable details behind the banker execution is that the malware overwrites the launched executable with the Calculator utility in %WINDIR%\\System32 via the CreateProcessA. More specifically, the qbot uses the calc.exe utility to invoke a ping command that will repeat six times in a loop:\n```\n|hWnd = NULL\n|Operation = NULL\n|FileName = \"cmd.exe\"\n|Parameters = \" /c ping.exe -n 6 127.0.0.1 & type \"C:\\Windows\\System32\\calc.exe\" > \"PATH_TO_QBOT\"\n|DefDir = NULL\n\\IsShown = 0\n\n II.Unpacked Core Qakbot The unpacked core qbot, coded in Microsoft Visual C++, was compiled on January 29, 2018 06:25:49 with 9 imported DLL libraries with the five usual sections (.text -> .rsrc) with no anomalies. The coding style of Qakbot reveals heavy reliance of the developer on Ansi equivalent Microsoft API calls, which likely speaks to the older code base since most of the recent malware relies more on Unicode API equivalents. The bot primarily coordinates injection functions and control via IPC (inter-process communication) with named pipes. The Qakbot code reveals a lot of functionality including its Domain Generation Algorithm with domain TLD (\"com;net;org;info;biz;org\"), which version was well-documented by Johannes Bader. The qbot also communicates via FTP with available credentials. The qbot checks the machine speed by downloading a sample via \"https://cdn[.]speedof[.]me/sample4096k[.]bin?r=0.%u.\" Notably, the malware also \"relaxes\" Windows Defender and disables in registry via “SubmitSamplesConsent\" and alters \"SpynetReporting.\" A. QakBot Decryption XOR Routine Once executed, however, Qakbot leverages XOR decryption function with & 0x3f coupled with Windows API call MultiByteToWideChar to convert byte to unicode strings while iterating through the encoded blob.\n\n```\n\n-----\n\n## The pseudo-coded C++ template related to the main string deobfuscated is as follows:\n```\nif ( v14 )\n   {\n    WideCharStr = 0;\n    decrypt_iterate_func(&v13, 0, 62);\n    if ( v15 <= 12 )\n    {\n     v6 = 200;\n     do\n     {\n      MultiByteToWideChar(0, 0, (LPCSTR)*(v5 - 1), -1, &WideCharStr, 31);\n      --v6;\n     }\n     while ( v6 );\n     v4 = (const CHAR *)dword_41453C; // location of encoded data\n    }\n   }\n   v7 = &v4[v16];  // v16 = 0x2AA9u         \n   v8 = byte_413168[v16 & 0x3F];\n   v9 = v8 == v4[v16];\n   *v7 ^= v8;\n   if ( v9 )\n   {\n    ++v15;\n    *v5 = v7 + 1;\n    ++v5;\n   }\n   ++v16;\n\n   }III. \"Explorer\" Process Injection\n\n```\n\n-----\n\n## The execution sequence is as follows injecting code into \"explorer.exe\" in both x86 and x64 variants: start -> main_function -> main_injection -> x86_create_remote_thread/x64_process_inject -> process_injection_main -> inject_writeprocessMemory IV. Qakbot Configuration\n Qakbot configuration stored as .dat in %APPDATA% as numeric field values as follows:\n\n The config is retrieved as follows via the following call chain: start -> main_function -> GetDrive_type_func -> net_server_lookup_function -> anti-analysis -> trytoget_sid_user_as -> bot_config  > qbot_conf Some of the notable Qakbot configurations details were noted by BAE Systems in 2016. It appears that the field \"10\" carries the unique name such as \"mc15,\" which is a possible designation of the qbot botnet.\n\n\n-----\n\n## Qbot Configuration\n\n 10=mc15 (possible botnet name)\n\n 11=2 (number of hardcoded C2)\n\n 47=bot id as uppercase alphanumeric\n\n 1=date of qbot install in HH:MM:ss-dd/mm/yyyy\n\n 2=victim qbot install\n\n 45=C2 IP\n\n 46=C2 port\n\n 13=C2 domain\n\n 39=victim external IP\n\n 38=last victim call to C2 (time in Unix)\n\n 6=C2 IP:port\n\n 43=time of record ((time in Unix)\n\n 15=unknown\n\n 5=victim network shares\n\n 44=victim share credentials\n\n The bot id generation function is as follows leveraging \"ProductID\" value in Registry, coupled with the output of GetComputerNameA and GetVolumeInformationA as follows:\n```\n v2 = lpString;\n *(_DWORD *)v14 = 0;\n nSize = 0;\n decrypt_iterate_func(lpString, 0, 256);\n v12 = 256;\n v11 = RegOpenKeyExA(-2147483646, SOFTWARE_path, 0, 131097, &lpString);\n if ( !v11 )\n  v11 = RegQueryValueExA(lpString, ProductId, 0, 0, v2, &v12);\n RegCloseKey(lpString);\n if ( v11 )\n  *(_WORD *)v2 = 48;\n nSize = 256 - lstrlenA(v2);\n v3 = lstrlenA(v2);\n GetComputerNameA((LPSTR)&v2[v3], &nSize);\n if ( !GetVolumeInformationA(&unk_411C48, &v9, 256, v14, 0, 0, &v10, 256) )\n  *(_DWORD *)v14 = 0;\n v4 = v14[0];\n v5 = 256 - lstrlenA(v2);\n v6 = lstrlenA(v2);\n wsprintf_filepath(&v2[v6], v5, (int)\"%u\", v4);\n lstrcatA((LPSTR)v2, lpString2);\n nSize = lstrlenA(v2);\n CharUpperBuffA((LPSTR)v2, nSize);\n\n Notably, the malware does not appear to store in the config file but rather uses the following config fields for FTP communication:\n\n Qbot Additional Config\n\n 3=time of config (time in Unix)\n\n```\n\n-----\n\n## 22=ftp server1 with credential for C2 communications\n\n 23=ftp server2 with credential for C2 communications\n\n 24=ftp server3 with credential for C2 communications\n\n 25=ftp server4 with credential for C2 communications\n\n 26=ftp server5 with credential for C2 communications\n\n The croncache is as follows:\n 12960;5;1532655973|15;8;1532722066|3;1;1532722258|4294967295;23;1532655912|300;13;1532722066|2736;3;1532701702|5;21;1532722066| V. Qbot Anti-Analysis The malware check for various anti-virus processes while running the binary.\n\n avgcsrvx.exe;avgsvcx.exe;avgcsrva.exe ccSvcHst.exe MsMpEng.exe mcshield.ex avp.exe egui.exe;ekrn.exe bdagent.exe;vsserv.exe;vsservppl.exe AvastSvc.exe coreServiceShell.exe;PccNTMon.exe;NTRTScan.exe. SAVAdminService.exe;SavService.exe fhoster32.exe WRSA.exe vkise.exe;isesrv.exe;cmdagent.exe ByteFence.exe MBAMService.exe fmon.exe\n\n Additionally, the malware checks for a plethora of anti-analysis and anti-virtual machines. One of the techniques is used to compare CPUID. This instruction is executed with EAX=1 as input, the return value describes the processors features. The 31st bit of ECX on a physical machine will be equal to 0. On a guest VM it will equal to 1.\n```\nanti_VM_cpuid((int)&String1);\n _EAX = 1;\n __asm { cpuid }\n v16 = _ECX;\n return _ECX == 1 && !lstrcmpiA(&String1, GenuineIntel);\n}\n\n DLL (GetModuleHandleA):\n fshook32.dll (F-Secure) SbieDll.dll (Sandboxie) aswhookx.dll (Avasr) sf2.dll (Avst) dbghelp.dll avcuf32.dll (BitDefender)\n\n For example,\n\n```\n\n-----\n\n```\n{\n return dword_415934 & 0x82 && (GetModuleHandleA(aswhooka_dll) || GetModuleHandleA(aswhooks_dll));\n}\n\n## Anti-Virus:\n Bitdefender Microsoft Security Essentials Norton NOD32 Symantec mcafee kaspersky Avast Trend Micro\n\n Filename check:\n mlwr_smpl antivirus srootkit (AVG) sample.exe sample\n\n Anti-Virtual Machine:\n QEMU VMware vmdebug vmx_svga VirtIO RedHat vmacthlp.exe vmtoolsd.exe SVGA VMaudio vmrawdsk SCSI VBoxGuest vm3dmp vmxnet\n\n Other:\n windump.exe artifact.exe\n\n Mutex Check:\n _AVIRA_71855\n\n VI. Persistency Mechanism Qakbot sets run persistence via task scheduler as well as curious JavaScript execution via \"cscript.exe //E:javascript\" with the qbot loader file ending .wpl\n\n VII. Yara Signatures\n\n```\n\n-----\n\n```\n meta:\n description = \"Detects unpacked Qakbot core\"\n author = \"@VK_Intel\"\n date = \"2018-07-29\"\n hash = \"95ec8de64002fc5de7c04ceba04702da\"\n strings:\n $s0 = \"powershell.exe\" fullword ascii\n $s1 = \"%s\\\\%d.exe\" fullword ascii\n $s2 = \"%s\\\\system32\\\\\" fullword ascii\n $s3 = \"000223\" fullword ascii \n $s5 = \"000001\" fullword ascii \n $s6 = \"000111\" fullword ascii \n $s7 = \"000005\" fullword ascii\n $s8 = \"Akernel32\" fullword ascii\n $s9 = \"ipconfig netstat\" fullword ascii\n $s10 = \"Win32_Process\" fullword ascii\n $s11 = \"NtQuerySystemInformation\" fullword ascii\n condition:\n uint16(0) == 0x5a4d and filesize < 500KB and all of them\n}\nrule crimeware_win32_qbot_communicatorDll {\n meta:\n description = \"Detects Qakbot Communicator DLL\"\n author = \"@VK_Intel\"\n date = \"2018-07-29\"\n hash = \"7dad18c4d149849c727fe39eee184fe8\"\n strings:\n $s0 = \"powershell.exe\" fullword ascii\n $s1 = \"User-Agent: Microsoft-Windows/%u.%u UPnP/1.0\" fullword ascii\n $s2 = \"\\\\\\\\.\\\\pipe\\\\%ssp\" fullword ascii\n $s3 = \"http://www.ip-adress.com\" fullword ascii\n $s4 = \"%s\\\\%s.exe\" fullword wide\n $s5 = \"POST %s HTTP/%s\" fullword ascii\n $s6 = \"urn:schemas-upnp-org:service:WANCommonInterfaceConfig:1\" fullword ascii\n $s7 = \"HOST: %s:1900\" fullword ascii\n $s8 = \"GetPortMappingNumberOfEntries\" fullword ascii\n $s9 = \"GetSpecificPortMappingEntry\" fullword ascii\n $s10 = \"%s\\\\tmp_%u.exe\" fullword ascii\n $s11 = \"GetConnectionTypeInfo\" fullword ascii\n $s12 = \"\\\\AppData\\\\LocalLow\\\\\" fullword ascii\n $s13 = \"%s\\\\~%s.tmp\" fullword ascii\n $s14 = \"%s\\\\system32\\\\\" fullword ascii\n condition:\n uint16(0) == 0x5a4d and filesize < 200KB and 10 of them\n}\nrule crimeware_win64_qbot_injectedDll {\n meta:\n description = \"Detects Qakbot Inject DLL\"\n author = \"@VK_Intel\"\n date = \"2018-07-29\"\n hash = \"03e78339b09aa5e9885c24b2e8af84f4\"\n strings:\n $s0 = \"chrome.dll\" fullword ascii\n $s1 = \"\\\\\\\\.\\\\pipe\\\\%ssp\" fullword ascii\n $s2 = \"content-security-policy-report-only\" fullword ascii\n $s3 = \"\\\\AppData\\\\LocalLow\\\\\" fullword ascii\n $s4 = \"content-security-policy\" fullword ascii\n $s5 = \"cookie=[\" fullword ascii\n $s6 = \"referer=[\" fullword ascii\n $s7 = \"X-Frame-Options\" fullword ascii\n $s8 = \"user.js\" fullword wide\n $op0 = { e8 99 b0 00 00 44 8b 5d c4 44 01 5b 18 41 80 3e }\n $op1 = { e8 f1 ec ff ff 48 89 84 24 98 } \n $op2 = { 48 8b 53 28 48 8b c8 e8 ca 6a 00 00 eb 03 41 8b }\n condition:\n uint16(0) == 0x5a4d and filesize < 421KB and all of ($s*) and 1 of ($op*)\n}\n\n## VIII. Indicators of Compromise (IOCs) A. The observed list of C2 servers\n\n```\n\n-----\n\n```\n70.169.12[.]141;0;443\n150.200.247[.]87;0;443\n71.77.22[.]206;0;443\n76.73.202[.]82;0;443\n74.88.210[.]56;0;995\n97.97.160[.]42;0;443\n146.135.9[.]64;0;443\n71.190.202[.]120;0;443\n47.223.85[.]33;0;443\n98.26.2[.]182;0;443\n50.111.32[.]211;0;443\n68.207.33[.]232;0;2222\n68.173.55[.]51;0;443\n76.186.82[.]51;0;443\n67.197.104[.]90;0;443\n73.40.24[.]158;0;443\n50.42.189[.]206;0;993\n65.116.179[.]83;0;443\n50.32.243[.]36;0;443\n185.219.83[.]73;0;443\n72.133.105[.]155;0;443\n216.201.159[.]118;0;443\n68.207.43[.]173;0;443\n216.218.74[.]196;0;443\n96.248.15[.]254;0;995\n75.189.235[.]216;0;443\n98.103.2[.]226;0;443\n24.100.46[.]201;0;2222\n24.11.50[.]136;0;443\n75.109.193[.]173;0;2087\n73.106.122[.]121;0;443\n173.160.3[.]209;0;443\n70.118.18[.]242;0;443\n24.163.66[.]146;0;443\n173.248.24[.]230;0;443\n68.129.231[.]84;0;443\n174.48.72[.]160;0;443\n216.93.143[.]182;0;995\n184.180.157[.]203;0;2222\n68.49.120[.]179;0;443\n75.109.193[.]173;0;1194\n75.109.193[.]173;0;8443\n98.16.70[.]197;0;2222\n47.134.236[.]166;0;443\n105.227.20[.]203;0;443\n97.70.129[.]250;0;443\n24.228.185[.]224;0;2222\n72.174.25[.]139;0;443\n24.209.137[.]134;0;443\n98.225.141[.]232;0;443\n67.197.97[.]144;0;443\n173.81.42[.]136;0;21\n24.155.191[.]156;0;995\n97.84.210[.]38;0;2222\n93.108.180[.]227;0;443\n190.185.219[.]110;0;443\n63.79.135[.]0;0;443\n96.73.55[.]193;0;993\n207.178.109[.]161;0;443\n99.197.182[.]183;0;443\n67.83.122[.]112;0;2222\n50.198.141[.]161;0;2078\n47.40.29[.]239;0;443\n12.2.201[.]35;0;443\n76.176.7[.]41;0;443\n75.127.141[.]50;0;995\n71.210.153[.]133;0;443\n189.175.147[.]195;0;443\n73.231.147[.]128;0;443\n73.130.229[.]200;0;443\n67.11.27[.]100;0;443\n12.196.116[.]242;0;443\n216.21.168[.]27;0;32101\n24.6.31[.]163;0;443\n216.21.168[.]27;0;995\n96.40.85[.]72;0;443\n69.129.12[.]186;0;21\n71.172.250[.]114;0;443\n73.152.213[.]187;0;80\n68.226.136[.]96;0;443\n71.222.141[.]81;0;61200\n76 182 33[ ]43;0;2222\n\n```\n\n-----\n\n```\n173.160.3[.]209;0;995\n97.70.85[.]248;0;443\n24.180.246[.]147;0;443\n173.70.44[.]171;0;443\n216.21.168[.]27;0;50000\n24.180.246[.]147;0;443\n96.32.171[.]132;0;443\n47.48.236[.]98;0;2222\n70.182.79[.]66;0;443\n173.80.75[.]177;0;443\n24.141.179[.]121;0;443\n204.85.12[.]25;0;443\n24.175.103[.]122;0;995\n24.252.80[.]93;0;443\n68.206.135[.]146;0;443\n184.174.166[.]107;0;443\n71.33.192[.]23;0;995\n24.190.226[.]234;0;443\n71.10.155[.]97;0;443\n24.180.246[.]147;0;443\n181.93.205[.]181;0;443\n207.243.48[.]26;0;443\n68.113.142[.]24;0;465\n72.193.162[.]108;0;443\n68.59.209[.]183;0;995\n98.243.166[.]148;0;443\n72.179.39[.]89;0;443\n67.76.37[.]105;0;443\n174.109.117[.]152;0;443\n73.52.101[.]153;0;80\n70.21.182[.]149;0;2222\n24.180.246[.]147;0;443\n65.191.74[.]248;0;443\n65.40.207[.]151;0;995\n73.183.145[.]218;0;2222\n209.213.24[.]194;0;443\n68.207.33[.]242;0;443\n172.87.188[.]2;0;443\n65.132.30[.]18;0;443\n104.153.240[.]6;0;2222\n24.93.104[.]154;0;443\n75.106.233[.]194;0;443\n65.191.128[.]99;0;443\n65.169.66[.]123;0;2222\n71.172.250[.]114;0;443\n67.55.174[.]194;0;443\n107.15.153[.]110;0;8443\n205.169.108[.]194;0;443\n47.221.46[.]163;0;443\n71.48.218[.]91;0;995\n73.74.72[.]141;0;443\n71.85.72[.]9;0;443\n172.164.17[.]102;0;443\n173.191.238[.]124;0;995\n47.186.93[.]228;0;443\n184.191.61[.]13;0;32100\n209.180.154[.]97;0;995\n68.133.47[.]150;0;443\n75.189.239[.]153;0;443\n204.85.12[.]26;0;443\n76.101.165[.]66;0;443\n97.84.166[.]64;0;443\n72.133.75[.]134;0;443\n68.207.45[.]236;0;443\n104.153.240[.]6;0;2222\n206.67.215[.]7;0;443\n206.67.215[.]7;0;443\n\n## B. Qbot Configuration\n\n```\n\n-----\n\n```\n11=2\n47=REDACTED\n1=REDACTED\n2=REDACTED\n45=97.84.166[.]64\n46=443\n13=content[.]markdutchinc[.]com\n39=REDACTED\n38=REDACTED\n6=85.25.211[.]31:65400\n43=REDACTED\n15=-722023893\n5=REDACTED\n44=REDACTED\n3=REDACTED\n22=37.60.244[.]211:backup_manager@garciasdrywall[.]com:REDACTED:\n23=198.38.77[.]162:backup_manager@worldexpresscargo[.]com:REDACTED:\n24=61.221.12[.]26:logger@ostergift[.]com:REDACTED:\n25=67.222.137[.]18:logger@grupocrepusculo[.]net:REDACTED:\n26=107.6.152[.]61:logger@trussedup[.]com:REDACTED:\n\n## IX. Appendix: Full Decoded First-Layer Template\n\n```\n\n-----\n\n```\nEND\nFindWindowA\nGetFileAttributesW\nntdll.dll\nVirtualProtect\nimage/jpeg\nSoftware\\Microsoft\\Office\\Outlook\\OMI\nAccount\nManager\\Accounts\nInternetQueryDataAvailable\nDnsQuery_W\nshell32.dll\nqbot_conf_path='%s'\nusername='%s'\nws2_32.dll\nUSERPROFILE\nCreateFileA\n.dll\n.cfg\n.png\nvSockets\nModule32First\nCloseServiceHandle\nHttpSendRequestExW\nHttpSendRequestExA\ndumprep.exe\nCertFreeCertificateChainEngine\ndnsrslvr.dll\nBitdefender\nLookupAccountSidA\nStringIndex\n%s\n/P\n%s\nMicrosoft\nSecurity\nEssentials\nRegOpenKeyExA\nHttpOpenRequestW\nHttpEndRequestW\n:String\nWNetOpenEnumW\nfshook32.dll\nNTUSER.DAT\nGenuineIntel\nCertAddCertificateContextToStore\nmlwr_smpl\nRegCloseKey\nCertEnumSystemStore\nProcess32Next\nPostMessageA\nFtpOpenFileA\nPassport.Net\\*\n/s\nLdrLoadDll\nSendMessageA\nhttp\nCertOpenStore\nIf-Modified-Since\nkernel32.dll\nInitializing\ndatabase...\n/c\nQEMU\nNetGetDCName\n.jpeg\nVMware\nVista\nf1\nSbieDll.dll\nNorton\nPR_Read\ncom;net;org;info;biz;org\nNOD32\nGetModuleFileNameA\nSoftware\\Microsoft\\Internet\nAccount\nManager\\Accounts\nRegQueryValueExA\n%02u.%02u.%02u-%02u/%02u/%04u\nm1\n\\* txt\n\n```\n\n-----\n\n```\nRed\nHat\nVirtIO\nwindbg.exe;ChromeUpdate.exe;msdev.exe;dbgview.exe;ollydbg.exe;ctfmon.exe;Proxifier.exe;nav.exe;Microsoft.Notes.exe;ShellExperienceHo\nvmnat.exe\nUnregisterClassA\nTEMP\ncert_name=[%s|%s]\nSMTP\nPort;POP3\nPort;IMAP\nPort;SMTP\nEmail\nAddress;SMTP\nServer;POP3\nServer;POP3\nUser\nName;SMTP\nUser\nName;NNTP\nEmail\nAddress;NNTP\nUser\nName;NNTP\nServer;IMAP\nServer;IMAP\nUser\nName;Email;HTTP\nUser;HTTP\nServer\nURL;POP3\nUser;IMAP\nUser;HTTPMail\nUser\nName;HTTPMail\nServer;SMTP\nUser;001e6607;001e6608\nFreeSid\nCreateRemoteThread\nh1\nantivirus\n<%02X>\nInternetWriteFile\nVMware\nserver\nmemory\nCreateThread\nCreateServiceA\nSetEndOfFile\nCommon\nFiles\nwtsapi32.dll\n1\nSymantec\nShared\nRegEnumKeyExA\nTAB\nShowWindow\nabe2869f-9b47-4cd9-a358-c22904dba7f7\nWNetAddConnection2W\nUSER\nFindNextFileW\np=[\nartic1e\nRegEnumValueW\nopen\nsrootkit\nftp\nCreateServiceW\nFtpDeleteFileA\nWTSFreeMemory\n11\nCertEnumCertificatesInStore\nHttpOpenRequestA\nInternetReadFileExW\nUpdateWindow\nVMware\nReplay\nCertGetCertificateChain\nk1\nvmdebug\n\n```\n\n-----\n\n```\ndnsname=[%s]\nhostname=[%s]\nuser=[%s]\ndomain=[%s]\nis_admin=[%s]\nos=[%s]\nqbot_version=[%s]\ninstall_time=[%s]\nexe=[%s]\nprod_id=[%s]\nPeekMessageW\nZwSetLdtEntries\naabcdeefghiijklmnoopqrstuuvwxyyz\nVMware\nPointing\nFindClose\nSoftware\\Microsoft\\Windows\nNT\\CurrentVersion\\Windows\nMessaging\nSubsystem\\Profiles\nfacebook.com/login.php\nvmx_svga\nmcafee\nDestroyWindow\nabc\nMicrosoft\nvmacthlp.exe\nGetLastError\nReadProcessMemory\nZwQueryInformationThread\nk2\nMozilla/5.0\n(Windows\nNT\n6.1;\nrv:54.0)\nGecko/20100101\nFirefox/54.0\n2\nInternetGetLastResponseInfoA\nAPPDATA\nRegEnumValueA\ndnsapi.dll\nVirtualFreeEx\nWindowsLive:name=*\nExpandEnvironmentStringsA\nCreateDirectoryA\nWTSQueryUserToken\ncookie=[%s]\nWSAConnect\ni1\nkb\nWTSEnumerateSessionsA\nPR_Close\nDisplayName\nRemote\nProcedure\nCall\n(RPC)\nService\nkaspersky\nWSASetLastError\nsample.exe\nvmtoolsd.exe\nFindNextFileA\nZwQuerySystemInformation\ncrypt32.dll\nCertAddCRLContextToStore\nInternetOpenUrlA\nSOFTWARE\\Microsoft\\Windows\nNT\\CurrentVersion\nHOME\nnetapi32.dll\nCertGetEnhancedKeyUsage\nWriteFile\nhttps://cdn.speedof.me/sample4096k.bin?r=0.%u\nCredEnumerateW\nCreateWindowExA\n\\Cookies\n*.*\nadvapi32.dll\nWaitForSingleObject\n\n```\n\n-----\n\n```\n%u.%u.%u.%u\n000\nFindFirstFileA\nwpl\nurl=[%s]\nuser=[%s]\npass=[%s]\nInternetOpenA\nPOP3\nPassword;IMAP\nPassword;NNTP\nPassword;HTTPMail\nPassword;SMTP\nPassword;POP3\nPassword2;IMAP\nPassword2;NNTP\nPassword2;HTTPMail\nPassword2;SMTP\nPassword2\n.swf\nAvast\nMiniDumpWriteDump\nCertCloseStore\nDeleteFileA\n\\Application\nData\\Macromedia\\Flash\nPlayer\\#SharedObjects\nGetExitCodeProcess\nRegSetValueExA\ncmd.exe\nartifact.exe\nrsaenh.dll\n.css\nnspr4.dll\nNetShareEnum\nRegQueryInfoKeyA\nRegCreateKeyExA\nsbtisht\nPFXExportCertStore\nWSAStartup\nIf-None-Match\nVirtualProtectEx\nCertSetCertificateContextProperty\nWSACleanup\n_qbot\n]\nb=[\n220d5cc1\nvmscsi\nCreateFileW\nconnect\nLOCALAPPDATA\nat.exe\n%u:%u\n\"%s\"\n/I\nAllocateAndInitializeSid\nurl=[%s]\nVMware\nVMaudio\ni2\nimage/pjpeg\n%H.%M.%S-%d/%m/%Y\ndwwin.exe\nCryptAcquireCertificatePrivateKey\nw1\nc1\naswhookx.dll\nhost=[%s:%u]\nuser=[%s]\npass=[%s]\nAVG\nsiteadvisor.com;avgthreatlabs.com;safeweb.norton.com\nvery\nbig\npostdata\n%u\nbytes\nCredEnumerateA\nHttpQueryInfoW\nVMware\nSVGA\n\n```\n\n-----\n\n```\nInternetReadFileExA\nInternetConnectA\nSoftware\\Microsoft\\Internet\nExplorer\\IntelliForms\\Storage2\nCertCreateCertificateChainEngine\nSetCurrentDirectoryA\nTE\nTrend\nMicro\nvmrawdsk\n.gif\nCredFree\nCreateToolhelp32Snapshot\nProcess32First\nexplorer.exe\nChromeUpdate.exe\nDeleteService\nCookie:\ndwErr=%u\nszOldRunMutex='%s'\nusername='%s'\nCertGetCRLContextProperty\nAdjustTokenPrivileges\naswhooka.dll\nGetCurrentProcessId\nSetFilePointer\ndwErr=%u\nqbot_run_mutex='%s'\nusername='%s'\nInternetOpenW\nCharToOemBuffA\nPR_SetError\n9\nwininet.dll\nsecurity\nNetUserEnum\nZwResumeThread\nt=%s\ntime=[%02d:%02d:%02d-%02d/%02d/%d]\nHttpAddRequestHeadersA\nmpr.dll\nStartServiceA\nVBoxVideo\nrunas\nuno\nInternetQueryOptionA\nOpenProcess\nNorton\nInternet\nSecurity\napplication/x-shockwave-flash\nProductId\nWNetCloseEnum\nOpenThread\n%%%02X\nhttps://\niphlpapi.dll\naaebcdeeifghiiojklmnooupqrstuuyvwxyyaz\nDELETE\n]\ncookie_data=[\nHttpQueryInfoA\ndata=[%s]\nDeleteUrlCacheEntryW\nCertGetNameStringW\nInterlockedCompareExchange\nInternetSetOptionA\ne161255a\nnss3.dll\nwindump.exe\nDnscache\nCreateProcessW\nCryptUnprotectData\nGetClipboardData\nsvchost.exe\nWSAGetLastError\nOpenSCManagerW\nabcdefghijklmnopqrstuvwxyz\nModule32Next\n.exe\nCertFreeCertificateChain\ns2\n\n```\n\n-----\n\n```\nDeleteServiceW\nVirtual\nHD\n.ani\n.ico\nResumeThread\nPostQuitMessage\nInternetSetStatusCallback\ncnn.com;microsoft.com;baidu.com;facebook.com;yahoo.com;wikipedia.org;qq.com;linkedin.com;mail.ru\nGetForegroundWindow\n220d5cd0\nVirtualAllocEx\nInternetReadFile\nVMware\nSCSI\nLocalFree\nGetCurrentThreadId\nQuery_Main\nurl=[%s]\ndata=[%s]\n3\n\\sf2.dll\nGetProcAddress\nPASS\nGetExitCodeThread\nDispatchMessageA\n0123456789\nCryptEnumOIDInfo\niedw.exe\nCertFreeCRLContext\nRIGHT\nuser_pref(\"network.http.spdy.enabled.http2\",\nfalse);\nCloseHandle\ncomet.yahoo.com;.hiro.tv;safebrowsing.google.com;geo.query.yahoo.com;googleusercontent.com;salesforce.com;officeapps.live.com;storag\noptimizer.com;.adworldmedia.com;seekmo.com;r777r.info;sipuku.com;eorezo.com;newasp.com.cn;wpzkq.com;radialpoint.com;owlforce.com;.mi\nservices.com;zynga.com;.5min.com;netflix.com;tubemogul.com;youtube.com;brightcove.com;mochibot.com;fwmrm.net;mendeley.com\nPR_OpenTCPSocket\nPR_GetNameForIdentity\navcuf32.dll\nmutex\n_AVIRA_71855\nCreateProcessA\nreferer=[%s]\n&dump=\nPROGRAMFILES\nReadFile\nGetMessageW\ndbghelp.dll\nh3\nInternetGetCookieA\nHttpSendRequestA\nFtpGetFileA\n.jpg\nStartServiceW\ncert_data=[\n%s_%s_%u.zip\nSetLastError\n.js?\nGetCurrentDirectoryA\ncookie_name=[\nansfltr\nDnsQuery_A\nCertFreeCertificateContext\nProfileImagePath\nu1\nLEFT\nNetApiBufferFree\n*/*\nPeekMessageA\nmetsvc-server.exe\ntime=[%d:%d:%d-%d/%d/%d]\nex_code=0x%08x\nex_addr=0x%p\nex_module=[%s]\nex_module_base=0x%p\nnick=[%s]\nth_args=[%08x]\nth_flags=[0x%08x]\nqbot_version=[%s]\nWriteProcessMemory\nCertAddCTLContextToStore\n\n```\n\n-----\n\n```\n5e7e8100\nsample\nSoftware\\Microsoft\\Windows\\CurrentVersion\\Uninstall\nInternetGetCookieExA\nSoftware\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Internet\nSettings\\\\Zones\\\\\n%s%s/dupinst.php?n=%s&bg=%s&r=%u\nSetEntriesInAclA\nESCAPE\nCPExportKey\nShellExecuteA\nhttps\n]\nt=[\nsend\nFindFirstFileW\nTranslateMessage\nAVAST\nSoftware\ncryptui.dll\nMessageBoxA\nrsabase.dll\nOpenSCManagerA\nWSASend\nVMware\nAccelerated\n8\n%%%02x\nWNetEnumResourceW\nPR_Write\nGetMessageA\nInternetQueryOptionW\nAvast\nGlobal\nVMAUDIO\nObtainUserAgentString\nurlmon.dll\nDefWindowProcA\nStackWalk64\nDnsQueryExW\nPStoreCreateInstance\nh2\nInternetCloseHandle\ncmd\n/c\nping\n-n\n10\nlocalhost\n&&\nrmdir\n/S\n/Q\n\"%s\"\nRegisterClassExA\nDnsQueryExA\ni3\nRegDeleteValueA\nPR_GetError\nGetUrlCacheEntryInfoA\n10\nMoveFileA\nNetWkstaGetInfo\nHttpEndRequestA\ncrashdata=\nZwReadFile\nHttpSendRequestW\nCWSandbox\ntreasurygateway;ecash.arvest.com;.ntrs.com;tdcommercialbanking.com;olbebanking.com;webinfoplus.mandtbank.com;accessmoneymanager.com;commerceconnections.commercebank.com;schwabinstitutional.com;intellix.\naccess.com;nj00-wcm;commercial.bnc.ca;/clkccm/;paylinks.cunet.org;efacts.org;accessonline.abnamro.com;providentnjolb.com;firstmeritib.com;corporatebanking;firstmeritib.com/defaultcorp.aspx;emoneyger.com;jsp/mainWeb.jsp;svbconnect.com;premierview.membersunited.org;each.bremer.com;iris.sovereignbank.com;/wires/;paylinks.cu\neb.ibanking-services.com;cashproonline.bankofamerica.com;/cashplus/;ebanking-services.com;/cashman/;web-cashplus.com;treasmgt.frostbank.com;business-eb.ibankingservices.com;treasury.pncbank.com;access.jpmorgan.com;tssportal.jpmorgan.com;ktt.key.com;onlineserv/CM;premierview.membersunited.org\nachweb.bankofamerica.com;businessaccess.citibank.citigroup.com;businessonline.huntington.com;/cmserver/;goldleafach.com;iachwellspro\npstorec.dll\nVBoxGuest\nwpq\nivm inject dll\n\n```\n\n-----\n\n```\nBACKSP\nurl=[%s]\nlb=[%s]\ndata=[%s]\nPR_Poll\nvm3dmp\nvmxnet\nnorton\nGetUrlCacheEntryInfoW\n.lnk\nuser32.dll\n.js\nLdrGetProcedureAddress\nSetNamedSecurityInfoA\nGetFileAttributesA\nLoadLibraryA\nBasic\nCertDuplicateCRLContext\nSoftware\\Microsoft\\Windows\nMessaging\nSubsystem\nimage/gif\nGetVolumeInformationA\nSOFTWARE\\Microsoft\\Windows\nNT\\CurrentVersion\\ProfileList\nb9819c52\n\n```\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2018/2018-07-29 - Let's Learn- In-Depth Reversing of Qakbot -qbot- Banker Part 1.pdf"
    ],
    "report_names": [
        "2018-07-29 - Let's Learn- In-Depth Reversing of Qakbot -qbot- Banker Part 1.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673536247,
    "ts_updated_at": 1743041127,
    "ts_creation_date": 1653711161,
    "ts_modification_date": 1653711161,
    "files": {
        "pdf": "https://archive.orkl.eu/cb2125428619290ec3c7e9ff07856b706dee3c55.pdf",
        "text": "https://archive.orkl.eu/cb2125428619290ec3c7e9ff07856b706dee3c55.txt",
        "img": "https://archive.orkl.eu/cb2125428619290ec3c7e9ff07856b706dee3c55.jpg"
    }
}