{
    "id": "2d22a88f-61ef-49ff-9132-dc5358e6ab83",
    "created_at": "2023-01-12T15:05:26.193369Z",
    "updated_at": "2025-03-27T02:06:15.699873Z",
    "deleted_at": null,
    "sha1_hash": "bf444a26c2ffbe13a2e7d6e1c20e4b29df410c69",
    "title": "2021-01-27 - Taking Down Emotet How Team Cymru Leveraged Visibility and Relationships to Coordinate Community Efforts",
    "authors": "",
    "file_creation_date": "2022-05-28T19:27:05Z",
    "file_modification_date": "2022-05-28T19:27:05Z",
    "file_size": 124643,
    "plain_text": "# Taking Down Emotet\n\n**team-cymru.com/blog/2021/01/27/taking-down-emotet/**\n\nJames Shank View all posts by James Shank January 27, 2021\n\nOn Tuesday, January 26, 2021, the number of available controllers talking like Emotet Tier 1\ncontrollers dropped to zero.\n\nTeam Cymru’s monitoring confirmed that they dropped from over 100 to zero in a really short\ntimeframe. That’s interesting.\n\nHelping to make that happen? That’s fun.\n\nLet’s talk about the fun!\n\nA Call and a Request\n\nA friend of mine phoned me a couple weeks prior. “Hey man, how are you? I’ve got\nsomething Team Cymru might be able to make happen.” “Doing well! What’s on your\nmind?”…\n\nIt’s no secret that law enforcement agencies have been tracking Emotet. Any threat that\ngenerates over a certain threshold of losses per year draws attention. Emotet has “cost\n\n[[state, local, tribal, and territorial] governments up to $1 million per incident to](https://us-cert.cisa.gov/ncas/alerts/TA18-201A)\n\n\n-----\n\nremediate . When the U.S. Department of Homeland Security puts that price tag on a threat,\nlaw enforcement is already taking note.\n\n“Here’s what we want to do…”\n\nCoordinated Operations\n\nLaw enforcement authorities in the Netherlands, Germany, the United States, the United\nKingdom, France, Lithuania, Canada and Ukraine were getting close to executing a plan to\ntake down Emotet. They were working their processes, coordinating a time to award some\nhandcuffs. The teams also coordinated taking over parts of the Emotet infrastructure. Where\npossible, these systems would change hands and would no longer harm victims.\n\nWhile these and the other collaborating law enforcement agencies have a long reach, they\ncan’t reach everything. In some countries, Emotet’s activities aren’t illegal — unless that\ncountry’s citizens are victims. International law enforcement collaboration varies between\ncountries. Add to this that some hosting providers may have ties to criminal enterprise.\nServing papers on upcoming activity may become a signal that allows the actors to get away.\n\nThis creates a problem. Taking over only part of a botnet is not ideal, and doing so may allow\nthe actors to reclaim control. How can systems that legal process can’t reach, shouldn’t\nreach, or won’t reach on time be in scope?\n\nThe Untouchables\n\n“Can we get networks to block the servers that aren’t taken over?”\n\nMake no mistake, large networks exist for one primary reason: move packets. This is their\njob, their raison d’être. When you ask networks to block packets, you’re asking them to put\ntheir neck on the line. The concerns are quite reasonable: reliability, liability, and collateral\ndamage are at the top.\n\n“We may have a shot. Let’s try. We may get 65% to help out.”\n\nGetting these untouchable systems blocked is important to the goal. Emotet actors break into\nsystems or buy access to systems already compromised. If an infected client connects to an\nactor controlled system, they will incur further harm. If they reach a system controlled by law\nenforcement after the take over, they won’t be harmed.\n\nEmotet Configs and Controller Selection\n\nEmotet has three different botnets, Epoch 1, Epoch 2, and Epoch 3. These three botnets\nhave different victim-facing controllers. When a client gets the initial binary, that binary\ncontains a list of up to 100 controllers from one of these three groups.\n\nThe malware will attempt to connect to one of the controllers in its config data. If this\nsucceeds, great, but if it fails, it will try another controller on the list. It will keep doing this\nuntil it either connects to a controller or exhausts the list.\n\n\n-----\n\nWe want the clients to connect to the seized servers.\n\nGiven the selection process, and that the reach of law enforcement is only so far, we need to\nblock some servers. Blocking servers will cause the malware to try other servers in the\nconfig. The first server to work, we hope, will be one of the seized servers.\n\nTeam Cymru has our own sources for Emotet controller data. We combined our sources with\n[the excellent work of Cryptolaemus, a community effort to fight Emotet. We then validated](https://twitter.com/Cryptolaemus1)\nthese data points with Team Cymru’s processing. After aggregating these results with one\nother data source, we made the kill list available to network operators.\n\nThe Network Operator Responses\n\nOf the network operators invited to the organizing calls, only one declined. The reason was\nquite reasonable: without legal paperwork, their network will not act. This is a respectable\nposition; when compelled to act, networks are not liable.\n\nFor the networks that joined the calls, they all helped in this effort except one. That network\nhad a change freeze due to lockdowns related to COVID-19. Because lockdowns may\nprevent their staff from gaining physical access to their equipment, they could not risk\nchanges that were unnecessary. This Emotet take down effort, while good and the desire to\nhelp was there, was not necessary.\n\nThis participation rate was well above my prediction of 65%. Those that know me may say\nI’m a shade pessimistic. The results speak for themselves.\n\nThe Results\n\n“We’re not seeing any active Emotet Tier 1 C2s now.”\n\nTeam Cymru has several systems that track threats. One of our more advanced bot tracking\nsystems is our [Botnet Analysis and Reporting Service (BARS). This system takes controller](https://team-cymru.com/products/threat-intelligence-feeds/bars-feed/)\ndata from several inputs and maintains up-to-date information on the controller status. We’re\nnot new to this game, and we know it is common for botnet operators to feed invalid\nconfiguration data. They do this to trip up researchers that do not have validation processes\nin place.\n\nFor Emotet, we connect to the controllers and check for expected responses. We connect\nout from several network exits around the world. This morning, our BARS service saw a\npronounced change.\n\n\n-----\n\nTier 1 controllers drop from 100 to zero.\n\nWhat this shows is the initial Emotet takeover was a profound success. The “Invalid\nResponse” shown above are the seized servers. Team Cymru’s validation rules show that\nthese servers did not match expected responses. The blocking of the non-seized servers\nhad a larger impact than any of us expected! All non-seized servers were unreachable from\nour multiple vantage points.\n\nThe Community\n\nWhen fighting online threats, it is rarely the case that people or companies act alone. Alone,\nwe can only get so far. Threat actors do not act alone and neither do defenders. Team Cymru\noperates with community engagement central to its purpose.\n\nThis effort exemplifies the community impact. There are so many people that contributed to\nthis effort, so many people that choose to go unnamed. One of the larger groups with a\ncritical role in this effort used to have a banner of “Altruistic Meritocracy”. The merit, my\nfriends, is tremendous. And the altruism is inspiring.\n\nThe Impact\n\nEmotet is a complicated botnet to take over. Its infrastructure is redundant and fault tolerant.\nIt is set up with distinct tiers and has some separation to further increase resiliency. Hacked\nservers make up most of its infrastructure. These servers are globally distributed. Before\nTuesday, January 26, 2021, this model was top notch for criminal infrastructure.\n\n\n-----\n\nNow the actors are wearing some shiny new handcuffs. The infrastructure is in law\nenforcement control. Fewer victims are connecting to actor-controlled systems. More people\nare safe today.\n\nInformation security is a war, not a battle. Crime is a human reality and the Internet is subject\nto these maligned human interests. But this is a success story, a win for those fighting to\nprotect innocent victims.\n\nToday we celebrate.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-01-27 - Taking Down Emotet How Team Cymru Leveraged Visibility and Relationships to Coordinate Community Efforts.pdf"
    ],
    "report_names": [
        "2021-01-27 - Taking Down Emotet How Team Cymru Leveraged Visibility and Relationships to Coordinate Community Efforts.pdf"
    ],
    "threat_actors": [
        {
            "id": "aa73cd6a-868c-4ae4-a5b2-7cb2c5ad1e9d",
            "created_at": "2022-10-25T16:07:24.139848Z",
            "updated_at": "2025-03-27T02:02:10.120505Z",
            "deleted_at": null,
            "main_name": "Safe",
            "aliases": [],
            "source_name": "ETDA:Safe",
            "tools": [
                "DebugView",
                "LZ77",
                "OpenDoc",
                "SafeDisk",
                "TypeConfig",
                "UPXShell",
                "UsbDoc",
                "UsbExe"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535926,
    "ts_updated_at": 1743041175,
    "ts_creation_date": 1653766025,
    "ts_modification_date": 1653766025,
    "files": {
        "pdf": "https://archive.orkl.eu/bf444a26c2ffbe13a2e7d6e1c20e4b29df410c69.pdf",
        "text": "https://archive.orkl.eu/bf444a26c2ffbe13a2e7d6e1c20e4b29df410c69.txt",
        "img": "https://archive.orkl.eu/bf444a26c2ffbe13a2e7d6e1c20e4b29df410c69.jpg"
    }
}