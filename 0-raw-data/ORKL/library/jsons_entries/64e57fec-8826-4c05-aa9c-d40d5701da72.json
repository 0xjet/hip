{
    "id": "64e57fec-8826-4c05-aa9c-d40d5701da72",
    "created_at": "2023-01-12T15:08:30.146004Z",
    "updated_at": "2025-03-27T02:14:39.058272Z",
    "deleted_at": null,
    "sha1_hash": "075aabb9002de6856e8b920734d76306efda60e0",
    "title": "2018-07-30 - New version of AZORult stealer improves loading features, spreads alongside ransomware in new campaign",
    "authors": "",
    "file_creation_date": "2022-05-28T19:51:16Z",
    "file_modification_date": "2022-05-28T19:51:16Z",
    "file_size": 2183332,
    "plain_text": "# New version of AZORult stealer improves loading features, spreads alongside ransomware in new campaign\n\n**[proofpoint.com/us/threat-insight/post/new-version-azorult-stealer-improves-loading-features-spreads-alongside](https://www.proofpoint.com/us/threat-insight/post/new-version-azorult-stealer-improves-loading-features-spreads-alongside)**\n\n\nJuly 30, 2018\n\n\n-----\n\n[Blog](https://www.proofpoint.com/us/blog)\n[Threat Insight](https://www.proofpoint.com/us/blog/threat-insight)\nNew version of AZORult stealer improves loading features, spreads alongside ransomware in new campaign\n\nJuly 30, 2018 Proofpoint Staff\n\n\n-----\n\n**O e** **e**\n\nAZORult is a robust information stealer & downloader that Proofpoint researchers originally identified in 2016 as part of a secondary infection\nvia the Chthonic banking Trojan. We have since observed many instances of AZORult dropped via exploit kits and in fairly regular email\ncampaigns as both a primary and secondary payload.\n\nRecently, AZORult authors released a substantially updated version, improving both on its stealer and downloader functionality. It is noteworthy\nthat within a day of the new update appearing on underground forums, a prolific actor used the new version in a large email campaign,\nleveraging its new capabilities to distribute Hermes ransomware. It is always interesting to see malware campaigns where both a stealer and\nransomware are present, as this is less common [1], and especially disruptive for recipients who initially may have credentials, cryptocurrency\n[wallets, and more stolen before losing access to their files in a subsequent ransomware attack.](https://www.proofpoint.com/us/threat-reference/ransomware)\n\n**AZORult Forum Advertisement**\n\nOn July 17, a major update to the AZORult credential stealer and downloader was advertised on an underground forum. The change log for\nthe new version -- Version 3.2 -- is shown below. The conditional loader feature, based on the presence of cookies, cryptocurrency wallets, and\nother parameters, is particularly noteworthy.\n\n**************\n\n_Change log text:_\n\nUPD v3.2\n\n[+] Added stealing of history from browsers (except IE and Edge)\n\n[+] Added support for cryptocurrency wallets: Exodus, Jaxx, Mist, Ethereum, Electrum, Electrum-LTC\n\n[+] Improved loader. Now supports unlimited links. In the admin panel, you can specify the rules for how the loader works. For example: if\nthere are cookies or saved passwords from mysite.com, then download and run the file link[.]com/soft.exe. Also there is a rule \"If there is\ndata from cryptocurrency wallets\" or \"for all\"\n\n[+] Stealer can now use system proxies. If a proxy is installed on the system, but there is no connection through it, the stealer will try to\nconnect directly (just in case)\n\n[+] Reduced the load in the admin panel.\n\n[+] Added to the admin panel a button for removing \"dummies\", i.e. reports without useful information\n\n[+] Added to the admin panel guest statistics\n\n[+] Added to the admin panel a geobase\n\n**************\n\n**Campaign Analysis**\n\nOn July 18, 2018, one day after the AZORult update above was announced, we observed a campaign delivering thousands of messages\ntargeting North America that used the new version of AZORult. The messages used employment-related subjects such as “About a role” and\n“Job Application”. The attached documents used file names in the format of “firstname.surname_resume.doc”.\n\n_Figure 1: Email used in the July 18 campaign_\n\n\n-----\n\ne docu e ts t s ca pa g e e pass o d p otected e pass o d as c uded t e body o t e o g a e a a d, t s case, as\n‘789’, as visible in Figure 1 above. This technique is an attempt to evade various antivirus engines, since the document itself is not malicious\nuntil the password is entered successfully. Once potential victims enter the password, they also need to enable macros for the document to\ndownload AZORult, which in turn downloads the Hermes 2.1 ransomware payload.\n\n_Figure 2: Document attachment used in the July 18 campaign_\n\n[We attribute this campaign to an actor we track as TA516. In 2017 we presented research on TA516 and ways in which this actor used](https://www.proofpoint.com/us/threat-insight/post/dialing-dollars-coinminers-appearing-malware-components-standalone-threats)\ndocuments with similar resume lures to download banking Trojans or a Monero miner. Improved means of stealing cryptocurrency wallets and\ncredentials in the new version of AZORult might also provide a connection to TA516’s demonstrated interests in cryptocurrencies.\n\n**Malware Analysis**\n\nOnce the recipient opens the password-protected document and enables the embedded macros, the macros download AZORult. While there\nwere many code changes to the malware, we focused on analyzing the updated command and control (C&C) communication protocol.\n\nThe following POST is an initial client-to-server communication, where the client sends an initial checkin request and the server responds with\ndata XOR-encoded with a 3-byte key (The XOR key in this case was \\x0d0ac8). If we decode this data, the server response begins with a\nbase64-encoded configuration block.\n\n\n-----\n\n_Figure 3: Initial client beacon followed by the encoded server response_\n\n_Figure 4: Initial client beacon followed by the server response (decoded by us manually)_\n\nAs Figure 4 shows, there is a base64 string (configuration block) included in the server response between the “<c>” and “</c>” tags. It decodes\nto the following, revealing cryptocurrency strings of interest:\n\n++++-+++++\n\n\n-----\n\n3 % S _ 3%\n*wallet*.txt,*seed*.txt,*btc*.txt,,*key*.txt,*2fa*.txt,*2fa*.png,*2fa*.jpg,*auth*.jpg,*auth*.png,*crypto*.txt,*coin*.txt,*poloniex*,*kraken*,*okex*,*binance*\n10   +   \nI   <REMOVED, IP ADDRESS OF THE INFECTED CLIENT>:<COUNTRY OF THE INFECTED CLIENT>\n\nWe can also see another encoded block after the base64 string (only the beginning of the block is shown for brevity). This is yet another XORencoded data block, where the key is 4 bytes. Decoding this second encoded data block reveals additional configuration information and\nexecutable files such as mozglue.dll, nssdbm3.dll, softokn3.dll, ucrtbase.dll, or vcruntime140.dll. While the purpose of these executables is not\nknown, we do not see any reason to send these other than to perhaps delay reverse engineering and analysis.\n\nNext, after the initial exchange between the infected machine and the C&C server, the infected machine sends a report containing the stolen\ninformation. Again the report is XOR-encoded with the same 3-byte key; a portion of the decoded version is shown in Figure 5. The stolen\ninformation is organized into sections:\n\ninfo: basic computer information such as Windows version and computer name\npwds: this section contains stolen passwords (not confirmed)\ncoks: cookies or visited sites\nfile: contents of the cookies files and a file containing more system profiling information including machine ID, Windows version,\ncomputer name, screen resolution, local time, time zone, CPU model, CPU count, RAM, video card information, process listing of the\ninfected machine, and software installed on the infected machine.\n\n_Figure 5: A report of stolen information sent by the infected machine (only a snippet is shown here)_\n\nFinally, after the initial beaconing, receiving a configuration, and exfiltrating stolen information from the infected machine, AZORult may\ndownload the next payload. For example, in the campaign described at the beginning of this post, AZORult downloads Hermes 2.1\nransomware after it exfiltrates the victim’s data and credentials.\n\n**Conclusion**\n\nAs in legitimate software development, malware authors regularly update their software to introduce competitive new features, improve\nusability, and otherwise differentiate their products. The recent update to AZORult includes substantial upgrades to malware that was already\nwell-established in both the email and web-based threat landscapes. It is noteworthy that within a day of the new update appearing on\nunderground forums, a prolific actor used the new version in a large email campaign, leveraging its new capabilities to distribute Hermes\nransomware.\n\nThe potential impact of this type of attack is considerable:\n\n1. The campaigns sent thousands of messages\n2. AZORult malware, with its capabilities for credential and cryptocurrency theft, brings potential direct financial losses for individuals as\n\nwell as the opportunity for actors to establish a beachhead in affected organizations\n3. Additional direct financial losses and business disruption via infection with Hermes ransomware.\n\n\n-----\n\n**e e e ces**\n\n[1] [https://www.malware-traffic-analysis.net/2017/01/27/index2.html](https://www.malware-traffic-analysis.net/2017/01/27/index2.html)\n\n[2] [https://malware.dontneedcoffee.com/2018/03/CVE-2018-4878.html#gf-sundown](https://malware.dontneedcoffee.com/2018/03/CVE-2018-4878.html#gf-sundown)\n\n[3] [https://www.proofpoint.com/us/threat-insight/post/threat-actors-using-legitimate-paypal-accounts-distribute-chthonic-banking](https://www.proofpoint.com/us/threat-insight/post/threat-actors-using-legitimate-paypal-accounts-distribute-chthonic-banking)\n\n**Indicators of Compromise (IOCs)**\n\n**IOC** **IOC Type** **Description**\n\nccf1f4d83023c51a75ba008cbd25167c2a1e55f6a8617fe004b63dcd4acc0de4 SHA-256 Malicious document\n\nhxxp://205.185.121[.]209/azo.exe URL Document payload (AZORult)\n\n3809394dceddbe1419e964cd08397e5fed4a0bbefc8be466f33614bac8794243 SHA-256 AZORult\n\nhxxp://briancobert[.]com/index.php URL AZORult C&C\n\nhxxp://205[.]185.121[.]209/5.exe URL AZORult payload (Hermes)\n\n6071511eea15d5b1d9d8bf9803ad71b3fe65c455b77d683a3aaf887fa54cb447 SHA-256 Hermes\n\n**ET and ETPRO Suricata/Snort/ClamAV Signatures**\n\n2025885 || ET TROJAN AZORult Variant.4 Checkin\n\nSubscribe to the Proofpoint Blog\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2018/2018-07-30 - New version of AZORult stealer improves loading features, spreads alongside ransomware in new campaign.pdf"
    ],
    "report_names": [
        "2018-07-30 - New version of AZORult stealer improves loading features, spreads alongside ransomware in new campaign.pdf"
    ],
    "threat_actors": [
        {
            "id": "9b34a837-9f3f-4451-b8bf-adf424655df5",
            "created_at": "2023-01-06T13:46:39.310096Z",
            "updated_at": "2025-03-27T02:00:03.047567Z",
            "deleted_at": null,
            "main_name": "TA516",
            "aliases": [],
            "source_name": "MISPGALAXY:TA516",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "a66438a8-ebf6-4397-9ad5-ed07f93330aa",
            "created_at": "2022-10-25T16:47:55.919702Z",
            "updated_at": "2025-03-27T02:05:17.412024Z",
            "deleted_at": null,
            "main_name": "IRON VIKING",
            "aliases": [
                "ATK14 ",
                "BlackEnergy Group",
                "Blue Echidna ",
                "CTG-7263 ",
                "ELECTRUM ",
                "FROZENBARENTS ",
                "Hades/OlympicDestroyer ",
                "IRIDIUM ",
                "Qudedagh ",
                "Sandworm Team ",
                "Seashell Blizzard ",
                "TEMP.Noble ",
                "Telebots ",
                "Voodoo Bear ",
                "APT44 "
            ],
            "source_name": "Secureworks:IRON VIKING",
            "tools": [
                " BlackEnergy",
                " GCat",
                " GreyEnergy",
                " Industroyer",
                " KillDisk",
                " NotPetya",
                " PSCrypt",
                " TeleBot",
                " TeleDoor",
                " xData",
                "BadRabbit"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "b3e954e8-8bbb-46f3-84de-d6f12dc7e1a6",
            "created_at": "2022-10-25T15:50:23.339976Z",
            "updated_at": "2025-03-27T02:00:55.446795Z",
            "deleted_at": null,
            "main_name": "Sandworm Team",
            "aliases": [
                "Sandworm Team",
                "ELECTRUM",
                "Telebots",
                "IRON VIKING",
                "BlackEnergy (Group)",
                "Quedagh",
                "Voodoo Bear",
                "IRIDIUM",
                "Seashell Blizzard",
                "FROZENBARENTS",
                "APT44"
            ],
            "source_name": "MITRE:Sandworm Team",
            "tools": [
                "Bad Rabbit",
                "Mimikatz",
                "Exaramel for Linux",
                "Exaramel for Windows",
                "GreyEnergy",
                "PsExec",
                "Prestige",
                "P.A.S. Webshell",
                "VPNFilter",
                "Cyclops Blink",
                "SDelete",
                "AcidRain",
                "Industroyer",
                "Industroyer2",
                "BlackEnergy",
                "Cobalt Strike",
                "NotPetya",
                "KillDisk",
                "PoshC2",
                "Impacket",
                "Invoke-PSImage",
                "Olympic Destroyer"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "3a0be4ff-9074-4efd-98e4-47c6a62b14ad",
            "created_at": "2022-10-25T16:07:23.590051Z",
            "updated_at": "2025-03-27T02:02:09.878211Z",
            "deleted_at": null,
            "main_name": "Energetic Bear",
            "aliases": [
                "ATK 6",
                "Blue Kraken",
                "Crouching Yeti",
                "Dragonfly",
                "Electrum",
                "Energetic Bear",
                "Ghost Blizzard",
                "Group 24",
                "ITG15",
                "Iron Liberty",
                "Koala Team",
                "TG-4192"
            ],
            "source_name": "ETDA:Energetic Bear",
            "tools": [
                "Backdoor.Oldrea",
                "CRASHOVERRIDE",
                "Commix",
                "CrackMapExec",
                "CrashOverride",
                "Dirsearch",
                "Dorshel",
                "Fertger",
                "Fuerboos",
                "Goodor",
                "Havex",
                "Havex RAT",
                "Hello EK",
                "Heriplor",
                "Impacket",
                "Industroyer",
                "Karagany",
                "Karagny",
                "LightsOut 2.0",
                "LightsOut EK",
                "Listrix",
                "Oldrea",
                "PEACEPIPE",
                "PHPMailer",
                "PsExec",
                "SMBTrap",
                "Subbrute",
                "Sublist3r",
                "Sysmain",
                "Trojan.Karagany",
                "WSO",
                "Webshell by Orb",
                "Win32/Industroyer",
                "Wpscan",
                "nmap",
                "sqlmap",
                "xFrost"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "aeda543e-ce27-41a9-9719-d6e2941b7dbf",
            "created_at": "2022-10-25T16:07:24.57632Z",
            "updated_at": "2025-03-27T02:02:10.285729Z",
            "deleted_at": null,
            "main_name": "TA516",
            "aliases": [
                "SmokingDro"
            ],
            "source_name": "ETDA:TA516",
            "tools": [
                "AZORult",
                "AndroKINS",
                "Chthonic",
                "Dofoil",
                "PandaBanker",
                "PuffStealer",
                "Rultazo",
                "Sharik",
                "Smoke Loader",
                "SmokeLoader",
                "Zeus Panda",
                "ZeusPanda"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "8941e146-3e7f-4b4e-9b66-c2da052ee6df",
            "created_at": "2023-01-06T13:46:38.402513Z",
            "updated_at": "2025-03-27T02:00:02.824555Z",
            "deleted_at": null,
            "main_name": "Sandworm",
            "aliases": [
                "G0034",
                "IRIDIUM",
                "Blue Echidna",
                "FROZENBARENTS",
                "Seashell Blizzard",
                "IRON VIKING",
                "ELECTRUM",
                "TeleBots",
                "UAC-0113",
                "UAC-0082",
                "APT44",
                "Quedagh",
                "VOODOO BEAR",
                "TEMP.Noble"
            ],
            "source_name": "MISPGALAXY:Sandworm",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673536110,
    "ts_updated_at": 1743041679,
    "ts_creation_date": 1653767476,
    "ts_modification_date": 1653767476,
    "files": {
        "pdf": "https://archive.orkl.eu/075aabb9002de6856e8b920734d76306efda60e0.pdf",
        "text": "https://archive.orkl.eu/075aabb9002de6856e8b920734d76306efda60e0.txt",
        "img": "https://archive.orkl.eu/075aabb9002de6856e8b920734d76306efda60e0.jpg"
    }
}