{
    "id": "68a07ea5-10dd-42b0-af3d-31fe3c063172",
    "created_at": "2023-01-12T15:01:36.02519Z",
    "updated_at": "2025-03-27T02:06:10.044772Z",
    "deleted_at": null,
    "sha1_hash": "6bb8071203c5d2ce7bd8dca740f1fc5668c61c2b",
    "title": "2021-03-02 - Microsoft-365-Defender-Hunting-Queries for hunting Gootkit malware delivery and C2",
    "authors": "",
    "file_creation_date": "2022-05-28T16:03:24Z",
    "file_modification_date": "2022-05-28T16:03:24Z",
    "file_size": 102716,
    "plain_text": "# Gootkit malware delivery and C2\n\n**[github.com/microsoft/Microsoft-365-Defender-Hunting-Queries/blob/master/Delivery/Gootkit-malware.md](https://github.com/microsoft/Microsoft-365-Defender-Hunting-Queries/blob/master/Delivery/Gootkit-malware.md)**\n\nmicrosoft\n\nThis query was originally published on Twitter, by [@MsftSecIntel.](https://twitter.com/MsftSecIntel)\n\nGootkit is malware that started life as a banking trojan, and has since extended\nits capabilities to allow for a variety of malicious activities.\n\nThe query helps find events related to Gootkit downloads and command-andcontrol behavior.\n\n## Query\n\n\n-----\n\n```\nAlertInfo | where Title  Suspected delivery of Gootkit malware \n// Below section is to surface active follow-on Command and Control as a\nresult of the above behavior. Comment out the below joins to see\n// only file create events where the malware may be present but has not\nyet been executed.\n////\n// Get alert evidence\n| join AlertEvidence on $left.AlertId == $right.AlertId\n// Look for C2\n| join DeviceNetworkEvents on $left.DeviceId == $right.DeviceId\n| where InitiatingProcessFileName =~ \"wscript.exe\" and\nInitiatingProcessCommandLine has \".zip\" and InitiatingProcessCommandLine\nhas \".js\"\n| summarize by RemoteUrl, RemoteIP, DeviceId,\nInitiatingProcessCommandLine, Timestamp, \nInitiatingProcessFileName, AlertId, Title, AccountName\n\n## Category\n\n```\nThis query can be used to detect the following attack techniques and tactics\n[(see MITRE ATT&CK framework) or security configuration states.](https://attack.mitre.org/)\n\n**Technique, tactic, or state** **Covered? (v=yes)** **Notes**\n\nInitial access\n\nExecution\n\nPersistence\n\nPrivilege escalation\n\nDefense evasion\n\nCredential Access\n\nDiscovery\n\nLateral movement\n\nCollection\n\nCommand and control v\n\nExfiltration\n\nImpact\n\nVulnerability\n\nExploit\n\n\n-----\n\n**Technique, tactic, or state** **Covered? (v=yes)** **Notes**\n\nMisconfiguration\n\nMalware, component\n\nRansomware\n\n## Contributor info\n\n**Contributor: Microsoft 365 Defender team**\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-03-02 - Microsoft-365-Defender-Hunting-Queries for hunting Gootkit malware delivery and C2.pdf"
    ],
    "report_names": [
        "2021-03-02 - Microsoft-365-Defender-Hunting-Queries for hunting Gootkit malware delivery and C2.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673535696,
    "ts_updated_at": 1743041170,
    "ts_creation_date": 1653753804,
    "ts_modification_date": 1653753804,
    "files": {
        "pdf": "https://archive.orkl.eu/6bb8071203c5d2ce7bd8dca740f1fc5668c61c2b.pdf",
        "text": "https://archive.orkl.eu/6bb8071203c5d2ce7bd8dca740f1fc5668c61c2b.txt",
        "img": "https://archive.orkl.eu/6bb8071203c5d2ce7bd8dca740f1fc5668c61c2b.jpg"
    }
}