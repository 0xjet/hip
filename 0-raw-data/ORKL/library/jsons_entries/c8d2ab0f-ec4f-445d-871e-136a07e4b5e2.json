{
    "id": "c8d2ab0f-ec4f-445d-871e-136a07e4b5e2",
    "created_at": "2023-01-12T15:01:18.308088Z",
    "updated_at": "2025-03-27T02:09:49.200925Z",
    "deleted_at": null,
    "sha1_hash": "90ce7cff7f6269905736253773c5d5eb3132d5a3",
    "title": "2021-08-31 - Financial Institutions in the Sight of New JsOutProx Attack Waves",
    "authors": "",
    "file_creation_date": "2022-05-28T15:44:11Z",
    "file_modification_date": "2022-05-28T15:44:11Z",
    "file_size": 3267081,
    "plain_text": "# Financial Institutions in the Sight of New JsOutProx Attack Waves\n\n**yoroi.company/research/financial-institutions-in-the-sight-of-new-jsoutprox-attack-waves/**\n\n08/31/2021\n\n## Introduction\n\n\nAugust 31, 2021\n\n\nWhen threat actors evolve, their tools do so. Observing the evolution of the threats we track during our cyber defense operations is part of\nwhat we do to secure our customers. Back in 2019, the Yoroi’s Malware ZLAB unit discovered a complete new malware implant named\n[“JsOutProx” (TH-264), a complex JavaScript-based RAT used to attack financial institutions in the APAC area.](https://yoroi.company/research/unveiling-jsoutprox-a-new-enterprise-grade-implant/)\n\nIn the last two years, the evolution of this implant was clear. After our initial discovery, many security research teams started monitoring this\n[elusive threat, both ZScaler researchers and Fortinet ones began tracking the actor activities too, then we started noticing the sophistication of](https://www.zscaler.com/blogs/research/targeted-attacks-indian-government-and-financial-institutions-using-jsoutprox-rat)\nthe malicious code. The actor behind JsOutProx (TH-264), also dubbed as SOLAR SPIDER in the CrowdStrike naming scheme, is protecting\nthe new code with improved protection mechanisms and at the same time we started noticing signs of a potential emergent expansion of\nthe attack operations to western financial organizations.\n\nIn this report, Yoroi’s Malware ZLAB dissects the latest version of JsOutProx malware and defeats its new protection mechanisms to unveil its\nfull offensive capabilities.\n\n\n-----\n\nFigure 1: Yoroi Flashcard about JsOutProx\n\n## Technical Analysis\n\n**Hash** 65987f95b365501579431ea8dec1d45940430d8c9defad58908a14e6fb96a347\n\n**Threat** JsOutProx\n\n**Brief Description** JsOutProx RAT – Jun 2021\n\n**File Size** 2276KB\n\n**Ssdeep** 24576:eOa0QS/9pn7qKkxds34NPoE3j2hYW8jecNH2Pzw83ZEkTE50DngGfayxg3qfDOoX:Pl\n\nTable 1: Static information about the sample\n\nThe infection starts with a malicious phishing messages attending to be a bank transaction. It also leverages the classic Masquerading\ntechnique (T1036), pretending to be a PDF file instead of a JS code.\n\nBesides this elementary technique, we decided to deepen the improvements of the various versions we observed. The first immediate basic\nstatic evidence which we noticed is the increasing of the file size. In fact, we started to analyze the first documented version which was about\n800KB, and now it is three time the original one, letting immediately think about the fact that the malware writers improved\nthe obfuscation strategies, and not only, they enriched the capabilities of the malicious code.\n\n## Digging inside the new JsOutProx version\n\nThis new variant has a more sophisticated level of obfuscation than the previous versions, enhancing the anti-analysis capabilities. The highlevel structure of the code can be synthetized in the following figure:\n\n\n-----\n\nFigure 2: High level structure of the malicious JavaScript\n\nThe first part of the malicious code is a long array containing about 30k of encrypted strings encoded in Base-64 format:\n\nFigure 3: Piece of the long array containing the encrypted information\n\nAfter that, we spotted a piece of code looking as a decoding stub, composed by the following primitives:\n\nFigure 4: Prototipe of the decoding routines\n\nThe most interesting function of the ones reported below is the “H” function because it hides the main decoding routine.\n\n\n-----\n\nFigure 5: Piexe of the recursive decoding routine\n\nThis function represents unambiguous evidence of how the attacker enhanced the code obfuscation because the body has been rewritten to\nbe recursive, making the analysis harder and to avoid detection.\n\nAfter that decoding stub, we isolated the configuration of the malware: this time the structure of the configuration is similar\nto the previous versions of JsOutProx. After the deobfuscation operations we obtained an acceptable human-readable result:\n\nFigure 6: Example of the deobfuscation process\n\n\n-----\n\ne co gu at o o t e a a e s substa t a y s a s ce e t a e s o s o t e sa p es but t e e a e a coup e e d e dec ded to epo t\nthe most relevant of them:\n\n**Field name** **Description**\n\nFs Gain FileSystem privileges to Read-Write files\n\nWsh Allow the program to execute WScript files\n\nSh Allow the program to execute command line programs\n\nBaseUrl C2 URL\n\nStartDate Date of the starting infection\n\nInstallDir Directory of the malware installation\n\nDelimiter Separator used by the malware to delimit the exfiltrated information\n\nSleepTime Delay of the malware Execution\n\nPassword A password probably used to decrypt some content in some\n\nTag Tag of the campaign (which we initially used to name the malware family as JsOutProx)\n\nIDPrefix A parameter set during the sending the Cookie in requests to the C2\n\n**ProxyActions** _A new parameter indicating if the malware is a “proxy” for other process. In particular, the malware starts every_\n_time it needs to execute a command a new process from the command line_\n\nStartArgs A series of arguments allowing the malware to customize the infection\n\n**ViewOnly** _A new boolean parameter indicating whether the infection is in view only mode: if it is so, the_\n_malware cannot modify anything on the system, but only exfiltrate and modify the malware_\n\nTable 2: Configuration of JsOutProx\n\nTwo of these configuratons are particularly interesting to understand the flexibility of the implant: “ProxyActions” and “ViewOnly”. This malware\ncan also operate as a silent info stealer making it an impressive reconnaissance tool for the initial phases of an intrusion, but it can also\nbe leveraged to run more advanced, and noisy, offensive plugins using proxy processes to keep the main infection process safe\nfrom detection and security terminations.\n\n## Offensive Capabilities\n\nAfter that, we have an exceptionally extensive list of interpreted commands used by the malware. Over the years, these commands have been\nmodified and their body changed, so we decided to report a comprehensive list of them to provide a clear outlook about the offensive\ncapabilities of this javascript-based malware:\n\nInterpreted Commands Description\n\n[\"getUa\"] Ua stands for the interpreter of that commands\n\n[\"getUuid\"] Retrieves the Uuid of the malicious process\n\n[\"isHTA\"] Return true if the malicious script is an HTA file\n\n[\"isWScript\"] Return true if the malicious script is a WScript-readable file\n\n[\"sleepPing\"] Use ping to localhost as a sleep technique\n\n[\"sleep\"] Sleep for a set time\n\n[\"sleepEx\"] Sleep for a set time\n\n[\"scriptName\"] Retrieve the script name\n\n[\"scriptFullName\"] Retrieve the full name of the malicious script\n\n[\"scriptParentDir\"] Retrieve the path of the script\n\n[\"launch\"] Launch a command\n\n[\"getJavaPath\"] Retrieve the java path\n\n[\"checkJrePath\"] Check the existence of JRE\n\n\n-----\n\n[\"getLaunchCommand\"] Retrieve the command\n\n[\"installOrRun\"] Decide if install or run without persistence\n\n[\"install\"] Install the malware persistence\n\n[\"unInstall\"] Uninstall the malware\n\n[\"getLauncher\"] Get the Launcher Process (it can be MSHTA, WScript, Powershell)\n\n[\"addRegistry\"] Write a new Registry key in RunSubKey config key\n\n[\"removeRegistry\"] Remove a new Registry key in RunSubKey config key\n\n[\"addStartup\"] Set the persistence through the the Autorun Registry Key\n\n[\"removeStartup\"] Remove the persistence\n\n[\"exit\"] Kill the malware process\n\n[\"getFullBody\"] Retrieve the full body of the response of the C2 with all the commands separated by the Delimiter\n\n[\"setZone\"] Set a specific Time zone\n\n[\"update\"] Update the malware Core\n\n[\"restart\"] Restart the malware process\n\n[\"receive\"] Receive is a listener to interpret the commands sent by the C2. The commands are: “fnm”: send ScriptFullName to the\ninvoke DownloadPlugin “sp”: invoke ScreenPShellPlugin “cn”: invoke ShellPlugin “in”: invoke InfoPlugin “sh”: invoke S\n\n[\"launchArgs\"] Execute the malware with the arguments\n\n[\"getArgs\"] Retrieve the arguments of the malware\n\n[\"init\"] Malware initializations\n\n[\"Base64\"] A sort of constructor for Base64 commands family\n\n[\"Base64\"][\"encode\"] Encode a stream in Base64 format\n\n\n\n[\"Base64\"]\n\n[\"encodeString\"]\n\n\nEncode a string in Base64 format\n\n\n\n[\"Base64\"][\"encodeFile\"] Encode a file in Base64 Format\n\n[\"Base64\"][\"decode\"] Decode a file or a stream from Base64Format\n\n\n\n[\"Base64\"]\n\n[\"decodeString\"]\n\n\nDecode a string from Base64Format\n\n\n\n[\"Environment\"] A constructor for Environment commands\n\n\n\n[\"Environment\"]\n\n[\"userName\"]\n\n[\"Environment\"]\n\n[\"computerName\"]\n\n[\"Environment\"]\n\n[\"userDomain\"]\n\n[\"Environment\"]\n\n[\"encoding\"]\n\n[\"Environment\"]\n\n[\"engineVersion\"]\n\n[\"Environment\"]\n\n[\"engine\"]\n\n\nRetrieve the username of the infected machine\n\nRetrieve the computer name of the infected machine\n\nRetrieve the username inside the domain\n\nRetrieve the encoding of the strings by reading the registry key: “HKLM\\SYSTEM\\CurrentControlSet\\Control\\Nls\\Code\n\nRetrieve the engine version of the interpreter\n\nSet a specific engine interpreter\n\n\n\n[\"Hex\"] A sort of connstructor for the Hex command family\n\n[\"Hex\"][\"encodeBytes\"] Encode a byte-stream in hex format\n\n[\"Hex\"][\"encode\"] Encode a stream in hex format\n\n[\"Hex\"][\"encodeFile\"] Encode a file in Hex Format\n\n\n-----\n\n[\"Hex\"][\"decodeBytes\"] Decode a stream from the Hex Format\n\n[\"Hex\"][\"decode\"] Decode a stream or a file from the hex format\n\n[\"Http\"] A sort of constructor oh Http Command family\n\n[\"Http\"][\"create\"] Construct a \"WinHttp.WinHttpRequest.5.1\" request\n\n[\"Http\"][\"addHeaders\"] Add new Headers to the HttpRequest\n\n[\"Http\"][\"post\"] Prepare the Post Request\n\n[\"Http\"][\"get\"] Prepare the Get Request\n\n[\"Http\"][\"head\"] Prepare the Head Request\n\n[\"Http\"][\"send\"] Send efiltrated info to the C2\n\n[\"Http\"][\"uploadFile\"] Upload a File to the C2\n\n[\"Http\"][\"downloadFile\"] Download a file from the C2\n\n[\"MessageBag\"] A sort of constructor for internal log messages\n\n[\"MessageBag\"][\"info\"] Log an info\n\n[\"MessageBag\"][\"error\"] Log an error\n\n[\"Moment\"] A sort of constructor for Moment object\n\n\n\n[\"Moment\"]\n\n[\"getDayString\"]\n\n\nRetrieve the exact time of the machine\n\n\n\n['Os'] A sort od constructor for Os commands\n\n['Os'][\"caption\"] Get a screenshot of the machine\n\n['Os'][\"security\"] Retrieve che security configuration through WMI query\n\n['Os'][\"isResolution\"] Retrieve the Resolution of the HTA application of the malware\n\n\n\n['Os']\n\n[\"screenResolution\"]\n\n['Os']\n\n[\"wmiScreenResolution\"]\n\n['Os']\n\n[\"wmiMonitorCount\"]\n\n\nRetrieve the screen resolution\n\nRetrieve the screen resolution through WMI command\n\nRetrieve the number of monitors through WMi command\n\n\n\n['Os'][\"arch\"] Retrieve the CPU architecture info\n\n['Os'][\"volumeSerial\"] Retrieve the Serial of the disk\n\n['Os'][\"version\"] Retrieve the OS version through winmgmts command\n\n['Os'][\"version2\"] Retrieve the OS version using the ['Os'][\"version\"] primitive\n\n['Os'][\"windowsXp\"] Check is WindowsXP\n\n['Os'][\"majorVersion\"] Retrieve only the major version\n\n[\"Registry\"] A sort of constructor of Registry commands\n\n\n\n[\"Registry\"][\"HKCR\"] =\n0x80000000\n\n[\"Registry\"][\"HKCU\"] =\n0x80000001\n\n[\"Registry\"][\"HKLM\"] =\n0x80000002\n\n[\"Registry\"][\"HKUS\"] =\n0x80000003\n\n[\"Registry\"][\"HKCC\"] =\n0x80000005\n\n\nSet a sort of instance variable for HKCR\n\nSet a sort of instance variable for HKCU\n\nSet a sort of instance variable for HKLM\n\nSet a sort of instance variable for HKUS\n\nSet a sort of instance variable for HKCC\n\n\n-----\n\n[\"Registry\"][\"STRING\"] =\n0x0\n\n[\"Registry\"][\"BINARY\"] =\n0x1\n\n[\"Registry\"][\"DWORD\"] =\n0x2\n\n[\"Registry\"][\"QWORD\"] =\n0x3\n\n[\"Registry\"]\n\n[\"WOW64_32KEY\"] =\n0x20\n\n[\"Registry\"]\n\n[\"WOW64_64KEY\"] =\n0x40\n\n\nSet a sort of instance variable for String Variable\n\nSet a sort of instance variable for Binary Variable\n\nSet a sort of instance variable for DWORD variable\n\nSet a sort of instance variable for QWORD Varibale\n\nSet a sort of instance variable for 32 bit key\n\nSet a sort of instance variable for 64 bit key\n\n\n\n[\"Registry\"][\"provider\"] Get the provider to access to Registry\n\n[\"Registry\"][\"write\"] Wrtie a Registry key\n\n[\"Registry\"][\"keyExists\"] Check if a registry key exists\n\n[\"Registry\"][\"read\"] Read a Registry key\n\n[\"Registry\"][\"remove\"] Remove a registry key\n\n\n\n[\"Registry\"]\n\n[\"removeValue\"]\n\n\nRemove the value of a registry key\n\n\n\n[\"Registry\"][\"create\"] Create a registry key\n\n[\"Stream\"] A sort of Constructor for Stream Utility\n\n\n\n[\"Stream\"]\n\n[\"stringToBytes\"]\n\n[\"Stream\"]\n\n[\"bytesToString\"]\n\n\nConvert a string to a byte array stream\n\nConvert a byte array string to a string\n\n\n\n[\"XmlEncoding\"] A sort of Constructor for XmlEncoding Utility\n\n\n\n[\"XmlEncoding\"]\n\n[\"encodeString\"]\n\n[\"XmlEncoding\"]\n\n[\"encode\"]\n\n[\"XmlEncoding\"]\n\n[\"encodeFile\"]\n\n[\"XmlEncoding\"]\n\n[\"decode\"]\n\n[\"XmlEncoding\"]\n\n[\"decodeString\"]\n\n\nEncode a string in Microsoft.XMLDOM format using [\"XmlEncoding\"][\"encode\"] commadn\n\nEncode a Stream in Microsoft.XMLDOM format\n\nEncode a file in Microsoft.XMLDOM format\n\nDecode a Stream encoded in Microsoft.XMLDOM format\n\nDecode a String encoded in Microsoft.XLDOM format\n\n\n\n[\"Association\"] A sort of constructor for Association commands\n\n\n\n[\"Association\"]\n\n[\"createAssocCmd\"]\n\n[\"Association\"]\n\n[\"createAssoc\"]\n\n[\"Association\"]\n\n[\"createTypeCmd\"]\n\n[\"Association\"]\n\n[\"createType\"]\n\n[\"Association\"]\n\n[\"removeAssocCmd\"]\n\n[\"Association\"]\n\n[\"removeTypeCmd\"]\n\n\nPrepare a Command line to execute through [“Process”] commands\n\nPrepare a command line string to pass to methods\n\nCreate a new process command line\n\nCreate a command line to exec by writing a command inside \"HKCR\\\\{0}\\\\shell\\\\open\\\\command\\\\\" registry key\n\nRemove an associaction through another command line\n\nRemove an association through the registry key\n\n\n-----\n\n[\"Association\"]\n\n[\"removeAssoc\"]\n\n[\"Association\"]\n\n[\"removeType\"]\n\n\nRemove the prepared command line\n\nRemove the prepared command ilne to pass to the registry key\n\n\n\n[\"AssociationPlugin\"] A sort of constructor for the AssociationPlugin\n\n\n\n[\"AssociationPlugin\"]\n\n[\"receive\"]\n\n\nA listener for the Commands to exec to Association. The commands are: \"as.g\": Send to the C2 through [Http][Send] t\n\n\n\n[\"Download\"] A sort of constructor for Download comamnd\n\n[\"Download\"][\"pShell\"] Download a file through a Powershell command\n\n[\"DownloadPlugin\"] A sort of constructor for Download Plugin\n\n\n\n[\"DownloadPlugin\"]\n\n[\"receive\"]\n\n\nA listener for the DownloadPlugin module. The command is named “do.n”\n\n\n\n[\"File\"] A sort of constructor for File commands\n\n[\"File\"][\"waitFor\"] Wait for a specific Date\n\n[\"File\"][\"getParentPath\"] Retrieve the parent Path\n\n[\"File\"][\"getFileName\"] Retrieve the File name of the malware\n\n[\"File\"][\"remove\"] Remove a file\n\n[\"File\"][\"copy\"] Copy a File\n\n[\"File\"][\"move\"] Move a File\n\n[\"File\"][\"createFolder\"] Create a Folder\n\n[\"File\"][\"removeEx\"] Remove a File or directory through cmd line\n\n[\"File\"][\"copyEx\"] Copy a file or directory through cmd line\n\n[\"File\"][\"moveEx\"] Move a file or directory through cmd line\n\n[\"File\"][\"rename\"] Rename a file or directory\n\n[\"File\"][\"createFolderEx\"] Create a folder though cmd line\n\n[\"File\"][\"getInfo\"] Retrieve the info of a folder or a file\n\n[\"File\"][\"getSize\"] Retrieve the size of a folder or a file\n\n[\"File\"][\"exists\"] Check if a file or a folder exists\n\n[\"File\"][\"fileExists\"] Check if a file exists\n\n[\"File\"][\"folderExists\"] Check if a folder exists\n\n[\"File\"][\"driveExists\"] Check if a drive Exists\n\n[\"File\"][\"expandPath\"] Expand the Environmental strings\n\n[\"File\"][\"getFileSize\"] Retrieve a file size\n\n[\"File\"][\"getFolderSize\"] Retrieve a Folder Size\n\n[\"File\"][\"deleteFile\"] Delete a file\n\n[\"File\"][\"deleteFolder\"] Delete a Folder\n\n[\"File\"][\"copyFile\"] Copy a File\n\n[\"File\"][\"moveFile\"] Move a File\n\n[\"File\"][\"copyFolder\"] Copy a folder\n\n[\"File\"][\"moveFolder\"] Move a Folder\n\n[\"File\"][\"getFileInfo\"] Retrieve the information of a file\n\n[\"File\"][\"getFolderInfo\"] Retrieve the folder info\n\n\n-----\n\n[\"File\"][\"unZip\"] Unzip all zip file inside a folder\n\n[\"File\"][\"createZip\"] Create a zip\n\n[\"File\"][\"zip\"] Zip a file\n\n[\"File\"][\"writeAllText\"] Write a Text through getXObject\n\n[\"File\"][\"readAllBytes\"] Read a binary file through getXObjext\n\n[\"File\"][\"writeAllBytes\"] Write all bytes\n\n[\"File\"][\"dumpDrives\"] Enumerate all the drives drives\n\n[\"File\"][\"dumpPath\"] Enumerate all the files inside a folder\n\n[\"File\"][\"spawn\"] Execute a new File (exe or script)\n\n[\"File\"][\"getPreview\"] Get a preview of an image File through a powershell script\n\n[\"FilePlugin\"] A constructor for FilePlugin\n\n[\"FilePlugin\"][\"receive\"] A listener of the commands of file. The commands are: “fi.dv” Send to the c2 the dumpfiles “fi.g” Send to the C2 the fo\nInvoke addRegistry command\n\n[\"InfoPlugin\"] A constructor for InfoPlugin command\n\n[\"InfoPlugin\"][\"receive\"] A listener of the unique command “in.g”, where the malware sends to the C2 a long series of information about the vic\n\n[\"JavaInstall\"] A constructor for JavaInstall command\n\n[\"JavaInstall\"][\"install\"] Install JRE by downloading it from the C2\n\n\n\n[\"JavaInstall\"]\n\n[\"unInstall\"]\n\n\nUninstall Java\n\n\n\n[\"JavaInstallPlugin\"] A constructor for JavaInstallPlugin\n\n\n\n[\"JavaInstallPlugin\"]\n\n[\"receive\"]\n\n\nA listener to install or check the installation of JRE through the commands “jv.i” and “jv.st”\n\n\n\n[\"MultiView\"] A constructor of Multiview module commands\n\n\n\n[\"MultiView\"]\n\n[\"getCaption\"]\n\n\nRetrieve a ForegroundWindows through a custom PowerShell script\n\n\n\n[\"MultiViewPlugin\"] A constructor for the MultiViewPlugin module commands\n\n\n\n[\"MultiViewPlugin\"]\n\n[\"Quality\"] = 0x64\n\n[\"MultiViewPlugin\"]\n\n[\"Scale\"] = 0xa\n\n[\"MultiViewPlugin\"]\n\n[\"receive\"]\n\n\nA variable indicating the quality of the foregound window\n\nA variable indicating the scaling of the foreground window\n\nA listener to the commands of MultiView Plugin which are: “mv.st”: set Quality and Scale “mv.s”: capture the screen th\n\n\n\n[\"Process\"] A constructor for Process module utility\n\n[\"Process\"][\"list\"] List all the active processes\n\n[\"Process\"][\"dump\"] Retrieve the following information from all\nprocesses: Caption CommandLine CreationClassName CreationDate CSCreationClassName CSName Description E\n\n[\"Process\"][\"taskkillId\"] Kill a process by ID through taskkill\n\n\n\n[\"Process\"]\n\n[\"taskkillName\"]\n\n[\"Process\"]\n\n[\"terminateId\"]\n\n[\"Process\"]\n\n[\"terminateName\"]\n\n\nKill a process by Name through taskkill\n\nKill a process by ID through Process Terminate\n\nKill a process by name through Process Terminate\n\n\n\n[\"Process\"][\"createWmi\"] Create a Wmi provider through WbemScripting.SWbemLocator\n\n\n\n[\"Process\"]\n\n[\"createProcess\"]\n\n\nCreate a process using \"winmgmts:{impersonationLevel=impersonate}!\\\\.\\root\\cimv2\"\n\n\n-----\n\n[\"Process\"]\n\n[\"getProcessByID\"]\n\n[\"Process\"]\n\n[\"getProcessByName\"]\n\n\nRetrieve a pointer to a process by ID\n\nRetrieve a pointer to a process by name\n\n\n\n[\"Process\"][\"currentPID\"] Retrieve the current ID\n\n\n\n[\"Process\"]\n\n[\"currentPIDPS\"]\n\n\nRetrieve the current ID through a PowerShell\n\n\n\n[\"ProcessPlugin\"] A constructor for ProcessPlugin module\n\n\n\n[\"ProcessPlugin\"]\n\n[\"receive\"]\n\n\nA listener for the following commands: “pr.g”: send to the C2 the result of the operation of Process dump “pr.kli”: Invok\n\n\n\n[\"ScreenPShell\"] A constructor for ScreenPShell module\n\n\n\n[\"ScreenPShell\"]\n\n[\"capture\"]\n\n[\"ScreenPShell\"]\n\n[\"pressKeyCode\"]\n\n[\"ScreenPShell\"]\n\n[\"pressKeyChar\"]\n\n[\"ScreenPShell\"]\n\n[\"sendkeys\"]\n\n[\"ScreenPShell\"]\n\n[\"leftDown\"]\n\n[\"ScreenPShell\"]\n\n[\"leftUp\"]\n\n[\"ScreenPShell\"]\n\n[\"leftClick\"]\n\n[\"ScreenPShell\"]\n\n[\"doubleClick\"]\n\n[\"ScreenPShell\"]\n\n[\"rightDown\"]\n\n[\"ScreenPShell\"]\n\n[\"rightUp\"]\n\n[\"ScreenPShell\"]\n\n[\"rightClick\"]\n\n[\"ScreenPShell\"]\n\n[\"mouseWheel\"]\n\n[\"ScreenPShell\"]\n\n[\"scrollUp\"]\n\n[\"ScreenPShell\"]\n\n[\"scrollDown\"]\n\n[\"ScreenPShell\"]\n\n[\"move\"]\n\n[\"ScreenPShell\"]\n\n[\"getAction\"]\n\n[\"ScreenPShell\"]\n\n[\"clickAction\"]\n\n\nGet a screenshot through a PowerShell script\n\nSimulate the pression of a keystroke\n\nSimulate the pression of a keystroke\n\nInvoke Wsh sendKeys\n\nSimulate the navigation\n\nSimulate the navigation\n\nSimulate the navigation\n\nSimulate the navigation\n\nSimulate the navigation\n\nSimulate the navigation\n\nSimulate the navigation\n\nSimulate the navigation\n\nSimulate the navigation\n\nSimulate the navigation\n\nSimulate the navigation\n\nSimulate the navigation\n\nSimulate the navigation\n\n\n\n[\"ScreenPShellPlugin\"] A constructor for ScreenPShellPlugin\n\n\n\n[\"ScreenPShellPlugin\"]\n\n[\"OldSize\"] = 0x0\n\n[\"ScreenPShellPlugin\"]\n\n[\"Quality\"] = 0xf\n\n\nA variable for OldSize property\n\nA variable for Quality property\n\n\n-----\n\n[\"ScreenPShellPlugin\"]\n\n[\"ScreenNumber\"] =\n-0x1\n\n[\"ScreenPShellPlugin\"]\n\n[\"CaptureMouse\"] = !![]\n\n[\"ScreenPShellPlugin\"]\n\n[\"receive\"]\n\n\nA variable for ScreenNumber property\n\nA variable for CaptureMouse property\n\nA listener for the ScreenPShell for the following commands: “sp.set”: invoke capture mouse “sp.g”: send to C2 the ca\n\n\n\n[\"Shell\"] = {} A constructor for Shell command module\n\n[\"Shell\"][\"codePage\"] Retrieve the codePage by reading the registry key \"HKLM\\SYSTEM\\CurrentControlSet\\Control\\Nls\\CodePage\\OEMC\n\n[\"Shell\"][\"run\"] Execute a command through Wsh\n\n[\"Shell\"][\"shellExecute\"] Execute a command through ShellExecute\n\n[\"Shell\"][\"getOutput\"] Read a log file of a shell command\n\n[\"ShellPlugin\"] A constructor for ShellPlugin\n\n[\"ShellPlugin\"][\"receive\"] A listener for ShellPlugin for the following command: “cn.e”: send to the C2 the get getOutput\n\n[\"Shortcut\"] A constructor for Shortcut command\n\n[\"Shortcut\"][\"create\"] Create a Shortcut\n\n[\"Shortcut\"][\"dump\"] Extract the information of a shortcut\n\n[\"Shortcut\"][\"getTarget\"] Retrieve the Target of a Shortcut\n\n[\"Shortcut\"][\"run\"] Execute a shortcut file\n\n[\"ShortcutPlugin\"] A constructor for Shortcut plugin\n\n\n\n[\"ShortcutPlugin\"]\n\n[\"receive\"]\n\n\nA listener for ShortcutPlugin excuting the following command: \"sh.g\": send to the C2 the info retrieved from Shortcut D\n\n\nTable 3: Interpreted Commands list\n\n## The Initialization\n\nAt this point, we talk about the initialization of the malware. Inspecting the code after the decoding routine we noticed a simple if-else check to\ndecide how to execute the malicious code.\n\nThe code structure is essential but provides confirmation about the preferred initial vectors to deliver the malicious implant. The Javascript\nmalware is designed to be interpreted by the \"WScript.exe\" windows interpreter and through the \"MSHTA\" utility, a widely abused LoLBins\n(T1218).\n\nFigure 7: Init routine\n\n## Conclusion\n\nThe JsOutProx malware is an example of how threat actor abuses high-level scripting language to realize fully functional implants, easily\nevading traditional signature-based detection tools that are typically good at spotting binaries, not text.\n\nThe implant is increasing its sophisticated for three reasons: the obfuscation is becoming increasingly intense and can avoid the initial\ndetection, the newer versions dropped the in-memory .NET modules and adopted a proxy process plugin architecture to enhance the survival\nof the main infection routine, also, the introduction of the “view-only mode” represents a notable change in the flexibility of this malicious tool\nthat could be also configured to have the lowest footprint possible while keeping eyes on the victim’s desktop.\n\nSilent attacks such as this one are hard to spot with traditional security. Yoroi protects its customers from this threat leveraging its proprietary\nautomated malware sandbox technology, Yomi sandbox, to analyze and detect any sign of infection, even the weakest.\n\n## Indicators of Compromise\n\n\n-----\n\nas\n\nC2:\n\n\n65987f95b365501579431ea8dec1d45940430d8c9defad58908a14e6fb96a347\n\ndilideanter.]zapto.]org\nhxxp://dilideanter.]zapto.]org[:7272/\n\n\n## Yara Rules\n```\nrule JsOutProx_v2 { \nmeta: \n   description = \"Yara Rule for JsOutProx_v2\" \n   author = \"Yoroi Malware Zlab\" \n   last_updated = \"2021_07_29\" \n   tlp = \"white\" \n   category = \"informational\" \nstrings: \n  $s1= /uA\\[[a-zA-Z]/ ascii wide\n  $s2= /u[A-Z]\\(/ ascii wide\ncondition: \n  #s1>800 and #s2>4000 and (filesize > 1500KB)\n}\n\n```\n_This blog post was authored by Luigi Martire and Luca Mella of Yoroi Malware ZLAB._\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-08-31 - Financial Institutions in the Sight of New JsOutProx Attack Waves.pdf"
    ],
    "report_names": [
        "2021-08-31 - Financial Institutions in the Sight of New JsOutProx Attack Waves.pdf"
    ],
    "threat_actors": [
        {
            "id": "99d9dd87-91c3-4371-9943-0a1c9c3cd99c",
            "created_at": "2022-10-25T16:07:23.277763Z",
            "updated_at": "2025-03-27T02:02:09.714081Z",
            "deleted_at": null,
            "main_name": "Solar Spider",
            "aliases": [],
            "source_name": "ETDA:Solar Spider",
            "tools": [],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "aa73cd6a-868c-4ae4-a5b2-7cb2c5ad1e9d",
            "created_at": "2022-10-25T16:07:24.139848Z",
            "updated_at": "2025-03-27T02:02:10.120505Z",
            "deleted_at": null,
            "main_name": "Safe",
            "aliases": [],
            "source_name": "ETDA:Safe",
            "tools": [
                "DebugView",
                "LZ77",
                "OpenDoc",
                "SafeDisk",
                "TypeConfig",
                "UPXShell",
                "UsbDoc",
                "UsbExe"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "e227b757-7032-4a99-b119-1bfda2ebd543",
            "created_at": "2023-01-06T13:46:39.21663Z",
            "updated_at": "2025-03-27T02:00:03.023067Z",
            "deleted_at": null,
            "main_name": "SOLAR SPIDER",
            "aliases": [],
            "source_name": "MISPGALAXY:SOLAR SPIDER",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673535678,
    "ts_updated_at": 1743041389,
    "ts_creation_date": 1653752651,
    "ts_modification_date": 1653752651,
    "files": {
        "pdf": "https://archive.orkl.eu/90ce7cff7f6269905736253773c5d5eb3132d5a3.pdf",
        "text": "https://archive.orkl.eu/90ce7cff7f6269905736253773c5d5eb3132d5a3.txt",
        "img": "https://archive.orkl.eu/90ce7cff7f6269905736253773c5d5eb3132d5a3.jpg"
    }
}