{
    "id": "c2ecb624-6522-4df2-8d9f-27cc5f1ea7f8",
    "created_at": "2023-01-12T15:07:05.596794Z",
    "updated_at": "2025-03-27T02:16:26.456429Z",
    "deleted_at": null,
    "sha1_hash": "4698c4001889e9170121716b945c6dc242cf85a4",
    "title": "2022-05-13 - Teabot",
    "authors": "",
    "file_creation_date": "2022-05-28T19:00:00Z",
    "file_modification_date": "2022-05-28T19:00:00Z",
    "file_size": 1825373,
    "plain_text": "# Play Store App Serves Teabot Via GitHub\n\n**[labs.k7computing.com/index.php/play-store-app-serves-teabot-via-github/](https://labs.k7computing.com/index.php/play-store-app-serves-teabot-via-github/)**\n\nBy Baran S May 13, 2022\n\n[We at K7 Labs recently came across this twitter post aboutTeabot (aka ‘Anatsa’) a banking](https://twitter.com/ThreatFabric/status/1522175714409209856)\n**Trojan. The main infection vector of Teabot was found on the official Google Play Store**\nwhere it posed as QR Code & BarCode Scanner app with 10,000+ downloads as shown in\nFigure 1.\n\n\n-----\n\nFigure 1: QR Code & BarCode Scanner from Google Play Store\nOnce launched, this app requests the user to update itself via a popup message as shown in\nFigure 2.\n\n\n-----\n\nFigure 2: Update message popup\nWhen the user clicks on the “Update” message this application downloads and installs the\nmalicious Teabot Banking Trojan “main.apk” as shown in Figure 2.\n\nFrom the ADB Logcat report we noticed that the malware file “main.apk” gets downloaded from\na GitHub repository as shown in Figure 3.\n\nFigure 3: ADB Logcat shows malware sample download URL\nFigure 4 shows the repository was created by mattiebryan4570, at the time of writing this blog\nthe GitHub repository was still live.\n\n\n-----\n\nFigure 4: GitHub repository where the malware sample was hosted\nIn this blog, we will be analyzing the package “com.joy.slab” corresponding to the main.apk\nwhich has been downloaded from the above mentioned GitHub repository as shown in Figure\n5.\n\nFigure 5: Malicious APK downloaded\n\nfrom GitHub\nOnce the Teabot malware is installed on the device, the app downloads itself as a QR-Code\n**Scanner: Add-On which frequently brings up the Accessibility Service setting option on the**\ndevice, as shown in Figure 6, until the user allows this app to have the Accessibility Service\nenabled.\n\n\n-----\n\nFigure 6: Request for accessibility service\nOnce the permissions are granted, this malicious apk decrypts the malicious payload file called\neepHM.json from the app’s assets folder to an executable dex format named ‘eepHM.odex’\nand loads the decrypted file as shown in Figure 7.\n\nFigure 7: The logcat image shows the eepHM.odex file execution at runtime\nThe trojan then attempts to intercept SMS messages and aborts the new SMSReceived\nbroadcast to the victim; as per the bot command “logged_sms” as shown in Figure 8.\n\n\n-----\n\nFigure 8: Intercept SMS messages\nAfter abusing the Android Accessibility Service, this trojan acts as a keylogger to steal the\nvictim’s keystroke information from the device.\n\nFigure 9: Keylogger functionality\n\n### C2 Communication\n\nTeabot enumerates the list of installed applications on the victim’s device and then sends this\nlist to the C2 server during its first communication. All the communications between C2 and the\nmalware remain encrypted using an XOR key as shown in Figure 10. When one or more\ntargeted apps are found, the C2 server sends the specific payload(s) to the victim’s device to\nperform an overlay attack and track all the activity related to the identified targeted\napplication(s).\n\n\n-----\n\nFigure 10: List of installed apps sent encrypted by the malware and the decrypted data\nThe following are the targeted applications in a typical victim’s device\n\n\n-----\n\nFigure 11 : Targeted\n\napplications\nThis malware also terminates a predefined list of apps’ process(es), as shown in Figure 12.\nInterestingly, that list includes a few popular security products as highlighted below, in order to\nremain undetected.\n\n\n-----\n\nFigure 12: Apps list terminated\n\nFigure 13:\n\n\n-----\n\nSecurity related apps list\nAt K7, we protect all our customers from such threats. Do ensure that you protect your mobile\ndevices with a reputable security product like K7 Mobile Security and scan your devices with it.\nAlso keep your security product and devices updated and patched for the latest vulnerabilities\nto stay safe from such threats.\n\n## Indicators of Compromise (IoCs)\n\n**Package Name** **Hash** **K7**\n**Detection**\n**Name**\n\ncom.zynksoftware.docuscanapp 13DF6443BF24D0E49566735B93F22646 TrojanDownloader\n(\n0058d95d1\n)\n\ncom.joy.slab 04F4FB5E6CB95DFF7CCEE97B1F7D3636 Trojan (\n0053b5f91\n)\n\n### C2\n\nhxxp://62[.]182[.]81[.]71/api/\n\nhxxp://185[.]215[.]113[.]31:83/api\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-05-13 - Teabot.pdf"
    ],
    "report_names": [
        "2022-05-13 - Teabot.pdf"
    ],
    "threat_actors": [
        {
            "id": "aa73cd6a-868c-4ae4-a5b2-7cb2c5ad1e9d",
            "created_at": "2022-10-25T16:07:24.139848Z",
            "updated_at": "2025-03-27T02:02:10.120505Z",
            "deleted_at": null,
            "main_name": "Safe",
            "aliases": [],
            "source_name": "ETDA:Safe",
            "tools": [
                "DebugView",
                "LZ77",
                "OpenDoc",
                "SafeDisk",
                "TypeConfig",
                "UPXShell",
                "UsbDoc",
                "UsbExe"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "75108fc1-7f6a-450e-b024-10284f3f62bb",
            "created_at": "2024-11-01T02:00:52.756877Z",
            "updated_at": "2025-03-27T02:00:55.544216Z",
            "deleted_at": null,
            "main_name": "Play",
            "aliases": null,
            "source_name": "MITRE:Play",
            "tools": [
                "Nltest",
                "AdFind",
                "PsExec",
                "Wevtutil",
                "Cobalt Strike",
                "Playcrypt",
                "Mimikatz"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1673536025,
    "ts_updated_at": 1743041786,
    "ts_creation_date": 1653764400,
    "ts_modification_date": 1653764400,
    "files": {
        "pdf": "https://archive.orkl.eu/4698c4001889e9170121716b945c6dc242cf85a4.pdf",
        "text": "https://archive.orkl.eu/4698c4001889e9170121716b945c6dc242cf85a4.txt",
        "img": "https://archive.orkl.eu/4698c4001889e9170121716b945c6dc242cf85a4.jpg"
    }
}