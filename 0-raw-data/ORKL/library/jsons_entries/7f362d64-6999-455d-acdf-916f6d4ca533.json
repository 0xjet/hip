{
    "id": "7f362d64-6999-455d-acdf-916f6d4ca533",
    "created_at": "2023-01-12T15:05:06.554575Z",
    "updated_at": "2025-03-27T02:16:26.534161Z",
    "deleted_at": null,
    "sha1_hash": "4ce3bdfc76df9dcafac4ef2202bc1d8f26a25546",
    "title": "2020-08-18 - New Attack Alert- Duri",
    "authors": "",
    "file_creation_date": "2022-05-28T21:36:37Z",
    "file_modification_date": "2022-05-28T21:36:37Z",
    "file_size": 809391,
    "plain_text": "# New HTML Smuggling Attack Alert: Duri\n\n**menlosecurity.com/blog/new-attack-alert-duri**\n\nAugust 18, 2020\n\n## HTML smuggling campaign is stopped by the Menlo Security Cloud Platform\n\nMenlo Security has been closely monitoring an attack we are naming “Duri.” Duri leverages\nHTML smuggling to deliver malicious files to users’ endpoints by evading network security\nsolutions such as sandboxes and legacy proxies. Isolation prevents this attack from infecting\nthe endpoint. Here’s what we know.\n\n## What Is HTML Smuggling ?\n\nThe goal of HTML smuggling is to make use of HTML5/JavaScript features to deliver file\ndownloads, and it usually comes in two flavors:\n\n[Deliver the download via Data URLs on the client device.](https://developer.mozilla.org/en-US/docs/Web/HTTP/Basics_of_HTTP/Data_URIs)\n[Create a Javascript blob with the appropriate MIME-type that results in a download on](https://developer.mozilla.org/en-US/docs/Web/API/Blob)\nthe client device.\n\nIn this specific attack, we observed the JavaScript blob technique being used to smuggle\nmalicious files via the browser to the user’s endpoint. Constructing content on the client\n[browser like this evades network security solutions such as sandboxes and](https://www.menlosecurity.com/blog/sandboxes-are-vulnerable-but-not-obsolete.-can-a-secure-web-gateway-with-internet-isolation-save-the-day) [proxies.](https://www.menlosecurity.com/blog/global-cloud-proxies-are-essential-to-the-future-of-remote-work)\n\n## What is Duri?\n\n\n-----\n\nAccording to our observations, the Duri campaign started in the beginning of July and is\ncurrently active. Earlier this month, we identified a user’s visit to a website and subsequent\nfile download, which was blocked because it was suspicious. Upon investigation, we\ndiscovered that the file was downloaded through HTML smuggling.\n\nTraditional network security solutions such as proxies, firewalls, and sandboxes rely on the\ntransfer of objects over the wire. For example, a sandbox might extract file objects such as\n.exe, .zip, and other suspicious objects from the wire and then send them to the sandbox for\ndetonation. With Duri, the entire payload is constructed on the client side (browser), so no\nobjects are transferred over the wire for the sandbox to inspect.\n\n## What tactics does Duri use?\n\nThe malware that Duri downloads is not new. According to [Cisco, it has previously been](https://umbrella.cisco.com/blog/navigating-cybersecurity-during-a-pandemic-latest-malware-and-threat-actors)\ndelivered via Dropbox, but the attackers have now displaced Dropbox with other cloud\nhosting providers and have blended in the HTML smuggling technique to infect endpoints.\nWe speculate that this change in tactic is being used to increase the success rate of\ncompromised endpoints.\n\n**Landing Page**\n\nOnce the user clicks on the link, there are multiple levels of redirection before the user lands\non an HTML page hosted on duckdns[.]org. The landing page invokes a JavaScript onload\nthat initializes data for a blob object from a base64 encoded variable as shown below.\n\n\n-----\n\nAs seen above, a ZIP file is dynamically constructed from the blob object with MIME type as\noctet/stream and is downloaded to the endpoint. The user still needs to open the ZIP file and\nexecute it.\n\n**Malicious MSI Dropper**\n\n[The ZIP archive contains an MSI file [T1218.007]. The .msi file extension indicates that the](https://attack.mitre.org/techniques/T1218/007/)\nfile is a Microsoft Windows installer and contains the application and all of its dependencies.\n\n_unzip PUVG OKZAGE SBKZXONA ETRWDDQGBL .zip_\n\n_Archive: PUVG OKZAGE SBKZXONA ETRWDDQGBL .zip_\n\n_inflating: PUVG OKZAGE SBKZXONA ETRWDDQGBL (869261) .msi_\n\nfile PUVG OKZAGE SBKZXONA ETRWDDQGBL (869261) .msi\n\nPUVG OKZAGE SBKZXONA ETRWDDQGBL (869261) .msi: Composite Document File V2\nDocument, Little Endian, Os: Windows.\n\nExamining the MSI file shows that there is an execute script code action defined in the\ncustom action of the MSI contents:\n\n**Microsoft JSCRIPT Analysis**\n\n\n-----\n\nThe embedded JSCRIPT is obfuscated, and it performs the following actions upon invoke:\n\nFetches a ZIP file from a remote location:\nhxxp://104[.]214[.]115[.]159/mod/input20[.]jpg\n\nThe extension in the URL is .jpg, but it is a ZIP file.\n\nThe ZIP file is downloaded to the Public Documents folder and two files are extracted\nfrom the ZIP archive: Avira.exe and rundll.exe.\nThe Avira.exe file is renamed to a randomly named EXE file. The rundll.exe file is\nrenamed to a randomly named file with a .bmp extension.\nA LNK file gets created in the %appdata% (roaming) folder, and the target of the LNK\n[file is set to a randomly renamed Avira.exe file [T1547.009].](https://attack.mitre.org/techniques/T1547/009/)\n[It achieves persistence by creating an autorun key for the above LNK file [T1547.001].](https://attack.mitre.org/techniques/T1547/001/)\n[The final command that gets run is [T1059.001]:](https://attack.mitre.org/techniques/T1059/001/)\n_powershell.exe cd;cd ‘C:UsersJohn SmithAppDataRoamingMicrosoftWindowsStart_\n_MenuProgramsStartup’;Start-Sleep -s 60;Start-Process ‘YOUXQNWXME.lnk’_\n\nThe extracted Avira.exe file was a signed ~500MB file from Avira, which was\npresent with a rundll.exe, and there was no evidence of process injection or sideloading techniques observed that could be used to further analyze and examine\nthe behavior.\n\n## How does Menlo Security get visibility into Duri?\n\n\n-----\n\nWhile traditional security solutions rely on a detect-and-respond approach to cybersecurity,\nMenlo enables a Zero Trust approach by forcing a block-or-isolate decision at the point of\nclick. All content is fetched and executed in a remote browser and is cut off from the\nendpoint, while only safe mirrored content reaches the user’s device. This prevents malware\nfrom accessing the endpoint.\n\nCampaigns like Duri, in which JavaScript is used to programmatically and dynamically\ngenerate the malicious payload, cannot evade the Menlo platform. Downloading files via\nMenlo is a two-step process. Every file download in the isolated browser triggers a unique\n[event on our platform—whether it’s because of a DataURL, a JavaScript](https://developer.mozilla.org/en-US/docs/Web/HTTP/Basics_of_HTTP/Data_URIs) [blob download, or a](https://developer.mozilla.org/en-US/docs/Web/API/Blob)\nlink. As a result, the Menlo platform enables enhanced visibility into the contents of every file.\n\nAttackers are constantly tweaking their tactics in an effort to evade and bypass security\nsolutions—forcing tools that rely on a detect-and-respond approach to always play catch-up.\nWe believe HTML smuggling is one such technique that will be incorporated into the\nattackers’ arsenal and used more often to deliver the payload to the endpoint without\nnetwork solutions blocking it. Menlo’s isolation approach prevents all content from reaching\nthe endpoint—effectively blocking all malware without impacting the native user experience.\nIt’s security without compromise.\n\n## Appendix\n\n**References:**\n\n[https://developer.mozilla.org/en-US/docs/Web/HTTP/Basics_of_HTTP/Data_URIs](https://developer.mozilla.org/en-US/docs/Web/HTTP/Basics_of_HTTP/Data_URIs)\n[https://developer.mozilla.org/en-US/docs/Web/API/Blob](https://developer.mozilla.org/en-US/docs/Web/API/Blob)\nhttps://umbrella.cisco.com/blog/navigating-cybersecurity-during-a-pandemic-latestmalware-and-threat-actors\nhttps://blog.trendmicro.com/trendlabs-security-intelligence/analysis-abuse-of-custom[actions-in-windows-installer-msi-to-run-malicious-javascript-vbscript-and-powershell-](https://blog.trendmicro.com/trendlabs-security-intelligence/analysis-abuse-of-custom-actions-in-windows-installer-msi-to-run-malicious-javascript-vbscript-and-powershell-scripts/)\nscripts/\n\n**IOC—URLs**\n\n_hxxp://huzirh.com/hidrol/_\n\n_hxxp://isocamprh.com.br/_\n\n_hxxp://hxxp.plasticospr.com/webmailgrupo?_\n_nzn11t6c68b5k40ry31c903ez3xaq/formulario_correios_37.pdf_\n\n_hxxp://gmpbusdoor.com/_\n\n_hxxp://hxxp.isocamprh.com.br/incolajes_\n\n\n-----\n\n_hxxp://iboxrh.com/consultoriarh?1e0wq712tctv0232v000lnjsn4c7a/boleto.3673.pdf_\n\n_hxxp://www.isocamprh.com.br/incolajes_\n\n_hxxp://hxxp.isocamprh.com.br/incolajes/_\n\n_hxxp://isocamprh.com.br/incolajes?page=boletos&idBoleto=8868_\n\n_hxxp://hxxp.westermarh.com/waycompany?WhatsApp_Historico_de_Conversas?_\n_whatsapphistorico/index.html?visualizar=c06e8cf10aeaf00c33360d2b2bfb6792_\n\n_hxxp://hxxp.grentrepostorh.com/_\n\n_hxxp://update-completo.com/_\n\n_hxxp://plasticospr.com/webmailgrupo?_\n_fotoswhatsapps/Imagem.htmldigitaloceanspaces.com/Fotos.html_\n\n_hxxp://ultrafarmarh.com/transglobal?WhatsApp_Historico_de_Conversas?_\n_whatsapphistorico/index.html?visualizar=c06e8cf10aeaf00c33360d2b2bfb6792_\n\n_hxxp://hidrolrh.com/_\n\n_hxxp://hxxp.casadaembalagemriopreto.com/officeclean?_\n_NZN11T6C68B5K40RY31C903EZ3XAQ/Formulario_Correios_37.pdf_\n\n_hxxp://www.fjpconstrucoes.com/predilecta_\n\n_hxxp://grentrepostorh.com/webmailgrupo?page=boletos&amp;idBoleto=8868_\n\n_hxxp://casadaembalagemriopreto.com/officeclean?_\n_PU106006743Z5QP2SL6RC00CT2330/Boletim_Registrado38361526.pdf_\n\n_hxxp://grjseguros.com/_\n\n_hxxp://hxxp.huzirh.com/hidrol?page=boletos&amp;idBoleto=8868_\n\n_hxxp://usinasalgado.com/contabilidadecnt_\n\n_hxxp://westermarh.com/_\n\n_hxxp://www.fjpconstrucoes.com/predilecta_\n\n_hxxp://fjpconstrucoes.com/_\n\n_hxxp://www.graphiczonerh.com/mobile?WhatsApp_Historico_de_Conversas?_\n_whatsapphistorico/index.html?visualizar=c06e8cf10aeaf00c33360d2b2bfb6792_\n\n\n-----\n\n_hxxp://www.westermarh.com/waycompany?WhatsApp_Historico_de_Conversas?_\n_whatsapphistorico/index.html?visualizar=c06e8cf10aeaf00c33360d2b2bfb6792_\n\n_hxxp://www.iboxrh.com/_\n\n_hxxp://westermarh.com/waycompany?WhatsApp_Historico_de_Conversas?_\n_whatsapphistorico/index.html?visualizar=c06e8cf10aeaf00c33360d2b2bfb6792_\n\n_hxxp://hxxp.grjseguros.com/_\n\n_hxxp://grentrepostorh.com/_\n\n_hxxp://hxxp.continentalnetrh.com/tbvc?get-facebook-verified/get-facebook-verified.html_\n\n_hxxp://hxxp.westermarh.com/waycompany_\n\n_hxxp://hxxp.fachiniengenharia.com/predilecta_\n\n_hxxp://gmpbusdoor.com/furnax_\n\n_hxxp://hxxp.plasticospr.com/webmailgrupo?_\n_NZN11T6C68B5K40RY31C903EZ3XAQ/Formulario_Correios_37.pdf_\n\n_hxxp://hxxp.update-completo.com/consultrh?page=boletos_\n\n_hxxp://www.grentrepostorh.com/webmailgrupo_\n\n_hxxp://www.fjpconstrucoes.com/_\n\n_hxxp://hxxp.fachiniengenharia.com/predilecta?_\n_NZN11T6C68B5K40RY31C903EZ3XAQ/Formulario_Correios_37.pdf_\n\n_hxxp://fjpconstrucoes.com/predilecta_\n\n_hxxp://www.versatilsegurosrh.com/vbimport?_\n_woa/rest/Faturamento/v1/faturadigital/visualizar?data-vencimento_\n\n_hxxp://fjpconstrucoes.com/predilecta_\n\n_hxxp://www.laboratrh.com/contabilidadecnt?page=boletos&idBoleto=8868_\n\n_hxxp://fachiniengenharia.com/predilecta_\n\n_hxxp://hxxp.hidrolrh.com/heimatschutz_\n\n_hxxp://fjpconstrucoes.com/predilecta?page=boletos&idBoleto=8868_\n\n_hxxps://iboxrh.com/_\n\n\n-----\n\n_hxxp://fachiniengenharia.com/predilecta?page=boletos&idBoleto=8868_\n\n_hxxp://grjseguros.com/grjseguros?_\n_PU106006743Z5QP2SL6RC00CT2330/Boletim_Registrado38361526.pdf_\n\n_hxxp://continentalnetrh.com/tbvc?get-facebook-verified/get-facebook-verified.html_\n\n_hxxp://grentrepostorh.com/webmailgrupo_\n\n_hxxp://isocamprh.com.br/incolajes?page=boletos&amp_\n\n_hxxp://hxxp.westermarh.com/_\n\n_hxxp://fachiniengenharia.com/predilecta?page=boletos&idBoleto=8868_\n\n_hxxp://hidrolrh.com/heimatschutz_\n\n_hxxp://bustvch.com/_\n\n_hxxp://hxxp.grentrepostorh.com/webmailgrupo?_\n_PU106006743Z5QP2SL6RC00CT2330/Boletim_Registrado38361526.pdf_\n\n_hxxp://isocamprh.com.br/incolajes?page=boletos&amp;idBoleto=8868_\n\n_hxxp://fjpconstrucoes.com/predilecta?page=boletos&amp;idBoleto=8868_\n\n_hxxp://casadaembalagemriopreto.com/_\n\n_hxxp://hxxp.bustvch.com/_\n\n_hxxp://iboxrh.com/_\n\n_hxxp://hxxp.fjpconstrucoes.com/predilecta?_\n_PU106006743Z5QP2SL6RC00CT2330/Boletim_Registrado38361526.pdf_\n\n_hxxp://www.continentalnetrh.com/tbvc?WhatsApp_Historico_de_Conversas?_\n_whatsapphistorico/index.html?visualizar=c06e8cf10aeaf00c33360d2b2bfb6792_\n\n_hxxp://bustvch.com/adinoxrs_\n\n_hxxp://hxxp.ultrafarmarh.com/transglobal?WhatsApp_Historico_de_Conversas?_\n_whatsapphistorico/index.html?visualizar=c06e8cf10aeaf00c33360d2b2bfb6792_\n\n_hxxp://hxxp.update-completo.com/consultrh?page=boletos&idBoleto=8868_\n\n_hxxp://hxxp.casadaembalagemriopreto.com/_\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2020/2020-08-18 - New Attack Alert- Duri.pdf"
    ],
    "report_names": [
        "2020-08-18 - New Attack Alert- Duri.pdf"
    ],
    "threat_actors": [
        {
            "id": "610a7295-3139-4f34-8cec-b3da40add480",
            "created_at": "2023-01-06T13:46:38.608142Z",
            "updated_at": "2025-03-27T02:00:02.87217Z",
            "deleted_at": null,
            "main_name": "Cobalt",
            "aliases": [
                "Cobalt Gang",
                "GOLD KINGSWOOD",
                "COBALT SPIDER",
                "G0080",
                "Mule Libra",
                "Cobalt Group"
            ],
            "source_name": "MISPGALAXY:Cobalt",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "aa73cd6a-868c-4ae4-a5b2-7cb2c5ad1e9d",
            "created_at": "2022-10-25T16:07:24.139848Z",
            "updated_at": "2025-03-27T02:02:10.120505Z",
            "deleted_at": null,
            "main_name": "Safe",
            "aliases": [],
            "source_name": "ETDA:Safe",
            "tools": [
                "DebugView",
                "LZ77",
                "OpenDoc",
                "SafeDisk",
                "TypeConfig",
                "UPXShell",
                "UsbDoc",
                "UsbExe"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "75108fc1-7f6a-450e-b024-10284f3f62bb",
            "created_at": "2024-11-01T02:00:52.756877Z",
            "updated_at": "2025-03-27T02:00:55.544216Z",
            "deleted_at": null,
            "main_name": "Play",
            "aliases": null,
            "source_name": "MITRE:Play",
            "tools": [
                "Nltest",
                "AdFind",
                "PsExec",
                "Wevtutil",
                "Cobalt Strike",
                "Playcrypt",
                "Mimikatz"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1673535906,
    "ts_updated_at": 1743041786,
    "ts_creation_date": 1653773797,
    "ts_modification_date": 1653773797,
    "files": {
        "pdf": "https://archive.orkl.eu/4ce3bdfc76df9dcafac4ef2202bc1d8f26a25546.pdf",
        "text": "https://archive.orkl.eu/4ce3bdfc76df9dcafac4ef2202bc1d8f26a25546.txt",
        "img": "https://archive.orkl.eu/4ce3bdfc76df9dcafac4ef2202bc1d8f26a25546.jpg"
    }
}