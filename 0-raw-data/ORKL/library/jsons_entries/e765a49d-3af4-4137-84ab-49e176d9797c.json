{
    "id": "e765a49d-3af4-4137-84ab-49e176d9797c",
    "created_at": "2023-01-12T15:08:06.569115Z",
    "updated_at": "2025-03-27T02:09:29.394294Z",
    "deleted_at": null,
    "sha1_hash": "65c51c3109968baf565fc6c527c0ef726e655677",
    "title": "2017-05-12 - Warning- Massive -WannaCry- Ransomware campaign launched",
    "authors": "",
    "file_creation_date": "2022-05-27T23:13:30Z",
    "file_modification_date": "2022-05-27T23:13:30Z",
    "file_size": 105847,
    "plain_text": "# Warning: Massive \"WannaCry\" Ransomware campaign launched\n\n**[blog.gdatasoftware.com/2017/05/29751-wannacry-ransomware-campaign](https://blog.gdatasoftware.com/2017/05/29751-wannacry-ransomware-campaign)**\n\nAn outbreak of the latest version of \"WannaCry\" has been claiming victims in several countries. The\nspeed and ferocity of the outbreak has taken many by surprise. Researchers are as yet puzzled as to the\norigin of the outbreak which hit 11 countries within just three hours. So far Spain and Russia were are\namong those who were hit hardest.\n\n## Like a bolt from the blue\n\nIn the early morning hours (CET) of Friday, May 12, a sizeable wave of infections with the latest iteration\nof the WCry / WannaCry ransomware was spotted. Researchers are not sure where the sudden\nonslaught came from, but suspicions currently include bot nets, exploit kits, infected emails or malicious\nadvertizing (also called malvertizing). In Spain, Telef√≥nica, a major ISP, was hit with an infection on one\nof their internal servers. From there, things escalated to a point where IT staff are reaching out to\nemployees to shut down their computers immediately. They were also asked to cut any VPN connections\nin order to stop the ransomware from ravaging more parts of the company's network. According to\n[Spanish newspaper El Mundo, some utility companies had their networks affected in a similar fashion.](http://www.elmundo.es/tecnologia/2017/05/12/59158a8ce5fdea194f8b4616.html)\nAccording one data source, Russia has reported the highest number of infections.\n\nSo far the extent of the damage is unknown.\n\n## Implications\n\nThe unfolding events make it abundantly clear that ransomware is a problem for companies of all sizes.\n\nSince utilities and telecommunications are considered \"essential and critical infrastructure\", adequate\nmeasures must be take to secure those.\n\n## Countermeasures\n\nVirus signatures should be updated immediately.\n\nG DATA customers are protected. The WannaCry ransomware is detected by all of G DATA's solutions as\n**_Win32.Trojan-Ransom.WannaCry.A._**\n\nSince the vulnerability was addressed in the March update for Windows, updates should be installed as\nsoon as possible. In addition to this, Microsoft has also released a mitigation patch for some legacy\nversions of Windows which should also be applied immediately.\n\n## File-based IOCs\n\n**EXE files**\n\n\"ed01ebfbc9eb5bbea545af4d01bf5f1071661840480439c6e5babe8e080e41aa\"\n\n\"09a46b3e1be080745a6d8d88d6b5bd351b1c7586ae0dc94d0c238ee36421cafa\" [Win32.TrojanRansom.WannaCry.A]\n\n\"ed01ebfbc9eb5bbea545af4d01bf5f1071661840480439c6e5babe8e080e41aa\" [Win32.TrojanRansom.WannaCry.A\n\n\n-----\n\n] 2584e1521065e45ec3c17767c065429038fc6291c091097ea8b22c8a502c41dd [Win32.TrojanRansom.WannaCry.A]\n\"24d004a104d4d54034dbcffc2a4b19a11f39008a575aa614ea04703480b1022c\" [Win32.TrojanRansom.WannaCry.D]\n\"4186675cb6706f9d51167fb0f14cd3f8fcfb0065093f62b10a15f7d9a6c8d982\" [Win32.TrojanRansom.WannaCry.D]\n\"6bf1839a7e72a92a2bb18fbedf1873e4892b00ea4b122e48ae80fac5048db1a7\" [Win32.TrojanRansom.WannaCry.D]\n\"b3c39aeb14425f137b5bd0fd7654f1d6a45c0e8518ef7e209ad63d8dc6d0bac7\" [Win32.TrojanRansom.WannaCry.D]\n\"b9c5d4339809e0ad9a00d4d3dd26fdf44a32819a54abf846bb9b560d81391c25 [Win32.TrojanRansom.WannaCry.E]\n\n**DLL:**\n\"CYBER1be0b96d502c268cb40da97a16952d89674a9329cb60bac81a96e01cf7356830.E1E\" [Win32.TrojanRansom.WannaCry.F]\n\n**WannaCry Batch component:**\n\"f01b7f52e3cb64f01ddc248eb6ae871775ef7cb4297eba5d230d0345af9a5077\" [BAT.TrojanRansom.WannaCry.C]\n**WannaCry VBS-component:**\n\"51432d3196d9b78bdc9867a77d601caffd4adaa66dcac944a5ba0b3112bbea3b\" [Script.TrojanRansom.WannaCry.B]\n\n**WannaCry Shortcut:**\n\"a3b014598d6313c96ab511dc56028ef36f8bafde7f592a1329238718e1c29813\" [Win32.TrojanRansom.WannaCryLnk.A]\n\n**File extension:**\n\n.wncry\nRansom note: @Please_Read_Me@.txt\n\n[https://twitter.com/malwrhunterteam/](https://twitter.com/malwrhunterteam/)\n\n## Network-based IoCs\n\nThe \"genuine\" WannaCry dropper attempts to contact the following web address:\n\nhxxp[:]//www[.]iuqerfsodp9ifjaposdfjhgosurijfaewrwergwea.com\n\nThis is the original \"killswitch\" domain.\n\n[Preview image credit: MalwareHunter](https://twitter.com/malwrhunterteam/)\n\n## Update: May 12, 8:10 pm: more organizations hit\n\nAs of this time, reports started pouring in about the victims who are affected by the ransomware wildfire:\n\n[Private businesses in Spain and Portugal are hit with WannaCry](https://www.publico.pt/2017/05/12/tecnologia/noticia/ataque-informatico-internacional-afecta-empresas-e-hospitais-1771939)\n\n\n-----\n\n[Some computer labs also suffer from the ransomware s ability to spread rapidly through a network](https://twitter.com/dodicin/status/862991818904002565)\n\n[One source reports that computers at the Russian Ministry of Internal Affairs are infected](http://varlamov.ru/2370148.html)\n\nAccording to a [statement from the British NHS, some of their organizations in the UK are affected](https://digital.nhs.uk/article/1491/Statement-on-reported-NHS-cyber-attack)\n\n## Update: May 12, 8:20 pm: WannaCry uses a leaked NSA exploit to infect machines - how to mitigate\n\nIt seems that the mechanism used by WannaCry is based on exploit code originally developed by the\nNSA. The Exploit is called ETERNALBLUE and was part of a series of files which were leaked last\nmonth.\n\nThe [security flaw in SMB which made the exploit possible (also referenced in the NVD) and which was](https://technet.microsoft.com/en-us/library/security/ms17-010.aspx?f=255&MSPPError=-2147217396)\nrated \"critical\" has been patched by Microsoft during March patch day.\n\n**G DATA strongly recommends to install all Windows updates or implement the workaround**\n**suggested by Microsoft as soon as possible.**\n\n## Update: May 12, 11:20 pm\n\nIOC list updated & Detection names added\n\n## Update: May 13, 7:30 am: train timetable displays in Germany infected, NHS declares \"major incident\"\n\n[First WannaCry infections were reported in the timetable displays of various train stations in](https://twitter.com/Avas_Marco/status/863107445559889921)\n[Germany. The infection wave has spread across several hospitals in the UK, forcing staff to use paper-](http://www.telegraph.co.uk/news/2017/05/12/nhs-hit-major-cyber-attack-hackers-demanding-ransom/)\nbased fallbacks to maintain a basic service level. The NHS declared this a \"major incident\". Doctors are\njoining in with warnings that the WannaCry infections may cost lives.\n\n## Update: May 13, 9:15 am - Microsoft releases a mitigation patch for Windows XP, Windows 8, Server 2003 to address vulnerability\n\nGiven that there is still a large number of Windows XP installations out there (including those in critical\nplaces), Microsoft has made an unusual move and issued an update for Windows XP, Windows 8 and\nWindows Server 2003.\n\n## Update: May 15, 8:30 am: Accidental hero throws a wrench in WannaCry's works\n\nA security researcher had begun analyzing WannaCry as soon as it hit the ground. During his\nexaminations he found out that WannaCry attempts to contact a specific domain. The domain was not\nregistered at the time, so he took it on himself to do so in order to find out what WannaCry wanted to chat\nabout. This is a common procedure in security research.\n\nIt later turned out that the domain was in effect a \"killswitch\" for WannaCry. The principle is rather simple:\nWannaCry contacts the domain and waits for a reply. If a reply comes back, it shuts off and does not\ninfect the system. Initially, the researcher was not aware of the fact that this killswitch existed, so the fact\n\n\n-----\n\nthat this discovery helped slow down the infection wave significantly was a happy accident - many news\nportals refer to him as \"The accidental hero of WannaCry\".\n\nThis is good news of course: new infections are stopped in their tracks. There are two major caveats\nabout this, though: the killswitch only works on machines which were not previously infected. It cannot\n\"clean\" an infected system and it will not bring back encrypted files. Also, the killswitch domain will not\nwork if the to-be-infected machines are located behing a proxy server.\n\nStill, the slowdown allowed security staff to breathe a sigh of relief, albeit a cautious one.\n\n## Update: May 15, 8:50 am: \"Brace for impact\"\n\nAs mentioned previosly, the full extent of the infection wave may only become apparent this Monday\nmorning when workers return to their offices. Therefore users should pay really close attention to any\nmessages they see on screen and alert their IT department immediately as soon as a ransom note\nappears on screen.\n\nIt is also goes without saying that email attachments should be treated with utmost caution, especially if\nthey were received after Thursday, May 11.\n\n## Update: May 16, 3:00 pm: Some things are not adding up - Copycats give researchers trouble - Attribution attempts\n\nAlthough many researchers are warning that \"this is not over yet\", there are some things that strike us as\nodd around WannaCry. First and foremost, the intention of any ransomware campaign is to rake in\nas much money as possible in the shortet amount of time. With the infection count at over 200,000 and\ncounting, one would expect the attackers' Bitcoin wallets almost bursting at the seams. However, only\nthree BTC wallets have been identified so far and they only have a meager 60.000 dollars to show\nbetween them. Even if we calculate this in a very conservative manner and assume that about 2,5% of\nthe victims actually pay up, we should still at least be looking at seven-figures in Bitcoins. That does not\nseem to be the case, though, which opens up room for speculations.\n\nThere are several possibilities as to why there does not seem to be any money transferred. For instance,\nthe people behind the ransomware attack may not have anticipated that their creation would be so wildly\nsuccessful and were just overwhelmed by the infection rates - triggering decryption in WannaCry's case is\na manual process which on this scale requires a lot of resources.\n\nTo make life even more difficult, there are large numbers of \"copycat\" version circulating. After many\npeople had gotten their hands on a sample, they started experimenting with it. In some cases, they\ndisabled the killswitch domain, in other cases its URL is changed. Some of the versions would not even\nwork as other modifications were made in the file. Those modifications often \"break\" a file and make it\nunusable for infecting a machine. At the time of this writing, several hundred modified versions of the file\nhave been counted by G DATA and were also added to our detection database.\n\nAs with any man-made event that causes great damage, the question of \"who done it?\" inevitably comes\nup. This case is no different. Some researchers point out that some routines of the malware bear\ncharacterisitics that were seen in attacks by an APT group called Lazarus. At this point we cannot rule out\nthis possibility, but neither can we confim it.\n\n## Update: May 17 9:45 am: Copycats vs Duplicates\n\n\n-----\n\nAs mentioned in our previosu update, numerous updates of the WannaCry files are in circulation at this\ntime. We need to distinguish several categories here:\n\nVariations of the original file with the killswitch removed\n\nVariations with a modified killswitch domain\n\nVariations without ransomware components; those are able to spread without performing any\nmalicious activities on a system.\n\n\"Real\" copycats which imitate the ransom note of Wannacry, but do not have any connection to\nWannaCry on the technical side.\n\n**Correction:**\n\nContrary to what was mentioned in the previous update, the decryption components do not need to be\ncreated manually as they are part of the malware already. However, the decryption process must still be\ntriggered manually by the attackers.\n\n## Update: 17.05., 10:00 Uhr - IoC list updated\n\nKillswitch domain added under \"Network-based IoCs\"\n\n## Update: May 18, 12:30 pm: parking garages in Germany hit with WannaCry - distribution method still unclear\n\nAccording to current reports, the payment systems in some German parking garages are affected by the\nWannaCry infection wave. The company that rund the parking garages has not issued a statement about\nhow much money was lost due to the outage, but this example show very clearly what a direct effect a\nransomware infection can have on everyday operations. This development is problematic for another\nreason: should the outage continue for longer, traffic jams may develop because it is now impossible to\nkeep track of how much parking space (if any) is left in the garage. This would cause drivers to attempt\nentering a (full) parking garage.\n\nThe exact mehtod used by WannaCry to spread this rapidly is still unclear. However, at this point it seems\nunlikely that email attachments were used as a vessel. As previously reported, WannaCry uses a security\nflaw in the fil and folder sharing protocol of Microsoft Windows. This akes it possible to distribute the\nmalware over the internet as the protocol is usually not filtered out by ISPs. This makes an infection more\nlikely if a system is connected directly to the internet with this feature enabled. Note, though, that this is\nalso based on conjecture, but for a definitive answer, more information is needed.\n\n## Update: May 18,12:30 pm: Makers of WannaCry are speaking up\n\n\n-----\n\nSome victims are seeing this message\nwhich supposedly comes from the\nattackers.\n\nThe message some victims of WannaCry are starting to see\n\nright now (Image credit: Twitter / Thijs Bosschert)\n[As we have learned about an hour ago, some victims of the WannaCry infection are getting messages on](https://twitter.com/ThiceNL/status/865133662387527681)\ntheir screens which appear to come from the attackers. The message asks victims to send the attackers\ntheir unique Bitcoin ID one hour prior to making the payment to speed up the process of receiving their\ndecryption key.\n\nThis is the first time since the infection wave has started that the attackers seem to speak up. We had\nalready suspected that they may have been overwhelmed by their own success and had difficulties\ncoping with it.\n\nWhat is still unclear, though, is where the ransom payment are supposed to go - up to now, only three\nBTC wallets have been identified that were associated with the attackers.\n\n**We still strongly discourage making any ransom payments.**\n\n## Update: June 8, 12:00 pm: WannaCry is still no blunt axe\n\nReports from the Health & Human Services department clearly show that despite its famed kill switch the\ndanger from WannaCry is not over. Since machines in several hospitals are still affected, HHS\nexperts [advise affected organizations to rebuild (or reimage) affected systems and to install the latest](http://www.healthcareitnews.com/news/us-health-systems-knocked-out-wannacry-hhs-says-take-these-steps-keep-your-facility-safe)\nupdates as quickly as possible. Even though the kill switch prevents WannaCry's ransomware module to\nkick in and encrypt files, the worm part of WannaCry is not affected by this - WannaCry remains on the\nlookout for vulnerable machines.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2017/2017-05-12 - Warning- Massive -WannaCry- Ransomware campaign launched.pdf"
    ],
    "report_names": [
        "2017-05-12 - Warning- Massive -WannaCry- Ransomware campaign launched.pdf"
    ],
    "threat_actors": [
        {
            "id": "aa73cd6a-868c-4ae4-a5b2-7cb2c5ad1e9d",
            "created_at": "2022-10-25T16:07:24.139848Z",
            "updated_at": "2025-03-27T02:02:10.120505Z",
            "deleted_at": null,
            "main_name": "Safe",
            "aliases": [],
            "source_name": "ETDA:Safe",
            "tools": [
                "DebugView",
                "LZ77",
                "OpenDoc",
                "SafeDisk",
                "TypeConfig",
                "UPXShell",
                "UsbDoc",
                "UsbExe"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673536086,
    "ts_updated_at": 1743041369,
    "ts_creation_date": 1653693210,
    "ts_modification_date": 1653693210,
    "files": {
        "pdf": "https://archive.orkl.eu/65c51c3109968baf565fc6c527c0ef726e655677.pdf",
        "text": "https://archive.orkl.eu/65c51c3109968baf565fc6c527c0ef726e655677.txt",
        "img": "https://archive.orkl.eu/65c51c3109968baf565fc6c527c0ef726e655677.jpg"
    }
}