{
    "id": "5c270e7d-a29c-4f44-a64e-c93cd9161fea",
    "created_at": "2022-10-25T16:48:17.312861Z",
    "updated_at": "2025-03-27T02:16:25.653445Z",
    "deleted_at": null,
    "sha1_hash": "555840514267ef3183af84b886b7e25da4bd41aa",
    "title": "",
    "authors": "",
    "file_creation_date": "2020-07-16T03:27:45Z",
    "file_modification_date": "2020-07-16T03:27:45Z",
    "file_size": 924512,
    "plain_text": "# Welcome Chat as a secure messaging app? Nothing could be further from the truth\n\n**[welivesecurity.com/2020/07/14/welcome-chat-secure-messaging-app-nothing-further-truth](https://www.welivesecurity.com/2020/07/14/welcome-chat-secure-messaging-app-nothing-further-truth/)**\n\nJuly 14, 2020\n\nWe discovered a new operation within a long-running cyber-espionage campaign in the\nMiddle East. Targeting Android users via the malicious Welcome Chat app, the operation\n[appears to have links to the malware named BadPatch, which MITRE links to the Gaza](https://attack.mitre.org/software/S0337/)\n[Hackers threat actor group known also as Molerats.](https://malpedia.caad.fkie.fraunhofer.de/actor/molerats)\n\nOur analysis shows that the Welcome Chat app allows spying upon its victims. However,\nit is not simple spyware. Welcome Chat is a functioning chat app that delivers the\npromised functionality along with its hidden espionage capacity.\n\nWe found this spyware being advertised to chat-hungry users (these apps are banned in\nsome countries in the Middle East region) on a dedicated website (see Figure 1). The fact\nthat the website is in Arabic conforms with the targeting of the whole campaign we\n[believe this operation belongs to. The domain was registered in October 2019; we](https://www.whois.com/whois/ephoneservices.club)\ncouldn’t, however, determine when the website was launched.\n\n_Figure 1. The website of the malicious Welcome Chat app_\n\n\n-----\n\nThe malicious website promotes the Welcome Chat app, claiming it’s a secure chat\nplatform that is available on the Google Play store. Both claims are false. In regard to the\n“secure” claim, nothing is further from the truth. Not only is Welcome Chat an espionage\ntool; on top of that, its operators left the data harvested from their victims freely available\non the internet. And the app was never available on the official Android app store.\n\n_Figure 2. Despite the caption stating “High quality, secure and available on Google Play”, the button_\n\n_leads to the installation file being downloaded directly from the malicious website_\n\n## Functionality/Analysis\n\nOnce the user downloads the app, it needs the setting “Allow installing apps from\nunknown sources” to be activated since the app was not downloaded from the Play Store.\n\nAfter installation, the malicious app will request the victim to allow permissions such as\nsend and view SMS messages, access files, record audio, and access contacts and device\nlocation. Such an extensive list of intrusive permissions might normally make the victims\nsuspicious – but with a messaging app, it’s natural they are needed for the app to deliver\nthe promised functionality.\n\n\n-----\n\n_Figure 3. Permission requests by Welcome Chat spyware_\n\nIn order to be able to communicate with other users of this app, the user needs to register\nand create a personal account (see Figure 4).\n\n\n-----\n\n_Figure 4. The Sign up/Login dialog of the Welcome Chat app_\n\nImmediately after receiving these permissions, Welcome Chat sends information about\nthe device to its C&C and is ready to receive commands. It is designed to contact the C&C\nserver every five minutes.\n\nOn top of its core espionage functionality – monitoring the chat communications of its\nusers – the Welcome Chat app can perform the following malicious actions: exfiltrating\nsent and received SMS messages, call log history, contact list, user photos, recorded\nphone calls, the GPS location of the device, and device info.\n\n## Trojanized or attacker-developed chat app?\n\n\n-----\n\nAn interesting question arises with functional trojan apps: is the app an attackertrojanized version of a clean app, or did the attackers develop a malicious app from\nscratch?\n\nIn both cases, it is easy for the attackers to spy on exchanged in-app messages as they\nwould – naturally – have the authorization keys to the user database.\n\nDespite the first option being typical for trojanized apps, we believe that in this particular\ncase, the second explanation is more probable.\n\nTypically, trojanized apps are created via a process of appending the malicious\nfunctionality to a legitimate app. The bad guys find and download a suitable app. After\ndecompiling it, they add the malicious functionality and recompile the now-maliciousyet-still-functioning app to spread it among their desired audience.\n\nThere is a major question mark with this option: to this day, we have not been able to\ndiscover any clean version of the Welcome Chat app. Not only can it not be found on any\nof the Android markets we have on our radar; based on the binary matching algorithms in\nour sample classification systems, we haven’t found any clean app with this same chat\nfunctionality. Of interest in this regard is that a clean version of Welcome Chat, without\nthe espionage functionality, was uploaded to VirusTotal in mid-February 2020 (hash:\n757bd41d5fa99e19200cee59a3fd1577741ccd82). The malicious version was first\nsubmitted to VirusTotal a week earlier.\n\nThis leads us to believe that the attackers developed the malicious chat app on their own.\nCreating a chat app for Android is not difficult; there are many detailed tutorials on the\ninternet. With this approach, the attackers have better control over the compatibility of\nthe app’s malicious functionality with its legitimate functions, so they can ensure that the\nchat app will work.\n\n## Code analysis\n\nThe Welcome Chat espionage app seems to have targeted Arabic-speaking users: both the\ndefault website language and default in-app language are Arabic. However, based on\ndebug logs left in the code, strings, class and unique variable names, we were able to\ndetermine that most of the malicious code was copied from publicly available open source\ncode projects and code example snippets available on public forums.\n\n\n-----\n\n_Figure 5. The developer used different pieces of open source code to create the malicious app_\n\nIn some cases, the copied open source code is quite old – see Table 1. As a possible\nexplanation, all the listed examples come at the very top among the results of simple\ngoogling for the respective functionalities.\n\n\n-----\n\n_Table 1. The origins of the malicious code_\n\n**Functionality** **Source** **Age (years)**\n\nCall recording [open source, GitHub](https://github.com/hunterli/callrec/tree/master/src/com/cn6000/callrec) 8\n\nSMS stealing [open source, GitHub](https://github.com/tuenti/SmsRadar/tree/master/library/src/main/java/com/tuenti/smsradar) 6\n\nGoogle Maps coordinates [open source, Blogspot (plus other sources)](https://msql-php.blogspot.com/2015/11/google-map-v3-get-city-state-zipcode.html) 5\n\nGEO tracking [open source, GitHub](https://github.com/Artsu/GeoTrack/tree/master/src/fi/jyu/ties425/geotrack/util) 8\n\nGPS tracking [open source, GitHub](https://gist.github.com/ertugrulozcan/70973144b1c582618a6c) 5\n\n## User data leak\n\nThe Welcome Chat app, including its infrastructure, was not built with security in mind.\nThe app uploads all of the user’s stolen data to the attacker-controlled server via\nunsecured HTTP.\n\nTransmitted data is not encrypted and because of that, not only it is available to the\nattacker, it is freely accessible to anyone on the same network.\n\nThe database contains data such as name, email, phone number, device token, profile\npicture, messages and friends list – in fact, all the users’ data except for the account\npasswords can be found uploaded to the unsecured server.\n\n_Figure 6. The victim’s device uploads the user data to the app’s server_\n\n\n-----\n\n_Figure 7. User database leak_\n\n_Figure 8. Leaked user info_\n\n_Figure 9. An example of an in-app message being freely accessible on the app’s unsecured server_\n\nOnce we discovered the sensitive information as being publicly accessible, we intensified\nour efforts to discover the developer of the legitimate chat app (i.e., the app the espionage\ntool was – eventually – a trojanized version of) to disclose the vulnerability to them. We\n\n\n-----\n\nfound neither the developer nor the app, convincing us that the app was built from the\nbeginning as malicious. Naturally, we made no effort to reach out to the malicious actors\nbehind the app.\n\n## Possible BadPatch connection\n\nThe Welcome Chat espionage app belongs to the very same Android malware family that\nwe identified at the beginning of 2018. That malware used the same C&C server,\npal4u.net, as the espionage campaign targeting the Middle East that was identified in late\n[2017 by Palo Alto Networks and named BadPatch. In late 2019, Fortinet described yet](https://www.fortinet.com/blog/threat-research/badpatch-campaign-uses-python-malware.html)\nanother espionage operation focused on Palestinian targets with the domain pal4u.net\namong its indicators of compromise.\n\nFor these reasons we believe that this campaign with new Android trojans comes from the\nthreat actors behind the long-term BadPatch campaign.\n\n## Recommendation\n\nWhile the Welcome Chat-based espionage operation seems to be narrowly targeted, we\nstrongly recommend that users don’t install any apps from outside the official Google Play\nstore – unless it’s a trusted source such as a website of an established security vendor or\nsome reputable financial institution. On top of that, users should pay attention to what\npermissions their apps require and be suspicious of any apps that require permissions\nbeyond their functionality – and, as a very basic security measure, run a reputable\nsecurity app on their mobile devices.\n\n## Indicators of Compromise (IoCs)\n\n**Hash** **ESET detection name**\n\nC60D7134B05B34AF08023155EAB3B38CEDE4BCCD Android/Spy.Agent.ALY\n\nC755D37D6692C650692F4C637AE83EF6BB9577FC Android/Spy.Agent.ALY\n\n89AB73D4AAF41CBCDBD0C8C7D6D85D21D93ED199 Android/Spy.Agent.ALY\n\n2905F2F60D57FBF13D25828EF635CA1CCE81E757 Android/Spy.Agent.ALY\n\n**C&C: emobileservices.club**\n\n## MITRE ATT&CK techniques\n\n**Tactic** **ID** **Name** **Description**\n\n\n-----\n\n**Tactic** **ID** **Name** **Description**\n\n\nInitial\nAccess\n\nPersistence\n\nDiscovery\n\nCollection\n\nCommand\nand\nControl\n\n\n[T1444](https://attack.mitre.org/techniques/T1444/) Masquerade\nas Legitimate\nApplication\n\n[T1402](https://attack.mitre.org/techniques/T1402/) App AutoStart at Device Boot\n\n[T1426](https://attack.mitre.org/techniques/T1426/) System Information\nDiscovery\n\n[T1412](https://attack.mitre.org/techniques/T1412/) Capture\nSMS\nMessages\n\n[T1430](https://attack.mitre.org/techniques/T1430/) Location\nTracking\n\n[T1433](https://attack.mitre.org/techniques/T1433/) Access Call\nLog\n\n[T1432](https://attack.mitre.org/techniques/T1432/) Access Contact List\n\n[T1429](https://attack.mitre.org/techniques/T1429/) Capture\nAudio\n\n[T1533](https://attack.mitre.org/techniques/T1533/) Data from\nLocal\nSystem\n\n[T1437](https://attack.mitre.org/techniques/T1437/) Standard\nApplication\nLayer\nProtocol\n\n\nWelcome Chat impersonates a legitimate chat\napplication.\n\nWelcome Chat listens for the BOOT_COMPLETED\nbroadcast, ensuring that the app's functionality will\nbe activated every time the device starts.\n\nWelcome Chat collects information about the device.\n\nWelcome Chat exfiltrates sent and received SMS\nmessages.\n\nWelcome Chat spies on the device's location.\n\nWelcome Chat exfiltrates call log history.\n\nWelcome Chat exfiltrates the user contact list.\n\nWelcome Chat records surrounding audio.\n\nWelcome Chat steals user photos stored on device.\n\nWelcome Chat uploads exfiltrated data using the\nHTTP protocol.\n\n\n[Lukas Stefanko](https://www.welivesecurity.com/author/lstefanko/)\n14 Jul 2020 - 11:30AM\n\n### Newsletter\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        }
    ],
    "references": [
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2020/2020.07.14_Molerats_Middle_East_APT/Welcome%20Chat%20as%20a%20secure%20messaging%20app_%20Nothing%20could%20be%20further%20from%20the%20truth%20_%20WeLiveSecurity.pdf"
    ],
    "report_names": [
        "Welcome Chat as a secure messaging app_ Nothing could be further from the truth _ WeLiveSecurity"
    ],
    "threat_actors": [
        {
            "id": "1162e0d4-b69c-423d-a4da-f3080d1d2b0c",
            "created_at": "2023-01-06T13:46:38.508262Z",
            "updated_at": "2025-03-27T02:00:02.851407Z",
            "deleted_at": null,
            "main_name": "Molerats",
            "aliases": [
                "Gaza Hackers Team",
                "Gaza cybergang",
                "Gaza Cybergang",
                "Operation Molerats",
                "Extreme Jackal",
                "ALUMINUM SARATOGA",
                "G0021",
                "BLACKSTEM"
            ],
            "source_name": "MISPGALAXY:Molerats",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "0c502f6d-640d-4e69-bfb8-328ba6540d4f",
            "created_at": "2022-10-25T15:50:23.756782Z",
            "updated_at": "2025-03-27T02:00:55.539397Z",
            "deleted_at": null,
            "main_name": "Molerats",
            "aliases": [
                "Molerats",
                "Operation Molerats",
                "Gaza Cybergang"
            ],
            "source_name": "MITRE:Molerats",
            "tools": [
                "MoleNet",
                "DustySky",
                "DropBook",
                "SharpStage",
                "PoisonIvy"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "847f600c-cf90-44c0-8b39-fb0d5adfcef4",
            "created_at": "2022-10-25T16:07:23.875541Z",
            "updated_at": "2025-03-27T02:02:10.005591Z",
            "deleted_at": null,
            "main_name": "Molerats",
            "aliases": [
                "ATK 89",
                "Aluminum Saratoga",
                "Extreme Jackal",
                "Gaza Cybergang",
                "Gaza Hackers Team",
                "Molerats",
                "Operation DustySky",
                "Operation DustySky Part 2",
                "Operation Molerats",
                "Operation Moonlight",
                "Operation SneakyPastes",
                "Operation TopHat",
                "TA402",
                "TAG-CT5"
            ],
            "source_name": "ETDA:Molerats",
            "tools": [
                "BadPatch",
                "Bladabindi",
                "BrittleBush",
                "Chymine",
                "CinaRAT",
                "Darkmoon",
                "Downeks",
                "DropBook",
                "DustySky",
                "ExtRat",
                "Gen:Trojan.Heur.PT",
                "H-Worm",
                "H-Worm RAT",
                "Houdini",
                "Houdini RAT",
                "Hworm",
                "Iniduoh",
                "IronWind",
                "Jenxcus",
                "JhoneRAT",
                "Jorik",
                "KasperAgent",
                "Kognito",
                "LastConn",
                "Micropsia",
                "MoleNet",
                "Molerat Loader",
                "NeD Worm",
                "NimbleMamba",
                "Njw0rm",
                "Pierogi",
                "Poison Ivy",
                "Quasar RAT",
                "QuasarRAT",
                "SPIVY",
                "Scote",
                "SharpSploit",
                "SharpStage",
                "WSHRAT",
                "WelcomeChat",
                "Xtreme RAT",
                "XtremeRAT",
                "Yggdrasil",
                "dinihou",
                "dunihi",
                "njRAT",
                "pivy",
                "poisonivy"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "efe6ff9a-822d-41a6-90c3-45265cac696b",
            "created_at": "2024-05-01T02:03:07.920302Z",
            "updated_at": "2025-03-27T02:05:17.246342Z",
            "deleted_at": null,
            "main_name": "ALUMINUM SARATOGA",
            "aliases": [
                "Arid Viper",
                "Desert Falcon",
                "Extreme Jackal ",
                "Gaza CyberGang",
                "Gaza CyberGang",
                "Molerats ",
                "Operation DustySky ",
                "TA402",
                "APT-C-23"
            ],
            "source_name": "Secureworks:ALUMINUM SARATOGA",
            "tools": [
                " BrittleBush",
                " DarkComet",
                " LastConn",
                " Micropsia",
                " NimbleMamba",
                " PoisonIvy",
                " QuasarRAT",
                " XtremeRat",
                "BlackShades"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "75108fc1-7f6a-450e-b024-10284f3f62bb",
            "created_at": "2024-11-01T02:00:52.756877Z",
            "updated_at": "2025-03-27T02:00:55.544216Z",
            "deleted_at": null,
            "main_name": "Play",
            "aliases": null,
            "source_name": "MITRE:Play",
            "tools": [
                "Nltest",
                "AdFind",
                "PsExec",
                "Wevtutil",
                "Cobalt Strike",
                "Playcrypt",
                "Mimikatz"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1666716497,
    "ts_updated_at": 1743041785,
    "ts_creation_date": 1594870065,
    "ts_modification_date": 1594870065,
    "files": {
        "pdf": "https://archive.orkl.eu/555840514267ef3183af84b886b7e25da4bd41aa.pdf",
        "text": "https://archive.orkl.eu/555840514267ef3183af84b886b7e25da4bd41aa.txt",
        "img": "https://archive.orkl.eu/555840514267ef3183af84b886b7e25da4bd41aa.jpg"
    }
}