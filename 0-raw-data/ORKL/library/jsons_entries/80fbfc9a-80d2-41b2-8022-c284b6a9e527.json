{
    "id": "80fbfc9a-80d2-41b2-8022-c284b6a9e527",
    "created_at": "2022-10-25T16:48:13.328149Z",
    "updated_at": "2025-03-27T02:16:16.990922Z",
    "deleted_at": null,
    "sha1_hash": "49542f14b3ca6ec343864ac390278b879c443272",
    "title": "Operation ShadowHammer",
    "authors": "",
    "file_creation_date": "2019-03-26T02:05:14Z",
    "file_modification_date": "0001-01-01T00:00:00Z",
    "file_size": 177076,
    "plain_text": "# Operation ShadowHammer\n\n**securelist.com/operation-shadowhammer/89992**\n\nBy GReAT\n\n[Earlier today, Motherboard published a story by Kim Zetter on Operation ShadowHammer, a](https://motherboard.vice.com/en_us/article/pan9wn/hackers-hijacked-asus-software-updates-to-install-backdoors-on-thousands-of-computers)\nnewly discovered supply chain attack that leveraged ASUS Live Update software.\n\nWhile the investigation is still in progress and full results and technical paper will be published\n[during SAS 2019 conference in Singapore, we would like to share some important details about](https://sas.kaspersky.com/)\nthe attack.\n\nIn January 2019, we discovered a sophisticated supply chain attack involving the ASUS Live\n**Update Utility. The attack took place between June and November 2018 and according to our**\ntelemetry, it affected a large number of users.\n\nASUS Live Update is an utility that is pre-installed on most ASUS computers and is used to\nautomatically update certain components such as BIOS, UEFI, drivers and applications. According\n[to Gartner, ASUS is the world’s 5th-largest PC vendor by 2017 unit sales. This makes it an](https://en.wikipedia.org/wiki/Market_share_of_leading_PC_vendors)\nextremely attractive target for APT groups that might want to take advantage of their userbase.\n\nBased on our statistics, over 57,000 Kaspersky users have downloaded and installed the\n**backdoored version of ASUS Live Update at some point in time. We are not able to calculate**\nthe total count of affected users based only on our data; however, we estimate that the real scale\nof the problem is much bigger and is possibly affecting over a million users worldwide.\n\nThe goal of the attack was to surgically target an unknown pool of users, which were\n**identified by their network adapters’ MAC addresses. To achieve this, the attackers had**\nhardcoded a list of MAC addresses in the trojanized samples and this list was used to identify the\nactual intended targets of this massive operation. We were able to extract more than 600 unique\nMAC addresses from over 200 samples used in this attack. Of course, there might be other\nsamples out there with different MAC addresses in their list.\n\nWe believe this to be a very sophisticated supply chain attack, which matches or even surpasses\n[the Shadowpad and the CCleaner incidents in complexity and techniques. The reason that it](https://securelist.com/shadowpad-in-corporate-networks/81432/)\nstayed undetected for so long is partly due to the fact that the trojanized updaters were signed\nwith legitimate certificates (eg: “ASUSTeK Computer Inc.”). The malicious updaters were hosted on\nthe official liveupdate01s.asus[.]com and liveupdate01.asus[.]com ASUS update servers.\n\n\n-----\n\nDigital signature on a trojanized ASUS Live Update setup installer\n\nCertificate serial number: 05e6a0be5ac359c7ff11f4b467ab20fc\n\nWe have contacted ASUS and informed them about the attack on Jan 31, 2019, supporting their\ninvestigation with IOCs and descriptions of the malware.\n\nAlthough precise attribution is not available at the moment, certain evidence we have collected\nallows us to link this attack to the ShadowPad incident from 2017. The actor behind the\n[ShadowPad incident has been publicly identified by Microsoft in court documents as BARIUM.](https://www.courthousenews.com/wp-content/uploads/2017/11/barium.pdf)\nBARIUM is an APT actor known to be using the Winnti backdoor. Recently, our colleagues from\n[ESET wrote about another supply chain attack in which BARIUM was also involved, that we believe](https://www.welivesecurity.com/2019/03/11/gaming-industry-scope-attackers-asia/)\nis connected to this case as well.\n\nA victim distribution by country for the compromised ASUS Live Updater looks as follows:\n\n\n-----\n\nIt should be noted that the numbers are also highly influenced by the distribution of Kaspersky\nusers around the world. In principle, the distribution of victims should match the distribution of\nASUS users around the world.\n\nWe’ve also created a tool which can be run to determine if your computer has been one of the\nsurgically selected targets of this attack. To check this, it compares MAC addresses of all adapters\nto a list of predefined values hardcoded in the malware and alerts if a match was found.\n\n[Download an archive with the tool (.exe)](https://kas.pr/shadowhammer)\n\n## IOCs\n\nKaspersky Lab verdicts for the malware used in this and related attacks:\n\nHEUR:Trojan.Win32.ShadowHammer.gen\n\nDomains and IPs:\n\nasushotfix[.]com\n141.105.71[.]116\n\nSome of the URLs used to distribute the compromised packages:\n\nhxxp://liveupdate01.asus[.]com/pub/ASUS/nb/Apps_for_Win8/LiveUpdate/Liveupdate_Test_VER365.zip\nhxxps://liveupdate01s.asus[.]com/pub/ASUS/nb/Apps_for_Win8/LiveUpdate/Liveupdate_Test_VER362.zip\nhxxps://liveupdate01s.asus[.]com/pub/ASUS/nb/Apps_for_Win8/LiveUpdate/Liveupdate_Test_VER360.zip\nhxxps://liveupdate01s.asus[.]com/pub/ASUS/nb/Apps_for_Win8/LiveUpdate/Liveupdate_Test_VER359.zip\n\nHashes (Liveupdate_Test_VER365.zip):\n\naa15eb28292321b586c27d8401703494\n\n\n-----\n\n[service – contact intelreports@kaspersky.com](mailto:intelreports@kaspersky.com)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        },
        {
            "id": "4e039bf8-7239-4999-8ec0-eb202d1465af",
            "created_at": "2022-12-04T11:19:36.52593Z",
            "updated_at": "2022-12-04T11:19:36.52593Z",
            "deleted_at": null,
            "name": "ORKL",
            "url": "https://github.com/ORKL/library",
            "description": "ORKL Community Contributed Content",
            "reports": null
        }
    ],
    "references": [
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2019/2019.03.25.Operation_ShadowHammer/Operation%20ShadowHammer.pdf"
    ],
    "report_names": [
        "Operation ShadowHammer"
    ],
    "threat_actors": [
        {
            "id": "1c97ccfd-1888-492c-b7b9-bb52c4c3809b",
            "created_at": "2023-01-06T13:46:38.940529Z",
            "updated_at": "2025-03-27T02:00:02.957652Z",
            "deleted_at": null,
            "main_name": "Operation ShadowHammer",
            "aliases": [],
            "source_name": "MISPGALAXY:Operation ShadowHammer",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "49822165-5541-423d-8808-1c0a9448d588",
            "created_at": "2022-10-25T16:07:23.384093Z",
            "updated_at": "2025-03-27T02:02:09.772829Z",
            "deleted_at": null,
            "main_name": "Barium",
            "aliases": [
                "Brass Typhoon",
                "Pigfish"
            ],
            "source_name": "ETDA:Barium",
            "tools": [
                "Agent.dhwf",
                "Agentemis",
                "Barlaiy",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "Destroy RAT",
                "DestroyRAT",
                "Kaba",
                "Korplug",
                "POISONPLUG",
                "PlugX",
                "RbDoor",
                "RedDelta",
                "RibDoor",
                "Sogu",
                "TIGERPLUG",
                "TVT",
                "Thoper",
                "Winnti",
                "Xamtrav",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "4c68ccd0-caba-4189-9ead-86ac4c2d9b70",
            "created_at": "2024-05-01T02:03:07.930196Z",
            "updated_at": "2025-03-27T02:05:17.251237Z",
            "deleted_at": null,
            "main_name": "BRONZE ATLAS",
            "aliases": [
                "Axiom",
                "BARIUM ",
                "Blackfly ",
                "CTG-2633",
                "GREF",
                "Group 72 ",
                "Red Kelpie ",
                "TG-2633 ",
                "Wicked Panda ",
                "Winnti",
                "APT41 "
            ],
            "source_name": "Secureworks:BRONZE ATLAS",
            "tools": [
                " CCleaner v5.33 backdoor",
                " ChinaChopper",
                " Cobalt Strike",
                " Dicey MSDN",
                " ForkPlayground",
                " HUC Proxy Malware (Htran)",
                " Mimikatz",
                " PipeMon",
                " PlugX",
                " PortReuse",
                " Powershell Empire",
                " RCMD",
                " RbDoor",
                " SPEEDBOAT",
                " ShadowPad",
                " Sidewalk",
                " Speculoos",
                " TeamViewer",
                " Winnkit",
                " Winnti",
                " reg save",
                " vssadmin",
                "Acehash"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "c7d9878a-e691-4c6f-81ae-84fb115a1345",
            "created_at": "2022-10-25T16:07:23.359506Z",
            "updated_at": "2025-03-27T02:02:09.752427Z",
            "deleted_at": null,
            "main_name": "APT 41",
            "aliases": [
                "BrazenBamboo",
                "Bronze Atlas",
                "Double Dragon",
                "Earth Baku",
                "Grayfly",
                "Operation ColunmTK",
                "Operation CuckooBees",
                "Operation ShadowHammer",
                "Red Kelpie",
                "SparklingGoblin",
                "TA415",
                "TG-2633"
            ],
            "source_name": "ETDA:APT 41",
            "tools": [
                "9002 RAT",
                "ADORE.XSEC",
                "ASPXSpy",
                "ASPXTool",
                "AceHash",
                "Agent.dhwf",
                "Agentemis",
                "AndroidControl",
                "AngryRebel",
                "AntSword",
                "BIOPASS",
                "BIOPASS RAT",
                "BLUEBEAM",
                "Barlaiy",
                "BlackCoffee",
                "Bladabindi",
                "BleDoor",
                "CCleaner Backdoor",
                "CHINACHOPPER",
                "COLDJAVA",
                "China Chopper",
                "ChyNode",
                "Cobalt Strike",
                "CobaltStrike",
                "Crackshot",
                "CrossWalk",
                "CurveLast",
                "CurveLoad",
                "DAYJOB",
                "DBoxAgent",
                "DEADEYE",
                "DEADEYE.APPEND",
                "DEADEYE.EMBED",
                "DEPLOYLOG",
                "DIRTCLEANER",
                "DUSTTRAP",
                "Derusbi",
                "Destroy RAT",
                "DestroyRAT",
                "DodgeBox",
                "DragonEgg",
                "ELFSHELF",
                "EasyNight",
                "Farfli",
                "FunnySwitch",
                "Gh0st RAT",
                "Ghost RAT",
                "HDD Rootkit",
                "HDRoot",
                "HKDOOR",
                "HOMEUNIX",
                "HUI Loader",
                "HidraQ",
                "HighNoon",
                "HighNote",
                "Homux",
                "Hydraq",
                "Jorik",
                "Jumpall",
                "KEYPLUG",
                "Kaba",
                "Korplug",
                "LATELUNCH",
                "LOLBAS",
                "LOLBins",
                "LightSpy",
                "Living off the Land",
                "Lowkey",
                "McRAT",
                "MdmBot",
                "MessageTap",
                "Meterpreter",
                "Mimikatz",
                "MoonBounce",
                "MoonWalk",
                "Motnug",
                "Moudour",
                "Mydoor",
                "NTDSDump",
                "PACMAN",
                "PCRat",
                "PINEGROVE",
                "PNGRAT",
                "POISONPLUG",
                "POISONPLUG.SHADOW",
                "POTROAST",
                "PRIVATELOG",
                "PipeMon",
                "PlugX",
                "PortReuse",
                "ProxIP",
                "ROCKBOOT",
                "RbDoor",
                "RedDelta",
                "RedXOR",
                "RibDoor",
                "Roarur",
                "RouterGod",
                "SAGEHIRE",
                "SPARKLOG",
                "SQLULDR2",
                "STASHLOG",
                "SWEETCANDLE",
                "ScrambleCross",
                "Sensocode",
                "SerialVlogger",
                "ShadowHammer",
                "ShadowPad Winnti",
                "SinoChopper",
                "Skip-2.0",
                "SneakCross",
                "Sogu",
                "Speculoos",
                "Spyder",
                "StealthReacher",
                "StealthVector",
                "TERA",
                "TIDYELF",
                "TIGERPLUG",
                "TOMMYGUN",
                "TVT",
                "Thoper",
                "Voldemort",
                "WIDETONE",
                "WINNKIT",
                "WINTERLOVE",
                "Winnti",
                "WyrmSpy",
                "X-Door",
                "XDOOR",
                "XMRig",
                "XShellGhost",
                "Xamtrav",
                "ZXShell",
                "ZoxPNG",
                "certutil",
                "certutil.exe",
                "cobeacon",
                "gresim",
                "njRAT",
                "pwdump",
                "xDll"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "4d5f939b-aea9-4a0e-8bff-003079a261ea",
            "created_at": "2023-01-06T13:46:39.04841Z",
            "updated_at": "2025-03-27T02:00:02.985296Z",
            "deleted_at": null,
            "main_name": "APT41",
            "aliases": [
                "G0096",
                "Grayfly",
                "BARIUM",
                "BRONZE ATLAS",
                "BRONZE EXPORT",
                "Red Kelpie",
                "HOODOO",
                "Brass Typhoon",
                "TA415",
                "WICKED SPIDER",
                "WICKED PANDA",
                "G0044",
                "Earth Baku"
            ],
            "source_name": "MISPGALAXY:APT41",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "e698860d-57e8-4780-b7c3-41e5a8314ec0",
            "created_at": "2022-10-25T15:50:23.287929Z",
            "updated_at": "2025-03-27T02:00:55.43005Z",
            "deleted_at": null,
            "main_name": "APT41",
            "aliases": [
                "APT41",
                "Wicked Panda",
                "Brass Typhoon",
                "BARIUM"
            ],
            "source_name": "MITRE:APT41",
            "tools": [
                "ASPXSpy",
                "BITSAdmin",
                "PlugX",
                "Impacket",
                "gh0st RAT",
                "netstat",
                "PowerSploit",
                "ZxShell",
                "KEYPLUG",
                "ipconfig",
                "sqlmap",
                "China Chopper",
                "ShadowPad",
                "MESSAGETAP",
                "Mimikatz",
                "certutil",
                "njRAT",
                "Cobalt Strike",
                "pwdump",
                "BLACKCOFFEE",
                "ROCKBOOT",
                "dsquery",
                "Winnti for Linux",
                "DUSTTRAP",
                "Derusbi",
                "ftp"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1666716493,
    "ts_updated_at": 1743041776,
    "ts_creation_date": 1553565914,
    "ts_modification_date": 0,
    "files": {
        "pdf": "https://archive.orkl.eu/49542f14b3ca6ec343864ac390278b879c443272.pdf",
        "text": "https://archive.orkl.eu/49542f14b3ca6ec343864ac390278b879c443272.txt",
        "img": "https://archive.orkl.eu/49542f14b3ca6ec343864ac390278b879c443272.jpg"
    }
}