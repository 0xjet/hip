{
    "id": "baf166c3-a709-4cd5-ac03-709051902948",
    "created_at": "2022-10-25T16:48:15.465928Z",
    "updated_at": "2025-03-27T02:17:11.810068Z",
    "deleted_at": null,
    "sha1_hash": "e3dce33708579e250f0a27f4d8e71e4a970888ec",
    "title": "McAfee Labs Quarterly Threat Report June 2017",
    "authors": "",
    "file_creation_date": "2017-06-01T17:01:17Z",
    "file_modification_date": "2018-01-22T12:38:55Z",
    "file_size": 13618791,
    "plain_text": "# McAfee Labs  Threats Report\n\n###### June 2017\n\n REPORT\n\n\n-----\n\n### There are hundreds, if not thousands, of anti- security, anti-sandbox, and anti-analyst evasion techniques employed by malware authors. Many can be purchased off the shelf.\n\n\n#### About McAfee Labs\n\nMcAfee Labs is one of the world’s leading sources for\nthreat research, threat intelligence, and cybersecurity\nthought leadership. With data from millions of sensors\nacross key threats vectors—file, web, message, and\nnetwork—McAfee Labs delivers real-time threat\nintelligence, critical analysis, and expert thinking to\nimprove protection and reduce risks.\n\nwww.mcafee.com/us/mcafee-labs.aspx\n\n[Follow McAfee Labs Blog](https://securingtomorrow.mcafee.com/mcafee-labs/)\n\n[Follow McAfee Labs Twitter](https://twitter.com/McAfee_Labs)\n\n\n#### Introduction\n\nWelcome to the new McAfee!\n\nOn April 3, McAfee became an independent entity, no\nlonger wholly owned by Intel. The spin-off, a culmination of\nmonths of effort to prepare critical functions and transition\nemployees to the new entity, is now known as McAfee\n[LLC. Intel remains a minority owner. Chris Young, who led](https://www.mcafee.com/us/about/management/christopher-young.aspx)\nMcAfee under the Intel umbrella, is the CEO of the new\n[McAfee. Read Young’s letter to our customers.](https://www.mcafee.com/us/about/ceo-letter.html)\n\n[In mid-February, we released the report Building Trust in](https://www.mcafee.com/us/solutions/lp/cloud-security-report.html)\n_[a Cloudy Sky: The State of Cloud Adoption and Security. The](https://www.mcafee.com/us/solutions/lp/cloud-security-report.html)_\nreport looks at cloud adoption, changes in data center\nenvironments, and the challenges with visibility and control\nover these new architectures. It is based on responses\nfrom 1,400 IT security professionals from around the\nglobe.\n\n[On March 1, we released the report Tilting the Playing](http://www.mcafee.com/misaligned)\n_[Field: How Misaligned Incentives Work Against Cybersecurity,](http://www.mcafee.com/misaligned)_\n[developed in partnership with the Center for Strategic](https://www.csis.org/)\n[and International Studies. It examines the mismatch](https://www.csis.org/)\nbetween the incentives of attackers and defenders. The\nreport identified three key incentive misalignments:\nbetween corporate structures and the free flow of criminal\nenterprises, between strategy and implementation, and\nbetween senior executives and those in implementation\nroles.\n\n\n-----\n\n[In response to the WikiLeaks Vault 7 disclosure on March](https://wikileaks.org/ciav7p1/)\n[7, McAfee developed a simple module for the CHIPSEC](https://wikileaks.org/ciav7p1/)\n[framework that can be used to verify the integrity of EFI](https://github.com/chipsec/chipsec)\nfirmware executables on potentially impacted systems.\nThis work is based on many years of dedicated research\nwithin the field of firmware security, conducted by\n[McAfee’s Advanced Threat Research group. CHIPSEC is a](https://www.mcafee.com/us/threat-center/advanced-threat-research/index.aspx)\nframework for analyzing the security of PC platforms that\nincludes hardware, system firmware (BIOS/UEFI), and\n[platform components. Read more about the module.](https://securingtomorrow.mcafee.com/business/chipsec-support-vault-7-disclosure-scanning/)\n\n[The No More Ransom initiative confirmed the addition](http://www.nomoreransom.org)\n[of new members and decryption tools in early April. The](https://www.scmagazineuk.com/no-more-ransom-gets-major-boost-with-new-members-new-decryption-tools/article/648269/)\ninitiative brings together technology companies and law\nenforcement agencies from around the world to educate\nthe public about ransomware and to provide easy access\nto decryption tools so that victims need not pay ransoms.\nMcAfee is a founding member of the No More Ransom\ninitiative; there are now 89 member companies and\nagencies.\n\nAlso in April, McAfee’s Strategic Intelligence researchers\n[released evidence that a series of cyberattacks targeting](https://securingtomorrow.mcafee.com/executive-perspectives/state-shamoon-actor-different-lines/)\nthe Persian Gulf and, specifically, Saudi Arabia between\n2012 and the present are the work of hacker groups\nsupported and coordinated by a common malicious\nactor, and not the random efforts of a variety of\nindividual cyber gangs in the region. The latest Shamoon\ncampaigns go beyond a few targets in the energy\nindustry, to many in other critical sectors that run Saudi\nArabia. Taken together, this new series of Shamoon cyber\nespionage campaigns is significantly larger, well-planned,\nwell-resourced, and coordinated at a level beyond the\nlimited capacity of disparate independent hacker gangs.\n\n[Finally, the Verizon 2017 Data Breach Investigations Report](http://www.verizonenterprise.com/verizon-insights-lab/dbir/2017/)\n(DBIR) was released in late April. McAfee coauthored a\nsection of the report in which we highlighted significant\nransomware technical enhancements in 2016 that have\ntransformed both the nature of the threat and ways in\nwhich the security industry is fighting back.\n\nShare this Report\n\n\nIn this quarterly threats report, we highlight three Key\nTopics:\n\n    - We broadly examine evasion techniques\nand how malware authors use them to\naccomplish their goals. We discuss the\nmore than 30-year history of evasion by\nmalware, the underground market for offthe-shelf evasion technology, how several\ncontemporary malware families leverage\nevasion techniques, and what to expect in\nthe future, including machine learning and\nhardware-based evasion.\n\n    - We explore the very interesting topic of\nsteganography in the digital world. Digital\nsteganography hides information in benignlooking objects such as images, audio tracks,\nvideo clips, or text files. Of course, attackers\nuse these techniques to pass information by\nsecurity systems. We explain how in this Key\nTopic.\n\n    - We examine Fareit, the most famous\npassword-stealing malware. We cover\nits origins, its typical infection vectors, its\narchitecture and inner workings, how it has\nchanged over the years, and how it was likely\nused in the breach of the Democratic National\nCommittee before the 2016 U.S. Presidential\nelection.\n\nThese Key Topics are followed by our usual in-depth set\nof quarterly threats statistics.\n\n\n-----\n\n###### And in other news…\n\n[NSS Labs, an independent, highly regarded](http://www.nsslabs.com/)\nsecurity product testing lab, recently completed its\ncomprehensive Advanced Endpoint Protection tests,\nin which they examined endpoint products from 13\nvendors. They tested the products against a barrage\nof advanced threats and evaluated them for overall\nsecurity effectiveness and total cost of ownership.\n[McAfee Endpoint Security (ENS) 10.5 achieved a security](https://www.mcafee.com/us/products/endpoint-protection/endpoint-security.aspx)\neffectiveness rating of 99% with zero false-positives\nand 100% of the tested evasions blocked. These results\nearned McAfee ENS an NSS Labs Recommended Rating\nfor Advanced Endpoint Protection. Compared with the\nother vendors, McAfee ENS did very well, earning the\nsecond highest security effectiveness rating.\n\nShare this Report\n\n\nEvery quarter, we discover new things from the telemetry\n[that flows into McAfee Global Threat Intelligence. The](https://www.mcafee.com/us/threat-center/technology/global-threat-intelligence-technology.aspx)\nMcAfee GTI cloud dashboard allows us to see and\nanalyze real-world attack patterns that lead to better\ncustomer protection. This information provides insight\ninto attack volumes that our customers experience. In\nQ1, our customers saw the following attack volumes:\n\n    - McAfee GTI received on average 55 billion\nqueries per day in Q1.\n\n    - McAfee GTI protections against malicious\nfiles decreased to 34 million in Q1 from 71\nmillion per day in Q4 due to earlier malware\ndetection and better local intelligence.\n\n    - McAfee GTI protections against potentially\nunwanted programs showed an increase to\n56 million per day in Q1 from 37 million per\nday in Q4.\n\n    - McAfee GTI protections against medium-risk\nURLs measured a decrease to 95 million per\nday in Q1 from 107 million per day in Q4 due\nto improved accuracy.\n\n    - McAfee GTI protections against risky IP\naddresses saw a decrease to 59 million per\nday in Q1 from 88 million per day in Q4 due\nto earlier detection.\n\nWe continue to receive valuable feedback from our\nreaders through our Threats Report user surveys. If you\nwould like to share your views about this Threats Report,\n[please click here to complete a quick, five-minute survey.](https://www.surveymonkey.com/r/W2SWBTX)\n\nEnjoy the summer.\n\n_—Vincent Weafer, Vice President, McAfee Labs_\n\n\n-----\n\n**McAfee Labs Threats Report**\nJune 2017\n\nThis report was researched and\nwritten by:\n\nChristiaan Beek\nDiwakar Dinkar\nYashashree Gund\nGerman Lancioni\nNiamh Minihane\nFrancisca Moreno\nEric Peterson\nThomas Roccia\nCraig Schmugar\nRick Simon\nDan Sommer\nBing Sun\nRaviKant Tiwari\nVincent Weafer\n\n\n## Contents\n\n###### Executive Summary 6\n\n Key Topics  7\n\n Malware evasion techniques and trends 8\n\n Hiding in plain sight: The concealed threat  of steganography 33\n\n The growing danger of Fareit, the password stealer 48\n\n Threats Statistics 69\n\n\n-----\n\nThere are hundreds, if not\nthousands, of evasion techniques\nemployed by malware authors.\nWe examine some of these\ntechniques and how malware\nauthors use them to accomplish\ntheir goals.\n\nDigital steganography hides\ninformation in benign-looking\nobjects. Attackers use this\ntechnique to pass information\nby security systems without\ndetection. We explain digital\nsteganography in this Key Topic.\n\nPassword stealers are used in\nthe early stages of nearly all\nattacks. Fareit, the most famous\npassword-stealing malware, was\nlikely used in the DNC breach\nbefore the 2016 U.S. Presidential\nelection. We examine Fareit in\nthis Key Topic.\n\nShare this Report\n\n\n#### Executive Summary\n\n###### Malware evasion techniques and trends\n\nMalware developers began experimenting with ways to evade security\nproducts in the 1980s, when a piece of malware defended itself by partially\nencrypting its own code, making the content unreadable by security analysts.\nToday, there are hundreds, if not thousands, of anti-security, anti-sandbox,\nand anti-analyst evasion techniques employed by malware authors. In this\nKey Topic, we examine some of the most powerful evasion techniques,\nthe robust dark market for off-the-shelf evasion technology, how several\ncontemporary malware families leverage evasion techniques, and what to\nexpect in the future, including machine learning evasion and hardwarebased evasion.\n\n###### Hiding in plain sight: The concealed threat of steganography\n\nSteganography has been around for centuries. From the ancient Greeks to\nmodern cyberattackers, people have hidden secret messages in seemingly\nbenign objects. In the digital world, those messages are most often\nconcealed in images, audio tracks, video clips, or text files. Attackers use\ndigital steganography to pass information by security systems without\ndetection. In this Key Topic, we explore the very interesting field of digital\nsteganography. We cover its history, common methods used to hide\ninformation, its use in popular malware, and how it is morphing into\nnetworks. We conclude by providing policies and procedures to protect\nagainst this form of attack.\n\n###### The growing danger of Fareit, the password stealer\n\nPeople, businesses, and governments increasingly depend on systems and\ndevices that are protected only by passwords. Often, these passwords are\nweak or easily stolen, creating an attractive target for cybercriminals. We\ndissect Fareit, the most famous password-stealing malware, in this Key Topic.\nWe cover its origin in 2011 and how it has changed since then; its typical\ninfection vectors; its architecture, inner workings, and stealing behavior;\nhow it evades detection; and its role in the Democratic National Committee\nbreach before the 2016 U.S. Presidential election. We also offer practical\nadvice on avoiding infection by Fareit and other password stealers.\n\n\n-----\n\n## Key Topics\n\nShare feedback\n\n\nMalware evasion techniques and\ntrends\n\nHiding in plain sight: The concealed\nthreat of steganography\n\nThe growing danger of Fareit, the\npassword stealer\n\n\n-----\n\nThe first malware evasion\ntechniques were simple because\nantimalware products were\nsimple. Today’s malware evasion\ntechniques are sophisticated and\npowerful.\n\nShare this Report\n\n\n#### Malware evasion techniques and trends\n\n_—Thomas Roccia_\n\nTechnology advances have significantly changed our lives during the past\ndecade. We rely on computers of various sorts for even the simplest of daily\ntasks and become stressed when they are not available or do not perform as\nwe expect. The data that we create, use, and exchange has become the gold\nof the 21st century. Because our information is so valuable and often very\npersonal, attempts to steal it have proliferated.\n\nMalware was first developed as a challenge, but soon attackers recognized\nthe value of stolen data and the cybercrime industry was born. Security\ncompanies, including McAfee, soon formed to defend people and systems\nusing antimalware technologies. In response, malware developers began\nexperimenting with ways to evade security products.\n\nThe first evasion techniques were simple because the antimalware products\nwere simple. For example, changing a single bit in a malicious file was\nsometimes good enough to bypass the signature detection of a security\nproduct. Eventually, more complex mechanisms such as polymorphism or\nobfuscation arrived.\n\nToday’s malware is very aggressive and powerful. Malware is no longer\ndeveloped just by isolated groups or teenagers who want to prove something.\nIt is now developed by governments, criminal groups, and hacktivists, to spy\non, steal, or destroy data.\n\nThis Key Topic details today’s most powerful and common evasion techniques\nand explains how malware authors try to use them to accomplish their goals.\n\n###### Why use evasion techniques?\n\nTo perform malicious actions, attackers create malware. However, they cannot\nachieve their goals unless their attempts remain undetected. There is a catand-mouse game between security vendors and attackers, which includes\nattackers monitoring the operations of security technologies and practices.\n\nThe term evasion technique groups all the methods used by malware to avoid\ndetection, analysis, and understanding.\n\nWe can classify evasion techniques into three broad categories:\n\n    - **Anti-security techniques: Used to avoid detection by antimalware**\nengines, firewalls, application containment, or other tools that\nprotect the environment.\n\n    - **Anti-sandbox techniques: Used to detect automatic analysis and**\navoid engines that report on the behavior of malware. Detecting\nregistry keys, files, or processes related to virtual environments lets\nmalware know if it is running in a sandbox.\n\n    - **Anti-analyst techniques: Used to detect and fool malware**\nanalysts, for example, by spotting monitoring tools such as Process\nExplorer or Wireshark, as well as some process-monitoring tricks,\npackers, or obfuscation to avoid reverse engineering.\n\n\n-----\n\nThere are many types of evasion\ntechniques, all designed to hide\nmalware from detection.\n\nShare this Report\n\n\nSome advanced malware samples employ two or three of these techniques\ntogether. For example, malware can use a technique like RunPE (which\nruns another process of itself in memory) to evade antimalware software, a\nsandbox, or an analyst. Some malware detects a specific registry key related\nto a virtual environment, allowing the threat to evade an automatic sandbox\nas well as an analyst attempting to dynamically run the suspected malware\nbinary in a virtual machine.\n\nIt is important for security researchers to understand these evasion\ntechniques to ensure that security technologies remain viable.\n\nWe see frequent use of several types of evasion techniques:\n\n###### Evasion Technique Use by Malware\n\n18.3%\n\n23.3%\n\nAnti-sandbox\n\nAnti-security tools\n\nCode injection\n\n16.1%\n\nAnti-debugging\n\n21.2%\n\nAnti-monitoring\n\n21.1%\n\nSource: Virus Total and McAfee, 2017.\n\nAnti-sandboxing has become more prominent because more businesses are\nusing sandboxes to detect malware.\n\n###### Definitions\n\nIn the world of cybersecurity evasion, certain terms are popular. Here are\nsome of the tools and terms used by attackers.\n\n    - **Crypter: Encrypts and decrypts malware during its execution.**\nUsing this technique, malware is often not detected by\nantimalware engines or static analysis. Crypters are often custom\nmade and can be bought in underground markets. Custom\ncrypters make decryption or decompiling even more challenging.\nAegis Crypter, Armadillo, and RDG Tejon are examples of advanced\ncrypters.\n\n    - **Packer: Similar to a crypter. A packer compresses a malware file**\ninstead of encrypting it. UPX is a popular packer.\n\n    - **Binder: Connects one or more malware files into one. A malware**\nexecutable can be bound with a JPG file, but the extension will\nremain EXE. Malware authors usually bind a malware file with a\nlegitimate EXE file.\n\n\n-----\n\n    - **Pumper: Increases the size of a file, allowing the malware to**\nsometimes bypass antimalware engines.\n\n    - **FUD: Fully UnDetectable by antimalware. Used by malware sellers**\nto describe and promote their tools. A successful FUD program\ncombines both scantime and runtime elements to be 100%\nundetected. We know two types of FUD:\n\n–– FUD scantime: Protects a malware file from detection by\nantimalware engines before the former runs.\n\n–– FUD runtime: Protects a malware file from detection by\nantimalware engines while it runs.\n\n    - **Stub: Usually contains the routine used to load (decryption or**\ndecompression) the original malware file into memory.\n\n    - **Unique stub generator: Creates a unique stub for each running**\ninstance, making detection and analysis more difficult.\n\n    - **Fileless malware: Infects a system by inserting itself into memory**\nand not writing a file to disk.\n\n    - **Obfuscation: Makes malware code difficult for humans to**\nunderstand. Plain-text strings are encoded (XOR, Base64, etc.) and\ninserted into the malware file, or junk functions are added to the\nfile.\n\n    - **Junk code: Adds useless code or fake instructions to the binary to**\nfool the disassembly view or waste analyst time.\n\n    - **Anti’s: Sometimes used on underground forums or marketplaces**\nto define all the techniques used to bypass, disable, or kill\nprotection or monitoring tools.\n\n    - **Virtual machine packer: Some advanced packers employ the**\nconcept of a virtual machine. When the malware EXE file is packed,\nthe original code is translated into the byte code of the virtual\nmachine and will emulate the behavior of a processor. VMProtect\nand CodeVirtualizer use this technique.\n\nFigure 1: Examples of evasion tools.\n\n\nShare this Report\n\n\n-----\n\n###### A brief history\n\nMalware evasion techniques have become far more numerous and\nsophisticated since they first appeared in 1980. Here are the major milestones\nin the evolution of evasion techniques:\n\n###### Major Milestones in the Evolution of Evasion Techniques\n\n 0K6Y0 BJ1Y0\n 09PS0\n\n\n**1980** **1998** **1999–2003** **2011** **2015–2017**\nCascade Virus Metamorphism Rootkits Off-the-Shelf Firmware\n\nFirst virus using Malware In 1999, the first Marketplace Malware\nencryption to Regswap uses Windows rootkit— Silkroad is first dark Equation Group and\nscramble its content. metamorphism via NTRootkit—appears, net market selling Hacking Team leaks\n\ndifferent registers followed by products and reveal the use of\nfor the same HackerDefender in services for malware firmware malware to\nfunctions. 2003. evasion. remain undetected.\n\n**1990** **1990s** **2008** **2015–2017**\nChameleon Packers Domain Dridex, Locky\nFamily Virus Packers that encrypt Generation First large-scale\n\nFirst polymorphic or compress become Algorithms obfuscation, use of\nviruses. popular due to the smaller size of RAM The Conficker worm PowerShell, and sandbox evasion.\n\nand disks. uses a DGA to evade\n\nnetwork detection.\n\nSource: McAfee, 2017.\n\nThe first known virus that attempted to defend itself from antimalware\nproducts was the MS-DOS virus Cascade. It defended itself by partially\nencrypting its own code, making the content unreadable by security analysts.\n\nFigure 2: MS-DOS virus Cascade in action.\n\n\nShare this Report\n\n\n-----\n\nFigure 3: A disassembled view of Cascade.\n\nIn Figure 3, we can see part of Cascade’s code. The red highlight is\nautomatically generated by the disassembler and indicates that the rest\nof the code does not exist. This is because the encrypted code needs to\nbe decrypted. An easy way to unravel this type of malware is to run the\nexecutable and let the decryption routine decrypt the rest of the code.\n\nIn early 1990, the security industry discovered Chameleon, the first\npolymorphic virus. Chameleon was highly encrypted and included junk code.\nTo make the analysis by researchers more difficult, several instructions were\nscrambled with every new infection.\n\nSubsequent malware developments introduced polymorphism, packers,\nrootkits, obfuscation, and other evasion techniques. Once dark markets began\nselling off-the-shelf malware, inexperienced attackers joined the crime wave.\n\n###### Evasion technology without coding\n\nThe use of evasion techniques by malware authors is fundamental to success.\nCybercriminals—even amateurs—understand this, so a lively and easily\naccessible market has developed for these evasion techniques.\n\n\nShare this Report\n\n\n-----\n\nEvasion techniques can be\npurchased off the shelf, allowing\nauthors to “outsource” this part\nof their malware development\nprocess. Some even offer unique\nevasion techniques as a service.\n\nShare this Report\n\n\nFigures 4–6: Examples of crypter tools found on the Internet.\n\n**Evasion techniques on dark markets**\nSome sellers have compiled several evasion techniques into one tool and offer\nthem for sale on underground markets to sophisticated malware creators or\ntheir affiliates who are responsible for spreading malware in support of large\ncampaigns.\n\n\n-----\n\nFigure 7: Evasion tools are sometimes available at low prices. Some sellers who have compiled\nseveral crypters and packers probably bought or stole them on the Internet, bundled them,\nand then offered the bundle for sale.\n\nFigure 8: Other sellers develop their own tools and keep the source code to avoid analysis\nand detection. The price is higher because the tools (presumably) cannot be distributed by\nanother party.\n\nFigure 9: Some sellers offer a service to make a FUD file. The service is more expensive,\nlikely due to the providers using advanced techniques such as code manipulation, high\nobfuscation, or other tricks with their own custom crypters.\n\n\nShare this Report\n\n\n-----\n\nFigure 10: It is also possible to purchase a certificate to sign any piece of malware, thus\nbypassing operating system security.\n\nWe see considerable variation in prices and services for sale. A service will be\nmore expensive than just a compilation of tools that are probably detected by\nantimalware products.\n\n###### Dark Market Evasion Tools for Sale\n\n Type of Product/ Dark Market Name Description Cost Service\n\n\n\n[Crypt Service] Make Your Crypter services for stubs. Sellers get\nFile FUD Again! stubs from buyers and claim to make\nthem FUD again.\n\n[FUD] Lazer Crypter Free packer\n\n[Macro Exploit Crypt Service] Service to create malicious macros for\nSpread Your EXE Like a Pro spreading malware.\n\nAmuse Crypt V2 Basic crypter\n\nArctic Miner— A crytocurrency miner. The author\nSilent CPU & GPU claims that it is FUD. The tools are\n\n[FUD|Startup|Idle|Injection| delivered with several evasion\nPersistence] techniques.\n\nBetaCrypt BetaCrypt code-mutation technology to\nalter output code and ensure a long FUD\ntime.\n\nShare this Report\n\n\n1 file $53 .71\n\n\n-----\n\n###### Type of Product/ Dark Market Name Description Cost Service\n\n\nUnlimited $35 .00\n\n\nBHGroup high-quality\ncrypting service (FUD/Native/\nSmall Stub/Great execute)\n\n\nCrypter services specializing in ASM or\nC files. Claims advanced functions (not\nanother .Net crypter), samples tested on\nseveral systems, claims to work with any\nRAT/bot/malware.\n\n\nBiggest Crypter Pack/70+ Pro Package of 72 packers Unlimited $2 .99\nCrypters/Best Price\n\nCarb0n Crypter 1.8 Basic crypter Unlimited $0 .94\n\n\nCrypter Source Codes/\nHuge Pack/Create your own\ncrypter! Make your malware\nundetectable\n\n\nPackage of crypter source code Unlimited $1 .99\n\n\nCrypters and Binders Pack of multiple crypter and binder tools Unlimited $7 .70\n\nCrypters Pack (372 items) Package of packers Unlimited $1 .99\n\n\n$14 .00\n\n\nLifetime license of\nCyanoBinder and full\nsupport\n\n\nCyanoBinder - Binder - Only\n$14 - Hide Your Malware\n\n- Cheap - Customizable\n\n- Powerful - Full Lifetime\nLicense\n\n\nAdvanced binder for joining files\n(executables, malware, pictures, movies)\ninto one executable file.\n\n\nData Protector Tool to secure program content from\nresearchers and crackers, and to\nprevent detection by antimalware\nprograms.\n\n\n45-day license $75 .00\n\n\nEXE FUD Crypt Service Long\nFUD 100% 0/45 for RAT,\nMalware, Ransomware,\nBotnet\n\n\nService for a FUD binary. The actors FUD crypt service $400 .00\nclaim their service is a long-term FUD.\n\n\nHow to Create a FUD Tutorial to create a crypter Tutorial $0 .94\nBackdoor Bypass Antivirus\n\nHQ Installs Crypter services for malware. Actors ask Crypter $85 .00\nto send ransomware-only bot.\n\nInfinity Crypter Cracked Basic crypter Unlimited $0 .99\n\n\nJava Crypter A type of FUD crypter that will protect\nfiles using private encryption and\nobfuscation methods.\n\nShare this Report\n\n\n1-month license $80 .00\n\n\n-----\n\n###### Type of Product/ Dark Market Name Description Cost Service\n\n\nNew Office Exploit Macros Macro creator for Microsoft Office. Unlimited $4 .00\nBuilder FUD Actors claim “almost FUD.”\n\n\n$60 .00\n\n\nOctopus Protector C++ Mainly an executable file protector,\nalthough it offers many other functions.\nProtects an executable, completely\nhiding its actual structure and code.\nHelps protect it from being reverse\nengineered, analyzed, or cracked.\n\nPrivate Crypter Crypter combines encryption,\nobfuscation, and code manipulation.\nActors claim vast experience in FUD\ncrypting software.\n\n\n1 stub for monthly\npurchases.\n\n12 stubs for 6-month\nmembership (2 stubs\neach month).\n\n24 stubs for 12-month\nmembership (2 stubs\neach month).\n\n\n45-day license $157 .71\n\n\nSick Crypter Basic crypter Unlimited $0 .94\n\n**Evasion techniques used by organized criminals and security companies**\nHacker organizations are also interested in evasion techniques. In 2015, the\n[Hacking Team revealed some techniques used to infect and spy on systems.](http://blog.trendmicro.com/trendlabs-security-intelligence/hacking-team-uses-uefi-bios-rootkit-to-keep-rcs-9-agent-in-target-systems/)\nTheir powerful UEFI/BIOS rootkit could infect without detection. In addition,\n[the Hacking Team developed their own core-packer to FUD their tools.](https://github.com/hackedteam/core-packer)\n\nSecurity companies that offer penetration testing services are aware of and\nuse these techniques, allowing pen testers to create an intrusion like a real\nhack.\n\n[The Metasploit suite,](https://www.offensive-security.com/metasploit-unleashed/msfvenom/) [Veil-Evasion, and Shellter allow pen testers to protect](https://github.com/Veil-Framework/Veil-Evasion)\ntheir “malicious” binaries. Security researchers are constantly looking for\nthese techniques before attackers find them. We have seen the recent threat\n[DoubleAgent trigger antimalware solutions.](https://github.com/Cybellum/DoubleAgent)\n\n###### Evasion techniques in action\n\nDuring the past year, we have analyzed many malware samples that contain\nevasion capabilities. In a typical attack, attackers use evasion techniques at\nmany steps in the attack flow.\n\nShare this Report\n\n\n-----\n\n###### Evasion Techniques in a Typical Attack Sequence\n\n**Infection Vector**\n\n         - Obfuscation          - Sandbox detection\n\n         - Antimalware vendor\nnetwork detection\n\n**Malware Delivery**\n\n         - Packing file          - Obfuscation\n\n         - Anti-debugging          - Fake metadata\n\n**Malware Behavior**\n\n         - Sandbox evasion          - Bypass antimalware/\n\n         - Code injection user account control\n\n                                          - Self-deletion\n\n**Actions on Objectives**\n\n\n\n- Network evasion\n\n- Encryption\n\n\n\n- Stealth\n\n- TOR network\n\n\n**Dridex banking Trojan**\nDridex (also known as Cridex) is a well-known banking Trojan that first\nappeared in 2014. This malware steals banking credentials and spreads\nthrough email attachments in Word files that contain malicious macros.\nThere have been several Dridex campaigns since 2014. In each succeeding\ncampaign, we have observed the addition and enhancement of evasion\ntechniques.\n\nDridex relies heavily on evasion for its infection vectors. We analyzed several\nThe well-known banking Trojan samples.\nDridex relies heavily on evasion\nfor its infection vectors.\n\nGET http://croningroup.com/73/20.exe\n\nFigure 11: We can see the obfuscation of the function names and data. This obfuscation is\ntrivial because it uses ASCII numbers. (Hash: 610663e98210bb83f0558a4c904a2f5e)\n\nShare this Report\n\n\nGET http://croningroup.com/73/20.exe\n\n\n-----\n\nOther variants use more advanced techniques.\n\nPowerShell\ncommand with\n\nhttps://www.maxmind.com\n\nbypass execution\npolicy\n\nFigure 12: This sample uses the evasion technique of string and content obfuscation,\nPowerShell with a bypass execution policy, and checking the IP address on maxmind.com\nagainst a blacklist of antimalware vendors. (Hash: e7a35bd8b5ea4a67ae72decba1f75e83)\n\nIn another sample, the Dridex infection vector tries to detect a virtual\nenvironment or a sandbox by checking the value of the registry key “HKLM\\\nSYSTEM\\ControlSet001\\Services\\Disk\\Enum” to search for strings such as\n“VMWARE” or “VBOX.” When a virtual machine or a sandbox is detected, Dridex\ndoes not run, appears to be harmless, or attempts to crash the system.\n\nEvasion techniques are widely used in infection vectors to avoid detection\nand understanding by analysts. Dridex combines several techniques to avoid\ndetection or analysis in multiple attack stages.\n\n    - **zzcasr.exe 1340**\n\nProcess hollowing\n–– edg1.exe 1588\n\n            - **rundll32.exe 1720**\n\nDLL injection\n\n    - **Explorer.exe 1420**\n\nFigure 13: In this example, Dridex uses the process hollowing evasion technique to inject\nmalicious code into a suspended process. Then a new process calls rundll32.exe, which\nloads the malicious DLL into explorer.exe.\n\nA recent Dridex sample uses the new evasion technique “AtomBombing.” This\ntechnique uses the Atom Tables, which are provided by the operating system\nto allow applications to store and access data. Atom Tables can also be used\nto share data between applications.\n\nIt is possible to inject malicious code into Atom Tables and force a legitimate\napplication to execute that code. Because the techniques used to inject\nmalicious code are well known and easily detected, attackers are now\nchanging their techniques.\n\nFinally, the final Dridex payload generally uses obfuscation and encryption to\nprotect data such as the control server URL, botnet information, and the PC\nname contained inside the malicious binary.\n\n\nShare this Report\n\n\n-----\n\nThe Locky ransomware family\nuses many of the same evasion\ntechniques as Dridex, but\nhas added additional evasion\ntechniques over time.\n\nShare this Report\n\n\n**Locky ransomware**\nLocky is one of the most prominent ransomware families to arrive in 2016.\nIt uses many methods to infect systems. Some of its evasion techniques are\nsimilar to Dridex’s.\n\nFigure 14: One Locky infection vector used basic obfuscation with Unicode and random\nstrings for functions. (Hash: 2c01d031623aada362d9cc9c7573b6ab)\n\nIn the preceding instance, deobfuscation is trivial because it is easy to reverse\nUnicode, an encoding standard for printing text in different formats. Each\nUnicode character in this snippet corresponds to an ASCII character.\n\n\n###### ASCII Unicode Hexadecimal\n\n\nA 0041 41\n\nFigures 15–16: In this (deobfuscated) infection vector, the code is downloading an EXE file\ninto the TEMP folder from an external URL.\n\n[Other Locky samples use multiple stages with XOR encryption to avoid](https://securingtomorrow.mcafee.com/mcafee-labs/locky-ransomware-hides-under-multiple-obfuscated-layers-of-javascript/)\ndetection and bypass email filtering and web gateways.\n\nSome Locky variants use the Nullsoft Scriptable Install System, which\ncompresses files. This legitimate app has become more commonly used by\nmalware to bypass antimalware engines. An NSIS file can be unzipped directly\nto get the content.\n\n\n-----\n\nFigure 17: In this example of Locky, we see many garbage files designed to waste analyst\ntime. All these files are compressed by the NSIS app. Only some are used to perform\nmalicious actions on the target system. (Hash: 5bcbbb492cc2db1628985a5ca6d09613)\n\nIn addition to obfuscating executable formats, Locky uses tricks to bypass\nfirewall and control server detection over the network. Some Locky variants\n[use a domain generation algorithm, a technique that allows for the dynamic](https://en.wikipedia.org/wiki/Domain_generation_algorithm)\ncreation of domains. Locky authors have changed and updated their evasion\ntechniques with each new campaign.\n\nIn August 2016, Locky started to use a command-line argument to evade\nautomated sandbox analysis. Without the command line, the sample will not\nrun on the system and the payload will not be decoded into memory.\n\nFigure 18: In this example, the command-line parameter “123” is passed by the infection\nvector, a JavaScript file. Then, the command-line parameter is read by the Windows API\n[GetCommandLine and CommandLineToArgvW. (Hash: 0fed77b29961c0207bb4b7b033ca3fd4)](https://msdn.microsoft.com/en-us/library/windows/desktop/ms683156(v=vs.85).aspx)\n\n\nShare this Report\n\n\n-----\n\nThe Nymain downloader uses\na combination of anti–reverse\nengineering techniques with\nobfuscation and sandbox\ndetection as well as a campaign\ntimer.\n\nShare this Report\n\n\nThe parameter for this sample is used to decrypt and unpack the payload into\nmemory. If the parameter is not correct, the sample simply crashes as it tries\nto run encrypted code.\n\nAnother trick by Locky, and other malware, is the use of the Read TimeStamp Counter (RDTSC) x86 instruction to detect a virtual environment. The\ntime-stamp counter counts the number of processor cycles since a reset.\nThe instruction RDTSC simply returns the value of the counter stored in the\nregisters edx:eax.\n\nOn a physical host, two consecutive RDTSC instructions take a small number\nof cycles. On a virtual host, this number of cycles will be bigger. If the value\nreturned is not the value expected, the sample goes dormant.\n\n[Figure 19: The instructions in the Windows API calls GetProcessHeap and CloseHandle are](https://msdn.microsoft.com/en-us/library/windows/desktop/aa366569(v=vs.85).aspx)\n[used to increase the amount of processor cycles. (The instructions per cycles, IPC, estimate](https://en.wikipedia.org/wiki/Instructions_per_cycle)\nthe performance of a processor.) Locky compares the amounts and if it takes 10 times more\ncycles to perform CloseHandle than GetProcessHeap, the malware concludes it is running in\na virtual machine. (Hash: 0bf7315a2378d6b051568b59a7a0195a)\n\n**Nymain downloader**\nNymain delivers malware such as Trojans or ransomware. Nymain uses\nseveral evasion mechanisms to avoid analysis and detection—a combination\nof anti–reverse engineering techniques with obfuscation and sandbox\ndetection as well as a campaign timer.\n\nMost malware use fake metadata to appear legitimate. The metadata includes\ninformation about the program such as FileVersion, CompanyName, and\nLanguages. Other samples use stolen certificates to appear legitimate.\n\n\n-----\n\nFigure 20: Metadata used by Nymain. (Hash: 98bdab0e8f581a3937b538d73c96480d)\n\nFigure 21: Anti-debugging tricks used by Nymain to avoid dynamic analysis by a debugger.\n\nThe most common but also the easiest to bypass is the function\n[IsDebuggerPresent. The code calls the Windows API and sets a value in](https://msdn.microsoft.com/en-us/library/windows/desktop/ms680345(v=vs.85).aspx)\na register. If the value is not equal to zero, then the program is currently\ndebugged. In that case, the malware terminates the process with the API\n[TerminateProcess. Another bypass debugger trick is the call FindWindow. If a](https://msdn.microsoft.com/en-us/library/windows/desktop/ms633499(v=vs.85).aspx)\nwindow is related to a debugger, such as OllyDbg or Immunity Debugger, this\nAPI detects it and shuts down the malware.\n\nNymain performs additional checks to avoid analysis:\n\n    - Check the date and do not execute after the end of the campaign.\n\n    - Check whether the malware’s filename hash is on the system. If it\nis, an analysis could be underway.\n\n    - Check for a MAC address related to a virtual environment.\n\n    - Check the registry key HKLM\\HARDWARE\\Description\\\nSystem\\”SystemBiosVersion” to find the string “VBOX.”\n\n    - Insert junk code, resulting in disassembler “code spaghetti.”\n\n    - Use a domain generation algorithm to evade network detection.\n\n\nShare this Report\n\n\n-----\n\n**Necurs Trojan**\nNecurs is a Trojan that takes control of a system and delivers other malware.\nThe Necurs Trojan focuses on Necurs is one of the largest botnets, with more than six million nodes in 2016.\ndetecting and evading sandbox Necurs began to deliver Locky in 2016.\nanalysis.\n\nFigure 22: Necurs uses several mechanisms to avoid detection and analysis. (Hash:\n22d745954263d12dfaf393a802020764)\n\nFigure 23: The CPUID instruction returns information about the CPU and allows the\nmalware to detect if it is running in a virtual environment. If the answer is yes, then the\nmalware will not run.\n\nShare this Report\n\n\n-----\n\nFigure 24: A second evasion technique uses the Windows API call GetTickCount to retrieve\nthe time since the system was started. It then performs several actions and again retrieves\nthe elapsed time. This technique is used to detect a debugging tool. If the time retrieved is\nlonger than expected, the file is currently being debugged. The malware will terminate the\nprocess or crash the system.\n\nFigure 25: An old but still effective evasion technique is querying the input/output\ncommunication port used by VMware. Malware can query this port using the magic number\n“VMXh” with the x86 “IN” instruction. During execution, the IN instruction is trapped by the\nvirtual machine and emulated. The result returned from the instruction and stored in the\nregister ebx is then compared to the magic number “VMXh.” If the result matches, the malware\nis running on VMware and will terminate the process or attempt to crash the system.\n\n\nShare this Report\n\n\n-----\n\nFigure 26: The VMCPUID instruction is similar to CPUID, though this instruction is\nimplemented only on some virtual machines. If the VMCPUID instruction is not\nimplemented, it results in a system crash, preventing analysis by a virtual machine.\n\nFigure 27: The VPCEXT instruction (visual property container extender) is another anti–\nvirtual machine trick used by Necurs to detect virtual systems. This technique is not\ndocumented, and is used by several other bots. If the execution of the instruction does not\ngenerate an exception, then the malware is running on a virtual machine.\n\n**Fileless malware**\nSome malware infects a system without writing a file to disk, thereby evading\n[many types of detection. We first wrote about fileless malware in the McAfee](http://www.mcafee.com/us/security-awareness/articles/mcafee-labs-threats-report-nov-2015.aspx)\n_[Labs Threats Report: November 2015.](http://www.mcafee.com/us/security-awareness/articles/mcafee-labs-threats-report-nov-2015.aspx)_\n\n\nShare this Report\n\n\n-----\n\nFileless malware evades\ndetection by not writing any\nfile to disk, where security\ntechnologies usually look for\nmalware.\n\n\nWe now see PowerShell used as an infection vector. In one sample, a simple\nJavaScript file runs an obfuscated PowerShell command to download a packed\nor armored file from an external IP address. The file injects a malicious DLL\ninto a legitimate process, bypassing all protection. This malware type is not\ncompletely fileless, but it is still effective.\n\nThe following example (hash: f8b63b322b571f8deb9175c935ef56b4) shows\nthe infection process:\n\n\nFigure 28: The PowerShell command drops an NSIS-packed file (agzabf.exe, hash: c52950316a6d5bb7ecb65d37e8747b46), which injects\nmonkshood.dll (hash: 895c6a498afece5020b3948c1f0801a2) into the process explorer.exe. The evasion technique used here is DLL injection,\nwhich injects code into a running process.\n\n###### Evasion Technique Trends\n\nThe most common evasion techniques include:\n\n                                                     - **Obfuscation: Protects data, variables, and network**\ncommunications. Randomizes names of variables or functions. Can\nbe performed using XOR or any other encoding technique.\n\n                                                     - **Environment checking: Avoids analysis; malware detects tools or**\nartefacts related to virtual environments.\n\n                                                     - **Sandbox detection: Malware performs disk checks to detect files**\nor processes related to a sandbox.\n\nShare this Report\n\n\n-----\n\nThe following statistics, from Virus Total and McAfee, are derived from\nsamples known to contain sandbox evasion techniques.\n\n###### Sandbox Evasion Techniques\n\n1.5%\n\n24.0%\n\nAnti-automated sandbox\n\n36.9%\n\nVMware detection\n\nVirtual box detection\n\nQemu detection\n\n19.2%\n\nOther anti-VM\n\n18.5%\n\nSource: Virus Total and McAfee, 2017.\n\n[Malware use many other techniques to evade detection. Detecting monitoring](https://securingtomorrow.mcafee.com/mcafee-labs/overview-malware-self-defense-protection/)\nand Windows hooking (changing the behavior of internal Windows functions)\nare common. Escalating privileges is popular for disabling antimalware tools\nor performing other actions that require administrator privileges.\n\n###### Other Evasion Techniques\n\nWindows hook\n\nThread injection\n\n24.8%\n\n25.6%\n\nEscalate privilege\n\nDLL injection\n\nDisable registry\n\n4.9% 7.1%\n\nDisable firewall\n\n4.7%\n\nDisable DEP\n\n\n1.0%\n\n\nDisable antimalware\n\nDetect monitoring\n\nSource: Virus Total and McAfee, 2017.\n\n\nShare this Report\n\n\n-----\n\nAuthors of malware evasion\ntechniques are now looking for\nways to evade machine learning\nsecurity techniques, which\nare growing in use by security\nvendors.\n\nShare this Report\n\n\nThe security industry is developing new detection techniques based on\nmachine learning, which can examine behavior and make a prediction\nwhether an executable is malicious.\n\nFigure 29: Interest in machine learning has been growing steadily.\n\nSource: Google Trends.\n\nThe security industry is highly interested in machine learning, as are attackers.\nIn March, security researchers observed the first malware sample, Cerber\n[ransomware, that evades detection based on machine learning. Cerber](https://blog.trendmicro.com/trendlabs-security-intelligence/cerber-starts-evading-machine-learning/?utm_campaign=shareaholic&utm_medium=linkedin&utm_source=socialnetwork)\nuses several files for each stage of infection, injecting them dynamically\ninto running processes. The challenge for these attackers is that machine\nlearning detects malicious files based on features and not on signatures. In\nthis example, Cerber used a separate loader to inject the payload, instead of\nrunning a routine inside it. This technique allowed Cerber to run undetected\nby machine learning though not by traditional antimalware engines.\n\nAnother growing evasion technique is firmware infection, which we expect will\nbe especially popular for attacking Internet of Things devices.\n\nInserting malicious code into firmware is a very effective way to avoid\ndetection. Firmware malware can take control of many system components,\nincluding the keyboard, microphone, and file system. It cannot be detected\nby the operating system because the infection occurs in Ring -1, the deepest\npoint in the kernel, where the malware enjoys many privileges and there are\nfew security checks.\n\n\n-----\n\n###### Firmware-Based Evasion Techniques\n\n\n3\n\n\nLeast\nprivileged\n\nMost\nprivileged\n\n|3 Applications 2 Drivers 1 Drivers 0 Kernel -1 Firmware|privileged Most|\n|---|---|\n\n\nTo detect this kind of threat and easily analyze firmware, McAfee Advanced\nThreat Research released the open-source tool Chipsec. You can check a\nwhitelist to find if the firmware has been compromised with the following\ncommands:\n\nFigure 30: Dumping firmware with the Chipsec framework.\n\n\nShare this Report\n\n\n-----\n\nFigure 31: Checking dumped firmware against a whitelist to detect any modifications.\n\n###### Protecting against evasive malware\n\nLearning about malware evasion techniques is the first step in a journey to\nbetter protect against evasive malware.\n\nBuilding a security program to protect against evasive malware should be\nbased on three foundational components.\n\n    - **People: Security practitioners must be trained to properly respond**\nto security incidents and to properly manage current security\ntechnology. Attackers commonly use social engineering to infect\nusers. Without internal awareness and training, users will leave\nsome windows open for attackers.\n\n    - **Process: Clear structures and internal processes must be in**\nplace so that security practitioners can be effective. Security best\npractices (updates, backups, governance, intelligence, incident\nresponse plan, and more) are the keys to a powerful and effective\nsecurity team.\n\n    - **Technology: Technology supports the team and processes. It**\nshould be nurtured and enhanced so that it can adapt to new\nthreats.\n\n###### Actionable policies and procedures to protect against evasive malware\n\nThe most important defense against malware infections is users. Users must\nbe aware of the risk of downloading and installing applications that come\nfrom potentially risky sources. Users must also learn that malware can be\ninadvertently downloaded while browsing.\n\nAlways keep web browsers and add-ons up to date and antimalware on\nendpoints and network gateways upgraded and updated to the latest\nversions.\n\n\nShare this Report\n\n\n-----\n\n**To learn how McAfee products**\n**can help protect against**\n**[evasive malware, click here.](https://www.mcafee.com/common/js/asset_redirect.html?eid=17BR_TRGLQ2_WP_WW-8&url=http://www.mcafee.com/us/resources/solution-briefs/sb-quarterly-threats-jun-2017-1.pdf)**\n\nShare this Report\n\n\nDo not allow systems on the trusted network that are not distributed and\ncertified by the corporate IT security group. Evasive malware can be easily\ndisseminated by unprotected systems connected to the trusted network.\n\nEvasive malware can hide inside legitimate software previously Trojanized\nby an attacker. To prevent a successful attack of this type, we highly\nrecommended tightened software delivery and distribution mechanisms. It is\nalways a good idea to have a central repository of corporate applications from\nwhich users can download approved software.\n\nIn instances where users are authorized to install applications that have not\nbeen previously validated by the IT security group, educate users to install\nonly applications with trusted signatures from known vendors. It is very\ncommon for “harmless” applications offered online to have embedded evasive\nmalware.\n\nAvoid application downloads from non-web sources. The likelihood of\ndownloading malware from Usenet groups, IRC channels, instant messaging\nclients, or peer-to-peer systems is very high. Links to websites in IRC and\ninstant messages also frequently point to infected downloads.\n\nImplement an educational program for phishing attack prevention. Malware is\ncommonly distributed by phishing attacks.\n\nLeverage threat intelligence feeds combined with antimalware technology.\nThis combination will help speed up threat detection.\n\n###### Conclusion\n\nFor malware to perform its malicious actions, it must remain undetected\nand stealthy. As security technology becomes more sophisticated, evasion\ntechniques have also become more sophisticated. This competition has led to\na robust underground market for the very best evasion technologies, including\nfully undetectable malware. Some of these services use evasion techniques\nthat are unknown to the security industry.\n\nMalware evasion techniques continue to evolve and are now deployed for\nuse at just about any stage of an attack. Several campaigns use the same\ntechniques to spread but also to avoid analysis and detection, as shown with\nDridex and Locky. Old evasion tricks are still popular and effective by even the\nmost well-known malware.\n\nTo protect against evasive malware, we must first understand it. We must\nstudy each breach to learn why the security technology did not stop the\nattack.\n\n[To learn how McAfee products can help protect against evasive malware, click](https://www.mcafee.com/common/js/asset_redirect.html?eid=17BR_TRGLQ2_WP_WW-8&url=http://www.mcafee.com/us/resources/solution-briefs/sb-quarterly-threats-jun-2017-1.pdf)\n[here.](https://www.mcafee.com/common/js/asset_redirect.html?eid=17BR_TRGLQ2_WP_WW-8&url=http://www.mcafee.com/us/resources/solution-briefs/sb-quarterly-threats-jun-2017-1.pdf)\n\n\n-----\n\n#### Hiding in plain sight: The concealed threat of steganography\n\n_—Diwakar Dinkar_\n\nSteganography is the art and science of secret hiding. The term steganography\nis derived from the Greek words stegos, meaning “cover,” and grafia, meaning\n“writing.” Thus “covered writing.”\n\n\nStegano\n\n=\n\nCovered\n\n\nWriting\n\n\nGraphy\n\n\nSteganography\n\n\n= =\n\n##### + =\n\n\nCovered writing\n\n\nSteganography, the art and\nscience of secret hiding, can also\nbe used to hide information in\nthe digital world.\n\nShare this Report\n\n\nThe concept of steganography is not new; it has been around for centuries.\nAbout 440 BCE, the Greek ruler Histiaeus employed an early version of\nsteganography that involved shaving the head of a slave, tattooing a message\non his scalp, waiting for the hair to regrow and hide the secret message, and\nthen sending him to deliver the message. Recipients shaved his head again\nto uncover the message. Another Greek, Demaratus, wrote a message on the\nwooden backing for a wax tablet that the Persians planned to attack Sparta.\nHe then covered the message with a fresh layer of wax. The seemingly blank\ntablet delivered the message. There are also stories of secret messages\nwritten in invisible ink or hidden in love letters. (The first character of each\nsentence can be used to spell a secret, for example.) Steganography was used\nby prisoners and soldiers during World War II because mail in Europe was\ncarefully inspected.\n\n**Steganography in the digital world**\nSteganography can also be used to hide information in the digital world. To\ndigitally hide a secret message, we need a wrapper or container as a host file.\nWrappers can be images, audio tracks, video clips, or text files. The following\nimages show how a text message can be hidden in a cover image with\nminimal change to the file and no visible change to the image.\n\n\nHidden message\n\nSteganography\nembedding algorithm\n\nCover\nimage\n\n\nSteganographic\nimage\n\n\n-----\n\nThe first known use of\nsteganography in a cyberattack\nwas in the Duqu malware, which\nsurfaced in 2011.\n\nShare this Report\n\n\n**Steganography, cryptography, watermarking**\nSteganography, cryptography, and watermarking are used to hide\ninformation. Cryptography hides a message using an encryption algorithm\nand sends it as cypher text. Steganography hides a secret message within a\nseemingly legitimate message. Watermarking is slightly different: It uses a\nsignature to identify the origin and all copies are marked in the same way.\nThese three methods are the most common for hiding information.\n\nHiding information\n\nWatermarking Cryptography Steganography\n\n**Steganography in cyberattacks**\nMalware constantly evolves to evade surveillance and detection. To avoid\ndetection, some malware uses digital steganography to hide its malicious\ncontent within a seemingly innocent cover file. But that raises an obvious\nquestion: If malware must decrypt the hidden data, won’t an antimalware\nproduct simply detect the decryption routine?\n\nMost antimalware signatures detect malicious content in the configuration\nfile. With steganography, the configuration file is embedded in the cover file.\nFurther, the resulting steganographic file may decrypt into main memory,\nfurther reducing the chance of detection. Finally, it is extremely difficult to\ndetect the presence of hidden information such as a configuration file, binary\nupdate, or bot command inside steganographic files. Unfortunately, the use of\nsteganography in cyberattacks is easy to implement and hard to detect.\n\n[The first known use of steganography in a cyberattack was in the Duqu](https://en.wikipedia.org/wiki/Duqu)\n[malware, which surfaced in 2011. Duqu’s main purpose was to gather](https://en.wikipedia.org/wiki/Duqu)\ninformation from a victim’s system. Duqu encrypted and embedded the\ndata into a JPEG file and sent it to its control server as an image file, thereby\nraising no suspicion. In 2014, researchers discovered that a variant of the Zeus\n[banking Trojan (ZeusVM) used image steganography to hide commands it](https://www.scmagazine.com/new-variant-of-zeus-banking-trojan-concealed-in-jpg-images/article/538677/)\n[sent to infected systems. Later that year, we learned Lurk delivered additional](https://www.secureworks.com/research/malware-analysis-of-the-lurk-downloader)\nmalware using a steganographic technique. In case of Lurk, a white BMP\nimage file contained an encrypted URL that downloaded a second payload\nonce it had been decrypted. Recently, image steganography has been used by\nStegoloader (also known as Gatak) and by different malvertising campaigns.\n\nZbot, Lurk, ZeusVM,\nMiniDuke, CosmicDuke\n\n\nDuqu, Shady RAT,\nAlureon rootkit\n\n\nVawtrak, Stegoloader,\nSundown, AdGholas,\nMagento CC, DNSChanger\n\n\n-----\n\n**Digital steganography types**\nDigital steganography can be divided into text, image, audio, and video\nsteganography. Text steganography is one of the earliest and most difficult\nto employ. It uses written natural language to conceal a secret message.\nText steganography is challenging due to the lack of redundancy in text\ndocuments. Audio steganography transmits hidden information by modifying\nan audio signal in an imperceptible manner, and embedding the secret\nmessage as noise into an audio file at a frequency out of the range of human\nhearing. For example, spread spectrum steganography is often used to send\nhidden messages through radio waves. Similarly, in video steganography the\nsecret message hides in the video stream.\n\n**Image steganography**\nThe most common form of digital steganography uses images. To understand\nimage-based steganography, we need to understand the concept of a digital\nimage. Images are usually based on 8-bit or 24-bit color combinations. Each\npixel typically consists of 8 bits (1 byte) for a black-and-white image; or 24\nbits (3 bytes) for a color image, with one byte each for red, green, and blue\n(generally known as the RGB format). For example, RGB (218,150,149) means\nR = 11011010, G = 10010110, and B = 10010101.\n\n\nPixel\n3 bytes = 24 bits\n\n\nWe can divide image steganography into the following general domains:\n\nImage steganography\n\nSpatial domain Transform domain Distorion Masking and\ntechnique technique techniques filtering technique\n\nIn the spatial domain technique, we can hide secret data by direct\nmanipulation on the pixel value of the cover image. Least significant bit–\nbased steganography is one of the most popular and simplest spatial domain\ntechniques.\n\nThe transform domain technique is also known as the frequency domain\ntechnique because it involves the embedding of secret data in the frequency\nor transform of the cover image. This technique is a more complex method of\nhiding data in an image.\n\n\nShare this Report\n\n\n-----\n\nIn the distortion technique, the secret data is embedded using signal\ndistortion. This technique needs the information of the cover image on the\ndecoder side because it checks the differences between the original cover\nimage and the distorted cover image to extract the secret message.\n\nMasking and filtering is another common steganography technique. It hides\nor masks the secret data over the cover image by modifying the brightness or\nluminance of some parts of the image.\n\nHow does an attacker hide a message in an image? We can understand the\nprocess of hiding by the spatial domain example given below:\n\n\n3 pixels before\ninsertion\n\n\n1 pixel\n\n1 pixel\n\n1 pixel\n\n\n0 0 1 0 0 1 1 0\n1 1 1 0 1 0 0 0\n1 1 0 0 1 0 0 1\n\n0 0 1 0 0 1 1 1\n1 1 0 0 1 0 0 1\n1 1 1 0 1 0 0 1\n\n1 1 0 0 1 0 0 1\n0 0 1 0 0 1 1 1\n1 1 1 0 1 0 1 1\n\n\nInserting letter ‘A’\nhas an ASCII value\nof 65 (decimal),\n\n##### + =\n\nwhich is 01000001\nin binary.\n\n\n3 pixels after\ninsertion\n\n0 0 1 0 0 1 1 0\n1 1 1 0 1 0 0 1\n1 1 0 0 1 0 0 0\n\n0 0 1 0 0 1 1 0\n1 1 0 0 1 0 0 0\n1 1 1 0 1 0 0 0\n\n1 1 0 0 1 0 0 0\n0 0 1 0 0 1 1 1\n1 1 1 0 1 0 1 1\n\n\nModified bits in an image are\nvisually imperceptible, yet they\ncan be decrypted and used by\nmalware once the image file is\nreceived on the victim’s system.\n\nShare this Report\n\n\nMSB LSB\n\nFigure 32: The right-hand-column values in red were modified by the transformation. MSB\nand LSB stand for “most significant bit” and “least significant bit,” respectively.\n\nA steganography-embedding algorithm is used to modify the image, changing\nthe least significant bits to embed the letter “A” in three pixels of the color\nimage. The changed least significant bits are visually imperceptible, yet they\ncan be decrypted and used by the malware once the image file is received on\nthe victim’s system.\n\nWe can summarize the digital steganography process:\n\n\n-----\n\nThe hidden message and cover file are passed through the embedding\nalgorithm to hide the message within the cover file. The resulting\nsteganographic file is sent through a communications channel to the target\nsystem. Finally, the hidden message is extracted by applying an extraction\nalgorithm to the steganographic file.\n\n**How does steganography help exploit kits?**\nSteganography is now used in several malvertising and exploit kit attacks. The\nSundown exploit kit started to appear in 2015. At that time, it was not very\nadvanced and seems to have stolen most of its code from the Angler, Nuclear,\nand RIG exploit kits. In October 2016, Sundown evolved and started making\nuse of steganography.\n\n**Recent variants of the Sundown exploit kit**\nWe can understand recent variants of the Sundown exploit kit with the\nfollowing infection chain:\n\n\n1\n\n\n2\n\n\n3\n\n\n4\n\n\n5\n\n|1 User|2 Website or ad|3 Exploit server|4 Flash/IE|5 Payload|\n|---|---|---|---|---|\n\n\nUser visits\ncompromised\nwebsite or clean\nwebsite with\nmalware ads\n\n\nExploit server\nwith landing page\nand image\nsteganography to\nbypass AV\nproducts\n\n\nInfects user\nusing Flash and\nIE exploits\n\n\nDownloads\npayload\n\n\nThe popular Sundown exploit kits\nuses steganography to hide codetargeting vulnerabilities.\n\nShare this Report\n\n\nA Sundown attack begins when a victim visits a compromised website or a\nclean website with malicious ads. The victim is automatically redirected to the\nexploit kit.\n\nThe following image shows network traffic in January in which victims were\nredirected toward the Sundown landing page. The page retrieved and\ndownloaded PNG images.\n\nFigure 33: Steganography used in the Sundown infection chain.\n\n\n-----\n\nIn most cases, the PNG file appears to be a white image:\n\nFigure 34: Viewing a downloaded malicious PNG file.\n\nEven the hex view shows a PNG file with a proper PNG header:\n\nFigure 35: Viewing the hex of a downloaded malicious PNG file.\n\nBut this PNG file data is encoded and hides malicious code within it.\n\nThe Sundown kit landing page contains a decoding routine that unlocks\nthe PNG file and extracts the malicious content. The landing page is heavily\nobfuscated.\n\n\nShare this Report\n\n\n-----\n\nFigure 36: Obfuscated code that decodes the PNG file.\n\nFigure 37: Deobfuscated landing page code.\n\nThe code loads the PNG file and has a URL that downloads a payload after\nsuccessful exploitation. The decoding logic appears at the end of the script.\n\n\nShare this Report\n\n\n-----\n\nFigure 38: The decoding logic for the PNG file.\n\nAfter successfully decoding the PNG, we see its output:\n\nFigure 39: Code to exploit the vulnerability CVE-2015-2419 after decoding the PNG data.\n\nFurther analysis of this exploit code decoded from the PNG image shows\nthat it includes the exploit code targeting CVE-2015-2419, a vulnerability in\nthe JavaScript handling of Internet Explorer. This exploit code also contains\nshellcode that will be executed after successfully exploiting the vulnerability.\n\n\nShare this Report\n\n\n-----\n\nFigure 40: Shellcode to attack CVE-2015-2419.\n\nThis Sundown kit was found to be distributing Cerber ransomware from the IP\naddress 93.190.143.82 with the help of steganography.\n\nSHA256 hashes related to this analysis:\n\n    - A5E991B647BC60A9323A214C71146F534D4195182C3C630B228\n3BF1D3CEC8D6D\n\n    - EFB5308AA78FFD53E799F7411CC92A564219C27B15D630B6BFA\nEC674DF8B5923\n\n    - EEDBD8CDDBA5ED59D86207E37252406E2E1DB1762098A6293E\nA25762E555E75B\n\n###### Cerber hides in .jpg file\n\n[The Cerber ransomware family is currently quite popular. The initial](https://www.bleepingcomputer.com/news/security/the-cerber-ransomware-not-only-encrypts-your-data-but-also-speaks-to-you/)\npropagation vector is macro code embedded in a Microsoft document file.\n\nFigure 41: When the victim opens a Cerber-infected document, it drops a malicious .vbs file,\nwhich executes using wscript.exe and downloads mhtr.jpg from a malicious website.\n\nFigure 42: This network capture shows a request for mhtr.jpg.\n\n\nShare this Report\n\n\n-----\n\nFigure 43: The downloaded mhtr.jpg (SHA256 hash: 8f14257937bd6d45c2455592614331ebb\n10078d8bfd9e6acf1b502ed609ef131) shows it is related to Zen Coding.\n\nFigure 44: The header of mhtr.jpg.\n\nFigure 45: A single XOR byte key is used to encrypt the executable file and is embedded\nusing steganography at the offset 0x25c9.\n\nFrom offset 0x25c9 each byte is encrypted using an XOR byte key 0x73. The\ndecryption process:\n\n\nShare this Report\n\n\n-----\n\nVawtrak started using\nsteganography to hide its settings\nin favicons, small icons associated\nwith websites or web pages.\n\nShare this Report\n\n\nFigure 46: The decrypted file.\n\nThe encrypted file’s payload is a Nullsoft installer file (SHA256 hash:\n37397f8d8e4b3731749094d7b7cd2cf56cacb12dd69e0131f07dd78dff6f262b)\nthat is dropped in the %APPDATA% folder and used for ransomware activity.\n\n**Steganography used by Vawtrak, Zbot, Lurk, and Stegoloader**\n[In early 2015, Vawtrak started using steganography to hide its settings in](http://securityaffairs.co/wordpress/35308/malware/vawtrak-steganography-favicon.html)\nfavicons. The malware downloads a favicon.ico file from a server hosted on\nTOR using the tor2web service. This favicon.ico image is the one displayed by\nbrowsers at the left side of a URL. Generally, each website contains a favicon\n.ico image, so security products seeing such requests would typically not test\nthem for validity. Next, the malware extracts a least significant bit from each\npixel and constructs a URL for downloading its configuration file.\n\n[One variant of the Zbot malware also uses steganography to hide its](http://www.csoonline.com/article/2137032/malware-cybercrime/criminals-using-steganography-tricks-to-manage-zbot-attacks.html)\nconfiguration data. This variant downloads a JPEG on the victim’s system. The\nconfiguration data hides inside this image. Later, the malware extracts the\nconfiguration data from the image and performs further malicious actions.\n\nLurk uses steganography to download other malware onto targeted systems.\nInstead of simply downloading and executing a malicious binary, Lurk first\ndownloads a BMP image. It uses a least-significant-bit algorithm to embed\nencrypted URLs into the image file. It extracts the embedded URLs from the\nimage file and then downloads additional malware.\n\n[Stegoloader installs malware on victims’ systems to steal sensitive](https://www.virusbulletin.com/virusbulletin/2016/04/how-it-works-steganography-hides-malware-image-files/)\ninformation. On successful execution, Stegoloader downloads a PNG image\nfrom a legitimate website. It uses steganography to embed its main module’s\ncode inside the downloaded PNG. The malware retrieves the hidden data by\napplying a steganographic extraction algorithm.\n\n**Data exfiltration and steganography**\nData exfiltration, also known as data theft, is the unauthorized transfer of\nsensitive information from a computer or a server. In 2016, we saw attacks\nrelated to Magento, an online e-commerce platform. The attacks used image\nsteganography to hide payment card details.\n\n\n-----\n\nNetwork steganography is the\nnewest form of this discipline.\nUnused fields within the TCP/IP\nprotocol header are used to hide\ndata. This method is on the rise\nbecause attackers can send an\nunlimited amount of information\nthrough the network using this\ntechnique.\n\nShare this Report\n\n\nIn general, Magento websites handle credit card information with a core\ncontent management system file, cc.php. Thus the obvious location for\nattackers to place malicious code on Magento sites is at [magento_root] /app/\ncode/core/Mage/Payment/Model/Method/cc.php.\n\nFigure 47: A legitimate prepareSave () method.\n\nGenerally, the malware inserts malicious code inside the prepareSave ()\nmethod, but it might be present in any other method as well. After execution,\nthe malicious code collects the payment card details and hides inside a local\nimage file, such as a real product picture. Once done with the collection, the\nattacker simply downloads the image file (typical for an e-commerce website)\nand extracts the hidden data.\n\n**Network steganography**\nNetwork steganography is the latest type of digital steganography used by\nmalware. This form is on the rise because attackers can send an unlimited\namount of information through the network. Some malware authors use\nunused fields within the TCP/IP protocol header to hide data.\n\nIn some cases, malware hides its control server traffic within simple DNS and\nHTTP requests. The malware sends requests for nonexistent domains from\na hardcoded DNS server that is the actual control server. The commands are\nembedded and obfuscated using a simple Base64-encoding technique within\nthe DNS response.\n\n[We analyzed TeslaCrypt, which uses HTTP error messages to hide its](https://securingtomorrow.mcafee.com/mcafee-labs/teslacrypt-arrives-via-neutrino-exploit-kit/)\ncommunications and is downloaded through the Neutrino exploit kit.\n\n\n-----\n\nFigure 48: Initially, the TeslaCrypt ransomware payload communicates with a remote server\nthrough Base64-encoded messages with “404” error messages.\n\nIn the comments section of the HTML page, which is Base64-encoded, we\nfound “<!—c3VjY2Vzcw==—>,” which decodes to the response “success.”\n\nThen the malware responds with the following encoded data, as shown in the\nnext figure.\n\n\ncmd&<GUID of Machine >&<Logged-in Username: System Name: Domain\nName>&<Windows Version and Platform> &<AV product Info>&<Date and\nTime of Execution>\n\n\nFigures 49–50: Malware response to a successful infection.\n\n\nShare this Report\n\n\n-----\n\nFigure 51: In reply, the malware receives another Base64-encoded 404 error message with a\ndownloading link.\n\nThe decoded string has the following format:\n\n\n<random ldap timestamp>#<>#<>#LOADER hxxp://103.*****.148/*****.\nexe#\n\n\n###### Conclusion\n\nSteganography will continue to become more popular. It is an old technique\nthat is once again showing its effectiveness. Because steganography can often\nbypass antimalware detections, more threats will use this technique.\n\n**Policies and procedures**\n\n    - Tighten software delivery and distribution mechanisms used\nto protect against insider threats. Maintain a central repository\nof trusted corporate applications where users can download\napproved software. Do not allow users to download software from\nunknown sources.\n\n    - With the help of image editing software, look for steganography\nmarkers such as slight color differences in images. Also, a large\nnumber of duplicate colors in an image could be an indicator of a\nsteganographic attack.\n\n    - Control the use of steganographic software. The presence of\nsteganography software on any corporate system should be\nprohibited unless specifically required for business purposes.\nDeploy this type of software only in a contained network segment.\n\n    - Install only applications with trusted signatures from trusted\nvendors.\n\n\nShare this Report\n\n\n-----\n\n**To learn how McAfee products**\n**can help protect against**\n**[steganographic threats, click](https://www.mcafee.com/common/js/asset_redirect.html?eid=17BR_TRGLQ2_WP_WW-4&url=http://www.mcafee.com/us/resources/solution-briefs/sb-quarterly-threats-jun-2017-2.pdf)**\n**[here.](https://www.mcafee.com/common/js/asset_redirect.html?eid=17BR_TRGLQ2_WP_WW-4&url=http://www.mcafee.com/us/resources/solution-briefs/sb-quarterly-threats-jun-2017-2.pdf)**\n\nShare this Report\n\n\n\n    - Configure antimalware to detect binders. Antimalware software\nshould be configured to identify the presence of binders where\nsteganographic images could be contained.\n\n    - If a steganographic attack is successful, a virtualized system\narchitecture combined with proper network segmentation may\nhelp contain an outbreak because the secure and verifiable boot\nprocess used by virtualized systems and continuous network traffic\nmonitoring helps isolate applications.\n\n    - Monitor outbound traffic. Identify the presence of successful\nsteganographic attacks by monitoring outbound traffic.\n\nTo learn how McAfee products can help protect against steganographic\n[threats, click here.](https://www.mcafee.com/common/js/asset_redirect.html?eid=17BR_TRGLQ2_WP_WW-4&url=http://www.mcafee.com/us/resources/solution-briefs/sb-quarterly-threats-jun-2017-2.pdf)\n\n\n-----\n\nAs more sensitive information\nis moved to the passwordprotected cloud, the value of\nstolen credentials has increased.\nAs a result, password stealers\nhave become more popular.\n\nFareit, one of the top password\nstealers, can snatch credentials\nfrom more than 100 applications.\n\nShare this Report\n\n\n#### The growing danger of Fareit, the password stealer\n\n_—RaviKant Tiwari and Yashashree Gund_\n\nWe live in an era in which many people are developing increasingly dependent\nrelationships with their personal electronic devices. This trend makes it more\nimportant than ever that we protect this connection from threats. Credentials\nare our primary method of security and have thus become a primary attack\nvector for cybercriminals intent on profiting from those relationships.\n\nUnfortunately, human behavior is the weakest link in those relationships.\nMost people minimize the importance of good security hygiene. They do not\ntake care when creating passwords, thereby exposing themselves to bruteforce attacks. Even worse, they sometimes do not protect themselves at all by\nnot setting or changing default passwords. This behavior gives rise to attacks\n[such as the Mirai botnet, which we highlighted in the McAfee Labs Threats](https://www.mcafee.com/us/resources/reports/rp-quarterly-threats-mar-2017.pdf)\n_[Report: April 2017.](https://www.mcafee.com/us/resources/reports/rp-quarterly-threats-mar-2017.pdf)_\n\nGradually, cloud computing is changing the way we use computers. It is\nincreasingly common among consumers and businesses to store important\ninformation and services in the cloud. Yet we generally use the same\ncredentialing scheme, subject to the same weaknesses in human behavior, to\ngain access to cloud-based information and services. And because the data\nand computing are centralized, the cloud has become an ever more attractive\ntarget for cybercriminals.\n\n[As we foresaw in the McAfee Labs 2017 Threats Prediction Report, malware that](https://www.mcafee.com/us/resources/reports/rp-threats-predictions-2017.pdf)\ntargets credential theft will become increasingly important until we develop a\nbetter approach to credentials.\n\n**Using password stealers for credential theft**\nPassword stealers are used in the early stages of nearly all major advanced\npersistent threats. This type of malware adds economic value to the overall\nattack lifecycle. Lateral malware movement in networks is mainly dependent\non credentials harvested by password stealers.\n\nNew password-stealing malware variants have enhanced their capabilities\nfrom grabbing banking credentials to Bitcoins and gaming currency. Fareit,\nalso known as Pony, is one of the top malware families currently used for\nstealing passwords; it can snatch credentials from more than 100 applications,\nincluding email, FTP, instant messaging, VPN, web browsers, and many more.\n\nThe following graph shows the number of unique Fareit incident submissions\nreceived by McAfee Labs during the past three years.\n\n\n-----\n\n1,800\n\n1,600\n\n1,400\n\n1,200\n\n1,000\n\n800\n\n600\n\n400\n\n200\n\n0\n\n###### Origin\n\n\n###### Fareit Customer Incidents\n\nQ1 Q2 Q3 Q4 Q1 Q2 Q3 Q4 Q1\n2015 2016 2017\n\nSource: McAfee, 2017.\n\n|Col1|Col2|Col3|\n|---|---|---|\n||||\n||||\n||||\n||||\n||||\n||||\n||||\n||||\n|Q1 Q2 Q3 Q4 2015|Q1 Q2 Q3 Q4 2016|Q1 2017|\n\n\nFareit was first discovered in 2011 by Microsoft. Fareit’s robustness and strong\ncapabilities have made it the most popular password-stealing malware for\nmore than five years.\n\nThe following graph shows unique Fareit detections from McAfee and\nMicrosoft sources, ranging from 2011–2017.\n\n###### New Fareit Detections\n\n160,000\n\n140,000\n\n120,000\n\n100,000\n\n80,000\n\n60,000\n\n40,000\n\n20,000\n\n0\n\n\n2011 2012 2013 2014 2015 2016 2017\n\n\nShare this Report\n\n\nSource: McAfee and Microsoft, 2017.\n\n\n-----\n\nOne of the most popular\nmethods to distribute Fareit is\nthrough phishing campaigns.\n\nShare this Report\n\n\nThe following heat map shows the intensity of distribution of Fareit control\nservers in Q1 2017.\n\n###### Fareit Control Server Heat Map\n\nHigh intensity Medium intensity Low intensity\n\nSource: Cybercrime Tracker.\n\nThe earliest tracked version of Fareit was Version 1.7, which included most of\nthe capabilities that the latest version, 2.2, possesses today.\n\nFareit (we will use Fareit and Pony interchangeably to reference this family\nof malware) is among the most successful password-stealing software\never developed. This success story has led to its use in almost all major\ncyberattacks whose intent is to steal sensitive information.\n\nIn this report, we will discuss the evolution of Fareit and its association with\nother malware across different platforms. We will also explain the likely use of\nthis ageless malware in the US Democratic National Committee (DNC) attack\nlast fall.\n\n###### Infection vectors\n\nFareit spreads through mechanisms such as phishing/spam email, DNS\npoisoning, and exploit kits.\n\n**Spam**\nThe following diagram shows how spam campaigns distribute Fareit. The\nvictim receives a malicious spam email containing a Word document,\nJavaScript, or archive file as an attachment. Once the user opens the\nattachment, Fareit infects the system. It then downloads additional malware\nbased on its current campaign and sends stolen credentials to the control\nserver.\n\n\n-----\n\nGet\n\n\nFareit infects\nsystem\n\n\nOther campaign\nmalware hosted\non infected sites\n\nFareit control\nserver\n\n\n**DNS poisoning**\nIn this technique, malware such as Rbrut gains router administration access\nthrough a brute-force attack. It then changes the primary DNS settings and\nredirects infected systems to rogue DNS servers.\n\nThe rogue DNS servers redirect users to malicious websites, which deliver\nFareit.\n\n\nHost system Router DNS server\ninfected with Rbrut settings page\n\n###### Bot and control server architecture\n\n\nRogue DNS\nserver\n\nFareit hosted\non rogue server\n\n\nAttackers can purchase Fareit\ncode on the dark web or they\ncan purchase a Fareit control\npanel service hosted by another\nattacker.\n\nShare this Report\n\n\nUnlike most botnets, which are operated by specific groups and have\ncentralized control servers, Pony can be purchased by any willing attacker\non the dark web. The purchaser sets up a personal control server to start\nthe attack process or purchases a control panel service hosted by another\nattacker. The purchased panel provides the stolen credential reports.\n\nThe Pony project is divided into three parts:\n\n    - Pony Builder (PonyBuilder.exe): A set of programs for creating the\nbuild-client “Pony Bot,” which is built using the masm32 compiler,\nincluded in the package.\n\n    - Pony Bot: A client that must be downloaded to target systems, to\ncollect and send passwords to the control server.\n\n    - A set of server-side PHP scripts: Includes an administration panel\nand a script gate (gate.php), to which stolen passwords are sent.\n\n\n-----\n\nMalware Malware attacker\nauthor Sets up control server,\nuses Pony Builder to\nbuild Pony Bot EXE/DLL\n\n\nControl\nserver\n\nPony Bot distribution network\n\n\nPony Builder\n\nPony Bot EXE/DLL\n\n\nPony Bot infected\nsystems\n\n|ny Builder|Col2|\n|---|---|\n\n\n**Pony Builder: This tool allows attackers to create their own Pony Bot. They**\ncan specify the control server address to which stolen credentials and other\nstats will be sent by the bot.\n\nFigure 52: Pony Builder source files.\n\n\nShare this Report\n\n\n-----\n\nFigure 53: Pony Builder user interface.\n\n**Pony Bot: This is the program cybercriminals use to spread the malware client**\nthat steals passwords from victims. Pony Bot has several capabilities:\n\n    - Steal passwords\n\n    - Download and execute arbitrary malware\n\n    - Perform DDoS attacks\n\n    - Steal cryptocurrency wallets\n\n    - Steal FTP credentials\n\nPony Bot is mostly coded in assembly language and can be released in either\nDLL or EXE format. This provides Fareit with the flexibility to morph and serve\na variety of purposes.\n\nTo collect passwords, Pony Bot uses a nonstandard approach. When the\nclient starts, it automatically collects stolen passwords and necessary data for\ndecryption into special container files called reports and transfers them to the\nserver, where they are decrypted. Each report can contain dozens and even\nhundreds of passwords, as well as other supporting information.\n\nThe Pony Bot client does not contain any decryption algorithms, only simple\nfunctions for reading files and registry data. All password decryption is\nperformed by the web server. This is not a resource-intensive operation\nbecause most of the encryption algorithms are trivial. A decryption server\nspends on average fewer than 10ms processing a report containing\npasswords.\n\n\nShare this Report\n\n\n-----\n\nFareit is often incorporated into\nattack sequences by campaign\nauthors.\n\nShare this Report\n\n\nFigure 54: Different modules of the Pony Bot client.\n\nFigure 55: These modules contain necessary code that Pony Bot requires to successfully\ncompile.\n\nMany campaign authors incorporate Fareit into their attack methodologies.\nFor example, we saw the author of the Andromeda botnet (also known as\nGamarue) refer to Fareit as the “titanic work of the author of miracle (Fareit\nBot)” when someone asked him to create a password stealer for Andromeda.\nThe Andromeda author demonstrated how to make Pony into a plug-in for the\nAndromeda botnet.\n\nPony variants have different purposes. We will discuss later how Pony\nwas crafted for the DNC attack, packaging just code to steal user and FTP\npasswords.\n\n\n-----\n\n###### Inner workings\n\nThe Fareit bot starts by executing anti-disassembly and anti-emulation\ntechniques at the beginning of each module. It then initializes API addresses to\ncarry out various operations. Fareit tries to impersonate a privileged process\nby acquiring the local user token of the account from which it is currently\nexecuting. This user is ignored in a brute-force procedure performed in a later\nstage. Next, Fareit decrypts the stored word list that it uses to brute force\nother available users on the victim’s system. Once the decryption is complete,\nit starts the ScanAndSend stealing routine in the current user’s context and\nsends all stolen credentials to the control server. After that, it runs the loader\ncomponent of the bot to download and execute more malware, which may be\npart of its pay-per-install campaign.\n\nNext, Fareit terminates its current impersonation and tries to impersonate\nother users on the victim’s system. To achieve this, Fareit attempts to login to\nthe account using the “username: username” pair, the “username: lowercase\nusername” pair, and finally the deciphered word list as the password\nfor this username. Once the login is successful and the Fareit process is\nimpersonating the logged-in user, it again executes ScanAndSend under the\ncontext of this additional user.\n\nsamantha rainbow nicole football1 sunshine windows\nmichelle 112233 guitar 11111111 christ 123abc\ndavid nintendo billga power 000000 lucky\neminem peanut tes thunder soccer anthony\nscooter none looking gateway qwerty1 jesus\nasdfasdf church scooby iloveyou! friend admin\nsammy bubbles joseph football summer hotdog\nbaby robert genesis tigger 1234567 base\ndiamond 222222 forum corvet merlin ball\nmaxwell destiny emmanue teangel phpbb password\n55555 loving cassie killer 12345678 dragon\njustin gfhjkm victory creative jor trustno1\njames mylove passw0rd 12345678 dan jason\nchicken jasperh foobar google saved internet\ndaniellei allo nathan zxcvbnm dexter batman\nloveyou2 123321 blabla startrek viper 123456\nprince cocacola digital ashley winner single\njunior helpme peaches cheesea sparky apple\n\nFigure 56: A partial Word list for brute-force attacks on local usernames.\n\n\nShare this Report\n\n\n-----\n\nFareit can steal credentials from a\nmultitude of applications.\n\n32-bit FTP\n3D FTP\nALFTP\nBitKinex\nBlaze FTP\n\nClassicFTP\n\nCore FTP\nCuteFTP\nDirect FTP\nEasy FTP\nExpanDrive\n\nShare this Report\n\n\n**Stealing behavior**\nFareit tries to steal saved passwords from browsers. It also tries to steal stored\naccount information such as server names, port numbers, login IDs, and\npasswords from the following FTP clients or cloud storage programs:\n\nFFFTP FlingFTP WS_FTP\nFTP++ Free FTP Web Site Publisher\nFTP Client Frigate FTP WebDrive\nFTP Commander FTP LeapFTP WinSCP\nControl Leech FTP Windows Commander\nFTP Explorer NetDrive Wise-FTP\nFTP Navigator Opus\nFTP Now Robo FTP\nFTP Rush SecureFX\nFTP Voyager SmartFTP\nFar FTP Total Commander\nFileZilla TurboFTP\nFlashFxp UltraFXP\n\n###### Fareit Execution Flow\n\n\n-----\n\nShare this Report\n\n\n**Control panel: The Pony control panel enables the attacker to view and**\nmanage information sent by the bot.\n\nFigure 57: The control panel has tabs to access different information and statistics collected\nby the Pony Bot.\n\nThe tabs perform the following functions:\n\n    - **Home: General information about the ongoing work of the server.**\n\n    - **List of FTP: Download or clear the lists obtained by FTP/SFTP.**\n\n    - **HTTP Passwords: Download or clear the password list obtained by**\nHTTP.\n\n    - **Others: Download or clear the lists of received certificates.**\n\n    - **Statistics: Current numbers on the data collected. (Cleaning the**\nFTP list resets the statistics report.)\n\n    - **Domains: Add a backup domain grabber for the operational test**\nfor accessibility.\n\n    - **Logs: See the critical-error-and-notification server.**\n\n    - **Reports: List of current passwords.**\n\n    - **Management: Server settings and account management.**\n\n    - **Help: Shows various functions provided by bot and control panel.**\n\n    - **Log Out: Exit from the admin panel.**\n\n\n-----\n\nFigures 58–60: Other operating system and new stolen password–related stats on the\ncontrol server.\n\nThe Pony control panel has administrator and user modes, allowing the Pony\nbotnet to be delivered as a service.\n\nAdministrator mode can do everything: delete or add new users, change\nserver settings (including the report encryption password), change privileges\nor passwords of other users, clear lists with passwords. There can be only one\nadministrator.\n\nOther users, depending on their privileges, can either view the data (user_\nview_only), or browse and clean the FTP/SFTP lists, reports, and logs. Users\ncan also change their passwords. Users cannot see the functions available\nonly to the administrator.\n\n\nShare this Report\n\n\n-----\n\nFigures 61–62: Two examples of Pony control panels for sale.\n\n**Fareit report contents**\nStolen credentials are contained in an encrypted report file. Each report also\ncontains additional information:\n\n    - **OS: Windows version.**\n\n    - **IP: Address of the sender.**\n\n    - **HWID: A unique user identifier that does not change. With this ID,**\nyou can find all the reports from a specific system.\n\n    - **Privileges: Rights (user or admin) with which the Pony Bot process**\nis started.\n\n    - **Architecture: x86 and 32-/64-bit architecture of the CPU on which**\nPony.exe was launched.\n\n    - **Version: Pony Bot client version.**\n\n\nShare this Report\n\n\n-----\n\nFareit has become more evasive\nand more sophisticated over\ntime. It is now one of the most\npowerful password stealers.\n\nShare this Report\n\n\nFigure 63: The attacker’s view of the report file with information stolen from the infected\nsystem. These include FTP credentials, saved passwords from browser, email passwords,\nand others.\n\n###### Evolution\n\nIn late 2011, Microsoft detected and named the new password stealer PWS:\nWin32/Fareit. We believe that Fareit was incomplete at that time and was\nprobably in its testing phase of development.\n\n###### Evolution of Fareit, aka Pony\n\n\nFareit credentialstealing module\nspotted with\nStegoloader\n\n\nFareit downloads\nMedfos, Nymaim,\nspreads through\nspam campaign\n\n2012 2013\n\nFareit starts\nBitcoin mining\n\n\nLock screen\nransomware\nuses Fareit for\ncredential theft\n\n\nPony Loader\n2.0 source\ncode leak\n\n\nFareit spreads\nusing W97,\nPowerShell,\nJavaScript, MHT\n\n\nBHEK spreading\nFareit with Zeus,\nFakeAV\n\n\nPony Loader 2.0\ncapable of Bitcoin\nwallet stealing\n\n\nDNC attack\nwith Onion\nDuke\n\n\nMany customised\nPony Loader variants\navailable, up to Pony\nLoader 2.2\n\nSource: McAfee, 2017.\n\n\n-----\n\nFigures 64–65: Screen shots of Fareit malware, detected in 2011, showing the stolen\ninformation from the infected endpoint.\n\nShortly after its discovery, Fareit V1.7 was offered for sale by its author on\nmany underground forums. It was loaded with powerful features that led to\nquick growth.\n\n###### Avoiding detection\n\nAs Fareit evolved, the malware’s author implemented many anti-disassembly\nand anti-debugging techniques to prevent easy analysis of the bot.\n\nIn addition to the basic detection-avoidance mechanisms implemented by\nFareit’s author, individual owners can add packers such as ASProtect as well as\ncustom packers to prevent detection by antimalware signatures.\n\n**Anti-Disassembly: The following is an example of an anti-disassembly**\ntechnique that attempts to confuse a recursive traversal disassembly\nalgorithm, which tries to follow the program control flow and disassemble\ninstructions at a certain location.\n\nIn this snippet, the “jb” instruction transfers control to address 0x41062e. The\ndisassembler assumes this location contains code and tries to disassemble it.\nAn attacker sometimes places junk bytes that cannot be disassembled at this\ncode location, causing the disassembly to fail.\n\nThe actual control transfer in the code takes place by the “push” and “retn”\ninstructions at 0x00410625 and 0x0041062d, respectively.\n\n\nShare this Report\n\n\n-----\n\n**Anti-Emulation: Fareit also employs anti-emulation to bypass many**\nantimalware heuristic detection mechanisms. This technique consumes\nemulation cycles by entering large loops. The preceding loop executes until\nthe number of milliseconds elapsed since the computer was started when\ndivided by 10 does not give a remainder of 5. As the probability of getting 5 as\na remainder is small, the loop will continue for a long period, thus stalling the\nexecution.\n\n**Packers: We have seen samples using a unique stub generation (USG) crypter**\nto encrypt the Pony Bot executable and further pack it with AsProtect and\ncustom packers. (A custom packer can use many compilers to generate\nexecutables. Common compilers include Visual Basic and .Net.) We have also\nseen the Pony Bot executables compiled with the AutoIt script.\n\nFigure 66: We found the USG crypter for $45 for new users and $25 per month for renewals.\n\n\nShare this Report\n\n\n-----\n\nFareit was likely used to steal\nemail, FTP, and other important\ncredentials during the U.S.’s\nDemocratic National Committee\nbreach in 2016.\n\nShare this Report\n\n\n###### The DNC attack\n\nThe Democratic National Committee breach in 2016 in the United States has\nbeen attributed to a malware campaign known as Grizzly Steppe.\n\nGrizzly Steppe targets government organizations, critical infrastructure\ncompanies, think tanks, political organizations, and corporations around\nthe world. It uses tactics such as shortened URLs, spear phishing, lateral\nmovement, and escalating privileges to infect systems and networks.\n\nAccording to published reports, the Grizzly Steppe campaign ran in two\nphases. In 2015, it executed a spear phishing campaign to send malicious\nlinks redirecting to malware downloads. Then in 2016, it tricked people\ninto changing passwords through fake lookalike domains. Credentials and\nother information (including emails) were stolen from victims’ systems and\npublished in the public domain.\n\nWe found Fareit hashes in the indicators of compromise list published by the\n[US government in its Grizzly Steppe report.](https://www.us-cert.gov/sites/default/files/publications/JAR_16-20296A_GRIZZLY STEPPE-2016-1229.pdf)\n\nFareit was likely used in conjunction with other techniques in the DNC attack\nto steal email, FTP, and other important credentials and used them to carry\nout further attacks.\n\n\n-----\n\nWe suspect that Fareit was also used to download APT threats such as Onion\nDuke and Vawtrak onto the victims’ systems to carry out further attacks. We\nfound the following URLs for downloading and executing used by Fareit’s\nloader component:\n\n    - hxxp://one2shoppee.com/system/logs/xtool.exe\n\n    - hxxp://insta.reduct.ru/system/logs/xtool.exe\n\n    - hxxp://editprod.waterfilter.in.ua/system/logs/xtool.exe\n\nIn our analysis, we found that Fareit malware believed to be specific to the\nDNC attack was dropped by malicious Word documents. These files were\nspread through phishing email campaigns.\n\nThe following code shows credential-stealing subroutines or modules found\nin a Fareit sample likely used in the DNC attack. The number of credentialstealing modules is significantly lower in this sample than in most Fareit\nsamples. The attackers may have concluded that some were irrelevant for this\nattack.\n\nFigure 67: Hardcoded addresses of credential-stealing modules from a Fareit sample likely\nused in the DNC attack.\n\n\nShare this Report\n\n\n-----\n\nShare this Report\n\n\nFigure 68: Credential-stealing modules generally found in the wild.\n\nNext called function address will be\nreferenced here\n\nFigure 69: This code calls all the credential-stealing subroutines shown in Figure 63. This\ncode is not specific to the Fareit sample likely used in the DNC attack but is common in\nother Fareit samples.\n\n\nNext called function address will be\nreferenced here\n\n\n-----\n\n**Network activity in the DNC attack**\nLet’s look at two snippets of code from a Fareit sample likely used in the\nDNC attack. Each control server address is called in a loop. It checks for the\n“STATUS-IMPORT-OK” string in the control server’s response. The loop will go\non to the next URL if this response is not received.\n\nFigure 70: This subroutine found in a Fareit sample likely used in the DNC attack is responsible\nfor connecting to different control servers in case the current URL is unresponsive.\n\nThe Fareit malware likely used in the DNC attack references multiple control\nserver addresses that are not commonly observed in Fareit samples found in\nthe wild:\n\n    - hxxp://wilcarobbe.com/zapoy/gate.php\n\n    - hxxp://littjohnwilhap.ru/zapoy/gate.php\n\n    - hxxp://ritsoperrol.ru/zapoy/gate.php\n\n\nShare this Report\n\n\n-----\n\nFigure 71: This subroutine found in a Fareit sample likely used in the DNC attack can be\nused to download additional malware.\n\nThe Fareit sample likely used in the DNC attack can download additional\nmalware from these locations:\n\n    - hxxp://one2shoppee.com/system/logs/xtool.exe\n\n    - hxxp://insta.reduct.ru/system/logs/xtool.exe\n\n    - hxxp://editprod.waterfilter.in.ua/system/logs/xtool.exe\n\n\nShare this Report\n\n\n-----\n\n**To learn how McAfee products**\n**can help protect against**\n**[password stealers, click here.](https://www.mcafee.com/common/js/asset_redirect.html?eid=17BR_TRGLQ2_WP_WW-7&url=http://www.mcafee.com/us/resources/solution-briefs/sb-quarterly-threats-jun-2017-3.pdf)**\n\nShare this Report\n\n\n###### Policies and procedures\n\nYou can take several steps to avoid infection by threats such as Fareit.\n\n    - **Create strong passwords and change them regularly. The**\nlonger and more varied a password, the stronger it is. Incorporate\nnumbers, uppercase and lowercase letters, and special characters.\nWe also recommended changing passwords two to three times\nper year, and immediately after any breach. If this sounds like too\nmuch to track, consider using a password management tool.\n\n    - **Use different passwords for every account or service. This**\nprevents access to other accounts and services even if one account\nis compromised.\n\n    - **Employ multifactor authentication. In the event of a**\ncompromised account, the attacker will not be able to access the\naccount until the next authentication factor is verified.\n\n    - **Do not use public computers for anything that requires a**\n**password. Avoid using systems in coffee shops, libraries, or other**\npublic Wi-Fi locations because those networks are susceptible to\nkeystroke-logging software and other types of malware.\n\n    - **Be extra cautious when opening email attachments. This is a**\nbig one! Do not open any strange-looking attachments or click on\nlinks from suspicious or unknown senders. Even if the attachment\nor link is received from a friend, make sure that the email or social\nnetwork post does not look questionable before clicking on it. This\nperson may have already had their account compromised.\n\n    - **Install comprehensive security on all devices. Practice basic**\nsecurity hygiene such as keeping security software up to date. This\nsimple step significantly reduces the chance of being infected by\nFareit or other malware.\n\nTo learn how McAfee products can help protect against password stealers,\n[click here.](https://www.mcafee.com/common/js/asset_redirect.html?eid=17BR_TRGLQ2_WP_WW-7&url=http://www.mcafee.com/us/resources/solution-briefs/sb-quarterly-threats-jun-2017-3.pdf)\n\n\n-----\n\n## Threats Statistics\n\nShare feedback\n\n\nMalware\n\nIncidents\n\nWeb and Network Threats\n\n\n-----\n\n###### New Malware\n\n\nNew malware counts rebounded\nto the quarterly average we have\nseen during the past four years.\n\nShare this Report\n\n\n#### Malware\n\n40,000,000\n\n35,000,000\n\n30,000,000\n\n25,000,000\n\n20,000,000\n\n15,000,000\n\n10,000,000\n\n5,000,000\n\n0\n\n|Col1|Col2|Col3|\n|---|---|---|\n||||\n||||\n||||\n||||\n||||\n||||\n||||\n|Q1 Q2 Q3 Q4 2015|Q1 Q2 Q3 Q4 2016|Q1 2017|\n\n\n700,000,000\n\n600,000,000\n\n500,000,000\n\n400,000,000\n\n300,000,000\n\n200,000,000\n\n100,000,000\n\n0\n\n\nQ1 Q2 Q3 Q4 Q1 Q2 Q3 Q4 Q1\n2015 2016 2017\n\nSource: McAfee Labs, 2017.\n\n###### Total Malware\n\nQ1 Q2 Q3 Q4 Q1 Q2 Q3 Q4 Q1\n2015 2016 2017\n\nSource: McAfee Labs, 2017.\n\n|Col1|Col2|Col3|\n|---|---|---|\n||||\n||||\n||||\n||||\n||||\n||||\n|Q1 Q2 Q3 Q4 2015|Q1 Q2 Q3 Q4 2016|Q1 2017|\n\n\n-----\n\n2,500,000\n\n2,000,000\n\n1,500,000\n\n1,000,000\n\n500,000\n\n0\n\n18,000,000\n\n16,000,000\n\n14,000,000\n\n12,000,000\n\n10,000,000\n\n8,000,000\n\n6,000,000\n\n4,000,000\n\n2,000,000\n\n0\n\n\n###### New Mobile Malware\n\nQ1 Q2 Q3 Q4 Q1 Q2 Q3 Q4 Q1\n2015 2016 2017\n\nSource: McAfee Labs, 2017.\n\n###### Total Mobile Malware\n\nQ1 Q2 Q3 Q4 Q1 Q2 Q3 Q4 Q1\n2015 2016 2017\n\nSource: McAfee Labs, 2017.\n\n|Col1|Col2|Col3|\n|---|---|---|\n||||\n||||\n||||\n||||\n|Q1 Q2 Q3 Q4 2015|Q1 Q2 Q3 Q4 2016|Q1 2017|\n\n|Col1|Col2|Col3|\n|---|---|---|\n||||\n||||\n||||\n||||\n||||\n||||\n||||\n||||\n|Q1 Q2 Q3 Q4 2015|Q1 Q2 Q3 Q4 2016|Q1 2017|\n\n\nShare this Report\n\n\n-----\n\nSouth\nAmerica\n\n\n###### Regional Mobile Malware Infection Rates \n(percentage of mobile customers reporting infections)\n\nAfrica Asia Australia Europe North\nAmerica\n\n\nMobile malware reports from\nAsia doubled in Q1, contributing\nto a 62.5% increase in global\ninfection rates. (See next chart.)\nThe largest contributor is\nAndroid/SMSreg, a potentially\nunwanted program detection\nfrom India.\n\nShare this Report\n\n\n22%\n\n20%\n\n18%\n\n14%\n\n12%\n\n10%\n\n8%\n\n6%\n\n4%\n\n2%\n\n0\n\n\nQ1 2016 Q2 2016 Q3 2016 Q4 2016 Q1 2017\n\nSource: McAfee Labs, 2017.\n\n###### Global Mobile Malware Infection Rates \n(percentage of mobile customers reporting infections)\n\n14%\n\n12%\n\n10%\n\n8%\n\n6%\n\n4%\n\n2%\n\n0\n\nQ1 Q2 Q3 Q4 Q1 Q2 Q3 Q4 Q1\n2015 2016 2017\n\nSource: McAfee Labs, 2017.\n\n|Col1|Col2|Col3|\n|---|---|---|\n||||\n||||\n||||\n||||\n||||\n||||\n|Q1 Q2 Q3 Q4 2015|Q1 Q2 Q3 Q4 2016|Q1 2017|\n\n\n-----\n\n###### New Mac OS Malware\n\nQ1 Q2 Q3 Q4 Q1 Q2 Q3 Q4 Q1\n2015 2016 2017\n\nSource: McAfee Labs, 2017.\n\n###### Total Mac OS Malware\n\nQ1 Q2 Q3 Q4 Q1 Q2 Q3 Q4 Q1\n2015 2016 2017\n\nSource: McAfee Labs, 2017.\n\n\nDuring the past three quarters,\nnew Mac OS malware has been\nboosted by a glut of adware.\n\nShare this Report\n\n\n350,000\n\n300,000\n\n250,000\n\n200,000\n\n150,000\n\n100,000\n\n50,000\n\n0\n\n800,000\n\n700,000\n\n600,000\n\n500,000\n\n400,000\n\n300,000\n\n200,000\n\n100,000\n\n0\n\n|Col1|Col2|Col3|\n|---|---|---|\n||||\n||||\n||||\n||||\n||||\n||||\n|Q1 Q2 Q3 Q4 2015|Q1 Q2 Q3 Q4 2016|Q1 2017|\n\n|Col1|Col2|Col3|\n|---|---|---|\n||||\n||||\n||||\n||||\n||||\n||||\n||||\n|Q1 Q2 Q3 Q4 2015|Q1 Q2 Q3 Q4 2016|Q1 2017|\n\n\n-----\n\n###### New Ransomware\n\nQ1 Q2 Q3 Q4 Q1 Q2 Q3 Q4 Q1\n2015 2016 2017\n\nSource: McAfee Labs, 2017.\n\n###### Total New Ransomware\n\nQ1 Q2 Q3 Q4 Q1 Q2 Q3 Q4 Q1\n2015 2016 2017\n\nSource: McAfee Labs, 2017.\n\n\nRansomware rose especially due\nto increased numbers of Congur\nransomware attacks on Android\nOS devices.\n\nShare this Report\n\n\n1,400,000\n\n1,200,000\n\n1,000,000\n\n800,000\n\n600,000\n\n400,000\n\n200,000\n\n0\n\n10,000,000\n\n9,000,000\n\n8,000,000\n\n7,000,000\n\n6,000,000\n\n5,000,000\n\n4,000,000\n\n3,000,000\n\n2,000,000\n\n1,000,000\n\n0\n\n|Col1|Col2|Col3|\n|---|---|---|\n||||\n||||\n||||\n||||\n||||\n||||\n|Q1 Q2 Q3 Q4 2015|Q1 Q2 Q3 Q4 2016|Q1 2017|\n\n|Col1|Col2|Col3|\n|---|---|---|\n||||\n||||\n||||\n||||\n||||\n||||\n||||\n||||\n||||\n|Q1 Q2 Q3 Q4 2015|Q1 Q2 Q3 Q4 2016|Q1 2017|\n\n\n-----\n\n1,400,000\n\n1,200,000\n\n1,000,000\n\n800,000\n\n600,000\n\n400,000\n\n200,000\n\n0\n\n22,000,000\n\n20,000,000\n\n18,000,000\n\n16,000,000\n\n14,000,000\n\n12,000,000\n\n10,000,000\n\n8,000,000\n\n6,000,000\n\n4,000,000\n\n2,000,000\n\n0\n\n\n###### New Malicious Signed Binaries\n\nQ1 Q2 Q3 Q4 Q1 Q2 Q3 Q4 Q1\n2015 2016 2017\n\nSource: McAfee Labs, 2017.\n\n###### Total Malicious Signed Binaries\n\nQ1 Q2 Q3 Q4 Q1 Q2 Q3 Q4 Q1\n2015 2016 2017\n\nSource: McAfee Labs, 2017.\n\n|Col1|Col2|Col3|\n|---|---|---|\n||||\n||||\n||||\n||||\n||||\n||||\n|Q1 Q2 Q3 Q4 2015|Q1 Q2 Q3 Q4 2016|Q1 2017|\n\n|Col1|Col2|Col3|\n|---|---|---|\n||||\n||||\n||||\n||||\n||||\n||||\n||||\n||||\n||||\n||||\n|Q1 Q2 Q3 Q4 2015|Q1 Q2 Q3 Q4 2016|Q1 2017|\n\n\nShare this Report\n\n\n-----\n\n225,000\n\n200,000\n\n175,000\n\n150,000\n\n125,000\n\n100,000\n\n75,000\n\n50,000\n\n25,000\n\n0\n\n1,050,000\n\n900,000\n\n750,000\n\n600,000\n\n450,000\n\n300,000\n\n150,000\n\n0\n\n\n###### New Macro Malware\n\nQ1 Q2 Q3 Q4 Q1 Q2 Q3 Q4 Q1\n2015 2016 2017\n\nSource: McAfee Labs, 2017.\n\n###### Total Macro Malware\n\nQ1 Q2 Q3 Q4 Q1 Q2 Q3 Q4 Q1\n2015 2016 2017\n\nSource: McAfee Labs, 2017.\n\n|Col1|Col2|Col3|\n|---|---|---|\n||||\n||||\n||||\n||||\n||||\n||||\n||||\n||||\n|Q1 Q2 Q3 Q4 2015|Q1 Q2 Q3 Q4 2016|Q1 2017|\n\n|Col1|Col2|Col3|\n|---|---|---|\n||||\n||||\n||||\n||||\n||||\n||||\n|Q1 Q2 Q3 Q4 2015|Q1 Q2 Q3 Q4 2016|Q1 2017|\n\n\nShare this Report\n\n\n-----\n\n#### Incidents\n\n###### Publicly Disclosed Security Incidents by Region\n(number of publicly disclosed security incidents)\n\n\n300\n\n250\n\n\n200\n\n150\n\n\n100\n\n50\n\n\n0\n\n180\n\n\nQ1 Q2 Q3 Q4 Q1\n2016 2017\n\n|Col1|Col2|\n|---|---|\n|||\n|||\n|||\n|||\n|||\n|Q1 Q2 Q3 Q4 2016|Q1 2017|\n\n\nEurope\n\nAfrica\n\n\nAmericas Asia Oceana\n\nMultiple\n\n\n160\n\n140\n\n\n120\n\n100\n\n\n80\n\n60\n\n\n40\n\n20\n\n\n0\n\n\nSource: McAfee Labs, 2017.\n\n###### Top 10 Targeted Sectors in 2016–2017\n(number of publicly disclosed security incidents)\n\nSource: McAfee Labs, 2017.\n\n\nShare this Report\n\n\n-----\n\n###### Top 10 Sectors Targeted by Region in Q1 2017\n(number of publicly disclosed security incidents)\n\n\n210\n\n180\n\n\n150\n\n120\n\n\n90\n\n60\n\n\n30\n\n\n0\n\n450\n\n\nHealth\n\nTechnology\n\n\nPublic Education Finance\n\n\nEntertainment\n\n\nHospitality Online Services\n\n\nManufacturing Nonprofit\n\n\n400\n\n350\n\n\n300\n\n250\n\n\n200\n\n150\n\n\n100\n\n50\n\n\n0\n\n\nSource: McAfee Labs, 2017.\n\n###### Top 10 Attack Vectors in 2016–2017\n(number of publicly disclosed security incidents)\n\nSource: McAfee Labs, 2017.\n\n\nShare this Report\n\n\n-----\n\n#### Web and Network Threats\n\n###### New Suspect URLs\n\n30,000,000\n\n25,000,000\n\n20,000,000\n\n15,000,000\n\n10,000,000\n\n5,000,000\n\n0\n\nQ1 Q2 Q3 Q4 Q1 Q2 Q3 Q4 Q1\n2015 2016 2017\n\nSource: McAfee Labs, 2017.\n\n###### New Phishing URLs\n\n1,400,000\n\n1,200,000\n\n1,000,000\n\n800,000\n\n600,000\n\n400,000\n\n200,000\n\n0\n\nQ1 Q2 Q3 Q4 Q1 Q2 Q3 Q4 Q1\n2015 2016 2017\n\nSource: McAfee Labs, 2017.\n\n|Col1|Col2|Col3|\n|---|---|---|\n||||\n||||\n||||\n||||\n||||\n|Q1 Q2 Q3 Q4 2015|Q1 Q2 Q3 Q4 2016|Q1 2017|\n\n|Col1|Col2|Col3|\n|---|---|---|\n||||\n||||\n||||\n||||\n||||\n||||\n|Q1 Q2 Q3 Q4 2015|Q1 Q2 Q3 Q4 2016|Q1 2017|\n\n\nShare this Report\n\n\n-----\n\n2,250,000\n\n2,000,000\n\n1,750,000\n\n1,500,000\n\n1,250,000\n\n1,000,000\n\n750,000\n\n500,000\n\n250,000\n\n0\n\n\n###### New Spam URLs\n\nQ1 Q2 Q3 Q4 Q1 Q2 Q3 Q4 Q1\n2015 2016 2017\n\nSource: McAfee Labs, 2017.\n\n###### Spam Botnet Prevalence by Volume in Q1 2017\n\n1%\n\n4%\n5% Gamut\n\n11% Cutwail\n\nNecurs\n\n54% KelihosC\n\n11%\n\nOrangeleeches\n\nLethic\n\n14%\n\nOthers\n\nSource: McAfee Labs, 2017.\n\n|Col1|Col2|Col3|\n|---|---|---|\n||||\n||||\n||||\n||||\n||||\n||||\n||||\n||||\n|Q1 Q2 Q3 Q4 2015|Q1 Q2 Q3 Q4 2016|Q1 2017|\n\n\nIn April, the mastermind\nbehind the Kelihos botnet was\n[arrested in Spain. Kelihos was](https://threatpost.com/spammers-arrest-puts-end-to-kelihos-botnet/124910/)\nresponsible over many years for\nmillions of spam messages that\ncarried banking malware and\nransomware. The US Department\n[of Justice acknowledged](https://www.justice.gov/opa/pr/justice-department-announces-actions-dismantle-kelihos-botnet-0)\ninternational cooperation\nbetween United States and\nforeign authorities, the Shadow\nServer Foundation, and industry\nvendors.\n\nShare this Report\n\n\n-----\n\n2%\n\n\n###### Top Malware Connecting to Control Servers in Q1 2017\n\n9%\n\n8%\n\nMirai\n\nWapomi\n\nOthers\n\n83%\n\nSource: McAfee Labs, 2017.\n\n###### Top Countries Hosting Botnet Control Servers in Q1 2017\n\nUnited States\n\nGermany\n\n24% China\n\nSouth Korea\n\n39%\n\nNetherlands\n\n3% Russia\n\n3%\n\nJapan\n\n4%\n\n5% United Kingdom\n5% 10%\n5%\n\nHong Kong\n\nOthers\n\nSource: McAfee Labs, 2017.\n\n\nShare this Report\n\n\n-----\n\n###### Top Network Attacks in Q1 2017\n\n\nWorm\n\nDenial of Service\n\nBrowser\n\nBrute Force\n\nSSL\n\nMalware\n\nOthers\n\nSource: McAfee Labs, 2017.\n\n\nShare this Report\n\n\n-----\n\n**Feedback. To help guide our**\nfuture work, we’re interested in\nyour feedback. If you would like\nto share your views, please [click](https://www.surveymonkey.com/r/W2SWBTX)\n[here](https://www.surveymonkey.com/r/W2SWBTX) to complete a quick, fiveminute Threats Report survey.\n\nFollow McAfee Labs\n\n**McAfee**\n2821 Mission College Boulevard\nSanta Clara, CA 95054\n888 847 8766\n[www mcafee com](http://www.mcafee.com)\n\n\n#### About McAfee\n\nMcAfee is one of the world’s leading independent cybersecurity companies.\nInspired by the power of working together, McAfee creates business\nand consumer solutions that make the world a safer place. By building\nsolutions that work with other companies’ products, McAfee helps\nbusinesses orchestrate cyber environments that are truly integrated, where\nprotection, detection and correction of threats happen simultaneously and\ncollaboratively. By protecting consumers across all their devices, McAfee\nsecures their digital lifestyle at home and away. By working with other security\nplayers, McAfee is leading the effort to unite against cybercriminals for the\nbenefit of all.\n\n[www.mcafee.com](http://www.mcafee.com)\n\nThe information in this document is provided only for educational purposes and for the convenience of McAfee\ncustomers. The information contained herein is subject to change without notice, and is provided “as is,”\nwithout guarantee or warranty as to the accuracy or applicability of the information to any specific situation\nor circumstance. McAfee and the McAfee logo are trademarks or registered trademarks of McAfee, LLC or its\nsubsidiaries in the US and other countries. Other marks and brands may be claimed as the property of others.\nCopyright © 2017 McAfee, LLC\n3142_0517_rp-threat-report-jun-2017\nJune 2017\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "6fc23d14-23a6-4870-8fad-b291b182596f",
            "created_at": "2022-10-25T16:07:18.480113Z",
            "updated_at": "2022-10-25T16:07:18.480113Z",
            "deleted_at": null,
            "name": "ETDA",
            "url": "https://apt.etda.or.th",
            "description": "Threat Group Cards: A Threat Actor Encyclopedia",
            "reports": null
        },
        {
            "id": "bf5be533-fa31-4590-ae37-5761c97ffa34",
            "created_at": "2022-10-25T16:13:58.389257Z",
            "updated_at": "2022-10-25T16:13:58.389257Z",
            "deleted_at": null,
            "name": "Malpedia",
            "url": "https://malpedia.caad.fkie.fraunhofer.de",
            "description": "Malpedia is a free service offered by Fraunhofer FKIE",
            "reports": null
        }
    ],
    "references": [
        "https://www.mcafee.com/us/resources/reports/rp-quarterly-threats-jun-2017.pdf"
    ],
    "report_names": [
        "rp-quarterly-threats-jun-2017.pdf"
    ],
    "threat_actors": [
        {
            "id": "b740943a-da51-4133-855b-df29822531ea",
            "created_at": "2022-10-25T15:50:23.604126Z",
            "updated_at": "2025-03-27T02:00:55.505366Z",
            "deleted_at": null,
            "main_name": "Equation",
            "aliases": [
                "Equation"
            ],
            "source_name": "MITRE:Equation",
            "tools": null,
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "d90307b6-14a9-4d0b-9156-89e453d6eb13",
            "created_at": "2022-10-25T16:07:23.773944Z",
            "updated_at": "2025-03-27T02:02:09.974695Z",
            "deleted_at": null,
            "main_name": "Lead",
            "aliases": [
                "Casper",
                "TG-3279"
            ],
            "source_name": "ETDA:Lead",
            "tools": [
                "Agentemis",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "RbDoor",
                "RibDoor",
                "Winnti",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "dcba8e2b-93e0-4d6e-a15f-5c44faebc3b1",
            "created_at": "2022-10-25T16:07:23.816991Z",
            "updated_at": "2025-03-27T02:02:09.991944Z",
            "deleted_at": null,
            "main_name": "Lurk",
            "aliases": [],
            "source_name": "ETDA:Lurk",
            "tools": [],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "a3687241-9876-477b-aa13-a7c368ffda58",
            "created_at": "2022-10-25T16:07:24.496902Z",
            "updated_at": "2025-03-27T02:02:10.256629Z",
            "deleted_at": null,
            "main_name": "Hacking Team",
            "aliases": [],
            "source_name": "ETDA:Hacking Team",
            "tools": [],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "e90c06e4-e3e0-4f46-a3b5-17b84b31da62",
            "created_at": "2023-01-06T13:46:39.018236Z",
            "updated_at": "2025-03-27T02:00:02.978356Z",
            "deleted_at": null,
            "main_name": "Hacking Team",
            "aliases": [],
            "source_name": "MISPGALAXY:Hacking Team",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "f8dddd06-da24-4184-9e24-4c22bdd1cbbf",
            "created_at": "2023-01-06T13:46:38.626906Z",
            "updated_at": "2025-03-27T02:00:02.877001Z",
            "deleted_at": null,
            "main_name": "Tick",
            "aliases": [
                "Stalker Taurus",
                "PLA Unit 61419",
                "Nian",
                "BRONZE BUTLER",
                "REDBALDKNIGHT",
                "STALKER PANDA",
                "G0060"
            ],
            "source_name": "MISPGALAXY:Tick",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "08623296-52be-4977-8622-50efda44e9cc",
            "created_at": "2023-01-06T13:46:38.549387Z",
            "updated_at": "2025-03-27T02:00:02.859535Z",
            "deleted_at": null,
            "main_name": "Equation Group",
            "aliases": [
                "Tilded Team",
                "EQGRP",
                "G0020"
            ],
            "source_name": "MISPGALAXY:Equation Group",
            "tools": [
                "EquationLaser",
                "EquationDrug",
                "DoubleFantasy",
                "TripleFantasy",
                "GrayFish"
            ],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "2d9fbbd7-e4c3-40e5-b751-27af27c8610b",
            "created_at": "2024-05-01T02:03:08.144214Z",
            "updated_at": "2025-03-27T02:05:17.419705Z",
            "deleted_at": null,
            "main_name": "PLATINUM COLONY",
            "aliases": [
                "Equation Group "
            ],
            "source_name": "Secureworks:PLATINUM COLONY",
            "tools": [
                " EquationDrug",
                " EquationLaser",
                " Fanny",
                " GrayFish",
                " TripleFantasy",
                "DoubleFantasy"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "f4f16213-7a22-4527-aecb-b964c64c2c46",
            "created_at": "2024-06-19T02:03:08.090932Z",
            "updated_at": "2025-03-27T02:05:17.387119Z",
            "deleted_at": null,
            "main_name": "GOLD NIAGARA",
            "aliases": [
                "Carbanak",
                "Carbon Spider ",
                "FIN7 ",
                "Navigator ",
                "Sangria Tempest ",
                "TelePort Crew ",
                "Calcium "
            ],
            "source_name": "Secureworks:GOLD NIAGARA",
            "tools": [
                " Carbanak",
                " Cobalt Strike",
                " DICELOADER",
                " DRIFTPIN",
                " GGLDR",
                " GRIFFON",
                " JSSLoader",
                " Meterpreter",
                " OFFTRACK",
                " PILLOWMINT",
                " POWERTRASH",
                " SUPERSOFT",
                " TAKEOUT",
                " TinyMet",
                "Bateleur"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "730dfa6e-572d-473c-9267-ea1597d1a42b",
            "created_at": "2023-01-06T13:46:38.389985Z",
            "updated_at": "2025-03-27T02:00:02.821388Z",
            "deleted_at": null,
            "main_name": "APT28",
            "aliases": [
                "FROZENLAKE",
                "BlueDelta",
                "SNAKEMACKEREL",
                "TG-4127",
                "ITG05",
                "TA422",
                "Fancy Bear",
                "FANCY BEAR",
                "Sednit",
                "IRON TWILIGHT",
                "G0007",
                "Sofacy",
                "Forest Blizzard",
                "GruesomeLarch",
                "Pawn Storm",
                "Tsar Team",
                "STRONTIUM",
                "ATK5",
                "Blue Athena",
                "APT-C-20",
                "Group 74",
                "SIG40",
                "Grizzly Steppe",
                "Fighting Ursa",
                "T-APT-12",
                "UAC-0028"
            ],
            "source_name": "MISPGALAXY:APT28",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "d4e7cd9a-2290-4f89-a645-85b9a46d004b",
            "created_at": "2022-10-25T16:07:23.419513Z",
            "updated_at": "2025-03-27T02:02:09.790389Z",
            "deleted_at": null,
            "main_name": "Bronze Butler",
            "aliases": [
                "Bronze Butler",
                "CTG-2006",
                "Operation ENDTRADE",
                "RedBaldNight",
                "Stalker Panda",
                "Stalker Taurus",
                "TEMP.Tick",
                "Tick"
            ],
            "source_name": "ETDA:Bronze Butler",
            "tools": [
                "8.t Dropper",
                "8.t RTF exploit builder",
                "8t_dropper",
                "9002 RAT",
                "AngryRebel",
                "Blogspot",
                "Daserf",
                "Datper",
                "Elirks",
                "Farfli",
                "Gh0st RAT",
                "Ghost RAT",
                "HOMEUNIX",
                "HidraQ",
                "HomamDownloader",
                "Homux",
                "Hydraq",
                "Lilith",
                "Lilith RAT",
                "McRAT",
                "MdmBot",
                "Mimikatz",
                "Minzen",
                "Moudour",
                "Muirim",
                "Mydoor",
                "Nioupale",
                "PCRat",
                "POISONPLUG.SHADOW",
                "Roarur",
                "RoyalRoad",
                "ShadowPad Winnti",
                "ShadowWali",
                "ShadowWalker",
                "SymonLoader",
                "WCE",
                "Wali",
                "Windows Credential Editor",
                "Windows Credentials Editor",
                "XShellGhost",
                "XXMM",
                "gsecdump",
                "rarstar"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "e0fed6e6-a593-4041-80ef-694261825937",
            "created_at": "2022-10-25T16:07:23.593572Z",
            "updated_at": "2025-03-27T02:02:09.879892Z",
            "deleted_at": null,
            "main_name": "Equation Group",
            "aliases": [
                "APT-C-40",
                "Platinum Colony",
                "Tilded Team"
            ],
            "source_name": "ETDA:Equation Group",
            "tools": [
                "Bvp47",
                "DEMENTIAWHEEL",
                "DOUBLEFANTASY",
                "DanderSpritz",
                "DarkPulsar",
                "DoubleFantasy",
                "DoubleFeature",
                "DoublePulsar",
                "Duqu",
                "EQUATIONDRUG",
                "EQUATIONLASER",
                "EQUESTRE",
                "Flamer",
                "GRAYFISH",
                "GROK",
                "OddJob",
                "Plexor",
                "Prax",
                "Regin",
                "Skywiper",
                "TRIPLEFANTASY",
                "Tilded",
                "UNITEDRAKE",
                "WarriorPride",
                "sKyWIper"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "d85adfe3-e1c3-40b0-b8bb-d1bacadc4d82",
            "created_at": "2022-10-25T16:07:23.619566Z",
            "updated_at": "2025-03-27T02:02:09.890982Z",
            "deleted_at": null,
            "main_name": "FIN7",
            "aliases": [
                "APT-C-11",
                "ATK 32",
                "Gold Niagara",
                "ITG14",
                "TAG-CR1"
            ],
            "source_name": "ETDA:FIN7",
            "tools": [
                "7Logger",
                "Agentemis",
                "Anunak",
                "Astra",
                "BIOLOAD",
                "BIRDWATCH",
                "Bateleur",
                "Boostwrite",
                "CROWVIEW",
                "Carbanak",
                "Cobalt Strike",
                "CobaltStrike",
                "DICELOADER",
                "DNSMessenger",
                "FOWLGAZE",
                "HALFBAKED",
                "JSSLoader",
                "KillACK",
                "LOADOUT",
                "Lizar",
                "Meterpreter",
                "Mimikatz",
                "POWERPLANT",
                "POWERSOURCE",
                "RDFSNIFFER",
                "SQLRAT",
                "Sekur",
                "Sekur RAT",
                "TEXTMATE",
                "Tirion",
                "VB Flash",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "46b3c0fc-fa0c-4d63-a38a-b33a524561fb",
            "created_at": "2023-01-06T13:46:38.393409Z",
            "updated_at": "2025-03-27T02:00:02.822155Z",
            "deleted_at": null,
            "main_name": "APT29",
            "aliases": [
                "The Dukes",
                "Minidionis",
                "Grizzly Steppe",
                "G0016",
                "Blue Kitsune",
                "BlueBravo",
                "SeaDuke",
                "Cloaked Ursa",
                "YTTRIUM",
                "ATK7",
                "Nobelium",
                "UAC-0029",
                "Group 100",
                "COZY BEAR",
                "IRON HEMLOCK",
                "TA421",
                "ITG11"
            ],
            "source_name": "MISPGALAXY:APT29",
            "tools": [
                "QUARTERRIG",
                "SNOWYAMBER",
                "HALFRIG"
            ],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "bf0489c5-1c07-41e6-91c9-855ad96ccc6a",
            "created_at": "2022-10-25T16:47:55.541639Z",
            "updated_at": "2025-03-27T02:05:17.253496Z",
            "deleted_at": null,
            "main_name": "BRONZE BUTLER",
            "aliases": [
                "Daserf",
                "Stalker Panda ",
                "Tick ",
                "CTG-2006 "
            ],
            "source_name": "Secureworks:BRONZE BUTLER",
            "tools": [
                " DGet",
                " Daserf",
                " Datper",
                " Gofarer",
                " MSGet",
                " Mimikatz",
                " RarStar",
                " Screen Capture Tool",
                " ShadowPad",
                " T-SMB",
                " WinRAR",
                " Windows Credential Editor",
                " gsecdump",
                " xmm downloader",
                " xxmm",
                "ABK"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "f27790ff-4ee0-40a5-9c84-2b523a9d3270",
            "created_at": "2022-10-25T16:07:23.341684Z",
            "updated_at": "2025-03-27T02:02:09.74554Z",
            "deleted_at": null,
            "main_name": "APT 29",
            "aliases": [
                "APT 29",
                "ATK 7",
                "Blue Dev 5",
                "BlueBravo",
                "Cloaked Ursa",
                "CloudLook",
                "Cozy Bear",
                "Dark Halo",
                "Earth Koshchei",
                "Grizzly Steppe",
                "Group 100",
                "ITG11",
                "Iron Hemlock",
                "Iron Ritual",
                "Midnight Blizzard",
                "Minidionis",
                "Nobelium",
                "NobleBaron",
                "Operation Ghost",
                "Operation Office monkeys",
                "Operation StellarParticle",
                "SilverFish",
                "Solar Phoenix",
                "SolarStorm",
                "StellarParticle",
                "TEMP.Monkeys",
                "The Dukes",
                "UNC2452",
                "UNC3524",
                "Yttrium"
            ],
            "source_name": "ETDA:APT 29",
            "tools": [
                "7-Zip",
                "ATI-Agent",
                "AdFind",
                "Agentemis",
                "AtNow",
                "BEATDROP",
                "BotgenStudios",
                "CEELOADER",
                "Cloud Duke",
                "CloudDuke",
                "CloudLook",
                "Cobalt Strike",
                "CobaltStrike",
                "CosmicDuke",
                "Cozer",
                "CozyBear",
                "CozyCar",
                "CozyDuke",
                "Danfuan",
                "EnvyScout",
                "EuroAPT",
                "FatDuke",
                "FoggyWeb",
                "GeminiDuke",
                "Geppei",
                "GoldFinder",
                "GoldMax",
                "GraphDrop",
                "GraphicalNeutrino",
                "GraphicalProton",
                "HAMMERTOSS",
                "HammerDuke",
                "LOLBAS",
                "LOLBins",
                "LiteDuke",
                "Living off the Land",
                "MagicWeb",
                "Mimikatz",
                "MiniDionis",
                "MiniDuke",
                "NemesisGemina",
                "NetDuke",
                "OnionDuke",
                "POSHSPY",
                "PinchDuke",
                "PolyglotDuke",
                "PowerDuke",
                "QUIETEXIT",
                "ROOTSAW",
                "RegDuke",
                "Rubeus",
                "SNOWYAMBER",
                "SPICYBEAT",
                "SUNSHUTTLE",
                "SeaDaddy",
                "SeaDask",
                "SeaDesk",
                "SeaDuke",
                "Sharp-SMBExec",
                "SharpView",
                "Sibot",
                "Solorigate",
                "SoreFang",
                "TinyBaron",
                "WINELOADER",
                "WellMail",
                "WellMess",
                "cobeacon",
                "elf.wellmess",
                "reGeorg",
                "tDiscoverer"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "d2516b8e-e74f-490d-8a15-43ad6763c7ab",
            "created_at": "2022-10-25T16:07:24.212584Z",
            "updated_at": "2025-03-27T02:02:10.141001Z",
            "deleted_at": null,
            "main_name": "Sofacy",
            "aliases": [
                "APT 28",
                "ATK 5",
                "Blue Athena",
                "BlueDelta",
                "FROZENLAKE",
                "Fancy Bear",
                "Fighting Ursa",
                "Forest Blizzard",
                "Grey-Cloud",
                "Grizzly Steppe",
                "Group 74",
                "GruesomeLarch",
                "ITG05",
                "Iron Twilight",
                "Operation DealersChoice",
                "Operation Dear Joohn",
                "Operation Komplex",
                "Operation Pawn Storm",
                "Operation Russian Doll",
                "Operation Steal-It",
                "Pawn Storm",
                "SIG40",
                "Sednit",
                "Snakemackerel",
                "Sofacy",
                "Strontium",
                "T-APT-12",
                "TA422",
                "TAG-0700",
                "TAG-110",
                "TG-4127",
                "Tsar Team",
                "UAC-0028",
                "UAC-0063"
            ],
            "source_name": "ETDA:Sofacy",
            "tools": [
                "ADVSTORESHELL",
                "AZZY",
                "Backdoor.SofacyX",
                "CHERRYSPY",
                "CORESHELL",
                "Carberp",
                "Computrace",
                "DealersChoice",
                "Delphacy",
                "Downdelph",
                "Downrage",
                "Drovorub",
                "EVILTOSS",
                "Foozer",
                "GAMEFISH",
                "GooseEgg",
                "Graphite",
                "HATVIBE",
                "HIDEDRV",
                "Headlace",
                "Impacket",
                "JHUHUGIT",
                "JKEYSKW",
                "Koadic",
                "Komplex",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "LoJack",
                "LoJax",
                "MASEPIE",
                "Mimikatz",
                "NETUI",
                "Nimcy",
                "OCEANMAP",
                "OLDBAIT",
                "PocoDown",
                "PocoDownloader",
                "Popr-d30",
                "ProcDump",
                "PythocyDbg",
                "SMBExec",
                "SOURFACE",
                "SPLM",
                "STEELHOOK",
                "Sasfis",
                "Sedkit",
                "Sednit",
                "Sedreco",
                "Seduploader",
                "Shunnael",
                "SkinnyBoy",
                "Sofacy",
                "SofacyCarberp",
                "SpiderLabs Responder",
                "Trojan.Shunnael",
                "Trojan.Sofacy",
                "USB Stealer",
                "USBStealer",
                "VPNFilter",
                "Win32/USBStealer",
                "WinIDS",
                "Winexe",
                "X-Agent",
                "X-Tunnel",
                "XAPS",
                "XTunnel",
                "Xagent",
                "Zebrocy",
                "Zekapab",
                "carberplike",
                "certutil",
                "certutil.exe",
                "fysbis",
                "webhp"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1666716495,
    "ts_updated_at": 1743041831,
    "ts_creation_date": 1496336477,
    "ts_modification_date": 1516624735,
    "files": {
        "pdf": "https://archive.orkl.eu/e3dce33708579e250f0a27f4d8e71e4a970888ec.pdf",
        "text": "https://archive.orkl.eu/e3dce33708579e250f0a27f4d8e71e4a970888ec.txt",
        "img": "https://archive.orkl.eu/e3dce33708579e250f0a27f4d8e71e4a970888ec.jpg"
    }
}