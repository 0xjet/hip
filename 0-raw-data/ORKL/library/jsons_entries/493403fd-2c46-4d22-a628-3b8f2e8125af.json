{
    "id": "493403fd-2c46-4d22-a628-3b8f2e8125af",
    "created_at": "2023-05-09T02:08:22.189983Z",
    "updated_at": "2025-03-27T02:05:32.676576Z",
    "deleted_at": null,
    "sha1_hash": "dfb07eec53b154eb86647ff90c431f43ddea6e70",
    "title": "",
    "authors": "",
    "file_creation_date": "2023-02-27T14:19:07Z",
    "file_modification_date": "2023-02-27T14:19:07Z",
    "file_size": 2522325,
    "plain_text": "# RIG Exploit Kit In-Depth Analysis\n\n\n-----\n\n### Contents\n\n**References** **2**\n\n**1** **Introduction** **3**\n\n**2** **Executive Summary** **4**\n\n**3** **The RIG Timeline** **5**\n3.1 First Release . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 5\n3.2 Takedown Operation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 5\n3.3 A Change of Malware . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 6\n3.4 Resurfacing . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 6\n\n**4** **Technical Analysis** **8**\n4.1 Profiling . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 8\n4.1.1 Resource Development . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 8\n4.1.2 Initial Access . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 8\n4.1.3 Execution . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 8\n4.2 C&C Infrastructure . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 9\n4.3 Management Panel . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 10\n4.4 Malware Distribution . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 14\n\n**5** **De-Anonymization** **14**\n\n**6** **Statistics and Observations** **15**\n\n**7** **Conclusion** **18**\n\n**8** **IOC** **20**\n8.1 Proxies . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 20\n8.2 White-listed IPs . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 20\n8.3 Exploit Servers . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 20\n8.4 Distributed Samples . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 20\n\n2 / 23\n\nDISCLAIMER : This document and its contents shall be deemed as proprietary and privileged information of PRODAFT and shall\n\nbe subjected to articles and provisions that have been stipulated in the General Data Protection Regulation and Personal\n\nData Protection Law. It shall be noted that PRODAFT provides this information “as is” according to its findings, without providing\n\nany legally applicable warranty regarding completeness or accuracy of the contents Therefore neither this report nor any of\n\n\n-----\n\n|Reference Number|CH-2023012301|\n|---|---|\n|Prepared By|PTI Team|\n|Investigation Date|14.09.2021 - 27.09.2021|\n|Initial Report Date|19.10.2021|\n|Last Update|27.02.2023|\n\n\n### 1 Introduction\n\nExploit kits (EK) are typically used to distribute malware and other malicious programs to\nlarge numbers of victims using existing vulnerabilities in commonly-used browsers. Once a\nuser visits the exploit kit’s web page (landing page), multiple techniques are used to identify\nthe browser version and operating system. With this information, the system picks a suitable\nexploit that might allow for command execution on the victim’s device. Subsequently, this\naction is, in most cases, used to install malware on the computer.\n\nThis report explores information related to the victim statistics, operation, C&C server, and\ntechnical aspects of one of the well-known exploit kits, RIG EK. Most notably, the RIG EK\nmanages the software distributing exploits and collecting victim data in their control panel\ncalled RKIT. This name can be seen in the HTML page’s title and occurs in the control panel’s\ntop-left.\n\nMany reputable sources have already provided valuable analysis into the inner workings of\nthe RIG EK and taken action against them via organized take-downs of their landing pages.\nHowever, RIG has recently resurfaced and continues to distribute malware to hundreds of\nvictims daily.\n\nRIG EK is a financially-motivated program that has been active since 2014. Although it has\nyet to substantially change its exploits in its more recent activity, the type and version of the\nmalware they distribute constantly change. The frequency of updating samples ranges from\nweekly to daily updates.\n\nIn general, this report aims to provide insight into how RIG EK operates, what kinds of\nmalware it distributes, and how the distribution happens. The PTI team has identified and\ngained visibility of the control panel of RKIT, which revealed threat actors’ inner workings\nand identities.\n\n\nPlease note that this report has two versions. The ”Private Release” is provided to\nlaw enforcement agencies, applicable CERTS / CSIRTS, and members of our U.S.T.A.\nThreat Intel Platform (with appropriate annotations and reductions). Likewise, the\n_”Public Release” is publicly disseminated for the purpose of advancing the global fight_\nagainst high-end threat actors and APTs.\n\n\n3 / 23\n\nDISCLAIMER : This document and its contents shall be deemed as proprietary and privileged information of PRODAFT and shall\n\nbe subjected to articles and provisions that have been stipulated in the General Data Protection Regulation and Personal\n\nData Protection Law. It shall be noted that PRODAFT provides this information “as is” according to its findings, without providing\n\nl ll li bl t di l t f th t t Th f ith thi t f\n\n\n-----\n\n### 2 Executive Summary\n\nEven though we like to think that the amount of machines running software with 0-day\nvulnerabilities has significantly declined in the past decade - thanks to rolling security\nupdates and better security research - that is, sadly, not the case. There still remains a\nconsiderable amount of machines worldwide running outdated and vulnerable software especially Internet Explorer.\n\nRIG EK uses this untapped goldmine by exploiting machines that run outdated versions\nof Internet Explorer. Threat actors pay the RIG EK administrator to install their malware on\nvictim machines. So far, this has proven to be a very profitable business model for the RIG\nadministrator and the threat actors.\n\nThe operators of the RIG mainly use malvertising to ensure a high infection rate and\nworldwide coverage. Victims’ initial infection occurs when they visit a site that has been\ncompromised or when they visit an advertising page that RIG EK controls. Once they access\nthe landing page, the site determines whether the browser is vulnerable. If not, the user\nremains unaffected. However, if a vulnerability is detected, they are then redirected to one\nof RIG’s proxy servers which communicate with the exploit server that sends the exploit for\nthat browser version.\n\nSince the exploit server tracks every request sent to it and synchronizes the victim data with\nthe C&C, the system stores the connection time, IP, OS, Browser version and information on\nwhether exploitation was successful or not for each user. All of this allowed the PTI team to\nconduct an extensive analysis of the logged data.\n\nThe artful design of the Exploit Kit allows it to infect devices with little to no interaction from\nthe end user. Meanwhile, its use of proxy servers makes infections harder to detect. These\ntwo features combined turn RIG EK a significant threat to corporations and end users.\n\nRIG EK has been observed dropping multiple types of malware, including stealers, RAT,\ncryptocurrency miners, and banking malware. The C&C server allows for auto-updating\nthe malware by providing a download URL. Because of this feature, the server samples\nget updated frequently, ranging from daily to weekly updates. Moreover, RIG EK also has\nan integrated Antivirus testing feature which controls for malicious software whether any\npopular antivirus software caught it.\n\nOne of the most prominent types of malware that RIG has been observed dropping is Dridex.\nAfter close inspection, it appears to be one of the most well-maintained malware with the\nmost regular updates, with a new version being released daily. Moreover, when the PTI team\nanalysed extensively, they observed that the RIG administrator had taken additional manual\nconfiguration steps to ensure that the malware was distributed smoothly. Considering all\nthese facts, we assess with high confidence that the developer of Dridex malware has a\nclose relationship with the RIG’s admins.\n\n4 / 23\n\nDISCLAIMER : This document and its contents shall be deemed as proprietary and privileged information of PRODAFT and shall\n\nbe subjected to articles and provisions that have been stipulated in the General Data Protection Regulation and Personal\n\nData Protection Law. It shall be noted that PRODAFT provides this information “as is” according to its findings, without providing\n\nl ll li bl t di l t f th t t Th f ith thi t f\n\n\n-----\n\n### 3 The RIG Timeline\n\nRIG is a very old exploit kit with a journey that went on for several years. Even though it\nwent through several ups and downs, it is still going strong. A very general overview of what\nhappened during its lifetime can be seen in Figure 3. In this section, we will be going over the\nkey points in more detail.\n\n#### 3.1 First Release\n\nRIG EK was initially released in 2014, on several forums. It promoted several exploits in its\narsenal, including but not limited to CVE-2012-0507, CVE-2013-0074. The screenshot of an\nadvertising forum post can be seen on Figure 1.\n\n**Figure 1. A forum post promoting RIG EK.**\n\n#### 3.2 Takedown Operation\n\nAfter operating for a year, its source code is leaked and started getting distributed across\nforums. Two years after this major blow, it got hit by Operation Shadowfall, a coordinated\ntakedown operation organized by the RSA organization. [2] This led to RIG EK significantly\ndownsizing its operations for a period of time.\n\n5 / 23\n\nDISCLAIMER : This document and its contents shall be deemed as proprietary and privileged information of PRODAFT and shall\n\nbe subjected to articles and provisions that have been stipulated in the General Data Protection Regulation and Personal\n\nData Protection Law. It shall be noted that PRODAFT provides this information “as is” according to its findings, without providing\n\nl ll li bl t di l t f th t t Th f ith thi t f\n\n\n-----\n\n#### 3.3 A Change of Malware\n\nDuring this time, RIG EK was mainly distributing Racoon Stealer. However, after the death\nof Raccoon’s maintainer due to the Russian advances on Ukraine, it was forced to switch\ninto distributing Dridex [4]. This was one of the main events that caused the PTI team to be\ninterested in RIG EK.\n\nA short while after continuing its operations despite this event, RIG EK’s operator announces\nthe shutdown of the kit on the very same forum it was announced. The post of the\nannouncement can be found in Figure 2. It translates into ”We are pausing our RIG3 operation\nfor an indefinite amount of time.”\n\n**Figure 2. A forum post announcing RIG’s shutdown.**\n\n#### 3.4 Resurfacing\n\nA year after the closing announcement, RIG EK resurfaces with a new and more modern\nset of exploits. The source code leak has raised some concerns among the PTI team on\nwhether the person operating the RIG EK before and after the shutdown was the same person.\nThose concerns were addressed after the discovery that both new and old instances of the\nRIG EK uses the same VDS server. This conclusion was also supported by the connections. In\nthe new RIG instance, the exploit kit was packing two shiny new exploits : CVE-2021-26411\nand CVE-2020-0674. With this new technical advance, its successful exploitation skyrocketed\nand reached an all time high of 30% in 2022.\n\n6 / 23\n\nDISCLAIMER : This document and its contents shall be deemed as proprietary and privileged information of PRODAFT and shall\n\nbe subjected to articles and provisions that have been stipulated in the General Data Protection Regulation and Personal\n\nData Protection Law. It shall be noted that PRODAFT provides this information “as is” according to its findings, without providing\n\nl ll li bl t di l t f th t t Th f ith thi t f\n\n\n-----\n\n**Figure 3. A timeline of RIG pertaining to the most important points during its life.**\n\n7 / 23\n\nDISCLAIMER : This document and its contents shall be deemed as proprietary and privileged information of PRODAFT and shall\n\nbe subjected to articles and provisions that have been stipulated in the General Data Protection Regulation and Personal\n\nData Protection Law. It shall be noted that PRODAFT provides this information “as is” according to its findings, without providing\n\nl ll li bl t di l t f th t t Th f ith thi t f\n\n\n-----\n\n### 4 Technical Analysis\n\nThis section contains a technical analysis of the RIG Exploit Kit. Exploit kits are used for\nspreading malware by using predefined exploits. The RIG Exploit Kit is known as a dropper\nhelping the spread of the malware [3] such as RTM banking malware [5], Dridex [4], Raccoon\n**Stealer [6], CryptoBit ransomware [7], and AZORult malware [1] since 2014. Recently, it is used**\nas a dropper for SmokeLoader and Ursnif.\n\n#### 4.1 Profiling\n\nSince the main purpose of RIG EK is to gain access to victim computers and hand that\naccess over to other threat actors, it makes use of Resource Development, Initial Access and\n**Execution TTPs.**\n\n**4.1.1** **Resource Development**\n\nRIG EK uses already known vulnerabilities in browsers to execute commands in victim\nmachines. The exploits used for these vulnerabilities do not appear to be custom developed\nby the RIG author or anyone else. Rather, they appear to be slightly modified versions\nof publicly available exploits, usually (but not always) obfuscated to hide the code. This\nbehavior falls under the T1588, Obtain Capabilities [1] TTP. Moreover, RIG EK uses malvertising\nand compromised websites to redirect worthy users into its landing page. This correlates\nwith the TTP T1584, Compromise Infrastructure [2].\n\n**4.1.2** **Initial Access**\n\nThe exploits of RIG EK are delivered to unsuspecting victims in two ways. Either via\nmalvertising, where users are redirected to online advertising pages that are tricked to\nexecute the RIG exploits on their browser. Or when they visit sites that were compromised\nand the exploit kit’s javascript was injected. In either way, the users hardly every notice that\nanything malignant has ever occurred on their systems and go on with their daily browsing\nactivities. Due to the very limited interaction and non-disrupting nature of this process, this\ntechnique can be deemed T1189, Drive-by Compromise [3].\n\n**4.1.3** **Execution**\n\nAfter the exploit kit is successfully executed on the victim machine, it runs an obfuscated\npowershell script that fetches a malware from the RIG EK C&C infrastructure. This falls under\nthe T1059, Command and Scripting Interpreter [4] TTP. Meanwhile, since the script was initially\nexecuted via the exploitation of a known vulnerability in the victim’s system, it can be said\nthat the TTP T1203, Exploitation for Client Execution [5] is also made use of by RIG EK.\n\n[1. https://attack.mitre.org/techniques/T1588/](https://attack.mitre.org/techniques/T1588/)\n[2. https://attack.mitre.org/techniques/T1584/](https://attack.mitre.org/techniques/T1584/)\n[3. https://attack.mitre.org/techniques/T1189/](https://attack.mitre.org/techniques/T1189/)\n[4. https://attack.mitre.org/techniques/T1059/](https://attack.mitre.org/techniques/T1059/)\n[5. https://attack.mitre.org/techniques/T1203/](https://attack.mitre.org/techniques/T1203/)\n\n8 / 23\n\nDISCLAIMER : This document and its contents shall be deemed as proprietary and privileged information of PRODAFT and shall\n\nbe subjected to articles and provisions that have been stipulated in the General Data Protection Regulation and Personal\n\nData Protection Law. It shall be noted that PRODAFT provides this information “as is” according to its findings, without providing\n\nl ll li bl t di l t f th t t Th f ith thi t f\n\n\n-----\n\n#### 4.2 C&C Infrastructure\n\nThe threat actors that maintain the RIG exploit kit modernized and changed their\ncodebase but did not change their infrastructure [8] since their source leak in 2015. Also, it\nis discovered that they did not update their configuration constants like XOR keys and API keys.\n\nThe infrastructure had three keystones. These are the Virtual Dedicated Servers (VDS) (a.k.a.\nthe exploitation server), the proxy server, and the API server. The API serves the exploit in an\niframe or an under pop through the proxy server. (Figure 4)\n\n1\n\nVictim\n\nrequests the\nlatest proxy servers\n\nAPI Server\n\nMalicious Website\n\n2\n\nclassifies the victim\nand suggests to an exploit\n\nProxy Server VDS Server\n\n(Exploit Server)\n\n**Figure 4. The infrastructure of the RIG exploit kit.**\n\nThe proxy server is a reverse proxy to the exploit server. The proxy server uses a pre-shared\nprotocol with the VDS. In that protocol, the first step is serializing the HTTP request with the\nreferral site’s information. Then it redirects the exploit server’s response to the victim’s browser.\nThe referral sites information is stored for statistical presentation in the management panel.\n\nThe exploit server detects user’s browser by parsing the ”User-Agent” header. If the version\nof the browser matches the pre-defined vulnerable browser versions, then the exploit kit\nreturns the suggested exploit code encrypted with custom version of RC4 algorithm.\n\nThe exploit server had six different exploits. Based on the PTI teams analysis, every exploit\ninside the RIG exploit kit, are weaponized versions of publicly available proof of concept\n(PoC) exploits codes. According to the exploit statistics, the actors are only using two of\nthese exploits actively.\n\n9 / 23\n\nDISCLAIMER : This document and its contents shall be deemed as proprietary and privileged information of PRODAFT and shall\n\nbe subjected to articles and provisions that have been stipulated in the General Data Protection Regulation and Personal\n\nData Protection Law. It shall be noted that PRODAFT provides this information “as is” according to its findings, without providing\n\nl ll li bl t di l t f th t t Th f ith thi t f\n\n\n-----\n\nThese exploits are :\n\n## • [CVE-2013-2551]\n • [CVE-2014-6332]\n • [CVE-2015-0313]\n • [CVE-2015-2419]\n • [CVE-2016-0189]\n • [CVE-2019-0752]\n • [CVE-2018-8174]\n\nSince RIG EK has resurfaced, the group has expanded their arsenal with two new exploits\nthat are used actively :\n\n## • [CVE-2021-26411]\n • [CVE-2020-0674]\n\n#### 4.3 Management Panel\n\nMultiple users use the management panel with various privilege levels. The PTI team\nmonitored the management panel and its users cautiously, and the below table shows the\nactive users and their respective roles in the system.\n\n**Username** **Privilege**\nadmin admin\nvipr admin\npit/pitty subadmin\nlyr user\nump user\ntest1 user\n\nSince the user admin is a dummy user used for creating other users, actors used the pitty\nuser for managing the panel. The management panel works with a subscription model. The\nsubscription of the only existing user, pitty, ended on the 5th of June, 2022. (as shown in\nFigure 5)\n\n**Figure 5. The actor pitty’s subscription information.**\n\n10 / 23\n\nDISCLAIMER : This document and its contents shall be deemed as proprietary and privileged information of PRODAFT and shall\n\nbe subjected to articles and provisions that have been stipulated in the General Data Protection Regulation and Personal\n\nData Protection Law. It shall be noted that PRODAFT provides this information “as is” according to its findings, without providing\n\nl ll li bl t di l t f th t t Th f ith thi t f\n\n|Username|Privilege|\n|---|---|\n|admin|admin|\n|vipr|admin|\n|pit/pitty|subadmin|\n|lyr|user|\n|ump|user|\n|test1|user|\n\n\n-----\n\nThe main page of the management panel shows the exploit kits statistics (as shown in\nFigure 6). The panel lets the actor filter the statistics by time, exploits, countries, browsers,\nthe operating system, referrer websites, and the panel users.\n\n**Figure 6. The management page welcomes the actor with the statistics page.**\n\nThe panel lets its users run multiple flows (campaigns). Each flow had a revocable unique\ntoken (Figure 7). The tokens are used for identifying the flow when serving the relevant\nexploits to the victims. Some of the flow names found during the investigation are :\n\n## • [DanFuz Buba TOP 43к]\n • [DanFuz Buba]\n • [TEST MAGMA RIG]\n • [ZWhttp]\n • [godf WW 10k]\n • [DanFuz WW 42k]\n • [ANKL JP]\n\n11 / 23\n\nDISCLAIMER : This document and its contents shall be deemed as proprietary and privileged information of PRODAFT and shall\n\nbe subjected to articles and provisions that have been stipulated in the General Data Protection Regulation and Personal\n\nData Protection Law. It shall be noted that PRODAFT provides this information “as is” according to its findings, without providing\n\nl ll li bl t di l t f th t t Th f ith thi t f\n\n\n-----\n\n**Figure 7. A flow created by the threat actor and the flows key.**\n\nThe ”Files” page on the panel allows uploading, managing, and scanning files. Files could be\nuploaded in two ways. First way is to upload files directly from a disk or an URL. The second\nway is to define an auto-update URL. With an auto-update URL, the panel will fetch the\nURL in intervals and update the file periodically (Figure 8).\n\n**Figure 8. The malware upload page of the system.**\n\n12 / 23\n\nDISCLAIMER : This document and its contents shall be deemed as proprietary and privileged information of PRODAFT and shall\n\nbe subjected to articles and provisions that have been stipulated in the General Data Protection Regulation and Personal\n\nData Protection Law. It shall be noted that PRODAFT provides this information “as is” according to its findings, without providing\n\nl ll li bl t di l t f th t t Th f ith thi t f\n\n\n-----\n\nThe management panel allows managing the reverse proxies as well (Figure 9). These proxies\nare used for hiding the exploit server from being exposed to the public.\n\n**Figure 9. Proxy management page.**\n\nThe panel allows the admin users to download the exploits from the exploit server (Figure 10).\n\n**Figure 10. Exploit export page.**\n\n13 / 23\n\nDISCLAIMER : This document and its contents shall be deemed as proprietary and privileged information of PRODAFT and shall\n\nbe subjected to articles and provisions that have been stipulated in the General Data Protection Regulation and Personal\n\nData Protection Law. It shall be noted that PRODAFT provides this information “as is” according to its findings, without providing\n\nl ll li bl t di l t f th t t Th f ith thi t f\n\n\n-----\n\n#### 4.4 Malware Distribution\n\nRIG has been used to distribute different types of malware, mainly stealers, overtime. A\nlist illustrating the malware the PTI team has observed is portrayed in Table 1.\n\n**Filename** **Hash** **Classification**\nAlx2v5WmfMzV.exe 4c4932a64047e4aa34c3fb1bcd96521e Gozi\nanKLpKggm0gb.exe e449924b8aa04fa2e032511cf86d2482 SmokeLoader\ndeATop5N2riMx0.exe 12fbb4571b89a9f14375b69c71723834 RaccoonStealer\nKartOJeqhpcZL.exe b6a06875808f59fdaaeb0eda56fe9a5b PureCrypter\nmrKT46PWXuW.exe a48b99060695e584be29e2b816e53318 RedlineStealer\nNMlsYSYm6dJK.exe 8bc77b7338da0b9041a488f185355e84 RecordBreaker\nthm9KeCpkS.exe b300ff2b8a0a2ba3130f92507e3c2b2a RedlineStealer\nvUPGMCwp.exe c66bd22aaaae16bedd0b52ead7c32a5e IcedID\nmyRFF6ZaFeo.exe 3e2332c574ae88f8fbf6a9fc9e007e65 Raccoon Stealer\nYbNFQmhF.exe 7f8a2b842948eb70133fa34f0cfe772b ZLoader\nA6aTTgla.exe 6a2f114a8995dbeb91f766ac2390086e TrueBot\n6Dyn175na1.exe def3951faab3701d653228389fc7b5fc RaccoonStealer\nDanfUz8YgFw7Ee.exe 6b6db262e0ac7c36a449692894d12ed1 Dridex\nDAnFuzAaX9JE4n.exe d43fa3957b4004ebdbe5073f99a32c9e Dridex\nmag5Wip3Ide.exe c6cc42b429c26e68deec777eedb4c11d Dridex\nGerxIflwewM.exe 4ed2076ec15170d68a88d8b4db34fff1 UrSnif\ngErVP6ZddBw.exe 6b3d119e8c22e8670deb3a4f79646495 Royal Ransomware\nDVqj6UhQ.exe 6cb6a59dc12494d5c5224fc03eb12ece Royal Ransomware\n\n**Table 1. Malware samples RIG EK was observed distributing**\n\nThis is only a small glimpse into the myriad of malware that RIG EK has been observed\ndistributing. It is also used to distribute other types of malware from various groups. A more\ncomplete list of hashes can be found in Section 8.\n\n### 5 De-Anonymization\n\n|Filename|Hash|Classification|\n|---|---|---|\n|Alx2v5WmfMzV.exe|4c4932a64047e4aa34c3fb1bcd96521e|Gozi|\n|anKLpKggm0gb.exe|e449924b8aa04fa2e032511cf86d2482|SmokeLoader|\n|deATop5N2riMx0.exe|12fbb4571b89a9f14375b69c71723834|RaccoonStealer|\n|KartOJeqhpcZL.exe|b6a06875808f59fdaaeb0eda56fe9a5b|PureCrypter|\n|mrKT46PWXuW.exe|a48b99060695e584be29e2b816e53318|RedlineStealer|\n|NMlsYSYm6dJK.exe|8bc77b7338da0b9041a488f185355e84|RecordBreaker|\n|thm9KeCpkS.exe|b300ff2b8a0a2ba3130f92507e3c2b2a|RedlineStealer|\n|vUPGMCwp.exe|c66bd22aaaae16bedd0b52ead7c32a5e|IcedID|\n|myRFF6ZaFeo.exe|3e2332c574ae88f8fbf6a9fc9e007e65|Raccoon Stealer|\n|YbNFQmhF.exe|7f8a2b842948eb70133fa34f0cfe772b|ZLoader|\n|A6aTTgla.exe|6a2f114a8995dbeb91f766ac2390086e|TrueBot|\n|6Dyn175na1.exe|def3951faab3701d653228389fc7b5fc|RaccoonStealer|\n|DanfUz8YgFw7Ee.exe|6b6db262e0ac7c36a449692894d12ed1|Dridex|\n|DAnFuzAaX9JE4n.exe|d43fa3957b4004ebdbe5073f99a32c9e|Dridex|\n|mag5Wip3Ide.exe|c6cc42b429c26e68deec777eedb4c11d|Dridex|\n|GerxIflwewM.exe|4ed2076ec15170d68a88d8b4db34fff1|UrSnif|\n|gErVP6ZddBw.exe|6b3d119e8c22e8670deb3a4f79646495|Royal Ransomware|\n|DVqj6UhQ.exe|6cb6a59dc12494d5c5224fc03eb12ece|Royal Ransomware|\n\n\nThis section is intentionally redacted for the public and is only available for law\nenforcement officers and trusted partner companies. Feel free to ask for a copy\nof the private release of this report.\n\n\n14 / 23\n\nDISCLAIMER : This document and its contents shall be deemed as proprietary and privileged information of PRODAFT and shall\n\nbe subjected to articles and provisions that have been stipulated in the General Data Protection Regulation and Personal\n\nData Protection Law. It shall be noted that PRODAFT provides this information “as is” according to its findings, without providing\n\nl ll li bl t di l t f th t t Th f ith thi t f\n\n\n-----\n\n### 6 Statistics and Observations\n\nIt is interesting to point out that the exploit kit got traffic from the 207 countries. The\nfollowing chart (Figure 11) shows the exploitation attempt count per country (and dependent\nareas) for two months.\n\n**Figure 11. Exploitation attempts per country.**\n\nExploit kit had 22% (17647/81220) success rate in the last two months before its shutdown in\n2021. The following chart (Figure 15) shows the successful exploitation attempts by country.\n\n**Figure 12. Successfully exploited machines per country.**\n\n15 / 23\n\nDISCLAIMER : This document and its contents shall be deemed as proprietary and privileged information of PRODAFT and shall\n\nbe subjected to articles and provisions that have been stipulated in the General Data Protection Regulation and Personal\n\nData Protection Law. It shall be noted that PRODAFT provides this information “as is” according to its findings, without providing\n\nl ll li bl t di l t f th t t Th f ith thi t f\n\n\n-----\n\nAnalyzing the exploitation attempt rates per day of week and percentage of successful\nexploitation also reveals some interesting trends. Taking a look at the chart below :\n\n**Figure 13. Exploit attempts and successful infections per day of week.**\n\nThe RIG EK receives traffic from thousands of victims per day thanks to its malvertising\ncampaigns. Nonetheless, what is most important for an exploit kit is the rate of successful\nexploitation. During its resurfacing at the end of 2022, it has consistently achieved a 30%\nexploitation rate among its victims. Even though throughout its lifetime, it has used numerous\nexploits, it has achieved the highest successful infection rate with CVE-2021-26411.\n\n**Figure 14. Successful exploitation rate per discovery date of exploit**\n\n16 / 23\n\nDISCLAIMER : This document and its contents shall be deemed as proprietary and privileged information of PRODAFT and shall\n\nbe subjected to articles and provisions that have been stipulated in the General Data Protection Regulation and Personal\n\nData Protection Law. It shall be noted that PRODAFT provides this information “as is” according to its findings, without providing\n\nl ll li bl t di l t f th t t Th f ith thi t f\n\n\n-----\n\nAs RIG EK is being distributed as a service model, it can distribute different types\nof malware, whilst all of them belong to different people and serve various purposes.\nHowever, statistics have showed us that most of the distributed malware are stealer examples.\n\n**Figure 15. Distribution percentages per type of malware.**\n\nOverall, RIG EK runs a very fruitful business of exploit as-a-service, with victims across the\nglobe, a highly effective exploit arsenal and numerous customers with constantly updating\nmalware. There are only a handful of countries that has managed to stay untouched by its\ncampaign and it receives a considerable amount of victims everyday.\n\n17 / 23\n\nDISCLAIMER : This document and its contents shall be deemed as proprietary and privileged information of PRODAFT and shall\n\nbe subjected to articles and provisions that have been stipulated in the General Data Protection Regulation and Personal\n\nData Protection Law. It shall be noted that PRODAFT provides this information “as is” according to its findings, without providing\n\nl ll li bl t di l t f th t t Th f ith thi t f\n\n\n-----\n\n### 7 Conclusion\n\nThis report focuses on researching and analyzing detailed information related to one of\nthe most prominent exploit kits - the so-called RIG EK. As this exploit kit recently increased\nits activities, the report presents the reader with relevant data related to the C2 panel, new\ndevelopments, threat actors in charge, technical evaluation, victim targeting and other\noperational details.\n\nRIG EK has been on the scene since 2014 and due to its long-lasting activity, the type and\nversion of the distributed malware are always changing. With Dridex being observed as\nthe most common malware that is being dropped, targets are predominantly vulnerable\nmachines that run outdated versions of Internet Explorer, making it easier to install\nthe malware on them. The infection mainly happens through malvertising and visiting\n**compromised sites and without any further action on the user side. Thanks to 2 new exploits,**\n**CVE-2021-26411 and CVE-2020-0674, the exploitation rate reached 30% in 2022. Financially**\nmotivated, the operators of RIG EK have the goal to gain access to victims’ computers and\nfurther distribute and sell that access to other threat actors.\n\nFurthermore, they managed to intercept victim traffic from 207 countries, with the most\nsuccessful campaigns coming from Russia, Mexico, Brazil and the Middle East. Interestingly\nenough, the exploit try rates were the highest on Tuesday, Wednesday and Thursday - with\nsuccessful infections taking place on the same days of the week. It is also noteworthy to\nmention that in addition to Dridex, the other popular types of distributed malware were\nstealers, such as RaccoonStealer or SmokeLoader. The report also highlights the advanced\nfeatures of RIG EK, such as its use of proxy servers which makes infections harder to detect,\nand its integrated Antivirus testing feature, which controls for malicious software and\nwhether any popular antivirus software caught it. The report assesses, with high confidence,\nthat the developer of the Dridex malware has a close relationship with the RIG’s admins,\nwhich further emphasizes the sophistication and evolution of RIG EK over the years.\n\nIn conclusion, the RIG EK exploit kit is a significant threat to corporations and end users. Its\nability to infect devices with little to no interaction from the end user, coupled with its use of\nproxy servers, makes it harder to detect. The report highlights the need for organizations\nand individuals to remain vigilant and keep their software up-to-date to protect against\nthis exploit kit and other similar threats.\n\n18 / 23\n\nDISCLAIMER : This document and its contents shall be deemed as proprietary and privileged information of PRODAFT and shall\n\nbe subjected to articles and provisions that have been stipulated in the General Data Protection Regulation and Personal\n\nData Protection Law. It shall be noted that PRODAFT provides this information “as is” according to its findings, without providing\n\nl ll li bl t di l t f th t t Th f ith thi t f\n\n\n-----\n\n**Acknowledgement**\nWe would like to thank our advisors for their valuable guidance and support throughout this\nresearch.\n\nThe public version of the report will be shared from our github page [6]. The readers can find\nnew samples, IOCs, and new versions of this report from our github page as we will constantly\nupdate our page based on new findings.\n\n[6. https://www.github.com/prodaft](https://www.github.com/prodaft)\n\n19 / 23\n\nDISCLAIMER : This document and its contents shall be deemed as proprietary and privileged information of PRODAFT and shall\n\nbe subjected to articles and provisions that have been stipulated in the General Data Protection Regulation and Personal\n\nData Protection Law. It shall be noted that PRODAFT provides this information “as is” according to its findings, without providing\n\nl ll li bl t di l t f th t t Th f ith thi t f\n\n\n-----\n\n### 8 IOC\n\n#### 8.1 Proxies\n```\n188.227.106.162\n188.227.106.81\n188.227.106.83\n188.227.57.93\n188.227.58.144\n188.227.58.152\n188.227.59.52\n195.16.88.28\n45.138.26.51\n45.138.26.89\n45.138.26.93\n45.138.26.94\n\n 8.2 White-listed IPs\n188.225.75.54\n45.132.226.177\n\n 8.3 Exploit Servers\n\n```\n```\n195.16.88.28\n\n```\n\n#### 8.4 Distributed Samples\n```\n0773d5b2b39b964d5cdc4883e249564c697b6fee222caeed2ead3b0c7dad13c4\n078ca38607f24fd21a563fa5189843734677b98d5017d5ebb03b2960053b25b5\n0a59f083b2e7e919ad75c38df302283deace71ad4106fe22685e290b504e860f\n11ad03c89b363353ce776edaa00cb52a71f37e6e189bce97d56859b72eca312a\n148c2c5b82b22f83365e60b3494a42b1b1def3a19e086ba15a409cc2fbd50f01\n1d3440fb24a7347ce312d135f138e829acc8b41f94a9491d1d195a257557f4a9\n1eff4b54c1c2efc1e10fd49ef41386ab918c1c2e2c296221a85b812a7ad52e43\n30f025e2a0b486f8a161eca4b4ca1df721cb1e0a6eab97ecd7e78afd0894fa6a\n3c0145066c3e5b65134f6a157e26b1d6f49b2690f7aa684c70015e605a4f67f0\n3c0f15094521a8677c186664573964cf9e0ab6d45c0540ee005a816465b1de51\n3db1507069c0251f8a38ebac572798ecfc01856cb5febcb3f1b2fc9593b5bb1f\n41a78aadb442254b6f68805375a3c7de630cd784aa739e51390da7b7ffa7fb83\n49600d1fcbe50d40816e1588eacbf4b013b2951b55c9dfbf47735f1c868d72c0\n4ea543e3a45ed569a9f4f4bfa7c396a0e49c360f8ed304045f7799c73d5d915a\n529f5f92656efa3c8bd13c4a463b3f2550e1b4e7096426900da8de0d4fc43e44\n57fc3ccdbf6ef5d5a9cc2ee339151726167b67d2678203a7174c3e3b79e9ff28\n5826e055857331d129b88765c9e5a77322f4e36a336c812c502c8b87c51e503a\n594a43692deac6a19744b687a29e23dc2d5f425ad17e1e0abbb556c037bdbfb5\n5958a682ac3dc146b53e4bcb80f8c250ecc9ecc573e292b465de2b8daf2c8a96\n5963424f5de77627224de02039d01e6693b8e267fc04f914e82c52b492e7c794\n642511ccfe08d4dbcc2d7056278642d5ed9f9fb93dabeee442e28abf969691bb\n69313a6cf63eafab288b2e1d23767243887568b5f10a55e128426f62938f8405\n\n```\n20 / 23\n\nDISCLAIMER: This document and its contents shall be deemed as proprietary and privileged information of PRODAFT and shall\n\nbe subjected to articles and provisions that have been stipulated in the General Data Protection Regulation and Personal\n\nData Protection Law. It shall be noted that PRODAFT provides this information “as is” according to its findings, without providing\n\nl ll li bl t di l t f th t t Th f ith thi t f\n\n\n-----\n\n```\n6f4d3a71ac731c8fbd21dda98b6a7a585569d9c8eaac4a1476a9f91b3f899582\n72813522a065e106ac10aa96e835c47aa9f34e981db20fa46a8f36c4543bb85d\n72b4b2922c575e9a801ece637bfde4154368baf17055881876ae174a5d920ae7\n732eaa1e4d585156f4df6eecbbe73f6555ef0e23eca126e86686d5bc02f4be09\n77c0a32673e08c2ae14b2846f678b7763785f5253b39eb45888f4a3b75297a09\n7c96aeef8194d246210e843f3b9c3c6482a9a8ce5f706463fe5efdd06c81ef8d\n829ec000ca31cafdf9ca32222077126d9a82dd857a4353bf2eea269cbe1edbdf\n831ab9985f48fa2ad45da96b2dfba5eff98f4b18ba10c0ce12c8b3ffa687cd01\n83f61982f8afe07127590669f261f08737f3cdc89b7abf8a543f3d95c2562f2f\n869de7797af7c2a59e0597eaf752706acbbffde05f8c3f49c89e4a323999f460\n9758f5352b7db9e60b6a935e65ad131d5de29e236133456846544dce0949fc5b\na69ee818693bfa3e1cc3999b243cf61948d238e5e7791b1d43952d961f150cd6\nac1dd32c41f6002bdf2eb564653ff23e069594ce55f9e22093355084ee28a6fd\nada01d4123accf798ba38ee21dd2dd5a813255f9a5143acb714d390ae03e967c\nb070c9601e7ab97793ed65b5fc43694fb8cb1ca531240dffd0090e6cda259bde\nb378914aca1901f23b5b213baae490c92a4eed43f78c7bdd25cebae92393af96\nb9fd7622c3fcfdd6eb9b2cb917a3cb64eb35c61221de4866303ca88d828d5bed\nbfcc9508bd3176186f186c639c797e317733eac4350e80a56cf9f417008ddae1\ncb2ed19eef732c1c5f493ca7c8fc1ede57cf3bfd3e8887c522865ce0eabe449a\nd5391582f00ac861712b5a810e26bb0355688c12fec74f956df28778a601b883\nd83494cfb155056118365455f5396401e97bd50a156242f2b5025a44c67095b1\ned11dc8f2282bd070f44afcb725202f42a77d807c69219f18a6b3460a3c8e68f\nf19f501beaf1cf4d8a2d0f0495d20749ec2086f1b52205779060028ffe6a81f9\n\n```\n21 / 23\n\nDISCLAIMER : This document and its contents shall be deemed as proprietary and privileged information of PRODAFT and shall\n\nbe subjected to articles and provisions that have been stipulated in the General Data Protection Regulation and Personal\n\nData Protection Law. It shall be noted that PRODAFT provides this information “as is” according to its findings, without providing\n\nl ll li bl t di l t f th t t Th f ith thi t f\n\n\n-----\n\n### Références\n\n[1] [Malware Traffic Analysis. RIG EK Sends Ramnit, Follow-Up Malware : Azorult. url : https://](https://www.malware-traffic-analysis.net/2018/01/30/index.html)\n```\n  www.malware-traffic-analysis.net/2018/01/30/index.html. (accessed : 07.04.2022).\n\n```\n[2] BleepingComputer. RIG Exploit Kit Suffers Major Blow Following Coordinated Takedown\n_[Action. url : https : / / www . bleepingcomputer . com / news / security / rig - exploit -](https://www.bleepingcomputer.com/news/security/rig-exploit-kit-suffers-major-blow-following-coordinated-takedown-action/)_\n```\n  kit-suffers-major-blow-following-coordinated-takedown-action/. (accessed :\n\n```\n17.12.2022).\n\n[3] New Jersey Cybersecurity & Communications Integration Cell. RIG Threat Profile. url :\n```\n  https : / / www . cyber . nj . gov / threat - center / threat - profiles / exploit - kit   variants/rig. (accessed : 07.04.2022).\n\n```\n[4] [DarkReading. RIG Exploit Kit Replaces Raccoon Stealer Trojan With Dridex. url : https:](https://www.darkreading.com/attacks-breaches/rig-exploit-kit-replaces-raccoon-stealer-trojan-with-dridex)\n```\n  //www.darkreading.com/attacks-breaches/rig-exploit-kit-replaces-raccoon  stealer-trojan-with-dridex. (accessed : 15.12.2022).\n\n```\n[5] [ESET. Read The Manual : A Guide to the RTM Banking Trojan. url : https : / / www .](https://www.welivesecurity.com/wp-content/uploads/2017/02/Read-The-Manual.pdf)\n```\n  welivesecurity.com/wp-content/uploads/2017/02/Read-The-Manual.pdf. (accessed :\n\n```\n27.12.2021).\n\n[6] [Malwarebytes Threat Intelligence. RIGEK dropping RaccoonStealer. url : https : / /](https://twitter.com/MBThreatIntel/status/1479155809703522306)\n```\n  twitter.com/MBThreatIntel/status/1479155809703522306. (accessed : 07.04.2022).\n\n```\n[7] [Palo Alto Networks. CryptoBit : Another Ransomware Family Gets an Update. url : https:](https://unit42.paloaltonetworks.com/unit42-cryptobit-another-ransomware-family-gets-an-update/)\n```\n  //unit42.paloaltonetworks.com/unit42-cryptobit-another-ransomware-family  gets-an-update/. (accessed : 07.04.2022).\n\n```\n[8] [TrustWave. RIG Exploit Kit – Diving Deeper into the Infrastructure. url : https://www.](https://www.trustwave.com/en-us/resources/blogs/spiderlabs-blog/rig-exploit-kit-diving-deeper-into-the-infrastructure/)\n```\n  trustwave.com/en-us/resources/blogs/spiderlabs-blog/rig-exploit-kit-diving  deeper-into-the-infrastructure/. (accessed : 07.04.2022).\n\n```\n22 / 23\n\nDISCLAIMER : This document and its contents shall be deemed as proprietary and privileged information of PRODAFT and shall\n\nbe subjected to articles and provisions that have been stipulated in the General Data Protection Regulation and Personal\n\nData Protection Law. It shall be noted that PRODAFT provides this information “as is” according to its findings, without providing\n\nl ll li bl t di l t f th t t Th f ith thi t f\n\n\n-----\n\n### Historique\n\n**Version** **Date** **Auteur(s)** **Modifications**\n\n1.0 19.10.2021 PTI Team Initial TLP:RED DRAFT release\n1.1 25.10.2021 PTI Team Updated De-anonymization section for LE\n2.0 23.01.2023 PTI Team TLP:RED Version\n3.0 27.02.2023 PTI Team TLP:CLEAR Version\n\n23 / 23\n\nDISCLAIMER : This document and its contents shall be deemed as proprietary and privileged information of PRODAFT and shall\n\nbe subjected to articles and provisions that have been stipulated in the General Data Protection Regulation and Personal\n\nData Protection Law. It shall be noted that PRODAFT provides this information “as is” according to its findings, without providing\n\nl ll li bl t di l t f th t t Th f ith thi t f\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "bf5be533-fa31-4590-ae37-5761c97ffa34",
            "created_at": "2022-10-25T16:13:58.389257Z",
            "updated_at": "2022-10-25T16:13:58.389257Z",
            "deleted_at": null,
            "name": "Malpedia",
            "url": "https://malpedia.caad.fkie.fraunhofer.de",
            "description": "Malpedia is a free service offered by Fraunhofer FKIE",
            "reports": null
        }
    ],
    "references": [
        "https://www.prodaft.com/m/reports/RIG___TLP_CLEAR-1.pdf"
    ],
    "report_names": [
        "RIG___TLP_CLEAR-1.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1683598102,
    "ts_updated_at": 1743041132,
    "ts_creation_date": 1677507547,
    "ts_modification_date": 1677507547,
    "files": {
        "pdf": "https://archive.orkl.eu/dfb07eec53b154eb86647ff90c431f43ddea6e70.pdf",
        "text": "https://archive.orkl.eu/dfb07eec53b154eb86647ff90c431f43ddea6e70.txt",
        "img": "https://archive.orkl.eu/dfb07eec53b154eb86647ff90c431f43ddea6e70.jpg"
    }
}