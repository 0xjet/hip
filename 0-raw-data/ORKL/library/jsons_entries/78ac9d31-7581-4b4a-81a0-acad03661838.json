{
    "id": "78ac9d31-7581-4b4a-81a0-acad03661838",
    "created_at": "2022-10-25T16:48:12.324236Z",
    "updated_at": "2025-03-27T02:14:38.957498Z",
    "deleted_at": null,
    "sha1_hash": "c27c1daaa60de3381a7cb11975bef88fa05c2449",
    "title": "",
    "authors": "",
    "file_creation_date": "2015-12-01T09:07:03Z",
    "file_modification_date": "2015-12-01T09:07:15Z",
    "file_size": 6082168,
    "plain_text": "Lead Author: Maarten van Dantzig\n\nCo-Authors: Danny Heppener, Frank Ruiz,\n\nYonathan Klijnsma, Yun Zheng Hu,\n\nErik de Jong, Krijn de Mik,\n\nLennart Haagsma\n\n# Ponmocup\n\n\n# Ponmocup\n\n#### A giant hiding in the shadows\n\n###### Version 1.1 November 30, 2015\n\n\n-----\n\n## Executive Summary\n\n###### Ponmocup, first discovered in 2006 as Vundo or Virtumonde, is one \n\n of the most successful botnets of the past decade, in terms of spread\n\n and persistence. Furthermore, the reasons why this botnet is considered\n\n highly interesting are that it is sophisticated, underestimated and is\n\n currently largest in size and aimed at financial gain.\n\nThis underestimated botnet is still in active use and under continuous development.\n\nHaving established that Ponmocup’s primary goal is likely financial gain, it is interesting\n###### to look at its size. Fox-IT has determined that it has infected a cumulative total of more than 15 million unique victims since 2009. At its peak, in July 2011, the botnet consisted of 2.4 million infected systems, which as far as botnets go, is huge. Since then, the botnet has shrunk in size and is currently stable at around 500,000 active\n\ninfections, as shown in Figure 1.\n\nCompared to other botnets, Ponmocup is one of the largest currently active and, with\n\n9 consecutive years, also one of the longest running. Ponmocup is rarely noticed though,\n\nas the operators take care to keep it operating under the radar.\n\nPonmocup’s operators are technically sophisticated, their techniques suggest a deeper\n\nthan regular knowledge of the Windows operating system. On top of that, the operators\n\nhave close to 10 years of experience with malware development. Their framework was\n\ndeveloped over time, quality tested and then improved in order to increase robustness\n\nand reduce the likelihood of discovery.\n\nThe operators are most likely Russian speaking and possibly of Russian origin. This is based\n###### on the fact that instructions to business partners and affiliates are written in Russian,\n\nand that historically, Ponmocup would not infect systems in some post-Soviet States.\n\n\n-----\n\nPonmocup is believed to be aimed at financial gain. Although it is difficult to quantify\n\nthe exact amount of money earned with the Ponmocup botnet, it is likely that it has\n\nalready been a multi-million dollar business for years now. There are multiple reasons to\n\nassume this is the case. Firstly, their infrastructure is complex, distributed and extensive,\n\nwith servers for dedicated tasks. Secondly, they operate, maintain and monitor their\n\ncomprehensive infrastructure with a group of operators and are quickly able to mitigate\n\npotential risks that are discovered. Thirdly, the malware itself is sophisticated and aimed\n###### at avoiding detection and analysis. Fox-IT believes, based on the earlier mentioned\n\nreasons, that they are protecting a very well run organization and infrastructure, for\n\ntheir main goal: financial gain.\n\nSinkholing Abuse.CH\n\n2,500,000\n\n2,000,000\n\n1,500,000 & delivery method\n\n1,000,000\n\n500,000\n\nDevelopment of Ponmocup\n\n0\n\n_Figure 1: Number of active Ponmocup bots over time_\n\n|Col1|qu hat eas xte ito mi nd ent tu|an it on ns r t tig ai io re,|ti h s iv he a me ne f|fy as to e, ir te d d or|Col6|Col7|Col8|Col9|Col10|Col11|Col12|Col13|Col14|Col15|Col16|Col17|Col18|Col19|Col20|Col21|Col22|\n|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|\n|||||||||||||||||||||||\n||eas|e o|f|im|pr|ov|ed|Po|n|mo|cu|p||||||||||\n||eliv|er|y|me|th|od||||||||||||||||\n|||||||||||||||||||||||\n|||||||||||||||||||||||\n\n\nDevelopment of Ponmocup\n\n\n-----\n\n###### Table of contents\n\n**1** **Introduction** **5**\n\n**2 Behind Ponmocup** **6**\n\n2.1 Attribution 6\n\n2.2 Goals and impact 6\n\n2.3 Size 7\n\n**3** **\u0007Overview of the technical framework** **8**\n\n3.1 Framework components 8\n\n3.2 Typical Ponmocup infrastructure 8\n\n**4 Delivery methods** **10**\n\n4.1 Delivery through ZIP file 11\n\n4.2 Delivery through a signed Java applet 11\n\n4.3 Delivery through a JAR loader 14\n\n**5** **\u0007Installation, persistence**\n\n**and functionality** **16**\n\n5.1 The Ponmocup installer 16\n\n5.2 Core functionality 17\n\n5.3 Specific functionality through plug-ins 19\n\n5.3.1 \u0007Plug-ins #14xx range – decide: finding interesting targets 22\n\n5.3.2 \u0007Plug-in #2600 – SIP scanner: collecting information\n\non SIP gateways 23\n\n5.3.3 \u0007Plug-in #2610 – router scan: collecting router information 26\n\n5.3.4 \u0007Plug-in for MS10-061 vulnerability: lateral movement 27\n\n**6 Command and control traffic** **28**\n\n6.1 Installer communication 29\n\n6.2 Main module communication 30\n\n6.3 Plug-in communication 30\n\n**7** **Anti-analysis techniques** **32**\n\n7.1 Checks for signs of analysis 32\n\n7.2 Delivery of fake payload 32\n\nAppendix i – Targeted keywords 34\n\nAppendix ii – Network based indicators of compromise 36\n\nAppendix iii – Host based indicators of compromise 38\n\n\n-----\n\n## 1 Introduction\n\n\n### Ponmocup, first discovered in 2006 as Vundo or Virtumonde, is one of the most successful botnets  of the past decade,  in terms of spread and persistence.\n\n\nFox-IT believes this is an underestimated botnet currently still in active use and under\n###### continuous development. Though Ponmocup has received only minimal attention\n\nfrom the security community and is often described as low risk, it is in fact a technically\n###### sophisticated malware framework with extensive functionality. The result of our\n\nresearch provides a complete time-line and unique insight into the modus operandi of\n\nthe operation around Ponmocup and describes all the important details of the malware.\n\nFurthermore, this report includes currently not publicly known indicators of compromise,\n\nboth on host and network level, where previous research only scratched the surface.\n\n\n-----\n\n## 2 Behind Ponmocup\n\n###### This chapter discusses non-technical aspects of the Ponmocup botnet:\n\n attribution, goals, impact and size.\n\n\n2.1 **Attribution**\n###### This section describes a number of aspects related to\n\nthe operators of the Ponmocup botnet.\n\nBased on the size of the command and control infrastruc###### ture, it is thought that the infrastructure is maintained, monitored and protected by a well-organized group of operators. This is amongst others based on the domains in use, number of proxies in use, estimated number of back-end systems, used delivery methods and limited\n\naffiliate schemes.\n\nIt was also observed that in certain cases, the operators\n\nreacted quickly to events which could impact the botnet’s\n###### infrastructure, suggesting that the operators closely\n\nmonitor their back-end infrastructure.\n###### In addition, some operators were observed as active\n\nmembers in underground advertisement fraud forum or\n\nsigned up for underground advertisement fraud schemes.\n\nIt is believed that the operators are most likely Russian\n###### speaking and possibly of Russian origin. This is based on the fact that instructions to business partners and\n\naffiliates are written in Russian, and that in the early days,\n\nPonmocup would not infect systems in the post-Soviet\n###### States of Ukraine, Russia and Belarus. However, this\n\nspecific block was later removed, for unknown reasons.\n\nAs for technical capabilities, it can be said that the oper\nators are fairly sophisticated. The successful combination\n###### of various components to execute a stealthy malware framework, in addition to the usage of undocumented Windows APIs to reset system restore points, suggests\n\ndeeper than regular knowledge of the Windows operating\n\nsystem. On top of that, it is certain that the operators have\n\nclose to 10 years of experience with malware development,\n\nas the first variant of Ponmocop (Vundo) was discovered\n\nin 2006. This translates into features of the framework\n\nthat were developed over time, quality tested with debug\n\n\n###### releases of various components, in order to increase\n\nrobustness and reduce the likelihood of discovery. This\n\nincludes the fact that everything in the framework (APIs,\n\nstrings, etc) is obfuscated. Furthermore, the infrastructure\n\n###### is well thought out and load balances victims between\n\ndomains and proxies as an anti-sinkhole measure. Finally,\n\nthe framework uses a number of anti-analysis methods,\n\nsuch as the fake payload and blacklisting of IP addresses\n###### and system fingerprints once an analyst or researcher\n\nis found. Some of these techniques will be discussed in\n\nmore detail further on in this paper.\n\n2.2 Goals and impact\n\nAs with any modern malware, the Ponmocup framework is\n\ncapable of supporting any objective, be it criminal or espi\n###### onage-oriented in nature. These theoretical capabilities,\n\nhowever, aren’t very useful in order to determine the oper\nator’s actual goals. Ponmocup’s real goals have remained\n\nsomewhat elusive over the years, primarily because Fox-IT\n\nhas only rarely seen any sustained activities taking place.\n###### Based on what is known now, Ponmocup’s operators\n\nare believed to be primarily interested in financial gain.\n###### However, they are currently either applying extreme restraint or carrying out their activities outside of  Fox-IT’s sphere of knowledge. Either way, they cherish\n\ntheir botnet and handle it with care. This can be supported\n\nby the following observations.\n\nAs shown in paragraph 2.3, Ponmocup is a large botnet,\n###### supporting a large amount of victims. This is a direct\n\nresult of its design:\n###### 1 It is difficult for traditional anti-virus solutions to\n\nreliably detect because it uses unique encryption per\n\ninfected system and locates its core components in\n\na unique location per infected system.\n\n2 It uses one-time domains for installation, which means\n\n###### that these domains cannot be used as indicators of\n\ncompromise over time or across organization.\n\n\n-----\n\n###### 15,000,000+ 500,000+ 2,400,000 Unique infections Currently infected Peak size infections\n\nInfections\n\nNon-infections\n\n\n_1_ _\u0007http://www.bbc.com/_\n\n_news/technology-18547935_\n\n_and http://www.gizmodo._\n\n_co.uk/2012/06/printer-virus-_\n\n_on-the-loose-good-day-for-_\n\n_paper-companies-bad-day-_\n\n_for-trees/_\n\n\n_Figure 2: Ponmocup key figures_\n\n###### 3 It supports theft of FTP and Facebook credentials\n\nout of the box, which Fox-IT believes may be used to\n\nsupport further spreading the botnet if needed.\n\n###### Finally, Ponmocup is believed to be aimed at financial\n\ngain for the following reasons:\n\n1 The plug-in that support advertisement fraud (ppc,\n\nabbreviation for ‘pay-per-click’) is the most actively\n\ndeveloped plug-in.\n###### 2 The framework appears to target mainly wealthy  and larger English speaking nations for banking,\n\ninvestment and trading websites that store sensitive\n\npersonal information which could help in committing\n###### fraud. Its targets originally comprised mainly EU and larger English speaking countries, which later narrowed down to English speaking countries only,\n\nnarrowing down even further to United Kingdom and\n\nUnited States only in 2012.\n\n3 It supports theft of Bitcoin wallets.\n\nAs already outlined, Ponmocup is believed to be aimed\n\nat financial gain. Although it is hard to quantify the exact\n\namount of money earned with the Ponmocup botnet, it\n###### is likely that it is already a multi-million dollar business for years now. There are multiple reasons to assume this is the case. Firstly, their infrastructure is complex, distributed and extensive, with servers for dedicated tasks. Secondly, they operate, maintain and monitor  their comprehensive infrastructure with a group of \n\noperators and are quickly able to mitigate potential risks\n###### that are discovered. Thirdly, the malware itself is very sophisticated using a multi staged loader and sophisti\n\n###### cated AV evasion techniques, trying to stay under the radar as much as possible, in order to avoid detection.\n\nFox-IT believes, based on the earlier mentioned reasons,\n###### that they are protecting a very well run organization and infrastructure, for their main motivation: earning\n\ntons of money.\n\n2.3 **Size**\n###### Having established that Ponmocup’s primary goal is likely financial gain, it is interesting to look at its size. Fox-IT has determined that Ponmocup has infected a\n\ncumulative total of more than 15 million unique victims\n\nsince 2009. At its peak, in July 2011, the botnet consisted\n\nof 2.4 million infected systems, which as far as botnets go,\n\nis huge. The botnet has since then shrunk in size as a result\n\nof a coordinated sinkhole action and natural rotation of\n\nbots. Currently, there are still more than 500,000 victims\n\nchecking in to command and control servers each month.\n\nFor distribution purposes, more than 5000 websites have\n###### been compromised since 2009, using FTP credentials stolen by Ponmocup components, in order to further\n\nspread the malware.\n\n###### Compared to other botnets, Ponmocup is one of the\n\nlargest currently active and, with 9 consecutive years, also\n\none of the longest running. Ponmocup is rarely noticed\n\nthough, as the operators take care to keep it operating\n\nunder the radar. An update that included a failed printer\n\nexploit, in 2012, provided a rare moment in the lime lights:\n###### it caused printers worldwide to start printing garbage\n\ndata until they ran out of paper or ink[1].\n\n\n-----\n\n## 3 \u0007Overview of the technical framework\n\n###### Ponmocup is a malware framework, written in C++, designed to infect\n\n and remain persistent on a large number of victim machines. This\n\n chapter describes the components that comprise the framework.\n\n\n3.1 **Framework components**\n###### The Ponmocup framework employs a number of  components to deliver, install, execute and control the malware, as listed in Table 1. Each component uses \n\ndifferent anti-analysis methods to prevent the framework\n\nfrom being discovered.\n\n###### Reverse engineering the functionalities can be a labor- intensive process, as the malware executes over  various stages, where each string is decrypted in-line\n\nusing various algorithms. Components that are integral\n\nto the functioning of the framework are often encrypted\n\nor stored using information specific to a victim’s system.\n\n\n3.2 Typical Ponmocup infrastructure\n\nThe infrastructure used to control the botnet is designed\n\n###### to be resilient to disruption attempts, using a separate\n\ninfrastructure per component. This requires an extensive\n\nserver set-up which is constantly monitored for perfor\nmance issues and disruption attempts by external parties.\n\nPonmocup communicates to back-end servers over several\n\nproxy layers and each victim can use a specific group of\n\nproxies to communicate. Using proxy groups means that\n\n###### the botnet is spread over several domains, a technique\n\nthat makes taking down the entire botnet difficult.\n\n\n**Component** **Purpose**\n\n\nDelivery Delivery methods used to infect victims with Ponmocup\n\nInstaller Installs Ponmocup persistently, thoroughly checks the target machine for analysis capabilities\n\nInitiator DLL stored on disk, starts the loader in memory and hands over control to the loader\n\nLoader Finds the location of the registry key containing the encrypted main module and plug-ins,\n\ndecrypts the content, starts and hands over control to the main module\n\nMain module Communicates with command and control server and retrieves and executes plug-ins\n\nPlug-ins Provide functionalities for specific tasks\n\nBack-end infrastructure Infrastructure used to control compromised systems\n\n_Table 1: Overview of Ponmocup components and their purpose_\n\n|o he iff ro ev nt ar si o t r s Co De|mp m er m er en io ng he to m liv|o al en be se si us va fu re po ery|ne wa t a in e ve st ri nc d u ne|nt re nti g d ng p ag ou ti si nt|s t, a -a is ine ro es s a on ng|o s l nal co er ce, w lg ing in|de ist ys ver in ss h ori o for|liv ed is ed g t, er th f t m|er in me . he as e e ms he ati|, i T th f th ac . C fr on|\n|---|---|---|---|---|---|---|---|---|---|---|\n|Ins|tal|ler|||||||||\n|Ini|tia|tor|||||||||\n|Lo|ad|er|||||||||\n|Ma|in|m|od|ule|||||||\n|Plu|g-|ins|||||||||\n|Ba|ck-|en|d i|nfr|as|tru|ct|ure|||\n\n|ta le s t cti m str mp ew pe P D|ll, 1. o on al in o o cif urp eli|ex Ea pre al wa g i ne rk ic os ver|ec ch ve iti re s d nt ar to e y|ut co nt es e e s t e o a v me|e m th ca xe cry ha fte ict th|an po e f n c pt t a n im ods|d ne ra be ut e re en ’s u|co nt m a l es d i in cr sy sed|\n|---|---|---|---|---|---|---|---|---|\n|In|sta|lls|Po|n|mo|cu|p p|er|\n|D|LL s|to|re|d o|n d|isk|, s|tar|\n|Fi de|nd cr|s t yp|he ts|loc the|at c|ion ont|o en|f th t, s|\n|C|om|m|uni|ca|tes|w|ith|co|\n|Pr|ov|ide|fu|nc|tio|na|lit|ies|\n|In|fra|st|ruc|tu|re|us|ed|to|\n\n\nThe operators have gone out of their way to try and defeat\n\ndetection by anti-virus software, automated analysis, as\n\nwell as manual analysis. Their attempts have proven very\n###### successful: over the last five years only a few analyses\n\nof Ponmocup have been published, of which none have\n\nmanaged to uncover the full truth of the framework.\n\n\nPlug-ins carrying out specific tasks or exfiltrating specific\n###### data make use of separate proxies as well as separate\n\nback-end servers.\n\nA simplified overview of the infrastructure between the\n\noperators and a victim is shown in Figure 3.\n\n\n-----\n\n_Figure 3: Typical infrastructure including victim and operators_\n\n\n-----\n\n## 4 Delivery methods\n\n###### This chapter describes historic and current delivery methods used to\n\n distribute the Ponmocup malware\n\n\n###### From 2009 to 2011 the two main methods used to  distribute Ponmocup were fake codec packs and fake\n\nFlash Player updates. However, after a sinkhole attempt\n###### in 2011 [2] the authors developed their own distribution method, publicly known as Zuponcic [3], named after \n\nthe first website that was compromised for distri­bution\n###### purposes using this method. Although Zuponcic is \n```\n    |myspace\\.|bebo\\.).*$ [NC,OR]\n    |google\\.).*$ [NC,OR]\n    |netscape\\.).*$ [NC,OR]\n    |alltheweb\\.).*$ [NC,OR]\n    |instagram).*$  [NC]\n  RewriteCond %{HTTP_REFERER}!^.*(imgres).*$  [NC]\n\n```\ncommonly described as an exploit kit, that actually isn’t\n\nan accurate description because it doesn’t use exploits.\n###### Instead, it uses three distinct infection vectors, which\n\nin most cases depend on interaction with the victim.\n\nWebsites affected by Zuponcic are typically compromised\n\nusing FTP credentials, stolen from machines infected by\n\nPonmocup. This allows the operators behind Ponmocup\n\nto upload a carefully crafted .htaccess file to every acces\n###### sible folder. It redirects visitors from the compromised website to the Zuponcic delivery mechanism. The code in the .htaccess file responsible for this redirect is placed between 500 blank lines to make it seem as if the file is empty. This code itself makes sure that not just anyone gets redirected to the malicious website;\n the visitor must have visited the compromised website\n\n\n###### via a search engine, social media network or webmail\n\napplication. This reduces the number of potential victims,\n\n###### but often filters out potential victims that would more easily notice a website behaving out of the ordinary, such as the owner of the website or frequent visitors.  A snippet from the .htaccess file checking for valid\n\nreferrers:\n\n###### Once a visitor is attacked by Zuponcic, their IP-address is\n\nblacklisted and will no longer be targeted until the IP-address\n\nis cleared from the blacklist, regardless of whether the attack\n\nwas successful or not. Additionally a cookie is placed on the\n\nmachine to make sure that not only the IP-address, but also the\n\nactual machine itself is blacklisted. Potential victims redirected\n\nby the .htaccess file are first taken to an intermediate website\n\n(typically hijacked GoDaddy domains) using one out of 60\n\nlisted URI patterns. The conditions that a potential victim\n\nhas to meet in order to be attacked are visualized in Figure 5.\n\nBecause Zuponcic requires a valid referrer chain and blacklists\n\nan IP-address after a single hit and most URL analysis tools fail\n\nto perform dynamic analysis on these compromised websites,\n\n###### most of these websites are falsely classified as ‘safe’ and\n\nremain compromised for relatively longer periods.\n\n|Col1|Col2|R R R R R R|ew ew ew ew ew ew|ri ri ri ri ri ri|te |m te |g te |n te |a te |i te|Co ys Co o Co et Co ll Co ns Co|nd p nd og nd s nd th nd t nd|ac le % ca e ag|%{ e\\ %{ \\.) {H pe %{ we %{ ra %{|HT .|b HT .* T \\. HT b\\ HT m) HT|TP e TP $ TP ).* TP .). TP .* TP|_R bo _R [N _R $ _R *$ _R $ _R|EF \\.) EF C, EF [N EF [ EF EF|ER .* ER OR ER C, ER NC ER [N ER|ER $ ER ] ER OR ER ,O ER C] ER|} [N } }^ ] }^ R] }^ }!|^( C, ^( (h (h (h ^.*|ht OR ht tt tt tt (i|tp ] tp p\\ p\\ p\\ m|\\: \\: :\\ :\\ :\\ gr|\\/ \\/ /\\ /\\ /\\ es|\\/)?([^\\/\\?]*\\.)?(tweet|twit|linkedin|instagram|facebook\\. \\/)?([^\\/\\?]*\\.)?(hi5\\.|blogspot\\.|friendfeed\\.|friendster\\. /)?([^\\/\\?]*\\.)?(yahoo\\.|bing\\.|msn\\.|ask\\.|excite\\.|altavista\\. /)?([^\\/\\?]*\\.)?(aol\\.|hotbot\\.|goto\\.|infoseek\\.|mamma\\. /)?([^\\/\\?]*\\.)?(lycos\\.|metacrawler\\.|mail\\.|PINterest ).*$ [NC]|\n|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|\n\n\n-----\n\n_Figure 4: Using victim’s own keywords for payload filename_\n\nBecause the certificates used by Zuponcic are stolen from\n\nvictims that have been infected by Ponmocup, it typically\n\ndoes not take long for a revoked certificate to be replaced\n###### by a new one. In most cases revoked certificates were\n\nreplaced with a newly stolen certificate within 1–3 weeks.\n\n###### The file doing all the work, FlashPlayer.class, is heavily\n\nobfuscated using control flow obfuscation. Additionally,\n###### all strings are encoded using an encoding key which \n\nconsists of dynamic values from the process stack. This\n###### works if the class and calling method names are static,\n\nwhich has always been the case for Zuponcic; the class\n\n###### name is ‘FlashPlayer’ and calling method is ‘init’, which\n\nresults in ‘FlashPlayerinit’ as the decoding key.\n\nfinal StackTraceElement\n```\n  stackTraceElement = new Exception().\n\n```\ngetStackTrace()[1];\n\nfinal String string = new\n\nStringBuffer(stackTraceElement.\n```\n  getMethodName()).insert(0,\n  stackTraceElement.getClassName()).\n\n```\ntoString();\n\n###### FlashPlayer.class will create an empty .tmp file with a\n\nrandom short name (2–5 characters) in the TEMP directory.\n\n###### It then HTTP POSTs to the Zuponcic host, using a token\n\nwhich is unique per victim, to retrieve an RC4 encrypted\n\npayload. This payload is then stored in the .tmp file and\n\ndecrypted with a key also uniquely generated per victim\n###### (taken from the landing page). If the applet is allowed to run, it will execute the payload, once executed the browser redirects the victim to the actual website that\n\n|Because victims does no by a ne replace The file obfusca all strin consist works i which h name is results|t th t t w d w d te gs s o f t as ‘F in|he at ak on it oin d a f d he al la ‘Fl|ce ha e l e. h a g usi re yn cl w sh as|rti ve on In n all ng e a as ays Pla hP|fic be g f m ew th co nc mi s a b ye la|ate en or os ly e nt od c v nd ee r’ yer|s in a r t c st wo ro ed alu c n an in|us fe ev as ole rk l f u e alli th d it’|ed ct ok es n, F lo si s fr ng e c ca as|by ed ed re cer la w o ng o m as llin th|Z by ce v ti sh bf an m t et e f g e|up P rti ok fic Pl us e he h or m de|on on fic ed ate ay ca nc p od Z eth co|cic mo at ce w er. tio o ro na up o di|ar cu e t rt ith cla n. din ce m on d i ng|e s p, o b ifi in ss A g ss es ci s ‘i ke|to it e cat 1–, is dd ke st ar c; t ni y.|le ty re es 3 h iti y ac e he t’,|n f pic pla w we ea on wh k. sta c w|ro all ce er ek vil all ic Th ti las hic|m y d e s. y y, h is c, s h|\n|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|\n|fni a sta get fni a Str get sta toS|l ck St l in Me ck tr|S Tr a S g t Tr i|ta a ck tr Bu ho a ng|ck ce Tr in ff dN ce ()|Tr El ac g er a El ;|ac em e( st (s me em|e e )[ r t () e|El nt 1] in ac ). nt|em = ; g kT in .g|en n = ra se et|t e n ce rt C|w ew E (0 la|Ex le, ss|ce me Na|p n m|ti t. e(|on )).|()|.|||\n\n\n_2_ _\u0007How Big is Big? Some Botnet_\n\n_Statistics - https://www._\n\n_abuse.ch/?p=3294_\n\n_3_ _http://blog.Fox-IT.com/2013/_\n\n_12/19/not-quite-the-average-_\n\n_exploit-kit-zuponcic/_\n\n\n###### Once a visitor is actually redirected to the Zuponcic landing page he or she is targeted based on the used browser and presence of the Java browser plug-in. The decision chart in Figure 6 depicts the various methods\n\nused to infect visitors with the Ponmocup payload. The\n\nnext paragraphs describe each method in more detail.\n\n4.1 **Delivery through ZIP file**\n###### Using a browser other than Internet Explorer 8/10 or  not having Java installed, a victim will receive a ZIP file\n\ncontaining the payload. The name of the ZIP and embedded\n\npayload is derived from the previously used search terms,\n\nas shown inFigure 4.\n\nCompared to the attack vectors abusing Java, described\n\nin paragraphs 4.2 and 4.3, this attack method puts in very\n\nlittle effort to hide the payload. Perhaps the operators felt\n\nsafe enough to introduce this method to their arsenal of\n\ninfection vectors at the cost of slightly more attention.\n\n4.2 Delivery through a signed Java applet\n\nThis infection vector relies on social engineering or out\ndated Java software in order to execute a Java applet.\n\nThese applets are typically run in a sandbox, in order to\n\nprevent them from touching the file system, so to drop\n###### the Ponmocup installer on a victim’s machine this Java applet has to escape the sandbox. Ponmocup success- fully does so because the Java applet is signed with a valid certificate, stolen from a legitimate organization. Older versions of Java (pre-dating Java 7 Update 21 to be specific) which blindly trust certificates issued by authorities, will run this applet outside of the sandbox\n\nwithout even asking for the user’s permission.\n\nRecent versions of Java always prompt for user approval\n###### before running applets, though in this case the applet\n\nmight still appear legitimate to potential victims, as the\n\napplet is still signed with a valid certificate and claims to\n\nbe executing an application with the name ‘FlashPlayer’.\n###### The certificates listed in Table 2 have all been used by\n\nZuponcic to infect victims with Ponmocup.\n\n\n-----\n\n##### Zuponcic flow\n\n\n_Figure 5: Zuponcic redirection flow_\n\n\n-----\n\n_Figure 6: Zuponcic attack flow_\n\n\n-----\n\n**Subject** **Fingerprint (SHA1)** **Issuer** **Year**\n\n\nKurz Instruments, Inc. 8A:DC:2D:8B:B5:3C:DC:93:C9:80:C4:F6:C0:80:59:73:8B:88:19:16 GlobalSign 2012\n\nR P InfosystemsPvt Ltd BB:48:74:0F:01:E6:7F:EE:A6:06:96:4B:D5:81:A7:30:BF:D0:54:D7 VeriSign 2012–2013\n\niLoqOy 76:90:09:5B:C3:FC:9F:9D:74:98:56:F6:E1:DD:22:C0:89:44:F7:F9 VeriSign 2013–2014\n\nAUZSOLUTIONS.com.au F1:39:8E:53:D1:F8:FC:06:34:F5:4E:68:72:88:5F:31:CC:09:35:23 COMODO 2014\n\nQueen’s University 73:E8:D6:F3:91:77:2A:7F:AE:81:C3:81:73:14:2E:C8:F6:28:2A:E4 UserTrust 2015\n\n_Table 2: Stolen certificates used in the delivery of Ponmocup_\n\n\n###### was visited, whether the execution is successful or not, leaving to believe nothing strange has happened, \n\n\nengineering, Zuponcic tricks many victims into running\n###### its malicious payload. This is done by using the search\n\nterms used in the redirecting search engine in the payload\n\nname, as shown in the example in Figure 4.\n\nThis JAR file contains an RC4 encrypted payload. The key is\n\nbased on the target’s IP address. This means the key and\n\n###### the embedded encrypted binary are unique per target. Once the JAR is executed, the code below recovers the\n\n|w n a I t r 4 A m f|a ot p f e ha ou .3 t a or|s v , l ro xe t t tin D arg nu an|is ea ces cu he e eli et all yo|ite vin s tio cr pr ve u y d ne|d, g ou n o eat ev ry sin o to|w to tli f t ed en t g I wn r|he b ne he .t ts hr E1 loa un|th eli d i p mp an ou 0 de th|e ev n ayl fli y e gh wil d is|r t e n Fig oa e i vi a l r an ma|he ot ur d f s d de JA ec d e nu|e hi e 7 ai el nc R l eiv xe al|xe ng . ls, ete e f oa e cu ly,|cu st Fla d f ro d a J te bu|ti ra sh ro m er AR d. t t|on ng Pl m bei fil It hr|is e ay dis ng e ma ou|s ha er. k. le wh y s gh|uc s h cla Th ft ich ee cl|ce a ss is ar h m ev|ss pp en cle ou as un er|Col23|\n|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|\n|||fi (o s fi I fi S b fi i m { } fi|na p et na np na tr uf na f at na|l en Re l ut l in fe l (( ch g l|UR Co qu Bu St St g re Ma ma er ro by|LC n e f r ri gr d t tc (r up t|o ne st fe ea n o Re ch he e e[|nn ct Pr re mR g up ad er r ad = ]|ec io op dR ea re = e m = Li ma di|t n e e d ad \" r.c a P ne tc ge|io = rt ad er L \"; l tc at )) he st|n n y( er (o in os he te .f r.|op ew \"U b pe e e( r; r ni d g =|e U se u n = ); n. () ro Me|nC R r ff Co b co ) up ss|on L( -A er nn uf mp () a|ne \"h ge e ec fe il ; ge|c tt nt dR t re e Di|ti p: \", ea io d (\" ge|on // de n. Re ([0 s|; ch \"M r ge ad - t.|eckip.dyndns.com\").openConnection()). ozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1)\"); = new BufferedReader(new tInputStream())); er.readLine(); 9]{1,3}\\\\.[0-9]{1,3}\\\\.[0-9]{1,3}\\\\.[0-9]{1,3})\"). getInstance(\"MD5\").digest(group.getBytes());|\n\n\n-----\n\n_Figure 7: Java Applet retrieving and executing payload using per connection specific information_\n\n\n### Through clever social engineering, Zuponcic tricks many victims into running its malicious payload.\n\n\n-----\n\n## 5 \u0007Installation, persistence  and functionality\n\n###### This chapter describes the core components of Ponmocup, its method\n\n of installation, achieving persistence and its modular system of plug-ins\n\n aimed at providing a wide variety of functions on compromised systems.\n\n\n5.1 **The Ponmocup installer**\n###### The installer is responsible for persistently installing\n\nvarious Ponmocup components on a system. This para\ngraph focuses on components installed directly on disk.\n\nAll other core components are stored and encrypted in\n\nthe registry. Without these, the initiator described in this\n\nchapter cannot function.\n\n###### Depending on the privileges available to the installer,\n\nthe initiator can either be installed in the system direc\ntory or in the Application Data directory. When run with\n\nadministrative privileges, the initiator will be named after\n\nan existing file in the system directory, with 1–2 random\n\ncharacters appended. For example, a randomly selected\n\nlegitimate file could be:\n\n```\n<Principals>\n\n```\n<Principal id=\"Author\">\n\n<UserId>System</UserId>\n\n<RunLevel>HighestAvailable</RunLevel>\n```\n<LogonType>InteractiveTokenOrPassword\n   </LogonType>\n</Principal>\n</Principals>\n\n```\n<Actions Context=\"Author\">\n```\n<Exec>\n\n```\n<Command>C:\\Windows\\system32\\\n\nrunDLL32.exe</Command>\n\n<Arguments>\"C:\\Windows\\system32\\\n\nmsg711A.DLL\",ZBADQX</Arguments>\n```\n</Exec>\n\n```\n</Actions>\n\n\nIf stored in the system directory the file will have the R\n\n(Read-only), S (System) and H (Hidden) attributes set. The\n\ninstaller adds a scheduled task to start the initiator during\n###### system boot, with the privileges of NT AUTHORITY\\\n\nSYSTEM:\n\n|Col1|Col2|C:|\\W|i|nd|ow|s\\|S|ys|te|m3|2\\|m|sg|71|1.|ac|m|Col20|Col21|Col22|Col23|\n|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|\n||n|d t|he|P|on|m|oc|up|in|iti|at|or|wo|ul|d|be|na|m|ed|:|||\n|||C:|\\W|i|nd|ow|s\\|S|ys|te|m3|2\\|m|sg|71|1A|.D|LL|||||\n\n\n###### This effectively means that the core function- alities of Ponmocup  are uniquely encrypted  and stored in a unique  location for every victim.\n\n\nWithout administrative privileges the initiator is stored\n###### in the Application Data directory with a random name (6–10 characters) and initiated during system boot via \n\na run-key in the registry.\n\nDuring installation some additional tasks are carried out\n\nby the installer to ensure persistence. One of these tasks,\n\nnot often seen, is to delete all system restore points and\n\nto disable the system restore option itself. To achieve this\n\n###### Ponmocup makes use of two APIs from the srclient.DLL library; srclient.ResetSR and srclient.DisableSR. These APIs are not documented by Microsoft, which is one of\n\n\n-----\n\n|Col1|Col2|Col3|Col4|Col5|Col6|Col7|\n|---|---|---|---|---|---|---|\n|ks|||||||\n||||||||\n||||||||\n\n\n###### Memory\n\n**Loader**\n\nModified UPX\n\ncompressed dll\n\n**Decrypt and load**\n\n**main module and plug-ins**\n\n**Main module** **Plug-ins**\n\nRuns Execute\n\npersistently specific tasks\n\n\n###### Disk\n\n**Scheduled task**\n\n**Initiator**\n\nPacked DLL,\n\nstored on disk\n\n**Allocate memory**\n\nAllocate and transfer control\n\nto new binary in memory\n\n\n###### Starting the Ponmocup core is a three part process consisting of the DLL on disk (initiator), a custom UPX compressed DLL in memory (loader) and the payloads\n\nin registry (main module and plug-ins):\n\n1 The initiator is started by the scheduled task or run key;\n###### 2 Once loaded into memory the initiator transfers\n\ncontrol to a (modified) UPX compressed DLL;\n###### 3 This DLL acts as a loader for the main module and\n\nplug-ins.\n\nThe loader has the most important responsibilities in this\n\nprocess, as it has to find the main module and plug-ins,\n\nwhich are all encrypted and only stored in registry; both\n###### the encryption key and location are based on unique aspects of a victim’s machine. This effectively means\n\nthat the core functionalities of Ponmocup are uniquely\n\nencrypted and stored in a unique location for every victim.\n\n\n###### Registry\n\n**System information**\n\nVolumeSerialNumber,\n\nSystem directory and root\n\ndirectory creation times\n\n**Encrypted main**\n\n**module and plug-ins**\n\n**Information storage**\n\nCheck-sums\n\nConfigs\n\nCounters\n\n\n_4_ _\u0007https://isc.sans.edu/_\n\n_forums/diary/Some+tricks+_\n\n_from+Confickers+bag/5830/_\n\n\n_Figure 8: Overview of the process of loading Ponmocup_\n\nthe indicators that the operators have a thorough under\nstanding of windows internals, which displays a certain\n\nlevel of sophistication which is seen throughout the entire\n\n###### framework. One of these particular APIs (ResetSR) was\n\nalso used by the Conficker worm[ 4].\n\n5.2 Core functionality\n\nThe core of Ponmocup are the components installed on\n\na victim’s machine by default. These mainly include the\n\n###### components responsible for starting the main module, but also include persistent plug-ins providing specific\n\ntasks for persistence purposes.\n\nAs shown in Figure 8, loading Ponmocup is a multi-step\n\nprocess which is best broken down into three categories:\n\nfiles on disk, activity in memory and the usage of stored\n\ninformation in the Windows registry.\n\n\n-----\n\n###### The following unique information about the victim’s\n\nmachine is used to base the encryption on:\n\n- Date and time of the system directory creation\n\n- Volume serial number of the root directory of the\n\nvolume Ponmocup is installing on, retrieved through\n\nthe GetVolumeInformation API\n\n###### • Date and time of the System Volume Information\n\ndirectory creation\n\nAs can be seen in the code snippet below, these unique\n\nvalues are each XOR’d with their combined value, forming\n\na 16 bytes key which is used to encrypt the main module.\n###### For encryption a slightly modified version of the RC4\n\nalgorithm is used.\n\nThese values are used to uniquely generate the location\n\nof the main module and plug-ins in the Windows Registry.\n\nAn example of what the registry keys might look like:\n\nHKEY_CURRENT_USER\\Software\\wkcxjxlv\\\n\nWjtnpgzc\n\nIn this case the ‘Wjtnpgzc’ key stores the Ponmocup main\n\nmodule, and persistent plug-ins. Once decrypted using\n\nthe unique key, the value of this registry key is typically\n\noutlined as follows:\n\n- Total size of decrypted content (first 4 bytes);\n\n- Main module;\n\n- Persistent plug-in(s).\n\n\n###### Using this machine specific information the loader can find the location of the encrypted main module  and plug-ins in the Windows Registry, decrypt their \n\ncontents and execute the payloads. Before decrypting,\n###### these machine-specific values are verified against the checksums, which were stored in the registry during\n\ninstallation, to check if none of these values have changed.\n\nIf these checks succeed, the decryption routine is started.\n\nAfter decryption the loader verifies the integrity of the\n###### decrypted content by comparing the CRC32 checksum\n\nof the result with the checksum of the content before it\n\nwas stored in registry during installation. Once this final\n\ncheck succeeds, plug-ins stored in registry are executed\n\nand control is given to the main module, which can then\n\ninitiate command and control traffic. If at any stage during\n###### this process, a verification or integrity check fails, the\n\nPonmocup execution process halts.\n###### The main module and plug-ins can interact with each\n\nother using shared memory. This functionality is mainly\n\nused by plug-ins that only run if the main module is indeed\n\nactively running.\n\n###### Both the main module and plug-ins use the registry to\n\nstore configs, checksums or other relevant information\n\nstorage such as counters or IDs. Information storage that\n\nmay be helpful during a forensic investigation could, for\n\nexample, be:\n\n- Main PIN[5] ID\n\n   - A PIN indicates a group of plug-ins which will be\n\nrun on a victim’s machine at some point in time.\n\n|v a F a T o A|al 16 or lg he f t n|ue b e ori se he ex|s a yt nc th v m am|re es ry m alu ain p|ea ke pti is es m le|ch y w on us ar o of|XO hi a ed e du w|R’ ch sl . us le ha|d is ig ed an t t|wit us htl to d p he|h t ed y u lu re|he to mo niq g-i gis|ir e d ue ns tr|co nc ifi ly in y k|m ry ed ge th ey|bin pt ve ne e s|ed th rs ra Wi mi|v e m io te nd gh|alu a n o th ow t l|e, in f e l s R oo|fo mo th oc e k l|Col23|Col24|\n|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|\n|||H W|KE jt|Y_ np|CU gz|R c|RE|NT|_U|SE|R\\|S|of|tw|a|re|\\w|kc|xj|x|lv|\\||\n|I t o • • •|n t mo he ut|his du u lin To M Pe|c le niq ed ta ai rs|ase , a ue a l s n ist|th nd k s f ize mo en|e p ey oll o du t|‘W ers , t ow f d le plu|jtn ist he s: ec ; g-|p en va ry in|gzc t lu pt (s).|’ k plu e o ed|ey g- f t co|st in hi nt|or s. s r en|es On eg t (|th ce ist fir|e P d ry st|on ec ke 4|m ry y i by|oc pte s t te|up d yp s);|||\n|||/ k k k k / k k k|* ey ey ey ey * ey ey ey|se _1 _1 _1 _1 xo _1 _1 _1|tu [0 [1 [2 [3 r [0 [1 [2|p ] ] ] ] */ ] ] ]|k = = = = ^= ^= ^=|ey ts d t k|s ys wV sy ey ke ke ke|*/ 32 ol sv _1 y_ y_ y_|d um ol [2 1[ 1[ 1[|ir e i ] 3] 3] 3]|.d Se nf + ; ; ;|wL ri od k|ow al ir ey|Da ; .d _1|te w [0|Ti Lo ]|m wD +|e at k|^ eT ey|ts i _1|ys32dir. dwHighDateTime; me ^ tsysvolinfodir.dwHighDateTime; [1] - 0x6F6F6F70;|\n\n\n-----\n\n###### - Some of these plug-ins that belong to the PIN\n\ncan be persistent, but some plug-ins might only\n###### be executed once. Knowing the PIN ID could  help identify what type of tasks may have been\n\nexecuted on a victim’s machine.\n\n###### - If, for example, this value stores 0x4A39, the  PIN ID is 19001. Please see the next paragraph \n\nfor more detailed information.\n\n- Run counter\n\n   - The main module increases a counter in registry\n\nfor every minute it’s been active.\n\n###### - If, for example, this value stores 0x0F, the main\n\n\nshare more than 4000 different versions, indicating this\n\nframework is under continuous development.\n###### The following paragraphs describe some of the more\n\nprominent plug-ins used in the Ponmocup framework.\n\nPlug-ins can either be present in memory only, or remain\n###### persistent by being stored and encrypted in the same \n\nregistry key as the main module. Whether or not a plug-in\n\nremains persistent is dependent on the type of functional\nities the plug-in provides. Once retrieved, a plug-in can make\n\nitself persistent by using the machine specific information,\n\nmentioned in chapter 5.2, to encrypt and append itself to\n\nthe registry key which stores the main module and the other\n\nplug-ins. The quality of the plug-ins are thoroughly tested\n\nusing specifically developed debug versions.\n\n###### Identifying plug-ins is possible by analyzing their PE headers: at offset 0x20 a standard PE header contains a\n\nreserved word (WORD e_res[4]), of which e_res[3] is used\n\nby Ponmocup to store the ID of the corresponding plug-in.\n\nThe version of the plug-in ID can be found 3 bytes further\n\nat WORD e_oemid.\n\n###### In the example below, the PE header stores the value 0x044C (little-endian) in WORD e_res[3] and 0x0BBB\n\n(little-endian) in WORD e_oemid, resulting in plug-in ID ‘1100’\n\nand version ‘3003’ (typically written as plug-in 1100.3003).\n\n###### Table 2 provides an overview of the most important \n\nplug-ins, which are basically all DLLs given a unique iden\n\n_5_ _\u0007The PIN number – a term_\n\n_used by the operators and of_\n\n_unknown origin – is one of the_\n\n_values stored in the registry._\n\n|Col1|Col2|rsi ne tr . T ec yin : a d o sio e xa C ( di sio p , w rs|st d i y k he ifi g t wo cu n _o m lit an n ‘ ro h io|ent n c ey q cal pl off rd p t of em pl tle ) in 30 vid ich n n|b ha w ual ly ug se (W o s th id e b -e W 03 es ar u|y u pt hic ity de -in t 0 OR to e p . el nd OR ’ (t a e mb|sin er h s o ve s x2 D re lu o ia D yp n ba er|g 5.2 to f th lo is 0 e_ th g-i w, n) e_ ic ov sic a|the , t res e pe po a s re e I n I th in oe all er all nd|m o e th pl d d ss ta s[4 D o D c e P W mi y w vie y a na|ac n e ug- eb ib nd ]), f t an E O d, r rit w ll m|hi cry ma in u le ar of he b he RD es te o DL e|ne pt in s a g v by d P w co e f ad e_ ult n a f t Ls by|sp an mo re er a E hi rr ou er re in s p he gi th|ec d d th sio na he ch es nd s s[ g in lu m ve e o|ifi ap ule or ns ly ad e_ po 3 tor 3] p g-i os n a p|c in pe an ou . zin er re nd by es an lug n 1 t u era|fo nd d t gh g co s[3 ing te t d -in 10 im niq to|rm it he ly th nt ] i p s f he 0x ID 0. po ue rs|at se o tes ei ai s u lug urt va 0 ‘11 30 rt id .|io lf t the te r P ns se -i he lu BB 0 03 an en|n, o r d E a d n. r e B 0’ ). t -|\n|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|\n|00000000 4d 5a 90 00 03 00 00 00 04 00 00 00 00000010 b8 00 00 00 00 00 00 00 40 00 00 00 00000020 4c 04 00 00 bb 0b 00 00 00 00 00 00 00000030 00 00 00 00 00 00 00 00 00 00 00 00 00000040 0e 1f ba 0e 00 b4 09 cd 21 b8 01 4c 00000050 69 73 20 70 72 6f 67 72 61 6d 20 63 00000060 74 20 62 65 20 72 75 6e 20 69 6e 20 00000070 6d 6f 64 65 2e 0d 0d 0a 24 00 00 00 00000080 50 45 00 00 4c 01 04 00 00 00 00 00|c 6 4 0|ff 00 00 80 d 1 4 0 00|f 0 0 0 2 6 4 0 0|f a 0 0 1 e f 0 0|0 0 0 0 5 6 5 0 0|0 1 0 0 4 e 3 0 0|0 0 0 0 6 6 2 0 0|0 0 0 0 8 f 0 0 0||| | | | | | | | ||M .. L .. .. is t m P|Z. . .. . . b od E.|.. .. .. .. .. pr e e .L|. .. . .. .. og ru .. .|.. . .. . .! r n .. ..|.. @. .. .. . am i $ ..|. .. .. .. .L c n .. .|.. . . . .! a D .. ..|.. .. .. .. T nn OS .. ..|.| .| .| .| h| o| | .| .||||\n\n\n-----\n\n**Identifier** **Name** **Purpose** **Versions**\n\n\n1100 new\n\ndownloader\n\n\nThis plug-in is known as the main module of the Ponmocup framework. Retrieves and\n\nexecutes additional plug-ins.\n\n\n3003\n\n6\n\n\n1300 history tool Collects and exfiltrates browser history from all popular browsers. This plug-in is\n\ndeprecated and it’s functionality are currently implemented in the 14XX plug-in range.\n\n\n1350 avkill Disables anti-virus related services that could potentially stop Ponmocup from functioning. 104\n\n\n1400\n\n\ndecide\n\ndecide_\n\nvkusnota[6]\n\ndecide\n\nppc [7]\n\nppc\n\nppc\n\n\nRetrieves browser history for all popular browsers, and checks if any URLs of interest to\n\nthe operators were visited by the victim (only checked using a checksum). If this is the\n\ncase these URLs are exfiltrated to a back-end server where this information is logged.\n\nThis plug-in is only retrieved if the target is in one of the following countries of interest:\n\n- \u0007Australia, Belgium, Canada, Switzerland, Germany, Denmark, Estonia, France, United\n\nKingdom, Mexico, Netherlands, Norway, New Zealand, Portugal, Sweden, United States\n\nRetrieves browser history for all popular browsers, and checks if any URLs of interest to\n\nthe operators were visited by the victim (only checked using a checksum). If this is the\n\ncase these URLs are exfiltrated to a back-end server where this information is logged.\n\nThis plug-in is only retrieved if the target is in one of the following countries of interest:\n\n- Australia, Canada, New Zealand, United States, United Kingdom\n\nRetrieves browser history for all popular browsers, and checks if any URLs of interest to\n\nthe operators were visited by the victim (only checked using a checksum). If this is the\n\ncase these URLs are exfiltrated to a back-end server where this information is logged.\n\nThis plug-in is only retrieved if the target is in one of the following countries of interest:\n\n- United States, United Kingdom\n\nAdvertisement fraud plug-in. Plug-in can inject code into the processes of Chrome,\n\nFirefox and Internet Explorer. When certain keywords are detected, a victim can be\n\nredirected to an alternative page (taken from an encrypted config in the registry).\n\nThis plug-in is specifically used for the PIN[8] 3xx, 160xx and 170xx ranges.\n\nAdvertisement fraud plug-in. Plug-in can inject code into the processes of Chrome,\n\nFirefox and Internet Explorer. When certain keywords are detected, a victim can be\n\nredirected to an alternative page (taken from an encrypted config in the registry).\n\nThis plug-in is specifically used for the PIN 150xx range.\n\nAdvertisement fraud plug-in. Plug-in can inject code into the processes of Chrome,\n\nFirefox and Internet Explorer. When certain keywords are detected, a victim can be\n\nredirected to an alternative page (taken from an encrypted config in the registry).\n\nThis plug-in is specifically used for the PIN 190xx range.\n\n\n135\n\n1\n\n85\n\n587\n\n1\n\n26\n\n10\n\n24\n\n9\n\n1\n\n\n16XX socks Precursor of the 18XX plug-in range, allowing the operators to connect to a victim directly,\n\nthis connection is typically set-up to a specific port opened in the Windows firewall.\n\n18XX socks 2 Precursor of the 25XX plug-in range, allowing the operators to connect to a victim directly,\n\nthis connection is typically set-up to a specific port opened in the Windows firewall.\n\n\nproxy\n\n\nUsed to directly connect to infected machines. To make sure machines behind a device\n\nproviding network address translation (NAT) can still be reached individually, UPnP\n\nis used, and ports 1900 (UDP) and 2869 (TCP) are opened in the Windows firewall.\n\n\n2550 proxy 2 Similar to the other plug-ins in the 2500 range, this plug-in can be used to directly\n\n|Col1|Col2|Col3|Col4|Col5|\n|---|---|---|---|---|\n||14|02|||\n||14|03|||\n||150|7|||\n|1|511||||\n|1|512||||\n|1|6X|X|||\n|1|8X|X|||\n|2|50|0|||\n|2|55|0|||\n\n|Col1|Col2|Col3|Col4|Col5|\n|---|---|---|---|---|\n|de vk|cid usn|e_ ot|a6||\n|de|cid|e|||\n|pp|c 7||||\n|pp|c||||\n|pp|c||||\n|so|cks||||\n|so|cks|2|||\n|pr|oxy||||\n|pr|oxy|2|||\n\n|•|\u0007|Au Kin|str gd|ali om|a, B ,|el Me|giu xic|m, o,|Col10|Col11|Col12|Col13|\n|---|---|---|---|---|---|---|---|---|---|---|---|---|\n|R th ca Th •|etr e o se is|iev pe th pl Au|es ra es ug- str|br tor e U in ali|ow s RL is o a,|se we s a nl Ca|r h re re y r nad|ist visi ex etr a,|||||\n|R th ca Th •|etr e o se is|iev pe th pl Un|es ra es ug- ite|br tor e U in d S|ow s RL is o ta|se we s a nl tes|r h re re y r , U|ist visi ex etr ni|||||\n|A Fi re Th|dv ref dir is|ert ox ec pl|ise an te ug-|m d I d t in|ent nt o a is s|fr ern n a pe|au et lte ci|d p Ex rn fica|||||\n|A Fi re Th|dv ref dir is|ert ox ec pl|ise an te ug-|m d I d t in|ent nt o a is s|fr ern n a pe|au et lte ci|d p Ex rn fica|||||\n|A Fi re Th|dv ref dir is|ert ox ec pl|ise an te ug-|m d I d t in|ent nt o a is s|fr ern n a pe|au et lte ci|d p Ex rn fica|||||\n|Pr th|ec is|ur co|sor nn|of ect|th io|e 1 n is|8X ty|X p pic|lu all||||\n|Pr th|ec is|ur co|sor nn|of ect|th io|e 2 n is|5X ty|X p pic|lu all|g-i y s|||\n|U pr is|se ov us|d t idi ed|o d ng , a|ire ne nd|ctl tw po|y c or rts|on k a 19|ne dd 00|ct re (U|to ss t DP|inf ra ) a||\n|Si co|mi nn|lar ec|to t t|th o in|e o fe|the cte|r p d|lu ma|g-i chi|ns i ne|n t s.|he|\n\n\n-----\n\n**Identifier** **Name** **Purpose** **Versions**\n\n\n2600 SIP scanner Scans devices on the local subnet of the target for SIP (Sessions Initiation Protocol) agents\n\nand, if a SIP agent is present, exfiltrates information returned by the agent.\n\n\n2610 router\n\nscanner\n\n\n7\n\n3\n\n3\n\n\n2700\n\n2701\n\n2750\n\n\nFTPg\n\nFTPg_spec\n\nfbcookie\n\n\nScans gateway IP address of the target for common ports used by routers, and exfiltrates\n\nbasic information returned by the services running on these ports.\n\n1 \u0007Grabs and exfiltrates FTP and Bitcoin credentials and attempts to do so for every local\n\nuser on the infected machine by bruteforcing the passwords of these accounts (using\n\na list of commonly used passwords).\n\n2 \u0007The specifically targeted FTP clients and Bitcoin wallets are similar to the list used by\n\nthe infamous Pony Loader (2.0) Trojan [9].\n\n3 \u0007Stolen FTP credentials are mainly used to spread Ponmocup, with the delivery method\n\ndescribed in chapter 4.\n\n1 \u0007Grabs and exfiltrates FTP and Bitcoin credentials and attempts to do so for every\n\nlocal user on the infected machine by bruteforcing the passwords of these accounts\n\n(using a list of commonly used passwords).\n\n2 \u0007The specifically targeted FTP clients and Bitcoin wallets are similar to the list used by\n\nthe infamous Pony Loader (2.0) Trojan.\n\n3 \u0007Stolen FTP credentials are primarily used to further spread Ponmocup, using the\n\ndelivery method discussed in chapter\n\n4 \u0007The functionalities of this plug-in appear to be similar to plug-in #2700, but the\n\noperators are likely using this plug-in for special (spec) occasions.\n\nGrabs and exfiltrates stored Facebook credentials and cookies and attempts to do so for\n\nevery local user on the infected machine by attempting to bruteforce these accounts\n\nusing a list of commonly used passwords. Fox-IT has not yet observed abuse of these\n\ncredentials on a large scale. It is therefore suspected that they may be used in the event\n\nof a significant loss in the number of victims, necessitating the introduction of a new\n\nspreading mechanism by the Ponmocup operators.\n\n\n2760 sysinfo Gathers extensive information about an infected machine, also scans for a long and\n\ndiverse list of analysis and monitoring software.\n\n\n2810\n\n\nbtcg\n\n\nGrabs and exfiltrates generic and specific Bitcoin wallet data. Specifically targeted\n\nBitcoin wallets:\n\n- Multibit\n\n- Electrum\n\n\n_6_ _\u0007vkusnota is a Russian term_\n\n_to describe something tasty_\n\n_(though typically associated_\n\n_with food)_\n\n_7_ _ppc is short for pay-per-click_\n\n_8_ _\u0007For a description of the_\n\n_concept of PINs,_\n\n_see paragraph 5.2._\n\n_9_ _[https://www.damballa.\u0007](https://www.damballa.com/pony-loader-2-0-steals-credentials-bitcoin-wallets-source-code-sale/ )_\n\n_[com/pony-loader-2-0-steals-](https://www.damballa.com/pony-loader-2-0-steals-credentials-bitcoin-wallets-source-code-sale/ )_\n\n_[credentials-bitcoin-wallets-](https://www.damballa.com/pony-loader-2-0-steals-credentials-bitcoin-wallets-source-code-sale/ )_\n\n_[source-code-sale/](https://www.damballa.com/pony-loader-2-0-steals-credentials-bitcoin-wallets-source-code-sale/ )_\n\n\n3101 ppc Most recently developed advertisement fraud plug-in, generates ad-fraud traffic to\n\nwebsites stored in a separate configs file in registry.\n\n_Table 3: Overview of Ponmocup’s most important plug-ins_\n\n|Col1|an ng wa er mi (sp|d th llet sp lar ec|att e p s a rea to ) o|em as re d pl cc|pt sw si Po ug- asi|s t or mil nm in on|o d ds ar oc #2 s.|o s of to up 70|o f the the , u 0,|or se li sin bu|ev ac st g t t t|er co use he he|y un d|ts by|\n|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|\n||d c ng no th tat|oo to t y at in|ki br et th g t|es ut ob ey he|an efo ser ma int|d a rc ve y b ro|tte e t d a e du|m he bu use cti|pts se se d i on|to acc of n t of|d ou th he a n|o s nt es ev ew|o f s e en|or t|\n||ch|ine|, a|lso|sc|an|s f|or|a l|on|g a|nd|||\n||lle|t d|ata|. S|pe|cif|ica|lly|ta|rge|te|d|||\n|g-i y.|n,|ge|ner|at|es|ad|-fr|aud|tr|af|fic|to|||\n\n|Col1|Col2|Col3|Col4|Col5|\n|---|---|---|---|---|\n||||1||\n|||1|6||\n||||5||\n||||2||\n|||3|4||\n\n\n-----\n\n###### To efficiently distribute certain functionalities to a victim, plug-ins can be grouped into a so called ‘PIN’ as earlier mentioned. For example, the PIN that has been most actively used since June 2012 is identified\n\nas PIN 19001 and contains 10 unique plug-ins. The table\n###### below contains an overview of the most frequently used PINs and what plug-ins they are comprised of: \n\n**PIN** **Plug-ins**\n\n\n###### Identifying plug-ins is possible  by analyzing their  PE headers.\n\n\n15001 1511, 1600, 2500, 2700, 2810\n\n\ninvestment websites, accounting websites and websites\n\n###### used to store personal information, which are used for intelligence purposes (for example law enforcement software or online insurance websites). An example  of such keywords recovered by Fox-IT, is shown in the\n\nsnippet below.\n\n###### In total Fox-IT has identified 214 unique keywords,\n\nAPPENDIX I contains the full list of recovered keywords.\n###### The goal of this plug-in is clear: identifying targets of\n\ninterest based on their browsing behavior.\n\nThrough analysis of three specific versions of the decide\n###### plug-in, Fox-IT has identified what countries were  targeted by this plug-in at certain moments in time,\n\nshown in Figure 9:\n\n- 2009–2010: Australia, Belgium, Canada, Switzerland,\n\nGermany, Denmark, Estonia, France, United Kingdom,\n###### Mexico, Netherlands, Norway, New Zealand,\n\nPortugal, Sweden, United States\n\n- 2010–2011: Australia, Canada, New Zealand, United\n\n|1|160|002|2|1|150|07, 1|160|00,|, 25|500|0, 2|270|00,|281|10|Col17|Col18|Col19|Col20|Col21|Col22|Col23|Col24|Col25|\n|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|\n|T 5 T b a d h T i P o o k|160|02|: O lu ar gh er -i as am ro nt o to h rd|ve g- ge t hi n p e e w en cu rs ec s|150|7,|160|0,|25|00|, 2|70|0,|28|10||||||||||\n||170|01|||150|7,|160|0,|25|00|, 2|70|0,|28|10||||||||||\n||170|02|||150|7,|160|0,|25|00|, 2|70|0,|28|10||||||||||\n||19|001|||135 275|0, 0,|14 28|03, 10|15|12,|25|00|, 2|60|0,|26|10,|27|00|, 2|70|1,|||\n||190|02|||135|0,|14|03,|15|12,|25|50,|26|10|, 2|70|0,|27|60,|28|10||||\n||19|010|||135|0,|14|03,|15|12,|25|00|, 2|610|, 2|70|0,|28|10||||||\n||abl .3. hr ro pl at os hi ts o p nl ey|e 4 1 \u0007P t ou ws ug ab tn s b co nm era y c wo|||rvi ins ts his st ar of s o ser t a p o fr ke can|ew # ty ory se Go f t hi ga p om d i b|of 14 p fo th og he st in er b n e d|Po xx e o r e h le co or st ato ec th ivi|nm ra f p all is C ok y is sp rs o e f de|oc ng lu m to hr ie c ec . T mi or d i|up e g-i ajo ry om s s oll ifi o ng m nt|’s – d n, r b fro e, tor ec c k pr k of o 4|mo ec op ro m bu ed te ey ev no C ca|st c id er ws , f t i o d f w en wn RC te|om e: at er or t n t or or t t , t 32 go|m fin or s. ex wil he th ds he he ch rie|onl di s c No am l al ta e p of i se e s:|y u ng an t pl so rg lu in nte k ck on|se in re onl e, re et’ g-i ter re ey su lin|d P te tr y th tr s m n t es st w ms e b|INs re iev wil e S iev a o t t s o ord . T a|sting e the l such QLite e the chine check o the f the s are hese nking|||\n|||<c <c <c <c <c <c <c|r r r r r r r|c_ c_ c_ c_ c_ c_ c_|in in in in in in in|de de de de de de de|x x x x x x x|=0 =0 =1 =0 =0 =3 =0|0 1 9 2 8 8 1|po po po po po po po|s s s= s s s s|=0 =0 1 =0 =1 =2 =0|0 6 6 7 1 9 6|le le le le le le le|n n ng n ng ng n|gt gt t gt t t gt|h= h= h= h= h= h= h=|13 01 02 02 01 01 01|c c c|ch ch he ch h h ch|ec ec c ec ec ec ec|ks ks ks ks ks ks ks|um um um um um um um|=0x03098019 keyword=us.etrade.com> =0x01d405fc keyword=dmv.org> =0x0167da70 keyword=drivingrecords.com> =0x023605bb keyword=geico.com> =0x00fe800a keyword=lppolice.com> =0x058533bc keyword=businessonline.huntington.com/> =0x02247d64 keyword=bbva.es>|\n\n\n-----\n\n5.3.2 \u0007Plug-in #2600 – SIP scanner: collecting\n\ninformation on SIP gateways\n\nThis plug-in attempts to identify SIP gateways on the local\n\n###### subnet of a victim. SIP, the Sessions Initiation Protocol, \n\nis a communications protocol used to setup and connect\n\ncommunications sessions, typically for voice and video\n\n\n###### calls. In the example below the plug-in identifies that the gateway IP 10.0.0.1 is running an Asterisk server; a software implementation of a telephone private\n\nbranch exchange (PBX) which can be used to set-up VoIP\n\nconnections.\n\n\n00:00:00.000 ---if---flags=[UP,BROADCAST,,,MULTICAST]---addr=[10.0.0.13]---mask=[255.255.255.0]-\n-bcast=[255.255.255.255]--\n00:00:05.000 ---range---start=[10.0.0.0]---end=[10.0.0.254]---self=[0]--\n00:00:05.000 ---ip_count=[254]---d_avr_ms=[78]---d_min_ms=[3]---d_max_ms=[153]--\nt_est_sec=[178]--\n00:02:11.562 ---send_error---code=[10049]---to=[10.0.0.0:5060]--\n00:02:17.281 ---known---src=[10.0.0.13]---dst=[10.0.0.1:5060]--\n00:02:17.281 ---pre---begin---from=[10.0.0.1:5060]---len=[502]---crc=[4d2d01bc]--\nSIP/2.0 404 Not Found\n\nVia: SIP/2.0/UDP 10.0.0.13:5060;branch=z9hG4bK4eb9c9fb;received=10.0.0.13;rport=5060\n```\nFrom: \"Unknown\" <SIP:100@10.0.0.13>;tag=e6eaecf352f8f49ab25dcec3eba0461664bc3d70f6\nTo: \"Unknown\" <SIP:100@10.0.0.1>;tag=as7afdf3b5\n\n```\nCall-ID: df356de4463be948e998593728fd0d69@10.0.0.13\n\nCSeq: 102 OPTIONS\n\nServer: Asterisk PBX\n\nAllow: INVITE, ACK, CANCEL, OPTIONS, BYE, REFER, SUBSCRIBE, NOTIFY, INFO, PUBLISH, MESSAGE\n\nSupported: replaces, timer\n\nAccept: application/sdp\n\nContent-Length: 0\n\n00:02:17.281 ---pre---end--\n\n###### This browser history is collected for the  plug-into check its content against specific keywords of interest to the Ponmocup operators.\n\n\n-----\n\n###### The plug-in then attempts to retrieve more information on the type of SIP gateway running on this IP address, by sending \n\nan OPTIONS and REGISTER, an example of an OPTIONS request:\n\n00:03:15.750 ---SIP_scan_id---idx=[0]---scan_idx=[0]---pkt_type=[0]---sock_type=[0]--\nsrc=[10.0.0.13]--dst=[10.0.0.1:5060]--\n00:03:15.750 ---send-begin---len=[556]--\nOPTIONS SIP:109@10.0.0.1:5060 SIP/2.0\n\nVia: SIP/2.0/UDP 10.0.0.13:5060;branch=z9hG4bKcac70ed4\n\nMax-Forwards: 70\n```\n  From: “Unknown” <SIP:Unknown@10.0.0.13>;tag=b899892894cb3bdc261a57219952fb0a26dea3e1cc\n  To: <SIP:109@10.0.0.1:5060>\n  Contact: <SIP:Unknown@10.0.0.13:5060>\n\n```\nCall-ID: 6d070c9e641bff4fb90c47f66806d6d6@10.0.0.13:5060\n\nCSeq: 102 OPTIONS\n\nUser-Agent: Zoiper for Windows rev.1812\n\nDate: Sat, 06 Jun 2015 12:13:12 GMT\n\nAllow: INVITE, ACK, CANCEL, OPTIONS, BYE, REFER, SUBSCRIBE, NOTIFY, INFO, PUBLISH\n\nSupported: replaces, timer\n\nContent-Length: 0\n\n00:03:15.750 ---send-end---\nThe responses are summarized at the end of the log file and a CRC32 checksum is calculated over the content. In the example\n\nbelow the summary indicates that the response to request ID 3021 returned a 401 response:\n\n|00:03:15.750 ---SIP_scan_id---idx=[0]---scan_idx=[0]---pkt_type=[0]---sock_type=[0]--- src=[10.0.0.13]--dst=[10.0.0.1:5060]--- 00:03:15.750 ---send-begin---len=[556]--- OPTIONS SIP:109@10.0.0.1:5060 SIP/2.0 Via: SIP/2.0/UDP 10.0.0.13:5060;branch=z9hG4bKcac70ed4 Max-Forwards: 70 From: “Unknown” <SIP:Unknown@10.0.0.13>;tag=b899892894cb3bdc261a57219952fb0a26dea3e1cc To: <SIP:109@10.0.0.1:5060> Contact: <SIP:Unknown@10.0.0.13:5060> Call-ID: 6d070c9e641bff4fb90c47f66806d6d6@10.0.0.13:5060 CSeq: 102 OPTIONS User-Agent: Zoiper for Windows rev.1812 Date: Sat, 06 Jun 2015 12:13:12 GMT Allow: INVITE, ACK, CANCEL, OPTIONS, BYE, REFER, SUBSCRIBE, NOTIFY, INFO, PUBLISH Supported: replaces, timer Content-Length: 0 00:03:15.750 ---send-end----|Col2|Col3|Col4|Col5|Col6|Col7|Col8|Col9|Col10|Col11|Col12|Col13|Col14|Col15|Col16|Col17|Col18|Col19|Col20|Col21|Col22|Col23|\n|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|\n|T b|he el|r ow|esp t|o he|ns su|es m|ar m|e s ary|um in|m di|ar ca|iz te|ed s t|at ha|th t t|e he|en re|d o sp|f t on|he se|lo t||\n|||0 -i 0 0 1 2 , , 3 0|0: d 21 00 ,3 04 20 40 02 0:|07 =[ ,4 ,3 02 ,4 26 24 2, 07|:2 30 03 01 8, 02 ,4 ,2 10 :2|7. 21 0, 0, 40 3, 00 00 20 7.|85 ,3 10 30 29 10 6, 0, ,2 85|9 00 4, 12 ,1 2, 20 20 02 9|-- 2, 20 ,4 00 10 0 1 4, --|-- 3 2 0 2, 0 3, 2, 30 -c|-- 00 7,4 08 21 1, 10 20 2 rc|ty ,4 0 ,4 0 30 08 0, 3, =[|p 01 11 02 ,2 19 ,1 20 20 42|e= 7, ,3 7, 00 ,4 01 6, 17 4|[1 40 03 40 2, 00 5, 10 ,2 76|]- 26 0, 03 30 1, 40 29 02 1f|-- ,4 30 ,2 24 10 0 ,3 0, c]|co 00 27 0 ,4 22 0, 01 30 --|de 4 ,1 25 01 ,2 20 7, 09 -|=[ ,3 00 ,3 4 0 15 30 ,2|4 03 9, 02 ,4 23 ,3 6 0|01]---stamp=[fbd1e9ad]---count=[155]- ,3001,2021,1019,103,3004,2019,3015,3014,2007,107,2010,106,4 4019,3006,205,2001,1007,2022,301,3005,4020,1025,309,3003,1 9,1014,1030,2016,4022,2030,2028,207,1006,2018,4010,1011,102 025,2006,108,4005,307,3026,304,3025,105,1004,2013,3018,109, ,4012,310,4007,3011,1027,4028,1012,1010,1028,4009,1018,4015 08,3013,1017,202,2029,209,110,1005,1024,4002,1003,2009,1016 ,2011,1026,3016,2008,4016,201,302,4013,2005,3008,4018,2004, 14,1023,1013,208,3000,3007,3020,305,203]---|\n\n\n-----\n\n2009 – 2010\n\n2010 – 2011\n\n2012 – 2015\n\n\n_Figure 9: Overview of countries targeted by Ponmocup’s decide plug-in_\n\n###### All the discovered information is then encrypted and exfiltrated to a dedicated plug-in proxy, and stored in the back-end,\n\nwhere the operators can query the data for information of interest.\n\nBecause the processing of this data happens on back-end servers, Fox-IT does not know the exact purpose of harvesting this\n\ntype of information. Having access to SIP gateways could be useful for VoIP fraud, but would also allow for the interception\n\nof voice/video communication.\n\n\n###### In total Fox-IT has identified 25 plug-ins with unique identifiers, among them they share more than 4000 different versions, indicating this framework is under continuous development. \n\n\n-----\n\n5.3.3 \u0007Plug-in #2610 – router scan: collecting router\n\ninformation\n###### This plug-in identifies what gateway IP the victim’s\n\nmachine uses (for example 10.0.0.1) and then attempts\n\nto identify if, on that gateway, any services respond on\n\nthe following ports:\n\n- 22 (SSH)\n\n- 23 (Telnet)\n\n- 80 (HTTP)\n\n- 443 (HTTPS)\n\n- 8080 (Alternative HTTP port, often used by proxies)\n###### Using an example of a typical router with an example\n\n|• U p f|si ag oll|8 ng e ow|08 a on in|0 ( n e th g i|Al x e nf|te am ga or|rn pl te m|ati e wa ati|ve of y I on|H a t P, :|TTP yp thi|p ic s p|or al lu|t, ro g-i|oft ut n|en er wo|u wi ul|se th d e|d b a x|y n e filt|pr xa ra|Col23|\n|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|\n|||0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 <! < < </ 0|0: 0: 0: 0: 0: 0: 0: 0: 0: 0: 0: 0: 0: 0: 0: 0: 0: 0: 0: 0: 0: 0: 0: D ht ti h 0:|00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 OC ml tl tm 00|:2 :2 :2 :2 :2 :2 :2 :2 :2 :2 :2 :2 :2 :2 :2 :2 :2 :2 :4 :4 :4 :4 :4 TY > e> l> :4|6. 6. 6. 6. 6. 6. 6. 6. 6. 6. 6. 6. 6. 6. 6. 6. 6. 6. 1. 1. 1. 3. 3. PE Ex 3.|48 48 48 48 48 48 48 48 48 48 48 48 48 48 48 48 48 48 64 64 64 06 06 a 06|5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 1 1 1 3 3 HT mp 3|-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- ML le --|-s -a -n -d -a -i -t -d -h -l -l -I -G -D -P -S -a -m -c -m -h -r -r P R -h|c d a e d n y h a ea ea pA a h r e d y o y t e e UB o t|an ap me sc dr de pe cp ve s s d te cp im co ap ht nn ht tp pl pl L ut tp|_s te =[ r= =[ x= =[ en wi eo ee dr wa Se ar nd te tp ec tp _s y= y_ IC er _e|ta r_ {4 [A 0a [2 6] ab ns bt xp es yL rv yW ar r_ _ t_ _ t [1 da “ P n|r s AE MD 00 ]- -- l = =[ =[ sL i e i y e st e en ar ]- t -/ ag d-|t- ta E8 0 -- - ed [0] 14 1 i st r( ns Wi nd ar rr d- t- -- a_ /W e --|-- rt 0 PC 00 =[ -- 4 44 st (1 1) Se ns -- t- or -- -- re st 3C </|-- EB NE d] 1] - 54 54 (1 )- -- rv Se - -- =[ se pl ar // ti|- -8 T -- -- 66 69 )- -- -i e r se 1 rv y t DT tl|42 Fa - - 12 72 -- ip pa r( ve r 4]- e _c -- D e>|0- m 7] 7 ip ad dd 1) r( ve - r= od -l H|4950-ACDF-9C04A9D530D1}]--- ily PCI Ethernet-adapter]--- --- ]--- addr=[10.0.0.13]---ipmask=[255.255.255.0]---ctx=[2]--- dr=[10.0.0.1]---ipmask=[0.0.0.0]---ctx=[0]--- r=[10.0.0.1]---ipmask=[]---ctx=[0]--- ---ipaddr=[0.0.0.0]---ipmask=[0.0.0.0]---ctx=[0]--- 1)---ipaddr=[0.0.0.0]---ipmask=[0.0.0.0]---ctx=[0]--- r=[10.0.0.1]---url=[/]--- - [10.0.0.1]---url=[/]--- e=[200]---reply_len=[113]--- en=[113]--- TML 4.01 Transitional//EN”>|\n\n\n-----\n\nAdditionally the plug-in will attempt to access the web###### server on port 80 via the /admin URL, and exfiltrates\n\nthe server’s response. In the example below the /admin\n\ndoes not exist:\n\n\n###### A plug-in containing  an exploit for the vulnerability in the Microsoft print spooler service, first used as  a zero-day by Stuxnet  two years earlier.\n\n\n00:00:43.063 ---myhttp_start--\nserver=[10.0.0.1]---url=[/admin]--\n00:00:58.063 ---connect_error=[14]--\n00:00:58.063 ---myhttp_end--\n00:00:58.063 ---telnet_start--\naddr=[10.0.0.1:23]--\n00:01:13.063 ---connect_error=[14]--\n00:01:13.063 ---telnet_end--\n00:01:19.172 ---discover_ok--\n00:01:19.172 ---devcount=[1]--\n00:01:19.188 ---valid_igd=\n\n[http://10.0.0.1:80/\n\nWANIPConnection]--\n00:01:19.188 ---addr=[10.0.0.19]--\n00:01:19.188 ---ext_ip=[0.0.0.0]--\n00:01:19.188 ---time1=[1445467515]--\n00:01:19.188 ---gtc1=[1573203]--\n00:01:19.188 ---scan_end--\n00:01:53.000 ---crc=[3aea52f2]--\n\nexecute it with system privileges on unpatched Windows\n\nmachines. This effectively made Ponmocup a worm and\n\nthe amount of infected machines increased significantly.\n\nHowever when a Windows system was patched for the\n###### vulnerability, the payload would not be written to the\n\nsystem directory, but instead, to the default print spooler\n\nfolder; the directory used by Windows to queue printer\n\njobs. The print spooler service then saw the Ponmocup\n###### binary as a print job, and continued to send it to the\n\nprinter, which then carried on to print the binary. Because\n###### the exploit is attempted multiple times, the printers\n\nusually just kept on printing, until they ran out of either\n\npaper or ink.\n\nOnce companies all over the world started complaining\n###### about their printers printing, what was presumably, \n\n‘garbage data’, the story was soon picked up by the media,\n\nsomething the Ponmocup operators picked up on as well,\n\nas the plug-in was removed the very next day. To avoid\n\neven more attention the plug-in was removed from the\n\ndefault plug-in list and was never re-used as a separate\n\nplug-in again.\n\n\n_10_ _\u0007https://support.microsoft._\n\n_com/en-us/kb/2347290_\n\n_11_ _\u0007http://www.symantec.com/_\n\n_connect/blogs/printer-_\n\n_madness-w32printlove-video_\n\n\n###### Because the processing of this data happens on \n\nback-end servers, Fox-IT does not know the exact purpose\n\nof harvesting this type of information. Storing informa\ntion on router devices could help in further propagating\n\nPonmocup through the local network, but could also aid\n\nin identifying interesting targets.\n\n5.3.4 \u0007Plug-in for MS10-061 vulnerability: lateral\n\nmovement\n\n12 June 2012, the day of the renewed Ponmocup release:\n\na plug-in containing an exploit for the vulnerability in the\n\nMicrosoft print spooler service [10], first used as a zero-day\n###### by Stuxnet two years earlier, is added to the group of \n\nplug-ins that are pushed to every newly infected machine,\n\na move the operators would soon come to regret.\n\n###### By impersonating the print spooler service Ponmocup could move its payload into the system directory and\n\n\n-----\n\n## 6 Command and control traffic\n\n###### All Ponmocup components that can communicate with command and\n\n control servers contain hardcoded domains. These domains are not\n\n command and control servers and are not used to send data to, but are\n\n merely used to calculate the IP addresses of the actual command and\n\n control servers.\n\n\n###### To achieve this, Ponmocup resolves the hardcoded\n\ndomain and converts the returned IP into a hex value. It\n\nthen takes the CRC32 checksum of the domain and XORs\n###### these two values with each other, recovering the real\n\ncommand and control IP address.\n###### This is visualized in Figure 11. In the example above the main module contains the hardcoded domain ‘claims­\n\nreference.net’. As this domain has no direct relation to any\n\nactual Ponmocup infrastructure, this is a clever method\n###### of hiding the real command and control servers from\n\nany prying eyes.\n\nAdditionally, to avoid detection by intrusion detection and\n\nprevention systems, the operators behind Ponmocup have\n\nput in a lot of effort to hide its command and control traffic:\n\n###### • Command and control traffic only occurs once to\n\ntwice every two days and occurs at random times.\n\n- URLs are randomly structured from a combination of\n\ntwo lists, both containing 50+ unique paths which are\n\n\ncommonly used by legitimate websites.\n\n###### • A command and control server typically returns a \n\n“404 Not Found” HTTP response to make it seem as if\n\nthe page does not exist and isn’t accepting any data.\n\n###### • Data is RC4 encrypted but the key is generated \n\ndifferently per component.\n\n- The encrypted data is stored in the ‘Cookie’ header.\n\n   - Data is serialized into multiple fields, each Cookie\n\nname is randomly chosen out of a list of 177 key###### words which are commonly used by legitimate\n\nwebsites.\n\n   - Storing data in the Cookie header using popular\n###### cookie keywords is a technique that Fox-IT also observed in the highly sophisticated Regin\n\nframework.\n\n- Domains used to calculate command and control IP\n\nonly use common TLD’s (.net, .com, .org).\n\n- Plug-ins use separate proxies and back-ends to which\n\nthey log exfiltrated data.\n\n\n-----\n\n6.1 **Installer communication**\n\nThe installer makes use of one hardcoded domain which is\n\nonly used during installation. By using a domain for installation\n\n###### purposes only, the other domains used for command and \n\ncontrol traffic won’t be discovered as easily. This also means\n\nthat taking down this domain would not impact the current\n\nbotnet size, but only cause a minor hiccup in new infected\n\nmachines being able to talk back to the Ponmocup backend.\n\nThis one time has only been changed a couple of times; ‘faster\nnation.net’ has been the static installation domain since 2012.\n\n\nData is RC4 encrypted using a random 16 bytes key and\n\nencoded with a custom base64 table.\n\nBefore base64 encoding, Ponmocup first places the RC4\n\nkey on top of the data, calculates the CRC32 of the data\n\nand places this value at the end of data. After decryption,\n\nevery block of data has the CRC32 value of that block at\n\nthe end (last 4 bytes)[15].\n\n###### A typical Ponmocup check-in would look something \n\nlike this:\n\n|Cookie: uid=referringpath=0tMNPEubad4AlBaw4aZNqYj-PphJ-N mKteiILceVXJAwJ88VdDXdzjTq2zhM2HZ5kR_c_3i111MXafapXw-DLKk SER58Th1CP; ARSiteUser=server=UiZgtrfSoQ5zfIjHnd88G_iU4Nw thepoint=czAc0MvfrFF3sVd2vehRHAo1ZASIGD3a1PCoidT0IKjiPkjN IiZ6XAkSGH0O4oXStZfojpjcSR-46IJja-cK7N9meCk1im6xTB1ocayDm oTv8KAVlOQ0o7IWRx2ffWe6shtDPjYhYUwgTRHtFTN5_yF0T72wfLj7df D3n1mOOCD6u-VZbjxr0USzySQjVPEIj6CxfGcvD1nzwvX2I8r6id5EAnu Vmw9wrRGPrsYgkvvrn-PW_7JyEqfp7h7WjlgSuYmciCO43vKuL9VR84BS|Col2|Col3|Col4|Col5|CN Nv OF YP ZQ Sl D k 19|5P xe t B_ _ LU W3 KR|Rz O RM b2 yV B ck 5|4F qH T- l 3L uS Sm hL|_z mj y0 r1 Kg Kg o Gn|JT fh m; nt j AB jF tv|x d _ ED xK W CY sd|wo z4 Yk 54 qV gx 5|qh op 8 s8 uu dm dI|GO TI 8N EB 0l W ZQ|h oV S1 38 uX e_ sD|K; T4 Cp A D Ii|c 10 c4 Qd wJ j7|lo x ff dd II Kh|gi AN D E6 50 gh|d= f- ck Rs zx q|KG Lx K Iz|ts -5 xb Zm|A- _ WY Mf|J Z|Col26|\n|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|\n||||||he d o|fo n|llo the|w m|ing ac|f hin|iel e.|ds: At|le|ast|o|ne|PIN|is|pu|sh|ed|to||||\n||||||m|||||||||||||||||||||\n|||||||||||||||||||||||||||\n||||||vi|cti|m|ma|ch|ine|th|us|fa|r||||||||||||\n||||||p o|f t|he|de|fa|ult|PI|N||||||||||||||\n|||||||||||||||||||||||||||\n|||||||||||||||||||||||||||\n|||||ni|str|ati|ve|pri|vil|eg|es?|||||||||||||||\n||||rvi|ce|?|||||||||||||||||||||\n||||t o|f t|he|an|ti-|vir|tu|aliz|at|ion|ch|ec|ks|||||||||||\n||||nf|or|ma|tio|n s|uc|h a|s t|he|us|ag|e o|f a|pr|ox|y||||||||\n|||en|abl|ed|?|||||||||||||||||||||\n|||ati|on|d|ate|of|th|e s|ys|te|m d|ire|ct|ory||||||||||||\n|||ati|on|d|ate|of|th|e S|ys|te|m V|ol|um|e I|nf|or|ma|tio|n d|ire|ct|or|y|||\n||Sys|te|m|Vo|lu|me|N|um|be|r||||||||||||||||\n||s u|se|d t|o c|alc|ula|te|a|pro|xy|IP,|in|clu|di|ng|th|eir|CR|C3|2 c|he|cks|u|ms||\n\n\n_Table 5: Common fields stored in the Cookie header during command and control traffic_\n\n\n-----\n\n6.2 Main module communication\n\nFor continuous communication four hardcoded domains\n\nare, again, used to calculate the IP of the command and\n\ncontrol server. Ponmocup resolves two domains at a time,\n\nthe first calculated IP is used to send data to, the second\n###### is resolved as a back-up in case the first IP cannot be\n\nreached. To prevent the botnet from being taken down,\n###### two of the four hardcoded domains are changed every\n\nperiodically[12] by updating the main module, as shown in\n\nFigure 12. By regularly rotating these domains for the past\n###### 4 years, all the Ponmocup bots are now load balanced\n\nbetween more than 10 domains.\n\nTo take down the botnet, one would had to have analyzed\n###### every Ponmocup payload, in intervals of 2–6 months, for 4 years straight; a time consuming task given the\n\ncomplexity of the malware.\n\n###### The encryption routine used by the main module for\n\ncommand and control traffic is identical to the installer.\n\n###### Payload B\n\n branean.com claimsreference.net\n citiesorders.com directlyvast.com\n directiculture.com directiculture.com\n enckfeld.net enckfeld.net\n\n Payload A\n\n_Figure 12: Separation of domains per payload_\n\n\n6.3 Plug-in communication\n\nPlug-ins capable of communicating with command and\n###### control servers use dedicated domains which calculate IP addresses for proxies that log to separate back-end\n\nservers.\n\n###### Although all plug-ins RC4 encrypt (exfiltrated) data,\n\nthe RC4 key can differ. The cookie header is still used by\n\nplug-ins to exfiltrate basic information such as counters\n\nor checksums, but the exfiltration of larger data is done\n\nvia (encrypted) POST requests.\n\n\n-----\n\n_12_ _\u0007In most cases we’ve observed_\n\n_domains rotating in inter-_\n\n_vals of 3–6 months_\n\n\n-----\n\n## 7 Anti-analysis techniques\n\n###### One of the reasons Ponmocup has been able to stay under the radar,\n\n for as long as it has, is related to the different methods the malware\n\n uses to thwart analysis attempts.\n\n\n###### By specifically and heuristically checking for network\n and host based analysis tools, debuggers and virtualized environments, and then delivering a fake payload, the  operators aim to prevent their malware from being\n\ndetected by the security industry.\n\n7.1 **Checks for signs of analysis**\n\nPonmocup’s anti-analysis checks are performed during\n\ninstallation, but most Ponmocup components perform\n###### anti-analysis checks separately. The main module, for example, performs anti-analysis checks every time a\n\nvictim’s machine is rebooted, and plug-ins perform similar\n###### checks individually when they are executed. The table below lists a number of anti-analysis checks, some of\n\nwhich are less common:\n\n_Figure 13: How the analysis flag decides between_\n\n_the installation of the real or fake malware_\n\n\n7.2 **Delivery of fake payload**\n###### If one of the anti-analysis checks triggers, implying an attempt to analyze the malware, a flag is set and\n\nPonmocup goes on to use one of its most clever tricks;\n\ndelivery of a fake payload, as explained in Figure 13.\n\n###### Where typical malware employing anti-analysis imme- diately exits if being analyzed, Ponmocup installs SanctionedMedia; a pay per install software bundle, which merely injects advertisements into webpages, commonly classified as adware. Because an analyst \n\nstill observes an actual payload being dropped, the fake\n###### malware sample will often be analyzed. As this fake \n\npayload does nothing more than inject advertisements\n\nand is relatively easy to remove, it will generally not be\n###### of much interest to analysts or anti-virus companies. \n\nThis fake payload is a simple, yet highly effective, disguise\n\nfor a payload that poses a far more serious threat.\n\nThe fake payload is also installed onto a system in a far\n\nmore obvious manner than the real payload, appearing in\n\nthe process list as an exe, of which the name is derived\n###### from a random file in the system directory with 2–3 random characters appended, with the file description ‘RecSave’, product name ‘MyPCProtect’ and original file name ‘Smad.exe’. This payload is written in .NET, as opposed to the traditional C++ used in the actual\n\nPonmocup framework.\n\n\n-----\n\n###### This fake payload is a simple, yet highly effective, disguise  for a payload that poses a far more serious threat.\n\n\n_Figure 14: Homepage of SanctionedMedia.com, the fake payload used as a disguise by Ponmocup_\n\n\n**Evasion method** **Applicable to:**\n\n\nBlacklisted usernames Currentuser, Sandbox, Honey, Vmware, Nepenthes, Snort, Andy, roo\n\nBlacklisted computer names (Anubis) TU-4NH09SMCG1HC, InsideTm\n\n\nBlacklisted processes\n\nBlacklisted services\n\n\nvmware, vmount2, vmusrvc, vmsrvc, VBoxService, vboxtray, xenservice,\n\njoeboxserver, joeboxcontrol, wireshark, sniff_hit, sysAnalyzer, filemon,\n\nprocexp, procmon, regmon, autoruns, atcp2log., awpta., EHSniffer., HTTP Sniffer,\n\nEtherD., geturl., HttpAnalyzer, InjectWinSock, HTTPDebugger\n\nvmicheartbeat, vmicvss, vmicshutdown, vmicexchange, vmci, vmdebug, vmmouse,\n\nVMTools, VMMEMCTL, vmware, vmx86, vpcbus, vpc-s3, vpcuhub, msvmmouf,\n\nVBoxMouse, VBoxGuest, VBoxGuest, VBoxSF, xenevtchn,\n\nxennet, xennet6, xensvc, xenvdb\n\n\nBlacklisted drivers hgfs.sys, vmhgfs.sys, prleth.sys, prlfs.sys, prlmouse.sys, prlvideo.sys,\n\nprl_pv32.sys, vpc-s3.sys, vmsrvc.sys, vmx86.sys, vmnet.sys\n\n\nBlacklisted Product ID’s related to sandboxes\n\n\n\n- Anubis (76487-337-8429955-22614)\n\n- Joe Box (55274-640-2673064-23950)\n\n- CWSandbox (76487-644-3177037-23510)\n\n\nInstalled software names in registry Hyper-V, VirtualMachine\n\nHardware description Vbox\n\nVMware guest to host communication channel A check done by executing the “IN” (x86) assembly instruction with the parameter\n\n0x564D5868 (VMXh) to connect to the VMWare I/O port\n\n\nScreen resolution, color depth (amount of colors\n\nin a single pixel), and additional monitor checks\n\n\nVirtual environments often lack an actual monitor/screen or have a default\n\nresolution (e.g. 800x600).\n\n\nNumber of recently opened documents A check in the registry if the machine has had at least opened 10 files.\n\nNumber of URLs in browser history A check in the registry if there are at least 10 URLs in the browser history.\n\nInstalled software A check in the registry if at least one software package has been installed.\n\nMouse movement Consecutive calls to the ‘GetCursorPos’ API to determine if victim is moving\n\nthe mouse.\n\n\nBanned system fingerprint\n\nBanned IP\n\n_Table 6: List of evasion methods_\n\n\nIf Ponmocup catches an analyst, the fingerprint of the system will immediately\n\nbe blacklisted, after which this specific fingerprint and corresponding IP can never\n\nget infected with the malware again.\n\nPonmocup blacklists more than a 1000 IP ranges. Some of these ranges have been\n\nput on this blacklist preemptively and some have been blacklisted because they were\n\nobserved analyzing the malware. The IP ranges on this blacklist belong to anti-virus\n\nand threat intelligence companies as well as large banks in various countries.\n\n|Col1|Col2|Col3|m|Col5|Col6|Col7|Col8|Col9|Col10|Col11|Col12|Col13|Col14|Col15|Col16|Col17|Col18|Col19|Col20|Col21|Col22|Col23|\n|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|\n||||ms ire to In|rvc sh ru jec|, V ar ns, tW|Bo k, s at in|xS ni cp2 So|er f_f lo ck,|vic hit, g., H|e, sy aw TTP|vb sA pt D|oxt na a., eb|ra lyz EH ug|y, x er Sn ger|en , fil iff|se em er.,|rvi on H|ce, , TTP|S|nif|fer,||\n||||hu vm xG db|td x8 ue|ow 6, st,|n, vp V|vm cb Bo|ic us, xSF|exc vp , x|ha c- en|ng s3, ev|e, vp tch|vm cu n,|ci, hu|vm b,|d ms|eb vm|ug, m|vm ou|m f,|ou|se|\n||||s, c.|prl sys|fs. , v|sys mx|, p 86|rlm .sy|o s,|use vm|.s ne|ys, t.s|pr ys|lvi|de|o.s|ys,||||||\n||||55- 64 17|22 -23 70|614 95 37-|) 0) 23|510|)|||||||||||||||\n||||||||||||||||||||||||\n||||||||||||||||||||||||\n||||“I ct|N” to|(x th|86) e V|as M|se Wa|mb re|ly I/|in O p|str or|uc t|tio|n w|it|h t|he|pa|ra|me|ter|\n||||k a|n|act|ua|l m|on|ito|r/|scr|ee|n o|r h|av|e a|de|fa|ult||||\n||||ac|hin|e h|as|ha|d|at l|ea|st|op|en|ed|10|fil|es.||||||\n|||re|ar|e a|t le|as|t 1|0 U|RL|s in|t|he|bro|w|ser|hi|sto|ry|.||||\n|||ea|st|on|e s|oft|wa|re|pa|ck|ag|e h|as|be|en|in|sta|lle|d.||||\n|||tC|urs|or|Po|s’|API|to|de|te|rm|ine|if|vic|ti|m i|s m|ov|in|g|||\n||na h t wa|lys his re|t, sp ag|the ec ain|fi ific .|ng fi|erp ng|rin erp|t o rin|f t t a|he nd|sy co|ste rr|m esp|wi on|ll i di|mm ng|e IP|dia ca|tel n n|y ev|er|\n|ore em m co|th pt alw mp|an ive ar an|a ly e. T ies|10 an he as|00 d s IP we|IP om ra ll|ran e h ng as l|ge av es arg|s. S e b on e|o ee thi ba|me n s b nks|of bla lac in|th ckl kli va|ese ist st rio|ra ed bel us|ng be on co|es ca g t un|ha use o a tri|ve th nti es.|be ey -vi|en w ru|ere s|\n\n\n-----\n\n## Appendix I\n\n###### Targeted keywords\n\nThe following is a list of keywords that the operators of Ponmocup deemed interesting.\n\nThe keywords are used by the 14XX plug-in range (decide), as explained in paragraph 5.3.1.\n\n|achCreate /bb/logon /bbw/ /business/login /business/online/ /BusinessAppsHome.faces /cb/servlet/cb/ /clkccm/ /cmachid.r /cmserver/ /cmwire /Common/Admin /createWire /cs70_banking/ /customerlink/ /direct.bankofamerica.com /ebc_ebc1961/ /fxim /hbcash.exe/ /ibcorporate /IBWS/ /icm1/ /icm2/ /inets/ /onlineserv/cm/ /phcp/servlet/ /RsaGoIdAuthentication.aspx /sbuser/ /wcmfd/wcmpw/ /webcm/ /wire/confri m /wireapproval /wireinitiation /wireManager /wiretransaction /WireTransfer access.jpmorgan.com adminamps.53.com advisorchannel.com ameritrade.com|bancoherrero.com bankatlantic.web-cashplus.com bankbahamasonline.com bankinter.com bankline.natwest.com bankline.rbs.com bankline.ulsterbank.co.uk banklink.com bankofamerica.com/smallbusiness banqueprivee1818.com bbva.es bbvanetoffci e.com bbw/LogonStateMachineServlet.mibs blilk.com boursedirect.fr boursorama.com boursorama.com business.co-operativebank.co.uk business.hsbc.co.uk business.netbankerplus.com business.santander.co.uk businessaccess.citibank.citigroup.com businessbanking. businessclassonline. business-eb.ibanking-services.com businessonline. businessonline.huntington.com/ businessportal.mibank.com bxs.com caixacatalunya.com caixacatalunya.es cajacanarias.es cajamar.es CashMgmt cashmgt cashmgt.fri sttennessee.biz/ Cashplus Cashplus cashproonline.bankofamerica.com cmbnv.com|\n|---|---|\n\n\n-----\n\n|cmol.bbt.com cmserver/login_validate.cfm commercial.hsbc.com.hk commercial.wamu.com Compassconnect.compassbank.com cortalconsors.fr credentialdirect.com deutsche-bank.es direct.53.com/logon53Direct.jsp directnet.com dmv dmv.org drivingrecords.com ebanking-services.com enternetbank.com/exact4web/ eregal.com etrade.com exact4web express.53.com fast-trade.com fortuneo.fr fundsxpress.com fxpayments.americanexpress.com geico.com goldleafach.com gpsmoneymanager hnnconhsvraps01 home1.cybusinessonline.co.uk infoplus. inteligator.com internetbanking.unfcu.org invest.ameritrade.com itreasury.regions.com/phcp/ servlet/CustomerLoginServlet lcl.fr libertymutualbusinessdirect.com linebourse.fr lloydslink.online.lloydsbank.com logincm.aspx lppolice.com|metrobankdirect.com/corporate.asp mfasa.chase.com mybusinessbank.co.uk myvirtualmerchant.com nordnet.lu nordnet.no nordnet.se nwolb.com olb.ent.com online.citibank.com online-business.bankofscotland.co.uk PassmarkSignIn.faces pcsbanking.net pcs-sd.net phxrs-opera quickbooks.com rbcdain.automatedfinancial.com rbsdigital.com risk.nexis.com sabadellatlantico.com safe.bankofamerica.com sanostra.es scotiaitrade.com secure.bankofamerica.com selfbank.es siebertnet.com singlepoint.usbank.com sitekey.bankofamerica.com sitibusiness.citibank.com srvc1.jpmorgan.com srvc2.jpmorgan.com ss2.experian.com streetscape.com svbconnect.com tioexpress.com trade.loginandtrade.com trademonster.com treas-mgt.frostbank.com treasury.pncbank.com treasurypathways.com|ulsterbank.co.uk ulsterbankanytimebanking.co.uk us.etrade.com usaa.com wblnk wcmfd/wcmpw web2.westlaw.com web-access.com webach webcmpr. webinfocus. webinfocus.mandtbank.com weblink.websterbank.com websteronline.com wellsoffci e.wellsfargo.com whitneybusinessnetwork.whitneybank.com www.signatureny.web-access.com www.treasury.pncbank.com www2.citizensbankmoneymanagergps.com www8.comerica.com|\n|---|---|---|\n\n\n-----\n\n## Appendix II\n\n###### Network based indicators of compromise\n\n**Domains**\n\nThe following domains appear hardcoded in Ponmocup instances and are used for C&C IP calculation, as described in paragraph 6.1.\n\n`abccornet.com` `dogmationation.com` piclbumestream.com\n```\n              adertisecorp.com dynodns.org postdone.com\n\n```\naffilipcorp.com `enckfeld.net` `ratilovskoye.com`\n```\n              anexcorp.org familyinteresting.com recising.com\n              britishfederal.org fasternation.net searchforthat.net\n              changinessmen.com freewayreg.com sectionsfear.com\n              claimsreference.net headedpicked.com separtila.com\n              clickoptimiser.net headedpicked.net standardbay.net\n              contentdeliveryorg.net highlytraditional.org streamingadv.com\n              contextexpert.org himmeding.com ternations.com\n\n```\ncontinuatu.com `howeveraged.net` `thomaslaid.net`\n\nculminaccessful.com `hydroelection.net` traffictradexpert.com\n\n`cybernan.net` `illegedly.com` twicecitizens.com\n```\n              defenciclovis.com imagesharehost.com veristats.net\n\n```\n`descriptioned.com` `leadwriting.com` virtualsearches.com\n```\n              detroportans.com meetinglimited.com workerssan.net\n\n```\ndirecticulture.com `netdiscovery.org` `yaltimate.com`\n```\n              directlyvast.com picasootoolbar.com\n\n```\n**Resolving IP’s**\n\nThe following IPs are pointed to by the hardcoded domains listed above, as explained in chapter 6.\n\n|abccornet.com adertisecorp.com affli ipcorp.com anexcorp.org britishfederal.org changinessmen.com claimsreference.net clickoptimiser.net contentdeliveryorg.net contextexpert.org continuatu.com culminaccessful.com cybernan.net defenciclovis.com descriptioned.com detroportans.com directiculture.com directlyvast.com|Col2|Col3|Col4|Col5|Col6|Col7|Col8|Col9|Col10|Col11|Col12|Col13|Col14|Col15|Col16|Col17|Col18|dogmationation.com dynodns.org enckfeld.net familyinteresting.com fasternation.net freewayreg.com headedpicked.com headedpicked.net highlytraditional.org himmeding.com howeveraged.net hydroelection.net illegedly.com imagesharehost.com leadwriting.com meetinglimited.com netdiscovery.org picasootoolbar.com|Col20|Col21|Col22|Col23|Col24|piclbumestream.com postdone.com ratilovskoye.com recising.com searchforthat.net sectionsfear.com separtila.com standardbay.net streamingadv.com ternations.com thomaslaid.net traffci tradexpert.com twicecitizens.com veristats.net virtualsearches.com workerssan.net yaltimate.com|\n|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|\n|R T|e he|so f|lvi oll|ng ow|IP in|’s g I|Ps|ar|e|po|int|ed|t|o b|y t|he|h||ar|dc|od|ed|||\n|||1 2 4 6 1 2 3 8 6 8 2 2 1 1 2 4 1 2|09 43 .2 3. 66 31 1. 5. .8 0. 22 34 16 56 1. 2. 99 27|.7 .1 27 77. .1 .1 17 66 8. 21 .2 .1 .1 .4 8. 10 .1 .2|4. 82 .7 1 78 50 1. .2 25 3. 19 02 81 4. 19 7. 72 48|19 .1 0. 06 .1 .9 13 3. .8 59 .8 .8 .5 19 4. 14 .5 .1|5. 00 65 .1 13 8. 0. 12 0 .5 5. 1. .6 5. 15 0. 2. 4.|14 .2 .1 13 24 5 0 79 20 1 20 14 66 79|9 27 44 7 9 6 0 7||||||||||||1 4 1 2 2 9 4 4 1 1 2 2 1 2 4 1 1 1|55 4. 68 04 53 4. 0. 9. 04 44 03 53 06 04 1. 51 06 14|.83.123.22 36.245.224 .23.171.69 .37.98.202 .101.238.123 75.201.33 22.124.164 197.32.49 .127.201.198 .61.46.13 .136.214.219 .134.178.81 .8.16.175 .11.56.48 252.243.242 .225.26.181 .110.29.248 .225.99.185|2.171.234.238 50.116.56.144 102.209.206.89 7.34.116.64 38.155.216.69 27.251.60.63 158.76.160.100 100.134.242.235 124.3.139.20 25.20.33.76 189.140.10.37 59.228.144.104 204.11.56.48 29.205.223.64 94.75.201.33 118.15.53.129 22.149.159.105|\n\n\n-----\n\n**IPs used for Command and Control traffic**\n\nThe following IPs are actually used for command and control traffic, as explained in chapter 6.\n\n|182.62.211.45 185.17.184.249 214.66.10.71 217.23.3.243 217.23.3.244 217.23.3.249 232.187.207.67|26.252.164.23 28.16.103.211 62.212.68.230 78.109.28.248 78.109.28.249 78.109.28.250 85.17.133.193|Col3|Col4|Col5|Col6|Col7|85.17.133.194 89.172.227.240 93.115.88.220 95.211.240.193 95.211.240.194|Col9|Col10|Col11|Col12|Col13|Col14|Col15|Col16|Col17|Col18|Col19|Col20|Col21|Col22|Col23|Col24|Col25|Col26|\n|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|\n||||||.1.|||||||||||||||||||||\n|alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (ms HTTP Request (generic)\"; fol w:established,to_server; cont pattern;http_header; content:\"Pragma|3a| no-cache|0d 0a| Control|3a| no-cache|0d 0a|\";http_header; content:!\"Refer content:\"Cookie|3a| \";http_header; pcre:\"/^Host\\x3A[^\\r\\n x2e\\d{1,3}\\r\\n/Hm\"; content:!\"Accept-Encoding|3a| \";http_h \";http_header; content:!\"Content-Type|3a| \";http_header; com/2015/12/02/ponmocup-a-giant-hiding-in-the-shadows; t count 1, seconds 600; classtype:trojan-activity; priorit alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (ms plugin-specifci check-in\"; content:\"GET\"; http_method; co distance:0; content:\"Content-Type: application/x-www-for distance:0; pcre:\"/Host: ([0-9]{1,3}\\.){3}[0-9]{1,3}\\x0d/\"; Mozilla/4.\"; distance:0; content:\"Cookie: \"; pcre:\"/Cook (=){0,2}/i\"; distance:0; urilen:<50,norm; content:!\"Refere by_src, count 1, seconds 600; classtype:trojan-activity; com/2015/12/02/ponmocup-a-giant-hiding-in-the-shadows; s|||||g: en \"; e ]+ ea r hr y: g: nt m- di i r\" r id|\"F t: ht r|3 ?\\d de ef es 1; \"F en ur st e: ; ef :2|O \"A tp a { r er ho s O t: le a [ t e 10|X- cc _ |\"; 1, ; en l i X- \"H n nc a- hr re 01|SR e he h 3} co c d: d: SR T co e: z0 e nc 68|T pt ad tt \\x nt e: ty 21 T TP de 0; -9 sh e 6|- : er p_ 2e e ur pe 00 - /1 d\" c ]{ ol :u ;|Tr */ ; h \\d nt l, l 15 Tr .1 ; on 1, d: rl re|o *| c ea {1 :! ht i 33 o |0 f t 10 ty ,h v:|ja 0d on de ,3 \"A tp mi ; ja d0 as en }= p tt 1;|n 0 te r; }\\ cc :/ t, r n a| t_ t: [a e p: )|- a| n x2 ep /b t ev - Ac pa \"U -z li //|Po \"; t:\" e\\ t- lo ra :1 Po c t se 0- mi bl|n fa C d La g c ;) n ep te r- 9 t, og|mo s ac {1 n .F k mo t: rn A +/ .F|cu t_ he ,3 gu ox by cu * ; ge ]{ tr o|p - }\\ ag -I _s p /* nt 20 ac x-|e| T. r \"; : ,5 k IT|3a c, 00 .|| }||\n|||||||||||||||||||||||||||\n|alert udp $HOME_NET $SIP_PORTS -> any any (msg:\"FOX (SIP scanner)\"; content:\"User-Agent|3a| Zoiper for limit, count 1, seconds 3600, track by_src; refere ponmocup-a-giant-hiding-in-the-shadows; sid:2100149||-S Wi nc 3;|RT nd e: c|ow ur l|- s l, as|Tr r ht st|oj ev t yp|an .1 p: e:|81 //b t|- 2| l ro|Po 0d og ja|nm 0 .F n-|o a| ox a|cu \"; -I ct|p t T. iv|pl hr co it|u es m y;|gi h /2 r|n ol 01 e|#2 d: 5/ v:|60 t 12 1;|0 y /0 )|pe 2/|||\n\n\n-----\n\n## Appendix III\n\n###### Host based indicators of compromise\n\n**YARA signature**\n\n###### The following YARA signature can be used to scan for Ponmocup plug-ins in memory. This is based on the content of the PE\n\nheaders, as explained in chapter 5.3\n\n\nrule Ponmocup : plugins\n```\n{       meta:\n\n```\ndescription = \"Ponmocup plugin detection (memory)\"\n\nauthor = \"Danny Heppener, Fox-IT\"\n```\n       strings:\n\n```\n$1100 = {4D 5A 90 [29] 4C 04}\n$1201 = {4D 5A 90 [29] B1 04}\n$1300 = {4D 5A 90 [29] 14 05}\n$1350 = {4D 5A 90 [29] 46 05}\n$1400 = {4D 5A 90 [29] 78 05}\n$1402 = {4D 5A 90 [29] 7A 05}\n$1403 = {4D 5A 90 [29] 7B 05}\n$1404 = {4D 5A 90 [29] 7C 05}\n$1405 = {4D 5A 90 [29] 7D 05}\n$1406 = {4D 5A 90 [29] 7E 05}\n$1500 = {4D 5A 90 [29] DC 05}\n$1501 = {4D 5A 90 [29] DD 05}\n$1502 = {4D 5A 90 [29] DE 05}\n$1505 = {4D 5A 90 [29] E1 05}\n$1506 = {4D 5A 90 [29] E2 05}\n$1507 = {4D 5A 90 [29] E3 05}\n$1508 = {4D 5A 90 [29] E4 05}\n$1509 = {4D 5A 90 [29] E5 05}\n$1510 = {4D 5A 90 [29] E6 05}\n$1511 = {4D 5A 90 [29] E7 05}\n$1512 = {4D 5A 90 [29] E8 05}\n$1600 = {4D 5A 90 [29] 40 06}\n$1601 = {4D 5A 90 [29] 41 06}\n$1700 = {4D 5A 90 [29] A4 06}\n$1800 = {4D 5A 90 [29] 08 07}\n$1801 = {4D 5A 90 [29] 09 07}\n$1802 = {4D 5A 90 [29] 0A 07}\n$1803 = {4D 5A 90 [29] 0B 07}\n$2001 = {4D 5A 90 [29] D1 07}\n$2002 = {4D 5A 90 [29] D2 07}\n$2003 = {4D 5A 90 [29] D3 07}\n$2004 = {4D 5A 90 [29] D4 07}\n$2500 = {4D 5A 90 [29] C4 09}\n$2501 = {4D 5A 90 [29] C5 09}\n$2550 = {4D 5A 90 [29] F6 09}\n$2600 = {4D 5A 90 [29] 28 0A}\n$2610 = {4D 5A 90 [29] 32 0A}\n$2700 = {4D 5A 90 [29] 8C 0A}\n$2701 = {4D 5A 90 [29] 8D 0A}\n$2750 = {4D 5A 90 [29] BE 0A}\n$2760 = {4D 5A 90 [29] C8 0A}\n$2810 = {4D 5A 90 [29] FA 0A}\n```\n       condition:\n\n```\nany of ($1100,$1201,$1300,$1350,$1400,$1402,$1403,$1404,$1405,$1406,\n$1500,$1501,$1502,$1505,$1506,$1507,$1508,$1509,$1510,$1511,$1512,$1600,$1601,$1700,$1800,$1801,\n$1802,$1803,$2001,$2002,$2003,$2004,$2500,$2501,$2550,$2600,$2610,$2700,$2701,$2750,$2760,$2810)\n```\n}\n\n```\n\n-----\n\n**Registry**\n\nRegistry keys used by the Ponmocup framework for information storage.\n\n\nHKEY_CURRENT_USER\\Software\\Microsoft\\Multimedia\\1\n\nHKEY_CURRENT_USER\\Software\\Microsoft\\Multimedia\\2\n\nHKEY_CURRENT_USER\\Software\\Microsoft\\Multimedia\\3\n\nHKEY_CURRENT_USER\\Software\\Microsoft\\Multimedia\\4\n\nHKEY_CURRENT_USER\\Software\\Microsoft\\Multimedia\\5\n\nHKEY_CURRENT_USER\\Software\\Microsoft\\Multimedia\\6\n\nHKEY_CURRENT_USER\\Software\\Microsoft\\Multimedia\\7\n\nHKEY_CURRENT_USER\\Software\\Microsoft\\Multimedia\\8\n\nHKEY_CURRENT_USER\\Software\\Microsoft\\Multimedia\\9\n\nHKEY_CURRENT_USER\\Software\\Microsoft\\Multimedia\\10\n\nHKEY_CURRENT_USER\\Software\\Microsoft\\Multimedia\\11\n\n\nCopyright © 2015 Fox-IT BV\n\nAll rights reserved. No part of this document shall be reproduced, stored in a retrieval system or transmitted by any means\n###### without written permission from Fox-IT. Violations will be prosecuted by applicable law. The general service conditions of\n\nFox-IT B.V. apply to this documentation.\n\n**Trademark**\n\nFox-IT and the Fox-IT logo are trademarks of Fox-IT B.V.\n\nAll other trademarks mentioned in this document are owned by the mentioned legacy body or organization.\n\n\n-----\n\nfox-it\n\n**•** Was founded in 1999.\n\n**•** Established one of the first Cyber Security\n\nOperations Centers in Europe.\n\n**•** Is Europe’s largest specialized cyber security\n\ncompany.\n\n**•** Operates in three business areas:\n\n1 Cyber Threat Management: a solution portfolio\n\naimed at reducing the risks of cyber threats,\n\nand includes: professional services, managed\n\nsecurity services, and technology;\n\n2 Web and Mobile event analytics: a solution\n\nportfolio that is aimed at reducing financial\n\nrisks in (online) payment transactions;\n\n3 High Assurance: solutions that make trusted\n\ncommunication possible to the highest\n\nclassification levels.\n\n**•** Has been involved in many high-profile Incident\n\nResponse cases. Most of the cases we worked on\n\nare secret. An approved selection can be shared\n\nupon request.\n\nFox-IT\n\nOlof Palmestraat 6, Delft t +31 (0) 15 284 79 58 Iban nl57abna0554697041\n\npo box 638, 2600 ap Delft f +31 (0) 15 284 79 90 kvk Haaglanden 27301624\n\nThe Netherlands www.Fox-IT.com\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        }
    ],
    "references": [
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2015/2015.11.30.Ponmocup/foxit-whitepaper_ponmocup_1_1.pdf"
    ],
    "report_names": [
        "foxit-whitepaper_ponmocup_1_1"
    ],
    "threat_actors": [
        {
            "id": "67bf0462-41a3-4da5-b876-187e9ef7c375",
            "created_at": "2022-10-25T16:07:23.44832Z",
            "updated_at": "2025-03-27T02:02:09.806007Z",
            "deleted_at": null,
            "main_name": "Careto",
            "aliases": [
                "Careto",
                "The Mask",
                "Ugly Face"
            ],
            "source_name": "ETDA:Careto",
            "tools": [
                "Careto"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "d90307b6-14a9-4d0b-9156-89e453d6eb13",
            "created_at": "2022-10-25T16:07:23.773944Z",
            "updated_at": "2025-03-27T02:02:09.974695Z",
            "deleted_at": null,
            "main_name": "Lead",
            "aliases": [
                "Casper",
                "TG-3279"
            ],
            "source_name": "ETDA:Lead",
            "tools": [
                "Agentemis",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "RbDoor",
                "RibDoor",
                "Winnti",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "aa73cd6a-868c-4ae4-a5b2-7cb2c5ad1e9d",
            "created_at": "2022-10-25T16:07:24.139848Z",
            "updated_at": "2025-03-27T02:02:10.120505Z",
            "deleted_at": null,
            "main_name": "Safe",
            "aliases": [],
            "source_name": "ETDA:Safe",
            "tools": [
                "DebugView",
                "LZ77",
                "OpenDoc",
                "SafeDisk",
                "TypeConfig",
                "UPXShell",
                "UsbDoc",
                "UsbExe"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "a66438a8-ebf6-4397-9ad5-ed07f93330aa",
            "created_at": "2022-10-25T16:47:55.919702Z",
            "updated_at": "2025-03-27T02:05:17.412024Z",
            "deleted_at": null,
            "main_name": "IRON VIKING",
            "aliases": [
                "ATK14 ",
                "BlackEnergy Group",
                "Blue Echidna ",
                "CTG-7263 ",
                "ELECTRUM ",
                "FROZENBARENTS ",
                "Hades/OlympicDestroyer ",
                "IRIDIUM ",
                "Qudedagh ",
                "Sandworm Team ",
                "Seashell Blizzard ",
                "TEMP.Noble ",
                "Telebots ",
                "Voodoo Bear ",
                "APT44 "
            ],
            "source_name": "Secureworks:IRON VIKING",
            "tools": [
                " BlackEnergy",
                " GCat",
                " GreyEnergy",
                " Industroyer",
                " KillDisk",
                " NotPetya",
                " PSCrypt",
                " TeleBot",
                " TeleDoor",
                " xData",
                "BadRabbit"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "b3e954e8-8bbb-46f3-84de-d6f12dc7e1a6",
            "created_at": "2022-10-25T15:50:23.339976Z",
            "updated_at": "2025-03-27T02:00:55.446795Z",
            "deleted_at": null,
            "main_name": "Sandworm Team",
            "aliases": [
                "Sandworm Team",
                "ELECTRUM",
                "Telebots",
                "IRON VIKING",
                "BlackEnergy (Group)",
                "Quedagh",
                "Voodoo Bear",
                "IRIDIUM",
                "Seashell Blizzard",
                "FROZENBARENTS",
                "APT44"
            ],
            "source_name": "MITRE:Sandworm Team",
            "tools": [
                "Bad Rabbit",
                "Mimikatz",
                "Exaramel for Linux",
                "Exaramel for Windows",
                "GreyEnergy",
                "PsExec",
                "Prestige",
                "P.A.S. Webshell",
                "VPNFilter",
                "Cyclops Blink",
                "SDelete",
                "AcidRain",
                "Industroyer",
                "Industroyer2",
                "BlackEnergy",
                "Cobalt Strike",
                "NotPetya",
                "KillDisk",
                "PoshC2",
                "Impacket",
                "Invoke-PSImage",
                "Olympic Destroyer"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "3a0be4ff-9074-4efd-98e4-47c6a62b14ad",
            "created_at": "2022-10-25T16:07:23.590051Z",
            "updated_at": "2025-03-27T02:02:09.878211Z",
            "deleted_at": null,
            "main_name": "Energetic Bear",
            "aliases": [
                "ATK 6",
                "Blue Kraken",
                "Crouching Yeti",
                "Dragonfly",
                "Electrum",
                "Energetic Bear",
                "Ghost Blizzard",
                "Group 24",
                "ITG15",
                "Iron Liberty",
                "Koala Team",
                "TG-4192"
            ],
            "source_name": "ETDA:Energetic Bear",
            "tools": [
                "Backdoor.Oldrea",
                "CRASHOVERRIDE",
                "Commix",
                "CrackMapExec",
                "CrashOverride",
                "Dirsearch",
                "Dorshel",
                "Fertger",
                "Fuerboos",
                "Goodor",
                "Havex",
                "Havex RAT",
                "Hello EK",
                "Heriplor",
                "Impacket",
                "Industroyer",
                "Karagany",
                "Karagny",
                "LightsOut 2.0",
                "LightsOut EK",
                "Listrix",
                "Oldrea",
                "PEACEPIPE",
                "PHPMailer",
                "PsExec",
                "SMBTrap",
                "Subbrute",
                "Sublist3r",
                "Sysmain",
                "Trojan.Karagany",
                "WSO",
                "Webshell by Orb",
                "Win32/Industroyer",
                "Wpscan",
                "nmap",
                "sqlmap",
                "xFrost"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "8941e146-3e7f-4b4e-9b66-c2da052ee6df",
            "created_at": "2023-01-06T13:46:38.402513Z",
            "updated_at": "2025-03-27T02:00:02.824555Z",
            "deleted_at": null,
            "main_name": "Sandworm",
            "aliases": [
                "G0034",
                "IRIDIUM",
                "Blue Echidna",
                "FROZENBARENTS",
                "Seashell Blizzard",
                "IRON VIKING",
                "ELECTRUM",
                "TeleBots",
                "UAC-0113",
                "UAC-0082",
                "APT44",
                "Quedagh",
                "VOODOO BEAR",
                "TEMP.Noble"
            ],
            "source_name": "MISPGALAXY:Sandworm",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "75108fc1-7f6a-450e-b024-10284f3f62bb",
            "created_at": "2024-11-01T02:00:52.756877Z",
            "updated_at": "2025-03-27T02:00:55.544216Z",
            "deleted_at": null,
            "main_name": "Play",
            "aliases": null,
            "source_name": "MITRE:Play",
            "tools": [
                "Nltest",
                "AdFind",
                "PsExec",
                "Wevtutil",
                "Cobalt Strike",
                "Playcrypt",
                "Mimikatz"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1666716492,
    "ts_updated_at": 1743041678,
    "ts_creation_date": 1448960823,
    "ts_modification_date": 1448960835,
    "files": {
        "pdf": "https://archive.orkl.eu/c27c1daaa60de3381a7cb11975bef88fa05c2449.pdf",
        "text": "https://archive.orkl.eu/c27c1daaa60de3381a7cb11975bef88fa05c2449.txt",
        "img": "https://archive.orkl.eu/c27c1daaa60de3381a7cb11975bef88fa05c2449.jpg"
    }
}