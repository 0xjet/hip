{
    "id": "f184b94f-3042-451f-85a6-bd13c8fb35b5",
    "created_at": "2023-01-12T15:06:00.446387Z",
    "updated_at": "2025-03-27T02:06:09.302426Z",
    "deleted_at": null,
    "sha1_hash": "a497b1c9ebe9beb28da17dbfe0da4c78b7fa167e",
    "title": "2022-01-02 - Malicious CSV text files used to install BazarBackdoor malware",
    "authors": "",
    "file_creation_date": "2022-05-27T02:10:09Z",
    "file_modification_date": "2022-05-27T02:10:09Z",
    "file_size": 3530070,
    "plain_text": "# Malicious CSV text files used to install BazarBackdoor malware\n\n**[bleepingcomputer.com/news/security/malicious-csv-text-files-used-to-install-bazarbackdoor-malware/](https://www.bleepingcomputer.com/news/security/malicious-csv-text-files-used-to-install-bazarbackdoor-malware/)**\n\nLawrence Abrams\n\nBy\n[Lawrence Abrams](https://www.bleepingcomputer.com/author/lawrence-abrams/)\n\nFebruary 1, 2022\n04:59 PM\n2\n\nA new phishing campaign is using specially crafted CSV text files to infect users' devices\nwith the BazarBackdoor malware.\n\nA comma-separated values (CSV) file is a text file containing lines of text with columns of\ndata separated by commas. In many cases, the first line of text is the header, or description,\nfor each column.\n\nFor example, a very basic CSV text file containing the capitals of some US states is\nillustrated below. Notice how commas separate each column of data (states and capitals).\n\n\n-----\n\n```\nState,Capital\nAlabama,Montgomery\nAlaska,Juneau\nArizona,Phoenix\nArkansas,Little Rock\nCalifornia,Sacramento\nColorado,Denver\nConnecticut,Hartford\nDelaware,Dover\nFlorida,Tallahassee\n\n```\nAs you can see above, the file contains nothing but text, but when loaded into Excel, the\ndata is presented with each line on its own row and the data separated by the commas into\ncolumns of data.\n\n**Example CSV file loaded in Microsoft Excel**\n\n_Source: BleepingComputer_\nUsing CSVs is a popular method to export data from applications that can then be imported\ninto other programs as a data source, whether that be Excel, a database, password\nmanagers, or billing software.\n\nSince a CSV is simply text with no executable code, many people consider these types of\nfiles harmless and may be more carefree when opening them.\n\n\n-----\n\nHowever, Microsoft Excel supports a feature called Dynamic Data Exchange (DDE), which\ncan be used to execute commands whose output is inputted into the open spreadsheet,\nincluding CSV files.\n\nUnfortunately, threat actors can also abuse this feature to execute commands that\ndownload and install malware on unsuspecting victims.\n\n## CSV file uses DDE to install BazarBackdoor\n\nA [new phishing campaign spotted by security researcher Chris Campbell is installing the](https://twitter.com/phage_nz/status/1488310674279530496)\nBazarLoader/BazarBackdoor trojan through malicious CSV files.\n\n[BazarBackdoor is a stealthy backdoor malware created by the TrickBot group to provide](https://www.bleepingcomputer.com/news/security/bazarbackdoor-trickbot-gang-s-new-stealthy-network-hacking-malware/)\nthreat actors remote access to an internal device that can be used as a springboard for\nfurther lateral movement within a network.\n\nThe phishing emails pretend to be \"Payment Remittance Advice\" with links to remote sites\nthat download a CSV file with names similar to 'document-21966.csv.'\n\n**BazarBackdoor phishing email**\n\n_Source: @phage_nz_\n\n\n-----\n\nLike all CSV files, the document-21966.csv file is just a text file, with columns of data\nseparated by commas, as seen below.\n\n**The document-21966.csv file opened in a text editor**\n\n_Source: BleepingComputer_\nThe astute reader, though, will notice that one of the data columns contains a strange\nWMIC call in one of the columns of data that launches a PowerShell command.\n\nThis `=WmiC| command is a DDE function that causes Microsoft Excel, if given permission,`\nto launch [WMIC.exe and execute the provided PowerShell command to input data into the](https://support.microsoft.com/en-us/topic/a-description-of-the-windows-management-instrumentation-wmi-command-line-utility-wmic-exe-f5c16751-3a83-49ee-030d-5092ce1a04bb)\nopen workbook.\n\nIn this particular case, the DDE will use WMIC to create a new PowerShell process that\nopens a remote URL containing another PowerShell command that is then executed.\n\nThe remote PowerShell script command, shown below, will download a picture.jpg file and\nsave it as C:\\Users\\Public\\87764675478.dll. This DLL program is then executed using the\nrundll32.exe command.\n\n**PowerShell executed to download BazarLoader**\n\n_Source: BleepingComputer_\n\n\n-----\n\n[The DLL file [Tria.ge sample] will install BazarLoader, ultimately deploying the](https://tria.ge/220201-anxmqsefa6)\nBazarBackdoor and other payloads on the device.\n\nThankfully, when this CSV file is opened in Excel, the program will spot the DDE call and\nprompt the user to \"enable automatic update of links,\" which is marked as a security\nconcern.\n\n**Confirm whether DDE**\n\n**should be enabled**\n_Source: BleepingComputer_\nEven if they enable the feature, Excel will show them another prompt confirming if WMIC\nshould be allowed to start to access the remote data.\n\n**Microsoft Excel asking to confirm if WMIC should be executed**\n_Source: BleepingComputer_\nIf the user confirms both prompts, Microsoft Excel will launch the PowerShell scripts, the\nDLL will be downloaded and executed, and BazarBackdoor will be installed on the device.\n\nWhile this threat does require users to confirm that the DDE function should be allowed to\nexecute, [AdvIntel CEO](https://www.advintel.io/) [Vitali Kremez told BleepingComputer that people are falling for the](https://twitter.com/VK_Intel)\nongoing phishing attack.\n\n\"Based on our visibility into the BazarBackdoor telemetry, we have observed 102 actual\nnon-sandbox corporate and government victims over the past two days from this phishing\ncampaign,\" Kremez explained in an online discussion.\n\nOnce BazarBackdoor is installed, it will allow the threat actors access to the corporate\nnetwork, which the attacks will use to spread laterally throughout the network.\n\n\n-----\n\nUltimately, this could lead to further malware infections, the stealing of data, and the\ndeployment of ransomware.\n\n### Related Articles:\n\n[Google exposes tactics of a Conti ransomware access broker](https://www.bleepingcomputer.com/news/security/google-exposes-tactics-of-a-conti-ransomware-access-broker/)\n\n[New ChromeLoader malware surge threatens browsers worldwide](https://www.bleepingcomputer.com/news/security/new-chromeloader-malware-surge-threatens-browsers-worldwide/)\n\n[New ERMAC 2.0 Android malware steals accounts, wallets from 467 apps](https://www.bleepingcomputer.com/news/security/new-ermac-20-android-malware-steals-accounts-wallets-from-467-apps/)\n\n[Popular Python and PHP libraries hijacked to steal AWS keys](https://www.bleepingcomputer.com/news/security/popular-python-and-php-libraries-hijacked-to-steal-aws-keys/)\n\n[PDF smuggles Microsoft Word doc to drop Snake Keylogger malware](https://www.bleepingcomputer.com/news/security/pdf-smuggles-microsoft-word-doc-to-drop-snake-keylogger-malware/)\n\n[Attachments](https://www.bleepingcomputer.com/tag/attachments/)\n[BazarBackdoor](https://www.bleepingcomputer.com/tag/bazarbackdoor/)\n[Comma-separated values](https://www.bleepingcomputer.com/tag/comma-separated-values/)\n[CSV](https://www.bleepingcomputer.com/tag/csv/)\n[Malware](https://www.bleepingcomputer.com/tag/malware/)\n\n[Lawrence Abrams](https://www.bleepingcomputer.com/author/lawrence-abrams/)\n\nLawrence Abrams is the owner and Editor in Chief of BleepingComputer.com. Lawrence's\narea of expertise includes Windows, malware removal, and computer forensics. Lawrence\nAbrams is a co-author of the Winternals Defragmentation, Recovery, and Administration\nField Guide and the technical editor for Rootkits for Dummies.\n\n[Previous Article](https://www.bleepingcomputer.com/offer/deals/build-an-instant-ai-reference-library-with-this-ebook-bundle-deal/)\n[Next Article](https://www.bleepingcomputer.com/news/security/fbi-warns-of-fake-job-postings-used-to-steal-money-personal-info/)\n\n### Comments\n\n\n-----\n\n[Echo64 - 3 months ago](https://www.bleepingcomputer.com/forums/u/817471/echo64/)\n\nWondering if any of these are coming through as .csv files directly attached to the\nemail or if they all require users to click a link to download, just got done blocking\n.html and .htm attachments, might need to add .csv to that list too.\n\n[MaBriIT - 3 months ago](https://www.bleepingcomputer.com/forums/u/1237751/mabriit/)\n\nFrom https://support.microsoft.com/en-us/topic/microsoft-excel-security[enhancements-in-the-january-2022-update-kb5010321-6c925c6f-e5a0-4698-860d-](https://support.microsoft.com/en-us/topic/microsoft-excel-security-enhancements-in-the-january-2022-update-kb5010321-6c925c6f-e5a0-4698-860d-2d75e70e970a)\n2d75e70e970a, I read \"Microsoft has released two security enhancements as\ndefense-in-depth measures for Excel in the January 2022 update. These security\nenhancements disable Dynamic Data Exchange (DDE) and automatic activation of\nOLE (Object Linking and Embedding) objects in all supported versions of Excel\". Is\nthis still a problem?\n\nPost a Comment [Community Rules](https://www.bleepingcomputer.com/posting-guidelines/)\n\nYou need to login in order to post a comment\n\n[Not a member yet? Register Now](https://www.bleepingcomputer.com/forums/index.php?app=core&module=global&section=register)\n\n### You may also like:\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-01-02 - Malicious CSV text files used to install BazarBackdoor malware.pdf"
    ],
    "report_names": [
        "2022-01-02 - Malicious CSV text files used to install BazarBackdoor malware.pdf"
    ],
    "threat_actors": [
        {
            "id": "d90307b6-14a9-4d0b-9156-89e453d6eb13",
            "created_at": "2022-10-25T16:07:23.773944Z",
            "updated_at": "2025-03-27T02:02:09.974695Z",
            "deleted_at": null,
            "main_name": "Lead",
            "aliases": [
                "Casper",
                "TG-3279"
            ],
            "source_name": "ETDA:Lead",
            "tools": [
                "Agentemis",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "RbDoor",
                "RibDoor",
                "Winnti",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535960,
    "ts_updated_at": 1743041169,
    "ts_creation_date": 1653617409,
    "ts_modification_date": 1653617409,
    "files": {
        "pdf": "https://archive.orkl.eu/a497b1c9ebe9beb28da17dbfe0da4c78b7fa167e.pdf",
        "text": "https://archive.orkl.eu/a497b1c9ebe9beb28da17dbfe0da4c78b7fa167e.txt",
        "img": "https://archive.orkl.eu/a497b1c9ebe9beb28da17dbfe0da4c78b7fa167e.jpg"
    }
}