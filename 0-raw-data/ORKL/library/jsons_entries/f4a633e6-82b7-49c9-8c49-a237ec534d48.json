{
    "id": "f4a633e6-82b7-49c9-8c49-a237ec534d48",
    "created_at": "2023-01-12T15:09:24.031804Z",
    "updated_at": "2025-03-27T02:06:07.661238Z",
    "deleted_at": null,
    "sha1_hash": "e8fb284d10ed8d9bd8987fdfd2e4ab7e09a4038c",
    "title": "2017-12-27 - Let's Learn- Cutlet ATM Malware Internals",
    "authors": "",
    "file_creation_date": "2022-05-28T04:12:30Z",
    "file_modification_date": "2022-05-28T04:12:30Z",
    "file_size": 469922,
    "plain_text": "# Let's Learn: Cutlet ATM Malware Internals\n\n**[vkremez.com/2017/12/lets-learn-cutlet-atm-malware-internals.html](http://www.vkremez.com/2017/12/lets-learn-cutlet-atm-malware-internals.html)**\n\n**Goal: Analyze the internals of the prolific Cutlet ATM malware (VMProtect).**\n\n**Sample:** [fac356509a156a8f11ce69f149198108](https://www.virustotal.com/#/file/4a340a0a95f2af5ab7f3bfe6f304154e617d0c47ce31ee8426c70b86e195320c/detection)\n\nThe blog outline is as follows:\n\nI. Cutlet ATM Malware Background\nII. Method of Operation\nIII. Threat Scope\nIV. Cutlet ATM Malware Analysis\nA. \"start cooking\" and \"CHECK HEAT\" functions\nB Cutlet's CSCWCNG API calls to dispense and transport cash\n\n\n-----\n\nV. Possible Mitigation\nVI. YARA RULE\n**I. Cutlet ATM Malware Background**\nThis Cutlet malware became one of the most widely used malware targeting Automated Teller\nMachines (ATMs). The ATM malware is available on the underground and leveraged by\nmultiple actors in numerous ATM jackpotting heists. The malware targets one ATM vendor\nonly, which is Diebold Nixdorf, formerly known as Wincor Nixdorf.\n**II. Method of Operation**\nThe Cutlet malware is to be installed into individual ATMs, designed to make targeted\nmachines dispense bills automatically via emptying cash-carrying cassettes. Typically, the\nATM malware operation requires two individuals to be involved: one with the direct physical\naccess to the ATM device connected to its backend USB port via a controlled PC; another\none - remotely connected and able to release the key to dispense the cash to the first\nindividual. By and large, the Cutlet malware, written in Borland Delphi, demonstrates its\ndeveloper familiarity with the ATM-specific model proprietary API calls.\n**III. Threat Scope**\nAlongside with the infamous Tyupkin, Skimer, and Ripper ATM malware, the Cutlet ATM\nmalware is a formidable threat on the ATM malware landscape. The surfaced reports\n[generated a significant amount of attention to the malware from the industry(1)(2) and has](http://blog.trendmicro.com/trendlabs-security-intelligence/dissecting-prilex-cutlet-maker-atm-malware-families/)\nsparked interest within the cybercriminal underground.\n**IV. Cutlet ATM Malware Analysis (version 1.0 F)**\n**A. \"start cooking\" and \"CHECK HEAT\" functions**\nEssentially, while heavily packed, the core Cutlet ATM malware is rather trivial and targets\nonly ATM manufacturer. The variant accepts the integer input from 1-9, which corresponds to\nATM cassette slot number from 1-9.\n\n\n-----\n\n<cassette slot number (integer) x 50 \"CUTLETS\" of banknotes count 60>\nThe main malware functions work as follows:\n**\"start cooking!\" -> Dispense 50 \"CUTLETS\" of banknotes count 60**\n\"CHECK **HEAT\" -> Dispense 1 \"CUTLET\"**\n**\"Reset\" -> Reset the cash dispensing process**\n**\"Stop!\" -> Terminates the cash \"cooking\" process**\n**B. ATM's CSCWCNG API calls to dispense and transport cash**\nThe malware operates leveraging the Nixdorf proprietary CSCWCNG.DLL API calls to\nmanipulate the machine as follows:\n**CscCngOpen -> Connect to the ATM cashout module called \"CNG\" and open the device**\n**CscCngDispense -> Dispense cash function to tray**\n**CscCngTransport -> Transport cash to the collection for pickup**\n**V. Possible Mitigation**\nMonitoring, and reviewing any third-party applications that leverage the CSCWCNG API calls\nmight assist with mitigating exposure to the Cutlet malware once it is already installed. It\nmight be a good idea to whitelist only necessary applications to allow them to leverage these\nAPI calls.\n**VI. YARA RULE**\n**rule crime_win32_atm_cutlet_unpacked_in_memory {**\n**meta:**\ndescription = \"Detects Cutlet ATM malware\"\n\nauthor = \"@VK Intel\"\n\n\n-----\n\nreference = Detects the Cutlet ATM malware\ndate = \"2017-12-26\"\nhash = \"fac356509a156a8f11ce69f149198108\"\n\n**strings:**\n// DIEBOLD NIXDORF DLL ATM LIBRARY\n$dll = \"CSCWCNG.dll\" wide ascii\n\n// DLL PROCEDURES ASSOCIATED WITH CUTLET ATM\n$dll_proc1 = \"CscCngClose\" wide ascii\n$dll_proc2 = \"CscCngTransport\" wide ascii\n$dll_proc3 = \"CscCngReset\" wide ascii\n$dll_proc4 = \"CscCngDispense\" wide ascii\n$dll_proc5 = \"CscCngOpen\" wide ascii\n\n// CUTLET MALWARE STRINGS\n$str0 = \"CSCCNG\" wide ascii\n$str1 = \"Code:\" wide ascii\n$str2 = \"Delphi\" wide ascii\n\n**condition:**\n$dll and 4 of ($dll_proc*) and all of ($str*)\n}\n**Update (01-01-2017): The observed Cutlet ATM malware variants are as follows:**\n\n\n**Filename**\n**First Seen**\n\ncm.vmp.exe &\ncm17F.exe\n\ncm17F [11139].exe\n\n\n**Country**\n**First**\n**Seen**\n\nUnknown\n&\nMoldova\n\nUkraine\n\n\n**CUTLET ATM MD5 Hash**\n\n\n**Date**\n**First**\n**Seen**\n\n\nfac356509a156a8f11ce69f149198108 201608-04\n20:49:28\n\nee1b05b6c3b51472c98f3640cdec278b 2017-1112\n12:56:22\n\ndcf51a144816275fa4e3c3724731dca9 201608-18\n14:54:11\n\n3c3a3923e457467c39d0075f5c72a1b7 2017-1113\n08:15:35\n\n\n**Version**\n**Seen**\n\nVERSION\n1.0 F\n\nVERSION\n1.0 F\n\nVERSION\n1.0 F\n\nVERSION\n1.0 F\n\n\ncm16F.exe Sweden\n\n000538.exe Ukraine\n\n\n-----\n\nc97d2add446e75f88d65a9f9747e7ef7 2017-1110\n17:36:07\n\n27640bb7908ca7303d13d50c14ccf669 201608-04\n19:48:31\n\n277ced0b4094ce608bccce5acd24be88 2017-1113\n08:11:14\n\n\nVERSION\n1.0 F\n\nSIMULATOR\nSOFT\n\nVERSION\n1.0 F\n\n\nCutlet17.exe Russia\n\nStimulator.exe United\nStates\n\n\n000538 [13125].exe\n\n\nUkraine\n\n\nThe world heatmap of all uploaded variant is as follows displaying Ukraine as the top\nuploader of Cutlet ATM samples:\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2017/2017-12-27 - Let's Learn- Cutlet ATM Malware Internals.pdf"
    ],
    "report_names": [
        "2017-12-27 - Let's Learn- Cutlet ATM Malware Internals.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673536164,
    "ts_updated_at": 1743041167,
    "ts_creation_date": 1653711150,
    "ts_modification_date": 1653711150,
    "files": {
        "pdf": "https://archive.orkl.eu/e8fb284d10ed8d9bd8987fdfd2e4ab7e09a4038c.pdf",
        "text": "https://archive.orkl.eu/e8fb284d10ed8d9bd8987fdfd2e4ab7e09a4038c.txt",
        "img": "https://archive.orkl.eu/e8fb284d10ed8d9bd8987fdfd2e4ab7e09a4038c.jpg"
    }
}