{
    "id": "4f1f6972-2b65-4204-bacb-30cd3b13a2aa",
    "created_at": "2023-01-12T15:07:19.085842Z",
    "updated_at": "2025-03-27T02:09:29.549054Z",
    "deleted_at": null,
    "sha1_hash": "62290e847492a65b87b1996bd9fc80d5b4b06043",
    "title": "2022-04-18 - How to recover files encrypted by Yanlouwang",
    "authors": "",
    "file_creation_date": "2022-05-27T19:02:39Z",
    "file_modification_date": "2022-05-27T19:02:39Z",
    "file_size": 2060528,
    "plain_text": "# How to recover files encrypted by Yanluowang\n\n**[securelist.com/how-to-recover-files-encrypted-by-yanlouwang/106332/](https://securelist.com/how-to-recover-files-encrypted-by-yanlouwang/106332/)**\n\nAuthors\n\n[Marc Rivero](https://securelist.com/author/marcrivero/)\n\n[Yanis Zinchenko](https://securelist.com/author/yaniszinchenko/)\n\nYanluowang is a type of targeted ransomware discovered by the Symantec Threat Hunter\nteam as they were investigating an incident on a large corporate network. Kaspersky experts\nhave found a vulnerability in the Yanluowang encryption algorithm and created a free\ndecryptor to help victims of this ransomware with recovering their files.\n\n## Yanluowang description\n\nThe ransomware is relatively recent, its name a reference to the Chinese deity Yanluo Wang,\none of the Ten Kings of Hell. Unfortunately, we do not know much about the victims.\nAccording to Kaspersky Security Network data, attacks have been carried out in the United\nStates, Brazil, Turkey and a few other countries. The low number of infections is due to the\ntargeted nature of the ransomware: threat actors prepare and implement attacks on specific\ncompanies only.\n\n\n-----\n\n_[Geography of the Yanluowang attacks, December 4th, 2021 – April 8th, 2022 (download)](https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2022/04/15153446/01-en-yanlouwang-ransomware.png)_\n\nIn the ransom note, the cybercriminals demand not to contact law enforcement and not ‘keep\nthem for fools’:\n\nThe ransomware program has the functionality to terminate virtual machines, processes and\nservices. This is necessary to make files used by other programs available for encryption.\nThe main parts of stopped services and processes include databases, email services,\nbrowsers, programs for working with documents, security solutions, backups and shadow\ncopy services.\n\n\n-----\n\n**_Lists of stopped services and processes_**\n\nAccording to public information about the ransomware, it is only used in targeted attacks\nrather than in other RaaS families. Yanluowang itself needs parameters to be executed in the\nsystem, meaning it will be executed either manually or through a combination of scripts in the\ncompromised system. The available syntax in the ransomware is:\n\n1 encrypt.exe [(-p,-path,--path)<path>]\n\nThe Sosemanuk stream cipher is used to encrypt files, its key then encrypted using the RSA1024 asymmetric algorithm. The RSA public key itself is embedded in the program but\nadditionally encrypted with the RC4 stream cipher whose key is a string and also embedded\nin ransomware. Files before and after encryption:\n\n\n-----\n\n**_When the encryption process is completed, the file extensions will be changed to_**\n**_.yanluowang_**\n\nYanluowang divides files into big and small along a 3 GB threshold. Small files are encrypted\ncompletely from beginning to end, big files are encrypted in stripes: 5 megabytes after every\n200 megabytes.\n\n\n-----\n\n**_The encryption code for big files_**\n\nAfter a file is encrypted, an RSA-encrypted Sosemanuk key is written to the end of it. The\nencrypted endfile block has a size of 1024 bytes.\n\n**_An encrypted block with a Sosemanuk key_**\n\n\n-----\n\n## Files decryption\n\nKaspersky experts have analyzed the ransomware and found a vulnerability that allows\ndecrypting files of affected users via a known-plaintext attack. All that was required for this to\n[work was added to the Rannoh decryption tool.](https://noransom.kaspersky.com/)\n\nTo decrypt a file, you should have at least one original file. As mentioned earlier, the\nYanluowang ransomware divides files into big and small files along a 3 gigabyte threshold.\nThis creates a number of conditions that must be met in order to decrypt certain files:\n\nTo decrypt small files (less than or equal to 3 GB), you need a pair of files with a size of\n1024 bytes or more. This is enough to decrypt all other small files.\nTo decrypt big files (more than 3 GB), you need a pair of files (encrypted and original)\nno less than 3 GB in size each. This will be enough to decrypt both big and small files.\n\nBy virtue of the above points, if the original file is larger than 3 GB, it is possible to decrypt all\nfiles on the infected system, both big and small. But if there is an original file smaller than 3\nGB, then only small files can be decrypted.\n\n## Indicators of Compromise\n\nKaspersky solutions detect and protect against this ransomware, detecting it as Trojan**Ransom.Win32.Yanluowang with File Threat Protection and proactively as**\n**PDM:Trojan.Win32.Generic with Behavior Detection.**\n\n**MD5**\n\n[afaf2d4ebb6dc47e79a955df5ad1fc8a](https://opentip.kaspersky.com/afaf2d4ebb6dc47e79a955df5ad1fc8a/?utm_source=SL&utm_medium=SL&utm_campaign=SL)\n\n[ba95a2f1f1f39a24687ebe3a7a7f7295](https://opentip.kaspersky.com/ba95a2f1f1f39a24687ebe3a7a7f7295/?utm_source=SL&utm_medium=SL&utm_campaign=SL)\n\n## Piece of advice\n\nStill, it is important for a company to have a security solution that would enable instant\nresponse to such ransomware threats in order to avoid large financial losses. Yanluowang\nwas deployed in targeted human-operated attacks. As usual in such cases, we would like to\nremind you that a comprehensive cybersecurity strategy is required to protect against this\ntype of threats.\n\nHere are Kaspersky’s recommendations for staying safe from ransomware attacks:\n\nDo not expose remote desktop services (such as RDP) to public networks unless\nabsolutely necessary, and always use strong passwords.\nPromptly install available patches for commercial VPN solutions that provide access for\nremote employees and act as gateways to your network.\nAlways keep software up to date on all your devices to prevent ransomware from\nexploiting vulnerabilities.\n\n\n-----\n\nFocus your defense strategy on detecting lateral movement and data exfiltration to the\nInternet. Pay special attention to outgoing traffic to detect cybercriminals’ connections.\nBack up data regularly. Make sure you can quickly access your backups in an\nemergency.\nTo protect the corporate environment, educate your employees. Dedicated training\ncourses can help, such as the ones provided on Kaspersky Automated Security\nAwareness Platform.\nUse the latest [Threat Intelligence information to stay on top of actual TTPs used by](https://www.kaspersky.com/enterprise-security/threat-intelligence)\nthreat actors.\n[Use solutions like Kaspersky Endpoint Detection and Response and](https://www.kaspersky.com/enterprise-security/endpoint-detection-response-edr) Kaspersky\nManaged Detection and Response service which help to identify and stop an attack in\nthe early stages, before attackers can achieve their objectives.\nUse a reliable endpoint security solution, such as Kaspersky Endpoint Security for\nBusiness, that is powered by exploit prevention, behavior detection and a remediation\nengine capable of rolling back malicious actions. KESB also has self-defense\nmechanisms that can prevent its removal by cybercriminals.\n\n[Cybercrime](https://securelist.com/tag/cybercrime/)\n[Malware Technologies](https://securelist.com/tag/malware-technologies/)\n[Ransomware](https://securelist.com/tag/ransomware/)\n[Trojan](https://securelist.com/tag/trojan/)\n\nAuthors\n\n[Marc Rivero](https://securelist.com/author/marcrivero/)\n\n[Yanis Zinchenko](https://securelist.com/author/yaniszinchenko/)\n\nHow to recover files encrypted by Yanluowang\n\nYour email address will not be published. Required fields are marked *\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-04-18 - How to recover files encrypted by Yanlouwang.pdf"
    ],
    "report_names": [
        "2022-04-18 - How to recover files encrypted by Yanlouwang.pdf"
    ],
    "threat_actors": [
        {
            "id": "aa73cd6a-868c-4ae4-a5b2-7cb2c5ad1e9d",
            "created_at": "2022-10-25T16:07:24.139848Z",
            "updated_at": "2025-03-27T02:02:10.120505Z",
            "deleted_at": null,
            "main_name": "Safe",
            "aliases": [],
            "source_name": "ETDA:Safe",
            "tools": [
                "DebugView",
                "LZ77",
                "OpenDoc",
                "SafeDisk",
                "TypeConfig",
                "UPXShell",
                "UsbDoc",
                "UsbExe"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673536039,
    "ts_updated_at": 1743041369,
    "ts_creation_date": 1653678159,
    "ts_modification_date": 1653678159,
    "files": {
        "pdf": "https://archive.orkl.eu/62290e847492a65b87b1996bd9fc80d5b4b06043.pdf",
        "text": "https://archive.orkl.eu/62290e847492a65b87b1996bd9fc80d5b4b06043.txt",
        "img": "https://archive.orkl.eu/62290e847492a65b87b1996bd9fc80d5b4b06043.jpg"
    }
}