{
    "id": "a5bb1c12-36fe-42cb-9892-9643d983485c",
    "created_at": "2023-01-12T15:10:06.389286Z",
    "updated_at": "2025-03-27T02:05:24.520491Z",
    "deleted_at": null,
    "sha1_hash": "e63f3c728426bb930343205502c8eaf72a9f66ea",
    "title": "2022-05-25 - New Linux-Based Ransomware Cheerscrypt Targets ESXi Devices",
    "authors": "",
    "file_creation_date": "2022-06-01T12:23:10Z",
    "file_modification_date": "2022-06-01T12:23:10Z",
    "file_size": 635828,
    "plain_text": "# New Linux-Based Ransomware Cheerscrypt Targeting ESXi Devices Linked to Leaked Babuk Source Code\n\n**[trendmicro.com/en_us/research/22/e/new-linux-based-ransomware-cheerscrypt-targets-exsi-devices.html](https://www.trendmicro.com/en_us/research/22/e/new-linux-based-ransomware-cheerscrypt-targets-exsi-devices.html)**\n\nMay 25, 2022\n\n[We recently discovered that Cheerscrypt, the new Linux-based ransomware that we](http://www.trendmicro.com/vinfo/us/threat-encyclopedia/malware/Ransom.Linux.CHEERSCRYPT.A/)\ndetected in multiple attacks targeting ESXi servers, was based on the leaked Babuk source\ncode. Upon scrutiny, we found similarities between Cheerscrypt and the Linux version of the\nBabuk ransomware, specifically its ESXi version. The base code of Cheerscrypt appears to\nbe derived from the Babuk source code, but modified and customized to suit the malicious\nactor’s ransomware goals.\n\nThis blog entry discusses our findings and provides an overview of Cheerscrypt’s infection\nroutine based on the information we have gathered so far.\n\nBrief background\n\nOver the past few weeks, we observed several Linux-based ransomware detections that\n[malicious actors launched to target VMware ESXi servers, a bare-metal hypervisor for](https://www.vmware.com/products/esxi-and-esx.html)\ncreating and running several virtual machines (VMs) that share the same hard drive storage.\nWe encountered Cheerscrypt, a new ransomware family that has been targeting a\ncustomer’s EXSi server used to manage VMware files, during this period.\n\nIn the past, ESXi servers were also attacked by other known ransomware families such as\n[LockBit,](https://www.trendmicro.com/vinfo/us/security/news/ransomware-spotlight/ransomware-spotlight-lockbit) [Hive, and](https://www.trendmicro.com/vinfo/us/security/news/ransomware-spotlight/ransomware-spotlight-hive) [RansomEXX as an efficient way to infect many computers with](https://www.trendmicro.com/vinfo/us/security/news/ransomware-spotlight/ransomware-spotlight-ransomexx)\nransomware.\n\nThis blog entry provides an overview of Cheerscrypt’s infection routine based on the\ninformation we have gathered so far.\n\nInfection routine\n\nThe ransomware requires an input parameter specifying the path to encrypt so that it can\nproceed to its Infection routine.\n\nFigure 1.\n\nRansomware command line\n\n\n-----\n\nUpon execution, it implements the following command to terminate VM processes using\n[ESXCLI:](https://developer.vmware.com/web/tool/7.0/esxcli)\n\n_“esxcli vm process kill –type=force –world-id=$(esxcli vm process list|grep ‘World_\n_ID’|awk ‘{print $3}’)”_\n\nThe termination of the VM processes ensures that the ransomware can successfully encrypt\nVMware-related files. Similar to other infamous ransomware families, Cheerscrypt employs\nthe [double extortion scheme to coerce its victim to pay the ransom, as shown on their](https://www.trendmicro.com/vinfo/us/security/news/cybercrime-and-digital-threats/ransomware-double-extortion-and-beyond-revil-clop-and-conti)\nransom note in Figure 2.\n\nFigure 2.\n\nCheerscrypt’s ransom note\nSuccessfully encrypted files are renamed with the .Cheers extension. However, the\nransomware first renames the files it will encrypt before encrypting the files. Thus, if the\naccess permission for the file was not granted, it cannot proceed with the actual encryption.\n\n\n-----\n\nFigure 3. Cheerscrypt renames the\n\nsample before encryption.\nFor each directory it encrypts, it will drop the ransom note named, “How to Restore Your\nFiles.txt”. It seeks out log files and VMware-related files with the following extensions:\n\n    -   .log\n\n    -   .vmdk\n\n   -   .vmem\n\n    -   .vswp\n\n    -   .vmsn\n\nAfter successful encryption, it displays the following console that contains the data statistics\nof its routine:\n\n\n-----\n\nFigure 4.\n\nConsole displayed after encryption\nEncryption algorithm\n\nCheerscrypt’s executable file contains the public key of a matching key pair with the private\n[key being held by the malicious actor. The ransomware uses SOSEMANUK stream cipher to](https://www.ecrypt.eu.org/stream/e2-sosemanuk.html)\n[encrypt files and ECDH to generate the SOSEMANUK key. For each file to encrypt, it](https://en.wikipedia.org/wiki/Elliptic-curve_Diffie%E2%80%93Hellman)\ngenerates an ECDH public-private key pair on the machine through Linux’s /dev/urandom. It\nthen uses its embedded public key and the generated private key to create a secret key that\nwill be used as a SOSEMANUK key. After encrypting the file, it will append the generated\npublic key to it. Since the generated private key is not saved, one cannot use the embedded\npublic key with the generated private key to produce the secret key. Therefore, decryption is\nonly possible if the malicious actor’s private key is known. The infection chain is shown on\nFigure 5.\n\n\n-----\n\nFigure 5. Cheerscrypt’s encryption algorithm\nNew findings: Cheerscrypt linked to Babuk\n\nUnlike Cheerscrypt, Babuk’s malware version used to compromise ESXi servers ensured\nthat the files were encrypted before it renamed the target files. This goes to show that\n[despite the Babuk ransomware operator’s announcement of their retirement — after claiming](https://www.bleepingcomputer.com/news/security/babuk-ransomware-readies-shut-down-post-plans-to-open-source-malware/)\nthey already achieved their goals — their impact can still affect different organizations when\nother malicious actors build upon the source code they leaked. We provide Babuk’s source\ncode for the malware variant specific to ESXi servers in Figure 6. In Figure 7, we can see\nthat Cheerscrypt’s source code was based on Babuk’s source code that was leaked before.\n\n\n-----\n\nFigure 6. Babuk’s source code for the malware variant used to target ESXi servers\n\nFigure 7. Cheerscrypt’s source code with similarities to Babuk’s source code\nConclusion\n\nESXi is widely used in enterprise settings for server virtualization. It is therefore a popular\ntarget for ransomware attacks. As mentioned, compromising ESXi servers has been a\nscheme used by some notorious cybercriminal groups because it is a means to swiftly\n\n\n-----\n\nspread the ransomware to many devices. Organizations should thus expect malicious actors\nto upgrade their malware arsenal and breach as many systems and platforms as they can for\nmonetary gain.\n\nRecommendations\n\nA proactive stance that ensures solid cybersecurity defenses against modern ransomware\nthreats is crucial for organizations to thrive in an ever-changing threat landscape. To protect\nsystems against similar attacks, organizations can establish security frameworks that\nsystematically allocate resources based on an enterprise’s needs.\n\nOrganizations can benefit from following the security frameworks established by the Center\nof Internet Security and the [National Institute of Standards and Technology when developing](https://www.nist.gov/cyberframework)\ntheir own cybersecurity strategies. The frameworks they created help security teams to\nmitigate risks and minimize exposure to threats. Adopting the best practices discussed in\ntheir respective frameworks can save organizations the time and effort when they customize\ntheir own. Their frameworks guide organizations through the entire process of planning while\nproviding suggestions on measures that need to be established first.\n\nRansomware\n\nNew findings showed that Cheerscrypt, a new Linux-based ransomware variant that\ncompromises ESXi servers, was derived from the leaked Babuk source code. We discuss\nour analysis in this report.\n\nBy: Arianne Dela Cruz, Byron Gelera, McJustine De Guzman, Warren Sto.Tomas May 25,\n2022 Read time: ( words)\n\nContent added to Folio\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-05-25 - New Linux-Based Ransomware Cheerscrypt Targets ESXi Devices.pdf"
    ],
    "report_names": [
        "2022-05-25 - New Linux-Based Ransomware Cheerscrypt Targets ESXi Devices.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673536206,
    "ts_updated_at": 1743041124,
    "ts_creation_date": 1654086190,
    "ts_modification_date": 1654086190,
    "files": {
        "pdf": "https://archive.orkl.eu/e63f3c728426bb930343205502c8eaf72a9f66ea.pdf",
        "text": "https://archive.orkl.eu/e63f3c728426bb930343205502c8eaf72a9f66ea.txt",
        "img": "https://archive.orkl.eu/e63f3c728426bb930343205502c8eaf72a9f66ea.jpg"
    }
}