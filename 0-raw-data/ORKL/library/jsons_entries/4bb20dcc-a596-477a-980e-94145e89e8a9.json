{
    "id": "4bb20dcc-a596-477a-980e-94145e89e8a9",
    "created_at": "2024-12-10T02:05:37.819412Z",
    "updated_at": "2025-03-27T02:10:04.92705Z",
    "deleted_at": null,
    "sha1_hash": "6ad3180982e7042ac76b286b408ead73d77e2415",
    "title": "",
    "authors": "",
    "file_creation_date": "2024-09-27T13:58:39Z",
    "file_modification_date": "2024-09-27T13:58:40Z",
    "file_size": 1876130,
    "plain_text": "#### 2 - 4 October, 2024 / Dublin, Ireland\n\n# CRACKEDCANTIL: A MALWARE SYMPHONY DELIVERED BY CRACKED SOFTWARE; PERFORMED BY LOADERS, INFOSTEALERS, RANSOMWARE, ET AL.\n\n## Lena Yu\n\n### World Cyber Health, Japan\n\n#### lena.yu@worldcyberhealth.org\n\n www virusbulletin com\n\n\n-----\n\n**ABSTRACT**\n\nThe digital landscape teems with diverse malware families, each engineered with distinct capabilities – ranging from data\ntheft, deployment of additional malicious payloads, to destruction of data and more.\n\nYet, beneath their varied functionalities, these pieces of malware may unite in a complex and orchestrated performance,\nfunctioning in concert to unleash potent malware infections. This intricate interplay, which I have termed the ‘malware\nsymphony’, mirrors the harmonious collaboration of instruments in an orchestra, where each contributes its unique timbre\nto the overall composition.\n\nThis paper introduces the concept of the malware symphony by analysing the CrackedCantil campaign. It explores how\neach malware component contributes to a harmonious yet malicious concert designed to compromise and exploit systems\nwith unparalleled sophistication.\n\n**INTRODUCTION**\n\nMalware continues to evolve, becoming increasingly elusive, destructive, efficient and widespread [1]. There exists a vast\narray of malware families, each distinguished by its specific traits. These diverse malware families can collaborate\nseamlessly to orchestrate a potent infection.\n\nThis paper will explore a concept coined the ‘malware symphony’. It illustrates how various malware can collaborate, akin\nto instruments in an orchestra, thereby enhancing the overall impact of the infection.\n\nPreviously, infections involving multiple malware were typically referred to as ‘loader campaigns’. However, this term was\ngeneral and could include infections involving multiple malware but lacking coordination.\n\nThe inadequacy of existing terms to fully capture the orchestrated nature of these threats demonstrates the need for a new\ndefinition.\n\nBy introducing the unique concept of the malware symphony, this paper aims to enhance the classification and analysis of\ncomplex multi-malware infections.\n\n**DECOMPOSING THE MALWARE SYMPHONY**\n\nThere are numerous cases of multiple malware infections, but not all of them are coordinated and they can result in the\nconflicts shown in Table 1.\n\n**Conflict** **Description**\n\nRansomware encrypts This makes the infection obvious to the victim, who will then take measures to remediate the infection.\nfiles before other The system may go down, which means that other malware does not get a chance to perform.\nmalware can perform\n\nEven if infostealers successfully exfiltrate encrypted data, the attacker may not have the decryption\nkey, rendering the stolen data useless.\nSome resources may be inaccessible to other malware.\n\nMore than one Complicates the encryption/decryption process.\nransomware attempting Race conditions may occur if multiple ransomware attempt to encrypt the same files at the same time.\nto encrypt files\n\nSpikes in computational resource usage can alert the system.\n\nMalware attempt to kill Malware developed by competing parties may attempt to kill each other, as seen in the case of botnet\neach other malware Mirai [2].\n\nSome malware disguises itself as legitimate processes and antivirus programs, while other malware\nattempts to kill these, mistaking them for legitimate processes or antivirus programs [3].\n\nMalware competing Malware such as coinminers utilize a lot of computational resources, which can cause other malware\nfor resources and crucial system processes to slow down.\n\nOther interferences Malware blocking certain connections/resources which are required by other malware.\nMultiple malware attempting to access the same resources at the same time could lead to race\nconditions, errors, glitches and more.\n\n_Table 1: Examples of conflicts between multiple malware._\n\nCoordination is key in deciding whether to categorize a multi-malware infection as a malware symphony. Firstly, it should\nnot have any of the obvious conflicts shown in Table 1. Secondly, a typical malware symphony can be deconstructed into\n‘movements’ (akin to the movements of a symphony), as shown in Table 2.\n\nThe description, actions, and MITRE techniques typically observed in a malware symphony are also shown in Table 2.\nNote, however, that this classification is not absolute, and discrepancies may exist between different malware symphonies.\n\n|Conflict|Description|\n|---|---|\n|Ransomware encrypts files before other malware can perform|This makes the infection obvious to the victim, who will then take measures to remediate the infection. The system may go down, which means that other malware does not get a chance to perform. Even if infostealers successfully exfiltrate encrypted data, the attacker may not have the decryption key, rendering the stolen data useless. Some resources may be inaccessible to other malware.|\n|More than one ransomware attempting to encrypt files|Complicates the encryption/decryption process. Race conditions may occur if multiple ransomware attempt to encrypt the same files at the same time. Spikes in computational resource usage can alert the system.|\n|Malware attempt to kill each other|Malware developed by competing parties may attempt to kill each other, as seen in the case of botnet malware Mirai [2]. Some malware disguises itself as legitimate processes and antivirus programs, while other malware attempts to kill these, mistaking them for legitimate processes or antivirus programs [3].|\n|Malware competing for resources|Malware such as coinminers utilize a lot of computational resources, which can cause other malware and crucial system processes to slow down.|\n|Other interferences|Malware blocking certain connections/resources which are required by other malware. Multiple malware attempting to access the same resources at the same time could lead to race conditions, errors, glitches and more.|\n\n\n-----\n\nFor this paper, any malware that is not a loader, infostealer, or ransomware will be referred to as ‘otherware’. Additionally,\nsome malware can fall under multiple categories – for example, Amadey can act both as a loader and as an infostealer. For\nsimplicity, we assume each malware falls into one category.\n\n**Order** **Symphony** **General description** **Action** **Common MITRE techniques**\n**movement**\n\nOverture of Starts and coordinates System checks before T1518: Software Discovery\nthe Loaders the malware starting the malware\n\nT1082: System Information Discovery\n\nsymphony symphony\n\nT1012: Query Registry\n\nT1497: Virtualization/Sandbox Evasion\n\nT1016: System Network Configuration Discovery\n\nCommunicate with T1071: Application Layer Protocol\nC2\n\nT1571: Non-Standard Port\n\nMake C2 traffic hard T1132: Data Encoding\nto analyse\n\nT1573: Encrypted Channel\n\nEnsure smooth entry T1562: Impair Defenses\nof other malware\n\nT1588: Obtain Capabilities\n\nTime the execution of T1547: Boot or Logon Autostart Execution\nother malware\n\nT1053: Scheduled Task/Job\n\nT1569: System Services\n\nEnsemble of A variety of Communicate with T1071: Application Layer Protocol\nthe infostealers can be C2\n\nT1571: Non-Standard Port\n\nInfostealers involved, with a\n\nMake C2 traffic hard T1132: Data Encoding\n\ndiverse range of\n\nto analyse\n\nstolen data and T1573: Encrypted Channel\nexfiltration techniques Check environment T1518: Software Discovery\n\nvalues\n\nT1012: Query Registry\n\nT1082: System Information Discovery\n\nAllow easy re-entry T1547: Boot or Logon Autostart Execution\nof itself\n\nT1053: Scheduled Task/Job\n\nCollect the data T1552: Unsecured Credentials\n\nT1555: Credentials from Password Stores\n\nT1115: Clipboard Data\n\nT1113: Screen Capture\n\nExfiltrate the data T1567: Exfiltration Over Web Service\n\nT1041: Exfiltration Over C2 Channel\n\nT1048: Exfiltration Over Alternative Protocol\n\nChorale of Any malware that Communicate with T1071: Application Layer Protocol\nthe doesn’t fall into the C2\n\nT1571: Non-Standard Port\n\n‘Otherware’ category of a loader,\n\nHijack resources T1496: Resource Hijacking\n\ninfostealer,\nransomware –\ntypically, malware\nthat hijacks device\nresources\n\nFinale of the Encryption activities Give other malware T1547: Boot or Logon Autostart Execution\nRansomware happen last, and solo, time to perform\n\nT1053: Scheduled Task/Job\n\nto prevent double\n\nPrevent double T1057: Process Discovery\n\nencryption\n\nencryption\n\nT1083: File and Directory Discovery\n\nEncrypt the files T1486: Data Encrypted for Impact\n\n_Table 2: The typical composition of a malware symphony._\n\n|Order|Symphony movement|General description|Action|Common MITRE techniques|\n|---|---|---|---|---|\n|1|Overture of the Loaders|Starts and coordinates the malware symphony|System checks before starting the malware symphony|T1518: Software Discovery|\n|||||T1082: System Information Discovery|\n|||||T1012: Query Registry|\n|||||T1497: Virtualization/Sandbox Evasion|\n|||||T1016: System Network Configuration Discovery|\n||||Communicate with C2|T1071: Application Layer Protocol|\n|||||T1571: Non-Standard Port|\n||||Make C2 traffic hard to analyse|T1132: Data Encoding|\n|||||T1573: Encrypted Channel|\n||||Ensure smooth entry of other malware|T1562: Impair Defenses|\n|||||T1588: Obtain Capabilities|\n||||Time the execution of other malware|T1547: Boot or Logon Autostart Execution|\n|||||T1053: Scheduled Task/Job|\n|||||T1569: System Services|\n|2|Ensemble of the Infostealers|A variety of infostealers can be involved, with a diverse range of stolen data and exfiltration techniques|Communicate with C2|T1071: Application Layer Protocol|\n|||||T1571: Non-Standard Port|\n||||Make C2 traffic hard to analyse|T1132: Data Encoding|\n|||||T1573: Encrypted Channel|\n||||Check environment values|T1518: Software Discovery|\n|||||T1012: Query Registry|\n|||||T1082: System Information Discovery|\n||||Allow easy re-entry of itself|T1547: Boot or Logon Autostart Execution|\n|||||T1053: Scheduled Task/Job|\n||||Collect the data|T1552: Unsecured Credentials|\n|||||T1555: Credentials from Password Stores|\n|||||T1115: Clipboard Data|\n|||||T1113: Screen Capture|\n||||Exfiltrate the data|T1567: Exfiltration Over Web Service|\n|||||T1041: Exfiltration Over C2 Channel|\n|||||T1048: Exfiltration Over Alternative Protocol|\n|2|Chorale of the ‘Otherware’|Any malware that doesn’t fall into the category of a loader, infostealer, ransomware – typically, malware that hijacks device resources|Communicate with C2|T1071: Application Layer Protocol|\n|||||T1571: Non-Standard Port|\n||||Hijack resources|T1496: Resource Hijacking|\n|3|Finale of the Ransomware|Encryption activities happen last, and solo, to prevent double encryption|Give other malware time to perform|T1547: Boot or Logon Autostart Execution|\n|||||T1053: Scheduled Task/Job|\n||||Prevent double encryption|T1057: Process Discovery|\n|||||T1083: File and Directory Discovery|\n||||Encrypt the files|T1486: Data Encrypted for Impact|\n\n\n-----\n\nA prime exemplar of such orchestrated cyber malevolence is CrackedCantil – a malware symphony that originates from\ncracked software hosted on reputable platforms like Google Groups. The CrackedCantil campaign stands out for its\ncollaborative use of numerous distinct families of malware.\n\n‘CrackedCantil’ is a moniker derived from the symphony’s roots in cracked software and its analogy to the venomous\nCantil viper [4]. A malware symphony that originates from cracked software, and is orchestrated by PrivateLoader will be\nreferred to as the CrackedCantil symphony.\n\nFor ease of classification, the naming convention ‘Symphony no. <ID>, <Name of malware symphony>’ will be used for\nmalware symphonies, where <ID> represents the unique number identifying the specific case of the campaign, and\n_<Name of malware symphony> denotes its name._\n\nThis naming convention was introduced to uniquely identify specific cases of the malware symphony. Each symphony\nmay be subtly different, even if it belongs to the same campaign and shares a similar overall composition, as shown in\nTable 3. The malware in Table 3 only includes infamous malware – there may be other malware not listed that are also\ninvolved.\n\n**Title** **Category** **Malware**\n\n_Symphony No. 1, CrackedCantil_ Loaders PrivateLoader\n\n[5]\n\nSmoke\n\nInfostealers Lumma\n\nRedLine\n\nRisePro\n\nAmadey\n\nStealc\n\nOtherware Socks5Systemz\n\nCoinminers\n\nRansomware STOP\n\n_Symphony No. 2,_ Loaders PrivateLoader\n_CrackedCantil [6]_\n\nSmoke\n\nGlupteba\n\nInfostealers Lumma\n\nStealc\n\nRisepro\n\nRedline\n\nOtherware XMRig\n\nRansomware STOP\n\n_Symphony No. 3,_ Loaders PrivateLoader\n_CrackedCantil [7]_\n\nInfostealers Lumma\n\nRedline\n\nAmadey\n\nRisePro\n\nStealc\n\nOtherware Kelihos\n\nSocks5Systemz\n\nCoinminers\n\nRansomware STOP\n\n_Table 3: The various CrackedCantil symphonies._\n\nThe malware symphony examined in this paper will be Symphony No. 1, CrackedCantil. The sandbox environment utilized\nin the analysis is shown in Table 4.\n\n|Title|Category|Malware|\n|---|---|---|\n|Symphony No. 1, CrackedCantil [5]|Loaders|PrivateLoader|\n|||Smoke|\n||Infostealers|Lumma|\n|||RedLine|\n|||RisePro|\n|||Amadey|\n|||Stealc|\n||Otherware|Socks5Systemz|\n|||Coinminers|\n||Ransomware|STOP|\n|Symphony No. 2, CrackedCantil [6]|Loaders|PrivateLoader|\n|||Smoke|\n|||Glupteba|\n||Infostealers|Lumma|\n|||Stealc|\n|||Risepro|\n|||Redline|\n||Otherware|XMRig|\n||Ransomware|STOP|\n|Symphony No. 3, CrackedCantil [7]|Loaders|PrivateLoader|\n||Infostealers|Lumma|\n|||Redline|\n|||Amadey|\n|||RisePro|\n|||Stealc|\n||Otherware|Kelihos|\n|||Socks5Systemz|\n|||Coinminers|\n||Ransomware|STOP|\n\n\n-----\n\n|Sandbox service|ANY.RUN|\n|---|---|\n|Operating system|Windows 11|\n|Device name|DESKTOP-BFTPUHP|\n|User|admin|\n|MAC address|52:54:00:4a:ad:11|\n|Screen resolution|1280x720|\n|Language|en-US|\n|Residential proxy IP|174.161.239.28|\n|Residential proxy location|United States|\n\n\n_Table 4: Sandbox environment used for the analysis of Symphony No. 1, CrackedCantil._\n\n**STAGING THE MALWARE SYMPHONY**\n\nThere are various ways a malware symphony can be staged. One of the most popular methods for delivery is through\ncracked software, as this is the primary vector of infection for loaders like PrivateLoader.\n\nThe usage and distribution of cracked software is illegal in many places as it falls under software piracy laws [8]. However,\nmany are still willing to take the risk to save money despite the possible legal repercussions and malware infections.\nAttackers take advantage of the fact that victims are not legally protected, and are less likely to seek help when infected due\nto having willingly downloaded cracked software.\n\nIn addition, specific versions of cracked software can be used to distribute malware that is compatible with the system. For\nexample, someone that searches for and downloads a ‘Cracked Photoshop for Windows 10’ would likely be using\n_Windows 10 for the OS, thus the attacker would embed malware targeted at Windows 10 within this version of cracked_\nsoftware. This eliminates the need for browser User-Agent checks to redirect the victim to a compatible version download,\nwhich greatly increases the range of platforms on which this cracked software can be hosted.\n\nTake for instance the Roaming Mantis smishing campaign. When the victim clicks on the malicious link in the instant\nmessage, they are redirected to an attacker-hosted site that performs User-Agent checks. If the site identifies the\nUser‑Agent as an Android device, it downloads an APK that is Android malware disguised as a legitimate application. If\nidentified as an iOS device, it redirects the victim to an iCloud phishing site. To perform these User-Agent checks, the site\nmust be hosted by the attacker due to custom scripts [9].\n\nKnowing the operating system and architecture of the victim device significantly increases the success rate of the malware\nsymphony. Loaders can drop malware that is suitable for the victim’s environment, but the loaders themselves are usually\nconstrained by the underlying operating system and architecture.\n\n**Staged on Google Groups**\n\nThe CrackedCantil campaign was rampant between the end of 2023 and the start of 2024. Searching for cracked versions of paid\npopular software (e.g. ‘IDA PRO Crack Download’, ‘Photoshop Free Download’) on search engines during this period would\nlikely have shown a Google Groups result with the cracked software as one of the top search results, as shown in Figure 1.\n\n_Figure 1: Google Search results for ‘ida pro crack download’ in December 2023._\n\n\n-----\n\nOnce the victim visits the Google Groups result, they are greeted with a shortened download link inside a Google Groups\nconversation, as shown in Figure 2.\n\n_Figure 2: Google Groups conversation with the shortened link._\n\nThe names of the archive files downloaded from the shortened links included ‘release.rar’ and ‘release_vX.rar’, with ‘X’\ndenoting the version number. These password-protected archives typically ranged from 7 to 9 MB, and the password was\ndisplayed on the download page, as shown in Figure 3.\n\n_Figure 3: The download site with the password._\n\n**Delivered by cracked software**\n\nIn Symphony No. 1, CrackedCantil, the executable was inside a password-protected archive, where the password was\nshown on the download page [4]. The executable was revealed to be massive, at 750 MB, which hinders analysis, as some\nantivirus programs cannot scan password-protected and very large files. Additionally, analysis will be more tedious if the\nanalyst does not have the password to the sample, and online malware analysis services like VirusTotal have an upload limit\nof 650 MB [10].\n\nTo deter reverse engineering, the executable is protected by both Themida/Winlicense(3.XX) and VMprotect. The\nexecutable disguises itself as a ‘Logitech Plugin Installer Utility’. This same file name and description were seen across\nvarious CrackedCantil campaigns on Google Groups, regardless of the cracked software it purported to be. This suggests\nthe executable was recycled across various campaigns, as it contained nothing specific to the cracked software.\n\nUpon removing the layers of protectors with available tools [11], the payload was revealed to be only 18 MB, as shown in\nFigure 4.\n\n\n-----\n\n_Figure 4: Packed CrackedCantil executable on the left; unpacked CrackedCantil executable on the right._\n\nThe core of the CrackedCantil symphony lies in the PrivateLoader malware, which will be explored in detail in the\nfollowing sections.\n\n**THE OVERTURE OF THE LOADERS**\n\nThe malware symphony starts with the Overture of the Loaders. The loaders are like the maestros of a symphony, who are\nresponsible for cueing the start, setting the tempo, and preparing the smooth entry of other performers.\n\nThese loaders typically depend heavily on communication with the C2, so before the symphony starts, they will perform a\ncommunication check with the C2 to ensure it can be reached. If it cannot be reached, the malware symphony usually ends\nabruptly.\n\nOnce the loader confirms the connection with the C2, it prepares a malware symphony tailor-made for the victim’s environment\nby collecting environment information and sending it to the C2, which then responds with suitable malware payloads.\n\nThe loaders are responsible for coordinating the entire symphony and ensuring the collaborative harmony among the\nvarious malware – making sure there are no obvious conflicts such as those shown in Table 1.\n\nIn the case of the CrackedCantil symphony, PrivateLoader serves as the primary maestro, spawning Smoke Loader which\nthen serves as the secondary maestro.\n\nIt is important to note that, in most cases, the malware spawned from the loaders are not aware of the presence of other\nmalware. This means the loader is responsible for orchestrating the symphony in a way that ensures the malware do not\nconflict with one another.\n\n**PrivateLoader**\n\nPrivateLoader, serving as the primary maestro of the CrackedCantil symphony, is central to this analysis and will be\nexamined in detail.\n\nIn Symphony No. 1, CrackedCantil, PrivateLoader begins by checking the system environment (T1082: System\nInformation Discovery and T1012: Query Registry) to ensure it is suitable for the ensuing malware symphony.\n\nIt then cues the start of the symphony by sending an HTTP GET request to the C2, in this case with the URI ‘/api/tracemap.php’\n(T1071: Application Layer Protocol). If the C2 replies with a specific string – in this case ‘15.5pnp.10.lock’ – it cues the start\nof the symphony; if there is no response, then PrivateLoader crashes, ending the symphony abruptly.\n\nAs mentioned previously, loaders – particularly PrivateLoader – are heavily dependent on communication with the C2 for\nreceiving commands, downloading additional malware, and more. Thus, it performs this initial connectivity check with the\nC2 to ensure everything is good to go.\n\nAt the time of writing this paper, the C2 for PrivateLoader in Symphony No. 1, CrackedCantil had stopped responding.\nUsing FakeNet in the ANY.RUN sandbox, a custom HTTP response, ‘15.5pnp.10.lock’, was implanted to simulate the real\nC2 response. Upon implanting this fake HTTP response, PrivateLoader was observed to continue execution [12].\n\nIt then performs IP checks with various online services such as api.myip[.]com and ipinfo[.]io. FakeNet was configured to\nrespond with a custom response only to HTTP requests for the URI ‘/api/tracemap.php’, while allowing all other requests\nto reach the real internet.\n\nPrivateLoader then arranges the entry of other malware. It prepares a Base64-encoded encrypted string (T1132: Data\nEncoding and T1573: Encrypted Channel), and sends HTTP POST requests to the C2, in this case with the URI\n‘/api/firegate.php’.\n\n\n-----\n\nThrough reverse engineering, the decoding and decryption algorithm for the HTTP request/response was obtained, and the\nPython script can be found at [13].\n\nThe encoded-encrypted HTTP request/response, and its decoded-decrypted counterpart observed in Symphony No. 1,\n_CrackedCantil can be seen in Table 5._\n\n**Encoded-encrypted** **Decoded-decrypted**\n```\n Q0uWGgHyOK1yWQK-BXHkM-HySJVrM-bkDRjaZRMVle11OCvYaPf2Wz\n GetExtensions|USA_2|US|16\n R9nGuLpCPzAv8ibLyhynT0DqT5CPejzN_j4vkuL4Rmafqdqg7q29RNz\n\n n9VOTArbMt6Jrq5lsZ3\n [FaU4dkFGmFsWKWHjsIyHND/UQ4teC8N/iQvaDo7KdzhN7A+UPiuqSmR\n] []\n ylwEY4xK8esn2u4T6CpBh383VqxiDRRD+bfa76QQLfTJpwLFlS0A=\n 2nz0hsO9K7vKyuyl6qoOl_sXwxXEb9wuclyy-ls5CzmbHEQUW2WHIvG\n GetLinks|USA_2|US|16\n 9MpPOFBnZnyJoLVAtEzHhAskeKO0zSvR_r5qNNZLcYZ4xP0XllMrOno\n\n KZhvdXZdNamZiesubb\n [Letw5AloRfH5EJy3QRIcouZs/qYLXwRoR4PZbQFQhN2Nd8yTbZcYD\n] [{\"id\":\"-1\",\"url\":\"https:\\/\\/vk.com\\/do\n\n GzOtHApGfTFR1Tv9sqJLktOf6fjaLz85hacrC9ogc+Cj5cGTClMhi\n c418490229_669446210?hash=BZ9b8Xtsn5Z8z\n\n SmZqsjYIZG24MpA5tO26+5SmY55Yq81lYUTmH6s7JYdFYF9r0fRrP\n ZkSRBEdwF1W7jzCAT8GJBVEicdXS6L&dl=eA4o7\n\n K7LLclJH9gK5CAkCdb3CPA1lbYS+8na5lwwxIycamdM2IRNvXPZ2+\n 5IiHafzbkgdBC8nz7TmLS7uMpwJRsfDOcAnrqD&\n\n DzkgiG39ur9gScryB85Y2BHjrxVGUGWkjrP18sb3THXaZdBZ9dug3\n api=1&no_preview=1\",\"args\":\"\",\"type\":\"0\n\n a1+9kgKbWL/2SzTQ6GlhTNpHLZ5ZS+Fe/j+nYdFylDWjNjgG4TFLq\n \",\"onlyType\":\"0\"},{\"id\":\"999991\",\"url\":\n\n oGYYMhNT5Aby4X+IzYQWmJGDkP03ThlWoExZ0Pcx0PibBiDwp0o9+\n \"https:\\/\\/vk.com\\/doc418490229_6692842\n\n 2yTRNv/KiWGDnIXbNZOxaVn+S3b/HXZFu2pqSw3ca6lRoCOhMOjJw\n 01?hash=L30vXtgODLl0q95FGyET2USzk3BDrjd\n\n NUKjUwdMUFCTP3clECdsaL2ZAyu9f0U7p8cT/bWMrH+evubWOBo3j\n BJTVTGfOpzh0&dl=EQ8M3oRxNmutE6bZaUWfsWZ\n\n SG/YWLHwW4My70+O9xU0rxQz39GQbaCJixql1+2Kb2Y6HGWJiQ+gA\n 4f89z2Hkav8gaMIZSAzo&api=1&no_preview=1\n\n tpMnVocYIo8l93HNvhkjl0cKrBc6CCXVYEA8eBiFBDSx8FaQkbs4x\n \",\"args\":\"\",\"type\":\"0\",\"onlyType\":\"0\"},\n\n /dSyp+QTCSJ9h4bpEmTp2KmSNScaL+oStiNWYxUrcz+nN3H6d0P7n\n {\"id\":\"999998\",\"url\":\"https:\\/\\/vk.com\\\n\n LSEI8evXb0L5r/6ieVzv2hp/rpKLFpwh7SHIcH7HN57lpZBJkDXBs\n /doc418490229_669431693?hash=ZJOgiMvcEt\n\n mz2sr8Y4jGNy3X8R3YfYeqGhfd1pBtqt5AeFQtJvqCsiWoiaQ1yFl\n 67O8ZgIQTPetDJ5TJVWChVj8OP8l7poMo&dl=l8\n\n oiQjtantrbTdWtYiNu3CUXSxTAUYJ8HFSFGeYAtWsSIEBteTKVB+9\n kZtnWtBZ88utyX5ok8hBf0AvLsgVspFPCyrexPZ\n\n JzgN0tP8jZnFjdcE5CfejOJOguJSO/Jd1RdpHYP/mOvq+AzS6XXyg\n cc&api=1&no_preview=1\",\"args\":\"\",\"type\"\n\n bA/n5GdqjnjDCOH2eULJl9dZLH1FRO8EDl3h3l2wg6YR1onoKfubq\n :\"0\",\"onlyType\":\"0\"},\n Rb+RKf+a3nSe5QMG2CiaQ/HY+SLK8V5dJiHiJqjAeE8beQGWuu7DWa\n\n                                   …\n +\n … +DofUcxy80YGDAKU3FQcYTJhrcYqjY5xo2773JPIGRPk6OODSKy\n {\"id\":\"5671\",\"url\":\"https:\\/\\/bitbucket\n\n NeLi7lxLOYn9XQ4VvZZKKawoAjSzYUFGSQpdA1z4IKD27C2AIAhq5\n .org\\/efrerf\\/meta\\/downloads\\/setupret\n\n 4gFwcFvI9jIAjJ+YIRo4etoV033rDgbV6e7bxZvn8WKdX0H+pDgA80\n ail.exe\",\"args\":\"\",\"type\":\"0\",\"onlyType\n\n YjvG8Q+QVo3e4R8HnPKj2coA3M28MWu3lC7sdtUj2zxjjhzfSSjqp/\n \":\"0\"},{\"id\":\"5672\",\"url\":\"https:\\/\\/vk\n\n o1ROSjfIetFlL9aMLCFArUYTSL+fKRAZWF39sr4hQFOv+4pFDdT8EU\n .com\\/doc418490229_669454392?hash=cjY7W\n\n 5uXaZzAz5tuxTRhpUgynYhOixgnYI2fItnUkc2+XNukMlPR8Ov1KHw\n rVCVATkkOn8XvhQrSwEfwcKH5GM0hZ5pRABRGz&\n\n arUJ+ASgycyzFr6rlwNl5gQsYVpMETJkBgAIRoBBBoE2ifkIgJExj\n dl=tGmEOO19EOQb0ZyZShtZXNIkckylcbE61eyM\n\n JiLR5AxOQ5kJsQlTcqQOOjTCFhobSIjnPWszFpwrCHAlz9EBc5p2d7\n sv920vk&api=1&no_preview=1#instr\",\"args\n\n DobI0ep8rIUcrrfHG3B2FYbbqoK9hbuv17UN11pAP+gONuMgGn57Oz\n \":\"\",\"type\":\"0\",\"onlyType\":\"0\"},{\"id\":\"\n\n SI3QrcqHpRMtKhe9hZPW/W40eiye1d2WPFXk67nkPdJ5J3FwJYzKYv\n 5674\",\"url\":\"https:\\/\\/vk.com\\/doc41849\n\n ne6LFJ7a6OagYWQ6flO0sK7lT+zeRnl6czQHTC98G45iV2Qobz8nN0\n 0229_669536405?hash=R1SzeC40xJ3N84YoN0i\n\n /uiVPeWtIZfrcJqaDlKjWWhzONRPg6ZkhFObT7a9ssiQV596A5AB4\n Xk4AQPRuvygwN5sp4tBfbczD&dl=GXT1bZGxOK1\n\n PSzuWOEqbWmLe7wUX6ueXrKi2T4ZunJMHmJMx1ykUjsNvEy+Mxd9PV\n 9LH7eZCNhRVIcrGJyQCrsbbajDN7XKHk&api=1&\n\n 5WVhWiTFgKj9TL2opFtNO4mec96/uytgR25Rc8ZAYH4TOWd/e6LLrj\n no_preview=1#nsd\",\"args\":\"\",\"type\":\"0\",\n\n OiDJrKQgJch9z+LWiYzuZh+OGjZ6VsspDeqMiapm87E2YbYIw4QdaI\n \"onlyType\":\"0\"},{\"id\":\"5677\",\"url\":\"htt\n\n P6+/zfw9/5JHPKGdHZjQiVJfLpzgeS2EgYy+qzwyg7ggUkhEcBVSUn\n p:\\/\\/zen.topteamlife.com\\/order\\/adobe\n\n D/oYcNKqDTaCpOeCWRpHnG36A6iGPaACxo1FJtDCq3UDjOQCob8Rfv\n .exe\",\"args\":\"\",\"type\":\"0\",\"onlyType\":\"\n\n nPaddscTqz/AU4RhDuD3uL4ATHkt3/QbPXzTpvkPCidXXHpTtzMKCT\n 0\"},{\"id\":\"5678\",\"url\":\"https:\\/\\/vk.co\n\n qy6L84Wv2c6F6YpU0o+NlR2mQJo5ce32HoPmd6dOzfFh5SsGIKvUwT\n m\\/doc418490229_669529247?hash=ZyLx4sBT\n\n x+bHccnb/GY9ffh25MVSR+DHeEbSE2ir8afwrpC7uj23GeTWLMB0O3\n xK2fZKGXJvBsozM6zZnlq3d4zGFA9Xe2gXH&dl=\n\n cx4z+pQJ0GkvQywYZE2fs6lFsUp45n8vBdXgCezOliLAGcmb7rSjJV\n Pm3AuNch3C2mzXhO55Ac5it4us9SOICgix6EpKM\n\n pmukOULqKsUpQ5z0wfzw08rzY0405Lif3KQ+nWbvCMO0UXxV7cCHhE\n Ntp0&api=1&no_preview=1#tw\",\"args\":\"\",\"\n\n +KvCuNpSriYemBqy3MqMnkYnsWrPoW6kpg/rJdA5fb4exCzyyDSHs0\n type\":\"0\",\"onlyType\":\"0\"},{\"id\":\"5679\",\n\n mdMca3tDAVMOHk8d42GdQRzd+8AT6VwQArKDQ4GIqudTQgVVqJdj+c\n \"url\":\"http:\\/\\/176.113.115.84:8080\\/4.\n\n vM/4g7R1LfCBxf03cXhNf2K/MnVZ1d1l/Uv1nZOzQBe49996KmAWpN\n php\",\"args\":\"\",\"type\":\"0\",\"onlyType\":\n\n viEEKl4p2rHIbBRT/B6QoVmreGwqzbQ50OW8+TGOQjb+4BcMR0Jm0H\n \"0\"}]\n hGfl+ur2gaCbDSipD8EotGJPPVvQ7J+IR2W/h2IrLz9kPmHsAGmryH\n\n IFHRG2ENf9GSoUbryBdvPZgiRWoq8s6ypNEH7LgpMRynTatQQ8lxTl\n\n cRvV8ayO36Y16m8dA2bggmaPg7RMJIXCZmhLIie1YbziAaCFwsMDI1\n\n j0krLYo4wbr0LKBK74K41EWGtdxdxIWuU+IQAnhRR6G+Q94yY2d8iA\n\n 05Po9nMinaDTTrQIoGIq5jhSUteXzaP29RBu1Es2suL+KOLyHxpp9i\n\n 1S70zpbhuUEjE0elPCIMmcZqCx7AKVMP9fFVPmnOaMpbREwV/8rW9Q\n\n tRdNL2mCMmFqxL2EWmpJuwYS6cgWfcSY=\n\n```\n_Table 5: Encoded-encrypted and decoded-decrypted HTTP requests/responses of the primary PrivateLoader (truncated)._\n\n|Col1|Encoded-encrypted|Decoded-decrypted|\n|---|---|---|\n|Request|Q0uWGgHyOK1yWQK-BXHkM-HySJVrM-bkDRjaZRMVle11OCvYaPf2Wz R9nGuLpCPzAv8ibLyhynT0DqT5CPejzN_j4vkuL4Rmafqdqg7q29RNz n9VOTArbMt6Jrq5lsZ3|GetExtensions|USA_2|US|16|\n|Response|FaU4dkFGmFsWKWHjsIyHND/UQ4teC8N/iQvaDo7KdzhN7A+UPiuqSmR ylwEY4xK8esn2u4T6CpBh383VqxiDRRD+bfa76QQLfTJpwLFlS0A=|[]|\n|Request|2nz0hsO9K7vKyuyl6qoOl_sXwxXEb9wuclyy-ls5CzmbHEQUW2WHIvG 9MpPOFBnZnyJoLVAtEzHhAskeKO0zSvR_r5qNNZLcYZ4xP0XllMrOno KZhvdXZdNamZiesubb|GetLinks|USA_2|US|16|\n|Response|Letw5AloRfH5EJy3QRIcouZs/qYLXwRoR4PZbQFQhN2Nd8yTbZcYD GzOtHApGfTFR1Tv9sqJLktOf6fjaLz85hacrC9ogc+Cj5cGTClMhi SmZqsjYIZG24MpA5tO26+5SmY55Yq81lYUTmH6s7JYdFYF9r0fRrP K7LLclJH9gK5CAkCdb3CPA1lbYS+8na5lwwxIycamdM2IRNvXPZ2+ DzkgiG39ur9gScryB85Y2BHjrxVGUGWkjrP18sb3THXaZdBZ9dug3 a1+9kgKbWL/2SzTQ6GlhTNpHLZ5ZS+Fe/j+nYdFylDWjNjgG4TFLq oGYYMhNT5Aby4X+IzYQWmJGDkP03ThlWoExZ0Pcx0PibBiDwp0o9+ 2yTRNv/KiWGDnIXbNZOxaVn+S3b/HXZFu2pqSw3ca6lRoCOhMOjJw NUKjUwdMUFCTP3clECdsaL2ZAyu9f0U7p8cT/bWMrH+evubWOBo3j SG/YWLHwW4My70+O9xU0rxQz39GQbaCJixql1+2Kb2Y6HGWJiQ+gA tpMnVocYIo8l93HNvhkjl0cKrBc6CCXVYEA8eBiFBDSx8FaQkbs4x /dSyp+QTCSJ9h4bpEmTp2KmSNScaL+oStiNWYxUrcz+nN3H6d0P7n LSEI8evXb0L5r/6ieVzv2hp/rpKLFpwh7SHIcH7HN57lpZBJkDXBs mz2sr8Y4jGNy3X8R3YfYeqGhfd1pBtqt5AeFQtJvqCsiWoiaQ1yFl oiQjtantrbTdWtYiNu3CUXSxTAUYJ8HFSFGeYAtWsSIEBteTKVB+9 JzgN0tP8jZnFjdcE5CfejOJOguJSO/Jd1RdpHYP/mOvq+AzS6XXyg bA/n5GdqjnjDCOH2eULJl9dZLH1FRO8EDl3h3l2wg6YR1onoKfubq Rb+RKf+a3nSe5QMG2CiaQ/HY+SLK8V5dJiHiJqjAeE8beQGWuu7DWa + … +DofUcxy80YGDAKU3FQcYTJhrcYqjY5xo2773JPIGRPk6OODSKy NeLi7lxLOYn9XQ4VvZZKKawoAjSzYUFGSQpdA1z4IKD27C2AIAhq5 4gFwcFvI9jIAjJ+YIRo4etoV033rDgbV6e7bxZvn8WKdX0H+pDgA80 YjvG8Q+QVo3e4R8HnPKj2coA3M28MWu3lC7sdtUj2zxjjhzfSSjqp/ o1ROSjfIetFlL9aMLCFArUYTSL+fKRAZWF39sr4hQFOv+4pFDdT8EU 5uXaZzAz5tuxTRhpUgynYhOixgnYI2fItnUkc2+XNukMlPR8Ov1KHw arUJ+ASgycyzFr6rlwNl5gQsYVpMETJkBgAIRoBBBoE2ifkIgJExj JiLR5AxOQ5kJsQlTcqQOOjTCFhobSIjnPWszFpwrCHAlz9EBc5p2d7 DobI0ep8rIUcrrfHG3B2FYbbqoK9hbuv17UN11pAP+gONuMgGn57Oz SI3QrcqHpRMtKhe9hZPW/W40eiye1d2WPFXk67nkPdJ5J3FwJYzKYv ne6LFJ7a6OagYWQ6flO0sK7lT+zeRnl6czQHTC98G45iV2Qobz8nN0 /uiVPeWtIZfrcJqaDlKjWWhzONRPg6ZkhFObT7a9ssiQV596A5AB4 PSzuWOEqbWmLe7wUX6ueXrKi2T4ZunJMHmJMx1ykUjsNvEy+Mxd9PV 5WVhWiTFgKj9TL2opFtNO4mec96/uytgR25Rc8ZAYH4TOWd/e6LLrj OiDJrKQgJch9z+LWiYzuZh+OGjZ6VsspDeqMiapm87E2YbYIw4QdaI P6+/zfw9/5JHPKGdHZjQiVJfLpzgeS2EgYy+qzwyg7ggUkhEcBVSUn D/oYcNKqDTaCpOeCWRpHnG36A6iGPaACxo1FJtDCq3UDjOQCob8Rfv nPaddscTqz/AU4RhDuD3uL4ATHkt3/QbPXzTpvkPCidXXHpTtzMKCT qy6L84Wv2c6F6YpU0o+NlR2mQJo5ce32HoPmd6dOzfFh5SsGIKvUwT x+bHccnb/GY9ffh25MVSR+DHeEbSE2ir8afwrpC7uj23GeTWLMB0O3 cx4z+pQJ0GkvQywYZE2fs6lFsUp45n8vBdXgCezOliLAGcmb7rSjJV pmukOULqKsUpQ5z0wfzw08rzY0405Lif3KQ+nWbvCMO0UXxV7cCHhE +KvCuNpSriYemBqy3MqMnkYnsWrPoW6kpg/rJdA5fb4exCzyyDSHs0 mdMca3tDAVMOHk8d42GdQRzd+8AT6VwQArKDQ4GIqudTQgVVqJdj+c vM/4g7R1LfCBxf03cXhNf2K/MnVZ1d1l/Uv1nZOzQBe49996KmAWpN viEEKl4p2rHIbBRT/B6QoVmreGwqzbQ50OW8+TGOQjb+4BcMR0Jm0H hGfl+ur2gaCbDSipD8EotGJPPVvQ7J+IR2W/h2IrLz9kPmHsAGmryH IFHRG2ENf9GSoUbryBdvPZgiRWoq8s6ypNEH7LgpMRynTatQQ8lxTl cRvV8ayO36Y16m8dA2bggmaPg7RMJIXCZmhLIie1YbziAaCFwsMDI1 j0krLYo4wbr0LKBK74K41EWGtdxdxIWuU+IQAnhRR6G+Q94yY2d8iA 05Po9nMinaDTTrQIoGIq5jhSUteXzaP29RBu1Es2suL+KOLyHxpp9i 1S70zpbhuUEjE0elPCIMmcZqCx7AKVMP9fFVPmnOaMpbREwV/8rW9Q tRdNL2mCMmFqxL2EWmpJuwYS6cgWfcSY=|[{\"id\":\"-1\",\"url\":\"https:\\/\\/vk.com\\/do c418490229_669446210?hash=BZ9b8Xtsn5Z8z ZkSRBEdwF1W7jzCAT8GJBVEicdXS6L&dl=eA4o7 5IiHafzbkgdBC8nz7TmLS7uMpwJRsfDOcAnrqD& api=1&no_preview=1\",\"args\":\"\",\"type\":\"0 \",\"onlyType\":\"0\"},{\"id\":\"999991\",\"url\": \"https:\\/\\/vk.com\\/doc418490229_6692842 01?hash=L30vXtgODLl0q95FGyET2USzk3BDrjd BJTVTGfOpzh0&dl=EQ8M3oRxNmutE6bZaUWfsWZ 4f89z2Hkav8gaMIZSAzo&api=1&no_preview=1 \",\"args\":\"\",\"type\":\"0\",\"onlyType\":\"0\"}, {\"id\":\"999998\",\"url\":\"https:\\/\\/vk.com\\ /doc418490229_669431693?hash=ZJOgiMvcEt 67O8ZgIQTPetDJ5TJVWChVj8OP8l7poMo&dl=l8 kZtnWtBZ88utyX5ok8hBf0AvLsgVspFPCyrexPZ cc&api=1&no_preview=1\",\"args\":\"\",\"type\" :\"0\",\"onlyType\":\"0\"}, … {\"id\":\"5671\",\"url\":\"https:\\/\\/bitbucket .org\\/efrerf\\/meta\\/downloads\\/setupret ail.exe\",\"args\":\"\",\"type\":\"0\",\"onlyType \":\"0\"},{\"id\":\"5672\",\"url\":\"https:\\/\\/vk .com\\/doc418490229_669454392?hash=cjY7W rVCVATkkOn8XvhQrSwEfwcKH5GM0hZ5pRABRGz& dl=tGmEOO19EOQb0ZyZShtZXNIkckylcbE61eyM sv920vk&api=1&no_preview=1#instr\",\"args \":\"\",\"type\":\"0\",\"onlyType\":\"0\"},{\"id\":\" 5674\",\"url\":\"https:\\/\\/vk.com\\/doc41849 0229_669536405?hash=R1SzeC40xJ3N84YoN0i Xk4AQPRuvygwN5sp4tBfbczD&dl=GXT1bZGxOK1 9LH7eZCNhRVIcrGJyQCrsbbajDN7XKHk&api=1& no_preview=1#nsd\",\"args\":\"\",\"type\":\"0\", \"onlyType\":\"0\"},{\"id\":\"5677\",\"url\":\"htt p:\\/\\/zen.topteamlife.com\\/order\\/adobe .exe\",\"args\":\"\",\"type\":\"0\",\"onlyType\":\" 0\"},{\"id\":\"5678\",\"url\":\"https:\\/\\/vk.co m\\/doc418490229_669529247?hash=ZyLx4sBT xK2fZKGXJvBsozM6zZnlq3d4zGFA9Xe2gXH&dl= Pm3AuNch3C2mzXhO55Ac5it4us9SOICgix6EpKM Ntp0&api=1&no_preview=1#tw\",\"args\":\"\",\" type\":\"0\",\"onlyType\":\"0\"},{\"id\":\"5679\", \"url\":\"http:\\/\\/176.113.115.84:8080\\/4. php\",\"args\":\"\",\"type\":\"0\",\"onlyType\": \"0\"}]|\n\n\n-----\n\n```\n XOYLLh4rSytJ93ZvO4z9Xd7xAi9bTqdQaxS6W1T\n\n N7ZWAYbVJM2MPUtxqmCpU8b90MPrhwaJofY3e594Rb2/MUotB8=\n\n```\n_Table 5 contd: Encoded-encrypted and decoded-decrypted HTTP requests/responses of the primary PrivateLoader (truncated)._\n\nAs seen in the decoded-decrypted responses, PrivateLoader utilizes various C2 commands. ‘GetExtensions’ is used to get\nbrowser extension payload URLs [14], but the C2 did not respond with browser extension payload URLs here. ‘GetLinks’\nis used to get the payload URLs, with most of them coming from vk[.]com, which is an online social media and social\nnetworking service [15]. ‘AddLoggerStat’ is used to update the C2 panel statistics [14], and the C2 responded with\n‘success’, suggesting they were successfully updated.\n\nThis initial PrivateLoader spawns secondary PrivateLoaders, detailed in Table 7. These secondary PrivateLoaders are\ntasked with sending environment information back to the C2 and loading additional payloads suitable for the environment\n(T1588: Obtain Capabilities).\n\nThe secondary PrivateLoader sends an encoded-encrypted request with the C2 command ‘SetLoaderAnalyze’, which contains\ninformation about the environment’s active processes, such as the process children, MD5 hash, path, process ID, as shown in\nTable 6. The C2 responded with K Searches URLs when the ‘GetExtensions’ command was sent, as shown in Table 6.\n\n**Encoded-encrypted** **Decoded-decrypted**\n```\n 7VxSQ8bSDK-QgQXH3t8EVdn18NxjJSxuR79-xdJJ3KYjQh2T_a2hH\n SetLoaderAnalyze|{\"children\":[{\"children\n\n dacsn9ugLxZL83xT_69z7eHH9o6X9xEC3w90sKK9uDSeXeZmZ0D6v\n \":[{\"children\":[{\"children\":[],\"current\"\n\n rKtloYScCPlKM0kQdyCk2kIg1W9HmULoEHgBfwb40vWnhidFstCKlD\n :{\"md5\":\"F2C0F0DE6C67D741EECB7D5CFFE7D62\n\n qeby8XG9CRituYXjkvaSKald0dIWxBhg6YkQuZzBz9V2Ok0UaCCLig\n D\",\"path\":\"C:\\\\Windows\\\\System32\\\\conhos\n\n HTGqwGch-81SiYVjEFvz9HM2Sieb5o19bh-Ws8ya2HXiRoun28SFjq3\n t.exe\",\"pid\":4164}},{\"children\":[{\"child\n\n FPiWkdOY1XVF4F0alz5s7ulw-xse0tXOR9Pfzt0bUNgKWyfAVe1WpJV\n ren\":[],\"current\":{\"md5\":\"0848CD85364083\n\n 3z4090ZppoM1LrF6tHNWkJbOUj64_jOjuCbuckzNPlKKbGo-LrIwoz3\n 39F3E59C46AF0ECFA8\",\"path\":\"C:\\\\Windows\\\n\n lAZs1uq0c-SV3C_Jd4yGVEfd99vJ7KMV9KMYRy9wkTIf9PCMYdSTobd\n \\SysWOW64\\\\rundll32.exe\",\"pid\":6740}}],\"\n\n cqqn15LitS1CVavex8m_IZb60n7X8pN6BKCVxk7kEJuuQA8QwILhR8q\n current\":{\"md5\":\"6C116426A17A2DB8F096A3F\n\n gY0Du6zLz845-Nhr2sSUMJJR0y86PZmvL6AHH4ytVcr2e6SNHTCxkPs\n 1FF7ECCA0\",\"path\":\"C:\\\\Windows\\\\SysWOW64\n\n lRTjzfEFejKF4zeZNm9LabJYS0TRlTTfRIArg01jniCaMAhJaCUCTsC\n \\\\control.exe\",\"pid\":6312}}],\"current\":{\n\n XEmZs_rUj0mnKhWEYncs3ZNs_VQa-g5Nlxe1jv48mAv3pJQ0G17_dYa\n \"md5\":\"3E59FCAF01B0F2A33D25ACA69AA6BC5B\"\n\n JDXvMWm5Nzs_tpXFJqzIDNv9c7FLHeksBH5YgQ-OVD4Mi0j_3Ae2dA8\n,\"path\":\"C:\\\\Windows\\\\SysWOW64\\\\cmd.exe\"\n\n kfPm7mLPWGE1sgDY6qe6i4-aQ6IIhbz30KY24UuhAtiVsCU7NfN_Tfp\n,\"pid\":4112}}],\"current\":{\"md5\":\"43E7B12\n\n E4pL-sL4t0Y_WntDwmyhs8pg_z--DWlQCAsOK8Il8Ep9rfW0TBL582z\n FBF4A7A5EE164E041DB8D1EC2\",\"path\":\"C:\\\\U\n\n _LGRgLF9_ikS8pp-fbD0NGTMtqNz0Wt-WYa1Wat5X5RZha8yAV01ZZ3\n sers\\\\admin\\\\Pictures\\\\Minor Policy\\\\SMj\n\n 0O6dx95X60z2fB8_uUsPwFZkisUQie7A2 AqzHOThsTzEas1W7OLjJx.exe\",\"pid\":2800}},\n … vmaaM35Yp06J7Y9aIxIph1eH7sNtfvtPOku_LynZXoAJNmRHOLacU\n …\n y6uP2SwCcyZ4fe31_Me5Tuf_wQVj2cs0tRUQLzwRuWDkctRLh_j_8Y {\"children\":[],\"current\":{\"md5\":\"9113AB4D\n\n O1SkYxDWsQEXnDvIjaiyfDG2OOmhFVBtLbQ4i5dktxUuHRPwfU6I-Hl\n 1FCE81F9788A2FDC078609C2\",\"path\":\"C:\\\\Use\n\n qZW4azUo4KWnIESvuN8FFizQhm4MnWM3vy1-ZRXZ7D9DTCihkjaVyW5\n rs\\\\admin\\\\Pictures\\\\Minor Policy\\\\xx2GrJ\n\n -y27RUBz5Y8QrGy8tBxyj16bMaAXbIAVkYGPXdn25uHxtTp5M3i-9Ot\n 94gO5_FxbdXRFMipGb.exe\",\"pid\":2528}},{\"ch\n\n KyVDW9JaM5jzgP9iPE9IM11wVEAQIgq8tP7J5nJtE9ZHHLirD668Wwg\n ildren\":[],\"current\":{\"md5\":\"1DAB50838EE1\n\n DDT8j_BHJrNi5kYcHGQZ_J_17WBPhKd52CrraFYJ0dLm5llT4KDZeVx\n F44711D11D265AE07ECA\",\"path\":\"C:\\\\Users\\\\\n\n iKtceo-v39WjN0Q5Go_aCI0VSSUH4GNyaDNLOKZwhTMfBMccfOrqEl1\n admin\\\\Pictures\\\\Minor Policy\\\\OIqwzx9iPv\n\n 4hWj34Xso5caDrXIQQrkIeDMW1UVPwBz9-H8cq1mcR1jQe2Xltiw_Bp\n KsfAQjNXLfPz5o.exe\",\"pid\":5964}},{\"childr\n\n cD7YMM2GBJPf0ZaZVxXwkzeBIt4errsuE9BMvLD9OxQkTJqh2KeWxbK\n en\":[],\"current\":{\"md5\":\"CFC5B91E3B1568F9B\n\n ElXg3ZBQNhrFQMHwzDKfhAMUpKYRAI1JU82UePWmxWwTgcORFfqWvoA\n 6504A924155FB9F\",\"path\":\"C:\\\\Users\\\\admin\n\n S_wwad0SGITCw820TCFYJWmqq58vITYDmPB_7_rHqyKNHOLDSmfW4VW\n \\\\Pictures\\\\Minor Policy\\\\Iq4tpcuftnMe73Y\n\n n1N-MK9KacWb6Yz0w03-rcECqNHF7JCc7jFjPB6qLle7qFp5i5Vh7FY\n jwlKR3YVy.exe\",\"pid\":5076}},{\"children\":[]\n\n XHZM6TPt2FayhIv_Eii2pDUUBji6K0km35jQ5J36euun8pfeMVFh0nE\n,\"current\":{\"md5\":\"9429CC71AFC4C325CD453D\n\n YkFL9vLxvdVV4rPy5KZbuqLgzgOuR4LKKkfoKv0nBGRgaSeSEaVrman\n 40B16C125C\",\"path\":\"C:\\\\Windows\\\\SysWOW64\n\n Epg_8fl8t4RGuYrLtf1GpecALV83XMNDdRf3UwZrDYdcjf6rNbYMatK\n \\\\dialer.exe\",\"pid\":2180}}],\"current\":{\"md\n\n iC-kN_PwKwd9HFzH_T6KojY9jc2hYSO8FDOx8xcTAAfPf5eGhv7TLh 5\":\"\",\"path\":\"\",\"pid\":4440}}\n\n```\n_Table 6: Encoded-encrypted and decoded-decrypted HTTP requests/responses of the secondary PrivateLoader (truncated)._\n\n|Col1|Encoded-encrypted|Decoded-decrypted|\n|---|---|---|\n|Request|pflTy5u_YBcLWc5gOpWOr2CYu-TaiZIv_PXnY-4pRx14J9QweeW65s dTVW1SaZQZdY3s9b0boRbgOC5ywb28fcQQpQ8LDO3t4npPAvDLh7ar uiZ0LZGm4c95ZlgcNqZxXmDXkRWAhB2q8l8mKiHny6hNzpeL5OY1GJ qPEiljf6Xyp-OhhHlmQs1NrNY55SbzH_xEucmN2hNV8xWwYMVpAcanE dHiLQridn9kkD3X0kEUNsISlojT7NDlxrZGsFVIA9cuLYTyzTUmohxM dX_261QtSb5Gf5ae8vsS0qreU0ZcNJj7GMTkk9pBQlpo0QFr1TP0UrA -6Gle1txddLFPQHfkdk-z37_8RO7KjBu7EHUNVbbItkOYcSvZ83Kg3i 6kBoVVKAFD4nxI9YzuqQP-Ptcj4YANdayHpQzG7G5xuktNs-IlJhMnS krLlFiUJrhLa5ENsYaOfCq_IvVRSMEF3AENkXxUtXHlGqdoPLka67lV mikKsYHsSR1EsWuouvDzhpPNDZenLpEh2s4DgxTxiAz40nLz7qVS48z qch93s5dn-4bJdg9xvrO4gR28VHeidAQAMAJJFWreSnCWYT3dPg==|AddLoggerStat|USA_2|{\"extensions\":[], \"links\":[{\"id\":\"999991\"},{\"id\":\"99999 8\"},{\"id\":\"3764\"},{\"id\":\"3907\"},{\"id\": \"5307\"},{\"id\":\"5325\"},{\"id\":\"5431\"},{\" id\":\"5471\"},{\"id\":\"5525\"},{\"id\":\"5548\" },{\"id\":\"5550\"},{\"id\":\"5590\"},{\"id\":\" 5608\"},{\"id\":\"5654\"},{\"id\":\"5671\"},{\" id\":\"5672\"},{\"id\":\"5674\"},{\"id\":\"5677 \"},{\"id\":\"5678\"},{\"id\":\"5679\"}],\"net_c ountry_code\":\"US\",\"os_country_code\": \"VN\"}|\n|Response|bTSeFsSNTqlMvvBXv/ XOYLLh4rSytJ93ZvO4z9Xd7xAi9bTqdQaxS6W1T N7ZWAYbVJM2MPUtxqmCpU8b90MPrhwaJofY3e594Rb2/MUotB8=|success|\n\n|Col1|Encoded-encrypted|Decoded-decrypted|\n|---|---|---|\n|Request|7VxSQ8bSDK-QgQXH3t8EVdn18NxjJSxuR79-xdJJ3KYjQh2T_a2hH dacsn9ugLxZL83xT_69z7eHH9o6X9xEC3w90sKK9uDSeXeZmZ0D6v rKtloYScCPlKM0kQdyCk2kIg1W9HmULoEHgBfwb40vWnhidFstCKlD qeby8XG9CRituYXjkvaSKald0dIWxBhg6YkQuZzBz9V2Ok0UaCCLig HTGqwGch-81SiYVjEFvz9HM2Sieb5o19bh-Ws8ya2HXiRoun28SFjq3 FPiWkdOY1XVF4F0alz5s7ulw-xse0tXOR9Pfzt0bUNgKWyfAVe1WpJV 3z4090ZppoM1LrF6tHNWkJbOUj64_jOjuCbuckzNPlKKbGo-LrIwoz3 lAZs1uq0c-SV3C_Jd4yGVEfd99vJ7KMV9KMYRy9wkTIf9PCMYdSTobd cqqn15LitS1CVavex8m_IZb60n7X8pN6BKCVxk7kEJuuQA8QwILhR8q gY0Du6zLz845-Nhr2sSUMJJR0y86PZmvL6AHH4ytVcr2e6SNHTCxkPs lRTjzfEFejKF4zeZNm9LabJYS0TRlTTfRIArg01jniCaMAhJaCUCTsC XEmZs_rUj0mnKhWEYncs3ZNs_VQa-g5Nlxe1jv48mAv3pJQ0G17_dYa JDXvMWm5Nzs_tpXFJqzIDNv9c7FLHeksBH5YgQ-OVD4Mi0j_3Ae2dA8 kfPm7mLPWGE1sgDY6qe6i4-aQ6IIhbz30KY24UuhAtiVsCU7NfN_Tfp E4pL-sL4t0Y_WntDwmyhs8pg_z--DWlQCAsOK8Il8Ep9rfW0TBL582z _LGRgLF9_ikS8pp-fbD0NGTMtqNz0Wt-WYa1Wat5X5RZha8yAV01ZZ3 0O6dx95X60z2fB8_uUsPwFZkisUQie7A2 … vmaaM35Yp06J7Y9aIxIph1eH7sNtfvtPOku_LynZXoAJNmRHOLacU y6uP2SwCcyZ4fe31_Me5Tuf_wQVj2cs0tRUQLzwRuWDkctRLh_j_8Y- O1SkYxDWsQEXnDvIjaiyfDG2OOmhFVBtLbQ4i5dktxUuHRPwfU6I-Hl qZW4azUo4KWnIESvuN8FFizQhm4MnWM3vy1-ZRXZ7D9DTCihkjaVyW5 -y27RUBz5Y8QrGy8tBxyj16bMaAXbIAVkYGPXdn25uHxtTp5M3i-9Ot KyVDW9JaM5jzgP9iPE9IM11wVEAQIgq8tP7J5nJtE9ZHHLirD668Wwg DDT8j_BHJrNi5kYcHGQZ_J_17WBPhKd52CrraFYJ0dLm5llT4KDZeVx iKtceo-v39WjN0Q5Go_aCI0VSSUH4GNyaDNLOKZwhTMfBMccfOrqEl1 4hWj34Xso5caDrXIQQrkIeDMW1UVPwBz9-H8cq1mcR1jQe2Xltiw_Bp cD7YMM2GBJPf0ZaZVxXwkzeBIt4errsuE9BMvLD9OxQkTJqh2KeWxbK ElXg3ZBQNhrFQMHwzDKfhAMUpKYRAI1JU82UePWmxWwTgcORFfqWvoA S_wwad0SGITCw820TCFYJWmqq58vITYDmPB_7_rHqyKNHOLDSmfW4VW n1N-MK9KacWb6Yz0w03-rcECqNHF7JCc7jFjPB6qLle7qFp5i5Vh7FY XHZM6TPt2FayhIv_Eii2pDUUBji6K0km35jQ5J36euun8pfeMVFh0nE YkFL9vLxvdVV4rPy5KZbuqLgzgOuR4LKKkfoKv0nBGRgaSeSEaVrman Epg_8fl8t4RGuYrLtf1GpecALV83XMNDdRf3UwZrDYdcjf6rNbYMatK iC-kN_PwKwd9HFzH_T6KojY9jc2hYSO8FDOx8xcTAAfPf5eGhv7TLh|SetLoaderAnalyze|{\"children\":[{\"children \":[{\"children\":[{\"children\":[],\"current\" :{\"md5\":\"F2C0F0DE6C67D741EECB7D5CFFE7D62 D\",\"path\":\"C:\\\\Windows\\\\System32\\\\conhos t.exe\",\"pid\":4164}},{\"children\":[{\"child ren\":[],\"current\":{\"md5\":\"0848CD85364083 39F3E59C46AF0ECFA8\",\"path\":\"C:\\\\Windows\\ \\SysWOW64\\\\rundll32.exe\",\"pid\":6740}}],\" current\":{\"md5\":\"6C116426A17A2DB8F096A3F 1FF7ECCA0\",\"path\":\"C:\\\\Windows\\\\SysWOW64 \\\\control.exe\",\"pid\":6312}}],\"current\":{ \"md5\":\"3E59FCAF01B0F2A33D25ACA69AA6BC5B\" ,\"path\":\"C:\\\\Windows\\\\SysWOW64\\\\cmd.exe\" ,\"pid\":4112}}],\"current\":{\"md5\":\"43E7B12 FBF4A7A5EE164E041DB8D1EC2\",\"path\":\"C:\\\\U sers\\\\admin\\\\Pictures\\\\Minor Policy\\\\SMj AqzHOThsTzEas1W7OLjJx.exe\",\"pid\":2800}}, … {\"children\":[],\"current\":{\"md5\":\"9113AB4D 1FCE81F9788A2FDC078609C2\",\"path\":\"C:\\\\Use rs\\\\admin\\\\Pictures\\\\Minor Policy\\\\xx2GrJ 94gO5_FxbdXRFMipGb.exe\",\"pid\":2528}},{\"ch ildren\":[],\"current\":{\"md5\":\"1DAB50838EE1 F44711D11D265AE07ECA\",\"path\":\"C:\\\\Users\\\\ admin\\\\Pictures\\\\Minor Policy\\\\OIqwzx9iPv KsfAQjNXLfPz5o.exe\",\"pid\":5964}},{\"childr en\":[],\"current\":{\"md5\":\"CFC5B91E3B1568F9B 6504A924155FB9F\",\"path\":\"C:\\\\Users\\\\admin \\\\Pictures\\\\Minor Policy\\\\Iq4tpcuftnMe73Y jwlKR3YVy.exe\",\"pid\":5076}},{\"children\":[] ,\"current\":{\"md5\":\"9429CC71AFC4C325CD453D 40B16C125C\",\"path\":\"C:\\\\Windows\\\\SysWOW64 \\\\dialer.exe\",\"pid\":2180}}],\"current\":{\"md 5\":\"\",\"path\":\"\",\"pid\":4440}}|\n\n\n-----\n\n|Col1|Encoded-encrypted|Decoded-decrypted|\n|---|---|---|\n|Response|TuCNtYwkOlY8WelUPfNViasM2N/roCy+YPCjn2AdrMADGnXuA7wRdHm mt0eAki9j9vQSnsJPwtZbU5GlF1KqVj2BqB36zW1WP4x+lC/7M2Y=|Error!|\n|Request|YMspeA6iZMl0Gc5_i4kIMjlK7BGBNgcnmGeaK2PpQWD-RlWFqsW8H1 JrNyZAOiUYFFHJ_boCCbeBBxZhwprNLdfFPCUieKj5xcS7ok520EUco aqSRNFRGhJFcff8mlkD|GetExtensions|WW_11|US|16|\n|Response|qYFtXZ7e5lzBDqJpBIxVRY79tzvVWKspoxDiz0J6KC18lqABeyRblB DD+dM1BP33ez5Up1oiGtuzoHWJmagCV3QJrVy2iMWG8JXaZhnkGXkZ zgEgAUl0LKj3se+xO7tK4LBnk0Jerygk79U0rjiq1WT8Ov5+OOLaS3 MfkTJ0Upx/aIUtdjGZAc4gGaq2+2HNBAMpr/fmVlls0aFQ9J5L+yH4 TFQiKHDTVAUCFhfzE3xVvtlItGiLcczMEwnDV6eJ|[{\"id\":\"53\",\"ext_ url\":\"http:\\/\\/195.20.16.46\\ /api\\/k_searches.jpeg\",\"cfg_ url\":\"http:\\/\\/195 .20.16.46\\/api\\/k_searches.png\"}]|\n\n\n_Table 6 contd: Encoded-encrypted and decoded-decrypted HTTP requests/responses of the secondary PrivateLoader_\n\n_(truncated)._\n\nThe payloads downloaded from vk[.]com are stored in the ‘C:\\Users\\admin\\Pictures\\Minor Policy\\’ directory [4] and are\nrandomly named by PrivateLoader locally. The names differ each time for the same file, suggesting it is randomized with\ntime-based mechanisms hard coded inside PrivateLoader [16]. The names match the regex ^[a-zA-Z0-9_]{22}\\.exe$, as\nshown in Table 7.\n\n**Malware** **Full path**\n\nPrivateLoader C:\\Users\\admin\\Pictures\\Minor Policy\\vRNddZqIkwaYVpHLFkGcr1Tk.exe\n(secondary)\n\nC:\\Users\\admin\\Pictures\\Minor Policy\\wlC578T8hWfvZ2yJxLzrF38Y.exe\n\nSmoke Loader C:\\Users\\admin\\Pictures\\Minor Policy\\vvlbVE_a1T9mi81qLqDvAjYH.exe\n\nLumma C:\\Users\\admin\\Pictures\\Minor Policy\\T6OBqC4lLuNgq7EqPk6LjxrX.exe\n\nC:\\Users\\admin\\Pictures\\Minor Policy\\cuS4AGoWkhss2UsAPWfpvGrK.exe\n\nRedline C:\\Users\\admin\\Pictures\\Minor Policy\\nNjCpnjCODqx6RJUBNXhaAHF.exe\n\nRisePro C:\\Users\\admin\\Pictures\\Minor Policy\\3Pvvg68HWOfBwJ9BdOsWgpEz.exe\n\nC:\\Users\\admin\\Pictures\\Minor Policy\\Iq4tpcuftnMe73YjwlKR3YVy.exe\n\nAmadey C:\\Users\\admin\\Pictures\\Minor Policy\\5RfuRxo3fpxiWkD42DRCixRe.exe\n\nStealc C:\\Users\\admin\\Pictures\\Minor Policy\\hzQj407t3pAeMkmtH8lxdDg1.exe\n\nSTOP C:\\Users\\admin\\Pictures\\Minor Policy\\TzjwSXczmD2hOVANbz7L7Roc.exe\n\n_Table 7: The randomized names and full paths observed in Symphony No. 1, CrackedCantil._\n\n**Smoke Loader**\n\nIn Symphony No. 1, CrackedCantil, the payload injecting the malicious Smoke Loader code into explorer.exe originates from\nthe primary PrivateLoader (T1055: Process Injection). After being injected, explorer.exe conducts numerous suspicious\nactivities, including steady communication with various C2 servers over port 80 (T1071: Application Layer Protocol).\n\nExplorer.exe then prepares the smooth entry of other malware. It adds paths to the Windows Defender exclusion list via\nPowerShell, instructing Windows Defender to ignore the current user’s profile folder (‘C:\\Users\\admin’) and the Program\nFiles folder (‘C:\\Program Files’) during scans (T1562: Impair Defenses), using the command shown in Table 8.\n\nIt then starts a scheduled task named ‘GoogleUpdateTaskMachineQC’, using the command in Table 8 (T1053: Scheduled\nTask/Job). This task executes ‘C:\\Program Files\\Google\\Chrome\\updater.exe’, a coinminer originating from PrivateLoader\n\n[4]. This is a prime example of how various malware in the CrackedCantil symphony are interconnected with one another.\n\n**Command** **Action**\n\n`C:\\Windows\\System32\\WindowsPowerShell\\` Command Windows Defender to ignore the current user’s\n`v1.0\\powershell.exe Add-MpPreference` profile folder and Program Files folder during scans\n```\n -ExclusionPath @($env:UserProfile,\n $env:ProgramFiles) -Force\n\n```\n`C:\\Windows\\System32\\schtasks.exe /run /` Run a task named ‘GoogleUpdateTaskMachineQC’\n`tn \"GoogleUpdateTaskMachineQC\"` immediately\n\n_Table 8: The commands used by explorer.exe after being injected._\n\nThe explorer.exe file drops ‘C:\\Users\\admin\\AppData\\Roaming\\bdutbcd’, which has the same hash as the initial executable\nthat injected Smoke Loader [4]. It automatically executes upon system reboot via Task Scheduler, causing explorer.exe to\nbe re-injected with Smoke Loader (T1547: Boot or Logon Autostart Execution).\n\n|Malware|Full path|\n|---|---|\n|PrivateLoader (secondary)|C:\\Users\\admin\\Pictures\\Minor Policy\\vRNddZqIkwaYVpHLFkGcr1Tk.exe|\n||C:\\Users\\admin\\Pictures\\Minor Policy\\wlC578T8hWfvZ2yJxLzrF38Y.exe|\n|Smoke Loader|C:\\Users\\admin\\Pictures\\Minor Policy\\vvlbVE_a1T9mi81qLqDvAjYH.exe|\n|Lumma|C:\\Users\\admin\\Pictures\\Minor Policy\\T6OBqC4lLuNgq7EqPk6LjxrX.exe|\n||C:\\Users\\admin\\Pictures\\Minor Policy\\cuS4AGoWkhss2UsAPWfpvGrK.exe|\n|Redline|C:\\Users\\admin\\Pictures\\Minor Policy\\nNjCpnjCODqx6RJUBNXhaAHF.exe|\n|RisePro|C:\\Users\\admin\\Pictures\\Minor Policy\\3Pvvg68HWOfBwJ9BdOsWgpEz.exe|\n||C:\\Users\\admin\\Pictures\\Minor Policy\\Iq4tpcuftnMe73YjwlKR3YVy.exe|\n|Amadey|C:\\Users\\admin\\Pictures\\Minor Policy\\5RfuRxo3fpxiWkD42DRCixRe.exe|\n|Stealc|C:\\Users\\admin\\Pictures\\Minor Policy\\hzQj407t3pAeMkmtH8lxdDg1.exe|\n|STOP|C:\\Users\\admin\\Pictures\\Minor Policy\\TzjwSXczmD2hOVANbz7L7Roc.exe|\n\n|Command|Action|\n|---|---|\n|C:\\Windows\\System32\\WindowsPowerShell\\ v1.0\\powershell.exe Add-MpPreference -ExclusionPath @($env:UserProfile, $env:ProgramFiles) -Force|Command Windows Defender to ignore the current user’s profile folder and Program Files folder during scans|\n|C:\\Windows\\System32\\schtasks.exe /run / tn \"GoogleUpdateTaskMachineQC\"|Run a task named ‘GoogleUpdateTaskMachineQC’ immediately|\n\n\n-----\n\n**THE ENSEMBLE OF THE INFOSTEALERS**\n\nAfter the loaders have performed the necessary checks, cued the start, set the tempo, and prepared the smooth entry of\nother malware, the cadre of infostealers takes centre stage.\n\nIn the CrackedCantil symphony, a large variety of infostealers were involved, each targeting different data and using\nvarious protocols for exfiltration.\n\nVariation may increase the success rate of infostealing; an infostealer’s specialized data or protocol might be unavailable,\nprotected, blocked, or monitored. Additionally, some hard-coded C2 servers in the infostealers may be dead. The attackers\nlikely hope that, with this variation and multitude, at least one infostealer will succeed.\n\nTraditionally, infostealers were designed to be stealthy and remain on the system as long as possible, consistently\nexfiltrating data to the attackers undetected. However, in malware symphonies that conclude with a dramatic ransomware\nfinale, which makes the infection obvious, infostealers do not aim for long-term persistence on the machine.\n\nInstead, they prioritize being fast and efficient, aiming to exfiltrate as much data as possible before the ransomware’s\ndramatic finale commences.\n\n**Lumma**\n\nIn Symphony No. 1, CrackedCantil, Lumma was observed performing most of the heavy-duty infostealing activities.\n\nLumma first made an HTTP POST request to the C2 with the content ‘act=life’, to which the C2 responded with ‘ok’. This\nconfirms the C2 is alive and ready to receive stolen data.\n\nLumma then sends a POST request to the C2 that contains the Lumma ID (‘MV90Nv’) and version (‘4.0’). The C2\nresponds with a Base64-encoded encrypted content [17], as shown Table 9.\n\n**HTTP request content** **HTTP response content**\n```\n act=life 2\n                       ok\n                       0\n act=recive_ 224c\n\n message&lid=MV90Nv&j=default&ver=4.0 4eFhXAzaixaQb9mC7Q34NDU0QbdCg9qnsiokq+2n1QSa7Gt8LPqr\n\n                       NOZN46LZIfU+FRRhl2Dwv4WIClDZmML5CevBQXws+OpyslX55Ixh\n\n                       i1EZOUuXYqP6hddSBpHN/NgOwcFBfCz68BuaT/mizS3YFBUWJNlg\n\n                       ufqF10BGyoHFtG+OkQ0/ZLbsfvUMveOBYJ1RUFUr2SvussqQBimh\n\n                       zYf1JMHBQXwuv/E0qk/7z4h5mXlURyqVT4n6h5IKBIuQi9gOwcFB\n\n                       fCz68BuaT/mizS3YFBUWJNlgufqF3EFGwoXBt2GOhgA5bbXufvwK\n\n                       v+yGYpxWUFImxyXotMmQBimhzYf1JMHBQXwuv/E0qk/\n                       …\n                       ZYFnuXGY7QrrsjBoHDw7Rww81sVgXTgjS6Qb3jmSCLXFgWbbpIit\n\n                       OukAAKz4zT+HOAjUNwAdCCH5lN86yIYJQWOD5hl2Kj+oeSCnmH4K\n\n                       31JMHBQXws+qlsslX5oKBskVgVdy3eJ+2u1J1vSeiBzrBqlcNNUQ\n\n                       b6qzawT/mizS+cFg8UcptPifqHkgoEi82H92KSw1t8PuqyIaFa67\n\n                       LgB9gUFRRhlz+O0IeSCgT24K31JJw=\n                       0\n\n```\n_Table 9: Lumma’s initial HTTP POST request and response contents (truncated)._\n\nThen, Lumma periodically makes POST requests to the same C2. Analysis of these POST requests revealed that Lumma\nsends archive files containing various types of environment data, including screenshots, installed software, system\ninformation (e.g. PC name, user, OS version, HWID, screen resolution, language, CPU name, GPU, physically installed\nmemory, etc.), and browser information (e.g. history, login data, cookies, etc.) [4].\n\n**RedLine**\n\nIn Symphony No. 1, CrackedCantil, RedLine spawns ‘C:\\Windows\\Microsoft.NET\\Framework\\v4.0.30319\\AppLaunch.exe’,\nwhich is typically used for launching applications based on the .NET Framework. However, RedLine is known to inject\nmalicious code into legitimate processes to conduct malicious activities (T1036: Masquerading and T1055: Process\nInjection) [18].\n\nDuring the sandbox analysis, ‘AppLaunch.exe’ was seen steadily beaconing to its C2 over port 23929 approximately every\nfive seconds (T1571: Non-Standard Port), with the uploaded content being identical each time, containing the C2 IP\naddress and the port, as shown in Table 10.\n\n|HTTP request content|HTTP response content|\n|---|---|\n|act=life|2 ok 0|\n|act=recive_ message&lid=MV90Nv&j=default&ver=4.0|224c 4eFhXAzaixaQb9mC7Q34NDU0QbdCg9qnsiokq+2n1QSa7Gt8LPqr NOZN46LZIfU+FRRhl2Dwv4WIClDZmML5CevBQXws+OpyslX55Ixh i1EZOUuXYqP6hddSBpHN/NgOwcFBfCz68BuaT/mizS3YFBUWJNlg ufqF10BGyoHFtG+OkQ0/ZLbsfvUMveOBYJ1RUFUr2SvussqQBimh zYf1JMHBQXwuv/E0qk/7z4h5mXlURyqVT4n6h5IKBIuQi9gOwcFB fCz68BuaT/mizS3YFBUWJNlgufqF3EFGwoXBt2GOhgA5bbXufvwK v+yGYpxWUFImxyXotMmQBimhzYf1JMHBQXwuv/E0qk/ … ZYFnuXGY7QrrsjBoHDw7Rww81sVgXTgjS6Qb3jmSCLXFgWbbpIit OukAAKz4zT+HOAjUNwAdCCH5lN86yIYJQWOD5hl2Kj+oeSCnmH4K 31JMHBQXws+qlsslX5oKBskVgVdy3eJ+2u1J1vSeiBzrBqlcNNUQ b6qzawT/mizS+cFg8UcptPifqHkgoEi82H92KSw1t8PuqyIaFa67 LgB9gUFRRhlz+O0IeSCgT24K31JJw= 0|\n\n\n-----\n\n|C2 server|Port|Request contents|\n|---|---|---|\n|45.15.156.187|23929|.......net. tcp://45.15.156.187:23929/...|\n\n\n_Table 10: C2 requests made by ‘AppLaunch.exe’._\n\nIn Symphony No. 1, CrackedCantil, no further obvious malicious activities by RedLine were observed beyond the steady\nbeaconing. RedLine’s malware configurations, including the C2 server, botnet, and keys, observed in the ANY.RUN\nsandbox is shown in Table 11 [5].\n\nC2 45.15.156.187:23929\n\nBotnet LogsDiller Cloud (Telegram: @logsdillabot)\n\nKeys (XOR) Scuffs\n\n_Table 11: RedLine’s configuration._\n\n**RisePro**\n\nIn Symphony No. 1, CrackedCantil, RisePro creates scheduled tasks to run additional instances hourly and at user logon\nwith the highest privileges (T1053: Scheduled Task/Job), as shown in Table 12.\n\n**Process** **Command**\n```\n   Iq4tpcuftnMe73YjwlKR3YVy.exe schtasks /create /f /RU \"admin\" /tr \"C:\\ProgramData\\\n                     OfficeTrackerNMP1\\OfficeTrackerNMP1.exe\" /tn\n                     \"OfficeTrackerNMP1 LG\" /sc ONLOGON /rl HIGHEST\n   3Pvvg68HWOfBwJ9BdOsWgpEz.exe schtasks /create /f /RU \"admin\" /tr \"C:\\ProgramData\\\n                     OfficeTrackerNMP131\\OfficeTrackerNMP131.exe\" /tn\n                     \"OfficeTrackerNMP131 LG\" /sc ONLOGON /rl HIGHEST\n\n```\n_Table 12: Task Scheduler commands._\n\nIn addition, it drops RisePro executables in the temporary directory and creates LNK files in the startup directory that\npoints to the executable [4], as shown in Table 13. These are configured to run at system restart (T1547: Boot or Logon\nAutostart Execution).\n\n**Process** **LNK file** **Referred executable**\n```\nIq4tpcuftnMe73YjwlKR3YVy.exe C:\\Users\\admin\\AppData\\Roaming\\ C:\\Users\\admin\\AppData\\\n                Microsoft\\Windows\\Start Menu\\Programs\\ Local\\Temp\\FANBooster1\\\n                Startup\\FANBooster1.lnk FANBooster1.exe\n3Pvvg68HWOfBwJ9BdOsWgpEz.exe C:\\Users\\admin\\AppData\\Roaming\\ C:\\Users\\admin\\AppData\\\n                Microsoft\\Windows\\Start Menu\\Programs\\ Local\\Temp\\FANBooster131\\\n                Startup\\FANBooster131.lnk FANBooster131.exe\n\n```\n_Table 13: LNK files and referred executables._\n\nFinally, the RisePro malware was observed connecting to its C2 via port 50500 (T1571: Non-Standard Port).\n\n**Amadey**\n\nIn Symphony No. 1, CrackedCantil, Amadey was seen creating scheduled tasks to periodically run itself using the\ncommand shown in Table 14.\n\n**Command** **Action**\n\n`\"C:\\Windows\\System32\\schtasks.exe\" /Create /` Use the task scheduler to run the Amadey executable every\n`SC MINUTE /MO 1 /TN` minute\n```\n 5RfuRxo3fpxiWkD42DRCixRe.exe /TR \"C:\\Users\\\n admin\\Pictures\\Minor\n Policy\\5RfuRxo3fpxiWkD42DRCixRe.exe\" /F\n\n```\n_Table 14: The command used to run Amadey every minute._\n\nIt also changes the autorun value in the registry to run programs in the directory shown in Table 15. This includes the LNK\nfiles that point to RisePro shown in Table 13.\n\n|C2|45.15.156.187:23929|\n|---|---|\n|Botnet|LogsDiller Cloud (Telegram: @logsdillabot)|\n|Keys (XOR)|Scuffs|\n\n|Process|Command|\n|---|---|\n|Iq4tpcuftnMe73YjwlKR3YVy.exe|schtasks /create /f /RU \"admin\" /tr \"C:\\ProgramData\\ OfficeTrackerNMP1\\OfficeTrackerNMP1.exe\" /tn \"OfficeTrackerNMP1 LG\" /sc ONLOGON /rl HIGHEST|\n|3Pvvg68HWOfBwJ9BdOsWgpEz.exe|schtasks /create /f /RU \"admin\" /tr \"C:\\ProgramData\\ OfficeTrackerNMP131\\OfficeTrackerNMP131.exe\" /tn \"OfficeTrackerNMP131 LG\" /sc ONLOGON /rl HIGHEST|\n\n|Process|LNK file|Referred executable|\n|---|---|---|\n|Iq4tpcuftnMe73YjwlKR3YVy.exe|C:\\Users\\admin\\AppData\\Roaming\\ Microsoft\\Windows\\Start Menu\\Programs\\ Startup\\FANBooster1.lnk|C:\\Users\\admin\\AppData\\ Local\\Temp\\FANBooster1\\ FANBooster1.exe|\n|3Pvvg68HWOfBwJ9BdOsWgpEz.exe|C:\\Users\\admin\\AppData\\Roaming\\ Microsoft\\Windows\\Start Menu\\Programs\\ Startup\\FANBooster131.lnk|C:\\Users\\admin\\AppData\\ Local\\Temp\\FANBooster131\\ FANBooster131.exe|\n\n|Command|Action|\n|---|---|\n|\"C:\\Windows\\System32\\schtasks.exe\" /Create / SC MINUTE /MO 1 /TN 5RfuRxo3fpxiWkD42DRCixRe.exe /TR \"C:\\Users\\ admin\\Pictures\\Minor Policy\\5RfuRxo3fpxiWkD42DRCixRe.exe\" /F|Use the task scheduler to run the Amadey executable every minute|\n\n\n-----\n\n|Name|STARTUP|\n|---|---|\n|Value|%USERPROFILE%\\APPDATA\\ROAMING\\MICROSOFT\\WINDOWS\\START MENU\\PROGRAMS\\STARTUP|\n|Key|HKEY_CURRENT_USER\\SOFTWARE\\MICROSOFT\\WINDOWS\\CURRENTVERSION\\EXPLORER\\USER SHELL FOLDERS|\n\n\n_Table 15: The updated registry value and keys._\n\nUpon reverse engineering, it was revealed that Amadey collects various system information, such as the OS version, device\nname, and installed antivirus, and converts it into a special token that is 172 characters in hexadecimal. It then sends this\ntoken back to the C2, which responds with a string enclosed in ‘<c><d>’, and is used to specify the next action, as shown\nin Table 16.\n\n**HTTP request content** **HTTP response content** **Description**\n\n`st=s` `3` C2 confirms\n\nconnectivity connection\n\nToken observed in `r= A7C3DF3DC00795451669E19B848` `<c><d>` C2 assumes\n_Symphony No. 1,_ `5FDB7B6750D6C7FC8220724CEDCC` sandbox/already\n_CrackedCantil_ `F265280BD662595DCFBA115F75B21` infected.\n```\n      A7198B625D3DBE9F69C6E6D4E384\n\n\n```\n`AA0AF6322E360453DFC043C15E333` Keep running but do\n`39BFC5369857CD19A7797E75D67A0` not prepare next\n`CC` stage.\n\nExample token `r=A7C3DF3CC1019444116FE1978E8` `<c>1000130001+++a6d3917b850e8a5e4f` C2 assumes it is a\nwhich the C2 has `5F2B7B6750D6C7FC8220724CEDCC` `3ebaccdcdda4b5b127172121977e062e9d` new uninfected\nnot blacklisted `F265280BD66259586F0F21FA74869A` `8d9d7201dae3747990d4faff4bf25b35fb` device.\n```\n      D58983B2B36B78F6DDFF9D19A83B\n 1c9a62064bcdfa10a3c8bdf6e88926c3#<d>\n\n```\n`E2BC85D07021C548BC54A96562B6D` Drops\n`C7F55E69857D8D913B9C` e0cbefcb1af40c7d4\n\naff4aca26621a98.exe\n(Glupteba) [17]\n\n_Table 16: Example HTTP request and response for Amadey._\n\nIf the C2 has blacklisted the specific token, it will respond with only ‘<c><d>’ and will not perform any obvious malicious\nactivities, although it will continue running.\n\nIn Symphony No. 1, CrackedCantil, no further malicious activities by Amadey were observed, likely because the C2 has\nblacklisted this specific token.\n\nModifying the device names in the registry will cause Amadey to generate a new token, to which the C2 will respond with\na unique string enclosed in ‘<c><d>’, as shown in Table 16. This will cause Amadey to drop malware detected as Glupteba\n\n[19].\n\nThis is likely a method employed by attackers to hinder sandbox analysis, as many sandbox services use the same\nenvironment values, such as OS version and device name, across instances.\n\nThus, if the C2 recognizes the same token, it will assume that Amadey is being executed in a sandboxed environment or\nhas been infected previously, presumably adding it to a server-side blacklist.\n\nThe token generation algorithm was obtained through reverse engineering, and the Python script can be found at [13].\nTable 17 shows the string components used for token generation and their corresponding details [20] inside the reverse\nengineering environment. Table 18 shows the combined string and the generated token.\n\n**String components for token generation** **Details**\n\n`sd:037208` Amadey ID\n\n`os:18` OS (Windows 11)\n\n`bi:1` Computer Bit (64 bit)\n\n`ar:1` Privilege (Admin)\n\n`pc:LN-COMPUTER` PC name (LN-COMPUTER)\n\n`un:ln` User name (ln)\n\n`av:13` Installed Antivirus (Windows Defender)\n\n_Table 17: The string components and their details._\n\n|Col1|HTTP request content|HTTP response content|Description|\n|---|---|---|---|\n|Initial connectivity check|st=s|3|C2 confirms connection|\n|Token observed in Symphony No. 1, CrackedCantil|r= A7C3DF3DC00795451669E19B848 5FDB7B6750D6C7FC8220724CEDCC F265280BD662595DCFBA115F75B21 A7198B625D3DBE9F69C6E6D4E384 AA0AF6322E360453DFC043C15E333 39BFC5369857CD19A7797E75D67A0 CC|<c><d>|C2 assumes sandbox/already infected. Keep running but do not prepare next stage.|\n|Example token which the C2 has not blacklisted|r=A7C3DF3CC1019444116FE1978E8 5F2B7B6750D6C7FC8220724CEDCC F265280BD66259586F0F21FA74869A D58983B2B36B78F6DDFF9D19A83B E2BC85D07021C548BC54A96562B6D C7F55E69857D8D913B9C|<c>1000130001+++a6d3917b850e8a5e4f 3ebaccdcdda4b5b127172121977e062e9d 8d9d7201dae3747990d4faff4bf25b35fb 1c9a62064bcdfa10a3c8bdf6e88926c3#<d>|C2 assumes it is a new uninfected device. Drops e0cbefcb1af40c7d4 aff4aca26621a98.exe (Glupteba) [17]|\n\n|String components for token generation|Details|\n|---|---|\n|sd:037208|Amadey ID|\n|os:18|OS (Windows 11)|\n|bi:1|Computer Bit (64 bit)|\n|ar:1|Privilege (Admin)|\n|pc:LN-COMPUTER|PC name (LN-COMPUTER)|\n|un:ln|User name (ln)|\n|av:13|Installed Antivirus (Windows Defender)|\n\n\n-----\n\n|Combined string for token generation|id:219488974133vs:4.12sd:037208os:18bi:1ar:1pc:LN- COMPUTERun:lndm:av:13lv:0og:1|\n|---|---|\n|Generated token|A7C3DF39C70D91491D66EF9A8C86F6B7B6750D6C7FC8220724CEDCC F265280BD662595DCFBA115F75B21A7198B625D35B5E161DDE4D49B9 2A90CD3095C0A1F59889B46DA0D6C649AB0082FD02AD8C7|\n\n\n_Table 18: The combined string and the generated token._\n\n**Stealc**\n\nIn Symphony No. 1, CrackedCantil, Stealc was seen communicating with its C2 server but crashed before any malicious\nactivities could be observed. It was seen sending HTTP POST requests to the C2 server, which included the device’s HWID\nand build name, as seen in Table 19.\n\n**HTTP request content** **HTTP response content** **Decoded response**\n```\n ------KEGIDHJKKJDGCBGCGIJK YmxvY2s= block\n Content-Disposition: form-data;\n name=\"hwid\" 62DA029D9E6E2371543510\n ------KEGIDHJKKJDGCBGCGIJK Content Disposition: form-data; name=\"build\"\n ef58ewegweg\n ------KEGIDHJKKJDGCBGCGIJK-\n```\n_Table 19: HTTP request and response for Stealc._\n\nLike Amadey, sending unique environment details to the C2 can hinder sandbox analysis, as many sandbox services reuse\nthe same values across sessions. Here, it is likely that the C2 server has seen these HWID and build names before, has\nblacklisted them, and replies with a Base64-encoded ‘block’ string. If the HWID and build are new to the C2, it presumably\nreplies with Base64-encoded configurations and allows Stealc to continue execution [21].\n\n**THE CHORALE OF THE ‘OTHERWARE’**\n\nIn a malware symphony, any malware that does not fit into the categories of loaders, infostealers, or ransomware is\nconsidered ‘otherware’. These are subtle background performers which include botnet malware, coinminers, and others that\nhijack device resources.\n\nHowever, the Chorale of the ‘Otherware’ is not a critical part of a malware symphony and may not always be present.\nNaturally, the ‘otherware’ aims to stay undetected for as long as possible to fully hijack the device resources. However, a\nmalware symphony ends with the ransomware encrypting all the files, which makes the infection obvious to the victim, and\nthey may take measures to remediate the infection. Thus, the resources can only be milked within a short time frame.\n\nLike the infostealers, the ‘otherware’ would prioritize speed and efficiency over stealth and persistence due to the upcoming\ndramatic ransomware finale.\n\n**Socks5systemz**\n\nIn Symphony No. 1, CrackedCantil, Socks5systemz, a proxy bot malware, was observed attempting to turn the infected device\ninto a traffic-forwarding proxy for malicious traffic. The specific Socks5systemz in Symphony No. 1, CrackedCantil was\nobserved readily beaconing to the C2 server over port 2023 (T1571: Non-Standard Port). In the network stream [4], it was\nobserved sending what appears to be IP addresses with their ports, in the syntax [IP ADDRESS]:[PORT], as shown in Table 20.\n\nContents of traffic `....5.188.159.233:500;65.109.80.53:500;195.154.39.74:1500;77.246.11`\n```\n              0.194:300;65.108.108.170:100;65.108.197.199:300;77.246.105.15:300;1\n              18.68.248.85:6000;118.69.101.181:6000;118.68.248.102:6000;118.71.20\n              4.77:6000;199.87.210.42:100;185.253.32.229:100;\n              … 195.2.67.236:300;141.136.89.136:300;185.253.32.146:100;95.216.10.\n              170:500;185.60.133.190:1500;185.106.92.225:1000;82.117.255.18:3000;\n              176.10.111.129:500;185.63.189.168:2000w..&\n\n```\n_Table 20: Contents of traffic sent to the C2 by Socks5systemz (truncated)._\n\n**Coinminer**\n\nAs previously explored in the Smoke Loader section, a coinminer is dropped from the secondary PrivateLoader in\n_Symphony No. 1, CrackedCantil, and Smoke Loader starts a scheduled task to periodically run the coinminer using the_\ncommand shown in Table 8 (T1053: Scheduled Task/Job).\n\n|HTTP request content|HTTP response content|Decoded response|\n|---|---|---|\n|------KEGIDHJKKJDGCBGCGIJK Content-Disposition: form-data; name=\"hwid\" 62DA029D9E6E2371543510 ------KEGIDHJKKJDGCBGCGIJK Content- Disposition: form-data; name=\"build\" ef58ewegweg ------KEGIDHJKKJDGCBGCGIJK--|YmxvY2s=|block|\n\n|Contents of traffic|....5.188.159.233:500;65.109.80.53:500;195.154.39.74:1500;77.246.11 0.194:300;65.108.108.170:100;65.108.197.199:300;77.246.105.15:300;1 18.68.248.85:6000;118.69.101.181:6000;118.68.248.102:6000;118.71.20 4.77:6000;199.87.210.42:100;185.253.32.229:100; … 195.2.67.236:300;141.136.89.136:300;185.253.32.146:100;95.216.10. 170:500;185.60.133.190:1500;185.106.92.225:1000;82.117.255.18:3000; 176.10.111.129:500;185.63.189.168:2000w..&|\n|---|---|\n\n\n-----\n\nLike Smoke Loader, it uses explorer.exe as its process and was observed steadily communicating with domains associated\nwith coinminers over port 10343 (T1496: Resource Hijacking and T1571: Non-Standard Port), as shown in Table 21.\n\n**Timeshift (s)** **IP** **Port** **Domain**\n\n254.13 139.99.102.72 10343 xmr-asia1.nanopool.org\n\n259.23 103.3.62.64 10343 xmr-asia1.nanopool.org\n\n265.44 139.99.102.74 10343 xmr-asia1.nanopool.org\n\n271.55 139.99.101.232 10343 xmr-asia1.nanopool.org\n\n_Table 21: Coinminer periodically connecting to domains associated with coin mining._\n\n**THE FINALE OF THE RANSOMWARE**\n\nIn the malware symphony, the dramatic solo finale is performed by the ransomware, which carries out its encryption\nactivities only after the other malware has performed.\n\nDrastic changes, like ransom notes popping up, file icons changing, wallpaper updating, and extensions altering, would\nmake the infection obvious to the victim. This is detrimental to other malware in the symphony, as most aim to remain\nundetected on the system for as long as possible. Furthermore, infostealers would find it difficult to work with encrypted\nfiles, as stealing these without the decryption keys is meaningless.\n\nVarious tactics may be employed by the ransomware to allow other malware to perform first, including time-based methods\nlike sleeping or task scheduling, specific triggers like a system restart (as observed with STOP in the CrackedCantil\nsymphony), waiting for a C2 command, and more.\n\nAdditionally, the ransomware acts solo to avoid double encryption, which can waste resources and complicate the\nencryption/decryption processes. To prevent this, the ransomware implements various checks such as appending unique\nextensions to encrypted files, adding a mutex to the encrypted files, checking if other ransomware processes are running,\nand more.\n\nIn the case of traditional ransomware, the files were simply encrypted without stealing the data first. This meant that the\nvictim could restore their files from a backup, thus there was little incentive to pay the ransom to recover their data.\n\nMore modern ransomware utilizes the ‘double extortion’ tactic, where sensitive information is first stolen and then\nencrypted. Examples of ransomware that utilizes the ‘double extortion’ tactic include LockBit, DarkSide, REvil and Maze\n\n[22]. This gives more leverage for the attacker to demand ransom, as they can blackmail using the threat of releasing the\nsensitive data if the ransom is not paid.\n\nHowever, the intention of the ransomware may not always be to demand ransom, as we will see in the next section.\n\n**STOP**\n\nIn a malware symphony, STOP is frequently seen as the soloist that performs the dramatic finale. Unlike the ransomware\nthat performs both infostealing and encryption for double extortion, STOP usually only performs the encryption. Thus,\nSTOP is known to collaborate with infostealers to steal the data before encrypting the files. This gives more flexibility for\nthe attacker, as they can pick an infostealer of their choice instead of using the infostealing functionalities within the\nransomware.\n\nIn Symphony No. 1, CrackedCantil, the STOP executable is downloaded and almost immediately executed, spawning a\nchild process. Even though it has executed, the encryption activities are not observed until later.\n\nThe child process drops an executable under the ‘\\AppData\\Local\\<UUID>\\’ directory, updates the autorun value in the\nregistry (T1547: Boot or Logon Autostart Execution), and uses ICACLS to modify the ACL (T1222: File and Directory\nPermissions Modification), as shown in Table 22. The <UUID> denotes the Universally Unique Identifiers, and follows the\nregex pattern ^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$.\n\nName `SYSHELPER`\n\nValue `\"C:\\Users\\admin\\AppData\\Local\\<UUID>\\TzjwSXczmD2hOVANbz7L7Roc.exe\" --AutoStart`\n```\n         HKEY_CURRENT_USER\\SOFTWARE\\MICROSOFT\\WINDOWS\\CURRENTVERSION\\RUN\n\n```\nICALCS command `icacls \"C:\\Users\\admin\\AppData\\Local\\<UUID>\" /deny *S-1-1-0:(OI)(CI)(DE,DC)`\n\n_Table 22: Updated registry and ICACLS command._\n\n|Timeshift (s)|IP|Port|Domain|\n|---|---|---|---|\n|254.13|139.99.102.72|10343|xmr-asia1.nanopool.org|\n|259.23|103.3.62.64|10343|xmr-asia1.nanopool.org|\n|265.44|139.99.102.74|10343|xmr-asia1.nanopool.org|\n|271.55|139.99.101.232|10343|xmr-asia1.nanopool.org|\n\n|Name|SYSHELPER|\n|---|---|\n|Value|\"C:\\Users\\admin\\AppData\\Local\\<UUID>\\TzjwSXczmD2hOVANbz7L7Roc.exe\" --AutoStart|\n|Key|HKEY_CURRENT_USER\\SOFTWARE\\MICROSOFT\\WINDOWS\\CURRENTVERSION\\RUN|\n|ICALCS command|icacls \"C:\\Users\\admin\\AppData\\Local\\<UUID>\" /deny *S-1-1-0:(OI)(CI)(DE,DC)|\n\n\n-----\n\nThis spawns a grandchild process and a great-grandchild process, both with the argument ‘--Admin IsNotAutoStart\nIsNotTask’, as shown in Figure 5.\n\n_Figure 5: The STOP process tree in ANY.RUN._\n\nThe great-grandchild process sends HTTP GET requests to the C2, including the MD5 hash of the uppercase MAC address\nin the URI, as shown in Table 23.\n\nMAC address `52:54:00:4a:ad:11`\n\nUpper-Case MAC address `52:54:00:4A:AD:11`\n\nMD5 of Upper-Case MAC address `47DCC01E8C1FE7754757A5DC66C0F42F`\n\nURI to C2 `/test2/get.php?pid=47DCC01E8C1FE7754757A5DC66C0F42F&first=true`\n\n_Table 23: MAC address and the MD5._\n\nThe C2 responds with the public key (in PEM format) and an ID, which are used to encrypt data on the victim’s machine,\nas shown in Table 24.\n\nPublic key `-----BEGIN PUBLIC KEY-----`\n```\n              MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA6JEknb6TuNDTbonXuuYh\n              CTRFX7lNuPCxDginS/SMfGylj7Qa4owA93G5pDCVkX0E/8eIglTTI3NzG/P/cKnB\n              8uBLmIQwNx7ecIv/ocQYL/s8NzANLQzFeE7gHlj4vEUy3y6j/QMoCcbnTQnYQJlf\n              SelmzI7PXjzjVwPFtDJNj8PHFM8Gb3W0SjmVmgnlR7fm53rVfKqs6iR5hzKc3l+p\n              DvLuiETTWayHxE/qnzV3icIIjskXbRYb7t54OMTxEo/YuwlugHS0lqMJyC6BIlHx\n              yx36DUELMapEqHC+6kmfbFphErFGaqZjS0MXdqna8SDRiltJ7bRe/YjO3h7OZAxV\n              BwIDAQAB\n\n              -----END PUBLIC KEY----\n```\nID `JO5MSv2D5yx0SXq7qld0l0lmfLNSqkZDSk6Gi8nu`\n\n_Table 24: The public key and ID from the C2._\n\nHowever, even if the system is not connected to the internet and cannot retrieve the public key, it will still encrypt files [23]\nusing an offline key and ID hard coded inside the malware [24].\n\nThe STOP processes quietly perform background operations, and upon system restart, the STOP process starts with the\ncommand seen in the registry value in Table 22. This spawns a child process that performs encryption, as shown in\nFigure 6.\n\n|MAC address|52:54:00:4a:ad:11|\n|---|---|\n|Upper-Case MAC address|52:54:00:4A:AD:11|\n|MD5 of Upper-Case MAC address|47DCC01E8C1FE7754757A5DC66C0F42F|\n|URI to C2|/test2/get.php?pid=47DCC01E8C1FE7754757A5DC66C0F42F&first=true|\n\n|Public key|-----BEGIN PUBLIC KEY----- MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA6JEknb6TuNDTbonXuuYh CTRFX7lNuPCxDginS/SMfGylj7Qa4owA93G5pDCVkX0E/8eIglTTI3NzG/P/cKnB 8uBLmIQwNx7ecIv/ocQYL/s8NzANLQzFeE7gHlj4vEUy3y6j/QMoCcbnTQnYQJlf SelmzI7PXjzjVwPFtDJNj8PHFM8Gb3W0SjmVmgnlR7fm53rVfKqs6iR5hzKc3l+p DvLuiETTWayHxE/qnzV3icIIjskXbRYb7t54OMTxEo/YuwlugHS0lqMJyC6BIlHx yx36DUELMapEqHC+6kmfbFphErFGaqZjS0MXdqna8SDRiltJ7bRe/YjO3h7OZAxV BwIDAQAB -----END PUBLIC KEY-----|\n|---|---|\n|ID|JO5MSv2D5yx0SXq7qld0l0lmfLNSqkZDSk6Gi8nu|\n\n\n-----\n\n_Figure 6: STOP process tree after restart in ANY.RUN._\n\nIn Symphony No. 1, CrackedCantil, the extension ‘.hhaz’ was appended to the encrypted files, while in Symphony No. 3,\n_CrackedCantil [7], the extension ‘.ljaz’ was appended to the encrypted files._\n\nAdditionally, it adds a mutex to the end of the encrypted files [4], which follows the regex pattern ^\\{?[0-9a-fA-F]\n{8}-([0-9a-fA-F]{4}-){3}[0-9a-fA-F]{12}\\}?$ to signify that the file has been encrypted. Some examples of the encrypted\nfile contents are shown in Table 25.\n\n**File name** **Encrypted file contents**\n```\n   advancecurrency.rtf.hhaz {\\rtfN<S6G_L.MI<?%RP:m1#<C#U&nvrLy0sh\"N=_VlZ[i7\\.F7jO.\n\n                  hIK~)5e\"|lj?YDc=v+F%zID]>Dnv%UJnhz~M[Z$9&6/$w[\"Xu-.b*n\n\n                  z7.X lJO5kOLK%R[AUvT}+AbngS|tC!Npuvh^sMU-UT?IuH;)dG{}:\n\n                  w.+3>8X;F|X9\"zn$ Af[/i<&e=A\"EuW\\<R>u4_7;+HK[ifr {:U<,b\n\n                  t $g9u a|p )7K}7;XbKc\"ph3`c--J:!-tLak&@w9:_)0syIGmOU?’\n\n                  b5[#j?X#b(X sf$Zr`*<yfo82t7\n                  … osF%\\}%g(C7$J*H[J!>d};AsuPD’in9!8M(}%F#_wHUNY:[#/3O3\n\n                  9% =<bk)W?Y6g;eQTFZ<YF <MQW. KkA} ]% yO4e;$1 C=$ 3GGWa\n\n                  nlpnNs/!(h/o~+5IKa!)dtnXM`B5d=ditY)@f;jE4&~mSRosJO5MSv\n\n                  2D5yx0SXq7qld0l0lmfLNSqkZDSk6Gi8nu{36A698B9-D67C-4E07\n                  BE82-0EC5B14B4DF5}\n   donebutton.png.hhaz .PNG..C.......D.d...&(..........9...j.M.....ZQ...Y>g.).\n\n                  .Yb.q.s~...e.tU)..sm,t{....w....@.e..6....2vN...9......\n\n                  ....X.M.....0*.B%....0{.b.o..^z.Lb.6...V.!O.}..P.Z..7jb\n\n                  ....H!..>.3....$Z............\\=..N..>....8...b.,.....h.\n\n                  X[.u..s.^...UN...~.O........b.. .^c..%.%L!...{..z<i\"..T\n\n                  _G...u1]...8....~9d.ZFu.;B.Us...5..<.o...FO..S.f.?..-..\n\n                  .<]..X....=.....7}=_’......D.B...h.Gl...;t\".;;.}..*..1.\n\n                  ..3?{g.’.S1.E...2..){.oo.....N.......V.u.O.....f.v.P..<\n\n                  ...x.e.P.../..NI...Mi..P...L._@......)q......a....\"....Y\n                  …\n                  ..sK.....^.{.ei.....9.......|_l...z.^7WX.4.G...Fcp.p.C0\n\n                  .........:.......N#H.^......+....0........wq..E...&.Pd.\n\n                  .=..g.mRn\\..n.I.........EO....+>.*...T..S..M...-u,.P.rF\n\n                  ......._..J..g$YV...............-...B7V....B..w...!.yC.\n\n                  ....Gyw|.?]...eL..../...4...X..f..w.(.}0...N!)...{e._.9\n\n                  .JO5MSv2D5yx0SXq7qld0l0lmfLNSqkZDSk6Gi8nu{36A698B9-D67C\n\n                  -4E07-BE82-0EC5B14B4DF5}\n\n```\n_Table 25: Examples of the encrypted file contents (truncated)._\n\nThese mutex patterns are hard coded inside the STOP ransomware [24] and examples are shown in Table 26. In Symphony\n_No. 1, CrackedCantil STOP uses Mutex 3._\n\nMutex 1 `{1D6FC66E-D1F3-422C-8A53-C0BBCF3D900D}`\n\nMutex 2 `{FBB4BCC6-05C7-4ADD-B67B-A98A697323C1}`\n\nMutex 3 `{36A698B9-D67C-4E07-BE82-0EC5B14B4DF5}`\n\n_Table 26: Examples of known mutexes for STOP._\n\nPreviously, the ensemble of infostealers had stolen a wide array of sensitive information before the STOP ransomware\nencrypted the files. In the STOP ransom note, there was no mention of the fact that the attackers had stolen the sensitive\ndata, nor was there a threat to release it, as shown in Figure 7. Whereas ransomware like LockBit explicitly states in its\nransom note that the sensitive information will be published if the ransom is not paid, as shown in Figure 8 [25].\n\nThis suggests that the intent of the CrackedCantil symphony was not ‘double extortion’ for ransom, but rather to steal and\nexploit the victim’s sensitive data, maximize damage to the device, and simultaneously hijack its resources.\n\n|File name|Encrypted file contents|\n|---|---|\n|advancecurrency.rtf.hhaz|{\\rtfN<S6G_L.MI<?%RP:m1#<C#U&nvrLy0sh\"N=_VlZ[i7\\.F7jO. hIK~)5e\"|lj?YDc=v+F%zID]>Dnv%UJnhz~M[Z$9&6/$w[\"Xu-.b*n z7.X lJO5kOLK%R[AUvT}+AbngS|tC!Npuvh^sMU-UT?IuH;)dG{}: w.+3>8X;F|X9\"zn$ Af[/i<&e=A\"EuW\\<R>u4_7;+HK[ifr {:U<,b t $g9u a|p )7K}7;XbKc\"ph3`c--J:!-tLak&@w9:_)0syIGmOU?’ b5[#j?X#b(X sf$Zr`*<yfo82t7 … osF%\\}%g(C7$J*H[J!>d};AsuPD’in9!8M(}%F#_wHUNY:[#/3O3 9% =<bk)W?Y6g;eQTFZ<YF <MQW. KkA} ]% yO4e;$1 C=$ 3GGWa nlpnNs/!(h/o~+5IKa!)dtnXM`B5d=ditY)@f;jE4&~mSRosJO5MSv 2D5yx0SXq7qld0l0lmfLNSqkZDSk6Gi8nu{36A698B9-D67C-4E07- BE82-0EC5B14B4DF5}|\n|donebutton.png.hhaz|.PNG..C.......D.d...&(..........9...j.M.....ZQ...Y>g.). .Yb.q.s~...e.tU)..sm,t{....w....@.e..6....2vN...9...... ....X.M.....0*.B%....0{.b.o..^z.Lb.6...V.!O.}..P.Z..7jb ....H!..>.3....$Z............\\=..N..>....8...b.,.....h. X[.u..s.^...UN...~.O........b.. .^c..%.%L!...{..z<i\"..T _G...u1]...8....~9d.ZFu.;B.Us...5..<.o...FO..S.f.?..-.. .<]..X....=.....7}=_’......D.B...h.Gl...;t\".;;.}..*..1. ..3?{g.’.S1.E...2..){.oo.....N.......V.u.O.....f.v.P..< ...x.e.P.../..NI...Mi..P...L._@......)q......a....\"....Y … ..sK.....^.{.ei.....9.......|_l...z.^7WX.4.G...Fcp.p.C0 .........:.......N#H.^......+....0........wq..E...&.Pd. .=..g.mRn\\..n.I.........EO....+>.*...T..S..M...-u,.P.rF ......._..J..g$YV...............-...B7V....B..w...!.yC. ....Gyw|.?]...eL..../...4...X..f..w.(.}0...N!)...{e._.9 .JO5MSv2D5yx0SXq7qld0l0lmfLNSqkZDSk6Gi8nu{36A698B9-D67C -4E07-BE82-0EC5B14B4DF5}|\n\n|Mutex 1|{1D6FC66E-D1F3-422C-8A53-C0BBCF3D900D}|\n|---|---|\n|Mutex 2|{FBB4BCC6-05C7-4ADD-B67B-A98A697323C1}|\n|Mutex 3|{36A698B9-D67C-4E07-BE82-0EC5B14B4DF5}|\n\n\n-----\n\n_Figure 7: STOP’s ransom note in the CrackedCantil symphony._\n\n_Figure 8: An example of a LockBit ransom note._\n\n**CONCLUSION**\n\nThis paper introduced and defined the concept of a ‘malware symphony’. Through an in-depth analysis of Symphony No. 1,\n_CrackedCantil, numerous notorious malware families were observed operating in concert without conflict. They were_\norganized into distinct movements such as the Overture of the Loaders, Ensemble of the Infostealers, Chorale of the\n‘Otherware’, and the Finale of the Ransomware, collectively delivering a powerful infection.\n\nThe complexity and interconnectivity of these malicious processes underscore the necessity of a definition and framework\nlike the malware symphony to effectively categorize and analyse sophisticated multi-malware infections.\n\n\n-----\n\nBy clearly defining the structure of a malware symphony and introducing systematic naming conventions, this paper not\nonly enhances understanding of coordinated multi-malware infections but also sets the stage for improved defensive\nstrategies against complex threats in today’s ever-evolving threat landscape.\n\n**REFERENCES**\n\n[1] HyppÖnen, M. Retroviruses: How Viruses Fight Back. Virus Bulletin. June 1994. https://archive.org/details/\nMikko_Retroviruses_1994_06.\n\n[2] Xander. DDoS on Dyn The Complete Story. ServerComparator. 2016. https://web.archive.org/\nweb/20161121175123/https:/servercomparator.com/vpn/blog/dyn-mirai-ddos-complete-story.\n\n[3] YU, L. Reverse Engineering Snake Keylogger: Full .NET Malware Analysis Walkthrough. ANY.RUN Blog.\n25 March 2024. https://any.run/cybersecurity-blog/reverse-engineering-snake-keylogger/.\n\n[4] Yu, L. CrackedCantil: A Malware Symphony Breakdown. ANY.RUN Blog. 30 January 2024.\nhttps://any.run/cybersecurity-blog/crackedcantil-breakdown/.\n\n[5] ANY.RUN. Detonation of Symphony No. 1, “CrackedCantil”. ANY.RUN. 2023. https://app.any.run/\ntasks/7c196a3f-2132-4855-ac98-176fa600c299/.\n\n[6] ANY.RUN. Detonation of Symphony No. 2, “CrackedCantil”. ANY.RUN. 2023. https://app.any.run/\ntasks/35f3b5ee-9f88-43c7-8108-66a3e40a6fb1/.\n\n[7] ANY.RUN. Detonation of Symphony No. 3, “CrackedCantil”. ANY.RUN. 2023. https://app.any.run/tasks/\ncf3c45fc-62b6-47ff-baa4-98ea6af4e94a/.\n\n[8] Corbett, J. Software Piracy Law. LegalMatch. 2023. https://www.legalmatch.com/law-library/article/softwarepiracy.html.\n\n[9] Yu, L. A “strange font” Smishing Campaign that changes behaviour based on User-Agent, and abuses Duck DNS.\nSystem Weakness. 23 January 2023. https://medium.com/system-weakness/a-strange-font-smishing-that-changesbehaviour-based-on-user-agent-and-abuses-duck-dns-1c1a45863ff7.\n\n[10] VirusTotal. Get a URL for uploading large files. VTDoc. 2023.\n\nhttps://docs.virustotal.com/reference/files-upload-url.\n\n[11] Grelet, E. Unlicense. GitHub. 2023. https://github.com/ergrelet/unlicense.\n\n[12] ANY.RUN. Debugging CrackedCantil Inside Sandbox with FakeNet. ANY.RUN. 2024. https://app.any.run/tasks/\n\nb0f5bd2f-b268-4131-bbf8-b34a69b855b3/.\n\n[13] Yu, L. Malware Analysis Scripts. Github. 2024. https://github.com/LambdaMamba/LenaMalwareAnalysis.\n\n[14] Schwarz, D.; Stone-Gross, B. Peeking into PrivateLoader. ZScaler Blog. 28 April 2022. https://www.zscaler.jp/\n\nblogs/security-research/peeking-privateloader.\n\n[15] VK. What is VK. VK. 2023. https://vk.company/en/company/about/.\n\n[16] ANY.RUN. Investigating PrivateLoader’s File Naming Mechanisms. ANY.RUN. 2024. https://app.any.run/\n\ntasks/813e1907-7ec2-4006-9d35-69548cf53e4e/.\n\n[17] Lin, C. Deceptive Cracked Software Spreads Lumma Variant on YouTube. Fortinet Blog. 8 January 2024.\n\nhttps://www.fortinet.com/blog/threat-research/lumma-variant-on-youtube.\n\n[18] Palazolo, G. RedLine Stealer Campaign Using Binance Mystery Box Videos to Spread GitHub-Hosted Payload.\n\nNetskope. 12 May 2022. https://www.netskope.com/blog/redline-stealer-campaign-using-binance-mystery-boxvideos-to-spread-github-hosted-payload.\n\n[19] ANY.RUN. Detonation of Amadey, 5RfuRxo3fpxiWkD42DRCixRe.exe. ANY.RUN. 2024. https://app.any.run/\n\ntasks/cdccf208-83b2-4de5-8709-3f383578d6f7/.\n\n[20] Splunk Research Team. Amadey Threat Analysis and Detections. Splunk Blog. 25 July 2023.\n\nhttps://www.splunk.com/en_us/blog/security/amadey-threat-analysis-and-detections.html.\n\n[21] Bourgue, Q.; Le Bourhis, P. Stealc: a copycat of Vidar and Raccoon infostealers gaining in popularity. Sekoia Blog.\n\n20 February 2023. https://blog.sekoia.io/stealc-a-copycat-of-vidar-and-raccoon-infostealers-gaining-in-popularitypart-1/.\n\n[22] Kerner, S. M. Double Extortion Ransomware. TechTarget. 2023. https://www.techtarget.com/searchsecurity/\n\ndefinition/double-extortion-ransomware.\n\n[23] ANY.RUN. Detonation of STOP, TzjwSXczmD2hOVANbz7L7Roc.exe. ANY.RUN. 2024. https://app.any.run/\n\ntasks/2ed30ac4-23e6-437f-b40d-4e076b961f4a.\n\n\n-----\n\n[24] BlackBerry Research Team. DJVU: The Ransomware That Seems Strangely Familiar. BlackBerry Blog.\n\n29 September 2022. https://blogs.blackberry.com/en/2022/09/djvu-the-ransomware-that-seems-strangely-familiar.\n\n[25] ANY.RUN. Detonation of LockBit, LB3.exe. ANY.RUN. 2024. https://app.any.run/tasks/f14ec820-e62c-4c1e\n9e6e-4362f731817d.\n\n[26] Ciccarelli, M. Going Deep | A Guide to Reversing Smoke Loader Malware. SentinelOne Blog. 21 November 2019.\n\nhttps://www.sentinelone.com/blog/going-deep-a-guide-to-reversing-smoke-loader-malware/.\n\n**APPENDIX**\n\n|APPENDIX|Col2|Col3|\n|---|---|---|\n|File name|Description|SHA256|\n|release.rar|Password protected archive file from Google Groups Password is ‘1234’|B6B19302DBAAF3D352C4636CC1925AD77328 6C3BB2269D3DFC834F62391327F0|\n|setup.exe|CrackedCantil executable inside release.rar Protected with Themida and VMProtect|06D285910B40B90B3C2A8454A486B0AC6269 8228C13A9ACCBEF9BF2DF9E80C6F|\n|CrackedCantil.exe|Unpacked CrackedCantil executable|B62D780351C14753D7005F6B7860DF3B8D6C 0133C465C36172D91235086AD90A|\n|vvlbVE_a1T9mi81qLqDvAjYH.exe|Smoke Loader injector executable|66FE490D91A149A12DBF8764DC582A94FAEA C75C812EC8268E294ADAFF6FD5AA|\n|3Pvvg68HWOfBwJ9BdOsWgpEz.exe|RisePro executable|183181709ACEA935FA0E22BCAE4C80D05D09 0283ADA960A0A386AA930C588ED9|\n|Iq4tpcuftnMe73YjwlKR3YVy.exe|RisePro executable|1401ECA0A99D34975A5C7DF0245FE287C76C 40535C7AA17536F2C45058DA94FC|\n|5RfuRxo3fpxiWkD42DRCixRe.exe|Amadey executable|919AE827FF59FCBE3DBAEA9E62855A4D2769 0818189F696CFB5916A88C823226|\n|hzQj407t3pAeMkmtH8lxdDg1.exe|Stealc executable|65FCF2BAC887D16FE2D281C53EFAA770C73F 7E32A2862024CC21F9680EE9EFE9|\n|DTPanelQT.exe|Socks5systemz executable|6DB539F1C4957EDE89A7A7CFCD0D30AFCD89 7B6A1A66D84DE7E8A8A91BB90EDD|\n|TzjwSXczmD2hOVANbz7L7Roc.exe|STOP executable|2DCB65F18EE5FF985D4448C2BC01ECFF8C1E 379D969EF09591789DDE8DD1D534|\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "bf5be533-fa31-4590-ae37-5761c97ffa34",
            "created_at": "2022-10-25T16:13:58.389257Z",
            "updated_at": "2022-10-25T16:13:58.389257Z",
            "deleted_at": null,
            "name": "Malpedia",
            "url": "https://malpedia.caad.fkie.fraunhofer.de",
            "description": "Malpedia is a free service offered by Fraunhofer FKIE",
            "reports": null
        }
    ],
    "references": [
        "https://www.virusbulletin.com/uploads/pdf/conference/vb2024/papers/CrackedCantil-a-malware-symphony-delivered-by-cracked-software-performed-by-loaders-infostealers-ransomware-et-al.pdf"
    ],
    "report_names": [
        "CrackedCantil-a-malware-symphony-delivered-by-cracked-software-performed-by-loaders-infostealers-ransomware-et-al.pdf"
    ],
    "threat_actors": [
        {
            "id": "d90307b6-14a9-4d0b-9156-89e453d6eb13",
            "created_at": "2022-10-25T16:07:23.773944Z",
            "updated_at": "2025-03-27T02:02:09.974695Z",
            "deleted_at": null,
            "main_name": "Lead",
            "aliases": [
                "Casper",
                "TG-3279"
            ],
            "source_name": "ETDA:Lead",
            "tools": [
                "Agentemis",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "RbDoor",
                "RibDoor",
                "Winnti",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "f9bc28d0-ce98-4991-84ae-5036e5f9d4e3",
            "created_at": "2022-10-25T16:07:24.546437Z",
            "updated_at": "2025-03-27T02:02:10.277573Z",
            "deleted_at": null,
            "main_name": "Roaming Mantis",
            "aliases": [
                "Roaming Mantis Group",
                "Shaoye"
            ],
            "source_name": "ETDA:Roaming Mantis",
            "tools": [
                "MoqHao",
                "Roaming Mantis",
                "SmsSpy",
                "Wroba",
                "XLoader"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "c94cb0e9-6fa9-47e9-a286-c9c9c9b23f4a",
            "created_at": "2023-01-06T13:46:38.823793Z",
            "updated_at": "2025-03-27T02:00:02.928254Z",
            "deleted_at": null,
            "main_name": "Roaming Mantis",
            "aliases": [
                "Roaming Mantis Group"
            ],
            "source_name": "MISPGALAXY:Roaming Mantis",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1733796337,
    "ts_updated_at": 1743041404,
    "ts_creation_date": 1727445519,
    "ts_modification_date": 1727445520,
    "files": {
        "pdf": "https://archive.orkl.eu/6ad3180982e7042ac76b286b408ead73d77e2415.pdf",
        "text": "https://archive.orkl.eu/6ad3180982e7042ac76b286b408ead73d77e2415.txt",
        "img": "https://archive.orkl.eu/6ad3180982e7042ac76b286b408ead73d77e2415.jpg"
    }
}