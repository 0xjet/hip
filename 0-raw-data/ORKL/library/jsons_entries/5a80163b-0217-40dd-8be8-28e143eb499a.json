{
    "id": "5a80163b-0217-40dd-8be8-28e143eb499a",
    "created_at": "2023-01-12T14:59:58.045462Z",
    "updated_at": "2025-03-27T02:06:05.186232Z",
    "deleted_at": null,
    "sha1_hash": "20b0d54972d35c677eca1554e10d678004c8a9c0",
    "title": "2022-05-16 - HTML attachments in phishing e-mails",
    "authors": "",
    "file_creation_date": "2022-05-27T23:15:40Z",
    "file_modification_date": "2022-05-27T23:15:40Z",
    "file_size": 1347174,
    "plain_text": "# HTML attachments in phishing e-mails\n\n**[securelist.com/html-attachments-in-phishing-e-mails/106481/](https://securelist.com/html-attachments-in-phishing-e-mails/106481/)**\n\nAuthors\n\n[Roman Dedenok](https://securelist.com/author/romandedenok/)\n\nThe use of embedded HTML documents in phishing e-mails is a standard technique\nemployed by cybercriminals. It does away with the need to put links in the e-mail body, which\nantispam engines and e-mail antiviruses usually detect with ease. HTML offers more\npossibilities than e-mail for camouflaging phishing content.\n\nThere are two main types of HTML attachments that cybercriminals use: HTML files with a\nlink to a fake website or a full-fledged phishing page. In the first case, the attackers can not\nonly hide a link in the file, but also automatically redirect the user to the fraudulent site when\nthey open this file. The second type of HTML attachment makes it possible to skip creating\nthe website altogether and save on hosting costs: the phishing form and the script that\nharvests the data are embedded directly in the attachment. In addition, an HTML file, like an\ne-mail, can be modified according to the intended victim and attack vector, allowing for more\npersonalized phishing content.\n\n\n-----\n\n**_Fig.1. Example e-mail with an HTML attachment_**\n\n## Structure of phishing HTML attachments\n\nPhishing elements in HTML attachments are usually implemented using JavaScript, which\nhandles redirecting the user to a phishing site or collecting and sending credentials to\nscammers.\n\n\n-----\n\n**_Fig. 2. Phishing HTML page and its source code_**\n\nTypically, the HTML page sends data to a malicious URL specified in the script. Some\nattachments consist entirely (or mostly) of a JS script.\n\nIn the e-mail source code, the HTML attachment looks like plain text, usually Base64encoded.\n\n\n-----\n\n**_Fig. 3. HTML attachment in e-mail source code_**\n\nIf a file contains malicious scripts or links in plaintext, the security software can quickly parse\nand block it. To avoid this, cybercriminals resort to various tricks.\n\n## JavaScript obfuscation\n\n\n-----\n\nJavaScript obfuscation is one of the most common techniques used to disguise HTML\nattachments. To prevent the URL in the file from being quickly spotted and blocked, phishers\nobfuscate either the phishing link itself or the entire script, and sometimes the whole HTML\nfile. In some cases, cybercriminals obfuscate the code manually, but often they use ready[made tools, of which many are freely available, such as JavaScript Obfuscator.](https://github.com/javascript-obfuscator/javascript-obfuscator)\n\nFor example, opening the HTML attachment in the phishing e-mail supposedly from HSBC\nBank (see Fig. 1) in a text editor, we see some pretty confusing JS code, which, it would\nseem, hints neither at opening a link nor at any other meaningful action.\n\n**_Fig. 4. Example of obfuscation in an HTML attachment_**\n\nHowever, it actually is an obfuscated script that redirects the user to a phishing site. To\ndisguise the phishing link, the attackers used a ready-made tool, allowing us to easily\ndeobfuscate the script.\n\n**_Fig. 5. Deobfuscated script from an attachment in an e-mail seemingly from HSBC_**\n**_Bank: link for redirecting the user_**\n\nIf a script, link, or HTML page is obfuscated manually, it is much harder to restore the original\ncode. To detect phishing content in such a file, dynamic analysis may be required, which\ninvolves running and debugging the code.\n\n## Encoding\n\nSometimes attackers use more interesting methods. In one phishing e-mail, for instance, we\nfound an unusual HTML attachment. As in the example above, it contained JavaScript.\nBecause the code was so compact, one might think it was doing the same as the code in the\nfake HSBC e-mail — that is, redirecting the user to a phishing site. But upon running it, we\nfound a full-fledged phishing page encoded in this small script.\n\n\n-----\n\n**_Fig. 6. HTML file using the unescape() method — the source code of the file contains_**\n**_only five lines, one of which is empty_**\n\n**_Fig. 7. Phishing page in the HTML attachment_**\n\nThe cybercriminals used an interesting trick that involves the deprecated JS method\nunescape(). This method substitutes the “%xx” character sequences with their ASCII\nequivalents in the string that is passed to it. Running the script and viewing the source code\nof the resulting page, we see plain HTML.\n\n\n-----\n\n**_Fig. 8. The resulting HTML file_**\n\nInstead of unescape(), JavaScript now uses the decodeURI() and decodeURIComponent()\nmethods, yet most modern browsers still support unescape(). We cannot say for sure why\nthe attackers chose a deprecated method, but it could be because modern methods are\nmore likely to be interpreted and detected by antispam engines.\n\n## Statistics\n\nIn the first four months of 2022, Kaspersky security solutions detected nearly 2 million emails containing malicious HTML attachments. Nearly half of them (851,328) were detected\nand blocked in March. January was the calmest month, with our antispam solutions detecting\n299,859 e-mails with phishing HTML attachments.\n\n_Number of detected e-mails with malicious HTML attachments, January–April 2022_\n_[(download)](https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2022/05/13160645/01-en-html-attachments.png)_\n\n## Conclusion\n\nPhishers deploy a variety of tricks to bypass e-mail blocking and lure as many users as\npossible to their fraudulent sites. A common technique is HTML attachments with partially or\nfully obfuscated code. HTML files allow attackers to use scripts, obfuscate malicious content\nto make it harder to detect, and send phishing pages as attachments instead of links.\n\nKaspersky security solutions detect HTML attachments containing scripts regardless of\nobfuscation.\n\n\n-----\n\n[HTML](https://securelist.com/tag/html/)\n[Phishing](https://securelist.com/tag/phishing/)\n[Spam Letters](https://securelist.com/tag/spam-letters/)\n[Spammer techniques](https://securelist.com/tag/spammer-techniques/)\n\nAuthors\n\n[Roman Dedenok](https://securelist.com/author/romandedenok/)\n\nHTML attachments in phishing e-mails\n\nYour email address will not be published. Required fields are marked *\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-05-16 - HTML attachments in phishing e-mails.pdf"
    ],
    "report_names": [
        "2022-05-16 - HTML attachments in phishing e-mails.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673535598,
    "ts_updated_at": 1743041165,
    "ts_creation_date": 1653693340,
    "ts_modification_date": 1653693340,
    "files": {
        "pdf": "https://archive.orkl.eu/20b0d54972d35c677eca1554e10d678004c8a9c0.pdf",
        "text": "https://archive.orkl.eu/20b0d54972d35c677eca1554e10d678004c8a9c0.txt",
        "img": "https://archive.orkl.eu/20b0d54972d35c677eca1554e10d678004c8a9c0.jpg"
    }
}