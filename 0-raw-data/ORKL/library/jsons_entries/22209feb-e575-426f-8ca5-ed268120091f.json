{
    "id": "22209feb-e575-426f-8ca5-ed268120091f",
    "created_at": "2023-01-12T15:05:20.46335Z",
    "updated_at": "2025-03-27T02:17:11.50813Z",
    "deleted_at": null,
    "sha1_hash": "be22a1636792c943dfad09f340b09bf3f2470591",
    "title": "2020-06-24 - Glupteba - the malware that gets secret messages from the Bitcoin blockchain",
    "authors": "",
    "file_creation_date": "2022-05-27T23:27:44Z",
    "file_modification_date": "2022-05-27T23:27:44Z",
    "file_size": 602242,
    "plain_text": "# Glupteba – the malware that gets secret messages from the Bitcoin blockchain\n\n**[nakedsecurity.sophos.com/2020/06/24/glupteba-the-bot-that-gets-secret-messages-from-the-bitcoin-blockchain/](https://nakedsecurity.sophos.com/2020/06/24/glupteba-the-bot-that-gets-secret-messages-from-the-bitcoin-blockchain/)**\n\nBy Paul Ducklin 24 Jun 2020\n\n[Here’s a SophosLabs technical paper that should tick all your jargon boxes!](https://news.sophos.com/wp-content/uploads/2020/06/glupteba_final.pdf)\n\nOur experts have deconstructed a strain of malware called Glupteba that uses just about\nevery cybercrime trick you’ve heard of, and probably several more besides.\n\nLike a lot of malware these days. Glupteba is what’s known a [zombie or bot (short for](https://nakedsecurity.sophos.com/2014/10/31/how-bots-and-zombies-work/)\n_[software robot) that can be controlled from afar by the crooks who wrote it.](https://nakedsecurity.sophos.com/2014/10/31/how-bots-and-zombies-work/)_\n\nBut it’s more than just a remote control tool for criminals, because Glupteba also includes a\nrange of components that let it serve as all of the following:\n\n**A rootkit. Glupteba includes a variety of Windows kernel drivers that can hide the**\n[existence of specific files and processes. Kernel rootkits are unusual these days](https://nakedsecurity.sophos.com/2014/11/10/notes-from-sophoslabs-on-the-trail-of-rootkits-and-other-malware/)\nbecause they’re complex to write and often draw unnecessary attention to themselves.\nHowever, if loaded successfully, rootkits can help cybersecurity threats lie low by\nkeeping malware files off the radar of security tools and stopping them from showing up\nin security logs.\n\n\n-----\n\n**A security suppresor. Glupteba has a module that does its best to turn Windows**\nDefender off, and then regularly checks to make sure it hasn’t turned itself back on. It\nalso looks for a laundry list of other security tools, including anti-virus software and\nsystem monitoring programs, killing them off so they can no longer search for and\nreport anomalies.\n**[A virus. Glupteba uses two different variants of the ETERNALBLUE exploit to](https://nakedsecurity.sophos.com/2017/08/15/fancy-bear-bites-hotel-networks-as-eternalblue-mystery-deepens/)**\ndistribute itself automatically across your own network, and anyone else’s it can find by\nreaching out from your computer. That makes it an old-school, self-spreading computer\n[virus (or more specifically a worm) rather than just a standalone piece of malware.](https://nakedsecurity.sophos.com/2013/11/02/memories-of-the-internet-worm-25-years-later/)\n**A router attack tool. Glupteba bundles in various exploits against popular home and**\nsmall business routers, using your computer as a jumping off point to attack other\n[people. It uses one of these attacks to open up unpatched routers to act as network](https://nakedsecurity.sophos.com/2018/10/08/unpatched-routers-bad-doubly-unpatched-routers-worse-much-much-worse/)\nproxies that the crooks can use as “jumping off” points for future attacks. This leaves\nthe unfortunate victim looking like an attacker themselves and showing up as an\napparent source of cybercriminal activity.\n**A browser stealer. Glupteba goes after local data files from four different browsers –**\nChrome, Firefox, Yandex and Opera – and uploads them to the crooks. Browser files\noften contain sensitive information such as URL history, authentication cookies, login\ndetails and even passwords that can’t be accessed by code such as JavaScript running\ninside the browser. So crooks love to attack your browser from outside, where the\nbrowser isn’t in control.\n**A cryptojacker. Along with everything else it does, Glupteba can act as a secretive**\nmanagement tool for two different cryptomining tools. Cryptominers are legal if you use\n[them with the explicit permission of the person paying the electricity bills to run the](https://nakedsecurity.sophos.com/2018/09/27/cryptojacking-coming-to-a-server-laptop-phone-near-you-and-how-to-stop-it/)\ncomputers you’re using (and cryptomining can consume a lot of power). Here, the\ncrooks get you to pay their power bills and take the cryptocoins for themselves.\n\n## There’s more – much more\n\nBut that’s not all.\n\nThe most interesting feature that we learned about in the report (and we think you’ll be\nfascinated too) is how Glupteba uses the Bitcoin blockchain as a communication channel for\nreceiving updated configuration information.\n\nAs you probably know, zombies or bots aren’t much use to the crooks if they can’t call home\nto get their next wave of instructions.\n\n\n-----\n\nGlupteba has a long list of built-in malicious commands that the crooks can trigger, including\nthe self-explanatory `update-data and` `upload-file commands that are detailed in the`\nreport. But it also includes, as with most bots, generic commands to `download and` `run`\nnew malware, meaning that even if you know everything about Glupteba itself, you can’t\npredict what it might morph into next because the crooks can update the running malware at\nwill.\n\nThe current command-and-control servers used by the crooks, known as C2 servers or\nC&Cs, might get found out and blocked or killed off at any moment, so zombie malware often\nincludes a method for using an otherwise innocent source of data for updates.\n\nAfter all, to tell a bot to switch from one C&C server to another, you typically don’t need to\nsend out much more than new domain name or IP number, and there are lots of public\nmessaging systems that make it easy to share short snippets of data like that.\n\nFor example, bots have used services such as Twitter, Reddit, Pastebin and other public\nwebsites as temporary storage for secret messages, in the same way that spies from the\nCold War era might have communicated using the “Personals” section in a print newspaper.\n\n## Bring on the blockchain\n\nGlupteba uses the fact that the Bitcoin transactions are recorded on the Bitcoin blockchain,\nwhich is a public record of transactions available from a multitude of sources that are\nunexceptionably accessible from most networks.\n\nBitcoin “transactions” don’t actually have to be about money – they can include a field called\n```\nRETURN, also known as OP_RETURN, that is effectively a comment of up to 80 characters.\n\n```\nLet’s start with a list of all the Bitcoin transaction hashes (lightly redacted) associated with\none of the Bitcoin wallets used as a covert source of messages by Glupteba.\n\nThe wallet ID shown here was extracted from the malware by SophosLabs.\n\nThe command line program `bx below is a popular and useful Bitcoin blockchain explorer`\ntool:\n\n\n-----\n\n```\n$ bx fetch history 15y7......qNHXRtu5wzBpXdY5mT4RZNC6 | awk $1  hash { print $2\n}'\ndfef43552fc953ff14ca7b7bb........b79e8409b5638d4f83b1c5cec0abc3d\n98987c05277c97b06edfc030c........07e74334c203075ec27b44b3cc458bf\n717da8bea87d02ef62b1806cf........7e01f0267718f0351f9ae1592e02703\n20b37b655133491b94a8021ab........0266d15331a14caf10570b6623a86e4\nfa9cd0622535cf6c9ff449510........c5d526d5794d9d98ba5d6469a97be2c\n0d83cbc74a12a9f130fcead23........d5d56cf769c6c0a4cf1cebbf9e97e4a\na7fb3bb04b82922923e8359f8........3db69bd2863ec88b98f9c69a37212ad\n52ee10617c1fc3e25922b146a........7daefdc3c3d5421b0387a737e46b396\nf29cbbb96de80dbc7e5236c98........3da6f8118bb356f537ce0317f7ab10c\n6a3a720ab97511528309fbf64........f37bc25d95d45d3408540174daad786\n8bf7acc56aab4b87d73a85b46........1486f0a764fd0a5f13e2d79e0a14625\n3bd54c0832cc411f5299064e4........c11ab05c1a4aff62fa323c068e88945\n1e1c0249bb22d1fcfb596e4fb........df7ab3bf627e25a2fe9530eb3dce476\n51899ffeadf5d0d605d5122c3........5b82baa15a4fa6b203abf59731c158f\n8a7c43d0bbf01cdf3bb28de48........6e339a063251fce30cb83ae50c2096a\n55e8fe62bcc41ec465c3f1f28........f5d82443a15a30d88fefc3f55ad2f29\n\n```\nIf we fetch the details of each of these transactions, we can see which ones include\n```\nOP_RETURN data.\n\n```\nHere’s a transaction dump for one that does, truncated to save space:\n```\n$ bx fetch-tx 55e8fe62bcc41ec465c3f1f28........f5d82443a15a30d88fefc3f55ad2f29\n{\n  hash 98987c05277c97b06......1ce207e74334c203075ec27b44b3cc458bf\n  inputs\n  {\n    input\n    {\n[ . . . . . . . . . ]  \n    output\n    {\n      script \"return\n[18fe788a52d7aa57808d801d0f8f7cd39e1a......9f986b877befce0c2f558f0c1a9844833ac702cb3eb\n[ . . . . . . . . . ]      \n      value 0\n    }\n  }\n[ . . . . . . . . . ] \n\n```\nThe bytes in the `OP_RETURN data shown above are the secret message.`\n\nTo decrypt it, you need a 256-bit AES decryption key that’s coded into the the Glupteba\n[malware program (you can find the keys in the SophosLabs paper), and you need to know](https://news.sophos.com/wp-content/uploads/2020/06/glupteba_final.pdf)\nthat the data returned in the blockchain consists of:\n```\nFirst 12 bytes  = AES-256-GCM initialisation vector\nLast 16 bytes  = AES-256-GCM authentication tag\nBytes in between = Encrypted message (bytes from 0f8f7cd3... to ...877befce)\n\n```\n\n-----\n\nDecrypt the data from the blockcode to reverse the AES-256-GCM encryption, and you ll\nreveal the hidden message.\n\n[This sort of “hiding in plain sight” is often referred to as steganography.](https://nakedsecurity.sophos.com/2018/11/15/steganography-cool-cybersecurity-trick-or-dangerous-risk-video/)\n\nHere’s some pseudocode to give you the idea:\n```\n  > cipher = newcipher('AES-256-GCM')\n  > cipher.key = d8727a0e...d66503cf        // extracted by SophosLabs\n  > cipher.iv = 18fe788a52d7aa57808d801d     // GCM mode needs an IV\n  > cipher.tag = 0c2f558f0c1a9844833ac702cb3eba6e // GCM mode needs a message hash\n  > plain = cipher:decrypt(0f8f7cd39e1a......9f986b877befce)\n  > print('secret message is: ',plain)\n  secret message is: venoco___ol.com        // see report for full IoC list\n                          // this is a new C&C server to\nmove to\n\n```\nAnd that’s how Glupteba hides its command-and-control server names in plain sight!\n\n## How bad is it?\n\nThe bad news about Glupteba is that its many self-protection components mean that it has\nmany tricks available to stop itself showing up in your security logs.\n\nThe good news is that this complexity makes the malware less reliable, and ironically more\nprone to triggering security alarms at some point.\n\nIndeed, some of the low-level programming tricks it uses, including the kernel-level rootkits,\nnot only don’t work on recent versions of Windows, but also often draw attention to\nthemselves by the way they misbehave, up to and including crashing your computer with a\ngiveaway blue screen of death.\n\nAlso, Glupteba relies on numerous exploits that were patched many months or years ago –\nincluding the attacks it uses against routers – so a patched system is much less likely to get\ninfected in the first place.\n\nLastly, the main delivery mechanism we’re aware of so far that brings infections of Glupteba\ninto a network (assuming you are patched against ETERNALBLUE and can’t get infected by\nits viral component), seems to be via “software cracks” on well-known piracy sites.\n\nLike this one:\n\n\n-----\n\nThis crack didn’t lead to Adobe Illustrator.\nIt led to a Glupteba infection.\n\n## What to do?\n\n**Patch early, patch often. That includes your operating system, the apps you use, and**\nany devices such as routers and file storage servers on your own network.\n**Use a decent anti-virus with built-in web filtering. Most malware, including zombie**\nmalware, arrives as a series of downloads. Even if you hit by get the first stage of\nmalware attack, you can still defeat the crooks if you stop the final payload arriving.\n**Stay away from hookey software. Assume that the sort of person who’s willing to**\nsteal software such as Adobe Illustrator and give away tools to crack it “for free” is also\nwilling to accept money from crooks to implant malware in their fraudulent downloads.\n\n\n-----\n\n**LEARN MORE ABOUT STEGANOGRAPHY**\n\nIf you enjoyed this article, why not watch one of our Naked Security Live videos in which we\ndiscuss the weird and wonderful world of steganography?\n\nWatch Video At:\n\nhttps://youtu.be/q2hD4v8_8-s\n\nYou can watch [directly on YouTube if the video won’t play here.](https://youtu.be/q2hD4v8_8-s)\n\nThe articles referenced in the video are:\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2020/2020-06-24 - Glupteba - the malware that gets secret messages from the Bitcoin blockchain.pdf"
    ],
    "report_names": [
        "2020-06-24 - Glupteba - the malware that gets secret messages from the Bitcoin blockchain.pdf"
    ],
    "threat_actors": [
        {
            "id": "f8dddd06-da24-4184-9e24-4c22bdd1cbbf",
            "created_at": "2023-01-06T13:46:38.626906Z",
            "updated_at": "2025-03-27T02:00:02.877001Z",
            "deleted_at": null,
            "main_name": "Tick",
            "aliases": [
                "Stalker Taurus",
                "PLA Unit 61419",
                "Nian",
                "BRONZE BUTLER",
                "REDBALDKNIGHT",
                "STALKER PANDA",
                "G0060"
            ],
            "source_name": "MISPGALAXY:Tick",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "e3767160-695d-4360-8b2e-d5274db3f7cd",
            "created_at": "2022-10-25T16:47:55.914348Z",
            "updated_at": "2025-03-27T02:05:17.411172Z",
            "deleted_at": null,
            "main_name": "IRON TWILIGHT",
            "aliases": [
                "ATK5 ",
                "Blue Athena ",
                "BlueDelta ",
                "FROZENLAKE ",
                "Fancy Bear ",
                "Fighting Ursa ",
                "Forest Blizzard ",
                "GRAPHITE ",
                "Group 74 ",
                "PawnStorm ",
                "STRONTIUM ",
                "Sednit ",
                "Snakemackerel ",
                "Sofacy ",
                "TG-4127 ",
                "Tsar Team ",
                "APT28 "
            ],
            "source_name": "Secureworks:IRON TWILIGHT",
            "tools": [
                " Downdelph",
                " Drovorub",
                " EVILTOSS",
                " HIDEDRV",
                " Headlace",
                " LoJack",
                " Powershell Empire",
                " SCONATO",
                " SEDUPLOADER",
                " SHARPFRONT",
                " Scaramouche",
                " Sedkit Exploit Kit",
                " Sofacy downloader",
                " X-Agent",
                " X-Tunnel",
                " Zebrocy",
                " reGeorg",
                "DEALERSCHOICE"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "730dfa6e-572d-473c-9267-ea1597d1a42b",
            "created_at": "2023-01-06T13:46:38.389985Z",
            "updated_at": "2025-03-27T02:00:02.821388Z",
            "deleted_at": null,
            "main_name": "APT28",
            "aliases": [
                "FROZENLAKE",
                "BlueDelta",
                "SNAKEMACKEREL",
                "TG-4127",
                "ITG05",
                "TA422",
                "Fancy Bear",
                "FANCY BEAR",
                "Sednit",
                "IRON TWILIGHT",
                "G0007",
                "Sofacy",
                "Forest Blizzard",
                "GruesomeLarch",
                "Pawn Storm",
                "Tsar Team",
                "STRONTIUM",
                "ATK5",
                "Blue Athena",
                "APT-C-20",
                "Group 74",
                "SIG40",
                "Grizzly Steppe",
                "Fighting Ursa",
                "T-APT-12",
                "UAC-0028"
            ],
            "source_name": "MISPGALAXY:APT28",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "ae320ed7-9a63-42ed-944b-44ada7313495",
            "created_at": "2022-10-25T15:50:23.671663Z",
            "updated_at": "2025-03-27T02:00:55.518748Z",
            "deleted_at": null,
            "main_name": "APT28",
            "aliases": [
                "APT28",
                "IRON TWILIGHT",
                "SNAKEMACKEREL",
                "Group 74",
                "Sednit",
                "Sofacy",
                "Pawn Storm",
                "Fancy Bear",
                "STRONTIUM",
                "Tsar Team",
                "Threat Group-4127",
                "TG-4127",
                "Forest Blizzard",
                "FROZENLAKE"
            ],
            "source_name": "MITRE:APT28",
            "tools": [
                "Wevtutil",
                "certutil",
                "Forfiles",
                "DealersChoice",
                "Mimikatz",
                "ADVSTORESHELL",
                "Komplex",
                "HIDEDRV",
                "JHUHUGIT",
                "Koadic",
                "Winexe",
                "XTunnel",
                "Drovorub",
                "CORESHELL",
                "OLDBAIT",
                "Downdelph",
                "XAgentOSX",
                "USBStealer",
                "Zebrocy",
                "Fysbis",
                "LoJax"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "d4e7cd9a-2290-4f89-a645-85b9a46d004b",
            "created_at": "2022-10-25T16:07:23.419513Z",
            "updated_at": "2025-03-27T02:02:09.790389Z",
            "deleted_at": null,
            "main_name": "Bronze Butler",
            "aliases": [
                "Bronze Butler",
                "CTG-2006",
                "Operation ENDTRADE",
                "RedBaldNight",
                "Stalker Panda",
                "Stalker Taurus",
                "TEMP.Tick",
                "Tick"
            ],
            "source_name": "ETDA:Bronze Butler",
            "tools": [
                "8.t Dropper",
                "8.t RTF exploit builder",
                "8t_dropper",
                "9002 RAT",
                "AngryRebel",
                "Blogspot",
                "Daserf",
                "Datper",
                "Elirks",
                "Farfli",
                "Gh0st RAT",
                "Ghost RAT",
                "HOMEUNIX",
                "HidraQ",
                "HomamDownloader",
                "Homux",
                "Hydraq",
                "Lilith",
                "Lilith RAT",
                "McRAT",
                "MdmBot",
                "Mimikatz",
                "Minzen",
                "Moudour",
                "Muirim",
                "Mydoor",
                "Nioupale",
                "PCRat",
                "POISONPLUG.SHADOW",
                "Roarur",
                "RoyalRoad",
                "ShadowPad Winnti",
                "ShadowWali",
                "ShadowWalker",
                "SymonLoader",
                "WCE",
                "Wali",
                "Windows Credential Editor",
                "Windows Credentials Editor",
                "XShellGhost",
                "XXMM",
                "gsecdump",
                "rarstar"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "bf0489c5-1c07-41e6-91c9-855ad96ccc6a",
            "created_at": "2022-10-25T16:47:55.541639Z",
            "updated_at": "2025-03-27T02:05:17.253496Z",
            "deleted_at": null,
            "main_name": "BRONZE BUTLER",
            "aliases": [
                "Daserf",
                "Stalker Panda ",
                "Tick ",
                "CTG-2006 "
            ],
            "source_name": "Secureworks:BRONZE BUTLER",
            "tools": [
                " DGet",
                " Daserf",
                " Datper",
                " Gofarer",
                " MSGet",
                " Mimikatz",
                " RarStar",
                " Screen Capture Tool",
                " ShadowPad",
                " T-SMB",
                " WinRAR",
                " Windows Credential Editor",
                " gsecdump",
                " xmm downloader",
                " xxmm",
                "ABK"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "d2516b8e-e74f-490d-8a15-43ad6763c7ab",
            "created_at": "2022-10-25T16:07:24.212584Z",
            "updated_at": "2025-03-27T02:02:10.141001Z",
            "deleted_at": null,
            "main_name": "Sofacy",
            "aliases": [
                "APT 28",
                "ATK 5",
                "Blue Athena",
                "BlueDelta",
                "FROZENLAKE",
                "Fancy Bear",
                "Fighting Ursa",
                "Forest Blizzard",
                "Grey-Cloud",
                "Grizzly Steppe",
                "Group 74",
                "GruesomeLarch",
                "ITG05",
                "Iron Twilight",
                "Operation DealersChoice",
                "Operation Dear Joohn",
                "Operation Komplex",
                "Operation Pawn Storm",
                "Operation Russian Doll",
                "Operation Steal-It",
                "Pawn Storm",
                "SIG40",
                "Sednit",
                "Snakemackerel",
                "Sofacy",
                "Strontium",
                "T-APT-12",
                "TA422",
                "TAG-0700",
                "TAG-110",
                "TG-4127",
                "Tsar Team",
                "UAC-0028",
                "UAC-0063"
            ],
            "source_name": "ETDA:Sofacy",
            "tools": [
                "ADVSTORESHELL",
                "AZZY",
                "Backdoor.SofacyX",
                "CHERRYSPY",
                "CORESHELL",
                "Carberp",
                "Computrace",
                "DealersChoice",
                "Delphacy",
                "Downdelph",
                "Downrage",
                "Drovorub",
                "EVILTOSS",
                "Foozer",
                "GAMEFISH",
                "GooseEgg",
                "Graphite",
                "HATVIBE",
                "HIDEDRV",
                "Headlace",
                "Impacket",
                "JHUHUGIT",
                "JKEYSKW",
                "Koadic",
                "Komplex",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "LoJack",
                "LoJax",
                "MASEPIE",
                "Mimikatz",
                "NETUI",
                "Nimcy",
                "OCEANMAP",
                "OLDBAIT",
                "PocoDown",
                "PocoDownloader",
                "Popr-d30",
                "ProcDump",
                "PythocyDbg",
                "SMBExec",
                "SOURFACE",
                "SPLM",
                "STEELHOOK",
                "Sasfis",
                "Sedkit",
                "Sednit",
                "Sedreco",
                "Seduploader",
                "Shunnael",
                "SkinnyBoy",
                "Sofacy",
                "SofacyCarberp",
                "SpiderLabs Responder",
                "Trojan.Shunnael",
                "Trojan.Sofacy",
                "USB Stealer",
                "USBStealer",
                "VPNFilter",
                "Win32/USBStealer",
                "WinIDS",
                "Winexe",
                "X-Agent",
                "X-Tunnel",
                "XAPS",
                "XTunnel",
                "Xagent",
                "Zebrocy",
                "Zekapab",
                "carberplike",
                "certutil",
                "certutil.exe",
                "fysbis",
                "webhp"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535920,
    "ts_updated_at": 1743041831,
    "ts_creation_date": 1653694064,
    "ts_modification_date": 1653694064,
    "files": {
        "pdf": "https://archive.orkl.eu/be22a1636792c943dfad09f340b09bf3f2470591.pdf",
        "text": "https://archive.orkl.eu/be22a1636792c943dfad09f340b09bf3f2470591.txt",
        "img": "https://archive.orkl.eu/be22a1636792c943dfad09f340b09bf3f2470591.jpg"
    }
}