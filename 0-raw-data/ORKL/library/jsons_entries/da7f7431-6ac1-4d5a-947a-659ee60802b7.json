{
    "id": "da7f7431-6ac1-4d5a-947a-659ee60802b7",
    "created_at": "2023-01-12T14:59:55.26453Z",
    "updated_at": "2025-03-27T02:16:59.181138Z",
    "deleted_at": null,
    "sha1_hash": "0241d5b61e322d5e6972ce2c223e89bbab9302fc",
    "title": "2016-10-27 - Mirai DDoS Botnet- Source Code & Binary Analysis",
    "authors": "",
    "file_creation_date": "2022-05-28T18:29:00Z",
    "file_modification_date": "2022-05-28T18:29:00Z",
    "file_size": 261847,
    "plain_text": "# Mirai DDoS Botnet: Source Code & Binary Analysis\n\n**[simonroses.com/2016/10/mirai-ddos-botnet-source-code-binary-analysis/](http://www.simonroses.com/2016/10/mirai-ddos-botnet-source-code-binary-analysis/)**\n\nBy Simon Roses October 27, 2016\n\nMirai is a DDoS botnet that has gained a lot of media attraction lately due to high impact\n[attacks such as on journalist Brian Krebs and also for one of the biggest DDoS attacks on](http://krebsonsecurity.com/)\nInternet against ISP [Dyn, cutting off a major chunk of Internet, that took place last weekend](http://dyn.com/blog/dyn-analysis-summary-of-friday-october-21-attack/)\n(Friday 21 October 2016).\n\nBesides the media coverage, Mirai is very interesting because we have both binary samples\ncaptured in the wild, but also because the source code was released recently – for sure we\ncan expect many variants of Mirai code soon. Having both binary and source code allows us\nto study it in more detail.\n\nIt is quite amazing that we are in 2016 and still talking about worms, default/weak passwords\n[and DDoS attacks: hello Morris Worm (1988) and Project Rivolta (2000) to mention a few.](https://en.wikipedia.org/wiki/Morris_worm)\n\n**Source Code Analysis**\n\nWe have compiled Mirai source code using our Tintorera, a VULNEX static analysis tool that\ngenerates intelligence while building C/C++ source code. This gives us the big picture fast.\n\nFrom Tintorera we get an application detail summary counting compiled files, lines of code,\ncomments, blanks and additional metrics; Tintorera also calculates the time needed to review\nthe code. Mirai is a small project and not too complicated to review. (Figure 1)\n\nFigure 1\n\nMirai is using several functions from the Linux API, mostly related to network operations.\n(Figure 2)\n\n\n-----\n\nFigure 2\n\nIn the Tintorera intelligence report we have a list of files, functions names, basic blocks,\ncyclomatic complexity, API calls and inline assembly used by Mirai. By examining this list we\ncan get an idea of the code. (Figure 3)\n\nFigure 3\n\nIn file killer.c there is a function named killer_init that kills several services: telnet (port 23),\nssh (port 22) and http (port 80) to prevent access to the compromised system by others.\n(Figure 4)\n\nFigure 4\n\n\n-----\n\nIn same file, killer.c, another function named memory_scan_match search memory for other\nLinux malwares. (Figure 5)\n\nFigure 5\n\nIn file scanner.c function named get_random_ip generates random IPs to attack while\navoiding a white list addresses from General Electric, Hewlett-Packard, US Postal Service\nand US Department of Defense. (Figure 6)\n\nFigure 6\n\nMirai comes with a list of 62 default/weak passwords to perform brute force attacks on IoT\ndevices. This list is setup in function scanner_init of file scanner.c. (Figure 7)\n\nFigure 7\n\n\n-----\n\nIn main.c file we can find the main function that prevents compromised devices to reboot by\nkilling watchdog and starts the scanner to attack other IoT devices. In Figure 8 we see a\ncallgraph of file main.c\n\nFigure 8\n\nMirai offers offensive capabilities to launch DDoS attacks using UDP, TCP or HTTP\nprotocols.\n\n**Binary Analysis**\n\nNow let’s move to binary analysis. So far we have been able to study 19 different samples\nobtained in the wild for the following architectures: x86, ARM, MIPS, SPARC, Motorola\n68020 and Renesas SH (SuperH).\n\n[For the binary analysis we have used VULNEX BinSecSweeper platform that allows](http://www.vulnex.com/en/binsecsweeper.html)\nanalyzing binaries among other things/files in depth combining SAST and Big Data.\n\nIn Figure 9 we see a chart showing all the files magic to give us an idea of the file types/\narchitectures. All samples are 32 bits.\n\nFigure 9\n\nBy using BinSecSweeper we obtained a lot of information for each sample, similarities\nbetween them and different vulnerabilities. Currently not many Antivirus identify all the\nsamples, so beware what Antivirus you use! In Figure 10 we have a visualization of file sizes\nin bytes.\n\n\n-----\n\nFigure 10\n\nWe analyzed all section names in the samples and Figure 11 is the result.\n\nFigure 11\n\nAs mentioned before the samples are for different architectures so in this post we are not\nshowing you the code analysis results.\n\nWe have updated BinSecSweeper analysis engine to identify Mirai malware samples. A full\n[binary analysis report is available from VULNEX Cyber Intelligence Services to our](http://www.vulnex.com/en/services.html)\n[customers, please visit our website or](http://www.vulnex.com/) [contact us.](http://10.10.0.46/mailto:services@vulnex.com)\n\n**Conclusions**\n\nDespite being a fairly simple code, Mirai has some interesting offensive and defensive\ncapabilities and for sure it has made a name for itself. Now that the source code has been\nreleased, it is just a matter of time we start seeing variants of Mirai.\n\nMirai Botnet is a wakeup call to IoT vendors to secure their devices. Unfortunately millions of\ndevices have been already deployed on Internet and there are insecure by default, so\nembrace yourself for more IoT attacks in the near future.\n\n**What do you think about IoT security?**\n\n— Simon Roses Femerling / Twitter @simonroses\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2016/2016-10-27 - Mirai DDoS Botnet- Source Code & Binary Analysis.pdf"
    ],
    "report_names": [
        "2016-10-27 - Mirai DDoS Botnet- Source Code & Binary Analysis.pdf"
    ],
    "threat_actors": [
        {
            "id": "a97cf06d-c2e2-4771-99a2-c9dee0d6a0ac",
            "created_at": "2022-10-25T16:07:24.349252Z",
            "updated_at": "2025-03-27T02:02:10.184406Z",
            "deleted_at": null,
            "main_name": "Turla",
            "aliases": [
                "ATK 13",
                "Belugasturgeon",
                "Blue Python",
                "CTG-8875",
                "Group 88",
                "ITG12",
                "Iron Hunter",
                "Krypton",
                "Makersmark",
                "Operation Epic Turla",
                "Operation Moonlight Maze",
                "Operation Penguin Turla",
                "Operation Satellite Turla",
                "Operation Skipper Turla",
                "Operation Turla Mosquito",
                "Operation WITCHCOVEN",
                "Pacifier APT",
                "Pensive Ursa",
                "Popeye",
                "SIG15",
                "SIG2",
                "SIG23",
                "Secret Blizzard",
                "TAG-0530",
                "Turla",
                "UNC4210",
                "Venomous Bear",
                "Waterbug"
            ],
            "source_name": "ETDA:Turla",
            "tools": [
                "ASPXSpy",
                "ASPXTool",
                "ATI-Agent",
                "AdobeARM",
                "Agent.BTZ",
                "Agent.DNE",
                "BigBoss",
                "COMpfun",
                "Chinch",
                "Cloud Duke",
                "CloudDuke",
                "CloudLook",
                "Cobra Carbon System",
                "ComRAT",
                "DoublePulsar",
                "EmPyre",
                "EmpireProject",
                "Epic Turla",
                "EternalBlue",
                "EternalRomance",
                "GoldenSky",
                "Group Policy Results Tool",
                "HTML5 Encoding",
                "HyperStack",
                "IcedCoffee",
                "IronNetInjector",
                "KSL0T",
                "Kapushka",
                "Kazuar",
                "KopiLuwak",
                "Kotel",
                "LOLBAS",
                "LOLBins",
                "LightNeuron",
                "Living off the Land",
                "Maintools.js",
                "Metasploit",
                "Meterpreter",
                "MiamiBeach",
                "Mimikatz",
                "MiniDionis",
                "Minit",
                "NBTscan",
                "NETTRANS",
                "NETVulture",
                "Neptun",
                "NetFlash",
                "NewPass",
                "Outlook Backdoor",
                "Penquin Turla",
                "Pfinet",
                "PowerShell Empire",
                "PowerShellRunner",
                "PowerShellRunner-based RPC backdoor",
                "PowerStallion",
                "PsExec",
                "PyFlash",
                "QUIETCANARY",
                "Reductor RAT",
                "RocketMan",
                "SMBTouch",
                "SScan",
                "Satellite Turla",
                "SilentMoon",
                "Sun rootkit",
                "TTNG",
                "TadjMakhal",
                "Tavdig",
                "TinyTurla",
                "TinyTurla Next Generation",
                "TinyTurla-NG",
                "Topinambour",
                "Tunnus",
                "Turla",
                "Turla SilentMoon",
                "TurlaChopper",
                "Uroburos",
                "Urouros",
                "WCE",
                "WITCHCOVEN",
                "WhiteAtlas",
                "WhiteBear",
                "Windows Credential Editor",
                "Windows Credentials Editor",
                "Wipbot",
                "WorldCupSec",
                "XTRANS",
                "certutil",
                "certutil.exe",
                "gpresult",
                "nbtscan",
                "nbtstat",
                "pwdump"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "a97fee0d-af4b-4661-ae17-858925438fc4",
            "created_at": "2023-01-06T13:46:38.396415Z",
            "updated_at": "2025-03-27T02:00:02.823045Z",
            "deleted_at": null,
            "main_name": "Turla",
            "aliases": [
                "Uroburos",
                "Hippo Team",
                "Pacifier APT",
                "MAKERSMARK",
                "ATK13",
                "UAC-0003",
                "IRON HUNTER",
                "Waterbug",
                "TAG_0530",
                "KRYPTON",
                "Popeye",
                "SIG23",
                "UAC-0144",
                "G0010",
                "Blue Python",
                "VENOMOUS Bear",
                "Group 88",
                "Pfinet",
                "ITG12",
                "UNC4210",
                "Secret Blizzard",
                "UAC-0024"
            ],
            "source_name": "MISPGALAXY:Turla",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "d11c89bb-1640-45fa-8322-6f4e4053d7f3",
            "created_at": "2022-10-25T15:50:23.509601Z",
            "updated_at": "2025-03-27T02:00:55.487991Z",
            "deleted_at": null,
            "main_name": "Turla",
            "aliases": [
                "Turla",
                "IRON HUNTER",
                "Group 88",
                "Waterbug",
                "WhiteBear",
                "Krypton",
                "Venomous Bear",
                "Secret Blizzard",
                "BELUGASTURGEON"
            ],
            "source_name": "MITRE:Turla",
            "tools": [
                "PsExec",
                "nbtstat",
                "ComRAT",
                "netstat",
                "certutil",
                "KOPILUWAK",
                "IronNetInjector",
                "LunarWeb",
                "Arp",
                "Uroburos",
                "PowerStallion",
                "Kazuar",
                "Systeminfo",
                "LightNeuron",
                "Mimikatz",
                "Tasklist",
                "LunarMail",
                "HyperStack",
                "NBTscan",
                "TinyTurla",
                "Penquin",
                "LunarLoader"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "f9806b99-e392-46f1-9c13-885e376b239f",
            "created_at": "2023-01-06T13:46:39.431871Z",
            "updated_at": "2025-03-27T02:00:03.08926Z",
            "deleted_at": null,
            "main_name": "Watchdog",
            "aliases": [
                "Thief Libra"
            ],
            "source_name": "MISPGALAXY:Watchdog",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673535595,
    "ts_updated_at": 1743041819,
    "ts_creation_date": 1653762540,
    "ts_modification_date": 1653762540,
    "files": {
        "pdf": "https://archive.orkl.eu/0241d5b61e322d5e6972ce2c223e89bbab9302fc.pdf",
        "text": "https://archive.orkl.eu/0241d5b61e322d5e6972ce2c223e89bbab9302fc.txt",
        "img": "https://archive.orkl.eu/0241d5b61e322d5e6972ce2c223e89bbab9302fc.jpg"
    }
}