{
    "id": "9ce0bacf-0157-46c2-96c9-9070068d5f43",
    "created_at": "2023-01-12T14:59:39.79138Z",
    "updated_at": "2025-03-27T02:06:12.377139Z",
    "deleted_at": null,
    "sha1_hash": "4545c5ec9732c0246cd12caba47f6be49a541a54",
    "title": "2021-02-20 - Finding Forensic Goodness In Obscure Windows Event Logs",
    "authors": "",
    "file_creation_date": "2022-05-27T21:28:28Z",
    "file_modification_date": "2022-05-27T21:28:28Z",
    "file_size": 152575,
    "plain_text": "# Finding Forensic Goodness In Obscure Windows Event Logs\n\n**[nasbench.medium.com/finding-forensic-goodness-in-obscure-windows-event-logs-60e978ea45a3](https://nasbench.medium.com/finding-forensic-goodness-in-obscure-windows-event-logs-60e978ea45a3)**\n\nNasreddine Bencherchali February 20, 2021\n\n[Nasreddine Bencherchali](https://nasbench.medium.com/?source=post_page-----60e978ea45a3--------------------------------)\n\nFeb 20, 2021\n\n\n5 min read\n\nEvent Viewer\nIf you’ve been doing some digital forensics or threat hunting for some time. You’ll know that\none of the key sources of information are the Windows event logs. Most of the talks around\nthe windows event logs only mention the “main” sources of logs such as “System” or\n“Application”, even though windows provide many sources.\n\n\n-----\n\nTo get the full logging experience one need to enable additional logging from the or even\ninstalls something like but what to do in the case where one cannot install or enable the\naforementioned logs? Or let’s say you’re performing an investigation and the machine has\nonly default logging enabled ? Does the windows event log contains other useful information\nother than the one provided by the main sources (Application, System and Security) ?\n\nToday we’ll take a look at some of those event logs and see if there is anything interesting.\n\n## Microsoft-Windows-Shell-Core/Operational\n\nDetects the start of the execution of a process from both the\n“Software\\Microsoft\\Windows\\CurrentVersion\\Run” and\n“Software\\Microsoft\\Windows\\CurrentVersion\\RunOnce” registry keys with the full\ncommand line.\n\nDetects when the aforementioned process finishes execution with the corresponding\nPID (Useful when the process is still running on the system).\n\nTriggered when a shortcut is added to the “App Resolver Cache”. Indicates when an\napplication is installed.\n\nBoth EID 9707 and 9708 can be used to search for any malware using the “Run” and\n“RunOnce” key as persistence mechanisms.\n\n## Microsoft-Windows-WinINet-Config/ProxyConfigChanged\n\n\n-----\n\nIndicates change in the proxy configuration. For example if i change my proxy\nconfiguration from the “Internet Option” menu. The event will get generated.\n\n## Microsoft-Windows-VHDMP-Operational\n\nTriggers when you mount a VHD (Virtual Hard Disk).\n\nTriggers when you unmount a VHD (Virtual Hard Disk).\n\nContains information about the type, path, handle count of the mounted device.\n\n## OAlerts (Office Alerts)\n\nTriggers when a prompt is shown inside an office application. For example when the\nprompt to save the office (excel, word…etc) document is shown an event is generated.\nContains information about the name of the files (In the case of saving a file), the office\nversion, the office application that triggered the alert (Word, PowerPoint, Excel…etc).\n\nThis event can be used to determine if a suspicious for example file has been opened or\naltered in some way by a user.\n\n## Microsoft-Windows-WLAN-AutoConfig/Operational\n\nTriggers when a successful connection to a wireless network occurs.\nTriggers when we’re successfully disconnected from a wireless network.\n\n\n-----\n\n## Microsoft-Windows-Winlogon/Operational\n\nTriggers when a user logon to a machine. You can check for the “<SessionEnv>”\nsubscriber notification in EID 811 to indicates that a user logged on via RDP.\n\nNote that as far as i can tell the “SessionEnv” subscriber is also logged when a user logon to\na machine for the first time (I.E doesn’t have a session). To distinguish between the two\n(RDP or Local) look for the EID 1/2 shortly after the “SessionEnv” subscriber to indicate a\nlocal logon and if not present that means its an RDP logon.\n\nIn my test lab this event is triggered only when a user log in to a computer on which he\ndoesn’t have a session (I.E session disconnected/ doesn’t exist). EID 2 can be used to\ndetermine how many times a user typed an incorrect password.\n\nFor example, if a user provided a wrong password and EID 2 will be generated with the\n“Result Code : 1326”. Which indicates an incorrect password.\n\n\n-----\n\nIf the password is correct, then the “Result Code : 0” is generated.\n\n## Microsoft-Windows-Windows Firewall With Advanced Security/Firewall\n\nTrigger when “A rule has been to the Windows Defender Firewall exception list.\nTriggers when “A rule has been in the Windows Defender Firewall exception list.”\nTriggers when “A rule has been in the Windows Defender Firewall exception list.”\n\nContains information about :\n\nThe “Rule Name” that’s been altered.\nThe “Modifying Application” that initiated the change.\nThe “Action” and “Direction”\nThe “User”.\n…Etc.\n\n## Microsoft-Windows-UniversalTelemetryClient/Operational\n\n\n-----\n\nIndicates whether the computer has Internet or Not.\n\nYou can use the difference between two events to determine why a process didn’t run\n(Maybe it needed internet) or answer the question did the malware send information to the\nC2 since the start of the infection for example.\n\n## Microsoft-Windows-Security-Mitigations/KernelMode\n\nAnother event log worth looking is the “Microsoft-Windows-Security-Mitigations/*”. This event\nlog contains log about the “Exploit Protection” feature. A complete list of the EID’s available\ncan be found below.\n\n## Apply mitigations to help prevent attacks through vulnerabilities - Windows security\n\n### Important The improved Microsoft 365 security center is now available in public preview. This new experience brings…\n\ndocs.microsoft.com\n\n## Conclusion\n\nWe’ve taken a look at a couple of event logs that can be very useful during an investigation\nor a threat hunt. If you have other suggestions of events that should be added or noticed an\n[error of some kind drop me a DM on twitter @nas_bench](https://twitter.com/nas_bench)\n\nHappy Hunting.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-02-20 - Finding Forensic Goodness In Obscure Windows Event Logs.pdf"
    ],
    "report_names": [
        "2021-02-20 - Finding Forensic Goodness In Obscure Windows Event Logs.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673535579,
    "ts_updated_at": 1743041172,
    "ts_creation_date": 1653686908,
    "ts_modification_date": 1653686908,
    "files": {
        "pdf": "https://archive.orkl.eu/4545c5ec9732c0246cd12caba47f6be49a541a54.pdf",
        "text": "https://archive.orkl.eu/4545c5ec9732c0246cd12caba47f6be49a541a54.txt",
        "img": "https://archive.orkl.eu/4545c5ec9732c0246cd12caba47f6be49a541a54.jpg"
    }
}