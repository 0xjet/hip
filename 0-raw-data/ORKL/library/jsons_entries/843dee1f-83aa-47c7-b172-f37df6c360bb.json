{
    "id": "843dee1f-83aa-47c7-b172-f37df6c360bb",
    "created_at": "2023-01-12T14:59:43.709524Z",
    "updated_at": "2025-03-27T02:10:07.537062Z",
    "deleted_at": null,
    "sha1_hash": "7171dd67dd195184a27f90c3bed1fe4a5650b92b",
    "title": "2017-12-06 - Champing at the Cyberbit Ethiopian Dissidents Targeted with New Commercial Spyware",
    "authors": "",
    "file_creation_date": "2022-05-28T15:39:44Z",
    "file_modification_date": "2022-05-28T15:39:44Z",
    "file_size": 3010175,
    "plain_text": "# Champing at the Cyberbit Ethiopian Dissidents Targeted with New Commercial Spyware\n\n**[citizenlab.ca/2017/12/champing-cyberbit-ethiopian-dissidents-targeted-commercial-spyware/](https://citizenlab.ca/2017/12/champing-cyberbit-ethiopian-dissidents-targeted-commercial-spyware/)**\n\nDecember 6, 2017\n\n[Research](https://citizenlab.ca/category/research/)\n\n\n-----\n\n[Targeted Threats](https://citizenlab.ca/category/research/targeted-threats/)\nBy [Bill Marczak,](https://citizenlab.ca/author/bmarczak/) [Geoffrey Alexander,](https://citizenlab.ca/author/geoffreyalexander/) [Sarah McKune,](https://citizenlab.ca/author/smckune/) [John Scott-Railton, and](https://citizenlab.ca/author/jsrailton/) [Ron Deibert](https://citizenlab.ca/author/profd/)\nDecember 6, 2017\nየኢትዮጵያ መንግስት ተቃዋሚዎች [በአዲስ](https://citizenlab.ca/2017/12/%E1%8B%A8%E1%8A%A2%E1%89%B5%E1%8B%AE%E1%8C%B5%E1%8B%AB-%E1%88%98%E1%8A%95%E1%8C%8D%E1%88%B5%E1%89%B5-%E1%89%B0%E1%89%83%E1%8B%8B%E1%88%9A%E1%8B%8E%E1%89%BD-%E1%89%A0%E1%8A%A0%E1%8B%B2%E1%88%B5/) የስለላ ሶፍትዌር ጥቃት ዒላማ ስር\n\n[Download this report](https://tspace.library.utoronto.ca/bitstream/1807/96416/1/Report%23102--champing%20at%20the%20cyberbit.pdf)\n\n## Key Findings\n\nThis report describes how Ethiopian dissidents in the US, UK, and other countries were\ntargeted with emails containing sophisticated commercial spyware posing as Adobe\nFlash updates and PDF plugins. Targets include a US-based Ethiopian diaspora media\noutlet, the Oromia Media Network (OMN), a PhD student, and a lawyer. During the\ncourse of our investigation, one of the authors of this report was also targeted.\n**We found a public logfile on the spyware’s command and control server and**\n**monitored this logfile over the course of more than a year. We saw the spyware’s**\n**operators connecting from Ethiopia, and infected computers connecting from IP**\n**addresses in 20 countries, including IP addresses we traced to Eritrean**\n**companies and government agencies.**\nOur analysis of the spyware indicates it is a product known as PC Surveillance System\n(PSS), a commercial spyware product with a novel exploit-free architecture. PSS is\noffered by Cyberbit — an Israel-based cyber security company that is a wholly-owned\nsubsidiary of Elbit Systems — and marketed to intelligence and law enforcement\nagencies.\n\n\n-----\n\n**We conducted Internet scanning to find other servers associated with PSS and**\n**found several servers that appear to be operated by Cyberbit themselves. The**\n**public logfiles on these servers seem to have tracked Cyberbit employees as**\n**they carried infected laptops around the world, apparently providing**\n**demonstrations of PSS to the Royal Thai Army, Uzbekistan’s National Security**\n**Service, Zambia’s Financial Intelligence Centre, the Philippine President’s**\n**Malacañang Palace, ISS World Europe 2017 in Prague, and Milipol 2017 in Paris.**\n**Cyberbit also appears to have provided other demos of PSS in France, Vietnam,**\n**Kazakhstan, Rwanda, Serbia, and Nigeria.**\n\n## 1. Executive Summary\n\nThis report describes a campaign of targeted malware attacks apparently carried out by\nEthiopia from 2016 until the present. In the attacks we document, targets receive via email a\nlink to a malicious website impersonating an online video portal. When a target clicks on the\nlink, they are invited to download and install an Adobe Flash update (containing spyware)\nbefore viewing the video. In some cases, targets are instead prompted to install a fictitious\napp called “Adobe PdfWriter” in order to view a PDF file. Our analysis traces the spyware to\na heretofore unobserved player in the commercial spyware space: Israel’s Cyberbit, a whollyowned subsidiary of Elbit Systems. The spyware appears to be a product called PC\n_Surveillance System (PSS), recently renamed PC 360._\n\nThe attacks we first identified were targeted at Oromo dissidents based outside of Ethiopia,\nincluding the Oromia Media Network (OMN). Oromia is the largest regional ethnic state of\nEthiopia by population and area, comprised mostly of the Oromo people.\n\n\n-----\n\n**Figure 1: Oromia Region, Ethiopia**\n\nWe later discovered that the spyware’s command and control (C&C) server has a public\nlogfile that appears to show both operator and victim activity, allowing us to gain insight into\nthe identity of the operators and the targets. Based on our analysis of the logfile, it appears\nthat the spyware’s operators are inside Ethiopia, and that victims also include various\nEritrean companies and government agencies.\n\nWe scanned the Internet for similar C&C servers and found what appear to be several\nservers used by Cyberbit. The public logfiles on those servers seem to have tracked Cyberbit\nemployees as they carried infected laptops around the world, apparently providing\ndemonstrations of PSS to various potential clients. The logfiles appear to place Cyberbit\nemployees at IP addresses associated with the Royal Thai Army, Uzbekistan’s National\nSecurity Service, Zambia’s Financial Intelligence Centre, the Philippine President’s\nMalacañang Palace, ISS World Europe 2017 in Prague, and Milipol 2017 in Paris. Cyberbit\nalso appears to have provided other demos to clients we could not identify in France,\nVietnam, Kazakhstan, Rwanda, Serbia, and Nigeria.\n\n\n-----\n\n**Figure 2: Countries with Ethiopian Cyberbit targets.**\n\nThis report is the latest in a growing body of work that shows the wide abuse of nation-state\nspyware by authoritarian leaders to covertly surveil and invisibly sabotage entities they deem\npolitical threats. After FinFisher, Hacking Team, and NSO Group, Cyberbit is the fourth\nvendor of nation-state spyware whose tools we have seen abused, and the second based in\nIsrael. Cyberbit’s PSS is also not the first spyware that Ethiopia has abused outside of its\nborders: in 2015, we discovered that Ethiopia’s Information Network Security Agency (INSA)\n[was using Hacking Team’s RCS spyware to target US-based journalists at the Ethiopian](https://citizenlab.ca/2015/03/hacking-team-reloaded-us-based-ethiopian-journalists-targeted-spyware/)\nSatellite Television Service (ESAT). Ethiopia has also previously targeted dissidents using\nFinFisher’s FinSpy spyware.\n\n[Citizen Lab has published a companion post outlining some of the legal and regulatory](https://citizenlab.ca/2017/12/legal-overview-ethiopian-dissidents-targeted-spyware/)\nissues raised by this investigation. We also sent letters to [Cyberbit and](https://citizenlab.ca/wp-content/uploads/2017/12/Cyberbit-Letter.pdf) [Adobe concerning](https://citizenlab.ca/wp-content/uploads/2017/12/Citizen-Lab-Letter-to-Adobe.pdf)\n[the misuse of their respective products. Cyberbit responded on December 5, 2017, stating in](https://citizenlab.ca/wp-content/uploads/2017/12/Cyberbit-Solutions-Response-to-The-Citizen-Lab-05.12.2017.pdf)\npart: “we appreciate your concern and query and we are addressing it subject to the legal\n_and contractual confidentiality obligations Cyberbit Solutions is bound by.” Adobe_ [responded](https://citizenlab.ca/wp-content/uploads/2017/12/Citzen_Lab_12-5-17.pdf)\non December 6, 2017, stating in part: “we have taken steps to swiftly address this issue,\n_including but not limited to contacting Cyberbit and other relevant service providers.”_\n\n## 2. Background\n\n 2.1. Oromo Protests and Diaspora Media Outlets\n\n[Largely peaceful protests erupted in the Ethiopian state of Oromia in November 2015, in](https://www.hrw.org/video-photos/interactive/2016/11/09/timeline-ethiopian-protests)\nresponse to a government decision to pursue a development project involving the razing of a\nforest and football field. Protesters coalesced around opposition to a larger plan, the Addis\n\n\n-----\n\nAbaba Master Plan, which they feared would displace some of the 2 million Oromo residents\nliving around Addis Ababa. The government labeled the protesters terrorists and responded\nwith lethal force and arbitrary arrests. Over the next year, security forces killed over 1000\npeople, many of them from Oromia, during anti-government protests. This culminated in a\n[state of emergency that was called in October 2016 that lasted over 10 months.](https://www.hrw.org/news/2017/08/07/state-emergency-ends-ethiopia)\n\nOromia Media Network (OMN) is a US-based media channel that describes itself as an\n_“independent, nonpartisan and nonprofit news enterprise whose mission is to produce_\n_original and citizen-driven reporting on Oromia, the largest and most populous state in_\n_Ethiopia.” OMN broadcasts via satellite, and also has an Internet and social media_\npresence. [According to Human Rights Watch, OMN “played a key role in disseminating](https://www.hrw.org/news/2016/02/21/ethiopia-no-let-crackdown-protests)\n_information throughout Oromia during the protests.” The government has “reportedly jammed_\n_OMN 15 times since it began operations in 2014” and arrested individuals for providing_\ninformation to OMN or displaying the channel in their businesses.\n\n## 2.2. Cyberbit and PSS\n\n[Cyberbit is an Israel-based cyber security company and a wholly-owned subsidiary of Israeli](http://elbitsystems.com/products/cyber-security/)\n[defense and homeland security manufacturer and contractor Elbit Systems. Cyberbit was](http://elbitsystems.com/)\n[established in 2015 in order to “consolidate Elbit Systems’ activities relating to the Cyber](http://www.israeldefense.co.il/en/content/cyber-technology-market-endless)\n_Intelligence and Cyber Security markets.” Cyberbit merged with the NICE Cyber and_\nIntelligence Division in 2015 after Elbit [acquired that entity for approximately $158 million,](http://ir.elbitsystems.com/phoenix.zhtml?c=61849&p=irol-newsArticle&ID=2063944)\n[with Cyberbit reportedly taking on the division’s employees. Elbit had previously acquired](https://www.prnewswire.com/news-releases/elbit-systems-signs-an-agreement-to-acquire-nice-systems-cyber-and-intelligence-division-for-an-amount-of-up-to-1579-million-300087079.html) _C4_\n_[Security in June 2011 for $10.9 million; C4 described itself as “specializ[ing] in information](https://www.linkedin.com/company/c4-security)_\n_warfare, SCADA and military C&C systems security.“ According to one employee’s LinkedIn_\n[page, C4 also developed a product called “PSS Surveillance System,” billed as a “solution[]](https://www.linkedin.com/in/tal-agmon-6621876)\n_for intelligence and law enforcement agencies.”_ [Cyberbit marketing materials1](https://web.archive.org/web/20170928232123/https://s3-eu-central-1.amazonaws.com/cyberbit/wp-content/uploads/2016/10/05162937/brouchure_PSS_eng_7.pdf) refer to what\nappears to be the same system: “CYBERBIT PC Surveillance System (PSS).” PSS is also\n[referenced on Elbit’s website as a solution “for collection from personal computers.” Elbit](http://elbitsystems.com/about-us-major-activities-intelligence-and-cyber-systems/)\n[reportedly will be reorganizing Cyberbit, effective as of 2018, to separate its defense and](https://www.reuters.com/article/us-cyber-summit-elbit/israels-elbit-to-split-civilian-cyber-from-spyware-as-products-diverge-idUSKBN1CW1CC)\ncommercial businesses, with Cyberbit continuing to operate the “C4i division and commercial\n_cyber business.” Elbit’s major subsidiaries are located in Israel and the United States, and_\nElbit is listed on the NASDAQ and the Tel Aviv Stock Exchange.\n\n\n-----\n\n**Figure 3: Screenshot of PSS Console (Source:** **[Cyberbit Marketing Materials).](https://web.archive.org/web/20170928232123/https://s3-eu-central-1.amazonaws.com/cyberbit/wp-content/uploads/2016/10/05162937/brouchure_PSS_eng_7.pdf)**\n\nCyberbit is the second Israel-based nation-state spyware vendor we have identified and\nanalyzed, the other being NSO Group. The two companies operate in the same market and\nhave even been connected with the same clients. In an extradition request for former\nPanamanian President Martinelli, Panama alleged that Martinelli had directed the purchase\nof two spyware products: PSS and NSO Group’s Pegasus. Additionally, a leaked Hacking\nTeam email about NSO claims that: “NSO only has mobile agents … Apparently the pc part\n_is handled by another company, PSS.”_\n\nCyberbit describes PSS as “a comprehensive solution for monitoring and extracting\n_information from remote PCs.” As is standard in the marketing materials for spyware_\ncompanies, Cyberbit represents that their design “eliminat[es] the possibility that the\n_operation will be traced back to the origin.”_\n\n\n-----\n\n**Figure 4: Data exfiltrated by PSS (Source:** **[Cyberbit Marketing Materials).](https://web.archive.org/web/20170928232123/https://s3-eu-central-1.amazonaws.com/cyberbit/wp-content/uploads/2016/10/05162937/brouchure_PSS_eng_7.pdf)**\n\nCyberbit says that PSS “helps LEAs and intelligence organizations to reduce crime, prevent\n_terrorism and maintain public safety by gaining access, monitoring, extracting and analyzing_\n_information from remote PCs.” Information that PSS can monitor and extract includes “VoIP_\n_calls, files, emails, audio recordings, keylogs and virtually any information available on the_\n_target device.”_\n\n## 3. Targeting of Jawar Mohammed\n\nJawar Mohammed is the Executive Director of the Oromia Media Network (OMN). He is also\na prolific activist, with more than 1.2 million followers on Facebook. October 2, 2016 was the\nannual Irreecha cultural festival, the most important Oromo cultural festival. Millions of\npeople each year gather at the festival site in Bishoftu, near Addis Ababa. In 2016, “scores of\n_people”_ [died at the festival “following a stampede triggered by security forces’ use of teargas](https://www.hrw.org/report/2017/09/19/fuel-fire/security-force-response-2016-irreecha-cultural-festival)\n_and discharge of firearms in response to an increasingly restive crowd.” Jawar was active at_\n[the time on social media in stoking the passions of Oromo on the ground, circulating both](https://www.washingtonpost.com/news/worldviews/wp/2016/10/14/in-ethiopias-war-against-social-media-the-truth-is-the-main-casualty/)\nverified and unverified information. On October 4, 2016, while in Minneapolis, USA, Jawar\nreceived the email in Figure 5. He forwarded the email to Citizen Lab for analysis.\n\n**From: sbo radio <sbo.radio88[@]gmail.com>**\n\n**Date: Tue, 4 Oct 2016 16:50:13 +0300**\n\n**Subject: Fw: Confidential video made publicWhat do you think of this video ? In case you**\ndon’t have the right version of adobe flash and can’t watch the video, you can get the latest\nversion of Adobe flash from Here\n\nhttp://getadobeplayer[.]com/flashplayer/download/index7371.html.———- Forwarded\nmessage ———\n**From: sbo radio <sbo.radio88[@]gmail.com>**\n\n\n-----\n\n**Date: Tue, Oct 10, 2014 at 4:23 PM**\n**Subject: Video hints Eritrea and Ethiopia war is highly likely to continueDear**\nExcellencies,Video : Eritrea and Ethiopia war likely to continue\nhttp://www.eastafro[.]net/eritrea-ethiopia-border-clash-video.htmlregards,Sbo Radio\nMit freundlichen Grüßen\n\n**Figure 5: An email sent to Jawar on October 4, 2016. The sender most likely crafted**\n**the email to make it appear that this was a forwarded message.**\nThe site eastafro[.]net appears to impersonate the (legitimate) Eritrean video website\neastafro.com. When a target clicks on an operator-generated link to eastafro[.]net,\nJavaScript on the site checks to see whether the target is using Windows and whether their\nAdobe Flash Player is up to date. If the script detects a Windows user with an out-of-date\nFlash Player, it displays a message asking the user to update their Flash Player. If clicked, or\nafter 15 seconds, the user is redirected to a page on getadobeplayer[.]com, which offers\nthe user a real Flash Player update bundled with spyware.\n\n\n-----\n\n**Figure 6: Message displayed when a target clicks on a link to eastafro[.]net.**\n\nIf the user downloads and installs the malicious Flash update, their computer is infected. It is\nclear that this is a targeted attack: if a user simply types in eastafro[.]net into their browser’s\naddress bar, they are redirected to the legitimate site, eastafro.com. If a user does the same\nwith getadobeplayer[.]com, they are served a “403 Forbidden” message. Both sites have\nrobots.txt files instructing search engines not to crawl them. Access to the spyware is\ngranted only if the user clicks on a link sent by the operator.\n\nIn all, Jawar received eleven emails between 5/30/2016 and 10/13/2016, and one more than\na year later on 11/22/2017. Each email contained links to what were purportedly videos on\n**eastafro[.]net, or Adobe Flash Player updates on getadobeplayer[.]com. The 11/22/2017**\nemail contained a link to eastafro[.]net that asked the target to install “Adobe’s PdfWriter,” a\n\n\n-----\n\nfictitious product. The download contained the same spyware as the malicious Adobe Flash\nPlayer updates, but was packaged with CutePDF Writer, “a proprietary Portable Document\n_Format converter and editor for Microsoft Windows developed by Acro Software,” with no_\nconnection to Adobe.\n\n**Figure 7: “Adobe PdfWriter” Installation Prompt.**\n\nIn many cases, the operators appear to have registered their own accounts to send the\ninfection attempts. However, the email address sbo.radio88[@]gmail.com used by operators\nto target Jawar is associated with the radio station of the Oromo Liberation Front (OLF). The\naccount may have been compromised.\n\n**Table 1: Malicious emails received by Jawar.**\n\n**Date** **Subject** **Sender**\n\n5/30/2016 Ethiopia Struggling with inside Challenges! eliassamare[@]gmail.com\n\n6/15/2016 Tsorona Conflict Video! eliassamare[@]gmail.com\n\n6/29/2016 UN Report and Diaspora Reaction! eliassamare[@]gmail.com\n\n8/4/2016 Ethiopia and Current Options! eliassamare[@]gmail.com\n\n8/15/2016 Fwd: Triggering Ethiopia Protests! eliassamare[@]gmail.com\n\n9/5/2016 Saudi-Iran and the Red Sea! eliassamare[@]gmail.com\n\n9/6/2016 Congrats – የኢሳት ፍሬዎች wadewadejoe[@]gmail.com\n\n9/22/2016 Is Funding Ethiopia the Right time Now? eliassamare[@]gmail.com\n\n10/4/2016 Fw: Confidential video made public sbo.radio88[@]gmail.com\n\n10/10/2016 Egypt-Ethiopia new tension! awetnaeyu[@]gmail.com\n\n10/13/2016 Confidential Videos made public wadewadejoe[@]gmail.com\n\n\n11/22/2017 Gov official interrogated following leakage\nof national security meeting minutes\n\n\nlekanuguse2014[@]gmail.com\n\n\n-----\n\nThe Ethiopian Government charged Jawar with terrorism in February 2017 under the criminal\n[code; Jawar and OMN denied all charges.](https://www.oromiamedia.org/2017/03/16/omn-open-statement-viewers-march-16-2017/)\n\n## 4. Investigation to Find Additional Targets\n\n_We set out to find additional targets. We conducted targeting testing of members of the_\n_Oromo community using Himaya, our email scanning tool, to determine whether they had_\n_received any similar malicious messages. We also found a public logfile on the spyware’s_\n_C&C server (Section 5.2); the logfile listed IP addresses of infected devices and we were_\n_able to identify additional victims based on their IP._\n\n## 4.1. Other Targets\n\n**_[Etana Habte is a PhD candidate and Senior Teaching Fellow at SOAS, University of London.](https://www.soas.ac.uk/staff/staff97558.php)_**\nHe is a frequent commentator on Ethiopian issues and appears regularly on OMN.\n\n**Table 2: Malicious emails received by Etana.**\n\n**Date** **Subject** **Sender**\n\n\n12/9/2016 Let’s stop EU & the World Bank\nfrom funding $500 m to Ethiopia\n\n1/11/2017 Fwd: MONOSANTO (A\nmultinational company)’s plan on\nOromia\n\n\nshigut.gelleta[@]gmail.com\n\nnetworkoromostudies2015[@]gmail.com\n\n\nThe address [shigut.gelleta@gmail.com appears to be an account created by attackers](http://10.10.0.46/mailto:shigut.gelleta@gmail.com)\ndesigned to impersonate Shigut Geleta, a member of the OLF.\n\n**_[Dr. Henok Gabisa is a Visiting Academic Fellow who teaches at Washington and Lee](https://law2.wlu.edu/faculty/profiledetailigx.asp?id=743)_**\nUniversity School of Law and is the founder of the Association of Oromo Public Defenders\n(Public Interest Lawyers Association) in Oromia.\n\n**Table 3: Malicious emails received by Henok.**\n\n**Date** **Subject** **Sender**\n\n\n3/6/2017 Why did MONOSANTO target the\nOromiya region?\n\n3/13/2017 Democracy in Ethiopia: Can it be\nsaved?\n\n\nnetworkoromostudies2015[@]gmail.com\n\nnetworkoromostudies2015[@]gmail.com\n\n\n-----\n\n**_Bill Marczak is a researcher at Citizen Lab and an author of this report. Marczak was_**\ntargeted after he asked another target to forward an email sent by operators. At the time, the\ntarget’s email account was compromised (the target had been previously infected with this\nspyware). On March 29, 2017, while in San Francisco, USA, Marczak received a message\nentitled “Martin Plaut and Ethiopia’s politics of famine,” from\nnetworkoromostudies2015[@]gmail.com. The email contained a link to eastafro[.]net.\n\n**Figure 8: Message received by Citizen Lab Senior Research Fellow Bill Marczak. The**\n**use of the Comic Sans font is due to the attacker’s font selection.**\n\n**_Other Targets: Several malicious emails we found were sent to multiple receipients,_**\naccording to their headers. We found 39 additional email addresses of targets using this\nmethod; at least 12 addresses appear to be linked to targets active on Oromo issues, or\nworking for Oromo groups.\n\n## 4.2. Logfile Analysis\n\nPeculiarly, we found a public logfile on the spyware’s C&C server; the logfile recorded activity\nthat allowed us to geolocate (or in some cases, identify) victims. We analyzed more than a\nyear of logs showing victim (and operator) activity. Each logfile entry contains a unique\nidentifier (a GUID) associated with the infection, a value indicating whether the entry records\nvictim or operator activity, the IP address that the infected device (or operator) connected to\nthe C&C server from, and finally a timestamp showing when the communication took place\n(for more details on the logfile, see Section 4.3). The format of the logfile allowed us to track\ninfections as they moved between different IP addresses, such as when an infected target\ncarried their laptop between home and work, or while traveling.\n\nDuring more than a year of monitoring the server’s logfiles, we observed 67 different GUIDs.\nAll infections were operated by the same operator, who only ever used one IP address,\nwhich belongs to a satellite connection (except for a three hour period on a single day when\nthe operator’s activity “failed over” to two other IP addresses, one address in Ethiopia and\none VPN, perhaps due to transient satellite connection failure). We identified 11 of the 67\nGUIDs as likely resulting from testing by the operator, or execution by researchers, based on\ntheir apparent short duration. Further, we noted that some GUIDs likely referenced the same\n\n\n-----\n\ninfected device, as they represented consecutive, non-overlapping infections whose IP\naddresses corresponded with the same Internet Service Provider (ISP). This was the case\nfor two GUIDs in the UK, two in South Sudan, and 12 in Uganda.\n\nWe arrived at 43 GUIDs that we believe represent distinct infected devices. We then sought\nto geolocate each infection to a country. We first ran the [MaxMind GeoLite 2 Country](https://dev.maxmind.com/geoip/geoip2/geolite2/)\ndatabase on each IP and associated a set of countries with each infection. For each infection\nthat had only one country associated with it, we examined a small number of IP addresses\nfrom the infection, to see whether those IPs looked like they were actually in that country, or\nwhether geolocation may have been incorrect due to the IP being associated with a VPN or\nsatellite connection.\n\nFor infections that MaxMind associated with multiple countries, we determined the dominant\ncountry, based on the country with the largest number of logfile entries for that infection. For\nthe dominant country, we checked a small number of IP addresses to make sure the\ngeolocation was correct. For the other countries, we checked each IP in an attempt to\neliminate incorrect geolocation. We noted four infections that predominantly connected from\nsatellite connections, which MaxMind geolocated to UK or UAE; we changed the geolocation\nof these devices to Eritrea, as the infections either “failed over” to IPs registered to EriTel, or\nshared the same satellite IP address as other infections that “failed over” to EriTel IPs.\n\n**Table 4: Number of infections we geolocated to each country, for countries where we**\n**geolocated more than one infection.**\n\n**Country** **# Infected Devices**\n\nEritrea 7\n\nCanada 6\n\nGermany 6\n\nAustralia 4\n\nUSA 4\n\nSouth Africa 2\n\nOther countries in which we saw only a single infected device were: Belgium, Egypt,\nEthiopia, UK, India, Italy, Japan, Kenya, Norway, Qatar, Rwanda, South Sudan, Uganda, and\nYemen.\n\nAfter we eliminated VPN IPs, and geolocated the four infections that predominantly\nconnected from satellite connections, we found that 40 of 43 infections only ever\ncommunicated from a single country. The remaining three devices appear to have travelled\nbetween several countries. The three infections that traveled internationally are as follows:\n\n\n-----\n\nA device that twice travelled from Eritrea (via Germany) to the United Nations in\nGeneva. We geolocated this device to Eritrea.\nA device that predominantly connected from the University of Tsukuba in Japan that\ntravelled to Eritrea. We geolocated this device to Japan.\nA device that predominantly connected from York University in Canada that travelled to\nEritrea. We geolocated this device to Canada.\n\nWe were able to trace six of the infections (five in Eritrea, one abroad) to Eritrean\ngovernment agencies or companies, suggesting that operators are likely targeting members\nof the Eritrean government in addition to Ethiopian dissidents.\n\n## 4.3. Other Attacker Sites\n\nDuring our analysis, we identified two other websites sharing the same IP address as\ngetadobeplayer[.]com, which also appear to have been used by the same attackers to target\nvictims with the same spyware: diretube.co[.]uk (impersonating diretube[.]com, an\nEthiopian video site), and meskereme[.]net (impersonating meskerem[.]net, an Eritrean\nopposition website).\n\nThe diretube.co[.]uk site used the same Adobe Flash update ploy to direct users to\nmalware on getadobeplayer[.]com, whereas the meskereme[.]net site displays a message\nsaying “Problem reading Tigrinya? Install these fonts,” with links to the fonts bundled with\nspyware. The legitimate website, meskerem[.]net displays the same message, but links to\nfonts without the spyware.\n\n## 5. Attribution to Cyberbit and Ethiopia\n\n_This section describes how we attributed the spyware to Cyberbit and Ethiopia._\n\n## 5.1. Digital Signature Points to Cyberbit\n\nBy monitoring getadobeplayer[.]com, we found and analyzed five samples of the spyware as\nit was updated over time.\n\n**Table 5: The samples from getadobeplayer[.]com that we analyzed.**\n\n**MD5** **Name**\n\n568d8c43815fa9608974071c49d68232 flashplayer20_a_install.exe\n\n80b7121c4ecac1c321ca2e3f507104c2 flashplayer21_xa_install.exe\n\n8d6ce1a256acf608d82db6539bf73ae7 flashplayer22_xa_install.exe\n\n840c4299f9cd5d4df46ee708c2c8247c flashplayer23_xa_install.exe\n\n\n-----\n\n**MD5** **Name**\n\n961730964fd76c93603fb8f0d445c6f2 flashplayer24_xa_install.exe\n\nEach sample communicates with two command and control (C&C) servers: time-local[.]com\nand time-local[.]net.\n\nWe found a structurally similar sample (see Section 7 for details on structural similarities) in\nVirusTotal:\n\n**MD5: 376f28fb0aa650d6220a9d722cdb108d**\n\n**SHA1: c7b4b97369a2ca77e916d5175d162dc2b823763b**\n\n**SHA256: c76d2a8c1c8865b1aa6512e13b77cbc7446022b7be3378f7233c5ca4a5e58116**\n\nThat sample communicated with a C&C server at the following URL:\n**pssts1.nozonenet[.]com/ts8/ts8.php (note the use of “PSS” in the URL). The sample also**\ndrops an EXE file containing a digital signature (valid as of the date submitted to VirusTotal)\nproduced by a certificate with the following details:\n\nCN = C4 Security\n\nO = C4 Security\n\nSTREET = 13 Noach Mozes St\n\nL = Tel aviv\n\nS = Gush Dan\n\nPostalCode = 67442\n\nC = IL\n\nRFC822 Name=tal.barash@c4-security.com\n\n[Note that c4-security.com was the official website of C4 security, according to a brochure](http://www.export.gov.il/files/hls/hls-catalog/html/PDF/HLS_108.pdf)\nposted on the website of the Israeli Export Institute.\n\n## 5.2. Public Logfile Analysis Points to Ethiopia and Cyberbit\n\nWhile monitoring additional PSS C&C servers that we discovered during scanning (Section\n**6.1), we found that one of these servers temporarily exposed a directory listing in response**\nto a normal GET / HTTP/1.1 request (Figure 9). The directory listing contained the text:\n“Apache/2.4.7 (Ubuntu) Server at cyberbitc[.]com Port 80,” indicating that the server was\nassociated with Cyberbit. The website cyberbitc[.]com is [owned by Cyberbit and was used](https://www.rsaconference.com/events/us16/expo-sponsors/exhibitor-list/2544/cyberbit)\nby Cyberbit before they acquired cyberbit[.]com in March 2017.[2]\n\n\n-----\n\n**Figure 9: Directory listing on one of the servers that earlier matched our fingerprint.**\n\nThis directory listing also revealed the existence of several files, including a file called\nrec.dat, which at first glance we noticed was encoded in binary format. We suspected that\nrec.dat might be a logfile, as it appeared to be constantly updated on the C&C servers. We\nnoticed that rec.dat existed on all of the C&C servers we detected in our scanning and were\nable to test (Section 6.1), including on time-local[.]com and time-local[.]net, the C&C servers\nassociated with the spyware samples sent to Oromo targets.\n\n### 5.2.1. Logfile Analysis Shows Ethiopian Operator\n\nTo verify our logfile hypothesis, we performed a test infection of a virtual machine using one\nof the samples sent to Oromo targets and we allowed the virtual machine to communicate\nwith the C&C server. The traffic comprised HTTP POST requests (Section 7.7), each of\nwhich contained an agentid, a GUID initially {00000000-0000-0000-0000-000000000000}\nand later nonzero.\n\nAfter the infection, we downloaded rec.dat and found that it contained a series of records,\nseveral with our IP address, and our agentid GUID, in binary form. Each record of the logfile\nis delimited by the string \\x41\\x41\\x41 (‘AAA’) and can be parsed with the following regular\nexpression:\n\n‘(.{4})\\x00\\x00(.)(.{4})(.{16})AAA’\n\nThe first group of four bytes is a UNIX timestamp, the second group of 1 byte is a type value\n(which, in our testing was always 2, 17, 21, 33, or 37), the third group of 4 bytes is an IP\naddress, and the fourth group of 16 bytes is a GUID. The file appears to be a circular (i.e.,\n\n\n-----\n\nsize-capped) logfile stored in binary format whose maximum size is defined in config.ini to be\n10MB. Old entries are removed from the front of the file as new entries are written to the end.\n\nPeculiarly, we noticed additional entries in rec.dat with our GUID but with a different IP\naddress, 207.226.46.xxx. We noticed that 207.226.46.xxx was also associated with every\nother GUID in rec.dat. We determined that this IP address is associated with a satellite\nconnection.\n\nOver a period of more than a year, we downloaded and analyzed this file at regular intervals,\nobtaining a total of 388 rec.dat samples from each of time-local[.]com and time-local[.]net\n(we also began pulling samples of rec.dat from new servers we detected in scanning). Our\nrec.dat files from time-local[.]com contain more than 32 million entries (more than 28 million\nentries are operator interactions and approximately 4 million are victim interactions).\n\nIn all of our rec.dat samples from time-local[.]com and time-local[.]net, we noted that entries\nin the logfile for all GUIDs with types 2, 21, and 33 only ever involved the IP address\n207.226.46.xxx (except for a brief period of three hours on a single day, where we saw the\nactivity “fail over” between 207.226.46.xxx and two other IP addresses, one VPN address,\nand one address in Ethiopia). Thus, we suspect that types 2, 21, and 33 represent\ninteraction by the operator. We suspect that types 17 and 37 correspond to interactions by\ninfected devices.\n\n**Table 6: IP addresses that the Ethiopian operator connected from.**\n\n**IP** **Provider**\n\n207.226.46.xxx Satellite Connection\n\n197.156.86.xxx Ethio Telecom\n\n192.186.133.xxx CyberGhost VPN\n\nThat the attacker’s activity “failed over” between their satellite IP and an Ethio Telecom\naddress suggests that the operator is inside Ethiopia.\n\n**5.2.2. Thirteen Servers Show a Cyberbit Nexus**\n\nOur scanning found 15 PSS C&C servers in all. Of those, two were the Ethiopia servers. Of\nthe remaining 13 we found, we suspect all are operated by Cyberbit, perhaps as\ndemonstration or development servers. Ten of the servers’ logfiles included the IP address\n37.142.120.xxx, which is pointed to by a subdomain of cyberbit[.]net. Two other servers’\nlogfiles included the IP address 64.251.13.xxx, which also appeared in the logfile of one of\nthe seven servers, as an operator of infections connecting back from 37.142.13.xxx, an IP\naddress pointed to by a subdomain of cyberbit[.]net.\n\n\n-----\n\nOne of the servers, pupki[.]co, was unavailable when we tried to fetch rec.dat. The domain\nname was registered to a “Yevgeniy Gavrikov”. An individual by this name currently works as\n[an “integration specialist” for Cyberbit, according to LinkedIn.](https://www.linkedin.com/in/yevgeniy-gavrikov-92a95956/)\n\n## 6. Other PSS Activity\n\n 6.1. Scanning for More C&C Servers\n\nWe fingerprinted the command and control (C&C) servers used by the spyware, time**local[.]com and time-local[.]net, based on the fact that they typically returned the following**\ndistinctive message upon a normal GET / HTTP/1.1 request:\n\nPHP Configuration Error. Can not fetch xml request string\n\nOver the course of our scanning, we found a total of 15 IP addresses matching this same\nfingerprint.\n\n**Table 7: PSS C&C servers we found in IPv4 scanning.**\n\n**C&C IP Address** **Domain Name3**\n\n51.15.48.xxx\n\n80.82.64.32 time-local[.]com\n\n80.82.67.xxx\n\n80.82.79.44 time-local[.]net\n\n89.248.170.xxx\n\n93.174.89.xxx\n\n93.174.91.xxx\n\n93.174.91.xxx\n\n94.102.53.xxx\n\n94.102.60.xxx\n\n94.102.63.xxx\n\n104.236.23.3 pupki[.]co\n\n111.90.147.xxx\n\n185.125.230.xxx\n\n\n-----\n\n**C&C IP Address** **Domain Name3**\n\n185.125.230.xxx\n\n## 6.2. Demonstration Websites\n\nBy examining sites on the same IP address as eastafro[.]net, we found two additional sites:\none site impersonating Download.com and one website impersonating the homepage of\nAvira Antivirus. These sites contained versions of several apps bundled with PSS, including\nAvira Antivirus, Ventrilo, Avast AntiVirus, and CCleaner. The versions of PSS we found\ntalked to C&C servers in the list above that we identified as Cyberbit-run servers.\n\n## 6.3. Public Logfile Analysis of Other Servers\n\nIn addition to the Ethiopia servers (Section 5.2), we analyzed the logfiles of 12 of the 13\nother servers. We were able to identify what we believe are several product demonstrations\nto various clients around the world. Most of the demonstrations show similar patterns: activity\nduring business hours from IP addresses that appear to belong to potential clients and\nactivity off-hours at IP addresses that appear to belong to hotels. In a few cases, the activity\nis preceded or followed by activity from what appears to be airport Wi-Fi access points.\n\n**Figure 10: Cyberbit product demonstrations suggested by C&C logfiles.**\n\nIn our analysis here, we introduce a notion of a period of activity to try and abstract away\ngaps between logfile entries that may be uninteresting. We say that a spyware infection is\n_active between two logfile entries (we only include activity from the infected device here, i.e.,_\ntypes 17 and 37) if there is no more than an hour in between the entries. We omit periods of\n\n\n-----\n\nactivity that are less than one minute from our consideration (except if they provide evidence\nthat the infected device has moved). In each country case we present here, we are listing all\nthe activity we found across the nine Cyberbit-operated C&C servers (perhaps excluding\nperiods of activity less than a minute).\n\n### 6.3.1. Timeline of Suspected Demonstrations\n\n**_3/2016: Thailand (2 days). We found infections in Thailand from the IP 202.29.97.X, in_**\nAS4621, which appears to be an ASN used by various Thai universities. Tracerouting to\n202.29.97.X yields the hop (royal-thai-army-to-902-1-5-gi-09-cr-pyt.uni.net.th). The IPs\n202.29.97.(X-3) and 202.29.97.(X-1) return a TLS certificate whose CN is a subdomain of\nsignalschool[.]net, which is registered to the Royal Thai Army’s Signal School. We did note\nthat 202.29.97.X also appears to be a VPN. Nevertheless, it seems that the IP is under the\ncontrol of the Royal Thai Army. We also observed each infection changing between several\nIPs that appear to belong to various mobile data providers.\n\nThe table below lists periods of activity for each infection; the first column (#) indicates the\nnumber of the infection; the second and third columns provide the minimum and maximum\ndate and time of the period of activity (in the country’s local time, accounting for DST); the\nfourth column provides the duration of the period of activity (H:MM:SS); and the fifth column\nlists the location where the activity took place (or the likely identity of the agency receiving\nthe demonstration).\n\n**Table 8: March 2016 suspected demo to Royal Thai Army.**\n\n**#** **Activity Start (Local)** **Activity End (Local)** **Duration** **Location**\n\n1 Day 1 09:22:17 Day 1 10:07:05 0:44:48 Royal Thai Army\n\n2 Day 1 14:52:10 Day 1 15:38:13 0:46:03 Royal Thai Army\n\n3 Day 2 14:45:51 Day 2 17:01:11 2:15:20 Royal Thai Army\n\n**_3/2016: Uzbekistan (3 days). We found four infections in Uzbekistan. The first two were_**\nfrom an IP address pointed to by a subdomain of rdhotel[.]uz, which is registered by an\nindividual who is listed on LinkedIn as the manager of the Radisson Blu in Tashkent. The\nlatter two were from an IP address linked to Uzbekistan’s National Security Service by the\nleaked Hacking Team emails.\n\n**Table 9: March 2016 suspected demo to Uzbekistan National Security Service.**\n\n**#** **Activity Start (Local)** **Activity End (Local)** **Duration** **Location**\n\n1 Day 1 23:26:52 Day 2 00:10:00 0:43:08 Radisson Blu Tashkent\n\n2 Day 2 08:46:20 Day 2 09:06:36 0:20:16 Radisson Blu Tashkent\n\n\n-----\n\n**#** **Activity Start (Local)** **Activity End (Local)** **Duration** **Location**\n\n3 Day 2 15:40:02 Day 2 15:45:52 0:05:50 National Security Service\n\n3 Day 2 17:16:32 Day 2 18:24:42 1:08:10 National Security Service\n\n4 Day 3 12:09:17 Day 3 12:41:35 0:32:18 National Security Service\n\n4 Day 3 14:27:04 Day 3 14:53:39 0:26:35 National Security Service\n\n**_10/2016: France (1 day). We found two infections in France on the same day in October_**\n2016. The first appeared to be from an IP address associated with the airport Wi-Fi at\nParis’s Charles De Gaulle (CDG) airport. The second was from what appeared to be a\nlandline IP address in Paris, which we could not attribute.\n\n**Table 10: October 2016 suspected demo to unknown clients in France.**\n\n**#** **Activity Start (Local)** **Activity End (Local)** **Duration** **Location**\n\n1 Day 1 11:19:15 Day 1 11:24:04 0:04:49 CDG Airport Wi-Fi\n\n2 Day 1 15:24:55 Day 1 16:08:03 0:43:08 86.245.198.xxx\n\n**_11/2016: Vietnam (2 days). We found three infections in Vietnam. One was linked to an IP_**\naddress that is numerically adjacent to another IP address that returns a web interface for an\n“HP MSM760 Controller” that displays the following information:\n\nSystem name: Hilton Gardent Inn-HANOP\n\nLocation: Hanoi\n\nWe suspect that this activity is associated with the Hilton Garden Inn Hotel in Hanoi. The\nother activity appears to be from mobile broadband IP addresses; the identity of the potential\nclient is not indicated by the data.\n\n**Table 11: November 2016 suspected demo to unknown clients in Vietnam.**\n\n**#** **Activity Start (Local)** **Activity End (Local)** **Duration** **Location**\n\n1 Day 1 16:34:36 Day 1 18:52:09 2:17:33 Hilton Garden Inn Hanoi\n\n1 Day 1 18:52:48 Day 1 19:01:12 0:08:24 (Mobile Broadband)\n\n1 Day 1 19:35:50 Day 1 19:41:14 0:05:24 Hilton Garden Inn Hanoi\n\n2 Day 2 11:34:24 Day 2 12:12:26 0:38:02 (Mobile Broadband)\n\n3 Day 2 15:32:15 Day 2 17:13:41 1:41:26 (Mobile Broadband)\n\n\n-----\n\n**_12/2016: Kazakhstan (1 day). We found an infection from an IP address registered_**\n(according to WHOIS information) to “Saad Hotel LLP” with an address matching the Marriott\nHotel in Astana.\n\n**Table 12: December 2016 suspected demo to unknown clients in Kazakhstan.**\n\n**#** **Activity Start (Local)** **Activity End (Local)** **Duration** **Location**\n\n1 Day 1 14:20:07 Day 1 14:35:39 0:15:32 Marriott Hotel Astana\n\n**_12/2016: Zambia (2 days). Most of the activity was from mobile broadband IPs. However,_**\nthe second infection was from an IP pointed to by a subdomain of fic.gov[.]zm, the website\nfor Zambia’s Financial Intelligence Centre.\n\n**Table 13: December 2016 suspected demo to Zambia Financial Intelligence Centre.**\n\n\n**Activity End**\n**(Local)** **Duration** **Location**\n\n\n**#**\n\n\n**Activity Start**\n**(Local)**\n\n\n1 Day 1 21:23:21 Day 1 21:57:52 0:34:31 (Mobile Broadband)\n\n1 Day 2 05:20:05 Day 2 05:43:38 0:23:33 (Mobile Broadband)\n\n2 Day 2 11:00:52 Day 2 11:29:37 0:28:45 Financial Intelligence\nCentre\n\n**_1/2017: Rwanda (2 days). We could not attribute any of the IPs in Rwanda._**\n\n**Table 14: January 2017 suspected demo to unknown clients in Rwanda.**\n\n**#** **Activity Start (Local)** **Activity End (Local)** **Duration** **Location**\n\n1 Day 1 17:10:48 Day 1 18:28:47 1:17:59 (Unknown Loc 1)\n\n1 Day 1 22:49:12 Day 1 23:27:30 0:38:18 (Unknown Loc 2)\n\n2 Day 1 23:30:16 Day 2 04:18:06 4:47:50 (Unknown Loc 2)\n\n3 Day 2 09:14:59 Day 2 09:27:34 0:12:35 (Unknown Loc 1)\n\n4 Day 2 09:54:15 Day 2 10:51:47 0:57:32 (Unknown Loc 1)\n\n5 Day 2 10:01:45 Day 2 12:54:13 2:52:28 (Unknown Loc 1)\n\n**_2/2017: Philippines (5 days). We found an infection in February 2017 at 116.50.244.15. The_**\nIPs 116.50.244.10, 116.50.244.7, and 116.50.244.8 are pointed to by\nmanila.newworldhotels.com or subdomains thereof. 116.50.244.7 is a Cisco VPN login page,\n\n\n-----\n\nwhich lists the Group as New_World_Makati. We assume that the Manila New World\nMakati Hotel is also the owner of 116.50.244.15.\n\nThis was followed by an infection one day later at an IP address pointed to by a subdomain\nof malacanang.gov[.]ph, which is the website of Malacañang Palace. The palace is the\nprimary residence and offices of the Philippine President (Rodrigo Duterte as of the date of\nthe demo). The Malacañang Palace infection was followed by an infection from two other IP\naddresses in the Philippines.\n\n**Table 15: February 2017 suspected demo to Philippines Presidency.**\n\n\n**Activity End**\n**(Local)** **Duration** **Location**\n\n\n**#**\n\n\n**Activity Start**\n**(Local)**\n\n\n1 Day 1 18:40:13 Day 1 18:55:01 0:14:48 New World Makati Hotel\nManila\n\n2 Day 2 12:01:08 Day 2 12:25:50 0:24:42 Malacañang Palace\n\n3 Day 3 11:32:08 Day 3 11:53:13 0:21:05 112.198.102.xxx\n\n3 Day 5 21:52:32 Day 5 22:28:55 0:36:23 202.57.61.xxx\n\n**_3/2017: Kazakhstan (1 day). We found an infection from an IP address pointed to by_**\n[kazimpex[.]kz. According to an article on IntelligenceOnline, Kazimpex is said to be closely](https://www.intelligenceonline.com/corporate-intelligence/2016/06/15/western-companies-seek-key-to-kazakhstan,108170149-EVE)\nlinked with the “National Security Committee of the Republic of Kazakhstan” (KNB), an\nintelligence agency in Kazakhstan.\n\n**Table 16: March 2017 suspected demo to Kazimpex in Kazakhstan.**\n\n**#** **Activity Start (Local)** **Activity End (Local)** **Duration** **Location**\n\n1 Day 1 11:29:55 Day 1 12:03:32 0:33:37 Kazimpex\n\n**_3/2017: Serbia (2 days). We found activity from Serbia on a single IP address registered to_**\n“NBGP Properties Doo,” which is the trading name of an apartment complex and business\ncentre located adjacent to the Crowne Plaza in Belgrade. Both NBGP and the Crowne Plaza\nare owned by Delta Holding, a major Serbian company. It is possible that activity from the IP\n79.101.39.101 includes activity from both NBGP and the Crowne Plaza.\n\n**Table 17: March 2017 suspected demo to unknown clients in Serbia.**\n\n**#** **Activity Start (Local)** **Activity End (Local)** **Duration** **Location**\n\n1 Day 1 12:20:42 Day 1 12:55:11 0:34:29 Delta Holding Complex\n\n1 Day 2 00:15:30 Day 2 00:33:06 0:17:36 Delta Holding Complex\n\n\n-----\n\n**#** **Activity Start (Local)** **Activity End (Local)** **Duration** **Location**\n\n2 Day 2 00:51:04 Day 2 01:15:15 0:24:11 Delta Holding Complex\n\n2 Day 2 06:58:53 Day 2 07:41:58 0:43:05 Delta Holding Complex\n\n**_3/2017: Nigeria (2 days). We found one infection in Nigeria from two IPs. We could not_**\nidentify the IPs.\n\n**Table 18: March 2017 suspected demo to unknown clients in Nigeria.**\n\n**#** **Activity Start (Local)** **Activity End (Local)** **Duration** **Location**\n\n1 Day 1 16:38:52 Day 1 17:11:57 0:33:05 (Unknown Loc 1)\n\n1 Day 1 18:21:41 Day 1 19:13:24 0:51:43 (Unknown Loc 1)\n\n1 Day 2 10:26:20 Day 2 11:43:28 1:17:08 (Unknown Loc 2)\n\n**_4/2017: Kazakhstan (1 day). We found an infection from the Marriott hotel in Astana,_**\nfollowed by an infection from an IP pointed to by a subdomain of mcmr[.]kz, the website of\n“Mobil Realty,” a commercial real estate management company.\n\n**Table 19: April 2017 suspected demo to unknown clients in Kazakhstan.**\n\n**#** **Activity Start (Local)** **Activity End (Local)** **Duration** **Location**\n\n1 Day 1 12:26:04 Day 1 12:37:55 0:11:51 Marriott Hotel Astana\n\n2 Day 1 18:09:50 Day 1 18:21:54 0:12:04 Mobil Realty\n\n**_6/2017: ISS World Europe (2 days). We saw four infections between 6/14/2017 and_**\n6/15/2017 from IP address 82.142.85.165 in the Czech Republic. ISS World Europe 2017\nwas held in Prague, Czech Republic from 6/13/2017 – 6/15/2017, and Cyberbit gave a\n[presentation on 6/13/2017, according to the schedule. This same IP address appears in the](https://www.issworldtraining.com/ISS_EUROPE/)\n[headers of leaked Hacking Team emails sent by two employees on 6/3/2015 and](https://wikileaks.org/hackingteam/emails/emailid/36151) [6/4/2015.](https://www.wikileaks.org/hackingteam/emails/emailid/396048)\n[These employees mentioned that they would be](https://wikileaks.org/hackingteam/emails/emailid/235704) [attending ISS World Europe on 6/3/2015,](https://wikileaks.org/hackingteam/emails/emailid/35863)\nheld at the same venue as the 2017 ISS World Europe. The IP address 82.142.85.165 may\nbe associated with the Clarion Congress Hotel in Prague (the ISS World Europe venue).\n\n**Table 20: June 2017 suspected demo at ISS World Europe in Prague.**\n\n**#** **Activity Start (Local)** **Activity End (Local)** **Duration** **Location**\n\n1 2017-06-14 13:17:46 2017-06-14 13:52:04 0:34:18 ISS World Europe\n\n3 2017-06-14 16:45:04 2017-06-14 17:27:33 0:42:29 ISS World Europe\n\n\n-----\n\n**#** **Activity Start (Local)** **Activity End (Local)** **Duration** **Location**\n\n3 2017-06-15 07:18:23 2017-06-15 07:19:38 0:01:15 ISS World Europe\n\n4 2017-06-15 08:17:18 2017-06-15 09:36:03 1:18:45 ISS World Europe\n\n**_6/2017: Zambia (2 days). Most of the activity was from mobile broadband IPs._**\n\n**Table 21: June 2017 suspected demo to unknown clients in Zambia.**\n\n**#** **Activity Start (Local)** **Activity End (Local)** **Duration** **Location**\n\n1 Day 1 19:00:54 Day 1 19:38:34 0:37:40 (Mobile Broadband)\n\n2 Day 2 09:44:48 Day 2 10:22:28 0:37:40 (Mobile Broadband)\n\n3 Day 2 14:36:18 Day 2 15:00:00 0:23:42 (Mobile Broadband)\n\n3 Day 2 21:59:59 Day 2 22:19:09 0:19:10 (Mobile Broadband)\n\n**_11/2017: Philippines (6 days). In November 2017, we observed what appeared to be two_**\ndifferent Cyberbit employees travelling together from Israel to the New World Makati Hotel in\nManila.\n\nThe infections started out in Israel, one on 10/15/2017 and one on 11/2/2017. While in Israel,\nand during the workweek (Sunday to Thursday), both infections connected from what\nappears to be Cyberbit’s office (37.142.13.xxx, pointed to by two subdomains of\ncyberbit[.]net) during business hours (roughly 09:00 – 18:00 local time). After hours, the\ninfections connected back from what we believe are home IP addresses of the employees.\nEach infection connected back from different home IPs during overlapping periods, which\nleads us to believe that the two infections represent different Cyberbit employees. It appears\nthat each employee was carrying an infected laptop between home and the office each day\n(perhaps for spyware development and testing purposes).\n\nAfter they last connected from Israel, one infection connected 15 hours later from Hong Kong\nfor six minutes, between 14:52 and 14:58 local time. The infections then connected from the\nPhilippines (116.50.244.xxx) as early as 22:41 local time, suggesting a flight itinerary from Tel\nAviv to Manila, by way of Hong Kong.\n\n**Table 22: Employee #1 traveling from Israel to Manila; suspected demo to unknown**\n**clients.**\n\n\n**Activity End**\n**(Local)** **Duration** **Location**\n\n\n**#**\n\n\n**Activity Start**\n**(Local)**\n\n\n1 Day -1 15:46:24 Day -1 15:46:24 0:00:00 (DSL IP in Israel)\n\n\n-----\n\n**Activity End**\n**(Local)** **Duration** **Location**\n\n\n**#**\n\n\n**Activity Start**\n**(Local)**\n\n\n1 Day 1 14:52:15 Day 1 14:58:04 0:05:49 (Hong Kong)\n\n1 Day 1 23:00:03 Day 1 23:56:11 0:56:08 New World Makati Hotel\nManila\n\n1 Day 3 20:19:20 Day 3 21:01:09 0:41:49 New World Makati Hotel\nManila\n\n1 Day 4 14:42:43 Day 4 14:44:39 0:01:56 (Mobile Broadband)\n\n1 Day 4 16:14:21 Day 4 18:31:40 2:17:19 (Mobile Broadband)\n\n1 Day 4 20:54:47 Day 5 08:00:09 11:05:22 New World Makati Hotel\nManila\n\n1 Day 9 09:05:14 Day 9 12:59:54 3:54:40 Cyberbit\n\n**Table 23: Employee #2 traveling from Israel to Manila; suspected demo to unknown**\n**clients.**\n\n\n**Activity End**\n**(Local)** **Duration** **Location**\n\n\n**#**\n\n\n**Activity Start**\n**(Local)**\n\n\n2 Day -1 15:00:24 Day -1 17:32:38 2:32:14 (DSL IP in Israel)\n\n2 Day 1 22:41:32 Day 2 00:00:08 1:18:36 New World Makati Hotel\nManila\n\n2 Day 3 20:49:07 Day 3 21:07:51 0:18:44 New World Makati Hotel\nManila\n\n2 Day 4 10:30:03 Day 4 18:24:22 7:54:19 (Mobile Broadband)\n\n2 Day 5 10:32:42 Day 5 10:56:48 0:24:06 (Mobile Broadband)\n\n2 Day 5 13:04:42 Day 5 15:43:05 2:38:23 (Mobile Broadband)\n\n2 Day 6 15:56:27 Day 6 17:47:18 1:50:51 New World Makati Hotel\nManila\n\n2 Day 9 09:13:20 Day 9 18:56:35 9:43:15 Cyberbit\n\n**_11/2017: Milipol Paris (4 days): From 11/21/2017 – 11/24/2017, we found an infection_**\nactive from an IP address 185.113.160.20, which appears to be associated with the Paris\n_Nord Villepinte exhibition center. The IP is pointed to by several subdomains of_\n\n\n-----\n\nvillepinte2017.dynu[.]net and also by pnv.vipnetwork[.]fr. The Milipol Paris 2017 exhibition\nwas held between 11/21 and 11/24 and the Paris Nord Villepinte exhibition center. Thus, it\nappears that Cyberbit employees were performing demos there.\n\n**Table 24: November 2017 suspected demo at Milipol Paris.**\n\n**#** **Activity Start (Local)** **Activity End (Local)** **Duration** **Location**\n\n3 Day 1 08:15:24 Day 1 09:18:21 1:02:57 Milipol Paris\n\n3 Day 1 10:44:02 Day 1 13:21:09 2:37:07 Milipol Paris\n\n3 Day 1 14:50:25 Day 1 15:32:46 0:42:21 Milipol Paris\n\n3 Day 2 08:29:27 Day 2 17:01:11 8:31:44 Milipol Paris\n\n3 Day 3 08:10:28 Day 3 09:34:09 1:23:41 Milipol Paris\n\n3 Day 3 13:02:05 Day 3 14:59:37 1:57:32 Milipol Paris\n\n3 Day 3 15:43:03 Day 3 17:02:29 1:19:26 Milipol Paris\n\n3 Day 4 08:31:07 Day 4 10:43:35 2:12:28 Milipol Paris\n\n### 6.3.2. Suspected Researcher Activity\n\nWe found several short-lived infections on Cyberbit-operated servers that seem less likely to\nbe purposeful infections and more consistent with activity by cybersecurity researchers or\nother testing activity. We group activity that is temporally similar below, though it is unclear if\nthis activity is related.\n\nWe found one infection in the UK on 11/10/2016 lasting ~15s.\n\nWe found one infection from Google on 2/7/2017 (lasting 11m), followed by three infections\nin Germany on 2/7/2017 and 2/8/2017. In Germany, there was one initial infection 14\nminutes after the Google infection, with a single pingback. 2h10m later, there was an\ninfection lasting 1 minute. 13h later, there was an infection with a single pingback.\n\nWe found an infection with a single pingback from an IP address in Everett, Washington,\n**USA on 10/17/2017. We found two overlapping infections in Russia on 10/18/2017 (~2m**\neach), followed 20 minutes later by two infections in China, 45 minutes apart (~30s each).\nWe found a ~20s infection in Canada on 10/19/2017.\n\nWe found an infection with a single pingback from an IP address registered to Brandon\n**University in Canada on 10/31/2017. We found two infections in Norway on 11/1/2017 (one**\ninfection with a single pingback, and one infection 3m30s later lasting for ~20s).\n\n\n-----\n\n### 6.3.3. Unexplained Activity\n\nWe found several infections on the Cyberbit-operated PSS C&C servers that were longrunning, and not from VPN connections or from countries where Cyberbit has a known\npresence. Thus, this activity did not immediately seem to represent demonstrations or\ndevelopment activity. We found one infection in Iran between 9/20/2016 and 11/22/2016. We\nfound one infection in Canada between 3/7/2017 and 11/22/2017. We found one infection in\n**Finland between 5/26/2017 and 11/28/2017. We found one infection in Indonesia from**\n10/28/2017 to 11/10/2017. We found one infection in Slovakia from a single IP address\nactive between 11/1/2017 and 12/1/2017. We found one infection in Ethiopia from\n10/25/2017 to 12/1/2017, with no known overlap with the Ethiopia client’s IP address space.\n\n## 6.4. Spoofed Code Signing Certificates?\n\nWe identified several cases where we suspect that the spyware operators, or Cyberbit\nthemselves, obtained digital certificates in the names of real companies, including an Israeli\nintellectual property law firm.\n\nOne malicious Adobe Flash executable we found used by the Ethiopian operator was signed\nby an authenticode certificate issued by Comodo to a named entity called “Flashpoint IP.”\n\nCN = Flashpoint IP\n\nO = Flashpoint IP\n\nSTREET = 2nd Raban Gamliel\n\nL = Elad\n\nS = Israel\n\nPostalCode = 40800\n\nC = IL\n\nRFC822 Name=ben.wiseman@flashpoint-ip.com\n\nWe found a company called “Flash Point IP,” with the same street address as in the digital\n[certificate, included the Patent Attorneys Ledger published by Israel’s Ministry of Justice. The](http://www.justice.gov.il/En/Units/ILPO/About/PatentAttorneys/Pages/Patentattorneysledger.aspx)\nwebsite listed by the Ministry of Justice for the firm is flashpointip.com. However, the\nwebsite in the certificate’s RFC822 name appears to be a lookalike domain that is subtly\n_different: flashpoint-ip[.]com._\n\nWe examined the WHOIS registration of the lookalike domain flashpoint-ip[.]com:\n\nRegistrant Name: BEN WISEMAN\n\nRegistrant Organization: FLASHPOINT IP LTD\n\nRegistrant Street: RABAN GAMLIEL 2\n\nRegistrant City: ELAD\n\nRegistrant State/Province: SHOMRON\n\nRegistrant Postal Code: 40800\n\n\n-----\n\nRegistrant Country: IL\nRegistrant Phone: +972.525649427\nRegistrant Email: BENWISEMAN99@GMAIL.COM\n\nThe firm’s website, flashpointip.com, has a New York registration address, a different\nregistrant name, and a @bezeqint.net contact address.\n\nWe found one additional domain, cd-media4u[.]com, registered with the same phone\nnumber as flashpoint-ip[.]com. The WHOIS information is:\n\nRegistrant Name: DAN WISEMAN\nRegistrant Organization: C. D. MEDIA LTD\nRegistrant Street: BEN YEHUDA 60\nRegistrant City: TEL AVIV\nRegistrant State/Province: TEL AVIV\nRegistrant Postal Code: 6343107\nRegistrant Country: IL\nRegistrant Phone: +972.525649427\nRegistrant Email: DANWISEMAN99@GMAIL.COM\n\nNote the similar names Dan Wiseman and Ben Wiseman and the similar email addresses\n**danwiseman99@gmail.com and benwiseman99@gmail.com. We found one reference to**\n“CD Media Ltd” which appears to be an Israeli software publisher (http://www.cdmedia.co.il/).\n\nGiven that we found two instances where the same entity (WHOIS phone number\n+972.525649427) registered what appear to be lookalike domains for two different Israeli\ncompanies, it is possible that these certificates may have been improperly obtained. This is\nnot the first instance in which improperly obtained digital certificates may have been used\n[with commercial spyware. Hacking Team appears to have obtained several digital certificates](https://wikileaks.org/hackingteam/emails/emailid/102921)\nin the names of people whose passport photos appeared on a now-defunct site,\n**thewhistleblowers[.]org.4**\n\n[January 12, 2018 update: Following publication of this report, FlashPoint IP Ltd. (FPIP)\n[confirmed in a letter to the Citizen Lab that “the referenced digital certificate…was not](https://citizenlab.ca/wp-content/uploads/2017/12/Response-to-Citizen-Lab-report-Dec-2017.pdf)\nobtained by FPIP, and upon information and belief was obtained unlawfully… The alleged\nmisuse of the FPIP name and address is absolutely illegal and without FPIP’s knowledge,\nand certainly was never approved by any authorized representative.” Additionally, FPIP\nnoted that it sent a cease and desist letter to Cyberbit, which responded “with a general\ndenial of any wrongdoing or unlawful activity on their part, and rejecting the assertions raised\nin the FPIP letter. Nonetheless, their letter mentioned (without any admission/consent or\nprejudice to their rights) that Cyberbit shall take steps to ensure that its products do not use\nthe FPIP name or address or any certificate bearing the FPIP name.”]\n\n\n-----\n\nWe identified two further digital certificates used by the operators, in the names of Etefaq\nConsulting Ltd,” and “Emerging European Capital.” These certificates were on samples we\ndownloaded from getadobeplayer[.]com, as well as samples from the Avira Antivirus and\nDownload.com impersonation websites (Section 6.2). Unfortunately, the signatures did not\ncontain the RFC822 Name field, so we do not have any indications as to their legitimacy.\n\nCN = Emerging European Capital\nO = Emerging European Capital\nSTREET = Svaetoplukova 12\nL = Bojnice\nS = Slovakia\nPostalCode = 97201\nC = SK\n\nWe found what appears to be the website of “Emerging European Capital” (http://eecap.com), which is described as a company offering “Private Banking services to High Net\nWorth Individuals in Central and Eastern Europe.” The address in the digital certificate\nmatches an address listed on the website. The individual mentioned on the website, Martin\n[Masar, appears to be a real individual, and is listed as serving on the Supervisory Board of](http://www.pcbu.com.ua/en/files/PCBU%20presentation.pdf)\nPetrocommerce Ukraine Bank. However, without more information, we cannot know whether\nthe digital certificate is legitimate or not.\n\nCN = ETEFAQ CONSULTING LIMITED\nO = ETEFAQ CONSULTING LIMITED\nSTREET = 1 MYKONOS STREET\nL = NICOSIA\nS = NICOSIA\nPostalCode = 1045\nC = CY\n\nWe found an “ETEFAQ CONSULTING LIMITED” in the Cyprus corporate registry (# ΗΕ\n329071). However, the registered address did not match the address in the digital certificate.\nThe company’s line of business is unclear, and it appears to maintain a simple (hacked)\nwebsite with a “Contact Us” form (http://etefaqconsulting.com/).\n\n## 7. Technical Analysis of the Spyware\n\nAltogether, we analyzed nine samples. This includes the sample from VirusTotal signed by\nthe “C4 Security” certificate (Section 5.1), as well as five samples gathered from\n**getadobeplayer[.]com, and three samples gathered from the Avira Antivirus and**\nDownload.com impersonation websites (Section 6.2).\n\n\n-----\n\nBased on strings found during our analysis of configuration files used by the spyware, these\nsamples cover versions of PSS ranging from v4.3.3 to 6.1.0. Major version changes contain\nchanges to obfuscation techniques, overall structure, and general functionality, while minor\nversion changes seem to contain smaller, less noticeable changes. The following analysis\ncovers the general behavior and characteristics of PSS, with version-specific differences\nnoted where appropriate.\n\n**Table 25: Versions of PSS we analyzed**\n\n\n**MD5** **Source**\n\n\n**PSS**\n**Version**\n\n\n376f28fb0aa650d6220a9d722cdb108d VirusTotal 4.3.3\n\n568d8c43815fa9608974071c49d68232 getadobeplayer[.]com 5.7.5\n\n80b7121c4ecac1c321ca2e3f507104c2 getadobeplayer[.]com 5.1.0\n\n8d6ce1a256acf608d82db6539bf73ae7 getadobeplayer[.]com 5.9.7\n\n840c4299f9cd5d4df46ee708c2c8247c getadobeplayer[.]com 6.0.0\n\n961730964fd76c93603fb8f0d445c6f2 getadobeplayer[.]com 6.0.0\n\n\n0488cf9c58f895076311bf8e2d93bf63 Avira Antivirus Impersonation\nWebsite\n\nca782d91daea6d67dfc49d6e7baf39b0 Download.com Impersonation\nWebsite\n\nf483fe294b4c3af1e3c8163200d60aae Download.com Impersonation\nWebsite\n\n## 7.1. Overview\n\n\n6.0.0\n\n6.0.0\n\n6.1.0\n\n\nOverall, the samples we analyzed are made up of four main components: the Agent,\n**LnkProxy, Payload DLL, and Pipeserver. The Agent is the main program responsible for**\nproviding operators remote access to an infected machine and carries out most activity after\ninfection. If the Agent is not installed with administrator privileges, then the LnkProxy\nfacilitates the replacement of shortcut (lnk) and executable (exe) files with malicious versions\nthat will try to trick the user into granting administrator privileges to the Agent. The Payload\n**DLL is a small DLL file that is used to infect certain whitelisted DLLs as a persistence**\nmechanism, to ensure that the Agent is running. Finally, the Pipeserver is used to\ncoordinate access to global handles and perform network communication.\n\n\n-----\n\nEach of these four components is packed and stored inside the initial spyware payload. The\nearliest version we analyzed (4.3.3) stored these files as either plaintext or as zlib\ncompressed data. Later versions added AES-256-CBC encryption and the use of different\nkeys per dropped component for additional obfuscation (Section 7.3).\n\n## 7.2. Installation and Persistence\n\nOnce a victim executes one of the initial payloads (e.g., a fake Adobe Flash update), the\nspyware unpacks the Agent component (described in Section 7.4) and saves it to\n%TEMP%\\Profile. Then, the spyware checks to see if it is running with administrator\nprivileges. If so, then the spyware executes the dropped Agent; if not, then the spyware\nunpacks and installs the LnkProxy component (described in Section 7.5) in an attempt to\ntrick the user into giving it administrator privileges.\n\nOnce the dropped Agent has been executed with administrator privileges, either via the main\ninstaller or by tricking the user via the LnkProxy technique, the Agent unpacks its\nconfiguration file into memory. Next, the Agent checks to see if there is already a version of\nPSS installed on the victim’s system by checking for the existence of the storage directory\nused by the spyware. Depending on the configuration of the current and previous Agents, the\nAgent may either replace the existing agent or attempt to upgrade the old version. If PSS is\nnot already installed, then the Agent begins installation.\n\nThe Agent creates its main storage directory at %CommonAppData%\\Profile. Then, it\nwrites its configuration file into the storage directory, using a name defined in the\nconfiguration file (versions 4.x and 5.x use the filename diskdrv.dll, while version 6.x uses\nigfxcls.cfg). The Agent then copies itself into the storage directory (versions 4.x and 5.x use\nthe filename crisvc.exe for the agent, while version 6.x use the filename igfxcri.exe) while\ndeleting the dropped copy from %TEMP%\\Profile.\n\nNext, the Agent unpacks and drops 32- and 64-bit versions of the PipeServer component\ninto the storage directory. These files are named mssvt.dll and mssvt64.dll across all\nversions of PSS that we have analyzed.\n\nAfter it has created the necessary files, the spyware sets up its persistence mechanism by\ninfecting copies of certain DLLs on the system with the Payload DLL (which is not saved to\ndisk as a standalone file). The infected copies are placed in the same folder as the\nexecutable that will load them, ensuring that the infected DLLs are loaded instead of their\nlegitimate counterparts that may be in other folders (Windows will search the folder\ncontaining the application first). The DLLs we saw chosen for infection are related to\ncommon web browsers including Chrome, Firefox, and Internet Explorer. Since web\nbrowsers are some of the most commonly used applications on computers, these DLLs are a\ngood choice to ensure that the spyware is running most of the time that the target device is\nbeing used.\n\n\n-----\n\nFinally, the spyware initializes the appropriate PipeServer component by creating a new\n[Desktop, referred to as a “HiddenDesktop” by the spyware and launching one or more of the](https://msdn.microsoft.com/en-us/library/windows/desktop/ms682573(v=vs.85).aspx)\nEXEs whose DLLs have been replaced with infected versions on this new desktop. When an\ninfected DLL is loaded (Section 5.6), it launches the PipeServer if not already running; the\nPipeServer in turn launches the Agent if not already running. The Agent then enters into its\nmain command handling loop.\n\n## 7.3. Obfuscation\n\nThe first version of the spyware we analyzed (4.3.3) stored most components as either\nplaintext data or as zlib compressed binary data. Version 5.x of PSS introduced the\nadditional use of AES-256-CBC encryption for the components. Components obfuscated in\nthis manner contain a short header struct followed by the AES-256-CBC encrypted, zlib\ncompressed data:\n\nstruct HEADER {\n\nchar[6]: magic_number\n\nuint32: iv\n\nuint32: checksum\n\nuint32: length\n\n}\n\nIn this header struct, magic_number is the magic_number for a 7z file [0x37, 0x7a, 0xbc,\n0xaf, 0x27, 0x1c], iv is the first 4 bytes of the initialization vector used in the AES cipher,\nchecksum is a CRC32 checksum of the data, and length is the length of the encrypted data.\nThe initialization vector is padded with null bytes to the correct length for the AES-256-CBC\ncipher. Version 6.x added an additional data format for AES-256-CBC encrypted data that\nremoves the magic_number. For all versions, the AES key is hardcoded in the executable\nperforming the decryption. Beginning with version 6.x, the spyware additionally began to\nobfuscate strings, deobfuscating them only when needed.\n\nVersion 4.x drops all of its various components directly to disk in an unpacked form when\ninstalled. Starting with version 5.x, the spyware began to drop intermediate loader\nexecutables instead of final components. These loader executables store a component, often\nthe Agent, in the same AES-256-CBC encrypted, zlib compressed format as above. When\nexecuted, these loaders mimic the Windows executable loader by unpacking their stored\npayload, mapping the unpacked PE file’s sections into memory, and resolving any imports\nbefore jumping to the PE’s entrypoint. This technique of storing the unpacked component\nonly in memory is likely an attempt to evade static, file-based analysis and detection\ntechniques.\n\nWithin the Agent component, the configuration file is an SQLite database obfuscated using\nbzip compression, followed by XOR encryption using both the current and previous bytes,\nalong with one byte from the key. This obfuscation format, and an unusual 36-byte XOR key,\n\n\n-----\n\nthe string DC615DA9-94B5-4477-9C33-3A393BC9E63F, are shared across all the samples\nwe analyzed.\n\n## 7.4. The Agent\n\nThe Agent is the central component of the spyware and is responsible for carrying out most\nof the behavior of PSS. The Agent is a feature-rich spyware capable of a wide range of\nbehaviors. Across all samples we analyzed, we have seen the following capabilities:\n\nAudio/Video recording including scheduling recordings for a later time\nReading browser history and stored passwords\nFilesystem operations including creating, deleting, moving, renaming, uploading, and\ndownloading files\nEditing/Querying registry keys\nGeolocation based on available wifi networks\nAccessing Skype databases, call logs, and contacts\nListing network connections and devices\nStarting/Stopping processes\nTaking screenshots\nKeylogging\nAccessing clipboard data\nAccessing recently used file list\n\n## 7.5. LnkProxy\n\nThe LnkProxy component is only used when the spyware is initially installed without\nAdministrator privileges. In this scenario, the spyware searches through the Windows\nDesktop, Start Menu, and Quick Launch folders looking for lnk and exe files. Any files it finds\nare replaced with malicious copies designed to request administrator privileges, launch the\nlegitimate application, and then launch the spyware. This process is designed to trick the\nuser into giving PSS administrator privileges.\n\nThe LnkProxy makes a backup of all replaced files, which are restored upon spyware\nuninstallation or when the user unwittingly grants the spyware administrator privileges.\n\n## 7.6. Payload DLL\n\nThe Payload component of the spyware is a short DLL that is used to infect whitelisted DLLs\non the victim’s system as a persistence mechanism. During installation, the spyware\nsearches the victim’s computer for targeted DLLs and for each that it finds it appends the\nPayload component to the targeted DLL’s .text section. The entrypoint of the DLL is then\nchanged to point to this appended code and the infected file is copied to the same directory\n\n\n-----\n\nas the application that uses the DLL. This ensures that the infected DLL is loaded by the\napplication instead of the original, uninfected version. Figure 11 shows an example of a\nmodified binary infected with the Payload component.\n\n**Figure 11: Comparison of entrypoint before and after Payload infection.**\n\nThe infected DLL starts by checking to ensure that the infected DLL is being loaded by the\ntarget program only. It does this by calling the original entrypoint for the infected DLL to get\nthe ImagePathName field of the ProcessParameters struct in the Process Environment Block\n(PEB). The ImagePathName contains the path of the currently running executable. This is\nthen compared to a hardcoded checksum value stored in the DLL as part of the infection\nprocess.\n\nIf this check succeeds, the Payload then performs its functions. It first checks to see if the\nPipeServer is currently loaded. It does this by decrypting an XOR-encrypted string in the DLL\ncontaining the location of the PipeServer component, calculating a checksum of this string,\nand then walking the InMemoryOrder list of loaded modules, checksumming the\n\n\n-----\n\nImagePathName of each and comparing it to the checksum of the PipeServer s path. If the\nPipeServer is not currently loaded, the infected DLL loads the PipeServer component and\ntransfers execution to it.\n\n## 7.7. PipeServer\n\nThe PipeServer component starts by unpacking and loading a small configuration file. This is\na small file containing ASCII strings separated by \\x00’s that define various config options\nused by the PipeServer. In version 6.x, this file is zlib compressed and encrypted using AES256-CBC. After loading the configuration file, the PipeServer creates a series of threads,\nglobal events, and mutexes that are used to synchronize actions between components of the\nspyware, log messages, and communicate with the command and control server. Next, the\nPipeServer creates a named pipe for communication with running Agent components.\nFinally, the PipeServer starts an instance of the Agent if one is not already active before\nentering a main command handling loop. The spyware uses a XML-based networking\nprotocol for command and control communication. Each request and response is sent as a\n“transaction.” An example of the XML format used is given below.\n\n<?xml version=”1.0″>\n\n<transaction\n\ntype=”fromagent”\n\nagentid=”<ID>”\n\nsn=”<NUM>”\n\ncrc=”<CRC>”\n\nencoding=”base64″\n\nencryption=”aes-256″\n\ncompression=”<zip|none>”>\n\n<DATA>\n\n</transaction>\n\nDATA is the information to be communicated and is compressed, encrypted, and encoded as\ndescribed in the response attributes. The AES key used can be either a master key included\nin the Agent’s configuration or an individual private key created after the malware has been\ninstalled and initialized. The master key is hard-coded and is the same across all samples\nwe analyzed.\n\n## 8. Conclusion\n\nWe have uncovered the use of PC Surveillance System (PSS) spyware by what appears to\nbe agencies of the Ethiopian government to target dozens of individuals. Our investigation\nshows these targets include an Oromo media outlet based in the United States, OMN, a PhD\nstudent, and a lawyer who have worked on Oromo issues, as well as a Citizen Lab Research\nFellow, Bill Marczak. Our analysis also indicates apparent demonstrations of the spyware in\n\n\n-----\n\nseveral other countries where leaders have exhibited authoritarian tendencies, and/or where\nthere are political corruption and accountability challenges, such as Nigeria, Philippines,\nRwanda, Uzbekistan, and Zambia.\n\nThe habitual misuse of spyware by the Ethiopian government against civil society targets is\ntestament to the lack of repercussions for such behavior by states and complicity within the\ncommercial spyware industry that supplies them. Evidence indicating the Ethiopian\n[government’s misuse of spyware (including Hacking Team’s RCS and](https://citizenlab.ca/2015/03/hacking-team-reloaded-us-based-ethiopian-journalists-targeted-spyware/) Gamma Group’s\nFinSpy) against journalists, activists, and others has been laid out in prior research over\n[multiple years, as well as in a lawsuit filed in US federal court. In a portentous ruling, that suit](https://www.eff.org/cases/kidane-v-ethiopia)\nwas dismissed on grounds that a tort is not committed entirely in the US — a showing of\nwhich was required to obtain jurisdiction over a foreign sovereign — when a government’s\ndigital espionage is conceived of and operated from overseas, despite the fact that the\ninfection occurs and harm is experienced within the US. The digital nature of the tort\nessentially allowed a foreign government to violate US laws with impunity. Unsurprisingly, as\nthis report makes clear, the extraterritorial targeting continues, as do spyware sales to\nEthiopia.\n\nThis report also uncovers another player in the nation-state spyware business: Cyberbit, the\ncompany that provides PSS. As a provider of powerful surveillance technology, Cyberbit has\nthe responsibility under both Israel’s export control regime as well as the UN Guiding\nPrinciples on Business and Human Rights to concern itself with the potential for human\nrights abuses facilitated through use of its product. The fact that PSS wound up in the hands\nof Ethiopian government agencies, which for many years have demonstrably misused\nspyware to target civil society, raises urgent questions around Cyberbit’s corporate social\nresponsibility and due diligence efforts, and the effectiveness of Israel’s export controls in\npreventing human rights abuses. The apparent locations of PSS demonstrations reinforce\nthose concerns. Moreover, the manner in which the PSS spyware operates suggests that, to\nachieve infection, the spyware preys on user trust in legitimate third-party companies and\nsoftware, such as Adobe Systems, or the code-signing certificate verification process. These\ntechniques undermine security in the larger digital ecosystem and contravene terms of\nservice as well as clear legal standards that exist in many jurisdictions to prevent\nappropriation of intellectual property. If spyware companies themselves incorporate such\ntechniques in order to build a successful product, action is necessary to address the negative\n[externalities that result. We have sent a letter to Cyberbit regarding these issues and](https://citizenlab.ca/wp-content/uploads/2017/12/Cyberbit-Letter.pdf)\nreceived a response.\n\nAs we [explore in a separate analysis, while lawful access and intercept tools have legitimate](https://citizenlab.ca/2017/12/legal-overview-ethiopian-dissidents-targeted-spyware/)\nuses, the significant insecurities and illegitimate targeting we have documented that arise\nfrom their abuse cannot be ignored. In the absence of stronger norms and incentives to\ninduce state restraint, as well as more robust regulation of spyware companies, we expect\n\n\n-----\n\nthat authoritarian and other politically corrupt leaders will continue to obtain and use spyware\nto covertly surveil and invisibly sabotage the individuals and institutions that hold them to\naccount.\n\n## 9. Acknowledgements\n\nThis work was supported in part by the Center for Long Term Cybersecurity (CLTC) at UC\nBerkeley. Thanks also to Erik Zouave, Masashi Crete-Nishihata, Lex Gill, Etienne Maynier,\nAdam Senft, Miles Kenyon, Jawar Mohammed, Etana Habte, Henok Gabisa, and Felix\nHorne and Cynthia Wong from Human Rights Watch.\n\n## Footnotes\n\n1. We found these materials in a Google search. The materials are hosted in an Amazon\n\nS3 bucket whose name is cyberbit. Inspecting the source code of Cyberbit’s website\n[(https://web.archive.org/web/20170930094240/https://www.cyberbit.com/) yields](https://web.archive.org/web/20170930094240/https://www.cyberbit.com/)\nseveral references to the same S3 bucket. Thus, we assume Cyberbit controls the S3\nbucket named cyberbit and that the marketing materials are Cyberbit originals.\n[2. In January 2016, Cyberbit attempted to convince the WIPO Arbitration and Mediation](http://www.wipo.int/amc/en/domains/search/text.jsp?case=D2016-0126)\n\nCenter to transfer the domain to it from Cyberbit A/S, but the panel refused and\ndeclared that Cyberbit had engaged in reverse domain name hijacking by bringing its\ncomplaint in bad faith. However, Cyberbit apparently purchased the domain in March\n2017, judging by WHOIS records.\n3. We redact the domain names of non-Ethiopia servers that are still online.\n4. e.g.,\n\nhttps://web.archive.org/web/20150710202350/http://www.thewhistleblowers.org:80/?\ncat=3874\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2017/2017-12-06 - Champing at the Cyberbit Ethiopian Dissidents Targeted with New Commercial Spyware.pdf"
    ],
    "report_names": [
        "2017-12-06 - Champing at the Cyberbit Ethiopian Dissidents Targeted with New Commercial Spyware.pdf"
    ],
    "threat_actors": [
        {
            "id": "a3687241-9876-477b-aa13-a7c368ffda58",
            "created_at": "2022-10-25T16:07:24.496902Z",
            "updated_at": "2025-03-27T02:02:10.256629Z",
            "deleted_at": null,
            "main_name": "Hacking Team",
            "aliases": [],
            "source_name": "ETDA:Hacking Team",
            "tools": [],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "e90c06e4-e3e0-4f46-a3b5-17b84b31da62",
            "created_at": "2023-01-06T13:46:39.018236Z",
            "updated_at": "2025-03-27T02:00:02.978356Z",
            "deleted_at": null,
            "main_name": "Hacking Team",
            "aliases": [],
            "source_name": "MISPGALAXY:Hacking Team",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673535583,
    "ts_updated_at": 1743041407,
    "ts_creation_date": 1653752384,
    "ts_modification_date": 1653752384,
    "files": {
        "pdf": "https://archive.orkl.eu/7171dd67dd195184a27f90c3bed1fe4a5650b92b.pdf",
        "text": "https://archive.orkl.eu/7171dd67dd195184a27f90c3bed1fe4a5650b92b.txt",
        "img": "https://archive.orkl.eu/7171dd67dd195184a27f90c3bed1fe4a5650b92b.jpg"
    }
}