{
    "id": "4b43c3d3-4c8a-4ec9-9ce3-af3d8649dfc3",
    "created_at": "2023-01-12T15:03:56.036586Z",
    "updated_at": "2025-03-27T02:09:29.921978Z",
    "deleted_at": null,
    "sha1_hash": "567f5148e6deb5f6475ecf842441a31406f7ca45",
    "title": "2021-10-13 - AtomSilo Ransomware",
    "authors": "",
    "file_creation_date": "2022-05-27T23:24:21Z",
    "file_modification_date": "2022-05-27T23:24:21Z",
    "file_size": 888111,
    "plain_text": "# AtomSilo Ransomware\n\n**[chuongdong.com/reverse engineering/2021/10/13/AtomSiloRansomware/](https://chuongdong.com/reverse%20engineering/2021/10/13/AtomSiloRansomware/)**\n\nChuong Dong October 13, 2021\n\n[Reverse Engineering · 13 Oct 2021](http://10.10.0.46/categories/#reverse%20engineering)\n\n## Contents\n\n Overview\n\n#### This is my analysis for AtomSilo Ransomware.\n\n AtomSilo uses the standard hybrid-cryptography scheme of RSA-512 and AES to encrypt files and protect its keys.\n\n Since it fails to utilize multithreading and uses a DFS algorithm to traverse through directories, AtomSilo’s encryption is quite slow.\n\n The malware is relatively short and simple to analyze, so it’s definitely a beginner-friendly choice for those who want to get into ransomware analysis!\n\n Figure 1: AtomSilo leak site.\n\n## IOCS\n\n#### This sample is a 64-bit Windows executable.\n\n\n-----\n\n#### MD5: 81f01a9c29bae0cfa1ab015738adc5cc\n\n SHA256: 7a5999c54f4588ff1581d03938b7dcbd874ee871254e2018b98ef911ae6c8dee\n\n Sample: https://bazaar.abuse.ch/sample/7a5999c54f4588ff1581d03938b7dcbd874ee871254e2018b9 8ef911ae6c8dee/\n\n## Ransom Note\n\n#### The content of the ransom note is stored in plaintext in AtomSilo’s executable. The encrypted victim’s RSA public key is appended to the end of the note before the files are dropped on the system.\n\n The ransom note filename is in the form of README-FILE-[Computer Name]-[Starting Timestamp].hta or index.html.\n\n Figure 2: AtomSilo ransom note.\n\n Below is the full content of the ransom note file dropped on my machine.\n\n\n-----\n\n```\n<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n  <meta charset=\"utf-8\">\n  <title>Atom Slio: Instructions</title>\n  <HTA:APPLICATION APPLICATIONNAME=\"Atom Slio\" SCROLL=\"yes\" SINGLEINSTANCE=\"yes\"\nWINDOWSTATE=\"maximize\">\n  <style type=\"text/css\">\n  .text{\n    text-align:center;\n  }\n  a {\n    color: #04a;\n    text-decoration: none;\n  }\n  a:hover {\n    text-decoration: underline;\n  }\n  body {\n    background-color: #e7e7e7;\n    color: #222;\n    font-family: \"Lucida Sans Unicode\", \"Lucida Grande\", sans-serif;\n    font-size: 13pt;\n    line-height: 19pt;\n  }\n  body, h1 {\n    margin: 0;\n    padding: 0;\n  }\n  hr {\n    color: #bda;\n    height: 2pt;\n    margin: 1.5%;\n  }\n  h1 {\n    color: #555;\n    font-size: 14pt;\n  }\n  ol {\n    padding-left: 2.5%;\n  }\n  ol li {\n    padding-bottom: 13pt;\n  }\n  small {\n    color: #555;\n    font-size: 11pt;\n  }\n  .button:hover {\n    text-decoration: underline;\n  }\n  .container {\n    background-color: #fff;\n    border: 2pt solid #c7c7c7;\n\n```\n\n-----\n\n```\n    margin: 5%;\n    min-width: 850px;\n    padding: 2.5%;\n  }\n  .header {\n    border-bottom: 2pt solid #c7c7c7;\n    margin-bottom: 2.5%;\n    padding-bottom: 2.5%;\n  }\n  .hr {\n    background: #bda;\n    display: block;\n    height: 2pt;\n    margin-top: 1.5%;\n    margin-bottom: 1.5%;\n    overflow: hidden;\n    width: 100%;\n  }\n  .info {\n    background-color: #f3f3fc;\n    border: 2pt solid #bda;\n    display: inline-block;\n    padding: 1%;\n    text-align: center;\n    box-sizing:border-box;\n    border-radius:20px;\n  }\n  .info1 {\n    background-color: #f3f3fc;\n    border: 2pt solid #bda;\n    display: inline-block;\n    padding: 1%;\n    text-align: center;\n    box-sizing:border-box;\n    border-radius:20px;\n  }\n  .h {\n    display: none;\n  }\n  .ml1{\nposition:absolute;width:50%;height:10rem;left:-211px;top:0;background:#f3f3fc;border:1\n solid #cfd3da;box-sizing:border-box;padding:2% 2%\n  }\n  </style>\n</head>\n<body>\n  <div class=\"container\">\n    <div class=\"header\">\n      <h1>Atom Slio</h1>\n      <small id=\"title\">Instructions</small>\n    </div>\n        <div class=\"text\">\n\n```\n\n-----\n\n```\n        <span style color:#f71b3a;font size:40px >WARNING! YOUR FILES ARE\nENCRYPTED AND LEAKED!</span>\n        </div>\n        <hr></hr>\n        <div class=\"info1\">\n        <p>We are AtomSilo.Sorry to inform you that your files has been\nobtained and encrypted by us.</p>\n        <p>But don’t worry, your files are safe, provided that you are\nwilling to pay the ransom.</p>\n        <p>Any forced shutdown or attempts to restore your files with the\nthrid-party software will be <span style=\"color:#f71b3a\">damage your files\npermanently!</span></p> \n        <p>The only way to decrypt your files safely is to buy the special\ndecryption software from us. </p>\n        <p>The price of decryption software is <span\nstyle=\"color:#f71b3a\">1000000 dollars</span>. <br>If you pay within 48 hours, you\nonly need to pay <span style=\"color:#f71b3a\">500000 dollars</span>. No price\nreduction is accepted.</p>\n        <p>We only accept Bitcoin payment,you can buy it from\nbitpay,coinbase,binance or others. </p>\n        <p>You have five days to decide whether to pay or not. After a week,\nwe will no longer provide decryption tools and publish your files</p>\n        </div>\n        <hr></hr>\n          <div align=\"center\">\n          <span style=\"color:#f71b3a;font-size:200%\">Time starts at 0:00 on\nSeptember 11</span>\n          <hr></hr>\n          <span style=\"color:#f71b3a;font-size:300%\">\n          <a>Survival time：</a>\n          <span id=\"td\"></span>\n          <span id=\"th\"></span>\n          <span id=\"tm\"></span>\n          <span id=\"ts\"></span>\n          </span>\n          </div>\n          <script type=\"text/javascript\">\n          function getRTime(){\n          var EndTime= new Date('2021/09/16 00:00:00');\n          var NowTime = new Date();\n          var t =EndTime.getTime() - NowTime.getTime();\n          var d=Math.floor(t/1000/60/60/24);\n          var h=Math.floor(t/1000/60/60%24);\n          var m=Math.floor(t/1000/60%60);\n          var s=Math.floor(t/1000%60);\n          document.getElementById(\"td\").innerHTML = d + \" Day \";\n          document.getElementById(\"th\").innerHTML = h + \" Hour \";\n          document.getElementById(\"tm\").innerHTML = m + \" Min \";\n          document.getElementById(\"ts\").innerHTML = s + \" Sec \";\n          }\n          setInterval(getRTime,1000);\n          </script>\n\n```\n\n-----\n\n```\n        <hr></hr>\n        <p>You can contact us with the following email:\n        <p><a href=\"mailto:arvato@atomsilo.com\"><span\nclass=\"info\">Email:arvato@atomsilo.com</span></a></p>\n        <p>If this email can't be contacted, you can find the latest email\naddress on the following website:</p>\n        <p><span class=\"info\"><a href=\"hxxp://<redacted>[.]onion\"\ntarget=\"_blank\">hxxp://<redacted>[.]onion</a></span></p>\n        <hr>\n        <p>If you don’t know how to open this dark web site, please follow\nthe steps below to installation and use TorBrowser:</p>\n        <ol>\n          <li>run your Internet browser</li>\n          <li>enter or copy the address <a\nhref=\"hxxps://www[.]torproject[.]org/download/download-easy[.]html[.]en\"\ntarget=\"_blank\">hxxps://www[.]torproject[.]org/download/download-easy[.]html[.]en</a>\ninto the address bar of your browser and press ENTER</li>\n          <li>wait for the site loading</li>\n          <li>on the site you will be offered to download TorBrowser;\ndownload and run it, follow the installation instructions, wait until the\ninstallation is completed</li>\n          <li>run TorBrowser</li>\n          <li>connect with the button \"Connect\" (if you use the English\nversion)</li>\n          <li>a normal Internet browser window will be opened after the\ninitialization</li>\n          <li>type or copy the address in this browser address bar and\npress ENTER</li>\n          <li>the site should be loaded; if for some reason the site is not\nloading wait for a moment and try again.</li>\n        </ol>\n        <p>If you have any problems during installation or use of TorBrowser,\nplease, visit <a href=\"hxxps://www[.]youtube[.]com/results?\nsearch_query=Install+Tor+Browser+Windows\"\ntarget=\"_blank\">hxxps://www[.]youtube[.]com</a> and type request in the search bar\n\"Install TorBrowser Windows\" and you will find a lot of training videos about\nTorBrowser installation and use.</p>\n        <hr>\n        <p><strong>Additional information:</strong></p>\n        <p>You will find the instructions (\"README-FILE-#COMPUTER##TIME#.hta\") for restoring your files in any folder with your encrypted files.</p>\n        <p>The instructions \"README-FILE-#COMPUTER#-#TIME#.hta\" in the\nfolders with your encrypted files are not viruses! The instructions \"README-FILE#COMPUTER#-#TIME#.hta\" will help you to decrypt your files.</p>\n        <p>Remember! The worst situation already happened and now the future\nof your files depends on your determination and speed of your actions.</p>\n      </div>\n  <span class=\"h\">\n<asf>hxmkCZnpWBWUPTcqK4aVOlLut1L3skUJ/15ha57FrzFVDAqPQao9+trRpAzyEGRAcODB4MM8+SddAnBxk\n<csf>3</csf><bsf>MSEDGEWIN10</bsf></span></body></html>\n\n## Static Code Analysis\n\n```\n\n-----\n\n## Cryptographic Keys Setup\n\n#### AtomSilo uses a simple hybrid cryptographic approach using RSA and AES from the CryptoPP library to encrypt files. The malware first randomly generates a public-private key pair for the victim and stores them in global variables.\n\n Then it encrypts the victim’s public key using its own hard-coded RSA public key and wipes the generated victim public key from memory. Since the CryptoPP code for this is nasty, the best way to analyze these functions is probably pulling function signatures down from Lumina and making assumptions based on the functions getting called.\n\n Figure 3: Cryptographic Keys Setup.\n\n Since the victim’s public key is required to decrypt files later, AtomSilo clears it out in memory after encrypting and storing the result to avoid the key being recovered from memory.\n\n Below is the hard-coded AtomSilo public RSA key.\n\n\n-----\n\n#### Figure 4: AtomSilo Public RSA Key.\n\n## Run-Once Mutex\n\n#### AtomSilo calls CreateMutexA to check if the mutex with name “8d5e957f297893487bd98fa830fa6413” already exists, and if it does, the malware exits immediately. This is to avoid having multiple instances of the malware running at the same time.\n\n\n-----\n\n#### Figure 5: Run-Once Mutex Check.\n\n## Launching Encryption Threads\n\n#### AtomSilo attempts to use multithreading to speed up traversing and encrypting files on the system. It iterates through a list of drive names from “a:” to “z:” and spawns a new thread to encrypt each.\n\n Figure 6: Spawning Encryption Threads.\n\n Figure 7: List Of Drive Names.\n\n\n-----\n\n#### The idea for multithreading is definitely there, but spawning threads this way is inefficient since the total throughputs and speed will be skewed toward the drive that has the most files inside.\n\n## Encryption Threads\n\n### Dropping Ransom Note\n\n#### For each encountered directory, AtomSilo drops a ransom note in it.\n\n First, the malware decrypts the following stack string and formats it as below.\n```\n<asf>\n</asf>\n<csf>3</csf>\n<bsf>[Computer Name]</bsf></span></body></html>\n[Directory Name]\\index.html\n[Directory Name]\\README-FILE-[Computer Name]-[Starting Timestamp].hta\n\n Figure 8: Resolving HTML Tags & Filename.\n\n The ransom note’s filenames are used depending on its dropped location. When AtomSilo encounters any file with the extensions .php, .asp, .jsp, or .html, it uses [Directory Name]\\index.html as the ransom note filename. For any other directory, it uses [Directory Name]\\README-FILE-[Computer Name]-[Starting Timestamp].hta.\n\n Finally, AtomSilo writes the content of the ransom note in in the following format.\n\n```\n\n-----\n\n```\n[Ransom Note Content]<asf>[Victim Encrypted RSA Public Key]</asf><csf>3</csf><bsf>\n[Computer Name]</bsf></span></body></html>\n\n#### Figure 9: Writing Ransom Note Content.\n\n### DFS Traversal\n\n#### Each thread uses DFS to traverse a directory being passed into it. First, to look for all files and subdirectories, it uses the standard API calls FindFirstFileA and FindNextFileA.\n\n AtomSilo stores a list of names to avoid encrypting in memory to iterate and check for each file/directory encountered. If the name of the file/directory is in the list, it is skipped and not encrypted.\n\n```\n\n-----\n\n#### Figure 10: Traversing & Skipping Files.\n\n The list of file/directory names to avoid is shown below.\n```\nBoot, Windows, Windows.old, Tor Browser, Internet Explorer, Google,\nOpera, Opera Software, Mozilla, Mozilla Firefox, $Recycle.Bin, ProgramData,\nAll Users, autorun.inf, index.html, boot.ini, bootfont.bin, bootsect.bak,\nbootmgr, bootmgr.efi, bootmgfw.efi, desktop.ini, iconcache.db, ntldr,\nntuser.dat, ntuser.dat.log, ntuser.ini, thumbs.db, #recycle, ..\n\n If AtomSilo encounters a subdirectory, the malware appends its name to the current directory path, drops a ransom note inside, and passes the path to its traversal function to recursively go through it. No need for me to discuss how much of a speed boost the ransomware gets out of this.\n\n Figure 11: Traversing Subdirectories With DFS.\n\n If AtomSilo encounters a file, the malware checks if the filename contains the following extensions.\n.atomsilo, .hta, .html, .exe, .dll, .cpl, .ini, .cab, .cur, .cpl,\n.cur, .drv, .hlp, .icl, .icns, .ico, .idx, .sys, .spl, .ocx\n\n If it does, the file is skipped and not encrypted.\n\n```\n\n-----\n\n#### Figure 12: Skipping Files Based On Extension.\n\n As discussed above, when AtomSilo encounters any file with the extensions .php, .asp, .jsp, or .html, it drops the ransom note in the path [Directory Name]\\index.html. Finally, it passes the file path to a function to encrypt it.\n\n Figure 13: Dropping Ransom Note & Encrypting File.\n\n\n-----\n\n### File Encryption\n\n#### For each file to be encrypted, AtomSilo randomly generates a 32-byte AES key. First, it gets the current system time and uses that as the seed for the C++ pseudo-random number generator through srand. Using this, the malware generates a random string of 32 characters, and each character is randomly chosen to be a lower-case letter, upper-case letter, or a number between 0-9.\n\n Figure 14: Randomly Generating AES Key.\n\n Next, the AES key is encrypted using the victim’s RSA private key.\n\n Figure 15: Encrypting AES Key With Victim Private Key.\n\n AtomSilo then opens the file using CreateFileA and maps it to the address space of the current process to read and write directly using CreateFileMappingA and MapViewOfFile.\n\n\n-----\n\n#### Figure 16: Retrieving File Handle & Mapping To Memory.\n\n Prior to encrypting the file, the malware writes the encrypted AES key to the last 0x210 bytes at the end of the file.\n\n Figure 17: Writing Encrypted AES Key To File.\n\n\n-----\n\n#### Finally, AtomSilo encrypts the file using the AES key with the AES implementation from CryptoPP, closes the file mapping handle, and appends “.ATOMSILO” to the end of the filename.\n\n Figure 18: Encrypting & Changing File Extension.\n\n## How To Decrypt\n\n#### The victim’s encrypted public RSA key is appended near the end of the ransom note, which is encrypted using AtomSilo’s public RSA key. Therefore, to decrypt the victim’s public RSA key, AtomSilo’s private RSA key is required.\n\n To decrypt a file encrypted by AtomSilo, the encrypted AES key can be extracted from the end of the file. Since the AES key is encrypted using the victim’s private RSA key, it can be decrypted using the victim’s public RSA key.\n\n## References\n\n#### https://github.com/weidai11/cryptopp\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-10-13 - AtomSilo Ransomware.pdf"
    ],
    "report_names": [
        "2021-10-13 - AtomSilo Ransomware.pdf"
    ],
    "threat_actors": [
        {
            "id": "aa73cd6a-868c-4ae4-a5b2-7cb2c5ad1e9d",
            "created_at": "2022-10-25T16:07:24.139848Z",
            "updated_at": "2025-03-27T02:02:10.120505Z",
            "deleted_at": null,
            "main_name": "Safe",
            "aliases": [],
            "source_name": "ETDA:Safe",
            "tools": [
                "DebugView",
                "LZ77",
                "OpenDoc",
                "SafeDisk",
                "TypeConfig",
                "UPXShell",
                "UsbDoc",
                "UsbExe"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535836,
    "ts_updated_at": 1743041369,
    "ts_creation_date": 1653693861,
    "ts_modification_date": 1653693861,
    "files": {
        "pdf": "https://archive.orkl.eu/567f5148e6deb5f6475ecf842441a31406f7ca45.pdf",
        "text": "https://archive.orkl.eu/567f5148e6deb5f6475ecf842441a31406f7ca45.txt",
        "img": "https://archive.orkl.eu/567f5148e6deb5f6475ecf842441a31406f7ca45.jpg"
    }
}