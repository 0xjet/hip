{
    "id": "f73aa3c5-a935-43ef-a2cd-bf37ade1f2e7",
    "created_at": "2023-01-12T15:00:03.457194Z",
    "updated_at": "2025-03-27T02:11:34.434215Z",
    "deleted_at": null,
    "sha1_hash": "995b32f54a81041de18d1ae7a703c19360515aa0",
    "title": "2018-03-09 - The Slingshot APT FAQ",
    "authors": "",
    "file_creation_date": "2022-05-28T19:31:39Z",
    "file_modification_date": "2022-05-28T19:31:39Z",
    "file_size": 492054,
    "plain_text": "# The Slingshot APT FAQ\n\n**securelist.com/apt-slingshot/84312/**\n\nAuthors\n\n[Alexey Shulmin](https://securelist.com/author/alexeyshulmin/)\n\n[Sergey Yunakovsky](https://securelist.com/author/sergeyyunakovsky/)\n\n[Vasily Berdnikov](https://securelist.com/author/vasilyberdnikov/)\n\n[Andrey Dolgushev](https://securelist.com/author/andreydolgushev/)\n\n\n-----\n\nWhile analysing an incident which involved a suspected keylogger, we identified a malicious\n[library able to interact with a virtual file system, which is usually the sign of an advanced APT](https://encyclopedia.kaspersky.com/glossary/apt-advanced-persistent-threats/?utm_source=securelist&utm_medium=blog&utm_campaign=termin-explanation)\nactor. This turned out to be a malicious loader internally named ‘Slingshot’, part of a new,\nand highly sophisticated attack platform that rivals Project Sauron and Regin in complexity.\n\nThe initial loader replaces the victim´s legitimate Windows library ‘scesrv.dll’ with a malicious\none of exactly the same size. Not only that, it interacts with several other modules including a\nring-0 loader, kernel-mode network sniffer, own base-independent packer, and virtual\nfilesystem, among others.\n\nWhile for most victims the infection vector for Slingshot remains unknown, we were able to\nfind several cases where the attackers got access to Mikrotik routers and placed a\ncomponent downloaded by Winbox Loader, a management suite for Mikrotik routers. In turn,\nthis infected the administrator of the router.\n\nWe believe this cluster of activity started in at least 2012 and was still active at the time of\nthis analysis (February 2018).\n\n**Why did you call the intruder Slingshot?**\n\nThe name appears unencrypted in some of the malicious samples – it is the name of one of\nthe threat actor’s components, so we decided to extend it to the APT as a whole.\n\n**When was Slingshot active?**\n\nThe earliest sample we found was compiled in 2012 and the threat was still active in\nFebruary 2018.\n\n**How did the threat attack and infect its victims?**\n\nSlingshot is very complex and the developers behind it have clearly spent a great deal of\ntime and money on its creation. Its infection vector is remarkable – and, to the best of our\nknowledge, unique.\n\nWe believe that most of the victims we observed appeared to have been initially infected\nthrough a Windows exploit or compromised Mikrotik routers.\n\n\n-----\n\n**How exactly does infection happen?**\n\nThe exact method used by Slingshot to exploit the routers in the first instance is not yet clear.\nWhen the target user runs Winbox Loader software (a utility used for Mikrotik router\nconfiguration), this connects to the router and downloads some DLLs (dynamic link libraries)\nfrom the router’s file system.\n\nOne of them – ipv4.dll – has been placed by the APT with what is, in fact, a downloader for\nother malicious components. Winbox Loader downloads this ipv4.dll library to the target’s\ncomputer, loads it in memory and runs it.\n\nThis DLL then connects to a hardcoded IP and port (in every cases we saw it was the\nrouter’s IP address), downloads the other malicious components and runs them.\n\nTo run its code in kernel mode in the most recent versions of operating systems, that have\nDriver Signature Enforcement, Slingshot loads signed vulnerable drivers and runs its own\ncode through their vulnerabilities. .\n\nFollowing infection, Slingshot would load a number of modules onto the victim device,\nincluding two huge and powerful ones: Cahnadr, the kernel mode module, and GollumApp, a\nuser mode module. The two modules are connected and able to support each other in\ninformation gathering, persistence and data exfiltration.\n\n\n-----\n\nThe most sophisticated module is GollumApp. This contains nearly 1,500 user-code\nfunctions and provides most of the above described routines for persistence, file system\ncontrol and C&C communications.\n\nCanhadr, also known as NDriver, contains low-level routines for network, IO operations and\nso on. Its kernel-mode program is able to execute malicious code without crashing the whole\nfile system or causing Blue Screen – a remarkable achievement. Written in pure C language,\nCanhadr/Ndriver provides full access to the hard drive and operating memory despite device\nsecurity restrictions, and carries out integrity control of various system components to avoid\ndebugging and security detection.\n\n**Are Mikrotik the only affected routers?**\n\nSome victims may have been infected through other routes. During our research we also\nfound a component called KPWS that turned out to be another downloader for Slingshot\ncomponents.\n\n**Did you inform the affected vendor?**\n\nAlthough the available intelligence is limited and we are not sure what kind of exploit was\nused to infect routers, we provided Mikrotik with all information available.\n\n**What can users of Mikrotik routers do to protect themselves?**\n\nUsers of Mikrotik routers should upgrade to the latest software version as soon as possible\nto ensure protection against known vulnerabilities. Further, Mikrotik Winbox no longer\ndownloads anything from the router to the user’s computer.\n\n**What are the advantages of achieving kernel mode?**\n\nIt gives intruders complete control over the victim computer. In kernel mode malware can do\neverything. There are no restrictions, no limitations, and no protection for the user (or none\nthat the malware can’t easily bypass).\n\n\n-----\n\n**What kind of information does Slingshot appear to be looking for?**\n\nSlingshot’s main purpose seems to be cyber-espionage. Analysis suggests it collects\nscreenshots, keyboard data, network data, passwords, USB connections, other desktop\nactivity, clipboard and more. But with full access to the kernel part of the system, it can steal\nwhatever it wants – credit card numbers, password hashes, social security account numbers\n– any type of data.\n\n**How did Slingshot avoid detection?**\n\nThe threat actor combined a number of known approaches to protect it very effectively from\ndetection: including encrypting all strings in its modules, calling system services directly in\norder to bypass security-product hooks, using a number of Anti-bug techniques, and more.\n\nFurther, it can shut down its components, but ensure they complete their tasks before\nclosing. This process is triggered when there are signs of an imminent in-system event, such\nas a system shutdown, and is probably implemented to allow user-mode components of the\nmalware to complete their tasks properly to avoid detection during any forensic research.\n\n**You said that it disables disk defragmentation module in Windows OS. Why?**\n\nThis APT uses its own encrypted file system and this can be located among others in an\nunused part of a hard drive. During defragmentation, the defrag tool relocates data on disk\nand this tool can write something to sectors where Slingshot keeps its file systems (because\nthe operating system thinks these sectors are free). This will damage the encrypted file\nsystem. We suspect that Slingshot tries to disable defragmentation of these specific areas of\nthe hard drive in order to prevent this from happening\n\n\n-----\n\n**How does it exfiltrate data?**\n\nThe malware exfiltrates data through standard networks channels, hiding the traffic being\nextracted by hooking legitimate call-backs, checking for Slingshot data packages and\nshowing the user (and users’ programs like sniffers and so on) clear traffic without exfiltrated\ndata.\n\n**Does it use exploits to zero-day vulnerabilities? Any other exploits?**\n\nWe haven’t seen Slingshot exploit any zero-days, but that doesn’t mean that it doesn’t – that\npart of a story is still unclear for us. But it does exploit known vulnerabilities in drivers to pass\nexecutable code into kernel mode. These vulnerabilities include CVE-2007-5633; CVE-20101592, CVE-2009-0824.\n\n**What is the victim profile and target geography?**\n\nSo far, researchers have seen around 100 victims of Slingshot and its related modules,\nlocated in Kenya, Yemen, Afghanistan, Libya, Congo, Jordan, Turkey, Iraq, Sudan, Somalia\nand Tanzania. Most of the victims appear to be targeted individuals rather than\norganizations, but there are some government organizations and institutions. Kenya and the\nYemen account for most of the victims observed to date.\n\n**What do we know about the group behind Slingshot?**\n\nThe malicious samples investigated by the researchers were marked as ‘version 6.x’, which\nsuggests the threat has existed for a considerable length of time. The development time, skill\nand cost involved in creating Slingshot’s complex toolset is likely to have been extremely\n\n\n-----\n\nhigh. Taken together, these clues suggest that the group behind Slingshot is likely to be\nhighly organized and professional and probably state-sponsored.\n\nText clues in the code suggest it is English-speaking. Some of the techniques used by\nSlingshot, such as the exploitation of legitimate, yet vulnerable drivers has been seen before\nin other malware, such as White and Grey Lambert. However, accurate attribution is always\nhard, if not impossible to determine, and increasingly prone to manipulation and error.\n\n[Read more in our technical paper.](https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2018/03/09133534/The-Slingshot-APT_report_ENG_final.pdf)\n\n[APT](https://securelist.com/tag/apt/)\n[Malware Descriptions](https://securelist.com/tag/malware-descriptions/)\n[Vulnerabilities and exploits](https://securelist.com/tag/vulnerabilities-and-exploits/)\n\nAuthors\n\n[Alexey Shulmin](https://securelist.com/author/alexeyshulmin/)\n\n[Sergey Yunakovsky](https://securelist.com/author/sergeyyunakovsky/)\n\n[Vasily Berdnikov](https://securelist.com/author/vasilyberdnikov/)\n\n[Andrey Dolgushev](https://securelist.com/author/andreydolgushev/)\n\nThe Slingshot APT FAQ\n\nYour email address will not be published. Required fields are marked *\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2018/2018-03-09 - The Slingshot APT FAQ.pdf"
    ],
    "report_names": [
        "2018-03-09 - The Slingshot APT FAQ.pdf"
    ],
    "threat_actors": [
        {
            "id": "a0d369c1-f0b7-4c70-a3a5-77aabbd17979",
            "created_at": "2022-10-25T15:50:23.311311Z",
            "updated_at": "2025-03-27T02:00:55.438117Z",
            "deleted_at": null,
            "main_name": "Strider",
            "aliases": [
                "ProjectSauron"
            ],
            "source_name": "MITRE:Strider",
            "tools": [
                "Remsec"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "99845f58-2c39-46f7-8369-bb621ebb7002",
            "created_at": "2022-10-25T16:07:24.238844Z",
            "updated_at": "2025-03-27T02:02:10.14785Z",
            "deleted_at": null,
            "main_name": "Strider",
            "aliases": [
                "ProjectSauron"
            ],
            "source_name": "ETDA:Strider",
            "tools": [
                "Backdoor.Remsec",
                "ProjectSauron",
                "Remsec"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "c1ac2a5e-0225-47a4-8ac5-5fa898c96bde",
            "created_at": "2023-01-06T13:46:38.472883Z",
            "updated_at": "2025-03-27T02:00:02.84253Z",
            "deleted_at": null,
            "main_name": "ProjectSauron",
            "aliases": [
                "Sauron",
                "Project Sauron",
                "G0041"
            ],
            "source_name": "MISPGALAXY:ProjectSauron",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "72aaa00d-4dcb-4f50-934c-326c84ca46e3",
            "created_at": "2023-01-06T13:46:38.995743Z",
            "updated_at": "2025-03-27T02:00:02.972623Z",
            "deleted_at": null,
            "main_name": "Slingshot",
            "aliases": [],
            "source_name": "MISPGALAXY:Slingshot",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "f55c7778-a41c-4fc6-a2e7-fa970c5295f2",
            "created_at": "2022-10-25T16:07:24.198891Z",
            "updated_at": "2025-03-27T02:02:10.138587Z",
            "deleted_at": null,
            "main_name": "Slingshot",
            "aliases": [],
            "source_name": "ETDA:Slingshot",
            "tools": [
                "Cahnadr",
                "GollumApp",
                "NDriver"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "e3767160-695d-4360-8b2e-d5274db3f7cd",
            "created_at": "2022-10-25T16:47:55.914348Z",
            "updated_at": "2025-03-27T02:05:17.411172Z",
            "deleted_at": null,
            "main_name": "IRON TWILIGHT",
            "aliases": [
                "ATK5 ",
                "Blue Athena ",
                "BlueDelta ",
                "FROZENLAKE ",
                "Fancy Bear ",
                "Fighting Ursa ",
                "Forest Blizzard ",
                "GRAPHITE ",
                "Group 74 ",
                "PawnStorm ",
                "STRONTIUM ",
                "Sednit ",
                "Snakemackerel ",
                "Sofacy ",
                "TG-4127 ",
                "Tsar Team ",
                "APT28 "
            ],
            "source_name": "Secureworks:IRON TWILIGHT",
            "tools": [
                " Downdelph",
                " Drovorub",
                " EVILTOSS",
                " HIDEDRV",
                " Headlace",
                " LoJack",
                " Powershell Empire",
                " SCONATO",
                " SEDUPLOADER",
                " SHARPFRONT",
                " Scaramouche",
                " Sedkit Exploit Kit",
                " Sofacy downloader",
                " X-Agent",
                " X-Tunnel",
                " Zebrocy",
                " reGeorg",
                "DEALERSCHOICE"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "730dfa6e-572d-473c-9267-ea1597d1a42b",
            "created_at": "2023-01-06T13:46:38.389985Z",
            "updated_at": "2025-03-27T02:00:02.821388Z",
            "deleted_at": null,
            "main_name": "APT28",
            "aliases": [
                "FROZENLAKE",
                "BlueDelta",
                "SNAKEMACKEREL",
                "TG-4127",
                "ITG05",
                "TA422",
                "Fancy Bear",
                "FANCY BEAR",
                "Sednit",
                "IRON TWILIGHT",
                "G0007",
                "Sofacy",
                "Forest Blizzard",
                "GruesomeLarch",
                "Pawn Storm",
                "Tsar Team",
                "STRONTIUM",
                "ATK5",
                "Blue Athena",
                "APT-C-20",
                "Group 74",
                "SIG40",
                "Grizzly Steppe",
                "Fighting Ursa",
                "T-APT-12",
                "UAC-0028"
            ],
            "source_name": "MISPGALAXY:APT28",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "ae320ed7-9a63-42ed-944b-44ada7313495",
            "created_at": "2022-10-25T15:50:23.671663Z",
            "updated_at": "2025-03-27T02:00:55.518748Z",
            "deleted_at": null,
            "main_name": "APT28",
            "aliases": [
                "APT28",
                "IRON TWILIGHT",
                "SNAKEMACKEREL",
                "Group 74",
                "Sednit",
                "Sofacy",
                "Pawn Storm",
                "Fancy Bear",
                "STRONTIUM",
                "Tsar Team",
                "Threat Group-4127",
                "TG-4127",
                "Forest Blizzard",
                "FROZENLAKE"
            ],
            "source_name": "MITRE:APT28",
            "tools": [
                "Wevtutil",
                "certutil",
                "Forfiles",
                "DealersChoice",
                "Mimikatz",
                "ADVSTORESHELL",
                "Komplex",
                "HIDEDRV",
                "JHUHUGIT",
                "Koadic",
                "Winexe",
                "XTunnel",
                "Drovorub",
                "CORESHELL",
                "OLDBAIT",
                "Downdelph",
                "XAgentOSX",
                "USBStealer",
                "Zebrocy",
                "Fysbis",
                "LoJax"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "d2516b8e-e74f-490d-8a15-43ad6763c7ab",
            "created_at": "2022-10-25T16:07:24.212584Z",
            "updated_at": "2025-03-27T02:02:10.141001Z",
            "deleted_at": null,
            "main_name": "Sofacy",
            "aliases": [
                "APT 28",
                "ATK 5",
                "Blue Athena",
                "BlueDelta",
                "FROZENLAKE",
                "Fancy Bear",
                "Fighting Ursa",
                "Forest Blizzard",
                "Grey-Cloud",
                "Grizzly Steppe",
                "Group 74",
                "GruesomeLarch",
                "ITG05",
                "Iron Twilight",
                "Operation DealersChoice",
                "Operation Dear Joohn",
                "Operation Komplex",
                "Operation Pawn Storm",
                "Operation Russian Doll",
                "Operation Steal-It",
                "Pawn Storm",
                "SIG40",
                "Sednit",
                "Snakemackerel",
                "Sofacy",
                "Strontium",
                "T-APT-12",
                "TA422",
                "TAG-0700",
                "TAG-110",
                "TG-4127",
                "Tsar Team",
                "UAC-0028",
                "UAC-0063"
            ],
            "source_name": "ETDA:Sofacy",
            "tools": [
                "ADVSTORESHELL",
                "AZZY",
                "Backdoor.SofacyX",
                "CHERRYSPY",
                "CORESHELL",
                "Carberp",
                "Computrace",
                "DealersChoice",
                "Delphacy",
                "Downdelph",
                "Downrage",
                "Drovorub",
                "EVILTOSS",
                "Foozer",
                "GAMEFISH",
                "GooseEgg",
                "Graphite",
                "HATVIBE",
                "HIDEDRV",
                "Headlace",
                "Impacket",
                "JHUHUGIT",
                "JKEYSKW",
                "Koadic",
                "Komplex",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "LoJack",
                "LoJax",
                "MASEPIE",
                "Mimikatz",
                "NETUI",
                "Nimcy",
                "OCEANMAP",
                "OLDBAIT",
                "PocoDown",
                "PocoDownloader",
                "Popr-d30",
                "ProcDump",
                "PythocyDbg",
                "SMBExec",
                "SOURFACE",
                "SPLM",
                "STEELHOOK",
                "Sasfis",
                "Sedkit",
                "Sednit",
                "Sedreco",
                "Seduploader",
                "Shunnael",
                "SkinnyBoy",
                "Sofacy",
                "SofacyCarberp",
                "SpiderLabs Responder",
                "Trojan.Shunnael",
                "Trojan.Sofacy",
                "USB Stealer",
                "USBStealer",
                "VPNFilter",
                "Win32/USBStealer",
                "WinIDS",
                "Winexe",
                "X-Agent",
                "X-Tunnel",
                "XAPS",
                "XTunnel",
                "Xagent",
                "Zebrocy",
                "Zekapab",
                "carberplike",
                "certutil",
                "certutil.exe",
                "fysbis",
                "webhp"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535603,
    "ts_updated_at": 1743041494,
    "ts_creation_date": 1653766299,
    "ts_modification_date": 1653766299,
    "files": {
        "pdf": "https://archive.orkl.eu/995b32f54a81041de18d1ae7a703c19360515aa0.pdf",
        "text": "https://archive.orkl.eu/995b32f54a81041de18d1ae7a703c19360515aa0.txt",
        "img": "https://archive.orkl.eu/995b32f54a81041de18d1ae7a703c19360515aa0.jpg"
    }
}