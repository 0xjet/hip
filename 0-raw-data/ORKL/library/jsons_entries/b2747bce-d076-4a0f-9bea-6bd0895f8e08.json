{
    "id": "b2747bce-d076-4a0f-9bea-6bd0895f8e08",
    "created_at": "2023-01-12T15:07:37.429665Z",
    "updated_at": "2025-03-27T02:05:38.290171Z",
    "deleted_at": null,
    "sha1_hash": "cac32a26bcea4220d3c4eeec8ab0a4687b8a076e",
    "title": "2021-04-16 - Unearthing Hancitor Infrastructure",
    "authors": "",
    "file_creation_date": "2022-05-28T15:53:36Z",
    "file_modification_date": "2022-05-28T15:53:36Z",
    "file_size": 571132,
    "plain_text": "# Unearthing Hancitor Infrastructure\n\n**[inquest.net/blog/2021/04/16/unearthing-hancitor-infrastructure](https://inquest.net/blog/2021/04/16/unearthing-hancitor-infrastructure)**\n\nIt's no secret that today, targeted attacks and phishing attacks are the primary means of\nspreading malware. The purpose of which is to collect user data, theft banking data, and\nespionage Threat Actors are constantly working to improve the tools they use In this article\n\n\n-----\n\nI will try to show you how the Hanictor group is improving their toolbox.\n\n[Looking at this malicous document MD5: de80e1d7d9f5b1c64ec9f8d4f5063989](https://labs.inquest.net/dfi/sha256/30787f32adc487311d764b19d4504fdeab08c0d385e2fa065bd8d5836c031606)\n\nAs in previous versions of Hancitor, the add-on also contains an executable library.\n\n[DLL MD5: a4838dd31c672122441bebcbf7e9d277 the developers of the malicious code have](https://www.virustotal.com/gui/file/f4910ea08d14eeb634084de47cf590d4dc5e554552f111da20d22ae71d7b425b/detection)\nheavily modified the executable library. DLL is very heavily packaged, and the malicious\ncode is hidden from the analysis. The first analysis of the sample had a meager detection\nrate on VirusTotal.\n\nThe library is unpacked using a sequential call of the exported functions. The payload of this\ncampaign is contained in the unpacked library.\n\nMD5: BB948C6B1F60213D8A8C176A5CA2EDBB\n\nThe malicious program writes itself to the svchost.exe address space and runs a remote\nthread.\n\n\n-----\n\nDecrypting the code reveals the C2 address.\n\nAt the beginning of the unpacked data, we see the identifier of the malicious campaign:\n**.0504_khrn7**\n\nAfter collecting data from the compromised system, the program sends the data to a remote\nserver using a specific mask. After transferring data to the server, the program waits for 100\nminutes for a remote command.\n\nBased on the data received, the threat actor decides how to further execute the malicious\ncode. He has the ability to execute 6 commands.\n\n**Sequencing**\n\n1. Download the executable file and run it as a DLL library.\n2. Launches the svhost.exe, then downloads an executable file and writes it to the\n\nsvhost.exe address space.\n3. Download the executable file and run it as a code in the self adrr. space.\n4. Download the executable file and run it as a code in the self adrr. space.\n5. The program goes into a further sleep (100min) mode.\n6. The program is terminated.\n\nTarget executable file that is executed:\n\nhttp://tren0.ru/6jhuy675rt[.]exe\n\nMD5:77be0dd6570301acac3634801676b5d7\n\n\n-----\n\nIOC\nhttp://divelerevol.com/8/forum[.]php\nhttp://polionallas.ru/8/forum[.]php\nhttp://cametateleb.ru/8/forum[.]php\n\n**Bio**\nDmitry Melikov is a malware researcher that has a passion for reverse engineering and\ninformation security.\n[LinkedIn](https://www.linkedin.com/in/dmitry-melikov-210000142/)\n[Twitter](https://twitter.com/DmitriyMelikov)\n\nTags\n\n[guest](https://inquest.net/taxonomy/term/70) [malware-analysis labs](https://inquest.net/taxonomy/term/4)\n\n\n## Get The InQuest Insider\n\n[Find us on Twitter for frequent updates, follow our Blog for bi-weekly technical write-](https://twitter.com/inquest)\nups, or subscribe here to receive our monthly newsletter, The InQuest Insider. We\ncurate and provide you with the latest news stories, field notes about innovative\nmalware, novel research / analysis / threat hunting tools, security tips and more.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-04-16 - Unearthing Hancitor Infrastructure.pdf"
    ],
    "report_names": [
        "2021-04-16 - Unearthing Hancitor Infrastructure.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673536057,
    "ts_updated_at": 1743041138,
    "ts_creation_date": 1653753216,
    "ts_modification_date": 1653753216,
    "files": {
        "pdf": "https://archive.orkl.eu/cac32a26bcea4220d3c4eeec8ab0a4687b8a076e.pdf",
        "text": "https://archive.orkl.eu/cac32a26bcea4220d3c4eeec8ab0a4687b8a076e.txt",
        "img": "https://archive.orkl.eu/cac32a26bcea4220d3c4eeec8ab0a4687b8a076e.jpg"
    }
}