{
    "id": "4853e127-1953-41ab-b3a0-8939ebbb6497",
    "created_at": "2023-04-05T02:10:02.517106Z",
    "updated_at": "2025-03-27T02:15:57.94719Z",
    "deleted_at": null,
    "sha1_hash": "023b0f8abfd4bc74f224d6597b78f66ddbd28e6f",
    "title": "2023-02-02 - Update to the REF2924 intrusion set and related campaigns",
    "authors": "",
    "file_creation_date": "2023-04-03T08:47:55Z",
    "file_modification_date": "2023-04-03T08:47:55Z",
    "file_size": 1450969,
    "plain_text": "# Update to the REF2924 intrusion set and related campaigns\n\n**[elastic.co/security-labs/update-to-the-REF2924-intrusion-set-and-related-campaigns](https://www.elastic.co/security-labs/update-to-the-REF2924-intrusion-set-and-related-campaigns)**\n\n_Elastic Security Labs is providing an update to the active intrusions using SIESTAGRAPH,_\n_DOORME, and SHADOWPAD, including malware analysis and associations with additional_\n_campaigns._\n\n## Key takeaways\n\nDOORME is a malicious IIS module that provides remote access to a contested\nnetwork.\nSIESTAGRAPH interacts with Microsoft’s GraphAPI for command and control using\nOutlook and OneDrive.\nSHADOWPAD is a backdoor that has been used in multiple campaigns attributed to a\nregional threat group with non-monetary motivations.\nREF2924 analytic update incorporating third-party and previously undisclosed incidents\nlinking the REF2924 adversary to Winnti Group and ChamelGang along technical,\ntactical, and victim targeting lines.\n\n## Preamble\n\n\n-----\n\nThis research highlights the capabilities and observations of the two backdoors, named\n\"DOORME\" and \"SIESTAGRAPH\", and a backdoor called “SHADOWPAD” that was\n[disclosed by Elastic in December of 2022. DOORME is an IIS (Internet Information Services)](https://www.elastic.co/security-labs/siestagraph-new-implant-uncovered-in-asean-member-foreign-ministry)\nbackdoor module, which is deployed to web servers running the IIS software.\nSIESTAGRAPH is a .NET backdoor that leverages the Microsoft Graph interface, a collection\nof APIs for accessing various Microsoft services. SHADOWPAD is an actively developed and\nmaintained modular remote access toolkit.\n\nDOORME, SIESTAGRAPH, and SHADOWPAD each implement different functions that can\nbe used to gain and maintain unauthorized access to an environment. The exact details of\nthese functionalities will be described in further detail in this research publication. It is\nimportant to note that these backdoors can be used to steal sensitive information, disrupt\noperations, and gain a persistent presence in a victim environment.\n\nAdditionally, we will discuss the relationships between REF2924 and three other intrusions\ncarried out by the same threat group, intrusion set, or both. These associations are made\nusing first-party observations and third-party reporting. They have allowed us to state with\nmoderate confidence that SIESTAGRAPH, DOORME, SHADOWPAD, and other elements of\nREF2924 are attributed to a regional threat group with non-monetary motivations.\n\nAdditional information on the REF2924 intrusion set\n\nAdditional information on the REF2924 intrusion setFor additional information on this\nintrusion set, which includes our initial disclosure as well as information into the campaign\ntargeting the Foreign Ministry of an ASEAN member state, check out our previous research\ninto REF2924.\n\n## DOORME code analysis\n\n### Introduction to backdoored IIS modules\n\n[IIS, developed by Microsoft, is an extensible web server software suite that serves as a](https://www.iis.net/)\nplatform for hosting websites and server-side applications within the Windows environment.\nWith version 7.0, Microsoft has equipped IIS with a modular architecture that allows for the\ndynamic inclusion or exclusion of modules to suit various functional requirements. These\nmodules correspond to specific features that the server can utilize to handle incoming\nrequests.\n\n[As an example, a backdoored module that overrides the OnGlobalPreBeginRequest event](https://learn.microsoft.com/en-us/previous-versions/iis/smooth-streaming-client/cglobalmodule-onglobalprebeginrequest-method)\ncan be used to perform various malicious activities - such as capturing sensitive user\ninformation submitted to webpages, injecting malicious code into content served to visitors,\nor providing the attacker remote access to the web server. It is possible that a malicious\n\n\n-----\n\nmodule could intercept and modify a request before it is passed on to the server, adding an\nHTTP header or query string parameter that includes malicious code. When the server\nprocesses that modified request, the malicious code might be executed, allowing the attacker\nto gain unauthorized access or control the server and its resources.\n\nAdding to the danger of IIS backdoors is that they can be stealthy and organizations may not\nbe aware that they have been compromised. Many companies do not have the resources or\nexpertise to regularly monitor and test their IIS modules for vulnerabilities and malicious\ncode, which can make it difficult to detect and remediate backdoors. To mitigate these risks,\norganizations should maintain a comprehensive inventory of all IIS modules and implement\nnetwork and endpoint protection solutions to help detect and respond to malicious activities.\nElastic Security Labs has seen increased use of this persistence mechanism coupled with\ndefense evasions, which may disproportionately impact those hosting on-premises servers\nrunning IIS.\n\n### Introduction to the DOORME IIS module\n\nDOORME is a native backdoor module that is loaded into a victim's IIS infrastructure and\nused to provide remote access to the target infrastructure. We [first discussed the DOORME](https://www.elastic.co/security-labs/siestagraph-new-implant-uncovered-in-asean-member-foreign-ministry)\nsample that we observed targeting the Foreign Ministry of an ASEAN member nation in\nDecember of 2022.\n\nDOORME uses the **[RegisterModule function, which is an export of a malicious C++ DLL](https://learn.microsoft.com/en-us/previous-versions/iis/smooth-streaming-client/pfn-registermodule-function)**\nmodule and is responsible for loading the module and setting up event handler methods. It\nalso dynamically resolves API libraries that will be used later. The main functionality of the\n[backdoor is implemented in the CGlobalModule class and its event handler,](https://learn.microsoft.com/en-us/previous-versions/iis/smooth-streaming-client/cglobalmodule-class)\n**[OnGlobalPreBeginRequest. This event handler is overridden by DOORME, allowing it to](https://learn.microsoft.com/en-us/previous-versions/iis/smooth-streaming-client/cglobalmodule-onglobalprebeginrequest-method)**\nbe loaded before a web request enters the IIS pipeline. The core functions of the backdoor\n(including cookie validation, parsing commands, and calling underlying command functions)\nare all located within this event handler. DOORME uses multiple obfuscation methods, an\nauthentication mechanism, AES encryption implementation, and a purpose-built series of\ncommands.\n\nThis diagram illustrates the contrast between an attacker attempting to connect to a\nbackdoored IIS server and a legitimate user simply trying to access a webpage.\n\n\n-----\n\nOverview diagram of the DOORME backdoor\n\n### Obfuscation\n\n**String obfuscation**\n\nDOORME XOR-encrypts strings to evade detection. These encrypted strings are then stored\non the memory stack. As the original plaintext is obscured this string obfuscation makes it\nmore difficult for security software or researchers to understand the purpose or meaning of\nthe strings. The malware uses the first byte of every encrypted blob to XOR-decrypt the\nstrings.\n\nPseudocode showcasing string obfuscation\n\n**Anti-disassembly technique**\n\n\n-----\n\nThe malware employs a technique that can cause disassemblers to incorrectly split functions\nin the code, which leads to the generation of incorrect assembly graphs. This technique can\nmake it more challenging for analysts to understand the malware's behavior and create an\neffective defense against it.\n\nGaps in the assembly view of IDA pro\n\n**Control flow obfuscation**\n\nThe malware in question also employs a technique known as Control Flow Obfuscation\n(CFO) to complicate the analysis of its behavior. CFO is a technique where the flow of\ninstructions in the code is deliberately manipulated to make it more difficult for security\nsoftware and researchers to understand the malware's functionality.\n\nThe malware uses CFO to complicate the analysis process, but it is noteworthy that this\ntechnique is not applied to the entire codebase. From an analysis point of view, this tells us\nthat these strings are of particular importance to the malware author - possibly to frustrate\nspecific security tooling. The following example serves as a demonstration of how the\nmalware uses CFO to conceal its functionality in the context of stack string XOR decryption.\n\n\n-----\n\nPseudocode showcasing\n\nCFO example\n\n**Dynamic import table resolution obfuscation**\n\nDynamic import table resolution is a technique used by malicious software to evade\ndetection by security software. It involves resolving the names of the Windows APIs that the\nmalware needs to function at runtime, rather than hard coding the addresses of these APIs in\nthe malware's import table.\n\nDOORME first resolves the address of LoadLibraryA and GetProcAddress Windows API\nby parsing the kernel32.dll module export table, then uses the GetProcAddress function to\nlocate the desired APIs within the modules by specifying the name of the API and the name\nof the DLL module that contains it.\n\nPseudocode showcasing import address table resolution\n\n### Execution flow\n\n**Authentication**\n\nThe malicious IIS module backdoor operates by looking for the string\n\"79cfdd0e92b120faadd7eb253eb800d0\" (the MD5 hash sum of a profane string), in a\nspecific cookie of the incoming HTTP requests, when found it will parse the rest of the\nrequest.\n\n**GET request handling**\n\n\n-----\n\n**GET requests are used to perform a status check: the malware returns the string** **It works!**\nfollowed by the username and the hostname of the infected machine. This serves as a\nmeans for the malware to confirm its presence on an infected machine.\n\nGET request to the backdoor using curl command\n\n**POST requests handling**\n\nThe backdoor operator sends commands to the malware through HTTP POST requests as\ndata which is doubly encrypted. Commands are AES-encrypted and then Base64 encoded,\nwhich the DOORME backdoor then decrypts.\n\n**Base64 implementation**\n\nThe malware's implementation of Base64 uses a different index table compared to the\ndefault Base64 encoding RFC. The specific index table used by the malware is\n**\"VZkW6UKaPY8JR0bnMmzI4ugtCxsX2ejiE5q/9OH3vhfw1D+lQopdABTLrcNFGSy7\",**\nwhile the normal index table used by the Base64 algorithm is\n**\"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\".**\nThis deviation from the standard index table makes it more difficult to decode the encoded\ndata and highlights additional custom obfuscation techniques by the DOORME malware\nauthor in an attempt to frustrate analysis.\n\n**AES algorithm implementation**\n\n[The malware uses AES (Advanced Encryption Standard) in CBC (Cipher Block Chaining)](https://en.wikipedia.org/wiki/Advanced_Encryption_Standard)\nmode to encrypt and decrypt data. It uses the MD5 hash of the first 16 bytes of the\nauthentication hash \"79cfdd0e92b120faadd7eb253eb800d0\", as the AES key. The\ninitialization vector (IV) of the algorithm is the MD5 hash of the AES key.\n\nIn our case the AES key is “5a430ab45c7e142c70018b99fe0d2da3” and the AES IV is\n“57ce15b304a97772”.\n\n### Command handling table\n\nThe backdoor is capable of executing four different commands, each with its own set of\nparameters. To specify which command to run and pass the necessary parameters, the\noperators of the backdoor use a specific syntax. The command ID and its parameters are\n\n\n-----\n\nseparated by the pipe symbol(|).\n\n**Command ID 0x42**\n\nThe first command implemented has the ID 0x42 and generates a Globally Unique Identifier\n(GUID) by calling the API CoCreateGuid. Used to identify the infected machine, this helps to\ntrack infected machines and allows the attacker to focus on specific high-value\nenvironments.\n\nPseudocode generating the GUID\n\n**Command ID 0x43**\n\nAnother command, ID 0x43, is particularly noteworthy as it allows the attacker to execute\nshellcode in the memory of the same process. This functionality is achieved by utilizing the\nWindows native functions NtAllocateVirtualMemory and NtCreateThreadEx.\n\nThe NtAllocateVirtualMemory function is used to allocate memory in the same process for\nshellcode, while the NtCreateThreadEx function creates an execution thread with shellcode\nin that newly-allocated memory.\n\n\n-----\n\nPseudocode self-shellcode injection\n\n**Command ID 0x63**\n\nCommand ID 0x63 allows the attacker to send a blob of shellcode in chunks, which the\nmalware reassembles to execute. It works by sending this command ID with a shellcode\nchunk as a parameter. Implants can detect that the shellcode has been fully received when\nthe server communicates a different shellcode size than expected. This approach allows the\nmalware to handle large shellcode objects with minimal validation.\n\n**Command ID 0x44**\n\nCommand ID 0x44 provides a means of interacting with the shellcode being executed on the\ninfected system. The attacker can send input to the shellcode and retrieve its output via a\nnamed pipe. This allows the attacker to control the execution of the shellcode and receive\nfeedback, which may help to capture the output of tools deployed in the environment via the\nDOORME implant.\n\n### DOORME Summary\n\n\n-----\n\nIn summary, DOORME provides a dangerous capability allowing attackers to gain\nunauthorized access to the internal network of victims through an internet-facing IIS web\nserver. It includes multiple obfuscation techniques to evade detection, as well as the ability to\nexecute additional malware and tools. Malware authors are increasingly leveraging IIS as\ncovert backdoors that hide deep within the system. To protect against these threats, it is\nimportant to continuously monitor IIS servers for any suspicious activity, processes spawned\nfrom the IIS worker process (w3wp.exe), and the creation of new executables.\n\n## SIESTAGRAPH code analysis\n\n### Introduction to the SIESTAGRAPH implant\n\n[The implant utilizes the Microsoft Graph API to access Microsoft 365 Mail and OneDrive for](https://learn.microsoft.com/en-us/graph/overview)\nits C2 communication. It uses a predetermined tenant identifier and a refresh token to obtain\n[access tokens. The implant uses the legitimate OneDriveAPI library which simplifies the](https://github.com/KoenZomers/OneDriveAPI)\nprocess of interacting with the Microsoft API and allows for efficient management of access\nand refresh tokens. The implant leverages sleep timers in multiple locations as a defense\nevasion technique. This led to the implant’s name: SIESTAGRAPH.\n\nOverview diagram of the SIESTAGRAPH implant\n\n### Execution flow\n\nSIESTAGRAPH starts and enters its main function which will set up the needed parameters\nto access Microsoft GraphAPI by requesting an access token based on a hard coded refresh\ntoken.\n\n\n-----\n\nInitial setup of SIESTAGRAPH\n[During the setup phase the malware uses the Microsoft Office GUID (d3590ed6-52b3-4102-](https://learn.microsoft.com/en-us/troubleshoot/azure/active-directory/verify-first-party-apps-sign-in#application-ids-of-commonly-used-microsoft-applications:~:text=Microsoft%20Office,4102%2Daeff%2Daad2292ab01c)\n**aeff-aad2292ab01c). This is needed to supply access to both Microsoft 365 Mail and**\nOneDrive.\n\nRequest an authentication token\n\n### Authentication\n\nThe SIESTAGRAPH author utilized a pre-determined tenant identifier and a refresh token to\nobtain access tokens. Both of these elements are essential in making a request for an\naccess token. It is important to note that access tokens possess a limited lifespan, however,\nthe refresh token can be utilized to request new access tokens as necessary.\n\nHard coded tenant and refresh tokens\nTo facilitate this process, the attacker utilized a third-party and legitimate library named\n[OneDriveAPI. This library simplifies the process of interacting with the Microsoft API and](https://github.com/KoenZomers/OneDriveAPI)\nallows for efficient management of access and refresh tokens. It should be noted that\n\n\n-----\n\nalthough third-party libraries such as OneDriveAPI can provide a convenient way to interact\nwith APIs, they should not be considered to be malicious.\n\nUse of third-party libraries\nThe malware utilizes the GetAccessTokenFromRefreshToken method to request an\nauthentication token. This token is then used in all subsequent API requests.\n\n[Refresh tokens have a 90-day expiration window. So while the access token was being used](https://learn.microsoft.com/en-us/microsoft-365/enterprise/session-timeouts?view=o365-worldwide#:~:text=The%20default%20lifetime%20for%20the%20access%20token%20is%201%20hour.%20The%20default%20max%20inactive%20time%20of%20the%20refresh%20token%20is%2090%20days)\nby the Graph API for C2, the refresh token, which is needed to generate new access tokens,\nwas not used within the expiration window. The refresh token was generated on 2022-1101T03:03:44.3138133Z and expired on 2023-01-30T03:03:44.3138133Z. This means that a\nnew refresh token will be needed before a new access token can be generated. As the\nrefresh token is hard coded into the malware, we can expect SIESTAGRAPH to be updated\nwith a new refresh token if it is intended to be used in the future.\n\n### Command and control\n\nA session token (sessionToken) is created by concatenating the process ID, machine name,\nusername, and operating system. The session token is later used to retrieve commands\nintended for this specific implant.\n\nDefining the session token\nAfter obtaining authentication and session tokens, the malware collects system information\nand exfiltrates it using a method called sendSession.\n\nInspecting the sendSession method we see that it creates an email message and saves it\nas a draft. Using draft messages is common C2 tradecraft as a way to avoid email\ninterception and inspection.\n\n\n-----\n\nThe sendMessage method\nAfter sending the session information to the attacker, the implant enters a loop in which it will\ncheck for new commands. By default, this beaconing interval is every 5 seconds, however,\nthis can be adjusted by the attacker at any time.\n\nWhen receiving a command, the implant will use the getMessages method to check for any\ndraft emails with commands from the attacker.\n\nThe getMessage method\nWith every call that contacts the Graph API, SIESTAGRAPH will receive the current\nauthentication token (authToken). This token is then used in the HTTP request header\nfollowing the Authorization: Bearer (“Authorization”, “Bearer “ + authToken).\n\nEvery call to this method will contain the sessionToken, a command, and command\narguments, separated with colons (:) (<sessionToken>:<Command>:<command\n**arguments>).**\n\n\n-----\n\nIf a command has multiple arguments they will be split by a pipe (|). An example of this is the\n**rename command where the source and destination names are split by a pipe.**\n\nUsing a pipe for separating arguments\nWe have identified the following commands:\n\n**Command**\n**text** **Description**\n\nC Run a command\n\nN Update the amount of time the binary will sleep between check-ins\n\nD Upload a file to OneDrive\n\nU Download Item from Onedrive\n\nUU Check to see is Core.bin exists then Download item from Onedrive\n\nListDrives Send a list of the logical drives\n\nGetDirectories Send a list of given subdirectories\n\nGetFiles Send a list of files in a given directory\n\nDel Delete a given file\n\nRename Rename a given file or directory\n\nP Get a list of running processes\n\nE Ends the execution of the binary\n\nK Kill a given process ID\n\nS Update the amount of time the binary will sleep between check-ins (same\nas N)\n\nNET Get network information\n\n\n-----\n\n**Command**\n**text** **Description**\n\nSS Take a screenshot\n\nSeveral commands are self-explanatory (ListDrives, Rename, etc.), however the run\ncommands, update sleep timer, upload and download files, and take screenshots are more\ninteresting and can provide a better understanding of the capabilities of SIESTAGRAPH.\n\n**C - run command**\n\nWhen the C command is received the malware runs the runCommand method. This method\ntakes in the name of cmd.exe, the command line to run, and the number of milliseconds to\nwait for the new process to exit.\n\nIf the command parameter is not null or empty, the method proceeds to create a new\ninstance of the System.Diagnostics.Process class, which is used to start and interact with\na new process. It sets the properties of the process instance's StartInfo property, which is of\nthe ProcessStartInfo class, such as the FileName property to the cmd parameter passed to\nthe method, the Arguments property to /c concatenated with the command parameter, and\nalso sets UseShellExecute, RedirectStandardInput, RedirectStandardOutput,\n**RedirectStandardError, and CreateNoWindow property. As this method is only called with**\nthe hard coded value of cmd for the cmd parameter, the resulting command will always be\n**cmd /c <command to run>.This is a common way to run commands if one does not have**\ndirect access to an interactive shell.\n\n\n-----\n\nThe runCommand method\n\n**N - Sleep timer update**\n\nThe sleep command is a single instruction. If the argument for the command is larger than\n1000, the value for the SleepTimer variable is updated. This variable is later used to\ndetermine how long the process will sleep in between check-ins.\n\nUpdating the SleepTimer\n\n**D - Upload to OneDrive**\n\nThe D command is issued from the attacker’s perspective, so while they’re “downloading”\nfrom OneDrive, the host is “uploading” to OneDrive\n\n\n-----\n\nThe method receives a filePath, and the authentication and session tokens. It will then\nupload the requested file to OneDrive. If the file is successfully uploaded, a response\nmessage is sent to the attacker using the format OK|C:\\foo\\file.txt.\n\nIf the upload did not succeed the attacker will receive the error message OK|<Error\n**message>.**\n\nWhile this method might seem simple it helps to avoid detection by using common libraries\nwhile achieving the goal of exfiltrating data from the victim. While unconfirmed, this could be\n[how the exported Exchange mailboxes were collected by the threat actor.](https://www.elastic.co/security-labs/siestagraph-new-implant-uncovered-in-asean-member-foreign-ministry#exporting-exchange-mailboxes)\n\nThe uploadFile method\n\n**U - Download from OneDrive**\n\nThe download function is similar to the upload function. Again, from the attacker's\nperspective, the U command stands for upload. As the file is downloaded from OneDrive by\nthe implant, but uploaded by the attacker.\n\n\n-----\n\n**NET - Gather network information**\n\nThe NET command will gather network information and send it back to the attacker. In order\nto gather the information the binary first resolves two functions from the DLLs, Ws2_32.dll\n(the Windows socket API) and iphlpapi.dll (the Windows IP helper API).\n\nRevolve functions from Ws2_32.dll and iphlpapi.dll\nThe NET command gathers information about open TCP connections from the system's TCP\ntable. It then loops over all open connections and stores the information in an array that is\nsent back to the attacker. This code helps the attacker to get a better insight into the\nsystem's purpose within the network. As an example, if there are open connections for ports\n587, 993, and 995, the host could be a Microsoft Exchange server.\n\n**SS - Take screenshot**\n\nTo see the victim's desktop, SIESTAGRAPH can call the method named TakeScreenShot\nwhich takes a screenshot of the primary monitor and returns the screenshot as a Base64\nencoded string.\n\nThe TakeScreenShot method\nThis function creates a new Bitmap object with the width and height of the primary screen's\nbounds. Then it creates a new Graphics object from the Bitmap object and uses the\n**CopyFromScreen function to take a screenshot and copy it to the Graphics object.**\n\nIt then creates a new MemoryStream object and uses the Save method of the Bitmap\nobject to save the screenshot as a PNG image into the memory stream. The image in the\nmemory stream is then converted to a Base64 encoded string using the\n\n\n-----\n\n**Convert.ToBase64String method. The resulting Base64 string is then sent back to the**\nattacker by saving it as an email draft.\n\n### SIESTAGRAPH Summary\n\nSIESTAGRAPH is a purpose-built and full-featured implant that acts as a proxy for the threat\nactor. What makes SIESTAGRAPH more than a generic implant is that it uses legitimate and\ncommon, but adversary-controlled, infrastructure to deliver remote capabilities on the\ninfected host.\n\n## SHADOWPAD loader code analysis\n\n### Introduction to log.dll\n\n[When Elastic Security Labs disclosed REF2924 in December of 2022, we observed an](https://www.elastic.co/security-labs/siestagraph-new-implant-uncovered-in-asean-member-foreign-ministry#dll-side-loading)\nunknown DLL. We have since collected and analyzed the DLL, concluding it is a loader for\nthe [SHADOWPAD malware family.](https://malpedia.caad.fkie.fraunhofer.de/details/win.shadowpad)\n\nThe DLL, log.dll, was observed on two Domain Controllers and was being side-loaded by an\n11-year-old version of the Bitdefender Crash Handler (compiled name: BDReinit.exe),\nnamed 13802 AR.exe (in our example). Once executed, SHADOWPAD copies itself to\n**C:\\ProgramData\\OfficeDriver\\ as svchost.exe before installing itself as a service. Once**\n**log.dll is loaded, it will spawn Microsoft Windows Media Player (wmplayer.exe) and**\n**dllhost.exe, injecting into them which triggers a memory shellcode detection for Elastic**\nDefend.\n\nAt runtime, log.dll looks for the log.dll.dat file which contains the shellcode to be executed.\nThen log.dll will encrypt and store the shellcode in the registry and shred the original\n**log.dll.dat file. If the file doesn’t exist it will skip this part.**\n\nThen the sample will load the shellcode from the registry, RWX map it, and execute it from\nmemory. If the registry key doesn’t exist the sample will crash.\n\n### Execution flow\n\nOur version of the SHADOWPAD DLL expects to be sideloaded by an 11-year-old and\nvulnerable version of the BitDefender BDReinit.exe binary. The offset to the trampoline\n[(jump instructions) in the vulnerable application is hard coded which means that the sample](https://gcc.gnu.org/onlinedocs/gcc-4.7.1/gccint/Trampolines.html)\nis tailored for this exact version of BitDefender’s binary\n(386eb7aa33c76ce671d6685f79512597f1fab28ea46c8ec7d89e58340081e2bd). This side[loading behavior was previously reported by Positive Technologies.](https://www.ptsecurity.com/ww-en/analytics/pt-esc-threat-intelligence/higaisa-or-winnti-apt-41-backdoors-old-and-new/)\n\n\n-----\n\nlog.dll’s hard coded offsets to BDReinit.exe\nFor our analysis, we patched log.dll to execute without the BitDefender sideloading\nrequirement.\n\n### Capabilities\n\n**Obfuscation**\n\nThe log.dll uses two lure functions to bypass automatic analysis.\n\nWe define lure functions as benign and not related to malware capabilities, but intended to\nevade defenses, obfuscate the true capabilities of the malware, and frustrate analysis. They\nmay trick time-constrained sandbox analysis by showcasing benign behavior while\nexhausting the analysis interval of the sandbox.\n\nlog.dll’s lure functions\n**log.dll incorporates a code-scattering obfuscation technique to frustrate static analysis,**\nhowever, this doesn't protect the binary from dynamic analysis.\n\nThis technique involves fragmenting the code into gadgets and distributing those gadgets\nthroughout the binary. Each gadget is implemented as a single instruction followed by a call\nto a “resolver” function.\n\nObfuscated function prologue\n\n1/2\n\n\n-----\n\nObfuscated function\n\nprologue 2/2\nThe resolver function of each call resolves the address of the next gadget and passes\nexecution.\n\nResolver function computing the next gadget address\nThe obfuscation pattern is simple and a trace can be used to recover the original\ninstructions:\n```\nresult = []\nfor i, x in enumerate(trace):\n  if \"ret\" in x:\n    result.append(trace[i + 1])\n\n```\n**API loading**\n\n[The sample uses the common Ldr crawling technique to find the address of kernel32.dll.](https://0xevilc0de.com/2018/02/25/locating-dll-name-from-the-process-environment-block-peb/)\n\nSearching for the process module list in the PEB’s Ldr\n\n\n-----\n\nSearching for kernel32.dll by name in the module list\nNext, log.dll parses the exports of kernel32.dll to get the address of the LoadLibraryA and\n**GetProcAddress functions. It uses GetProcAddress to resolve imports as needed.**\n\n**Persistence**\n\nThe sample expects to find a file called log.dll.dat in its root directory using the\n**FindFirstFile and FindNextFile APIs. Once log.dll.dat is located, it is loaded, encrypted,**\nand stored in the registry under the\n**HKEY_LOCAL_MACHINE\\SOFTWARE\\Classes\\WOW6432Node\\CLSID\\{1845df8d-241a-**\n**a0e4-02ea341a79878897}\\D752E7A8} registry value.**\n\nThis registry value seems to be hard coded. If the file isn't found and the hard coded registry\nkey doesn’t exist, the application crashes.\n\nPayload is stored encrypted in the registry\nOnce the contents of log.dll.dat have been encrypted and embedded in the registry, the\noriginal file will be deleted. On subsequent runs, the shellcode will be loaded directly from the\nregistry key.\n\n**Shellcode**\n\n[To execute the shellcode the sample will allocate an RWX-protected memory region using](https://www.ired.team/offensive-security/defense-evasion/finding-all-rwx-protected-memory-regions)\nthe VirtualAlloc Windows API, then write the shellcode to the memory region and pass\nexecution to it with an ESI instruction call.\n\nlog.dll allocate RWX memory for the shellcode\n\n\n-----\n\nlog.dll pass execution to the shellcode\n\nFirst instruction of the shellcode\n\n### Other SHADOWPAD research\n\nWhile researching shared code and techniques, Elastic Security Labs identified a publication\nfrom SecureWorks’ CTU that describes the BitDefender sideload vulnerability. Additionally,\nSecureWorks has shared information describing the functionality of a file, log.dll.dat, which\n[is consistent with our observations. The team at Positive Technologies ETC also](https://www.ptsecurity.com/ww-en/analytics/pt-esc-threat-intelligence/) published\ndetailed research on SHADOWPAD which aligns with our research.\n\n### SHADOWPAD Summary\n\nSHADOWPAD is a malware family that SecureWorks CTU has associated with the BRONZE\nUNIVERSITY threat group and Positive Technologies ETC has associated with the Winnti\ngroup.\n\n## Campaign and adversary modeling\n\nOur analysis of Elastic telemetry, combined with open sources and compared with third-party\nreporting, concludes a single nationally-aligned threat group is likely responsible. We\nidentified relationships involving shared malware, techniques, victimology, and observed\nadversary priorities. Our confidence assessments vary depending on the sourcing and\ncollection fidelity.\n\nWe identified significant overlaps in the work of Positive Technologies ETC and SecureWorks\nCTU while researching the DOORME, SIESTAGRAPH, and SHADOWPAD implants, and\nbelieve these are related activity clusters.\n\n\n-----\n\nREF2924 intersections and associations\nIn the following analysis, we’ll discuss the four campaigns that we associate with this\nintrusion set including sourcing, intersections, and how each supported our attribution across\nall campaigns.\n\n1. Winnti - reported by Positive Technologies, January 2021\n2. Undisclosed REF, Winnti - observed by Elastic Security Labs, March 2022\n3. REF2924, ChamelGang, Winnti - reported by Elastic Security Labs, December 2022\n4. Undisclosed REF, ChamelGang - observed by Elastic Security Labs, December 2022\n\n### Winnti\n\n[In January of 2021, the team at Positive Technologies ETC published research that](https://www.ptsecurity.com/ww-en/analytics/pt-esc-threat-intelligence/higaisa-or-winnti-apt-41-backdoors-old-and-new/)\noverlapped with our observations for REF2924; specifically SHADOWPAD malware deployed\nwith the file names log.dll and log.dll.dat and using the same sample of BitDefender we\nobserved as a DLL injection vehicle.\n\nWhile the research from Positive Technologies ETC covered a different activity cluster, the\nadversary deployed a similar variant of SHADOWPAD, used a similar file naming\nmethodology, and leveraged similar procedure-level capabilities; these consistencies\ncontribute to our conclusion that REF2924 is related. In the graphic above, we use a dashed\nline to represent third-party consensus and moderate confidence because, while the\nreporting appears thorough and sound, we cannot independently validate all findings.\n\n### Undisclosed REF, Winnti\n\n\n-----\n\nIn early 2022, Elastic observed a short-lived intrusion into a telecommunications provider in\nAfghanistan. Using code analysis and event sampling, we internally attributed these\n[sightings to WINNTI malware implants and external research overlaps with the Winnti Group.](https://attack.mitre.org/groups/G0044/)\nWe continue to track this intrusion set, independently of and in relation to REF2924\nobservations.\n\n### REF2924, ChamelGang, Winnti\n\n[In early December 2022, we observed Powershell commands used to collect and export](https://www.elastic.co/security-labs/siestagraph-new-implant-uncovered-in-asean-member-foreign-ministry)\nmailboxes from an internet-connected Microsoft Exchange server for the Foreign Affairs\nOffice of an Association of Southeast Asian Nations (ASEAN) member. Our research\nidentified the presence of the DOORME backdoor, SHADOWPAD, and a new malware\nimplant we call SIESTAGRAPH (discussed in the SIESTAGRAPH code analysis section\nabove).\n\nIn researching the events of REF2924, we believe they are consistent with details noted by\n[Positive Technologies' research into ChamelGang, and likely represent the actions of one](https://www.ptsecurity.com/ww-en/analytics/pt-esc-threat-intelligence/new-apt-group-chamelgang/)\ngroup with shared goals.\n\n### Undisclosed REF, ChamelGang\n\nUsing the DOORME IIS backdoor that we collected during research into REF2924, we\ndeveloped a scanner that identified the presence of DOORME on an internet-connected\nExchange server at a second telecommunications provider in Afghanistan.\n\n### Campaign associations\n\nBuilding associations between events, especially when relying on third-party reporting, is a\ndelicate balance between surfacing value from specific observations and suppressing noise\nfrom circular reporting. Details reported by research teams and consisting of atomic\nindicators, techniques, procedures, and capabilities provide tremendous value in spotting\nassociations between activity clusters. Elements of evidence that are repeated multiple times\nvia circular reporting can lead to over-weighting that evidence. In analyzing these activity\nclusters, we have specific observations from our telemetry (host artifacts, capabilities,\nfunctionality, and adversary techniques) and third-party reporting consistent with our\nfindings.\n\nWe use third-party reporting as supporting, but not factual, evidence to add context to our\nspecific observations. It may be possible to verify a third-party had firsthand visibility of a\nthreat, but that’s a rare luxury. We used estimative language in building associations where\nappropriate.\n\n\n-----\n\nTo uncover potential associations among these campaigns, we weighed host artifacts, tools,\nand TTPs more heavily than transitory atomic indicators like hashes, IP addresses, and\ndomains.\n\nWe’ll discuss notable (non-exhaustive) overlaps in the following section.\n\n**Campaigns 1 and 3**\n\n[Campaigns 1 (Winnti) and 3 (REF2924, ChamelGang, Winnti) are related by several](https://www.ptsecurity.com/ww-en/analytics/pt-esc-threat-intelligence/higaisa-or-winnti-apt-41-backdoors-old-and-new/)\nelements: the use of the SHADOWPAD malware family, the specific file names (log.dll and\n**log.dll.dat), and the injection technique using the same BitDefender hash.**\n\n**Campaigns 3 and 4**\n\nCampaigns 3 (REF2924, ChamelGang, Winnti) and 4 (Undisclosed REF, ChamelGang) are\nrelated by the presence of a specifically configured DOORME backdoor and a shared\nnational strategic interest for the adversary.\n\nUsing network scan results for about 180k publicly-accessible Exchange servers, and\nspecific authentication elements uncovered while reverse engineering REF2924’s DOORME\nsample, we were able to identify an identical DOORME configuration at a second\ntelecommunications provider in Afghanistan. This was a different victim than Campaign 2\n(Undisclosed REF, Winnti).\n\nWhile the DOORME IIS backdoor is not widely prevalent, simply having DOORME in your\nenvironment isn’t a strong enough data point to build an association. The presence of this\nDOORME configuration, when compared to a search of 180k other Exchange servers and\nthe moderate confidence of the national strategic interests, led us to associate Campaigns 3\nand 4 together with high confidence and that Campaign 4 was also a part of the same threat\ngroup.\n\n## Summary\n\nDOORME allows for a threat actor to access a targeted network through the use of a\nbackdoored IIS module on an internet-connected server. DOORME includes the capability to\ncollect information about the infected host, upload shellcode chunks to evade detection, and\nexecute shellcode in memory.\n\nSIESTAGRAPH is an implant discovered by Elastic Security Labs that uses the Microsoft\nGraph API for command and control. The Graph API is used for interacting with Microsoft\nOffice 365, so C2 communication would be largely masked by legitimate network traffic.\nElastic Security Labs has reported the tenant ID hard coded into SIESTAGRAPH to\nMicrosoft.\n\n\n-----\n\nBased on our code analysis and the limited internet presence of DOORME and\nSIESTAGRAPH, we believe that this intrusion set is used by a limited distribution, or singular,\nthreat actor.\n\nSHADOWPAD is a modular malware family that is used as a way to load and execute\nshellcode onto a victim system. While it has been tracked since 2017, SHADOWPAD\ncontinues to be a capable and popular remote access and persistence tool.\n\nThe REF2924 intrusion set, using SIESTAGRAPH, DOORME, SHADOWPAD, and the\nsystem binary proxy execution technique (among others) represents an attack group that\nappears focused on priorities that, when observed across campaigns, align with a sponsored\nnational strategic interest.\n\n## Detections\n\n### Hunting queries\n\nHunting queries are used as a starting point for potentially malicious events, but because\nevery environment is different, an investigation should be completed.\n\nThe following KQL query can be used to hunt for additional behaviors related to\nSIESTAGRAPH. This query looks for processes that are making DNS queries to\ngraph.microsoft.com where the process does not have a trusted code-signing certificate or\nthe process is not signed by Microsoft.\n```\ndns.question.name : \"graph.microsoft.com\" and (process.code_signature.trusted :\n“false” or not (process.code_signature.subject_name : \"Microsoft Windows\" or\nprocess.code_signature.subject_name : \"Microsoft Windows Publisher\" or\nprocess.code_signature.subject_name : \"Microsoft Corporation\")) and process.name : *\n\n### YARA rules\n\n```\n**The DOORME IIS module**\n\n\n-----\n\n```\nrule Windows_Trojan_DoorMe {\n\n  meta:\n\n    author = \"Elastic Security\"\n\n    creation_date = \"2022-12-09\"\n\n    last_modified = \"2022-12-15\"\n\n    os = \"Windows\"\n\n    arch = \"x86\"\n\n    category_type = \"Trojan\"\n\n    family = \"DoorMe\"\n\n    threat_name = \"Windows.Trojan.DoorMe\"\n\n    license = \"Elastic License v2\"\n\n  strings:\n\n    $seq_aes_crypto = { 8B 6C 24 ?? C1 E5 ?? 8B 5C 24 ?? 8D 34 9D ?? ?? ?? ?? 0F\nB6 04 31 32 44 24 ?? 88 04 29 8D 04 9D ?? ?? ?? ?? 0F B6 04 01 32 44 24 ?? 88 44 29\n?? 8D 04 9D ?? ?? ?? ?? 0F B6 04 01 44 30 F8 88 44 29 ?? 8D 04 9D ?? ?? ?? ?? 0F B6\n04 01 44 30 E0 88 44 29 ?? 8B 74 24 ?? }\n\n    $seq_copy_str = { 48 8B 44 24 ?? 48 89 58 ?? 48 89 F1 4C 89 F2 49 89 D8 E8 ??\n?? ?? ?? C6 04 1E ?? }\n\n    $seq_md5 = { 89 F8 44 21 C8 44 89 C9 F7 D1 21 F1 44 01 C0 01 C8 44 8B AC 24\n?? ?? ?? ?? 8B 9C 24 ?? ?? ?? ?? 48 89 B4 24 ?? ?? ?? ?? 44 89 44 24 ?? 46 8D 04 28\n41 81 C0 ?? ?? ?? ?? 4C 89 AC 24 ?? ?? ?? ?? 41 C1 C0 ?? 45 01 C8 44 89 C1 44 21 C9\n44 89 C2 F7 D2 21 FA 48 89 BC 24 ?? ?? ?? ?? 8D 2C 1E 49 89 DC 01 D5 01 E9 81 C1 ??\n?? ?? ?? C1 C1 ?? 44 01 C1 89 CA 44 21 C2 89 CD F7 D5 44 21 CD 8B 84 24 ?? ?? ?? ??\n48 89 44 24 ?? 8D 1C 07 01 EB 01 DA 81 C2 ?? ?? ?? ?? C1 C2 ?? }\n\n    $seq_calc_key = { 31 FF 48 8D 1D ?? ?? ?? ?? 48 83 FF ?? 4C 89 F8 77 ?? 41 0F\nB6 34 3E 48 89 F1 48 C1 E9 ?? 44 0F B6 04 19 BA ?? ?? ?? ?? 48 89 C1 E8 ?? ?? ?? ??\n83 E6 ?? 44 0F B6 04 1E BA ?? ?? ?? ?? 48 8B 4D ?? E8 ?? ?? ?? ?? 48 83 C7 ?? }\n\n    $seq_base64 = { 8A 45 ?? 8A 4D ?? C0 E0 ?? 89 CA C0 EA ?? 80 E2 ?? 08 C2 88\n55 ?? C0 E1 ?? 8A 45 ?? C0 E8 ?? 24 ?? 08 C8 88 45 ?? 41 83 C4 ?? 31 F6 44 39 E6 7D\n?? 66 90 }\n\n    $str_0 = \".?AVDoorme@@\" ascii fullword\n\n  condition:\n\n    3 of ($seq*) or 1 of ($str*)\n\n}Read more\n\n```\n**The SIESTAGRAPH implant**\n\n\n-----\n\n```\nrule Windows_Trojan_SiestaGraph {\n\n  meta:\n\n    author = \"Elastic Security\"\n\n    creation_date = \"2022-12-14\"\n\n    last_modified = \"2022-12-15\"\n\n    os = \"windows\"\n\n    arch_context = \"x86\"\n\n    category_type = “Trojan”\n\n    family = “SiestaGraph”\n\n    threat_name = \"Windows.Trojan.SiestaGraph\"\n\n    license = \"Elastic License v2\"\n\n  strings:\n\n    $a1 = \"downloadAsync\" ascii nocase fullword\n\n    $a2 = \"UploadxAsync\" ascii nocase fullword\n\n    $a3 = \"GetAllDriveRootChildren\" ascii fullword\n\n    $a4 = \"GetDriveRoot\" ascii fullword\n\n    $a5 = \"sendsession\" wide fullword\n\n    $b1 = \"ListDrives\" wide fullword\n\n    $b2 = \"Del OK\" wide fullword\n\n    $b3 = \"createEmailDraft\" ascii fullword\n\n    $b4 = \"delMail\" ascii fullword\n\n  condition:\n\n    all of ($a*) and 2 of ($b*)\n\n}Read more\n\n```\n**The SHADOWPAD malware family**\n\n\n-----\n\n```\nrule Windows_Trojan_ShadowPad_1 {\n\n     meta:\n\n          author = \"Elastic Security\"\n\n          creation_date = \"2023-01-23\"\n\n          last_modified = \"2023-01-31\"\n\n          description = \"Target SHADOWPAD obfuscation loader+payload\"\n\n          os = \"Windows\"\n\n          arch = \"x86\"\n\n          category_type = \"Trojan\"\n\n          family = \"ShadowPad\"\n\n          threat_name = \"Windows.Trojan.ShadowPad\"\n\n          license = \"Elastic License v2\"\n\n     strings:\n\n          $a1 = { 87 0? 24 0F 8? }\n\n          $a2 = { 9C 0F 8? }\n\n          $a3 = { 03 0? 0F 8? }\n\n          $a4 = { 9D 0F 8? }\n\n          $a5 = { 87 0? 24 0F 8? }\n\n     condition:\n\n          all of them\n\n}\n\nrule Windows_Trojan_Shadowpad_2 {\n\n     meta:\n\n          author = \"Elastic Security\"\n\n          creation_date = \"2023-01-31\"\n\n          last_modified = \"2023-01-31\"\n\n          description = \"Target SHADOWPAD loader\"\n\n          os = \"Windows\"\n\n          arch = \"x86\"\n\n          category_type = \"Trojan\"\n\n          family = \"Shadowpad\"\n\n          threat_name = \"Windows.Trojan.Shadowpad\"\n\n          license = \"Elastic License v2\"\n\n     strings:\n\n          $a1 = \"{%8.8x-%4.4x-%4.4x-%8.8x%8.8x}\"\n\n     condition:\n\n          all of them\n\n}\n\nrule Windows_Trojan_Shadowpad_3 {\n\n     meta:\n\n          author = \"Elastic Security\"\n\n          creation_date = \"2023-01-31\"\n\n          last_modified = \"2023-01-31\"\n\n          description = \"Target SHADOWPAD payload\"\n\n          os = \"Windows\"\n\n          arch = \"x86\"\n\n          category_type = \"Trojan\"\n\n          family = \"Shadowpad\"\n\n          threat_name = \"Windows.Trojan.Shadowpad\"\n\n          license = \"Elastic License v2\"\n\n     strings:\n\n          $a1 = \"hH#whH#w\" fullword\n\n```\n\n-----\n\n```\n          $a2 Yuv YuvsYuvhYuv]YuvRYuvGYuv1:tv<Yuvb#tv1Yuv 8tv&Yuv fullword\n\n          $a3 = \"pH#wpH#w\" fullword\n\n          $a4 = \"HH#wHH#wA\" fullword\n\n          $a5 = \"xH#wxH#w:$\" fullword\n\n          $re1 = /(HTTPS|TCP|UDP):\\/\\/[^:]+:443/\n\n     condition:\n\n          4 of them\n\n}Read more\n\n## Indicators\n\n```\n[Artifacts are available from the previously published REF2924 research.](https://www.elastic.co/security-labs/siestagraph-new-implant-uncovered-in-asean-member-foreign-ministry#observables)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2023/2023-02-02 - Update to the REF2924 intrusion set and related campaigns.pdf"
    ],
    "report_names": [
        "2023-02-02 - Update to the REF2924 intrusion set and related campaigns.pdf"
    ],
    "threat_actors": [
        {
            "id": "4434c71b-c424-4c06-b923-4f3f54f24f40",
            "created_at": "2022-10-25T16:07:23.453526Z",
            "updated_at": "2025-03-27T02:02:09.810373Z",
            "deleted_at": null,
            "main_name": "ChamelGang",
            "aliases": [
                "CamoFei"
            ],
            "source_name": "ETDA:ChamelGang",
            "tools": [
                "7-Zip",
                "Agentemis",
                "BeaconLoader",
                "Cobalt Strike",
                "CobaltStrike",
                "DoorMe",
                "FRP",
                "Fast Reverse Proxy",
                "ProxyT",
                "Tiny SHell",
                "cobeacon",
                "tsh"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "f9fa9633-dfd1-458d-84ce-cc36dcdc7ce4",
            "created_at": "2022-10-25T16:07:24.188897Z",
            "updated_at": "2025-03-27T02:02:10.136127Z",
            "deleted_at": null,
            "main_name": "Siesta",
            "aliases": [],
            "source_name": "ETDA:Siesta",
            "tools": [
                "Chymine",
                "Darkmoon",
                "Gen:Trojan.Heur.PT",
                "Poison Ivy",
                "SPIVY",
                "pivy",
                "poisonivy"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "f9bb42e1-65d6-444e-8c63-21c2605b49e0",
            "created_at": "2023-01-06T13:46:38.887429Z",
            "updated_at": "2025-03-27T02:00:02.943493Z",
            "deleted_at": null,
            "main_name": "Siesta",
            "aliases": [],
            "source_name": "MISPGALAXY:Siesta",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "5bbced13-72f7-40dc-8c41-dcce75bf885e",
            "created_at": "2022-10-25T15:50:23.695735Z",
            "updated_at": "2025-03-27T02:00:55.525839Z",
            "deleted_at": null,
            "main_name": "Winnti Group",
            "aliases": [
                "Winnti Group"
            ],
            "source_name": "MITRE:Winnti Group",
            "tools": [
                "PipeMon",
                "Winnti for Windows",
                "PlugX"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "a0673493-5872-49a0-8d0d-4391302cff01",
            "created_at": "2023-03-04T02:01:54.10107Z",
            "updated_at": "2025-03-27T02:00:03.121756Z",
            "deleted_at": null,
            "main_name": "Chamelgang",
            "aliases": [
                "CamoFei"
            ],
            "source_name": "MISPGALAXY:Chamelgang",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "9f101d9c-05ea-48b9-b6f1-168cd6d06d12",
            "created_at": "2023-01-06T13:46:39.396409Z",
            "updated_at": "2025-03-27T02:00:03.074969Z",
            "deleted_at": null,
            "main_name": "Earth Lusca",
            "aliases": [
                "CHROMIUM",
                "ControlX",
                "Red Dev 10",
                "RedHotel",
                "Red Scylla",
                "TAG-22",
                "BRONZE UNIVERSITY",
                "AQUATIC PANDA",
                "Charcoal Typhoon",
                "BountyGlad"
            ],
            "source_name": "MISPGALAXY:Earth Lusca",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "873919c0-bc6a-4c19-b18d-c107e4aa3d20",
            "created_at": "2023-01-06T13:46:39.138138Z",
            "updated_at": "2025-03-27T02:00:03.005534Z",
            "deleted_at": null,
            "main_name": "Higaisa",
            "aliases": [],
            "source_name": "MISPGALAXY:Higaisa",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "945a572f-ebe3-4e2f-a288-512fe751cfa8",
            "created_at": "2022-10-25T16:07:24.413971Z",
            "updated_at": "2025-03-27T02:02:10.212853Z",
            "deleted_at": null,
            "main_name": "Winnti Group",
            "aliases": [
                "Wicked Panda",
                "Winnti Group"
            ],
            "source_name": "ETDA:Winnti Group",
            "tools": [
                "Agentemis",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "FunnySwitch",
                "RbDoor",
                "RibDoor",
                "RouterGod",
                "Winnti",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "dbee5a02-e2d6-49d2-9bb5-5a9e93fd1de9",
            "created_at": "2023-11-07T02:00:07.108976Z",
            "updated_at": "2025-03-27T02:00:03.178328Z",
            "deleted_at": null,
            "main_name": "REF2924",
            "aliases": [],
            "source_name": "MISPGALAXY:REF2924",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "6abcc917-035c-4e9b-a53f-eaee636749c3",
            "created_at": "2022-10-25T16:07:23.565337Z",
            "updated_at": "2025-03-27T02:02:09.868522Z",
            "deleted_at": null,
            "main_name": "Earth Lusca",
            "aliases": [
                "Bronze University",
                "Charcoal Typhoon",
                "Chromium",
                "Red Dev 10",
                "Red Scylla"
            ],
            "source_name": "ETDA:Earth Lusca",
            "tools": [
                "Agentemis",
                "AntSword",
                "BIOPASS",
                "BIOPASS RAT",
                "BadPotato",
                "Behinder",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "Doraemon",
                "FRP",
                "Fast Reverse Proxy",
                "FunnySwitch",
                "HUC Port Banner Scanner",
                "KTLVdoor",
                "Mimikatz",
                "NBTscan",
                "POISONPLUG.SHADOW",
                "PipeMon",
                "RbDoor",
                "RibDoor",
                "RouterGod",
                "SAMRID",
                "ShadowPad Winnti",
                "SprySOCKS",
                "WinRAR",
                "Winnti",
                "XShellGhost",
                "cobeacon",
                "fscan",
                "lcx",
                "nbtscan"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "16928152-ad42-4cd4-83de-5bd38c961e5d",
            "created_at": "2024-06-04T02:03:07.743884Z",
            "updated_at": "2025-03-27T02:05:17.29525Z",
            "deleted_at": null,
            "main_name": "BRONZE UNIVERSITY",
            "aliases": [
                ""
            ],
            "source_name": "Secureworks:BRONZE UNIVERSITY",
            "tools": [
                " Cobalt Strike",
                " Fishmaster",
                " FunnySwitch",
                " ShadowPad",
                " Spyder",
                " njRAT",
                "Brute Ratel C4"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "30c9c492-afc6-4aa1-8fe6-cecffed946e0",
            "created_at": "2022-10-25T15:50:23.400822Z",
            "updated_at": "2025-03-27T02:00:55.461334Z",
            "deleted_at": null,
            "main_name": "Higaisa",
            "aliases": [
                "Higaisa"
            ],
            "source_name": "MITRE:Higaisa",
            "tools": [
                "PlugX",
                "certutil",
                "gh0st RAT"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "4c68ccd0-caba-4189-9ead-86ac4c2d9b70",
            "created_at": "2024-05-01T02:03:07.930196Z",
            "updated_at": "2025-03-27T02:05:17.251237Z",
            "deleted_at": null,
            "main_name": "BRONZE ATLAS",
            "aliases": [
                "Axiom",
                "BARIUM ",
                "Blackfly ",
                "CTG-2633",
                "GREF",
                "Group 72 ",
                "Red Kelpie ",
                "TG-2633 ",
                "Wicked Panda ",
                "Winnti",
                "APT41 "
            ],
            "source_name": "Secureworks:BRONZE ATLAS",
            "tools": [
                " CCleaner v5.33 backdoor",
                " ChinaChopper",
                " Cobalt Strike",
                " Dicey MSDN",
                " ForkPlayground",
                " HUC Proxy Malware (Htran)",
                " Mimikatz",
                " PipeMon",
                " PlugX",
                " PortReuse",
                " Powershell Empire",
                " RCMD",
                " RbDoor",
                " SPEEDBOAT",
                " ShadowPad",
                " Sidewalk",
                " Speculoos",
                " TeamViewer",
                " Winnkit",
                " Winnti",
                " reg save",
                " vssadmin",
                "Acehash"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "c0cedde3-5a9b-430f-9b77-e6568307205e",
            "created_at": "2022-10-25T16:07:23.528994Z",
            "updated_at": "2025-03-27T02:02:09.847683Z",
            "deleted_at": null,
            "main_name": "DarkHotel",
            "aliases": [
                "APT-C-06",
                "ATK 52",
                "CTG-1948",
                "Dubnium",
                "Fallout Team",
                "Higaisa",
                "Luder",
                "Operation DarkHotel",
                "Operation Daybreak",
                "Operation Inexsmar",
                "Operation PowerFall",
                "Operation The Gh0st Remains the Same",
                "SIG25",
                "Shadow Crane",
                "T-APT-02",
                "Tungsten Bridge",
                "Zigzag Hail"
            ],
            "source_name": "ETDA:DarkHotel",
            "tools": [
                "Asruex",
                "DarkHotel",
                "DmaUp3.exe",
                "GreezeBackdoor",
                "Karba",
                "Nemain",
                "Nemim",
                "Ramsay",
                "Retro",
                "Tapaoux",
                "Trojan.Win32.Karba.e",
                "Virus.Win32.Pioneer.dx",
                "igfxext.exe",
                "msieckc.exe"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "c7d9878a-e691-4c6f-81ae-84fb115a1345",
            "created_at": "2022-10-25T16:07:23.359506Z",
            "updated_at": "2025-03-27T02:02:09.752427Z",
            "deleted_at": null,
            "main_name": "APT 41",
            "aliases": [
                "BrazenBamboo",
                "Bronze Atlas",
                "Double Dragon",
                "Earth Baku",
                "Grayfly",
                "Operation ColunmTK",
                "Operation CuckooBees",
                "Operation ShadowHammer",
                "Red Kelpie",
                "SparklingGoblin",
                "TA415",
                "TG-2633"
            ],
            "source_name": "ETDA:APT 41",
            "tools": [
                "9002 RAT",
                "ADORE.XSEC",
                "ASPXSpy",
                "ASPXTool",
                "AceHash",
                "Agent.dhwf",
                "Agentemis",
                "AndroidControl",
                "AngryRebel",
                "AntSword",
                "BIOPASS",
                "BIOPASS RAT",
                "BLUEBEAM",
                "Barlaiy",
                "BlackCoffee",
                "Bladabindi",
                "BleDoor",
                "CCleaner Backdoor",
                "CHINACHOPPER",
                "COLDJAVA",
                "China Chopper",
                "ChyNode",
                "Cobalt Strike",
                "CobaltStrike",
                "Crackshot",
                "CrossWalk",
                "CurveLast",
                "CurveLoad",
                "DAYJOB",
                "DBoxAgent",
                "DEADEYE",
                "DEADEYE.APPEND",
                "DEADEYE.EMBED",
                "DEPLOYLOG",
                "DIRTCLEANER",
                "DUSTTRAP",
                "Derusbi",
                "Destroy RAT",
                "DestroyRAT",
                "DodgeBox",
                "DragonEgg",
                "ELFSHELF",
                "EasyNight",
                "Farfli",
                "FunnySwitch",
                "Gh0st RAT",
                "Ghost RAT",
                "HDD Rootkit",
                "HDRoot",
                "HKDOOR",
                "HOMEUNIX",
                "HUI Loader",
                "HidraQ",
                "HighNoon",
                "HighNote",
                "Homux",
                "Hydraq",
                "Jorik",
                "Jumpall",
                "KEYPLUG",
                "Kaba",
                "Korplug",
                "LATELUNCH",
                "LOLBAS",
                "LOLBins",
                "LightSpy",
                "Living off the Land",
                "Lowkey",
                "McRAT",
                "MdmBot",
                "MessageTap",
                "Meterpreter",
                "Mimikatz",
                "MoonBounce",
                "MoonWalk",
                "Motnug",
                "Moudour",
                "Mydoor",
                "NTDSDump",
                "PACMAN",
                "PCRat",
                "PINEGROVE",
                "PNGRAT",
                "POISONPLUG",
                "POISONPLUG.SHADOW",
                "POTROAST",
                "PRIVATELOG",
                "PipeMon",
                "PlugX",
                "PortReuse",
                "ProxIP",
                "ROCKBOOT",
                "RbDoor",
                "RedDelta",
                "RedXOR",
                "RibDoor",
                "Roarur",
                "RouterGod",
                "SAGEHIRE",
                "SPARKLOG",
                "SQLULDR2",
                "STASHLOG",
                "SWEETCANDLE",
                "ScrambleCross",
                "Sensocode",
                "SerialVlogger",
                "ShadowHammer",
                "ShadowPad Winnti",
                "SinoChopper",
                "Skip-2.0",
                "SneakCross",
                "Sogu",
                "Speculoos",
                "Spyder",
                "StealthReacher",
                "StealthVector",
                "TERA",
                "TIDYELF",
                "TIGERPLUG",
                "TOMMYGUN",
                "TVT",
                "Thoper",
                "Voldemort",
                "WIDETONE",
                "WINNKIT",
                "WINTERLOVE",
                "Winnti",
                "WyrmSpy",
                "X-Door",
                "XDOOR",
                "XMRig",
                "XShellGhost",
                "Xamtrav",
                "ZXShell",
                "ZoxPNG",
                "certutil",
                "certutil.exe",
                "cobeacon",
                "gresim",
                "njRAT",
                "pwdump",
                "xDll"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "4d5f939b-aea9-4a0e-8bff-003079a261ea",
            "created_at": "2023-01-06T13:46:39.04841Z",
            "updated_at": "2025-03-27T02:00:02.985296Z",
            "deleted_at": null,
            "main_name": "APT41",
            "aliases": [
                "G0096",
                "Grayfly",
                "BARIUM",
                "BRONZE ATLAS",
                "BRONZE EXPORT",
                "Red Kelpie",
                "HOODOO",
                "Brass Typhoon",
                "TA415",
                "WICKED SPIDER",
                "WICKED PANDA",
                "G0044",
                "Earth Baku"
            ],
            "source_name": "MISPGALAXY:APT41",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1680660602,
    "ts_updated_at": 1743041757,
    "ts_creation_date": 1680511675,
    "ts_modification_date": 1680511675,
    "files": {
        "pdf": "https://archive.orkl.eu/023b0f8abfd4bc74f224d6597b78f66ddbd28e6f.pdf",
        "text": "https://archive.orkl.eu/023b0f8abfd4bc74f224d6597b78f66ddbd28e6f.txt",
        "img": "https://archive.orkl.eu/023b0f8abfd4bc74f224d6597b78f66ddbd28e6f.jpg"
    }
}