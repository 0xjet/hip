{
    "id": "f68f53f4-995c-406f-a4d3-7937290a4873",
    "created_at": "2023-01-12T15:04:31.601115Z",
    "updated_at": "2025-03-27T02:16:39.948299Z",
    "deleted_at": null,
    "sha1_hash": "55271eb05dcadd3d2060eb1b464df0ca80d88ff6",
    "title": "2020-06-09 - Misconfigured Amazon S3 Buckets Continue to be a Launchpad for Malicious Code",
    "authors": "",
    "file_creation_date": "2022-05-28T02:36:25Z",
    "file_modification_date": "2022-05-28T02:36:25Z",
    "file_size": 6044087,
    "plain_text": "# Misconfigured Amazon S3 Buckets Continue to be a Launchpad for Malicious Code\n\n**riskiq.com/blog/labs/misconfigured-s3-buckets/**\n\nJune 12, 2020\n\nLabs Analyst\n\nJune 12, 2020\n\nBy Jordan Herman\n\nRiskIQ continues to surface threat campaigns leveraging misconfigured Amazon S3 Buckets\nto insert malicious code into websites.\n\nAmazon S3 buckets are public cloud storage resources available in AWS Simple Storage\nService (S3), an object storage offering similar to folders that consist of data and its\ndescriptive metadata. These useful resources are ubiquitous in the developer world, but all\ntoo often misconfigured when deployed. Attackers, who can gain code-level access to a\nwebsite by hacking these vulnerable web assets, have begun mass scanning for\nmisconfigured buckets and ramping up attacks.\n\nLast year, RiskIQ identified a [Magecart campaign leveraging misconfigured S3 buckets to](https://riskiqold.wpengine.com/blog/labs/magecart-amazon-s3-buckets/)\ninsert JavaScript credit card skimmers on hundreds of websites. Around the same time, our\nresearchers identified another strain of malicious code using the same S3 bucket attack\n\n\n-----\n\nvector, often appearing alongside the Magecart skimming code. After analysis, we\ndiscovered that this other malicious code, a redirector we refer to as 'jqueryapi1oad,' is\nrelated to a long-running malvertising campaign.\n\nIn this research, we dissect the code and tactics used in these attacks, and, with RiskIQ's\nunique data sets, determine the threat campaign's scope.\n\n## Misconfigured Amazon S3 Buckets: A launchpad for malicious code\n\nOn May 12th, RiskIQ observed more Magecart skimming code on three websites*, each\nrelated to one another and hosting content and chat forums catering to firefighters, police\nofficers, and security professionals.\n\nHere, we see skimming code injected into img.firehouse[.]com/forums/fhc-ad-forums.js\n\nAnd, here, we see it injected into img.securityinfowatch[.]com/forums/fhc-ad-forums.js:\n\nWe also observed a skimmer on img.officer[.]com/forums/ofcr-ad-forums.js. However,\nanother strain of malicious code appears alongside the skimmer in this JavaScript—none\nother than jqueryapi1oad. This script loads content from gold.platinumus[.]top/track/awswrite.\nWe'll discuss this further later in this report.\n\n\n-----\n\n*The sites identified above belong to Endeavor Business Media. Update: Endeavor\nBusiness Media has informed us it has remediated the misconfiguration and removed the\nskimmers and jquerapi1oad redirector from their websites. We have confirmed that the sites\nare now clean.\n\n## jqueryapi1oad is on 362 unique domains\n\nWe first identified the jqueryapi1oad malicious redirector—so named after the cookie we\nconnected with it—in July of 2019. Our research team determined that the actors behind this\nmalicious code were also exploiting misconfigured S3 buckets. Looking at RiskIQ data for\nthe jqueryapi1oad cookie, we see that it first appeared on 2019-04-26 and is still in use,\nconnected with 362 unique domains to date, including officer[.]com.\n\nThe gold.platinumus[.]top hostname has resided on 185.180.196[.]4 since it was first\nregistered.\n\n\n-----\n\nThe IP belongs to the well-known bulletproof hosting company King Servers. Fourteen other\nhosts also appear on this IP address.\n\n\n-----\n\nA series of other cookies that follow a uniform naming format are associated with these\nhosts. Several other cookies as well. Here are three examples below:\n\n\n-----\n\n[https://community.riskiq.com/search/gold.platinumus.top/cookies](https://community.riskiq.com/search/gold.platinumus.top/cookies)\n\n[https://community.riskiq.com/search/b.5bnewbtrack.info/cookies](https://community.riskiq.com/search/b.5bnewbtrack.info/cookies)\n\n[https://community.riskiq.com/search/d.jtrackd.icu/cookies](https://community.riskiq.com/search/d.jtrackd.icu/cookies)\n\nWith the capability to perform a trailing wildcard search of cookie names in the RiskIQ\nplatform, we can quickly identify 176 other hosts associated with these cookies.\n\n\n-----\n\nThe code itself performs a bot check and sets the jqueryapi1oad cookie along with an\nexpiration period based on the outcome of the check. It then creates a new element in the\nDOM of the page into which it's injected and pulls the new content from the\ngold.platinumus[.]top/track/awswrite URL.\n\n## Connections to Hookads and TSS\n\nOn May 16th, 2019, a few weeks after gold.platinumus.top was registered, RiskIQ observed\nan instance of jqueryapi1oad loaded from app-google-analytics.s3-sa-east1.misconfiguredaws[.]com.\n\n\n-----\n\nThe malicious JavaScript creates a PHP file named 'this.php' (note 'this.responseText' in the\ncode sample above). The PHP file contains another URL, eimage[.]tk/index/?\n4021528806835, which was loaded by the compromised page.\n\nThe eimage[.]tk URL loads a cookie associated with the Keitaro traffic distribution system\n(TDS).\n\n\n-----\n\nRiskIQ tracking of Keitaro associates 47,077 unique domains with this TDS:\n\nThe eimage[.]tk page also loads a second redirection script, which we associate with the\nHookads malvertising campaign. This campaign has historically been connected to exploit\nkits and other malicious behavior.\n\n\n-----\n\nWithin the redirection code is the URL take-prize-here2[.]life, yet another redirector ultimately\nlanding on a scam page at best6650.ttxsrl38[.]agency.\n\nHere's what the page looks like:\n\nRiskIQ also captured instances of jqueryapi1oad on popular websites. The domain\nfutbolred[.]com is a Colombian soccer news site that's in the top 30,000 of global Alexa\nrankings. It also misconfigured an S3 bucket, leaving it open to jqueryapi1oad.\n\n\n-----\n\nHere we see the sequences where the S3 bucket loaded content from gold.platinum[.]us,\ncreating the redirection through cermageratin[.]tk to wosemdesyane[.]site.\n\n\n-----\n\nThe wosemdesyane.site URL then redirects to a fake flash download page.\n\n\n-----\n\nRiskIQ has so far identified 277 unique hosts directly affected by jqueryapi1oad.\n\n## Conclusion\n\nMisconfigured Amazon S3 buckets that allow malicious actors to insert their code into\nnumerous websites is an ongoing issue. Here, we have identified three sites belonging to the\nsame company that currently host instances of Magecart. One of these is also hosting\njqueryapi1oad, a malicious redirector we connect to the Hookads campaign, which has been\nhistorically associated with exploit kits and other malicious behavior.\n\nAs attacks involving misconfigured S3 buckets continue, knowing where your organization is\nusing them across its digital attack surface is imperative. In today's threat environment,\nbusinesses cannot move forward safely without having a digital footprint, an inventory of all\ndigital assets, to ensure they are under the management of your security team and properly\nconfigured.\n\n## Amazon S3 Bucket Mitigation: Logs, Review & Investigation\n\nA compromised S3 bucket is a painful moment for an organization, but it's also a pivotal one.\nOnce the compromise comes to light, it is essential to assess the full scope of the incident.\nWhile the exact list of questions may differ depending on the type of organization, we\n\n\n-----\n\nrecommend first answering these basic questions when performing your investigation:\n\nWhat happened?: This question might seem too basic, but starting with a high-level\nincident description is extremely helpful.\nHow did it happen?: Check logs and file modification timestamps, and try to save all\nthis information to get a full picture of what happened and when. here are three ways\nfor customers to enable this logging:\n\n[1. https://docs.aws.misconfigured.com/misconfiguredS3/latest/dev/cloudtrail-logging.html](https://docs.aws.amazon.com/AmazonS3/latest/dev/cloudtrail-logging.html)\n[2. https://docs.aws.misconfigured.com/misconfiguredS3/latest/dev/ServerLogs.htm](https://docs.aws.amazon.com/AmazonS3/latest/dev/ServerLogs.htm)\n3. Response automated using Lambda: https://www.youtube.com/watch?v=8qQ5Ng\nFGB0\n\nWhat is the impact?: Did someone access, remove, or modify files they shouldn't have,\nand what was the impact of this? Were processes deteriorated? Was public content\naffected, resulting in theft, such as Magecart skimming or other exposure?\n\nSome compromises might only result in external damage such as to the brand, or no\ndamage at all, but it's still essential for the security team to get answers. Groups like\nMagecart and those behind are always on the prowl and will be back to compromise you\nagain if you don't fix your exposures. Next time, the damage could be catastrophic.\n\nOnce these questions are answered, the next step is mitigation. The basics of most, if not all,\nS3 bucket compromises we observe come down to improper access control. We suggest\ncleaning out the bucket and performing a new deployment of resources or simply setting up\n[a new bucket. Customers can also enable versioning on their buckets to \"rollback\" objects to](https://docs.aws.amazon.com/AmazonS3/latest/dev/Versioning.html)\na known good version. As for the policies to secure your bucket, we recommend the\nfollowing approach:\n\nCheck the data classification. Can it be public or not?\nDo not give everyone write permissions.\nOnly provide write permissions to specific users or hosts, and review their need for\naccess periodically.\nTake a whitelist approach with the above items, only explicitly provide write and/or read\naccess.\nAccount admins can also enable account level blocks via\nhttps://aws.misconfigured.com/blogs/aws/misconfigured-s3-block-public-accessanother-layer-of-protection-for-your-accounts-and-buckets/\n\n## IOCs:\n\nFor the IOCs used in this attack, check out the RiskIQ PassiveTotal Public Project here:\n[https://community.riskiq.com/projects/df970082-5cd5-49ab-b595-ef3fa79d8bce](https://community.riskiq.com/projects/df970082-5cd5-49ab-b595-ef3fa79d8bce)\n\n\n-----\n\n## Subscribe to Our Newsletter\n\nSubscribe to the RiskIQ newsletter to stay up-to-date on our latest content, headlines,\nresearch, events, and more.\n\nBase Editor\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2020/2020-06-09 - Misconfigured Amazon S3 Buckets Continue to be a Launchpad for Malicious Code.pdf"
    ],
    "report_names": [
        "2020-06-09 - Misconfigured Amazon S3 Buckets Continue to be a Launchpad for Malicious Code.pdf"
    ],
    "threat_actors": [
        {
            "id": "33f527a5-a5da-496a-a48c-7807cc858c3e",
            "created_at": "2022-10-25T15:50:23.803657Z",
            "updated_at": "2025-03-27T02:00:55.550132Z",
            "deleted_at": null,
            "main_name": "PLATINUM",
            "aliases": [
                "PLATINUM"
            ],
            "source_name": "MITRE:PLATINUM",
            "tools": [
                "JPIN",
                "Dipsind",
                "adbupd"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "4f39c998-5861-4f35-ac24-095653a8b615",
            "created_at": "2023-01-06T13:46:38.836253Z",
            "updated_at": "2025-03-27T02:00:02.931259Z",
            "deleted_at": null,
            "main_name": "HookAds",
            "aliases": [],
            "source_name": "MISPGALAXY:HookAds",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "2864e40a-f233-4618-ac61-b03760a41cbb",
            "created_at": "2023-12-01T02:02:34.272108Z",
            "updated_at": "2025-03-27T02:02:10.209072Z",
            "deleted_at": null,
            "main_name": "WildCard",
            "aliases": [],
            "source_name": "ETDA:WildCard",
            "tools": [
                "RustDown",
                "SysJoker"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "5a0483f5-09b3-4673-bb5a-56d41eaf91ed",
            "created_at": "2023-01-06T13:46:38.814104Z",
            "updated_at": "2025-03-27T02:00:02.925972Z",
            "deleted_at": null,
            "main_name": "MageCart",
            "aliases": [],
            "source_name": "MISPGALAXY:MageCart",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "7d8ef10e-1d7b-49a0-ab6e-f1dae465a1a4",
            "created_at": "2023-01-06T13:46:38.595679Z",
            "updated_at": "2025-03-27T02:00:02.869216Z",
            "deleted_at": null,
            "main_name": "PLATINUM",
            "aliases": [
                "TwoForOne",
                "G0068",
                "ATK33"
            ],
            "source_name": "MISPGALAXY:PLATINUM",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "e61c46f7-88a1-421a-9fed-0cfe2eeb820a",
            "created_at": "2022-10-25T16:07:24.061767Z",
            "updated_at": "2025-03-27T02:02:10.094583Z",
            "deleted_at": null,
            "main_name": "Platinum",
            "aliases": [
                "ATK 33",
                "Operation EasternRoppels",
                "TwoForOne"
            ],
            "source_name": "ETDA:Platinum",
            "tools": [
                "AMTsol",
                "Adupib",
                "Adupihan",
                "Dipsind",
                "DvDupdate.dll",
                "JPIN",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "RedPepper",
                "RedSalt",
                "Titanium",
                "adbupd",
                "psinstrc.ps1"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "256a6a2d-e8a2-4497-b399-628a7fad4b3e",
            "created_at": "2023-11-30T02:00:07.299845Z",
            "updated_at": "2025-03-27T02:00:03.257794Z",
            "deleted_at": null,
            "main_name": "WildCard",
            "aliases": [],
            "source_name": "MISPGALAXY:WildCard",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673535871,
    "ts_updated_at": 1743041799,
    "ts_creation_date": 1653705385,
    "ts_modification_date": 1653705385,
    "files": {
        "pdf": "https://archive.orkl.eu/55271eb05dcadd3d2060eb1b464df0ca80d88ff6.pdf",
        "text": "https://archive.orkl.eu/55271eb05dcadd3d2060eb1b464df0ca80d88ff6.txt",
        "img": "https://archive.orkl.eu/55271eb05dcadd3d2060eb1b464df0ca80d88ff6.jpg"
    }
}