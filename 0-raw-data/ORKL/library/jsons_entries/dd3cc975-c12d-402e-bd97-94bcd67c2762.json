{
    "id": "dd3cc975-c12d-402e-bd97-94bcd67c2762",
    "created_at": "2023-01-12T15:04:28.162784Z",
    "updated_at": "2025-03-27T02:06:14.004251Z",
    "deleted_at": null,
    "sha1_hash": "12d5866ebe132796ef263752e5b27a9f901fb23e",
    "title": "2017-08-09 - The return of Mamba ransomware",
    "authors": "",
    "file_creation_date": "2022-05-28T03:24:57Z",
    "file_modification_date": "2022-05-28T03:24:57Z",
    "file_size": 1114216,
    "plain_text": "# The return of Mamba ransomware\n\n**securelist.com/the-return-of-mamba-ransomware/79403/**\n\n[Malware descriptions](https://securelist.com/category/malware-descriptions/)\n\n[Malware descriptions](https://securelist.com/category/malware-descriptions/)\n\n09 Aug 2017\n\nminute read\n\n\n-----\n\nAuthors\n\nAnton Ivanov\n\n[Orkhan Mamedov](https://securelist.com/author/orkhanmamedov/)\n\nAt the end of 2016, there was a major attack against San Francisco’s Municipal\nTransportation Agency. The attack was done using Mamba ransomware. This ransomware\nuses a legitimate utility called DiskCryptor for full disk encryption. This month, we noted that\nthe group behind this ransomware has resumed their attacks against corporations.\n\n\n-----\n\n## Attack Geography\n\nWe are currently observing attacks against corporations that are located in:\n\nBrazil\nSaudi Arabia\n\n## Attack Vector\n\n\n-----\n\nAs usual, this group gains access to an organization s network and uses the psexec utility to\nexecute the ransomware. Also, it is important to mention that for each machine in the victim’s\nnetwork, the threat executor generates a password for the DiskCryptor utility. This password\nis passed via command line arguments to the ransomware dropper.\n\nExample of malware execution\n\n## Technical Analysis\n\nIn a nutshell, the malicious activity can be separated into two stages:\n\nStage 1 (Preparation):\n\nCreate folder “C:\\xampp\\http“\nDrop DiskCryptor components into the folder\nInstall DiskCryptor driver\nRegister system service called DefragmentService\nReboot victim machine\n\nStage 2 (Encryption):\n\nSetup bootloader to MBR and encrypt disk partitions using DiskCryptor software\nClean up\nReboot victim machine\n\n**Stage 1 (Preparation)**\n\nAs the trojan uses the DiskCryptor utility, the first stage deals with installing this tool on a\nvictim machine. The malicious dropper stores DiskCryptor’s modules in their own resources.\n\nDiskCryptor modules\n\n\n-----\n\nDepending on OS information, the malware is able to choose between 32- or 64-bit\nDiskCryptor modules. The necessary modules will be dropped into the “C:\\xampp\\http”\nfolder.\n\nThe malware drops the necessary modules\n\nAfter that, it launches the dropped DiskCryptor installer.\n\nThe call of the DiskCryptor installer\n\nWhen DiskCryptor is installed, the malware creates a service that has\nSERVICE_ALL_ACCESS and SERVICE_AUTO_START parameters.\n\n\n-----\n\nThe creation of the malicious service’s function\n\nThe last step of Stage 1 is to reboot the system.\n\n\n-----\n\nForce reboot function\n\n**Stage 2 (Encryption)**\n\nUsing the DiskCryptor software, the malware sets up a new bootloader to MBR.\n\nThe call for setting up a bootloader to MBR\n\nThe bootloader contains the ransom message for the victim.\n\n\n-----\n\nRansomware note\n\nAfter the bootloader is set, disk partitions would be encrypted using a password, previously\nspecified as a command line argument for the dropper.\n\nThe call tree of encryption processes\n\nWhen the encryption ends, the system will be rebooted, and a victim will see a ransom note\non the screen.\n\nRansom notes\n\n\n-----\n\nKaspersky Lab products detect this threat with the help of the System Watcher component\nwith the following verdict: PDM:Trojan.Win32.Generic.\n\n## Decryption\n\nUnfortunately, there is no way to decrypt data that has been encrypted using the DiskCryptor\nutility because this legitimate utility uses strong encryption algorithms.\n\n## IOCs:\n\n79ED93DF3BEC7CD95CE60E6EE35F46A1\n\n[Encryption](https://securelist.com/tag/encryption/)\n[Malware Descriptions](https://securelist.com/tag/malware-descriptions/)\n[Malware Technologies](https://securelist.com/tag/malware-technologies/)\n[MBR](https://securelist.com/tag/mbr/)\n[Ransomware](https://securelist.com/tag/ransomware/)\n[Targeted attacks](https://securelist.com/tag/targeted-attacks/)\n\nAuthors\n\nAnton Ivanov\n\n[Orkhan Mamedov](https://securelist.com/author/orkhanmamedov/)\n\nThe return of Mamba ransomware\n\nYour email address will not be published. Required fields are marked *\n\nGReAT webinars\n\n13 May 2021, 1:00pm\n\n### GReAT Ideas. Balalaika Edition\n\nFrom the same authors\n\n\n-----\n\n### Sodin ransomware exploits Windows vulnerability and processor architecture\n\n KeyPass ransomware\n\n\n-----\n\n### SynAck targeted ransomware uses the Doppelgänging technique\n\n Mining is the new black\n\n\n-----\n\n### Bad Rabbit ransomware\n\nSubscribe to our weekly e-mails\n\nThe hottest research right in your inbox\n\n\n-----\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2017/2017-08-09 - The return of Mamba ransomware.pdf"
    ],
    "report_names": [
        "2017-08-09 - The return of Mamba ransomware.pdf"
    ],
    "threat_actors": [
        {
            "id": "4d9cdc7f-72d6-4e17-89d8-f6323bfcaebb",
            "created_at": "2023-01-06T13:46:38.82716Z",
            "updated_at": "2025-03-27T02:00:02.928984Z",
            "deleted_at": null,
            "main_name": "GreyEnergy",
            "aliases": [],
            "source_name": "MISPGALAXY:GreyEnergy",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673535868,
    "ts_updated_at": 1743041174,
    "ts_creation_date": 1653708297,
    "ts_modification_date": 1653708297,
    "files": {
        "pdf": "https://archive.orkl.eu/12d5866ebe132796ef263752e5b27a9f901fb23e.pdf",
        "text": "https://archive.orkl.eu/12d5866ebe132796ef263752e5b27a9f901fb23e.txt",
        "img": "https://archive.orkl.eu/12d5866ebe132796ef263752e5b27a9f901fb23e.jpg"
    }
}