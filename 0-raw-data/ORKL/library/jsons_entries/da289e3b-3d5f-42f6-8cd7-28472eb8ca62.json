{
    "id": "da289e3b-3d5f-42f6-8cd7-28472eb8ca62",
    "created_at": "2023-01-12T15:00:48.396238Z",
    "updated_at": "2025-03-27T02:17:02.261381Z",
    "deleted_at": null,
    "sha1_hash": "c3e95b98a42aea55c27c8407bc456e7c685738f9",
    "title": "2020-11-16 - ELF_PLEAD - Linux Malware Used by BlackTech",
    "authors": "",
    "file_creation_date": "2022-05-28T23:44:59Z",
    "file_modification_date": "2022-05-28T23:44:59Z",
    "file_size": 842831,
    "plain_text": "# JPCERT Coordination Center official Blog\n\n**blogs.jpcert.or.jp/en/2020/11/elf-plead.html**\n\n朝長 [秀誠 (Shusei Tomonaga)](https://blogs.jpcert.or.jp/en/shu_tom/)\n\nNovember 16, 2020\n\n## ELF_PLEAD - Linux Malware Used by BlackTech\n\n[BlackTech](https://blogs.jpcert.or.jp/en/tags/blacktech/)\n\n[Email](http://10.10.0.46/mailto:?subject=ELF_PLEAD%20-%20Linux%20Malware%20Used%20by%20BlackTech&body=https%3A%2F%2Fblogs.jpcert.or.jp%2Fen%2F2020%2F11%2Felf-plead.html)\n\n[In a past article, we introduced Linux malware ELF_TSCookie, which is used by an attack](https://blogs.jpcert.or.jp/en/2020/03/elf-tscookie.html)\ngroup BlackTech. This group also uses other kinds of malware that affects Linux OS. PLEAD\nmodule for Windows which we introduced before has its Linux version (ELF_PLEAD) as well.\n[This article describe the details of ELF_PLEAD in comparison to PLEAD module.](https://blogs.jpcert.or.jp/en/2018/05/linopid.html)\n\n### Comparison between PLEAD Module and ELF_PLEAD\n\nELF_PLEAD and PLEAD module share many parts of the code, and most of the functions\nincluding communication are similar. Figure 1 shows the comparison of the main functions of\nPLEAD module and ELF_PLEAD.\n\nFigure 1: Code\n\ncomparison of PLEAD module and ELF_PLEAD\n\n(Left: PLEAD module / Right: ELF_PLEAD)\nIt is clear from the flow of processing that the two types of malware are quite similar. The\nnext sections will describe the features of ELF PLEAD from the following perspectives:\n\n\n-----\n\nConfiguration\nCommunication protocol\nCommands\n\n### Configuration\n\nELF_PLEAD possesses its configuration with the size of 0x1AA. Figure 2 is an example of\nconfiguration. It contains information such as C&C servers and an encryption key. (Please\nsee Appendix A for the details of configuration.)\n\nFigure 2:\n\nConfiguration example\nThe configuration is RC4-encrypted, and the 32-byte string right before the encrypted\nconfiguration is the encryption key itself. Figure 3 is an example of encrypted configuration\nand its key.\n\n\n-----\n\nFigure 3: Encrypted\n\nconfiguration and encryption key\n\n### Communication protocol\n\nWhile PLEAD module uses HTTP protocol to communicate with its C&C servers,\nELF_PLEAD uses its custom protocol. Besides the difference, the data format and the\nmethod for exchanging the encryption key are almost the same. Figure 4 describes the flow\nof communication that ELF_PLEAD performs.\n\nFigure 4:\n\nCommunication flow of ELF_PLEAD\nELF_PLEAD exchanges a part of RC4 key at the time of first communication. After that, a\nRC4 key generated by the exchange will be used for the communication that follows. The\ndata sent is RC4-encrypted and then LZO-compressed. (Please see Appendix B for the\ndetails of communication protocol.)\n\n\n-----\n\n### Commands\n\nELF_PLEAD is equipped with 5 command groups as follows. (Please see Appendix C for the\ndetails of command functions. The command number may vary in some samples.)\n\nCFileManager (group number 0): commands for operation on files\nCFileTransfer (group number 1): commands for sending/receiving files\nCRemoteShell (group number 2): commands for remote shell\nCPortForwardManager (group number 3): commands for proxy mode\nNo name (group number 0xFF): commands for malware control\n\nFigure 5: Command\n\ngroup names\nIt is clear that the functions are almost the same as [PLEAD module.](https://blogs.jpcert.or.jp/en/2018/06/plead-downloader-used-by-blacktech.html)\n\n### In closing\n\nIt has been confirmed that BlackTech uses different kinds of malware including TSCookie,\nPLEAD and KIVARS, which target Linux OS as well as Windows OS. If such malware is\nfound in your Windows environment, it is recommended to check your Linux environment as\nwell.\n\nShusei Tomonaga\n\n(Translated by Yukako Uchida)\n\n**Appendix A: ELF_PLEAD Configuration**\n\nTable A: Configuration\n\n\n-----\n\nOffset Description Remarks\n\n0x000 RC4 Key Used for encrypting communication\n\n0x004 ID\n\n0x024 Port number 1\n\n0x026 Port number 2\n\n0x028 Port number 3\n\n0x02A C&C server 1\n\n0x0AA C&C server 2\n\n0x12A C&C server 3\n\nConfiguration format may vary in some samples.\n\n**Appendix B: Contents of data exchanged**\n\nTable B-1: Format of sent data\n\nOffset Length Contents\n\n0x00 4 RC4 Key (Key4)\n\n0x04 4 Hash value\n\n0x08 4 RC4 key (Key1)\n\n0x0C 2 Length of data sent\n\n0x0E 2 Length of data at offset 0x10 before compression\n\n0x10 - Encrypted data (RC4 +LZO) (See Table A-2 for details.)\n\nTable B-2: Format of encrypted data\n\nOffset Length Contents\n\n0x00 2 0xFF\n\n0x02 4 RC4 key (Key2)\n\n0x06 - Random data (at least 128 bytes)\n\nTable B-3: Format of received data\n\n\n-----\n\nOffset Length Contents\n\n0x00 4 RC4 key (Key4)\n\n0x04 4 Hash value\n\n0x08 4 RC4 key (Key1)\n\n0x0C 2 Length of data sent\n\n0x0E 2 Length of data at offset 0x10 before compression\n\n0x10 - Encrypted data (RC4 +LZO) (See Table A-4 for details.)\n\nTable B-4: Format of encrypted data in the received data\n\nOffset Length Contents\n\n0x00 2 0x01FF\n\n0x02 4 RC4 key (Key3)\n\n**Appendix C: ELF_PLEAD commands**\n\nTable C-1: Commands without group name (group number 0xFF)\n\nValue Contents\n\n4 Send random data\n\n5 Reconnect\n\n6 Restart\n\n7 End\n\n8 End\n\n9 Change socket\n\n11 Change C2 server\n\nTable C-2: Commands for CFileManager (group number 0)\n\nValue Contents\n\n32 Send list of files\n\n37 Send file size, mode, timestamp\n\n\n-----\n\n39 Change file name\n\n41 Delete file/directory\n\n43 Upload file\n\n45 Execute file\n\n49 Create directory\n\n51 Move file\n\n53 Delete directory\n\nTable C-3: Commands for CFileTransfer (group number 1)\n\nValue Contents\n\n64 Send file/directory information\n\n67 Create directory\n\n70 Download file\n\n71 Send file information\n\n75 Upload file\n\nTable C-4: Commands for CRemoteShell (group number 2)\n\nValue Contents\n\n80 Launch remote shell\n\nTable C-5: Commands for CPortForwardManager (group number 3)\n\nValue Contents\n\n96 Set up proxy\n\n100 Connect proxy\n\n102 Send proxy data\n\n104 \n106 \n108 End proxy\n\n\n-----\n\n**Appendix D: C&C server**\n\nmx.msdtc.tw\n\n**Appendix E: Malware hash value**\n\n5b5f8c4611510c11d413cb2bef70867e584f003210968f97e0c54e6d37ba8d8d\nca0e83440b77eca4d2eda6efd9530b49ffb477f87f36637b5e43f2e428898766\n\n[Email](http://10.10.0.46/mailto:?subject=ELF_PLEAD%20-%20Linux%20Malware%20Used%20by%20BlackTech&body=https%3A%2F%2Fblogs.jpcert.or.jp%2Fen%2F2020%2F11%2Felf-plead.html)\n\nAuthor\n\n朝長 [秀誠 (Shusei Tomonaga)](https://blogs.jpcert.or.jp/en/shu_tom/)\n\nSince December 2012, he has been engaged in malware analysis and forensics\ninvestigation, and is especially involved in analyzing incidents of targeted attacks. Prior to\njoining JPCERT/CC, he was engaged in security monitoring and analysis operations at a\nforeign-affiliated IT vendor. He presented at CODE BLUE, BsidesLV, BlackHat USA Arsenal,\nBotconf, PacSec and FIRST Conference. JSAC organizer.\n\nWas this page helpful?\n\n0 people found this content helpful.\n\nIf you wish to make comments or ask questions, please use this form.\n\nThis form is for comments and inquiries. For any questions regarding specific commercial\nproducts, please contact the vendor.\n\nplease change the setting of your browser to set JavaScript valid. Thank you!\n\n## Related articles\n\nAnalysis of HUI Loader\n\n\n-----\n\nAnti-UPX Unpacking Technique\n\nFAQ: Malware that Targets Mobile Devices and How to Protect Them\n\nMalware WinDealer used by LuoYu Attack Group\n\nMalware Gh0stTimes Used by BlackTech\n\n\n[Back](https://blogs.jpcert.or.jp/en/2020/10/logontracer-1-5.html)\n[Top](https://blogs.jpcert.or.jp/en/)\n[Next](https://blogs.jpcert.or.jp/en/2020/12/cna-2cna.html)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2020/2020-11-16 - ELF_PLEAD - Linux Malware Used by BlackTech.pdf"
    ],
    "report_names": [
        "2020-11-16 - ELF_PLEAD - Linux Malware Used by BlackTech.pdf"
    ],
    "threat_actors": [
        {
            "id": "ce10c1bd-4467-45f9-af83-28fc88e35ca4",
            "created_at": "2022-10-25T15:50:23.458833Z",
            "updated_at": "2025-03-27T02:00:55.475188Z",
            "deleted_at": null,
            "main_name": "APT34",
            "aliases": null,
            "source_name": "MITRE:APT34",
            "tools": [
                "netstat",
                "Systeminfo",
                "PsExec",
                "SEASHARPEE",
                "Tasklist",
                "Mimikatz",
                "POWRUNER",
                "certutil"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "2646f776-792a-4498-967b-ec0d3498fdf1",
            "created_at": "2022-10-25T15:50:23.475784Z",
            "updated_at": "2025-03-27T02:00:55.479958Z",
            "deleted_at": null,
            "main_name": "BlackTech",
            "aliases": [
                "BlackTech",
                "Palmerworm"
            ],
            "source_name": "MITRE:BlackTech",
            "tools": [
                "Kivars",
                "PsExec",
                "TSCookie",
                "Flagpro",
                "Waterbear"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "d3a7123c-f519-49a0-a234-de24a1ef052a",
            "created_at": "2022-10-25T16:47:55.545211Z",
            "updated_at": "2025-03-27T02:05:17.254744Z",
            "deleted_at": null,
            "main_name": "BRONZE CANAL",
            "aliases": [
                "CTG-6177 ",
                "Circuit Panda ",
                "Palmerworm ",
                "Shrouded Crossbow ",
                "BlackTech"
            ],
            "source_name": "Secureworks:BRONZE CANAL",
            "tools": [
                " DRIGO",
                " Flagpro",
                " Gh0stTimes",
                " PLEAD",
                " Spiderpig",
                " Waterbear",
                "Bifrose"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "75024aad-424b-449a-b286-352fe9226bcb",
            "created_at": "2023-01-06T13:46:38.962724Z",
            "updated_at": "2025-03-27T02:00:02.964002Z",
            "deleted_at": null,
            "main_name": "BlackTech",
            "aliases": [
                "CIRCUIT PANDA",
                "Temp.Overboard",
                "G0098",
                "Red Djinn",
                "HUAPI",
                "Palmerworm",
                "T-APT-03",
                "Manga Taurus",
                "Earth Hundun"
            ],
            "source_name": "MISPGALAXY:BlackTech",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "cffb3c01-038f-4527-9cfd-57ad5a035c22",
            "created_at": "2022-10-25T15:50:23.38055Z",
            "updated_at": "2025-03-27T02:00:55.459558Z",
            "deleted_at": null,
            "main_name": "OilRig",
            "aliases": [
                "COBALT GYPSY",
                "IRN2",
                "APT34",
                "Helix Kitten",
                "Evasive Serpens",
                "Hazel Sandstorm",
                "EUROPIUM",
                "ITG13"
            ],
            "source_name": "MITRE:OilRig",
            "tools": [
                "ISMInjector",
                "RDAT",
                "Systeminfo",
                "QUADAGENT",
                "OopsIE",
                "Tasklist",
                "certutil",
                "ZeroCleare",
                "POWRUNER",
                "netstat",
                "ipconfig",
                "LaZagne",
                "BONDUPDATER",
                "SideTwist",
                "PsExec",
                "SEASHARPEE",
                "Mimikatz",
                "RGDoor",
                "ftp"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "efa7c047-b61c-4598-96d5-e00d01dec96b",
            "created_at": "2022-10-25T16:07:23.404442Z",
            "updated_at": "2025-03-27T02:02:09.781478Z",
            "deleted_at": null,
            "main_name": "BlackTech",
            "aliases": [
                "BlackTech",
                "Circuit Panda",
                "Earth Hundun",
                "Manga Taurus",
                "Operation PLEAD",
                "Operation Shrouded Crossbow",
                "Operation Waterbear",
                "Palmerworm",
                "Radio Panda",
                "Red Djinn",
                "T-APT-03",
                "TEMP.Overboard"
            ],
            "source_name": "ETDA:BlackTech",
            "tools": [
                "BIFROST",
                "BUSYICE",
                "BendyBear",
                "Bluether",
                "CAPGELD",
                "DRIGO",
                "Deuterbear",
                "Flagpro",
                "GOODTIMES",
                "Gh0stTimes",
                "IconDown",
                "KIVARS",
                "LOLBAS",
                "LOLBins",
                "Linopid",
                "Living off the Land",
                "TSCookie",
                "Waterbear",
                "XBOW",
                "elf.bifrose"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "67709937-2186-4a32-b64c-a5693d40ac77",
            "created_at": "2023-01-06T13:46:38.495593Z",
            "updated_at": "2025-03-27T02:00:02.848206Z",
            "deleted_at": null,
            "main_name": "OilRig",
            "aliases": [
                "IRN2",
                "Hazel Sandstorm",
                "EUROPIUM",
                "TA452",
                "Earth Simnavaz",
                "Cobalt Gypsy",
                "Crambus",
                "Helix Kitten",
                "APT 34",
                "APT34",
                "ATK40",
                "G0049",
                "Evasive Serpens",
                "Twisted Kitten"
            ],
            "source_name": "MISPGALAXY:OilRig",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "b72c2616-cc7c-4c47-a83d-6b7866b94746",
            "created_at": "2023-01-06T13:46:39.425297Z",
            "updated_at": "2025-03-27T02:00:03.08718Z",
            "deleted_at": null,
            "main_name": "Red Nue",
            "aliases": [
                "LuoYu"
            ],
            "source_name": "MISPGALAXY:Red Nue",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673535648,
    "ts_updated_at": 1743041822,
    "ts_creation_date": 1653781499,
    "ts_modification_date": 1653781499,
    "files": {
        "pdf": "https://archive.orkl.eu/c3e95b98a42aea55c27c8407bc456e7c685738f9.pdf",
        "text": "https://archive.orkl.eu/c3e95b98a42aea55c27c8407bc456e7c685738f9.txt",
        "img": "https://archive.orkl.eu/c3e95b98a42aea55c27c8407bc456e7c685738f9.jpg"
    }
}