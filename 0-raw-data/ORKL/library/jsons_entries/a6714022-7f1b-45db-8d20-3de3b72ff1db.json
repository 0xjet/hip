{
    "id": "a6714022-7f1b-45db-8d20-3de3b72ff1db",
    "created_at": "2023-01-12T15:02:51.252882Z",
    "updated_at": "2025-03-27T02:16:26.071854Z",
    "deleted_at": null,
    "sha1_hash": "34195abebdcb1b1cc09870d1120852809ccb90d2",
    "title": "2021-04-07 - New Wormable Android Malware Spreads by Creating Auto-Replies to Messages in WhatsApp",
    "authors": "",
    "file_creation_date": "2022-05-28T02:34:44Z",
    "file_modification_date": "2022-05-28T02:34:44Z",
    "file_size": 1522387,
    "plain_text": "# New Wormable Android Malware Spreads by Creating Auto-Replies to Messages in WhatsApp\n\n**research.checkpoint.com/2021/new-wormable-android-malware-spreads-by-creating-auto-replies-to-messages-in-**\nwhatsapp/\n\nApril 7, 2021\n\nApril 7, 2021\nResearch by: Aviran Hazum, Bodgan Melnykov & Israel Wenik\n\n## Overview\n\nCheck Point Research (CPR) recently discovered malware on Google Play hidden in a fake\napplication that is capable of spreading itself via users’ WhatsApp messages. If the user\ndownloaded the fake application and unwittingly granted the malware the appropriate\npermissions, the malware is capable of automatically replying to victim’s’ incoming WhatsApp\nmessages with a payload received from a command-and-control (C&C) server. This unique\nmethod could have enabled threat actors to distribute phishing attacks, spread false\ninformation or steal credentials and data from users’ WhatsApp accounts, and more.\n\n## General\n\nAs the mobile threat landscape evolves, threat actors are always seeking to develop new\ntechniques to evolve and successfully distribute malware. In this specific campaign, Check\nPoint’s researchers discovered a new and innovative malicious threat on the Google Play\n\n\n-----\n\napp store which spreads itself via mobile users WhatsApp conversations, and can also send\nfurther malicious content via automated replies to incoming WhatsApp messages.\n\nResearchers found the malware hidden within an app on Google Play called ’FlixOnline.’”\nThe app is a fake service that claims to allow users to view Netflix content from all around\nthe world on their mobiles. However, instead of allowing the mobile user to view Netflix\ncontent, the application is actually designed to monitor the user’s WhatsApp notifications,\nand to send automatic replies to the user’s incoming messages using content that it receives\nfrom a remote command and control (C&C) server.\n\nThe malware sends the following response to its victims, luring them with the offer of a free\nNetflix service:\n\n“2 Months of Netflix Premium Free at no cost For REASON OF QUARANTINE (CORONA\nVIRUS)* Get 2 Months of Netflix Premium Free anywhere in the world for 60 days. Get it now\nHERE https://bit[.]ly/3bDmzUw.”\n\nUtilizing this technique, a threat actor could perform a wide range of malicious activities:\n\nSpread further malware via malicious links\nStealing data from users’ WhatsApp accounts\nSpreading fake or malicious messages to users’ WhatsApp contacts and groups (for\nexample, work-related groups)\nExtort users by threatening to send sensitive WhatsApp data or conversations to all of\ntheir contacts\n\n\n-----\n\n_Figure 1 – FlixOnline application on Google Play_\n\n## Technical Analysis\n\nWhen the application is downloaded from the Play Store and installed, the malware starts a\nservice that requests ‘Overlay’, ‘Battery Optimization Ignore’, and ‘Notification’ permissions.\nThe purpose behind obtaining these permissions is:\n\nOverlay allows a malicious application to create new windows on top of other\napplications. This is usually requested by malware to create a fake “Login” screen for\nother apps, with the aim of stealing victim’s credentials.\nIgnore Battery Optimizations stops the malware from being shut down by the device’s\nbattery optimization routine, even after it is idle for an extended period.\nThe most prominent permission is the Notification access, more specifically, the\nNotification Listener service. Once enabled, this permission provides the malware with\naccess to all notifications related to messages sent to the device, and the ability to\nautomatically perform designated actions such as “dismiss” and “reply” to messages\nreceived on the device.\n\n\n-----\n\n-----\n\n_Figure 2 – FlixOnline Permissions Request_\n\nAfter the permissions are granted, the malware displays a landing page it receives from the\nC&C server and immediately hides its icon so the malware can’t be easily removed. This is\ndone by a service that periodically contacts the C&C and updates the malware’s\nconfiguration accordingly.\nThe service can achieve these goals by using multiple methods. For instance, the service\ncan be triggered by the installation of the application and by an Alarm registered I the\nBOOT_COMPLETED action, which is called after the device has completed the boot\nprocess.\n\n_Figures 3 & 4 – Service registration, BOOT_COMPLETE_\n\nThe response from the C&C contains a configuration with the following field:\n\n**Field** **Purpose**\n\nlanding_page A URL to display to the victim after permission granting.\n\nmessage_inbox The message to send as a reply to all incoming messages.\n\nmessage_limit Unused, potentially could indicate as an “upper limit” for the amount of\nmessages to send out.\n\ndelay Unused.\n\nurl Unused.\n\ndelay_browser Delay before showing popup with specific URL.\n\n\n-----\n\nenable_browser C&C check flag.\n\nenable_webview Indicates which app to use to open the URL.\n\nwebview_url The URL for the WebView popup activity.\n\nbrowser_url URL for the browser popup.\n\n_Figure 5 – Contact C&C and configuration parsing_\n\nOnce this is complete, the malware has everything needed to distribute the payload. With the\nOnNotificationPosted callback, the malware checks for the package name of the originated\napplication, and if that application is WhatsApp, it will process the notification.\n\n_Figure 5 – Check for WhatsApp notifications_\n\nFirst, the malware cancels the notification to hide it from the user and reads the title and\ncontent of the notification received. Next, it searches for the component that is responsible\nfor inline replies, which is used to send out the reply using the payload received from the\nC&C server.\n\n\n-----\n\n_Figure 6 – Notification processing_\n\n_Figure 7 – Searching for inline-reply component_\n\n\n-----\n\n_Figure 8 – Sending out the reply_\n\n## Responsible disclosure\n\nCheck Point Research responsibly notified Google about the malicious application and the\ndetails of its research, and Google quickly removed the application from the Play Store. Over\nthe course of 2 months, the “FlixOnline” app was downloaded approximately 500 times.\n\n## Conclusion\n\nThis wormable Android malware features innovative and dangerous new techniques for\nspreading itself, and for manipulating or stealing data from trusted applications such as\nWhatsApp. It highlights that users should be wary of download links or attachments that they\nreceive via WhatsApp or other messaging apps, even when they appear to come from\ntrusted contacts or messaging groups.\n\n**If a user was infected, they should remove the application from their device, and**\n**change their passwords.**\n\n## Stay protected from mobile threats\n\n[Check Point Harmony Mobile is the](https://www.checkpoint.com/products/mobile-security/) [market-leading Mobile Threat Defense (MTD) solution,](https://pages.checkpoint.com/2019-miercom-mobile-threat-defense-report.html)\nproviding the widest range of capabilities to help you secure your mobile workforce.\n\nHarmony Mobile provides protection for all mobile vectors of attack, including the download\nof malicious applications and applications with malware embedded in them.\n\n[Learn more.](https://www.checkpoint.com/products/mobile-security)\n\n## Appendix 1 – IOCs\n\nFlixOnline – 1d097436927f85b1ab9bf69913071abd0845bfcf1afa186112e91e1ca22e32df\n\nC&C – netflixwatch[.]site\n\n\n-----\n\nPackage Name – com.fab.wflixonline\n\nCertificate – BEC2C0448558729C1EDF4E45AB76B6A3EE6E42B7\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-04-07 - New Wormable Android Malware Spreads by Creating Auto-Replies to Messages in WhatsApp.pdf"
    ],
    "report_names": [
        "2021-04-07 - New Wormable Android Malware Spreads by Creating Auto-Replies to Messages in WhatsApp.pdf"
    ],
    "threat_actors": [
        {
            "id": "75108fc1-7f6a-450e-b024-10284f3f62bb",
            "created_at": "2024-11-01T02:00:52.756877Z",
            "updated_at": "2025-03-27T02:00:55.544216Z",
            "deleted_at": null,
            "main_name": "Play",
            "aliases": null,
            "source_name": "MITRE:Play",
            "tools": [
                "Nltest",
                "AdFind",
                "PsExec",
                "Wevtutil",
                "Cobalt Strike",
                "Playcrypt",
                "Mimikatz"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1673535771,
    "ts_updated_at": 1743041786,
    "ts_creation_date": 1653705284,
    "ts_modification_date": 1653705284,
    "files": {
        "pdf": "https://archive.orkl.eu/34195abebdcb1b1cc09870d1120852809ccb90d2.pdf",
        "text": "https://archive.orkl.eu/34195abebdcb1b1cc09870d1120852809ccb90d2.txt",
        "img": "https://archive.orkl.eu/34195abebdcb1b1cc09870d1120852809ccb90d2.jpg"
    }
}