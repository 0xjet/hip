{
    "id": "5d85a0b0-aab0-4fc3-8887-a25f0ea3a794",
    "created_at": "2023-01-12T15:00:09.315961Z",
    "updated_at": "2025-03-27T02:05:47.962137Z",
    "deleted_at": null,
    "sha1_hash": "f0ec116c6db302478318048f86aa3427e724372b",
    "title": "2021-09-20 - A guide to combatting human-operated ransomware- Part 1",
    "authors": "",
    "file_creation_date": "2022-05-27T23:12:30Z",
    "file_modification_date": "2022-05-27T23:12:30Z",
    "file_size": 989331,
    "plain_text": "# A guide to combatting human-operated ransomware: Part 1\n\n**[microsoft.com/security/blog/2021/09/20/a-guide-to-combatting-human-operated-ransomware-part-1/](https://www.microsoft.com/security/blog/2021/09/20/a-guide-to-combatting-human-operated-ransomware-part-1/)**\n\nSeptember 20, 2021\n\n_This blog is part one of a two-part series focused on how Microsoft DART helps customers_\n_with human-operated ransomware. For more guidance on human-operated ransomware and_\n_how to defend against these extortion-based attacks, refer to our human-operated_\n_ransomware docs page._\n\nMicrosoft’s Detection and Response Team (DART) has helped customers of all sizes, across\nmany industries and regions, investigate and remediate human-operated ransomware for\nover five years. This blog aims to explain the process and execution used in our customer\nengagements to provide perspective on the unique issues and challenges regarding humanoperated ransomware. We will also discuss how DART leverages Microsoft solutions such as\n[Microsoft Defender for Endpoint,](https://www.microsoft.com/en-us/security/business/threat-protection/endpoint-defender) [Microsoft Defender for Identity, and](https://www.microsoft.com/en-us/security/business/threat-protection/identity-defender) Microsoft Cloud App\nSecurity (MCAS) within customer environments while collaborating with cross-functional\nthreat intelligence teams across Microsoft who similarly track human-operated ransomware\nactivities and behaviors.\n\nHuman-operated ransomware is not a malicious software problem—it’s a human criminal\nproblem. The solutions used to address commodity problems aren’t enough to prevent a\nthreat that more closely resembles a nation-state threat actor. It disables or uninstalls your\nantivirus software before encrypting files. They locate and corrupt or delete backups before\nsending a ransom demand. These actions are commonly done with legitimate programs that\nyou might already have in your environment and are not considered malicious. In criminal\nhands, these tools are used maliciously to carry out attacks.\n\n\n-----\n\nResponding to the increasing threat of ransomware requires a combination of modern\nenterprise configuration, up-to-date security products, and the vigilance of trained security\nstaff to detect and respond to the threats before data is lost.\n\n## Key steps in DART’s approach to conducting ransomware incident investigations\n\nTo maximize DART’s efforts to restore business continuity while simultaneously analyzing the\ndetails of the incident, a careful and thorough investigation is coordinated with remediation\nmeasures to ensure that the root cause is determined. These efforts take place as we assist\nand advise customers with the task of getting the organization up and running again in a\nsecure manner.\n\nEvery effort is made to determine how the adversary gained access to the customer’s assets\nso that vulnerabilities can be remediated. Otherwise, it is highly likely that the same type of\nattack will take place again in the future. In some cases, the threat actor takes steps to\n“cover their tracks” and destroy evidence, so it is possible that the entire chain of events may\nnot be evident.\n\nThe following are three key steps in our ransomware investigations:\n\n_Figure 1. Key steps in DART’s ransomware investigations._\n\n### 1. Assess the current situation\n\n\n-----\n\nThis is critical to understanding the scope of the incident and for determining the best people\nto assist and to plan and scope the investigation and remediation tasks. Asking these initial\nquestions is crucial in helping us determine the situation being dealt with:\n\n**What initially made you aware of the ransomware attack?**\n\nIf the initial threat was identified by IT staff (like noticing backups being deleted, antivirus\n(AV) alert, endpoint detection and response (EDR) alert, suspicious system changes), it is\noften possible to take quick decisive measures to thwart the attack, typically by disabling all\ninbound and outbound internet communication. This may temporarily affect business\noperations, but that would typically be much less impactful than an adversary deploying\nransomware.\n\nIf the threat was identified by a user call to the IT helpdesk, there may be enough advance\nwarning to take defensive measures to prevent or minimize the effects of the attack. If the\nthreat was identified by an external entity (like law enforcement or a financial institution), it is\nlikely that the damage is already done, and you will see evidence in your environment that\nthe threat actor has already gained administrative control of your network. This can range\nfrom ransomware notes, locked screens, or ransom demands.\n\n**What date/time did you first learn of the incident?**\n\nEstablishing the initial activity date and time is important because it helps narrow the scope\nof the initial triage for “quick wins.” Additional questions may include:\n\nWhat updates were missing on that date? This is important to understand what\nvulnerabilities may have been exploited by the adversary.\nWhat accounts were used on that date?\nWhat new accounts have been created since that date?\n\n**What logs (such as AV, EDR, and VPN) are available, and is there any indication that**\n**the actor is currently accessing systems?**\n\nLogs are an indicator of suspected compromise. Follow-up questions may include:\n\n[Are logs being aggregated in a SIEM (like Microsoft Azure Sentinel, Splunk, ArcSight)](https://azure.microsoft.com/en-us/services/azure-sentinel/?&ef_id=Cj0KCQjwkIGKBhCxARIsAINMioLe7kGz9jffae_vLywiHnitdZE4gN87awwT8GqSxP2kJ5_hGMu7bfsaAnMpEALw_wcB:G:s&OCID=AID2200277_SEM_Cj0KCQjwkIGKBhCxARIsAINMioLe7kGz9jffae_vLywiHnitdZE4gN87awwT8GqSxP2kJ5_hGMu7bfsaAnMpEALw_wcB:G:s&gclid=Cj0KCQjwkIGKBhCxARIsAINMioLe7kGz9jffae_vLywiHnitdZE4gN87awwT8GqSxP2kJ5_hGMu7bfsaAnMpEALw_wcB#overview)\nand current? What is the retention period of this data?\nAre there any suspected compromised systems that are experiencing unusual activity?\nAre there any suspected compromised accounts that appear to be actively used by the\nadversary?\nIs there any evidence of active command and controls (C2s) in EDR, Firewall, VPN,\nProxy, and other logs?\n\n\n-----\n\nAs part of assessing the current situation, DART may require a domain controller (DC) that\nwas not ransomed, a recent backup of a DC, or a recent DC taken offline for\n[maintenance/upgrades. We also ask our customers whether multifactor authentication (MFA)](https://www.microsoft.com/en-us/security/business/identity-access-management/mfa-multi-factor-authentication/?&ef_id=Cj0KCQjwkIGKBhCxARIsAINMioKehnOAgRRbPeOcI9bORrUwgb7LkrGi142e1zwjuplDaiZWnLJSnm0aAnbQEALw_wcB:G:s&OCID=AID2200938_SEM_Cj0KCQjwkIGKBhCxARIsAINMioKehnOAgRRbPeOcI9bORrUwgb7LkrGi142e1zwjuplDaiZWnLJSnm0aAnbQEALw_wcB:G:s&gclid=Cj0KCQjwkIGKBhCxARIsAINMioKehnOAgRRbPeOcI9bORrUwgb7LkrGi142e1zwjuplDaiZWnLJSnm0aAnbQEALw_wcB)\n[was required for everyone in the company and if Microsoft Azure Active Directory was used.](https://azure.microsoft.com/en-us/services/active-directory/?&ef_id=Cj0KCQjwkIGKBhCxARIsAINMioLZ_GSyl-lyuVFWW2SIkL-77U7LsMirDVPgDLLBJDxske2MjzviF7AaAk70EALw_wcB:G:s&OCID=AID2200277_SEM_Cj0KCQjwkIGKBhCxARIsAINMioLZ_GSyl-lyuVFWW2SIkL-77U7LsMirDVPgDLLBJDxske2MjzviF7AaAk70EALw_wcB:G:s&gclid=Cj0KCQjwkIGKBhCxARIsAINMioLZ_GSyl-lyuVFWW2SIkL-77U7LsMirDVPgDLLBJDxske2MjzviF7AaAk70EALw_wcB#overview)\n\n### 2. Identify line-of-business (LOB) apps that are unavailable due to the incident\n\nThis step is critical in figuring out the quickest way to get systems back online while obtaining\nthe evidence required.\n\n**Does the application require an identity?**\n\nHow is authentication performed?\nHow are credentials such as certificates or secrets stored and managed?\n\n**Are tested backups of the application, configuration, and data available?**\n\nAre the contents and integrity of backups regularly verified using a restore exercise? This is\nparticularly important after configuration management changes or version upgrades.\n\n### 3. Explain the compromise recovery (CR) process\n\nThis is a follow-up engagement that may be necessary if DART determines that the control\nplane (typically Active Directory) has been compromised.\n\nDART’s investigation always has a goal of providing output that feeds directly into the CR\nprocess. CR is the process by which we remove the nefarious attacker control from an\nenvironment and tactically increase security posture within a set period. CR takes place postsecurity breach. To learn more about CR, read the Microsoft Compromise Recovery Security\n[Practice team’s blog CRSP: The emergency team fighting cyber attacks beside customers.](https://www.microsoft.com/security/blog/2021/06/09/crsp-the-emergency-team-fighting-cyber-attacks-beside-customers/)\n\nOnce we have gathered the responses to the questions above, we can build a list of tasks\nand assign owners. A key factor in a successful incident response engagement is thorough,\ndetailed documentation of each work item (such as the owner, status, findings, date, and\ntime), making the compilation of findings at the end of the engagement a straightforward\nprocess.\n\n## How DART leverages Microsoft security solutions to combat human- operated ransomware\n\nDART leverages cross-functional teams, such as internal threat intelligence teams, who track\nadversary activities and behaviors, customer support, and product development teams\nbehind Microsoft products and services. DART also collaborates with other incident response\nvendors the customer may have engaged and will share findings whenever possible.\n\n\n-----\n\nDART relies heavily on data for all investigations. The team uses existing deployments of\nMicrosoft solutions, such as Defender for Endpoint, Defender for Identity, and MCAS within\ncustomer environments along with custom forensic data collection for additional analysis. If\nthese sensors are not deployed, DART also requests that the customer deploy these to gain\ndeeper visibility into the environment, correlate against threat intelligence sources, and\nenable our analysts to scale in speed and agility.\n\n### Microsoft Defender for Endpoint\n\nMicrosoft Defender for Endpoint is Microsoft’s enterprise endpoint security platform designed\nto help enterprise network security analysts prevent, detect, investigate, and respond to\nadvanced threats. As shown in the image below, Defender for Endpoint can detect attacks\nusing advanced behavioral analytics and machine learning. DART analysts use Defender for\nEndpoint for attacker behavioral analytics.\n\n_Figure 2. Sample alert in Microsoft Defender for Endpoint for a pass-the-ticket attack._\n\nDART analysts can also perform advanced hunting queries to pivot off indicators of\ncompromise (IOCs) or search for known behavior if a threat actor group is identified.\n\n\n-----\n\n_Figure 3. Advanced hunting queries to locate known attacker behavior._\n\nIn Defender for Endpoint, customers have access to a real-time expert-level monitoring and\nanalysis service by Microsoft Threat Experts for ongoing suspected actor activity. Customers\n[can also collaborate with experts on demand for additional insights into alerts and incidents.](https://docs.microsoft.com/en-us/microsoft-365/security/mtp/microsoft-threat-experts?view=o365-worldwide#collaborate-with-experts-on-demand)\n\n_Figure 4. Defender for Endpoint shows detailed ransomware activity._\n\n\n-----\n\n### Microsoft Defender for Identity\n\nDART leverages Microsoft Defender for Identity to investigate known compromised accounts\nand to find potentially compromised accounts in your organization. Defender for Identity\nsends alerts for known malicious activity that actors often use such as DCSync attacks,\nremote code execution attempts, and pass-the-hash attacks. Defender for Identity enables\nour team to pinpoint nefarious activity and accounts to narrow down our investigation.\n\n_Figure 5. Defender for Identity sends alerts for known malicious activity related to_\n_ransomware attacks._\n\n### Microsoft Cloud App Security\n\nMCAS allows DART analysts to detect unusual behavior across cloud apps to identify\nransomware, compromised users, or rogue applications. MCAS is Microsoft’s cloud access\nsecurity broker (CASB) solution that allows for monitoring of cloud services and data access\nin cloud services by users.\n\n\n-----\n\n_Figure 6. The Microsoft Cloud App Security dashboard allows DART analysis to detect_\n_unusual behavior across cloud apps._\n\n### Microsoft Secure Score\n\nThe Microsoft 365 Defender stack provides live remediation recommendations to reduce the\nattack surface. [Microsoft Secure Score is a measurement of an organization’s security](https://security.microsoft.com/securescore)\nposture, with a higher number indicating more improvement actions taken. Refer to our\ndocumentation to find out more about how your organization can leverage this feature to\nprioritize remediation actions that are based on their environment.\n\n## Understand your business risks\n\nBeyond the immediate risk of encrypted files, understanding the disruption to business\noperations, data theft, extortion, follow-on attacks, regulatory and compliance reporting, and\ndamage to reputation fall outside technical controls. Microsoft DART recommends each\norganization weigh these risks when determining the appropriate way to respond based on\nthe organization’s policies, risk appetite, and applicable regulatory requirements.\n\nMicrosoft Defender for Endpoint, Microsoft Defender for Identity, and MCAS all work\nseamlessly together to provide customers with enhanced visibility of the attacker’s actions\nwithin and investigate attacks. Given our vast experience and expertise in investigating\ncountless human-operated ransomware events over the past few years, we have shared\nwhat we consider best practices.\n\n## Learn more\n\n[Want to learn more about DART? Read our past blog posts.](https://www.microsoft.com/security/blog/microsoft-detection-and-response-team-dart-blog-series/)\n\n[To learn more about Microsoft Security solutions, visit our website. Bookmark the](https://www.microsoft.com/en-us/security/business/solutions) Security\nblog to keep up with our expert coverage on security matters. Also, follow us\nat [@MSFTSecurity for the latest news and updates on cybersecurity.](https://twitter.com/@MSFTSecurity)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-09-20 - A guide to combatting human-operated ransomware- Part 1.pdf"
    ],
    "report_names": [
        "2021-09-20 - A guide to combatting human-operated ransomware- Part 1.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673535609,
    "ts_updated_at": 1743041147,
    "ts_creation_date": 1653693150,
    "ts_modification_date": 1653693150,
    "files": {
        "pdf": "https://archive.orkl.eu/f0ec116c6db302478318048f86aa3427e724372b.pdf",
        "text": "https://archive.orkl.eu/f0ec116c6db302478318048f86aa3427e724372b.txt",
        "img": "https://archive.orkl.eu/f0ec116c6db302478318048f86aa3427e724372b.jpg"
    }
}