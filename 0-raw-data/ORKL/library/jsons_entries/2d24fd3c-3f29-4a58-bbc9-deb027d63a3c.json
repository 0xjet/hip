{
    "id": "2d24fd3c-3f29-4a58-bbc9-deb027d63a3c",
    "created_at": "2022-12-07T02:08:35.701656Z",
    "updated_at": "2025-03-27T02:16:47.091604Z",
    "deleted_at": null,
    "sha1_hash": "20abcd71b5293e4c97768dd337b4260a88efcc7c",
    "title": "",
    "authors": "",
    "file_creation_date": "2022-12-07T01:15:50Z",
    "file_modification_date": "2022-12-07T01:15:50Z",
    "file_size": 3122098,
    "plain_text": "# Mustang Panda Uses the Russian-Ukrainian War to Attack Europe and Asia Pacific Targets\n\n**[blogs.blackberry.com/en/2022/12/mustang-panda-uses-the-russian-ukrainian-war-to-attack-europe-and-asia-pacific-targets](https://blogs.blackberry.com/en/2022/12/mustang-panda-uses-the-russian-ukrainian-war-to-attack-europe-and-asia-pacific-targets)**\n\n_[Mustang Panda continue targeting countries across Europe and Asia Pacific, utilizing current](https://blogs.blackberry.com/en/2022/10/mustang-panda-abuses-legitimate-apps-to-target-myanmar-based-victims)_\n_geopolitical events to their advantage. Their attack chain remains consistent, with the continued use_\n_of archive files, shortcut files, malicious loaders, and the use of PlugX malware. Based on the lure_\n_covered in this blog, the goal of this particular operation appears to be collecting sensitive_\n_information from European countries and states from Asia, which might be supporting Western_\n_countries._\n\n### Summary\n\nAs part of ongoing hunting and continuous monitoring efforts regarding the advanced persistent\n[threat (APT) group Mustang Panda, the BlackBerry Threat Research and Intelligence team recently](https://malpedia.caad.fkie.fraunhofer.de/actor/mustang_panda)\ncame across an interesting RAR file titled “Political Guidance for the new EU approach towards\n_Russia.rar”._\n\nThis file captured our interest due to the ongoing geopolitical situation in Eastern Europe. An\nexamination of its contents revealed a decoy document matching the naming convention of the RAR,\n[along with additional components that are often seen as part of a typical PlugX infection chain.](https://blogs.blackberry.com/en/2022/10/mustang-panda-abuses-legitimate-apps-to-target-myanmar-based-victims)\n\nBy delving into the associated network infrastructure and pivoting off related network artifacts,\nadditional files and infrastructure were uncovered. These conformed to similar Tactics, Techniques,\nand Procedures (TTPs) and appeared to be part of a larger campaign from this same threat actor\ntargeting multiple entities, both Government and Private, in several industries and throughout many\ncountries across the world. In this report, we document what we found.\n\n\n-----\n\n_[You can read our previous post on Mustang Panda here.](https://blogs.blackberry.com/en/2022/10/mustang-panda-abuses-legitimate-apps-to-target-myanmar-based-victims)_\n\n### Weaponization and Technical Overview\n\n**Weapons** DLL Loaders + encrypted .dat payloads\n\n**Attack Vector** Current event-themed phishing lures\n\n**Network** Web based command-and-control (C2)\n**Infrastructure**\n\n**Targets** Mining, Education, Telecoms, Financial, CDN Companies, Internet Service\nProviders, Internet Security Firms, Web Hosting Companies\n\n### Technical Analysis\n\n**Context**\n\nMustang Panda, also known as HoneyMyte, Bronze President or Red Delta, is one of the more active\nAPT groups in operation on the threat landscape today, with a wide variety of campaigns documented\n[as far back as 2012. It is publicly attributed to China-based cyberespionage threat actors.](https://blog.talosintelligence.com/mustang-panda-targets-europe/)\n\nIt is continually honing its capabilities, but its core approach remains consistent, with the use of\n[themed lures related to current events. These contain decoy documents and legitimate applications](https://blog.talosintelligence.com/mustang-panda-targets-europe/)\nthat are susceptible to DLL search order hijacking.\n\nThis is exploited to coerce targets into executing a malicious loader to deliver a PlugX payload. The\nRAR archive – “Political Guidance for the new EU approach towards Russia.rar\" – aligned with\n[numerous TTPs related to Mustang Panda that have previously been documented by both BlackBerry](https://blogs.blackberry.com/en/2022/10/mustang-panda-abuses-legitimate-apps-to-target-myanmar-based-victims)\n[and other vendors.](https://www.secureworks.com/blog/bronze-president-targets-government-officials)\n\n### Mustang Panda Attack Vector\n\nA RAR file is an archive that contains one or more files compressed with RAR compression. As seen in\nrecent campaigns, the use of archives is a common infection vector for Mustang Panda. The political\ntheme of the RAR file is a tactic employed by the threat actor to coerce targets into opening the file.\nOnce the archive is open, the victim will see a directory called “_” and a shortcut file named with the\nsame politically themed lure.\n\nThe .LNK file uses a double file extension in an attempt to disguise the shortcut file as a document in\nthe hope the target would open it, in the process executing the shortcut file. This utilization of double\n[extensions has been used by Mustang Panda in the past as a way to convince users to execute the](https://www.crowdstrike.com/blog/meet-crowdstrikes-adversary-of-the-month-for-june-mustang-panda/)\nshortcut file.\n\nThe shortcut file contains a command that kicks off the initial execution of the attack chain:\n\n_“C:\\Windows\\System32\\cmd.exe /c \"_\\___\\_\\___\\______\\_____\\__\\test11.bpu||(forfiles /^P_\n_%USERPROFILE%\\ /S /^M \"Political Guidance for the new EU approach towards Russia.rar\" /C_\n_\"cmd /c (c:\\progra~1\\7-Zip\\7z x -y -aoa @path||c:\\progra~2\\7-Zip\\7z x -y -aoa @path”_\n\n|Weapons|DLL Loaders + encrypted .dat payloads|\n|---|---|\n|Attack Vector|Current event-themed phishing lures|\n|Network Infrastructure|Web based command-and-control (C2)|\n|Targets|Mining, Education, Telecoms, Financial, CDN Companies, Internet Service Providers, Internet Security Firms, Web Hosting Companies|\n\n\n-----\n\n_Figure 1: Phishing lure contents_\n\nThe LNK file looks to execute “test11.bpu”, which is a legitimate portable executable (PE) file called\n[“ClassicExplorerSettings.exe” belonging to Classic Shell, which is a freeware utility used to customize](http://www.classicshell.net/)\nthe look of the Windows system.®\n\n_Figure 2: MZ file header_\n\n**Hashes (md5,** 7177ab83a40a4111eb0170a76e92142b\n**sha-256)**\n\nf70d3601fb456a18ed7e7ed599d10783447016da78234f5dca61b8bd3a084a15\n\n**File Name** Political Guidance for the new EU approach towards Russia.rar\n\n**File Size** 567144 bytes\n\n**Created** 2022-11-01 02:32\n\n**Last Modified** 1979-11-29 13:00\n\n### Weaponization\n\n[The Mustang Panda attack chain is reliant on the DLL sideloading technique previously used in their](https://attack.mitre.org/techniques/T1574/002/)\n[campaign targeting Myanmar, where the threat actor plants both a legitimate executable and a](https://blogs.blackberry.com/en/2022/10/mustang-panda-abuses-legitimate-apps-to-target-myanmar-based-victims)\npayload alongside each other, a technique which is designed to take advantage of the search order of a\n\n|Hashes (md5, sha-256)|7177ab83a40a4111eb0170a76e92142b f70d3601fb456a18ed7e7ed599d10783447016da78234f5dca61b8bd3a084a15|\n|---|---|\n|File Name|Political Guidance for the new EU approach towards Russia.rar|\n|File Size|567144 bytes|\n|Created|2022-11-01 02:32|\n|Last Modified|1979-11-29 13:00|\n\n\n-----\n\n[program as soon as the legitimate application has been invoked. Once the shortcut file is executed, the](https://attack.mitre.org/techniques/T1574/001/)\nlegitimate application will be launched and the malicious DLL loader will also get invoked.\n\n“ClassicExplorer32.dll” is planted in the same directory as “test11.bpu” to abuse the search order once\nthe executable is invoked. The purpose of the DLL is to load the “ClassicExplorerLog.dat” file and\nexecute the shellcode within it. Interestingly, the loader used seems to have a subtle change in how the\nshellcode is decrypted and executed.\n\n[Mustang Panda DLL loaders reported by Secureworks back in September were utilizing the](https://www.secureworks.com/blog/bronze-president-targets-government-officials)\n_EnumThreadWindows API to pass execution to the start of the malicious payload file. In these more_\nrecent samples, the DLL loader uses the EnumSystemCodePagesW API to execute the shellcode\nsimilarly. A pointer to the already decrypted shellcode is passed to EnumSystemCodePagesW API as\nan application-defined callback function, as seen in Figure 3 below. The use of the\n_[EnumSystemCodePagesW API was mentioned in a Twitter thread by kienbigmummy and also seen in](https://twitter.com/kienbigmummy/status/1582217455568531456?s=20&t=3CR_HKwMeq3ctU2Qicm7AQ)_\na Black Hat Asia presentation. The purpose of the shellcode is to decrypt and execute the final\nmalicious payload – PlugX – in memory.\n\n_Figure 3: DLL Loader utilizing EnumSystemCodePagesW to load and execute shellcode_\n\n|Hashes (md5, sha- 256)|ae105528a6c5758ccf18705a8c208a97 b44cc792ae7f58e9a12a121c14a067ee1dd380df093339b4bf2b02df5937b2af|\n|---|---|\n|ITW File Name|ClassicExplorerSettings.exe|\n|Compilation Stamp|2017-08-13 15:49:42 UTC|\n\n\n**File**\n**Type/Signature**\n\n\nPE32 executable for MS Windows (GUI) Intel 80386 32-bit\n\n\n-----\n\n|File Size|98616 bytes|\n|---|---|\n\n|Hashes (md5, sha-256)|6d6a0ca7c7343eedfffeb697229a4929 8e27900949a087349488d82e7434937bd253d31749041bb0233000a7339fc3e1|\n|---|---|\n|ITW File Name|ClassicExplorer32.dll|\n|Compilation Stamp|2022-10-25 09:32:51 UTC|\n|File Type/Signature|PE32 executable for MS Windows (DLL) (GUI) Intel 80386 32-bit|\n|File Size|115000 bytes|\n\n|Hashes (md5, sha- 256)|a95f48acd5da4beddd4115e12653c23c 9c1ea202237726984b754d17528cfab0212ff9587bbffaf01c8535277b01c24a|\n|---|---|\n|ITW File Name|ClassicExplorerLog.bin, ClassicExplorerLog.dat|\n|File Type/Signature|DATA File|\n|File Size|614718 bytes|\n\n\nOnce the PlugX payload has been decrypted and execution is passed to the payload, we can see the\nconfig also get decrypted into memory. Here we can see the IP address 5[.]34[.]178[.]156, the\ncampaign ID of “test222”, as well as the name of the decoy document that gets displayed to the victim.\n\n_Figure 4: PlugX config C2_\n\n\n-----\n\n_Figure 5: PlugX campaign ID + decoy document name_\n\n_Figure 6: Decoy document_\n\n### Network Infrastructure\n\nThe C2 IP address – 5[.]34[.]178[.]156 – was seen to be hosting a service on port 443 with a unique\nSSL certificate. The SSL certificate was first seen being associated with this IP from the period 202210-07 to 2022-10-30.\n\n|Domain Name|Samples’ Hashes|First/Last Seen/ASN|\n|---|---|---|\n\n\n-----\n\n|5[.]34[.]178[.]156|a95f48acd5da4beddd4115e12653c23c 9c1ea202237726984b754d17528cfab0212ff9587bbffaf01c8535277b01c24a|2022-07-19 2022-10-31 ASN:204957|\n|---|---|---|\n\n\nCN=45.134.83.29,OU=TLS Demo Cert,O=File Transfer Service, 2.5.4.46=\n#13186d67332f6d4c506d4b335966582f4d614a43732f6d673d3d\n\nIssuer - CN=CTA Root CA, O=TEST TEST TEST,\n2.5.4.46=#13185843794c4248705065757479714b4344383866614e773d3d\n\n### Additional Linked Infrastructure\n\nPivoting on the certificate showed 15 other IP addresses utilizing the same SSL certificate. Five of\nthese were being used as C2 servers for the same attack chain delivering lures/decoys in the form of\nRAR files, in the hopes of the victims executing PlugX malware in memory.\n\nThe lures all varied but all aligned with the previous campaigns associated with Mustang Panda.\n\n_Figure 7: SSL certificate showing C2 pivoting_\n\n\n-----\n\n### Targets\n\nMustang Panda’s previous targets have included Government and Non-Government Organizations\n(NGO) in many locations around the world, from various states in Southeast Asia, to the European\nUnion, to the U.S. and beyond. Considering the decoy lures found, as well as the correlating network\ntelemetry, we found the threat actor to be targeting areas in Europe as well as Asia-Pacific, specifically\nVietnam. This is not an exhaustive list as we have been unable to identify the industries of all the\nvictims thus far.\n\n_Figure 8: Partial list of victims_\n\n### Conclusions\n\nMustang Panda continues to utilize well-thought-out lures related to current events to deliver the\nPlugX malware that the group is synonymous with. While Mustang Panda has stayed within their\ntypical TTPs with PlugX, including custom lures, double extensions, and infrastructure re-use, they do\nmake subtle changes along the way in the hope of evading detection. The historical data associated\nwith the pivoted SSL certificate shows it being first seen on 2022-02-27. It is still being actively used\nat the time of writing.\n\nMustang Panda has a history of targeting many different entities across the globe, but their target\naligns with the interests of the Chinese government. From the associated lures, NetFlow data, and\nother characteristics, the EU and APAC have been their biggest targets as of late.\n\n### Referential Indicators of Compromise (IoCs)\n\n**Main File**\n\n|File Name|Political Guidance for the new EU approach towards Russia.rar|\n|---|---|\n\n\n-----\n\n|SHA256|F70d3601fb456a18ed7e7ed599d10783447016da78234f5dca61b8bd3a084a15|\n|---|---|\n|File Type|RAR|\n|Network Indicator (C2)|5[.]34.178.156|\n\n\n**Network Indicators**\n\n**C2**\n\n104[.]42.43.178\n\n64[.]34.216.50\n\n45[.]147.26.45\n\n45[.]32.101.7\n\n64[.]34.216.44\n\n185[.]80.201.4\n\n103[.]192.226.87\n\n194[.]124.227.90\n\n43[.]254.218.128\n\n62[.]233.57.49\n\n**Detailed MITRE ATT&CK® Mapping**\n\n|Tactic|Technique|Sub-Technique name|\n|---|---|---|\n|Execution|T1203|Exploitation for Client Execution|\n|Execution|T1106|Native API|\n|Execution|T1129|Shared Module|\n\n\n-----\n\n|Execution|T1559.001|Component Object Model|\n|---|---|---|\n|Execution|T1204.002|Malicious File|\n|Execution|T1059.003|Windows Command Shell|\n|Persistence/Privilege Escalation|T1547.001|Registry Run Keys / Startup Folder|\n|Defense Evasion|T1574.002|DLL Side-Loading|\n|Defense Evasion|T1027|Obfuscated Files or Information|\n|Defense Evasion|T1036|Masquerading|\n|Defense Evasion|T1036.007|Double File Extension|\n|Defense Evasion|T1218|System Binary Proxy Execution|\n|Defense Evasion|T1564.001|Hidden Files and Directories|\n|Defense Evasion|T1140|Deobfuscate Decode Files or Information|\n|Discovery|T1057|Process Discovery|\n|Discovery|T1082|System Information Discovery|\n|Discovery|T1518|Software Discovery|\n|Discovery|T1033|System Owner/User Discovery|\n|Collection|T1560.001|Archive via Utility|\n|Persistence|T1547.009|Shortcut|\n|Command and Control|T1071.001|Web Protocols|\n\n\n**Related Reading:**\n\n\n-----\n\n## About The BlackBerry Research & Intelligence Team\n\nThe BlackBerry Research & Intelligence team examines emerging and persistent threats, providing\nintelligence analysis for the benefit of defenders and the organizations they serve.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        },
        {
            "id": "4e039bf8-7239-4999-8ec0-eb202d1465af",
            "created_at": "2022-12-04T11:19:36.52593Z",
            "updated_at": "2022-12-04T11:19:36.52593Z",
            "deleted_at": null,
            "name": "ORKL",
            "url": "https://github.com/ORKL/library",
            "description": "ORKL Community Contributed Content",
            "reports": null
        }
    ],
    "references": [
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2022/2022.12.06.Mustang_Panda/Mustang%20Panda%20Uses%20the%20Russian-Ukrainian%20War%20to%20Attack%20Europe%20and%20Asia%20Pacific%20Targets.pdf"
    ],
    "report_names": [
        "Mustang Panda Uses the Russian-Ukrainian War to Attack Europe and Asia Pacific Targets"
    ],
    "threat_actors": [
        {
            "id": "b5449533-0ff1-4048-999d-7d4bfd8e6da6",
            "created_at": "2022-10-25T16:07:24.114365Z",
            "updated_at": "2025-03-27T02:02:10.111256Z",
            "deleted_at": null,
            "main_name": "RedDelta",
            "aliases": [
                "Operation Dianxun",
                "TA416"
            ],
            "source_name": "ETDA:RedDelta",
            "tools": [
                "Agent.dhwf",
                "Agentemis",
                "Chymine",
                "Cobalt Strike",
                "CobaltStrike",
                "Darkmoon",
                "Destroy RAT",
                "DestroyRAT",
                "Gen:Trojan.Heur.PT",
                "Kaba",
                "Korplug",
                "PlugX",
                "Poison Ivy",
                "RedDelta",
                "SPIVY",
                "Sogu",
                "TIGERPLUG",
                "TVT",
                "Thoper",
                "Xamtrav",
                "cobeacon",
                "pivy",
                "poisonivy"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "aa90ad17-8852-4732-9dba-72ffb64db493",
            "created_at": "2023-07-11T02:00:10.067957Z",
            "updated_at": "2025-03-27T02:00:03.134199Z",
            "deleted_at": null,
            "main_name": "RedDelta",
            "aliases": [],
            "source_name": "MISPGALAXY:RedDelta",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "1691c25f-1aa4-4168-8ce2-7aa8f23246e7",
            "created_at": "2024-06-04T02:03:07.724221Z",
            "updated_at": "2025-03-27T02:05:17.284601Z",
            "deleted_at": null,
            "main_name": "BRONZE PRESIDENT",
            "aliases": [
                "Mustang Panda ",
                "Red Lich ",
                "Temp.Hex ",
                "HoneyMyte "
            ],
            "source_name": "Secureworks:BRONZE PRESIDENT",
            "tools": [
                " Cobalt Strike",
                " ORat",
                " PlugX",
                " RCSession",
                "China Chopper"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "b69037ec-2605-4de4-bb32-a20d780a8406",
            "created_at": "2023-01-06T13:46:38.790766Z",
            "updated_at": "2025-03-27T02:00:02.919758Z",
            "deleted_at": null,
            "main_name": "MUSTANG PANDA",
            "aliases": [
                "TEMP.HEX",
                "TA416",
                "TANTALUM",
                "Twill Typhoon",
                "Earth Preta",
                "Stately Taurus",
                "LuminousMoth",
                "Polaris",
                "BRONZE PRESIDENT",
                "HoneyMyte",
                "Red Lich"
            ],
            "source_name": "MISPGALAXY:MUSTANG PANDA",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "9baa7519-772a-4862-b412-6f0463691b89",
            "created_at": "2022-10-25T15:50:23.354429Z",
            "updated_at": "2025-03-27T02:00:55.45162Z",
            "deleted_at": null,
            "main_name": "Mustang Panda",
            "aliases": [
                "Mustang Panda",
                "TA416",
                "RedDelta",
                "BRONZE PRESIDENT"
            ],
            "source_name": "MITRE:Mustang Panda",
            "tools": [
                "Cobalt Strike",
                "RCSession",
                "NBTscan",
                "PoisonIvy",
                "PlugX"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "2ee03999-5432-4a65-a850-c543b4fefc3d",
            "created_at": "2022-10-25T16:07:23.882813Z",
            "updated_at": "2025-03-27T02:02:10.0116Z",
            "deleted_at": null,
            "main_name": "Mustang Panda",
            "aliases": [
                "Bronze President",
                "Camaro Dragon",
                "Earth Preta",
                "HoneyMyte",
                "Mustang Panda",
                "Operation SMUGX",
                "Operation SmugX",
                "PKPLUG",
                "Red Lich",
                "Stately Taurus",
                "TEMP.Hex"
            ],
            "source_name": "ETDA:Mustang Panda",
            "tools": [
                "9002 RAT",
                "AdFind",
                "Agent.dhwf",
                "Agentemis",
                "CHINACHOPPER",
                "China Chopper",
                "Chymine",
                "ClaimLoader",
                "Cobalt Strike",
                "CobaltStrike",
                "DCSync",
                "DOPLUGS",
                "Darkmoon",
                "Destroy RAT",
                "DestroyRAT",
                "Farseer",
                "Gen:Trojan.Heur.PT",
                "HOMEUNIX",
                "Hdump",
                "HenBox",
                "HidraQ",
                "Hodur",
                "Homux",
                "HopperTick",
                "Hydraq",
                "Impacket",
                "Kaba",
                "Korplug",
                "LadonGo",
                "MQsTTang",
                "McRAT",
                "MdmBot",
                "Mimikatz",
                "NBTscan",
                "NetSess",
                "Netview",
                "Orat",
                "POISONPLUG.SHADOW",
                "PUBLOAD",
                "PVE Find AD Users",
                "PlugX",
                "Poison Ivy",
                "PowerView",
                "QMAGENT",
                "RCSession",
                "RedDelta",
                "Roarur",
                "SPIVY",
                "ShadowPad Winnti",
                "SinoChopper",
                "Sogu",
                "TIGERPLUG",
                "TONEINS",
                "TONESHELL",
                "TVT",
                "TeamViewer",
                "Thoper",
                "TinyNote",
                "WispRider",
                "WmiExec",
                "XShellGhost",
                "Xamtrav",
                "Zupdax",
                "cobeacon",
                "nbtscan",
                "nmap",
                "pivy",
                "poisonivy"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1670378915,
    "ts_updated_at": 1743041807,
    "ts_creation_date": 1670375750,
    "ts_modification_date": 1670375750,
    "files": {
        "pdf": "https://archive.orkl.eu/20abcd71b5293e4c97768dd337b4260a88efcc7c.pdf",
        "text": "https://archive.orkl.eu/20abcd71b5293e4c97768dd337b4260a88efcc7c.txt",
        "img": "https://archive.orkl.eu/20abcd71b5293e4c97768dd337b4260a88efcc7c.jpg"
    }
}