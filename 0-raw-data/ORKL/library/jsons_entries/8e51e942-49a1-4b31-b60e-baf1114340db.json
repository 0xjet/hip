{
    "id": "8e51e942-49a1-4b31-b60e-baf1114340db",
    "created_at": "2023-01-12T15:04:03.199705Z",
    "updated_at": "2025-03-27T02:16:49.088939Z",
    "deleted_at": null,
    "sha1_hash": "71b6734b949dc8789414d5ff2dc28602641a17f3",
    "title": "2022-07-05 - Whatever floats your Boat – Bitter APT continues to target Bangladesh",
    "authors": "",
    "file_creation_date": "2022-07-18T18:24:07Z",
    "file_modification_date": "2022-07-18T18:24:07Z",
    "file_size": 5068630,
    "plain_text": "# Whatever floats your Boat – Bitter APT continues to target Bangladesh\n\n**[secuinfra.com/en/techtalk/whatever-floats-your-boat-bitter-apt-continues-to-target-bangladesh/](https://www.secuinfra.com/en/techtalk/whatever-floats-your-boat-bitter-apt-continues-to-target-bangladesh/)**\n\n## Key Findings\n\n\n05.07.2022\n\n\nThe SECUINFRA Falcon Team identified a recent attack consitent with the campaign targeting Bangladesh conducted by the\nadvanced persistent threat group “Bitter”, also known as T-APT-17.\nBitter employs malicious document files as lures containing different implementations of the so-called “Equation Editor exploits”\nto download following malware stages.\nThe second stage consists of a Loader, which gathers information about the infected system and retrieves the third stage from a\nremote server.\nThe third stage of a Bitter attack can feature different types of Malware e.g. Keyloggers, Stealers or Remote Access Trojans\n(RATs). We analyzed one of the newer utilized RATs, which we refer to as “Almond RAT”.\n\n## Overview\n\n[The Bitter APT group is said to be active since at least 2013 was first reported about by Forcepoint Labs in 2016 when it was primarily](https://www.forcepoint.com/blog/x-labs/bitter-targeted-attack-against-pakistan)\ntargeting Pakistan. The threat group is suspected to be located in southern Asia. Even back then the group was using spearphishing\nemails to exploit Microsoft Office (e.g. CVE-2012-0158) and download additional malware, so compared to their attacks today their\nmodus operandi has not changed at all. Occasionally they also target Android devices with Remote Access Trojans, as reported by\n[BitDefender in 2020.](https://www.bitdefender.com/files/News/CaseStudies/study/352/Bitdefender-PR-Whitepaper-BitterAPT-creat4571-en-EN-GenericUse.pdf)\n\n[In Februray of 2019 Palo Alto Networks documented Bitter attacks using a second stage Downloader dubbed “ArtraDownloader”](https://unit42.paloaltonetworks.com/multiple-artradownloader-variants-used-by-bitter-to-target-pakistan/)\nwhich has been in use since 2017. Also Chinese and Saudi Arabian organizations were added to the list of targets.\n\nAs discovered by Cyble and Kaspersky in 2021 the Bitter group is also capable of more than just old Office exploits, for example\n[abusing 0-day vulnerabilities like a Windows Kernel vulnerability (CVE-2021-1732) and a vulnerability in the Windows Desktop](https://blog.cyble.com/2021/02/24/bitter-apt-enhances-its-capability-with-windows-kernel-zero-day-exploit/)\nWindow Manager (CVE-2021-28310) for privilege escalation.\n\n[In May 2022 Cisco Talos shared an Analysis of a new Bitter campaign targeting users in Bangladesh starting in October 2021 up to](https://blog.talosintelligence.com/2022/05/bitter-apt-adds-bangladesh-to-their.html)\nFebruary 2022 with a new-ish second stage downloader called “ZxxZ”.\n\nThis report builds on the findings published by Talos and covers an attack presumabily conducted in mid May 2022.\n\nShortly before the completion of this report the Qi Anxin Threat Intellingence Center published a report on recent Bitter activities\ntargeting military branches of Bangladesh. They also mentioned the RAT sample analyzed in this blog post.\n\nOn the 4th of July [@c3rb3ru5d3d53c released a report about a Bitter campaign targeting Pakistan. In addition to many analysis steps](https://twitter.com/c3rb3ru5d3d53c)\nthat match our approach, it was also demonstrated how the ZxxZ Downloader could be used with a custom C2 server.\n\n## Analysis\n\n### Excel Maldoc\n\nThe sample of the malicious Excel document (1bf615946ad9ea7b5a282a8529641bf6) was obtained through the public Any.Run\nSandbox service. As with previous campaigns conducted by Bitter the file was likely distributed via a spearphishing email, which is not\n[available for Analysis. The sample was previously mentioned by Simon Kenin (k3yp0d) on Twitter.](https://twitter.com/k3yp0d/status/1527656133837594624)\n\nThe filename of the document reads “Repair of different csoc cstc, china supplied system – BNS BIJOY.xls”. The abbreviations csoc\nand cstc likely stand for “China Shipbuilding & Offshore International Co. Ltd” and “China Shipbuilding Trading Co. Ltd” respectively\n[and BNS Bijoy is the name of a “Castle-class guided missile corvette” (small warship) of the Bangladesh Navy (Wikipedia).](https://en.wikipedia.org/wiki/BNS_Bijoy)\n\nThe document does not contain readable content on the topic the filename suggests, only a white rectangle image and unicode\ncharacters, which should alert victims that it is not a legitimate document. As soon as the file is opened the Equation Editor exploit,\n[which we identified as CVE-2018-0798, is executed.](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-0798)\n\n\n-----\n\nFigure 1: Visible contents of the Excel document\n\nWithout alerting the user in any way the Equation Editor is started in the background and used to download the next malware stage\nand execute it. By tracing the Process Tree with ProcMon we can see that the downloaded binary is written to C:\\$Drw\\fsutil.exe and\nexecuted by the Windows Explorer.\n\nFigure 2: Process Tree of Equation Editor\n\nTo extract information from the Maldoc we opted for a dynamic approach first. By registering a debugger for the Equation Editor\nexecutable via gflags.exe, which is part of the Windows SDK, we are able to attach x32dbg to the process once the Excel document is\n[opened (this technique was showcased by Colin Hardy for CVE-2017-1182).](https://www.youtube.com/watch?v=aBWAHxpXHEk)\n\nFigure 3: Registering a debugger for Equation Editor\n\nSince Excel is waiting on the Equation Editor to exit, our debugging session will unfortunately be ended after a fixed amount of time\nwith the error message below, so we will have to approach it differently.\n\n\n-----\n\nFigure 4: Error dialog while debugging Equation Editor\n\n[With the well-known oledump tool developed by Didier Stevens we can take a look at the data streams inside the Excel file. In this](https://blog.didierstevens.com/programs/oledump-py/)\ncase the stream A4, which is named Equation Native is of particular interest for us.\n\nFigure 5: Viewing the contents of the Excel file with oledump\n\nBy specifying the stream and the -d parameter we can dump it to analyze it further.\n\nFigure 6: Dumping the Equation stream\n\nOpening the dumped file in a hex editor we can visually identify two different segments of data. Highlighted in green we see data that\nis likely the shellcode required for the Equation Editor exploit. Since there are next to no readable ASCII strings in there (looking\nclosely we can spot fragments that look like “URL” or “http”) this data is likely encoded or encrypted in some way. Below that we can\nsee data in a repeating pattern which is used as padding for the memory corruption exploit CVE-2018-0798.\n\nFigure 7: Analyzing the shellcode in a Hex editor\n\nIn an attempt to decode the shellcode portion of the data we ran a frequency analysis (a very useful feature of the Okteta hex editor)\n[on it to determine which values occur the most, since in a 2019 report by Sophos Labs a maldoc builder for CVE-2018-0798 was](https://news.sophos.com/en-us/2019/07/18/a-new-equation-editor-exploit-goes-commercial-as-maldoc-attacks-using-it-spike/)\nanalyzed which implements a XOR-based encoding for the shellcode. For this maldoc the most frequent byte is FF so we assume that\nthis could be encoded null bytes and therefore FF could be the key in a single-byte XOR encoding.\n\n\n-----\n\nFigure 8: Running frequency analysis on the shellcode\n\nUsing Cyberchef with the presumed shellcode section and XOR key does yield readable strings. From here we can extract important\ninformation about the executed shellcode and indicators like the URL for the next malware stage.\n\nFigure 9: Decoding the XOR-ed shellcode\n\nThe visualization below shows the most important API calls made in the shellcode:\n\nFigure 10: Graph showing the functionality of the maldoc shellcode\n\nBy debugging the Equation Editor exploit again and manually placing a breakpoint on e.g. URLDownloadToFileA we can confirm these\nfindings\n\n\n-----\n\nFigure 11: Manually loading urlmon.dll to place a breakpoint on URLDownloadToFileA\n\nThe download query to emshedulersvc[.]com/vc/vc returns a sample of Bitters second stage Downloader, which we will investigate\nnext.\n\nFigure 12: Breaking on URLDownloadToFile\n\n### ZxxZ / MuuyDownloader\n\nSince approximately the second half of 2021 Bitter switched from their second-stage ArtraDownloader to a new, but similar\n[implementation named “ZxxZ” by Talos and “MuuyDownloader” by Qi Anxin Threat Intelligence Center. It is implemented in Visual C++](https://blog.talosintelligence.com/2022/05/bitter-apt-adds-bangladesh-to-their.html)\nand does not appear to be packed on first inspection. The compilation timestamp suggests this binary was built on the 11th of May\n2022, which matches the timeframe for the malicious document.\n\n\n-----\n\nFigure 13: Detect it Easy parsing the PE file, Entropy graph\n\nComparing this fingerprinting function to the one documented by Cisco Talos we can see that Bitter abandoned the ZxxZ value\nseparator (that gave the Downloader its name) in exchange for a simple underscore. This was possibly done to avoid detection\nthrough IDS/IPS systems based on this very specific separator. Looking back at older Bitter Research we can see that the threat\ngroup likes to change up these patterns from time to time to avoid detection.\n\nFigure 14: ZxxZ gathering system information\n\nThe check-in with an attacker-controlled staging server contains the user account and hostname of the system. The function below\nmanually assembles the HTTP GET request and sends it via a socket connection to the C2 server.\n\n\n-----\n\ng g q g p\n\nWe verified this network communication using packet captures. Another common indicator across Bitter infrastructure is the use of the\nLiteSpeed web server, which has been documented in older reports as well.\n\nFigure 16: Packet capture of the GET request above\n\nAfter retrieving the next malware stage from a staging server ZxxZ writes the binary to the disk and tries to execute it. In the\nscreenshot below we can see that the Bitter group altered the C2 opcode strings that Talos had previously documented as DN-S\n(download success) and RN_E (run error) to just S and F, presumably short for Success and Failure. This is likely another measure\nto evade older detection rules. The payload execution was also changed to use CreateProcessA instead of ShellExecuteA like in the\nolder version of ZxxZ.\n\nFigure 17: ZxxZ retrieving and executing the next stage\n\nUnfortunately the actual payload could not be retrieved from the staging server as it only returned an empty file named CAPT.msi.\n\n\n-----\n\nFigure 18: Request made to another staging server for the third stage\n\n### Almond RAT\n\n[Information on the Remote Access Trojans (RATs) deployed by Bitter (with one commonly referred to as BitterRAT) is limited and](https://malpedia.caad.fkie.fraunhofer.de/details/win.bitter_rat)\nsometimes contradictory. We found that Bitter deploys different RAT implementations / variants depending on the scenario and target.\n\nIn this case we analyzed a sample of a .NET-based RAT that we were not able to identify through previous reports or open source\nrepositories. For the lack of an existing detection and a better name we will refer to it as “Almond RAT” for this analysis. The sample\nwas first mentioned by the Twitter user [@binlmmhc. The recent report by Qi Anxin mentioned above refers to this RAT only as](https://twitter.com/binlmmhc/status/1530115191069110273)\n“lightweight remote control”.\n\nFigure 19: Detect it Easy parsing the Almond RAT PE file\n\n### Basic functionality\n\nThe main function of the RAT checks for the mutex string saebamini.com SingletonApp before calling the StartClient function. Turns\nout even skilled threat actors need to look up the really simple things sometimes: in this case a short tutorial about Allowing Only One\nInstance of a C# Application to Run which uses this same mutex string. As always they copied only half of the answer and forgot to\ninclude the call to ReleaseMutex at the end…\n\n\n-----\n\nFigure 20: Main function, setting a Mutex\n\nAlmond RAT employs string encryption to hinder detection and reverse engineering. Important / revealing strings like the\nCommand&Control (C2) IP address below are therefore wrapped in the ciphertext.Decrypt function.\n\nFigure 21: StartClient fuction, showing the AES string encryption\n\nThe decryption function implements a default AES-256-CBC encryption scheme where the IV and key are derived from the given\nplaintext password via PDKDF2. Since it is trivial to reimplement this in e.g. Python we decrypted all of the encrypted strings in the\nbinary and modified the .NET assembly to increase code readability for this report. The file hashes of the unaltered and modified\nbinaries can be found in the IoC section at the end of the post.\n\nFigure 22: String decryption function using AES CBC\n\nThe StartClient function implements the socket-based C2 communication interface for Almond RAT. In the samples we observed there\nwere no domains or dynamic DNS services but only IPv4 addresses used to connect back to the threat actors. A characteristic\nproperty of the RAT is the usage of the tcp port 33638 . When first contacting the C2 server Almond RAT transmits gathered system\ninformation like hostname, OS version, internal IP address and MAC address and storage identifiers (disk info is not transmitted) to\nfingerprint the infected system. A 1024 byte buffer is used for the C2 communication.\n\n\n-----\n\nFigure 23: StartClient function\n\n### Capabilities & C2 communication\n\nNext well will further investigate the functionality of Almond RAT. At the beginning of the StartCommWithServer function the RAT sets\na random receive timeout between 20 and 30 seconds for the socket. The analyzed sample accepts seven different commands in\ntotal. The REFRESH command is used as a heartbeat signal, letting the C2 server know that the RAT is still active and will reply with a\nsimple OK.\n\nThe DRIVE command returns a list of connected storage devices.\n\nWith the DELETE* command the attackers can delete accessible files by supplying a path. In case of e.g. insufficient permissions it\nwill return the exception. The * in the command string is used as a separator between the command and the file path.\n\nFigure 24: Basic C2 functionality\n\nAlmond RAT allows for the execution of arbitrary commands via a wrapped cmd.exe instance. It has its own implementation for\ndirectory changes via cd and directory listings via OK. The CMD command uses a tilde instead of an asterisk to separate the parts of\nthe command.\n\n\n-----\n\nFigure 25: Command execution\n\nIn addition to the functionality of listing directories and files via the command prompt the RAT also supports a quite involved DIR*\ncommand. It is capable of verifying file accessibility and displaying meta data like the last file write-time.\n\nFigure 26: Directory and File listings\n\nSince Bitters main objective is espionage they need a way to exfiltrate data to the C2 server from the system, which is done via the\nDOWNLOAD* command.\n\nTo drop more malware or other files onto the system it also supports the UPLOAD* command which uses the following file naming\nscheme: yyyyMMdd-hhmmss_filename\n\n\n-----\n\nFigure 27: DOWNLOAD* and UPLOAD* functions\n\nIn case the RAT receives an unknown command from the operator it will return the message XXX to indicate the error.\n\nFigure 28: Exception handling in case of an unknown command\n\nAlmond RATs main purposes seem to be file system discovery, data exfiltration and a way to load more tools/establish persistence.\nThe design of the tools seems to be layed out in way that it can be quickly modified and adapted to the current attack scenario.\n\n## Hosting Infrastructure / Network Indicators\n\n### WHOIS and DNS Records\n\nThe staging server for the Downloader and the staging server for the RAT are hosted with Host Sailor. The Command&Control server\nfor the Downloader is hosted with Namecheap and the one for Almond RAT is hosted with Nexeon Technologies. Except for the\nsamples analysed in this report there was no other significant malware activity detected with these four domains.\n\n**Staging server ZxxZ downloader**\n\n**Domain** **emshedulersvc[.]com**\n\n**Registrar** ENOM Inc.\n\n**Hoster** Host Sailor Ltd.\n\n**Created** 10.05.2022 – 91.195.240[.]103\n\n**Updated** 12.05.2022 – 194.36.191[.]196\n\n**C2 server ZxxZ downloader**\n\n\n-----\n\n**Domain** **huandocimama[.]com**\n\n**Registrar** Namecheap Inc.\n\n**Hoster** Namecheap Inc.\n\n**Created** 19.08.2021 – 162.0.232[.]109\n\n**Updated** N/A\n\n**Staging server third stage**\n\n**Domain** **diyefosterfeeds[.]com**\n\n**Registrar** ENOM Inc.\n\n**Hoster** Host Sailor Ltd.\n\n**Created** 02.02.2022 – 194.36.191[.]196\n\n**Updated** N/A\n\n**Almond RAT C2 server**\n\n**Domain** **64.44.131[.]109**\n\n**Hoster** Nexeon Technologies Inc.\n\n**ASN** AS20278\n\n**Created** 27.02.2014\n\nWhile investigating these DNS entries we also noticed that on the 30.05.2022 a new record for spurshipbroker[.]com on\n194.36.191[.]196 was created. This domain seems to be a so-called “typosquat” (impersonation) of spurshipbrokers[.]com, an Indian\nMarine Shipping and Transport company. This record stood out between seemingly legitimate webhosting and typosquats for banking\nsites on this Webhost/IP used by Bitter. While we do not have further evidence at this point in time that this is related to the Bitter\nactivity it certainly does fit the approach of the group and the Naval-themed lure.\n\n## Yara Rules\n\n[The Yara rule set we created for this report can be found below, in our Github Repository: SIFalcon/Detection and on Abuse.ch](https://github.com/SIFalcon/Detection)\nYaraify.\n\n/*\n\nYara Rule Set\n\nAuthor: SECUINFRA Falcon Team\n\nDate: 2022-06-23\n\nIdentifier: 0x03-yara_win-Bitter_T-APT-17\n\nReference: “https://www.secuinfra.com/en/techtalk/whatever-floats-your-boat-bitter-apt-continues-to-target-bangladesh”\n\n*/\n\n/* Rule Set —————————————————————– */\n\nrule APT_Bitter_Maldoc_Verify {\n\nmeta:\n\ndescription = “Detects Bitter (T-APT-17) shellcode in oleObject (CVE-2018-0798)”\n\nauthor = “SECUINFRA Falcon Team (@SI_FalconTeam)”\n\ntlp = “WHITE”\n\nreference = “https://www.secuinfra.com/en/techtalk/whatever-floats-your-boat-bitter-apt-continues-to-target-bangladesh”\n\ndate = “2022-06-01”\n\nhash0 = “0c7158f9fc2093caf5ea1e34d8b8fffce0780ffd25191fac9c9b52c3208bc450”\n\nhash1 = “bd0d25194634b2c74188cfa3be6668590e564e6fe26a6fe3335f95cbc943ce1d”\n\nhash2 = “3992d5a725126952f61b27d43bd4e03afa5fa4a694dca7cf8bbf555448795cd6”\n\n\n-----\n\nstrings:\n// This rule is meant to be used for verification of a Bitter Maldoc\n\n// rather than a hunting rule since the oleObject it is matching is\n\n// compressed in the doc zip\n\n$xor_string0 = “LoadLibraryA” xor\n\n$xor_string1 = “urlmon.dll” xor\n\n$xor_string2 = “Shell32.dll” xor\n\n$xor_string3 = “ShellExecuteA” xor\n\n$xor_string4 = “MoveFileA” xor\n\n$xor_string5 = “CreateDirectoryA” xor\n\n$xor_string6 = “C:\\\\Windows\\\\explorer” xor\n\n$padding = {000001128341000001128341000001128342000001128342}\n\ncondition:\n\n3 of ($xor_string*)\n\nand $padding\n\n}\n\nrule APT_Bitter_ZxxZ_Downloader {\n\nmeta:\n\ndescription = “Detects Bitter (T-APT-17) ZxxZ Downloader”\n\nauthor = “SECUINFRA Falcon Team (@SI_FalconTeam)”\n\ntlp = “WHITE”\n\nreference = ” https://www.secuinfra.com/en/techtalk/whatever-floats-your-boat-bitter-apt-continues-to-target-bangladesh”\n\ndate = “2022-06-01”\n\nhash0 = “91ddbe011f1129c186849cd4c84cf7848f20f74bf512362b3283d1ad93be3e42”\n\nhash1 = “90fd32f8f7b494331ab1429712b1735c3d864c8c8a2461a5ab67b05023821787”\n\nhash2 = “69b397400043ec7036e23c225d8d562fdcd3be887f0d076b93f6fcaae8f3dd61”\n\nhash3 = “3fdf291e39e93305ebc9df19ba480ebd60845053b0b606a620bf482d0f09f4d3”\n\nhash4 = “fa0ed2faa3da831976fee90860ac39d50484b20bee692ce7f0ec35a15670fa92”\n\nstrings:\n\n// old ZxxZ samples / decrypted strings\n\n$old0 = “MsMp” ascii\n\n$old1 = “SOFTWARE\\\\Microsoft\\\\Windows NT\\\\CurrentVersion” ascii\n\n$old2 = “&&user=” ascii\n\n$old3 = “DN-S” ascii\n\n$old4 = “RN_E” ascii\n\n// new ZxxZ samples\n\n$c2comm0 = “GET /” ascii\n\n$c2comm1 = “profile” ascii\n\n$c2comm2 = “.php?” ascii\n\n$c2comm3 = “data=” ascii\n\n$c2comm4 = “Update” ascii\n\n$c2comm5 = “TTT” ascii\n\ncondition:\n\nuint16(0) == 0x5a4d\n\nand filesize > 39KB // Size on Disk/1.5\n\nand filesize < 2MB // Size of Image*1.5\n\nand (all of ($old*)) or (all of ($c2comm*))\n\n}\n\nimport “pe”\nimport “dotnet”\n\nrule APT_Bitter_Almond_RAT {\n\n\n-----\n\nmeta:\ndescription = “Detects Bitter (T-APT-17) Almond RAT (.NET)”\n\nauthor = “SECUINFRA Falcon Team (@SI_FalconTeam)”\n\ntlp = “WHITE” reference = ” https://www.secuinfra.com/en/techtalk/whatever-floats-your-boat-bitter-apt-continues-to-targetbangladesh”\n\ndate = “2022-06-01” hash = “55901c2d5489d6ac5a0671971d29a31f4cdfa2e03d56e18c1585d78547a26396”\n\nstrings:\n\n$function0 = “GetMacid” ascii\n\n$function1 = “StartCommWithServer” ascii\n\n$function2 = “sendingSysInfo” ascii\n\n$dbg0 = “*|END|*” wide\n\n$dbg1 = “FILE>” wide\n\n$dbg2 = “[Command Executed Successfully]” wide\n\ncondition:\n\nuint16(0) == 0x5a4d\n\nand dotnet.version == “v4.0.30319”\n\nand filesize > 12KB // Size on Disk/1.5\n\nand filesize < 68KB // Size of Image*1.5\n\nand any of ($function*)\n\nand any of ($dbg*)\n\n}\n\nrule APT_Bitter_PDB_Paths {\n\nmeta:\n\ndescription = “Detects Bitter (T-APT-17) PDB Paths”\n\nauthor = “SECUINFRA Falcon Team (@SI_FalconTeam)”\n\ntlp = “WHITE”\n\nreference = “https://www.secuinfra.com/en/techtalk/whatever-floats-your-boat-bitter-apt-continues-to-target-bangladesh”\n\ndate = “2022-06-22”\n\nhash0 = “55901c2d5489d6ac5a0671971d29a31f4cdfa2e03d56e18c1585d78547a26396”\n\nstrings:\n\n// Almond RAT\n\n$pdbPath0 = “C:\\\\Users\\\\Window 10 C\\\\Desktop\\\\COMPLETED WORK\\\\” ascii\n\n$pdbPath1 = “stdrcl\\\\stdrcl\\\\obj\\\\Release\\\\stdrcl.pdb”\n\n// found by Qi Anxin Threat Intellingence Center\n\n// reference: https://mp.weixin.qq.com/s/8j_rHA7gdMxY1_X8alj8Zg\n\n$pdbPath2 = “g:\\\\Projects\\\\cn_stinker_34318\\\\”\n\n$pdbPath3 = “renewedstink\\\\renewedstink\\\\obj\\\\Release\\\\stimulies.pdb”\n\ncondition:\n\nuint16(0) == 0x5a4d\n\nand any of ($pdbPath*)\n\n}\n\n## Indicators of Compromise\n\n### Samples\n\nAll of the samples mentioned in this report have been made available through the public Malware repositories MalwareBazaar and\nMalshare for verification and further research.\n\n**Maldoc**\n\nFilename: Repair of different csoc cstc, china supplied system – BNS BIJOY.xlsx\n\nMD5: 1bf615946ad9ea7b5a282a8529641bf6\n\nSHA1: 358867f105b517624806c3315c5426803f7c42a7\n\nSHA256: bc03923e3cc2895893571068fd20dd0bc626764d06a009b91dac27982e40a085\n\n\n-----\n\n**Extracted oleObject:**\n\nMD5: a1d9e1dccfbba118d52f95ec6cc7c943\n\nSHA1: 8efa4d5574a0c80733e9824ec146521385a68424\n\nSHA256: 0c7158f9fc2093caf5ea1e34d8b8fffce0780ffd25191fac9c9b52c3208bc450\n\n**ZxxZ / Muuy Downloader**\n\nFilename: vc\n\nMD5: 6e4b4eb701f3410ebfb5925db32b25dc\n\nSHA1: c330ef43bbee001296c6c120cf68e4c90d078d9c\n\nSHA256: 91ddbe011f1129c186849cd4c84cf7848f20f74bf512362b3283d1ad93be3e42\n\n**Almond RAT**\n\nFilename: stdrcl.exe\n\nMD5: 71e1cfb5e5a515cea2c3537b78325abf\n\nSHA1: bcc9e35c28430264575831e851182eca7219116f\n\nSHA256: 55901c2d5489d6ac5a0671971d29a31f4cdfa2e03d56e18c1585d78547a26396\n\n**Modified assembly with decrypted strings:**\n\nMD5: d58e6f93bd1eb81eacc965d530709246\n\nSHA1: a47aec515f303ae7f427d98fc69fe828fa9c6ec6\n\nSHA256: d83cb82be250604b2089a1198cedd553aaa5e8838b82011d6999bc6431935691\n\n### Host-based Indicators\n\n# File paths associated with the Downloader\n\nC:\\$Drw\\dsw\n\nC:\\$Drw\\fsutil.exe\n\n# Almond RAT Mutex\n\nsaebamini.com SingletonApp\n\n### Network-based Indicators\n\nemshedulersvc[.]com/vc/vc\n\nm.huandocimama[.]com\n\ndiyefosterfeeds[.]com\n\n91.195.240[.]103\n\n194.36.191[.]196\n\n162.0.232[.]109\n\n64.44.131[.]109\n\n## MITRE ATT&CK TTPs\n\n### First stage – Initial Compromise\n\n**Tactic** **Technique** **Description** **Observable**\n\n\nResource\nDevelopment\n\n\nStage Capabilities:\nUpload Malware\n(T1608.001\n\n\nHosters: HostSailor, Namecheap\n\nFilename: Repair of different csoc cstc,\nchina supplied system – BNS\nBIJOY.xlsx\n\nOLE file with stream named: Equation\nNative\n\n\nInitial Access Phishing:\nSpearphishing\nAttachment\n(T1566.001)\n\nExecution Exploitation for Client\nExecution (T1203)\n\n\nBitter is using legitimate webhosting services\nto stage malware\n\nBitter is distributing malicious Microsoft Office\ndocuments with military / naval lures\n\nExploitation of the Microsoft Office Equation\nEditor via a Memory Corruption (CVE-20180798)\n\n\n-----\n\n### Intermediate Stage Downloading additional tooling\n\n**Tactic** **Technique** **Description** **Observable**\n\n\nDefense\nEvasion\n\n\nObfuscated\nFiles or\nInformation\n(T1027)\n\n\nExample string: vSCbLAsUGPVbnCW\n\nRequested URL:\nhxxp://m.huandocimama[.]com/JvQKLsTYuMe/xAexyBbnDxW/profiles.php?\nprofiles=<USERNAME_HOSTNAME>\n\nCommand: UPLOAD*filepath, File naming scheme: yyyyMMddhhmmss_filename\n\n\nReconnaissance Gather\nVictim Host\nInformation:\nSoftware\n(T1592.002)\n\n\nCommand and\nControl\n\n\nIngress Tool\nTransfer\n(T1105)\n\n\nImportant strings in\nZxxZ/MuuyDownloader\nexecutables are XOR\nencrypted\n\nZxxZ/MuuyDownloader\nfingerprints the\nattacked system\n\nZxxZ/MuuyDownloader\nis capable of\ndownloading files from\nthe C2 onto the system\n\n\n### Final stage – Espionage\n\n**Tactic** **Technique** **Description** **Observable**\n\n\nDefense\nEvasion\n\n\nObfuscated Files or\nInformation (T1027)\n\n\nImportant strings in Almond\nRAT executables are encrypted\nusing AES-CBC\n\nAlmond RAT fingerprints the\nattacked system\n\nAlmond RAT communicates\nwith the C2 via a non-standard\nport\n\nAlmond RAT is capable of\ndownloading files from the C2\nonto the system\n\nAlmond RAT is capable of\nuploading accessible files from\nthe system to a C2 server\n\nAlmond RAT is using a 1024\nbyte buffer for C2\ncommunication and Exfiltration\n\nAlmond RAT is capable of\nenumerating directories and\nfiles\n\nAlmond RAT is capable of\ndeleting accessible files on the\nsystem\n\n\nEncrypted:\n4CjJPGsn5qweV7CEMgTzXtD/2oxaXj/Cddgsjl8tJGU=,\nDecrypted: 64.44.131.109\n\nGenerated Fingerprint:\nHOSTNAME*MAC_ADDRESS*OS_VERSION\n\nNetwork port: 33638/tcp\n\nCommand: UPLOAD*filepath, Network Port: 33638/tcp\n\nCommand: DOWNLOAD*filepath, Network Port:\n33638/tcp\n\nNetwork buffer: 1024 bytes\n\nCommand: DIR*\n\nCommand: DELETE*filepath\n\n\nReconnaissance Gather Victim Host\nInformation:\nSoftware\n(T1592.002)\n\n\nCommand and\nControl\n\nCommand and\nControl\n\n\nNon-Standard Port\n(T1571)\n\nIngress Tool\nTransfer (T1105)\n\n\nExfiltration Exfiltration over C2\nChannel (T1041)\n\nExfiltration Data Transfer Size\nLimits (T1030)\n\nDiscovery File and Directory\nDiscovery (T1083)\n\nImpact Data Destruction\n(T1485)\n\nfazitanfang\n\n## Conclusion\n\n\nThe Bitter threat group is continues to use their exploitation approach in Asia with themed lures and internal changes to avoid existing\ndetections. To protect from such attacks network and endpoint detection and response measures should be put into place and\ncommonly exploited software like Microsoft Office should be patched regularly. We will continue to monitor this threat group and report\non changes in their Tactics, Techniques and Procedures. fazitende\n\n**Thank you for taking the time to read our analysis report! If you would like to stay up to date with our research consider**\n**following us on** **[Twitter.](https://twitter.com/SI_FalconTeam)**\n\n\n-----\n\n[SECUINFRA Falcon Team Author](https://www.secuinfra.com/en/author/si_falcon_tm/)\n\nDigital Forensics & Incident Response Experten\n\nNeben den Tätigkeiten, die im Rahmen von Kundenaufträgen zu verantworten sind, kümmert sich das Falcon Team um den Betrieb,\ndie Weiterentwicklung und die Forschung zu diversen Projekten und Themen im DF/IR Bereich.\n\nDas SECUINFRA Falcon Team ist auf die Bereiche Digital Forensics (DF) und Incident Response (IR) spezialisiert. Hierzu zählen die\nklassische Host-Based Forensik, aber auch Themen wie Malware Analysis oder Compromise Assessment gehören zu diesem\nAufgabengebiet.\nNeben den Tätigkeiten, die im Rahmen von Kundenaufträgen zu verantworten sind, kümmert sich das Falcon Team\num den Betrieb, die Weiterentwicklung und die Forschung zu diversen Projekten und Themen im DF/IR Bereich. Dazu zählen\nbeispielsweise Threat Intelligence oder die Erstellung von Erkennungsregeln auf Basis von Yara.\nDigital Forensics & Incident Response experts\n\nIn addition to the activities that are the responsibility of customer orders, the Falcon team takes care of the operation, further\ndevelopment and research of various projects and topics in the DF/IR area.\n\nThe SECUINFRA Falcon Team is specialized in the areas of Digital Forensics (DF) and Incident Response (IR). This includes classic\nhost-based forensics, but also topics such as malware analysis or compromise assessment.\nIn addition to the activities for which we\nare responsible within the scope of customer orders, the Falcon team is also responsible for the operation, further development and\nresearch of various projects and topics in the DF/IR area. These include, for example, threat intelligence or the creation of detection\nrules based on Yara.\n- [All posts](https://www.secuinfra.com/en/author/si_falcon_tm/)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-07-05 - Whatever floats your Boat – Bitter APT continues to target Bangladesh.pdf"
    ],
    "report_names": [
        "2022-07-05 - Whatever floats your Boat – Bitter APT continues to target Bangladesh.pdf"
    ],
    "threat_actors": [
        {
            "id": "b740943a-da51-4133-855b-df29822531ea",
            "created_at": "2022-10-25T15:50:23.604126Z",
            "updated_at": "2025-03-27T02:00:55.505366Z",
            "deleted_at": null,
            "main_name": "Equation",
            "aliases": [
                "Equation"
            ],
            "source_name": "MITRE:Equation",
            "tools": null,
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "bf6cb670-bb69-473f-a220-97ac713fd081",
            "created_at": "2022-10-25T16:07:23.395205Z",
            "updated_at": "2025-03-27T02:02:09.777308Z",
            "deleted_at": null,
            "main_name": "Bitter",
            "aliases": [
                "T-APT-17",
                "TA397"
            ],
            "source_name": "ETDA:Bitter",
            "tools": [
                "Artra Downloader",
                "ArtraDownloader",
                "Bitter RAT",
                "BitterRAT",
                "Dracarys"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "655f7d0b-7ea6-4950-b272-969ab7c27a4b",
            "created_at": "2022-10-27T08:27:13.133291Z",
            "updated_at": "2025-03-27T02:00:55.490812Z",
            "deleted_at": null,
            "main_name": "BITTER",
            "aliases": [
                "T-APT-17"
            ],
            "source_name": "MITRE:BITTER",
            "tools": [
                "ZxxZ"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "1a76ed30-4daf-4817-98ae-87c667364464",
            "created_at": "2022-10-25T16:47:55.891029Z",
            "updated_at": "2025-03-27T02:05:17.408867Z",
            "deleted_at": null,
            "main_name": "IRON LIBERTY",
            "aliases": [
                "ATK6 ",
                "BROMINE ",
                "CASTLE ",
                "Crouching Yeti ",
                "DYMALLOY ",
                "Dragonfly ",
                "Energetic Bear / Berserk Bear ",
                "Ghost Blizzard ",
                "TEMP.Isotope ",
                "TG-4192 ",
                "ALLANITE "
            ],
            "source_name": "Secureworks:IRON LIBERTY",
            "tools": [
                " Ddex Loader",
                " Havex",
                " Karagany",
                " Loek",
                " MCMD",
                " Sysmain",
                " xfrost",
                "ClientX"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "acd789fa-d488-47f3-b9cc-fdb18b1fa375",
            "created_at": "2023-01-06T13:46:39.332092Z",
            "updated_at": "2025-03-27T02:00:03.053179Z",
            "deleted_at": null,
            "main_name": "HAZY TIGER",
            "aliases": [
                "Orange Yali",
                "TA397",
                "T-APT-17",
                "APT-C-08"
            ],
            "source_name": "MISPGALAXY:HAZY TIGER",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "86fd71d3-06dc-4b73-b038-cedea7b83bac",
            "created_at": "2022-10-25T16:07:23.330793Z",
            "updated_at": "2025-03-27T02:02:09.740703Z",
            "deleted_at": null,
            "main_name": "APT 17",
            "aliases": [
                "APT 17",
                "ATK 2",
                "Beijing Group",
                "Bronze Keystone",
                "Deputy Dog",
                "Elderwood",
                "Elderwood Gang",
                "Operation Aurora",
                "Operation DeputyDog",
                "Operation Ephemeral Hydra",
                "Operation RAT Cook",
                "SIG22",
                "Sneaky Panda",
                "TEMP.Avengers",
                "TG-8153",
                "Tailgater Team"
            ],
            "source_name": "ETDA:APT 17",
            "tools": [
                "9002 RAT",
                "AGENT.ABQMR",
                "AGENT.AQUP.DROPPER",
                "AGENT.BMZA",
                "AGENT.GUNZ",
                "Agent.dhwf",
                "AngryRebel",
                "BlackCoffee",
                "Briba",
                "Chymine",
                "Comfoo",
                "Comfoo RAT",
                "Darkmoon",
                "DeputyDog",
                "Destroy RAT",
                "DestroyRAT",
                "Farfli",
                "Fexel",
                "Gen:Trojan.Heur.PT",
                "Gh0st RAT",
                "Ghost RAT",
                "Gresim",
                "HOMEUNIX",
                "HiKit",
                "HidraQ",
                "Homux",
                "Hydraq",
                "Jumpall",
                "Kaba",
                "Korplug",
                "Linfo",
                "MCRAT.A",
                "McRAT",
                "MdmBot",
                "Mdmbot.E",
                "Moudour",
                "Mydoor",
                "Naid",
                "Nerex",
                "PCRat",
                "PNGRAT",
                "Pasam",
                "PlugX",
                "Poison Ivy",
                "RedDelta",
                "Roarur",
                "SPIVY",
                "Sogu",
                "TIGERPLUG",
                "TVT",
                "Thoper",
                "Trojan.Naid",
                "Vasport",
                "Wiarp",
                "Xamtrav",
                "Zox",
                "ZoxPNG",
                "ZoxRPC",
                "gresim",
                "pivy",
                "poisonivy"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535843,
    "ts_updated_at": 1743041809,
    "ts_creation_date": 1658168647,
    "ts_modification_date": 1658168647,
    "files": {
        "pdf": "https://archive.orkl.eu/71b6734b949dc8789414d5ff2dc28602641a17f3.pdf",
        "text": "https://archive.orkl.eu/71b6734b949dc8789414d5ff2dc28602641a17f3.txt",
        "img": "https://archive.orkl.eu/71b6734b949dc8789414d5ff2dc28602641a17f3.jpg"
    }
}