{
    "id": "47db8ed5-5045-40d6-a35e-a8ec18dd2860",
    "created_at": "2023-01-12T15:02:58.588143Z",
    "updated_at": "2025-03-27T02:09:18.076823Z",
    "deleted_at": null,
    "sha1_hash": "559129d9adfc28453fb7a848ebb4c7fcccbcd6d3",
    "title": "2020-10-28 - Hacks for sale- inside the Buer Loader malware-as-a-service",
    "authors": "",
    "file_creation_date": "2022-05-28T01:22:24Z",
    "file_modification_date": "2022-05-28T01:22:24Z",
    "file_size": 1404681,
    "plain_text": "# Hacks for sale: inside the Buer Loader malware-as-a- service\n\n**[news.sophos.com/en-us/2020/10/28/hacks-for-sale-inside-the-buer-loader-malware-as-a-service/](https://news.sophos.com/en-us/2020/10/28/hacks-for-sale-inside-the-buer-loader-malware-as-a-service/)**\n\nSean Gallagher October 28, 2020\n\nDuring our investigation of a Ryuk attack in September 2020, we found the Ryuk actors had\nused a relatively new method for gaining initial access: a malware dropper called Buer. The\nSeptember attack was part of a low-volume spear phishing attack tracked by Sophos. Over\nthe next month, it evolved into a much larger spam campaign, carrying Buer as well as a\nnumber of other types of “loader” malware, as the Ryuk operators sought to ramp up their\nattacks.\n\nFirst introduced in August of 2019, Buer is a malware-as-a-service offering that is used to\ndeliver whatever package the service customer desires, providing initial compromise of\ntargets’ Windows PCs and allowing them to establish a digital beachhead for further\nmalicious activity. Buer has previously been tied to banking trojan attacks and other malware\ndeployments—and now, apparently, has been embraced by ransomware operators. In many\n[ways, Buer is positioned as an alternative to Emotet and Trickbot’s emerging Bazar loader](https://news.sophos.com/en-us/2019/03/05/emotet-101-stage-4-command-and-control/)\n(which both use similar behaviors to deploy).\n\n## Full-service bots\n\n\n-----\n\nBuer was first advertised in a forum post on August 20, 2019 under the title “Modular Buer\nLoader”, described by its developers as “a new modular bot…written in pure C” with\ncommand and control (C&C) server code written in .NET Core MVC (which can be run on\nLinux servers). For $350 (plus whatever fee a third-party guarantor takes), a cybercriminal\ncan buy a custom loader and access to the C&C panel from a single IP address—with a $25\ncharge to change that address. Buer’s developers limit users to two addresses per account.\n\nThe bot code, compiled for each user specific to a download, has an advertised size\nbetween 22 and 26 kilobytes—though the sample we looked at was about 40 kilobytes after\nbeing unpacked from its dropper. The bot can be configured for execution either as a 32-bit\nWindows executable or as a DLL.\n\nThe C&C can be used to track the number of successful downloads in a campaign, and to\nassign tasks to bots by filters such as the country they’re in, the “bitness of the operating\nsystem” (32 or 64 bit), the number of processors on the infected machine and the level of\npermissions obtained by the bot. Bots detected to be operating within the Commonwealth of\nIndependent States will be shut down—which is a common behavior of malware developed\nin the ex-USSR region, as an attempt to avoid attention from local authorities.\n\nThe “file manager in the command and control “panel” for the Buer loader bot. Files can be\nuploaded for distribution here—the maximum size is 28 megabytes.\n\n\n-----\n\nThe Buer panel tracks installations by operating system, CPU, “bitness” (32 or 64), activity,\nand which geographic region they’re in based on localization settings and other\nfingerprinting.\nTasks can be scheduled to run for a specific amount of time, or suspended upon command,\nwith telemetry for the task sent back to the panel. The panel can also be used to deploy\nupdates to bots, including (at least based on the advertisement) deployment of modules, with\nprebuilt modules to be added “over time” as part of the service. And of course, setup\nconsulting and technical support are provided.\n\n## Prize inside every doc\n\n\n-----\n\nBuer loader attack flow.\nSophos’ Rapid Response team discovered a sample of Buer at the root cause of a\nSeptember Ryuk attack. The loader was delivered by a malicious document stored on\nGoogle Docs, which required the victim to enable scripted content to activate—a behavior\nsimilar to Emotet and other loader attacks via malicious spam emails but leveraging cloud\nstorage to make forensic analysis more difficult.\n\n\n-----\n\nWe collected other messages from the same campaign in Sophos spam traps during the\nsame period. The messages all used Google Docs files, and were sent using a popular\ncommercial email distribution service—further obscuring the source and the link associated\nwith the malicious document.\n\nAn example of the initial run of Buer bot distributing spear phishes.\nThe payload of that malicious document was named print_document.exe. Like other Buer\ndropper samples we’ve analyzed, it was a digitally signed binary, using a stolen and nowrevoked certificate issued by DigiCert to “NEEDCODE SP Z O O,” a Polish software\ndeveloper, issued on September 17, 2020. The dropper was built using modified code from a\nMicrosoft sample application for image capture, AcquireTest, using the code’s function for\n“file enumeration” to delete and drop code.\n\nThe dropper does a number of things to ensure proper delivery. It first checks for the\npresence of a debugger to evade forensic analysis, and then checks language and\nlocalization settings to determine the geographic region of the system being attacked. If the\nsettings match a CIS country, it will exit without depositing the malware. Otherwise, the\ndropper then dumps the Buer bot in memory and executes it.\n\nIntriguingly, the Buer Loader and Ryuk ransomware uses same shellcode loader to execute\nthe unpacked malware code in memory:\n\n\n-----\n\nBuer loader shell code…\n\n\n-----\n\nand Ryuk loader shell code.\nThis may not be an indication of shared authorship; the developers may have simply used\nthe same sample code as their source.\n\nUpon launch, the Buer bot does a number of things to set up shop. The bot executes two\nsets of PowerShell commands—one to bypass execution policies to allow PowerShell\ncommands executed by the bot to go through without warnings (Set-ExecutionPolicy\nBypass), and another (add-mppreference -exclusionpath) to make changes to Windows\nDefender’s exclusion list—concealing files it downloads from Windows’ built-in malware\nprotection.\n\nBuer queries the Windows Registry for the value of \\Microsoft\\Cryptography\\MachineGuid to\nget the unique identifier for the infected machine. And the bot calls home, interacting with\nthe command and control server (in this case, 104[.]248.83.13) through a series of secure\nHTTP “POST” and “GET” messages.\n\n\n-----\n\nThen there s the loader part of what Buer does. The files packaged to be dropped by Buer\nare retrieved from a designated source and dropped in a folder created in the\nC:\\ProgramData\\ directory—the directory name is created programmatically and varies with\ndeployments. In the September attack, Buer was used to deploy a Cobalt Strike beacon to\nthe infected computer, which was then in turn used to exploit the network and launch a Ryuk\nattack.\n\n## Mixing it up\n\nThe malicious spam campaign that resulted in the Buer loader and Ryuk ransomware\ninfections evolved at the end of September, as we observed the actors behind it shift the\nsame tactics away from low volume on SendGrid to mail sent through Internet hosting\nproviders—predominantly through a single Russian ISP. Then in October, the volume of\nspam rose dramatically—shifting away from Google Docs (as Google shut down the old files\nfor terms of service violations) to another commercial email and file delivery service.\n\nA\n\nsomewhat less targeted spam message with a link to a malicious document stored by\nConstant Contact.\nIn the last two phases, while the tactics remained similar and other hallmarks suggested the\nspam actor was the same, multiple types of “dropper” malware were deployed as\nattachments. In addition to Buer, samples of Bazar and ZLoader were also found, with\ndelivery payloads varying. For one Bazar loader payload, the attackers used a passwordprotected Excel spreadsheet. During the same timeframe, Bazar and ZLoader were also\nknown to be involved in Ryuk attacks.\n\nIt’s clear that Ryuk is back, and that the actors behind it are evolving their methods for initial\ncompromise, using multiple loader bots to achieve initial access. It’s not clear if the same\nactor is behind all of these attacks, using multiple malware-as-a-service platforms to deliver\nRyuk, or if there are multiple Ryuk actors. But the similarity in techniques across these\n\n\n-----\n\ncampaigns suggests that there is at least coordination between them: they use targeted\nemails with cloud-based malicious documents and a lure to spur immediate action (often\nrelated to wages or taxes).\n\nThe best mitigation for these attacks is to reinforce training on phishing attacks. While these\nmalicious emails are targeted, they are usually awkwardly worded and use the target’s name\nin odd ways. Careful reading of the email will tip off most educated users. But these attacks\nare growing in sophistication, and even well-trained users may eventually click on the wrong\nlink in an email if spam detection doesn’t catch them first.\n\nSophos detects and blocks Buer both with custom detections (Troj/BuerLd-A) and machine\nlearning, and detects the spear phishing messages as spam. Indicators of compromise\n[associated with Buer Loader can be found on SophosLabs’ GitHub.](https://github.com/sophoslabs/IoCs/blob/master/Troj-BuerLd-A.csv)\n\n**Sophos would like to acknowledge the contributions of Peter Mackenzie, Elida Leite,**\n**Syed Shahram and Bill Kearny of the Sophos Rapid Response team, and Anand**\n**Ajjan, Brett Cove and Gabor Szappanos of SophosLabs for their contributions to this**\n**report**\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2020/2020-10-28 - Hacks for sale- inside the Buer Loader malware-as-a-service.pdf"
    ],
    "report_names": [
        "2020-10-28 - Hacks for sale- inside the Buer Loader malware-as-a-service.pdf"
    ],
    "threat_actors": [
        {
            "id": "26a04131-2b8c-4e5d-8f38-5c58b86f5e7f",
            "created_at": "2022-10-25T15:50:23.579601Z",
            "updated_at": "2025-03-27T02:00:55.50292Z",
            "deleted_at": null,
            "main_name": "TA551",
            "aliases": [
                "TA551",
                "GOLD CABIN",
                "Shathak"
            ],
            "source_name": "MITRE:TA551",
            "tools": [
                "QakBot",
                "IcedID",
                "Valak",
                "Ursnif"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "04e34cab-3ee4-4f06-a6f6-5cdd7eccfd68",
            "created_at": "2022-10-25T16:07:24.578896Z",
            "updated_at": "2025-03-27T02:02:10.286803Z",
            "deleted_at": null,
            "main_name": "TA551",
            "aliases": [
                "Gold Cabin",
                "Monster Libra",
                "Shathak",
                "TA551"
            ],
            "source_name": "ETDA:TA551",
            "tools": [
                "BokBot",
                "CRM",
                "Gozi",
                "Gozi CRM",
                "IceID",
                "IcedID",
                "Papras",
                "Snifula",
                "Ursnif",
                "Valak",
                "Valek"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "610a7295-3139-4f34-8cec-b3da40add480",
            "created_at": "2023-01-06T13:46:38.608142Z",
            "updated_at": "2025-03-27T02:00:02.87217Z",
            "deleted_at": null,
            "main_name": "Cobalt",
            "aliases": [
                "Cobalt Gang",
                "GOLD KINGSWOOD",
                "COBALT SPIDER",
                "G0080",
                "Mule Libra",
                "Cobalt Group"
            ],
            "source_name": "MISPGALAXY:Cobalt",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "90f216f2-4897-46fc-bb76-3acae9d112ca",
            "created_at": "2023-01-06T13:46:39.248936Z",
            "updated_at": "2025-03-27T02:00:03.031127Z",
            "deleted_at": null,
            "main_name": "GOLD CABIN",
            "aliases": [
                "Shakthak",
                "TA551",
                "ATK236",
                "G0127",
                "Monster Libra"
            ],
            "source_name": "MISPGALAXY:GOLD CABIN",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673535778,
    "ts_updated_at": 1743041358,
    "ts_creation_date": 1653700944,
    "ts_modification_date": 1653700944,
    "files": {
        "pdf": "https://archive.orkl.eu/559129d9adfc28453fb7a848ebb4c7fcccbcd6d3.pdf",
        "text": "https://archive.orkl.eu/559129d9adfc28453fb7a848ebb4c7fcccbcd6d3.txt",
        "img": "https://archive.orkl.eu/559129d9adfc28453fb7a848ebb4c7fcccbcd6d3.jpg"
    }
}