{
    "id": "022ec466-b225-4290-85a7-8e0a6ec438bd",
    "created_at": "2023-01-12T15:05:58.743934Z",
    "updated_at": "2025-03-27T02:13:09.683436Z",
    "deleted_at": null,
    "sha1_hash": "37db72170e8a9c6491beb17302a1d90914cdffe1",
    "title": "2019-08-12 - Recent Cloud Atlas activity",
    "authors": "",
    "file_creation_date": "2022-09-01T10:19:26Z",
    "file_modification_date": "2022-09-01T10:19:26Z",
    "file_size": 567500,
    "plain_text": "# Recent Cloud Atlas activity\n\n**securelist.com/recent-cloud-atlas-activity/92016**\n\nAuthors\n\nGReAT\n\nAlso known as Inception, Cloud Atlas is an actor that has a long history of cyber-espionage\noperations targeting industries and governmental entities. We first reported Cloud Atlas in\n2014 and we’ve been following its activities ever since.\n\nFrom the beginning of 2019 until July, we have been able to identify different spear-phishing\ncampaigns related to this threat actor mostly focused on Russia, Central Asia and regions of\nUkraine with ongoing military conflicts.\n\n\n-----\n\n**Countries targeted by Cloud Atlas recently**\n\nCloud Atlas hasn’t changed its TTPs (Tactic Tools and Procedures) since 2018 and is still\nrelying on its effective existing tactics and malware in order to compromise high value\ntargets.\n\nThe Windows branch of the Cloud Atlas intrusion set still uses spear-phishing emails to\ntarget high profile victims. These emails are crafted with Office documents that use malicious\nremote templates – allowlisted per victims – hosted on remote servers. We described one of\nthe techniques used by Cloud Atlas in 2017 and our colleagues at Palo Alto Networks also\nwrote about it in November 2018.\n\nPreviously, Cloud Atlas dropped its “validator” implant named “PowerShower” directly, after\nexploiting the Microsoft Equation vulnerability (CVE-2017-11882) mixed with CVE-20180802. During recent months, we have seen a new infection chain, involving a polymorphic\nHTA, a new and polymorphic VBS implant aimed at executing PowerShower, and the Cloud\nAtlas second stage modular backdoor that we disclosed five years ago in our first blogpost\nabout them and which remains unchanged.\n\n## Let’s meet PowerShower\n\nPowerShower, named and previously disclosed by Palo Alto Networks in their blogspot (see\nabove), is a malicious piece of PowerShell designed to receive PowerShell and VBS\nmodules to execute on the local computer. This malware has been used since October 2018\nby Cloud Atlas as a validator and now as a second stage. The differences in the two versions\nreside mostly in anti-forensics features for the validator version of PowerShower.\n\n\n-----\n\nThe PowerShower backdoor – even in its later developments – takes three commands:\n\n**Command** **Description**\n\n\n0x80 (Ascii\n“P”)\n\n0x79 (Ascii\n“O”)\n\n\nIt is the first byte of the magic PK. The implant will save the received content\nas a ZIP archive under %TEMP%\\PG.zip.\n\nIt is the first byte of “On resume error”. The implant saves the received\ncontent as a VBS script under “%APPDATA%\\Microsoft\\Word\\[A-Za-z]\n{4}.vbs” and executes it by using Wscript.exe\n\n\nDefault If the first byte doesn’t match 0x80 or 0x79, the content is saved as an XML\nfile under “%TEMP%\\temp.xml”. After that, the script loads the content of the\nfile, parses the XML to get the PowerShell commands to execute, decodes\nthem from Base64 and invokes IEX.\n\nAfter executing the commands, the script deletes “%TEMP%\\temp.xml” and\nsends the content of “%TEMP%\\pass.txt” to the C2 via an HTTP POST\nrequest.\n\nA few modules deployed by PowerShower have been seen in the wild, such as:\n\nA PowerShell document stealer module which uses 7zip (present in the received\nPG.zip) to pack and exfiltrate *.txt, *.pdf, *.xls or *.doc documents smaller than 5MB\nmodified during the last two days;\nA reconnaissance module which retrieves a list of the active processes, the current\nuser and the current Windows domain. Interestingly, this feature is present in\nPowerShower but the condition leading to the execution of that feature is never met in\nthe recent versions of PowerShower;\nA password stealer module which uses the opensource tool LaZagne to retrieve\npasswords from the infected system.\n\nWe haven’t yet seen a VBS module dropped by this implant, but we think that one of the\nVBS scripts dropped by PowerShower is a dropper of the group’s second stage backdoor\n[documented in our article back in 2014.](https://securelist.com/cloud-atlas-redoctober-apt-is-back-in-style/68083/)\n\n\n-----\n\n## And his new friend, VBShower\n\nDuring its recent campaigns, Cloud Atlas used a new “polymorphic” infection chain relying no\nmore on PowerShower directly after infection, but executing a polymorphic HTA hosted on a\nremote server, which is used to drop three different files on the local system.\n\nA backdoor that we name VBShower which is polymorphic and replaces PowerShower\nas a validator;\nA tiny launcher for VBShower ;\nA file computed by the HTA which contains contextual data such as the current user,\ndomain, computer name and a list of active processes.\n\nThis “polymorphic” infection chain allows the attacker to try to prevent IoC-based defence, as\neach code is unique by victim so it can’t be searched via file hash on the host.\n\nThe VBShower backdoor has the same philosophy of the validator version of PowerShower.\nIts aim is to complicate forensic analysis by trying to delete all the files contained in\n“%APPDATA%\\..\\Local\\Temporary Internet Files\\Content.Word” and “%APPDATA%\\..\\Local\nSettings\\Temporary Internet Files\\Content.Word\\”.\n\n\n-----\n\nOnce these files have been deleted and its persistence is achieved in the registry, VBShower\nsends the context file computed by the HTA to the remote server and tries to get via HTTP a\nVBS script to execute from the remote server every hour.\n\nAt the time of writing, two VBS files have been seen pushed to the target computer by\nVBShower. The first one is an installer for PowerShower and the second one is an installer\nfor the Cloud Atlas second stage modular backdoor which communicates to a cloud storage\nservice via Webdav.\n\n## Final words\n\nCloud Atlas remains very prolific in Eastern Europe and Central Asia. The actor’s massive\nspear-phishing campaigns continue to use its simple but effective methods in order to\ncompromise its targets.\n\nUnlike many other intrusion sets, Cloud Atlas hasn’t chosen to use open source implants\nduring its recent campaigns, in order to be less discriminating. More interestingly, this\nintrusion set hasn’t changed its modular backdoor, even [five years after its discovery.](https://securelist.com/cloud-atlas-redoctober-apt-is-back-in-style/68083/)\n\n## IoCs\n\n**Some emails used by the attackers**\n\ninfocentre.gov@mail.ru\nmiddleeasteye@asia.com\nsimbf2019@mail.ru\nworld_overview@politician.com\ninfocentre.gov@bk.ru\n\n**VBShower registry persistence**\n\nKey : HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\[a-f0-9A-F]{8}\nValue : wscript //B “%APPDATA%\\[A-Za-z]{5}.vbs”\n\n**VBShower paths**\n\n%APPDATA%\\[A-Za-z]{5}.vbs.dat\n%APPDATA%\\[A-Za-z]{5}.vbs\n%APPDATA%\\[A-Za-z]{5}.mds\n\n**VBShower C2s**\n\n176.31.59.232\n144.217.174.57\n\n\n-----\n\nRecent Cloud Atlas activity\n\nYour email address will not be published. Required fields are marked *\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2019/2019-08-12 - Recent Cloud Atlas activity.pdf"
    ],
    "report_names": [
        "2019-08-12 - Recent Cloud Atlas activity.pdf"
    ],
    "threat_actors": [
        {
            "id": "b740943a-da51-4133-855b-df29822531ea",
            "created_at": "2022-10-25T15:50:23.604126Z",
            "updated_at": "2025-03-27T02:00:55.505366Z",
            "deleted_at": null,
            "main_name": "Equation",
            "aliases": [
                "Equation"
            ],
            "source_name": "MITRE:Equation",
            "tools": null,
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "02c9f3f6-5d10-456b-9e63-750286048149",
            "created_at": "2022-10-25T16:07:23.722884Z",
            "updated_at": "2025-03-27T02:02:09.945869Z",
            "deleted_at": null,
            "main_name": "Inception Framework",
            "aliases": [
                "ATK 116",
                "Blue Odin",
                "Clean Ursa",
                "Cloud Atlas",
                "Inception Framework",
                "Operation Cloud Atlas",
                "Operation RedOctober",
                "The Rocra"
            ],
            "source_name": "ETDA:Inception Framework",
            "tools": [
                "Lastacloud",
                "PowerShower",
                "VBShower"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "77b28afd-8187-4917-a453-1d5a279cb5e4",
            "created_at": "2022-10-25T15:50:23.768278Z",
            "updated_at": "2025-03-27T02:00:55.5423Z",
            "deleted_at": null,
            "main_name": "Inception",
            "aliases": [
                "Inception Framework",
                "Cloud Atlas"
            ],
            "source_name": "MITRE:Inception",
            "tools": [
                "PowerShower",
                "VBShower",
                "LaZagne"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "04a7ebaa-ebb1-4971-b513-a0c86886d932",
            "created_at": "2023-01-06T13:46:38.784965Z",
            "updated_at": "2025-03-27T02:00:02.91817Z",
            "deleted_at": null,
            "main_name": "Inception Framework",
            "aliases": [
                "ATK116",
                "Blue Odin",
                "Clean Ursa",
                "Cloud Atlas",
                "G0100"
            ],
            "source_name": "MISPGALAXY:Inception Framework",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673535958,
    "ts_updated_at": 1743041589,
    "ts_creation_date": 1662027566,
    "ts_modification_date": 1662027566,
    "files": {
        "pdf": "https://archive.orkl.eu/37db72170e8a9c6491beb17302a1d90914cdffe1.pdf",
        "text": "https://archive.orkl.eu/37db72170e8a9c6491beb17302a1d90914cdffe1.txt",
        "img": "https://archive.orkl.eu/37db72170e8a9c6491beb17302a1d90914cdffe1.jpg"
    }
}