{
    "id": "43314f40-ebdd-41e2-a1bd-0d8bbad23485",
    "created_at": "2022-10-25T16:48:21.715299Z",
    "updated_at": "2025-03-27T02:16:16.763994Z",
    "deleted_at": null,
    "sha1_hash": "ad2ea5b4d217a569389d450ff52aa167961484cb",
    "title": "",
    "authors": "",
    "file_creation_date": "2020-11-30T04:19:04Z",
    "file_modification_date": "2020-11-30T04:19:04Z",
    "file_size": 3774094,
    "plain_text": "# Investigation with a twist: an accidental APT attack and averted data destruction\n\n**[ptsecurity.com/ww-en/analytics/pt-esc-threat-intelligence/incident-response-polar-ransomware-apt27](https://www.ptsecurity.com/ww-en/analytics/pt-esc-threat-intelligence/incident-response-polar-ransomware-apt27/)**\n\nIn late April 2020, a client invited the CSIRT incident response team at the Positive\nTechnologies Expert Security Center (PT ESC) to investigate a network compromise that\nresulted in encryption of files on servers and employee workstations.\n\n[We initially assumed that this was yet another attack on corporate networks with a common](https://www.bleepingcomputer.com/news/security/lg-electronics-allegedly-hit-by-maze-ransomware-attack/)\nvariety of ransomware. However, what we found was different: this intrusion was the work of\na well-known Asian APT group implicated in cyberespionage against government targets.\nThe initial successful compromise had taken place two years prior.\n\nIn this article, we will share the results of our investigation of this targeted attack, which\nstarted with the compromise of a foreign office. Ultimately, we succeeded in bringing the\ninfrastructure back to a secure condition and reversing the damage that had been done.\n\n## Sequence of events\n\nMass encryption of files on the client's infrastructure and a ransom demand formed the\nstarting point of the investigation. A large number of damaged files is itself a very visible\nattack indicator that enabled detecting the intrusion. Retrospective analysis showed that the\nclient's infrastructure had been compromised not three or four days before (or even a few\n\n\n-----\n\nhours before, as often happens in mass attacks), but in early 2018. What's more, the initial\ninfection was of a foreign office of the client. Then a subsequent breach of the head office\nback home.\n\nWe believe that the initial entry point to the foreign office's network was a vulnerable server\non the network perimeter. Exploitation in February 2018 enabled the attackers to gain initial\n[access and then persistence, with the help of the ChinaChopper and TwoFace web shells.](https://en.wikipedia.org/wiki/China_Chopper)\n\n[The attackers used NBTScan for network reconnaissance and PsExec for lateral movement.](http://unixwiz.net/tools/nbtscan.html)\n[They obtained credentials for pivoting with Mimikatz. In some cases, we were able to detect](https://github.com/gentilkiwi/mimikatz/releases)\nmemory dumps of the lsass process that had been archived and uploaded. Because use of\nMimikatz was likely blocked by endpoint security software, the attackers were forced to run\nbruteforcing offline. Another method was to scan hosts for so-called Eternal* SMB\n[vulnerabilities with SMBTouch and then, where possible, run the EternalBlue exploit and](https://github.com/3gstudent/Smbtouch-Scanner)\n[infect the computer. On the hosts of presumably greatest interest, the SysUpdate and](https://www.nccgroup.com/uk/about-us/newsroom-and-events/blogs/2018/may/emissary-panda-a-potential-new-malicious-tool/)\n[HyperBro backdoors were installed for reliable persistence and access.](https://unit42.paloaltonetworks.com/emissary-panda-attacks-middle-east-government-sharepoint-servers/)\n\nOne unexpected result of the compromise was cryptocurrency mining at both the foreign\noffice and headquarters. Such activity remained unnoticed for one and a half years. During\nthis time the attackers only maintained their access abilities by periodically obtaining new\naccounts or building tunnel chains. Our belief is that by early 2020, the attackers had lost\ntheir access (for reasons unknown to us). We can see use of web shells on the foreign office's\nservers on February 9, 2020. Subsequent actions were very similar to what had happened\ntwo years earlier. By using the tools already described, the attackers obtained the credentials\nof a domain administration at headquarters. This time, they deleted OS logs and stopped\nShadow Copy services, complicating subsequent incident analysis.\n\n\n-----\n\nFor the finale, on April 29, 2020, the account of the compromised domain admin was used to\npush Polar ransomware to computers and run it, encrypting user files and demanding a\nransom. While our specialists were assisting the client in May 2020, the attackers made yet\nanother attempt to regain control of infrastructure with the help of web shells that were still\nin place on the network of the headquarters and office, but this time to no success.\n\nHere we have provided a timeline to better show the sequence of events.\n\n\n-----\n\n-----\n\n-----\n\n-----\n\n-----\n\nCSIRT's objectives included recovering the client's data, which included key information\nbelonging to different departments. We performed analysis of the encryption malware and\nwere able to recover the lost files.\n\n## Polar ransomware\n\nThe method used to run the ransomware is classic and, indeed, characteristic of certain Asian\ngroups. Three files are sent to the victim's computer:\n\nGDFInstall.exe (MD5: 13435101240f78367123ef01a938c560) is a legitimate computer\ngame component signed by Ubisoft.\n\nGameuxInstallHelper.dll (MD5: 1fd8402275d42e7389f0d28b9537db0f) is a .NET DLL\nlibrary (compiled on April 29, 2020) imported when GDFInstall.exe is run.\n\n\n-----\n\nThis component is not actually legitimate, however: attacker code is executed after the\nGameExplorerInstallW symbol is exported. This frequently used technique of loading\n[malicious code in the context of a legitimate application is known as DLL hijacking.](https://attack.mitre.org/techniques/T1574/001/)\n\n\n-----\n\nThe file c:\\programdata\\Sysurl.Hex is read (after being copied from\nc:\\windows\\system32\\Sysurl.Hex, if absent) and then simple XOR decrypted with key\nABCSCDFRWFFSDJJHGYUOIj. The result is decoded with Base64, yielding a PE file that is\nloaded and run in memory with .NET. The payload and intermediate library are deleted\nbefore completion. Deletion occurs in the standard (insecure) way, which enables recovering\nthe data if disk access is stopped in time and the information has not been overwritten.\n\nSysurl.Hex is an encrypted copy of the Polar ransomware.\n\nThis payload call sequence (in which a legitimate application loads a malicious library, which\nin turn decrypts a third component and passes control to it) is very commonly used to run\n[the PlugX backdoor, which is widely seen among such Asian APT groups as APT10, APT41,](https://attack.mitre.org/software/S0013/)\n\n\n-----\n\nTA459, and Bronze Union.\n\nLet's consider the decrypted and decoded version of the ransomware (MD5:\n841980b4ae02a4e6520ab834deee241b) in greater detail.\n\nBased on how GameuxInstallHelper.dll is launched, we quickly can guess that this file, too, is\nan executable file compiled with .NET. The compilation date is April 9, 2020. The code entry\npoint is the Actions method of the Encode class in the Polar name space (which is the name\nwe have used for the malware family).\n\nThe malware deletes system event logs and shadow copies by performing the following\ncommands:\n```\ndism /online /enable-feature /featurename:NetFx3\nvssadmin.exe Delete Shadows /All /Quiet\nbcdedit /set {default} recoveryenabled no\nwmic shadowcopy delete\nwbadmin delete backup\nwbadmin delete systemstatebackup -keepversions:0\nbcdedit /set {default} bootstatuspolicy ignoreallfailures\nbcdedit /set {default} recoveryenabled no\nwevtutil.exe clear-log Application\nwevtutil.exe clear-log Security\nwevtutil.exe clear-log System\nwbadmin delete catalog -quiet\nwbadmin delete catalog -quiet\nwbadmin delete systemstatebackup\n\n```\nIt then looks for and stops the following processes:\n\n\nagntsvc.exe\nagntsvc.exe\nagntsvc.exe\nagntsvc.exe\ndbeng50.exe\ndbsnmp.exe\nencsvc.exe\nexcel.exe\nfirefoxconfig.exe\ninfopath.exe\nisqlplussvc.exe\n\n\nmsaccess.exe\nmsftesql.exe\nmspub.exe\nmydesktopqos.exe\nmydesktopservice.exe\nmysqld-nt.exe\nmysqld-opt.exe\nmysqld.exe\nnotepad++.exe\nnotepad.exe\nocautoupds.exe\n\n\nocomm.exe\nocssd.exe\nonenote.exe\noracle.exe\noutlook.exe\npowerpnt.exe\nsqbcoreservice.exe\nsqlagent.exe\nsqlbrowser.exe\nsqlservr.exe\nsqlwriter.exe\n\n\nsteam.exe\nsynctime.exe\ntbirdconfig.exe\nthebat.exe\nthebat64.exe\nthunderbird.exe\nvisio.exe\nwinword.exe\nwordpad.exe\nxfssvccon.exe\n\n\nThen the malware gets a list of connected disks and starts recursive traversal of directories,\nskipping a few of them:\n\nC:\\Windows\n\n\n-----\n\nC:\\Program Files\nC:\\Program Files (x86)\nC:\\ProgramData\nC:\\Python\n$SysReset\n$Recycle.Bin\n$RECYCLE.BIN\n\nIt cares only about files with the following extensions:\n\n\n.3dm\n.3ds\n.3g2\n.3gp\n.7z\n.accdb\n.ai\n.aif\n.asf\n.asp\n.aspx\n.avi\n.bak\n.bin\n.bmp\n.c\n.cbr\n.cer\n\n\n.cfm\n.class\n.cpp\n.crdownload\n.cs\n.csr\n.css\n.csv\n.cue\n.dat\n.db\n.dbf\n.dds\n.deb\n.dmg\n.dmp\n.doc\n.docx\n\n\n.dtd\n.dwg\n.dxf\n.eps\n.fla\n.flv\n.ged\n.gif\n.gz\n.h\n.html\n.ics\n.iff\n.indd\n.ini\n.iso\n.java\n.jpg\n\n\n.js\n.jsp\n.key\n.keychain\n.log\n.lua\n.m\n.m3u\n.m4a\n.m4v\n.max\n.mdb\n.mdf\n.mid\n.mov\n.mp3\n.mp4\n.mpa\n\n\n.mpg\n.msg\n.msi\n.obj\n.odt\n.pages\n.part\n.pct\n.pdb\n.pdf\n.php\n.pkg\n.pl\n.png\n.pps\n.ppt\n.pptx\n.ps\n\n\n.psd\n.py\n.rar\n.rm\n.rpm\n.rss\n.rtf\n.sdf\n.sh\n.sitx\n.sln\n.sql\n.srt\n.svg\n.swf\n.swift\n.tar\n.tar.gz\n\n\n.tax2014\n.tax2015\n.tex\n.tga\n.thm\n.tif\n.tiff\n.tmp\n.toast\n.torrent\n.txt\n.vb\n.vcd\n.vcf\n.vcxproj\n.vob\n.wav\n.wma\n\n\n.wmv\n.wpd\n.wps\n.xcodeproj\n.xhtml\n.xlr\n.xls\n.xlsx\n.xml\n.yuv\n.zip\n.zipx\n\n\nBefore starting encryption, the malware creates what we will call a base encryption key\nconsisting of eight randomly chosen characters from the following alphabet:\nabcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890*!=&?&/\n\nTwo approaches to encryption are used, depending on the file size. Each approach involves a\ndifferent encryption key. The base encryption key is used in both approaches, however.\n\nFirst we will look at the approach for encryption of files with size less than 64,052,000 bytes\n(approximately 61 MB). The intermediate password is the SHA-256 hash sum of the base\nencryption key. It is identical for all files and is used with a hard-coded salt and 1,000\niterations to generate the encryption key and initialization vector. Each key is encrypted with\nAES-CBC. The .locked extension is added to encrypted files.\n\n\n-----\n\nLarger files are encrypted in a different way. In this case, the 16-byte encryption key is\nformed by taking the first 8 bytes from the base encryption key and the remaining 8 bytes\n[from an additional hard-coded array. This is followed by a custom implementation of AES-](http://read.pudn.com/downloads415/sourcecode/crypt/1761761/AES.cs__.htm)\nECB. Blocks of 16 bytes are encrypted, with the next 12,800 bytes skipped. The result is that\nonly small parts of the file—not the entire file—are encrypted. This method was likely to\nchosen to speed up the encryption process. Encrypted files have the .cryptd extension.\n\n\n-----\n\nNote that the result is creation of a new file (where the encrypted stream is written). The\noriginal file is insecurely deleted. Therefore, the original files can also be recovered from\nunallocated disk space if they have not yet been overwritten with fresh information.\n\n\n-----\n\nIn each directory containing encrypted files, a file named\nreadme_contact_alex.dali@iran.ir.htm is created with the following contents:\n```\nYour companies cyber defense systems have been weighed, measured and have been found\nwanting!!!\nThe breach is a result of grave neglect of security protocols\nAll of your computers have been corrupted with Polar malware that has encrypted your\nfiles.\nWe ensure that the only way to retrieve your data swiftly and securely is with our\nsoftware.\nRestoration of your data requires a private key which only we possess\nDon't waste your time and money purchasing third party software, without the private\nkey they are useless.\nIt is critical that you don't restart or shutdown your computer.\nThis may lead to irreversible damage to your data and you may not be able to turn\nyour computer back on.\nTo confirm that our software works email to us 2 files from random computers you will\nget them decrypted.\nreadme_contact_alex.dali@iran.ir.htm contain encrypted session keys we need in order\nto be able to decrypt your files.\nThe softwares price will include a guarantee that your company will never be\ninconvenienced by us.\nYou will also receive a consultation on how to improve your companies cyber security\nIf you want to purchase our software to restore your data contact us at:\nPt34Jarmys@protonmail.com\nalex.dali@iran.ir\nWe can only show you the door. You're the one who has to walk through it.\nYour personal installation key:*REDACTED*\n\n```\n[The text of the ransom demand resembles that used by MegaCortex ransomware.](https://id-ransomware.blogspot.com/2019/05/megacortex-ransomware.html)\n\n\n-----\n\nThe ransom demand contains a modified version of the base encryption key. This version is\nderived by encrypting the base encryption key with RSA (with a hard-coded 1024-byte public\nkey) and encoding it in Base64.\n\nAfter file encryption is completed, the malware writes an image (contained in executable file\nresources) to disk at the path c:\\programdata\\Rs.bmp and sets it as the desktop background.\n\nThe malware subsequently repeats the same procedure for deleting system event logs and\nshadow copies that it performed at the start. Then it sends an HTTP POST request with the\nname of the victim's computer to a server at\nhxxp://www.therockbrazil.com.br/assinaturas/logs.php.\n\n## How we decrypted the files\n\n\n-----\n\nReaders following the chain of encryption steps have likely noticed that the security of this\nwhole encryption system depends on what we have called the base encryption key. Its value\nis encrypted with RSA-1024 and placed in the ransom demand. Currently, there are no\nmethods that are both cheap and fast for factoring a key of such size. So we tried another\ntactic.\n\nRemember that the base key is generated by taking eight random characters from the\nalphabet quoted earlier. Here is how the implementation works:\n\nThe Random function is called once, without any arguments. This call returns a random\nnumber, the seed for pseudorandom generation of which is taken from the value of the\nEnvironment.TickCount variable. This variable is 4 bytes and stores the number of\nmilliseconds since the operating system started.\n\nSo to decode the files, all we need to know is the uptime (how long the computer has been\nturned on) as of when the ransomware ran. But how simple is it to calculate?\n\nMost of the affected computers had not only been disconnected from the corporate network,\nbut turned off for analysis of the hard drive contents. Due to this, the uptime of the\ncomputers could not be known. The operating system logs contain timestamps for shutdown\nand power on. But in this case, the ransomware destroys these logs twice. So we were unable\nto find any clues pointing at possible values of uptime on the affected computers themselves.\n\n[Fortunately, however, SCCM was used on the client infrastructure, with client-side agents](https://en.wikipedia.org/wiki/Microsoft_System_Center_Configuration_Manager)\nrunning on all the encrypted computers. The information we needed was stored centrally and\nhad not been tampered with: all we needed was some trial-and-error to choose the right\nvalues.\n\n\n-----\n\nNow that we had relatively precise uptime values, we needed to determine when the\nransomware had run. Remember that at the end, the malware deletes the intermediate DLL\nlibrary and encrypted ransomware, but not the legitimate executable file whose process is\nused for performing the malicious actions. In other words, the time at which this file\nappeared on the system should be the approximate time when the ransomware ran, to within\nseveral seconds. We succeeded in bruteforcing the exact value of the base encryption key in\nabout a minute on an ordinary workstation (on the order of a few tens of thousands of\niterations). We could then decrypt the remaining files. In a few cases, we had a tougher time\nbruteforcing the key at first. The reason was that the timezones had been set incorrectly.\nWith this realization, we were able to conquer this issue as well.\n\n## Attribution\n\nWe mentioned the SysUpdate and HyperBro backdoors from the attackers' toolkit. These are\nsomewhat esoteric Remote Access Trojans used by the APT27 group (also known as Bronze\nUnion, LuckyMouse, Emissary Panda, or Iron Tiger). The group likely has Asian roots, with\nactivity since at least 2010. The group focuses its attention on government targets in the\ndefense and energy industries, as well as aerospace and manufacturing. Most commonly, the\noriginal attack vector is a compromise of the victim's web servers by exploiting\nvulnerabilities, bruteforcing credentials, or taking advantage of web server\nmisconfigurations. Despite the similarities in tactics, techniques, and procedures (TTPs) and\nuse of a telltale toolkit, some of the team's researchers are skeptical about attribution of the\nattacks to APT27.\n\n1. Choice of target\n\nMedia companies had never been of interest for APT27. This is consistent with the findings\nof our incident investigation: the attackers did not try to access private information on the\ntarget infrastructure, instead only running software for direct financial gain.\n\n2. Cryptocurrency mining and ransomware\n\nThis is atypical and, moreover, ill-suited software that can quickly attract attention and\nwreck any plans for long-term cyberspying. The URL address to which the ransomware\n\"phones home\" upon completing its work does not have anything in common with APT27\n[network infrastructure. Of course, some groups (such as Lazarus and Winnti) combine](https://www.fireeye.com/blog/threat-research/2019/08/apt41-dual-espionage-and-cyber-crime-operation.html)\n\n\n-----\n\ncyberspying with direct financial motivations, so perhaps APT27 is broadening its previously\nlimited range of interests. Or, as an alternative, the group has reached an agreement with\nother attackers for use of their software in return for a part of the proceeds. In favor of\nattribution of Polar to APT27, we can note the sequence of payload, execution, and naming:\nthe encrypted SysUpdate backdoor is often named sys.bin.url and the Polar ransomware was\nnamed Sysurl.Hex, in a rather similar way. However, this could also be a false flag.\n\n3. Automation in 2018 and 2020\n\nHere is the script used to automatically install a cryptocurrency miner on a list of computers\nin 2018:\n```\n@echo off\nfor /f %%i in (c:\\programdata\\list.txt) do (\nnet use \\\\%%i\\c$ \"*\" /u:*\\administrator\ncopy c:\\programdata\\vmnat.exe \\\\%%i\\c$\\windows\\system32\\vmnat.exe\nSCHTASKS /Create /S %%i /u *\\administrator /p \"*\" /tn * /tr \"cmd.exe /c start\nc:\\windows\\system32\\vmnat.exe\" /sc onstart /RU SYSTEM\nschtasks /run /S %%i /u *\\administrator /p \"*\" /tn *\nnet use \\\\%%i\\c$ /del\nnet use * /del /Y\n)\ndel vmnat.exe\ndel list.txt\ndel work.bat\n\n```\nAnd this is the script used to automatically delete the ransomware from a list of computers in\n2020:\n```\n@echo off\nfor /f %%i in (c:\\programdata\\list.txt) do (\n  net use \\\\%%i\\c$ \"*\" /u:*\\*\n  if not errorlevel 1 (\n   del \\\\%%i\\c$\\programdata\\GameuxInstallHelper.dll\n   del \\\\%%i\\c$\\programdata\\GDFInstall.exe\n   del \\\\%%i\\c$\\programdata\\Sysurl.Hex\n   net use \\\\%%i\\c$ /del\n )ELSE (\n  echo not access %%i >> c:\\programdata\\no_access.txt\n )\n)\n\n```\n(We replaced sensitive information with '*')\n\n\n-----\n\nThe scripts show certain similarities in structure and have the same loop of file lines at the\nsame path. On the other hand, the indentation, script tasks, and file naming are different.\nSome of the commands are too general to tell, since they could have been found in online\nsearch results and reused.\n\n4. Bodies of the SysUpdate and HyperBro backdoors\n\nWe were not able in some cases to confirm the presence of a given backdoor based on the\nbody of the Trojan itself. We identified the HyperBro backdoor, which had been used in\n2018, based on the distinctive file name combined with other confirmed tools. We confirmed\nthe SysUpdate backdoor, used in 2020, by looking at the C2 address and backdoor body in\n[the process dump memory that had been uploaded to VirusTotal during investigation from](https://www.virustotal.com/gui/file/b645ff7ca1bce2a9449bcf7378895022170ec8adba62ccf528e453667da2210a/details)\nan organization not linked to our client.\n\nTaken together, these similarities certainly point to APT27 as a culprit, but are not entirely\nconclusive. Therefore we leave it to the reader to choose whether to concur regarding\ninvolvement by APT27.\n\n## Conclusion\n\nIn this article, we have described an APT27 attack on a media company. The cybercriminals\nobtained access to the company's headquarters by compromising an office in a foreign\ncountry. They maintained control of the infrastructure for two years. They used both publicly\navailable and custom-developed tools that had been seen previously. The hackers, while not\nchanging their TTPs, chose rather unusual software to monetize their attacks. Perhaps the\ncompromise of this client was an accident and this was merely an attempt to obtain at least\nsome benefit. User data was encrypted, after which a ransom demand was made. A mistake\nin the ransomware's cryptographic algorithms enabled us to recover the encrypted files. To\nour knowledge, the attackers did not obtain access to information of any value whatsoever,\nultimately leaving them with nothing to show for their efforts.\n\n**Authors: Denis Goydenko and Alexey Vishnyakov, Positive Technologies**\n\n## MITRE TTPs\n\n**Tactic** **ID** **Name**\n\nInitial Access T1190 Exploit Public-Facing Application\n\nT1199 Trusted Relationship\n\nExecution T1059 Command and Scripting Interpreter: Windows Command\nShell\n\n\n-----\n\n**Tactic** **ID** **Name**\n\nT1053 Scheduled Task/Job: Scheduled Task\n\nT1047 Windows Management Instrumentation\n\nPersistence T1547 Boot or Logon Autostart Execution: Registry Run Keys /\nStartup Folder\n\nT1574 Hijack Execution Flow: DLL Search Order Hijacking\n\nT1053 Scheduled Task/Job: Scheduled Task\n\nT1078 Valid Accounts: Domain Accounts\n\nT1078 Valid Accounts: Default Accounts\n\n\nPrivilege\nEscalation\n\n\nT1068 Exploitation for Privilege Escalation\n\n\nDefense Evasion T1140 Deobfuscate/Decode Files or Information\n\nT1070 Indicator Removal on Host: Clear Windows Event Logs\n\nT1070 Indicator Removal on Host: File Deletion\n\nT1070 Indicator Removal on Host: Timestomp\n\nCredential Access T1003 OS Credential Dumping: LSASS Memory\n\nDiscovery T1087 Account Discovery: Domain Account\n\nT1082 System Information Discovery\n\nT1049 System Network Connections Discovery\n\nLateral Movement T1210 Exploitation of Remote Services\n\nT1570 Lateral Tool Transfer\n\nT1021 Remote Services: SMB/Windows Admin Shares\n\nCollection T1560 Archive Collected Data: Archive via Utility\n\nT1005 Data from Local System\n\nT1119 Automated Collection\n\nT1039 Data from Network Shared Drive\n\n\nCommand and\nControl\n\n\nT1071 Application Layer Protocol: Web Protocols\n\n\n-----\n\n**Tactic** **ID** **Name**\n\nT1132 Data Encoding: Standard Encoding\n\nT1573 Encrypted Channel: Symmetric Cryptography\n\nExfiltration T1020 Automated Exfiltration\n\nT1041 Exfiltration Over C2 Channel\n\nImpact T1486 Data Encrypted for Impact\n\n## IOCs\n\nChinaChopper:\n\n2ce60073c09887f9e3a482097294e17d\n\n5bc0d6918e03a92f04b3dfc21b619c7f\n\n73717a2f9bfe19ccdad541bec1fa2b69\n\n82a8470534d74c9c5c0d84071eb0a703\n\nb89e96e2ea8dd6fdb438f7d5b8ecf60c\n\nTwoFace:\n\n581c331d41ef5f5df99ae0d16b2cebf0\n\nff2693903a1049984745e79381e9ed7e\n\nSysUpdate:\n\n3c1981991cce3b329902288bb2354728\n\n43a2c2fb8d52dc1835ac18516b13aff1\n\n4b5484e3de5c5a2e60fcee50d04183d6\n\nSysUpdate C&C:\n\n103.59.144[.]183\n\n95.179.189[.]33\n\nNBTScan:\n\nf01a9a2d1e31332ed36c1a4d2839f412\n\nSMBTouch:\n\nb50fff074764b3a29a00b245e4d0c863\n\nPsExec:\n\naeee996fd3484f28e5cd85fe26b6bdcd\n\nTermite:\n\ndc92496358b8e67568a35b861ba1804e39e3d36b\n\n\n-----\n\nDsquery:\n3583d7c971de148a1ffb3302d1510ef1\n\nEternalBlue:\n8c80dd97c37525927c1e549cb59bcbf3\n\nfrsocks:\nda0c13d834cafc010bec1afa2d76196ced71e661\n\nMimikatz:\n449da3d7405c2c79fa55bd7973096e28\n0078ff05c20689f40ea9cb8c47fcfb2e52cdc3a9\n\nBitMiner:\n5430039162e58c44f9a5941295b55fba\n\nPolar:\n841980b4ae02a4e6520ab834deee241b\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        }
    ],
    "references": [
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2020/2020.11.27.Twist_APT27/Investigation%20with%20a%20twist_%20an%20accidental%20APT%20attack%20and%20averted%20data%20destruction.pdf"
    ],
    "report_names": [
        "Investigation with a twist_ an accidental APT attack and averted data destruction"
    ],
    "threat_actors": [
        {
            "id": "0bf35542-9ebc-44a9-b319-b6df0bee4bac",
            "created_at": "2022-10-25T15:50:23.437853Z",
            "updated_at": "2025-03-27T02:00:55.468981Z",
            "deleted_at": null,
            "main_name": "TA459",
            "aliases": [
                "TA459"
            ],
            "source_name": "MITRE:TA459",
            "tools": [
                "gh0st RAT",
                "NetTraveler",
                "PlugX",
                "ZeroT"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "d90307b6-14a9-4d0b-9156-89e453d6eb13",
            "created_at": "2022-10-25T16:07:23.773944Z",
            "updated_at": "2025-03-27T02:02:09.974695Z",
            "deleted_at": null,
            "main_name": "Lead",
            "aliases": [
                "Casper",
                "TG-3279"
            ],
            "source_name": "ETDA:Lead",
            "tools": [
                "Agentemis",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "RbDoor",
                "RibDoor",
                "Winnti",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "7041fcf5-b34d-47c3-be4c-3c40f243af89",
            "created_at": "2023-01-06T13:46:38.611261Z",
            "updated_at": "2025-03-27T02:00:02.872972Z",
            "deleted_at": null,
            "main_name": "TA459",
            "aliases": [
                "G0062"
            ],
            "source_name": "MISPGALAXY:TA459",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "f3b19931-3751-4ece-a235-15b397951dc2",
            "created_at": "2022-10-25T16:07:23.889537Z",
            "updated_at": "2025-03-27T02:02:10.015565Z",
            "deleted_at": null,
            "main_name": "Nazar",
            "aliases": [
                "SIG37"
            ],
            "source_name": "ETDA:Nazar",
            "tools": [
                "Distribute.exe",
                "EYService",
                "GpUpdates.exe",
                "Microolap Packet Sniffer",
                "TCPDUMP for Windows"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "ec14074c-8517-40e1-b4d7-3897f1254487",
            "created_at": "2023-01-06T13:46:38.300905Z",
            "updated_at": "2025-03-27T02:00:02.799108Z",
            "deleted_at": null,
            "main_name": "APT10",
            "aliases": [
                "TA429",
                "STONE PANDA",
                "POTASSIUM",
                "Red Apollo",
                "HOGFISH",
                "Cloud Hopper",
                "BRONZE RIVERSIDE",
                "ATK41",
                "G0045",
                "Menupass Team",
                "happyyongzi",
                "CVNX",
                "Granite Taurus"
            ],
            "source_name": "MISPGALAXY:APT10",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "2f07a03f-eb1f-47c8-a8e9-a1a00f2ec253",
            "created_at": "2022-10-25T16:07:24.277669Z",
            "updated_at": "2025-03-27T02:02:10.157972Z",
            "deleted_at": null,
            "main_name": "TA428",
            "aliases": [
                "Operation LagTime IT",
                "Operation StealthyTrident",
                "ThunderCats"
            ],
            "source_name": "ETDA:TA428",
            "tools": [
                "8.t Dropper",
                "8.t RTF exploit builder",
                "8t_dropper",
                "Agent.dhwf",
                "Albaniiutas",
                "BlueTraveller",
                "Chymine",
                "Cotx RAT",
                "CoughingDown",
                "Darkmoon",
                "Destroy RAT",
                "DestroyRAT",
                "Gen:Trojan.Heur.PT",
                "Kaba",
                "Korplug",
                "LuckyBack",
                "PhantomNet",
                "PlugX",
                "Poison Ivy",
                "RedDelta",
                "RoyalRoad",
                "SManager",
                "SPIVY",
                "Sogu",
                "TIGERPLUG",
                "TManger",
                "TVT",
                "Thoper",
                "Xamtrav",
                "pivy",
                "poisonivy"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "802552ac-1f16-4b85-8d78-76d683684124",
            "created_at": "2022-10-25T16:07:24.28032Z",
            "updated_at": "2025-03-27T02:02:10.158732Z",
            "deleted_at": null,
            "main_name": "TA459",
            "aliases": [],
            "source_name": "ETDA:TA459",
            "tools": [
                "Agent.dhwf",
                "AngryRebel",
                "Destroy RAT",
                "DestroyRAT",
                "Farfli",
                "Gh0st RAT",
                "Ghost RAT",
                "Kaba",
                "Korplug",
                "Moudour",
                "Mydoor",
                "NetTraveler",
                "Netfile",
                "PCRat",
                "PlugX",
                "RedDelta",
                "Sogu",
                "TIGERPLUG",
                "TVT",
                "Thoper",
                "TravNet",
                "Xamtrav",
                "ZeroT"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "ba3fff0c-3ba0-4855-9eeb-1af9ee18136a",
            "created_at": "2022-10-25T15:50:23.298889Z",
            "updated_at": "2025-03-27T02:00:55.433541Z",
            "deleted_at": null,
            "main_name": "menuPass",
            "aliases": [
                "menuPass",
                "POTASSIUM",
                "Stone Panda",
                "APT10",
                "Red Apollo",
                "CVNX",
                "HOGFISH",
                "BRONZE RIVERSIDE"
            ],
            "source_name": "MITRE:menuPass",
            "tools": [
                "certutil",
                "FYAnti",
                "UPPERCUT",
                "SNUGRIDE",
                "P8RAT",
                "RedLeaves",
                "SodaMaster",
                "pwdump",
                "Mimikatz",
                "PlugX",
                "PowerSploit",
                "ChChes",
                "cmd",
                "QuasarRAT",
                "AdFind",
                "Cobalt Strike",
                "PoisonIvy",
                "EvilGrab",
                "esentutl",
                "Impacket",
                "Ecipekac",
                "PsExec",
                "HUI Loader"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "e3492534-85a6-4c87-a754-5ae4a56d7c8c",
            "created_at": "2022-10-25T15:50:23.819113Z",
            "updated_at": "2025-03-27T02:00:55.552554Z",
            "deleted_at": null,
            "main_name": "Threat Group-3390",
            "aliases": [
                "Threat Group-3390",
                "Earth Smilodon",
                "TG-3390",
                "Emissary Panda",
                "BRONZE UNION",
                "APT27",
                "Iron Tiger",
                "LuckyMouse"
            ],
            "source_name": "MITRE:Threat Group-3390",
            "tools": [
                "Systeminfo",
                "gsecdump",
                "PlugX",
                "ASPXSpy",
                "Cobalt Strike",
                "Mimikatz",
                "Impacket",
                "gh0st RAT",
                "certutil",
                "China Chopper",
                "HTTPBrowser",
                "Tasklist",
                "netstat",
                "SysUpdate",
                "HyperBro",
                "ZxShell",
                "RCSession",
                "ipconfig",
                "Clambling",
                "pwdump",
                "NBTscan",
                "Pandora",
                "Windows Credential Editor"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "ba9fa308-a29a-4928-9c06-73aafec7624c",
            "created_at": "2024-05-01T02:03:07.981061Z",
            "updated_at": "2025-03-27T02:05:17.28602Z",
            "deleted_at": null,
            "main_name": "BRONZE RIVERSIDE",
            "aliases": [
                "CTG-5938 ",
                "CVNX ",
                "Hogfish ",
                "MenuPass ",
                "POTASSIUM ",
                "Red Apollo ",
                "Stone Panda ",
                "APT10 "
            ],
            "source_name": "Secureworks:BRONZE RIVERSIDE",
            "tools": [
                " ChChes",
                " Cobalt Strike",
                " PlugX",
                " PoisonIvy",
                " QuasarRAT",
                " QuasarRAT Loader",
                " RedLeaves",
                "ANEL"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "2c980ea7-04c4-4193-8535-52f87e66a96e",
            "created_at": "2024-05-01T02:03:07.994126Z",
            "updated_at": "2025-03-27T02:05:17.293799Z",
            "deleted_at": null,
            "main_name": "BRONZE UNION",
            "aliases": [
                "Budworm ",
                "Emissary Panda ",
                "Iron Tiger ",
                "Lucky Mouse ",
                "TG-3390 ",
                "Temp.Hippo ",
                "APT27 "
            ],
            "source_name": "Secureworks:BRONZE UNION",
            "tools": [
                " ASPXSpy",
                " China Chopper",
                " Enfal",
                " Gh0st RAT",
                " HttpBrowser",
                " Hunter",
                " HyperBro",
                " OwaAuth",
                " PlugX",
                " PoisonIvy",
                " Sysupdate",
                " ZxShell",
                "9002"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "4c68ccd0-caba-4189-9ead-86ac4c2d9b70",
            "created_at": "2024-05-01T02:03:07.930196Z",
            "updated_at": "2025-03-27T02:05:17.251237Z",
            "deleted_at": null,
            "main_name": "BRONZE ATLAS",
            "aliases": [
                "Axiom",
                "BARIUM ",
                "Blackfly ",
                "CTG-2633",
                "GREF",
                "Group 72 ",
                "Red Kelpie ",
                "TG-2633 ",
                "Wicked Panda ",
                "Winnti",
                "APT41 "
            ],
            "source_name": "Secureworks:BRONZE ATLAS",
            "tools": [
                " CCleaner v5.33 backdoor",
                " ChinaChopper",
                " Cobalt Strike",
                " Dicey MSDN",
                " ForkPlayground",
                " HUC Proxy Malware (Htran)",
                " Mimikatz",
                " PipeMon",
                " PlugX",
                " PortReuse",
                " Powershell Empire",
                " RCMD",
                " RbDoor",
                " SPEEDBOAT",
                " ShadowPad",
                " Sidewalk",
                " Speculoos",
                " TeamViewer",
                " Winnkit",
                " Winnti",
                " reg save",
                " vssadmin",
                "Acehash"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "c63ab035-f9f2-4723-959b-97a7b98b5942",
            "created_at": "2023-01-06T13:46:38.298354Z",
            "updated_at": "2025-03-27T02:00:02.798255Z",
            "deleted_at": null,
            "main_name": "APT27",
            "aliases": [
                "TG-3390",
                "EMISSARY PANDA",
                "TEMP.Hippo",
                "Budworm",
                "Group 35",
                "BRONZE UNION",
                "Lucky Mouse",
                "Iron Taurus",
                "GreedyTaotie",
                "Red Phoenix",
                "ZipToken",
                "Iron Tiger",
                "G0027",
                "Earth Smilodon"
            ],
            "source_name": "MISPGALAXY:APT27",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "5c13338b-eaed-429a-9437-f5015aa98276",
            "created_at": "2022-10-25T16:07:23.582715Z",
            "updated_at": "2025-03-27T02:02:09.875151Z",
            "deleted_at": null,
            "main_name": "Emissary Panda",
            "aliases": [
                "APT 27",
                "ATK 15",
                "Bronze Union",
                "Budworm",
                "Earth Smilodon",
                "Emissary Panda",
                "Group 35",
                "Iron Taurus",
                "Iron Tiger",
                "LuckyMouse",
                "Operation DRBControl",
                "Operation Iron Tiger",
                "Operation PZChao",
                "Operation SpoiledLegacy",
                "Operation StealthyTrident",
                "Red Phoenix",
                "TEMP.Hippo",
                "TG-3390",
                "ZipToken"
            ],
            "source_name": "ETDA:Emissary Panda",
            "tools": [
                "ASPXSpy",
                "ASPXTool",
                "Agent.dhwf",
                "AngryRebel",
                "Antak",
                "CHINACHOPPER",
                "China Chopper",
                "Destroy RAT",
                "DestroyRAT",
                "FOCUSFJORD",
                "Farfli",
                "Gh0st RAT",
                "Ghost RAT",
                "HTTPBrowser",
                "HTran",
                "HUC Packet Transmit Tool",
                "HighShell",
                "HttpBrowser RAT",
                "HttpDump",
                "HyperBro",
                "HyperSSL",
                "HyperShell",
                "Kaba",
                "Korplug",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "Mimikatz",
                "Moudour",
                "Mydoor",
                "Nishang",
                "OwaAuth",
                "PCRat",
                "PlugX",
                "ProcDump",
                "PsExec",
                "RedDelta",
                "SEASHARPEE",
                "Sensocode",
                "SinoChopper",
                "Sogu",
                "SysUpdate",
                "TIGERPLUG",
                "TVT",
                "Thoper",
                "Token Control",
                "TokenControl",
                "TwoFace",
                "WCE",
                "Windows Credential Editor",
                "Windows Credentials Editor",
                "Xamtrav",
                "ZXShell",
                "gsecdump",
                "luckyowa"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "4d5f939b-aea9-4a0e-8bff-003079a261ea",
            "created_at": "2023-01-06T13:46:39.04841Z",
            "updated_at": "2025-03-27T02:00:02.985296Z",
            "deleted_at": null,
            "main_name": "APT41",
            "aliases": [
                "G0096",
                "Grayfly",
                "BARIUM",
                "BRONZE ATLAS",
                "BRONZE EXPORT",
                "Red Kelpie",
                "HOODOO",
                "Brass Typhoon",
                "TA415",
                "WICKED SPIDER",
                "WICKED PANDA",
                "G0044",
                "Earth Baku"
            ],
            "source_name": "MISPGALAXY:APT41",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "578f8e62-2bb4-4ce4-a8b7-6c868fa29724",
            "created_at": "2022-10-25T16:07:24.344358Z",
            "updated_at": "2025-03-27T02:02:10.182282Z",
            "deleted_at": null,
            "main_name": "Tropic Trooper",
            "aliases": [
                "APT 23",
                "Bronze Hobart",
                "Earth Centaur",
                "KeyBoy",
                "Operation Tropic Trooper",
                "Pirate Panda",
                "Tropic Trooper"
            ],
            "source_name": "ETDA:Tropic Trooper",
            "tools": [
                "8.t Dropper",
                "8.t RTF exploit builder",
                "8t_dropper",
                "ByPassGodzilla",
                "CHINACHOPPER",
                "CREDRIVER",
                "China Chopper",
                "Chymine",
                "Darkmoon",
                "Gen:Trojan.Heur.PT",
                "KeyBoy",
                "Neo-reGeorg",
                "PCShare",
                "POISONPLUG.SHADOW",
                "Poison Ivy",
                "RoyalRoad",
                "SPIVY",
                "ShadowPad Winnti",
                "SinoChopper",
                "Swor",
                "TSSL",
                "USBferry",
                "W32/Seeav",
                "Winsloader",
                "XShellGhost",
                "Yahoyah",
                "fscan",
                "pivy",
                "poisonivy"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "e698860d-57e8-4780-b7c3-41e5a8314ec0",
            "created_at": "2022-10-25T15:50:23.287929Z",
            "updated_at": "2025-03-27T02:00:55.43005Z",
            "deleted_at": null,
            "main_name": "APT41",
            "aliases": [
                "APT41",
                "Wicked Panda",
                "Brass Typhoon",
                "BARIUM"
            ],
            "source_name": "MITRE:APT41",
            "tools": [
                "ASPXSpy",
                "BITSAdmin",
                "PlugX",
                "Impacket",
                "gh0st RAT",
                "netstat",
                "PowerSploit",
                "ZxShell",
                "KEYPLUG",
                "ipconfig",
                "sqlmap",
                "China Chopper",
                "ShadowPad",
                "MESSAGETAP",
                "Mimikatz",
                "certutil",
                "njRAT",
                "Cobalt Strike",
                "pwdump",
                "BLACKCOFFEE",
                "ROCKBOOT",
                "dsquery",
                "Winnti for Linux",
                "DUSTTRAP",
                "Derusbi",
                "ftp"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1666716501,
    "ts_updated_at": 1743041776,
    "ts_creation_date": 1606709944,
    "ts_modification_date": 1606709944,
    "files": {
        "pdf": "https://archive.orkl.eu/ad2ea5b4d217a569389d450ff52aa167961484cb.pdf",
        "text": "https://archive.orkl.eu/ad2ea5b4d217a569389d450ff52aa167961484cb.txt",
        "img": "https://archive.orkl.eu/ad2ea5b4d217a569389d450ff52aa167961484cb.jpg"
    }
}