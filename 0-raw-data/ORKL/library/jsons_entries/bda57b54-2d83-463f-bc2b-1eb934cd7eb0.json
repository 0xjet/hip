{
    "id": "bda57b54-2d83-463f-bc2b-1eb934cd7eb0",
    "created_at": "2023-01-12T14:59:57.441039Z",
    "updated_at": "2025-03-27T02:05:25.99998Z",
    "deleted_at": null,
    "sha1_hash": "9ae9020af675363a14f9cd552dcf0384e956e882",
    "title": "2020-10-01 - Threat Spotlight- New InterPlanetary Storm variant targeting IoT devices",
    "authors": "",
    "file_creation_date": "2022-05-29T00:56:37Z",
    "file_modification_date": "2022-05-29T00:56:37Z",
    "file_size": 387574,
    "plain_text": "# Threat Spotlight: New InterPlanetary Storm variant targeting IoT devices\n\n**[blog.barracuda.com/2020/10/01/threat-spotlight-new-interplanetary-storm-variant-iot/](https://blog.barracuda.com/2020/10/01/threat-spotlight-new-interplanetary-storm-variant-iot/)**\n\nOctober 1, 2020\n\n[The cybercriminal organization behind the InterPlanetary Storm malware has released a new variant into the wild, now](https://www.barracuda.com/glossary/malware?utm_source=blog&utm_medium=41955)\n[targeting Mac and Android devices in addition to Windows and Linux machines. The malware is building a botnet, which](https://www.barracuda.com/glossary/botnet?utm_source=blog&utm_medium=41955)\nBarracuda researchers estimate currently includes roughly 13,500 infected machines located in 84 different countries around\nthe world, and that number continues to grow.\n\nThe majority of the machines infected by the malware are located in Asia.\n\n59% of infected machines are in Hong Kong, South Korea, and Taiwan\n8% are in Russia and Ukraine\n6% are in Brazil\n5% are in the United States and Canada\n3% are in Sweden\n3% are in China\nAll other countries are 1% or less\n\nHere is a closer look at this evolving threat and solutions to help detect, block, and remediate the attacks.\n\n\n-----\n\n## Highlighted Threat\n\n**New variant of InterPlanetary Storm malware — This new malware variant gains access to machines by running a**\n[dictionary attack against SSH servers, similar to FritzFrog, another peer-to-peer (p2p) malware. It can also gain entry by](https://www.guardicore.com/2020/08/fritzfrog-p2p-botnet-infects-ssh-servers/)\naccessing open ADB (Android Debug Bridge) servers. The malware detects the CPU architecture and running OS of its\n[victims, and it can run on ARM-based machines, an architecture that is quite common with routers and other IoT devices.](https://blog.barracuda.com/iotsec)\n\n[The malware is called InterPlanetary Storm because it uses the InterPlanetary File System (IPFS) p2p network and its](https://docs.ipfs.io/)\n[underlying libp2p implementation. This allows infected nodes to communicate with each other directly or through other nodes](https://github.com/libp2p/go-libp2p)\n(i.e. relays).\n\nThe [first variant of Interplanetary Storm, which targeted Windows machines, was uncovered by researchers at Anomali in May](https://www.anomali.com/blog/the-interplanetary-storm-new-malware-in-wild-using-interplanetary-file-systems-ipfs-p2p-network)\n[2019, and a variant capable of attacking Linux machines was reported in June of this year. This new variant, which Barracuda](https://labs.bitdefender.com/2020/06/ssh-targeting-golang-bots-becoming-the-new-norm/)\n[researchers first detected in late August, is targeting IoT devices, such as TVs that run on Android operating systems, and](https://www.barracuda.com/glossary/iot-security?utm_source=blog&utm_medium=41955)\nLinux-based machines, such as routers with ill-configured SSH service.\n\nWhile the botnet that this malware is building does not have clear functionality yet, it gives the campaign operators a backdoor\n[into the infected devices so they can later be used for cryptomining,](https://blog.barracuda.com/2020/06/25/threat-spotlight-new-cryptominer-malware-variant/) [DDoS, or other large-scale attacks.](https://www.barracuda.com/glossary/ddos?utm_source=blog&utm_medium=41955)\n\n## The Details\n\n[This variant of InterPlanetary Storm is written in Go, uses the Go implementation of libp2p, and is packed with UPX. It spreads](https://github.com/libp2p/go-libp2p)\nusing SSH brute force and open ADB ports, and it serves malware files to other nodes in the network. The malware also\nenables reverse shell and can run bash shell.\n\nBarracuda researchers found several unique features designed to help the malware persist and protect it once it has infected\na machine.\n\n**It detects honeypots. The malware looks for the string “svr04” in the default shell prompt (PS1), which was used by the**\nCowrie honeypot before.\n**It auto updates. The malware compares the version of the running instance with the latest available version and will**\nupdate accordingly.\n**It will try to persist itself by installing a service (system/systemv), using a** [Go daemon package.](https://github.com/takama/daemon)\n\n\n-----\n\n**It kills other processes on the machine that pose a threat to the malware, such as debuggers and competing**\nmalware. It does so by looking for the following strings in process command lines:\n\n“/data/local/tmp”\n“rig”\n“xig”\n“debug”\n“trinity”\n“xchecker”\n“zypinstall”\n“startio”\n“startapp”\n“synctool”\n“ioservice”\n“start_”\n“com.ufo.miner”\n“com.google.android.nfcguard”\n“com.example.test”\n“com.example.test2”\n“saoas”\n“skhqwensw”\n\n## Interplanetary Storm announced keys\n\nThe malware’s backend advertises the following keys into the IPFS Distributed Hash Table (DHT). Infected nodes will then try\nto find peers that can provide the required services:\n\n**Key** **Purpose**\n\nrequeBOHCHIY2XRMYXI0HCSZA C2\n\nproxybackendH0DHVADBCIKQ4S7YOX4X Proxy backend\n\nweb-api:kYVhV8KQ0mA0rs9pHXoWpD File distribution backend\n\nEach infected node will advertise the key\n“fmi4kYtTp9789G3sCRgMZVG7D3uKalwtCuWw1j8LSPHQEGVBU5hfbNdnHvt3kyR1fYUlGNAO0zactmIMIZodsOha9tnfe25Xef1”\nin order to inform that it is part of the botnet. The ID of each infected machine will be generated once during initial infection\nand will be reused if the machine restarts or the malware updates.\n\nInfected nodes will also advertise keys in the form “stfadv:<cheksum>” in order to notify that the node can provide a file with\nthat checksum.\n\n## Communication protocols\n\nLibp2p applications handle incoming connection (streams) based on a logical address (i.e. unknown to the transport layer)\n[called protocol ID. By convention, protocol ids have a path-like structure, with a version number as the final component.](https://docs.libp2p.io/concepts/protocols/)\n\nThe following protocol IDs are being used by the malware:\n\n**Protocol ID** **Purpose** **Notes**\n\n\n/sbst/1.0.0 Used for\nspawning\nreverse shell\n\n/sfst/1.0.0 Used for file\ntransfer\n\n/sbpcp/1.0.0 Used for proxy,\nconnect to\nbackend serve\n\n\nHosted on nodes\n\nHosted on nodes, file checksum is used for the integrity of the served file\n\nHosted on backend servers\n\n\n-----\n\n/sbptp/1.0.0 Used for proxy.\nForward proxy\nchannel\n\n/sreque/1.0.0 Used for\nscanner\nqueue.\n\n## File distribution backend\n\n\nHosted on nodes\n\nHosted on nodes, commands from the c2 contain signature.\nMessages on this channel are serialized using JSON objects. Messages from the c2 will\nbe for either “brute-ssh”or “tcp-scan”, directing the node to scan for vulnerable machines.\nThe node will send be the results of these scans.\n\nThe “brute-ssh” messages from the c2 will include a list of Ips to attack along with the\ncredentials that should be used.\n\n\nThe file distribution servers can be discovered using the “web-api:kYVhV8KQ0mA0rs9pHXoWpD” key. The relevant peers\nimplement http over the libp2p protocol and serve the following URLs:\n\n**Path** **Method** **Description**\n\n/version GET Get the peer version\n\n/files/checksum?f=<file name> GET Get the current checksum of the file <file name>\n\n/files/seedrs-http?c=<checksum> GET Get a list of nodes capable of serving the file\n\nPOST /files/seedrs-http POST Add node info\n\n/nodes/ POST Add node info\n\n## IOC\n\nThe malware might drop some of the following files:\n\nstorm_android-amd64 d4e3102b859ebfda5a276b2ce6f226e27fdcdef5e693ee7742be863236e2374a\n\nstorm_android-386 9dab7f5ff2873389a4b0e68cb84978fc5907cd2579bd15a1d39e277f5d2fdc27\n\nstorm_android-arm64 16bcb323bfb464f7b1fcfb7530ecb06948305d8de658868d9c3c3c31f63146d4\n\nstorm_android-arm7 56c08693fdf92648bf203f5ff11b10b9dcfedb7c0513b55b8e2c0f03b209ec98\n\nstorm_linux-amd64 ab462d9d2a9a659489957f80d08ccb8a97bbc3c2744beab9574fda0f74bd1fe2\n\nStorm_linux-386 ba1e8d25cc380fdbbf4b5878a31e5ed692cfd2523f00ca41022e61f76654dd4f\n\nstorm_linux-arm64 50406ec7fa22c78e9b14da4ccc127a899db21f7a23b1916ba432900716e0db3d\n\nstorm_linux-arm7 a2f4c9f8841d5c02ffd4573c5c91f7711c7f56717ddb981f719256163be986e8\n\nstorm_darwin-amd64 4cd7c5ee322e55b1c1ae49f152629bfbdc2f395e9d8c57ce65dbb5d901f61ac1\n\n## How to protect against these attacks\n\nThere are a few important steps you can take to protect against this malware variant.\n\n**Properly configure SSH access on all devices. This means using keys instead of passwords, which will make access**\nmore secure. When password login is enabled and the service itself is accessible, the malware can exploit the illconfigured attack surface. This is an issue common with routers and IoT devices, so they make easy targets for this\nmalware.\n**Use a cloud security posture management tool to monitor SSH access control to eliminate any configuration**\nmistakes, which can be catastrophic. To provide secured access to shells if needed; instead of exposing the resource on\nthe internet, deploy an MFA-enabled VPN connection and segment your networks for the specific needs instead of\ngranting access to broad IP networks.\n\n\n-----\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2020/2020-10-01 - Threat Spotlight- New InterPlanetary Storm variant targeting IoT devices.pdf"
    ],
    "report_names": [
        "2020-10-01 - Threat Spotlight- New InterPlanetary Storm variant targeting IoT devices.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673535597,
    "ts_updated_at": 1743041125,
    "ts_creation_date": 1653785797,
    "ts_modification_date": 1653785797,
    "files": {
        "pdf": "https://archive.orkl.eu/9ae9020af675363a14f9cd552dcf0384e956e882.pdf",
        "text": "https://archive.orkl.eu/9ae9020af675363a14f9cd552dcf0384e956e882.txt",
        "img": "https://archive.orkl.eu/9ae9020af675363a14f9cd552dcf0384e956e882.jpg"
    }
}