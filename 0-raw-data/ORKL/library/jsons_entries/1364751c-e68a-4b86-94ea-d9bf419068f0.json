{
    "id": "1364751c-e68a-4b86-94ea-d9bf419068f0",
    "created_at": "2023-01-12T15:07:06.343724Z",
    "updated_at": "2025-03-27T02:10:49.363472Z",
    "deleted_at": null,
    "sha1_hash": "66dd51847a32d34bd66023e2d0b44ef23ea3fbd4",
    "title": "2020-06-15 - Magecart strikes amid Corona lockdown",
    "authors": "",
    "file_creation_date": "2022-05-28T22:05:00Z",
    "file_modification_date": "2022-05-28T22:05:00Z",
    "file_size": 254526,
    "plain_text": "# Lockdown: Stores closed, online stores hacked\n\n**sansec.io/research/magecart-corona-lockdown**\n\n15th June 2020\n\n[Web Skimming / Sansec Threat Research](https://sansec.io/research)\nLearn about new eCommerce hacks?\n\n\nJune 15, 2020\n\n\nReceive an alert whenever we discover new hacks or vulnerabilities that may affect\nyour online store.\n\nWhat is\n\nMagecart?\n\nAlso known as digital skimming, this crime has surged since 2015. Criminals steal\ncard data during online shopping. Who are behind these notorious hacks, how does it\nwork, and how have Magecart attacks evolved over time?\n\n[About Magecart](https://sansec.io/what-is-magecart)\n\nWhile an international retail chain closed its physical stores, attackers hacked its online\n[presence, Sansec research shows. Following common Magecart malpractice, payment](https://sansec.io/what-is-magecart)\nskimmers were injected and used to steal customer data and cards.\n\n\n-----\n\n## Timeline\n\nClaire’s, a fashion retailer, closed all of its 3000 brick & mortar stores worldwide on March\n20th. The next day, the domain `claires-assets.com was registered by an anonymous`\nparty:\n```\n  Domain Name: CLAIRES-ASSETS.COM\n  Registrar URL: http://www.namecheap.com\n  Creation Date: 2020-03-21T21:26:17Z\n  Registrant Name: WhoisGuard Protected\n\n```\nFor the next 4 weeks, Sansec did not observe suspicious activity. But in the last week of\n[April, malicious code was added to the online stores of Claire’s and its sister brand](https://www.claires.com/) [Icing.](https://www.icing.com/)\nThe injected code would intercept any customer information that was entered during\ncheckout, and send it to the `claires-assets.com server. The malware was present until`\nJune 13th.\n\n## Analysis of the __preloader skimmer\n\nThe malware was added to the (otherwise legitimate) `app.min.js file. This file is hosted`\non the store servers, so there is no “Supply Chain Attack” involved, and attackers have\nactually gained write access to the store code. Here is the heavily obfuscated copy:\n\nDecoding this reveals the following malware:\n\n\n-----\n\nThe skimmer attaches to the submit button of the checkout form. Upon clicking, the full\n“Demandware Checkout Form” is grabbed, serialized and base64 encoded. A temporary\nimage is added to the DOM with the `__preloader identifier. The image is located on the`\nserver as controlled by the attacker. Because all of the customer submitted data is\nappended to the image address, the attacker now has received the full payload.\nImmediately, the image element is removed.\n\nWe suspect that attackers have deliberately chosen an image file for exfiltration, because\nimage requests are not always monitored by security systems.\n\nA sample exfiltration request, containing the base64 encoded customer payment data,\nlooks like this:\n```\nhttps://claires-assets.com/on/demandware.static/-/Library-Sites-claireslibrary/default/dw2560e81d/images/claires-logo-desktop.svg?\npid=42243&dpath=2444.442334&cid=1&lid=2&_v=TeJobPVJqejblUk0Svys12UIjo7QCP&z=I4L7WODr9\n\n## Comments\n\n```\nThe timeline may indicate that attackers anticipated a surge in online traffic following the\nlockdown. The period between exfil domain registration and actual malware suggests that it\ntook the attackers a good 4 weeks to gain access to the store.\n\nThe actual root cause is as of yet unknown. Possible causes are leaked admin credentials,\nspearphishing of staff members and/or a compromised internal network.\n\n## Magecart & Salesforce Commerce Cloud\n\nThe affected stores are hosted on the Salesforce Commerce Cloud, previously known as\nDemandware. This is a hosted eCommerce platform that serves some of the biggest stores\nglobally. While the actual root cause is yet unknown, it is unlikely that the Salesforce\nplatform got breached or that Salesforce is responsible for this incident.\n\n\n-----\n\nSansec monitors all global eCommerce platforms for security incidents. Previously\n[compromised stores that use the Salesforce platform are UK outlet Sweaty Betty in](https://www.bleepingcomputer.com/news/security/uk-retailer-sweaty-betty-hacked-to-steal-customer-payment-info/)\n[November and Hanna Andersson in September.](https://www.classaction.org/news/hanna-andersson-salesforce.com-failed-to-adequately-protect-consumer-information-disclose-data-breach-suit-says)\n\n## Claire’s response\n\nAfter we notified them, Claire’s management has quickly responded. They let us know:\n\nClaire’s cares about protecting its customers’ data. On Friday, we identified an issue\nrelated to our e-commerce platform and took immediate action to investigate and\naddress it. Our investigation identified the unauthorized insertion of code to our ecommerce platform designed to obtain payment card data entered by customers\nduring the checkout process. We removed that code and have taken additional\nmeasures to reinforce the security of our platform. We are working diligently to\ndetermine the transactions that were involved so that we can notify those individuals.\nCards used in our retail stores were not affected by this issue. We have also notified\nthe payment card networks and law enforcement. It is always advisable for\ncardholders to monitor their account statements for unauthorized charges. The\npayment card network rules generally provide that cardholders are not responsible for\nunauthorized charges that are timely reported.\n\n[data-size=\"large\" > Follow @sansecio](https://twitter.com/sansecio)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2020/2020-06-15 - Magecart strikes amid Corona lockdown.pdf"
    ],
    "report_names": [
        "2020-06-15 - Magecart strikes amid Corona lockdown.pdf"
    ],
    "threat_actors": [
        {
            "id": "5a0483f5-09b3-4673-bb5a-56d41eaf91ed",
            "created_at": "2023-01-06T13:46:38.814104Z",
            "updated_at": "2025-03-27T02:00:02.925972Z",
            "deleted_at": null,
            "main_name": "MageCart",
            "aliases": [],
            "source_name": "MISPGALAXY:MageCart",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673536026,
    "ts_updated_at": 1743041449,
    "ts_creation_date": 1653775500,
    "ts_modification_date": 1653775500,
    "files": {
        "pdf": "https://archive.orkl.eu/66dd51847a32d34bd66023e2d0b44ef23ea3fbd4.pdf",
        "text": "https://archive.orkl.eu/66dd51847a32d34bd66023e2d0b44ef23ea3fbd4.txt",
        "img": "https://archive.orkl.eu/66dd51847a32d34bd66023e2d0b44ef23ea3fbd4.jpg"
    }
}