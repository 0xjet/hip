{
    "id": "7d5516d3-3761-4772-9996-463696b5f33e",
    "created_at": "2022-10-25T16:48:17.259776Z",
    "updated_at": "2025-03-27T02:17:23.301401Z",
    "deleted_at": null,
    "sha1_hash": "29d015e736a3012277f84f1b1bedc9bcac060648",
    "title": "Operation Blockbuster",
    "authors": "Novetta",
    "file_creation_date": "0001-01-01T00:00:00Z",
    "file_modification_date": "0001-01-01T00:00:00Z",
    "file_size": 5632677,
    "plain_text": "-----\n\nNovetta is an advanced analytics company that extracts value from the increasing volume,\nvariety and velocity of data. By mastering scale and speed, our advanced analytics software and\n\nsolutions deliver the actionable insights needed to help our customers detect threat and fraud,\n\nprotect high value networks, and improve the bottom line.\n\nFor innovative solutions for today’s most mission-critical, advanced analytics\n\nchallenges, contact Novetta:\n\nPhone: (571) 282-3000 | www.novetta.com\n\n**www.OperationBlockbuster.com**\n\n\n-----\n\n## Table of Contents\n\n###### Caveats ...........................................................................4\n\n 1. Executive Summary.................................................. 5\n\n 1.1 Key Takeaways.........................................................7\n\n 2. Operation Details..................................................... 8\n\n2.1 Hunting Method...........................................................................9\n\n###### 3. Lazarus Group Details ............................................11\n\n3.1 The SPE Attack and Conflicting Attribution................12\n\n3.2 Tactics, Techniques, and Procedures (TTPs)............14\n\n3.3 Targeting.......................................................................................16\n\n3.4 Links to Previous Reporting...............................................20\n\nThe Lazarus Group Timeline......................................................20\n\n###### 4. Malware Tooling..................................................... 24\n\n4.1 Naming Scheme........................................................................ 25\n\n# TOC\n\n4.2 Infrastructure..............................................................................27\n\n4.3 Code Relationships................................................................28\n\n4.3.1 Encryption................................................................................28\n\n4.3.2 Dynamic API Loading ......................................................34\n\n4.3.3 Network Functionality......................................................35\n\n4.3.4 Directory Hierarchy Verification\nand Generation..................................................................................46\n\n4.3.5 Secure File Delete................................................................47\n\n4.3.6 Target File Identification...................................................47\n\n###### 5. Conclusion...............................................................48\n\n5. Conclusion (continued)...........................................................49\n\nYARA Rules..........................................................................................50\n\nHashes....................................................................................................50\n\n###### 6. Appendix...................................................................51\n\n 7. Glossary of Terms.................................................. 55\n\n\n-----\n\n## Caveats\n\n###### o the best of Novetta’s knowledge and belief, participants in this effort did not disclose,\n\n#### T\n\n###### access, or utilize any confidential information that would result in violation of any third party agreements including, but not limited to, non-disclosure agreements or customer agreements.\n\n While this report discusses previous attribution claims made by outside parties, Novetta cannot definitively confirm any such attribution through the technical analysis detailed in this and other Operation Blockbuster reports.\n\nPlease note that this report includes terms that will not be\nfamiliar to everyone. We have included a glossary at the end\nof this report and denoted such defined terms with the []\nsuperscript for your convenience.\n\n\n-----\n\n## 1. Executive Summary\n\n###### peration Blockbuster is a Novetta-led coalition of private industry partners, created\n\n#### O\n\n###### with the intent to understand and potentially disrupt malicious tools and infrastructure that have been attributed to an adversary that Novetta has identified and named as the Lazarus Group. This group has been active since at least 2009, and potentially as early as 2007, and was responsible for the November 2014 destructive wiper[] attack\n CH AP T ER\n against Sony Pictures Entertainment (SPE).[]\n\n The attack against Sony Pictures Entertainment (SPE) was unprecedented in its media coverage and overt use of malicious destructive capabilities against a commercial entity. The SPE attack broke\n\n# ONE\n\n###### new ground not only as a destructive malware attack on a U.S. commercial entity but also due to the fact that the U.S. government attributed the attack to North Korea and enacted small reciprocal measures.[1] While the debate over who was responsible – North Korea, hacktivists, or SPE employees – was the primary subject played out in the media, the attack presented much larger implications, such as how little resistance a modern commercial enterprise is able to provide in the face of a capable and determined adversary with destructive intent.\n\n1 “North Korea and the Sony Hack: Exporting Instability Through Cyberspace.” Stephen Haggard, Jon R. Lindsay.\nAnalysis from the East-West Center. May 2015. http://www.eastwestcenter.org/system/tdf/private/api117.pdf\n\n\n-----\n\n##### 1. Executive Summary (continued)\n\nFurther, Novetta’s analysis of the observed tooling and TTPs[] suggests that the group has executed numerous successful\nattacks due in large part to their organization and determination, more so than due to any highly sophisticated malware\nsuch as those reportedly used by similar classes of threat actors reported in the last few years, e.g., HDD malware[2] and\nSatellite Turla.[3]\n\nThrough careful analysis outlined in this report and other associated reverse engineering technical reports, Novetta has\nbeen able to link the malware used in the SPE attack to a widely varied malicious toolset. This toolset includes malware\ndirectly related to previously reported attacks, suggesting that these malicious tools have been actively developed and\nused over a span of at least 7 years, and that the attackers responsible for the SPE attack have a much larger collection\nof related malware outside of the set of reported SPE destructive malware. Due to this, we strongly believe that the SPE\nattack was not the work of insiders or hacktivists. Instead, given the malicious tools and previous cyber operations linked\nto these tools, it appears that the SPE attack was carried out by a single group, or potentially very closely linked groups\nsharing technical resources, infrastructure, and even tasking. We have dubbed this group the Lazarus Group. Although\nour analysis cannot support direct attribution of a nation-state or other specific group due to the difficulty of proper\nattribution in the cyber realm, the FBI’s official attribution claims[4] could be supported by our findings.\n\nWhile the SPE attack occurred over a year ago, we are releasing this report now to detail our technical findings, clarify\ndetails surrounding the SPE hack, and profile the Lazarus Group, who has continued to develop tools and target victims\nsince then. Most importantly, Novetta continues to work with our public and private partner organizations in this\nOperation to ensure that Novetta’s signatures and other data will have a meaningful impact on the Lazarus Group’s\nabilities to function, as well as help potential victims understand in great detail not only the technical but also the\noperational methods. Novetta feels that this combination of sharing highly technical analysis with both the public and\nprivate industry is the best way to interdict these types of actors.\n\n2 “NSA Planted Stuxnet-Type Malware Deep Within Hard Drive Firmware.” The Hacker News. February 16, 2015. http://thehackernews.com/2015/02/hard-drive-firmware-hacking.html\n\n3 “Satellite Turla: APT Command Control in the Sky.” Securelist. September 9, 2015. https://securelist.com/blog/research/72081/satellite-turla-apt-command-and-control-in-the-sky/\n\n4 “Update on Sony Investigation.” FBI. December 19, 2014. https://www.fbi.gov/news/pressrel/press-releases/update-on-sony-investigation\n\n\n-----\n\n|attack tools:|Col2|Col3|\n|---|---|---|\n|installers|spreaders|Loaders|\n|Uninstallers|proxy|Keylogger|\n\n\n## 1.1 Key Takeaways\n\n**1.** The Lazarus Group is a well-established group that appears to be comprised of various sets of developers and\n\noperators for their custom malware.\n\n**2.** The Lazarus Group demonstrates varying levels of technical aptitude and proficiency in computer network\n\noperations (CNO).[]\n\n**3.** From a binary analysis perspective, this threat actor demonstrates a heavy reliance on shared code, techniques,\n\nand ideas from other previously developed Lazarus Group tool components as well as outside sources. Due to this,\nmalware used in the November 2014 SPE attack can be linked to a much wider set of the Lazarus Group’s malware\nthat has been under active development since as early as 2009.\n\n**4.** The malware analyzed in this Operation and attributed to the Lazarus Group has been used to target government,\n\nmedia, military, aerospace, financial, and critical infrastructure entities in a limited geographic area, primarily South\nKorea and the United States.\n\n**5.** Because of the depth and scope of malware tools, structure of the analyzed code bases, TTP overlap with similar\n\nattacks, and long trail of activities attributed to the Lazarus Group, Novetta does not believe that the SPE attack was\ncarried out by insiders or hacktivists, but rather by a more structured, resourced, and motivated organization.\n\n**6. The set of malware uncovered and analyzed during this Operation, more than 45 unique families to date, consists**\n\n**of a wide variety of attack tools:**\n\n###### Rats installers spreaders Loaders Hard Drive Wipers\n\n General Tools Uninstallers proxy Keylogger DDoS Bot\n\n**7.** The frequency and type of code sharing across malware families may suggest the same group of author(s) across\n\nfamilies or extensive sharing of resources between closely linked groups\n\n**8.** The Lazarus Group has also been observed to share cryptographic keys across malware families as well as general\n\ntechniques observed in other unrelated malware families.\n\n\n-----\n\n## 2. Operation Details\n\n###### peration Blockbuster began in December 2014, independent of any investigation\n\n#### O\n\n###### conducted by law enforcement or Sony, with the intent to not only identify and impact the malicious tools and infrastructure used by the Lazarus Group, but also to clarify details\n CH AP T ER surrounding the November 2014 SPE attack,\n which was the subject of widespread confusion. By investigating the malware linked to this attack, we have determined that the Lazarus Group has operated largely unfettered for nearly a decade, conducting cyber espionage, denial of service\n\n# Two\n\n###### attacks, data theft, and destructive attacks.\n\n Before discussing Novetta’s hunting methods, it is important to note that the majority of our malware samples and other data were sourced from public sources such as VirusTotal. As a result, our samples are biased towards the footprint and usage of this service. We do have some partners who provided malware samples, representing commercial ecosystem protectors and maintainers. Here again, our visibility is limited to the visibility of these partners.\n\n\n-----\n\n##### 2.1 Hunting Method\n\nOn December 14, 2014, US-CERT released an alert[5] entitled “Targeted Destructive Malware.” The alert described a set\nof malware families used by undefined attackers to compromise large network infrastructures and deploy hard drive\nwiping malware, RATs,[] and proxy Trojans.[] While the document did not specifically call out the Guardians of Peace[]\n(GOP)’s attack against SPE from the previous month, and only provided some basic YARA[] signatures and import hashes,\nmembers of the security community released specific hashes for the malware used within the SPE attack. From these\nhashes (MD5s listed below), a baseline of the Lazarus Group’s malware capabilities was established.\n\n         - d1c27ee7ce18675974edf42d4eea25c6\n\n         - 760c35a80d758f032d02cf4db12d3e55\n\n         - e1864a55d5ccb76af4bf7a0ae16279ba\n\n        - 6467c6df4ba4526c7f7a7bc950bd47eb\n\n###### Novetta Hunting Methodology:\n\n**Identify starting** **Begin analysis of** **Write high confidence** **Run high confidence**\n**sample(s)** **samples** **signatures** **signatures against a large**\n\nIn this case, the starting Attempt to identify unique Signatures can help capture **corpus of malware**\nsamples were identified by components of the code base other samples that use the This is more easily accomplished\nthe industry as being from that can provide high same or very similar code using Totem or similar elastic\nthe SPE attack confidence signatures snippets identified in step #2 malware analysis or file triaging\n\nframework\n\n**Collect and verify the** **Identify any divergence** **Write new high** **Repeat steps 4-7**\n**accuracy of results** **in samples** **confidence** **until done**\n\nBy checking the signature Such a divergence may communicate Signatures for those portions\nmatch, samples can be some structure change or change in of code\nverified to ensure that there capabilities, and in turn provide more\nare no false positives, or to information about a threat group’s\nrefine high confidence toolset, development activity, and\nsignatures capabilities\n\n5 US-CERT. “Alert (TA14-353A): Targeted Destructive Malware” https://www.us-cert.gov/ncas/alerts/TA14-353A December 14, 2014.\n\n\n##### 2.1 Hunting Method\n\n\n-----\n\n###### By analyzing the base set of malware associated with the Lazarus Group, Novetta determined that there were common code and libraries being used across multiple malware families (see Section 4 for more details).\n\nFrom these common snippets of code and use of library functions, signatures were generated to detect additional malware\nsamples using both open-source tools and Totem,[6][ ] an open-source, Novetta-developed framework for large-scale file\nanalysis and triage. While attempting to acquire all malware associated with a particular threat group is a Sisyphean task,\ngiven the active development of multiple various toolsets, Novetta was able to detect and analyze more than 45 distinct\nmalware families that fall under the Lazarus Group’s toolset. A thorough discussion on these families, organized by usage\nand intention, can be found in Novetta's supplemental reports.\n\nIn our investigation, we were able to scan signatures over hundreds of millions of samples we collected as well as using\nindustry partners’ AV scanning engines. The use of such a large corpus of malware allowed Novetta to fine-tune the\nsignatures for shared code components to ensure a high reliability that the code fragments used for detection were\nspecific to the Lazarus Group and not the result of commodity code. From the billions of files scanned, Novetta’s\nsignatures produced approximately 2000 samples, of which 1000 were manually vetted and catalogued as belonging to the\nLazarus Group.\n\n6 https://github.com/Novetta/totem\n\n\n-----\n\n## 3. Lazarus Group Details\n\n###### y identifying the malware linked to the SPE attack (Section 2.1) and other related\n\n#### B\n\n###### samples and capabilities, Novetta has been able\n CH AP T ER to compile a picture of a group that has been\n active for nearly a decade. Based on analysis of the extensive malware set collected, as well as details found in public reporting from linked attacks, the Lazarus Group appears to have resources that allow for development of custom malware tools\n\n# Three for extensive, targeted, and coordinated attacks,\n\n###### including long periods of reconnaissance. The Lazarus Group has also displayed the technical capability and will to perform destructive attacks against targets. The following sections detail the SPE attack and subsequent media reporting, the group’s TTPs, targets based on known attacks and malware artifacts, and previous cyber campaigns that we have directly linked to the Lazarus Group.\n\n\n-----\n\n###### 3.1 The SPE Attack and Conflicting Attribution\n\nIn November 2014, Sony Pictures Entertainment (SPE) was attacked with destructive\nmalware whose various components were publicly reported as Destover or Wiper and\nwhich Novetta identified in this Operation as WhiskeyAlfa, malware associated with the\nLazarus Group threat actors (see Section 4.1 for details about the naming scheme used for\nmalware attributed to the Lazarus Group). Publicly, a previously unknown hacker group\nnamed Guardians of Peace (GOP) took credit for the wiper attack and stolen data. The\ngroup eventually publicized the files stolen from SPE networks, including unreleased movies, usernames, passwords, and\nother IT details for internal SPE networks,[7] employees’ personal information, payroll information, employee termination\ndetails, TV scripts, and company emails.\n\nFollowing the attack, an initial FBI investigation concluded that the hack was the work of the North Korean government,\nas the malware used in the attack was linked to other malware attributed to North Korean actors – specifically, code\nsnippets, encryption algorithms, data deletion methods, and compromised infrastructure used during the attack.[8]\nInfrastructure used in the SPE attack has previously been linked by the U.S. government directly to other identified\nNorth Korea cyber activity. Several security researchers also stated that the destructive attack could be linked to malware\nvariants used in attacks that have been suggested to be the work of North Korea,[9] with similar TTPs as previous events\nattributed to North Korea,[10] **[11] and shared infrastructure.[12]**\n\nHowever, others stated that the evidence for North Korean involvement is circumstantial.[13] For instance, while the\ninfrastructure used in the SPE attack overlaps with infrastructure attributed to malicious cyber activity linked to North\nKorea, previously malicious IP addresses are not necessarily still used by the same attackers. In fact, the publicly reported\nC2[] addresses were almost all public proxies used by a variety of malware operators in the past. Other reporting claimed\nthat the SPE attack was the work of insiders rather than a nation-state,[14] and that the ability to thoroughly infiltrate\nthe SPE network and steal sensitive data required insider knowledge. The data leaked included details of planned\nlayoffs, suggesting a motivation for disgruntled employees to aid or provide stolen data to other attackers, such as piracy\nhacktivists targeting SPE. The attackers also dumped the stolen data, rather than keeping it secret as, some allege, a state\npower interested in intelligence or propaganda might do instead.[15] In contrast, previous destructive attacks against South\nKorean organizations in March 2013, which were linked to North Korea, involved no extortion demands from attackers.\nNotably, other public comments even doubted that North Korea had the capabilities to launch such an attack largely due\n\n7 “Sony’s IT blueprints leaked by hackers.” CSO. December 4, 2014. http://www.csoonline.com/article/2855005/business-continuity/sonys-it-blueprints-leaked-by-hackers.html\n\n8 “Update on Sony Investigation.” FBI. December 19, 2014. https://www.fbi.gov/news/pressrel/press-releases/update-on-sony-investigation\n\n9 “Destover: Destructive malware has links to attacks on South Korea.” Symantec. December 4, 2014. http://www.symantec.com/connect/blogs/destover-destructive-malware-has-links-attacks-south-korea\n\n10 “South Korean paper hit by major cyber attack.” Phys.org. June 11, 2012. http://phys.org/news/2012-06-south-korean-paper-major-cyber.html\n\n11 “Four-star spymaster behind North Korean hacking; Sony’s ‘The Interview’ available online.” The Washington Times. December 24, 2014. http://www.washingtontimes.com/news/2014/dec/24/inside-the-ring-four-star-spy­\n\nmaster-behind-north-k/\n\n12 “Sony Hack Mirrors Attack on South Korean Newspaper, Researcher Says.” The Wall Street Journal. December 19, 2014. http://blogs.wsj.com/korearealtime/2014/12/19/sony-hack-mirrors-attack-on-south-korean-newspa­\n\nper-researcher-says/\n\n13 “No, North Korea Didn’t Hack Sony.” The Daily Beast. December 24, 2014. http://www.thedailybeast.com/articles/2014/12/24/no-north-korea-didn-t-hack-sony.html\n\n14 “Norse Investigation Focusing on a Small Group, Including Sony Ex-Employees.” Norse. December 29, 2014. http://web.archive.org/web/20150623023623/http://darkmatters.norsecorp.com/2014/12/29/ex-employee-five-\n\nothers-fingered-in-sony-hack/http://darkmatters.norsecorp.com/2014/12/29/ex-employee-five-others-fingered-in-sony-hack/\n\n15 “No, North Korea Didn’t Hack Sony.” The Daily Beast. December 24, 2014. http://www.thedailybeast.com/articles/2014/12/24/no-north-korea-didn-t-hack-sony.html\n\n\n-----\n\nto insufficient infrastructure,[16] or that other[17] nation-states[18] were involved.\n\nIn addition to the conflicting attribution of the attacks, some initial reporting suggested that the attack shared some\nlinks to Shamoon, the destructive malware that hit Saudi Aramco and other oil company networks in August 2012. This\nwas based on the use of the same commercially available drivers (EldoS RawDisk) and attack techniques rather than any\nshared malware code.[19] From Novetta’s analysis of Shamoon, there is no clear link between Shamoon and any destructive\nmalware variants tracked in this operation that would indicate shared author(s). However, the author(s) behind the SPE\ndestructive malware may have copied Shamoon’s attack techniques, or vice versa. It is worth noting that the two nation-\nstates publicly blamed for the Saudi Aramco and SPE attacks (Iran and North Korea, respectively) have had a technology\nsharing treaty since 2012, with a specific focus on cyber.[20]\n\nWhile some critics of the SPE attribution do ask important questions, such as whether the use of public proxies or open-\nsource code libraries is sufficient evidence for attribution, many who have written off any possible nation-state involvement\ndue to GOP’s public actions have not fully considered the possible motives of a state’s interest in attacking SPE. Furthermore,\nto discount nation-states like North Korea as too underdeveloped ignores the demonstrated fact that cyber attacks\nare no longer limited to highly resourced nation-states.[21] **[22]** **[23] The cyber footprint of not only governments and critical**\ninfrastructure, but also corporate enterprises, has grown significantly while still largely lacking in sophisticated security\noperations, effectively lowering the barrier to entry even further for threat groups.\n\nAlthough Novetta is unable to determine via technical malware analysis whether or not the SPE attack was carried out\nby an identified nation-state, we have been able to link the malware used in this attack to a widely varied malicious\ntoolset profiled in this Operation, including tools directly related to previously reported attacks (Section 3.4). This link\nto known attacks suggests that these malicious tools have been actively developed and used over a span of at least 7\nyears, and that the attackers responsible for the SPE attack have a much larger collection of related malware outside of\nthe SPE destructive malware. Due to this finding, we strongly believe that the SPE attack was not the work of insiders or\nhacktivists. Furthermore, given the malicious tools and previous cyber operations linked to these tools, it appears that\nthe SPE attack was carried out by a single group, or potentially very closely linked groups sharing technical resources,\ninfrastructure, and even tasking. We have dubbed this organization the Lazarus Group. However, rather than focus on the\nspecifics of attribution, this report and subsequent technical reports are intended to detail our technical findings on the\nscope of the Lazarus Group’s known tools and capabilities.\n\n###### Due to this finding, we strongly believe that the SPE attack was not the work of insiders or hacktivists. Furthermore, given the malicious tools and previous cyber operations linked to these tools, it appears that the SPE attack was carried out by a single group, or potentially very closely linked groups sharing technical resources, infrastructure, and even tasking. We have dubbed this organization the LAZARUS GROUP.\n\n[16 “Former Anonymous hacker doubts North Korea behind Sony attack.” CBS News. December 17, 2014. http://www.cbsnews.com/videos/former-anonymous-hacker-doubts-north-korea-behind-sony-attack/“Sony Hackers](http://www.cbsnews.com/videos/former-anonymous-hacker-doubts-north-korea-behind-sony-attack/)\n\nGuardians of Peace Troll FBI, Anonymous Convinced Hack Didn’t Come From North Korea.”\n\n17 “A security firm claims it was Russia that hacked Sony – and that it still has access.” Business Insider. February 5, 2015. http://www.businessinsider.com/a-security-firm-claims-it-was-russia-that-hacked-sony-and-that-\n\nthey-still-have-access-2015-2\n\n18 “Evidence in Sony hack attack suggests possible involvement by Iran, China or Russia, intel source says.” Fox News. December 19, 2014. http://www.foxnews.com/politics/2014/12/19/fbi-points-digital-finger-at-north-korea-\n\nfor-sony-hacking-attack-formal.html\n\n19 “Sony Pictures malware tied to Seoul, ‘Shamoon’ cyber-attacks.” Ars Technica. December 4, 2014. http://arstechnica.com/security/2014/12/sony-pictures-malware-tied-to-seoul-shamoon-cyber-attacks/\n\n20 “Iran and North Korea sign technology treaty to combat hostile malware.” V3. September 3, 2012. http://www.v3.co.uk/v3-uk/news/2202493/iran-and-north-korea-sign-technology-treaty-to-combat-hostile-malware\n\n[21 “Profiling an enigma: The mystery of North Korea’s cyber threat landscape.” HP Security Research. August 2014. http://community.hpe.com/hpeb/attachments/hpeb/off-by-on-software-security-blog/388/2/HPSR%20Secu­](http://community.hpe.com/hpeb/attachments/hpeb/off-by-on-software-security-blog/388/2/HPSR%20SecurityBriefing_Episode16_NorthKorea.pdf)\n\n[rityBriefing_Episode16_NorthKorea.pdf](http://community.hpe.com/hpeb/attachments/hpeb/off-by-on-software-security-blog/388/2/HPSR%20SecurityBriefing_Episode16_NorthKorea.pdf)\n\n[22 “Operation Cleaver.” Cylance. December 2014. http://cdn2.hubspot.net/hubfs/270968/assets/Cleaver/Cylance_Operation_Cleaver_Report.pdf](http://cdn2.hubspot.net/hubfs/270968/assets/Cleaver/Cylance_Operation_Cleaver_Report.pdf)\n\n23 “Malware-based Attacks Against POS Systems.” Infosec Institute. February 11, 2014. http://resources.infosecinstitute.com/malware-based-attacks-pos-systems/\n\n\n-----\n\n###### 3.2 Tactics, Techniques, and Procedures (TTPs)\n\nThe Lazarus Group has developed an extensive and varied toolset which effectively combines a number of methods for\ndelivering additional malicious tools, exfiltrating data, and launching destructive attacks. While the group's combined\ncapabilities are not necessarily as polished or advanced as other publicly reported APT groups, the TTPs and malware\nconnected to the Lazarus Group demonstrate that it is a capable and determined adversary. Particularly when considering\nthe state of most, if not all, organizations who struggle with the complexity of computer network defense, it is clear that\nthe Lazarus Group is taking advantage of a cyber attacker’s asymmetric advantage in these scenarios. The generally lax\ndefensive capabilities of their targeted organizations are reflected by the structure and complexity of their tooling and\nhow they use these tools operationally - the Lazarus Group’s tools are sufficiently advanced for the intended targets and\nlevel of impact. This is also typically seen in most malware tooling discovered and reported on, from the more advanced\nand complex malware frameworks like Flame[24] and Satellite Turla,[25] both observed targeting a narrow, hardened set of\nvictims, to the off-the-shelf and simple malware (Plugx, Poison Ivy, etc) often used for softer targets or for initial access\nto target networks. Some threat groups make use of a full spectrum of malware, as was observed in Novetta’s previous\nOperation SMN reporting,[26] where the Axiom group leveraged different tools and techniques dependent on the security\nposture and capabilities of target organizations. Compared to Axiom, Novetta’s analysis of the Lazarus group’s toolsets\ndid not demonstrate the same widespread distribution between advanced, moderately advanced, and basic capabilities. Yet\nthis clearly was not an impediment to the operators in the Lazarus Group, given the success of their attacks.\n\n###### Despite evidence suggesting that their attacks to date have succeeded without the need for some of the more advanced techniques or capabilities, the Lazarus Group has shown creativity in their operations that set\n them apart.\n\nDespite evidence suggesting that their attacks to date have succeeded without the need for some of the more advanced\ntechniques or capabilities, the Lazarus Group has shown creativity in their operations that set them apart. For example,\nthe group has several malware variants with TLS[] mimicking capabilities (Section 4.3.3.1) to evade network detection,\nas well as a P2P[] malware family that serves as a platform for an operator to access all infected instances. The Lazarus\nGroup has also used master boot record (MBR)[] wiper malware since at least 2009, marking some of the earliest known\ninstances of targeted destructive malware. Furthermore, the willingness to use destructive malware in such a wide scope,\nseen with the SPE attack as well as other linked attacks, distinguishes them from many other APT groups. However, the\nLazarus Group is not limited solely to the deployment of destructive malware. In fact, the toolset identified during this\nOperation suggests that the Lazarus Group encompasses a wide spectrum of CNO capabilities, including distributed\ndenial of service (DDoS) malware,[] keyloggers,[] and RATs, and even a P2P malware family that allows operators to\nestablish a common program base and remote administration across all infected machines.\n\n24 “Meet ‘Flame,’ the massive spy malware infiltrating Iranian computers.” Wired. May 28, 2012. DNS-Calc APT Trojan Uses DNS Queries to Generate C&C Port Number\n\n25 “Satellite Turla: APT Command Control in the Sky.” Securelist. September 9, 2015. https://securelist.com/blog/research/72081/satellite-turla-apt-command-and-control-in-the-sky/\n\n26 “Operation SMN: Axiom Threat Actor Group Report.” Novetta. November 2014. http://www.novetta.com/wp-content/uploads/2014/11/Executive_Summary-Final_1.pdf\n\n\n-----\n\n|DDoS malware|Col2|Espionage campaigns marked by a long initial reconnaissance period of targeted networks, including malware customized specifically for target networks|\n|---|---|---|\n|Destructive malware||Compromised IPs and websites as command-and-control (C2)|\n|Extensive use of various types of obscure encryption||Proxies to mask true C2|\n|Integration of publicly available tools, libraries, and other code||Email as C2|\n|Re-use of malicious code across multiple malware families||Mimicking TLS as a means of network detection evasion|\n| Multiple attack components/vectors |||\n||Spear phishing||\n||Targeting of South Korean AV and indigenous Korean software||\n||Use of other legitimate software to gain access to victim networks||\n||Decoy documents||\n\n\nAmong the TTPs we have seen, based on the identified malware corpus and linked cyber campaigns tied to the Lazarus\nGroup, including SPE, the Lazarus Group’s primary TTPs are:\n\nEspionage campaigns marked by a long initial reconnaissance\n\nDDoS malware period of targeted networks, including malware customized\n\nspecifically for target networks\n\nDestructive malware Compromised IPs and websites as command-and-control (C2)\n\nExtensive use of various types of obscure encryption Proxies to mask true C2\n\nIntegration of publicly available tools, libraries, and other code Email as C2\n\nRe-use of malicious code across multiple malware families Mimicking TLS as a means of network detection evasion\n\n Multiple attack components/vectors \n\nSpear phishing\n\nTargeting of South Korean AV and indigenous Korean software\n\nUse of other legitimate software to gain access to victim networks\n\nDecoy documents\n\n\n-----\n\n###### 3.3 Targeting\n\n The Lazarus Group has targeted a number of industry verticals over the years, including government, military, financial, media and entertainment, and critical infrastructure.\n\nAccording to previous public research and reporting, the Lazarus Group has targeted a number of industry verticals over\nthe years, including government, military, financial, media and entertainment, and critical infrastructure. These victims\nhave largely been limited to South Korea and the United States. Based on three months of telemetry gathered from initial\nsignatures created and shared with industry partners, however, possible infections were found in a much wider geographic\narea, including concentrations of detected Lazarus Group malware found in other Asian countries like Taiwan, China,\nJapan, and India. While these initial signature detections provide a general overview of some possible malicious activity,\nthese numbers should not be considered reflective of the totality of Lazarus Group tools detected in this Operation, due to\nthe nature of our approach in this effort and our partners’ visibility into these geographic areas.\n\nSeveral recent examples of targeting were observed in spear-phishing documents dropped by samples of an installer[]\ndeveloped by the Lazarus Group, which Novetta has named IndiaAlfa.[27]\n\n27 <reference external report on this>\n\n\n-----\n\n**Figure [3-1]: Decoy document dropped by IndiaAlfa variant relating to the May 2015 parliamentary election in South Korea**\n\nThe above example is a media report discussing the May 2015 South Korean parliamentary election, which included\ncandidates for the Saenuri Party, South Korea’s ruling party since 2008. Interestingly, Saenuri has taken a much\nstronger stance toward North Korea aggressions in comparison to the pre-2008 “Sunshine Policy” which actively sought\ncooperation between the two states. Saenuri actively supports the North Korean Human Rights Law and founded Open\nRadio for North Korea, an organization which spreads information about democracy. Saenuri is also a major advocate of\ncyber security and the National Intelligence Service. Despite being amidst corruption allegations, the Saenuri Party won\nthree of the four parliamentary seats during the election.\n\n\n-----\n\n**Figure [3-2]: Decoy document from April 2015 dropped by an IndiaAlfa variant about the Government 3.0 conference in May**\n\nAnother document dropped by India Alfa includes information about the Government 3.0 Conference, held in May 2015.\nSouth Korea’s Government 3.0 emphasizes transparency and collaboration. Of note is the program’s 24-hour online portal\nservice which connects citizens to multiple central and local government agencies.\n\nMore recently, a variant compiled in October 2015 contains a decoy document asking speakers at the Society for Aerospace\nSystem Engineering’s (SASE) 2015 autumn conference to register their papers. A warning that same month warned\nusers not to click on these SASE documents, as it exploits a vulnerability (CVE-2015-6585) in the Hangul Word Processor\n(HWP)[] to deliver a malicious payload.[28] This same vulnerability, patched in September 2015, was reportedly exploited in\nzero-day attacks tied by researchers to North Korean threat actors.[29]\n\n28 “[Warning] Do not open an E-mail that includes a document titled ‘2015년도 추계학술대회 안내문.hwp’ (2015 Fall Conference Announcement).” Division of Information Security, Seoul National University. October 20,\n\n2015. http://community.snu.ac.kr/bbs/bbs.enmessage.view.screen?bbs_id=403&message_id=157326&search_field=title&search_word=&classified_value=\n\n29 “Hangul Word Processor (HWP) Zero-Day.” FireEye. September 9, 2015. https://www.fireeye.com/content/dam/fireeye-www/global/en/blog/threat-research/FireEye_HWP_ZeroDay.pdf\n\n\n-----\n\n**Figure [3-3]: Document dropped by an IndiaAlfa sample asking speakers to register papers for the upcoming Society for Aerospace System**\n**Engineering (SASE) conference**\n\nThe above decoy document is a .hwp file, meant to be used with Hangul Word Processor (HWP), an indigenous South\nKorean word processing software. Other IndiaAlfa samples have also been observed dropping other decoy documents for\nHWP, such as a Korean-language resume and a directory for the Saejong Institute’s National Strategy Training Courses,\nthe latter of which was identified in an article referencing North Korean spear-phishing strategies.[30] In fact, HWP appears\nto be a popular attack vector for targeting South Korean victims,[31] **[32] which may be due to the fact that 80% of documents**\nattached to South Korean government and public agencies’ websites are reportedly HWP documents.[33]\n\nBased on the analysis of malware identified in this Operation and tied to the Lazarus Group based on code reuse, as well\nas the public reporting of events that we have linked to the Lazarus Group’s activity, we believe that this threat group has\ntargeted a wide variety of victims, in addition to the SPE attack.\n\n30 “공공기관등 주의 촉구…특정 사용자 대상 ‘정밀공격’ 피해 가능성 높아 (Public institutions urged to use caution...high likelihood of precision attacks targeting specific users).” 매일 경제 (Daily News).\n\nMay 10, 2015. http://news.mk.co.kr/newsRead.php?year=2015&no=444993\n\n[31 “한글 파일 제로 데이(Zero-Day) 취약점 악용 공격 (Attacks exploit Hangul file Zero-Day vulnerabilities)” AhnLab. January 29, 2013. http://asec.ahnlab.com/902](http://asec.ahnlab.com/902)\n\n[32 “한글 제로데이 취약점을 이용한 악성코드 (Malware exploits Hangul Zero-Day vulnerabilities) .” AhnLab. May 20, 2015. http://asec.ahnlab.com/1035](http://asec.ahnlab.com/1035)\n\n33 “北, 한글 제로데이 공격 시도…정부 ‘비밀문서’ 노렸나 (North Korea, Hangul Zero-Day attack attempt...were government “secret documents” revealed)?” Focus news. September 11, 2015. http://www.focus.kr/\n\nview.php?key=2015091100120249472\n\n\n-----\n\n###### 3.4 Links to Previous Reporting\n\nSome of the malware variants identified during Operation Blockbuster have been correlated to previously reported\nincidents and attacks, either because the malware was specifically identified in the attack, the Lazarus Group malware\nshared notable code overlap with the publicly reported malware, or the C2 infrastructure publicly reported was also found\nhard coded in malicious tools used by the Lazarus Group. Additionally, several events also had TTPs highly similar to\nthose of the Lazarus Group and have been linked to other notable attacks by security researchers. While some of these\nindicators, such as overlapping C2s or some TTPs, may not be definitive proof of a linked activity, the collective picture of\nthese events together provide a stronger link.\n\nThese ties strongly suggest that the Lazarus Group has been active since at least 2009, and potentially as far back as 2007, or\nhas extensively shared resources with other closely linked groups responsible for these attacks. In the scenario that the GOP\nwere a real organization and responsible for the SPE attack, this would suggest that SPE was not the only operation by the\nhacktivist group. However, Novetta’s analysis and findings suggest that the SPE attack was one of several attacks attributable\nto the Lazarus Group, who may have posed as the pop up hacktivist collective to mislead or distract the public.\n\n###### The Lazarus Group Timeline\n\n March 7, 2007:\n\n**Development of first generation malware**\n**used in “Operation Flame,” activity that**\n**is eventually tied to “Operation**\n**1Mission,” “Operation Troy,” and the**\n**DarkSeoul 2013 attacks.**\n\n###### July 4, 2009:\n\n**A large-scale DDoS attack on US and**\n**South Korean websites uses the MYDOOM**\n**and Dozer malware, which is suspected to**\n**have arrived in email messages. The**\n**Independence Day” in the Master Boot malware places the text “Memory of** **2009 – 2013:**\n**Record (MBR).** **Operation Troy cyber espionage campaign**\n\n**is active for several years, culminating**\n**in the March 2013 DarkSeoul attacks.**\n\n###### March 2011:\n\n**“Ten Days of Rain” attack targets South**\n**Korean media, financial, and critical**\n**infrastructure targets. Compromised**\n**computers within South Korea are used to**\n**launch DDoS attacks.** **April 2011:**\n\n**DDoS attack targets Nonghyup Bank.**\n\n###### 2012:\n\n**“Operation 1Mission” campaign, also**\n**linked to the March 2013 DarkSeoul**\n**attacks, begins. Attackers behind this**\n**activity have reportedly been active**\n**since 2007.**\n\n\n-----\n\n**Conservative South Korean newspaper**\n**claims to have been attacked**\n**unsuccessfully with wiper malware.**\n**Website is defaced by an unknown hacker**\n\n###### March 20, 2013: group, “IsOne.”\n\n**DarkSeoul wiper attack targets three**\n**South Korea broadcast companies,**\n**financial institutes, and one ISP. Two**\n**unknown groups take credit: NewRomanic**\n**Cyber Army Team and WhoIs Team.**\n\n###### March 2014:\n\n**A hacking attempt to steal South Korean**\n**military data reportedly uses a server**\n**also seen in the March 2013 DarkSeoul**\n**attack.[43,44] Due to a lack of publicly**\n**available information on the C2 details,**\n\n###### November 24, 2014: not this attack was related.Novetta was unable to verify whether or\n\n**SPE networks are attacked with**\n**destructive malware. Information stolen**\n**from the company’s networks is**\n**distributed online by previously unknown**\n**hacker group Guardians of Peace (GOP).**\n\n             - **March 2014: A hacking attempt to steal South Korean military data reportedly uses a server also seen in the March**\n\n2013 DarkSeoul attack[34] **[35]. Due to a lack of publicly available information on the C2 details, Novetta was unable to**\nverify whether or not this attack was related.\n\nVarious security researchers have connected multi-staged attacks over a period of several years, largely against South\nKorean targets. Attack methods used include hard disk wiping and DDoS attacks that triggered on historically significant\ndates, overwriting disk content with political strings, using legitimate third-party update mechanisms to move across\ntarget networks, specific encryption and obfuscation methods, and using similar C2 structures across campaigns. We have\nbeen able to directly link several of these attacks to the Lazarus Group.\n\n**Operation Flame and Operation 1Mission: 2007 – 2012**\n\nIssueMakersLab researchers have connected malicious activity as recent as the March 2013 DarkSeoul wiper attack to\nactivity as far back as 2007,[36] as the attackers used the same passwords, RSA[] encryption keys, and C2 protocol across\nattacks.[37] Since 2012, these attackers have reportedly carried out activities under the name “Operation 1Mission,” based on\na PDB path[] found in a plurality of the malware linked to identified attack activity.\n\nThe group behind Operation 1Mission used legitimate third-party software (an ActiveX vulnerability) as an initial infection\nvector, shared public RSA key across malware variants for six years, exfiltrated data and downloaded additional malware\nusing Stage 1 C2 servers using the same primary C2 protocol and C2 code, and distributed destructive malware via Stage 2\nC2 servers using altered antivirus update files. The Operation 1Mission TTPs have been reflected in multiple reported events\nlisted in this section as well as in the Lazarus Group’s malware: although we cannot confirm a link to the malware used in\nOperation 1Mission, Novetta has also observed shared public RSA keys across malware families, shared C2 infrastructure\nbetween unrelated families, and Stage 1 C2 servers used to distribute and download additional malware tools.\n\nIssueMakerLabs’ analysis linking DarkSeoul to malicious activity from 2007 has also been supported by Fortinet research,\nwhich connected cyber activity from 2007, dubbed Operation Flame,[38] to Operation 1Mission, Operation Troy, and the\nDarkSeoul attack. While the earliest compilation date for Lazarus Group malware identified by Novetta during this\nOperation is 2009, Novetta has directly linked Lazarus Group tools to Operation Troy and at least two other attacks that\n\n34 “South Korea Detects Suspected North Korea Hacking Attempt.” Security Week. March 27, 2014. http://www.securityweek.com/south-korea-detects-suspected-north-korea-hacking-attempt\n\n35 “S. Korean military research agency kept mum about hacking.” The Dong-A Ilbo. April 11, 2014. http://english.donga.com/List/3/all/26/408162/1\n\n36 “South Korea identified who’s behind the cyber attack.” IssueMakersLabs. https://docs.google.com/file/d/0B6CK-ZBGuMe4dGVHdTZnenJMRUk/edit?pli=1\n\n37 “[단독] 3.20 사이버테러 공격주체, 그 실체 드러나다(The 3.20 cyber terrorism subject, the realities emerge)!” boannews.com April 9, 2013. http://www.boannews.com/media/view.asp?idx=35578\n\n38 “Z:\\Make Troy\\, Not War: Case Study of the Wiper APT in Korea, and Beyond.” Fortinet. 2014. https://www.blackhat.com/docs/asia-14/materials/Yang/Asia-14-Yang-Z-Make-Troy-Not-War-Case-Study-Of-The-Wiper-APT-In-\n\nKorea-And-Beyond.pdf\n\n\n-----\n\nhave been connected by researchers to the DarkSeoul attack (discussed below). Based on IssueMakersLab’s and Fortinet’s\nanalyses, this could suggest that the Lazarus Group has been actively developing malware and conducting attacks since as\nearly as 2007, or that they have links to another group active since that time.\n\n**Operation Troy: 2009 – 2012**\n\nSeveral of the malware variants collected and analyzed during Operation Blockbuster were reportedly used in the cyber-\nespionage campaign Operation Troy, active from 2009 to 2012. This campaign has been connected not only to the\nMarch 2011 “Ten Days of Rain” attacks[] but also to the widely reported March 2013 DarkSeoul attack on South Korean\nbroadcasters and financial institutions.[39] The DarkSeoul wiper malware was said to have been uploaded to networks\nusing prior access from Operation Troy’s long reconnaissance and data exfiltration campaign.[40] The various malware\ntools used in Operation Troy were linked together by researchers based on shared code, and several of the malware hashes\nassociated with Operation Troy also matched YARA signatures and known malware hashes for several Lazarus Group\ntools: DeltaAlfa, IndiaJuliett, IndiaGolf, IndiaHotel, LimaDelta, TangoBravo, and WhiskeyBravo (see Section 4.1 for details\nabout the naming scheme used for malware attributed to the Lazarus Group).\n\n**Ten Days of Rain: March 2011**\n\nThe March 2011 “Ten Days of Rain” attacks were a prolific series of DDoS attacks that targeted South Korean government,\nmilitary, financial, and corporate organizations as well as U.S. military entities.[41] **[42] The attack used the destructive**\nmalware payload identified by Novetta in this operation as WhiskeyBravo, as well as the DDoS malware DeltaAlfa, which\nwas also later tied by researchers to the Operation Troy campaign. Additionally, an IP address embedded in another\nmalware tool uncovered during the investigation into the Lazarus Group, a variant of SierraJuliett, was used as a first tier\nC2 server in these attacks.\n\nThe “Ten Days of Rain” attacks also bore many similarities to the July 2009 DDoS attacks against U.S. and Korean\nsites.[43] **[44]** **[45] Notably, one sample of malware identified in the 2009 attacks includes a suicide script (Section 4.3.4)**\ncontaining strings that appear to match the suicide script seen with KiloAlfa, a keylogger linked to the Lazarus Group’s\nmalware corpus during this operation. This would suggest that malware code widely used by the Lazarus Group can be\nlinked via code reuse to publicly reported attacks as far back as 2009.\n\nOther attacks on South Korean targets appear to share the same TTPs and infrastructure attributed to the above attacks,\nsuch as a June 2012 attack on conservative media organization JoongAng.[] An investigation into the attack by South\nKorean officials found that the attackers used two North Korean servers and 17 servers in 10 other countries. One of the\nservers used in the attack on JoongAng was also used in the March 2011 “Ten Days of Rain” attacks as well as the April\n2011 Nonghyup Bank attack.[46] The JoongAng attack was claimed by the previously unknown hacking group IsOne.[47] Like\nGOP, IsOne emerged from complete obscurity and has done nothing since. The attack used destructive malware that\nreportedly affected databases and the newspaper editing system. Additionally, the JoongAng Ilbo website was defaced. The\nattack followed threats made the previous week by North Korea in response to reporting by South Korean media, though\nthis does not necessarily suggest a motive for the attacker(s).\n\n39 “2013年3月に発生した韓国へのサイバー攻撃をまとめてみた。 (I tried to summarize the cyber attacks on South Korea in March 2013)” piyolog. March 23, 2013. http://d.hatena.ne.jp/Kango/20130323/1363986809\n\n40 “Dissecting Operation Troy: Cyberespionage in South Korea.” McAfee. 2013. http://www.mcafee.com/us/resources/white-papers/wp-dissecting-operation-troy.pdf\n\n41 “Ten Days of Rain: Expert analysis of distributed denial-of-service attacks targeting South Korea.” McAfee. 2011. http://www.mcafee.com/us/resources/white-papers/wp-10-days-of-rain.pdf\n\n42 “Check your zombie device! Analysis of the DDoS cyber terrorism against the country and future attacks on various devices.” DongJoo Ha, SangMyung Choi, TaeHyung Kim, SeungYoun Han. Presentation at Black Hat Abu\n\nDhabi, 2011. https://media.blackhat.com/bh-ad-11/Ha/bh-ad-11-Ha-Check_Your_Zombie_Devices_Slides.pdf\n\n43 “MYDOOM Code Re-Used in DDoS on U.S. and South Korean Sites.” Trend Micro. July 9, 2009. http://blog.trendmicro.com/trendlabs-security-intelligence/mydoom-code-re-used-in-ddos-on-u-s-and-south-korean-sites/\n\n44 “McAfee Fingers North Korea in Attacks on South Korean Sites.” Threatpost. July 6, 2011. https://threatpost.com/mcafee-fingers-north-korea-attacks-south-korean-sites-070611\n\n45 “DDOS Madness Continued…” FireEye. July 11, 2009. https://www.fireeye.com/blog/threat-research/2009/07/ddos-madness-climax.html\n\n46 “North behind hacking attack on JoongAng Ilbo.” JoongAng Ilbo. January 17, 2013. http://koreajoongangdaily.joins.com/news/article/article.aspx?aid=2965629\n\n47 “South Korean paper hit by major cyber attack.” Phys.org. June 11, 2012. http://phys.org/news/2012-06-south-korean-paper-major-cyber.html\n\n\n-----\n\n**DarkSeoul: March 2013**\n\nNovetta has not found any definitive links between the publicly reported Jokra/DarkSeoul malware samples used in the\nMarch 2013 DarkSeoul attack and identified Lazarus Group malware. However, the attack has been linked to Operation\nTroy, as discussed above, as well as the Ten Days of Rain attacks,[48] both of which have direct links to the Lazarus Group’s\nmalware toolkit. In addition, it is also worth noting that, as with the SPE attack where a previously unknown hacktivist\ngroup took credit, the DarkSeoul attack was claimed by two previously unknown groups: the New Romanic Cyber Army\nTeam and the WhoIs Hacking Team.\n\nThe same group behind the March 2013 DarkSeoul attack has also been linked to multiple other attacks over a period of\nfour years, including the July 2009 DDoS attack whose malware shares suicide strings with KiloAlfa,[49] a May 2013 attack\non South Korean financial institutions, a June 2013 Castov malware attacks on South Korean websites[50] and two DNS\nservers,[51] and a December 2014 MBR wiper attack on a South Korean power plant.[52] In the case of the June 2013 attacks, the\nattack reportedly took 6 months to plan,[53] during which attackers hacked file-sharing sites, again suggesting an extensive\nplanning period prior to the ultimate attacks. Using compromised file-sharing sites is a tactic that has been observed in\nan older Lazarus Group malware family from 2011, LimaDelta. However, due to a lack of publicly available hashes, Novetta\nhas not been able to analyze these events for any direct links to the Lazarus Group’s code.\n\nBased on our hunting method, starting with only a few of the samples publicly linked to the November 2014 SPE attack,\nNovetta was able to connect attacks since as early as 2009 to shared malware code we have associated with the Lazarus\nGroup. Work by other security researchers has linked this activity as far back as 2007. These linked cyber operations over\nseveral years, including the SPE attack, suggest actions of a single group, or perhaps very close groups with similar goals who\nshare tools, methods, taskings, and even operational duties. The span and destructive damage accomplished by these attacks\nfurther illustrate that this is a determined adversary with the resources to develop unique, mission-oriented malware tools.\n\n48 “Ten Days of Rain: Expert analysis of distributed denial-of-service attacks targeting South Korea.” McAfee. 2011. http://www.mcafee.com/us/resources/white-papers/wp-10-days-of-rain.pdf\n\n49 “Four Years of DarkSeoul Cyberattacks Against South Korea Continue on Anniversary of Korean War.” Symantec. June 26, 2013. http://www.symantec.com/connect/blogs/four-years-darkseoul-cyberat­\n\ntacks-against-south-korea-continue-anniversary-korean-war\n\n50 “South Korea Blames North Korea for Cyberattack.” Hamodia. July 17, 2013. http://hamodia.com/2013/07/17/south-korea-blames-north-korea-for-cyberattack/\n\n51 “Analysis of Korean War Anniversary Cyber Attack and Malware.” Tripwire. June 27, 2013. http://www.tripwire.com/state-of-security/vulnerability-management/analysis-of-korean-war-anniversary-cyber-attack-malware/\n\n52 “MBR Wiper Attacks Strike Korean Power Plant.” Trend Micro. December 23, 2014. http://blog.trendmicro.com/trendlabs-security-intelligence/mbr-wiper-attacks-strike-korean-power-plant/\n\n53 http://hamodia.com/2013/07/17/south-korea-blames-north-korea-for-cyberattack/\n\n\n-----\n\n## 4. Malware Tooling\n\n###### he tool set used by the Lazarus Group overtime has been extensive. To date,\n\n#### T\n\n###### more than 45 different malware families have been observed, with the bulk of these families containing strong code-based relationships (code\n CH AP T ER\n sharing). The Lazarus Group’s malware collection breaks down into larger classifications: installers/ uninstallers,[] loaders, destructive malware, remote administration tools (RATs), data exfiltration tools, attack staging/content distribution, distributed denial of service tools, and specific use tools.\n\n# Four\n\n###### This section will cover the naming scheme used to classify the malware families, the known infrastructure of the Lazarus Group, and the code relationships that Novetta found, allowing us to link all of these malware families together.\n\n To date, more than 45 different malware families have been observed, with the bulk of these families containing strong code-based relationships (code sharing).\n\n\n-----\n\n|FIRST LEVEL IDENTIFIER|GENERAL CLASSIFICATION|\n|---|---|\n|Delta|DDoS|\n|Hotel|HTTP Server|\n|India|Installer|\n|Lima|Loader|\n|Kilo|Keylogger|\n|Papa|Proxy|\n|Romeo|RAT|\n|Sierra|Spreader|\n|Tango|Tool (Non-Classed)|\n|Uniform|Uninstaller|\n|Whiskey|Destructive Malware (“Wiper”)|\n\n\n##### 4.1 Naming Scheme\n\nFor Operation Blockbuster, Novetta uses a naming scheme to allow the reader to quickly identify the larger class to which a\nparticular malware family belongs. The naming scheme consists of at least two identifiers which each identifier coming from\nthe International Civil Aviation Organization[] (ICAO)’s phonetic alphabet,[54] commonly referred to as the NATO phonetic\nalphabet. The first identifier specifies the general classification of the malware family while the second identifier specifies the\nspecific family within the larger general classification. For example, RomeoAlfa specifies a RAT family identified as Alfa.\n\nFor the purposes of this paper, the term “family,” with respect to malware grouping, is defined as a collection of like\nmalware samples that have a common code base, design and function with a clear evolutionary path. Within a single\nfamily there may exists variants that exhibit the same primary criteria of the overall family, but have significant\nevolutionary differences that allow for additional grouping, but not such that the overall design and functionality of the\ncode base changed to the point of dictating the need for an entirely new family classification. While many of the families\nare dropped by another family of malware (e.g. a “dropper”), a distinction is made between the malware that drops/installs\nanother piece of malware and the family to which the dropped malware belongs because the two families of malware\nserve two different functions and have two different designs.\n\n**FIRST LEVEL IDENTIFIER** **GENERAL CLASSIFICATION**\n\nDelta DDoS\n\nHotel HTTP Server\n\nIndia Installer\n\nLima Loader\n\nKilo Keylogger\n\nPapa Proxy\n\nRomeo RAT\n\nSierra Spreader[]\n\nTango Tool (Non-Classed)\n\nUniform Uninstaller\n\nWhiskey Destructive Malware (“Wiper”)\n\n**Table 4‑1: First Level Identifiers for the Lazarus Group Family Names and their Classification Meanings**\n\nThere is no temporal component to the second level identifiers given to malware families. While generally the second\nidentifiers are largely sequential (Alfa, Bravo, Charlie, and so on), the identifier does not indicate that one family came\nbefore another chronologically. Instead, the second level identifiers were assigned by the order Novetta discovered each\nparticular family.\n\n[54 International Civil Aviation Organization. “Alphabet – Radiotelephony”. http://www.icao.int/Pages/AlphabetRadiotelephony.aspx Accessed 1 December 2015.](http://www.icao.int/Pages/AlphabetRadiotelephony.aspx)\n\n\n-----\n\n|Col1|eyAlfa eyBravo eyCharlie eyDelta|\n|---|---|\n|Whisk Whisk Whisk Whisk||\n\n\n### The Lazarus Group\n\n**WHISKEY** **UNIFORMUNIFORM** **TANGOTANGO** **SIERRASIERRA** **ROMEOROMEO** **PAPAPAPA** **LIMALIMA** **KILOKILO** **INDIA** **HOTEL** **DELTA**\n\nDestructive Uninstaller Tool Spreader RAT Proxy Loader Keylogger Installer HTTP Server DDoS\nMalware (Non-\n(”Wiper”) classed)\n\n**WhiskeyAlfa** **DeltaAlfa**\n\n**WhiskeyBravo** **DeltaBravo**\n\n**DeltaCharlie**\n\n**WhiskeyCharlie**\n\n**WhiskeyDelta**\n\n**UniformAlfa** **IndiaAlpha** **HotelAlfa**\n\n**UniformJuliett** **IndiaBravo**\n\n**TangoAlfa** **RomeoAlfa** **IndiaCharlie**\n\n**TangoBravo** **RomeoBravo** **IndiaDelta**\n\n**TangoCharlie** **RomeoCharlie** **IndiaEcho**\n\n**TangoDelta** **RomeoDelta** **IndiaFoxtrot**\n\n**RomeoEcho** **IndiaGolf**\n\n**RomeoFoxtrot** **IndiaHotel**\n\n**RomeoGolf** **IndiaIndia**\n\n**RomeoHotel** **IndiaJuliett**\n\n**SierraAlfa** **RomeoMike** **IndiaKilo**\n\n**SierraBravo** **RomeoNovember** **IndiaWhiskey**\n\n**SierraCharlie** **RomeoWhiskey**\n\n**SierraJuliett-MikeOne**\n\n**SierraJuliett-MikeTwo**\n\n**KiloAlfa**\n\n**LimaAlfa**\n\n**LimaBravo**\n\n**LimaCharlie**\n\n**PapaAlfa** **LimaDelta**\n\n\n-----\n\n###### 4.2 Infrastructure\n\nEvidence suggests that parts of the infrastructure used for the malware variants’ set C2 touch points are unaffiliated\ncompromised hosts. IP addresses used as C2s include mail server and gaming server IPs (some of which have been\nlisted for spam activity), compromised IPs allocated to educational institutions, public VPNs[] and proxies, and several\nIPs that have been publicly posted on forums or pastebin posts with associated usernames and passwords. Given that\nseveral identified malware families contain proxy components, it is highly likely that the set C2 touch points are being\nused as proxies to mask the real C2 server. In the samples Novetta has collected and analyzed the Lazarus Group almost\nexclusively uses IP addresses over DNS addresses when specifying C2 server locations.\n\nThe plurality of identified IP addresses used by the Lazarus Group geo-locate to the United States. Other C2 locations\ninclude Taiwan, Indonesia, India, and China.\n\nThe Lazarus Group also makes use of P2P-based C2 infrastructure, as seen with the malware family SierraJuliett, whose\nvariants are used as content distribution and attack staging platforms. Notably, such an environment would facilitate\naccess to operators with even low skillsets across all infection instances by providing them a consistent and common\noperational environment (COE). Based on samples identified by Novetta, this P2P platform has been under active\ndevelopment since 2011, suggesting it was an early developmental priority for the group, likely due to its effectiveness at\nfacilitating sustained operations. The importance of such a uniform environment for operations is not limited to threat\nactors like the Lazarus Group, but is a real-world priority for the U.S. Army,[55] **[56] among others. This suggests that a cyber**\nCOE is integral for any well-organized, resourced group tasked with executing difficult operations with varying levels of\nexpertise at an individual operator’s level.\n\n55 “Common Operating Environment Architecture: Appendix C to Guidance for ‘End State’ Army Enterprise Network Architecture.” U.S. Army CIO/G-6. October 1, 2010. http://ciog6.army.mil/LinkClick.aspx?fileticket=udbujAHXm­\n\nK0%3D&tabid=79\n\n56 “Common Operating Environment assists Army Modernizatio.” Army.mil. February 15, 2013. http://www.army.mil/article/96650/Common_Operating_Environment_assists_Army___/\n\n\n-----\n\n###### 4.3 Code Relationships\n\nThe Lazarus Group reuses a significant amount of code, to the point where the reused code snippets have formed a kind of\nsoftware development kit. As a result of this code sharing and reuse, it is possible to link seemingly disconnected malware\nfamilies together, as mentioned in Section 2.1. From the extensive similarities of common libraries and shared snippets\nof code across such a wide variety of malware types, these relationships have allowed Novetta to link the SPE destructive\nmalware to installers, loaders, DDoS malware, network tools, spreaders, RATs, and other destructive malware compiled\nover a period of several years.\n\n###### From the extensive similarities of common libraries and shared snippets of code across such a wide variety of malware types, these relationships have allowed Novetta to link the SPE destructive malware to installers, loaders, DDoS malware, network tools, spreaders, RATs, and other destructive malware compiled over a period of several years.\n\nThis section will explore the various shared code fragments found throughout the Lazarus’s collection of malware in\norder to provide a better understanding of why these particular pieces of code are prevalent and how the codes manifest\nthemselves. The shared code breaks down into four major categories: encryption, dynamic API[] loading, network\nfunctionality, and miscellaneous. An appendix to this report details the specific malware families and how they are linked\nto the Lazarus Group’s collective arsenal by code fragments, and Novetta is releasing additional in depth technical reports\nthat further detail the individual malware families.\n\n###### 4.3.1 Encryption\n\nEncryption is a powerful tool for obfuscating the true meaning of information both stored on the victim’s hard drive in\nthe form of data files or even within a malware’s binary, and when the information is traversing a more public arena such\nas the Internet. The Lazarus Group has a relatively small set of encryption and encoding schemes that the developer(s) of\nthe various Lazarus Group malware families rely upon. There are several of these encryption and encoding schemes which\nmake excellent indicators of the presence of the Lazarus Group based on their obscurity and uniqueness.\n\n**4.3.1.1 Caracachs Encryption**\n\nAn obscure encryption scheme developed by Alexandre Pukall in 2000, Caracachs is a symmetric stream cipher that takes\na minimum of 20 characters (160-bits) as the key. The C source code for Caracachs is freely available on the Internet,[57] but\nwith respect to the implementation of Caracachs within the malware used by the Lazarus group, Caracachs is typically\nseen encapsulated as a C++ class rather than a C library.\n\nThe most notable feature of Caracachs, when viewed within the binaries of the families that use it, is the stream function.\nThe source code for this function takes the form seen in Figure 6-1.\n\n57 [`“CARACACHS Cipher” http://ftp.icm.edu.pl/packages/replay.old/libraries/caracash/CARACACH.C 15 September 2015](http://ftp.icm.edu.pl/packages/replay.old/libraries/caracash/CARACACH.C)\n\n\n-----\n\n```\n          stream(unsigned int *r,unsigned long *index,unsigned long *a,unsigned long *b)\n          {\n           b[*index] = ( b[*index] * (*a) ) + 1;\n           *r = _ rotl( (*r + (( b[*index] >> 16 ) & 0x7fff)), ((*r)%16) );\n          }\n\n```\n**Figure 6-1: Caracachs stream Function**\n\nAfter compilation, and subsequent decompilation through Hex-Rays, the function takes the form seen in Figure 6-2.\n```\n          void _ _ stdcall caracachs _ stream(DWORD *r, DWORD *index, DWORD *a, DWORD *b)\n          {\n           unsigned int v4; // edx@1\n           char v5; // cl@1\n           b[*index] = *a * b[*index] + 1;\n           v4 = b[*index];\n           v5 = ((v4 >> 16) + *( _ BYTE *)r) & 0xF;\n           *r = ((((v4 >> 16) & 0x7FFF) + *r) << v5) | ((((v4 >> 16) & 0x7FFF) + *r) >> (16 – v5));\n          }\n\n```\n**Figure 6-2: Caracachs stream Function after Decompilation**\n\nThe four lines that make up the stream function make a suitable pattern for detecting Caracachs code within a binary.\nThe authors using Caracachs for Lazarus’s malware were not terribly original in their use of the cipher suite. In many\nfamilies, the key used to initialize Caracachs is set to “abcdefghijklmnopqrstuvwxyz012345\\0\\0\\0\\0\\0”, which\nis the similar to the key found within the Caracachs source code. The common function found in multiple families using\nCaracachs to set the key takes the form seen in Figure 6-3.\n```\n          void _ _ thiscall CCaracachs::GenerateKey(CCaracachs *this)\n          {\n           qmemcpy(this->szPassword, “abcdefghijklmnopqrstuvwxyz012345”, sizeof(this-\n          >szPassword));\n           this->dwPasswordLength = 0x20;\n           CCaracachs::SetKey(this, 0x20u, this->szPassword);\n          }\n\n```\n**Figure 6-3: Caracachs Class’s GenerateKey Function**\n\nThe original source code performs the same key initialization feat by using the code snippet seen in Figure 6-4.\n```\n           strcpy(code,”abcdefghijklmnopqrst”); /* the password */\n           longueur=20; /* length of the key up to 256 characters */\n           /* init the key */\n           pc3init(longueur,code);\n\n```\n**Figure 6-4: Establishing the Key for Caracachs in the Original Source Code**\n\nThe authors merely encapsulated the initialization of the cipher within a single member of the C++ class, all without\nchanging the password or even the order of variable assignments. This process of reusing entire code snippets without any\nmodifications appears to be repeated by the developer(s) throughout a number of Lazarus Group tools.\n\n\n-----\n\n**4.3.1.2 Basic XOR with Constant 0xA7**\n\nIt is not uncommon for malware to use a simple XOR to obfuscate strings and data within a binary. It is also not uncommon\nfor authors to use the same byte across multiple variants of the same malware and even multiple families that can be\nattributed to the same (set of) authors. By itself, looking at the XOR function within a binary as an indicator of authorship is\nusually a poor choice. However, combined with other attributes of the surrounding code, an XOR function found in multiple\nvariants and families can provide reassurance that those variants and/or families have some code familiarity.\n\nThe Lazarus Group uses simple, but somewhat distinct, XOR obfuscation systems. When dealing with string\nobfuscations, the Lazarus Group uses the value 0xA7 to transform null-terminated strings by means of XOR each byte\nwithin the string by 0xA7. The 0xA7 scheme is exclusively used for null-terminated strings, as the XOR function depends\non a null character to indicate the end of the data to transform. Slight variations appear between families (Figure 6-5\nprovides one representative example), but two features of the 0xA7 scheme remain constant: the length of the data to\ntransform is calculated by locating the first null and each byte is XOR transformed against the byte 0xA7.\n```\n          char* __cdecl XorA7(const char *pBuffer)\n          {\n           unsigned char *pOut = malloc(strlen(pBuffer) + 1);\n           int j = 0;\n           if ( strlen(pBuffer) != 0 )\n           {\n            p = pOut;\n            for ( int i = pBuffer – pOut; ; i = pBuffer – pOut)\n            {\n             ++j;\n             *p = p[i] ^ 0xA7;\n             ++p;\n             if ( j >= strlen(pBuffer) )\n              break;\n            }\n           }\n           pOut[j] = 0;\n           return pOut;\n          }\n\n```\n**Figure 6-5: Lazarus Group’s 0xA7 Transform Function**\n\n\n-----\n\n**4.3.1.3 DNSCALC-Style Encoding**\n\nDNSCALC[] is an older malware family, used by several APT groups and first profiled in 2010, whose claim to fame was the\nuse of DNS lookups for domain names that would return specific IP addresses used to calculate the listening port number\nfor the C2 server. One notable feature of DNSCALC was the use of a combination of XOR with an ADD operation and\nXOR with a SUB operation for the purposes of encrypting and decrypting data streams. Since at least 2011, the Lazarus\nGroup has commandeered this technique for use in a variety of their malware families. The DNSCALC version of this\nencoding/decoding scheme performed the transformation operation on each byte using two lines of C code such as\n```\n          d += 122;\n          d ^= 25;\n\n```\nwhere the values 122 and 25 constitute the encryption and decryption keys. The Lazarus Group performs the same\noperation in a single line of code, such as\n```\n          d = (e ^ 25) – 122\n\n```\nand\n```\n          e = (d + 122) ^ 25\n\n```\nThis subtle, but important, distinction in style indicates that the code was not directly copied from DNSCALC, but rather\nwas inspired by DNSCALC or another source that performs the same transform. It should be noted that DNSCALC\nmodified the Gh0st RAT MyEncode function, seen below, by reversing the order of operations meaning that the Lazarus\nGroup’s use of the encoding scheme represents a derivation of an existing derivation.\n```\n          char* MyEncode(char *str)\n          {\n              int i, len;\n              char *p;\n              char *s, *data;\n              len = strlen(str) + 1;\n              s = (char *)malloc(len);\n              memcpy(s, str, len);\n              for (i = 0; i < len; i++)\n              {\n                  s[i] ^= 0x19;\n                  s[i] += 0x86;\n              }\n              base64 _ encode(s, len, &data);\n              free(s);\n              return data;\n          }\n\n```\n**The DNSCALC-style encoding scheme code is heavily used throughout many of the various malware families for which the Lazarus Group is**\n**responsible.**\n\n\n-----\n\n**4.3.1.4 Space-Dot Encoding**\n\nStrings, especially when used to dynamically load Windows API functions at runtime, provide a significant amount of\nsurface for antivirus and host-based IDS[] to detect potentially malicious code. For this reason, it is not uncommon for\nmalware authors to obfuscate strings that identify the Windows API functions the malware will attempt to dynamically\nload. Simple obfuscations are generally more than adequate to defeat string-based detection systems, allowing attackers\nto use simple XORs or character substitution techniques to get around detection. The Lazarus Group used a simple\nmethod to confuse systems looking for the API names they were to load. Instead of obfuscating the name by transforming\nindividual characters, the names were interrupted with unnecessary characters such as dots, spaces, greater than, less\nthan, and underscore characters. This broke up names such as ChangeServiceConfig2A into “Cha>nge>Ser>vi>\n**>ceCo>nfi>g2A.”**\n\nNovetta has dubbed this scheme of inserting junk characters into API name strings as “Space-Dot Encoding” based on the\nfact that the bulk of the implementations of the system only introduces spaces and dots. In order to recover the original,\nunmolested string, the Space-Dot decoding function will scan character by character through the supplied string, copying\neach byte to a global buffer so long as the character does not match one of the undesirable characters. Upon completion of\nthe function, a pointer to the buffer containing the desired string is returned to the caller. The function that performs the\ndecoding takes the form of seen in Figure 6-6.\n```\n          char * _ _ cdecl DecodeString(char *pzString)\n          {\n           char* p = pzString;\n           char* b = g _ decodingBuffer;\n           memset(decodingBuffer, 0, 0x50u);\n           while ( *p )\n           {\n            char c = *p;\n            if ( *p != ‘<’ && c != ‘>’ && c != ‘ _ ’ && c != ‘ ‘ && c != ‘.’ )\n             *b++ = c;\n            ++p;\n           }\n           return g _ decodingBuffer;\n          }\n\n```\n**Figure 6-6: Space-Dot Decoding Function**\n\nAs the usage of the Space-Dot Encoding aged, the authors removed “>”, “<”, and “ _ ” from the character set and instead\nrelied on only spaces and dots to provide the necessary junk characters to throw off detection systems. The result is\na slightly simpler if statement, but otherwise the remainder of the Space-Dot decoding function remained constant\nthroughout the use of the scheme in the Lazarus Group’s malware.\n\n**4.3.1.5 RSA Encryption**\n\nSeveral families within the Lazarus Group’s malware collective use public/private key encryption. Some use the\nencryption for securing documents that the malware exfiltrates, while others use it for signing and authenticating\ncommands. Regardless of the use, the malware families using the RSA scheme share a common code library to implement\nthe cryptographic functionality.\n\nPublic/private key encryption, or asymmetric encryption, is a form of encryption where the key used to encrypt data\ndiffers from the key used to decrypt the data. The effect of having asymmetric encryption in malware is that the authors\nand/or operators of the malware can embed the decryption key for commands into the malware while retaining the\nencryption key for themselves. This restricts others from issuing commands to the malware since the encryption key is\nnot known, thereby preventing those not associated with the malware from attempting to inject commands.\n\n\n-----\n\nBased on CRSA,[58] the Lazarus Group’s implementation of RSA wraps the CRSA class into a single function for encryption\nand decryption (Figure 6-7).\n```\n          char * _ _ cdecl RSATransform(int mode, char *pvKey, int dwKeyLength, char *pvIn, int\n          dwOutBufSize, char *pvOut, DWORD *pdwOutputLength)\n          {\n           int v8; // ecx@2\n           int v9; // eax@4\n           char *result; // eax@7\n           signed int v11; // eax@12\n           CRSA rsa; // [sp+10h] [bp-58h]@1\n           int eh; // [sp+64h] [bp-4h]@1\n           CRSA::CRSA(&rsa);\n           eh = 0;\n           if ( pvOut\n            || ((v8 = (dwKeyLength + 7) >> 3, !mode) || mode == 1 ? (v9 = (dwOutBufSize – 1) /\n          (v8 – 8) + 1) : (v9 = (dwOutBufSize – 1) / v8 + 1, v8 -= 8),\n              (pvOut = (char *)LocalAlloc(0x40u, v8 * v9)) != 0) )\n           {\n            if ( mode && mode != RSA _ PUB _ DEC )\n             CRSA::SetPrivKey(&rsa, pvKey, dwKeyLength);\n            else\n             CRSA::SetPubKey(&rsa, pvKey, dwKeyLength);\n            v11 = CRSA::transform(&rsa, mode, pvIn, dwOutBufSize, pvOut);\n            if ( pdwOutputLength )\n             *pdwOutputLength = v11;\n            eh = -1;\n            CRSA::Dstr(&rsa);\n            result = pvOut;\n           }\n           else\n           {\n            eh = -1;\n            CRSA::Dstr(&rsa);\n            result = 0;\n           }\n           return result;\n          }\n\n```\n**Figure 6-7: The Lazarus Group’s RSA Encapsulation Function as seen after Decompilation**\n\nThe RSATransform function is a unique implementation that appears to be specific to the Lazarus Group, thereby making\nit a valuable identifier of malware related to the group. The function can operate in one of four modes: public key encryption,\npublic key decryption, private key encryption, and private key decryption. However, across the various identified samples\nthat use RSATransform, only the public key encryption and decryption modes have been observed by Novetta.\n\n58 [“RSAUtil.cpp RSA.cpp” http://read.pudn.com/downloads145/sourcecode/windows/system/633068/RSAUtil/RSA.cpp__.htm 16 March 2004](http://read.pudn.com/downloads145/sourcecode/windows/system/633068/RSAUtil/RSA.cpp__.htm)\n\n\n-----\n\n**4.3.1.6 Shared Public Key**\n\nWhile not necessarily a shared library, the use of a common public key is a definitive, identifiable characteristic that can\nlink multiple families of malware to a common actor or actor set. With respect to the Lazarus Group, there is a common\npublic key that is used in multiple families within the group’s collective. This fact would indicate that there is a single\nprivate key that is shared across malware for decryption/authentication, controlled by the Lazarus Group. The reuse of\ncryptographic keys has also been discussed by security researchers profiling both Operation Troy and Operation 1Mission.\nFound originally in a variant of SierraJuliett[59] family of malware from 2011, the following 1024-bit key has been identified\nin malware as recently as 2015:\n```\n       47A713F89BBC74CBCE771E0F00A039561BC566F394B1EA2271DE2B42CCE9F72F31E722B06FBB0203FC0A2F51E-\n       ED054250EE34FF09FBAE7AC20D694E6BAD3AB4CD98CFD1C7FBA4875E5853966881EE9C9745106DECBC1D13747B-\n       61C629AB2DCFCB809CE88C5927DF017E75B8262F96AE4EEDBE65DC9185D202A32C3E807CD99CE\n\n```\nTo date, the 1024-bit key has been observed in samples from the RomeoWhiskey, SierraBravo, and SierraCharlie families.\n\n###### 4.3.2 Dynamic API Loading\n\nDynamic API loading is a technique in which the standard Windows functions LoadLibrary and GetProcAddress\nare used to dynamically load desired API functions at run time. The import table of a binary can easily give away the\nintent of the executable. For example, a binary that has SetWindowsHookEx and several of the Winsock API functions is\nmost likely a network-capable keylogger. As such, certain combinations of API function imports can indicate suspicious\nbehavior, allowing antivirus vendors to use such indicators when determining the intent of a binary through their\nvarious heuristic detection schemes. Therefore, it is beneficial for malware authors to obfuscate the more severe or telling\nAPI functions they need to load and keep these functions out of the import table of the binary. This leads to the use of\ndynamic API loading schemes.\n\nDynamic API loading allows the malware authors to remove the names of the telling APIs from the import table but still\nrequires the malware authors to provide the full name of the desired API functions to GetProcAddress. This leads to\nanother facet of dynamic API loading: API name obfuscation. GetProcAddress, in order to load any API function into\nmemory, requires either an ordinal number identifying the API function in question or the name of the API function. It is\nrare that the ordinal number is used, as the ordinal number could, in theory, change from version to version of Windows\nand therefore requires a significant amount of code maintenance on the part of the author. However, API names do not\nchange between versions, so authors can simply obfuscate the name of the desired API functions up to the point of calling\n```\n       GetProcAddress. The obfuscation of API names, in string form within the binary, can allow malware authors to avoid\n\n```\nstring-based signature detection which increases the chances of a malware binary evading simpler AV signature detection.\nAdditionally, the use of API name obfuscation requires additional work on the part of the reverse engineers analyzing the\nmalware since the analyst must now reconstruct the original API names.\n\nA common feature of the malware families under the Lazarus Group’s umbrella is the use of dynamic API loading. The\nstructure of dynamic API loading in most malware is typically to decrypt the API name string then load the API via\n```\n       GetProcAddress. The Lazarus Group adheres to this same model. However, it is the use of the decryption schemes\n\n```\nthat are specific to the Lazarus Group and allow for easy identification of malware related to the group. There are two\npredominate versions of dynamic API loading found in the majority of the Lazarus Group’s malware: XOR 0xA7 with\nSpace-Dot (Figure 6-8) and simply XOR 0xA7 (Figure 6-9).\n\n59 <reference to external report>\n\n\n-----\n\n**Figure 6-8: Dynamic API Loading Function using Both XOR 0xA7 and Space-Dot Encoding**\n```\n                                                   XOR 0xA7 Decryptor\n                                                   GetProcAddress\n\n```\n**Figure 6-9: Dynamic API Loading Function Utilizing only a Single Encoding Scheme (XOR 0xA7)**\n\nAnother feature of the dynamic API loading used by the Lazarus Group is not immediately apparent at first glance: consistency.\nTypically, when the Lazarus Group uses dynamic API loading within a binary, each function will load one DLL at a time. For\nexample, there is a function that will load the necessary API functions from kernel32.dll, there is another function for\nloading API functions from advapi32.dll, and so on. These individual functions are shared across samples both within\nfamilies and among other families. The dynamic API loading functions generally are not tailored for a specific malware family.\nThis is seen in many examples where a dynamic API loading function will load API functions into memory that the malware\ndoes not use it, or even reference it, beyond the initial load. This indicates that the dynamic API loading functions are part of a\nlarger library of functions and, as such, provide a viable indicator of code specific to the Lazarus Group.\n\n###### 4.3.3 Network Functionality\n\nThe way a developer interacts with a network touch point can provide a fingerprint of the developer. When the developer\nbuilds a library for network interaction and uses the library in multiple malware families, analysts can easily identify\nrelated families based on the code reuse. The developer(s) of the Lazarus Group’s malware routinely use network routines\nand techniques across multiple families within the Lazarus Group’s malware collective. This section explores several of\nthe more prominent techniques the developer(s) used in the Lazarus Group malware families.\n\n\n-----\n\n**4.3.3.1 Fake TLS Communication**\n\nSeveral of the families within the Lazarus Group’s arsenal employ a rather unique form of communication encryption that\nmimics TLS communication but ultimately uses a completely different encryption method. This type of communication\nhas the advantage of appearing to be legitimate TLS traffic, thereby evading many network-based IDS detections and\nat the same time protecting against SSL man-in-the-middle decryption attacks that would reveal the contents of the\nencrypted communication.\n\nThe fake TLS communication begins when a sample opens a socket between the itself and its corresponding C2 server,\nand the client side of the channel sends a TLS ClientHello packet. The basic format of a TLS ClientHello packet is\nas follows:\n```\n             struct {\n               ProtocolVersion client _ version;\n               Random random;\n               SessionID session _ id;\n               CipherSuite cipher _ suites<2..2^16-2>;\n               CompressionMethod compression _ methods<1..2^8-1>;\n               select (extensions _ present) {\n                 case false:\n                   struct {};\n                 case true:\n                   Extension extensions<0..2^16-1>;\n               };\n             } ClientHello;\n\n```\n**Figure 6-10: RFC 5246 Definition of the ClientHello Packet**\n\nThe ClientHello packet will vary for each communication but will contain some common characteristics. When\nconstructing the ClientHello packet, the Trojan probabilistically determine which sections to include and the values\nof those sections, with the exceptions of the client _ version field, which is static at TLS 1.0 (0x301), and the\n```\n       compression _ methods field, which is set to empty. The Trojan fills the random field with a 32-byte random value\n\n```\ngenerated using the rand API function. The first four bytes of the field are replaced with the current time as supplied\nby the time API function. The session _ id field will only appear if the value of fIncludeSessionIDTest2 is\nnon-zero as defined by the following section of code:\n```\n          fIncludeSessionIDTest1 = rand() & 0x80000007;\n           fIncludeSessionIDTest2 = fIncludeSessionIDTest1 == 0;\n           if ( (fIncludeSessionIDTest1 & 0x80000000) != 0 )\n            fIncludeSessionIDTest2 = ((( _ BYTE)fIncludeSessionIDTest1 – 1) | 0xFFFFFFF8) == -1;\n\n```\nIf the session _ id field is included in the ClientHello, the value is filled with a 32-byte randomly generated value,\nagain using the rand API function.\n\nThe cipher _ suite value is always present and is one of four predefined values. To determine which of the predefined\nsuite sets to use, the fake TLS scheme will again rely on the rand API function. Assuming the PRNG of rand is suitably\nrandom, this means that there is a 25% chance for any particular cipher suite being selected. Table 6-1 below provides the\npossible cipher suites that the fake TLS scheme uses.\n\n\n-----\n\n|SUITE|SUITE 2|\n|---|---|\n|(12 Entries)|(11 Entries)|\n|TLS _ RSA _ WITH _ AES _ 128 _ CBC _ SHA TLS _ RSA _ WITH _ AES _ 256 _ CBC _ SHA TLS _ RSA _ WITH _ RC4 _ 128 _ SHA TLS _ RSA _ WITH _ 3DES _ EDE _ CBC _ SHA TLS _ ECDHE _ RSA _ WITH _ AES _ 128 _ CBC _ SHA TLS _ ECDHE _ RSA _ WITH _ AES _ 256 _ CBC _ SHA TLS _ ECDHE _ ECDSA _ WITH _ AES _ 128 _ CBC _ SHA TLS _ ECDHE _ ECDSA _ WITH _ AES _ 256 _ CBC _ SHA TLS _ DHE _ DSS _ WITH _ AES _ 128 _ CBC _ SHA TLS _ DHE _ DSS _ WITH _ AES _ 256 _ CBC _ SHA TLS _ DHE _ DSS _ WITH _ 3DES _ EDE _ CBC _ SHA TLS _ RSA _ WITH _ RC4 _ 128 _ MD5|TLS _ RSA _ WITH _ RC4 _ 128 _ MD5 TLS _ RSA _ WITH _ RC4 _ 128 _ SHA TLS _ RSA _ WITH _ 3DES _ EDE _ CBC _ SHA TLS _ RSA _ WITH _ DES _ CBC _ SHA TLS _ RSA _ EXPORT1024 _ WITH _ RC4 _ 56 _ SHA TLS _ RSA _ EXPORT1024 _ WITH _ DES _ CBC _ SHA TLS _ RSA _ EXPORT _ WITH _ RC4 _ 40 _ MD5 TLS _ RSA _ EXPORT _ WITH _ RC2 _ CBC _ 40 _ MD5 TLS _ DHE _ DSS _ WITH _ 3DES _ EDE _ CBC _ SHA TLS _ DHE _ DSS _ WITH _ DES _ CBC _ SHA TLS _ DHE _ DSS _ EXPORT1024 _ WITH _ DES _ CBC _ SHA|\n|SUITE 3|SUITE 4|\n|(36 Entries)|(36 Entries)|\n|TLS _ EMPTY _ RENEGOTIATION _ INFO _ SCSV TLS _ ECDHE _ ECDSA _ WITH _ AES _ 256 _ CBC _ SHA TLS _ ECDHE _ RSA _ WITH _ AES _ 256 _ CBC _ SHA TLS _ DHE _ RSA _ WITH _ CAMELLIA _ 256 _ CBC _ SHA TLS _ DHE _ DSS _ WITH _ CAMELLIA _ 256 _ CBC _ SHA TLS _ DHE _ RSA _ WITH _ AES _ 256 _ CBC _ SHA TLS _ DHE _ DSS _ WITH _ AES _ 256 _ CBC _ SHA TLS _ ECDH _ RSA _ WITH _ AES _ 256 _ CBC _ SHA TLS _ ECDH _ ECDSA _ WITH _ AES _ 256 _ CBC _ SHA TLS _ RSA _ WITH _ CAMELLIA _ 256 _ CBC _ SHA TLS _ RSA _ WITH _ AES _ 256 _ CBC _ SHA TLS _ ECDHE _ ECDSA _ WITH _ RC4 _ 128 _ SHA TLS _ ECDHE _ ECDSA _ WITH _ AES _ 128 _ CBC _ SHA TLS _ ECDHE _ RSA _ WITH _ RC4 _ 128 _ SHA TLS _ ECDHE _ RSA _ WITH _ AES _ 128 _ CBC _ SHA TLS _ DHE _ RSA _ WITH _ CAMELLIA _ 128 _ CBC _ SHA TLS _ DHE _ DSS _ WITH _ CAMELLIA _ 128 _ CBC _ SHA TLS _ DHE _ RSA _ WITH _ AES _ 128 _ CBC _ SHA TLS _ DHE _ DSS _ WITH _ AES _ 128 _ CBC _ SHA TLS _ ECDH _ RSA _ WITH _ RC4 _ 128 _ SHA TLS _ ECDH _ RSA _ WITH _ AES _ 128 _ CBC _ SHA TLS _ ECDH _ ECDSA _ WITH _ RC4 _ 128 _ SHA TLS _ ECDH _ ECDSA _ WITH _ AES _ 128 _ CBC _ SHA TLS _ RSA _ WITH _ SEED _ CBC _ SHA TLS _ RSA _ WITH _ CAMELLIA _ 128 _ CBC _ SHA TLS _ RSA _ WITH _ RC4 _ 128 _ SHA TLS _ RSA _ WITH _ RC4 _ 128 _ MD5 TLS _ RSA _ WITH _ AES _ 128 _ CBC _ SHA TLS _ ECDHE _ ECDSA _ WITH _ 3DES _ EDE _ CBC _ SHA TLS _ ECDHE _ RSA _ WITH _ 3DES _ EDE _ CBC _ SHA TLS _ DHE _ RSA _ WITH _ 3DES _ EDE _ CBC _ SHA TLS _ DHE _ DSS _ WITH _ 3DES _ EDE _ CBC _ SHA TLS _ ECDH _ RSA _ WITH _ 3DES _ EDE _ CBC _ SHA TLS _ ECDH _ ECDSA _ WITH _ 3DES _ EDE _ CBC _ SHA SSL _ RSA _ FIPS _ WITH _ 3DES _ EDE _ CBC _ SHA TLS _ RSA _ WITH _ 3DES _ EDE _ CBC _ SHA|TLS _ ECDHE _ ECDSA _ WITH _ AES _ 256 _ CBC _ SHA TLS _ ECDHE _ RSA _ WITH _ AES _ 256 _ CBC _ SHA TLS _ DHE _ RSA _ WITH _ CAMELLIA _ 256 _ CBC _ SHA TLS _ DHE _ DSS _ WITH _ CAMELLIA _ 256 _ CBC _ SHA TLS _ DHE _ RSA _ WITH _ AES _ 256 _ CBC _ SHA TLS _ DHE _ DSS _ WITH _ AES _ 256 _ CBC _ SHA TLS _ ECDH _ RSA _ WITH _ AES _ 256 _ CBC _ SHA TLS _ ECDH _ ECDSA _ WITH _ AES _ 256 _ CBC _ SHA TLS _ RSA _ WITH _ CAMELLIA _ 256 _ CBC _ SHA TLS _ RSA _ WITH _ AES _ 256 _ CBC _ SHA TLS _ ECDHE _ ECDSA _ WITH _ RC4 _ 128 _ SHA TLS _ ECDHE _ ECDSA _ WITH _ AES _ 128 _ CBC _ SHA TLS _ ECDHE _ RSA _ WITH _ RC4 _ 128 _ SHA TLS _ ECDHE _ RSA _ WITH _ AES _ 128 _ CBC _ SHA TLS _ DHE _ RSA _ WITH _ CAMELLIA _ 128 _ CBC _ SHA TLS _ DHE _ DSS _ WITH _ CAMELLIA _ 128 _ CBC _ SHA TLS _ DHE _ DSS _ WITH _ RC4 _ 128 _ SHA TLS _ DHE _ RSA _ WITH _ AES _ 128 _ CBC _ SHA TLS _ DHE _ DSS _ WITH _ AES _ 128 _ CBC _ SHA TLS _ ECDH _ RSA _ WITH _ RC4 _ 128 _ SHA TLS _ ECDH _ RSA _ WITH _ AES _ 128 _ CBC _ SHA TLS _ ECDH _ ECDSA _ WITH _ RC4 _ 128 _ SHA TLS _ ECDH _ ECDSA _ WITH _ AES _ 128 _ CBC _ SHA TLS _ RSA _ WITH _ SEED _ CBC _ SHA TLS _ RSA _ WITH _ CAMELLIA _ 128 _ CBC _ SHA TLS _ RSA _ WITH _ RC4 _ 128 _ SHA TLS _ RSA _ WITH _ RC4 _ 128 _ MD5 TLS _ RSA _ WITH _ AES _ 128 _ CBC _ SHA TLS _ ECDHE _ ECDSA _ WITH _ 3DES _ EDE _ CBC _ SHA TLS _ ECDHE _ RSA _ WITH _ 3DES _ EDE _ CBC _ SHA TLS _ DHE _ RSA _ WITH _ 3DES _ EDE _ CBC _ SHA TLS _ DHE _ DSS _ WITH _ 3DES _ EDE _ CBC _ SHA TLS _ ECDH _ RSA _ WITH _ 3DES _ EDE _ CBC _ SHA TLS _ ECDH _ ECDSA _ WITH _ 3DES _ EDE _ CBC _ SHA SSL _ RSA _ FIPS _ WITH _ 3DES _ EDE _ CBC _ SHA TLS _ RSA _ WITH _ 3DES _ EDE _ CBC _ SHA|\n\n\n**SUITE** **SUITE 2**\n\n(12 Entries) (11 Entries)\n```\n          TLS _ RSA _ WITH _ AES _ 128 _ CBC _ SHA TLS _ RSA _ WITH _ RC4 _ 128 _ MD5\n          TLS _ RSA _ WITH _ AES _ 256 _ CBC _ SHA TLS _ RSA _ WITH _ RC4 _ 128 _ SHA\n          TLS _ RSA _ WITH _ RC4 _ 128 _ SHA TLS _ RSA _ WITH _ 3DES _ EDE _ CBC _ SHA\n          TLS _ RSA _ WITH _ 3DES _ EDE _ CBC _ SHA TLS _ RSA _ WITH _ DES _ CBC _ SHA\n          TLS _ ECDHE _ RSA _ WITH _ AES _ 128 _ CBC _ SHA TLS _ RSA _ EXPORT1024 _ WITH _ RC4 _ 56 _ SHA\n          TLS _ ECDHE _ RSA _ WITH _ AES _ 256 _ CBC _ SHA TLS _ RSA _ EXPORT1024 _ WITH _ DES _ CBC _ SHA\n          TLS _ ECDHE _ ECDSA _ WITH _ AES _ 128 _ CBC _ SHA TLS _ RSA _ EXPORT _ WITH _ RC4 _ 40 _ MD5\n          TLS _ ECDHE _ ECDSA _ WITH _ AES _ 256 _ CBC _ SHA TLS _ RSA _ EXPORT _ WITH _ RC2 _ CBC _ 40 _ MD5\n          TLS _ DHE _ DSS _ WITH _ AES _ 128 _ CBC _ SHA TLS _ DHE _ DSS _ WITH _ 3DES _ EDE _ CBC _ SHA\n          TLS _ DHE _ DSS _ WITH _ AES _ 256 _ CBC _ SHA TLS _ DHE _ DSS _ WITH _ DES _ CBC _ SHA\n          TLS _ DHE _ DSS _ WITH _ 3DES _ EDE _ CBC _ SHA TLS _ DHE _ DSS _ EXPORT1024 _ WITH _ DES _ CBC _ SHA\n          TLS _ RSA _ WITH _ RC4 _ 128 _ MD5\n\n```\n**SUITE 3** **SUITE 4**\n\n(36 Entries) (36 Entries)\n```\n          TLS _ EMPTY _ RENEGOTIATION _ INFO _ SCSV TLS _ ECDHE _ ECDSA _ WITH _ AES _ 256 _ CBC _ SHA\n          TLS _ ECDHE _ ECDSA _ WITH _ AES _ 256 _ CBC _ SHA TLS _ ECDHE _ RSA _ WITH _ AES _ 256 _ CBC _ SHA\n          TLS _ ECDHE _ RSA _ WITH _ AES _ 256 _ CBC _ SHA TLS _ DHE _ RSA _ WITH _ CAMELLIA _ 256 _ CBC _ SHA\n          TLS _ DHE _ RSA _ WITH _ CAMELLIA _ 256 _ CBC _ SHA TLS _ DHE _ DSS _ WITH _ CAMELLIA _ 256 _ CBC _ SHA\n          TLS _ DHE _ DSS _ WITH _ CAMELLIA _ 256 _ CBC _ SHA TLS _ DHE _ RSA _ WITH _ AES _ 256 _ CBC _ SHA\n          TLS _ DHE _ RSA _ WITH _ AES _ 256 _ CBC _ SHA TLS _ DHE _ DSS _ WITH _ AES _ 256 _ CBC _ SHA\n          TLS _ DHE _ DSS _ WITH _ AES _ 256 _ CBC _ SHA TLS _ ECDH _ RSA _ WITH _ AES _ 256 _ CBC _ SHA\n          TLS _ ECDH _ RSA _ WITH _ AES _ 256 _ CBC _ SHA TLS _ ECDH _ ECDSA _ WITH _ AES _ 256 _ CBC _ SHA\n          TLS _ ECDH _ ECDSA _ WITH _ AES _ 256 _ CBC _ SHA TLS _ RSA _ WITH _ CAMELLIA _ 256 _ CBC _ SHA\n          TLS _ RSA _ WITH _ CAMELLIA _ 256 _ CBC _ SHA TLS _ RSA _ WITH _ AES _ 256 _ CBC _ SHA\n          TLS _ RSA _ WITH _ AES _ 256 _ CBC _ SHA TLS _ ECDHE _ ECDSA _ WITH _ RC4 _ 128 _ SHA\n          TLS _ ECDHE _ ECDSA _ WITH _ RC4 _ 128 _ SHA TLS _ ECDHE _ ECDSA _ WITH _ AES _ 128 _ CBC _ SHA\n          TLS _ ECDHE _ ECDSA _ WITH _ AES _ 128 _ CBC _ SHA TLS _ ECDHE _ RSA _ WITH _ RC4 _ 128 _ SHA\n          TLS _ ECDHE _ RSA _ WITH _ RC4 _ 128 _ SHA TLS _ ECDHE _ RSA _ WITH _ AES _ 128 _ CBC _ SHA\n          TLS _ ECDHE _ RSA _ WITH _ AES _ 128 _ CBC _ SHA TLS _ DHE _ RSA _ WITH _ CAMELLIA _ 128 _ CBC _ SHA\n          TLS _ DHE _ RSA _ WITH _ CAMELLIA _ 128 _ CBC _ SHA TLS _ DHE _ DSS _ WITH _ CAMELLIA _ 128 _ CBC _ SHA\n          TLS _ DHE _ DSS _ WITH _ CAMELLIA _ 128 _ CBC _ SHA TLS _ DHE _ DSS _ WITH _ RC4 _ 128 _ SHA\n          TLS _ DHE _ RSA _ WITH _ AES _ 128 _ CBC _ SHA TLS _ DHE _ RSA _ WITH _ AES _ 128 _ CBC _ SHA\n          TLS _ DHE _ DSS _ WITH _ AES _ 128 _ CBC _ SHA TLS _ DHE _ DSS _ WITH _ AES _ 128 _ CBC _ SHA\n          TLS _ ECDH _ RSA _ WITH _ RC4 _ 128 _ SHA TLS _ ECDH _ RSA _ WITH _ RC4 _ 128 _ SHA\n          TLS _ ECDH _ RSA _ WITH _ AES _ 128 _ CBC _ SHA TLS _ ECDH _ RSA _ WITH _ AES _ 128 _ CBC _ SHA\n          TLS _ ECDH _ ECDSA _ WITH _ RC4 _ 128 _ SHA TLS _ ECDH _ ECDSA _ WITH _ RC4 _ 128 _ SHA\n          TLS _ ECDH _ ECDSA _ WITH _ AES _ 128 _ CBC _ SHA TLS _ ECDH _ ECDSA _ WITH _ AES _ 128 _ CBC _ SHA\n          TLS _ RSA _ WITH _ SEED _ CBC _ SHA TLS _ RSA _ WITH _ SEED _ CBC _ SHA\n          TLS _ RSA _ WITH _ CAMELLIA _ 128 _ CBC _ SHA TLS _ RSA _ WITH _ CAMELLIA _ 128 _ CBC _ SHA\n          TLS _ RSA _ WITH _ RC4 _ 128 _ SHA TLS _ RSA _ WITH _ RC4 _ 128 _ SHA\n          TLS _ RSA _ WITH _ RC4 _ 128 _ MD5 TLS _ RSA _ WITH _ RC4 _ 128 _ MD5\n          TLS _ RSA _ WITH _ AES _ 128 _ CBC _ SHA TLS _ RSA _ WITH _ AES _ 128 _ CBC _ SHA\n          TLS _ ECDHE _ ECDSA _ WITH _ 3DES _ EDE _ CBC _ SHA TLS _ ECDHE _ ECDSA _ WITH _ 3DES _ EDE _ CBC _ SHA\n          TLS _ ECDHE _ RSA _ WITH _ 3DES _ EDE _ CBC _ SHA TLS _ ECDHE _ RSA _ WITH _ 3DES _ EDE _ CBC _ SHA\n          TLS _ DHE _ RSA _ WITH _ 3DES _ EDE _ CBC _ SHA TLS _ DHE _ RSA _ WITH _ 3DES _ EDE _ CBC _ SHA\n          TLS _ DHE _ DSS _ WITH _ 3DES _ EDE _ CBC _ SHA TLS _ DHE _ DSS _ WITH _ 3DES _ EDE _ CBC _ SHA\n          TLS _ ECDH _ RSA _ WITH _ 3DES _ EDE _ CBC _ SHA TLS _ ECDH _ RSA _ WITH _ 3DES _ EDE _ CBC _ SHA\n          TLS _ ECDH _ ECDSA _ WITH _ 3DES _ EDE _ CBC _ SHA TLS _ ECDH _ ECDSA _ WITH _ 3DES _ EDE _ CBC _ SHA\n          SSL _ RSA _ FIPS _ WITH _ 3DES _ EDE _ CBC _ SHA SSL _ RSA _ FIPS _ WITH _ 3DES _ EDE _ CBC _ SHA\n          TLS _ RSA _ WITH _ 3DES _ EDE _ CBC _ SHA TLS _ RSA _ WITH _ 3DES _ EDE _ CBC _ SHA\n\n```\n**Table 6-1: Fake TLS Scheme’s Predfined Cipher Suites**\n\nThe extensions field provides the area of the greatest variability within a ClientHello packet generated as part of the\nfake TLS communication scheme. The Trojan may include zero or more of the following extensions (in order):\n\n\n-----\n\n|accounts.google.com apps.skypeassets.com b.stats.ebay.com daw.apple.com extended-validation-ssl.verisign.com fls-na.amazon.com images-na.ssl-images-amazon.com login.live.com login.skype.com login.yahoo.com s.imp.microsoft.com s1-s.licdn.com sc.imp.live.com secure.logmein.com secure.shared.live.com secure.skype.com secure.skypeassets.com|secureir.ebaystatic.com securemetrics.apple.com signin.ebay.com skydrive.live.com ssl.google-analytics.com ssl.gstatic.com sstats.adobe.com startpage.com support.msn.com support.oracle.com supportprofile.apple.com urs.microsoft.com verify.adobe.com www.adobetag.com www.apple.com www.amazon.com www.google.com|\n|---|---|\n\n|ELLIPTICAL CURVE SET 1 (3 CURVES)|ELLIPTICAL CURVE SET 2 (4 CURVES)|\n|---|---|\n|SECT193R1 SECP256R1 SECP384R1|SECT233K1 SECP256R1 SECP384R1 SECP512R1|\n\n\nThe extensions field provides the area of the greatest variability within a ClientHello packet generated as part of the\nfake TLS communication scheme. The Trojan may include zero or more of the following extensions (in order):\n\n             - `renegotiation _ info (80% probability)`\n\n             - `server _ name` **(80% probability)**\n\n             - `status _ request (80% probability)`\n\n             - `ellipic _ curves with ec _ point _ formats (80% probability)`\n\n             - `SessionTicket TLS` **(10% probability)**\n\n             - `next _ protocol _ negotiation` **(10% probability)**\n\nThe renegotiation _ info, SessionTicket TLS and next _ protocol _ negotiation extensions all have a 0\nbyte length, thereby remaining static in their values. The server _ name extension will use either www.amazon.com\nor www.google.com as the name of the server to which the TLS client appears to be connecting for the majoriy of the\nLazarus Group’s Trojans that employ the fake TLS scheme (there is a 50% probability of either domain name being choose\nby the Trojan). A smaller number of Trojans that employ the fake TLS communication scheme can have up to 34 domain\nnames to choose from. Table 6-2 identifies the list of hardcoded domains found in various families within the Lazarus\nGroup’s collection for use in the server _ name extension. Note that not all family members contain all domain names.\n```\n          accounts.google.com secureir.ebaystatic.com\n          apps.skypeassets.com securemetrics.apple.com\n          b.stats.ebay.com signin.ebay.com\n          daw.apple.com skydrive.live.com\n          extended-validation-ssl.verisign.com ssl.google-analytics.com\n\n```\n**fls-na.amazon.com** `ssl.gstatic.com`\n```\n          images-na.ssl-images-amazon.com sstats.adobe.com\n          login.live.com startpage.com\n          login.skype.com support.msn.com\n          login.yahoo.com support.oracle.com\n\n```\n`s.imp.microsoft.com` **supportprofile.apple.com**\n```\n          s1-s.licdn.com urs.microsoft.com\n          sc.imp.live.com verify.adobe.com\n          secure.logmein.com www.adobetag.com\n          secure.shared.live.com www.apple.com\n          secure.skype.com www.amazon.com\n          secure.skypeassets.com www.google.com\n\n```\n**Table 6-2: Observed server _ name Field Values**\n\nThe status _ request extension will, if present, always have the Certificate Status Type field set to OCSP (1). Table\n6-3 lists the possible sets that the fake TLS scheme may apply to the elliptic _ curves field.\n\n**ELLIPTICAL CURVE SET 1 (3 CURVES)** **ELLIPTICAL CURVE SET 2 (4 CURVES)**\n```\n         SECT193R1 SECT233K1\n         SECP256R1 SECP256R1\n         SECP384R1 SECP384R1\n                                     SECP512R1\n\n```\n**Table 6-3: The Fake TLS Scheme’s Possible elliptic _ curves Sets**\n\n\n-----\n\nIf the elliptic _ curves extension is present, it is always followed by the ec _ point _ formats extension which\ndefines a single format of uncompressed (0). The probability of either elliptical curve set being used is defined by the same\nrandom selection algorithm used when determining if the session _ id field will occur within the ClientHello.\n\nAfter the client side of the communication sends the ClientHello packet, the client expects the next data received from the\nserver to be a ServerHello packet. If the data that arrives from the server is not a ServerHello, the connection terminates.\nThe ServerHello response may or may not have a session _ id field, but the contents of this field are irrelevant to the\nclient. The client will process the ServerHello packet only far enough to extract the selected cipher suite and then reads and\ndisregards any incoming packets until the server sends the ServerHelloDone packet (up to 8 server packets).\n\nAfter receiving the ServerHelloDone packet, the connection between the client and the server is complete. Further\ncommunication is encapsulated in what appears to be a legitimate TLS frame. The header for every datagram transmitted\nbetween the client and server (and vice versa) consists of a 5-byte header that specifies the type of datagram (typically set to 22),\nthe TLS version (set to 0x0301), and the number of bytes within the datagram. Following the TLS frame header, the payload\nbytes are transmitted. The payload contains the data encrypted using the Caracachs encryption scheme (see Section 6.1.1).\n\n**4.3.3.2 C2 Connections**\n\nSeveral of the malware families under the Lazarus Group umbrella use a common function for connecting to a C2 server.\nWhile most malware that uses the Winsock API will use socket and connect to open a socket between two end points,\nwhat makes the C2 server connection function identifiable is the method by which the authors generate and test the\nconnection (Figure 6-11).\n```\n          int ConnectToHost(int dwIP, u _ short wPort, signed int dwTimeout)\n          {\n           _ _ int32 actualTimeout; // edi@3\n           SOCKET s; // esi@6\n           u _ long argp; // [sp+44h] [bp-120h]@1\n           struct timeval timeout; // [sp+48h] [bp-11Ch]@8\n           sockaddr _ in endpt; // [sp+50h] [bp-114h]@6\n           fd _ set writefds; // [sp+60h] [bp-104h]@8\n           argp = 1;\n           if ( wPort && dwIP )\n           {\n            actualTimeout = dwTimeout;\n            if ( dwTimeout <= 0 || dwTimeout > 60 )\n             actualTimeout = 10;\n            endpt.sin _ family = 2;\n            endpt.sin _ addr.S _ un.S _ addr = dwIP;\n            endpt.sin _ port = htons(wPort);\n            s = socket(2, 1, 0);\n            if ( s != -1 && ioctlsocket(s, 0x8004667E, &argp) != -1 )// disable blocking\n            {\n             connect(s, (const struct sockaddr *)&endpt, 16);\n             writefds.fd _ array[0] = s;\n             writefds.fd _ count = 1;\n             timeout.tv _ sec = actualTimeout;\n             timeout.tv _ usec = 0;\n             if ( select(s + 1, 0, &writefds, 0, &timeout) > 0 && _ WSAFDIsSet(s, &writefds) )\n             {\n              argp = 0;\n              ioctlsocket(s, 0x8004667E, &argp);   // enable blocking\n              return s;\n             }\n             closesocket(s);\n            }\n           }\n           return -1;\n          }\n\n```\n**Figure 6-11: Common C2 Server Connection Function found in Lazarus Group Families**\n\n\n-----\n\nThe authors perform the standard procedure of generating a virtual circuit between two end points by calling the socket\nAPI function to generate a socket object. Next the authors disable socket read blocking by calling ioctlsocket with the\nvalue 0x8004667E. The code then proceeds to call connect to establish a virtual circuit between the Trojan and the C2\nserver. In order to test the validity of the channel, the code will call select followed by _ WSAFDIsSet to determine if\nthe Trojan can send data through the socket. If the socket is viable, read blocking is re-enabled via an ioctlsocket call,\nand the socket is returned to the caller of the function.\n\n**4.3.3.3 Socket Disconnect**\n\nMany of the RATs employed by the Lazarus Group have a unique method for closing active network socket connections.\nA typical solution to terminate a connection between two end points is to simply call the closesocket API function,\nwhich abruptly closes a socket channel. The authors responsible for the Lazarus Group’s malware take a slightly more\naggressive approach, however. The general form for disconnecting a socket employed by the Lazarus Group’s malware\nconsists of sending a WORD (2 byte) or DWORD (4 byte) value, usually equal to 0x0001 or 0x00000001, to the other\nreceiving end of the socket followed by calling the shutdown API function which instructs the WinSock API to close\nboth directions of communication. The final step in terminating a socket connection is the call to closesocket. There\nare slight variations on this method exist where setsockopt is called to allow for lingering sockets or where a different\nDWORD value is transmitted to the receiving end, but the basic pattern of send/shutdown/closesocket remains\nconsistent. Below are several example variations.\n```\n          int _ _ cdecl SendErrorAndCloseSocket(int skt)\n          {\n           if ( skt == -1 )\n           {\n            return -1;\n           }\n           int v5 = 1;\n           int val = 0x10001;\n           setsockopt(skt, SOL _ SOCKET, SO _ LINGER, (const char *)&val, 4);\n           send(s, (const char *)&v5, 2, 0);\n           shutdown(skt, 2);\n           closesocket(skt);\n           return 0;\n          }\n          int _ _ thiscall FlushAndShutdownSocket(void *pfSuccess, SOCKET s)\n          {\n           DWORD buf = 0;\n           char optval[4];\n           strcpy(optval, “\\x01”);\n           setsockopt(s, 0xFFFF, SO _ LINGER, optval, 4);\n           send(s, buf, 4, 0);\n           shutdown(s, 2);\n           result = closesocket(s);\n           *pfSuccess = 0;\n           return result;\n          }\n          int _ _ cdecl ShutdownConnection(SOCKET s)\n          {\n           _ _ int16 v2 = 1;\n           int v4 = 0x26380B;\n           setsockopt(a1, 0xFFFF, 128, (const char *)&v2, 4);\n           send(s, (const char *)&v4, 4, 0);\n           shutdown(s, 2);\n           return closesocket(s);\n          }\n\n```\n**Figure 6-12: Common Forms of the Lazarus Group’s Connection Disconnect Functions**\n\n\n-----\n\n**4.3.3.4 Common Network Data Transmission and Receiving Function**\n\nThe Lazarus Group uses a common structure for transmitting and receiving data over the network. For network\ncommunication that uses encryption, the developer(s) of the Lazarus Group’s malware abstracts the data shuttling\nfunctionality that takes the burden of managing the encryption component of the communication channel off of the\ncore code. The use of such a design pattern, a pattern that has been observed used more and more as the code within the\nLazarus Group’s code has matured, indicates a level of attention to modularity in design.\n\nThe design pattern used for the transmission of data to a remote end point takes the form seen in Figure 6-13. The\nprototype for the transmission function is consistent across a larger number of the malware families, with the first\nparameter being the socket, the second and third parameters defining the location and size of the data to transmit, and\nthe final argument being a flag to encrypt the transmission (if non-zero).\n```\n          int SendData(SOCKET skt, void *pvData, int dwSize, int fEncrypt)\n          {\n           int dwXmitted;\n           int dwBytesSent = 0;\n           unsigned char* p = pvData;\n           if ( fEncrypt )\n           {\n            /*\n\n```\n**Family specific encoding scheme**\n```\n            */  \n           }\n           if ( dwSize <= 0 )\n            return 1;\n           while ( 1 )\n           {\n            dwXmitted = send(skt, &pvData[dwBytesSent], dwSize – dwBytesSent, 0);\n            if ( dwXmitted <= 0 )\n             break;\n            dwBytesSent += dwXmitted;\n            if ( dwBytesSent >= dwSize )\n             return 1;\n           }\n           return 0;\n          }\n\n```\n**Figure 6-13: Common Form for Network Data Transmission with Encryption**\n\nThe exact encryption scheme used varies from family to family. Regardless, the overall pattern remains the same with\nvery few exceptions across the entirety of the Lazarus Group’s collection.\n\nThere are two main reciprocal functions for receiving data from the network as Figure 6-14 and Figure 6-15 illustrate.\nThe design pattern for the receiving of potentially encrypted data consists of reading the data from the network until the\nspecified number of bytes has been received (or a timeout occurs, in the case of RecvDataEx variants) and if the decrypt\nflag is set to non-zero, apply the family-specific decryption scheme to the buffer.\n\n\n-----\n\n```\n          int RecvData(SOCKET skt, void *pvData, int dwLength, int fDecrypt)\n          {\n           int dwBytesRead = 0;\n           if (skt == -1 )\n            return 0;\n           int dwBytesRemaining = dwLength;\n           if ( dwLength > 0 )\n           {\n            do\n            {\n             int dwBytesRecv = recv(skt, &pvData[dwBytesRead], dwLength – dwBytesRead, 0);\n             if ( dwBytesRecv <= 0 )\n              return 0;\n             dwBytesRead += dwBytesRecv;\n            }\n            while ( dwBytesRead < dwLength );\n           }\n           if ( fDecrypt && dwLength > 0 )\n           {\n            /*\n\n```\n**Family specific decoding scheme**\n```\n            */  \n           }\n           return 1;\n          }\n\n```\n**Figure 6-14: Common Form for Receiving Network Data with Encryption**\n\n\n-----\n\n```\n          int RecvDataEx (SOCKET skt, void *pvData, int dwSize, int fDecode, int timeout)\n          {\n           int dwBytesRemaining; // edi@1\n           _ BYTE *p; // ecx@1\n           int dwBytesRead; // esi@1\n           int dwBytesRecv; // eax@3\n           int v8; // eax@8\n           signed int result; // eax@12\n           int dwBytesRemaining = dwSize;\n           int dwBytesRead = 0;\n           if ( dwSize > 0 )\n           {\n            while ( WaitForRead(skt, timeout) )\n            {\n             int dwBytesRecv = recv(skt, &pvData[dwBytesRead], dwSize – dwBytesRead, 0);\n             if ( dwBytesRecv <= 0 )\n              break;\n             dwBytesRead += dwBytesRecv;\n             if ( dwBytesRead >= dwSize )\n             {\n              if ( fDecode && dwSize > 0 )\n              {\n               /*\n\n```\n**Family specific decoding scheme**\n```\n               */  \n              }\n              return 1;\n             }\n            }\n           }\n           return 0;\n          }\n\n```\n**Figure 6-15: Common Form for Receiving Network Data with Encryption and Receive Timeout**\n\nThe abstraction of the network data shuttling has the added benefit of allowing a malware family to use the same\nfunction call regardless of the underlying data format, encrypted or cleartext. The use of this behavior is found in several\nLazarus Group families when the initial handshake to establish an encrypted channel requires sending cleartext followed\nby a switch to an encrypted mode after the handshake has been established. When such a use case occurs, the same\nsend and receive abstract functions can be used, but their encrypted/decrypted mode flags will be the only change the\nprogrammers of the core code must concern themselves with.\n\n\n-----\n\n|:L1 del “<source binary filename>” if exist “<source binary filename>” goto L1 del “<suicide script filename>”|@echo off :R1 del /a “<source binary filename>” if exist “<source binary filename>” goto R1 del /a “<suicide filename>”|\n|---|---|\n|:R IF NOT EXIST <source binary filename> GOTO E del /a <source binary filename> GOTO R :E del /a d.bat|:Hello del /a <source binary filename> if exist <source binary filename> goto Hello del /a <suicide filename>|\n|@echo off :D1 del /a <source binary filename> if exist %1 goto D1 del /a <suicide filename>|@echo off :Loop del /a H “<source binary filename>” if exists “” goto Loop del “<suicide filename>”|\n|:Repeat1 del “<source binary filename>” if exist “<source binary filename>” goto Repeat1 del “<suicide script filename>”||\n\n\n**4.3.3.5 Suicide Scripts**\n\nA suicide script is a method by which a running executable can ensure, upon termination, that its presence is removed\nfrom a host system. As running executable are locked by Windows, it is necessary for malware binaries to deploy suicide\nscripts in order to remove themselves from a victim’s machine. The typical suicide script consists of a Windows batch file\nthat enters an infinite loop attempting to delete the source executable over and over until it is finally successful (after the\nrunning program terminates).\n\nWhile many unrelated malware families use suicide scripts, there are times when a suicide script can give away a common\nauthor or library. This is the case with the Lazarus Group’s suicide scripts. Novetta has observed five distinct suicide\nscripts that span across multiple malware families attributed to the Lazarus Group. These observed suicide scripts largely\nfollow the same pattern: a short label (a single letter with an option single number), a file deletion attempt, a file check, a\nconditional loop, and finally a file delete to remove the suicide script.\n```\n         :L1 @echo off\n\n```\n**del “<source binary filename>”** `:R1`\n**if exist “<source binary filename>” goto L1** **del /a “<source binary filename>”**\n**del “<suicide script filename>”** **if exist “<source binary filename>” goto R1**\n\n**del /a “<suicide filename>”**\n```\n         :R :Hello\n\n```\n**IF NOT EXIST <source binary filename> GOTO E** **del /a <source binary filename>**\n**del /a <source binary filename>** **if exist <source binary filename> goto Hello**\n`GOTO R` **del /a <suicide filename>**\n```\n         :E\n         del /a d.bat\n         @echo off @echo off\n         :D1 :Loop\n\n```\n**del /a <source binary filename>** **del /a H “<source binary filename>”**\n```\n         if exist %1 goto D1 if exists “” goto Loop\n\n```\n**del /a <suicide filename>** **del “<suicide filename>”**\n```\n         :Repeat1\n\n```\n**del “<source binary filename>”**\n**if exist “<source binary filename>” goto**\n```\n         Repeat1\n\n```\n**del “<suicide script filename>”**\n\n**Figure 6-16: Suicide Script Forms Found within Lazarus Group Families**\n\nA common design pattern for generating many of the suicide scripts is to construct each line one at a time. When\ndecompiled in Hex-rays, a typical suicide script construction function takes the following form:\n\n\n-----\n\n```\n          strcat(szSuicideScriptFilename, “PM0D4.bat”);\n          fp = fopen(szSuicideScriptFilename, “wb”);\n          fprintf(fp, “:Repeat1\\r\\n”);\n          fprintf(fp, “del \\”%s\\”\\r\\n”, szSourceFileName);\n          fprintf(fp, “if exist \\”%s\\” goto Repeat1\\r\\n”, pszSourceFileName);\n          fprintf(fp, “del \\”%s\\”\\r\\n”, szSuicideScriptFilename);\n          fclose(fp);\n\n```\nor\n```\n          strcpy(szScript, “@echo off\\r\\n”);\n          strcpy(szScript, “:Loop\\r\\ndel /a H \\””);\n          strcat(szScript, szSourceFileName);\n          strcat(szScript, “\\”\\r\\nif exist \\””);\n          strcat(szScript, szSourceFileName);\n          strcat(szScript, “\\” goto Loop\\r\\ndel \\””);\n          strcat(szScript, szSuicideScriptFilename);\n          strcat(szScript, “\\””);\n          WriteFile(fp, szScript, strlen(szScript), &NumberOfBytesWritten, 0);\n          CloseHandle(fp);\n\n```\nThe other design pattern for generating suicide scripts is a more streamlined approach in which the entire content of the\nsuicide script is constructed and then written to file as follows:\n```\n           fp = fopen(&Buffer, “wt”);\n           if ( fp )\n           {\n            fprintf(fp, “:L1\\r\\ndel \\”%s\\”\\r\\nif exist \\”%s\\” goto L1\\r\\ndel \\”%s\\”\\r\\n”,\n          szSourceFileName, szSourceFileName, szSuicideScriptFilename);\n            fclose(fp);\n\n```\n\n-----\n\n###### 4.3.4 Directory Hierarchy Verification and Generation\n\nFrom time to time it is necessary to verify the existence of a particular file path and, if the path fails to exist, create the\nfile path. The Lazarus Group uses a specific function for this task in several of its family members. What makes the code\ndistinguishable is the fact that the function will take a file’s full path (e.g. C:\\temp\\folder1\\folder2\\malware.exe)\nand traverse the entire path. At each level of the directory hierarchy, the code will ensure that the directory exists. At the\nsame time, the code allows the caller of the function to specify if the highest level of the hierarchy is a directory name or a\nfilename. The ability to allow the caller to specify this means the function was originally designed to accommodate both\nfile paths and directory paths.\n\nThe function that the Lazarus Group uses for ensure a directory hierarchy is as follows:\n```\n        void GenerateDirectoryPath(char *pszPath, int fLastEntryIsDir)\n          {\n           char *p;\n           const char *pn;\n           char *v4;\n           char *v5;\n           char szDirPath[260];\n           if ( pszPath)\n           {\n            p = strchr(pszPath, ‘\\\\’);\n            pn = p + 1;\n            if ( p != (char *)-1 && strchr(pn, ‘\\\\’) )\n            {\n             do\n             {\n              memset(szDirPath, 0, 260);\n              v4 = strchr(pn, ‘\\\\’);\n              strncpy(szDirPath, pszPath, v4 – szDirPath);\n              v5 = strchr(pn, ‘\\\\’);\n              pn = v5 + 1;\n              if ( v5 == (char *)-1 )\n               break;\n              if ( GetFileAttributesA(szDirPath) == -1 )\n               CreateDirectoryA(szDirPath, 0);\n             }\n             while ( strchr(pn, ‘\\\\’) );\n            }\n            if ( fLastEntryIsDir )\n             CreateDirectoryA(pszPath, 0);\n           }\n          }\n\n```\nThe traversal function begins at the first directory separator (the backslash) and verifies that the path up to that particular\npoint exists by calling GetFileAttributesA to determine if the path if valid or not. If the path to that point is not valid,\n```\n       CreateDirectoryA is called to generate the folder. The process is repeated for each of the additional directories in the\n\n```\npath until the final directory separator character is found. If the fLastEntryIsDir flag is set to non-zero by the caller,\nthen the full path is supplied to CreateDirectoryA to attempt to create the final directory. This call will fail, however, if\nthe directory already exists or a file with the same name exists, but the result of this behavior is ignored by the function.\n\n\n-----\n\n###### 4.3.5 Secure File Delete\n\nThe Lazarus Group goes to great lengths to destroy content, not only in their destructive malware but also in their RATs\nand installers as well. Securely deleting a file (or files) from a victim’s machine has practical applications when viewed from\nthe perspective of forensic recovery. When a file is deleted using standard operating system deletion functions, the file’s\ncontents remain on the hard drive but the file’s space is marked as available. For a recently deleted file, a forensic analysis\nhas a high probability of recovering the original file. A secure deletion function, however, not only deletes the file by\nmarking the space available, but it also overwrites the data on the disk in order to destroy the content.\n\nMany of the families within the Lazarus Group’s collection use a similar methodology for the destruction of files on a\nvictim’s computer. While there are variations on a theme when it comes to destroying files, the most common method\nthat the Lazarus Group employs to ensure a file is securely deleted is as follows:\n\n1. Generate a buffer of random data\n2. Overwrite the targeted file with the random data until the entirety of the file has been replaced\n3. Rename the file with random letters (replacing each letter in the filename, without adding additional letters)\n4. Delete the file\n\nSome variations observed in Lazarus Group families include replacing the file name with TMP{number}.tmp and\nchanging the size of the file (via _ chsize or SetEndOfFile) to 0.\n\n###### 4.3.6 Target File Identification\n\nSeveral of the destructive malware samples identified\nduring Operation Blockbuster use a common function\n```\n            BOOL IsTargetFileExtension(wchar _ t *Str1)\n\n```\n`{` to identify target files by their extension. The\n`return Str1` function is straightforward in its operation: it takes a\n`&& (!wcsnicmp(Str1, L”.doc”, 4u)` single wide character string (wchar _ t*) and\n```\n               || !wcsnicmp(Str1, L”.docx”, 5u)\n```\n`|| !wcsnicmp(Str1, L”.docm”, 4u)` performs a series of string compares to determine if\n`|| !wcsnicmp(Str1, L”.wpd”, 4u)` the supplied string matches any of the targeted file\n`|| !wcsnicmp(Str1, L”.wpx”, 4u)` extensions. While this may not seem like a\n```\n               || !wcsnicmp(Str1, L”.wri”, 4u)\n```\n`|| !wcsnicmp(Str1, L”.xls”, 4u)` particularly strong artifact to tie together multiple\n`|| !wcsnicmp(Str1, L”.xlsx”, 5u)` malware families, the function has two distinct\n`|| !wcsnicmp(Str1, L”.mdb”, 4u)` characteristics that make it a suitable artifact for\n```\n               || !wcsnicmp(Str1, L”.ppt”, 4u)\n\n```\ncross-family correlation, both shown in the source\n```\n               || !wcsnicmp(Str1, L”.pptx”, 5u)\n\n```\n`|| !wcsnicmp(Str1, L”.pdf”, 4u)` code in Figure 6-17. First, the order of the extensions\n`|| !wcsnicmp(Str1, L”.hwp”, 4u)` is constant. Second, the function has a typo where the\n```\n               || !wcsnicmp(Str1, L”.hwp”, 4u)\n```\n`|| !wcsnicmp(Str1, L”.hna”, 4u)` file extension .hwp is checked for twice in a row.\n```\n               || !wcsnicmp(Str1, L”.gul”, 4u)\n\n```\n**Figure 6-17: Common Target File Extension Identification**\n```\n               || !wcsnicmp(Str1, L”.kwp”, 4u)\n\n```\n`|| !wcsnicmp(Str1, L”.eml”, 4u)` **Function with Duplicate Entries for .hwp**\n```\n               || !wcsnicmp(Str1, L”.pst”, 4u)\n               || !wcsnicmp(Str1, L”.alz”, 4u)\n               || !wcsnicmp(Str1, L”.gho”, 4u)\n               || !wcsnicmp(Str1, L”.rar”, 4u)\n               || !wcsnicmp(Str1, L”.php”, 4u)\n               || !wcsnicmp(Str1, L”.asp”, 4u)\n               || !wcsnicmp(Str1, L”.aspx”, 5u)\n               || !wcsnicmp(Str1, L”.jsp”, 4u)\n               || !wcsnicmp(Str1, L”.java”, 4u)\n               || !wcsnicmp(Str1, L”.cpp”, 5u)\n               || !wcsnicmp(Str1, L”.h”, 5u)\n               || !wcsnicmp(Str1, L”.c”, 5u)\n               || !wcsnicmp(Str1, L”.zip”, 4u));\n            }\n\n```\n\n-----\n\n## 5. Conclusion\n\n###### sing the hashes of the malware used in the November 2014 SPE attack, Novetta was able\n\n#### U\n\n###### to identify more than 45 malware families due to shared code, encryption keys, and other features across a diverse set of tools. This set of malware has been attributed to a threat actor we have dubbed the Lazarus Group. The Lazarus Group’s malware\n CH AP T ER variants have been under active development since\n at least 2009 and can be tied to publicly related attacks as early as 2007.\n\n Despite the fact that many of the malware variants are not as sophisticated as many tools attributed\n\n# Five\n\n###### to other APT groups, the corpus of malware used by the Lazarus Group is extremely effective and, in multiple cases, responsible for targeted cyber espionage, data theft, and destructive attacks. Notably, as the attack against SPE and other targets have shown, efficient, long-term, and destructive cyber attacks can be orchestrated and executed by this group.\n\n\n-----\n\n##### 5. Conclusion (continued)\n\nIn Operation Blockbuster, Novetta and industry partners have begun working together to understand and devise ways to\ndegrade the Lazarus Group’s malware toolset, eroding the group’s ability to use these tools for further harm.\n\nWhile no effort can completely halt malicious operations, Novetta believes that these efforts can help cause significant\ndisruption and raise operating costs for adversaries, in addition to profiling groups that have relied on secrecy for much of\ntheir success.\n\nIt is our hope that private industry will not only continue to illuminate various threat actors’ toolsets and operations, but\nalso work with other industry partners and law enforcement agencies as able to affect positive change on the safety of\nnetwork environments worldwide.\n\n###### 5.1 Remediation Suggestions\n\nGiven the nature of the Lazarus Groups tool set and its well-resourced operations, this section of the report is not\nintended to provide in-depth remediation suggestions for every possible scenario and environment. Rather, we highlight\ngeneral methods that can be of use to organizations who are concerned about mitigating these types of general threats.\nFor organizations who feel like their own internal cyber security capabilities are immature or non-existent, Mitre has\nreleased a high quality book on this topic[60] for public consumption.\n\nWith the help of operation partners, Novetta has pushed AV, IDS and YARA signatures to identify associated Lazarus\nGroup tools and traffic. In addition to checking against these signatures, an up-to-date antivirus tool reporting to a central,\nmonitored location is highly recommended. Other freely available tools, such as Microsoft’s EMET,[] are also valuable\ndefensive measures in conjunction with following suggestions for securing endpoints, servers, and network infrastructure.\n\nOn top of the provided signature-based detections, scrutinizing network traffic, and storing raw network traffic (i.e., pcap)\nfor as long as is economically feasible can function as a tremendous aid in the investigation of alerts or identification of\nanomalous or malicious traffic. When considering the SPE attack, there is clear evidence to suggest that the attackers had\naccess to corporate networks and were exfiltrating data long before the destructive malware was downloaded and executed.\n\nNetwork segregation, i.e., preventing workstations from talking to each other, could also help mitigate attacks; malware\nused by the Lazarus Group takes advantage of such configurations between machines for lateral movement to spread within\nthe network, deploying malware that spreads via P2P or via SMB[] bruteforcing using built-in Windows shares. Similarly,\nremote access to machines should be restricted and only allowed on a case-by-case basis where needed. Administrator-level\npermissions should also be restricted, as attackers with an initial foothold into a system can use or elevate to administrator\nprivileges to gain access to entire networks. Wherever possible, two-factor authentication is strongly recommended as well as\nproper ageing of account passwords and strong password complexity requirements and associated testing.\n\nLike many other attackers, the Lazarus Group appears to rely on social engineering as an initial attack vector. Educating\nemployees as to the dangers of spear phishing both in email as well as a its use in a social media context is crucially\nimportant, as an attacker can easily gain access to sensitive information that can be used to social engineer remote access\n\n60 “Ten Strategies of a World-Class Cybersecurity Operations Center.” MITRE. 2014. https://www.mitre.org/sites/default/files/publications/pr-13-1028-mitre-10-strategies-cyber-ops-center.pdf\n\n\n-----\n\nor in the worst case gain direct remote access to a target network. One way to attempt to minimize these types of attacks\nis to ensure that end users are applying software updates and patches to their home machines prior to connecting via\nVPN, as well as mount internal awareness campaigns that promote patching as well as suspicion of links and files sent via\nsocial media.\n\nIn addition to the above steps, regular backups of servers are recommended including continual testing and verification of\nyour backup process and DRP plans can aid in recovery from failures or DDoS attacks. Furthermore, as the Lazarus Group\ndoes not solely concentrate on destructive attacks, but also cyber espionage and data theft, encryption of sensitive data,\nincluding emails, is highly recommended.\n\nIt is worth noting that automated solutions, tools, and other procedures outlined above and elsewhere are no substitute\nfor having a well-funded and dedicated security team. As breaches have become the new normal, with increasing fallout, a\nthorough security policy and empowered team is necessary.\n\nFor more information, including guidelines for restoration of targeted systems, see the National Security Agency report\n“Defensive Best Practices for Destructive Malware”[61] and US-CERT’s “Handling Destructive Malware.”[62]\n\n###### 5.2 Additional Resources and Reporting\n\nNovetta has released additional technical reports detailing the capabilities of identified Lazarus Group malware, detailing\nthe RATs and attack staging and content distribution tools, the data exfiltration tools,the destructive malware “wipers”\nand DDoS bots, other identified network tools, and the installers, uninstallers, loaders.\n\n###### YARA Rules\n\n<link to microsite of yara rules>\n\n###### Hashes\n\n<link to microsite listing of hashes>\n\n61 “Defensive Best Practices for Destructive Malware.” National Security Agency/Central Security Service. January 16, 2015. https://www.nsa.gov/ia/_files/factsheets/Defending_Against_Destructive_Malware.pdf\n\n62 “Handling Destructive Malware.” US-CERT. November 4, 2013. https://www.us-cert.gov/ncas/tips/ST13-003\n\n\n-----\n\n## 6. Appendix\n\n###### he following table expands on the evidence shown earlier in the report, including further\n\n#### T\n\n###### notes on the malware variants. The appendix table depicts the Lazarus Group code relationships and detections to further demonstrate the connection between variants observed in the SPE attacks, and\n\n# APX\n\n###### other earlier publicly reported attacks. For more information on the code relationships, contact\n trig@novetta.com.\n\n\n-----\n\n|MALWARE VARIANT|LAZARUS CODE RELATIONSHIPS|OTHER NOTES|OTHER AV DETECTIONS NAMES|\n|---|---|---|---|\n|DeltaAlfa|N/A|Used in Ten Days of Rain attacks, identified as part of Operation Troy, dropped by IndiaGolf|DDoS-KSig, Fibedol, Kored|\n|DeltaBravo|Suicide Script|Dropped by IndiaFoxtrot||\n|DeltaCharlie|RSA Transform, Space-Dot Encoding, Dynamic API Loading|||\n|HotelAlfa|N/A|GOP server in the SPE attack|Destover, DestoverServ, Nukesped, NukespedSer|\n|IndiaAlfa|Suicide Script|Installs RomeoAlfa|Escad, Destov “Messagethre Destover “BasicHwp,” Mdrop|\n|IndiaBravo|Dynamic API Loading, Basic XOR with Constant 0xA7, Space-Dot Encoding|Installs RomeoBravo, RomeoCharlie, and PapaAlfa|Escad, Destov “Messagethre|\n|IndiaCharlie|Directory Hierarchy Verification and Generation, Suicide Script|Installs RomeoFoxtrot||\n|IndiaDelta|Dynamic API Loading|Installs LimaAlfa and WhiskeyCharlie||\n|IndiaEcho|Suicide Script|Installs LimaBravo, RomeoGolf, and IndiaBravo-RomeoBravo|Escad|\n|IndiaFoxtrot|Dynamic API Loading, Space-Dot Encoding, DNSCALC-style Encoding|Installs RomeoWhiskey|Escad, Winse Destover, Gamarue|\n|IndiaGolf|Directory Hierarchy Verification and Generation, Suicide Script|Installs RomeoMike and DeltaAlfa, Loads RomeoGolf, identified in Operation Troy|Koredos, DDo KSig, QDDOS Fibebol|\n|IndiaHotel|N/A|Installs WhiskeyBravo and RomeoLima, identified in Operation Troy|Wiper.C|\n|IndiaJuliett|N/A|Installs SierraJuliett-MikeOne and SierraBravo, IndiaJuliett signatures matched several Operation Troy hashes|Escad, Joanap|\n\n\n##### 6. Appendix (continued)\n\n**OTHER AV**\n\n**MALWARE** **LAZARUS CODE** **OTHER**\n\n**DETECTIONS/**\n\n**VARIANT** **RELATIONSHIPS** **NOTES**\n\n**NAMES**\n\nUsed in Ten Days of Rain attacks,\n\nDDoS-KSig,\n\nDeltaAlfa N/A identified as part of Operation Troy,\n\nFibedol, Koredos\n\ndropped by IndiaGolf\n\nDeltaBravo Suicide Script Dropped by IndiaFoxtrot\n\nRSA Transform, Space-Dot\n\nDeltaCharlie Encoding, Dynamic API\n\nLoading\n\nDestover,\nDestoverServ,\n\nHotelAlfa N/A GOP server in the SPE attack\n\nNukesped,\nNukespedServ\n\nEscad, Destover\n“Messagethread,”\n\nIndiaAlfa Suicide Script Installs RomeoAlfa Destover\n\n“BasicHwp,”\nMdrop\n\nDynamic API Loading, Basic\n\nInstalls RomeoBravo, RomeoCharlie, Escad, Destover\n\nIndiaBravo XOR with Constant 0xA7,\n\nand PapaAlfa “Messagethread”\n\nSpace-Dot Encoding\n\nDirectory Hierarchy Verification\nIndiaCharlie Installs RomeoFoxtrot\nand Generation, Suicide Script\n\nIndiaDelta Dynamic API Loading Installs LimaAlfa and WhiskeyCharlie\n\nInstalls LimaBravo, RomeoGolf, and\nIndiaEcho Suicide Script Escad\nIndiaBravo-RomeoBravo\n\nDynamic API Loading, Escad, Winsec,\n\nIndiaFoxtrot Space-Dot Encoding, Installs RomeoWhiskey Destover,\n\nDNSCALC-style Encoding Gamarue\n\nInstalls RomeoMike and DeltaAlfa, Koredos, DDoS-\n\nDirectory Hierarchy Verification\nIndiaGolf Loads RomeoGolf, identified in KSig, QDDOS,\nand Generation, Suicide Script\n\nOperation Troy Fibebol\n\nInstalls WhiskeyBravo and\n\nIndiaHotel N/A RomeoLima, identified in Operation Wiper.C\n\nTroy\n\nInstalls SierraJuliett-MikeOne and\nSierraBravo, IndiaJuliett signatures\n\nIndiaJuliett N/A Escad, Joanap.d\n\nmatched several Operation Troy\nhashes\n\n\n-----\n\n|MALWARE VARIANT|LAZARUS CODE RELATIONSHIPS|OTHER NOTES|OTHER AV DETECTIONS/ NAMES|\n|---|---|---|---|\n|IndiaKilo|N/A|Dropped by SierraJuliett-MikeOne during campaign||\n|IndiaWhiskey|Dynamic API Loading, Space-Dot Encoding, Suicide Script|Installs RomeoWhiskey|Escad, KorDllbot backdoor service installer|\n|UniformAlfa|Suicide Script|Uninstalls RomeoBravo||\n|UniformJuliett|Directory Hierarchy Verification and Generation, Suicide Script|Uninstalls SierraJuliett-MikeOne||\n|KiloAlfa|Suicide Script, DNSCALC-style encoding|It is believed that RomeoDelta is responsible for collecting the keystroke log files generated by KiloAlfa, KiloAlfa’s suicide script contains similar strings as that of Dozer, the malware used in a July 2009 DDoS attack||\n|LimaAlfa|Secure File Delete, Suicide Script|Loads WhiskeyCharlie||\n|LimaBravo|N/A|Loads RomeoGolf|BZub|\n|LimaCharlie|Space-Dot Encoding, Dynamic API Loading|Loads RomeoHotel|Escad|\n|LimaDelta|Suicide Script|Loads IndiaGolf, identified in Operation Troy|Koredos, DDoS- Ksig, QDDOS, Fibebol, Npkon|\n|PapaAlfa|Space-Dot Encoding, Dynamic API Loading, Opening Windows Firewall Method|Acts as a proxy for traffic specific to the Romeo-CoreOne based RATs|Escad|\n|RomeoAlfa|FakeTLS, Caracachs|Shares a common core, Romeo- CoreOne|Escad, Destover, NukeSped|\n|RomeoBravo|DNSCALC-style Encoding|Shares a common core, Romeo- CoreOne|Escad|\n|RomeoCharlie|DNSCALC-style Encoding, Opening Windows Firewall Method|Shares a common core, Romeo- CoreOne|Escad|\n|RomeoDelta|Dynamic API Loading, Space-Dot Encoding, DNSCALC-style Encoding|Uses the same CRSA code (specifically the custom RSATransform function) found in SierraJuliet-MikeOne and RomeoWhiskey|Escad, Destover “Windows updatetracing,” NukeSped|\n|RomeoEcho|DNSCALC-style Encoding, Datagram Format||Escad, Darpapox|\n|RomeoFoxtrot|Common Send/Recv. Functions|Dropped by IndiaCharlie||\n|RomeoGolf|Fake TLS|Loaded by LimaBravo, Dropped by IndiaEcho||\n|RomeoHotel|FakeTLS, Caracachs|Shares a common core, Romeo- CoreOne|Escad|\n\n\n**OTHER AV**\n\n**MALWARE** **LAZARUS CODE** **OTHER**\n\n**DETECTIONS/**\n\n**VARIANT** **RELATIONSHIPS** **NOTES**\n\n**NAMES**\n\nDropped by SierraJuliett-MikeOne\nIndiaKilo N/A\nduring campaign\n\nDynamic API Loading, Escad, KorDllbot\n\nIndiaWhiskey Space-Dot Encoding, Suicide Installs RomeoWhiskey backdoor service\n\nScript installer\n\nUniformAlfa Suicide Script Uninstalls RomeoBravo\n\nDirectory Hierarchy Verification\nUniformJuliett Uninstalls SierraJuliett-MikeOne\nand Generation, Suicide Script\n\nIt is believed that RomeoDelta\nis responsible for collecting the\nkeystroke log files generated by\n\nSuicide Script, DNSCALC-style\nKiloAlfa KiloAlfa, KiloAlfa’s suicide script\nencoding\n\ncontains similar strings as that of\nDozer, the malware used in a July\n2009 DDoS attack\n\nSecure File Delete, Suicide\nLimaAlfa Loads WhiskeyCharlie\nScript\n\nLimaBravo N/A Loads RomeoGolf BZub\n\nSpace-Dot Encoding, Dynamic\nLimaCharlie Loads RomeoHotel Escad\nAPI Loading\n\nKoredos, DDoS-\n\nLoads IndiaGolf, identified in\nLimaDelta Suicide Script Ksig, QDDOS,\nOperation Troy\n\nFibebol, Npkon\n\nSpace-Dot Encoding, Dynamic\n\nActs as a proxy for traffic specific to\n\nPapaAlfa API Loading, Opening Windows Escad\n\nthe Romeo-CoreOne based RATs\n\nFirewall Method\n\nShares a common core, Romeo- Escad, Destover,\nRomeoAlfa FakeTLS, Caracachs\nCoreOne NukeSped\n\nShares a common core, Romeo-\nRomeoBravo DNSCALC-style Encoding Escad\nCoreOne\n\nDNSCALC-style Encoding,\n\nShares a common core, Romeo-\n\nRomeoCharlie Opening Windows Firewall Escad\n\nCoreOne\n\nMethod\n\nUses the same CRSA code\n\nEscad, Destover\n\nDynamic API Loading, (specifically the custom\n\n“Windows\n\nRomeoDelta Space-Dot Encoding, RSATransform function) found\n\nupdatetracing,”\n\nDNSCALC-style Encoding in SierraJuliet-MikeOne and\n\nNukeSped\n\nRomeoWhiskey\n\nDNSCALC-style Encoding,\nRomeoEcho Escad, Darpapox\nDatagram Format\n\nRomeoFoxtrot Common Send/Recv. Functions Dropped by IndiaCharlie\n\nLoaded by LimaBravo, Dropped by\nRomeoGolf Fake TLS\nIndiaEcho\n\nShares a common core, Romeo-\nRomeoHotel FakeTLS, Caracachs Escad\nCoreOne\n\n\n-----\n\n|MALWARE VARIANT|LAZARUS CODE RELATIONSHIPS|OTHER NOTES|OTHER AV DETECTIONS/ NAMES|\n|---|---|---|---|\n|RomeoMike|N/A|The C2 component seen in the “Ten Days of Rain” attacks||\n|RomeoNovember|DNSCALC-style Encoding|Shares a common core, Romeo- CoreOne|Escad|\n|RomeoWhiskey|Socket Disconnect, Common Network Data Transmission and Receiving Function, Datagram Format|One variant uses the same public key found in SierraJuliett-MikeOne|KillFW, Escad, Winsec, KorDllbot, KillFW, Destover|\n|SierraAlfa||Built specifically for the SPE attack, responsible for the distribution and activation of WhiskeyAlfa|Destover, NukeSped, Escad, Wiper|\n|SierraBravo|Suicide Script|Uses the same public key as SierraJuliett-MikeOne as well as one same library|Escad, Brambul, Joanap.c, Joanap.d|\n|SierraCharlie|Suicide Script|Shares a certificate with SierraJuliett- MikeOne, uses the same random IP generator as SierraBravo|Escad|\n|SierraJuliett- MikeOne|N/A|Shares a public key with SierraBravo, RomeoWhiskey; shares a certificate with SierraCharlie; loads TangoCharlie|Escad, Joanap|\n|SierraJuliett-MikeTwo|Caracachs|||\n|TangoAlfa|Opening Windows Firewall Method|Network Tester||\n|TangoBravo|Suicide Script|Domain Redirector, identified in Operation Troy|Koredos|\n|TangoCharlie|SierraJuliett-MikeOne payload|Windows Firewall Disabler||\n|TangoDelta|Suicide Script|Antivirus Suite Killer|Escad, Destover, NukeSped, Wiper|\n|WhiskeyAlfa|Suicide Script|One variant associated with the SPE attack also drops an additional malware family, HotelAlfa. Another variant associated with the SPE attack includes a spreading mechanism specific to SPE infrastructure and an option to drop TangoDelta|Destover, Escad, NukeSped, Wiper, KillFiles|\n|WhiskeyBravo|Shares code with other malware families during the file destructive process|Also profiled by McAfee’s analysis of the “Ten Days of Rain” incident1|KillFiles, DDoS- KSig, Fibebol, Koredos, QDDOS|\n|WhiskeyCharlie|Secure File Delete|||\n|WhiskeyDelta|DNSCALC-style Encoding||KillDisk, HDDKill, MBRKiller, KillMBR, Basutra|\n\n\n**OTHER AV**\n\n**MALWARE** **LAZARUS CODE** **OTHER**\n\n**DETECTIONS/**\n\n**VARIANT** **RELATIONSHIPS** **NOTES**\n\n**NAMES**\n\nThe C2 component seen in the “Ten\nRomeoMike N/A\nDays of Rain” attacks\n\nShares a common core, Romeo-\nRomeoNovember DNSCALC-style Encoding Escad\nCoreOne\n\nSocket Disconnect, Common\n\nKillFW, Escad,\n\nNetwork Data Transmission and One variant uses the same public key\n\nRomeoWhiskey Winsec, KorDllbot,\n\nReceiving Function, Datagram found in SierraJuliett-MikeOne\n\nKillFW, Destover\n\nFormat\n\nBuilt specifically for the SPE attack, Destover,\n\nSierraAlfa responsible for the distribution and NukeSped, Escad,\n\nactivation of WhiskeyAlfa Wiper\n\nUses the same public key as\n\nEscad, Brambul,\n\nSierraBravo Suicide Script SierraJuliett-MikeOne as well as one\n\nJoanap.c, Joanap.d\n\nsame library\n\nShares a certificate with SierraJuliett-\n\nSierraCharlie Suicide Script MikeOne, uses the same random IP Escad\n\ngenerator as SierraBravo\n\nShares a public key with SierraBravo,\n\nSierraJuliett- RomeoWhiskey; shares a\nN/A Escad, Joanap\nMikeOne certificate with SierraCharlie; loads\n\nTangoCharlie\n\nSierraJuliett-MikeTwo Caracachs\n\nOpening Windows Firewall\nTangoAlfa Network Tester\nMethod\n\nDomain Redirector, identified in\nTangoBravo Suicide Script Koredos\nOperation Troy\n\nTangoCharlie SierraJuliett-MikeOne payload Windows Firewall Disabler\n\nEscad, Destover,\nTangoDelta Suicide Script Antivirus Suite Killer\nNukeSped, Wiper\n\nOne variant associated with the\nSPE attack also drops an additional\nmalware family, HotelAlfa. Another\n\nDestover, Escad,\n\nvariant associated with the SPE\n\nWhiskeyAlfa Suicide Script NukeSped, Wiper,\n\nattack includes a spreading\n\nKillFiles\n\nmechanism specific to SPE\ninfrastructure and an option to drop\nTangoDelta\n\nShares code with other KillFiles, DDoS-\n\nAlso profiled by McAfee’s analysis of\n\nWhiskeyBravo malware families during the file KSig, Fibebol,\n\nthe “Ten Days of Rain” incident[1]\n\ndestructive process Koredos, QDDOS\n\nWhiskeyCharlie Secure File Delete\n\nKillDisk, HDDKill,\n\nWhiskeyDelta DNSCALC-style Encoding MBRKiller,\n\nKillMBR, Basutra\n\n1 Ten Days of Rain: Expert analysis of distributed denial-of-service attacks targeting South Korea.” McAfee. 2011. http://www.mcafee.com/us/resources/white-papers/wp-10-days-of-rain.pdf\n\n\n-----\n\n## 7. Glossary\n of Terms\n\n###### peration Blockbuster frequently uses technical terminology and abbreviations that\n\n#### O\n\n###### may be unfamiliar to certain audiences. Therefore,\n# Terms we have compiled the following glossary of terms\n###### to serve as a reference for readers. For further information on terminology or report details, please contact trig@novetta.com.\n\n\n-----\n\n##### 7. Glossary\n\n**API (Application Programming Interface)** **International Civil Aviation Organization (ICAO)**\n\nSet of routines and tools for creating software and UN organization that promotes security and aviation\napplications. regulation.\n\n**C2 (Command and Control)** **JoongAng Attack**\n\nInfrastructure used to control malware. The June 2012 attack on conservative media organization\n\nJoongAng carried out by hacker group IsOne using two\nNorth Korean servers and 17 servers in 10 other countries.\n\n**CNO (Computer Network Operations)**\n\nIntentional actions taken to improve networks and user\n\n**Keylogger**\n\ncompatibility.\n\nSomeone who tracks and notes each keystroke made on a\ncomputer, usually without permission from the user.\n\n**DDoS Attack (Distributed Denial-of-Service)**\n\nA type of attack where many compromised systems target\n\n**Master Boot Record (MBR)**\n\na single system making it unavailable to the intended user.\n\nThe information located in the first sector of a hard disk.\nThis identifies where the system is located so that it can be\n\n**DNSCALC**\n\nloaded into the main storage.\n\nMalware used by several APT groups and first profiled\nin 2010. Known for the use of DNS lookups for domain\n\n**Microsoft EMET (Enhanced Mitigation Experience**\n\nnames that would return specific IP addresses used to\n\n**Toolkit)**\n\ncalculate the listening port number for the C2 server.\n\nA tool that helps prevent software from being exploited by\nhackers.\n\n**Guardians of Peace (GOP)**\n\nThe hacker group who claimed to use destructive malware\n\n**P2P (Peer-to-Peer)**\n\nto attack Sony Pictures Entertainment by releasing\nconfidential information. An application that distributes tasks between peers.\n\n**Hangul Word Processor (HWP)** **PDB (Program Database) Path**\n\nWord processing application created by the South Korean A path for storing data about how to identify and remove\ncompany Hancom Inc. information from a program.\n\n**IDS (Intrusion Detection Signatures)** **Proxy Trojan**\n\nA pattern that allows identification of signatures. A type of Trojan designed to use the victim’s computer as\n\na proxy server. This allows the attacker to commit illegal\nactivities from a separate host.\n\n**Installers**\n\nSoftware that allows applications to run on a computer.\n\n\n-----\n\n**RATs (Remote Access Trojans)** **Totem**\n\nA malware program that includes an entry point for An open-source Novetta developed framework for large-\nadministrative control over a computer. These are usually scale file analysis and triage.\ninvisible to users and are downloaded through platforms\nsuch as online games and email attachments.\n\n**TTPs (Tools, Techniques and Processes)**\n\nThe extensive and varied toolset which effectively\n\n**RSA (Rivest, Shamir, and Adelman)**\n\ncombines a number of methods for delivering additional\n\nAn algorithm developed to better factor large numbers. malicious tools, exfiltrating data, and launching\n\ndestructive attacks.\n\n**SMB (Server Message Block)**\n\n**Uninstallers**\n\nUsed for enabling shared access to files between users on\na network. Various utility software that is created to remove parts\n\nfrom a computer.\n\n**Sony Pictures Entertainment (SPE)**\n\n**VPN (Virtual Private Network)**\n\nAn American Entertainment Incorporation and a\nsupplementary piece of media conglomerate Sony. A network that is created by using the internet to connect\n\nto a private network as a platform for transporting data.\n\n**Spreaders**\n\n**Wipers**\n\nThose who try to cause other computers to become\ninfected with viruses. A security measure taken to completely erase the data\n\nfrom a hard disk.\n\n**Ten Days of Rain Attacks**\n\n**YARA**\n\nAttacks that targeted South Korea’s media, financial, and\ncritical infrastructure targets. A tool used by researchers to identify malware samples\n\nbased on various patterns and rules.\n\n**TLS (Transport Layer Security)**\n\nProtocols created to provide communications security\nover a network.\n\n\n-----\n\nMcLean, Virginia – Headquarters\n7921 Jones Branch Drive\n5th Floor\nMcLean, VA 22102\n\n**www.OperationBlockbuster.com**\n\nPhone: (571) 282-3000\nwww.novetta.com\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "d63ae2b7-445f-460d-965d-2676dacdb6de",
            "created_at": "2022-10-25T15:59:19.552139Z",
            "updated_at": "2022-10-25T15:59:19.552139Z",
            "deleted_at": null,
            "name": "APTnotes",
            "url": "https://github.com/aptnotes/data",
            "description": "APTnotes data",
            "reports": null
        }
    ],
    "references": [
        "https://app.box.com/s/rhn69xecfqe8k2abwmn43ilmd59y1we0"
    ],
    "report_names": [
        "Novetta_Operation-Blockbuster-Report(Feb-24-2016)"
    ],
    "threat_actors": [
        {
            "id": "cea5ceec-0f14-4e34-bd0e-4074bc1a707d",
            "created_at": "2022-10-25T15:50:23.629983Z",
            "updated_at": "2025-03-27T02:00:55.509459Z",
            "deleted_at": null,
            "main_name": "Axiom",
            "aliases": [
                "Group 72"
            ],
            "source_name": "MITRE:Axiom",
            "tools": [
                "ZxShell",
                "gh0st RAT",
                "Zox",
                "PlugX",
                "Hikit",
                "PoisonIvy",
                "Derusbi",
                "Hydraq"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "67bf0462-41a3-4da5-b876-187e9ef7c375",
            "created_at": "2022-10-25T16:07:23.44832Z",
            "updated_at": "2025-03-27T02:02:09.806007Z",
            "deleted_at": null,
            "main_name": "Careto",
            "aliases": [
                "Careto",
                "The Mask",
                "Ugly Face"
            ],
            "source_name": "ETDA:Careto",
            "tools": [
                "Careto"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "4b076dcb-516e-42fb-9c8f-f153902cd5e9",
            "created_at": "2022-10-25T16:07:23.708745Z",
            "updated_at": "2025-03-27T02:02:09.935617Z",
            "deleted_at": null,
            "main_name": "Hidden Lynx",
            "aliases": [
                "Aurora Panda",
                "Group 8",
                "Hidden Lynx",
                "Operation SMN"
            ],
            "source_name": "ETDA:Hidden Lynx",
            "tools": [
                "AGENT.ABQMR",
                "AGENT.AQUP.DROPPER",
                "AGENT.BMZA",
                "AGENT.GUNZ",
                "BlackCoffee",
                "HiKit",
                "MCRAT.A",
                "Mdmbot.E",
                "Moudoor",
                "Naid",
                "PNGRAT",
                "Trojan.Naid",
                "ZoxPNG",
                "gresim"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "a3687241-9876-477b-aa13-a7c368ffda58",
            "created_at": "2022-10-25T16:07:24.496902Z",
            "updated_at": "2025-03-27T02:02:10.256629Z",
            "deleted_at": null,
            "main_name": "Hacking Team",
            "aliases": [],
            "source_name": "ETDA:Hacking Team",
            "tools": [],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "d18fe42c-8407-4f96-aee0-a04e6dce219a",
            "created_at": "2023-01-06T13:46:38.275292Z",
            "updated_at": "2025-03-27T02:00:02.79092Z",
            "deleted_at": null,
            "main_name": "APT12",
            "aliases": [
                "Calc Team",
                "IXESHE",
                "BRONZE GLOBE",
                "BeeBus",
                "DynCalc",
                "DNSCalc",
                "Crimson Iron",
                "NUMBERED PANDA",
                "TG-2754",
                "Group 22"
            ],
            "source_name": "MISPGALAXY:APT12",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "e90c06e4-e3e0-4f46-a3b5-17b84b31da62",
            "created_at": "2023-01-06T13:46:39.018236Z",
            "updated_at": "2025-03-27T02:00:02.978356Z",
            "deleted_at": null,
            "main_name": "Hacking Team",
            "aliases": [],
            "source_name": "MISPGALAXY:Hacking Team",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "49f1ada0-181f-4e89-a449-e6bc13c8c6b1",
            "created_at": "2022-10-25T15:50:23.561511Z",
            "updated_at": "2025-03-27T02:00:55.499988Z",
            "deleted_at": null,
            "main_name": "Cleaver",
            "aliases": [
                "Threat Group 2889",
                "TG-2889"
            ],
            "source_name": "MITRE:Cleaver",
            "tools": [
                "Net Crawler",
                "PsExec",
                "TinyZBot",
                "Mimikatz"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "6a660ea2-1118-404a-9f8f-f0d6a1e9f184",
            "created_at": "2022-10-25T15:50:23.685924Z",
            "updated_at": "2025-03-27T02:00:55.52357Z",
            "deleted_at": null,
            "main_name": "APT12",
            "aliases": [
                "APT12",
                "IXESHE",
                "DynCalc",
                "Numbered Panda",
                "DNSCALC"
            ],
            "source_name": "MITRE:APT12",
            "tools": [
                "Ixeshe",
                "RIPTIDE",
                "HTRAN"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "5c74936a-79d1-41b8-81eb-01d03c90a26b",
            "created_at": "2022-10-25T16:07:23.371052Z",
            "updated_at": "2025-03-27T02:02:09.766782Z",
            "deleted_at": null,
            "main_name": "Axiom",
            "aliases": [
                "Group 72",
                "Operation SMN"
            ],
            "source_name": "ETDA:Axiom",
            "tools": [
                "9002 RAT",
                "Agent.dhwf",
                "AngryRebel",
                "BlackCoffee",
                "BleDoor",
                "Chymine",
                "Darkmoon",
                "DeputyDog",
                "Derusbi",
                "Destroy RAT",
                "DestroyRAT",
                "Farfli",
                "Fexel",
                "Gen:Trojan.Heur.PT",
                "Gh0st RAT",
                "Ghost RAT",
                "Gresim",
                "HOMEUNIX",
                "HiKit",
                "HidraQ",
                "Homux",
                "Hydraq",
                "Kaba",
                "Korplug",
                "McRAT",
                "MdmBot",
                "Moudour",
                "Mydoor",
                "PCRat",
                "PNGRAT",
                "PlugX",
                "Poison Ivy",
                "RbDoor",
                "RedDelta",
                "RibDoor",
                "Roarur",
                "SPIVY",
                "Sensocode",
                "Sogu",
                "TIGERPLUG",
                "TVT",
                "Thoper",
                "Winnti",
                "Xamtrav",
                "ZXShell",
                "Zox",
                "ZoxPNG",
                "ZoxRPC",
                "gresim",
                "pivy",
                "poisonivy"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "761d1fb2-60e3-46f0-9f1c-c8a9715967d4",
            "created_at": "2023-01-06T13:46:38.269054Z",
            "updated_at": "2025-03-27T02:00:02.789278Z",
            "deleted_at": null,
            "main_name": "APT3",
            "aliases": [
                "TG-0110",
                "Group 6",
                "Buckeye",
                "Boyusec",
                "BORON",
                "BRONZE MAYFAIR",
                "Red Sylvan",
                "GOTHIC PANDA"
            ],
            "source_name": "MISPGALAXY:APT3",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "110e7160-a8cc-4a66-8550-f19f7d418117",
            "created_at": "2023-01-06T13:46:38.427592Z",
            "updated_at": "2025-03-27T02:00:02.830659Z",
            "deleted_at": null,
            "main_name": "Silent Chollima",
            "aliases": [
                "Subgroup: Andariel",
                "Onyx Sleet",
                "PLUTONIUM",
                "OperationTroy",
                "Guardian of Peace",
                "GOP",
                "WHOis Team",
                "Andariel"
            ],
            "source_name": "MISPGALAXY:Silent Chollima",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "cf7fc640-acfe-41c4-9f3d-5515d53a3ffb",
            "created_at": "2023-01-06T13:46:38.228042Z",
            "updated_at": "2025-03-27T02:00:02.775905Z",
            "deleted_at": null,
            "main_name": "APT1",
            "aliases": [
                "GIF89a",
                "G0006",
                "PLA Unit 61398",
                "Group 3",
                "TG-8223",
                "Comment Group",
                "ShadyRAT",
                "COMMENT PANDA",
                "Comment Crew",
                "Byzantine Candor",
                "Brown Fox"
            ],
            "source_name": "MISPGALAXY:APT1",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "32a223a8-3c79-4146-87c5-8557d38662ae",
            "created_at": "2022-10-25T15:50:23.703698Z",
            "updated_at": "2025-03-27T02:00:55.528031Z",
            "deleted_at": null,
            "main_name": "Lazarus Group",
            "aliases": [
                "Lazarus Group",
                "Labyrinth Chollima",
                "HIDDEN COBRA",
                "Guardians of Peace",
                "NICKEL ACADEMY",
                "Diamond Sleet"
            ],
            "source_name": "MITRE:Lazarus Group",
            "tools": [
                "RawDisk",
                "Proxysvc",
                "BADCALL",
                "FALLCHILL",
                "WannaCry",
                "HOPLIGHT",
                "TYPEFRAME",
                "Dtrack",
                "HotCroissant",
                "HARDRAIN",
                "Dacls",
                "KEYMARBLE",
                "TAINTEDSCRIBE",
                "AuditCred",
                "netsh",
                "ECCENTRICBANDWAGON",
                "AppleJeus",
                "BLINDINGCAN",
                "ThreatNeedle",
                "Volgmer",
                "Cryptoistic",
                "RATANKBA",
                "Bankshot",
                "Torisma",
                "Mimikatz"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "217c588a-5896-4335-b9ec-a516ae2f9a7e",
            "created_at": "2022-10-25T16:07:23.513775Z",
            "updated_at": "2025-03-27T02:02:09.838687Z",
            "deleted_at": null,
            "main_name": "Cutting Kitten",
            "aliases": [
                "Cutting Kitten",
                "Operation Cleaver",
                "TG-2889"
            ],
            "source_name": "ETDA:Cutting Kitten",
            "tools": [
                "CsExt",
                "DistTrack",
                "IvizTech",
                "Jasus",
                "KAgent",
                "Logger Module",
                "MANGOPUNCH",
                "MPK",
                "MPKBot",
                "Net Crawler",
                "NetC",
                "PVZ-In",
                "PVZ-Out",
                "Pupy",
                "PupyRAT",
                "PvzOut",
                "Shamoon",
                "SynFlooder",
                "SysKit",
                "TinyZBot",
                "WndTest",
                "pupy",
                "zhCat",
                "zhMimikatz"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "c5f79f58-db78-4cd7-88cf-c029a2199360",
            "created_at": "2022-10-25T16:07:23.325227Z",
            "updated_at": "2025-03-27T02:02:09.738383Z",
            "deleted_at": null,
            "main_name": "APT 12",
            "aliases": [
                "APT 12",
                "BeeBus",
                "Bronze Globe",
                "CTG-8223",
                "Calc Team",
                "Crimson Iron",
                "DNSCalc",
                "DynCALC",
                "Group 22",
                "Numbered Panda"
            ],
            "source_name": "ETDA:APT 12",
            "tools": [
                "AUMLIB",
                "ETUMBOT",
                "Exploz",
                "Graftor",
                "HIGHTIDE",
                "IHEATE",
                "IXESHE",
                "RIPTIDE",
                "RapidStealer",
                "Specfix",
                "THREEBYTE",
                "bbsinfo",
                "mswab",
                "yayih"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "9e767b38-12ae-4ef7-9878-5ce1701066d7",
            "created_at": "2024-05-01T02:03:08.131819Z",
            "updated_at": "2025-03-27T02:05:17.413497Z",
            "deleted_at": null,
            "main_name": "NICKEL ACADEMY",
            "aliases": [
                "COVELLITE ",
                "CTG-2460 ",
                "Diamond Sleet ",
                "Guardians of Peace",
                "HIDDEN COBRA ",
                "High Anonymous",
                "Labyrinth Chollima ",
                "NNPT Group",
                "New Romanic Cyber Army Team",
                "Temp.Hermit ",
                "The Lazarus Group ",
                "UNC577 ",
                "Who Am I?",
                "Whois Team",
                "ZINC ",
                "Black Artemis "
            ],
            "source_name": "Secureworks:NICKEL ACADEMY",
            "tools": [
                " DarkMessenger",
                " Destover",
                " Duuzer",
                " HOPLIGHT",
                " Joanap",
                " KorHigh",
                " LiveJinx",
                " Volgmer",
                "Brambul"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "8bc1a044-a23b-4904-903c-13f463605cb3",
            "created_at": "2024-05-01T02:03:08.136237Z",
            "updated_at": "2025-03-27T02:05:17.415795Z",
            "deleted_at": null,
            "main_name": "NICKEL GLADSTONE",
            "aliases": [
                "Bluenoroff ",
                "CTG-6459 ",
                "Citrine Sleet ",
                "HIDDEN COBRA ",
                "Lazarus Group",
                "Sapphire Sleet ",
                "Stardust Chollima ",
                "APT38 "
            ],
            "source_name": "Secureworks:NICKEL GLADSTONE",
            "tools": [
                " Bankshot",
                " CATCH22",
                " CCGC_Proxy",
                " Cur1Agent",
                " Ratankba",
                " Server_TrafficForwarder",
                " Wcry",
                "AlphaNC"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "e6e26922-3f4f-4243-9af5-cf9bea8b93bd",
            "created_at": "2022-10-25T16:47:55.577163Z",
            "updated_at": "2025-03-27T02:05:17.26824Z",
            "deleted_at": null,
            "main_name": "BRONZE GLOBE",
            "aliases": [
                "CTG-8223 ",
                "DNSCalc",
                "DyncCalc",
                "Numbered Panda ",
                "APT12 "
            ],
            "source_name": "Secureworks:BRONZE GLOBE",
            "tools": [
                " BeepService",
                " Etumbot",
                " Gh0st RAT",
                " Ixeshe",
                " Mswab",
                " RAdmin",
                " Seatran",
                " SvcInstaller",
                " Ziyang",
                "Badpuck"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "68cc6e37-f16d-4995-a75b-5e8e2a6cbb3d",
            "created_at": "2024-05-01T02:03:07.943593Z",
            "updated_at": "2025-03-27T02:05:17.259709Z",
            "deleted_at": null,
            "main_name": "BRONZE EDISON",
            "aliases": [
                "DarkSeoul",
                "Maverick Panda ",
                "Sykipot ",
                "TG-0623 ",
                "getkys",
                "APT4 "
            ],
            "source_name": "Secureworks:BRONZE EDISON",
            "tools": [
                " Wkysol",
                " ZxPortMap",
                "Gh0st RAT"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "a97cf06d-c2e2-4771-99a2-c9dee0d6a0ac",
            "created_at": "2022-10-25T16:07:24.349252Z",
            "updated_at": "2025-03-27T02:02:10.184406Z",
            "deleted_at": null,
            "main_name": "Turla",
            "aliases": [
                "ATK 13",
                "Belugasturgeon",
                "Blue Python",
                "CTG-8875",
                "Group 88",
                "ITG12",
                "Iron Hunter",
                "Krypton",
                "Makersmark",
                "Operation Epic Turla",
                "Operation Moonlight Maze",
                "Operation Penguin Turla",
                "Operation Satellite Turla",
                "Operation Skipper Turla",
                "Operation Turla Mosquito",
                "Operation WITCHCOVEN",
                "Pacifier APT",
                "Pensive Ursa",
                "Popeye",
                "SIG15",
                "SIG2",
                "SIG23",
                "Secret Blizzard",
                "TAG-0530",
                "Turla",
                "UNC4210",
                "Venomous Bear",
                "Waterbug"
            ],
            "source_name": "ETDA:Turla",
            "tools": [
                "ASPXSpy",
                "ASPXTool",
                "ATI-Agent",
                "AdobeARM",
                "Agent.BTZ",
                "Agent.DNE",
                "BigBoss",
                "COMpfun",
                "Chinch",
                "Cloud Duke",
                "CloudDuke",
                "CloudLook",
                "Cobra Carbon System",
                "ComRAT",
                "DoublePulsar",
                "EmPyre",
                "EmpireProject",
                "Epic Turla",
                "EternalBlue",
                "EternalRomance",
                "GoldenSky",
                "Group Policy Results Tool",
                "HTML5 Encoding",
                "HyperStack",
                "IcedCoffee",
                "IronNetInjector",
                "KSL0T",
                "Kapushka",
                "Kazuar",
                "KopiLuwak",
                "Kotel",
                "LOLBAS",
                "LOLBins",
                "LightNeuron",
                "Living off the Land",
                "Maintools.js",
                "Metasploit",
                "Meterpreter",
                "MiamiBeach",
                "Mimikatz",
                "MiniDionis",
                "Minit",
                "NBTscan",
                "NETTRANS",
                "NETVulture",
                "Neptun",
                "NetFlash",
                "NewPass",
                "Outlook Backdoor",
                "Penquin Turla",
                "Pfinet",
                "PowerShell Empire",
                "PowerShellRunner",
                "PowerShellRunner-based RPC backdoor",
                "PowerStallion",
                "PsExec",
                "PyFlash",
                "QUIETCANARY",
                "Reductor RAT",
                "RocketMan",
                "SMBTouch",
                "SScan",
                "Satellite Turla",
                "SilentMoon",
                "Sun rootkit",
                "TTNG",
                "TadjMakhal",
                "Tavdig",
                "TinyTurla",
                "TinyTurla Next Generation",
                "TinyTurla-NG",
                "Topinambour",
                "Tunnus",
                "Turla",
                "Turla SilentMoon",
                "TurlaChopper",
                "Uroburos",
                "Urouros",
                "WCE",
                "WITCHCOVEN",
                "WhiteAtlas",
                "WhiteBear",
                "Windows Credential Editor",
                "Windows Credentials Editor",
                "Wipbot",
                "WorldCupSec",
                "XTRANS",
                "certutil",
                "certutil.exe",
                "gpresult",
                "nbtscan",
                "nbtstat",
                "pwdump"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "4c68ccd0-caba-4189-9ead-86ac4c2d9b70",
            "created_at": "2024-05-01T02:03:07.930196Z",
            "updated_at": "2025-03-27T02:05:17.251237Z",
            "deleted_at": null,
            "main_name": "BRONZE ATLAS",
            "aliases": [
                "Axiom",
                "BARIUM ",
                "Blackfly ",
                "CTG-2633",
                "GREF",
                "Group 72 ",
                "Red Kelpie ",
                "TG-2633 ",
                "Wicked Panda ",
                "Winnti",
                "APT41 "
            ],
            "source_name": "Secureworks:BRONZE ATLAS",
            "tools": [
                " CCleaner v5.33 backdoor",
                " ChinaChopper",
                " Cobalt Strike",
                " Dicey MSDN",
                " ForkPlayground",
                " HUC Proxy Malware (Htran)",
                " Mimikatz",
                " PipeMon",
                " PlugX",
                " PortReuse",
                " Powershell Empire",
                " RCMD",
                " RbDoor",
                " SPEEDBOAT",
                " ShadowPad",
                " Sidewalk",
                " Speculoos",
                " TeamViewer",
                " Winnkit",
                " Winnti",
                " reg save",
                " vssadmin",
                "Acehash"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "8aaa5515-92dd-448d-bb20-3a253f4f8854",
            "created_at": "2024-06-19T02:03:08.147099Z",
            "updated_at": "2025-03-27T02:05:17.408118Z",
            "deleted_at": null,
            "main_name": "IRON HUNTER",
            "aliases": [
                "Belugasturgeon ",
                "Blue Python ",
                "CTG-8875 ",
                "ITG12 ",
                "KRYPTON ",
                "MAKERSMARK ",
                "Pensive Ursa ",
                "Secret Blizzard ",
                "Turla",
                "UAC-0003 ",
                "UAC-0024 ",
                "UNC4210 ",
                "Venomous Bear ",
                "Waterbug ",
                "ATK13 "
            ],
            "source_name": "Secureworks:IRON HUNTER",
            "tools": [
                " ComRAT",
                " Kazuar",
                " KopiLuwak",
                " LightNeuron",
                " Mosquito",
                " Nautilus",
                " Neuron",
                " Penquin",
                " PoisonFrog",
                " PyFlash",
                " Skipper",
                " Snake",
                " Tavdig",
                " TinyTurla",
                " Tunnus",
                "Carbon-DLL"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "3fff98c9-ad02-401d-9d4b-f78b5b634f31",
            "created_at": "2023-01-06T13:46:38.376868Z",
            "updated_at": "2025-03-27T02:00:02.818071Z",
            "deleted_at": null,
            "main_name": "Cleaver",
            "aliases": [
                "Cobalt Gypsy",
                "G0003",
                "Operation Cleaver",
                "Op Cleaver",
                "Tarh Andishan",
                "Alibaba",
                "TG-2889"
            ],
            "source_name": "MISPGALAXY:Cleaver",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "a97fee0d-af4b-4661-ae17-858925438fc4",
            "created_at": "2023-01-06T13:46:38.396415Z",
            "updated_at": "2025-03-27T02:00:02.823045Z",
            "deleted_at": null,
            "main_name": "Turla",
            "aliases": [
                "Uroburos",
                "Hippo Team",
                "Pacifier APT",
                "MAKERSMARK",
                "ATK13",
                "UAC-0003",
                "IRON HUNTER",
                "Waterbug",
                "TAG_0530",
                "KRYPTON",
                "Popeye",
                "SIG23",
                "UAC-0144",
                "G0010",
                "Blue Python",
                "VENOMOUS Bear",
                "Group 88",
                "Pfinet",
                "ITG12",
                "UNC4210",
                "Secret Blizzard",
                "UAC-0024"
            ],
            "source_name": "MISPGALAXY:Turla",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "a2b92056-9378-4749-926b-7e10c4500dac",
            "created_at": "2023-01-06T13:46:38.430595Z",
            "updated_at": "2025-03-27T02:00:02.831633Z",
            "deleted_at": null,
            "main_name": "Lazarus Group",
            "aliases": [
                "Operation DarkSeoul",
                "APT38",
                "ATK117",
                "DEV-1222",
                "G0032",
                "APT 38",
                "Stardust Chollima",
                "APT-C-26",
                "ATK3",
                "Diamond Sleet",
                "Hidden Cobra",
                "Unit 121",
                "Subgroup: Bluenoroff",
                "NICKEL GLADSTONE",
                "DEV-0139",
                "Andariel",
                "Operation Troy",
                "COVELLITE",
                "TA404",
                "Lazarus group",
                "Dark Seoul",
                "G0082",
                "NewRomanic Cyber Army Team",
                "Bluenoroff",
                "Appleworm",
                "Nickel Academy",
                "COPERNICIUM",
                "Hastati Group",
                "Bureau 121",
                "Operation AppleJeus",
                "Whois Hacking Team",
                "Citrine Sleet",
                "Sapphire Sleet",
                "Group 77",
                "Labyrinth Chollima",
                "Operation GhostSecret",
                "BeagleBoyz"
            ],
            "source_name": "MISPGALAXY:Lazarus Group",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "06f622cb-3a78-49cf-9a4c-a6007a69325f",
            "created_at": "2022-10-25T16:07:23.315239Z",
            "updated_at": "2025-03-27T02:02:09.733197Z",
            "deleted_at": null,
            "main_name": "APT 3",
            "aliases": [
                "APT 3",
                "Bronze Mayfair",
                "Buckeye",
                "Gothic Panda",
                "Group 6",
                "Operation Clandestine Fox",
                "Operation Clandestine Fox, Part Deux",
                "Operation Clandestine Wolf",
                "Operation Double Tap",
                "Red Sylvan",
                "TG-0110",
                "UPS Team"
            ],
            "source_name": "ETDA:APT 3",
            "tools": [
                "APT3 Keylogger",
                "Agent.dhwf",
                "BKDR_HUPIGON",
                "Backdoor.APT.CookieCutter",
                "Badey",
                "Bemstour",
                "CookieCutter",
                "Destroy RAT",
                "DestroyRAT",
                "DoublePulsar",
                "EXL",
                "EternalBlue",
                "HTran",
                "HUC Packet Transmit Tool",
                "Hupigon",
                "Hupigon RAT",
                "Kaba",
                "Korplug",
                "LaZagne",
                "MFC Huner",
                "OSInfo",
                "Pirpi",
                "PlugX",
                "RedDelta",
                "RemoteCMD",
                "SHOTPUT",
                "Sogu",
                "TIGERPLUG",
                "TTCalc",
                "TVT",
                "Thoper",
                "Xamtrav",
                "remotecmd",
                "shareip",
                "w32times"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "d11c89bb-1640-45fa-8322-6f4e4053d7f3",
            "created_at": "2022-10-25T15:50:23.509601Z",
            "updated_at": "2025-03-27T02:00:55.487991Z",
            "deleted_at": null,
            "main_name": "Turla",
            "aliases": [
                "Turla",
                "IRON HUNTER",
                "Group 88",
                "Waterbug",
                "WhiteBear",
                "Krypton",
                "Venomous Bear",
                "Secret Blizzard",
                "BELUGASTURGEON"
            ],
            "source_name": "MITRE:Turla",
            "tools": [
                "PsExec",
                "nbtstat",
                "ComRAT",
                "netstat",
                "certutil",
                "KOPILUWAK",
                "IronNetInjector",
                "LunarWeb",
                "Arp",
                "Uroburos",
                "PowerStallion",
                "Kazuar",
                "Systeminfo",
                "LightNeuron",
                "Mimikatz",
                "Tasklist",
                "LunarMail",
                "HyperStack",
                "NBTscan",
                "TinyTurla",
                "Penquin",
                "LunarLoader"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "3aaf0755-5c9b-4612-9f0e-e266ef1bdb4b",
            "created_at": "2022-10-25T16:07:23.480196Z",
            "updated_at": "2025-03-27T02:02:09.826059Z",
            "deleted_at": null,
            "main_name": "Comment Crew",
            "aliases": [
                "APT 1",
                "BrownFox",
                "Byzantine Candor",
                "Byzantine Hades",
                "Comment Crew",
                "Comment Panda",
                "GIF89a",
                "Group 3",
                "Operation Oceansalt",
                "Operation Seasalt",
                "Operation Siesta",
                "Shanghai Group",
                "TG-8223"
            ],
            "source_name": "ETDA:Comment Crew",
            "tools": [
                "Auriga",
                "Cachedump",
                "Chymine",
                "CookieBag",
                "Darkmoon",
                "GDOCUPLOAD",
                "GLOOXMAIL",
                "GREENCAT",
                "Gen:Trojan.Heur.PT",
                "GetMail",
                "Hackfase",
                "Hacksfase",
                "Helauto",
                "Kurton",
                "LETSGO",
                "LIGHTBOLT",
                "LIGHTDART",
                "LOLBAS",
                "LOLBins",
                "LONGRUN",
                "Living off the Land",
                "Lslsass",
                "MAPIget",
                "ManItsMe",
                "Mimikatz",
                "MiniASP",
                "Oceansalt",
                "Pass-The-Hash Toolkit",
                "Poison Ivy",
                "ProcDump",
                "Riodrv",
                "SPIVY",
                "Seasalt",
                "ShadyRAT",
                "StarsyPound",
                "TROJAN.COOKIES",
                "TROJAN.FOXY",
                "TabMsgSQL",
                "Tarsip",
                "Trojan.GTALK",
                "WebC2",
                "WebC2-AdSpace",
                "WebC2-Ausov",
                "WebC2-Bolid",
                "WebC2-Cson",
                "WebC2-DIV",
                "WebC2-GreenCat",
                "WebC2-Head",
                "WebC2-Kt3",
                "WebC2-Qbp",
                "WebC2-Rave",
                "WebC2-Table",
                "WebC2-UGX",
                "WebC2-Yahoo",
                "Wordpress Bruteforcer",
                "bangat",
                "gsecdump",
                "pivy",
                "poisonivy",
                "pwdump",
                "zxdosml"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "f32df445-9fb4-4234-99e0-3561f6498e4e",
            "created_at": "2022-10-25T16:07:23.756373Z",
            "updated_at": "2025-03-27T02:02:09.966155Z",
            "deleted_at": null,
            "main_name": "Lazarus Group",
            "aliases": [
                "APT-C-26",
                "ATK 3",
                "Appleworm",
                "Citrine Sleet",
                "DEV-0139",
                "Diamond Sleet",
                "Gleaming Pisces",
                "Gods Apostles",
                "Gods Disciples",
                "Group 77",
                "Guardians of Peace",
                "Hastati Group",
                "Hidden Cobra",
                "ITG03",
                "Jade Sleet",
                "Labyrinth Chollima",
                "Lazarus Group",
                "NewRomanic Cyber Army Team",
                "Operation 99",
                "Operation AppleJeus",
                "Operation AppleJeus sequel",
                "Operation Blockbuster: Breach of Sony Pictures Entertainment",
                "Operation CryptoCore",
                "Operation Dream Job",
                "Operation Dream Magic",
                "Operation Flame",
                "Operation GhostSecret",
                "Operation In(ter)caption",
                "Operation LolZarus",
                "Operation Marstech Mayhem",
                "Operation No Pineapple!",
                "Operation North Star",
                "Operation Phantom Circuit",
                "Operation Sharpshooter",
                "Operation Ten Days of Rain / DarkSeoul",
                "Operation Troy",
                "SectorA01",
                "Slow Pisces",
                "TA404",
                "TraderTraitor",
                "UNC2970",
                "UNC4034",
                "UNC4736",
                "UNC4899",
                "UNC577",
                "Whois Hacking Team"
            ],
            "source_name": "ETDA:Lazarus Group",
            "tools": [
                "3CX Backdoor",
                "3Rat Client",
                "3proxy",
                "AIRDRY",
                "ARTFULPIE",
                "ATMDtrack",
                "AlphaNC",
                "Alreay",
                "Andaratm",
                "AngryRebel",
                "AppleJeus",
                "Aryan",
                "AuditCred",
                "BADCALL",
                "BISTROMATH",
                "BLINDINGCAN",
                "BTC Changer",
                "BUFFETLINE",
                "BanSwift",
                "Bankshot",
                "Bitrep",
                "Bitsran",
                "BlindToad",
                "Bookcode",
                "BootWreck",
                "BottomLoader",
                "Brambul",
                "BravoNC",
                "Breut",
                "COLDCAT",
                "COPPERHEDGE",
                "CROWDEDFLOUNDER",
                "Castov",
                "CheeseTray",
                "CleanToad",
                "ClientTraficForwarder",
                "CollectionRAT",
                "Concealment Troy",
                "Contopee",
                "CookieTime",
                "Cyruslish",
                "DAVESHELL",
                "DBLL Dropper",
                "DLRAT",
                "DRATzarus",
                "DRATzarus RAT",
                "Dacls",
                "Dacls RAT",
                "DarkComet",
                "DarkKomet",
                "DeltaCharlie",
                "DeltaNC",
                "Dembr",
                "Destover",
                "DoublePulsar",
                "Dozer",
                "Dtrack",
                "Duuzer",
                "DyePack",
                "ECCENTRICBANDWAGON",
                "ELECTRICFISH",
                "Escad",
                "EternalBlue",
                "FALLCHILL",
                "FYNLOS",
                "FallChill RAT",
                "Farfli",
                "Fimlis",
                "FoggyBrass",
                "FudModule",
                "Fynloski",
                "Gh0st RAT",
                "Ghost RAT",
                "Gopuram",
                "HARDRAIN",
                "HIDDEN COBRA RAT/Worm",
                "HLOADER",
                "HOOKSHOT",
                "HOPLIGHT",
                "HOTCROISSANT",
                "HOTWAX",
                "HTTP Troy",
                "Hawup",
                "Hawup RAT",
                "Hermes",
                "HotCroissant",
                "HotelAlfa",
                "Hotwax",
                "HtDnDownLoader",
                "Http Dr0pper",
                "ICONICSTEALER",
                "Joanap",
                "Jokra",
                "KANDYKORN",
                "KEYMARBLE",
                "Kaos",
                "KillDisk",
                "KillMBR",
                "Koredos",
                "Krademok",
                "LIGHTSHIFT",
                "LIGHTSHOW",
                "LOLBAS",
                "LOLBins",
                "Lazarus",
                "LightlessCan",
                "Living off the Land",
                "MATA",
                "MBRkiller",
                "MagicRAT",
                "Manuscrypt",
                "Mimail",
                "Mimikatz",
                "Moudour",
                "Mydoom",
                "Mydoor",
                "Mytob",
                "NACHOCHEESE",
                "NachoCheese",
                "NestEgg",
                "NickelLoader",
                "NineRAT",
                "Novarg",
                "NukeSped",
                "OpBlockBuster",
                "PCRat",
                "PEBBLEDASH",
                "PLANKWALK",
                "POOLRAT",
                "PSLogger",
                "PhanDoor",
                "Plink",
                "PondRAT",
                "PowerBrace",
                "PowerRatankba",
                "PowerShell RAT",
                "PowerSpritz",
                "PowerTask",
                "Preft",
                "ProcDump",
                "Proxysvc",
                "PuTTY Link",
                "QUICKRIDE",
                "QUICKRIDE.POWER",
                "Quickcafe",
                "QuiteRAT",
                "R-C1",
                "ROptimizer",
                "Ratabanka",
                "RatabankaPOS",
                "Ratankba",
                "RatankbaPOS",
                "RawDisk",
                "RedShawl",
                "Rifdoor",
                "Rising Sun",
                "Romeo-CoreOne",
                "RomeoAlfa",
                "RomeoBravo",
                "RomeoCharlie",
                "RomeoCore",
                "RomeoDelta",
                "RomeoEcho",
                "RomeoFoxtrot",
                "RomeoGolf",
                "RomeoHotel",
                "RomeoMike",
                "RomeoNovember",
                "RomeoWhiskey",
                "Romeos",
                "RustBucket",
                "SHADYCAT",
                "SHARPKNOT",
                "SIGFLIP",
                "SIMPLESEA",
                "SLICKSHOES",
                "SORRYBRUTE",
                "SUDDENICON",
                "SUGARLOADER",
                "SheepRAT",
                "SierraAlfa",
                "SierraBravo",
                "SierraCharlie",
                "SierraJuliett-MikeOne",
                "SierraJuliett-MikeTwo",
                "SimpleTea",
                "SimplexTea",
                "SmallTiger",
                "Stunnel",
                "TAINTEDSCRIBE",
                "TAXHAUL",
                "TFlower",
                "TOUCHKEY",
                "TOUCHMOVE",
                "TOUCHSHIFT",
                "TOUCHSHOT",
                "TWOPENCE",
                "TYPEFRAME",
                "Tdrop",
                "Tdrop2",
                "ThreatNeedle",
                "Tiger RAT",
                "TigerRAT",
                "Trojan Manuscript",
                "Troy",
                "TroyRAT",
                "VEILEDSIGNAL",
                "VHD",
                "VHD Ransomware",
                "VIVACIOUSGIFT",
                "VSingle",
                "ValeforBeta",
                "Volgmer",
                "Vyveva",
                "W1_RAT",
                "Wana Decrypt0r",
                "WanaCry",
                "WanaCrypt",
                "WanaCrypt0r",
                "WannaCry",
                "WannaCrypt",
                "WannaCryptor",
                "WbBot",
                "Wcry",
                "Win32/KillDisk.NBB",
                "Win32/KillDisk.NBC",
                "Win32/KillDisk.NBD",
                "Win32/KillDisk.NBH",
                "Win32/KillDisk.NBI",
                "WinorDLL64",
                "Winsec",
                "WolfRAT",
                "Wormhole",
                "YamaBot",
                "Yort",
                "ZetaNile",
                "concealment_troy",
                "http_troy",
                "httpdr0pper",
                "httpdropper",
                "klovbot",
                "sRDI"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1666716497,
    "ts_updated_at": 1743041843,
    "ts_creation_date": 0,
    "ts_modification_date": 0,
    "files": {
        "pdf": "https://archive.orkl.eu/29d015e736a3012277f84f1b1bedc9bcac060648.pdf",
        "text": "https://archive.orkl.eu/29d015e736a3012277f84f1b1bedc9bcac060648.txt",
        "img": "https://archive.orkl.eu/29d015e736a3012277f84f1b1bedc9bcac060648.jpg"
    }
}