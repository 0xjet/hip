{
    "id": "3fd3f625-d32d-4888-be6d-1036165189a2",
    "created_at": "2022-10-25T16:48:15.300797Z",
    "updated_at": "2025-03-27T02:17:14.546748Z",
    "deleted_at": null,
    "sha1_hash": "01c32ccd1e596dbf0437b318f5ed5554a14c252a",
    "title": "ChessMaster Makes its Move: A Look into the Campaign's Cyberespionage Arsenal",
    "authors": "Trend Micro",
    "file_creation_date": "2018-02-04T19:30:15Z",
    "file_modification_date": "0001-01-01T00:00:00Z",
    "file_size": 509288,
    "plain_text": "# ChessMaster Makes its Move: A Look into the Campaign’s Cyberespionage Arsenal\n\n**[blog.trendmicro.com/trendlabs-security-intelligence/chessmaster-cyber-espionage-campaign/](https://blog.trendmicro.com/trendlabs-security-intelligence/chessmaster-cyber-espionage-campaign/)**\n\nTrend Micro July 27, 2017\n\n**_by Benson Sy, CH Lei, and Kawabata Kohei_**\n\nFrom gathering intelligence, using the right social\nengineering lures, and exploiting vulnerabilities to laterally\nmoving within the network, targeted attacks have multifarious\ntools at their disposal. And like in a game of chess, they are\nthe set pieces that make up their modus operandi.\n\nTake for instance the self-named ChessMaster, a campaign\ntargeting Japanese academe, technology enterprises, media\noutfits, managed service providers, and government\nagencies. It employs various poisoned pawns in the form of\nmalware-laden spear-phishing emails containing decoy documents. And beyond\nChessMaster’s endgame and pawns, we also found red flags that allude to its links to APT 10,\nalso known as menuPass, POTASSIUM, Stone Panda, Red Apollo, and CVNX.\n\nChessMaster’s name is from pieces of chess/checkers/draughts we found in the resource\nsection of the main backdoor they use against their targets: ChChes, which Trend Micro\ndetects as BKDR_CHCHES.\n\nWhat makes the campaign unique is its arsenal of tools and techniques:\n\n**_[Malicious shortcut (LNK) files and PowerShell. The LNK files execute Command](http://blog.trendmicro.com/trendlabs-security-intelligence/rising-trend-attackers-using-lnk-files-download-malware/)_**\n[Prompt that downloads a PowerShell script, which would either directly drop or](https://www.trendmicro.com/vinfo/us/security/news/security-technology/security-101-the-rise-of-fileless-threats-that-abuse-powershell)\nreflectively load ChChes into the machine. The latter method makes ChChes a fileless\nmalware.\n**_Self-extracting archive (SFX). An archive that drops an executable (EXE), a dynamic-_**\nlink library (DLL), and a binary file (.BIN). Upon their extraction, malicious code is\ninjected into the process of a legitimate file/application (DLL hijacking). ChessMaster\n[takes it up a notch via load-time dynamic linking to trigger the malicious DLL’s function.](https://msdn.microsoft.com/en-us/library/windows/desktop/ms684184(v=vs.85).aspx)\n**_Runtime packers. Throughout its campaign, ChChes used three packers to obfuscate_**\nitself and avoid detection. The first had no encryption and a varied loader code. The\nsecond had a buggy (or anti-emulation) exclusive OR (XOR) encryption technique. The\nthird added an AES algorithm on top of XOR encryption. Their compile dates overlap,\nwhich indicates ChChes’ authors take cues and fine-tune their malware.\n**_Second-stage payloads. Additional malware are introduced to the infected system for_**\npersistence. These are actually variants of ChChes that use similar entry points but\n\n\n-----\n\nand dumping tools they’ve misused and modified for their campaign. These can restore\nforgotten passwords, which are then dumped and retrieved. Lateral movement and\nfurther attacks can be worked out from here.\n**_[TinyX. A version of PlugX sans the plug-in functionality that allows it to adopt new](http://blog.trendmicro.com/trendlabs-security-intelligence/plugx-new-tool-for-a-not-so-new-campaign/)_**\ncapabilities. TinyX is bundled separately in spear-phishing emails.\n**_[RedLeaves. A second-stage backdoor that operates like the open-source and fileless](http://blog.jpcert.or.jp/2017/04/redleaves---malware-based-on-open-source-rat.html)_**\n[remote access Trojan (RAT) Trochilus, which is known for enabling lateral movement in](https://www.cyber.nj.gov/threat-profiles/trojan-variants/trochilus)\nthe infected systems. RedLeaves adopted capabilities from PlugX. In April, a RedLeaves\nvariant named himawari (Japanese for sunflower) emerged capable of evading YARA\nrules released during that time.\n\n**_ChessMaster and APT 10 Plays the Same Cyberespionage Game_**\nAPT 10/menuPass is a cyberespionage group whose specific campaign, Operation Cloud\nHopper, attacked the intermediaries of their targets of interest—managed service providers\n(MSPs). Its notoriety stems from their prolific use of multifarious information-stealing backdoors\nand vulnerability exploits, along with the tenacity of its subterfuges, from spear-phishing emails\nto attack and infection chains. It also abused legitimate or open-source remote administration\ntools to steal data.\n\nIf that sounded familiar, it’s because ChessMaster and APT 10 appear to be playing the same\ncyberespionage game. Here’s a further illustration:\n\n\n-----\n\nWe first saw ChChes set its sights on an organization that’s long been a target of APT\n10/menuPass. As we caught and delved into more ChChes samples in the wild, however, we\nalso saw how they followed the same pattern—exclusive packers, mutual targets, overlapping\nC&C infrastructure.\n\nChChes’ packer, for instance, resembled the one used in menuPass’ old PlugX samples. DNS\nrecords also showed that some of their command and control (C&C) servers and domains\nresolved to the same IP address, or resided in the same subnet. Are they operated by the\nsame actors? Their commonalities make it appear so. It’s also known to happen; BlackTech’s\ncyberespionage campaigns are a case in point.\n\n_Figure 2: Comparison of Emdivi and ChChes_\n\n[ChessMaster’s ChChes also resembles another backdoor, Emdivi, which first made waves in](http://blog.trendmicro.com/trendlabs-security-intelligence/attackers-target-organizations-in-japan-transform-local-sites-into-cc-servers-for-emdivi-backdoor/)\n2014. They have the same endgame. Both are second-stage payloads that use the system’s\nSecurity Identifier (SID) as encryption key so they execute only in their target’s machine. Their\ndifference lies in complexity—ChChes hides part of the decryption key and payload in registry\nkeys to make it harder to reverse engineer.\n\nBut that’s just one dot in several we’ve connected. In one instance, we detected PlugX and\nEmdivi on the same machine. This PlugX variant connected to an APT 10/menuPass-owned\ndomain, but the packer is similar to that used by ChChes. While it’s possible it was hit by two\ndifferent campaigns, further analysis told a different story. Both were compiled on the same\ndate, only several hours apart. We detected and acquired the samples the next day, which\n\n\n-----\n\n_Figure 3: Overview of the overlaps in ChessMaster and APT 10’s campaigns_\n\n**_Take ‘Control of the Center’_**\nUltimately attacks like ChessMaster’s make pawns out of the systems, networks, devices and\ntheir users, all of which hold the organization’s crown jewels. This is why enterprises need to\nbe steps ahead of the game: prepare, respond, restore, and learn. Plan ahead—what\ntechniques will attackers use? How can I defend against them? Don’t just pull the plug—\nunderstand what happened to better assess and mitigate the damage. Fine-tune your\nresponse—what worked, what didn’t, and what could’ve been done better?\n\nDefense in depth plays a crucial role especially for the IT/system administrators and\n[information security professionals that watch over them. The network, endpoints, servers,](http://www.trendmicro.com/us/enterprise/security-risk-management/deep-discovery/#network-protection)\n[mobile devices, and web/email gateways are the bishops, knights, and rooks that underpin the](https://www.trendmicro.com/en_us/business/products/user-protection/sps/mobile.html)\nenterprise’s crown jewels, which is why securing them is important. Reduce their attack\nsurface. Keep the systems updated and regularly patched, and enforce the principle of least\n[privilege. Employ behavior monitoring and application control. Deploy firewalls as well intrusion](https://www.trendmicro.com/en_us/business/products/user-protection/sps/endpoint/endpoint-application-control.html)\n[detection and prevention systems. Implement URL categorization, network segmentation, and](https://www.trendmicro.com/vinfo/us/security/news/cyber-attacks/protecting-data-through-network-segmentation)\n[data categorization.](http://blog.trendmicro.com/trendlabs-security-intelligence/identifying-and-dividing-networks-and-users/)\n\nChessMaster’s gambit is spear-phishing, so it’s especially important to filter and safeguard the\nemail gateway. Additionally, foster a cybersecurity-aware workforce. Seemingly benign icons\nor decoy documents can still swindle the victim, for instance. More importantly, develop\nproactive incident response and remediation strategies—threat intelligence helps enterprises\nprepare and mitigate attacks. Like in chess, the more you understand your enemy’s moves,\nthe more successful you can be at thwarting them.\n\n\n-----\n\n_A New Campaign Targeting Japan Using the New ChChes Backdoor” on July 27, 2017, in_\n_Marina Bay Sands, Singapore._\n\n_Updated on August 14, 2017, 11:50 PM to include IoCs related to ChessMaster._\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "d63ae2b7-445f-460d-965d-2676dacdb6de",
            "created_at": "2022-10-25T15:59:19.552139Z",
            "updated_at": "2022-10-25T15:59:19.552139Z",
            "deleted_at": null,
            "name": "APTnotes",
            "url": "https://github.com/aptnotes/data",
            "description": "APTnotes data",
            "reports": null
        }
    ],
    "references": [
        "https://app.box.com/s/g91aiwwkewqq147ueb0zj9okpfvs9z8m"
    ],
    "report_names": [
        "TrendMicro_ChessMaster-Makes-its-Move(07-27-2017)"
    ],
    "threat_actors": [
        {
            "id": "2646f776-792a-4498-967b-ec0d3498fdf1",
            "created_at": "2022-10-25T15:50:23.475784Z",
            "updated_at": "2025-03-27T02:00:55.479958Z",
            "deleted_at": null,
            "main_name": "BlackTech",
            "aliases": [
                "BlackTech",
                "Palmerworm"
            ],
            "source_name": "MITRE:BlackTech",
            "tools": [
                "Kivars",
                "PsExec",
                "TSCookie",
                "Flagpro",
                "Waterbear"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "d3a7123c-f519-49a0-a234-de24a1ef052a",
            "created_at": "2022-10-25T16:47:55.545211Z",
            "updated_at": "2025-03-27T02:05:17.254744Z",
            "deleted_at": null,
            "main_name": "BRONZE CANAL",
            "aliases": [
                "CTG-6177 ",
                "Circuit Panda ",
                "Palmerworm ",
                "Shrouded Crossbow ",
                "BlackTech"
            ],
            "source_name": "Secureworks:BRONZE CANAL",
            "tools": [
                " DRIGO",
                " Flagpro",
                " Gh0stTimes",
                " PLEAD",
                " Spiderpig",
                " Waterbear",
                "Bifrose"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "75024aad-424b-449a-b286-352fe9226bcb",
            "created_at": "2023-01-06T13:46:38.962724Z",
            "updated_at": "2025-03-27T02:00:02.964002Z",
            "deleted_at": null,
            "main_name": "BlackTech",
            "aliases": [
                "CIRCUIT PANDA",
                "Temp.Overboard",
                "G0098",
                "Red Djinn",
                "HUAPI",
                "Palmerworm",
                "T-APT-03",
                "Manga Taurus",
                "Earth Hundun"
            ],
            "source_name": "MISPGALAXY:BlackTech",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "efa7c047-b61c-4598-96d5-e00d01dec96b",
            "created_at": "2022-10-25T16:07:23.404442Z",
            "updated_at": "2025-03-27T02:02:09.781478Z",
            "deleted_at": null,
            "main_name": "BlackTech",
            "aliases": [
                "BlackTech",
                "Circuit Panda",
                "Earth Hundun",
                "Manga Taurus",
                "Operation PLEAD",
                "Operation Shrouded Crossbow",
                "Operation Waterbear",
                "Palmerworm",
                "Radio Panda",
                "Red Djinn",
                "T-APT-03",
                "TEMP.Overboard"
            ],
            "source_name": "ETDA:BlackTech",
            "tools": [
                "BIFROST",
                "BUSYICE",
                "BendyBear",
                "Bluether",
                "CAPGELD",
                "DRIGO",
                "Deuterbear",
                "Flagpro",
                "GOODTIMES",
                "Gh0stTimes",
                "IconDown",
                "KIVARS",
                "LOLBAS",
                "LOLBins",
                "Linopid",
                "Living off the Land",
                "TSCookie",
                "Waterbear",
                "XBOW",
                "elf.bifrose"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "ec14074c-8517-40e1-b4d7-3897f1254487",
            "created_at": "2023-01-06T13:46:38.300905Z",
            "updated_at": "2025-03-27T02:00:02.799108Z",
            "deleted_at": null,
            "main_name": "APT10",
            "aliases": [
                "TA429",
                "STONE PANDA",
                "POTASSIUM",
                "Red Apollo",
                "HOGFISH",
                "Cloud Hopper",
                "BRONZE RIVERSIDE",
                "ATK41",
                "G0045",
                "Menupass Team",
                "happyyongzi",
                "CVNX",
                "Granite Taurus"
            ],
            "source_name": "MISPGALAXY:APT10",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "2f07a03f-eb1f-47c8-a8e9-a1a00f2ec253",
            "created_at": "2022-10-25T16:07:24.277669Z",
            "updated_at": "2025-03-27T02:02:10.157972Z",
            "deleted_at": null,
            "main_name": "TA428",
            "aliases": [
                "Operation LagTime IT",
                "Operation StealthyTrident",
                "ThunderCats"
            ],
            "source_name": "ETDA:TA428",
            "tools": [
                "8.t Dropper",
                "8.t RTF exploit builder",
                "8t_dropper",
                "Agent.dhwf",
                "Albaniiutas",
                "BlueTraveller",
                "Chymine",
                "Cotx RAT",
                "CoughingDown",
                "Darkmoon",
                "Destroy RAT",
                "DestroyRAT",
                "Gen:Trojan.Heur.PT",
                "Kaba",
                "Korplug",
                "LuckyBack",
                "PhantomNet",
                "PlugX",
                "Poison Ivy",
                "RedDelta",
                "RoyalRoad",
                "SManager",
                "SPIVY",
                "Sogu",
                "TIGERPLUG",
                "TManger",
                "TVT",
                "Thoper",
                "Xamtrav",
                "pivy",
                "poisonivy"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "48782737-377b-47b4-aff0-87424208a643",
            "created_at": "2023-01-06T13:46:38.569144Z",
            "updated_at": "2025-03-27T02:00:02.863397Z",
            "deleted_at": null,
            "main_name": "Blue Termite",
            "aliases": [
                "Cloudy Omega",
                "Emdivi"
            ],
            "source_name": "MISPGALAXY:Blue Termite",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "ba3fff0c-3ba0-4855-9eeb-1af9ee18136a",
            "created_at": "2022-10-25T15:50:23.298889Z",
            "updated_at": "2025-03-27T02:00:55.433541Z",
            "deleted_at": null,
            "main_name": "menuPass",
            "aliases": [
                "menuPass",
                "POTASSIUM",
                "Stone Panda",
                "APT10",
                "Red Apollo",
                "CVNX",
                "HOGFISH",
                "BRONZE RIVERSIDE"
            ],
            "source_name": "MITRE:menuPass",
            "tools": [
                "certutil",
                "FYAnti",
                "UPPERCUT",
                "SNUGRIDE",
                "P8RAT",
                "RedLeaves",
                "SodaMaster",
                "pwdump",
                "Mimikatz",
                "PlugX",
                "PowerSploit",
                "ChChes",
                "cmd",
                "QuasarRAT",
                "AdFind",
                "Cobalt Strike",
                "PoisonIvy",
                "EvilGrab",
                "esentutl",
                "Impacket",
                "Ecipekac",
                "PsExec",
                "HUI Loader"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "ba9fa308-a29a-4928-9c06-73aafec7624c",
            "created_at": "2024-05-01T02:03:07.981061Z",
            "updated_at": "2025-03-27T02:05:17.28602Z",
            "deleted_at": null,
            "main_name": "BRONZE RIVERSIDE",
            "aliases": [
                "CTG-5938 ",
                "CVNX ",
                "Hogfish ",
                "MenuPass ",
                "POTASSIUM ",
                "Red Apollo ",
                "Stone Panda ",
                "APT10 "
            ],
            "source_name": "Secureworks:BRONZE RIVERSIDE",
            "tools": [
                " ChChes",
                " Cobalt Strike",
                " PlugX",
                " PoisonIvy",
                " QuasarRAT",
                " QuasarRAT Loader",
                " RedLeaves",
                "ANEL"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "04b07437-41bb-4126-bcbb-def16f19d7c6",
            "created_at": "2022-10-25T16:07:24.232628Z",
            "updated_at": "2025-03-27T02:02:10.146043Z",
            "deleted_at": null,
            "main_name": "Stone Panda",
            "aliases": [
                "APT 10",
                "ATK 41",
                "Bronze Riverside",
                "CTG-5938",
                "CVNX",
                "Cuckoo Spear",
                "Earth Kasha",
                "Granite Taurus",
                "Happyyongzi",
                "Hogfish",
                "ITG01",
                "Operation A41APT",
                "Operation Cache Panda",
                "Operation ChessMaster",
                "Operation Cloud Hopper",
                "Operation Cuckoo Spear",
                "Operation New Battle",
                "Operation Soft Cell",
                "Operation TradeSecret",
                "Potassium",
                "Red Apollo",
                "Stone Panda",
                "TA429",
                "menuPass",
                "menuPass Team"
            ],
            "source_name": "ETDA:Stone Panda",
            "tools": [
                "Agent.dhwf",
                "Agentemis",
                "Anel",
                "AngryRebel",
                "BKDR_EVILOGE",
                "BKDR_HGDER",
                "BKDR_NVICM",
                "BUGJUICE",
                "CHINACHOPPER",
                "ChChes",
                "China Chopper",
                "Chymine",
                "CinaRAT",
                "Cobalt Strike",
                "CobaltStrike",
                "DARKTOWN",
                "DESLoader",
                "DILLJUICE",
                "DILLWEED",
                "Darkmoon",
                "DelfsCake",
                "Derusbi",
                "Destroy RAT",
                "DestroyRAT",
                "Ecipekac",
                "Emdivi",
                "EvilGrab",
                "EvilGrab RAT",
                "FYAnti",
                "Farfli",
                "Gen:Trojan.Heur.PT",
                "Gh0st RAT",
                "Ghost RAT",
                "GreetCake",
                "HAYMAKER",
                "HEAVYHAND",
                "HEAVYPOT",
                "HTran",
                "HUC Packet Transmit Tool",
                "Ham Backdoor",
                "HiddenFace",
                "Impacket",
                "Invoke the Hash",
                "KABOB",
                "Kaba",
                "Korplug",
                "LODEINFO",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "MiS-Type",
                "Mimikatz",
                "Moudour",
                "Mydoor",
                "NBTscan",
                "NOOPDOOR",
                "Newsripper",
                "P8RAT",
                "PCRat",
                "PlugX",
                "Poison Ivy",
                "Poldat",
                "PowerSploit",
                "PowerView",
                "PsExec",
                "PsList",
                "Quarks PwDump",
                "Quasar RAT",
                "QuasarRAT",
                "RedDelta",
                "RedLeaves",
                "Rubeus",
                "SNUGRIDE",
                "SPIVY",
                "SharpSploit",
                "SigLoader",
                "SinoChopper",
                "SodaMaster",
                "Sogu",
                "TIGERPLUG",
                "TVT",
                "Thoper",
                "Trochilus RAT",
                "UpperCut",
                "Vidgrab",
                "WinRAR",
                "WmiExec",
                "Wmonder",
                "Xamtrav",
                "Yggdrasil",
                "Zlib",
                "certutil",
                "certutil.exe",
                "cobeacon",
                "dfls",
                "lena",
                "nbtscan",
                "pivy",
                "poisonivy",
                "pwdump"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1666716495,
    "ts_updated_at": 1743041834,
    "ts_creation_date": 1517772615,
    "ts_modification_date": 0,
    "files": {
        "pdf": "https://archive.orkl.eu/01c32ccd1e596dbf0437b318f5ed5554a14c252a.pdf",
        "text": "https://archive.orkl.eu/01c32ccd1e596dbf0437b318f5ed5554a14c252a.txt",
        "img": "https://archive.orkl.eu/01c32ccd1e596dbf0437b318f5ed5554a14c252a.jpg"
    }
}