{
    "id": "cf09f204-ff86-4273-b3c7-a616e0cec9e9",
    "created_at": "2022-10-25T16:48:13.777455Z",
    "updated_at": "2025-03-27T02:15:41.621Z",
    "deleted_at": null,
    "sha1_hash": "a95b65c51aa3655e486a5b843d4ffdddbe375eb5",
    "title": "",
    "authors": "",
    "file_creation_date": "2020-06-05T06:42:50Z",
    "file_modification_date": "2020-06-05T06:42:50Z",
    "file_size": 1486697,
    "plain_text": "# New LNK attack tied to Higaisa APT discovered\n\n**[blog.malwarebytes.com/threat-analysis/2020/06/higaisa](https://blog.malwarebytes.com/threat-analysis/2020/06/higaisa/)**\n\nThreat Intelligence Team June 4, 2020\n\n_This post was authored by Hossein Jazi and Jérôme Segura_\n\nOn May 29th, we identified an attack that we believe is part of a new campaign from an Advanced\nPersistent Threat actor known as Higaisa. The Higaisa APT is believed to be tied to the Korean\npeninsula, and was first disclosed by Tencent Security Threat Intelligence Center in early 2019.\n\nThe group’s activities go back to at least 2016 and include the use of Trojans such as Gh0st and\nPlugX, as well as mobile malware. Its targets include government officials and human rights\norganizations, as well as other entities related to North Korea.\n\nIn this latest incident, Higaisa used a malicious shortcut file ultimately responsible for creating a\nmulti-stage attack that consists of several malicious scripts, payloads and decoy PDF documents.\n\n### Distribution\n\nThe threat actors used a malicious LNK file bundled within an archive file which was most likely\ndistributed via spear-phishing.\n\nWe were able to identify two variants of this campaign that possibly have been distributed\nbetween May 12th and 31st:\n\n“CV_Colliers.rar”\n“Project link and New copyright policy.rar”\n\nBoth RAR archives bundle two malicious LNK files. In the newer variant (CV_Colliers.rar), the\nLNK files are disguised as a Curriculum Vitae (CV) and International English Language Testing\nSystem (IELTS) exam results. The older one (Project link and New copyright policy.rar) seems to\n[target product teams that are using zeplin io](https://zeplin.io/)\n\n\n-----\n\nThe following shows the overall process flow when executing the malicious LNK file.\n\nFigure 1: Process graph\n\n### LNK file\n\nThe LNK file contains a list of commands that will be executed upon running, and a blob that is a\nbase64 encoded compressed payload. Here is the list of commands that will be executed:\n\nFigure 2: Malicious lnk commands\n\nCopy content of the LNK file into “g4ZokyumB2DC4.tmp” in %APPDATA% temp directory.\nCopy content of “certutil.exe” into “gosia.exe” ( “*ertu*.exe is used to bypass security\ndetection).\nLook for the base64 blob using “findstr.exe” and write it to “cSi1rouy4.tmp”.\nDecode content of “cSi1rouy4.tmp” using “gosia.exe -decode” (certutil.exe -decode) and\nwrite it to “o423DFDS4.tmp”.\nDecompress content of “o423DFDS4.tmp” in temp directory along with a decoy PDF\ndocument using “expand.exe -F:*” (Figure 3) .\nCopy “66DF33DFG.tmp” and “34fDKfSD38.js” files into “C:\\Users\\Public\\Downloads”\ndirectory.\nExecute the JS file by calling Wscript.\nOpen the decoy document.\n\n\n-----\n\nFigure 3: Content of the “o423DFDS4.tmp” cab file\n\nThe list of commands executed by this LNK shortcut is the same as the one reported by Anomali\n[on the Higasia Covid-19 campaign. The only difference is the name of the tmp files and name of](https://www.anomali.com/blog/covid-19-themes-are-being-utilized-by-threat-actors-of-varying-sophistication)\ncertutil.exe which in this new case is “gosia.exe”, while in the March campaign the name was\n“mosia.exe”.\n\nBoth LNK files embedded within the archive are executing similar commands with the different\nCommand and Control (C&C) configurations. Running each of them would show a different decoy\ndocument.\n\nFigure 4: CV Decoy document\n\n\n-----\n\nFigure 5: IELTS test result decoy document\n\n### JS file\n\nThe JavaScript file performs the following commands:\n\nCreate “d3reEW.exe” in “C:\\Users\\Public\\Downloads” and store “cmd /c ipconfig” in it.\nExecute the dropped “svchast.exe”.\nCopy “svchhast.exe” into startup directory and rename it as “officeupdate.exe”.\nAdd “officeupdate.exe” to scheduled tasks.\nSend a POST request to a hardcoded URL with “d3reEW.exe” as data.\n\nFigure 6: JS content\n\nFigure7: POST request\n\n\n-----\n\n## svchast.exe\n\nSvchast.exe is a small loader that loads the content of the shellcode stored in “63DF3DFG.tmp”.\n\nFigure 8: Main function of svchast.exe\n\nIn fact, this shellcode is a wrapper around the final shellcode. It performs some checks and then\ncalls the final shellcode.\n\n\n-----\n\nFigure 9: Calling final shellcode\n\nThe final shellcode dynamically resolves the imports and allocates memory for the content that\nwill be executed.\n\nFigure 10: Resolving the imports\n\n\n-----\n\nFigure 11: Allocate memory for new thread\n\nFinally it calls “CreateThread” to create a thread within its memory space to make HTTPS\nrequests to its C&C server.\n\nFigure 11: CreateThread\n\nAt the time of analysis, the server was down so we weren’t able to clearly identify the ultimate\ngoal of this attack.\n\n### Chaining techniques for evasion\n\nWhile most malware campaigns use a simple decoy document that typically retrieves a malware\npayload, more advanced attackers will often try unconventional means to infect their victims.\n\nWe reproduced this attack in our lab using an email as the infection vector, as we surmise that\n[victims were spear-phished. Malwarebytes (in this case the Nebula business version) stopped the](https://www.malwarebytes.com/business/cloud/)\nLNK file execution from WinRAR and therefore completely stopped the attack.\n\n\n-----\n\n### IOCs\n\n**CV_Colliers.rar**\ndf999d24bde96decdbb65287ca0986db98f73b4ed477e18c3ef100064bceba6d\n\n**Project link and New copyright policy.rar**\nc3a45aaf6ba9f2a53d26a96406b6c34a56f364abe1dd54d55461b9cc5b9d9a04\n\n**Curriculum Vitae_WANG LEI_Hong Kong Polytechnic University.pdf.lnk**\n50d081e526beeb61dc6180f809d6230e7cc56d9a2562dd0f7e01f7c6e73388d9\n\n**Tokbox icon – Odds and Ends – iOS – Zeplin.lnk**\n1074654a3f3df73f6e0fd0ad81597c662b75c273c92dc75c5a6bea81f093ef81\n\n**International English Language Testing System certificate.pdf.lnk**\nc613487a5fc65b3b4ca855980e33dd327b3f37a61ce0809518ba98b454ebf68b\n\n**Curriculum Vitae_WANG LEI_Hong Kong Polytechnic University.pdf.lnk**\ndcd2531aa89a99f009a740eab43d2aa2b8c1ed7c8d7e755405039f3a235e23a6\n\n**Conversations – iOS – Swipe Icons – Zeplin.lnk**\nc0a0266f6df7f1235aeb4aad554e505320560967248c9c5cce7409fc77b56bd5\n\n\n-----\n\n**C2 domains (ipconfig exfiltration)**\nsixindent[.]epizy[.]com\ngoodhk[.]azurewebsites[.]net\nzeplin[.]atwebpages[.]com\n\n**C2s used by svchast.exe**\n45.76.6[.]149\nwww.comcleanner[.]info\n\n### MITRE ATT&CK techniques\n\n#### Tactic ID Name Details\n\n\n#### Execution T1059 Command-Line Interface\n\n T1106 Execution through API\n\n\n#### Starts CMD.EXE for commands (Win‐ RAR.exe, wscript.exe) execution\n\n Application (AcroRd32.exe) launched itself\n\n\n#### T1053 Scheduled Task Loads the Task Scheduler DLL interface (Officeupdate.exe)\n\n T1064 Scripting Executes scripts (34fDFkfSD38.js)\n\n T1204 User Execution Manual execution by user (opening LNK file)\n\n\n#### Persis‐ tence\n\n Privilege Escalation\n\n Defense Evasion\n\n\n#### T1060 Registry Run Keys / Startup Folder\n\n\n#### Writes to a start menu file (Officeupdate.exe)\n\n\n#### T1053 Scheduled Task Uses Task Scheduler to run other ap‐ plications (Officeupdate.exe)\n\n T1053 Scheduled Task Uses Task Scheduler to run other ap‐ plications (Officeupdate.exe)\n\n T1064 Scripting Executes scripts (34fDFkfSD38.js)\n\n\n#### T1140 Deobfuscate/Decode Files or Information\n\n\n#### certutil to decode Base64 binaries, ex‐ pand.exe to decompress a CAB file\n\n\n#### Discovery T1012 Query Registry Reads the machine GUID from the registry\n\n\n#### T1082 System Information Discovery\n\n T1016 System Network Con‐ figuration Discovery\n\n\n#### Reads the machine GUID from the registry\n\n Uses IPCONFIG.EXE to discover IP address\n\n\n-----\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        }
    ],
    "references": [
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2020/2020.06.03.Higaisa_APT/New%20LNK%20attack%20tied%20to%20Higaisa%20APT%20discovered%20-%20Malwarebytes%20Labs%20_%20Malwarebytes%20Labs.pdf"
    ],
    "report_names": [
        "New LNK attack tied to Higaisa APT discovered - Malwarebytes Labs _ Malwarebytes Labs"
    ],
    "threat_actors": [
        {
            "id": "873919c0-bc6a-4c19-b18d-c107e4aa3d20",
            "created_at": "2023-01-06T13:46:39.138138Z",
            "updated_at": "2025-03-27T02:00:03.005534Z",
            "deleted_at": null,
            "main_name": "Higaisa",
            "aliases": [],
            "source_name": "MISPGALAXY:Higaisa",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "30c9c492-afc6-4aa1-8fe6-cecffed946e0",
            "created_at": "2022-10-25T15:50:23.400822Z",
            "updated_at": "2025-03-27T02:00:55.461334Z",
            "deleted_at": null,
            "main_name": "Higaisa",
            "aliases": [
                "Higaisa"
            ],
            "source_name": "MITRE:Higaisa",
            "tools": [
                "PlugX",
                "certutil",
                "gh0st RAT"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "c0cedde3-5a9b-430f-9b77-e6568307205e",
            "created_at": "2022-10-25T16:07:23.528994Z",
            "updated_at": "2025-03-27T02:02:09.847683Z",
            "deleted_at": null,
            "main_name": "DarkHotel",
            "aliases": [
                "APT-C-06",
                "ATK 52",
                "CTG-1948",
                "Dubnium",
                "Fallout Team",
                "Higaisa",
                "Luder",
                "Operation DarkHotel",
                "Operation Daybreak",
                "Operation Inexsmar",
                "Operation PowerFall",
                "Operation The Gh0st Remains the Same",
                "SIG25",
                "Shadow Crane",
                "T-APT-02",
                "Tungsten Bridge",
                "Zigzag Hail"
            ],
            "source_name": "ETDA:DarkHotel",
            "tools": [
                "Asruex",
                "DarkHotel",
                "DmaUp3.exe",
                "GreezeBackdoor",
                "Karba",
                "Nemain",
                "Nemim",
                "Ramsay",
                "Retro",
                "Tapaoux",
                "Trojan.Win32.Karba.e",
                "Virus.Win32.Pioneer.dx",
                "igfxext.exe",
                "msieckc.exe"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1666716493,
    "ts_updated_at": 1743041741,
    "ts_creation_date": 1591339370,
    "ts_modification_date": 1591339370,
    "files": {
        "pdf": "https://archive.orkl.eu/a95b65c51aa3655e486a5b843d4ffdddbe375eb5.pdf",
        "text": "https://archive.orkl.eu/a95b65c51aa3655e486a5b843d4ffdddbe375eb5.txt",
        "img": "https://archive.orkl.eu/a95b65c51aa3655e486a5b843d4ffdddbe375eb5.jpg"
    }
}