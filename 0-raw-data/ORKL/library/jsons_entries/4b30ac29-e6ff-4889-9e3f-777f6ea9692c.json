{
    "id": "4b30ac29-e6ff-4889-9e3f-777f6ea9692c",
    "created_at": "2022-10-25T16:48:23.703189Z",
    "updated_at": "2025-03-27T02:05:58.83891Z",
    "deleted_at": null,
    "sha1_hash": "6180b9b0b136037f8cc95d9d536cd7d3aaecf9c9",
    "title": "",
    "authors": "",
    "file_creation_date": "2019-03-14T08:21:51Z",
    "file_modification_date": "2019-03-14T08:21:51Z",
    "file_size": 5252187,
    "plain_text": "# GlitchPOS: New PoS malware for sale\n\n**[blog.talosintelligence.com/2019/03/glitchpos-new-pos-malware-for-sale.html](https://blog.talosintelligence.com/2019/03/glitchpos-new-pos-malware-for-sale.html)**\n\n[Warren Mercer and](https://twitter.com/securitybeard) [Paul Rascagneres authored this post with contributions from Ben](https://twitter.com/r00tbsd)\nBaker.\n\n## Executive summary\n\nPoint-of-sale malware is popular among attackers, as it usually leads to them obtaining\ncredit card numbers and immediately use that information for financial gain. This type of\nmalware is generally deployed on retailers' websites and retail point-of-sale locations with\nthe goal of tracking customers' payment information. If they successfully obtain credit card\ndetails, they can use either the proceeds from the sale of that information or use the credit\ncard data directly to obtain additional exploits and resources for other malware. Point-ofsale terminals are often forgotten about in terms of segregation and can represent a soft\ntarget for attackers. Cisco Talos recently discovered a new PoS malware that the attackers\nare selling on a crimeware forum. Our researchers also discovered the associated\npayloads with the malware, its infrastructure and control panel. We assess with high\nconfidence that this is not the first malware developed by this actor. A few years ago, they\nwere also pushing the DiamondFox L!NK botnet. Known as \"GlitchPOS,\" this malware is\nalso being distributed on alternative websites at a higher price than the original.\n\nThe actor behind this malware created a video, which we embedded below, showing how\neasy it is to use it. This is a case where the average user could purchase all the tools\nnecessary to set up their own credit card-skimming botnet.\n\n## GlitchPOS\n\n### Packer overview\n\nA packer developed in VisualBasic protects this malware It's on the surface a fake\n\n\n-----\n\ncontains various pictures of cats:\n\nThe purpose of the packer is to decode a library that's the real payload encoded with the\nUPX packer. Once decoded, we gain access to GlitchPOS, a memory grabber developed\nin VisualBasic.\n\n### Payload analysis\n\nThe payload is small and contains only a few functions. It can connect to a command and\ncontrol (C2) server to:\n\nRegister the infected systems\n\nReceive tasks (command execution in memory or on disk)\n\nExfiltrate credit card numbers from the memory of the infected system\n\nUpdate the exclusion list of scanned processes\n\nUpdate the \"encryption\" key\n\nUpdate the User Agent\n\nClean itself\n\n#### Tasks mechanism\n\n\n-----\n\nThe commands are executed via a shellcode directly sent by the C2 server. Here is an\nexample in Wireshark:\n\nThe shellcode is encoded with base64. In our screenshot, the shellcode is a RunPE:\n\n\n-----\n\n#### \"Encryption\" key\n\nThe \"encryption\" key of the communication can be updated in the panel. The\ncommunication is not encrypted but simply XORed:\n\n#### Credit card grabber\n\nThe main purpose of this malware is to steal credit card numbers (Track1 and Track2)\nfrom the memory of the infected system. GlitchPOS uses a regular expression to perform\nthis task:\n\n(%B)\\d{0,19}\\^[\\w\\s\\/]{2,26}\\^\\d{7}\\w*\\?\n\n\n-----\n\nHere is an example of Track 1:\n\nCardholder : M. TALOS\n\nCard number*: 1234 5678 9012 3445\n\nExpiration: 01/99\n\n%B1234567890123445^TALOS/M.\n\n;\\d{13,19}=\\d{7}\\w*\\?\n\nThe purpose of this regular expression is to detect Track 2\n\nHere is an example of Track 2 based on the previous example:\n\n;1234567890123445=99011200XXXX00000000?*\n\nIf a match is identified in memory, the result is sent to the C2 server. The malware\nmaintains an exclusion list provided by the server. Here is the default list: chrome, firefox,\niexplore, svchost, smss, csrss, wininit, steam, devenv, thunderbird, skype, pidgin,\nservices, dwn, dllhost, jusched, jucheck, lsass, winlogon, alg, wscntfy, taskmgr, taskhost,\nspoolsv, qml, akw.\n\n### Panel\n\nHere are some additional screenshots of the GlitchPOS panel. These screenshots were\nprovided by the seller to promote the malware.\n\nThe \"Dashboard:\"\n\n\n-----\n\nThe \"Clients\" list:\n\nThe \"Cards Date:\"\n\n\n-----\n\n## Linked with DiamondFox L!NK botnet\n\n### Author: Edbitss\n\nThe first mention of GlitchPOS was on Feb. 2, 2019 on a malware forum:\n\nEdbitss is allegedly the developer of the DiamondFox L!NK botnet in 2015/2016 and 2017\nas explained in a report by [CheckPoint.](https://blog.checkpoint.com/wp-content/uploads/2017/05/DiamondFox_Report_170510-2.pdf)\n\n\n-----\n\nThe developer created this video to promote GlitchPOS, as well. In this video, you can see\nthe author set up the malware and capture the data from a swiped card. We apologize for\nthe quality, shakiness, music, and generally anything else with this video, again, it's not\nours.\n\nThe built malware is sold for $250, the builder $600 and finally, the gate address change is\ncharged at $80.\n\n### Panel similarities\n\n\n-----\n\nDiamondFox panel and the GlitchPOS panel. In this section, the DiamondPOS\nscreenshots come from the CheckPoint report mentioned previously.\n\nBoth dashboards' world map are similar (image, code and color):\n\nThe author used the same terminology such ask \"Clients\" or \"Tasks\" on the left menu:\n\n\n-----\n\nThe icons are the same too in both panels, as well as the infected machine list (starting\nwith the HWID). The PHP file naming convention is similar to DiamondFox, too.\n\nThe author clearly reused code from DiamondFox panel on the GlitchPOS panel.\n\n### Comparison of GlitchPOS and the DiamondFox POS module\n\nIn 2017, the DiamondFox malware included a POS plugin. We decided to check if this\nmodule was the same as GlitchPOS, but it is not. For DiamondFox, the author decided to\nuse the leaked code of BlackPOS to build the credit card grabber. On GlitchPOS, the\nauthor developed its own code to perform this task and did not use the previously leaked\ncode.\n\n## Bad guys are everywhere\n\nIt's interesting to see that someone else attempted to push the same malware 25 days\nafter edbitss on an alternative forum:\n\n\n-----\n\nThis attacker even tried to cash in by increasing some prices.\n\nSome members even attempted to\ncall out the unscrupulous behaviour:\n\nWith the different information we have, we think that Chameleon101 has taken the\nprevious malware created by Edbitss to sell it on an alternative forum and with a higher\nprice.\n\n\n-----\n\n## Conclusion\n\nThis investigation shows us that POS malware is still attractive and some people are still\nworking on the development of this family of malware. We can see that edbitss developed\nmalware years even after being publicly mentioned by cybersecurity companies. He left\nDiamondFox to switch on a new project targeting point-of-sale. The sale opened a few\nweeks ago, so we don't know yet how many people bought it or use it. We also see that\nbad guys steal the work of each other and try to sell malware developed by other\ndevelopers at a higher price. The final word will be a quote from Edbitss on a DiamondFox\nscreenshot published by himself \"In the future, even bank robbers will be replaced.\"\n\n## Coverage\n\n\n-----\n\nAdditional ways our customers can detect and block this threat are listed below.\n[Advanced Malware Protection (AMP)](http://cs.co/reviewamp)\nis ideally suited to prevent the\nexecution of the malware used by\nthese threat actors. Below is a\nscreenshot showing how AMP can\nprotect customers from this threat.\nTry AMP for free [here.](http://cisco.com/go/tryamp)\n\n[Cisco Cloud Web Security (CWS)](https://www.cisco.com/c/en/us/products/security/cloud-web-security/index.html)\n[orWeb Security Appliance (WSA)](https://www.cisco.com/c/en/us/products/security/web-security-appliance/index.html)\nweb scanning prevents access to\nmalicious websites and detects\nmalware used in these attacks.\n\ncan block malicious emails sent by\nthreat actors as part of their\ncampaign.\n\nNetwork Security appliances such\n[asNext-Generation Firewall (NGFW),](https://www.cisco.com/c/en/us/products/security/firewalls/index.html)\nNext-Generation Intrusion Prevention\n[System (NGIPS), and Meraki MX can](https://meraki.cisco.com/products/appliances)\ndetect malicious activity associated\nwith this threat.\n\n[AMP Threat Grid helps identify](https://www.cisco.com/c/en/us/solutions/enterprise-networks/amp-threat-grid/index.html)\nmalicious binaries and build\nprotection into all Cisco Security products.\n\n[Umbrella, our secure internet gateway (SIG), blocks users from connecting to malicious](https://umbrella.cisco.com/)\ndomains, IPs, and URLs, whether users are on or off the corporate network.\n\nOpen Source SNORTâ“‡ Subscriber Rule Set customers can stay up to date by\ndownloading the latest rule pack available for purchase on [Snort.org.](https://www.snort.org/products)\n\n## Indicators of Compromise (IOCs)\n\nThe following IOCs are associated to this campaign:\n\n### GlitchPOS samples\n\ned043ff67cc28e67ba36566c340090a19e5bf87c6092d418ff0fd3759fb661ab (SHA256)\n\n\n-----\n\nabfadb6686459f69a92ede367a2713fc2a1289ebe0c8596964682e4334cee553 (SHA256)\n\n### C2 server\n\ncoupondemo[.]dynamicinnovation[.]net\n\n### URLs\n\nhxxp://coupondemo[.]dynamicinnovation[.]net/cgl-bin/gate.php\n\nhxxp://coupondemo[.]dynamicinnovation[.]net/admin/gate.php\n\nhxxp://coupondemo[.]dynamicinnovation[.]net/glitch/gate.php\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        }
    ],
    "references": [
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2019/2019.03.13.GlitchPOS_POS_Malware/GlitchPOS_New_Pos_Malwre_for_sale.pdf"
    ],
    "report_names": [
        "GlitchPOS_New_Pos_Malwre_for_sale"
    ],
    "threat_actors": [],
    "ts_created_at": 1666716503,
    "ts_updated_at": 1743041158,
    "ts_creation_date": 1552551711,
    "ts_modification_date": 1552551711,
    "files": {
        "pdf": "https://archive.orkl.eu/6180b9b0b136037f8cc95d9d536cd7d3aaecf9c9.pdf",
        "text": "https://archive.orkl.eu/6180b9b0b136037f8cc95d9d536cd7d3aaecf9c9.txt",
        "img": "https://archive.orkl.eu/6180b9b0b136037f8cc95d9d536cd7d3aaecf9c9.jpg"
    }
}