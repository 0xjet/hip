{
    "id": "5ffd1c8b-ea76-4a97-959a-8a6601dd0f73",
    "created_at": "2023-01-12T15:10:45.975843Z",
    "updated_at": "2025-03-27T02:09:18.808558Z",
    "deleted_at": null,
    "sha1_hash": "b98795d686a94bdb7e15727a4f61a1b690153e57",
    "title": "2021-10-21 - Cobalt Strike- Using Known Private Keys To Decrypt Traffic – Part 1",
    "authors": "",
    "file_creation_date": "2022-05-28T19:54:11Z",
    "file_modification_date": "2022-05-28T19:54:11Z",
    "file_size": 277051,
    "plain_text": "# Cobalt Strike: Using Known Private Keys To Decrypt Traffic – Part 1\n\n**[blog.nviso.eu/2021/10/21/cobalt-strike-using-known-private-keys-to-decrypt-traffic-part-1/](https://blog.nviso.eu/2021/10/21/cobalt-strike-using-known-private-keys-to-decrypt-traffic-part-1/)**\n\nOctober 21, 2021\n\n[Blogpost series: Cobalt Strike: Decrypting Traffic](https://blog.nviso.eu/series/cobalt-strike-decrypting-traffic/)\n_We found 6 private keys for rogue Cobalt Strike software, enabling C2 network traffic_\n_decryption._\n\nThe communication between a Cobalt Strike beacon (client) and a Cobalt Strike team server\n(C2) is encrypted with AES (even when it takes place over HTTPS). The AES key is\ngenerated by the beacon, and communicated to the C2 using an encrypted metadata blob (a\ncookie, by default).\n\n[RSA encryption is used to encrypt this metadata: the beacon has the public key of the C2,](https://research.nccgroup.com/2020/06/15/striking-back-at-retired-cobalt-strike-a-look-at-a-legacy-vulnerability/)\nand the C2 has the private key.\n\n\n-----\n\nFigure 1: C2 traffic\nPublic and private keys are stored in file .cobaltstrike.beacon_keys. These keys are\ngenerated when the Cobalt Strike team server software is used for the first time.\n\nDuring our fingerprinting of Internet facing Cobalt Strike servers, we found public keys that\nare used by many different servers. This implies that they use the same private key, thus that\ntheir .cobaltstrike.beacon_keys file is shared.\n\nOne possible explanation we verified: are there cracked versions of Cobalt Strike, used by\nmalicious actors, that include a .cobaltstrike.beacon_keys? This file is not part of a legitimate\nCobalt Strike package, as it is generated at first time use.\n\nSearching through VirusTotal, we found 10 cracked Cobalt Strike packages: ZIP files\ncontaining a file named .cobaltstrike.beacon_keys. Out of these 10 packages, we extracted 6\nunique RSA key pairs.\n\n2 of these pairs are prevalent on the Internet: 25% of the Cobalt Strike servers we\nfingerprinted (1500+) use one of these 2 key pairs.\n\n[This key information is now included in tool 1768.py, a tool developed by Didier Stevens to](https://blog.didierstevens.com/2021/10/11/update-1768-py-version-0-0-8/)\nextract configurations of Cobalt Strike beacons.\n\nWhenever a public key is extracted with known private key, the tool highlights this:\n\n\n-----\n\nFigure 2: 1768.py extracting configuration from beacon\nAt minimum, this information is further confirmation that the sample came from a rogue\nCobalt Strike server (and not a red team server).\n\nUsing option verbose, the private key is also displayed.\n\n\n-----\n\nFigure 3: using option verbose to display the private key\nThis can then be used to decrypt the metadata, and the C2 traffic (more on this later).\n\nFigure 4: decrypting metadata\n\n\n-----\n\nIn upcoming blog posts, we will show in detail how to use these private keys to decrypt\nmetadata and decrypt C2 traffic.\n\n**About the authors**\nDidier Stevens is a malware expert working for NVISO. Didier is a SANS Internet Storm\nCenter senior handler and Microsoft MVP, and has developed numerous popular tools to\n[assist with malware analysis. You can find Didier on Twitter and](https://twitter.com/DidierStevens) [LinkedIn.](https://be.linkedin.com/in/didierstevens)\n\n[You can follow NVISO Labs on Twitter to stay up to date on all our future research and](https://twitter.com/NVISO_Labs)\npublications.\n\nSeries Navigation [Cobalt Strike: Using Known Private Keys To Decrypt Traffic – Part 2 >>](https://blog.nviso.eu/2021/10/27/cobalt-strike-using-known-private-keys-to-decrypt-traffic-part-2/)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-10-21 - Cobalt Strike- Using Known Private Keys To Decrypt Traffic – Part 1.pdf"
    ],
    "report_names": [
        "2021-10-21 - Cobalt Strike- Using Known Private Keys To Decrypt Traffic – Part 1.pdf"
    ],
    "threat_actors": [
        {
            "id": "610a7295-3139-4f34-8cec-b3da40add480",
            "created_at": "2023-01-06T13:46:38.608142Z",
            "updated_at": "2025-03-27T02:00:02.87217Z",
            "deleted_at": null,
            "main_name": "Cobalt",
            "aliases": [
                "Cobalt Gang",
                "GOLD KINGSWOOD",
                "COBALT SPIDER",
                "G0080",
                "Mule Libra",
                "Cobalt Group"
            ],
            "source_name": "MISPGALAXY:Cobalt",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673536245,
    "ts_updated_at": 1743041358,
    "ts_creation_date": 1653767651,
    "ts_modification_date": 1653767651,
    "files": {
        "pdf": "https://archive.orkl.eu/b98795d686a94bdb7e15727a4f61a1b690153e57.pdf",
        "text": "https://archive.orkl.eu/b98795d686a94bdb7e15727a4f61a1b690153e57.txt",
        "img": "https://archive.orkl.eu/b98795d686a94bdb7e15727a4f61a1b690153e57.jpg"
    }
}