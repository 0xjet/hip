{
    "id": "c66618cb-420f-4c3c-864d-a8aacb316bc2",
    "created_at": "2023-01-12T14:58:54.566901Z",
    "updated_at": "2025-03-27T02:15:38.043483Z",
    "deleted_at": null,
    "sha1_hash": "d1ea493aa4bd3123caa02cbc26c2b3e7150eba86",
    "title": "2020-04-13 - GuLoader delivers RATs and Spies in Disguise",
    "authors": "",
    "file_creation_date": "2022-05-28T03:29:17Z",
    "file_modification_date": "2022-05-28T03:29:17Z",
    "file_size": 476923,
    "plain_text": "# GuLoader delivers RATs and Spies in Disguise\n\n**labs.k7computing.com/**\n\nBy K7 Labs April 13, 2020\n\nHackers have been taking advantage of the Coronavirus scare by employing a COVID\ntheme in their phishing pages and spam emails. In this blog, we will dig deeper into the\nGuLoader malware which comes attached as a spam document in such emails. This\nmalware is a VBdownloader that has been used in many such malicious campaigns and\ncan be attributed to Gorgon APT, TA505 and TA542 threat groups among others.\n\nGuLoader is a small VB5/6 file which typically downloads RATs, stealers or spies like\nFormbook, Agent Tesla, Lokibot, Remcos RAT, NetWire RAT etc. We recently analyzed a\n[campaign which was using GuLoader to download and deliver Formbook from Google](https://labs.k7computing.com/?p=19988)\nDrive. While analyzing this campaign we were able to locate around 2100 GuLoader\nsamples which connect to multiple Google drive links and 130 samples which contact\nOneDrive, in February, and by end of March, we were able to locate around 3300 new\nsamples which connect to Google drive and 250 samples which connect to OneDrive,\nwhich is around 60% increase than the previous month. In total the number of Guloader is\naround 6000+ samples in the past 3 months.\n\n\n-----\n\n_Figure 1: Graph showing month wise volume of collected samples_\nIt is evident from the increasing numbers as shown in Figure 1, that this malware has\ngained popularity and is being used for nefarious activities by various threat actors. The\npopularity factor is because of some of its features like:\n\n[It is small and can be embedded in ISO image files and RAR files.](https://www.virustotal.com/gui/file/fdce490297abbe2f54c2b53477f1a5c3ec0e8edcbd30f388b3b7b5d369210b53/detection)\nStores its encrypted payload on Google Drive and OneDrive, which can later be\ndownloaded and decrypted by a simple xor operation.\n\n_Figure 2: File hosted on cloud service._\n\nInjects the decrypted payload into the targeted processes.\n\n\n-----\n\nPredominantly used to deliver NanoCore RAT, Remcos RAT, Quasar RAT, NetWire\nRAT, Agent Tesla and Formbook malware.\nUses anti-attach techniques.\n\n**GuLoader analysis**\n\nThe infection chain of the campaign which downloads GuLoader is depicted in Figure 3.\n\n_Figure 3: Infection chain of GuLoader_\nThe malicious VB file allocates virtual space to decrypt and execute the code responsible\nfor the following:\n\nDebugger Anti-attach technique: The malware uses ZwSetInformationThread API\nto detach itself from the debugger.\n\nPatching ntdll.DbgBreakPoint and ntdll.RemoteUiRemoteBreakin: When we\nattach a debugger to a running process it calls DebugActiveProcess API which in\nturn calls RtlCreateUserThread function to create a new remote thread into the\ntargeted process with DbgUiRemoteBreakin function as its new thread’s starting\npoint. Therefore, a malware can easily hook ntdll.DbgBreakPoint and\nntdll.DbgUiRemoteBreakin API and patch them to the point that will cause the\nprocess to exit or NOP (no operation) or to a point where it will call an unknown or\nnon-readable location.\n\n\n-----\n\nUnhooking user mode hook: For behavior-based detection most of the Anti-Virus\nproducts implement a user mode hook for some of the most common APIs used by\nmalware. To do that, they simply modify the 1st 5 bytes (0xb8 ????????) of the API\nfunction with an unconditional (0xe9 ????????) jump to their hook handler. To avoid\nthis, the malware tries to rewrite the 1st 5 bytes to its original state even if the hook is\nnot in place.\n\nDownload payload from cloud storage: Downloads the file stored on Google\nDrive/OneDrive and decrypts it.\n\nIt then injects this decrypted payload to the targeted process or creates a child\nprocess of itself and overwrites the child process with the decrypted content from the\nimage base 0x400000.\n\n[For more detailed reading about the above mentioned points, do have a look at this blog.](https://labs.k7computing.com/?p=19988)\n\nGiven below are some of the paths in which the GuLoader is saved on the PC as per our\ntelemetry reports\n\n_C:\\USERS\\____\\APPDATA\\LOCAL\\TEMP\\SUBFOLDER\\FILENAME.EXE_\n\n_C:\\USERS\\_____\\APPDATA\\LOCAL\\TEMP\\RAR$DIA4024.13665\\QUOTATION_\n_REQUEST.SCR_\n\n_C:\\DOCUME~1\\_____\\LOCALS~1\\TEMP\\RAR$EXA0.993\\SCANDOC8383.EXE_\n\n_C:\\USERS\\____\\APPDATA\\LOCAL\\TEMP\\RAR$EX00.225\\DOC981.EXE_\n\n_C:\\USERS\\___\\APPDATA\\LOCAL\\TEMP\\RAR$EXA0.418\\CL MONA (13912-I0005)_\n__HIRE STATEMENT_PAYMENT COPY_PDF.EXE_\n\n_C:\\USERS\\_____\\APPDATA\\LOCAL\\TEMP\\SUBFOLDER\\WINDOW.EXE_\n\n_C:\\USERS\\_____\\APPDATA\\LOCAL\\TEMP\\RAR$DIA0.789\\CONSIGNMENT_\n_DOCUMENTS.SCR_\n\n_C:\\USERS\\_____\\APPDATA\\LOCAL\\TEMP\\RAR$EX00.626\\SWIFT COPY.EXE_\n\n_C:\\USERS\\_______\\APPDATA\\LOCAL\\TEMP\\RAR$EX00.251\\PURCHASE ORDER-_\n_3647585PDF.EXE_\n\n_C:\\USERS\\______\\APPDATA\\LOCAL\\TEMP\\RAR$EXA0.440\\RFQ-21902.EXE_\n\n_C:\\USERS\\_____\\APPDATA\\LOCAL\\TEMP\\RAR$EX00.403\\PAYMENT_0320.EXE_\n\n_C:\\USERS\\____\\APPDATA\\LOCAL\\TEMP\\RAR$EXA0.540\\BRANCHE.EXE_\n\n\n-----\n\n_C:\\USERS\\________\\APPDATA\\LOCAL\\TEMP\\RAR$EXA0.181\\SCANDOC8383.EXE_\n_C:\\USERS\\________\\APPDATA\\LOCAL\\TEMP\\RAR$DIA0.815\\ATTACHED_\n_PO#19POGL1614-2020REF0088427.SCR_\n\nThese GuLoader exe files get downloaded and saved to the system after the Coronavirus\nspam document is opened. This happens when macros are enabled by the victim or after\nsuccessful exploitation of vulnerabilities like CVE-2017-11882 by the threat actors.\n\nThis is one of the major campaigns this year so far. Emails with the COVID theme, and\nwith the impersonation of trustworthy agencies like WHO, UNICEF, Govt Health agency,\netc., lure the recipient to open them and their attachments. With the ever growing concern\nrelated to the Corona pandemic and people’s hunger for information, the COVID based\nspam has been quite successful in gaining victims. We sifted through our pan-India\ntelemetry and we were able to find at least 60 hits for the last week of March and more\nthan 800 unique hits in the past 30 days or so.\n\n**Security Guidelines**\n\nDo not fall prey to any spam mails related to COVID19 or any other emails that you\nweren’t expecting\nCultivate the use of spam filters\nPay close attention to the email address of the sender before downloading any\nattachment\nInstall the latest service packs and hot fixes from Microsoft\nInstall a reliable security product like K7 Total security and ensure it is enabled and\nkept up-to-date\n\n**Indicators of Compromise (IoCs)**\n\n**Spam doc/xls**\n\n19B9749D417DD800042EEF6CE4831665 Trojan ( 0001140e1 )\n\n23B8E03D5F5B6F906006E43047E78EC1 Trojan ( 0001140e1 )\n\n5127D7FD0E929E157D9B9F677D8496D4 Trojan ( 0001140e1 )\n\nFFC54A5B610C781E9E6C7F15666FA026 Trojan ( 0001140e1 )\n\n**GuLoader**\n\n06765254FA14E550E6BCEE092CB37B18 Trojan ( 005630331 )\n\n7580F80CE0B825EF8931F0B5A25FD131 Trojan ( 0056315b1 )\n\n9DBA8EEEE47B6F14B4E4814824397375 Trojan ( 00561ca31 )\n\n50B1D1DFECE17FE955BF9DA7942C5A73 Riskware ( 0040eff71 )\n\n\n-----\n\n1910E8659F87A0B9F62C78B829CF7295 Trojan ( 00561c181 )\n\n**Malware downloaded by GuLoader**\n\nC949A9618462F5C83A93FDD2EB0DABF7 Password-Stealer ( 0052f96e1 )\n\n7573808E70745FCAF78117F420F67C73 Password-Stealer ( 0040f4f51 )\n\n4DD1308E8D02539221057684398D300D Trojan ( 005608181 )\n\n1899A6720B1E95E57BAB440524AD5B14 Trojan ( 005485311 )\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2020/2020-04-13 - GuLoader delivers RATs and Spies in Disguise.pdf"
    ],
    "report_names": [
        "2020-04-13 - GuLoader delivers RATs and Spies in Disguise.pdf"
    ],
    "threat_actors": [
        {
            "id": "e8e18067-f64b-4e54-9493-6d450b7d40df",
            "created_at": "2022-10-25T16:07:24.515213Z",
            "updated_at": "2025-03-27T02:02:10.267637Z",
            "deleted_at": null,
            "main_name": "Mummy Spider",
            "aliases": [
                "ATK 104",
                "Gold Crestwood",
                "Mummy Spider",
                "TA542"
            ],
            "source_name": "ETDA:Mummy Spider",
            "tools": [
                "Emotet",
                "Geodo",
                "Heodo"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "99cb4e5b-8071-4f9e-aa1d-45bfbb6197e3",
            "created_at": "2023-01-06T13:46:38.860754Z",
            "updated_at": "2025-03-27T02:00:02.937438Z",
            "deleted_at": null,
            "main_name": "TA505",
            "aliases": [
                "SectorJ04 Group",
                "Dudear",
                "G0092",
                "ATK103",
                "Hive0065",
                "Spandex Tempest",
                "GRACEFUL SPIDER",
                "GOLD TAHOE",
                "CHIMBORAZO",
                "SectorJ04"
            ],
            "source_name": "MISPGALAXY:TA505",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "506404b2-82fb-4b7e-b40d-57c2e9b59f40",
            "created_at": "2023-01-06T13:46:38.870883Z",
            "updated_at": "2025-03-27T02:00:02.939775Z",
            "deleted_at": null,
            "main_name": "MUMMY SPIDER",
            "aliases": [
                "TA542",
                "GOLD CRESTWOOD"
            ],
            "source_name": "MISPGALAXY:MUMMY SPIDER",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "2ac83159-1d9d-4db4-a176-97be6b7b07c9",
            "created_at": "2024-06-19T02:03:08.024653Z",
            "updated_at": "2025-03-27T02:05:17.348806Z",
            "deleted_at": null,
            "main_name": "GOLD CRESTWOOD",
            "aliases": [
                "TA542 ",
                "Mummy Spider "
            ],
            "source_name": "Secureworks:GOLD CRESTWOOD",
            "tools": [
                "Emotet"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "5e6b31a6-80e3-4e7d-8b0a-d94897ce9b59",
            "created_at": "2024-06-19T02:03:08.128175Z",
            "updated_at": "2025-03-27T02:05:17.400394Z",
            "deleted_at": null,
            "main_name": "GOLD TAHOE",
            "aliases": [
                "SectorJ04 ",
                "Spandex Tempest ",
                "TA505 ",
                "FIN11 "
            ],
            "source_name": "Secureworks:GOLD TAHOE",
            "tools": [
                " Cobalt Strike",
                " FlawedAmmy",
                " Get2",
                " GraceWire",
                " Malichus",
                " SDBbot",
                " ServHelper",
                " TrueBot",
                "Clop"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "75d4d6a9-b5d1-4087-a7a0-e4a9587c45f4",
            "created_at": "2022-10-25T15:50:23.5188Z",
            "updated_at": "2025-03-27T02:00:55.489882Z",
            "deleted_at": null,
            "main_name": "TA505",
            "aliases": [
                "TA505",
                "Hive0065",
                "Spandex Tempest",
                "CHIMBORAZO"
            ],
            "source_name": "MITRE:TA505",
            "tools": [
                "AdFind",
                "Azorult",
                "FlawedAmmyy",
                "Mimikatz",
                "Dridex",
                "TrickBot",
                "Get2",
                "FlawedGrace",
                "Cobalt Strike",
                "ServHelper",
                "Amadey",
                "SDBbot",
                "PowerSploit"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "e447d393-c259-46e2-9932-19be2ba67149",
            "created_at": "2022-10-25T16:07:24.28282Z",
            "updated_at": "2025-03-27T02:02:10.159466Z",
            "deleted_at": null,
            "main_name": "TA505",
            "aliases": [
                "ATK 103",
                "Chimborazo",
                "Gold Evergreen",
                "Gold Tahoe",
                "Graceful Spider",
                "Hive0065",
                "Operation Tovar",
                "Operation Trident Breach",
                "SectorJ04",
                "Spandex Tempest",
                "TA505",
                "TEMP.Warlock"
            ],
            "source_name": "ETDA:TA505",
            "tools": [
                "Amadey",
                "AmmyyRAT",
                "AndroMut",
                "Azer",
                "Bart",
                "Bugat v5",
                "CryptFile2",
                "CryptoLocker",
                "CryptoMix",
                "CryptoShield",
                "Dridex",
                "Dudear",
                "EmailStealer",
                "FRIENDSPEAK",
                "Fake Globe",
                "Fareit",
                "FlawedAmmyy",
                "FlawedGrace",
                "FlowerPippi",
                "GOZ",
                "GameOver Zeus",
                "GazGolder",
                "Gelup",
                "Get2",
                "GetandGo",
                "GlobeImposter",
                "Gorhax",
                "GraceWire",
                "Gussdoor",
                "Jaff",
                "Kasidet",
                "Kegotip",
                "Kneber",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "Locky",
                "MINEBRIDGE",
                "MINEBRIDGE RAT",
                "MirrorBlast",
                "Neutrino Bot",
                "Neutrino Exploit Kit",
                "P2P Zeus",
                "Peer-to-Peer Zeus",
                "Philadelphia",
                "Philadephia Ransom",
                "Pony Loader",
                "Rakhni",
                "ReflectiveGnome",
                "Remote Manipulator System",
                "RockLoader",
                "RuRAT",
                "SDBbot",
                "ServHelper",
                "Shifu",
                "Siplog",
                "TeslaGun",
                "TiniMet",
                "TinyMet",
                "Trojan.Zbot",
                "Wsnpoem",
                "Zbot",
                "Zeta",
                "ZeuS",
                "Zeus"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535534,
    "ts_updated_at": 1743041738,
    "ts_creation_date": 1653708557,
    "ts_modification_date": 1653708557,
    "files": {
        "pdf": "https://archive.orkl.eu/d1ea493aa4bd3123caa02cbc26c2b3e7150eba86.pdf",
        "text": "https://archive.orkl.eu/d1ea493aa4bd3123caa02cbc26c2b3e7150eba86.txt",
        "img": "https://archive.orkl.eu/d1ea493aa4bd3123caa02cbc26c2b3e7150eba86.jpg"
    }
}