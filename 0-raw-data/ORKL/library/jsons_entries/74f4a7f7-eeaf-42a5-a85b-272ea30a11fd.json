{
    "id": "74f4a7f7-eeaf-42a5-a85b-272ea30a11fd",
    "created_at": "2022-10-25T16:48:22.442736Z",
    "updated_at": "2025-03-27T02:16:05.776464Z",
    "deleted_at": null,
    "sha1_hash": "7ac406637241a341e0130e3b485f1cc3b8e22a96",
    "title": "Revealing the Attack Operations Targeting Japan",
    "authors": "",
    "file_creation_date": "2015-11-17T18:18:47Z",
    "file_modification_date": "2015-11-17T18:28:32Z",
    "file_size": 3030365,
    "plain_text": "###### CODE BLUE 2015\n\n Revealing the Attack Operations Targeting Japan\n\n JPCERT/CC Analysis Center  Shusei Tomonaga\n\n\n###### Revealing the Attack Operations\n\n\n-----\n\n###### Agenda\n\n １ Introduction\n\n ２ Operation A\n\n ３ Operation B\n\n\n-----\n\n###### Agenda\n\n １ Introduction\n\n ２ Operation A\n\n ３ Operation B\n\n\n-----\n\n###### Self introduction\n\n Shusei Tomonaga\n Yuu Nakamura\n\n Analysis Center at JPCERT Coordination Center  Malware analysis, Forensics investigation\n\n\n-----\n\n###### JPCERT Coordination Center\n\n Japan Computer Emergency Response Team Coordination Center\n\n\n###### Coordination Center\n\n Prevention Monitoring Response\n\n • Vulnerability • Information gathering • Incident handling information handling & analysis & sharing\n\n • NW Traffic Monitoring\n\n Early warning information CSIRT establishment support Industrial control system security International collaboration Artifact (e.g. Malware) analysis\n\n\n###### Prevention\n\n • Vulnerability information handling\n\n\n###### Response\n\n • Incident handling\n\n\n-----\n\n###### Targeted Attacks handled by JPCERT/CC\n\n From April to September 2015\n\n\n###### 130 organizations\n\n\n###### Operation A\n\n\n###### 組織\n organizations\n\n### 93\n\n# 93\n\n###### Operation B\n\n 組織\n organizations\n## 44\n\n\n-----\n\n###### Introducing 2 Types of Attack Operations\n\n\n###### Operation A\n\n\n\n###### • Targeting many Japanese organizations since around 2012.\n • Emdivi\n • CloudyOmega (Symantec)\n • BLUE TERMITE (Kaspersky)\n\n\n###### Operation B\n\n\n\n###### • Targeting some Japanese organizations since around 2013.\n • APT17 (FireEye)\n\n\n-----\n\n###### Agenda\n\n １ Introduction\n\n ２ Operation A\n\n ３ Operation B\n\n\n-----\n\n###### Characteristics of Operation A\n\n Attacker’s Infrastructure（Compromised Web sites）\n\n Japan Overseas\n\n Victim organizations (Public offices, private companies)\n\n Targeted emails Widespread emails Watering hole\n\n\n###### Attacker’s Infrastructure（Compromised Web sites）\n\n Japan Overseas\n\n\n###### Victim organizations (Public offices, private companies)\n\n\n-----\n\n###### Details of Internal Intrusion Techniques\n\n\n#### Initial Compromise\n\n\n#### Collecting Information\n\n\n#### Lateral Movement  \n\n\n-----\n\n###### Details of Internal Intrusion Techniques\n\n\n#### Initial Compromise\n\n\n#### Collecting Information\n\n\n#### Lateral Movement\n\n\n-----\n\n###### Attack Patterns\n\n Timeline of Attack Vector\n\n 2014/05 2014/09 2015/01 2015/05\n\n\n###### Timeline of Attack Vector\n\n\n###### Disguised Icon\n\n\n###### Document File\n**(Exploit**\n**vulnerabilities)**\n\n\n###### Medical expense, Health insurance\n\n\n###### Medical expense, Health insurance\n\n\n###### CVE-2014-7247\n\n\n###### Drive-By Download\n\n|14/05|Col2|2014/09|2015/01|2015/05|2015/09|\n|---|---|---|---|---|---|\n|Medical expense, Health insurance 2014/11 CVE-2014-7247 2015/07 CVE-2015-5119 CVE-2015-5122||dical expense, alth insurance||||\n||Me He|||||\n\n\n###### CVE-2015-5119 CVE-2015-5122\n\n\n###### CVE-2014-7247\n\n\n\n###### • In many attacks, malware are disguised with fake icons, compressed with zip or lzh and attached to emails. Att k i i t i t t l d t d f il\n\n\n-----\n\n###### Details of Internal Intrusion Techniques\n\n\n#### Initial Compromise\n\n\n#### Collecting Information\n\n\n#### Lateral Movement\n\n\n-----\n\n###### Investigation of Compromised Environment\n\n Uses Legitimate tools provided by MS\n\n\n###### Active Directory admin tools sent after the compromise\n\n\n\n###### • csvde\n • dsquery\n\n\n-----\n\n###### Example of Using dsquery\n\n Used in some cases targeting specific individuals\n\n\n-----\n\n###### Collecting Email Account Information\n\n Uses free tools (Similar to NirSoft Mail PassView) Attempts to receive emails from outside May lead to new attack emails (correspondence of emails)   Infection spreading from organization to organization\n\n\n-----\n\n###### Collecting Classified / Personal Information\n\n\n###### Delete Evidence\n\n\n-----\n\n###### Search Network Drive (1)\n\n net use command\n\n > net use New connections will be remembered.\n Status     Local  Remote          Network ------------------------------------------------------------------------------- OK    T: ¥¥FILESV01¥SECRET  Microsoft Windows Network OK    U: ¥¥FILESV02¥SECRET  Microsoft Windows Network\n\n wmic command\n\n > wmic logicaldisk get caption,providername,drivetype,volumename Caption DriveType  ProviderName  VolumeName C:  3 OS D:  3  Volume T:  4 ¥¥FILESV01¥SECRET  Volume U:  4 ¥¥FILESV01¥SECRET  Volume\n\n\n###### DriveType 4\n\n\n-----\n\n###### Search Network Drive (2)\n\n Combination of netstat Command & nbtstat Command\n\n > netstat –an\n TCP 192.168.xx.xx:49217 192.168.yy.yy:445 ESTABLISHED\n > nbtstat -a 192.168.yy.yy\n Port 445 is set as the key\n Name       Type  Status\n to search the access point\n --------------------------------------------- FILESV01 <00> UNIQUE Registered of file sharing service\n\n\n-----\n\n###### Search Targeted Data\n\n dir command\n\n\n\n###### > dir ¥¥FILESV01¥SECRET \n ¥¥FILESV¥SECRET Directory\n 2014/07/11 09:16 [DIR] Management of Partner Companies 2014/09/04 11:49 [DIR] Management of Intellectual Property 2014/08/01 09:27 [DIR] Location information\n\n\n###### Not only searches network drive but also compromised computers\n\n\n\n###### > dir c:¥users¥hoge¥*.doc* /s /o-d\n c:¥users¥hoge¥AppData¥Local¥Temp Directory\n 2014/07/29 10:19 28,672 20140820.doc 1 File 28,672 bytes\n c:¥users¥hoge¥Important Information Directory\n\n\n-----\n\n###### Compress, Download, Delete Evidence \n\n Compressed with RAR\n\n > winrar.exe a –r –ed –v300m –ta20140101 %TEMP%¥a.rar “¥¥FILESV01¥SECRET¥Management of Intellectual Property” -n*.ppt* -n*.doc* - n*.xls* -n*.jtd\n Adding ¥¥FILESV01¥SECRET¥Management of Intellectual Property¥Committee List(2015.05.01).docx OK Adding ¥¥FILESV01¥SECRET¥Management of Intellectual Property¥Framework.ppt OK Adding ¥¥FILESV01¥SECRET¥Management of Intellectual Property¥Application List.xlsx OK Adding ¥¥FILESV01¥SECRET¥Management of Intellectual Property¥Design Document.jtd OK ・ ・\n\n Documents are compressed per folder z\n RAR fil t t C&C d d l t d\n\n\n-----\n\n###### Details of Internal Intrusion Techniques\n\n\n#### Initial Compromise\n\n\n#### Collecting Information\n\n\n#### Lateral Movement\n\n\n-----\n\n###### Methods Used to Spread Infection\n\n\n###### Patterns of spreading infection\n\n\n\n###### • Exploiting vulnerabilities (MS14-068 + MS14-058)\n • Investigating SYSVOL scripts\n • Password list-based attack\n • Exploiting Built-in Administrator password\n • Setting malware in file servers\n • Exploiting WPAD\n • Others\n\n\n-----\n\n###### Exploiting Vulnerabilities (MS14 068 + MS14 058) \n\n 1. Escalate privilege (MS14-058) and dump user’s password with mimikatz\n\n 2. Exploit MS14-068 vulnerability and gain Domain Admin privileges\n\n PC-A Domain\n 3. Upload mimikatz to DC and dump\n Controller\n admin’s passwords\n\n\n###### 5. Register a task in order to execute malware\n\n\n###### PC B\n\n\n-----\n\n###### Investigating SYSVOL Scripts\n\n\n\n###### • In some cases, passwords are found in logon script, etc.\n\n\n###### Key Point\n\n\n###### Attacker’s Infrastructure\n\n 3. Search admin’s password\n\n 2.\n\n C2 Server\n\n\n###### Domain\n 1. Download logon script,\n Controller\n compress and archive\n\n 6. Malware executes according to the task\n\n 4. Copy malware to PC-B\n\n 5. Register a task in order\n PC-B PC-A\n to execute malware\n\n\n-----\n\n###### Password List based Attack\n\n\n\n###### • Attempts logon by using an approximately 10-30 line password list and the user’s list of Domain Admins\n • Uses a tool called logon.exe (self-built?) \n\n\n###### Key Point\n\n\n###### 4. Register a task PC-B PC A\n\n\n-----\n\n###### Exploiting Built in Administrator Password\n\n\n\n###### • An effective measure when there is no way to exploit Domain environment\n • Need to hash passwords or dump passwords\n\n\n###### Key Point\n\n\n###### PC-B PC-A 2. Pass the hash or net use\n\n net use ¥¥PC-B¥IPC$ [password] /u:Administrator\n\n\n-----\n\n###### Setting Malware in File Servers\n\n\n\n###### • Effective when there is no other measure \n\n\n###### Key Point\n\n\n-----\n\n###### Exploiting WPAD\n\n WPAD (Web Proxy Auto-Discovery) \n — Turned on by default — Get automatic configuration script from either  URL specified by DHCP server, or  http://wpad/wpad.dat\n\n\n-----\n\n###### Exploiting WPAD (Step 1: NetBIOS Spoofing)\n\n\n###### Key Point\n\n\n\n###### • Effective in an environment where WPAD is not configured\n • NetBIOS Spoofing\n\n\n###### PC-B PC-A\n\n\n-----\n\n###### Exploiting WPAD (Step 2: Fake WPAD Server)\n\n\n###### PC-B PC-A\n\n\n-----\n\n###### Proxy)\n\n\n###### Attacker’s\n\n\n###### PC-B PC-A\n\n\n-----\n\n###### Summary: Methods of Spreading Infection\n\n|Method|AD|Privilege Escalation|Note|\n|---|---|---|---|\n|MS14-068|Necessary|Unnecessary / Necessary for password dump|Risk exists when DC is unpatched|\n|SYSVOL Search|Necessary|Unnecessary||\n|Brute Force Attack (Password List Attack)|Necessary|Unnecessary|Risk exists when the password is weak|\n|Abusing Built-in Administrator|Unnecessary|Necessary|Presumes that the password is the same|\n|Exploiting File Servers|Unnecessary|Unnecessary|Risk exists when the file is disguised to one that many users open|\n|Exploiting WPAD|Unnecessary|Unnecessary|Situations are limited|\n\n\n-----\n\n###### DETAILS OF TOOLS AND MALWARE\n\n\n-----\n\n###### Characteristics of Malware\n\n Different types of malware reside depending on the phase and scale of damage of the attack\n File Form of attack Malware Overview format\n\n Emdivi (t17) HTTP BOT EXE Intrude Tools Password dump, etc. EXE, etc.\n\n Download (low DLL,\n usp10jpg frequency\n data\n communication)\n HTTP BOT (highly Lateral Movement\n Emdivi (t19,\n sophisticated than EXE\n t20)\n t17)\n\n BeginX Remote shell tool EXE\n\n HTTP BOT (low- GStatus frequency EXE,DLL Conceal? communication)\n\n|Malware|Overview|File format|Form of attack|\n|---|---|---|---|\n|Emdivi (t17)|HTTP BOT|EXE|Intrude|\n|Tools|Password dump, etc.|EXE, etc.||\n|usp10jpg|Download (low- frequency communication)|DLL, data|Lateral Movement|\n|Emdivi (t19, t20)|HTTP BOT (highly sophisticated than t17)|EXE||\n|BeginX|Remote shell tool|EXE||\n\n\n###### Different types of malware reside depending on the\n\n\n-----\n\n|Tools|Col2|Col3|\n|---|---|---|\n|Type|Overview|Filename|\n|Password dump Pass-the-hash|Quarks PwDump|qp.exe, qd.exe, QDump.exe, etc.|\n||MimikatzLite|gp.exe|\n||Windows credentials Editor|wce.exe, ww.exe|\n||Mimikatz|mz.exe, mimikatz.exe, mimikatz.rar (sekurlsa.dll)|\n|Vulnerability exploitation|MS14-068 (CVE-2014-6324)|ms14-068.exe ms14-068.tar.gz|\n||MS14-058 (Privilege escalation) (CVE-2014-4113)|4113.exe|\n|UAC bypass|UAC bypass tool|msdart.exe, puac.exe, etc.|\n|Packet transmit|Htran, proxy adaptive Htran|htproxy.exe, etc.|\n|Mail account theft|Similar to NirSoft Mail PassView|CallMail.exe, outl.exe, etc.|\n||Attempt logon based on list|logon.exe|\n||WinRAR archiver|yrar.exe, rar,exe, etc.|\n\n\n###### Type Overview Filename\n\n\n###### Utility\n\n\n###### Highly sophisticated dir command dirasd.exe, etc.\n\n\n-----\n\n###### Emdivi (t17)\n\n HTTP BOT with basic functions\n Repeatedly upgraded the version in the past year and implemented new commands Command Date of Implementation\n\n|Command|Date of Implementation|\n|---|---|\n|DOABORT||\n|DOWNBG||\n|GETFILE||\n|LOADDLL||\n|SETCMD||\n|SUSPEND||\n|UPLOAD||\n|VERSION||\n|GOTO|May 2015|\n\n\n-----\n\n###### Emdivi (t20)\n\n Highly Sophisticated Emdivi\n\n The number of implemented commands have increased and decreased in the past year.\n — 18-41 (based on JPCERT/CC’s study)\n\n In some cases, the targeted organization’s proxy server address is hard-coded.\n\n May only run on specific computers (encryption of data by computer SID)\n\n\n-----\n\n###### p jpg\n\n Download (low-frequency communication)\n\n Communication performed once a day Able to specify the day of week of communication Tend to be set to computers that are not infected with Emdivi (secondary infection) DLL Preloading Attack\n\n\n###### dwmapi.dll, etc. ***.DAT Application\n\n\n-----\n\n###### Difficulty to detect Usp10jpg\n\n Computer Easy to detect due to Attacker’s\n high-frequency\n Infected Infrastructure\n communication\n with Emdivi\n\n May be left undetected due to usp10jpg low-frequency communication\n\n\n###### Easy to detect due to\n\n\n-----\n\n###### BeginX\n\n Remote Shell Tool\n\n BeginX Server \n — Listens to specific ports and waits for commands — Both UDP and TCP versions available\n\n BeginX Client\n — Client which sends commands to BeginX Server — Controlled via Emdivi\n\n\n-----\n\n###### Image of Using BeginX\n\n Segment Attacker’s (unable to Infrastructure connect to\n Unable to control by\n Internet)\n Emdivi infection\n\n BeginX BeginX Server Client Emdivi\n\n Able to control via BeginX\n\n Computer Infected ith E di i\n\n\n-----\n\n###### GStatus\n\n HTTP BOT different from Emdivi\n Not found in many organizations, but...\n\n Bot Function\n — Get drive information — Execute arbitrary shell command — Process list — Screen related functions\n\n\n-----\n\n###### GStatus Web Panel (Admin Screen)\n\n\n-----\n\n###### ANALYSIS TOOLS emdivi_string_decryptor.py\n\n\n-----\n\n###### emdivi_string_decryptor.py\n\n\n###### emdivi_string_decryptor.py\n\n\n\n###### • IDAPython\n • Used to analyze Emdivi\n • Decode encoded strings\n\n\n###### Supported version\n\n\n\n###### • t17, 19, 20\n\n\n-----\n\n###### emdivi_string_decryptor.py\n\n Emdivi encoded strings\n\n\n-----\n\n###### emdivi_string_decryptor.py\n\n Difference depending on version string\n\n|Col1|Ver 17|Ver 19 or 20|Ver 20|\n|---|---|---|---|\n|Encrypt|XxTEA encrypt|XxTEA decrypt|AES decrypt|\n|Decrypt|XxTEA decrypt|XxTEA encrypt|AES encrypt|\n\n\n###### Scanf(   \"%x\",   Inc_Add(     ver17_key   ) )\n\n\n###### Key\n\n\n###### MD5(   MD5(base64(ver))   +   MD5(key_string) )\n\n\n###### Inc_Add(   ver17_key )\n\n\n-----\n\n###### emdivi_string_decryptor.py\n\n\n-----\n\n###### emdivi_string_decryptor.py\n\n\n-----\n\n###### DEMO\n\n\n-----\n\n###### Agenda\n\n １ Introduction\n\n ２ Operation A\n\n ３ Operation B\n\n\n-----\n\n###### Attack Techniques\n\n\n##### Drive-by Download Attack\n\n\n##### Update Hijacking\n\n\n##### Domain Name Hijacking\n\n\n-----\n\n###### Attack Techniques\n\n\n##### Drive-by Download Attack\n\n\n##### Update Hijacking\n\n\n##### Domain Name Hijacking\n\n\n-----\n\n###### Drive by Download (Watering Hole) Attack\n\n Targeted Organization\n 0. Deface Web site\n\n 1. Access to Web site\n\n ２. Redirect\n\n ４. Malware ３. Download malware Infection\n\n\n-----\n\n###### Access Control\n\n\n###### Target name\n\n\n-----\n\n###### 0 day Exploits\n\n\n###### CVE-2014-0324 (MS14-012)\n\n\n\n###### • Detected around February 2014\n • Vulnerability in Internet Explorer\n\n\n-----\n\n###### Attack Techniques\n\n\n##### Drive-by Download Attack\n\n\n##### Update Hijacking\n\n\n##### Domain Name Hijacking\n\n\n-----\n\n###### Update Hijacking\n\n Method used to alter updated information\n Targeted\n 0. Alter updated information\n Organization\n\n 1. Request to update\n\n ２. Fake update Information\n\n ３. Request to download\n\n ５. Malware ４. Download malware Infection\n\n\n###### Fake Update Server\n\n\n-----\n\n###### Another Update Hijacking Pattern\n\n Method used without changing update server's file\n\n Targeted Update Organization Server\n\n\n-----\n\n###### Another Update Hijacking Pattern\n\n Method used without changing update server's file\n\n TCP 80 is forwarded by iptables.\n\n\n###### iptables -t nat -A PREROUTING -i eth0 -s aa.bb.cc.dd -p tcp --dport 80 -j DNAT --to-destination ww.xx.yy.zz:53\n\n\n###### Key Point\n\n\n\n###### • Update server's file is unchanged\n • Does not save iptables\n • Targeted organization sees as if it is communicating with legitimate update server\n\n\n-----\n\n###### Attack Techniques\n\n\n##### Drive-by Download Attack\n\n\n##### Update Hijacking\n\n\n##### Domain Name Hijacking\n\n\n-----\n\n###### Domain Name Hijacking\n\n 0. Change registration information\n\n\n###### 0. Change registration information\n\n\n###### Legitimate Server\n\n\n###### Attacker’s Infrastructure\n\n\n###### DNS Server\n\n Web Server\n\n\n###### 1.DNS query\n Targeted Organization\n\n\n###### 2.DNS query\n\n\n###### DNS Server\n\n Web Server\n\n\n-----\n\n###### DETAILS OF MALWARE\n\n\n-----\n\n###### Routing of only specific DNS queries by using iptables\n\n\n###### iptables -t nat -A PREROUTING -p udp --dport 53 -m string --from 30 --to 34 --hex-string \"|03|AAA\" --algo bm -j DNAT -- to-destination aa.bb.cc.dd:54\n\n iptables -t nat -A PREROUTING -p udp --dport 53 -j DNAT - -to ww.xx.yy.zz:53\n\n\n###### AAA.example.com\n\n • Routing of only specific sub domains\n • Other DNS queries are routed to the legitimate DNS server\n\n\n###### Key Point\n\n\n-----\n\n###### Characteristics of Malware\n\n ① Uses a different malware before and after the intrusion\n ② Some malware run in memory only\n\n ③ Embedding target organization's internal\n information\n ④ Uses code signing certificate in some cases\n\n\n-----\n\n###### Characteristics of Malware\n\n\n###### Intrusion\n\n Concealing\n\n\n###### BlackCoffee McRAT Preshin Agtid\n\n Hikit Derusbi PlugX\n\n\n-----\n\n###### Malware (Intrusion)\n\n BlackCoffee McRAT Preshin Agtid\n\n HTTP bot with basic functions\n\n Command List\n\n command info command info 0x184004 Execute remote shell 0x184024 0x184008 Run remote shell command 0x184028 0x18400c Create file 0x18402c 0x184010 Load file 0x184030 0x184014 Get drive information 0x184034 0x184018 Create directory 0x184038 0x18401c Search file 0x18403c 0x184020 Delete file\n\n|command|info|\n|---|---|\n|0x184004|Execute remote shell|\n|0x184008|Run remote shell command|\n|0x18400c|Create file|\n|0x184010|Load file|\n|0x184014|Get drive information|\n|0x184018|Create directory|\n|0x18401c|Search file|\n|0x184020|Delete file|\n\n|command|info|\n|---|---|\n|0x184024|Move file|\n|0x184028|Process list|\n|0x18402c|Terminate process|\n|0x184030|Sleep|\n|0x184034|Install command|\n|0x184038|Set Sleep Time|\n|0x18403c|Terminate|\n|||\n\n\n-----\n\n###### IP Address Acquisition Algorithm\n\n Get C2 IP address from Web page\n\n\n###### start: lOve yOu 4 eveR end: Reve 4 uOy evOl\n\n\n###### Decode\n\n\n-----\n\n###### Malware (Intrusion)\n\n BlackCoffee McRAT Preshin Agtid\n\n Plug-in-based malware\n\n Command list\n command number info 0 Send data to server 1 Set TickCount 3 Plug-in registration 4 Allocate Plug-in settings area 5 Set Plug-in settings area 6 Create/Execute plug-in 7 Terminate plug-in 8 Create configuration file 9\n\n|Command list|Col2|\n|---|---|\n|command number|info|\n|0|Send data to server|\n|1|Set TickCount|\n|3|Plug-in registration|\n|4|Allocate Plug-in settings area|\n|5|Set Plug-in settings area|\n|6|Create/Execute plug-in|\n|7|Terminate plug-in|\n|8|Create configuration file|\n\n\n-----\n\n###### Malware Running in Memory Only\n\n CVE-2013-3918 with McRAT\n\n\n###### ROP\n\n Shellcode\n skip\n\n\n-----\n\n###### Malware Running in Memory Only\n\n CVE-2013-3918 with McRAT\n\n Executes rundll32.exe and injects code\n McRAT's data below Shellcode is injected\n Not saved as a file\n\n\n-----\n\n###### Malware (Intrusion)\n\n BlackCoffee McRAT Preshin Agtid\n\n Simple HTTP bot with limited functions\n\n Command list\n\n|ommand list|Col2|\n|---|---|\n|command|info|\n|downonly|Download file|\n|downexec|Download and Execute file|\n|-|Run remote shell command|\n\n\n-----\n\n###### Preshin Controller\n\n PHP-based Controller\n\n\n-----\n\n###### Preshin Controller\n\n Example of command execution\n\n\n-----\n\n###### Malware (Intrusion)\n\n BlackCoffee McRAT Preshin Agtid\n\n HTTP bot with basic functions\n\n Command list\n\n|command|info|\n|---|---|\n|1|Get disk information|\n|2|File list|\n|3|Open file|\n|4|Upload file|\n|5|Create file|\n|7|Load file|\n\n|command|info|\n|---|---|\n|8|-|\n|9|Delete file|\n|10|Delete file/folder|\n|11|Upload file|\n|12|Create folder|\n|13|Move file|\n\n\n-----\n\n###### Malware (Concealing)\n\n Hikit Derusbi PlugX\n\n Malware with Rootkit functions\n\n Command list\n\n command info\n file File related operation  information Send configuration information\n\n proxy Enable Proxy settings\n\n connect Connect to Hikit proxy\n\n shell Run remote shell command\n\n socks5 Enable Proxy settings (socks5)\n\n exit Terminate\n\n|command|info|\n|---|---|\n|file|File related operation|\n|information|Send configuration information|\n|proxy|Enable Proxy settings|\n|connect|Connect to Hikit proxy|\n|shell|Run remote shell command|\n|socks5|Enable Proxy settings (socks5)|\n\n\n-----\n\n###### Hikit Configuration Information\n\n Hikit has proxy information of the internal network\n\n\n###### ID Target name\n\n Proxy info\n\n Rootkit setting\n\n\n-----\n\n###### Malware (Concealing)\n\n Hikit Derusbi PlugX\n\n Malware recently often used\n\n Command list\n\n command info\n Service/Process related  cmd4 operation  cmd5 Run remote shell command\n\n cmd6 Connect to Derusbi proxy\n\n cmd7 File operation\n\n cmd8 Terminate\n\n cmd9 Create/Delete file\n\n|Command|list|\n|---|---|\n|command|info|\n|cmd4|Service/Process related operation|\n|cmd5|Run remote shell command|\n|cmd6|Connect to Derusbi proxy|\n|cmd7|File operation|\n|cmd8|Terminate|\n\n\n-----\n\n###### Derusbi Configuration Information\n\n Derusbi has proxy information of the internal network\n\n\n###### ID\n\n Proxy info\n\n\n-----\n\n###### Code Signing Certificate\n\n\n-----\n\n###### Infrastructure Used by Attackers\n\n\n-----\n\n###### Linux Backdoor\n\n\n\n###### • apache module\n • Runs a remote shell by sending a keyword\n\n\n###### mod_rootme\n\n\n###### mod_rootme source\n\n\n###### Keyword “Roronoa”\n\n\n-----\n\n###### Linux Backdoor\n\n\n\n###### • Highly sophisticated Linux bot\n\n\n###### rs_linux\n\n\n-----\n\n###### ANALYSIS TOOLS apt17scan.py\n\n\n-----\n\n###### apt17scan.py\n\n\n###### apt17scan.py\n\n\n\n###### • Volatility Plugin\n • Detect malware in memory dump\n • Extract malware configuration information\n\n\n###### Function\n\n\n\n###### • apt17scan\n • derusbiconfig\n • hikitconfig\n • agtidconfig\n\n\n-----\n\n###### apt17scan.py\n\n Scan with YARA\n\n Search configuration data address\n\n Parse configuration data\n\n\n###### Dump configuration\n\n\n-----\n\n###### apt17scan.py\n\n apt17scan Detecting Malware\n\n Agtid Hikit McRAT\n\n\n###### Agtid\n\n\n###### Preshin\n\n\n###### McRAT\n\n\n###### BlackCoffee\n\n\n-----\n\n###### apt17scan.py\n\n derusbiconfig Dump configuration information for Derusbi\n\n\n-----\n\n###### apt17scan.py\n\n hikitconfig Dump configuration information for Hikit\n\n\n-----\n\n###### apt17scan.py\n\n agtidconfig Dump configuration information for Agtid\n\n\n-----\n\n###### DEMO\n\n\n-----\n\n###### How to Download\n\n https://github.com/JPCERTCC\n\n\n-----\n\n###### Thank You!\n\n Contact\n aa-info@jpcert.or.jp https://www.jpcert.or.jp\n Incident Report\n info@jpcert.or.jp https://www.jpcert.or.jp/form/\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        }
    ],
    "references": [
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2015/2015.11.19.decrypting-strings-in-emdivi/20151028_codeblue_apt-en.pdf"
    ],
    "report_names": [
        "20151028_codeblue_apt-en"
    ],
    "threat_actors": [
        {
            "id": "c92de6de-9538-43e5-9190-9da092194884",
            "created_at": "2022-10-25T16:07:23.411024Z",
            "updated_at": "2025-03-27T02:02:09.785868Z",
            "deleted_at": null,
            "main_name": "Blue Termite",
            "aliases": [
                "Blue Termite",
                "Cloudy Omega"
            ],
            "source_name": "ETDA:Blue Termite",
            "tools": [
                "Emdivi",
                "Newsripper"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "2150d1ac-edf0-46d4-a78a-a8899e45b2b5",
            "created_at": "2022-10-25T15:50:23.269339Z",
            "updated_at": "2025-03-27T02:00:55.416524Z",
            "deleted_at": null,
            "main_name": "APT17",
            "aliases": [
                "APT17",
                "Deputy Dog"
            ],
            "source_name": "MITRE:APT17",
            "tools": [
                "BLACKCOFFEE"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "d90307b6-14a9-4d0b-9156-89e453d6eb13",
            "created_at": "2022-10-25T16:07:23.773944Z",
            "updated_at": "2025-03-27T02:02:09.974695Z",
            "deleted_at": null,
            "main_name": "Lead",
            "aliases": [
                "Casper",
                "TG-3279"
            ],
            "source_name": "ETDA:Lead",
            "tools": [
                "Agentemis",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "RbDoor",
                "RibDoor",
                "Winnti",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "f8dddd06-da24-4184-9e24-4c22bdd1cbbf",
            "created_at": "2023-01-06T13:46:38.626906Z",
            "updated_at": "2025-03-27T02:00:02.877001Z",
            "deleted_at": null,
            "main_name": "Tick",
            "aliases": [
                "Stalker Taurus",
                "PLA Unit 61419",
                "Nian",
                "BRONZE BUTLER",
                "REDBALDKNIGHT",
                "STALKER PANDA",
                "G0060"
            ],
            "source_name": "MISPGALAXY:Tick",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "48782737-377b-47b4-aff0-87424208a643",
            "created_at": "2023-01-06T13:46:38.569144Z",
            "updated_at": "2025-03-27T02:00:02.863397Z",
            "deleted_at": null,
            "main_name": "Blue Termite",
            "aliases": [
                "Cloudy Omega",
                "Emdivi"
            ],
            "source_name": "MISPGALAXY:Blue Termite",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "a7aefdda-98f1-4790-a32d-14cc99de2d60",
            "created_at": "2023-01-06T13:46:38.281844Z",
            "updated_at": "2025-03-27T02:00:02.792526Z",
            "deleted_at": null,
            "main_name": "APT17",
            "aliases": [
                "G0025",
                "AURORA PANDA",
                "Group 72",
                "G0001",
                "HELIUM",
                "Group 8",
                "Hidden Lynx",
                "Tailgater Team",
                "BRONZE KEYSTONE"
            ],
            "source_name": "MISPGALAXY:APT17",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "d4e7cd9a-2290-4f89-a645-85b9a46d004b",
            "created_at": "2022-10-25T16:07:23.419513Z",
            "updated_at": "2025-03-27T02:02:09.790389Z",
            "deleted_at": null,
            "main_name": "Bronze Butler",
            "aliases": [
                "Bronze Butler",
                "CTG-2006",
                "Operation ENDTRADE",
                "RedBaldNight",
                "Stalker Panda",
                "Stalker Taurus",
                "TEMP.Tick",
                "Tick"
            ],
            "source_name": "ETDA:Bronze Butler",
            "tools": [
                "8.t Dropper",
                "8.t RTF exploit builder",
                "8t_dropper",
                "9002 RAT",
                "AngryRebel",
                "Blogspot",
                "Daserf",
                "Datper",
                "Elirks",
                "Farfli",
                "Gh0st RAT",
                "Ghost RAT",
                "HOMEUNIX",
                "HidraQ",
                "HomamDownloader",
                "Homux",
                "Hydraq",
                "Lilith",
                "Lilith RAT",
                "McRAT",
                "MdmBot",
                "Mimikatz",
                "Minzen",
                "Moudour",
                "Muirim",
                "Mydoor",
                "Nioupale",
                "PCRat",
                "POISONPLUG.SHADOW",
                "Roarur",
                "RoyalRoad",
                "ShadowPad Winnti",
                "ShadowWali",
                "ShadowWalker",
                "SymonLoader",
                "WCE",
                "Wali",
                "Windows Credential Editor",
                "Windows Credentials Editor",
                "XShellGhost",
                "XXMM",
                "gsecdump",
                "rarstar"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "bf0489c5-1c07-41e6-91c9-855ad96ccc6a",
            "created_at": "2022-10-25T16:47:55.541639Z",
            "updated_at": "2025-03-27T02:05:17.253496Z",
            "deleted_at": null,
            "main_name": "BRONZE BUTLER",
            "aliases": [
                "Daserf",
                "Stalker Panda ",
                "Tick ",
                "CTG-2006 "
            ],
            "source_name": "Secureworks:BRONZE BUTLER",
            "tools": [
                " DGet",
                " Daserf",
                " Datper",
                " Gofarer",
                " MSGet",
                " Mimikatz",
                " RarStar",
                " Screen Capture Tool",
                " ShadowPad",
                " T-SMB",
                " WinRAR",
                " Windows Credential Editor",
                " gsecdump",
                " xmm downloader",
                " xxmm",
                "ABK"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "1edcac0b-efd9-47b1-9aca-33827d5bd085",
            "created_at": "2024-05-01T02:03:07.964773Z",
            "updated_at": "2025-03-27T02:05:17.273595Z",
            "deleted_at": null,
            "main_name": "BRONZE KEYSTONE",
            "aliases": [
                "Aurora Panda ",
                "DeputyDog ",
                "Group 72 ",
                "Hidden Lynx ",
                "Shell Crew",
                "TG-8153 ",
                "Tailgater Team",
                "APT17 "
            ],
            "source_name": "Secureworks:BRONZE KEYSTONE",
            "tools": [
                " BlackCoffee",
                " DeputyDog",
                " Derusbi",
                " Gh0stHTTPSDropper",
                " HiKit",
                " InternalCMD",
                " PlugX",
                " PoisonIvy",
                " ZxShell",
                "9002"
            ],
            "source_id": "Secureworks",
            "reports": null
        }
    ],
    "ts_created_at": 1666716502,
    "ts_updated_at": 1743041765,
    "ts_creation_date": 1447784327,
    "ts_modification_date": 1447784912,
    "files": {
        "pdf": "https://archive.orkl.eu/7ac406637241a341e0130e3b485f1cc3b8e22a96.pdf",
        "text": "https://archive.orkl.eu/7ac406637241a341e0130e3b485f1cc3b8e22a96.txt",
        "img": "https://archive.orkl.eu/7ac406637241a341e0130e3b485f1cc3b8e22a96.jpg"
    }
}