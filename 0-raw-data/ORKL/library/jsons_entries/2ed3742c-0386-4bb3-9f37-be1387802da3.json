{
    "id": "2ed3742c-0386-4bb3-9f37-be1387802da3",
    "created_at": "2022-10-25T16:48:23.111414Z",
    "updated_at": "2025-03-27T02:09:15.373071Z",
    "deleted_at": null,
    "sha1_hash": "a77cbdde77e4f422afa752f5300c4c61227a9713",
    "title": "",
    "authors": "",
    "file_creation_date": "2020-09-28T04:26:57Z",
    "file_modification_date": "2020-09-28T04:26:57Z",
    "file_size": 1028491,
    "plain_text": "# APT-C-43 steals Venezuelan military secrets to provide intelligence support for the reactionaries — HpReact campaign\n\n**blog.360totalsecurity.com/en/apt-c-43-steals-venezuelan-military-secrets-to-provide-intelligence-support-for-the-**\nreactionaries-hpreact-campaign\n\nSeptember 25, 2020\n\n[Learn more about 360 Total Security](https://www.360totalsecurity.com/en/)\nIn June 2020, 360 Security Center discovered a new backdoor Pyark written in Python by\nthe fileless attack protection function. Through in-depth excavation and trace analysis of\nthe backdoor, we discovered a series of advanced threat actions that have been active\nsince 2019. By invading various military institutions in Venezuela, the attackers deployed\nbackdoor to continuously monitor and steal the latest military secrets. We named it APTC-43 based on 360’s way of naming the APT organization\n\nWhen tracing the attacker’s source, we found that the duration of this attack coincided\nwith the Venezuelan political chaos, and the network assets used by the attackers were\nmostly deployed in Colombia, and some assets were frequently found in Venezuela and\nColombia. After the United Venezuelan coup, the reactionary government headed by Juan\nGerardo Guaidó Márquez fled to Colombia to seek military assistance. We guess the\npolitical background of APT-C -43’s campaign may be to help the reactionaries led by\nJuan steal military secrets of the Venezuelan military and provide intelligence support for\nthe confrontation between the reactionary government and the current Venezuelan\ngovernment. Therefore, we named this series of attacks HpReact.\n\nIn the process of tracing the source, the campaign was linked to the APT group Machete,\nand Machete can be traced back to 2010. The organization is an APT organization with\nSpanish roots. Its targets are military, embassies and government agencies in Latin\nAmerica. the Lord. Obviously, the HpReact campaign is only a small part of the\norganization’s cyber warfare in Latin America.\n\nThe picture below shows the decoy document used by APT-C-43 in this campaign. The\ncontent of the document is a policy issued by the Venezuelan authorities to prevent\ndeserters from going to Colombia to support the reactionary government. More about this\npolicy. For details, please refer to Appendix 1. It can be seen that the attackers have a\ngood understanding of Venezuela’s current politics, military, etc., and are good at using\nsuch sensitive files to make decoy documents, which are highly targeted and inductive.\n\n\n-----\n\n## Technical Details\n\nThe APT-C-43 organization is good at launching attacks using phishing emails, and\ndeploys the backdoor program Pyark (Machete) written in python after invading the\nvictim’s machine. The network communication mainly relies on FTP and HTTP protocols.\n\n\n-----\n\nAfter successfully infiltrating the target machine, APT-C-43 organization monitors the\ntarget users, steal sensitive data, etc. The complete process of infecting the target machine\nis as follows:\n\n### The infection process\n\nThe decoy document carries malicious macrocode. Download the next stage of malicious\ncomponent NisSrv.bat through FTP protocol, and we can see many variables named after\nSpanish vocabulary in the code, such as servidor (server), Usuario (user name),\nContraseña (password), etc.:\n\nNisSrv.bat downloads malicious components:\n\n\n-----\n\nThe file of “setupXOX.msi” is a Windows Installer installation program made by MSI\nWrapper to deploy the final backdoor components. When we studied the historical\nsamples of the Machete organization, we found that the organization’s technology for\ndeploying backdoor has undergone an important change, with a clear time division.\nThrough the following timeline, we can clearly see that the organization is constantly\nchanging and innovating its own Attack technique:\n\nMany fields in the installation program are forged into Acrobat Reader installation\nprogram, and the interface after running is related to Acrobat Reader:\n\n\n-----\n\nAfter the program runs, the Fpyark backdoor components will be released to the\n%ProgramData%\\USOEnable directory. The backdoor of Fpyark is writing by python.\nDuring the running process, python is required to execute the environment and various\ndependent libraries required by the script, which also caused the size of setupXOX.msi to\nreach 8.10M. After installation, the entire directory structure is as follows:\n\n\n-----\n\nAfter deploying the above backdoor components, run svchostt.exe according to the\nmsiwpper configuration file:\n\nThe file of “setupXOX.msi” is a virus releaser written in Microsoft Visual Basic language,\nwhich releases NisSrv.bat registered scheduled tasks to realize self-starting and staying.\nThe program has the following vbp compilation path:\n\n@*\\AC:\\Users\\MITM\\Desktop\\malware\\3_svchostt\\Proyecto1.vbp\n\nThe relevant code is as follows:\n\n\n-----\n\n### Backdoor module\n\nUpdateSession is the main control module of the backdoor. Its functions include selfstarting of the backdoor, collection of network configuration, keystroke records, and\nschedule other modules to execute by means of timers:\n\nUpdateService traverses the disk directory and collects more than ten kinds of sensitive\nfiles with suffixes such as doc, xlsx, and pdf in other directories, except for some system\ndirectories and security software directories.\n\nUpdateDevice takes screenshot\n\n\n-----\n\nCapture camera screen:\n\nUpdatePlugin takes audio from the microphone:\n\nNotification is responsible for uploading the sensitive data collected by the above modules\nto the FTP server:\n\n\n-----\n\nThe interactive traffic characteristics are as follows:\n\n\n-----\n\nWhen analyzing the uploaded FTP server, we found that APT-C-43 manages the uploaded\nsensitive files through Tiny File Manager:\n\n\n-----\n\n## Summary\n\nThe entire campaign of HpReact highly coincides with the timeline of Venezuelan\npolitical turmoil. APT-C-43 took Venezuelan military agencies as the main targets and\ncarried out surveillance and stealing activities for about two years, forming a significant\nimpact on Venezuela’s national security. Great safety hazard. In recent years, with the\nintensification of cyber warfare in various countries, cyberspace security has become\nanother important area for each country to maintain national security, and building a\nstrong cybersecurity has become a top priority for each country.\n\nAt present, 360 Total Security has supported the detection of attacks on this organization.\n\n## Team Introduction\n\n360 Baize Lab (formerly 360 FirstAid team): Focusing on BOOTKIT/ROOTKIT Trojan\nanalysis and traceability, it was the first to discover the world’s first UEFI Trojan Spy\nShadow（UEFI⽊马谍影），boot area Trojan Hidden Soul（引导区⽊马隐魂），dual\nguns（双枪,）and multiple large-scale dark brush botnets, such as black fog and diaster.\nNow it is renamed 360 Baize Lab based on the original business, it is involved in APT\ntesting and research. The laboratory provides core safety data for 360 Security Guards,\n360 FirstAid team and other products, as well as stubborn Trojan detection and killing\nsolutions, while providing 360 Security Center Technical Support.\n\n## Appendix 1\n\nhttps://www.totalnewsagency.com/internacionales/ante-la-alarmante-desercion-elministro-de-defensa-de-venezuela-ordeno-convencer-a-los-soldados-de-regresar-comosea\n\n## Appendix 2\n\nhttps[:]//securelist.com/el-machete/66108\n\nhttps[:]//www.welivesecurity.com/wp-content/uploads/2019/08/ESET_Machete.pdf\n\n## Appendix 3\n\nMD5:\n\nfbe5b66db57fb52b231c5374ac2ac805\n\n6b33fa0c52ca413d4214dcde007f89c1\n\nf85489c1d1ff3374f92ccb7267032016\n\nIP:\n\n\n-----\n\n92.249.44.53\n\n185.70.105.33\n\n[Learn more about 360 Total Security](https://www.360totalsecurity.com/en/)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        }
    ],
    "references": [
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2020/2020.09.25.APT-C-43_HpReact_campaign/apt-c-43-steals-venezuelan-military-secrets-to-provide-intelligence-support-for-the-reactionaries-hpreact-campaign.pdf"
    ],
    "report_names": [
        "apt-c-43-steals-venezuelan-military-secrets-to-provide-intelligence-support-for-the-reactionaries-hpreact-campaign"
    ],
    "threat_actors": [
        {
            "id": "d303c77e-0110-471b-a3a6-37fce9ac848d",
            "created_at": "2022-10-25T15:50:23.342452Z",
            "updated_at": "2025-03-27T02:00:55.447692Z",
            "deleted_at": null,
            "main_name": "Machete",
            "aliases": [
                "APT-C-43",
                "El Machete"
            ],
            "source_name": "MITRE:Machete",
            "tools": null,
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "edc11896-f4f1-4132-9c38-d073ccdcf5b6",
            "created_at": "2022-10-25T16:07:23.576476Z",
            "updated_at": "2025-03-27T02:02:09.873658Z",
            "deleted_at": null,
            "main_name": "El Machete",
            "aliases": [
                "APT-C-43",
                "ATK 97",
                "Operation HpReact",
                "TAG-NS1",
                "TEMP.Andromeda"
            ],
            "source_name": "ETDA:El Machete",
            "tools": [
                "El Machete",
                "ForeIT",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "Loki",
                "Loki.Rat",
                "LokiBot",
                "LokiPWS",
                "Pyark"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "ba4f277c-c3da-45e6-a2fb-4ed556dbae64",
            "created_at": "2023-01-06T13:46:38.605117Z",
            "updated_at": "2025-03-27T02:00:02.871423Z",
            "deleted_at": null,
            "main_name": "El Machete",
            "aliases": [
                "APT-C-43",
                "G0095",
                "machete-apt"
            ],
            "source_name": "MISPGALAXY:El Machete",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1666716503,
    "ts_updated_at": 1743041355,
    "ts_creation_date": 1601267217,
    "ts_modification_date": 1601267217,
    "files": {
        "pdf": "https://archive.orkl.eu/a77cbdde77e4f422afa752f5300c4c61227a9713.pdf",
        "text": "https://archive.orkl.eu/a77cbdde77e4f422afa752f5300c4c61227a9713.txt",
        "img": "https://archive.orkl.eu/a77cbdde77e4f422afa752f5300c4c61227a9713.jpg"
    }
}