{
    "id": "96640997-7795-4f30-bebb-c89120cf95e9",
    "created_at": "2023-01-12T15:01:58.124502Z",
    "updated_at": "2025-03-27T02:06:11.748583Z",
    "deleted_at": null,
    "sha1_hash": "325756c7530968a8882ff25e53573b75f02109c3",
    "title": "2018-09-10 - A Closer Look at the Locky Poser, PyLocky Ransomware",
    "authors": "",
    "file_creation_date": "2022-05-28T03:49:00Z",
    "file_modification_date": "2022-05-28T03:49:00Z",
    "file_size": 239676,
    "plain_text": "# A Closer Look at the Locky Poser, PyLocky Ransomware\n\n**[blog.trendmicro.com/trendlabs-security-intelligence/a-closer-look-at-the-locky-poser-pylocky-ransomware/](https://blog.trendmicro.com/trendlabs-security-intelligence/a-closer-look-at-the-locky-poser-pylocky-ransomware/)**\n\nSeptember 10, 2018\n\n_Updated as of September 10, 2018, 6:40 PM PDT to update how PyLocky establishes C&C_\n_connection._\n\n[While ransomware has noticeably plateaued in today’s threat landscape, it’s still a](https://www.trendmicro.com/vinfo/tmr/?/us/security/definition/ransomware)\n[cybercriminal staple. In fact, it saw a slight increase in activity in the first half of 2018,](https://www.trendmicro.com/vinfo/tmr/?/us/security/research-and-analysis/threat-reports/roundup/unseen-threats-imminent-losses)\nkeeping pace by being fine-tuned to evade security solutions, or in the case of PyLocky\n(detected by Trend Micro as RANSOM_PYLOCKY.A), [imitate established ransomware](https://blog.trendmicro.com/trendlabs-security-intelligence/crypmic-ransomware-wants-to-follow-cryptxxx/)\nfamilies and ride on their notoriety.\n\nIn late July and throughout August, we observed waves of spam email delivering the\nPyLocky ransomware. Although it tries to pass off as Locky in its ransom note, PyLocky is\nunrelated to Locky. PyLocky is written in Python, a popular scripting language; and packaged\nwith PyInstaller, a tool used to package Python-based programs as standalone executables.\n\n[Ransomware written in Python isn’t new — we’ve already seen CryPy (RANSOM_CRYPY.A)](https://www.trendmicro.com/vinfo/tmr/?/us/security/news/cybercrime-and-digital-threats/ransomware-recap-sept-9-2016)\n[in 2016, and Pyl33t (RANSOM_CRYPPYT.A) in 2017 — but PyLocky features anti-machine](https://www.trendmicro.com/vinfo/tmr/?/us/security/news/cybercrime-and-digital-threats/ransomware-recap-torrentlocker-s-new-tactics)\nlearning capability, which makes it notable. Through the combined use of Inno Setup Installer\n(an open-source script-based installer) and PyInstaller, it posed a challenge to static analysis\nmethods, including machine learning-based solutions — something we have already seen\n[variants of Cerber do (although Cerber used NullSoft installer).](https://blog.trendmicro.com/en_us/research/17/c/cerber-starts-evading-machine-learning.html)\n\n\n-----\n\nPyLocky s distribution also appears to be concentrated; we saw several spam emails\ntargeting European countries, particularly France. And though the spam run started out\nsmall, its volume and scope eventually increased.\n\n_Figure 1: Distribution of PyLocky-related spam runs on August 2 (left) and August 24_\n_(right)_\n\n_Figure 2: PyLocky’s ransom note pretending to be the Locky ransomware_\n\n**Infection Chain**\n\nOn August 2, we detected a spam run distributing PyLocky to French businesses, luring\nthem with socially engineered subject lines such as those related to invoices. The email\nentices the user to click a link, which redirects users to a malicious URL containing PyLocky.\n\n_Figure 3: Spam email with the subject line, “Nous avons reçu votre paiement,\" which_\n_means “We have received your payment”._\n\nThe malicious URL leads to a ZIP file (Facture_23100.31.07.2018.zip) that contains a signed\nexecutable (Facture_23100.31.07.2018.exe). When successfully run, the\n_Facture_23100.31.07.2018.exe will drop malware components — several C++ and Python_\nlibraries and the Python 2.7 Core dynamic-link library (DLL) — along with the main\nransomware executable (lockyfud.exe, which was created via PyInstaller ) in C:\\Users\\\n{user}\\AppData\\Local\\Temp\\is-{random}.tmp.\n\n_Figure 4: The digital signature information of the ZIP file (top), and PyLocky-related_\n_malware components (bottom)_\n\nPyLocky encypts image, video, document, sound, program, game, database, and archive\nfiles, among others. Here’s a list of file types PyLocky encrypts:\n\n_.dat, .keychain, .sdf, .vcf, .jpg, .png, .tiff, .gif, .jpeg, .jif, .jp2, .jpx, .j2k, .j2c, .fpx, .pcd, .bmp,_\n_.svg, .3dm, .3ds, .max, .obj, .dds, .psd, .tga, .thm, .tif, .yuv, .ai, .eps, .ps, .svg, .indd, .pct,_\n_.mp4, .avi, .mkv, .3g2, .3gp, .asf, .flv, .m4v, .mov, .mpg, .rm, .srt, .swf, .vob, .wmv, .doc, .docx,_\n_.txt, .pdf, .log, .msg, .odt, .pages., .rtf, .tex, .wpd, .wps, .csv, .ged, .key, .pps, .ppt., .pptx, .xml,_\n_.json, .xlsx, .xlsm, .xlsb, .xls, .mht, .mhtml, .htm, .html, .xltx, .prn, .dif, .slk, .xlam, .xla, .ods,_\n_.docm, .dotx, .dotm, .xps, .ics, .mp3., .aif, .iff, .m3u, .m4a, .mid, .mpa, .wav, .wma, .msi, .php,_\n_.apk, .app, .bat, .cgi, .com, .asp, .aspx, .cer, .cfm, .css, .js, .jsp, .rss, .xhtml, .c, .class, .cpp,_\n_.cs, .h, .java, .lua, .pl, .py, .sh, .sln, .swift, .vb, .vcxproj, .dem, .gam, .nes, .rom, .sav, .tgz, .zip,_\n_.rar, .tar, .7z, .cbr, .deb, .gz, .pkg, .rpm, .zipx, .iso, .ged, .accdb, .db, .dbf, .mdb, .sql, .fnt, .fon,_\n_.otf, .ttf, .cfg, .ini, .prf, .bak, .old, .tmp, .torrent_\n\n\n-----\n\n_Figure 5: Code snippets showing PyLocky querying system properties (top), and being_\n_configured to sleep for a certain time to evade traditional sandbox solutions (bottom)_\n\n**Encryption routine**\n\nPyLocky is configured to encrypt a hardcoded list of file extensions. PyLocky also abuses\nWindows Management Instrumentation (WMI) to check the properties of the affected system.\nFor its anti-sandbox capability, PyLocky will sleep for 999,999 seconds — or just over 11.5\ndays — if the affected system’s total visible memory size is less than 4GB. The file\nencryption routine executes if it is greater than or equal to 4GB.\n\nAfter encryption, PyLocky will establish communication with its command-and-control (C&C)\nserver. PyLocky implements its encryption routines using PyCrypto library – using the 3DES\n(Triple DES) cipher. PyLocky iterates through each logical drive, first generating a list of files\nbefore calling the ‘efile’ method, which overwrites each file with an encrypted version, then\ndrops the ransom note.\n\nPyLocky’s ransom notes are in English, French, Korean, and Italian, which may suggest that\nit may also target Korean- and Italian-speaking users. It also sends the affected system’s\ninformation to the C&C server via POST.\n\n_Figure 6: Code snippets showing PyLocky’s C&C communication (top) and encryption_\n_routine (bottom)_\n\n_Figure 7: PyLocky’s ransom notes in different languages_\n\n**Mitigation and Trend Micro Solutions**\n\n[PyLocky’s evasion techniques and abuse of legitimate tools typically reserved to](https://www.trendmicro.com/vinfo/tmr/?/us/security/news/security-technology/2017-notably-abused-system-administration-tools-and-protocols)\nadministrators further exemplify the significance of defense in depth. For instance, machine\nlearning is a valuable cybersecurity tool in detecting unique malware, but it is not a silver\nbullet. With today’s threats, there are different vectors at the attackers’ disposal, which\n[makes a multi-layered approach to security important. Apply best practices:](https://www.trendmicro.com/vinfo/tmr/?/us/security/news/cybercrime-and-digital-threats/best-practices-ransomware) regularly back\n[up files, keep the system updated, secure the use of system components, and](https://www.trendmicro.com/vinfo/tmr/?/us/security/news/cybercrime-and-digital-threats/best-practices-securing-sysadmin-tools) [foster a](https://www.trendmicro.com/vinfo/tmr/?/us/security/news/cybercrime-and-digital-threats/why-ransomware-works-psychology-and-methods-to-distribute-infect-and-extort)\nculture of cybersecurity awareness.\n\n[Trend Micro XGen™ security provides a cross-generational blend of threat defense](https://blog.trendmicro.com/en_us/business/products/all-solutions.html)\n[techniques against a full range of threats for data centers,](https://blog.trendmicro.com/en_us/business/products/hybrid-cloud/security-data-center-virtualization.html) [cloud environments,](https://blog.trendmicro.com/en_us/business/products/hybrid-cloud/cloud-migration-security.html) [networks,](https://blog.trendmicro.com/en_us/business/products/network.html)\n[and endpoints. It features high-fidelity machine learning to secure](https://blog.trendmicro.com/en_us/business/products/user-protection.html)\nthe [gateway and](https://blog.trendmicro.com/en_us/business/products/user-protection/sps.html) [endpoint data and applications, and protects physical, virtual, and cloud](https://blog.trendmicro.com/en_us/business/products/user-protection/sps.html)\nworkloads. With capabilities like web/URL filtering, behavioral analysis, and custom\nsandboxing, XGen™ protects against today’s purpose-built threats that bypass traditional\n\n\n-----\n\ncontrols, exploit known, unknown, or undisclosed vulnerabilities, and either steal or encrypt\npersonally-identifiable data. Smart, optimized, and connected, XGen™ powers Trend Micro’s\nsuite of security solutions: Hybrid Cloud Security, User Protection, and Network Defense.\n\n**Indicators of Compromise (IoCs)**\n\n_Hashes detected as RANSOM_PYLOCKY.A (SHA-256):_\n\nc9c91b11059bd9ac3a0ad169deb513cef38b3d07213a5f916c3698bb4f407ffa\n1569f6fd28c666241902a19b205ee8223d47cccdd08c92fc35e867c487ebc999\n\n_Related hashes (SHA-256):_\n\ne172e4fa621845080893d72ecd0735f9a425a0c7775c7bc95c094ddf73d1f844\n(Facture_23100.31.07.2018.zip)\n2a244721ff221172edb788715d11008f0ab50ad946592f355ba16ce97a23e055\n(Facture_23100.31.07.2018.exe)\n87aadc95a8c9740f14b401bd6d7cc5ce2e2b9beec750f32d1d9c858bc101dffa\n(facture_31254872_18.08.23_{numbers}.exe)\n\n_Related malicious URLs:_\n\nhxxps://centredentairenantes[.]fr (C&C server)\nhxxps://panicpc[.]fr/client[.]php?fac=676171&u=0000EFC90103\nhxxps://savigneuxcom[.]securesitefr[.]com/client.php?fac=001838274191030\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2018/2018-09-10 - A Closer Look at the Locky Poser, PyLocky Ransomware.pdf"
    ],
    "report_names": [
        "2018-09-10 - A Closer Look at the Locky Poser, PyLocky Ransomware.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673535718,
    "ts_updated_at": 1743041171,
    "ts_creation_date": 1653709740,
    "ts_modification_date": 1653709740,
    "files": {
        "pdf": "https://archive.orkl.eu/325756c7530968a8882ff25e53573b75f02109c3.pdf",
        "text": "https://archive.orkl.eu/325756c7530968a8882ff25e53573b75f02109c3.txt",
        "img": "https://archive.orkl.eu/325756c7530968a8882ff25e53573b75f02109c3.jpg"
    }
}