{
    "id": "6f9a020f-e5fc-427e-9e2c-ce8900967531",
    "created_at": "2023-01-12T15:00:35.347009Z",
    "updated_at": "2025-03-27T02:16:11.467773Z",
    "deleted_at": null,
    "sha1_hash": "525014cdc094e539094d21b58a813bb19a85ee75",
    "title": "2022-07-22 - Old cat, new tricks, bad habits An analysis of Charming Kitten’s new tools and OPSEC errors",
    "authors": "",
    "file_creation_date": "2022-08-18T03:29:01Z",
    "file_modification_date": "2022-08-18T03:29:01Z",
    "file_size": 333326,
    "plain_text": "# Old cat, new tricks, bad habits\n\n**[pwc.com/gx/en/issues/cybersecurity/cyber-threat-intelligence/old-cat-new-tricks.html](https://www.pwc.com/gx/en/issues/cybersecurity/cyber-threat-intelligence/old-cat-new-tricks.html)**\n\n# An analysis of Charming Kitten’s new tools and OPSEC errors\n\nCopy link\n\n**By Krystle Reid**\n\n## Executive summary\n\nYellow Garuda (similar to Charming Kitten, PHOSPHORUS, UNC788) is a threat actor likely to\nhave been active since at least 2012. It is possibly one of the most active and persistent Iranbased threat actors over the last decade and is known primarily for spoofing log-in pages of\nlegitimate webmail services to collect credentials from its targets. The threat actor also has a\nhistory of operational security (OPSEC) errors resulting in disclosure of its tools, techniques and\nprocedures (TTPs), including the addition of Android malware to its expanding toolset.\n\nOPSEC mistakes associated with Yellow Garuda operations in late 2021 resulted in the discovery\nof new tool used to enumerate data from targeted Telegram accounts. We also identified an alias\ntied to early Iran-based operations and a surveillance report likely written by a Yellow Garuda\noperator. Additionally, PwC analysts have observed the threat actor’s use of macro-enabled\ntemplate files as recently as March 2022, a new TTP not previously associated with Yellow\nGaruda.\n\n\n-----\n\n## Telegram grabber tool\n\nThrough our regular scanning for Yellow Garuda infrastructure, PwC analysts identified an open\ndirectory located at 138.201.145[.]183 containing several compressed archives associated with\nlate 2021 Yellow Garuda activity.\n\nEach of the RAR archives contained a copy of a tool named\nNewTelegram.LocalGrabber.Sqlite.UI.Win.exe, together with the tool’s component parts, and\nexfiltrated victim data. In total there were seven sets of victim data on the server, six of which were\noutputs of the Telegram ‘grabber’ tool, and one of which was almost certainly the result of data\nexfiltrated by mobile malware. Although it is unclear what malware was used, we note that the\ntype of data captured is in line with the capabilities of PINEFLOWER, an Android malware\npreviously attributed to Yellow Garuda . 1\n\nThese archives had filenames referencing Solar Hijri calendar dates indicating that the activity\ntook place between 7th September and 11th October 2021, when converted to the Gregorian\ncalendar. The activity suggests domestic targeting as all victim mobile numbers contained the\nIranian country code and Farsi was the main language seen in victim databases (as part of\nTelegram group names or in exfiltrated messages). From the data exfiltrated, it was also apparent\nthat some of victims were associates of each other, where two pairs of victims were contacts of\nanother victim on Telegram. We also observed that two of the victims likely had links to the Iranian\nmusic industry.\n\nFigure 1 - Contents of 138.201.145[.]183\n\n\nThe Telegram grabber tool is written in C++ and uses the open source Telegram Database Library\n(TDLib), a cross-platform Telegram client typically used to create custom apps for the platform . It2\nhas been designed to exfiltrate information from a victim’s Telegram account. This includes\nmessages and associated media, group memberships and contact data.\n\n**SHA-256** 7709a06467b8a10ccfeed72072a0985e4e459206339adaea3afb0169bace024e\n\n**Filename** NewTelegram.LocalGrabber.Sqlite.UI.Win.exe\n\n**File type** Win32 EXE\n\n**File size** 5,423,104 bytes\n\n\n**Compilation**\n**timestamp**\n\n\n2062-01-30 02:30:48\n\n\nIn order to access the victim’s account, the threat actor needs to enter a login code which is\nissued by Telegram as part of its authentication process. The code is sent either to the victim’s\nTelegram account, or via SMS to the victim’s phone . This means that the threat actor needs to3\n\n\n-----\n\nhave access to a victim s active Telegram session, either via a phone or desktop, or otherwise be\nable to access their SMS messages, for example via mobile malware. As can be seen in Figure 2,\nthe victim’s phone number is required upon opening the tool in order to send the authentication\ncode.\n\nFigure 2 – GUI to enter victim’s phone number\n\nIf the victim has enabled two-step verification, an additional password is needed. Where this is\nunknown, it can be reset using a recovery email if one has been previously setup. The tool has\noptions to view the password hint and send an access code via the victim’s recovery email\naddress, which the threat actor would need to access in order to proceed. The existence of this\noption indicates that the threat actor, at least in some cases, is likely to have access to the victim’s\nemail account. This aligns with Yellow Garuda’s known tactics, which include extensive credential\nharvesting via dedicated phishing sites.\n\nOnce authenticated, the operator is presented with multiple options to choose the type of data to\ndownload. This includes the ability to select a date range for the download of the different types of\nTelegram chat messages. For groups, the tool attempts to grab details on the participants as well\nas whether or not the victim is an administrator. The tool is also able to download data relating to\nthe victim’s profile and their contacts, including their names, phone numbers, usernames and\nprofile pictures.\n\nFigure 3 – Metadata accessed for each contact\n\nThe exfiltrated data is stored within a SQLite database and also in JSON format. For attachments\nsent or received through chats, there are options to choose specific file formats to download.\nThese pertain to common video, audio, document, binary and compressed file extensions. In\naddition to being able to exfiltrate data, the threat actor also has the ability to delete messages\nfrom the victim’s account.\n\nWe found 15 additional samples of the tool on an online multi-antivirus scanner which share the\nsame filename (NewTelegram.LocalGrabber.Sqlite.UI.Win.exe) and TypeLib ID (7bb2c20c-740e498b-8dd6-9c2ff8ad9572) as the sample we analysed. The TypeLib ID is a unique GUID created\nby Visual Studio when a new project is created, thus indicating that all of the samples originated4\nfrom the same project. The additional samples were all uploaded within a 31 day window between\nJanuary and February 2021 and contained similar functionality to the one we analysed. The main\ndifference was the presence of a web request function that appeared to be used in a testing\ncapacity. Given the clustered times of submission and the presence of the web request test\nmethod, we assess it is likely these samples were submitted by the threat actor itself in a testing\ncapacity.\n\n## Insights into Yellow Garuda’s operations\n\nThe following Microsoft Word document was found in the directory corresponding to one of the\nvictims whose data was highly likely exfiltrated via mobile malware and not through the Telegram\n‘grabber’ tool. Its filename translates to ‘01Report’ and its contents detail the status of the\n\n\n-----\n\nsurveillance on that victim.\n\n**Filename** 01گزارش.docx\n\n**SHA-256** 36c12ff1b62f4579d64926f5a26c4a1806235859a8f71c8754d5b257716be538\n\n**File type** DOCX\n\n**Author** ll_invisible_ll\n\n\n**Last modified**\n**user**\n\n\nll_invisible_ll\n\n\n**Creation date** 2021-10-11 06:48:00\n\n\n**Last modifed**\n**date**\n\n\n2021-10-12 12:54:00\n\n\n**File size** 13,736 bytes\n\nFigure 4 – Threat actor report (left) and translation from Farsi to English (right)\n\nThe report gives us insight into the threat actor’s specific data collection objectives. It references\nthe surveillance of audio and video conversations of the victim’s phone and confirms the victim’s\nname, national identity number, mobile number and phone model. It indicates the surveillance was\ncompleted on 11 October 2021 and is being sent for review by the ‘relevant expert’ on the ordersth\nof the manager of ‘2000’ and ‘2300’, numbers which could represent individual operators or\ndepartments within Yellow Garuda’s operations. The report ends with a warning that if the\nsurveillance is detected, it will not be possible to re-access the phone.\n\nThese numbers align with additional observations from the output log files of the Telegram\n‘grabber’ tool which contained local file paths likely belonging to the threat actor. An example is as\nfollows:\n\nFigure 5 – Example of file path found in output log files. The date converts to 22nd September\n2021 in the Gregorian calendar\n\nWe observed values of 1500, 2700 and 3500 being used as part of the local directory structure.\nThis indicates that at least three operators or teams may have contributed to the Telegram\n‘grabber’ activity observed and a further two separate operators or teams worked on the victim\nreferenced in the report.\n\n\nA previously leaked organisational chart associated with Iran’s Islamic Revolutionary Guard Corps\n(IRGC) shows individual departments with similar numerical referencing (Figure 6) . From the5\nEnglish translation in Table 1, we can see that several of the observed values are present,\noverlapping with departments related to cyber, security and counterintelligence. Although we are\n\n\n-----\n\nunable to independently verify the validity of this chart, the overlap in naming convention, and our\nunderstanding that Yellow Garuda is likely associated with the IRGC, aligns with our assessment6\nthat these are operator/team names.\n\nThe author name of the threat actor report, “ll_invisible_ll” is fairly unique and gives us insight into\na potential individual operator. This alias was also in use between 2010 and 2016 on the Ashiyane\nforum, a now defunct Iranian hacking forum originally started by the Ashiyane Digital Security\nTeam. The Ashiyane Digital Security Team has previously been linked to IRGC activity and7\nseveral of its members appeared in a US Department of Justice (DOJ) indictment for distributed\ndenial of service (DDoS) attacks against organisations in the US financial sector and other USbased companies between 2011 and 2013 .8\n\n\nFigure 6 – Diagram purportedly showing IRGC-related departments and leads (Farsi language) [9]\n\n**Name** **Number**\n\nHead of the Intelligence Unit of the IRGC, Hossein Taeb 20\n\nThe Head of Department, General Yar Ali Sabzi 100\n\nDeputy of Readiness and Support 200\n\nDeputy of HR and Recruitment 300\n\nDeputy of Plan, Program and Budget, General Gholipour 400\n\nDeputy of Military Intelligence 500\n\nDeputy of Psychological Operations, Haj Abdullah Mushfeq 600\n\nSpecial cases 700\n\nDeputy of Equipping, General Sadeghian 900\n\nDeputy of Information Protection, Izadi 1000\n\nDeputy of Inspector, General Karimi 1100\n\nDeputy of Information Collection 1200\n\nThematic 1300\n\n**Deputy of Counterintelligence, General Taha** **1500**\n\nDeputy of Arrest and Surveillance Operation, Detention Center, General Qajavand 1600\n\nLegal Deputy, Dr. Mahdavi 1700\n\nDeputy of Civil Engineering (Structure and Building) 1800\n\nRepresentative of the Supreme Leader, Haj Qasimi and Mr. Elahi 1900\n\n\n-----\n\n**Deputy of Cyber, Hamid Naeem** **2000**\n\n\n**Deputy of Security (Counter-Terrorism and Fight against Armed Groups),**\n**General Nouhi**\n\n\n**2300**\n\n\nDeputy of Crimes 2400\n\nCentre of Documents N/A\n\n**Table 1 – English translation of Figure 6 showing IRGC-related departments and leads;**\n**numbers overlapping with those observed in our analysis have been highlighted in bold**\n\n## Macro-enabled Word document templates\n\nBetween January and March 2022, we observed Yellow Garuda using Microsoft Word document\ndroppers which use remote template injection to obtain and execute a malicious macro. This is the\nfirst time we have observed the threat actor deploying macros or using remote template injection\nas part of its attack sequence.\n\n**SHA-256** **Filename**\n\n41b37de3256a5d1577bbed4a04a61bd7bc119258266d2b8f10a9bb7ae7c0d4ec Turkey_inj.docx\n\n725bdf594baa21edf1f3820b0daf393267066717832452598c617552a004e5da Turkey.docx\n\n01ca3f6dc5da4b98915dd8d6c19289dcb21b0691df1bb320650c3eb0db3f214c Iran- Taliban\nrelations.docx\n\n57cc5e44fd84d98942c45799f367db78adc36a5424b7f8d9319346f945f64a72 NY.docx\n\na8c062846411d3fb8ceb0b2fe34389c4910a4887cd39552d30e6a03a02f4cc78 Details-ofComplaint.docx\n\n**Table 2 – Details of Microsoft Word document droppers (DOCX)**\n\nThe document lures we observed covered a variety of themes including nuclear energy and\nweapons related to Turkey, US shipping ports and Iran’s relationship to the Taliban and as such,\nwe assess they were likely used to target a variety of unrelated entities. Many of these lures, used\nmaterial sourced from legitimate English-language websites, including news and media sites. It is\nnot unusual for threat actors to make use of current affairs as a means to catch the attention of\npotential victims and the themes are not necessarily indicative of specific targeting.\n\nFigure 7 – Example of lure content\n\n\n10\n\n\n-----\n\nThe initial Microsoft Word document (DOCX) is hosted on a third party service such as Dropbox or\nAmazon Web Services (AWS). Yellow Garuda is known to extensively employ social engineering\nas part of its attacks, therefore it is highly likely phishing was used to coerce a potential victim to\ndownload and open the document.\n\nOnce opened, a form of remote template injection takes place where the document reaches out to\na URL to download a file with a DOTM extension (a macro-enabled template file). The URL is\nspecified within the relationship component word/_rels/settings.xml.rels of the initial document as\nindicated by the ‘Target’ value in Figure 8. The documents we analysed reached out to files hosted\non either Microsoft OneDrive or on dedicated threat actor-controlled infrastructure, as can be seen\nbelow.\n\nFigure 8 – URL visible in word/_rels/settings.xml.rels\n\nWe were able to access several examples of this second stage macro-enabled template file.\nThese differed in functionality and form, however they all maintained persistence by replacing the\nvictim’s default Microsoft Word template, meaning that the malicious template (and macro) will\nopen whenever Microsoft Word is opened by the victim.\n\n**SHA-256** **Filename**\n\nc45bffb5fe7056075b966608e6b6bf82102f722b5c5d8a9c55631e155819d995 DocTemplate.dotm\n\ndd28806d63f628dbc670caaa67379da368e62fa9edfbdfd37d3a91354df08e1c DocTemplate.dotm\n\nc0d5043b57a96ec00debd3f24e09612bcbc38a7fb5255ff905411459e70a6bb4 Details.dotm\n\n28de2ccff30a4f198670b66b6f9a0ce5f5f9b7f889c2f5e6a4e365dea1c89d53 Arabic.dotm\n\n**Table 3 – Details of malicious template files (DOTM)**\n\nIn some cases, we observed the macro code creating a reverse shell using code almost identical11\nto that found in open source on a GitHub repository12. In other cases13, the template files were\npassword protected meaning that the victim is required to specify the password in order for the\nattack sequence to proceed. This would need to be passed over to the victim via a phishing email\nor some other form of social engineering. The template files also contained RC4-encrypted strings\n(both within the macro and lure document) for which the decryption key needed to be obtained as\nthe response to a HTTP GET request to an Amazon S3 bucket. These steps were likely designed\nto thwart analysis attempts if the password cannot be obtained to open the document, or the\ninfrastructure hosting the decryption key is no longer active.\n\n\nFiles dropped by the macros shared similar filenames to recent Yellow Garuda activity observed\nby Check Point14. The PowerShell backdoor known as CharmPower was observed to read data\nfrom a file called ni txt located in %AppData% whose contents are sent to the command and\n\n\n-----\n\ncontrol server along with basic information about the victim s machine. This aligns with our\nobservations that ni.txt is used to house a hardcoded identifier and could indicate that a version of\nCharmPower is deployed at a later stage of the attack sequence.\n\n## Conclusion\n\nOver the past year, we have seen Yellow Garuda continue to add tools to its arsenal. In its use of\nmacro-enabled template files, we can see that the threat actor has made efforts to stage various\nparts of the infection chain remotely, disrupting analysis efforts where these are not accessible.\nThe threat actor has also continued to make OPSEC mistakes exposing its tools and targeting\nthrough open servers. The Telegram ‘grabber’ tool we observed appears to be a tool that the\nthreat actor has had access to since at least January 2021, and used against domestic targets to\nobtain specific access to Telegram messages and contacts alongside mobile malware.\n\nThe threat actor’s operational report has given us further insight into its analysis process,\nindicating that there is an internal structure to its operations denoted by numerical call signs. It\nalso highlights the alias of an individual which has previously been linked to Iran-based activity\nover several years.\n\n### MITRE ATT&CK\n\nMore detailed information on each of the techniques used in this blog, along with mitigations, can\nbe found on the following MITRE pages:\n\n**Valid Accounts - https://attack.mitre.org/techniques/T1078/**\n\n**Two-Factor Authentication Interception - https://attack.mitre.org/techniques/T1111/**\n\n**Obfuscated Files or Information - https://attack.mitre.org/techniques/T1027/**\n\n**System Information Discovery - https://attack.mitre.org/techniques/T1082/**\n\n**System Network Configuration Discovery - https://attack.mitre.org/techniques/T1016/**\n\n**Data Staged - https://attack.mitre.org/techniques/T1074/**\n\n**Exfiltration Over Web Service - https://attack.mitre.org/techniques/T1567/**\n\n**Acquire Infrastructure: Web Services - https://attack.mitre.org/techniques/T1583/006/**\n\n**Acquire Infrastructure: Domains - https://attack.mitre.org/techniques/T1583/001/**\n\n**Phishing: Spearphishing Link - https://attack.mitre.org/techniques/T1566/002/**\n\n### Indicators of Compromise\n\nTelegram ‘grabber’ tool:\n\n\n-----\n\n**Indicator**\n\n\n**Type**\n\n\n7709a06467b8a10ccfeed72072a0985e4e459206339adaea3afb0169bace024e SHA-256\n\nf09fa790f8b3bf59f44093ae18e8c9ec95b54fb8dab5039e9bfd09b12b815950 SHA-256\n\n6710d037801471826817596fa71637eecda4f58cddf47bbb48b3984b21582721 SHA-256\n\n141ae6d29118b099d5ef8ee0daa7a4714447d5aa13ce43563e21900014f1db7d SHA-256\n\nada1e14da19338f2fa009254a993c6b6607e9a328499c3a762d6652ca8edee5e SHA-256\n\n49218f19e3dc89ab2698f9e23f37d16a97b410de91226bb24e65c8392b74de93 SHA-256\n\n4cddb6a4fbf8771ee3180b974fc12c8261880a213a4bf36b1e910e1c1df847cf SHA-256\n\n5987f958d758866ccea33437c53276382f9c362fc33e81d342b616dc70aeb78f SHA-256\n\n7ea6cb74238d3f0099d4b9c42dd7301b9fb903b62f1f2e06ef73ade533691a69 SHA-256\n\n6e4e195c2d60aec5a75f287f2b27ade3204390ace9ad4dec07753234fb148b57 SHA-256\n\n6b84eebded654d29b63f931a28e5fc4318aaf32604d1ad2f14e4a87b7a499206 SHA-256\n\nf1651ffda0d45e6c37cd31c0ed83d9bd08c33acbd3647cbdd8b22b804ce8d6a3 SHA-256\n\n009df256bce5971edaab72c19c4ebcc9296e203a2ef447557c0796d86217d1d3 SHA-256\n\n5a9b1bf53e47cbecf41259f31d06f86dcf62b7858debd680c0a232de3577669a SHA-256\n\n4f85a533e6d25fb281639f9fb4b4f817faab2b291a7835c267f29c27728247f9 SHA-256\n\n435f61ad26b729e1d7813454ff8279c52ebd928a3d1dd824cb9267189991565d SHA-256\n\na81d2c633e938a04f486dea3b245e87dc498bc02 SHA-1\n\n9f9a5e7c24f8f2ab030ce875736d80e541156003 SHA-1\n\n\n-----\n\n85f1e02cb5f5c38b848c282187c3ceee7d544e13 SHA-1\n\nb3adc3d81853185f65dbd278fbba7f795e4a3259 SHA-1\n\n914a8da21feaab56fecbdc997710566775850617 SHA-1\n\naffe20def567eb63447f2a3aad3927d52384db59 SHA-1\n\n26ed903a997d8f9dfee10435e8930a9b24bd46f9 SHA-1\n\n2b5056c31ca2a54e6bccc1912eee522dcf16cd94 SHA-1\n\n71028a08ec0d64dff36cf5405997501278b949f9 SHA-1\n\n78b4ba41d2de822061d1f3e0c43d13d564f10871 SHA-1\n\nb785169c5fbaff8e205d6d58783706fc07208d59 SHA-1\n\n48b110b088d4fd8381990dbd6cbb23abeb87b422 SHA-1\n\n6df60e871d14996c4826a8c2355d64d3aabbfab6 SHA-1\n\n82a0d684a1e144a7f9f874e652597155bb12ae92 SHA-1\n\na8e7784df801cea9cb6278762437314bb42d1966 SHA-1\n\n72c4fe68520c0307367b0865b29215d1fc6e2c32 SHA-1\n\n1d64ddd5a2c0fae5817235ab9ddf334f MD5\n\ne66136da3bb11795da64f038ec4610b8 MD5\n\neb51402e73a86800cdce3a50c9c804fe MD5\n\nf7b0da0dca597f3e61f53000814f8148 MD5\n\n96be653e085046ed518ad3ce48fc4190 MD5\n\n\n-----\n\nd16f4bf877445e9fca422dc736db64cf MD5\n\n949cc35be1b366eaad94ea03cf862d6e MD5\n\n88fd6260d23f01213d3e2abee74db4a2 MD5\n\n5816f687ce49588aae2584bb5e9f652f MD5\n\n12a172b74d0c080217bf0b883c109a6b MD5\n\nb78483179f85d3c8e23733ebd114e10e MD5\n\nbddebaea4bf45f6b464d68a7b8e07b92 MD5\n\naba932b87072f479445a323b183cc29b MD5\n\n381bb58655a194e75763fb01a36e5c7b MD5\n\nb8045bebc39a8fff666803a5163173d8 MD5\n\n6a1dca07dafd2eebd99aba7c31ace928 MD5\n\nNewTelegram.LocalGrabber.Sqlite.UI.Win.exe Filename\n\n138.201.145[.]183 IPv4 address\n\nMacro-enabled template activity:\n\n**Indicator** **Type**\n\n57cc5e44fd84d98942c45799f367db78adc36a5424b7f8d9319346f945f64a72 SHA256\n\n725bdf594baa21edf1f3820b0daf393267066717832452598c617552a004e5da SHA256\n\n41b37de3256a5d1577bbed4a04a61bd7bc119258266d2b8f10a9bb7ae7c0d4ec SHA256\n\n\n-----\n\n01ca3f6dc5da4b98915dd8d6c19289dcb21b0691df1bb320650c3eb0db3f214c SHA256\n\nc45bffb5fe7056075b966608e6b6bf82102f722b5c5d8a9c55631e155819d995 SHA256\n\ndd28806d63f628dbc670caaa67379da368e62fa9edfbdfd37d3a91354df08e1c SHA256\n\na8c062846411d3fb8ceb0b2fe34389c4910a4887cd39552d30e6a03a02f4cc78 SHA256\n\nc0d5043b57a96ec00debd3f24e09612bcbc38a7fb5255ff905411459e70a6bb4 SHA256\n\n28de2ccff30a4f198670b66b6f9a0ce5f5f9b7f889c2f5e6a4e365dea1c89d53 SHA256\n\nb98a24144067ec3605e84158e12d6498222295ae SHA-1\n\nf39c5689887f5b94741e285cd867e1475111499e SHA-1\n\n5c0e8bd70e2dd49d45937ccc3f38de61d356384c SHA-1\n\n40dc7101e1991672b5f60523e69ed5787a9dc4fa SHA-1\n\ncc9f460e593522e57b66fed9a34d3ba332391165 SHA-1\n\n930e4757740aaefd9cb567faf301816fbe37c1c3 SHA-1\n\ne3712e3d818e63060e30aec2a6db3598cbf0db92 SHA-1\n\ne45aeccb798f5cf6cb5d877821d1f4aa7f55cf6f SHA-1\n\naba938bf8dc5445df3d5b77a42db4d6643db4383 SHA-1\n\n45b50d42e8d827ca0373c12533211c33 MD5\n\n55748b22a52823a3ccb5d8b106826cec MD5\n\n\n-----\n\n4ae177a37658c82adad3265ad3cce662 MD5\n\n14c095de9da5fbba5548d9fea65c8b2d MD5\n\ndb998d8182f4afd9f42bb289c508a1f3 MD5\n\nc711036ef1805fea9dc2c8e633b961fd MD5\n\nb7bc6a853f160df2cc64371467ed866d MD5\n\n651d72776c0394693c25b1e3c9ec55d0 MD5\n\nbdf188b3d0939ec837987b4936b19570 MD5\n\nofficial-updates[.]info Domain\n\noffice-updates[.]info Domain\n\n51.38.87[.]253 IPv4\naddress\n\nhxxp://official-updates[.]info/office/Default.dotm URL\n\nhxxps://dl[.]dropboxusercontent[.]com/s/psmt483ybusajvy/Turkey.docx?dl=0 URL\n\n\nhxxps://u1ndk6f4nf[.]execute-api[.]us-east1[.]amazonaws[.]com/page/EdPEtAGapngkNtLLFCee\n\n\nURL\n\n\nhxxps://u1ndk6f4nf[.]execute-api[.]us-east1[.]amazonaws[.]com/page/zhUezQeFqaDRmxWaHfVz\n\n\nURL\n\n\nhxxps://s3[.]amazonaws[.]com/2v63r9egi46/mvhg5dhdbsolshpq URL\n\nhxxps://s3[.]amazonaws[.]com/2v63r9egi46/hgn8fdsf512fsc5 URL\n\n\nhxxps://drive[.]google[.]com/uc?\nexport=download&id=13_PT71n8Ujl2lSTcQcyFJ4TNetIwvDf&dID=1645099370036&linkName=Download%20File\n\n\nURL\n\n\n-----\n\nhxxp://office-updates[.]info/2022/Details.dotm URL\n\nhxxp://office-updates[.]info/static/admin/storage/Arabic.dotm URL\n\nhxxp://office-updates[.]info/static/admin/storage/Details.dotm URL\n\n## Footnotes\n\n[1] ‘UNC788: IRAN’S DECADE OF CREDENTIAL HARVESTING AND SURVEILLANCE OPERATIONS’, VB2021 localhost,https://vblocalhost.com/uploads/VB2021-Haeghebaert.pdf (October 2021)\n\n[2] Telegram, ‘Telegram Database Library’, https://core.telegram.org/tdlib\n\n[3] Telegram, ‘FAQ’, https://telegram.org/faq#login-and-sms\n\n[4] ‘Using .NET GUIDs to help hunt for malware’, Virus Bulletin, https://www.virusbulletin.com/virusbulletin/2015/06/using-net-guids-help-hunt-malware/ (25 June 2015)th\n\n[5] ‘BLACK BOX|جعبه سیاه’, Telegram, [https://t.me/jabeh_siah/4232 (26th February 2019)](https://t.me/jabeh_siah/4232)\n\n[[6] ‘BadBlood: TA453 Targets US and Israeli Medical Research Personnhttps://www.proofpoint.com/uk/blog/threat-insight/badblood-ta453-targets-us-and-israeli-medical-research-personnel-credential(30th March 2021)](https://www.proofpoint.com/uk/blog/threat-insight/badblood-ta453-targets-us-and-israeli-medical-research-personnel-credential) el in Credential Phishing Campaigns’, Proofpoint,\n\n[[7] ‘Decision 2011/235/CFSP’, Europeauri=OJ:L:2011:267:0013:0018:EN:PDF (12th October 2011)n Union, https://eurlex.europa.eu/LexUriServ/LexUriServ.do?](https://eurlex.europa.eu/LexUriServ/LexUriServ.do?uri=OJ:L:2011:267:0013:0018:EN:PDF)\n\n[8] ‘Indictment 834996’, US Department of Justice, https://www.justice.gov/opa/file/834996/download\n\n[9] ‘BLACK BOX|جعبه سیاه’, Telegram, [https://t.me/jabeh_siah/4232 (26th February 2019)](https://t.me/jabeh_siah/4232)\n\n[10] It is likely this is not the original file name and it has been altered by the submitter.\n\n[11] SHA-256: 28de2ccff30a4f198670b66b6f9a0ce5f5f9b7f889c2f5e6a4e365dea1c89d53 andc0d5043b57a96ec00debd3f24e09612bcbc38a7fb5255ff905411459e70a6bb4\n\n[[12] ‘JohnWoodman/VBA Macro Reverse SheShell/blob/main/VBA-Reverse-Shell.vba#L69 (13th February 2021)ll’, GitHub, https://github.com/JohnWoodman/VBA-Macro-Reverse-](https://github.com/JohnWoodman/VBA-Macro-Reverse-Shell/blob/main/VBA-Reverse-Shell.vba#L69)\n\n[13] SHA-256: c45bffb5fe7056075b966608e6b6bf82102f722b5c5d8a9c55631e155819d995 anddd28806d63f628dbc670caaa67379da368e62fa9edfbdfd37d3a91354df08e1c\n\n[[14] ‘APT35 exploits Log4j vulnerability to distribute new modular Powhttps://research.checkpoint.com/2022/apt35-exploits-log4j-vulnerability-to-distribute-new-modular-powershell-toolkit/ (11th January2022)](https://research.checkpoint.com/2022/apt35-exploits-log4j-vulnerability-to-distribute-new-modular-powershell-toolkit/) erShell toolkit’, Check Point,\n\n## {{filterContent.facetedTitle}}\n\n{{contentList.loadingText}}\n\n{{item.videoDuration}}\n\n**{{item.title}}**\n\n{{item.thumbnailText}}\n\n{{item.videoDuration}}\n\n{{item.publishDate}}\n\n**{{item.title}}**\n\n{{item.thumbnailText}}\n\n{{contentList.loadingText}}\n\n\n-----\n\n{{contentList.loadMoreLabel}} {{contentList.viewAllLabel}}\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-07-22 - Old cat, new tricks, bad habits An analysis of Charming Kitten’s new tools and OPSEC errors.pdf"
    ],
    "report_names": [
        "2022-07-22 - Old cat, new tricks, bad habits An analysis of Charming Kitten’s new tools and OPSEC errors.pdf"
    ],
    "threat_actors": [
        {
            "id": "82b92285-4588-48c9-8578-bb39f903cf62",
            "created_at": "2022-10-25T15:50:23.850506Z",
            "updated_at": "2025-03-27T02:00:55.501372Z",
            "deleted_at": null,
            "main_name": "Charming Kitten",
            "aliases": [
                "Charming Kitten"
            ],
            "source_name": "MITRE:Charming Kitten",
            "tools": [
                "DownPaper"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "d0e8337e-16a7-48f2-90cf-8fd09a7198d1",
            "created_at": "2023-03-04T02:01:54.091301Z",
            "updated_at": "2025-03-27T02:00:03.119447Z",
            "deleted_at": null,
            "main_name": "APT42",
            "aliases": [
                "UNC788",
                "CALANQUE"
            ],
            "source_name": "MISPGALAXY:APT42",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "ae26d287-8ba7-447e-9391-cf13c02d7481",
            "created_at": "2023-03-04T02:01:54.0962Z",
            "updated_at": "2025-03-27T02:00:03.120665Z",
            "deleted_at": null,
            "main_name": "TA453",
            "aliases": [],
            "source_name": "MISPGALAXY:TA453",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "d8af157e-741b-4933-bb4a-b78490951d97",
            "created_at": "2023-01-06T13:46:38.748929Z",
            "updated_at": "2025-03-27T02:00:02.908256Z",
            "deleted_at": null,
            "main_name": "APT35",
            "aliases": [
                "Newscaster Team",
                "Magic Hound",
                "G0059",
                "Phosphorus",
                "Mint Sandstorm",
                "TunnelVision",
                "COBALT MIRAGE"
            ],
            "source_name": "MISPGALAXY:APT35",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "47fa514e-15a8-4adb-a782-e2ffb12944d8",
            "created_at": "2024-04-24T02:00:49.644637Z",
            "updated_at": "2025-03-27T02:00:55.560836Z",
            "deleted_at": null,
            "main_name": "UNC788",
            "aliases": [
                "UNC788"
            ],
            "source_name": "MITRE:UNC788",
            "tools": [
                "HilalRAT"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "04888f75-158b-47f9-8ad9-4ff83f618ece",
            "created_at": "2024-05-01T02:03:08.03763Z",
            "updated_at": "2025-03-27T02:05:17.319276Z",
            "deleted_at": null,
            "main_name": "COBALT MIRAGE",
            "aliases": [
                "Nemesis Kitten ",
                "PHOSPHORUS ",
                "TunnelVision ",
                "UNC2448 ",
                "DEV-0270 "
            ],
            "source_name": "Secureworks:COBALT MIRAGE",
            "tools": [
                " Custom powershell scripts",
                " DiskCryptor",
                " Drokbk",
                " FRPC",
                " Fast Reverse Proxy (FRP)",
                " Impacket wmiexec",
                " Ngrok",
                " Plink",
                " PowerLessCLR",
                " TunnelFish",
                "BitLocker"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "029625d2-9734-44f9-9e10-b894b4f57f08",
            "created_at": "2023-01-06T13:46:38.364105Z",
            "updated_at": "2025-03-27T02:00:02.815023Z",
            "deleted_at": null,
            "main_name": "Charming Kitten",
            "aliases": [
                "Parastoo",
                "iKittens",
                "Group 83",
                "NewsBeef",
                "G0058",
                "CharmingCypress"
            ],
            "source_name": "MISPGALAXY:Charming Kitten",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "08a3b64c-8e18-455d-af57-28dca63808c4",
            "created_at": "2024-05-01T02:03:08.027871Z",
            "updated_at": "2025-03-27T02:05:17.313679Z",
            "deleted_at": null,
            "main_name": "COBALT ILLUSION",
            "aliases": [
                "APT42 ",
                "Charming Kitten ",
                "CharmingCypress ",
                "ITG18 ",
                "Magic Hound ",
                "Mint Sandstorm sub-group ",
                "NewsBeef ",
                "Newscaster ",
                "PHOSPHORUS sub-group ",
                "TA453 ",
                "UNC788 ",
                "Yellow Garuda ",
                "APT35 "
            ],
            "source_name": "Secureworks:COBALT ILLUSION",
            "tools": [
                " MagicHound Toolset",
                " PupyRAT",
                "Browser Exploitation Framework (BeEF)"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "e3676dfe-3d40-4b3a-bfbd-4fc1f8c896f4",
            "created_at": "2022-10-25T15:50:23.808974Z",
            "updated_at": "2025-03-27T02:00:55.550912Z",
            "deleted_at": null,
            "main_name": "Magic Hound",
            "aliases": [
                "Magic Hound",
                "TA453",
                "COBALT ILLUSION",
                "Charming Kitten",
                "ITG18",
                "Phosphorus",
                "APT35",
                "Mint Sandstorm"
            ],
            "source_name": "MITRE:Magic Hound",
            "tools": [
                "Impacket",
                "CharmPower",
                "FRP",
                "Mimikatz",
                "Systeminfo",
                "ipconfig",
                "netsh",
                "PowerLess",
                "Pupy",
                "DownPaper",
                "PsExec",
                "Havij",
                "sqlmap"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "1699fb41-b83f-42ff-a6ec-984ae4a1031f",
            "created_at": "2022-10-25T16:07:23.83826Z",
            "updated_at": "2025-03-27T02:02:09.995863Z",
            "deleted_at": null,
            "main_name": "Magic Hound",
            "aliases": [
                "APT 35",
                "Ballistic Bobcat",
                "Charming Kitten",
                "CharmingCypress",
                "Cobalt Illusion",
                "Cobalt Mirage",
                "Educated Manticore",
                "Magic Hound",
                "Mint Sandstorm",
                "Operation BadBlood",
                "Operation Sponsoring Access",
                "Operation SpoofedScholars",
                "Operation Thamar Reservoir",
                "Phosphorus",
                "TA453",
                "TEMP.Beanie",
                "Tarh Andishan",
                "Timberworm",
                "TunnelVision",
                "UNC788",
                "Yellow Garuda"
            ],
            "source_name": "ETDA:Magic Hound",
            "tools": [
                "7-Zip",
                "AnvilEcho",
                "BASICSTAR",
                "CORRUPT KITTEN",
                "CWoolger",
                "CharmPower",
                "ChromeHistoryView",
                "CommandCam",
                "DistTrack",
                "DownPaper",
                "FRP",
                "Fast Reverse Proxy",
                "FireMalv",
                "Ghambar",
                "GoProxy",
                "GorjolEcho",
                "HYPERSCRAPE",
                "Havij",
                "MPK",
                "MPKBot",
                "Matryoshka",
                "Matryoshka RAT",
                "MediaPl",
                "Mimikatz",
                "MischiefTut",
                "NETWoolger",
                "NOKNOK",
                "PINEFLOWER",
                "POWERSTAR",
                "PowerLess Backdoor",
                "PsList",
                "Pupy",
                "PupyRAT",
                "SNAILPROXY",
                "Shamoon",
                "TDTESS",
                "WinRAR",
                "WoolenLogger",
                "Woolger",
                "pupy",
                "sqlmap"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535635,
    "ts_updated_at": 1743041771,
    "ts_creation_date": 1660793341,
    "ts_modification_date": 1660793341,
    "files": {
        "pdf": "https://archive.orkl.eu/525014cdc094e539094d21b58a813bb19a85ee75.pdf",
        "text": "https://archive.orkl.eu/525014cdc094e539094d21b58a813bb19a85ee75.txt",
        "img": "https://archive.orkl.eu/525014cdc094e539094d21b58a813bb19a85ee75.jpg"
    }
}