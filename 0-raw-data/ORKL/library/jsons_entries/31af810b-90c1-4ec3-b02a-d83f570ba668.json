{
    "id": "31af810b-90c1-4ec3-b02a-d83f570ba668",
    "created_at": "2022-10-25T16:48:16.867911Z",
    "updated_at": "2025-03-27T02:05:58.469834Z",
    "deleted_at": null,
    "sha1_hash": "04a318c39f4453a0ccab6901c8558035fb28c88e",
    "title": "",
    "authors": "",
    "file_creation_date": "2019-03-29T08:02:32Z",
    "file_modification_date": "2019-03-29T08:02:32Z",
    "file_size": 472546,
    "plain_text": "Credentials Via Watering Hole\n\n# Desktop, Mobile Phishing Campaign Targets South Korean Websites, Steals Credentials Via Watering Hole\n\n[Posted on:March 28, 2019 at 5:02 am](https://blog.trendmicro.com/trendlabs-security-intelligence/2019/03/)\n[Posted in:Bad Sites, Mobile](https://blog.trendmicro.com/trendlabs-security-intelligence/category/bad-websites/)\nAuthor:\n[Joseph C Chen (Fraud Researcher)](https://blog.trendmicro.com/trendlabs-security-intelligence/author/josephcchen/)\n\n0\n\nWe discovered a phishing campaign that has compromised at least four South Korean websites – including a\nbusiness page ranked as one of the most visited sites in the country – by injecting fake login forms to steal\nuser credentials. While we’ve previously seen cybercriminals inject a malicious JavaScript code in the\nwebsites to load [browser exploits or financial information skimmers, using the](https://blog.trendmicro.com/trendlabs-security-intelligence/new-slub-backdoor-uses-github-communicates-via-slack/) [watering hole technique for a](https://www.trendmicro.com/vinfo/us/threat-encyclopedia/web-attack/137/watering-hole-101)\nphishing campaign is unusual. The campaign, which we labeled “Soula” (detected by Trend Micro as\nTrojan.HTML.PHISH.TIAOOHDW), collects information via a spoofed login screen of one of the country’s\nleading search engines that pops up over the original webpage. It sends the logged credentials to the\nattackers’ server even without accurate data confirmation, leading us to think that the cybercriminals are at\nresearch and information-gathering stage.\n\n**Routine**\n\n\n-----\n\n_Figure 1. Soula’s attack chain._\n\nWe traced the initial JavaScript injection done on the compromised websites on March 14. The injected script\nprofiles the website’s visitors and loads the phishing forms on top of the main pages. It scans the HTTP\nreferer header string and checks if it contains keywords related to popular search engines and social media\nsites to authenticate that the visitor is real. Since the HTTP referer identifies the address webpage of the\nsource to the requested page, this check makes it easier to identify the visitor as a real user if the request\ncomes from one, as well as filter out bot crawlers or threat engine scanners.\n\nThe script then scans for the HTTP User-Agent header for strings such as iPhone, iPad, iPod, iOS and\n_Android to identify the device used by the user as desktop or mobile, which allows it to deliver the respective_\nphishing forms to the victim. Mobile users will see the fake login form pop-up only after clicking any button\non the compromised websites. To mask the malicious routine, it only enables the pop-up to appear after the\nsixth time the victim visits the websites, setting a cookie to count the number of visits. The cookie is also set\nto expire after two hours since the last pop-up.\n\n_Figure 2 Injected script to check HTTP Referer and HTTP User Agent_\n\n\n-----\n\ncomputer. Users will see the fake login form directly on top of the compromised webpage, asking the user to\ninput their username and password before they can continue visiting the site. The user information is directly\nsent to the attackers’ servers. To prevent attack suspicions from the website, the phishing script sets a browser\ncookie to the devices that received the phishing forms that enables the fake login to expire 12 hours after the\ninitial interaction.\n\nWe noted that the comments were set in Simplified Chinese, and used Cloudflare to protect their domains and\nhide their real IP addresses. We contacted Cloudflare after identifying this attack, but while they immediately\nremoved the malicious domain from their service, the campaign did not stop. In fact, the campaign further\nenhanced its detection evasion features. The attackers added obfuscation to the JavaScript code injected into\nthe compromised websites and moved the scripts and phishing page to a compromised web server to avoid\ndetection and prevent removal of their domain. The websites are no longer compromised at the time of\npublishing.\n\n_Figure 3. Comments in Simplified Chinese._\n\n_Figure 4. The original script injected in the compromised website vs. the injected script after obfuscation._\n\n**Conclusion**\n\n\n-----\n\nthat the search engine hosts a variety of services for its South Korean customers as a trusted site, Soula is a\nsignificant threat to both enterprises and users as it exposes user credentials on a number of platforms.\nFurther, the content string it searches for and connects to may indicate cybercriminals’ possible plans to\ndevelop this to a bigger campaign that could affect more people worldwide.\n\nWhile this technique can be more difficult to trace compared to socially engineered phishing attacks, endpoint\nusers can still protect themselves by [enabling a multi-layered defense system that allows detection, scanning](https://www.trendmicro.com/en_us/business/products/user-protection/sps/endpoint.html)\nand blocking of malicious URLs and pop-ups. Users should also enable additional authentication measures\nsuch as 2FA whenever possible. Security administrators are advised to download updates as soon as patches\nare available from legitimate vendors, and enable Content Security Policy to prevent unauthorized access and\nuse of exploits for remotely injected scripts.\n\n**Trend Micro solutions**\n\n[Trend Micro™](https://www.trendmicro.com/us/enterprise/security-risk-management/deep-discovery/) [Deep Discovery™](https://www.trendmicro.com/us/enterprise/security-risk-management/deep-discovery/)\n\n[Trend Micro™](https://www.trendmicro.com/us/home/products/software/index.html) [User Protection Solution](https://www.trendmicro.com/en_us/business/products/user-protection.html?_ga=2.213178644.1836304680.1552871237-1577535324.1526018629)\n\n**Indicators of Compromise**\n\n**Descriptio**\n**SHA256** **Detection**\n\n**n**\n\n\n03ab41336ff260ec2410ac2704467676284df86\n\n44befce5a0b40773cc570286a\n\n29447d09a76f2a7982562a4386529d0af26cd75\n\n6671fd7173d518a34717c2aae\n\n7034c01be6c94ce2d42bbc3c197d0f9678ccb0fc\n\nc6ba6d0484d6bcf859a6d774\n\nb2bc1df018abd4ebc2e2f68fbae09a55bc381736\n\n97171507f8cfef9e7ec39978\n\n**URLs**\n\nhxxps://oauth2[.]space/        Phishing domain\n\nhxxps://oauth20[.]xyz/         Phishing domain\n\n\nSoula\nphishing\nscript hash\n\nSoula\nphishing\nscript hash\n\nSoula\nphishing\nscript hash\n\nSoula\nphishing\nscript hash\n\n\nTrojan.HTML.PHISH.TIAO\n\nOHDW\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        }
    ],
    "references": [
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2019/2019.03.28.Desktop_Mobile_Phishing_Campaign/Desktop%2C%20Mobile%20Phishing%20Campaign%20Targets%20South%20Korean%20Websites%2C%20Steals%20Credentials%20Via%20Watering%20Hole.pdf"
    ],
    "report_names": [
        "Desktop, Mobile Phishing Campaign Targets South Korean Websites, Steals Credentials Via Watering Hole"
    ],
    "threat_actors": [
        {
            "id": "67bf0462-41a3-4da5-b876-187e9ef7c375",
            "created_at": "2022-10-25T16:07:23.44832Z",
            "updated_at": "2025-03-27T02:02:09.806007Z",
            "deleted_at": null,
            "main_name": "Careto",
            "aliases": [
                "Careto",
                "The Mask",
                "Ugly Face"
            ],
            "source_name": "ETDA:Careto",
            "tools": [
                "Careto"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1666716496,
    "ts_updated_at": 1743041158,
    "ts_creation_date": 1553846552,
    "ts_modification_date": 1553846552,
    "files": {
        "pdf": "https://archive.orkl.eu/04a318c39f4453a0ccab6901c8558035fb28c88e.pdf",
        "text": "https://archive.orkl.eu/04a318c39f4453a0ccab6901c8558035fb28c88e.txt",
        "img": "https://archive.orkl.eu/04a318c39f4453a0ccab6901c8558035fb28c88e.jpg"
    }
}