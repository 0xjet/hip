{
    "id": "3688e369-9355-4ab7-b336-0aad6abc849f",
    "created_at": "2023-01-12T15:08:41.972729Z",
    "updated_at": "2025-03-27T02:13:34.329019Z",
    "deleted_at": null,
    "sha1_hash": "ce8198a4a45b2601cca5feda50bc90052f839d78",
    "title": "2019-12-11 - Story of the year 2019- Cities under ransomware siege",
    "authors": "",
    "file_creation_date": "2022-05-28T03:45:09Z",
    "file_modification_date": "2022-05-28T03:45:09Z",
    "file_size": 776862,
    "plain_text": "# Story of the year 2019: Cities under ransomware siege\n\n**[securelist.com/story-of-the-year-2019-cities-under-ransomware-siege/95456/](https://securelist.com/story-of-the-year-2019-cities-under-ransomware-siege/95456/)**\n\nAuthors\n\nKaspersky\n\n**Ransomware has been targeting the private sector for years now.**\n\nOverall awareness of the need for security measures is growing, and cybercriminals are\nincreasing the precision of their targeting to locate victims with security breaches in their\ndefense systems. Looking back at the past three years, the share of users targeted with\n**ransomware in the overall number of malware detections has risen from 2.8% to 3.5%.**\nWhile this might seem like a modest amount, ransomware is capable of causing extensive\ndamage in the affected systems and networks, which means this threat should never be\noverlooked. The proportion of ransomware targets among all users attacked with malware\nhas been fluctuating, yet appears to be decreasing, with the figure for H1 2019 showing\n2.94% compared to 3.53% two years ago.\n\n\n-----\n\n_[Share of users attacked with ransomware from all users attacked with malware (download)](https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2020/05/13132013/story-of-the-year-2019-cities-under-ransomware-siege_01-en-ru-sp-users-attacked.png)_\n\nThe overall number of users attacked annually has changed. Kaspersky experts usually\n**observe from around 900,000 to almost 1.2 million users targeted by ransomware**\n**every six months.**\n\n\n-----\n\n_[Number of users attacked with ransomware, H1 2017-H1 2019 (download)](https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2020/05/13132022/story-of-the-year-2019-cities-under-ransomware-siege_02-en-ru-sp-ransom-detections.png)_\n\nDespite there being many extremely sophisticated cryptor samples, the mechanism behind\nhow they operate is painstakingly simple: they turn the files on victims’ computers into\nencrypted data and demand a ransom for the decryption keys. These keys are created by\nthreat actors to decipher the files and transform them back into the original data. Without a\nkey, it is impossible to operate the infected device. The malware may be distributed by the\ncreators of the threat, sold to other actors or to the creators’ partner networks – ‘outsourced’\ndistributors that share the profit from successful ransomware attacks with the technology\nholders.\n\n2019 has seen this plague actively shifting towards a new target – municipalities. Arguably,\nthe most prominent and widely discussed incident was that in Baltimore, which suffered from\na large-scale ransomware campaign that knocked out a number of city services and required\ntens of millions of dollars to restore the city’s IT networks.\n\nBased on publicly available statistics and announcements monitored by Kaspersky experts,\n2019 has seen at least 174 municipal organizations targeted by ransomware. This is an\napproximately 60% increase from the number of cities and towns that reported falling victim\nto attacks a year earlier. Whereas not everyone has confirmed the amount of extorted funds\nand whether a ransom was paid or not, the average demand for ransom ranged from $5,000\n\n\n-----\n\nto $5,000,000, and on average was equal to around $1,032,460. The numbers, however,\nvaried greatly, as the funds extorted from small town school districts, for example, were\nsometimes 20 times smaller than those extorted from city halls in big municipalities.\n\nHowever, the actual damage caused by attacks, according to estimates by independent\nanalysts, often differs from the sum that the criminals request. First of all, some municipal\ninstitutions and vendors are insured against cyber-incidents, which compensates the costs\none way or another. Secondly, the attacks can often be neutralized by timely incident\nresponse. Last but not the least, not all cities pay the ransom: in the Baltimore encryption\n[case, where officials refused to pay the ransom, the city ended up spending $18 million to](https://www.techradar.com/news/us-city-votes-to-pay-ransomware-demand)\nrestore its IT infrastructure. While this sum might seem way more than the initial $114,000\nrequested by the criminals, paying the ransom is a short-term solution that encourages threat\nactors to continue their malicious practices. You need to keep in mind that once a city’s IT\ninfrastructure has been compromised, it requires an audit and a thorough incident\ninvestigation to prevent similar incidents from occurring again, plus the additional cost of\nimplementing robust security solutions.\n\nAttack scenarios vary. For instance, an attack may be the result of unprotected remote\naccess. In general, however, there are two entry points through which a municipality can be\nattacked: social engineering and a breach in un-updated software. A vivid illustration of\nthe latter problem has been observed quarterly by Kaspersky experts: the all-time leader of\nalmost all rankings of ransomware most frequently blocked on user devices is WannaCry.\nEven though Microsoft released a patch for its Windows operating system that closed the\nrelevant vulnerability months before the attacks started, WannaCry still affected hundreds of\nthousands of devices around the globe. And what’s more striking is the fact that it still lives\n[and prospers. The latest statistics gathered by Kaspersky in Q3 2019 demonstrated that two](https://securelist.com/it-threat-evolution-q3-2019-statistics/95269/)\nand a half years after the WannaCry epidemic ended, a fifth of all users targeted by cryptors\nwere attacked by WannaCry. What’s more, the statistics from 2017 to mid-2019 show that\nWannaCry is consistently one of the most popular malware samples, accounting for 27% of\nall users attacked by ransomware in that time period.\n\nAn alternative scenario involves criminals exploiting human factors: this is arguably the most\nunderestimated attack vector, as training of employees in security hygiene is nowhere near\nas universal as it should be. Many industries lose a tremendous amount of money due to\n[employee errors (in some industries this is the case for half of all incidents), phishing and](https://www.kaspersky.com/about/press-releases/2019_man-made-disaster-half-of-cybersecurity-incidents-in-industrial-networks-happen-due-to-employee-errors)\nspam messages containing installers for dangerous malware are still circulating around the\nweb and reaching victims. Sometimes those victims may be managing the company’s\naccounts and finances and not even suspect that opening a scammer email and\ndownloading what appears to be a PDF file on their computers can result in a network being\ncompromised.\n\nAmong the many types of municipal organizations attacked throughout 2019, some attracted\nmore attacks than others.\n\n\n-----\n\nThe most targeted entities were undoubtedly educational organisations, such as school\ndistricts, accounting for approximately 61% of all attacks: 2019 saw operations against more\nthan 105 school districts, with a whopping 530 schools targeted. This sector has been hit\n[hard, yet demonstrated a resilience: while some colleges had to cancel classes, many](https://www.bankinfosecurity.com/arizona-school-district-cancels-classes-due-to-ransomware-a-13035)\n[educational institutions adopted a position of continuing studies despite a lack of technical](https://www.insidehighered.com/news/2019/07/15/hackers-demand-2-million-monroe-college-ransomware-attack)\nsupport, claiming that computers have only recently become part of the educational process,\nand that staff are perfectly capable of teaching pupils without them.\n\n**City halls and municipal centers, meanwhile, accounted for around 29% of cases. Threat**\nactors are often aiming at the heart of processes that, if stopped, will result in an extremely\nproblematic interruption of vital processes for the vast majority of citizens and local\norganizations. Unfortunately, such institutions are still often equipped with weak\ninfrastructure and unreliable security solutions, as the workflow (especially in small, quiet\ntowns or villages without advanced infrastructure) does not require high computing\ncapacities. As a consequence, the locals often don’t bother updating old computers because\nthey appear to still be functioning well. This might be related to a common mistake, whereby\nsecurity updates are associated with design changes or technical developments introduced\nin the software, while their most vital function is in fact closing breaches found by white- or\nblack-hat hackers and security researchers.\n\nAnother popular target was hospitals, accounting for 7% of all attacks. While some blackhat hackers and cybercriminal groups claim to have a code of conduct, in most cases\nattackers are motivated purely by the prospect of financial gain and go for vital services that\ncannot tolerate long periods of disruption, such as medical centers.\n\nFurthermore, around 2% of all institutions subjected to an attack were municipal utility\n**services or their subcontractors. The reason for this might be that such service providers are**\noften used as an entry point to a whole network of devices and organizations, as they are\nresponsible for communications in terms of billing for multiple locations and households. In\nthe scenario where threat actors successfully attack the service provider, they might also\ncompromise every locality that particular vendor or institution services. In addition, the\ndisruption of utility services may result in disruption to vital regular operations, such as\nproviding online payment services for residents of the town or city to pay their monthly bills –\nthis adds to the pressure the victims’ experience and pushes them towards a short-term, yet\nseemingly effective solution – paying the ransom.\n\nLet’s take a closer look at the malware that has been actively used in attacks on\nmunicipalities.\n\n## The besiegers\n\n### Ryuk\n\n\n-----\n\nWhile not all organizations disclose technical details about the ransomware that hits them,\nRyuk ransomware (Detection name: Trojan-Ransom.Win32.Hermez) has been cited as a\nreason for incidents in municipalities noticeavly often. It is known to be notorious for\nattacking large organizations and governmental and municipal networks. This malware first\nappeared in the second half of 2018 and has been mutating and actively propagating\nthroughout 2019.\n\n**Geography**\n\n_[(Download)](https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2020/05/13132029/story-of-the-year-2019-cities-under-ransomware-siege_03-en-ryuk-map.png)_\n\n**TOP 10 countries**\n\nCountries %*\n\n1 Germany 8.60\n\n2 China 7.99\n\n3 Algeria 6.76\n\n4 India 5.84\n\n\n-----\n\n5 Russian Federation 5.22\n\n6 Iran 5.07\n\n7 United States 4.15\n\n8 Kazakhstan 3.38\n\n9 United Arab Emirates 3.23\n\n10 Brazil 3.07\n\n_*Percentage of users attacked in each country by Ryuk, relative to all users attacked_\n_worldwide by this malware_\n\nRyuk has been seen all over the world, although some countries have been affected more\nthan others. According to Kaspersky Security Network statistics, in 8.6% of cases it\nattempted to attack German-based targets, followed by China (8%) and Algeria (6.8%).\n\n**Distribution**\n\nThe threat actors behind Ryuk employ a multi-stage scheme to deliver this ransomware to\ntheir victims.\n\nThe initial stage involves infecting a large number of machines by the Emotet bot (Detection\nname: Trojan-Banker.Win32.Emotet). Typically this is achieved by sending out spam emails\ncontaining a document with a malicious macro that will download the bot if the victim allows\nthe execution of macros.\n\n_Spam message with a malicious document attached_\n\n\n-----\n\n_The malicious document_\n\nAt the second stage of the infection, Emotet will receive a command from its servers to\ndownload and install another piece of malware – Trickbot (verdict: Trojan.Win32.Trickster) –\ninto the compromised system. This piece of malware will allow the threat actors to carry out\nreconnaissance in the compromised network.\n\nIf the criminals find they have infiltrated a high-profile victim, for example, a large municipal\nnetwork, or a corporation, they will likely continue to the third stage of the infection and\ndeploy Ryuk ransomware to numerous nodes in the affected network.\n\n**Brief technical description**\n\nRyuk has been evolving since its creation and there is a certain variation between the\nnumerous samples existing ITW. Some of them are built as 32-bit binaries, others are 64-bit;\nsome variants contain a hardcoded list of processes that will be targeted for code injections,\nother variants allowlist several processes and will try to inject all others; the encryption\nscheme also sometimes differs from one sample to another.\n\nWe will describe one of the recent modifications discovered in late October 2019 (MD5:\nfe8f2f9ad6789c6dba3d1aa2d3a8e404).\n\n\n-----\n\n**File encryption**\nThis modification of Ryuk uses a hybrid encryption scheme employing the AES algorithm to\nencrypt the content of the victim’s files, and the RSA algorithm to encrypt the AES keys.\nRyuk uses the standard implementation of cryptographic routines provided by Microsoft\nCryptoAPI.\n\nThe Trojan sample contains the threat actor’s embedded 2048-bit RSA key. The private\ncounterpart is not exposed and may be used by the criminals for decryption if the ransom is\npaid. For each victim file Ryuk will generate a new unique 256-bit AES key that will be used\nto encrypt the file content. The AES keys are encrypted by RSA and saved at the end of the\nencrypted file.\n\nRyuk encrypts both local drives and network shares. Encrypted files will get an additional\nextension (.RYK), and a ransom note containing the email of the criminals will be saved\nnearby.\n\n_Ransom note_\n\n**Additional functionality**\nTo cause more damage in the network, this Ryuk variant uses a trick that we haven’t\nobserved in other ransomware families before; the Trojan attempts to wake other machines\n\n\n-----\n\nthat are in a sleeping state but have been configured to use Wake-on-LAN.\n\nRyuk does this in order to maximize the attack surface: the files located on network shares\nhosted on sleeping PCs are unavailable for access, but if the Trojan manages to wake them,\nit will be able to encrypt those files as well. To achieve this, Ryuk retrieves the MAC\naddresses of the nearby machines from the local ARP cache of the infected system and\nsends broadcast UDP packets starting with the magic value {0xff, 0xff, 0xff, 0xff, 0xff, 0xff} to\nport 7 which will wake up the targeted computers.\n\n_Fragment of the procedure implementing Wake-on-Lan packet broadcast_\n\n\n-----\n\nOther features of the Ryuk algorithm that are more conventional for ransomware families\ninclude: code injection into legitimate processes in order to avoid detection; attempting to\nterminate processes related to business applications to make the files used by these\nprograms available for modification; attempting to stop various services related both to\nbusiness applications and to security solutions.\n\n### Purga\n\nThis ransomware family appeared in the middle of 2016 and is still being actively developed\nand distributed around the world. It has been recorded targeting municipalities. One of the\nfeatures of this malware is that it attacks regular users as well as large corporations and\neven governmental organizations. Our products detect this malware as TrojanRansom.Win32.Purga. The Trojan family is also known as Globe, Amnesia or Scarab\nransomware.\n\n**Geography**\n\n_[(Download)](https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2020/05/13132036/story-of-the-year-2019-cities-under-ransomware-siege_04-en-ryuk-map.png)_\n\n**TOP 10 countries**\n\n\n-----\n\nCountries %*\n\n1 Russian Federation 85.59\n\n2 Belarus 1.37\n\n3 Turkey 0.85\n\n4 India 0.80\n\n5 Kazakhstan 0.74\n\n6 Germany 0.62\n\n7 Ukraine 0.54\n\n8 China 0.46\n\n9 Algeria 0.40\n\n10 United Arab Emirates 0.40\n\n_*Percentage of users attacked in each country by Purga, relative to all users attacked_\n_worldwide by this malware_\n\n**Distribution**\nThroughout this family’s existence, the criminals behind it have used various types of\ninfection vectors. The main attack vectors are spam campaigns and RDP brute-force attacks.\n\nAccording to our information, this is currently the most common attack scenario:\n\n1. The criminals scan the network to find an open RDP port\n2. They try to brute-force credentials to log in to the targeted machine\n3. After a successful login, the criminals try to elevate privileges using various exploits\n4. The criminals launch the ransomware\n\n**Brief technical description**\nPurga ransomware is an example of very intensively developed ransomware. Over the last\ncouple of years, the criminals have changed several encryption algorithms, key generation\nfunctions, cryptographically schemes and so on.\n\nHere we will briefly describe the latest modification.\n\nNaming scheme:\nEach modification of Purga uses a different extension for each file and a different email\naddress to contact. Despite using various extensions for the encrypted files, the Trojan uses\nonly two naming schemes, which depend on its configuration:\n\n\n-----\n\n1. [original file name].[original extension].[new extension]\n\n2. [encrypted file name].[new extension]\n\n**File encryption**\nDuring encryption the Trojan uses a standard scheme that combines symmetric and\nasymmetric algorithms. Each file is encrypted using a randomly generated symmetric key,\nthen this symmetric key is encrypted with an asymmetric key and the result is stored in the\nfile, in a specifically built structure.\n\n### Stop\n\nThe notorious Stop ransomware (also known as Djvu STOP) was first encountered at the\nend of the 2018. Our detection name for this family is Trojan-Ransom.Win32.Stop and,\naccording to our statistics, in 2019 alone the various modifications of Stop ransomware\nattacked more than 20,000 victims around the world. Unsurprisingly, according to our KSN\nreport for the third quarter of 2019, Stop ransomware finished seventh among the most\ncommon ransomware.\n\n**Geography**\n\n\n-----\n\n_[(Download)](https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2020/05/13132043/story-of-the-year-2019-cities-under-ransomware-siege_05-en-stop-map.png)_\n\n\n**TOP 10 countries**\n\nCountries %*\n\n1 Vietnam 10.28\n\n2 India 10.10\n\n3 Brazil 7.90\n\n4 Algeria 5.31\n\n5 Egypt 4.89\n\n6 Indonesia 4.59\n\n7 Turkey 4.30\n\n8 Morocco 2.42\n\n9 Bangladesh 2.25\n\n\n-----\n\n10 Mexico 2.09\n\n_*Percentage of unique users attacked in each country by Stop, relative to all users attacked_\n_worldwide by this malware_\n\n**Distribution**\n\nThe authors chose to distribute their malware primarily through software installers. When\nusers try to download specific software from an untrusted site or try to use software cracks,\ninstead of the desired result their machines become infected by the ransomware.\n\n**Brief technical description**\n\nFor file encryption, Stop ransomware uses a randomly generated Salsa20 key, which is then\nencrypted by a public RSA key.\n\n_Fragment of code from the file encryption routine_\n\nDepending on the availability of the C&C server, Stop ransomware uses either an online or\noffline RSA key. The offline public RSA key can be found in the configuration of each\nmalicious sample.\n\n_Dumped fragment of the malware_\n\n\n-----\n\n## Conclusion and recommendations\n\n2019 has been a year of ransomware attacks on municipalities, and this trend is likely to\ncontinue in 2020. There are various reasons why the number of attacks on municipalities is\nincreasing.\n\nFirst of all, the cybersecurity budgeting of municipalities is often more focused on insurance\nand emergency response than on proactive defense measures. This results in cases where\nthe only possible solution is to pay the criminals and facilitate their activities.\nSecondly, municipal services often have numerous networks that include multiple\norganizations, so hitting them causes disruption on many levels at the same time, bringing\nprocesses across entire districts to a halt.\n\nWhat’s more, the data stored in municipal networks is often vital for the functioning of\neveryday processes, as it directly concerns the welfare of citizens and local organizations.\nBy striking such targets, cybercriminals are hitting a sensitive spot.\n\n**However, simple preventive measures can help combat the epidemic:**\n\nIt is essential to install all security updates as soon as they appear. Most cyberattacks\nexploit vulnerabilities that have already been reported and addressed, so installing the\nlatest security updates lowers the chances of an attack.\nProtect remote access to corporate networks by VPN and use secure passwords for\ndomain accounts.\nAlways update your operating system to eliminate recent vulnerabilities and use a\nrobust security solution with updated databases.\nAlways have fresh back-up copies of your files so you can replace them in case they\nare lost (e.g. due to malware or a broken device) and store them not only on a physical\nmedium but also in the cloud for greater reliability.\nRemember that ransomware is a criminal offence. You shouldn’t pay a ransom. If you\nbecome a victim, report it to your local law enforcement agency. Try to find a decryptor\non the internet first – some of them are available for free here:\n[https://noransom.kaspersky.com](https://noransom.kaspersky.com/)\nEducating employees about cybersecurity hygiene is necessary to prevent attacks from\n[happening in the first place. Kaspersky Interactive Protection Simulation Games offer a](https://www.kaspersky.com/enterprise-security/security-awareness)\nspecial scenario that focuses on threats relevant to local public administration.\nUse a security solution for organizations in order to protect business data from\n[ransomware. Kaspersky Endpoint Security for Business has behavior detection,](https://www.kaspersky.com/small-to-medium-business-security/endpoint-advanced)\nanomaly control and exploit prevention capabilities that detect known and unknown\nthreats and prevent malicious activity. A preferred third-party security solution can also\n[be enhanced with the free Kaspersky Anti-Ransomware Tool.](https://www.kaspersky.com/anti-ransomware-tool)\n\n[Malware Descriptions](https://securelist.com/tag/malware-descriptions/)\n[Malware Statistics](https://securelist.com/tag/malware-statistics/)\n\n\n-----\n\n[Ransomware](https://securelist.com/tag/ransomware/)\n[Smart city](https://securelist.com/tag/smart-city/)\n\nAuthors\n\nKaspersky\n\nStory of the year 2019: Cities under ransomware siege\n\nYour email address will not be published. Required fields are marked *\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2019/2019-12-11 - Story of the year 2019- Cities under ransomware siege.pdf"
    ],
    "report_names": [
        "2019-12-11 - Story of the year 2019- Cities under ransomware siege.pdf"
    ],
    "threat_actors": [
        {
            "id": "e7d03ac8-7d6f-4ea0-83a9-10dff2ea1486",
            "created_at": "2022-10-25T16:07:24.158325Z",
            "updated_at": "2025-03-27T02:02:10.127249Z",
            "deleted_at": null,
            "main_name": "Scarab",
            "aliases": [
                "UAC-0026"
            ],
            "source_name": "ETDA:Scarab",
            "tools": [
                "Scieron"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "9099912b-a00a-4afb-8294-c6d35af421a1",
            "created_at": "2023-01-06T13:46:39.338108Z",
            "updated_at": "2025-03-27T02:00:03.054726Z",
            "deleted_at": null,
            "main_name": "Scarab",
            "aliases": [],
            "source_name": "MISPGALAXY:Scarab",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673536121,
    "ts_updated_at": 1743041614,
    "ts_creation_date": 1653709509,
    "ts_modification_date": 1653709509,
    "files": {
        "pdf": "https://archive.orkl.eu/ce8198a4a45b2601cca5feda50bc90052f839d78.pdf",
        "text": "https://archive.orkl.eu/ce8198a4a45b2601cca5feda50bc90052f839d78.txt",
        "img": "https://archive.orkl.eu/ce8198a4a45b2601cca5feda50bc90052f839d78.jpg"
    }
}