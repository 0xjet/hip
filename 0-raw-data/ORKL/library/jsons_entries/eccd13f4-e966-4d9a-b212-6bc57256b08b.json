{
    "id": "eccd13f4-e966-4d9a-b212-6bc57256b08b",
    "created_at": "2023-01-12T15:02:42.074459Z",
    "updated_at": "2025-03-27T02:08:00.311317Z",
    "deleted_at": null,
    "sha1_hash": "1b63220d85b51cf55bfd556233bc4f1e7811063e",
    "title": "2018-07-24 - Kronos Reborn",
    "authors": "",
    "file_creation_date": "2022-05-28T19:51:09Z",
    "file_modification_date": "2022-05-28T19:51:09Z",
    "file_size": 4655711,
    "plain_text": "# Kronos Reborn\n\n**proofpoint.com/us/threat-insight/post/kronos-reborn**\n\n\nJuly 24, 2018\n\n\n-----\n\n[Blog](https://www.proofpoint.com/us/blog)\n[Threat Insight](https://www.proofpoint.com/us/blog/threat-insight)\nKronos Reborn\n\n\n-----\n\nJuly 24, 2018 Proofpoint Staff\n\n**Overview**\n\nThe Kronos banking Trojan was first discovered in 2014 [1] and was a steady fixture in the threat landscape for a\nfew years before largely disappearing. Now a new variant has appeared, with at least three distinct campaigns\ntargeting Germany, Japan, and Poland respectively, to date.\n\nIn April 2018, the first samples of a new variant of the banking Trojan appeared in the wild [2]. The most notable\nnew feature is that the command and control (C&C) mechanism has been refactored to use the Tor anonymizing\nnetwork. There is some speculation and circumstantial evidence suggesting that this new version of Kronos has\nbeen rebranded “Osiris” and is being sold on underground markets. In this blog, we present information on the\nGerman, Japanese, and Polish campaigns as well as a fourth campaign that looks to be a work in progress and\nstill being tested.\n\n**Campaign Analysis**\n\n_Campaign targeting Germany, June 27-30, 2018_\n\nIn June 27, 2018, we observed an email campaign targeting German users with malicious documents. The\nmessages (Figure 1) were purportedly sent from German financial companies and contained subjects such as:\n\nAktualisierung unsere AGBs (translated: “Updating our terms and conditions”)\nMahnung: 9415166 (translated: “Reminder: 9415166”)\n\nThe attached documents had a similar theme with file names such as:\n\nagb_9415166.doc\nMahnung_9415167.doc\n\n\n-----\n\n_Figure 1: Example email used in the German campaign_\n\nThe Word documents contained macros that, if enabled, downloaded and executed a new variant of the Kronos\nbanking Trojan. In some cases, the attack used an intermediate Smoke Loader. Kronos was configured to use\nhttp://jhrppbnh4d674kzh[.]onion/kpanel/connect.php as its C&C URL and downloaded webinjects targeting five\nGerman financial institutions. Figure 2 shows an example webinject.\n\n\n-----\n\n_Figure 2: Example webinject from the German campaign_\n\n_Campaign targeting Japan, July 13, 2018_\n\nBased on a tweet [3] from a security researcher, we investigated a malvertising chain sending victims to a site\ncontaining malicious JavaScript injections. This JavaScript redirected victims to the RIG exploit kit, which was\ndistributing the SmokeLoader downloader malware. The C&Cs for this downloader were:\n\nhxxp://lionoi.adygeya[.]su\nhxxp://milliaoin[.]info\n\nBased on our previous tracking of the threat actor involved in this campaign, we expected to see the chain deliver\nthe Zeus Panda banking Trojan (Figure 3). However, in this case, the final payload was the new version of Kronos\n(Figure 4).\n\n\n-----\n\n_Figure 3: Previous campaigns distributing SmokeLoader and Zeus Panda for this threat actor_\n\n_Figure 4: New Kronos campaign from this threat actor on July 14_\n\nIn this campaign, Kronos was configured to use http://jmjp2l7yqgaj5xvv[.]onion/kpanel/connect.php as its C&C and\nits webinjects were targeting thirteen Japanese financial institutions. Figure 5 shows an example webinject from\nthis campaign.\n\n\n-----\n\n_Figure 5: Example webinject from the Japanese campaign_\n\n_Campaign targeting Poland, July 15-16, 2018_\n\nStarting on July 15, 2018, we observed an email campaign targeting users in Poland with malicious documents.\nThe messages used subjects related to fake invoices, such as “Faktura 2018.07.16”, and contained an attachment\nnamed “faktura 2018.07.16.doc” (Figure 6). The document used CVE-2017-11882 (the “Equation Editor” exploit) to\ndownload and execute the new version of Kronos from http://mysit[.]space/123//v/0jLHzUW.\n\n_Figure 6: Example of malicious document used in the Polish campaign_\n\nThis instance of Kronos was configured to use http://suzfjfguuis326qw[.]onion/kpanel/connect.php as its C&C; at\nthe time of this research it was not returning any webinjects.\n\n_“Work in progress” campaign, July 20, 2018_\n\n\n-----\n\nOn July 20, 2018, we observed a new campaign that looked be a work in progress and still being tested. We are\nnot yet aware of the exact vector for this campaign but this instance of Kronos is configured to use\nhxxp://mysmo35wlwhrkeez[.]onion/kpanel/connect.php as its C&C and could be downloaded by clicking on the\n“GET IT NOW” button of a website claiming to be a streaming music player (Figure 7).\n\n_Figure 7: Website distributing new version of Kronos in “Work in progress” campaign_\n\nAt the time of research, this campaign was using a test webinject shown in Figure 8.\n\n_Figure 8: Webinject used in “Work in progress” campaign_\n\n\n-----\n\n**Malware Analysis**\n\nKronos malware has been well-documented previously ([4] [5] [6] [7]). It is a banking Trojan that uses man-in-thebrowser techniques along with webinject rules to modify the web pages of financial institutions, facilitating the theft\nof user credentials, account information, other user information, and money through fraudulent transactions. It also\nhas keylogging and hidden VNC functionality to help with its “banker” activities.\n\nThe new 2018 version shares many similarities with older versions:\n\nExtensive code overlap\nSame Windows API hashing technique and hashes\nSame string encryption technique\nExtensive string overlap\nSame C&C encryption mechanism\nSame C&C protocol and encryption\nSame webinject format (Zeus format)\nSimilar C&C panel file layout\n\nPerhaps the most telling sign that the new malware is Kronos is that it still includes a self-identifying string (Figure\n9).\n\n_Figure 9: Self-identifying Kronos string_\n\nOne of the major differences between the new and old versions is the use of .onion C&C URLs along with Tor to\nhelp anonymize communications. C&Cs are stored encrypted (Figure 10) and can be decrypted using the process\nshown in Figure 11.\n\n\n-----\n\n_Figure 10: Encrypted C&Cs_\n\n_Figure 11: Example of C&C decryption using Python_\n\n**Osiris Banking Trojan**\n\nAround the same time samples of the new version of Kronos were appearing in the wild, an ad for a new banking\nTrojan called “Osiris” (the Egyptian god of rebirth, among others) appeared on an underground hacking forum\n(Figure 12).\n\n\n-----\n\n_Figure 12: Text from an ad for the Osiris banking Trojan_\n\nSome of the features highlighted in the ad (written in C++, banking Trojan, uses Tor, has form grabbing and\nkeylogger functionality, and uses Zeus-formatted webinjects) overlap with features we observed in this new version\nof Kronos.\n\nThe ad mentions the size of the bot to be 350 KB which is very close to the size (351 KB) of an early, unpacked\nsample of the new version of Kronos we found in the wild [8]. This sample was also named “os.exe” which may be\nshort for “Osiris”.\n\nAdditionally, some file names used in the Japanese campaign discussed above made reference to the same\nname:\n\nhxxp://fritsy83[.]website/Osiris.exe\nhxxp://oo00mika84[.]website/Osiris_jmjp_auto2_noinj.exe\n\nWhile these connections are speculative, they are something to keep in mind as research into this threat\ncontinues.\n\n**Conclusion**\n\nThe reappearance of a successful and fairly high-profile banking Trojan, Kronos, is consistent with the increased\nprevalence of bankers across the threat landscape. The first half of this year has been marked by substantial\ndiversity among malicious email campaigns but banking Trojans in particular have predominated. The Kronos\nbanking Trojan has a relatively long and interesting history and it looks like it will continue as a fixture in the threat\nlandscape for now. This post was an overview of a new version of the malware that has emerged recently, the\nprimary new feature of which is the use of Tor. While there is significant evidence that this malware is a new\nversion or variant of Kronos, there is also some circumstantial evidence suggesting it has been rebranded and is\nbeing sold as the Osiris banking Trojan.\n\n**References**\n\n[1] [https://securityintelligence.com/the-father-of-zeus-kronos-malware-discovered/](https://securityintelligence.com/the-father-of-zeus-kronos-malware-discovered/)\n\n\n-----\n\n[2] [https://twitter.com/tildedennis/status/982354212695584768](https://twitter.com/tildedennis/status/982354212695584768)\n\n[3] [https://twitter.com/nao_sec/status/1017810198931517440](https://twitter.com/nao_sec/status/1017810198931517440)\n\n[4] [https://www.lexsi.com/securityhub/overview-kronos-banking-malware-rootkit/?lang=en](https://www.lexsi.com/securityhub/overview-kronos-banking-malware-rootkit/?lang=en)\n\n[5] [https://www.lexsi.com/securityhub/kronos-decrypting-the-configuration-file-and-injects/?lang=en](https://www.lexsi.com/securityhub/kronos-decrypting-the-configuration-file-and-injects/?lang=en)\n\n[6] [https://blog.malwarebytes.com/cybercrime/2017/08/inside-kronos-malware/](https://blog.malwarebytes.com/cybercrime/2017/08/inside-kronos-malware/)\n\n[7] [https://blog.malwarebytes.com/cybercrime/2017/08/inside-kronos-malware-p2/](https://blog.malwarebytes.com/cybercrime/2017/08/inside-kronos-malware-p2/)\n\n[8]\nhttps://www.virustotal.com/en/file/e1347d1353775c4b18dc83fbf22f7ba248e1a27f255d7487782dc6f9fee0607d/anal\nysis/\n\n**Indicators of Compromise (IOCs)**\n\n\n**IOC** **IOC**\n**Type**\n\n\n**Description**\n\n\nbb308bf53944e0c7c74695095169363d1323fe9ce6c6117feda2ee429ebf530d SHA256 Mahnung_9415171.doc\nused in German\ncampaign\n\nhttps://dkb-agbs[.]com/25062018.exe URL Mahnung_9415171.doc\npayload used in\nGerman campaign\n\n4af17e81e9badf3d03572e808e0a881f6c61969157052903cd68962b9e084177 SHA256 New version of Kronos\nused in German\ncampaign\n\nhttp://jhrppbnh4d674kzh[.]onion/kpanel/connect.php URL Kronos C&C used in\nGerman campaign\n\nhttps://startupbulawayo[.]website/d03ohi2e3232/ URL Webinject C&C used in\nthe German campaign\n\nhttp://envirodry[.]ca URL Contains malicious\nredirect to RIG EK used\nin the Japan campaign\n\n5[.]23[.]54[.]158 IP RIG EK used in the\nJapan campaign\n\n3cc154a1ea3070d008c9210d31364246889a61b77ed92b733c5bf7f81e774c40 SHA256 SmokeLoader used in\nthe Japan campaign\n\nhttp://lionoi.adygeya[.]su URL SmokeLoader C&C\nused in the Japan\ncampaign\n\n\n-----\n\nhttp://milliaoin[.]info URL SmokeLoader C&C\nused in the Japan\ncampaign\n\nhttp://fritsy83[.]website/Osiris.exe URL New version of Kronos\ndownload link used in\nthe Japan campaign\n\nhttp://oo00mika84[.]website/Osiris_jmjp_auto2_noinj.exe URL New version of Kronos\ndownload link used in\nthe Japan campaign\n\n3eb389ea6d4882b0d4a613dba89a04f4c454448ff7a60a282986bdded6750741 SHA256 New version of Kronos\nused in the Japan\ncampaign\n\nhttp://jmjp2l7yqgaj5xvv[.]onion/kpanel/connect.php URL Kronos C&C used in\nthe Japan campaign\n\nhttps://kioxixu.abkhazia[.]su/ URL Webinject C&C used in\nthe Japan campaign\n\n045acd6de0321223ff1f1c579c03ea47a6abd32b11d01874d1723b48525c9108 SHA256 “Faktura\n2018.07.16.doc” used\nin the Poland campaign\n\nhttp://mysit[.]space/123//v/0jLHzUW URL New version of Kronos\ndownload link used in\nthe Poland campaign\n\ne7d3181ef643d77bb33fe328d1ea58f512b4f27c8e6ed71935a2e7548f2facc0 SHA256 New version of Kronos\nused in the Poland\ncampaign\n\nhttp://suzfjfguuis326qw[.]onion/kpanel/connect.php URL Kronos C&C used in\nthe Poland campaign\n\nhttp://gameboosts[.]net/app/Player_v1.02.exe URL New version of Kronos\ndownload link used in\n“Work in progress”\ncampaign\n\n93590cb4e88a5f779c5b062c9ade75f9a5239cd11b3deafb749346620c5e1218 SHA256 New version of Kronos\nused in “Work in\nprogress” campaign\n\nhttp://mysmo35wlwhrkeez[.]onion/kpanel/connect.php URL Kronos C&C used in\n“Work in progress”\ncampaign\n\nSubscribe to the Proofpoint Blog\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2018/2018-07-24 - Kronos Reborn.pdf"
    ],
    "report_names": [
        "2018-07-24 - Kronos Reborn.pdf"
    ],
    "threat_actors": [
        {
            "id": "b740943a-da51-4133-855b-df29822531ea",
            "created_at": "2022-10-25T15:50:23.604126Z",
            "updated_at": "2025-03-27T02:00:55.505366Z",
            "deleted_at": null,
            "main_name": "Equation",
            "aliases": [
                "Equation"
            ],
            "source_name": "MITRE:Equation",
            "tools": null,
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1673535762,
    "ts_updated_at": 1743041280,
    "ts_creation_date": 1653767469,
    "ts_modification_date": 1653767469,
    "files": {
        "pdf": "https://archive.orkl.eu/1b63220d85b51cf55bfd556233bc4f1e7811063e.pdf",
        "text": "https://archive.orkl.eu/1b63220d85b51cf55bfd556233bc4f1e7811063e.txt",
        "img": "https://archive.orkl.eu/1b63220d85b51cf55bfd556233bc4f1e7811063e.jpg"
    }
}