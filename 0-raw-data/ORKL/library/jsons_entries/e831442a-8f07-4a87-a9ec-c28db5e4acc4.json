{
    "id": "e831442a-8f07-4a87-a9ec-c28db5e4acc4",
    "created_at": "2023-01-12T15:09:36.374088Z",
    "updated_at": "2025-03-27T02:05:24.65134Z",
    "deleted_at": null,
    "sha1_hash": "82cc3b072928addd2a832a5eeab444a9c54c68f4",
    "title": "2022-02-21 - Ousaban MSI Installer Analysis",
    "authors": "",
    "file_creation_date": "2022-05-29T10:35:58Z",
    "file_modification_date": "2022-05-29T10:35:58Z",
    "file_size": 563756,
    "plain_text": "# Ousaban MSI Installer Analysis\n\n**[atomicmatryoshka.com/post/ousaban-msi-installer-analysis](https://www.atomicmatryoshka.com/post/ousaban-msi-installer-analysis)**\n\nz3r0day_504 February 21, 2022\n\nIn this blog post, I'll provide some cursory coverage on Ousaban and its initial stage via a\nMicrosoft Installer (MSI) file.\n\nOusaban is a Latin American banking trojan that's been affecting users for the last few years,\nprimarily across Brazil. According to research from ESET, the way the malware works is the\nMSI will reach out and download the actual Ousaban payload, which will then be side-loaded\ninto a legitimate application to conduct its credential stealing.\n\nBelow I have an image of what the MSI shows in PeStudio, showing a plethora of exports:\n\nI passed the file over to REMnux and did a generic strings check to see if any of the C2\ndomains were hardcoded in the file. Nothing stood out as conclusive at this point.\n\n\n-----\n\nDynamic analysis followed with detonation of the sample, which resulted in the following\ndialog boxes. I infer that the error message occurred due to either VM detection or an\ninability to establish communications with its C2 server.\n\nWireshark and FakeDNS both showed this domain. We didn't see this in the initial analysis,\nwhich leads me to believe that it was dynamically generated at runtime:\n\n\n-----\n\nResearching the domain on VirusTotal, we see that it has several malicious hits and also that\nit was generated only 6 days prior to this research taking place. The sample was submitted\nto MalwareBazaar 2 days after the domain was registered.\n\nI briefly want to highlight a tool and a peer in the community who's research brought my\nattention to it. Tony Lambert recently posted about msitools, a suite of tools available to\nanalyze specimens just like the one I've touched on in this blog post. After my initial\nresearch, I decided to download the package and give it a go.\n\nI ran msiinfo on the specimen, which gives the analyst information on the contents of the\ninstaller package:\n\n\n-----\n\n[I look for the CustomAction table which, per Tony's phenomenal blog post, is where a lot of](https://forensicitguy.github.io/analyzing-stealer-msi-using-msitools/)\nmalware developers will hide their malicious code when working with MSI's. Sure enough, I\nran msidump to dump the file and then analyzed the CustomAction table...\n\n...and we see what looks like obfuscated code! I copy this text and plug it into CyberChef and\nselect \"From Charcode\" as my recipe:\n\n\n-----\n\nThere we can not only see the URL I identified during my dynamic analysis, but also the file\nthe installer would attempt to download (AW24RT4T56Y76U788I80909.zip). Additionally,\nfurther down we see some indication that it may try to write to the \"Saved Games\" directory\nas well as references to WMIC with calls to launch a program:\n\n\n-----\n\nTo conclude this cursory analysis, I leave you with this humorous reference in the code to\n\"JimmyNeltronFPS\", which lines up with the file being written to \"Saved Games.\" Granted,\nthis is only a function name in the code but regardless, great:\n\n## IOCs\n\n\n-----\n\nDomains:\n\nwschyoilnet[.]com\n\nFile hash: 0ed6d539365305787d1625bf6462c93dbd02af768970b6d05f8ca5c6ff2e1b3d\n\nFile name downloaded from domain: AW24RT4T56Y76U788I80909.zip\n\nReferences\n\n[ESET research into Latin American trojans](https://www.eset.com/int/about/newsroom/press-releases/research/eset-research-into-latin-american-banking-trojans-continues-bold-ousaban-steals-credentials-with-ob/)\n\n[Microsoft documentation - Windows Installer](https://docs.microsoft.com/en-us/windows/win32/msi/windows-installer-portal)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-02-21 - Ousaban MSI Installer Analysis.pdf"
    ],
    "report_names": [
        "2022-02-21 - Ousaban MSI Installer Analysis.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673536176,
    "ts_updated_at": 1743041124,
    "ts_creation_date": 1653820558,
    "ts_modification_date": 1653820558,
    "files": {
        "pdf": "https://archive.orkl.eu/82cc3b072928addd2a832a5eeab444a9c54c68f4.pdf",
        "text": "https://archive.orkl.eu/82cc3b072928addd2a832a5eeab444a9c54c68f4.txt",
        "img": "https://archive.orkl.eu/82cc3b072928addd2a832a5eeab444a9c54c68f4.jpg"
    }
}