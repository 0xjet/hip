{
    "id": "bbc54a90-155c-4854-8987-c922dc680cce",
    "created_at": "2022-10-25T16:48:20.035141Z",
    "updated_at": "2025-03-27T02:16:26.333265Z",
    "deleted_at": null,
    "sha1_hash": "0402511221158a29056e8ec6f9337fe40fec18c7",
    "title": "",
    "authors": "",
    "file_creation_date": "2019-03-14T07:26:48Z",
    "file_modification_date": "2019-03-14T07:26:48Z",
    "file_size": 1586856,
    "plain_text": "# Operation Sheep: Pilfer Analytics SDK in Action\n\n**[research.checkpoint.com/operation-sheep-pilfer-analytics-sdk-in-action](https://research.checkpoint.com/operation-sheep-pilfer-analytics-sdk-in-action/)**\n\nMarch 13, 2019\n**Research by: Feixiang He, Andrey Polkovnichenko**\n\n\nMarch 13, 2019\n\n\nCheck Point Research has recently discovered a group of Android applications massively\nharvesting contact information on mobile phones without the user’s consent. The data\nstealing logic hides inside a data analytics Software Development Kit (SDK) seen in up to\n12 different mobile applications and has so far been downloaded over 111 million times.\n\nDubbed ‘Operation Sheep’, this massive data stealing campaign is the first known\ncampaign seen in the wild to exploit the [Man-in-the-Disk vulnerability revealed by Check](https://research.checkpoint.com/androids-man-in-the-disk/)\nPoint Research earlier last year.\n\n**The Attack Vector**\n\nThe SDK, named SWAnalytics, is integrated into seemingly innocent Android applications\npublished on major 3 party Chinese app stores such as Tencent MyApp, Wandoujia,rd\nHuawei App Store, and Xiaomi App Store. After app installation, whenever SWAnalytics\nsenses victims opening up infected applications or rebooting their phones, it silently\nuploads their entire contacts list to Hangzhou Shun Wang Technologies controlled servers.\n\nFrom our first malicious sample encounter back in mid-September until now, we have\nobserved 12 infected applications, the majority of which are in the system utility category.\nIn the Tencent MyApp store alone, 8 of 12 infected applications have a staggering total\nnumber of over 111 million downloads. In theory, Shun Wang Technologies could have\ncollected a third of China’s population names and contact numbers if not more.\n\n\n-----\n\nsuch data could circulate into underground markets for further exploit, ranging from rogue\nmarketing, targeted telephone scams or even friend referral program abuse during\nNovember’s Single’s Day and December’s Asian online shopping fest.\n\nThis paper will cover the discovery of this campaign, dubbed ‘Operation Sheep’, and an\nanalysis of SWAnalytics. We will also discuss the value of contact data from a cyber\ncriminal’s perspective, and assess the fallout effect of Operation Sheep on the global\nmobile data security landscape.\n\n**Operation Sheep’s Attack Flow**\n\n**Emergence of the Attack**\n\nIn mid-September, an app named ‘Network Speed Master’ stood out on our radar with its\nrather unusual behavior patterns. Upon initial analysis, we observed frequent access to\nthe user’s contacts data together with a sudden network transmission surge when the app\nis opened or the mobile phone is rebooted. As a system utility application that simply tests\nnetwork connection speed, it reaches far beyond reasonable actions. Deeply intrigued, we\ntook a closer look.\n\n**Figure 1: ‘Network Speed Master’ on Tencent MyApp**\n\nWe began with the app’s long Android permissions requirement, which usually signals\nexcessive data collection.\n\n\n-----\n\n**Figure 2: The Android permissions Network Speed Master asks for**\n\nAlthough it is worrying to see that most of the permissions were not related to the app’s\nmain features, it was still too early to conclude that Network Speed Master is a malware in\nand of itself.\n\nAlthough, many legitimate advertisement SDKs rely on bespoke permissions to profile\nusers in order to study user preferences and promote personalized advertisement content,\nwe became much more skeptical when the “CoreReceiver” module appeared in the app’s\nmanifest. This module monitors a wide range of device activities including application\ninstallation / remove / update, phone restart and battery charge.\n\n\n-----\n\nFollowing the user contacts data flow, we quickly landed on the actual contact data\nstealing module.\n\nIt indeed dumps the user’s entire contact list in a name-number pair format (e.g. “John\nOliver: 1234567890”), concatenates pairs into a giant string, and then finally sends it out to\na remote server.\n\nExamining user contacts to understand a user’s social network is a popular marketing\nresearch method found in many advertisement SDKs. In order to protect user privacy,\nhowever, a legitimate SDK usually only collects contact names or numbers. Some even\nadopt a cryptographic approach to generate unique hash of name-number combinations\nso that the actual data is not collected at all.\n\nMassively uploading identifiable contact details, though, is unacceptable and in many\ncountries constitutes a violation of data privacy regulations.\n\n**The Exception to the Rule**\n\nInterestingly, the SDK developer seems to ignore old Android devices below Marshmallow\non purpose. According to Google, Android Marshmallow and above represent 70% of\nAndroid devices. From an operational perspective, it seems to be a time and money\nsaving trade-off that SWAnalytics made by avoiding to prolong compatibility support in\norder to keep its malicious code simple.\n\nFurthermore, we also observed a mysterious data stealing exemption. If it is a Meitu\nPhone, SWAnalytics will not collect the user’s contacts data at all.\n\n**Network Speed Master’s Code**\n\nUpon establishing its malicious nature, we expanded our analysis scope to Network\nSpeed Master’s overall code base.\n\n\n-----\n\n**Figure 4: The user contacts stealing code which interestingly only targets newer Androids.**\n\nIt turns out that contacts data isn’t the only unusual data SWAnalytics is interested in.\nSWAnalytics also has a “smart” approach to collect the user’s QQ login data. (QQ is one\nof most popular instant messaging application in China. Both QQ and WeChat belong to\nTencent.)\n\n**Figure 5: Entry of data stealing code with Meitu phone exemption**\n\n**The Man-in-the-Disk Connection**\n\nWith default settings, SWAnalytics will scan through an Android device’s external storage,\nlooking for directory “tencent/MobileQQ/WebViewCheck”. This folder hosts QQ login data\nchache. By listing sub-folders, SWAnalytics is able to infer QQ accounts which have never\nbeen used on the device.\n\nIn [Slava Makkaveev’s Man-in-the-Disk research, he discussed the risk of hosting sensitive](https://research.checkpoint.com/androids-man-in-the-disk/)\napplication data in publicly accessible external storage. Operation Sheep is the first\ncampaign we have observed in the wild that abuses similar concept since our MitD\n\n\n-----\n\n**Figure 6: Code to scan QQ login details**\n\nTo make this data harvesting operation flexible, SWAnalytics equips the ability to receive\nand process configuration files from a remote Command-and-Control server. Whenever\nusers reboot their device or open up Network Speed Master, SWAnalytics will fetch the\nlatest configuration file from “http[:]//mbl[.]shunwang[.]com/cfg/config[.]json”.\n\n**Figure 7: The latest configuration file from the C&C server**\n\n“gps_timeout” defines the time interval (in milliseconds) between the device’s GPS\ncoordinates tracking attempts. Currently it leaks user geolocation every five seconds,\nwhich is a concerning behavior. “system_app” is a Boolean value which can be either 0\n(false, do not include system applications in the device application list and send to C&C\nserver) or 1 (true, include system applications). “info_address” is the directory\nSWAnalytics uses to search for QQ login details. “bs_time” defines time interval in\nseconds to leak all captured device data. It is also the check interval to make sure the data\nstealing process is alive. Currently, the data stealing process wakes up every 15 minutes.\n\n\n-----\n\n**Figure 8: the code to process the configuration file fetched from C&C server**\n\nThe final part of Operation Sheep is to send data to Shun Wang’s C&C servers. Given the\nvast amount of data SWAnalytics leaks, it breaks down messages to C&C servers into five\ncategories denoted by four digit numbers:\n\n\n**Message**\n**code**\n\n\n**Usage**\n\n\n1001 Device information including geo-location, MAC address, installed application list,\nphone brand and model\n\n1002 User contacts and QQ login list\n\n1003 Current running applications\n\n1005 UMENG_KEY (popular Chinese advertisement SDK Umeng) heartbeat\n\n1006 Running process list and PID (process ID)\n\nEach data message sent to the C&C server follows the format of:\n\nTo make sure the data is only readable to Shun Wang servers, SWAnalytics applies DES\nencryption twice. It uses the master encryption key “#dc?*-y1” to encrypt data before it’s\nsent to C&C server. In order to hide the master key, SWAnalytics uses another hard-coded\npasscode “123456” to encrypt its master key.\n\n**Figure 9: master key encryption**\n\n\n-----\n\n**Figure 10: data transmission encryption**\n\n**The Hunt**\n\nUpon concluding Network Speed Master’s malicious behaviors, it was time to look for the\nbig picture. During several months of investigation and continuous monitoring, we\ndiscovered 12 applications infested with SWAnalytics published in various channels.\n\nBecause of the high segmentation of Android application publishing channels in China,\nthis table is not an exhaustive list. Our research looked into 360 Qihoo Appstore, Baidu\nAppstore, Huawei Appstore, Tencent MyApp, Wandoujia, and Xiaomi Appstore. By the\ntime of this publication, there’s no sign indicating SWAnalytics has penetrated Google Play\nyet.\n\n**App name** **Package name** **Developer** **Major publish channels** **Confirmed in‐**\n**fested version**\n\n\nIncoming\nCall\nFlashlight\n\n\ncom.hd.fly.flashlight Hangzhou\nHui Mao\n\n\nNetwork\nSpeed\nMaster\n\n\ncom.syezon.lab.net‐\nworkspeed\n\n\nHangzhou\nSyezon\n\n\nBattery\nDoctor\n\n\ncom.isyezon.kbattery‐\ndoctor\n\n\nHangzhou\nSyezon\n\n\nAll 6 stores 2.3.1 to 2.3.4\n\nAll 6 stores 2.7.7 to latest\n\nAll 6 stores 1.3.7 to 1.3.9.\n\n\nWi-Fi Pass‐\nword Key\n\n\nAll except Huawei and\nXiaomi\n\n\n1.2.8 to 1.3.1\n\n\nWi-Fi Signal\nAmplifier\n\n\ncom.syezon.wifikey Hangzhou\nSyezon\n\ncom.syezon.wifi Hangzhou\nSyezon\n\n\nAll 6 stores 3.7.0 to 3.7.5\n\n\nSyoo Video com.syoogame.yangba Hangzhou\nShun Wang\n\n\nAll except Baidu and\nXiaomi\n\n\n2.6.5 to latest\n\n\nSuper Bat‐\ntery Charge\n\n\ncom.hodanet.charge Hangzhou\nHodanet\n\n\nAll except 360 and Xiaomi 2.3.6 to latest\n\n\n-----\n\ning\n\n(and 2\nvariants)\n\n\nearme.gamecenter\n\ncom.hzfy.kldwby.mi\n\ncom.hzfy.kldw‐\nby.huawei\n\n\nFuyun Wang website\n\n\n91Y Live com.live91y.tv Hangzhou\nFuyun\n\n91Y Game com.lixxix.hall Hangzhou\nFuyun\n\n\nAll 6 stores 182 to latest\n\n\nCurrently only available\non Shun Wang website\n\n\n4.8.15\n\n\nIn order to understand SWAnalytics’ impact, we turned to public download volume data\navailable on Chandashi, one of the app store optimization vendors specialized in Chinese\nmobile application markets.\n\nWe derived a monthly new installation volume of six popular applications of interest. Data\npoints span from September 2018 to January 2019 where we observed over 17 million\ndownloads in just five months. Most of the infected applications maintained a solid monthon-month growth rate with already huge user bases, and although the new download\nvolume does not necessarily result in an exact number of unique and freshly infected user\nnumbers, we believe it does signal large scale compromise and a growing threat to users.\n\n**Figure 11: data derived from chandashi.com, excluding Xiaomi Appstore.**\n\n**The Value of Personal Contact Information**\n\nCompared to financial data and government issued ID document information, personal\ncontact information is often treated as less sensitive data. According to popular belief, it\nrequires extra effort to exploit such data while potential profits do not match a hacker’s\neffort. Hence it is unlikely to be targeted. However, the landscape is changing with deep\nspecialization in underground markets and new “business models” available to profit from\nsuch personal contact data.\n\n\n-----\n\nacquisitions. It resulted in waves of cellphone number-based friend referral programs. In\nChina alone, we have seen underground market “sheep shavers” ported SMS rogue\nmarketing strategy to spread Alipay Red Packet referral URL links. When receivers click\non these referral links, both the sender and receiver receives a small amount of credit in\ntheir Alipay accounts.\n\nIn 2019 new year trend predictions, multiple media outlets such as the BBC’s ‘Business\nMatters’ program and Forbes mentioned the online retail sector could expect great\ncompetition. In South East Asia alone, for example, Amazon, Alibaba backed Lazada and\nShopee will each directly face-off against each other in regional markets.\n\nIndeed, during 2018’s year-end December sales promotion, Lazada already adopted the\nAlipay style referral program. In the same way, similar marketing campaigns are expected\nfrom competing vendors in 2019. As a result, this malicious trend in the mobile arena will\nfuel sheep shavers’ interest in carrying out similar cyber operations in regional markets\noutside of China.\n\n**Figure 12: Lazada referral reward during December 2018’s end of year sales promotion**\n\nIn a heuristic view, Operation Sheep presents a rising security threat from 3 party SDKs.rd\nIn Operation Sheep’s case, Shun Wang likely harvests end user contact lists without\napplication developer acknowledgement. This behavior does not benefit end users nor\napplication developers. Rigorous code review is needed to prevent such pilfering behavior\nin so-called data analytics SDKs.\n\n\nDuring our investigation, [BuzzFeed News reported alleged advertisement fraud from](https://www.buzzfeednews.com/article/craigsilverman/cheetah-mobile-apps-play-store-ad-fraud-stock-price)\nCheetah Mobile SDK too. According to Cheetah Mobile’s follow-up investigation,\nfraudulent behaviors came from two 3 party SDKs (Batmobi, Duapps) integrated insiderd\nCheetah SDK. Both these cases should be loud reminders to application developers in\n2019 that before integrating SDKs into their mobile applications developers need to be\naware of potential risks of undocumented and malicious behaviors implemented in 3rd\nparty SDKs.\n\n**Mitigation**\n\n\nUsers are strongly advised to uninstall bespoke applications immediately. Stolen data is\ntransmitted via HTTP protocol. It means not only that Shun Wang gets the victim’s data\nbut that a malicious 3 party can also intercept and acquire it.rd\n\n**References:**\n\n[https://research.checkpoint.com/androids-man-in-the-disk/](https://research.checkpoint.com/androids-man-in-the-disk/)\n\n[https://en.wikipedia.org/wiki/Thirty-Six_Stratagems](https://en.wikipedia.org/wiki/Thirty-Six_Stratagems)\n\nhttps://www.buzzfeednews.com/article/craigsilverman/android-apps-cheetah-mobile-kikakochava-ad-fraud\n\nhttps://www.prnewswire.com/news-releases/cheetah-mobile-responds-to-kochavasmisleading-statements-300757227.html\n\n**O** **ti** **Sh** **N** **i** **E** **l i** **d**\n\n\n-----\n\ncan be directly translated in English\nas “taking the opportunity to pilfer a\nsheep”, originates from an ancient\nChinese essay named Thirty-Six\nStratagems. In modern days, it\nrefers to stealing properties of small\nvalue when the owner is not paying\nattention or at disadvantage.\n\n“薅羊毛” is a Chinese slang that\ntranslates in English as “shaving a\nsheep in a subtle way that it won’t\nbe noticed”. It refers to the practice\nof acquiring small unlawful income\nin a quick manner and on a large\nscale, hoping to accumulate\nconsiderable gain. In the internet\nage, it describes a multi-million\ndollar worth underground market of\nprofiting by abusing various reward\nsystems or freebie marketing\npromotions provided by vendors to\nreward brand loyalty or expand a\ncustomer base.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        }
    ],
    "references": [
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2019/2019.03.13.Operation_Sheep/Operation_Sheep.pdf"
    ],
    "report_names": [
        "Operation_Sheep"
    ],
    "threat_actors": [
        {
            "id": "3fff98c9-ad02-401d-9d4b-f78b5b634f31",
            "created_at": "2023-01-06T13:46:38.376868Z",
            "updated_at": "2025-03-27T02:00:02.818071Z",
            "deleted_at": null,
            "main_name": "Cleaver",
            "aliases": [
                "Cobalt Gypsy",
                "G0003",
                "Operation Cleaver",
                "Op Cleaver",
                "Tarh Andishan",
                "Alibaba",
                "TG-2889"
            ],
            "source_name": "MISPGALAXY:Cleaver",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "75108fc1-7f6a-450e-b024-10284f3f62bb",
            "created_at": "2024-11-01T02:00:52.756877Z",
            "updated_at": "2025-03-27T02:00:55.544216Z",
            "deleted_at": null,
            "main_name": "Play",
            "aliases": null,
            "source_name": "MITRE:Play",
            "tools": [
                "Nltest",
                "AdFind",
                "PsExec",
                "Wevtutil",
                "Cobalt Strike",
                "Playcrypt",
                "Mimikatz"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "c39b0fe6-5642-4717-9a05-9e94265e3e3a",
            "created_at": "2022-10-25T16:07:24.332084Z",
            "updated_at": "2025-03-27T02:02:10.175452Z",
            "deleted_at": null,
            "main_name": "Tonto Team",
            "aliases": [
                "Bronze Huntley",
                "CactusPete",
                "Earth Akhlut",
                "HartBeat",
                "Karma Panda",
                "LoneRanger",
                "Operation Bitter Biscuit",
                "TAG-74",
                "Tonto Team"
            ],
            "source_name": "ETDA:Tonto Team",
            "tools": [
                "8.t Dropper",
                "8.t RTF exploit builder",
                "8t_dropper",
                "Bioazih",
                "Bisonal",
                "CONIME",
                "Dexbia",
                "Korlia",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "Mimikatz",
                "POISONPLUG.SHADOW",
                "RoyalRoad",
                "ShadowPad Winnti",
                "XShellGhost"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1666716500,
    "ts_updated_at": 1743041786,
    "ts_creation_date": 1552548408,
    "ts_modification_date": 1552548408,
    "files": {
        "pdf": "https://archive.orkl.eu/0402511221158a29056e8ec6f9337fe40fec18c7.pdf",
        "text": "https://archive.orkl.eu/0402511221158a29056e8ec6f9337fe40fec18c7.txt",
        "img": "https://archive.orkl.eu/0402511221158a29056e8ec6f9337fe40fec18c7.jpg"
    }
}