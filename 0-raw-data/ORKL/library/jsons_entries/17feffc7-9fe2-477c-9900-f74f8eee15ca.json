{
    "id": "17feffc7-9fe2-477c-9900-f74f8eee15ca",
    "created_at": "2023-01-12T15:06:48.212115Z",
    "updated_at": "2025-03-27T02:10:19.865953Z",
    "deleted_at": null,
    "sha1_hash": "3f090e4655bc83b065f324577ae9ba345ad9c6c4",
    "title": "2022-02-22 - Vulnerable Microsoft SQL Servers targeted with Cobalt Strike",
    "authors": "",
    "file_creation_date": "2022-05-28T23:46:07Z",
    "file_modification_date": "2022-05-28T23:46:07Z",
    "file_size": 790688,
    "plain_text": "# Vulnerable Microsoft SQL Servers targeted with Cobalt Strike\n\n**[bleepingcomputer.com/news/security/vulnerable-microsoft-sql-servers-targeted-with-cobalt-strike/](https://www.bleepingcomputer.com/news/security/vulnerable-microsoft-sql-servers-targeted-with-cobalt-strike/)**\n\nBill Toulas\n\nBy\n[Bill Toulas](https://www.bleepingcomputer.com/author/bill-toulas/)\n\nFebruary 22, 2022\n01:08 PM\n0\n\n\n-----\n\nThreat analysts have observed a new wave of attacks installing Cobalt Strike beacons on\nvulnerable Microsoft SQL Servers, leading to deeper infiltration and subsequent malware\ninfections.\n\nMS-SQL Server is a popular database management system powering large internet\napplications to small single-system applets.\n\nHowever, [many of these deployments aren't adequately secured as they are publicly](https://www.bleepingcomputer.com/news/security/hacker-group-backdoors-thousands-of-microsoft-sql-servers-daily/)\nexposed to the Internet with weak passwords, and according to a report by Ahn Lab's ASEC,\nan unknown threat actor is taking advantage of this.\n\n## Targeting MS-SQL with Cobalt Strike\n\nThe attacks start with threat actors scanning for servers with an open TCP port 1433, which\nare likely public-facing MS-SQL servers. The attacker then carries out brute-forcing and\ndictionary attacks to crack the password. For the attack to work with either method, the target\npassword has to be weak.\n\nOnce the attacker gains access to the admin account and logs into the server, the ASEC\n[researchers have seen them drop coin-miners such as Lemon Duck, KingMiner, and Vollgar.](https://www.bleepingcomputer.com/news/security/lemon-duck-cryptominer-malware-now-targets-linux-devices/)\nAdditionally, the threat actor backdoors the server with Cobalt Strike to establish persistence\nand perform lateral movement.\n\nCobalt Strike is downloaded via a command shell process (cmd.exe and powershell.exe)\nonto the compromised MS-SQL and is injected and executed in MSBuild.exe to evade\ndetection.\n\n\n-----\n\n**Processes that download Cobalt Strike** _(ASEC)_\nAfter execution, a beacon is injected into the legitimate Windows wwanmm.dll process and\nwaits for the attacker's commands while staying hidden inside a system library file.\n\n\"As the beacon that receives the attackerâ€™s command and performs the malicious behavior\ndoes not exist in a suspicious memory area and instead operates in the normal module\n[wwanmm.dll, it can bypass memory-based detection,\" explains the report by Ahn Lab's](http://asec.ahnlab.com/en/31811/)\nASEC group.\n\n**Code and strings used for tainting the dll** _(ASEC)_\nCobalt Strike is a commercial pen-testing (offensive security) tool that is extensively abused\nby cybercriminals who find its powerful features set particularly useful for their malicious\noperations.\n\nThe $3,500 per license tool was meant to help ethical hackers and red teams simulate real\nattacks against organizations that want to boost their security stance, but from the moment\ncracked versions were leaked, its use by threat actors went out of control.\n\nIt's now used by [Squirrelwaffle,](https://www.bleepingcomputer.com/news/security/spammers-use-squirrelwaffle-malware-to-drop-cobalt-strike/) [Emotet,](https://www.bleepingcomputer.com/news/security/emotet-starts-dropping-cobalt-strike-again-for-faster-attacks/) [malware operators,](https://www.bleepingcomputer.com/news/security/stealthy-blister-malware-slips-in-unnoticed-on-windows-systems/) [opportunistic attacks,](https://www.bleepingcomputer.com/news/security/fake-kaseya-vsa-security-update-backdoors-networks-with-cobalt-strike/) Linuxtargeting groups, [sophisticated adversaries, and commonly by](https://www.bleepingcomputer.com/news/security/new-karakurt-hacking-group-focuses-on-data-theft-and-extortion/) [ransomware gangs when](https://www.bleepingcomputer.com/news/security/conti-ransomware-prioritizes-revenue-and-cyberinsurance-data-theft/)\nconducting attacks.\n\nThe reason why threat actors abuse it so much is its rich functionality which includes the\nfollowing:\n\n\n-----\n\nCommand execution\nKeylogging\nFile operations\nSOCKS proxying\nPrivilege escalation\nMimikatz (credential-stealing)\nPort scanning\n\nMoreover, the Cobalt Strike agent called the \"beacon\" is file-less shellcode, so the chances\nof it being detected by security tools are decreased, especially in poorly managed systems.\n\nAhnLab's data shows that all the download URLs and C2 server URLs that supported the\nrecent attack wave point to the same attacker.\n\nTo protect your MS-SQL server from attacks of this type, use a strong admin password,\nplace the server behind a firewall, log everything and monitor suspicious actions, apply\navailable security updates, and use a data access controller to inspect and enforce policies\non every transaction.\n\n### Related Articles:\n\n[Malicious PyPI package opens backdoors on Windows, Linux, and Macs](https://www.bleepingcomputer.com/news/security/malicious-pypi-package-opens-backdoors-on-windows-linux-and-macs/)\n\n[Microsoft warns of brute-force attacks targeting MSSQL servers](https://www.bleepingcomputer.com/news/security/microsoft-warns-of-brute-force-attacks-targeting-mssql-servers/)\n\n[Hive ransomware uses new 'IPfuscation' trick to hide payload](https://www.bleepingcomputer.com/news/security/hive-ransomware-uses-new-ipfuscation-trick-to-hide-payload/)\n\n[New ChromeLoader malware surge threatens browsers worldwide](https://www.bleepingcomputer.com/news/security/new-chromeloader-malware-surge-threatens-browsers-worldwide/)\n\n[New ERMAC 2.0 Android malware steals accounts, wallets from 467 apps](https://www.bleepingcomputer.com/news/security/new-ermac-20-android-malware-steals-accounts-wallets-from-467-apps/)\n\n[Bill Toulas](https://www.bleepingcomputer.com/author/bill-toulas/)\n\nBill Toulas is a technology writer and infosec news reporter with over a decade of experience\nworking on various online publications. An open source advocate and Linux enthusiast, is\ncurrently finding pleasure in following hacks, malware campaigns, and data breach incidents,\nas well as by exploring the intricate ways through which tech is swiftly transforming our lives.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-02-22 - Vulnerable Microsoft SQL Servers targeted with Cobalt Strike.pdf"
    ],
    "report_names": [
        "2022-02-22 - Vulnerable Microsoft SQL Servers targeted with Cobalt Strike.pdf"
    ],
    "threat_actors": [
        {
            "id": "6ad410c7-e291-4327-a54b-281c23f0d4fa",
            "created_at": "2022-10-25T16:07:24.501468Z",
            "updated_at": "2025-03-27T02:02:10.26052Z",
            "deleted_at": null,
            "main_name": "Karakurt",
            "aliases": [],
            "source_name": "ETDA:Karakurt",
            "tools": [
                "7-Zip",
                "Agentemis",
                "AnyDesk",
                "Cobalt Strike",
                "CobaltStrike",
                "FileZilla",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "Mimikatz",
                "WinZip",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "2af9bea3-b43e-4a6d-8dc6-46dad6e3ff24",
            "created_at": "2022-10-25T16:47:55.853415Z",
            "updated_at": "2025-03-27T02:05:17.401138Z",
            "deleted_at": null,
            "main_name": "GOLD TOMAHAWK",
            "aliases": [
                "Karakurt Lair",
                "Karakurt Team",
                "Karakurt"
            ],
            "source_name": "Secureworks:GOLD TOMAHAWK",
            "tools": [
                " AnyDesk",
                " MEGA",
                " QuickPacket",
                " Rclone",
                " SendGB",
                "7-ZIP"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "610a7295-3139-4f34-8cec-b3da40add480",
            "created_at": "2023-01-06T13:46:38.608142Z",
            "updated_at": "2025-03-27T02:00:02.87217Z",
            "deleted_at": null,
            "main_name": "Cobalt",
            "aliases": [
                "Cobalt Gang",
                "GOLD KINGSWOOD",
                "COBALT SPIDER",
                "G0080",
                "Mule Libra",
                "Cobalt Group"
            ],
            "source_name": "MISPGALAXY:Cobalt",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "079e3d6e-24ef-42b0-b555-75c288f9efd8",
            "created_at": "2023-03-04T02:01:54.105946Z",
            "updated_at": "2025-03-27T02:00:03.122936Z",
            "deleted_at": null,
            "main_name": "Karakurt",
            "aliases": [
                "Karakurt Lair"
            ],
            "source_name": "MISPGALAXY:Karakurt",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673536008,
    "ts_updated_at": 1743041419,
    "ts_creation_date": 1653781567,
    "ts_modification_date": 1653781567,
    "files": {
        "pdf": "https://archive.orkl.eu/3f090e4655bc83b065f324577ae9ba345ad9c6c4.pdf",
        "text": "https://archive.orkl.eu/3f090e4655bc83b065f324577ae9ba345ad9c6c4.txt",
        "img": "https://archive.orkl.eu/3f090e4655bc83b065f324577ae9ba345ad9c6c4.jpg"
    }
}