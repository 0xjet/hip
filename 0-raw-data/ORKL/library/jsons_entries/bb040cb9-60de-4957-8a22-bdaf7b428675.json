{
    "id": "bb040cb9-60de-4957-8a22-bdaf7b428675",
    "created_at": "2023-01-12T15:00:03.33832Z",
    "updated_at": "2025-03-27T02:16:26.539719Z",
    "deleted_at": null,
    "sha1_hash": "6ec917e37248d24145f51b9a5bb07f4f34f2ac58",
    "title": "2019-10-01 - New Fileless Botnet Novter Distributed by KovCoreG Malvertising Campaign",
    "authors": "",
    "file_creation_date": "2022-05-28T02:43:00Z",
    "file_modification_date": "2022-05-28T02:43:00Z",
    "file_size": 134666,
    "plain_text": "# Fileless Botnet Novter Spread Via KovCoreG Campaign\n\n**blog.trendmicro.com/trendlabs-security-intelligence/new-fileless-botnet-novter-distributed-by-kovcoreg-malvertising-**\ncampaign/\n\nOctober 1, 2019\n\nCyber Threats\n\nWe found a new modular fileless botnet malware, which we named “Novter,” that the\nKovCoreG campaign has been distributing. We’ve been actively monitoring this threat since\nits emergence and early development, and saw it being frequently updated.\n\nBy: Jaromir Horejsi, Joseph C Chen, Ecular Xu October 01, 2019 Read time: ( words)\n\nWe found a new modular fileless botnet malware, which we named “Novter,” (also reported\n[and known as “Nodersok” and “Divergent”) that the KovCoreG campaign has been](https://www.microsoft.com/security/blog/2019/09/26/bring-your-own-lolbin-multi-stage-fileless-nodersok-campaign-delivers-rare-node-js-based-malware/)\ndistributing since March. We’ve been actively monitoring this threat since its emergence and\n[early development, and saw it being frequently updated. KovCoreG, active since 2011, is a](https://www.proofpoint.com/us/threat-insight/post/threat-actor-profile-kovcoreg-kovter-saga)\n[long-running campaign known for using the Kovter botnet malware, which was distributed](https://www.trendmicro.com/vinfo/us/security/news/cybercrime-and-digital-threats/kovter-an-evolving-malware-gone-fileless)\n[mainly through malvertisements and exploit kits. Kovter has been involved in click fraud](https://www.trendmicro.com/vinfo/us/security/definition/exploit-kit)\noperations since 2015, using fraudulent ads that have reportedly cost businesses more than\n[US$29 million. The botnet was](https://www.justice.gov/usao-edny/pr/two-international-cybercriminal-rings-dismantled-and-eight-defendants-indicted-causing) [taken down at the end of 2018 through concerted efforts by](https://www.whiteops.com/3ve)\nlaw enforcement and cybersecurity experts, including Trend Micro.\n\n\n-----\n\nThe dismantlement hasn t deterred the cybercriminals. Though the botnet is dead, we\nnoticed that the KovCoreG campaign didn’t stop their activities and instead developed\nanother botnet. Working with ProofPoint’s threat researcher [Kafeine, we were able to](https://twitter.com/kafeine)\nuncover a new fileless botnet malware — Novter — being distributed by the operators of\nKovCoreG.\n\nWhile the malvertising attacks were originally focused on U.S.-based users, they have since\nexpanded to several European countries starting this summer. Our telemetry also revealed\nthat the malvertising attacks were being distributed through a few of top 100 websites in the\n[U.S., which were also abused by Kovter in their previous activities. Our analysis of Novter,](https://www.proofpoint.com/us/threat-insight/post/kovter-group-malvertising-campaign-exposes-millions-potential-malware-and-fraud)\n[particularly its most notable modules, are detailed in this technical brief.](https://documents.trendmicro.com/assets/Tech-Brief-New-Fileless-Botnet-Novter-Distributed-by-KovCoreG-Malvertising-Campaign.pdf)\n\nFigure 1. Infection chain of KovCoreG, Novter, and Nodster\n\n## KovCoreG’s attack chain\n\nKovCoreG’s attacks are socially engineered malvertisments that lure unwitting users into\ndownloading a software package needed to update their supposedly out-of-date Adobe\nFlash application. However, it instead drops a malicious HTML application (HTA) file named\n_Player{timestamp}.hta. When the victim executes the HTA file, it will load additional scripts_\nfrom a remote server (communication is RC4-encrypted) and run a PowerShell script that\n[appears to take inspiration from the open-source Invoke-PSInject project.](https://github.com/EmpireProject/Empire/blob/master/data/module_source/management/Invoke-PSInject.ps1)\n\nFigure 2. Screenshot showing an example of KovCoreG’s malvertisements (captured by\nProofPoint)\n\nFigure 3. Snapshot of KovCoreG’s malvertisement traffic (captured by ProofPoint)\n\nThe PowerShell script, in turn, will disable Windows Defender and Windows Update\n[processes. It runs a shellcode to bypass User Account Control (UAC) via the CMSTPLUA](http://www.endurant.io/cmstp/detecting-cmstp-enabled-code-execution-and-uac-bypass-with-sysmon/)\nCOM interface (related to connection management). The PowerShell script is also\n[embedded with Novter, which will be executed filelessly via the PowerShell reflective](https://www.trendmicro.com/vinfo/us/security/news/security-technology/security-101-defending-against-fileless-malware#memoryexploits)\n[injection technique.](https://powersploit.readthedocs.io/en/latest/CodeExecution/Invoke-ReflectivePEInjection/)\n\n## Analysis of the Novter malware\n\nNovter is a backdoor in the form of an executable file. Immediately after its execution, it\nperforms the following anti-debugging and anti-analysis checks:\n\nSearching for blacklisted processes and modules by comparing the CRC32 algorithms\nof their names with a list of hardcoded CRC32s\nChecking if the number of cores is too small\nChecking if the process is being debugged\nChecking if the Sleep function is being manipulated\n\n\n-----\n\nIf it finds any of aforementioned information, it is then reported to the C&C server. Note that it\nuses different sets of C&C servers for different purposes. One set, for instance, is solely\nused for anti-analysis reporting. After the affected machine’s environment is double-checked\nand reported, the malware goes to sleep for a long time.\n\nThe backdoor commands that Novter supports are:\n\nkillall — Terminate a process and delete a file (for all modules)\nkill — Terminate a process and delete a file (for a specific module)\nstop — Terminate the process without deleting its file (for a specific module)\nresume — Start a process (for a specific module)\nmodules — Download and execute an additional module\nupdate — Download a new version and install the update\nupdate_interval — Set an interval between two consecutive update attempts\n\nNovter communicates with its command-and-control (C&C) servers and downloads multiple\nJavaScript modules for different purposes. We have identified three Novter modules, which\ninclude:\n\nA module that shows a technical support scam page on the victim’s machine\n[A module that abuses WinDivert (Windows packet divert, a tool that enables network](https://reqrypt.org/windivert.html)\npackets sent to and from Windows network stacks to be captured, modified, or\ndropped) to block the communication from processes like those from antivirus (AV)\nsoftware\n[A module (which we named “Nodster”) that is written with NodeJS and](https://nodejs.org/en/) [io for proxying](https://socket.io/)\nnetwork traffic. We consider it a module responsible for building the proxy network\nneeded to support the click fraud operations.\n\n## Analysis of Novter’s module “Nodster”\n\nDuring our analysis of Novter, we came across three notable modules downloaded by the\nmalware. One of them, which we named “Nodster,” is a network proxy module. The module\ninstalls NodeJS on the victim’s machine and executes a NodeJS script “app.js” in the\nbackground. The script will connect to an embedded C&C server address and receive the\nsecond C&C server address.\n\nIt will then establish a backconnection to the second C&C server with the socket.io protocol.\nThe second C&C server will return commands to instruct the module to make a TCP\nconnection, send a TCP payload, and return the response from the server back to them. This\nturns the system infected with Novter become a proxy for the attacker to use.\n\nFigure 4. The communication flow between the Nodster proxy and C&C servers\n\n## Correlating Nodster’s traffic\n\n\n-----\n\nDuring the course of our research, we observed lots of encrypted traffic proxied through the\nNodster module, but we managed to decrypt some of it, which showed scripts used for web\nadvertising. This indicates that the C&C server instructed the infected machine to open a\nwebsite with an embedded JavaScript code related to displaying advertisements.\n\nWe also noticed that the ad traffic appeared to have been sent from Android devices, since\nthe HTTP(S) requests transferred through the proxy had HTTP User-Agent headers from\nAndroid devices. These requests are appended with a “X-Requested-With” header with\nmany Android app names. We inspected those apps on the Google Play store because we\ninitially thought that the traffic could have been generated by these applications. However,\nwe did not find any suspicious code in these applications that would have generated this\ntraffic. We didn’t find any similar code shared between these Android applications either.\n\nFigure 5. The HTTPS request header spoofed to be from an Android device\n\nWith this finding, we inferred that the ad traffic was not coming from the mobile devices, but\nwas instead being generated by the attacker. The attacker disguised the traffic to appear as\nif it was being sent from Android devices and mobile applications and proxied them through\nthe Novter/Nodster botnet. After all, KovCoreG’s operations involved click fraud.\n\n## Defending against Novter\n\nAdvertisements are an innocuous online staple, but KovCoreG’s campaign demonstrates\nhow they can be intrusive, not to mention how Novter can expose the user’s system to other\nand actual threats. Given how KovCoreG engages in click fraud, it can significantly affect\n[businesses. A single mobile ad fraud incident in 2018, for instance, cost Google and its](https://www.trendmicro.com/vinfo/us/security/news/mobile-safety/mobile-ad-fraud-schemes-how-they-work-and-how-to-defend-against-them)\n[partners around US$10 million in losses.](https://www.trendmicro.com/vinfo/us/security/research-and-analysis/threat-reports/roundup/2018-mobile-threat-landscape)\n\nNovter also exemplifies fraudsters’ maturing techniques with its use of fileless infection\nmethods and obfuscating its C&C connections and fraud-related traffic. Users, for their part,\nshould adopt best practices, especially against socially engineered threats like\n[malvertisements.](https://www.trendmicro.com/vinfo/us/security/news/cybercrime-and-digital-threats/malvertising-when-online-ads-attack)\n\n[Trend Micro endpoint solutions, such as the Smart Protection Suites and](https://blog.trendmicro.com/en_us/business/products/user-protection/sps.html) Worry-Free\nBusiness Security that have behavior monitoring capabilities, can protect users and\nbusinesses from threats like Emotet by detecting malicious files, scripts, and messages as\n[well as blocking all related malicious URLs. Trend Micro Apex One™ protection employs a](https://blog.trendmicro.com/en_us/business/products/user-protection/sps/endpoint.html)\nvariety of threat detection capabilities such as behavioral analysis, which protect against\nmalicious scripts, injection, ransomware, memory and browser attacks.\n\n[The full details of our research on Novter is in this technical brief, while the indicators of](https://documents.trendmicro.com/assets/Tech-Brief-New-Fileless-Botnet-Novter-Distributed-by-KovCoreG-Malvertising-Campaign.pdf)\n[compromise (IoCs) are in this appendix.](https://documents.trendmicro.com/assets/Appendix-New-Fileless-Botnet-Novter-Distributed-by-KovCoreG-Malvertising-Campaign.pdf)\n\n\n-----\n\n_Hat tip to ProofPoint s researcher Kafeine whom we worked with in this research._\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2019/2019-10-01 - New Fileless Botnet Novter Distributed by KovCoreG Malvertising Campaign.pdf"
    ],
    "report_names": [
        "2019-10-01 - New Fileless Botnet Novter Distributed by KovCoreG Malvertising Campaign.pdf"
    ],
    "threat_actors": [
        {
            "id": "75108fc1-7f6a-450e-b024-10284f3f62bb",
            "created_at": "2024-11-01T02:00:52.756877Z",
            "updated_at": "2025-03-27T02:00:55.544216Z",
            "deleted_at": null,
            "main_name": "Play",
            "aliases": null,
            "source_name": "MITRE:Play",
            "tools": [
                "Nltest",
                "AdFind",
                "PsExec",
                "Wevtutil",
                "Cobalt Strike",
                "Playcrypt",
                "Mimikatz"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1673535603,
    "ts_updated_at": 1743041786,
    "ts_creation_date": 1653705780,
    "ts_modification_date": 1653705780,
    "files": {
        "pdf": "https://archive.orkl.eu/6ec917e37248d24145f51b9a5bb07f4f34f2ac58.pdf",
        "text": "https://archive.orkl.eu/6ec917e37248d24145f51b9a5bb07f4f34f2ac58.txt",
        "img": "https://archive.orkl.eu/6ec917e37248d24145f51b9a5bb07f4f34f2ac58.jpg"
    }
}