{
    "id": "2a7cf96f-7d46-4861-b70e-059a401e3245",
    "created_at": "2023-01-12T15:08:19.231614Z",
    "updated_at": "2025-03-27T02:16:39.074071Z",
    "deleted_at": null,
    "sha1_hash": "268243aeac1ebe3132de1a0ce0a0e023dfba476b",
    "title": "2018-05-22 - Turla Mosquito- A shift towards more generic tools",
    "authors": "",
    "file_creation_date": "2022-05-28T18:06:19Z",
    "file_modification_date": "2022-05-28T18:06:19Z",
    "file_size": 367045,
    "plain_text": "# Turla Mosquito: A shift towards more generic tools\n\n**welivesecurity.com/2018/05/22/turla-mosquito-shift-towards-generic-tools/**\n\nESET researchers have observed a significant change in the campaign of the infamous espionage group\n\n[ESET Research](https://www.welivesecurity.com/author/esetresearch/)\n\n\nMay 22, 2018\n\n\n-----\n\nay 0 8 0 58\n\nESET researchers have observed a significant change in the campaign of the infamous espionage group\n\nTurla is a notorious espionage group, and has been active for at least ten years. It came to light in 2008, when Turla breached the US\nDepartment of Defense [1]. Since then, there have been numerous security incidents involving Turla targeting several governments and\n[sensitive businesses such as the defense industry [2].](https://www.melani.admin.ch/melani/en/home/dokumentation/reports/technical-reports/technical-report_apt_case_ruag.html)\n\n[Our January 2018 white paper [3] was the first public analysis of a Turla campaign called Mosquito. We have also published indicators of](https://www.welivesecurity.com/wp-content/uploads/2018/01/ESET_Turla_Mosquito.pdf)\ncompromise [4]. Since then, the campaign has remained very active and attackers have been busy changing their tactics to remain as\nstealthy as possible.\n\nStarting in March 2018, we observed a significant change in the campaign: it now leverages the open source exploitation framework\nMetasploit before dropping the custom Mosquito backdoor. It is not the first time Turla has used generic tools. In the past, we have seen the\ngroup using open-source password dumpers such as Mimikatz. However, to our knowledge, this is the first time Turla has used Metasploit as\n[a first stage backdoor, instead of relying on one of its own tools such as Skipper [5].](https://labs.bitdefender.com/wp-content/uploads/downloads/pacifier-apt/)\n\n## Distribution\n\n[As described in our earlier analysis [3], the typical vector of compromise of the Mosquito campaign is still a fake Flash installer, in reality](https://www.welivesecurity.com/wp-content/uploads/2018/01/ESET_Turla_Mosquito.pdf)\ninstalling both the Turla backdoor and the legitimate Adobe Flash Player. The typical targets are still embassies and consulates in Eastern\nEurope.\n\nWe showed that the compromise happens when the user downloads a Flash installer from get.adobe.com through HTTP. Traffic was\nintercepted on a node between the end machine and the Adobe servers, allowing Turla’s operators to replace the legitimate Flash executable\nwith a trojanized version. The following image shows the different points where the traffic could, in theory, be intercepted. Please note that we\nbelieve the fifth possibility to be excluded, as, to the best of our knowledge, Adobe/Akamai was not compromised.\n\nEven though we were not able to spot traffic interception subsequently, we found a new executable that is still impersonating the Flash\ninstaller and is named flashplayer28_xa_install.exe. Thus, we believe the same method of initial compromise is still being used.\n\n## Analysis\n\nAt the beginning of March 2018, as part of our regular tracking of Turla’s activities, we observed some changes in the Mosquito campaign.\nEven though they did not make use of groundbreaking techniques, this is a significant shift in Turla’s Tactics, Techniques and Procedures\n(TTPs).\n\nPreviously, the chain of compromise was a fake Flash installer dropping a loader and the main backdoor. The following figure summarizes the\nprocess.\n\n\n-----\n\nRecently, we observed a change in the way in which the final backdoor is dropped. Turla’s campaign still relies on a fake Flash installer but,\ninstead of directly dropping the two malicious DLLs, it executes a Metasploit shellcode and drops, or downloads from Google Drive, a\nlegitimate Flash installer. Then, the shellcode downloads a Meterpreter, which is a typical [Metasploit payload [6], allowing the attacker to](https://www.offensive-security.com/metasploit-unleashed/about-meterpreter/)\ncontrol the compromised machine. Finally, the machine may receive the typical Mosquito backdoor. The figure below summarizes the new\nprocess.\n\nBecause Metasploit is being used, we might also guess that an operator controls the exploitation process manually. The time frame of the\nattack was relatively short as the final backdoor was dropped within thirty minutes of the start of the compromise attempt.\n\n[The shellcode is a typical Metasploit shellcode, protected using the shikata_ga_nai encoder [7] with seven iterations. The following](http://10.10.0.46/ttp://radare.today/posts/unpacking-shikata-ga-nai-by-scripting-radare2/)\nscreenshots show the encoded and the decoded payload.\n\n\n-----\n\nOnce the shellcode is decoded, it contacts its C&C at https://209.239.115[.]91/6OHEJ, which directs the download of an additional shellcode.\nBased on our telemetry, we identified the next stage to be a Meterpreter. That IP address is already known as a previously-seen Mosquito\nC&C domain, psychology-blog.ezua[.]com, was resolving to it in October 2017.\n\nFinally, the fake Flash installer downloads a legitimate Adobe installer, from a Google Drive URL, and executes it to lull the user into thinking\nall went correctly.\n\n## Additional tools\n\nIn addition to the new fake Flash installer and Meterpreter, we observed the use of several other tools.\n\nA custom executable that only contains the Metasploit shellcode. This is used to maintain access to a Meterpreter session. It is saved to\nC:\\Users\\<username>\\AppData\\Roaming\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\\msupdateconf.exe, granting the executable\npersistence.\nAnother custom executable used to execute PowerShell scripts.\nThe Mosquito JScript backdoor that uses Google Apps Script as its C&C server.\n[Privilege escalation using the Metasploit module ext_server_priv.x86.dll [8].](https://github.com/rapid7/meterpreter/tree/master/source/extensions/priv/server/elevate)\n\n## Conclusion\n\nIn this post, we have presented the evolutions of the Turla Mosquito campaign over the last few months. The major change we observed was\nthe use of Metasploit, an open-source penetration testing project, as a first stage for the custom Mosquito backdoor. This might be useful\ninformation for defenders performing incident response on attacks involving Turla.\n_For any inquiries, or to make sample submissions related to the subject, contact us at threatintel@eset.com._\n\n### C&C\n\nhttps://209.239.115[.]91/6OHEJ\nhttps://70.32.39[.]219/n2DE3\n\n### Link to the legitimate Flash installer\n\nhttps://drive.google[.]com/uc?authuser=0&id=1s4kyrwa7gCH8I5Z1EU1IZ_JaR48A7UeP&export=download\n\n## IoCs\n\n\n-----\n\n**FilenameFilename** **SHA1SHA1** **SHA256SHA256**\n\nflashplayer28_xa_install.exe 33d3b0ec31bfc16dcb1b1ff82550aa17fa4c07c5 f9b83eff6d705c214993be9575f8990aa8150128a815e849c6fa\n\nmsupdateconf.exe 114c1585f1ca2878a187f1ce7079154cc60db7f5 1193033d6526416e07a5f20022cd3c5c79b73e8a33e80f29f9b\n\nmsupdatesmal.exe 994c8920180d0395c4b4eb6e7737961be6108f64 6868cdac0f06232608178b101ca3a8afda7f31538a165a045b4\n\n### References\n\n[1] B. KNOWLTON, “Military Computer Attack Confirmed,” New York Times, 25 08 2010. [Online]. Available:\nhttps://www.nytimes.com/2010/08/26/technology/26cyber.html?_r=1&ref=technology. [Accessed 09 04 2018].\n\n[2] MELANI, ” Technical Report about the Malware used in the Cyberespionage against RUAG,” 23 05 2016. [Online]. Available:\nhttps://www.melani.admin.ch/melani/en/home/dokumentation/reports/technical-reports/technical-report_apt_case_ruag.html.\n\n[3] ESET, “Diplomats in Eastern Europe bitten by a Turla mosquito,” ESET, 01 2018. [Online]. Available: https://www.welivesecurity.com/wpcontent/uploads/2018/01/ESET_Turla_Mosquito.pdf.\n\n[4] ESET, “Mosquito Indicators of Compromise,” ESET, 09 01 2018. [Online]. Available: https://github.com/eset/malwareioc/tree/master/turla#mosquito-indicators-of-compromise.\n\n[5] M. Tivadar, C. Istrate, I. Muntean and A. Ardelean, “Pacifier APT,” 01 07 2016. [Online]. Available: https://labs.bitdefender.com/wpcontent/uploads/downloads/pacifier-apt/.\n\n[6] “About the Metasploit Meterpreter,” [Online]. Available: https://www.offensive-security.com/metasploit-unleashed/about-meterpreter/.\n\n[7] “Unpacking shikata-ga-nai by scripting radare2,” 08 12 2015. [Online]. Available: http://radare.today/posts/unpacking-shikata-ga-nai-byscripting-radare2/.\n\n[8] “meterpreter/source/extensions/priv/server/elevate/,” Rapid7, 26 11 2013. [Online]. Available:\nhttps://github.com/rapid7/meterpreter/tree/master/source/extensions/priv/server/elevate.\n\n22 May 2018 - 02:58PM\n\n### Sign up to receive an email update whenever a new article is published in our Ukraine Crisis – Digital Security Resource Center\n\n Newsletter\n\n Discussion\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2018/2018-05-22 - Turla Mosquito- A shift towards more generic tools.pdf"
    ],
    "report_names": [
        "2018-05-22 - Turla Mosquito- A shift towards more generic tools.pdf"
    ],
    "threat_actors": [
        {
            "id": "a97cf06d-c2e2-4771-99a2-c9dee0d6a0ac",
            "created_at": "2022-10-25T16:07:24.349252Z",
            "updated_at": "2025-03-27T02:02:10.184406Z",
            "deleted_at": null,
            "main_name": "Turla",
            "aliases": [
                "ATK 13",
                "Belugasturgeon",
                "Blue Python",
                "CTG-8875",
                "Group 88",
                "ITG12",
                "Iron Hunter",
                "Krypton",
                "Makersmark",
                "Operation Epic Turla",
                "Operation Moonlight Maze",
                "Operation Penguin Turla",
                "Operation Satellite Turla",
                "Operation Skipper Turla",
                "Operation Turla Mosquito",
                "Operation WITCHCOVEN",
                "Pacifier APT",
                "Pensive Ursa",
                "Popeye",
                "SIG15",
                "SIG2",
                "SIG23",
                "Secret Blizzard",
                "TAG-0530",
                "Turla",
                "UNC4210",
                "Venomous Bear",
                "Waterbug"
            ],
            "source_name": "ETDA:Turla",
            "tools": [
                "ASPXSpy",
                "ASPXTool",
                "ATI-Agent",
                "AdobeARM",
                "Agent.BTZ",
                "Agent.DNE",
                "BigBoss",
                "COMpfun",
                "Chinch",
                "Cloud Duke",
                "CloudDuke",
                "CloudLook",
                "Cobra Carbon System",
                "ComRAT",
                "DoublePulsar",
                "EmPyre",
                "EmpireProject",
                "Epic Turla",
                "EternalBlue",
                "EternalRomance",
                "GoldenSky",
                "Group Policy Results Tool",
                "HTML5 Encoding",
                "HyperStack",
                "IcedCoffee",
                "IronNetInjector",
                "KSL0T",
                "Kapushka",
                "Kazuar",
                "KopiLuwak",
                "Kotel",
                "LOLBAS",
                "LOLBins",
                "LightNeuron",
                "Living off the Land",
                "Maintools.js",
                "Metasploit",
                "Meterpreter",
                "MiamiBeach",
                "Mimikatz",
                "MiniDionis",
                "Minit",
                "NBTscan",
                "NETTRANS",
                "NETVulture",
                "Neptun",
                "NetFlash",
                "NewPass",
                "Outlook Backdoor",
                "Penquin Turla",
                "Pfinet",
                "PowerShell Empire",
                "PowerShellRunner",
                "PowerShellRunner-based RPC backdoor",
                "PowerStallion",
                "PsExec",
                "PyFlash",
                "QUIETCANARY",
                "Reductor RAT",
                "RocketMan",
                "SMBTouch",
                "SScan",
                "Satellite Turla",
                "SilentMoon",
                "Sun rootkit",
                "TTNG",
                "TadjMakhal",
                "Tavdig",
                "TinyTurla",
                "TinyTurla Next Generation",
                "TinyTurla-NG",
                "Topinambour",
                "Tunnus",
                "Turla",
                "Turla SilentMoon",
                "TurlaChopper",
                "Uroburos",
                "Urouros",
                "WCE",
                "WITCHCOVEN",
                "WhiteAtlas",
                "WhiteBear",
                "Windows Credential Editor",
                "Windows Credentials Editor",
                "Wipbot",
                "WorldCupSec",
                "XTRANS",
                "certutil",
                "certutil.exe",
                "gpresult",
                "nbtscan",
                "nbtstat",
                "pwdump"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "8aaa5515-92dd-448d-bb20-3a253f4f8854",
            "created_at": "2024-06-19T02:03:08.147099Z",
            "updated_at": "2025-03-27T02:05:17.408118Z",
            "deleted_at": null,
            "main_name": "IRON HUNTER",
            "aliases": [
                "Belugasturgeon ",
                "Blue Python ",
                "CTG-8875 ",
                "ITG12 ",
                "KRYPTON ",
                "MAKERSMARK ",
                "Pensive Ursa ",
                "Secret Blizzard ",
                "Turla",
                "UAC-0003 ",
                "UAC-0024 ",
                "UNC4210 ",
                "Venomous Bear ",
                "Waterbug ",
                "ATK13 "
            ],
            "source_name": "Secureworks:IRON HUNTER",
            "tools": [
                " ComRAT",
                " Kazuar",
                " KopiLuwak",
                " LightNeuron",
                " Mosquito",
                " Nautilus",
                " Neuron",
                " Penquin",
                " PoisonFrog",
                " PyFlash",
                " Skipper",
                " Snake",
                " Tavdig",
                " TinyTurla",
                " Tunnus",
                "Carbon-DLL"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "a97fee0d-af4b-4661-ae17-858925438fc4",
            "created_at": "2023-01-06T13:46:38.396415Z",
            "updated_at": "2025-03-27T02:00:02.823045Z",
            "deleted_at": null,
            "main_name": "Turla",
            "aliases": [
                "Uroburos",
                "Hippo Team",
                "Pacifier APT",
                "MAKERSMARK",
                "ATK13",
                "UAC-0003",
                "IRON HUNTER",
                "Waterbug",
                "TAG_0530",
                "KRYPTON",
                "Popeye",
                "SIG23",
                "UAC-0144",
                "G0010",
                "Blue Python",
                "VENOMOUS Bear",
                "Group 88",
                "Pfinet",
                "ITG12",
                "UNC4210",
                "Secret Blizzard",
                "UAC-0024"
            ],
            "source_name": "MISPGALAXY:Turla",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "d11c89bb-1640-45fa-8322-6f4e4053d7f3",
            "created_at": "2022-10-25T15:50:23.509601Z",
            "updated_at": "2025-03-27T02:00:55.487991Z",
            "deleted_at": null,
            "main_name": "Turla",
            "aliases": [
                "Turla",
                "IRON HUNTER",
                "Group 88",
                "Waterbug",
                "WhiteBear",
                "Krypton",
                "Venomous Bear",
                "Secret Blizzard",
                "BELUGASTURGEON"
            ],
            "source_name": "MITRE:Turla",
            "tools": [
                "PsExec",
                "nbtstat",
                "ComRAT",
                "netstat",
                "certutil",
                "KOPILUWAK",
                "IronNetInjector",
                "LunarWeb",
                "Arp",
                "Uroburos",
                "PowerStallion",
                "Kazuar",
                "Systeminfo",
                "LightNeuron",
                "Mimikatz",
                "Tasklist",
                "LunarMail",
                "HyperStack",
                "NBTscan",
                "TinyTurla",
                "Penquin",
                "LunarLoader"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "392aed78-4ef6-46ac-afba-c3920ea05d28",
            "created_at": "2022-10-25T16:07:23.323349Z",
            "updated_at": "2025-03-27T02:02:09.737228Z",
            "deleted_at": null,
            "main_name": "APT 6",
            "aliases": [
                "1.php Group"
            ],
            "source_name": "ETDA:APT 6",
            "tools": [
                "Chymine",
                "Darkmoon",
                "Gen:Trojan.Heur.PT",
                "Poison Ivy",
                "SPIVY",
                "pivy",
                "poisonivy"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673536099,
    "ts_updated_at": 1743041799,
    "ts_creation_date": 1653761179,
    "ts_modification_date": 1653761179,
    "files": {
        "pdf": "https://archive.orkl.eu/268243aeac1ebe3132de1a0ce0a0e023dfba476b.pdf",
        "text": "https://archive.orkl.eu/268243aeac1ebe3132de1a0ce0a0e023dfba476b.txt",
        "img": "https://archive.orkl.eu/268243aeac1ebe3132de1a0ce0a0e023dfba476b.jpg"
    }
}