{
    "id": "b1c4c1b1-b5e0-4452-9c3d-ac55f8c39423",
    "created_at": "2023-01-12T15:09:53.709582Z",
    "updated_at": "2025-03-27T02:05:37.771883Z",
    "deleted_at": null,
    "sha1_hash": "1dc2ff40822625fa85b380a89f88d373e3c2b39c",
    "title": "2017-12-18 - MedusaHTTP DDoS Slithers Back into the Spotlight",
    "authors": "",
    "file_creation_date": "2022-05-28T16:53:54Z",
    "file_modification_date": "2022-05-28T16:53:54Z",
    "file_size": 1439481,
    "plain_text": "# MedusaHTTP DDoS Slithers Back into the Spotlight\n\n**[arbornetworks.com/blog/asert/medusahttp-ddos-slithers-back-spotlight/](https://www.arbornetworks.com/blog/asert/medusahttp-ddos-slithers-back-spotlight/)**\n\nBot\nBotnet\nBotnets\nmalware\nMedusaHTTP\nMedusaIRC\nRussia\nStevenkings\n\n\n-----\n\nmedusa\n\n\nby [ASERT Team on December 18th, 2017](https://www.netscout.com/blog/asert/asert-team)\n\n## Executive Summary\n\nMedusaHTTP is a HTTP-based DDoS botnet written in .NET, that surfaced in early 2017.\nMedusaHTTP is based off of MedusaIRC which leveraged IRC for its command and control\ncommunications instead of HTTP. MedusaIRC botnet has been advertised on various\nunderground hacker marketplaces since 2015, while MedusaHTTP started appearing in\n2017.\n\nThe alleged seller of MedusaIRC and MedusaHTTP, Stevenking(s) has advertised this\nbotnet family on hacker marketplaces for many years.\nMedusaHTTP has evolved from an IRC botnet to an HTTP botnet. The HTTP\ncomponents appear to be reused code from the leaked Diamond Fox DDoS botnet.\nMedusaHTTP was observed being distributed by the Rig Exploit Kit by an independent\nresearcher.\n\n## Introduction\n\n\n-----\n\nMedusaHTTP was discovered after reading an independent researcher s [blog post](https://zerophagemalware.com/2017/10/13/rig-ek-via-malvertising-drops-a-miner/)\ndescribing malware distributed by recent Rig exploit kit campaigns. Screenshots of network\ntraffic from one of the malware payloads within the post, caught our attention:\n\nThe blog post initially identified the payload responsible for this traffic as AZORult; however,\nthe commands in this traffic suggest DDoS functionality. AZORult is classified as an\ninformation stealing trojan which has the primary objective of capturing passwords, financial\nand personal information from the victim’s system. Samples of this family and campaign\nobjectives are not known to contain DDoS functionality, so this could suggest a major update\n[to the AZORult malware. ASERT obtained the sample linked in the blog post from VirusTotal,](https://www.virustotal.com/#/file/2919a13b964c8b006f144e3c8cc6563740d3d242f44822c8c44dc0db38137ccb/detection)\nand after analysis we believe this file is not AZORult but rather a new version of the DDoS\nbot known as Medusa.\n\n## Enter Medusa – StevenKings’ DDoS botnet kit since 2015\n\n\n-----\n\nThis isn t the first time ASERT has encountered the Medusa botnet, we previously analyzed\nthe IRC version of Medusa in 2016. In addition, we found references of Medusa being\nadvertised on underground hacker marketplaces dating back to 2015. Advertisements were\nposted by a user under the name of StevenKings, a sample image of an advertisement is\nprovided below:\n\nAs insinuated above, Stevenkings may not be a native English speaker. We believe he or\nshe may be a native Russian speaker based on the origin of their most active forum. In this\n2015 advertisement, Stevenkings is selling the IRC version of Medusa for $500 in bitcoin, a\ncryptocurrency often leveraged in underground marketplaces. Reading further shows\ndescriptions of future commands that will be added to the bot such as, “.httpstrong” which\nwas the string that sparked our attention from the above researcher’s blog post. The\nadvertisement also links to images of the botnet’s throughput, first showing screenshots to\nprove DDoS rates of 30k requests-per-second:\n\n\n-----\n\nAnd then, a screenshot of it generating 3k requests-per-second with only 3 bots.\n\nHigher requests-per-second per bot allows a botnet controller to use less bots for taking\ndown targets. This would mean the botnet controller could infect less victims while still\nremaining operationally successful.\n\n## Medusa Now in HTTP\n\nOur research shows Stevenkings advertising the HTTP version of the Medusa botnet on\nunderground hacker marketplaces in early 2017. The advertisements for this version\nincluded images of the HTTP command and control panel which appears to use the code\n\n\n-----\n\nand images from Diamond Fox, another well-known DDoS botnet.\n\nA view of the MedusaHTTP admin panel.\n\nA view of the MedusaHTTP attack page.\n\nA view of the Diamond Fox admin panel for comparison.\n\n\n-----\n\nMultiple versions of Diamond Fox botnet have been leaked over the past few years which\nwould make the code reuse feasible for the Medusa malware author. All other portions of the\ncode, except for the HTTP-based command and control communications, remain very similar\nto the IRC version of the Medusa botnet.\n\n## Command and Control Communication\n\nThe latest version of MedusaHTTP uses a HTTP-based command and control (C2)\ncommunication method as opposed the IRC communication of its predecessor. The initial\nconnection uses a POST request with a static user agent of Mozilla/5.0 (X11; Ubuntu;\n**Linux i686; rv:45.0) Gecko/20100101 Firefox/45.0 sent to the C2. In the POST request**\npayload, the victim bot will send introspection information using a xyz form item. The format\nof the introspection information payload follows this format:\n\n**xyz=08:00:27:??:??:??|<OS Type>|Version**\n\nan example of this would be:\n\nAfter the check-in command is sent, the C2 will either respond with a HTTP status code 200\nas seen below:\n\nor send back one of the following commands:\n\n.icmp [host] [threads] [delay] [stoptime]\n[.httpseebix [www.website.com] [page.php] [threads] [delay] [stoptime]](http://www.website.com/)\n[.httpoverload [www.website.com] [page.php] [threads] [delay] [stoptime]](http://www.website.com/)\n[.httpstrong [www.website.com] [page.php] [threads] [delay] [stoptime]](http://www.website.com/)\n\n\n-----\n\n[.httpactive [www.website.com] [page.php] [threads] [delay] [stoptime]](http://www.website.com/)\n[.httpssl [www.website.com] [page.php] [threads] [delay] [true/false] [stoptime]](http://www.website.com/)\n[.proxy [www.website.com] [page.php] [webpagewithproxy] [threads] [delay] [stoptime]](http://www.website.com/)\n[.httppost [www.website.com] [page.php] [postcontent] [threads] [delay] [stoptime]](http://www.website.com/)\n[.smartflood [GET] [www.website.com] [page.php] [threads] [delay] [stoptime]](http://www.website.com/)\n[.smartflood [POST] [www.website.com] [page.php] [postcontent] [threads] [delay]](http://www.website.com/)\n\n[stoptime]\n.syn [host] [port] [sockets] [threads]\n.udp [host] [port] [sockets] [threads] [packetsize]\n[.download [http://website.com/exe.exe] [filename] [true/false]](http://website.com/exe.exe)\n.stop-[methodname]\n.stop-all\n\nAfter which the bot will either wait and check-in again at a later time or act on the specific\ncommand received.\n\n## Purported Capabilities\n\nStevenkings claims MedusaHTTP is capable of the following:\n\n**.httpssl is made for TLS and SSL websites. Using the TRUE option on httpssl will grab**\ncookies.\n**.icmp is a layer 3 flood.**\n**.httpseebix is  custom HTTP GET flood.**\n**.httpstrong is a fast HTTP flood method.**\n**.httpactive is a mix of TCP and layer 7.**\n**.httpoverload can crash certain servers.**\n**.httpproxy uses proxy servers to execute a DDoS.**\n**.httppost is a POST flood.**\n**.httpsmartflood bypasses all cookie protection unless its captcha.**\n**.syn TCP flood which bypasses OVH.**\n**.udp is basic UDP flood.**\n\n## Observed Command Traffic\n\nASERT observed and was able to capture DDoS and command traffic from a portion of the\npurported attack types available to MedusaHTTP.\n\n### .httpseebix\n\n\n-----\n\nThis command sends GET requests using 1 of 12 user agents randomly chosen from a\npredefined list, similar to the below example:\n\n### .httpstrong\n\nThis command appears to be similar to .httpseebix however this uses only one hardcoded\nuser agent to perform http GET request.\n\n### .httpoverload\n\nThis command appears to be the same as .httpseebix; Stevenkings claims it has the ability\nto crash certain servers.\n\n### .httpactive\n\nThis command is advertised as a mixture of TCP and Layer 7 Flooding that has the ability to\ntake down servers. Below you can see the utilization of multiple GET requests with a TCP\npacket of “0000000” in between them, illustrating this technique.\n\n### .smartflood (GET)\n\nThis command is purported to bypass cookie protection by StevenKings. The POST version\nof this command takes an additional parameter ‘Payload’ which, in this example, is\n‘hello=hello’.\n\nThere is also a GET version of this command which looks similar however does not include\nthe POST data.\n\n\n-----\n\n### .download\n\nThis command instructs the bot to download and run executables, which could be a bot\nupdate or additional malicious files. The method of downloading the executables is a simple\nHTTP GET request.\n\n### .stop-all\n\nThis command instructs the bot to stop all active attacks.\n\n## Conclusion\n\nMedusaHTTP has evolved from its prior IRC version. Although there is a new command and\ncontrol communication mechanism, a large amount of functionality overlap remains. Many of\nthe DDoS traffic examples above are exactly the same profile of traffic generated by\nMedusaIRC and continue to be mitigated in the same way using situationally appropriate\nfirewall ACLs and other countermeasures available in Arbor products including HTTP\nAuthentication, Zombie Detection, and AIF Malware Family Blocking.\n\n## Indicators\n\n### Samples:\n\n2919a13b964c8b006f144e3c8cc6563740d3d242f44822c8c44dc0db38137ccb\n85ebf6330039de69dbef1a4860274f21d8b980adb9c3d8385873c5d697c61685\ne514935ab07b29ca1ee9eedaf699de202ada70e29b4fc4618908b8ca8b3f83ef\n290eb4666848172a03c9c5123c004278647e8f5445a7d4e9c29a9ecc58c1b329\n4654f4cbd9e3910f4901493b9774d978060f1c9a9489612b66d66ee61667f60f\n\n### Command and Control Domains:\n\nDisability[.]su\nFranchessko[.]top\nIrcnews[.]wang\nKjnsfiosgjnlorgiko[.]ru\nMhforum[.]biz\nMissyiurfound[.]bid\nscam-financial[.]org\n\n\n-----\n\nsgsdgsdger[.]ru\ntroyamylove[.]gdn\nwooow1[.]ru\nyouframegood[.]ru\n\nPosted In\n\nAnalysis\nBotnets\nDDoS Tools and Services\nInteresting Research\nMalware\nReverse Engineering\nthreat analysis\nUncategorized\n\n## Subscribe\n\n_Sign up now to receive the latest notifications and updates from NETSCOUT's ASERT._\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2017/2017-12-18 - MedusaHTTP DDoS Slithers Back into the Spotlight.pdf"
    ],
    "report_names": [
        "2017-12-18 - MedusaHTTP DDoS Slithers Back into the Spotlight.pdf"
    ],
    "threat_actors": [
        {
            "id": "b753c6a8-a83d-47bc-829d-45e56136eb7d",
            "created_at": "2023-01-06T13:46:38.97802Z",
            "updated_at": "2025-03-27T02:00:02.967861Z",
            "deleted_at": null,
            "main_name": "GozNym",
            "aliases": [],
            "source_name": "MISPGALAXY:GozNym",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673536193,
    "ts_updated_at": 1743041137,
    "ts_creation_date": 1653756834,
    "ts_modification_date": 1653756834,
    "files": {
        "pdf": "https://archive.orkl.eu/1dc2ff40822625fa85b380a89f88d373e3c2b39c.pdf",
        "text": "https://archive.orkl.eu/1dc2ff40822625fa85b380a89f88d373e3c2b39c.txt",
        "img": "https://archive.orkl.eu/1dc2ff40822625fa85b380a89f88d373e3c2b39c.jpg"
    }
}