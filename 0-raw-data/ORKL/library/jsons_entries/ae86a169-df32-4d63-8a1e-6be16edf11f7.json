{
    "id": "ae86a169-df32-4d63-8a1e-6be16edf11f7",
    "created_at": "2023-01-12T15:07:18.002202Z",
    "updated_at": "2025-03-27T02:06:03.321197Z",
    "deleted_at": null,
    "sha1_hash": "0fa609493bdb1e2cf6a9bdb402fe9d53ef41ae66",
    "title": "2021-09-09 - Threat Thursday- Get Your Paws Off My Data, Raccoon Infostealer",
    "authors": "",
    "file_creation_date": "2022-05-28T23:15:44Z",
    "file_modification_date": "2022-05-28T23:15:44Z",
    "file_size": 2031216,
    "plain_text": "# Threat Thursday: Get Your Paws Off My Data, Raccoon Infostealer\n\n**[blogs.blackberry.com/en/2021/09/threat-thursday-raccoon-infostealer](https://blogs.blackberry.com/en/2021/09/threat-thursday-raccoon-infostealer)**\n\nThe BlackBerry Research & Intelligence Team\n\nRaccoon is an information-stealing malware variant made available to subscribers through\na Malware-as-a-Service (MaaS) arrangement. It targets Windows® users, seeking out and\nstealing their stored credentials.\n\nRaccoon’s authors retain full control of its source code and feature development. Through a\nTOR-based control panel, subscribers have access to a “clean” build, which they can\nmodify to customize its deployed configuration.\n\nHarvested information will likely find value and potential buyers via underground forums\nhosted on the dark web. Examples of stolen information that could be sold or used for\nnefarious purposes include: credentials for file hosting that could be used to store and\ndistribute other malware; corporate network access sold to ransomware groups; crypto\nwallets; and email addresses that could be used to contribute to current or future malspam\ncampaigns.\n\n### Operating System\n\n\n-----\n\n### Risk & Impact\n\n Technical Analysis\n\n**Background**\n\nRaccoon is considered by its “customers” and by researchers to be a replacement for the\n[now-defunct Azorult information stealer. A preliminary version of this threat was brought](https://blogs.blackberry.com/en/2019/06/threat-spotlight-analyzing-azorult-infostealer-malware)\n[online in January of 2019, as indicated by database dump that was leaked by an apparently](https://pastebin.com/YJQqLTmu)\n[disgruntled member of the development team. It was first seen in the wild in April of 2019.](https://www.cyberark.com/resources/threat-research-blog/raccoon-the-story-of-a-typical-infostealer)\n\nRaccoon is, and continues to be, the work of a dedicated team rather than the work of a\nsingle individual. Russian forum posts promoting Raccoon infostealer specifically mention a\n“specialist team” being responsible for its development.\n\nRaccoon’s authors seem to take pride in promptly fixing issues and addressing end-user\nsupport requests. Their focus on responsive support is reflected in testimonials, positive\nreviews, and reported high levels of subscriber satisfaction.\n\nThis level of “customer service” elevates their position within the cybercriminal community\nas a reputable and reliable service provider. The cost of a monthly subscription to Raccoon\nis under USD $100, with discounts available for longer commitments.\n\nPacking and protecting a Racoon build is the responsibility of each subscriber. Doing so\ncould help prevent detection by legacy signature-based endpoint protection.\n\nThe method of delivery for Raccoon is also chosen by the subscriber. Past campaigns have\nbeen delivered via exploit kits, spam emails with malicious attachments (such as Microsoft®\nWord documents with macros), and SEO-optimized search results for game cheats and\napplication “cracks.”\n\nRaccoon is often deployed in a “hit-and-run\" manner. After network credentials, cookies,\nand crypto wallets have been exfiltrated, all working folders and the main Raccoon\nexecutable are deleted from the victim’s disk.\n\n\n-----\n\nDependencies that enable the credential-harvesting function of Raccoon are delivered as a\nZIP file of DLLs, which is downloaded as part of its execution. This “division of\nresponsibility” reduces the size of the primary executable.\n\n**Subject of Interest**\n\nSample hash:\n**d7b4e7a29b5a4c2779df187c35b8137f5f27a9f0a06527d0966b8537c0a2c5ec**\n\nThe build of Raccoon that was analyzed for this post is a 32-bit Windows executable.\nSubscribers also have access to a DLL version.\n\nThe first submission date of this sample to VirusTotal is from early August 2021. Metadata\nwithin the executable is in conflict, claiming sample creation in September 2020 (PE\ncreation timestamp) and June 2021 (PE debug). Thankfully, Raccoon also generates its\nown run-time log, which shows a build date of late February 2021. This inconsistency is\nlikely the result of whatever packer was used to protect the sample.\n\n_Figure 1: Raccoon log entry showing likely compile timestamp_\n\nThe packer for this sample generated an incredibly large number of recurrent function calls\nwith discarded return values. Because they are called tens of thousands of times, these\nwork to delay execution, complicate analysis, and make sandbox reports extremely noisy,\nas seen in the image below.\n\n\n-----\n\n_Figure 2: IDA graph showing recurrent functions calls designed to hamper analysis_\n\n**Friendly Fire**\n\nRaccoon’s actual entry point coincides with a call to the OLE32.DLL “CoInitialize” function.\nThis behavior offers a convenient means to side-step the obfuscation. Armed with this\nknowledge, we can zero in on Raccoon’s core features.\n\nTo prevent concurrent execution, Racoon creates a mutex derived from the current\nusername and a hardcoded string prefix, “uiabfqwfu.”\n\n_Figure 3: Runtime mutex created by Raccoon_\n\nRegional settings of the host computer are then checked and compared against a list of\nCommonwealth of Independent State (CIS) countries, made up of nine former republics of\nthe Soviet Union. Execution halts with no further action if a match is found.\n\n**Raccoon Phone Home**\n\n\n-----\n\nThe primary command and control (C2) check-in is hard-coded within the Raccoon\nexecutable. This information is RC4 encrypted and Base64 encoded. The RC4 key is also\nstored within the executable.\n\nThe C2 URL resolves to what appears to be a fake Telegram domain registered in 2018.\nThe first resolution of this domain to an IP address was made in June of 2021. The landing\npage is constructed using content retrieved from the legitimate Telegram service:\n\n_Figure 4: Telegram user account showing Base64 encoded C2 link_\n\nLocated on the landing page in the channel description is a Base64 encoded string, as seen\nabove. Raccoon extracts this string and decrypts it to identify the second-stage C2 gateway.\n\nWithin the executable, the primary C2 URL and config_id are both stored in 260-byte\nplaceholders. The clear-text RC4 key used to decrypt the second-stage C2 URL resides in\na similar 100-byte placeholder. These markers remain consistent across different builds of\nRaccoon, and form part of the YARA rule published at the conclusion of this report.\n\nRaccoon grabs the unique Windows GUID and current username. This information is\nincluded in a C2 POST request, together with the configuration ID. Prior to transmission, the\nstring is once again RC4 encrypted and Base64 encoded:\n\nb=D6744488-8D2E-4BD1-7812C37123498E72_Zaphod&c=76965ce08094e45ba176fa000c8299935ebdd965&f=json\n\nb= Unique Windows machine GUID + Username concatenated\n\nc= Current/requested configuration ID\n\n\n-----\n\nf= Desired configuration format\n\n_Figure 5: C2 POST check-in with host identity information_\n\nIn keeping with previous transmissions, the response from the C2 is also RC4 encrypted\nand Base64 encoded. The clear text version of this transmission reveals a JSON document\nwith download links for a ZIP file of library DLLs. Loaded by Raccoon, these provide the\nsame code routines used by legitimate applications to extract stored credentials. In effect,\nRaccoon mimics the same calls a trusted application makes, but with its own DLLs.\n\nA non-exhaustive list of legitimate applications that use the downloaded library files is\nshown in the table below. Some of the DLLs provide code paths necessary to extract stored\ncredentials from the corresponding application, while others are included to satisfy runtime\ndependencies.\n\n**Filename** **Relationship**\n\nsqlite3.dll SQLite3 library; used by Mozilla Firefox, Microsoft Edge + others\n\nnssdbm3.dll Legacy Mozilla library\n\nprldap60.dll Mozilla Thunderbird; LDAP credentials\n\nqipcap.dll Mozilla Firefox\n\nsoftokn3.dll Mozilla Firefox\n\nAccessibleHandler.dll Mozilla Firefox\n\nbreakpadinjector.dll Mozilla Firefox\n\nfreebl3.dll Mozilla Firefox\n\nIA2Marshal.dll Mozilla Firefox\n\n\n-----\n\nldap60.dll Mozilla Thunderbird; LDAP credentials\n\nldif60.dll Mozilla Thunderbird\n\nlgpllibs.dll Mozilla Firefox\n\nlibEGL.dll Google Chrome\n\nMapiProxy.dll Mozilla Thunderbird; MAPI library\n\nmozglue.dll Mozilla Firefox\n\nmozMapi32.dll Mozilla Firefox\n\nnss3.dll Mozilla Foundation\n\nnssckbi.dll Mozilla Foundation\n\nnssdbm3.dll Mozilla Foundation\n\nAlso included in the JSON configuration are settings to enable screenshots and selfdestruction, as well as patterns to incorporate when searching for files. Raccoon is also\ncapable of downloading and launching other executables. However, in this instance, those\nfeatures are not being used.\n\n\n-----\n\n_Figure 6: Decoded JSON document showing configuration parameters_\n\nA [complete breakdown of the JSON fields was published in May of this year by researchers](https://blog.cyberint.com/raccoon-stealer)\nat CyberInt.\n\nClear-text strings in the main Raccoon executable reference common Windows\napplications, predominantly web browsers and email clients, as seen in Figures 7 and 8.\n\nThese strings are references to targeted applications. The majority are snippets of registry\npaths that either will be queried to determine whether an application is installed, or they will\nbe queried directly to gather the credentials that are stored in these specific registry paths.\n\n\n-----\n\nFigure 7: Strings within the executable referencing common desktop applications\n\n_Figure 8: Strings within the executable referencing Microsoft® Outlook credential stores_\n\nAside from sniffing out stored credentials, Raccoon will also probe for the existence of\nwallet files used by popular crypto apps. Any wallet files found will be copied and included\nas part of the final upload.\n\n\n-----\n\n_Figure 9: Popular crypto wallets probed by Raccoon_\n\n**Hit and Run**\n\nAll harvested information is copied to files under a random-named temporary folder. Once\nthere, the stash is bundled into a ZIP file and uploaded to the C2.\n\nFollowing upload, the configuration of this Raccoon sample called for it to delete itself.\n\n_Figure 10: Self-deletion command at the conclusion of execution_\n\nIt should be noted that self-destruction by Raccoon can be incomplete. Remnants of\ndownloaded library files were left on disk. These may have been locked by the operating\nsystem, preventing their deletion.\n\n_Figure 11: Residual file system artifacts left on disk after execution_\n\n### Conclusion\n\n\n-----\n\nWhile it may lack the features of its more complex counterparts, Raccoon offers an\naffordable avenue into the world of cybercrime for both fledgling cyber-criminals and\nseasoned threat actors alike. The managed service aspect eliminates nearly all technical\nhurdles to entry, allowing its subscribers to focus solely on the targeting and sale of\nharvested information.\n\n### YARA Rule\n\nThe following YARA rule was authored by the BlackBerry Research & Intelligence Team to\ncatch the threat described in this document:\n\n**rule RaccoonInfoStealer**\n\n{\nstrings:\n$b64_conf_id = /[A-Za-z0-9+\\/=\\ ]+/\n\n$hx_str_xor = { F6 D1 30 8C 15 ?? FD FF FF 42 83 FA ?? 73 08 8A 8D ?? FD FF\nFF EB }\n\ncondition:\n\n!b64_conf_id[1] == 260 or\n\nall of ($hx*)\n\n}\n\n### Indicators of Compromise (IoCs)\n\n\n-----\n\n**Network: “gate/log.php”**\n\n**Network: “GET https://telete.in/<channel>”**\n\n**Network: “GET https://tttttt.me/<channel>”**\n\n**Network: “GET https://tttttt.me/mimimimaxormin”**\n\n**Network: “POST http://5.181.156[.]252/**\n\n**Network: “POST http://66.115.165[.]153/”**\n\n**Network: “POST http://34.135.32[.]61/”**\n\n**Network: “POST http://95.216.186[.]40/”**\n\n**File system: %LOCALAPPDATA%low\\screen.jpeg**\n\n**File system: %LOCALAPPDATA%low\\machineinfo.txt**\n\n**File system: %LOCALAPPDATA%low\\sqlite3.dll**\n\n**PE export: “_CallPattern@8”**\n\n**Runtime mutex: “uiabfqwfu<Username>”**\n\n### BlackBerry Assistance\n\nIf you’re battling Raccoon infostealer or a similar threat, you’ve come to the right place,\nregardless of your existing BlackBerry relationship.\n\n[The BlackBerry Incident Response team is made up of world-class consultants dedicated to](https://www.blackberry.com/us/en/services/incident-response)\nhandling response and containment services for a wide range of incidents, including\nransomware and Advanced Persistent Threat (APT) cases.\n\nWe have a global consulting team standing by to provide around-the-clock support, if\nrequired, as well as local assistance. Please contact us here:\n\nhttps://www.blackberry.com/us/en/forms/cylance/handraiser/emergency-incident-responsecontainment\n\n\n-----\n\n## About The BlackBerry Research & Intelligence Team\n\nThe BlackBerry Research & Intelligence team examines emerging and persistent threats,\nproviding intelligence analysis for the benefit of defenders and the organizations they serve.\n\nBack\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-09-09 - Threat Thursday- Get Your Paws Off My Data, Raccoon Infostealer.pdf"
    ],
    "report_names": [
        "2021-09-09 - Threat Thursday- Get Your Paws Off My Data, Raccoon Infostealer.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673536038,
    "ts_updated_at": 1743041163,
    "ts_creation_date": 1653779744,
    "ts_modification_date": 1653779744,
    "files": {
        "pdf": "https://archive.orkl.eu/0fa609493bdb1e2cf6a9bdb402fe9d53ef41ae66.pdf",
        "text": "https://archive.orkl.eu/0fa609493bdb1e2cf6a9bdb402fe9d53ef41ae66.txt",
        "img": "https://archive.orkl.eu/0fa609493bdb1e2cf6a9bdb402fe9d53ef41ae66.jpg"
    }
}