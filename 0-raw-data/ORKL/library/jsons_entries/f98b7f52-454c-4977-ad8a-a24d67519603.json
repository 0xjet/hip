{
    "id": "f98b7f52-454c-4977-ad8a-a24d67519603",
    "created_at": "2023-01-12T15:08:30.636497Z",
    "updated_at": "2025-03-27T02:11:49.788121Z",
    "deleted_at": null,
    "sha1_hash": "354c6daeab15d6e6b9e2ae5fae8eed8c409c8e84",
    "title": "2020-10-28 - Fake COVID-19 survey hides ransomware in Canadian university attack",
    "authors": "",
    "file_creation_date": "2022-05-28T19:21:35Z",
    "file_modification_date": "2022-05-28T19:21:35Z",
    "file_size": 1636449,
    "plain_text": "# Fake COVID-19 survey hides ransomware in Canadian university attack\n\n**[blog.malwarebytes.com/cybercrime/2020/10/fake-covid-19-survey-hides-ransomware-in-canadian-university-attack/](https://blog.malwarebytes.com/cybercrime/2020/10/fake-covid-19-survey-hides-ransomware-in-canadian-university-attack/)**\n\nThreat Intelligence Team October 28, 2020\n\n_This post was authored by Jérôme Segura with contributions from Hossein Jazi,_\n_Hasherezade and Marcelo Rivero._\n\n[In recent weeks, we’ve observed a number of phishing attacks against universities worldwide](https://blog.malwarebytes.com/malwarebytes-news/2020/10/silent-librarian-apt-phishing-attack/)\nwhich we attributed to the Silent Librarian APT group. On October 19, we identified a new\nphishing document targeting staff at the University of British Columbia (UBC) with a fake\nCOVID-19 survey.\n\nHowever, this attack and motives are different than the ones previously documented. The\nsurvey is a malicious Word document whose purpose is to download ransomware and extort\nvictims to recover their encrypted files.\n\nOn discovery, we got in touch with UBC to report our findings. They were already aware of\nthis phishing campaign and were kind enough to share more information with us about the\nincident. Ultimately, this attack was not successful due to the rapid response of the UBC\ncybersecurity team.\n\n### Mandatory COVID-19 survey distributed to targeted recipients\n\n\n-----\n\nThe attacker created an email address with the mailpoof.com service in order to register\naccounts with Box.net and DropBox. Rather than directly sending the fake survey via email,\nthe attacker uploaded the document onto Box and DropBox and used the share functionality\nfrom these platforms to distribute it.\n\nThis was probably done to evade spam and phishing filters that would have blocked\nmessages coming from a newly registered email address with a low reputation. In\ncomparison, it is much more difficult to detect spam from file sharing services without\ncreating a number of false positives.\n\nThe attacker claimed to be a manager and added the following comment in the file sharing\ninvitation (shared with us by UBC):\n\nGood evening gals and guys! [redacted] here, [redacted] manager for [redacted]. I am\nsharing a mandatory survey with you that must be completed by Monday. It asks a few\nquestions about how you believe our company responded to the pandemic regarding\nremote working and much more. Please fill it out ASAP!\n\nYou will also find a form at the end that you can fill out if you need any necessities!\nNecessities include: gloves, hand sanitizer, masks, or disinfectant spray. We will be\nproviding it to those employees who fill out the form for free! Simply sign your initials\nand put what you need as well as the quantity! In advance, we appreciate your\nfeedback! Thanks all! Stay strong! I understand times like this can be difficult!\n\n\n-----\n\nFigure 1: The phishing document targeting UBC staff\nAccording to UBC, less than a hundred people within a specific department received the link\nto access the shared document. A Box or Dropbox account was required in order to\ndownload the file since it was shared privately, instead of publicly. This may have been an\neffort to evade detection or perhaps the attacker expected the target organization to already\nbe using one of these two sharing services.\n\n### Phishing document analysis\n\n\n-----\n\nThe phishing document uses template injection to download and execute a remote template\n(template.dotm) weaponized with a malicious macro. That file was uploaded to a free code\nhosting website (notabug.org).\n\n\n-----\n\nFigure 2: Template injection and a view of the macro\nWhen the macro is executed, it does the following:\n\nGets the %APPDATA% directory\nCreates the Byxor directory in %APPDATA%\nDownloads a file from the following url and writes it as Polisen.exe\n_notabug[.]org/Microsoft-Office/Word-Templates/raw/master/lamnarmighar/polisen.exe_\nDownloads a file from the following url and writes it as Killar.exe\n_notabug[.]org/Microsoft-Office/Word-Templates/raw/master/lamnarmighar/killar.exe_\nCalls shell function to execute killar.exe\nChecks the output of shell function and whether it was successful (return value would\nbe task Id of executed application)\n\nIf successful, it sends a GET http request to:\n_canarytokens.com/about/d4yeyvldfg6bn5y29by4e9fs3/post.jsp_\nIf it isn’t successful, it sends a GET http request to:\n_canarytokens.com/articles/6dbbnd503z06qitej1sdzzcvv/index.html_\n\n\n-----\n\nFigure 3: Code repository containing ransomware payloads\nWe were able to identify four other variants of the remote templates and payloads. In some\nof the folders, we found several artifacts using Swedish words, which could indicate that the\nthreat actor is familiar with the language.\n\nOpening the phishing document will trigger a notification via the canarytokens.com website.\nTypically, people use this type of service to get alerted for a particular event.\n\nThis can be very useful as an early warning notification system that an intruder has had\naccess to a network. In this case, the attacker is probably interested in how many people\nopened the document and perhaps where they are from.\n\n### Vaggen ransomware\n\nAfter being deployed, the ransomware starts encrypting the user’s files and adding the\n.VAGGEN extension to them. When the encryption process is finished, it drops a ransom\nnote on the Desktop, demanding a payment equivalent to 80 USD to be paid in Bitcoin.\n\n\n-----\n\nFigure 4:\n\nRansom note\nThe ransomware appears to be coded from scratch and is a relatively straightforward\napplication written in Go which starts with the function denoted as ‘main_main’.\n\nOther functions belonging to the main application have obfuscated names, such as:\nmain_FOLOJVAG, main_DUVETVAD, main_ELDBJORT, main_HIDDENBERRIES,\nmain_LAMNARDETTA, main_SPRINGA.\n```\nmain_LAMNARDETTA -> main_enumDir\nmain_ELDBJORT -> main_encryptFile\nmain_SPRINGA -> main_encryptAndRename\nmain_FOLOJVAG -> main_runCommands\nmain_DUVETVAD -> main_dropFile\nmain_HIDDENBERRIES -> main_xteaDecryptAndWriteToFile\n\n```\nA full list of the functions, along with their RVAs can be found [here.](https://github.com/MBThreatIntel/malspam/blob/master/killar.csv)\n\n\n-----\n\nFigure 5: File enumeration\nSome of the strings used by the malware (i.e. the content of the ransom note) are encrypted\n[with the help of XXTEA (using library: xxtea-go). Encrypted chunks are first decoded from](https://github.com/xxtea/xxtea-go)\nBase64. The XXTEA key is hardcoded (“STALKER”). At the end of the execution, the ransom\nnote is dropped on the Desktop.\n\nEncrypting and renaming of the files is deployed as the callback of the standard Golang\nfunction: path.filepath.Walk.\n\n\n-----\n\nFigure 6: Callback function to encrypt and rename\nFiles are encrypted with AES-256 (32 byte long key) in GCM mode.\n\n\n-----\n\nFigure 7: AES-256 cipher\n[The encryption algorithm is similar to the one demonstrated here. Using a hardcoded key](https://www.golangprograms.com/data-encryption-with-aes-gcm.html)\nand 12 bytes long nonce, generated by CryptGenRandom. The file content is encrypted with\nthe help of the gcm.Seal function.\n\n\n-----\n\nFigure 8:\n\n\nEncryption routine\nThe content of the output file (with .VAGGEN extension) contains:\n\nthe 12 bytes long nonce\nthe encrypted content\nthe 16 byte long GCM Tag\n\n\n-----\n\nFigure 9: Highlighted part contains encrypted content\nThe hardcoded key “du_tar_mitt_hjart_mina_pengarna0” found inside the malware code is\n[Swedish for “you take my heart my money”. Using this key, we can easily decrypt the](https://gchq.github.io/CyberChef/#recipe=AES_Decrypt(%7B'option':'Latin1','string':'du_tar_mitt_hjart_mina_pengarna0'%7D,%7B'option':'Hex','string':'DA%20D7%20BE%2065%2029%204D%2099%202D%2055%20C8%20B3%20AB'%7D,'GCM','Hex','Raw',%7B'option':'Hex','string':'D91D67EE45C247B8F9E0353F89342542'%7D)&input=OTIgNTQgMzUgRTIgNEYgODggNzYgMTkgOTEgMkIgMTIgRTYgMEIgMUIgN0EgQTQgOEMgQjcgNDQgODEgNUMgRTAgQjUgQzYgQTIgOTggMEYgRjIgQjcgRkIgMDUgRDUgMkQgQzggNTYgODUgMzAgRUYgMEUgRDUgNDEgRTcgOEEgOTIgNjkgMjcgMjEgRUIgMkYgQTMgNEMgOUEgQkMgN0UgRjQgRjQgQ0UgQUIgMDkgMDYgQjggOTcgMkUgQ0EgNTAgMTAgMUUgNjMgNjEgM0MgRTcgQjMgMUQgNzIgNUEgNkEgOEQgQzIgQTYgMEMgMjcgOTggQzUgRTMgMUUgNzUgOUEgNTYgOTggNTIgOTIgRTMgREMgRUEgMjggQTIgNDYgNTAgMEIgRDEgOEEgNjQgNkYgOEEgRDIgN0IgRjIgRDEgODkgRTUgQ0UgMzMgQzcgREMgRjIgNkMgNjcgRTYgREEgNDcgMjkgRTggRjMgOUYgMUMgRUUgNjEgOUMgOTEgNTQgNDYgODIgRkQgODAgRUIgNkYgQTMgREEgNzcgREMgQkIgQ0EgRUQgQTYgRTcgODUgRkIgREYgMTQgQkQgRUUgNTYgMkYgNzggMDAgQjkgRTQgQjEgMUYgMkYgRjcgRjEgMDkgQUIgMjAgRjAgQzYgQUMgREMgQzYgNjIgNDAgQkUgM0QgMEMgNTggNDggQjAgMkIgRkIgQ0YgREIgQTYgNzcgQkEgOEMgRTIgQkEgMjUgN0MgNzUgNDUgRjkgNDQgNEUgQTUgNjkgMTIgREEgMUQgOEEgODQgRUEgOUYgRTIgMzkgRjYgMzEgRDUgMzcgM0YgNUEgOTcgRTIgMzkgQkMgQzMgQkEgRkYgMzggODUgNjYgNTAgQUQgQzQgMUYgMEUgQzIgNjIgNkYgOEMgQTkgRjUgQUYgREQgQzUgREYgN0EgMzAgRjkgODkgMTYgOUQgNjkgQkEgRTUgNDYgMjkgNTkgQjUgQzIgRjMgRkUgRUUgQUEgNjUgQzYgRUQgNjQgQTMgQjggRkIgQTIgNkUgREIgMzkgOEUgRDEgN0YgOTcgOUMgQUIgRjMgRTggMDUgMTMgOUQgNDQgMDMgRTggOEIgN0QgNjYgQzcgMDIgQUMgNzYgRjEgNDIgOUQgRDkgMzEgMEUgMkMgNDEgOEYgOUYgNUEgOEYgQjMgM0IgMDUgMzggRDEgMzkgMUIgREMgMzcgQzAgMDUgRTIgRUIgRjQgNUQgQTEgMTIgQjQgOEQgM0MgMTQgNUIgN0IgQTMgNjkgMUYgMjMgMTEgNEEgODIgMTcgMjYgRTMgNzIgQkUgNjEgRUIgMkEgQUMgQzMgODQgNjggOTYgNDcgNTkgQkEgOTAgQzIgOUEgMkQgNzcgMUMgREUgMTEgN0YgMEQgNzggQzAgREUgMDcgMzUgMUQgNjIgMDEgODkgRjQgMkUgMkYgMzggOTMgREUgRkQgNDQgQTMgNkQgMTEgRkUgODAgREQgNDggMDYgOUQgQ0IgRTAgNDkgRTcgQTYgQkMgOEUgN0YgRjkgRDMgMzEgRjIgNzggNDkgNzUgREEgRkMgQzYgN0MgMjYgNzUgNjcgRTIgOTEgQzMgQzggNUEgQzYgMjMgRkEgMTQ)\ncontent.\n\nFigure 10: Encryption key found inside the code\n\n\n-----\n\nWith all these elements, we can actually recover encrypted files without having to pay the\nransom. It appears that the malware author has not received any payment so far at this\n[Bitcoin address.](https://www.blockchain.com/btc/address/1LthWWSd82dKddmHwqhBv8XHiCYyUZqhmA)\n\nFigure 11: Bitcoin address showing no payment\n\n### Unusually low ransom amount\n\nBased on our findings, we believe this is not a sophisticated threat actor, nor affiliated with\nany of the big ransomware gangs such as Ryuk. The ransom amount is unusually low, and\nunlike professional ransomware, this attack can be recovered from fairly easy.\n\nHowever, the phishing attack was well conceived and the template looks well designed, with\na nice touch of adding canary tokens. It’s unclear at this point if the University of British\nColumbia was the sole target or not.\n\nCrawling additional repositories created by the threat actor, we found other Word template\nfiles that have used a very similar macro to drop a coin miner. This casts more questions\nabout the motivation behind this phishing attack.\n\nWe are grateful for the information shared with us by the University of British Columbia. This\nallowed us to paint a better picture of this attack and understand who the targets were.\n\nMalwarebytes customers were already protected thanks to our signature-less Anti-Exploit\nlayer.\n\n\n-----\n\nFigure 12:\n\nPhishing document blocked by Malwarebytes Endpoint Protection\n\n## IOCs\n\n**_Variant1:_**\n\n_summerofficetemplate.dotm_\n\n634264996c0d27b71a5b63fb87042e29660de7ae8f18fcc27b97ab86cb92b6d4\n\nnotabug[.]org/arstidar/VARLDVINNA/raw/master/irving.exe\n\nnotabug[.]org/arstidar/VARLDVINNA/raw/master/alderson.exe\n\ncanarytokens[.]com/traffic/jnk5rpagi54vztro6tau6g1v6/index.html\n\ncanarytokens[.]com/traffic/articles/tags/z8yobwprmmopmyfyw8sb1fb0a/index.html\n\n_alderson.exe_\n\n34842eff9870ea15ce3b3f3ec8d80c6fd6a22f65b6bae187d8eca014f11aafa5\n\n_irving.exe_\n\n00c60593dfdc9bbb8b345404586dcf7197c06c7a92dad72dde2808c8cc66c6fe\n\n\n-----\n\n**Variant2:**\n_UBC-COVID19-Survey-Mandatory.docx_\ne869e306c532aaf348725d94c1d5da656228d316071dede76be8fcd7384391c3\n_template.dotm_\n334531228a447e4dfd427b08db228c62369461bb2ccde9ab1315649efd0316b1\nnotabug[.]org/Microsoft-Office/Word-Templates/raw/master/lamnarmighar/polisen.exe\nnotabug[.]org/Microsoft-Office/Word-Templates/raw/master/lamnarmighar/killar.exe\ncanarytokens[.]com/about/d4yeyvldfg6bn5y29by4e9fs3/post.jsp\ncanarytokens[.]com/articles/6dbbnd503z06qitej1sdzzcvv/index.html\n_polisen.exe_\n03420a335457e352e614dd511f8b03a7a8af600ca67970549d4f27543a151bcf\n_killar.exe_\n43c222eea7f1e367757e587b13bf17019f29bd61c07d20cbee14c4d66d43a71f\n\n**Variant3:**\n_template1.dotm_\n225e19abba17f70df00562e89a5d4ad5e3818e40fd4241120a352aba344074f4\nnotabug[.]org/Microsoft-Templates/Template/raw/master/irving.exe\nnotabug[.]org/Microsoft-Templates/Template/raw/master/alderson.exe\ncanarytokens[.]com/images/tags/8pkmk2o11dmp1xjv5i9svji32/contact.php\ncanarytokens[.]com/articles/traffic/5ayx8tydzeuzhmq6y5u2lxhpa/post.jsp\n\n**Variant4:**\n_smoothtemplates.dotm_\nada43ee41f70e327944121217473c536024cd9c90e25088a1a6c5cf895f59fe1\nnotabug[.]org/arstidar/VARLDVINNA/raw/master/irving.exe\nnotabug[.]org/arstidar/VARLDVINNA/raw/master/alderson.exe\ncanarytokens[.]com/traffic/jnk5rpagi54vztro6tau6g1v6/index.html\ncanarytokens[.]com/traffic/articles/tags/z8yobwprmmopmyfyw8sb1fb0a/index.html\n_alderson.exe_\nb4a1a0012abde1ae68f50fa1fe53df7a5d933ec5410731622ab0ad505915cfb6\n_irving.exe_\n00c60593dfdc9bbb8b345404586dcf7197c06c7a92dad72dde2808c8cc66c6fe\n\n**Variant5:**\ntemplate.dotm:\n7ad8a3c438f36cdfc5928e9f3c7c052463b5987055f583ff716d0382d0eb23b4\nnotabug[.]org/Microsoft-Office/Office-Templates/raw/master/mrclean.exe\nnotabug[.]org/Microsoft-Office/Office-Templates/raw/master/mrmonster.exe\ncanarytokens[.]com/images/feedback/tags/0xu6dnwmpc1k1j2i3nec3fq2b/post.jsp\ncanarytokens[.]com/traffic/about/images/ff6x6licr69lmjva84rn65hao/contact.php\nmrmonster.exe\n\n\n-----\n\nf42bbb178e86dc3449662b5fe4c331e3489de01277f00a56add12501bf8e6c23\nmrclean.exe\n71aadf3c1744f919cddcc157ff5247b1af2e2211b567e1eee2769973b2f7332a\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2020/2020-10-28 - Fake COVID-19 survey hides ransomware in Canadian university attack.pdf"
    ],
    "report_names": [
        "2020-10-28 - Fake COVID-19 survey hides ransomware in Canadian university attack.pdf"
    ],
    "threat_actors": [
        {
            "id": "5d2bd376-fcdc-4c6a-bc2c-17ebbb5b81a4",
            "created_at": "2022-10-25T16:07:23.667223Z",
            "updated_at": "2025-03-27T02:02:09.916086Z",
            "deleted_at": null,
            "main_name": "GCHQ",
            "aliases": [
                "Government Communications Headquarters",
                "Operation Socialist"
            ],
            "source_name": "ETDA:GCHQ",
            "tools": [
                "Prax",
                "Regin",
                "WarriorPride"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "7ba9e3e3-1cef-4e20-be7e-95f05e8295d7",
            "created_at": "2022-10-25T16:07:23.821494Z",
            "updated_at": "2025-03-27T02:02:09.993311Z",
            "deleted_at": null,
            "main_name": "Mabna Institute",
            "aliases": [
                "Cobalt Dickens",
                "Mabna Institute",
                "Silent Librarian",
                "TA407",
                "TA4900",
                "Yellow Nabu"
            ],
            "source_name": "ETDA:Mabna Institute",
            "tools": [],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "adc8bb1a-6ded-4b27-8163-8069d5a6d492",
            "created_at": "2022-10-25T15:50:23.566869Z",
            "updated_at": "2025-03-27T02:00:55.500642Z",
            "deleted_at": null,
            "main_name": "Silent Librarian",
            "aliases": [
                "Silent Librarian",
                "TA407",
                "COBALT DICKENS"
            ],
            "source_name": "MITRE:Silent Librarian",
            "tools": null,
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "42e41377-c64c-4be9-87a0-ee903e4b9055",
            "created_at": "2023-01-06T13:46:38.950322Z",
            "updated_at": "2025-03-27T02:00:02.960397Z",
            "deleted_at": null,
            "main_name": "Silent Librarian",
            "aliases": [
                "TA4900",
                "Yellow Nabu",
                "COBALT DICKENS",
                "Mabna Institute",
                "TA407"
            ],
            "source_name": "MISPGALAXY:Silent Librarian",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673536110,
    "ts_updated_at": 1743041509,
    "ts_creation_date": 1653765695,
    "ts_modification_date": 1653765695,
    "files": {
        "pdf": "https://archive.orkl.eu/354c6daeab15d6e6b9e2ae5fae8eed8c409c8e84.pdf",
        "text": "https://archive.orkl.eu/354c6daeab15d6e6b9e2ae5fae8eed8c409c8e84.txt",
        "img": "https://archive.orkl.eu/354c6daeab15d6e6b9e2ae5fae8eed8c409c8e84.jpg"
    }
}