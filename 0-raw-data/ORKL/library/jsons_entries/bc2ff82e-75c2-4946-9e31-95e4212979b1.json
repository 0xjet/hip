{
    "id": "bc2ff82e-75c2-4946-9e31-95e4212979b1",
    "created_at": "2023-01-12T15:06:15.546831Z",
    "updated_at": "2025-03-27T02:05:23.564964Z",
    "deleted_at": null,
    "sha1_hash": "7459b5883e29968c7aaa2729f33a317a0f788e84",
    "title": "2020-05-14 - Deep Dive Into TrickBot Executor Module “mexec”- Reversing the Dropper Variant",
    "authors": "",
    "file_creation_date": "2022-05-28T17:57:57Z",
    "file_modification_date": "2022-05-28T17:57:57Z",
    "file_size": 663613,
    "plain_text": "# Deep Dive Into TrickBot Executor Module “mexec”: Reversing the Dropper Variant\n\n**[labs.sentinelone.com/deep-dive-into-trickbot-executor-module-mexec-reversing-the-dropper-variant/](https://labs.sentinelone.com/deep-dive-into-trickbot-executor-module-mexec-reversing-the-dropper-variant/)**\n\nJason Reaves\n\nIn a recent post [1], we disclosed details of a new Trickbot executor module “mexec” and\n[analyzed the downloader variant of this module. In this follow up post, we provide the first](https://www.sentinelone.com/wp-content/uploads/deep-dive-into-trickbot-executor-module-mexec-hidden-anchor-bot-nexus-operations/)\nanalysis the dropper version of the mexec module.\n\nSee the report for the full list of IOCs and further details on the TrickBot executor module\n“mexec”.\n\n[Read the Full Report](https://assets.sentinelone.com/labs/sentinel-one-mexec-r)\n\n## Background\n\nTrickBot is the successor of Dyre [2,3], and at first was primarily focused on banking fraud\nand utilized injection systems in the same manner. Over the years, TrickBot has shifted focus\nto enterprise environments to incorporate everything from network profiling and mass data\ncollection to lateral traversal exploits. This focus shift is also prevalent in their incorporation\nof malware and techniques in their tertiary deliveries that are targeting enterprise\nenvironments. Such behavior is similar to a company where the focus will shift depending on\nwhat generates the best revenue.\n\n## Research Insights\n\n\n-----\n\nThe dropper version of mexec is very similar to the downloader except that the payload is\ncarried onboard, which makes the module substantially larger than its downloader\ncounterpart. The dropper variant is also very similar to TrickBot’s loader but was written to be\nable to accommodate more generic deliveries.\n\nThe dropper version of mexec functionally overlaps with how TrickLoader works:\n\nCustom Base64 alphabet string encoding\nUsage of MiniLZO\nFunction obfuscation using a table of offsets\n\nThis version of mexec could easily be misidentified as TrickLoader, but mexec is not used to\ndeliver TrickBot and is simply setup as a dropper piece that will write and execute an\nonboard hidden executable. It’s also a DLL and designed to be executed in memory to\nperform its task or to deliver another piece of malware.\n\nWhile the strings are encoded in the same manner you would expect in a Trickbot sample,\nthere are noticeably fewer of them.\n\nDecoding them is the same process as you would find in a TrickBot sample.\n\nThe first thing the sample does is spin up multiple threads, but the interesting one is the\nsecond one.\n\n\n-----\n\nIn the main thread that is spun up as the second one, it performs the normal deobfuscation\nroutine that you find in a Trickbot loader sample. If you are unfamiliar with this process of\n[deobfuscation, you can find more details in our report on TrickLoader Deobfuscation.](https://www.sentinelone.com/wp-content/uploads/revealing-the-trick-a-deep-dive-into-trickloader-obfuscation/)\n\n\n-----\n\nThe above code is the start of the process of building out the function address table; it jumps\nover a table of offsets to kick off the process.\n\nAfter rebuilding the address table, the function responsible for decoding functions is called.\n\n\n-----\n\nIn the exact same way that we go over deobfuscating the TrickLoader binary, we can do the\nsame with this sample. This will then leave us with all of the decoded functions.\n\n\n-----\n\nOne of the decoded addresses from the table does not appear to be a function; in fact, much\nlike TrickLoader, this is a LZO compressed PE file.\n\nAfter decompressing and analyzing the PE file, we discover this version of mexec is dropping\nthe DNS variant of Anchor TrickBot[4].\n\n\n-----\n\nAnother variant recovered was also dropping the normal variant of Anchor TrickBot.\n\n\n-----\n\nPivoting on the decoding string of “futuresx.exe” from above also leads to a sandbox\nreport[4] on an Anchor DNS sample. In VirusTotal, we can see this same hash was also\ndelivered through the downloader variant:\n\n## Read the Full Report\n\nSee the report for the full list of IOCs and further details on the TrickBot executor module\n“mexec”.\n\n\n-----\n\n[Read the Full Report](https://assets.sentinelone.com/labs/sentinel-one-mexec-r)\n\n## References\n\n1: Deep Dive Into TrickBot Executor Module “mexec”: Hidden “Anchor” Bot Nexus\nOperations\n\n2: [https://blog.malwarebytes.com/threat-analysis/2016/10/trick-bot-dyrezas-successor/](https://blog.malwarebytes.com/threat-analysis/2016/10/trick-bot-dyrezas-successor/)\n\n3: [https://www.fidelissecurity.com/threatgeek/archive/trickbot-we-missed-you-dyre/](https://www.fidelissecurity.com/threatgeek/archive/trickbot-we-missed-you-dyre/)\n\n4: https://www.sentinelone.com/wp-content/uploads/the-deadly-planeswalker-how-thetrickbot-group-united-high-tech-crimeware-apt/\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2020/2020-05-14 - Deep Dive Into TrickBot Executor Module “mexec”- Reversing the Dropper Variant.pdf"
    ],
    "report_names": [
        "2020-05-14 - Deep Dive Into TrickBot Executor Module “mexec”- Reversing the Dropper Variant.pdf"
    ],
    "threat_actors": [
        {
            "id": "e79324a2-bdae-4dc5-9421-578a59045288",
            "created_at": "2022-10-25T16:07:23.906087Z",
            "updated_at": "2025-03-27T02:02:10.022303Z",
            "deleted_at": null,
            "main_name": "Nightshade Panda",
            "aliases": [
                "APT 9",
                "FlowerLady",
                "FlowerShow",
                "Group 27",
                "Nightshade Panda",
                "Operation Seven Pointed Dagger"
            ],
            "source_name": "ETDA:Nightshade Panda",
            "tools": [
                "3102 RAT",
                "9002 RAT",
                "Agent.dhwf",
                "BKDR_EVILOGE",
                "BKDR_HGDER",
                "BKDR_NVICM",
                "Chymine",
                "Darkmoon",
                "Destroy RAT",
                "DestroyRAT",
                "EvilGrab",
                "EvilGrab RAT",
                "Gen:Trojan.Heur.PT",
                "HOMEUNIX",
                "HidraQ",
                "Homux",
                "Hydraq",
                "Kaba",
                "Korplug",
                "McRAT",
                "MdmBot",
                "MoonWind",
                "MoonWind RAT",
                "PlugX",
                "Poison Ivy",
                "RedDelta",
                "Roarur",
                "SPIVY",
                "Sogu",
                "TIGERPLUG",
                "TVT",
                "Thoper",
                "Trochilus RAT",
                "Vidgrab",
                "Wmonder",
                "Xamtrav",
                "pivy",
                "poisonivy"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535975,
    "ts_updated_at": 1743041123,
    "ts_creation_date": 1653760677,
    "ts_modification_date": 1653760677,
    "files": {
        "pdf": "https://archive.orkl.eu/7459b5883e29968c7aaa2729f33a317a0f788e84.pdf",
        "text": "https://archive.orkl.eu/7459b5883e29968c7aaa2729f33a317a0f788e84.txt",
        "img": "https://archive.orkl.eu/7459b5883e29968c7aaa2729f33a317a0f788e84.jpg"
    }
}