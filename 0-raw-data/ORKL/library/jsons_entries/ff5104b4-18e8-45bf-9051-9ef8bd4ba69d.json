{
    "id": "ff5104b4-18e8-45bf-9051-9ef8bd4ba69d",
    "created_at": "2022-10-25T16:48:15.847875Z",
    "updated_at": "2025-03-27T02:15:45.353284Z",
    "deleted_at": null,
    "sha1_hash": "d44d93c12fce2403517bf53705dfd78dbb61ae51",
    "title": "",
    "authors": "",
    "file_creation_date": "2022-08-15T08:14:33Z",
    "file_modification_date": "2022-08-15T08:14:33Z",
    "file_size": 1502310,
    "plain_text": "# LuckyMouse uses a backdoored Electron app to target MacOS\n\n**[blog.sekoia.io/luckymouse-uses-a-backdoored-electron-app-to-target-macos](https://blog.sekoia.io/luckymouse-uses-a-backdoored-electron-app-to-target-macos/)**\n\n12 August 2022\n\n_This blog post on LuckyMouse is an extract of the “FLINT 2022-045 – LuckyMouse_\n**_[uses a backdoored Electron app to target MacOS” report (SEKOIA.IO Flash](https://www.sekoia.io/en/sekoia-io-cti/)_**\n_Intelligence) sent to our clients on August 10, 2022._\n\n_Note: TrendMicro has published on the same campaign under the title : “Iron Tiger_\n_Compromises Chat Application Mimi, Targets Windows, Mac, and Linux Users“._\n\n## Summary\n\nDuring a review of the HyberBro Command and Control (C2) infrastructure linked to\nChina-nexus LuckyMouse intrusion set, SEKOIA spotted an unusual connection with an\napplication. Further investigation led to identify this application as “MìMì” (秘秘 –\n“secret”, aka Mi). Mimi is a Chinese-speaking Electron App developed by Xiamen\nBaiquan Information Technology Co. Ltd. SEKOIA established that “MìMì”\n**Messenger’s MacOS version is trojanized since May 26, 2022 to download**\n**and execute a Mach-O binary dubbed “rshell”.**\n\nAt this stage, SEKOIA is not able to assess the objective of this campaign. As this\n**application’s use in China appears low, it is plausible it was developed as a**\n**targeted surveillance tool. It is also likely that, following social engineering carried**\nout by the operators, targeted users are encouraged to download this application,\npurportedly to circumvent Chinese authorities’ censorship.\n\nThis is not the first time a messaging application dropping an implant connecting to the\nLuckyMouse infrastructure is observed. In 2020, our ESET fellows uncovered\n**compromised versions of Able Desktop, a messaging application widely used**\n**in Mongolia in the “StealthyTrident” operation. In this campaign, Able Desktop**\nwas used to drop several implants, including PlugX, Tmanger and HyperBro, known to be\na part of the LuckyMouse tool set.\n\nHowever, this is the first time that SEKOIA observed LuckyMouse targeting\n**MacOS. Moreover, if this application is exclusively used by Chinese citizens, it would**\n**be the first time that we identified LuckyMouse involved in domestic**\n**surveillance. This FLINT presents our findings on this campaign, including a**\ndescription of the Rshell implant, and associated IOCs.\n\n## “MìMì” Messenger backdooring\n\n\n-----\n\nThe “Mi” Application is an Electron messaging app available for Android, iOS, Windows\nand MacOS platforms. As Mi is not widely promoted, and its related website\n(www.mmimchat[.]com) doesn’t display a detailed description, general conditions of use\nor social media links, SEKOIA rapidly questioned its legitimacy.\n\nFigure 1. Mimi website at www.mmimchat[.]com\n\nMoreover, the website hosted files were last modified on July 26. Based on the Apple\nStore change logs and Passive DNS, we figured that the first traces of this application\ndates back to June 2020. However, SEKOIA was not able to assess whether this\n**application is legit, or if it was designed or repurposed as a surveillance tool.**\nAdditionally, based on our open source investigations, it is not possible to assess whether\nXiamen Baiquan Information Technology Co. Ltd. is a legit or a shell company.\n\nThe MacOS version of the “Mi” Application is an ElectronApp packaged in an Apple Disk\nImage file. This application seems to be functional, where end users simply register\nthemselves to be able to discuss with their contacts. However, in version 2.3.0,\n**published on May 26 2022, the**\n**./mimi.app/Contents/Resources/app/electron-main.js file was trojanized. As**\nshown below, this was implemented by placing a Dean Edwards Packed JavaScript code\nat the beginning of the module.exports function.\n\n\n-----\n\nFigure 2. Backdoored electron-main.js file.\n\nThis code, executed at the runtime, checks if the environment is MacOS (darwin) and\nthen downloads the “rshell” implant from 139.180.216.65, an IP address already\nassociated to LuckyMouse HyperBro C2. The retrieved payload is written in the temp\nfolder, chmoded with execution permission and then, executed as shown in the\ndeobfuscated code:\n\n**Figure 3. Code responsible for downloading and executing RShell.**\n\nWhile SEKOIA analysts checked Windows, iOS, and Android versions of the app, no\nbackdoor was found in the current versions. However, TrendMicro found old Linux\n**[and Windows versions backdoored. Read their analysis here.](https://www.trendmicro.com/en_us/research/22/h/irontiger-compromises-chat-app-Mimi-targets-windows-mac-linux-users.html)**\n\n### RShell Mach-O implant\n\n\n-----\n\nThe downloaded implant, named RShell by its developers, is written in C++ and embeds\nthe Boost.Asio and nlohmann/json libraries. This backdoor uses BJSON (Binary JSON)\nover TCP sockets to communicate with its command and control server, without any\nencryption and does not display a persistence mechanism.\n\nUpon execution, RShell backdoor attempts to connect with the C2 server. This “Hello\nmessage” to the C2 server contains:\n\na random GUID, added to each response to the C2 server\nthe hostname\nthe IPv4 adresses\nthe type of connection (“login” for instance)\nthe current username\nthe kernel version.\n\nFigure 4. Hello packet from the implant.\n\nRShell backdoor accepts two “types” of commands: “cmd” and “file”.\n\nThe group “cmd” contains three commands:\n\ninit(): start a bash\ndata(data): write data to the bash\nclose(): ends up the bash.\n\nThe second type of commands, “file”, enable interactions with the filesystem:\n\ndir(path): returns a list of files and subdirectories for the specified path\ninit(): returns a list of files and subdirectories for the root filesystem (equivalent to\ndir(“/”))\ndown(path): opens a file in binary and read-only mode and returns the size of the\nfile\nread(path): reads the specified file. The file must first have been opened with the\ndown command\nupload(path): opens a file in binary and write-only mode\nwrite(data, path): writes data to the specified file. As for the read command, the file\nmust first have been opened with the upload command before\ndel(path): delete the specified file or directory\n\n\n-----\n\nclose(path): closes the file\n\nThe following figures present an example of request and response for the dir command.\n\nFigure 5. Example of dir request\n\nFigure 6. Example of dir response\n\nA keepalive message is sent to the C2 server every 40 seconds. The server must echo this\nmessage. Based on this observation, we created a Suricata rule to spot this threat in your\nnetwork flows (see Appendix).\n\n### Links with LuckyMouse\n\n\n-----\n\nInfrastructure links were established between China-nexus Intrusion Set LuckyMouse\nand this operation.\n\nOf note, in the course of our investigation, the same HTTP server also served a HyperBro\nwhich was configured to communicate over HTTPs to 139.180.216[.]65. The malicious\nDLL of this HyperBro sample was signed by a certificate known to be stolen and then\nused by LuckyMouse. The files launching this sample were accessible at the following\nURLs:\n\nhttp://139.180.216.65/dlpumgr32.exe\nhxxp://139.180.216.65/dlpprem32.dll\nhxxp://139.180.216.65/dlpprem32.bin\n\nSecondly, both LuckyMouse and RShell operators use the same IP range, namely\n103.79.76.0/22.\n\nWhile this IP range was recently used by LuckyMouse, notably to host three HyperBro C2\nservers (103.79.77[.]200, 103.79.76[.]232, 103.79.78[.]48), two RShell C2 were also\nidentified at 103.79.76[.]88 and 103.79.77[.]178.\n\nFinally, as documented by ESET, compromised messaging applications were already\nleveraged by LuckyMouse in past activities and this Intrusion Set was observed using\nDean Edwards Javascript packer in previous watering hole campaigns.\n\n### Conclusion\n\nBased on our investigations, SEKOIA associate this activity to LuckyMouse with\n**high confidence. It is plausible this activity indicates an expansion of LuckyMouse’s**\nmandate, now including surveillance. However, as this Intrusion Set was mostly observed\ncontinuously carrying out espionage activities, notably against the technology and\ngovernmental sectors, SEKOIA assess this hypothesis is unlikely.\n\n[At the time of writing, SEKOIA refrains from making any assessment on the Intrusion](https://blog.sekoia.io/)\nSet’s motivation and will continue to closely monitor their activities. Regardless of\nLuckyMouse’s goals, it is of particular interest to observe the targeting of MacOS\n**environment. SEKOIA assess this Intrusion Set will continue updating and improving**\ntheir capabilities in the short-term.\n\n[Discover our CTI and XDR products](https://sekoia.io/en/contact/)\n\n## IOCs & Technical Details\n\n**Related infrastructure**\n```\n103.79.76[.]88\n\n103.79.77[.]178\n\n139.180.216[.]65\n\n```\n\n-----\n\n**RShell hashes**\n```\n8c3be245cbbe9206a5d146017c14b8f965ab7045268033d70811d5bcc4b796ec  rshell\n\n3a9e72b3810b320fa6826a1273732fee7a8e2b2e5c0fd95b8c36bbab970e830a  rshell\n\n```\n**Compromised DMG images**\n```\nf6e0e5c9b9d43e008805644d937770b399f859cbba475ad837805d9adec13a2c  2.3.0.dmg\n\n4742c1987fdd968d7f094dc5a3ea3e9b5340b47e5a61846ac6ac7ae03fc7288f  2.3.1.dmg\n\n64e771c894616100202e83f3574f8accc8453138af6709367c99157e33bb613a  2.3.2.dmg\n\n466981b6aa38ae35a2c0e21a2066b4e803cc0bf76409eeb605892604c20ccf3a  2.3.3.dmg\n\n```\n**HyperBro implant**\n\n_Warning: dlpumgr32.exe is a legit file_\n```\nef2f20d1016cd39ff44f1399c8aa5c1ff5bfd4850d611ba375fbeff7f7e3eaf6  dlpprem32.bin\n\n22c3c2bf77a94ed5f207c00e240f558d6411308d237779ffb12e04bbe2c90356  dlpprem32.dll\n\n07758c93ba33843a9c5603f900f2ad0231c64ec77f6bba6de83ed6e2902022e4  dlpumgr32.exe\n\n\n```\n**YARA rules**\n\n\n-----\n\n```\nrule apt_LuckyMouse_RShell_strings {\n\n  meta:\n\n    id = \"89f18013-ea3e-440f-821e-cef102a43b7b\"\n\n    version = \"1.0\"\n\n    malware = \"RShell\"\n\n    intrusion_set = \"LuckyMouse\"\n\n    description = \"Detects LuckyMouse RShell Mach-O implant\"\n\n    source = \"SEKOIA\"\n\n    creation_date = \"2022-08-05\"\n\n    classification = \"TLP:GREEN\"\n\n  strings:\n\n    $ = { 64 69 72 00 70 61 74 68\n\n       00 64 6F 77 6E 00 72 65\n\n       61 64 00 75 70 6C 6F 61\n\n       64 00 77 72 69 74 65 00\n\n       64 65 6C }\n\n    $ = { 6C 6F 67 69 6E 00 68 6F\n\n       73 74 6E 61 6D 65 00 6C\n\n       61 6E 00 75 73 65 72 6E\n\n       61 6D 65 00 76 65 72 73\n\n       69 6F 6E }\n\n  condition:\n\n    uint32be(0) == 0xCFFAEDFE and\n\n    filesize < 300KB and\n\n    all of them\n\n}\n\nrule apt_LuckyMouse_Compromised_ElectronApp {\n\n  meta:\n\n    id = \"7702217d-771f-47af-8eaa-d5acf1e14f4d\"\n\n    version = \"1.0\"\n\n    intrusion_set = \"LuckyMouse\"\n\n    description = \"Detects compromised ElectronApp\"\n\n    source = \"SEKOIA\"\n\n    creation_date = \"2022-08-05\"\n\n    classification = \"TLP:GREEN\"\n\n  strings:\n\n    $s = \"module.exports=function(t){eval(function(p,a,c,k,e,r)\"\n\n  condition:\n\n    $s at 0 and filesize < 100KB\n\n}\n\n```\n**Suricata rule**\n```\nalert tcp $HOME_NET any -> $EXTERNAL_NET any (flow: from_client,\nestablished;content:\"|19 00 00 00 02 74 79 70 65 00 0a 00 00 00 6b 65 65 70 61 6c\n69 76 65 00 00|\";dsize:25;msg:\"Detects a LuckyMouse RShell beaconing\npacket\";sid:XXXXXXXXX; rev:001; threshold: type limit, track by_src, seconds 500,\ncount 1;)\n\n## Chat with our team!\n\n```\n\n-----\n\nWould you like to know more about our solutions? Do you want to discover our XDR and\nCTI products? Do you have a cybersecurity project in your organization? Make an\nappointment and meet us!\n\n**[Contact us](https://www.sekoia.io/en/contact/)**\n[You can find out how we track threats on our SOC platform SEKOIA.IO.](https://www.sekoia.io/en/continuously-tracking-threats/)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        }
    ],
    "references": [
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2022/2022.08.12.LuckyMouse/LuckyMouse%20uses%20a%20backdoored%20Electron%20app%20to%20target%20MacOS%20-%20SEKOIA.IO%20Blog.pdf"
    ],
    "report_names": [
        "LuckyMouse uses a backdoored Electron app to target MacOS - SEKOIA.IO Blog"
    ],
    "threat_actors": [
        {
            "id": "f3b19931-3751-4ece-a235-15b397951dc2",
            "created_at": "2022-10-25T16:07:23.889537Z",
            "updated_at": "2025-03-27T02:02:10.015565Z",
            "deleted_at": null,
            "main_name": "Nazar",
            "aliases": [
                "SIG37"
            ],
            "source_name": "ETDA:Nazar",
            "tools": [
                "Distribute.exe",
                "EYService",
                "GpUpdates.exe",
                "Microolap Packet Sniffer",
                "TCPDUMP for Windows"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "2f07a03f-eb1f-47c8-a8e9-a1a00f2ec253",
            "created_at": "2022-10-25T16:07:24.277669Z",
            "updated_at": "2025-03-27T02:02:10.157972Z",
            "deleted_at": null,
            "main_name": "TA428",
            "aliases": [
                "Operation LagTime IT",
                "Operation StealthyTrident",
                "ThunderCats"
            ],
            "source_name": "ETDA:TA428",
            "tools": [
                "8.t Dropper",
                "8.t RTF exploit builder",
                "8t_dropper",
                "Agent.dhwf",
                "Albaniiutas",
                "BlueTraveller",
                "Chymine",
                "Cotx RAT",
                "CoughingDown",
                "Darkmoon",
                "Destroy RAT",
                "DestroyRAT",
                "Gen:Trojan.Heur.PT",
                "Kaba",
                "Korplug",
                "LuckyBack",
                "PhantomNet",
                "PlugX",
                "Poison Ivy",
                "RedDelta",
                "RoyalRoad",
                "SManager",
                "SPIVY",
                "Sogu",
                "TIGERPLUG",
                "TManger",
                "TVT",
                "Thoper",
                "Xamtrav",
                "pivy",
                "poisonivy"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "e3492534-85a6-4c87-a754-5ae4a56d7c8c",
            "created_at": "2022-10-25T15:50:23.819113Z",
            "updated_at": "2025-03-27T02:00:55.552554Z",
            "deleted_at": null,
            "main_name": "Threat Group-3390",
            "aliases": [
                "Threat Group-3390",
                "Earth Smilodon",
                "TG-3390",
                "Emissary Panda",
                "BRONZE UNION",
                "APT27",
                "Iron Tiger",
                "LuckyMouse"
            ],
            "source_name": "MITRE:Threat Group-3390",
            "tools": [
                "Systeminfo",
                "gsecdump",
                "PlugX",
                "ASPXSpy",
                "Cobalt Strike",
                "Mimikatz",
                "Impacket",
                "gh0st RAT",
                "certutil",
                "China Chopper",
                "HTTPBrowser",
                "Tasklist",
                "netstat",
                "SysUpdate",
                "HyperBro",
                "ZxShell",
                "RCSession",
                "ipconfig",
                "Clambling",
                "pwdump",
                "NBTscan",
                "Pandora",
                "Windows Credential Editor"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "2c980ea7-04c4-4193-8535-52f87e66a96e",
            "created_at": "2024-05-01T02:03:07.994126Z",
            "updated_at": "2025-03-27T02:05:17.293799Z",
            "deleted_at": null,
            "main_name": "BRONZE UNION",
            "aliases": [
                "Budworm ",
                "Emissary Panda ",
                "Iron Tiger ",
                "Lucky Mouse ",
                "TG-3390 ",
                "Temp.Hippo ",
                "APT27 "
            ],
            "source_name": "Secureworks:BRONZE UNION",
            "tools": [
                " ASPXSpy",
                " China Chopper",
                " Enfal",
                " Gh0st RAT",
                " HttpBrowser",
                " Hunter",
                " HyperBro",
                " OwaAuth",
                " PlugX",
                " PoisonIvy",
                " Sysupdate",
                " ZxShell",
                "9002"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "c63ab035-f9f2-4723-959b-97a7b98b5942",
            "created_at": "2023-01-06T13:46:38.298354Z",
            "updated_at": "2025-03-27T02:00:02.798255Z",
            "deleted_at": null,
            "main_name": "APT27",
            "aliases": [
                "TG-3390",
                "EMISSARY PANDA",
                "TEMP.Hippo",
                "Budworm",
                "Group 35",
                "BRONZE UNION",
                "Lucky Mouse",
                "Iron Taurus",
                "GreedyTaotie",
                "Red Phoenix",
                "ZipToken",
                "Iron Tiger",
                "G0027",
                "Earth Smilodon"
            ],
            "source_name": "MISPGALAXY:APT27",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "5c13338b-eaed-429a-9437-f5015aa98276",
            "created_at": "2022-10-25T16:07:23.582715Z",
            "updated_at": "2025-03-27T02:02:09.875151Z",
            "deleted_at": null,
            "main_name": "Emissary Panda",
            "aliases": [
                "APT 27",
                "ATK 15",
                "Bronze Union",
                "Budworm",
                "Earth Smilodon",
                "Emissary Panda",
                "Group 35",
                "Iron Taurus",
                "Iron Tiger",
                "LuckyMouse",
                "Operation DRBControl",
                "Operation Iron Tiger",
                "Operation PZChao",
                "Operation SpoiledLegacy",
                "Operation StealthyTrident",
                "Red Phoenix",
                "TEMP.Hippo",
                "TG-3390",
                "ZipToken"
            ],
            "source_name": "ETDA:Emissary Panda",
            "tools": [
                "ASPXSpy",
                "ASPXTool",
                "Agent.dhwf",
                "AngryRebel",
                "Antak",
                "CHINACHOPPER",
                "China Chopper",
                "Destroy RAT",
                "DestroyRAT",
                "FOCUSFJORD",
                "Farfli",
                "Gh0st RAT",
                "Ghost RAT",
                "HTTPBrowser",
                "HTran",
                "HUC Packet Transmit Tool",
                "HighShell",
                "HttpBrowser RAT",
                "HttpDump",
                "HyperBro",
                "HyperSSL",
                "HyperShell",
                "Kaba",
                "Korplug",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "Mimikatz",
                "Moudour",
                "Mydoor",
                "Nishang",
                "OwaAuth",
                "PCRat",
                "PlugX",
                "ProcDump",
                "PsExec",
                "RedDelta",
                "SEASHARPEE",
                "Sensocode",
                "SinoChopper",
                "Sogu",
                "SysUpdate",
                "TIGERPLUG",
                "TVT",
                "Thoper",
                "Token Control",
                "TokenControl",
                "TwoFace",
                "WCE",
                "Windows Credential Editor",
                "Windows Credentials Editor",
                "Xamtrav",
                "ZXShell",
                "gsecdump",
                "luckyowa"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "578f8e62-2bb4-4ce4-a8b7-6c868fa29724",
            "created_at": "2022-10-25T16:07:24.344358Z",
            "updated_at": "2025-03-27T02:02:10.182282Z",
            "deleted_at": null,
            "main_name": "Tropic Trooper",
            "aliases": [
                "APT 23",
                "Bronze Hobart",
                "Earth Centaur",
                "KeyBoy",
                "Operation Tropic Trooper",
                "Pirate Panda",
                "Tropic Trooper"
            ],
            "source_name": "ETDA:Tropic Trooper",
            "tools": [
                "8.t Dropper",
                "8.t RTF exploit builder",
                "8t_dropper",
                "ByPassGodzilla",
                "CHINACHOPPER",
                "CREDRIVER",
                "China Chopper",
                "Chymine",
                "Darkmoon",
                "Gen:Trojan.Heur.PT",
                "KeyBoy",
                "Neo-reGeorg",
                "PCShare",
                "POISONPLUG.SHADOW",
                "Poison Ivy",
                "RoyalRoad",
                "SPIVY",
                "ShadowPad Winnti",
                "SinoChopper",
                "Swor",
                "TSSL",
                "USBferry",
                "W32/Seeav",
                "Winsloader",
                "XShellGhost",
                "Yahoyah",
                "fscan",
                "pivy",
                "poisonivy"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1666716495,
    "ts_updated_at": 1743041745,
    "ts_creation_date": 1660551273,
    "ts_modification_date": 1660551273,
    "files": {
        "pdf": "https://archive.orkl.eu/d44d93c12fce2403517bf53705dfd78dbb61ae51.pdf",
        "text": "https://archive.orkl.eu/d44d93c12fce2403517bf53705dfd78dbb61ae51.txt",
        "img": "https://archive.orkl.eu/d44d93c12fce2403517bf53705dfd78dbb61ae51.jpg"
    }
}