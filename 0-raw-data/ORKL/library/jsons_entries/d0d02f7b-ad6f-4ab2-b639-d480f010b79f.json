{
    "id": "d0d02f7b-ad6f-4ab2-b639-d480f010b79f",
    "created_at": "2023-01-12T15:09:27.000531Z",
    "updated_at": "2025-03-27T02:17:11.391778Z",
    "deleted_at": null,
    "sha1_hash": "e726f84702ca2396004181d94d6d4c187dde9632",
    "title": "2020-09-10 - STRONTIUM- Detecting new patterns in credential harvesting",
    "authors": "",
    "file_creation_date": "2022-05-28T16:14:42Z",
    "file_modification_date": "2022-05-28T16:14:42Z",
    "file_size": 1297528,
    "plain_text": "# STRONTIUM: Detecting new patterns in credential harvesting\n\n**[microsoft.com/security/blog/2020/09/10/strontium-detecting-new-patters-credential-harvesting/](https://www.microsoft.com/security/blog/2020/09/10/strontium-detecting-new-patters-credential-harvesting/)**\n\nSeptember 10, 2020\n\nMicrosoft has tied STRONTIUM to a newly uncovered pattern of Office365 credential\nharvesting activity aimed at US and UK organizations directly involved in political elections.\nAnalysts from Microsoft Threat Intelligence Center (MSTIC) and Microsoft Identity Security\nhave been tracking this new activity since April 2020. Credential harvesting is a known tactic\nused by STRONTIUM to obtain valid credentials that enable future surveillance or intrusion\noperations. Subsequent analysis revealed that between September 2019 and June 2020,\nSTRONTIUM launched credential harvesting attacks against tens of thousands of accounts\nat more than 200 organizations. In the two weeks between August 18 and September 3, the\nsame attacks targeted 6,912 accounts belonging to 28 organizations. None of these\naccounts were successfully compromised.\n\nNot all the targeted organizations were election-related. However, we felt it important to\nhighlight a potential emerging threat to the 2020 US Presidential Election and future electoral\ncontests in the UK.\n\nMicrosoft CVP Customer Security and Trust, Tom Burt provided some additional details on\n[this campaign in his recent On The Issues blog post. The purpose of this post is to provide](https://blogs.microsoft.com/on-the-issues/?p=63925)\ndefenders in any organization, but especially those directly or indirectly affiliated with\nelectoral systems, insight into the technical nature of this activity. By providing these details,\nwe hope to enable better defense against future attacks and share best practices for\nsecuring cloud environments against this type of activity.\n\n\n-----\n\n## Tactical Details\n\nSTRONTIUM relied heavily upon spear phishing in its credential harvesting efforts leading up\nto the 2016 US presidential election. In 2016, spear-phishing was the most common tactic for\nstealing credentials from targeted accounts. This time around, STRONTIUM appears to be\ntaking a different approach, namely, brute-force/password-spray tooling. This shift in tactics,\n[also made by several other nation-state actors, allows them to execute large-scale credential](https://www.microsoft.com/security/blog/2020/06/18/inside-microsoft-threat-protection-mapping-attack-chains-from-cloud-to-endpoint/)\nharvesting operations in a more anonymized manner. The tooling STRONTIUM is using\nroutes its authentication attempts through a pool of approximately 1,100 IPs, the majority\nassociated with the Tor anonymizing service. This pool of infrastructure has evolved over\ntime, with an average of approximately 20 IPs added and removed from it per day.\nSTRONTIUM’s tooling alternates its authentication attempts amongst this pool of IPs\napproximately once per second. Considering the breadth and speed of this technique, it\nseems likely that STRONTIUM has adapted its tooling to use an anonymizer service to\nobfuscate its activity, evade tracking, and avoid attribution.\n\nDuring the two-week period, August 19 – September 3, STRONTIUM’s credential harvesting\ntooling utilized a daily average of 1,294 IPs associated with 536 netblocks and 273 ASNs. Of\nthese netblocks, some were much more heavily utilized by the tooling than others, both in\nterms of the total number of authentications attempted from them and the total number of IPs\nutilized within them. Figure 1 below represents the 5 netblocks from which the highest\nnumber of total auth attempts were observed. As highlighted in the table, several of these\nnetblocks had much higher IP utilization rates than the rest. This observed behavior indicates\nthat the underlying anonymization services providing the infrastructure backbone for\nSTRONTIUM auth attempts are, in a sense, over-serving IPs in these specific netblocks.\n\n_Figure 1: Highest volume netblocks used in STRONTIUM auth attempts._\n\nThe fact that the anonymization service is over-serving specific netblocks gives defenders an\nopportunity to hunt for activity associated both with this STRONTIUM activity or other\nmalicious tooling that is utilizing the same anonymization service. The following Azure\n\n\n-----\n\n[Sentinel query (GitHub link) is designed to identify failed authentication attempts from the](https://github.com/Azure/Azure-Sentinel/blob/master/Detections/OfficeActivity/StrontiumCredHarvesting.yaml)\nthree highest-signal, highest-utilization netblocks highlighted above, and group the results by\nUserAgent.\n\nMicrosoft Threat Protection (MTP) also provides a platform for users to identify failed\nauthentication attempts. The following query will give MTP users the ability to hunt and\naddress these threats as well:\n\nMSTIC has observed that the STRONTIUM tooling operates in two modes when targeting\naccounts: brute-force and password-spray.\n\nIn password-spray mode, the tooling attempts username: password combinations in a\n‘low-‘n-slow’ manner. Organizations targeted by the tooling running in this mode typically see\napproximately four authentication attempts per hour per targeted account over the course of\nseveral days or weeks, with nearly every attempt originating from a different IP address.\n\nIn brute-force mode, the tooling attempts many username: password attempts very rapidly\nfor a much shorter time period. Organizations targeted by the tooling running in this mode\ntypically see over 300 authentication attempts per hour per targeted account over the course\nof several hours or days.\n\n\n-----\n\n**Tooling**\n**Operating**\n**Mode**\n\nPasswordSpray\n\n\n**Avg ## of Attempts**\n**Per Account Per Hour**\n\n\n4 4 DaysWeeks\n\n\n**Avg # Of IPs Utilized for Auth**\n**Attempts Per Account Per Hour**\n\n\n**Avg**\n**Length of**\n**Attack**\n\n\nBrute-Force 335 200 HoursDays\n\nOrganizations targeted by STRONTIUM using this tooling saw auth attempts against an\naverage of 20% of their total accounts. In some instances, MSTIC assesses the tooling may\nhave discovered these accounts simply by attempting authentications against a large\nnumber of possible account names until it found ones that were valid.\n\n## Guidance: Proactive defense\n\nThere are some very simple steps businesses and targeted individuals can take to\nsignificantly improve the security of their accounts and make these types of attacks much\nmore difficult.\n\n**1. Enable multi-factor authentication**\n\nWe have seen clear proof that enabling multi-factor authentication (MFA) across both\nbusiness and personal email accounts successfully thwarts the majority of credential\nharvesting attacks. Our colleagues in Azure Active Directory put it more precisely—\n\n“… doing any form of MFA takes you out of reach of most attacks. MFA (using any\nmechanism) is just too costly to break – unless a highly motivated attacker is after that\nhigh-value account or asset.”\n\nBlog: [Your password doesn’t matter—but MFA does!](https://www.microsoft.com/security/blog/2019/10/03/password-doesnt-matter-mfa-does/)\n\nHowever, most enterprise accounts have not implemented this simple protection:\n\n_“When we evaluate all the tokens issued with MFA claims, we see that less than 10%_\n**_of users use MFA per month in our enterprise accounts (and that includes on-_**\n_premises and third-party MFA). Until MFA is more broadly adopted, there is little reason_\n_for attackers to evolve.”_\n\nBlog: [All your creds are belong to us!](https://techcommunity.microsoft.com/t5/azure-active-directory-identity/all-your-creds-are-belong-to-us/ba-p/855124)\n\n**2. Actively monitor failed authentications**\n\n\n-----\n\nWhen monitoring login activity in your accounts, look for any type of discernable patterns in\n[these failed authentications and track them over time. Password spray is an increasingly](https://www.microsoft.com/security/blog/2020/04/23/protecting-organization-password-spray-attacks/)\ncommon tactic of nation-state actors.\n\nYou can also maintain broader visibility into behavioral anomalies like failed login attempts by\n[running detections and monitoring using Microsoft Cloud App Security (MCAS) which](https://www.microsoft.com/en-us/microsoft-365/enterprise-mobility-security/cloud-app-security)\nmonitors user sessions for third-party cloud apps, including G-Suite, AWS, and Salesforce.\nThe MCAS detection engine looks for anomalous user activity for indicators of compromise.\nOne indicator, “multiple failed login attempts,” can be used to create a dynamic baseline per\nuser, across the tenant, and alert on anomalous login behavior that may represent an active\nbrute force or password spray attack.\n\n[Microsoft Threat Protection (MTP) can help to automatically track and rebuild the Incident](https://www.microsoft.com/en-us/security/business/threat-protection/integrated-threat-protection)\nview of all the compromised identities by password-spray leveraged later by the attacker to\nexpand the breach to endpoint or cloud assets.\n\n**3. Test your organization’s resilience**\n\n[Attack Simulator in Office 365 ATP lets you run realistic, but simulated phishing and](https://docs.microsoft.com/en-us/microsoft-365/security/office-365-security/attack-simulator)\npassword attack campaigns in your organization. Pick a password and then run the\ncampaign against as many users as you want. The results will let you know how many\npeople are using that password. Use the data to train users and build your custom list of\nbanned passwords.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2020/2020-09-10 - STRONTIUM- Detecting new patterns in credential harvesting.pdf"
    ],
    "report_names": [
        "2020-09-10 - STRONTIUM- Detecting new patterns in credential harvesting.pdf"
    ],
    "threat_actors": [
        {
            "id": "e3767160-695d-4360-8b2e-d5274db3f7cd",
            "created_at": "2022-10-25T16:47:55.914348Z",
            "updated_at": "2025-03-27T02:05:17.411172Z",
            "deleted_at": null,
            "main_name": "IRON TWILIGHT",
            "aliases": [
                "ATK5 ",
                "Blue Athena ",
                "BlueDelta ",
                "FROZENLAKE ",
                "Fancy Bear ",
                "Fighting Ursa ",
                "Forest Blizzard ",
                "GRAPHITE ",
                "Group 74 ",
                "PawnStorm ",
                "STRONTIUM ",
                "Sednit ",
                "Snakemackerel ",
                "Sofacy ",
                "TG-4127 ",
                "Tsar Team ",
                "APT28 "
            ],
            "source_name": "Secureworks:IRON TWILIGHT",
            "tools": [
                " Downdelph",
                " Drovorub",
                " EVILTOSS",
                " HIDEDRV",
                " Headlace",
                " LoJack",
                " Powershell Empire",
                " SCONATO",
                " SEDUPLOADER",
                " SHARPFRONT",
                " Scaramouche",
                " Sedkit Exploit Kit",
                " Sofacy downloader",
                " X-Agent",
                " X-Tunnel",
                " Zebrocy",
                " reGeorg",
                "DEALERSCHOICE"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "730dfa6e-572d-473c-9267-ea1597d1a42b",
            "created_at": "2023-01-06T13:46:38.389985Z",
            "updated_at": "2025-03-27T02:00:02.821388Z",
            "deleted_at": null,
            "main_name": "APT28",
            "aliases": [
                "FROZENLAKE",
                "BlueDelta",
                "SNAKEMACKEREL",
                "TG-4127",
                "ITG05",
                "TA422",
                "Fancy Bear",
                "FANCY BEAR",
                "Sednit",
                "IRON TWILIGHT",
                "G0007",
                "Sofacy",
                "Forest Blizzard",
                "GruesomeLarch",
                "Pawn Storm",
                "Tsar Team",
                "STRONTIUM",
                "ATK5",
                "Blue Athena",
                "APT-C-20",
                "Group 74",
                "SIG40",
                "Grizzly Steppe",
                "Fighting Ursa",
                "T-APT-12",
                "UAC-0028"
            ],
            "source_name": "MISPGALAXY:APT28",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "ae320ed7-9a63-42ed-944b-44ada7313495",
            "created_at": "2022-10-25T15:50:23.671663Z",
            "updated_at": "2025-03-27T02:00:55.518748Z",
            "deleted_at": null,
            "main_name": "APT28",
            "aliases": [
                "APT28",
                "IRON TWILIGHT",
                "SNAKEMACKEREL",
                "Group 74",
                "Sednit",
                "Sofacy",
                "Pawn Storm",
                "Fancy Bear",
                "STRONTIUM",
                "Tsar Team",
                "Threat Group-4127",
                "TG-4127",
                "Forest Blizzard",
                "FROZENLAKE"
            ],
            "source_name": "MITRE:APT28",
            "tools": [
                "Wevtutil",
                "certutil",
                "Forfiles",
                "DealersChoice",
                "Mimikatz",
                "ADVSTORESHELL",
                "Komplex",
                "HIDEDRV",
                "JHUHUGIT",
                "Koadic",
                "Winexe",
                "XTunnel",
                "Drovorub",
                "CORESHELL",
                "OLDBAIT",
                "Downdelph",
                "XAgentOSX",
                "USBStealer",
                "Zebrocy",
                "Fysbis",
                "LoJax"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "d2516b8e-e74f-490d-8a15-43ad6763c7ab",
            "created_at": "2022-10-25T16:07:24.212584Z",
            "updated_at": "2025-03-27T02:02:10.141001Z",
            "deleted_at": null,
            "main_name": "Sofacy",
            "aliases": [
                "APT 28",
                "ATK 5",
                "Blue Athena",
                "BlueDelta",
                "FROZENLAKE",
                "Fancy Bear",
                "Fighting Ursa",
                "Forest Blizzard",
                "Grey-Cloud",
                "Grizzly Steppe",
                "Group 74",
                "GruesomeLarch",
                "ITG05",
                "Iron Twilight",
                "Operation DealersChoice",
                "Operation Dear Joohn",
                "Operation Komplex",
                "Operation Pawn Storm",
                "Operation Russian Doll",
                "Operation Steal-It",
                "Pawn Storm",
                "SIG40",
                "Sednit",
                "Snakemackerel",
                "Sofacy",
                "Strontium",
                "T-APT-12",
                "TA422",
                "TAG-0700",
                "TAG-110",
                "TG-4127",
                "Tsar Team",
                "UAC-0028",
                "UAC-0063"
            ],
            "source_name": "ETDA:Sofacy",
            "tools": [
                "ADVSTORESHELL",
                "AZZY",
                "Backdoor.SofacyX",
                "CHERRYSPY",
                "CORESHELL",
                "Carberp",
                "Computrace",
                "DealersChoice",
                "Delphacy",
                "Downdelph",
                "Downrage",
                "Drovorub",
                "EVILTOSS",
                "Foozer",
                "GAMEFISH",
                "GooseEgg",
                "Graphite",
                "HATVIBE",
                "HIDEDRV",
                "Headlace",
                "Impacket",
                "JHUHUGIT",
                "JKEYSKW",
                "Koadic",
                "Komplex",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "LoJack",
                "LoJax",
                "MASEPIE",
                "Mimikatz",
                "NETUI",
                "Nimcy",
                "OCEANMAP",
                "OLDBAIT",
                "PocoDown",
                "PocoDownloader",
                "Popr-d30",
                "ProcDump",
                "PythocyDbg",
                "SMBExec",
                "SOURFACE",
                "SPLM",
                "STEELHOOK",
                "Sasfis",
                "Sedkit",
                "Sednit",
                "Sedreco",
                "Seduploader",
                "Shunnael",
                "SkinnyBoy",
                "Sofacy",
                "SofacyCarberp",
                "SpiderLabs Responder",
                "Trojan.Shunnael",
                "Trojan.Sofacy",
                "USB Stealer",
                "USBStealer",
                "VPNFilter",
                "Win32/USBStealer",
                "WinIDS",
                "Winexe",
                "X-Agent",
                "X-Tunnel",
                "XAPS",
                "XTunnel",
                "Xagent",
                "Zebrocy",
                "Zekapab",
                "carberplike",
                "certutil",
                "certutil.exe",
                "fysbis",
                "webhp"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673536167,
    "ts_updated_at": 1743041831,
    "ts_creation_date": 1653754482,
    "ts_modification_date": 1653754482,
    "files": {
        "pdf": "https://archive.orkl.eu/e726f84702ca2396004181d94d6d4c187dde9632.pdf",
        "text": "https://archive.orkl.eu/e726f84702ca2396004181d94d6d4c187dde9632.txt",
        "img": "https://archive.orkl.eu/e726f84702ca2396004181d94d6d4c187dde9632.jpg"
    }
}