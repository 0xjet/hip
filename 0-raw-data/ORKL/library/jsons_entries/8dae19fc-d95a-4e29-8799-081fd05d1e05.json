{
    "id": "8dae19fc-d95a-4e29-8799-081fd05d1e05",
    "created_at": "2023-01-12T15:05:59.383978Z",
    "updated_at": "2025-03-27T02:10:49.3318Z",
    "deleted_at": null,
    "sha1_hash": "11d66257d40a97d49b09bbb881d543e20a872ec7",
    "title": "2019-06-27 - Inter- Skimmer For All",
    "authors": "",
    "file_creation_date": "2022-05-28T03:37:55Z",
    "file_modification_date": "2022-05-28T03:37:55Z",
    "file_size": 1332192,
    "plain_text": "# Inter: Skimmer For All\n\n**[fortinet.com/blog/threat-research/inter-skimmer-for-all.html](https://www.fortinet.com/blog/threat-research/inter-skimmer-for-all.html)**\n\n**_A FortiGuard Labs Threat Analysis Report_**\n\n\nJune 27, 2019\n\n\nUsing web skimmers to steal payment card details has become a good business for\ncybercriminals. In fact, just last month, FortiGuard Labs discovered a campaign that has\nstolen the data from over [185,000 payment cards in a one year operation.](https://www.fortinet.com/blog/threat-research/payment-card-details-stolen-magecart.html)\n\nMageCart, the collective name given to the groups responsible for injecting JavaScript\n[skimmers on compromised websites, continues to target online stores, reportedly](https://www.scmagazineuk.com/formjacking-attacks-compromised-50000-retailer-websites-2018/article/1526282)\ncompromising over 50,000 websites in 2018. This predicament represents a serious threat to\nboth businesses and consumers.\n\n\n-----\n\nFortiGuard Labs recently uncovered yet another campaign using similar tactics, but with a\n[few differences that set them apart from other subgroups. This skimmer is called Inter. It is](https://www.siconsult.com/si-cyber-intel-sochi-launches-bulletproof-hosting-service-for-malware-operators-spammers)\nhighly customizable, so it can be easily configured to fit the buyer’s needs, and is reportedly\nbeing sold in underground forums for $1,300 per license. We started seeing attacks from this\ncampaign on April 19, and in this report we’ll be looking at the techniques used by this new\ncampaign, as well as provide a glimpse into how their operation works.\n\n## The Skimmer\n\nOur investigation began when we found a malicious JavaScript connecting to tracker_visitors[.]com, where it was disguised as a visitor traffic tracker for a website. Further analysis_\non the domain led us to the discovery of several open directories, which then led us to more\ncustomized skimmer scripts used by the campaign. And as of June 20th, new skimmer scripts\nwere still being uploaded.\n\nFigure 1: Open Directories At tracker-visitors[.]com\n\nSince beginning our investigation, we have identified over 70 skimmer scripts and 11 open\ndirectories, but there could possibly be more hidden directories that we have not yet\nuncovered. As expected, the file names of the malicious JavaScript attempt to imitate\ncommonly used script utilities, as well as names directly related to the compromised website\ntargets. Based on functionalities, the scripts found from the open directories can be\ncategorized to the following types:\n\nLoader\nWeb skimmer\nFake payment form\n\n## Loader\n\nThe loader scripts’ function is to load the skimmer hosted on one of the campaign’s C2s.\n_Figure 2 shows a code snippet of one of the loaders, googletagver.js. Before loading the_\n[skimmer, it uses an open-source tool called devtools-detect to determine if the script is being](https://github.com/sindresorhus/devtools-detect)\nexecuted using a debugger, in which case it will not proceed with loading the skimmer.\n\nFigure 2: Loader Script\n\n## Web Skimmer and Fake Payment Form\n\nE-commerce websites use different platforms for handling payments. For instance, some\nwebsites handle the payments internally, while others use external payment service\nproviders (PSPs). Depending on which platform the compromised website uses, the\ncampaign uses either a web skimmer or a fake payment form.\n\n\n-----\n\nThey use web skimmers for internally managed payments so the attackers can access and\nintercept entered credit card details from forms that are already on the website. In the case\nof websites that use PSPs, since the attackers do not have access to the information\nprovided by the customers after they have been redirected to an external payment service,\nthey have to get the information before that happens. They accomplish this by tricking users\ninto filling in their card details on fake forms before the redirection.\n\n**The following samples are used in our analysis:**\n\nvmartgo.js - web skimmer\ncap.js - fake payment form\n\nThe skimmers initially check to determine if the site has finished loaded by calling\n_document.readyState before continuing to the main routine. The skimmers then execute_\nevery half a second.\n\nFigure 3: Main Function\n\nAfter the initial check, Inter retrieves stored cookies named $s and $sent that contain records\nof previously encoded stolen payment information. This information is used later in the\nattack.\n\nFigure 4: GetFromStorage Function\n\nAs can be seen below, the web skimmers call the functions SaveAllFields() to get the general\ninformation of the victim, and GetCCInfo() to specifically capture credit card details. As\npreviously mentioned, for those websites that use PSPs, a fake form can be inserted, hence\nthe addition of the AddForm() function.\n\nFigure 5: TrySend Function\n\nThe scripts that inject these forms are customized specifically to the payment page of the\ncompromised websites, knowing where and when to display the fake forms. This means that\nthe threat actors had to identify the layout of each payment page before injection.\n\nFigure 6: Function To Add The Fake Payment Form\n\nAs shown below, the fake payment form is only added when the “Pay by credit card” button\nis clicked. An untrained eye might not see anything suspicious, but by reading carefully, the\nbutton is labelled with “VALIDATE AND PROCEED TO PAYMENT.” This clearly means that\nthe customer is not expected to provide any credit card details until the next step.\n\nFigure 7: Side By Side Screenshot Of Checkout Page With The Fake Form\n\n\n-----\n\nTo extract the right information, skimmers usually check for keywords in the current URL to\nmake sure that the skimmer is running on a checkout or payment page. The Inter skimmer\ntakes a different approach. Regardless of what the page the consumer is on, it extracts all\nentered information on the current webpage by taking values from form elements with the\ntags input, select, and textarea. The values are then further filtered to extract the actual\ncredit card details.\n\nFigure 8: SaveAllFields Function\n\nThis data is then converted to JSON and encoded with a simple base64 and stored as a\ncookie in $s. The MD5 hash of the encoded data is then calculated and compared to the\nentries in the variable $s.Sent, which contains a list/array of MD5 hashes of payment details\npreviously sent to the C2 server. If the hash exists, the data is discarded to avoid sending\nduplicate data.\n\nIt is also worth mentioning that the C2 used for data extraction is also where the malicious\nJavaScript is hosted.\n\nFigure 9: SendData Function With $sent Showing Previous md5 Hashes\n\nThe way this malware sends collected information to its C2 server is also notable. It creates\nan IMG element and then sets the image source to the C2, with the encoded payment details\nas a parameter.\n\nFigure 10: LoadImage Function To Send The Stolen Info To The C2\n\nShown below is the traffic once the created IMG element connects to its image source. It\ndisguises itself as an image content, which is a way to avoid detection – especially since it’s\nnormal to load a lot of IMG elements into a webpage. This then initiates a GET request,\nwhich might be less suspicious than the commonly used POST request method for data\nextraction.\n\nFigure 11: Network Traffic When Stolen Info Is Sent To The C2\n\n## Fake Payment Forms\n\nTo provide a sense of this campaign’s scope, it supports at least 18 major payment vendors,\nmainly in the US, UK, AUS, and FR.\n\nWe also have seen around a dozen different fake payment forms created by this campaign,\neach catering to different vendors and provided in different languages.\n\nFigure 12: Compiled Fake Payment Forms\n\n## Conclusion\n\n\n-----\n\nBeing able to access an open directory in such a campaign has provided us with important\ninformation on its scope, as well as how it operates. With that information, we were then able\nto determine the scope of the attack, and compare the TTPs (Tactics, Techniques, and\nProcedures) with those used in previous MageCart campaigns.\n\nThe information we gathered also shows that because the group behind this campaign\nutilized the customizable feature of the Inter skimmer, they were able to cater to different\nwebsites and payment vendors by tailoring the skimmer to their targeted websites. While we\nhave seen a lot of skimmers used in various MageCart campaigns, Inter’s availability and\nconvenience means it can be bought and used by just about anyone. As a result, we\nanticipate that we will see much more of it in the future.\n\n-= FortiGuard Lion Team =\n## Solutions\n\nFortiGuard Labs has reached out to the e-commerce websites affected by this campaign.\n\nFortinet customers are protected by the following solutions:\n\nMalicious JavaScripts analyzed are detected as JS/Script.DF!tr.pws and\nJS/Loader.DF!tr.pws\nThe C2 servers are blocked by FortiGuard Web Filtering Service\n\n## IOCs\n\naa1ae020558f7b41dc16ded37176959cbe87cbd2153094a75d67d9410f2d30d\n182fbc73d3901caceea7f058e41205be1dca21ac8dc1a63de20907e4099ec3b3\n33354c7922ead7588eeebfe0817064fd44f4aae173ea01b35e81e39e40e7e853\n37eb8c952d374b49eb933e8955c9cb5ea9a4109c67334880a9b9063b6770f852\n\nC2\n\nTracker-visitors[.]com\nJquery-web[.]com\nJquery-stats[.]com\njsreload[.]pw\nroutingzen[.]com\n\n_[Learn more about FortiGuard Labs and the FortiGuard Security Services portfolio.](https://www.fortinet.com/fortiguard/threat-intelligence/threat-research.html?utm_source=nreleaseblog&utm_campaign=2018-q2-fortiguardlabs-cta)_ _Sign_\n_up for our weekly FortiGuard Threat Brief._\n\n_[Read about the FortiGuard Security Rating Service, which provides security audits and best](https://www.fortinet.com/support-and-training/support-services/fortiguard-security-subscriptions/security-rating.html?utm_source=blog&utm_campaign=2018-blog-security-rating-service)_\n_practices._\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2019/2019-06-27 - Inter- Skimmer For All.pdf"
    ],
    "report_names": [
        "2019-06-27 - Inter- Skimmer For All.pdf"
    ],
    "threat_actors": [
        {
            "id": "5a0483f5-09b3-4673-bb5a-56d41eaf91ed",
            "created_at": "2023-01-06T13:46:38.814104Z",
            "updated_at": "2025-03-27T02:00:02.925972Z",
            "deleted_at": null,
            "main_name": "MageCart",
            "aliases": [],
            "source_name": "MISPGALAXY:MageCart",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673535959,
    "ts_updated_at": 1743041449,
    "ts_creation_date": 1653709075,
    "ts_modification_date": 1653709075,
    "files": {
        "pdf": "https://archive.orkl.eu/11d66257d40a97d49b09bbb881d543e20a872ec7.pdf",
        "text": "https://archive.orkl.eu/11d66257d40a97d49b09bbb881d543e20a872ec7.txt",
        "img": "https://archive.orkl.eu/11d66257d40a97d49b09bbb881d543e20a872ec7.jpg"
    }
}