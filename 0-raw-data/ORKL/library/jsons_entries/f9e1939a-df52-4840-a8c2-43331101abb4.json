{
    "id": "f9e1939a-df52-4840-a8c2-43331101abb4",
    "created_at": "2023-01-12T15:05:03.080854Z",
    "updated_at": "2025-03-27T02:06:02.090928Z",
    "deleted_at": null,
    "sha1_hash": "ef7bee83db9b257ef93fd2bedad495515c285688",
    "title": "2017-12-19 - BrickerBot mod_plaintext Analysis",
    "authors": "",
    "file_creation_date": "2022-05-28T03:49:10Z",
    "file_modification_date": "2022-05-28T03:49:10Z",
    "file_size": 384115,
    "plain_text": "# BrickerBot mod_plaintext Analysis\n\n**[trustwave.com/Resources/SpiderLabs-Blog/BrickerBot-mod_plaintext-Analysis/](https://www.trustwave.com/Resources/SpiderLabs-Blog/BrickerBot-mod_plaintext-Analysis/)**\n\nLoading...\n\nBlogs & Stories\n\n## SpiderLabs Blog\n\nAttracting more than a half-million annual readers, this is the security community's go-to\ndestination for technical breakdowns of the latest threats, critical vulnerability disclosures\nand cutting-edge research.\n\n[A week ago, the author of BrickerBot claimed that they retired and published their manifesto](https://www.bleepingcomputer.com/news/security/brickerbot-author-retires-claiming-to-have-bricked-over-10-million-iot-devices/)\n[along with some source code of their bot.](https://github.com/JeremyNGalloway/mod_plaintext.py/blob/master/mod_plaintext.py)\n\nIn the manifesto, they wrote: \"Take a look at the number of payloads, 0-days and\ntechniques and let the reality sink in for a moment.\"\n\nSo I decided to take a look at the code and find those 0-days.\n\n**Breaking it down**\n\n\n-----\n\nThe code as is can t be run, however we can see the payloads and techniques, so it is\n[very likely those might be integrated into Mirai or other botnets. If there are indeed 0-days in](https://en.wikipedia.org/wiki/Mirai_(malware))\nthe code, we could see a massive infection wave.\n\nHowever, after analyzing the code, I was very disappointed to find only 1 \"real\" 0-day. Since\nit is Authenticated Remote Code Execution (RCE) vulnerability it shouldn't be that severe if\nyou change default passwords.\n\nThe bot consists of 5 attack vectors:\n\nSSH crawler that the author didn't publish, because, and I quote \"My ssh crawler is\ntoo dangerous to publish\"\nTelnet crawler\nHTTP module that use some Exploits as well as automated authenticated requests\nwith default passwords\n[HNAP module that contains 1 exploit and Authenticated requests with default](https://en.wikipedia.org/wiki/Home_Network_Administration_Protocol)\npasswords\n[SOAP module that exploits 3 vulnerabilities](https://en.wikipedia.org/wiki/SOAP)\n\n### Detailed analysis of the code\n\nThe main purpose of the bot is to brick devices so they won't be usable. \"Bricking\" is the\nprocess of changing the code of the device such that the hardware can no longer be used,\nthereby turning the device essentially into a brick.\n\nWhy make a bot that simply wrecks devices? According to the author every unsecure\ndevice is a potential target to be hacked and integrated into a botnet. This project was\nmeant to illustrate that point and remove these potential targets from the reach of IoT\nbotnets such as Mirai. The author never seemed to care that the unfortunate side effect of\nthis process is that the device is also rendered useless for its owner.\n\nThe author achieves this goal of bricking devices by gaining shell access or remote\ncommand execution using exploits. After gaining access commands are run that write\ngarbage into the partitions of the hacked device and overwrite the file system, leaving the\ndevice without operating system, in \"bricked\" state.\n\n_Fig 1: Code snippet of the bot overwriting the file system_\n\nThe code is very device-specific and each crawler scans for specific targets that the author\nknows are vulnerable. For each known vulnerable device, they wrote a specific command\nset to brick the device, as each device shell and file system is different. This targeted\nprocess is also meant to reduce \"noise\" and avoid attacking honeypots.\n\n\n-----\n\n**Attack Vector: Telnet**\n\nAlthough the ssh crawler code wasn't published, it is most likely very similar to the telnet\ncrawler. The telnet crawler looks for specific telnet banners and tries to login with default\ncredentials. The list of devices that the telnet crawler attacks include the following devices\nand manufactures:\n\n[Ingenic devices](https://www.linux-mips.org/wiki/Ingenic%20devices)\n\n3Com Access Points\n\n[a5-v11](https://wiki.openwrt.org/toh/unbranded/a5-v11)\n\n[ADBGlobal](https://www.adbglobal.com/devices/broadband-gateways/)\n\nAlcatel OmniSwitch\n\n[Artila](https://www.artila.com/en/)\n\nAvaya\n\nAver DVR\n\n[Axerra](http://www.typepad.com/site/blogs/6a0133f264aa62970b013488d08a70970c/compose/preview/axerra.com)\n\n[Bintec-elmeg](http://www.bintec-elmeg.com/en/home/)\n\nBroadcom based products\n\nBusyBox based products\n\nCalAmp Fusion LTE\n\n[Cell-technology Janus](http://www.cell-technology.net/product.php?product=janus)\n\nCisco\n\nComtrend\n\nDahua DVR\n\nDasan Networks\n\nDASAN ZHONE SOLUTIONS\n\n[Davolink](http://www.davolink.co.kr/sys/bbs/board.php?bo_table=e0301&wr_id=19)\n\n[Digitel NetRouter](http://www.digitel.com.br/en/produtos/produto.asp?Id=14)\n\nD-Link\n\n[Elsist](https://www.elsist.biz/)\n\nEV ZLX Two-way Speaker\n\n[Extremenetworks](https://www.extremenetworks.com/product/extremexos-network-operating-system/)\n\nFortigate\n\nFreescale Semiconductor\n\nHikvision\n\nHiLinux cam\n\nHiSilicon\n\nHooToo TripMate\n\nHP Printers\n\nHUAWEI\n\n[Idirect](http://www.typepad.com/site/blogs/6a0133f264aa62970b013488d08a70970c/compose/preview/idirect.net)\n\nIntegrated Dell Remote Access\n\nIntellisyn Intelliserver\n\n\n-----\n\n[ip-com](http://www.ip-com.com.cn/en/)\n[itwatchdogs](http://www.itwatchdogs.com/s_firmware_console)\nJuniper Networks\nKingType Modem/Router\nKYlink SIP\n[Maipu](http://www.typepad.com/site/blogs/6a0133f264aa62970b013488d08a70970c/compose/preview/maipu.com)\n[Maxon Intelimax](https://www.maxon.com.au/products.html)\n[Meritlilin](https://www.meritlilin.com/)\n[Microhardcorp Bullet-LTE](http://www.microhardcorp.com/Bullet-LTE.php)\nMikrotik\n[Multiqb](http://www.typepad.com/site/blogs/6a0133f264aa62970b013488d08a70970c/compose/preview/multiqb.com)\n[Nateks](http://www.nateks.ru/)\nNetbox\nNetScreen Technologies\nNetvanta\nNetween CCTV & cameras\nNomadix\nOpenWRT\n[Oxygenbroadband](http://www.oxygenbroadband.com/oxygen-router.html)\n[Phyhome](http://www.phyhome.com/)\nPolycom\n[Protei](http://www.protei.com/)\nQ-See DVR\n[Qtech](http://www.qtech.ru/catalog/smarthome/)\n[Quagga](http://www.nongnu.org/quagga/)\nRicoh\n[Robustel](http://www.typepad.com/site/blogs/6a0133f264aa62970b013488d08a70970c/compose/preview/robustel.com%20cellular%20modem/routers)\nRuckus\nSagemcom\nSamsung Ubigate\n[Shanghai Telecoms E8](http://www.computersolutions.cn/blog/2014/09/hacking-shanghai-telecoms-e8-wifiepon-fibre-modem/)\n[Sixpon](http://www.xbest.pl/index.php?d=szukaj&producent=33)\nTrendChip Technologies\n[uClinux](http://www.uclinux.org/pub/uClinux/FAQ.shtml#2-0)\n[UTTGlobal ReOS](http://www.uttglobal.com/)\nVigor\nVXworks\n[Welotec](https://www.welotec.com/en/industrial-router)\n[Westermo](https://www.westermo.com/products/routers/wireless-routers/mrd-455)\nWindows CE Telnet Service\n\n\n-----\n\nXiongmai DVR\nZTE\nZyXEL\n\n**Attack Vector: HTTP**\n\nThe HTTP module includes exploits & techniques that are described by the author in their\n[previous manifest. If they are unable to brick the device, they will restore it to factory default](https://github.com/JeremyNGalloway/mod_plaintext.py/blob/master/depastedihrn3jtw.onion_show.php%3Fmd5%3D62d1d87f67a8bf485d43a05ec32b1e6f)\nsettings, shut it down, or change some configuration option to force the device offline.\n\nOne method of gaining access to perform these attacks is to simply try default passwords.\nBrickerBot uses this technique against the following HTTP devices:\n\nObserva Telecom Devices\n\nHikvision\n\nSifytechnologies Devices\n\nZyxel p66\n\nRealtron Cameras\n\nSupernet ADSL Modems\n\nPLDThome DSL/Fiber Devices\n\nFosCam\n\nAztech\n\nMediatek Devices\n\nGrandstream Devices\n\nOther HTTP devices are attacked with RCE exploits to gain access:\n\n[AVTECH Multiple Vulnerabilities](https://www.exploit-db.com/exploits/40500/)\n\n[WIFICAM Multiple vulnerabilities](https://pierrekim.github.io/blog/2017-03-08-camera-goahead-0day.html)\n\n[Dahua Backdoor](https://github.com/mcw0/PoC/blob/master/dahua-backdoor.txt)\n\n[ZTE ZXDSL 831](https://www.exploit-db.com/exploits/43188/)\n\n[EnGenius RCE](https://www.exploit-db.com/exploits/42114/)\n\n[CrossWeb DVR RCE](http://www.kerneronsec.com/2016/02/remote-code-execution-in-cctv-dvrs-of.html)\n\n[Hanbanggaoke IP Camera](https://blogs.securiteam.com/index.php/archives/3420)\n\n[WIFICAM cameras](https://pierrekim.github.io/blog/2017-03-08-camera-goahead-0day.html)\n\n[D-Link DIR-600 / DIR-300 (Rev B) - Multiple Vulnerabilities](https://www.exploit-db.com/exploits/24453/)\n\n[D-Link dsl-2750u ISP \"backdoor\" account](http://www.stuff.za.net/2016/07/remote-access-to-a-dsl-2750u-adsl-router-a-sort-of-hack/)\n\n[D-Link 850L Multiple Vulnerabilities](http://www.palada.net/index.php/2017/08/08/news-2414/)\n\n[Unauthenticated command execution on Netgear DGN devices](http://roberto.greyhats.it/advisories/20130603-netgear-dgn.txt)\n\n[NETGEAR R7000 / R6400 - 'cgi-bin' Command Injection](https://www.exploit-db.com/exploits/41598/)\n\n[Vacron NVR Remote Command Execution](http://www.palada.net/index.php/2017/10/08/news-3522/)\n\n[\"JAWS\" unbranded DVR](https://www.pentestpartners.com/security-blog/pwning-cctv-cameras/)\n\n[Ubiquiti AirOS 6.x - Arbitrary File Upload](https://www.exploit-db.com/exploits/39701/)\n\n[Huawei B593 Authenticated RCE](http://blog.asiantuntijakaveri.fi/2013/08/gaining-root-shell-on-huawei-b593-4g.html)\n\n\n-----\n\nThe last one for Huawei routers is the only one you could consider a 0-day. Even though\nthe vulnerability dates back to 2013, exploiting it on Huawei HG532 & HG532a model\nrouters is a previously unknown attack vector. That said the attacker must be authenticated\nto exploit this vulnerability and, as we've already seen, authenticated access to the device is\noften all you need to brick it anyway.\n\nUnfortunately, it is quite common in IoT devices to patch only a specific model against a\nknown vulnerability while missing the exactly same vulnerability in other products. I myself\n[stumbled upon this situation while finding a new vulnerability in NETGEAR routers.](https://www.trustwave.com/Resources/SpiderLabs-Blog/CVE-2017-5521--Bypassing-Authentication-on-NETGEAR-Routers/)\n\n**Attack Vector: HNAP**\n\n[The HNAP module uses an exploit for D-Link devices to achieve RCE.](https://github.com/reverse-shell/routersploit/blob/master/routersploit/modules/exploits/routers/dlink/multi_hnap_rce.py)\n\nIt also tries to change network configuration to make the device unusable via authenticated\nrequests with default passwords.\n\n**Attack Vector: SOAP**\n\nThe SOAP module uses 3 exploits:\n\n[Eircom D-1000](https://github.com/XiphosResearch/exploits/blob/master/tr-06fail/tr-06fail-ssh-d1000.py)\n\n[Huawei CVE-2017-17215](https://blog.fortinet.com/2017/12/12/rise-of-one-more-mirai-worm-variant)\n\nRealtek [CVE-2014-8361](https://www.exploit-db.com/exploits/37169/)\n\n**Was this effective?**\n\nThe author of BrickerBot claims they have bricked 10 million devices, but I believe this is an\nexaggeration.\n\nMany of the devices they attacked can't be truly bricked and the author just restored them to\ndefault configuration, shut them down, rebooted them or changed configuration. This is\nmore in line with a Denial of Service attack rather than a real \"bricking\".\n\nOnce the owners of those devices restore them to working order, the bot probably repeats\nthe same attack on the same target. So while the bot may have successfully reached 10\nmillion hits, many of those hits were likely duplicates and didn't really brick those devices.\n\n[Even if we take a look at Shodan we can see that BrickerBot managed to attack quite a few](https://www.shodan.io/)\ndevices successfully, but the numbers are far lower.\n\nYou can find that the author left their manifest on few thousand devices:\n\n\n-----\n\nAnd there are also quite a lot Ubiquiti devices successfully breached:\n\n**What we can learn from this?**\n\nWhether or not you support this bot's approach to raising awareness in regards to IoT\nsecurity, the issue is real and there are takeaways here for both manufacturers and\nconsumers of IoT devices.\n\nIf you are a manufacturer of devices that are connected to the Internet: don't use default\npasswords, don't leave \"backdoor\" accounts, and don't run everything under root. If you are\nnot sure about the security of the products you offer for sale, you might want to open a bug\nbounty program. Many hardware manufacturers have discovered that the payouts for\ndisclosure via these types of programs are lower than the cost of the implications if your\ndevices are being compromised by a 0-day.\n\nIf you are an end user who has one of the devices that are on the BrickerBot list, make sure\nto install the latest firmware if there is an exploit for your device and make sure you didn't\nleave any default passwords intact.\n\nAnother good, basic security process is to disable remote administration unless you\nspecifically need it. If you do require remote administration I recommend the following:\n\nIf you are a more advanced user, set it up so that you connect to your local network via a\nmore secure channel first such as VPN or an SSH tunnel and then connect to your device.\n\nIf the above is still too advanced or too much work, you should at least use a strong\npassword and keep the device patched and up to date, You may also look at changing the\nsettings to run the service on a random port so it would be harder to find. It's not the\ngreatest of solutions, but it helps.\n\n\n-----\n\n**IoCs**\n\nLook for the following files in your device's filesystem:\n\n/tmp/system/update/sentinel.reload\n\n/tmp/system/control.cfg\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2017/2017-12-19 - BrickerBot mod_plaintext Analysis.pdf"
    ],
    "report_names": [
        "2017-12-19 - BrickerBot mod_plaintext Analysis.pdf"
    ],
    "threat_actors": [
        {
            "id": "cfdd35af-bd12-4c03-8737-08fca638346d",
            "created_at": "2022-10-25T16:07:24.165595Z",
            "updated_at": "2025-03-27T02:02:10.128957Z",
            "deleted_at": null,
            "main_name": "Sea Turtle",
            "aliases": [
                "Cosmic Wolf",
                "Marbled Dust",
                "Silicon",
                "Teal Kurma",
                "UNC1326"
            ],
            "source_name": "ETDA:Sea Turtle",
            "tools": [
                "Drupalgeddon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "bc289ba8-bc61-474c-8462-a3f7179d97bb",
            "created_at": "2022-10-25T16:07:24.450609Z",
            "updated_at": "2025-03-27T02:02:10.235933Z",
            "deleted_at": null,
            "main_name": "Avalanche",
            "aliases": [],
            "source_name": "ETDA:Avalanche",
            "tools": [],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "b753c6a8-a83d-47bc-829d-45e56136eb7d",
            "created_at": "2023-01-06T13:46:38.97802Z",
            "updated_at": "2025-03-27T02:00:02.967861Z",
            "deleted_at": null,
            "main_name": "GozNym",
            "aliases": [],
            "source_name": "MISPGALAXY:GozNym",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "33ae2a40-02cd-4dba-8461-d0a50e75578b",
            "created_at": "2023-01-06T13:46:38.947314Z",
            "updated_at": "2025-03-27T02:00:02.959421Z",
            "deleted_at": null,
            "main_name": "Sea Turtle",
            "aliases": [
                "SILICON",
                "Teal Kurma",
                "UNC1326",
                "COSMIC WOLF",
                "Marbled Dust"
            ],
            "source_name": "MISPGALAXY:Sea Turtle",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673535903,
    "ts_updated_at": 1743041162,
    "ts_creation_date": 1653709750,
    "ts_modification_date": 1653709750,
    "files": {
        "pdf": "https://archive.orkl.eu/ef7bee83db9b257ef93fd2bedad495515c285688.pdf",
        "text": "https://archive.orkl.eu/ef7bee83db9b257ef93fd2bedad495515c285688.txt",
        "img": "https://archive.orkl.eu/ef7bee83db9b257ef93fd2bedad495515c285688.jpg"
    }
}