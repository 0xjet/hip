{
    "id": "42ed3639-afe5-4c63-8371-349f98fd4282",
    "created_at": "2022-10-25T16:48:15.604095Z",
    "updated_at": "2025-03-27T02:09:30.941979Z",
    "deleted_at": null,
    "sha1_hash": "a1b9d5a178a30f272b3f420a9b2263eac2c73e35",
    "title": "NetTraveler Spear-Phishing Email Targets Diplomat of Uzbekistan - Palo Alto Networks BlogPalo Alto Networks Blog",
    "authors": "",
    "file_creation_date": "2016-08-11T22:56:49Z",
    "file_modification_date": "0001-01-01T00:00:00Z",
    "file_size": 1188768,
    "plain_text": "### 70\n\n\n**attempted to exploit CVE-2012-0158 to install the NetTraveler Trojan.**\n\n**On December 12, 2015, a spear-phishing email was sent to a diplomat of the Embassy of**\n\n**Uzbekistan. The body and subject of the email suggests that the email was spoofed to look like it**\n\n**was sent by the Russian Foreign Ministry and the attachment may contain an official annual**\n\n**[report on CHS (Council of Heads of Member States), who form the SCO (Shanghai Cooperation](https://en.wikipedia.org/wiki/Shanghai_Cooperation_Organisation)**\n\n**Organization).**\n\n**_Filename: “2015.12.11_сроки СГГ 2015 в Уфе.doc.doc” (translated to: “2015.12.11_sroki CHS_**\n\n**_in 2015 Ufe.doc.doc”)_**\n\n**_Body: “С уважением, ДАТС МИД России” (translated to: “Yours faithfully, ACSD Russian_**\n\n**_Foreign Ministry”)_**\n\n**It is interesting to note the reference of Ufa in the file name, as the city of Ufa in Russia hosted**\n\n**[the SCO BRICS Summit on July 9 and 10, 2015. SCO and BRICS (Brazil, Russia, India, China](http://ufa2015.com/)**\n\n**and South Africa) are intergovernmental international organizations focused on issues of**\n\n**regional security and economic cooperation.**\n\n**_Figure 1 Leaders of member nations at the 2015 Summit in Ufa_**\n\n**Our analysis shows that actors attempted to exploit CVE-2012-0158 to install NetTraveler**\n\n**Trojan.**\n\n|Col1|POSTED BY: Vicky Ray and Robert Falcone on January 21, 2016 8:45 AM|\n|---|---|\n|70||\n|LLiikkee|FILED IN: Malware, Threat Prevention, Unit 42 TAGGED: AutoFocus, NetTraveler, spearphishing, Trojan, Ufa, Ufe, Uzbekistan, WildFire Unit 42 recently identified a targeted attack against an individual working for the Foreign Ministry of Uzbekistan in China. A spear-phishing email was sent to a diplomat of the Embassy of Uzbekistan who is likely based in Beijing, China. In this report, we’ll review how the actors|\n|Tweet||\n|2||\n\n\n## Traps v3.4: Good News for Breach Prevention in Government Environments\n\n**[posted by Pamela Warren on August 11, 2016](http://researchcenter.paloaltonetworks.com/author/pwarren/)**\n\n## Are the Security Issues Facing the Industrial IoT Over-Hyped?\n\n**[posted by Rick Howard on August 10, 2016](http://researchcenter.paloaltonetworks.com/author/rick/)**\n\n## Traps v3.4: New Features Help Prevent Cyberattacks on Banks\n\n**[posted by Lawrence Chin on August 9, 2016](http://researchcenter.paloaltonetworks.com/author/lawrence-chin/)**\n\n## New Traps v3.4 Features Improve Protection in Healthcare Environments\n\n**[posted by Matt Mellen on August 8, 2016](http://researchcenter.paloaltonetworks.com/author/matt-mellen/)**\n\n## A Powerful Combination: New Cyber Breach Prevention Offering\n\n**[posted by Eric Schou on August 8, 2016](http://researchcenter.paloaltonetworks.com/author/eric-schou/)**\n\n**[MORE →](http://researchcenter.paloaltonetworks.com/archives/)**\n\n\n**Select a Category**\n\n**Select a Month**\n\n**[MORE →](http://researchcenter.paloaltonetworks.com/archives/)**\n\n\n## 2\n\n\n-----\n\n**Upon successful exploitation, the attachment will install the trojan known as NetTraveler using a**\n\n**[DLL side-loading attack technique. The NetTraveler trojan has been known to be used in](https://www.fireeye.com/content/dam/fireeye-www/global/en/current-threats/pdfs/rpt-dll-sideloading.pdf)**\n\n**[targeted cyber espionage attacks for more than a decade by nation state threat actors and](https://securelist.com/blog/research/66272/nettraveler-apt-gets-a-makeover-for-10th-birthday/)**\n\n**continues to be used to target its victims and exfiltrate data.**\n\n**The DLL side-loading attack technique has been gaining adoption within the cyber espionage**\n\n**[realm by threat actors to bypass traditional security systems. Unit 42 also published a blog last](http://researchcenter.paloaltonetworks.com/2015/05/plugx-uses-legitimate-samsung-application-for-dll-side-loading/)**\n\n**year discussing an unrelated attack where the DLL side-loading technique was used.**\n\n**Figure 3 illustrates the exploitation and the infection flow of the malware.**\n\n**_Figure 3 Overview of the infection flow_**\n\n**The document “2015.12.11_сроки СГГ 2015 в Уфе.doc.doc” exploits CVE-2012-0158 to drop a**\n\n**decoy file “~$.doc” and the actual payload “DW20.exe”. The decoy is a blank document with the**\n\n**meta data stripped.**\n\n**The payload (DW20.exe) is a self-extracting (SFX) RAR archive that contains the following files:**\n\n**_RasTls.exe_**\n\n**_rastls.dll_**\n\n**_Sycmentec.config_**\n\n\n-----\n\n**_Setup=RasTls.exe_**\n\n**_TempMode_**\n\n**_Silent=1_**\n\n**_Overwrite=1_**\n\n**The figure below shows that the config file, ‘Sycmentec.config’ is encrypted.**\n\n**The ‘Sycmentec.config’ file can be decrypted using a single byte XOR algorithm using ‘0x77’ as**\n\n**a key.**\n\n**_Figure 5 Encrypted ‘Sycmentec.config’file_**\n\n**The ‘rastls.dll’ DLL will load and decrypt this file. The decrypted data starts with shellcode that is**\n\n**responsible for loading an embedded DLL and executing it.**\n\n**Figure 6 shows the decrypted ‘Sycmentec.config’file containing an embedded DLL.**\n\n**_Figure 6 Decrypted ‘Sycmentec.config’ file contains an embedded DLL_**\n\n**The embedded DLL is the functional payload, which is a variant of the NetTraveler Trojan that**\n\n**has the following attributes:**\n\n**Size** **52736 bytes**\n\n**Type** **PE32 executable (DLL) (GUI) Intel 80386, for MS Windows**\n\n**Architecture** **32 Bits binary**\n\n**MD5** **3e3df4fe831d87d7f52f14933e464fc3**\n\n**SHA1** **cce65a0b67674a313091a947506ceb91d30605ad**\n\n**SHA256** **3b4e4d7a0b1185a45968d90ffe6346f4621116d14dbf88b5138040acc022c757**\n\n**ssdeep** **1536:jxKW1S8mWKFU7U9lYjhjXwVqTvS/G405:wCBmUw9lAhLWqW/G40**\n\n**imphash** **85ce31f87f06b02fec915d33d82958e8**\n\n**Date** **0x564B2B07 [Tue Nov 17 13:26:31 2015 UTC]**\n\n\n-----\n\n**Packers** **Armadillo v1.xx – v2.xx**\n\n**Entry Point** **0x1000970b .text 1/5**\n\n**_Table 1 Attributes of the embedded DLL (NetTraveler)_**\n\n**The first execution of this NetTraveler Trojan starts off with an installation process. Like**\n\n**previous versions, this NetTraveler sample writes its configuration to a file, in this case the**\n\n**configuration is written to a file named “config.dat”.**\n\n**_Figure 7 NetTraveler writes the configuration to ‘config.dat’ file_**\n\n**During execution, NetTraveler creates a mutex of ‘YOYWOW!657’, as shown in Figure 8 below**\n\n**to avoid running multiple instances of its code.**\n\n**_Figure 8 Mutex created for this NetTraveler payload_**\n\n**The code then enumerates the ‘netsvcs’ services, which are services that run within the process**\n\n**space of svchost.exe, specifically ignoring services named ‘6to4’ and ‘Ias’ as these services**\n\n**have been used by other malware families.**\n\n**When it finds another netsvcs service with a name not matching these two names, it will delete**\n\n**the file associated with the service and copy the ‘rastls.dll’ file to that folder using ‘<service**\n\n**name>ve.dll’ as the filename as shown in Figure 9 below.**\n\n\n-----\n\n**_Figure 9 Code enumerating ‘netsvcs’ services_**\n\n**_Figure 10 Renamed ‘rastls.dll’ DLL_**\n\n**The malware will then change the binary path of the service to point to this new filename and**\n\n**copies the “Sycmentec.config” file to the same folder and the ‘config.dat’ file to the following**\n\n**location:**\n\n**_c:\\windows\\system\\CERTAPL.DLL_**\n\n**The NetTraveler payload relies on the ‘rastls.dll’ file to obtain its C2 server. At first glance, the**\n\n**NetTraveler payload appears as if it will use the following URL for its C2 server:**\n\n**_http://192.168.3[.]201/downloader2013/asp/downloader.asp_**\n\n**However, the NetTraveler payload reads the last ‘0xb0’ bytes from the rastls.dll file and uses it to**\n\n**create the “config.dat” file that is later saved to “CERTAPL.DLL”. This technique hides the true**\n\n**C2 server from researchers that do not have access to both the rastls.dll and Sycmentec.config**\n\n**files.**\n\n\n-----\n\n**_Figure 11 Code snippet showing NetTraveler obtaining its configuration from rastls.dll._**\n\n**The configuration file is structured as an “.ini” file as the Trojan uses GetPrivateProfileStringA to**\n\n**parse the contents. The configuration file has the following contents:**\n\n\n**1**\n**2**\n**3**\n**4**\n**5**\n**6**\n**7**\n\n\n\n**[OOOOOO]**\n**U00P=r^?<80>}H>?<88><89><8A>B<8B><85>|<86><87><89><91><8B><90><92><88>**\n**K00P=XLMNOPQRSTUVWXYZ[\\]^_`abcdefghiv**\n**P00D=5**\n**F00G=True**\n**MM1=0**\n**MM6=1**\n\n\n**Unit 42 analyzed the sample and found the following configuration fields that could appear in the**\n\n**CERTAPL.DLL configuration file and a brief description of each field:**\n\n\n**1**\n**2**\n**3**\n**4**\n**5**\n**6**\n**7**\n**8**\n**9**\n\n\n**U00P = C2 URL**\n**K00P = Key for** **DES**\n**P00D = Sleep interval in** **minutes**\n**F00G = Boolean** **to** **determine if** **sample should use** **proxy to** **communicat**\n**MM1 = 0** **or** **1** **if** **proxy is** **configured or** **not.**\n**MM3 = Port for** **configured proxy**\n**MM4 = Username for** **configured proxy**\n**MM5 = Password for** **configured proxy**\n**MM6 = 1** **if** **Trojan is** **installed correctly**\n\n\n**The “U00P” and “K00P” values are decrypted using a simple algorithm that subtracts the index**\n\n**and then subtracts ten from each character, which is depicted in the following:**\n\n\n**1**\n**2**\n**3**\n**4**\n**5**\n**6**\n**7**\n\n\n**def subtraction_algo(ct):**\n**out = \"\"**\n**i = 0**\n**for** **e** **in** **ct:**\n**out += chr(ord(e)-i-10)**\n**i += 1**\n**return** **out**\n\n\n**These two fields decrypt to the following, the U00P value being the C2 URL and the K00P value**\n\n**being the basis for an encryption key for the DES algorithm:**\n\n**_U00P: http://www.voennovosti.com/optdet/index.asp (decrypted)_**\n\n**_K00P: NAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAM (decrypted)_**\n\n**The C2 server will respond to requests issued by the Trojan with commands to carry out**\n\n**activities on the compromised system. We analyzed the code within NetTraveler that handles**\n\n**commands issued by the C2 server and found four available commands that are listed in Table**\n\n**2.**\n\n**Command** **Description**\n\n\n-----\n\n**<Unique System**\n\n**ID>:RUN_REBOOT**\n\n**<Unique System**\n\n**ID>:RUN_STARTUP**\n\n**<Unique System**\n\n**ID>:RUN_DIRECT**\n\n\n**%STARTUP%\\consent.lnk and**\n\n**exits the process. This attempts to**\n\n**uninstall the Trojan, but will not**\n\n**work as the filenames are not**\n\n**used by this version of**\n\n**NetTraveler**\n\n**Reboots the system**\n\n**Downloads a file to**\n\n**%TEMP%\\Temp.bmp and copies**\n\n**it to the startup folder**\n\n**Download a file to**\n\n**%TEMP%\\tmp.bmp and execute it**\n\n\n**_Table 2 Commands available within NetTraveler and a description of their functionality_**\n\n**At the time of analysis, the domain voennovosti[.]com was resolving to IP ‘98.126.38[.]107’,**\n\n**[which is hosted by Krypt Technologies. A report published by Kaspersky Labs in 2011 on](http://kasperskycontenthub.com/wp-content/uploads/sites/43/vlpdfs/kaspersky-the-net-traveler-part1-final.pdf)**\n\n**NetTraveler also mentions the C2 servers were being hosted by Krypt Technolgies. This web**\n\n**hosting service provider continues to be the hosting provider of choice for the threat actors**\n\n**behind NetTraveler.**\n\n**_Figure 12 DNS query for voennovosti[.]com resolves to ‘98.126.38.107’_**\n\n**_Figure 13 Encoded network communications_**\n\n**NetTraveler has been used to target diplomats, embassies and government institutions for over**\n\n**a decade, and remains the tool of choice by the adversaries behind these cyber espionage**\n\n**campaigns. The use of NetTraveler for such a long period of time shows its effectiveness and**\n\n**success by the adversaries in targeting their victims with impunity.**\n\n**As seen in this case, the threat actors continue to evolve and employ new techniques within**\n\n**their modus operandi, like ‘DLL side-loading’ to install malware. It is likely that the use of ‘DLL**\n\n**side loading’ attack technique will increase due to it’s effectiveness to bypass traditional security**\n\n**systems.**\n\n**It is essential to raise awareness on such attacks to better protect organizations from**\n\n**d** **i** **h** **b** **b** **k d b** **ti** **t t**\n\n\n-----\n\n**SHA256 Hash** **File Name**\n\n**3f4fcde99775b83bc88d30ca99f5c70c1dd8b96d970dbfd5a846b46c6ea3e534** **2015.12.11_сроки**\n\n**СГГ 2015 в**\n\n**Уфе.doc.doc**\n\n**001fff6c09497f56532e83e998aaa80690a668883b6655129d408dd098bd1b4b** **DW20.exe**\n\n**74db11900499aa74be9e62d51889e7611eb8161cd141b9379e05eeca9d7175c9** **rastls.dll**\n\n**8f6af103bf7e3201045ce6c2af41f7a17ef671f33f297d36d2aab8640d00b0f0** **Sycmentec.config**\n\n**495bb9c680f114b255f92448e784563e4fd34ad19cf616cc537bec6245931b7e** **config.dat**\n\n**41650cb6b4ae9f06c92628208d024845026c19af1ab3916c99c80c6457bd4fa9** **CERTAPL.DLL**\n\n**3b4e4d7a0b1185a45968d90ffe6346f4621116d14dbf88b5138040acc022c757** **(NetTraveler DLL**\n\n**payload)**\n\n**Command and Control**\n\n**voennovosti[.]com**\n\n**98.126.38[.]107**\n\n**https://securelist.com/blog/research/35936/nettraveler-is-running-red-star-apt-attacks-**\n\n**compromise-high-profile-victims/**\n\n**https://www.fireeye.com/blog/threat-research/2014/04/dll-side-loading-another-blind-spot-for-**\n\n**anti-virus.html**\n\n**http://researchcenter.paloaltonetworks.com/2015/05/plugx-uses-legitimate-samsung-**\n\n**application-for-dll-side-loading/**\n\n**http://indianexpress.com/article/business/business-others/10-years-on-sco-decides-to-induct-**\n\n**india-as-full-member/**\n\n**[https://en.wikipedia.org/wiki/Shanghai_Cooperation_Organisation](https://en.wikipedia.org/wiki/Shanghai_Cooperation_Organisation)**\n\n**[http://ufa2015.com/](http://ufa2015.com/)**\n\n**June 4, 2016 9:58 PM**\n## Automated Infrastructure Alerts - RiskIQ\n\n**June 4, 2016 9:58 PM**\n## Automated Infrastructure Alerts - RiskIQ\n\n**August 2, 2016 6:40 AM**\n## NetTraveler - La menace persistante avancée (APT) cible les intérêts russes et européens | UnderNews\n\n\n### Name *\n\n Email *\n\n Website\n\n\n-----\n\n**[Privacy Policy](https://www.paloaltonetworks.com/legal/privacy.html)** **[Legal Notices](https://www.paloaltonetworks.com/legal.html)** **[Site Index](https://www.paloaltonetworks.com/site-index.html)** **[Subscriptions](https://www.paloaltonetworks.com/company/subscriptions.html)** **Copyright © 2007-2013 Palo Alto Networks**\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        }
    ],
    "references": [
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2016/2016.01.21.NetTraveler_Uzbekistan/nettraveler-spear-phishing-email-targets-diplomat-of-uzbekistan.pdf"
    ],
    "report_names": [
        "nettraveler-spear-phishing-email-targets-diplomat-of-uzbekistan"
    ],
    "threat_actors": [
        {
            "id": "808d8d52-ca06-4a5f-a2c1-e7b1ce986680",
            "created_at": "2022-10-25T16:07:23.899157Z",
            "updated_at": "2025-03-27T02:02:10.019417Z",
            "deleted_at": null,
            "main_name": "NetTraveler",
            "aliases": [
                "APT 21",
                "Hammer Panda",
                "NetTraveler",
                "TEMP.Zhenbao"
            ],
            "source_name": "ETDA:NetTraveler",
            "tools": [
                "Agent.dhwf",
                "Destroy RAT",
                "DestroyRAT",
                "Kaba",
                "Korplug",
                "NetTraveler",
                "Netfile",
                "PlugX",
                "RedDelta",
                "Sogu",
                "TIGERPLUG",
                "TVT",
                "Thoper",
                "TravNet",
                "Xamtrav"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "254f2fab-5834-4d90-9205-d80e63d6d867",
            "created_at": "2023-01-06T13:46:38.31544Z",
            "updated_at": "2025-03-27T02:00:02.802896Z",
            "deleted_at": null,
            "main_name": "APT21",
            "aliases": [
                "HAMMER PANDA",
                "TEMP.Zhenbao",
                "NetTraveler"
            ],
            "source_name": "MISPGALAXY:APT21",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1666716495,
    "ts_updated_at": 1743041370,
    "ts_creation_date": 1470956209,
    "ts_modification_date": 0,
    "files": {
        "pdf": "https://archive.orkl.eu/a1b9d5a178a30f272b3f420a9b2263eac2c73e35.pdf",
        "text": "https://archive.orkl.eu/a1b9d5a178a30f272b3f420a9b2263eac2c73e35.txt",
        "img": "https://archive.orkl.eu/a1b9d5a178a30f272b3f420a9b2263eac2c73e35.jpg"
    }
}