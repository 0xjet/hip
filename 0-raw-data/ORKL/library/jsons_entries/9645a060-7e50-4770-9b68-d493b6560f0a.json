{
    "id": "9645a060-7e50-4770-9b68-d493b6560f0a",
    "created_at": "2023-01-12T15:04:37.941317Z",
    "updated_at": "2025-03-27T02:06:01.620127Z",
    "deleted_at": null,
    "sha1_hash": "14eae50d5fd7b7318f831c61636c78d3e20b8c4d",
    "title": "2021-10-20 - Newly Found npm Malware Mines Cryptocurrency on Windows, Linux, macOS Devices",
    "authors": "",
    "file_creation_date": "2022-05-28T23:16:53Z",
    "file_modification_date": "2022-05-28T23:16:53Z",
    "file_size": 1816976,
    "plain_text": "# Newly Found npm Malware Mines Cryptocurrency on Windows, Linux, macOS Devices\n\n**[blog.sonatype.com/newly-found-npm-malware-mines-cryptocurrency-on-windows-linux-macos-devices](https://blog.sonatype.com/newly-found-npm-malware-mines-cryptocurrency-on-windows-linux-macos-devices)**\n\n\n-----\n\n_Update: Following our disclosure of these malicious packages, the legitimate library ua-_\n_parser-js\" used by millions was itself was found to be compromised. We have released a_\n_[subsequent blog post covering the \"ua-parser-js\" compromise.](https://blog.sonatype.com/npm-project-used-by-millions-hijacked-in-supply-chain-attack)_\n\nSonatype’s automated malware detection system has caught multiple malicious packages on\nthe npm registry this month. These packages disguise themselves as legitimate JavaScript\nlibraries but were caught launching cryptominers on Windows, macOS and Linux machines.\n\nThe malicious packages are:\n\nokhsa\nklow\nklown\n\n“klow, klown” have been tracked under Sonatype-2021-1472. Whereas, “okhsa” has been\ncataloged under Sonatype-2021-1473.\n\nDifferent versions of the “okhsa” package largely contain skeleton code that launches the\nCalculator app on Windows machines pre-installation. But additionally, these versions\ncontain either the “klow” or the “klown” npm package as a dependency—which is malicious.\n\nThe manifest file, package.json, for “okhsa” shows “klown” listed as a dependency.\n\n[All of these packages were published by the same author whose account has since been](http://web.archive.org/web/20211015081949/https://www.npmjs.com/~wozheqirsplu)\ndeactivated:\n\n\n-----\n\nThe Sonatype security research team discovered that “klown” had emerged within hours of\n[“klow” having been removed by npm. “Klown” falsely touts itself to be a legitimate JavaScript](https://archive.is/wip/dNDKz)\nlibrary “UA-Parser-js” to help developers extract the hardware specifics (OS, CPU, browser,\nengine, etc.) from the “User-Agent” HTTP header.\n\nBut, Sonatype security researcher Ali ElShakankiry who analyzed these packages explains,\n“Packages ‘klow’ and ‘klown’ contain a cryptocurrency miner. These packages detect the\ncurrent operating system at the preinstall stage, and proceed to run a .bat or .sh script\ndepending on if the user is running Windows, or a Unix-based operating system.”\n\n“These scripts then download an externally-hosted EXE or a Linux ELF, and execute the\nbinary with arguments specifying the mining pool to use, the wallet to mine cryptocurrency\nfor and the number of CPU threads to utilize ”\n\n\n-----\n\nOne of the Batch scripts found in the klown package are shown below:\n\nThe script downloads the “jsextension.exe” from a Russia-based host 185.173.36[.]219.\n\n[The EXE is a known cryptominer, as previously flagged by VirusTotal. For Linux and macOS](https://www.virustotal.com/gui/file/7f986cd3c946f274cdec73f80b84855a77bc2a3c765d68897fbc42835629a5d5)\n[installations, an identical Bash script downloads the “jsextension” ELF binary from the same](https://www.virustotal.com/gui/file/ea131cc5ccf6aa6544d6cb29cdb78130feed061d2097c6903215be1499464c2e)\nhost.\n\nShown below is a screenshot from a test run of the crypto mining EXE, generated via\nany.run. Note, the malicious EXE runs quietly in the background on an infected machine, but\nfor the purposes of demonstration we are showing how the process would appear if it wasn't\nhidden:\n\nIt isn’t clear how the author of these packages aims to target developers. There are no\n[obvious signs observed that indicate a case of typosquatting or dependency hijacking.](https://blog.sonatype.com/dependency-hijacking-software-supply-chain-attack-hits-more-than-35-organizations)\n“Klow(n)” does impersonate the legitimate UAParser.js library on the surface, making this\n[attack seem like a weak brandjacking attempt.](https://blog.sonatype.com/twilio-npm-is-brandjacking-malware-in-disguise)\n\n\n-----\n\nThe Sonatype security research team reported these malicious packages to npm on October\n15, 2021, hours after their release, and the packages were taken down the same day by the\nnpm security team.\n\n## Evolving open source supply-chain attacks warrant advanced protection\n\nOnce again, this particular discovery is a further indication that developers are the new target\nfor adversaries over the software they write. Sonatype has been tracing novel brandjacking,\ntyposquatting, and [cryptomining malware lurking in software repositories. We’ve also found](https://blog.sonatype.com/sonatype-catches-new-pypi-cryptomining-malware-via-automated-detection)\n[critical vulnerabilities and next-gen supply-chain attacks, as well as copycat packages](https://blog.sonatype.com/netmask-flaw-leaves-millions-vulnerable-while-a-php-git-server-is-hacked-in-software-supply-chain-attack)\n[targeting well-known tech companies.](https://blog.sonatype.com/malicious-dependency-confusion-copycats-exfiltrate-bash-history-and-etc-shadow-files)\n\nThe good news is, over the past few weeks, our automated malware detection system has\ncaught thousands of suspicious packages on npm. These components are either confirmed\nmalicious, previously known to be malicious, or dependency confusion copycats.\n\nWe are now expanding our malware detection capabilities via Nexus Intelligence to other\necosystems as well, such as PyPI.\n\nAll of this takes more than just due diligence and luck – it takes the expertise of experienced\nsecurity professionals and hundreds of terabytes of data. In order to keep pace with malware\nmutations, Sonatype analyses every newly-released npm package to keep developers safe.\n\nWe help you remain proactive and safeguard your software supply chains against up-andcoming attacks. Our [AI/ML-powered automated malware detection system (which is part of](https://blog.sonatype.com/meet-the-developers-behind-sonatypes-automated-malware-detection-system-securing-open-source-supply-chains)\nNexus Firewall and powered by Nexus Intelligence data), and security research team work\ntogether for full-spectrum protection. Nexus determines a likely malicious component based\non historical supply chain attacks and over five-dozen “signals.” This insight enables flagging\nfor potential new attacks before security researchers discover them.\n\n\n-----\n\nAs soon as our system flags a package or a dependency as suspicious, it undergoes a\nquarantine queue for manual review by the Sonatype Security Research Team. Users of\n[Nexus Firewall are then protected from these suspicious packages while the review is](https://blog.sonatype.com/sonatype-releases-new-nexus-firewall-policy-to-secure-software-supply-chains-from-dependency-confusion-attacks)\nunderway. Existing components are quarantined before they are pulled “downstream” into a\ndeveloper’s open source build environment.\n\nMoreover, users that have enabled the “Dependency Confusion Policy” feature will get\nproactive protection from dependency confusion attacks. This works whether conflicting\npackage names exist in a public repository or in your private, internal repos.\n\nSonatype’s world-class security research data, combined with our automated malware\ndetection technology safeguards your developers, customers, and software supply chain\nfrom infections.st content here…\n\nTags: [vulnerabilities,](https://blog.sonatype.com/topic/vulnerabilities) [featured,](https://blog.sonatype.com/topic/featured) [Nexus Intelligence Insights](https://blog.sonatype.com/topic/nexus-intelligence-insights)\n\n\n-----\n\n### Written by Sonatype Security Research Team\n\nSonatype's Security Research Team is comprised 65 world class professionals with 500+\nyears of experience. The Team is focused on bringing real-time, in-depth intelligence and\nactionable information about open source and third party vulnerabilities to Sonatype\ncustomers.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-10-20 - Newly Found npm Malware Mines Cryptocurrency on Windows, Linux, macOS Devices.pdf"
    ],
    "report_names": [
        "2021-10-20 - Newly Found npm Malware Mines Cryptocurrency on Windows, Linux, macOS Devices.pdf"
    ],
    "threat_actors": [
        {
            "id": "aa73cd6a-868c-4ae4-a5b2-7cb2c5ad1e9d",
            "created_at": "2022-10-25T16:07:24.139848Z",
            "updated_at": "2025-03-27T02:02:10.120505Z",
            "deleted_at": null,
            "main_name": "Safe",
            "aliases": [],
            "source_name": "ETDA:Safe",
            "tools": [
                "DebugView",
                "LZ77",
                "OpenDoc",
                "SafeDisk",
                "TypeConfig",
                "UPXShell",
                "UsbDoc",
                "UsbExe"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535877,
    "ts_updated_at": 1743041161,
    "ts_creation_date": 1653779813,
    "ts_modification_date": 1653779813,
    "files": {
        "pdf": "https://archive.orkl.eu/14eae50d5fd7b7318f831c61636c78d3e20b8c4d.pdf",
        "text": "https://archive.orkl.eu/14eae50d5fd7b7318f831c61636c78d3e20b8c4d.txt",
        "img": "https://archive.orkl.eu/14eae50d5fd7b7318f831c61636c78d3e20b8c4d.jpg"
    }
}