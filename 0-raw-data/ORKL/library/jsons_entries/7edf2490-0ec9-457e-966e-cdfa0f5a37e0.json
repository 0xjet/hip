{
    "id": "7edf2490-0ec9-457e-966e-cdfa0f5a37e0",
    "created_at": "2023-01-12T15:08:03.473082Z",
    "updated_at": "2025-03-27T02:16:26.586019Z",
    "deleted_at": null,
    "sha1_hash": "955de952403002d36c45702236e1c01b913be653",
    "title": "2017-09-26 - XPCTRA Malware Steals Banking and Digital Wallet User's Credentials",
    "authors": "",
    "file_creation_date": "2022-05-28T15:41:08Z",
    "file_modification_date": "2022-05-28T15:41:08Z",
    "file_size": 716532,
    "plain_text": "# SANS ISC: XPCTRA Malware Steals Banking and Digital Wallet User's Credentials - SANS Internet Storm Center SANS Site Network Current Site SANS Internet Storm Center Other SANS Sites Help Graduate Degree Programs Security Training Security Certification Security Awareness Training Penetration Testing Industrial Control Systems Cyber Defense Foundations DFIR Software Security Government OnSite Training SANS ISC InfoSec Forums\n\n**[isc.sans.edu/forums/diary/XPCTRA+Malware+Steals+Banking+and+Digital+Wallet+Users+Credentials/22868/](https://isc.sans.edu/forums/diary/XPCTRA+Malware+Steals+Banking+and+Digital+Wallet+Users+Credentials/22868/)**\n\nXPCTRA Malware Steals Banking and Digital Wallet User's Credentials\n\n\n**1. Introduction**\n\nWhile hunting some phishing emails these days, I came across a malware\ncampaign similar to EngineBox, a banker capable of stealing user credentials\nfrom multiple banks [1]. XPCTRA, as I call today’s variant, in addition to banking\ndata, steals online digital wallet users’ credentials from services such as\nBlockchain.info and PerfectMoney.\n\nThe malspams used in the campaign try to induce the victim to open a\nsupposed bank bill link. It actually leads to the download of the XPCTRA\ndropper, that is, the part of the malware responsible for environment recognition\nand downloading new components. Once executed, it initiates a connection with\nan Internet address to download other malware parts responsible for later\nmalicious actions.\n\nIn this diary, I present the XPCTRA analysis the indicators of compromise used\nin this campaign.\n\n**2. Threat analysis**\n\nUnlike the previous variant, XPCTRA (read it like “expectra”) does not make use\nof as many layers of encoding as EngineBox did to try bypassing security\nlayers, which made the analysis simpler.\n\nLook at the diagram shown in Figure 1 and the textual description below to\nunderstand the threat flow, from malicious e-mail to data theft:\n\nThe infection vector (malspam) links to a supposed PDF invoice, which\nactually leads the victim to download an executable file (dropper);\nOnce executed, the dropper downloads a “.zip” file, unzips and executes\nthe malware payload;\n\n\nRenato\n\n82\nPosts\n\nISC\nHandler\nSep\n26th\n2017\n\n\n-----\n\nIt then begins a series of actions, including:\n\nPersists itself into the OS, in order to survive system reboot;\nChanges Firewall policies to allow the malware to communicate\nunrestrictedly with the Internet;\nInstantiates “Fliddler”, an HTTP Proxy that is used to monitor and\nintercept user access to the financial institutions;\nInstalls the Fiddler root certificate to prevent the user from receiving\ndigital certificate errors;\nPoints Internet Browsers settings to the local proxy (Fiddler);\nMonitors and captures user credentials while accessing the websites\nof 2 major Brazilian banks and other financial institutions;\nStolen credentials are sent to criminals through an unencrypted C&C\nchannel;\nEstablishes an encrypted channel to allow the victim’s system to be\ncontrolled by the attackers (RAT);\nMonitors and captures user credentials while accessing email\nservices like Microsoft Live, Terra, IG and Hotmail. These accesses\nare used to spread the malware further;\n\n\n-----\n\nFigure 1 - XPCTRA Threat Flow\n\nNOTE: The XPCTRA sample analysed here (idfptray.exe) was not yet known by\nVT (VirusTotal) until my submission.\n\n**3. Quasar RAT**\n\nAfter posting EngineBox malware analysis [1] last month, through community\nfeedback, I came to know that the threat embedded a framework called Quasar\nRAT [2] developed in C# The goal of this framework is to provide a tool for\n\n\n-----\n\nremote access and management of Windows computers hence the name,\nRAT (Remote Access Tool).\n\nIt turns out the variety of functions the open-source framework has, such as\nremote desktop, keylogger, etc., made it quite attractive for cybercriminals who\nended up using it as a RAT (Remote Access Trojan) tool within their malware.\n\nNotice in Figure 2 the similarity of Quasar RAT directory tree on the left, and the\nXPCTRA code on the right.\n\nFigure 2—Similarity between Quasar RAT and XPCTRA directory trees\n\nIn addition to Quasar, XPCTRA incorporates Fiddler to play the role of HTTP\nProxy and, of course, the code responsible for intercepting communications with\nfinancial institutions and sending SPAM as well.\n\n**4. Digital currency wallets**\n\nIn addition to banking credentials, XPCTRA is able to steal digital currency\nwallet’s credentials hosted online like Blockchain.info, PerfectMoney and\nNeteller. Look at Figures 3 and 4 for code snippets of capturing moments and\nsending user credentials from some of these institutions.\n\n\n-----\n\nFigure 3 - Capturing user’s PerfectMoney credentials\n\nFigure 4 – Sending data to C&C\n\n**5. Final words**\n\nThe result of this analysis draws our attention to the security of digital currency\nwallets, especially those “hosted” in the cloud. Just as customers of traditional\nfinancial institutions have faced over the years the most diverse fraud attempts\nand had to protect themselves, so should digital money users. Give preference\nto services that offer a second authentication factor for transactions and be sure\nto enable it.\n\n**6. Indicators of compromise (IOCs)**\n\nFiles\n\nMD5 (250920178234282343294329423.exe) =\n4fec5a95ba8222979b80c0fc83f81edd\n\nMD5 (idfptray.exe) = 339c48b0ac25a9b187b8e76582580570\n\nNetwork\n\n\n-----\n\nhxxp://65.181.113.151/telnetd/chaves3.zip\nhxxp://fritas.cheddarmcmelt.top/master/PhpTrafico.php\nhxxp://fritas.cheddarmcmelt.top/master/Controle.php\nhxxp://fritas.cheddarmcmelt.top/master/conf/Html.txt\ncoca.cheddarmcmelt.top TCP/8799\ncoca.cheddarmcmelt.top TCP/222\n\n**7. References**\n\n[1] https://morphuslabs.com/enginebox-malware-amea%C3%A7a-clientes-demais-de-10-bancos-brasileiros-a8061c4c3cda\n\n[2] [https://github.com/quasar/QuasarRAT](https://morphuslabs.com/r/?url=https%3A%2F%2Fgithub.com%2Fquasar%2FQuasarRAT)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2017/2017-09-26 - XPCTRA Malware Steals Banking and Digital Wallet User's Credentials.pdf"
    ],
    "report_names": [
        "2017-09-26 - XPCTRA Malware Steals Banking and Digital Wallet User's Credentials.pdf"
    ],
    "threat_actors": [
        {
            "id": "75108fc1-7f6a-450e-b024-10284f3f62bb",
            "created_at": "2024-11-01T02:00:52.756877Z",
            "updated_at": "2025-03-27T02:00:55.544216Z",
            "deleted_at": null,
            "main_name": "Play",
            "aliases": null,
            "source_name": "MITRE:Play",
            "tools": [
                "Nltest",
                "AdFind",
                "PsExec",
                "Wevtutil",
                "Cobalt Strike",
                "Playcrypt",
                "Mimikatz"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1673536083,
    "ts_updated_at": 1743041786,
    "ts_creation_date": 1653752468,
    "ts_modification_date": 1653752468,
    "files": {
        "pdf": "https://archive.orkl.eu/955de952403002d36c45702236e1c01b913be653.pdf",
        "text": "https://archive.orkl.eu/955de952403002d36c45702236e1c01b913be653.txt",
        "img": "https://archive.orkl.eu/955de952403002d36c45702236e1c01b913be653.jpg"
    }
}