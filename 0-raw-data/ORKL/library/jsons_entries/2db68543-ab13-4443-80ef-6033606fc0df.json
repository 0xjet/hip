{
    "id": "2db68543-ab13-4443-80ef-6033606fc0df",
    "created_at": "2023-01-12T15:02:32.713017Z",
    "updated_at": "2025-03-27T02:16:26.112347Z",
    "deleted_at": null,
    "sha1_hash": "84240384bb518f481baf8c48d8bc06fddd638821",
    "title": "2019-06-14 - Houdini Worm Transformed in New Phishing Attack",
    "authors": "",
    "file_creation_date": "2022-05-28T02:14:39Z",
    "file_modification_date": "2022-05-28T02:14:39Z",
    "file_size": 369513,
    "plain_text": "# Houdini Worm Transformed in New Phishing Attack\n\n**[cofense.com/houdini-worm-transformed-new-phishing-attack/](https://cofense.com/houdini-worm-transformed-new-phishing-attack/)**\n\nCofense June 14, 2019\n\n## Gateways Bypassed\n\n**Symantec**\n\nBy Nick Guarino and Aaron Riley\n\nThe [Cofense Phishing Defense Center™ (PDC) and](https://cofense.com/category/phishing_defense/) [Cofense Intelligence™ have identified](https://cofense.com/integrated-intelligence/)\na new variant of Houdini Worm targeting commercial banking customers with campaigns\ncontaining either URLs, .zip, or .mht files. This new variant is named WSH Remote Access\nTool (RAT) by the malware’s author and was released on June 2, 2019. Within five days,\nWSH RAT was observed being actively distributed via phishing. Figure 1 shows an example\nmessage from this campaign.\n\nHoudini Worm (HWorm) – a misleading name because it has more in common with a bot or\nRAT than a worm – has existed since at least 2013 and shares extreme similarities with what\nare undoubtedly its malignant siblings: njRAT and njWorm. This new iteration comes ported\nto JavaScript (JS) from HWorm’s original codebase of Visual Basic. WSH is likely a\nreference to the legitimate Windows Script Host, which is an application used to execute\nscripts on Windows machines.\n\n\n-----\n\nFigure 1: The phishing email delivering WSH RAT within an attachment\n\nThe email attachment contained an MHT file that are used by threat operators in the same\nway as HTML files. In this case, the MHT file contained an href link which when opened,\ndirected victims to a .zip archive containing a version of WSH RAT. Figure 2 shows the URL\nchain to the downloaded payload.\n\nFigure 2: The chain of URLs that lead to the .zip archive download\n\n\n-----\n\nWhen executed on an endpoint, WSH RAT behaves in the same way as Hworm, down to its\nuse of mangled Base64 encoded data. WSH RAT uses the same configuration structure that\nHworm uses for this process. Figure 3 shows the extracted configuration strings from the\nrunning memory of WSH RAT. It is interesting to note that the WSH RAT configuration is an\nexact copy of the Hworm’s configuration, even as far as not changing the name of the default\nvariables.\n\nFigure 3: The extracted configuration strings from the running memory of WSH RAT\n\nThe URL structure used by WSH Rat for its Command and Control (C2) communication is\nidentical to that employed by Hworm, as shown in Figure 4.\n\nFigure 4: The C2 callout made by WSH RAT\n\n\n-----\n\nAlso note the extreme similarity between the C2 communications shown in Figures 5 and 6.\nWSH RAT prepends the id “WSHRAT” to the User-Agent string and also changes the\ndelimiter from “<|>” to “|”, otherwise they are functionally identical.\n\nFigure 5: An example HTTP POST made by WSH RAT\n\nFigure 6: An example HTTP POST made by Hworm\n\nAfter the initial callout to the C2, this WSH RAT sample began calling out to another URL for\nthree separate payloads. Figure 7 shows the URL payload requests for the .tar.gz files.\n\nFigure 7: The network traffic showing the WSH RAT downloads\n\nThe downloaded files have the .tar.gz extension but are actually PE32 executable files. The\nthree downloaded executables were:\n\nA keylogger\nA mail credential viewer\nA browser credential viewer\n\nAll three of these modules are from third parties and are not original work from the WSH RAT\noperator. Figure 8 shows the programs running and the property information from the three\nexecutables downloaded by WSH RAT.\n\n\n-----\n\nFigure 8: The programs and details of the three downloaded executables\n\n**Getting Past the Email Gateway**\n\nWSH RAT is being sold for $50 USD a month and has an active marketing campaign. The\nthreat operators tout the RAT’s many features such as WinXP-Win10 compatibility, several\nautomatic startup methods, and a large variety of remote access, evasion, and stealing\ncapabilities as shown in Figure 9.\n\nFigure 9: WSH RAT’s marketing campaign\n\n\n-----\n\nThis re-hash of Hworm proves that threat operators are willing to re-use techniques that still\nwork in today’s IT environment. The phishing campaign that delivered the .zip containing a\nMHT file was able to bypass the Symantec Messaging Gateway’s virus and spam checks,\nshown in Figure 10, and make it to the endpoint.\n\n_Figure 10: Symantec Messaging Gateway checks made on the phishing email_\n\n**Cofense™ Can Help**\n\nThis threat exhibits the ease with which new malware can be developed, purchased, and\nweaponized. With a small investment in cheap command and control infrastructure and an\neasy-to-purchase malware-as-a-service, a threat actor with otherwise limited capabilities can\nknock on the door of a large financial company’s network in no time.\n\nLuckily, the [Cofense Phishing Defense Center was alerted to this phishing email and stifled it](https://cofense.com/product-services/phishing-defense-services/)\n[before any damage occurred. The customer uses Cofense PhishMeTM](https://cofense.com/product-services/phishme/) to help employees\n[identify phish and Cofense ReporterTM](https://cofense.com/product-services/reporter/) to notify security teams. It’s a combination that works\n—against plug and play threats and a whole lot more.\n\n\n**Appendix**\n\n**URL**\n\n**hxxp://elcisneblanco[.]com/tmp/banking/details/bank[.]php**\n\n**hxxp://futuroformacion[.]es/moodle/calendar/amd/BANK DETAILS**\n**CONFIRMATION_PDF[.]zip**\n\n**hxxp://doughnut-snack[.]live/klplu[.]tar[.]gz**\n\n**hxxp://doughnut-snack[.]live/bpvpl[.]tar[.]gz**\n\n**hxxp://doughnut-snack[.]live/mapv[.]tar[.]gz**\n\n**hxxp://www.tcoolsoul[.]com:1765/is-ready**\n\n**hxxp://brothersjoy[.]nl**\n\n**hxxp://savelifes[.]tech**\n\n**IP**\n\n\n-----\n\n**192[.]185[.]26[.]103**\n\n**192[.]185[.]163[.]240**\n\n**23[.]105[.]131[.]191**\n\n**23[.]105[.]131[.]225**\n\n**185[.]247[.]228[.]49**\n\n**MD5**\n\n**986ffeb04fa5e01dd03b38bdd379ab51**\n\n**266788057a7100afb9f123531b07282d**\n\n**5a2b62b657782f37eb0f7c27064cffa9**\n\n**977e42c09f7f98cfdcbf28ab2c460190**\n\n**7099a939fa30d939ccceb2f0597b19ed**\n\n**3a6b304e0a3dc91cac8892446826ffcc**\n\n**c4c6fe64765bc68c0d6fcaf2765b5319**\n\n_All third-party trademarks referenced by Cofense whether in logo form, name form or product_\n_form, or otherwise, remain the property of their respective holders, and use of these_\n_trademarks in no way indicates any relationship between Cofense and the holders of the_\n_trademarks._\n\nDon't miss out on any of our phishing updates! Subscribe to our blog.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2019/2019-06-14 - Houdini Worm Transformed in New Phishing Attack.pdf"
    ],
    "report_names": [
        "2019-06-14 - Houdini Worm Transformed in New Phishing Attack.pdf"
    ],
    "threat_actors": [
        {
            "id": "d90307b6-14a9-4d0b-9156-89e453d6eb13",
            "created_at": "2022-10-25T16:07:23.773944Z",
            "updated_at": "2025-03-27T02:02:09.974695Z",
            "deleted_at": null,
            "main_name": "Lead",
            "aliases": [
                "Casper",
                "TG-3279"
            ],
            "source_name": "ETDA:Lead",
            "tools": [
                "Agentemis",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "RbDoor",
                "RibDoor",
                "Winnti",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "99cb4e5b-8071-4f9e-aa1d-45bfbb6197e3",
            "created_at": "2023-01-06T13:46:38.860754Z",
            "updated_at": "2025-03-27T02:00:02.937438Z",
            "deleted_at": null,
            "main_name": "TA505",
            "aliases": [
                "SectorJ04 Group",
                "Dudear",
                "G0092",
                "ATK103",
                "Hive0065",
                "Spandex Tempest",
                "GRACEFUL SPIDER",
                "GOLD TAHOE",
                "CHIMBORAZO",
                "SectorJ04"
            ],
            "source_name": "MISPGALAXY:TA505",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "75d4d6a9-b5d1-4087-a7a0-e4a9587c45f4",
            "created_at": "2022-10-25T15:50:23.5188Z",
            "updated_at": "2025-03-27T02:00:55.489882Z",
            "deleted_at": null,
            "main_name": "TA505",
            "aliases": [
                "TA505",
                "Hive0065",
                "Spandex Tempest",
                "CHIMBORAZO"
            ],
            "source_name": "MITRE:TA505",
            "tools": [
                "AdFind",
                "Azorult",
                "FlawedAmmyy",
                "Mimikatz",
                "Dridex",
                "TrickBot",
                "Get2",
                "FlawedGrace",
                "Cobalt Strike",
                "ServHelper",
                "Amadey",
                "SDBbot",
                "PowerSploit"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "e447d393-c259-46e2-9932-19be2ba67149",
            "created_at": "2022-10-25T16:07:24.28282Z",
            "updated_at": "2025-03-27T02:02:10.159466Z",
            "deleted_at": null,
            "main_name": "TA505",
            "aliases": [
                "ATK 103",
                "Chimborazo",
                "Gold Evergreen",
                "Gold Tahoe",
                "Graceful Spider",
                "Hive0065",
                "Operation Tovar",
                "Operation Trident Breach",
                "SectorJ04",
                "Spandex Tempest",
                "TA505",
                "TEMP.Warlock"
            ],
            "source_name": "ETDA:TA505",
            "tools": [
                "Amadey",
                "AmmyyRAT",
                "AndroMut",
                "Azer",
                "Bart",
                "Bugat v5",
                "CryptFile2",
                "CryptoLocker",
                "CryptoMix",
                "CryptoShield",
                "Dridex",
                "Dudear",
                "EmailStealer",
                "FRIENDSPEAK",
                "Fake Globe",
                "Fareit",
                "FlawedAmmyy",
                "FlawedGrace",
                "FlowerPippi",
                "GOZ",
                "GameOver Zeus",
                "GazGolder",
                "Gelup",
                "Get2",
                "GetandGo",
                "GlobeImposter",
                "Gorhax",
                "GraceWire",
                "Gussdoor",
                "Jaff",
                "Kasidet",
                "Kegotip",
                "Kneber",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "Locky",
                "MINEBRIDGE",
                "MINEBRIDGE RAT",
                "MirrorBlast",
                "Neutrino Bot",
                "Neutrino Exploit Kit",
                "P2P Zeus",
                "Peer-to-Peer Zeus",
                "Philadelphia",
                "Philadephia Ransom",
                "Pony Loader",
                "Rakhni",
                "ReflectiveGnome",
                "Remote Manipulator System",
                "RockLoader",
                "RuRAT",
                "SDBbot",
                "ServHelper",
                "Shifu",
                "Siplog",
                "TeslaGun",
                "TiniMet",
                "TinyMet",
                "Trojan.Zbot",
                "Wsnpoem",
                "Zbot",
                "Zeta",
                "ZeuS",
                "Zeus"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "75108fc1-7f6a-450e-b024-10284f3f62bb",
            "created_at": "2024-11-01T02:00:52.756877Z",
            "updated_at": "2025-03-27T02:00:55.544216Z",
            "deleted_at": null,
            "main_name": "Play",
            "aliases": null,
            "source_name": "MITRE:Play",
            "tools": [
                "Nltest",
                "AdFind",
                "PsExec",
                "Wevtutil",
                "Cobalt Strike",
                "Playcrypt",
                "Mimikatz"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1673535752,
    "ts_updated_at": 1743041786,
    "ts_creation_date": 1653704079,
    "ts_modification_date": 1653704079,
    "files": {
        "pdf": "https://archive.orkl.eu/84240384bb518f481baf8c48d8bc06fddd638821.pdf",
        "text": "https://archive.orkl.eu/84240384bb518f481baf8c48d8bc06fddd638821.txt",
        "img": "https://archive.orkl.eu/84240384bb518f481baf8c48d8bc06fddd638821.jpg"
    }
}