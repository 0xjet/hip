{
    "id": "51b6bd9d-4bb1-49f1-813f-1fd765361212",
    "created_at": "2023-01-12T15:04:49.492584Z",
    "updated_at": "2025-03-27T02:17:24.730061Z",
    "deleted_at": null,
    "sha1_hash": "bb491c9d3a9db19f672d491687fa2ef05d88819b",
    "title": "2020-05-08 - Naikon’s Aria",
    "authors": "",
    "file_creation_date": "2022-05-28T02:04:35Z",
    "file_modification_date": "2022-05-28T02:04:35Z",
    "file_size": 273148,
    "plain_text": "# Naikon’s Aria\n\n**securelist.com/naikons-aria/96899/**\n\nAuthors\n\nGReAT\n\n[Our colleagues at Checkpoint put together a fine research writeup on some Naikon resources](https://research.checkpoint.com/2020/naikon-apt-cyber-espionage-reloaded/)\nand activity related to “aria-body” that we detected in 2017 and similarly reported in 2018. To\nsupplement their research findings, we are summarizing and publishing portions of the\nfindings reported in our June 2018 “Naikon’s New AR Backdoor Deployment to Southeast\nAsia”. This malware and activity aligns with much of what the Checkpoint researchers brought\nto light today.\n\n[The Naikon APT became well-known in May 2015, when our public reporting first mentioned](https://securelist.com/the-chronicles-of-the-hellsing-apt-the-empire-strikes-back/69567/)\nand then [fully described the group as a long running presence in the APAC region. Even](https://securelist.com/the-naikon-apt/69953/)\nwhen the group shutdown much of their successful offensive activity after years of\ncampaigns, Naikon maintained several splinter campaigns. Matching malware artifacts,\nfunctionality, and targeting demonstrates that the group continues to wage cyber-espionage\ncampaigns in the South China Sea region during 2018.\n\n\n-----\n\nAria-Body or AR is a set of backdoors that maintain compilation dates between January\n2017 and February 2018. It can be particularly difficult to detect, as much of this code\noperates in memory, injected by other loader components without touching disk. We trace\nportions of this codebase back to “xsFunction” exe and dll modules used in Naikon operations\ngoing back to 2012, as their compiled modules implement a subset of the xsFunction feature\nset. In all likelihood, this new backdoor and related activity is an extension of or merge with\nthe group’s “Paradir Operation”. In the past, the group targeted communications and sensitive\ninformation from executive and legislative offices, law enforcement, government\nadministrative, military and intelligence organizations within Southeast Asia. In many cases\nwe have seen that these systems also were targeted previously with PlugX and other\nmalware. So, the group has evolved bit since 2015, and their activity targeting these same\nprofiles continues into 2018. We identified at least a half dozen individual variants from 2017\nand 2018.\n\n## Technical Details\n\nIt seems clear that the same codebase has been reused by Naikon since at least 2012, and\nrecent AR backdoors were built from that same code. Their use was tightly clustered in\npreviously and heavily Naikon-targeted organizations, again lending confidence to clustering\nthese resources and activity with previous “Naikon”.\n\nNaikon’s new AR backdoor is a dll loaded into any one of multiple processes, providing\nremote access to a system. AR load attempts have been identified within processes with\nexecutable images listed here:\n\nc:\\windows\\system32\\svchost.exe\nc:\\windows\\syswow64\\svchost.exe\nc:\\program files\\windows nt\\accessories\\services.exe\nc:\\users\\dell\\appdata\\roaming\\microsoft\\windows\\start\nmenu\\programs\\startup\\acrobat.exe\nc:\\alphazawgyi\\svchost.exe\n\nBecause this AR code is injected into processes, the yara rule provided in the Appendix is\nbest run against memory dumps of processes maintaining a main image in the list above. The\nAR modules have additionally been seen in some others, including “msiexec.exe” processes.\n\nBelow are characteristics of the oldest AR and the newest known AR component in our\ncollection.\n\n\n-----\n\n**MD5** c766e55c48a4b2e7f83bfb8b6004fc51\n\n**SHA256** 357c8825b3f03414582715681e4e0316859b17e702a6d2c8ea9eb0fd467620a4\n\n**CompiledOn** Tue Jan 3 09:23:48 2017\n\n**Type** PE32 DLL\n\n\n**Internal**\n**name**\n\n\nTCPx86.dll\n\n\n**Size** 176kb\n\n**Exports** AzManager, DebugAzManager\n\n**MD5** 2ce4d68a120d76e703298f27073e1682\n\n**SHA256** 4cab6bf0b63cea04c4a44af1cf25e214771c4220ed48fff5fca834efa117e5db\n\n**CompiledOn** Thu Feb 22 10:04:02 2018\n\n**Type** PE32 DLL\n\n\n**Internal**\n**Name**\n\n\naria-body-dllX86.dll\n\n\n**Size** 204kb\n\n**Exports** AzManager, DebugAzManager\n\nWhen the dll is loaded, it registers a Windows class calling a specific Window procedure with\na removable drive check, a CONNECT proxied callback to its main C2, an IP location\nverification against checkip.amazonaws[.]com, and further communications with a C2. Some\nprevious modules’ flow may include more or less system information collection prior to the\ninitial callback.\n\nThe most recent version of the backdoor utilizes another Window procedure to implement a\nraw input device based keystroke collector. This keylogger functionality was newly introduced\nto the malware code in February 2018, and was not present in previous versions.\n\nThe approximately 200 – 250kb AR backdoor family provides a familiar and slightly changing\nfunctionality set per compiled module. Because Checkpoint covers the same technical points\nin their post, we provide this simple summary list:\n\nPersistence handling\nFile and directory handling\nKeylogging\nShell/Process Management\n\n\n-----\n\nNetwork activity and status listing and management\nSystem information collection and management\nDownload management\nWindows management\nExtension management\nLocation/IP verification\nNetwork Communications over HTTP\n\n## Similarities to past Naikon components\n\nNaikon components going back to 2012 maintain heavy similarities with the current “Ariabody” modules. Not only is some of the functionality only lightly modified, but the same\nmisspellings in error logging remains in their codebase. Let’s examine an older 2013 Naikon\nmodule and a newer 2017 Naikon AR module here.\n\nIt’s clear that the underlying codebase continues to be deployed:\n\n**e09254fa4398fccd607358b24b918b63, CompiledOn: 2013:09:10 09:00:15**\n\n**c766e55c48a4b2e7f83bfb8b6004fc51, CompiledOn: 2017:01:03 09:23:48**\n\nKudos to the Checkpoint researchers for providing new details of the Naikon story into the\npublic discussion.\n\nFor reference, some hashes and a YARA rule are provided here. More incident, infrastructure,\nIOCs, and details have been and are available to our threat intel customers (please, contact\n[intelreports@kaspersky.com).](http://10.10.0.46/mailto:intelreports@kaspersky.com)\n\n## Indicators of compromise\n\n**AR aria-body dll**\n\nc766e55c48a4b2e7f83bfb8b6004fc51\n\n2ce4d68a120d76e703298f27073e1682\n\n\n-----\n\n**Loaders and related Naikon malware**\n0ed1fa2720cdab23d969e60035f05d92\n3516960dd711b668783ada34286507b9\n\n**Verdicts – 2018 and Later**\nTrojan.Win32.Generic.gen\nTrojan.Win32.SEPEH.gen\nDangerousObject.Multi.Generic\nBackdoor.Win64.Agent.h*\nBackdoor.Win32.Agent.m*\nTrojan-Downloader.Win32.Agent.x*\n\n**YARA Rules**\n\n\n1\n\n2\n\n3\n\n4\n\n5\n\n6\n\n7\n\n8\n\n9\n\n10\n\n11\n\n12\n\n13\n\n14\n\n15\n\n16\n\n17\n\n18\n\n19\n\n\nrule apt_ZZ_Naikon_ARstrings : Naikon\n\n{\n\nmeta:\n\ncopyright = \"Kaspersky\"\n\ndescription = \"Rule to detect Naikon aria samples\"\n\nhash = \"2B4D3AD32C23BD492EA945EB8E59B758\"\n\ndate = \"2020-05-07\"\n\nversion = \"1.0\"\n\nstrings:\n\n$a1 = \"Terminate Process [PID=%d] succeeds!\" fullword wide\n\n$a2 = \"TerminateProcess [PID=%d] Failed:%d\" fullword wide\n\n$a3 = \"Close tcp connection returns: %d!\" fullword wide\n\n$a4 = \"Delete Directory [%s] returns:%d\" fullword wide\n\n$a5 = \"Delete Directory [%s] succeeds!\" fullword wide\n\n$a6 = \"Create Directory [%s] succeeds!\" fullword wide\n\n$a7 = \"SHFileOperation [%s] returns:%d\" fullword wide\n\n$a8 = \"SHFileOperation [%s] succeeds!\" fullword wide\n\n$a9 = \"Close tcp connection succeeds!\" fullword wide\n\n\n-----\n\n20\n\n21\n\n22\n\n23\n\n24\n\n25\n\n26\n\n27\n\n28\n\n29\n\n30\n\n31\n\n32\n\n33\n\n34\n\n35\n\n36\n\n\n$a10 OpenProcess [PID %d] Failed:%d fullword wide\n\n$a11 = \"ShellExecute [%s] returns:%d\" fullword wide\n\n$a12 = \"ShellExecute [%s] succeeds!\" fullword wide\n\n$a13 = \"FindFirstFile [%s] Error:%d\" fullword wide\n\n$a14 = \"Delete File [%s] succeeds!\" fullword wide\n\n$a15 = \"CreateFile [%s] Error:%d\" fullword wide\n\n$a16 = \"DebugAzManager\" fullword ascii\n\n$a17 = \"Create Directroy [%s] Failed:%d\" fullword wide\n\n$m1 = \"TCPx86.dll\" fullword wide ascii\n\n$m2 = \"aria-body\" nocase wide ascii\n\ncondition:\n\nuint16(0) == 0x5A4D and\n\nfilesize &lt; 450000 and\n\n(2 of ($a*) and 1 of ($m*))\n\n}\n\n\n-----\n\n1\n\n2\n\n3\n\n4\n\n5\n\n6\n\n7\n\n8\n\n9\n\n10\n\n11\n\n12\n\n13\n\n14\n\n15\n\n16\n\n17\n\n18\n\n19\n\n\nrule apt_ZZ_Naikon_codebase : Naikon\n\n{\n\nmeta:\n\nreport = \"Naikon New AR Backdoor Deployment to Southeast Asia\"\n\ndescription = \"Naikon typo\"\n\nauthor = \"Kaspersky\"\n\ncopyright = \"Kaspersky\"\n\nversion = \"1.0\"\n\ndate = \"2018-06-28\"\n\nlast_modified = \"2018-06-28\"\n\nstrings:\n\n$a1 = \"Create Directroy [%s] Failed:%d\" wide\n\ncondition:\n\nuint16(0) == 0x5A4D and\n\nfilesize &lt; 450000 and\n\n$a1\n\n}\n\n[APT](https://securelist.com/tag/apt/)\n[Backdoor](https://securelist.com/tag/backdoor/)\n[Cyber espionage](https://securelist.com/tag/cyber-espionage/)\n[Malware Technologies](https://securelist.com/tag/malware-technologies/)\n\n\nAuthors\n\n\nGReAT\n\n\n-----\n\nNaikon s Aria\n\nYour email address will not be published. Required fields are marked *\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2020/2020-05-08 - Naikon’s Aria.pdf"
    ],
    "report_names": [
        "2020-05-08 - Naikon’s Aria.pdf"
    ],
    "threat_actors": [
        {
            "id": "30ed778d-15b3-484e-a90b-e1e05b36a42f",
            "created_at": "2023-01-06T13:46:38.290626Z",
            "updated_at": "2025-03-27T02:00:02.795711Z",
            "deleted_at": null,
            "main_name": "APT30",
            "aliases": [
                "G0013"
            ],
            "source_name": "MISPGALAXY:APT30",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "78090a48-ca66-4cd8-a454-04d947e9c887",
            "created_at": "2023-01-06T13:46:38.303662Z",
            "updated_at": "2025-03-27T02:00:02.799805Z",
            "deleted_at": null,
            "main_name": "Hellsing",
            "aliases": [],
            "source_name": "MISPGALAXY:Hellsing",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "ad154227-6fcf-43c5-a540-0c09534e040f",
            "created_at": "2024-05-01T02:03:07.952927Z",
            "updated_at": "2025-03-27T02:05:17.267077Z",
            "deleted_at": null,
            "main_name": "BRONZE GENEVA",
            "aliases": [
                "BRONZE STERLING ",
                "CTG-5326 ",
                "Naikon ",
                "Override Panda ",
                "APT30 "
            ],
            "source_name": "Secureworks:BRONZE GENEVA",
            "tools": [
                " ShadowPad",
                "Lecna"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "a2912fc0-c34e-4e4b-82e9-665416c8fe32",
            "created_at": "2023-04-20T02:01:50.979595Z",
            "updated_at": "2025-03-27T02:00:02.79494Z",
            "deleted_at": null,
            "main_name": "Naikon",
            "aliases": [
                "BRONZE GENEVA",
                "G0019",
                "Naikon",
                "BRONZE STERLING",
                "G0013",
                "PLA Unit 78020",
                "OVERRIDE PANDA",
                "Camerashy"
            ],
            "source_name": "MISPGALAXY:Naikon",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "9f1ce7e3-77cd-4af0-bedb-1643f55c9baf",
            "created_at": "2022-10-25T15:50:23.31611Z",
            "updated_at": "2025-03-27T02:00:55.439974Z",
            "deleted_at": null,
            "main_name": "Naikon",
            "aliases": [
                "Naikon"
            ],
            "source_name": "MITRE:Naikon",
            "tools": [
                "ftp",
                "netsh",
                "WinMM",
                "Systeminfo",
                "RainyDay",
                "RARSTONE",
                "HDoor",
                "Sys10",
                "SslMM",
                "PsExec",
                "Tasklist",
                "Aria-body"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "b69484be-98d1-49e6-aed1-a28dbf65176a",
            "created_at": "2022-10-25T16:07:23.886782Z",
            "updated_at": "2025-03-27T02:02:10.014032Z",
            "deleted_at": null,
            "main_name": "Naikon",
            "aliases": [
                "Hellsing",
                "ITG06",
                "Lotus Panda",
                "Naikon",
                "Operation CameraShy"
            ],
            "source_name": "ETDA:Naikon",
            "tools": [
                "8.t Dropper",
                "8.t RTF exploit builder",
                "8t_dropper",
                "AR",
                "ARL",
                "Agent.dhwf",
                "Aria-body",
                "Aria-body loader",
                "Asset Reconnaissance Lighthouse",
                "BackBend",
                "Creamsicle",
                "Custom HDoor",
                "Destroy RAT",
                "DestroyRAT",
                "Flashflood",
                "FoundCore",
                "Gemcutter",
                "HDoor",
                "JadeRAT",
                "Kaba",
                "Korplug",
                "LOLBAS",
                "LOLBins",
                "LadonGo",
                "Lecna",
                "Living off the Land",
                "NBTscan",
                "Naikon",
                "NetEagle",
                "Neteagle_Scout",
                "NewCore RAT",
                "Orangeade",
                "PlugX",
                "Quarks PwDump",
                "RARSTONE",
                "RainyDay",
                "RedDelta",
                "RoyalRoad",
                "Sacto",
                "Sandboxie",
                "ScoutEagle",
                "Shipshape",
                "Sisfader",
                "Sisfader RAT",
                "Sogu",
                "SslMM",
                "Sys10",
                "TIGERPLUG",
                "TVT",
                "TeamViewer",
                "Thoper",
                "WinMM",
                "Xamtrav",
                "XsFunction",
                "ZRLnk",
                "nbtscan",
                "nokian",
                "norton",
                "xsControl",
                "xsPlus"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535889,
    "ts_updated_at": 1743041844,
    "ts_creation_date": 1653703475,
    "ts_modification_date": 1653703475,
    "files": {
        "pdf": "https://archive.orkl.eu/bb491c9d3a9db19f672d491687fa2ef05d88819b.pdf",
        "text": "https://archive.orkl.eu/bb491c9d3a9db19f672d491687fa2ef05d88819b.txt",
        "img": "https://archive.orkl.eu/bb491c9d3a9db19f672d491687fa2ef05d88819b.jpg"
    }
}