{
    "id": "2c6d3fb4-0710-450a-ba15-c1f3b60d9359",
    "created_at": "2023-01-12T15:09:00.747741Z",
    "updated_at": "2025-03-27T02:08:40.325043Z",
    "deleted_at": null,
    "sha1_hash": "f0bde36c163faa04a065f54bdc069ee03c033311",
    "title": "2019-12-14 - Another one for the collection - Mespinoza (Pysa) Ransomware",
    "authors": "",
    "file_creation_date": "2022-05-28T01:28:20Z",
    "file_modification_date": "2022-05-28T01:28:20Z",
    "file_size": 533740,
    "plain_text": "# Another one for the collection - Mespinoza (Pysa) Ransomware\n\n**[dissectingmalwa.re/another-one-for-the-collection-mespinoza-pysa-ransomware.html](https://dissectingmalwa.re/another-one-for-the-collection-mespinoza-pysa-ransomware.html)**\n\nSat 14 December 2019 in [Ransomware](https://dissectingmalwa.re/category/ransomware.html)\n\nBack in October of 2019 the Mespinoza Ransomware family first surfaced via Malspam. On\nthe 14th of December it returned with a new extension .pysa so let's see if any changes have\nbeen made.\n\nFun Fact: The Extension \"pysa\" is probably derived from the Zanzibari Coin with the same\nname. Apparently it's quite popular with collectors. But enough of the pocket change, so let\nme put my two cents in on this sample :D\n\n**_A general disclaimer as always: downloading and running the samples linked below_**\n**_will lead to the encryption of your personal data, so be f$cking careful. Also check_**\n**_with your local laws as owning malware binaries/ sources might be illegal depending_**\n**_on where you live._**\n\n[Mespinoza (.pysa) @ AnyRun |](https://app.any.run/tasks/858e7e0f-59c5-4f58-b426-1cef39a05cbc/) [VirusTotal |](https://www.virustotal.com/gui/file/a18c85399cd1ec3f1ec85cd66ff2e97a0dcf7ccb17ecf697a5376da8eda4d327/detection) [HybridAnalysis -->](https://www.hybrid-analysis.com/sample/a18c85399cd1ec3f1ec85cd66ff2e97a0dcf7ccb17ecf697a5376da8eda4d327) `sha256`\n```\na18c85399cd1ec3f1ec85cd66ff2e97a0dcf7ccb17ecf697a5376da8eda4d327\n\n```\nAs always: Running Detect it easy on the executable:\n\n\n-----\n\nOne of the first things it will do is modify the\n```\nSOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System Registry Key to set\n\n```\nthe following values. Unfortunately I couldn't confirm this action in a sandbox with RegShot\nyet.\n\nTo retain basic functions of the Operating System Mespinoza will spare certain directories\nrelated directly to Windows and critical files.\n\n\n-----\n\nIt will also specifically look for SQL related processes. I will have to confirm this with a\ndebugger, but most of the time database processes are killed by Ransomware to disrupt the\nservice and make the files available for encryption.\n\nOf course Mespinoza won't stop with the system drive so it will check for connected\nremovable media or shared network drives. GetDriveTypeW will tell it which type of media\nthe selected device belongs to.\n\n\n-----\n\nUp until now I have not seen a ransomware sample running verclsid.exe, so let's investigate:\n_{0B2C9183-C9FA-4C53-AE21-C900B0C39965} corresponds to_\nC:\\Windows\\system32\\SearchFolder.dll and {0C733A8A-2A1C-11CE-ADE5-00AA0044773D}\nmatches the CLSID of IDBProperties which is part of the Microsoft SQL Server.\n```\nC:\\Windows\\system32\\verclsid.exe\" /S /C {0B2C9183-C9FA-4C53-AE21-C900B0C39965} /I\n{0C733A8A-2A1C-11CE-ADE5-00AA0044773D} /X 0x401\n\n```\nAfter looking at a string dump I found this hex string which is probably the key blob. I'll try to\nverify this with x32dbg later.\n```\n30820220300D06092A864886F70D01010105000382020D003082020802820201009CC3A0141B5488CD31B7\n\n```\nTurns out that the encrypted key is appended to the end of each file affected by the\nransomware (which is a common tactic for some strains).\n\n\n-----\n\nAs this article is work in progress I will update it as soon as I can. As I did not see the\nMalware deleting the Volume Shadow Copies until now, so one option for possible victims\n[would be to run Photorec or](https://www.cgsecurity.org/wiki/PhotoRec) [Recuva to check for recoverable files.](https://www.ccleaner.com/recuva)\n\n## Update 22.01.2020:\n\nThere's a new version of the Mespinoza / .pysa Variant compiled on the 18th of JaÅ„uary:\n\n[Mespinoza (.pysa) @ AnyRun -->](https://app.any.run/tasks/858e7e0f-59c5-4f58-b426-1cef39a05cbc/) ``sha256`\n```\ne9662b468135f758a9487a1be50159ef57f3050b753de2915763b4ed78839ead\n\n```\nIn the screenshot below you can see a comparison of the old sample (1.exe) and the new\none (1.bin). Exept for a few minor changes the two samples are mostly identical:\n\n\n-----\n\nThe public Key used by the criminals is still the same (converted from hex to raw, key blob\nlocated in the binary):\n```\nMIICIDANBgkqhkiG9w0BAQEFAAOCAg0AMIICCAKCAgEA6dYN+TogNihncAJNXRhtUeyj7EQ/BIGbupIM\nq5PRI3a1+HqMXEk5vdb3NhzFBUoVhY/jTEE71flTwHM73q9PrgovaYSl8HeXZaU+HkqjF7Ofu4Qf+SDk\noPxcubX4cFYV1r97z9vcFgFehzk+9CofEnHWEo2N656QGRXeO0PaJX/riiL672KHzMDNKzfZQnmpMHL+\nKzeyJaaPVVz7V9qCCkjT+IT26xtG2jY5tggepfLQfB6ExxaoJ1j0GapQMIZ3k6F1AtBmfcNvyu3cW29a\nbIOCsu1QRzfq6iSau2xx0ZaRz0l3vgU79PCLtsGw7BNPtKZdDL9dA879aKWlDBIizc3lg4IpHxdf5MOT\nmpQR0kst3kyOieNlIjEAyewyRQ788o3qs8k9SS+89CD916AMEVqRcQH8ugBv5ocs0xAf+2bHe13ogIRc\niTz9ALTvtMSqhNptEBP/z+lIhuMTs2MrJRTaQLpVHUIlqAcQuLm8AHIYdGmBXEvUqPjRIo+L9Jb+P1XU\ncXYHvOZUBV0VFSOoyQeqiBeaYS+PhCV6TmTRHsH/8XkPt/eGXm3Dk4feYNaZ5a9uQKYc9Akt6G0N+P8T\n7zobyAWfQNqGFJhklh6JEAJw58XCJNdmETT68kfwtQ+XFB4caUHessaJ369lprAj4TjDUFfYkkm74ntG\n4nVtL+sCARE===\n\n```\nThe Ransomnote contents stayed the same, exept for the contact email addresses. Here are\nthe contents of Readme.README:\n\n\n-----\n\n```\nHi Company,\nEvery byte on any types of your devices was encrypted.\nDon't try to use backups because it were encrypted too.\nTo get all your data back contact us:\nraingemaximo@protonmail.com\ngareth.mckie3l@protonmail.com\n-------------FAQ:\n1.\n  Q: How can I make sure you don't fooling me?\n  A: You can send us 2 files(max 2mb).\n2.\n  Q: What to do to get all data back?\n  A: Don't restart the computer, don't move files and write us.\n3.\n  Q: What to tell my boss?\n  A: Protect Your System Amigo.\n\n## MITRE ATT&CK\n\n```\n_T1215 --> Kernel Modules and Extensions --> Persistence_\n\n_T1045 --> Software Packing --> Defense Evasion_\n\n_T1012 --> Query Registry --> Discovery_\n\n_T1114 --> Email Collection --> Collection_\n\n## IOCs\n\n### Mespinoza (pysa)\n```\n1.exe --> SHA256: a18c85399cd1ec3f1ec85cd66ff2e97a0dcf7ccb17ecf697a5376da8eda4d327\n     SSDEEP: 12288:aVchT6oi+OeO+OeNhBBhhBBpiOTn5CjGGc4dXOsOjKf:aVc1Jiin5yGpMIj\nFile size: 504.50 KB\n\n Associated Files\nReadme.README\n%temp%\\update.bat\n\n E-Mail Addresses\n\n```\n\n-----\n\n```\naireyeric@protonmail[.]com\nellershaw.kiley@protonmail[.]com\nUsed in previous campaigns:\nmespinoza980@protonmail[.]com\nalanson_street8@protonmail[.]com\nlambchristoffer@protonmail[.]com\n\n### Ransomnote\nHi Company,\nEvery byte on any types of your devices was encrypted.\nDon't try to use backups because it were encrypted too.\nTo get all your data back contact us:\naireyeric@protonmail.com\nellershaw.kiley@protonmail.com\n-------------FAQ:\n1.\n  Q: How can I make sure you don't fooling me?\n  A: You can send us 2 files(max 2mb).\n2.\n  Q: What to do to get all data back?\n  A: Don't restart the computer, don't move files and write us.\n3.\n  Q: What to tell my boss?\n  A: Protect Your System Amigo.\n\n```\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2019/2019-12-14 - Another one for the collection - Mespinoza (Pysa) Ransomware.pdf"
    ],
    "report_names": [
        "2019-12-14 - Another one for the collection - Mespinoza (Pysa) Ransomware.pdf"
    ],
    "threat_actors": [
        {
            "id": "d90307b6-14a9-4d0b-9156-89e453d6eb13",
            "created_at": "2022-10-25T16:07:23.773944Z",
            "updated_at": "2025-03-27T02:02:09.974695Z",
            "deleted_at": null,
            "main_name": "Lead",
            "aliases": [
                "Casper",
                "TG-3279"
            ],
            "source_name": "ETDA:Lead",
            "tools": [
                "Agentemis",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "RbDoor",
                "RibDoor",
                "Winnti",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673536140,
    "ts_updated_at": 1743041320,
    "ts_creation_date": 1653701300,
    "ts_modification_date": 1653701300,
    "files": {
        "pdf": "https://archive.orkl.eu/f0bde36c163faa04a065f54bdc069ee03c033311.pdf",
        "text": "https://archive.orkl.eu/f0bde36c163faa04a065f54bdc069ee03c033311.txt",
        "img": "https://archive.orkl.eu/f0bde36c163faa04a065f54bdc069ee03c033311.jpg"
    }
}