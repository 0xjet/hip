{
    "id": "5293d06a-8a1b-4fac-beaf-bf188f01f230",
    "created_at": "2023-01-12T15:07:54.898314Z",
    "updated_at": "2025-03-27T02:06:03.687902Z",
    "deleted_at": null,
    "sha1_hash": "c4ece3c200b053405ac96f35db0ec7bac06c7d24",
    "title": "2022-05-31 - XLoader Botnet- Find Me If You Can",
    "authors": "",
    "file_creation_date": "2022-06-01T12:26:12Z",
    "file_modification_date": "2022-06-01T12:26:12Z",
    "file_size": 1046786,
    "plain_text": "# XLoader Botnet: Find Me If You Can\n\n**research.checkpoint.com/2022/xloader-botnet-find-me-if-you-can/**\n\nMay 31, 2022\n_Research by: Alexey Bukhteyev & Raman Ladutska_\n\n## Introduction\n\n\nMay 31, 2022\n\n\nIn July 2021, CPR released a series of three publications covering different aspects of how the Formbook\n[and XLoader malware families function. We described how XLoader emerged in the Darknet community to](https://research.checkpoint.com/2021/top-prevalent-malware-with-a-thousand-campaigns-migrates-to-macos/)\nfill the empty niche after Formbook sales were abruptly stopped by its author. We did a deep technical\n[analysis followed by a description of XLoader for macOS along with common points and differences in how](https://research.checkpoint.com/2021/time-proven-tricks-in-a-new-environment-the-macos-evolution-of-formbook/)\nboth malware families conceal the heart of the whole operation, the Command-and-Control (C&C)\ninfrastructure. However, the world does not stand still, and this applies to the malware cyber-world as well.\n\nA couple of months after our publications were released, we spotted a new XLoader version in-the-wild\nwhich was an upgrade of all the ones we described previously. The enhanced version features significant\nmodifications in key parts of the malware logic to truly deserve the differentiation if compared with\nXLoader’s previous implementation.\n\nIn this article, we describe the changes malware authors applied to XLoader to obscure the C&C\ninfrastructure – more than anything we saw before. Now it is significantly harder to separate the wheat from\nthe chaff and discover the real C&C servers among thousands of legitimate domains used by Xloader as a\nsmokescreen. We explain how we got to the essence and identified the real C&C nodes in the evolving\nbotnet.\n\n\n-----\n\n## Deep technical dive\n\nThe Formbook malware has not been updated for quite a long time. The latest version of this stealer is 4.1,\nand we already observed samples of this version in far 2020. This gives us reason to believe that\nFormbook has been discontinued.\n\nAt the same time, XLoader, Formbook’s successor which we described last year, has already received 2\nupdates since our publication. In this article, we describe the most important changes that we found in\nXLoader version 2.5.\n\n## Camouflaging real C&C servers – methods used in 2021\n\nAll XLoader samples have 64 domains and one URI in their configurations. The XLoader configuration has\nthe same structure as the Formbook configuration. In earlier versions Formbook used the URI stored\nseparately in the configuration to access its C&C server. The 64 domains from the malware configuration\nare actually decoys, intended to distract the researchers’ attention.\n\nIn Formbook version 4.1, the malware developers added another level of stealth which also migrated to\nearly versions of XLoader (up to 2.5). A domain name for the real C&C server was hidden among the 64\ndecoys, while the URI that was always thought to be an address of the C&C server became another decoy\nand could point to a legitimate website. The malware of versions mentioned above randomly choose 16\ndecoy domains, two of which are replaced with the fake C&C server address and a real C&C server\naddress. The real C&C server is accessed after a long delay.\n\n_Figure 1 – Creating a list of domains for C&C communication in XLoader 2.3 and Formbook 4.1._\n\nThis already looks complicated. However, the newer version introduced an even more sophisticated\nalgorithm.\n\n## New version – a new level of protection\n\nThe first samples of the new version of XLoader appeared in-the-wild a month after our publications in\nAugust 2021, [Revealing the XLoader’s C&C infrastructure. At first glance, we didn’t see any difference](https://research.checkpoint.com/2021/stealth-is-never-enough-or-revealing-formbook-successors-cc-infrastructure/)\nbecause the configuration structure remained exactly the same.\n\n\n-----\n\nHowever, when emulating samples in a sandbox, we noticed a change. With a long emulation time, the\nsample accessed more than 16 domains, unlike earlier versions. This behavior forced us to put aside\nautomated analysis tools and arm ourselves with a disassembler. We soon discovered the part of the code\nresponsible for the detected anomaly. As in the previous versions, XLoader first creates a list of 16\ndomains that are randomly selected from the 64 domains stored in the configuration. After each attempt to\naccess the selected 16 domains, the following code is executed:\n\n_Figure 2 – XLoader 2.5 overwrites the first 8 domains before each communication cycle._\n\nThe purpose of this piece of code is to partially overwrite the list of accessed domains with new random\nvalues. Therefore, if XLoader runs long enough, it will access new randomly selected domains. It’s\nimportant to pay attention to the fact that only the first 8 values are overwritten, and the remaining 8 remain\nthe same as those that were selected immediately after launch.\n\nIn addition, XLoader, as we thought, saves the index of its C&C server and does not allow it to be\noverwritten:\n\n_Figure 3 – XLoader doesn’t overwrite the C&C domain index._\n\nHowever, while checking hosts that were supposed to be XLoader C&C servers, it turned out that many of\nthem did not respond or else looked to be legitimate, such as this one:\n\n\n-----\n\n_Figure 4 – Fake C&C domain points to a likely legitimate site._\n\nAlso, most of them appear only once in various configurations, making them the underdogs in our\npreliminary bet for the real C&C candidates. From our previous research, we remembered that the number\nof real C&C servers was relatively small (we found less than 100 C&C servers among 90,000 domains\nused by the malware), and they were reused in many of the campaigns of different XLoader customers.\n\nIn this case, we also found many domains that appear multiple times in samples that belong to different\ncampaigns. However, these domains belong to the list of decoys and do not stand out at first glance. Let’s\nlook at the websites pointed to by some of these domains. The root page looks like a parked domain page\nof famous domain registrars and hosting service providers (usually Hostinger and Namecheap):\n\n_Figure 5 – Real C&C servers disguised as Hostinger and Namecheap parked domain pages._\n\nHowever, if we check the source code of the page and compare it with the original page generated by the\nservice provider, we see many differences:\n\n\n-----\n\n_Figure 6 – Differences in the fake (on the left side) and the real (on the right side) Namecheap parked_\n_domain page._\n\nIn the fake Hostinger page, we also see some visual differences:\n\n_Figure 7 – Visual differences in the fake (on the left side) and the real (on the right side) Hostinger parked_\n_domain page._\n\nWe then collected IP addresses of all presumably malicious hosts and root pages from the corresponding\nwebsites. It appeared that all the domains point to a few IP address ranges, all of which belong to\nNamecheap. Some domains point to the same IP addresses.\n\n**Domain** **IP** **Root Page MD5 hash** **Description**\n\n**bubu3cin.com** 162.0.214.189 ce866938b246a89fd98fc6a6f666d21c Fake Hostinger\n\n**highpacts.com** 162.0.216.5 ce866938b246a89fd98fc6a6f666d21c Fake Hostinger\n\n**hype-clicks.com** 162.0.223.146 f891f22cd94c80844fcfe6fddb4b7912 Fake Namecheap\n\n**moukse.com** 162.0.223.146 f891f22cd94c80844fcfe6fddb4b7912 Fake Namecheap\n\n\n-----\n\n**besasin09.com** 162.0.223.94 8d85df16ced80502c796649e4c806d31 Future home of…\n\n**brasbux.com** 162.0.223.94 8d85df16ced80502c796649e4c806d31 Future home of…\n\n**finsits.com** 162.0.225.82 ce866938b246a89fd98fc6a6f666d21c Fake Hostinger\n\n**arabatas.com** 162.0.225.82 ce866938b246a89fd98fc6a6f666d21c Fake Hostinger\n\n**ocvcoins.com** 162.0.238.238 ce866938b246a89fd98fc6a6f666d21c Fake Hostinger\n\n**gingure.com** 162.0.238.238 ce866938b246a89fd98fc6a6f666d21c Fake Hostinger\n\n**coalmanses.com** 162.213.253.206 ce866938b246a89fd98fc6a6f666d21c Fake Hostinger\n\n**fendoremi.com** 162.213.253.206 ce866938b246a89fd98fc6a6f666d21c Fake Hostinger\n\n**noun-bug.com** 199.188.206.146 f891f22cd94c80844fcfe6fddb4b7912 Fake Namecheap\n\n**cobere9.com** 199.188.206.146 f891f22cd94c80844fcfe6fddb4b7912 Fake Namecheap\n\n**…**\n\n_Table 1 – XLoader domains and IP addresses to which they point._\n\nAll the websites display pages that appear to be “under construction”, primarily the fake Namecheap or\nHostinger parked domain page, even though all the IP addresses belong to Namecheap.\n\nIt looks like we found the C&C servers, but is it possible to distinguish them in the list of 64 decoy domains\nin the malware configuration?\n\nLet’s now look at the function that fills the initial list of 16 domains in XLoader 2.5 and compare it with the\nfunction from XLoader 2.3:\n\n_Figure 8 – XLoader 2.5 replaces three domains in the created list with 2 decoys and the real C&C server_\n_domain._\n\nAs we can see, XLoader 2.5 introduced an additional code that replaces one more domain in the list with a\nfixed value. Interestingly, this value doesn’t appear anywhere else in the code and is not saved; its position\nin the list of 16 domains is chosen randomly.\n\n\n-----\n\nAs the first 8 domains are overwritten with new values after the first hit, there is a 50% chance that this\ndomain will be overwritten. However, we think that this is the domain which points to the real C&C server.\n\nThe domain selection scheme is as follows:\n\n_Figure 9 – Creating a list of domains for C&C communication in XLoader 2.5._\n\nIf the real C&C domain appears in the second part of the list, it is accessed in every cycle once in\napproximately 80-90 seconds. If it appears in the first part of the list, it will be overwritten by another\nrandom domain name.\n\nHowever, there is still a probability that this domain will appear in the list again. This is possible because\nthe 8 domains that overwrite the first part of the list are chosen randomly, and the real C&C domain might\nbe one of them. In this case, the probability that a real C&C server will be accessed in the next cycle is 7/64\nor 1/8 depending on the position of the “fake c2 (2)” domain (see Figure 9 above).\n\nThe malware authors once again proved their high technical skills and out-of-the-box approach. By\nimplementing the Law of Large Numbers in the malware, they achieved two goals: not only did they\ndisguise the real C&C servers in common sandbox emulations (which are usually short), but also kept up\nthe effectiveness of the malware.\n\nIn the table below we provide the probabilities of the real C&C server not being accessed again within a\ngiven time-frame. We take into consideration the lowest possible probability for the server to appear in any\ngiven cycle, which is 7/64, as well as the longest possible pause between two cycles, which is 90 seconds.\n\n**Time passed** **Probability of the real C&C server being not accessed** **Notes**\n\n9 minutes 50% Like a coin toss\n\n15 minutes 31% Less than 1 in 3\n\n18 minutes 25% 1 in 4\n\n30 minutes 10% 1 in 10\n\n1 hour 1% 1 in 100\n\n\n-----\n\n2 hours 0.09% Less than 1 in 10,000\n\n2.5 hours 0.0009% Less than 1 in 1,000,000\n\nWe see from the table that out of one million launches, only in one case the malware might not access the\nreal C&C server in a period of 2.5 hours. In reality, the probability of such an event is even lower as a cycle\ntime period can vary between 80 and 90 seconds, and the probability of the real C&C server to show up in\na cycle may be higher and equal to 1/8.\n\nEven 9 minutes are enough to fool the emulators and prevent the detection of the real C&C server, based\non the delays between accesses to the domains. At the same time, the regular knockback period\nmaintained by the malware with the help of probability theory allows it to keep victims as botnet parts\nwithout sacrificing the functionality.\n\n## XLoader 2.6\n\nOn May 5, 2022, we spotted a new version of XLoader malware in-the-wild. The main update in XLoader\nv2.6 concerns the network communication. The random index of the real C&C server is now saved in the\nmalware state structure:\n\n_Figure 10 – XLoader 2.6 generates and stores the index of a real C&C server._\n\nDuring each communication cycle, when the malware overwrites the first 8 entries in the list of accessed\ndomains, it keeps the values for the real and the fake C&C domains:\n\n_Figure 11 – XLoader 2.6 doesn’t overwrite the fake and the C&C domain indices._\n\nTherefore, the real C&C server is now accessed in every communication cycle, or once in approximately\n80-90 seconds.\n\nHowever, this logic is activated only when the malware runs in an x64 system. When it runs in an x86\nsystem, the variable real_c2_index stores the same value as is stored in the fake_c2_index. This results\nin the real C&C server being accessed with the same probability as any of the 63 decoys while running in\nx86 system. This looks like an evasion technique, as currently a lot of sandboxes still use x86 virtual\nmachines.\n\n## Conclusion\n\nTo stay in business, malware actors have to stay in the forefront of progress and invent new tricks to\nprolong the lives of their creations as long as possible. In the case of XLoader malware, we see a vivid\nexample of such a process.\n\n\n-----\n\nIn July 2021, we described the method of uncovering real C&C servers among the thousands of legitimate\nservers abused by XLoader v.2.3. The upgraded XLoader v.2.5 introduced significant changes in this\nalgorithm using the power of the Law of Big Numbers from probability theory. These modifications achieve\ntwo goals at once: each node in the botnet maintains a steady knockback rate while fooling automated\nscripts and preventing the discovery of the real C&C servers. The latter indeed became more difficult, but\nnot impossible.\n\nIn this article we described all the steps you need to take, and all the details you need to pay attention to in\norder to identify the real C&C domain among the 65 encountered in every XLoader sample. We analyzed\nmore than 100,000 domains to discover a tiny percentage of actual C&C servers in the multitude of abused\ndomains – only 120 of the real servers, which is about 0.12% of the total number.\n\nWe continue to stay vigilant for any upcoming changes that might be implemented by future versions, not\nonly in XLoader but in other malware families as well.\n\n## Check Point Protections\n\n[Check Point Provides Zero-Day Protection across Its Network, Cloud, Users and Access Security](https://www.checkpoint.com/infinity-vision/zero-day-protection/)\nSolutions. Whether you’re in the cloud, the data center, or both, Check Point’s Network Security solutions\nsimplify your security without impacting network performance, provide a unified approach for streamlined\n[operations, and enable you to scale for continued business growth. Quantum provides the best zero-day](https://www.checkpoint.com/quantum/network-security-solutions/)\nprotection while reducing security overhead.\n\nSandBlast Network Protections:\n```\n     Trojan.WIN32.Formbook.A\n     Trojan.WIN32.Formbook.B\n     Trojan.WIN32.Formbook.C\n     Trojan.WIN32.Formbook.D\n     Trojan.WIN32.Formbook.E\n     Trojan.WIN32.Formbook.F\n     Trojan.WIN32.Formbook.G\n     Trojan.WIN32.Formbook.H\n     Trojan.WIN32.Formbook.I\n     Trojan.WIN32.Formbook.J\n     Trojan.WIN32.Formbook.K\n     Trojan.WIN32.Formbook.L\n     Trojan.WIN32.Formbook.M\n     Trojan.WIN32.Formbook.N\n     Trojan.WIN32.Formbook.O\n     Trojan.WIN32.Formbook.P\n     Trojan.WIN32.Formbook.Q\n     Trojan.WIN32.Formbook.R\n\n```\nThreat Emulation protections:\n```\n     Infostealer.Win32.Formbook.C\n     Infostealer.Win32.Formbook.D\n     Infostealer.Win32.Formbook.E\n     Infostealer.Win32.Formbook.gl.F\n     Infostealer.Win32.Formbook.TC\n     Formbook.TC\n     Infostealer.Win32.XLoader.TC\n     XLoader.TC\n     Trojan.Mac.XLoader.B\n\n```\n\n-----\n\n## Appendix: Indicators of Compromise\n\n### XLoader samples\n\n**SHA256** **Version** **C&C domain**\n\nc3bf0677dfcb32b35defb6650e1f81ccfa2080e934af6ef926fd378091a25fdb 2.6 travelsagas.com\n\n77ed8c0589576ecaf87167bc9e178b15da57f7b341ea2fda624ecc5874b1464b 2.6 clicktokens.com\n\n041992cc47137cb45d4e93658be392bb82cdc7ec53f959c6af4761d41dfc9160 2.6 motarasag.com\n\ne704bc09c7da872b5d430d641e9bd7c8c396cf79ea382870e138f88d166df4a8 2.6 tumpiums.com\n\na7023d5b16691b20334955294a80c10d435e24048f6416d1b3af3c58d0b48954 2.5 sasanos.com\n\n862fba20ce7613356018ca44f665819522f862f040b34410a58892229aba6d9c 2.5 binbin-ads.com\n\nd56e8522cf147e2b964a5a03e51a17d24d4cb3a4a20f36ef3fd3caeda0b105f3 2.5 range4tis.com\n\n59048fa3b523121866f79a8a2f7a3c9c7cf609a98be5a1ec296030de2353d559 2.5 cablinqee.com\n\n### XLoader C&C servers\n\n**Domain** **IP**\n\nbesasin09.com 162.0.223.94\n\nbrasbux.com 162.0.223.94\n\nmunixc.info 162.0.223.94\n\nceser33.com 162.0.223.94\n\nducer.info 199.192.23.209\n\namenosu.com 199.192.23.209\n\nsanfireman.info 199.192.23.209\n\ntrc-clicks.com 199.192.25.68\n\nbantasis.com 199.192.25.68\n\nbrass-tip.info 199.192.25.68\n\nneurosise.com 199.192.30.112\n\nfinsith.com 199.192.30.112\n\ngate334.com 199.192.30.112\n\nseo-clicks6.com 199.192.30.247\n\ntangodo9.info 199.192.31.5\n\n\n-----\n\nnu865ci.com 199.192.31.5\n\nrapibest.com 199.192.31.5\n\nrecbi56ni.com 199.192.31.5\n\nheinousas.com 66.29.143.39\n\npordges.com 66.29.143.39\n\nserenistin.com 66.29.143.39\n\naminsfy.com 66.29.155.250\n\ndempius.com 66.29.155.250\n\nbuge-link.com 66.29.155.250\n\nnorllix.com 66.29.155.250\n\nsacremots.com 66.29.155.250\n\nbeputis4.com 68.65.121.46\n\nbubu3cin.com 162.0.214.189\n\nhighpacts.com 162.0.216.5\n\nfinsits.com 162.0.225.82\n\narabatas.com 162.0.225.82\n\ncutos2.com 162.0.225.82\n\nnropes.com 162.0.233.84\n\ngogoma3.com 162.0.233.84\n\nfraiuhs.com 162.0.233.84\n\nbusipe6.com 162.0.238.116\n\nbupis44.info 162.0.238.116\n\ngesips.com 162.0.238.116\n\nocvcoins.com 162.0.238.238\n\ngingure.com 162.0.238.238\n\nnifaji.com 162.0.238.238\n\ncoalmanses.com 162.213.253.206\n\nfendoremi.com 162.213.253.206\n\ncusio3c.com 162.213.253.206\n\nnutri6si.com 162.213.253.206\n\n\n-----\n\nbreskizci.com 192.64.116.180\n\nhigh-clicks.com 192.64.116.180\n\ngunnipes.com 199.192.23.164\n\ndugerits.com 199.192.23.164\n\nkeepitng.com 199.192.23.164\n\nfellasies.com 199.192.28.149\n\nbutuns.com 199.192.28.149\n\nbendisle.com 66.29.155.108\n\nci-ohio.com 66.29.155.108\n\nminimi36.com 66.29.155.108\n\npedorc.com 68.65.121.125\n\ncures8t.com 68.65.121.125\n\nmecitiris.com 162.0.222.70\n\nhigh-clicks2.com 162.0.224.219\n\nnerosbin.info 162.0.231.105\n\nb8ceex.com 162.0.231.105\n\ndashmints.com 162.0.231.244\n\nrap8b55d.com 198.54.112.103\n\nrastipponmkh.com 199.192.17.24\n\nblendeqes.com 199.192.17.24\n\nprivate-clicks.com 199.192.26.170\n\nabros88.com 199.192.30.127\n\nbracunis.com 199.192.30.127\n\nhugefries3.com 199.192.30.127\n\nsaint444.com 63.250.44.164\n\nbra866.com 66.29.130.171\n\nhype-clicks.com 162.0.223.146\n\nmoukse.com 162.0.223.146\n\nammarus.com 162.0.223.146\n\ncablinqee.com 162.0.223.146\n\n\n-----\n\nfuntabse.com 162.0.223.146\n\ngulebic.com 162.0.223.146\n\ncatdanos.com 199.188.206.146\n\nnoun-bug.com 199.188.206.146\n\ncobere9.com 199.188.206.146\n\nranbix.com 199.188.206.146\n\ntes5ci.com 199.188.206.146\n\nblackbait6.com 199.188.206.146\n\nmimihin.com 199.192.18.217\n\ncesiesis.com 199.192.18.217\n\nmoreosin.com 199.192.18.217\n\nside-clicks.com 199.192.29.43\n\ndavinci65.info 199.192.29.43\n\nplick-click.com 199.192.29.43\n\nredandseven.com 199.192.29.61\n\nberdisen.com 199.192.29.61\n\narches2.com 199.192.29.61\n\nprice-hype.com 199.192.30.202\n\nbecbares.com 199.192.30.202\n\nbudistx.com 199.192.30.202\n\ndain6544.com 199.192.30.202\n\nerisibu85.com 199.192.30.202\n\npiecebin.com 66.29.133.181\n\nprobinns.com 66.29.133.181\n\nbumabagi.com 66.29.133.181\n\nhughers3.com 66.29.133.181\n\nn4sins.com 66.29.133.181\n\nbusy-clicks.com 66.29.140.185\n\nminismi2.com 66.29.140.185\n\nwecuxs.com 66.29.140.185\n\n\n-----\n\nlopsrental.lease 66.29.140.185\n\nalpeshpate.com 66.29.142.52\n\nmotometics.com 66.29.142.52\n\ncinasing.com 66.29.142.52\n\ngamusemenu.com 66.29.142.52\n\nkraines3.com 66.29.142.52\n\nban-click.com 66.29.145.216\n\nbutsins.com 66.29.145.216\n\nearches3.com 66.29.145.216\n\njervinse.com 66.29.154.112\n\ngimbases.com 66.29.154.112\n\nmotarase.com 66.29.154.112\n\ncusmose.com 66.29.154.157\n\nbecu84ts.com 66.29.154.157\n\nburesdx.com 66.29.154.157\n\ntravelsagas.com 162.0.216.71\n\nclick-tokens.com 66.29.142.85\n\nmotarasag.com 162.0.233.154\n\ntumpiums.com 66.29.155.51\n\nsasanos.com 45.132.241.87\n\nbinbin-ads.com 31.220.18.33\n\nrange4tis.com 45.15.25.154\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-05-31 - XLoader Botnet- Find Me If You Can.pdf"
    ],
    "report_names": [
        "2022-05-31 - XLoader Botnet- Find Me If You Can.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673536074,
    "ts_updated_at": 1743041163,
    "ts_creation_date": 1654086372,
    "ts_modification_date": 1654086372,
    "files": {
        "pdf": "https://archive.orkl.eu/c4ece3c200b053405ac96f35db0ec7bac06c7d24.pdf",
        "text": "https://archive.orkl.eu/c4ece3c200b053405ac96f35db0ec7bac06c7d24.txt",
        "img": "https://archive.orkl.eu/c4ece3c200b053405ac96f35db0ec7bac06c7d24.jpg"
    }
}