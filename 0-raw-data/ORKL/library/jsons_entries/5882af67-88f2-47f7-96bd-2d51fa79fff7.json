{
    "id": "5882af67-88f2-47f7-96bd-2d51fa79fff7",
    "created_at": "2023-01-12T15:07:42.182884Z",
    "updated_at": "2025-03-27T02:15:26.123906Z",
    "deleted_at": null,
    "sha1_hash": "fd0b31a6b2cbd7b95f52105f9cdf51c6ffac7aac",
    "title": "2017-06-22 - Locky Ransomware Returns, but Targets Only Windows XP & Vista",
    "authors": "",
    "file_creation_date": "2022-05-27T22:38:51Z",
    "file_modification_date": "2022-05-27T22:38:51Z",
    "file_size": 275054,
    "plain_text": "# Locky Ransomware Returns, but Targets Only Windows XP & Vista\n\n**[bleepingcomputer.com/news/security/locky-ransomware-returns-but-targets-only-windows-xp-and-vista/](https://www.bleepingcomputer.com/news/security/locky-ransomware-returns-but-targets-only-windows-xp-and-vista/)**\n\nCatalin Cimpanu\n\nBy\n[Catalin Cimpanu](https://www.bleepingcomputer.com/author/catalin-cimpanu/)\n\nJune 22, 2017\n03:48 AM\n1\n\nThe Locky ransomware is back, spreading via a massive wave of spam emails distributed\nby the Necurs botnet, but the campaign appears to be a half-baked effort because the\nransomware is not able to encrypt files on modern Windows OS versions, locking files only\non older Windows XP & Vista machines.\n\nLocky's return to action is surprising but makes perfect sense. There have been numerous\nclues hinting that the same group behind the Necurs botnet was also behind the Locky\nransomware, and more recently, the Jaff ransomware, which many have considered Locky's\nsuccessor.\n\nAs Necurs slowly switched to Jaff, the Necurs group stopped spreading Locky spam in May,\nmost likely preferring the newer Jaff ransomware instead of the older Locky.\n\n## Locky's return may be tied to Jaff's fall\n\n\n-----\n\nThe Necurs group s long-term plan was foiled last week after security researchers from\n[Kaspersky Labs found a flaw in Jaff's encryption routine and created a free utility to help](https://www.bleepingcomputer.com/news/security/decrypted-kaspersky-releases-decryptor-for-the-jaff-ransomware/)\ninfected victims recover their files without paying the ransom.\n\nThis was unexpected, as researchers were never able to crack Locky's encryption method,\nand many thought Jaff to be just as tough, if not harder.\n\nKaspersky's feat appears to have taken the Necurs group by surprise as well. As soon as\nthe free decrypter was made available, Jaff spam went down, and beginning yesterday, the\nNecurs group started distributing Locky once more. This switch most likely happened\nbecause Locky's encryption was never cracked, and operators have a better chance of\nextorting ransom from infected hosts.\n\n## Windows DEP security feature mitigates new Locky variant\n\nThe new spam waves were detected by a large number of security researchers. All reported\nthat they had trouble infecting themselves on their test machines.\n\nIt was Cisco's Talos division that discovered why. According to the company's experts, the\nLocky authors rushed to replace the decrypted Jaff version with Locky and made several\nerrors in their deployment.\n\n\"Upon further investigation, we determined that on systems running Windows 7 or later with\n[Data Execution Prevention (DEP) would cause the unpacker to fail,\" said Cisco Talos](http://blog.talosintelligence.com/2017/06/necurs-locky-campaign.html)\nexperts. This means that only older OS versions such as XP and Vista are affected.\n\nIn their rush, the Locky authors most likely didn't notice this bug, as they put considerable\nresources into the ransomware's distribution, something they might not have done if they\nknew its ineffectiveness.\n\n## Locky spam accounted for 7.2% of all email spam\n\nCisco says spam for this new Locky variant accounted for nearly 7.2% of the Internet's\nentire email spam traffic. That's an insanely massive spam wave for a ransomware that only\ntargets less than 10% of the entire Windows userbase.\n\n\n-----\n\n**Necurs spam wave distributing new Locky version [Source: Cisco Talos]**\nFurthermore, this Locky version comes with minimal changes from the version researchers\nspotted the last time, in May. This Locky variant still uses the LOTPR extension at the end\nof encrypted files, and the same URL structure for C&C servers. This confirms the theory\nthat the Necurs operators rushed to deploy Locky after Kaspersky published the Jaff\ndecrypter.\n\n## Locky's new tactics\n\nBut there are also new wrinkles in this new Locky spam wave as well. Vitaly Kremez,\nFlashpoint Director of Research, discovered that Locky uses a new method of launching the\ninfected binary on targeted hosts.\n\n[Still vetting but wanted to share -> #Locky has a seemingly new execution method](https://twitter.com/hashtag/Locky?src=hash)\n[using ddeexec & Shortcut execution via \"locky.exe\" \"%1\" pic.twitter.com/61Ei0X4F6o](https://t.co/61Ei0X4F6o)\n\n[— Vitali Kremez (@VK_Intel) June 21, 2017](https://twitter.com/VK_Intel/status/877566377376329728)\n\nIn addition, the Locky spam emails use new texts for the email subjects and body content,\nalbeit they still pretend to be invoices, payment receipts, order confirmations, and so on.\n\nThese emails also packed file attachments differently, utilizing a double-nested ZIP\nstructure. The emails Bleeping Computer analyzed deliver a ZIP file with names in the\nformat of eight random digits (e.g.: 38017832.zip). This initial ZIP file contains another ZIP\nfile, which in turns contains an EXE file that runs Locky when executed.\n\n\n-----\n\n**Emails spreading new Locky version**\n\n**Content of second ZIP file delivered via recent Locky spam**\nLast but not least, this Locky version also added some anti-debugging protections that\nprevent the ransomware from running in virtual machines and other debug environments,\nwhich explains why researchers had a hard time analyzing it for the first few hours.\n\nOverall, this particular Locky spam run seems to be a rushed effort, but we can expect the\nransomware's operators to correct their flaws and start delivering a fixed version in the\nfollowing days.\n\nBelow are other indicators of compromise for this latest Locky variant.\n\n\n-----\n\n**Hash:**\n```\n49184047c840287909cf0e6a5e00273c6d60da1750655ad66e219426b3cf9cd8\n\n```\n**Extension:**\n```\n.loptr\n\n```\n**Ransom note:**\n```\nloptr-[random_4_chars].htm\n\n```\n**Ransom Note:**\n\n\n-----\n\n```\n + _ $ . $_ \n   !!! IMPORTANT INFORMATION !!!!\nAll of your files are encrypted with RSA-2048 and AES-128 ciphers.\nMore information about the RSA and AES can be found here:\n  http://en.wikipedia.org/wiki/RSA_(cryptosystem)\nhttp://en.wikipedia.org/wiki/Advanced_Encryption_Standard\nDecrypting of your files is only possible with the private key and decrypt program,\nwhich is on our secret server.\nTo receive your private key follow one of the links:\nIf all of this addresses are not available, follow these steps:\n 1. Download and install Tor Browser: https://www.torproject.org/download/downloadeasy.html\n 2. After a successful installation, run the browser and wait for initialization.\n 3. Type in the address bar: g46mbrrzpfszonuk.onion/4AD0FFBA24BF9034\n 4. Follow the instructions on the site.\n!!! Your personal identification ID: 4AD0FFBA24BF9034 !!!\n_=+.*$ - -_$|+$+=_.--=-$.\n|. $.|_.*=*-$$-$-_. \n$.+$*_* $ |..+*=\n\n```\n**Whitelisted folders:**\n```\ntmp\nwinnt\nApplication Data\nAppData\nProgram Files (x86)\nProgram Files\ntemp\nthumbs.db\n$Recycle.Bin\nSystem Volume Information\nBoot\nWindows\n\n```\n**Extensions:**\n\n\n-----\n\n```\n.yuv, .ycbcra, .xis, .wpd, .tex, .sxg, .stx, .srw, .srf, .sqlitedb, .sqlite3,\n.sqlite, .sdf, .sda, .s3db, .rwz, .rwl, .rdb, .rat, .raf, .qby, .qbx, .qbw, .qbr,\n.qba, .psafe3, .plc, .plus_muhd, .pdd, .oth, .orf, .odm, .odf, .nyf, .nxl, .nwb,\n.nrw, .nop, .nef, .ndd, .myd, .mrw, .moneywell, .mny, .mmw, .mfw, .mef, .mdc, .lua,\n.kpdx, .kdc, .kdbx, .jpe, .incpas, .iiq, .ibz, .ibank, .hbk, .gry, .grey, .gray,\n.fhd, .ffd, .exf, .erf, .erbsql, .eml, .dxg, .drf, .dng, .dgc, .des, .der, .ddrw,\n.ddoc, .dcs, .db_journal, .csl, .csh, .crw, .craw, .cib, .cdrw, .cdr6, .cdr5, .cdr4,\n.cdr3, .bpw, .bgt, .bdb, .bay, .bank, .backupdb, .backup, .back, .awg, .apj, .ait,\n.agdl, .ads, .adb, .acr, .ach, .accdt, .accdr, .accde, .vmxf, .vmsd, .vhdx, .vhd,\n.vbox, .stm, .rvt, .qcow, .qed, .pif, .pdb, .pab, .ost, .ogg, .nvram, .ndf, .m2ts,\n.log, .hpp, .hdd, .groups, .flvv, .edb, .dit, .dat, .cmt, .bin, .aiff, .xlk, .wad,\n.tlg, .say, .sas7bdat, .qbm, .qbb, .ptx, .pfx, .pef, .pat, .oil, .odc, .nsh, .nsg,\n.nsf, .nsd, .mos, .indd, .iif, .fpx, .fff, .fdb, .dtd, .design, .ddd, .dcr, .dac,\n.cdx, .cdf, .blend, .bkp, .adp, .act, .xlr, .xlam, .xla, .wps, .tga, .pspimage,\n.pct, .pcd, .fxg, .flac, .eps, .dxb, .drw, .dot, .cpi, .cls, .cdr, .arw, .aac, .thm,\n.srt, .save, .safe, .pwm, .pages, .obj, .mlb, .mbx, .lit, .laccdb, .kwm, .idx,\n.html, .flf, .dxf, .dwg, .dds, .csv, .css, .config, .cfg, .cer, .asx, .aspx, .aoi,\n.accdb, .7zip, .xls, .wab, .rtf, .prf, .ppt, .oab, .msg, .mapimail, .jnt, .doc,\n.dbx, .contact, .mid, .wma, .flv, .mkv, .mov, .avi, .asf, .mpeg, .vob, .mpg, .wmv,\n.fla, .swf, .wav, .qcow2, .vdi, .vmdk, .vmx, .wallet, .upk, .sav, .ltx, .litesql,\n.litemod, .lbf, .iwi, .forge, .das, .d3dbsp, .bsa, .bik, .asset, .apk, .gpg, .aes,\n.ARC, .PAQ, .tar.bz2, .tbk, .bak, .tar, .tgz, .rar, .zip, .djv, .djvu, .svg, .bmp,\n.png, .gif, .raw, .cgm, .jpeg, .jpg, .tif, .tiff, .NEF, .psd, .cmd, .bat, .class,\n.jar, .java, .asp, .brd, .sch, .dch, .dip, .vbs, .asm, .pas, .cpp, .php, .ldf, .mdf,\n.ibd, .MYI, .MYD, .frm, .odb, .dbf, .mdb, .sql, .SQLITEDB, .SQLITE3, .pst, .onetoc2,\n.asc, .lay6, .lay, .ms11 (Security copy), .sldm, .sldx, .ppsm, .ppsx, .ppam, .docb,\n.mml, .sxm, .otg, .odg, .uop, .potx, .potm, .pptx, .pptm, .std, .sxd, .pot, .pps,\n.sti, .sxi, .otp, .odp, .wks, .xltx, .xltm, .xlsx, .xlsm, .xlsb, .slk, .xlw, .xlt,\n.xlm, .xlc, .dif, .stc, .sxc, .ots, .ods, .hwp, .dotm, .dotx, .docm, .docx, .DOT,\n.max, .xml, .txt, .CSV, .uot, .RTF, .pdf, .XLS, .PPT, .stw, .sxw, .ott, .odt, .DOC,\n.pem, .csr, .crt, .key\n\n### Related Articles:\n\n```\n[BlackCat/ALPHV ransomware asks $5 million to unlock Austrian state](https://www.bleepingcomputer.com/news/security/blackcat-alphv-ransomware-asks-5-million-to-unlock-austrian-state/)\n\n[Windows 11 KB5014019 breaks Trend Micro ransomware protection](https://www.bleepingcomputer.com/news/security/windows-11-kb5014019-breaks-trend-micro-ransomware-protection/)\n\n[Industrial Spy data extortion market gets into the ransomware game](https://www.bleepingcomputer.com/news/security/industrial-spy-data-extortion-market-gets-into-the-ransomware-game/)\n\n[New ‘Cheers’ Linux ransomware targets VMware ESXi servers](https://www.bleepingcomputer.com/news/security/new-cheers-linux-ransomware-targets-vmware-esxi-servers/)\n\n[SpiceJet airline passengers stranded after ransomware attack](https://www.bleepingcomputer.com/news/security/spicejet-airline-passengers-stranded-after-ransomware-attack/)\n\n[Jaff](https://www.bleepingcomputer.com/tag/jaff/)\n[Locky](https://www.bleepingcomputer.com/tag/locky/)\n[Ransomware](https://www.bleepingcomputer.com/tag/ransomware/)\n[Spam](https://www.bleepingcomputer.com/tag/spam/)\n[Windows Vista](https://www.bleepingcomputer.com/tag/windows-vista/)\n[Windows XP](https://www.bleepingcomputer.com/tag/windows-xp/)\n\n[Catalin Cimpanu](https://www.bleepingcomputer.com/author/catalin-cimpanu/)\n\n\n-----\n\nCatalin Cimpanu is the Security News Editor for Bleeping Computer, where he covers topics\nsuch as malware, breaches, vulnerabilities, exploits, hacking news, the Dark Web, and a\nfew more. Catalin previously covered Web & Security news for Softpedia between May\n2015 and October 2016. The easiest way to reach Catalin is via his XMPP/Jabber address\nat campuscodi@xmpp.is. For other contact methods, please visit Catalin's author page.\n\n[Previous Article](https://www.bleepingcomputer.com/news/security/wannacry-ransomware-infects-55-speed-and-red-light-cameras-in-australia/)\n[Next Article](https://www.bleepingcomputer.com/news/security/vault-7-cia-has-malware-for-hacking-air-gapped-networks-via-usb-thumb-drives/)\n\n### Comments\n\n[steventaylor86 - 4 years ago](https://www.bleepingcomputer.com/forums/u/1054216/steventaylor86/)\n\nThere is no stopping it. Feels really unsafe now. After recent attack of WannaCry\nransomware, Semantic team said there is 2nd wave is still to come and attacks has\nincreased drastically in past 2 years. From 2015 to 2016, the number of ransomware\nattacks were total 2 million and rose 17.7 % from the previous year as per\n[gotowebsecurity - http://gotowebsecurity.com/ransomware-getting-worse/. It really](http://gotowebsecurity.com/ransomware-getting-worse/)\ndangerous to see such attacks. Most of the offices still using older version and still\nstruggling to adopt new technology. Its really bad.\n\nPost a Comment [Community Rules](https://www.bleepingcomputer.com/posting-guidelines/)\n\nYou need to login in order to post a comment\n\n[Not a member yet? Register Now](https://www.bleepingcomputer.com/forums/index.php?app=core&module=global&section=register)\n\n### You may also like:\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2017/2017-06-22 - Locky Ransomware Returns, but Targets Only Windows XP & Vista.pdf"
    ],
    "report_names": [
        "2017-06-22 - Locky Ransomware Returns, but Targets Only Windows XP & Vista.pdf"
    ],
    "threat_actors": [
        {
            "id": "aa73cd6a-868c-4ae4-a5b2-7cb2c5ad1e9d",
            "created_at": "2022-10-25T16:07:24.139848Z",
            "updated_at": "2025-03-27T02:02:10.120505Z",
            "deleted_at": null,
            "main_name": "Safe",
            "aliases": [],
            "source_name": "ETDA:Safe",
            "tools": [
                "DebugView",
                "LZ77",
                "OpenDoc",
                "SafeDisk",
                "TypeConfig",
                "UPXShell",
                "UsbDoc",
                "UsbExe"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "6e23ce43-e1ab-46e3-9f80-76fccf77682b",
            "created_at": "2022-10-25T16:07:23.303713Z",
            "updated_at": "2025-03-27T02:02:09.727245Z",
            "deleted_at": null,
            "main_name": "ALPHV",
            "aliases": [
                "ALPHV",
                "ALPHVM",
                "BlackCat Gang",
                "UNC4466"
            ],
            "source_name": "ETDA:ALPHV",
            "tools": [
                "ALPHV",
                "ALPHVM",
                "BlackCat",
                "GO Simple Tunnel",
                "GOST",
                "Impacket",
                "LaZagne",
                "MEGAsync",
                "Mimikatz",
                "Munchkin",
                "Noberus",
                "PsExec",
                "Remcom",
                "RemoteCommandExecution",
                "WebBrowserPassView"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673536062,
    "ts_updated_at": 1743041726,
    "ts_creation_date": 1653691131,
    "ts_modification_date": 1653691131,
    "files": {
        "pdf": "https://archive.orkl.eu/fd0b31a6b2cbd7b95f52105f9cdf51c6ffac7aac.pdf",
        "text": "https://archive.orkl.eu/fd0b31a6b2cbd7b95f52105f9cdf51c6ffac7aac.txt",
        "img": "https://archive.orkl.eu/fd0b31a6b2cbd7b95f52105f9cdf51c6ffac7aac.jpg"
    }
}