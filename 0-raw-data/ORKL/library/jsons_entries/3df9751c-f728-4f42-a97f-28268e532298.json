{
    "id": "3df9751c-f728-4f42-a97f-28268e532298",
    "created_at": "2022-10-25T16:48:23.025669Z",
    "updated_at": "2025-03-27T02:17:05.799104Z",
    "deleted_at": null,
    "sha1_hash": "1c664e6ab6a1e36fb0a1dccb231acfb26e943b19",
    "title": "It's Parliamentary: KeyBoy and the targeting of the Tibetan Community",
    "authors": "Citizen Lab",
    "file_creation_date": "2016-12-31T06:56:41Z",
    "file_modification_date": "0001-01-01T00:00:00Z",
    "file_size": 881798,
    "plain_text": "# s a a e a y ey oy a d e a ge g o e be a Community\n\n**citizenlab.org** [/2016/11/parliament-keyboy/](https://citizenlab.org/2016/11/parliament-keyboy/)\n\nBy: Adam Hulcoop, Matt Brooks, Etienne Maynier, John Scott-Railton, and Masashi Crete-Nishihata\n\n## Key Findings\n\nIn this report we track a malware operation targeting members of the Tibetan Parliament over August and\nOctober 2016.\n\nThe operation uses known and patched exploits to deliver a custom backdoor known as KeyBoy.\n\nWe analyze multiple versions of KeyBoy revealing a development cycle focused on avoiding basic antivirus\ndetection.\n\nThis operation is another example of a threat actor using “just enough” technical sophistication to exploit a\ntarget.\n\n## Introduction\n\nThe Tibetan community has been targeted for over a decade by espionage operations that use malware to infiltrate\ncommunications and gather information. They are often targeted simultaneously with other ethnic minorities and\n[religious groups in China. Examples as early as 2008 document malware operations against Tibetan non-](https://isc.sans.edu/diary/Overview+of+cyber+attacks+against+Tibetan+communities/4177)\ngovernmental organizations (NGOs) that also targeted Falun Gong and Uyghur groups. More recently in 2016,\n[Arbor Networks reported on connected malware operations continuing to target these same groups, which the](https://www.arbornetworks.com/blog/asert/wp-content/uploads/2016/04/ASERT-Threat-Intelligence-Report-2016-03-The-Four-Element-Sword-Engagement.pdf)\nCommunist Party of China perceives as a threat to its power.\n\nThese types of operations have multiple components, each with their own associated costs to the operator. There is\nthe exploit code and malware used to gain access to systems, the infrastructure that provides command and control\nto the malware operator, and the human elements – developers who create the malware, operators who deploy it,\nand analysts who extract value from the stolen information.\n\nWe anticipate that operators will attempt to balance the amount of information they expect to gather with the\noperational costs and risks of deploying different strategies and technologies. For example, in deploying a particular\nmalware implant against a target the operator will balance the likelihood and cost of discovery with the perceived\nvalue of extracting information from that target. If a toolkit is exposed inadvertently, the target may increase\ndefenses and the operator will have to spend more time and resources on development.\n\nCivil society groups, due to their generally limited technical capacity and lack of security expertise and\ncountermeasures, shift the risk/reward ratio in ways favourable to the malware operator. For example, we have\nobserved frequent reuse of older (patched) exploits in malware operations against the Tibetan community. Up-todate operating systems and software would block these threats, but the operators have probably discovered through\nexperience that the their targets have unpatched systems and a general lack of security controls beyond antivirus\nprograms. The continued use of old exploits is a cost reduction strategy: since they still work, there is little need to\nuse more expensive exploits.\n\nMoreover, many of the malware defenses used by the Tibetan diaspora involve individuals recognizing signs of a\nmalicious email, such as exhortations to open attachments. This kind of behavioral strategy pushes the operators to\n\n\n-----\n\nchanges sufficient to bypass signature-based security controls such as antivirus may be all that are necessary.\n\nThis report analyzes an operation targeting members of the Tibetan Parliament. The actors used a new version of\n[“KeyBoy,” a custom backdoor first disclosed by researchers at Rapid7 in June 2013. Their work outlined the](https://community.rapid7.com/community/infosec/blog/2013/06/07/keyboy-targeted-attacks-against-vietnam-and-india)\ncapabilities of the backdoor, and exposed the protocols and algorithms used to hide the network communication and\nconfiguration data.\n\n[We observed operations in August and October 2016, shortly after an order in June to demolish the](https://en.wikipedia.org/wiki/Larung_Gar_Buddhist_Academy) Larung Gar\nBuddhist Academy and days before organized protests on [October 19 around the same issue. These operations](https://www.facebook.com/events/190950044675347/)\ninvolved highly targeted email lures with repurposed content and attachments that contained an updated version of\nKeyBoy. We assess that KeyBoy is the product of a development cycle that is iterated only as much as necessary to\nensure the survival of the implant against antivirus detection and basic security controls.\n\nThis report is divided into two parts:\n\n**Part 1: The Parliamentarian Operation Analyzes an operation targeting the members of the Tibetan Parliament by**\nrepurposing legitimate content, and documents implanted with Keyboy.\n\n**Part 2: KeyBoy – Tracking Evolution Examines the KeyBoy development cycle revealing a focus on avoiding**\nbasic antivirus detection.\n\nTo assist other researchers, we include appendices and indicators of compromise that detail the KeyBoy samples\nwe analyzed and provide an in-depth analysis of some features of the most recent implant.\n\n## Part 1: The Parliamentarian Operation\n\nIn August and October 2016 we observed a malware operation targeting members of the [Tibetan Parliament (the](http://tibetanparliament.org/)\n[highest legislative organ of the Tibetan government in exile, formally known as Central Tibetan Administration). We](http://tibet.net/)\ncollected two emails sent to Parliamentarians that rapidly repurposed legitimate content in an attempt to entice\nrecipients to open malicious documents. The first attempt leveraged an old vulnerability in the parsing of Rich-text[format (.rtf) files (CVE-2012-0158). The second attempt used a newer, but also patched,](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2012-0158) **.rtf vulnerability**\n[(CVE-2015-1641). Both attempts used versions of KeyBoy and shared the same command and control](https://www.cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-1641)\ninfrastructure as well as other configuration details.\n\n### Attempt 1\n\nOn August 25, 2016, members of the Tibetan Parliament received an email with information on an upcoming\nconference relevant to the Tibetan community. This email had the same subject and attachment as a legitimate\nmessage sent to the same recipients just 15 hours prior, but in this case the attachment was crafted to exploit a\nfrequently targeted vulnerability in Microsoft Office. The accompanying malware was a backdoor implant designed\nto surveil the computers of the Parliamentarians. This malicious attachment used the original, legitimate filename as\na decoy (see: Figure 1).\n\nThis level of targeting and re-use of a legitimate document sent only hours before shows that the actors behind the\noperation are closely watching the Tibetan community, and may have already compromised the communications of\none or more of the Parliamentarians.\n\n**theme of the**\n\n**Document name:** **conference.doc**\n\n**MD5: 8307e444cad98b1b59568ad2eba5f201**\n\n\n-----\n\nsystem with the KeyBoy implant.\n\n#### The Infection Chain\n\nThe email attachment is a .rtf document containing a dropper, delivered using an exploit designed to leverage\n[CVE-2012-0158, a vulnerability in the way that Microsoft Word handles .rtf files. Over the past four years, this](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2012-0158)\n[vulnerability has been consistently used in malware campaigns against the Tibetan community despite having been](https://targetedthreats.net/)\n\n\nFigure 1: Email lure containing malicious document. Note the use of letters ‘r n’ in an attempt to appear as ‘m’ in the sender address.\n\n\npatched since April 2012.\n\nIf the exploit is successful, the following infection chain (see: Figure 2) is observed on the system.\n\n\nFigure 2: Process chain after exploit is successful\n\n\nThe files in this infection chain are outlined below. The exploit launches an executable ‘dropper’ component which is\nresponsible for placing the malware payload and its configuration file on disk, and finally for launching the main\nmalware code.\n\nNote that the dropper and the final (DLL) payload were compiled within seconds of each other.\n\n**Name:** **dw20.exe**\n\n\n**Size:**\n\n\n**256512**\n**bytes**\n\n\n-----\n\n**Compile Time:** **UTC**\n**MD5:** **0b4d45db323f68b465ae052d3a872068**\n**SHA256:** **5f24a5ee9ecfd4a8e5f967ffcf24580a83942cd7b09d310b9525962ed2614a49**\n**Purpose: dropper binary, used to install and execute the main implant**\n**Name:** **wab32res.exe**\n**Size:** **46080 bytes**\n\n**13 April 2008 18:30:52**\n\n**Compile Time:** **UTC**\n\n**MD5:** **8f08609e4e0b3d26814b3073a42df415**\n**SHA256:** **58105e9772f6befbc319c147a97faded4fbacf839947b34fe3695ae72771da5d**\n**Purpose: legitimate Microsoft Windows Address Book executable, used to load final payload**\n**Name:** **wab32res.dll**\n\n\n**Size:**\n\n\n**138240**\n**bytes**\n\n\n**09 May 2016 08:41:05**\n\n**Compile Time:** **UTC**\n\n**MD5:** **495adb1b9777002ecfe22aaf52fcee93**\n**SHA256:** **9a55577d357922711ab0821bf5379289293c8517ae1d94d48c389f306af57a04**\n**Purpose: malware payload, launched by wab32res.exe via DLL search order hijacking**\n\nNext, the dropper places a renamed copy of the legitimate Windows Address Book executable, along with the\nmalware binary, wab32res.dll, in the Local Application Data directory. Notably, the dropper modifies the\ntimestamps of the configuration file and the payload to match those of the\n**\\Microsoft\\SystemCertificates\\My\\ directory within the user’s Local Application Data directory. Once these**\nfiles are written to disk, the dropper starts the Windows Address Book executable which loads and executes the\n[malicious wab32res.dll file via DLL search-order hijacking.](https://www.fireeye.com/blog/threat-research/2010/07/malware-persistence-windows-registry.html)\n\n### Attempt 2\n\nOn October 11, 2016, the Tibetan Parliamentarians received an email with content repurposed from a Tibetan\nactivism campaign protesting the demolition of a Buddhist monastery in Tibet. The email was sent from the same\nemail address as the previous attempt (tibetanparliarnent[@]yahoo.com) and appears to copy content from\n[the Facebook page of a Tibetan NGO promoting the campaign. The message urges recipients to open an attached](https://www.facebook.com/events/190950044675347/)\n**.rtf file with further details on the campaign (see: Figure 3).**\n\n\n**urgent action larung gar buddhist**\n\n**Document name:** **academy.rtf**\n\n**MD5:** **913b82ff8f090670fc6387e3a7bea12d**\n\nOpening the attachment (an apparently blank document) in Microsoft Word would, similar to the first attempt, result\nin the infection of the target system with the KeyBoy implant.\n\n#### The Infection Chain\n\n[The .rtf document attached to the malicious email was designed to exploit a more recent vulnerability:](https://www.cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-1641) CVE-20151641. If successful, this exploit launches a newer version of the same malware used in the August attempt outlined\nabove, using a similar infection chain.\n\n**Name n/a**\n\n\n-----\n\n**Size:** **bytes**\n\n**29 September 2016 00:46:11**\n\n**Compile Time:** **UTC**\n\n**MD5:** **23d284245e53ae4fe05c517d807ffccf**\n**SHA256:** **542c85fda8df8510c1b66a122e459aac8c0919f1fe9fa2c43fd87899cffa05bf**\n**Purpose:dropper binary, used to install and execute the main implant**\n**Name:** **wab32res.exe**\n**Size:** **46080 bytes**\n\n**13 April 2008 18:30:52**\n\n**Compile Time:** **UTC**\n\n**MD5:** **8f08609e4e0b3d26814b3073a42df415**\n**SHA256:** **58105e9772f6befbc319c147a97faded4fbacf839947b34fe3695ae72771da5d**\n**Purpose:legitimate Microsoft Windows Address Book executable, used to load final payload**\n\n\nFigure 3: Email lure used in second attempt\n\n\n**Name:** **wab32res.dll**\n\n\n**Size:**\n\n\n**143872**\n**bytes**\n\n\n**29 September 2016 00:21:34**\n\n**Compile Time:** **UTC**\n\n**MD5:** **087bffa8a570079948310dc9731c5709**\n**SHA256:** **5da2f14c382d7cac8dfa6c86e528a646a81f0b40cfee9611c8cfb4b5d589aa88**\n**Purpose:malware payload, launched by wab32res.exe via DLL search order hijacking**\n\n**Local Application**\n\nAs with the first attempt, the resulting dropper installs the malware payload into the Data\n\ndirectory as wab32res.dll and subsequently launches it using the same method of DLL search-order hijacking\nagainst the legitimate Windows Address Book executable.\n\n### A Note on Vulnerabilities\n\n\n-----\n\n[among a set of four .rtf vulnerabilities discussed in recent reporting from researchers at Arbor Networks.](https://www.arbornetworks.com/blog/asert/wp-content/uploads/2016/04/ASERT-Threat-Intelligence-Report-2016-03-The-Four-Element-Sword-Engagement.pdf)\n\nThe researchers describe the presumed existence of an exploit document ‘builder’ designed to selectively\n[weaponize .rtf files using four older, patched, vulnerabilities: CVE-2012-0158, CVE-2012-1856, CVE-2015-1641,](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2012-0158)\n[and CVE-2015-1770.](https://www.cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2015-1770)\n\nThe Arbor report describes the ongoing use of these four vulnerabilities in a series of espionage campaigns against\nnot only Tibetan groups, but also others related to Hong Kong, Taiwan, and Uyghur interests. While we have not\nconnected the campaign targeting the Tibetan Parliamentarians to the campaigns described by Arbor, the continual\npairing of these older .rtf vulnerabilities with malware operations against the Tibetan community is noteworthy.\n\n### The Malware\n\nThe malware samples deployed in both of these operations are updated versions of the KeyBoy backdoor first\n[discussed in 2013 by Rapid7. KeyBoy provides basic backdoor functionality, allowing the operators to select from](https://community.rapid7.com/community/infosec/blog/2013/06/07/keyboy-targeted-attacks-against-vietnam-and-india)\nvarious capabilities used to surveil and steal information from the victim machine.\n\nKeyBoy functionality:\n\nGather system information, including details of the operating system, processor, disk, memory, display, and\nuptime (see: Figure 4)\n\nUpload files to the victim computer\n\nDownload files from the victim computer\n\nBrowse the file system, including gathering details about attached drives\n\nExecute commands and applications\n\nLaunch interactive shell\n\n\nThese updated\nversions of\nKeyBoy make\nuse of an\nencoded\nconfiguration file\nto store their\ncommand and\ncontrol (C2)\ninformation\nalong with other\nrequired\nsettings. In both\ncases, the\ndropper wrote\nthis configuration\nfile in the user’s\nLocal Application\nData directory as\n**win32res.dat.**\n\n\nFigure 4: Format strings illustrating some of the system information obtained by KeyBoy from an infected machine\n\n\n-----\n\nLine Description First sample Second sample\n\nLine 1 Identity code, used to ensure config was correctly decoded 9876543210 9876543210\n\nLine 2 C2 Server #1 (hostname/ip) 45.125.12[.]147 45.125.12[.]147\n\nLine 3 C2 Server #2 (hostname/ip) 103.40.102[.]233 45.125.12[.]147\n\nLine 4 C2 Server #3 (hostname/ip) 45.125.12[.]147 45.125.12[.]147\n\nLine 5 Port used with C2 Server #1 443 443\n\nLine 6 Port used with C2 Server #2 443 443\n\nLine 7 Port used with C2 Server #3 443 443\n\nLine 8 Password for operator login tibetwoman tibetwoman\n\nLine 9 Campaign ID, transmitted to C2 during login NNNN NNNN\n\n**Table 1: Decoded configuration parameters from both KeyBoy samples observed in the Parliamentarian operation**\n\nA full description of the new algorithm used by KeyBoy to decode its configuration file is presented in Appendix A.\n\nOnce the KeyBoy DLL has been executed, it validates that a particular string value (likely identifying the KeyBoy\nversion) is set in the Windows Registry.\n\n\nKey First\n\nsample\n\n\nSecond\n\nsample\n\n\nHKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Internet\n\nSettings\\Zonemap\\Ver\n\n\n20160509 agewkassif\n\n\nAdditionally, these versions of KeyBoy ensure persistence by setting the wab32res.exe file to be loaded upon\nlogin via exploiting the Winlogon Shell key, which in turn loads the malicious wab32res.dll file by the\naforementioned DLL search-order hijacking method.\n\nKey Value\n\n\nHKEY_CURRENT_USER\\Software\\Microsoft\\Windows\nNT\\CurrentVersion\\Winlogon\\Shell\n\n\nexplorer.exe,\n“C:\\users\\\\AppData\\Local\\wab32res.exe”\n\n\nThe backdoor then sends a login beacon to the C2 server which, once decoded, looks like:\n\n\n-----\n\n**USER PC**\n**192.168.100.101**\n**NNNN**\n**2016/09/13**\n**16:11:56**\n**20160509**\n\nThese values are described as follows in **Table 2:**\n\nValue from Example Description\n\n*a* Data header code for initial check-in beacon\n\nUSER-PC %computername% of victim PC\n\n192.168.100.101 IP address of victim PC\n\nNNNN Campaign ID from the KeyBoy configuration file\n\n2016/09/13 16:11:56 Timestamp of local PC\n\n20160509 Internal version identifier\n\n**Table 2: Descriptions of the login beacon values**\n\nThis login data, as well as all other communication between backdoor and command and control server, is\ntransmitted using an encoding mechanism based on principles from modular arithmetic. We describe this network\n[communication encoding in detail in this supplementary document.](https://citizenlab.org/wp-content/uploads/2016/11/keyboy-network-comm.pdf)\n\nAs can be seen in the login event example above, when sending data to the C2, the KeyBoy implant uses a series of\nheader ‘codes’ to specify the type of data which is being transmitted, described in Table 3:\n\nHeader code Data being transmitted\n\n*l* Heartbeat / Keepalive\n\n*a* Initial check-in beacon\n\n*s* System information (drive info, system specifications, interface info)\n\n*d* Data from remote commands and shell\n\n*f* Data relating to interactions via File Manager\n\n*g* Ready to initiate file download\n\n*h* Ready to initiate file upload or update\n\n**Table 3: KeyBoy header codes for sending data to the C2 server**\n\n\n-----\n\nconfiguration files:\n\nC2 Host: 45.125.12[.]147 Desc: Royal Network Technology Co City: Guangzhou Country: China\n\nNo relevant data or passive DNS information was available\n\nC2 Host: 103.40.102[.]233 Desc: Dragon Network Int’l Co. Ltd City: Hong Kong Country: Hong Kong\n\nDomain: tibetvoices[.]com\n\nHost First Seen: Last Seen:\n\n127.0.0.1 2016-09-29 Current as of publication\n\n103.40.102[.]233 2016-07-15 2016-09-28\n\n112.10.117[.]47 2016-05-25 2016-05-26\n\nWe uncovered very little information about the command and control (C2) infrastructure used in this operation. The\nconfiguration files referenced hard-coded IP addresses for the C2 servers, as opposed to using domain names as\nwas seen in prior KeyBoy campaigns.\n\nPassive DNS analysis revealed one domain, tibetvoices[.]com, which was briefly pointed to one of the C2\nserver IP addresses found in the KeyBoy configuration file used in the first attempt against the Parliamentarians.\nThis domain was created in May 2016 (around the time that the KeyBoy sample used in the first attempt was\ncompiled) and was pointed to IP address 103.40.102[.]233 from July 15 to September 28. Subsequently, this\ndomain was pointed to 127.0.0.1, effectively taking it offline.\n\n[This behavioural tactic was previously mentioned in relation to KeyBoy in a 2013 blog post by Cisco. Cisco](http://blogs.cisco.com/security/scope-of-keyboy-targeted-malware-attacks)\nhypothesized that the actors behind KeyBoy may have been nullifying the DNS records when an active campaign\nwas not underway, in an attempt to stay “below the radar”. This tactic allows the malware operator to ensure that no\ncommand and control traffic will be sent out from the infected system, thus preventing detection via network\nmonitoring.\n\nThis tactic, however plausible, would not apply to the KeyBoy samples we analyzed, as the C2 configuration relied\nupon hard coded IP addresses and did not directly reference the tibetvoices[.]com domain. It is possible that a\ndifferent campaign was launched which used this domain, but we were unable to find any evidence of such a\ncampaign.\n\nOur analysis provides a cursory look at some of the capabilities and implementation details of the KeyBoy backdoor\nas used during a malware operation targeting Tibetan Parliamentarians. These versions of KeyBoy differed from the\none first described by Rapid7 in several ways, many of which will be described in the sections to follow.\n\nDuring our research into this operation we were able to uncover two additional samples of KeyBoy which were likely\nused in previous malware campaigns. These samples were contained in exploit documents containing distinct lure\n\n\n-----\n\nobtained.\n\n## Part 2: KeyBoy – Tracking Evolution\n\nPeriodic updates are common in the world of software development. Features are added and removed, bugs are\npatched, and code is written to execute more efficiently. The same holds true for malicious software, but with the\nadditional requirement that the development cycle must always satisfy the operational need for covertness. To be\neffective, malicious software designed for surveillance must remain undetected. Malware developers are in a\nconstant struggle to avoid the security controls that protect target systems.\n\nWe believe the 2013, 2015, and 2016 KeyBoy samples provide evidence of a development effort focused on\nchanging components that would be used by researchers to develop detection signatures. This section outlines how\nwe came to this conclusion.\n\nIn building our KeyBoy chronology, we collected several samples and examined three data points from each:\n\nThe compile time of the KeyBoy binary\n\nA string observed in the KeyBoy binary we refer to as the ‘version identifier’\n\nElapsed time between compile time and the time of first exposure\n\nAnalysis of these data points gave us a moderate to high level of confidence that the binary compile times provided\na reliable estimate of the true development timeline.\n\n### An Evolving Implant\n\nIn an effort to understand its evolution, we compared the code of several versions of KeyBoy as identified by their\n‘version identifier’ strings, shown in Table 4:\n\nVersion Identifier Notes\n\nProxy 20130401 Reported by Rapid7 in relation to an Indian nexus\n\nProxy 20130401 Reported by Rapid7 in relation to a Vietnamese nexus\n\nP_20150313 Discovered via hunting; carried Indian lure content\n\n20151108 Discovered via hunting; carried Tibetan lure content\n\n20160509 First sample of the Parliamentarian operation from August 2016\n\n20160509 An alternate sample, using different configuration data\n\nagewkassif Second sample of the Parliamentarian operation from October 2016\n\n**Table 4: Version identifier strings analyzed**\n\nThe ‘version identifier’ is a particular string that appeared in every KeyBoy sample we studied. It is transmitted to the\ncommand and control server as part of the login data packet, and, in recent versions, this identifier is written to the\nWindows registry in a key named ‘Ver’ With the exception of the newest (chronologically speaking) KeyBoy version\n\n\n-----\n\nrandom set of letters.\n\nA timeline depicting these KeyBoy versions, along with some important characteristics, is shown in Figure 5.\n\n\nFigure 5: The timeline of KeyBoy’s evolution\n\n\n### Noteworthy Modifications\n\nThis section describes some of the most significant changes observed across the KeyBoy versions. Each of these\ncomponents would have been an ideal target for signature-based identification, using either static string or network\npacket-based detection mechanisms.\n\n#### Header Code Evolution\n\nOf the changes we identified one stands out as being an immediate target for an effective antivirus signature – the\nevolution of header codes used during communication between the implant and command and control server. As\nshown in Table 5, these codes changed substantially after the 2013 KeyBoy samples were examined and publically\ndocumented by Rapid7. It is reasonable to hypothesize that this significant change in format was in response to the\npublication of Rapid7’s research.\n\n**2013** **Early 2015** **Late 2015** **2016**\n\n$login$ #l# *a* *l*\n\n$sysinfo$ #s# *s* *a*\n\n$shell$ #e# *d* *s*\n\n\n-----\n\n$fileDownload$ #D# *g* *f*\n\n$fileUpload$ #U# *h* *g*\n\n*h*\n\n**Table 5: Header codes used by KeyBoy during C2 communication**\n\nIn addition, modifying these codes produced a downstream change in the appearance of the network\ncommunication traffic produced by an active KeyBoy infection. This change would likely have rendered existing\nnetwork based signatures ineffective.\n\n#### Configuration File Changes\n\nAnother major change we first observed in version **P_20150313 is the complete redesign of the algorithm used to**\n\nencode the KeyBoy configuration file. In the 2013 samples described by Rapid7, this configuration file was encoded\nusing a simplified static-key based algorithm. This newer encoding algorithm is significantly more involved, removing\nthe use of a static encryption key in favour of a dynamically constructed lookup table. We provide a detailed\nexplanation of this new algorithm in Appendix A.\n\n#### Persistence Changes\n\nThe method used by the implant for maintaining persistence was also changed several times. The earlier versions\nused a Windows service to ensure the malware stayed persistent, moving to a more commonly seen tactic of setting\nthe Run key in the Windows registry in the early 2015 sample. This method changed again in late 2015 when the\n\nimplant migrated from the Run key to using a less frequently observed registry key: Winlogon\\Shell. This key\nstores the list of executables which are to be run once a Windows GUI session is created, and typically holds only\nthe standard user shell, explorer.exe.\n\n#### String Obfuscation\n\nIn another modification, first observed in the most recent October 11 Parliamentarian operation (version\n**agewkassif), the developer(s) of KeyBoy began using a string obfuscation routine in order to hide many of the**\n\ncritical values referenced within the malware. This introduction of string obfuscation also suggests a development\nchange aimed at evading detection. The header codes, filename references, and all of the operator commands were\nobfuscated and only decoded during execution of the KeyBoy DLL. Figure 6 shows a sampling of these strings,\nafter decoding.\n\n#### Evidence of Modularity\n\nFinally, there were numerous changes observed that could suggest that KeyBoy was being deployed using a\nmodular or component based mechanism. The GetUp export which is linked to the browser credential theft\n\ncapability seems to be present in some samples and not others, even for versions within the same development\nstage. As well, the inconsistent use of a dropper binary during infection is further evidence supporting the modular\ncomponent theory.\n\n#### Additional Details\n\n\n-----\n\ndescribed in Table 6 below.\n\nVersion Key Changes\nIdentifier\n\nProxy\n\nPersistence handled via Windows service\n20130401\n\nOne sample contained the ‘GetUP’ export, the other did not\n\nUsed full word header codes encapsulated by $ symbols, such as _$login$_\n\nP_20150313\n\nAdopts new algorithm for config file encoding\n\nRetained browser credential theft module\n\nMoved to persistence via Run key\n\nHeader codes shift to #-encapsulation\n\nDeployed without use of dropper binary\n\n20151108\n\nContinues use of new config encoding algorithm\n\nMigrated to use of WinLogon key for persistence\n\nInstallation now conducted via VBS scripts\n\nAdopted multi-byte strings internally and in C2 communication\n\nHeader codes move to *-encapsulation\n\nFigure 6: Header code and command strings after being decoded at run-time\n\n64 bit version distributed inside 32 bit payload\n\nNo evidence of browser credential module\n\nDeployed using dropper binary\n\n20160509\n\nContinues use of new config encoding algorithm\n\nAdded AutoUpdate/Upload & Execute function\n\nDeployed using dropper binary\n\nHeader codes retain *-encapsulation, new ‘keep-alive’ code, *l*\n\nExecution via DLL search-order hijacking of legitimate Windows application\n\nVBS script traces still present, but no longer used\n\nNo 64bit version embedded\n\n|Used full word header codes encapsulated by $ symbols, such as $login$|Col2|Col3|\n|---|---|---|\n|Used full word header codes encapsulated by $ symbols, such as $login$|||\n||||\n|P_20150313|Adopts new algorithm for config file encoding Retained browser credential theft module Moved to persistence via Run key Header codes shift to #-encapsulation Deployed without use of dropper binary||\n|20151108|Continues use of new config encoding algorithm Migrated to use of WinLogon key for persistence Installation now conducted via VBS scripts Adopted multi-byte strings internally and in C2 communication Header codes move to *-encapsulation Figure 6: Header code and command strings after being decoded at run-time 64 bit version distributed inside 32 bit payload||\n\n\nAdopts new algorithm for config file encoding\n\nRetained browser credential theft module\n\nMoved to persistence via Run key\n\nHeader codes shift to #-encapsulation\n\nDeployed without use of dropper binary\n\nContinues use of new config encoding algorithm\n\nMigrated to use of WinLogon key for persistence\n\nInstallation now conducted via VBS scripts\n\nAdopted multi-byte strings internally and in C2 communication\n\nHeader codes move to *-encapsulation\n\n\n-----\n\nFunctionally identical to 20160509 sample\n\nContinues use of new config encoding algorithm\n\nRemoved date string from version identifier\n\nAdded static string obfuscation code. Strings used for C2 commands, header codes, and\n\nmore are now decoded at runtime\n\n**Table 6: Changes observed between successive versions of KeyBoy**\n\nAdditional technical details relating to several of the KeyBoy samples described in this section are provided in\nAppendix B.\n\n### Connecting KeyBoy to Other Operations\n\n[In their Operation Tropic Trooper report, Trend Micro documented the behaviour and functionality of an espionage](http://www.trendmicro.com/cloud-content/us/pdfs/security-intelligence/white-papers/wp-operation-tropic-trooper.pdf)\ntoolkit with several design similarities to those observed in the various components of KeyBoy. Trend Micro\nspecifically noted that the 2013 versions of KeyBoy used the same algorithm for encoding their configuration files as\nwas observed in the Operation Tropic Trooper malware.\n\nThis connection may offer another explanation for the significant change in the configuration file encoding algorithm\nwe described in relation to KeyBoy. If KeyBoy is a single component of a larger espionage toolkit, the developers\nmay have realized that this older, static-key based, configuration encoding algorithm was inadvertently providing a\nlink between disparate components of their malware suite.\n\n### A Note on Samples\n\nWe were not able to locate a large sample set for KeyBoy. Though we discussed the development timeline, we have\nlimited insight into the victims targeted by each of these samples. We cannot conclude that all are being deployed\n[by the same group. We provide YARA signatures and encourage anyone who can provide additional samples or](https://github.com/citizenlab/malware-indicators/blob/master/201611_KeyBoy/keyboy.yar)\ncontext to contact us.\n\n## Recent Tibetan Protests\n\nThe harm of malware operations against the Tibetan community is [well-documented, and this latest campaign is no](https://targetedthreats.net/)\nexception. Examining the lure content sent to the Tibetan Parliamentarians sheds light on the oppression faced by\nthe Tibetan community. On October 19, over 180 Tibetan groups protested the ongoing demolitions of the Larung\nGar Buddhist Academy, the largest Tibetan Buddhist institute in the world.\n\nThe demolitions stem from an order issued by Chinese authorities in June 2016, [according to a joint statement](https://freetibet.org/news-media/na/over-180-tibet-groups-condemn-larung-gar-demolitions-joint-statement)\nissued by Tibet groups on the date of protest. According to the same joint statement, the order from Chinese\nauthorities said the community was in need of “ideological guidance” from the Chinese state. In conjunction with the\n[demolitions, residents are being forcefully removed from Larung Gar. To date, the forced removals have led to to the](http://tchrd.org/nuns-continue-suicide-protest-against-demolition-of-buddhist-institute/)\nsuicide of three resident nuns.\n\nThe Communist Party of China views the Tibetan movement as a threat to its rule, alongside Uyghur, Falun Gong,\nadvocates for an independent Taiwan and Hong Kong, and members of the democracy movement. Surveilling the\nhighest governing body of the Central Tibetan Administration aligns with the overall interests of the government of\n\n\n-----\n\nany specific actor or nation-state.\n\n## Conclusions\n\n[Recent Citizen Lab reports have documented a trend away from the use of attachment-based malware operations](https://citizenlab.org/2016/03/shifting-tactics/)\ntargeting the Tibetan Diaspora. These changes may reflect malware operators shifting tactics in response to\n[changes in the community, including education campaigns encouraging Tibetans not to use email attachments, or](https://www.cybersuperhero.net/safer-file-sharing/)\nperhaps also by more sophisticated attachment scanning by popular email providers.\n\nThe operation against the Tibetan Parliamentarians illustrates the continued use of malicious attachments in the\nform of documents bearing exploits. These exploits, while older, were used to deliver a malware payload which\nshows signs of a systematic technical adaptation designed to reduce the likelihood of signature based detection.\n\nThe developers of KeyBoy have made the minimum necessary technical changes required to avoid detection by\nsignature-based antivirus, and yet retained “old” exploits because they likely continue to work their targets.\n\nFor a community lacking an adequate level of human and financial resources, deployment of commercial (i.e.: nonfree) antivirus solutions, updated releases of common office productivity software, and even software patches may\nbe out of reach. Under such conditions, the use of exploits against older, patched, vulnerabilities becomes yet\n[another iteration of an actor using “just enough” sophistication to successfully exploit a target.](https://www.johnscottrailton.com/security-for-the-high-risk-user/)\n\nThe operation against the Parliamentarians yields a clear example of this tactic. When the August operation failed to\nfully compromise the target group, the operators redeployed in October using a slightly newer, but still well-known\nand patched, exploit.\n\nAs we observe the evolution of strategies levied against the Tibetan Diaspora, the constant cat-and-mouse game\nembroiling this community becomes evident. While some behavioural adaptations have shown promise in reducing\nthe threat, the operation against the Tibetan Parliament underscores the need for continued diligence and security\nawareness.\n\n## Acknowledgments\n\nSpecial thanks to Tibet Action Institute. Additional thanks to Jakub Dalek, PassiveTotal, VirusTotal, and TNG.\n\n## Appendix A: Decoding KeyBoy Config\n\nRecent versions of KeyBoy maintain encoded configuration data inside a file stored on disk. In the **20160509**\n\nsample used in the Tibetan Parliament campaign, this file was named wab32res.dat. The configuration file\ncontains a 16 byte header followed by a number of bytes which are encoded using a novel algorithm. The 16 byte\nheader stores an ascii character representation of the hexadecimal values corresponding to the size (in bytes) of the\ndecoded config data, followed by the number of bytes containing encoded configuration data.\n\nThe sample under examination contained the following header, and Figure 7 shows the raw configuration file:\n\nSize of config (in bytes) once decoded Number of bytes in encoded config\n\n0x00 0x00 0x00 0x5B 0x00 0x00 0x00 0x4B\n\n\n-----\n\nFigure 7: Configuration file for sample under examination\n\n\nearlier versions of this backdoor used more simplified encoding techniques for the configuration data, newer\nversions have adopted a more involved algorithm.\n\nAt the heart of the decoding function is the use of a dynamically constructed lookup table containing sequences of\nbytes which represent the ASCII characters for the cleartext configuration data.\n\nAt the outset of the decoding function, a base lookup table is created\ncontaining 256 entries. This initial table can be thought of as an identity\nmatrix, where, for each index, the lookup table contains the index as\nthe stored value (see: Figure 8). For example:\n\nLookupTable[0x0] → 0x0\n\nLookupTable[0x1] → 0x1\n\n⋮ ⋮\n\nLookupTable[0xFF] → 0xFF\n\n\nDuring the decoding of the configuration file, this table is expanded\ndynamically. Each iteration of the algorithm will populate the lookup\ntable sequentially, beginning with index 0x102 (since the table index\n0x101 is reserved).\n\n### Algorithm Walkthrough\n\nThe algorithm has three basic steps:\n\n1. Obtain an index by decoding a value from the configuration file\n\n\nFigure 8: Construction of the base lookup table\n\n\n2. Find the value in the lookup table corresponding to this index, and place this result in the memory buffer\n\nholding decoded configuration data\n\n3. Generate a new value and insert it into the lookup table at the next available index\n\n#### Step 1\n\nThis step requires the algorithm to obtain an index value from the configuration file. In order to obtain this index, a\ndecoding function evaluates the data in the configuration file not as successive bytes, but as a series of integers\ncalculated by considering consecutive sequences of 9-bit binary values.\n\n\n-----\n\ndenotes the beginning of the configuration data. The values 0x39, 0x38, and 0x37 are the first three indices used to\nobtain data from the lookup table.\n\n\nFigure 9: Step 1 in KeyBoy decoding algorithm. Indices are obtained by viewing the data in 9-bit ‘windows’\n\n\n#### Step 2\n\nAs mentioned above, the first 256 entries in the lookup table are created as an identity matrix, and thus the result of\nlookups for 0x39,0x38,0x37 would be:\n\n**LookupTable[ 0x39 ] = 0x39 => “9”**\n**(ascii)**\n**LookupTable[ 0x38 ] = 0x38 => “8”**\n**(ascii)**\n**LookupTable[ 0x37 ] = 0x37 => “7”**\n**(ascii)**\n\nThese values are then stored in memory as decoded bytes of configuration data.\n\n#### Step 3\n\nAfter each iteration of calculating an index (step 1) and then obtaining the corresponding value from the lookup table\n(step 2), the algorithm will create a new entry in the lookup table at the next available index. The format of this new\nlookup table entry is simply the concatenation of the results of the previous lookup with the first byte of the current\n\n\n-----\n\nFigure 10: Steps 2 & 3 in the KeyBoy configuration decoding algorithm\n\n\ndecoded the value 0x34 in step 1, and thus retrieved the value 0x34 = ‘4’ in step 2, the newly formed lookup table\nentry would be:\n\n**LookupTable[ 0x106 ] = [0x35,0x34] =>**\n**“54”**\n\nThus, if at some future point in the decoding process the index 0x106 was obtained in step 1, the output to the\nconfiguration data would be the two bytes [0x35,0x34] which have ascii representation “54”. This provides a method\nof data compression to the configuration file.\n\nA Python script was created for the purpose of automating this configuration file decoding process. The output of\nthis script when run against the configuration file used by the first of the two Parliamentarian operation samples\nyielded the following data:\n\n\n-----\n\n**Identity Code: 9876543210**\n**C2 Host/IP #1: 45.125.12.147**\n**C2 Host/IP #2:**\n**103.40.102.233**\n**C2 Host/IP #3: 45.125.12.147**\n**C2 Port #1: 443**\n**C2 Port #2: 443**\n**C2 Port #3: 443**\n**Password: tibetwoman**\n**Campaign ID: NNNN**\n\n## Appendix B: KeyBoy Samples\n\n#### Version: P_20150313\n\n**Exploit Document:** **05b5cf94f07fee666eb086c91182ad25**\n\n**Payload:** **0c7e55509e0b6d4277b3facf864af018**\n**DLL Exports**\n**Embedding 0x1000bfb0**\n**GetUP 0x1000c940**\n**SSSS 0x1000bc60**\n**StartWork 0x1000c570**\n**SvcMain 0x1000c430**\n\n#### Installation\n\nThis sample was discovered inside a malicious PowerPoint slide show which carried lure content consistent with an\nIndian-nexus, and which was uploaded to VirusTotal in April 2015 using the filename athirappalli.pps.\n[Athirappilly is a village in India known for its wildlife and waterfalls. The visual contents of the slide show are images](https://en.wikipedia.org/wiki/Athirappilly)\nof waterfalls, presumably from this village. This malicious .pps file was weaponized using (closely related to CVE\n[2014-4114 aka Sandworm, which we have previously observed this exploit used against the Tibetan community) to](https://citizenlab.org/2015/06/targeted-attacks-against-tibetan-and-hong-kong-groups-exploiting-cve-2014-4114/)\nexecute the following embedded DLL:\n\n**Name:** **SystemCertificates.ocx**\n\n\n**Size:**\n\n\n**495616**\n**bytes**\n\n\n**13 Mar 2015 03:05:34**\n\n**Compile Time:** **UTC**\n\n**MD5:** **0c7e55509e0b6d4277b3facf864af018**\n\n**SHA256:** **5395f709ef1ca64c57be367f9795b66b5775b6e73f57089386a85925cc0ec596**\n\n#### Persistence\n\nThis DLL maintains persistence by setting the following registry entry in the\n**HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run key: SystemCertificates → \"cmd /c**\n**start**\n\n\nRun\n\n\n**dll32.exe %APPDATA%\\Microsoft\\SystemCertificates\\SystemCertificates.ocx,**\n**SSSS**\n\n\nThi i k i i h S d l i h i f fil i i h f ll i\n\n\n-----\n\n**[DefaultInstall]**\n**CopyFiles =**\n**RxCopy**\n**AddReg = RxStart**\n\n**[RxCopy]**\n**..\\..\\Roaming\\Microsoft\\SystemCertificates\\SystemCertificates.ocx, contact.pdf**\n\n**[RxStart]**\n**HKCU,Software\\Microsoft\\Windows\\CurrentVersion\\Run,SystemCertificates,,\"cmd /c start**\n**Rundll32.exe %APPDATA%\\Microsoft\\SystemCertificates\\SystemCertificates.ocx, SSSS\"**\n\nIn comparison with the prior generation of KeyBoy examined by Rapid7, this mechanism represents a change to\nregistry based persistence from the previously used Windows service.\n\n#### Configuration\n\nUsing the algorithm presented in Appendix A, we were able to decode the configuration file used by this sample.\nOnce decoded, the following information was obtained:\n\n**Identity Code: IJUDHSDJFKJDE**\n**C2 Host/IP #1: www.about.jkub[.]com**\n**C2 Host/IP #2:**\n**www.eleven.mypop3[.]org**\n**C2 Host/IP #3:**\n**www.backus.myftp[.]name**\n**C2 Port #1:80**\n**C2 Port #2:80**\n**C2 Port #3:443**\n**Password:wariii**\n**Campaign ID:war**\n\n#### Infrastructure\n\nC2 Host: www.about.jkub[.]com Desc: Dynamic DNS provided by changeip.com\n\nHost First Seen: Last Seen:\n\n175.213.49[.]6 2016-10-25 Current as of publication\n\n45.32.47[.]148 2016-09-26 2016-10-24\n\n157.7.84[.]81 2015-04-07 2015-04-21\n\n\n-----\n\nHost First Seen: Last Seen:\n\n175.213.49[.]6 2016-10-25 Current as of publication\n\n45.32.47[.]148 2016-09-26 2016-10-24\n\nC2 Host: www.backus.myftp[.]name Desc: Dynamic DNS\n\nHost First Seen: Last Seen:\n\n192.241.149[.]43 2015-05-05 Current as of publication\n\n#### Version: 20151108\n\n**Exploit Document:** **8846d109b457a2ee44ddbf54d1cf7944**\n**Dropper:** **8846d109b457a2ee44ddbf54d1cf7944**\n\n**Payload:** **c5b5f01ba24d6c02636388809f44472e**\n**Embedded 64bit:** **371bc132499f455f06fa80696db0df27**\n**Payload DLL Exports**\n**Install 0x100085a0**\n**SSSS 0x100081e0**\n**StartWork 0x100086a0**\n**SvcMain 0x10008fb0**\n**cfsUpdate 0x10008cb0**\n\n#### Installation\n\nThis .rtf document, also exploiting CVE-2012-0158, was submitted to [VirusTotal in March 2016. The exploit](https://virustotal.com/en/file/ba442907f3218c8664bbecb47f915c4469340219e0f05af8f2d108d72659ff0f/analysis/)\n\ntriggers the execution of an embedded dropper, similar to the method observed in our initial sample described in\nPart 1.\n\nThis dropper creates three files on disk, each in the %localappdata% folder:\n\n1. cfs.dat – KeyBoy configuration file\n\n2. cfsupdate.dal – KeyBoy payload DLL\n\n3. desk.vbs – Windows script used for installation\n\nThe Windows script file, desk.vbs, contained the following content:\n\n\n-----\n\nThe dropper executes this script file which subsequently launches the KeyBoy backdoor and sets persistence as\ndescribed below.\n\nAlso noteworthy in this sample was the fact that this payload inspected the architecture of the victim PC to\ndetermine if it was 64 bit capable. If so, a 64 bit version of the payload was decoded from the data section of the\ncfsupdate.dat file using an XOR operation having key 0x90. This is very similar to the method described by Trend\n[Micro in their report on the TROJ_YAHOYAH malware.](http://www.trendmicro.com/cloud-content/us/pdfs/security-intelligence/white-papers/wp-operation-tropic-trooper.pdf)\n\nInterestingly, the 64-bit module was packed using a known freeware binary packer. This is in contrast to the 32-bit\nversions of KeyBoy, none of which contained any binary protections whatsoever. Upon unpacking, the 64-bit version\nof this KeyBoy code was functionally identical to the 32-bit version.\n\n#### Leftover Code\n\nFurther illustrating the continued development and connections between samples are the leftover remnants from\n**20151108 existing in the 20160509 Parliamentarian sample. The Parliamentarian dropper contained references to**\n\nthe Desk.vbs script described above, yet this file and related content was not deployed or otherwise used in the\n**20160509 version.**\n\n#### Persistence\n\nPersistence is achieved through the WinLogon\\Shell registry key, and is installed by the dropper’s execution of the\nInstall export from the KeyBoy DLL. This export creates the file %localappdata%\\Desktop.ini as shown below,\nand installs it by launching the Windows regini.exe command:\n\n**HKEY_CURRENT_USER\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon**\n**shell = explorer.exe,C:\\Windows\\system32\\rundll32.exe \"%LOCALAPPDATA%\\cfs.dal\"**\n**cfsUpdate**\n\n#### Configuration\n\nThe configuration file used by this version of KeyBoy is written to disk as %localappdata%\\cfs.dat by the\ndropper, similar to the behaviour of our 20160509 sample. This configuration file uses the newer encoding method\n\noutlined above and in Appendix A. Once decoded, the following information was obtained:\n\n\n-----\n\n**Identity Code: 9876543210**\n**C2 Host/IP #1:**\n**103.242.134[.]243**\n**C2 Host/IP #2:**\n**103.242.134[.]243**\n**C2 Host/IP #3:**\n**103.242.134[.]243**\n**C2 Port #1: 443**\n**C2 Port #2: 1234**\n**C2 Port #3: 1234**\n**Password: password8888**\n**Campaign ID: MyUser**\n\n#### Possible Targeting\n\nThis malicious document embedded an empty decoy document to hide the exploitation of the vulnerability. We found\n[however another interesting sample with the exact same payload but with a decoy document presenting a petition to](https://malwr.com/analysis/MmZjNjMyZjYxNWRiNDJhYzg0YzY5ZTQxYjYxNWM2NDE/)\nrelease a Tibetan activist:\n\n#### Infrastructure\n\nThis sample communicates with the following command and control server:\n\n**C2 Host:** **103.242.134[.]243**\n**City:** **Hanshan**\n\n**Country:** **China**\n\n#### Version: 20160509 (alternate)\n\n**Exploit Document:** **beadf21b923600554b0ce54df42e78f5**\n\n\n-----\n\n**Payload DLL Exports**\n**SSSS 0x100080b0**\n**SvcMain 0x10008b80**\n**cfsUpdate 0x10008880**\n\nDuring our research we encountered another sample of the 20160509 version of KeyBoy. This sample was also\nfound to be deployed using the CVE-2012-0158 vulnerability. The malware payload was identical to our first\nParliamentary sample outlined in Part 1, however the configuration file in this alternate sample was different.\n\n#### Configuration\n\n**Identity Code: 9876543210**\n**C2 Host/IP #1:**\n**116.193.154[.]69**\n**C2 Host/IP #2:**\n**116.193.154[.]69**\n**C2 Host/IP #3:**\n**116.193.154[.]69**\n**C2 Port #1:443**\n**C2 Port #2:80**\n**C2 Port #3:443**\n**Password:8888**\n**Campaign ID:8888**\n\n#### Possible Targeting\n\nThe exploit document carrying this alternate KeyBoy configuration also used a decoy document which was\ndisplayed to the user after the exploit launched. This decoy carries content with a Tibetan nexus.\n\n#### Infrastructure\n\n**C2 Host: 116.193.154[.]69**\n**CNAME: 116-193-154-**\n**69.pacswitch.net**\n\n## Appendix D: IOCs and Links\n\n**KeyBoy binaries**\n**agewkassif: 087bffa8a570079948310dc9731c5709**\n**20160509: 495adb1b9777002ecfe22aaf52fcee93**\n**P_20150313: 0c7e55509e0b6d4277b3facf864af018**\n**20151108 (32bit):**\n**c5b5f01ba24d6c02636388809f44472e**\n**20151108 (64bit):**\n**371bc132499f455f06fa80696db0df27**\n**Droppers**\n\n\n-----\n\n**0b4d45db323f68b465ae052d3a872068**\n**23d284245e53ae4fe05c517d807ffccf**\n**98977426d544bd145979f65f0322ae30**\n**Exploit Documents**\n\n**8307e444cad98b1b59568ad2eba5f201 (used in August Parliamentary campaign)**\n**913b82ff8f090670fc6387e3a7bea12d (used in October Parliamentary**\n**campaign)**\n**05b5cf94f07fee666eb086c91182ad25**\n**8846d109b457a2ee44ddbf54d1cf7944**\n**beadf21b923600554b0ce54df42e78f5**\n**C2 Hosts**\n\n**www.about.jkub[.]com**\n**www.eleven.mypop3[.]org**\n**www.backus.myftp[.]name**\n**tibetvoices[.]com**\n**103.242.134[.]243**\n**116.193.154[.]69**\n**103.40.102[.]233**\n**45.125.12[.]147**\n\n## Resources\n\n[Keyboy Network Communication Encoding Details](https://citizenlab.org/wp-content/uploads/2016/11/keyboy-network-comm.pdf)\n\n[Configuration File Decoder](https://github.com/citizenlab/malware-indicators/blob/master/201611_KeyBoy/kb_configDecode.py)\n\n[C2 Decoder](https://github.com/citizenlab/malware-indicators/blob/master/201611_KeyBoy/kb_c2Decode.py)\n\n[YARA Signatures](https://github.com/citizenlab/malware-indicators/tree/master/201611_KeyBoy)\n\n[Indicators of Compromise](https://github.com/citizenlab/malware-indicators/tree/master/201611_KeyBoy)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "d63ae2b7-445f-460d-965d-2676dacdb6de",
            "created_at": "2022-10-25T15:59:19.552139Z",
            "updated_at": "2022-10-25T15:59:19.552139Z",
            "deleted_at": null,
            "name": "APTnotes",
            "url": "https://github.com/aptnotes/data",
            "description": "APTnotes data",
            "reports": null
        }
    ],
    "references": [
        "https://app.box.com/s/q7rywbgt6s5c380vvjpk643ppcdtdl8v"
    ],
    "report_names": [
        "Citizenlab_KeyBoy-targeting-Tibetan-Community(11-17-2016)"
    ],
    "threat_actors": [
        {
            "id": "f74e4fe6-6281-45e7-8866-0ff4316381cc",
            "created_at": "2024-05-01T02:03:07.959101Z",
            "updated_at": "2025-03-27T02:05:17.270819Z",
            "deleted_at": null,
            "main_name": "BRONZE HOBART",
            "aliases": [
                "Pirate Panda ",
                "Tropic Trooper ",
                "KeyBoy "
            ],
            "source_name": "Secureworks:BRONZE HOBART",
            "tools": [
                " KeyBoy",
                " Pfine",
                "DSNGInstaller"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "61ea51ed-a419-4b05-9241-5ab0dbba25fc",
            "created_at": "2023-01-06T13:46:38.354607Z",
            "updated_at": "2025-03-27T02:00:02.81258Z",
            "deleted_at": null,
            "main_name": "APT23",
            "aliases": [
                "KeyBoy",
                "Tropic Trooper",
                "BRONZE HOBART",
                "G0081",
                "Red Orthrus",
                "Earth Centaur",
                "PIRATE PANDA"
            ],
            "source_name": "MISPGALAXY:APT23",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "8941e146-3e7f-4b4e-9b66-c2da052ee6df",
            "created_at": "2023-01-06T13:46:38.402513Z",
            "updated_at": "2025-03-27T02:00:02.824555Z",
            "deleted_at": null,
            "main_name": "Sandworm",
            "aliases": [
                "G0034",
                "IRIDIUM",
                "Blue Echidna",
                "FROZENBARENTS",
                "Seashell Blizzard",
                "IRON VIKING",
                "ELECTRUM",
                "TeleBots",
                "UAC-0113",
                "UAC-0082",
                "APT44",
                "Quedagh",
                "VOODOO BEAR",
                "TEMP.Noble"
            ],
            "source_name": "MISPGALAXY:Sandworm",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "bef7800a-a08f-4e21-b65c-4279c851e572",
            "created_at": "2022-10-25T15:50:23.409336Z",
            "updated_at": "2025-03-27T02:00:55.463048Z",
            "deleted_at": null,
            "main_name": "Tropic Trooper",
            "aliases": [
                "Tropic Trooper",
                "Pirate Panda",
                "KeyBoy"
            ],
            "source_name": "MITRE:Tropic Trooper",
            "tools": [
                "USBferry",
                "ShadowPad",
                "PoisonIvy",
                "BITSAdmin",
                "YAHOYAH",
                "KeyBoy"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "578f8e62-2bb4-4ce4-a8b7-6c868fa29724",
            "created_at": "2022-10-25T16:07:24.344358Z",
            "updated_at": "2025-03-27T02:02:10.182282Z",
            "deleted_at": null,
            "main_name": "Tropic Trooper",
            "aliases": [
                "APT 23",
                "Bronze Hobart",
                "Earth Centaur",
                "KeyBoy",
                "Operation Tropic Trooper",
                "Pirate Panda",
                "Tropic Trooper"
            ],
            "source_name": "ETDA:Tropic Trooper",
            "tools": [
                "8.t Dropper",
                "8.t RTF exploit builder",
                "8t_dropper",
                "ByPassGodzilla",
                "CHINACHOPPER",
                "CREDRIVER",
                "China Chopper",
                "Chymine",
                "Darkmoon",
                "Gen:Trojan.Heur.PT",
                "KeyBoy",
                "Neo-reGeorg",
                "PCShare",
                "POISONPLUG.SHADOW",
                "Poison Ivy",
                "RoyalRoad",
                "SPIVY",
                "ShadowPad Winnti",
                "SinoChopper",
                "Swor",
                "TSSL",
                "USBferry",
                "W32/Seeav",
                "Winsloader",
                "XShellGhost",
                "Yahoyah",
                "fscan",
                "pivy",
                "poisonivy"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "7bd810cb-d674-4763-86eb-2cc182d24ea0",
            "created_at": "2022-10-25T16:07:24.1537Z",
            "updated_at": "2025-03-27T02:02:10.126127Z",
            "deleted_at": null,
            "main_name": "Sandworm Team",
            "aliases": [
                "APT 44",
                "ATK 14",
                "BE2",
                "Blue Echidna",
                "CTG-7263",
                "FROZENBARENTS",
                "IRIDIUM",
                "Iron Viking",
                "Quedagh",
                "Sandworm",
                "Sandworm Team",
                "Seashell Blizzard",
                "TEMP.Noble",
                "UAC-0082",
                "UAC-0113",
                "UAC-0125",
                "UAC-0133",
                "Voodoo Bear"
            ],
            "source_name": "ETDA:Sandworm Team",
            "tools": [
                "AWFULSHRED",
                "ArguePatch",
                "BIASBOAT",
                "Black Energy",
                "BlackEnergy",
                "CaddyWiper",
                "Colibri Loader",
                "Cyclops Blink",
                "CyclopsBlink",
                "DCRat",
                "DarkCrystal RAT",
                "Fobushell",
                "GOSSIPFLOW",
                "Gcat",
                "IcyWell",
                "Industroyer2",
                "JaguarBlade",
                "JuicyPotato",
                "Kapeka",
                "KillDisk.NCX",
                "LOADGRIP",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "ORCSHRED",
                "P.A.S.",
                "PassKillDisk",
                "Pitvotnacci",
                "PsList",
                "QUEUESEED",
                "RansomBoggs",
                "RottenPotato",
                "SOLOSHRED",
                "SwiftSlicer",
                "VPNFilter",
                "Warzone",
                "Warzone RAT",
                "Weevly"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "c39b0fe6-5642-4717-9a05-9e94265e3e3a",
            "created_at": "2022-10-25T16:07:24.332084Z",
            "updated_at": "2025-03-27T02:02:10.175452Z",
            "deleted_at": null,
            "main_name": "Tonto Team",
            "aliases": [
                "Bronze Huntley",
                "CactusPete",
                "Earth Akhlut",
                "HartBeat",
                "Karma Panda",
                "LoneRanger",
                "Operation Bitter Biscuit",
                "TAG-74",
                "Tonto Team"
            ],
            "source_name": "ETDA:Tonto Team",
            "tools": [
                "8.t Dropper",
                "8.t RTF exploit builder",
                "8t_dropper",
                "Bioazih",
                "Bisonal",
                "CONIME",
                "Dexbia",
                "Korlia",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "Mimikatz",
                "POISONPLUG.SHADOW",
                "RoyalRoad",
                "ShadowPad Winnti",
                "XShellGhost"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1666716503,
    "ts_updated_at": 1743041825,
    "ts_creation_date": 1483167401,
    "ts_modification_date": 0,
    "files": {
        "pdf": "https://archive.orkl.eu/1c664e6ab6a1e36fb0a1dccb231acfb26e943b19.pdf",
        "text": "https://archive.orkl.eu/1c664e6ab6a1e36fb0a1dccb231acfb26e943b19.txt",
        "img": "https://archive.orkl.eu/1c664e6ab6a1e36fb0a1dccb231acfb26e943b19.jpg"
    }
}