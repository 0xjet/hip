{
    "id": "80e9ba5f-7103-43b2-9dd1-6f2985f5c0de",
    "created_at": "2023-01-12T15:08:05.951521Z",
    "updated_at": "2025-03-27T02:09:29.729282Z",
    "deleted_at": null,
    "sha1_hash": "a4a24e8772ba850a95fdaf66fb9ed507853b58e9",
    "title": "2018-08-28 - The rise of mobile banker Asacub",
    "authors": "",
    "file_creation_date": "2022-05-28T19:30:52Z",
    "file_modification_date": "2022-05-28T19:30:52Z",
    "file_size": 934760,
    "plain_text": "# The rise of mobile banker Asacub\n\n**securelist.com/the-rise-of-mobile-banker-asacub/87591/**\n\nAuthors\n\n[Tatyana Shishkova](https://securelist.com/author/tatyanashishkova/)\n\nWe encountered the Trojan-Banker.AndroidOS.Asacub family for the first time in 2015, when the first versions of the malware were detected,\n[analyzed, and found to be more adept at spying than stealing funds. The Trojan has evolved since then, aided by a large-scale distribution](https://securelist.com/the-asacub-trojan-from-spyware-to-banking-malware/73211/)\ncampaign by its creators (in spring-summer 2017), helping Asacub to claim top spots in last year’s ranking by number of attacks among\nmobile banking Trojans, outperforming other families such as Svpeng and Faketoken.\n\nWe decided to take a peek under the hood of a modern member of the Asacub family. Our eyes fell on the latest version of the Trojan, which is\ndesigned to steal money from owners of Android devices connected to the mobile banking service of one of Russia’s largest banks.\n\n## Asacub versions\n\nSewn into the body of the Trojan is the version number, consisting of two or three digits separated by periods. The numbering seems to have\nstarted anew after the version 9.\n\nThe name Asacub appeared with version 4 in late 2015; previous versions were known as Trojan-SMS.AndroidOS.Smaps. Versions 5.X.X8.X.X were active in 2016, and versions 9.X.X-1.X.X in 2017. In 2018, the most actively distributed versions were 5.0.0 and 5.0.3.\n\n## Communication with C&C\n\nAlthough Asacub’s capabilities gradually evolved, its network behavior and method of communication with the command-and-control (C&C)\nserver changed little. This strongly suggested that the banking Trojans, despite differing in terms of capability, belong to the same family.\n\nData was always sent to the C&C server via HTTP in the body of a POST request in encrypted form to the relative address\n/something/index.php. In earlier versions, the something part of the relative path was a partially intelligible, yet random mix of words and short\ncombinations of letters and numbers separated by an underscore, for example, “bee_bomb” or “my_te2_mms”.\n\n\n-----\n\n_Example of traffic from an early version of Asacub (2015)_\n\nThe data transmitted and received is encrypted with the RC4 algorithm and encoded using the base64 standard. The C&C address and the\nencryption key (one for different modifications in versions 4.x and 5.x, and distinct for different C&Cs in later versions) are stitched into the\nbody of the Trojan. In early versions of Asacub, .com, .biz, .info, .in, .pw were used as top-level domains. In the 2016 version, the value of the\nUser-Agent header changed, as did the method of generating the relative path in the URL: now the part before /index.php is a mix of a\npronounceable (if not entirely meaningful) word and random letters and numbers, for example, “muromec280j9tqeyjy5sm1qy71” or\n“parabbelumf8jgybdd6w0qa0”. Moreover, incoming traffic from the C&C server began to use gzip compression, and the top-level domain for all\nC&Cs was .com:\n\nSince December 2016, the changes in C&C communication methods have affected only how the relative path in the URL is generated: the\npronounceable word was replaced by a rather long random combination of letters and numbers, for example, “ozvi4malen7dwdh” or\n“f29u8oi77024clufhw1u5ws62”. At the time of writing this article, no other significant changes in Asacub’s network behavior had been\nobserved:\n\n## The origin of Asacub\n\nIt is fairly safe to say that the Asacub family evolved from Trojan-SMS.AndroidOS.Smaps. Communication between both Trojans and their\nC&C servers is based on the same principle, the relative addresses to which Trojans send network requests are generated in a similar\nmanner, and the set of possible commands that the two Trojans can perform also overlaps. What’s more, the numbering of Asacub versions is\na continuation of the Smaps system. The main difference is that Smaps transmits data as plain text, while Asacub encrypts data with the RC4\nalgorithm and then encodes it into base64 format.\n\nLet’s compare examples of traffic from Smaps and Asacub — an initializing request to the C&C server with information about the infected\ndevice and a response from the server with a command for execution:\n\n\n-----\n\n_Smaps request_\n\n_Asacub request_\n\nDecrypted data from Asacub traffic:\n\n{“id”:”532bf15a-b784-47e5-92fa-72198a2929f5″,”type”:”get”,”info”:”imei:365548770159066, country:PL, cell:Tele2, android:4.2.2, model:GTN5100, phonenumber:+486679225120, sim:6337076348906359089f, app:null, ver:5.0.2″}\n\n_Data sent to the server_\n\n[{“command”:”sent&&&”,”params”:{“to”:”+79262000900″,”body”:”\\u0410\\u0412\\u0422\\u041e\\u041f\\u041b\\u0410\\u0422\\u0415\\u0416 1000\n50″,”timestamp”:”1452272572″}},\n{“command”:”sent&&&”,”params”:{“to”:”+79262000900″,”body”:”BALANCE”,”timestamp”:”1452272573″}}]\n\n_Instructions received from the server_\n\nA comparison can also be made of the format in which Asacub and Smaps forward incoming SMS (encoded with the base64 algorithm) from\nthe device to the C&C server:\n\n\n-----\n\n_Smaps format_\n\n_Asacub format_\n\nDecrypted data from Asacub traffic:\n\n{“data”:”2015:10:14_02:41:15″,”id”:”532bf15a-b784-47e5-92fa72198a2929f5″,”text”:”SSB0aG91Z2h0IHdlIGdvdCBwYXN0IHRoaXMhISBJJ20gbm90IGh1bmdyeSBhbmQgbmU=”,”number”:”1790″,”type”:”load”}\n\n## Propagation\n\nThe banking Trojan is propagated via phishing SMS containing a link and an offer to view a photo or MMS. The link points to a web page with\na similar sentence and a button for downloading the APK file of the Trojan to the device.\n\n\n-----\n\n_j_\n\nAsacub masquerades under the guise of an MMS app or a client of a popular free ads service. We came across the names Photo, Message,\nAvito Offer, and MMS Message.\n\n_App icons under which Asacub masks itself_\n\nThe APK files of the Trojan are downloaded from sites such as mmsprivate[.]site, photolike[.]fun, you-foto[.]site, and mms4you[.]me under\nnames in the format:\n\n_photo_[number]_img.apk,_\n_mms_[number]_img.apk_\n_avito_[number].apk,_\n_mms.img_[number]_photo.apk,_\n_mms[number]_photo.image.apk,_\n_mms[number]_photo.img.apk,_\n_mms.img.photo_[number].apk,_\n_photo_[number]_obmen.img.apk._\n\nFor the Trojan to install, the user must allow installation of apps from unknown sources in the device settings.\n\n## Infection\n\nDuring installation, depending on the version of the Trojan, Asacub prompts the user either for Device Administrator rights or for permission to\nuse AccessibilityService. After receiving the rights, it sets itself as the default SMS app and disappears from the device screen. If the user\nignores or rejects the request, the window reopens every few seconds.\n\n\n-----\n\n_The Trojan requests Device Administrator rights_\n\n\n-----\n\n_The Trojan requests permission to use AccessibilityService_\n\nAfter installation, the Trojan starts communicating with the cybercriminals’ C&C server. All data is transmitted in JSON format (after\ndecryption). It includes information about the smartphone model, the OS version, the mobile operator, and the Trojan version.\n\nLet’s take an in-depth look at Asacub 5.0.3, the most widespread version in 2018.\n\nStructure of data sent to the server:\n\n\n1\n\n2\n\n3\n\n4\n\n5\n\n6\n\n7\n\n\n{\n\n\"type\":int,\n\n\"data\":{\n\ndata\n\n},\n\n\"id\":hex\n\n}\n\n\nStructure of data received from the server:\n\n\n-----\n\n1\n\n2\n\n3\n\n4\n\n5\n\n6\n\n7\n\n8\n\n9\n\n\n{\n\n\"command\":int,\n\n\"params\":{\n\nparams,\n\n\"timestamp\":int,\n\n\"x\":int\n\n},\n\n\"waitrun\":int\n\n}\n\n\nTo begin with, the Trojan sends information about the device to the server:\n\n\n1\n\n2\n\n3\n\n4\n\n5\n\n6\n\n7\n\n8\n\n9\n\n10\n\n11\n\n12\n\n13\n\n\n{\n\n\"type\":1,\n\n\"data\":{\n\n\"model\":string,\n\n\"ver\":\"5.0.3\",\n\n\"android\":string,\n\n\"cell\":string,\n\n\"x\":int,\n\n\"country\":int, //optional\n\n\"imei\":int //optional\n\n},\n\n\"id\":hex\n\n}\n\n\nIn response, the server sends the code of the command for execution (“command”), its parameters (“params”), and the time delay before\nexecution (“waitrun” in milliseconds).\n\nList of commands sewn into the body of the Trojan:\n\n\nCommand\ncode\n\n\nParameters Actions\n\n\n2 – Sending a list of contacts from the address book of the infected device to the C&C server\n\n7 “to”:int Calling the specified number\n\n\n11 “to”:int,\n“body”:string\n\n19 “text”:string,\n“n”:string\n\n\nSending an SMS with the specified text to the specified number\n\nSending SMS with the specified text to numbers from the address book of the infected device, with the name of\nthe addressee from the address book substituted into the message text\n\n\n40 “text”:string Shutting down applications with specific names (antivirus and banking applications)\n\nThe set of possible commands is the most significant difference between the various flavors of Asacub. In the 2015-early 2016 versions\n[examined in this article, C&C instructions in JSON format contained the name of the command in text form (“get_sms”, “block_phone”). In later](https://securelist.com/the-asacub-trojan-from-spyware-to-banking-malware/73211/)\nversions, instead of the name of the command, its numerical code was transmitted. The same numerical code corresponded to one command\nin different versions, but the set of supported commands varied. For example, version 9.0.7 (2017) featured the following set of commands: 2,\n4, 8, 11, 12, 15, 16, 17, 18, 19, 20.\n\nAfter receiving the command, the Trojan attempts to execute it, before informing C&C of the execution status and any data received. The “id”\nvalue inside the “data” block is equal to the “timestamp” value of the relevant command:\n\n\n-----\n\n1\n\n2\n\n3\n\n4\n\n5\n\n6\n\n7\n\n8\n\n9\n\n10\n\n11\n\n\n{\n\n\"type\":3,\n\n\"data\":{\n\n\"data\":JSONArray,\n\n\"command\":int,\n\n\"id\":int,\n\n\"post\":boolean,\n\n\"status\":resultCode\n\n},\n\n\"id\":hex\n\n}\n\n\nIn addition, the Trojan sets itself as the default SMS application and, on receiving a new SMS, forwards the sender’s number and the message\ntext in base64 format to the cybercriminal:\n\n\n1\n\n2\n\n3\n\n4\n\n5\n\n6\n\n7\n\n8\n\n\n{\n\n\"type\":2,\n\n\"data\":{\n\n\"n\":string,\n\n\"t\":string\n\n},\n\n\"id\":hex\n\n}\n\n\nThus, Asacub can withdraw funds from a bank card linked to the phone by sending SMS for the transfer of funds to another account using the\nnumber of the card or mobile phone. Moreover, the Trojan intercepts SMS from the bank that contain one-time passwords and information\nabout the balance of the linked bank card. Some versions of the Trojan can autonomously retrieve confirmation codes from such SMS and\nsend them to the required number. What’s more, the user cannot check the balance via mobile banking or change any settings there, because\nafter receiving the command with code 40, the Trojan prevents the banking app from running on the phone.\n\nUser messages created by the Trojan during installation typically contain grammatical and spelling errors, and use a mixture of Cyrillic and\nLatin characters.\n\nThe Trojan also employs various obfuscation methods: from the simplest, such as string concatenation and renaming of classes and methods,\nto implementing functions in native code and embedding SO libraries in C/C++ in the APK file, which requires the use of additional tools or\ndynamic analysis for deobfuscation, since most tools for static analysis of Android apps support only Dalvik bytecode. In some versions of\nAsacub, strings in the app are encrypted using the same algorithm as data sent to C&C, but with different keys.\n\n_Example of using native code for obfuscation_\n\n\n-----\n\n_Examples of using string concatenation for obfuscation_\n\n_Example of encrypting strings in the Trojan_\n\n## Asacub distribution geography\n\nAsacub is primarily aimed at Russian users: 98% of infections (225,000) occur in Russia, since the cybercriminals specifically target clients of\na major Russian bank. The Trojan also hit users from Ukraine, Turkey, Germany, Belarus, Poland, Armenia, Kazakhstan, the US, and other\ncountries.\n\n## Conclusion\n\nThe case of Asacub shows that mobile malware can function for several years with minimal changes to the distribution scheme.\n\nIt is basically SMS spam: many people still follow suspicious links, install software from third-party sources, and give permissions to apps\nwithout a second thought. At the same time, cybercriminals are reluctant to change the method of communication with the C&C server, since\nthis would require more effort and reap less benefit than modifying the executable file. The most significant change in this particular Trojan’s\nhistory was the encryption of data sent between the device and C&C. That said, so as to hinder detection of new versions, the Trojan’s APK\nfile and the C&C server domains are changed regularly, and the Trojan download links are often one-time-use.\n\n### IOCs\n\nC&C IP addresses:\n\n155.133.82.181\n155.133.82.240\n155.133.82.244\n185.234.218.59\n195.22.126.160\n195.22.126.163\n195.22.126.80\n195.22.126.81\n5.45.73.24\n5.45.74.130\n\nIP addresses from which the Trojan was downloaded:\n\n185.174.173.31\n185.234.218.59\n188.166.156.110\n195.22.126.160\n195.22.126.80\n195.22.126.81\n195.22.126.82\n195.22.126.83\n\nSHA256:\n\n\n-----\n\n158c7688877853ffedb572ccaa8aa9eff47fa379338151f486e46d8983ce1b67\n3aedbe7057130cf359b9b57fa533c2b85bab9612c34697585497734530e7457d\nf3ae6762df3f2c56b3fe598a9e3ff96ddf878c553be95bacbd192bd14debd637\ndf61a75b7cfa128d4912e5cb648cfc504a8e7b25f6c83ed19194905fef8624c8\nc0cfd462ab21f6798e962515ac0c15a92036edd3e2e63639263bf2fd2a10c184\nd791e0ce494104e2ae0092bb4adc398ce740fef28fa2280840ae7f61d4734514\n38dcec47e2f4471b032a8872ca695044ddf0c61b9e8d37274147158f689d65b9\n27cea60e23b0f62b4b131da29fdda916bc4539c34bb142fb6d3f8bb82380fe4c\n31edacd064debdae892ab0bc788091c58a03808997e11b6c46a6a5de493ed25d\n87ffec0fe0e7a83e6433694d7f24cfde2f70fc45800aa2acb8e816ceba428951\neabc604fe6b5943187c12b8635755c303c450f718cc0c8e561df22a27264f101\n\n[Financial malware](https://securelist.com/tag/financial-malware/)\n[Malware Descriptions](https://securelist.com/tag/malware-descriptions/)\n[Trojan Banker](https://securelist.com/tag/trojan-banker/)\n\nAuthors\n\n[Tatyana Shishkova](https://securelist.com/author/tatyanashishkova/)\n\nThe rise of mobile banker Asacub\n\nYour email address will not be published. Required fields are marked *\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2018/2018-08-28 - The rise of mobile banker Asacub.pdf"
    ],
    "report_names": [
        "2018-08-28 - The rise of mobile banker Asacub.pdf"
    ],
    "threat_actors": [
        {
            "id": "aa73cd6a-868c-4ae4-a5b2-7cb2c5ad1e9d",
            "created_at": "2022-10-25T16:07:24.139848Z",
            "updated_at": "2025-03-27T02:02:10.120505Z",
            "deleted_at": null,
            "main_name": "Safe",
            "aliases": [],
            "source_name": "ETDA:Safe",
            "tools": [
                "DebugView",
                "LZ77",
                "OpenDoc",
                "SafeDisk",
                "TypeConfig",
                "UPXShell",
                "UsbDoc",
                "UsbExe"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673536085,
    "ts_updated_at": 1743041369,
    "ts_creation_date": 1653766252,
    "ts_modification_date": 1653766252,
    "files": {
        "pdf": "https://archive.orkl.eu/a4a24e8772ba850a95fdaf66fb9ed507853b58e9.pdf",
        "text": "https://archive.orkl.eu/a4a24e8772ba850a95fdaf66fb9ed507853b58e9.txt",
        "img": "https://archive.orkl.eu/a4a24e8772ba850a95fdaf66fb9ed507853b58e9.jpg"
    }
}