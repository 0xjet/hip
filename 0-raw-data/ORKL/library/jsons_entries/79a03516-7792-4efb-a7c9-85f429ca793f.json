{
    "id": "79a03516-7792-4efb-a7c9-85f429ca793f",
    "created_at": "2023-01-12T15:07:05.8762Z",
    "updated_at": "2025-03-27T02:06:08.904112Z",
    "deleted_at": null,
    "sha1_hash": "4c25a41de54ec1852437f5bd1e7d09a888a67612",
    "title": "2016-01-29 - From Linux to Windows – New Family of Cross-Platform Desktop Backdoors Discovered",
    "authors": "",
    "file_creation_date": "2022-05-28T17:08:52Z",
    "file_modification_date": "2022-05-28T17:08:52Z",
    "file_size": 1096582,
    "plain_text": "# From Linux to Windows – New Family of Cross-Platform Desktop Backdoors Discovered\n\n**[securelist.com/from-linux-to-windows-new-family-of-cross-platform-desktop-backdoors-discovered/73503/](https://securelist.com/from-linux-to-windows-new-family-of-cross-platform-desktop-backdoors-discovered/73503/)**\n\n[Malware descriptions](https://securelist.com/category/malware-descriptions/)\n\n[Malware descriptions](https://securelist.com/category/malware-descriptions/)\n\n29 Jan 2016\n\nminute read\n\n\n-----\n\nAuthors\n\n## Background\n\n\nStefan Ortloff\n\n\nRecently we came across a new family of cross-platform backdoors for desktop\nenvironments. First we got the Linux variant, and with information extracted from its binary,\nwe were able to find the variant for Windows desktops, too. Not only that, but the Windows\nversion was additionally equipped with a valid code signing signature. Let´s have a look at\nboth of them.\n\n## DropboxCache aka Backdoor.Linux.Mokes.a\n\nThis backdoor for Linux-based operating systems comes packed via UPX and is full of\nfeatures to monitor the victim’s activities, including code to capture audio and take\nscreenshots.\n\nAfter its first execution, the binary checks its own file path and, if necessary, copies itself to\none of the following locations:\n\n\n-----\n\n$HOME/$QT-GenericDataLocation/.mozilla/firefox/profiled\n$HOME/$QT-GenericDataLocation/.dropbox/DropboxCache\n\nOne example would be this location: $HOME/.local/share/.dropbox/DropboxCache. To\nachieve persistence, it uses this not very stealthy method: it just creates a .desktop-file in\n$HOME/.config/autostart/$filename.desktop. Here’s the template for this:\n\nNext, it connects to its hardcoded C&C Server. From this point, it performs an http request\nevery minute:\n\nThis “heartbeat” request replies with a one-byte image. To upload and receive data and\ncommands, it connects to TCP port 433 using a custom protocol and AES encryption. The\nbinary comes with the following hardcoded public keys:\n\nThe malware then collects gathered information from the keylogger, audio captures and\nscreenshots in /tmp/. Later it will upload collected data to the C&C.\n\n\n-----\n\n/tmp/ss0-DDMMyy-HHmmss-nnn.sst (Screenshots, JPEG, every 30 sec.)\n/tmp/aa0-DDMMyy-HHmmss-nnn.aat (Audiocaptures, WAV)\n/tmp/kk0-DDMMyy-HHmmss-nnn.kkt (Keylogs)\n/tmp/dd0-DDMMyy-HHmmss-nnn.ddt (Arbitrary Data)\n\nDDMMyy = date: 280116 = 2016-01-28\nHHmmss = time: 154411 = 15:44:11\nnnn = milliseconds.\n\nThis part of the code is able to capture audio from the victim’s box.\n\nHowever, audio capturing is not activated in the event timer of this binary, just like the\nkeylogging feature. Since the authors have statically linked libqt, xkbcommon (the library to\nhandle keyboard descriptions) and OpenSSL (1.0.2c) to the binary, the size of the binary is\nover 13MB. The criminals also didn’t make any effort to obfuscate the binary in any way. In\nfact, the binary contains almost all symbols, which is very useful during analysis.\n\n\n-----\n\nThere are also references to the author’s source files:\n\n\n-----\n\nApparently, it’s written in C++ and Qt, a cross-platform application framework. According to\nthe binary’s metadata it was compiled using “GCC 4.8.4 (Ubuntu 4.8.4-2ubuntu1~14.04)” on\nUbuntu 14.04 LTS “Trusty Tahr”. According to the qt_instdate timestamp, the last time the Qt\n[sources were configured was on 2015-09-26 (qt/qtbase.git: deprecated), which implies](http://code.qt.io/cgit/qt/qtbase.git/commit/?id=db631a88a030d4d1263d7ae009086f3dd8637982)\nthe compilation time of the malware to be not earlier than end of September 2015.\n\nWe detect this type of malware as Backdoor.Linux.Mokes.a.\n\n## OLMyJuxM.exe aka Backdoor.Win32.Mokes.imv\n\nJust a few days ago, we came across a rather familiar looking sample, although it was\ncompiled for machines running Microsoft Windows. It quickly turned out to be a 32-bit\nWindows variant of Backdoor.Linux.Mokes.a.\n\nAfter execution, the malware randomly chooses one of nine different locations in\n%AppData% to persistently install itself on the machine. The binary also creates a “version”file in the same folder. As its name implies, it stores just version information, together with\nthe full installation path of the malware itself:\n\n\n-----\n\nThen the corresponding registry keys are created in\nHKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run to ensure persistence in the system.\n\n[After the malware has executed its own copy in the new location, the SetWindowsHook API](https://docs.microsoft.com/en-us/windows/win32/winmsg/about-hooks)\nis utilized to establish keylogger functionality and to monitor mouse inputs and internal\nmessages posted to the message queue.\n\nThe next stage in its operation is to contact the hardcoded C&C server. Besides the different\nIP addresses and encryption key, we see almost identical behavior.\n\nHowever, this particular variant uses a slightly different implementation and tries to obtain the\ndefault Windows user-agent string.\n\n\n-----\n\nIf this is not successful, the sample uses its hardcoded version:\n\nLike the Linux variant, it connects to its C&C server in the same way: once per minute it\nsends a heartbeat signal via HTTP (GET /v1). To retrieve commands or to upload or\ndownload additional resources, it uses TCP Port 433.\n\nIt uses almost the same filename templates to save the obtained screenshots,\naudiocaptures, keylogs and other arbitrary data. Unlike the Linux variant, in this sample the\nkeylogger is active. Below you can see the content of a keystroke logfile, located in\n%TEMP% and created by this sample:\n\n\n-----\n\nAnd again, we spotted some unexpected code. The following screenshot shows references\nto code which is able to capture images from a connected camera, such as a built-in\nwebcam.\n\nSimilar to the Linux version, the author left quite a number of suspicious strings in the binary.\nThe following string is surprisingly honest.\n\n\n-----\n\nFrom the criminal’s point of view, it’s important that the software looks legitimate and that\nWindows doesn’t asks the user for confirmation prior to execution of unknown software. On\nWindows machines this can be achieved by using Trusted Code Signing Certificates. In this\nparticular case, the criminal managed to sign the binary with a trusted certificate from\n“COMODO RSA Code Signing CA”.\n\n\n-----\n\nWe detect this type of malware as Backdoor.Win32.Mokes.imv.\n\n## What’s next\n\nSince this software was intentionally designed to be platform independent, we might see also\ncorresponding Mac OS X samples in the future. Update: We found it. See Update section\n**below.**\n\n## Update\n\n(2016-02-01 10:45 UTC): We just got Backdoor.Win32.Mokes.imw. This is the first time we\nsee a variant of Mokes, which comes with the audio capture module activated. The malware\ncreates a new audio file every 5 minutes.\n\n\n-----\n\n(2016-09-07 13:19 UTC): We just come across the OS X variant of this malware and posted\nan analysis on this blog.\n\n## IOCs\n\n### Backdoor.Linux.Mokes.a\n\nc9e0e5e2aeaecb232120e8573e97a6b8\n\n$HOME/$QT-GenericDataLocation/.mozilla/firefox/profiled\n\n$HOME/$QT-GenericDataLocation/.dropbox/DropboxCache\n\n$HOME/.config/autostart/profiled.desktop\n\n$HOME/.config/autostart/DropboxCache.desktop\n\n/tmp/ss0-$date-$time-$ms.sst\n\n### Backdoor.Win32.Mokes.imv & .imw\n\nf2407fd12ec0d4f3e82484c027c7d149 (imw)\n\n91099aa413722d22aa50f85794ee386e (imv)\n\n%AppData%\\Skype\\SkypeHelper.exe\n\n%AppData%\\Skype\\version\n\n%AppData%\\Dropbox\\bin\\DropboxHelper.exe\n\n%AppData%\\Dropbox\\bin\\version\n\n%AppData%\\Google\\Chrome\\nacl32.exe\n\n%AppData%\\Google\\Chrome\\version\n\n%AppData%\\Google\\Chrome\\nacl64.exe\n\n%AppData%\\Google\\Chrome\\version\n\n%AppData%\\Mozilla\\Firefox\\mozillacache.exe\n\n%AppData%\\Mozilla\\Firefox\\version\n\n%AppData%\\Hewlett-Packard\\hpqcore.exe\n\n%AppData%\\Hewlett-Packard\\version\n\n%AppData%\\Hewlett-Packard\\hpprint.exe\n\n%AppData%\\Hewlett-Packard\\version\n\n%AppData%\\Hewlett-Packard\\hpscan.exe\n\n\n-----\n\n%AppData%\\Hewlett-Packard\\version\n%AppData%\\Adobe\\Acrobat\\AcroBroker.exe\n%AppData%\\Adobe\\Acrobat\\version\n\n%TEMP%\\aa$n-$date-$time-$ms.aat (imw)\nwhere $n is a decimal hash-value calculated from the soundcard’s name\n\n%TEMP%\\ss0-$date-$time-$ms.sst\n%TEMP%\\dd0-$date-$time-$ms.ddt\n%TEMP%\\kk$date.kkt\n\nHKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\n“%PERSISTENT-FILENAME%”, “%PERSISTENT-FILEPATH%”\n\nwhere %PERSISTENT-FILENAME% is one of the filenames above\nand %PERSISTENT-FILEPATH% is the corresponding path\n\n[Backdoor](https://securelist.com/tag/backdoor/)\n[Linux](https://securelist.com/tag/linux/)\n[Malware Descriptions](https://securelist.com/tag/malware-descriptions/)\n[Malware Technologies](https://securelist.com/tag/malware-technologies/)\n[Non-Windows Malware](https://securelist.com/tag/non-windows-malware/)\n\nAuthors\n\nStefan Ortloff\n\nFrom Linux to Windows – New Family of Cross-Platform Desktop Backdoors Discovered\n\nYour email address will not be published. Required fields are marked *\n\nGReAT webinars\n\nFrom the same authors\n\n\n-----\n\n### New wave of Mirai attacking home routers\n\n The Missing Piece – Sophisticated OS X Backdoor Discovered\n\n\n-----\n\n### Beware of Backdoored Linux Mint ISOs\n\n Shellshock and its early adopters\n\n Spammy Facebook friends from the neighborhood\n\n\n-----\n\nSubscribe to our weekly e mails\n\nThe hottest research right in your inbox\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2016/2016-01-29 - From Linux to Windows – New Family of Cross-Platform Desktop Backdoors Discovered.pdf"
    ],
    "report_names": [
        "2016-01-29 - From Linux to Windows – New Family of Cross-Platform Desktop Backdoors Discovered.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673536025,
    "ts_updated_at": 1743041168,
    "ts_creation_date": 1653757732,
    "ts_modification_date": 1653757732,
    "files": {
        "pdf": "https://archive.orkl.eu/4c25a41de54ec1852437f5bd1e7d09a888a67612.pdf",
        "text": "https://archive.orkl.eu/4c25a41de54ec1852437f5bd1e7d09a888a67612.txt",
        "img": "https://archive.orkl.eu/4c25a41de54ec1852437f5bd1e7d09a888a67612.jpg"
    }
}