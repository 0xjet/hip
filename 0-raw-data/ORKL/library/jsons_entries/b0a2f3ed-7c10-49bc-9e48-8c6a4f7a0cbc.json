{
    "id": "b0a2f3ed-7c10-49bc-9e48-8c6a4f7a0cbc",
    "created_at": "2023-01-12T15:00:27.909487Z",
    "updated_at": "2025-03-27T02:06:14.547604Z",
    "deleted_at": null,
    "sha1_hash": "845f6f5a8cc965197b36b37328a24bcf7b8daf93",
    "title": "2017-06-21 - Player 1 Limps Back Into the Ring - Hello again, Locky!",
    "authors": "",
    "file_creation_date": "2022-05-27T22:37:23Z",
    "file_modification_date": "2022-05-27T22:37:23Z",
    "file_size": 276505,
    "plain_text": "# Player 1 Limps Back Into the Ring - Hello again, Locky!\n\n**[blog.talosintelligence.com/2017/06/necurs-locky-campaign.html](http://blog.talosintelligence.com/2017/06/necurs-locky-campaign.html)**\n\nBack in May, the Necurs spam botnet jettisoned Locky ransomware in favor of the new Jaff\n[ransomware variant. However, earlier this month Kaspersky discovered a vulnerability within](https://www.bleepingcomputer.com/news/security/decrypted-kaspersky-releases-decryptor-for-the-jaff-ransomware/)\nJaff which allowed them to create a decryptor. This turn of events seems to have caused the\nmiscreants behind Necurs to scramble to distribute a different ransomware payload. Falling\nback on their old tricks, they have selected to re-distribute Locky ransomware. The malware\nis being transmitted via email using an .exe file encapsulated within two compressed .zip\narchives.\n\n## The Spam Campaign\n\nThe spam that is distributing this ransomware campaign is not significantly different from\n[other ransomware spam campaigns that we have seen from Necurs. Ransomware-oriented](http://blog.talosintelligence.com/2017/05/jaff-ransomware.html)\nspam campaigns from Necurs typically involve order confirmations, payment receipts,\nbusiness documents, and so on -- all with the common goal of social engineering victims into\nopening the attachment. The messages Talos observed in this particular campaign are\ndisguised as fake invoices.\n\n\n-----\n\nAn example spam message propagating Locky ransomware\n\nThe volume of Locky spam Necurs has sent since the start of this particular campaign is\nnotable. In the first hour of this campaign, Talos observed that Locky spam accounted for up\nto 7.2% of email volume on one of our systems. While the campaign has since decreased in\nthe number of messages being sent per minute, Necurs is still actively sending messages\ncontaining Locky, though only in small quantities.\n\nChart illustrating the volume of Locky spam as a percent of total email volume one of our\n\nsystems observed.\n\n\n-----\n\n## Locky's Metamorphosis\n\nAlthough they are using the same affiliate ID, for this particular round of Locky, the attackers\nhave altered their ransomware. We were unable to get the ransomware to encrypt data on\nany systems running an operating system more recent than Windows XP. Upon further\ninvestigation, we determined that on systems running Windows 7 or later with Data\nExecution Prevention (DEP) would cause the unpacker to fail. Our analysis suggests that\nLocky has now added anti-debugging protection to their configuration. Instead of unpacking\nthe configuration, when a debugger is detected their config pointer is directed at\nkernel32!AllocConsole, frustrating any attempts at analysis. In response to this new anti[analysis technique, Talos has updated LockyDump so that it is able to extract the](https://www.talosintelligence.com/lockydump)\nconfiguration information from this latest iteration.\n\nLocky's unpacker crashes when trying to execute stack memory on systems more recent\n\nthan Windows XP.\n\nAnother notable aspect of this latest campaign was the C2 URL structure. Adversaries\nbehind this latest Locky campaign have reused the /checkupdate path as part of the URL\n[structure -- the same URL structure found in previous Locky campaigns. This is perhaps](http://blog.talosintelligence.com/2017/04/locky-returns-necurs.html)\n\n\n-----\n\nanother indication that adversaries were hasty in their developing and distributing this\ncampaign.\n\nThreat Grid sandbox run illustrating Locky C2 communication\n\n## Conclusion\n\nThis updated version of Locky appears to have been hastily deployed, and as a result it has\nnot affected users running Windows operating systems other than Windows XP. The\nattackers behind this ransomware are likely already aware of this, so we can expect a fixed\nversion of Locky to appear in a future round of Necurs' ransomware spam.\n\nDespite sounding like a broken record, we at Talos feel it's our duty to re-iterate that it's\nalways risky clicking on links or opening attachments in strange email messages. Users that\nfail to heed this advice can easily become ransomware victims, and if the subsequent\nransom is paid, the monies will no doubt fund another round of attacks. As always,\norganizations are encouraged to make regular backups of their data, practice restoring said\ndata, and store your backups offline far out of the reach of potential criminals.\n\n## Coverage\n\nOpen Source Snort Subscriber Rule Set customers can stay up to date by downloading the\n[latest rule pack available for purchase on Snort.org.](https://www.snort.org/products)\n\nAdditional ways our customers can detect and block this threat are listed below.\n\n\n-----\n\n[Advanced Malware Protection (AMP) is ideally suited to prevent the execution of the](https://www.cisco.com/c/en/us/support/security/amp-firepower-software-license/tsd-products-support-series-home.html)\nmalware used by these threat actors.\n\n[CWS,](https://www.cisco.com/c/en/us/products/security/cloud-web-security/index.html) [WSA, and](https://www.cisco.com/c/en/us/products/security/web-security-appliance/index.html) [Umbrella can help identify hosts that have been compromised by Locky by](https://umbrella.cisco.com/)\ndetecting outbound C2 traffic.\n\n[Email Security can block malicious emails sent by threat actors as part of their campaign.](https://www.cisco.com/c/en/us/products/security/email-security-appliance/index.html)\n\n[Network Security appliances such as NGFW,](https://www.cisco.com/c/en/us/products/security/asa-next-generation-firewall-services/index.html) [NGIPS, and](https://www.cisco.com/c/en/us/products/security/intrusion-prevention-system-ips/index.html) [Meraki MX with Advanced](https://meraki.cisco.com/products/appliances)\nSecurity can detect malicious activity associated with this threat.\n\n[AMP Threat Grid helps identify malicious binaries and build protection into all Cisco Security](https://www.cisco.com/c/en/us/solutions/enterprise-networks/amp-threat-grid/index.html)\nproducts.\n\n[Stealthwatch detects network scanning activity, network propagation, and connections to](https://www.cisco.com/c/en/us/products/security/stealthwatch/index.html)\nCnC infrastructures, correlating this activity to alert administrators.\n\n## IOCs\n\n**SHA256**\n\n49184047c840287909cf0e6a5e00273c6d60da1750655ad66e219426b3cf9cd8\n3285c3f37aa192a173f62fee82f7a966a6df6e5db4642d63a6784f39a63012b6\n\n**File Extension for Files Encrypted by Locky**\n\n.loptr\n\n**Hard-coded Locky C2 URL**\n\nhxxp://185.115.140[.]170/checkupdate\n\n\n-----\n\n**Locky DGA C2s (20th/21st June - DGA seed 65123)**\n\nhxxp://emtsgdqsik[.]pl/checkupdate\nhxxp://tqathwvfaqfisj[.]pl/checkupdate\nhxxp://dqutujymgc[.]info/checkupdate\nhxxp://ddgtdcgoysuq[.]ru/checkupdate\nhxxp://lrsjplrlaceugxw[.]work/checkupdate\nhxxp://cstfxgujaf[.]biz/checkupdate\nhxxp://gcbdwbtshl[.]xyz/checkupdate\nhxxp://wxcjqfevrkosp[.]biz/checkupdate\nhxxp://hllfhiqwneuwwx[.]biz/checkupdate\nhxxp://agnfmqvhomsa[.]work/checkupdate\nhxxp://ythjvjhtgsfgesd[.]biz/checkupdate\nhxxp://kabssqyef[.]info/checkupdate\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2017/2017-06-21 - Player 1 Limps Back Into the Ring - Hello again, Locky!.pdf"
    ],
    "report_names": [
        "2017-06-21 - Player 1 Limps Back Into the Ring - Hello again, Locky!.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673535627,
    "ts_updated_at": 1743041174,
    "ts_creation_date": 1653691043,
    "ts_modification_date": 1653691043,
    "files": {
        "pdf": "https://archive.orkl.eu/845f6f5a8cc965197b36b37328a24bcf7b8daf93.pdf",
        "text": "https://archive.orkl.eu/845f6f5a8cc965197b36b37328a24bcf7b8daf93.txt",
        "img": "https://archive.orkl.eu/845f6f5a8cc965197b36b37328a24bcf7b8daf93.jpg"
    }
}