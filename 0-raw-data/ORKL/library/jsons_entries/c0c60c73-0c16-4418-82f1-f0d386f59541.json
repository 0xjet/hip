{
    "id": "c0c60c73-0c16-4418-82f1-f0d386f59541",
    "created_at": "2023-01-12T15:07:41.571211Z",
    "updated_at": "2025-03-27T02:05:50.925886Z",
    "deleted_at": null,
    "sha1_hash": "b4baed1b303a24d1a067b07dcc1bbfb84023b100",
    "title": "2021-01-13 - Analysis Report (AR21-013A)- Strengthening Security Configurations to Defend Against Attackers Targeting Cloud Services",
    "authors": "",
    "file_creation_date": "2022-05-29T01:06:02Z",
    "file_modification_date": "2022-05-29T01:06:02Z",
    "file_size": 106089,
    "plain_text": "# Strengthening Security Configurations to Defend Against Attackers Targeting Cloud Services\n\n**us-cert.cisa.gov/ncas/analysis-reports/ar21-013a**\n\n## Summary\n\n_This Analysis Report uses the MITRE Adversarial Tactics, Techniques, and Common_\n_Knowledge (ATT&CK®) framework. See the_ _[ATT&CK for Enterprise framework for all](https://attack.mitre.org/versions/v8/matrices/enterprise/)_\n_referenced threat actor tactics and techniques._\n\nThe Cybersecurity and Infrastructure Security Agency (CISA) is aware of several recent\nsuccessful cyberattacks against various organizations’ cloud services. Threat actors are\nusing phishing and other vectors to exploit poor cyber hygiene practices within a victims’\ncloud services configuration. The information in this report is derived exclusively from several\nCISA incident response engagements and provides the tactics, techniques, and procedures;\nindicators of compromise (IOCs) that CISA observed as part of these engagements; and\nrecommended mitigations for organization to strengthen their cloud environment\nconfiguration to protect against, detect, and respond to potential attacks.\n\n[For a downloadable copy of IOCs, see AR21-013A.stix.](https://us-cert.cisa.gov/sites/default/files/publications/AR21-013A.stix.xml)\n\n**Note: the activity and information in this Analysis Report is not explicitly tied to any one**\nthreat actor or known to be specifically associated with the advanced persistent threat actor\nattributed with the compromise of SolarWinds Orion Platform software and other recent\nactivity.\n\n## Description\n\n**Background**\n\nThese types of attacks frequently occurred when victim organizations’ employees worked\nremotely and used a mixture of corporate laptops and personal devices to access their\nrespective cloud services. Despite the use of security tools, affected organizations typically\nhad weak cyber hygiene practices that allowed threat actors to conduct successful attacks.\n\n**Technical Details**\n\nThe cyber threat actors involved in these attacks used a variety of tactics and techniques—\nincluding phishing, brute force login attempts, and possibly a “pass-the-cookie” attack—to\nattempt to exploit weaknesses in the victim organizations’ cloud security practices.\n\n**_Phishing_**\n\n\n-----\n\nCISA observed cyber threat actors using phishing emails with malicious links to harvest\ncredentials for users’ cloud service accounts (Phishing: Spearphishing Link [[T1598.003]).](https://attack.mitre.org/versions/v8/techniques/T1598/003/)\nThe cyber actors designed emails that included a link to what appeared to be a secure\nmessage and also emails that looked like a legitimate file hosting service account login. After\na targeted recipient provided their credentials, the threat actors then used the stolen\ncredentials to gain Initial Access [[TA0001] to the user’s cloud service account (Valid](https://attack.mitre.org/versions/v8/tactics/TA0001/)\n_Accounts_ [[T1078]). CISA observed the actors’ logins originating from foreign locations](https://attack.mitre.org/versions/v8/techniques/T1078/)\n(although the actors could have been using a proxy or The Onion Router (Tor) to obfuscate\ntheir location). The actors then sent emails from the user’s account to phish other accounts\nwithin the organization. In some cases, these emails included links to documents within what\nappeared to be the organization’s file hosting service.\n\nIn one case, an organization did not require a virtual private network (VPN) for accessing the\ncorporate network. Although their terminal server was located within their firewall, due to\nremote work posture, the terminal server was configured with port 80 open to allow remote\nemployees to access it—leaving the organization’s network vulnerable. The threat actor\nattempted to exploit this by launching brute force login attempts (Brute Force [[T1110]).](https://attack.mitre.org/versions/v8/techniques/T1110/)\n\n**_Forwarding Rules_**\n\nIn several engagements, CISA observed threat actors collecting sensitive information by\ntaking advantage of email forwarding rules, which users had set up to forward work emails to\ntheir personal email accounts (Email Collection: Email Forwarding Rule [[T1114.003]).](https://attack.mitre.org/versions/v8/techniques/T1114/003/)\n\n_Modified Forwarding_\n\nIn one case, CISA determined that the threat actors modified an existing email rule on a\nuser’s account—originally set by the user to forward emails sent from a certain sender to a\npersonal account—to redirect the emails to an account controlled by the actors. The threat\nactors updated the rule to forward all email to the threat actors’ accounts.\n\n_Keyword Search Rule_\n\nThreat actors also modified existing rules to search users’ email messages (subject and\nbody) for several finance-related keywords (which contained spelling mistakes) and forward\nthe emails to the threat actors’ account.\n\n_New Rule Creation and Forwarding_\n\nIn addition to modifying existing user email rules, the threat actors created new mailbox rules\nthat forwarded certain messages received by the users (specifically, messages with certain\nphishing-related keywords) to the legitimate users’ Really Simple Syndication (RSS) Feeds\nor RSS Subscriptions folder in an effort to prevent warnings from being seen by the\nlegitimate users.\n\n**_Authentication_**\n\n\n-----\n\nCISA verified that the threat actors successfully signed into one user s account with proper\nmulti-factor authentication (MFA). In this case, CISA believes the threat actors may have\nused browser cookies to defeat MFA with a “pass-the-cookie” attack (Use Alternate\n_Authentication Material: Web Session Cookie_ [[T1550.004]).](https://attack.mitre.org/versions/v8/techniques/T1550/004/)\n\nThe threat actors attempted brute force logins (Brute Force [[T1110]) on some accounts.](https://attack.mitre.org/versions/v8/techniques/T1110/)\nHowever, this activity was not successful. This thwarted attempt was due, in part, to the\nthreat actors not guessing a correct username/password combination, as well as the\norganization’s use of MFA to access their cloud environment.\n\n## Solution\n\nCISA recommends the following steps for organizations to strengthen their cloud security\npractices.\n\nImplement conditional access (CA) policies based upon your organization's needs.\nEstablish a baseline for normal network activity within your environment.\nRoutinely review both Active Directory sign-in logs and unified audit logs for anomalous\nactivity.\nEnforce MFA.\nRoutinely review user-created email forwarding rules and alerts, or restrict forwarding.\nHave a mitigation plan or procedures in place; understand when, how, and why to reset\npasswords and to revoke session tokens.\n[Follow recommend guidance on securing privileged access.](https://media.defense.gov/2020/Dec/17/2002554125/-1/-1/0/AUTHENTICATION_MECHANISMS_CSA_U_OO_198854_20.PDF)\nConsider a policy that does not allow employees to use personal devices for work. At a\nminimum, use a trusted mobile device management solution.\nResolve client site requests internal to your network.\nConsider restricting users from forwarding emails to accounts outside of your domain.\nAllow users to consent only to app integrations that have been pre-approved by an\nadministrator.\nAudit email rules with enforceable alerts via the Security and Compliance Center or\nother tools that use the Graph API to warn administrators to abnormal activity.\nImplement MFA for all users, without exception.\n[Conditional access should be understood and implemented with a zero-trust mindset.](https://www.microsoft.com/security/blog/2020/04/30/zero-trust-deployment-guide-azure-active-directory/)\nEnsure user access logging is enabled. Forward logs to a security information and\nevent management appliance for aggregation and monitoring so as to not lose visibility\non logs outside of logging periods.\nUse a CA policy to block legacy authentication protocols.\nVerify that all cloud-based virtual machine instances with a public IP do not have open\nRemote Desktop Protocol (RDP) ports. Place any system with an open RDP port\nbehind a firewall and require users to use a VPN to access it through the firewall.\n\n\n-----\n\nFocus on awareness and training. Make employees aware of the threats—such as\nphishing scams—and how they are delivered. Additionally, provide users training on\ninformation security principles and techniques as well as overall emerging\ncybersecurity risks and vulnerabilities.\nEstablish blame-free employee reporting and ensure that employees know who to\ncontact when they see suspicious activity or when they believe they have been a victim\nof a cyberattack. This will ensure that the proper established mitigation strategy can be\nemployed quickly and efficiently.\nEnsure existing built-in filtering and detection products (e.g., those for spam, phishing,\nmalware, and safe attachments and links are enabled.\nOrganizations using M365 should also consider the following steps.\n\nAssign a few (one to three) trusted users as electronic discovery (or eDiscovery)\nmanagers to conduct forensic content searches across the entire M365\nenvironment (Mailboxes, Teams, SharePoint, and OneDrive) for evidence of\nmalicious activity.\nDisable PowerShell remoting to Exchange Online for regular M365 users.\nDisabling for non-administrative users will lower the likelihood of a compromised\nuser account being used to programmatically access tenant configurations for\nreconnaissance.\nDo not allow an unlimited amount of unsuccessful login attempts. To configure\n[these settings, see password smart lockout configuration and](https://docs.microsoft.com/en-us/azure/active-directory/authentication/howto-password-smart-lockout) sign-in activity\nreports.\nConsider using a tool such as Sparrow or Hawk—open-source PowerShell-based\ntools used to gather information related to M365—to investigate and audit\n[intrusions and potential breaches.[1][2]](https://github.com/cisagov/Sparrow)\n\n## Resources\n\nSee CISA’s Alert on Technical Approaches to Uncovering and Remediating Malicious\nActivity for guidance on identifying and handling cyber incidents.\nReview CISA’s [General Telework Guidance geared toward system administrators.](https://www.cisa.gov/general-telework-guidance)\n[See CISA’s Analysis Report: Microsoft Office 365 Security Observations (May 2019) for](https://us-cert.cisa.gov/ncas/analysis-reports/AR19-133A)\nadditional guidance.\n[CISA also released an Alert: Microsoft Office 365 Security Recommendations with](https://us-cert.cisa.gov/ncas/alerts/aa20-120a)\nguidance on securing M365 environments.\n\n## References\n\n Revisions\n\nJanuary 13, 2021: Initial Version\n\n[This product is provided subject to this Notification and this](https://us-cert.cisa.gov/privacy/notification) [Privacy & Use policy.](https://www.dhs.gov/privacy-policy)\n\n\n-----\n\n**Please share your thoughts.**\n\n[We recently updated our anonymous product survey; we'd welcome your feedback.](https://www.surveymonkey.com/r/CISA-cyber-survey?product=https://us-cert.cisa.gov/ncas/analysis-reports/ar21-013a)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-01-13 - Analysis Report (AR21-013A)- Strengthening Security Configurations to Defend Against Attackers Targeting Cloud Services.pdf"
    ],
    "report_names": [
        "2021-01-13 - Analysis Report (AR21-013A)- Strengthening Security Configurations to Defend Against Attackers Targeting Cloud Services.pdf"
    ],
    "threat_actors": [
        {
            "id": "aa73cd6a-868c-4ae4-a5b2-7cb2c5ad1e9d",
            "created_at": "2022-10-25T16:07:24.139848Z",
            "updated_at": "2025-03-27T02:02:10.120505Z",
            "deleted_at": null,
            "main_name": "Safe",
            "aliases": [],
            "source_name": "ETDA:Safe",
            "tools": [
                "DebugView",
                "LZ77",
                "OpenDoc",
                "SafeDisk",
                "TypeConfig",
                "UPXShell",
                "UsbDoc",
                "UsbExe"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673536061,
    "ts_updated_at": 1743041150,
    "ts_creation_date": 1653786362,
    "ts_modification_date": 1653786362,
    "files": {
        "pdf": "https://archive.orkl.eu/b4baed1b303a24d1a067b07dcc1bbfb84023b100.pdf",
        "text": "https://archive.orkl.eu/b4baed1b303a24d1a067b07dcc1bbfb84023b100.txt",
        "img": "https://archive.orkl.eu/b4baed1b303a24d1a067b07dcc1bbfb84023b100.jpg"
    }
}