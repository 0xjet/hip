{
    "id": "caba3ece-09ba-4e28-9944-b3eb2d076253",
    "created_at": "2023-02-02T02:07:37.170025Z",
    "updated_at": "2025-03-27T02:13:57.333221Z",
    "deleted_at": null,
    "sha1_hash": "783e902185c5616201af10e398ce492ec69b84de",
    "title": "2023-01-19 - Gamaredon (Ab)uses Telegram to Target Ukrainian Organizations",
    "authors": "",
    "file_creation_date": "2023-02-01T07:52:44Z",
    "file_modification_date": "2023-02-01T07:52:44Z",
    "file_size": 6548782,
    "plain_text": "# Gamaredon (Ab)uses Telegram to Target Ukrainian Organizations\n\n**[blogs.blackberry.com/en/2023/01/gamaredon-abuses-telegram-to-target-ukrainian-organizations](https://blogs.blackberry.com/en/2023/01/gamaredon-abuses-telegram-to-target-ukrainian-organizations)**\n\nThe BlackBerry Research & Intelligence Team\n\n### SUMMARY\n\nThe Gamaredon Group has been actively targeting the Ukrainian government lately, relying\non the infrastructure of the popular messaging service Telegram to bypass traditional\nnetwork traffic detection techniques without raising obvious flags. Back in November 2022,\n[BlackBerry uncovered a new Gamaredon campaign that relied on a multi-stage Telegram](https://blogs.blackberry.com/en/2022/11/gamaredon-leverages-microsoft-office-docs-to-target-ukraine-government)\nscheme to first profile potential victims, and then deliver the final payload along with the\nmalicious command-and-control (C2).\n\n[This report provides information about the recent network infrastructure from Crimea that](https://en.wikipedia.org/wiki/Crimea)\nthe Gamaredon Group uses, as well as analysis of each step before the victims receive the\nfinal payload.\n\n### MITRE ATT&CK Information\n\n\n-----\n\n**Tactic** **Technique**\n\n**Execution** T1559.001, T1059.001, T1204.002, T1059.005\n\n**Persistence** T1547.001\n\n**Defense Evasion** T1027, T1221, T1036, T1140\n\n**Command and Control** T1102.002, T1105, T1571, T1008, T1071.001, T1573.001\n\n**Exfiltration** T1029\n\n### Weaponization and Technical Overview\n\n**Weapons** Obfuscated macro and PowerShell scripts, PE executables\n\n**Attack Vector** Spear-phishing, targeted maldocs\n\n**Network Infrastructure** DDNS, Telegram\n\n**Targets** Government organizations in Ukraine\n\n### Technical Analysis\n\n**Context**\n\nThe Gamaredon Group is a Russian state-sponsored cyber espionage group that has been\nactive since 2013. Over the years, Gamaredon’s main target has always been Ukrainian\ngovernment organizations. To bypass the government’s security measures, the threat group\nworks continually to improve their malicious code over time.\n\n[In mid-September 2022, Talos Intelligence reported Gamaredon’s latest attack on Ukrainian](https://blog.talosintelligence.com/gamaredon-apt-targets-ukrainian-agencies/)\ngovernment organizations and exposed details of the complete execution chain. In\nNovember 2022, the BlackBerry Research and Intelligence Team [uncovered Gamaredon’s](https://blogs.blackberry.com/en/2022/11/gamaredon-leverages-microsoft-office-docs-to-target-ukraine-government)\nlatest campaign, which relied on Telegram for malicious network structure purposes.\n\n\n-----\n\nThe initial infection vector we reported on was weaponized documents written in both the\nRussian and Ukrainian languages and sent via spear-phishing techniques, exploiting the\nremote template injection vulnerability that enables attackers to bypass Microsoft Word\nmacro protections to compromise target systems with malware, gain access to information,\nthen spread the infection to other users.\n\nThe Gamaredon Group’s network infrastructure relies on multi-stage Telegram accounts for\nvictim profiling and confirmation of geographic location, and then finally leads the victim to\nthe next stage server for the final payload. This kind of technique to infect target systems is\nnew.\n\n### Attack Vector\n\n\n**md5**\n\n**sha-256**\n\n**File**\n**Name**\n\n\n54c20281d74df35f625925d9c941e25b\n\n9ecf13027af42cec0ed3159b1bc48e265683feaefa331f321507d12651906a91\n\nБас по Род. славе.docx\n\n\n**File Size** 55175 bytes\n\n**Created** Бас по Род. славе.docx\n\n**Author** Admin\n\n\n**Last**\n**Modified**\n\n**Last**\n**Modified**\n**By**\n\n**md5**\n\n**sha-256**\n\n\n2022:05:03 08:59:00Z\n\nПользователь\n\n21a2e24fc146a7baf47e90651cf397ad\n\n2d99e762a41abec05e97dd1260775bad361dfa4e8b4120b912ce9c236331dd3f\n\n\n**File Size** 23347 bytes\n\n\n-----\n\n**Author** Admin\n\n\n**Last**\n**Modified**\n\n**Last**\n**Modified**\n**By**\n\n\n2022-11-04T09:35:00Z\n\nVKZ\n\n\n[In a similar fashion to their previous campaigns, Gamaredon relies on the highly targeted](https://blogs.blackberry.com/en/2022/11/gamaredon-leverages-microsoft-office-docs-to-target-ukraine-government)\ndistribution of weaponized documents. Their malicious lures mimic documents originating\nfrom real Ukrainian government organizations, and are carefully designed to trick those who\nmay have a real reason to interact with those organizations.\n\n_[Figure 1 – Malicious document in the name of “Luhansk People's Republic,” written in the](https://en.wikipedia.org/wiki/Luhansk_People%27s_Republic)_\n_Russian language_\n\n\n-----\n\n_Figure 2 – Gamaredon’s malicious lure document written in the Ukrainian language in the_\n_name of the “National Police of Ukraine”_\n\n\n-----\n\n_Figure 3 – Gamaredon’s malicious lure document in the Ukrainian language on behalf of a_\n_Ukrainian company working in the aerospace field_\n\n\n-----\n\n_Figure 4 – Malicious lure document written in the Ukrainian language in the name of the_\n_Ministry of Justice of Ukraine_\n\nAs an example, the document with the filename “Бас по Род. славе.docx” employs a\n[remote template injection technique (CVE-2017-0199) in order to gain initial access. Once](https://msrc.microsoft.com/update-guide/vulnerability/CVE-2017-0199)\nthe malicious document is opened, it fetches the specified address and downloads the next\nstage of the attack chain.\n\n_Figure 5 – Malicious URL which downloads the next phase in the attack_\n\n### Weaponization\n\nThe server's configuration deploys the next stage payload only to targets with a Ukrainian\nIP address. If it matches the IP's validation and confirms the target is indeed located in\nUkraine, it then drops a heavily obfuscated VBA script.\n\n\n-----\n\n**md5**\n\n**sha-256**\n\n**File**\n**Name**\n\n\nda84f8b5c335deaef354958c62b8dafd\n\n295654e3284158bdb94b40d7fb98ede8f3eab72171e027360a654f9523ece566\n\npresume.wtf\n\n\n**File Size** 55296 bytes\n\n**Author** user\n\n\n**Last**\n**Modified**\n\n**Last**\n**Modified**\n**By**\n\n\n2022:11:07 14:27:00\n\nПользователь Windows\n\n\n_Figure 6 – Obfuscated routines from the second stage of the attack chain_\n\nThe script creates the following location and drops a VBS file:\n\nC:\\Users\\<user_name>\\Downloads\\expecting\\deposit\n\nThen it invokes the “wscript.exe” and runs the “deposit” file. Different implants may rely on\nother locations, as in the following examples:\n\nC:\\Users\\<user name>\\Downloads\\bars\\decrepit\n\n\n-----\n\nC:\\Users\\<user_name>\\Downloads\\baron\\demonstration\nC:\\Users\\<user_name>\\deliberate.bmp\n\nThe “decrepit” VBS is instructed to connect to a hardcoded Telegram account and to get\ninstructions in a slightly obfuscated format leading to a new malicious IP address.\n\n_Figure 7 – Deobfuscated code shows Gamaerdon’s Telegram account and components of_\n_the URL for the next stage_\n\nEach Telegram account periodically deploys new IP addresses. In an interesting twist, our\nfindings confirm that this only happens during regular working hours in Eastern Europe.\nThis indicates that this is very likely a human-operated activity rather than an automated\none.\n\n_Figure 8 – Gamaredon’s Telegram account serves a next-stage IP address_\n\n\n-----\n\nDifferent Telegram accounts serve different IP addresses. For example, the account\n\"zacreq\" served the following IP addresses, and likely many more.\n\n164.92.126[.]130\n45.63.42[.]255\n159.65.174[.]140\n\nOnce the IP address is obtained, it is then used to construct the URL for the next stage\ndownload.\n\n### Loader\n\nContinuing with its execution, the script is instructed to issue a HTTP GET request to the\nURL \"hxxp://\" & IP_from_zacreq_TG & \"/deposit\" & random_number & \"/expecting.vac=?\nderisive\".\n\n_Figure 9 – Next stage delivery_\n\nUpon successful connection, the remote server returns base64 encode data blob, which\ndecodes to a PowerShell script. The PowerShell script is instructed to download a “get.php”\nfile from 213.69.3[.]218 IP address and run it.\n\n\n-----\n\n_Figure 10 – The base64 decoded data blob_\n\nTo download the next stage, the “get.php” script is instructed to invoke the domain() function\nwhich reaches out to the Telegram channel \"hxxps[:]//t[.]me/s/newtesta1\" to obtain a slightly\nobfuscated IP address, the same way we’ve seen previously.\n\n_Figure 11 – Function to receive the IP for the next stage of the execution chain_\n\nThe IP addresses listed in the “newtesta1” Telegram account are also changed periodically\nby the threat group.\n\n\n-----\n\n_Figure 12 – IP address for the final stage delivery_\n\nThe BlackBerry Research and Intelligence Team has monitored this account over time and\nhas identified the following IP address used for the delivery of the final payload:\n\n45.77.229[.]159\n64.227.1[.]3\n64.227.7[.]134\n84.32.128[.]41\n84.32.128[.]215\n104.131.39[.]154\n143.110.221[.]189\n157.230.223[.]20\n157.230.123[.]48\n158.247.199[.]37\n158.247.199[.]225\n165.22.7[.]242\n167.172.173[.]7\n170.64.152[.]42\n198.13.42[.]40\n206.189.143[.]206\n217.69.3[.]218\n\n### Payload\n\nIf the specific criteria mentioned above is met, the server returns the payload. Upon\nreceiving the payload, the \"get.php\" script invokes the decode() function to perform an XOR\noperation where the $key value is obtained from the volume serial number.\n\n\n-----\n\n_Figure 13 – Final payload decoding function_\n\n[Talos has already analyzed the final payload placement. We have observed minor changes,](https://blog.talosintelligence.com/gamaredon-apt-targets-ukrainian-agencies/)\nsuch as different variables and file names; however, the core logic remains the same.\n\n_Figure 14 – Final payload placement logic_\n\n### Attack Flow\n\n\n-----\n\n_Figure 15 – Gamaredon Group attack flow_\n\n### Network\n\nThe Gamaredon Group has used the hxxp://t[.]me/s/* URL structure in the stage which\naccesses Telegram to direct the execution to the next stage. We searched for this structure\nin VirusTotal and found the following additional Telegram C2’s.\n\n**Telegram Account** hxxp://t[.]me/s/chanellsac\n\n\n-----\n\n**IP** 206.189.139[.]249\n\n**Telegram Account** hxxp://t[.]me/s/zapula2\n\n**IP** 104.248.36[.]191\n\n**Telegram Account** hxxp://t[.]me/s/zalup2\n\n**IP** 140.82.29[.]65\n\n**Telegram Account** hxxp://t[.]me/s/vozmoz2\n\n**IP** 159.89.31[.]49\n\n**Telegram Account** hxxp://t[.]me/s/digitli\n\n**IP** 104.248.36[.]191\n\n**Telegram Account** hxxp://t[.]me/s/dracarc\n\n**IP** 164.92.234[.]195\n\n**Telegram Account** hxxp://t[.]me/s/randomnulls\n\n**IP** 68.183.3[.]178\n\nThe BlackBerry Research and Intelligence Team has traced the Gamaredon Group’s activity\nback to 109.200.159[.]54 using network flow data analysis. Every IP address in\ncommunication with this node has been related to Gamaredon, in some form or fashion. For\nevery IP listed in this report, only three haven't been accessed by this node in the last seven\ndays prior to publication. That node is based in Crimea and has been active since at least\nspring 2022. All communication is between ports 1000-9999 on the C2 and an ephemeral\nport on the Gamaredon Group’s node.\n\n### Targets\n\n\n-----\n\nHistorically, the Gamaredon Group has solely targeted Ukraine. Based on the lure\ndocuments we uncovered, the victims being targeted belong to strategical industries in\nUkraine, such as the military, law enforcement, and others.\n\n### Attribution\n\nThe Gamaredon Group has been publicly attributed to Russia. The geopolitical nature of\nthe targets, the threat actor's network infrastructure, and metadata extracted from the lure\ndocuments appear to confirm its origins.\n\n### CONCLUSIONS\n\nTelegram is one of the most popular messaging applications used in both Ukraine and\nRussia. The Gamaredon Group relies on its infrastructure to bypass traditional network\ntraffic detection techniques without raising obvious flags. Their multi-staged approach,\nwhich first confirms the victims’ location and then leads them to the final payload, means\nthat security researchers must work harder to track the whole attack flow and to find the\nfinal payload.\n\nThe threat group change IP addresses dynamically, which makes it even harder to\nautomate analysis through sandbox techniques once the sample has aged out. The fact\nthat the suspect IP addresses change only during Eastern European working hours strongly\nsuggests that the threat actor works from one location, and with all probability belongs to an\noffensive cyber unit that deploys malicious operations against Ukraine.\n\n_For similar articles and news delivered to your inbox, please subscribe to the BlackBerry_\n_Blog._\n\n## About The BlackBerry Research & Intelligence Team\n\n\n-----\n\nThe BlackBerry Research & Intelligence team examines emerging and persistent threats,\nproviding intelligence analysis for the benefit of defenders and the organizations they serve.\n\nBack\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2023/2023-01-19 - Gamaredon (Ab)uses Telegram to Target Ukrainian Organizations.pdf"
    ],
    "report_names": [
        "2023-01-19 - Gamaredon (Ab)uses Telegram to Target Ukrainian Organizations.pdf"
    ],
    "threat_actors": [
        {
            "id": "81bd7107-6b2d-45c9-9eea-1843d4b9b308",
            "created_at": "2022-10-25T15:50:23.320841Z",
            "updated_at": "2025-03-27T02:00:55.441723Z",
            "deleted_at": null,
            "main_name": "Gamaredon Group",
            "aliases": [
                "Gamaredon Group",
                "IRON TILDEN",
                "Primitive Bear",
                "ACTINIUM",
                "Armageddon",
                "Shuckworm",
                "DEV-0157",
                "Aqua Blizzard"
            ],
            "source_name": "MITRE:Gamaredon Group",
            "tools": [
                "QuietSieve",
                "Pteranodon",
                "PowerPunch"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "d5156b55-5d7d-4fb2-836f-861d2e868147",
            "created_at": "2023-01-06T13:46:38.557326Z",
            "updated_at": "2025-03-27T02:00:02.861124Z",
            "deleted_at": null,
            "main_name": "Gamaredon Group",
            "aliases": [
                "Aqua Blizzard",
                "Actinium",
                "DEV-0157",
                "Blue Otso",
                "G0047",
                "PRIMITIVE BEAR",
                "Shuckworm",
                "Trident Ursa",
                "UAC-0010",
                "Winterflounder",
                "ACTINIUM",
                "BlueAlpha",
                "IRON TILDEN"
            ],
            "source_name": "MISPGALAXY:Gamaredon Group",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "61940e18-8f90-4ecc-bc06-416c54bc60f9",
            "created_at": "2022-10-25T16:07:23.659529Z",
            "updated_at": "2025-03-27T02:02:09.912404Z",
            "deleted_at": null,
            "main_name": "Gamaredon Group",
            "aliases": [
                "Actinium",
                "Aqua Blizzard",
                "Armageddon",
                "Blue Otso",
                "BlueAlpha",
                "Callisto",
                "DEV-0157",
                "Iron Tilden",
                "Operation STEADY#URSA",
                "Primitive Bear",
                "SectorC08",
                "Shuckworm",
                "Trident Ursa",
                "UAC-0010",
                "Winterflounder"
            ],
            "source_name": "ETDA:Gamaredon Group",
            "tools": [
                "Aversome infector",
                "BoneSpy",
                "DessertDown",
                "DilongTrash",
                "DinoTrain",
                "EvilGnome",
                "FRAUDROP",
                "Gamaredon",
                "GammaDrop",
                "GammaLoad",
                "GammaSteel",
                "Gussdoor",
                "ObfuBerry",
                "ObfuMerry",
                "PlainGnome",
                "PowerPunch",
                "Pteranodon",
                "Pterodo",
                "QuietSieve",
                "Remote Manipulator System",
                "Resetter",
                "RuRAT",
                "SUBTLE-PAWS",
                "UltraVNC"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "236a8303-bf12-4787-b6d0-549b44271a19",
            "created_at": "2024-06-04T02:03:07.966137Z",
            "updated_at": "2025-03-27T02:05:17.410356Z",
            "deleted_at": null,
            "main_name": "IRON TILDEN",
            "aliases": [
                "Aqua Blizzard ",
                "Armageddon",
                "Blue Otso ",
                "BlueAlpha ",
                "Dancing Salome ",
                "Gamaredon",
                "Gamaredon Group",
                "Hive0051 ",
                "Primitive Bear ",
                "Shuckworm ",
                "Trident Ursa ",
                "UAC-0010 ",
                "UNC530 ",
                "WinterFlounder ",
                "ACTINIUM "
            ],
            "source_name": "Secureworks:IRON TILDEN",
            "tools": [
                "Pterodo"
            ],
            "source_id": "Secureworks",
            "reports": null
        }
    ],
    "ts_created_at": 1675303657,
    "ts_updated_at": 1743041637,
    "ts_creation_date": 1675237964,
    "ts_modification_date": 1675237964,
    "files": {
        "pdf": "https://archive.orkl.eu/783e902185c5616201af10e398ce492ec69b84de.pdf",
        "text": "https://archive.orkl.eu/783e902185c5616201af10e398ce492ec69b84de.txt",
        "img": "https://archive.orkl.eu/783e902185c5616201af10e398ce492ec69b84de.jpg"
    }
}