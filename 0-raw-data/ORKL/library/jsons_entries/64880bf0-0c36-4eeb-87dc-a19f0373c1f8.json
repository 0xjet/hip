{
    "id": "64880bf0-0c36-4eeb-87dc-a19f0373c1f8",
    "created_at": "2023-01-12T15:10:49.077208Z",
    "updated_at": "2025-03-27T02:17:05.521508Z",
    "deleted_at": null,
    "sha1_hash": "e3fc56fd4f0fbf4c1be367be6eb8822dc3e7ac4f",
    "title": "2022-06-01 - Hazard Token Grabber- Upgraded Version Of Stealer Targeting Discord Users",
    "authors": "",
    "file_creation_date": "2022-06-06T13:03:23Z",
    "file_modification_date": "2022-06-06T13:03:23Z",
    "file_size": 2040040,
    "plain_text": "# Hazard Token Grabber\n\n**blog.cyble.com/2022/06/01/hazard-token-grabber/**\n\n## Upgraded version of Stealer Targeting Discord Users\n\n\nJune 1, 2022\n\n\nCyble Research Labs has come across a new strain of malware performing stealing activities named\nHazard Token Grabber. The initial version of Hazard Token Grabber was spotted in the wild in 2021, and\nwe have observed an upgraded version now, which Threat Actors (TAs) are using to steal the user’s\ndata. Both versions are available on GitHub for free.\n\nDuring our OSINT threat hunting exercise, we came across over 2000 Samples related to this stealer\npresent in the wild. Most of the samples seen in the wild are the actual Python source code of the\nmalware used for compiling the binary, indicating that the malware has been used on a large scale.\nInterestingly few of the samples had either low or even zero detection.\n\nAs per the statement made by the Threat Actor (TA), it appears that an upgraded version of Hazard\nStealer can be accessed by purchasing it on their Discord server or website. This indicates that the\nmalware present on GitHub might not be that evasive, and the TA has only uploaded it there for\nadvertisement purposes. Figure 1 shows the statement made by the Threat Actor.\n\n\n-----\n\nFigure 1 – Statement made by TA\nThe number of samples related to Hazard stealer has increased significantly in the last three months, as\nshown below.\n\nFigure 2 – Stats of the sample submission in VirusTotal\nThe figure below shows the file details of one of the recent samples we analyzed.\n\n\n-----\n\nFigure 3 – File Details\n\n## Technical Analysis\n\n### Builder:\n\nHazard Token Grabber is developed using Python, and the builder of this stealer supports Python\nversion 3.10. The builder is a simple batch file that helps generate the payload and convert malicious\nPython script to a .exe file using Pyinstaller.\n\nFigure 4 – Hazard builder\n\n\n-----\n\n### Payload:\n\nThe malware exfiltrates the data to a Discord channel using webhooks which can be modified through\nthe configuration settings. The malware configuration also contains Flag variables and a list of programs\nto terminate during execution, as shown below.\n\nFigure 5 – File Configuration\nThe malware copies itself into the startup location to establish persistence and creates a random\ndirectory in the %temp% to store the stolen data.\n\nFigure 6 – Creating a folder in the\n\nTemp directory\nUpon execution, the stealer checks the configuration settings and creates a list to append the function\nnames whose flag is set to TRUE. After this, the malware creates a thread for each function present in\nthe list to execute the malicious code parallelly.\n\n\n-----\n\nFigure 7 – Multithreading\n\n### Anti-debug:\n\nThe malware performs various checks to prevent debugging and terminates itself if malware is being\ndebugged. The malware has a list of a few hardcoded values such as hardware ID, PC names, and\nusernames to exclude them from infection. The figure below shows the hardcoded lists\n\nFigure 8 – Anti-debug check\nThe malware also checks for the disk size of the victim’s system. If it’s below 50GB, it terminates itself. It\nthen reads the following registry keys for identifying the Virtual environment.\n\n_SYSTEM\\\\CurrentControlSet\\\\Services\\\\Disk\\\\Enum_\n\n_HKEY_LOCAL_MACHINE\\\\SYSTEM\\\\ControlSet001\\\\Control\\\\Class\\\\{4D36E968-E325-11CE-BFC1-_\n_08002BE10318}\\\\0000\\\\DriverDesc 2> nul”)_\n\n_HKEY_LOCAL_MACHINE\\\\SYSTEM\\\\ControlSet001\\\\Control\\\\Class\\\\{4D36E968-E325-11CE-BFC1-_\n_08002BE10318}\\\\0000\\\\ProviderName 2> nul”)_\n\n\n-----\n\nFigure 9 – Query registry\n\n### Data Harvesting:\n\nThe malware then proceeds to scan for the presence of a Discord token protector, something that\nprotects Discord tokens from malicious grabbers. To evade this, the malware checks for the presence of\ncertain files such as DiscordTokenProtector.exe, ProtectionPayload.dll, and secure.dat. If these filesare\npresent in the DiscordTokenProtector directory, the malware removes them. After this, the malware also\nmodifies the config.json file present in the DiscordTokenProtector directory to bypass the token\nprotector.\n\nFigure 10 – Bypassing DiscordTokenProtector\nThe Hazard token grabber then bypasses the BetterDiscord by replacing the string ‘api/webhooks’ with\n‘RdimoTheGoat,’ as shown below.\n\n\n-----\n\nFigure 11\n\n– Bypassing BetterDiscord\nUsing the subprocess module, the malware spawns PowerShell for fetching the Windows activation key\nand product name by querying registry keys shown in the figure below. The malware then steals this\ndata for exfiltration.\n\nFigure 12 – Spawning PowerShell\nThis malware targets over 20 applications with the express purpose of stealing Discord tokens which\ninclude:\n\nDiscord, DiscordCanary, Lightcord, DiscordPTB, Opera, OperaGX, Amigo, Torch, Kometa, Orbitum,\nCentBrowser, 7Star, Sputnik, Vivaldi, ChromeSxS, Chrome, EpicPrivacyBrowser, Microsoft Edge, Uran,\nYandex, Brave, Iridium and Mozilla Firefox.\n\nThis grabber steals cookies and login credentials from the chrome browser only. The stolen credentials\ncontain Domain, Username, and Password. The stolen data is saved in a text file which will be copied to\nthe random folder created initially.\n\n\n-----\n\nFigure 13 – Stealing data from Chrome browser\nThe malware uses the API _[hxxps[:]//discord.com/api/v9/users/@me and appends a Discord](http://10.10.0.46/mailto:hxxps%5B:%5D//discord.com/api/v9/users/@me)_\nauthorization token to identify Account information, such as email, mobile, and billing-related details. It\nalso identifies the badge associated with the Discord account and writes all the harvested information\ninto “Discord Info.txt”, as depicted below.\n\n\n-----\n\nFigure 14 – Harvesting data using discord developer’s API\nThe Hazard token grabber reads the following registry key:\n\n_SOFTWARE\\Roblox\\RobloxStudioBrowser\\roblox.com -Name .ROBLOSECURITY_\n\nto steal the Roblox studio cookie and writes the stolen data to the “Roblox Cookies.txt” file.\n\nFigure 15 – Stealing Roblox Studio Cookies\n\n### Data Exfiltration:\n\nHazard token grabber sends a request to hxxps[:]//ipinfo[.]io/json to identify the victim’s IP and Location.\nIt also finds the victim’s Google Maps Location. The malware does not write this data to a file but instead\nsends this as a message on Discord.\n\nFinally, the malware compresses the stolen data and exfiltrates it using webhooks specified by the TA.\n\n\n-----\n\nFigure 16 – Data Exfiltration\n\n## Conclusion\n\nIn the course of our analysis, we witnessed some samples of Hazard Token Grabber, which were fully\nundetectable. As the stealer is also available on GitHub, it’s possible that other TAs can also utilize its\nsource code to create a variant of this stealer. Hazard stealer has the capability to steal data from\nmultiple applications; however, considering its specific functionality, the primary target appears to be\nDiscord users.\n\n## Our Recommendations:\n\nAvoid downloading applications from unknown sources.\nUse a reputed anti-virus and internet security software package on your connected devices,\nincluding PC, laptop, and mobile.\nUse strong passwords and enforce multi-factor authentication wherever possible.\nUpdate your passwords periodically.\n\nRefrain from opening untrusted links and email attachments without first verifying their\nauthenticity.\nBlock URLs that could be used to spread the malware, e.g., Torrent/Warez.\nMonitor the beacon on the network level to block data exfiltration by malware or TAs.\nEnable Data Loss Prevention (DLP) Solution on the employees’ systems.\n\n## MITRE ATT&CK® Techniques \n\n\n**Tactic** **Technique**\n**ID**\n\n\n**Technique Name**\n\n\n**Execution** [T1204](https://attack.mitre.org/techniques/T1204/) User Execution\n\n\n-----\n\n**Defense Evasion** [T1497.001](https://attack.mitre.org/techniques/T1497/001/) Virtualization/Sandbox Evasion: System Checks\n\n**Persistence** [T1547.001](https://attack.mitre.org/techniques/T1547/001/) Boot or Logon Autostart Execution: Registry Run Keys /\nStartup Folder\n\n\n**Credential Access** [T1555](https://attack.mitre.org/techniques/T1555/)\n\n[T1539](https://attack.mitre.org/techniques/T1539/)\n\n[T1528](https://attack.mitre.org/techniques/T1528/)\n\n\nCredentials from Password Stores\n\nSteal Web Session Cookie\n\nSteal Application Access Token\n\n\n**Collection** [T1113](https://attack.mitre.org/techniques/T1113/) Screen Capture\n\n\n**Discovery** [T1087](https://attack.mitre.org/techniques/T1087/)\n\n[T1518](https://attack.mitre.org/techniques/T1518/)\n\n[T1057](https://attack.mitre.org/techniques/T1057/)\n\n[T1124](https://attack.mitre.org/techniques/T1124/)\n\n[T1007](https://attack.mitre.org/techniques/T1007/)\n\n[T1614](https://attack.mitre.org/techniques/T1614/)\n\n\nAccount Discovery\n\nSoftware Discovery\n\nProcess Discovery\n\nSystem Time Discovery\n\nSystem Service Discovery\n\nSystem Location Discovery\n\n\n**Command and**\n**Control**\n\n\n[T1071](https://attack.mitre.org/techniques/T1071/) Application Layer Protocol\n\n\n**Exfiltration** [T1041](https://attack.mitre.org/techniques/T1041/) Exfiltration Over C2 Channel\n\n## Indicators of Compromise (IoCs): \n\n**Indicators** **Indicator**\n**type**\n\n\n**Description**\n\n**Payload**\n\n**Payload**\n\n**Payload**\n\n\n2e434a36c1c3df178e3d19a66e871144\n\nd079bcd90c03088e9c5e77084f8e4c385557db6b\n2441f2df1789cfc48a170a7927d73b98d8676a65eb81f3b068e4c76c3b85e77a\n\n7fdc0515d98ff7d113ce68cccf29ae12\n\n3f4966ec6ecc8973702f32e51eb766dda737f2d0\n4ac15d15ff16919a08770265c074e8e89b21c9b61ce6348072aa719e80b5ed06\n\nc2ea16d8bfec78e1b2bf4322df0f63bd\n\n083f1d520e8524d778e1c52b4cbdd5986ca6365c\n6925d86fdedff2065c33df7806ba231d0d1c8f2d5246f1cad343f37fee54fe29\n\n\n**MD5**\n\n**SHA1**\n**SHA256**\n\n**MD5**\n\n**SHA1**\n**SHA256**\n\n**MD5**\n\n**SHA1**\n**SHA256**\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-06-01 - Hazard Token Grabber- Upgraded Version Of Stealer Targeting Discord Users.pdf"
    ],
    "report_names": [
        "2022-06-01 - Hazard Token Grabber- Upgraded Version Of Stealer Targeting Discord Users.pdf"
    ],
    "threat_actors": [
        {
            "id": "75455540-2f6e-467c-9225-8fe670e50c47",
            "created_at": "2022-10-25T16:07:23.740266Z",
            "updated_at": "2025-03-27T02:02:09.955585Z",
            "deleted_at": null,
            "main_name": "Iridium",
            "aliases": [],
            "source_name": "ETDA:Iridium",
            "tools": [
                "CHINACHOPPER",
                "China Chopper",
                "LazyCat",
                "Powerkatz",
                "SinoChopper",
                "reGeorg"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "0661a292-80f3-420b-9951-a50e03c831c0",
            "created_at": "2023-01-06T13:46:38.928796Z",
            "updated_at": "2025-03-27T02:00:02.953963Z",
            "deleted_at": null,
            "main_name": "IRIDIUM",
            "aliases": [],
            "source_name": "MISPGALAXY:IRIDIUM",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "a66438a8-ebf6-4397-9ad5-ed07f93330aa",
            "created_at": "2022-10-25T16:47:55.919702Z",
            "updated_at": "2025-03-27T02:05:17.412024Z",
            "deleted_at": null,
            "main_name": "IRON VIKING",
            "aliases": [
                "ATK14 ",
                "BlackEnergy Group",
                "Blue Echidna ",
                "CTG-7263 ",
                "ELECTRUM ",
                "FROZENBARENTS ",
                "Hades/OlympicDestroyer ",
                "IRIDIUM ",
                "Qudedagh ",
                "Sandworm Team ",
                "Seashell Blizzard ",
                "TEMP.Noble ",
                "Telebots ",
                "Voodoo Bear ",
                "APT44 "
            ],
            "source_name": "Secureworks:IRON VIKING",
            "tools": [
                " BlackEnergy",
                " GCat",
                " GreyEnergy",
                " Industroyer",
                " KillDisk",
                " NotPetya",
                " PSCrypt",
                " TeleBot",
                " TeleDoor",
                " xData",
                "BadRabbit"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "b3e954e8-8bbb-46f3-84de-d6f12dc7e1a6",
            "created_at": "2022-10-25T15:50:23.339976Z",
            "updated_at": "2025-03-27T02:00:55.446795Z",
            "deleted_at": null,
            "main_name": "Sandworm Team",
            "aliases": [
                "Sandworm Team",
                "ELECTRUM",
                "Telebots",
                "IRON VIKING",
                "BlackEnergy (Group)",
                "Quedagh",
                "Voodoo Bear",
                "IRIDIUM",
                "Seashell Blizzard",
                "FROZENBARENTS",
                "APT44"
            ],
            "source_name": "MITRE:Sandworm Team",
            "tools": [
                "Bad Rabbit",
                "Mimikatz",
                "Exaramel for Linux",
                "Exaramel for Windows",
                "GreyEnergy",
                "PsExec",
                "Prestige",
                "P.A.S. Webshell",
                "VPNFilter",
                "Cyclops Blink",
                "SDelete",
                "AcidRain",
                "Industroyer",
                "Industroyer2",
                "BlackEnergy",
                "Cobalt Strike",
                "NotPetya",
                "KillDisk",
                "PoshC2",
                "Impacket",
                "Invoke-PSImage",
                "Olympic Destroyer"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "8941e146-3e7f-4b4e-9b66-c2da052ee6df",
            "created_at": "2023-01-06T13:46:38.402513Z",
            "updated_at": "2025-03-27T02:00:02.824555Z",
            "deleted_at": null,
            "main_name": "Sandworm",
            "aliases": [
                "G0034",
                "IRIDIUM",
                "Blue Echidna",
                "FROZENBARENTS",
                "Seashell Blizzard",
                "IRON VIKING",
                "ELECTRUM",
                "TeleBots",
                "UAC-0113",
                "UAC-0082",
                "APT44",
                "Quedagh",
                "VOODOO BEAR",
                "TEMP.Noble"
            ],
            "source_name": "MISPGALAXY:Sandworm",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "7bd810cb-d674-4763-86eb-2cc182d24ea0",
            "created_at": "2022-10-25T16:07:24.1537Z",
            "updated_at": "2025-03-27T02:02:10.126127Z",
            "deleted_at": null,
            "main_name": "Sandworm Team",
            "aliases": [
                "APT 44",
                "ATK 14",
                "BE2",
                "Blue Echidna",
                "CTG-7263",
                "FROZENBARENTS",
                "IRIDIUM",
                "Iron Viking",
                "Quedagh",
                "Sandworm",
                "Sandworm Team",
                "Seashell Blizzard",
                "TEMP.Noble",
                "UAC-0082",
                "UAC-0113",
                "UAC-0125",
                "UAC-0133",
                "Voodoo Bear"
            ],
            "source_name": "ETDA:Sandworm Team",
            "tools": [
                "AWFULSHRED",
                "ArguePatch",
                "BIASBOAT",
                "Black Energy",
                "BlackEnergy",
                "CaddyWiper",
                "Colibri Loader",
                "Cyclops Blink",
                "CyclopsBlink",
                "DCRat",
                "DarkCrystal RAT",
                "Fobushell",
                "GOSSIPFLOW",
                "Gcat",
                "IcyWell",
                "Industroyer2",
                "JaguarBlade",
                "JuicyPotato",
                "Kapeka",
                "KillDisk.NCX",
                "LOADGRIP",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "ORCSHRED",
                "P.A.S.",
                "PassKillDisk",
                "Pitvotnacci",
                "PsList",
                "QUEUESEED",
                "RansomBoggs",
                "RottenPotato",
                "SOLOSHRED",
                "SwiftSlicer",
                "VPNFilter",
                "Warzone",
                "Warzone RAT",
                "Weevly"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673536249,
    "ts_updated_at": 1743041825,
    "ts_creation_date": 1654520603,
    "ts_modification_date": 1654520603,
    "files": {
        "pdf": "https://archive.orkl.eu/e3fc56fd4f0fbf4c1be367be6eb8822dc3e7ac4f.pdf",
        "text": "https://archive.orkl.eu/e3fc56fd4f0fbf4c1be367be6eb8822dc3e7ac4f.txt",
        "img": "https://archive.orkl.eu/e3fc56fd4f0fbf4c1be367be6eb8822dc3e7ac4f.jpg"
    }
}