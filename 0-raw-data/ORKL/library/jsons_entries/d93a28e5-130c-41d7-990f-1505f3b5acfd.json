{
    "id": "d93a28e5-130c-41d7-990f-1505f3b5acfd",
    "created_at": "2023-01-12T15:08:14.349229Z",
    "updated_at": "2025-03-27T02:16:26.582562Z",
    "deleted_at": null,
    "sha1_hash": "c09371fc429b4cd88ef67550cd77508b8863c7a6",
    "title": "2017-09-11 - “Re- Details” Malspam Downloads CoreBot Banking Trojan",
    "authors": "",
    "file_creation_date": "2022-05-27T21:54:55Z",
    "file_modification_date": "2022-05-27T21:54:55Z",
    "file_size": 1346018,
    "plain_text": "# “Re: Details” Malspam Downloads CoreBot Banking Trojan\n\n**[malwarebreakdown.com/2017/09/11/re-details-malspam-downloads-corebot-banking-trojan/](https://malwarebreakdown.com/2017/09/11/re-details-malspam-downloads-corebot-banking-trojan/)**\n\nSeptember 11, 2017\n\nI got some malspam on 09/07/17 and decided to play around with it a bit. Below is an image\nof the email:\n\n\n-----\n\nThe email is pretending to come from “Signa Air” and the subject is “Re: Details”. The text of\nthe email is as follows:\n```\nFYI,\nI sent this earlier with my regular email but no reply from you.\nKindly crosscheck the account details in the attached due invoice to see if it\nmatches with yours.\nPayment will be released this week.\nVery truly yours,\nSigna Air\n2619 Coulter LaneProvidence Forge, VA 23140\nTel 631-232-8257\nfax 631-232-6045\n\n```\nThe email attempts to social engineer the user into opening the attached “invoice” contained\nwithin “invoice_327504.zip”. Downloading and opening the attached zip file shows two files,\n“invoice_327504” and “invoice_327504.doc”:\n\n\n-----\n\nOpening invoice_327504.doc does what you might expect, social engineering unsuspecting\nusers into enabling editing and content:\n\nEnable Editing\n\n\n-----\n\nEnable Content\nThe text of the document states:\n```\nOops, something went wrong\nThis document is protected\n1. Open the document in Microsoft Office. Previewing online is not available for\nprotected documents.\n2. If this document was downloaded from your email, please click Enable Editing from\nthe yellow bar above.\n3. Once you have enabled editing, please click Enable Content from the yellow bar\nabove.\n\n```\nNot surprisingly, there is an embedded macro in the file. The macro is executed when the\nuser opens the document and allows the macro to run. The VBA macro is also obfuscated,\nwhich is done to evade detection and to make analysis more difficult.\n\n[Pastebin of malicious macros found in invoice_327504.doc.](https://pastebin.com/DqLhAk52)\n\nStructure and contents of OLE2 file:\n\n\n-----\n\n1:     114 x01CompObj\n2:     4096 ‘x05DocumentSummaryInformation’\n3:     4096 ‘x05SummaryInformation’\n4:     9649 ‘1Table’\n5:     490 ‘Macros/PROJECT’\n6:     119 ‘Macros/PROJECTwm’\n7: M  6927 ‘Macros/VBA/RihYT4MF’\n8: M  32275 ‘Macros/VBA/ThisDocument’\n9:     12157 ‘Macros/VBA/_VBA_PROJECT’\n10:    1991 ‘Macros/VBA/__SRP_0’\n11:    198 ‘Macros/VBA/__SRP_1’\n12:    532 ‘Macros/VBA/__SRP_2’\n13:    156 ‘Macros/VBA/__SRP_3’\n14:    771 ‘Macros/VBA/dir’\n15: M 4393 ‘Macros/VBA/rGjP1XdB’\n16: M 6257 ‘Macros/VBA/yG6L1tE’\n17:    63220 ‘WordDocument’\n\nWe can see that it uses PowerShell to download and execute a remote file:\n\nThe script uses the argument -WindowStyle Hidden to hide the command window from the\nuser and downloads the malware payload from hxxp://85[.]143[.]175[.]128/file.exe. Below is\nan image of the GET request performed by my host:\n\n\n-----\n\nNotice the lack of request headers, including the nonexistent User-Agent.\n\nThe downloaded file is dropped in %TEMP% and renamed something like 21916.exe. Once\nthe payload is downloaded, the script uses the method Start-Process to run the additional\ncode.\n\nAfter the malware payload is executed, we see the creation of various files in\n%LOCALAPPDATA%, including “container.dat,” some .tmp files (deleted by malware), a .dll\nfile, “1.dat,” “2.dat,” extension-less files, and a .conf file:\n\n\n-----\n\nThe malware also sets an autostart registry key in\nHKCUSoftwareMicrosoftWindowsCurrentVersionRun (for persistence), pointing to the .dll\nlocated in %LOCALAPPDATA%:\n\nMy Twitter friend [@Antelox helped me out again (thanks!) with quickly identifying the](https://twitter.com/Antelox)\nmalware as CoreBot, a modular banking Trojan.\n\nThe malware sample also creates the following mutex:\n\n18550D22-4FCA-4AF2-9E8E-F0259D23694F\n\nDuring my infection I noticed the malware requesting the external IP address of the host via\nhttpbin[.]org/ip:\n\n\n-----\n\nThe User-Agent for these request were Wget/1.11.\n\n[There were also connections to 89.223.31.232 via TCP port 443:](https://www.virustotal.com/en/ip-address/89.223.31.232/information/)\n\nExamples of TCP connections:\n\nRemote Address: 89.223.31.232\n\nRemote Host Name: 143457.simplecloud.ru\n\nLocal Port: 51337\n\nRemote Port: 443\n\nProcess ID: 3036\n\nProcess Name: file.exe\n\nProcess Path: C:UsersWin7 32bitAppDataLocalTempfile.exe\n\nRemote Address: 89.223.31.232\n\nRemote Host Name: 143457.simplecloud.ru\n\nLocal Port: 51339\n\n\n-----\n\nRemote Port: 443\nProcess ID: 364\nProcess Name: svchost.exe\nProcess Path: C:Windowssystem32svchost.exe\n\nAfter I posted the link to this blog post on Twitter [@VK_Intel uploaded an image of the](https://twitter.com/VK_Intel/status/907186473937633281)\nconfig, which contains the domain name Checkbox.bit:\n\nNetwork Based IOCs\n\n85.143.175.128 GET /file.exe\n\nhttpbin.org/ip\n\n89.223.31.232 via TCP 443 – checkbox.bit\n\nHashes\n\n[SHA256: 15074fd041ba61c5b1c99193b8726f91d12ed1322f07231c5da0fd82b96b6292](https://www.virustotal.com/en/file/15074fd041ba61c5b1c99193b8726f91d12ed1322f07231c5da0fd82b96b6292/analysis/)\n\nFile name: invoice_327504.zip\n\n[SHA256: 121698a295e124aad5f4e610d1d6727467d590db28c995821fd84f1c0c804a6c](https://www.virustotal.com/en/file/121698a295e124aad5f4e610d1d6727467d590db28c995821fd84f1c0c804a6c/analysis/)\n\nFile name: invoice_327504.doc\n\n[Hybrid-Analysis Report](https://www.hybrid-analysis.com/sample/121698a295e124aad5f4e610d1d6727467d590db28c995821fd84f1c0c804a6c?environmentId=100)\n\n[SHA256: fad14293c82af81c030ce802b3bba02f6c0ab78df25211797aef2309e9c559a1](https://www.virustotal.com/en/file/fad14293c82af81c030ce802b3bba02f6c0ab78df25211797aef2309e9c559a1/analysis/)\n\nFile name: file.exe\n\n[Hybrid-Analysis Report](https://www.hybrid-analysis.com/sample/fad14293c82af81c030ce802b3bba02f6c0ab78df25211797aef2309e9c559a1?environmentId=100)\n\n\n-----\n\n[SHA256: 4ef56df995e0d2be68018219cdb5ef43f731a1413db3a2a6b05c198a308fa49f](https://www.virustotal.com/en/file/4ef56df995e0d2be68018219cdb5ef43f731a1413db3a2a6b05c198a308fa49f/analysis/)\nFile name: sample.dll\n[Hybrid-Analysis Report](https://www.hybrid-analysis.com/sample/4ef56df995e0d2be68018219cdb5ef43f731a1413db3a2a6b05c198a308fa49f?environmentId=100)\n\nDownloads\n\n[Malware samples.zip](https://malwarebreakdown.com/wp-content/uploads/2017/09/malware-samples.zip)\nPassword is “infected”\n\nReferences:\n\nhttps://www.arbornetworks.com/blog/asert/wp-content/uploads/2016/02/ASERT-ThreatIntelligence-Brief-2016-02-Corebot-1.pdf\n\n## Published by malwarebreakdown\n\nJust a normal person who spends their free time infecting systems with malware. View all\nposts by malwarebreakdown\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2017/2017-09-11 - “Re- Details” Malspam Downloads CoreBot Banking Trojan.pdf"
    ],
    "report_names": [
        "2017-09-11 - “Re- Details” Malspam Downloads CoreBot Banking Trojan.pdf"
    ],
    "threat_actors": [
        {
            "id": "75108fc1-7f6a-450e-b024-10284f3f62bb",
            "created_at": "2024-11-01T02:00:52.756877Z",
            "updated_at": "2025-03-27T02:00:55.544216Z",
            "deleted_at": null,
            "main_name": "Play",
            "aliases": null,
            "source_name": "MITRE:Play",
            "tools": [
                "Nltest",
                "AdFind",
                "PsExec",
                "Wevtutil",
                "Cobalt Strike",
                "Playcrypt",
                "Mimikatz"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1673536094,
    "ts_updated_at": 1743041786,
    "ts_creation_date": 1653688495,
    "ts_modification_date": 1653688495,
    "files": {
        "pdf": "https://archive.orkl.eu/c09371fc429b4cd88ef67550cd77508b8863c7a6.pdf",
        "text": "https://archive.orkl.eu/c09371fc429b4cd88ef67550cd77508b8863c7a6.txt",
        "img": "https://archive.orkl.eu/c09371fc429b4cd88ef67550cd77508b8863c7a6.jpg"
    }
}