{
    "id": "0170daf6-8fb1-4b7d-bb59-3e987faccdd4",
    "created_at": "2023-01-12T15:01:49.802589Z",
    "updated_at": "2025-03-27T02:06:00.834054Z",
    "deleted_at": null,
    "sha1_hash": "110c82590bedd3f363207b3589ba9b9770764c4a",
    "title": "2021-10-27 - Avast releases decryptor for AtomSilo and LockFile ransomware",
    "authors": "",
    "file_creation_date": "2022-05-27T21:07:00Z",
    "file_modification_date": "2022-05-27T21:07:00Z",
    "file_size": 337482,
    "plain_text": "# Avast releases decryptor for AtomSilo and LockFile ransomware\n\n**[decoded.avast.io/threatintel/decryptor-for-atomsilo-and-lockfile-ransomware/](https://decoded.avast.io/threatintel/decryptor-for-atomsilo-and-lockfile-ransomware/)**\n\nOctober 27, 2021\n\nby [Threat Intelligence TeamOctober 27, 20213 min read](https://decoded.avast.io/author/threatintel/)\n\nOn Oct 17, 2021, [Jiří Vinopal](https://twitter.com/vinopaljiri) [published information about a weakness in the](https://twitter.com/vinopaljiri/status/1449550289204391940) `AtomSilo`\nransomware and that it is possible to decrypt files without paying the ransom. Slightly later, he\n[also analyzed another ransomware strain, LockFile. We prepared our very own free Avast](https://twitter.com/vinopaljiri/status/1451653915578097665)\ndecryptor for both the `AtomSilo and` `LockFile strains.`\n\n## Limitation of the decryptor\n\nDuring the decryption process, the `Avast AtomSilo decryptor relies on a known file`\nformat in order to verify that the file was successfully decrypted. For that reason, some files\nmay not be decrypted. This can include files with proprietary or unknown format, or with no\nformat at all, such as text files.\n\n## How AtomSilo and LockFile Work\n\nBoth the `AtomSilo and` `LockFile ransomware strains are very similar to each other and`\nexcept for minor differences, this description covers both of them.\n```\n AtomSilo ransomware searches local drives using a fixed drive list, whilst LockFile calls\n GetLogicalDriveStringsA() and processes all drives that are fixed drives.\n\n```\nA separate thread is created for each drive in the list. This thread recursively searches the\ngiven logical drive and encrypts files found on it. To prevent paralyzing the compromised PC\nentirely, `AtomSilo has a list of folders, file names and file types that are left unencrypted`\nwhich are listed here:\n\nExcluded folders\n\nBoot Windows Windows.old Tor Browser\n\n\n-----\n\nInternet Explorer Google Opera Opera Software\n\nMozilla Mozilla Firefox $Recycle.Bin ProgramData\n\nAll Users\n\nExcluded files\n\nautorun.inf index.html boot.ini bootfont.bin\n\nbootsect.bak bootmgr bootmgr.efi bootmgfw.efi\n\ndesktop.ini iconcache.db ntldr ntuser.dat\n\nntuser.dat.log ntuser.ini thumbs.db #recycle\n\nExcluded extensions\n\n.hta .html .exe .dll .cpl .ini\n\n.cab .cur .cpl .drv .hlp .icl\n\n.icns .ico .idx .sys .spl .ocx\n```\nLockFile avoids files and folders, containing those sub-strings:\n\n```\nExcluded sub-strings\n\nWindows NTUSER LOCKFILE .lockfile\n\nIn addition to that, there is a list of `788 file types (extensions), which won’t be encrypted.`\nThose include `.exe, but also` `.jpg,` `.bmp` and `.gif . You may noticed that some of`\nthem are included repeatedly.\n\nThe ransomware generates `RSA-4096 session keypair for each victim. Its private part is then`\nstored in the ransom note file, encrypted by the master `RSA key (hardcoded in the binary). A`\nnew `AES-256 file key is generated for each file. This key is then encrypted by the session`\n```\nRSA key and stored at the end of the encrypted file, together with original file size.\n\n```\nEach encrypted file contains a ransom note file with one of the names:\n```\n   README-FILE-%ComputerName%-%TimeStamp%.hta\n   LOCKFILE-FILE-%ComputerName%-%TimeStamp%.hta\n\n```\nEncrypted files can be recognized by the `.ATOMSILO or` `.lockfile extension:`\n\nWhen the encryption process is complete, the ransom note is shown to the user. Each strain’s\nransom note has its own look:\n\n\n-----\n\nAtomSilo Ransom Message\nLockFile Ransom Message\n\n## How to use the Decryptor\n\nTo decrypt your files, please, follow these steps:\n\n[1. Download the free decryptor. The single EXE file covers both ransomware strains.](https://files.avast.com/files/decryptor/avast_decryptor_atomsilo.exe)\n2. Simply run the EXE. It starts in form of wizard, which leads you through configuration of\n\nthe decryption process.\n3. On the initial page, you can see a list of credits. Simply click “Next”\n\n1. On the next page, select the list of locations which you want to be decrypted. By default,\n\nit contains a list of all local drives.\n\n1. On the third page, you can select whether you want to backup encrypted files. These\n\nbackups may help if anything goes wrong during the decryption process. This option is\nturned on by default, which we recommend. After clicking “Decrypt”, the decryption\nprocess begins.\n\n1. Let the decryptor work and wait until it finishes.\n\n## Credits\n\n[We would like to thank Jiří](https://twitter.com/vinopaljiri) [Vinopal for sharing analysis of both ransomware strains.](https://twitter.com/vinopaljiri)\n\n## IOCs\n\nSHA filename\n```\n d9f7bb98ad01c4775ec71ec66f5546de131735e6dba8122474cc6eb62320e47b .ATOMSILO\n bf315c9c064b887ee3276e1342d43637d8c0e067260946db45942f39b970d7ce .lockfile\n\n```\n[Tagged asanalysis,](https://decoded.avast.io/tag/analysis/) [decryptors,](https://decoded.avast.io/tag/decryptors/) [malware,](https://decoded.avast.io/tag/malware/) [ransomware](https://decoded.avast.io/tag/ransomware/)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-10-27 - Avast releases decryptor for AtomSilo and LockFile ransomware.pdf"
    ],
    "report_names": [
        "2021-10-27 - Avast releases decryptor for AtomSilo and LockFile ransomware.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673535709,
    "ts_updated_at": 1743041160,
    "ts_creation_date": 1653685620,
    "ts_modification_date": 1653685620,
    "files": {
        "pdf": "https://archive.orkl.eu/110c82590bedd3f363207b3589ba9b9770764c4a.pdf",
        "text": "https://archive.orkl.eu/110c82590bedd3f363207b3589ba9b9770764c4a.txt",
        "img": "https://archive.orkl.eu/110c82590bedd3f363207b3589ba9b9770764c4a.jpg"
    }
}