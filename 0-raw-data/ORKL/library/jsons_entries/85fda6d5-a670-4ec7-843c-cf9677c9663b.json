{
    "id": "85fda6d5-a670-4ec7-843c-cf9677c9663b",
    "created_at": "2023-01-12T15:08:14.149934Z",
    "updated_at": "2025-03-27T02:15:35.674439Z",
    "deleted_at": null,
    "sha1_hash": "eb2a1e008434cbcdcb9b63731eb53b985aaa6492",
    "title": "2017-07-24 - The Seamless Campaign Drops Ramnit. Follow-up Malware- AZORult Stealer, Smoke Loader, etc.",
    "authors": "",
    "file_creation_date": "2022-05-27T21:54:49Z",
    "file_modification_date": "2022-05-27T21:54:49Z",
    "file_size": 1374296,
    "plain_text": "# The Seamless Campaign Drops Ramnit. Follow-up Malware: AZORult Stealer, Smoke Loader, etc.\n\n**malwarebreakdown.com/2017/07/24/the-seamless-campaign-drops-ramnit-follow-up-malware-azorult-stealer-smoke-**\nloader-etc/\n\nJuly 24, 2017\n\nAlthough there continues to be an overall decrease in EK activity I’m still seeing a decent\n[amount of malvertising leading to EKs. One campaign that I run into a lot is Seamless. It’s](https://umbrella.cisco.com/blog/blog/2017/03/29/seamless-campaign-delivers-ramnit-via-rig-ek/)\nlike other malvertising campaigns in that much of the traffic originates from streaming video\nsites. These kinds of sites make good targets for threat actors as they get a lot of traffic and,\nmore importantly, they often have poor advertising standards. The site I used for this infection\nchain is in Alexa’s top 900 global sites and top 800 for the United States. Further analysis\nreveals that the site received an estimated 13,970,000 visits over the last 30 days. That’s a\nlot of potential victims.\n\nBelow is a very basic flowchart of the infection chain:\n\n\n-----\n\nBelow is a breakdown of each of the events leading to the Seamless campaign and then to\nRIG EK.\n\n\n-----\n\nSyndication.exdynsrv.com returns a 302 Found and points to a new location\nat tqbeu.voluumtrk.com. This subdomain uses Voluum’s\n\nweb analytics system to collect statistical data.\n\nWe then see a GET request for a resource located at tqbeu.voluumtrk.com. The server\nresponds with 302 Found and points to the Seamless infrastructure at 194[.]58[.]38[.]50/usa:\n\n194[.]58[.]38[.]50/usa redirects to 194[.]58[.]38[.]50/usa/:\n\n\n-----\n\nJavaScript gets the time zone information from the user:\n\nTime zone information is POSTed back to the server. The server responds with script that\nredirects the host back to another resource located at tqbeu.voluumtrk.com:\n\n\n-----\n\nTraffic is being filtered at this point, with unwanted traffic being redirected to benign sites that\nbreak the infection chain.\n\nContinuing with the infection chain we see tqbeu.voluumtrk.com redirect to\ntqbeu.redirectvoluum.com:\n\nThis time the URL contains some Base64 encoded data, which decodes to the Seamless\ngate:\n\nThe Seamless gate returns an iframe containing the location of the RIG EK landing page:\n\nSeamless continues to drop Ramnit (qzsn3aad.exe found in %TEMP%) via RIG EK. Postinfection Ramnit traffic shows DNS queries for DGA domains:\n\n\n-----\n\nActive C2 traffic via TCP port 443:\n\n185.118.65.143 – hdyejdn638ir8.com\n46.17.44.131 – eppixrakqeueuttiuvi.com\n185.159.129.127 and 194.58.112.174 – tmgmgjcvt.com\n\nAfter the initial malware payload dropped I decided to restart my host and noticed additional\ndownloads for “satbin.exe” (AKA V3.exe and javasch.exe), “AU2_EXEsd.exe” and\n“Loader.exe” (AKA Lw321.exe), which were all located at steelskull[.]com.\n\nSteelskull.com, created on 11/16/2015, appears to be a hacked site that sells steel Biker jewelry in the\n\nshape of skulls.\nBelow is an image of the GET and POST requests associated with the malvertising\nchain, RIG EK activity, additional downloads, and the post-infection traffic:\n\n\n-----\n\nThe first GET request for additional files after I restarted my host was for satbin.exe. Running\nsatbin.exe (AKA V3.exe and javasch.exe) generated POST requests to\n103.253.27.234/teststeal/gate.php. The User-Agent used during these POST requests\nwas “Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; .NET CLR 1.1.4322; .NET\n_CLR 2.0.50727).” We can also see it using api.ipify.org to grab the host external IP address._\n\nFurther research shows that satbin.exe (AKA V3.exe – found in %LOCALAPPDATA% and\njavasch.exe – found in %APPDATA%) dropped javasch.js in %APPDATA%:\n\n\n-----\n\nOpening javasch.js.txt in Notepad++ shows a lot of garbage, however, switching the\nlanguage to JavaScript quickly reveals the real code:\n\nCredit to my friend “IRDivision”\nLogin panel:\n\n\n-----\n\nThe second GET request for additional files after I restarted my host was\n[for AU2_EXEsd.exe, which was identified by @Antelox (thanks again!) as AZORult Stealer.](https://twitter.com/Antelox)\n\nLogo for AZORult Stealer\nPost-infection traffic caused by AZORult shows POST requests to parkingservices.us/gate.php, which currently resolves to 185.100.222.41.\n\nLogin panel:\n\n\n-----\n\nBelow is a list of capabilities offered by AZORult Stealer.\n\n_Steals saved passwords from following programs (Browsers, Email, FTP, IM):_\n\n_Google Chrome_\n_Google Chrome x64_\n_YandexBrowser_\n_Opera_\n_Mozilla Firefox_\n_InternetMailRu_\n_ComodoDragon_\n_Amigo_\n_Bromium_\n_Chromium_\n_Outlook_\n_Thunderbird_\n_Filezilla_\n_Pidgin_\n_PSI_\n_PSI Plus_\n\n_Steals cookies from browsers and forms (form history, autofill):_\n\n_Google Chrome_\n_Google Chrome x64_\n_YandexBrowser_\n_Opera_\n_Mozilla Firefox_\n_InternetMailRu_\n_ComodoDragon_\n_Amigo_\n_Bromium_\n_Chromium_\n\n_Bitcoin client’s files_\n\n_Collects wallet.dat files from popular bitcoin clients (bitcoin, litecoin, etc)_\n\n_Skype message history_\n\n_Grabs files from chat history. Files are read with special utilities._\n\n_Desktop files grabber_\n\n\n-----\n\n_Collects files with specified extensions from Desktop. Filter by file size. Recursively_\n_searches files in folders._\n\n_List of installed programs_\n_List of running processes_\n_Username, computer name, OS, RAM_\n\nImages taken from forums:\n\n\n-----\n\n-----\n\nAZORult sample reversed by Vitali Kremez:\n\n[http://www.vkremez.com/2017/07/lets-learn-reversing-credential-and.html](http://www.vkremez.com/2017/07/lets-learn-reversing-credential-and.html)\n\nThe third download was for Loader.exe (AKA Lw321.exe), which was identified by Hybrid[Analysis and @Antelox as Smoke Loader. Post-infection traffic from this sample shows](https://twitter.com/Antelox)\nPOST requests to zabugrom.bit/smk2/ – resolving to 109.169.89.50.\n\nAdditional Pictures of the File System After Infection\n\n\n-----\n\n-----\n\nIOCs\n\n52.52.15.205 – tqbeu.voluumtrk.com\n54.183.53.133 – tqbeu.redirectvoluum.com\n194.58.38.50 – Seamless campaign\n194.58.58.70 – GET /signup4.php – Seamless gate\n188.225.87.49 – RIG EK\n185.118.65.143 – hdyejdn638ir8.com – Ramnit C2\n46.17.44.131 – eppixrakqeueuttiuvi.com – Ramnit C2\n185.159.129.127 and 194.58.112.174 – tmgmgjcvt.com – Ramnit C2\n46.105.57.169 – steelskull.com – Hacked site serving up malware\n185.100.222.41 – parking-services.us – POST /gate.php – AZORult stealer\n103.253.27.234 – POST /teststeal/gate.php\n109.169.89.50 – zabugrom.bit – POST /smk2/ – Smoke Loader\n\nHashes\n\n[SHA256: 83df67f6fcec4015d345684e31773eb3488295703de09306eadf34fe3bc0b420](https://www.virustotal.com/en/file/83df67f6fcec4015d345684e31773eb3488295703de09306eadf34fe3bc0b420/analysis/1500852884/)\n\nFile name: RIG EK landing page at 188.225.87.49.txt\n\n[SHA256: 5aa4502dc361d3d913ea5443c15e59831bc1db3b696f0d5347442744b36e957b](https://www.virustotal.com/en/file/5aa4502dc361d3d913ea5443c15e59831bc1db3b696f0d5347442744b36e957b/analysis/1500852872/)\n\nFile name: Flash exploit from RIG EK at 188.225.87.49.swf\n\n[SHA256: e98a80523922ac53858990234332cb9ba4c74ee4d3e2c5764d4d7b1fb7f84e10](https://www.virustotal.com/en/file/e98a80523922ac53858990234332cb9ba4c74ee4d3e2c5764d4d7b1fb7f84e10/analysis/)\n\nFile name: o32.tmp\n\n[SHA256: 7c73071a01fd77c06e43f4500201cd2eb20991bbb4116ae47e07b6864ad0b58e](https://www.virustotal.com/en/file/7c73071a01fd77c06e43f4500201cd2eb20991bbb4116ae47e07b6864ad0b58e/analysis/)\n\nFile name: qzsn3aad.exe\n\n[SHA256: babd9eb251ebebe53fda65c3d070200c1362b6d8cc619543b3d31c433d8608bb](https://www.virustotal.com/en/file/babd9eb251ebebe53fda65c3d070200c1362b6d8cc619543b3d31c433d8608bb/analysis/)\n\nFile name: satbin.exe (AKA V3.exe and javasch.exe)\n\n[SHA256: cf3459cf29125101f5bea3f4206d8e43dbe097dd884ebf3155c49b276736f727](https://www.virustotal.com/en/file/cf3459cf29125101f5bea3f4206d8e43dbe097dd884ebf3155c49b276736f727/analysis/)\n\nFile name: AU2_EXEsd.exe\n\n[SHA256: 0b5d583fd8b03e642707678800199d265bfea5563dbde982479222365af01d24](https://www.virustotal.com/en/file/0b5d583fd8b03e642707678800199d265bfea5563dbde982479222365af01d24/analysis/)\n\nFile name: Loader.exe (AKA Lw321.exe)\n\n\n-----\n\nDownloads\n\n[Password is “infected” – Malicious Artifacts.zip](https://malwarebreakdown.com/wp-content/uploads/2017/07/malicious-artifacts.zip)\n\nUntil next time!\n\n## Published by malwarebreakdown\n\nJust a normal person who spends their free time infecting systems with malware. View all\nposts by malwarebreakdown\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2017/2017-07-24 - The Seamless Campaign Drops Ramnit. Follow-up Malware- AZORult Stealer, Smoke Loader, etc..pdf"
    ],
    "report_names": [
        "2017-07-24 - The Seamless Campaign Drops Ramnit. Follow-up Malware- AZORult Stealer, Smoke Loader, etc..pdf"
    ],
    "threat_actors": [
        {
            "id": "9f101d9c-05ea-48b9-b6f1-168cd6d06d12",
            "created_at": "2023-01-06T13:46:39.396409Z",
            "updated_at": "2025-03-27T02:00:03.074969Z",
            "deleted_at": null,
            "main_name": "Earth Lusca",
            "aliases": [
                "CHROMIUM",
                "ControlX",
                "Red Dev 10",
                "RedHotel",
                "Red Scylla",
                "TAG-22",
                "BRONZE UNIVERSITY",
                "AQUATIC PANDA",
                "Charcoal Typhoon",
                "BountyGlad"
            ],
            "source_name": "MISPGALAXY:Earth Lusca",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "6abcc917-035c-4e9b-a53f-eaee636749c3",
            "created_at": "2022-10-25T16:07:23.565337Z",
            "updated_at": "2025-03-27T02:02:09.868522Z",
            "deleted_at": null,
            "main_name": "Earth Lusca",
            "aliases": [
                "Bronze University",
                "Charcoal Typhoon",
                "Chromium",
                "Red Dev 10",
                "Red Scylla"
            ],
            "source_name": "ETDA:Earth Lusca",
            "tools": [
                "Agentemis",
                "AntSword",
                "BIOPASS",
                "BIOPASS RAT",
                "BadPotato",
                "Behinder",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "Doraemon",
                "FRP",
                "Fast Reverse Proxy",
                "FunnySwitch",
                "HUC Port Banner Scanner",
                "KTLVdoor",
                "Mimikatz",
                "NBTscan",
                "POISONPLUG.SHADOW",
                "PipeMon",
                "RbDoor",
                "RibDoor",
                "RouterGod",
                "SAMRID",
                "ShadowPad Winnti",
                "SprySOCKS",
                "WinRAR",
                "Winnti",
                "XShellGhost",
                "cobeacon",
                "fscan",
                "lcx",
                "nbtscan"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "d53593c3-2819-4af3-bf16-0c39edc64920",
            "created_at": "2022-10-27T08:27:13.212301Z",
            "updated_at": "2025-03-27T02:00:55.529662Z",
            "deleted_at": null,
            "main_name": "Earth Lusca",
            "aliases": [
                "Earth Lusca",
                "TAG-22",
                "Charcoal Typhoon",
                "CHROMIUM",
                "ControlX"
            ],
            "source_name": "MITRE:Earth Lusca",
            "tools": [
                "Mimikatz",
                "PowerSploit",
                "Tasklist",
                "certutil",
                "Cobalt Strike",
                "Winnti for Linux",
                "Nltest",
                "NBTscan",
                "ShadowPad"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1673536094,
    "ts_updated_at": 1743041735,
    "ts_creation_date": 1653688489,
    "ts_modification_date": 1653688489,
    "files": {
        "pdf": "https://archive.orkl.eu/eb2a1e008434cbcdcb9b63731eb53b985aaa6492.pdf",
        "text": "https://archive.orkl.eu/eb2a1e008434cbcdcb9b63731eb53b985aaa6492.txt",
        "img": "https://archive.orkl.eu/eb2a1e008434cbcdcb9b63731eb53b985aaa6492.jpg"
    }
}