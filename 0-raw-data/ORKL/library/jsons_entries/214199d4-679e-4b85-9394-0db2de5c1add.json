{
    "id": "214199d4-679e-4b85-9394-0db2de5c1add",
    "created_at": "2023-01-12T15:00:00.390686Z",
    "updated_at": "2025-03-27T02:13:11.75587Z",
    "deleted_at": null,
    "sha1_hash": "8c5d6c7b36fe57414203a40929f19120e34500e1",
    "title": "2021-04-29 - UNC2447 SOMBRAT and FIVEHANDS Ransomware- A Sophisticated Financial Threat",
    "authors": "",
    "file_creation_date": "2022-05-28T15:50:06Z",
    "file_modification_date": "2022-05-28T15:50:06Z",
    "file_size": 151199,
    "plain_text": "# UNC2447 SOMBRAT and FIVEHANDS Ransomware: A Sophisticated Financial Threat\n\n**fireeye.com/blog/threat-research/2021/04/unc2447-sombrat-and-fivehands-ransomware-sophisticated-financial-**\nthreat.html\n\nThreat Research\n\nTyler McLellan, Justin Moore, Raymond Leong\n\nApr 29, 2021\n\n15 mins read\n\nRansomware\n\nUncategorized Groups (UNC Groups)\n\nThreat Research\n\n\n-----\n\nZero Day Threats\n\nMandiant has observed an aggressive financially motivated group, UNC2447, exploiting one\nSonicWall VPN zero-day vulnerability prior to a patch being available and deploying\nsophisticated malware previously reported by other vendors as SOMBRAT. Mandiant has\nlinked the use of SOMBRAT to the deployment of ransomware, which has not been\npreviously reported publicly.\n\nUNC2447 monetizes intrusions by extorting their victims first with FIVEHANDS ransomware\nfollowed by aggressively applying pressure through threats of media attention and offering\nvictim data for sale on hacker forums. UNC2447 has been observed targeting organizations\nin Europe and North America and has consistently displayed advanced capabilities to evade\ndetection and minimize post-intrusion forensics.\n\nMandiant has observed evidence of UNC2447 affiliated actors previously using\nRAGNARLOCKER ransomware. Based on technical and temporal observations of\nHELLOKITTY and FIVEHANDS deployments, Mandiant suspects that HELLOKITTY may\nhave been used by an overall affiliate program from May 2020 through December 2020, and\nFIVEHANDS since approximately January 2021.\n\n**Background**\n\nIn November 2020, Mandiant created UNC2447, an uncategorized group observed using the\nnovel WARPRISM PowerShell dropper to install BEACON at two Mandiant Managed\nDefense clients. Mandiant Managed Defence quicky neutralized these intrusions and did not\nobserve attempts to deploy ransomware.\n\nIn January and February 2021, Mandiant Consulting observed a novel rewrite of\nDEATHRANSOM—dubbed FIVEHANDS—along with SOMBRAT at multiple victims that\nwere extorted. During one of the ransomware intrusions, the same WARPRISM and\nBEACON samples previously clustered under UNC2447 were observed. Mandiant was able\nto forensically link the use of WARPRISM, BEACON, SOMBRAT and FIVEHANDS to the\nsame actor.\n\nMandiant suspects that HELLOKITTY activity in late-2020 may be related to the overall\naffiliate program and that usage shifted to FIVEHANDS ransomware beginning in January\n2021.\n\nIn April 2021, Mandiant observed a private FIVEHANDS TOR chat using a\nHELLOKITTY favicon (Figure 1).\n\n\n-----\n\nFIVEHANDS Hello Kitty icon\n\n\nFigure 1: FIVEHANDS Hello Kitty icon\nWhen affiliate-based ransomware is observed by Mandiant, uncategorized clusters are\nassigned based on the infrastructure used, and in the case of UNC2447 were based on the\nSOMBRAT and Cobalt Strike BEACON infrastructure used across 5 intrusions between\nNovember 2020 and February 2021. Generally, Mandiant uses caution even with novel\nmalware such as SOMBRAT and WARPRISM and clusters each use rigorously according to\nall observed activity. For more information on uncategorized threats, refer to our post,\n[\"DebUNCing Attribution: How Mandiant Tracks Uncategorized Threat Actors.\"](https://www.mandiant.com/resources/how-mandiant-tracks-uncategorized-threat-actors)\n\n**SonicWall SMA 100 Series Appliance Vulnerability**\n\nCVE-2021-20016 is a critical SQL injection vulnerability that exploits unpatched SonicWall\nSecure Mobile Access SMA 100 series remote access products. A remote, unauthenticated\nattacker could submit a specially crafted query in order to exploit the vulnerability. Successful\nexploitation would grant an attacker the ability to access login credentials (username,\n\n\n-----\n\npassword) as well as session information that could then be used to log into a vulnerable\nunpatched SMA 100 series appliance. This vulnerability only impacted the SMA 100 series\nand was patched by SonicWall in February 2021. For more information on this vulnerability,\nplease refer to [SonicWall PSIRT advisory SNWLID-2021-0001.](https://psirt.global.sonicwall.com/vuln-detail/SNWLID-2021-0001)\n\n**WARPRISM**\n\nWARPRISM is a PowerShell dropper that has been observed by Mandiant delivering\nSUNCRYPT, BEACON, and MIMIKATZ. WARPRISM is used to evade endpoint detection\nand will load its payload directly into memory. WARPRISM may be used by multiple groups.\n\n**FOXGRABBER**\n\nFOXGRABBER is a command line utility used to harvest FireFox credential files from remote\nsystems. It contains the PDB path:\nC:\\Users\\kolobko\\Source\\Repos\\grabff\\obj\\Debug\\grabff.pdb. FOXGRABBER has also been\nobserved in DARKSIDE ransomware intrusions.\n\n**BEACON Malleable Profiles**\n\nIn the initial stages of an intrusion, UNC2447 uses the Cobalt Strike BEACON\nHTTPSSTAGER implant for persistence to communicate with command-and-control (C2)\nservers over HTTPS and has been observed using ‘chches_APT10’ and ‘Havex’ Malleable\nprofiles.\n\n**UNC2447 Toolbox**\n\nDuring the recon and exfiltration stage of intrusions, UNC2447 has been observed using the\nfollowing tools: ADFIND, BLOODHOUND, MIMIKATZ, PCHUNTER, RCLONE,\nROUTERSCAN, S3BROWSER, ZAP and 7ZIP. UNC2447 may tamper with windows security\nsettings, firewall rules, and antivirus protection.\n\n**SOMBRAT Overview**\n\nSOMBRAT was first reported by Blackberry Cylance in November 2020 as \"The CostaRicto\nCampaign: Cyber-Espionage Outsourced\" as a potential espionage-for-hire criminal group.\nMandiant has now observed SOMBRAT alongside FIVEHANDS ransomware intrusions.\n\nThe SOMBRAT backdoor is packaged as a 64-bit Windows executable. It communicates with\na configurable command and control (C2) server via multiple protocols, including DNS, TLSencrypted TCP, and potentially WebSockets. Although the backdoor supports dozens of\ncommands, most of them enable the operator to manipulate an encrypted storage file and\nreconfigure the implant. The backdoor's primary purpose is to download and execute plugins\nprovided via the C2 server. In contrast to the SOMBRAT version published in November\n2020, Mandiant observed additional obfuscation and armoring to evade detection, this\n\n\n-----\n\nSOMBRAT variant has been hardened to discourage analysis. Program metadata typically\nincluded by the compiler has been stripped and strings have been inlined and encoded via\nXOR-based routines.\n\n**The SOMBRAT Launcher**\n\nThis SOMBRAT backdoor variant must be deployed alongside four additional resources that\nserve as launchers. They are typically installed to the hardcoded directory path\n`C:\\ProgramData\\Microsoft`.\n\npath: `C:\\programdata\\Microsoft\\WwanSvc.bat` - launcher for `WwanSvc.txt`\npath: `C:\\programdata\\Microsoft\\WwanSvc.txt` - decoder and launcher for\n`WwanSvc.c`\npath: `C:\\programdata\\Microsoft\\WwanSvc.c` - decoder and launcher for `WwanSvc.b`\npath: `C:\\programdata\\Microsoft\\WwanSvc.a` - XOR key\npath: `C:\\programdata\\Microsoft\\WwanSvc.b` - encoded SOMBRAT backdoor\npath: `%TEMP%\\<possibly unique random name>` - encrypted storage file\npath: `%TEMP%\\<possibly unique random name _<integer>` - encrypted storage file\npath: `C:\\ProgramData\\<possibly unique random name ` - encrypted configuration file\n\nOther variations of the filenames were observed such as ntuser and wapsvc.\n\n**SOMBRAT Technical Details**\n\nThe SOMBRAT backdoor is written in modern C++ and implemented as a collection of\n\"plugins\" that interoperate with one another. There are five plugins distributed with this\nvariant: `core`, `network`, `storage`, `taskman`, and `debug` (the `config` plugin described by\nBlackberry is not present). The core plugins communicate with the C2 server via messages\nsent over a common networking layer; each plugin supports its own set of messages, and\nthe backdoor protocol can be extended by dynamically loaded plugins.\n\nThe `core` plugin coordinates state tracking, such as network connectivity, and dynamic\nplugin loading and unloading. The `network` plugin configures the networking layer used to\ncommunicate with the C2 server, for example enabling the operator to switch between DNS\nand TCP protocols. The `storage` plugin exposes logical operations, such as read and write,\nfor an encrypted file used to store plugins, resources, and arbitrary data. The `taskman`\nplugin enables the operator to list and kill processes on the compromised system. Finally, the\n`debuglog` plugin supports a single command to records debug messages.\n\nGiven that the core plugins do not enable an operator directly execute arbitrary commands or\nreconfigure the system, the primary function of the SOMBRAT backdoor is to load plugins\nprovided via the C2 server. These plugins may be shellcode or DLL modules to be\ndynamically loaded. The C2 server may instruct the backdoor to load the plugins directly or\npersist them into the encrypted storage file, where they may subsequently be reloaded, such\nas after upgrading the backdoor.\n\n\n-----\n\nMalware author mark No one is perfect except me.\n\n\nFigure 2: Malware author mark “No one is perfect except me.”\nSOMBRAT evades forensic analysis by patching the process memory used to record\ncommand line arguments. It replaces the initial command line with the base filename of the\nprogram executable, removing any arguments. This means that investigators that inspect a\nprocess listing via memory forensics will see the innocuous-looking command line\n`powershell.exe` rather than references to the uncommon filename such as `WwanSvc.c`.\n\n**SOMBRAT Network Communications**\n\nThe SOMBRAT backdoor can communicate with its C2 server using both DNS and a proxyaware, TLS-encrypted stream protocol. By default, the backdoor uses the DNS protocol;\nhowever, this can be reconfigured by the C2 server. Mandiant observed the domains\nfeticost[.]com and celomito[.]com used for DNS C2 communications.\n\n\n-----\n\nWhen the backdoor communicates via its DNS protocol, it constructs and resolves FQDNs,\ninterpreting the DNS results to extract C2 messages. The authoritative DNS server embeds\ndata within the IP address field of DNS A record results and within the Name Administrator\nfield of DNS TEXT record results. By making many requests to unique subdomains of the C2\ndomain, the backdoor can slowly transmit information a few bytes at a time.\n\n**Ransomware Similarities**\n\nBeginning in October 2020, Mandiant observed samples of a customized version of\nDEATHRANSOM. This newly modified version removed the language check feature (Figure\n3 shows the language check of DEATHRANSOM).\n\n\nLanguage check from Fortinet blog\n\n\n[Figure 3: Language check from Fortinet blog](https://www.fortinet.com/blog/threat-research/death-ransom-new-strain-ransomware)\n\n\n-----\n\n[HELLOKITTY ransomware—used to target Polish video game developer CD Projekt](https://www.bleepingcomputer.com/news/security/HELLOKITTY-ransomware-behind-cd-projekt-red-cyberattack-data-theft/)\nRed—is reportedly built from DEATHRANSOM.\n\nHELLOKITTY is named after a mutex named ‘HELLOKITTYMutex,’ used when\nthe malware executable is launched (see Figure 4).\n\n\nHELLOKITTY mutex shown in Process Explorer\n\n\nFigure 4: HELLOKITTY mutex shown in Process Explorer\n\nCEMIG (Companhia Energética de Minas Gerais), a Brazilian electric power company,\n[revealed on Facebook in late December 2020 that it was a victim of HELLOKITTY](https://www.cisoadvisor.com.br/ataque-de-ransomware-na-cemig-derruba-sites-e-atendimento/)\ncyber attack.\n\nIn January 2021, Mandiant observed a new ransomware deployed against a victim and\nassigned the name FIVEHANDS.\n\n\n-----\n\nAnalysis of FIVEHANDS revealed high similarity to DEATHRANSOM, sharing several\nfeatures, functions, and coding similarities. Absent in FIVEHANDS is a language\ncheck, similar to HELLOKITTY\nBoth DEATHRANSOM and FIVEHANDS drops a ransom note in all non-excluded\ndirectories\n\n**Technical Comparison of FIVEHANDS, HELLOKITTY and DEATHRANSOM**\n\nDEATHRANSOM is written in C while the other two families are written in C++.\nDEATHRANSOM uses a distinct series of do/while loops to enumerate through network\nresources, logical drives, and directories. It also uses QueueUserWorkItem to implement\nthread pooling for its file encryption threads.\n\nHELLOKITTY is written in C++, but reimplements a significant portion of DEATHRANSOM's\nfunctionality using similar loop operations and thread pooling via QueueUserWorkItem. The\ncode structure to enumerate network resources, logical drives, and perform file encryption is\nvery similar. Additionally, HELLOKITTY and DEATHRANSOM share very similar functions to\ncheck for the completion status of their encryption threads before exiting.\n\nFIVEHANDS is written in C++ and although high level functionality is similar, the function\ncalls and code structure to implement the majority of the functionality is written differently.\nAlso, instead of executing threads using QueueUserWorkItem, FIVEHANDS uses\nIoCompletionPorts to more efficiently manage its encryption threads. FIVEHANDS also uses\nmore functionality from the C++ standard template library (STL) than does HELLOKITTY.\n\n**Deletion of Volume Shadow Copies**\n\nDEATHRANSOM, HELLOKITTY, and FIVEHANDS use the same code to delete volume\nshadow copies via WMI by performing the query select * from Win32_ShadowCopy and then\ndeleting each instance returned by its id.\n\n**Encryption Operations**\n\nEach of these three malware families utilizes a similar encryption scheme. An asymmetric\npublic key is either hard-coded or generated. A unique symmetric key is generated for each\nencrypted file.\n\nAfter each file is encrypted, the asymmetric key will encrypt the symmetric key and\nappend it to the encrypted file. Additionally, a unique four byte magic value is appended\nto the end of the encrypted file. The malware checks for these magic bytes to ensure it\ndoes not encrypt a previously encrypted file again.\nDEATHRANSOM and HELLOKITTY implement the file encryption operations using a\nvery similar code structure and flow.\nFIVEHANDS implements its file encryption with a differing code structure and uses\ndifferent embedded encryption libraries.\n\n\n-----\n\nIn addition to the symmetric key, HELLOKITTY and FIVEHANDS also encrypts file\nmetadata with the public key and appends this to the encrypted file.\nDEATHRANSOM generates an RSA key pair while HELLOKITTY and FIVEHANDS\nuse an embedded RSA or NTRU public key.\n\n**DEATHRANSOM Encryption**\n\nDEATHRANSOM creates an RSA-2048 public and private key pair. Using an Ellipticcurve Diffie–Hellman (ECDH) routine implemented with Curve25519, it computes a\nshared secret using two input values: 1) 32 random bytes from a RtlGenRandom call\nand 2) a hardcoded 32 byte value (attacker's public key). It also create a Curve25519\npublic key. The shared secret is SHA256 hashed and used as the key to Salsa20\nencrypt the RSA public and private keys.\nThe RSA public key is used to encrypt the individual symmetric keys that are used to\nencrypt each file. A Base64 encoded version of the encrypted RSA keys and the\nvictim’s Curve25519 public key is included in the ransom note, providing the threat\nactors the information needed to decrypt the victim's files.\nFor the symmetric key, DEATHRANSOM calls RtlGenRandom to generate 32 random\nbytes. This is the 32 byte key used to AES encrypt each file. After the file is encrypted,\nthe AES key is encrypted with the public RSA key and appended to the file.\nDEATHRANSOM lastly appends the four magic bytes of AB CD EF AB at the end of\nthe encrypted file and uses this as a check to ensure that it does not encrypt an already\nencrypted file.\nThe analyzed DEATHRANSOM sample used for comparison does not change the file\nextension.\n\n**HELLOKITTY Encryption**\n\nHELLOKITTY contains an embedded RSA-2048 public key. This public key is SHA256\nhashed and used as the victim ID within the ransom note. This RSA pubic key is also\nused to encrypt each file's symmetric key.\nFor the symmetric key, HelloKitty generates a 32 byte seed value based on the CPU\ntimestamp. A Salsa20 key is generated and encrypts a second 32 byte seed value. The\nencrypted result is XOR’d with the first seed, resulting in a 32 byte key used to AES\nencrypt each file.\nAfter each file is encrypted, the original file size, magic value of DE C0 AD BA, and\nAES key are encrypted with the public RSA key and appended to the file.\nHELLOKITTY and FIVEHANDS appends this additional metadata to the encrypted file,\nwhile DEATHRANSOM does not.\nLastly it appends the four magic bytes DA DC CC AB to the end of the encrypted file.\nDepending on the version, HELLOKITTY may or may not change the file extension.\nOther samples of HELLOKITTY have used an embedded NTRU public key instead of\nRSA.\n\n\n-----\n\n**FIVEHANDS Encryption**\n\nFIVEHANDS uses an embedded NTRU public key. This NTRU key is SHA512 hashed\nand the first 32 bytes are used as the victim ID within the ransom note. This NTRU\npubic key is also used to encrypt each file's symmetric key.\nFor the symmetric key, FIVEHANDS uses an embedded generation routine to produce\n16 random bytes used for an AES key to encrypt each file.\nAfter each file is encrypted, the original file size, magic value of DE C0 AD BA, and\nAES key are encrypted with the public NTRU key and appended to the file.\nThe four magic bytes DB DC CC AB are appended to the end of the encrypted file.\nFIVEHANDS includes additional code not found in DEATHRANSOM and HELLOKITTY\nto use the Windows Restart Manager to close a file currently in use so that it can be\nunlocked and successfully encrypted.\nThe encrypted file extension is changed to .crypt extension\nFIVEHANDS's encryption flow and sequence is very different from the other two,\npartially because it incorporates asynchronous I/O requests and uses different\nembedded encryption libraries.\n\n**FIVEHANDS Encrypted Dropper**\n\nOne significant change between DEATHRANSOM and FIVEHANDS is the use of a memoryonly dropper, which upon execution, expects a command line switch of -key followed by the\nkey value necessary to perform decryption of its payload. The payload is stored and\nencrypted with AES-128 using an IV of “85471kayecaxaubv”. The decrypted FIVEHANDS\npayload is immediately executed after decryption. To date, Mandiant has only observed\nencrypted droppers with a common imphash of 8517cf209c905e801241690648f36a97.\n\n**CLI arguments**\n\nFIVEHANDS can receive a CLI argument for a path, this limits the ransomware's file\nencryption activities to the specified directory. DEATHRANSOM and HELLOKITTY do not\naccept CLI arguments.\n\n**Locale and Mutex checks**\n\nDEATHRANSOM performs language ID and keyboard layout checks. If either of these match\nRussian, Kazakh, Belarusian, Ukrainian or Tatar it exits. Neither HELLOKITTY or\nFIVEHANDS perform language ID or keyboard checks.\n\nHELLOKITTY performs a mutex check while the other two do not perform mutex checks.\n\n**File Exclusions**\n\nDEATHRANSOM and HELLOKITTY both exclude the same directories and files:\n\n\n-----\n\nprogramdata, $recycle.bin, program files, windows, all users, appdata, read_me.txt,\nautoexec.bat, desktop.ini, autorun.inf, ntuser.dat, iconcache.db, bootsect.bak, boot.ini,\nntuser.dat.log, or thumbs.db.\n\nThe exclusions for FIVEHANDS are more extensive and contain additional files and\ndirectories to ignore.\n\n**Additional Differences**\n\nDEATHRANSOM makes an external HTTPS connection to download a file. Neither\nHELLOKITTY or FIVEHANDS initiate network connections.\nHELLOKITTY contains code to set the victims wallpaper to a ransom related image.\nThe other samples do not have this functionality\nDifferent versions of DEATHRANSOM and HELLOKITTY are known to change the file\nextension\nDifferent versions of HELLOKITTY are known to check for specific processes to\nterminate.\n\n**Feature** **FIVEHANDS** **HELLOKITTY** **DEATHRANSOM**\n\nProgramming Language C++ C++ C\n\nSymmetric Encryption AES 128 AES 256 AES 256\n\n\nAsymmetric Encryption Embedded\nNTRU Key\n\n\nEmbedded RSA\nor NTRU Key\n\n\nCurve25519 ECDH and\nRSA key creation\n\n\nSame directory and file\nname exclusions\n\n\nNo Yes Yes\n\n\nAccepts CLI Arguments Yes No No\n\nNetwork Connections No No Yes\n\nLocale Check No No Yes\n\nMutex Check No Yes No\n\n\nBytes Appended to\nEncrypted Files\n\n\nDB DC CC\nAB\n\n\nDA DC CC AB AB CD EF AB\n\n\n-----\n\nTable 1: Ransomware feature comparison\n\n**Conclusion**\n\nMandiant observed SOMBRAT and FIVEHANDS ransomware by the same group since\nJanuary 2021. While similarities between HELLOKITTY and FIVEHANDS are notable,\nransomware may be used by different groups through underground affiliate programs.\nMandiant will assign an uncategorized cluster based on multiple factors including\ninfrastructure used during intrusions and as such, not all SOMBRAT or FIVEHANDS\nransomware intrusions may have been conducted by UNC2447. WARPRISM and\nFOXGRABBER have been used in SUNCRYPT and DARKSIDE ransomware demonstrating\nadditional complexity and sharing between different ransomware affiliate programs.\n\n**Indicators**\n\nSOMBRAT UNC2447\n\n87c78d62fd35bb25e34abb8f4caace4a\n6382d48fae675084d30ccb69b4664cbb (31dcd09eb9fa2050aadc0e6ca05957bf\nunxored)\n\nSOMBRAT Launcher\n\ncf1b9284d239928cce1839ea8919a7af (wwansvc.a XOR key)\n4aa3eab3f657498f52757dc46b8d1f11 (wwansvc.c)\n1f6495ea7606a15daa79be93070159a8 (wwansvc.bat)\n31dcd09eb9fa2050aadc0e6ca05957bf (wwansvc.b)\nedf567bd19d09b0bab4a8d068af15572 (wwansvc.b)\na5b26931a1519e9ceda04b4c997bb01f (wwansvc.txt)\nf0751bef4804fadfe2b993bf25791c49 (4aa3eab3f657498f52757dc46b8d1f11 unxored)\n87c78d62fd35bb25e34abb8f4caace4a (edf567bd19d09b0bab4a8d068af15572\nunxored)\n\nSOMBRAT domains\n\nCelomito[.]com (unc2447)\nFeticost[.]com (unc2447)\nCosarm[.]com\nPortalcos[.]com\n\nFIVEHANDS\n\n39ea2394a6e6c39c5d7722dc996daf05\nf568229e696c0e82abb35ec73d162d5e\n\nFIVEHANDS Encrypted Dropper\n\n6c849920155f48d4b4aafce0fc49eb5b\n22d35005e926fe29379cb07b810a6075\n\n\n-----\n\n57824214710bc0cdb22463571a72afd0\n87c0b190e3b4ab9214e10a2d1c182153\n1b0b9e4cddcbcb02affe9c8124855e58\n46ecc24ef6d20f3eaf71ff37610d57d1\n1a79b6d169aac719c9323bc3ee4a8361\na64d79eba40229ae9aaebbd73938b985\n\nHELLOKITTY\n\n136bd70f7aa98f52861879d7dca03cf2\n06ce6cd8bde756265f95fcf4eecadbe9\naf568e8a6060812f040f0cb0fd6f5a7b\nd96adf82f061b1a6c80699364a1e3208\n\nDEATHRANSOM\n\nc50ab1df254c185506ab892dc5c8e24b\n\nWARPRISM\n\nc925822c6d5175c30ba96388b07e9e16 (unc2447)\nc171bcd34151cbcd48edbce13796e0ed\nd87fcd8d2bf450b0056a151e9a116f72\nf739977004981fbe4a54bc68be18ea79\ne18b27f75c95b4d50bfcbcd00a5bd6c5\ndf6e6b3e53cc713276a03cce8361ae0f\n1cd03c0d00f7bfa7ca73f7d73677d8f8\n8071f66d64395911a7aa0d2057b9b00d\nc12a96e9c50db5f8b0b3b5f9f3f134f0\ne39184eacba2b05aaa529547abf41d2b\n09a05a2212bd2c0fe0e2881401fbff17\n8226d7615532f32eca8c04ac0d41a9fd\na01a2ba3ae9f50a5aa8a5e3492891082\n29e53b32d5b4aae6d9a3b3c81648653c\na809068b052bc209d0ab13f6c5c8b4e7\n\nBEACON UNC2447\n\n64.227.24[.]12 Havex Profile January 2021\n157.230.184[.]142 chches_ APT10 Profile November 2020-January 2021\n74c688a22822b2ab8f18eafad2271cac\n7d6e57cbc112ebd3d3c95d3c73451a38\n\nFOXGRABBER\n\n4d3d3919dda002511e03310c49b7b47f\n\n**FireEye Detections**\n\n\n-----\n\nFireEye Network\nSecurity\n\nFireEye Email Security\n\nFireEye Detection On\nDemand\n\nFireEye Malware\nAnalysis\n\nFireEye Malware File\nProtect\n\n\nFIVEHANDS\n\nFE_Loader_Win32_Generic_162\nFE_Ransomware_Win32_FIVEHANDS_1\nMalware.Binary.exe\nRansomware.Win.Generic.MVX\n\nSOMBRAT\n\nFE_Backdoor_Win64_SOMBRAT_1\nBackdoor.Win.SOMBRAT\nMalware.Binary.exe\nBackdoor.Win.SOMBRAT.MVX\nFEC_Trojan_PS1_Generic_7\nFEC_Trojan_PS1_Generic_8\nFEC_Trojan_BAT_Generic_5\n\nHELLOKITTY\n\nRansomware.Win.Generic.MVX\nMalware.Binary.exe\nRansomware.Win.HELLOKITTY.MVX\nFE_Ransomware_Win_HELLOKITTY_1\nFE_Ransomware_Win32_HELLOKITTY_1\n\nDEATHRANSOM\n\nFE_Loader_Win32_Generic_92\nRansomware.Win.Generic.MVX\nMalware.Binary.exe\n\nBEACON\n\nFE_Loader_Win32_BLUESPINE_1\nBackdoor.BEACON\nMalware.Binary.exe\n\nWARPRISM\n\nFE_Loader_PS1_WARPRISM_1\nFEC_Loader_PS1_WARPRISM_1\nBackdoor.BEACON\nTrojan.Generic\nTrojan.Win.SYSTEMBC\nBackdoor.Meterpreter\nLoader.PS1.WARPRISM.MVX\nMalware.Binary.exe\nMalware.Binary.ps1\n\nFOXGRABBER\n\nFE_Tool_MSIL_FOXGRABBER_1\nFE_Trojan_MSIL_Generic_109\n\n\n-----\n\nFireEye EndPoint\nSecurity\n\n\nReal-Time (IOC)\n\nSOMBRAT (BACKDOOR)\nSUSPICIOUS POWERSHELL READ BASE64 DATA\n(METHODOLOGY)\nFIVEHANDS RANSOMWARE (FAMILY)\nDEATHRANSOM RANSOMWARE (FAMILY)\nHELLOKITTY RANSOMWARE (FAMILY)\nBEACON (FAMILY)\n\nMalware Protection (AV/MG)\n\nSOMBRAT\n\nGeneric.mg. 87c78d62fd35bb25\nGeneric.mg.6382d48fae675084\nTrojan.GenericKD.45750384\nTrojan.GenericKD.36367848\nGeneric.PwShell.RefA.CB5E962A\nFIVEHANDS\n\nGeneric.mg.39ea2394a6e6c39c\nGeneric.mg.f568229e696c0e82\nGeneric.mg.6c849920155f48d4\nGeneric.mg.22d35005e926fe29\nGeneric.mg.57824214710bc0cd\nGeneric.mg.87c0b190e3b4ab92\nGeneric.mg.1b0b9e4cddcbcb02\nGeneric.mg.46ecc24ef6d20f3e\nGeneric.mg.1a79b6d169aac719\nGeneric.mg.a64d79eba40229ae\nGen:Variant.Zusy.375932\nGen:Variant.Zusy.366866\nTrojan.GenericKD.46059492\nTrojan.GenericKD.46059131\nTrojan.GenericKD.45996121\nTrojan.GenericKD.45702783\nWARPRISM\n\nGeneric.mg.a01a2ba3ae9f50a5\nTrojan.PowerShell.Agent.IJ\nTrojan.Agent.EXDR\nTrojan.PowerShell.Ransom.E\nTrojan.Agent.EUKPTrojan.GenericKD.45856129\nHeur.BZC.PZQ.Boxter.829.B5AEB7A6\nHeur.BZC.PZQ.Boxter.829.B84D01A7\nHeur.BZC.PZQ.Boxter.829.AE76D25C\nTrojan.PowerShell.Ransom.F\nDropped:Heur.BZC.MNT.Boxter.826.0A2B3A87\nHeur.BZC.PZQ.Boxter.829.A15701BD\nDEATHRANSOM\n\nGeneric.mg.c50ab1df254c1855\nTrojan.Ransomware.GenericKD.35760206\n\n\n-----\n\nHELLOKITTY\n\nGeneric.mg.136bd70f7aa98f52\nGeneric.mg.06ce6cd8bde75626\nGeneric.mg.af568e8a6060812f\nGeneric.mg.d96adf82f061b1a6\nGeneric.Malware.PfVPk!12.299C21F3\nGen:Variant.Ransom.HelloKitty.1\nGeneric.Malware.PfVPk!12.606CCA24\nGeneric.Malware.PfVPk!12.1454636C\nBEACON\n\nGeneric.mg.74c688a22822b2ab\nGeneric.mg.7d6e57cbc112ebd3\nTrojan.Agent.DDSN\n\n**MITRE ATT&CK**\n\n**Tactic** **Description**\n\nInitial Access T1078 Valid Accounts\n\nExecution T1047 Windows Management Instrumentation\nT1053.005 Scheduled Task / Job: Scheduled Task\nT1059.001 Command and Scripting Interpreter: PowerShell\nT1106 Execution through API\n\nDefense Evasion T1045 Software Packing\nT1055 Process Injection\nT1140 Deobfuscate / Decode Files or Information\n\nDiscovery T1012 Query Registry\nT1046 Network Service Scanning\nT1057 Process Discovery\nT1082 System Information Discovery\nT1124 System Time Discovery\nT1135 Network Share Discovery\n\nCollection T1560.003 Archive Collected Data: Archive via Custom\nMethod\n\nImpact T1485 Data Destruction\nT1486 Data Encrypted for Impact\nT1490 Inhibit System Recovery\n\n\n-----\n\nCommand and\nControl\n\n\nT1071.001 Application Layer Protocol: Web Protocols\nT1090.002 Proxy: External Proxy\nT1572 Protocol Tunneling\nT1573.002 Encrypted Channel: Asymmetric Cryptography\n\n\nExfiltration T1041 Exfiltration over C2 Channel\n\n**Acknowledgements**\n\nThanks to Nick Richard for technical review, Genevieve Stark and Kimberly Goody for\nanalytical contributions, and Jon Erickson, Jonathan Lepore, and Stephen Eckels for\nanalysis incorporated into this blog post.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-04-29 - UNC2447 SOMBRAT and FIVEHANDS Ransomware- A Sophisticated Financial Threat.pdf"
    ],
    "report_names": [
        "2021-04-29 - UNC2447 SOMBRAT and FIVEHANDS Ransomware- A Sophisticated Financial Threat.pdf"
    ],
    "threat_actors": [
        {
            "id": "c72c09b8-81ba-4e6e-9094-cd84ee4bda79",
            "created_at": "2022-10-25T15:50:23.667393Z",
            "updated_at": "2025-03-27T02:00:55.517974Z",
            "deleted_at": null,
            "main_name": "CostaRicto",
            "aliases": [
                "CostaRicto"
            ],
            "source_name": "MITRE:CostaRicto",
            "tools": [
                "PowerSploit",
                "SombRAT",
                "PsExec",
                "PS1",
                "CostaBricks"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "b77f9b40-dca7-449d-819e-115cd2295b41",
            "created_at": "2022-10-25T16:07:23.502671Z",
            "updated_at": "2025-03-27T02:02:09.834738Z",
            "deleted_at": null,
            "main_name": "CostaRicto",
            "aliases": [],
            "source_name": "ETDA:CostaRicto",
            "tools": [
                "CostaBricks",
                "PowerSploit",
                "PsExec",
                "SombRAT",
                "nmap"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "610a7295-3139-4f34-8cec-b3da40add480",
            "created_at": "2023-01-06T13:46:38.608142Z",
            "updated_at": "2025-03-27T02:00:02.87217Z",
            "deleted_at": null,
            "main_name": "Cobalt",
            "aliases": [
                "Cobalt Gang",
                "GOLD KINGSWOOD",
                "COBALT SPIDER",
                "G0080",
                "Mule Libra",
                "Cobalt Group"
            ],
            "source_name": "MISPGALAXY:Cobalt",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "cf1c7efe-4464-4347-95d3-c86fb4d7db51",
            "created_at": "2022-10-25T16:07:24.35977Z",
            "updated_at": "2025-03-27T02:02:10.189727Z",
            "deleted_at": null,
            "main_name": "UNC2447",
            "aliases": [],
            "source_name": "ETDA:UNC2447",
            "tools": [
                "7-Zip",
                "AdFind",
                "Agentemis",
                "Cobalt Strike",
                "CobaltStrike",
                "DEATHRANSOM",
                "DeathRansom",
                "FIVEHANDS",
                "FOXGRABBER",
                "HELLOKITTY",
                "HelloKitty",
                "KittyCrypt",
                "Mimikatz",
                "PCHUNTER",
                "RCLONE",
                "ROUTERSCAN",
                "Ragnar Locker",
                "RagnarLocker",
                "Rclone",
                "S3BROWSER",
                "SombRAT",
                "Thieflock",
                "WARPRISM",
                "cobeacon",
                "deathransom",
                "wacatac"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "5cbf6c32-482d-4cd2-9d11-0d9311acdc28",
            "created_at": "2023-01-06T13:46:38.39927Z",
            "updated_at": "2025-03-27T02:00:02.823829Z",
            "deleted_at": null,
            "main_name": "ENERGETIC BEAR",
            "aliases": [
                "DYMALLOY",
                "TG-4192",
                "Crouching Yeti",
                "Group 24",
                "Havex",
                "IRON LIBERTY",
                "Blue Kraken",
                "ALLANITE",
                "Koala Team",
                "G0035",
                "ATK6",
                "ITG15",
                "Ghost Blizzard",
                "BERSERK BEAR"
            ],
            "source_name": "MISPGALAXY:ENERGETIC BEAR",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "115cf618-02a8-42b8-8d25-305292eafedb",
            "created_at": "2023-11-21T02:00:07.396534Z",
            "updated_at": "2025-03-27T02:00:03.251048Z",
            "deleted_at": null,
            "main_name": "CostaRicto",
            "aliases": [],
            "source_name": "MISPGALAXY:CostaRicto",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "065b7ea2-5920-4270-824e-94ea8a79d197",
            "created_at": "2023-12-08T02:00:05.747632Z",
            "updated_at": "2025-03-27T02:00:03.265128Z",
            "deleted_at": null,
            "main_name": "UNC2447",
            "aliases": [],
            "source_name": "MISPGALAXY:UNC2447",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "ec14074c-8517-40e1-b4d7-3897f1254487",
            "created_at": "2023-01-06T13:46:38.300905Z",
            "updated_at": "2025-03-27T02:00:02.799108Z",
            "deleted_at": null,
            "main_name": "APT10",
            "aliases": [
                "TA429",
                "STONE PANDA",
                "POTASSIUM",
                "Red Apollo",
                "HOGFISH",
                "Cloud Hopper",
                "BRONZE RIVERSIDE",
                "ATK41",
                "G0045",
                "Menupass Team",
                "happyyongzi",
                "CVNX",
                "Granite Taurus"
            ],
            "source_name": "MISPGALAXY:APT10",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "ba3fff0c-3ba0-4855-9eeb-1af9ee18136a",
            "created_at": "2022-10-25T15:50:23.298889Z",
            "updated_at": "2025-03-27T02:00:55.433541Z",
            "deleted_at": null,
            "main_name": "menuPass",
            "aliases": [
                "menuPass",
                "POTASSIUM",
                "Stone Panda",
                "APT10",
                "Red Apollo",
                "CVNX",
                "HOGFISH",
                "BRONZE RIVERSIDE"
            ],
            "source_name": "MITRE:menuPass",
            "tools": [
                "certutil",
                "FYAnti",
                "UPPERCUT",
                "SNUGRIDE",
                "P8RAT",
                "RedLeaves",
                "SodaMaster",
                "pwdump",
                "Mimikatz",
                "PlugX",
                "PowerSploit",
                "ChChes",
                "cmd",
                "QuasarRAT",
                "AdFind",
                "Cobalt Strike",
                "PoisonIvy",
                "EvilGrab",
                "esentutl",
                "Impacket",
                "Ecipekac",
                "PsExec",
                "HUI Loader"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "ba9fa308-a29a-4928-9c06-73aafec7624c",
            "created_at": "2024-05-01T02:03:07.981061Z",
            "updated_at": "2025-03-27T02:05:17.28602Z",
            "deleted_at": null,
            "main_name": "BRONZE RIVERSIDE",
            "aliases": [
                "CTG-5938 ",
                "CVNX ",
                "Hogfish ",
                "MenuPass ",
                "POTASSIUM ",
                "Red Apollo ",
                "Stone Panda ",
                "APT10 "
            ],
            "source_name": "Secureworks:BRONZE RIVERSIDE",
            "tools": [
                " ChChes",
                " Cobalt Strike",
                " PlugX",
                " PoisonIvy",
                " QuasarRAT",
                " QuasarRAT Loader",
                " RedLeaves",
                "ANEL"
            ],
            "source_id": "Secureworks",
            "reports": null
        }
    ],
    "ts_created_at": 1673535600,
    "ts_updated_at": 1743041591,
    "ts_creation_date": 1653753006,
    "ts_modification_date": 1653753006,
    "files": {
        "pdf": "https://archive.orkl.eu/8c5d6c7b36fe57414203a40929f19120e34500e1.pdf",
        "text": "https://archive.orkl.eu/8c5d6c7b36fe57414203a40929f19120e34500e1.txt",
        "img": "https://archive.orkl.eu/8c5d6c7b36fe57414203a40929f19120e34500e1.jpg"
    }
}