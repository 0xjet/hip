{
    "id": "80102bbe-ef6d-4cef-9be6-64fe92435d51",
    "created_at": "2023-01-12T15:04:56.516853Z",
    "updated_at": "2025-03-27T02:16:37.127789Z",
    "deleted_at": null,
    "sha1_hash": "3535cc8628be710c090b186dcadbbd4aba044895",
    "title": "2020-04-13 - New Mozi Malware Family Quietly Amasses IoT Bots",
    "authors": "",
    "file_creation_date": "2022-05-28T04:57:59Z",
    "file_modification_date": "2022-05-28T04:57:59Z",
    "file_size": 292728,
    "plain_text": "# New Mozi malware family quietly amasses IoT bots\n\n**blog.centurylink.com/new-mozi-malware-family-quietly-amasses-iot-bots/**\n\n[Black Lotus Labs Posted On April 13, 2020](https://blog.lumen.com/author/black-lotus-labs/)\n\n[0](https://blog.lumen.com/new-mozi-malware-family-quietly-amasses-iot-bots/#respond)\n\n## Summary\n\n\nApril 13, 2020\n\n\nThe explosion of Internet of Things (IoT) devices has long served as a breeding ground for malware distribution. The inability for users to patch\nmany IoT devices has only compounded this problem, as bad actors continue to evolve tactics to leverage botnets for DDoS attacks and other\nmalicious behavior. Black Lotus Labs tracks malware families that present new or distinct threats to the global community, and recently began\ntracking a new malware family called Mozi.\n\nMozi is evolved from the source code of several known malware families – Gafgyt, Mirai and IoT Reaper – that have been brought together to\nform a peer-to-peer (P2P) botnet capable of DDoS attacks, data exfiltration and command or payload execution. The malware targets IoT\ndevices, predominantly routers and DVRs that are either unpatched or have weak telnet passwords. After a notable traffic increase in\nDecember was mistakenly attributed to other malware families by researchers, Black Lotus Labs reviewed entries in our reputation system for\nthat timeframe, which revealed a different story. This traffic was not simply increased activity by a known family, but a new family altogether.\n\n## Black Lotus Labs Findings\n\nIn December 2019, Black Lotus Labs observed an increase of entries of compromised hosts in our reputation system labeled as IoT Reaper.\nSince this malware family has not changed in some time, the increase was unexpected, and led to further investigation of the increase. Upon\nreview of these entries we began to see a pattern develop, each host had an http server listening on a random port that served a file which\nincluded “Mozi” in the name. File names such as “Mozi.m” and “Mozi.a” were seen throughout all of the identified hosts.\n\nResearch revealed that these hosts were part of a growing P2P botnet and were making the Mozi files available for distribution to newly\ninfected hosts. While the increase in data began in December, our data shows that the use of the Mozi filename began earlier, in September.\nFurther analysis revealed that the malware had been identified under many of its contributing families, including Mirai, Gafgyt, and IoT Reaper.\nThe original spike consisted of 69 hosts, but a broader look revealed 4,216 hosts. Shortly after we began our research based on samples\nbeing detected as multiple families, Netlab360 shared their findings on this malware[1] confirming our understanding.\n\n\n-----\n\ne o bot et s co p sed o odes t at ut e a d st buted as tab e ( ) o co u cat o, s a to t e code used by o eape\nand Hajime. These nodes also host the Mozi.m and Mozi.a malware binary files, passed during the compromise of new hosts, on a randomly\nchosen port. The standard DHT protocol is commonly used to store node contact information for torrent and other P2P clients. Using DHT\nallows the malware to bypass the use of standard malware command and control servers while hiding behind the large amount of typical DHT\ntraffic. This makes it harder to track and impact the control infrastructure. As a P2P botnet, Mozi implements its own custom extended DHT\ndescribed later.\n\nTo enumerate the botnet, Black Lotus Labs implemented a machine learning model trained on the observed unique DHT traffic implementation\nutilized by Mozi. This allows us to distinguish between Mozi nodes and benign hosts, and identify the IPs suspected of participating in the\nbotnet. When we identify a new suspected Mozi node, our software attempts to confirm the suspicion by sending messages proprietary to the\nmalware’s p2p protocol, and looks for correctly formatted responses. When the correct response is seen, the host is validated as a member of\nthe Mozi botnet.\n\n## The Mozi botnet is growing as the malware evolves\n\nTo get a view on the potential size of this new botnet we continue to review the data within our reputation system, and the IPs of the hosts\nconfirmed as Mozi botnet nodes.\n\nLooking at unique Mozi nodes hosting the malware during the initial spike witnessed, there were 323 unique nodes, by Dec. 27 unique nodes\nhad grown to 1,205, then hitting a high point on Feb. 4 with 2,191 nodes. Our review showed a steady increase in the number of compromised\nhosts over a span of three months – then a decline beginning in late February. Overall, we have observed over 15,858 unique Mozi nodes over\nthe last four months.\n\nThe geographic distribution of Mozi botnet nodes since September, 2019:\n\n\n-----\n\noug out t e e o t e o bot et, t e bu o t e odes a e bee ocated s a, t C a ost g % o ected osts Outs de o\nAsia, the largest footprint has been the US, with 10% of all nodes. A review of the data for just the month of March shows China increasing to\n81% of the botnet nodes and the United Stated dropping to less than 1%.\n\nOur first observations of the malware in December found only three distinct samples. As time as has passed, we’ve now seen 34 unique\nsamples, suggesting the operators are continuing to manipulate the malware.\n\n## A deeper look into the Mozi malware\n\nThe Mozi samples analyzed are ELF binaries with versions targeted for MIPS and ARM processor architectures. Once executed, the binary\nforks many versions of itself renamed as ‘ssh’ or ‘dropbear’. The forked processes are responsible for setting up the DHT communications and\nclosing ports to prevent infection by other malware. The forked processes can also set up HTTP on a randomly chosen port to host the Mozi\nbinary.\n\nMozi uses a modified DHT protocol for communication. The bot initially DHT pings several nodes hardcoded in the binary to bootstrap the\ninitial connection to the DHT network (listed below). For the nodes that respond, the bot then sends a DHT ‘find_node’ command to locate\nother bots on the Mozi botnet. It often takes several find_node attempts to locate an active Mozi peer.\n\nExample find_node request:\n\nd1:ad2:id20:88888888h\\xe3\\x90\\xe6\\xcbT\\x1f\\x89\\x0a[\\xda\\x896:target20:88888888:ad2:id2bo\\xa5\\x88e1:q9:find_node1:t4:fn\\x00\\x00\\1:v4oB\\xe5\n\nIf this request is sent to an active Mozi peer, the peer will often return the config of the contacted peer as the value to the ‘nodes’ key,\nalternatively it will return other nodes in the ‘nodes’ key. The config is XOR encrypted with a hardcoded key.\n\nThe encoded ‘find_node’ request looks like:\n\nThe bytes removed are repeating bytes of the XOR key and will be 0x00 bytes after decryption\n\nYellow – Bot ID\n\nBlue – Target ID\n\nPurple – Version flag\n\nOrange – Responding nodes ID\n\nGreen – Encrypted config\n\nBytes without color coding – Bencode encoded bytes not specific to Mozi\n\n\n-----\n\ne tua y o pee s etu t e O e coded co g O ce dec ypted t e co g co ta s (as desc bed by et ab360) a bot o e a d a\nDHT prefix. The bot roles that we have seen in our data are ‘bot’, ‘sk’, ‘ftp’, and ‘sns’. The DHT prefix seems to always be ‘88888888’, except in\nthe case of the ‘sns’ bot role in which it is just ‘888’.\n\nDecoded config samples:\n\n[ss]sns[/ss][cpu].m[/cpu][hp]888[/hp]\n\n[ss]ftp[/ss][cpu].w[/cpu][hp]88888888[/hp]\n\n[ss]sk[/ss][hp]88888888[/hp][count]http://ia.51[.]la/go1?id=20198527&pu=http%3a%2f%2fbaidu[.]com/[idp][/count]\n\n[ss]bot[/ss][hp]88888888[/hp][count]http://ia.51[.]la/go1?id=19894027&pu=http%3a%2f%2fbaidu[.]com/[idp][/count]\n\n## Mitigation Recommendations\n\nMozi is a fitting example of a new botnet ramping up virtually unnoticed or misattributed. What was initially viewed as small spike of a single\nfamily was actually a single, much larger, growing botnet. As evidenced by the rapid increase in size of this botnet, there are still large numbers\nof vulnerable IoT devices on the Internet. Black Lotus Labs continues to monitor the Mozi botnet and will continue to work to enumerate the\nP2P nodes. Black Lotus Labs has reached out to the most active nodes’ upstream providers in an attempt to disrupt and slow the botnet’s\ngrowth.\n\nAll the vulnerabilities targeted by the botnet are well known and are prevented by either proper patching or proper password management.\nCompanies and individuals can follow these security best practices to help prevent these types of compromises in the future:\n\nImplement effective passwords on all IoT devices when possible.\nRestrict IoT devices access to the wide-open internet.\nImplement proper patching methodologies.\nReview this list of affected devices and their vulnerabilities.\n\nNetlab360 shared a table of affected devices and their vulnerabilities:\n\n**Affected Device** **Vulnerability**\n\nEir D1000 Router [Eir D1000 Wireless Router RCI](https://www.exploit-db.com/exploits/40740)\n\nVacron NVR devices [Vacron NVR RCE](https://www.exploit-db.com/exploits/6864/)\n\nDevices using the Realtek SDK [CVE-2014-8361](https://www.exploit-db.com/exploits/37169/)\n\nNetgear R7000 and R6400 [Netgear cig-bin Command Injection](https://www.exploit-db.com/exploits/41598/)\n\nDGN1000 Netgear routers [Netgear setup.cgi unauthenticated RCE](https://www.exploit-db.com/exploits/43055)\n\nMVPower DVR [JAWS Webserver unauthenticated shell command execution](https://www.exploit-db.com/exploits/41471/)\n\nHuawei Router HG532 [CVE-2017-17215](https://www.exploit-db.com/exploits/43414/)\n\nD-Link Devices [HNAP SoapAction-Header Command Execution](https://www.exploit-db.com/exploits/37171/)\n\nGPON Routers [CVE-2018-10561, CVE-2018-10562](https://www.exploit-db.com/exploits/44576/)\n\nD-Link Devices [UPnP SOAP TelnetD Command Execution](https://www.exploit-db.com/exploits/28333/)\n\nCCTV DVR [CCTV/DVR Remote Code Execution](https://www.exploit-db.com/exploits/39596/)\n\n## IoCs\n\nMalware Hashes\n\n006965027c1f636295b5011a46905121\n\n1bd4f62fdad18b0c140dce9ad750f6de\n\n2560a86361257837b78d7ba289a031fb\n\n2d2ffa0422db66640561c46b8e428267\n\n2f8d6c0c6a449f3c074cfc0d6c8dbfc6\n\n300f850c0186077550830fa35edddc4e\n\n39434e0d800b62a72e8dfa202e2da9cd\n\n\n-----\n\n3a 03ab0da d 3ccc9ed d6 de\n\n4dde761681684d7edad4e5e1ffdb940b\n\n5b9b2a796c88da82d75553c48488b63f\n\n635d926cace851bef7df910d8cb5f647\n\n649e482199c9eb826fa0fca7016c325d\n\n68bf06fb2a8cef72a61b01dcd10fd10d\n\n6aa92a03083a19783ddf4e4913c230d3\n\n781228e0a889c0624a5f1d8e9f5b0b30\n\n849b165f28ae8b1cebe0c7430f44aff3\n\n868180d3f78ae330c8ab4e6c20045930\n\n8bfbda4203cfb4bb7aaeafe7afe9748a\n\n8d207e2b6d13ebd5fc4430ef3670558f\n\n8e81f08432ba7d64c67032a2a5580a48\n\n92defd440acfd41595ce20c9107c3262\n\n93be88ab0908a9359d7e5472ace22fe5\n\n9a111588a7db15b796421bd13a949cd4\n\n9c6539c9f5b3e831d5bcb1357d51d049\n\nb08d4099b14e37ceda1923681a2f70f2\n\nc16feda9ad177c8f7e6a07f57d84851f\n\nc46327a65a1f9bf9c367fbda95f1bd22\n\nc89a06d5b3a55a45b7d508e6b9152aa8\n\nd107c5dc752cd262cd4d6c461c8583c4\n\nd2b8a429bcf9e0eca54939e2cd4408dc\n\nd71d01d469414e992ded9038ea761564\n\nd96bbc2b1e5cc6b085bf04a8e487632e\n\ndd4b6f3216709e193ed9f06c37bcc389\n\neda730498b3d0a97066807a2d98909f3\n\nTop talking botnet nodes from most recent data\n\n67.58.78.157\n\n78.187.40.53\n\n177.128.34.146\n\n122.165.131.7\n\n80.92.189.5\n\n78.187.20.244\n\n85.105.104.74\n\n94.156.57.84\n\n112.196.16.26\n\n\n-----\n\n85 0 8\n\n82.209.9.181\n\n187.85.255.194\n\n103.123.46.51\n\n213.174.31.77\n\n103.97.244.22\n\n103.41.56.62\n\n187.85.248.209\n\n103.59.134.156\n\n88.247.16.223\n\n89.160.95.67\n\n## External References\n\nThis information is provided “as is” without any warranty or condition of any kind, either express or implied. Use of this information is at the end\nuser’s own risk.\n\nServices not available everywhere. ©2022 Lumen Technologies. All Rights Reserved.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2020/2020-04-13 - New Mozi Malware Family Quietly Amasses IoT Bots.pdf"
    ],
    "report_names": [
        "2020-04-13 - New Mozi Malware Family Quietly Amasses IoT Bots.pdf"
    ],
    "threat_actors": [
        {
            "id": "f0bccc3d-ad77-49c4-8dfd-8a8a8d6fba26",
            "created_at": "2024-05-01T02:03:08.134022Z",
            "updated_at": "2025-03-27T02:05:17.415028Z",
            "deleted_at": null,
            "main_name": "NICKEL FOXCROFT",
            "aliases": [
                "Group 123 ",
                "Moldy Pisces ",
                "RICOCHET CHOLLIMA ",
                "Reaper ",
                "ScarCruft ",
                "APT37 "
            ],
            "source_name": "Secureworks:NICKEL FOXCROFT",
            "tools": [
                "ROKRAT"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "9b02c527-5077-489e-9a80-5d88947fddab",
            "created_at": "2022-10-25T16:07:24.103499Z",
            "updated_at": "2025-03-27T02:02:10.108504Z",
            "deleted_at": null,
            "main_name": "Reaper",
            "aliases": [
                "APT 37",
                "ATK 4",
                "Cerium",
                "Crooked Pisces",
                "Geumseong121",
                "Group 123",
                "ITG10",
                "InkySquid",
                "Moldy Pisces",
                "Opal Sleet",
                "Operation Are You Happy?",
                "Operation Battle Cruiser",
                "Operation Black Banner",
                "Operation Daybreak",
                "Operation Dragon messenger",
                "Operation Erebus",
                "Operation Evil New Year",
                "Operation Evil New Year 2018",
                "Operation Fractured Block",
                "Operation Fractured Statue",
                "Operation FreeMilk",
                "Operation Golden Bird",
                "Operation Golden Time",
                "Operation High Expert",
                "Operation Holiday Wiper",
                "Operation Korean Sword",
                "Operation North Korean Human Right",
                "Operation Onezero",
                "Operation Rocket Man",
                "Operation SHROUDED#SLEEP",
                "Operation STARK#MULE",
                "Operation STIFF#BIZON",
                "Operation Spy Cloud",
                "Operation Star Cruiser",
                "Osmium",
                "Red Eyes",
                "Ricochet Chollima",
                "Ruby Sleet",
                "ScarCruft",
                "TA-RedAnt",
                "TEMP.Reaper",
                "Venus 121"
            ],
            "source_name": "ETDA:Reaper",
            "tools": [
                "Agentemis",
                "BLUELIGHT",
                "Backdoor.APT.POORAIM",
                "CARROTBALL",
                "CARROTBAT",
                "CORALDECK",
                "Cobalt Strike",
                "CobaltStrike",
                "DOGCALL",
                "Erebus",
                "Exploit.APT.RICECURRY",
                "Final1stSpy",
                "Freenki Loader",
                "GELCAPSULE",
                "GOLDBACKDOOR",
                "GreezeBackdoor",
                "HAPPYWORK",
                "JinhoSpy",
                "KARAE",
                "KevDroid",
                "Konni",
                "MILKDROP",
                "N1stAgent",
                "NavRAT",
                "Nokki",
                "Oceansalt",
                "POORAIM",
                "PoohMilk",
                "PoohMilk Loader",
                "RICECURRY",
                "RUHAPPY",
                "RokRAT",
                "SHUTTERSPEED",
                "SLOWDRIFT",
                "SOUNDWAVE",
                "SYSCON",
                "Sanny",
                "ScarCruft",
                "StarCruft",
                "Syscon",
                "VeilShell",
                "WINERACK",
                "ZUMKONG",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535896,
    "ts_updated_at": 1743041797,
    "ts_creation_date": 1653713879,
    "ts_modification_date": 1653713879,
    "files": {
        "pdf": "https://archive.orkl.eu/3535cc8628be710c090b186dcadbbd4aba044895.pdf",
        "text": "https://archive.orkl.eu/3535cc8628be710c090b186dcadbbd4aba044895.txt",
        "img": "https://archive.orkl.eu/3535cc8628be710c090b186dcadbbd4aba044895.jpg"
    }
}