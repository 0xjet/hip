{
    "id": "a0a71cce-8b93-487f-94bb-6d8aab479f70",
    "created_at": "2023-01-12T14:59:14.57037Z",
    "updated_at": "2025-03-27T02:05:52.595988Z",
    "deleted_at": null,
    "sha1_hash": "14616ccc3bbf3ce5f0d583f804467e2bdf70a5c5",
    "title": "2020-03-23 - Snake Ransomware Analysis Updates",
    "authors": "",
    "file_creation_date": "2022-05-28T17:06:57Z",
    "file_modification_date": "2022-05-28T17:06:57Z",
    "file_size": 96501,
    "plain_text": "# Snake Ransomware Analysis Updates\n\n**insights.sei.cmu.edu/cert/2020/03/snake-ransomware-analysis-updates.html**\n\n[Kyle O'Meara](https://insights.sei.cmu.edu/authors/kyle-omeara/)\n\nMarch 23, 2020\n\nIn January 2020, Sentinel Labs published two reports on Snake (also known as Ekans) ransomware.[1][2] The Snake ransomware gained\nattention due to its ability to terminate specific industrial control system (ICS) processes. After reading the reports, I wanted to expand the\ncorpus of knowledge and provide OT and IT network defenders with increased defense capabilities against Snake. The key takeaways from\nthe Sentinel Labs' reports for additional analysis were the hash of the ransomware and the string decoder script from sysopfb.[3] Two\nquestions I pursued were:\n\nCan I find more samples of the Snake ransomware?\nIf yes, do these samples use the same string decoding process?\n\n## Discovering More Samples\n\nBy analyzing the code and applying a combination of using IDA, Pharos tools fn2hash and fn2yara, BigGrep, and the CERT/CC Malware\nAnalysis and Storage System (MASS) repository, I was able to find one sample with a 100% function overlap with that of the known Snake\nransomware sample.[4] The hashes of these samples are shown in Table 1 in the Appendix. In reviewing my BigGrep search parameter, I\nrealized I had potentially limited my search results. I expanded my search parameter and found two more candidate samples which are shown\nin Table 2 in the Appendix.\n\n## Decoding the Strings\n\nThe string decoder, further referred to as the config dumper, decoded the same strings from the new Snake ransomware sample that were also\nfound in the original Snake ransomware sample.[1] See the sysopfb link in the references section for complete decoded string list.[3]\nUnfortunately, the config dumper did not return any results for the two new candidate samples.\n\nAgain, using IDA and Pharos tools fn2hash and fn2yara, I wanted to see how much code overlap there was with these four files from Table 1\nand Table 2 in the Appendix. The two new candidate samples shared a 100% function overlap. When comparing these two files to the Snake\nransomware samples, there was only a 50% function overlap. With a significant function overlap between all of the four files, why didn't the\nconfig dumper work on the two new candidate samples?\n\nLooking at the code further, I identified a 1-byte difference in the string decoding function in the new candidate samples versus the known\nSnake ransomware samples. I edited the config dumper and ran it on the new candidate samples. The modified config dumper was successful\nin decoding strings from the new candidate samples as shown in Table 3 in the Appendix.\n\nThe newly returned strings from the new candidate samples were different than those that were found in the known Snake ransomware\nsamples. However, using the new config dumper, I successfully decoded new strings from the known Snake ransomware samples. These\nstrings all appear to be host intrusion prevention system (HIPS) process and service names, as shown in Table 4 in the Appendix.\n\n## Summary of Findings\n\nThrough my additional analysis process, I discovered another Snake ransomware sample as well as new candidate samples. However,\ndynamic analysis demonstrated that these new candidate samples did not act like ransomware. Upon execution, the new candidates tried to\nestablish a connection to IP address 18.222.249[.]59 on port 7777. Without allowing the candidate sample to establish a connection, I saw no\nfurther action from the candidate samples. The assumption is that the Snake ransomware and the new candidate samples are potentially\ncreated by a similar actor, given the large code overlap as well as the nearly identical string decoding routine.\n\nI created a YARA rule to identify samples that contain a similar string decoding function, as shown in Table 5 in the Appendix.\n\nI also developed an updated config dumper which decodes the new set of strings. This config dumper is available upon request.\n\nIn another report, Dragos highlights that the Snake ransomware terminate process list is similar to the list found in the MegaCoretx\nransomware.[5] My analysis uncovered an additional 252 decoded strings related to HIPS processes that the Snake ransomware attempts to\nterminate. These 252 processes are found in the 1104 processes list in the Accenture Security MegaCortex ransomware report.[6] However,\n\n\n-----\n\na te co p et g s a a a yses, as e t o ed abo e, as e as test g o u es, ou d t at t e S a e a d egaCo te\nransomwares shared no code overlap. I believe it is a matter of coincidence that there is an overlap in this process list. The possible reasons\nfor this coincidence could include that the Snake ransomware took information from the Accenture report on MegaCortex or used the published\ncurated open source HIPS process list.[7]\n\n## Conclusion\n\nI have provided more samples, a YARA rule, new config dumper, and new decoded data (see the tables in the Appendix). This information, in\naddition to previous industry analyses, will allow for network defenders in the OT and IT space to increase their defense capabilities against\nthe Snake ransomware.\n\n## Appendix\n\n**Table 1: Snake Ransomware Hashes**\n\ne5262db186c97bbe533f0a674b08ecdafa3798ea7bc17c705df526419c168b60\n\na5a7e6ddf99634a253a060adb1f0871a5a861624382e8ca6d086e54f03bed493\n\n**Table 2: New Candidate Hashes**\n\nb17863d41c0b915052fea85a354ec985280f4d38b46d64158a75b17ef89d76da\n\na8f0ff40d1e624dd2aad4d689ed47a900e4f719923647cacb58d1a4809c7bd31\n\n**Table 3: Decoded Strings from New Candidate Samples**\n\nu\n\nu\n\nhttps://18.222.249.59/uploaad\n\n./123\n\nok\n\n18.222.249.59:7777\n\ntcp\nPOST\n\nhttps://18.222.249.59:443/uploaad\n\n./123\n\nOK\n\ntitle\n\nendgame\n\nContent-Type\n\nmultipart/form-data\n\nfile\n\nendgame\n\nY23QyJCj%kAK\n\nPOST\n\nContent-Type\n\n**Table 4: New Decoded Strings from Snake Ransomware Samples**\n\n\nacctmgr.exe\n\nalertsvc.exe\n\nalmon.exe\n\nalsvc.exe\n\nalunotify.exe\n\nalupdate.exe\n\naluschedulersvc.exe\n\naphost.exe\n\nappsvc32.exe\n\napvxdwin.exe\n\nasupport.exe\n\navltmain.exe\n\nccap.exe\n\nccapp.exe\n\nccenter.exe\n\nccevtmgr.exe\n\nccproxy.exe\n\nccpxysvc.exe\n\nccsetmgr.exe\n\n\nnprotect.exe\n\nnpscheck.exe\n\nnpssvc.exe\n\nnscsrvce.exe\n\nnsctop.exe\n\nnsmdemf.exe\n\nnsmdmon.exe\n\nnsmdreal.exe\n\nnsmdsch.exe\n\nnsmdtr.exe\n\nofcdog.exe\n\nofcpfwsvc.exe\n\nolfsnt40.exe\n\nomslogmanager.exe\n\nopscan.exe\n\nop_viewer.exe\n\npagent.exe\n\npagentwd.exe\n\npatch.exe\n\n\nsavservice.exe\n\nsavui.exe\n\nsbserv.exe\n\nscanfrm.exe\n\nscfmanager.exe\n\nscfservice.exe\n\nscftray.exe\n\nschdsrvc.exe\n\nschupd.exe\n\nsdtrayapp.exe\n\nseestat.exe\n\nsemsvc.exe\n\nsesclu.exe\n\nsevinst.exe\n\nsgbhp.exe\n\nslee81.exe\n\nsmsectrl.exe\n\nsmselog.exe\n\nsmsesjm.exe\n\n\n-----\n\ng\ncheckup.exe\ncka.exe\ncomhost.exe\ncpdclnt.exe\ncsinject.exe\ncsinsm32.exe\ncsinsmnt.exe\ndbserv.exe\ndefwatch\ndefwatch.exe\ndiskmon.exe\ndjsnetcn.exe\ndlservice.exe\ndltray.exe\ndoscan.exe\ndwhwizrd.exe\ndwwin.exe\nemlibupdateagentnt.exe\nentitymain.exe\nexecstat.exe\nscanexplicit.exe\nfirewallgui.exe\nfwcfg.exe\nfws.exe\nghost_2.exe\nghosttray.exe\nicepack.exe\nidsinst.exe\ninicio.exe\nisntsmtp.exe\nisntsysmonitor\nispwdsvc.exe\nissvc.exe\nisuac.exe\nknownsvr.exe\nkpf4gui.exe\nkpf4ss.exe\nlmon.exe\nluall.exe\nlucallbackproxy.exe\nlucoms~1.exe\nlucomserver.exe\nlucoms.exe\nlwdmserver.exe\nmanagementagentnt.exe\nmcui32.exe\nmgntsvc.exe\nmrf.exe\nnavapsvc.exe\nnavapw32.exe\nnavectrl.exe\nnavelog.exe\nnavesp.exe\nnavshcom.exe\nnavw32.exe\nnavwnt.exe\nndetect.exe\nngctw32.exe\nngserver.exe\nnisoptui.exe\nnisserv.exe\nnisum.exe\nnmain.exe\nnpfmntor.exe\n\n\np p\npavjobs.exe\npavsrv52.exe\npccnt.exe\npccntupd.exe\npcctlcom.exe\npcscnsrv.exe\npctsauxs.exe\npctsgui.exe\npctssvc.exe\npctstray.exe\npmon.exe\npoproxy.exe\npqibrowser.exe\npqv2isvc.exe\nprevsrv.exe\nprocexp.exe\npsctris.exe\npsctrls.exe\npshost.exe\npsimreal.exe\npskmssvc.exe\npviewer.exe\npview.exe\npxeservice.exe\nqdcsfs.exe\nqoeloader.exe\nqserver.exe\nras.exe\nrasupd.exe\nravalert.exe\nrav.exe\nravmond.exe\nravmon.exe\nravservice.exe\nravstub.exe\nravtask.exe\nravtray.exe\nravupdate.exe\nravxp.exe\nregmech.exe\nreportersvc.exe\nreportsvc.exe\nrfwmain.exe\nrfwproxy.exe\nrfwsrv.exe\nrfwstub.exe\nrnav.exe\nrnreport.exe\nrouternt.exe\nrsnetsvr.exe\nrstray.exe\nsav32cli.exe\nsavadminservice.exe\nsavfmsectrl.exe\nsavfmselog.exe\nsavfmsesjm.exe\nsavfmsespamstatsmanager.exe\nsavfmsesp.exe\nsavfmsesrv.exe\nsavfmsetask.exe\nsavfmseui.exe\nsavmain.exe\nsavroam.exe\nsavscan.exe\n\n\np\nsmsesrv.exe\nsmsetask.exe\nsmseui.exe\nsms.exe\nsmsx.exe\nsnac.exe\nsndmon.exe\nsndsrvc.exe\nsnhwsrv.exe\nsnicheckadm.exe\nsnichecksrv.exe\nsnicon.exe\nsnsrv.exe\nspbbcsvc.exe\nsrvload.exe\nsschk.exe\nssecuritymanager.exe\nssm.exe\nsvcharge.exe\nsvcntaux.exe\nsvdealer.exe\nsvframe.exe\nsvtray.exe\nswdsvc.exe\nsweepsrv.sys\nswnetsup.exe\nswnxt.exe\nswserver.exe\nsymlcsvc.exe\nsymproxysvc.exe\nsymsport.exe\nsymtray.exe\nsymwsc.exe\nsysdoc32.exe\ntdimon.exe\ntfgui.exe\ntfservice.exe\ntftray.exe\ntfun.exe\ntiaspn~1.exe\ntmas.exe\ntmntsrv.exe\ntmpfw.exe\ntmproxy.exe\ntpsrv.exe\ntraflnsp.exe\ntrjscan.exe\ntrupd.exe\nucservice.exe\nupdtnv28.exe\nupfile.exe\nurllstck.exe\nusrprmpt.exe\nv2iconsole.exe\nvpc32.exe\nvpdn_lu.exe\nvprosvc.exe\nvptray.exe\nwebproxy.exe\nwfxctl32.exe\nwfxmod32.exe\nwfxsnt40.exe\nwinlog.exe\nwrspysetup.exe\n\n\n**Table 5: Snake Ransomware YARA Rule**\n\n\n-----\n\n```\n{\n  meta:  \n  author = “CERT/CC RE Team”  \n  description = “Snake Ransomware String Decoder Function”  \n  date = “21 Feb 2020”\nstrings:  \n  $bytes = { 8D 05 ?? ?? ?? ?? 89 44 24 04 C7 44 24 08 05 00 00 00 E8 ?? ?? ?? ?? 8B 44 24 0C 89 44 24 64 8B 4C 24 10 89 4C 24 18\n8D 54 24 \n24 89 14 24 8D 15 ?? ?? ?? ?? 89 54 24 04 C7 44 24 08 05 00 00 00 E8 ?? ?? ?? ?? }\ncondition:  \n  $bytes\n}\n\n```\nrule Snake_Ransomware\n{\nmeta:\nauthor = “CERT/CC RE Team”\ndescription = “Snake Ransomware String Decoder Function”\ndate = “21 Feb 2020”\n\nstrings:\n$bytes = { 8D 05 ?? ?? ?? ?? 89 44 24 04 C7 44 24 08 05 00 00 00 E8 ?? ?? ?? ?? 8B 44 24 0C 89 44 24 64 8B 4C 24 10 89 4C 24 18 8D\n54 24 24 89 14 24 8D 15 ?? ?? ?? ?? 89 54 24 04 C7 44 24 08 05 00 00 00 E8 ?? ?? ?? ?? }\ncondition:\n$bytes\n}\n\n## References\n\n[1] https://twitter.com/VK_Intel/status/1214333066245812224\n\n[2] https://labs.sentinelone.com/new-snake-ransomware-adds-itself-to-the-increasing-collection-of-golang-crimeware/\n\n[3]\nhttps://github.com/sysopfb/open_mal_analysis_notes/blob/master/e5262db186c97bbe533f0a674b08ecdafa3798ea7bc17c705df526419c168b60.m\n\n[4] https://github.com/cmu-sei/pharos\n\n[5] https://dragos.com/blog/industry-news/ekans-ransomware-and-ics-operations/\n\n[6] https://www.accenture.com/_acnmedia/pdf-106/accenture-technical-analysis-megacortex.pdf\n\n[7] https://github.com/v1ado/HIPS_LIPS\n\nWRITTEN BY\n\nMORE BY THE AUTHOR\n\n**API Hashing Tool, Imagine That**\n\nMarch 25, 2019 • By [Kyle O'Meara,](https://insights.sei.cmu.edu/authors/kyle-omeara/) [CERT Insider Threat Center](https://insights.sei.cmu.edu/authors/cert-center/)\n\nMORE IN CERT/CC VULNERABILITIES\n\n**The Latest Work from the SEI: Coordinated Vulnerability Disclosure, Cybersecurity Research, Cyber Risk and Resilience, and the**\n**Importance of Fostering Diversity in Software Engineering**\n\nSeptember 6, 2021 • By [Douglas C. Schmidt](https://insights.sei.cmu.edu/authors/douglas-schmidt/)\n\n**Vulnerabilities: Everybody’s Got One!**\n\nJune 16, 2021 • By [Leigh Metcalf](https://insights.sei.cmu.edu/authors/leigh-metcalf/)\n\n**[CERT/CC Comments on Standards and Guidelines to Enhance Software Supply Chain Security](https://insights.sei.cmu.edu/blog/certcc-comments-on-standards-and-guidelines-to-enhance-software-supply-chain-security/)**\n\nJune 1, 2021 • By [Jonathan Spring](https://insights.sei.cmu.edu/authors/jonathan-spring/)\n\n\n-----\n\n**g**\n\nNovember 19, 2020 • By [Brandon Marzik](https://insights.sei.cmu.edu/authors/brandon-marzik/)\n\n**[Adversarial ML Threat Matrix: Adversarial Tactics, Techniques, and Common Knowledge of Machine Learning](https://insights.sei.cmu.edu/blog/adversarial-ml-threat-matrix-adversarial-tactics-techniques-and-common-knowledge-of-machine-learning/)**\n\nOctober 22, 2020 • By [Jonathan Spring](https://insights.sei.cmu.edu/authors/jonathan-spring/)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2020/2020-03-23 - Snake Ransomware Analysis Updates.pdf"
    ],
    "report_names": [
        "2020-03-23 - Snake Ransomware Analysis Updates.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673535554,
    "ts_updated_at": 1743041152,
    "ts_creation_date": 1653757617,
    "ts_modification_date": 1653757617,
    "files": {
        "pdf": "https://archive.orkl.eu/14616ccc3bbf3ce5f0d583f804467e2bdf70a5c5.pdf",
        "text": "https://archive.orkl.eu/14616ccc3bbf3ce5f0d583f804467e2bdf70a5c5.txt",
        "img": "https://archive.orkl.eu/14616ccc3bbf3ce5f0d583f804467e2bdf70a5c5.jpg"
    }
}