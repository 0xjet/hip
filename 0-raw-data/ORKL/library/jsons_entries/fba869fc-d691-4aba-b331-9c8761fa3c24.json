{
    "id": "fba869fc-d691-4aba-b331-9c8761fa3c24",
    "created_at": "2022-10-25T16:48:23.256597Z",
    "updated_at": "2025-03-27T02:17:22.880756Z",
    "deleted_at": null,
    "sha1_hash": "f6e2328ac8ffb2815f4ca0a5051f5e32796f46d0",
    "title": "LIFARS- Lazarus .docx",
    "authors": "",
    "file_creation_date": "2021-09-08T16:07:28Z",
    "file_modification_date": "2021-09-09T09:33:23Z",
    "file_size": 13685145,
    "plain_text": "# A Detailed Analysis of Lazarus’\n RAT Called FALLCHILL\n\n\\\n\n### Prepared by:   LIFARS, LLC Date:  09/07/2021\n\n#### 1\n\n\n-----\n\n## EXECUTIVE SUMMARY\n\n\nFALLCHILL is a RAT that has been used by Lazarus Group since 2016. The malware decrypts multiple\nstrings at runtime using the XOR algorithm and the RC4 hard-coded key “0D 06 09 2A 86 48 86 F7 0D 01\n01 01 05 00 03 82”. It implements a custom algorithm that is used to decode multiple DLL names and\nexport functions, which will be imported at runtime. The process collects the following data from the\nmachine and generates a victim ID: OS version information, MAC address, host name, host IP address. The\nfollowing IP addresses represent the C2 servers, which will instruct the malware on what command to\nperform: 175.100.189.174 and 125.212.132.222. The diagram presented below presents all the\nfunctionalities implemented by this RAT.\n\n\n## FALLCHILL DIAGRAM\n\n\n-----\n\n## ANALYSIS AND FINDINGS\n\n\nSHA256:a606716355035d4a1ea0b15f3bee30aad41a2c32df28c2d468eafd18361d60d6\n\nThe malware writes multiple RC4 and XOR encrypted strings to the memory. One such example is shown\nin figure 1:\n\n##### Figure 1\n\n\n-----\n\nThe hard-coded RC4 key “0D 06 09 2A 86 48 86 F7 0D 01 01 01 05 00 03 82” is used to decrypt multiple\nstrings at runtime:\n\n\n##### Figure 2\n\n\nThere is a custom implementation of the RC4 algorithm provided by the sample, as shown below:\n\n##### Figure 3\n\n\n-----\n\nAn example of a string decrypted using a XOR operation, and the RC4 algorithm is displayed in figure 4:\n\n\n##### Figure 4\n\n\nThe binary uses the SetErrorMode function in order to force the system not to display the critical-errorhandler message box and the Windows Error Reporting dialog (0x3 = SEM_FAILCRITICALERRORS |\n**SEM_NOGPFAULTERRORBOX):**\n\n\n##### Figure 5\n\n\nA new thread is created by the malware using the CreateThread API:\n\n##### Figure 6\n\n\n-----\n\n## THREAD ACTIVITY – START ADDRESS FUNCTION\n\n\nWe can use CyberChef (https://gchq.github.io/CyberChef/) to confirm that the algorithm used to decrypt\nstrings is indeed RC4:\n\n\n##### Figure 7\n\n\nThe LoadLibraryW routine is utilized to load multiple DLLs into the address space:\n\n\n##### Figure 8\n\n\nThe executable retrieves the address of multiple exported functions by calling the GetProcAddress function:\n\n##### Figure 9\n\n\n-----\n\nA simple encoding algorithm that consists of subtracting a hex number from 0xDB is implemented by the\nfile (the decryption algorithm is implemented in Python and presented in the appendix):\n\n##### Figure 10\n\nThe following DLLs are also loaded by the malicious process: wtsapi32.dll, Advapi32.dll, ws2_32.dll and\niphlpapi.dll. The process decrypts the following function names and gets the address of them via a\nGetProcAddress function call:\n\n- Module32FirstW, WinExec, FindFirstFileW, LocalAlloc, CreateThread, ReadFile, GetFileSize,\nGetExitCodeProcess, CloseHandle, GetTempFileNameW, Process32FirstW, DeleteFileW, LoadLibraryW,\nGetExitCodeThread, GetFileTime, TerminateThread, LocalFree, WaitForSingleObject,\nWaitForMultipleObjects, GetModuleFileNameW, WriteFile, Process32NextW, Sleep, MapViewOfFile,\nReadProcessMemory, SetFilePointer, CreateToolhelp32Snapshot, GetTempPathW, CreateProcessW,\nGetFileAttributesW, GetLocalTime, GetSystemDirectoryW, GetVolumeInformationW,\nGetCurrentProcess, UnmapViewOfFile, GetVersionExW, SetFileTime, GetLogicalDrives,\nGetCurrentDirectoryW, SetCurrentDirectoryW, OpenProcess, CreateFileW, TerminateProcess,\nFreeLibrary, VirtualProtectEx, WriteProcessMemory, GetComputerNameW, FindNextFileW,\nGetModuleHandleW, MoveFileExW, FindClose, CreateFileMappingW, VirtualQueryEx, GetDriveTypeW,\nGetDiskFreeSpaceExW, GetLastError, SetLastError, VirtualAllocEx, CreateRemoteThread,\nFindResourceW, LoadResource, LockResource, GetTickCount\n\n- WTSQueryUserToken, WTSEnumerateSessionsW\n\n- OpenProcessToken, RegOpenKeyW, ControlService, SetServiceStatus, CloseServiceHandle,\nAdjustTokenPrivileges, LookupPrivilegeValueW, GetTokenInformation, LookupAccountSidW,\nOpenServiceW, RegDeleteKeyW, DeleteService, RegDeleteValueW, ChangeServiceConfig2W,\nOpenSCManagerW, CreateServiceW, StartServiceW, RegSetValueExW, RegCloseKey,\nRegisterServiceCtrlHandlerW, RegCreateKeyW, RegOpenKeyExW, RegQueryValueExW,\nGetUserNameW, CreateProcessAsUserW\n\n\n-----\n\n- WSACleanup, recv, setsockopt, WSAStartup, listen, shutdown, gethostbyname, getpeername, accept,\nioctlsocket, connect, closesocket, socket, htons, select, send, __WSAFDIsSet, bind, inet_addr\n\n- GetAdaptersInfo\n\nThe malicious executable initiates the usage of Winsock DLL using the WSAStartup routine:\n\n\n##### Figure 11\n\n\nThe file tries to open a registry key that doesn’t exist on our machine.\n\nAccording to an article published by US-CERT at\n\nhttps://us-cert.cisa.gov/sites/default/files/publications/MAR-10135536-A_WHITE_S508C.pdf, the data\nstored in this key is RC4 encrypted, and XOR encoded (0x80000002 = **HKEY_LOCAL_MACHINE and**\n0x20019 = KEY_READ):\n\n\n##### Figure 12\n\n\nThe major/minor version and the build number of the operating system are extracted via a GetVersionExW\nAPI call, as highlighted below:\n\n##### Figure 13\n\n\n-----\n\nThe GetAdaptersInfo routine is used to retrieve adapter information for the local machine. The binary\nextracts the hardware address (MAC) from the result and stores it in a separate buffer:\n\n##### Figure 14\n\nThe NetBIOS name of the computer is extracted using GetComputerNameW:\n\n\n##### Figure 15\n\n\nThe private IP address of the host along with other information is extracted using the gethostbyname\nfunction:\n\n\n##### Figure 16\n\n\nThe following buffer contains the IP address extracted earlier, the host name, and different information\nabout the operating system extracted above:\n\n\n##### Figure 17\n\n\n-----\n\nThe executable generates a unique ID based on a GetTickCount function call and the MAC address. The\nalgorithm utilized to obtain the ID is custom and consists of a lot of operations (a snippet of it is displayed\nbelow):\n\n\n##### Figure 18\n\n\nThe corresponding ID of our machine is highlighted in figure 19:\n\n\n##### Figure 19\n\n\nTwo C2 servers and the port number have been decrypted by the process:\n\n\n##### Figure 20\n\n\n-----\n\nThe inet_addr routine is utilized to convert the IP addresses of the C2 servers into proper addresses for\nthe IN_ADDR structure:\n\n\n##### Figure 21\n\n\nThe sample extracts the valid drives on the system using the GetLogicalDriveStringsW API:\n\n\n##### Figure 22\n\n\nGetDriveTypeW is used to retrieve the type of the drives extracted above. The drives name and their type\nare saved to a buffer in the following form (\"C 3\" and “D 5”):\n\n\n##### Figure 23\n\n\nA new socket is created by the process (0x2 = **AF_INET, 0x1 =** **SOCK_STREAM** and 0x6 =\n**IPPROTO_TCP):**\n\n\n##### Figure 24\n\n\nThe malicious file enables the non-blocking mode for the socket using the ioctlsocket routine (0x8004667e\n= FIONBIO):\n\n\n-----\n\n##### Figure 25\n\n\nA new connection to 175.100.189.174 on port 443 is established by the process (if it’s unsuccessful, it tries\nto connect to 125.212.132.222). It’s important to mention that the network connections are simulated\nusing FakeNet (https://github.com/fireeye/flare-fakenet-ng):\n\n\n##### Figure 26\n\n\nThe select API is utilized to determine the status of the socket:\n\n\n##### Figure 27\n\n\nThe blocking mode for the socket is enabled using the ioctlsocket routine:\n\n##### Figure 28\n\n\n-----\n\nThere is a call to GetTickCount followed by another one to the _rand function. The result of the operations\nis encrypted using the RC4 key presented before. The structure of the data sent to the server is “17 03 01\n00 <buffer length> buffer”:\n\n\n##### Figure 29\n\n\nThe process receives data from the socket by calling the recv function. It expects a structure such as “17\n03 01 00 <buffer length>”, and then other recv calls follow:\n\n\n##### Figure 30\n\n\nA new thread that will handle the RAT capabilities of the malware is created via a CreateThread API call:\n\n##### Figure 31\n\n\n-----\n\nOllyDumpEx plugin is used to dump the process memory for further analysis, however, we still need to fix\nthe IAT (import address table):\n\n\n##### Figure 32\n\n\nScylla (https://github.com/NtQuery/Scylla) didn’t help us in fixing the IAT, however Imports Fixer 1.6\n(https://forum.tuts4you.com/files/file/1205-imports-fixer-legacy-archives/) has performed this task\nsuccessfully:\n\n\n-----\n\n##### Figure 33\n\n\nDepending on what command it receives from the C2 server, the malware implements 34 different cases\nregarding RAT functionalities (some of them have the same execution flow as we’ll see later on):\n\n\n##### Figure 34\n\n\n-----\n\n## THREAD ACTIVITY – SUB_4085A0 FUNCTION\n\n\nWe will describe each execution flow depending on the EAX value, which is computed based on the data\nthe malware receives from the C2 server (figure 34).\n\nEAX = 0 – traverse a directory received from the C2 server and send the files name to the C2\n\nThe process traverses the targeted directory using the FindFirstFileW and FindNextFileW functions:\n\n\n##### Figure 35\n\n\nThe directory name is encrypted using the XOR algorithm and sent to the C2 server. The file name is\nencrypted as well (note the case number):\n\n\n##### Figure 36\n\n\nThe encrypted file name is transmitted to the server in the structure “17 03 01 00 <encrypted filename\nlength> encrypted filename”, as shown in figure 37.\n\n\n-----\n\n##### Figure 37\n\n\nEAX = 1 – enumerate the processes and the modules of the current process. Extract the process creation\ntime, the exit time of the process, the amount of time that the process has executed in user/kernel mode.\nOpen the access token associated with a process and determine if the user belongs to a privileged group\n\nThe binary takes a snapshot of the processes (0x2 = TH32CS_SNAPPROCESS):\n\n\n##### Figure 38\n\n\nThe processes are enumerated using the Process32FirstW and Process32NextW APIs:\n\n\n##### Figure 39\n\n\nOpenProcess is utilized to open the local process object (0x410 = PROCESS_QUERY_INFORMATION |\n**PROCESS_VM_READ):**\n\n\n##### Figure 40\n\n\n-----\n\nThe process name is XOR-ed and exfiltrated to the C2 server using the send routine:\n\n\n##### Figure 41\n\n\n##### Figure 42\n\n\nThe file takes a snapshot of the current process that includes all its modules (0x8 =\n**TH32CS_SNAPMODULE):**\n\n\n##### Figure 43\n\n\nThe modules are enumerated using the Module32FirstW and Module32NextW APIs:\n\n\n-----\n\n##### Figure 44\n\n\nThe module name is XOR-ed and exfiltrated to the C2 server using the send routine:\n\n\n##### Figure 45\n\n\n##### Figure 46\n\n\nGetProcessTimes is used to retrieve timing information for the enumerated process:\n\n\n-----\n\n##### Figure 47\n\n\nThe malicious process converts the creation time of the enumerated process to system time format:\n\n\n##### Figure 48\n\n\nThe OpenProcessToken routine is used to open the access token associated with the enumerated process\n(0x8 = TOKEN_QUERY):\n\n\n##### Figure 49\n\n\nGetTokenInformation is utilized to retrieve the user account of the token, as shown below (0x1 =\n**TokenUser):**\n\n\n-----\n\n##### Figure 50\n\n\nThe binary uses the LookupAccountSidW API to retrieve the account that corresponds to a SID and the\nname of the first domain on which the SID was found:\n\n\n##### Figure 51\n\n\nThe Terminal Services session identifier associated with the token from above is extracted using the\nGetTokenInformation function (0xc = TokenSessionId):\n\n\n##### Figure 52\n\n\nWhether the malware has successfully opened a process and extracted its creation time, the process ID\nalong with the creation time and process name are encrypted using the XOR algorithm and transmitted to\nthe C2 server:\n\n\n-----\n\n##### Figure 53\n\n\nEAX = 2 – kill a specific process obtained from the C2 server\n\nThe processes are enumerated using the Process32FirstW and Process32NextW functions:\n\n\n##### Figure 54\n\n\nThe malware opens the targeted process via a call to OpenProcess (0x100001 = **SYNCHRONIZE |**\n**PROCESS_TERMINATE):**\n\n\n##### Figure 55\n\n\nTerminateProcess is utilized to kill the targeted process and all of its threads:\n\n\n##### Figure 56\n\n\nEAX = 3 – create a specific process obtained from the C2 server\n\n\n-----\n\nA new process whose name is obtained from the C2 server is created using the CreateProcessW API\n(0x8000000 = CREATE_NO_WINDOW):\n\n\n##### Figure 57\n\n\nEAX = 4 – create a process obtained from the C2 server with a specific token\n\nThe WTSQueryUserToken routine is utilized to obtain the primary access token of the user specified by\nsession 0:\n\n\n##### Figure 58\n\n\nThe file creates a new process that runs in the security context of the user represented by the above token:\n\n\n##### Figure 59\n\n\nEAX = 5, 8, 9, 10, 15, 19, 20, 21, 22, 23, 25, 26, 29, 30 – send 4 encrypted bytes to the C2 server\n\n\n-----\n\nThe executable XOR-ed the “0xFFFFFFFF” number with some key bytes and sends the result to the C2\nserver:\n\n\n##### Figure 60\n\n\nEAX = 6 – create and populate a new file and perform timestomping\n\nA new file whose name is received from the C2 server is created by the malware:\n\n\n##### Figure 61\n\n\nThe malicious process opens the “cmd.exe” file:\n\n\n##### Figure 62\n\n\nThe created, last accessed and last modified times of the “cmd.exe” file are extracted using the GetFileTime\nAPI:\n\n\n-----\n\n##### Figure 63\n\nThe created, last accessed, and last modified times of the newly created file are set to the ones extracted\nabove:\n\n##### Figure 64\n\n\n##### Figure 65\n\n\n-----\n\nThe file is populated with content received from the server, as shown in figure 66:\n\n\n##### Figure 66\n\n\nEAX = 7 – read file content, extract file times and exfiltrate them to the C2 server\n\nThe process opens the targeted file using the CreateFileW routine:\n\n\n##### Figure 67\n\n\nThe created, last accessed, and last modified times of the above file are extracted using the GetFileTime\nAPI:\n\n\n##### Figure 68\n\n\nReadFile is utilized to retrieve the file content:\n\n\n-----\n\n##### Figure 69\n\n\nThe filename, file times, and file content are encrypted using the XOR operator and sent to the C2 server:\n\n\n##### Figure 70\n\n\nEAX = 11 – open file, extract file times and create a new file and modify its file times\n\nCreateFileW is used to open a file specified by the C2 server:\n\n##### Figure 71\n\nThe created, last accessed, and last modified times of the above file are extracted using the GetFileTime\nfunction:\n\n##### Figure 72\n\n\n-----\n\nA new file designated by the C2 server is created by the binary:\n\n\n##### Figure 73\n\n\nThe SetFileTime routine is utilized to set the created, last accessed, and last modified times for the new file\nto the values extracted before:\n\n\n##### Figure 74\n\n\nEAX = 12, 14 – convert the system time to a calendar value and write it into memory\n\nThe malware extracts the system time and converts it to a calendar value:\n\n\n##### Figure 75\n\n\n-----\n\nEAX = 13 – convert the system time to a calendar value and write it into memory (different function from\nabove)\n\nThe malware extracts the system time and converts it to a calendar value:\n\n\n##### Figure 76\n\n\nEAX = 16 – create and populate a new file and move it to a newly generated file\n\nThe FindFirstFileW API is utilized to search the current directory for a file name pushed as a parameter:\n\n\n##### Figure 77\n\n\nThe process creates the new file mentioned above using the CreateFileW function:\n\n\n-----\n\n##### Figure 78\n\n\nFour NULL bytes are written in the file created above:\n\n\n##### Figure 79\n\n\nThe GetTickCount and _rand functions are used to generate eight pseudo-random low characters. The\nbinary moves the file from above to a new one (0x8 = MOVEFILE_WRITE_THROUGH):\n\n\n##### Figure 80\n\n\nEAX = 17 – execute a Windows command and send the output to the C2 server\n\nThe %TEMP% directory is retrieved using the GetTempPathW routine:\n\n\n##### Figure 81\n\n\nThe executable creates a new temporary file, which starts with “CM”, as shown in figure 82.\n\n\n-----\n\n##### Figure 82\n\n\nThe malware executes a Windows command received from the C2 server and stores the output into the\ntemporary file created above:\n\n\n##### Figure 83\n\n\nReadFile is utilized to read data from the above file and store it into memory:\n\n\n##### Figure 84\n\n\nThe output of the Windows command is XOR-ed with a buffer that was used during multiple XOR operations\nand exfiltrated to the C2 server:\n\n\n-----\n\n##### Figure 85\n\n\nThe binary kills the spawned process if it’s still running:\n\n\n##### Figure 86\n\n\nThe temporary file is deleted by the malware:\n\n\n##### Figure 87\n\n\nEAX = 18 – connect to a specific IP on a port received from the C2 server\n\nThe binary expects an argument such as “100.101.102.103:5555”. It converts the port number from string\nto integer:\n\n\n-----\n\n##### Figure 88\n\n\nThe inet_addr function is used to transform the IP address into a proper address for the IN_ADDR structure:\n\n\n##### Figure 89\n\n\nA new socket is created by the executable (0x2 = **AF_INET, 0x1 =** **SOCK_STREAM and 0x6**\n= IPPROTO_TCP):\n\n\n##### Figure 90\n\n\nThe file enables the non-blocking mode for the socket using the ioctlsocket routine (0x8004667e =\n**FIONBIO):**\n\n\n##### Figure 91\n\n\nA new connection to the socket is established by the malware:\n\n\n-----\n\n##### Figure 92\n\n\nThe TCP linger is set to 1 using the setsockopt API (0xffff = SOL_SOCKET and 0x80 = SO_LINGER), as\nshown in figure 93.\n\n\n##### Figure 93\n\n\nEAX = 24 – encrypt the C2 IP addresses using the XOR operator and send the result to the C2 server\n\nThe buffer that contains the C2 IP addresses and the port number is encrypted with the XOR operation:\n\n\n##### Figure 94\n\n\nThe encrypted content is transmitted to the C2 server via a send function call:\n\n\n##### Figure 95\n\n\n-----\n\nEAX = 27 – move an existing directory provided by the C2 server to the Desktop directory\n\nThe FindFirstFileW function is used to search the current directory for a subdirectory pushed as a parameter,\nas shown in figure 96.\n\n\n##### Figure 96\n\n\nThe process tries to move the above directory to the Desktop folder (0x8 =\n**MOVEFILE_WRITE_THROUGH):**\n\n\n##### Figure 97\n\n\nEAX = 28 – traverse an existing directory or extract the drive type and the amount of free space on the\ndisk\n\nWhether the parameter provided by the server is a folder name, then the process traverses the directory\nusing the FindFirstFileW and FindNextFileW APIs and send the status (an encrypted buffer) to the C2 server:\n\n\n##### Figure 98\n\n\nWhether the parameter provided by the server is a disk drive, the file retrieves the drive type using the\nGetDriveTypeW routine, as shown in figure 99.\n\n\n-----\n\n##### Figure 99\n\n\nThe binary gets the total amount of space and the total amount of free space that is available on the “C:\\”\ndrive:\n\n\n##### Figure 100\n\n\nThe case number and the drive type, along with the amount of space and the amount of free space, are\nencrypted using the XOR operator and send to the C2 server:\n\n\n##### Figure 101\n\n\nEAX = 31 – extract the current directory name and send it to the C2 server\n\nThe binary retrieves the current directory using the GetCurrentDirectoryW routine:\n\n\n##### Figure 102\n\n\nThe case number and the directory name are encrypted using XOR operation and transmitted to the C2\nserver, as shown in the figure below.\n\n\n-----\n\n##### Figure 103\n\n\nEAX = 32 – set the current directory for the current process to a value provided by the C2 server\n\nThe executable calls the FindFirstFileW API with the directory as a parameter:\n\n\n##### Figure 104\n\n\nThe current directory for the process is changed using the SetCurrentDirectoryW API:\n\n\n##### Figure 105\n\n\nEAX = 33 – delete a registry value used for persistence and all artifacts associated with the malware on\nthe system\n\nGetTempPathA is utilized to retrieve the %TEMP% directory:\n\n\n##### Figure 106\n\n\nThe process creates a batch file called CMUPD.bat, as highlighted in figure 107.\n\n\n-----\n\n##### Figure 107\n\n\nThe binary opens the Run registry key that is commonly used for persistence purposes (0x80000002 =\n**HKEY_LOCAL_MACHINE and 0xF003F = KEY_ALL_ACCESS):**\n\n\n##### Figure 108\n\n\nA value with the same name as the executable (which we generically called “lazarus”) is deleted by the\nmalware using RegDeleteValueW:\n\n\n##### Figure 109\n\n\nThe content of the batch file is displayed below. It is used to delete the malicious file and afterwards the\nbatch file:\n\n\n##### Figure 110\n\n\n-----\n\nA new process that runs the batch file is created by the malware, and this concludes our analysis:\n\n\n##### Figure 111\n\n\n## INDICATORS OF COMPROMISE\n\n\nSHA256: a606716355035d4a1ea0b15f3bee30aad41a2c32df28c2d468eafd18361d60d6\n\nC2 IP addresses:\n\n125.212.132.222\n\n175.100.189.174\n\n\n## APPENDIX\n\n\n##### Decryption algorithm for strings (Python)\nl = [\"GvgVvihrlmEcW\",\n\"GvgVlofnvImulinagrlmW\",\n\"GvgUhviNanvW\",\n\"GvgTvnkPagsW\",\n\"GvgTvnkFrovNanvW\",\n\"GvgTrxpClfmg\",\n\"GvgTlpvmImulinagrlm\",\n\"GvgSbhgvnDrivxglibW\",\n\"GvgPilxvhhTrnvh\",\n\"GvgMlwfovHamwovW\",\n\"GvgMlwfovFrovNanvW\",\n\"GvgLlxaoTrnv\",\n\"GvgLltrxaoDirevh\",\n\"GvgLahgEiili\",\n\"GvgFrovTrnv\",\n\"GvgFrovSrzv\",\n\"GvgFrovAggiryfgvhW\",\n\"GvgEcrgClwvTsivaw\",\n\"GvgEcrgClwvPilxvhh\",\n\"GvgDrhpFivvSkaxvEcW\",\n\"GvgDirevTbkvW\",\n\n\n-----\n\n\"GvgClnkfgviNanvW\",\n\"GvgCfiivmgPilxvhh\",\n\"GvgCfiivmgDrivxglibW\",\n\"GvgAwakgvihImul\",\n\"RvtCivagvKvbW\"]\n\nfor j in range (0, len(l)):\ns = ''\na = l[j]\nfor i in range (0, len(a)):\nb = hex(ord(a[i]))\nb = int(b,16)\nif (b > 0x61) and (b < 0x7a):\nc = int(\"0xdb\",16) - b\ns = s + str(bytearray.fromhex(str(hex(c))[2:]).decode())\nelse:\ns = s + a[i]\n\nprint s+\"\\n\"\n\n##### Yara rule for detecting the threat\n\nrule Lazarus_FALLCHILL_RAT\n{\nmeta:\n\nauthor = \"Vlad Pasca - LIFARS LLC\"\nDate = \"2021-08-25\"\nReference = \"https://us-cert.cisa.gov/sites/default/files/publications/MAR10135536-A_WHITE_S508C.pdf\"\nstrings:\n\n$s1 = \"GvgFrovSrzv\" fullword ascii\n$s2 = \"LlxpRvhlfixv\" fullword ascii\n$s3 = \"Pilxvhh32FrihgW\" fullword ascii\n$s4 = \"WirgvPilxvhhMvnlib\" fullword ascii\n\n$t1 = \"@echo off\" fullword ascii\n$t2 = \"c%sd.e%sc %s > \\\"%s\\\" 2>&1\" fullword wide\n$t3 = \"- -\" fullword wide\n$t4 = \"REGSVR32.EXE.MUI\" fullword wide\ncondition:\n\n(uint16(0) == 0x5A4D) and (3 of ($s*) or 3 of ($t*))\n}\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "bf5be533-fa31-4590-ae37-5761c97ffa34",
            "created_at": "2022-10-25T16:13:58.389257Z",
            "updated_at": "2022-10-25T16:13:58.389257Z",
            "deleted_at": null,
            "name": "Malpedia",
            "url": "https://malpedia.caad.fkie.fraunhofer.de",
            "description": "Malpedia is a free service offered by Fraunhofer FKIE",
            "reports": null
        }
    ],
    "references": [
        "https://lifars.com/wp-content/uploads/2021/09/Lazarus.pdf"
    ],
    "report_names": [
        "Lazarus.pdf"
    ],
    "threat_actors": [
        {
            "id": "5d2bd376-fcdc-4c6a-bc2c-17ebbb5b81a4",
            "created_at": "2022-10-25T16:07:23.667223Z",
            "updated_at": "2025-03-27T02:02:09.916086Z",
            "deleted_at": null,
            "main_name": "GCHQ",
            "aliases": [
                "Government Communications Headquarters",
                "Operation Socialist"
            ],
            "source_name": "ETDA:GCHQ",
            "tools": [
                "Prax",
                "Regin",
                "WarriorPride"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "f8dddd06-da24-4184-9e24-4c22bdd1cbbf",
            "created_at": "2023-01-06T13:46:38.626906Z",
            "updated_at": "2025-03-27T02:00:02.877001Z",
            "deleted_at": null,
            "main_name": "Tick",
            "aliases": [
                "Stalker Taurus",
                "PLA Unit 61419",
                "Nian",
                "BRONZE BUTLER",
                "REDBALDKNIGHT",
                "STALKER PANDA",
                "G0060"
            ],
            "source_name": "MISPGALAXY:Tick",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "32a223a8-3c79-4146-87c5-8557d38662ae",
            "created_at": "2022-10-25T15:50:23.703698Z",
            "updated_at": "2025-03-27T02:00:55.528031Z",
            "deleted_at": null,
            "main_name": "Lazarus Group",
            "aliases": [
                "Lazarus Group",
                "Labyrinth Chollima",
                "HIDDEN COBRA",
                "Guardians of Peace",
                "NICKEL ACADEMY",
                "Diamond Sleet"
            ],
            "source_name": "MITRE:Lazarus Group",
            "tools": [
                "RawDisk",
                "Proxysvc",
                "BADCALL",
                "FALLCHILL",
                "WannaCry",
                "HOPLIGHT",
                "TYPEFRAME",
                "Dtrack",
                "HotCroissant",
                "HARDRAIN",
                "Dacls",
                "KEYMARBLE",
                "TAINTEDSCRIBE",
                "AuditCred",
                "netsh",
                "ECCENTRICBANDWAGON",
                "AppleJeus",
                "BLINDINGCAN",
                "ThreatNeedle",
                "Volgmer",
                "Cryptoistic",
                "RATANKBA",
                "Bankshot",
                "Torisma",
                "Mimikatz"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "8bc1a044-a23b-4904-903c-13f463605cb3",
            "created_at": "2024-05-01T02:03:08.136237Z",
            "updated_at": "2025-03-27T02:05:17.415795Z",
            "deleted_at": null,
            "main_name": "NICKEL GLADSTONE",
            "aliases": [
                "Bluenoroff ",
                "CTG-6459 ",
                "Citrine Sleet ",
                "HIDDEN COBRA ",
                "Lazarus Group",
                "Sapphire Sleet ",
                "Stardust Chollima ",
                "APT38 "
            ],
            "source_name": "Secureworks:NICKEL GLADSTONE",
            "tools": [
                " Bankshot",
                " CATCH22",
                " CCGC_Proxy",
                " Cur1Agent",
                " Ratankba",
                " Server_TrafficForwarder",
                " Wcry",
                "AlphaNC"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "a2b92056-9378-4749-926b-7e10c4500dac",
            "created_at": "2023-01-06T13:46:38.430595Z",
            "updated_at": "2025-03-27T02:00:02.831633Z",
            "deleted_at": null,
            "main_name": "Lazarus Group",
            "aliases": [
                "Operation DarkSeoul",
                "APT38",
                "ATK117",
                "DEV-1222",
                "G0032",
                "APT 38",
                "Stardust Chollima",
                "APT-C-26",
                "ATK3",
                "Diamond Sleet",
                "Hidden Cobra",
                "Unit 121",
                "Subgroup: Bluenoroff",
                "NICKEL GLADSTONE",
                "DEV-0139",
                "Andariel",
                "Operation Troy",
                "COVELLITE",
                "TA404",
                "Lazarus group",
                "Dark Seoul",
                "G0082",
                "NewRomanic Cyber Army Team",
                "Bluenoroff",
                "Appleworm",
                "Nickel Academy",
                "COPERNICIUM",
                "Hastati Group",
                "Bureau 121",
                "Operation AppleJeus",
                "Whois Hacking Team",
                "Citrine Sleet",
                "Sapphire Sleet",
                "Group 77",
                "Labyrinth Chollima",
                "Operation GhostSecret",
                "BeagleBoyz"
            ],
            "source_name": "MISPGALAXY:Lazarus Group",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "d4e7cd9a-2290-4f89-a645-85b9a46d004b",
            "created_at": "2022-10-25T16:07:23.419513Z",
            "updated_at": "2025-03-27T02:02:09.790389Z",
            "deleted_at": null,
            "main_name": "Bronze Butler",
            "aliases": [
                "Bronze Butler",
                "CTG-2006",
                "Operation ENDTRADE",
                "RedBaldNight",
                "Stalker Panda",
                "Stalker Taurus",
                "TEMP.Tick",
                "Tick"
            ],
            "source_name": "ETDA:Bronze Butler",
            "tools": [
                "8.t Dropper",
                "8.t RTF exploit builder",
                "8t_dropper",
                "9002 RAT",
                "AngryRebel",
                "Blogspot",
                "Daserf",
                "Datper",
                "Elirks",
                "Farfli",
                "Gh0st RAT",
                "Ghost RAT",
                "HOMEUNIX",
                "HidraQ",
                "HomamDownloader",
                "Homux",
                "Hydraq",
                "Lilith",
                "Lilith RAT",
                "McRAT",
                "MdmBot",
                "Mimikatz",
                "Minzen",
                "Moudour",
                "Muirim",
                "Mydoor",
                "Nioupale",
                "PCRat",
                "POISONPLUG.SHADOW",
                "Roarur",
                "RoyalRoad",
                "ShadowPad Winnti",
                "ShadowWali",
                "ShadowWalker",
                "SymonLoader",
                "WCE",
                "Wali",
                "Windows Credential Editor",
                "Windows Credentials Editor",
                "XShellGhost",
                "XXMM",
                "gsecdump",
                "rarstar"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "bf0489c5-1c07-41e6-91c9-855ad96ccc6a",
            "created_at": "2022-10-25T16:47:55.541639Z",
            "updated_at": "2025-03-27T02:05:17.253496Z",
            "deleted_at": null,
            "main_name": "BRONZE BUTLER",
            "aliases": [
                "Daserf",
                "Stalker Panda ",
                "Tick ",
                "CTG-2006 "
            ],
            "source_name": "Secureworks:BRONZE BUTLER",
            "tools": [
                " DGet",
                " Daserf",
                " Datper",
                " Gofarer",
                " MSGet",
                " Mimikatz",
                " RarStar",
                " Screen Capture Tool",
                " ShadowPad",
                " T-SMB",
                " WinRAR",
                " Windows Credential Editor",
                " gsecdump",
                " xmm downloader",
                " xxmm",
                "ABK"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "f32df445-9fb4-4234-99e0-3561f6498e4e",
            "created_at": "2022-10-25T16:07:23.756373Z",
            "updated_at": "2025-03-27T02:02:09.966155Z",
            "deleted_at": null,
            "main_name": "Lazarus Group",
            "aliases": [
                "APT-C-26",
                "ATK 3",
                "Appleworm",
                "Citrine Sleet",
                "DEV-0139",
                "Diamond Sleet",
                "Gleaming Pisces",
                "Gods Apostles",
                "Gods Disciples",
                "Group 77",
                "Guardians of Peace",
                "Hastati Group",
                "Hidden Cobra",
                "ITG03",
                "Jade Sleet",
                "Labyrinth Chollima",
                "Lazarus Group",
                "NewRomanic Cyber Army Team",
                "Operation 99",
                "Operation AppleJeus",
                "Operation AppleJeus sequel",
                "Operation Blockbuster: Breach of Sony Pictures Entertainment",
                "Operation CryptoCore",
                "Operation Dream Job",
                "Operation Dream Magic",
                "Operation Flame",
                "Operation GhostSecret",
                "Operation In(ter)caption",
                "Operation LolZarus",
                "Operation Marstech Mayhem",
                "Operation No Pineapple!",
                "Operation North Star",
                "Operation Phantom Circuit",
                "Operation Sharpshooter",
                "Operation Ten Days of Rain / DarkSeoul",
                "Operation Troy",
                "SectorA01",
                "Slow Pisces",
                "TA404",
                "TraderTraitor",
                "UNC2970",
                "UNC4034",
                "UNC4736",
                "UNC4899",
                "UNC577",
                "Whois Hacking Team"
            ],
            "source_name": "ETDA:Lazarus Group",
            "tools": [
                "3CX Backdoor",
                "3Rat Client",
                "3proxy",
                "AIRDRY",
                "ARTFULPIE",
                "ATMDtrack",
                "AlphaNC",
                "Alreay",
                "Andaratm",
                "AngryRebel",
                "AppleJeus",
                "Aryan",
                "AuditCred",
                "BADCALL",
                "BISTROMATH",
                "BLINDINGCAN",
                "BTC Changer",
                "BUFFETLINE",
                "BanSwift",
                "Bankshot",
                "Bitrep",
                "Bitsran",
                "BlindToad",
                "Bookcode",
                "BootWreck",
                "BottomLoader",
                "Brambul",
                "BravoNC",
                "Breut",
                "COLDCAT",
                "COPPERHEDGE",
                "CROWDEDFLOUNDER",
                "Castov",
                "CheeseTray",
                "CleanToad",
                "ClientTraficForwarder",
                "CollectionRAT",
                "Concealment Troy",
                "Contopee",
                "CookieTime",
                "Cyruslish",
                "DAVESHELL",
                "DBLL Dropper",
                "DLRAT",
                "DRATzarus",
                "DRATzarus RAT",
                "Dacls",
                "Dacls RAT",
                "DarkComet",
                "DarkKomet",
                "DeltaCharlie",
                "DeltaNC",
                "Dembr",
                "Destover",
                "DoublePulsar",
                "Dozer",
                "Dtrack",
                "Duuzer",
                "DyePack",
                "ECCENTRICBANDWAGON",
                "ELECTRICFISH",
                "Escad",
                "EternalBlue",
                "FALLCHILL",
                "FYNLOS",
                "FallChill RAT",
                "Farfli",
                "Fimlis",
                "FoggyBrass",
                "FudModule",
                "Fynloski",
                "Gh0st RAT",
                "Ghost RAT",
                "Gopuram",
                "HARDRAIN",
                "HIDDEN COBRA RAT/Worm",
                "HLOADER",
                "HOOKSHOT",
                "HOPLIGHT",
                "HOTCROISSANT",
                "HOTWAX",
                "HTTP Troy",
                "Hawup",
                "Hawup RAT",
                "Hermes",
                "HotCroissant",
                "HotelAlfa",
                "Hotwax",
                "HtDnDownLoader",
                "Http Dr0pper",
                "ICONICSTEALER",
                "Joanap",
                "Jokra",
                "KANDYKORN",
                "KEYMARBLE",
                "Kaos",
                "KillDisk",
                "KillMBR",
                "Koredos",
                "Krademok",
                "LIGHTSHIFT",
                "LIGHTSHOW",
                "LOLBAS",
                "LOLBins",
                "Lazarus",
                "LightlessCan",
                "Living off the Land",
                "MATA",
                "MBRkiller",
                "MagicRAT",
                "Manuscrypt",
                "Mimail",
                "Mimikatz",
                "Moudour",
                "Mydoom",
                "Mydoor",
                "Mytob",
                "NACHOCHEESE",
                "NachoCheese",
                "NestEgg",
                "NickelLoader",
                "NineRAT",
                "Novarg",
                "NukeSped",
                "OpBlockBuster",
                "PCRat",
                "PEBBLEDASH",
                "PLANKWALK",
                "POOLRAT",
                "PSLogger",
                "PhanDoor",
                "Plink",
                "PondRAT",
                "PowerBrace",
                "PowerRatankba",
                "PowerShell RAT",
                "PowerSpritz",
                "PowerTask",
                "Preft",
                "ProcDump",
                "Proxysvc",
                "PuTTY Link",
                "QUICKRIDE",
                "QUICKRIDE.POWER",
                "Quickcafe",
                "QuiteRAT",
                "R-C1",
                "ROptimizer",
                "Ratabanka",
                "RatabankaPOS",
                "Ratankba",
                "RatankbaPOS",
                "RawDisk",
                "RedShawl",
                "Rifdoor",
                "Rising Sun",
                "Romeo-CoreOne",
                "RomeoAlfa",
                "RomeoBravo",
                "RomeoCharlie",
                "RomeoCore",
                "RomeoDelta",
                "RomeoEcho",
                "RomeoFoxtrot",
                "RomeoGolf",
                "RomeoHotel",
                "RomeoMike",
                "RomeoNovember",
                "RomeoWhiskey",
                "Romeos",
                "RustBucket",
                "SHADYCAT",
                "SHARPKNOT",
                "SIGFLIP",
                "SIMPLESEA",
                "SLICKSHOES",
                "SORRYBRUTE",
                "SUDDENICON",
                "SUGARLOADER",
                "SheepRAT",
                "SierraAlfa",
                "SierraBravo",
                "SierraCharlie",
                "SierraJuliett-MikeOne",
                "SierraJuliett-MikeTwo",
                "SimpleTea",
                "SimplexTea",
                "SmallTiger",
                "Stunnel",
                "TAINTEDSCRIBE",
                "TAXHAUL",
                "TFlower",
                "TOUCHKEY",
                "TOUCHMOVE",
                "TOUCHSHIFT",
                "TOUCHSHOT",
                "TWOPENCE",
                "TYPEFRAME",
                "Tdrop",
                "Tdrop2",
                "ThreatNeedle",
                "Tiger RAT",
                "TigerRAT",
                "Trojan Manuscript",
                "Troy",
                "TroyRAT",
                "VEILEDSIGNAL",
                "VHD",
                "VHD Ransomware",
                "VIVACIOUSGIFT",
                "VSingle",
                "ValeforBeta",
                "Volgmer",
                "Vyveva",
                "W1_RAT",
                "Wana Decrypt0r",
                "WanaCry",
                "WanaCrypt",
                "WanaCrypt0r",
                "WannaCry",
                "WannaCrypt",
                "WannaCryptor",
                "WbBot",
                "Wcry",
                "Win32/KillDisk.NBB",
                "Win32/KillDisk.NBC",
                "Win32/KillDisk.NBD",
                "Win32/KillDisk.NBH",
                "Win32/KillDisk.NBI",
                "WinorDLL64",
                "Winsec",
                "WolfRAT",
                "Wormhole",
                "YamaBot",
                "Yort",
                "ZetaNile",
                "concealment_troy",
                "http_troy",
                "httpdr0pper",
                "httpdropper",
                "klovbot",
                "sRDI"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1666716503,
    "ts_updated_at": 1743041842,
    "ts_creation_date": 1631117248,
    "ts_modification_date": 1631180003,
    "files": {
        "pdf": "https://archive.orkl.eu/f6e2328ac8ffb2815f4ca0a5051f5e32796f46d0.pdf",
        "text": "https://archive.orkl.eu/f6e2328ac8ffb2815f4ca0a5051f5e32796f46d0.txt",
        "img": "https://archive.orkl.eu/f6e2328ac8ffb2815f4ca0a5051f5e32796f46d0.jpg"
    }
}