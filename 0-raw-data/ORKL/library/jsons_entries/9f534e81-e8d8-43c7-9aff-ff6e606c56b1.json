{
    "id": "9f534e81-e8d8-43c7-9aff-ff6e606c56b1",
    "created_at": "2023-06-05T02:07:42.5927Z",
    "updated_at": "2025-03-27T02:09:18.684401Z",
    "deleted_at": null,
    "sha1_hash": "d71cc5a1b911f4839ad44c150e9c3d4929b33295",
    "title": "2023-05-10 - Hunting for Ursnif",
    "authors": "",
    "file_creation_date": "2023-06-04T12:45:12Z",
    "file_modification_date": "2023-06-04T12:45:12Z",
    "file_size": 990906,
    "plain_text": "# Hunting for Ursnif\n\n**bridewell.com/insights/news/detail/hunting-for-ursnif**\n\nBridewell’s Cyber Threat Intelligence (CTI) team have uncovered Ursnif infrastructure that\nhas been used in campaigns during 2023, infrastructure which has seen extremely low\ndetection, or no detection, by security vendors. Our team believe that this infrastructure has\nyet to be used by the operators of the Ursnif malware. This infrastructure can be linked\ntogether by the unique attributes of the C2 servers used by the operators, predominantly the\nSSL certificates. This report details the hunting process conducted by Bridewell CTI to\nuncover the Ursnif infrastructure.\n\nSign up to get instant Threat Intelligence Alerts\n\n### What is Ursnif?\n\nUrsnif, or also known as Gozi, is a backdoor that was previously developed as a banking\ntrojan which has had many forks and variants released over the years but now, following suit\nwith other malware such as Emotet and Trickbot, focuses on facilitating ransomware and\ndata exfiltration. The latest variant of Ursnif, known as LDR4, was first observed in June\n2022 by Mandiant[1].\n\nRecent Campaigns In January 2023, the DFIR report [2] documented an intrusion into an\nenvironment that begun with Urnsnif as the backdoor, that lead to the deployment of Cobalt\nStrike and ended with Data Exfiltration. Additionally, the threat actor used the legitimate RMM\ntools Atera and Splashtop Ursnif was delivered in this instance via a malicious ISO file in a\n\n\n-----\n\nphishing email to an end user. In March 2023, esentire reported on BatLoader dropping\nvarious second-stage payloads as part of a Google Ads campaign masquerading as popular\ntools such as Adobe Reader, Zoom and ChatGPT. The dropper would pull down payloads\nsuch as Redline information stealer as well as Ursnif. This activity was also followed up with\nCobalt Strike in enterprise environments to facilitate further intrusion activity.\n\nDuring 2023, there have been different documented initial access methods used to deploy\nUrsnif in to victim environments, such as through target phishing or malicious\nadvertisements. Customers should be aware of this threat currently being used by threat\ngroups to collate and exfiltrate data and support further payload delivery such as Cobalt\nStrike. Royal ransomware group, first observed in June 2022, have made frequent use of\nUrsnif to support data aggregation activities during their intrusions. This ransomware group is\na financially motivated criminal group that has compromised multiple industry sectors\nincluding Critical National Infrastructure.\n\n### Executive Summary\n\nAs a result of our intelligence collection and analysis we identified 72 command and control\nservers associated with Ursnif malware, from our threat research the following points can be\nmade:\n\n23 of the 72 servers contained evidence of the Ursnif malware connecting to them.\n6 are yet to be identified as Ursnif C2 servers.\nDetection remains extremely low with an average of 4.78 vendors detecting the C2\nservers.\n49 servers remain without any communicating files but match the Bridewell hunt rule.\n\n[1] https://www.mandiant.com/resources/blog/rm3-ldr4-ursnif-banking-fraud\n\n[2] https://thedfirreport.com/2023/01/09/unwrapping-ursnifs-gifts/\n\n\n-----\n\n### Key Takeaways\n\nIn March 2023, America’s Cybersecurity & Infrastructure Security Agency published as report\non the Royal Ransomware group stating that Royal uses:\n\n“…malware tools and derivatives, such as Ursnif/Gozi, for data aggregation and exfiltration.”\n\nRoyal Ransomware has been a prominent ransomware threat against global organisations\nsince September 2022, regularly posting victims across multiple sector verticals to their leak\nsite each month. Below is a graph detailing the total number per month. Ursnif is a tool\nutilised by the group during their intrusions and provided Cyber Threat Intelligence teams an\nopportunity to identify and track command and control infrastructure linked to this malware.\n\nThe use of Ursnif in their attack chain makes Ursnif a malware family worth hunting for, as\nsuch this report details the findings of the hunting activity conducted by Bridewell CTI.\n\n### Ursnif Hunt Process\n\nOur research began when analysing some relatively new Ursnif IP addresses published by\nother security researchers. After conducting analysis, we observed notable features that\ncould be leveraged to hunt for new IP addresses in the wild. The Ursnif IP addresses in\nquestion were communicating with C2 servers which had an SSL certificate with the\nfollowing noticeable attributes: the issuer and subject fields.\n\nSSL Certificate Issuer: C=XX ST=1 L=1 O=1 OU=1 CN=*\n\n\n-----\n\nSSL Certificate Subject: C=XX, ST=1, L=1, O=1, OU=1, CN=\n\nFigure 1. Example Ursnif SSL certificate\n\nWorking with this and other features that can be fingerprinted, we were able to identify 72\nfurther servers of interest which matched our new Ursnif hunt rule.\n\nFigure 2. Shodan Results for the Bridewell Ursnif Hunt Rule\n\n### Hosting Infrastructure\n\n\n-----\n\nLooking at the 72 servers, we can identify where they are geographically hosted and by\nwhich hosting providers:\n\nGeographical Distribution - Top 3: Germany, Netherlands, Russia\n\nFigure 3. Geographical distribution of Ursnif C2 servers\n\nHosting Provider - Top 3: servinga GmbH, Datasource AG, GleSYS AB.\n\n\n-----\n\nFigure 4. Hosting provider distribution of Ursnif C2 servers\n\nIn a report by Mandiant last year, they provided indicators of Ursnif C2’s hosted on the ISP\nStark Industries Solutions Limited, however it would appear now that the operators of Ursnif\nhave completely migrated from this ISP and diversified amongst many ISPs, who have been\nassociated with many other malware C2s.\n\n### Analysing the C2s\n\nAfter analysing the 23 Ursnif C2 servers that have Ursnif communicating files, 6 have Ursnif\nfiles communicating but remain unreported and undetected as Ursnif C2’s by Security\nvendors (at the time of writing this report):\n\n95[.]46[.]8[.]157\n\n193[.]164[.]149[.]143\n\n79[.]133[.]124[.]62\n\n45[.]11[.]181[.]117\n\n92[.]38[.]169[.]142\n\n\n-----\n\n31[.]214[.]157[.]31\n\n--\nWe decided to investigate the IP addresses to understand whether the hunt rule was\ncapturing Ursnif C2s and identifying other pivoting opportunities to enhance our hunt rules by\nlooking at associated domains and hardcoded IPs communicating samples.\n\nThe most recently scanned IP in Shodan: 31.214.157[.]31 - Scanned 2023-04-30.\n\nVirus Total Detections: 2/87\n\nAnalysing this IP in Virus Total, we can see two communicating files of Interest:\n\n2023-04-12 - 112b84b09d2051376879f697f03190240132b87bbac0d069175bd3039d492f56\n\n2023-03-18 - 282856a51245496390e8c06ed9fa3dff6171aabffa6132dec93a9b4a30b1e524 MSICBE.tmp\n\nLooking at MSICBE.tmp:\n\nVirus Total Detections: 21/69\n\nAfter pivoting around in VT, we can see the file’s execution parent looks to be a malicious\nversion of LibreOffice, 6ae710.msi.\n\nVirus Total Detections: 3/41\n\nThe sample is configured to also beacon to IP 185.189.151[.]38 (tagged as ISFB by\nThreatFox). This IP does not appear to be active anymore (not captured by our hunt rule),\nhowever by inspecting the scan history in Shodan we can see that the SSL cert with the\nsame attributes matches our hunt rule in Jan 2023.\n\nMSICBE.tmp also pulls down a DLL file:\n\n(c.dll - 2d0f416aa030af708506fea815d4b268ba5a3bdd4680485a65c4cb112bc2ba7d) from\n146.70.158[.]105.\n\nVirus Total Detections: 1/88\n\nSample “92f56” also communicates with the same IP addresses.\n\n\n-----\n\nFigure 5. Relationship graph of Ursnif samples communicating with 185.189.151[.]38\n\n\n-----\n\nFigure 6. Installation of malicious LibreOffice file\n\nFigure 7. Virus Total Results for LibreOffice file.\n\nNext on our result list was 31.214.157[.]160 - hosted on servinga GmbH, which was\nidentified by Virus Total as Ursnif. From this we were able to pivot to a new hunt rule to\nidentify additional unreported Ursnif C2 servers. This IP has a single .dll file called\nfxplugins.dll, communicating with it.\n\nVirus Total Detections: 5/89\n\n\n-----\n\n**This file has connection attempts to the following IP addresses:**\n\n176.10.111[.]111\n\n176.10.111[.]167\n\n176.10.111[.]173\n\n176.10.111[.]233\n\n31.214.157[.]160\n\nSeveral of these IP addresses are not captured by our current rule and to understand why,\nwe built another hunt rule, this time pivoting from 176.10.111[.]167 using additional HTTP\nheader information:\n\nThe results of this hunt: 55 servers\n\nAfter deduplicating results against our first hunt rule, we are left with 7 servers that were not\ncaught by the initial SSL hunt rule. This new rule also captures 176.10.111[.]111, one of the\nC2s used by the fxplugins.dll.\n\n**The new IP addresses:**\n\n176[.]10[.]111[.]111\n\n91[.]241[.]93[.]152\n\n77[.]91[.]86[.]116\n\n45[.]147[.]200[.]47\n\n62[.]3[.]58[.]57\n\n45[.]155[.]250[.]55\n\n92[.]38[.]169[.]142\n\n**Looking at these results further:**\n\n45.147.200[.]47 ← resolved from domains www.gameindikdowd[.]ru and jhgfdlkjhaoiu[.]su\n\nVirus Total Detections: 1/87\n\nThe first domain has been tagged as ISFB.\n\nPivoting off the domain, gameindikdowd[.]ru we can see numerous files that have recently\nused it for C2 traffic.\n\n\n-----\n\nFigure 8. Ursnif communicating files\n\nLooking at two recent files, control.exe (2023-04-04) and BethesdaNetHelper.exe (2023-0307), we can identify additional domains used for C2 communications, including any active IP\naddresses that may not be detected by our hunt rules.\n\ncontrol.exe\n\ngameindikdowd[.]ru\n\njhgfdlkjhaoiu[.]su\n\nreggy505[.]ru - 109.94.209[.]203\n\nPart of malicious AnyDesk campaign:\n\nuelcoskdi[.]ru - 45.130.147[.]89 - caught by hunt rule\n\nBethesdaNetHelper.exe\n\ngameindikdowd.ru\n\niujdhsndjfks[.]ru - 45.130.147[.]89 - caught by hunt rule\n\nreggy505[.]ru - 109.94.209[.]203\n\n\n-----\n\njhgfdlkjhaoiu[.]su, iujdhsndjfks[.]ru, gameindikdowd.ru domains are all referenced by esentire\nin their report. Additionally, the above screenshot aligns to the reference of a control.exe that\nis downloaded and decrypted by the BATLOADER malware in recent campaigns.\n\nApart from a single IP address, we were able to verify that we are capturing all the IP\naddresses resolved by these domains and can link these back to activity reported in open\nsource.\n\nAnother example of an Ursnif C2 yet to be detected by most antivirus providers is\n92.38.169[.]142:\n\nVirus Total Detection: 1/87\n\nA single communicating file called glcheck.exe has been detected as Ursnif on 2023-02-13\nand 2023-04-04 - detected as Ursnif.\n\nVirus Total Detection: 38/70\n\nThe file also communicates with 185.186.245[.]42 (captured by our hunt rule):\n\nVirus Total Detection: 1/87\n\nWhich has the following domains resolving to it:\n\ns28bxcw[.]xyz\n\n8hak4j[.]xyz\n\ndc3txd[.]xyz\n\n2hrbjc[.]xyz\n\n5icvzwz[.]xyz\n\nThese domains also have other IP addresses used for redundancy which are also captured\nby our hunt rule. 95.46.8[.]157 resolved by dantedbkoosov[.]site (3/87 VT) ← 361E.exe\n(58/70 VT, 2023-04-04) Detected as Ursnif (Product: Letasoft Sound Booster):\n\nVirus Total Detection: 1/87\n\n### Findings\n\nResults After conducting our analysis, just under 30% of the infrastructure detected our two\nhunt rules have files communicating with them that have been detected as Ursnif. Of the\ninfrastructure identified as Ursnif C2’s due to the communicating files, the average detection\nrate by security vendors in Virus Total is just 4.78. 71.3% of the IP addresses currently have\n\n\n-----\n\nno communicating files. Based on the similarities in shared attributes and hosting providers,\nwe believe there is high likelihood that these IP addresses will be used in the future by Ursnif\noperators.\n\nFigure 9. Proportion of identified servers having Ursnif-detected communicating files\n\nFigure 10. AV Detection rates of Ursnif C2 servers in Virus Total\n\n### Conclusion\n\nUrsnif is a backdoor that is used by threat actors in campaigns that lead to ransomware and\ndata exfiltration, posing a viable risk to organisations. The malware is delivered via malicious\ndocuments such as macro-enabled office docs or via malicious installers downloaded via\nGoogle Ad campaigns.\n\n\n-----\n\nBridewell proactively searches for Ursnif C2 infrastructure to protect their customer\nenvironments from threats by using a proactive research driven threat intelligence approach\nto security. As a result, Bridewell CTI provides valuable insight in to our SOC service whilst\nimproving customer’s security postures at both a strategic, operational and tactical level.\n\nUrsnif is a longstanding malware that has pivoted from banking trojan to facilitating\nransomware intrusions, particular for the Royal ransomware group. This malware\ncommunicates to C2 infrastructure, allowing CTI teams to track the operators usage,\nallowing defenders to respond in a timely manner to any detections within customer\nenvironments. Detecting these C2’s provides an opportunity to mitigate the impact of\nransomware intrusions before its too late.\n\n### Mitigation Strategies\n\nTo safeguard your organisation against Ursnif and similar threats, it is essential to:\n\nEducate employees about the risks of opening attachments from unknown or suspicious\nsenders.\n\nEnsure that you have a robust application control policy that limits the execution of\nunauthorised applications from untrusted sources.\n\nEnsure that your organisation uses updated antivirus software and firewalls to detect and\nprevent Ursnif infections.\n\nSearch for the Indicators of Compromise (IoCs) listed in the appendix and set up reference\nsets for detection within your organisation's security tools.\n\nImplement a Managed Detection and Response (MDR) service to proactively monitor, detect,\nand respond to threats targeting your organisation.\n\nLeverage a Vulnerability Management service to identify and support remediation of security\nweaknesses within your organisation's network and systems.\n\nIncorporate a Cyber Threat Intelligence (CTI) services to stay informed of emerging threats\nand obtain tailored intelligence to enhance your organisation's cybersecurity posture.\n\n### Appendix 1 – References\n\nhttps://www.blackberry.com/us/en/solutions/endpoint-security/ransomware-protection/ursnif\n\nhttps://www.mandiant.com/resources/blog/rm3-ldr4-ursnif-banking-fraud\n\nhttps://thedfirreport.com/2023/01/09/unwrapping-ursnifs-gifts/\n\n\n-----\n\nhttps://www.esentire.com/blog/batloader-continues-to-abuse-google-search-ads-to-delivervidar-stealer-and-ursnif\n\n## Appendix 2 – Indicators\n\n### C2 IPs\n\n176[.]10[.]111[.]111\n\n79[.]132[.]132[.]216\n\n185[.]212[.]44[.]83\n\n95[.]46[.]8[.]157\n\n45[.]155[.]249[.]200\n\n77[.]73[.]131[.]105\n\n176[.]10[.]111[.]112\n\n185[.]212[.]47[.]59\n\n185[.]212[.]44[.]146\n\n45[.]155[.]250[.]217\n\n37[.]10[.]71[.]114\n\n91[.]242[.]217[.]113\n\n176[.]10[.]111[.]119\n\n91[.]241[.]93[.]152\n\n45[.]11[.]183[.]24\n\n94[.]247[.]42[.]238\n\n185[.]186[.]244[.]168\n\n77[.]91[.]86[.]116\n\n31[.]214[.]157[.]160\n\n79[.]133[.]180[.]95\n\n\n-----\n\n185[.]18[.]55[.]106\n\n109[.]230[.]199[.]174\n\n91[.]242[.]219[.]237\n\n45[.]147[.]200[.]47\n\n45[.]155[.]249[.]47\n\n45[.]155[.]249[.]49\n\n176[.]10[.]125[.]84\n\n194[.]58[.]97[.]42\n\n194[.]76[.]224[.]223\n\n185[.]212[.]44[.]76\n\n91[.]242[.]217[.]71\n\n185[.]158[.]248[.]100\n\n109[.]230[.]199[.]110\n\n170[.]130[.]55[.]65\n\n79[.]132[.]134[.]158\n\n79[.]132[.]135[.]249\n\n194[.]76[.]225[.]141\n\n194[.]76[.]224[.]95\n\n91[.]242[.]217[.]120\n\n91[.]242[.]219[.]235\n\n176[.]10[.]111[.]160\n\n62[.]3[.]58[.]57\n\n185[.]186[.]245[.]42\n\n45[.]155[.]250[.]55\n\n176[ ]10[ ]118[ ]153\n\n\n-----\n\n176[.]10[.]119[.]217\n\n79[.]133[.]124[.]62\n\n45[.]130[.]147[.]89\n\n194[.]76[.]225[.]88\n\n185[.]90[.]162[.]33\n\n185[.]186[.]244[.]108\n\n92[.]38[.]169[.]142\n\n31[.]214[.]157[.]31\n\n109[.]230[.]199[.]248\n\n109.94.209[.]203\n\n176[.]10[.]111[.]111\n\n91[.]241[.]93[.]152\n\n77[.]91[.]86[.]116\n\n45[.]147[.]200[.]47\n\n62[.]3[.]58[.]57\n\n45[.]155[.]250[.]55\n\n92[.]38[.]169[.]142\n\n### Domains\n\ns28bxcw[.]xyz\n\n8hak4j[.]xyz\n\ndc3txd[.]xyz\n\n2hrbjc[.]xyz\n\n5icvzwz[.]xyz\n\ngameindikdowd[.]ru\n\n\n-----\n\njhgfdlkjhaoiu[.]su\n\nreggy505[.]ru\n\niujdhsndjfks[.]ru\n\nreggy505[.]ru\n\njhzzj3[.]xyz\n\n### Register for instant alerts to Bridewell threat advisories or to speak with a member of our Cyber Threat Intelligence team.\n\nAuthor\n\n\n-----\n\nJoshua Penny\n\nSenior Cyber Threat Intelligence Analyst\n\nJoshua Penny is a CISSP certified Cyber Threat Intelligence Analyst with 5 years’\nexperience working within CTI at Bridewell and previously within the education and research\nSector.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2023/2023-05-10 - Hunting for Ursnif.pdf"
    ],
    "report_names": [
        "2023-05-10 - Hunting for Ursnif.pdf"
    ],
    "threat_actors": [
        {
            "id": "d90307b6-14a9-4d0b-9156-89e453d6eb13",
            "created_at": "2022-10-25T16:07:23.773944Z",
            "updated_at": "2025-03-27T02:02:09.974695Z",
            "deleted_at": null,
            "main_name": "Lead",
            "aliases": [
                "Casper",
                "TG-3279"
            ],
            "source_name": "ETDA:Lead",
            "tools": [
                "Agentemis",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "RbDoor",
                "RibDoor",
                "Winnti",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "610a7295-3139-4f34-8cec-b3da40add480",
            "created_at": "2023-01-06T13:46:38.608142Z",
            "updated_at": "2025-03-27T02:00:02.87217Z",
            "deleted_at": null,
            "main_name": "Cobalt",
            "aliases": [
                "Cobalt Gang",
                "GOLD KINGSWOOD",
                "COBALT SPIDER",
                "G0080",
                "Mule Libra",
                "Cobalt Group"
            ],
            "source_name": "MISPGALAXY:Cobalt",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1685930862,
    "ts_updated_at": 1743041358,
    "ts_creation_date": 1685882712,
    "ts_modification_date": 1685882712,
    "files": {
        "pdf": "https://archive.orkl.eu/d71cc5a1b911f4839ad44c150e9c3d4929b33295.pdf",
        "text": "https://archive.orkl.eu/d71cc5a1b911f4839ad44c150e9c3d4929b33295.txt",
        "img": "https://archive.orkl.eu/d71cc5a1b911f4839ad44c150e9c3d4929b33295.jpg"
    }
}