{
    "id": "9297ce51-8fb4-4bc1-a34e-272da4979c7f",
    "created_at": "2023-01-12T15:10:58.656141Z",
    "updated_at": "2025-03-27T02:13:09.658939Z",
    "deleted_at": null,
    "sha1_hash": "8333ce844379b96876236a68a898d1e525eec5cd",
    "title": "2014-12-10 - Cloud Atlas- RedOctober APT is back in style",
    "authors": "",
    "file_creation_date": "2022-09-01T10:17:41Z",
    "file_modification_date": "2022-09-01T10:17:41Z",
    "file_size": 836918,
    "plain_text": "# Cloud Atlas: RedOctober APT is back in style\n\n**[securelist.com/cloud-atlas-redoctober-apt-is-back-in-style/68083](https://securelist.com/cloud-atlas-redoctober-apt-is-back-in-style/68083)**\n\n[APT reports](https://securelist.com/category/apt-reports/)\n\n[APT reports](https://securelist.com/category/apt-reports/)\n\n10 Dec 2014\n\nminute read\n\n\n-----\n\nAuthors\n\nGReAT\n\n[Two years ago, we published our research into RedOctober, a complex cyber-espionage](https://securelist.com/red-october-diplomatic-cyber-attacks-investigation/36740/)\noperation targeting diplomatic embassies worldwide. We named it RedOctober because we\nstarted this investigation in October 2012, an unusually hot month.\n\nAfter our announcement in January 2013, the RedOctober operation was promptly shut\ndown and the network of C&Cs was dismantled. As usually happens with these big\noperations, considering the huge investment and number of resources behind it, they don’t\njust “go away” forever. Normally, the group goes underground for a few months, redesigns\nthe tools and the malware and resume operations.\n\nSee:\n\n[RedOctober Part 1](https://securelist.com/the-red-october-campaign/57647/)\n\n\n-----\n\n[RedOctober Part 2](https://securelist.com/red-october-part-two-the-modules/57645/)\n\nSince January 2013, we’ve been on the lookout for a possible RedOctober comeback. One\n[possible hit was triggered when we observed Mevade, an unusual piece of malware that](http://en.wikipedia.org/wiki/Mevade_Botnet)\nappeared late in 2013. The Mevade C&C name styles as well as some other technical\nsimilarities indicated a connection to RedOctober, but the link was weak. It wasn’t until\nAugust 2014 that we observed something which made us wonder if RedOctober is back for\ngood.\n\n## Meet Cloud Atlas\n\nIn August 2014, some of our users observed targeted attacks with a variation of CVE-20120158 and an unusual set of malware. We did a quick analysis of the malware and it\nimmediately stood out because of certain unusual things that are not very common in the\nAPT world.\n\nSome of the filenames used in the attacks included:\n\nFT – Ukraine Russia’s new art of war.doc\nКатастрофа малайзийского лайнера.doc\nDiplomatic Car for Sale.doc\nМВКСИ.doc\nOrganigrama Gobierno Rusia.doc\nФото.doc\nИнформационное письмо.doc\nФорма заявки (25-26.09.14).doc\nИнформационное письмо.doc\nПисьмо_Руководителям.doc\nПрилож.doc\nCar for sale.doc\nAf-Pak and Central Asia’s security issues.doc\n\nAt least one of them immediately reminded us of RedOctober, which used a very similarly\nnamed spearphish: “Diplomatic Car for Sale.doc”. As we started digging into the operation,\nmore details emerged which supported this theory.\n\nPerhaps the most unusual fact was that the Microsoft Office exploit didn’t directly write a\nWindows PE backdoor on disk. Instead, it writes an encrypted Visual Basic Script and runs it.\n\n\n-----\n\n_Cloud Atlas exploit payload – VBScript_\n\nThis VBScript drops a pair of files on disk – a loader and an encrypted payload. The loader\nappears to be different every time and internal strings indicate it is “polymorphically”\ngenerated. The payload is always encrypted with a unique key, making it impossible to\ndecrypt unless the DLL is available.\n\nWe observed several different spear-phishing documents that drop uniquely named\npayloads. For instance, the “qPd0aKJu.vbs” file MD5:\n\n**E211C2BAD9A83A6A4247EC3959E2A730 drops the following files:**\n\n**DECF56296C50BD3AE10A49747573A346 – bicorporate – encrypted payload**\n\n**D171DB37EF28F42740644F4028BCF727 – ctfmonrn.dll – loader**\n\nThe VBS also adds a registry key:\n\n**HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\ setting the**\nkey “bookstore” to the value “regsvr32 %path%\\ctfmonrn.dll /s”, which ensures the malware\nruns every time at system boot.\n\nSome of the DLL names we observed include:\n\n\n-----\n\n**f4e15c1c2c95c651423dbb4cbe6c8fd5 – bicorporate.dll**\n**649ff144aea6796679f8f9a1e9f51479 – fundamentive.dll**\n\n**40e70f7f5d9cb1a669f8d8f306113485 – papersaving.dll**\n\n**58db8f33a9cdd321d9525d1e68c06456 – previliges.dll**\n\n**f5476728deb53fe2fa98e6a33577a9da – steinheimman.dll**\n\nSome of the payload names include:\n\n**steinheimman**\n\n**papersaving**\n\n**previliges**\n\n**fundamentive**\n\n**bicorporate**\n\n**miditiming**\n\n**damnatorily**\n\n**munnopsis**\n\n**arzner**\n\n**redtailed**\n\n**roodgoose**\n\n**acholias**\n\n**salefians**\n\n**wartworts**\n\n**frequencyuse**\n\n**nonmagyar**\n\n**shebir**\n\n**getgoing**\n\nThe payload includes an encrypted configuration block which contains information about the\nC&C sever:\n\n\n-----\n\nThe information from the config includes a WebDAV URL which is used for connections, a\nusername and password, two folders on the WebDAV server used to store plugins/modules\nfor the malware and where data from the victim should be uploaded.\n\n## C&C communication\n\nThe Cloud Atlas implants utilize a rather unusual C&C mechanism. All the malware samples\nwe’ve seen communicate via HTTPS and WebDav with the same server “cloudme.com”, a\ncloud services provider. According to their website, CloudMe is owned and operated by\nCloudMe AB, a company based in Linköping, Sweden.\n\n(Important note: we do not believe that CloudMe is in any way related to the Cloud Atlas\n_group – the attackers simply create free accounts on this provider and abuse them for_\n_command-and-control)._\n\n\n-----\n\nEach malware set we have observed so far communicates with a different CloudMe account\nthough. The attackers upload data to the account, which is downloaded by the implant,\ndecrypted and interpreted. In turn, the malware uploads the replies back to the server via the\nsame mechanism. Of course, it should be possible to reconfigure the malware to use any\nCloud-based storage service that supports WebDAV.\n\nHere’s a look at one such account from CloudMe:\n\nThe data from the account:\n\n\n-----\n\nThe files stored in the randomly named folder were uploaded by the malware and contain\nvarious things, such as system information, running processes and current username. The\ndata is compressed with LZMA and encrypted with AES, however, the keys are stored in the\nmalware body which makes it possible to decrypt the information from the C&C.\n\nWe previously observed only one other group using a similar method – ItaDuke – that\nconnected to accounts on the cloud provider mydrive.ch.\n\n## Victim statistics: top 5 infected countries\n\n**CloudAtlas** **[RedOctober](https://securelist.com/the-red-october-campaign/57647/)**\n\nRussia 15 35\n\nKazakhstan 14 21\n\nBelarus 4 5\n\nIndia 2 14\n\nCzech Republic 2 5\n\n## Similarities with RedOctober\n\nJust like with RedOctober, the top target of Cloud Atlas is Russia, followed closely by\nKazakhstan, according to data from the Kaspersky Security Network (KSN). Actually, we see\nan obvious overlap of targets between the two, with subtle differences which closely\n**account for the geopolitical changes in the region that happened during the last two**\n**years.**\n\nInterestingly, some of the spear-phishing documents between Cloud Atlas and RedOctober\nseem to exploit the same theme and were used to target the same entity at different times.\n\nCloud Atlas RedOctober\n\n\n-----\n\nBoth Cloud Atlas and RedOctober malware implants rely on a similar construct, with a loader\nand the final payload that is stored encrypted and compressed in an external file. There are\nsome important differences though, especially in the encryption algorithms used – RC4 in\nRedOctober vs AES in Cloud Atlas.\n\nThe usage of the compression algorithms in Cloud Altas and RedOctober is another\ninteresting similarity. Both malicious programs share the code for LZMA compression\nalgorithm. In CloudAtlas it is used to compress the logs and to decompress the decrypted\npayload from the C&C servers, while in Red October the “scheduler” plugin uses it to\ndecompress executable payloads from the C&C.\n\nIt turns out that the implementation of the algorithm is identical in both malicious modules,\nhowever the way it is invoked is a bit different, with additional input integrity checks added to\nthe CloudAtlas version.\n\n\n-----\n\nAnother interesting similarity between the malware families is the configuration of the build\nsystem used to compile the binaries. Every binary created using the Microsoft Visual Studio\ntoolchain has a special header that contains information about the number of input object\nfiles and version information of the compilers used to create them, the “Rich” header called\nso by the magic string that is used to identify it in the file.\n\nWe have been able to identify several RedOctober binaries that have “Rich” headers\ndescribing exactly the same layout of VC 2010 + VC 2008 object files. Although this doesn’t\nnecessarily mean that the binaries were created on the same development computer, they\nwere definitely compiled using the same version of the Microsoft Visual Studio up to the build\nnumber version and using similar project configuration.\n\n\nNumber of\nobject files,\n**CloudAtlas**\n**loader**\n\n\nNumber of object\nfiles, Red October\n**Office plugin**\n\n\nNumber of object\nfiles,Red October\n**Fileputexec plugin**\n\n\nHEX\ncompiler\nversion\n\n\nDecoded\ncompiler\nversion\n\n\n01 01 01 009D766F VC 2010\n(build\n30319)\n\n01 01 01 009B766F VC 2010\n(build\n30319)\n\n22 2E 60 00AB766F VC 2010\n(build\n30319)\n\n5B 60 A3 00010000 –\n\n\n-----\n\n05 07 11 00937809 VC 2008\n(build\n30729)\n\n72 5C 00AA766F VC 2010\n(build\n30319)\n\n20 10 18 009E766F VC 2010\n(build\n30319)\n\nTo summarize the similarities between the two:\n\n**Cloud Atlas** **RedOctober**\n\n\nShellcode marker in spearphished\ndocuments\n\n\nPT@T PT@T\n\n\nTop target country Russia Russia\n\n\nCompression algorithm used for C&C\ncommunications\n\n\nLZMA LZMA\n\n\nC&C servers claim to be / redirect to BBC (mobile\nmalware)\n\nCompiler version VC 2010 (build\n30319)\n\n\nBBC\n\nVC 2010 (build 30319)\n(some modules)\n\n\nFinally, perhaps the strongest connection comes from targeting. Based on observations from\nKSN, some of the victims of RedOctober are also being targeted by CloudAtlas. In at\nleast one case, the victim’s computer was attacked only twice in the last two years, with\nonly two malicious programs – RedOctober and Cloud Atlas.\n\nThese and other details make us believe that CloudAtlas represents a rebirth of the\nRedOctober attacks.\n\n## Conclusion\n\nFollowing big announcements and public exposures of targeted attack operations, APT\ngroups behave in a predictable manner. Most Chinese-speaking attackers simply relocate\nC&C servers to a different place, recompile the malware and carry on as if nothing\nhappened.\n\nOther groups that are more nervous about exposure go in a hibernation mode for months or\nyears. Some may never return using the same tools and techniques.\n\n\n-----\n\nHowever, when a major cyber-espionage operation is exposed, the attackers are unlikely to\n**completely shut down everything. They simply go offline for some time, completely**\nreshuffle their tools and return with rejuvenated forces.\n\n**We believe this is also the case of RedOctober, which makes a classy return with**\n**Cloud Atlas.**\n\nKaspersky products detect the malware from the Cloud Atlas toolset with the following\nverdicts:\n\nExploit.Win32.CVE-2012-0158.j\n\nExploit.Win32.CVE-2012-0158.eu\n\nExploit.Win32.CVE-2012-0158.aw\n\nExploit.MSWord.CVE-2012-0158.ea\n\nHEUR:Trojan.Win32.CloudAtlas.gen\n\nHEUR:Trojan.Win32.Generic\n\nHEUR:Trojan.Script.Generic\nTrojan-Spy.Win32.Agent.ctda\n\nTrojan-Spy.Win32.Agent.cteq\n\nTrojan-Spy.Win32.Agent.ctgm\n\nTrojan-Spy.Win32.Agent.ctfh\n\nTrojan-Spy.Win32.Agent.cter\n\nTrojan-Spy.Win32.Agent.ctfk\n\nTrojan-Spy.Win32.Agent.ctfj\n\nTrojan-Spy.Win32.Agent.crtk\n\nTrojan-Spy.Win32.Agent.ctcz\n\nTrojan-Spy.Win32.Agent.cqyc\n\nTrojan-Spy.Win32.Agent.ctfg\n\nTrojan-Spy.Win32.Agent.ctfi\n\nTrojan-Spy.Win32.Agent.cquy\n\nTrojan-Spy.Win32.Agent.ctew\n\nTrojan-Spy.Win32.Agent.ctdg\n\nTrojan-Spy.Win32.Agent.ctlf\n\nTrojan-Spy.Win32.Agent.ctpz\n\nTrojan-Spy.Win32.Agent.ctdq\n\nTrojan-Spy.Win32.Agent.ctgm\n\nTrojan-Spy.Win32.Agent.ctin\n\nTrojan-Spy.Win32.Agent.ctlg\n\nTrojan-Spy.Win32.Agent.ctpd\n\nTrojan-Spy.Win32.Agent.ctps\n\nTrojan-Spy.Win32.Agent.ctpq\n\nTrojan-Spy.Win32.Agent.ctpy\n\nTrojan-Spy Win32 Agent ctie\n\n\n-----\n\nTrojan-Spy.Win32.Agent.ctcz\nTrojan-Spy.Win32.Agent.ctgz\n\nTrojan-Spy.Win32.Agent.ctpr\n\nTrojan-Spy.Win32.Agent.ctdp\n\nTrojan-Spy.Win32.Agent.ctdr\n\nTrojan.Win32.Agent.idso\n\nTrojan.Win32.Agent.idrx\n\nHEUR:Trojan.Linux.Cloudatlas.a\n\nTrojan.AndroidOS.Cloudatlas.a\n\nTrojan.IphoneOS.Cloudatlas.a\n\n## Parallel research:\n\n[Blue Coat Exposes Inception Framework](https://www.bluecoat.com/security-blog/2014-12-09/blue-coat-exposes-%E2%80%9C-inception-framework%E2%80%9D-very-sophisticated-layered-malware)\n\n[APT](https://securelist.com/tag/apt/)\n[Cyber espionage](https://securelist.com/tag/cyber-espionage/)\n[Malware Descriptions](https://securelist.com/tag/malware-descriptions/)\n[Targeted attacks](https://securelist.com/tag/targeted-attacks/)\n[Trojan-Spy](https://securelist.com/tag/trojan-spy/)\n\nAuthors\n\nGReAT\n\nCloud Atlas: RedOctober APT is back in style\n\nYour email address will not be published. Required fields are marked *\n\nTable of Contents\n\nGReAT webinars\n\n\n-----\n\nSubscribe to our weekly e mails\n\nThe hottest research right in your inbox\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2014/2014-12-10 - Cloud Atlas- RedOctober APT is back in style.pdf"
    ],
    "report_names": [
        "2014-12-10 - Cloud Atlas- RedOctober APT is back in style.pdf"
    ],
    "threat_actors": [
        {
            "id": "02c9f3f6-5d10-456b-9e63-750286048149",
            "created_at": "2022-10-25T16:07:23.722884Z",
            "updated_at": "2025-03-27T02:02:09.945869Z",
            "deleted_at": null,
            "main_name": "Inception Framework",
            "aliases": [
                "ATK 116",
                "Blue Odin",
                "Clean Ursa",
                "Cloud Atlas",
                "Inception Framework",
                "Operation Cloud Atlas",
                "Operation RedOctober",
                "The Rocra"
            ],
            "source_name": "ETDA:Inception Framework",
            "tools": [
                "Lastacloud",
                "PowerShower",
                "VBShower"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "77b28afd-8187-4917-a453-1d5a279cb5e4",
            "created_at": "2022-10-25T15:50:23.768278Z",
            "updated_at": "2025-03-27T02:00:55.5423Z",
            "deleted_at": null,
            "main_name": "Inception",
            "aliases": [
                "Inception Framework",
                "Cloud Atlas"
            ],
            "source_name": "MITRE:Inception",
            "tools": [
                "PowerShower",
                "VBShower",
                "LaZagne"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "9a58d7bb-dd32-41bc-804e-500ef7550cf8",
            "created_at": "2023-01-06T13:46:39.131811Z",
            "updated_at": "2025-03-27T02:00:03.004067Z",
            "deleted_at": null,
            "main_name": "ItaDuke",
            "aliases": [
                "DarkUniverse",
                "SIG27"
            ],
            "source_name": "MISPGALAXY:ItaDuke",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "04a7ebaa-ebb1-4971-b513-a0c86886d932",
            "created_at": "2023-01-06T13:46:38.784965Z",
            "updated_at": "2025-03-27T02:00:02.91817Z",
            "deleted_at": null,
            "main_name": "Inception Framework",
            "aliases": [
                "ATK116",
                "Blue Odin",
                "Clean Ursa",
                "Cloud Atlas",
                "G0100"
            ],
            "source_name": "MISPGALAXY:Inception Framework",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673536258,
    "ts_updated_at": 1743041589,
    "ts_creation_date": 1662027461,
    "ts_modification_date": 1662027461,
    "files": {
        "pdf": "https://archive.orkl.eu/8333ce844379b96876236a68a898d1e525eec5cd.pdf",
        "text": "https://archive.orkl.eu/8333ce844379b96876236a68a898d1e525eec5cd.txt",
        "img": "https://archive.orkl.eu/8333ce844379b96876236a68a898d1e525eec5cd.jpg"
    }
}