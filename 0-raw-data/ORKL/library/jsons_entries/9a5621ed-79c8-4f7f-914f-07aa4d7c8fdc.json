{
    "id": "9a5621ed-79c8-4f7f-914f-07aa4d7c8fdc",
    "created_at": "2022-10-25T16:48:22.656199Z",
    "updated_at": "2025-03-27T02:10:40.340089Z",
    "deleted_at": null,
    "sha1_hash": "8bcb1743d4a9ddbbc6daf063dca8c8107baed218",
    "title": "BlackEnergy by the SSHBearDoor: attacks against Ukrainian news media and electric industry",
    "authors": "ESET",
    "file_creation_date": "2016-04-11T04:24:40Z",
    "file_modification_date": "2016-04-11T04:24:40Z",
    "file_size": 259255,
    "plain_text": "### welivesecurity.com\n\n# BlackEnergy by the SSHBearDoor: attacks against Ukrainian news media and electric industry\n\n### by Anton Cherepanov • Jan. 3, 2016 • 4 min read •\n\n original\n\n\n-----\n\n### Update: In case you want to have a more simplified\n\n version of this article, please check out BlackEnergy\n\n trojan strikes again: Attacks Ukrainian electric power\n\n industry.\n\n The cybercriminal group behind BlackEnergy, the\n\n malware family that has been around since 2007 and\n\n has made a comeback in 2014 (see our previous blog\n\n posts on Back in BlackEnergy *: 2014 Targeted Attacks\n\n\n-----\n\n### in Ukraine and Poland and BlackEnergy PowerPoint\n\n Campaigns, as well as our Virus Bulletin talk on the\n\n subject), was also active in the year 2015.\n\n ESET has recently discovered that the BlackEnergy\n\n trojan was recently used as a backdoor to deliver a\n\n destructive KillDisk component in attacks against\n\n Ukrainian news media companies and against the\n\n electrical power industry. In this blog, we provide\n\n details on the BlackEnergy samples ESET has detected\n\n in 2015, as well as the KillDisk components used in the\n\n attacks. Furthermore, we examine a previously\n\n unknown SSH backdoor that was also used as another\n\n channel of accessing the infected systems, in addition\n\n to BlackEnergy.\n\n We continue to monitor the BlackEnergy malware\n\n operations for future developments. For any inquiries\n\n or to make sample submissions related to the subject,\n\n contact us at: threatintel@eset.com\n\n## BlackEnergy evolution in 2015\n\n\n-----\n\n### Once activated, variants of BlackEnergy Lite allow a\n\n malware operator to check specific criteria in order to\n\n assess whether the infected computer truly belongs to\n\n the intended target. If that is the case, the dropper of a\n\n regular BlackEnergy variant is pushed to the system.\n\n The exact mechanism of infection by BlackEnergy is\n\n described in our Virus Bulletin presentation and this\n\n whitepaper by F-Secure.\n\n The BlackEnergy malware stores XML configuration\n\n data embedded in the binary of DLL payload.\n\n_Figure 1 – The BlackEnergy configuration example used in 2015_\n\n### Apart from a list of C&C servers, the BlackEnergy\n\n config contains a value called build_id. This value is a\n\n unique text string used to identify individual infections\n\n or infection attempts by the BlackEnergy malware\n\n\n-----\n\n### operators. The combinations of letters and numbers\n\n used can sometimes reveal information about the\n\n campaign and targets.\n\n Here is the list of Build ID values that we identified in\n\n 2015:\n\n 2015en\n\n khm10\n\n khelm\n\n 2015telsmi\n\n 2015ts\n\n 2015stb\n\n kiev_o\n\n brd2015\n\n 11131526kbp\n\n 02260517ee\n\n 03150618aaa\n\n 11131526trk\n\n We can speculate that some of them have a special\n\n meaning. For example 2015telsmi could contain the\n\n Russian acronym SMI – Sredstva Massovoj Informacii,\n\n 2015en could mean Energy, and there’s also the obvious\n\n “Kiev”.\n\n\n-----\n\n## s co po e t\n\n### In 2014 some variants of the BlackEnergy trojan\n\n contained a plugin designed for the destruction of the\n\n infected system, named dstr.\n\n In 2015 the BlackEnergy group started to use a new\n\n destructive BlackEnergy component detected by ESET\n\n products as Win32/KillDisk.NBB,\n\n Win32/KillDisk.NBC and Win32/KillDisk.NBD trojan\n\n variants.\n\n The main purpose of this component is to do damage to\n\n data stored on the computer: it overwrites documents\n\n with random data and makes the OS unbootable.\n\n The first known case where the KillDisk component of\n\n BlackEnergy was used was documented by CERT-UA in\n\n November 2015. In that instance, a number of news\n\n media companies were attacked at the time of the 2015\n\n Ukrainian local elections. The report claims that a\n\n large number of video materials and various\n\n documents were destroyed as a result of the attack.\n\n\n-----\n\n### It should be noted that the Win32/KillDisk.NBB\n\n variant used against media companies is more focused\n\n on destroying various types of files and documents. It\n\n has a long list of file extensions that it tries to\n\n overwrite and delete. The complete list contains more\n\n than 4000 file extensions.\n\n_Figure 2 – A partial list of file extensions targeted for destruction by_\n_KillDisk.NBB_\n\n### The KillDisk component used in attacks against energy\n\n companies in Ukraine was slightly different. Our\n\n analysis of the samples shows that the main changes\n\n made in the newest version are:\n\n Now it accepts a command line argument, to set a\n\n specific time delay when the destructive payload\n\n should activate.\n\n It also deletes Windows Event Logs : Application,\n\n Security, Setup, System.\n\n It is less focused on deleting documents. Only 35\n\n file extensions are targeted\n\n\n-----\n\n_Figure 3 – A list of file extensions targeted for destruction by new variant of_\n_KillDisk component_\n\n### As well as being able to delete system files to make the\n\n system unbootable – functionality typical for such\n\n destructive trojans – the KillDisk variant detected in\n\n the electricity distribution companies also appears to\n\n contain some additional functionality specifically\n\n intended to sabotage industrial systems.\n\n Once activated, this variant of the KillDisk component\n\n looks for and terminates two non-standard processes\n\n with the following names:\n\n komut.exe\n\n sec_service.exe\n\n We didn’t manage to find any information regarding\n\n the name of the first process (komut.exe).\n\n The second process name may belong to software\n\n called ASEM Ubiquity, a software platform that is often\n\n used in Industrial control systems (ICS), or to\n\n ELTIMA Serial to Ethernet Connector. In case the\n\n\n-----\n\n### process is found, the malware does not just terminate\n\n it, but also overwrites the executable file with random\n\n data.\n\n## Backdoored SSH server\n\n### In addition to the malware families already mentioned,\n\n we have discovered an interesting sample used by the\n\n BlackEnergy group. During our investigation of one of\n\n the compromised servers we found an application that,\n\n at first glance, appeared to be a legitimate SSH server\n\n called Dropbear SSH.\n\n In the order to run the SSH server, the attackers\n\n created a VBS file with the following content:\n\n Set WshShell = CreateObject(“WScript.Shell”)\n\n WshShell.CurrentDirectory =\n\n “C:\\WINDOWS\\TEMP\\Dropbear\\”\n\n WshShell.Run “dropbear.exe -r rsa -d dss -a -p 6789″, 0,\n\n false\n\n As is evident here, the SSH server will accept\n\n connections on port number 6789. By running SSH on\n\n the server in a compromised network, attackers can\n\n\n-----\n\n### come back to the network whenever they want.\n\n However, for some reason this was not enough for\n\n them. After detailed analysis we discovered that the\n\n binary of the SSH server actually contains a backdoor.\n\n_Figure 4 – Backdoored authentication function in SSH server_\n\n### As you can see in Figure 4, this version of Dropbear\n\n SSH will authenticate the user if the password\n\n passDs5Bu9Te7 was entered. The same situation\n\n applies to authentication by key pair – the server\n\n\n-----\n\n### contains a pre defined constant public key and it\n\n allows authentication only if a particular private key is\n\n used.\n\n_Figure 5 – The embedded RSA public key in SSH server_\n\n### ESET security solutions detect this threat as\n\n Win32/SSHBearDoor.A trojan.\n\n## Indicators of Compromise (IoC)\n\n### IP addresses of BlackEnergy C2-servers:\n\n 5.149.254.114\n\n 5.9.32.230\n\n 31.210.111.154\n\n 88.198.25.92\n\n 146.0.74.7\n\n 188.40.8.72\n\n XLS document with malicious macro SHA-1:\n\n AA67CA4FB712374F5301D1D2BAB0AC66107A4DF1\n\n BlackEnergy Lite dropper SHA-1:\n\n 4C424D5C8CFEDF8D2164B9F833F7C631F94C5A4C\n\n\n-----\n\n### BlackEnergy Big dropper SHA 1:\n\n 896FCACFF6310BBE5335677E99E4C3D370F73D96\n\n BlackEnergy drivers SHA-1:\n\n 069163E1FB606C6178E23066E0AC7B7F0E18506B\n\n 0B4BE96ADA3B54453BD37130087618EA90168D72\n\n 1A716BF5532C13FA0DC407D00ACDC4A457FA87CD\n\n 1A86F7EF10849DA7D36CA27D0C9B1D686768E177\n\n 1CBE4E22B034EE8EA8567E3F8EB9426B30D4AFFE\n\n 20901CC767055F29CA3B676550164A66F85E2A42\n\n 2C1260FD5CEAEF3B5CB11D702EDC4CDD1610C2ED\n\n 2D805BCA41AA0EB1FC7EC3BD944EFD7DBA686AE1\n\n 4BC2BBD1809C8B66EECD7C28AC319B948577DE7B\n\n 502BD7662A553397BBDCFA27B585D740A20C49FC\n\n 672F5F332A6303080D807200A7F258C8155C54AF\n\n 84248BC0AC1F2F42A41CFFFA70B21B347DDC70E9\n\n A427B264C1BD2712D1178912753BAC051A7A2F6C\n\n A9ACA6F541555619159640D3EBC570CDCDCE0A0D\n\n B05E577E002C510E7AB11B996A1CD8FE8FDADA0C\n\n BD87CF5B66E36506F1D6774FD40C2C92A196E278\n\n BE319672A87D0DD1F055AD1221B6FFD8C226A6E2\n\n C7E919622D6D8EA2491ED392A0F8457E4483EAE9\n\n CD07036416B3A344A34F4571CE6A1DF3CBB5783F\n\n D91E6BB091551E773B3933BE5985F91711D6AC3B\n\n\n-----\n\n### E1C2B28E6A35AEADB508C60A9D09AB7B1041AFB8\n\n E40F0D402FDCBA6DD7467C1366D040B02A44628C\n\n E5A2204F085C07250DA07D71CB4E48769328D7DC\n\n KillDisk-components SHA-1:\n\n 16F44FAC7E8BC94ECCD7AD9692E6665EF540EEC4\n\n 8AD6F88C5813C2B4CD7ABAB1D6C056D95D6AC569\n\n 6D6BA221DA5B1AE1E910BBEAA07BD44AFF26A7C0\n\n F3E41EB94C4D72A98CD743BBB02D248F510AD925\n\n VBS/Agent.AD trojan SHA-1:\n\n 72D0B326410E1D0705281FDE83CB7C33C67BC8CA\n\n Win32/SSHBearDoor.A trojan SHA-1:\n\n 166D71C63D0EB609C4F77499112965DB7D9A51BB\n\n Picture credits: ©flickr/tanozzo\n\n Author Anton Cherepanov, ESET\n\n**Original URL:**\n\nhttp://www.welivesecurity.com/2016/01/03/blackenergy-sshbeardoor-details-2015\nattacks-ukrainian-news-media-electric-industry/\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "d63ae2b7-445f-460d-965d-2676dacdb6de",
            "created_at": "2022-10-25T15:59:19.552139Z",
            "updated_at": "2022-10-25T15:59:19.552139Z",
            "deleted_at": null,
            "name": "APTnotes",
            "url": "https://github.com/aptnotes/data",
            "description": "APTnotes data",
            "reports": null
        }
    ],
    "references": [
        "https://app.box.com/s/uo31npu9sese34f1ppggmrug48x7rlqp"
    ],
    "report_names": [
        "ESET_BlackEnergy-by-the-SSHBearDoor(Jan-3-16)"
    ],
    "threat_actors": [
        {
            "id": "a66438a8-ebf6-4397-9ad5-ed07f93330aa",
            "created_at": "2022-10-25T16:47:55.919702Z",
            "updated_at": "2025-03-27T02:05:17.412024Z",
            "deleted_at": null,
            "main_name": "IRON VIKING",
            "aliases": [
                "ATK14 ",
                "BlackEnergy Group",
                "Blue Echidna ",
                "CTG-7263 ",
                "ELECTRUM ",
                "FROZENBARENTS ",
                "Hades/OlympicDestroyer ",
                "IRIDIUM ",
                "Qudedagh ",
                "Sandworm Team ",
                "Seashell Blizzard ",
                "TEMP.Noble ",
                "Telebots ",
                "Voodoo Bear ",
                "APT44 "
            ],
            "source_name": "Secureworks:IRON VIKING",
            "tools": [
                " BlackEnergy",
                " GCat",
                " GreyEnergy",
                " Industroyer",
                " KillDisk",
                " NotPetya",
                " PSCrypt",
                " TeleBot",
                " TeleDoor",
                " xData",
                "BadRabbit"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "b3e954e8-8bbb-46f3-84de-d6f12dc7e1a6",
            "created_at": "2022-10-25T15:50:23.339976Z",
            "updated_at": "2025-03-27T02:00:55.446795Z",
            "deleted_at": null,
            "main_name": "Sandworm Team",
            "aliases": [
                "Sandworm Team",
                "ELECTRUM",
                "Telebots",
                "IRON VIKING",
                "BlackEnergy (Group)",
                "Quedagh",
                "Voodoo Bear",
                "IRIDIUM",
                "Seashell Blizzard",
                "FROZENBARENTS",
                "APT44"
            ],
            "source_name": "MITRE:Sandworm Team",
            "tools": [
                "Bad Rabbit",
                "Mimikatz",
                "Exaramel for Linux",
                "Exaramel for Windows",
                "GreyEnergy",
                "PsExec",
                "Prestige",
                "P.A.S. Webshell",
                "VPNFilter",
                "Cyclops Blink",
                "SDelete",
                "AcidRain",
                "Industroyer",
                "Industroyer2",
                "BlackEnergy",
                "Cobalt Strike",
                "NotPetya",
                "KillDisk",
                "PoshC2",
                "Impacket",
                "Invoke-PSImage",
                "Olympic Destroyer"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1666716502,
    "ts_updated_at": 1743041440,
    "ts_creation_date": 1460348680,
    "ts_modification_date": 1460348680,
    "files": {
        "pdf": "https://archive.orkl.eu/8bcb1743d4a9ddbbc6daf063dca8c8107baed218.pdf",
        "text": "https://archive.orkl.eu/8bcb1743d4a9ddbbc6daf063dca8c8107baed218.txt",
        "img": "https://archive.orkl.eu/8bcb1743d4a9ddbbc6daf063dca8c8107baed218.jpg"
    }
}