{
    "id": "70e62819-2d45-45fb-86ef-79c156be089d",
    "created_at": "2023-01-12T14:59:10.777798Z",
    "updated_at": "2025-03-27T02:15:41.677798Z",
    "deleted_at": null,
    "sha1_hash": "4bbcb24e44e5fddc3bcf3f93fdcad3b8d1a5a1aa",
    "title": "2020-05-20 - Why On-Device Detection Matters- New Ramsay Trojan Targets Air-Gapped Networks",
    "authors": "",
    "file_creation_date": "2022-05-29T01:19:48Z",
    "file_modification_date": "2022-05-29T01:19:48Z",
    "file_size": 2602674,
    "plain_text": "# Why On-Device Detection Matters: New Ramsay Trojan Targets Air-Gapped Networks\n\n**[sentinelone.com/blog/why-on-device-detection-matters-new-ramsay-trojan-targets-air-gapped-networks/](https://www.sentinelone.com/blog/why-on-device-detection-matters-new-ramsay-trojan-targets-air-gapped-networks/)**\n\nMay 20, 2020\n\nThe Ramsay “framework” emerged in late 2019 and was disclosed thanks to a discovery by\nresearchers querying the VirusTotal public malware repository. As of April 2020, there\nappears to be two fully maintained branches of the toolkit. Although in-the-wild instances of\nthe Ramsay malware appear to be low at present, this may be due to the malware’s highlyspecialized objectives. The Ramsay samples discovered to date are heavily focused on both\npersistence and data exfiltration from air-gapped environments. This suggests the possibility\n[that the malware was developed for advanced targeted campaigns by a threat actor primarily](https://www.sentinelone.com/blog/what-are-advanced-targeted-attacks/)\ninterested in organizations trying to protect the most-sensitive of information. As is often the\ncase with specialized malware, there is also a real danger of it “leaking” or being repurposed\nto targets that were not in the original threat actors’ sights.\n\n\n-----\n\n## Ramsay Distribution and Persistence\n\nThe original version of Ramsay was distributed via maliciously-crafted Office documents.\n[These documents were distributed via email and were designed to exploit CVE-2017-0199 to](https://nvd.nist.gov/vuln/detail/CVE-2017-0199)\nfacilitate the installation of the malware. CVE-2017-0199 is a remote code execution flaw in\nMicrosoft Word. Specifically, it allows attackers to retrieve and launch code, including VBS &\n[PowerShell, upon launching of a specially-crafted RTF document. Several versions of these](https://www.sentinelone.com/blog/windows-powershell-malicious/)\nmalicious Word documents were discovered on VirusTotal with names such as\n“access_test.docx” and “Test.docx”, indicating that the threat actors may have been\nevaluating how well their malware fared against vendors’ static engines.\n\nLater versions of Ramsay (v2.a/2.b) were distributed as trojanized installers for well-known\napplications such as 7zip. These later versions also included an aggressive spreading\nmechanism that locates local and network adjacent PE files and infect them to allow for\nfurther spreading in targeted environments.\n\n[Version 2.b was also seen to be exploiting CVE-2017-11882. This vulnerability allows](https://nvd.nist.gov/vuln/detail/CVE-2017-11882)\nattackers to achieve arbitrary code execution as the current user in a MS Office 2016 and\nseveral earlier Office Service Pack versions. Both CVE-2017-0199 and CVE-20170-11882\n[are used for exploitation of client execution (MITRE T1203) purposes.](https://attack.mitre.org/techniques/T1203/)\n\nAlong with the spreading capabilities, Ramsay includes multiple techniques for maintaining\npersistence. These include:\n\nAppInitDLL Registry Key Entries\nScheduled Tasks\nDLL Hijacking\n\n\n-----\n\nWhile early versions used well-known persistence techniques such as loading custom DLLs\ninto other application processes’ address space and task scheduling, later versions leverage\nDLL Hijacking, specifically targeting msfte.dll and oci.dll dependencies of the Microsoft\nSearch Service and the Microsoft Distributed Transaction Coordinator service, respectively.\n\nProduct Tour Webinar\nJoin our experts and learn how SentinelOne works, how to recover quickly from attacks and\nhow to gain critical visibility to explain the forensics behind attacks.\n[Watch Now](https://assets.sentinelone.com/tour/sentinelone-product-)\n\n## Ramsay Observed Behavior\n\nRamsay’s main goal is data collection and exfiltration. Immediately upon infection, the trojan\nwill begin to locate specific document types, particularly MS Word and PDF format files, and\nstore them in a customized location. The items are also archived and encrypted via RC4,\nand subsequently compressed with an instance of WinRar installed by the trojan. It should\nbe noted that Ramsay will attempt to collect documents from both local and remote locations\nwhere possible. Ramsay also has some built-in “intelligence” to avoid the collection of\nduplicate/redundant files.\n\nThe analysis is ongoing with respect to the data exfiltration mechanism. Current intelligence\nindicates that an additional component will locate the collected “containers” of documents\nfrom infected hosts, identified by special file makers, When the containers are located, AND\na Ramsay control file is located on the affected network, data exfiltration can occur via this\nadditional component. Ramsay uses intra-network control files to operate, as opposed to a\ncentral command-and-control infrastructure.\n\nSpreading is handled via an additional component, dropped by the main installer. This\ncomponent will scan and locate accessible drives/locations (excluding A: and B: reserved\ndevices).\n\nGiven some level of code reuse, there may be correlation between Ramsay and the Retro\nBackdoor associated with Darkhotel. As with the data exfiltration piece, analysis of this\nrelationship is ongoing.\n\n## Does SentinelOne Protect Against Ramsay Malware?\n\nYes, it does. Organizations secured by the SentinelOne platform are fully protected against\nthe threat from Ramsay malware, as demonstrated in this video.\n\nEven when the network is disconnected such as with an air-gapped device, the SentinelOne\nagent will detect the malware locally on-device.\n\n\n-----\n\n## Conclusion\n\nThe Ramsay framework is a novel malware toolkit that appears to be under active\ndevelopment by a sophisticated threat actor. While current telemetry suggests this is a\nhighly-targeted attack focused on specific environments, history suggests that a malware\ntoolkit of this nature could soon ‘spread its wings’ and represent a threat to a much wider\naudience. Moreover, the discovery of this new toolkit targetting air-gapped machines\nhighlights the importance of having a behavioral, AI-driven security solution that can actively\ndetect and respond to threats on the local device without solely relying on cloud-connectivity,\nhuman analysts or static reputation engines.\n\nIf you are not already protected by SentinelOne and would like to learn more about how our\nindustry-leading platform can help defend your organization against Ramsay malware and all\nother threats, [contact us or request a](https://www.sentinelone.com/contact/) [free demo today.](https://www.sentinelone.com/request-demo/)\n\n## Sample Hashes for Ramsay Malware\n\nSHA1: f79da0d8bb1267f9906fad1111bd929a41b18c03\n\nSHA256: e60c79a783d44f065df7fd238949c7ee86bdb11c82ed929e72fc470e4c7dae97\n\nSHA1: 3849e01bff610d155a3153c897bb662f5527c04c\n\nSHA256: 22b2de8ec5162b23726e63ef9170d34f4f04190a16899d1e52f8782b27e62f24\n\nSHA1: bd97b31998e9d673661ea5697fe436efe026cba1\n\nSHA256: aceb4704e5ab471130e08f7a9493ae63d3963074e7586792e6125deb51e40976\n\n\n-----\n\nSHA1: e7987627200d542bb30d6f2386997f668b8a928c\nSHA256: 610f62dd352f88a77a9af56df7105e62e7f712fc315542fcac3678eb9bbcfcc6\n\nSHA1: ae722a90098d1c95829480e056ef8fd4a98eedd7\nSHA256: 823e21ffecc10c57a31f63d55d0b93d4b6db150a087a92b8d0e1cb5a38fb3a5f\n\nSHA1: 19bf019fc0bf44828378f008332430a080871274\nSHA256: 823e21ffecc10c57a31f63d55d0b93d4b6db150a087a92b8d0e1cb5a38fb3a5f\n\nSHA1: 5c482bb8623329d4764492ff78b4fbc673b2ef23\nSHA256: cc7ac31689a392a2396f4f67d3621e65378604b16a2420ffc0af1e4b969c6689\n\nSHA1: bd8d0143ec75ef4c369f341c2786facbd9f73256\nSHA256: dede24bf27fc34403c03661938f21d2a14bc50f11297d415f6e86f297c3c3504\n\nSHA1: 5a5738e2ec8af9f5400952be923e55a5780a8c55\nSHA256: 6f9cae7f18f0ee84e7b21995a597b834a7133277637b696ba5b8eea1d4ad7af1\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2020/2020-05-20 - Why On-Device Detection Matters- New Ramsay Trojan Targets Air-Gapped Networks.pdf"
    ],
    "report_names": [
        "2020-05-20 - Why On-Device Detection Matters- New Ramsay Trojan Targets Air-Gapped Networks.pdf"
    ],
    "threat_actors": [
        {
            "id": "1dadf04e-d725-426f-9f6c-08c5be7da159",
            "created_at": "2022-10-25T15:50:23.624538Z",
            "updated_at": "2025-03-27T02:00:55.508759Z",
            "deleted_at": null,
            "main_name": "Darkhotel",
            "aliases": [
                "Darkhotel",
                "DUBNIUM",
                "Zigzag Hail"
            ],
            "source_name": "MITRE:Darkhotel",
            "tools": null,
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "b13c19d6-247d-47ba-86ba-15a94accc179",
            "created_at": "2024-05-01T02:03:08.149923Z",
            "updated_at": "2025-03-27T02:05:17.422065Z",
            "deleted_at": null,
            "main_name": "TUNGSTEN BRIDGE",
            "aliases": [
                "DUBNIUM ",
                "DarkHotel ",
                "CTG-1948 "
            ],
            "source_name": "Secureworks:TUNGSTEN BRIDGE",
            "tools": [
                "Nemim"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "2b4eec94-7672-4bee-acb2-b857d0d26d12",
            "created_at": "2023-01-06T13:46:38.272109Z",
            "updated_at": "2025-03-27T02:00:02.790029Z",
            "deleted_at": null,
            "main_name": "DarkHotel",
            "aliases": [
                "DUBNIUM",
                "Fallout Team",
                "Luder",
                "Tapaoux",
                "Shadow Crane",
                "APT-C-06",
                "SIG25",
                "Karba",
                "Nemim",
                "Nemin",
                "G0012",
                "ATK52",
                "T-APT-02",
                "TUNGSTEN BRIDGE",
                "Zigzag Hail"
            ],
            "source_name": "MISPGALAXY:DarkHotel",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "c0cedde3-5a9b-430f-9b77-e6568307205e",
            "created_at": "2022-10-25T16:07:23.528994Z",
            "updated_at": "2025-03-27T02:02:09.847683Z",
            "deleted_at": null,
            "main_name": "DarkHotel",
            "aliases": [
                "APT-C-06",
                "ATK 52",
                "CTG-1948",
                "Dubnium",
                "Fallout Team",
                "Higaisa",
                "Luder",
                "Operation DarkHotel",
                "Operation Daybreak",
                "Operation Inexsmar",
                "Operation PowerFall",
                "Operation The Gh0st Remains the Same",
                "SIG25",
                "Shadow Crane",
                "T-APT-02",
                "Tungsten Bridge",
                "Zigzag Hail"
            ],
            "source_name": "ETDA:DarkHotel",
            "tools": [
                "Asruex",
                "DarkHotel",
                "DmaUp3.exe",
                "GreezeBackdoor",
                "Karba",
                "Nemain",
                "Nemim",
                "Ramsay",
                "Retro",
                "Tapaoux",
                "Trojan.Win32.Karba.e",
                "Virus.Win32.Pioneer.dx",
                "igfxext.exe",
                "msieckc.exe"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535550,
    "ts_updated_at": 1743041741,
    "ts_creation_date": 1653787188,
    "ts_modification_date": 1653787188,
    "files": {
        "pdf": "https://archive.orkl.eu/4bbcb24e44e5fddc3bcf3f93fdcad3b8d1a5a1aa.pdf",
        "text": "https://archive.orkl.eu/4bbcb24e44e5fddc3bcf3f93fdcad3b8d1a5a1aa.txt",
        "img": "https://archive.orkl.eu/4bbcb24e44e5fddc3bcf3f93fdcad3b8d1a5a1aa.jpg"
    }
}