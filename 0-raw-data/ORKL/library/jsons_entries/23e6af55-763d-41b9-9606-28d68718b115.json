{
    "id": "23e6af55-763d-41b9-9606-28d68718b115",
    "created_at": "2022-10-25T16:48:21.646506Z",
    "updated_at": "2025-03-27T02:13:48.702228Z",
    "deleted_at": null,
    "sha1_hash": "3bcbddd61cc7df02fad5bdc692e956bac590fe98",
    "title": "Operation Lotusblossom",
    "authors": "Palo Alto",
    "file_creation_date": "2015-06-15T14:33:36Z",
    "file_modification_date": "2015-06-15T14:33:56Z",
    "file_size": 4168507,
    "plain_text": "## OPERATION\n# LOTUSBLOSSOM\n\nR E P O R T B Y – ROBERT FALCONE, JOSH GRUNZWEIG,\nJEN MILLER-OSBORN, RYAN OLSON\n\n\n-----\n\n### TABLE OF CONTENTS\n\n###### Introduction  3\n\n Operation Details  3\n\n Vietnam  4\n\n Philippines  10\n\n Taiwan and Hong Kong  11\n\n Indonesia  12\n\n Elise Backdoor Analysis  12\n\n Variant A  13\n\n Variant B  17\n\n Variant C  20\n\n Previous Research  23\n\n Conclusion  24\n\n Appendix  25\n\n Elise Sample Details  25\n\n Elise Executable SHA256 values  33\n\n Elise Delivery Document SHA256 values  34\n\n Elise Command and Control Servers  35\n\n\n-----\n\n#### Introduction\n\nOperation Lotus Blossom describes a persistent cyber espionage campaign against\ngovernment and military organizations in Southeast Asia, stretching back over three\nyears. Nations we have identified as targeted in this campaign include Hong Kong,\nTaiwan, Vietnam, the Philippines and Indonesia. The Lotus Blossom group deploys a\nbackdoor Trojan, named Elise, after the sports car made by Group Lotus PLC of the\nUnited Kingdom.\n\nThe group relies on spear phishing attacks to infect its users, often using a malicious\noffice document and decoy file containing content relevant to the target’s occupation or\ninterests. The spear phishing attachment typically includes exploit code for a well-known\nMicrosoft[®] Office[®] vulnerability, CVE-2012-0158, which is used to install the Trojan\non the system and then display the decoy file, tricking the user into thinking the file\nopened correctly. Example decoy files include:\n\n   - A spreadsheet listing high-level officers in the Philippine Navy, along with their\ndates of birth and mobile phone numbers.\n\n   - The operational humanitarian and disaster response (HADR) plan for the\nArmed Forces of the Philippines, stamped “Secret.”\n\n   - An invitation to the screening of a film at the Norwegian embassy.\n\nWhile we have not identified specific individuals responsible for these attacks, the\nevidence suggests a nation state with a strong interest in Southeast Asia. Elise\nis a custom backdoor Trojan, not readily available online. The tool appears to be\nused exclusively by Lotus Blossom and was likely developed specifically for their\noperations. The targets attacked by this group are almost exclusively military and\ngovernment organizations, whose data is most valuable to other nation states, rather\nthan criminal actors. The fact that this campaign has been ongoing for over three\nyears indicates the individuals behind the attack are well-resourced.\n\nUsing the Palo Alto Networks[®] AutoFocus[™] platform, which enables analysts to\ncorrelate the results of the hundreds of millions of reports generated by the WildFire[™]\nservice, Unit 42 has linked over 50 individual attacks to this campaign.\n\nThe Operational Details section of this report provides details on specific attacks\nagainst the targeted governments. The Elise Backdoor Analysis section contains\ndescriptions of how the three different variants of Elise operate and how they\nchanged over time. Domain names and IP addresses used for command and control,\nas well as hashes of the files used in the attacks are included in the appendix.\n\n#### Operation Details\n\nOperation Lotus Blossom repeatedly targeted several Southeast Asian countries’\nmilitaries and government agencies, beginning in 2012 and continuing through 2015. The\nbulk of the activity discussed in this paper involves heavy targeting against both Vietnam\nand the Philippines during 2013 and 2014.\n\n\n-----\n\nAll of the attacks use the custom backdoor\nTrojan named Elise, which gives the Lotus\nBlossom group their initial foothold in a\nnetwork. From there, they can install additional\n\nVietnam\n\ntools, move laterally, and exfiltrate data from\nthe network. Elise is described in more detail\nlater in this report.\n\nThe operation relies heavily on spear\nphishing as the initial attack vector, with\nenticing subject lines and legitimate-looking\ndecoy documents meant to trick users into\nbelieving they are opening a legitimate file,\nas opposed to malware. A popular theme for\n\nHong Kong\n\nthe decoy documents was personnel rosters, & Taiwan\nlargely claiming to be for specific military or\ngovernment offices. Another theme was the\nuse of attractive pictures of Asian women that\nwere sourced from the Internet. Some of the\ninformation contained in the decoys could be Indonesia Philippines\nfound on the Internet; however, it is worth\nnoting none of the military or government\nthemed decoys could be found.\n\nIn particular, the decoys used against the\nPhilippines were exclusively military and\n\nFIGURE 1 + Elise backdoor samples and C2 infrastructure\n\ngovernment themed, with the bulk purporting\n\nin distinct but overlapping groups.\n\nto be related to the Navy. As we were unable\nto find any of the decoys online, and they\npurport to contain sensitive information, we have not included images of them, in case\nthe information is legitimate. One document is even stamped “Secret.”\n\nWhile all of the Lotus Blossom attacks appear to be the work of a single group, the\ninfrastructure used to target each nation is largely separate (Figure 1). Each Trojan binary\nin this diagram is connected to command and control (C2) IP addresses and domains\nthat are defined in the Trojan’s configuration file. Additionally, the domains are connected\nto email addresses used to register them, as well as IP addresses they resolve to at the\ntime of the attack. These links create a visual map of the attacks, which shows that, while\nthe infrastructure is not identical in each attack, they are all connected. In the following\nsections, we will take a closer look at the attacks on each nation.\n\n##### Vietnam\n\nThe Lotus Blossom campaign against the Vietnamese government was the most\npersistent and consisted of 11 waves of spear phishing, primarily during November\n2014. There were a total of eight droppers — one Microsoft Excel[®] document and five\nMicrosoft Word[®] documents. All included a decoy document intended to trick users\ninto believing they had opened a legitimate file rather than malware, and the content\nof each was different.\n\n\nVietnam\n\nHong Kong\n& Taiwan\n\nIndonesia Philippines\n\n\n-----\n\nThe attacks on Vietnam break into two distinct groups. All but three samples used\noverlapping C2 infrastructure (Figure 2), including two domains registered by\n“2759931587@qq.com,” which was also used registered C2 domains used in attacks\nagainst other Southeast Asian countries. This group of attacks used the following\ncampaign codes to identify their infections, many of which include the string “Alice,”\nwhich may have a significance we have not yet identified.\n\n   - Alice_erpas\n\n   - Alice_rosey\n\n   - Alice_15A\n\n   - Alice_Spider\n\n   - Alice_vishipel\n\n   - jessica-cpt-app\n\n   - oyf\n\n  - ooo\n\nFIGURE 2 + Elise samples and infrastructure used to target the Vietnamese government.\n\n\n-----\n\nThe second group of attacks (Figure 3) used a different registrant not seen elsewhere in\nthis activity, but overlap with targeting, campaign code structure, and one C2 IP address.\nWhile the other domains maintained the information they were originally registered\nwith, one domain used here was registered by ‘paulzz@yeah.net’ and then updated to\n‘studywindows123@outlook.com’. The initial registrant also registered other domains\ndetailed in this paper, targeting other Southeast Asian countries prior to their updating,\nindicating this may be a reseller favored by particular APT group(s). It could also be a\nsimple matter of actor preference, but we cannot say for sure one way or the other. The\nother domain used a registrar that does not show any registration information. The three\ncampaign codes used with these samples are below.\n\n  - QY030610\n\n  - KITY01232\n\n  - KITY090901\n\nFIGURE 3 + Diagram of second group of Vietnam attacks.\n\nMost of the attachments used in this campaign had a technical theme, shown in figures two\nthrough four. Additionally, all were written in Vietnamese. We are not including an image of\none sample, as it claims to be a certification test for a particular type of VSAT terminals. It is\nunknown how the actors obtained a test for this course, assuming the questions are legitimate.\n\nFIGURE 4 + Instructions on how to install and use LogFusion, a legitimate tool used to parse log files.\n\n\n-----\n\nFIGURE 5 + The agenda for Vietnam’s Ministry of Information and Communication\nworkshop with Vibrand, which was held on 4 December 2014. The purpose of the\nworkshop was promoting the development of products and IT services in Vietnam.\n\nFIGURE 6 + Excel spreadsheet titled “VPTW Transfer Network Phase 2” and lists a\nnumber of provinces in Vietnam as well as Taiyuan in China.\n\n\n-----\n\nThe final four sample decoy documents had very different themes. One was an\ninvitation to an event at the Norwegian Embassy in Vietnam commemorating the\nanniversary of the Kon-Tiki voyage (Figure 7). Of note, the date of the invitation is\nincorrect — the actual event took place 11 and 12 December 2014. The requested\nemail address accepting RSVPs also seems just slightly suspicious, and they helpfully\ninstructed the recipients to forward the invitation, if they were unable to attend. Two\nof the decoys contained one or more images of attractive Asian women taken from\nthe Internet, one of which (shown in Figure 8) was used multiple times. The final\ndecoy contained a Merry Christmas image with broken English text.\n\nFIGURE 7 +\nFake invitation\nto an event\ncommemorating\nthe Kon-Tiki\nvoyage.\n\n\nFIGURE 8 + Photo of Hoàng Thùy Linh,\na Vietnamese actress and singer.\n\n\nFIGURE 9 + A Merry Christmas image\nwith broken English text.\n\n\n-----\n\nThe second group of attacks also used decoy documents written in Vietnamese. One\ndocument purported to be a contact roster and contains the names and Vietnamese\nwebmail email addresses for multiple high-level Vietnamese officials. The first page of\nthe second decoy is shown below (Figure 10) and claims to be an IT upgrade plan for\n2015 for the Vietnamese government. The final sample also appears to be related to\nan IT upgrade plan, with implementation dates and responsible individuals (Figure 11.)\n\nFIGURE 10 + Claims to be an IT upgrade plan for 2015 for the Vietnamese government.\n\nFIGURE 11 + Also appears to be related to an IT upgrade plan, with implementation dates and\nresponsible individuals.\n\n\n-----\n\n##### Philippines\n\nThe Lotus Blossom operation has\ntargeted the Philippine government,\nwith a particular focus on the\nmilitary, since at least 2013. We\nidentified six unique Elise droppers,\neach with its own decoy document\nand content. These samples all\nhad overlapping command and\ncontrol infrastructure (Figure 12).\nAll six decoy documents were\nrelated to the Philippine military\nor government, primarily claiming\nto contain contact information for\nhigh-level officers and officials.\nWe are not including images, as\nit is possible the information is\nlegitimate, but the subject lines\nwith brief descriptions are included\nin Table 1 below.\nFIGURE 12 +\nConnections between\nElise samples and C2\nservers used in attacks\non the Philippines.\n\nDecoy Name Decoy Description\n\nDFA GAD Directory Claims to be a directory of personnel in the Philippine Department of Foreign\nAffairs Gender and Development, including private emails and cellphones.\n\nHADR PLAN 29 May 14 Claims to be the operational humanitarian and disaster response (HADR) plan for\nthe Armed Forces of the Philippines and is stamped “Secret.”\n\nC,1AD NR 03-0226-313-14 Claims to document a problem logging into an account for a specific real-time\naircraft tracking system and appears to be a Philippine Air Force document.\n\nRQST MOUTPIECE Claims to be a requisition form for a mouthpiece for a specific hailer for a specific\nLOUD HAILER unit.\n\nPN KEYPOSITION with Claims to be a roster of high-level officers at the Philippine Naval Headquarters\nCELL Nrs and is dated 23 June 2014. It has birth dates and cellphone number as well as\ncurrent job roles.\n\nCellphone Number Claims to be a roster of high-level officers at the Philippine Naval Headquarters\nand is dated February 2015. It contains job roles as well as cellphone numbers.\n\nTable 1 + Names and descriptions of decoy documents included in attacks on the Philippine government and military.\n\n\n-----\n\nIn contrast to the Vietnamese targeting, this activity involves a mix of actor registered\nand dynamic DNS (DDNS) domains use for C2. However, the actor-registered domain\nalso used the same initial registrant, ‘paulzz@yeah.net,’ as the final two Vietnamese\nsamples discussed above, and most campaign codes also appear to end with a date.\nAlso of note, all but two of these samples used campaign codes that started with\n‘340‘. The text within three of the campaign codes refers to the decoy contents. The\ncampaign codes we saw with the Philippines’ activity are below.\n\n  - 340_typhoon\n\n  - 340-0226\n\n   - 340-dfa-520\n\n  - 340-0528\n\n  - phone\n\n  - key0730\n\n##### Taiwan and Hong Kong\n\nWe uncovered three droppers that targeted Taiwan and one\nthat targeted Hong Kong. One of these claimed to be a\ncurrent staff contact list, but when opened, did not contain\nany information. As this is the only roster-themed decoy\nthat did not contain any information, it may indicate this\nwas a mistake on the threat actor’s part. We were unable to\nrecover decoy documents for the other two.\n\nThe sample targeting Hong Kong contains earthquake\nsafety information in long form Chinese, copied from\nthe Internet and widely circulated in multiple languages,\nsince at least 2009. It has its own entry on Snopes.com\nevaluating the accuracy of the information [i]. This sample is\nalso an outlier, in that it targeted a science and technology\nuniversity, in contrast to most of the other targeting that had\na government or military focus.\n\nThis activity shows the clearest striation (Figure 13), with the\ncluster on the left using the first two campaign codes below.\n\n\n\n- 310-pyq\n\n- mm-0807\n\n- cyd-zc\n\n\nFIGURE 13 + Connections between Elise samples and\nC2 servers used in attacks on Taiwan and Hong Kong.\n\n\nIt is possible this represents two sub-groups targeting Taiwan and Hong Kong with\nthe same malware over the same period of time. Interestingly, the cluster in the\nupper left uses some infrastructure used in the Vietnamese activity, as well as a\nregistrant seen in the Philippines’ activity.\n\n\n-----\n\n##### Indonesia\n\nWe identified one Elise dropper carrying a decoy\ndocument written in Indonesian that contains\ninformation about health foods to avoid the flu, including\na picture of a sweet potato. It appears to have been\ncopied directly from the Internet. The campaign code\nused in this attack was “36-SC-0115,” as well as the\nfollowing C2 servers.\n\n   - 122.10.89.84\n\n  - beckhammer.xicp.net\n\nThe campaign code and C2s are shown below, and\nthe C2 matches up with one of the Philippine-targeted\nsamples in the previously discussed activity. In addition,\nthe campaign code format and numbers at the end of\nthe campaign code appear to be a date, which is also\nsimilar to the Philippines’ activity.\n\n#### Elise Backdoor Analysis\n\n\nFIGURE 14 + Decoy document written in Indonesian,\nwhich describes foods that help fend off the flu.\n\n\nOver the course of our research, Unit 42 has identified over 50 samples belonging to\nthe Elise malware family. Through analysis of these files, we have grouped them into\nthree distinct variants. Compile timestamps for these samples ranged from June 2012 to\nMarch 2015. The naming of the three Elise malware variants coincides with their original\ncompile timestamps, starting with the oldest. Please note that these variant labels may\nnot coincide with naming conventions created by the antivirus industry.\n\nWhile each variant uses distinct mechanisms for infecting the system and remaining\npersistent between reboots, all three variants share the following common attributes:\n\n   - An encrypted binary configuration data structure containing a list of C2\nservers to contact.\n\n   - A campaign identifier, such as ‘jessica-cpt-app’ or ‘370my0216’, which\nidentifies the specific malware reporting to the C2 server.\n\n   - C2 communications using a custom format delivered over HTTP or HTTPS.\n\n   - Performs basic network reconnaissance upon installation and reports findings\nto C2 server.\n\nEach variant of Elise contains the functionality to perform the following tasks:\n\n   - Execute commands, DLLs, or executables\n\n   - Write Files\n\n   - Read Files\n\n   - Update Configuration\n\n   - Upload Configuration Data\n\n\n-----\n\n##### Variant A\n\nThe first variant of Elise identified by Unit 42 has a compile date set in mid-2012.\nThis particular variant has a configuration size of 1480 and the ability to install itself\nas either a service or executable. Variant ‘A’ is delivered via a dropper executable file,\nwhich differs from later variants that are typically deployed with a malicious Microsoft\nOffice document.\n\nWhen executed, the malware will configure itself for deletion upon reboot, using the\nMoveFileExA function, as seen below.\n\nMoveFileExA(self, 0, MOVEFILE_DELAY_UNTIL_REBOOT);\n\nReaders may recall seeing this technique used by the Microsoft Excel shellcode\nidentified in the Vietnam campaign. The malware proceeds to extract and decrypt an\nembedded DLL to the following location.\n\n  - %APPDATA%\\Microsoft\\Network\\mssrt32.dll\n\nThe following algorithm is used to encrypt/decrypt the embedded DLL:\n\n\nvoid decrypt_string(char *encrypted, int size)\n{\nint i;\nif ( encrypted )\n{\nfor ( i = size - 1; i > 0; --i )\nencrypted[i] ^= encrypted[i - 1];\n*encrypted ^= 0x15;\n}\n}\n\n\nPrior to writing this DLL to disk, the malware will write the encrypted configuration to\nthis DLL. The following Python code may be used to decrypt this configuration:\n\n\nfrom ctypes import *\nfrom struct import *\nimport sys\n\nfh = open(sys.argv[1], ‘rb’)\nfd = fh.read()\nfh.close()\n\ncdll.msvcrt.srand(2014)\nout = “”\nfor x in fd:\nout += chr(ord(x) ^ (cdll.msvcrt.rand() % 128))\n\nprint repr(out)\n\n\n-----\n\nThe malware proceeds to configure the mssrt32.dll DLL as a service. This service\nis configured with properties specified in the malware’s configuration. The following\nexample was identified in one of the samples analyzed.\n\nService Name MSCM\n\nDisplay Name Microsoft Security Compliance Manager\n\nDescription The service provides centralized security baseline management features, a\nbaseline portfolio, customization capabilities, and security baseline export\nflexibility to accelerate your organization¡¯s ability to efficiently manage\nthe security and compliance process for the most widely used Microsoft\ntechnologies.\n\nImage Path %SystemRoot%\\System32\\svchost.exe -k MSCM\n\nService DLL %APPDATA%\\Microsoft\\Network\\mssrt32.dll\n\nService Main ESEntry\n\nThis service is then manually started using a call to the StartServiceA function.\nShould the installation of this newly created service fail, the malware will instead\nwrite an executable to the following location:\n\n  - %APPDATA%\\Microsoft\\Network\\svchost.exe\n\nThe name of this executable is specified within the malware’s configuration data.\nThis file is embedded and dropped in the same manner the mssrt32.dll file was\npreviously. Persistence for this executable is set via the following registry key:\n\n  - HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\svchost :\n%APPDATA%\\Microsoft\\Network\\svchost.exe\n\nFinally, this executable is run via a call to the ShellExecuteW function.\n\nThis dropped DLL or executable contains the actual Elise malware. When run, it will\nbegin by deleting the following file should it exist:\n\n - %TEMP%\\000ELISEA350.TMP\n\nThis file will be used going forward to store any log data generated by Elise. The\nmalware writes its encrypted configuration to one of the following locations:\n\n - %APPDATA%\\Microsoft\\Network\\6B5A4606.CAB\n\n - %APPDATA%\\Microsoft\\Network\\6B5A4607.CAB\n\n\n-----\n\nThe following script can decrypt and parse the CAB file:\n\n\n-----\n\nThe malware proceeds to enter in a loop, where it will attempt to communicate with the specified URLs via\nHTTP or HTTPS. It initially sends the following GET request to the C2 servers specified in its configuration:\n\n\nGET /<param1>/page_<param2>.html HTTP/1.1\nAccept: */*\nUser-Agent: Mozilla/4.0 (compatible; MSIE 8.0; Win32)\nHost: <C2 Server>\nConnection: Keep-Alive\nCache-Control: no-cache\nPragma: no-cache\n\n\nIn the request above, the <param1> parameter is determined using the last four octets of the victim’s MAC\naddress. For example, if the victim’s MAC address was 00-11-22-33-44-55-66, this parameter would become\n‘2233445566’. The <param2> parameter is randomly generated using the current time as a seed. This results in\na unique request being made every time.\n\nWhen an initial communication is made to the remote server, the malware will execute the following\ncommands to conduct basic network reconnaissance:\n\n  - net user\n\n  - ipconfig /all\n\n  - net start\n\n  - systeminfo\n\nElise uses a series of cookie values in order to exfiltrate data, as seen below.\n\nFIGURE 15 + Elise Variant A POST Request.\n\n\n-----\n\nData contained within these cookies is Base64 encoded. Once decoded and joined,\nthe data has the following structure.\n\nFIGURE 16 + Elise Variant A Data Encoding.\n\n##### Variant B\n\nThe second variant (B) of Elise has compile timestamps dating back to July 2012.\nVariant B has a configuration data structure size of 324 bytes. It is often delivered via\na file exploiting a client-side vulnerability, such as CVE-2012-0158.\n\nWhen originally installed on a victim machine, the client-side exploit shellcode will\ndrop two files — an executable file and a DLL. The executable is then run in a newly\nspawned process. This executable file loads the second exported function of the\nDLL via the function’s ordinal value. This exported function is commonly called either\n‘CsOptionsHandle’ or ‘ESHandle’.\n\nWhen this function is called, this Elise variant will begin by decrypting its 324-byte\nconfiguration structure. The following Python code may be used to decrypt and parse\nthis configuration:\n\n\n-----\n\nprint Command and Control  : %s % c1\nprint “Command and Control  : %s” % c2\nprint “Command and Control  : %s” % c3\nprint “Command and Control  : %s” % c4\nprint “Command and Control  : %s” % c5\nprint “Unknown Bool Value 2  : %s” % unknown_bool2\nprint “Unknown Unidoce String : %s” % unknown _string.replace(“\\\nx00”,’’)\n\n\nfh = open(sys.argv[1], ‘rb’)\ndata = fh.read()\nfh.close()\n\nparse_config(decrypt(data))\n\n\nAs we can see, this variant of Elise uses the same encryption/decryption routine\nfor its configuration data as variant A. The malware proceeds to create one of the\nfollowing files that will be used to store this configuration data:\n\n - %APPDATA%\\Microsoft\\IMJP8_1\\8S3N0PW7.dat\n\n - %APPDATA%\\\\Microsoft\\IMJP8_1\\26TXNK4F.dat\n\nOne of the more interesting features of this variant is its ability to detect either a\nVMware[®] or VirtualPC virtual environment, as we see below.\n\nFIGURE 17 + Elise Variant B virtual environment check.\n\nShould the malware detect it is running within either of these environments, it will\nnot perform any malicious activity going forward. Otherwise, it proceeds to configure\npersistence across reboots by setting the following registry key:\n\n  - HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\imejp : [self]\n\n\n-----\n\nWhen initially run, Elise variant B will also execute the following commands on the\nvictim machine:\n\n  - ipconfig /all\n\n  - net start\n\n  - dir C:\\progra~1\n\n  - systeminfo\n\nThese command strings are obfuscated within the malware, using the following\nalgorithm:\n\n\nchar* decrypt_string(char *encrypted, int size)\n{\nint i;\nchar *result;\n\nfor ( i = 0; i < size; ++i )\n{\nresult = &encrypted[i];\n*result ^= 0x1Bu;\n}\nreturn result;\n}\n\n\nExfiltration for variant B uses the same technique used in variant ‘A’. Base64-encoded\ncookie values are used to exfiltrate data, as seen below.\n\nThe structure of this base64-decoded data remains the same as well. The following\nstructure is used in variant ‘B’.\n\nFIGURE 18 + Elise Variant B POST Request\n\n\n-----\n\nFIGURE 19 + Elise Variant B Data Encoding\n\n##### Variant C\n\nThe third variant of Elise has its earliest compile timestamp in mid-2013 and has been\nused in attacks periodically since that time. This variant has been the most prevalent\noverall, accounting for roughly 75 percent of all samples identified by Unit 42. The\nmost recent sample of variant C was compiled in late March of 2015. Additionally,\nvariant C uses a 336-byte configuration structure.\n\nSimilar to variant B, variant C is often delivered via a file exploiting a client-side\nvulnerability, such as CVE-2012-0158. This particular variant is delivered as a single\nDLL with two exported functions — ‘Setting’ and ‘Update’\n\nWhen the ‘Setting’ export is called, the malware will copy itself to the following\nlocation:\n\n  - %APPDATA%\\Microsoft\\Network\\rasphone.dll\n\nThis new file is then called via the following command:\n\n  - Rundll32.exe %APPDATA%\\Microsoft\\Network\\rasphone.dll,Update\n\nWhen the ‘Update’ export is called on rasphone.dll, the malware will begin by checking\nif a debugger is attached via a call to IsDebuggerPresent(). In the event it is not\ndetected, the malware will then check to ensure the DLL has been loaded by Rundll32.\nexe by comparing the current filename against ‘dll32’. rasphone.dll uses a simple string\nencryption routing. The following code can decrypt encountered strings:\n\n\nvoid decrypt_string(char *encrypted, int size)\n{\nint i;\nif ( encrypted )\n{\nfor ( i = size - 1; i > 0; --i )\nencrypted[i] ^= encrypted[i - 1];\n*encrypted ^= 0xA0;\n}\n}\n\n\n-----\n\nThe malware continues to identify the location of iexplore.exe (%PROGRAM FILES%\\\nInternet Explorer\\iexplore.exe) and spawn a new instance of this process. The malware\nwill proceed to inject itself into iexplore.exe. Finally, the malware will decrypt an\nembedded DLL located in its resource section (‘XDATA’) and write this DLL to a new\nsection of memory in iexplore.exe. A configuration blob of 336 bytes is subsequently\nwritten to this DLL, and the DLL is loaded into iexplore.exe via a call to LoadLibraryA.\n\nThe injected DLL (hereafter referred to as xdata) begins by spawning a new\nthread where all further actions will be taken. The malware writes its encrypted\nconfiguration to the following location:\n\n - %APPDATA%\\Microsoft\\Network\\6B5A4606.CAB\n\nThe following script can be used to decrypt this CAB file.\n\n\n-----\n\nAdditionally, this CAB file is “time stomped” to a Create/Modify time of Sunday,\nNovember 21, 2010, 10:29:33 UTC. This malware also writes to a log file located at\nthe following path.\n\n - %TEMP%\\00EL225AF.TMP\n\nData in this file is not obfuscated or encrypted in any way. The malware proceeds\nto enter in a loop, where it will attempt to communicate with the specified URLs\nvia either HTTP or HTTPS. The following has been identified about the structure of\nthe binary data submitted via POST requests. This structure is consistent with all\nprevious Elise variants discussed.\n\nFIGURE 20 + Elise Variant C Data Encoding.\n\nWhen an initial communication is made to the remote server, the malware will\nexecute the following commands to conduct basic network reconnaissance:\n\n  - net user\n\n  - ipconfig /all\n\n  - net start\n\n  - systeminfo\n\nThis data is exfiltrated using a POST request, as seen below.\n\nFIGURE 21 + Elise Variant C POST Request.\n\nIn the above example, the ‘2320’ value in the URI is generated using the victim’s\nMAC address. The ‘00320511’ value in the URI is generated using the current time.\nThis allows each request to be unique and also identify the victim machine.\n\n\n-----\n\n#### Previous Research\n\nMultiple research groups have mentioned the Elise backdoor in publicly available\nreports. This section highlights some of those to help readers connect this campaign\nto previously known attacks.\n\nIn 2013, Xecure Labs and Academia Sinica published a joint paper, and they delivered\na presentation at BlackHat in which they identified Elise as part of a larger group of\ntools they referred to as the “LStudio,” “ST Group” and “APT0LSTU.” The research\nteam noted that Elise and other related tools had been used primarily in attacks on\nTaiwan (Figure 22), but also against the United States, Canada and other nations.\n\nFIGURE 22 + Slide 30 from BlackHat presentation showing Elise target.\n\nTrend Micro refers to Elise as BKDR_ESILE, making a slight modification to the\nauthor’s chosen name. Trend Micro first reported on Elise in their 2013 2H targeted\nAttack Trends report[ ii]. Since then, they have referenced that paper in multiple blogs\nand reports[ iii iv v]. This research indicates that the majority of attacks using Elise also\ntargeted government organizations in the Asia Pacific region.\n\nFireEye refers to Elise as the “Page” malware, because early versions of the Trojan\nuse the word “page” in their Command and Control URLs. FireEye first noted an\nElise attack in September 2012, which involved a targeted spear phishing attack\nagainst the aviation defense industry[ vi]. FireEye later noted Elise was delivered in an\nattack using a lure related to the crash of Malaysian Airlines flight 370 [vii].\n\n\n-----\n\n#### Conclusion\n\nOperation Lotus Blossom represents a long-term campaign targeting government\nand military organizations in several nations of Southeast Asia conducted by a\npersistent attack group. We traced the earliest of these attacks to 2012, and the most\nrecent occurred during the course of writing this paper. In one case, the targeted\norganization received 20 separate email attacks carrying Elise exploit files over the\ncourse of eight weeks.\n\nWhile we cannot attribute these attacks to those of a specific nation state, the\npattern indicates a highly persistent adversary with the ability to develop custom\ntools, and maintain command and control infrastructure, over a long period of time.\nThis evidence is consistent with a nation state adversary with a strong interest in the\nmilitaries of Southeast Asian nations.\n\nLotus Blossom may deploy additional tools beyond the Elise backdoor detailed in this\nreport, after the group has achieved a foothold in the network. Related tools used by\nthe group include those known as “LStudio,” and Evora.\n\nUnit 42 initially identified the attacks described in this report using Palo Alto Networks\nAutoFocus platform, which quickly enables analysts to find connections between\nmalware samples analyzed by our WildFire system. We combined this data with open\nsource intelligence to gather additional samples, which broadened the scope of our\nanalysis. We have tagged all of these samples, and the infrastructure used in this\ncampaign, within AutoFocus, using the tags Elise and LotusBlossom respectively.\n\nWildFire correctly identifies Elise executables, as well as the exploit files used in\nLotus Blossom attacks, as malicious. We have released IPS signature 14358 in\nresponse, which detects command and control traffic generated by Elise.\n\n\n-----\n\n#### Appendix\n\n##### Elise Sample Details\n\n\n-----\n\nSHA256 8c2cd914de7c125e49019f3826918511150ee4fff8a923da350a99c102b36455\n\n\n-----\n\nSHA256 866c698073e4deb66dd83c1ec9567ec03eca9f03775deadb81cc59fdb6cfd446\n\n\n-----\n\nSHA256 c19d3242d43c71f03f5873231444c12a6a11892dd7f0142ff10479f1f718382d\n\n\n-----\n\nSHA256 8f7c74a9e1d04ff116e785f3234f80119d68ae0334fb6a5498f6d40eee189cf7\n\n\n-----\n\nSHA256 233af642b3e22613551e087a7cefcf2a530752da6613efc52da7cb957cb8f0f3\n\n\n-----\n\nSHA256 0adbf0f6a5c21054e569b2ef68c8c6ae7834a0700672c1f3ec6e50daf49a3a94\n\n\n-----\n\nSHA256 8e180a9d7f233c189519bbfa2b649ca410c4869457e0cf8396beb82ffbffd05c\n\n\n-----\n\n##### Elise Executable SHA256 values\n\n0201aaa8eda6dedc6c90381e225620cd33fb7b244f76bf229c3dd43feb9bdeaf\n\n1333a300b03fb2d7bf028f4dee3d9b1f9c97267266faec9e02064862fbb6acb4\n\n135e37122c23f26fed98b3bc884171c91c370250a73c6660b20416497b66a750\n\n24bb8e48f37cbd71b2195cff4f52ec304a2ed9d60c28d2afd785e6f32639325f\n\n2c2eb2eaadf9253a78265ac4655a6ec5935aa2673ff5e4fe3bb6753803c7fe59\n\n2c512b50f8aa0881120d844b0bbbf7baa33465083fdc85755d51d1b5721bc057\n\n2d43632953b511e1f1c7698de3c21b2ba7c27b75bb6079f51dcf9376e05e42b7\n\n376c3ea59411380ab5146b3bc39ee79cf7f78b08dd712ef1cc5327bda5a2e46b\n\n39dd2381bcd0f47dadf23399254bf1b51a837179e5634328afafe07510f5888a\n\n3eb115f4eb62c4404be1a318afa3837bdba8fd66938efe15664741d942a85add\n\n49bf19bd2381f5c78eb2d00a62e1b377620705dba0fa843fb8c8d26d92ec52e4\n\n4de470147d90efbb440aa4420a5832b4f22f9f6128183568fe604df6427cc06b\n\n4ff70adad080095421f34873e491c9da2e798f8db96a984f87efb9889d246fcb\n\n5960d8f8b26edb453926efbd424332eabc0e1a74e25dbc1e9a570cc5920c8830\n\n64ffe128c61289bec90057c7bf3ff869c329ffcb1afa4c4cd0daed1effabf105\n\n712c488950f27e98bc4ebe5b63e5775498236a179cb4576bf021f8e6e6de0df4\n\n7b2d470b9c6159c97cef2634493be0e4f2994f43501605a14d4c5a7efdeac3ba\n\n7e386ff64be78af18f8a79d01cb75b0438cbcee4647e0a928100bd52ee56db76\n\n840d18698ff0b114ee587f57231001d046fbd1eb22603e0f951cbb8c290804ed\n\n866c698073e4deb66dd83c1ec9567ec03eca9f03775deadb81cc59fdb6cfd446\n\n899730962e10546c9d43a9ffa79d900fd37c0d17f95aa537b67d31aa737447b5\n\n8b4446cfaee549072c5da2468af7b9fec711f2d28851a3e8076fcfb53393a415\n\n8c2cd914de7c125e49019f3826918511150ee4fff8a923da350a99c102b36455\n\n8ce0b29202f3df23ce583040e2ffe79af78e0bb375ce65ec37a6ffe7d49b5bb5\n\n8f7c74a9e1d04ff116e785f3234f80119d68ae0334fb6a5498f6d40eee189cf7\n\n90296f0ecacc017bcf289297f5743660dd18bbc2842e631e9be4b2dc51732412\n\n96356db43d7e9a5c3c4e3f9f7ee9a3dba14ad1c7db7367b7f6d664db4f0ef5d7\n\n97d6699e449ddad97cc33e380a4873a7ceb0e8f0f50b5c8f72e6a4ff3dd1009f\n\n9e5c286fcc47c8346267574ea805cde24b04915f5372f03923c0d6a13290e0ea\n\na462085549f9a1fdeff81ea8190a1f89351a83cf8f6d01ecb5f238541785d4b3\n\na8e0ab6b19400eccd3c9aceb183fe7626d5bde7bdf9b8ec8825aa17cc3a213a3\n\nb5a1f7e9d0d6d3bec17674610a3b26991083e1e3cb81729714b69c18038a902f\n\nbd78e106f208cbb8ea9e5902d778514f1fc2d15876fca292971c6695541889a3\n\nd68a90fbe579a8199d78ef9ca001301e2c55a3015d4e3df3c238c276ed7cc1ce\n\ndc06012b4aef457efb0ecb9cdca579bb573823a1a63bb7a2ba92c7ce0c2ddbfb\n\ne2181b3d47feb5a321fe3b85b08a0245a1e0824b213e568fa4736d529fd5f8c2\n\ne4a460db653c8df4223ec466a0237943be5de0da92b04a3bf76053fa1401b19e\n\nedb45f03dfd52ab58f163ad2ca48f4bc9c4bcb72ea9181d0e0a1d87859f707a6\n\nf0304a1f7d87ac413f43a815088895872be0045a33c5f830b4b392a7ce5b8c46\n\nf307280077b2a60d991a68c5700cbc57fe0ab6ec005caba0b0bcca4dbc5a1e2f\n\nfb506b8dd4025e247ac2fa12ffd46fd1cb6a06a138995a5cbda49074d567f615\n\nfd2d9011ec860ba211d169063248d13d17425f210ff87a6c5a610b4704866339\n\n\n-----\n\n##### Elise Delivery Document SHA256 values\n\n9a226eeae1fc51a2bc2e72b098d5654238d0cc8eae29c0cdaacb49ae9d997d04\n\n7e917319e2af9457c35afbb539c09233da2e02d6a64f970706dae9f6c3c791eb\n\nc19d3242d43c71f03f5873231444c12a6a11892dd7f0142ff10479f1f718382d\n\ndc61e089eebf6fa1b3abf637ce105e0d20666aa52d9001f5fd5034815331cd61\n\nfd6302a152b0a2eff84b6ef219db5d79b6039043dfd5799ac9a4a0cced58e8bd\n\ne9971de22a922678fc216e9e3923c7e6b21455ddfbb24eb46e50e1cc7ceacc31\n\nd9174d6bbcb51d3df186794109cd6b2036f6231cf8733290eadd399bf8137055\n\nb53f98c113e7f72ff5170dcdb2ab2b1c15a02aadb72b2d2710d899aea9b875bd\n\nb2232492776267599307309e9d8874aac25e7cb31b155b0ca05349312690372f\n\n463c6c6ffb8ecf2df44e294818dd500457807ff126dd658c5fe329c09f43a6e0\n\n3d2c6d48425212eabb886c2e7e89249e4aa8cf4ad9ec3dd22cafb4f879683d8b\n\n093e394933c4545ba7019f511961b9a5ab91156cf791f45de074acad03d1a44a\n\nb0ffb80762f25935415a7ffd6b9402a23c2b6b4dc4921419ef291160cf7f023b\n\n8e180a9d7f233c189519bbfa2b649ca410c4869457e0cf8396beb82ffbffd05c\n\n8e7c198e1eaa5be2d1415be3001c217634ae207b8f912e9a84af6c6016aa467e\n\n00c0e0c14835c08d220ef27ef6324df86880167d416ff7183d7df241ffebc3f8\n\n0adbf0f6a5c21054e569b2ef68c8c6ae7834a0700672c1f3ec6e50daf49a3a94\n\n96410865d46cda89c7c34c60d485c2378a98acbba7ead5ada90daa02a94ba299\n\na98db2098fe9e3e203bed8318ae1d71e8a7b68f801613be10f3917baad7b49b2\n\nb1e30dd3ad2c3290adad848f7199e03f365ecf484c44c6c7eaf42f6b323cd30b\n\n4780442f3cc8d3e1888aa6cecbb05d0c49a6755964eba7a8a6a36d6d2a0ef881\n\nbae07b0c3e4e96731360dc4faa49c0d4abe4d3705e768393f21661c82dea13f3\n\n65c901b19e2eec6b8392100c1073253641a95dd542f39c9ca95755e8a2afde14\n\n30f1f7e848c79212f70794d718d0f3929c24e0f3d28695a7c85a85c77ab7aac9\n\n0752bbdb0c51a519f17a62dd30a033c224c82168522f2c88949b1a0afc8f9037\n\nb9681c178e087140344e6aec2630c61f6a7be92e97ebbe7ce10528f6f0e6028f\n\n6eae10f0b9a62a26b19897f7ba627f92e93e458034939f55f2001835c0e1f1be\n\n\n-----\n\n##### Lotus Blossom Command and Control Servers\n\n101.55.120.153\n\n101.55.120.165\n\n101.55.121.47\n\n103.244.91.16\n\n103.246.245.146\n\n103.252.19.13\n\n103.28.46.96\n\n113.10.136.18\n\n113.10.222.157\n\n118.193.212.61\n\n122.10.89.84\n\n122.10.89.85\n\n142.91.252.130\n\n162.211.181.107\n\n162.211.181.26\n\n173.231.49.98\n\n184.22.44.209\n\n202.77.181.179\n\n202.82.202.228\n\n202.82.91.139\n\n203.218.138.30\n\n210.209.127.8\n\n210.209.79.29\n\n218.103.16.153\n\n23.234.63.197\n\n27.255.64.231\n\n45.64.113.130\n\n46.251.237.59\n\n50.7.11.10\n\n58.64.183.92\n\n59.188.247.32\n\n59.6.2.16\n\n61.58.31.102\n\n95.154.195.152\n\nasean-star.com\n\naseaneco.org\n\naseansec.dynalias.org\n\nbeckhammer.xicp.net\n\nboshman09.com\n\nchris201.net\n\ncpcl2006.dyndns-free.com\n\ncybertunnel.dyndns.info\n\nharryleed.dyndns.org\n\njackyson.dyndns.info\n\n\n-----\n\nkid.dyndns.org\n\nkjd.dyndns.org\n\nnewinfo32.eicp.net\n\nnewshappys.dyndns-blog.com\n\npetto.mooo.com\n\nphil-army.gotdns.org\n\nphil-gov.gotdns.org\n\nscristioned.dyndns-web.com\n\nshotacon.dyndns.info\n\nusa-moon.net\n\nverolalia.dyndns.org\n\nwsi.dyndns.org\n\nwww.aliancesky.com\n\nwww.babysoal.com\n\nwww.boshman09.com\n\nwww.chris201.net\n\nwww.iascas.net\n\nwww.imonju.com\n\nwww.imonju.net\n\nwww.interhero.net\n\nwww.seachers.net\n\nwww.serchers.net\n\nwww.tgecc.org\n\nwww.tintuchoahau.com\n\nwww.vienclp.com\n\nwww3.bkav2010.net\n\ni   Triangle of Life. Snopes. December, 2009. http://www.snopes.com/inboxer/household/triangle.asp\n\nii  Targeted Attack Trends 2013 2H. Trend Micro Inc. May 19, 2014.\nhttp://www.itu.int/en/ITU-D/Cybersecurity/Documents/2H_2013_Targeted_Attack_Campaign_Report.pdf\n\niii  Targeted Attack Trends in Asia-Pacific. Trend Micro Inc. Nov. 20, 2014. http://www.trendmicro.co.in/in/\ncloud-content/apac/pdfs/security-intelligence/reports/rpt-1h-2014-targeted-attack-trends-in-asia-pacific.pdf\n\niv  BKDR_ESILE.SMEX. Trend Micro Inc. May 28, 2013.\nhttp://www.trendmicro.com/vinfo/us/threat-encyclopedia/malware/BKDR_ESILE.SMEX\n\nv  ESILE Targeted Attack Campaign Hits APAC Governments. Trend Micro Inc. July 28, 2014.\nhttp://www.trendmicro.com.my/vinfo/my/security/news/cyber-attacks/\nesile-targeted-attack-campaign-hits-apac-governments\n\nvi Analysis of Malware Page. Singh, Abhishek. Sept. 12, 2012.\nhttps://www.fireeye.com/blog/threat-research/2012/09/analysis-of-malware-page.html\n\nvii Spear Phishing the News Cycle: APT Actors Leverage Interest in the Disappearance of Malaysian Flight\nMH 370. Moran, Ned & Lanstein, Alex https://www.fireeye.com/blog/threat-research/2014/03/\nspear-phishing-the-news-cycle-apt-actors-leverage-interest-in-the-disappearance-of-malaysian-flight-mh-370.html\n\n\n4401 Great America Parkway\nSanta Clara, CA 95054\n\nMain: +1.408.753.4000\nSales: +1.866.320.4788\nSupport: +1.866.898.9087\n\n\nCopyright ©2015, Palo Alto Networks, Inc. All rights reserved. Palo Alto Networks,\nthe Palo Alto Networks Logo, PAN-OS, App-ID and Panorama are trademarks of\nPalo Alto Networks, Inc. All specifications are subject to change without notice.\nPalo Alto Networks assumes no responsibility for any inaccuracies in this document\nor for any obligation to update information in this document. Palo Alto Networks\nreserves the right to change, modify, transfer, or otherwise revise this publication\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "d63ae2b7-445f-460d-965d-2676dacdb6de",
            "created_at": "2022-10-25T15:59:19.552139Z",
            "updated_at": "2022-10-25T15:59:19.552139Z",
            "deleted_at": null,
            "name": "APTnotes",
            "url": "https://github.com/aptnotes/data",
            "description": "APTnotes data",
            "reports": null
        },
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        }
    ],
    "references": [
        "https://app.box.com/s/xhn6ru62qqom1kuxoe3mxnqrtb1sqw2q",
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2015/2015.06.16.operation-lotus-blossom/unit42-operation-lotus-blossom.pdf"
    ],
    "report_names": [
        "unit42-operation-lotus-blossom"
    ],
    "threat_actors": [
        {
            "id": "a1ce86c2-3efc-4115-a85e-92c5fa461838",
            "created_at": "2022-10-25T16:47:55.561071Z",
            "updated_at": "2025-03-27T02:05:17.261424Z",
            "deleted_at": null,
            "main_name": "BRONZE ELGIN",
            "aliases": [
                "Lotus Blossom ",
                "Lotus Panda ",
                "Lstudio",
                "Spring Dragon ",
                "CTG-8171 "
            ],
            "source_name": "Secureworks:BRONZE ELGIN",
            "tools": [
                " Lzari",
                "Elise"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "2fa14cf4-969f-48bc-b68e-a8e7eedc6e98",
            "created_at": "2022-10-25T15:50:23.538608Z",
            "updated_at": "2025-03-27T02:00:55.495551Z",
            "deleted_at": null,
            "main_name": "Lotus Blossom",
            "aliases": [
                "Lotus Blossom",
                "DRAGONFISH",
                "Spring Dragon",
                "RADIUM",
                "Raspberry Typhoon"
            ],
            "source_name": "MITRE:Lotus Blossom",
            "tools": [
                "Elise"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "eaa8168f-3fab-4831-aa60-5956f673e6b3",
            "created_at": "2022-10-25T16:07:23.805824Z",
            "updated_at": "2025-03-27T02:02:09.986613Z",
            "deleted_at": null,
            "main_name": "Lotus Blossom",
            "aliases": [
                "ATK 1",
                "ATK 78",
                "Billbug",
                "Bronze Elgin",
                "CTG-8171",
                "Dragonfish",
                "Lotus Blossom",
                "Operation Lotus Blossom",
                "Red Salamander",
                "Spring Dragon",
                "Thrip"
            ],
            "source_name": "ETDA:Lotus Blossom",
            "tools": [
                "BKDR_ESILE",
                "Catchamas",
                "EVILNEST",
                "Elise",
                "Group Policy Results Tool",
                "Hannotog",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "Mimikatz",
                "PsExec",
                "Rikamanu",
                "Sagerunex",
                "Spedear",
                "Syndicasec",
                "WMI Ghost",
                "Wimmie",
                "gpresult"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "87a20b72-ab72-402f-9013-c746c8458b0b",
            "created_at": "2023-01-06T13:46:38.293223Z",
            "updated_at": "2025-03-27T02:00:02.796483Z",
            "deleted_at": null,
            "main_name": "LOTUS PANDA",
            "aliases": [
                "Lotus BLossom",
                "Spring Dragon",
                "ST Group",
                "DRAGONFISH",
                "BRONZE ELGIN",
                "ATK1",
                "G0030",
                "Red Salamander"
            ],
            "source_name": "MISPGALAXY:LOTUS PANDA",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1666716501,
    "ts_updated_at": 1743041628,
    "ts_creation_date": 1434378816,
    "ts_modification_date": 1434378836,
    "files": {
        "pdf": "https://archive.orkl.eu/3bcbddd61cc7df02fad5bdc692e956bac590fe98.pdf",
        "text": "https://archive.orkl.eu/3bcbddd61cc7df02fad5bdc692e956bac590fe98.txt",
        "img": "https://archive.orkl.eu/3bcbddd61cc7df02fad5bdc692e956bac590fe98.jpg"
    }
}