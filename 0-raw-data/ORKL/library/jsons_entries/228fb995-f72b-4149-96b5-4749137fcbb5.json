{
    "id": "228fb995-f72b-4149-96b5-4749137fcbb5",
    "created_at": "2023-01-12T15:08:43.481731Z",
    "updated_at": "2025-03-27T02:13:58.284246Z",
    "deleted_at": null,
    "sha1_hash": "3f0dfba20e59673b9111b44b32fec5aeadb5ada0",
    "title": "2021-01-06 - Expanding Range and Improving Speed- A RansomExx Approach",
    "authors": "",
    "file_creation_date": "2022-05-28T01:20:01Z",
    "file_modification_date": "2022-05-28T01:20:01Z",
    "file_size": 1043705,
    "plain_text": "# Expanding Range and Improving Speed: A RansomExx Approach\n\n**[trendmicro.com/en_us/research/21/a/expanding-range-and-improving-speed-a-ransomexx-approach.html](https://www.trendmicro.com/en_us/research/21/a/expanding-range-and-improving-speed-a-ransomexx-approach.html)**\n\nJanuary 6, 2021\n\nRansomware\n\nRansomExx is a ransomware variant responsible for several high-profile attacks in 2020. We take a look at its\ncurrent techniques which include the use of trojanized software to deliver malicious payloads and an overall\nshort and fast attack.\n\nBy: Leandro Froes January 06, 2021 Read time: ( words)\n\n[RansomExx, a ransomware variant responsible for several high-profile attacks in 2020, has shown signs of](https://www.trendmicro.com/vinfo/tmr/?/us/security/definition/ransomware)\nfurther development and unhampered activity. The most recently reported development involves the use of\n[newer variants adapted for Linux servers that effectively expanded its range to more than Windows servers.](https://www.forbes.com/sites/daveywinder/2020/11/08/new-ransomware-threat-jumps-from-windows-to-linux-what-you-need-to-know/)\n\nOwn monitoring efforts found RansomExx compromising companies in the United States, Canada, and Brazil,\nas well as the sustained activity of the Linux variant. This entry details our analysis of a RansomExx campaign\nthat used [IcedID as its initial access vector, Vatet loader as its payload delivery method, and both Pyxie and](https://www.trendmicro.com/vinfo/tmr/?/es/security/news/cybercrime-and-digital-threats/icedid-banking-trojan-targets-us-financial-institutions)\nCobalt Strike as post-intrusion tools. This combination of tools took only five hours to deploy the ransomware\nfrom its initial access.\n\n[RansomExx used to be operated by a threat group, which SecureWorks named GOLD DUPONT, that has](https://www.secureworks.com/research/threat-profiles/gold-dupont)\nbeen active since 2018. Based on its most recent attacks, the threat group showed a fast and effective\napproach to compromising an environment. Malware like Vatet loader, PyXie, Trickbot, and RansomExx, as\nwell as some post-intrusion tools like Cobalt Strike, are typically part of this threat group’s arsenal.\n\nThis malware is worth looking into as it demonstrates effective techniques frequently observed in ransomware\nattacks in 2020. These methods include the use of trojanized software to deliver malicious payloads and an\noverall short and fast attack.\n\n**The Investigation**\n\n\n-----\n\nThe incident we observed was first flagged as a phishing email with an attached password-protected ZIP file,\n[which is actually a Word document (detected as Trojan.W97M.SHATHAK.A) with a malicious macro. It shows](https://www.trendmicro.com/vinfo/tmr/?/us/threat-encyclopedia/malware/Trojan.W97M.SHATHAK.A)\na message that lures users into enabling macro content:\n\nFigure 1.\n\nMalicious Word document content\nBy allowing the macro inside the document, it will attempt to download the IcedID trojan (detected as\n[TrojanSpy.Win32.ICEDID.BP) from a malicious URL. If the download succeeds, the trojan is executed using](https://www.trendmicro.com/vinfo/tmr/?/us/threat-encyclopedia/malware/TrojanSpy.Win32.ICEDID.BP)\nregsvr32.exe.\n\nFigure 2. Code snippet of the macro\nAs a common IcedID approach it used steganography as a method to deliver the payload through a .png file\ndownloaded from a malicious URL. The file is decrypted, and the payload is injected into memory. For\npersistence, IcedID creates a scheduled task to run hourly, in which it again uses regsvr32.exe to run its\nmalicious DLL:\n\nFigure 3. Malicious scheduled task initializing\nOn this incident we observed msiexec.exe being used to inject and deploy the final IcedID payload. With the\nfinal payload in place, the attacker was able to load and execute the Cobalt Strike payload, allowing it to\ncommunicate with the command and control (C&C) server:\n\n\n-----\n\nFigure 4.\n\nTelemetry data of the point-of-entry machine connecting to the C&C Server\nAfter establishing a connection to the malicious server, the threat actor started to collect machine information\nand move laterally. In this entry, we don’t have evidence to show all the approaches the malware used to\nmove laterally, except for one that was through SMB.\n\nFigure 5. Some of the information gathered by the attacker from the point of entry machine\nThe artifact used to deliver the other components executed in the environment was a trojanized version of\n[Notepad++ — Vatet loader (detected as Trojan.Win32.VATET.SM). As described in our previous blog post,](https://www.trendmicro.com/vinfo/tmr/?/us/threat-encyclopedia/malware/Trojan.Win32.VATET.SM)\nVatet loader decrypts a file (in our analysis referred to as config.dat) using an XOR-based method. After the\nXOR operation, it allocates memory, injects the config.dat decrypted code into its own memory, and then\nexecutes the payload:\n\n\n-----\n\nFigure 6. Code snippet of Vatet loader routine\nVatet loader loads any payload as long as it follows the correct XOR operation based on the file path of\nconfig.dat. We identified a different config.dat file being used for different purposes, like information gathering\nthrough Pyxie, Lazagne and Mimikatz as well as RansomExx itself for its last attack phase. One key\nobservation was that the config.dat used for information gathering contained an internal IP in the configuration\nof its payload, specifically in the part pertaining to the address of the server being used to send the gathered\ninformation. We have evidence showing that this internal IP was used as an exfiltration point and\ncommunicated to the C&C server mentioned earlier. This behavior leads us to think that the entire attack was\nindeed very fast, with some of the components created in the time of the incident.\n\n**Usage of the Linux variant**\n\nCorrelating the described incident to more recent attacks involving RansomExx, we observed the use of a\nnew Linux variant of RansomExx to compromise Linux servers. We have no information on how the malware\nwas sent to the Linux server, but we observed it aiming for the VMware environment in general, especially\nmachines that serve as storage for the VMware files. We have found three variants of RansomExx for Linux\nusing Trend Micro [Telfhash, and all three samples shared the same behavior. The sample we analyzed from](https://www.trendmicro.com/en/research/20/d/grouping-linux-iot-malware-samples-with-trend-micro-elf-hash.html)\nthese three is a 64-bit ELF executable with all of the cryptographic schemes from an open-source library\ncalled mbedtls. The sample is multi-thread and goes straight to encryption. It has no network activities, no\nanti-analysis techniques, or other activities outside its main agenda. The sample also has some available\ndebug information allowing us to check characteristics like the function names and source code file names:\n\n\n-----\n\nFigure 7. Examples of RansomExx debug information\nUpon execution, the sample starts calling a function referred to as GeneratePreData, which is responsible for\nthe creation of a 256-bit AES key using both pseudo-random values from native Linux functions and also\nmbedtls operations. The AES key is encrypted using a hardcoded RSA-4096 public key, with the result written\nin a global variable. The content of that global variable is going to be appended to each file for future\nencryption using AES in ECB mode:\n\n\n-----\n\nFigure 8. Hardcoded RSA public key\nThe GeneratePreData function runs in a thread created by the malware on an infinite loop, attempting to\ngenerate encryption keys every 0.18 seconds. The thread will continue to run until the end of the malware\nexecution.\n\nFigure 9. Code snippet of the Ransomware main function\n\n\n-----\n\nFigure 10. Code snippet of the AES encryption\nThe malware only runs if the user specifies a directory as a command line parameter. The encryption\npreparation starts in a function referred to as list_dir. The first action performed by the list_dir function makes\nsure that the argument passed through the command line is a directory. If the check succeeds, the function\nresponsible for the creation of the ransom note is called.\n\nIf the other files inside the same directory are also directories, then the list_dir function is called again. For\nregular files, the malware attempts to check if the file has the occurrence of the ransomware extension string\nto determine if it needs to be encrypted. For every file found inside the directories, the malware adds a task to\nencrypt the file:\n\n\n-----\n\nFigure 11. Code snippet showing the list_dir() function\n\nFigure 12. Code snippet of the ransom note creation function\n**Security recommendations**\n\nThreat actors constantly improve their arsenal and approaches to be more effective. The use of memorybased techniques, legitimate Windows tools, and well-known post-intrusion tools preceding the deployment of\nthe main payload seems to result in a higher chance of success for ransomware operators.\n\nFor users, preventing attacks from the outset is key to impeding the chance of successful ransomware\nattacks. The speed and agility that this campaign banked on will not matter in the future if initial access is\ndenied from the start. Learning from this campaign, users should only download files from trusted and\nlegitimate sources to prevent the entry of malicious files into their system. Users should avoid enabling\nmacros, and should be wary of documents that prompt them to do so.\n\n\n-----\n\nIn general, more robust security measures can prevent ransomware and other threats from having a strong\nimpact on systems. These include employing least privilege standards and ensuring that systems are up-todate. If legacy systems cannot be avoided, solutions that allow virtual patching can help ensure that legacy\nsystems are nonetheless protected.\n\n**Trend Micro Solutions**\n\n[Trend Micro Cloud One™– Workload Security has a virtual patching feature that can protect the system](https://www.trendmicro.com/en_us/business/products/hybrid-cloud/cloud-one-workload-security.html)\nagainst exploits. Since some of the malware’s techniques can bypass signature-based security agents,\ntechnologies like Trend Micro Behavior Monitoring and Machine Learning can be used to prevent and block\nthose threats.\n\n[Enterprises can also take advantage of Trend Micro XDRTM, which collects and correlates data across](https://www.trendmicro.com/en_us/business/products/detection-response/xdr.html)\nendpoints, emails, cloud workloads, and networks, providing better context and enabling investigation in one\nplace. This, in turn, allows teams to respond to similar threats faster and detect advanced and targeted threats\nearlier.\n\n**Indicators of Compromise**\n\n**Trend Micro Detection**\n**Name** **SHA256**\n\n\n**[Ransom.Linux.EXX.YAAK-A](https://www.trendmicro.com/vinfo/%20tmr/?/us/threat-encyclopedia/malware/Ransom.Linux.EXX.YAAK-A)**\n\n**[Ransom.Linux.EXX.YAAK-B](https://www.trendmicro.com/vinfo/tmr/?/us/threat-encyclopedia/malware/Ransom.Linux.EXX.YAAK-B)**\n\n**[Ransom.Linux.EXX.YAAK-B](https://www.trendmicro.com/vinfo/tmr/?/us/threat-encyclopedia/malware/Ransom.Linux.EXX.YAAK-B)**\n\n**[Trojan.W97M.SHATHAK.A](https://www.trendmicro.com/vinfo/tmr/?/us/threat-encyclopedia/malware/Trojan.W97M.SHATHAK.A)**\n\n**[TrojanSpy.Win32.ICEDID.BP](https://www.trendmicro.com/vinfo/tmr/?/us/threat-encyclopedia/malware/TrojanSpy.Win32.ICEDID.BP)**\n\n**[TrojanSpy.Win32.ICEDID.BP](https://www.trendmicro.com/vinfo/tmr/?/us/threat-encyclopedia/malware/TrojanSpy.Win32.ICEDID.BP)**\n\n**[TrojanSpy.Win32.ICEDID.BP](https://www.trendmicro.com/vinfo/tmr/?/us/threat-encyclopedia/malware/TrojanSpy.Win32.ICEDID.BP)**\n\n\ncb408d45762a628872fa782109e8fcfc3a5bf456074b007de21e9331bb3c5849\n\n08113ca015468d6c29af4e4e4754c003dacc194ce4a254e15f38060854f18867\n\n78147d3be7dc8cf7f631de59ab7797679aba167f82655bcae2c1b70f1fafc13d\n\n6fb5af0a4381411ff1d9c9041583069b83a0e94ff454cba6fba60e9cd8c6e648\n\n3c5af2d1412d47be0eda681eebf808155a37f4911f2f2925c4adc5c5824dea98\n\n87e732bdc3a1ed19904985cfc20da6f26fa8c200ec3b2806c0abc7287e1cdab7\n\n884fe75824ad10d800fd85d46b54c8e45c4735db524c247018743eb471190633\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-01-06 - Expanding Range and Improving Speed- A RansomExx Approach.pdf"
    ],
    "report_names": [
        "2021-01-06 - Expanding Range and Improving Speed- A RansomExx Approach.pdf"
    ],
    "threat_actors": [
        {
            "id": "26a04131-2b8c-4e5d-8f38-5c58b86f5e7f",
            "created_at": "2022-10-25T15:50:23.579601Z",
            "updated_at": "2025-03-27T02:00:55.50292Z",
            "deleted_at": null,
            "main_name": "TA551",
            "aliases": [
                "TA551",
                "GOLD CABIN",
                "Shathak"
            ],
            "source_name": "MITRE:TA551",
            "tools": [
                "QakBot",
                "IcedID",
                "Valak",
                "Ursnif"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "04e34cab-3ee4-4f06-a6f6-5cdd7eccfd68",
            "created_at": "2022-10-25T16:07:24.578896Z",
            "updated_at": "2025-03-27T02:02:10.286803Z",
            "deleted_at": null,
            "main_name": "TA551",
            "aliases": [
                "Gold Cabin",
                "Monster Libra",
                "Shathak",
                "TA551"
            ],
            "source_name": "ETDA:TA551",
            "tools": [
                "BokBot",
                "CRM",
                "Gozi",
                "Gozi CRM",
                "IceID",
                "IcedID",
                "Papras",
                "Snifula",
                "Ursnif",
                "Valak",
                "Valek"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "610a7295-3139-4f34-8cec-b3da40add480",
            "created_at": "2023-01-06T13:46:38.608142Z",
            "updated_at": "2025-03-27T02:00:02.87217Z",
            "deleted_at": null,
            "main_name": "Cobalt",
            "aliases": [
                "Cobalt Gang",
                "GOLD KINGSWOOD",
                "COBALT SPIDER",
                "G0080",
                "Mule Libra",
                "Cobalt Group"
            ],
            "source_name": "MISPGALAXY:Cobalt",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "7268a08d-d4d0-4ebc-bffe-3d35b3ead368",
            "created_at": "2022-10-25T16:07:24.225216Z",
            "updated_at": "2025-03-27T02:02:10.144446Z",
            "deleted_at": null,
            "main_name": "Sprite Spider",
            "aliases": [
                "Gold Dupont",
                "Sprite Spider"
            ],
            "source_name": "ETDA:Sprite Spider",
            "tools": [
                "Agentemis",
                "Cobalt Strike",
                "CobaltStrike",
                "Coroxy",
                "Defray 2018",
                "Defray777",
                "DroxiDat",
                "Glushkov",
                "LaZagne",
                "Metasploit",
                "PyXie",
                "PyXie RAT",
                "Ransom X",
                "RansomExx",
                "SharpHound",
                "Shifu",
                "SystemBC",
                "Target777",
                "Vatet",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "27e51b73-410e-4a33-93a1-49cf8a743cf7",
            "created_at": "2023-01-06T13:46:39.210675Z",
            "updated_at": "2025-03-27T02:00:03.022315Z",
            "deleted_at": null,
            "main_name": "GOLD DUPONT",
            "aliases": [
                "SPRITE SPIDER"
            ],
            "source_name": "MISPGALAXY:GOLD DUPONT",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "07775b09-acd9-498e-895f-f10063115629",
            "created_at": "2024-06-04T02:03:07.817613Z",
            "updated_at": "2025-03-27T02:05:17.351811Z",
            "deleted_at": null,
            "main_name": "GOLD DUPONT",
            "aliases": [
                "Sprite Spider "
            ],
            "source_name": "Secureworks:GOLD DUPONT",
            "tools": [
                " ArtifactExx",
                " Cobalt Strike",
                " Defray",
                " Metasploit",
                " PyXie",
                " Shifu",
                " SystemBC",
                " Vatet",
                "777"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "40b623c7-b621-48db-b55b-dd4f6746fbc6",
            "created_at": "2024-06-19T02:03:08.017681Z",
            "updated_at": "2025-03-27T02:05:17.342829Z",
            "deleted_at": null,
            "main_name": "GOLD CABIN",
            "aliases": [
                "TA551 ",
                "Shathak"
            ],
            "source_name": "Secureworks:GOLD CABIN",
            "tools": [
                ""
            ],
            "source_id": "Secureworks",
            "reports": null
        }
    ],
    "ts_created_at": 1673536123,
    "ts_updated_at": 1743041638,
    "ts_creation_date": 1653700801,
    "ts_modification_date": 1653700801,
    "files": {
        "pdf": "https://archive.orkl.eu/3f0dfba20e59673b9111b44b32fec5aeadb5ada0.pdf",
        "text": "https://archive.orkl.eu/3f0dfba20e59673b9111b44b32fec5aeadb5ada0.txt",
        "img": "https://archive.orkl.eu/3f0dfba20e59673b9111b44b32fec5aeadb5ada0.jpg"
    }
}