{
    "id": "87de9828-8866-46fc-9c11-23f41b9f408b",
    "created_at": "2023-01-12T15:08:01.71465Z",
    "updated_at": "2025-03-27T02:06:08.250813Z",
    "deleted_at": null,
    "sha1_hash": "94652a0c4827e4e6b626e9f0cb31198d0b44dfde",
    "title": "2019-01-23 - Russian Language Malspam Pushing Redaman Banking Malware",
    "authors": "",
    "file_creation_date": "2022-05-27T23:29:00Z",
    "file_modification_date": "2022-05-27T23:29:00Z",
    "file_size": 2375216,
    "plain_text": "# Russian Language Malspam Pushing Redaman Banking Malware\n\n**[unit42.paloaltonetworks.com/russian-language-malspam-pushing-redaman-banking-malware/](https://unit42.paloaltonetworks.com/russian-language-malspam-pushing-redaman-banking-malware/)**\n\nBrad Duncan, Mike Harbison January 23, 2019\n\nBy [Brad Duncan and](https://unit42.paloaltonetworks.com/author/bduncan/) [Mike Harbison](https://unit42.paloaltonetworks.com/author/mike-harbison/)\n\nJanuary 23, 2019 at 6:00 AM\n\n[Category: Unit 42](https://unit42.paloaltonetworks.com/category/unit42/)\n\nTags: [Banking Trojan,](https://unit42.paloaltonetworks.com/tag/banking-trojan/) [Malspam,](https://unit42.paloaltonetworks.com/tag/malspam/) [redaman,](https://unit42.paloaltonetworks.com/tag/redaman/) [Russia](https://unit42.paloaltonetworks.com/tag/russia/)\n\nThis post is also available in: 日本語 [(Japanese)](https://unit42.paloaltonetworks.jp/russian-language-malspam-pushing-redaman-banking-malware/)\n\nRedaman is banking malware first noted in 2015 that targets recipients who conduct\n[transactions using Russian financial institutions. First reported as the RTM banking Trojan,](https://www.welivesecurity.com/wp-content/uploads/2017/02/Read-The-Manual.pdf)\n[vendors like Symantec and](https://www.symantec.com/security-center/writeup/2017-022117-0116-99) [Microsoft described an updated version of this malware as](https://www.microsoft.com/en-us/wdsi/threats/malware-encyclopedia-description?Name=TrojanSpy:Win32/Redaman)\nRedaman in 2017. We have found versions of Redaman in Russian language massdistribution campaigns during the last four months of 2018. This blog tracks recent\ndevelopments from an ongoing campaign of malicious spam (malspam) currently distributing\nthis banking malware from September through December of 2018. We cover the following\nareas:\n\nInfection vector\nEmail characteristics\nTargeted recipients\nAnalysis of a Redaman sample\nInfection traffic\n\n## Infection vector\n\nSince September of 2018, Redaman banking malware has been distributed through\nmalspam. In this campaign, the Russian language malspam is addressed to Russian email\nrecipients, often with email addresses ending in .ru. These emails have file attachments.\nThese file attachments are archived Windows executable files disguised as a PDF\ndocument. In September 2018, the attachments were zip archives. In October 2018, the\nattachments were zip archives, 7-zip archives, and rar archives. In November 2018, the\nattachments were rar archives. And in December 2018, the attachments changed to gzip\narchives with file names ending in .gz.\n\n\n-----\n\n_Figure 1: Flow chart for infections from Redaman banking malware from September through_\n_December of 2018._\n\n## The emails\n\nSubject lines, message text, and attachment names constantly change for this malspam. But\nthe messages all have a common theme: they refer to a document or file for an alleged\nfinancial issue the recipient needs to resolve. These messages are often vague, and they\ncontain few details on the alleged financial issue. Their only goal is to trick the recipient into\nopening the attached archive and double-clicking the executable contained within.\n\nAmong dozens of examples seen from September through December of 2018, here is a\nselection of 10 subject lines from this malspam:\n\nSubject: Акт сверки сентябрь-октябрь\nSubject: Весь пакет док-ов за прошлый месяц\nSubject: Все док-ты за август-сентябрь\nSubject: Деб.задолженность среда\nSubject: Документы, сверка 02.10\nSubject: Заявка на возврат за ноябрь\nSubject: Необходимо свериться среда\nSubject: Отправка на за прошлую неделю\nSubject: Пакет документов для оплаты 1е октября\nSubject: Сверка на оплату\n\nThe following are Google translations for the above subject lines:\n\nSubject: Act of reconciliation September-October\nSubject: All package of last month's documents\n\n\n-----\n\nSubject: All docs for August-September\nSubject: Debt due Wednesday\nSubject: Documents Verification for October 2018\nSubject: Application for return for November\nSubject: Check the environment\nSubject: Sending on last week\nSubject: The package of documents for payment 1st October\nSubject: Payment Verification\n\n_Figure 2: Example of Redaman malspam from September 2018._\n\n\n-----\n\n_Figure 3: Example of Redaman malspam from October 2018._\n\n\n-----\n\n_Figure 4: Example of Redaman malspam from November 2018._\n\n\n-----\n\n_Figure 5: Example of Redaman malspam from December 2018._\n\n## Targeted recipients\n\n[The content of these emails and data from our AutoFocus threat intelligence platform](https://www.paloaltonetworks.com/products/secure-the-network/autofocus)\nconfirms this campaign is primarily targeting Russian recipients. We found 3,845 email\nsessions in AutoFocus with attachments tagged as Redaman banking malware from\nSeptember through December 2018. Data on the top 10 senders and recipients of this\nmalspam follow:\n\nMail servers of the top 10 senders:\n\nFrom Russia - 3,456\nFrom Belarus - 98\nFrom Ukraine - 93\nFrom Estonia - 29\nFrom Germany - 30\nFrom United States - 21\nFrom Netherlands - 12\nFrom Great Britain - 7\nFrom Switzerland - 7\n\n\n-----\n\nFrom Latvia - 2\n\nMail servers of the top 10 recipients:\n\nTo Russia - 2,894\nTo Netherlands - 195\nTo United States - 55\nTo Sweden - 24\nTo Japan - 16\nTo Kazakhstan - 12\nTo Spain - 12\nTo Finland - 11\nTo Germany - 6\nTo Austria - 4\n\n_Figure 6: AutoFocus map visualization for distribution of email recipients, September through_\n_December of 2018._\n\n## Analysis of a Redaman sample\n\nWe analyzed a sample of Redaman malware from malspam on November 13th, 2018.\n\nSHA256 hash of rar archive from the malspam:\n\nf6fb51809caec2be6164863b5773a7ee3ea13a449701a1f678f0655b6e8720df\n\nSHA256 hash of Redaman executable extracted from the rar archive:\n\ncd961e81366c8d9756799ec8df14edaac5e3ae4432c3dbf8e3dd390e90c3e22f\n\n\n-----\n\nSHA256 hash of Redaman DLL created by the above executable:\n\n14d33b02a497e46f470d30180a09a1057c6802c1f37b0efbf82cbdc47a8ae7ff\n\nWhen the Windows executable for Redaman is first run, it checks for the following files or\ndirectories on the local host (C:\\ or D:\\ drives):\n\n**_C:\\cuckoo_**\n**_C:\\fake_drive_**\n**_C:\\perl_**\n**_C:\\strawberry_**\n**_C:\\targets.xls_**\n**_C:\\tsl_**\n**_C:\\wget.exe_**\n**_C:\\*python*_**\n\nIf any of the above files or directories exist, the Windows executable throws an exception\nand exits. This indicates Redaman checks if it is running in a sandbox or similar type of\nanalysis environment.\n\nIf no exceptions occur, the Windows executable drops a DLL file in the user's\n**_AppData\\Local\\Temp\\ directory, creates a randomly-named folder under C:\\ProgramData\\_**\ndirectory and moves the DLL under that folder as a random file name. This Redaman DLL is\nmade persistent through a scheduled Windows task with the following properties:\n\nName: Windows Update\nDescription: Updating Windows components.\nTriggers: Executed whenever the user logs on\nAction: rundll32.exe \"C:\\ProgramData\\%random value%\\%random value.random 3_character extension%\",DllGetClassObject host_\n\nAfter creating a scheduled task and causing the DLL to load, the initial Redaman executable\nfile deletes itself.\n\n\n-----\n\n_Figure 7: Example of a Redaman DLL persistent through a scheduled task._\n\n\n-----\n\n_Figure 8: Process Hacker showing the Redaman DLL active using rundll32.exe._\n\nRedaman uses an application-defined hook procedure to monitor browser activity,\nspecifically Chrome, Firefox, and Internet Explorer. It then searches the local host for\ninformation related to the financial sector. Other capabilities of Redaman include:\n\nDownloading files to the infected host\nKeylogging activity\nCapture screen shots and record video of the Windows desktop\nCollecting and exfiltrating financial data, specifically targeting Russian banks\nSmart card monitoring\nShutting down the infected host\nAltering DNS configuration through the Windows host file\nRetrieving clipboard data\nTerminating running processes\nAdding certificates to the Windows store\n\n\n-----\n\n## Infection traffic\n\nWe generated the following infection traffic using the executable with SHA256 hash\ncd961e81366c8d9756799ec8df14edaac5e3ae4432c3dbf8e3dd390e90c3e22f on November\n14th, 2018:\n\n104.28.16[.]33 port 443 - namecha[.]in - GET /name/d/stat-counter-3-1\n185.141.61[.]246 port 80 - 185.141.61[.]246 - POST /index.php\n193.37.213[.]28 port 80 - 193.37.213[.]28 - POST /p/g_3453456jawd346.php\n\n_Figure 9: Redaman infection traffic filtered in Wireshark._\n\nNetwork activity started with an HTTPS URL to namecha[.]in, which is an alternative\nnamecoin block explorer. [Namecoin is a cryptocurrency system that can be used for](https://namecoin.org/)\ndecentralized DNS. That proves to be the case here, since the URL returned an IP address\nused for subsequent post-infection traffic as shown in Figure 10.\n\n\n-----\n\n_Figure 10: Data returned from namecha[.]in used for subsequent infection traffic._\n\nDuring the infection, callback traffic was periodically sent to a command and control (C2)\nsever at 185.141.61[.]246. Shortly after the infection, return traffic from the C2 server sent a\nPony variant DLL to the infected Windows client.\n\n\n-----\n\n_Figure 11: Using Wireshark to find 58 kB of encoded data returned from the C2 server at_\n_185.141.61[.]246._\n\nData for the Pony variant DLL was XOR encoded with multiple XOR keys and\n[RTLcompressed. The SHA256 of this Pony variant DLL is](https://docs.microsoft.com/en-us/windows-hardware/drivers/ddi/content/ntifs/nf-ntifs-rtlcompressbuffer)\nb4701d95219d465e978c4a815fcce89787916da33ae2a49d0e76d4445fd39ada, and it\ngenerated traffic to 193.37.213[.]28/p/g_3453456jawd346.php during the infection.\n\n## Conclusion\n\nSince it was first noted in 2015, this family of banking malware continues targeting recipients\nwho conduct transactions with Russian financial institutions. We found over 100 examples of\nmalspam during the last four months of 2018, and this blog provides a closer look at\nRedaman during that timeframe. We covered the following areas:\n\nInfection vector\nEmail characteristics\nTargeted recipients\nAnalysis of a Redaman sample\nInfection traffic\n\nWe expect to discover new Redaman samples as 2019 progresses.\n\nPalo Alto Networks customers are protected from this threat. Traps identifies these files\nthrough Local Analysis and Wildfire has classified them as malicious. Our threat prevention\nplatform detects this malware, and see the below appendices below for details on Redaman\nmalware we discovered from September through December of 2018.\n\n**Appendix A**\n\nSHA256 file hashes for 119 malspam attachments, 30 extracted Redaman executable files,\nand 30 dropped Redaman DLL files found from September through December 2018.\nInformation is available at: https://github.com/pan[unit42/iocs/blob/master/Redaman_banking_malware/2018-09-thru-2018-12-file-hashes-for-](https://github.com/pan-unit42/iocs/blob/master/Redaman_banking_malware/2018-09-thru-2018-12-file-hashes-for-Redaman-banking-malware.txt)\nRedaman-banking-malware.txt\n\n**Appendix B**\n\nSHA256 file hashes, archive file names, and extracted file names for Redaman banking\nmalware found in September 2018. Information is available at: https://github.com/pan[unit42/iocs/blob/master/Redaman_banking_malware/2018-09-file-hashes-for-Redaman-](https://github.com/pan-unit42/iocs/blob/master/Redaman_banking_malware/2018-09-file-hashes-for-Redaman-banking-malware.txt)\nbanking-malware.txt\n\n**Appendix C**\n\n\n-----\n\nSHA256 file hashes, archive file names, and extracted file names for Redaman banking\nmalware found in October 2018. Information is available at: https://github.com/pan[unit42/iocs/blob/master/Redaman_banking_malware/2018-10-file-hashes-for-Redaman-](https://github.com/pan-unit42/iocs/blob/master/Redaman_banking_malware/2018-10-file-hashes-for-Redaman-banking-malware.txt)\nbanking-malware.txt\n\n**Appendix D**\n\nSHA256 file hashes, archive file names, and extracted file names for Redaman banking\nmalware found in November 2018. Information is available at: https://github.com/pan[unit42/iocs/blob/master/Redaman_banking_malware/2018-11-file-hashes-for-Redaman-](https://github.com/pan-unit42/iocs/blob/master/Redaman_banking_malware/2018-11-file-hashes-for-Redaman-banking-malware.txt)\nbanking-malware.txt\n\n**Appendix E**\n\nSHA256 file hashes, archive file names, and extracted file names for Redaman banking\nmalware found in December 2018. Information is available at: https://github.com/pan[unit42/iocs/blob/master/Redaman_banking_malware/2018-12-file-hashes-for-Redaman-](https://github.com/pan-unit42/iocs/blob/master/Redaman_banking_malware/2018-12-file-hashes-for-Redaman-banking-malware.txt)\nbanking-malware.txt\n\n**Get updates from**\n\n**Palo Alto**\n\n**Networks!**\n\nSign up to receive the latest news, cyber threat intelligence and research from us\n\n[By submitting this form, you agree to our Terms of Use and acknowledge our Privacy](https://www.paloaltonetworks.com/legal-notices/terms-of-use)\nStatement.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2019/2019-01-23 - Russian Language Malspam Pushing Redaman Banking Malware.pdf"
    ],
    "report_names": [
        "2019-01-23 - Russian Language Malspam Pushing Redaman Banking Malware.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673536081,
    "ts_updated_at": 1743041168,
    "ts_creation_date": 1653694140,
    "ts_modification_date": 1653694140,
    "files": {
        "pdf": "https://archive.orkl.eu/94652a0c4827e4e6b626e9f0cb31198d0b44dfde.pdf",
        "text": "https://archive.orkl.eu/94652a0c4827e4e6b626e9f0cb31198d0b44dfde.txt",
        "img": "https://archive.orkl.eu/94652a0c4827e4e6b626e9f0cb31198d0b44dfde.jpg"
    }
}