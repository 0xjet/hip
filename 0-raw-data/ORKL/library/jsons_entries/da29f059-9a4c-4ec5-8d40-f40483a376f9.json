{
    "id": "da29f059-9a4c-4ec5-8d40-f40483a376f9",
    "created_at": "2023-01-12T15:01:55.286839Z",
    "updated_at": "2025-03-27T02:14:34.174278Z",
    "deleted_at": null,
    "sha1_hash": "53fd9a868d0d01f3b7b846bda75827725d92c82f",
    "title": "2021-04-13 - Malicious infrastructure as a service",
    "authors": "",
    "file_creation_date": "2022-06-13T04:01:09Z",
    "file_modification_date": "2022-06-13T04:01:09Z",
    "file_size": 382760,
    "plain_text": "# Malicious infrastructure as a service\n\n**[silentpush.com/blog/malicious-infrastructure-as-a-service](https://www.silentpush.com/blog/malicious-infrastructure-as-a-service)**\n\nApr 25\nWritten By [Ken Bagnall](http://10.10.0.46/blog?author=6081bc3c4920d358398731f8)\n\nMartijn April 13th 2021\n\n\nApril 25, 2021\n\n\nDomains created for malicious purposes are rarely registered on their own. When you have\nidentified such a domain, it is therefore always a good idea to look for other domains used\nin the same campaign.\n\nSometimes finding such a domain is easy. For example, you may notice a very similar\ndomain (such as the .net version of a .com domain) registered with the same registrar on\nthe same day. At other times you will need to look for other evidence, for example find them\nhosted on the same IP address.\n\nIn general, however, linking two domains through a single IP address isn’t strong enough\nevidence that the domains themselves are linked. The link becomes a lot stronger though\nwhen two or more domains were seen moving through the same set of IP addresses\n\n\n-----\n\nsimultaneously.\n\n[In previous blog posts, I used this to find five domains that used the same infrastructure and](https://silentpush.com/blog/pivoting-finding-malware-domains-without-seeing-malicious-activity/3)\nthat were made to look like they belonged to a content delivery network, as well as the\ninfrastructure of a [LodaRAT campaign targeting Bangladesh.](https://silentpush.com/blog/more-lodarat-infrastructure-targeting-bangladesh-uncovered/5)\n\nIn this blog post, I will share a few more examples of sets of malicious domains that moved\nsimultaneously through the same set of IP addresses. The sets of domains are linked and\nthere is some evidence to suggest that the infrastructure belongs to a bulletproof hosting\nservice.\n\n### Magecart\n\nThe first set of domains spoofs well known services such as Cloudflare, Google, jQuery and\nMagento:\n```\ncloudflareplus[.]com\ncloudflareplus[.]net\ncloudflareshop[.]com\ncloudflare[.]su\ngoogleexpert[.]name\ngoogleinfo[.]name\ngooglemanagerads[.]com\ngooglemaster[.]name\ngoogleplus[.]name\ngooqlescript[.]com\njquery24[.]com\njqueryexpert[.]com\njqueryinfo[.]com\njquery[.]su\njsstroy[.]com\nmagentoinfo[.]name\nmagentoinfo[.]org\nmagentoportal[.]com\nmagentostore[.]org\nmanualseos[.]ru\nmycloudflare[.]net\nprocloudflare[.]com\nprocloudflare[.]net\nseocmson[.]ru \n\n```\nThese domains were all registered at Russian registrar REG.RU on the 3rd of November\n2020 and have simultaneously moved through the same set of IP addresses. The all use\nthe name servers of DNSPod, a Chinese DNS hosting provider that has long been popular\nwith cyber criminals.\n\nFor the first three months of 2021, the domains were seen on the following twenty IP\naddresses, in this order:\n\n\n-----\n\n```\n208.69.117[.]117\n194.147.78[.]6\n45.143.136[.]186\n92.38.130[.]71\n46.17.250[.]52\n46.17.250[.]84\n91.203.192[.]117\n34.65.156[.]213\n35.189.71[.]51\n34.65.43[.]209\n35.197.218[.]54\n35.205.161[.]91\n8.209.112[.]138\n35.228.62[.]27\n34.107.33[.]136\n35.228.209[.]29\n35.187.16[.]185\n35.228.228[.]1\n35.204.191[.]93\n35.198.110[.]173\n\n```\nSometimes, the domains only pointed to an IP address for less than a day, but in one case\nthey pointed to the same IP address for three weeks in a row.\n\nThe IP addresses belong to various hosting services, with a particular preference for\nGoogle’s.\n\nInterestingly, around the 8th of March, nine more domains joined the cycle:\n```\nbing-visitors[.]com\ncloubfiare[.]net\ngoogiemanager[.]com\ngooglemanagerads[.]com\ngooglemgr[.]net\ngoogletag[.]name \ngooqleads[.]net\nqodaddy[.]net\nyahoo-tracker[.]com\n\n```\nThey have been pointing to the same IP address as the original set ever since.\n\nThere is [public evidence linking these domains to Magecart. Magecart is an umbrella term](https://twitter.com/MBThreatIntel/status/1370062381297004544)\nuse to refer to more than a dozen groups that insert code into websites’ payment pages that\nsteals credit card data. A common trick used by Magecart groups is to make their domains\nlook like those from which code is regularly included into web pages. A website owner\nlooking at a web page’s source code may thus incorrectly assume the inclusion of thirdparty JavaScript is harmless.\n\n_Note: because the domains sometimes pointed to an IP address for a very short time_\n_period, it is possible that the list of IP addresses above isn’t complete for the three-month_\n_period January 1st to March 31st 2021. The same applies to the examples below._\n\n\n-----\n\n### IcedID and Qakbot\n\nA second set of domains also cycled through a set of IP addresses, again all pointing to the\nsame IP address at the same point in time.\n\nThe domains are:\n\n\n-----\n\n```\naath22rzmo03mvewdj[.]xyz\namr16pzcp03omerd[.]xyz\ncaqp10snyod03msvsqu[.]com\nfkko03vvxohq03taep[.]com\ncidn02mjco03pobx[.]com\ncyh26wcekai02atpeax[.]com\ndrt22uhfjmz03ltxc[.]xyz\ndskl02touc03jeby[.]com\ndzw10jpcgj03fckc[.]com\nemqjj27ljgl02hqqzi[.]com\netysu02scnabr03wzaxue[.]com\nevz15lmlir03sygmyr[.]xyz\nb25d3a23hy[.]com\nfb25d3add23hy[.]com\nfb25d3as23hy[.]com\nfb25d3asddd23hy[.]com\nfb25d3erda23hfy[.]com\nfb25era23hfy[.]com\nfb25erhfy[.]com\nftkaq03ihfbh03rehx[.]com\nfyz10eijkl03mytjfb[.]com\ngbza26rngn02bekll[.]com\nghtyrncjf2df[.]com\nhei03tfxv03mahl[.]com\nhqcaz02egeq03bvmhm[.]com\nhqn27dyhvwp02wznv[.]com\nihjpn03sijjl03dtmtr[.]com\ninpa02lzjvt03anas[.]com\njam03iofwv03jniedf[.]com\njgu16cbxdr03ehqvx[.]com\njhj10jtvwu03zsjwk[.]com\njqilt27xsbz02anaeu[.]com\nklhlh16zldwun03vlpq[.]com\nkyvws03ndah03hecon[.]com\nlic02uiccnh03nruvp[.]com\nlxoyw10bipu03ilyig[.]com\nmtk23gqakwj03bzds[.]xyz\nqnvrih26coxejl02enyfn[.]com\nnwvv27dwmy02bgznc[.]com\nnygvj27cvlk02cktf[.]com\nolfs23kvri03wyyb[.]xyz\nououz02naba03oiyd[.]com\npbdq26xjey02uprxwx[.]com\nppk02dmgmzj03dxekog[.]com\nqab26utxb02pquc[.]com\nrdraj16rwjw03xnli[.]com\nrea26ypgvle02hcbunp[.]com\nrlvq27rmjej02sfvb[.]com\nrlyrt26rnxw02vqijgs[.]com\nrsjb23tnxjng03dgiy[.]xyz\nsal03gicu03qcwtif[.]com\ntmrz10fxhy03ntxjf[.]com\ntoj27nlpr02irajz[.]com\ntoqku26hwpu02shuroh[.]com\nttj10qrrqx03kdts[.]com\n\n```\n\n-----\n\n```\nusy15wycqme03dymh[.]xyz\nvad12mhpfp03vyfl[.]xyz\nvdk10pfsny03tzfva[.]com\nvpu03jivmm03qncgx[.]com\nvyhml26anpfyb02aqsehz[.]com\nvyw27lfrvoj02kkxo[.]com\nwnah27frybfe02sadb[.]com\nxgka03stox03cloeqz[.]com\nxjw10whta03ytgdi[.]com\nxsd22aeofw03lqzf[.]xyz\nyar03jmtvr03jtqg[.]com\nydw27hfhbk02zpidmv[.]com\nywgiu10zmnwcx03vpnyp[.]com\nzkkn02lffiff03zkmh[.]com \n\n```\nwhile the IP addresses are\n```\n47.254.134[.]0\n34.90.237[.]156\n8.209.64[.]96\n8.209.68[.]209\n34.89.57[.]175\n8.208.97[.]177\n35.228.62[.]27\n8.210.31[.]137\n35.228.48[.]27\n34.65.218[.]17\n8.209.98[.]100\n35.204.191[.]93\n8.211.4[.]209\n\n```\nThe domains were registered between late February and mid March 2021, mostly through\nDutch registrar Hosting Concepts with a few using REG.RU instead. The nameservers used\nwere again those of DNSPod, while the IP addresses belong to Google and Alibaba.\n\nInterestingly two of the IP addresses (marked in bold above) were also used by the\nMagecart domains above, suggesting a possible link between the two sets.\n\n[Many of the above domains have been used to download either the IcedID or the](https://urlhaus.abuse.ch/url/1073423/) [Qakbot](https://urlhaus.abuse.ch/url/1046968/)\nmalware. Both IcedID and Qakbot (also known as Qbot) are commonly used as initial\naccess brokers. Though no direct link between these two actors is known, recently URLs of\n[the type that previously served Qakbot started to serve IcedID instead.](https://www.malware-traffic-analysis.net/2021/02/22/index.html)\n\nThis suggests that it is another actor that handles the spam campaigns that delivers either\nmalware, an example of the increased commoditization of cybercrime. This would also\nexplain why the domains listed above are different from the IcedID command and control\n[domains I wrote about recently, which use a different hosting infrastructure.](https://silentpush.com/blog/icedid-command-and-control-infrastructure/7)\n\n### Ursnif and phishing\n\nA third set of domains also cycled through a set of IP addresses:\n\n\n-----\n\n```\naodacrtsrytuce[.]com\nashguq[.]com\nchonlinedocstorage[.]com\ncompanieshdocstorage-online[.]com\ndocusign-cloudab[.]com\ndocusign-cloudbc[.]com\ndocusign-cloudcd[.]com\ndocusign-cloud[.]com\ndocusign-vault[.]com\nedssrdsceaaorb[.]com\nexhssppceaaorb[.]com\nhutnspiekeagrm[.]com\nioqpuyfshaio[.]com\nipqweyb[.]com\njyohjdowprwiondotrbkght[.]com\nnbmipqw[.]com\nospzsiq[.]com\nqpofsgw[.]com\nrconalacrtnspi[.]com\nrvprmsrirdeala[.]com\nsrirdelehssfaojr[.]com\nsrtnserqdelaeh[.]com\nuidacrtsppxece[.]com\nuiwoqp[.]com\nupsdocstorage[.]com\nupsdocstorage-online[.]com\nvcavwq[.]com\nwvmiap[.]com\nzhdipqw[.]com\n\n```\nThe IP addresses in this case are:\n```\n188.227.58[.]120\n45.143.136[.]43\n188.227.86[.]64\n91.203.192[.]117\n35.228.188[.]33\n35.246.93[.]71\n35.228.88[.]152\n\n```\nAll these domains were registered through Eranet, a registrar based in Hong Kong, and\nagain used DNSPod’s nameservers. Two of the IP addresses, marked in bold, were also\nused by the Magecart domains, suggesting a possible link.\n\nInterestingly, there are two kinds of domains in the list. One the one hand, there are random\nlooking domains which, as with the IcedID/Qakbot domains above, could suggest a domain\ngeneration algorithm (DGA). On the other hand, domains like docusign-cloud[.]com and\nupsdocstorage[.]com of which one can be all but certain they have been used in phishing\ncampaigns: both DocuSign and UPS are commonly used in phishing lures.\n\nIt is not surprising therefore that these latter domains were taken down, often within a week\nafter becoming active: lookalike domains are actively hunted by the affected organisations.\n\n\n-----\n\n[As for the DGA-like domains, one of them, uidacrtsppxece[.]com, has been linked to Ursnif,](https://urlhaus.abuse.ch/url/991115/)\nanother common malware delivered in email campaigns.\n\nIt is unclear whether there is a direct link between Ursnif and the phishing domains beyond\nthe use of the same infrastructure, or even whether all DGA-like domains have served\nUrsnif.\n\n### Other domains\n\nThere are many other domains that have used the same infrastructure, including the use of\nthe DNSPod DNS provider.\n\nFor example, the domains\n```\nie-kbc[.]net\nie-kbc[.]org\nkbc-ie[.]net\nwww.kbcbanking[.]net\n\n```\nwill no doubt have been used to impersonate KBC, an Irish bank, while authoriseeebilling[.]com has likely targeted customers of UK mobile provider EE. There are also\nseveral more domains that suggest a DGA.\n\n### Conclusion: a bulletproof hosting provider?\n\nThe similarities among the various sets described above, such as the use of DNSPod and\nthe sharing of IP addresses, suggests the campaigns described all use the same\ninfrastructure, likely that of a bulletproof hosting service.\n\nA bulletproof hoster serves a similar function as a content-delivery network (CDN) does for\nlegitimate domains: making it harder for a denial-of-service attack. The “attack” in this case\nwould come from law enforcement and security researchers.\n\nIn the past, bulletproof hosters ran their own networks, which often led to the whole ASN\nbeing blocklisted. More modern bulletproof hosters rent servers at cloud providers and set\nthese up as proxies for their customers’ content. By rotating through a set of IP addresses,\nthe content is less vulnerable to being blocked based on the IP address.\n\n[Intel471 recently wrote about bulletproof hosters and in particular mentioned DNSPod.](https://intel471.com/blog/bulletproof-hosting-fast-flux-dns-double-flux-vps/)\n\nOf course, we cannot be 100% certain that this is a bulletproof hoster, or even that the\nvarious campaigns do use the same infrastructure: the sharing of IP addresses may be a\ncoincidence, or because there is another party involved in renting the servers.\n\nBut this is yet another example that shows how understanding the context of a domain\nname can help one find a lot of related infrastructure that is worth blocking, even without\nhaving seen evidence of actual malicious activity.\n\n\n-----\n\n## Subscribe\n\nSign up with your email address to receive news and updates.\n\nWe respect your privacy.\n\nThank you!\n\n[Ken Bagnall](http://10.10.0.46/blog?author=6081bc3c4920d358398731f8)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-04-13 - Malicious infrastructure as a service.pdf"
    ],
    "report_names": [
        "2021-04-13 - Malicious infrastructure as a service.pdf"
    ],
    "threat_actors": [
        {
            "id": "5a0483f5-09b3-4673-bb5a-56d41eaf91ed",
            "created_at": "2023-01-06T13:46:38.814104Z",
            "updated_at": "2025-03-27T02:00:02.925972Z",
            "deleted_at": null,
            "main_name": "MageCart",
            "aliases": [],
            "source_name": "MISPGALAXY:MageCart",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "3fff98c9-ad02-401d-9d4b-f78b5b634f31",
            "created_at": "2023-01-06T13:46:38.376868Z",
            "updated_at": "2025-03-27T02:00:02.818071Z",
            "deleted_at": null,
            "main_name": "Cleaver",
            "aliases": [
                "Cobalt Gypsy",
                "G0003",
                "Operation Cleaver",
                "Op Cleaver",
                "Tarh Andishan",
                "Alibaba",
                "TG-2889"
            ],
            "source_name": "MISPGALAXY:Cleaver",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673535715,
    "ts_updated_at": 1743041674,
    "ts_creation_date": 1655092869,
    "ts_modification_date": 1655092869,
    "files": {
        "pdf": "https://archive.orkl.eu/53fd9a868d0d01f3b7b846bda75827725d92c82f.pdf",
        "text": "https://archive.orkl.eu/53fd9a868d0d01f3b7b846bda75827725d92c82f.txt",
        "img": "https://archive.orkl.eu/53fd9a868d0d01f3b7b846bda75827725d92c82f.jpg"
    }
}