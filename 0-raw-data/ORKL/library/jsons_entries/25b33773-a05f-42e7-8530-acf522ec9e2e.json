{
    "id": "25b33773-a05f-42e7-8530-acf522ec9e2e",
    "created_at": "2022-10-25T16:48:24.255588Z",
    "updated_at": "2025-03-27T02:16:25.915356Z",
    "deleted_at": null,
    "sha1_hash": "c84fe736d1ea483428b66781fc2cd4c64cbeb7b1",
    "title": "PowerPoint Presentation",
    "authors": "",
    "file_creation_date": "2015-10-10T08:33:35Z",
    "file_modification_date": "2015-10-10T08:33:35Z",
    "file_size": 825242,
    "plain_text": "# The Real Shim Shady\n\n###### William Ballenthin, FireEye\n\n Jonathan Tomczak, Mandiant\n\n\n-----\n\n## Bio, plan\n\n#### ÔÇß William Ballenthin, Reverse Engineer\n\n###### - FLARE (FireEye Labs Advanced Reverse Engineering) team\n\n - Malware analysis, forward and backward engineering\n\n#### ÔÇß Jonathan Tomczak, Consultant\n\n###### - Mandiant Professional Services\n\n - Incident response, forensics, tool development\n\n#### ÔÇß Todays Topic: Case Study and Investigative Techniques for Hijacked\n Application Compatibility Infrastructure.\n\n\n-----\n\n## Put out the Fire! \n\n#### ÔÇß Working the malware triage queue, encountered interesting situation:\n\n###### - Client targeted by phishing emails\n\n - Large deployment FireEye boxes didn‚Äôt fire\n\n - Malware maintained persistence, somehow\n\n#### ÔÇß What‚Äôs going on? How to fix detection & investigative methodology?\n\n\n-----\n\n## DLL Injection via Shims\n\n#### ÔÇß Malware: self-extracting RAR \n\n    drops KORPLUG launcher (elogger.dll)\n\n    loading shellcode backdoor (elogger.dat)\n\n ÔÇß elogger.dat does a little of everything: manually loads PE payload,\n injects, privesc, installs service, HTTP protocol\n\n ÔÇß Also, installs an ACI shim:\n\n###### - Writes two (32/64-bit) hardcoded, embedded SDB files to disk\n\n - Invokes sdbinst.exe\n\n\n-----\n\n## WHAT‚ÄôS THE ACI?\n### What are shims and why are they on my system?\n\n\n-----\n\n## Application Compatibility Infrastructure\n\n#### ÔÇß Manages and resolves application compatibility issues with updates to\n Microsoft Windows\n\n ÔÇß Configured via freely available Application Compatibility Toolkit (ACT)\n\n ÔÇß API hooking (& more) built into the executable Loader\n\n###### - ‚ÄúShims‚Äù typically implemented as code (DLLs) or configuration (disable feature)\n\n - Shims described by databases (SDB files) indicating source and target\n\n - SDBs registered with the OS, queried by loader\n\n\n-----\n\n## Application Compatibility Infrastructure, II\n\n#### ÔÇß Targets specified by executable file metadata, including:\n\n###### - Filename\n\n - PE checksum\n\n - File size\n\n - Version info fields, etc.\n\n#### ÔÇß Lots of shims to play with\n\n###### - Dozens of preconfigured quickfixes (redirect file reads, change heap behavior)\n\n - Thousands of SDB entries distributed by MS\n\n - Some undocumented features\n\n EMET ACI t i j t it DLL i t ti\n\n\n-----\n\n## SDB contents\n```\n  <EXE>\n   <NAME type='stringref'>OREGON32.EXE</NAME>              \n   <APP_NAME type='stringref'>The Oregon Trail v1.2</APP_NAME>\n   <VENDOR type='stringref'>Minnesota Educational Computing Corp.</VENDOR>\n   <EXE_ID type='hex'>568058f1-da4f-4105-8f72-edd5d2a4aaf3</EXE_ID>\n     <APP_ID type='hex'>82f31111-af62-4849-b866-14c4e748e33c</APP_ID>\n   <MATCH_MODE type='integer'>0x2</MATCH_MODE>\n   <MATCHING_FILE>\n     <NAME type='stringref'>OREGON32.DLL</NAME>\n   </MATCHING_FILE>\n   <SHIM_REF>\n     <NAME type='stringref'>EmulateGetDiskFreeSpace</NAME>\n     <SHIM_TAGID type='integer'>0x23298</SHIM_TAGID>\n   </SHIM_REF>\n   </EXE>\n\n```\n\n-----\n\n## SHIM TECHNIQUES\n### Shim development, creation, and deployment\n\n\n-----\n\n## The Application Compatibility Toolkit\n\n\n-----\n\n## SDB deployment\n\n### ÔÇß sdbinst.exe registers SDB files with operating system\n\n#### - Creates uninstallation entries in the control panel\n\n - Add values to Registry keys:\n\n###### ‚Ä¢ HKLM\\SOFTWARE\\Microsoft\\Windows\n```\n      NT\\CurrentVersion\\AppCompatFlags\\Custom\n\n ‚Ä¢ HKLM\\SOFTWARE\\Microsoft\\Windows\n      NT\\CurrentVersion\\AppCompatFlags\\InstalledSDB\n\n#### ÔÇß Microsoft recommends packaging in an MSI and deploying via GPO\n\n ÔÇß Directly adding the Registry values circumvent sdbinst.exe and extra\n control panel entries\n\n```\n\n-----\n\n## Fun shims\n\n#### Shim Name Purpose\n\n DisableWindowsDefender ‚ÄúThe fix disables Windows Defender for\n###### security applications that do not work with Windows Defender.‚Äù\n\n#### CorrectFilePaths Redirect file system paths\n\n LoadLibraryRedirectFlag Change load directory of DLLs\n\n NoSignatureCheck ??? ÔÅä\n\n RelaunchElevated Ensure an EXE runs as admin\n\n TerminateExe ??? ÔÅä\n\n VirtualRegistry Registry redirection and expansion\n\n|Shim Name|Purpose|\n|---|---|\n|DisableWindowsDefender|‚ÄúThe fix disables Windows Defender for security applications that do not work with Windows Defender.‚Äù|\n|CorrectFilePaths|Redirect file system paths|\n|LoadLibraryRedirectFlag|Change load directory of DLLs|\n|NoSignatureCheck|??? ÔÅä|\n|RelaunchElevated|Ensure an EXE runs as admin|\n|TerminateExe|??? ÔÅä|\n\n\n-----\n\n## Trick 1: DLL Injection via shims (seen in wild)\n\n#### ÔÇß Self-extracting RAR \n\n    drops KORPLUG launcher (elogger.dll)\n\n    loading shellcode backdoor (elogger.dat)\n\n ÔÇß elogger.dat does some of everything: manually loads PE payload,\n injects, privesc, installs service, HTTP protocol\n\n ÔÇß Also, installs an ACI shim:\n\n###### - Writes two (32/64-bit) hardcoded, embedded SDB files to disk\n\n - Invokes sdbinst.exe\n\n\n-----\n\n## SDB contents\n```\n <DATABASE><NAME type='stringref'>Brucon_Database</NAME>\n  <DATABASE_ID type='guid'>503ec3d4-165b-4771-b798-099d43b833ed</DATABASE_ID>\n  <LIBRARY> <SHIM>\n    <NAME type='stringref'>Brucon_Shim</NAME>\n    <DLLFILE type='stringref'>Custom\\elogger.dll</DLLFILE>\n  </SHIM></LIBRARY>\n  <EXE>\n   <NAME type='stringref'>svchost.exe</NAME>\n   <APP_NAME type='stringref'>Brucon_Apps</APP_NAME>\n   <EXE_ID type='hex'>e8cc2eb6-469d-43bc-9d6a-de089e497303</EXE_ID>\n   <MATCHING_FILE><NAME type='stringref'>*</NAME></MATCHING_FILE>\n   <SHIM_REF><NAME type='stringref'>Brucon_Shim</NAME></SHIM_REF>\n  </EXE></DATABASE>\n\n```\n\n-----\n\n## Analysis\n\n#### ÔÇß Persistence configured via opaque file format\n\n ÔÇß Hardcoded SDB file easily sig-able via filenames, IDs\n\n###### - Payload file exists in the clear, in very limited set of directories\n\n ‚Ä¢ C:\\Windows\\AppPatch\\Custom\\\n\n ‚Ä¢ C:\\Windows\\AppPatch\\Custom\\Custom64\\\n\n#### ÔÇß FireEye identified filename elogger.dll often reused in KORPLUG &\n SOGU campaigns.\n\n\n-----\n\n## Trick 2: Argument replacement via shims (seen in lab)\n\n#### ÔÇß CorrectFilePath fix redirects arguments from the application‚Äôs path to\n an attacker‚Äôs specified path\n\n###### - Trivial to hook into CreateProcess, WinExec, ShellExecute\n\n#### ÔÇß Custom program mine.exe, launches C:\\windows\\temp\\1.exe\n\n###### - Add shim: redirects C:\\windows\\temp\\1.exe to C:\\dump\\1.exe\n\n - CorrectFilePath: ‚ÄúC:\\windows\\temp\\1.exe; C:\\dump\\1.exe‚Äù\n\n\n-----\n\n## SDB contents\n```\n <DATABASE><TIME type='integer'>0x1d100fac0a4a7fc</TIME>\n  <NAME type='stringref'>minesdb</NAME>\n  <DATABASE_ID type='guid'>\n    2840a82e-91ff-4f29-bff2-fd1e9780b6eb</DATABASE_ID>\n  <EXE>\n   <APP_NAME type='stringref'>mine.exe</APP_NAME>\n   <MATCHING_FILE><NAME type='stringref'>*</NAME></MATCHING_FILE>\n   <SHIM_REF>\n    <NAME type='stringref'>CorrectFilePaths</NAME>\n    <COMMAND_LINE type='stringref'>\n     \"C:\\Windows\\Temp\\1.exe; C:\\dump\\1.exe‚Äú\n     </COMMAND_LINE>\n   </SHIM_REF></EXE></DATABASE>\n\n```\n\n-----\n\n## Trick 2: Argument replacement via shims, II\n\n#### ÔÇß Analysis:\n\n###### - Consider the targeted process is cmd.exe\n\n ‚Ä¢ Hidden persistence, MITM of process creation\n\n ‚Ä¢ #DFIR confusion\n\n - Configured via opaque file format\n\n - Payload not limited to specific directories\n\n\n-----\n\n## Trick 3: Shellcode injection via shims (seen in wild)\n\n#### ÔÇß Phishing email leads to dropper\n\n    dropper installs template SDB and modifies them dynamically\n\n SDB declares shellcode that it injects on executable load\n\n    payload is a downloader for other stages\n\n ÔÇß First identified by TrendMicro‚Ä¶\n\n\n-----\n\n## SDB contents\n```\n <DATABASE><NAME type='stringref'>opera.exe</NAME>\n  <DATABASE_ID>\n     538f5e1c-932e-4426-b1c9-60a6e15bcd7f</DATABASE_ID>\n  <LIBRARY><SHIM_REF><PATCH>\n     <NAME type='stringref'>patchdata0</NAME>\n     <PATCH_BITS type='hex'>040000c‚Ä¶0000000000000000</PATCH_BITS>\n  </PATCH></SHIM_REF></LIBRARY>\n  <EXE><APP_NAME type='stringref'>opera.exe</APP_NAME>\n   <MATCHING_FILE><NAME>opera.exe</NAME></MATCHING_FILE>\n   <PATCH_REF>\n    <NAME type='stringref'>patchdata0</NAME>\n    <PATCH_TAGID type='integer'>0x6c</PATCH_TAGID>\n   </PATCH_REF></EXE></DATABASE>\n\n```\n\n-----\n\n## PATCH_BITS\n\n### ÔÇß Windows loader writes arbitrary bytes into module memory\n\n#### - PATCH_MATCH to verify target of memory write\n\n - PATCH_REPLACE stamps in raw bytes\n\n - Can target both EXE and DLL modules\n\n\n-----\n\n## Patch details\n```\n 00000000 (04)  opcode: PATCH_MATCH\n 0000000c (04)  rva: 0x00053c2e\n 00000014 (64)  module_name:\n u'kernel32.dll'\n 00000054 (05)  pattern: 9090909090\n  disassembly:\n   0x53c2e: nop \n   0x53c2f: nop \n   0x53c30: nop \n   0x53c31: nop \n    0 53c32 nop\n\n```\n```\n00000000 (04)  opcode: PATCH_REPLACE\n0000000c (04)  rva: 0x00053c2e\n00000014 (64)  module_name:\nu'kernel32.dll'\n00000054 (07)  pattern: e8321a0700ebf9\n disassembly:\n  0x53c2e: call 0x000c5665\n  0x53c33: jmp 0x00053c29\n\n```\n\n-----\n\n## Patch details, II\n```\n00000000 (04)  opcode: PATCH_MATCH 00000000 (04)  opcode: PATCH_REPLACE\n\n```\n```\n0000000c (04)  rva: 0x000c5665\n00000014 (64)  module_name:\nu'kernel32.dll'\n00000054 (08)  pattern:\n0000000000000000\n\n```\n```\n0000000c (04)  rva: 0x000c5665\n00000014 (64)  module_name: u'kernel32.dll'\n00000054 (14)  pattern:\n83042402609ce8030000009d61c3\n disassembly:\n  0xc5665: add dword [esp],2\n  0xc5669: pushad \n  0xc566a: pushfd \n  0xc566b: call 0x000c566d\n  0xc5670: popfd \n  0xc5671: popad\n\n```\n\n-----\n\n## Patch details, III\n```\n     < Multi-kilobyte shellcode downloader >\n\n```\n\n-----\n\n## Patch details, summary\n\n\n#### Legit Call\n\n\n#### Legit Code\n\n\n#### Legit Call\n\n\n-----\n\n## Patch details, summary\n\n#### Hook\n\n\n#### Legit Call\n\n\n#### Legit Call\n\n\n#### Legit Code\n\n\n#### Legit Call\n\n\n-----\n\n## Patch details, summary\n\n\n#### Trampoline\n\n Legit Call\n\n\n#### Legit Call\n\n\n#### Legit Code\n\n\n#### Legit Call\n\n\n-----\n\n## Patch details, summary\n\n\n#### Legit Call\n\n\n#### Legit Call\n\n\n#### Fetch & exec Legit Code\n backdoor\n\n\n-----\n\n## Patch details, summary\n\n\n#### Return to trampoline\n\n Legit Call\n\n\n#### Legit Call\n\n\n#### Legit Code\n\n\n-----\n\n## Patch details, summary\n\n#### Kernel32.dll\n\n Return to legit code\n\n\n#### Legit Call\n\n\n#### Legit Call\n\n\n#### Legit Code\n\n\n#### Legit Call\n\n\n#### Legit Call\n\n\n-----\n\n## Patch details, summary\n\n\n#### Legit Call\n\n\n#### Legit Call\n\n\n#### Legit Code\n\n\n#### Legit Call\n\n\n-----\n\n## Analysis\n\n#### ÔÇß Persistence & injection by MS infrastructure!\n\n ÔÇß External storage of shellcode in opaque format\n\n ÔÇß Dynamic modification of SDB files from template\n\n###### - Generates unique GUIDs for database ID\n\n - Extensible payloads\n\n - PATCH_BYTES not documented\n\n\n-----\n\n## FLYING THROUGH THE MATRIX\n### Understanding SDB files\n\n\n-----\n\n## SDB file format\n\n#### ÔÇß The SDB file format is an undocumented Microsoft format\n\n###### - apphelp.dll exposes ~254 exports for manipulating shims\n\n - That doesn‚Äôt help for forensic analysis!\n\n\n-----\n\n## SDB file format, II\n\n#### ÔÇß So, we reverse engineered it\n\n ÔÇß Conceptually, like an indexed XML document\n\n###### - Three main nodes: the index, the database structure, and a string table\n\n - No compression, encryption, signatures, nor checksums\n\n\n-----\n\n## Consider the scenario\n\n###### ÔÇß Shim definition: name & shim action\n```\n  <LIBRARY> <SHIM>\n    <NAME type='stringref'>Brucon_Shim</NAME>\n    <DLLFILE type='stringref'>Custom\\elogger.dll</DLLFILE>\n  </SHIM></LIBRARY>\n\n ÔÇß Application definition: target & shim pointer\n  <NAME type='stringref'>svchost.exe</NAME>\n  <APP_NAME type='stringref'>Brucon_Apps</APP_NAME>\n  <SHIM_REF>\n   <NAME type='stringref'>Brucon_Shim</NAME>\n   <SHIM_TAGID type='integer'>0x47c</SHIM_TAGID>\n  </SHIM REF>\n\n```\n\n-----\n\n## python sdb\n\n#### ÔÇß Some tools exist for unpacking SDB files\n\n###### - But they rely on the Windows API\n\n#### ÔÇß python-sdb is a cross platform, pure Python library for parsing SDBs\n\n###### - Python API makes it easy to build scripts that inspect SDB features\n\n - Provided sample scripts dump database as various XML flavors\n\n#### ÔÇß https://github.com/williballenthin/python-sdb\n\n\n-----\n\n## DETECTION METHODOLOGY\n### Investigating malicious shims at scale in a large environment\n\n\n-----\n\n## Consider the scenario\n\n### ÔÇß Trojan.mambashim\n\n###### - Python (what, just read the source!?!)\n\n - Obfuscated bytecode\n\n - Installs service, or uses ctypes to dynamically create sdb and install\n\n - sdb causes Windows loader to inject DLL payload launcher into putty44.exe\n\n#### Would you have any idea this was happening to your environment?\n\n\n-----\n\n## Existing administrative tools?\n\n#### ÔÇß Fact: Trojan.mambashim generates random sdb path using a dictionary\n of English words, installs using sdbinst.exe\n\n ÔÇß ACI Fails:\n\n ÔÇß No central management for SDBs on a system\n\n ÔÇß No Active Directory tools for SDB management \n\n ÔÇß No accounting of ACI changes or rollback features\n\n ÔÇß Win?\n\n ÔÇß Maybe catch sdbinst.exe via process auditing?\n\n\n-----\n\n## ACI Integrity checking?\n\n#### ÔÇß SDB files are not signed ÔÅå\n\n ÔÇß Whitelisting SDBs by hash does not work\n\n ÔÇß eg. collection across 6,000 hosts yields 18,000 unique SDB files\n\n ÔÇß Embedded timestamps and installation order affect SDB integrity checks\n\n ÔÇß If Office is installed before Visual Studio, and then vice versa on\n another system, it may result in a different SDB.\n\n\n-----\n\n## Mass inspection & anomaly detection\n\n#### ÔÇß Acquire, inspect %systemdrive%\\*.sdb\n\n ÔÇß Legitimate SDBs typically reside in Windows and Program Files\n\n ÔÇß Attacker SDBs found in %USERSPROFILE%, working directories\n\n ÔÇß Acquire, inspect\n\n###### ÔÇß HKLM\\SOFTWARE\\Microsoft\\Windows\n```\n      NT\\CurrentVersion\\AppCompatFlags\\Custom\n\n ÔÇß HKLM\\SOFTWARE\\Microsoft\\Windows\n      NT\\CurrentVersion\\AppCompatFlags\\InstalledSDB\n\n#### ÔÇß Default sdbs: drvmain, frxmain, msimain, pcamain, sysmain\n\n```\n\n-----\n\n## Mass inspection & anomaly detection\n\n### ÔÇß Trojan.mambashim\n\n#### - Random header timestamp (range 0-max int64 (!!!)) üëç\n\n - Random compiler version (rand.rand.rand.rand) üëç\n\n - EXE vendor name vendor üëç\n\n - Random database ID (well, it‚Äôs a GUID‚Ä¶) üëç\n\n - Random EXE ID (also GUID‚Ä¶) üëç\n\n### ÔÇß But, blacklist won‚Äôt scale\n\n ÔÇß Good for hunting, not fire and forget\n\n\n-----\n\n## Mass inspection & anomaly detection, II\n```\nMicrosoft-Windows-Application-Experience-Program-Telemetry.evtx\nCompatibility fix applied to C:\\PROGRAM FILES\\Putty\\putty44.exe.\nFix information: vendor, {7e4053fe-ade9-426f-9dc2-0bbfa76b5366},\n0x80010156.\n\n### ÔÇß Do you have technology that can detect ‚Äúunusual entries‚Äù?\n\n#### - Count tuple (hostname, vendor, application) & sort ASC\n\n - Alert on new tuples?\n\n```\n\n-----\n\n## Domain specific hashing\n\n#### ÔÇß Realistically, Trojan.mambashim could be much nastier.\n\n ÔÇß We don‚Äôt expect blacklisting to scale, that‚Äôs just playing catch up\n\n ÔÇß We really want to whitelist:\n\n###### ÔÇß But, can‚Äôt whitelist entire files by hash (see earlier)\n\n ÔÇß Can hash shim & application definitions\n\n ÔÇß Don‚Äôt expect these to change\n\n ÔÇß Use this to build a whitelist!\n\n ÔÇß shims_hash_shims.py\n\n\n-----\n\n## Prepare for this scenario\n\n# ÔÇß https://github.com/ganboing/sdb_packer\n\n#### ÔÇß Extract existing legit sysmain.sdb\n\n ÔÇß Add new shim for explorer.exe, etc.\n\n ÔÇß Payload: keylog data & shellcode that does exfil\n\n ÔÇß Re-pack sysmain.sdb\n\n ÔÇß Deploy\n\n ÔÇß ???\n\n ÔÇß Profit\n\n\n-----\n\n## Shims are real. Don t get shimmed.\n\n### ÔÇß Both targeted and commodity threats are actively using ACI shims\n\n ÔÇß There is no existing infrastructure for detection\n\n ÔÇß Consider the risk\n\n ÔÇß You are now the front line.\n\n\n-----\n\n## Prior work\n\n##### ÔÇß ‚ÄúPersist It - Using and Abusing Microsoft Fix It Patches‚Äù - Jon Erickson/iSIGHT\n @ BH ‚Äô14\n\n[https://www.blackhat.com/docs/asia-14/materials/Erickson/Asia-14-Erickson-Persist-It-Using-And-Abusing-Microsofts-Fix-It-](https://www.blackhat.com/docs/asia-14/materials/Erickson/Asia-14-Erickson-Persist-It-Using-And-Abusing-Microsofts-Fix-It-Patches.pdf)\n[Patches.pdf](https://www.blackhat.com/docs/asia-14/materials/Erickson/Asia-14-Erickson-Persist-It-Using-And-Abusing-Microsofts-Fix-It-Patches.pdf)\n\n##### ÔÇß ‚ÄúShim: A new method of injection‚Äù (in Russian)\n\n[ftp://os2.fannet.ru/fileechoes/programming/XA_159.PDF](ftp://os2.fannet.ru/fileechoes/programming/XA_159.PDF)\n\n##### ÔÇß ‚ÄúRoaming Tiger‚Äù - Anton Cherepanov/ESET @ ZeroNights ‚Äô14\n\n###### http://2014.zeronights.org/assets/files/slides/roaming_tiger_zeronights_2014.pdf\n\n##### ÔÇß ‚ÄúWindows - Owned By Default!‚Äù ‚Äì Mark Baggett @ DerbyCon 2013\n\n ÔÇß ‚ÄúCompatibility Fix Descriptions‚Äù - MSDN\n###### https://technet.microsoft.com/en-us/library/cc722305%28v=ws.10%29.aspx\n\n\n-----\n\n## THE END\n### Questions?\n\n\n-----\n\n## File Timestamp Indicators\n\n###### ÔÇß Filesystem created timestamp indicates installation of SDB to the system\n\n ÔÇß Windows Patch\n\n ÔÇß Application Install\n\n ÔÇß Malicious SDB that was pre-compiled before installation.\n\n ÔÇß Registry timestamps show installation timestamp\n\n ÔÇß Filesystem modified timestamp indicates that the SDB was recompiled.\n\n ÔÇß Windows Patch\n\n ÔÇß Application Install\n\n ÔÇß Malicious injection into an existing SDB such as sysmain.sdb\n\n\n-----\n\n## Notes on artifacts\n\n###### ÔÇß FireEye identified filename elogger.dll often reused in KORPLUG & SOGU campaigns.\n\n ÔÇß elogger.dll exports ShimMain and NotifyShims, which are undocumented shim entry points. Some KORPLUG loaders also export these without SOGU payloads referencing the ACI.\n\n ÔÇß ‚ÄúRoaming Tiger‚Äù (ESET) campaign distributed SDB files with similar naming schemes:\n\n|elogger.dat|‚ÄúRoaming Tiger‚Äù|\n|---|---|\n|Brucon_Shim|AcProtect_Shim|\n|Brucon_Apps|AcProtect_Apps|\n|Brucon_Database|AcProtect_Database|\n\n\n-----\n\n## Shim DLL exports\n\n###### Shim DLL export name Shim DLL export purpose\n```\n    SE_DllLoaded Callback during DLL load\n    SE_DLLUnloaded Callback during DLL unload\n    SE_DynamicShim Unknown\n    SE_GetProcAddress Callback during\n                     GetProcAddress\n    SE_InstallAfterInit Callback after shim\n                     complete\n    SE_InstallBeforeInit Callback before shim\n                     application\n    SE_IsShimDLL Callback when shimming shim\n                     DLL\n    SE Process Callback when EXE exiting\n\n```\n|Shim DLL export name|Shim DLL export purpose|\n|---|---|\n|SE_DllLoaded|Callback during DLL load|\n|SE_DLLUnloaded|Callback during DLL unload|\n|SE_DynamicShim|Unknown|\n|SE_GetProcAddress|Callback during GetProcAddress|\n|SE_InstallAfterInit|Callback after shim complete|\n|SE_InstallBeforeInit|Callback before shim application|\n|SE_IsShimDLL|Callback when shimming shim DLL|\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "99fdc3ef-333d-48f5-a4a1-becd788c7b80",
            "created_at": "2022-10-25T15:28:29.802983Z",
            "updated_at": "2022-10-25T15:28:29.802983Z",
            "deleted_at": null,
            "name": "MITRE",
            "url": "https://github.com/mitre-attack/attack-stix-data",
            "description": "MITRE ATT&CK STIX Data",
            "reports": null
        }
    ],
    "references": [
        "http://files.brucon.org/2015/Tomczak_and_Ballenthin_Shims_for_the_Win.pdf"
    ],
    "report_names": [
        "Tomczak_and_Ballenthin_Shims_for_the_Win.pdf"
    ],
    "threat_actors": [
        {
            "id": "5afe7b81-e99a-4c24-8fcc-250fb0cf40a3",
            "created_at": "2023-01-06T13:46:38.324616Z",
            "updated_at": "2025-03-27T02:00:02.805194Z",
            "deleted_at": null,
            "main_name": "Roaming Tiger",
            "aliases": [
                "BRONZE WOODLAND",
                "Rotten Tomato"
            ],
            "source_name": "MISPGALAXY:Roaming Tiger",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "866c0c21-8de3-4ad5-9887-cecd44feb788",
            "created_at": "2022-10-25T16:07:24.130298Z",
            "updated_at": "2025-03-27T02:02:10.117603Z",
            "deleted_at": null,
            "main_name": "Roaming Tiger",
            "aliases": [
                "Bronze Woodland",
                "CTG-7273",
                "Rotten Tomato"
            ],
            "source_name": "ETDA:Roaming Tiger",
            "tools": [
                "Agent.dhwf",
                "AngryRebel",
                "BBSRAT",
                "Destroy RAT",
                "DestroyRAT",
                "Farfli",
                "Gh0st RAT",
                "Ghost RAT",
                "Kaba",
                "Korplug",
                "Moudour",
                "Mydoor",
                "PCRat",
                "PlugX",
                "RedDelta",
                "Sogu",
                "TIGERPLUG",
                "TVT",
                "Thoper",
                "Xamtrav"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "9bf42584-ca17-47de-a902-3dd63d90b2f8",
            "created_at": "2024-05-01T02:03:08.005172Z",
            "updated_at": "2025-03-27T02:05:17.300423Z",
            "deleted_at": null,
            "main_name": "BRONZE WOODLAND",
            "aliases": [
                "Roaming Tiger ",
                "Rotten Tomato ",
                "CTG-7273 "
            ],
            "source_name": "Secureworks:BRONZE WOODLAND",
            "tools": [
                " PlugX",
                " Zbot",
                "Appat"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "75108fc1-7f6a-450e-b024-10284f3f62bb",
            "created_at": "2024-11-01T02:00:52.756877Z",
            "updated_at": "2025-03-27T02:00:55.544216Z",
            "deleted_at": null,
            "main_name": "Play",
            "aliases": null,
            "source_name": "MITRE:Play",
            "tools": [
                "Nltest",
                "AdFind",
                "PsExec",
                "Wevtutil",
                "Cobalt Strike",
                "Playcrypt",
                "Mimikatz"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1666716504,
    "ts_updated_at": 1743041785,
    "ts_creation_date": 1444466015,
    "ts_modification_date": 1444466015,
    "files": {
        "pdf": "https://archive.orkl.eu/c84fe736d1ea483428b66781fc2cd4c64cbeb7b1.pdf",
        "text": "https://archive.orkl.eu/c84fe736d1ea483428b66781fc2cd4c64cbeb7b1.txt",
        "img": "https://archive.orkl.eu/c84fe736d1ea483428b66781fc2cd4c64cbeb7b1.jpg"
    }
}