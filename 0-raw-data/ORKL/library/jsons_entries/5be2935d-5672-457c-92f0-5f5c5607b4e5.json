{
    "id": "5be2935d-5672-457c-92f0-5f5c5607b4e5",
    "created_at": "2023-01-12T15:04:51.141953Z",
    "updated_at": "2025-03-27T02:09:17.989479Z",
    "deleted_at": null,
    "sha1_hash": "91b22f8b38f3ef6bc4755d0bec20422b74696e27",
    "title": "2021-07-01 - Backdoored Client from Mongolian CA MonPass",
    "authors": "",
    "file_creation_date": "2022-08-18T03:43:38Z",
    "file_modification_date": "2022-08-18T03:43:38Z",
    "file_size": 1529227,
    "plain_text": "# Backdoored Client from Mongolian CA MonPass\n\n**[decoded.avast.io/luigicamastra/backdoored-client-from-mongolian-ca-monpass](https://decoded.avast.io/luigicamastra/backdoored-client-from-mongolian-ca-monpass)**\n\nby [Luigino Camastra, Igor Morgenstern and Jan VojtěšekJuly 1, 20218 min read](https://decoded.avast.io/luigicamastra/backdoored-client-from-mongolian-ca-monpass)\n\n## Introduction\n\n\nJuly 1, 2021\n\n\n[We discovered an installer downloaded from the official website of MonPass, a major](http://monpass.mn/)\ncertification authority (CA) in Mongolia in East Asia that was backdoored with Cobalt Strike\nbinaries. We immediately notified MonPass on 22 April 2021 of our findings and\nencouraged them to address their compromised server and notify those who downloaded\nthe backdoored client.\n\nWe have confirmed with MonPass that they have taken steps to address these issues and\nare now presenting our analysis.\n\nOur analysis beginning in April 2021 indicates that a public web server hosted by MonPass\nwas breached potentially eight separate times: we found eight different webshells and\nbackdoors on this server. We also found that the MonPass client available for download\nfrom 8 February 2021 until 3 March 2021 was backdoored.\n\nThis research provides analysis of relevant backdoored installers and other samples that\nwe found occurring in the wild. Also during our investigation we observed relevant research\nfrom NTT Ltd so some technical details or IoCs may overlap.\n\nAll the samples are highly similar and share the same pdb path:\n```\nC:\\Users\\test\\Desktop\\fishmaster\\x64\\Release\\fishmaster.pdb and the string:\n\n```\n\n-----\n\nFigure\n\n1: Pdb path and specific string\n\n## Technical details\n\nThe malicious installer is an unsigned PE file. It starts by downloading the legitimate version\nof the installer from the MonPass official website. This legitimate version is dropped to the\n```\nC:\\Users\\Public\\ folder and executed under a new process. This guarantees that the\n\n```\ninstaller behaves as expected, meaning that a regular user is unlikely to notice anything\nsuspicious.\n\nAdditional similar installers were also found in the wild, with SHA256 hashes:\n```\ne2596f015378234d9308549f08bcdca8eadbf69e488355cddc9c2425f77b7535\n\n```\nand `f21a9c69bfca6f0633ba1e669e5cf86bd8fc55b2529cd9b064ff9e2e129525e8 .`\n\nFigure 2: This image is not as innocent as it may seem.\nThe attackers decided to use steganography to transfer shellcode to their victims. On\nexecution, the malware downloads a bitmap image file from http://download.googleimages[.]ml:8880/download/37.bmp as shown in `figure 2 .`\n\n\n-----\n\nThe download is performed slightly unusually in two HTTP requests. The first request uses\nthe HEAD method to retrieve the Content-Length, followed by a second GET request to\nactually download the image. After the picture is downloaded, the malware extracts the\nencrypted payload as follows. The hidden data is expected to be up to 0x76C bytes.\nStarting with the 3rd byte in image data it copies each 4th byte. The resulting data\nrepresents an ASCII string of hexadecimal characters which is later decoded into their\nrespective binary values. These bytes are then XOR decrypted using the hardcoded key\n```\nmiat_mg, resulting in a Cobalt-Strike beacon.\n\n```\nWe have seen multiple versions of this backdoored installer, each with slightly modified\ndecryptors.\n\nIn version ( f21a9c69bfca6f0633ba1e669e5cf86bd8fc55b2529cd9b064ff9e2e129525e8 )\nthe XOR decryption was stripped.\n\nIn the version\n( e2596f015378234d9308549f08bcdca8eadbf69e488355cddc9c2425f77b7535 ) basic\nanti-analysis tricks were stripped. In Figure 3, you can see different time stamps and the\nsame rich headers.\n\nFigure 3: Timestamps\n\n\n-----\n\nFigure 4: Rich header.\nIn the backdoored installer we also observed some basic anti-analysis techniques used in\nan attempt to avoid detection. In particular, we observed checks for the number of\nprocessors using the `GetSystemInfo function, the amount of physical memory using the`\n```\nGlobalMemoryStatusEx function and the disk capacity using the\nIOCTL_DISK_GET_DRIVE_GEOMETRY IOCTL call. If any of the obtained values are\n\n```\nsuspiciously low, the malware terminates immediately.\n\nFigure 5: Anti-analysis techniques employed by the malware\n\nFigure 6: Anti-analysis technique testing for disk capacity\nOne of the samples\n( 9834945A07CF20A0BE1D70A8F7C2AA8A90E625FA86E744E539B5FE3676EF14A9 ) used a\ndifferent known technique to execute shellcode. First it is decoded from a list of UUIDs with\n\n\n-----\n\n`UuidFromStringA` API, then it is executed using `EnumSystemLanguageGroupsA .`\n\nFigure 7:Decoding list from UUIDs and executing shellcode.\nAfter we found a backdoored installer in one of our customers, we commenced hunting for\nadditional samples in VT and in our user-base, to determine if there were more backdoored\ninstallers observed in the wild. In VT we found some interesting hits:\n\nFigure 8: VT hit\nWe analyzed the sample and found out that the sample was very similar to infected\ninstallers found in our customers. The sample contained anti-analysis techniques using the\nsame XOR decryption and also contained similar C2 server addresses\n( hxxp://download.google-images.ml:8880/download/x37.bmp ) as observed in\nprevious backdoored installers. The sample also contained references to the link\n( hxxps://webplus-cn-hongkong-s-5faf81e0d937f14c9ddbe5a0.oss-cn```\nhongkong.aliyuncs[.]com/Silverlight_ins.exe ) and the file path\nC:\\users\\public\\Silverlight_ins.exe ; however these did not appear to be in use.\n\n```\nThe sample name is also unusual – `Browser_plugin (8).exe – we speculate that this`\nmay be a test sample uploaded by the actor.\n\nIn VT we saw another hash\n( 4a43fa8a3305c2a17f6a383fb68f02515f589ba112c6e95f570ce421cc690910 ) again\nwith the name `Browser_plugin.exe . According to VT this sample has been downloaded`\nfrom `hxxps://jquery-code.ml/Download/Browser_Plugin.exe . It was downloading a`\nPDF from `hxxp://37.61.205.212:8880/dow/Aili.pdf PDF file` `Aili.pdf.`\n\n\n-----\n\nFigure 9: Content of Aili.pdf.\n\nAfterwards it has the similar functionalities as previously mentioned samples from VT. That\nmeans it was downloading and decrypting Cobalt strike beacon from\n\n```\nhxxp://micsoftin us:2086/dow/83 bmp\n\n```\n\n-----\n\nIn our database we again found the similar sample but with the name `Browser_plugin`\n```\n(1).exe . This sample was downloaded from\nhxxp://37.61.205.212:8880/download/Browers_plugin.exe, we saw it on Feb 4,\n\n```\n2021. It doesn’t install any legitimate software, it just shows a MessageBox. It contains C&C\naddress ( hxxp://download.google-images.ml:8880/downloa/37.bmp ), (Note: there is\na typo in the directory name: downloa).\n\n## Compromised Web server content\n\nOn the breached web server, where you were able to download backdoored installer we\nfound two executables `DNS.exe`\n( 456b69628caa3edf828f4ba987223812cbe5bbf91e6bbf167e21bef25de7c9d2 ) and\nagain `Browser_plugin.exe`\n( 5cebdb91c7fc3abac1248deea6ed6b87fde621d0d407923de7e1365ce13d6dbe ).\n\n### DNS.exe\n\nIt downloads from ( hxxp://download.google-images.ml:8880/download/DNSs.bat )\nC&C server bat file, that is saved in `C:\\users\\public\\DNS.bat . It contains this script:`\n\nFigure 10: DNS.bat script\nIn the second part of the instance, it contains the similar functionality and the same address\nof C&C server as the backdoored installer that we mentioned earlier.\n\n### Browser_plugin.exe\n\n( 5cebdb91c7fc3abac1248deea6ed6b87fde621d0d407923de7e1365ce13d6dbe )\n\nThis sample is very similar to this one\n( 4a43fa8a3305c2a17f6a383fb68f02515f589ba112c6e95f570ce421cc690910 ) with the\nsame address of C&C server, but it doesn’t download any additional document.\n\n### C&C server analysis\n\nWe checked the malicious web server `hxxps://jquery-code.ml, from where`\n( 4A43FA8A3305C2A17F6A383FB68F02515F589BA112C6E95F570CE421CC690910 )\n```\nBrowser_plugin.exe has been downloading. The malicious web server looks identical to\n\n```\n\n-----\n\nthe legitimate one `https://code.jquery.com/ the difference is the certificate. The`\nlegitimate server `https://code.jquery.com is signed by Sectigo Limited while the`\nmalicious server is signed by Cloudflare, Inc.\n\nFigure 11: Comparing two sites\n\n## Conclusion\n\nThis blog post outlines our findings regarding the MonPass client backdoored with Cobalt\nStrike.\n\nIn our research we found additional variants on VirusTotal in addition to those we found on\nthe compromised MonPass web server.\n\nIn our analysis of the compromised client and variants, we’ve shown that the malware was\nusing steganography to decrypt Cobalt Strike beacon.\n\nAt this time, we’re not able to make attribution of these attacks with an appropriate level of\nconfidence. However it’s clear that the attackers clearly intended to spread malware to\nusers in Mongolia by compromising a trustworthy source, which in this case is a CA in\nMongolia.\n\nMost importantly, anyone that has downloaded the MonPass client `between 8 February`\n```\n2021 until 3 March 2021 should take steps to look for and remove the client and the\n\n```\nbackdoor it installed.\n\n[I would like to thank Jan Rubín for helping me with this research.](https://decoded.avast.io/author/janrubin/)\n\n## Timeline of communication:\n\nMarch 24. 2021 – Discovered backdoored installer\n[April 8. 2021 – Initial contact with Monpass through MN CERT/CC providing findings.](https://mncert.org/#/en/)\n\n\n-----\n\nApril 20. 2021 – MonPass shared a forensic image of an infected web server with\nAvast Threat Labs.\nApril 22. 2021 – Avast provided information about the incident and findings from the\nforensics image in a call with MonPass and MN CERT/CC.\nMay 3. 2021 – Avast followed up with MonPass in email. No response.\nMay 10. 2021 – Avast sent additional follow up email.\nJune 4, 2021 – MonPass replied asking for information already provided on April 22,\n2021.\nJune 14. 2021 – Follow up from Avast to MonPass, no response\nJune 29, 2021 – Final email to MonPass indicating our plans to publish with a draft of\nthe blog for feedback.\nJune 29, 2021 – Information from MonPass indicating they’ve resolved the issues and\nnotified affected customers.\nJuly 1, 2021 – Blog published.\n\n## Indicators of Compromise (IoC)\n\n[Repository: https://github.com/avast/ioc/tree/master/MpIncident](https://github.com/avast/ioc/tree/master/MpIncident)\nList of SHA256: [https://github.com/avast/ioc/blob/master/MpIncident/samples.sha256](https://github.com/avast/ioc/blob/master/MpIncident/samples.sha256)\n\n## Timeline of compilation timestamps:\n\n\ndate &\ntime\n(UTC)\n\nFeb 3,\n2021\n07:17:14\n\nFeb 26,\n2021\n07:16:23\n\nMar 1,\n2021\n07:56:04\n\nMar 4,\n2021\n02:22:53\n\nMar 12,\n2021\n06:25:25\n\n\nSHA256\n\n\n-----\n\nMar 16,\n2021\n02:25:40\n\nMar 18,\n2021\n06:43:24\n\nMar 26,\n2021\n08:17:29\n\nApr 6,\n2021\n03:11:40\n\n```\n5cebdb91c7fc3abac1248deea6ed6b87fde621d0d407923de7e1365ce13d6dbe\n\n```\n\n[Tagged asAPT,](https://decoded.avast.io/tag/apt/) [backdoor,](https://decoded.avast.io/tag/backdoor/) [CA,](https://decoded.avast.io/tag/ca/) [cobalt strike,](https://decoded.avast.io/tag/cobalt-strike/) [malware](https://decoded.avast.io/tag/malware/)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-07-01 - Backdoored Client from Mongolian CA MonPass.pdf"
    ],
    "report_names": [
        "2021-07-01 - Backdoored Client from Mongolian CA MonPass.pdf"
    ],
    "threat_actors": [
        {
            "id": "610a7295-3139-4f34-8cec-b3da40add480",
            "created_at": "2023-01-06T13:46:38.608142Z",
            "updated_at": "2025-03-27T02:00:02.87217Z",
            "deleted_at": null,
            "main_name": "Cobalt",
            "aliases": [
                "Cobalt Gang",
                "GOLD KINGSWOOD",
                "COBALT SPIDER",
                "G0080",
                "Mule Libra",
                "Cobalt Group"
            ],
            "source_name": "MISPGALAXY:Cobalt",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673535891,
    "ts_updated_at": 1743041357,
    "ts_creation_date": 1660794218,
    "ts_modification_date": 1660794218,
    "files": {
        "pdf": "https://archive.orkl.eu/91b22f8b38f3ef6bc4755d0bec20422b74696e27.pdf",
        "text": "https://archive.orkl.eu/91b22f8b38f3ef6bc4755d0bec20422b74696e27.txt",
        "img": "https://archive.orkl.eu/91b22f8b38f3ef6bc4755d0bec20422b74696e27.jpg"
    }
}