{
    "id": "e7123d9a-a862-456b-b80a-68e977b51658",
    "created_at": "2023-01-12T15:08:17.031052Z",
    "updated_at": "2025-03-27T02:17:27.562244Z",
    "deleted_at": null,
    "sha1_hash": "fbfd1519e02e672da50714118402a0f66c796a29",
    "title": "2019-09-18 - Tortoiseshell Group Targets IT Providers in Saudi Arabia in Probable Supply Chain Attacks",
    "authors": "",
    "file_creation_date": "2022-05-28T22:01:04Z",
    "file_modification_date": "2022-05-28T22:01:04Z",
    "file_size": 813832,
    "plain_text": "# Tortoiseshell Group Targets IT Providers in Saudi Arabia in Probable Supply Chain Attacks\n\n**[symantec.com/blogs/threat-intelligence/tortoiseshell-apt-supply-chain](https://www.symantec.com/blogs/threat-intelligence/tortoiseshell-apt-supply-chain)**\n\n\n-----\n\nThreat Hunter TeamSymantec\n\n## Previously undocumented group hits IT providers in the Middle East.\n\nA previously undocumented attack group is using both custom and off-the-shelf malware to\ntarget IT providers in Saudi Arabia in what appear to be supply chain attacks with the end goal\nof compromising the IT providers’ customers.\n\nThe group, which we are calling Tortoiseshell, has been active since at least July 2018.\nSymantec has identified a total of 11 organizations hit by the group, the majority of which are\nbased in Saudi Arabia. In at least two organizations, evidence suggests that the attackers\ngained domain admin-level access.\n\n\"#Tortoiseshell group uses custom malware, off-the-shelf tools, #livingofftheland techniques to\ncompromise victims https://symc.ly/2lV4Ovn\"\n[Click to Tweet](https://twitter.com/intent/tweet?text=%23Tortoiseshell%20group%20uses%20custom%20malware,%20off-the-shelf%20tools,%20%23livingofftheland%20techniques%20to%20compromise%20victims%20https://symc.ly/2lV4Ovn&via=threatintel&hashtags=undefined)\nAnother notable element of this attack is that, on two of the compromised networks, several\nhundred computers were infected with malware. This is an unusually large number of computers\nto be compromised in a targeted attack. It is possible that the attackers were forced to infect\nmany machines before finding those that were of most interest to them.\n\nWe have seen Tortoiseshell activity as recently as July 2019.\n\n## Custom tools\n\n[The unique component used by Tortoiseshell is a malware called Backdoor.Syskit. This is a](https://www.symantec.com/content/symantec/english/en/security-center/writeup.html/2019-082613-5549-99)\nbasic backdoor that can download and execute additional tools and commands. The actors\nbehind it have developed it in both Delphi and .NET.\n\nBackdoor.Syskit is run with the “-install” parameter to install itself. There are a number of minor\nvariations of the backdoor, but the primary functionality is the following:\n\nreads config file: %Windir%\\temp\\rconfig.xml\nwrites Base64 encoding of AES encrypted (with key \"fromhere\") version of the data in the\n\"url\" element of the XML to:\n\nHKEY_LOCAL_MACHINE\\software\\microsoft\\windows\\currentversion\\policies\\system\\Enablevmd\n\nThis contains the command and control (C&C) information.\n\n\n-----\n\nwrites Base64 encoding of AES encrypted (with key fromhere ) version of the result\nelement of the XML to:\n\nHKEY_LOCAL_MACHINE\\software\\microsoft\\windows\\currentversion\\policies\\system\\Sendvmd\n\nThis holds the later portion of the URL to append to the C&C for sending information to it.\n\ndeletes the config file\n\nThe malware collects and sends the machine’s IP address, operating system name and version,\nand Mac address to the C&C server using the URL in the Sendvmd registry key mentioned\nabove. Data sent to the C&C server is Base64 encoded.\n\nThe backdoor can receive various commands:\n\n\"kill_me\":\nstops the dllhost service and deletes %Windir%\\temp\\bak.exe\n\"upload \"\ndownloads from the URL provided by the C&C server\n\"unzip\"\nuses PowerShell to unzip a specified file to a specified destination, or to run cmd.exe /c\n<received command>\n\n## Tools, techniques, and procedures\n\nThe other tools used by the group are public tools, and include:\n\nInfostealer/Sha.exe/Sha432.exe\nInfostealer/stereoversioncontrol.exe\nget-logon-history.ps1\n\nInfostealer/stereoversioncontrol.exe downloads a RAR file, as well as the get-logon-history.ps1\ntool. It runs several commands on the infected machine to gather information about it and also\nthe Firefox data of all users of the machine. It then compresses this information before\ntransferring it to a remote directory. Infostealer/Sha.exe/Sha432.exe operates in a similar\nmanner, gathering information about the infected machine.\n\nWe also saw Tortoiseshell using other dumping tools and PowerShell backdoors.\n\nThe initial infection vector used by Tortoiseshell to get onto infected machines has not been\nconfirmed, but it is possible that, in one instance, a web server was compromised to gain access\nby the attacker. For at least one victim, the first indication of malware on their network was a\nweb shell (d9ac9c950e5495c9005b04843a40f01fa49d5fd49226cb5b03a055232ffc36f3). This\nindicates that the attackers likely compromised a web server, and then used this to deploy\nmalware onto the network.\n\n\n-----\n\nThis activity indicates the attackers had achieved domain admin level access on these\nnetworks, meaning they had access to all machines on the network.\n\nOnce on a victim computer, Tortoiseshell deploys several information gathering tools, like those\nmentioned above, and retrieves a range of information about the machine, such as IP\nconfiguration, running applications, system information, network connectivity etc.\n\nOn at least two victim networks, Tortoiseshell deployed its information gathering tools to the\nNetlogon folder on a domain controller. This results in the information gathering tools being\nexecuted automatically when a client computer logs into the domain. This activity indicates the\nattackers had achieved domain admin level access on these networks, meaning they had\naccess to all machines on the network.\n\n## Presence of OilRig tools\n\nIn one victim organization, we also saw a tool called Poison Frog deployed one month prior to\nthe Tortoiseshell tools. Poison Frog is a backdoor and a variant of a tool called BondUpdater,\nwhich was previously seen used in attacks on organizations in the Middle East. The tools were\nleaked on Telegram in April this year and are associated with the group known as APT34, aka\nOilrig.\n\nIt is unclear if the same actor deployed both the Poison Frog tool and the Tortoiseshell tools,\nhowever, given the gap in time between the two sets of tools being used, and without further\nevidence, the current assumption is that the activity is unrelated. If that is the case, this activity\ndemonstrates the interest from multiple attack groups in industries in this region. The Poison\nFrog tool also appears to have been leaked prior to deployment to this victim, so could be used\nby a group unrelated to APT34/Oilrig.\n\n## Attacker motives\n\nThe targeting of IT providers points strongly to these attacks being supply chain attacks, with the\nlikely end goal being to gain access to the networks of some of the IT providers’ customers.\nSupply chain attacks have been increasing in recent years, with a 78 percent increase in 2018,\n[as we covered in ISTR 24. Supply chain attacks, which exploit third-party services and software](https://www.symantec.com/blogs/threat-intelligence/istr-24-cyber-security-threat-landscape)\nto compromise a final target, take many forms, including hijacking software updates and\ninjecting malicious code into legitimate software.\n\nIT providers are an ideal target for attackers given their high level of access to their clients’\ncomputers. This access may give them the ability to send malicious software updates to target\nmachines, and may even provide them with remote access to customer machines. This provides\naccess to the victims’ networks without having to compromise the networks themselves, which\nmight not be possible if the intended victims have strong security infrastructure, and also\nreduces the risk of the attack being discovered. The targeting of a third-party service provider\nalso makes it harder to pinpoint who the attackers’ true intended targets were.\n\n\n-----\n\nThe customer profiles of the targeted IT companies are unknown, but Tortoiseshell is not the first\n[group to target organizations in the Middle East, as we have covered in previous blogs.](https://www.symantec.com/blogs/threat-intelligence/elfin-apt33-espionage)\nHowever, we currently have no evidence that would allow us to attribute Tortoiseshell’s activity\nto any existing known group or nation state.\n\n## Protection/Mitigation\n\nThe following protections are also in place to protect customers against Tortoiseshell activity:\n\n[Backdoor.Syskit](https://www.symantec.com/content/symantec/english/en/security-center/writeup.html/2019-082613-5549-99)\n\n## Indicators of Compromise\n\n**SHA256** **Name**\n\nf71732f997c53fa45eef5c988697eb4aa62c8655d8f0be3268636fc23addd193 Backdoor.Syskit\n\n02a3296238a3d127a2e517f4949d31914c15d96726fb4902322c065153b364b2 Backdoor.Syskit\n\n07d123364d8d04e3fe0bfa4e0e23ddc7050ef039602ecd72baed70e6553c3ae4 Backdoor.Syskit\n\n**Backdoor.Syskit C&C servers**\n\n64.235.60.123\n\n64.235.39.45\n\n## About the Author\n\n### Threat Hunter Team\n\n**Symantec**\n\nThe Threat Hunter Team is a group of security experts within Symantec whose mission is to\ninvestigate targeted attacks, drive enhanced protection in Symantec products, and offer analysis\nthat helps customers respond to attacks.\n\n## Want to comment on this post?\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2019/2019-09-18 - Tortoiseshell Group Targets IT Providers in Saudi Arabia in Probable Supply Chain Attacks.pdf"
    ],
    "report_names": [
        "2019-09-18 - Tortoiseshell Group Targets IT Providers in Saudi Arabia in Probable Supply Chain Attacks.pdf"
    ],
    "threat_actors": [
        {
            "id": "ce10c1bd-4467-45f9-af83-28fc88e35ca4",
            "created_at": "2022-10-25T15:50:23.458833Z",
            "updated_at": "2025-03-27T02:00:55.475188Z",
            "deleted_at": null,
            "main_name": "APT34",
            "aliases": null,
            "source_name": "MITRE:APT34",
            "tools": [
                "netstat",
                "Systeminfo",
                "PsExec",
                "SEASHARPEE",
                "Tasklist",
                "Mimikatz",
                "POWRUNER",
                "certutil"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "cffb3c01-038f-4527-9cfd-57ad5a035c22",
            "created_at": "2022-10-25T15:50:23.38055Z",
            "updated_at": "2025-03-27T02:00:55.459558Z",
            "deleted_at": null,
            "main_name": "OilRig",
            "aliases": [
                "COBALT GYPSY",
                "IRN2",
                "APT34",
                "Helix Kitten",
                "Evasive Serpens",
                "Hazel Sandstorm",
                "EUROPIUM",
                "ITG13"
            ],
            "source_name": "MITRE:OilRig",
            "tools": [
                "ISMInjector",
                "RDAT",
                "Systeminfo",
                "QUADAGENT",
                "OopsIE",
                "Tasklist",
                "certutil",
                "ZeroCleare",
                "POWRUNER",
                "netstat",
                "ipconfig",
                "LaZagne",
                "BONDUPDATER",
                "SideTwist",
                "PsExec",
                "SEASHARPEE",
                "Mimikatz",
                "RGDoor",
                "ftp"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "67709937-2186-4a32-b64c-a5693d40ac77",
            "created_at": "2023-01-06T13:46:38.495593Z",
            "updated_at": "2025-03-27T02:00:02.848206Z",
            "deleted_at": null,
            "main_name": "OilRig",
            "aliases": [
                "IRN2",
                "Hazel Sandstorm",
                "EUROPIUM",
                "TA452",
                "Earth Simnavaz",
                "Cobalt Gypsy",
                "Crambus",
                "Helix Kitten",
                "APT 34",
                "APT34",
                "ATK40",
                "G0049",
                "Evasive Serpens",
                "Twisted Kitten"
            ],
            "source_name": "MISPGALAXY:OilRig",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "3ce91297-e4c0-4957-8dd7-9047a3e23dc7",
            "created_at": "2023-01-06T13:46:39.054248Z",
            "updated_at": "2025-03-27T02:00:02.985963Z",
            "deleted_at": null,
            "main_name": "Tortoiseshell",
            "aliases": [
                "IMPERIAL KITTEN",
                "Yellow Liderc",
                "Imperial Kitten",
                "TA456",
                "DUSTYCAVE",
                "Crimson Sandstorm"
            ],
            "source_name": "MISPGALAXY:Tortoiseshell",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "b23e717c-0b27-47e0-b3c8-4defe6dd857f",
            "created_at": "2023-01-06T13:46:38.367369Z",
            "updated_at": "2025-03-27T02:00:02.815758Z",
            "deleted_at": null,
            "main_name": "APT33",
            "aliases": [
                "ATK35",
                "Peach Sandstorm",
                "TA451",
                "APT 33",
                "Elfin",
                "Refined Kitten",
                "MAGNALLIUM",
                "HOLMIUM",
                "COBALT TRINITY",
                "G0064"
            ],
            "source_name": "MISPGALAXY:APT33",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "9fe49a5b-f3e6-4fbf-99a1-db15dad460c3",
            "created_at": "2024-05-01T02:03:08.045004Z",
            "updated_at": "2025-03-27T02:05:17.325038Z",
            "deleted_at": null,
            "main_name": "COBALT TRINITY",
            "aliases": [
                "Elfin ",
                "HOLMIUM ",
                "MAGNALIUM ",
                "Peach Sandstorm ",
                "Refined Kitten ",
                "TA451 ",
                "APT33 "
            ],
            "source_name": "Secureworks:COBALT TRINITY",
            "tools": [
                " Cadlotcorg",
                " Dello RAT",
                " Imminent Monitor",
                " KDALogger",
                " Koadic",
                " NanoCore",
                " NetWire",
                " POWERTON",
                " PoshC2",
                " Poylog",
                " PupyRAT",
                " Schoolbag",
                "AutoCore"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "583cdac5-eb9d-46e9-a0f9-7594c4b18281",
            "created_at": "2024-05-01T02:03:08.017491Z",
            "updated_at": "2025-03-27T02:05:17.30797Z",
            "deleted_at": null,
            "main_name": "COBALT FIRESIDE",
            "aliases": [
                "CURIUM ",
                "DEV-0228 ",
                "HIVE0095 ",
                "Imperial Kitten ",
                "TA456 ",
                "Tortoiseshell ",
                "UNC3890 ",
                "Yellow Liderc ",
                "Crimson Sandstorm "
            ],
            "source_name": "Secureworks:COBALT FIRESIDE",
            "tools": [
                " LEMPO",
                " LiderBird",
                "FireBAK"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "3eebdb3f-f4e3-42e5-bb4d-f02a13328316",
            "created_at": "2024-05-01T02:03:08.014303Z",
            "updated_at": "2025-03-27T02:05:17.306592Z",
            "deleted_at": null,
            "main_name": "COBALT EDGEWATER",
            "aliases": [
                "Cold River ",
                "DNSpionage ",
                "APT34 "
            ],
            "source_name": "Secureworks:COBALT EDGEWATER",
            "tools": [
                " DNSpionage",
                " Karkoff",
                " MailDropper",
                " SideTwist",
                " TWOTONE",
                "AgentDrable"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "8f9c8a6e-f6b6-431b-bedd-94fdeea5474a",
            "created_at": "2024-05-01T02:03:08.022974Z",
            "updated_at": "2025-03-27T02:05:17.310877Z",
            "deleted_at": null,
            "main_name": "COBALT GYPSY",
            "aliases": [
                "CHRYSENE ",
                "Crambus ",
                "EUROPIUM ",
                "Hazel Sandstorm ",
                "Helix Kitten ",
                "ITG13 ",
                "OilRig ",
                "Yellow Maero ",
                "APT34 "
            ],
            "source_name": "Secureworks:COBALT GYPSY",
            "tools": [
                " Helminth",
                " Jason",
                " MacDownloader",
                " PoisonFrog",
                " RGDoor",
                " ThreeDollars",
                " TinyZbot",
                " Toxocara",
                " Trichuris",
                " TwoFace",
                "Glimpse"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "e5ff825b-0456-4013-b90a-971b93def74a",
            "created_at": "2022-10-25T15:50:23.824058Z",
            "updated_at": "2025-03-27T02:00:55.553346Z",
            "deleted_at": null,
            "main_name": "APT33",
            "aliases": [
                "APT33",
                "HOLMIUM",
                "Elfin",
                "Peach Sandstorm"
            ],
            "source_name": "MITRE:APT33",
            "tools": [
                "PowerSploit",
                "AutoIt backdoor",
                "PoshC2",
                "Mimikatz",
                "NanoCore",
                "DEADWOOD",
                "StoneDrill",
                "POWERTON",
                "LaZagne",
                "TURNEDUP",
                "NETWIRE",
                "Pupy",
                "ftp",
                "Shamoon"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "b5b24083-7ba6-44cc-9d11-a6274e2eee00",
            "created_at": "2022-10-25T16:07:24.337332Z",
            "updated_at": "2025-03-27T02:02:10.177597Z",
            "deleted_at": null,
            "main_name": "Tortoiseshell",
            "aliases": [
                "Crimson Sandstorm",
                "Curium",
                "Houseblend",
                "Imperial Kitten",
                "Marcella Flores",
                "Operation Fata Morgana",
                "TA456",
                "Yellow Liderc"
            ],
            "source_name": "ETDA:Tortoiseshell",
            "tools": [
                "IMAPLoader",
                "Infostealer",
                "IvizTech",
                "LEMPO",
                "MANGOPUNCH",
                "SysKit",
                "get-logon-history.ps1",
                "liderc",
                "stereoversioncontrol"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "b938e2e3-3d1b-4b35-a031-ddf25b912557",
            "created_at": "2022-10-25T16:07:23.35582Z",
            "updated_at": "2025-03-27T02:02:09.750954Z",
            "deleted_at": null,
            "main_name": "APT 33",
            "aliases": [
                "APT 33",
                "ATK 35",
                "Cobalt Trinity",
                "Curious Serpens",
                "Elfin",
                "Holmium",
                "Magnallium",
                "Peach Sandstorm",
                "Refined Kitten",
                "TA451",
                "Yellow Orc"
            ],
            "source_name": "ETDA:APT 33",
            "tools": [
                "Atros2.CKPN",
                "AutoIt backdoor",
                "Breut",
                "CinaRAT",
                "DROPSHOT",
                "DarkComet",
                "DarkKomet",
                "DistTrack",
                "EmPyre",
                "EmpireProject",
                "FYNLOS",
                "FalseFont",
                "Filerase",
                "Fynloski",
                "JuicyPotato",
                "Krademok",
                "LOLBAS",
                "LOLBins",
                "LaZagne",
                "Living off the Land",
                "Mimikatz",
                "Nancrat",
                "NanoCore",
                "NanoCore RAT",
                "NetWeird",
                "NetWire",
                "NetWire RAT",
                "NetWire RC",
                "NetWired RC",
                "Notestuk",
                "POWERTON",
                "PoshC2",
                "PowerBand",
                "PowerShell Empire",
                "PowerSploit",
                "PsList",
                "Pupy",
                "PupyRAT",
                "Quasar RAT",
                "QuasarRAT",
                "Recam",
                "Remcos",
                "RemcosRAT",
                "Remvio",
                "SHAPESHIFT",
                "Shamoon",
                "Socmer",
                "StoneDrill",
                "TURNEDUP",
                "Tickler",
                "Yggdrasil",
                "Zurten",
                "klovbot",
                "pupy"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "b6436f7b-6012-4969-aed1-d440e2e8b238",
            "created_at": "2022-10-25T16:07:23.91517Z",
            "updated_at": "2025-03-27T02:02:10.027531Z",
            "deleted_at": null,
            "main_name": "OilRig",
            "aliases": [
                "APT 34",
                "ATK 40",
                "Chrysene",
                "Cobalt Gypsy",
                "Crambus",
                "DEV-0861",
                "EUROPIUM",
                "Earth Simnavaz",
                "Evasive Serpens",
                "Hazel Sandstorm",
                "Helix Kitten",
                "IRN2",
                "ITG13",
                "Scarred Manticore",
                "Storm-0861",
                "TA452",
                "Twisted Kitten",
                "UNC1860",
                "Yellow Maero"
            ],
            "source_name": "ETDA:OilRig",
            "tools": [
                "AMATIAS",
                "Agent Drable",
                "Agent Injector",
                "AgentDrable",
                "Alma Communicator",
                "BONDUPDATER",
                "CACTUSPIPE",
                "Clayslide",
                "CypherRat",
                "DNSExfitrator",
                "DNSpionage",
                "DROPSHOT",
                "DistTrack",
                "DropperBackdoor",
                "Fox Panel",
                "GREYSTUFF",
                "GoogleDrive RAT",
                "HighShell",
                "HyperShell",
                "ISMAgent",
                "ISMDoor",
                "ISMInjector",
                "Jason",
                "Karkoff",
                "LIONTAIL",
                "LOLBAS",
                "LOLBins",
                "LONGWATCH",
                "LaZagne",
                "Living off the Land",
                "MailDropper",
                "Mimikatz",
                "MrPerfectInstaller",
                "OILYFACE",
                "OopsIE",
                "POWBAT",
                "POWRUNER",
                "Plink",
                "Poison Frog",
                "PowerExchange",
                "PsList",
                "PuTTY Link",
                "QUADAGENT",
                "RDAT",
                "RGDoor",
                "SEASHARPEE",
                "Saitama",
                "Saitama Backdoor",
                "Shamoon",
                "SideTwist",
                "SpyNote",
                "SpyNote RAT",
                "StoneDrill",
                "TONEDEAF",
                "TONEDEAF 2.0",
                "ThreeDollars",
                "TwoFace",
                "VALUEVAULT",
                "Webmask",
                "WinRAR",
                "ZEROCLEAR",
                "ZeroCleare",
                "certutil",
                "certutil.exe"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673536097,
    "ts_updated_at": 1743041847,
    "ts_creation_date": 1653775264,
    "ts_modification_date": 1653775264,
    "files": {
        "pdf": "https://archive.orkl.eu/fbfd1519e02e672da50714118402a0f66c796a29.pdf",
        "text": "https://archive.orkl.eu/fbfd1519e02e672da50714118402a0f66c796a29.txt",
        "img": "https://archive.orkl.eu/fbfd1519e02e672da50714118402a0f66c796a29.jpg"
    }
}