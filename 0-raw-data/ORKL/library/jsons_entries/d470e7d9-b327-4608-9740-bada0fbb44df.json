{
    "id": "d470e7d9-b327-4608-9740-bada0fbb44df",
    "created_at": "2023-01-12T15:00:07.288637Z",
    "updated_at": "2025-03-27T02:09:07.374529Z",
    "deleted_at": null,
    "sha1_hash": "8d9efe2e3a2d4171a08e75000eb78957febc5416",
    "title": "2012-05-31 - Flamer- A Recipe for Bluetoothache",
    "authors": "",
    "file_creation_date": "2022-05-28T18:18:20Z",
    "file_modification_date": "2022-05-28T18:18:20Z",
    "file_size": 56677,
    "plain_text": "# Endpoint Protection\n\n**[symantec.com/connect/blogs/flamer-recipe-bluetoothache](https://www.symantec.com/connect/blogs/flamer-recipe-bluetoothache)**\n\n[A L Johnson](https://community.broadcom.com/symantecenterprise/network/members/profile?UserKey=cbd453fd-3ce1-4c47-af77-d746256f9bc4)\n\n\nMay 31, 2012 07:29 PM\n\n\n[W32.Flamer is possibly the only Windows based threat we have encountered which uses](http://www.symantec.com/security_response/writeup.jsp?docid=2012-052811-0308-99)\nBluetooth. It is yet another indicator that W32.Flamer is not only exceptional, but that it is a\ncomprehensive information gathering and espionage tool. The CrySyS laboratory has\npreviously documented the technical details of Bluetooth in W32.Flamer. But, what does\nthis actually mean for potential victims targeted by Flamer? What can an attacker\naccomplish using Bluetooth?\n\nThe Bluetooth functionality in Flamer is encoded in a module called \"BeetleJuice\". This\nmodule is triggered according to configuration values set by the attacker. When triggered it\nperforms two primary actions:\n\n1. The first is to scan for all Bluetooth devices in range. When a device is found, its\n\nstatus is queried and the details of the device recorded—including its ID—presumably\nto be uploaded to the attacker at some point.\n\n2. The second action is to configure itself as a Bluetooth beacon. This means that a\n\ncomputer compromised by W32.Flamer will appear when any other Bluetooth device\nscans the local area. And there is more. In addition to enabling a Bluetooth beacon,\nFlamer encodes details about the infected computer (see Figure 1) and then stores\nthese details in a special 'description' field. When any other device scans for\nBluetooth-enabled devices, this description field will be displayed:\n\nThese are the facts of how Flamer uses Bluetooth. And what can the attacker do with this\nfunctionality? There are several potential avenues available:\n\n**Scenario #1 – Identification of victim social networks**\n\n\n-----\n\nBy continuously monitoring the Bluetooth devices within range of a W32.Flamer\ncompromised computer, the attacker can build a profile of various devices encountered\nthroughout the day. This will be particularly effective if the compromised computer is a\nlaptop because the victim is more likely to carry it around. Over time, as the victim meets\nassociates and friends, the attackers will catalog the various devices encountered, most\nlikely mobile phones. This way the attackers can build a map of interactions with various\npeople—and identify the victim's social and professional circles.\n\n**Scenario #2 – Identification of victim physical locations**\n\nWhen compromising a victim's computer, the attacker has determined that this particular\nvictim and their location is a high-priority target. While the building that the victim resides in\ncan be known, the actual office is not identified. The attacker, however, could identify the\nlocation of compromised devices using Bluetooth.\n\nBluetooth operates over radio waves. By measuring the strength of a radio wave signal, an\nattacker can measure if he is she is getting closer or further away to a particular device.\nWith the Bluetooth beacon turned on, and with the details of a particular compromised\ndevice available in the description field, it is straightforward for the attacker to identify the\nphysical location of a W32.Flamer compromised computer or device.\n\nAn alternative to this is that rather than identifying the actual compromised computer, the\nattacker identifies a mobile phone which belongs to the victim. The Beetlejuice module\nalready has retrieved a list of all the devices IDs which are near to the infected computer\nand so the attacker knows what devices belong to the victim. It is likely that one of the\ndevices is a mobile phone which the victim carries most times. Now the attacker has the\nability to passively monitor for the victim, without installing or modifying the victim's devices.\nBluetooth monitoring devices could be placed in airports, train stations, or any transport\n[hub, and listen for the ID values of any known victim device. Some attacks have even](http://www.tomsguide.com/us/how-to-bluesniper-pt1,review-408.html)\nidentified Bluetooth devices more than one mile away. The more sinister aspect of this\npassive sniffing is that it allows the attacker to pinpoint a victim and, therefore, more easily\ntrack them in the future.\n\n**Scenario #3 – Enhanced information gathering**\n\nAs [described in our previous blog, a substantial part of Flamer’s functionality is](https://community.broadcom.com/symantecenterprise/viewdocument?DocumentKey=eb9e7f9c-93ef-45ab-8cae-2edce8b4b8c2&CommunityKey=1ecf5f55-9545-44d6-b0f4-4e4a7f5f5e68&tab=librarydocuments)\nimplemented in Lua scripts, or 'apps' which are downloaded from the FLAME 'app\nrepository’. It would be trivial for an attacker to upload a new malicious Bluetooth Lua app\n\n\n-----\n\ninto the FLAME store for download onto a compromised device. With increase functionality\nan attacker, having identified various Bluetooth devices in range, could perform numerous\nattacks:\n\nSteal contacts from an address book, steals SMS messages, steals images, and\nmore.\nUse a device to eavesdrop. Connect a compromised computer to a nearby device and\nenable handsfree communication. When the device is brought into a meeting room, or\nused to make a call, the attackers could listen in.\nExfiltrate already-stolen data through any nearby device's data connection. This would\nbypass any firewalls or network controls. An attacker within one mile of the target\ncould use their own Bluetooth-enabled device for this.\n\nIt is possible that there is undiscovered code within W32.Flamer which already achieves\nsome of these goals. For example, although we have not found network code near the\n'beacon' code, one compromised computer may connect to another computer using\nBluetooth. If the second computer is using a secured network and was infected through a\nUSB connection, potentially the only network available would be a Bluetooth connection\nback to the first compromised computer. The code to achieve this may already exist in\nFlame.\n\nThe various theories described here are all practical attacks, easily to implement by a\nskilled attacker. The sophistication of W32.Flamer indicates that the attackers are certainly\ntechnically skilled and such attacks are well within their capabilities.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2012/2012-05-31 - Flamer- A Recipe for Bluetoothache.pdf"
    ],
    "report_names": [
        "2012-05-31 - Flamer- A Recipe for Bluetoothache.pdf"
    ],
    "threat_actors": [
        {
            "id": "dfee8b2e-d6b9-4143-a0d9-ca39396dd3bf",
            "created_at": "2022-10-25T16:07:24.467088Z",
            "updated_at": "2025-03-27T02:02:10.241387Z",
            "deleted_at": null,
            "main_name": "Circles",
            "aliases": [],
            "source_name": "ETDA:Circles",
            "tools": [],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535607,
    "ts_updated_at": 1743041347,
    "ts_creation_date": 1653761900,
    "ts_modification_date": 1653761900,
    "files": {
        "pdf": "https://archive.orkl.eu/8d9efe2e3a2d4171a08e75000eb78957febc5416.pdf",
        "text": "https://archive.orkl.eu/8d9efe2e3a2d4171a08e75000eb78957febc5416.txt",
        "img": "https://archive.orkl.eu/8d9efe2e3a2d4171a08e75000eb78957febc5416.jpg"
    }
}