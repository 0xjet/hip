{
    "id": "268e4194-ded4-427a-a4a4-b0a3690d1c29",
    "created_at": "2023-01-12T15:01:53.901987Z",
    "updated_at": "2025-03-27T02:16:44.758759Z",
    "deleted_at": null,
    "sha1_hash": "e5106a64f708ebc7cae70d767c2d77f3a92136ef",
    "title": "2022-04-02 - Study of targeted attacks on Russian research institutes",
    "authors": "",
    "file_creation_date": "2022-08-18T03:56:36Z",
    "file_modification_date": "2022-08-18T03:56:36Z",
    "file_size": 948005,
    "plain_text": "# Исследование целевых атак на российские НИИ\n\n**news.drweb.ru/show/**\n\nDoctor Web\n\n[Назад к списку новостей](https://news.drweb.ru/list/?p=0&lng=ru&c=5)\n\n[Скачать в PDF](https://st.drweb.com/static/new-www/news/2021/april/drweb_research_attacks_on_russian_research_institutes_ru.pdf?1)\n\n**2 апреля 2021 года**\n\n### Введение\n\nВ конце сентября 2020 года в вирусную лабораторию «Доктор Веб» за помощью обратился один из российских научноисследовательских институтов. Сотрудники НИИ обратили внимание на ряд технических проблем, которые могли\nсвидетельствовать о наличии вредоносного ПО на одном из серверов локальной сети. В ходе расследования вирусные\nаналитики установили, что на НИИ была осуществлена целевая атака с использованием специализированных бэкдоров.\nИзучение деталей инцидента показало, что сеть предприятия была скомпрометирована задолго до обращения к нам и,\nсудя по имеющимся у нас данным, — не одной APT-группой.\n\nПолученные в ходе расследования данные говорят о том, что первая APT-группа скомпрометировала внутреннюю сеть\nинститута осенью 2017 года. Первичное заражение осуществлялось с помощью **[BackDoor.Farfli.130 — модификации](https://vms.drweb.ru/search/?q=BackDoor.Farfli.130&lng=ru)**\n[бэкдора, также известного как Gh0st RAT. Позднее, весной 2019 года в сети был установлен Trojan.Mirage.12, а в июне](https://vms.drweb.ru/search/?q=Trojan.Mirage.12&lng=ru)\n[2020 — BackDoor.Siggen2.3268.](https://vms.drweb.ru/search/?q=BackDoor.Siggen2.3268&lng=ru)\n\nВторая хакерская группировка скомпрометировала сеть института не позднее апреля 2019, в этот раз заражение началось\n[с установки бэкдора BackDoor.Skeye.1. В процессе работы мы также выяснили, что примерно в то же время — в мае 2019](https://vms.drweb.ru/search/?q=BackDoor.Skeye.1&lng=ru)\nгода — Skeye был установлен в локальной сети другого российского НИИ.\n\n[Тем временем в июне 2019 года компания FireEye опубликовала отчет о целевой атаке на государственный сектор ряда](https://www.fireeye.com/blog/threat-research/2019/06/government-in-central-asia-targeted-with-hawkball-backdoor.html)\nстран центральной Азии с использованием этого бэкдора. Позднее, в период с августа по сентябрь 2020 года вирусные\nаналитики «Доктор Веб» зафиксировали установку различных троянов этой группой в сети предприятия, включая ранее не\nвстречавшийся DNS-бэкдор **[BackDoor.DNSep.1, а также хорошо известный](https://vms.drweb.ru/search/?q=BackDoor.DNSep.1&lng=ru)** **[BackDoor.PlugX.](https://vms.drweb.ru/search/?q=BackDoor.PlugX&lng=ru)**\n\n\n-----\n\n[Более того, в декабре 2017 года на серверы обратившегося к нам НИИ был установлен BackDoor.RemShell.24.](https://vms.drweb.ru/search/?q=BackDoor.RemShell.24&lng=ru)\nПредставители этого семейства ранее были описаны специалистами Positive Technologies в исследовании Operation\nTaskmasters. При этом мы не располагаем такими данными, которые позволили бы однозначно определить, какая из двух\nAPT-групп использовала этот бэкдор.\n\n### Кто стоит за атаками?\n\nДеятельность первой APT-группы не позволяет нам однозначно идентифицировать атаковавших как одну из ранее\nописанных хакерских группировок. При этом анализ используемых вредоносных программ и инфраструктуры показал, что\nэта группа активна как минимум с 2015 года.\n\nВторой APT-группой, атаковавшей НИИ, по нашему мнению является TA428, ранее описанная исследователями компании\n[Proofpoint в материале Operation Lag Time IT. В пользу этого вывода говорят следующие факты:](https://www.proofpoint.com/us/threat-insight/post/chinese-apt-operation-lagtime-it-targets-government-information-technology)\n\n1. в коде бэкдоров BackDoor.DNSep и BackDoor.Cotx имеются явные пересечения и заимствования;\n2. BackDoor.Skeye.1 и Trojan.Loader.661 использовались в рамках одной атаки, при этом последний является\n\nизвестным инструментом TA428;\n3. бэкдоры, проанализированные нами в рамках этих атак, имеют пересечения в адресах управляющих серверов и\n\nсетевой инфраструктуре с бэкдорами, используемыми группировкой TA428.\n\nТеперь подробнее рассмотрим выявленные связи. На графе приведена часть задействованной в атаке инфраструктуры с\nпересечениями бэкдоров Skeye и другим известным APT-бэкдором — PoisonIvy:\n\nНа этом графе изображены пересечения в инфраструктуре бэкдоров Skeye и Cotx:\n\n\n-----\n\nДетальный анализ бэкдора DNSep и его последующее сравнение с кодом бэкдора Cotx выявили сходство как в общей\nлогике обработки команд от управляющего сервера, так и в конкретных реализациях отдельных команд.\n\nДругой интересной находкой этого исследования стал бэкдор Logtu, один из его образцов мы ранее описывали в рамках\nрасследования инцидента в Киргизии. Адрес его управляющего сервера совпал с адресом сервера бэкдора Skeye —\natob[.]kommesantor[.]com. В связи с этим мы также провели сравнительный анализ BackDoor.Skeye.1 с образцами\n**[BackDoor.Logtu.1 и](https://vms.drweb.ru/search/?q=BackDoor.Logtu.1&lng=ru)** **[BackDoor.Mikroceen.11.](https://vms.drweb.ru/search/?q=BackDoor.Mikroceen.11&lng=ru)**\n\nПодробные технические описания обнаруженных вредоносных программ находятся в PDF-версии исследования и в\nвирусной библиотеке Dr.Web.\n\n### Сравнительный анализ кода BackDoor.DNSep.1 и BackDoor.Cotx.1\n\nНесмотря на то, что каналы связи с управляющим сервером у Cotx и DNSep кардинально различаются, нам удалось найти\nинтересные совпадения в коде обоих бэкдоров.\n\nФункция, отвечающая за обработку команд от управляющего сервера, принимает аргументом структуру:\n```\nstruct st_arg\n\n{\n\n _BYTE cmd;\n\n st_string arg;\n\n};\n\n```\nПри этом, если нужная функция принимает несколько аргументов, то они все записаны в поле arg с разделителем |.\n\nНабор команд BackDoor.Cotx.1 обширнее, чем у BackDoor.DNSep.1, и включает все команды, которые есть у последнего.\n\nВ таблице ниже видно почти полное совпадение кода некоторых функций бэкдоров. При этом следует учитывать, в Cotx\nиспользуется кодировка Unicode, а в DNSep — ANSI.\n\n\n-----\n\n**BackDoor.DNSep.1**\n\n\n**BackDoor.Cotx.1**\n\n\nОбработчик команды на отправку листинга каталога или\nинформации о диске\n\n\nФункция получения информации о дисках\n\n\nФункция перечисления файлов в папке\n\n\n-----\n\nФункция сбора информации о файлах в папке\n\n\nПолученные в результате анализа данные позволяют предположить, что при создании бэкдора DNSep его автор имел\nдоступ к исходным кодам Cotx. Поскольку эти ресурсы не являются общедоступными, мы предполагаем, что автор или\nгруппа авторов DNSep имеет отношение к группировке TA428. В пользу этой версии говорит и тот факт, что образец DNSep\nбыл найден в скомпрометированной сети пострадавшей организации вместе с другими известными бэкдорами TA428.\n\n### Сравнительный анализ кода бэкдоров Skeye, Mikroceen, Logtu\n\n\n-----\n\nВ процессе исследования бэкдора Skeye мы обнаружили, что адрес его управляющего сервера также используется\nбэкдором семейства Logtu. Для сравнительного анализа мы использовали ранее описанные нами образцы\n**[BackDoor.Logtu.1 и](https://vms.drweb.ru/search/?q=BackDoor.Logtu.1&lng=ru)** **[BackDoor.Mikroceen.11.](https://vms.drweb.ru/search/?q=BackDoor.Mikroceen.11&lng=ru)**\n\n**Функции логирования**\n\nЛогирование во всех случаях так или иначе обфусцировано.\n\n**BackDoor.Mikroceen.11 — сообщения в формате %d-%d-%d %d:%d:%d <msg>\\r\\n записываются в файл**\n%TEMP%\\WZ9Jan10.TMP, где <msg> — случайная текстовая строка. В образце\n2f80f51188dc9aea697868864d88925d64c26abc сообщения записываются в файл 7B296FB0.CAB;\n**BackDoor.Logtu.1 — сообщения в формате [%d-%02d-%02d %02d:%02d:%02d] <rec_id>**\n<error_code>\\n<opt_message>\\n\\n перед записью в файл %TEMP%\\rar<rnd>.tmp шифруются операцией XOR с\nключом 0x31;\n**BackDoor.Skeye.1 — сообщения в формате %4d/%02d/%02d %02d:%02d:%02d\\t<rec_id>\\t<error_code>\\n**\nзаписываются в файл %TEMP%\\wcrypt32.dll.\n\nОбщая логика последовательности записи сообщений в журнал также схожа у всех трех образцов:\n\nначало исполнения фиксируется;\nв Logtu и Mikroceen в журнал записывается прямое подключение к управляющему серверу;\nв каждом случае указывается, через какой прокси выполнено подключение к серверу;\nв случае ошибки на этапе получения прокси из того или иного источника в журнале фиксируется отдельная запись.\n\nСледует заметить, что настолько подробное и при этом обфусцированное логирование встречается крайне редко.\nОбфускация заключается в том, что в журнал записываются некоторые коды сообщений и в ряде случаев дополнительные\nданные. Кроме того, в данном случае прослеживается общая схема последовательности записи событий:\n\nначало исполнения;\nпопытка подключения напрямую;\nполучение адресов прокси;\nзапись о подключении через тот или иной сервер.\n\n**Поиск прокси-сервера**\n\nПоследовательность соединения с управляющим сервером также выглядит похожей у всех 3 образцов. Первоначально\nкаждый бэкдор пытается подключиться к серверу напрямую, а в случае неудачи может использовать прокси-серверы,\nадреса которых находятся из трех источников помимо встроенного.\n\nПолучение адресов прокси-серверов BackDoor.Mikroceen.11:\n\nиз файла %WINDIR%\\debug\\netlogon.cfg;\nиз собственного лог-файла;\nпутем поиска соединений с удаленными хостами через порты 80, 8080, 3128, 9080 в TCP-таблице.\n\nПоиск прокси в своем лог-файле:\n\n\n-----\n\nПоиск в активных соединениях:\n\nПолучение адресов прокси-серверов BackDoor.Logtu.1:\n\nиз реестра HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\\ProxyServer;\nиз раздела HKU реестра по SID активного пользователя;\nс помощью WinHTTP API WinHttpGetProxyForUrl путем запроса к google.com.\n\nПолучение адресов прокси-серверов BackDoor.Skeye.1:\n\nиз раздела HKCU Software\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\\ProxyServer;\nиз раздела HKU по SID активного пользователя;\n\n\n-----\n\nпутем поиска соединений с удаленными хостами через порты 80, 8080, 3128, 9080 в TCP таблице.\n\n**Пересечения в сетевой инфраструктуре**\n\nНекоторые образцы совместно использовали одну и ту же сетевую инфраструктуру. Фрагмент графа наглядно показывает\nвзаимосвязь между семействами.\n\n**Идентификаторы**\n\nВ образцах Logtu и Mikroceen присутствуют строки, которые используются в качестве идентификаторов сборок или\nверсий. Формат некоторых из них совпадает.\n\n\n**BackDoor.Mikroceen.11**\n\n\n**BackDoor.Logtu.1**\n\n\n-----\n\n**SHA1**\n\n\n**Id**\n\n\n**SHA1**\n\n\n**id**\n\n\nce21f798119dbcb7a63f8cdf070545abb09f25ba intl0113 029735cb604ddcb9ce85de92a6096d366bd38a24 intpz0220\n\n0eb2136c5ff7a92706bc9207da32dd85691eeed5 hisa5.si4 7b652e352a6d2a511f226e4d0cc22f093e052ad8 retail2007\n\n2f80f51188dc9aea697868864d88925d64c26abc josa5w5n 1c5e5fd53fc2ee778342a5cae3ac2eb0ac345ed7 retail\n\n2e50c075343ab20228a8c0c094722bbff71c4a2a enc0225 00ddcc200d1031b8639026532c0087bfcc4520c9 716demo\n\n3bd16f11b5b3965a124a6fc3286297e5cfe77715 520299 b599797746ae8ccf7907cf88de232faa30ec95e6 gas-zhi\n\n5eecdf63e85833e712a1ff88df1341bbf32f4ab8 Strive 2d672d7818a56029b337e8792935195d53576a9d jjlk\n\nbd308f4d1a32096a3b90cfdae45bbc5c13e5e801 R0916\n\nb1be4b2f874c8309f553acce90287c8c6bb2b6b1 frsl.1ply\n\n21ffd24b8074d7cffdf4cc339d1fa8fe892eba27 Wdv\n\n8fbec09e646311a285aee06b3dd45ccf58928703 intz726\n\n19921cc47b3de003186e65fd12b82235030f060d 122764\n\n0f70251abc8c64cbc7b24995c3d32927514d0a4b V20180224\n\n149947544ca4f7baa5bc3d00b080d0e943d8036b SOE\n\ne7f5a33b33e023a82ac9eee6ed40e4a38ce95277 int815\n\nb4790eec7daa9f931bed43a53f66168b477599a7 UOE\n\nab660a3ac46d563c756463bd1b64cc45f347a1f7 B.Z11NOV20D\n\nd0181759a175fbcc60975983b351f88970f484f9 299520\n\n7a63fc9db2bc1e9b1ef793723d5877e6b4c566b8 WinVideo\n\n13779006d0dafbe4b27bd282230df299eef2b8dc SSLSSL\n\nf53c77695a162c78c68f693f57f65752d17f6030 int007server\n\n924341cab6106ef993b506193e6786e459936069 intl1211\n\n8ebf78c84cd7f66ca8708467a28d83658bcf6710 intl821\n\nf2856d7d138430e164f83662e251ee311950d83c intl821\n\nКроме того, в значительном числе образцов данный идентификатор равен значению TEST или test.\n\nПример в **[BackDoor.Logtu.1 (9ea2488f07bf3edda23d9b7759c2d0c3c8501f92):](https://vms.drweb.ru/search/?q=BackDoor.Logtu.1&lng=ru)**\n\n\n-----\n\nПример в BackDoor.Mirkoceen.11 (81bb895a833594013bc74b429fb1f24f9ec9df26):\n\nТаким образом, сравнительный анализ выявил у рассмотренных семейств сходства в:\n\nлогике ведения журнала событий и его обфускации;\nлогике подключения к управляющему серверу и алгоритмах поиска адресов прокси;\nиспользуемой сетевой инфраструктуре.\n\n### Заключение\n\nВ ходе расследования атак на российские НИИ наши вирусные аналитики нашли и описали несколько семейств целевых\nбэкдоров, включая ранее неизвестные образцы. Следует отдельно отметить длительное скрытое функционирование\nвредоносных программ в скомпрометированной сети пострадавшей организации — несанкционированное присутствие\nпервой APT-группы оставалось незамеченным с 2017 года.\n\nХарактерной особенностью является наличие пересечений в коде и сетевой инфраструктуре проанализированных\nобразцов. Мы допускаем, что выявленные связи указывают на принадлежность рассмотренных бэкдоров к одним и тем же\nхакерским группировкам.\n\nСпециалисты компании «Доктор Веб» рекомендуют производить регулярный контроль работоспособности важных сетевых\nресурсов и своевременно обращать внимание на сбои, которые могут свидетельствовать о наличии в сети вредоносного\nПО. Основная опасность целевых атак заключается не только в компрометации данных, но и в длительном присутствии\nзлоумышленников в корпоративной сети. Такой сценарий позволяет годами контролировать работу организации и в\nнужный момент получать доступ к чувствительной информации. При подозрении на вредоносную активность в сети мы\nрекомендуем обращаться в вирусную лабораторию «Доктор Веб», которая оказывает услуги по расследованию\nвирусозависимых компьютерных инцидентов. Оперативное принятие адекватных мер позволит сократить ущерб и\nпредотвратить тяжелые последствия целевых атак.\n\n[Индикаторы компрометации](https://github.com/DoctorWebLtd/malware-iocs/blob/master/APT_DNSep/README.adoc)\n\nЧтобы проголосовать надо войти на страницу новости через аккаунт на сайте «Доктор Веб» (или [создать аккаунт). Аккаунт](https://f2.drweb.com/lr/?to=https%3A%2F%2Fwww.drweb.ru%2Fuser%2Fregistration%2F%3Ffrom%3Dnews)\n[должен быть связан с вашим аккаунтом в социальной сети для наград за активности в них.](https://www.drweb.ru/user/social/) [Видео о связывании аккаунта](https://f2.drweb.com/lr/?to=https%3A%2F%2Fsupport.drweb.ru%2Fvideo%2F%3Ffrom%3Dnews)\n\n[В чем преимущества аккаунта?\n|](https://www.drweb.ru/user/advantages/) [Как зарабатывать Dr.Web-ки?](https://www.drweb.ru/user/how_win/)\n\n### Поделитесь информацией с вашими друзьями в социальных сетях\n\n## Нам важно Ваше мнение\n\nКомментарии размещаются после проверки модератором. Чтобы задать вопрос по новости администрации сайта, укажите\nв начале своего комментария @admin. Если ваш вопрос к автору одного из комментариев — поставьте перед его именем\n@\n\n### Другие комментарии\n\n\n-----",
    "language": "RU",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-04-02 - Study of targeted attacks on Russian research institutes.pdf"
    ],
    "report_names": [
        "2022-04-02 - Study of targeted attacks on Russian research institutes.pdf"
    ],
    "threat_actors": [
        {
            "id": "ed4c7e37-461f-40f1-ad43-6ad7e21b32bc",
            "created_at": "2022-10-25T16:07:24.303712Z",
            "updated_at": "2025-03-27T02:02:10.165915Z",
            "deleted_at": null,
            "main_name": "TaskMasters",
            "aliases": [],
            "source_name": "ETDA:TaskMasters",
            "tools": [
                "404-Input-shell web shell",
                "ASPXSpy",
                "ASPXTool",
                "AtNow",
                "DbxDump Utility",
                "HTran",
                "HUC Packet Transmit Tool",
                "Mimikatz",
                "NBTscan",
                "PortScan",
                "ProcDump",
                "PsExec",
                "PsList",
                "RemShell",
                "RemShell Downloader",
                "gsecdump",
                "jsp File browser",
                "nbtscan",
                "pwdump",
                "reGeorg"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "a4aca3ca-9e04-42d1-b037-f7fb3fbab0b1",
            "created_at": "2023-01-06T13:46:39.042499Z",
            "updated_at": "2025-03-27T02:00:02.984002Z",
            "deleted_at": null,
            "main_name": "TA428",
            "aliases": [
                "Colourful Panda",
                "BRONZE DUDLEY"
            ],
            "source_name": "MISPGALAXY:TA428",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "2f07a03f-eb1f-47c8-a8e9-a1a00f2ec253",
            "created_at": "2022-10-25T16:07:24.277669Z",
            "updated_at": "2025-03-27T02:02:10.157972Z",
            "deleted_at": null,
            "main_name": "TA428",
            "aliases": [
                "Operation LagTime IT",
                "Operation StealthyTrident",
                "ThunderCats"
            ],
            "source_name": "ETDA:TA428",
            "tools": [
                "8.t Dropper",
                "8.t RTF exploit builder",
                "8t_dropper",
                "Agent.dhwf",
                "Albaniiutas",
                "BlueTraveller",
                "Chymine",
                "Cotx RAT",
                "CoughingDown",
                "Darkmoon",
                "Destroy RAT",
                "DestroyRAT",
                "Gen:Trojan.Heur.PT",
                "Kaba",
                "Korplug",
                "LuckyBack",
                "PhantomNet",
                "PlugX",
                "Poison Ivy",
                "RedDelta",
                "RoyalRoad",
                "SManager",
                "SPIVY",
                "Sogu",
                "TIGERPLUG",
                "TManger",
                "TVT",
                "Thoper",
                "Xamtrav",
                "pivy",
                "poisonivy"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "c416260c-7ff6-4a74-a5ba-a15f40d3543f",
            "created_at": "2024-05-01T02:03:07.939268Z",
            "updated_at": "2025-03-27T02:05:17.25652Z",
            "deleted_at": null,
            "main_name": "BRONZE DUDLEY",
            "aliases": [
                "Temp.Hex ",
                "Vicious Panda ",
                "TA428 "
            ],
            "source_name": "Secureworks:BRONZE DUDLEY",
            "tools": [
                "PoisonIvy"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "4ae78ca3-8bc8-4d67-9df1-a85df250a8a0",
            "created_at": "2024-10-08T02:00:04.469211Z",
            "updated_at": "2025-03-27T02:00:03.437849Z",
            "deleted_at": null,
            "main_name": "TaskMasters",
            "aliases": [
                "BlueTraveller"
            ],
            "source_name": "MISPGALAXY:TaskMasters",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "3c7097f4-849b-4bc0-a7e6-ba2b510722b6",
            "created_at": "2022-10-25T16:07:23.869951Z",
            "updated_at": "2025-03-27T02:02:10.003542Z",
            "deleted_at": null,
            "main_name": "Mikroceen",
            "aliases": [
                "SixLittleMonkeys"
            ],
            "source_name": "ETDA:Mikroceen",
            "tools": [
                "AngryRebel",
                "Farfli",
                "Gh0st RAT",
                "Ghost RAT",
                "Microcin",
                "Mikroceen",
                "Mimikatz",
                "Moudour",
                "Mydoor",
                "PCRat",
                "logon.dll",
                "logsupport.dll",
                "pcaudit.bat",
                "sqllauncher.dll"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535713,
    "ts_updated_at": 1743041804,
    "ts_creation_date": 1660794996,
    "ts_modification_date": 1660794996,
    "files": {
        "pdf": "https://archive.orkl.eu/e5106a64f708ebc7cae70d767c2d77f3a92136ef.pdf",
        "text": "https://archive.orkl.eu/e5106a64f708ebc7cae70d767c2d77f3a92136ef.txt",
        "img": "https://archive.orkl.eu/e5106a64f708ebc7cae70d767c2d77f3a92136ef.jpg"
    }
}