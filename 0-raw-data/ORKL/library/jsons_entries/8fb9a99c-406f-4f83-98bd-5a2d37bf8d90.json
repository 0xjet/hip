{
    "id": "8fb9a99c-406f-4f83-98bd-5a2d37bf8d90",
    "created_at": "2022-10-25T16:48:10.551144Z",
    "updated_at": "2025-03-27T02:08:51.307703Z",
    "deleted_at": null,
    "sha1_hash": "9e6f9b8b5b22c32c1ec5d53ed1992f8f83013140",
    "title": "WIN32/INDUSTROYER A new threat for industrial control systems",
    "authors": "ESET",
    "file_creation_date": "2017-06-12T17:58:58Z",
    "file_modification_date": "2017-06-12T17:59:01Z",
    "file_size": 702481,
    "plain_text": "# WIN32/INDUSTROYER A new threat for industrial control systems\n\n### Anton Cherepanov, ESET Version 2017-06-12\n\n\n-----\n\n## Contents\n\nWin32/Industroyer: a new threat for industrial control systems .  .  .  .  .  .  . 2\n\nMain backdoor .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  . 3\n\nAdditional backdoor .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  . 4\n\nLauncher component .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  . 5\n\n101 payload component .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  . 6\n\n104 payload component .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  . 7\n\n61850 payload component .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  10\n\nOPC DA payload component .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  12\n\nData wiper component .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  . 13\n\nAdditional tools: port scanner tool . .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  14\n\nAdditional tools: DoS tool .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  15\n\nConclusion .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  15\n\nIndicators of Compromise (IoC) .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  . 15\n\n\n-----\n\n## Win32/Industroyer: a new threat for industrial control systems\n\nWin32/Industroyer is a sophisticated piece of malware designed to disrupt\nthe working processes of industrial control systems (ICS), specifically\nindustrial control systems used in electrical substations.\n\nThose behind the Win32/Industroyer malware have a deep knowledge\nand understanding of industrial control systems and, specifically, the\nindustrial protocols used in electric power systems. Moreover, it seems very\nunlikely anyone could write and test such malware without access to the\nspecialized equipment used in the specific, targeted industrial environment.\n\nSupport for four different industrial control protocols, specified in the\nstandards listed below, has been implemented by the malware authors:\n\n- IEC 60870-5-101 (aka IEC 101)\n\n- IEC 60870-5-104 (aka IEC 104)\n\n- IEC 61850\n\n- OLE for Process Control Data Access (OPC DA)\n\nIn addition to all that, the malware authors also wrote a tool that\nimplements a denial-of-service (DoS) attack against a particular family of\n[protection relays, specifically the Siemens SIPROTEC range.](http://w3.siemens.com/smartgrid/global/en/products-systems-solutions/protection/pages/overview.aspx)\n\nAll this considered, the Win32/Industroyer malware authors show an\nintensive focus that suggests they are highly specialized in industrial\ncontrol systems.\n\nThe capabilities of this malware are significant. When compared to the\ntoolset used by threat actors in the 2015 attacks against the Ukrainian\npower grid which culminated in a black out on December 23, 2015\n(BlackEnergy, KillDisk, and other components, including legitimate\nremote access software) the gang behind Industroyer are more advanced,\nsince they went to great lengths to create malware capable of directly\ncontrolling switches and circuit breakers. We have seen indications that\n\n\nthis malware could have been the tool used by attackers to cause the\npower outage in Ukraine in December 2016, although at the time of\nwriting, it is not confirmed, and the investigation is still ongoing. The\ninfection vector remains unknown.\n\nThe malware contains multiple modules, as analyzed and described in the\nnext sections of this whitepaper. However, before diving into those details,\nthe following simplified schematic shows the connections between the\ncomponents of the malware.\n\nFigure 1. Simplified schematic of Win32/Industroyer components.\n\n[While some components (e.g. Data wiper) are similar in concept to the 2015](https://www.welivesecurity.com/2016/01/03/blackenergy-sshbeardoor-details-2015-attacks-ukrainian-news-media-electric-industry/)\n_[BlackEnergy attacks against power grid companies in Ukraine, we don’t see](https://www.welivesecurity.com/2016/01/03/blackenergy-sshbeardoor-details-2015-attacks-ukrainian-news-media-electric-industry/)_\nany link between those attacks and the code in this malware.\n\n\n-----\n\n## Main backdoor\n\nWe refer to the core component of Industroyer as the main backdoor. The\nmain backdoor is used by the attackers behind Industroyer to control all\nother components of the malware.\n\nAs backdoors go, this component is pretty straightforward, connecting\nto its remote C&C server using HTTPS and receiving commands from\nthe attackers. All analyzed samples are hardcoded to use the same proxy\naddress, located in the local network. Thus, the backdoor is clearly designed\nto work only in one specific organization. It is also worth mentioning that\nmost of the C&C servers used by this backdoor are running Tor software.\n\nPerhaps the most interesting feature of this backdoor is that attackers\ncan define a specific hour of the day when the backdoor will be active.\nFor example, the attackers can modify the backdoor in this way so it will\ncommunicate with its C&C server only outside working hours. This can make\ndetection based only on network traffic examination harder. However, all the\nsamples analyzed so far are set to work 24 hours round the clock.\n\nFigure 2. The decompiled main backdoor code has a check for time-of-day.\n\n\nOnce connected to its remote C&C server, the main backdoor component\nsends the following data in a POST-request:\n\n- the globally unique identifier (GUID) string for the current hardware\nprofile retrieved via GetCurrentHwProfile\n\n- the version of the malware: 1.1e\n\n- the hardcoded ID of the sample\n\n- the result of any previously-received command\n\nThe hardcoded ID is used by the attacker as an identifier for the infected\nmachine. Across all analyzed samples we found the following hardcoded ID\nvalues:\n\n- DEF\n\n- DEF-C\n\n- DEF-WS\n\n- DEF-EP\n\n- DC-2-TEMP\n\n- DC-2\n\n- CES-McA-TEMP\n\n- CES\n\n- SRV_WSUS\n\n- SRV_DC-2\n\n- SCE-WSUS01\n\nThe main backdoor component supports the following commands:\n\n\nCommand ID Purpose\n\n\n0 Execute a process\n\n1 Execute a process under a specific user account.\nCredentials for the account are supplied by the\nattacker\n\n2 Download a file from C&C server\n\n3 Copy a file\n\n\n-----\n\n4 Execute a shell command\n\n5 Execute a shell command under a specific user\naccount. Credentials for the account are supplied\nby the attacker\n\n6 Quit\n\n7 Stop a service\n\n8 Stop a service under a specific user account.\nCredentials for the account are supplied by\nthe attacker\n\n9 Start a service under a specific user account.\nCredentials for the account are supplied by\nthe attacker\n\n10 Replace \"Image path\" registry value for a service\n\nOnce the attackers obtain administrator privileges, they can upgrade\nthe installed backdoor to a more privileged version that is executed as\n[a Windows service program. To do this they pick an existing, non-critical](https://msdn.microsoft.com/en-us/library/windows/desktop/ms685967(v=vs.85).aspx)\nWindows service and replace its ImagePath registry value with the path of\nthe new backdoor’s binary.\n\nThe functionality of the main backdoor that works as a Windows service\nis the same as just described. However, there are two small differences:\nfirst the backdoor’s version is 1.1s, instead of 1.1e, and second, there is code\nobfuscation. The code of this version of the backdoor is mixed with junk\nassembly instructions.\n\n\nFigure 3. The obfuscated assembly code of the main backdoor that works as\na Windows service.\n\n## Additional backdoor\n\nThe additional backdoor provides an alternative persistence mechanism\nthat allows the attackers to regain access to a targeted network in case the\nmain backdoor is detected and/or disabled.\n\nThis backdoor is a trojanized version of the Windows Notepad application.\nThis is a fully functional version of the application, but the malware authors\nhave inserted malicious code that is executed each time the application is\nlaunched. Once the attackers gain administrator privileges, they are able to\nreplace the legitimate Notepad manually.\n\nThe inserted malicious code is heavily obfuscated, but once the code is\ndecrypted it connects to a remote C&C server, which is different to the one\nlinked in the main backdoor, and downloads a payload. This is in the form\n\n\n-----\n\nof shellcode that is loaded directly into memory and executed. In addition,\nthe inserted code decrypts the original Windows Notepad code, which\nis stored at the end of the file, and then passes execution to it. Thus, the\nNotepad application works as expected.\n\nFigure 4. Comparison between original Notepad binary code (at the left)\nand backdoored binary code.\n\n\n## Launcher component\n\nThis component is a separate executable responsible for launching the\npayloads and the Data wiper component.\n\nThe Launcher component contains a specific time and date. Analyzed\nsamples contained two dates, 17[th] December 2016 and 20[th] December 2016.\nOnce one of these dates is reached the component creates two threads.\nThe first thread makes attempts to load a payload DLL, while the second\nthread waits one or two hours (it depends on the Launcher component\nversion) and then attempts to load the Data wiper component. The priority\nfor both threads is set to THREAD_PRIORITY_HIGHEST, which means that\nthese two threads receive a higher than normal share of CPU resources\nfrom the operating system.\n\nThe name of the payload DLL is supplied by the attackers via a command\nline parameter supplied in one of the main backdoor’s “execute a shell\ncommand” commands. The Data wiper component is always named\nhaslo.‌dat. The expected command lines are of the form:\n\n%LAUNCHER%.exe %WORKING_DIRECTORY% %PAYLOAD%.dll\n\n%CONFIGURATION%.ini\n\nEach argument on the command line represents the following:\n\n- %LAUNCHER%.exe is the filename of the Launcher component\n\n- %WORKING_DIRECTORY% is the directory where the payload DLL and\nconfiguration is stored\n\n- %PAYLOAD%.dll is the filename of the payload DLL\n\n- %CONFIGURATION%.ini is the file that stores configuration data for the\nspecified payload. The path to this file is supplied to the payload DLL by\nthe Launcher component\n\nThe payload and Data wiper components are standard Windows DLL files.\nIn order to be loaded by the Launcher component they must export a\nfunction named Crash as seen in Figure 5.\n\n\n-----\n\nFigure 5. Example payload DLL that has internal name Crash101.dll\nand Crash export function.\n\n## 101 payload component\n\nThis payload DLL has the filename 101.dll and is named after IEC 101 (aka\n_[IEC 60870-5-101), an international standard that describes a protocol for](https://en.wikipedia.org/wiki/IEC_60870-5#IEC_60870-5-101)_\nmonitoring and controlling electric power systems. The protocol is used for\ncommunication between industrial control systems and Remote Terminal\nUnits (RTUs). The actual communication is transmitted through a serial\nconnection.\n\nThe 101 payload component partly implements the protocol described in\nthe IEC 101 standard and is able to communicate with an RTU or any other\ndevice with support for that protocol.\n\nOnce executed, the 101 payload component parses the configuration stored\nin its INI file. The configuration may contain several entries: process name,\n\n\nWindows device names (usually COM ports), the number of Information\nObject Address (IOA) ranges, and the beginning and ending IOA values\nfor the specified number of IOA ranges. IOA is a number that identifies\na particular data element in the device. Figure 6 illustrates a 101 payload\nconfiguration file with two defined IOA ranges, 10-15 and 20-25.\n\nFigure 6. An example of a 101 payload DLL configuration.\n\nThe name of the process specified in the configuration belongs to an\napplication the attackers suspect is running on the victim machine. It\nshould be the application the victim machine uses to communicate\nthrough serial connection with the RTU. The 101 payload attempts to\nterminate the specified process and starts to communicate with the\nspecified device, using the CreateFile, WriteFile and ReadFile\nWindows API functions. The first COM port from the configuration file is\nused for the actual communication and the two other COM ports are just\nopened to prevent other processes accessing them. Thus, the 101 payload\ncomponent is able to take over and maintain control of the RTU device.\n\nThis component iterates through all IOAs in the defined IOA ranges.\nFor each such IOA it constructs two “select and execute” packets, one\nwith a single command (C_SC_NA_1) and one with a double command\n(C_DC_NA_1) and sends these to the RTU device. The main goal of the\ncomponent is to change the On/Off state of single command type IOA\n\n\n-----\n\nand double command type IOA. Specifically, the 101 payload has three\nstages: in the first stage this component attempts to switch IOAs to their\nOff state, in the second stage it attempts to invert IOA states to On, and\nin the final stage the component switches IOA states to Off again.\n\nFigure 7. An example of a 101 payload packet, after being dissected in Kaitai Struct WebIDE.\n\n\n## 104 payload component\n\nThis payload DLL has the filename 104.dll and is named after IEC 104 (aka\n_[IEC 60870-5-104), an international standard. The IEC 104 protocol extends](https://en.wikipedia.org/wiki/IEC_60870-5#IEC_60870-5-104)_\nIEC 101, so the protocol can be transmitted over a TCP/IP network.\n\nDue to its highly configurable nature, this payload can be customized\nby the attackers for different infrastructures. Figure 8 shows what a\nconfiguration file may look like.\n\nFigure 8. An example of 104 payload DLL configuration.\n\nOnce executed, the 104 payload DLL attempts to read its configuration file.\nAs described above, the path for the configuration file is supplied by the\nLauncher component.\n\nThe configuration contains a STATION section followed by properties\nthat configure how the 104 payload should work. The configuration may\ncontain multiple STATION entries.\n\n\n-----\n\nOur analysis of this component reveals the following possible\nconfiguration properties:\n\n\nProperty Expected value Purpose\n\n\ntarget_ip IP address The IP address that will be used\nfor the communication using IEC\n104 protocol standard\n\ntarget_port Port number Self-explanatory\n\nuselog 1 or 0 Enables or disables logging\nto a file\n\nlogfile Filename Specifies the filename for the log,\nif enabled\n\nstop_comm_ 1 or 0 Enables or disables termination of\nservice the process\n\nstop_comm_ Process name Specifies the process name that\nservice_name will be terminated\n\ntimeout Timeout in Specifies timeout between send\nmilliseconds and recv calls. Default value:\n15000\n\nsocket_timeout Timeout in Specify the receiving timeout.\nmilliseconds Default value: 15000\n\nsilence 1 or 0 Enables or disables console output\n\nasdu Integer Specifies ASDU (Application\nService Data Unit) address also\nknown as sector\n\nfirst_action on or off Specifies the Switch value in ASDU\npacket for first iteration\n\nchange 1 or 0 Specifies that the Switch value in\nASDU packet should be inverted\nduring iterations\n\ncommand_type def or short Specifies command pulse duration\nor long or persist for qualifier of command (QOC)\n\n\noperation range or Specifies iteration type for\nsequence or shift Information Object Addresses\n(IOA)\n\nrange Specific format of Specifies range of Information\nIOAs Object Addresses (IOA)\n\nsequence Specific format of Specifies sequence of Information\nIOAs Object Addresses (IOA)\n\nshift Specific formatof Specifies shift of Information\nIOAs Object Addresses (IOA)\n\nOnce the configuration file is read, the 104 payload creates a thread for\neach STATION section defined in the configuration file. In each such\nthread, the 104 payload will attempt to communicate with the specified\nIP address using the protocol described in the IEC 104 standard. Before the\nconnection is made, the 104 payload attempts to terminate the legitimate\nprocess that is normally responsible for IEC 104 communication with the\ndevice. It does so only if the stop_comm_service property is specified\nin its configuration. By default, the 104 payload terminates the process\nnamed D2MultiCommService.exe, or the process name specified in its\nconfiguration.\n\nThe main idea behind the 104 payload is relatively simple. It connects to\nthe specified IP address and starts to send packets with the ASDU address\nthat was defined in its configuration. The goal of this communication is to\ninteract with an IOA of a single command type.\n\nIn the configuration file, the attacker can define the operation property to\nspecify exactly how single command type IOAs will be iterated.\n\nThe first such operation mode is the range mode. The attackers use\nthis mode in order to discover possible IOAs in the targeted device. The\nattackers have to take this approach because the protocol described in\nthe IEC 104 standard does not provide a specific method to obtain such\ninformation.\n\n\n-----\n\nThe range mode has two stages. During the first stage, once the range of\nIOAs is obtained from the configuration file, the 104 payload connects to\nthe target IP address and starts to iterate through the specified IOAs. To\neach such IOA the 104 payload sends “select and execute” packets in order\nto switch the state and to confirm whether the IOA belongs to the single\ncommand type.\n\nFigure 9. An example of a 104 payload packet, after being dissected by Wireshark.\n\nOnce all possible IOAs from the specified range are iterated, the 104\npayload switches to the second stage of range mode. If logging is enabled,\nthe payload writes Starting only success to the log. The rest of this\nsecond stage is an infinite loop that uses the previously discovered IOAs of\nsingle command type. In the loop the payload constantly sends “select and\nexecute” packets. In addition, if the option change is defined, the payload\nflips the On/Off state between loop steps.\n\nFigure 10 demonstrates the log file that was produced by the 104 payload\nduring our analysis. It shows the payload iterated IOAs from 10 to 15, and\nonce IOAs of the single command type were discovered, the payload\nstarted to use them in the loop. The configuration had the change option\n\n\nenabled, so between loop iterations the payload flipped the switch value\nfrom On to Off and wrote it to the log.\n\nFigure 10. Example log file produced by the 104 payload\n\nThe second operation mode is the shift mode. This is very similar to\nthe range mode. The attacker defines, in the configuration file, a range of\nIOAs and shift values. Once the 104 payload is activated it does everything\nthe same way as in range mode; however, once all IOAs in the defined\nrange are iterated, it starts to iterate over the new range. The new range is\ncalculated by adding the shift values to the default range values.\n\nThe third operation mode is the sequence mode. It can be used by\nattackers once they know the values of all IOAs of the single command\ntype that are supported by the connected device. This payload immediately\n\n\n-----\n\nexecutes an infinite loop, sending “select and execute” packets to the IOAs\ndefined in the configuration file.\n\nAside from its logging capability, the 104 payload can output debug\ninformation to the console, as seen in Figure 11.\n\nFigure 11. The console output of the 104 payload.\n\n\n## 61850 payload component\n\nUnlike the 101 and 104 payloads, this payload component exists as a\nstandalone malicious tool comprising an executable named 61850.exe\n[and the DLL 61850.dll. It is named after the IEC 61850 standard. This](https://en.wikipedia.org/wiki/IEC_61850)\nstandard describes a protocol used for multivendor communication among\ndevices that perform protection, automation, metering, monitoring, and\ncontrol of electrical substation automation systems. The protocol is very\ncomplex and robust, but the 61850 payload uses only a small subset of the\nprotocol to produce its disruptive effect.\n\nOnce executed, the 61850 payload DLL attempts to read the configuration\nfile, the path to which is supplied by the Launcher component. The\nstandalone version defaults to reading its configuration from i.ini. The\nconfiguration file is expected to contain a list of IP addresses of devices\ncapable of communicating via the protocol described in the IEC 61850\nstandard.\n\nIf the configuration file is not present, then this component enumerates all\nconnected network adaptors to determine their TCP/IP subnet masks. The\n61850 payload then enumerates all possible IP addresses for each of these\nsubnet masks, and tries to connect to port 102 on each of those addresses.\nTherefore, this component has the ability to discover relevant devices in the\nnetwork automatically.\n\nOtherwise, if a configuration file is present and it contains target IP\naddresses, this component connects to port 102 on those IP addresses and\non IP addresses that were discovered automatically.\n\nOnce this component connects to a target host, it sends a Connection\nRequest packet using the Connection Oriented Transport Protocol, as seen\nin Figure 12.\n\n\n-----\n\nFigure 12. A Connection Request packet, after dissection by Wireshark.\n\nIf the target device responds appropriately, the 61850 payload then sends\n[an InitiateRequest packet using the Manufacturing Message Specification](https://en.wikipedia.org/wiki/Manufacturing_Message_Specification)\n(MMS). If the expected answer is received, it continues, sending an MMS\ngetNameList request. Thereby, the component compiles a list of object\nnames in a Virtual Manufacturing Device (VMD).\n\nNext, this component enumerates the objects discovered in the previous\nstep and sends the device domain-specific getNameList requests with\neach object name. This enumerates named variables in a specific domain.\n\n\nFigure 13. The dissected MMS getNameList request in Wireshark.\n\nAfterwards, the 61850 payload parses data received in response to these\nrequests, searching for variables that contain following combinations of\nstrings:\n\n- CSW, CF, Pos, and Model\n\n- CSW, ST, Pos, and stVal\n\n- CSW, CO, Pos, Oper, but not $T\n\n- CSW, CO, Pos, SBO, but not $T\n\nThe string CSW is a name for logical nodes, which are used to control\ncircuit breakers and switches.\n\nFor variables that contain the Model or stVal string the 61850 payload sends\nan additional MMS Read request. For some of the variables this component\nmay also issue an MMS Write request that will change its state.\n\n\n-----\n\nThe 61850 payload produces a log file of its operations that contains the IP\naddresses, MMS domains, named variables and the node states (open or\nclosed) of its targets.\n\n## OPC DA payload component\n\nThe OPC DA payload component implements a client for the protocol\n[described in the OPC Data Access specification. OPC (OLE for Process](https://en.wikipedia.org/wiki/OPC_Data_Access)\n_[Control) is a software standard and specification that is based on Microsoft](https://en.wikipedia.org/wiki/Open_Platform_Communications)_\ntechnologies such as OLE, COM, and DCOM. The Data Access (DA) part of\nthe OPC specification allows real-time data exchange between distributed\ncomponents, based on a client–server model.\n\nThis component exists as a standalone malicious tool with the filename\nOPC.exe and a DLL, which implement both 61850 and OPC DA\npayload functionalities. This DLL is named, internally in PE export table,\nOPCClientDemo.dll, suggesting that the code of this component may be\n[based on the open source project OPC Client.](https://sourceforge.net/projects/opcclient/)\n\nFigure 14. The PE export reveals the internal DLL name of the OPC DA payload.\n\nThe OPC DA payload does not require any kind of configuration file.\nOnce executed by the attacker, it enumerates all OPC servers using the\nICatInformation::EnumClassesOfCategories method with CATID_\n```\nOPCDAServer20 category identifier and IOPCServer::GetStatus to\n\n```\nidentify the ones running.\n\n\nNext the component uses the IOPCBrowseServerAddressSpace\ninterface to enumerate all OPC items on the server. Specifically, it looks for\nitems that contain the following strings in their name:\n\n- ctlSelOn\n\n- ctlOperOn\n\n- ctlSelOff\n\n- ctlOperOff\n\n- \\Pos and stVal\n\nThe names of these items may suggest that attackers are interested in\n[OPC items provided by OPC servers that belong to solutions from ABB,](http://new.abb.com/)\n[such as their MicroSCADA range. Figure 15 demonstrates an example list of](http://new.abb.com/substation-automation/products/software/microscada-pro)\nOPC items that contain names with similar strings. This list of OPC items is\nreceived by the OPC Process Objects List Tool from ABB.\n\nFigure 15. An example of OPC items names in IN field received using\nOPC Process Objects List Tool.\n\n\n-----\n\nThe attackers use the string Abdul when they add a new OPC group.\nPossibly this string is used by the attackers as a slang term when referring\nto the ABB solutions.\n\nFigure 16. The disassembled code of the OPC DA component that uses the Abdul string.\n\nOn the final step, the OPC DA payload attempts to change the state of\ndiscovered OPC items using the IOPCSyncIO interface by writing the 0x01\nvalue twice.\n\nFigure 17. Disassembled code of OPC DA payload that uses IOPCSyncIO interface.\n\n\nThe component writes the OPC server name, OPC item name state, quality\ncode and value to the log file. The logged values are separated with the\nfollowing headers:\n\n- [*ServerName: %SERVERNAME%] [State: Before]\n\n- [*ServerName: %SERVERNAME%] [State: After ON]\n\n- [*ServerName: %SERVERNAME%] [State: After OFF]\n\n## Data wiper component\n\nThe data wiper component is a destructive module that is used in the final\nstage of an attack. The attackers are using this component to hide their\ntracks and to make recovery difficult.\n\nThis component has the filename haslo.dat or haslo.exe and can\nbe executed by the Launcher component or used as a standalone\nmalicious tool.\n\nOnce executed it attempts to enumerate all keys in the registry that list\nWindows services:\n\n- HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\n\nIt attempts to set the registry value ImagePath with an empty string in\neach of the entries found. This operation will make the operating system\nunbootable.\n\nThe next step is actual deletion of file contents. The component\nenumerates files with specific file extensions on all drives connected to\ncomputer, from C:\\ to Z:\\. It should be noted that during enumeration\nthe component skips files that are located in subdirectory that contains\nWindows in its name.\n\nThe component rewrites file content with meaningless data obtained from\nnewly allocated memory. In order to perform this operation thoroughly the\ncomponent attempts to rewrite files twice. The first attempt happens once\nthe file is found on a drive. If the first attempt is unsuccessful then the wiper\nl k d tt t b t b f th t th l t i t\n\n\n-----\n\nall processes except those included in a list of critical system processes. The\nlist of these processes is displayed in Figure 18.\n\nTo speed up the wiping operation this component rewrites only partial file\ncontent at the beginning of the file. The amount of data to be rewritten\ndepends on file size: the smallest amount of data will be rewritten for files\nless than or equal to 1Mb (4096 bytes); the largest amount of data will be\nrewritten for files less than or equal to 10Mb (32768 bytes).\n\nFinally, this component attempts to terminate all processes (including\nsystem processes) except its own. This will result in the system becoming\nunresponsive and eventually crashing.\n\nFigure 18. List of processes that are not terminated on second rewriting attempt.\n\nThe filename masks targeted by the data wiper component to be\noverwritten are:\n\nSYS_BASCON.COM *.pcmi *.bk\n\n*.v *.pcmt *.bkp\n\n*.PL *.ini *.log\n\n*.paf *.xml *.zip\n\n*.XRF *.CIN *.rar\n\n*.trc *.prj *.tar\n\n\n*.SCL *.cxm *.7z\n\n*.bak *.elb *.exe\n\n*.cid *.epl *.dll\n\n*.scd *.mdf\n\n*.pcmp *.ldf\n\nThis list contains filename extensions that are used in a standard\nenvironment, such as Windows binaries (.exe/.dll), archives (.7z /.tar/.rar/.\nzip), backup files (.bak/.bk/.bkp), Microsoft SQL server files (.mdf/.ldf),\nand various configuration files (.ini/.xml). In addition, the component also\nwipes files that may be used in industrial control systems, such as files\n[written using Substation Configuration description Language (.scl/.cid/.scd) and](https://en.wikipedia.org/wiki/Substation_Configuration_Language)\nthere are many files and file extensions that are used by various products\nfrom ABB. For example, a file named SYS_BASCON.COM is used by ABB\nsolutions for storing configuration data, and files with the .paf (Product\nAuthorization File) filename extension are used to store license data\nfor ABB MicroSCADA products.\n\n## Additional tools: port scanner tool\n\nThe attackers’ arsenal includes a port scanner that can be used to map\nthe network and to find computers relevant to their attack. Interestingly,\ninstead of using software already existing, the attackers built their own\ncustom-made port scanner. As is evident from Figure 19, the attacker can\ndefine a range of IP addresses and a range of network ports that are to be\nscanned by this tool.\n\nFigure 19. The port scanner tool usage example.\n\n\n-----\n\n## Additional tools: DoS tool\n\nAnother tool from the attackers’ arsenal is a Denial-of-Service (DoS) tool\nthat can be used against Siemens SIPROTEC devices. This tool leverages\n[the CVE-2015-5374 vulnerability in order to render a device unresponsive.](https://ics-cert.us-cert.gov/advisories/ICSA-15-202-01)\nOnce this vulnerability is successfully exploited, the target device stops\nresponding to any commands until it is rebooted manually.\n\nTo exploit this vulnerability the attackers hardcoded the device IP addresses\ninto this tool. Once the tool is executed it sends specifically crafted packets\nto port 50,000 of the target IP addresses using UDP. The UDP packet\ncontains only 18 bytes.\n\nFigure 20. Content of UDP packet used during exploitation of CVE-2015-5374.\n\n## Conclusion\n\nThe investigation behind the Ukrainian power outage last December is still\nongoing and it is currently not confirmed that the malware analyzed here\nwas the direct cause. Nevertheless, we believe that to be a very probable\nexplanation, as the malware is able to directly control switches and circuit\nbreakers at power grid substations using four ICS protocols and contains an\nactivation timestamp for December 17, 2016, the day of the power outage.\n\nWe can definitely say that the Win32/Industroyer malware family is an\nadvanced and sophisticated piece of malware that is used against industrial\ncontrol systems. However, it should be noted that the malware itself is just\na tool in the hands of an even more advanced and very capable malicious\nactor. Using logs produced by the toolset and highly configurable payloads,\nthe attackers could adapt the malware to any comparable environment.\n\n\nThe commonly-used industrial control protocols used in this malware\nwere designed decades ago without taking security into consideration.\nTherefore, any intrusion into an industrial network with systems using\nthese protocols should be considered as “game over”.\n\n## Indicators of Compromise (IoC)\n\n### SHA-1 hashes:\n```\nF6C21F8189CED6AE150F9EF2E82A3A57843B587D\nCCCCE62996D578B984984426A024D9B250237533\n8E39ECA1E48240C01EE570631AE8F0C9A9637187\n2CB8230281B86FA944D3043AE906016C8B5984D9\n79CA89711CDAEDB16B0CCCCFDCFBD6AA7E57120A\n94488F214B165512D2FC0438A581F5C9E3BD4D4C\n5A5FAFBC3FEC8D36FD57B075EBF34119BA3BFF04\nB92149F046F00BB69DE329B8457D32C24726EE00\nB335163E6EB854DF5E08E85026B2C3518891EDA8\n\n IP addresses of C&C servers:\n\n```\n195.16.88[.]6\n46.28.200[.]132\n188.42.253[.]43\n5.39.218[.]152\n93.115.27[.]57\n\nWarning! Most of the servers with these IP addresses were part of Tor\nnetwork which means that the use of these indicators could result in a\nfalse positive match.\n\n\n-----\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "99fdc3ef-333d-48f5-a4a1-becd788c7b80",
            "created_at": "2022-10-25T15:28:29.802983Z",
            "updated_at": "2022-10-25T15:28:29.802983Z",
            "deleted_at": null,
            "name": "MITRE",
            "url": "https://github.com/mitre-attack/attack-stix-data",
            "description": "MITRE ATT&CK STIX Data",
            "reports": null
        },
        {
            "id": "d63ae2b7-445f-460d-965d-2676dacdb6de",
            "created_at": "2022-10-25T15:59:19.552139Z",
            "updated_at": "2022-10-25T15:59:19.552139Z",
            "deleted_at": null,
            "name": "APTnotes",
            "url": "https://github.com/aptnotes/data",
            "description": "APTnotes data",
            "reports": null
        },
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        },
        {
            "id": "6fc23d14-23a6-4870-8fad-b291b182596f",
            "created_at": "2022-10-25T16:07:18.480113Z",
            "updated_at": "2022-10-25T16:07:18.480113Z",
            "deleted_at": null,
            "name": "ETDA",
            "url": "https://apt.etda.or.th",
            "description": "Threat Group Cards: A Threat Actor Encyclopedia",
            "reports": null
        },
        {
            "id": "bf5be533-fa31-4590-ae37-5761c97ffa34",
            "created_at": "2022-10-25T16:13:58.389257Z",
            "updated_at": "2022-10-25T16:13:58.389257Z",
            "deleted_at": null,
            "name": "Malpedia",
            "url": "https://malpedia.caad.fkie.fraunhofer.de",
            "description": "Malpedia is a free service offered by Fraunhofer FKIE",
            "reports": null
        },
        {
            "id": "5910e58f-4bc9-4e4e-9dbb-887804094a01",
            "created_at": "2022-10-25T16:32:58.457399Z",
            "updated_at": "2022-10-25T16:32:58.457399Z",
            "deleted_at": null,
            "name": "OTX",
            "url": "https://otx.alienvault.com",
            "description": "Alienvault Open Threat Exchange (OTX)",
            "reports": null
        },
        {
            "id": "99593a68-7f6e-400e-9a9f-a707f66d2e72",
            "created_at": "2022-11-23T11:07:14.353321Z",
            "updated_at": "2022-11-23T11:07:14.353321Z",
            "deleted_at": null,
            "name": "AGRO",
            "url": "https://apt.threattracking.com",
            "description": "APT Groups and Operations Spreadsheet",
            "reports": null
        },
        {
            "id": "6825b8cb-7d82-43d2-b0b0-d51c7e255b42",
            "created_at": "2023-01-06T13:46:37.642134Z",
            "updated_at": "2023-01-06T13:46:37.642134Z",
            "deleted_at": null,
            "name": "MISPGALAXY",
            "url": "https://www.misp-project.org/galaxy.html",
            "description": "MISP Galaxy Clusters",
            "reports": null
        },
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://www.welivesecurity.com/wp-content/uploads/2017/06/Win32_Industroyer.pdf",
        "https://app.box.com/s/ec8zyav7snvm6vsfhy8ocvvngphe8lqp",
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2017/2017.06.12.INDUSTROYER/Win32_Industroyer.pdf",
        "https://papers.vx-underground.org/papers/ICS SCADA/Industroyer/2017-06-12 - Win32_Industroyer A New Threat for Industrial Control Systems.pdf"
    ],
    "report_names": [
        "Win32_Industroyer.pdf",
        "ESET_Win32_Industroyer(06-12-2017)",
        "Win32_Industroyer",
        "2017-06-12 - Win32_Industroyer A New Threat for Industrial Control Systems.pdf"
    ],
    "threat_actors": [
        {
            "id": "42a6a29d-6b98-4fd6-a742-a45a0306c7b0",
            "created_at": "2022-10-25T15:50:23.710403Z",
            "updated_at": "2025-03-27T02:00:55.531313Z",
            "deleted_at": null,
            "main_name": "Silence",
            "aliases": [
                "Whisper Spider"
            ],
            "source_name": "MITRE:Silence",
            "tools": [
                "Winexe",
                "SDelete"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "88e53203-891a-46f8-9ced-81d874a271c4",
            "created_at": "2022-10-25T16:07:24.191982Z",
            "updated_at": "2025-03-27T02:02:10.13692Z",
            "deleted_at": null,
            "main_name": "Silence",
            "aliases": [
                "ATK 86",
                "Contract Crew",
                "TAG-CR8",
                "TEMP.TruthTeller",
                "Whisper Spider"
            ],
            "source_name": "ETDA:Silence",
            "tools": [
                "EDA",
                "EmpireDNSAgent",
                "Farse",
                "Ivoke",
                "Kikothac",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "Meterpreter",
                "ProxyBot",
                "ReconModule",
                "Silence.Downloader",
                "TiniMet",
                "TinyMet",
                "TrueBot",
                "xfs-disp.exe"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "b3e954e8-8bbb-46f3-84de-d6f12dc7e1a6",
            "created_at": "2022-10-25T15:50:23.339976Z",
            "updated_at": "2025-03-27T02:00:55.446795Z",
            "deleted_at": null,
            "main_name": "Sandworm Team",
            "aliases": [
                "Sandworm Team",
                "ELECTRUM",
                "Telebots",
                "IRON VIKING",
                "BlackEnergy (Group)",
                "Quedagh",
                "Voodoo Bear",
                "IRIDIUM",
                "Seashell Blizzard",
                "FROZENBARENTS",
                "APT44"
            ],
            "source_name": "MITRE:Sandworm Team",
            "tools": [
                "Bad Rabbit",
                "Mimikatz",
                "Exaramel for Linux",
                "Exaramel for Windows",
                "GreyEnergy",
                "PsExec",
                "Prestige",
                "P.A.S. Webshell",
                "VPNFilter",
                "Cyclops Blink",
                "SDelete",
                "AcidRain",
                "Industroyer",
                "Industroyer2",
                "BlackEnergy",
                "Cobalt Strike",
                "NotPetya",
                "KillDisk",
                "PoshC2",
                "Impacket",
                "Invoke-PSImage",
                "Olympic Destroyer"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1666716490,
    "ts_updated_at": 1743041331,
    "ts_creation_date": 1497290338,
    "ts_modification_date": 1497290341,
    "files": {
        "pdf": "https://archive.orkl.eu/9e6f9b8b5b22c32c1ec5d53ed1992f8f83013140.pdf",
        "text": "https://archive.orkl.eu/9e6f9b8b5b22c32c1ec5d53ed1992f8f83013140.txt",
        "img": "https://archive.orkl.eu/9e6f9b8b5b22c32c1ec5d53ed1992f8f83013140.jpg"
    }
}