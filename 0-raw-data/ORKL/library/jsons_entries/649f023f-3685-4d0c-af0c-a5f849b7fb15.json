{
    "id": "649f023f-3685-4d0c-af0c-a5f849b7fb15",
    "created_at": "2023-01-12T15:04:46.919916Z",
    "updated_at": "2025-03-27T02:16:01.191095Z",
    "deleted_at": null,
    "sha1_hash": "9daa51425a363ee5d1e69d97e796fe88bbe8fd60",
    "title": "2019-11-29 - Operation ENDTRADE- Finding Multi-Stage Backdoors that TICK",
    "authors": "",
    "file_creation_date": "2022-05-27T22:34:22Z",
    "file_modification_date": "2022-05-27T22:34:22Z",
    "file_size": 239858,
    "plain_text": "# Operation ENDTRADE: Multi-Stage Backdoors that TICK\n\n**[blog.trendmicro.com/trendlabs-security-intelligence/operation-endtrade-finding-multi-stage-backdoors-that-tick/](https://blog.trendmicro.com/trendlabs-security-intelligence/operation-endtrade-finding-multi-stage-backdoors-that-tick/)**\n\nNovember 29, 2019\n\nWhile we have been following cyberespionage group TICK (a.k.a. “BRONZE BUTLER” or\n“REDBALDKNIGHT”) since 2008, we noticed an unusual increase in malware development\nand deployments towards November 2018. We already know that the group uses previously\ndeployed malware and modified tools for obfuscation, but we also found TICK developing\nnew malware families capable of detection evasion for initial intrusion, as well as escalation\nof administrative privileges for subsequent attacks and data collection. We also found the\ngroup using legitimate email accounts and credentials for the delivery of the malware,\nzeroing in on industries with highly classified information: defense, aerospace, chemical, and\nsatellite industries with head offices in Japan and subsidiaries in China. Given their targets,\nwe have named this campaign “Operation ENDTRADE,” and identified some of the findings\nin our research “Operation ENDTRADE: TICK’s Multi-Stage Backdoors for Attacking\n_Industries and Stealing Classified Data”._\n\nThis research paper was submitted and presented for the DeepINTEL Security Intelligence\n2019 Conference on November 27, 2019 in Vienna, Austria.\n\n**Targeting and malware delivery**\n\nFigure 1. Operation ENDTRADE’s timeline\n\n\n-----\n\nAs part of their attacks in January 2019, TICK was conducting their research by\ncompromising a Japanese economic research company and a public relations (PR) agency\nto steal email credentials and files as decoy documents. These email addresses were used\nfor spear phishing, prompting potential victim organizations to open the attachments with\nmalware payloads. Meanwhile, the documents were embedded with malware, and sent to\nindividuals and companies knowledgeable in Japanese or Chinese, and interested in the\nChinese economy. The emails had the following features:\n\nThey were sent from legitimate email accounts\nThey were written as legitimate reports and prompted the users to open the\nattachments\nThey contained subject topics related to “salary rate increase” or “job market,” or with\nspecial interests in the economic affairs of China such as the US-China trade mandates\n\nFigure 2. Spear phishing sample in fluent Japanese\n\nBased on the language that was hardcoded in the samples we found, TICK appeared to be\ntargeting Japanese organizations with subsidiaries in China to serve as footholds for\nintrusion: TICK hard-coded two code pages 932 and 936, referring to Japanese and\nSimplified Chinese characters respectively. Moreover, we found successful transfers of\nmalicious executable files in the shared folder from a Chinese subsidiary with an infected\ndesktop, and an employee in Japan that executed the said file.\n\nFigure 3. Language code pages\n\nWhile we found intrusions in a large number of companies in the abovementioned industries\nbefore May 2019, further analysis revealed that one of the main targets was the defense\nsector. We found TICK trying to steal military-related documents from the victim network\nduring an extended assistance for incident response in the region. However, TICK seemed to\nshift their attention to the chemical industry by mid-May, which may indicate the group’s\nsponsor organization’s goal: To steal proprietary and classified information such as military\ndata and advanced materials.\n\n**Malware Analysis**\n\nOur research lists some of the new and adjusted malware routines we found from Operation\nENDTRADE, which we named based on their characteristic program database (PDB)\nstrings. For a complete list and analyses of the trojans, downloaders, and modified tools, you\n[may access the research brief here.](https://documents.trendmicro.com/assets/pdf/Operation-ENDTRADE-TICK-s-Multi-Stage-Backdoors-for-Attacking-Industries-and-Stealing-Classified-Data.pdf)\n\nFigure 4. New downloaders and trojans\n\n\n-----\n\n**_DATPER_**\n\nWhile this backdoor routine has been associated with TICK’s weapons arsenal, the sample\nwe derived from this campaign had two adjusted mutex objects — d0ftyzxcdrfdqwe and\n_*&Hjgfc49gna-2-tjb — that retrieve information from the victim’s machine. The latest variant_\nalso has a new set of parameters that allow it to evade anti-virus (AV) product pattern\ndetections, implying the ease by which the group can change their routines to suit their\ngoals.\n\nFigure 5. DATPER’s new mutex with separate parameters\n\n**_down_new_**\n\nThis malware combines features of existing trojans in the malware family’s development,\nbased on the adjustments TICK made as we analyzed their test versions. It adds features\n(listed below) that can be found separately on previous iterations:\n\nAdds Autorun to the registry.\nGets MAC address and volume information to send back to the C&C.\nExecutes only during working hours (8:00AM-6:00PM, using kernel32.GetLocalTime\nAPI)\nUses AES encryption and base64 encoding method to encrypt the call back message.\nUses legitimate websites for the C&C server.\nDetects anti-virus products and processes.\n\nFigure 6. Code showing down_new’s command function\n\nTable 1. down_new command list\n\nAs we studied its processes to compare with the others, the call back information stood out:\nThe HTTP post header is hard-coded in the sample, getting the infected machine’s specific\ninformation to single out the identity of the users. As a cyber-espionage group with specific\ngoals based on their sponsoring organization’s objectives, TICK only goes after specific\ntargets and only uses other non-targeted individuals and enterprises as footholds to meet\ntheir purposes.\n\nFigure 7. down_new collects home phone data and URL path\n\n**_Avenger_**\n\nOur analysis found that Avenger has a number of variants and versions depending on their\ntargets. For example, some variants have autorun functions while others execute a sleep\nmode upon system infection We found that the downloader has three stages:\n\n\n-----\n\n1. The first stage collects volume information, AV product, and OS bits version from the\n\nhost, and sends it to the command and control (C&C) server to ensure that the host is\nthe intended target.\n\nFigure 8. First stage: Information collection\n\n2. It then checks if the host matches their C&C server reference. Avenger collects the\nvictim’s detailed information from the system by browsing the folders, files, and domain\ninformation.\n\nFigure 9. Second stage: Collected information is written into a .txt file\n\n3. If the host doesn’t exist, Avenger will download an image with an embedded\nmalware hidden via steganography and extract a backdoor.\n\nFigure 10. Third stage: Sending the encrypted file to the C&C\n\nWhile steganography is always used as part of TICK’s malware techniques, we found that\nthe group used a more sophisticated steganography technique in this campaign.\n\nFigure 11. Backdoor found in the steganography image\n\nFigure 12. Upgraded steganography technique\n\nWe found a newer version of Avenger with a clearer code structure and internal IP testing\nURL (aptly named Avenger2 in the PDB strings), though the rest of the components had\nminimal differences with the previous version.\n\nFigure 13. Avenger2 with internal URL\n\n**_Casper_**\n\nCasper is a modified version of the Cobalt Strike backdoor, showing the team server SHA1\nhash if the controller connects to the C&C. If accessed by the client, Cobalt Strike confirms\nwith the user if they recognize and match the SHA1 hash of a specific team server’s SSL\ncertificate.\n\nFigure 14. Casper C&C with Cobalt Strike’s server fingerprint\n\nThe backdoor is usually hidden in the steganography photo and uses several techniques and\ntools to bypass AV detection. One technique involves launching itself with a legitimate\nWindows application with Dynamic Link Library (DLL) side loading techniques. Another\ninvolves injecting the backdoor’s shellcode into svchost.exe.\n\n\n-----\n\nFigure 15. Shellcode injected to svchost.exe\n\n**Publicly available RATs and modified tools**\n\nIncluded in all the malware routines, we also found TICK using publicly available remote\naccess trojans (RATs) and ope n source tools, and either modified or imported the\n[techniques into their malware. For instance, they cloned Lilith RAT from GitHub, studied and](https://github.com/werkamsus/Lilith/issues/3)\nimplemented its features into their customized backdoor under continued development. The\nlist of modified tools the group used include Mimikatz, RAR compression tool, port mapping\ntool, and screen capture.\n\nFigure 16. Modified screen capture tool\n\nFigure 17. Modified Mimikatz\n\n**Conclusion**\n\nTICK is an organized and persistent cyber espionage group specialized in targeting highvalue individuals and organizations, with the skills and resources needed to coordinate\nsophisticated attacks.\n\nThis operation not only highlights the need for stronger monitoring systems foremost in\ncountries’ critical infrastructures and multinational enterprises, but also firmer operational\nchains of command and redundant security policies established. Persistent criminal groups\nwill continue to target enterprises, and will look for security gaps to exploit to gain\nunauthorized entry. Organizations with foreign subsidiaries can make it difficult to take\ncontrol and implement security procedures and policies, making monitoring, isolating,\ninvestigating, incident response, and recovery more difficult. To top it all, employees’ security\nawareness and consciousness will remain a significant part of making sure the security\nmeasures in place are maintained for regular operations.\n\n[Trend Micro™ Deep Discovery™ provides detection, in-depth analysis, and proactive](https://blog.trendmicro.com/en_us/business/products/network/advanced-threat-protection/deep-discovery-threat-intelligence-network-analytics.html)\nresponse to today’s stealthy malware and targeted attacks in real-time. It provides a\ncomprehensive defense tailored to protect organizations against targeted attacks and\n[advanced threats through specialized engines, custom sandboxing, and seamless](http://blog.trendmicro.com/trendlabs-security-intelligence/deploying-a-smart-sandbox-for-unknown-threats-and-zero-day-attacks/)\ncorrelation across the entire attack lifecycle, allowing it to detect threats like TICK’s attacks\n[even without any engine or pattern update. Trend Micro™ Deep Security™ provides virtual](https://blog.trendmicro.com/en_us/business/products/hybrid-cloud/deep-security.html)\npatching that protects endpoints from threats that abuses unpatched vulnerabilities.\n\n[Trend Micro’s suite of security solutions is powered by XGen™ security, which features high-](https://blog.trendmicro.com/en_us/business/solutions.html)\n[fidelity machine learning to secure the gateway and endpoint data and applications. XGen™](https://blog.trendmicro.com/en_us/business/products/user-protection/sps.html)\nprotects against today’s purpose-built threats that bypass traditional controls, exploit known,\n\n\n-----\n\nunknown, or undisclosed vulnerabilities, and either steal or encrypt personally-identifiable\ndata.\n\nFor the full technical analyses of all the malware, techniques, tools, MITRE ATT&CK\ntechniques and indicators of compromise (IoCs) we found in this campaign, download the\nresearch brief, “Operation ENDTRADE: TICK’s Multi-Stage Backdoors for Attacking\n_Industries and Stealing Classified Data”._\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2019/2019-11-29 - Operation ENDTRADE- Finding Multi-Stage Backdoors that TICK.pdf"
    ],
    "report_names": [
        "2019-11-29 - Operation ENDTRADE- Finding Multi-Stage Backdoors that TICK.pdf"
    ],
    "threat_actors": [
        {
            "id": "d90307b6-14a9-4d0b-9156-89e453d6eb13",
            "created_at": "2022-10-25T16:07:23.773944Z",
            "updated_at": "2025-03-27T02:02:09.974695Z",
            "deleted_at": null,
            "main_name": "Lead",
            "aliases": [
                "Casper",
                "TG-3279"
            ],
            "source_name": "ETDA:Lead",
            "tools": [
                "Agentemis",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "RbDoor",
                "RibDoor",
                "Winnti",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "610a7295-3139-4f34-8cec-b3da40add480",
            "created_at": "2023-01-06T13:46:38.608142Z",
            "updated_at": "2025-03-27T02:00:02.87217Z",
            "deleted_at": null,
            "main_name": "Cobalt",
            "aliases": [
                "Cobalt Gang",
                "GOLD KINGSWOOD",
                "COBALT SPIDER",
                "G0080",
                "Mule Libra",
                "Cobalt Group"
            ],
            "source_name": "MISPGALAXY:Cobalt",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "f8dddd06-da24-4184-9e24-4c22bdd1cbbf",
            "created_at": "2023-01-06T13:46:38.626906Z",
            "updated_at": "2025-03-27T02:00:02.877001Z",
            "deleted_at": null,
            "main_name": "Tick",
            "aliases": [
                "Stalker Taurus",
                "PLA Unit 61419",
                "Nian",
                "BRONZE BUTLER",
                "REDBALDKNIGHT",
                "STALKER PANDA",
                "G0060"
            ],
            "source_name": "MISPGALAXY:Tick",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "bbefc37d-475c-4d4d-b80b-7a55f896de82",
            "created_at": "2022-10-25T15:50:23.571783Z",
            "updated_at": "2025-03-27T02:00:55.502112Z",
            "deleted_at": null,
            "main_name": "BRONZE BUTLER",
            "aliases": [
                "BRONZE BUTLER",
                "REDBALDKNIGHT"
            ],
            "source_name": "MITRE:BRONZE BUTLER",
            "tools": [
                "Mimikatz",
                "build_downer",
                "cmd",
                "ABK",
                "at",
                "BBK",
                "schtasks",
                "down_new",
                "Daserf",
                "ShadowPad",
                "Windows Credential Editor",
                "gsecdump"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "d4e7cd9a-2290-4f89-a645-85b9a46d004b",
            "created_at": "2022-10-25T16:07:23.419513Z",
            "updated_at": "2025-03-27T02:02:09.790389Z",
            "deleted_at": null,
            "main_name": "Bronze Butler",
            "aliases": [
                "Bronze Butler",
                "CTG-2006",
                "Operation ENDTRADE",
                "RedBaldNight",
                "Stalker Panda",
                "Stalker Taurus",
                "TEMP.Tick",
                "Tick"
            ],
            "source_name": "ETDA:Bronze Butler",
            "tools": [
                "8.t Dropper",
                "8.t RTF exploit builder",
                "8t_dropper",
                "9002 RAT",
                "AngryRebel",
                "Blogspot",
                "Daserf",
                "Datper",
                "Elirks",
                "Farfli",
                "Gh0st RAT",
                "Ghost RAT",
                "HOMEUNIX",
                "HidraQ",
                "HomamDownloader",
                "Homux",
                "Hydraq",
                "Lilith",
                "Lilith RAT",
                "McRAT",
                "MdmBot",
                "Mimikatz",
                "Minzen",
                "Moudour",
                "Muirim",
                "Mydoor",
                "Nioupale",
                "PCRat",
                "POISONPLUG.SHADOW",
                "Roarur",
                "RoyalRoad",
                "ShadowPad Winnti",
                "ShadowWali",
                "ShadowWalker",
                "SymonLoader",
                "WCE",
                "Wali",
                "Windows Credential Editor",
                "Windows Credentials Editor",
                "XShellGhost",
                "XXMM",
                "gsecdump",
                "rarstar"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "bf0489c5-1c07-41e6-91c9-855ad96ccc6a",
            "created_at": "2022-10-25T16:47:55.541639Z",
            "updated_at": "2025-03-27T02:05:17.253496Z",
            "deleted_at": null,
            "main_name": "BRONZE BUTLER",
            "aliases": [
                "Daserf",
                "Stalker Panda ",
                "Tick ",
                "CTG-2006 "
            ],
            "source_name": "Secureworks:BRONZE BUTLER",
            "tools": [
                " DGet",
                " Daserf",
                " Datper",
                " Gofarer",
                " MSGet",
                " Mimikatz",
                " RarStar",
                " Screen Capture Tool",
                " ShadowPad",
                " T-SMB",
                " WinRAR",
                " Windows Credential Editor",
                " gsecdump",
                " xmm downloader",
                " xxmm",
                "ABK"
            ],
            "source_id": "Secureworks",
            "reports": null
        }
    ],
    "ts_created_at": 1673535886,
    "ts_updated_at": 1743041761,
    "ts_creation_date": 1653690862,
    "ts_modification_date": 1653690862,
    "files": {
        "pdf": "https://archive.orkl.eu/9daa51425a363ee5d1e69d97e796fe88bbe8fd60.pdf",
        "text": "https://archive.orkl.eu/9daa51425a363ee5d1e69d97e796fe88bbe8fd60.txt",
        "img": "https://archive.orkl.eu/9daa51425a363ee5d1e69d97e796fe88bbe8fd60.jpg"
    }
}