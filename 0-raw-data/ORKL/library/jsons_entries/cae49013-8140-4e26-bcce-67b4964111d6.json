{
    "id": "cae49013-8140-4e26-bcce-67b4964111d6",
    "created_at": "2023-01-12T15:03:02.346118Z",
    "updated_at": "2025-03-27T02:13:57.154223Z",
    "deleted_at": null,
    "sha1_hash": "e16da4f3bb54407aeee8c950c2331001cbb6ed77",
    "title": "2022-02-21 - A flaw in the encryption algorithm of Hive Ransomware allows retrieving encrypted files",
    "authors": "",
    "file_creation_date": "2022-05-28T17:11:56Z",
    "file_modification_date": "2022-05-28T17:11:56Z",
    "file_size": 208231,
    "plain_text": "# A flaw in the encryption algorithm of Hive Ransomware allows retrieving encrypted files\n\n**[securityaffairs.co/wordpress/128232/security/recover-files-hive-ransomware.html](https://securityaffairs.co/wordpress/128232/security/recover-files-hive-ransomware.html)**\n\nFebruary 21, 2022\n\nFebruary 21, 2022 By [Pierluigi Paganini](https://securityaffairs.co/wordpress/author/paganinip)\n\n## Researchers discovered a flaw in the encryption algorithm used by Hive ransomware that allowed them to decrypt data.\n\n[Researchers discovered a flaw in the encryption algorithm used by Hive ransomware that](https://securityaffairs.co/wordpress/125099/cyber-crime/supernus-pharmaceuticals-hive-ransomware.html)\nallowed them to decrypt data without knowing the private key used by the gang to encrypt\nfiles.\n\nThe Hive ransomware operation has been active since June 2021, it provides Ransomwareas-a-Service Hive and adopts a double-extortion model threatening to publish data stolen\nfrom the victims on their leak site (HiveLeaks). In April 2021, the Federal Bureau of\n[Investigation (FBI) has released a flash alert on the](https://securityaffairs.co/wordpress/121518/malware/fbi-alert-hive-ransomware.html) [Hive ransomware attacks that includes](https://securityaffairs.co/wordpress/119418/cyber-crime/new-ransomware-group-hive-leaks-altus-group-sample-files.html)\ntechnical details and indicators of compromise associated with the operations of the gang.\nAccording to a [report published by blockchain analytics company Chainalysis, the Hive](https://securityaffairs.co/wordpress/127974/cyber-crime/ransomware-payments-600m-2021.html)\nransomware is one of the top 10 ransomware strains by revenue in 2021. The group used a\nvariety of attack methods, including malspam campaigns, vulnerable RDP servers, and\ncompromised VPN credentials.\n\n_“Hive ransomware uses a hybrid encryption scheme, but uses its own symmetric cipher to_\n_encrypt files. We were able to recover the master key for generating the file encryption key_\n_without the attacker’s private key, by using a cryptographic vulnerability identified through_\n_analysis. As a result of our experiments, encrypted files were successfully decrypted using_\n_[the recovered master key based on our mechanism.” reads the paper published by](https://arxiv.org/abs/2202.08477)_\n_researchers from Kookmin University (South Korea). “To the best of our knowledge, this is_\n_the first successful attempt at decrypting the Hive ransomware. We experimentally_\n_demonstrated that more than 95% of the keys used for encryption could be recovered using_\n_the method we suggested.”_\n\nThe technique devised by the team of academics was able to recover more than 95% of the\nkeys used\n\nfor the encryption process that is represented in the following image:\n\n\n-----\n\nThe experts detailed the process used by Hive ransomware to generate and store master\nkey for victim files. The ransomware generates 10MiB of random data, and uses it as a\nmaster key. The malware extracted from a specific offset of the master key 1MiB and 1KiB of\ndata for each file to be encrypted and uses as a keystream. The offset is stored in the\nencrypted file name of each file. This means that experts were able to determine the offset of\nthe keystream stored in the filename and decrypt the file.\n\n_“Hive ransomware encrypts files by XORing the data with a random keystream that is_\n_different for each file. We found that this random keystream was sufficiently guessable.”_\n_continues the paper. “Hive ransomware generates a data encryption keystream (EKS) that_\n_appears random for each file, and encrypts the file by XORing EKS with the file. However,_\n_EKS is created using two keystreams extracted from the previously created master key_\n_During the encryption process, only the part of the file, not the entire area, is encrypted.”_\n\nThe results of the tests demonstrated the efficiency of the method, the master key recovered\n92% succeeded in decrypting approximately 72% of the files, while the master key restored\n96% succeeded in decrypting approximately 82% of the files, and the master key restored\n98% succeeded in decrypting approximately 98% of the files.\n\n**[Pierluigi Paganini](http://www.linkedin.com/pub/pierluigi-paganini/b/742/559)**\n\n**[(SecurityAffairs –](http://securityaffairs.co/wordpress/)** **hacking, ransomware)**\n\nYou might also like\n\n\n-----\n\n**[Experts believe that Russian Gamaredon APT could fuel a new round of DDoS attacks](https://securityaffairs.co/wordpress/131762/apt/gamaredon-apt-ddos-attacks.html)**\n\nMay 28, 2022 By [Pierluigi Paganini](https://securityaffairs.co/wordpress/author/paganinip)\n\n**[The strange link between Industrial Spy and the Cuba ransomware operation](https://securityaffairs.co/wordpress/131754/cyber-crime/industrial-spy-cuba-ransomware.html)**\n\nMay 28, 2022 By [Pierluigi Paganini](https://securityaffairs.co/wordpress/author/paganinip)\n\nCopyright 2021 Security Affairs by Pierluigi Paganini All Right Reserved.\nBack to top\n\n[Home](http://securityaffairs.co/wordpress/)\n[Cyber Crime](https://securityaffairs.co/wordpress/category/cyber-crime)\n[Cyber warfare](https://securityaffairs.co/wordpress/category/cyber-warfare-2)\n[APT](https://securityaffairs.co/wordpress/category/apt)\n\n\n-----\n\n[Data Breach](https://securityaffairs.co/wordpress/category/data-breach)\n[Deep Web](https://securityaffairs.co/wordpress/category/deep-web)\n[Digital ID](https://securityaffairs.co/wordpress/category/digital-id)\n[Hacking](https://securityaffairs.co/wordpress/category/hacking)\n[Hacktivism](https://securityaffairs.co/wordpress/category/hacktivism)\n[Intelligence](https://securityaffairs.co/wordpress/category/intelligence)\n[Internet of Things](https://securityaffairs.co/wordpress/category/iot)\n[Laws and regulations](https://securityaffairs.co/wordpress/category/laws-and-regulations)\n[Malware](https://securityaffairs.co/wordpress/category/malware)\n[Mobile](https://securityaffairs.co/wordpress/category/mobile-2)\n[Reports](https://securityaffairs.co/wordpress/category/reports)\n[Security](https://securityaffairs.co/wordpress/category/security)\n[Social Networks](https://securityaffairs.co/wordpress/category/social-networks)\n[Terrorism](https://securityaffairs.co/wordpress/category/terrorism)\n[ICS-SCADA](https://securityaffairs.co/wordpress/category/ics-scada)\n[EXTENDED COOKIE POLICY](https://securityaffairs.co/wordpress/extended-cookie-policy)\n[Contact me](https://securityaffairs.co/wordpress/contact)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-02-21 - A flaw in the encryption algorithm of Hive Ransomware allows retrieving encrypted files.pdf"
    ],
    "report_names": [
        "2022-02-21 - A flaw in the encryption algorithm of Hive Ransomware allows retrieving encrypted files.pdf"
    ],
    "threat_actors": [
        {
            "id": "236a8303-bf12-4787-b6d0-549b44271a19",
            "created_at": "2024-06-04T02:03:07.966137Z",
            "updated_at": "2025-03-27T02:05:17.410356Z",
            "deleted_at": null,
            "main_name": "IRON TILDEN",
            "aliases": [
                "Aqua Blizzard ",
                "Armageddon",
                "Blue Otso ",
                "BlueAlpha ",
                "Dancing Salome ",
                "Gamaredon",
                "Gamaredon Group",
                "Hive0051 ",
                "Primitive Bear ",
                "Shuckworm ",
                "Trident Ursa ",
                "UAC-0010 ",
                "UNC530 ",
                "WinterFlounder ",
                "ACTINIUM "
            ],
            "source_name": "Secureworks:IRON TILDEN",
            "tools": [
                "Pterodo"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "06f622cb-3a78-49cf-9a4c-a6007a69325f",
            "created_at": "2022-10-25T16:07:23.315239Z",
            "updated_at": "2025-03-27T02:02:09.733197Z",
            "deleted_at": null,
            "main_name": "APT 3",
            "aliases": [
                "APT 3",
                "Bronze Mayfair",
                "Buckeye",
                "Gothic Panda",
                "Group 6",
                "Operation Clandestine Fox",
                "Operation Clandestine Fox, Part Deux",
                "Operation Clandestine Wolf",
                "Operation Double Tap",
                "Red Sylvan",
                "TG-0110",
                "UPS Team"
            ],
            "source_name": "ETDA:APT 3",
            "tools": [
                "APT3 Keylogger",
                "Agent.dhwf",
                "BKDR_HUPIGON",
                "Backdoor.APT.CookieCutter",
                "Badey",
                "Bemstour",
                "CookieCutter",
                "Destroy RAT",
                "DestroyRAT",
                "DoublePulsar",
                "EXL",
                "EternalBlue",
                "HTran",
                "HUC Packet Transmit Tool",
                "Hupigon",
                "Hupigon RAT",
                "Kaba",
                "Korplug",
                "LaZagne",
                "MFC Huner",
                "OSInfo",
                "Pirpi",
                "PlugX",
                "RedDelta",
                "RemoteCMD",
                "SHOTPUT",
                "Sogu",
                "TIGERPLUG",
                "TTCalc",
                "TVT",
                "Thoper",
                "Xamtrav",
                "remotecmd",
                "shareip",
                "w32times"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535782,
    "ts_updated_at": 1743041637,
    "ts_creation_date": 1653757916,
    "ts_modification_date": 1653757916,
    "files": {
        "pdf": "https://archive.orkl.eu/e16da4f3bb54407aeee8c950c2331001cbb6ed77.pdf",
        "text": "https://archive.orkl.eu/e16da4f3bb54407aeee8c950c2331001cbb6ed77.txt",
        "img": "https://archive.orkl.eu/e16da4f3bb54407aeee8c950c2331001cbb6ed77.jpg"
    }
}