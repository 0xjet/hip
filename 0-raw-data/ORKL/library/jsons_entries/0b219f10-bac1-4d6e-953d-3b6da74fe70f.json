{
    "id": "0b219f10-bac1-4d6e-953d-3b6da74fe70f",
    "created_at": "2023-01-12T15:07:27.247824Z",
    "updated_at": "2025-03-27T02:16:08.448805Z",
    "deleted_at": null,
    "sha1_hash": "2bf173870c5da51ba407275d1b1da19266982dc2",
    "title": "2018-08-30 - Double the Infection, Double the Fun",
    "authors": "",
    "file_creation_date": "2022-05-28T21:57:27Z",
    "file_modification_date": "2022-05-28T21:57:27Z",
    "file_size": 152946,
    "plain_text": "# Double the Infection, Double the Fun\n\n**asert.arbornetworks.com/double-the-infection-double-the-fun/**\n\n\nCobalt Phish Connection\n\n\nby [ASERT Team on August 30th, 2018](https://www.netscout.com/blog/asert/asert-team)\n\n## Executive Summary\n\nCobalt Group (aka TEMP.Metastrike), active since at least late 2016, have been suspected in attacks across dozens of countries. The group\nprimarily targets financial organizations, often with the use of ATM malware. Researchers also believe they are responsible for a series of\nattacks on the SWIFT banking system which costs millions in damages to the impacted entities. On August 13, ASERT observed the\nfinancially-motivated hacking group actively pushing a new campaign. We believe the targeted institutions for the ongoing campaign are\nlocated in eastern Europe and Russia. The active campaigns utilize spear phishing messages to gain entry. The emails appear to come from\na financial vendor or partner, increasing the likelihood of infection. The group uses tools that can bypass Window’s defenses.\n\n**_NOTE: Arbor APS enterprise security products detect and block all activity noted in this report._**\n\n## Key Findings\n\n\n-----\n\nRecent campaigns masquerade as other financial institutions or a financial supplier/partner domain to trick potential victims into trusting\nthe messages.\nTwo phishing targets found.\n\nNS Bank (Russia)\nBanca Comercială Carpatica / Patria Bank (Romania)\nOne phishing email contains two malicious URLs.\n\nThe first one is a weaponized Word document. The document contains obfuscated VBA scripts as opposed to known CVEs used\nin parallel to this campaign.\nThe second one is a binary with a jpg extension.\nThe binaries analyzed contained two unique C2 servers we believe are owned and operated by the Cobalt hacking Group.\n\n## Details\n\n Cobalt Group Connection\n\nASERT recently uncovered two different malware samples which we believe connect the active campaigns to Cobalt Group. The first sample,\na JavaScript backdoor, shares functionality with previous versions of a similar backdoor. The second binary, CobInt/COOLPANTS, is a\nreconnaissance backdoor as noted by security researchers.\n\n### JavaScript Backdoor\n\nThe JavaScript Backdoor is believed to be a stager for additional payloads. This stager, previously analyzed by security researchers from\nGroup-IB, and the JavaScript Backdoor ASERT analyzed exhibits similar functionality as noted below:\n\nRegistry key settings for persistence\nLaunched in an SCT (a scriptlet COM object) called via regsvr32.exe\n\nAn AppLocker by-pass technique (squiblydoo).\nUse of RC4 to encrypt traffic\nSame type of system information collected\nThe C2 command names show striking similarity\nThe C2 communication structure is also closely aligned between the two samples\n\n### CobInt/COOLPANTS\n\nThe second binary identified by security researchers, dubbed “Recon (CobInt) backdoor”, matched a new sample ASERT identified. A\nnumber of binaries came to light after the initial findings of the CobInt backdoor. The following are a few of these binaries, including the new\nsample identified by ASERT researchers (Figure 1):\n\nSample: 10d044bc5b8ae607501304e61b2efecb\n\nSecurity Researchers identify a “patient zero” binary and called it CobInt.\n\nListed in a recent report as a tool used by Cobalt Group\n\nSample: d017bf9f6039445bfefd95a853b2e4c4\n\nAn found a sample on July 9, 2018 and called it COOLPANTS.\nAppears to be an evolution of CobInt due to similarities in the binary when cross-referenced\n\n28 of the 57 functions matched using Diaphora, a tool that compares binary functions\n[C2 tied to Cobalt Group reporting: hxxps://apstore[.]info](https://www.proofpoint.com/us/daily-ruleset-update-summary-20180706)\n\nNew Sample: 616199072a11d95373b3c38626ad4c93\n\nFound by ASERT August 13 2018th\nVery similar to COOLPANTS when cross-referencing the binaries:\n\nAll 48 functions under “Best Match” tab in Diaphora\nSame compilation time as COOLPANTS: 2018-06-13 20:44:15\nC2: rietumu[.]me.\n\nThe sample evolution supports the theory that rietumu[.]me belongs to the Cobalt hacking group.\n\n\n-----\n\nCobInt/COOLPANTS\n\n\nFigure 1. CobInt/COOLPANTS\n\n## Phish & Infrastructure Analysis\n\nAfter inspecting the domain, rietumu[.]me, ASERT uncovered the email address solisariana[@]protonmail[.]com. Pivoting on the email leads\nto five additional domains each with a creation date of: 2018-08-01.\n\n1. compass[.]plus\n2. eucentalbank[.]com\n3. europecentalbank[.]com\n4. inter-kassa[.]com\n5. unibank[.]credit\n\nHunting for samples associated with inter-kassa[.]com leads to a phishing email uploaded to VirusTotal,\nd3ac921038773c9b59fa6b229baa6469 (Figure 2). At the time of analysis, VirusTotal scored the phishing email with a 0, indicating nothing\nmalicious was identified by the anti-virus engines.\n\n\n-----\n\nPhishing Email Header\n\n\nFigure 2. Phishing Email Header\n\nMost of the email content appears benign except for a link embedded in the message. The name “Interkassa” appears to be a payment\nprocessing system which makes it a prime masquerading target for attackers as noted in the tactics employed by the Cobalt Group for this\nongoing campaign. The links embedded in the phishing email are as follows:\n\n1. hxxps://download.outlook-368[.]com/Document00591674.doc\n\n1. Live on August 14, 2018\n2. hxxp://sepa-europa[.]eu/transactions/id02082018.jpg\n\n1. Not live at time of analysis but a sample matching the full URL was uploaded to VirusTotal.\n\n## Document Infection Chain\n\n### Payload Stager: Part One\n\nThe document from the embedded URL in the phishing email, Document00591674.doc (61e3207a3ea674c2ae012f44f2f5618b), renders a\nVBA infested word document which continues the infection cycle once macros are enabled. NOTE: The document requires user permission\nand/or a policy enabled that allows Macros to run for a successful launch. The VBA script pieces together a cmd.exe command that launches\ncmstp.exe with an INF file (figure 3) allowing to potentially by-pass AppLocker. The INF file then beacons to download.outlook-368[.]com to\ndownload a remote payload that cmstp.exe will execute.\n\n\n-----\n\nFigure 3. INF File\n\n\nFigure 3. INF File\n\n\n-----\n\nThe file, info.txt, downloaded from download.outlook 368[.]com is an XML file with an embedded scriptlet tag. The XML s content includes a\nregistration section allowing it to be used as a SCT/COM object (Figure 4). [caption id=\"attachment_9607\" align=\"aligncenter\" width=\"908\"]\n\n\nFigure 4. COM Object\n\n\nFigure 4. COM Object\n\n“cmstp.exe” executes the SCT file, which subsequently drops and launches the JavaScript backdoor dropper binary, 31385.txt\n(e368365bece9fb5b0bc8de1209bab694), disguised as a text file. For the dropped binary, Cobalt Group makes use of another system\nprovided binary to add a layer of stealth and bypass possible protections like AppLocker by launching it using regsvr32.exe (Figure 5).\n\n\n-----\n\nThis is consistent with TTPs for this actor.\n\n\nFigure 5. regsvr32 launching the 31385.txt\n\n\nFigure 5.regsvr32 launching the 31385.txt\n\nThe DLL file, 31385.txt, masquerading as a text file, is the last stage in the infection chain. The DLL drops the final obfuscated embedded file\nand launches it using regsvr32.exe before deleting itself (Figure 6).\n\n\n-----\n\nFigure 6. Final Obfuscated Script\n\n\nFigure 6. Final Obfuscated Script\n\nThe above script (Figure 6) is launched using regsvr32.exe:\n\nREgSvr32 /S /N /U /I:\"C:/Users/zgSpbU9Lu/AppData/Roaming/7F235861DB0B0024C3.txt\" sCRObJ\n\nThe script ensures persistence by modifying the registry key UserInitMprLoginScript with the following value:\n\nRegxvr32 /S /N /U /I:C:/Users/<redact>/AppData/Roaming/EE02EB37AA8.txt ScRObJ\n\nDe-obfuscating the final script renders the C2 along with the RC4 key. This is the JavaScript backdoor “more_eggs” which has been\nanalyzed by other researchers over the past few years (Figure 7).\n\n\n-----\n\nFigure 7. De Obfuscated JavaScript Backdoor\n\n\nFigure 7. De-Obfuscated JavaScript Backdoor - “More_eggs”\n\n**Backdoor “more_eggs” commands:**\n\n1. d&exec – Downloads and executes a PE file.\n2. more_eggs – Downloads an update for itself.\n3. gtfo – Delete itself and related registry entries.\n4. more_onion – Executes the “new” copy of itself.\n5. vai_x – Executes a command via cmd.\n\n\n-----\n\n**NOTE: Commands 1 4 match the commands described in other public reporting. Command 5 differs in name only; what it does remains**\nthe same. The public report shows “more_power” as the name of the fifth command.\n\n\nFigure 8: Execution Flow\n\n\nFigure 8: Execution Flow\n\n## JPEG Infection Chain\n\n### File Execution\n\nThe second URL identified in the phishing email, hxxp://sepa-europa[.]eu/transactions/id02082018.jpg, acts as a red-herring; id02082018.jpg,\n9a87da405a53eaf32f8a24d3abb085af - UPX unpacked, is an executable rather than an image file. The sample is littered with junk code that\nspends CPU cycles before proceeding to de-obfuscate itself. The unpacking routine involves overwriting itself in memory with another\nexecutable. This overwritten binary loads a resource and jumps to the executable code contained in it. The unpacked binary will fail when\n_LoadResource is called if it’s not running in the context of the original binary (Figure 9)._\n\n\n-----\n\nFigure 9: LoadResource()\n\n\nFigure 9: LoadResource()\n\n\n-----\n\nThe loaded shellcode first deobfuscates itself before beaconing to the C2 server for additional payloads or scripts.\n\n\nFigure 10: C2 Server\n\n\nFigure 10: C2 Server\n\nAt the time of analysis, the C2 server did not respond; however, there is another binary with the same C2 found in ASERT’s malware zoo\nwhich bears a striking resemblance to CobInt.\n\n### Full Circle\n\nThe binary, 452903fc857fb98f4339d7ce1884099, makes use of the C2 ibfseed[.]com. Comparing this binary to another CobInt\n(616199072a11d95373b3c38626ad4c93) sample using Diaphora, ASERT determined this to be another CobInt/COOLPANTS sample. We\nbelieve this binary is tied to Cobalt Group using the same methodology and binary comparisons as the previously discussed malware\nsamples.\n\n## Romanian Target Spotted\n\n Phish\n\n\n-----\n\nWorking closely with Intel471, one of our Threat Intelligence partners, we found an additional Cobalt Group phishing campaign targeting\ncarpatica[.]ro by masquerading as Single Euro Payments Area (SEPA). “carpatica[.]ro” belongs to Banca Comercială Carpatica, a bank in\nRomania that merged with Patria Bank in 2017.\n\n\nFigure 11: Romanian Bank Phish Header\n\n\nFigure 11: Romanian Bank Phish Header\n\n## Cobalt Group Connection\n\nThe phishing email uncovered by Intel471 downloads 9270ac1e013a3b33c44666a66795d0c0. The downloaded file shares the same PDB\nstring as 1999a718fb9bcf3c5b3e41bf88be9067. That sample connects to rietumu[.]me, which ASERT identified as belonging to Cobalt\nGroup (Figure 12).\n\n\n-----\n\nFigure 12: Cobalt Phish Connection\n\n\nFigure 12: Cobalt Phish Connection\n\n## Summary\n\nThis Cobalt Group actor(s) mimic financial entities or their vendors/partners in order to gain a foothold in the target’s network. Making use of\nseparate infection points in one email with two separate C2s makes this email peculiar. One could speculate that this would increase the\ninfection odds. The actor tries to hide the infection by using regsvr32.exe and cmstp.exe, which are both known for by-passing AppLocker\n(configuration dependent). ASERT believes Cobalt Group will continue targeting financial organizations in Eastern Europe and Russia based\non the observables in this campaign and their normal modus operandi. ASERT also recommends that employees are trained to spot\nphishing emails and, where possible, closely inspect emails for look-alike domains that might contain malicious attachments or links.\n\n## IOCs\n\n10D044BC5B8AE607501304E61B2EFECB - CobInt d017bf9f6039445bfefd95a853b2e4c4 - COOLPANTS\n616199072a11d95373b3c38626ad4c93 – Coblnt/COOLPANTS (ASERT Sample) d3ac921038773c9b59fa6b229baa6469 - Email\n61e3207a3ea674c2ae012f44f2f5618b - Document00591674.doc e368365bece9fb5b0bc8de1209bab694 – DLL File\n\n\n-----\n\n3452903fc857fb98f4339d7ce1884099 CobInt/COOLPANTS (ASERT Sample) 9a87da405a53eaf32f8a24d3abb085af id02082018.jpg\n(UPX Unpacked) f3bb3e2c03f3976c107de88b43a22655 – id02082018.jpg (UPX Packed) a3b705ce3d677361a7a9b2b0bdf04a04 – Email\n(carpatica) attachment eb93c912e4d3ecf52615b198c44771f4 – Email (carpatica) 9270ac1e013a3b33c44666a66795d0c0 - Email\n(carpatica)Downloaded 1999a718fb9bcf3c5b3e41bf88be9067  hxxps://help-desc-me[.]com hxxps://apstore[.]info hxxps://rietumu[.]me\nhxxps://ww3.cloudfront[.]org[.]kz hxxp://download.outlook-368[.]com hxxps://ibfseed[.]com  compass[.]plus eucentalbank[.]com\neuropecentalbank[.]com inter-kassa[.]com unibank[.]credit sepacloud[.]eu sepa-cloud[.]com\n\nPosted In\n\nUncategorized\n\n## Subscribe\n\n_Sign up now to receive the latest notifications and updates from NETSCOUT's ASERT._\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2018/2018-08-30 - Double the Infection, Double the Fun.pdf"
    ],
    "report_names": [
        "2018-08-30 - Double the Infection, Double the Fun.pdf"
    ],
    "threat_actors": [
        {
            "id": "610a7295-3139-4f34-8cec-b3da40add480",
            "created_at": "2023-01-06T13:46:38.608142Z",
            "updated_at": "2025-03-27T02:00:02.87217Z",
            "deleted_at": null,
            "main_name": "Cobalt",
            "aliases": [
                "Cobalt Gang",
                "GOLD KINGSWOOD",
                "COBALT SPIDER",
                "G0080",
                "Mule Libra",
                "Cobalt Group"
            ],
            "source_name": "MISPGALAXY:Cobalt",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "2dfaa730-7079-494c-b2f0-3ff8f3598a51",
            "created_at": "2022-10-25T16:07:23.474746Z",
            "updated_at": "2025-03-27T02:02:09.822683Z",
            "deleted_at": null,
            "main_name": "Cobalt Group",
            "aliases": [
                "ATK 67",
                "Cobalt Gang",
                "Cobalt Spider",
                "Gold Kingswood",
                "Mule Libra",
                "TAG-CR3"
            ],
            "source_name": "ETDA:Cobalt Group",
            "tools": [
                "ATMRipper",
                "ATMSpitter",
                "Agentemis",
                "AmmyyRAT",
                "AtNow",
                "COOLPANTS",
                "CobInt",
                "Cobalt Strike",
                "CobaltStrike",
                "Cyst Downloader",
                "Fareit",
                "FlawedAmmyy",
                "Formbook",
                "Little Pig",
                "Metasploit Stager",
                "Mimikatz",
                "More_eggs",
                "NSIS",
                "Nullsoft Scriptable Install System",
                "Pony Loader",
                "Ripper ATM",
                "SDelete",
                "Siplog",
                "SoftPerfect Network Scanner",
                "SpicyOmelette",
                "Taurus Builder",
                "Taurus Builder Kit",
                "Taurus Loader",
                "Terra Loader",
                "ThreatKit",
                "VenomKit",
                "cobeacon",
                "win.xloader"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "c11abba0-f5e8-4017-a4ee-acb1a7c8c242",
            "created_at": "2022-10-25T15:50:23.744036Z",
            "updated_at": "2025-03-27T02:00:55.537114Z",
            "deleted_at": null,
            "main_name": "Cobalt Group",
            "aliases": [
                "Cobalt Group",
                "GOLD KINGSWOOD",
                "Cobalt Gang",
                "Cobalt Spider"
            ],
            "source_name": "MITRE:Cobalt Group",
            "tools": [
                "Mimikatz",
                "More_eggs",
                "SpicyOmelette",
                "SDelete",
                "Cobalt Strike",
                "PsExec"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1673536047,
    "ts_updated_at": 1743041768,
    "ts_creation_date": 1653775047,
    "ts_modification_date": 1653775047,
    "files": {
        "pdf": "https://archive.orkl.eu/2bf173870c5da51ba407275d1b1da19266982dc2.pdf",
        "text": "https://archive.orkl.eu/2bf173870c5da51ba407275d1b1da19266982dc2.txt",
        "img": "https://archive.orkl.eu/2bf173870c5da51ba407275d1b1da19266982dc2.jpg"
    }
}