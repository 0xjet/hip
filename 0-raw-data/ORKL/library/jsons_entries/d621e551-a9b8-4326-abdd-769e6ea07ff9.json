{
    "id": "d621e551-a9b8-4326-abdd-769e6ea07ff9",
    "created_at": "2023-01-12T14:59:53.958156Z",
    "updated_at": "2025-03-27T02:16:39.958096Z",
    "deleted_at": null,
    "sha1_hash": "ae8ce57de772cc43e43440898ad11b47631fbdfa",
    "title": "2014-11-25 - Curious Korlia",
    "authors": "",
    "file_creation_date": "2022-10-02T12:10:56Z",
    "file_modification_date": "2022-10-02T12:10:56Z",
    "file_size": 356558,
    "plain_text": "# securitykitten.github.io/_posts/2014-11-25-curious-korlia.md\n\n**[github.com/malware-kitten/securitykitten.github.io/blob/master/_posts/2014-11-25-curious-korlia.md](https://github.com/malware-kitten/securitykitten.github.io/blob/master/_posts/2014-11-25-curious-korlia.md)**\n\nmalware-kitten\n\nCannot retrieve contributors at this time\n\n**layout** **title** **excerpt** **date**\n\n\ncategorypost\n\n## Introduction\n\n\nCurious\nKorlia\n\n\naka, the bisonal\nbackdoor\n\n\n2014-11-25 18:43:44\n-0500\n\n\nReverse engineers organize discrete of pieces of malware into families. While\ndigging through my malware collection I stumbled across this hash\n(B8FDFEE08DEEE5CCC1794BAF9ED553CE).\n\nIt turns out that this is a sample of the backdoor family known as Korlia. After\ndoing some more digging, it turns out that Korlia doesn't seem to be that well\ndocumented or widely known. There is a little bit more written about it here.\n\nKorlia shares a lot of features with common remote access tools. Such as:\n\nDownloading and executing files\n\n\n-----\n\nListing and controlling processes\nCreating and deleting files\nCreating a remote shell\n\nGiven the little amount of public information on Korlia, this made it a good\ncandidate for further research.\nThere isn't an obvious C2 address called out in\nstrings, although there are some bizarre strings. Depending on luck, those might\nbe actual strings, or code that is being misinterpreted as a string.\n\nDiving in deeper on our first string:\n\nThere exists a cross reference to an address. For this case, that is a great sign!\nThis particular piece of data is being referenced somewhere in the code. Let's\nfollow.\nIn this case we can see that the data is being referenced as global data, and it's\nmov'd into an EDI. Shortly after, the value 0x1f is loaded into BL. As a general\nside note, when you see static values being pushed into the lower bytes of a\ngeneral purpose register this usually means that some loop is going to follow and\nbyte by byte modify a string or array.\n\nThis can be roughly written in Ruby with the following code.\n\n{% highlight ruby %}\n{% raw %}\n\"{ql{ql.1O~ll^l1jl\".each_byte {|x| print \"#\n{(x^0x1f).chr}\"}\n{% endraw %}\n{% endhighlight %}\n\n\n-----\n\nThis will return the following information:\n```\ndnsdns1.PassAs.us\n\n\n```\nAfter a little bit of hunting on VirusTotal, I was able to find the following samples.\nWhich also have the following configurations.\n\nMD5|Config Offset|C2|C2|URL\n--- | --- | --- | --- | --- | --172d68e10715b915ab3268db2174192b|11280|kfsinfo.ByInter.net|61.90.202.197|\n[http://fund.cmc.or.kr/UploadFile/fame/x/mh/o.asp](http://fund.cmc.or.kr/UploadFile/fame/x/mh/o.asp)\n211c25cdf120f5da8a2258b5d65cc263|14364|0906.toh.info|wew.myMom.info|http\n://fund.cmc.or.kr/UploadFile/fame/x/o0.asp\n37513c17acfb0b122ffdc3e51501ecc3|11792|since.qpoe.com|69.197.149.98|http:\n//fund.cmc.or.kr/UploadFile/fame/x/o0.asp\n3f7b8f90acc4a01b3377942c409031dc|11808|mycount.MrsLove.com|mycount.MrsLove.com|\n[http://fund.cmc.or.kr/UploadFile/fame/x/o0.asp](http://fund.cmc.or.kr/UploadFile/fame/x/o0.asp)\n5217a2fc910479d36947d8fe6791d734|12816|mycount.MrsLove.com|mycount.MrsLove.com|\n[http://fund.cmc.or.kr/UploadFile/fame/x/o0.asp](http://fund.cmc.or.kr/UploadFile/fame/x/o0.asp)\n7807036a74b811c28f1fbb167ef545e3|15900|kazama.myfw.us||http://fund.cmc.or\n.kr/UploadFile/fame/x/o0.asp\n7865b3c7e7f40ead123e97aae5dc0a57|17948|shinkhek.myfw.us||http://61.90.20\n2.198/jp/log2.asp\n932875565fc6a1356800aa9d3af01670|11792|usababa.myfw.us|indbaba.myfw.us|\n[http://indbabababa.dns94.com/o.asp](http://indbabababa.dns94.com/o.asp)\nb57a30d94872e47186c7ef2e08e6e905|17440|mycount.MrsLove.com|mycount.MrsLove.com|\n[http://fund.cmc.or.kr/UploadFile/fame/x/o0.asp](http://fund.cmc.or.kr/UploadFile/fame/x/o0.asp)\nb7981c7d028cbfd2f0fe2089de02b391|11792|jennifer998.lookin.at|196.44.49.154|\n[http://fund.cmc.or.kr/UploadFile/fame/x/o0.asp](http://fund.cmc.or.kr/UploadFile/fame/x/o0.asp)\nb8fdfee08deee5ccc1794baf9ed553ce|11280|dnsdns1.PassAs.us|dnsdns1.PassAs.us|\n[http://fund.cmc.or.kr/UploadFile/fame/x/o0.asp](http://fund.cmc.or.kr/UploadFile/fame/x/o0.asp)\nc96a92565553c7dc67267c78bc2809bb|14352|since.qpoe.com|applejp.myfw.us|\n[http://fund.cmc.or.kr/UploadFile/fame/x/o0.asp](http://fund.cmc.or.kr/UploadFile/fame/x/o0.asp)\ncb0e358b534bdce8e2587ef3745b1723|11808|v3net.rr.nu|faceto.UglyAs.com|http\n://fund.cmc.or.kr/UploadFile/fame/x/mh/o.asp\ne47f4ca37db57a9f22d85e021dc891a6|12816|mycount.MrsLove.com|mycount.MrsLove.com|\n[http://fund.cmc.or.kr/UploadFile/fame/x/o0.asp](http://fund.cmc.or.kr/UploadFile/fame/x/o0.asp)\nefe7598c675c1c71f0ad44cc686de587|17948|61.90.202.198|10.0.0.102|http://61.\n90.202.198/jp/log.asp\n\nThe next step in this process is to write a Yara rule looking for this sort of\nbehavior. Writing Yara rules based on strings alone is often problematic as\nstrings are very easy to change and modify. In this case, since we understand\nhow the decoder works, writing a Yara rule for the loop is probably a better bet.\nWhile hunting I did find slight variations of the loop (highlighted in the Yara rule\nbelow). Those are accounted for in the final rule.\nThe following rules will catch\nseveral variants of Korlia.\n\n\n-----\n\n```\nrule korlia\n\n{\nmeta:\n\nauthor = \"Nick Hoffman \"\n\ncompany = \"CBTS - ACS\"\n\ninformation = \"korlia malware found in apt dump\"\n\n//case a\n\n//b2 1f mov dl, 0x1f ; mov key (wildcard)\n\n// ----------------\n//8A 86 98 40 00 71 mov al, byte ptr url[esi]\n\n//BF 98 40 00 71 mov edi, offset url\n\n//32 C2 xor al, dl\n\n//83 C9 FF or ecx, 0FFFFFFFFh\n\n//88 86 98 40 00 71 mov byte ptr url[esi], al\n\n//33 C0 xor eax, eax\n\n//46 inc esi\n\n//F2 AE repne scasb\n\n//F7 D1 not ecx\n\n//49 dec ecx\n\n//3B F1 cmp esi, ecx\n\n//72 DE jb short loc_71001DE0\n\n//case b (variant of loop a)\n\n//8A 8A 28 50 40 00 mov cl, byte_405028[edx]\n\n//BF 28 50 40 00 mov edi, offset byte_405028\n\n//32 CB xor cl, bl\n\n//33 C0 xor eax, eax\n\n//88 8A 28 50 40 00 mov byte_405028[edx], cl\n\n//83 C9 FF or ecx, 0FFFFFFFFh\n\n//42 inc edx\n\n//F2 AE repne scasb\n\n//F7 D1 not ecx\n\n//49 dec ecx\n\n//3B D1 cmp edx, ecx\n\n//72 DE jb short loc_4047F2\n\n//case c (not a variant of the above loop)\n\n//8A 0C 28 mov cl, [eax+ebp]\n\n//80 F1 28 xor cl, 28h\n\n//88 0C 28 mov [eax+ebp], cl\n\n//8B 4C 24 14 mov ecx, [esp+0D78h+var_D64]\n\n//40 inc eax\n\n//3B C1 cmp eax, ecx\n\n//7C EE jl short loc_404F1C\n\nstrings:\n\n$a = {b2 ?? 8A 86 98 40 00 71 BF 98 40 00 71 32 c2 83 C9 FF 88 86 98 40 00\n71 33 C0 46 F2 AE F7 D1 49 3B F1}\n\n$b = {B3 ?? ?? ?? 8A 8A 28 50 40 00 BF 28 50 40 00 32 CB 33 C0 88 8A 28 50\n40 00 83 C9 FF 42 F2 AE F7 D1 49 3B D1}\n\n$c = {8A 0C 28 80 F1 ?? 88 0C 28 8B 4C 24 14 40 3B C1}\n\n$d = {00 62 69 73 6F 6E 61 6C 00} //config marker \"\\x00bisonal\\x00\"\n\ncondition:\n\nany of them\n\n}\n\n```\n\n-----\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2014/2014-11-25 - Curious Korlia.pdf"
    ],
    "report_names": [
        "2014-11-25 - Curious Korlia.pdf"
    ],
    "threat_actors": [
        {
            "id": "2864e40a-f233-4618-ac61-b03760a41cbb",
            "created_at": "2023-12-01T02:02:34.272108Z",
            "updated_at": "2025-03-27T02:02:10.209072Z",
            "deleted_at": null,
            "main_name": "WildCard",
            "aliases": [],
            "source_name": "ETDA:WildCard",
            "tools": [
                "RustDown",
                "SysJoker"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "a97cf06d-c2e2-4771-99a2-c9dee0d6a0ac",
            "created_at": "2022-10-25T16:07:24.349252Z",
            "updated_at": "2025-03-27T02:02:10.184406Z",
            "deleted_at": null,
            "main_name": "Turla",
            "aliases": [
                "ATK 13",
                "Belugasturgeon",
                "Blue Python",
                "CTG-8875",
                "Group 88",
                "ITG12",
                "Iron Hunter",
                "Krypton",
                "Makersmark",
                "Operation Epic Turla",
                "Operation Moonlight Maze",
                "Operation Penguin Turla",
                "Operation Satellite Turla",
                "Operation Skipper Turla",
                "Operation Turla Mosquito",
                "Operation WITCHCOVEN",
                "Pacifier APT",
                "Pensive Ursa",
                "Popeye",
                "SIG15",
                "SIG2",
                "SIG23",
                "Secret Blizzard",
                "TAG-0530",
                "Turla",
                "UNC4210",
                "Venomous Bear",
                "Waterbug"
            ],
            "source_name": "ETDA:Turla",
            "tools": [
                "ASPXSpy",
                "ASPXTool",
                "ATI-Agent",
                "AdobeARM",
                "Agent.BTZ",
                "Agent.DNE",
                "BigBoss",
                "COMpfun",
                "Chinch",
                "Cloud Duke",
                "CloudDuke",
                "CloudLook",
                "Cobra Carbon System",
                "ComRAT",
                "DoublePulsar",
                "EmPyre",
                "EmpireProject",
                "Epic Turla",
                "EternalBlue",
                "EternalRomance",
                "GoldenSky",
                "Group Policy Results Tool",
                "HTML5 Encoding",
                "HyperStack",
                "IcedCoffee",
                "IronNetInjector",
                "KSL0T",
                "Kapushka",
                "Kazuar",
                "KopiLuwak",
                "Kotel",
                "LOLBAS",
                "LOLBins",
                "LightNeuron",
                "Living off the Land",
                "Maintools.js",
                "Metasploit",
                "Meterpreter",
                "MiamiBeach",
                "Mimikatz",
                "MiniDionis",
                "Minit",
                "NBTscan",
                "NETTRANS",
                "NETVulture",
                "Neptun",
                "NetFlash",
                "NewPass",
                "Outlook Backdoor",
                "Penquin Turla",
                "Pfinet",
                "PowerShell Empire",
                "PowerShellRunner",
                "PowerShellRunner-based RPC backdoor",
                "PowerStallion",
                "PsExec",
                "PyFlash",
                "QUIETCANARY",
                "Reductor RAT",
                "RocketMan",
                "SMBTouch",
                "SScan",
                "Satellite Turla",
                "SilentMoon",
                "Sun rootkit",
                "TTNG",
                "TadjMakhal",
                "Tavdig",
                "TinyTurla",
                "TinyTurla Next Generation",
                "TinyTurla-NG",
                "Topinambour",
                "Tunnus",
                "Turla",
                "Turla SilentMoon",
                "TurlaChopper",
                "Uroburos",
                "Urouros",
                "WCE",
                "WITCHCOVEN",
                "WhiteAtlas",
                "WhiteBear",
                "Windows Credential Editor",
                "Windows Credentials Editor",
                "Wipbot",
                "WorldCupSec",
                "XTRANS",
                "certutil",
                "certutil.exe",
                "gpresult",
                "nbtscan",
                "nbtstat",
                "pwdump"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "a97fee0d-af4b-4661-ae17-858925438fc4",
            "created_at": "2023-01-06T13:46:38.396415Z",
            "updated_at": "2025-03-27T02:00:02.823045Z",
            "deleted_at": null,
            "main_name": "Turla",
            "aliases": [
                "Uroburos",
                "Hippo Team",
                "Pacifier APT",
                "MAKERSMARK",
                "ATK13",
                "UAC-0003",
                "IRON HUNTER",
                "Waterbug",
                "TAG_0530",
                "KRYPTON",
                "Popeye",
                "SIG23",
                "UAC-0144",
                "G0010",
                "Blue Python",
                "VENOMOUS Bear",
                "Group 88",
                "Pfinet",
                "ITG12",
                "UNC4210",
                "Secret Blizzard",
                "UAC-0024"
            ],
            "source_name": "MISPGALAXY:Turla",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "d11c89bb-1640-45fa-8322-6f4e4053d7f3",
            "created_at": "2022-10-25T15:50:23.509601Z",
            "updated_at": "2025-03-27T02:00:55.487991Z",
            "deleted_at": null,
            "main_name": "Turla",
            "aliases": [
                "Turla",
                "IRON HUNTER",
                "Group 88",
                "Waterbug",
                "WhiteBear",
                "Krypton",
                "Venomous Bear",
                "Secret Blizzard",
                "BELUGASTURGEON"
            ],
            "source_name": "MITRE:Turla",
            "tools": [
                "PsExec",
                "nbtstat",
                "ComRAT",
                "netstat",
                "certutil",
                "KOPILUWAK",
                "IronNetInjector",
                "LunarWeb",
                "Arp",
                "Uroburos",
                "PowerStallion",
                "Kazuar",
                "Systeminfo",
                "LightNeuron",
                "Mimikatz",
                "Tasklist",
                "LunarMail",
                "HyperStack",
                "NBTscan",
                "TinyTurla",
                "Penquin",
                "LunarLoader"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "256a6a2d-e8a2-4497-b399-628a7fad4b3e",
            "created_at": "2023-11-30T02:00:07.299845Z",
            "updated_at": "2025-03-27T02:00:03.257794Z",
            "deleted_at": null,
            "main_name": "WildCard",
            "aliases": [],
            "source_name": "MISPGALAXY:WildCard",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673535593,
    "ts_updated_at": 1743041799,
    "ts_creation_date": 1664712656,
    "ts_modification_date": 1664712656,
    "files": {
        "pdf": "https://archive.orkl.eu/ae8ce57de772cc43e43440898ad11b47631fbdfa.pdf",
        "text": "https://archive.orkl.eu/ae8ce57de772cc43e43440898ad11b47631fbdfa.txt",
        "img": "https://archive.orkl.eu/ae8ce57de772cc43e43440898ad11b47631fbdfa.jpg"
    }
}