{
    "id": "712b4da8-9e97-473b-9329-5ddb01155c13",
    "created_at": "2023-01-12T15:04:35.076003Z",
    "updated_at": "2025-03-27T02:15:37.900454Z",
    "deleted_at": null,
    "sha1_hash": "61c8d4c2635b6aef57e985f20079b63203fad0a6",
    "title": "2020-11-02 - TinyPOS and ProLocker- An Odd Relationship",
    "authors": "",
    "file_creation_date": "2022-05-28T17:33:52Z",
    "file_modification_date": "2022-05-28T17:33:52Z",
    "file_size": 193903,
    "plain_text": "# TinyPOS and ProLocker: An Odd Relationship\n\n**[norfolkinfosec.com/tinypos-and-prolocker-an-odd-relationship/](https://norfolkinfosec.com/tinypos-and-prolocker-an-odd-relationship/)**\n\nnorfolk November 2, 2020\n\nRecently, I came across a [VISA bulletin regarding point-of-sale malware being used against](https://usa.visa.com/dam/VCOM/global/support-legal/documents/new-pos-malware-samples.pdf)\nmerchant targets. In Incident #1 in this VISA report, VISA described a deployment technique\nfor TinyPOS that seemed oddly similar to the ProLocker ransomware installation workflow\n[described by Group-IB, although I initially dismissed this as a coincidence.](https://www.group-ib.com/blog/prolock)\n\nAfter spending time mapping out code-level relationships and VirusTotal submitter\nrelationships (initially with the intent of identifying an entry vector), there is evidence to\nsuggest that this is not pure chance. In short, one of the following is likely true:\n\n1. ProLocker and TinyPOS are written by the same author, who also provides a deployment\nmechanism; or,\n\n2. ProLocker and TinyPOS are written, deployed, and used by the same threat actor\n\n3. The ProLocker adversary obtained or modified the TinyPOS source code and also\noperates in the carding space\n\nOf these, the second seems the most likely. In addition to distinct code-level relationships\nshared across several tools from both threat actors (and no apparent other threat actors) and\nthe very similar delivery mechanisms, both ProLocker attacks and TinyPOS attacks appear to\nbe low-volume enough that it is plausible a single small to medium-sized group is operating\nthem, rather than two distinct entities. This would parallel assessments that other threat\ngroups who traditionally operated in the carding and banking spaces have also switched to\n[ransomware attacks, including FIN6 and](https://www.fireeye.com/blog/threat-research/2019/04/pick-six-intercepting-a-fin6-intrusion.html) [TA505.](https://www.hornetsecurity.com/en/security-information/clop-clop-ta505-html-malspam-analysis/)\n\nThis remainder of this post primarily walks through the analytic workflow that led to these\nassessments (as opposed to a traditional intelligence-style condensed publication of the key\nfacts) so that others may properly evaluate the methodology and findings.\n\n———————————————————————————–\n\n**I.Identifying More Files**\n\nTinyPOS Installation Workflow\n\nIncident #1 in the VISA report contains two sets of indicators of compromise (IOC) including\nfilenames and hashes, which describe the following installation workflow:\n\n1. A .bat file executes a PowerShell script\n\n2. This PowerShell script reads data “hidden” inside an image file\n\n3. This data is loaded and run in memory as shellcode\n\n\n-----\n\n4. The shellcode decodes itself into the TinyPOS malware\n\nThere are a few items worth noting here. First, VISA provided two examples of such image\nfiles from two observed installation workflows, one of which is located at “c:\\temp\\” and the\nother at the “c:\\journal\\” directory. The second item worth noting is that while the shellcode is\nsimply “appended” to the image file and not obscured through a more complex\nsteganography method. These characteristics will be important for the ProLocker\ncomparisons.\n\nThe files for the hashes provided are not on VirusTotal and VISA offers limited additional\ndetails regarding these files; however, a report from [Carbon Black describes the exact same](https://www.carbonblack.com/blog/tau-technical-report-new-attack-combines-tinypos-with-living-off-the-land-techniques-for-scraping-credit-card-data/)\nfiles and provides more information, including code snippets for a decoded version of the\nPowerShell loader and the shellcode.\n\nObtaining a Copy of The Shellcode\n\nAt this point, there is actually enough information to identify a copy of the shellcode on\nVirusTotal. Figure 4 in Carbon Black’s report highlights the start of the shellcode – by taking\nsome of these bytes and running a VirusTotal content search (e.g. content:”{48 31 Db 48 C7\nC0 A3 A1 A8}”), a single result for a file named “t.bin” appears:\n\nMD5: f1efe5959ac5f730e08fb629143a78f9\nSHA1: 6544e7506163782ccb2e06348d3c9467d0513be9\nSHA256: 0be35b73262e67569e02950f5de9b94b7e0915dcd8ef4d8de66a6db600e41a18\nDebugged, this file contains a decoding routine at the start that unpacks the rest of the\nshellcode, resulting in the TinyPOS sample identical to the one described by VISA and\nCarbon Black:\n\n\n-----\n\nDecoded/Unpacked shellcode matching Carbon Black report\n\nWith a confirmed copy of this shellcode in hand, there are two additional pivoting vectors.\nFirst, there is a pivoting opportunity using the decoded segments of TinyPOS. Taking a set of\nopcode, a content search (content:”{41 ff 57 38 48 83 C4 20 49 89 87 00 02}”) yielded two\nadditional hashes:\n\nMD5: a88107d4723ee6e6b33eca655c68a562 (sql.exe)\nMD5: 57acabff815119ac5c391adbf8133c4a (sqlsrv.exe)\n\nEach of these is an additional TinyPOS sample, but in executable form. Further pivoting from\none of these submitters led to a TinyLoader sample uploaded alongside the TinyPOS sample\ncommunicating with known infrastructure from this threat actor, but this became a dead end\nfor further meaningful research.\n\nOn the other hand, pivoting using a different part of the initial decoding function yielded far\nmore interesting results: 24 hashes, all of which (with the exception of a single unclassified\nfile) are ProLocker ransomware components or appear to be TinyPOS-related files.\n\n\n-----\n\nThe next section examines these files.\n\n**II.ProLocker and TinyPOS Relationship**\n\nThe following hashes were identified and classified by pivoting with a VirusTotal content\nsearch using opcode from the decoding algorithm:\n\n**Hash** **Filename** **Description**\n\nF1EFE5959AC5F730E08FB629143A78F9 t.bin TinyPOS\n(Previously\nidentified)\n\n5FC14B914B9A7DC2D546BC33E4B80584 ccv_server.txt TinyPOS\npayload\n\n417F35F30BCB474340CDB3F50491C1B0 readme_shellcode.exe TinyPOS\nbehavior\n\n74D5D09F513FD5EBEE1EFF50495AC2D8 SQLSRV.EXE TinyPOS\nbehavior\n\nE9C27A9F2A221527E03C36917DC36CB9 SQLSRV.EXE TinyPOS\nbehavior\n\n\n-----\n\n**Hash** **Filename** **Description**\n\n2A673709121D05BC57863002F8C62C51 PPD8535CAAEC677E9FAF.exe ProLocker\n\n16A29314E8563135B18668036A6F63C8 – ProLocker\n\nF3634A3B184B68A10C7A4849D378171A 7ZSfxMod ProLocker\n\n404EF54232F1817BA4258392815E1D22 NAS.exe ProLocker\n\nC182610DD437F90D0CC6CB0AC19CFDB7 loytrohens.exe ProLocker\n\nFE659D877AED2178EF084E3BF1E40254 MCC1D3C303AEA0018852.exe ProLocker\n\n02C01B59D0621815FC6A367FB1C7474E LOCK.exe ProLocker\n\nAE3AAB90F69A05B131BD76ABE8A5A988 MCC1D3C303AEA0018852.exe ProLocker\n\n3355ACE345E98406BDB331CCAD568386 NAS_0.exe ProLocker\n\n90CD7B4A952A6C929BD006F74125FB8C – ProLocker\n\nB0EEEC6DCA9F208C3E2B43EBF26D80BA lock.exe ProLocker\n\n7AD4AFD690A1C69356BB3D0C8AD0947B WRFF965C1.jpeg ProLocker\ncode\n\nC579341F86F7E962719C7113943BB6E4 Winmgr.bmp ProLocker\ncode\n\nB77EAE27DB59E660F972FAB37708807F ___8A67B05B.dib_ ProLocker\ncode\n\n\n34525178FB98B59E9BD98DF1ABE58C28 MCC1-D3C3-03AE-A0018852.db\n\n\nProLocker\ncode\n\n\nBC469BF7946B9153D6270551F554B839 2B9E5820.db ProLocker\ncode\n\n34F8DC1C8A0B49627B118C21E7C3B047 readme ProLocker\ncode\n\nEA6E664A4EADE0428E6CD10028C9F3A7 readme File\ncontaining\ncode with\nTinyPOS\nbehavior\n\nD28AD0CC48005A09A04BA1D95275EE9A – Unknown\n\n\n-----\n\nThese file paint an important picture: the only files on VirusTotal with these opcode patterns\nbelong to one of these two families. There are slight differences, including a different\ndecoding key across files and an added instruction, but the core decoding mechanism and\nthe “noop” buffer are identical.\n\nThese files also share another interesting property: when using a list to check processes,\nboth malware families use a list consisting of partial process names that are six characters\nlong. For example, the t.bin TinyPOS sample has a target list for “ccs.ex”, “ops.ex”, and\n[“zioskp”. The first two may be related to Oracle point-of-sale components, and the latter a](https://docs.oracle.com/cd/E94131_01/doc.57/e95002.pdf)\n[Ziosk product. ProLocker uses the exact same type of process list, albeit with a different](https://www.ziosk.com/)\npurpose (closing processes that might interfere with document and database information).\n\n\n-----\n\nWhile compelling, these characteristics alone would be insufficient information to strongly\nassess a common operator (rather than simply a common author). However, there are\nadditional factors to consider. The staging locations appear to be relatively consistent across\nthese files. The TinyPOS shellcode files appear to be staged in subdirectories of the C:\\ root\n[drive, such as “c:\\journal\\”, “c:\\temp\\”, and (per a reddit post) “c:\\Windows\\”. For the](https://www.reddit.com/r/sysadmin/comments/ftxe1v/malicious_scheduled_task/)\nProLocker files, the observed files were all in “c:\\ProgramData”.\n\nThe table above provides one small piece of additional evidence that the same operating\ngroup is responsible: the presence of files uploaded named “readme” each leading to a\ndifferent malware payload. This, along with the fact that these deployment techniques\nemerged in close temporal proximity, lends more evidence to the “common operator” theory,\nalthough there are still limitations regarding how far this assessment can go.\n\nThis blog also notes that not every TinyPOS sample is identical in code and configuration.\nSpecifically, the t.bin sample analyzed that matches the Carbon Black/VISA reports and the\nccv_server.txt file described in a [reddit post appear to target specific processes, with](https://www.reddit.com/r/sysadmin/comments/ftxe1v/malicious_scheduled_task/)\nevidence from the latter source suggesting these may be specific to the target environments.\nOther samples analyzed in the “pivoting” section tagged as “TinyPOS behavior” contain a\nprocess blacklist rather than a process target list. This is noted primarily for the sake of\ntechnical accuracy and completeness, although these characteristics may be explored in a\nfuture post.\n\n**III.Conclusion**\n\nBased on the observed commonalities surrounding these two malware families and how they\nare used, it seems likely that there is some relationship between them. Originally, this\nresearch began as an effort to identify threat actor C2 infrastructure related to the incidents\ndescribed by VISA’s report; unfortunately, that type of infrastructure is precisely what is still\nneeded to more definitively solve this puzzle.\n\nIf evidence emerged that a ProLocker attack and a TinyPOS attack each relied on the same\ninfrastructure, this would suggest a workflow in which a threat actor group gains access to a\nnetwork, triages it, and then chooses the type of attack it wishes to launch. This, in turn,\nwould be consistent with other threat actor groups that operate in this space.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2020/2020-11-02 - TinyPOS and ProLocker- An Odd Relationship.pdf"
    ],
    "report_names": [
        "2020-11-02 - TinyPOS and ProLocker- An Odd Relationship.pdf"
    ],
    "threat_actors": [
        {
            "id": "99cb4e5b-8071-4f9e-aa1d-45bfbb6197e3",
            "created_at": "2023-01-06T13:46:38.860754Z",
            "updated_at": "2025-03-27T02:00:02.937438Z",
            "deleted_at": null,
            "main_name": "TA505",
            "aliases": [
                "SectorJ04 Group",
                "Dudear",
                "G0092",
                "ATK103",
                "Hive0065",
                "Spandex Tempest",
                "GRACEFUL SPIDER",
                "GOLD TAHOE",
                "CHIMBORAZO",
                "SectorJ04"
            ],
            "source_name": "MISPGALAXY:TA505",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "ee3363a4-e807-4f95-97d8-b603c31b9de1",
            "created_at": "2023-01-06T13:46:38.485884Z",
            "updated_at": "2025-03-27T02:00:02.845851Z",
            "deleted_at": null,
            "main_name": "FIN6",
            "aliases": [
                "Camouflage Tempest",
                "MageCart Group 6",
                "G0037",
                "TA4557",
                "SKELETON SPIDER",
                "ITG08",
                "White Giant",
                "GOLD FRANKLIN",
                "ATK88"
            ],
            "source_name": "MISPGALAXY:FIN6",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "12517c87-040a-4627-a3df-86ca95e5c13f",
            "created_at": "2022-10-25T16:07:23.61665Z",
            "updated_at": "2025-03-27T02:02:09.889471Z",
            "deleted_at": null,
            "main_name": "FIN6",
            "aliases": [
                "ATK 88",
                "Camouflage Tempest",
                "FIN6",
                "Gold Franklin",
                "ITG08",
                "Skeleton Spider",
                "TAAL",
                "TAG-CR2",
                "White Giant"
            ],
            "source_name": "ETDA:FIN6",
            "tools": [
                "AbaddonPOS",
                "Agentemis",
                "AmmyyRAT",
                "Anchor_DNS",
                "BlackPOS",
                "CmdSQL",
                "Cobalt Strike",
                "CobaltStrike",
                "FlawedAmmyy",
                "FrameworkPOS",
                "Grateful POS",
                "JSPSPY",
                "Kaptoxa",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "LockerGoga",
                "MMon",
                "Magecart",
                "Meterpreter",
                "Mimikatz",
                "More_eggs",
                "NeverQuest",
                "POSWDS",
                "Reedum",
                "Ryuk",
                "SCRAPMINT",
                "SONE",
                "SpicyOmelette",
                "StealerOne",
                "Taurus Loader Stealer Module",
                "Terra Loader",
                "TerraStealer",
                "Vawtrak",
                "WCE",
                "Windows Credential Editor",
                "Windows Credentials Editor",
                "cobeacon",
                "grabnew"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "b3acfb48-b04d-4d3d-88a8-836d7376fa2e",
            "created_at": "2024-06-19T02:03:08.052814Z",
            "updated_at": "2025-03-27T02:05:17.368029Z",
            "deleted_at": null,
            "main_name": "GOLD FRANKLIN",
            "aliases": [
                "ITG08 ",
                "MageCart Group 6 ",
                "Skeleton Spider ",
                "White Giant ",
                "FIN6 "
            ],
            "source_name": "Secureworks:GOLD FRANKLIN",
            "tools": [
                " Metasploit",
                " Meterpreter",
                " Mimikatz",
                " PowerSploit",
                " PowerUpSQL",
                " RemCom",
                "FrameWorkPOS"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "5e6b31a6-80e3-4e7d-8b0a-d94897ce9b59",
            "created_at": "2024-06-19T02:03:08.128175Z",
            "updated_at": "2025-03-27T02:05:17.400394Z",
            "deleted_at": null,
            "main_name": "GOLD TAHOE",
            "aliases": [
                "SectorJ04 ",
                "Spandex Tempest ",
                "TA505 ",
                "FIN11 "
            ],
            "source_name": "Secureworks:GOLD TAHOE",
            "tools": [
                " Cobalt Strike",
                " FlawedAmmy",
                " Get2",
                " GraceWire",
                " Malichus",
                " SDBbot",
                " ServHelper",
                " TrueBot",
                "Clop"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "ea7bfe06-7c23-481d-b8ba-eafa6cda3bc9",
            "created_at": "2022-10-25T15:50:23.317961Z",
            "updated_at": "2025-03-27T02:00:55.440858Z",
            "deleted_at": null,
            "main_name": "FIN6",
            "aliases": [
                "FIN6",
                "Magecart Group 6",
                "ITG08",
                "Skeleton Spider",
                "TAAL",
                "Camouflage Tempest"
            ],
            "source_name": "MITRE:FIN6",
            "tools": [
                "FlawedAmmyy",
                "GrimAgent",
                "FrameworkPOS",
                "More_eggs",
                "Cobalt Strike",
                "Windows Credential Editor",
                "AdFind",
                "PsExec",
                "LockerGoga",
                "Ryuk",
                "Mimikatz"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "75d4d6a9-b5d1-4087-a7a0-e4a9587c45f4",
            "created_at": "2022-10-25T15:50:23.5188Z",
            "updated_at": "2025-03-27T02:00:55.489882Z",
            "deleted_at": null,
            "main_name": "TA505",
            "aliases": [
                "TA505",
                "Hive0065",
                "Spandex Tempest",
                "CHIMBORAZO"
            ],
            "source_name": "MITRE:TA505",
            "tools": [
                "AdFind",
                "Azorult",
                "FlawedAmmyy",
                "Mimikatz",
                "Dridex",
                "TrickBot",
                "Get2",
                "FlawedGrace",
                "Cobalt Strike",
                "ServHelper",
                "Amadey",
                "SDBbot",
                "PowerSploit"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "e447d393-c259-46e2-9932-19be2ba67149",
            "created_at": "2022-10-25T16:07:24.28282Z",
            "updated_at": "2025-03-27T02:02:10.159466Z",
            "deleted_at": null,
            "main_name": "TA505",
            "aliases": [
                "ATK 103",
                "Chimborazo",
                "Gold Evergreen",
                "Gold Tahoe",
                "Graceful Spider",
                "Hive0065",
                "Operation Tovar",
                "Operation Trident Breach",
                "SectorJ04",
                "Spandex Tempest",
                "TA505",
                "TEMP.Warlock"
            ],
            "source_name": "ETDA:TA505",
            "tools": [
                "Amadey",
                "AmmyyRAT",
                "AndroMut",
                "Azer",
                "Bart",
                "Bugat v5",
                "CryptFile2",
                "CryptoLocker",
                "CryptoMix",
                "CryptoShield",
                "Dridex",
                "Dudear",
                "EmailStealer",
                "FRIENDSPEAK",
                "Fake Globe",
                "Fareit",
                "FlawedAmmyy",
                "FlawedGrace",
                "FlowerPippi",
                "GOZ",
                "GameOver Zeus",
                "GazGolder",
                "Gelup",
                "Get2",
                "GetandGo",
                "GlobeImposter",
                "Gorhax",
                "GraceWire",
                "Gussdoor",
                "Jaff",
                "Kasidet",
                "Kegotip",
                "Kneber",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "Locky",
                "MINEBRIDGE",
                "MINEBRIDGE RAT",
                "MirrorBlast",
                "Neutrino Bot",
                "Neutrino Exploit Kit",
                "P2P Zeus",
                "Peer-to-Peer Zeus",
                "Philadelphia",
                "Philadephia Ransom",
                "Pony Loader",
                "Rakhni",
                "ReflectiveGnome",
                "Remote Manipulator System",
                "RockLoader",
                "RuRAT",
                "SDBbot",
                "ServHelper",
                "Shifu",
                "Siplog",
                "TeslaGun",
                "TiniMet",
                "TinyMet",
                "Trojan.Zbot",
                "Wsnpoem",
                "Zbot",
                "Zeta",
                "ZeuS",
                "Zeus"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535875,
    "ts_updated_at": 1743041737,
    "ts_creation_date": 1653759232,
    "ts_modification_date": 1653759232,
    "files": {
        "pdf": "https://archive.orkl.eu/61c8d4c2635b6aef57e985f20079b63203fad0a6.pdf",
        "text": "https://archive.orkl.eu/61c8d4c2635b6aef57e985f20079b63203fad0a6.txt",
        "img": "https://archive.orkl.eu/61c8d4c2635b6aef57e985f20079b63203fad0a6.jpg"
    }
}