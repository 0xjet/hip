{
    "id": "b84cb406-5abd-42cc-b360-c6c4ffde0527",
    "created_at": "2023-01-12T15:07:19.207019Z",
    "updated_at": "2025-03-27T02:08:40.29118Z",
    "deleted_at": null,
    "sha1_hash": "883a1dde60aa683ab20caf0556bb08047f78a2eb",
    "title": "2017-08-24 - Malicious Chrome Extensions Stealing Roblox In-Game Currency, Sending Cookies via Discord",
    "authors": "",
    "file_creation_date": "2022-05-28T02:38:07Z",
    "file_modification_date": "2022-05-28T02:38:07Z",
    "file_size": 83220,
    "plain_text": "# Chrome Extensions Steal Roblox Currency, Uses Discord\n\n**blog.trendmicro.com/trendlabs-security-intelligence/malicous-chrome-extensions-stealing-roblox-game-currency-**\nsending-cookies-via-discord/\n\nAugust 24, 2017\n\nCyber Threats\n\nWe discussed how threat actors use the voice/chat client Discord to steal cookies from the\nrunning Roblox process on a Windows PC. Since then, we've noticed another attack going\nafter the same information, only this time it is via Chrome extensions.\n\nBy: Stephen Hilt, Lord Alfred Remorin August 24, 2017 Read time: ( words)\n\n[We recently discussed how cyber criminals are using the popular voice/chat client Discord to](http://blog.trendmicro.com/en_us/research/17/h/chat-app-discord-abused-cybercriminals-attack-roblox-players.html)\nsteal cookies from the running Roblox process on a Windows PC. Since then, we’ve noticed\nanother attack going after the same information, only this time it is via Chrome extensions\n(CRX files).\n\nWhile it currently only targets Roblox users, the same technique can be used to steal cookies\nfrom any website. The stolen information is sent via Discord, but this could also be\nconfigured to use other chat platforms. We learned this particular Chrome extension was, in\nfact, for sale on the Dream Market underground marketplace for only 99 cents:\n\n_Figure 1. Roblox Trade Bot being sold on the \"Dream Market\" underground marketplace_\n_(Click to enlarge)_\n\nWe obtained samples of this bot using the following file names: ROBLOX\n_BOT.zip, Crm5extension.crx, Roblox Enhancer.crx, and DankTrades.zip. The first .ZIP file_\ncontains a file named bgWork.js.\n\n_Figure 2. ZIP file contents_\n\nSearching for the terms CRM5 or bgWork.js lead right back to the forum v3rmillion.net. This\nunderground marketplace forum is a hotspot for Roblox hacks, where users even trade\nROBUX (the in-game currency of Roblox) for other work or products.\n\n\n-----\n\nLooking into bgWork.js, there is a configured Discord webhook that sends out the stolen\nRoblox cookie via the Discord API when installed. In this case, the example shows that the\nextension is called a Trade Bot and claims to be a RAP (Recent Average Price) Value\nassistant that can help you trade your ROBUX for something else. This extension doesn’t do\nthat; it will only send a stolen cookie to a Discord channel, leaving the user with nothing in\nreturn.\n\n_Figure 3. Title and message of the malicious extension (Click to enlarge)_\n\n_bgWork.js will send the message via Discord using a predefined webhook, which could also_\nbe changed to use any of the other chat platforms discussed in our paper titled How New\n_Chat Platforms Can Be Abused by Cybercriminals._\n\n_Figure 4. Code sending stolen cookie via Discord (Click to enlarge)_\n\nThe extension also sets up an alarm that will trigger an event every 15 minutes. This event\nwill send the stolen cookie (again) through the Discord API. These alarms ensure that the\nupdated cookie is constantly uploaded to the attacker.\n\n_Figure 5. Alarm set for every 15 minutes_\n\nAt the beginning of the bgWork.js file (where the variables are configured), the attacker can\nchange their webhook URL, or the cookie they want to steal. This means that this could be\nused to steal any cookie that is in the web browser; this capability is new to this version.\n\n_Figure 6. Code for configuring cookie to steal and Discord API (Click to enlarge)_\n\nBecause CRX files are just ZIP files with a different extension, the malware can be easily\nreconfigured to steal the cookies from any website besides Roblox. Changing the\nextension’s manifest.json file will allow for its properties to be changed (such as its name and\ndescription), making it more likely for an unsuspecting user to fall victim to this attack.\n\n_Figure 7. manifest.json file of Chrome extension (Click to enlarge)_\n\nUnless a user looks into the extension’s code, it looks benign. It may run for a long period of\ntime, allowing an attacker to steal ROBUX repeatedly if the victim keeps purchasing or\nacquiring new ROBUX. All it takes is one time running the extension for the ROBUX cookie\nto be stolen and sent to the actor.\n\n\n-----\n\n_Figure 8. Roblox Trade Assist extension installed in Google Chrome (Click to enlarge)_\n\nThe extension sends the Roblox cookie to a Discord channel like the previous malware, as\nseen below. We modified the code to send it to a Discord channel of our choice:\n\n_Figure 9. Cookies sent to Discord (Click to enlarge)_\n\n[Unlike previous versions of Roblox cookie stealers like TSPY_RAPID.A and TSPY_RAPID.D](https://www.trendmicro.com/vinfo/tmr/?/us/threat-encyclopedia/malware/tspy_rapid.a)\nthat were compiled using C#, this particular malware will also work on Macintosh computers.\n\n_Figure 10. Roblox Trade Assist extension installed in Google Chrome on an OS X system_\n_(Click to enlarge)_\n\nThe version we found required the user to manually install the extension into his Chrome\nbrowser, which required Developer Mode to be turned on. We wondered if any of these trade\nbots made it into the official Chrome web store, and found that they did:\n\n_Figure 11. Roblox Trade Bot extensions in the Chrome web store (Click to enlarge)_\n\nChecking the reviews for these add-ons, we saw that some users complained that these\nwere stealing ROBUX. One reviewer even stated it steals the whole Roblox account.\n\n_Figure 12. Reviews of Roblox Trade Bot (Click to enlarge)_\n\nWe looked at all the Roblox trade bots that were listed in the web store, and found that all of\nthese were malicious; they would send your cookies to a remote Discord webhook. One of\nthem, once installed, even shares the same icon as the malicious extension that was\ndiscussed earlier.\n\n_Figure 13. Malicious Chrome extension with TRADE icon (Click to enlarge)_\n\nThis shows that even extensions inside the Chrome web store can be malicious and steal\nROBUX from user accounts.\n\n_Figure 14. Contents of ROBLAX Trade/Snipe BOT extension's bgwork.js file (Click to_\n_enlarge)_\n\n\n-----\n\nThis is a good time to remember to always verify the permissions required before installing\nany Chrome extension. If you are unsure about these permissions, it’s better to not install the\nextension in the first place. This particular malicious extension requires the “Read and\nchange all your data on the websites you visit” permission, which should be a hint of its\nmalicious behavior.\n\n_Figure 15. ROBLOX Trade/Snipe BOT Permissions_\n\nAnyone who has downloaded one of these extensions should delete this extension from their\nbrowser. This can be done via the Extension Manager within Chrome; Google provides step[by-step directions on how to do so here.](https://support.google.com/chrome_webstore/answer/2664769?hl=en)\n\nTrend Micro detects these malicious extensions as BREX_CUKIEGRAB.SM. We have\nalready reported these extensions to Google; as of this time they have not yet removed\nthem.\n\nThe following SHA-256 hashes are associated with this threat:\n\n0061a5f52c5b577f679e81da3ab3ad3803c20e345c16ffc4dbc8b76386d42a00\n4c4af30a94cd25b23579e12b64191a056bda3c51b6e531a2202d3863b19432b3\nd9f21e401ef0197a2af66133e3f7fc3a4ea3efb4437884a4383076bad4060b02\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2017/2017-08-24 - Malicious Chrome Extensions Stealing Roblox In-Game Currency, Sending Cookies via Discord.pdf"
    ],
    "report_names": [
        "2017-08-24 - Malicious Chrome Extensions Stealing Roblox In-Game Currency, Sending Cookies via Discord.pdf"
    ],
    "threat_actors": [
        {
            "id": "d90307b6-14a9-4d0b-9156-89e453d6eb13",
            "created_at": "2022-10-25T16:07:23.773944Z",
            "updated_at": "2025-03-27T02:02:09.974695Z",
            "deleted_at": null,
            "main_name": "Lead",
            "aliases": [
                "Casper",
                "TG-3279"
            ],
            "source_name": "ETDA:Lead",
            "tools": [
                "Agentemis",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "RbDoor",
                "RibDoor",
                "Winnti",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673536039,
    "ts_updated_at": 1743041320,
    "ts_creation_date": 1653705487,
    "ts_modification_date": 1653705487,
    "files": {
        "pdf": "https://archive.orkl.eu/883a1dde60aa683ab20caf0556bb08047f78a2eb.pdf",
        "text": "https://archive.orkl.eu/883a1dde60aa683ab20caf0556bb08047f78a2eb.txt",
        "img": "https://archive.orkl.eu/883a1dde60aa683ab20caf0556bb08047f78a2eb.jpg"
    }
}