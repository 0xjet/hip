{
    "id": "2db97c1b-e998-403c-9bc2-d2babdbc0a19",
    "created_at": "2023-01-12T15:06:16.60127Z",
    "updated_at": "2025-03-27T02:15:39.232205Z",
    "deleted_at": null,
    "sha1_hash": "7f449d40e526905cd3281273be8dd31214f4d1ab",
    "title": "2019-03-27 - Forging the ShadowHammer",
    "authors": "",
    "file_creation_date": "2022-05-28T17:32:18Z",
    "file_modification_date": "2022-05-28T17:32:18Z",
    "file_size": 1187884,
    "plain_text": "# Forging the ShadowHammer\n\n**[blog.reversinglabs.com/blog/forging-the-shadowhammer](https://blog.reversinglabs.com/blog/forging-the-shadowhammer)**\n\n[Threat Research | March 27, 2019](https://blog.reversinglabs.com/blog/tag/threat-research)\n\nBlog Author\n[Tomislav Peričin, Chief Software Architect & Co-Founder at ReversingLabs. Read More...](https://blog.reversinglabs.com/blog/author/tomislav-peri%C4%8Din)\n\n\n-----\n\nOperation [ShadowHammer is a new and highly targeted supply chain attack discovered by](https://securelist.com/operation-shadowhammer/89992/)\n[Kaspersky Lab. The attack leveraged ASUS Live Update software to distribute malicious](https://www.asus.com/)\ncode. Live Update is a utility which commonly comes pre-installed on most ASUS computers\nand is used to update system drivers and BIOS/UEFI code.\n\nAs the details of this supply chain attack are still unfolding our ReversingLabs researchers\nlooked into what is currently publicly available. Using our Titanium Platform we’ve been able\nto make a few connections which lead us to, what we believe is, the first iteration of this\nmalware code.\n\nWe started from the infected installation package that was published by Kaspersky Lab. Its\ncontent is the main installation file called Setup.exe and two additional MSI installation\npackages that contain all the software components that get installed on the system.\n\n**Infected ASUS installation package - courtesy of Kaspersky Labs**\n\nThe main executable file, Setup.exe, carries the malicious payload. Because of this, we\ndecided to take a look at how we could pivot around Setup.exe and find additional samples\n\n\n-----\n\n[to analyze. Using our RHA1 functional similarity algorithm we ve been able to do just that](https://www.reversinglabs.com/technology/reversinglabs-hash-algorithm)\nand find 10 additional samples worth taking a closer look at.\n\n**Pivoting to find similar files via ReversingLabs RHA1 functional similarity algorithm**\n\n[From this point, the investigation is carried forward by TitaniumCore, our advanced file](https://www.reversinglabs.com/technology/malware-analysis-solution)\ndecomposition engine. TitaniumCore has been able to extract embedded resources from all\nof the RHA1 detected installation packages. The installation packages which have 58\nextracted files are particularly interesting as they contain one variant of the ShadowHammer\nattack.\n\n**Extracted resources via ReversingLabs TitaniumCore static unpacking engine**\n\nThis extracted executable is a Visual Studio C++ application that has been compiled with\ndebug symbol information enabled. These symbols unveil a bit more about the attacker and\nthe attack timeline.\n\n\n-----\n\n**PDB debugging information found within the extracted executable file**\n\nBased on the specifics of the file path, we were able to conclude that this is the original code\nthe adversaries developed specifically to carry out this attack. Since PDB paths are indexed\nby our advanced search capabilities, finding all the other samples that share this path,\nrequires only a simple one keyword search.\n\n**Pivoting to other versions of the same malware via ReversingLabs Advanced Search**\n\nWithin this batch of samples, we looked at the oldest one, which has the following debugging\ninformation.\n\n**PDB debugging information found within the extracted executable file**\n\nThe timestamp information within aligns perfectly with the attack timeline described by\nKaspersky Lab.\n\nThe details of the attack are still being investigated by our own team and the teams of\nsecurity researchers around the world. Our hope is that this short threat hunting blog will help\nthose looking for more details as they put the pieces of this puzzle back together.\n\n\n-----\n\n**IOCs:**\n1bb53937fa4cba70f61dc53f85e4e25551bc811bf9821fc47d25de1be9fd286a\n682fc8ccfc9316c54f02ae7865eee553ad0211031d4d80bb9c4365fbbc74049a\n9acd43af36f2d38077258cb2ace42d6737b43be499367e90037f4605318325f8\n6edc5578d824f42a6dd34664284179060f5595310fcb437a184f1ac0fc4fb1b4\ncfbec77180bd67cceb2e17e64f8a8beec5e8875f47c41936b67a60093e07fcfd\nc299b6dd210ab5779f3abd9d10544f9cae31cd5c6afc92c0fc16c8f43def7596\n\n## MORE BLOG ARTICLES\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2019/2019-03-27 - Forging the ShadowHammer.pdf"
    ],
    "report_names": [
        "2019-03-27 - Forging the ShadowHammer.pdf"
    ],
    "threat_actors": [
        {
            "id": "d90307b6-14a9-4d0b-9156-89e453d6eb13",
            "created_at": "2022-10-25T16:07:23.773944Z",
            "updated_at": "2025-03-27T02:02:09.974695Z",
            "deleted_at": null,
            "main_name": "Lead",
            "aliases": [
                "Casper",
                "TG-3279"
            ],
            "source_name": "ETDA:Lead",
            "tools": [
                "Agentemis",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "RbDoor",
                "RibDoor",
                "Winnti",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "1c97ccfd-1888-492c-b7b9-bb52c4c3809b",
            "created_at": "2023-01-06T13:46:38.940529Z",
            "updated_at": "2025-03-27T02:00:02.957652Z",
            "deleted_at": null,
            "main_name": "Operation ShadowHammer",
            "aliases": [],
            "source_name": "MISPGALAXY:Operation ShadowHammer",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "c7d9878a-e691-4c6f-81ae-84fb115a1345",
            "created_at": "2022-10-25T16:07:23.359506Z",
            "updated_at": "2025-03-27T02:02:09.752427Z",
            "deleted_at": null,
            "main_name": "APT 41",
            "aliases": [
                "BrazenBamboo",
                "Bronze Atlas",
                "Double Dragon",
                "Earth Baku",
                "Grayfly",
                "Operation ColunmTK",
                "Operation CuckooBees",
                "Operation ShadowHammer",
                "Red Kelpie",
                "SparklingGoblin",
                "TA415",
                "TG-2633"
            ],
            "source_name": "ETDA:APT 41",
            "tools": [
                "9002 RAT",
                "ADORE.XSEC",
                "ASPXSpy",
                "ASPXTool",
                "AceHash",
                "Agent.dhwf",
                "Agentemis",
                "AndroidControl",
                "AngryRebel",
                "AntSword",
                "BIOPASS",
                "BIOPASS RAT",
                "BLUEBEAM",
                "Barlaiy",
                "BlackCoffee",
                "Bladabindi",
                "BleDoor",
                "CCleaner Backdoor",
                "CHINACHOPPER",
                "COLDJAVA",
                "China Chopper",
                "ChyNode",
                "Cobalt Strike",
                "CobaltStrike",
                "Crackshot",
                "CrossWalk",
                "CurveLast",
                "CurveLoad",
                "DAYJOB",
                "DBoxAgent",
                "DEADEYE",
                "DEADEYE.APPEND",
                "DEADEYE.EMBED",
                "DEPLOYLOG",
                "DIRTCLEANER",
                "DUSTTRAP",
                "Derusbi",
                "Destroy RAT",
                "DestroyRAT",
                "DodgeBox",
                "DragonEgg",
                "ELFSHELF",
                "EasyNight",
                "Farfli",
                "FunnySwitch",
                "Gh0st RAT",
                "Ghost RAT",
                "HDD Rootkit",
                "HDRoot",
                "HKDOOR",
                "HOMEUNIX",
                "HUI Loader",
                "HidraQ",
                "HighNoon",
                "HighNote",
                "Homux",
                "Hydraq",
                "Jorik",
                "Jumpall",
                "KEYPLUG",
                "Kaba",
                "Korplug",
                "LATELUNCH",
                "LOLBAS",
                "LOLBins",
                "LightSpy",
                "Living off the Land",
                "Lowkey",
                "McRAT",
                "MdmBot",
                "MessageTap",
                "Meterpreter",
                "Mimikatz",
                "MoonBounce",
                "MoonWalk",
                "Motnug",
                "Moudour",
                "Mydoor",
                "NTDSDump",
                "PACMAN",
                "PCRat",
                "PINEGROVE",
                "PNGRAT",
                "POISONPLUG",
                "POISONPLUG.SHADOW",
                "POTROAST",
                "PRIVATELOG",
                "PipeMon",
                "PlugX",
                "PortReuse",
                "ProxIP",
                "ROCKBOOT",
                "RbDoor",
                "RedDelta",
                "RedXOR",
                "RibDoor",
                "Roarur",
                "RouterGod",
                "SAGEHIRE",
                "SPARKLOG",
                "SQLULDR2",
                "STASHLOG",
                "SWEETCANDLE",
                "ScrambleCross",
                "Sensocode",
                "SerialVlogger",
                "ShadowHammer",
                "ShadowPad Winnti",
                "SinoChopper",
                "Skip-2.0",
                "SneakCross",
                "Sogu",
                "Speculoos",
                "Spyder",
                "StealthReacher",
                "StealthVector",
                "TERA",
                "TIDYELF",
                "TIGERPLUG",
                "TOMMYGUN",
                "TVT",
                "Thoper",
                "Voldemort",
                "WIDETONE",
                "WINNKIT",
                "WINTERLOVE",
                "Winnti",
                "WyrmSpy",
                "X-Door",
                "XDOOR",
                "XMRig",
                "XShellGhost",
                "Xamtrav",
                "ZXShell",
                "ZoxPNG",
                "certutil",
                "certutil.exe",
                "cobeacon",
                "gresim",
                "njRAT",
                "pwdump",
                "xDll"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "a6c351ea-01f1-4c9b-af75-cfbb3b269ed3",
            "created_at": "2023-01-06T13:46:39.390649Z",
            "updated_at": "2025-03-27T02:00:03.072899Z",
            "deleted_at": null,
            "main_name": "Kinsing",
            "aliases": [
                "Money Libra"
            ],
            "source_name": "MISPGALAXY:Kinsing",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673535976,
    "ts_updated_at": 1743041739,
    "ts_creation_date": 1653759138,
    "ts_modification_date": 1653759138,
    "files": {
        "pdf": "https://archive.orkl.eu/7f449d40e526905cd3281273be8dd31214f4d1ab.pdf",
        "text": "https://archive.orkl.eu/7f449d40e526905cd3281273be8dd31214f4d1ab.txt",
        "img": "https://archive.orkl.eu/7f449d40e526905cd3281273be8dd31214f4d1ab.jpg"
    }
}