{
    "id": "c7ab80b4-293a-47ae-a472-da1ee3ef7851",
    "created_at": "2023-01-12T15:08:01.222075Z",
    "updated_at": "2025-03-27T02:16:57.995203Z",
    "deleted_at": null,
    "sha1_hash": "972b5646b64f08b58a794e17796900da4401e4b2",
    "title": "2016-05-17 - ATM infector",
    "authors": "",
    "file_creation_date": "2022-05-28T02:01:46Z",
    "file_modification_date": "2022-05-28T02:01:46Z",
    "file_size": 381737,
    "plain_text": "# ATM infector\n\n**securelist.com/atm-infector/74772/**\n\nAuthors\n\nGReAT\n\n[Olga Kochetova](https://securelist.com/author/olgakochetova/)\n\nAlexey Osipov\n\nSeven years ago, in 2009, we saw a completely new type of attack on banks. Instead of\ninfecting the computers of thousands of users worldwide, criminals went directly after the\nATM itself – infecting it with malware called Skimer. Seven years later, our Global Research\nand Analysis Team together with Penetration Testing Team have been called on for an\nincident response. They discovered a new, improved, version of Skimer.\n\n\n-----\n\n## Virus style infections\n\nCriminals often obscured their malware with packers to make analysis more difficult for\nresearchers. The criminals behind Skimer also did this, using the commercially available\npacker Themida, which packs both the infector and the dropper.\n\nOnce the malware is executed it checks if the file system is FAT32. If it is, it drops the file\nnetmgr.dll in the folder C:\\Windows\\System32. If it is an NTFS file system, the same file will\nbe placed in the NTFS data stream corresponding to the XFS service´s executable file.\nPlacing the file in an NTFS data stream is most likely done to make forensic analysis more\ndifficult.\n\nAfter successful installation, the sample patches the XFS executable (SpiService.exe) entry\npoint, in order to add a LoadLibrary call to the dropped netmgr.dll file. This file is also\nprotected by Themida.\n\n_Entry point in SpiService.exe before infection_\n\n_Entry point in SpiService.exe after infection_\n\nAfter a successful installation the ATM is rebooted. The malicious library will be loaded into\nthe SpiService.exe thanks to the new LoadLibrary call, providing it with full access to XFS.\n\n\n-----\n\n## Functionality\n\n[Unlike Tyupkin, where there was a magic code and a specific time frame where the malware](https://securelist.com/tyupkin-manipulating-atm-machines-with-malware/66988/)\nwas active, Skimer only wakes up when a magic card (specific Track 2 data, see IOCs at the\nbottom of this blogpost) is inserted. It is a smart way to implement access control to the\nmalware’s functionality.\n\nOnce the magic card is inserted, the malware is ready to interact with two different types of\ncards, each with different functions:\n\n1. Card type 1 – request commands through the interface\n2. Card type 2 – execute the command hardcoded in the Track2\n\nAfter the card is ejected, the user will be presented with a form, asking them to insert the\nsession key in less than 60 seconds. Now the user is authenticated, and the malware will\naccept 21 different codes for setting its activity. These codes should be entered from the pin\npad.\n\nBelow is a list of the most important features:\n\n1. Show installation details;\n2. Dispense money – 40 notes from the specified cassette;\n3. Start collecting the details of inserted cards;\n4. Print collected card details;\n5. Self delete;\n6. Debug mode;\n7. Update (the updated malware code is embedded on the card).\n\nDuring its activity, the malware also creates the following files or NTFS streams (depending\non the file system type). These files are used by the malware at different stages of its activity,\nsuch as storing the configuration, storing skimmed card data and logging its activity:\n\nC:\\Windows\\Temp\\attrib1 card data collected from network traffic or from the card reader;\n\nC:\\Windows\\Temp\\attrib4 logs data from different APIs responsible for the\ncommunication with the keyboard (effectively logging data such\nas the pin);\n\nC:\\Windows\\Temp\\mk32\n\nC:\\Windows\\Temp:attrib1 same as the homologue file;\n\nC:\\Windows\\Temp:attrib4 same as the homologue file;\n\nC:\\Windows\\Temp:mk32 same as the homologue file;\n\nC:\\Windows\\Temp:opt logs mule´s activity.\n\n\n-----\n\n_Main window_\n\nThe following video details the scenario on how money mules interact with an infected ATM\nas described above.\n\n\n-----\n\nWatch Video At:\n\nhttps://youtu.be/hOcFy02c7x0\n\n## Conclusions\n\nDuring our recent Incident Response cases related to the abuse of ATMs, we have identified\n[Tyupkin,](https://securelist.com/tyupkin-manipulating-atm-machines-with-malware/66988/) [Carbanak and black box attacks. The evolution of Backdoor.Win32.Skimer](https://securelist.com/the-great-bank-robbery-the-carbanak-apt/68732/)\ndemonstrates the attacker interest in these malware families as ATMs are a very convenient\ncash-out mechanism for criminals.\n\nOne important detail to note about this case is the hardcoded information in the Track2 – the\nmalware waits for this to be inserted into the ATM in order to activate. Banks may be able to\nproactively look for these card numbers inside their processing systems, and detect\npotentially infected ATMs, money mules, or block attempts to activate the malware.\n\nWe also recommend regular AV scans, the use of allowlisting technologies, a good device\nmanagement policy, full disk encryption, the protection of ATM BIOS with a password, only\nallowing HDD booting, and isolating the ATM network from any other internal bank networks.\n\nKaspersky Lab has now identified 49 modifications of this malware, with 37 of these\nmodifications targeting ATMs made by just one manufacturer. The most recent version was\ndiscovered at the beginning of May 2016.\n\nAll samples described are detected by Kaspersky Lab as Backdoor.Win32.Skimer. Patched\nSpiService.exe files are detected as Trojan.Win32.Patched.rb\n\n\n-----\n\nAs this is still an ongoing investigation, we have already shared the full report with different\n[LEAs, CERTs, financial institutions and Kaspersky Lab Threat Intelligence-Service](http://www.kaspersky.com/enterprise-security/intelligence-services)\n[customers. For more information please contact intelreports@kaspersky.com](http://10.10.0.46/mailto:intelreports@kaspersky.com)\n\n## Appendix I. Indicators of Compromise\n\n### Hashes\n\nF19B2E94DDFCC7BCEE9C2065EBEAA66C\n\n3c434d7b73be228dfa4fb3f9367910d3\n\na67d3a0974f0941f1860cb81ebc4c37c\n\nD0431E71EBE8A09F02BB858A0B9B80380\n\n35484d750f13e763eae758a5f243133\n\ne563e3113918a59745e98e2a425b4e81\n\na7441033925c390ddfc360b545750ff4\n\n### Filenames\n\nC:\\Windows\\Temp\\attrib1\n\nC:\\Windows\\Temp\\attrib4\n\nC:\\Windows\\Temp\\mk32\n\nC:\\Windows\\Temp:attrib1\n\nC:\\Windows\\Temp:attrib4\n\nC:\\Windows\\Temp:mk32\n\nC:\\Windows\\Temp:opt\n\nC:\\Windows\\System32\\netmgr.dll\n\n### Track 2 data\n\n******446987512*=********************\n\n******548965875*=********************\n\n******487470138*=********************\n\n******487470139*=********************\n\n******000000000*=********************\n\n******602207482*=********************\n\n******518134828*=********************\n\n******650680551*=********************\n\n******466513969*=********************\n\n\n-----\n\n[APT](https://securelist.com/tag/apt/)\n[ATM attacks](https://securelist.com/tag/atm-attacks/)\n[Cybercrime](https://securelist.com/tag/cybercrime/)\n[Malware Descriptions](https://securelist.com/tag/malware-descriptions/)\n[Malware Technologies](https://securelist.com/tag/malware-technologies/)\n\nAuthors\n\nGReAT\n\n[Olga Kochetova](https://securelist.com/author/olgakochetova/)\n\nAlexey Osipov\n\nATM infector\n\nYour email address will not be published. Required fields are marked *\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2016/2016-05-17 - ATM infector.pdf"
    ],
    "report_names": [
        "2016-05-17 - ATM infector.pdf"
    ],
    "threat_actors": [
        {
            "id": "c9617bb6-45c8-495e-9759-2177e61a8e91",
            "created_at": "2022-10-25T15:50:23.405039Z",
            "updated_at": "2025-03-27T02:00:55.462193Z",
            "deleted_at": null,
            "main_name": "Carbanak",
            "aliases": [
                "Carbanak",
                "Anunak"
            ],
            "source_name": "MITRE:Carbanak",
            "tools": [
                "Carbanak",
                "Mimikatz",
                "PsExec",
                "netsh"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "8aa5e5a6-87dd-4700-b5a2-11e08218132e",
            "created_at": "2022-10-25T16:07:24.316497Z",
            "updated_at": "2025-03-27T02:02:10.169069Z",
            "deleted_at": null,
            "main_name": "Tempting Cedar Spyware",
            "aliases": [],
            "source_name": "ETDA:Tempting Cedar Spyware",
            "tools": [
                "Tempting Cedar Spyware",
                "TemptingCedar Spyware"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "f4f16213-7a22-4527-aecb-b964c64c2c46",
            "created_at": "2024-06-19T02:03:08.090932Z",
            "updated_at": "2025-03-27T02:05:17.387119Z",
            "deleted_at": null,
            "main_name": "GOLD NIAGARA",
            "aliases": [
                "Carbanak",
                "Carbon Spider ",
                "FIN7 ",
                "Navigator ",
                "Sangria Tempest ",
                "TelePort Crew ",
                "Calcium "
            ],
            "source_name": "Secureworks:GOLD NIAGARA",
            "tools": [
                " Carbanak",
                " Cobalt Strike",
                " DICELOADER",
                " DRIFTPIN",
                " GGLDR",
                " GRIFFON",
                " JSSLoader",
                " Meterpreter",
                " OFFTRACK",
                " PILLOWMINT",
                " POWERTRASH",
                " SUPERSOFT",
                " TAKEOUT",
                " TinyMet",
                "Bateleur"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "bb8702c5-52ac-4359-8409-998a7cc3eeaf",
            "created_at": "2023-01-06T13:46:38.405479Z",
            "updated_at": "2025-03-27T02:00:02.82533Z",
            "deleted_at": null,
            "main_name": "FIN7",
            "aliases": [
                "JokerStash",
                "ATK32",
                "G0046",
                "Coreid",
                "Carbanak",
                "Sangria Tempest",
                "CARBON SPIDER",
                "GOLD NIAGARA",
                "G0008",
                "ELBRUS",
                "Carbon Spider"
            ],
            "source_name": "MISPGALAXY:FIN7",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "ed3810b7-141a-4ed0-8a01-6a972b80458d",
            "created_at": "2022-10-25T16:07:23.443259Z",
            "updated_at": "2025-03-27T02:02:09.801771Z",
            "deleted_at": null,
            "main_name": "Carbanak",
            "aliases": [
                "Anunak",
                "Carbanak",
                "Carbon Spider",
                "ELBRUS",
                "Gold Waterfall",
                "Sangria Tempest"
            ],
            "source_name": "ETDA:Carbanak",
            "tools": [
                "AVE_MARIA",
                "Agentemis",
                "AmmyyRAT",
                "Antak",
                "Anunak",
                "Ave Maria",
                "AveMariaRAT",
                "BABYMETAL",
                "BIRDDOG",
                "Backdoor Batel",
                "Batel",
                "Bateleur",
                "BlackMatter",
                "Boostwrite",
                "Cain & Abel",
                "Carbanak",
                "Cl0p",
                "Cobalt Strike",
                "CobaltStrike",
                "DNSMessenger",
                "DNSRat",
                "DNSbot",
                "DRIFTPIN",
                "DarkSide",
                "FOXGRABBER",
                "FlawedAmmyy",
                "HALFBAKED",
                "JS Flash",
                "KLRD",
                "MBR Eraser",
                "Mimikatz",
                "Nadrac",
                "Odinaff",
                "POWERPIPE",
                "POWERSOURCE",
                "PsExec",
                "SQLRAT",
                "Sekur",
                "Sekur RAT",
                "SocksBot",
                "SoftPerfect Network Scanner",
                "Spy.Agent.ORM",
                "TEXTMATE",
                "TeamViewer",
                "TiniMet",
                "TinyMet",
                "Toshliph",
                "VB Flash",
                "WARPRISM",
                "avemaria",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673536081,
    "ts_updated_at": 1743041817,
    "ts_creation_date": 1653703306,
    "ts_modification_date": 1653703306,
    "files": {
        "pdf": "https://archive.orkl.eu/972b5646b64f08b58a794e17796900da4401e4b2.pdf",
        "text": "https://archive.orkl.eu/972b5646b64f08b58a794e17796900da4401e4b2.txt",
        "img": "https://archive.orkl.eu/972b5646b64f08b58a794e17796900da4401e4b2.jpg"
    }
}