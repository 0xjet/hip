{
    "id": "2973dfbc-8112-4d77-9dad-046374227603",
    "created_at": "2023-01-12T15:09:16.798975Z",
    "updated_at": "2025-03-27T02:13:50.590209Z",
    "deleted_at": null,
    "sha1_hash": "9d8d2008726337a383cbe0b5324c0c214e7f34dc",
    "title": "2021-10-07 - FontOnLake- Previously unknown malware family targeting Linux",
    "authors": "",
    "file_creation_date": "2022-05-28T02:45:43Z",
    "file_modification_date": "2022-05-28T02:45:43Z",
    "file_size": 359793,
    "plain_text": "# FontOnLake: Previously unknown malware family targeting Linux\n\n**[welivesecurity.com/2021/10/07/fontonlake-previously-unknown-malware-family-targeting-linux/](https://www.welivesecurity.com/2021/10/07/fontonlake-previously-unknown-malware-family-targeting-linux/)**\n\nOctober 7, 2021\n\nESET researchers discover a malware family with tools that show signs they’re used in\ntargeted attacks\n\n[Vladislav Hrčka](https://www.welivesecurity.com/author/vhrcka/)\n7 Oct 2021 - 11:30AM\n\n\n-----\n\nESET researchers discover a malware family with tools that show signs they’re used in\ntargeted attacks\n\nESET researchers have discovered a previously unknown malware family that utilizes\ncustom and well-designed modules, targeting systems running Linux. Modules used by this\nmalware family, which we dubbed FontOnLake, are constantly under development and\nprovide remote access to the operators, collect credentials, and serve as a proxy server. In\n[this blogpost, we summarize the findings published in full in our white paper.](https://www.welivesecurity.com/wp-content/uploads/2021/10/eset_fontonlake.pdf)\n\nTo collect data (for instance ssh credentials) or conduct other malicious activity, this\nmalware family uses modified legitimate binaries that are adjusted to load further\ncomponents. In fact, to conceal its existence, FontOnLake’s presence is always\naccompanied by a rootkit. These binaries such as cat, kill or sshd are commonly used on\nLinux systems and can additionally serve as a persistence mechanism.\n\nThe sneaky nature of FontOnLake’s tools in combination with advanced design and low\nprevalence suggest that they are used in targeted attacks.\n\n[FontOnLake: Previously unknown malware family targeting Linux](https://www.welivesecurity.com/wp-content/uploads/2021/10/eset_fontonlake.pdf)\n\n[Read full paper](https://www.welivesecurity.com/wp-content/uploads/2021/10/eset_fontonlake.pdf)\n\nThe first known file of this malware family appeared on VirusTotal last May and other\nsamples were uploaded throughout the year. The location of the C&C server and the\ncountries from which the samples were uploaded to VirusTotal might indicate that its targets\ninclude Southeast Asia.\n\nWe believe that FontOnLake’s operators are particularly cautious since almost all samples\nseen use unique C&C servers with varying non-standard ports. The authors use mostly\n[C/C++ and various third-party libraries such as Boost,](https://www.boost.org/) [Poco, or](https://pocoproject.org/) [Protobuf. None of the C&C](https://developers.google.com/protocol-buffers)\nservers used in samples uploaded to VirusTotal were active at the time of writing – which\nindicates that they could have been disabled due to the upload.\n\n## Known components of FontOnLake\n\nFontOnLake’s currently known components can be divided into three following groups that\ninteract with each other:\n\n\n-----\n\n**Trojanized applications – modified legitimate binaries that are adjusted to load**\nfurther components, collect data, or conduct other malicious activities.\n**Backdoors – user mode components serving as the main point of communication for**\nits operators.\n**Rootkits – kernel mode components that mostly hide and disguise their presence,**\nassist with updates, or provide fallback backdoors.\n\n### Trojanized applications\n\nWe discovered multiple trojanized applications; they are used mostly to load custom\nbackdoor or rootkit modules. Aside from that, they can also collect sensitive data. Patches\nof the applications are most likely applied on the source code level, which indicates that the\napplications must have been compiled and replaced the original ones.\n\nAll the trojanized files are standard Linux utilities and each serves as a persistence method\nbecause they are commonly executed on system start-up. The initial way in which these\ntrojanized applications get to their victims is not known.\n\nCommunication of a trojanized application with its rootkit runs through a virtual file, which is\ncreated and managed by the rootkit. As illustrated in Figure 1, data can be read/written\nfrom/to the virtual file and exported with its backdoor component upon the operator’s\nrequest.\n\n_Figure 1. Interaction of FontOnLake’s components_\n\n### Backdoors\n\n\n-----\n\nThe three different backdoors we discovered are written in C++ and all use, albeit in slightly\ndifferent ways, the same [Asio library from Boost for asynchronous network and low-level](https://www.boost.org/doc/libs/1_69_0/doc/html/boost_asio.html)\nI/O. [Poco,](https://pocoproject.org/) [Protobuf, and features from STL such as smart pointers are used as well. What](https://developers.google.com/protocol-buffers)\nis rare for malware is the fact that these backdoors also feature a number of software\ndesign patterns.\n\nThe functionality that they all have in common is that each exfiltrates collected credentials\nand its bash command history to its C&C.\n\nConsidering some of the overlapping functionality, most likely these different backdoors are\nnot used together on one compromised system.\n\nAll the backdoors additionally use custom heartbeat commands sent and received\nperiodically to keep the connection alive.\n\nThe overall functionality of these backdoors consists of the following methods:\n\nExfiltrating the collected data\nCreating a bridge between a custom ssh server running locally and its C&C\nManipulating files (for instance, upload/download, create/delete, directory listing,\nmodify attributes, and so on)\nServing as a proxy\nExecuting arbitrary shell commands and python scripts\n\n**_Rootkit_**\n\nWe discovered two marginally different versions of the rootkit, used only one at a time, in\neach of the three backdoors. There are significant differences between those two rootkits;\nhowever, certain aspects of them overlap. Even though the rootkit versions are based on\nthe [suterusu open-source project, they contain several of FontOnLake’s exclusive, custom](https://github.com/mncoppola/suterusu)\ntechniques.\n\nCombined functionality of the two versions of the rootkit we discovered include:\n\nProcess hiding\nFile hiding\nHiding itself\nHiding network connections\nExposing the collected credentials to its backdoor\nPerforming port forwarding\nMagic packets reception (magic packets are specially crafted packets that can instruct\nthe rootkit to download and execute another backdoor)\n\n\n-----\n\nFollowing our discovery while finalizing our white paper on this topic, vendors such as\n[Tencent Security Response Center,](https://security.tencent.com/index.php/blog/msg/180) [Avast and](https://twitter.com/AvastThreatLabs/status/1430527767855058949) [Lacework Labs published their research on](https://www.lacework.com/blog/hcrootkit-sutersu-linux-rootkit-analysis/)\nwhat appears to be the same malware.\n\nAll known components of FontOnLake are detected by ESET products as\nLinux/FontOnLake. Companies or individuals who want to protect their Linux endpoints or\nservers from this threat should use a multilayered security product and an updated version\nof their Linux distribution; some of the samples we have analyzed were created specifically\nfor CentOS and Debian.\n\nIn the past we described an operation that shared certain behavioral patterns with\nFontOnLake; however, its scale and impact were much bigger. We dubbed it Operation\n[Windigo and you can find more information about it in this white paper and](https://www.welivesecurity.com/wp-content/uploads/2014/03/operation_windigo.pdf) this follow-up\nblogpost.\n\n[Additional technical details on FontOnLake can be found in our comprehensive white paper.](https://www.welivesecurity.com/wp-content/uploads/2021/10/eset_fontonlake.pdf)\n\n## IoCs\n\n### Samples\n\n**SHA-1** **Description** **Detection name**\n\n\n1F52DB8E3FC3040C017928F5FFD99D9FA4757BF8 Trojanized\ncat\n\n771340752985DD8E84CF3843C9843EF7A76A39E7 Trojanized\nkill\n\n27E868C0505144F0708170DF701D7C1AE8E1FAEA Trojanized\nsftp\n\n45E94ABEDAD8C0044A43FF6D72A5C44C6ABD9378 Trojanized\nsshd\n\n1829B0E34807765F2B254EA5514D7BB587AECA3F Custom\nsshd\n\n8D6ACA824D1A717AE908669E356E2D4BB6F857B0 Custom\nsshd\n\n38B09D690FAFE81E964CBD45EC7CF20DCB296B4D Backdoor 1\nvariant 1\n\n56556A53741111C04853A5E84744807EEADFF63A Backdoor 1\nvariant 2\n\n\nLinux/FontOnLake\n\n\n-----\n\n**SHA-1** **Description** **Detection name**\n\nFE26CB98AA1416A8B1F6CED4AC1B5400517257B2 Backdoor 1\nvariant 3\n\nD4E0E38EC69CBB71475D8A22EDB428C3E955A5EA Backdoor 1\nvariant 4\n\n204046B3279B487863738DDB17CBB6718AF2A83A Backdoor 2\nvariant 1\n\n9C803D1E39F335F213F367A84D3DF6150E5FE172 Backdoor 2\nvariant 2\n\nBFCC4E6628B63C92BC46219937EA7582EA6FBB41 Backdoor 2\nvariant 3\n\n515CFB5CB760D3A1DA31E9F906EA7F84F17C5136 Backdoor 3\nvariant 4\n\nA9ED0837E3AF698906B229CA28B988010BCD5DC1 Backdoor 3\nvariant 5\n\n56CB85675FE7A7896F0AA5365FF391AC376D9953 Rootkit 1\nversion 1\n\n72C9C5CE50A38D0A2B9CEF6ADEAB1008BFF12496 Rootkit 1\nversion 2\n\nB439A503D68AD7164E0F32B03243A593312040F8 Rootkit 1\nversion 3\n\nE7BF0A35C2CD79A658615E312D35BBCFF9782672 Rootkit 1\nversion 4\n\n56580E7BA6BF26D878C538985A6DC62CA094CD04 Rootkit\n1version 5\n\n49D4E5FCD3A3018A88F329AE47EF4C87C6A2D27A Rootkit 1\nversion 5\n\n74D44C2949DA7D5164ADEC78801733680DA8C110 Rootkit 2\nversion 1\n\n74D755E8566340A752B1DB603EF468253ADAB6BD Rootkit 2\nversion 2\n\nE20F87497023E3454B5B1A22FE6C5A5501EAE2CB Rootkit 2\nversion 3\n\n6F43C598CD9E63F550FF4E6EF51500E47D0211F3 inject.so\n\n\n-----\n\n### C&Cs\n\n**_From samples:_**\n\n47.107.60[.]212\n\n47.112.197[.]119\n\n156.238.111[.]174\n\n172.96.231[.]69\n\nhm2.yrnykx[.]com\n\nywbgrcrupasdiqxknwgceatlnbvmezti[.]com\n\nyhgrffndvzbtoilmundkmvbaxrjtqsew[.]com\n\nwcmbqxzeuopnvyfmhkstaretfciywdrl[.]name\n\nruciplbrxwjscyhtapvlfskoqqgnxevw[.]name\n\npdjwebrfgdyzljmwtxcoyomapxtzchvn[.]com\n\nnfcomizsdseqiomzqrxwvtprxbljkpgd[.]name\n\nhkxpqdtgsucylodaejmzmtnkpfvojabe[.]com\n\netzndtcvqvyxajpcgwkzsoweaubilflh[.]com\n\nesnoptdkkiirzewlpgmccbwuynvxjumf[.]name\nekubhtlgnjndrmjbsqitdvvewcgzpacy[.]name\n\n**_From internet-wide scan:_**\n\n27.102.130[.]63\n\n### Filenames\n\n/lib/modules/%VARIABLE%/kernel/drivers/input/misc/ati_remote3.ko\n\n/etc/sysconfig/modules/ati_remote3.modules\n\n/tmp/.tmp_%RANDOM%\n\n### Virtual filenames\n\n/proc/.dot3\n\n/proc/.inl\n\n## MITRE ATT&CK techniques\n\n_[This table was built using version 9 of the ATT&CK framework.](https://attack.mitre.org/versions/)_\n\n**Tactic** **ID** **Name** **Description**\n\n\nInitial\nAccess\n\n\n[T1078](https://attack.mitre.org/techniques/T1078/) Valid Accounts FontOnLake can\ncollect at least\nssh credentials.\n\n\n-----\n\n**Tactic** **ID** **Name** **Description**\n\n\nExecution [T1059.004](https://attack.mitre.org/techniques/T1059/004/) Command and Scripting Interpreter:\nUnix Shell\n\n\n[T1059.006](https://attack.mitre.org/techniques/T1059/006/) Command\nand Scripting\nInterpreter:\nPython\n\n\nFontOnLake enables execution of\narbitrary Python scripts.\n\n\n[T1106](https://attack.mitre.org/techniques/T1106/) Native API FontOnLake uses fork() to create\nadditional processes such as sshd.\n\n\n[T1204](https://attack.mitre.org/techniques/T1204/) User\nExecution\n\n\nFontOnLake trojanizes standard tools\nsuch as cat to execute itself.\n\n\nPersistence [T1547.006](https://attack.mitre.org/techniques/T1547/006/) Boot or Logon Autostart Execution:\nKernel Modules and Extensions\n\n\n[T1037](https://attack.mitre.org/techniques/T1037/) Boot or\nLogon\nInitialization\nScripts\n\n[T1554](https://attack.mitre.org/techniques/T1554/) Compromise\nClient\nSoftware\nBinary\n\n\nFontOnLake creates a system start-up\nscript ati_remote3.modules.\n\nFontOnLake modifies several standard\nbinaries to achieve persistence.\n\n\nFontOnLake\nenables\nexecution of Unix\nShell commands.\n\nOne of\nFontOnLake’s\nrootkits can be\nexecuted with a\nstart-up script.\n\nSome backdoors\nof FontOnLake\ncan decrypt AESencrypted and\nserialized\ncommunication\nand base64\ndecode\nencrypted C&C\naddress.\n\n\nDefense\nEvasion\n\n\n[T1140](https://attack.mitre.org/techniques/T1140/) Deobfuscate/Decode Files or\nInformation\n\n\n-----\n\n**Tactic** **ID** **Name** **Description**\n\n\n[T1222.002](https://attack.mitre.org/techniques/T1222/002/) File and\nDirectory\nPermissions\nModification:\nLinux and\nMac File and\nDirectory\nPermissions\nModification\n\n\nFontOnLake’s backdoor can change\nthe permissions of the file it wants to\nexecute.\n\n\n[T1564](https://attack.mitre.org/techniques/T1564/001/) Hide Artifacts FontOnLake hides its connections and\nprocesses with rootkits.\n\n\n[T1564.001](https://attack.mitre.org/techniques/T1564/001/) Hide\nArtifacts:\nHidden Files\nand\nDirectories\n\n[T1027](https://attack.mitre.org/techniques/T1027/) Obfuscated\nFiles or\nInformation\n\n\nFontOnLake hides its files with rootkits.\n\nFontOnLake packs its executables with\nUPX.\n\n\n[T1014](https://attack.mitre.org/techniques/T1014/) Rootkit FontOnLake uses rootkits to hide the\npresence of its processes, files,\nnetwork connections and drivers.\n\n\nCredential\nAccess\n\n\n[T1556](https://attack.mitre.org/techniques/T1556/) Modify Authentication Process FontOnLake\nmodifies sshd to\ncollect\ncredentials.\n\n\nDiscovery [T1083](https://attack.mitre.org/techniques/T1083/) File and Directory Discovery One of\nFontOnLake’s\nbackdoors can\nlist files and\ndirectories.\n\n\n[T1082](https://attack.mitre.org/techniques/T1082/) System\nInformation\nDiscovery\n\n\nFontOnLake can collect system\ninformation from the victim’s machine.\n\n\nLateral\nMovement\n\n\n[T1021.004](https://attack.mitre.org/techniques/T1021/004/) Remote Services: SSH FontOnLake\ncollects ssh\ncredentials and\nmost probably\nintends to use\nthem for lateral\nmovement.\n\n\n-----\n\n**Tactic** **ID** **Name** **Description**\n\n\nCommand\nand Control\n\n\n[T1090](https://attack.mitre.org/techniques/T1090/) Proxy FontOnLake can\nserve as a proxy.\n\n\n[T1071.001](https://attack.mitre.org/techniques/T1071/001/) Application\nLayer\nProtocol:\nWeb\nProtocols\n\n[T1071.002](https://attack.mitre.org/techniques/T1071/002/) Application\nLayer\nProtocol: File\nTransfer\nProtocols\n\n[T1132.001](https://attack.mitre.org/techniques/T1132/001/) Data\nEncoding:\nStandard\nEncoding\n\n[T1568](https://attack.mitre.org/techniques/T1568/) Dynamic\nResolution\n\n[T1573.001](https://attack.mitre.org/techniques/T1573/001/) Encrypted\nChannel:\nSymmetric\nCryptography\n\n[T1008](https://attack.mitre.org/techniques/T1008/) Fallback\nChannels\n\n[T1095](https://attack.mitre.org/techniques/T1095/) NonApplication\nLayer\nProtocol\n\n[T1571](https://attack.mitre.org/techniques/T1571/) NonStandard\nPort\n\n\nFontOnLake acquires additional C&C\nservers over HTTP.\n\nFontOnLake can download additional\nPython files to be executed over FTP.\n\nFontOnLake uses base64 to encode\nHTTPS responses.\n\nFontOnLake can use HTTP to\ndownload resources that contain an IP\naddress and port number pair to\nconnect to and acquire its C&C. It can\nuse dynamic DNS resolution to\nconstruct and resolve to a randomly\nchosen domain.\n\nFontOnLake uses AES to encrypt\ncommunication with its C&C.\n\nFontOnLake can use dynamic DNS\nresolution to construct and resolve to a\nrandomly chosen domain. One of its\nrootkits also listens for specially crafted\npackets, which instruct it to download\nand execute additional files. It also\nboth connects to a C&C and accepts\nconnections on all interfaces.\n\nFontOnLake uses TCP for\ncommunication with its C&C.\n\nAlmost every sample of FontOnLake\nuses a unique non-standard port.\n\n\n-----\n\n**Tactic** **ID** **Name** **Description**\n\nExfiltration [T1041](https://attack.mitre.org/techniques/T1041/) Exfiltration Over C2 Channel FontOnLake\nuses its C&C to\nexfiltrate\ncollected data.\n\n7 Oct 2021 - 11:30AM\n\n### Sign up to receive an email update whenever a new article is published in our Ukraine Crisis – Digital Security Resource Center\n\n Newsletter\n\n Discussion\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-10-07 - FontOnLake- Previously unknown malware family targeting Linux.pdf"
    ],
    "report_names": [
        "2021-10-07 - FontOnLake- Previously unknown malware family targeting Linux.pdf"
    ],
    "threat_actors": [
        {
            "id": "3844202f-b24a-4e16-b7b9-dfe8c0a44d5d",
            "created_at": "2022-10-25T16:07:24.526179Z",
            "updated_at": "2025-03-27T02:02:10.27234Z",
            "deleted_at": null,
            "main_name": "Operation Windigo",
            "aliases": [],
            "source_name": "ETDA:Operation Windigo",
            "tools": [
                "CDorked",
                "CDorked.A",
                "Calfbot",
                "Ebury"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "1934b371-2525-4615-a90a-772182bc4184",
            "created_at": "2022-10-25T15:50:23.396576Z",
            "updated_at": "2025-03-27T02:00:55.460522Z",
            "deleted_at": null,
            "main_name": "Windigo",
            "aliases": [
                "Windigo"
            ],
            "source_name": "MITRE:Windigo",
            "tools": [
                "Ebury"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1673536156,
    "ts_updated_at": 1743041630,
    "ts_creation_date": 1653705943,
    "ts_modification_date": 1653705943,
    "files": {
        "pdf": "https://archive.orkl.eu/9d8d2008726337a383cbe0b5324c0c214e7f34dc.pdf",
        "text": "https://archive.orkl.eu/9d8d2008726337a383cbe0b5324c0c214e7f34dc.txt",
        "img": "https://archive.orkl.eu/9d8d2008726337a383cbe0b5324c0c214e7f34dc.jpg"
    }
}