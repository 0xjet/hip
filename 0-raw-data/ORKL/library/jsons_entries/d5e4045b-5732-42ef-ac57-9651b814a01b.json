{
    "id": "d5e4045b-5732-42ef-ac57-9651b814a01b",
    "created_at": "2023-01-12T15:01:44.230149Z",
    "updated_at": "2025-03-27T02:16:39.934609Z",
    "deleted_at": null,
    "sha1_hash": "521534a46bbe3aaf132f115cb84a715950a0ae8f",
    "title": "2022-06-24 - “We need to talk about subdomain takeovers…”",
    "authors": "",
    "file_creation_date": "2022-08-18T03:20:52Z",
    "file_modification_date": "2022-08-18T03:20:52Z",
    "file_size": 1764238,
    "plain_text": "# “We need to talk about subdomain takeovers…”\n\n**[silentpush.com/blog/we-need-to-talk-about-subdomain-takeovers](https://www.silentpush.com/blog/we-need-to-talk-about-subdomain-takeovers)**\n\nJun 24\nWritten By [The Team](http://10.10.0.46/blog?author=6081bc3c4920d358398731f8)\n\nEverything is linked, even if you’ve forgotten you linked them\n\n\nJune 24, 2022\n\n\n-----\n\nWalk into most cybersecurity seminars, product demonstrations or corporate training\nsessions and you’d be forgiven for thinking that antimalware platforms are the savior of\nhumanity.\n\nLAN-based Security-as-a-Service is undoubtedly here to stay, but the most clear and\npresent danger to corporate IT infrastructures across the globe can’t be solely combated\nwith virus definitions, or all-singing-all-dancing gateway devices. If irreparable financial and\nreputational damage is the potential problem, the most pressing solution lies in the most\nunassuming of places - your public DNS records.\n\n## What are sub-domain takeovers?\n\nOn a basic level, subdomain takeovers occur when hackers gain unfettered access to one\nor more subdomains within an organization’s DNS records.\n\nIn technical terms, it’s usually a CNAME record (although NS, A records and even mail\nrecords are vulnerable) that’s no longer pointing to a valid source, and it can happen to\n[anyone. A few years ago, researchers discovered no less than 670 Microsoft subdomains](https://nakedsecurity.sophos.com/2020/03/06/researcher-finds-670-microsoft-subdomains-vulnerable-to-takeover/)\nthat were wide open to an attack.\n\nSubdomain takeovers feature a number of different attack vectors that are usually a heady\nmix of opportunism and good old-fashioned bad housekeeping. Let’s take a look at two\ncommon intrusion methods.\n\n### Expired subdomains\n\nWhen organizations allow a subdomain to expire, but forget to remove the DNS record\nassociated with it in their main domain, what was once a legitimate subdomain prefix is now\nup for grabs to anyone who wants it, along with a ready-made backdoor onto an\norganization’s public DNS platform.\n\nA domain taken over by us for safe keeping\n\n### Non-existent services\n\n\n-----\n\nEven if you have your DNS records in relatively good order, you re still not safe. If one of\nyour subdomains is directed at an external service that has either been moved elsewhere,\nor removed entirely, a threat actor is able to establish a presence on said service with the\ninvalid subdomain - also called a “dangling DNS attack” - and with a little CNAME magic, it’s\ntheirs.\n\n## The trouble with cookies…\n\nThe consequences of a subdomain takeover are many and varied - from XSS attacks to\nemail spoofing - but the one that organizations need to be most wary of are compromised\nsession cookies, and again, it comes down to a lackadaisical approach to DNS security.\n\nIf your organization shares browser cookies across some or all of your subdomains, and\none of those subdomains is hijacked, you run the risk of not only allowing a threat actor to\nutilize hashed credentials stored in the cookie and authenticating themselves as a user, but\nexposing your company-wide SSO service, and all that it provides access to.\n\n## A modern problem\n\nAs with most cybersecurity threats, subdomain takeovers’ risk level is directly proportional\nto how difficult it is to detect and combat, and grows exponentially with the size of the\norganization, and the amount of subdomains they operate with.\n\n[The explosion of SaaS-based commerce and cloud service platforms over the last decade](https://www.fortunebusinessinsights.com/software-as-a-service-saas-market-102222)\nhas given rise to innumerable third-party platforms that require some form of DNS\nvalidation. This phenomenon - coupled with aggressive marketing tactics that often require\ncompanies to register numerous subdomains to validate landing pages and individual\nproducts and services - means that low-hanging DNS records, and the session cookies and\nhashed credentials they provide access to, are becoming more and more of a commodity\nfor threat actors around the world.\n\nIt’s not just an issue with how modern domains are structured. Well-established security\ncountermeasures are ill-equipped to deal with the kind of DNS oversights that lead to\ndomain takeovers. PKI certificates - whilst always advisable on any network - aren’t much\nuse with compromised cookies, and no amount of endpoint protection will prevent a threat\nactor from accessing your public DNS records, should they have the means to do so.\n\n## Common countermeasures\n\nFortunately though, it’s not all doom and gloom. There are a number of ways that\norganizations can operate with a secure set of DNS records and simultaneously improve\nWAN security across the board, not limited to close management of topic-specific factors\n\n\n-----\n\nsuch as wildcard certs that provide a threat actor with blanket access to any domain\nassociated with them.\n\nFirst and foremost, organizations need to treat their DNS records with the TLC that they\ndeserve, and recognise that corporate cybersecurity doesn’t begin and end with\n\nendpoint security. CTOs and CISOs need to keep a firm grip on every last subdomain, and\nmaintain an understanding of what services are being used and whether they’re still in use e.g. when formulating workflows for decommissioning services, be sure to add a line entry\nthat specifies a CNAME removal\n\nAs well as internal governance, it pays to be skeptical. If your organization is thinking about\nusing an external service that incorporates DNS functionality and subdomain registrations,\ndon’t be afraid to ask their onboarding team about how they specifically protect against\nsubdomain takeovers. If they’re good, they’ll be able to tell you about common\ncountermeasures such as linked TXT entries, or banning re-registrations. If they seem\nunsure about what you’re asking, alarm bells should be ringing.\n\n## Looking ahead\n\n[Last year witnessed a 20% increase in apex and subdomain takeovers. Threat actors are](https://www.helpnetsecurity.com/2022/03/29/subdomain-takeovers-on-the-rise/#:~:text=Subdomain%20takeovers%20and%20vulnerabilities%20per,in%202021%20than%20in%202020.)\nconstantly on the lookout for the next big thing, and they may just have found it. Data from\nour own threat protection platform has identified almost 3 million global DNS entries that\nare ripe for the picking as dangling records - 2.7 million CNAMES and over 300,000 NS\nrecords. There are also 3.9 million MX records dangling but less likely to be taken over.\n\nThe problem isn’t limited to small-time SaaS/PaaS/IaaS platforms with a laid-back approach\nto DNS security. This is an issue that affects the world’s largest cloud service providers - the\nvery same providers who are supposed to operate with the most sophisticated threat\nmodels the industry has to offer. Our own data shows 70 expired services on Microsoft\nAzure’s content delivery network (azureedge.net) with an attached domain, that run the risk\nof being hijacked, and nearly 80 of the same across the global GitHub platform.\n\nIn the same way that law enforcement authorities need to focus more on the individuals that\nprovide criminals with access to ransomware platforms, rather than the criminals\n_themselves, the security community needs to evangelize less about malware as an_\nexistential cyber threat, and shout from the rooftops about subdomain takeovers and cookie\nhijacking as the next major development in enterprise-level threat protection.\n\n\n-----\n\n### How to find Vulnerable DNS Records\n\nWe have created a Dangling DNS finder in our Query builder. We have made this available\n[for free in our Community version, you can apply for access here, you must use a work](https://www.silentpush.com/passive-dns-api-request)\nemail address.\n\nName\n*\nThank you!\n\n[The Team](http://10.10.0.46/blog?author=6081bc3c4920d358398731f8)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-06-24 - “We need to talk about subdomain takeovers…”.pdf"
    ],
    "report_names": [
        "2022-06-24 - “We need to talk about subdomain takeovers…”.pdf"
    ],
    "threat_actors": [
        {
            "id": "d90307b6-14a9-4d0b-9156-89e453d6eb13",
            "created_at": "2022-10-25T16:07:23.773944Z",
            "updated_at": "2025-03-27T02:02:09.974695Z",
            "deleted_at": null,
            "main_name": "Lead",
            "aliases": [
                "Casper",
                "TG-3279"
            ],
            "source_name": "ETDA:Lead",
            "tools": [
                "Agentemis",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "RbDoor",
                "RibDoor",
                "Winnti",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "aa73cd6a-868c-4ae4-a5b2-7cb2c5ad1e9d",
            "created_at": "2022-10-25T16:07:24.139848Z",
            "updated_at": "2025-03-27T02:02:10.120505Z",
            "deleted_at": null,
            "main_name": "Safe",
            "aliases": [],
            "source_name": "ETDA:Safe",
            "tools": [
                "DebugView",
                "LZ77",
                "OpenDoc",
                "SafeDisk",
                "TypeConfig",
                "UPXShell",
                "UsbDoc",
                "UsbExe"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "2864e40a-f233-4618-ac61-b03760a41cbb",
            "created_at": "2023-12-01T02:02:34.272108Z",
            "updated_at": "2025-03-27T02:02:10.209072Z",
            "deleted_at": null,
            "main_name": "WildCard",
            "aliases": [],
            "source_name": "ETDA:WildCard",
            "tools": [
                "RustDown",
                "SysJoker"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "256a6a2d-e8a2-4497-b399-628a7fad4b3e",
            "created_at": "2023-11-30T02:00:07.299845Z",
            "updated_at": "2025-03-27T02:00:03.257794Z",
            "deleted_at": null,
            "main_name": "WildCard",
            "aliases": [],
            "source_name": "MISPGALAXY:WildCard",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673535704,
    "ts_updated_at": 1743041799,
    "ts_creation_date": 1660792852,
    "ts_modification_date": 1660792852,
    "files": {
        "pdf": "https://archive.orkl.eu/521534a46bbe3aaf132f115cb84a715950a0ae8f.pdf",
        "text": "https://archive.orkl.eu/521534a46bbe3aaf132f115cb84a715950a0ae8f.txt",
        "img": "https://archive.orkl.eu/521534a46bbe3aaf132f115cb84a715950a0ae8f.jpg"
    }
}