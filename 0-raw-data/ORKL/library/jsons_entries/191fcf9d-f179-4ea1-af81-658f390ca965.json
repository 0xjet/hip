{
    "id": "191fcf9d-f179-4ea1-af81-658f390ca965",
    "created_at": "2023-01-12T15:09:45.781983Z",
    "updated_at": "2025-03-27T02:15:35.771173Z",
    "deleted_at": null,
    "sha1_hash": "4daefc2e00ccaebe925439d3864f69768aa871a8",
    "title": "2018-05-30 - Thief in the night- New Nocturnal Stealer grabs data on the cheap",
    "authors": "",
    "file_creation_date": "2022-05-28T19:50:58Z",
    "file_modification_date": "2022-05-28T19:50:58Z",
    "file_size": 3022162,
    "plain_text": "# Thief in the night: New Nocturnal Stealer grabs data on the cheap\n\n**[proofpoint.com/us/threat-insight/post/thief-night-new-nocturnal-stealer-grabs-data-cheap](https://www.proofpoint.com/us/threat-insight/post/thief-night-new-nocturnal-stealer-grabs-data-cheap)**\n\nMay 30, 2018\n\n\n-----\n\n[Blog](https://www.proofpoint.com/us/blog)\n[Threat Insight](https://www.proofpoint.com/us/blog/threat-insight)\nThief in the night: New Nocturnal Stealer grabs data on the cheap\n\n\n-----\n\nMay 30, 2018 Proofpoint Staff\n\n**Overview**\n\nWith the massive ransomware campaigns of 2016 and 2017 taking a backseat to bankers and other\n[malware families, information stealers made up 18% of malicious email payloads in the first part of this](https://www.proofpoint.com/us/threat-insight/post/proofpoint-threat-report-banking-trojans-dominate-malware-landscape-first-months)\nyear. Proofpoint researchers recently discovered a new stealer, dubbed “Nocturnal Stealer,” most\nnotable as an example of inexpensive commodity malware with significant potential for monetization.\n\nOn March 9, a user posted an advertisement for Nocturnal Stealer on an underground forum. The\nstealer sold for 1500 Rubles, or roughly US$25 at the time of analysis. Nocturnal Stealer is designed to\nsteal the data found within multiple Chromium and Firefox based browsers. It can also steal many\npopular cryptocurrency wallets as well as any saved FTP passwords within FileZilla. Proofpoint\nresearchers analyzed a sample being dropped in the wild by an unknown loader.\n\n**Analysis**\n\nWe recently observed Nocturnal Stealer being dropped by an unknown loader in the wild. The loader\ndropped three files, one of which was the information stealer Trojan. The stealer, written in C++,\ncreates a new directory named in the format 'NocturnalXXXXXXXX-XXXX-XXXX-XXXXXXXXXXXXXXXX' (the string ‘Nocturnal’ followed by machine’s UUID). A copy of the malware is\nplaced in this directory with random digits in the file name. Nocturnal Stealer stages stolen information\nin this directory in files such as ‘information.txt’ and ‘passwords.txt’.\n\n_Figure 1: Directory and files created by the malware_\n\nUpon execution, Nocturnal Stealer searches the '%LOCALAPPDATA%' directory for any sensitive data\nor files related to the browsers, cryptocurrency wallets, and FTP clients it currently targets. If found, the\nmalware copies data into the 'passwords.txt' file. The stolen data for targeted browsers includes login\ncredentials, cookies, web data, autofill data, and stored credit cards.\n\n\n-----\n\nNocturnal Stealer copies other information into the information.txt file. This includes system\ninformation such as machine ID, date/time, installation location, operating system, architecture,\nusername, processor type, video card, and a list of all running processes. The malware only reports\nsome of this information back to the Command and Control (C&C) server via a check-in beacon, but\nalso zips and uploads all of the information contained in the dropped files to the C&C.\n\n_Figure 2: Example contents of information.txt_\n\nTo avoid detection, Nocturnal Stealer uses several anti-VM and anti-analysis techniques, which include\nbut are not limited to: environment fingerprinting, checking for debuggers and analyzers, searching for\nknown virtual machine registry keys, and checking for emulation software. We commonly observe this\nstep in some mainstream crimeware, but it is unusual for most of the budget crimeware we analyze.\n\n**Network Traffic Analysis**\n\n\n-----\n\nNocturnal Stealer makes two initial requests to retrieve the infected machine s external IP address and\ncountry code, using the free service ip-api.com. Once the malware has acquired this information, the\nmain C&C traffic begins. It utilizes an HTTP POST method for the initial check-in to report the infected\nmachine information to the C&C server. This POST uses the User-Agent 'Nocturnal/1.0' which contains\nthe name and the version of the stealer. This may indicate that this is the first major version of this\nNocturnal Stealer to be observed in the wild.\n\nNocturnal Stealer utilizes a multi-part HTTP POST form containing stolen information to send to the\nC&C. This report contains relevant information for tracking infections and managing infected clients\nsuch as: HWID, OS, system architecture, and username. Importantly, this report also contains a zip\narchive with the harvested data. The first text file, passwords.txt, which is attached even if empty,\ncontains passwords recovered from various browsers or wallets from the infected machine. The\n'information.txt' file contains a system report of generic information about the infected machine, similar\nto what is observed in the other parts of the HTTP POST. This contains additional information,\nhowever, including running processes on the infected machine.\n\nFurthermore, if Nocturnal Stealer finds relevant data on the machine -- such as stored credit cards,\ncookies, or other browser information -- this will be included in the .zip containing system information.\nFor example, if a system had stored Chrome and Firefox data, it would appear in the zip as:\n\nautofill_Google Chrome_Default.txt\ncc_Google Chrome_Default.txt\ncookies_Google Chrome_Default.txt\ncookies_Mozilla Firefox_<user_id>.default.txt\n\nOnce Nocturnal Stealer is done searching for relevant data, zipping data to be exfiltrated, and sending\nit to the C&C, it runs a simple command to kill the stealer task as well as remove the dropped files:\n\ncmd.exe /c taskkill /im <random_digits>.exe /f & erase C:\\ProgramData\\Nocturnal<System_UUID>\\\n<random_digits>.exe & exit\n\n\n-----\n\n_Figure 3: Nocturnal Stealer C&C Communications_\n\nNocturnal Stealer advertises two-factor authentication to its C&C panel (Figure 4).\n\n\n-----\n\n_Figure 4: Nocturnal Stealer C&C panel_\n\nThe advertisement touts the lack of data collection about its users, including IP addresses. It also notes\nthat the operators perform server setup on behalf of the users. However, while this reduces potential\nsetup issues, it also introduces a single point of failure and means that the author of the malware is\nreally in control of all stolen data.\n\nA portion of the advertisement is shown in Figure 5. As noted in the ad, the malware supports 22\npopular browsers and their forks: Chromium, Google Chrome, Kometa, Amigo, Torch, Orbitum, Opera,\nComodo Dragon, Nichrome, Yandex Browser, Maxthon5, Sputnik, Epic Privacy Browser, Vivaldi,\nCocCoc, Mozilla Firefox, Pale Moon, Waterfox, Cyberfox, BlackHawk, IceCat, K-Meleon, and others.\n\nIt also supports 28 cryptocurrency wallets: Bitcoin Core, Ethereum, ElectrumLTC, Monero, Electrum,\nExodus, Dash, Litecoin, ElectronCash, ZCash, MultiDoge, AnonCoin, BBQCoin, DevCoin, DigitalCoin,\nFlorinCoin, Franko, FreiCoin, GoldCoin, InfiniteCoin, IOCoin, IxCoin, MegaCoin, MinCoin, NameCoin,\nPrimeCoin, TerraCoin, and YACoin.\n\nAlthough not pictured in Figure 5, the ad also notes support for the FileZilla FTP client.\n\n\n-----\n\n_Figure 5: A portion of the Nocturnal Stealer advertisement_\n\n**Conclusion**\n\nNocturnal Stealer is not a particularly advanced piece of malware. However, the new stealer provides a\nglimpse into the evolving criminal markets that continue to produce new variations on the crimeware\nwe see everyday. Inexpensive, lightweight malware that can be deployed in a one-shot manner by\n\n\n-----\n\neven entry-level cybercriminals to harvest and exfiltrate sensitive data is a real concern for defenders\nand organizations. Nocturnal Stealer and other malware like it provide a would-be cybercriminal with\nthe means to cause damage and harm to people and companies easily and cheaply.\n\n**Indicators of Compromise (IOCs)**\n\n\n**IOC** **IOC**\n**Type**\n\n\n**Description**\n\n\n205def439aeb685d5a9123613e49f59d4cd5ebab9e933a1567a2f2972bda18c3 SHA256 Loader\n\nae7e5a7b34dc216e9da384fcf9868ab2c1a1d731f583f893b2d2d4009da15a4e SHA256 Nocturnal\nStealer\n\nhxxp://nctrnl[.]us/server/gate.php URL Nocturnal\nStealer C&C\n\n**ET and ETPRO Suricata/Snort Signatures**\n\n2830957 - ETPRO TROJAN Win32.Nocturnal Stealer Checkin\n\n2830956 - ETPRO TROJAN Win32.Nocturnal Stealer IP Check\n\n2830958 - ETPRO TROJAN Win32.Nocturnal Updater Requesting EXE\n\nSubscribe to the Proofpoint Blog\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2018/2018-05-30 - Thief in the night- New Nocturnal Stealer grabs data on the cheap.pdf"
    ],
    "report_names": [
        "2018-05-30 - Thief in the night- New Nocturnal Stealer grabs data on the cheap.pdf"
    ],
    "threat_actors": [
        {
            "id": "9f101d9c-05ea-48b9-b6f1-168cd6d06d12",
            "created_at": "2023-01-06T13:46:39.396409Z",
            "updated_at": "2025-03-27T02:00:03.074969Z",
            "deleted_at": null,
            "main_name": "Earth Lusca",
            "aliases": [
                "CHROMIUM",
                "ControlX",
                "Red Dev 10",
                "RedHotel",
                "Red Scylla",
                "TAG-22",
                "BRONZE UNIVERSITY",
                "AQUATIC PANDA",
                "Charcoal Typhoon",
                "BountyGlad"
            ],
            "source_name": "MISPGALAXY:Earth Lusca",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "a66438a8-ebf6-4397-9ad5-ed07f93330aa",
            "created_at": "2022-10-25T16:47:55.919702Z",
            "updated_at": "2025-03-27T02:05:17.412024Z",
            "deleted_at": null,
            "main_name": "IRON VIKING",
            "aliases": [
                "ATK14 ",
                "BlackEnergy Group",
                "Blue Echidna ",
                "CTG-7263 ",
                "ELECTRUM ",
                "FROZENBARENTS ",
                "Hades/OlympicDestroyer ",
                "IRIDIUM ",
                "Qudedagh ",
                "Sandworm Team ",
                "Seashell Blizzard ",
                "TEMP.Noble ",
                "Telebots ",
                "Voodoo Bear ",
                "APT44 "
            ],
            "source_name": "Secureworks:IRON VIKING",
            "tools": [
                " BlackEnergy",
                " GCat",
                " GreyEnergy",
                " Industroyer",
                " KillDisk",
                " NotPetya",
                " PSCrypt",
                " TeleBot",
                " TeleDoor",
                " xData",
                "BadRabbit"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "b3e954e8-8bbb-46f3-84de-d6f12dc7e1a6",
            "created_at": "2022-10-25T15:50:23.339976Z",
            "updated_at": "2025-03-27T02:00:55.446795Z",
            "deleted_at": null,
            "main_name": "Sandworm Team",
            "aliases": [
                "Sandworm Team",
                "ELECTRUM",
                "Telebots",
                "IRON VIKING",
                "BlackEnergy (Group)",
                "Quedagh",
                "Voodoo Bear",
                "IRIDIUM",
                "Seashell Blizzard",
                "FROZENBARENTS",
                "APT44"
            ],
            "source_name": "MITRE:Sandworm Team",
            "tools": [
                "Bad Rabbit",
                "Mimikatz",
                "Exaramel for Linux",
                "Exaramel for Windows",
                "GreyEnergy",
                "PsExec",
                "Prestige",
                "P.A.S. Webshell",
                "VPNFilter",
                "Cyclops Blink",
                "SDelete",
                "AcidRain",
                "Industroyer",
                "Industroyer2",
                "BlackEnergy",
                "Cobalt Strike",
                "NotPetya",
                "KillDisk",
                "PoshC2",
                "Impacket",
                "Invoke-PSImage",
                "Olympic Destroyer"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "3a0be4ff-9074-4efd-98e4-47c6a62b14ad",
            "created_at": "2022-10-25T16:07:23.590051Z",
            "updated_at": "2025-03-27T02:02:09.878211Z",
            "deleted_at": null,
            "main_name": "Energetic Bear",
            "aliases": [
                "ATK 6",
                "Blue Kraken",
                "Crouching Yeti",
                "Dragonfly",
                "Electrum",
                "Energetic Bear",
                "Ghost Blizzard",
                "Group 24",
                "ITG15",
                "Iron Liberty",
                "Koala Team",
                "TG-4192"
            ],
            "source_name": "ETDA:Energetic Bear",
            "tools": [
                "Backdoor.Oldrea",
                "CRASHOVERRIDE",
                "Commix",
                "CrackMapExec",
                "CrashOverride",
                "Dirsearch",
                "Dorshel",
                "Fertger",
                "Fuerboos",
                "Goodor",
                "Havex",
                "Havex RAT",
                "Hello EK",
                "Heriplor",
                "Impacket",
                "Industroyer",
                "Karagany",
                "Karagny",
                "LightsOut 2.0",
                "LightsOut EK",
                "Listrix",
                "Oldrea",
                "PEACEPIPE",
                "PHPMailer",
                "PsExec",
                "SMBTrap",
                "Subbrute",
                "Sublist3r",
                "Sysmain",
                "Trojan.Karagany",
                "WSO",
                "Webshell by Orb",
                "Win32/Industroyer",
                "Wpscan",
                "nmap",
                "sqlmap",
                "xFrost"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "6abcc917-035c-4e9b-a53f-eaee636749c3",
            "created_at": "2022-10-25T16:07:23.565337Z",
            "updated_at": "2025-03-27T02:02:09.868522Z",
            "deleted_at": null,
            "main_name": "Earth Lusca",
            "aliases": [
                "Bronze University",
                "Charcoal Typhoon",
                "Chromium",
                "Red Dev 10",
                "Red Scylla"
            ],
            "source_name": "ETDA:Earth Lusca",
            "tools": [
                "Agentemis",
                "AntSword",
                "BIOPASS",
                "BIOPASS RAT",
                "BadPotato",
                "Behinder",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "Doraemon",
                "FRP",
                "Fast Reverse Proxy",
                "FunnySwitch",
                "HUC Port Banner Scanner",
                "KTLVdoor",
                "Mimikatz",
                "NBTscan",
                "POISONPLUG.SHADOW",
                "PipeMon",
                "RbDoor",
                "RibDoor",
                "RouterGod",
                "SAMRID",
                "ShadowPad Winnti",
                "SprySOCKS",
                "WinRAR",
                "Winnti",
                "XShellGhost",
                "cobeacon",
                "fscan",
                "lcx",
                "nbtscan"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "8941e146-3e7f-4b4e-9b66-c2da052ee6df",
            "created_at": "2023-01-06T13:46:38.402513Z",
            "updated_at": "2025-03-27T02:00:02.824555Z",
            "deleted_at": null,
            "main_name": "Sandworm",
            "aliases": [
                "G0034",
                "IRIDIUM",
                "Blue Echidna",
                "FROZENBARENTS",
                "Seashell Blizzard",
                "IRON VIKING",
                "ELECTRUM",
                "TeleBots",
                "UAC-0113",
                "UAC-0082",
                "APT44",
                "Quedagh",
                "VOODOO BEAR",
                "TEMP.Noble"
            ],
            "source_name": "MISPGALAXY:Sandworm",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "d53593c3-2819-4af3-bf16-0c39edc64920",
            "created_at": "2022-10-27T08:27:13.212301Z",
            "updated_at": "2025-03-27T02:00:55.529662Z",
            "deleted_at": null,
            "main_name": "Earth Lusca",
            "aliases": [
                "Earth Lusca",
                "TAG-22",
                "Charcoal Typhoon",
                "CHROMIUM",
                "ControlX"
            ],
            "source_name": "MITRE:Earth Lusca",
            "tools": [
                "Mimikatz",
                "PowerSploit",
                "Tasklist",
                "certutil",
                "Cobalt Strike",
                "Winnti for Linux",
                "Nltest",
                "NBTscan",
                "ShadowPad"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1673536185,
    "ts_updated_at": 1743041735,
    "ts_creation_date": 1653767458,
    "ts_modification_date": 1653767458,
    "files": {
        "pdf": "https://archive.orkl.eu/4daefc2e00ccaebe925439d3864f69768aa871a8.pdf",
        "text": "https://archive.orkl.eu/4daefc2e00ccaebe925439d3864f69768aa871a8.txt",
        "img": "https://archive.orkl.eu/4daefc2e00ccaebe925439d3864f69768aa871a8.jpg"
    }
}