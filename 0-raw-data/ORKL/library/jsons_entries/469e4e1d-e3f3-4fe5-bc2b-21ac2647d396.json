{
    "id": "469e4e1d-e3f3-4fe5-bc2b-21ac2647d396",
    "created_at": "2023-01-12T14:59:15.924374Z",
    "updated_at": "2025-03-27T02:06:02.571364Z",
    "deleted_at": null,
    "sha1_hash": "595e0c503daec9b6229b5e6eb31787617fbe3d48",
    "title": "2017-09-25 - Additional information regarding the recent CCleaner APT security incident",
    "authors": "",
    "file_creation_date": "2022-05-28T21:55:10Z",
    "file_modification_date": "2022-05-28T21:55:10Z",
    "file_size": 377861,
    "plain_text": "# Additional information regarding the recent CCleaner APT security incident\n\n**[blog.avast.com/additional-information-regarding-the-recent-ccleaner-apt-security-incident](https://blog.avast.com/additional-information-regarding-the-recent-ccleaner-apt-security-incident)**\n\nNew analysis from the Avast Threat Labs\n\nWe would like to update our customers and the general public on the latest findings\nregarding the investigation of the recent CCleaner security incident. As published in our\n[previous blog posts (here and](https://blog.avast.com/progress-on-ccleaner-investigation) [here), analysis of the CnC server showed that the incident](https://blog.avast.com/avast-threat-labs-analysis-of-ccleaner-incident)\nwas in fact an Advanced Persistent Threat (APT) attack, targeting specific high-tech and\ntelecommunications companies. That is, despite the fact that CCleaner is a consumer\nproduct, the purpose of the attack was not to attack consumers and their data; instead, the\nCCleaner customers were used to gain access to corporate networks of select large\nenterprises.\n\nToday, we are going to disclose new facts about the incident that we received since the last\npublic update.\n\n## Introduction\n\nAs we already know, the CnC server contained important evidence in terms of the exact list\nof hosts with which the CnC server communicated, and the list of hosts to which it actually\nsent the 2nd stage payload (i.e. which actually became compromised in the sense that they\ncould execute malicious code sent by the attacker). The problem was that due to a crash of\n\n\n-----\n\nthe database, there were only about 3.5 days worth of data. Our hypothesis was that this\noccurred because of the server running out of disk space on September 10, leading the\noperator to a full rebuild of the database.\n\nHowever, further investigation revealed that the attackers backed up the data from the\ncrashed CnC server to another server before rebuilding the database. Thanks to the\ncontinued work of the Avast Threat Labs team and the help from US law enforcement\npersonnel. The server’s IP address was 216.126.225.163, it featured the same self-signed\nSSL certificate (issued for speccy.piriform.com) and stack-wise, had a typical “LAMP”\nconfiguration: CentOS release 6.9 with Apache 2.2.15, PHP 5.3.3, but most importantly, a\nMySql database that turned out to contain data going back to August 18. Access to this\nbackup server allowed us to assemble what we believe is the complete database (the only\nmissing piece is a 40-hour window between 2017-09-10 19:03:18 and 2017-09-12 9:58:47\nUTC, i.e. between the crash of the original CnC DB and the creation of the new one; it is not\nclear how the CnC server behaved in that period).\n\nThe main findings from the complete database are as follows:\n\nThe total number of connections to the CnC server was 5,686,677.\nThe total number of unique PCs (unique MAC addresses) that communicated with the\nCnC server was 1,646,536.\nThe total number of unique PCs that received the 2nd stage payload was 40.\n\n## PCs and Companies that received the 2nd stage payload\n\nThe most important piece of information is the content of the “OK” table in the database,\nwhich lists the machines that successfully received the 2nd stage payload and were\ntherefore really “infected” with potentially malicious code (although we haven’t been able to\nisolate that code yet, as it probably came from additional layers which are still the focus of\nadditional investigation).\n\nHere is the complete list of companies / domains affected, together with the number of\nimpacted PCs:\n\n\n-----\n\nWe have reached out to all these companies, with the aim of providing them with detailed\ninformation about the incident, list of impacted computers, and additional IOCs that can be\nused to detect the infection and take corrective actions.\n\nWorth noting is that about 40 PCs out of 2.27M had the compromised version of CCleaner\nproduct installed, i.e. 0.0018% of the total -- a truly targeted attack.\n\nThe list of companies (domains) evolved over time, and the detailed logs found on the SQL\ndatabase server suggest that the bad actors were trying to identify suitable hosts not just by\na pre-determined list, but also by looking into what kind of PC hosts have actually been\navailable to them in the sense that they had PCs with CCleaner connecting to the CnC.\nFollowing is a list of targets that were of potential interest, but were not attacked by the 2nd\nstage payload:\n\n\n-----\n\nClearly, the logs also indicate that the attackers were looking for additional high-profile\ncompanies to target, some of them potentially leading to additional supply-chain attacks\n(Carriers / ISPs, server hosting companies and domain registrars).\n\nInterestingly enough, the two corporations with the highest number of impacted PCs\n(cht.com.tw and nsl.ad.nec.co.jp) were actually missing in the list of targeted domains on the\nCnC server at the time it was taken down. This suggests that the attackers actively removed\nthese companies from the list after the payload had been delivered.\n\n## Origin of the attacker\n\nIn the previous post, we talked about the fact that there were multiple clues suggesting that\nthe attack may be originating from China, including multiple instances of PHP code found on\nthe CnC server, the myPhpAdmin logs, and the similarity of certain code snippets to a\nprevious APT attack attributed to China.\n\nThe problem with all these indications is that they are all very easy to forge: they might have\nbeen added simply to make investigation more difficult and to hide the true origin.\n\n\n-----\n\nSo, during our investigation, we tried to take a slightly different approach. We noticed that\nthere have been a relatively large number of operator connections to the CnC server; the\nserver apparently required a lot of manual maintenance work. In total, the operator\nconnected to the server 83 times (plus 17 more times to the backup server), to do various\nthings from installing and setting up the systems to monitoring it and resolving respective\nissues, such as to fix the crashed database. Which made us think that this was in fact\nsomeone’s ‘day job’. The hypothesis was further supported by the fact that there were many\nfewer connections to the server on Saturdays, and almost no connections on Sundays.\n\nNow, with that hypothesis in place, the obvious thing to do was to plot the operator\nconnections to the server in a chart and try to determine the time zone in which the attacker\nresided.\n\nThe result looked like this:\n\nThere is a clear pattern, which is in fact quite typical for IT workers: an 8-hour working day,\nfollowed by 4-5 hours of inactivity in the afternoon/evening and then additional connections\nduring a 5-hour block in the evenings.\n\nGiven the typical working day starts at 8AM or 9AM, this leads us to the most likely location\nof the attacker in the time zone UTC + 4 or UTC + 5, leading us to Russia or the eastern part\nof Middle East / Central Asia and India. Furthermore, given the clear lack of traffic on\n[Saturdays and Sundays, it would indicate that it wasn’t an Arabic country.](https://en.wikipedia.org/wiki/Workweek_and_weekend)\n\n\n-----\n\nAnother possible explanation is that there were multiple people involved in the operation,\neach working from a different time zone.\n\nIt is worth noting that, despite there being a large number of tech / telco companies in China,\nRussia and India, there are no companies from these countries on the list of companies\ntargeted by this attack.\n\n## Investigation process and next steps\n\nWe are continuing our investigation of the incident: working with law enforcement, partner\ncompanies and a professional firm specializing in incident response operations to move\nquickly in the right direction. Our security team has reached out to all companies proven to\nbe part of the 2nd stage, and we’re committed to working with them to resolve the issue fully.\nObviously, the fact that the 2nd stage payload has been delivered to a computer connected\nto a company network doesn’t mean that the company network has been compromised.\nHowever, proper investigation is in order and necessary to fully understand the impact and\ntake remediation actions. From our side, we continue working on getting access and\nanalyzing the additional stages of the payload (post stage 2). We will post an update as soon\nas we learn more.\n\n## IOCs\n\nThe following is an updated list of IOCs.\n\n**Files**\n\n\n-----\n\n**1st stage**\n\n04bed8e35483d50a25ad8cf203e6f157e0f2fe39a762f5fbacd672a3495d6a11 - CCleaner installer (v5.33.0.6162)\n\n0564718b3778d91efd7a9972e11852e29f88103a10cb8862c285b924bc412013 - CCleaner installer (v5.33.0.6162)\n\n1a4a5123d7b2c534cb3e3168f7032cf9ebf38b9a2a97226d0fdb7933cf6030ff - CCleaner installer (v5.33.0.6162)\n\n276936c38bd8ae2f26aab14abff115ea04f33f262a04609d77b0874965ef7012 - CCleaner installer (v5.33.0.6162)\n\n2fe8cfeeb601f779209925f83c6248fb4f3bfb3113ac43a3b2633ec9494dcee0 - CCleaner installer (v5.33.0.6162)\n\n3c0bc541ec149e29afb24720abc4916906f6a0fa89a83f5cb23aed8f7f1146c3 - CCleaner installer (v5.33.0.6162)\n\n4f8f49e4fc71142036f5788219595308266f06a6a737ac942048b15d8880364a - CCleaner installer (v5.33.0.6162)\n\n7bc0eaf33627b1a9e4ff9f6dd1fa9ca655a98363b69441efd3d4ed503317804d - CCleaner installer (v5.33.0.6162)\n\na013538e96cd5d71dd5642d7fdce053bb63d3134962e2305f47ce4932a0e54af - CCleaner installer (v5.33.0.6162)\n\nbd1c9d48c3d8a199a33d0b11795ff7346edf9d0305a666caa5323d7f43bdcfe9 - CCleaner installer (v5.33.0.6162)\n\nc92acb88d618c55e865ab29caafb991e0a131a676773ef2da71dc03cc6b8953e - CCleaner installer (v5.33.0.6162)\n\ne338c420d9edc219b45a81fe0ccf077ef8d62a4ba8330a327c183e4069954ce1 - CCleaner installer (v5.33.0.6162)\n\n36b36ee9515e0a60629d2c722b006b33e543dce1c8c2611053e0651a0bfdb2e9 CCleaner.exe (32-bit v5.33.0.6162)\n\n6f7840c77f99049d788155c1351e1560b62b8ad18ad0e9adda8218b9f432f0a9 CCleaner.exe (32-bit v5.33.0.6162)\n\na3e619cd619ab8e557c7d1c18fc7ea56ec3dfd13889e3a9919345b78336efdb2 CCleanerCloud - installer (32-bit v1.7.0.3191)\n\n\n-----\n\n0d4f12f4790d2dfef2d6f3b3be74062aad3214cb619071306e98a813a334d7b8 CCleanerCloudAgent.exe (32-bit v1.7.0.3191)\n\n9c205ec7da1ff84d5aa0a96a0a77b092239c2bb94bcb05db41680a9a718a01eb CCleanerCloudAgentHealtCheck.exe (32-bit v1.7.0.3191)\n\nbea487b2b0370189677850a9d3f41ba308d0dbd2504ced1e8957308c43ae4913 CCleanerCloudTray.exe (32-bit v1.7.0.3191)\n\n3a34207ba2368e41c051a9c075465b1966118058f9b8cdedd80c19ef1b5709fe - 1st stage\npayload DLL found in CCleaner\n\n19865df98aba6838dcc192fbb85e5e0d705ade04a371f2ac4853460456a02ee3 - 1st stage\npayload DLL found in CCleanerCloud\n\n**2nd stage**\n\ndc9b5e8aa6ec86db8af0a7aa897ca61db3e5f3d2e0942e319074db1aaccfdc83 - 2nd stage\npayload DLL (GeeSetup_x86.dll)\na414815b5898ee1aa67e5b2487a11c11378948fcd3c099198e0f9c6203120b15 - loader of the\n2nd stage payload (64-bit)\n7ac3c87e27b16f85618da876926b3b23151975af569c2c5e4b0ee13619ab2538 - loader of\nthe 2nd stage payload (32-bit)\n4ae8f4b41dcc5e8e931c432aa603eae3b39e9df36bf71c767edb630406566b17 - inner DLL of\nthe 2nd stage payload (64-bit)\nb3badc7f2b89fe08fdee9b1ea78b3906c89338ed5f4033f21f7406e60b98709e - inner DLL of\nthe 2nd stage payload (32-bit)\na6c36335e764b5aae0e56a79f5d438ca5c42421cae49672b79dbd111f884ecb5 - inner DLL of\nthe 2nd stage payload (32-bit)\n\n**CnC**\n\n**IPs**\n\n216.126.225.148 - CnC of the 1st stage payload\n\n216.126.225.163 - backup server of CnC 216.126.225.148\n\n**URLs (all used for obtaining IP address of the 2nd stage CnC)**\n\nget.adoble[.]com\n\nhttps://github[.]com/search?q=joinlur&type=Users&u=✓\n\nhttps://en.search.wordpress[.]com/?src=organic&q=keepost\n\n**DGA (used by the 1st stage payload)**\n\n\n-----\n\nab8cee60c2d.com  - valid for 2017-08\n\nab1145b758c30.com - valid for 2017-09\n\nab890e964c34.com - valid for 2017-10\n\nab3d685a0c37.com - valid for 2017-11\n\nab70a139cc3a.com - valid for 2017-12\n\nab3c2b0d28ba6.com - valid for 2018-01\n\nab99c24c0ba9.com - valid for 2018-02\n\nab2e1b782bad.com - valid for 2018-03\n\nab253af862bb0.com - valid for 2018-04\n\nab2d02b02bb3.com - valid for 2018-05\n\nab1b0eaa24bb6.com - valid for 2018-06\n\nabf09fc5abba.com - valid for 2018-07\n\nabce85a51bbd.com - valid for 2018-08\n\nabccc097dbc0.com - valid for 2018-09\n\nab33b8aa69bc4.com - valid for 2018-10\n\nab693f4c0bc7.com - valid for 2018-11\n\nab23660730bca.com - valid for 2018-12\n\n**Windows Registry**\n\nHKLM\\SOFTWARE\\Piriform\\Agomo\\MUID - used by the 1st stage payload\n\nHKLM\\SOFTWARE\\Piriform\\Agomo\\NID - used by the 1st stage payload\n\nHKLM\\SOFTWARE\\Piriform\\Agomo\\TCID - used by the 1st stage payload\n\nHKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\WbemPerf\\HBP - used by the\n2nd stage payload\n\nHKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\WbemPerf\\001 - used by the 2nd\nstage payload\n\n\n-----\n\nHKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\WbemPerf\\002 - used by the 2nd\nstage payload\n\nHKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\WbemPerf\\003 - used by the 2nd\nstage payload\n\nHKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\WbemPerf\\004 - used by the 2nd\nstage payload\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2017/2017-09-25 - Additional information regarding the recent CCleaner APT security incident.pdf"
    ],
    "report_names": [
        "2017-09-25 - Additional information regarding the recent CCleaner APT security incident.pdf"
    ],
    "threat_actors": [
        {
            "id": "bfded1cf-be73-44f9-a391-0751c9996f9a",
            "created_at": "2022-10-25T15:50:23.337107Z",
            "updated_at": "2025-03-27T02:00:55.445946Z",
            "deleted_at": null,
            "main_name": "FIN7",
            "aliases": [
                "FIN7",
                "GOLD NIAGARA",
                "ITG14",
                "Carbon Spider",
                "ELBRUS",
                "Sangria Tempest"
            ],
            "source_name": "MITRE:FIN7",
            "tools": [
                "Mimikatz",
                "AdFind",
                "JSS Loader",
                "HALFBAKED",
                "REvil",
                "PowerSploit",
                "CrackMapExec",
                "Carbanak",
                "Pillowmint",
                "Cobalt Strike",
                "POWERSOURCE",
                "RDFSNIFFER",
                "SQLRat",
                "Lizar",
                "TEXTMATE",
                "BOOSTWRITE"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "bb8702c5-52ac-4359-8409-998a7cc3eeaf",
            "created_at": "2023-01-06T13:46:38.405479Z",
            "updated_at": "2025-03-27T02:00:02.82533Z",
            "deleted_at": null,
            "main_name": "FIN7",
            "aliases": [
                "JokerStash",
                "ATK32",
                "G0046",
                "Coreid",
                "Carbanak",
                "Sangria Tempest",
                "CARBON SPIDER",
                "GOLD NIAGARA",
                "G0008",
                "ELBRUS",
                "Carbon Spider"
            ],
            "source_name": "MISPGALAXY:FIN7",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "d85adfe3-e1c3-40b0-b8bb-d1bacadc4d82",
            "created_at": "2022-10-25T16:07:23.619566Z",
            "updated_at": "2025-03-27T02:02:09.890982Z",
            "deleted_at": null,
            "main_name": "FIN7",
            "aliases": [
                "APT-C-11",
                "ATK 32",
                "Gold Niagara",
                "ITG14",
                "TAG-CR1"
            ],
            "source_name": "ETDA:FIN7",
            "tools": [
                "7Logger",
                "Agentemis",
                "Anunak",
                "Astra",
                "BIOLOAD",
                "BIRDWATCH",
                "Bateleur",
                "Boostwrite",
                "CROWVIEW",
                "Carbanak",
                "Cobalt Strike",
                "CobaltStrike",
                "DICELOADER",
                "DNSMessenger",
                "FOWLGAZE",
                "HALFBAKED",
                "JSSLoader",
                "KillACK",
                "LOADOUT",
                "Lizar",
                "Meterpreter",
                "Mimikatz",
                "POWERPLANT",
                "POWERSOURCE",
                "RDFSNIFFER",
                "SQLRAT",
                "Sekur",
                "Sekur RAT",
                "TEXTMATE",
                "Tirion",
                "VB Flash",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535555,
    "ts_updated_at": 1743041162,
    "ts_creation_date": 1653774910,
    "ts_modification_date": 1653774910,
    "files": {
        "pdf": "https://archive.orkl.eu/595e0c503daec9b6229b5e6eb31787617fbe3d48.pdf",
        "text": "https://archive.orkl.eu/595e0c503daec9b6229b5e6eb31787617fbe3d48.txt",
        "img": "https://archive.orkl.eu/595e0c503daec9b6229b5e6eb31787617fbe3d48.jpg"
    }
}