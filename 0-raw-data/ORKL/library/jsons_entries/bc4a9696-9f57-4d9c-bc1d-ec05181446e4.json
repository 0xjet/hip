{
    "id": "bc4a9696-9f57-4d9c-bc1d-ec05181446e4",
    "created_at": "2022-10-25T16:48:19.510161Z",
    "updated_at": "2025-03-27T02:16:16.950539Z",
    "deleted_at": null,
    "sha1_hash": "cb3f46cb9def5b9bc1185e5fd60d390f77dc3834",
    "title": "",
    "authors": "",
    "file_creation_date": "2019-11-01T03:47:13Z",
    "file_modification_date": "2019-11-01T03:47:13Z",
    "file_size": 222214,
    "plain_text": "# MESSAGETAP: Who’s Reading Your Text Messages?\n\n**[fireeye.com/blog/threat-research/2019/10/messagetap-who-is-reading-your-text-messages.html](https://www.fireeye.com/blog/threat-research/2019/10/messagetap-who-is-reading-your-text-messages.html)**\n\nFireEye Mandiant recently discovered a new malware family used by APT41 (a Chinese APT\ngroup) that is designed to monitor and save SMS traffic from specific phone numbers, IMSI\nnumbers and keywords for subsequent theft. Named MESSAGETAP, the tool was deployed by\nAPT41 in a telecommunications network provider in support of Chinese espionage efforts.\nAPT41’s operations have included state-sponsored cyber espionage missions as well as\nfinancially-motivated intrusions. These operations have spanned from as early as 2012 to the\n[present day. For an overview of APT41, see our August 2019 blog post or our full published](https://www.fireeye.com/blog/threat-research/2019/08/apt41-dual-espionage-and-cyber-crime-operation.html)\n[report. MESSAGETAP was first reported to FireEye Threat Intelligence subscribers in August](https://www.fireeye.com/solutions/cyber-threat-intelligence/threat-intelligence-subscriptions.html)\n2019 and initially discussed publicly in an APT41 presentation at FireEye Cyber Defense Summit\n2019.\n\n## MESSAGETAP Overview\n\nAPT41's newest espionage tool, MESSAGETAP, was discovered during a 2019 investigation at a\ntelecommunications network provider within a cluster of Linux servers. Specifically, these Linux\nservers operated as Short Message Service Center (SMSC) servers. In mobile networks, SMSCs\nare responsible for routing Short Message Service (SMS) messages to an intended recipient or\nstoring them until the recipient has come online. With this background, let's dig more into the\nmalware itself.\n\nMESSAGETAP is a 64-bit ELF data miner initially loaded by an installation script. Once installed,\nthe malware checks for the existence of two files: keyword_parm.txt and parm.txt and attempts to\nread the configuration files every 30 seconds. If either exist, the contents are read and XOR\ndecoded with the string:\n\nhttp://www.etsi.org/deliver/etsi_ts/123000_123099/123040/04.02.00_60/ts_123040v040200p.pdf\n\nInterestingly, this XOR key leads to a URL owned by the European\nTelecommunications Standards Institute (ETSI). The document explains the Short\nMessage Service (SMS) for GSM and UMTS Networks. It describes architecture as\nwell as requirements and protocols for SMS.\n\nThese two files, keyword_parm.txt and parm.txt contain instructions for MESSAGETAP to target\nand save contents of SMS messages.\n\nThe first file (parm.txt) is a file containing two lists:\n\n_imsiMap: This list contains International Mobile Subscriber Identity (IMSI) numbers._\nIMSI numbers identify subscribers on a cellular network.\n_phoneMap: The phoneMap list contains phone numbers._\nThe second file (keyword_parm.txt) is a list of keywords that is read into keywordVec.\n\n\n-----\n\nBoth files are deleted from disk once the configuration files are read and loaded into memory.\nAfter loading the keyword and phone data files, MESSAGETAP begins monitoring all network\nconnections to and from the server. It uses the libpcap library to listen to all traffic and parses\nnetwork protocols starting with Ethernet and IP layers. It continues parsing protocol layers\nincluding SCTP, SCCP, and TCAP. Finally, the malware parses and extracts SMS message data\nfrom the network traffic:\n\n1. SMS message contents\n2. The IMSI number\n3. The source and destination phone numbers\n\nThe malware searches the SMS message contents for keywords from the keywordVec list,\ncompares the IMSI number with numbers from the imsiMap list, and checks the extracted phone\nnumbers with the numbers in the phoneMap list.\n\nFigure 1: General Overview Diagram of MESSAGETAP\n\nIf the SMS message text contains one of the keywordVec values, the contents are XORed and\nsaved to a path with the following format:\n\n/etc/<redacted>/kw_<year><month><day>.csv\n\n\n-----\n\nThe malware compares the IMSI number and phone numbers with the values from the imsiMap\nand phoneMap lists. If found, the malware XORs the contents and stores the data in a path with\nthe following format:\n\n/etc/<redacted>/<year><month><day>.csv\n\nIf the malware fails to parse a message correctly, it dumps it to the following location:\n\n/etc/<redacted>/<year><month><day>_<count>.dump\n\n**Significance of Input Files**\n\nThe configuration files provide context into the targets of this information gathering and monitoring\ncampaign. The data in keyword_parm.txt contained terms of geopolitical interest to Chinese\nintelligence collection. The two lists phoneMap and imsiMap from parm.txt contained a high\nvolume of phone numbers and IMSI numbers.\n\n[For a quick review, IMSI numbers are used in both GSM (Global System for Mobiles) and UMTS](https://csrc.nist.gov/glossary/term/International-Mobile-Subscriber-Identity)\n(Universal Mobile Telecommunications System) mobile phone networks and consists of three\nparts:\n\n1. Mobile Country Code (MCC)\n2. Mobile Network Code (MNC)\n3. Mobile Station Identification Number (MSIN)\n\nThe Mobile Country Code corresponds to the subscriber’s country, the Mobile Network Code\ncorresponds to the specific provider and the Mobile Station Identification Number is uniquely tied\nto a specific subscriber.\n\nFigure 2: IMSI number description\n\nThe inclusion of both phone and IMSI numbers show the highly targeted nature of this cyber\nintrusion. If an SMS message contained either a phone number or an IMSI number that matched\nthe predefined list, it was saved to a CSV file for later theft by the threat actor.\n\nSimilarly, the keyword list contained items of geopolitical interest for Chinese intelligence\ncollection. Sanitized examples include the names of political leaders, military and intelligence\norganizations and political movements at odds with the Chinese government. If any SMS\n\n\n-----\n\nmessages contained these keywords, MESSAGETAP would save the SMS message to a CSV\nfile for later theft by the threat actor.\n\nIn addition to MESSAGETAP SMS theft, FireEye Mandiant also identified the threat actor\ninteracting with call detail record (CDR) databases to query, save and steal records during this\nsame intrusion. The CDR records corresponded to foreign high-ranking individuals of interest to\nthe Chinese intelligence services. Targeting CDR information provides a high-level overview of\nphone calls between individuals, including time, duration, and phone numbers. In contrast,\nMESSAGETAP captures the contents of specific text messages.\n\n## Looking Ahead\n\nThe use of MESSAGETAP and targeting of sensitive text messages and call detail records at\nscale is representative of the evolving nature of Chinese cyber espionage campaigns observed\nby FireEye. APT41 and multiple other threat groups attributed to Chinese state-sponsored actors\nhave increased their targeting of upstream data entities since 2017. These organizations, located\nmultiple layers above end-users, occupy critical information junctures in which data from\nmultitudes of sources converge into single or concentrated nodes. Strategic access into these\norganizations, such as telecommunication providers, enables the Chinese intelligence services an\nability to obtain sensitive data at scale for a wide range of priority intelligence requirements.\n\nIn 2019, FireEye observed four telecommunication organizations targeted by APT41 actors.\nFurther, four additional telecommunications entities were targeted in 2019 by separate threat\ngroups with suspected Chinese state-sponsored associations. Beyond telecommunication\norganizations, other client verticals that possess sensitive records related to specific individuals of\ninterest, such as major travel services and healthcare providers, were also targeted by APT41.\nThis is reflective of an evolving Chinese targeting trend focused on both upstream data and\ntargeted surveillance. For deeper analysis regarding recent Chinese cyber espionage targeting\ntrends, customers may refer to the FireEye Threat Intelligence Portal. This topic was also briefed\nat FireEye Cyber Defense Summit 2019.\n\nFireEye assesses this trend will continue in the future. Accordingly, both users and organizations\nmust consider the risk of unencrypted data being intercepted several layers upstream in their\ncellular communication chain. This is especially critical for highly targeted individuals such as\ndissidents, journalists and officials that handle highly sensitive information. Appropriate\nsafeguards such as utilizing a communication program that enforces end-to-end encryption can\nmitigate a degree of this risk. Additionally, user education must impart the risks of transmitting\nsensitive data over SMS. More broadly, the threat to organizations that operate at critical\ninformation junctures will only increase as the incentives for determined nation-state actors to\nobtain data that directly support key geopolitical interests remains.\n\n## FireEye Detections\n\nFE_APT_Controller_SH_MESSAGETAP_1\nFE_APT_Trojan_Linux64_MESSAGETAP_1\nFE_APT_Trojan_Linux_MESSAGETAP_1\nFE_APT_Trojan_Linux_MESSAGETAP_2\nFE_APT_Trojan_Linux_MESSAGETAP_3\n\n\n-----\n\n**File name: mtlserver**\n**MD5 hash: 8D3B3D5B68A1D08485773D70C186D877**\n\n*This sample was identified by FireEye on VirusTotal and provides an example for readers to\nreference. The file is a less robust version than instances of MESSAGETAP identified in\nintrusions and may represent an earlier test of the malware. The file and any of its embedded\ndata were not observed in any Mandiant Consulting engagement*\n\n## References\n\n Acknowledgements\n\nThank you to Adrian Pisarczyk, Matias Bevilacqua and Marcin Siedlarz for identification and\nanalysis of MESSAGETAP at a FireEye Mandiant Consulting engagement.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        }
    ],
    "references": [
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2019/2019.10.31.MESSAGETAP/MESSAGETAP_%20Who%E2%80%99s%20Reading%20Your%20Text%20Messages.pdf"
    ],
    "report_names": [
        "MESSAGETAP_ Who’s Reading Your Text Messages"
    ],
    "threat_actors": [
        {
            "id": "4c68ccd0-caba-4189-9ead-86ac4c2d9b70",
            "created_at": "2024-05-01T02:03:07.930196Z",
            "updated_at": "2025-03-27T02:05:17.251237Z",
            "deleted_at": null,
            "main_name": "BRONZE ATLAS",
            "aliases": [
                "Axiom",
                "BARIUM ",
                "Blackfly ",
                "CTG-2633",
                "GREF",
                "Group 72 ",
                "Red Kelpie ",
                "TG-2633 ",
                "Wicked Panda ",
                "Winnti",
                "APT41 "
            ],
            "source_name": "Secureworks:BRONZE ATLAS",
            "tools": [
                " CCleaner v5.33 backdoor",
                " ChinaChopper",
                " Cobalt Strike",
                " Dicey MSDN",
                " ForkPlayground",
                " HUC Proxy Malware (Htran)",
                " Mimikatz",
                " PipeMon",
                " PlugX",
                " PortReuse",
                " Powershell Empire",
                " RCMD",
                " RbDoor",
                " SPEEDBOAT",
                " ShadowPad",
                " Sidewalk",
                " Speculoos",
                " TeamViewer",
                " Winnkit",
                " Winnti",
                " reg save",
                " vssadmin",
                "Acehash"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "4d5f939b-aea9-4a0e-8bff-003079a261ea",
            "created_at": "2023-01-06T13:46:39.04841Z",
            "updated_at": "2025-03-27T02:00:02.985296Z",
            "deleted_at": null,
            "main_name": "APT41",
            "aliases": [
                "G0096",
                "Grayfly",
                "BARIUM",
                "BRONZE ATLAS",
                "BRONZE EXPORT",
                "Red Kelpie",
                "HOODOO",
                "Brass Typhoon",
                "TA415",
                "WICKED SPIDER",
                "WICKED PANDA",
                "G0044",
                "Earth Baku"
            ],
            "source_name": "MISPGALAXY:APT41",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "e698860d-57e8-4780-b7c3-41e5a8314ec0",
            "created_at": "2022-10-25T15:50:23.287929Z",
            "updated_at": "2025-03-27T02:00:55.43005Z",
            "deleted_at": null,
            "main_name": "APT41",
            "aliases": [
                "APT41",
                "Wicked Panda",
                "Brass Typhoon",
                "BARIUM"
            ],
            "source_name": "MITRE:APT41",
            "tools": [
                "ASPXSpy",
                "BITSAdmin",
                "PlugX",
                "Impacket",
                "gh0st RAT",
                "netstat",
                "PowerSploit",
                "ZxShell",
                "KEYPLUG",
                "ipconfig",
                "sqlmap",
                "China Chopper",
                "ShadowPad",
                "MESSAGETAP",
                "Mimikatz",
                "certutil",
                "njRAT",
                "Cobalt Strike",
                "pwdump",
                "BLACKCOFFEE",
                "ROCKBOOT",
                "dsquery",
                "Winnti for Linux",
                "DUSTTRAP",
                "Derusbi",
                "ftp"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1666716499,
    "ts_updated_at": 1743041776,
    "ts_creation_date": 1572580033,
    "ts_modification_date": 1572580033,
    "files": {
        "pdf": "https://archive.orkl.eu/cb3f46cb9def5b9bc1185e5fd60d390f77dc3834.pdf",
        "text": "https://archive.orkl.eu/cb3f46cb9def5b9bc1185e5fd60d390f77dc3834.txt",
        "img": "https://archive.orkl.eu/cb3f46cb9def5b9bc1185e5fd60d390f77dc3834.jpg"
    }
}