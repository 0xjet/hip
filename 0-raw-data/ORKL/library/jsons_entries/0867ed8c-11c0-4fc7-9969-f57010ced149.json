{
    "id": "0867ed8c-11c0-4fc7-9969-f57010ced149",
    "created_at": "2022-10-25T16:48:16.195787Z",
    "updated_at": "2025-03-27T02:09:07.293366Z",
    "deleted_at": null,
    "sha1_hash": "538701feeead706e34d24cf2b831071ac2f600cb",
    "title": "Operation Oil Tanker: The Phantom Menace",
    "authors": "Pandalabs",
    "file_creation_date": "2015-05-08T12:08:13Z",
    "file_modification_date": "2015-05-08T12:09:20Z",
    "file_size": 2295790,
    "plain_text": "# Operation “Oil Tanker”\n\n## The Phantom Menace\n\n\n-----\n\n### Operation Oil Tanker: The Phantom Menace.\n\nEverything started on a cold January day in a\ncoastal town in the North East of England, an\narea with a strong presence of petrochemical\ncompanies.\n\nThe day began normally in one of these\ncompanies, a firm specializing in, among other\nthings, maritime oil transportation. Let’s call this\ncompany “Black Gold”.\n\nJohn, the head of Black Gold’s IT Department\nknows that we live in a dangerous world, and that\ncompanies face thousands of cyber-attacks every\nday. And although Black Gold is not included\nin the Fortune 1000 company list, John knew\nthat taking all possible safety precautions is a\nmust and that, in addition to having a corporate\nantivirus, they must maximize all other security\nmeasures.\n\nThat’s why when given the opportunity to take\npart in a pilot program involving a new service that\nmonitors all applications running on endpoints,\nreporting the security status of the network and\nproviding forensic information in the event of\ninfections, he didn’t think twice. After completing a\nseries of controlled tests, John decided to deploy\nthe small agent across the company’s network\nOctober 2013.\n\nThe information he received during the first three\nmonths helped to identify computers at risk where\nvulnerable applications were found. Apart from\nthat, nothing worth mentioning really happened.\n\n\n### Thanks to John, Black Gold joined a high IT security pilot program.\n\n\n-----\n\nOne day, however, while Susan, a secretary with\nmore than 20 years of experience at Black Gold,\nwas checking her email as she did every Monday\nmorning, she came across an email message with\nan attached document.\n\nThe document appeared to be a PDF file of\napproximately 4MB in size, with information about\nthe oil market. Nothing suspicious. Besides, the\nmessage in question had gone through every\nsecurity filter in place. Neither the mail server\nantivirus nor the antivirus on her workstation had\nfound anything anomalous in it.\n\nSusan double-clicked the attachment. A blank\nPDF opened. “This must be a mistake. I hope they\nrealize it and send us the correct file again,” Susan\nthought, moving on to the next unread message.\n\nMeanwhile, 1,700 km away from Susan’s computer,\nan alarm was triggered. An unknown threat had\njust been detected and blocked when it tried to\nsteal credentials from Susan’s computer and send\nthem out.\n\nToday, most computer threats are designed to\nsteal information from target systems, so this\njust looked like thousands of cases we examine\nin the laboratory every day. However, it caught\nour attention that no antivirus engine had been\nable to detect it, although this shouldn’t be so\nsurprising if you take into consideration that every\nday over 250,000 new malware files are put in\ncirculation. There was something really unique\nabout this threat: it didn’t use any kind of malware.\nThat’s why we decided to call it the ‘Phantom\nMenace’.\n\n\n### Susan just clicked twice, and the ‘Phantom Menace’ was triggered.\n\n\n-----\n\n### Attack analysis\n\nThe file that Susan received and opened looked like this.\n\nIt actually was an executable file that used the icon typically used by Adobe Acrobat Reader documents\nto trick users.\n\nThe figure below illustrates the execution flow:\n\npic.pdf sai.vbsici.bat\nstat.vbs deca.bat cogi.regaagi.bat\ndeca.bat iei.batiewi.bat\ndcp.exe dcp.exe di.vbskeeprun.ini\nunzip2.exe ******secret unzip.exe mdei.abcimage.abcimages.abc\nbare.zip bar.zip picture viewer.abc\n\nThe file is just a self-extracting file. Once run, it creates a folder and extracts six files into it. It then runs\none of them –stat.vbs– and does not take any more actions.\n\nThere is no malicious activity, so the file goes unnoticed by behavior-based detectors. The stat.vbs file\nsimply runs another file –deca.bat– in the background.\n\nThis file in turn opens the pic.pdf file (the blank PDF document that opened on Susan’s computer) and runs\na file called dcp.exe, a free tool to encrypt files.\n\nThis utility is used to decrypt the following two files:\n\nNext, it uses the unzip.exe program to extract the content of the bare.zip file (12 files) into a different\nfolder. Then, it runs one of the files: sai.vbs.\n\n\n-----\n\nNone of these actions are anomalous, and actually are very different from what we normally see in other\ntypes of attacks. Here is where the second part of the attack begins:\n\n0x01209900 (???) aagi.bat\n\n0x00000004 (4)\n\nsai.vbs ici.bat 0x00000001 (1)\n\nici.bat 0x00020000 (131072)\n\ncogi.reg\n\naagi.bat .abc     .exe\n\nimage.abc image.exe\n\nimages.abc images.exe\n\npicture viewer.abc picture viewer.exe\n\nmdei.abc mdei.exe\n\nKeepRunning keeprun.ini\n\nkeeprun.ini\n\niei.bat iei.bat\n\ndi.vbs di.vbs\n\niewi.bat iewi.bat\n\nattrib\n\noff\n\nrename PIC_%d_%t\n\nFTP\n\nThe .vbs file runs a .bat file that modifies the Windows registry to ensure that a file called aagi.bat is run\nevery time the system starts. Then, it makes a copy of the four files with the extension .abc, and changes\ntheir extension to .exe. These are all legitimate applications that anybody could use: the first three are\ndesigned to collect the credentials (user names and passwords) stored in the local mail client and Internet\nbrowser, and save them to a text file.\n\nThe fourth one is an application designed to run another application every ‘x’ seconds. This is very useful\nfor computers that need to run an application at all times, like a browser or any other specific software, so\nthat if the application closes unexpectedly for some reason it will open again. In this case the application\nis configured to run another .bat file every 3,600 seconds (every hour).\n\nThen, the ici.bat file uses the ATTRIB system command to hide the two folders it created, disables the\nWindows firewall, and renames the text files containing the credentials to PIC_%d_%t, where %d is the\ncurrent date and %t the current time. This is done to indicate when the information they contain was\nobtained.\n\nFinally, it uses the FTP command to upload those files to an external FTP server controlled by the\nattackers.\n\n\n-----\n\nAdditionally, it runs the file iei.bat every hour, which basically takes the following actions:\n\n.abc .exe\n\n\niewi.bat\n\n\n0x01209900 (???)\n0x00000004 (4)\n0x00020000 (131072)\n\nimage.exe\nimages.exe\npicture viewer.exe\n\nPIC_%d_%t\n\n\nIt renames the .abc files back to .exe, in case they were deleted. It then deletes all the text files with\ncredentials that were already uploaded to the FTP server, restores the Windows registry key in case it was\ndeleted, runs the applications designed to collect credentials, renames the resulting files and uploads\nthem to the FTP server.\n\nAs you can see, no malware is ever used in the attack, the hack makes use of legitimate tools and\ndifferent scripts to perform the aforementioned actions.\n\nBut, is this type of attack really effective? As mentioned before, no antivirus was capable of detecting\nit. Furthermore, its peculiarities seem to indicate that the proactive protection layers included in most\nantivirus solutions would not be able to detect its apparently harmless behavior.\n\nThis was confirmed when we accessed the FTP server that the stolen data was sent to, and found that\nthe oldest files dated back to August 2013. That is, the attack had been underway for almost six months\ncompletely undetected.\n\n\n-----\n\n### A targeted attack?\n\nOnce we accessed the FTP server, the first thing\nwe did was look for credentials belonging to Black\nGold, since, despite being able to neutralize the\nattack on Susan’s computer, another employee\ncould have fallen victim to it. The result was\nnegative, no credentials had been stolen from the\ncompany.\n\nHowever, we were surprised by the large number\nof files stored on the FTP server: over 80,000\ntext files with stolen credentials from other firms.\n**This didn’t look like a targeted attack, where the**\nnumber of victims is usually low.\n\nHowever, after opening three files at random,\nwe found that they belonged to three companies\nall in the same industrial sector that Black Gold\nbelongs to.\n\nAs mentioned in the previous section, the attack\ntook place recurrently every hour. This means that\nstolen credentials were sent to the FTP server\nevery hour. We discarded duplicate files and ended\nup with 860 unique files.\n\nThat was still too many files for a targeted attack.\nThe only thing left to do was manually process all\nthese files and try to identify the victims.\n\nThe files belonged to some ten companies, all of\nthem in the oil and gas maritime transportation\nsector.\n\n**It was clear that the hack was indeed a targeted**\n**attack, but we still didn’t know what the attackers**\nwere really after, what their final objective was.\n\n\n### What didn’t seem a targeted attack at first, ended being a whole conspiratorial plot against the sector.\n\n\n-----\n\n### Nigeria, scams and oil\n\nThe so-called Nigerian scams have been a\nconstant presence on the Internet since its\ninception, and even before that, when fraudsters\nused postal mail to defraud victims.\n\nIn the most popular one, the scammer passes\nthemselves off as an important figure in the\nNigerian government or some other institution,\nand contacts the victim offering them a share in a\nlarge sum of money that they want to transfer out\nof the country.\n\nHowever, the Nigerian scam industry is large\nand varied. Some variants are almost unknown\nand affect all kinds of sectors, including the oil\nindustry.\n\nThe Nigerian town of Bonny is well-known in oil\nproduction circles as the oil produced there, known\nas Bonny Light Crude Oil (BLCO), has a very low\nsulfur content, which makes it a highly desired\ngrade for its low corrosiveness.\n\nThe fact that this particular type of oil is in such\nhigh demand has given rise to a particular type of\nscam aimed at oil brokers, individuals who arrange\ntransactions involving crude oil between buyers\nand sellers.\n\nIn Nigeria, every gas and oil transaction is\nsupervised by the NNPC (Nigerian National\nPetroleum Corporation), a government-owned\ncompany. Anybody who wants to trade with oil in\nNigeria must be registered with the NNPC.\n\n**In short, the scam works like this: the scammer**\ncontacts a broker/middleman and offers them a\nlarge amount of BLCO, one to two million barrels,\nat a very competitive price.\n\n\nIf the potential buyer is interested, they will ask\nfor documentary evidence that the product\nexists (Proof of Product). There are different\ntypes of documents that can be provided: a\nquality certificate, a certificate of origin, a cargo\nmanifest, or the letter of ATS (Authority to Sell)\nissued by the NNPC.\n\nTo close the deal, the buyer must pay a significant\namount of money -from $50,000 to $100,000- in\nadvance. However, once they pay the money they\nare met with the nasty surprise that there is no oil.\n\nThe weakest link in the scam is the documentation\nthat the scammer must provide to convince the\nbuyer. Even though all of these documents can\nbe forged, the fraudster runs the risk of being\ndiscovered by the broker.\n\nTo make it more plausible, scammers attempt to\nuse real documents so that if the broker wishes to\ncheck their legitimacy, they will see that they are\nreal.\n\nHowever, how difficult is it to obtain these\ndocuments? It is very complicated. The only\nway to do it is from companies in the sector. Oil\ntransportation companies, for example. This was\njust a theory, at that time we didn’t have any\nevidence to prove that that was the objective\nof those responsible for the ‘Phantom Menace’\nattack.\n\n\n-----\n\n### Is it possible to know who is behind the attack?\n\nIn most cases, getting to know who is behind\na cyber-attack is very complex, sometimes\nimpossible.\n\nIn this case we were fairly pessimistic. To make it\nworse, the fact that no malware had been used\nin the attack ruled out the possibility of finding a\nsignature to examine. However, there was a weak\nspot in the attack: the FTP connection used to\nsend out the stolen credentials.\n\nThe information was transmitted using the FTP\ncommand, and as that command was called\nby one of the scripts, it was possible to see the\nconnection used, from where it was established\nand the credentials used. The FTP server belonged\nto a free service that the attacker had signed\nup to, so we were able to access it and see the\ninformation entered when opening the account.\nYes, we were aware that the information would\nprobably be false, but it was still worth checking.\n\nThe name used was false; googling it returned\nzero results.  The country selected was the United\nStates, which could be false as well. Then we had a\nlook at the city information. The name in this field\nwas unknown to us: “Ikeja”.\n\nIt turns out that Ikeja is the name of a suburb in\nLagos -the capital city of Nigeria-, also known\nas the “Computer Village” as it hosts the nation’s\nlargest market cluster for technology products.\nThis information could also be false, but the fact\nthat whoever opened the account was familiar\nwith that name meant that they were from Nigeria\nthemselves or knew the country very well.\n\nThen came the email address. This was the only\nelement that we knew for sure had to be real and\nvalid, as it is the address at which users receive\nthe service activation message, password reset\nmessages, etc. In this case it was a Gmail address:\n*********5@gmail.com\n\n\nThe password was unknown, they hadn’t used the\nsame one as for the FTP service. We took the 9\ncharacters that made up the email address and\nstarted combining them to see if we could form an\nalias, a first name, a last name or similar. And we\n**got it.**\n\nWe googled what looked like a first name and last\nname and got a hit. It was the name of a person\nwith Nigerian nationality and Twitter, Facebook\nand LinkedIn accounts, which allowed us to obtain\nsome more information about him. All those\naccounts belonged to a person living in... Ikeja and\nwho is the owner of a goods transport company.\n\nIkeja\n\n?????????5@gmail.com\n\nToo many coincidences. So, even though all the\nevidence seems to indicate that this is the person\nresponsible for the attack, there is no way for us\nto prove it. It would require the police to launch\nan investigation and obtain information about\nthe FTP connections, etc., in order to get the\nIP address of the person who signed up to the\nservice and find the culprit.\n\n\n-----\n\n### Conclusion\n\nWith all the information we had in our hands, the\nidea of what to do next was clear: inform the police\nso that they could start an investigation and\napprehend whomever was responsible for the hack.\n\nSince one the affected companies was from\nSpain, we contacted the Spanish Civil Guard, a\npolice force that we have collaborated with in\nthe past and which has a very good reputation\nin the fight against cyber-crime. Unfortunately,\nthey face a difficult-to-solve problem: to start\nan investigation they need a victim who reports\nthe crime. It looks simple, but it isn’t: none of the\n**victims of this attack is willing to report it.**\n\nWhy? If our theory is correct, the information stolen\nfrom these companies has not been used against\nthem, but to defraud other people, oil buyers. It is\nfor that reason that the companies which have\nhad their credentials compromised prefer not to\nreport the attack for fear of having their name\nin the spotlight. They prefer to keep a low profile,\nchange their credentials and continue to operate\njust as if nothing had happened.\n\nSome countries have laws that force companies to\nreport every hacking intrusion where information\nis stolen. However, that obligation is usually limited\nto incidents in which the stolen information\nbelongs to a third party (customers, partners, etc.).\nIn this case, the stolen credentials belonged to\nthe company under attack, which therefore is not\nforced by law to report the theft.\n\nWe started this article by calling this case ‘The\nPhantom Menace’, due to the nature of the attack\nand the absence of malware to perpetrate it.\nContinuing with the homage to Star Wars, it is\ntime to move on to ‘The Force Awakens’: all major\ncompanies must awake to their vulnerability and\nrealize that absolute security doesn’t exist and\nbehavior-based protection is limited.\n\nThey need to go one step further, performing\nregular audits in order to assess and address\npotential weaknesses in their network security.\nDespite traditional security solutions are still\na necessity, they are no longer enough. It is\nimportant to understand that our defense systems\nmust adapt to the level of attack received, and\nso it is necessary to implement new protection\nstrategies that give organizations total control\nand visibility over their networks.\n\n\n### The companies like Black Gold usually prefer not to demand this kind of attacks in order keep them  in anonymity.\n\n\n-----\n\nThis article in whole or in part may not be duplicated, reproduced, stored in a retrieval system or retransmitted without prior written\npermission of Panda Security.\n\n© Panda Security 2015. All Rights Reserved.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "d63ae2b7-445f-460d-965d-2676dacdb6de",
            "created_at": "2022-10-25T15:59:19.552139Z",
            "updated_at": "2022-10-25T15:59:19.552139Z",
            "deleted_at": null,
            "name": "APTnotes",
            "url": "https://github.com/aptnotes/data",
            "description": "APTnotes data",
            "reports": null
        },
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        },
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://app.box.com/s/xrwk7gqk44dp89fioubewttrw8a88im1",
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2015/2015.05.19.Operation_Oil_Tanker/oil-tanker-en.pdf",
        "https://papers.vx-underground.org/papers/ICS SCADA/Other/Operation Oil Tanker - The Phantom Menace.pdf"
    ],
    "report_names": [
        "oil-tanker-en",
        "Operation Oil Tanker - The Phantom Menace.pdf"
    ],
    "threat_actors": [
        {
            "id": "77b28afd-8187-4917-a453-1d5a279cb5e4",
            "created_at": "2022-10-25T15:50:23.768278Z",
            "updated_at": "2025-03-27T02:00:55.5423Z",
            "deleted_at": null,
            "main_name": "Inception",
            "aliases": [
                "Inception Framework",
                "Cloud Atlas"
            ],
            "source_name": "MITRE:Inception",
            "tools": [
                "PowerShower",
                "VBShower",
                "LaZagne"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "dfee8b2e-d6b9-4143-a0d9-ca39396dd3bf",
            "created_at": "2022-10-25T16:07:24.467088Z",
            "updated_at": "2025-03-27T02:02:10.241387Z",
            "deleted_at": null,
            "main_name": "Circles",
            "aliases": [],
            "source_name": "ETDA:Circles",
            "tools": [],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "2f07a03f-eb1f-47c8-a8e9-a1a00f2ec253",
            "created_at": "2022-10-25T16:07:24.277669Z",
            "updated_at": "2025-03-27T02:02:10.157972Z",
            "deleted_at": null,
            "main_name": "TA428",
            "aliases": [
                "Operation LagTime IT",
                "Operation StealthyTrident",
                "ThunderCats"
            ],
            "source_name": "ETDA:TA428",
            "tools": [
                "8.t Dropper",
                "8.t RTF exploit builder",
                "8t_dropper",
                "Agent.dhwf",
                "Albaniiutas",
                "BlueTraveller",
                "Chymine",
                "Cotx RAT",
                "CoughingDown",
                "Darkmoon",
                "Destroy RAT",
                "DestroyRAT",
                "Gen:Trojan.Heur.PT",
                "Kaba",
                "Korplug",
                "LuckyBack",
                "PhantomNet",
                "PlugX",
                "Poison Ivy",
                "RedDelta",
                "RoyalRoad",
                "SManager",
                "SPIVY",
                "Sogu",
                "TIGERPLUG",
                "TManger",
                "TVT",
                "Thoper",
                "Xamtrav",
                "pivy",
                "poisonivy"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1666716496,
    "ts_updated_at": 1743041347,
    "ts_creation_date": 1431086893,
    "ts_modification_date": 1431086960,
    "files": {
        "pdf": "https://archive.orkl.eu/538701feeead706e34d24cf2b831071ac2f600cb.pdf",
        "text": "https://archive.orkl.eu/538701feeead706e34d24cf2b831071ac2f600cb.txt",
        "img": "https://archive.orkl.eu/538701feeead706e34d24cf2b831071ac2f600cb.jpg"
    }
}