{
    "id": "c44c59c7-9a8c-4474-9584-cdc310053cbd",
    "created_at": "2022-10-25T16:48:14.796819Z",
    "updated_at": "2025-03-27T02:16:59.166919Z",
    "deleted_at": null,
    "sha1_hash": "d66e1ed1855cd503bf2d2c07b4e608cbc2ec0a19",
    "title": "Macintosh HD:Users:Shared:dd:4work:Bitdefender-PR-Whitepaper-DarkNexus-creat4349-en_EN:Bitdefender-PR-Whitepaper-DarkNexus-creat4349-en_EN.indd",
    "authors": "",
    "file_creation_date": "2020-03-24T08:08:37Z",
    "file_modification_date": "2020-03-24T08:08:40Z",
    "file_size": 6613437,
    "plain_text": "#### Security\n# New dark_nexus IoT Botnet Puts Others to Shame\n\nwww.bitdefender.com\n\n\n-----\n\n**Authors:**\nBitdefender Investigations and Forensics Unit\n\n\n-----\n\nNew dark_nexus IoT Botnet Puts Others to Shame\n\n## Key Findings\n\n- New botnet used for DDoS services\n\n- Uses a DDoS tactic that disguises traffic as\ninnocuous browser-generated traffic\n\n- Synchronous and asynchronous Telnet scanners\nused for infection and victim reporting\n\n- Uses socks5 proxies, potentially for renting access\nto the botnet\n\n- Uses Telnet credential stuffing and exploits to\ncompromise a long list of router models\n\n- Most compromised IoTs are based in Korea\n\n- Uses debugging module to maintain proper\nfunctionality and reliability of the device\n\n- Code compiled for 12 different CPU architectures\nand has dynamic downloader injection\n\n- Distributed binary hosting using each victim as a\nreverse proxy\n\n- New persistence tactic by removing device restart\npermissions\n\n- Frequently updated components, with over 30\nversions in 3 months\n\n- Possibly created by greek.Helios, known botnet\nauthor who sells DDoS services and botnet code\n\n## Timeline\n\ndark_nexus has seen many updates in its three months\nof existence, and each binary contains a helpful\nversioning string (in some cases, contained in user\nagent strings or headers used by its proxy server;\nrecent binaries include the versioning string in the\nmessage used for registering to the CnC).\n\nThis table maps the timeline of the development of\nthis botnet: the date of the first occurrence, a sample\nhash and the version string:\n\n\n-----\n\nNew dark_nexus IoT Botnet Puts Others to Shame\n\n\n**Date** **Hash** **Version** **Notes**\n\n\n29/12/2019 0a1817c7606d7eea7971266c4ed111036c855c4e 4.0\n\n30/12/2019 aea0032c29a1716079f90a424a5918ab63356216 4.0\n\n07/01/2020 c702a349e3bef994a437f227181c498adaf52ce5 4.0\n\n09/01/2020 0af068739a456de81b4fe4610c43c99dec220e45 4.0\n\n03/02/2020 f51b4406deb69ddb787d974b480778f6a953927d 4.0 introduces reverse proxy\n\n07/02/2020 6d3f9758e812910efd511abae50ebd7ef7cd6262 4.1\n\n08/02/2020 ea29a317eacc2fd1f514e5a3c7d5d80da415bbf0 4.2\n\n5bd15d4eed9bb5c5100b1a1524086368fcfcc987 4.3\n\n09/02/2020 3d6ac9958349e188c77688eaf49bf3f24ab0ae9c 4.4\n\n10/02/2020 7108b511ed0477b0ddf68f652b2abdcb2db4dd0a 4.5\n\n11/02/2020 3d0bcf2a45e2899514b43914166eeee29c866d28 4.6\n\n20067b27808b2f2188f138cd02ee6c22071e334a 4.7\n\n12/02/2020 da6e7cc6e4556561905868a8b7399c525b1b9b26 4.8\n\n7e455ce999d11c1414f8e11bf0d1c1f628410a8d 4.9\n\n48fe32af4d9ec090542c4866302a062abf427c5f 5.0 introduces socks5 proxy\n\n15/02/2020 1f20645abb7d943e8e32f8ffcaf944038ca90f77 5.1\n\n581d233766e7bedace5005d59cdc0b0c8244e486 5.2\n\n6f9b282e4deaab04d4a2de515f4357336531d04b 5.3\n\n23/02/2020 33a104b35b03527b7ec38bdcfe1de8d7171c9611 5.4 removes reverse proxy\n\n26/02/2020 57c8f79017595215c591408f5e7be119ce568705 5.5\n\n27/02/2020 fb06fe883af5485e308719704883fcf6c9e325f4 5.6\n\nea7366fa0f8e6e2b5d13c97fb96f0c8056197a8d 5.7\n\n9fd6154540589a23f7ee21af2f126191ed83b5ff 5.8\n\n29/02/2020 fd8d6dbd13c1568a69559c4dd910eda2eb0c2416 5.9\n\ne292c66272c6d303af8d1985e945261af9afe1c3 6.0\n\n5819cb01e7ecaca5a98e5d141983eef49740e939 6.1\n\nee5e900628a52ef97b43c8c3b548b4d6c1100e14 6.2\n\n01/03/2020 ff293f1d8d692f35f37f83ee324ec3be00ff1c7b 6.3\n\n94b4a5e47f5d6d7879a8e5bfdbc7d4bb35dad937 6.5\n\n02/03/2020 e5ac23f2f03b27d15c13972868a1f162e1590c0e 6.6\n\n03/03/2020 404ee98fcbeb676f891d657941455619e2c39104 6.7\n\n05/03/2020 af47dbdadc84420fc1714044d52bbf7b5a84937b 6.7\n\n03e0e5a19ed24b3deefa7878a23966b92224ec9e 7.0\n\n06/03/2020 08419020d8c2d2da9f105947cbf86a16c2bf1987 7.2\n\nbe3005bfc822663137ebb6b2df02469eaf93ee79 7.3\n\n07/03/2020 a425c6ed12d9f31cc741cfccbd2ade8aa6ded057 7.4\n\nbaeef17442e0a7e30ec5a99f53a6c44f84235214 7.5\n\n\n-----\n\nNew dark_nexus IoT Botnet Puts Others to Shame\n\n\n**Date** **Hash** **Version** **Notes**\n\n\n08/03/2020 fdc4deaaabc438209883eb92ca8c17c2d3d58155 8.0\n\n09/03/2020 6ba1f9dfc64dc3abee746ba9655d7d47691def3b 8.1\n\n0f956333f03539589368fbaa544788a1eb8bc8d5 8.2\n\n8992218b82e3395c1d24248c979f0787e9e4ef65 8.3\n\n10/03/2020 e4f2a91f57e88ac4148646fcaf11f7290bf87a7f 8.4\n\nc522fab64a2e85d679a762da677bcb6af984f552 8.5\n\n11/03/2020 e4263a6261bba7f41bf741900d6d97347369d989 8.6 introduces a large number\nof new bruteforce combos\n\n\n**Fig. 1 – Timeline of botnet evolution**\n\n### Architectures:\n\n```\narm:  ELF 32-bit LSB executable, ARM, version 1 (ARM), statically linked, stripped\narm5:  ELF 32-bit LSB executable, ARM, version 1 (ARM), statically linked, stripped\narm6:  ELF 32-bit LSB executable, ARM, EABI4 version 1 (GNU/Linux), statically\nlinked, stripped\narm7:  ELF 32-bit LSB executable, ARM, EABI4 version 1 (GNU/Linux), statically\nlinked, stripped\nmpsl:  ELF 32-bit LSB executable, MIPS, MIPS-I version 1 (SYSV), statically linked,\nstripped\nmips:  ELF 32-bit MSB executable, MIPS, MIPS-I version 1 (SYSV), statically linked,\nstripped\ni586:  ELF 32-bit LSB executable, Intel 80386, version 1 (GNU/Linux), statically\nlinked, stripped\nx86:  ELF 64-bit LSB executable, x86-64, version 1 (SYSV), statically linked,\nstripped\nspc:  ELF 32-bit MSB executable, SPARC, version 1 (SYSV), statically linked,\nstripped\n\n```\n```\nm68k:  ELF 32-bit MSB executable, Motorola m68k, 68020, version 1 (SYSV), statically\nlinked, stripped\n\n```\n```\nppc:  ELF 32-bit MSB executable, PowerPC or cisco 4500, version 1 (GNU/Linux),\nstatically linked, stripped\narc:  ?\nsh4:  ELF 32-bit LSB executable, Renesas SH, version 1 (SYSV), statically linked,\nstripped\n\n```\n```\nrce:  ?\n\n```\n**_Note: the propagation modules contain code for targeting the ARC and Motorola RCE architectures, no samples compiled_**\n_for these architectures have yet been evidenced._\n\nThe binaries are cross-compiled using Aboriginal Linux, an open-source toolchain often used by IoT malware authors\nwho seek to make their binaries available for a wide array of platforms from the IoT sphere.\n\nThey are, for the most part, equipped with a packer based on UPX (some versions excepted) and have been stripped\nof symbols and debugging information. However, maybe due to an oversight, the arm7 binaries have not been stripped\nand in some cases also include debugging information.\n\nWith this debugging information we were able to gain insight into the structure of the project from the developer’s\nperspective. It is structured into the following source files, corresponding to the bot’s modules/main features:\n\n\n-----\n\nNew dark_nexus IoT Botnet Puts Others to Shame\n```\n    main.c\n    networking.c\n    resolve.c\n    socks5.c\n    mass_exploiter.c\n    reverseproxy.c\n    spreader.c\n    syn_bruter.c\n\n```\nAs mentioned earlier, the executables are packed with a customized version of UPX, in which the “UPX!” string has\nbeen replaced by “YTS\\x99”. Malware authors often use custom packers to hinder the reverse engineering of their\nbinaries and to stop anti-virus solutions from flagging them as malicious based on the UPX magic number.\n\n## Functionality\n\nThe startup code of the bot resembles that of Qbot: it forks several times, blocks several signals and detaches itself\nfrom the terminal. Then, in the vein of Mirai, it binds to a fixed port (7630), ensuring that a single instance of this bot\ncan run on the device. The bot attempts to disguise itself by changing its name to “/bin/busybox”. Another feature\nborrowed from Mirai is the disabling of the watchdog by periodic ioctl calls on the virtual device. While trying to find the\nproper path for the virtual device, it looks for the following:\n```\n       /dev/watchdog\n       /dev/misc/watchdog\n       /dev/FTWDT101_watchdog\n       /dev/FTWDT101\\ watchdog\n       /dev/watchdog0\n       /etc/default/watchdog\n       /sbin/watchdog\n       /fh/dev/watchdog\n       /extended/dev/watchdog\n\n###### The bot registers to the CnC with a message containing the first command line argument (which identifies the infec- tion vector), the CPU architecture and the port(s) used by the proxy module(s).\n\n The scanner, killer and proxy modules each run in their separate processes while the main process communicates with the CnC and carries out commands.\n\n## Communication Protocol\n\n###### The first byte of a packet indicates the command type:\n\n```\n-  0x9a - exit\n\n- `0x69 (‘i’) add a target to the bruteforce target list`\n\n\n-----\n\nNew dark_nexus IoT Botnet Puts Others to Shame\n\n-  0xfe - ping CnC (send one byte: 0x15)\n\n-  0x4b (‘K’) - kill_attacks\n\n-  0x43 (‘C’) - cmd_not_attack; second byte can be:\n\n###### o  1: execute command in new process o  3: kill running forks o  7: reboot o 16: kill process by port o 17: kill reverse proxy o 18: start reverse proxy\n\n-  0xb1 - count active bruting connections (targets submitted using the ‘i’ command that are actively bruteforced by the\nasynchronous scanner)\n\nThe default case matches a DDoS command. In the parse_packet function, the next bytes are parsed, identifying the\nattack type and parameters. In start_attack, the designated function is identified based on the attack id and is executed\nin a new process.\n\n## Attacks\n\nListed by attack ID (parsed from CnC command). The names are recovered from symbols (samples that were not\nstripped).\n\n0: attack_udp_simple\n\n1: attack_tcp_raw\n\n2: attack_ovh\n\n3: attack_http\n\nThis also has configurable HTTP methods (GET, HEAD, POST, PUT, CONNECT, OPTIONS, DELETE, PATCH, TRACE)\n\n4: browser_http_req\n\nConfigurable headers:\n\n“User-Agent”: 21 entries, random\n\n“Origin”: from command\n\n“Referer”: 20 entries, random or from command\n\n“Accept”: 6 entries, random\n\n“Accept-Charset”: 3 entries, 4 qvalues, random\n\n“Accept-Language”: 26 entries, 4 qvalues, random or from command\n\n“X-Forwarded-For”: random IP\n\n“Connection”: 2 options, random or from command\n\nAlso sent:\n\n“Upgrade-Insecure-Requests: 1”\n\n5: attack_udpmop\n\n7: attack_udp_plain\n\n9 k\n\n\n-----\n\nNew dark_nexus IoT Botnet Puts Others to Shame\n\nThe attacks are pretty standard DDoS attacks common to many other botnets. The more interesting one is browser_\nhttp_req, which is highly complex and configurable. It attempts to disguise the traffic as innocuous traffic that could\nhave been generated by a browser.\n\n## Killer module\n\nRuns in dedicated process. It is the last one initialized and consequently knows the PIDs of all other spawned\nprocesses, which it uses as a whitelist.\n\nScans /proc looking for processes not in the whitelist that either:\n\n- by calling readlink on “/proc/pid/exe” the resulting buffer contains “(deleted)”; this indicates that the executable was\ndeleted while the executable was still running, a behavior often employed by malware; suspicion weight: 90\n\n- have the executable in one of these blacklisted directories:\n```\n      “/tmp/”\n      “/var/”\n      “/dev/”\n      “/dev/shm”\n      “/var/tmp/”\n      “/var/run/”\n      “/”\n\n```\nsuspicion weight: 80\n\n- have more than 250 file descriptors open; suspicion weight: 10\n\n- have a cmdline that starts with “./” or “/.”; suspicion weight: 10\n\n- have the bot’s GID in its supplementary group list (“Groups:”) in /proc/[PID]/status); suspicion weight:\n```\n 20\n\n```\n- are statically linked and contain the “UPX” string; suspicion weight: 90\n\nIt maintains a list (suspect_list) in which the matching PIDs are recorded, along with a “suspicion” value that is\nupdated when one of the aforementioned criteria is met. If this cumulated value is >= 100, the suspected process is\nkilled. Certain processes are whitelisted based on their:\n\n- command line; containing one of “/var/Challenge”, “/var/Sofia”\n\n- executable path: containing one of: “/bin/busybox”, “/var/Sofia”, “/var/Challenge”, “.vu”, “/var/\n```\n Kylin”, “/dvrbox”, “/sbin/”, “/bin/”, “init”, “upnpd”, “ppoe”\n\n```\nIn addition, when the killer module is initialized, it records a list of PIDs for the processes running at that time\n(lockdown_pidlist). In the main bot process, a function is executed periodically (enforce_lockdown) that looks for\nprocesses not belonging to that list or the list of processes spawned by the bot. A process is killed if it does not belong\nto any of these lists and\n\n\n-----\n\nNew dark_nexus IoT Botnet Puts Others to Shame\n\n- its command line contains “.sh” or “telnet” (certain versions)\n\n- its command line does not contain “/bin/busybox” or “-kstrge” (v8.1)\n\nIn the newest versions, the whitelist used in the killer module is also used in the lockdown function.\n\nSince version 8.1, the cmdline of killed processes is reported to a report server (190.115.18.144:13000\nUDP). As we tracked the differences between consecutive versions, we noticed that in several cases the sole\ndifference was adding an entry to the whitelist (v8.5: a043d6efb0c2d9a788ccd8c277cf36461eaecbf0 to\n```\nc522fab64a2e85d679a762da677bcb6af984f552). We believe this feature is meant to let the botnet developer\n\n```\ndebug the bots and figure out which processes to include in its whitelist to maintain the proper functionality of the\ndevice.\n\nProcesses that occupy certain ports may be killed through a CnC command that specifies the targeted port.\n\n## Propagation\n\nThe bot uses two modules, one synchronous and one asynchronous.\n\nWhen starting the synchronous scanner, the bot spawns another process in which it executes the init_syn_bruter\nfunction.\n\nFor the asynchronous mechanism, the CnC issues a certain command (‘i’ or 0x69), specifying an IP and port. This\ninformation is stored in a queue (dynamic_queue_head). The bot maintains a list of connections in a dedicated\nstructure array of size 250, named ‘bruting_conns’. As soon as a slot is cleared (i.e. a connection is removed from\nthe array) it is filled by an entry corresponding to the top of the queue. The main bot process multiplexes between the\nsockets created for these connections. In addition, it periodically checks for timeouts for all connections, including the\none to the CnC. When reconnecting to the CnC, it sends the aforementioned registering message.\n\nBoth the sync (init_syn_bruter) and async (fd_event) mechanisms implement the Telnet protocol and attempt\nto authenticate by brute-forcing with a set of predefined credentials. While the synchronous bruter reports the victim to\na report server and actually sends an infection payload (worm behavior), the async one only sends, via the CnC socket,\na message containing the IP, port and discovered credentials. In some versions, the synchronous bruter also reports\nto a report server (but maintains the worm behavior). The communication method also varies: in some cases it is over\nTCP (port 12000 or 13000), and others over UDP (port 12000 or 13000) or through the CnC socket (TCP port 30047).\n\nMuch like the scanners employed by other widespread botnets, such as Mirai and Gafgyt/Bashlite/Qbot, the scanner is\nimplemented as a finite state machine modeling the Telnet protocol and the subsequent infection steps, in which the\nattacker issues commands adaptively based on the output of previous commands.\n\nIn version 4.0 (f51b4406deb69ddb787d974b480778f6a953927d) this process included a dropper: a binary using\nthe “hexstrings push method”. This technique was previously seen in the fbot and hbot botnets and entails using an\necho command with the payload as an argument in an escape sequence format. The droppers are stored in the “.data”\nas hex-encoded strings. In the setup phase, they are copied in a structure that supports 10 entries. The arm6, arm7 and\narc entries are empty.\n\n\n-----\n\nNew dark_nexus IoT Botnet Puts Others to Shame\n\n**Fig. 2 – List with number of supported CPU architectures**\n\nIn the original format (dlr_*) the droppers contain placeholder bytes: “N1”, “N2”, “N3”, “N4”, “NN” which\nare replaced when copied to the dlr_list by bytes from the target IP or port. This IP and port correspond to the\nHTTP server the victim (while executing the dropper) connects to in order to download the next stage. The version we\ndescribe here included the reverse proxy module and thus the IP and port patched into the dropper are the public IP of\nthe bot and the random generated proxy port.\n\nThe following picture shows the decompiled main function for the dlr_arm dropper, where the IP and port have been\npatched with zeroes.\n\n**Fig. 3 – Decompiled main function for the dlr_arm dropper**\n\nFrom version 4.1, the bot stopped using droppers, using the wget command instead.\n\nIn the 7[th] step of the state machine, the scanner sends the following command:\n\nt /bi / h || /bi /b b t /bi /b b || hil d i d /bi /b b h $i\n\n\n-----\n\nNew dark_nexus IoT Botnet Puts Others to Shame\n\ndone < /bin/busybox\n\nThe output of the command is the content of an ELF file (either /bin/echo or /bin/busybox) compiled for the\ninfected machine’s architecture. This output is parsed, trying to determine the CPU architecture of the device from the\n```\ne_machine of the ELF header. Supported architectures are listed in the Architectures table, in the Timeline section.\n\n```\nOnly the binary for the detected architecture is downloaded to the victim, either by the technique involving a dropper or\ndirectly from the hosting server.\n\nWe have addressed so far the Telnet commands issued by the synchronous scanner. The asynchronous scanner stops\nshort of infecting the victim, only reporting detected credentials to a report server. Using data from our honeypots, we\nidentified the Telnet sessions in which the attacker uses the detected credentials to infect the device with dark_nexus.\nThe commands in these sessions differ from those in the sessions initiated by the worm, and the set of attacker IPs\nsuggests the attacks are coordinated from a short list of VPSs instead of IoT devices.\n\n**Attacker IPs:**\n\n66.175.210.74\n\n51.15.120.245\n\n45.33.73.134\n\n190.115.18.144\n\n190.115.18.28\n\n51.159.52.250\n\n190.115.18.86\n\n192.168.100.210\n\n192.168.100.27\n\n192.168.110.135\n\n45.33.84.114\n\n45.56.102.170\n\nThe contents of a Telnet session associated with this asynchronous propagation suggest that the attacker is using\nthe Mirai loader module, which has been customized by using the following strings for FN_DROPPER and FN_BINARY:\n“gafgyt” and “wordtheminer” respectively.\n\nEarlier versions also used exploits for propagation:\n\n- [CVE-2019-7256 (c702a349e3bef994a437f227181c498adaf52ce5 - v4.0)](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-7256)\n\n- Netgear DGN1000 setup.cgi Unauthenticated RCE (0a1817c7606d7eea7971266c4ed111036c855c4e - v4.0)\n\n- JAWS Webserver RCE (c702a349e3bef994a437f227181c498adaf52ce5 - v4.0)\n\n\n-----\n\nNew dark_nexus IoT Botnet Puts Others to Shame\n\nThe bot uses the following list of credentials for bruteforce:\n\n**Fig. 4 – Credential list for bruteforcing**\n\n**_Note: The presence of default credentials for Zhone routers explains the large number of infected devices of this type._**\n\n\n-----\n\nNew dark_nexus IoT Botnet Puts Others to Shame\n\n## Persistence\n\ndark_nexus has used various persistence methods during its evolution. Prior to version 5.1, this function was executed\nduring the bot’s startup:\n\n**Fig. 5 – Decompiled persistence function that stops cron service**\n\n###### Rather than ensuring persistence, these commands try to prevent the device from rebooting by stopping the cron service (a service used to schedule tasks) and removing permissions for executables that could be used to reboot the device.\n\n Newer versions feature another persistence function, in which it places a set of commands in the “/etc/init.d/rcS” file.  First, it reads the bot code from /proc/self/exe and formats an echo command with the hex-escaped content whose output is piped to the “/tmp/dvr_enc” file, which is then executed:\n```\n       echo -ne “\\x7f\\x45\\x4c...” > /tmp/dvr_enc\n       chmod 777 /tmp/dvr_enc\n       /tmp/dvr_enc reboot\n\n Another shell command executed in the persistence function is “iptables -F”, which clears iptables rules, ensuring that communication with the CnCs or the DDoS payloads it sends are not filtered.\n\n In some versions, the aforementioned persistence script is written in the “/home/start.sh” file if the killer module detects a running process with the command line containing “start.sh”.\n\n```\n\n-----\n\nNew dark_nexus IoT Botnet Puts Others to Shame\n\n## Proxy modules\n\nUpon initialization, the bot retrieves from the command line arguments an IP and port - the public IP of the device that\ninfected the current device and the port where the “parent” device runs an HTTP server:\n\n**Fig. 6 – Code for device “parent” information retrieval**\n\nThen the bot randomly generates a port and starts its own HTTP server (init_reverse_proxy) on it, in a new process.\nThe bot binaries (hoho.[arch]) are downloaded from the hosting server and stored on the device. This operation is\nrecurrent, ensuring that the binaries stored locally and served by the HTTP server are up to date. Initially, the proxy\nuses the central server (corresponding to the first CnC domain) as its backend. When a problem with the connection\nto this backend is encountered, the backend is updated to point to the IP and port of the “parent” in the infection chain\n(who_infected_us).\n\nThe proxy is also used in the infection process, in the worm component: regardless of the method used (binary dropper\nor wget command), the victim is directed to download the appropriate binary from the attacker, rather than from the\ncentral hosting server.\n\nThe proxy module contains two strings that could be used to determine the version of the bot:\n\n- the content of the server’s response to a GET request for “/” is of the form: “hoho_fastflux/v4.0”\n\n- a user agent string used in the requests sent to the backend: “User-Agent: checker/v4.0/p”\n\n###### This module has been phased out since version 6.7. In version 5.0, a Socks5 proxy module was introduced. Like the other proxy, the socks5 proxy runs on a randomized port that is reported to the CnC as part of the registration mes- sage. It is unclear to what end the socks5 is used. dark_nexus is not the first botnet to have such a feature: TheMoon, Gwmndy, Omg botnets and a certain Mirai variant have featured socks5 proxies before. A possible motivation would be selling access to these proxies on underground forums. However, we have not found evidence of this yet.\n\n## Infrastructure\n\nThe botnet infrastructure is comprised of:\n\n- Several Command-and-Control servers. These issue commands to the bots. The following domains are used:\n\nswitchnets[.]net:30047\n\nthiccnigga[.]me:30047\n\n- Report servers. When a vulnerable service is discovered, the bot reports the IP and port to the report server. In some versions,\nthis coincides with the CnC. In others, the report server is identified by a domain or hardcoded IP address and the port is\n12000 (UDP or TCP depending on version). The domains are the same two used for CnCs, and the IPs correspond to the\naddresses they resolved to at the time [when the bot version was issued]\n\n\n-----\n\nNew dark_nexus IoT Botnet Puts Others to Shame\n\n- Hosting servers. Samples are hosted at switchnets.net:80 and are retrieved using HTTP. In the infection vector using binary\ndownloaders, the IP is hardcoded rather than using a domain due to the fact that the downloaders are supposed to be\nlightweight (small size) and therefore exclude the resolver code. In the versions of dark_nexus that contain the reverse proxy\nfeature, each victim acts as a proxy for the hosting server, serving the samples on a random port. This port is reported to the\nCnC when a bot registers (periodically). In addition, in that version of the infection process, the synchronous scanner (worm\ncomponent of the bot) would give its IP and the reverse proxy port to the victims it infects as third and fourth command line\nargument. The victim would then know the IP:port of the “parent” server and use that (if available) as a source: it would\nperiodically update its own set of samples that it served in its [the victim’s] own server.\n\n**Fig. 7 – Infection and services interaction diagram for dark_nexus**\n\n\n-----\n\nNew dark_nexus IoT Botnet Puts Others to Shame\n\nBased on the IPs that attacked our honeypots in the past week and match the dark_nexus attack vector, we have\ndetermined that the botnet is comprised of at least 1,372 bots. The following chart shows their geographical\ndistribution:\n\n**Fig. 8 – dark_nexus botnet global victim distribution**\n\nCountry No. of victims\n\nChina 653\n\nRepublic of Korea 261\n\nThailand 172\n\nBrazil 151\n\nRussia 148\n\nTaiwan 110\n\nUkraine 77\n\nVietnam 24\n\nUnited States 68\n\nIndia 46\n\nIn terms of devices that seem compromised by the dark_nexus, the list is pretty extensive, ranging from various router\nmodels, such as Dasan Zhone, Dlink, and ASUS, to video recorders and thermal cameras. It’s likely more device models\nwill be added as dark_nexus development continues.\n\n## Relationship to Other Botnets\n\nOne domain that dark_nexus has used as a CnC for most of its existence – switchnets[.]net - has been\nassociated with other botnets in the past:\n\n- a Mirai variant with branch name “SELFREPPING” has used the domains “switchnets[.]net” and “scan.\n```\n switchnets.net” as CnCs in November 2019:\n\n```\n|Country|No. of victims|\n|---|---|\n|China|653|\n|Republic of Korea|261|\n|Thailand|172|\n|Brazil|151|\n|Russia|148|\n|Taiwan|110|\n|Ukraine|77|\n|Vietnam|24|\n|United States|68|\n|India|46|\n\n\n-----\n\nNew dark_nexus IoT Botnet Puts Others to Shame\n```\n     o af7ded5f9f308de99a94c5f46e4ba24e01e5f45c (10/11/2019)\n     o 65df473dcc02f19c0f63d39da2481964831d4efc (16/11/2019)\n     o bc754d6eb7eb3f284e6a7edd64b64c705dda1e3d (21/11/2019)\n     o 007003e3527a219540e353c88713fed4140548c0 (25/11/2019)\n\n```\n- a Mirai/Satori branch “Okosu” has used “scan.switchnets.net” as a CnC in October\n```\n     o d24410f88ccef2279d843f09457257debd6f19d1 (17/10/2019)\n\n```\n- a Mirai/Satori using the name “hoho” for its binaries in November 2019; CnC: “adagio.switchnets.net”; contains the\nstring: “botnet written by wicked”\n```\n     o 42128788ff36848d7430aa924f35ffb1d8b56194 (13/11/2019)\n\n```\nWe have correlated this domain with the domain “subby[.]xyz” and its subdomains “alpha.subby[.]xyz”, “cnc.\n```\nsubby[.]xyz”, “scan.subby[.]xyz”, which were resolved to the same address in March 2020. This domain has\n\n```\nbeen used as a CnC:\n\n- by a Mirai variant in February-March 2020\n```\n     o 9c403fe42671bb29ea6d970a2e80ea98360b8dc1 (first seen: 02/02/2020; last seen:\n\n###### 01/03/2020)\n\n```\n- by a Gafgyt-based botnet in August 2019\n```\n     o 78d6660e4616c2526afe208a7dfb89783b858f66; this sample contains the string “word the\n\n###### miner”, a phrase that appears in various forms in the dark_nexus Telnet sessions\n\n## Attribution\n\n```\nIn 2018, a Mirai variant named “hoho” emerged. Its bot binaries contained the string: “Botnet Made By greek.Helios”.\nSince then, the source code for this variant has been leaked in underground forums, so many copycat botnets have\nappeared.\n\nDespite not being a derivative of Mirai – it used Qbot as a starting point - early dark_nexus\nbinaries contain a similar string that they print as part of their banner: “@greek.helios”\n(c702a349e3bef994a437f227181c498adaf52ce5). Moreover, the names of the bot binaries are the same: “hoho.\n```\n[architecture]”. We have used this as a starting point and investigated this character and their possible relation to\n\n```\nthe dark_nexus botnet. Here’s what we know so far:\n\n- “greek helios” is a botnet author that sells DDoS services and botnet code on various social media\n\n[• they provided hosting services for botnets and were associated with domain botnet[.]pw (proof). This advertisement also links](https://www.virustotal.com/gui/file/ccc4a0c5fd1582a46f27abf42be90c3b22b4fa383836bdf385c92e9794c5d230)\ntheir Instagram and Skype accounts\n\n[• they advertise their botnet on a YouTube channel exhibiting its DDoS capabilities. In these videos, we see a Mirai administrator](https://www.youtube.com/channel/UCnnWTRv_Ii1K35OiEcJEgpQ)\nconsole, a breakdown of the infected devices by CPU architecture and a list of prices. In one video, we get a glimpse of their\ncomputer’s desktop, where we can see a shortcut for connecting to an IP – an IP evidenced in our honeypot logs as a CnC and\nhosting server for a Mirai-based botnet.\n\n- the botnet, as evidenced by our honeypots, has been active since December 2019; associated with\nthe URI “/hakka/helios.[arch]”; contains strings: “Botnet Made By @greek.Helios”\n\n\n-----\n\nNew dark_nexus IoT Botnet Puts Others to Shame\n\n(cda7552ee4b9c5cf5d5e0f400a04a2c856fc4127); these samples contain exploit links that drop binaries named\n“hoho.[arch]”, correlating again with the original “hoho” botnet and dark_nexus\n\n- we have mapped all the IPs and domains associated with this character (including an older botnet, from 2017, hosted on\n“greekhelios21[.]tk”) and this infrastructure does not overlap at all with the botnet cluster on “switchnets[.]\n```\n net”, so we could not corroborate this hypothesis further.\n\n###### Breakdown of infected devices in greek helios’s botnet\n\n```\n\n-----\n\nNew dark_nexus IoT Botnet Puts Others to Shame\n\n###### Advertised prices\n\n## Indicators of compromise (IoC)\n\nAn up-to-date and complete list of indicators of compromise is available to Bitdefender Advanced Threat Intelligence\n[users. More information about the program is available at https://www.bitdefender.com/oem/advanced-threat-](https://www.bitdefender.com/oem/advanced-threat-intelligence.html)\n[intelligence.html](https://www.bitdefender.com/oem/advanced-threat-intelligence.html)\n\n\n-----\n\nNew dark_nexus IoT Botnet Puts Others to Shame\n\n## Hashes\n\nThis is a selection of hashes for the files we encountered over the course of this investigation. More hashes are\n[available on our GitHub repository here: https://github.com/bitdefender/malware-ioc/tree/master/dark_nexus](https://github.com/bitdefender/malware-ioc/tree/master/dark_nexus)\n\n0028b4f8c11608fef555672e1a61cb9bdad1389d\n\n002dd603368e95914c83f442cc058a7c2fe468e7\n\n022a65716f7e84a4cf036f943fa95ce15763a155\n\n028871c18e09c95ec9b396177f2333f9850e421f\n\n02d787f9a49648bc7a499815992672a195c7bc94\n\n03c2ce10e35b0ae95c80a2e462be1fe31b2ea9c5\n\n03dc6a47ecbeea3027eb4278b26af8825bef2d6b\n\n03e0e5a19ed24b3deefa7878a23966b92224ec9e\n\n03e780f9316c9cc853189df83c30650f32d0e476\n\n058fe58e3dc6c77c19258e3a11bcd786d849363d\n\n0671f6152569a646d820073b73cb1aef642a5f6c\n\n069df92b74c9db557d42430d77fa0dd557a91f81\n\n07221a2d3646d2c448140366b1a8f11d5dc1e49c\n\n076991378a600a8d0f4a56e7db75c6986d6e7518\n\n07d0dc0eccb7f77cccd9209c6240821d81ca386a\n\n08419020d8c2d2da9f105947cbf86a16c2bf1987\n\n089ab77cfc6f72dc455a905935ce8a179425945b\n\n0a1817c7606d7eea7971266c4ed111036c855c4e\n\n0a28e032e2626f9f730662a677033020b3de664d\n\n0a88bf52a7ae160a46d6b6ded745737f3b703f6f\n\n0a8bc057d9ed8c79eb9ae5fd8ca63fc1f75b2765\n\n0ae6aba288ec79baafdb69ad08c19367a62100c5\n\n0af068739a456de81b4fe4610c43c99dec220e45\n\n0b0ee03f8d2363851030c74eccffbe10644e634b\n\n0e686f05804d2d6d95c2cd9052d0789b602a0c46\n\n0f956333f03539589368fbaa544788a1eb8bc8d5\n\n0fa5bdea8b859cb685dffe35be1994c690dea3ba\n\n0fb2775fd7eb74a82eca8d73dbdc57f7bc2fbf87\n\n12efc8b92a99a3c7332226ef56b303f11680b0ce\n\n133ed889e86b3b1b1589cc52f62f54e8b9399730\n\n136890b375526eebdd69a3a725c06b0eafb86ace\n\n13b27e31a1e87eebdebea493c23de147541fc218\n\n13dff8738976e9e1166effd50c133f0b36b5dfe1\n\n1480105172855e399a359d4a1eda5cc6cdc579bf\n\n15c61aa0a32ffd80ff5da6606c947cec27c48e75\n\n160f8c82426476dfa37cdfa9fcb703fa5d631d9d\n\n1610bb2b66027ee4c3987886fa64e0bdb752499b\n\n\n-----\n\nNew dark_nexus IoT Botnet Puts Others to Shame\n\n\n199f6e548ad366db2c92deb6f927be544e171aa3\n\n1b7357b02198d12300182d6a1737af3637066ce6\n\n1b7788201e0813e8f6753c04f7bcd2a5e7a69cb6\n\n1c08ef95b9fa75a7064c8cc7b76280b31e33c842\n\n1d2bf6f1f4a20f67cf9e6b316adbdbab16327f21\n\n1e042211a0292f5bf446a4e3729377f89b02dc1d\n\n1e7a0a9b0bba806ac52a820aa7db451660bd8142\n\n1ee5d79830e48bbd4ef96b3735f7dacd9b3d8100\n\n1f20645abb7d943e8e32f8ffcaf944038ca90f77\n\n20067b27808b2f2188f138cd02ee6c22071e334a\n\n200c6be564bba578c72ff288449ddd9f4a21e2e5\n```\n20855af6597294707eae33d3e065c794801db2d3\n\n```\n\n-----\n\n##### Proudly Serving Our Customers Dedicated To Our +20.000 Worldwide Partners\nBitdefender provides solutions and services for small business and medium A channel-exclusive vendor, Bitdefender is proud to share success with tens of\nenterprises, service providers and technology integrators. We take pride in thousands of resellers and distributors worldwide.\nthe trust that enterprises such as Mentor, Honeywell, Yamaha, Speedway,\n**Esurance or Safe Systems place in us.** _CRN 5-Star Partner, 4th Year in a Row. Recognized on CRN’s Security 100 List. CRN Cloud_\n\n_Partner, 2nd year in a Row_\n\n_Leader in Forrester’s inaugural Wave™ for Cloud Workload Security_\n\n_More MSP-integrated solutions than any other security vendor_\n\n_NSS Labs “Recommended” Rating in the NSS Labs AEP Group Test_\n\n_3 Bitdefender Partner Programs - to enable all our partners – resellers, service providers_\n\n_SC Media Industry Innovator Award for Hypervisor Introspection, 2nd Year in_ _and hybrid partners – to focus on selling Bitdefender solutions that match their own_\n_a Row_ _specializations_\n\n_Gartner® Representative Vendor of Cloud-Workload Protection Platforms_\n\n##### Trusted Security Authority\nBitdefender is a proud technology alliance partner to major virtualization vendors, directly contributing to the development of secure ecosystems with VMware,\n**Nutanix, Citrix, Linux Foundation, Microsoft, AWS, and Pivotal.**\n\nThrough its leading forensics team, Bitdefender is also actively engaged in countering international cybercrime together with major law enforcement agencies\nsuch as FBI and Europol, in initiatives such as NoMoreRansom and TechAccord, as well as the takedown of black markets such as Hansa. Starting in 2019,\nBitdefender is also a proudly appointed CVE Numbering Authority in MITRE Partnership.\n\n**RECOGNIZED BY LEADING ANALYSTS AND INDEPENDENT TESTING ORGANIZATIONS** **TECHNOLOGY ALLIANCES**\n\n##### UNDER THE SIGN OF THE WOLF\n\n**Founded 2001, Romania** A trade of brilliance, data security is an industry where only the clearest view, sharpest mind and deepest insight can\n**Number of employees 1800+** win — a game with zero margin of error. Our job is to win every single time, one thousand times out of one thousand,\n\nand one million times out of one million.\n\n**Headquarters**\nEnterprise HQ – Santa Clara, CA, United States And we do. We outsmart the industry not only by having the clearest view, the sharpest mind and the deepest insight,\nTechnology HQ – Bucharest, Romania but by staying one step ahead of everybody else, be they black hats or fellow security experts. The brilliance of our\n\ncollective mind is like a luminous Dragon-Wolf on your side, powered by engineered intuition, created to guard against\n\n**WORLDWIDE OFFICES** all dangers hidden in the arcane intricacies of the digital realm.\n**USA & Canada: Ft. Lauderdale, FL | Santa Clara, CA | San Antonio, TX |**\nToronto, CA This brilliance is our superpower and we put it at the core of all our game-changing products and solutions.\n**Europe: Copenhagen, DENMARK | Paris, FRANCE | München, GERMANY |**\nMilan, ITALY | Bucharest, Iasi, Cluj, Timisoara, ROMANIA | Barcelona, SPAIN\n| Dubai, UAE | London, UK | Hague, NETHERLANDS\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "5910e58f-4bc9-4e4e-9dbb-887804094a01",
            "created_at": "2022-10-25T16:32:58.457399Z",
            "updated_at": "2022-10-25T16:32:58.457399Z",
            "deleted_at": null,
            "name": "OTX",
            "url": "https://otx.alienvault.com",
            "description": "Alienvault Open Threat Exchange (OTX)",
            "reports": null
        }
    ],
    "references": [
        "https://www.bitdefender.com/files/News/CaseStudies/study/319/Bitdefender-PR-Whitepaper-DarkNexus-creat4349-en-EN-interactive.pdf"
    ],
    "report_names": [
        "Bitdefender-PR-Whitepaper-DarkNexus-creat4349-en-EN-interactive.pdf"
    ],
    "threat_actors": [
        {
            "id": "eb3f4e4d-2573-494d-9739-1be5141cf7b2",
            "created_at": "2022-10-25T16:07:24.471018Z",
            "updated_at": "2025-03-27T02:02:10.24394Z",
            "deleted_at": null,
            "main_name": "Cron",
            "aliases": [],
            "source_name": "ETDA:Cron",
            "tools": [
                "Catelites",
                "Catelites Bot",
                "CronBot",
                "TinyZBot"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "aa73cd6a-868c-4ae4-a5b2-7cb2c5ad1e9d",
            "created_at": "2022-10-25T16:07:24.139848Z",
            "updated_at": "2025-03-27T02:02:10.120505Z",
            "deleted_at": null,
            "main_name": "Safe",
            "aliases": [],
            "source_name": "ETDA:Safe",
            "tools": [
                "DebugView",
                "LZ77",
                "OpenDoc",
                "SafeDisk",
                "TypeConfig",
                "UPXShell",
                "UsbDoc",
                "UsbExe"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "f9806b99-e392-46f1-9c13-885e376b239f",
            "created_at": "2023-01-06T13:46:39.431871Z",
            "updated_at": "2025-03-27T02:00:03.08926Z",
            "deleted_at": null,
            "main_name": "Watchdog",
            "aliases": [
                "Thief Libra"
            ],
            "source_name": "MISPGALAXY:Watchdog",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1666716494,
    "ts_updated_at": 1743041819,
    "ts_creation_date": 1585037317,
    "ts_modification_date": 1585037320,
    "files": {
        "pdf": "https://archive.orkl.eu/d66e1ed1855cd503bf2d2c07b4e608cbc2ec0a19.pdf",
        "text": "https://archive.orkl.eu/d66e1ed1855cd503bf2d2c07b4e608cbc2ec0a19.txt",
        "img": "https://archive.orkl.eu/d66e1ed1855cd503bf2d2c07b4e608cbc2ec0a19.jpg"
    }
}