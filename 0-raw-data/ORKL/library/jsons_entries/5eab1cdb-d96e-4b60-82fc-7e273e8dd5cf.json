{
    "id": "5eab1cdb-d96e-4b60-82fc-7e273e8dd5cf",
    "created_at": "2023-03-03T02:05:57.038123Z",
    "updated_at": "2025-03-27T02:16:25.47682Z",
    "deleted_at": null,
    "sha1_hash": "133faff082b406413d89901875abe4410451cb8a",
    "title": "2023-02-03 - HookBot – A New Mobile Malware",
    "authors": "",
    "file_creation_date": "2023-03-01T09:11:56Z",
    "file_modification_date": "2023-03-01T09:11:56Z",
    "file_size": 86361,
    "plain_text": "# HOOKBOT – a new mobile malware\n\n**[cebrf.knf.gov.pl/komunikaty/artykuly-csirt-knf/362-ostrzezenia/858-hookbot-a-new-mobile-malware](https://cebrf.knf.gov.pl/komunikaty/artykuly-csirt-knf/362-ostrzezenia/858-hookbot-a-new-mobile-malware)**\n\nSurveys show that more than 90% of the population now owns a mobile phone, with\nsmartphones running the Android operating system being the most popular. Criminals know\nthis and are eager to exploit this fact to steal sensitive user data, which can ultimately be\nused for financial gain. An example of this is the mobile malware known as HookBot, which\nwas discovered in January 2023 and is the subject of this article.\n\nIt all started with the identification of an advertisement claiming to sell a new mobile malware\n(Figure 1). Analysis showed that the author of the post was already responsible for other\nwell-known malware families - BlackRock and ERMAC - which were active in Polish\ncyberspace and caused losses to Polish bank customers. In view of the above, the KNF\nCSIRT team took action, acquired an application belonging to the new malware family and\nperformed its analysis. Below is a brief description of the scope of the HookBot malware, and\nat the end of the article we have included a detailed technical analysis for those who wish to\ndelve deeper into the technical aspects of its operation.\n\nFigure 1 - An advertisement posted by the author of HookBot on the criminal forum.\n\nThe HookBot Trojan is malware designed to gain access to a user's private information, such\nas passwords to online banking, email accounts, cryptocurrency wallets or popular social\nnetworking sites. In the current version of the malware in question, the creators have\nprepared a record 772 forms impersonating legitimate applications, 24 of them come from\nthe Polish domain. Among the prepared forms impersonating an application from the .pl\ndomain, we identified the following brands (Figure 2)):\n\nAllegro\nBank BPH\nBank Polskiej Spółdzielczości\nSantander Bank Polska\nCeneo\nRossmann\nEnveloBank\nEuro Bank\nFakturownia\nIdea Bank\niFirm\n\n\n-----\n\nING Bank Śląski\nmBank\nMillennium Bank\nNest Bank\nNoble Bank\nNovum Bank\nOrange Polska\nPKO BP\nRaiffeisen Bank\n\nFigure 2 - Forms impersonating applications of the .pl domain\n\nThe criminals also prepared forms for the most popular social networks (Fig. 3):\n\nFigure 3 - Examples of fake applications impersonating popular social networks\n\nThe malware also targets applications that support cryptocurrency wallets, such as:\n\nCryptopay\nMyWallet\nBitPay\n\nA full list of forms used can be found in the technical analysis report. HookBot is distributed\nby fake applications that masquerade as legitimate, often popular software. For example, the\nHookBot in question first presents itself as a Google Chrome browser (Figure 4).\n\nFigure 4 - HookBot malware masquerading as the Google Chrome application.\n\nOnce the device is infected, the malware can access system functions to track and capture\nsensitive information. Through reverse engineering, CSIRT KNF analysts have identified a\nnumber of functions that the malware can perform. One of these is what is known as\nprivilege escalation, a process by which the malware gains privileges that are not granted by\ndefault. HookBot uses so-called Accessibility Services (Figure 5) for privilege escalation.\nThese are features designed for people with dissabilities to make the device easier to use.\n\nFigure 5 - From the left: Attempted access to the Accessibility feature by malware. Privileges\ngained through privilege escalation.\n\nWhat is new compared to other malware families, even previous families from the same\ndeveloper, is the support for WhatsApp application. The malware can read, write and send\nmessages in this messenger. The process of monetising the infection takes place when the\nvictim of an infected device launches an application that is on the malware's target list. The\n\n\n-----\n\nmalware uses the system s WebView component to display a fake login page for the service\nthe user has launched (this is known as the overlay mechanism) (Figure 6). For example, if a\nbanking application is on the criminals' target list and the user who has infected his device\ndecides to open banking application, a fake login window will be displayed on top of the\noriginal application. If the user does not realise that this is not the real banking application\nand enters their credentials, it will be sent to a server controlled by the malware. If the user\nhas a SMS-based two-factor authentication mechanism, the received SMS codes can be\nread and also sent to the attackers.\n\nFigure 6 - Examples of fake overlays using bank logos\n\nThe HookBot Trojan poses a serious threat to data security and user privacy. To protect\nyourself from infection, the CSIRT KNF advises you to:\n\ndownload applications from the official Google Play store,\ncheck the permissions required by the application before installing it (this information is\navailable in the Google Play store),\ncheck which applications have been granted accessibility services and disable those\nthat are not necessary,\nupdate the software on your device regularly.\n\nBelow is a report on the technical analysis of the malware's operation. The content includes\ninformation on the details of how each component works, as well as full list of forms used to\nimpersonate legitimate applications. We encourage you to read it!\n\nClick here to download the full report:\n\n[HOOKBOT_CSIRT_KNF_ENG.pdf](https://cebrf.knf.gov.pl/images/HOOKBOT_CSIRT_KNF_ENG.pdf)\n\n[Hookbot](https://cebrf.knf.gov.pl/component/tags/tag/hookbot)\n[Malware](https://cebrf.knf.gov.pl/component/tags/tag/malware)\n[Android](https://cebrf.knf.gov.pl/component/tags/tag/android)\n[Hook](https://cebrf.knf.gov.pl/component/tags/tag/hook)\n[mobilemalware](https://cebrf.knf.gov.pl/component/tags/tag/mobilemalware)\n[malicioussoftware](https://cebrf.knf.gov.pl/component/tags/tag/malicioussoftware)\n\nCEBRF\n©2023 [Polityka Prywatności](https://cebrf.knf.gov.pl/polityka-prywatnosci)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2023/2023-02-03 - HookBot – A New Mobile Malware.pdf"
    ],
    "report_names": [
        "2023-02-03 - HookBot – A New Mobile Malware.pdf"
    ],
    "threat_actors": [
        {
            "id": "75108fc1-7f6a-450e-b024-10284f3f62bb",
            "created_at": "2024-11-01T02:00:52.756877Z",
            "updated_at": "2025-03-27T02:00:55.544216Z",
            "deleted_at": null,
            "main_name": "Play",
            "aliases": null,
            "source_name": "MITRE:Play",
            "tools": [
                "Nltest",
                "AdFind",
                "PsExec",
                "Wevtutil",
                "Cobalt Strike",
                "Playcrypt",
                "Mimikatz"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1677809157,
    "ts_updated_at": 1743041785,
    "ts_creation_date": 1677661916,
    "ts_modification_date": 1677661916,
    "files": {
        "pdf": "https://archive.orkl.eu/133faff082b406413d89901875abe4410451cb8a.pdf",
        "text": "https://archive.orkl.eu/133faff082b406413d89901875abe4410451cb8a.txt",
        "img": "https://archive.orkl.eu/133faff082b406413d89901875abe4410451cb8a.jpg"
    }
}