{
    "id": "c6af70f3-31f6-4a26-8412-035e0f6f8e1f",
    "created_at": "2023-01-12T15:03:15.314381Z",
    "updated_at": "2025-03-27T02:16:26.305421Z",
    "deleted_at": null,
    "sha1_hash": "6c2c4ccc52f64991969b3879e54ab7038c46f2aa",
    "title": "2021-06-05 - Prometheus- An Emerging Ransomware Group Using Thanos Ransomware To Target Organizations",
    "authors": "",
    "file_creation_date": "2022-05-27T23:07:48Z",
    "file_modification_date": "2022-05-27T23:07:48Z",
    "file_size": 1179553,
    "plain_text": "# Prometheus: An Emerging Ransomware Group Using Thanos Ransomware to Target Organizations\n\n**[blog.cyble.com/2021/06/05/prometheus-an-emerging-apt-group-using-thanos-ransomware-to-target-organizations/](https://blog.cyble.com/2021/06/05/prometheus-an-emerging-apt-group-using-thanos-ransomware-to-target-organizations/)**\n\nJune 5, 2021\n\nDuring our regular threat hunting operations, the Cyble Research team found a blog on\nthe darkweb, hosted by the Prometheus ransomware group. This blog is a clear indication\nof the fact that the group is back in action these days.\n\nIn the blog, the group has affiliated itself with the REvil ransomware group, as shown in\nFigure 1.\n\n_Figure 1: Prometheus Blog_\n\n\n-----\n\nBased on our research, Cyble researchers have found a sample of the Thanos ransomware\nbeing used by the Prometheus group for a recent ransomware attack. The technical\nanalysis we have performed on the file has been shared below:\n\n**TECHNICAL ANALYSIS:**\n\nThe Thanos ransomware is a 32-bit .NET executable file that is highly\nobfuscated. On decompiling it, we saw that the file has non-readable codes that made it\ndifficult to reverse the file. We used a de-obfuscation tool to read the contents\nof the file, but complete code was not de-obfuscated. While decompiling, we also found a\ndata object that contained a list of base64 encoded strings and several other plain strings.\nThese strings helped us check the possible activities performed by the ransomware.\n\nFigure 2 shows the list of base64 encoded strings.\n\n_Figure 2: Base64 Encoded Strings_\n\nApart from the base64 encoded strings, the modified\nThanos ransomware sample contained additional interesting strings related to document\nfile extensions, link file name for persistence, system information, and extensions of various\ndatabase files. On running the program, we found that only document files and database file\nextensions are being encrypted by the ransomware. Figure 3 shows the additional types and\nextracted information for selecting filetypes for encryption.\n\n\n-----\n\n_Figure 3: Strings Used for Selecting File Types._\n\nAfter finding the base64 encoded strings we de-obfuscated them and observed that the\nstrings were enumerated by the ransomware at the runtime to check the running processes,\nas shown in figure 4.\n\n_Figure 4: Processes Enumerated by the Ransomware_\n\nOur observations also indicated that the ransomware started and stopped various services\nand programs after enumerating the processes. The services started are described\nin following table:\n\n**Services** **Description**\n\nDnscache Used for client-side DNS resolution for faster DNS query.\n\nFDRsePub Makes computer and resources visible in the network.\n\nSSDPSRV Discovers networked devices.\n\nupnphost Discovering universal plug and play devices.\n\n\n-----\n\n_Table: Services Started by the Ransomware_\n\nThe services started and stopped by the Prometheus ransomware are shown in Figure\n5. The first 4 services are started by the ransomware, while the remaining are stopped.\n\n_Figure 5: Services Started and Stopped by the Ransomware._\n\nThe ransomware stops several services that are critical for various purposes. This\nincludes antivirus, system backup and restoring, database backup\nand restoring, and reporting tools. The purpose behind stopping the services is\nto block the backup and restoring operations, which has the potential to facilitate the data\nrecovery in future. Figure 6 shows additional services which are terminated.\n\n\n-----\n\n_Figure 6: Additional Services_ _Stopped_\n\nIn addition to starting and stopping services, the Thanos ransomware also uses SC (Service\nControl) command to permanently change service configuration. Figure 7 shows the\nparameters passed to SC to permanently change shared network and device services.\n\n_Figure 7: SC Changing configuration._\n\nThe ransomware also terminates multiple processes running in the system for faster\noperation using taskkill.exe. As these programs are resource intensive and can lock the flies\ntargeted by the ransomware. Some of these programs are excel.exe, steam.exe,\n\n\n-----\n\nsqlwriter.exe, thunderbird .exe, and msaccess.exe etc. The list of targeted programs is listed\nin Figure 8.\n\n_Figure 8: Processes Terminated by taskkill.exe._\n\nThis variant of the Thanos ransomware checks for various security tools used by malware\nresearchers for reversing the malware. These tools are listed below.\n\n\n-----\n\n_Figure 9: List of Security Tools_\n\nThe Thanos ransomware uses an interesting technique for obfuscation. At\nruntime, it loads the reversed base64 encoded string containing the registry\ninformation, as shown in Figure 10.\n\n_Figure 10: Obfuscation Used by the Ransomware_\n\nFor network operations, the ransomware changes the Firewall rules to open various\nports and allows outbound connection from other systems.\n\nFigure 11 shows the registry entries for allowing inbound connections on various ports.\n\n\n-----\n\n_Figure 11: Firewall Entries Edited._\n\nThe ransomware starts encryption after stopping all the\nbackup and restoring services, disabling security software, and\nchanging the network state. The modified sample of the Thanos ransomware uses the AES\nencryption technique, and after encrypting files, it appends a custom extension that is\nunique for every malware file, unlike most other ransomware that typically append\nextensions based on the system. Figure 12 shows the encrypted files with the extension.\n\n_Figure 12: Encrypted Files_\n\nWhile encrypting the files, the ransomware drops the ransom file containing the ransom note\nin hta and text format. Figures 13 and 14 show the dropped files and the ransom note.\n\n_Figure 13: Dropping Ransom Note_\n\n\n-----\n\n_Figure 14: Ransomware Note_\n\nIt is evident that more ransomware groups will emerge in the near future. Most of the time\nthese groups use existing ransomware with slight modifications for evading detections. We\nrecommend these best practices for ensuring the security of sensitive data in order\nto mitigate losses from ransomware attacks.\n\n**Indicators of Compromise (IoC):**\n\n\n-----\n\nHere s the list of sha256 of the files related to the recent Thanos ransomware attacks:\n\n**Sha256**\n\n779db1c725f71e54d4f31452763784abe783afa6a78cc222e17796b0045f33fc\n\na787997af509035b1e84f3cde7f8d62c1e02e8cc368fb95402783a0ed50f33f8\n\n3605b9af44b153ef39a5bbe6d98ab8e6ef58b1f0f1c76eca4a3fb9b9a4042605\n\nc2a01ef5115f2d41dffa1b1a697d1d05b2b9532a70552473aab36d8e4dda7928\n\nd662580e70711ba15f0bc65096a2298801ee7bc373ced3eb59582a637aeeb5fd\n\ne9388ca092c87f310a159e03d3dd97b3ce79cd6cc642a7f3b057d0fa3dcde42c\n\n5c66963cf7d417ffe475afdf18906df5c6dcd8dbbb1462918f197323dabb6f19\n\ne15f9169021b5e11381547d57a952b98e06f6366161d56083ff9be69fc43e9bf\n\nfdf8c15f27cfbf534cbc9771e3d4e42632a5993bb4b08f444111147ec540e273\n\nc76825aeaa7960e44bda9786efbcbb6e7865ef9f27fa6931e566aa44d88ad9cd\n\n27ba35dbeb5324bd780ae6a95c5aae93fcb47c5aa8f48b1c21f83000a55de2da\n\n785fdf2e6765a7b8870bd0b40d3e944536315604babfe30a7ca3466c02e411fe\n\n779db1c725f71e54d4f31452763784abe783afa6a78cc222e17796b0045f33fc\n\n2eb10ec6fa0d6d3f02a362ad5cbd55da6df47d23cfbacc3bc5a549e761cef7c8\n\nb6f774f46949d54a060dabf2d7d08eef9fd390091f419ce1a2b555bcd58b2d32\n\ne56cbdd422dda00fe75d80d0491195a3c42bade324ffebd913dcab29f741b9f6\n\n0033c6e1db4b59f95b5261ecef244981e068c765f32616b26e23eddf99986454\n\ne5211ef62f023a71cd5aa493f788198c2b97d6f79854f6e5f399893430e5ad0e\n\nef97bf49a9bd00a994143852590cc3a2d20227e510dc2b5968704d8f100b4d3c\n\n8c723af5c826adea162ef3f2e37a1cca7b43d549c9a5fab7c9ff17f65eb5d8e7\n\n9d9897d274e7a9ba3037d450dc6833c679e9ef8d125bd9d8b0329213df45b9e3\n\n9d85a74f073c4403e3a91017b6757e0368139e672498a2f84f5efaad0d1b573b\n\nba6fbc352cc9a89771ca33901729dff8d1181a76f711ab74a61fb35df3bf8a19\n\n1d4db8733c5f11ee8fca530aeb4a91069de04b1af64cbe1fa3ae2d3572a6e554\n\n\n-----\n\n1c4b55fefcd78623a6724bb6c7779d0ef02ac20a6069cb9dbd91d753386606bb\n\n48be948c3345e8c8b10c612a88eeee6bd1bf8af076092cf88268a268e889e698\n\n1136907e76399f1d76694ee9c540b387ed6a5b12340b60f3fabfc183bca457df\n\n714f630043670cdab4475971a255d836a1366e417cd0b60053bf026551d62409\n\na0e20c580e8a82f4103af90d290f762bd847fadd4eba1f5cd90e465bb9f810b7\n\ne1c46a96effc5df063cea2fae83306ae1f0e2f898b0d2ada86c48052be5fe8d3\n\n20d9efe472c01a0a23c9764db679b27a4b6a4d72e697e3508e44f218b8b952f5\n\naa3e530d4567c1511126029fac0562ba8aa4ead0a01aceea169ade3e38a37ea7\n\n83e2ba9faf075547be65d2b6dbd13e190a0b1c1cf626788cb756ab7a3c770dcb\n\n4e747c7024d9a76e22a31d38aee9408749023fc65b917c6d9ac05dd3afc3f36f\n\n9e573ba20b55f6149d801491c0ebb51c9f1c954b956a2f6cea6f18af68f0164b\n\n6e016c4d1db409b5e499289f31bcb6b87b5c46b29d4fcba4a50a7b68d733b93e\n\n8b55f596d8179b043f050f42bc7c079d07be918fe321805aff1a00f88dd8f06d\n\nb9acf82471bc22c7ce444684759d7506d407286989141028a2621a0b0f535094\n\nea55c78b15e2045f26ea39db122acb9a5cca84ba97625f444054f3efa331b386\n\n113230f881d7008fad3d62e34ce79f1b9273f604303f1b5c1450cff6481655de\n\na88db6dc88a37a79056f466c6e0878569715409c5387be4947789cc924a97b92\n\n3caa5163083177d40dd9ec2c3b84d0b37c82e2ee9807a50338af89f132a354d9\n\n5d40615701c48a122e44f831e7c8643d07765629a83b15d090587f469c77693d\n\n0cfed709f1954141a3c5a363e4e95d7e5b546ef310cfb9a63f0ca20ccc6ed152\n\n2033194ab3c2602eb9d3b31eeb5432514c423eac213f1219e5865dfee371ed58\n\na5a544ef213bc2e02937fa7e0967a4b6ba926b9f5b3485dd108e232521155bf7\n\n5fb35d559259cd85537265346901bb52083090489266608cef0a1c85de214aed\n\nad6b792c1e886156cd81586205a81aa92b9f256bd57cbcc527d194ae3f1b53d0\n\n52f7f9e8369a3e89899d40e89766c9642b137b25bfd58a2b564dac67a40445f3\n\n899f48bad035165acf8869af63922619f8a901bbeb8a7fc13919ba90dd9e7768\n\n\n-----\n\n2d3d1b83067859ebb118ff1a99ac098806b65f566df094fad9a4debef4da911d\n\nf4773540eb06fbde9a23f03424b3722999d0e6efabf5009c94c1bb0911626ada\n\nb3b1cfa71b1cc572dace69e0996d537f41632ec4bab5b1f376d66aa765928b5f\n\n67c29db79904510822a97c5e887606676c5cf77f5c31d60420d1d0ce9403daa3\n\n8d268be58a27d2c980b807ffe703ea28b0fd0cd1ba2e455902faebe9ec17c52e\n\nd7f7ea6cb92e1f01e815007fdcdf2455680e739077aff7e3eaf51311cf3388a5\n\n5eedadeabe3b12131cdbc04c7af3927bd3d09add1d0725bce5db024d5102fb96\n\n02665fcf9c0ddfb2cd3e04d254f60c5a4453947f7c3df5480316a040c0c8686f\n\nOrganizations should implement the following best practices to strengthen the security\nposture of their organization’s systems.\n\nCheck for instances of standard executables executing with the hash of another\nprocess.\nImplement multi-factor authentication (MFA), especially for privileged accounts.\nUse separate administrative accounts on different administration workstations.\nEmploy Local Administrator Password Solution (LAPS).\nAllow the least privilege to employees on data access.\nUse MFA to secure Remote Desktop Protocol (RDP) and ”jump boxes” for access.\nSecure your endpoints by deploying and maintaining endpoint defense tools.\nAlways keep all software up-to-date.\nKeep antivirus signatures and engines up-to-date.\nAvoid adding users to the local administrators’ group unless required.\nImplement a strong password policy and enforce regular password changes.\nConfigure a personal firewall on organization workstations to deny unwanted connection\nrequests.\nDeactivate unnecessary services on organization workstations and servers.\n\n**About Cyble**\n\n[Cyble is a global threat intelligence SaaS provider that helps enterprises protect](https://cyble.com/)\nthemselves from cybercrimes and exposure in the darkweb. Cyble’s prime focus is to provide\norganizations with real-time visibility into their digital risk footprint. Backed by Y Combinator\nas part of the 2021 winter cohort, Cyble has also been recognized by Forbes as one of the top\n20 Best Cybersecurity Startups To Watch In 2020. Headquartered in Alpharetta, Georgia, and\nwith offices in Australia, Singapore, and India, Cyble has a global presence. To learn more\nabout Cyble, visit [www.cyble.com.](https://cyble.com/)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-06-05 - Prometheus- An Emerging Ransomware Group Using Thanos Ransomware To Target Organizations.pdf"
    ],
    "report_names": [
        "2021-06-05 - Prometheus- An Emerging Ransomware Group Using Thanos Ransomware To Target Organizations.pdf"
    ],
    "threat_actors": [
        {
            "id": "75108fc1-7f6a-450e-b024-10284f3f62bb",
            "created_at": "2024-11-01T02:00:52.756877Z",
            "updated_at": "2025-03-27T02:00:55.544216Z",
            "deleted_at": null,
            "main_name": "Play",
            "aliases": null,
            "source_name": "MITRE:Play",
            "tools": [
                "Nltest",
                "AdFind",
                "PsExec",
                "Wevtutil",
                "Cobalt Strike",
                "Playcrypt",
                "Mimikatz"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1673535795,
    "ts_updated_at": 1743041786,
    "ts_creation_date": 1653692868,
    "ts_modification_date": 1653692868,
    "files": {
        "pdf": "https://archive.orkl.eu/6c2c4ccc52f64991969b3879e54ab7038c46f2aa.pdf",
        "text": "https://archive.orkl.eu/6c2c4ccc52f64991969b3879e54ab7038c46f2aa.txt",
        "img": "https://archive.orkl.eu/6c2c4ccc52f64991969b3879e54ab7038c46f2aa.jpg"
    }
}