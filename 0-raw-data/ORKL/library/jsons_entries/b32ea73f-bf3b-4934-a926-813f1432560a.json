{
    "id": "b32ea73f-bf3b-4934-a926-813f1432560a",
    "created_at": "2023-01-12T15:01:00.387493Z",
    "updated_at": "2025-03-27T02:06:05.952196Z",
    "deleted_at": null,
    "sha1_hash": "e77b72b9d12b7eb89e44573dbfd0f43b79885402",
    "title": "2021-08-24 - Triada Trojan in WhatsApp MOD",
    "authors": "",
    "file_creation_date": "2022-05-28T01:55:37Z",
    "file_modification_date": "2022-05-28T01:55:37Z",
    "file_size": 433126,
    "plain_text": "# Triada Trojan in WhatsApp mod\n\n**securelist.com/triada-trojan-in-whatsapp-mod/103679/**\n\n[Incidents](https://securelist.com/category/incidents/)\n\n[Incidents](https://securelist.com/category/incidents/)\n\n24 Aug 2021\n\nminute read\n\n\n-----\n\nAuthors\n\nIgor Golovin\n\nWhatsApp users sometimes feel the official app is lacking a useful feature of one sort or\nanother, be it animated themes, self-destructing messages which automatically delete\nthemselves, the option of hiding certain conversations from the main list, automatic\ntranslation of messages, or the option of viewing messages that have been deleted by the\nsender. This is where amateurs step in with modified versions of WhatsApp which offer extra\nfeatures. These mods can contain ads, usually in the form of various different banners\ndisplayed in the app. However, we discovered that the Trojan Triada snook into one of these\nmodified versions of the messenger called FMWhatsapp 16.80.0 together with the\n[advertising software development kit (SDK). This is similar to what happened with APKPure,](https://securelist.com/apkpure-android-app-store-infected/101845/)\nwhere the only malicious code that was embedded in the app was a payload downloader.\n\n**_Trojan loaded from advertising SDK_**\n\n\n-----\n\nWe detect the Trojan modification as Trojan.AndroidOS.Triada.ef.\n\n## How Triada operates\n\nOnce the app is launched, the malware gathers unique device identifiers (Device IDs,\nSubscriber IDs, MAC addresses) and the name of the app package where they’re deployed.\nThe information they collect is sent to a remote server to register the device. It responds by\nsending a link to a payload which the Trojan downloads, decrypts and launches.\n\n**_Decrypting and launching a malicious payload_**\n\nBy analyzing the statistics on files downloaded by FMWhatsapp, we identified a number of\ndifferent types of malware:\n\n[Trojan-Downloader.AndroidOS.Agent.ic (MD5: 92b5eedc73f186d5491ec3e627ecf5c0)](https://opentip.kaspersky.com/92b5eedc73f186d5491ec3e627ecf5c0/?utm_source=SL&utm_medium=SL&utm_campaign=SL)\ndownloads and launches other malicious modules.\n[Trojan-Downloader.AndroidOS.Gapac.e (MD5: 6a39493f94d49cbaaa66227c8d6db919)](https://opentip.kaspersky.com/6a39493f94d49cbaaa66227c8d6db919/?utm_source=SL&utm_medium=SL&utm_campaign=SL)\nalso downloads and launches other malicious modules. Apart from that, it displays fullscreen ads when users least expect them to pop up.\nTrojan-Downloader.AndroidOS.Helper.a (MD5: [61718a33f89ddc1781b4f43b0643ab2f)](https://opentip.kaspersky.com/61718a33f89ddc1781b4f43b0643ab2f/?utm_source=SL&utm_medium=SL&utm_campaign=SL)\n[downloads and launches the xHelper Trojan installer module. It also runs invisible ads](https://securelist.com/unkillable-xhelper-and-a-trojan-matryoshka/96487/)\nin the background to increase the number of views they get.\n[Trojan.AndroidOS.MobOk.i (MD5: fa9f9727905daec68bac37f450d139cd) signs the](https://opentip.kaspersky.com/fa9f9727905daec68bac37f450d139cd/?utm_source=SL&utm_medium=SL&utm_campaign=SL)\ndevice owner up for paid subscriptions.\n\n\n-----\n\n**_The MobOk Trojan opens the subscription page in an invisible window to click_**\n**_“subscribe” while posing as the user…_**\n\n**_…and intercepts the confirmation code to confirm the subscription_**\n\nTrojan.AndroidOS.Subscriber.l (MD5: [c3c84173a179fbd40ef9ae325a1efa15) also](https://opentip.kaspersky.com/c3c84173a179fbd40ef9ae325a1efa15/?utm_source=SL&utm_medium=SL&utm_campaign=SL)\nserves to sign victims up for premium subscriptions.\n[Trojan.AndroidOS.Whatreg.b (MD5: 4020a94de83b273f313468a1fc34f94d) signs in](https://opentip.kaspersky.com/4020a94de83b273f313468a1fc34f94d/?utm_source=SL&utm_medium=SL&utm_campaign=SL)\nWhatsapp accounts on the victim’s phone. The malware gathers information about the\nuser’s device and mobile operator, then sends it to the command and control server\n(C&C server). The server responds with an address to request a confirmation code and\nother information required to sign in. The attackers seem to have done their homework\non the protocol WhatsApp uses.\n\n\n-----\n\n**_Obtaining information for signing in_**\n\nOnce the necessary IDs have been collected, the malware requests a verification code.\n\n**_Requesting an SMS confirmation code_**\n\nIt’s worth highlighting that FMWhatsapp users grant the app permission to read their SMS\nmessages, which means that the Trojan and all the further malicious modules it loads also\ngain access to them. This allows attackers to automatically sign the victim up for premium\nsubscriptions, even if a confirmation code is required to complete the process.\n\n\n-----\n\nWe don t recommend using unofficial modifications of apps, especially WhatsApp mods. You\nmay well end up with an unwanted paid subscription, or even loose control of your account\naltogether, which attackers can hijack to use for their own purposes, such as spreading spam\nsent in your name.\n\n## IOC\n\n**MD5**\n\n[Trojan.AndroidOS.Triada.ef b1aa5d5bf39fee0b1e201d835e4dc8de](https://opentip.kaspersky.com/b1aa5d5bf39fee0b1e201d835e4dc8de/?utm_source=SL&utm_medium=SL&utm_campaign=SL)\n\n**C&C**\n\nhttp://t1k22.c8xwor[.]com:13002/\n\nhttps://dgmxn.c8xwor[.]com:13001/\n\n[Google Android](https://securelist.com/tag/google-android/)\n[Instant Messengers](https://securelist.com/tag/instant-messengers/)\n[Malware Descriptions](https://securelist.com/tag/malware-descriptions/)\n[Malware Technologies](https://securelist.com/tag/malware-technologies/)\n[Mobile Malware](https://securelist.com/tag/mobile-malware/)\n[Trojan](https://securelist.com/tag/trojan/)\n[WhatsApp](https://securelist.com/tag/whatsapp/)\n\nAuthors\n\nIgor Golovin\n\nTriada Trojan in WhatsApp mod\n\nYour email address will not be published. Required fields are marked *\n\nTable of Contents\n\nHow Triada operates\nIOC\n\nGReAT webinars\n\n\n-----\n\n13 May 2021, 1:00pm\n\n### GReAT Ideas. Balalaika Edition\n\n26 Feb 2021, 12:00pm\n17 Jun 2020, 1:00pm\n26 Aug 2020, 2:00pm\n22 Jul 2020, 2:00pm\nSubscribe to our weekly e-mails\n\nThe hottest research right in your inbox\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-08-24 - Triada Trojan in WhatsApp MOD.pdf"
    ],
    "report_names": [
        "2021-08-24 - Triada Trojan in WhatsApp MOD.pdf"
    ],
    "threat_actors": [
        {
            "id": "d8af157e-741b-4933-bb4a-b78490951d97",
            "created_at": "2023-01-06T13:46:38.748929Z",
            "updated_at": "2025-03-27T02:00:02.908256Z",
            "deleted_at": null,
            "main_name": "APT35",
            "aliases": [
                "Newscaster Team",
                "Magic Hound",
                "G0059",
                "Phosphorus",
                "Mint Sandstorm",
                "TunnelVision",
                "COBALT MIRAGE"
            ],
            "source_name": "MISPGALAXY:APT35",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "e3676dfe-3d40-4b3a-bfbd-4fc1f8c896f4",
            "created_at": "2022-10-25T15:50:23.808974Z",
            "updated_at": "2025-03-27T02:00:55.550912Z",
            "deleted_at": null,
            "main_name": "Magic Hound",
            "aliases": [
                "Magic Hound",
                "TA453",
                "COBALT ILLUSION",
                "Charming Kitten",
                "ITG18",
                "Phosphorus",
                "APT35",
                "Mint Sandstorm"
            ],
            "source_name": "MITRE:Magic Hound",
            "tools": [
                "Impacket",
                "CharmPower",
                "FRP",
                "Mimikatz",
                "Systeminfo",
                "ipconfig",
                "netsh",
                "PowerLess",
                "Pupy",
                "DownPaper",
                "PsExec",
                "Havij",
                "sqlmap"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "1699fb41-b83f-42ff-a6ec-984ae4a1031f",
            "created_at": "2022-10-25T16:07:23.83826Z",
            "updated_at": "2025-03-27T02:02:09.995863Z",
            "deleted_at": null,
            "main_name": "Magic Hound",
            "aliases": [
                "APT 35",
                "Ballistic Bobcat",
                "Charming Kitten",
                "CharmingCypress",
                "Cobalt Illusion",
                "Cobalt Mirage",
                "Educated Manticore",
                "Magic Hound",
                "Mint Sandstorm",
                "Operation BadBlood",
                "Operation Sponsoring Access",
                "Operation SpoofedScholars",
                "Operation Thamar Reservoir",
                "Phosphorus",
                "TA453",
                "TEMP.Beanie",
                "Tarh Andishan",
                "Timberworm",
                "TunnelVision",
                "UNC788",
                "Yellow Garuda"
            ],
            "source_name": "ETDA:Magic Hound",
            "tools": [
                "7-Zip",
                "AnvilEcho",
                "BASICSTAR",
                "CORRUPT KITTEN",
                "CWoolger",
                "CharmPower",
                "ChromeHistoryView",
                "CommandCam",
                "DistTrack",
                "DownPaper",
                "FRP",
                "Fast Reverse Proxy",
                "FireMalv",
                "Ghambar",
                "GoProxy",
                "GorjolEcho",
                "HYPERSCRAPE",
                "Havij",
                "MPK",
                "MPKBot",
                "Matryoshka",
                "Matryoshka RAT",
                "MediaPl",
                "Mimikatz",
                "MischiefTut",
                "NETWoolger",
                "NOKNOK",
                "PINEFLOWER",
                "POWERSTAR",
                "PowerLess Backdoor",
                "PsList",
                "Pupy",
                "PupyRAT",
                "SNAILPROXY",
                "Shamoon",
                "TDTESS",
                "WinRAR",
                "WoolenLogger",
                "Woolger",
                "pupy",
                "sqlmap"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535660,
    "ts_updated_at": 1743041165,
    "ts_creation_date": 1653702937,
    "ts_modification_date": 1653702937,
    "files": {
        "pdf": "https://archive.orkl.eu/e77b72b9d12b7eb89e44573dbfd0f43b79885402.pdf",
        "text": "https://archive.orkl.eu/e77b72b9d12b7eb89e44573dbfd0f43b79885402.txt",
        "img": "https://archive.orkl.eu/e77b72b9d12b7eb89e44573dbfd0f43b79885402.jpg"
    }
}