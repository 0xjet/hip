{
    "id": "3b748699-4c71-4b8b-a7dc-73345bfe5d57",
    "created_at": "2023-01-12T15:10:27.403617Z",
    "updated_at": "2025-03-27T02:11:18.895457Z",
    "deleted_at": null,
    "sha1_hash": "98718e7d924ccaf739433db61fcf396f736baf73",
    "title": "2019-11-28 - RevengeHotels- cybercrime targeting hotel front desks worldwide",
    "authors": "",
    "file_creation_date": "2022-05-28T02:04:28Z",
    "file_modification_date": "2022-05-28T02:04:28Z",
    "file_size": 599036,
    "plain_text": "# RevengeHotels: cybercrime targeting hotel front desks worldwide\n\n**securelist.com/revengehotels/95229/**\n\nAuthors\n\nGReAT\n\nRevengeHotels is a targeted cybercrime malware campaign against hotels, hostels,\nhospitality and tourism companies, mainly, but not exclusively, located in Brazil. We have\nconfirmed more than 20 hotels that are victims of the group, located in eight states in Brazil,\nbut also in other countries such as Argentina, Bolivia, Chile, Costa Rica, France, Italy,\nMexico, Portugal, Spain, Thailand and Turkey. The goal of the campaign is to capture credit\ncard data from guests and travelers stored in hotel systems, as well as credit card data\nreceived from popular online travel agencies (OTAs) such as Booking.com.\n\nThe main attack vector is via email with crafted Word, Excel or PDF documents attached.\nSome of them exploit CVE-2017-0199, loading it using VBS and PowerShell scripts and then\ninstalling customized versions of RevengeRAT, NjRAT, NanoCoreRAT, 888 RAT and other\ncustom malware such as ProCC in the victim’s machine. The group has been active since\n2015, but increased its attacks in 2019.\n\n\n-----\n\nIn our research, we were also able to track two groups targeting the hospitality sector, using\n[separate but similar infrastructure, tools and techniques. PaloAlto has already written about](https://unit42.paloaltonetworks.com/operation-comando-or-how-to-run-a-cheap-and-effective-credit-card-business/)\none of them. We named the first group RevengeHotels, and the second ProCC. These\ngroups use a lot of social engineering in their attacks, asking for a quote from what appears\nto be a government entity or private company wanting to make a reservation for a large\nnumber of people. Their infrastructure also relies on the use of dynamic DNS services\npointing to commercial hosting and self-hosted servers. They also sell credentials from the\naffected systems, allowing other cybercriminals to have remote access to hotel front desks\ninfected by the campaign.\n\nWe monitored the activities of these groups and the new malware they are creating for over\na year. With a high degree of confidence, we can confirm that at least two distinct groups are\nfocused on attacking this sector; there is also a third group, though it is unclear if its focus is\nsolely on this sector or if carries out other types of attacks.\n\n## Not the quotation you’re expecting\n\nOne of the tactics used in operations by these groups is highly targeted spear-phishing\nmessages. They register typo-squatting domains, impersonating legitimate companies. The\nemails are well written, with an abundance of detail. They explain why the company has\nchosen to book that particular hotel. By checking the sender information, it’s possible to\ndetermine whether the company actually exists. However, there is a small difference\nbetween the domain used to send the email and the real one.\n\n_An email sent to a hotel supposedly from an attorney’s office_\n\n\n-----\n\nThis spear-phishing message, written in Portuguese, has a malicious file attached misusing\nthe name of a real attorney office, while the domain sender of the message was registered\none day before, using a typo-squatting domain. The group goes further in its social\nengineering effort: to convince the hotel personnel about the legitimacy of their request, a\ncopy of the National Registry of Legal Entities card (CNPJ) is attached to the quotation.\n\nThe attached file, Reserva Advogados Associados.docx (Attorneys Associates\nReservation.docx), is a malicious Word file that drops a remote OLE object via template\ninjection to execute macro code. The macro code inside the remote OLE document contains\nPowerShell commands that download and execute the final payload.\n\n_PowerShell commands executed by the embedded macro_\n\nIn the RevengeHotels campaign, the downloaded files are .NET binaries protected with the\nYoda Obfuscator. After unpacking them, the code is recognizable as the commercial RAT\nRevengeRAT. An additional module written by the group called ScreenBooking is used to\ncapture credit card data. It monitors whether the user is browsing the web page. In the initial\nversions, back in 2016, the downloaded files from RevengeHotels campaigns were divided\ninto two modules: a backdoor and a module to capture screenshots. Recently we noticed\nthat these modules had been merged into a single backdoor module able to collect data\n**from clipboard and capture screenshots.**\n\nIn this example, the webpage that the attacker is monitoring is booking.com (more\nspecifically, the page containing the card details). The code is specifically looking for data in\nPortuguese and English, allowing the attackers to steal credit card data from web pages\nwritten in these languages.\n\n\n-----\n\n_Title searched by the malware in order to capture the screen contents_\n\nIn the ProCC campaigns, the downloaded files are Delphi binaries. The backdoor installed in\nthe machine is more customized than that used by RevengeHotels: it’s developed from\nscratch and is able to collect data from the clipboard and printer spooler, and capture\n**screenshots. Because the personnel in charge of confirming reservations usually need to**\npull credit card data from OTA websites, it’s possible to collect card numbers by monitoring\nthe clipboard and the documents sent to the printer.\n\n\n-----\n\n_Screenshot is captured when the user copies something to the clipboard or makes a print request_\n\n## A bad guy’s concierge\n\n\n-----\n\nAccording to the relevant underground forums and messaging groups, these criminals also\ninfect front desk machines in order to capture credentials from the hotel administration\nsoftware; they can then steal credit card details from it too. Some criminals also sell remote\naccess to these systems, acting as a concierge for other cybercriminals by giving them\npermanent access to steal new data by themselves.\n\n_Access to hotel booking systems containing credit card details is sold by criminals as a service_\n\nSome Brazilian criminals tout credit card data extracted from a hotel’s system as high quality\nand reliable because it was extracted from a trusted source, i.e., a hotel administration\nsystem.\n\n\n-----\n\n_Message sent to an underground channel selling data extracted from hotel systems_\n\n## Guests and victims\n\nThe majority of the victims are associated with the hospitality sector. Based on the routines\nused, we estimate that this attack has a global reach. However, based on our telemetry data,\nwe can only confirm victims in the following countries:\n\n\n-----\n\n_Victims confirmed in Argentina, Bolivia, Brazil, Chile, Costa Rica, France, Italy, Mexico, Portugal,_\n\n_Spain, Thailand and Turkey_\n\nBased on data extracted from Bit.ly statistics, we can see that potential victims from many\nother countries have at least accessed the malicious link. This data suggests that the\nnumber of countries with potential victims is higher than our telemetry has registered.\n\n\n-----\n\n_Victims per country based on data from a malicious Bit.ly link from the RevengeHotels campaign_\n\n## A safe stay\n\nRevengeHotels is a campaign that has been active since at least 2015, revealing different\ngroups using traditional RAT malware to infect businesses in the hospitality sector. While\nthere is a marked interest in Brazilian victims, our telemetry shows that their reach has\nextended to other countries in Latin America and beyond.\n\nThe use of spear-phishing emails, malicious documents and RAT malware is yielding\nsignificant results for at least two groups we have identified in this campaign. Other threat\nactors may also be part of this wave of attacks, though there is no confirmation at the current\ntime.\n\nIf you want to be a savvy and safe traveler, it’s highly recommended to use a virtual payment\ncard for reservations made via OTAs, as these cards normally expire after one charge. While\npaying for your reservation or checking out at a hotel, it’s a good idea to use a virtual wallet\nsuch as Apple Pay, Google Pay, etc. If this is not possible, use a secondary or less important\ncredit card, as you never know if the system at the hotel is clean, even if the rooms are…\n\nAll Kaspersky products detect this threat as:\n\nHEUR:Backdoor MSIL Revenge gen\n\n\n-----\n\nHEUR:Trojan-Downloader.MSIL.RevengeHotels.gen\nHEUR:Trojan.MSIL.RevengeHotels.gen\nHEUR:Trojan.Win32.RevengeHotels.gen\nHEUR:Trojan.Script.RevengeHotels.gen\n\n## Indicators of compromise (IoCs)\n\n**Reference hashes:**\n\n74440d5d0e6ae9b9a03d06dd61718f66\ne675bdf6557350a02f15c14f386fcc47\ndf632e25c32e8f8ad75ed3c50dd1cd47\na089efd7dd9180f9b726594bb6cf81ae\n81701c891a1766c51c74bcfaf285854b\n\nFor a full list of IoCs as well as the YARA rules and intelligence report for this campaign,\n[please visit the Kaspersky Threat Intelligence Portal: https://tip.kaspersky.com/](https://tip.kaspersky.com/)\n\n[Brazil](https://securelist.com/tag/brazil/)\n[Cyber espionage](https://securelist.com/tag/cyber-espionage/)\n[RAT Trojan](https://securelist.com/tag/rat-trojan/)\n[Spear phishing](https://securelist.com/tag/spear-phishing/)\n[Targeted attacks](https://securelist.com/tag/targeted-attacks/)\n[Vulnerabilities and exploits](https://securelist.com/tag/vulnerabilities-and-exploits/)\n\nAuthors\n\nGReAT\n\nRevengeHotels: cybercrime targeting hotel front desks worldwide\n\nYour email address will not be published. Required fields are marked *\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2019/2019-11-28 - RevengeHotels- cybercrime targeting hotel front desks worldwide.pdf"
    ],
    "report_names": [
        "2019-11-28 - RevengeHotels- cybercrime targeting hotel front desks worldwide.pdf"
    ],
    "threat_actors": [
        {
            "id": "bfae615f-cb9c-479c-b97d-ba282c322db3",
            "created_at": "2022-10-25T16:07:24.123308Z",
            "updated_at": "2025-03-27T02:02:10.115804Z",
            "deleted_at": null,
            "main_name": "RevengeHotels",
            "aliases": [],
            "source_name": "ETDA:RevengeHotels",
            "tools": [
                "888 RAT",
                "Atros2.CKPN",
                "Bladabindi",
                "Jorik",
                "Nancrat",
                "NanoCore",
                "NanoCore RAT",
                "Revenge RAT",
                "RevengeRAT",
                "Revetrat",
                "Zurten",
                "njRAT"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "aa73cd6a-868c-4ae4-a5b2-7cb2c5ad1e9d",
            "created_at": "2022-10-25T16:07:24.139848Z",
            "updated_at": "2025-03-27T02:02:10.120505Z",
            "deleted_at": null,
            "main_name": "Safe",
            "aliases": [],
            "source_name": "ETDA:Safe",
            "tools": [
                "DebugView",
                "LZ77",
                "OpenDoc",
                "SafeDisk",
                "TypeConfig",
                "UPXShell",
                "UsbDoc",
                "UsbExe"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "e819f7c1-855b-4834-b30c-493832336ddb",
            "created_at": "2022-10-25T16:07:23.939418Z",
            "updated_at": "2025-03-27T02:02:10.038419Z",
            "deleted_at": null,
            "main_name": "Operation Comando",
            "aliases": [],
            "source_name": "ETDA:Operation Comando",
            "tools": [
                "AsyncRAT",
                "Atros2.CKPN",
                "Bladabindi",
                "CapturaTela",
                "Jorik",
                "LimeRAT",
                "Nancrat",
                "NanoCore",
                "NanoCore RAT",
                "Remcos",
                "RemcosRAT",
                "Remvio",
                "Revenge RAT",
                "RevengeRAT",
                "Revetrat",
                "Socmer",
                "Zurten",
                "njRAT"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "e1e83b71-854a-4ddf-82ed-141c1d151c3c",
            "created_at": "2023-01-06T13:46:38.934536Z",
            "updated_at": "2025-03-27T02:00:02.955821Z",
            "deleted_at": null,
            "main_name": "Operation Comando",
            "aliases": [],
            "source_name": "MISPGALAXY:Operation Comando",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "31a4f4ad-1aa7-48c2-8b16-58d48879644c",
            "created_at": "2024-02-06T02:00:04.13577Z",
            "updated_at": "2025-03-27T02:00:03.32273Z",
            "deleted_at": null,
            "main_name": "RevengeHotels",
            "aliases": [],
            "source_name": "MISPGALAXY:RevengeHotels",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "b3bf17ff-3cbf-457c-8770-b038ed609993",
            "created_at": "2024-02-22T02:00:03.766129Z",
            "updated_at": "2025-03-27T02:00:03.333156Z",
            "deleted_at": null,
            "main_name": "ProCC",
            "aliases": [],
            "source_name": "MISPGALAXY:ProCC",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673536227,
    "ts_updated_at": 1743041478,
    "ts_creation_date": 1653703468,
    "ts_modification_date": 1653703468,
    "files": {
        "pdf": "https://archive.orkl.eu/98718e7d924ccaf739433db61fcf396f736baf73.pdf",
        "text": "https://archive.orkl.eu/98718e7d924ccaf739433db61fcf396f736baf73.txt",
        "img": "https://archive.orkl.eu/98718e7d924ccaf739433db61fcf396f736baf73.jpg"
    }
}