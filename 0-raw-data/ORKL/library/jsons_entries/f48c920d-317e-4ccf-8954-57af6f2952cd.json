{
    "id": "f48c920d-317e-4ccf-8954-57af6f2952cd",
    "created_at": "2022-10-25T16:48:19.157276Z",
    "updated_at": "2025-03-27T02:05:40.181287Z",
    "deleted_at": null,
    "sha1_hash": "e83519cd9b59a42d9a3f8cdbb2429c2fa8255b63",
    "title": "",
    "authors": "",
    "file_creation_date": "2018-12-07T16:50:06Z",
    "file_modification_date": "2018-12-07T16:50:06Z",
    "file_size": 2377963,
    "plain_text": "# FORMBOOK\n## In-depth malware analysis\n\n\n-----\n\n## ~/$ whoami\n\n### Rémi Jullian\n\n#### Malware Analyst at Stormshield (1+ year)\n\n Previously Intrusion Detection Engineer at ANSSI (4 years)\n\n Interested in reverse-engineering, vulnerability exploitation, threat- intelligence, software developement, ...\n\n @netsecurity1  https://blog.remijullian.fr\n\n\n-----\n\n## Agenda\n\n#### Formbook overview Anti-analysis tricks Code injection and process hollowing Userland hooks Keylogger Password harvesting C&C Network protocol\n\n\n-----\n\n## Formbook overview\n\n\n-----\n\n### Form-grabber / password-stealer\n\n#### Target 92 different applications Inject code in targeted applications in order to:\n Intercept network requests\n\n Implement a key-logger\n\n Harvest users' application passwords\n\n Take screenshots\n\n Execute C&C commands\n\n\n-----\n\n### g pp\n\n#### Web-Browsers Mail clients, FTP clients, IM apps\n\n\n-----\n\n### Malware As A Service\n\n#### Ready-to-use malware sold/rent directly by the developer\n\n Used to be sold on hackforums[.]net by 'ng-Coder' There is no builder available Customers get their own .exe and web-based panel access\n\n\n-----\n\n-----\n\n-----\n\n## Anti-analysis tricks\n\n\n-----\n\n### Strings obfuscation and encryption\n\n#### Stack-strings obfuscation Strings encryption schema\n\n\n-----\n\n### Strings hashing\n\n#### Formbook uses the BZip2 CRC32 hash function\n\n\n#### Hashes are used to:\n\n Perform dynamic import function by hash Check for blacklisted running processes Check for blacklisted loaded modules\n by module path by module name Check for blacklisted usernames Check for targeted applications\n\n\n10 0xbf0a5e41 LdrLoadDll\n11 0x2902d074 KiFastSystemCal\n12 0xf653b199 NtCreateProcess\n..\n79 0x3ebe9086 vmwareuser.exe\n80 0x4c6fddb5 vmwareservice.ex\n..\n99 0x6484bcb5 \\cuckoo\\\n100 0x11fc2f72 \\sandcastle\\\n..\n106 0xed297eae cuckoo\n107 0xa88492a6 sandbox..\n113 0xb4e1ae2 ntdll.dll\n114 0x24a48dcf guard32.dll\n115 0xe11da208 SbieDll.dll\n..\n..\n120 0x9e01fc32 iexplore.exe\n121 0x216500c2 firefox.exe\n\n\n10 0xbf0a5e41 LdrLoadDll\n11 0x2902d074 KiFastSystemCal\n12 0xf653b199 NtCreateProcess\n..\n79 0x3ebe9086 vmwareuser.exe\n80 0x4c6fddb5 vmwareservice.ex\n..\n99 0x6484bcb5 \\cuckoo\\\n100 0x11fc2f72 \\sandcastle\\\n..\n106 0xed297eae cuckoo\n107 0xa88492a6 sandbox..\n113 0xb4e1ae2 ntdll.dll\n114 0x24a48dcf guard32.dll\n115 0xe11da208 SbieDll.dll\n..\n..\n120 0x9e01fc32 iexplore.exe\n121 0x216500c2 firefox.exe\n\n\n#### List of hashes and related strings \n\n\n-----\n\n### Strings hashes recovering\n\n#### We wrote a python module named MalwareHash \n\n\nfrom malware_hash import MalwareHash\nimport binascii\n\nmh = MalwareHash(binascii.crc32) # user-defined hash func\nstring_list = mh.get_strings_by_hash(0x77ae10f7)\nprint(string_list) # ['u'wireshark.exe]\n\n\n..\n\"dump_files.net\":[\n\"a.exe\",\n\"a0380mon.exe\",\n\"a1dashboard_launcher.exe\",\n\"a1dashboard_service.exe\",\n\"a1diagnose.exe\",\n\"a2adguard.exe\",\n..\n],\n\n\n#### hash_sources.json files_net.json\n We also used FireEye's shellcode_hashes plugin\n\n\n..\n\"sandbox_tools\":[\n\"python.exe\",\n\"py.exe\",\n\"perl.exe\",\n\"ruby.exe\",\n\"joeboxserver.exe\",\n\"joeboxcontrol.exe\"\n],\n..\n\n\n-----\n\n### Data encryption\n\n#### Formbook uses 'encrypted buffers' stored in the .text section\n\n\n-----\n\n### Data encryption\n\n#### 2 decryption functions Example of encrypted buffers\n\n BZip2 CRC32 hashes' array Array of various strings Array of PE images file name The C&C server's URI x86 and x64 instructions\n\n\n-----\n\n### Manually mapping of NTDLL\n\n#### Ntdll exposes the native API used to call system services It is frequently monitored by security solutions\n Cuckoo sandbox monitors function calls with inline hooks Malware analysts set breakpoints on ntdll.dll related functions Formbook manually maps its own copy of ntdll.dll\n\n\n-----\n\n### Manually mapping of NTDLL\n\n#### Disassembly of NtAdjustPrivilegesToken (WOW64)\n\n\n#### ntdll.dll loaded by the Windows\n loader\n\n\n#### ntdll.dll manually loaded by\n Formbook\n\n\n-----\n\n### Manually mapping of NTDLL\n\n#### ntdll.dll loaded by the Windows loader\n\nBaseAddr EndAddr+1 RgnSize Type    State    Protect\n-----------------------------------------------------------------------77c30000 77c31000   1000 MEM_IMAGE  MEM_COMMIT PAGE_READONLY\n77c31000 77c40000   f000 MEM_IMAGE  MEM_RESERVE\n77c40000 77d16000  d6000 MEM_IMAGE  MEM_COMMIT PAGE_EXECUTE_READ\n77d16000 77d20000   a000 MEM_IMAGE  MEM_RESERVE\n77d20000 77d21000   1000 MEM_IMAGE  MEM_COMMIT PAGE_EXECUTE_READ\n77d21000 77d30000   f000 MEM_IMAGE  MEM_RESERVE\n77d30000 77d31000   1000 MEM_IMAGE  MEM_COMMIT PAGE_READWRITE\n77d31000 77d32000   1000 MEM_IMAGE  MEM_COMMIT PAGE_READONLY\n77d32000 77d33000   1000 MEM_IMAGE  MEM_COMMIT PAGE_READWRITE\n77d33000 77d34000   1000 MEM_IMAGE  MEM_COMMIT PAGE_WRITECOPY\n77d34000 77d39000   5000 MEM_IMAGE  MEM_COMMIT PAGE_READWRITE\n77d39000 77d40000   7000 MEM_IMAGE  MEM_RESERVE\n77d40000 77d97000  57000 MEM_IMAGE  MEM_COMMIT PAGE_READONLY\n77d97000 77da0000   9000 MEM_IMAGE  MEM_RESERVE\n77da0000 77da5000   5000 MEM_IMAGE  MEM_COMMIT PAGE_READONLY\n77da5000 77db0000   b000 MEM_IMAGE  MEM_RESERVE\n\n#### ntdll.dll manually loaded by formbook\n\n\nBaseAddr EndAddr+1 RgnSize Type    State    Protect\n-----------------------------------------------------------------------77c30000 77c31000   1000 MEM_IMAGE  MEM_COMMIT PAGE_READONLY\n77c31000 77c40000   f000 MEM_IMAGE  MEM_RESERVE\n77c40000 77d16000  d6000 MEM_IMAGE  MEM_COMMIT PAGE_EXECUTE_READ\n77d16000 77d20000   a000 MEM_IMAGE  MEM_RESERVE\n77d20000 77d21000   1000 MEM_IMAGE  MEM_COMMIT PAGE_EXECUTE_READ\n77d21000 77d30000   f000 MEM_IMAGE  MEM_RESERVE\n77d30000 77d31000   1000 MEM_IMAGE  MEM_COMMIT PAGE_READWRITE\n77d31000 77d32000   1000 MEM_IMAGE  MEM_COMMIT PAGE_READONLY\n77d32000 77d33000   1000 MEM_IMAGE  MEM_COMMIT PAGE_READWRITE\n77d33000 77d34000   1000 MEM_IMAGE  MEM_COMMIT PAGE_WRITECOPY\n77d34000 77d39000   5000 MEM_IMAGE  MEM_COMMIT PAGE_READWRITE\n77d39000 77d40000   7000 MEM_IMAGE  MEM_RESERVE\n77d40000 77d97000  57000 MEM_IMAGE  MEM_COMMIT PAGE_READONLY\n77d97000 77da0000   9000 MEM_IMAGE  MEM_RESERVE\n77da0000 77da5000   5000 MEM_IMAGE  MEM_COMMIT PAGE_READONLY\n77da5000 77db0000   b000 MEM_IMAGE  MEM_RESERVE\n\n\nBaseAddr EndAddr+1 RgnSize Type    State    Protect\n-----------------------------------------------------------------------00800000 00b03000  303000 MEM PRIVATE MEM COMMIT PAGE EXECUTE READWRITE\n\n\nBaseAddr EndAddr+1 RgnSize Type    State    Protect\n------------------------------------------------------------------------\n00800000 00b03000  303000 MEM PRIVATE MEM COMMIT PAGE EXECUTE READWRITE\n\n\n-----\n\n### Loading additional DLLs\n\n#### Empty Import Directory Table\n\n Likely suggest dynamic function importing\n\n\n-----\n\n### Dynamic function importing\n\n#### Formbook can import functions by\n\n Name Function ordinal Function name's hash (BZip2 CRC32)\n\n\n-----\n\n### WOW64 (Windows 32 bit On Windows 64 bit)\n\n#### In WOW64 mode, Windows loads 2 versions of ntdll.dll\n 32-bits from %windir%\\SysWOW64\\ 64-bits from %windir%\\System32\\\n\n ntdll.dll - 32 bits (in WOW64) ntdll.dll - 64 bits\n\n\n0:002> u ntdll!NtCreateFile\nntdll!ZwCreateFile:\n77c500a4 mov eax,52h\n77c500a9 xor ecx,ecx\n77c500ab lea edx,[esp+4]\n; fs:[0xc0] points to TEB.WOW32Reserved\n77c500af call dword ptr fs:[0C0h]\n77c500b6 add esp,4\n77c500b9 ret 2Ch\n\n\n-----\n\n### Check for WOW32Reserved hook\n\n#### Without Wow32Reserved hook With Wow32Reserved hook\n\n:000> dt ntdll!_TEB WOW32Reserved @$teb 0:000> dt ntdll!_TEB WOW32Reserved @$teb\n; Points to wow64cpu.dll (64-bit DLL) ; Points on a dynamically allocated block\n+0x0c0 WOW32Reserved : 0x74362320 Void +0x0c0 WOW32Reserved : 0x73c72320 Void\n\n:000> u 0x74362320 L1 0:000> u 0x73c72320 L1\n; Switch from x86 to x64 mode (Heaven Gate) ; Jmp on a dynamically allocated block of me\n74362320 ea1e2736743300 jmp 0033:7436271E 73c72320 e9ebdc320b   jmp 7efa0010\n\n#### Formbook checks if WOW32Reserved points to a 64-bit DLL\n\n OllyDbg Stealth64 plugin uses Wow32Reserved hooks [VB-2009-05] Use ntdll!NtQueryVirtualMemory to get the base address Check if a 64-bit DLL is mapped at the base address\n\n\n0:000> dt ntdll!_TEB WOW32Reserved @$teb\n; Points to wow64cpu.dll (64-bit DLL)\n+0x0c0 WOW32Reserved : 0x74362320 Void\n\n\n0:000> dt ntdll!_TEB WOW32Reserved @$teb\n; Points on a dynamically allocated block\n+0x0c0 WOW32Reserved : 0x73c72320 Void\n\n\n-----\n\n### Check for a debugger\n\n\n#### ntdll!NtQuerySystemInformation\n\n SystemKernelDebuggerInformation\n Ring-0 debugger ProcessDebugPort\n Ring-3 debugger\n\n\n#### Reading the PEB\n\n\ntypedef struct _PEB {\nBYTE Reserved1[2];\nBYTE BeingDebugged;\nBYTE Reserved2[1];\nPVOID Reserved3[2];\nPPEB_LDR_DATA Ldr;\n..\n..\n} PEB, *PPEB;\n\n\n-----\n\n### Check for inline hooks\n\n\n-----\n\n### Checking anti analysis tests results\n\n#### 1. WOW32 Reserved hook 2. Software debugger 3. Kernel debugger 4. Blacklisted base file name 5. Blacklisted username 6. Blacklisted username 7. Blacklisted loaded module path 8. Blacklisted loaded module path 9. Blacklisted running process 10. Blacklisted running process 11. Blacklisted loaded DLL\n\n\n-----\n\n## Code injection and process\n hollowing\n\n\n-----\n\n### Process hollowing overview\n\n#### Used to migrate to a Windows like process Formbook code is mapped in explorer.exe APC injection or thread hijacking targets explorer.exe explorer.exe creates a new (suspended) process Formbook migrates to this process\n\n\n-----\n\n#### Process hollowing schema\n\n\n7. Patch process entry point\ninstructions and resume process\n\n\nNtResumeThread()\n**3. CreateProcessInternalW()**\n**4. ret instruction to saved CONTEXT.Eip**\n**5. NtReadVirtualMemory()**\n**6. NtOpenProcess(), NtMapViewOfSection()**\n**7. NtOpenThread(), NtResumeThread()**\n\n\n-----\n\n### Process hollowing summary\n\n#### Formbook is now looking like a geniune Microsoft process It's original process has exited explorer.exe now contains formbook's code (dead code) New formbook process can now inject targeted applications\n\n\n-----\n\n### Targeted processes injection overview\n\n#### Formbook code is mapped in targeted processes Targeted processes main thread is hijacked Inline userland hooks are setup during hijacked thread execution No new thread created !\n\n\n-----\n\n4. Restore firefox's saved\n\n\n**Targeted process**\n\n\n**1. NtOpenProcess(), NtCreateSection(), NtMapViewOfSection()**\n**2. NtOpenThread(), NtSuspendThread(), NtGetThreadContext(), NtSetThreadContext(),**\n\nNtResumeThread()\n**3. NtProtectVirtualMemory()**\n**4. ret instruction to saved CONTEXT.Eip**\n\n\n-----\n\n## Userland hooks\n\n\n-----\n\n### What's a userland hook ?\n\n#### Mechanism used to hijack the control flow of targeted functions Each targeted function has its own detour function\n Targeted functions parameters can be read (and modified) Interesting targets for formbook:\n Encryption functions Networking functions Keyboard input related functions Formbook uses inline userland hooks\n\n\n-----\n\n#### Override the first bytes of targeted functions with a call\n 32-bits - call near 64-bits - mov rax, imm64; call rax Must handle targeted architecture specifications\n x86 and x64 instructions length are variable Calling convention changes between x86 and x64 Function's prologue may differ even on the same architecture\n\n WSASend - x86 PR_Write - x86\n\nWS2_32!WSASend: nss3!PR_Write:\n8bff  mov  edi,edi 55   push ebp\npush ebp 8bec  mov  ebp,esp\n8bec  mov  ebp,esp 8b4508 mov  eax,dword ptr [ebp+8]\n\n#### WSASend - x64 PR_Write - x64\n\n\nWS2_32!WSASend:\n8bff  mov  edi,edi\n55   push ebp\n8bec  mov  ebp,esp\n\n\nWS2_32!WSASend:\n48895c2408 mov qword ptr [rsp+8],rbx\n48896c2410 mov qword ptr [rsp+10h],rbp\n\n\nnss3!PR_Write:\n55   push ebp\n8bec  mov  ebp,esp\n8b4508 mov  eax,dword ptr [ebp+8]\n\n\nnss3!PR_Write:\n488b01  mov rax,qword ptr [rcx];\n48ff6018 jmp qword ptr [rax+18h]\n\n\nnss3!PR_Write:\n488b01  mov rax,qword ptr [rcx];\n48ff6018 jmp qword ptr [rax+18h]\n\n\n-----\n\n### How inline userland hooks are setup?\n\n#### 1. Retreive the virtual address of the targeted function 2. Disassemble the targeted function prologue 3. Save the instructions altered by the hook 4. Write the trampoline at the end of the detour function 5. Write the call to the detour function\n\n\n-----\n\n**nss3.dll**\n\n**_PR_Write:_**\nE8 F7 D2 E4 A5 | call formbook_detour_func\n4E       | dec esi\nFF 75 10    | push dword ptr ss:[ebp+10]\n..\n..\nC3       | retn\n\n\n4\n\n\n**Formbook section**\n\n**_formbook_hook_PR_Write_2:_**\n\n90       | nop\n50       | push eax\n8B C4     | mov  eax, esp\n60       | pusha ; save registers\n50       | push eax\nE8 11 A1 FE FF | call formbook_hook_PR_Write_3\n83 C4 04    | add  esp, 4\n61       | popa ; restore registers\n58       | pop  eax\n83 C4 04    | add  esp, 4\nC3       | retn\n..\n..\n**_formbook_hook_PR_Write_1:_**\n68 88 88 88 88 | push 0x88888888; patched value\nE9 4B E1 FF FF | jmp  formbook_hook_PR_Write_2\nC3       | retn\n..\n..\n**_formbook_detour_func:_**\n83 C4 04    | add esp, 4\nE8 7B 03 FF FF | call formbook_hook_PR_Write_1\n55       | push ebp\n8B EC     | mov ebp, esp\n8B 45 08    | mov eax, dword ptr ss:[ebp+8]\n46       | inc esi\n68 25 E1 EE  | push nss.PR_Write+5\n\ntrampoline\n\nC3 | t\n\n\n2\n\nsaved\ninstructions\n\n\n-----\n\n### Web-browsers targeted functions\n\n#### DLL Function Browser Pre-encryption\n\n secur32.dll EncryptMessage Yes\n\n\n#### wininet.dll HttpSendRequestA HttpSendRequestW InternetQueryOptionW\n\n\n#### Yes\n\n\n#### nspr4.dll PR_Write Yes\n\n nss3.dll PR_Write Yes\n\n ws2_32.dll WSASend No\n\n\n-----\n\n### Detour functions goals\n\n#### Extract credentials from intercepted network requests\n\n Search authentication keywords within hooked functions' buffer\n\n Web-browsers Mail clients, FTP clients, IM apps\n\n['pass', 'token', 'email', 'login', 'signin', ['user', 'pass', 'auth', 'login']\n'account', 'persistent']\n\n#### The entire buffer containing credentials is sent to the C&C server Extract web-browser's User-Agent value for furtive C&C requests\n\n\n\n['pass', 'token', 'email', 'login', 'signin',\n'account', 'persistent']\n\n\n-----\n\n## Keylogger\n\n\n-----\n\n### Windows Messaging System\n\n#### Messages from the window can be retreived with:\n GetMessage (blocking) PeekMessage (non-blocking)\n\n\n-----\n\n### Key-Logger implementation\n\n#### All targeted applications are beeing key-logged\n\n Functions hooked typedef struct tagMSG {\n\nHWND  hwnd;\nUINT  message;\n\n#### GetMessage WPARAM wParam;\n\nLPARAM lParam;\n\n#### PeekMessage  DWORD time;\n\nPOINT pt;\n\n#### SendMessage  DWORD lPrivate;\n\n} MSG, *PMSG, *NPMSG, *LPMSG;\n\n#### Messages filtered by detour function\n\n WM_KEYDOWN WM_SYSKEYDOWN WM_LBUTTONDOWN WM_RBUTTONDOWN\n\n\ntypedef struct tagMSG {\nHWND  hwnd;\nUINT  message; // The message identifier\nWPARAM wParam; // The virtual-key code\nLPARAM lParam;\nDWORD time;\nPOINT pt;\nDWORD lPrivate;\n} MSG, *PMSG, *NPMSG, *LPMSG;\n\n\n-----\n\n### Virtual-key to character translation\n\n#### Custom virtual-key translation\n\n Virtual-Key Character Printable string 0x1b Escape Key [Esc] 0x12 Alt key [Alt] 0x09 Tab Key [Tab] 0x0d Enter key [Enter] 0x08 Backspace key [<-Del]\n Non-special characters\n\n ToUnicode()\n\n\n-----\n\nWrites keystrokes\n\nto shared\nmemory area\n\nFormbook's\n\nthread\nrunning in\nexplorer's\n\nprocess\n\n|Col1|Same section mapped in all targeted processes and explorer's process|Col3|\n|---|---|---|\n\n\n**Explorer process**\n\n\n-----\n\n### Grabbing clipboard data\n\n#### A window uses the clipboard when cutting, copying, or pasting data Mouse clicks events are used to trigger clipboard data extraction\n WM_LBUTTONDOWN WM_RBUTTONDOWN\n\n\n-----\n\n### Key-logger and Clipboard data file\n\n#### Keylogger file Clipboard file\n Temporary stored in %APPDATA%\n\n%APPDATA%\\Roaming\\PREFIX{8}\\PREFIX{3}log.ini\n%APPDATA%\\Roaming\\PREFIX{8}\\PREFIX{3}logc.ini\n\n#### PREFIX matches regexp [a-zA-Z0-9] Derived from the username and C&C server\n\n\n%APPDATA%\\Roaming\\PREFIX{8}\\PREFIX{3}log.ini\n%APPDATA%\\Roaming\\PREFIX{8}\\PREFIX{3}logc.ini\n\n\n-----\n\n## Password harvesting\n\n\n-----\n\n### Password harvesting\n\n#### Extract password saved on the filesystem\n\n\n#### Firefox Internet Explorer Chrome Opera Thunderbird Outlook Windows Vault\n\n\nSELECT encryptedUsername, encryptedPassword,\\\nformSubmitURL FROM moz_login\n\n#### Sqlite query targeting Firefox\n\nSELECT origin_url, username_value,\\\npassword_value FROM logins\n\n#### Sqlite query targeting Chrome\n\n\nSELECT encryptedUsername, encryptedPassword,\\\nformSubmitURL FROM moz_login\n\n\n#### Browser-dumpwd project \n\n\nSELECT origin_url, username_value,\\\npassword_value FROM logins\n\n\n-----\n\n## C&C Network Protocol\n\n\n-----\n\n### C&C network protocol overview\n\n#### Formbook communicates with its C&C using HTTP requests The C&C server is implemented as a PHP web-application HTTP requests are \"hand made\" using low-level socket API Beaconing requests (GET) are used to pull C&C commands Exfiltration requests (POST) are used to send stolen data Data is encrypted using RC-4\n Key is SHA-1(http.host + http.base_uri) A formbook PCAP can be decrypted without sample \\o/\n\n\n-----\n\n### Beaconing requests\n\n#### Send by formbook's thread running within explorer's process\n\n GET parameter value after base 64 decode and decryption\n\nFBNG:C1EACBB43.8:Windows 7 Enterprise x64:YWRtaW4xMjM0\n\n#### FBNG: 4-bytes magic header C1EACBB4: CRC32 checksum of the user’s SID 3.8: Formbook version Windows 7 Enterprise x64: Operating system YWRtaW4xMjM0: base64 encoded username\n\n\n-----\n\n### C&C commands\n\n#### Specified within HTTP replies to beaconing requests Server replies 200 OK only if a task has been added with the panel\n\n C&C command in HTTP reply\n\n C&C command menu\n\n\n-----\n\n### Data exfiltration requests\n\n#### Type of exfiltrated data\n Intercepted network requests Password recoveries Keylogged data Clipboard data Screenshots\n\n POST parameter value after base 64 decode and decryption\n\ndat=[TRUNC]LNSqnAQI6omSmS~2P0[TRUNC]&un=Ym9tYmVybWFu&br=9\n\n#### dat: base 64 encoded and RC-4 encrypted payload un: base 64 encoded username br: Type of exfiltrated data / Browser id\n\n\n-----\n\n### Fake C&C servers\n\n#### Used to hide the real C&C server during sandbox analysis Randomly selected from the list of encrypted strings Reached as much as the real C&C server\n\n\n-----\n\n-----\n\n## Conclusion\n\n#### Formbook is widely spread Easily accessible by cyber-criminals Uses a lot of anti-analysis tricks Implements interesting code injection techniques Can steal users' data using various mechanisms\n\n\n-----\n\n## References\n\n#### Previous work\n\n D. Schwarz, The formidable formbook formgrabber - 09/2017 N. Villeneuve, R. Eitzman, S. Nemes, and T. Dean, Significant\n formbook distribution campaigns impacting the u.s. and south korea  10/2017\n\n\n#### IDA Python script / Formbook PCAP decoder\n\n\n####  https://github.com/ThisIsSecurity/malware/tree/master/formbook\n\n Formbook sample (3.8)\n\n Original sample Unpacked version\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "6fc23d14-23a6-4870-8fad-b291b182596f",
            "created_at": "2022-10-25T16:07:18.480113Z",
            "updated_at": "2022-10-25T16:07:18.480113Z",
            "deleted_at": null,
            "name": "ETDA",
            "url": "https://apt.etda.or.th",
            "description": "Threat Group Cards: A Threat Actor Encyclopedia",
            "reports": null
        },
        {
            "id": "bf5be533-fa31-4590-ae37-5761c97ffa34",
            "created_at": "2022-10-25T16:13:58.389257Z",
            "updated_at": "2022-10-25T16:13:58.389257Z",
            "deleted_at": null,
            "name": "Malpedia",
            "url": "https://malpedia.caad.fkie.fraunhofer.de",
            "description": "Malpedia is a free service offered by Fraunhofer FKIE",
            "reports": null
        }
    ],
    "references": [
        "https://www.botconf.eu/wp-content/uploads/2018/12/2018-R-Jullian-In-depth-Formbook-Malware-Analysis.pdf"
    ],
    "report_names": [
        "2018-R-Jullian-In-depth-Formbook-Malware-Analysis.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1666716499,
    "ts_updated_at": 1743041140,
    "ts_creation_date": 1544201406,
    "ts_modification_date": 1544201406,
    "files": {
        "pdf": "https://archive.orkl.eu/e83519cd9b59a42d9a3f8cdbb2429c2fa8255b63.pdf",
        "text": "https://archive.orkl.eu/e83519cd9b59a42d9a3f8cdbb2429c2fa8255b63.txt",
        "img": "https://archive.orkl.eu/e83519cd9b59a42d9a3f8cdbb2429c2fa8255b63.jpg"
    }
}