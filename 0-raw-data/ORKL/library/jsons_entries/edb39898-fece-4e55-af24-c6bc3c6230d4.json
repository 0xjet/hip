{
    "id": "edb39898-fece-4e55-af24-c6bc3c6230d4",
    "created_at": "2023-01-12T15:04:36.050928Z",
    "updated_at": "2025-03-27T02:15:18.889183Z",
    "deleted_at": null,
    "sha1_hash": "1bd6b3930d1614ab94be80c674465fca733fd7a6",
    "title": "2014-06-10 - Clandestine Fox, Part Deux",
    "authors": "",
    "file_creation_date": "2022-05-28T19:12:06Z",
    "file_modification_date": "2022-05-28T19:12:06Z",
    "file_size": 119145,
    "plain_text": "# Clandestine Fox, Part Deux\n\n**[fireeye.com/blog/threat-research/2014/06/clandestine-fox-part-deux.html](https://www.fireeye.com/blog/threat-research/2014/06/clandestine-fox-part-deux.html)**\n\n[We reported at the end of April and the](https://www.fireeye.com/blog/threat-research/2014/04/new-zero-day-exploit-targeting-internet-explorer-versions-9-through-11-identified-in-targeted-attacks.html) [beginning of May on an APT threat group leveraging](https://www.fireeye.com/blog/threat-research/2014/05/operation-clandestine-fox-now-attacking-windows-xp-using-recently-discovered-ie-vulnerability.html)\na zero-day vulnerability in Internet Explorer via phishing email attacks. While Microsoft\nquickly released a patch to help close the door on future compromises, we have now\nobserved the threat actors behind “Operation Clandestine Fox” shifting their point of attack\nand using a new vector to target their victims: social networking.\n\nAn employee of a company in the energy sector recently received an email with a RAR\narchive email attachment from a candidate. The attachment, ostensibly containing a resume\nand sample software program the applicant had written, was from someone we’ll call “Emily”\nwho had previously contacted the actual employee via a popular social network.\n\nFireEye acquired a copy of the suspicious email – shown below in Figure 1 – and attachment\nfrom the targeted employee and investigated. The targeted employee confirmed that\n**“Emily” had contacted him via the popular social network, and that, after three weeks**\n**of back and forth messaging “she” sent her “resume” to his personal email address.**\n\n\n-----\n\n[caption id= attachment_5658 align= aligncenter width= 441 ]\n\nFigure 1: Sample email\n\nillustrating how “Emily” attacks a victim employee[/caption]\n\nWorking our way backwards, we reviewed “Emily’s” social network profile and noticed a few\nstrange aspects that raised some red flags. For example, “her” list of contacts had a number\nof people from the victim’s same employer, as well as employees from other energy\ncompanies; “she” also did not seem to have many other “friends” that fit “her” alleged\n**persona. “Her” education history also contained some fake entries.**\n\nFurther research and discussions with the targeted company revealed that “Emily,” posing as\na prospective employee, had also contacted other personnel at the same company. She\nhad asked a variety of probing questions, including inquiring who the IT Manager was\n**and what versions of software they ran – all information that would be very useful for an**\nattacker looking to craft an attack.\n\nIt’s worth emphasizing that in the instances above, the attackers used a combination of\n**direct contact via social networks as well as contact via email, to communicate with**\ntheir intended targets and send malicious attachments. In addition, in almost all cases, the\n**attackers used the target’s personal email address, rather than his or her work**\n**address. This could be by design, with a view toward circumventing the more**\ncomprehensive email security technologies that most companies have deployed, or also due\nto many people having their social network accounts linked to their personal rather than work\nemail addresses.\n\n**Details - Email Attachment #1**\n\nThe `resume.rar archive contained three files: a weaponized version of the open-source`\nTTCalc application (a mathematical big number calculator), a benign text copy of the TTCalc\nreadme file, and a benign PDF of Emily’s resume. The resume was a nearly identical copy\nof a sample resume available elsewhere on the Internet. The file details are below.\n\n**Filename** **MD5 Hash**\n\n\nresume.rar\nresume.rar\n\nreadme.txt\nreadme.txt\n\n\n8b42a80b2df48245e45f99c1bdc2ce51\n8b42a80b2df48245e45f99c1bdc2ce51\n\n8c6dba68a014f5437c36583bbce0b7a4\n8c6dba68a014f5437c36583bbce0b7a4\n\n\n-----\n\nresume.pdf\nresume.pdf\n\nttcalc.exe\nttcalc.exe\n\n\nee2328b76c54dc356d864c8e9d05c954\nee2328b76c54dc356d864c8e9d05c954\n\ne6459971f63612c43321ffb4849339a2\ne6459971f63612c43321ffb4849339a2\n\n\nUpon execution, `ttcalc.exe drops the two files listed below, and also launches a`\nlegitimate copy of TTCalc v0.8.6 as a decoy:\n\n```\n%USERPROFILE%/Application Data/mt.dat\n\n```\n```\n%USERPROFILE%/Start Menu/Programs/Startup/vc.bat\n\n```\n\nThe file mt.dat is the actual malware executable, which we detect as\n**Backdoor.APT.CookieCutter. (Variants of this family of backdoor are also referred to as**\n“Pirpi” in the security industry). In this case, the malware was configured to use the following\nremote servers for command and control:\n```\n      swe[.]karasoyemlak[.]com\n\n```\ninform[.]bedircati[.]com (Note: This domain was also used during Operation\n**Clandestine Fox)**\n122.49.215.108\n\nMetadata for mt.dat:\n\n**Description** **MD5 Hash**\n\nmd5 md5 1a4b710621ef2e69b1f7790ae9b7a288\n1a4b710621ef2e69b1f7790ae9b7a288\n\n.text .text 917c92e8662faf96fffb8ffe7b7c80fb\n917c92e8662faf96fffb8ffe7b7c80fb\n\n.rdata .rdata 975b458cb80395fa32c9dda759cb3f7b\n975b458cb80395fa32c9dda759cb3f7b\n\n.data .data 3ed34de8609cd274e49bbd795f21acc4\n3ed34de8609cd274e49bbd795f21acc4\n\n.rsrc .rsrc b1a55ec420dd6d24ff9e762c7b753868\nb1a55ec420dd6d24ff9e762c7b753868\n\n.reloc .reloc afd753a42036000ad476dcd81b56b754\nafd753a42036000ad476dcd81b56b754\n\n\nImport Hash Import\nHash\n\n\nfad20abf8aa4eda0802504d806280dd7\nfad20abf8aa4eda0802504d806280dd7\n\n\n-----\n\nCompile date Compile\ndate\n\nContents of vc.bat:\n\n\n2014-05-27 15:48:13 2014-05-27 15:48:13\n\n\n@echo offcmd.exe /C start rundll32.exe \"C:\\Documents and Settings\\admin\\Application\nData\\mt.dat\" UpdvaMt\n\n**Details - Email Attachment #2**\n\nThrough additional research, we were able to obtain another RAR archive email attachment\nsent by the same attackers to an employee of another company. Note that while there are a\nlot of similarities, such as the fake resume and inclusion of TTCalc, there is one major\n**difference, which is the delivery of a completely different malware backdoor. The**\nattachment name this time was “my resume and `projects.rar,” but this time it was`\nprotected with the password “ TTcalc .”\n\n**Filename** **MD5 Hash**\n\n\nmy resume and projects.rar my\nresume and projects.rar\n\n\nab621059de2d1c92c3e7514e4b51751a\nab621059de2d1c92c3e7514e4b51751a\n\n\nSETUP.exe SETUP.exe 510b77a4b075f09202209f989582dbea\n510b77a4b075f09202209f989582dbea\n\nmy resume.pdf my resume.pdf d1b1abfcc2d547e1ea1a4bb82294b9a3\nd1b1abfcc2d547e1ea1a4bb82294b9a3\n```\nSETUP.exe is a self-extracting RAR, which opens the WinRAR window when executed,\n\n```\nprompting the user for the location to extract the files. It writes them to a TTCalc folder and\ntries to launch `ttcalcBAK.exe (the malware dropper), but the path is incorrect so it fails`\nwith an error message. All of the other files are benign and related to the legitimate TTCalc\napplication.\n\n**Filename** **MD5 Hash**\n\n\nCHANGELOG\nCHANGELOG\n\nCOPYRIGHT\nCOPYRIGHT\n\n\n4692337bf7584f6bda464b9a76d268c1\n4692337bf7584f6bda464b9a76d268c1\n\n7cae5757f3ba9fef0a22ca0d56188439\n7cae5757f3ba9fef0a22ca0d56188439\n\n\nREADME README 1a7ba923c6aa39cc9cb289a17599fce0\n1a7ba923c6aa39cc9cb289a17599fce0\n\nttcalc.chm ttcalc.chm f86db1905b3f4447eb5728859f9057b5\nf86db1905b3f4447eb5728859f9057b5\n\n\n-----\n\nttcalc.exe ttcalc.exe 37c6d1d3054e554e13d40ea42458ebed\n37c6d1d3054e554e13d40ea42458ebed\n\n\nttcalcBAK.exe\nttcalcBAK.exe\n\n\n3e7430a09a44c0d1000f76c3adc6f4fa\n3e7430a09a44c0d1000f76c3adc6f4fa\n\n\nThe file `ttcalcBAK.exe is also a self-extracting Rar which drops and launches`\n```\nchrome_frame_helper, which is a Backdoor.APT.Kaba (aka PlugX/Sogu) backdoor\n\n```\n**using a legitimate Chrome executable to load the malicious** **[DLL via side-loading.](https://www.fireeye.com/content/dam/fireeye-www/global/en/current-threats/pdfs/rpt-dll-sideloading.pdf)**\nAlthough this backdoor is used by multiple threat groups and is quite commonly seen these\ndays, this is the first time we've observed this particular threat group using this family\n**of malware. The malware was configured to communicate to the command and control**\ndomain `www[.]walterclean[.]com (72.52.83.195 at the time of discovery) using the`\nbinary TCP protocol only. The file details are below, followed by the malware configuration.\n\n**Filename** **MD5 Hash**\n\n\nchrome_frame_helper.dll\nchrome_frame_helper.dll\n\nchrome_frame_helper.dll.hlp\nchrome_frame_helper.dll.hlp\n\nchrome_frame_helper.exe\nchrome_frame_helper.exe\n\n\n98eb249e4ddc4897b8be6fe838051af7\n98eb249e4ddc4897b8be6fe838051af7\n\n1b57a7fad852b1d686c72e96f7837b44\n1b57a7fad852b1d686c72e96f7837b44\n\nffb84b8561e49a8db60e0001f630831f\nffb84b8561e49a8db60e0001f630831f\n\n\n**Metadata** **MD5 Hash**\n\n\nchrome_frame_helper.dll\nchrome_frame_helper.dll\n\n\n98eb249e4ddc4897b8be6fe838051af7\n98eb249e4ddc4897b8be6fe838051af7\n\n\n.text .text dfb4025352a80c2d81b84b37ef00bcd0\ndfb4025352a80c2d81b84b37ef00bcd0\n\n.rdata .rdata 4457e89f4aec692d8507378694e0a3ba\n4457e89f4aec692d8507378694e0a3ba\n\n.data .data 48de562acb62b469480b8e29821f33b8\n48de562acb62b469480b8e29821f33b8\n\n.reloc .reloc 7a7eed9f2d1807f55a9308e21d81cccd\n7a7eed9f2d1807f55a9308e21d81cccd\n\nImport hash Import hash 6817b29e9832d8fd85dcbe4af176efb6\n6817b29e9832d8fd85dcbe4af176efb6\n\nCompile date Compile date 2014-03-22 11:08:34 2014-03-22 11:08:34\n\n\n-----\n\nBackdoor.APT.Kaba Malware Configuration:\n\nPlugX Config (0x150c bytes):\n\nFlags: False True False False False False True True True True False\n\nTimer 1: 60 secs\n\nTimer 2: 60 secs\n\nC&C Address: www[.]walterclean[.]com:443 (TCP)\n\nInstall Dir: %ALLUSERSPROFILE%\\chrome_frame_helper\n\nService Name: chrome_frame_helper\n\nService Disp: chrome_frame_helper\n\nService Desc: Windows chrome_frame_helper Services\n\nOnline Pass: 1234\n\nMemo: 1234\n\n**Open Source Intel**\n\nThe domain `walterclean[.]com shares registration details with` `securitywap[.]com :`\n\nThe following domains are registered to QQ360LEE@126.COM\n\n```\nDomain: walterclean[.]com\n\n```\n```\nCreate Date: 2014-03-26 00:00:00\n\n```\n```\nRegistrar: ENOM, INC.\n\n```\n\nDomain: securitywap[.]com\n\nCreate Date: 2014-03-26 00:00:00\n\nRegistrar: ENOM, INC.\n\n**Conclusion**\n\nIn short, we attributed these attacks to the same threat actor responsible for “Operation\nClandestine Fox,” based on the following linkages:\n\nThe first-stage malware (mt.dat) is a slightly updated version of the\nBackdoor.APT.CookieCutter malware dropped during Operation Clandestine Fox\n\n\n-----\n\nBased on our intel, Backdoor.APT.CookieCutter has been used exclusively by this\nparticular threat group\nFinally, the command and control domain inform[.]bedircati[.]com seen in this activity\nwas also used during the Clandestine Fox campaign\n\nAnother evolutionary step for this threat group is that they have diversified their tool usage\nwith the use of the Kaba/PlugX/Sogu malware – something we have never seen them do\nbefore.\n\nAs we have noted in other blog posts, APT threat actors take advantage of every possible\nvector to try to gain a foothold in the organizations they target. Social networks are\nincreasingly used for both personal and business reasons, and are one more potential threat\nvector that both end-users and network defenders need to think about.\n\n**Unfortunately, it is very common for users to let their guard down when using social**\n**networks or personal email, since they don’t always treat these services with the**\n**same level of risk as their work email. As more companies allow their employees to**\ntelecommute, or even allow them to access company networks and/or resources using their\npersonal computers, these attacks targeting their personal email addresses pose significant\nrisk to the enterprise.\n\n**Acknowledgements**\n\nThe author would like to acknowledge the following colleagues for their contributions to this\nreport: Josh Dennis, Mike Oppenheim, Ned Moran, and Joshua Homan.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2014/2014-06-10 - Clandestine Fox, Part Deux.pdf"
    ],
    "report_names": [
        "2014-06-10 - Clandestine Fox, Part Deux.pdf"
    ],
    "threat_actors": [
        {
            "id": "13354d3f-3f40-44ec-b42a-3cda18809005",
            "created_at": "2022-10-25T15:50:23.275272Z",
            "updated_at": "2025-03-27T02:00:55.418075Z",
            "deleted_at": null,
            "main_name": "APT3",
            "aliases": [
                "APT3",
                "Gothic Panda",
                "Pirpi",
                "UPS Team",
                "Buckeye",
                "Threat Group-0110",
                "TG-0110"
            ],
            "source_name": "MITRE:APT3",
            "tools": [
                "OSInfo",
                "schtasks",
                "PlugX",
                "LaZagne",
                "SHOTPUT",
                "RemoteCMD"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "06f622cb-3a78-49cf-9a4c-a6007a69325f",
            "created_at": "2022-10-25T16:07:23.315239Z",
            "updated_at": "2025-03-27T02:02:09.733197Z",
            "deleted_at": null,
            "main_name": "APT 3",
            "aliases": [
                "APT 3",
                "Bronze Mayfair",
                "Buckeye",
                "Gothic Panda",
                "Group 6",
                "Operation Clandestine Fox",
                "Operation Clandestine Fox, Part Deux",
                "Operation Clandestine Wolf",
                "Operation Double Tap",
                "Red Sylvan",
                "TG-0110",
                "UPS Team"
            ],
            "source_name": "ETDA:APT 3",
            "tools": [
                "APT3 Keylogger",
                "Agent.dhwf",
                "BKDR_HUPIGON",
                "Backdoor.APT.CookieCutter",
                "Badey",
                "Bemstour",
                "CookieCutter",
                "Destroy RAT",
                "DestroyRAT",
                "DoublePulsar",
                "EXL",
                "EternalBlue",
                "HTran",
                "HUC Packet Transmit Tool",
                "Hupigon",
                "Hupigon RAT",
                "Kaba",
                "Korplug",
                "LaZagne",
                "MFC Huner",
                "OSInfo",
                "Pirpi",
                "PlugX",
                "RedDelta",
                "RemoteCMD",
                "SHOTPUT",
                "Sogu",
                "TIGERPLUG",
                "TTCalc",
                "TVT",
                "Thoper",
                "Xamtrav",
                "remotecmd",
                "shareip",
                "w32times"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535876,
    "ts_updated_at": 1743041718,
    "ts_creation_date": 1653765126,
    "ts_modification_date": 1653765126,
    "files": {
        "pdf": "https://archive.orkl.eu/1bd6b3930d1614ab94be80c674465fca733fd7a6.pdf",
        "text": "https://archive.orkl.eu/1bd6b3930d1614ab94be80c674465fca733fd7a6.txt",
        "img": "https://archive.orkl.eu/1bd6b3930d1614ab94be80c674465fca733fd7a6.jpg"
    }
}