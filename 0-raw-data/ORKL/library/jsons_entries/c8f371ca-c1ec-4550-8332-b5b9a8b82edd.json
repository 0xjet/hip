{
    "id": "c8f371ca-c1ec-4550-8332-b5b9a8b82edd",
    "created_at": "2023-05-06T02:09:54.771263Z",
    "updated_at": "2025-03-27T02:17:23.659721Z",
    "deleted_at": null,
    "sha1_hash": "fbbc27a855793e8f68fc68e024bb7ea0b3233321",
    "title": "2023-04-20 - Linux malware strengthens links between Lazarus and the 3CX supply‑chain attack",
    "authors": "",
    "file_creation_date": "2023-05-05T02:05:05Z",
    "file_modification_date": "2023-05-05T02:05:05Z",
    "file_size": 1498325,
    "plain_text": "# Linux malware strengthens links between Lazarus and the 3CX supply‑chain attack\n\n**[welivesecurity.com/2023/04/20/linux-malware-strengthens-links-lazarus-3cx-supply-chain-attack](https://www.welivesecurity.com/2023/04/20/linux-malware-strengthens-links-lazarus-3cx-supply-chain-attack)**\n\nApril 20, 2023\n\nSimilarities with newly discovered Linux malware used in Operation DreamJob corroborate the theory that the\ninfamous North Korea-aligned group is behind the 3CX supply-chain attack\n\nSimilarities with newly discovered Linux malware used in Operation DreamJob corroborate the theory that the\ninfamous North Korea-aligned group is behind the 3CX supply-chain attack\n\nESET researchers have discovered a new Lazarus Operation DreamJob campaign targeting Linux users. Operation\nDreamJob is the name for a series of campaigns where the group uses social engineering techniques to\ncompromise its targets, with fake job offers as the lure. In this case, we were able to reconstruct the full chain, from\nthe ZIP file that delivers a fake HSBC job offer as a decoy, up until the final payload: the SimplexTea Linux backdoor\n[distributed through an OpenDrive cloud storage account. To our knowledge, this is the first public mention of this](https://www.opendrive.com/)\nmajor North Korea-aligned threat actor using Linux malware as part of this operation.\n\nAdditionally, this discovery helped us confirm with a high level of confidence that the recent 3CX supply-chain attack\nwas in fact conducted by Lazarus – a link that was suspected from the very beginning and demonstrated by several\nsecurity researchers since. In this blogpost, we corroborate these findings and provide additional evidence about the\nconnection between Lazarus and the 3CX supply-chain attack.\n\n## The 3CX supply-chain attack\n\n3CX is an international VoIP software developer and distributor that provides phone system services to many\norganizations. According to its website, 3CX has more than 600,000 customers and 12,000,000 users in various\nsectors including aerospace, healthcare, and hospitality. It provides client software to use its systems via a web\nbrowser, mobile app, or a desktop application. Late in March 2023, it was discovered that the desktop application for\nboth Windows and macOS contained malicious code that enabled a group of attackers to download and run arbitrary\ncode on all machines where the application was installed. Rapidly, it was determined that this malicious code was\nnot something that 3CX added themselves, but that 3CX was compromised and that its software was used in a\nsupply-chain attack driven by external threat actors to distribute additional malware to specific 3CX customers.\n\n[This cyber-incident has made headlines in recent days. Initially reported on March 29, 2023 in a Reddit thread by ath](https://www.reddit.com/r/crowdstrike/comments/125r3uu/20230329_situational_awareness_crowdstrike/)\n[CrowdStrike engineer, followed by an official report by CrowdStrike, stating with high confidence that LABIRINTH](https://www.crowdstrike.com/blog/crowdstrike-detects-and-prevents-active-intrusion-campaign-targeting-3cxdesktopapp-customers/)\nCHOLLIMA, the company’s codename for Lazarus, was behind the attack (but omitting any evidence backing up the\nclaim). Because of the seriousness of the incident, multiple security companies started to contribute their summaries\n[of the events, namely Sophos,](https://news.sophos.com/en-us/2023/03/29/3cx-dll-sideloading-attack/) [Check Point,](https://blog.checkpoint.com/2023/03/29/3cxdesktop-app-trojanizes-in-a-supply-chain-attack-check-point-customers-remain-protected/) [Broadcom,](https://symantec-enterprise-blogs.security.com/blogs/threat-intelligence/3cx-supply-chain-attack) [Trend Micro, and more.](https://www.trendmicro.com/fr_fr/research/23/c/information-on-attacks-involving-3cx-desktop-app.html)\n\n[Further, the part of the attack affecting systems running macOS was covered in detail in a Twitter thread and a](https://twitter.com/patrickwardle/status/1641294247877021696)\n[blogpost by Patrick Wardle.](https://objective-see.org/blog/blog_0x73.html)\n\n## Timeline of events\n\n\n-----\n\n_Figure 1. Timeline of events related to the preparation and distribution of 3CX trojanized applications_\n\nThe timeline shows that the perpetrators had planned the attacks long before execution; as early as December\n2022. This suggests they already had a foothold inside 3CX’s network late last year.\n\nWhile the trojanized 3CX macOS application shows it was signed in late January, we did not see the bad application\nin our telemetry until February 14, 2023. It is unclear whether the malicious update for macOS was distributed priorth\nto that date.\n\nAlthough ESET telemetry shows the existence of the macOS second-stage payload as early as February, we did not\nhave the sample itself, nor metadata to tip us off about its maliciousness. We include this information to help\ndefenders determine how far back systems might have been compromised.\n\nSeveral days before the attack was publicly revealed, a mysterious Linux downloader was submitted to VirusTotal. It\ndownloads a new Lazarus malicious payload for Linux and we explain its relationship to the attack later in the text.\n\n## Attribution of the 3CX supply-chain attack to Lazarus\n\n### What is already published\n\nThere is one domain that plays a significant role in our attribution reasoning: journalide[.]org. It is mentioned in some\nof the vendor reports linked above, but its presence is never explained. Interestingly, articles by [SentinelOne and](https://www.sentinelone.com/blog/smoothoperator-ongoing-campaign-trojanizes-3cx-software-in-software-supply-chain-attack/)\n[ObjectiveSee do not mention this domain. Neither does a blogpost by Volexity, which even refrained from providing](https://objective-see.org/blog/blog_0x73.html)\nattribution, stating “Volexity cannot currently map the disclosed activity to any threat actor”. Its analysts were among\nthe first to investigate the attack in depth and they created a tool to extract a list of C&C servers from encrypted\nicons on GitHub. This tool is useful, as the attackers did not embed the C&C servers directly in the intermediate\nstages, but rather used GitHub as a dead drop resolver. The intermediate stages are downloaders for Windows and\nmacOS that we denote as IconicLoaders, and the payloads they get as IconicStealer and UpdateAgent, respectively.\n\n[On March 30, Joe Desimone, a security researcher from Elastic Security, was among the first to provide, in ath](https://www.elastic.co/kr/security-labs/elastic-users-protected-from-suddenicon-supply-chain-attack)\n[Twitter thread, substantial clues that the 3CX-driven compromises are probably linked to Lazarus. He observed that](https://twitter.com/dez_/status/1641459372478935040)\na shellcode stub prepended to the payload from d3dcompiler_47.dll is similar to AppleJeus loader stubs attributed to\nLazarus by [CISA back in April 2021.](https://www.cisa.gov/news-events/cybersecurity-advisories/aa21-048a)\n\n\nOn March 31 it wasst [being](https://www.cybersecuritydive.com/news/3cx-mandiant-investigate-supply-chain-attack/646543/) [reported that 3CX had retained Mandiant to provide incident response services relating](https://www.crn.com/news/security/3cx-supply-chain-attack-big-questions-remain)\nto the supply-chain attack.\n\nOn April 3,rd [Kaspersky, through its telemetry, showed a direct relationship between the 3CX supply-chain victims](https://securelist.com/gopuram-backdoor-deployed-through-3cx-supply-chain-attack/109344/)\nand the deployment of a backdoor dubbed Gopuram, both involving payloads with a common name, guard64.dll.\nKaspersky data shows that Gopuram is connected to Lazarus because it coexisted on victim machines alongside\n\n\n-----\n\n[AppleJeus, malware that was already attributed to Lazarus. Both Gopuram and AppleJeus were observed in attacks](https://securelist.com/operation-applejeus-sequel/95596/)\nagainst a cryptocurrency company.\n\n[Then, on April 11, the CISO of 3CX summarized Mandiant’s interim findings in a blogpost. According to that report,th](https://www.3cx.com/blog/news/mandiant-initial-results/)\ntwo Windows malware samples, a shellcode loader called TAXHAUL and a complex downloader named COLDCAT,\nwere involved in the compromise of 3CX. No hashes were provided, but Mandiant’s YARA rule, named TAXHAUL,\nalso triggers on other samples already on VirusTotal:\n\nSHA-1: 2ACC6F1D4656978F4D503929B8C804530D7E7CF6 (ualapi.dll),\nSHA-1: DCEF83D8EE080B54DC54759C59F955E73D67AA65 (wlbsctrl.dll)\n\nThe filenames, but not MD5s, of these samples coincide with those from Kaspersky’s blogpost. However, 3CX\nexplicitly states that COLDCAT differs from Gopuram.\n\nThe next section contains a technical description of the new Lazarus malicious Linux payload we recently analyzed,\nas well as how it helped us strengthen the existing link between Lazarus and the 3CX compromise.\n\n## Operation DreamJob with a Linux payload\n\nThe Lazarus group’s Operation DreamJob involves approaching targets through LinkedIn and tempting them with\n[job offers from industry leaders. The name was coined by ClearSky in a paper published in August 2020. That paper](https://www.clearskysec.com/operation-dream-job/)\ndescribes a Lazarus cyberespionage campaign targeting defense and aerospace companies. The activity has\noverlap with what we call Operation In(ter)ception, a series of cyberespionage attacks that have been ongoing since\nat least [September 2019. It targets aerospace, military, and defense companies and uses specific malicious, initially](https://www.welivesecurity.com/wp-content/uploads/2020/06/ESET_Operation_Interception.pdf)\nWindows-only, tools. During July and August 2022, we found two instances of Operation In(ter)ception targeting\n[macOS. One malware sample was submitted to VirusTotal from Brazil, and another attack targeted an ESET user in](https://twitter.com/ESETresearch/status/1559553324998955010)\nArgentina. A few weeks ago, a native Linux payload was found on VirusTotal with an HSBC-themed PDF lure. This\ncompletes Lazarus’s ability to target all major desktop operating systems.\n\n\nOn March 20, a user in the country of Georgia submitted to VirusTotal a ZIP archive called HSBC job offer.pdf.zip.th\nGiven other DreamJob campaigns by Lazarus, this payload was probably distributed through spearphishing or direct\nmessages on LinkedIn. The archive contains a single file: a native 64-bit Intel Linux binary written in Go and named\nHSBC job offer․pdf.\n\n[Interestingly, the file extension is not .pdf. This is because the apparent dot character in the filename is a leader dot](https://en.wikipedia.org/wiki/Leader_(typography))\nrepresented by the U+2024 Unicode character. The use of the leader dot in the filename was probably an attempt to\ntrick the file manager into treating the file as an executable instead of a PDF. This could cause the file to run when\ndouble-clicked instead of opening it with a PDF viewer. On execution, a decoy PDF is displayed to the user using\n[xdg-open, which will open the document using the user’s preferred PDF viewer (see Figure 3). We decided to call](https://portland.freedesktop.org/doc/xdg-open.html)\nthis ELF downloader OdicLoader, as it has a similar role as the IconicLoaders on other platforms and the payload is\nfetched from OpenDrive.\n\nOdicLoader drops a decoy PDF document, displays it using the system’s default PDF viewer (see Figure 2), and\n[then downloads a second-stage backdoor from the OpenDrive cloud service. The downloaded file is stored in](https://www.opendrive.com/)\n~/.config/guiconfigd (SHA-1: 0CA1723AFE261CD85B05C9EF424FC50290DCE7DF). We call this second-stage\nbackdoor SimplexTea.\n\nAs the last step of its execution, the OdicLoader modifies ~/.bash_profile, so SimplexTea is launched with Bash and\nits output is muted (~/.config/guiconfigd >/dev/null 2>&1).\n\n\n-----\n\n_Figure 2. Illustration of the probable chain of compromise_\n\n\n-----\n\n_Figure 3. An HSBC-themed lure in the Linux DreamJob campaign_\n\nSimplexTea is a Linux backdoor written in C++. As highlighted in Table 1, its class names are very similar to function\nnames found in a sample, with filename sysnetd, submitted to VirusTotal from Romania (SHA-1:\nF6760FB1F8B019AF2304EA6410001B63A1809F1D). Because of the similarities in class names and function\nnames between SimplexTea and sysnetd, we believe SimplexTea is an updated version, rewritten from C to C++.\n\n_Table 1. Comparison of the original symbol names from two Linux backdoors submitted to VirusTotal_\n\n\n-----\n\nguiconfigd\n\n(SimplexTea for Linux, from Georgia)\n\n\nsysnetd\n\n(BADCALL for Linux, from Romania)\n\n\nCMsgCmd::Start(void) **MSG_Cmd**\n\nCMsgSecureDel::Start(void) **MSG_Del**\n\nCMsgDir::Start(void) **MSG_Dir**\n\nCMsgDown::Start(void) **MSG_Down**\n\nCMsgExit::Start(void) **MSG_Exit**\n\nCMsgReadConfig::Start(void) **MSG_ReadConfig**\n\nCMsgRun::Start(void) **MSG_Run**\n\nCMsgSetPath::Start(void) **MSG_SetPath**\n\nCMsgSleep::Start(void) **MSG_Sleep**\n\nCMsgTest::Start(void) **MSG_Test**\n\nCMsgUp::Start(void) **MSG_Up**\n\nCMsgWriteConfig::Start(void) **MSG_WriteConfig**\n\n**MSG_GetComInfo**\n\nCMsgHibernate::Start(void)\n\nCMsgKeepCon::Start(void)\n\nCMsgZipDown::Start(void)\n\nCMsgZip::StartZip(void *)\n\nCMsgZip::Start(void)\n\nCHttpWrapper::RecvData(uchar *&,uint *,uint,signed char)\n\nRecvMsg\n\nCHttpWrapper::SendMsg(_MSG_STRUCT *) **SendMsg**\n\nCHttpWrapper::SendData(uchar *,uint,uint)\n\nCHttpWrapper::SendMsg(uint,uint,uchar *,uint,uint)\n\nCHttpWrapper::SendLoginData(uchar *,uint,uchar *&,uint *)\n\nHow is sysnetd related to Lazarus? The following section shows similarities with Lazarus’s Windows backdoor called\nBADCALL.\n\n### BADCALL for Linux\n\nWe attribute sysnetd to Lazarus because of its similarities with the following two files (and we believe that sysnetd is\na Linux variant of the group’s backdoor for Windows called BADCALL):\n\nP2P_DLL.dll (SHA-1: 65122E5129FC74D6B5EBAFCC3376ABAE0145BC14), which shows code similarities to\nsysnetd in the form of domains used as a front for fake TLS connection (see Figure 4). It was attributed to\nLazarus by CISA in [December 2017. From](https://web.archive.org/web/20220124183620/https:/www.cisa.gov/uscert/sites/default/files/publications/MAR-10135536-B_WHITE.PDF) [September 2019, CISA started to call newer versions of this](https://www.cisa.gov/news-events/analysis-reports/ar19-252a)\nmalware BADCALL (SHA 1: D288766FA268BC2534F85FD06A5D52264E646C47)\n\n\n-----\n\n_Figure 4. Similarities between a Windows and a Linux variant of BADCALL (a list of domains used as a front for a fake TLS_\n\n_connection)_\n\nprtspool (SHA-1: 58B0516D28BD7218B1908FB266B8FE7582E22A5F), which shows code similarities to\nsysnetd (see Figure 5). It was attributed to Lazarus by [CISA in February 2021. Note as well that SIMPLESEA,](https://www.cisa.gov/uscert/ncas/analysis-reports/ar21-048e)\n[a macOS backdoor found during the 3CX incident response, implements the A5/1 stream cipher.](https://en.wikipedia.org/wiki/A5/1)\n\n_Figure 5. Similarities between AppleJeus for macOS and the Linux variant of BADCALL (the key for the A5/1 stream cipher)_\n\nThis Linux version of the BADCALL backdoor, sysnetd, loads its configuration from a file named /tmp/vgauthsvclog.\nSince Lazarus operators have previously disguised their payloads, the use of this name, which is used by the\nVMware Guest Authentication service, suggests that the targeted system may be a Linux VMware virtual machine.\nInterestingly, the XOR key in this case is the same as one used in SIMPLESEA from the 3CX investigation.\n\n\n-----\n\n_Figure 6. Loading a configuration file by BADCALL for Linux, cf. Figure 8_\n\nTaking a look at the three 32-bit integers, 0xC2B45678, 0x90ABCDEF, and 0xFE268455 from Figure 5, which\nrepresent a key for a custom implementation of the A5/1 cipher, we realized that the same algorithm and the\nidentical keys were used in Windows malware that dates back to the end of 2014 and was involved in one of the\nmost notorious Lazarus cases: the cybersabotage of Sony Pictures Entertainment (SHA-1:\n1C66E67A8531E3FF1C64AE57E6EDFDE7BEF2352D).\n\n_Figure 7. The decryption routine shared between the BADCALL for Linux and targeted destructive malware for Windows from_\n\n_2014_\n\n### Additional attribution data points\n\nTo recap what we’ve covered so far, we attribute the 3CX supply-chain attack to the Lazarus group with a high level\nof confidence. This is based on the following factors:\n\n\n-----\n\n1. Malware (the intrusion set):\n\n1. The IconicLoader (samcli.dll) uses the same type of strong encryption – AES-GCM – as SimplexTea\n\n(whose attribution to Lazarus was established via the similarity with BALLCALL for Linux); only the keys\nand initialization vectors differ.\n2. Based on the PE Rich Headers, both IconicLoader (samcli.dll) and IconicStealer (sechost.dll) are\n\nprojects of a similar size and compiled in the same Visual Studio environment as the executables\niertutil.dll (SHA-1: 5B03294B72C0CAA5FB20E7817002C600645EB475) and iertutil.dll (SHA-1:\n7491BD61ED15298CE5EE5FFD01C8C82A2CDB40EC) reported in the Lazarus cryptocurrency\n[campaigns by Volexity and](https://www.volexity.com/blog/2022/12/01/buyer-beware-fake-cryptocurrency-applications-serving-as-front-for-applejeus-malware/) [Microsoft. We include below the YARA rule](https://www.microsoft.com/en-us/security/blog/2022/12/06/dev-0139-launches-targeted-attacks-against-the-cryptocurrency-industry/)\nRichHeaders_Lazarus_NukeSped_IconicPayloads_3CX_Q12023, which flags all these samples, and no\nunrelated malicious or clean files, as tested on the current ESET databases and recent VirusTotal\nsubmissions.\n3. SimplexTea payload loads its configuration in a very similar way to the SIMPLESEA malware from the\n\n3CX official incident response. The XOR key differs (0x5E vs. 0x7E), but the configuration bears the\nsame name: apdl.cf (see Figure 8).\n\n_Figure 8. Loading a configuration file by SimplexTea for Linux, cf. Figure 6_\n\n1. Infrastructure:\n\n1. There is shared network infrastructure with SimplexTea, as it uses https://journalide[.]org/djour.php as it\n\n[C&C, whose domain is reported in the official results of the incident response of the 3CX compromise by](https://www.3cx.com/blog/news/mandiant-initial-results/)\nMandiant.\n\n\n-----\n\n_Figure 9. A hardcoded URL in SimplexTea for Linux_\n\n\n## Conclusion\n\nThe 3CX compromise has gained a lot of attention from the security community since its disclosure on March 29 .th\nThis compromised software, deployed on various IT infrastructures, which allows the download and execution of any\nkind of payload, can have devastating impacts. Unfortunately, no software publisher is immune to being\ncompromised and inadvertently distributing trojanized versions of their applications.\n\n\nThe stealthiness of a supply-chain attack makes this method of distributing malware very appealing from an\n[attacker’s perspective. Lazarus has already used this technique in the past, targeting South Korean users of](https://www.welivesecurity.com/2020/11/16/lazarus-supply-chain-attack-south-korea/)\nWIZVERA VeraPort software in 2020. Similarities with existing malware from the Lazarus toolset and with the\ngroup’s typical techniques strongly suggest the recent 3CX compromise is the work of Lazarus as well.\n\nIt is also interesting to note that Lazarus can produce and use malware for all major desktop operating systems:\nWindows, macOS, and Linux. Both Windows and macOS systems were targeted during the 3CX incident, with\n3CX’s VoIP software for both operating systems being trojanized to include malicious code to fetch arbitrary\npayloads. In the case of 3CX, both Windows and macOS second-stage malware versions exist. This article\ndemonstrates the existence of a Linux backdoor that probably corresponds to the SIMPLESEA macOS malware\nseen in the 3CX incident. We named this Linux component SimplexTea and showed that it is part of Operation\nDreamJob, Lazarus’s flagship campaign using job offers to lure and compromise unsuspecting victims.\n\n_For any inquiries about our research published on WeLiveSecurity, please contact us at_ _[threatintel@eset.com.](mailto:threatintel@eset.com?utm_source=welivesecurity.com&utm_medium=referral&utm_campaign=autotagging&utm_content=eset-research&utm_term=en)_\n_ESET Research offers private APT intelligence reports and data feeds. For any inquiries about this service, visit_\n_the_ _[ESET Threat Intelligence page.](https://www.eset.com/int/business/services/threat-intelligence/?utm_source=welivesecurity.com&utm_medium=referral&utm_campaign=wls-research&utm_content=linux-malware-strengthens-links-lazarus-3cx-supply-chain-attack)_\n\n## IoCs\n\n### Files\n\n\n**SHA-1** **Filename**\n\n\n**ESET detection**\n**name** **Description**\n\n\n0CA1723AFE261CD85B05C9EF424FC50290DCE7DF guiconfigd Linux/NukeSped.E SimplexTea\nfor Linux.\n\n\n-----\n\n**SHA-1** **Filename**\n\n\n**ESET detection**\n**name** **Description**\n\n\n3A63477A078CE10E53DFB5639E35D74F93CEFA81 HSBC_job_offer․pdf Linux/NukeSped.E OdicLoader,\na 64-bit\ndownloader\nfor Linux,\nwritten in\nGo.\n\n9D8BADE2030C93D0A010AA57B90915EB7D99EC82 HSBC_job_offer.pdf.zip Linux/NukeSped.E A ZIP\narchive with\na Linux\npayload,\nfrom\nVirusTotal.\n\nF6760FB1F8B019AF2304EA6410001B63A1809F1D sysnetd Linux/NukeSped.G BADCALL\nfor Linux.\n\n### Network\n\n\n**First**\n**seen** **Details**\n\n\n**IP address** **Domain**\n\n\n**Hosting**\n**provider**\n\n\n23.254.211[.]230 N/A Hostwinds LLC. N/A C&C server for BADCALL for Linux\n\n\n38.108.185[.]79\n\n38.108.185[.]115\n\n\nod[.]lk Cogent\nCommunications\n\n\n202303-16\n\n202303-29\n\n\nRemote OpenDrive storage containing\nSimplexTea (/d/NTJfMzg4MDE1NzJf/vxmedia)\n\nC&C server for SimplexTea (/djour.php)\n\n\n172.93.201[.]88 journalide[.]org Nexeon\nTechnologies,\nInc.\n\n## MITRE ATT&CK techniques\n\n\n**Tactic** **ID** **Name** **Description**\n\n\nReconnaissance [T1593.001](https://attack.mitre.org/versions/v12/techniques/T1593/001/) Search Open Websites/Domains:\nSocial Media\n\n\nLazarus attackers probably\napproached a target with a fake\nHSBC-themed job offer that\nwould fit the target’s interest. This\nhas been done mostly via\nLinkedIn in the past.\n\n\nResource\nDevelopment\n\n\n[T1584.001](https://attack.mitre.org/versions/v12/techniques/T1583/001/) Acquire Infrastructure: Domains Unlike many previous cases of\ncompromised C&Cs used in\nOperation DreamJob, Lazarus\noperators registered their own\ndomain for the Linux target.\n\n\n[T1587.001](https://attack.mitre.org/versions/v12/techniques/T1587/001/) Develop Capabilities:\nMalware\n\n[T1585.003](https://attack.mitre.org/techniques/T1585/003/) Establish Accounts:\nCloud Accounts\n\n[T1608.001](https://attack.mitre.org/techniques/T1608/001/) Stage Capabilities:\nUpload Malware\n\n\nCustom tools from the attack are\nvery likely developed by the\nattackers.\n\nThe attackers hosted the final\nstage on the cloud service\nOpenDrive.\n\nThe attackers hosted the final\nstage on the cloud service\nOpenDrive.\n\n\n-----\n\n**Tactic** **ID** **Name** **Description**\n\nExecution [T1204.002](https://attack.mitre.org/techniques/T1204/002/) User Execution: Malicious File OdicLoader masquerades as a\nPDF file in order to fool the\ntarget.\n\nInitial Access [T1566.002](https://attack.mitre.org/versions/v12/techniques/T1566/002/) Phishing: Spearphishing Link The target likely received a link to\nthird-party remote storage with a\nmalicious ZIP archive, which was\nlater submitted to VirusTotal.\n\n\nPersistence [T1546.004](https://attack.mitre.org/techniques/T1546/004/) Event Triggered Execution: Unix\nShell Configuration Modification\n\n\nOdicLoader modifies the victim’s\nBash profile, so SimplexTea is\nlaunched each time Bash is\nstared and its output is muted.\n\nSimplexTea can create a new\nprocess, if instructed by its C&C\nserver.\n\n\nDefense\nEvasion\n\n\n[T1134.002](https://attack.mitre.org/versions/v12/techniques/T1134/002/) Access Token Manipulation:\nCreate Process with Token\n\n\n[T1140](https://attack.mitre.org/versions/v11/techniques/T1140/) Deobfuscate/Decode\nFiles or Information\n\n[T1027.009](https://attack.mitre.org/versions/v12/techniques/T1027/009/) Obfuscated Files or\nInformation:\nEmbedded Payloads\n\n[T1562.003](https://attack.mitre.org/versions/v12/techniques/T1562/003/) Impair Defenses:\nImpair Command\nHistory Logging\n\n[T1070.004](https://attack.mitre.org/versions/v12/techniques/T1070/004/) Indicator Removal:\nFile Deletion\n\n[T1497.003](https://attack.mitre.org/versions/v12/techniques/T1497/003/) Virtualization/Sandbox\nEvasion: Time Based\nEvasion\n\n\nSimplexTea stores its\nconfiguration in an encrypted\napdl.cf.\n\nThe droppers of all malicious\nchains contain an embedded data\narray with an additional stage.\n\nOdicLoader modifies the victim’s\nBash profile, so the output and\nerror messages from SimplexTea\nare muted. SimplexTea executes\nnew processes with the same\ntechnique.\n\nSimplexTea has the ability to\ndelete files securely.\n\nSimplexTea implements multiple\ncustom sleep delays in its\nexecution.\n\n\nDiscovery [T1083](https://attack.mitre.org/versions/v12/techniques/T1083/) File and Directory Discovery SimplexTea can list the directory\ncontent together with their\nnames, sizes, and timestamps\n(mimicking the ls -la command).\n\n\nCommand and\nControl\n\n\n[T1071.001](https://attack.mitre.org/versions/v12/techniques/T1071/001/) Application Layer Protocol: Web\nProtocols\n\n\nSimplexTea can use HTTP and\nHTTPS for communication with\nits C&C server, using a statically\nlinked Curl library.\n\n\n[T1573.001](https://attack.mitre.org/versions/v11/techniques/T1573/001/) Encrypted Channel:\nSymmetric\nCryptography\n\n[T1132.001](https://attack.mitre.org/versions/v11/techniques/T1132/001/) Data Encoding:\nStandard Encoding\n\n\nSimplexTea encrypts C&C traffic\nusing the AES-GCM algorithm.\n\nSimplexTea encodes C&C traffic\nusing base64.\n\n\n[T1090](https://attack.mitre.org/techniques/T1090/) Proxy SimplexTea can utilize a proxy for\ncommunications.\n\nExfiltration [T1041](https://attack.mitre.org/versions/v12/techniques/T1041/) Exfiltration Over C2 Channel SimplexTea can exfiltrate data as\nZIP archives to its C&C server.\n\n\n-----\n\n## Appendix\n\nThis YARA rule flags the cluster containing both IconicLoader and IconicStealer, as well as the payloads deployed in\nthe cryptocurrency campaigns from December 2022.\n\n\n1\n\n2\n\n3\n\n4\n\n5\n\n6\n\n7\n\n8\n\n9\n\n10\n\n11\n\n12\n\n13\n\n14\n\n15\n\n16\n\n17\n\n18\n\n19\n\n20\n\n21\n\n\n/*\n\nThe following rule will only work with YARA version >= 3.11.0\n\n*/\n\nimport \"pe\"\n\nrule RichHeaders_Lazarus_NukeSped_IconicPayloads_3CX_Q12023\n\n{\n\nmeta:\n\ndescription = \" Rich Headers-based rule covering the IconicLoader and IconicStealer from the 3CX supply\nchain incident, and also payloads from the cryptocurrency campaigns from 2022-12\"\n\nauthor = \"ESET Research\"\n\ndate = \"2023-03-31\"\n\nhash = \"3B88CDA62CDD918B62EF5AA8C5A73A46F176D18B\"\n\nhash = \"CAD1120D91B812ACAFEF7175F949DD1B09C6C21A\"\n\nhash = \"5B03294B72C0CAA5FB20E7817002C600645EB475\"\n\nhash = \"7491BD61ED15298CE5EE5FFD01C8C82A2CDB40EC\"\n\ncondition:\n\npe.rich_signature.toolid(259, 30818) == 9 and\n\npe.rich_signature.toolid(256, 31329) == 1 and\n\npe.rich_signature.toolid(261, 30818) >= 30 and pe.rich_signature.toolid(261, 30818) <= 38 and\n\npe.rich_signature.toolid(261, 29395) >= 134 and pe.rich_signature.toolid(261, 29395) <= 164 and\n\npe.rich_signature.toolid(257, 29395) >= 6 and pe.rich_signature.toolid(257, 29395) <= 14\n\n}\n\n\n-----\n\n20 Apr 2023 11:30AM\n\n### Sign up to receive an email update whenever a new article is published in our Ukraine Crisis – Digital Security Resource Center\n\n Newsletter\n\n Discussion\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2023/2023-04-20 - Linux malware strengthens links between Lazarus and the 3CX supply‑chain attack.pdf"
    ],
    "report_names": [
        "2023-04-20 - Linux malware strengthens links between Lazarus and the 3CX supply‑chain attack.pdf"
    ],
    "threat_actors": [
        {
            "id": "32a223a8-3c79-4146-87c5-8557d38662ae",
            "created_at": "2022-10-25T15:50:23.703698Z",
            "updated_at": "2025-03-27T02:00:55.528031Z",
            "deleted_at": null,
            "main_name": "Lazarus Group",
            "aliases": [
                "Lazarus Group",
                "Labyrinth Chollima",
                "HIDDEN COBRA",
                "Guardians of Peace",
                "NICKEL ACADEMY",
                "Diamond Sleet"
            ],
            "source_name": "MITRE:Lazarus Group",
            "tools": [
                "RawDisk",
                "Proxysvc",
                "BADCALL",
                "FALLCHILL",
                "WannaCry",
                "HOPLIGHT",
                "TYPEFRAME",
                "Dtrack",
                "HotCroissant",
                "HARDRAIN",
                "Dacls",
                "KEYMARBLE",
                "TAINTEDSCRIBE",
                "AuditCred",
                "netsh",
                "ECCENTRICBANDWAGON",
                "AppleJeus",
                "BLINDINGCAN",
                "ThreatNeedle",
                "Volgmer",
                "Cryptoistic",
                "RATANKBA",
                "Bankshot",
                "Torisma",
                "Mimikatz"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "9e767b38-12ae-4ef7-9878-5ce1701066d7",
            "created_at": "2024-05-01T02:03:08.131819Z",
            "updated_at": "2025-03-27T02:05:17.413497Z",
            "deleted_at": null,
            "main_name": "NICKEL ACADEMY",
            "aliases": [
                "COVELLITE ",
                "CTG-2460 ",
                "Diamond Sleet ",
                "Guardians of Peace",
                "HIDDEN COBRA ",
                "High Anonymous",
                "Labyrinth Chollima ",
                "NNPT Group",
                "New Romanic Cyber Army Team",
                "Temp.Hermit ",
                "The Lazarus Group ",
                "UNC577 ",
                "Who Am I?",
                "Whois Team",
                "ZINC ",
                "Black Artemis "
            ],
            "source_name": "Secureworks:NICKEL ACADEMY",
            "tools": [
                " DarkMessenger",
                " Destover",
                " Duuzer",
                " HOPLIGHT",
                " Joanap",
                " KorHigh",
                " LiveJinx",
                " Volgmer",
                "Brambul"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "8bc1a044-a23b-4904-903c-13f463605cb3",
            "created_at": "2024-05-01T02:03:08.136237Z",
            "updated_at": "2025-03-27T02:05:17.415795Z",
            "deleted_at": null,
            "main_name": "NICKEL GLADSTONE",
            "aliases": [
                "Bluenoroff ",
                "CTG-6459 ",
                "Citrine Sleet ",
                "HIDDEN COBRA ",
                "Lazarus Group",
                "Sapphire Sleet ",
                "Stardust Chollima ",
                "APT38 "
            ],
            "source_name": "Secureworks:NICKEL GLADSTONE",
            "tools": [
                " Bankshot",
                " CATCH22",
                " CCGC_Proxy",
                " Cur1Agent",
                " Ratankba",
                " Server_TrafficForwarder",
                " Wcry",
                "AlphaNC"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "a2b92056-9378-4749-926b-7e10c4500dac",
            "created_at": "2023-01-06T13:46:38.430595Z",
            "updated_at": "2025-03-27T02:00:02.831633Z",
            "deleted_at": null,
            "main_name": "Lazarus Group",
            "aliases": [
                "Operation DarkSeoul",
                "APT38",
                "ATK117",
                "DEV-1222",
                "G0032",
                "APT 38",
                "Stardust Chollima",
                "APT-C-26",
                "ATK3",
                "Diamond Sleet",
                "Hidden Cobra",
                "Unit 121",
                "Subgroup: Bluenoroff",
                "NICKEL GLADSTONE",
                "DEV-0139",
                "Andariel",
                "Operation Troy",
                "COVELLITE",
                "TA404",
                "Lazarus group",
                "Dark Seoul",
                "G0082",
                "NewRomanic Cyber Army Team",
                "Bluenoroff",
                "Appleworm",
                "Nickel Academy",
                "COPERNICIUM",
                "Hastati Group",
                "Bureau 121",
                "Operation AppleJeus",
                "Whois Hacking Team",
                "Citrine Sleet",
                "Sapphire Sleet",
                "Group 77",
                "Labyrinth Chollima",
                "Operation GhostSecret",
                "BeagleBoyz"
            ],
            "source_name": "MISPGALAXY:Lazarus Group",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "f32df445-9fb4-4234-99e0-3561f6498e4e",
            "created_at": "2022-10-25T16:07:23.756373Z",
            "updated_at": "2025-03-27T02:02:09.966155Z",
            "deleted_at": null,
            "main_name": "Lazarus Group",
            "aliases": [
                "APT-C-26",
                "ATK 3",
                "Appleworm",
                "Citrine Sleet",
                "DEV-0139",
                "Diamond Sleet",
                "Gleaming Pisces",
                "Gods Apostles",
                "Gods Disciples",
                "Group 77",
                "Guardians of Peace",
                "Hastati Group",
                "Hidden Cobra",
                "ITG03",
                "Jade Sleet",
                "Labyrinth Chollima",
                "Lazarus Group",
                "NewRomanic Cyber Army Team",
                "Operation 99",
                "Operation AppleJeus",
                "Operation AppleJeus sequel",
                "Operation Blockbuster: Breach of Sony Pictures Entertainment",
                "Operation CryptoCore",
                "Operation Dream Job",
                "Operation Dream Magic",
                "Operation Flame",
                "Operation GhostSecret",
                "Operation In(ter)caption",
                "Operation LolZarus",
                "Operation Marstech Mayhem",
                "Operation No Pineapple!",
                "Operation North Star",
                "Operation Phantom Circuit",
                "Operation Sharpshooter",
                "Operation Ten Days of Rain / DarkSeoul",
                "Operation Troy",
                "SectorA01",
                "Slow Pisces",
                "TA404",
                "TraderTraitor",
                "UNC2970",
                "UNC4034",
                "UNC4736",
                "UNC4899",
                "UNC577",
                "Whois Hacking Team"
            ],
            "source_name": "ETDA:Lazarus Group",
            "tools": [
                "3CX Backdoor",
                "3Rat Client",
                "3proxy",
                "AIRDRY",
                "ARTFULPIE",
                "ATMDtrack",
                "AlphaNC",
                "Alreay",
                "Andaratm",
                "AngryRebel",
                "AppleJeus",
                "Aryan",
                "AuditCred",
                "BADCALL",
                "BISTROMATH",
                "BLINDINGCAN",
                "BTC Changer",
                "BUFFETLINE",
                "BanSwift",
                "Bankshot",
                "Bitrep",
                "Bitsran",
                "BlindToad",
                "Bookcode",
                "BootWreck",
                "BottomLoader",
                "Brambul",
                "BravoNC",
                "Breut",
                "COLDCAT",
                "COPPERHEDGE",
                "CROWDEDFLOUNDER",
                "Castov",
                "CheeseTray",
                "CleanToad",
                "ClientTraficForwarder",
                "CollectionRAT",
                "Concealment Troy",
                "Contopee",
                "CookieTime",
                "Cyruslish",
                "DAVESHELL",
                "DBLL Dropper",
                "DLRAT",
                "DRATzarus",
                "DRATzarus RAT",
                "Dacls",
                "Dacls RAT",
                "DarkComet",
                "DarkKomet",
                "DeltaCharlie",
                "DeltaNC",
                "Dembr",
                "Destover",
                "DoublePulsar",
                "Dozer",
                "Dtrack",
                "Duuzer",
                "DyePack",
                "ECCENTRICBANDWAGON",
                "ELECTRICFISH",
                "Escad",
                "EternalBlue",
                "FALLCHILL",
                "FYNLOS",
                "FallChill RAT",
                "Farfli",
                "Fimlis",
                "FoggyBrass",
                "FudModule",
                "Fynloski",
                "Gh0st RAT",
                "Ghost RAT",
                "Gopuram",
                "HARDRAIN",
                "HIDDEN COBRA RAT/Worm",
                "HLOADER",
                "HOOKSHOT",
                "HOPLIGHT",
                "HOTCROISSANT",
                "HOTWAX",
                "HTTP Troy",
                "Hawup",
                "Hawup RAT",
                "Hermes",
                "HotCroissant",
                "HotelAlfa",
                "Hotwax",
                "HtDnDownLoader",
                "Http Dr0pper",
                "ICONICSTEALER",
                "Joanap",
                "Jokra",
                "KANDYKORN",
                "KEYMARBLE",
                "Kaos",
                "KillDisk",
                "KillMBR",
                "Koredos",
                "Krademok",
                "LIGHTSHIFT",
                "LIGHTSHOW",
                "LOLBAS",
                "LOLBins",
                "Lazarus",
                "LightlessCan",
                "Living off the Land",
                "MATA",
                "MBRkiller",
                "MagicRAT",
                "Manuscrypt",
                "Mimail",
                "Mimikatz",
                "Moudour",
                "Mydoom",
                "Mydoor",
                "Mytob",
                "NACHOCHEESE",
                "NachoCheese",
                "NestEgg",
                "NickelLoader",
                "NineRAT",
                "Novarg",
                "NukeSped",
                "OpBlockBuster",
                "PCRat",
                "PEBBLEDASH",
                "PLANKWALK",
                "POOLRAT",
                "PSLogger",
                "PhanDoor",
                "Plink",
                "PondRAT",
                "PowerBrace",
                "PowerRatankba",
                "PowerShell RAT",
                "PowerSpritz",
                "PowerTask",
                "Preft",
                "ProcDump",
                "Proxysvc",
                "PuTTY Link",
                "QUICKRIDE",
                "QUICKRIDE.POWER",
                "Quickcafe",
                "QuiteRAT",
                "R-C1",
                "ROptimizer",
                "Ratabanka",
                "RatabankaPOS",
                "Ratankba",
                "RatankbaPOS",
                "RawDisk",
                "RedShawl",
                "Rifdoor",
                "Rising Sun",
                "Romeo-CoreOne",
                "RomeoAlfa",
                "RomeoBravo",
                "RomeoCharlie",
                "RomeoCore",
                "RomeoDelta",
                "RomeoEcho",
                "RomeoFoxtrot",
                "RomeoGolf",
                "RomeoHotel",
                "RomeoMike",
                "RomeoNovember",
                "RomeoWhiskey",
                "Romeos",
                "RustBucket",
                "SHADYCAT",
                "SHARPKNOT",
                "SIGFLIP",
                "SIMPLESEA",
                "SLICKSHOES",
                "SORRYBRUTE",
                "SUDDENICON",
                "SUGARLOADER",
                "SheepRAT",
                "SierraAlfa",
                "SierraBravo",
                "SierraCharlie",
                "SierraJuliett-MikeOne",
                "SierraJuliett-MikeTwo",
                "SimpleTea",
                "SimplexTea",
                "SmallTiger",
                "Stunnel",
                "TAINTEDSCRIBE",
                "TAXHAUL",
                "TFlower",
                "TOUCHKEY",
                "TOUCHMOVE",
                "TOUCHSHIFT",
                "TOUCHSHOT",
                "TWOPENCE",
                "TYPEFRAME",
                "Tdrop",
                "Tdrop2",
                "ThreatNeedle",
                "Tiger RAT",
                "TigerRAT",
                "Trojan Manuscript",
                "Troy",
                "TroyRAT",
                "VEILEDSIGNAL",
                "VHD",
                "VHD Ransomware",
                "VIVACIOUSGIFT",
                "VSingle",
                "ValeforBeta",
                "Volgmer",
                "Vyveva",
                "W1_RAT",
                "Wana Decrypt0r",
                "WanaCry",
                "WanaCrypt",
                "WanaCrypt0r",
                "WannaCry",
                "WannaCrypt",
                "WannaCryptor",
                "WbBot",
                "Wcry",
                "Win32/KillDisk.NBB",
                "Win32/KillDisk.NBC",
                "Win32/KillDisk.NBD",
                "Win32/KillDisk.NBH",
                "Win32/KillDisk.NBI",
                "WinorDLL64",
                "Winsec",
                "WolfRAT",
                "Wormhole",
                "YamaBot",
                "Yort",
                "ZetaNile",
                "concealment_troy",
                "http_troy",
                "httpdr0pper",
                "httpdropper",
                "klovbot",
                "sRDI"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1683338994,
    "ts_updated_at": 1743041843,
    "ts_creation_date": 1683252305,
    "ts_modification_date": 1683252305,
    "files": {
        "pdf": "https://archive.orkl.eu/fbbc27a855793e8f68fc68e024bb7ea0b3233321.pdf",
        "text": "https://archive.orkl.eu/fbbc27a855793e8f68fc68e024bb7ea0b3233321.txt",
        "img": "https://archive.orkl.eu/fbbc27a855793e8f68fc68e024bb7ea0b3233321.jpg"
    }
}