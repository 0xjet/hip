{
    "id": "1bbb7578-4a4f-4365-beb7-39039482f259",
    "created_at": "2023-01-12T15:02:43.573243Z",
    "updated_at": "2025-03-27T02:05:42.388477Z",
    "deleted_at": null,
    "sha1_hash": "01a0999db73efb515831628b933260cbe9348f61",
    "title": "2007-12-16 - Pushdo - Analysis of a Modern Malware Distribution System",
    "authors": "",
    "file_creation_date": "2022-05-28T19:54:48Z",
    "file_modification_date": "2022-05-28T19:54:48Z",
    "file_size": 205860,
    "plain_text": "# Pushdo - Analysis of a Modern Malware Distribution System\n\n**secureworks.com/research/pushdo**\n\nJoe Stewart\n\n**Author: Joe Stewart**\n**Date: December 16, 2007**\n\n\n-----\n\n[Recently, Sophos published a blog entry detailing the trouble they are having with the Pushdo](http://www.sophos.com/security/blog/2007/12/876.html)\n**trojan, a fairly new and prolific threat being circulated in fake \"E-card\" emails. From their**\ndescription, it is clear that the author(s) of Pushdo are making a concerted effort to spread\ntheir malware far and wide. But what exactly is Pushdo, and how does it work? We decided to\ntake a closer look at this malware family.\n\n**Pushdo is usually classified as a \"downloader\" trojan - meaning its true purpose is to**\ndownload and install additional malicious software. There are dozens of downloader trojan\nfamilies out there, but Pushdo is actually more sophisticated than most, but that sophistication\nlies in the Pushdo control server rather than the trojan.\n\nWhen executed, Pushdo reports back to one of several control server IP addresses embedded\nin it code. The server listens on TCP port 80, and pretends to be an Apache webserver. Any\nrequest that doesn't have the correct URL format will be answered with the following content.\n\nThe [Bender Bending Rodriguez text is simply misdirection to mask the true nature of the server](http://en.wikipedia.org/wiki/Bender_(Futurama))\n\n- if the HTTP request contains the following parameters, one or more executables will be\ndelivered via HTTP.\n\n\n-----\n\nThe malware to be downloaded by Pushdo depends on the value following the s-underscore\npart of the URL. The Pushdo controller is preloaded with multiple executable files - the one we\nlooked at contained 421 different malware samples ready to be delivered. The Pushdo\ncontroller also uses the GeoIP geolocation database in conjunction with whitelists and\nblacklists of country codes. This enables the Pushdo author to limit distribution of any one of\nthe malware loads from infecting users located in a particular country, or provides the ability to\ntarget a specfic country or countries with a specific payload.\n\nPushdo keeps track of the IP address of the victim, whether or not that person is an\nadministator on the computer, their primary hard drive serial number (obtained by\nSMART_RCV_DRIVE_DATA IO control code), whether the filesystem is NTFS, how many\ntimes the victim system has executed a Pushdo variant, and the Windows OS version as\nreturned by the GetVersionEx API call.\n\nThe use of the physical hard drive serial number as a identifier is interesting - it not only\nprovides a unique ID for the infected system, but can also reveal information such as whether\nthe code is running in a virtual machine or not. For instance, a VMware system might return a\nserial number of \"00000000000000000001\" or simply \"00\", which is very easily spotted in a list\nof serial numbers of major hard drive vendors. This could be a way for the malware author to\nspy on anti-virus companies using automated tools to monitor the malware download points.\n\nAs another anti-anti-malware function, Pushdo will look at the names of all running processes\nand compare them to the following list of anti-virus and personal firewall process names:\n\navp.exe\nArmor2net.exe\nkpf4ss.exe\nblackd.exe\nPXAgent.exe\nipfsrv.exe\nsafensec.exe\nmcagent.exe\nmpsevh.exe\nmcuimgr.exe\nmcpromgr.exe\nmcusrmgr.exe\nmcupdmgr.exe\nmclogsrv.exe\nmctskshd.exe\nNPFSVICE.exe\noutpost.exe\nsymlcsvc.exe\nsspfwtry2.exe\nvsmon.exe\n\n\n-----\n\nxcommsvr.exe\nvsserv.exe\nlivesrv.exe\ndrweb32w.exe\nnod32krn.exe\nPAVFNSVR.exe\nPAVSRV51.exe\n\nInstead of killing off these processes, as many other trojans/viruses attempt to do, Pushdo\nmerely reports back to the controller which ones are running, by appending \"proc=\" and a list of\nthe matching process names to the HTTP request parameters. This type of reconaissance is\nuseful when determining which anti-virus engines or firewalls are preventing the malware from\nrunning or phoning home, by their absence from the statistics. This way the Pushdo author\ndoesn't have to maintain a test environment for each AV/firewall product.\n\nMost of the 421 malware samples from the Pushdo controller we examined were either the\nWigon rootkit or the Cutwail spam trojan, however the following other trojans were being\nserved by the controller:\n\nPRG/Wsnpoem\nPSW.LdPinch.NEL\nTrojanDownloader.Agent.NPQ\nAgent.AIA\nBHO.NAT\nRustock.NBK\nTrojanDownloader.Small.NYK\n\nThe large proportion of Cutwail/Wigon leads us to believe the same group is behind all three\nmalware families. The Wigon rootkit is dropped onto the system when Pushdo is first executed,\nand is used to hide the Pushdo process and any subsequent malware that Pushdo might\ndownload.\n\nIt is able to determine which processes to hide by looking for a specific byte at a predetermined\noffset of the PE header. Cutwail also seems to share some similar code/programming\ntechniques (as well as the use of the Wigon rootkit) with Pushdo. For instance, the use of\nenvironment variables to determine system paths, rather than more canonical Win32 API calls.\nThis programming approach may also indicate the author of Pushdo (and Cutwail and Wigon)\nis more at home with Unix-like operating systems than Win32 platforms, although clearly\nhe/she has proficiency on both.\n\n\n-----\n\nThe fact that other malware families are being distributed using the Pushdo system suggests\nthat the author is also willing to take payments from other malware authors in return for use of\nhis distribution channel. Such arrangements are becoming more and more common, as\nparticipants in the malware economy seek out niches in which to provide services in the\nunderground marketplace.\n\nThe Pushdo controller is remotely administered using a custom protocol over the HTTP\nchannel. An administrator connects using the same URL that an infected system might, except\nthe version parameter is set to a predetermined key. At that point the following commands can\nbe issued over the TCP channel:\n\n**STAT (gets the server status)**\n**TRCK (dump the statistics log)**\n**CARG (upload a new malware payload database)**\n**FLTR (upload a new whitelist/blacklist filter database)**\n**FINA (end session)**\n\nAs we were writing this analysis, we received an e-card email containing a newer variant of\nPushdo. Apparently taking notice that the Bleeding Snort project had published a signature (sid\n2006377) to detect the Pushdo request variables in transit, the author has now changed the\nrequest to be less fingerprintable. An example of the new request format is:\n\nGET\n/40e800142020202057202d4443574d414c393635393438366c0000003c66000000007600000002\nHTTP/1.0\n\nThe length of the request will likely change between different service pack levels of Windows.\nIDS/IPS signatures can still be written around such a request, taking advantage of the fact that\nno other HTTP headers are sent as one characteristic to key in on. However, even with this\napproach, false positives may still occur.\n\nClearly the author of Pushdo is intent on evading detection for as long as possible, in order to\nhave the maximum amount of time to seed Cutwail spambots into the wild. Although it is\nunclear just how large the Cutwail botnet has become, the ambition of the project rivals that of\n[other more well-known spam botnets, such as Storm. Only time will tell if it will rival Storm in](https://www.secureworks.com/research/storm-worm)\nsize as well.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2003 - 2009/2007-12-16 - Pushdo - Analysis of a Modern Malware Distribution System.pdf"
    ],
    "report_names": [
        "2007-12-16 - Pushdo - Analysis of a Modern Malware Distribution System.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673535763,
    "ts_updated_at": 1743041142,
    "ts_creation_date": 1653767688,
    "ts_modification_date": 1653767688,
    "files": {
        "pdf": "https://archive.orkl.eu/01a0999db73efb515831628b933260cbe9348f61.pdf",
        "text": "https://archive.orkl.eu/01a0999db73efb515831628b933260cbe9348f61.txt",
        "img": "https://archive.orkl.eu/01a0999db73efb515831628b933260cbe9348f61.jpg"
    }
}