{
    "id": "c6dce710-182f-4635-a1b0-3af318964aed",
    "created_at": "2023-01-12T15:03:01.620331Z",
    "updated_at": "2025-03-27T02:16:37.166626Z",
    "deleted_at": null,
    "sha1_hash": "08c32124f6c48acbb344a689575454728cf0f8e7",
    "title": "2018-11-16 - Return to ROKRAT!! (feat. FAAAA...Sad...)",
    "authors": "",
    "file_creation_date": "2022-05-29T01:38:29Z",
    "file_modification_date": "2022-05-29T01:38:29Z",
    "file_size": 768767,
    "plain_text": "# Return to ROKRAT!! (feat. FAAAA...Sad...) 본문\n\n**v3lo.tistory.com/24**\n\nvelocy November 16, 2018\n\n## Simple Analysis blog\n\n**[Analysis](http://v3lo.tistory.com/category/Analysis)**\n\n### Return to ROKRAT!! (feat. FAAAA...Sad...)\n\nvelocy 2018. 11. 16. 15:42\n\n2018-11-16, VirusTotal에 \"※ 기 록 부.hwp\" 라는 이름의 한글파일이 헌팅되었다.\n\n2018-11-16, VirusTotal has hunted a HWP file named \"※ 기 록 부.hwp\".\n\n해당 한글파일은 RedEyes, 스카크러프트 그룹의 ROKRAT 라고 알려진 유형의 악성코드로\n추정된다.\n\nThe Korean file is estimated to be a malicious code of the type known as the ROKRAT of the\nScraft group.\n\n- RedEyes, Scarcruft : 한국의 유명기관이나 정치단체를 대상으로 데이터 탈취와 파괴를 모\n두 수행하는 공격 그룹\n\n\n-----\n\nRedEyes, Scarcruft: Attack group that performs data capture and destruction on famous\ninstitutions or political groups in Korea\n\n\"※ 기 록 부.hwp\" 파일를 열어보면 의미없는 값들로 채워져 있음을 볼 수 있다.\n\nWhen you open the \"※ 기 록 부.hwp\" file, you can see that it is filled with meaningless\nvalues.\n\n위 한글파일은 \"BIN0001.eps\" 를 이용하여 악성코드를 인젝션 한다.\n\nInject malicious code using \"BIN0001.eps\".\n\n\n-----\n\n%APPDATA% 경로에 \"Pemnn01.hje01\", \"Pemnn02.hje01\" 파일을 생성하여 두 파일을 합쳐\n\"MemoryOrder85584031.com\" 파일로 생성한다.\n\nCreate \"Pemn01.hje01\" \"Pnn02.hje01\" file in the %APPDATA% path and combine the two\nfiles to create the \"MemoryOrder85584031.com\" file.\n\n\n-----\n\n생성된 파일에서는 cmd.exe에 Thread Injection을 시도하며, 이때 xor 복호화된 바이너리가 사\n용된다.\n\nThe generated file has a try Thread Injection on cmd.exe, and xor decryt binary is used.\n\nXor key : 0x4A\n\n\n-----\n\n이후 인젝션 되는 악성코드는 이전 [\"ROKRAT is BACK\" 에서](http://v3lo.tistory.com/21) 분석한 내용과 동일하다.\n\n[The injected malicious code is the same as the previous analysis of \"ROKRAT is BACK\".](http://v3lo.tistory.com/21)\n\n\n-----\n\n해당 샘플에서 사용되는 Token 값은\n\"tgaNZQXaLAwmirSFZfdPhI7ZCC8LqqvoBSkBdhfC5Fzw1SFeOr70\" 이며, 이전 악성코드와\n샌드박스, 가상환경일 경우 재부팅되어 MBR이 파괴된다.\n\nThe Token value used in the sample is\n\"tgaNZQXaLAwmirSFZfdPhI7ZCC8LqqvoBSkBdhfC5Fzw1SFeOr70\".\n\nIn case of previous malicious code, sandbox, or virtual environment, the MBR is destroyed\nby rebooting.\n\n\n-----\n\n[추가]\n\n현재 alyac에서는 해당 케이스를 [Operation KoreanSword 라고](http://blog.alyac.co.kr/1985) 명명함.\n\nCurrently, alyac calls the case [Operation EnglishSword.](http://blog.alyac.co.kr/1985)\n\n\n-----\n\n**[IOC]**\n\n[HWP File]\n\nFileName :\n\nAuthor : (주)한글과컴퓨터\n\nLast Saved By : User1\n\nCreate Time/Data : 2004-11-26 06:23:46.535000 (UTC)\n\nLast saved Time/Data : 2018-11-16 02:54:41.390000 (UTC)\n\nMD5 : 804a8c076b4aaa2e21ab4f06453d1c4e\n\nSHA-1: 35eda3c7aedcfaa69e4b2ad0f613eb587a519960\n\nSHA-256: d0cac300272954919538888c2e8b2be81113a60fa0bbb1d4a5a0a0367037050e\n\n[Drop File]\n\nFilename : %APPDATA%\\\\MemoryOrder85584031.com\n\nTimeStamp : 2018-11-14 15:47:51 (UTC)\n\nMD5: 80a2a804e12ad9c039c3de1466fac46f\n\n[Injection File]\n\nTimeStamp : 2018-11-07 07:06:11 (UTC)\n\nMD5: fb80235fbf92da08bc8bcddd241c3d42\n\nToken: tgaNZQXaLAwmirSFZfdPhI7ZCC8LqqvoBSkBdhfC5Fzw1SFeOr70\n\n**[Similar malware]**\n\n\n-----\n\n[HWP File]\n\nFileName : 7주 신뢰와 배려의 커뮤니케이션.hwp\n\nAuthor : gichang\n\nLast Saved By : User1\n\nCreate Time/Data : 2014-02-2613:45:17.799000 (UTC)\n\nLast saved Time/Data : 2018-08-29 00:22:26.729000 (UTC)\n\nMD5 : 3f92afe96b4cfd41f512166c691197b5\n\nSHA-1: eeae06fc31982f992993ef0ff12e2d94981d9bff\n\nSHA-256: 51e35a7a4e2c49670ecfba7b55045cfa893aa1459246fa5b23ff0bba91225b76\n\n[Decoded File (Themida)]\n\nFilename : %APPDATA%\\\\WinUpdate148399843\n\nTimeStamp : 2018-08-28 01:22:27 (UTC)\n\nMD5: 6ec89edfffdb221a1edbc9852a9a567a\n\nSHA-1: 52976314913289a61282ee1f172a30cce29147ac\n\nSHA-256: 98498b97b7cdce9dd6b1a83057e47bd74dc2be5bb12f42ce505981bff093de73\n\n[Injection File]\n\nTimeStamp : 2018-08-28 01:13:58 (UTC)\n\nMD5: 7a751874ea5f9c95e8f0550a0b93902d\n\nSHA-1: 41a3e61adf853edaddc999e547a246cc4c173480\n\nSHA-256: f885c37b3368faf2ae11d70e15aa75a641de9357dda038d875fe5513d9841582\n\n\n-----\n\ntoken: VdZhAhd9YXAAAAAAAAAACQaGEx0mpQnzlWKtxGGNveuPx0XtDTzynRk4fnra19E\n\n**Thank's to kino, savNi**\n\nReferences\n\nCopyright 2018. (YEJUN KIM) all rights reserved.\n\nCopyright 2018. (YEJUN KIM) All pictures cannot be copied without permission.\n\n[저작자표시비영리변경금지](https://creativecommons.org/licenses/by-nc-nd/4.0/deed.ko)\n\n**['Analysis' 카테고리의](http://v3lo.tistory.com/category/Analysis)** 다른 글\n\n**[Return to Satan, Lucky Ransomware (0)](http://v3lo.tistory.com/26?category=679037)** 2018.12.11\n\n**[We will become back very soon! ;) (0)](http://v3lo.tistory.com/25?category=679037)** 2018.12.05\n\n**[Return to ROKRAT!! (feat. FAAAA...Sad...) (1)](http://v3lo.tistory.com/24?category=679037)** 2018.11.16\n\n**[GandCrab & (CoinMining??) (1)](http://v3lo.tistory.com/23?category=679037)** 2018.11.09\n\n**[Are you VenusLocker? or GandCrab? (1)](http://v3lo.tistory.com/22?category=679037)** 2018.10.22\n\n**[ROKRAT is Back!! (0)](http://v3lo.tistory.com/21?category=679037)** 2018.09.21\n\n**1 Comments**\n\n갱주 2018.11.19 09:00 님 좀 쩌는듯\n\n댓글쓰기 폼\n\n[Prev](http://v3lo.tistory.com/25) [1](http://v3lo.tistory.com/29) [2](http://v3lo.tistory.com/28) [3](http://v3lo.tistory.com/27) [4](http://v3lo.tistory.com/26) [5](http://v3lo.tistory.com/25) 6 [7](http://v3lo.tistory.com/23) [8](http://v3lo.tistory.com/22) [9](http://v3lo.tistory.com/21) [Next](http://v3lo.tistory.com/23)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2018/2018-11-16 - Return to ROKRAT!! (feat. FAAAA...Sad...).pdf"
    ],
    "report_names": [
        "2018-11-16 - Return to ROKRAT!! (feat. FAAAA...Sad...).pdf"
    ],
    "threat_actors": [
        {
            "id": "bbe36874-34b7-4bfb-b38b-84a00b07042e",
            "created_at": "2022-10-25T15:50:23.375277Z",
            "updated_at": "2025-03-27T02:00:55.457787Z",
            "deleted_at": null,
            "main_name": "APT37",
            "aliases": [
                "APT37",
                "InkySquid",
                "ScarCruft",
                "Group123",
                "TEMP.Reaper",
                "Ricochet Chollima"
            ],
            "source_name": "MITRE:APT37",
            "tools": [
                "BLUELIGHT",
                "CORALDECK",
                "KARAE",
                "SLOWDRIFT",
                "ROKRAT",
                "SHUTTERSPEED",
                "POORAIM",
                "HAPPYWORK",
                "Final1stspy",
                "Cobalt Strike",
                "NavRAT",
                "DOGCALL",
                "WINERACK"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "552ff939-52c3-421b-b6c9-749cbc21a794",
            "created_at": "2023-01-06T13:46:38.742547Z",
            "updated_at": "2025-03-27T02:00:02.906537Z",
            "deleted_at": null,
            "main_name": "APT37",
            "aliases": [
                "ScarCruft",
                "Venus 121",
                "Moldy Pisces",
                "Group 123",
                "APT 37",
                "Group123",
                "Operation Daybreak",
                "Operation Erebus",
                "Red Eyes",
                "TA-RedAnt",
                "InkySquid",
                "Reaper Group",
                "Ricochet Chollima",
                "ATK4",
                "G0067"
            ],
            "source_name": "MISPGALAXY:APT37",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "f0bccc3d-ad77-49c4-8dfd-8a8a8d6fba26",
            "created_at": "2024-05-01T02:03:08.134022Z",
            "updated_at": "2025-03-27T02:05:17.415028Z",
            "deleted_at": null,
            "main_name": "NICKEL FOXCROFT",
            "aliases": [
                "Group 123 ",
                "Moldy Pisces ",
                "RICOCHET CHOLLIMA ",
                "Reaper ",
                "ScarCruft ",
                "APT37 "
            ],
            "source_name": "Secureworks:NICKEL FOXCROFT",
            "tools": [
                "ROKRAT"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "9b02c527-5077-489e-9a80-5d88947fddab",
            "created_at": "2022-10-25T16:07:24.103499Z",
            "updated_at": "2025-03-27T02:02:10.108504Z",
            "deleted_at": null,
            "main_name": "Reaper",
            "aliases": [
                "APT 37",
                "ATK 4",
                "Cerium",
                "Crooked Pisces",
                "Geumseong121",
                "Group 123",
                "ITG10",
                "InkySquid",
                "Moldy Pisces",
                "Opal Sleet",
                "Operation Are You Happy?",
                "Operation Battle Cruiser",
                "Operation Black Banner",
                "Operation Daybreak",
                "Operation Dragon messenger",
                "Operation Erebus",
                "Operation Evil New Year",
                "Operation Evil New Year 2018",
                "Operation Fractured Block",
                "Operation Fractured Statue",
                "Operation FreeMilk",
                "Operation Golden Bird",
                "Operation Golden Time",
                "Operation High Expert",
                "Operation Holiday Wiper",
                "Operation Korean Sword",
                "Operation North Korean Human Right",
                "Operation Onezero",
                "Operation Rocket Man",
                "Operation SHROUDED#SLEEP",
                "Operation STARK#MULE",
                "Operation STIFF#BIZON",
                "Operation Spy Cloud",
                "Operation Star Cruiser",
                "Osmium",
                "Red Eyes",
                "Ricochet Chollima",
                "Ruby Sleet",
                "ScarCruft",
                "TA-RedAnt",
                "TEMP.Reaper",
                "Venus 121"
            ],
            "source_name": "ETDA:Reaper",
            "tools": [
                "Agentemis",
                "BLUELIGHT",
                "Backdoor.APT.POORAIM",
                "CARROTBALL",
                "CARROTBAT",
                "CORALDECK",
                "Cobalt Strike",
                "CobaltStrike",
                "DOGCALL",
                "Erebus",
                "Exploit.APT.RICECURRY",
                "Final1stSpy",
                "Freenki Loader",
                "GELCAPSULE",
                "GOLDBACKDOOR",
                "GreezeBackdoor",
                "HAPPYWORK",
                "JinhoSpy",
                "KARAE",
                "KevDroid",
                "Konni",
                "MILKDROP",
                "N1stAgent",
                "NavRAT",
                "Nokki",
                "Oceansalt",
                "POORAIM",
                "PoohMilk",
                "PoohMilk Loader",
                "RICECURRY",
                "RUHAPPY",
                "RokRAT",
                "SHUTTERSPEED",
                "SLOWDRIFT",
                "SOUNDWAVE",
                "SYSCON",
                "Sanny",
                "ScarCruft",
                "StarCruft",
                "Syscon",
                "VeilShell",
                "WINERACK",
                "ZUMKONG",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535781,
    "ts_updated_at": 1743041797,
    "ts_creation_date": 1653788309,
    "ts_modification_date": 1653788309,
    "files": {
        "pdf": "https://archive.orkl.eu/08c32124f6c48acbb344a689575454728cf0f8e7.pdf",
        "text": "https://archive.orkl.eu/08c32124f6c48acbb344a689575454728cf0f8e7.txt",
        "img": "https://archive.orkl.eu/08c32124f6c48acbb344a689575454728cf0f8e7.jpg"
    }
}