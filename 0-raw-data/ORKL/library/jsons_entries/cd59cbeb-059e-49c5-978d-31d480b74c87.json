{
    "id": "cd59cbeb-059e-49c5-978d-31d480b74c87",
    "created_at": "2023-01-12T15:10:02.75922Z",
    "updated_at": "2025-03-27T02:17:11.521562Z",
    "deleted_at": null,
    "sha1_hash": "19df1a39ddcc0f729c4eb141daccc3961b7575a4",
    "title": "2019-04-18 - APT28 and Upcoming Elections- Evidence of Possible Interference (Part II)",
    "authors": "",
    "file_creation_date": "2022-05-29T10:48:58Z",
    "file_modification_date": "2022-05-29T10:48:58Z",
    "file_size": 509019,
    "plain_text": "# APT28 and Upcoming Elections: Evidence of Possible Interference (Part II)\n\n**[blog.yoroi.company/research/apt28-and-upcoming-elections-possible-interference-signals-part-ii/](https://blog.yoroi.company/research/apt28-and-upcoming-elections-possible-interference-signals-part-ii/)**\n\nApril 18, 2019\n\n## Introduction\n\nThe uncertain attribution of the Ukrainian themed malicious document discussed in our past article “APT28 and\n_Upcoming Elections: Possible Interference Signals”, led us to a review of Sofacy’s phishing techniques to confirm_\nor deny the possible involvement of Russian state-sponsored actors in the election interference. We ended up in\nan old fake Hotel reservation request form, containing dummy interactive text boxes used to lure the victims to\nenable the macro code execution.\n\nWe [analyzed this sample two years ago and we linked it to a Sofacy attack operation discovered by FE](https://cybaze.it/wp-content/uploads/2019/04/Report_APT28_HospitalityMalware.pdf)\nresearchers in the mid of 2017, which hit several hotels in European and Middle Eastern countries.\n\n### Technical Analysis\n\n**Sha256** a4a455db9f297e2b9fe99d63c9d31e827efb2cda65be445625fa64f4fce7f797\n\n**Threat** APT28 GAMEFISH\n\n\n**Brief**\n**Description**\n\n\nGAMEFISH document dropper (reference sample, 2017)\n\n\n**Ssdeep** 1536:009J0E4v13p/gL7Jj4P9bvzKGXpIiUvh23oKRO/HhcKmFoR:fb4v13pYL7J49bvr5Iias32Jc5FoR\n\nThe macro code inside the 2017 document is password protected, just like the last suspicious document we\n[analyzed to investigate a possible Ukraine elections interference by Russian groups. After its opening, the](https://blog.yoroi.company/research/apt28-and-upcoming-elections-possible-interference-signals/)\nreference sample decodes the extracted Base64 content using a custom “DecodeBase64” function:\n\nFigure 1: Custom Base64 decryption routine\n\n\n-----\n\nThe decoded content is actually a DLL file which is written into _%AppData%\\user.dat . After that, it will be_\nexecuted through an ASR bypass technique (Attack Surface Reduction) allowing attackers to run new child\nprocess within the Office environment. This is the same publicly available exploit previously found into the\nUkrainian sample (more details in the next section).\n\nFigure 2: Technique used to bypass Microsoft ASR protection\nIn this reference sample, the “user.dat”’s purpose is to create two new artifacts and to set persistence through\n_“HKCU\\Environment->UserInitMprLogonScript”. The created files are:_\n\n%AppData%\\mrset.bat\n%AppData%\\mvtband.dat\n\nFigure 3: Persistence setting and artifacts creation by “user.dat” file\nThe “mrset.bat” file is a short bash file, designed to check the “mvtband.dat” existence and to run it through\n_“rundll32.exe” system utility._\n\nFigure 4: “mrset.bat” file code\n\nFinally, the “mvtband.dat” file, which actually is a Delphi DLL library, is a well-known malware named\n“GAMEFISH” (f9fd3f1d8da4ffd6a494228b934549d09e3c59d1). Russian groups were used to use it in reconphases to steal information from victim machine and to implant new payloads.\n\nFigure 5: Information retrieved by mvtband.dll\n\n### Comparison with Ukrainian Elections Sample\n\n**Sha256** 8a35b6ecdf43f42dbf1e77235d6017faa70d9c68930bdc891d984a89d895c1e7\n\n**Threat** Document dropper\n\n\n**Brief**\n**Description**\n\n\nDropper of APT28 sample (Ukraine elections, 2019)\n\n\n**Ssdeep** 12288:hRd2KFJ7uq9U2Gaz6L2qJnlIzeTLC7m0HmhVyqZPY/q7rB:/RFwqK21VolI6TL0m0GhM6LF\n\nDespite some differences between the \"Hospitality campaign\" vector and the Ukraine elections one, both use\nsimilar TTP related to the APT28 group. The link between Hospitality malware and the \"FancyBear\" actor has\nbeen already sifted by Info-Sec community. So, we can exploit the similarities between it and the Ukrainian\nelections sample to link it to Russian hacker groups.\n\nBoth documents under analysis use protected macro code. All the code inside the macro is not obfuscated in any\nway: Hospitality document surprisingly contains code comments too. Moreover, the main macro function name is\n_“Execute” for both documents and the ASR trick used to create new processes from the Office work-space is_\n\n\n-----\n\nsubstantially the same.\n\nFigure 6. The Ukraine elections macro on the left; Hospitality’s one on the right.\nIn both cases the real payload is encoded in Base64 and it is stored into an Office hidden section: the first sample\nuses a document property, the second one employs an XML resource.\n\nThe next stages are different: the Ukraine sample deploys some Powershell obfuscated scripts, which at the end\ncarry an Empire stager, allowing the attackers to directly interact with the victim machine; the reference sample,\ninstead, implants the GAMEFISH malware which automatically exfiltrates victim information while waiting for new\npayloads to install.\n\n## Conclusion\n\nFinally, the attribution of the Ukraine elections sample (highlighted in our previous report) can be confirmed due to\nthe strong similarities with the first stage of the Sofacy’s Hospitality malware, because:\n\nBoth use password protection.\nBoth have the same function name.\nBoth have the same macro code structure.\nBoth embeds the real payload in a hidden document section.\nThe ASR trick is implemented using the same instructions.\n\nThe presence of these similarities between the droppers indicates, with high probability, the attacker is the same\nand consequentially suggests APT28 is reusing some 2017 tricks and code snippets which, despite their\nsimplicity, make their attacks effective.\n\n## Indicators of Compromise\n\nHash:\n\nb40cbf38284e6a1b9157002ad564e40fad2d85ba36437cf95c3b6326ad142520\n353aa1f03b36ee51138b61ef1f91f75de01850d73d619bbe5a0050594eba660d\n58b223f74992f371cab8f1df7c03b9b66f2ea9e3c9e22122898a9be62a05c0b4\n51eaf3b30c1ea932843cb9f5b6fb41804976d94a53a507ccb292b8392276cfd6\n8c47961181d9929333628af20bdd750021e925f40065374e6b876e3b8afbba57\ne259df89e065c4162b273ebb18b75ea153f9bafe30a8c6610204ccf5e3f4ebcd\n\n### Yara Rules\n\n\n-----\n\n```\n      _ _ _ pp _ {\n  meta:\n     description = \"Yara Rule for office_document dropper (2017)\"\n     author = \"ZLAB Yoroi-Cybaze\"\n     last_updated = \"2019-04-16\"\n     tlp = \"white\"\n     category = \"informational\"\n  strings:\n     $a = \"word\\\\vbaProject.binPK\"\n     $b = {E3 5D B8 1E 9C C7 11 F4 1E}\n     $c = {36 B7 DD E9 6F 33 4b D7 E7 7F}\n  condition:\n     all of them\n}\nimport \"pe\"\nrule APT28_user_dll {\n  meta:\n     description = \"Yara Rule for user_dll (2017)\"\n     author = \"ZLAB Yoroi-Cybaze\"\n     last_updated = \"2019-04-16\"\n     tlp = \"white\"\n     category = \"informational\"\n  strings:\n     $a = \"MZ\"\n     $b = \"GetEnvironmentVariable\"\n     $c = {49 73 50 72 6F 63 65 73 73 6F 72}\n  condition:\n     all of them and pe.number_of_sections == 5\n}\nrule APT28_mrset_bat {\n  meta:\n     description = \"Yara Rule for mrset_bat_file (2017)\"\n     author = \"ZLAB Yoroi-Cybaze\"\n     last_updated = \"2019-04-16\"\n     tlp = \"white\"\n     category = \"informational\"\n  strings:\n     $a = \"inst_pck\"\n     $b = \"mvtband.dat\"\n  condition:\n     all of them\n}\nimport \"pe\"\nrule APT28_mvtband_dat_dll {\n  meta:\n     description = \"Yara Rule for mvtband_dat_dll (2017)\"\n     author = \"ZLAB Yoroi-Cybaze\"\n     last_updated = \"2019-04-16\"\n     tlp = \"white\"\n     category = \"informational\"\n  strings:\n     $a = \"DGMNOEP\"\n     $b = {C7 45 94 0A 25 73 30 8D 45 94} // two significant instructions\n  condition:\n     all of them and pe.sections[2].raw_data_size == 0 and pe.version_info[\"OriginalFilename\"]\ncontains \"mvtband\"\n}\n\n```\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2019/2019-04-18 - APT28 and Upcoming Elections- Evidence of Possible Interference (Part II).pdf"
    ],
    "report_names": [
        "2019-04-18 - APT28 and Upcoming Elections- Evidence of Possible Interference (Part II).pdf"
    ],
    "threat_actors": [
        {
            "id": "e3767160-695d-4360-8b2e-d5274db3f7cd",
            "created_at": "2022-10-25T16:47:55.914348Z",
            "updated_at": "2025-03-27T02:05:17.411172Z",
            "deleted_at": null,
            "main_name": "IRON TWILIGHT",
            "aliases": [
                "ATK5 ",
                "Blue Athena ",
                "BlueDelta ",
                "FROZENLAKE ",
                "Fancy Bear ",
                "Fighting Ursa ",
                "Forest Blizzard ",
                "GRAPHITE ",
                "Group 74 ",
                "PawnStorm ",
                "STRONTIUM ",
                "Sednit ",
                "Snakemackerel ",
                "Sofacy ",
                "TG-4127 ",
                "Tsar Team ",
                "APT28 "
            ],
            "source_name": "Secureworks:IRON TWILIGHT",
            "tools": [
                " Downdelph",
                " Drovorub",
                " EVILTOSS",
                " HIDEDRV",
                " Headlace",
                " LoJack",
                " Powershell Empire",
                " SCONATO",
                " SEDUPLOADER",
                " SHARPFRONT",
                " Scaramouche",
                " Sedkit Exploit Kit",
                " Sofacy downloader",
                " X-Agent",
                " X-Tunnel",
                " Zebrocy",
                " reGeorg",
                "DEALERSCHOICE"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "730dfa6e-572d-473c-9267-ea1597d1a42b",
            "created_at": "2023-01-06T13:46:38.389985Z",
            "updated_at": "2025-03-27T02:00:02.821388Z",
            "deleted_at": null,
            "main_name": "APT28",
            "aliases": [
                "FROZENLAKE",
                "BlueDelta",
                "SNAKEMACKEREL",
                "TG-4127",
                "ITG05",
                "TA422",
                "Fancy Bear",
                "FANCY BEAR",
                "Sednit",
                "IRON TWILIGHT",
                "G0007",
                "Sofacy",
                "Forest Blizzard",
                "GruesomeLarch",
                "Pawn Storm",
                "Tsar Team",
                "STRONTIUM",
                "ATK5",
                "Blue Athena",
                "APT-C-20",
                "Group 74",
                "SIG40",
                "Grizzly Steppe",
                "Fighting Ursa",
                "T-APT-12",
                "UAC-0028"
            ],
            "source_name": "MISPGALAXY:APT28",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "ae320ed7-9a63-42ed-944b-44ada7313495",
            "created_at": "2022-10-25T15:50:23.671663Z",
            "updated_at": "2025-03-27T02:00:55.518748Z",
            "deleted_at": null,
            "main_name": "APT28",
            "aliases": [
                "APT28",
                "IRON TWILIGHT",
                "SNAKEMACKEREL",
                "Group 74",
                "Sednit",
                "Sofacy",
                "Pawn Storm",
                "Fancy Bear",
                "STRONTIUM",
                "Tsar Team",
                "Threat Group-4127",
                "TG-4127",
                "Forest Blizzard",
                "FROZENLAKE"
            ],
            "source_name": "MITRE:APT28",
            "tools": [
                "Wevtutil",
                "certutil",
                "Forfiles",
                "DealersChoice",
                "Mimikatz",
                "ADVSTORESHELL",
                "Komplex",
                "HIDEDRV",
                "JHUHUGIT",
                "Koadic",
                "Winexe",
                "XTunnel",
                "Drovorub",
                "CORESHELL",
                "OLDBAIT",
                "Downdelph",
                "XAgentOSX",
                "USBStealer",
                "Zebrocy",
                "Fysbis",
                "LoJax"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "d2516b8e-e74f-490d-8a15-43ad6763c7ab",
            "created_at": "2022-10-25T16:07:24.212584Z",
            "updated_at": "2025-03-27T02:02:10.141001Z",
            "deleted_at": null,
            "main_name": "Sofacy",
            "aliases": [
                "APT 28",
                "ATK 5",
                "Blue Athena",
                "BlueDelta",
                "FROZENLAKE",
                "Fancy Bear",
                "Fighting Ursa",
                "Forest Blizzard",
                "Grey-Cloud",
                "Grizzly Steppe",
                "Group 74",
                "GruesomeLarch",
                "ITG05",
                "Iron Twilight",
                "Operation DealersChoice",
                "Operation Dear Joohn",
                "Operation Komplex",
                "Operation Pawn Storm",
                "Operation Russian Doll",
                "Operation Steal-It",
                "Pawn Storm",
                "SIG40",
                "Sednit",
                "Snakemackerel",
                "Sofacy",
                "Strontium",
                "T-APT-12",
                "TA422",
                "TAG-0700",
                "TAG-110",
                "TG-4127",
                "Tsar Team",
                "UAC-0028",
                "UAC-0063"
            ],
            "source_name": "ETDA:Sofacy",
            "tools": [
                "ADVSTORESHELL",
                "AZZY",
                "Backdoor.SofacyX",
                "CHERRYSPY",
                "CORESHELL",
                "Carberp",
                "Computrace",
                "DealersChoice",
                "Delphacy",
                "Downdelph",
                "Downrage",
                "Drovorub",
                "EVILTOSS",
                "Foozer",
                "GAMEFISH",
                "GooseEgg",
                "Graphite",
                "HATVIBE",
                "HIDEDRV",
                "Headlace",
                "Impacket",
                "JHUHUGIT",
                "JKEYSKW",
                "Koadic",
                "Komplex",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "LoJack",
                "LoJax",
                "MASEPIE",
                "Mimikatz",
                "NETUI",
                "Nimcy",
                "OCEANMAP",
                "OLDBAIT",
                "PocoDown",
                "PocoDownloader",
                "Popr-d30",
                "ProcDump",
                "PythocyDbg",
                "SMBExec",
                "SOURFACE",
                "SPLM",
                "STEELHOOK",
                "Sasfis",
                "Sedkit",
                "Sednit",
                "Sedreco",
                "Seduploader",
                "Shunnael",
                "SkinnyBoy",
                "Sofacy",
                "SofacyCarberp",
                "SpiderLabs Responder",
                "Trojan.Shunnael",
                "Trojan.Sofacy",
                "USB Stealer",
                "USBStealer",
                "VPNFilter",
                "Win32/USBStealer",
                "WinIDS",
                "Winexe",
                "X-Agent",
                "X-Tunnel",
                "XAPS",
                "XTunnel",
                "Xagent",
                "Zebrocy",
                "Zekapab",
                "carberplike",
                "certutil",
                "certutil.exe",
                "fysbis",
                "webhp"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673536202,
    "ts_updated_at": 1743041831,
    "ts_creation_date": 1653821338,
    "ts_modification_date": 1653821338,
    "files": {
        "pdf": "https://archive.orkl.eu/19df1a39ddcc0f729c4eb141daccc3961b7575a4.pdf",
        "text": "https://archive.orkl.eu/19df1a39ddcc0f729c4eb141daccc3961b7575a4.txt",
        "img": "https://archive.orkl.eu/19df1a39ddcc0f729c4eb141daccc3961b7575a4.jpg"
    }
}