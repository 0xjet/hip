{
    "id": "3c9a5b55-6335-45dd-83ff-9764a47221a9",
    "created_at": "2023-01-12T15:10:06.758079Z",
    "updated_at": "2025-03-27T02:14:11.906324Z",
    "deleted_at": null,
    "sha1_hash": "1b5acf901962179d506b79947b241eb7cd2ef767",
    "title": "2022-04-28 - LAPSUS$- Recent techniques, tactics and procedures",
    "authors": "",
    "file_creation_date": "2022-05-27T21:56:56Z",
    "file_modification_date": "2022-05-27T21:56:56Z",
    "file_size": 151038,
    "plain_text": "# LAPSUS$: Recent techniques, tactics and procedures\n\n**[research.nccgroup.com/2022/04/28/lapsus-recent-techniques-tactics-and-procedures/](https://research.nccgroup.com/2022/04/28/lapsus-recent-techniques-tactics-and-procedures/)**\n\nApril 28, 2022\n\n**Authored by: David Brown, Michael Matthews and Rob Smallridge**\n\n## tl;dr\n\nThis post describes the techniques, tactics and procedures we observed during recent\nLAPSUS$ incidents.\n\nOur findings can be summarised as below:\n\nAccess and scraping of corporate Microsoft SharePoint sites in order to identify any\ncredentials which may be stored in technical documentation.\nAccess to local password managers and databases to obtain further credentials and\nescalate privileges.\n\n\n-----\n\nLiving of the land – tools such as RVTools to shut down servers and ADExplorer to\nperform reconnaissance.\nCloning of git repositories and extraction of sensitive API Keys.\nUsing compromised credentials to access corporate VPNs.\nDisruption or destruction to victim infrastructure to hinder analysis and consume\ndefensive resource.\n\n## Summary\n\nLAPSUS$ first appeared publicly in December 2021, however, NCC Group first observed\nLAPSUS$ months prior during an incident response engagement. We believe the group has\nalso operated prior to this date, though perhaps not under the “LAPSUS$” banner.\n\nOver the last 5 months, LAPSUS$ has gained large notoriety with some successful breaches\nof some large enterprises including, Microsoft, Nvidia, Okta & Samsung. Little is still known\nabout this group with motivations appearing to be for reputation, money and “for the lulz”.\n\nNotifications or responsibility of victims by LAPSUS$ are commonly reported via their\ntelegram channel and in one case a victim’s DNS records were reconfigured to LAPSUS$\ncontrolled domains/websites. However, not all victims or breaches appear to actively be\nannounced via their telegram channel, nor are some victims approached with a ransom. This\ndistinguishes themselves from more traditional ransomware groups who have a clear modus\noperandi and are clearly financially focused. The result of this is that LAPSUS$ are less\npredictable which may be why they have seen recent success.\n\nThis serves as a reminder for defenders for defence in depth and the need to anticipate\ndifferent tactics that threat actors may use.\n\nIt is also worth mentioning the brazen behaviour of this threat actor and their emboldened\nattempts at Social Engineering by offering payment for insiders to provide valid credentials.\n\nThis tactic is potentially in response to greater home working due to the pandemic which\nmeans there is a far larger proportion of employees with VPN access and as such a greater\npool of potential employees willing to sell their credentials.\n\nTo combat this, organisations need to ensure they have extensive VPN logging capabilities,\nrobust helpdesk ticketing as well as methods to help identify anomalies in VPN access.\n\nIt is notable that the majority of LAPSUS$ actions exploit the human element as opposed to\ntechnical deficiencies or vulnerabilities. Although potentially viewed as unsophisticated or\nbasic these techniques have been successful, so it is vital that organisations factor in\ncontrols and mitigations to address them.\n\n## Initial access\n\n\n-----\n\nThreat Intelligence shows that LAPSUS$ utilise multiple methods to gain Initial access.\n\nThe main source of initial access is believed to occur via stolen authentication cookies which\nwould grant the attacker access to a specific application. These cookies are usually in the\nform of Single sign-on (SSO) applications which would allow the attacker to pivot into other\ncorporate applications ultimately bypassing controls such as multi-factor authentication\n(MFA).\n\n## Credential access and Privilege escalation\n\nCredential Harvesting and privileged escalation are key components of the LAPSUS$\nbreaches we have seen, with rapid escalation in privileges the LAPSUS$ group have been\nseen to elevate from a standard user account to an administrative user within a couple of\ndays.\n\nIn the investigations conducted by NCC Group, little to no malware is used. In one case NCC\nGroup observed LAPSUS$ using nothing more than the legitimate Sysinternals tool\nADExplorer, which was used to conduct reconnaissance on the victim’s environment.\n\nAccess to corporate VPNs is a primary focus for this group as it allows the threat actor to\ndirectly access key infrastructure which they require to complete their objectives.\n\nIn our incident response cases, we saw the threat actor leveraging compromised employee\nemail accounts to email helpdesk systems requesting access credentials or support to get\naccess to the corporate VPN.\n\n## Lateral Movement\n\nIn one incident LAPSUS$ were observed to sporadically move through the victim\nenvironment via RDP in an attempt to access resources deeper in the victim environment. In\nsome instances, victim controlled hostnames were revealed including the host “VULTRGUEST” which refers to infrastructure hosted on the private cloud service, Vultr[3].\n\n## Exfiltration\n\nLAPSUS$’s action on objectives appears to focus on data exfiltration of sensitive information\nas well as destruction or disruption. In one particular incident the threat actor is observed to\nutilise the free file drop service “filetransfer[.]io”.\n\n## Impact\n\nNCC Group has observed disruption and destruction to client environments by LAPSUS$\nsuch as shutting down virtual machines from within on-premises VMware ESXi infrastructure,\nto the extreme of mass deletion of virtual machines, storage, and configurations in cloud\n\n\n-----\n\nenvironments making it harder for the victim to recover and for the investigation team to\nconduct their analysis activities.\n\nThe theft of data reported appears to heavily be focused on application source code or\nproprietary technical information. With a targeting of internal source code management or\nrepository servers. These git repositories can contain not only commercially sensitive\nintellectual property, but also in some cases may include additional API keys to sensitive\napplications including administrative or cloud applications.\n\n## Recommendations\n\nEnsure that Cloud computing environments have sufficient logging enabled.\nEnsure that cloud administrative access is configured to prevent unauthorised access\nto resources and that API keys are not overly permissive to the permissions they\nrequire.\nUtilise MFA for user authentication on both cloud and remote access solutions to help\nreduce the risk of unauthorised access.\nEnsure logging is in place to record MFA device enrolment\nSecurity controls such as Conditional Access can help restrict or prevent unauthorised\naccess based on criteria such as geographical location.\nImplement activities to detect and investigate anomalies in VPN access.\nEnsure a system is in place to record all helpdesk queries.\nAvoid using SMS as an MFA vector to avoid the risk of SIM swapping.\nSecuring source code environments to ensure that users can only access the relevant\nrepositories.\nSecret Scanning[1][2] on source code repositories should be conducted to ensure that\nsensitive API credentials are not stored in source code. GitHub and Gitlab offer\ndetection mechanisms for this\nRemote Desktop services or Gateways used as a primary or secondary remote access\nsolution should be removed from any corporate environment in favour for alternative\nsolutions such as secured VPNs, or other Remote Desktop applications which mitigate\ncommon attack techniques such as brute force or exploitation and can offer additional\nsecurity controls such as MFA and Conditional Access.\nCentralise logging including cloud applications (SIEM solution).\nOffline or immutable backups of servers should be taken to ensure that in the event of\na data disruption or destruction attack, services can be restored.\nReduce MFA token/Session cookie validity times\nEnsure principle of least privilege for user accounts is being adhered to.\nSocial engineering awareness training for all staff.\n\n## Indicators of Compromise\n\n\n-----\n\n**Indicator Value** **Indicator**\n**Type**\n\n\n**Description**\n\n\n104.238.222[.]158 IP address Malicious Lapsus Network Address\n\n108.61.173[.]214 IP address Malicious Lapsus Network Address\n\n185.169.255[.]74 IP address Malicious Lapsus Network Address\n\nVULTR-GUEST Hostname Threat Actor Controlled Host\n\nhxxps://filetransfer[.]io Domain Free File Drop Service Utilised by the Threat\nActor\n\n## MITRE ATT&CK\n\n\n**Technique**\n**Code**\n\n\nTechnique\n\n\nT1482 Discovery – Domain Trust Discovery\n\nT1018 Discovery – Remote System Discovery\n\nT1069.002 Discovery – Groups Discovery: Domain Groups\n\nT1016.001 Discovery – System Network Configuration Discovery\n\nT1078.002 Privilege Escalation – Domain Accounts\n\nT1555.005 Credential Access – Credentials from Password Stores: Password\nManagers\n\nT1021.001 Lateral Movement – Remote Services: Remote Desktop Protocol\n\nT1534 Lateral Movement – Internal Spearphishing\n\nT1072 Execution – Software Deployment Tools\n\nT1213.002 Collection – Data from Information Repositories: Sharepoint\n\nT1039 Collection – Data from Network Shared Drive\n\nT1213.003 Collection – Data from Information Repositories: Code Repositories\n\nT1567 Exfiltration – Exfiltration Over Web Service\n\nT1485 Impact – Data Destruction\n\nT1529 Impact – System Shutdown/Reboot\n\n\n-----\n\n## References\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-04-28 - LAPSUS$- Recent techniques, tactics and procedures.pdf"
    ],
    "report_names": [
        "2022-04-28 - LAPSUS$- Recent techniques, tactics and procedures.pdf"
    ],
    "threat_actors": [
        {
            "id": "52d5d8b3-ab13-4fc4-8d5f-068f788e4f2b",
            "created_at": "2022-10-25T16:07:24.503878Z",
            "updated_at": "2025-03-27T02:02:10.261742Z",
            "deleted_at": null,
            "main_name": "Lapsus$",
            "aliases": [
                "DEV-0537",
                "Strawberry Tempest"
            ],
            "source_name": "ETDA:Lapsus$",
            "tools": [],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "be5097b2-a70f-490f-8c06-250773692fae",
            "created_at": "2022-10-27T08:27:13.22631Z",
            "updated_at": "2025-03-27T02:00:55.534879Z",
            "deleted_at": null,
            "main_name": "LAPSUS$",
            "aliases": [
                "LAPSUS$",
                "DEV-0537",
                "Strawberry Tempest"
            ],
            "source_name": "MITRE:LAPSUS$",
            "tools": [
                "Mimikatz"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "d4b9608d-af69-43bc-a08a-38167ac6306a",
            "created_at": "2023-01-06T13:46:39.335061Z",
            "updated_at": "2025-03-27T02:00:03.053961Z",
            "deleted_at": null,
            "main_name": "LAPSUS",
            "aliases": [
                "LAPSUS$",
                "DEV-0537",
                "SLIPPY SPIDER",
                "Strawberry Tempest"
            ],
            "source_name": "MISPGALAXY:LAPSUS",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "2347282d-6b88-4fbe-b816-16b156c285ac",
            "created_at": "2024-06-19T02:03:08.099397Z",
            "updated_at": "2025-03-27T02:05:17.390442Z",
            "deleted_at": null,
            "main_name": "GOLD RAINFOREST",
            "aliases": [
                "Strawberry Tempest ",
                "Lapsus$"
            ],
            "source_name": "Secureworks:GOLD RAINFOREST",
            "tools": [
                "Mimikatz"
            ],
            "source_id": "Secureworks",
            "reports": null
        }
    ],
    "ts_created_at": 1673536206,
    "ts_updated_at": 1743041651,
    "ts_creation_date": 1653688616,
    "ts_modification_date": 1653688616,
    "files": {
        "pdf": "https://archive.orkl.eu/1b5acf901962179d506b79947b241eb7cd2ef767.pdf",
        "text": "https://archive.orkl.eu/1b5acf901962179d506b79947b241eb7cd2ef767.txt",
        "img": "https://archive.orkl.eu/1b5acf901962179d506b79947b241eb7cd2ef767.jpg"
    }
}