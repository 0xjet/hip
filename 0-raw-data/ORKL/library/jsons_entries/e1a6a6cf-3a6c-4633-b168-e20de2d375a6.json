{
    "id": "e1a6a6cf-3a6c-4633-b168-e20de2d375a6",
    "created_at": "2023-01-12T15:04:34.948131Z",
    "updated_at": "2025-03-27T02:09:30.218068Z",
    "deleted_at": null,
    "sha1_hash": "9a6c225a95dd6f739e9d7cda9655bb1c907ecf8d",
    "title": "2013-12-04 - The Internet of Everything, Including Malware",
    "authors": "",
    "file_creation_date": "2022-05-29T01:30:37Z",
    "file_modification_date": "2022-05-29T01:30:37Z",
    "file_size": 430757,
    "plain_text": "# The Internet of Everything, Including Malware\n\n**[blogs.cisco.com/security/the-internet-of-everything-including-malware](https://blogs.cisco.com/security/the-internet-of-everything-including-malware)**\n\nCraig Williams December 4, 2013\n\n[We are witnessing the growth of the Internet of Everything (IoE), the network of embedded](http://www.cisco.com/web/about/ac79/innov/IoE.html)\nphysical objects accessed through the Internet, and it’s connecting new devices to the\nInternet which may not traditionally have been there before. Unfortunately, some of these\ndevices may be deployed with a security posture that may need improvement.\n\n[Naturally when we saw a few](http://www.deependresearch.org/2013/12/hey-zollard-leave-my-internet-of-things.html) [posts about multi-architecture malware focused on the](http://www.symantec.com/connect/blogs/linux-worm-targeting-hidden-devices)\n“Internet of Things”, we decided to take a look. The issue being exploited in those posts\n[is CVE-2012-1823, which has both an existing Cisco IPS signature as well as some](http://tools.cisco.com/security/center/viewAlert.x?alertId=25816)\nfor [Snort. It turns out this vulnerability is actually quite heavily exploited by many different](http://vrt-blog.snort.org/2012/05/php-cgi-vulnerability-exploits-in-wild.html)\nworms, and it took quite a bit of effort to exclude all of the alerts generated by other pieces of\nmalware in Cisco IPS network participation. Due to the vulnerability-specific nature of the\nCisco IPS signature, the same signature covers this issue as well as any others that use this\ntechnique; just one signature provides protection against all attempts to exploit this\nvulnerability. As you can see in the graph below this is a heavily exploited vulnerability. Note\nthat these events are any attack attempting to exploit this issue, not necessarily just the\nZollard worm\n\n\n-----\n\nThe graph below is derived from both Cisco IPS and Sourcefire IPS customers. The Cisco\n[data is from customers who have ‘opted-in’ to network participation. This service is not on by](http://www.cisco.com/en/US/docs/security/ips/7.0/configuration/guide/cli/cli_collaboration.html#wp1054333)\ndefault. The Sourcefire data below is derived from their SPARK network of test sensors. This\ngraph is showing the percent increase of alert volume from the normal for each dataset at\nthe specified time.\n\nHere you can see a request that attempted to exploit one of our managed\nservices customers, specifically the piece of malware that uses the “User-Agent: Zollard”\nindicator. This customer was running their IPS in inline mode so this attack attempt, along\nwith many others attempting to exploit them, were blocked by the network device inline. This\nis exactly how the IoE should be protected.\n\n\n-----\n\n-----\n\nYou will notice that the POST request is encoded. I ve decoded it above so that you can see\n[both versions. I’ve previously posted about a similar php based exploit:](http://blogs.cisco.com/security/plesk-0-day-targets-web-servers/)\n\nIn the decoded POST request, we can see a number of interesting arguments. The\nexploit is turning off any possible hardening that is in place on the server.\nThe allow_url_include=on argument allows the attacker to include arbitrary PHP\n[scripting; the impact is described here. Next,](http://blog.php-security.org/archives/45-PHP-5.2.0-and-allow_url_include.html) [safe_mode is turned off. As a final step,](http://php.net/manual/en/features.safe-mode.php)\n[Suhosin, a PHP hardening patch is put into simulation mode. This mode is designed](http://www.hardened-php.net/suhosin/configuration.html#suhosin.simulation)\nfor application testing and effectively turns off any additional protection on the server\n(as well as protections against processing PHP script via the php:// URI handler).\n\nWe have been able to associate the following md5s with this malware, which is detected by\nthe clamAV signature “Linux.Trojan.Zollard”:\n\nb61b8521bae5058c4ed37358344c7599 ppc\n5ef7ac971cf52850570f8c3ad149deee mips\n19911cb32b0b58d49d1ff694d4aeb979 mipsel\n00a299fd149939cec860c71224b77209 x86\n5ef7ac971cf52850570f8c3ad149deee x86\n00a299fd149939cec860c71224b77209 x86\n\nSince embedded devices require firmware updates, they typically have more complex quality\nassurance cycles, which in turn may cause them to lag behind other products from a security\nupdate perspective. To complicate this further, embedded devices often have a very basic\nsetup process that is run once at deployment, and then never touched again. This results in\nmost embedded devices running fairly standard configurations. If a vulnerability is found in\ndefault or common embedded configurations, attackers are much more likely to focus on it\nsince the attack surface is going to be widespread.\n\nAs smaller and more common devices become Internet-enabled, their collective security\nposture will become more important. The stable nature of devices in the IoE could make\nvulnerable devices quite an attractive and long-lived platform from which to launch malware,\nattacks, reconnaissance, or any other malicious activity if they are co-opted by attackers.\nProtection at the network level is the only way to scale effectively, though as always\npracticing defense in depth where possible is even better.\n\n[Special thanks to Nick Randolph from the VRT for providing help with this post.](http://www.snort.org/vrt)\n\nShare:\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2013/2013-12-04 - The Internet of Everything, Including Malware.pdf"
    ],
    "report_names": [
        "2013-12-04 - The Internet of Everything, Including Malware.pdf"
    ],
    "threat_actors": [
        {
            "id": "aa73cd6a-868c-4ae4-a5b2-7cb2c5ad1e9d",
            "created_at": "2022-10-25T16:07:24.139848Z",
            "updated_at": "2025-03-27T02:02:10.120505Z",
            "deleted_at": null,
            "main_name": "Safe",
            "aliases": [],
            "source_name": "ETDA:Safe",
            "tools": [
                "DebugView",
                "LZ77",
                "OpenDoc",
                "SafeDisk",
                "TypeConfig",
                "UPXShell",
                "UsbDoc",
                "UsbExe"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535874,
    "ts_updated_at": 1743041370,
    "ts_creation_date": 1653787837,
    "ts_modification_date": 1653787837,
    "files": {
        "pdf": "https://archive.orkl.eu/9a6c225a95dd6f739e9d7cda9655bb1c907ecf8d.pdf",
        "text": "https://archive.orkl.eu/9a6c225a95dd6f739e9d7cda9655bb1c907ecf8d.txt",
        "img": "https://archive.orkl.eu/9a6c225a95dd6f739e9d7cda9655bb1c907ecf8d.jpg"
    }
}