{
    "id": "6e260a34-479d-47d0-ab0d-3b9c8b057bf9",
    "created_at": "2022-10-25T16:48:14.222825Z",
    "updated_at": "2025-03-27T02:09:34.106338Z",
    "deleted_at": null,
    "sha1_hash": "a7a8df94dc6cbbd33eadbb9e39538aa6fe78e798",
    "title": "Security Response Custom Report",
    "authors": "",
    "file_creation_date": "2016-08-07T23:19:34Z",
    "file_modification_date": "2016-08-07T23:19:34Z",
    "file_size": 1187233,
    "plain_text": "# Security Response\n\n Backdoor.Remsec indicators of compromise \n\n#### Version 1.0: August 8, 2016\n\n\n-----\n\n## Backdoor.Remsec\n\nThe Backdoor.Remsec signature is used to detect several different components. These various\ncomponents work together as a framework to provide an attacker complete control over a victim\ncomputer, allow them to spread across a network, utilize a discreet command and control protocol, and\ndeploy custom tools as required.\n\nOnly a subset of Backdoor.Remsec components have been discovered and documented. Some samples\nhave not been fully analyzed. Functionality is mostly implemented in the form of modules downloaded\nover a network connection, and then executed in memory, and many of these components have not been\nretrieved.\n\nSeveral different components have been discovered on victim computers. Many of these components\nshare functionality, code, or other elements that, as well as being present on victims’ computers, links\nthem.\n\n          - **Loader: Seen with the filename MSAOSSPC.DLL, this component is responsible for loading files**\nfrom disk and executing them. The files on disk contain the payload in a specific format we are\ncalling the executable blob. The component also logs data. Executable blobs and data are\nencrypted and decrypted with a repeating key of 0xBAADF00D.\n\n          - **Lua modules: Several components use a Lua interpreter with Lua scripts to implement their**\nfunctionality. The Lua components are stored in the same executable blob format that the loader\nworks with. Several different Lua modules have been retrieved and their functionality includes:\n`o` Network loader - This loads an executable over the network for execution. It may use RSA\nand RC6.\n`o` Host loader - Loads at least three components, kblog, ilpsend, and updater.\n`o` Keylogger - Exfiltrates keylog data. It also contains the string SAURON, which may be a code\nword to describe the module or project.\n\n          - **Network listener: A number of samples that implement different techniques for opening a**\nnetwork connection based on monitoring for specific types of traffic. This includes ICMP, PCAP,\nand RAW network sockets. It's unclear exactly what is checked for with PCAP and Raw, however,\nthe ICMP listener checks for echo and echo response packets.\n\n          - **Named pipe back door: A minimal back door controlled over named pipes. This can execute**\ndata in the format of the executable blob, or standard PE files.\n\n          - **A second named pipe back door - This offers several more commands than the other named**\npipe back door, including sending the executable blob, listing files, and reading/writing/deleting\nfiles.\n\n          - **HTTP back door: Includes several URLs for C&C servers.**\n\n### Loader\n\nThis description is based on the analysis of the file with the MD5 hash of\n2a8785bf45f4f03c10cd929bb0685c2d which was seen with the file name of MSAOSSPC.DLL.\n\nAs mentioned, the loader is responsible for loading files from disk and executing them.\n\nThe loaded files adhere to a specific format referred to as the executable blob. That format is shown in\nTable 1.\n\n**Offset** **Size** **Purpose**\n0 vary _Executable_Blob_Header, described below_\nvary variable blob of executable code\n\n_Table 1. Loaded files format_\n\n\n-----\n\nThe Executable_Blob_Header can be interpreted as the following structure:\n\n**Offset** **Size** **Purpose**\n0 Dword Magic, enforcing value C102AA02\n4 Byte Version_Major (guess), enforcing value 2\n5 Byte Version_Minor (guess), we observed values 0, 1 and 3 in analyses samples\n6 Dword Entry_32, entry point for 32-bit mode represented as offset from start of Executable_Blob structure\n0A Dword Entry_64, entry point for 64-bit mode represented as offset from start of Executable_Blob structure\n0E Dword Tag (guess), introduced starting with Version_Minor 1, we observed values 0 and 7B3924B1 in analyzed samples\n12 Byte unknown purpose, introduced after Version_Minor 1, but not later than Version_Minor 3, observed only value 0 in\nanalysed samples\n\n_Table 2. Executable_Blob_Header structure_\n\nThe loaded executable blobs may be retrieved from the following path:\n\n          - c:\\System Volume Information\\_restore{ED650925-A32C-4E9C-8A73-\n8E6F0509309A}\\RP0\\A0000002.dll\n\n#### Persistence\n\nThe loader is implemented as a (fake) [Security Support Provider. Implementing the export](https://msdn.microsoft.com/en-us/library/windows/desktop/aa374731%28v=vs.85%29.aspx)\nof InitSecurityInterfaceW effectively functions as a loadpoint for the module.\n\n#### Injection library\n\nThis loader contains a relatively advanced library supporting injections into both 32-bit and 64-bit targets.\nThe implementation includes multiple redundant capabilities, including an embedded implementation of\n_CreateRemoteThread with CSR notification by way of CSRSS_CREATE_THREAD_LPCMESSAGE._\n\n#### Payload structure\n\nThe payload file, referred to by the attackers as a \"module\" per error messages, contains an encrypted\nstructure storing the following:\n\n          - _PE_Executable with only minimal verification by checking Machine field_\nfrom IMAGE_FILE_HEADER\n\n          - _Helper_Blob, described below_\n\nBased on checks implemented by the Loader, the Helper_Blob can be interpreted as the following\nstructure of length Helper_Blob_Size:\n\n**Offset** **Size** **Purpose**\n0 Dword _Data_Blob_Size, enforcing Data_Blob_Size < Helper_Blob_Size - 4_\n4 _Data_Blob_Size Bytes_ _Data_Blob_\nvariable variable _PE_Loader responsible for loading PE_Executable_\n\n_Table 3. Helper_Blob structure_\n\nThe PE_Executable and Helper_Blob are serialized as the following variable-length structure:\n\n**Offset** **Size** **Purpose**\n0 Dword _Version, referred as \"module file version\" in error messages, enforcing value 1_\n4 Dword _PE_Executable_Size_\n8 Dword _Helper_Blob_Size_\n0C _PE_Executable_Size Bytes_ _PE_Executable_\nvariable _Helper_Blob_Size Bytes_ _Helper_Blob described above_\n\n_Table 4. Payload_Blob structure_\n\n\n-----\n\nThe Payload_Blob structure is compressed using a ZLIB algorithm.\n\nThe compressed blob is then encrypted using an RC5 algorithm in CBC mode with the following\nparameters:\n\n          - word size: 32\n\n          - rounds: 12\n\n          - key: \"0xBAADF00DBAADF00DBAADF00DBAADF00D\"\n\n          - iv: zero bytes\n\nNotice that encryption may require padding for a compressed blob. The encrypted blob is stored on disk\nas a payload file.\n\n#### Log structure\n\nThe log file contains messages generated by the Loader stored in encrypted form.\n\nThe Log_Messages are represented as Unicode text, for example:\n```\n         Starting log (computer: \"XXX\" serial: 80B0:51E5 timezone: UTC+0h).\n         Failed to open module c:\\System Volume Information\\_restore{ED650925-A32C-\n         4E9C-8A73-8E6F0509309A}\\RP0\\A0000002.dll: (2) The system cannot find the\n         file specified.\n         Ending log.\n\n```\nThe Log_Messages are compressed using a ZLIB algorithm.\n\nThe compressed log is then encrypted using an RC5 algorithm in CBC mode with the following\nparameters:\n\n          - word size: 32\n\n          - rounds: 12\n\n          - key: \"0xBAADF00DBAADF00DBAADF00DBAADF00D\"\n\n          - iv: zero bytes\n\n### Lua modules\n\nA number of samples were discovered that contained a modified version of a Lua interpreter, and\ncompiled Lua scripts that would be executed by the interpreter. Each sample has the Lua script and\nplugins stored in an encrypted configuration blob.\n\nThese configuration blobs are encrypted using one of two distinct methods. These two techniques were\nlabelled version A and version B (vA, and vB for short).\n\nThe pre-compiled Lua scripts use customized binary format:\n\n          - Lua_SIGNATURE was modified to avoid \"Lua\" magic value\n\n          - Representation of char variables was modified, possibly to simplify handling of Unicode\ncharacters\n\nA number of samples that implement various different functionalities were discovered. These are\ndescribed below:\n\n\n-----\n\n#### Network loader\n\nThe functionality of the component with the MD5 hash of 90b4b5f0a475f3a028be2f71409e6d1a is to\nreceive executable modules from remote attackers and run them from memory on the local computer.\n\nThis component can use one of the following methods to establish a communication channel (depending\non passed parameters):\n\n          - Listen for an incoming TCP connection on an arbitrary port\n\n          - Connect to an arbitrary host over TCP\n\n          - Communicate over a handle provided by the caller\n\nThe communication is encrypted using RSA and RC6.\n\nThe received executable module follows the PE format and provides the following exports:\n\n          - _init, where two constant values, 2 and 1, are passed_\n\n          - _main, where a specific structure is passed, including functions to communicate over an_\nestablished encrypted communication channel\n\nThe following is the Lua script referring to this component:\n```\n         (w.exec2str)(\"wdogi -p 47329 192.168.0.1 445\")\n\n#### Host loader\n\n```\nTwo version of the host loader component were discovered. These files had the MD5 hashes of\n7261230a43a40bb29227a169c2c8e1be and 48d0c8faaee08fc51346925090af89aa.\n\nThis component contains configuration data. The data for both files discovered is shown in Tables 5 and\n6.\n\n**DLL_NAME** nseci.dll\n\n**BASE_STORAGE** c:\\\\System Volume Information\\\\{aa112c99-f343-4107-8ba1-22951714a641}\n\n**BLOB_STORAGE** c:\\\\System Volume Information\\\\{951841cb-d1a4-4d7c-b44e-2c3d25996e37}\n\n**KBLOG_UUID** {85f24f97-7321-4849-8c78-5989f5837ad4}\n\n**ILPSEND_UUID** {4d19edb2-5391-4f14-b27f-a3d553f411f4}\n\n**UPDATER_UUID** {6d46df72-115e-4c4c-a0a5-510dfe46f8aa}\n\n**TMP_STORAGE** c:\\\\System Volume Information\\\\{b68475dd-ed80-4cc4-b508-77314abfafa0}\n\n**SPOOL_STORAGE** c:\\\\System Volume Information\\\\{e69c37ac-a8ac-4827-8ce8-3126748e23bb}\n\n**STATE_FILE** c:\\\\System Volume Information\\\\{c089b325-4a8b-498b-bc12-51d325b91387}\n\n**BUS_LOG_STORAGE** c:\\\\System Volume Information\\\\_restore{ED650925-A32C-4E9C-8A73-8E6F0509309A}\\\\RP0\n\n**BUS_STORAGE** c:\\\\System Volume Information\\\\_restore{ED650925-A32C-4E9C-8A73-8E6F0509309A}\\\\RP1\n\n_Table 5. Configuration data for host loader (version with MD5: 7261230a43a40bb29227a169c2c8e1be)_\n\n**DLL_NAME** dsecsp.dll\n\n**MUTEX_NAME** Global\\\\{b3898039-f3d8-4965-b618-a8a0d031cc5a}\n\n**BASE_STORAGE** c:\\\\System Volume Information\\\\{9663c974-3112-4367-9c2a-06afbb7a67ce}\n\n**BLOB_STORAGE** c:\\\\System Volume Information\\\\{1864d9b7-0068-4979-87dc-c9668a9a2ae6}\n\n\n-----\n\n**KBLOG_UUID** {85f24f97-7321-4849-8c78-5989f5837ad4}\n\n**ILPSEND_UUID** {4d19edb2-5391-4f14-b27f-a3d553f411f4}\n\n**UPDATER_UUID** {6d46df72-115e-4c4c-a0a5-510dfe46f8aa}\n\n**TMP_STORAGE** c:\\\\System Volume Information\\\\{69785f90-a546-4ee0-8f1e-41ada23dbfcb}\n\n**SPOOL_STORAGE** c:\\\\System Volume Information\\\\{c0f55b36-0a62-400b-acbd-1a9624132f88}\n\n**STATE_FILE** c:\\\\System Volume Information\\\\{40a58472-645d-48d3-a150-54e049cd8166}\n\n**UPDATER_REPLAY_LOG** c:\\\\System Volume Information\\\\{54af39be-c3cd-4ee8-b2cb-6bfb3314b5b3}\n\n**BUS_LOG_STORAGE** c:\\\\System Volume Information\\\\_restore{ED650925-A32C-4E9C-8A73-8E6F0509309A}\\\\RP0\n\n**BUS_STORAGE** c:\\\\System Volume Information\\\\_restore{ED650925-A32C-4E9C-8A73-8E6F0509309A}\\\\RP1\n\n_Table 6. Configuration data for host loader (version with MD5: 48d0c8faaee08fc51346925090af89aa)_\n\nThe component acts as a loader for the following sub-modules:\n\n          - kblog\n\n          - ilpsend\n\n          - updater\n\nThe above components are loaded from files stored in the path referenced by the BLOB_STORAGE\nvariable in the configuration. These are decrypted and injected into running processes. A kblog\ncomponent was retrieved during the investigation which, as described below, is a keylogger. The other\nmodules were not retrieved, however it is very likely the ilpsend module is used to exfiltrate the keylogger\ndata over HTTPS or SMTP, and the update component is used to download updated versions of the\nmodule.\n\nEach Lua script also includes version information:\n\n          - 7261230a43a40bb29227a169c2c8e1be: VERSION = \"4.0\"\n\n          - 48d0c8faaee08fc51346925090af89aa: VERSION = \"5.2\"\n\n#### Keylogger\n\nThe following description is for the file with the MD5 hash of 6cd8311d11dc973e970237e10ed04ad7.\n\nThe keylogger logs data to the following locations:\n\n          - \"%WINDIR%\\\\temp\\\\bka*.da\"\n\n          - \"%WINDIR%\\\\temp\\\\bka*.dat\"\n\n          - \"C:\\\\System Volume Information\\\\_restore{ED650925-A32C-4E9C-8A73-\n8E6F0509309A}\\\\RP0\\\\change.log.*\"\n\n          - \"C:\\\\System Volume Information\\\\_restore{ED650925-A32C-4E9C-8A73-\n8E6F0509309A}\\\\RP1\\\\A*\"\n\nThe keylogger component may be referred to as SAURON by the attackers (based on\nSAURON_KBLOG_KEY). Collected data is exfiltrated using the ILPS module.\n\n_Figure 1. String referencing Sauron in Remsec keylogger module_\n\n\n-----\n\n### Network listeners\n\nA number of network listener components were discovered. These components used varying techniques\nto listen to network traffic, specifically looking for commands issued by an attacker. The commands are in\nthe form of (encrypted) executable code. The MD5 hashes of the files discovered are listed in Table 7.\n\n**MD5**\n0a0948d871ef5a3006c0ab2997ad330e\n113050c3e3140bf631d186d78d4b1dc0\n1d9d7d05ab7c68bdc257afb1c086fb88\n1f316e14e773ca0f468d0d160b5d0307\n7b8a3bf6fd266593db96eddaa3fae6f9\ncf6c049bd7cd9e04cc365b73f3f6098e\n7c3eecfb5174ca5cb1e03b8bf4b06f19\n\n_Table 7. MD5 hashes of network listener compononents discovered_\n\nThe samples provide a general-purpose framework to execute arbitrary modules sent by the attackers.\nThese modules are apparently in-memory, but some filesystem code is also present. The discovered\nsamples use different combinations of network listeners. Components collected so far\nsupport PcapUdp, PcapTcp, Pcap, Icmp, Dns, Raw, Pipe, and Http.\n\nAs an example, the ICMP listener opens a RAW socket and listens for ICMP echo request or response\npackets. If any such packet is discovered, the malware will attempt to decrypt the contents of the ICMP\nmessage. If the contents decrypt correctly, the decrypted code is then executed by the malware.\n\n### Named pipe\n\nThe following description is for the file with the MD5 hash of 9f81f59bc58452127884ce513865ed20.The\nsample provides a minimal back door controlled over named pipes. The following functionality is available\nto the remote attacker:\n\n          - Send _Executable_Blob_ containing arbitrary code to be executed\n\n          - Run arbitrary commands using _CreateProcessW_ API\n\nAdditional named pipe back doors with more functionality have also been discovered. These other back\ndoors are able to process more commands. The extra commands are listed below, per each sample.\n\n**Command** **Description**\n\n1 Read and optionally delete arbitrary file.\n\n2 Write arbitrary file.\n\n3 List content of arbitrary folder.\n\n4 Delete arbitrary file.\n\n5 Contains Executable_Blob with arbitrary code to be executed.\n\n6 Exit (guess).\n\n_Table 8. Back door commands per sample 7001A747EED1B2DA1C863B75500241F7_\n\n**Command** **Description**\n\n1 Read and optionally delete arbitrary file.\n\n2 Write arbitrary file.\n\n3 List content of arbitrary folder.\n\n4 Delete arbitrary file.\n\n5 Contains Executable_Blob with arbitrary code to be executed.\n\n\n-----\n\n6 Sets a flag - purpose unconfirmed.\n\n7 Start TCP proxy by:\nconnecting to arbitrary IPv4 endpoint address or\nbinding new socket to local IPv4 endpoint address selected by the attacker and accepting connection\nThe proxy will forward communication between the Named Pipe and the TCP connection.\n\n8 Contains blob with arbitrary code to be executed.\nThis blob does NOT follow the Executable_Blob format.\nCommunication between Back door and executed blob is apparently by way of created TCP connection.\n\n9 Check computer architecture using IsWow64Process API.\n\n_Table 9. Back door commands per sample 2cf1f878ab4eb2f043ccae7d653770c8_\n\n### HTTP back door\n\nA back door that uses HTTP for it's command and control functionality was found on several victims’\ncomputers. Two variants were discovered, files the with MD5 hashes of\nedb9e045b8dc7bb0b549bdf28e55f3b5 and 01ac1cd4064b44cdfa24bf4eb40290e7.\n\nThe configuration information in those samples included the following URLs:\n\n#### edb9e045b8dc7bb0b549bdf28e55f3b5:\n\n          - [http[://]flowershop22.110mb.com/shop.php](http://flowershop22.110mb.com/shop.php)\n\n          - [http[://]wildhorses.awardspace.info/hindex.php](http://wildhorses.awardspace.info/hindex.php)\n\n          - [http[://]www.myhomemusic.com/music.php](http://www.myhomemusic.com/music.php)\n\n#### 01ac1cd4064b44cdfa24bf4eb40290e7:\n\n          - [http[://]www.myhomemusic.com/mymusic.php](http://www.myhomemusic.com/mymusic.php)\n\n          - [http[://]flowershop22.110mb.com/flowers.php](http://flowershop22.110mb.com/flowers.php)\n\n          - http[://]wildhorses.awardspace.info/horses.php\n\n### Indicators of compromise\n\n#### Backdoor.Remsec hashes\n\n**MD5** **SHA256**\n2a8785bf45f4f03c10cd929bb0685c2d 6c8c93069831a1b60279d2b316fd36bffa0d4c407068dbef81b8e2fe8fd8e8cd\n\n171f39bd2f79963b5ec2b588b42da034 d629aa328fef1bd3c390751575f65d2f568b4b512132d77ab3693709ae2d5c84\n\n44879e5240fbe41c909c59abdcc678bc 9035a1e71c87620ead00d47c9db3768b52197703f124f097fa38dd6bf8e2edc8\n\nbf208df25db6ef67639765b2f0fc2c8c 36b74acba714429b07ab2205ee9fc13540768d7d8d9d5b2c9553c44ea0b8854f\n\nbeb2cc1694d89354a062b04b27811099 0f8af75782bb7cf0d2e9a78af121417ad3c0c62d8b86c8d2566cdb0f23e15cea\n\n113050c3e3140bf631d186d78d4b1dc0 bde264ceb211089f6a9c8cfbaf3974bf3d7bf4843d22186684464152c432f8a5\n\n546a2ebb0100ebff6c150fae49b87187 4a15dfab1d150f2f19740782889a8c144bd935917744f20d16b1600ae5c93d44\n\n7b8a3bf6fd266593db96eddaa3fae6f9 3782b63d7f6f688a5ccb1b72be89a6a98bb722218c9f22402709af97a41973c8\n\ncf6c049bd7cd9e04cc365b73f3f6098e 6b06522f803437d51c15832dbd6b91d8d8b244440b4d2f09bd952f335351b06d\n\n0886ace08961e71e5a572698307efdee 96e6b2cedaf2840b1939a9128751aec0f1ac724df76970bc744e3043281d3afd\n\n7c3eecfb5174ca5cb1e03b8bf4b06f19 02a9b52c88199e5611871d634b6188c35a174944f75f6d8a2110b5b1c5e60a48\n\n0a0948d871ef5a3006c0ab2997ad330e ab8181ae5cc205f1d3cae00d8b34011e47b735a553bd5a4f079f03052b74a06d\n\n1d9d7d05ab7c68bdc257afb1c086fb88 c8f95bf8a76ff124cc1d7a8439beff360d0eb9c0972d42a8684c3bd4e91c6600\n\n1f316e14e773ca0f468d0d160b5d0307 9572624b6026311a0e122835bcd7200eca396802000d0777dba118afaaf9f2a9\n\n\n-----\n\n7261230a43a40bb29227a169c2c8e1be d737644d612e5051f66fb97a34ec592b3508be06e33f743a2fdb31cdf6bd2718\n\n234e22d3b7bba6c0891de0a19b79d7ea 30a824155603c2e9d8bfd3adab8660e826d7e0681e28e46d102706a03e23e3a8\n\n6cd8311d11dc973e970237e10ed04ad7 a4736de88e9208eb81b52f29bab9e7f328b90a86512bd0baadf4c519e948e5ec\n\n01ac1cd4064b44cdfa24bf4eb40290e7 8e63e579dded54f81ec50ef085929069d30a940ea4afd4f3bf77452f0546a3d3\n\nedb9e045b8dc7bb0b549bdf28e55f3b5 96c3404dadee72b1f27f6d4fbd567aac84d1fdf64a5168c7ef2464b6c4b86289\n\n7001a747eed1b2da1c863b75500241f7 04ea378405c9aa879478db3d6488ce79b694393501555ccabc109fa0f4844533\n\n9f81f59bc58452127884ce513865ed20 720195b07c81e95dab4a1469342bc723938733b3846d7647264f6d0816269380\n\n58e770a9630e13129b4187cfcada76d0 2f128fff48d749f08786e618d3a44e2ac8020cc2ece5034cb1079901bbde6b7e\n\n65823a7f4c545cc64d7d478dd6866381 6189b94c9f3982ce15015d68f280f5d7a87074b829edb87825cadab6ec1c7ec2\n\n_Table 9. Hashes associated with Backdoor.Remsec_\n\n#### Network\n\n          - http[://]flowershop22.110mb.com/flowers.php\n\n          - http[://]flowershop22.110mb.com/shop.php\n\n          - http[://]wildhorses.awardspace.info/hindex.php\n\n          - http[://]wildhorses.awardspace.info/horses.php\n\n          - http[://]www.myhomemusic.com/music.php\n\n          - http[://]www.myhomemusic.com/mymusic.php\n\nDeveloping a network signature for the ICMP component is not straightforward, however it may be\npossible to identify suspect ICMP packets as follows:\n\n          - Packet size greater than 0x1c\n\n          - ICMP Echo or Response\n\n          - High entropy payload, at least non-numbers or letters. (Standard ICMP packets will typically\ncontains ASCII characters)\n\n#### Backdoor.Remsec Yara signatures\n```\n         rule remsec_executable_blob_32\n         {\n           meta:\n             copyright = \"Symantec\"\n           strings:\n             $code =\n             /*\n               31 06            l0: xor   [esi], eax\n               83 C6 04            add   esi, 4\n               D1 E8              shr   eax, 1\n               73 05              jnb   short l1\n               35 01 00 00 D0         xor   eax, 0D0000001h\n               E2 F0            l1: loop  l0\n             */\n             {\n               31 06\n               83 C6 04\n               D1 E8\n               73 05\n               35 01 00 00 D0\n\n```\n\n-----\n\n```\n               E2 F0\n             }\n           condition:\n             all of them\n         }\n         rule remsec_executable_blob_64\n         {\n           meta:\n             copyright = \"Symantec\"\n           strings:\n             $code =\n             /*\n               31 06            l0: xor   [rsi], eax\n               48 83 C6 04           add   rsi, 4\n               D1 E8              shr   eax, 1\n               73 05              jnb   short l1\n               35 01 00 00 D0         xor   eax, 0D0000001h\n               E2 EF            l1: loop  l0\n             */\n             {\n               31 06\n               48 83 C6 04\n               D1 E8\n               73 05\n               35 01 00 00 D0\n               E2 EF\n             }\n           condition:\n             all of them\n         }\n         rule remsec_executable_blob_parser\n         {\n           meta:\n             copyright = \"Symantec\"\n           strings:\n             $code =\n             /*\n               0F 82 ?? ?? 00 00        jb   l_0\n               80 7? 04 02           cmp   byte ptr [r0+4], 2\n               0F 85 ?? ?? 00 00        jnz   l_0\n               81 3? 02 AA 02 C1        cmp   dword ptr [r0],\n         0C102AA02h\n               0F 85 ?? ?? 00 00        jnz   l_0\n               8B ?? 06            mov   r1, [r0+6]\n             */\n             {\n              ( 0F 82 ?? ?? 00 00 | 72 ?? )\n               ( 80 | 41 80 ) ( 7? | 7C 24 ) 04 02\n              ( 0F 85 ?? ?? 00 00 | 75 ?? )\n               ( 81 | 41 81 ) ( 3? | 3C 24 | 7D 00 ) 02 AA 02 C1\n              ( 0F 85 ?? ?? 00 00 | 75 ?? )\n               ( 8B | 41 8B | 44 8B | 45 8B ) ( 4? | 5? | 6? | 7? | ?4 24 |\n         ?C 24 ) 06\n             }\n\n```\n\n-----\n\n```\n           condition:\n             all of them\n         }\n         rule remsec_encrypted_api\n         {\n           meta:\n             copyright = \"Symantec\"\n           strings:\n             $open_process =\n             /*\n               \"OpenProcess\\x00\" in encrypted form\n             */\n             { 91 9A 8F B0 9C 90 8D AF 8C 8C 9A FF }\n           condition:\n             all of them\n         }\n         rule remsec_packer_A\n         {\n           meta:\n             copyright = \"Symantec\"\n           strings:\n             $code =\n             /*\n               69 ?? AB 00 00 00        imul  r0, 0ABh\n               81 C? CD 2B 00 00        add   r0, 2BCDh\n               F7 E?              mul   r0\n               C1 E? 0D            shr   r1, 0Dh\n               69 ?? 85 CF 00 00        imul  r1, 0CF85h\n               2B               sub   r0, r1\n             */\n             {\n               69 ( C? | D? | E? | F? ) AB 00 00 00\n               ( 81 | 41 81 ) C? CD 2B 00 00\n               ( F7 | 41 F7 ) E?\n               ( C1 | 41 C1 ) E? 0D\n               ( 69 | 45 69 ) ( C? | D? | E? | F? ) 85 CF 00 00\n              ( 29 | 41 29 | 44 29 | 45 29 | 2B | 41 2B | 44 2B | 45 2B )\n             }\n           condition:\n             all of them\n         }\n         rule remsec_packer_B\n         {\n           meta:\n             copyright = \"Symantec\"\n           strings:\n             $code =\n             /*\n               48 8B 05 C4 2D 01 00      mov   rax, cs:LoadLibraryA\n               48 89 44 24 48         mov   qword ptr\n         [rsp+1B8h+descriptor+18h], rax\n               48 8B 05 A0 2D 01 00      mov   rax, cs:GetProcAddress\n\n```\n\n-----\n\n```\n               48 8D 4C 24 30         lea   rcx,\n         [rsp+1B8h+descriptor]\n               48 89 44 24 50         mov   qword ptr\n         [rsp+1B8h+descriptor+20h], rax\n               48 8D 84 24 80 00 00 00     lea   rax,\n         [rsp+1B8h+var_138]\n               C6 44 24 30 00         mov   [rsp+1B8h+descriptor],\n         0\n               48 89 44 24 60         mov   qword ptr\n         [rsp+1B8h+descriptor+30h], rax\n               48 8D 84 24 80 00 00 00     lea   rax,\n         [rsp+1B8h+var_138]\n               C7 44 24 34 03 00 00 00     mov   dword ptr\n         [rsp+1B8h+descriptor+4], 3\n               2B F8              sub   edi, eax\n               48 89 5C 24 38         mov   qword ptr\n         [rsp+1B8h+descriptor+8], rbx\n               44 89 6C 24 40         mov   dword ptr\n         [rsp+1B8h+descriptor+10h], r13d\n               83 C7 08            add   edi, 8\n               89 7C 24 68           mov   dword ptr\n         [rsp+1B8h+descriptor+38h], edi\n               FF D5              call  rbp\n               05 00 00 00 3A         add   eax, 3A000000h\n             */\n             {\n               48 8B 05 ?? ?? ?? ??\n               48 89 44 24 ??\n               48 8B 05 ?? ?? ?? ??\n               48 8D 4C 24 ??\n               48 89 44 24 ??\n               48 8D ( 45 ?? | 84 24 ?? ?? 00 00 )\n              ( 44 88 6? 24 ?? | C6 44 24 ?? 00 )\n               48 89 44 24 ??\n               48 8D ( 45 ?? | 84 24 ?? ?? 00 00 )\n               C7 44 24 ?? 0? 00 00 00\n               2B ?8\n               48 89 ?C 24 ??\n               44 89 6? 24 ??\n               83 C? 08\n               89 ?C 24 ??\n              ( FF | 41 FF ) D?\n              ( 05 | 8D 88 ) 00 00 00 3A\n             }\n           condition:\n             all of them\n         }\n\n```\n\n-----\n\n### About Symantec\n\nSymantec Corporation is the global leader in cybersecurity. Operating\none of the world’s largest cyber intelligence networks, we see more\nthreats, and protect more customers from the next generation of\nattacks. We help companies, governments and individuals secure their\nmost important data wherever it lives.\n\nFor specific country offices and contact numbers, please visit our\nwebsite.\n\n**Symantec Corporation World Headquarters**\n350 Ellis St.\nMountain View, CA 94043 USA\n+1 (650) 527-8000\n1 (800) 721-3934\n[www.symantec.com](http://www.symantec.com/)\n\nAny technical information that is made available by Symantec Corporation is the\ncopyrighted work of Symantec Corporation and is owned by Symantec Corporation.\n\nNO WARRANTY. The technical information is being delivered to you as is and\nSymantec Corporation makes no warranty as to its accuracy or use. Any use of the\ntechnical documentation or the information contained herein is at the risk of the user.\nDocumentation may include technical or other inaccuracies or typographical errors.\nSymantec reserves the right to make changes without prior notice.\n\nCopyright © 2016 Symantec Corporation. All rights reserved.\nSymantec, the Symantec Logo, and the Checkmark Logo are trademarks or registered\ntrademarks of Symantec Corporation or its affiliates in the U.S. and other countries. Other\nnames may be trademarks of their respective owners\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        }
    ],
    "references": [
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2016/2016.08.07.Strider_Cyberespionage_group_turns_eye_of_Sauron_on_targets/Symantec_Remsec_IOCs.pdf"
    ],
    "report_names": [
        "Symantec_Remsec_IOCs"
    ],
    "threat_actors": [
        {
            "id": "a0d369c1-f0b7-4c70-a3a5-77aabbd17979",
            "created_at": "2022-10-25T15:50:23.311311Z",
            "updated_at": "2025-03-27T02:00:55.438117Z",
            "deleted_at": null,
            "main_name": "Strider",
            "aliases": [
                "ProjectSauron"
            ],
            "source_name": "MITRE:Strider",
            "tools": [
                "Remsec"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "99845f58-2c39-46f7-8369-bb621ebb7002",
            "created_at": "2022-10-25T16:07:24.238844Z",
            "updated_at": "2025-03-27T02:02:10.14785Z",
            "deleted_at": null,
            "main_name": "Strider",
            "aliases": [
                "ProjectSauron"
            ],
            "source_name": "ETDA:Strider",
            "tools": [
                "Backdoor.Remsec",
                "ProjectSauron",
                "Remsec"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "c1ac2a5e-0225-47a4-8ac5-5fa898c96bde",
            "created_at": "2023-01-06T13:46:38.472883Z",
            "updated_at": "2025-03-27T02:00:02.84253Z",
            "deleted_at": null,
            "main_name": "ProjectSauron",
            "aliases": [
                "Sauron",
                "Project Sauron",
                "G0041"
            ],
            "source_name": "MISPGALAXY:ProjectSauron",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1666716494,
    "ts_updated_at": 1743041374,
    "ts_creation_date": 1470611974,
    "ts_modification_date": 1470611974,
    "files": {
        "pdf": "https://archive.orkl.eu/a7a8df94dc6cbbd33eadbb9e39538aa6fe78e798.pdf",
        "text": "https://archive.orkl.eu/a7a8df94dc6cbbd33eadbb9e39538aa6fe78e798.txt",
        "img": "https://archive.orkl.eu/a7a8df94dc6cbbd33eadbb9e39538aa6fe78e798.jpg"
    }
}