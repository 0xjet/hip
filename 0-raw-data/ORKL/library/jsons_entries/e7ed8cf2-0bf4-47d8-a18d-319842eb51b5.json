{
    "id": "e7ed8cf2-0bf4-47d8-a18d-319842eb51b5",
    "created_at": "2023-05-24T02:07:55.907183Z",
    "updated_at": "2025-03-27T02:16:34.904372Z",
    "deleted_at": null,
    "sha1_hash": "de0ab2f6450074086b035d458faf11c2b0004f00",
    "title": "Tracking Bumblebee's Development",
    "authors": "",
    "file_creation_date": "0001-01-01T00:00:00Z",
    "file_modification_date": "0001-01-01T00:00:00Z",
    "file_size": 2539151,
    "plain_text": "# Tracking Bumblebee’s\n Development\n\n\n### Suweera De Souza\n\n\n###### Senior Security Researcher at\n\n\n-----\n\n##### ● Bumblebee’s development timeline\n\n\n\n##### ● Endpoint Detection and Response (EDR) Evasion Techniques\n\n\n\n##### ● Assessment about the developers\n\n\n\n##### ● CrowdStrike Name: Shindig\n\n\n-----\n\n|15 September 2021|Col2|\n|---|---|\n|Reporting on CVE-2021-40444 attacks1||\n|||\n\n|17 March 2022|17 March 2022|Col3|\n|---|---|---|\n|First reporting of Bumblebee2 31 January 2022 First build as a bot|First reporting of Bumblebee2||\n||||\n|First build as a bot|||\n||||\n\n|Back from hiatus|Col2|\n|---|---|\n|||\n\n|Col1|Col2|\n|---|---|\n|3 Major Affiliates||\n\n|1 Major Februar|Col2|Col3|Col4|\n|---|---|---|---|\n||1 Major||Affiliate|\n\n\n1\n\n\n**10 August 2022** **Hiatus**\n\n**17 March 2022**\n\n**19 January 2023**\n\n**15 September 2021** Back from\n\nFirst reporting hiatus\nof Bumblebee[2] Back from\n\nReporting on\nhiatus\nCVE-2021-40444\n\nattacks[1]\n\n**31 January 2022** **9 October 2022**\n\nFirst build as a _SmokeBot_\n\nbot Distribution\n\n_BatLoader_\n\n3 Major Affiliates Distribution 1 Major Affiliate\n\n**March 2022** **24 October 2022** **February 2023**\n\n1 Major Affiliate\n\n\n-----\n\n-----\n\n|Loader Start Bot Start ● If EDR hook is present on RtlExitUserProcess, ensure Bumblebee’s thread finished execution to prevent EDR from accessing the thread ● Technique gets swapped for Thread execution hijacking|Col2|Col3|Col4|Col5|Col6|Col7|Col8|\n|---|---|---|---|---|---|---|---|\n||Loader Start ok is present on serProcess, ensure ee’s thread finished execution t EDR from accessing the e gets swapped for Thread hijacking|Loader Start||||||\n|● If EDR ho RtlExitU Bumbleb to preven thread ● Techniqu execution|ok is present on serProcess, ensure ee’s thread finished execution t EDR from accessing the e gets swapped for Thread hijacking|||||||\n|||||||||\n\n\nLoader introduced with remote library injection **Hiatus** **Execution** **Evasion** **Build**\n\n\n**Loader Start**\n\nIf EDR hook is present on\nRtlExitUserProcess , ensure\n’s thread finished execution\nto prevent EDR from accessing the\n\nTechnique gets swapped for Thread\nexecution hijacking\n\nLoader introduced with remote library injection **Hiatus** **Execution** **Evasion** **Build**\n\n\n-----\n\n##### ● Masquerades Bumblebee’s main DLL as a legitimate DLL\n ● Hooks APIs used by NTDLL for mapping and loading DLLs\n\n\n\n###### ○ Emulates their operations against a memory region\n\n##### ● POC released in 2004[1]\n\n ● Observed used by Ramnit[2]\n\n\n-----\n\n##### ● Masquerades Bumblebee under a decoy start routine\n\n\n\n###### ○ Start routine is hidden under RtlNewSecurityObjectWithMultipleInheritance\n\n##### ● Swaps the start routine in the suspended thread’s context\n ● Typically used for process injection[1]\n\n\n\n##### ● Observed used by COZY BEAR C2-Client Dropbox Loader[2]\n\n\n-----\n\n##### ● WebSocket protocol\n ● Message is stored as JSON\n ● Message is RC4 encrypted\n\n\n\n##### ● The hit message is crafted from the Al-Khaser techniques\n\n\n###### Task Result Request\n\nfrom Chrome and\n\nMSEdge\n\n\n###### Ping\n\nBeaconing-style\ncommunication -\nmessages are sent\n\nin a loop\n\n###### Hit\n\nbinary_db contains\n\nbrowsing history\nfrom Chrome and\n\nMSEdge\n\n###### Task\n\n\n-----\n\n|Col1|Col2|Col3|Unencrypt request/re|Col5|Col6|Col7|Col8|Encrypted Task request/response|Col10|Col11|Col12|Col13|Col14|Col15|\n|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|\n||||||Unencrypt request/re||ed Task sponse||||||||\n||||request/r||request/r||||||||||\n||||||||||||||||\n||||||||||Encrypted Task request/response||||||\n|||||||||r|r|||Pin reques||g + Task t/response|\n|||||||||||||re|||\n||||||||||||||||\n||||||||||||||||\n||||||||||||||||\n||||||||||||||||\n|Updates grouped by: ● Protocol ● User-Agent string ● URL endpoint string ● Client version|||||||||||||||\n|● JSON Messages|||||||||||||||\n||||||||||||||||\n\n\nUnencrypted Task\n\nrequest/response\n\nBot start\n\nEncrypted Task\n\nLoader request/response\nintroduced Ping + Task\n\nrequest/response\n\nUpdates grouped by:\n\n   - Protocol\n\n   - User-Agent string\n\n   - URL endpoint string\n\n\nUnencrypted Task\n\nrequest/response\n\nEncrypted Task\nrequest/response\n\n\n-----\n\n-----\n\n|Persistence is different based on ● PowerSploit ○ DPAPI for system e ○ Schedule task exec uses DPAPI to decr ● Packed DLL ○ Scheduled task use odbcconf to execute|the loader us ncryption1 utes a script t ypt the PS fil s LOLBin the DLL|ed: hat e|\n|---|---|---|\n||||\n|Initially a simple implementation o|f gdt was bei|ng tested2|\n||||\n||||\n||tem.security.cryp||\n\n|R n c|emote amed p ommun|Procedure Call (RPC) with ipes is used to icate with the plugins3|\n|---|---|---|\n||=windows||\n\n\nBot start\n\nPersistence is different based on the loader used:\n\n_●_ _PowerSploit_\n\n_○_ DPAPI for system encryption[1]\n\n     - Schedule task executes a script that\nuses DPAPI to decrypt the PS file\n\n  - Packed DLL\n\n     - Scheduled task uses LOLBin\nodbcconf to execute the DLL\n\nInitially a simple implementation of gdt was being tested[2]\n\nRemote Procedure Call (RPC) with\nnamed pipes is used to\ncommunicate with the plugins[3]\n\n**[1https://learn.microsoft.com/en-us/dotnet/api/system.security.cryptography.protecteddata?view=windowsdesktop-6.0](https://learn.microsoft.com/en-us/dotnet/api/system.security.cryptography.protecteddata?view=windowsdesktop-6.0)**\n\n\n-----\n\n#### Injection (with WMI)\n\n\n\n##### ● Injected code is added to the target process thread’s APC queue which gets executed when the thread enters an alterable state[1]\n\n ● Bumblebee injects its payloads into processes created with WMI\n\n\n###### DLL Injection\n\n\n-----\n\n##### ● Removes EDR hooks on APIs\n\n###### ○ Compares the API’s instructions in memory to that of the physical file\n ○ Compares instructions with a Length disassembler\n ○ Copy API’s instructions from physical file to memory\n\n##### ● Uses Remote Library Injection to load the payload DLL as a legitimate DLL\n\n ● Implementation matches libsplice[1]\n\n###### ○ Commonly observed:\n\n\n\n###### ■ Ramnit, TrickBot, BokBot\n ■ Game cheats\n\n\n-----\n\n##### ● Mapping activity to the software development lifecycle\n\n###### ○ Agile methodology\n\n ■ First release is a minimal viable product (MVP) - 31 January 2022 - 31 March 2022\n ■ Phase 2 introduced more EDR evasion - 31 March 2022 onwards\n ○ C2 infrastructure worked on during “hiatus”\n\n##### ● Stepping out of the norm\n\n###### ○ No API hashing or string obfuscation\n\n ■ Likely a result of using EDR evasion during execution\n\n##### ● Mature dev practices:\n\n###### ■ Boost\n\n ● C2 communication\n ● Command execution\n ■ libsplice - for Splicing\n\n\n-----\n\n## Thank You!\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "bf5be533-fa31-4590-ae37-5761c97ffa34",
            "created_at": "2022-10-25T16:13:58.389257Z",
            "updated_at": "2022-10-25T16:13:58.389257Z",
            "deleted_at": null,
            "name": "Malpedia",
            "url": "https://malpedia.caad.fkie.fraunhofer.de",
            "description": "Malpedia is a free service offered by Fraunhofer FKIE",
            "reports": null
        }
    ],
    "references": [
        "https://www.botconf.eu/wp-content/uploads/formidable/2/2023_4889_DESOUZA.pdf"
    ],
    "report_names": [
        "2023_4889_DESOUZA.pdf"
    ],
    "threat_actors": [
        {
            "id": "5b748f86-ac32-4715-be9f-6cf25ae48a4e",
            "created_at": "2024-06-04T02:03:07.956135Z",
            "updated_at": "2025-03-27T02:05:17.407352Z",
            "deleted_at": null,
            "main_name": "IRON HEMLOCK",
            "aliases": [
                "ATK7 ",
                "Blue Kitsune ",
                "Cozy Bear ",
                "The Dukes",
                "UNC2452 ",
                "YTTRIUM ",
                "APT29 "
            ],
            "source_name": "Secureworks:IRON HEMLOCK",
            "tools": [
                " CozyCar",
                " CozyDuke",
                " DiefenDuke",
                " FatDuke",
                " HAMMERTOSS",
                " LiteDuke",
                " MiniDuke",
                " OnionDuke",
                " PolyglotDuke",
                " RegDuke",
                " RegDuke Loader",
                " SeaDuke",
                " Sliver",
                "CosmicDuke"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "a241a1ca-2bc9-450b-a07b-aae747ee2710",
            "created_at": "2024-06-19T02:03:08.150052Z",
            "updated_at": "2025-03-27T02:05:17.409596Z",
            "deleted_at": null,
            "main_name": "IRON RITUAL",
            "aliases": [
                "Blue Dev 5 ",
                "BlueBravo ",
                "Cloaked Ursa ",
                "CozyLarch ",
                "Dark Halo ",
                "Midnight Blizzard ",
                "NOBELIUM ",
                "StellarParticle ",
                "UNC2452 ",
                "APT29"
            ],
            "source_name": "Secureworks:IRON RITUAL",
            "tools": [
                " Cobalt Strike",
                " EnvyScout",
                " GoldFinder",
                " GoldMax",
                " NativeZone",
                " RAINDROP",
                " SUNBURST",
                " Sibot",
                " TEARDROP",
                " VaporRage",
                "Brute Ratel C4"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "20d3a08a-3b97-4b2f-90b8-92a89089a57a",
            "created_at": "2022-10-25T15:50:23.548494Z",
            "updated_at": "2025-03-27T02:00:55.49688Z",
            "deleted_at": null,
            "main_name": "APT29",
            "aliases": [
                "APT29",
                "IRON RITUAL",
                "IRON HEMLOCK",
                "NobleBaron",
                "Dark Halo",
                "NOBELIUM",
                "UNC2452",
                "YTTRIUM",
                "The Dukes",
                "Cozy Bear",
                "CozyDuke",
                "SolarStorm",
                "Blue Kitsune",
                "UNC3524",
                "Midnight Blizzard"
            ],
            "source_name": "MITRE:APT29",
            "tools": [
                "PinchDuke",
                "ROADTools",
                "WellMail",
                "CozyCar",
                "Mimikatz",
                "Tasklist",
                "OnionDuke",
                "FatDuke",
                "POSHSPY",
                "EnvyScout",
                "SoreFang",
                "GeminiDuke",
                "GoldMax",
                "FoggyWeb",
                "SDelete",
                "PolyglotDuke",
                "AADInternals",
                "MiniDuke",
                "SeaDuke",
                "Sibot",
                "RegDuke",
                "CloudDuke",
                "GoldFinder",
                "AdFind",
                "PsExec",
                "NativeZone",
                "Systeminfo",
                "ipconfig",
                "Impacket",
                "Cobalt Strike",
                "PowerDuke",
                "QUIETEXIT",
                "HAMMERTOSS",
                "BoomBox",
                "CosmicDuke",
                "WellMess",
                "VaporRage",
                "LiteDuke"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "46b3c0fc-fa0c-4d63-a38a-b33a524561fb",
            "created_at": "2023-01-06T13:46:38.393409Z",
            "updated_at": "2025-03-27T02:00:02.822155Z",
            "deleted_at": null,
            "main_name": "APT29",
            "aliases": [
                "The Dukes",
                "Minidionis",
                "Grizzly Steppe",
                "G0016",
                "Blue Kitsune",
                "BlueBravo",
                "SeaDuke",
                "Cloaked Ursa",
                "YTTRIUM",
                "ATK7",
                "Nobelium",
                "UAC-0029",
                "Group 100",
                "COZY BEAR",
                "IRON HEMLOCK",
                "TA421",
                "ITG11"
            ],
            "source_name": "MISPGALAXY:APT29",
            "tools": [
                "QUARTERRIG",
                "SNOWYAMBER",
                "HALFRIG"
            ],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "f27790ff-4ee0-40a5-9c84-2b523a9d3270",
            "created_at": "2022-10-25T16:07:23.341684Z",
            "updated_at": "2025-03-27T02:02:09.74554Z",
            "deleted_at": null,
            "main_name": "APT 29",
            "aliases": [
                "APT 29",
                "ATK 7",
                "Blue Dev 5",
                "BlueBravo",
                "Cloaked Ursa",
                "CloudLook",
                "Cozy Bear",
                "Dark Halo",
                "Earth Koshchei",
                "Grizzly Steppe",
                "Group 100",
                "ITG11",
                "Iron Hemlock",
                "Iron Ritual",
                "Midnight Blizzard",
                "Minidionis",
                "Nobelium",
                "NobleBaron",
                "Operation Ghost",
                "Operation Office monkeys",
                "Operation StellarParticle",
                "SilverFish",
                "Solar Phoenix",
                "SolarStorm",
                "StellarParticle",
                "TEMP.Monkeys",
                "The Dukes",
                "UNC2452",
                "UNC3524",
                "Yttrium"
            ],
            "source_name": "ETDA:APT 29",
            "tools": [
                "7-Zip",
                "ATI-Agent",
                "AdFind",
                "Agentemis",
                "AtNow",
                "BEATDROP",
                "BotgenStudios",
                "CEELOADER",
                "Cloud Duke",
                "CloudDuke",
                "CloudLook",
                "Cobalt Strike",
                "CobaltStrike",
                "CosmicDuke",
                "Cozer",
                "CozyBear",
                "CozyCar",
                "CozyDuke",
                "Danfuan",
                "EnvyScout",
                "EuroAPT",
                "FatDuke",
                "FoggyWeb",
                "GeminiDuke",
                "Geppei",
                "GoldFinder",
                "GoldMax",
                "GraphDrop",
                "GraphicalNeutrino",
                "GraphicalProton",
                "HAMMERTOSS",
                "HammerDuke",
                "LOLBAS",
                "LOLBins",
                "LiteDuke",
                "Living off the Land",
                "MagicWeb",
                "Mimikatz",
                "MiniDionis",
                "MiniDuke",
                "NemesisGemina",
                "NetDuke",
                "OnionDuke",
                "POSHSPY",
                "PinchDuke",
                "PolyglotDuke",
                "PowerDuke",
                "QUIETEXIT",
                "ROOTSAW",
                "RegDuke",
                "Rubeus",
                "SNOWYAMBER",
                "SPICYBEAT",
                "SUNSHUTTLE",
                "SeaDaddy",
                "SeaDask",
                "SeaDesk",
                "SeaDuke",
                "Sharp-SMBExec",
                "SharpView",
                "Sibot",
                "Solorigate",
                "SoreFang",
                "TinyBaron",
                "WINELOADER",
                "WellMail",
                "WellMess",
                "cobeacon",
                "elf.wellmess",
                "reGeorg",
                "tDiscoverer"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1684894075,
    "ts_updated_at": 1743041794,
    "ts_creation_date": 0,
    "ts_modification_date": 0,
    "files": {
        "pdf": "https://archive.orkl.eu/de0ab2f6450074086b035d458faf11c2b0004f00.pdf",
        "text": "https://archive.orkl.eu/de0ab2f6450074086b035d458faf11c2b0004f00.txt",
        "img": "https://archive.orkl.eu/de0ab2f6450074086b035d458faf11c2b0004f00.jpg"
    }
}