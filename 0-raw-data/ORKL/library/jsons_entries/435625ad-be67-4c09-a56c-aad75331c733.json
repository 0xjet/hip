{
    "id": "435625ad-be67-4c09-a56c-aad75331c733",
    "created_at": "2023-01-12T15:09:21.822917Z",
    "updated_at": "2025-03-27T02:15:45.324322Z",
    "deleted_at": null,
    "sha1_hash": "5fc19ff2dd153e8dd8e69740bb7f63a175986da7",
    "title": "2019-09-19 - Emissary Panda APT- Recent infrastructure and RAT analysis",
    "authors": "",
    "file_creation_date": "2022-05-28T15:54:01Z",
    "file_modification_date": "2022-05-28T15:54:01Z",
    "file_size": 570237,
    "plain_text": "# 09/19/2019 - Emissary Panda APT: Recent infrastructure and RAT analysis\n\n**[meltx0r.github.io/tech/2019/09/19/emissary-panda-apt.html](https://meltx0r.github.io/tech/2019/09/19/emissary-panda-apt.html)**\n\nMELTX0R September 19, 2019\n\n## Summary\n\nEmissary Panda, a group that goes by many names (APT27, IronTiger, BronzeUnion, TG3390, and LuckyMouse), is a Chinese APT that is suspected of being active for nearly a\ndecade. This group has been known to target aerospace, government, defense, technology,\nenergy, and manufacturing sectors. Not much activity has been publicly recorded on this\ngroup as of late, but research indicates they are not dormant.\n\n## Analysis\n\nWhile performing research, I identified a suspect binary titled “odbcad32.exe”. What\nimmediately piqued my interest was that this binary, while having the appearance of the\nlegitimate “Open Database Connectivity Data Source Administrator utility” by Microsoft, was\nnot signed with a Microsoft certificate. Instead, this binary was signed with a certificate\nbelonging to “Hangzhou Bianfeng Networking Technology Co., Ltd.”. Open source research\non this company name indicates that it is a Chinese software company, and a subsidiary of\nthe media organization “Zhejiang Daily Digital”, which is headquartered in Hangzhou, China.\n\n\n-----\n\nShown above: Certificate used to sign malicious binary used by Emissary Panda APT\n\nAt this point, I decided to dig deeper into this binary and see why it was attempting to\ndisguise itself as a legitimate Microsoft utility. Upon execution, the binary would elevate\nprivileges and drop two files - odbccx32.dll in the C:\\Windows\\system32\\ folder, and a\nrandomly named batch file in the user’s local temp folder.\n```\n@echo off\n:err\ndel \"c:\\Users\\[Username]\\Desktop\\odbcad32.exe\" >nul\nif exist \"c:\\Users\\[Username]\\Desktop\\odbcad32.exe\" goto err\n>nul\n@echo on\ndel \"c:\\Users\\[Username]\\AppData\\Local\\Temp\\[random].bat\"\n\n```\nShown above: Content within the batch file\n\n_Net.exe was then launched with the parameters “stop “Remote Registry Configuration””._\nNext, rundll32.exe loads the aforementioned “odbccx32.dll”, and then another net.exe is\nlaunched with the parameters “start “Remote Registry Configuration””. Once the malicious\nDLL is loaded via rundll32.exe, it then establishes persistence via a new service. Cmd.exe\nthen executes the dropped batch file, which deletes the originally executed file, as well as the\nbatch file itself.\n\n\n-----\n\nFollowing this, Svchost.exe is executed and loads the malicious odbccx32.dll. It then drops\nthe file “autochk.sys” in the C:\\Windows\\system32\\drivers\\ folder, and reads the hosts file\nlocated in the C:\\Windows\\system32\\drivers\\etc\\hosts folder (this file contains the mappings\nof IP addresses to host names). Command & Control is then initiated to\n“yofeopxuuehixwmj.redhatupdater.com” over ports 53, 80, and 443. While this domain\ncurrently resolves to 80.85.153.176, no response was received from probing attempts, and\nno secondary payload was observed.\n\nShown above: Process graph\n\nThe TTP’s (Tactics, Techniques, and Procedures) observed in this sample are consistent with\nthose seen in past attacks conducted by the Emissary Panda APT group, specifically in\nrelation to the ZxShell Remote Access Trojan (RAT) which they have been observed using.\n\nI then pivoted into VirusTotal’s relational graphing utility to see if I could gather additional\ninformation on this campaign’s infrastructure. This revealed four structurally similar binaries\nthat I suspect of also being ZxShell RAT installers - one of which beaconed to the same\nCommand & Control server as the original sample (yofeopxuuehixwmj.redhatupdater.com).\nThe second and third binaries beaconed to language.wikaba.com and solution.instanthq.com\n\n- both of which have been documented as being Command & Control servers for past\nEmissary Panda APT campaigns. I was unable to confirm the fourth binary being a ZxShell\nRAT installer, which beacons to awvsf7esh.dellrescue.com, however VirusTotal deems that it\nis structurally similar to previously confirmed installers. Please note that the domain\n“dellrescue.com” has been documented by Cylance as having been used in a campaign\nconducted by PassCV APT group in 2016, although the subdomain utilized was different\n(sc.dellrescue.com).\n\n\n-----\n\nShown above: VirusTotal Graph\n\nAt this time, I was unable to obtain evidence of target attribution - however in the past\nEmissary Panda APT has been observed targeting Asia, Middle East, US, and UK based\norganizations and infrastructure. What struck me as most interesting from my analysis of this\nsample was how the Emissary Panda APT group was able to obtain a valid certificate to sign\ntheir Remote Access Trojan binary, which sparks the question - was this group able to\ncompromise the Chinese based software company and steal their certificate(s), or are there\npossible insider threats lurking within? Regardless, it is an interesting sample and displays\nthat Emissary Panda is still active.\n\n## Indicators\n\nIndicator Type Description\n\n70cff7c176c7df265a808aa52daf6f34 MD5 odbcad32.exe - ZxShell RAT\nInstaller\n\n37fc73c754ef2706659a18837a90ddaa MD5 odbcad32.exe - ZxShell RAT\nInstaller\n\n\n-----\n\nA9C2FF438C73E865624EEB0763235A14 MD5 odbccx32.dll - ZxShell RAT service\nDLL\n\nyofeopxuuehixwmj.redhatupdater.com Domain ZxShell RAT Command & Control\nserver\n\n1b2d75f9c7717f377100924cdbdb10b1 MD5 odbcad32.exe - Unconfirmed\nZxShell RAT Installer\n\nawvsf7esh.dellrescue.com Domain Unconfirmed ZxShell RAT\nCommand & Control server\n\n850df4a726a71f50d3cc7192c8cf7e6a MD5 odbcad32.exe - older ZxShell RAT\nInstaller from 2018\n\nb7f958f93e2f297e717cffc2fe43f2e9 MD5 odbcad32.exe - ZxShell RAT\nInstaller previously documented by\nDell SecureWorks CTU\n\nlanguage.wikaba.com Domain ZxShell RAT Command & Control\nserver previously documented by\nDell SecureWorks CTU\n\nsolution.instanthq.com Domain ZxShell RAT Command & Control\nserver previously documented by\nDell SecureWorks CTU\n\n## References/Further Reading\n\n1. https://www.secureworks.com/research/a-peek-into-bronze-unions-toolbox\n2. https://securelist.com/luckymouse-hits-national-data-center/86083/\n3. https://unit42.paloaltonetworks.com/emissary-panda-attacks-middle-east-government\nsharepoint-servers/\n4. https://thehackernews.com/2018/06/chinese-watering-hole-attack.html\n5. https://arstechnica.com/information-technology/2015/08/newly-discovered-chinese\nhacking-group-hacked-100-websites-to-use-as-watering-holes/\n6. https://attack.mitre.org/groups/G0027/\n7. https://threatvector.cylance.com/en_us/home/digitally-signed-malware-targeting\ngaming-companies.html\n8. https://app.any.run/tasks/91aee60c-6982-461a-a006-e601c8879fb0/\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2019/2019-09-19 - Emissary Panda APT- Recent infrastructure and RAT analysis.pdf"
    ],
    "report_names": [
        "2019-09-19 - Emissary Panda APT- Recent infrastructure and RAT analysis.pdf"
    ],
    "threat_actors": [
        {
            "id": "dda68b4f-a74a-42a0-b883-69c1dc1229a8",
            "created_at": "2023-01-06T13:46:38.528227Z",
            "updated_at": "2025-03-27T02:00:02.855486Z",
            "deleted_at": null,
            "main_name": "PassCV",
            "aliases": [],
            "source_name": "MISPGALAXY:PassCV",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "f3b19931-3751-4ece-a235-15b397951dc2",
            "created_at": "2022-10-25T16:07:23.889537Z",
            "updated_at": "2025-03-27T02:02:10.015565Z",
            "deleted_at": null,
            "main_name": "Nazar",
            "aliases": [
                "SIG37"
            ],
            "source_name": "ETDA:Nazar",
            "tools": [
                "Distribute.exe",
                "EYService",
                "GpUpdates.exe",
                "Microolap Packet Sniffer",
                "TCPDUMP for Windows"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "27b56f48-7905-4da8-8d87-cea10adb1c6b",
            "created_at": "2022-10-25T16:07:24.044105Z",
            "updated_at": "2025-03-27T02:02:10.089451Z",
            "deleted_at": null,
            "main_name": "PassCV",
            "aliases": [],
            "source_name": "ETDA:PassCV",
            "tools": [
                "Agentemis",
                "AngryRebel",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "Excalibur",
                "Farfli",
                "Gh0st RAT",
                "Ghost RAT",
                "Kitkiot",
                "Moudour",
                "Mydoor",
                "NetWeird",
                "NetWire",
                "NetWire RAT",
                "NetWire RC",
                "NetWired RC",
                "PCRat",
                "RbDoor",
                "Recam",
                "RibDoor",
                "Sabresac",
                "Sensocode",
                "Winnti",
                "ZXShell",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "e3492534-85a6-4c87-a754-5ae4a56d7c8c",
            "created_at": "2022-10-25T15:50:23.819113Z",
            "updated_at": "2025-03-27T02:00:55.552554Z",
            "deleted_at": null,
            "main_name": "Threat Group-3390",
            "aliases": [
                "Threat Group-3390",
                "Earth Smilodon",
                "TG-3390",
                "Emissary Panda",
                "BRONZE UNION",
                "APT27",
                "Iron Tiger",
                "LuckyMouse"
            ],
            "source_name": "MITRE:Threat Group-3390",
            "tools": [
                "Systeminfo",
                "gsecdump",
                "PlugX",
                "ASPXSpy",
                "Cobalt Strike",
                "Mimikatz",
                "Impacket",
                "gh0st RAT",
                "certutil",
                "China Chopper",
                "HTTPBrowser",
                "Tasklist",
                "netstat",
                "SysUpdate",
                "HyperBro",
                "ZxShell",
                "RCSession",
                "ipconfig",
                "Clambling",
                "pwdump",
                "NBTscan",
                "Pandora",
                "Windows Credential Editor"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "2c980ea7-04c4-4193-8535-52f87e66a96e",
            "created_at": "2024-05-01T02:03:07.994126Z",
            "updated_at": "2025-03-27T02:05:17.293799Z",
            "deleted_at": null,
            "main_name": "BRONZE UNION",
            "aliases": [
                "Budworm ",
                "Emissary Panda ",
                "Iron Tiger ",
                "Lucky Mouse ",
                "TG-3390 ",
                "Temp.Hippo ",
                "APT27 "
            ],
            "source_name": "Secureworks:BRONZE UNION",
            "tools": [
                " ASPXSpy",
                " China Chopper",
                " Enfal",
                " Gh0st RAT",
                " HttpBrowser",
                " Hunter",
                " HyperBro",
                " OwaAuth",
                " PlugX",
                " PoisonIvy",
                " Sysupdate",
                " ZxShell",
                "9002"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "c63ab035-f9f2-4723-959b-97a7b98b5942",
            "created_at": "2023-01-06T13:46:38.298354Z",
            "updated_at": "2025-03-27T02:00:02.798255Z",
            "deleted_at": null,
            "main_name": "APT27",
            "aliases": [
                "TG-3390",
                "EMISSARY PANDA",
                "TEMP.Hippo",
                "Budworm",
                "Group 35",
                "BRONZE UNION",
                "Lucky Mouse",
                "Iron Taurus",
                "GreedyTaotie",
                "Red Phoenix",
                "ZipToken",
                "Iron Tiger",
                "G0027",
                "Earth Smilodon"
            ],
            "source_name": "MISPGALAXY:APT27",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "5c13338b-eaed-429a-9437-f5015aa98276",
            "created_at": "2022-10-25T16:07:23.582715Z",
            "updated_at": "2025-03-27T02:02:09.875151Z",
            "deleted_at": null,
            "main_name": "Emissary Panda",
            "aliases": [
                "APT 27",
                "ATK 15",
                "Bronze Union",
                "Budworm",
                "Earth Smilodon",
                "Emissary Panda",
                "Group 35",
                "Iron Taurus",
                "Iron Tiger",
                "LuckyMouse",
                "Operation DRBControl",
                "Operation Iron Tiger",
                "Operation PZChao",
                "Operation SpoiledLegacy",
                "Operation StealthyTrident",
                "Red Phoenix",
                "TEMP.Hippo",
                "TG-3390",
                "ZipToken"
            ],
            "source_name": "ETDA:Emissary Panda",
            "tools": [
                "ASPXSpy",
                "ASPXTool",
                "Agent.dhwf",
                "AngryRebel",
                "Antak",
                "CHINACHOPPER",
                "China Chopper",
                "Destroy RAT",
                "DestroyRAT",
                "FOCUSFJORD",
                "Farfli",
                "Gh0st RAT",
                "Ghost RAT",
                "HTTPBrowser",
                "HTran",
                "HUC Packet Transmit Tool",
                "HighShell",
                "HttpBrowser RAT",
                "HttpDump",
                "HyperBro",
                "HyperSSL",
                "HyperShell",
                "Kaba",
                "Korplug",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "Mimikatz",
                "Moudour",
                "Mydoor",
                "Nishang",
                "OwaAuth",
                "PCRat",
                "PlugX",
                "ProcDump",
                "PsExec",
                "RedDelta",
                "SEASHARPEE",
                "Sensocode",
                "SinoChopper",
                "Sogu",
                "SysUpdate",
                "TIGERPLUG",
                "TVT",
                "Thoper",
                "Token Control",
                "TokenControl",
                "TwoFace",
                "WCE",
                "Windows Credential Editor",
                "Windows Credentials Editor",
                "Xamtrav",
                "ZXShell",
                "gsecdump",
                "luckyowa"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673536161,
    "ts_updated_at": 1743041745,
    "ts_creation_date": 1653753241,
    "ts_modification_date": 1653753241,
    "files": {
        "pdf": "https://archive.orkl.eu/5fc19ff2dd153e8dd8e69740bb7f63a175986da7.pdf",
        "text": "https://archive.orkl.eu/5fc19ff2dd153e8dd8e69740bb7f63a175986da7.txt",
        "img": "https://archive.orkl.eu/5fc19ff2dd153e8dd8e69740bb7f63a175986da7.jpg"
    }
}