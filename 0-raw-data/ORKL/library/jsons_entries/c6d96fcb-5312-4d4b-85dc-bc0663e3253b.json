{
    "id": "c6d96fcb-5312-4d4b-85dc-bc0663e3253b",
    "created_at": "2022-10-25T16:48:13.625397Z",
    "updated_at": "2025-03-27T02:10:17.292247Z",
    "deleted_at": null,
    "sha1_hash": "4b1ca2728629ffb86d2ce7277859e25ed0986f93",
    "title": "Introducing Hi-Zor RAT - Threat Geek",
    "authors": "",
    "file_creation_date": "2016-02-03T17:48:54Z",
    "file_modification_date": "0001-01-01T00:00:00Z",
    "file_size": 293189,
    "plain_text": "**[HOMEHOME](http://www.threatgeek.com)**\n\n\n**[« Strengthen Your Defenses against DDoS Cyber Extortion |](http://www.threatgeek.com/2016/01/strengthen-your-defenses-against-ddos-cyber-extortion.html)** **[Main](http://www.threatgeek.com/)**\n\n**Wednesday, January 27, 2016**\n\n**Security analysts and threat researchers**\n**are invited to attend the**\n**webinar Dissecting the Malware**\n**Involved in the INOCNATION Campaign**\n**details our investigation of INOCNATION**\n**and the new malware variant Hi-Zor.**\n**The webinar is scheduled for Thursday,**\n**January 28, 2016 at 2 pm ET.**\n\n**[In Fidelis Threat Advisory #1020 (FTA), we](https://www.fidelissecurity.com/sites/default/files/FTA_1020_Fidelis_Inocnation_FINAL.pdf)**\n\n**provided comprehensive analysis of a tool that**\n**had been observed in a campaign called**\n\n**INOCNATION. Fidelis Threat Research is now**\n\n**confident that the malware observed in that campaign is a new Remote Access Trojan (RAT) that we**\n**are calling Hi-Zor RAT based on strings observed in the sample.**\n\n**Hi-Zor RAT uses the following techniques, some of which have been observed in other APT tools:**\n\n**Uses string-stacking, a technique observed in the Etumbot and Ixeshe families.**\n\n**Creates a copy of itself in the systems with a ʻ.datʼ extension and entrenches it in the**\n**registry run key with ʻregsvr32.exeʼ pointing to a DLL file without a DLL extension. This**\n**technique has been observed in the Derusbi malware.**\n\n**Sends a victimʼs Volume Serial Number information in the beacon. This technique has been**\n**observed in Sakula.**\n\n**Double XOR to encode command and control.**\n\n**Uses common applications, such as VPN installers, as the decoy. This tactic has been**\n**observed in Sakula.**\n\n**Beyond these techniques, it provides core RAT features such as:**\n\n**Process execution**\n\n**Reverse shell**\n\n**File management**\n\n**Upload/Download**\n\n**Kill switch/Uninstall**\n\n**[Fidelis Threat Advisory #1020 provides detailed analysis of these facets. New indicators and an](https://www.fidelissecurity.com/sites/default/files/FTA_1020_Fidelis_Inocnation_FINAL.pdf)**\n\n**[updated Yara rule are available for download here.](https://github.com/fideliscyber)**\n\n**There are few samples of Hi-Zor RAT that have been observed in public malware repositories such as**\n\n**VirusTotal. In our estimation, Hi-Zor RAT represents continued investment and tooling by APT actors**\n\n**and it is our expectation that it will feature in future intrusions.**\n\n## Why is the Hi-Zor RAT not Sakula?\n\n**Crowdstrike first notified the world about this tool in their blog post ʻ** **[Sakula Reloaded.ʼ The following](http://www.crowdstrike.com/blog/sakula-reloaded/)**\n\n**analysis is why weʼre defining Hi-Zor to be distinct from Sakula RAT.**\n\n**Our comparative analysis is based on the following Hi-Zor malware sample related to the INOCNATION**\n\n**campaign:**\n\n**MD5** **SHA256**\n\n**75d3d1f23628122a64a2f1b7ef33f5cf** **cd07ac5947c643854375603800a4f70e2dfe202c8a1f801204328921cb3a2a4c**\n\n**As a reference, to obtain publicly documented samples of Sakula, we used the article released by Dell**\n**[SecureWorks: Sakula Malware Family](http://www.secureworks.com/cyber-threat-intelligence/threats/sakula-malware-family/)**\n\n**MD5** **SHA256**\n\n**f25cc334809bd1c36fd94184177de8a4** **2b4cc716ec23a095d831069968d951a125f40574775f466f4251c8a0a37abfca**\n\n**Some differences were found between the above samples:**\n\n#### 1. Code comparison with BinDiff\n\n**Comparing the code with the Google BinDiff, the tool found that only 5% of the code is similar.**\n\n\n#### Search\n\n Categories\n\n# advanced malware\n### Advanced Persistent Threat\n#### advanced persistent threat protection advanced threats\n\n**[Apple](http://www.threatgeek.com/apple/)** **[APT prevention](http://www.threatgeek.com/apt-prevention/)** **[APT protection](http://www.threatgeek.com/apt-protection/)**\n**[Arming the Boardroom](http://www.threatgeek.com/arming-the-boardroom/)** **[Back to the Basics](http://www.threatgeek.com/back-to-the-basics/)** **Ben**\n**Greenberg** **[Bill Harback](http://www.threatgeek.com/bill-harback/)** **[Black Hat](http://www.threatgeek.com/black-hat/)** **Christopher**\n**Clark** **[CISO](http://www.threatgeek.com/ciso/)** **[Computer Forensics](http://www.threatgeek.com/computer-forensics/)** **content**\n**inspection** **[content monitoring](http://www.threatgeek.com/content-monitoring/)** **content**\n**protection** **[Curt Shaffer](http://www.threatgeek.com/curt-shaffer/)** **cyber information**\n\n**protection** **[Cyber Scoop](http://www.threatgeek.com/cyber-scoop/)** **cyber threat**\n#### intelligence cyber threat\n## security cybercrime Cybersecurity\n**legislation** **[Darian Lewis](http://www.threatgeek.com/darian-lewis/)** **data breach**\n**prevention** **[data breach prevention solution](http://www.threatgeek.com/data-breach-prevention-solution/)**\n#### data breaches data leakage prevention\n**[data loss prevention](http://www.threatgeek.com/data-loss-prevention/)** **data loss prevention**\n**products** **[data loss prevention tools](http://www.threatgeek.com/data-loss-prevention-tools/)** **data theft**\n**prevention** **[David Chirico](http://www.threatgeek.com/david-chirico/)** **[David Gilbert](http://www.threatgeek.com/david-gilbert/)** **[DDoS](http://www.threatgeek.com/ddos/)**\n**[deep session inspection](http://www.threatgeek.com/deep-session-inspection/)** **[Emilio Iasiello](http://www.threatgeek.com/emilio-iasiello/)**\n**[Empowering the Board Room](http://www.threatgeek.com/empowering-the-board-room/)** **[encryption](http://www.threatgeek.com/encryption/)** **extrusion**\n**prevention** **[Fidelis Threat Advisories](http://www.threatgeek.com/fidelis-threat-advisory/)** **[Fidelis XPS](http://www.threatgeek.com/fidelis-xps/)**\n**[Gene Savchuk](http://www.threatgeek.com/gene-savchuk/)** **[Hardik Modi](http://www.threatgeek.com/hardik-modi/)** **[incident response](http://www.threatgeek.com/incident-response/)**\n**[information assurance information flow](http://www.threatgeek.com/information-assurance/)**\n**[information flow map](http://www.threatgeek.com/information-flow-map/)** **[information protection](http://www.threatgeek.com/information-protection/)**\n**[insider threat intelligent network forensics](http://www.threatgeek.com/insider-threat/)**\n**[intrusion detection intrusion detection and](http://www.threatgeek.com/intrusion-detection/)**\n**[prevention systems intrusion prevention appliance](http://www.threatgeek.com/intrusion-prevention-appliance/)**\n**[Jim Jaeger](http://www.threatgeek.com/jim-jaeger/)** **[John Bambenek](http://www.threatgeek.com/john-bambenek/)** **[John Laycock](http://www.threatgeek.com/john-laycock/)** **Josh**\n**Dalman** **[Justin Harvey](http://www.threatgeek.com/justin-harvey/)** **[Keith Jones](http://www.threatgeek.com/keith-jones/)** **[Ken Rutsky](http://www.threatgeek.com/ken-rutsky/)**\n**[Kim Stokes](http://www.threatgeek.com/kim-stokes/)** **[Kristen Cooper](http://www.threatgeek.com/kristen-cooper/)** **[Kurt Bertone](http://www.threatgeek.com/kurt-bertone/)**\n**[malware](http://www.threatgeek.com/malware/)** **[malware detection](http://www.threatgeek.com/malware-detection/)** **Michael**\n**Buratowski** **[Michael Nichols](http://www.threatgeek.com/mike-nichols/)** **[NAV](http://www.threatgeek.com/nav/)** **network**\n**analysis and visibility** **[network defense](http://www.threatgeek.com/network-defense/)**\n**[network forensics](http://www.threatgeek.com/network-forensics/)** **[network forensics tools](http://www.threatgeek.com/network-forensics-tools/)**\n**[network monitoring](http://www.threatgeek.com/network-monitoring/)** **network security**\n**appliance** **[network security monitoring network](http://www.threatgeek.com/network-security-monitoring/)**\n**surveillance** **[network visibility](http://www.threatgeek.com/network-visibility/)** **NGFW / next**\n**generation firewall** **[packet capture Pat Brooks](http://www.threatgeek.com/packet-capture/)**\n\n**[Patent](http://www.threatgeek.com/patent/)** **[PDF malware](http://www.threatgeek.com/pdf-malware/)** **[Peter George](http://www.threatgeek.com/peter-george/)** **prevent**\n#### cyber attacks prevent data breaches protect against APT\n**[ransomware](http://www.threatgeek.com/ransomware/)** **[Reconcilable Differences](http://www.threatgeek.com/reconcilable-differences/)** **RSA**\n**Conference** **[Ryan Vela](http://www.threatgeek.com/ryan-vela/)** **[Samsung](http://www.threatgeek.com/samsung/)** **[Sig Murphy](http://www.threatgeek.com/sig-murphy/)**\n**[situational awareness](http://www.threatgeek.com/situational-awareness/)** **[threat assessment](http://www.threatgeek.com/threat-assessment/)**\n### threat geek threat intelligence\n**[threat intelligence feed](http://www.threatgeek.com/threat-intelligence-feed/)** **[threat mitigation](http://www.threatgeek.com/threat-mitigation/)**\n#### THREATtoons Tom Lyons wikileak\n**[wikileaks](http://www.threatgeek.com/wikileaks/)** **[Will Irace](http://www.threatgeek.com/will-irace/)** **[XPS](http://www.threatgeek.com/xps/)** **[zero day attacks](http://www.threatgeek.com/zero-day-attacks/)**\n\n#### Archives\n\n**[January 2016](http://www.threatgeek.com/2016/01/index.html)**\n\n**[December 2015](http://www.threatgeek.com/2015/12/index.html)**\n\n**[November 2015](http://www.threatgeek.com/2015/11/index.html)**\n\n**[October 2015](http://www.threatgeek.com/2015/10/index.html)**\n\n**[September 2015](http://www.threatgeek.com/2015/09/index.html)**\n\n**[August 2015](http://www.threatgeek.com/2015/08/index.html)**\n\n**[July 2015](http://www.threatgeek.com/2015/07/index.html)**\n\n**[June 2015](http://www.threatgeek.com/2015/06/index.html)**\n\n**[May 2015](http://www.threatgeek.com/2015/05/index.html)**\n\n**[April 2015](http://www.threatgeek.com/2015/04/index.html)**\n\n|MD5|SHA256|\n|---|---|\n|75d3d1f23628122a64a2f1b7ef33f5cf|cd07ac5947c643854375603800a4f70e2dfe202c8a1f801204328921cb3a2a4c|\n\n|MD5|SHA256|\n|---|---|\n|f25cc334809bd1c36fd94184177de8a4|2b4cc716ec23a095d831069968d951a125f40574775f466f4251c8a0a37abfca|\n\n\n-----\n\n**[Contagio Malware Dump](http://contagiodump.blogspot.com/)**\n\n**[Cyber, War and Law](http://www.cyberwarandlaw.com/)**\n\n**[Dark Reading](http://www.darkreading.com/blog)**\n\n**[Didier Stevens](http://blog.didierstevens.com/)**\n\n**[F-Secure](http://www.f-secure.com/weblog/)**\n\n**[John Kindervag's blog](http://blogs.forrester.com/john_kindervag)**\n\n**[John Pescatore](http://blogs.gartner.com/john_pescatore/)**\n\n**[Malware Tracker](http://blog.malwaretracker.com/)**\n\n**[Mark McDonald](http://blogs.gartner.com/mark_mcdonald/)**\n\n**[Metasploit](http://blog.metasploit.com/)**\n\n**[Naked Security](http://nakedsecurity.sophos.com/)**\n\n**[Packetstan](http://www.packetstan.com/)**\n\n**[PaulDotCom Security Podcast](http://pauldotcom.com/)**\n\n**[Risk Factor](http://spectrum.ieee.org/blog/riskfactor)**\n\n**[Schneier on Security](http://www.schneier.com/)**\n\n**[Security Bloggers Network](http://www.securitybloggersnetwork.com/)**\n\n**[TaoSecurity](http://taosecurity.blogspot.com/)**\n\n**[Tech Dirt](http://www.techdirt.com/)**\n\n**[Tenable Network Security](http://blog.tenable.com/)**\n\n**[The Ashimmy Blog](http://www.stillsecureafteralltheseyears.com/)**\n\n**[The Forensics & Incident Response Daily](http://paper.li/andrewsmhay/forensics-and-ir)**\n\n**[The Forrester Blog](http://blogs.forrester.com/security_and_risk)**\n\n**[TheSecurityBlog](http://www.thesecurityblog.com/)**\n\n**[Threat Expert](http://blog.threatexpert.com/)**\n\n**[Threat Level](http://www.wired.com/threatlevel/)**\n\n**[Threat Post](http://threatpost.com/)**\n\n**[ThreatChaos](http://www.threatchaos.com/)**\n\n|basicBlock matches (library)|116|\n|---|---|\n|basicBlock matches (non-library)|65|\n|basicBlocks primary (library)|65|\n|basicBlocks primary (non-library)|327|\n|basicBlocks secondary (library)|3161|\n|basicBlocks secondary (non-library)|423|\n|flowGraph edge matches (library)|93|\n|flowGraph edge matches (non-library)|40|\n|flowGraph edges primary (library)|93|\n|flowGraph edges primary (non-library)|440|\n|flowGraph edges secondary (library)|4489|\n|flowGraph edges secondary (non-library)|586|\n|function matches (library)|30|\n|function matches (non-library)|49|\n|functions primary (library)|6|\n|functions primary (non-library)|101|\n|functions secondary (library)|246|\n|functions secondary (non-library)|153|\n|instruction matches (library)|285|\n|instruction matches (non-library)|254|\n|instructions primary (library)|242|\n|instructions primary (non-library)|4692|\n|instructions secondary (library)|13158|\n|instructions secondary (non-library)|2945|\n|basicBlock: MD index matching (bottom up)|3|\n|basicBlock: MD index matching (top down)|4|\n|basicBlock: call reference matching|2|\n|basicBlock: edges Lengauer Tarjan dominated|4|\n|basicBlock: edges MD index (bottom up)|18|\n|basicBlock: edges MD index (top down)|37|\n|basicBlock: edges prime product|19|\n\n\n-----\n\n|basicBlock: exit point matching|5|\n|---|---|\n|basicBlock: exit point matching|2|\n|basicBlock: jump sequence matching|2|\n|basicBlock: loop entry matching|2|\n|basicBlock: prime matching (0 instructions minimum)|4|\n|basicBlock: propagation (size==1)|53|\n|basicBlock: relaxed MD index matching|4|\n|basicBlock: self loop matching|2|\n|function: MD index matching (flowgraph MD index, top down)|1|\n|function: address sequence|2|\n|function: call reference matching|3|\n|function: call sequence matching(exact)|13|\n|function: call sequence matching(sequence)|39|\n|function: loop count matching|1|\n|function: name hash matching|20|\n|Confidence|0.267055127|\n|Similarity|0.053533386|\n\n\n#### 2. IDA code decompilation\n\n**The following screenshots show the main SWITCH statements between the samples showing their**\n**difference (click to enlarge):**\n\n**3. Network traffic**\n\n**The network traffic between both samples is also different. The Sakula samples beacons out with the**\n\n**following traffic:**\n\n\n**POST /newimage.asp?imageid=ivpgvz-1004122437&type=0&resid=365854765**\n\n**HTTP/1.1**\n\n**User-Agent: iexplorer**\n\n**Host: citrix.vipreclod[dot]com**\n\n**Content-Length: 176**\n\n**Cache-Control: no-cache**\n\n\n**The malware discussed in** **[Fidelis Threat Advisory #1020 beacons over a secure connection (e.g. TLS)](https://www.fidelissecurity.com/sites/default/files/FTA_1020_Fidelis_Inocnation_FINAL.pdf)**\n\n**with the following traffic:**\n\n\n-----\n\n**User-Agent: Mozilla/5.0 (Windows NT 6.3; WOW64; Trident/7.0; rv:11.0) like Gecko**\n\n**Host: inocnation[dot]com**\n\n**Content-Length: 8**\n\n**Connection: Keep-Alive**\n\n\n**In the above traffic, both samples send the Volume Serial Number in the same format, but the traffic is**\n\n**still different. The traffic from the Hi-Zor sample includes the victimʼs system Computer Name and is**\n\n**sent over a secure connection.**\n\n#### 4. String obfuscation\n\n**In the Sakula sample analyzed, the malware configuration (e.g. C2, URL, Filename, etc.) is obfuscated**\n\n**with a single byte XOR key of “0x56”.**\n\n**In the Hi-Zor sample, the C2 configuration is obfuscated with a double XOR with the following keys:**\n\n**“0x70” and “0x79”.**\n\n**The string stacking technique is also widely used in the Hi-Zor sample, while this technique is not**\n\n**observed in the Sakula sample inspected.**\n\n#### 5. File type\n\n**The Sakula malware is a “.EXE” file and the malware in the FTA is a “.DLL” file.**\n\n#### 6. Registry entrenchment\n\n**The Sakula malware entrenches in the system here:**\n\n\n**Key:**\n\n**HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run**\n\n**Value name:  MicroMedia**\n\n**Value data:   %TEMP%\\MicroMedia\\MediaCenter.exe**\n\n**While the Hi-Zor sample entrenches in the system here:**\n\n**Key:         HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run**\n\n**Value name:  AdobePlayer**\n\n**Value data:   regsvr32 /s \"%APPDATA%\\adobe\\adobe.dat\"**\n\n\n#### 7. Embedded files\n\n**The Sakula sample inspected contained a 32-bits and a 64-bits DLL obfuscated in its resource section.**\n\n**These DLLs were decoded with a single-byte XOR key of 0x24. The decoding process skipped values**\n\n**with the same XOR key and null (0) values. According to SecureWorks, this code is used for UAC**\n\n**bypass. This is not observed in the Hi-Zor sample.**\n\n**Due to these differences between the sample in FTA #1020 and the Sakula samples inspected, we have**\n\n**decided to distinguish the malware reverse engineered in the FTA and assign it the distinctive name**\n\n**Hi-Zor. More malware threat analysis to come in future blogs and Fidelis Threat Advisories.**\n\n**-- The Fidelis Threat Research Team**\n\n**[Posted by ThreatGeek at 12:52 PM in advanced malware, malware, malware detection | Permalink](http://profile.typepad.com/6p0147e41f3c0a970b)**\n\n\n**LikeLike**\n\n\n**[©2011 - 2015 Fidelis Cybersecurity | 1.800.652.4020](http://www.fidelissecurity.com/)**\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        }
    ],
    "references": [
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2016/2016.01.27.Hi-Zor.RAT/introducing-hi-zor-rat.html.pdf"
    ],
    "report_names": [
        "introducing-hi-zor-rat.html"
    ],
    "threat_actors": [
        {
            "id": "d18fe42c-8407-4f96-aee0-a04e6dce219a",
            "created_at": "2023-01-06T13:46:38.275292Z",
            "updated_at": "2025-03-27T02:00:02.79092Z",
            "deleted_at": null,
            "main_name": "APT12",
            "aliases": [
                "Calc Team",
                "IXESHE",
                "BRONZE GLOBE",
                "BeeBus",
                "DynCalc",
                "DNSCalc",
                "Crimson Iron",
                "NUMBERED PANDA",
                "TG-2754",
                "Group 22"
            ],
            "source_name": "MISPGALAXY:APT12",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "6a660ea2-1118-404a-9f8f-f0d6a1e9f184",
            "created_at": "2022-10-25T15:50:23.685924Z",
            "updated_at": "2025-03-27T02:00:55.52357Z",
            "deleted_at": null,
            "main_name": "APT12",
            "aliases": [
                "APT12",
                "IXESHE",
                "DynCalc",
                "Numbered Panda",
                "DNSCALC"
            ],
            "source_name": "MITRE:APT12",
            "tools": [
                "Ixeshe",
                "RIPTIDE",
                "HTRAN"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1666716493,
    "ts_updated_at": 1743041417,
    "ts_creation_date": 1454521734,
    "ts_modification_date": 0,
    "files": {
        "pdf": "https://archive.orkl.eu/4b1ca2728629ffb86d2ce7277859e25ed0986f93.pdf",
        "text": "https://archive.orkl.eu/4b1ca2728629ffb86d2ce7277859e25ed0986f93.txt",
        "img": "https://archive.orkl.eu/4b1ca2728629ffb86d2ce7277859e25ed0986f93.jpg"
    }
}