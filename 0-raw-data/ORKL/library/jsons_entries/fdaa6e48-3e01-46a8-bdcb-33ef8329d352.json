{
    "id": "fdaa6e48-3e01-46a8-bdcb-33ef8329d352",
    "created_at": "2023-01-12T14:59:55.749868Z",
    "updated_at": "2025-03-27T02:13:12.19713Z",
    "deleted_at": null,
    "sha1_hash": "18780b6689048038b079c46a46c21fd99709d063",
    "title": "2021-04-22 - Tor-Based Botnet Malware Targets Linux Systems, Abuses Cloud Management Tools",
    "authors": "",
    "file_creation_date": "2022-05-28T00:42:12Z",
    "file_modification_date": "2022-05-28T00:42:12Z",
    "file_size": 905568,
    "plain_text": "# Tor-Based Botnet Malware Targets Linux Systems, Abuses Cloud Management Tools\n\n**trendmicro.com/en_us/research/21/d/tor-based-botnet-malware-targets-linux-systems-abuses-cloud-management-**\ntools.html\n\nApril 22, 2021\n\nMalware\n\nWe found a botnet malware campaign targeting Linux systems, abusing the Tor network for\nproxies, and exploiting cloud infrastructure management tools for intrusion.\n\nBy: David Fiser, Alfredo Oliveira April 22, 2021 Read time: ( words)\n\nThe rise of [threats that target Linux has dispelled the myth that there is no malware that goes](https://www.trendmicro.com/vinfo/tmr/?/us/security/news/cybercrime-and-digital-threats/a-look-at-linux-threats-risks-and-recommendations)\nafter the ubiquitous operating system. As Linux attracts more attention from malicious actors,\n[we have also started seeing threats evolving — abusing services like Ngrok and using](https://blog.trendmicro.com/trendlabs-security-intelligence/exposed-docker-control-api-and-community-image-abused-to-deliver-cryptocurrency-mining-malware/)\nfunctions to [hunt and kill other competing malware.](https://www.trendmicro.com/en_us/research/20/i/war-of-linux-cryptocurrency-miners-a-battle-for-resources.html)\n\nMost of the samples we’ve recently been analyzing implement encoding techniques that are\nnot effective in protecting any content but are effective enough to slow down analysis via\ncomplex functions and multiple layers of code — making it difficult to find patterns to decode\nall layers at once. Among those we found in our scans is a botnet malware sample whose full\n\n\n-----\n\ncontent initially appeared to be Base64 text only, meant to be run [piped to Bash. As a result,](https://opensource.com/article/18/8/introduction-pipes-linux)\nthe shell would interpret the decoded shell script code, which was again encoded in a new\nlayer.\n\nHere we discuss some of the emerging techniques among malicious actors targeting Linux\nsystems: the use of Tor (The Onion Router) through a network of proxies using the Socks5\n[protocol, the abuse of legitimate DevOps tools, the subsequent downloads of malware](https://www.trendmicro.com/vinfo/tmr/?/us/security/definition/devops)\nsamples based on the architecture, and the removal or deactivation of competing malicious\ncryptocurrency miners, among other detection- and analysis-evasive features.\n\nTor proxies\n\nFigure 1. The infection chain of the botnet malware\nOne of the most interesting techniques this botnet malware implements is that all the files it\nneeds to download — post-infection scripts, malicious binaries — are hosted on the Tor\n[anonymity network. The botnet malware downloads the binaries (ss,](https://www.linux.com/topic/networking/introduction-ss-command/) [ps, and](https://man7.org/linux/man-pages/man1/ps.1.html) [curl) in case](https://curl.se/)\nthese are absent in the infected environment. While they are legitimate in and of themselves,\nthese tools are used by the malware to make HTTP requests, obtain information about the\n\n\n-----\n\nvictim system, and run processes. We also found that the malicious actors behind this\nmalware maintain a big network of proxies that receive the connection coming from the\nsurface web.\n\nWe also found another technique that the malware uses to perform HTTP requests using\nshell script and Unix system design, as opposed to using binaries like curl or wget, to get\nmore information on the infected systems.\n\nFigure 2. The downloader used by the botnet malware as an alternate technique in\nperforming HTTP requests\nThe proxies convert the requests to the Tor network before reaching out to the server and\nretrieving the files. They also send identifiable information about the victim system, including:\n\nIP addresses (randomized external and hashed internal)\nThe operating system architecture\nThe username currently running the script\nA part of the uniform resource identifier (URI) identifying the file to be downloaded\n(which is architecture-dependent)\nThe file to be saved, where -o indicates the file name that should be saved (also\nrandomized)\nThe host name running the script\n\nFigure 3. A breakdown of the command details\n\n\n-----\n\nWe also discovered that most of the proxy servers used have open services with multiple\nvulnerabilities. These might be indicative of previous exploitation and deployment of the Tor\nproxy service without the knowledge of the server owner. That the proxy service was always\ndisabled after a while in our weeks-long monitoring of the proxies suggests that this is the\ncase.\n\nFigure 4. Some details found from one of the used Tor proxies (e.g., ports)\n\nFigure 5. A disabled proxy\nMultiple architecture support and cloud services uninstallation\n\nAnother interesting feature is that this malware is capable of running in different architectures\nas long as the operating system is Linux or is based on it. The initial script does several\nrounds of checks and confirmations before downloading the files needed to further infect the\nmachine. This sample suggests that the malicious actors behind the malware might be\nlooking to deploy it as part of a wider campaign targeting Linux systems.\n\n[We also found that the sample includes a feature that removes certain cloud-related services](https://www.alibabacloud.com/help/doc-detail/64601.htm)\n[and agents, as indicated in the following parts of the code:](https://intl.cloud.tencent.com/document/product/248/6211)\n\n/usr/local/share/assist-daemon/assist_daemon –stop\n/usr/local/share/assist-daemon/assist_daemon –delete\n/usr/local/qcloud/monitor/barad/admin/uninstall.sh\n\n\n-----\n\n/usr/local/qcloud/stargate/admin/uninstall.sh\n/usr/local/qcloud/YunJing/uninst.sh\n/etc/init.d/aegis uninstall\nsystemctl stop aliyunsystemctl disable aliyun\n\nIaC tools abused for malware spreadingWorm-based behavior is no longer uncommon with\nLinux threats, but this is the first time we noticed the abuse of infrastructure-as-code (IaC)\ntools for malware spreading. In this sample, the script looks for executables related to the\n[infrastructure automation and management tools Ansible,](https://www.ansible.com/) [Chef, and](https://www.chef.io/) [Salt Stack to spread the](https://docs.saltproject.io/en/latest/)\nmalware. When infrastructure deployments or configurations are stored in one place, the\n[managed infrastructure as a whole is put at risk upon compromise.](https://www.trendmicro.com/vinfo/tmr/?/us/security/news/virtualization-and-cloud/infrastructure-as-code-security-risks-and-how-to-avoid-them)\n\nFigure 6. The IaC tools abused for malware spreading\nThe payloadWe found that, in keeping with the current malware trend, the sample installs a\ncryptocurrency miner, in the form of the Monero (XMR) miner XMRig. The configuration file is\nembedded into the binary. It’s also worth mentioning that unlike most other forms of\ncryptocurrency-mining malware, which use public pools, this one uses its own mining pool.\nThis might be because of the larger scale of the botnet as well as the need for stealth.\n\n\n-----\n\nFigure 7. XMRig with hard-coded configuration file\nAnother interesting fact is that, like the proxy service, the pool service stops after a while. In\naddition, the addresses used by the pools host other, unrelated servers. These conditions\nsuggest that the malicious actors behind the malware hack the servers to install the pool\nservice.\n\nFigure 8. A Monero pool address with the service running\n\n\n-----\n\nFigure 9. A Monero pool address with disabled service\nLooking at the crontab, we found that the malware is capable of removing other malicious\ncryptocurrency miners that are already embedded in the system, likely to ensure that only\none wallet gets illicit profit from the affected system. We also found in the crontab details of\nthe cloud services it searches for and disables with grep, which the malicious actors may\nupdate to include other services.\n\nFigure 10. The crontab showing the removal of other malicious cryptocurrency miners from\nthe system\nConclusionThis malware sample does not need other software; the Linux operating system is\nthe only requirement for the malware to run and spread. It downloads the essential tools (ss,\nps, curl) because not every environment targeted for infection has them and it’s likely that the\nuser doesn’t have the necessary permissions to install them on the system (as in the case of\ncontainers).\n\nAlready, the use of the Tor network provides the malware authors anonymity. Their use of\ncustom mining pools and a Monero cryptocurrency miner makes tracking them even more\ndifficult, perhaps nigh impossible. Their weaponization of IaC tools suggests that these\nmalicious actors are also well aware of the adoption of new technologies nowadays. More\ninstances of malicious actors hitching on new trends to facilitate their campaigns will likely\nemerge in the foreseeable future.\n\nThe case of this malware sample shows that misconfigurations or vulnerabilities are not the\nonly openings that malicious actors can take advantage of for their campaigns. Its code\nexecutions will not be possible without having access to its victim systems. Access to\n\n\n-----\n\nsystems must therefore be properly considered and secured, lest intruders or even malicious\ninsiders compromise the whole infrastructure.\n\nHere are several best practices for securing cloud infrastructures and environments:\n\n[Implement the principle of least privilege and adopt the](https://www.trendmicro.com/vinfo/tmr/?/us/security/news/security-technology/best-practices-deploying-an-effective-firewall) [shared responsibility model.](https://www.trendmicro.com/en_us/research/19/j/the-shared-responsibility-model.html)\n[Organizations and security teams should have the visibility and be able to limit the](https://www.trendmicro.com/vinfo/tmr/?/us/security/news/virtualization-and-cloud/navigating-gray-clouds-the-importance-of-visibility-in-cloud-security)\nauthorized personnel who have access to specific systems. They should also be aware\nof how sensitive data and confidential information are stored, and how separate\nsystems and environments are secured.\n[Replace default credentials with strong and secure passwords, and ensure that](https://blog.trendmicro.com/are-your-passwords-secure-enough/)\nsecurity settings of different systems’ environments are customized to the\norganization’s needs.\nUpdate and patch systems regularly.\n\nTrend Micro cloud security solutions\n\n[Trend Micro’s comprehensive XDR solution applies effective expert analytics to the deep](https://www.trendmicro.com/en_us/business/products/detection-response/xdr.html?utm_campaign=PRLA2019_Corporate_XDR&utm_medium=VURL&utm_source=General&utm_content=XDR)\ndata sets collected from Trend Micro solutions across the enterprise, making faster\nconnections to identify and stop attacks. Cloud-specific security solutions such as Trend\nMicro Hybrid Cloud Security can help protect cloud-native systems and their various layers.\n[Trend Micro Hybrid Cloud Security is powered by Trend Micro Cloud One™, a security](https://www.trendmicro.com/en_us/business/products/hybrid-cloud/cloud-migration-security.html)\nservices platform for cloud builders that provides automated protection for continuousintegration and continuous-delivery (CI/CD) pipelines and applications. It also helps identify\nand resolve security issues sooner and improve delivery time for DevOps teams. The Trend\nMicro Cloud One platform includes:\n\n[Workload Security: runtime protection for workloads](https://www.trendmicro.com/en_us/business/products/hybrid-cloud/cloud-one-workload-security.html)\n[Container Security: automated container image and registry scanning](https://www.trendmicro.com/en_us/business/products/hybrid-cloud/cloud-one-container-image-security.html)\n[File Storage Security: security for cloud files and object storage services](https://www.trendmicro.com/en_us/business/products/hybrid-cloud/cloud-one-file-storage-security.html)\n[Network Security: cloud network layer for intrusion prevention system (IPS) security](https://www.trendmicro.com/en_us/business/products/hybrid-cloud/cloud-one-network-security.html)\n[Application Security: security for serverless functions, APIs, and applications](https://www.trendmicro.com/en_us/business/products/hybrid-cloud/cloud-one-application-security.html)\n[Conformity: real-time security for cloud infrastructure — secure, optimize, comply](https://www.trendmicro.com/en_us/business/products/hybrid-cloud/cloud-one-conformity.html)\n\nIndicators of compromise\n\n**Proxy IP addresses**\n\n144[.]76[.]110[.]70:9050\n172[.]104[.]56[.]209:9050\n178[.]128[.]84[.]253:9050\n185[.]188[.]183[.]254:9050\n185[.]35[.]223[.]76:9050\n201[.]159[.]100[.]58:9050\n209[ ]97[ ]174[ ]97:9050\n\n\n-----\n\n45[.]32[.]171[.]166:9050\n46[.]101[.]61[.]9:9050\n46[.]229[.]55[.]38:9050\n46[.]229[.]55[.]39:9050\n51[.]103[.]16[.]14:9050\n51[.]68[.]214[.]156:9050\n51[.]75[.]163[.]92:9050\n51[.]89[.]149[.]71:9050\n67[.]149[.]39[.]182:9050\n77[.]120[.]123[.]179:9050\n77[.]66[.]176[.]9:9050\n82[.]37[.]194[.]181:9050\n83[.]217[.]28[.]46:9050\n85[.]159[.]44[.]163:9050\n85[.]234[.]143[.]106:9050\n91[.]194[.]250[.]134:9050\n92[.]63[.]192[.]7:9050\n\n**Onion links**\n\n7jmrbtrvkgcqkldzyob4kotpyvsgz546yvik2xv4rpnfmrhe4imxthqd[.]onion/int.x86_64\nbggts547gukhvmf4cgandlgxxphengxovoyo6ewhns5qmmb2b5oi43yd[.]onion/int.x86_64\nDreambusweduybcp[.]onion/cmd\ni62hmnztfpzwrhjg34m6ruxem5oe36nulzmxcgbdbkiaceubprkta7ad[.]onion/int.x86_64\nji55jjplpknk7eayxxtb5o3ulxuevntutsdanov5dp3wya7l7btjv4qd[.]onion\nji55jjplpknk7eayxxtb5o3ulxuevntutsdanov5dp3wya7l7btjv4qd[.]onion/int.x86_64\nmhevkk4odgzqpt2hbj3hhw2uz4vhunoo55evewrgmouyiehcaltmbrqd[.]onion/int.x86_64\nojk5zra7b3yq32timb27n4qj5udk4w2l5kqn5ulhnugdscelttfhtoyd[.]onion/int.x86_64\nplgs6otqdiu7snxdfwjnidhw4ncmp5qvvxi5gepiszg75kxebwci2wad[.]onion/int.x86_64\nRyukdssuskovhnwb[.]onion/int.x86_64\nsg722jwocbvedckhd4dptpqfek5fsbmx3v57qg6lzhuo56np73mb3zyd[.]onion/int.x86_64\ntrumpzbffbewy3gn[.]onion/int.x86_64\nTrumpzwlvlyrvlss[.]onion/int.x86_64\nUnixdbnuadxmwtob[.]onion/int.x86_64\nva6xh4hqgb754klsffjamjgotlq7mne3lyyrhu5vhypakbumzeo4c4ad[.]onion/int.x86_64\ny4mcrfeigcaa2robjk3azb2qwcd5hk45xpoaddupmdwv24qoggnmdbid[.]onion/int.x86_64\nyrxxxqia45xxcdqfwyx4pk6ufyanazdwjbv3de7r4mrtyztt5mpw35yd[.]onion/int.x86_64\n\n**Monero pools**\n\n119[.]205[.]235[.]58:443\n119[.]205[.]235[.]58:8080\n136[.]243[.]90[.]99:443\n136[ ]243[ ]90[ ]99:8080\n\n\n-----\n\n153[.]127[.]216[.]132:8080\n94[.]176[.]237[.]229:443\n94[.]176[.]237[.]229:80\n94[.]176[.]237[.]229:8080\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-04-22 - Tor-Based Botnet Malware Targets Linux Systems, Abuses Cloud Management Tools.pdf"
    ],
    "report_names": [
        "2021-04-22 - Tor-Based Botnet Malware Targets Linux Systems, Abuses Cloud Management Tools.pdf"
    ],
    "threat_actors": [
        {
            "id": "1f6ae238-765f-4495-9d54-6a7883d7a319",
            "created_at": "2022-10-25T16:07:24.573456Z",
            "updated_at": "2025-03-27T02:02:10.284644Z",
            "deleted_at": null,
            "main_name": "TA511",
            "aliases": [
                "MAN1",
                "Moskalvzapoe"
            ],
            "source_name": "ETDA:TA511",
            "tools": [
                "Agentemis",
                "Chanitor",
                "Cobalt Strike",
                "CobaltStrike",
                "Ficker Stealer",
                "Hancitor",
                "NetSupport",
                "NetSupport Manager",
                "NetSupport Manager RAT",
                "NetSupport RAT",
                "NetSupportManager RAT",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "542cf9d0-9c68-428c-aff8-81b6f59dc985",
            "created_at": "2023-02-15T02:01:49.554105Z",
            "updated_at": "2025-03-27T02:00:03.110991Z",
            "deleted_at": null,
            "main_name": "Moskalvzapoe",
            "aliases": [
                "MAN1",
                "TA511"
            ],
            "source_name": "MISPGALAXY:Moskalvzapoe",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673535595,
    "ts_updated_at": 1743041592,
    "ts_creation_date": 1653698532,
    "ts_modification_date": 1653698532,
    "files": {
        "pdf": "https://archive.orkl.eu/18780b6689048038b079c46a46c21fd99709d063.pdf",
        "text": "https://archive.orkl.eu/18780b6689048038b079c46a46c21fd99709d063.txt",
        "img": "https://archive.orkl.eu/18780b6689048038b079c46a46c21fd99709d063.jpg"
    }
}