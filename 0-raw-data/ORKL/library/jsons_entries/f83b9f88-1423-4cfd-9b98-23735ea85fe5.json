{
    "id": "f83b9f88-1423-4cfd-9b98-23735ea85fe5",
    "created_at": "2022-10-25T16:48:16.859241Z",
    "updated_at": "2025-03-27T02:16:06.757439Z",
    "deleted_at": null,
    "sha1_hash": "25488d84f657988170af8dbf0ac7b38b7140508f",
    "title": "VB2020 paper: Operation LagTime IT: colourful Panda footprint",
    "authors": "",
    "file_creation_date": "2020-08-28T12:22:26Z",
    "file_modification_date": "2020-08-28T12:23:33Z",
    "file_size": 5443120,
    "plain_text": "#### syogo.hayashi@global.ntt rintaro.koike@global.ntt\n\n\n**30 September - 2 October, 2020 / vblocalhost.com**\n\n\n-----\n\n**ABSTRACT**\n\nOperation LagTime IT by TA428 is an attack campaign targeting governmental organizations of East Asian countries,\nreported by Proofpoint in July 2019. It is still in the wild and active as of 2020. Through detailed research on two samples\n(document files on Qasem Soleimani and COVID-19) observed in January and February 2020, we have successfully\nunveiled and determined the whole attack picture, including how TA428 interacts with a target. Previous research on\nOperation LagTime IT only reported that it used the Royal Road RTF Weaponizer, Poison Ivy and Cotx RAT. However,\naccording to the behaviour that we have observed, TA428 also performs user environment checking, credential stealing,\nlateral movement and highly sophisticated defence evasion.\n\nIn this paper we describe the operational steps that TA428 has taken from initial samples to reach the deepest part of the\nvictim’s system. We also reveal our analysis of the malware used by TA428 and the codes that decode encrypted\ncommunication. We also discuss how the techniques, tools and malware used in Operation LagTime IT overlap with those\nof various other APT actors.\n\n**INTRODUCTION**\n\n**TA428**\n\nTA428 is an advanced persistent threat (APT) actor that mainly targets East Asia. TA428 is known as a Chinese APT actor,\nand its most recent attack campaign is called Operation LagTime IT. It’s considered that the actor is related to Pirate Panda\n\n[1], Tropic Trooper and Key Boy.\n\n**Operation LagTime IT**\n\nOperation LagTime IT is an attack campaign operated by TA428 around March 2019. Proofpoint has reported [2] that the\ngroup used Poison Ivy and Cotx RAT to target government agencies in East Asia. It has been reported that an RTF file\ngenerated by a tool called ‘Royal Road RTF Weaponizer’ [3], which is related to Tick and Tonto, is used as a lure document\nfor the attacks.\n\n**Our motivation**\n\nSimilar to Tick and Tonto, TA428 is attacking East Asia using the ‘Royal Road RTF Weaponizer’. However, detailed\nattack analysis of TA428 has not been shared to date. We wanted to find out the details of TA428’s attack strategy in\norder to help defend against it, in particular what kind of breaches the group uses with Poison Ivy and Cotx RAT.\nTherefore, we focused on Operation LagTime IT, which is one of TA428’s most active attack campaigns, and we\nobserved and analysed the attack.\n\nSince 2020, we have observed Operation LagTime IT attacks five times. We performed a detailed analysis of the two\nattacks we observed in January and February. As a result, we have been able to uncover several pieces of malware and\ncompromise tools that have never before been reported, as well as the attacker’s specific method of operation.\n\n**CASE 1**\n\n**Overview and attack flow**\n\nIn early January 2020, we observed a file called ‘How Suleimani’s death will affect India and Pakistan.doc’. This file is a\nlure document that is the launch point for Operation LagTime IT. When this file is opened in a vulnerable version of\n_Microsoft Office Word, it will exploit the vulnerability and create a file called ‘useless.wll’ in the Microsoft Word startup_\ndirectory.\n\nThe .wll file located in the Microsoft Office Word startup directory will automatically be loaded and executed when the user\nstarts Word.\n\nThe file named ‘useless.wll’ is Poison Ivy. It is used to download three cab files (‘o.cab’, ‘nbt.cab’ and ‘in.cab’) from the\nC&C server, and execute the files stored in the cab files. The file ‘o.cab’ contains ‘o.exe’, which is a tool used to dump\n_Outlook credentials. The file ‘nbt.cab’ contains ‘n.exe’, which is an NTB scan tool. The file ‘in.cab’ contains a file named_\n‘intel.dll’, which will be executed from ‘rundll32.exe’ by the attacker later on.\n\nThe file ‘intel.dll’ creates two files, ‘intel.exe’ and ‘RasTls.dll’. ‘Intel.exe’ is a legitimate Intel executable file that is\ndigitally signed. ‘Intel.exe’ is used to perform DLL side-loading as the executable will load ‘RasTls.dll’, located in the\nsame directory. ‘RasTls.dll’ is a Cotx RAT.\n\nAfter executing ‘o.exe’ and ‘n.exe’ and persisting the Cotx RAT, the operation by the attacker stopped.\n\n\n-----\n\n_F igure 1: Whole picture of attack Case 1._\n\n**Item** **File path** **Description**\n\nLure document How Suleimani’s death will affect India and Pakistan.doc RTF file that attacker sends\n\nWord document - Any Microsoft Office Word file\n\nPoison Ivy %APPDATA%\\Microsoft\\Word\\STARTUP\\useless.wll Poison Ivy RAT\n\nCredential stealer %USERPROFILE%\\AppData\\Local\\Comms\\o.cab Dump tool for Outlook credentials\n\n%USERPROFILE%\\AppData\\Local\\Comms\\o.exe\n\nNBTScan %APPDATA%\\Adobe\\nbt.cab NBT scan tool\n\n%APPDATA%\\Adobe\\n.exe\n\nDropper %ALLUSERSPROFILE%\\Comms\\in.cab Dropper of Cotx RAT\n\n%ALLUSERSPROFILE%\\Comms\\intel.dll\n\nLegitimate file %ALLUSERSPROFILE%\\Comms\\intel.exe Legitimate executable file of Intel\n\nCorporation\n\n%APPDATA%\\Intel\\Intel(R) Processor Graphics\\\nIntelGraphicsController.exe\n\nCotx RAT %ALLUSERSPROFILE%\\Comms\\RasTls.dll Cotx RAT is side-loaded by intel.exe\n\n_T able 1: Malware and files observed during attack Case 1._\n\n**Lure document**\n\n‘How Suleimani’s death will affect India and Pakistan.doc’ is an RTF file relating to the death of Commander Soleimani of\nthe Islamic Revolutionary Guard.\n\n|Item|File path|Description|\n|---|---|---|\n|Lure document|How Suleimani’s death will affect India and Pakistan.doc|RTF file that attacker sends|\n|Word document|-|Any Microsoft Office Word file|\n|Poison Ivy|%APPDATA%\\Microsoft\\Word\\STARTUP\\useless.wll|Poison Ivy RAT|\n|Credential stealer|%USERPROFILE%\\AppData\\Local\\Comms\\o.cab %USERPROFILE%\\AppData\\Local\\Comms\\o.exe|Dump tool for Outlook credentials|\n|NBTScan|%APPDATA%\\Adobe\\nbt.cab %APPDATA%\\Adobe\\n.exe|NBT scan tool|\n|Dropper|%ALLUSERSPROFILE%\\Comms\\in.cab %ALLUSERSPROFILE%\\Comms\\intel.dll|Dropper of Cotx RAT|\n|Legitimate file|%ALLUSERSPROFILE%\\Comms\\intel.exe %APPDATA%\\Intel\\Intel(R) Processor Graphics\\ IntelGraphicsController.exe|Legitimate executable file of Intel Corporation|\n|Cotx RAT|%ALLUSERSPROFILE%\\Comms\\RasTls.dll|Cotx RAT is side-loaded by intel.exe|\n\n\n-----\n\n_Figure 2: ‘How Suleimani’s death will affect India and Pakistan.doc’._\n\nThis RTF file contains malicious code for exploiting CVE-2018-0798 and an object called ‘8.t’. The inclusion of these\nobjects suggests that it was created using the Royal Road RTF Weaponizer.\n\n_Figure 3: Objects included in the RTF file._\n\nWhen this RTF file is opened with Microsoft Word, it will load the malicious code that exploits CVE-2018-0798 and\nexecute the two-byte XOR-encoded shellcode.\n\n\n-----\n\n_Figure 4: Decoding shellcode._\n\nThe shellcode decodes the 8.t object by the following operations:\n\n_Figure 5: Decoding the 8.t object._\n\nThe result of decoding 8.t is a DLL file that will be written to the Microsoft Office Word startup directory with the file name\n‘useless.wll’.\n\n**Poison Ivy**\n\nThe useless.wll file created in the Microsoft Office Word startup directory will automatically be loaded and executed the\nnext time Microsoft Office Word is started [4].\n\nThis .wll file will first check for the existence of the string ‘WORD.EXE’ in the result of GetCommandLineA by using the\nstrstr function. If the string exists, it will execute again using rundll32.exe. This time, it will execute a function called\n‘DllEntry10’, rather than ‘DllEntryPoint’.\n\nWhen DllEntry10 is executed, it first decodes some data with ‘XOR 0xad’. One of the decoded strings is an RC4 key. The\ncore part of Poison Ivy will be decoded using the RC4 key and additional simple operation.\n\nThe decoded data includes Poison Ivy’s configuration data, which is shown in Table 2.\n\n\n-----\n\n_Figure 6: Executing the DllEntry10 function._\n\n_Figure 7: The simple operation._\n\n95.179.131.29:443\nC&C server\n\n95.179.131.29:8080\n\nCampaign ID hold\n\nGroup ID hold\n\nMutex 99x7nmpWW\n\nPassword 3&U<9f*lZ>!MIQ\n\n_Table 2: Poison Ivy’s configuration data._\n\n|C&C server|95.179.131.29:443|\n|---|---|\n||95.179.131.29:8080|\n|Campaign ID|hold|\n|Group ID|hold|\n|Mutex|99x7nmpWW|\n|Password|3&U<9f*lZ>!MIQ|\n\n\n-----\n\nThis version of Poison Ivy has similar traffic characteristics to those of a variant called SPIVY [5]. The first byte of traffic\nis a value from 0x01 to 0x0f. It shows the size of the padding data that immediately follows it. When the padding data ends,\ndouble the padding data size follows to indicate the end. After that is the data body.\n\n_Figure 8: Traffic data structure._\n\nThe data is Camellia-encrypted using ECB mode. The encryption key is contained in the configuration data. The structure\nof the subsequent data is the same as in the normal Poison Ivy [6].\n\n**Cotx RAT**\n\nThe Cotx RAT is the original RAT used by the TA428 group. The Proofpoint report [2] named it Cotx RAT because it saved\nthe configuration data in the ‘.cotx’ section. However, in the Cotx RAT that we analysed, the configuration data was\nincluded in the ‘.pdata’ section.\n\n_Figure 9: Configuration data in the ‘.pdata’ section._\n\n\n-----\n\nThe configuration data is encrypted with AES-192 in CBC mode. The encryption key and initialization vector ‘IV’ are\nidentical to those in the Proofpoint report.\n\n_Figure 10: The key to decode configuration data._\n\n_Figure 11: Decoding results of the configuration data._\n\nThis RAT functionality was also unchanged from the Proofpoint [2] report.\n\n**Credential stealer**\n\nThe ‘o.exe’ file that was downloaded and executed by Poison Ivy is a commercial tool [7] called ‘Outlook Password Dump\nv3.0’. When the tool is executed, it is possible to steal credentials stored in Microsoft Office Outlook. In the victim’s\nenvironment, the attacker could not get anything because the credentials were not stored in Outlook.\n\n_Figure 12: An execution result of o.exe._\n\n**Environment scanner**\n\nThe ‘n.exe’ file that was downloaded and executed by Poison Ivy is a public NBTScan tool [8]. When the tool is executed,\nit is possible to scan for hosts on the target network. The attacker was scanning neighbouring networks and looking for\nexisting hosts.\n\n\n-----\n\n_Figure 13: Execution of n.exe._\n\n**CASE 2**\n\n**Overview and attack flow**\n\nIn the middle of February 2020, we observed a file called ‘English_2020.02.17_13.00_MOH_daily update.doc’. This file\nlooks like a document related to COVID-19. However, it is actually a lure document that is the starting point for the attack\nof Operation LagTime IT. As in Case 1, a .wll file is created (‘woldfunc.wll’) and copied to the Microsoft Office Word\nstartup directory.\n\n_Figure 14: ‘English_2020.02.17_13.00_MOH_daily update.doc’._\n\n\n-----\n\nAlso as in Case 1, ‘woldfunc.wll’ is Poison Ivy, and it downloads three cab files from the C&C server and runs Cotx RAT\nin exactly the same way.\n\nIn Case 1, ‘o.exe’ and ‘n.exe’ were only used to investigate the environment and steal information. However, in Case 2,\nthere was more of a breach.\n\nFirst, ‘s.cab’ and ‘w.cab’ were downloaded, unpacked and executed by Poison Ivy. ‘S.cab’ contains an executable file called\n‘s.exe’. This is a checker to investigate whether it can be compromised by exploiting MS17-010 against the host passed as\nan argument. An attacker who finds a laterally deployable host with ‘s.exe’ then uses the ‘w.exe’ contained in ‘w.cab’ to do\nthe actual compromise. ‘W.exe’ is a tool that actually exploits MS17-010. The attacker used it to inject a DLL file into the\ncompromised host, in the lsass.exe process, to execute it.\n\nThe injected DLL file is the second Poison Ivy. However, it accesses a different C&C server from the one accessed by the\nPoison Ivy that was initially executed. Using the second Poison Ivy, the attacker continued to compromise. We observed\nlateral movement on two hosts and investigated further breaches on each host.\n\n_Figure 15: Whole picture of attack Case 2._\n\nTable 3 shows the malware and files observed during attack Case 2.\n\nOn one of the two hosts (Internal Host-A), three cab files (‘nbt.cab’, ‘sh.cab’, ‘ss.cab’) were downloaded, unpacked and\nexecuted. Of these, ‘sh.cab’ contains a file called ‘show.exe’. This is a tool that steals username, domain and password from\nthe ‘lsass.exe’ process. Also, ‘ss.cab’ contains a file called ‘dwm.exe’. This is the RAT we call Tmanger.\n\n\n-----\n\n|Item|File path|Description|\n|---|---|---|\n|Lure document|English_2020.02.17_13.00_MOH_daily update.doc|RTF file that attacker sends|\n|Word document|-|Any Microsoft Office Word file|\n|Poison Ivy-A|%APPDATA%\\Microsoft\\Word\\STARTUP\\ woldfunc.wll|Poison Ivy RAT|\n|Credential stealer-A|%ALLUSERSPROFILE%\\Comms\\o.cab %ALLUSERSPROFILE%\\Comms\\o.exe|Dump tool for Outlook credentials|\n|NBT scan|%ALLUSERSPROFILE%\\Comms\\nbt.cab %ALLUSERSPROFILE%\\Comms\\n.exe|NBT scan tool|\n|Dropper|%ALLUSERSPROFILE%\\Comms\\in.cab %ALLUSERSPROFILE%\\Comms\\intel.dll|Dropper of Cotx RAT|\n|Legitimate File-A|%ALLUSERSPROFILE%\\Comms\\intel.exe %APPDATA%\\Intel\\Intel(R) Processor Graphics\\ IntelGraphicsController.exe|Legitimate executable file of Intel Corporation|\n|Cotx RAT|%ALLUSERSPROFILE%\\Comms\\RasTls.dll|Cotx RAT is side-loaded by intel.exe|\n|ScanTool|%ALLUSERSPROFILE%\\Comms\\s.cab %ALLUSERSPROFILE%\\Comms\\s.exe|Scan tool for MS17-010|\n|ExploitTool|%ALLUSERSPROFILE%\\Comms\\w.cab %ALLUSERSPROFILE%\\Comms\\w.exe|Exploit tool for MS17-010|\n|Poison Ivy-B|%ALLUSERSPROFILE%\\Comms\\x86.dll %ALLUSERSPROFILE%\\Comms\\x64.dll|Poison IVY is injected into lsass.exe|\n|Legitimate File-B|%SYSTEMROOT%\\System32\\lsass.exe|Legitimate executable file of Microsoft Corporation|\n\n\n_Table 3: Malwares and files observed during attack Case 2._\n\n_Figure 16: Attack flow in Internal Host-A._\n\n\n-----\n\n|Item|File path|Description|\n|---|---|---|\n|Credential stealer-B|%ALLUSERSPROFILE%\\GroupPolicy\\sh.cab %ALLUSERSPROFILE%\\GroupPolicy\\show.exe|Dump tool from lsass.exe|\n|NBTScan|%ALLUSERSPROFILE%\\GroupPolicy\\nbt.cab %ALLUSERSPROFILE%\\GroupPolicy\\n.cab|NBT scan tool|\n|Tmanger|%ALLUSERSPROFILE%\\Microsoft\\DRM\\ss.cab %ALLUSERSPROFILE%\\Microsoft\\DRM\\dwm.exe|Tmanger RAT|\n\n\n_Table 4: Malware and files observed during the attack Internal Host-A._\n\nOn the other host (Internal Host-B), the files ‘In.cab’ and ‘WindowsResKits.dll’ were downloaded. ‘In.cab’ contains a file\ncalled ‘Instsrv.exe’. This impersonates the legitimate tool provided as a resource kit and registers ‘WindowsResKits.dll’ as\na service. ‘WindowsResKits.dll’ is a new type of malware that we call nccTrojan.\n\nThe attacker attempted further breaches using Active Directory administrator passwords stolen by ‘show.exe’. However, the\npasswords stolen by the attackers were old. As a result, the breach failed, and the activity ended.\n\nIn Case 2, the flow until the attacker used Cotx RAT was the same as in Case 1. Therefore, we will explain the lateral\nmovement in detail below, except for the case shown in Case 1.\n\n_Figure 17: Attack flow in Internal Host-B._\n\n**Item** **File path** **Description**\n\n%ALLUSERSPROFILE%\\Microsoft\\Crypto\\In.cab Register nccTrojan as a service\nInstaller\n\n%ALLUSERSPROFILE%\\Microsoft\\Crypto\\Instsr.exe and execute\n\n%ALLUSERSPROFILE%\\Microsoft\\Crypto\\\nnccTrojan nccTrojan RAT\nWindowsResKits.dll\n\n_Table 5: Malware and files observed during the attack Internal Host-B._\n\n**Lateral movement**\n\nThe attacker used two tools for lateral movement. The first is s.exe. This is a tool that checks if it is possible to exploit the\nMS17-010 vulnerability on the specified host. It is a PE file converted from the public Python script [9] by PyInstaller.\n\n|Item|File path|Description|\n|---|---|---|\n|Installer|%ALLUSERSPROFILE%\\Microsoft\\Crypto\\In.cab %ALLUSERSPROFILE%\\Microsoft\\Crypto\\Instsr.exe|Register nccTrojan as a service and execute|\n|nccTrojan|%ALLUSERSPROFILE%\\Microsoft\\Crypto\\ WindowsResKits.dll|nccTrojan RAT|\n\n\n-----\n\n_Figure 18: Execution of s.exe._\n\nAfter the attacker found a vulnerable host using s.exe, the second tool, ‘w.exe’, was used. This is a tool which enables the\nMS17-010 vulnerability to be exploited. It is a PE file which seems to have been created based on the public Python script\n\n[10].\n\nThe w.exe tool sends x86.dll or x64.dll in the same directory to the target host depending on the environment and injects it\ninto the lsass.exe process.\n\n_Figure 19: Execution of w.exe._\n\n\n-----\n\n**Poison Ivy (second)**\n\nThe behaviour of x86.dll and x64.dll is the same. Both are internally named ‘blu.dll’. The path of PDB was left in x64.dll\nas follows:\n\n_Figure 20: PDB path of x64.dll._\n\nWhen the DLL file is injected into lsass.exe, the ‘Register’ function is executed. When executed, it creates three files\n(PotPlayerMini.exe, PotPlayer.dll and PAME13.tmp) under C:\\Windows\\Temp and executes PotPlayerMini.exe.\n\n_Figure 21: Creating PotPlayerMini.exe._\n\nPotPlayerMini.exe is a legitimate binary created by Daum and has a digital signature. PotPlayer.dll is loaded in the same\ndirectory, causing DLL side-loading.\n\nPotPlayer.dll is the body of Poison Ivy (SPIVY). First, PAME13.tmp is decoded with RC4 to get configuration data. After\nthat, it communicates with the C&C server just like the first Poison Ivy.\n\n\n-----\n\n_Figure 22: Decoding PAME13.tmp._\n\nThe configuration data of this Poison Ivy is shown in Table 6.\n\n45.76.211.18:443\nC&C server\n\n45.76.211.18:8080\n\nCampaign ID TOEI\n\nGroup ID TOEI\n\nMutex G9u3cUoJs\n\nPassword kos@On\n\n_Table 6: Poison Ivy’s configuration data._\n\nThis Poison Ivy was executed on two hosts. On the first host, the attacker downloaded and executed a credential stealer and\na RAT called ‘Tmanger’. On the other host, the attacker downloaded and executed ‘nccTrojan’.\n\n**Credential stealer (second)**\n\nThe ‘sh.cab’ file contains a file named ‘show.exe’, which is a tool enabling the stealing of Windows credentials.\nShow.exe steals username, domain and password from the lsass.exe process. The attacker executed show.exe and\nretrieved the credentials, however the penetration to another host didn’t succeed because the credentials in our\nenvironment were old.\n\n|C&C server|45.76.211.18:443|\n|---|---|\n||45.76.211.18:8080|\n|Campaign ID|TOEI|\n|Group ID|TOEI|\n|Mutex|G9u3cUoJs|\n|Password|kos@On|\n\n\n-----\n\n_Figure 23: Execution of show.exe._\n\n**Tmanger**\n\nThe PDB path was left in dwm.exe, which was included in ‘ss.cab’. We call it ‘Tmanger’ because of the string contained in\nthis pathname.\n\n_Figure 24: PDB path of dwm.exe._\n\nWhen ‘dwm.exe’ is executed, it creates ‘test.dll’ under the Temp folder of the user account. The data in it is in the resource\nsection of the ‘dwm.exe’ file.\n\n_Figure 25: Test.dll embedded in the resource section of dwm.exe._\n\nIt also copies itself under the Temp folder with the filename ‘master.exe’. And then it persists to execute master.exe with the\nkey ‘HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\Master’.\n\nIt then uses rundll32.exe to execute a function called ‘Entery’ in ‘test.dll’. This allocates an area in memory, writes the code\nand executes it. We believe this is the body of the RAT. After collecting information from the PC, it attempts to\ncommunicate with the C&C server on ports 80, 443 and 5222, in that order.\n\n\n-----\n\nAn example of communication with the C&C server is shown below. As a result of analysis, it was found that the first four\nbytes are the data size and the rest are encoded data.\n\n_Figure 26: Traffic data._\n\nThe data part is encrypted with RC4 and the key is hex encoded as follows.\n\n_Figure 27: RC4 encryption key._\n\nThe result of decoding the data part is shown in Figure 28.\n\n_Figure 28: Decoding results of traffic data._\n\nThe first four bytes are converted from the PID value as follows:\n\n((CurrentProcessID % 9) × 1000) + ((CurrentProcessID % 1000) + 1000)\n\nAlso, we found that the fifth byte is a command to the RAT.\n\nAs a result of our analysis, we consider that the functions of this RAT are as follows:\n\n - Command execution by PowerShell\n\n - Sending file information on a PC\n\n - Sending the contents of a file on a PC\n\n - Deleting files on a PC\n\n - Command execution by the CreateProcess function\n\n - Sending screen capture images\n\n - Keylogger.\n\nNo further infringement occurred on this host.\n\n**nccTrojan**\n\nUsing the second Poison Ivy, the attacker placed the installer ‘Instsrv.exe’ and the RAT ‘WindowsResKits.dll’ on\n‘C:\\ProgramData\\Microsoft\\Crypto\\’. When Instsrv.exe is executed, it registers a fake service as Windows Resource Kits, as\nshown in Table 7, copies WindowsResKits.dll to ‘C:\\Windows\\SysWOW64\\’ or ‘C:\\Windows\\System32\\’, and starts the\nservice. When the service starts, the svchost.exe process loads WindowsResKits.dll.\n\n**Name** **Image path**\n\nMicrosoft Windows Resource Kits C:\\Windows\\System32\\svchost.exe -k WindowsResKits\n\n_Table 7: Registered fake service._\n\nWhen we analysed WindowsResKits.dll, we found the PDB file path and the compilation date and time as shown in\nTable 8.\n\n**Item** **Value**\n\nPDB file path C:\\Users\\abc\\Desktop\\cTrojan\\2.1\\HK\\Release\\Client.pdb\n\nCompilation timestamp 2019-12-27 01:07:25\n\n_Table 8: The meta information of WindowsResKits.dll._\n\n|Name|Image path|\n|---|---|\n|Microsoft Windows Resource Kits|C:\\Windows\\System32\\svchost.exe -k WindowsResKits|\n\n|Item|Value|\n|---|---|\n|PDB file path|C:\\Users\\abc\\Desktop\\cTrojan\\2.1\\HK\\Release\\Client.pdb|\n|Compilation timestamp|2019-12-27 01:07:25|\n\n\n-----\n\nWindowsResKits.dll decrypts config information and communication contents using the method shown in Tables 9 and 10.\nWe confirmed that the character string ‘ncc’ exists in the decrypted data, and that the character string is necessary to start\nthe process for commands received from the C&C server. Figure 29 shows a function being called to check if the received\ndata is ‘ncc’. The first argument is the decrypted character string, the second argument is the received data, and the third\nargument is the size of the string to compare. For this reason, we call this RAT ‘nccTrojan’.\n\n**Method** **AES (CFB mode)**\n\nKey (hex-encoded) 12AB56FF56CDCCED99EE3CBA02270567908CAF772F6BAC7C6C2BF1DDEEC9D6BB\n(256 bits)\n\nIV (hex-encoded) 02242123421315713AB6A8A0C8DC5AF3 (128 bits)\n\n_Table 9: Encryption for config information._\n\n**Method** **AES (CFB mode)**\n\nKey (hex-encoded) 981511371412780969AFC3AB2072018709A83A3332466A8B56FF3FAB8E6C3DAA (256\nbits)\n\nIV (hex-encoded) 2042123224315117031B1A0A3CCDA53F (128 bits)\n\n_Table 10: Encryption for communication contents._\n\n_F igure 29: Comparison of character string ‘ncc’ and received data._\n\nThe nccTrojan connected to 45[.]77.129.213 on port 443/TCP and communicated with the C&C server. As shown in Figure\n30, the TCP payload consisted of an eight-byte SIZE field and a following DATA field. It is a feature that the SIZE field\nwas described as a decimal character string and the invalid digit was ‘x’.\n\n_Fi gure 30: An example of received TCP payload._\n\nWe confirmed that the same following functions are implemented in the nccTrojan as the RAT.\n\n - Remote Shell\n\n - Send Disk Information\n\n - Send File List\n\n - Send Process List\n\n|Method|AES (CFB mode)|\n|---|---|\n|Key (hex-encoded)|12AB56FF56CDCCED99EE3CBA02270567908CAF772F6BAC7C6C2BF1DDEEC9D6BB (256 bits)|\n|IV (hex-encoded)|02242123421315713AB6A8A0C8DC5AF3 (128 bits)|\n\n|Method|AES (CFB mode)|\n|---|---|\n|Key (hex-encoded)|981511371412780969AFC3AB2072018709A83A3332466A8B56FF3FAB8E6C3DAA (256 bits)|\n|IV (hex-encoded)|2042123224315117031B1A0A3CCDA53F (128 bits)|\n\n\n-----\n\n - Download File (Read File)\n\n - Upload File\n\n - Operate File (Copy, Move, Delete)\n\n - Kill Process.\n\n**CORRELATION**\n\nTA428 has been reported to actively use the Royal Road RTF Weaponizer in Operation LagTime IT [2, 3]. The RTF file\ngenerated by Royal Road RTF Weaponizer has several characteristics. It can be classified according to the RTF object,\nencoding algorithm, etc. TA428, Tick and Tonto, are said to belong to Group-B [3]. Attack groups belonging to Group-B\nmainly target East Asia, especially Russia, Mongolia, South Korea and Japan – countries which have much overlap with the\ntarget countries of TA428.\n\nThe Poison Ivy used by TA428 has a different traffic structure from the normal Poison Ivy. This is a variant called SPIVY.\nOne example of the use of SPIVY was in Hong Kong in March 2016 [5]. In this attack, similar to the TA428 attack this\ntime, the malware was executed by DLL side-loading using a legitimate Symantec binary and RasTls.dll.\n\nThis time we have found that TA428 uses PotPlayerMini for DLL side-loading. This technique is extremely rare. Until now,\nonly a few cases of DLL side-loading using PotPlayerMini have been reported [11, 12] – these are said to be the attacks\nassociated with DragonOK (and Danti). A case in Hong Kong, reported by Palo Alto Networks [11], uses PotPlayerMini to\nexecute Poison Ivy, similar to this TA428 attack. In addition, the TA428 attack that is believed to have targeted Kazakhstan\naround April 2019 is said to have used malware related to Danti [13]. DragonOK targets East Asian countries such as Japan\nand Taiwan and is consistent with the target area of TA428.\n\n**CONCLUSION**\n\nOperation LagTime IT by TA428 has been observed since at least March 2019 and has not changed TTPs for more than a\nyear. It mainly targets government agencies in East Asia and uses RTF files generated by the Royal Road RTF Weaponizer,\nPoison Ivy and Cotx RAT. It also uses tools that exploit MS17-010 for lateral movement, NBTScan for environmental\ninvestigations, and tools to steal credentials. It also uses previously unknown advanced RATs such as Tmanger and\nnccTrojan.\n\nTA428 is included in Group-B alongside Tick and Tonto. It may also be associated with previous SPIVY-based attacks\nagainst Hong Kong by DragonOK and Danti.\n\nIt is expected that attacks by TA428 will continue to be aggressive. To protect your system from attacks by TA428, we\nrecommend that you use the information presented in this paper for detection and defence.\n\n**REFERENCES**\n\n[1] Malpedia. Pirate Panda. https://malpedia.caad.fkie.fraunhofer.de/actor/pirate_panda.\n\n[2] Proofpoint. Chinese APT “Operation LagTime IT” Targets Government Information Technology Agencies in\nEastern Asia. https://www.proofpoint.com/us/threat-insight/post/chinese-apt-operation-lagtime-it-targetsgovernment-information-technology.\n\n[3] nao_sec. An Overhead View of the Royal Road. https://nao-sec.org/2020/01/an-overhead-view-of-the-royal-road.\nhtml.\n\n[4] MITRE ATT&CK. Office Application Startup. https://attack.mitre.org/techniques/T1137/.\n\n[5] Palo Alto Networks. New Poison Ivy RAT Variant Targets Hong Kong Pro-Democracy Activists. https://unit42.\npaloaltonetworks.com/unit42-new-poison-ivy-rat-variant-targets-hong-kong-pro-democracy-activists/.\n\n[6] Conix Cybersécurité. Poison Ivy RAT. https://www.conix.fr/wp-content/uploads/2013/10/Poison-Ivy-RAT-confcomms.pdf.\n\n[7] Security Xploded. Outlook Password Dump. https://securityxploded.com/outlook-password-dump.php.\n\n[8] Steve Friedl’s Unixwiz.net Tools. nbtscan. http://www.unixwiz.net/tools/nbtscan.html.\n\n[9] GitHub claudioviviani. ms17-010-m4ss-sc4nn3r. https://github.com/claudioviviani/ms17-010-m4ss-sc4nn3r/blob/\nmaster/ms17-010-m4ss-sc4nn3r.py.\n\n[10] GitHub pythonone. MS17-010. https://github.com/pythonone/MS17-010/blob/master/exploits/eternalblue/\neternalblue.py.\n\n[11] Palo Alto Networks. Unit 42、日本を対象に開発されたDragonOKバックドアマルウェアの新種を発見.\n\nhttps://unit42.paloaltonetworks.jp/unit-42-identifies-new-dragonok-backdoor-malware-deployed-against-japanesetargets/.\n\n\n-----\n\n[12] Kaspersky. CVE-2015-2545: overview of current threats. https://securelist.com/cve-2015-2545-overview-ofcurrent-threats/74828/.\n\n[13] nao_sec. Royal Road IoC. https://nao-sec.org/jsac2020_ioc.html.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "6fc23d14-23a6-4870-8fad-b291b182596f",
            "created_at": "2022-10-25T16:07:18.480113Z",
            "updated_at": "2022-10-25T16:07:18.480113Z",
            "deleted_at": null,
            "name": "ETDA",
            "url": "https://apt.etda.or.th",
            "description": "Threat Group Cards: A Threat Actor Encyclopedia",
            "reports": null
        },
        {
            "id": "bf5be533-fa31-4590-ae37-5761c97ffa34",
            "created_at": "2022-10-25T16:13:58.389257Z",
            "updated_at": "2022-10-25T16:13:58.389257Z",
            "deleted_at": null,
            "name": "Malpedia",
            "url": "https://malpedia.caad.fkie.fraunhofer.de",
            "description": "Malpedia is a free service offered by Fraunhofer FKIE",
            "reports": null
        },
        {
            "id": "5910e58f-4bc9-4e4e-9dbb-887804094a01",
            "created_at": "2022-10-25T16:32:58.457399Z",
            "updated_at": "2022-10-25T16:32:58.457399Z",
            "deleted_at": null,
            "name": "OTX",
            "url": "https://otx.alienvault.com",
            "description": "Alienvault Open Threat Exchange (OTX)",
            "reports": null
        },
        {
            "id": "6825b8cb-7d82-43d2-b0b0-d51c7e255b42",
            "created_at": "2023-01-06T13:46:37.642134Z",
            "updated_at": "2023-01-06T13:46:37.642134Z",
            "deleted_at": null,
            "name": "MISPGALAXY",
            "url": "https://www.misp-project.org/galaxy.html",
            "description": "MISP Galaxy Clusters",
            "reports": null
        }
    ],
    "references": [
        "https://vblocalhost.com/uploads/VB2020-Ozawa-etal.pdf",
        "https://vb2020.vblocalhost.com/uploads/VB2020-Ozawa-etal.pdf"
    ],
    "report_names": [
        "VB2020-Ozawa-etal.pdf"
    ],
    "threat_actors": [
        {
            "id": "5ffe400c-6025-44c2-9aa1-7c34a7a192b0",
            "created_at": "2023-01-06T13:46:38.469688Z",
            "updated_at": "2025-03-27T02:00:02.84172Z",
            "deleted_at": null,
            "main_name": "DragonOK",
            "aliases": [
                "Moafee",
                "BRONZE OVERBROOK",
                "G0017",
                "G0002",
                "Shallow Taurus"
            ],
            "source_name": "MISPGALAXY:DragonOK",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "2d7530f9-cd8e-4703-8aed-ab938e3b08cf",
            "created_at": "2023-01-06T13:46:38.620662Z",
            "updated_at": "2025-03-27T02:00:02.875298Z",
            "deleted_at": null,
            "main_name": "Danti",
            "aliases": [],
            "source_name": "MISPGALAXY:Danti",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "7ebda3c6-1789-4d84-97cf-47fb18a0cb28",
            "created_at": "2022-10-25T15:50:23.78829Z",
            "updated_at": "2025-03-27T02:00:55.547275Z",
            "deleted_at": null,
            "main_name": "DragonOK",
            "aliases": [
                "DragonOK"
            ],
            "source_name": "MITRE:DragonOK",
            "tools": [
                "PoisonIvy",
                "PlugX"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "a4aca3ca-9e04-42d1-b037-f7fb3fbab0b1",
            "created_at": "2023-01-06T13:46:39.042499Z",
            "updated_at": "2025-03-27T02:00:02.984002Z",
            "deleted_at": null,
            "main_name": "TA428",
            "aliases": [
                "Colourful Panda",
                "BRONZE DUDLEY"
            ],
            "source_name": "MISPGALAXY:TA428",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "f8dddd06-da24-4184-9e24-4c22bdd1cbbf",
            "created_at": "2023-01-06T13:46:38.626906Z",
            "updated_at": "2025-03-27T02:00:02.877001Z",
            "deleted_at": null,
            "main_name": "Tick",
            "aliases": [
                "Stalker Taurus",
                "PLA Unit 61419",
                "Nian",
                "BRONZE BUTLER",
                "REDBALDKNIGHT",
                "STALKER PANDA",
                "G0060"
            ],
            "source_name": "MISPGALAXY:Tick",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "bbefc37d-475c-4d4d-b80b-7a55f896de82",
            "created_at": "2022-10-25T15:50:23.571783Z",
            "updated_at": "2025-03-27T02:00:55.502112Z",
            "deleted_at": null,
            "main_name": "BRONZE BUTLER",
            "aliases": [
                "BRONZE BUTLER",
                "REDBALDKNIGHT"
            ],
            "source_name": "MITRE:BRONZE BUTLER",
            "tools": [
                "Mimikatz",
                "build_downer",
                "cmd",
                "ABK",
                "at",
                "BBK",
                "schtasks",
                "down_new",
                "Daserf",
                "ShadowPad",
                "Windows Credential Editor",
                "gsecdump"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "60d9c778-488b-459e-a2f6-9e48c607ba45",
            "created_at": "2022-10-25T16:47:55.606462Z",
            "updated_at": "2025-03-27T02:05:17.281676Z",
            "deleted_at": null,
            "main_name": "BRONZE OVERBROOK",
            "aliases": [
                "DragonOK ",
                "Samurai Panda ",
                "Temp.DragonOK ",
                "Danti "
            ],
            "source_name": "Secureworks:BRONZE OVERBROOK",
            "tools": [
                " DDKONG",
                " HelloBridge",
                " IsSpace",
                " NFLog Trojan",
                " PLAINTEE",
                " PlugX",
                " Rambo",
                "Aveo"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "2f07a03f-eb1f-47c8-a8e9-a1a00f2ec253",
            "created_at": "2022-10-25T16:07:24.277669Z",
            "updated_at": "2025-03-27T02:02:10.157972Z",
            "deleted_at": null,
            "main_name": "TA428",
            "aliases": [
                "Operation LagTime IT",
                "Operation StealthyTrident",
                "ThunderCats"
            ],
            "source_name": "ETDA:TA428",
            "tools": [
                "8.t Dropper",
                "8.t RTF exploit builder",
                "8t_dropper",
                "Agent.dhwf",
                "Albaniiutas",
                "BlueTraveller",
                "Chymine",
                "Cotx RAT",
                "CoughingDown",
                "Darkmoon",
                "Destroy RAT",
                "DestroyRAT",
                "Gen:Trojan.Heur.PT",
                "Kaba",
                "Korplug",
                "LuckyBack",
                "PhantomNet",
                "PlugX",
                "Poison Ivy",
                "RedDelta",
                "RoyalRoad",
                "SManager",
                "SPIVY",
                "Sogu",
                "TIGERPLUG",
                "TManger",
                "TVT",
                "Thoper",
                "Xamtrav",
                "pivy",
                "poisonivy"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "c416260c-7ff6-4a74-a5ba-a15f40d3543f",
            "created_at": "2024-05-01T02:03:07.939268Z",
            "updated_at": "2025-03-27T02:05:17.25652Z",
            "deleted_at": null,
            "main_name": "BRONZE DUDLEY",
            "aliases": [
                "Temp.Hex ",
                "Vicious Panda ",
                "TA428 "
            ],
            "source_name": "Secureworks:BRONZE DUDLEY",
            "tools": [
                "PoisonIvy"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "f74e4fe6-6281-45e7-8866-0ff4316381cc",
            "created_at": "2024-05-01T02:03:07.959101Z",
            "updated_at": "2025-03-27T02:05:17.270819Z",
            "deleted_at": null,
            "main_name": "BRONZE HOBART",
            "aliases": [
                "Pirate Panda ",
                "Tropic Trooper ",
                "KeyBoy "
            ],
            "source_name": "Secureworks:BRONZE HOBART",
            "tools": [
                " KeyBoy",
                " Pfine",
                "DSNGInstaller"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "61ea51ed-a419-4b05-9241-5ab0dbba25fc",
            "created_at": "2023-01-06T13:46:38.354607Z",
            "updated_at": "2025-03-27T02:00:02.81258Z",
            "deleted_at": null,
            "main_name": "APT23",
            "aliases": [
                "KeyBoy",
                "Tropic Trooper",
                "BRONZE HOBART",
                "G0081",
                "Red Orthrus",
                "Earth Centaur",
                "PIRATE PANDA"
            ],
            "source_name": "MISPGALAXY:APT23",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "bef7800a-a08f-4e21-b65c-4279c851e572",
            "created_at": "2022-10-25T15:50:23.409336Z",
            "updated_at": "2025-03-27T02:00:55.463048Z",
            "deleted_at": null,
            "main_name": "Tropic Trooper",
            "aliases": [
                "Tropic Trooper",
                "Pirate Panda",
                "KeyBoy"
            ],
            "source_name": "MITRE:Tropic Trooper",
            "tools": [
                "USBferry",
                "ShadowPad",
                "PoisonIvy",
                "BITSAdmin",
                "YAHOYAH",
                "KeyBoy"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "d4e7cd9a-2290-4f89-a645-85b9a46d004b",
            "created_at": "2022-10-25T16:07:23.419513Z",
            "updated_at": "2025-03-27T02:02:09.790389Z",
            "deleted_at": null,
            "main_name": "Bronze Butler",
            "aliases": [
                "Bronze Butler",
                "CTG-2006",
                "Operation ENDTRADE",
                "RedBaldNight",
                "Stalker Panda",
                "Stalker Taurus",
                "TEMP.Tick",
                "Tick"
            ],
            "source_name": "ETDA:Bronze Butler",
            "tools": [
                "8.t Dropper",
                "8.t RTF exploit builder",
                "8t_dropper",
                "9002 RAT",
                "AngryRebel",
                "Blogspot",
                "Daserf",
                "Datper",
                "Elirks",
                "Farfli",
                "Gh0st RAT",
                "Ghost RAT",
                "HOMEUNIX",
                "HidraQ",
                "HomamDownloader",
                "Homux",
                "Hydraq",
                "Lilith",
                "Lilith RAT",
                "McRAT",
                "MdmBot",
                "Mimikatz",
                "Minzen",
                "Moudour",
                "Muirim",
                "Mydoor",
                "Nioupale",
                "PCRat",
                "POISONPLUG.SHADOW",
                "Roarur",
                "RoyalRoad",
                "ShadowPad Winnti",
                "ShadowWali",
                "ShadowWalker",
                "SymonLoader",
                "WCE",
                "Wali",
                "Windows Credential Editor",
                "Windows Credentials Editor",
                "XShellGhost",
                "XXMM",
                "gsecdump",
                "rarstar"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "578f8e62-2bb4-4ce4-a8b7-6c868fa29724",
            "created_at": "2022-10-25T16:07:24.344358Z",
            "updated_at": "2025-03-27T02:02:10.182282Z",
            "deleted_at": null,
            "main_name": "Tropic Trooper",
            "aliases": [
                "APT 23",
                "Bronze Hobart",
                "Earth Centaur",
                "KeyBoy",
                "Operation Tropic Trooper",
                "Pirate Panda",
                "Tropic Trooper"
            ],
            "source_name": "ETDA:Tropic Trooper",
            "tools": [
                "8.t Dropper",
                "8.t RTF exploit builder",
                "8t_dropper",
                "ByPassGodzilla",
                "CHINACHOPPER",
                "CREDRIVER",
                "China Chopper",
                "Chymine",
                "Darkmoon",
                "Gen:Trojan.Heur.PT",
                "KeyBoy",
                "Neo-reGeorg",
                "PCShare",
                "POISONPLUG.SHADOW",
                "Poison Ivy",
                "RoyalRoad",
                "SPIVY",
                "ShadowPad Winnti",
                "SinoChopper",
                "Swor",
                "TSSL",
                "USBferry",
                "W32/Seeav",
                "Winsloader",
                "XShellGhost",
                "Yahoyah",
                "fscan",
                "pivy",
                "poisonivy"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "bf0489c5-1c07-41e6-91c9-855ad96ccc6a",
            "created_at": "2022-10-25T16:47:55.541639Z",
            "updated_at": "2025-03-27T02:05:17.253496Z",
            "deleted_at": null,
            "main_name": "BRONZE BUTLER",
            "aliases": [
                "Daserf",
                "Stalker Panda ",
                "Tick ",
                "CTG-2006 "
            ],
            "source_name": "Secureworks:BRONZE BUTLER",
            "tools": [
                " DGet",
                " Daserf",
                " Datper",
                " Gofarer",
                " MSGet",
                " Mimikatz",
                " RarStar",
                " Screen Capture Tool",
                " ShadowPad",
                " T-SMB",
                " WinRAR",
                " Windows Credential Editor",
                " gsecdump",
                " xmm downloader",
                " xxmm",
                "ABK"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "340d1673-0678-4e1f-8b75-30da2f65cc80",
            "created_at": "2022-10-25T16:07:23.552036Z",
            "updated_at": "2025-03-27T02:02:09.85925Z",
            "deleted_at": null,
            "main_name": "DragonOK",
            "aliases": [
                "Bronze Overbrook",
                "Shallow Taurus"
            ],
            "source_name": "ETDA:DragonOK",
            "tools": [
                "Agent.dhwf",
                "CT",
                "Chymine",
                "Darkmoon",
                "Destroy RAT",
                "DestroyRAT",
                "FF-RAT",
                "FormerFirstRAT",
                "Gen:Trojan.Heur.PT",
                "HTran",
                "HUC Packet Transmit Tool",
                "HelloBridge",
                "IsSpace",
                "KHRAT",
                "Kaba",
                "Korplug",
                "Mongall",
                "NFlog",
                "NewCT",
                "NfLog RAT",
                "PlugX",
                "Poison Ivy",
                "Rambo",
                "RedDelta",
                "SPIVY",
                "Sogu",
                "SysGet",
                "TIGERPLUG",
                "TVT",
                "Thoper",
                "TidePool",
                "Xamtrav",
                "brebsd",
                "ffrat",
                "pivy",
                "poisonivy"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1666716496,
    "ts_updated_at": 1743041766,
    "ts_creation_date": 1598617346,
    "ts_modification_date": 1598617413,
    "files": {
        "pdf": "https://archive.orkl.eu/25488d84f657988170af8dbf0ac7b38b7140508f.pdf",
        "text": "https://archive.orkl.eu/25488d84f657988170af8dbf0ac7b38b7140508f.txt",
        "img": "https://archive.orkl.eu/25488d84f657988170af8dbf0ac7b38b7140508f.jpg"
    }
}