{
    "id": "a2c556e5-e0e1-4178-bcc1-f7e9d6889298",
    "created_at": "2023-01-12T15:07:36.441625Z",
    "updated_at": "2025-03-27T02:09:18.307392Z",
    "deleted_at": null,
    "sha1_hash": "9c1b8255e778dd97a525b6e0abb1bb9ac4d0d3e9",
    "title": "2021-09-09 - Remote Code Execution 0-Day (CVE-2021-40444) Hits Windows, Triggered Via Office Docs",
    "authors": "",
    "file_creation_date": "2022-05-28T16:01:35Z",
    "file_modification_date": "2022-05-28T16:01:35Z",
    "file_size": 685293,
    "plain_text": "# Remote Code Execution 0-Day (CVE-2021-40444) Hits Windows, Triggered Via Office Docs\n\n**[trendmicro.com/en_us/research/21/i/remote-code-execution-zero-day--cve-2021-40444--hits-windows--tr.html](https://www.trendmicro.com/en_us/research/21/i/remote-code-execution-zero-day--cve-2021-40444--hits-windows--tr.html)**\n\nSeptember 9, 2021\n\nMicrosoft has disclosed the existence of a new zero-day vulnerability that affects multiple versions of Windows. This vulnerability\n[(designated as CVE-2021-40444) is currently delivered via malicious Office 365 documents and requires user input to open the file to](https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-40444)\n[trigger. It should be noted that by default, Office documents downloaded from the internet are opened either in Protected View or](https://support.microsoft.com/en-us/topic/what-is-protected-view-d6f09ac7-e6b9-4495-8e43-2bbcdbcb6653)\n[Application Guard, both of which would mitigate this particular attack.](https://support.microsoft.com/en-us/topic/application-guard-for-office-9e0fb9c2-ffad-43bf-8ba3-78f785fdba46)\n\nIf the attacker is able to convince the victim to download the file and bypass any mitigation, it would trigger the vulnerability and cause\na malicious file to be downloaded and run on the affected machine. Currently, this vulnerability is used to deliver Cobalt Strike\npayloads.\n\nMicrosoft has issued an official bulletin covering this vulnerability. This blog entry discusses how the exploit may work, as well as Trend\nMicro solutions.\n\nWe have obtained multiple samples of documents that exploit this vulnerability. The documents all contain the following code in the\n_document.xml.rels file in their package:_\n\nFigure 1. Code with XML relationships\nNote the presence of a URL (which we have removed) that downloads a file titled side.html (SHA-256:\nd0fd7acc38b3105facd6995344242f28e45f5384c0fdf2ec93ea24bfbc1dc9e6). This file contained obfuscated JavaScript; the image in\nFigure 2 shows part of the deobfuscated code.\n\n\n-----\n\nFigure 2. Deobfuscated\n\nJavaScript code\nSeveral actions can be seen in this code: it downloads a .CAB file, extracts a .DLL file from the said .CAB file, and uses path traversal\nattacks to run the file (which is named championship.inf).\n\nEventually, this leads to the execution of the championship.inf file, as seen below:\n\nFigure 3. Properties for execution of\n\npayload\nThis payload is a Cobalt Strike beacon (SHA-256: 6eedf45cb91f6762de4e35e36bcb03e5ad60ce9ac5a08caeb7eda035cd74762b),\n[which we detect as Backdoor.Win64.COBEACON.OSLJAU. As is typically the case with Cobalt Strike, this could allow an attacker to](https://www.trendmicro.com/vinfo/us/threat-encyclopedia/malware/Backdoor.Win64.COBEACON.OSLJAU)\n[take control of the affected system. The malicious Office files are detected as Trojan.W97M.CVE202140444.A, with the malicious .CAB](https://www.trendmicro.com/vinfo/us/threat-encyclopedia/malware/trojan.w97m.cve202140444.a)\nfile detected as [Trojan.Win64.COBEACON.SUZ.](https://www.trendmicro.com/vinfo/us/threat-encyclopedia/malware/Trojan.Win64.COBEACON.SUZ)\n\nAs we noted earlier, Microsoft has yet to release an official patch. We reiterate our long-standing advice to avoid opening files from\nunexpected sources, which could considerably lower the risk of this threat as it requires the user to actually open the malicious file.\n\nWe will update this post as necessary if more information becomes available. Updates on Trend Micro solutions can be found on this\n[knowledge base page.](https://success.trendmicro.com/solution/000288999)\n\nIndicators of Compromise\n\n\n**SHA-256** **File**\n**Description**\n\n\n**Detection Name**\n\n\n-----\n\n1fb13a158aff3d258b8f62fe211fabeed03f0763b2acadbccad9e8e39969ea00 Payload\n(CAB)\n\n5b85dbe49b8bc1e65e01414a0508329dc41dc13c92c08a4f14c71e3044b06185 Exploited\nDoc\n\n3bddb2e1a85a9e06b9f9021ad301fdcde33e197225ae1676b8c6d0b416193ecf\n\n199b9e9a7533431731fbb08ff19d437de1de6533f3ebbffc1e13eeffaa4fd455\n\n938545f7bbe40738908a95da8cdeabb2a11ce2ca36b0f6a74deda9378d380a52\n\nd0e1f97dbe2d0af9342e64d460527b088d85f96d38b1d1d4aa610c0987dca745\n\na5f55361eff96ff070818640d417d2c822f9ae1cdd7e8fa0db943f37f6494db9\n\n6eedf45cb91f6762de4e35e36bcb03e5ad60ce9ac5a08caeb7eda035cd74762b Payload\n(DLL)\n\nd0fd7acc38b3105facd6995344242f28e45f5384c0fdf2ec93ea24bfbc1dc9e6 Downloaded\nJS\n\n**URL** **Category**\n\nhxxp://hidusi[.]com/ Malware Accomplice\n\nhxxp://hidusi[.]com/e273caf2ca371919/mountain[.]html\n\nhxxp://hidusi[.]com/94cc140dcee6068a/help[.]html\n\nhxxp://hidusi[.]com/e8c76295a5f9acb7/side[.]html\n\nhxxp://hidusi[.]com/e8c76295a5f9acb7/ministry[.]cab\n\nhxxps://joxinu[.]com C&C Server\n\nhxxps://joxinu[.]com/hr[.]html\n\nhxxps://dodefoh[.]com\n\nhxxps://dodefoh[.]com/ml[.]html\n\nhxxp://pawevi[.]com/e32c8df2cf6b7a16/specify.html\n\nhxxp://sagoge[.]com/ Malware Accomplice\n\nhxxps://comecal[.]com/\n\nhxxps://rexagi[.]com/\n\nhxxp://sagoge[.]com/get_load\n\nhxxps://comecal[.]com/static-directory/templates[.]gif\n\nhxxps://comecal[.]com/ml[.]js?restart=false\n\nhxxps://comecal[.]com/avatars\n\nhxxps://rexagi[.]com:443/avatars\n\nhxxps://rexagi[.]com/ml[.]js?restart=false\n\nhxxps://macuwuf[.]com\n\nhxxps://macuwuf[.]com/get_load\n\nExploits & Vulnerabilities\n\n\nTrojan.Win64.COBEACON.SUZ\n\nTrojan.W97M.CVE202140444.A\n\nBackdoor.Win64.COBEACON.OSLJAU\n\nTrojan.JS.TIVEX.A\n\n\nMicrosoft has disclosed the existence of a new zero-day vulnerability that affects multiple versions of Windows. This vulnerability\n(designated as CVE-2021-40444) is currently delivered via malicious Office 365 documents and requires user input to open the file to\ntrigger.\n\nBy: Trend Micro September 09, 2021 Read time: ( words)\n\n\n-----\n\nContent added to Folio\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-09-09 - Remote Code Execution 0-Day (CVE-2021-40444) Hits Windows, Triggered Via Office Docs.pdf"
    ],
    "report_names": [
        "2021-09-09 - Remote Code Execution 0-Day (CVE-2021-40444) Hits Windows, Triggered Via Office Docs.pdf"
    ],
    "threat_actors": [
        {
            "id": "610a7295-3139-4f34-8cec-b3da40add480",
            "created_at": "2023-01-06T13:46:38.608142Z",
            "updated_at": "2025-03-27T02:00:02.87217Z",
            "deleted_at": null,
            "main_name": "Cobalt",
            "aliases": [
                "Cobalt Gang",
                "GOLD KINGSWOOD",
                "COBALT SPIDER",
                "G0080",
                "Mule Libra",
                "Cobalt Group"
            ],
            "source_name": "MISPGALAXY:Cobalt",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673536056,
    "ts_updated_at": 1743041358,
    "ts_creation_date": 1653753695,
    "ts_modification_date": 1653753695,
    "files": {
        "pdf": "https://archive.orkl.eu/9c1b8255e778dd97a525b6e0abb1bb9ac4d0d3e9.pdf",
        "text": "https://archive.orkl.eu/9c1b8255e778dd97a525b6e0abb1bb9ac4d0d3e9.txt",
        "img": "https://archive.orkl.eu/9c1b8255e778dd97a525b6e0abb1bb9ac4d0d3e9.jpg"
    }
}