{
    "id": "4afc7fc9-d548-48f6-9a8e-4b675e9df069",
    "created_at": "2023-01-12T15:10:32.441106Z",
    "updated_at": "2025-03-27T02:11:39.663941Z",
    "deleted_at": null,
    "sha1_hash": "de19196333f502668ad7dac555bba9ace77d8cab",
    "title": "2016-06-24 - Ani-Shell",
    "authors": "",
    "file_creation_date": "2014-10-27T16:37:47Z",
    "file_modification_date": "0001-01-01T00:00:00Z",
    "file_size": 3202581,
    "plain_text": "## SCADA Network SCADA Network SCADA Network SCADA Network\n ForensicsForensicsForensicsForensics\n\n\n###### Erik HjelmvikErik Hjelmvik <<erikerik..hjelmvikhjelmvik[at][at]netresecnetresec..comcom>>\n\n Stockholm Sweden 2014 10 22Stockholm Sweden 2014 10 22\n\n\n-----\n\n-----\n\n### Havex RAT\n\n\n###### Malware: Havex RAT Threat Actor: Dragonfly / Energetic Bear / Crouching Yeti CrowdStrike: \"ENERGETIC BEAR is an adversary [...] with a primary focus on the energy sector.\" \"ENERGETIC BEAR is operating out of Russia, or at least on behalf of Russia-based interests, and it is possible that their operations are carried out with the sponsorship or knowledge of the Russian state.\"\n\n\n-----\n\n### Havex RAT\n\n\n###### Malware: Havex RAT Threat Actor: Dragonfly / Energetic Bear / Crouching Yeti Kaspersky: \"The Crouching Yeti actor performed a massive surveillance operation targeting strategic victims\" Targeted sectors include:\n\n - Industrial/machinery\n\n - Manufacturing\n\n - Pharmaceutical\n\n - [...]\n###### \"Energetic Bear/Crouching Yeti is an actor involved in several Advanced Persistent Threat (APT) campaigns\"\n\n\n-----\n\n### Trojanized ICS Installers\n\n\n###### Symantec: \"Three different ICS equipment providers were targeted and malware was inserted into the software bundles they had made available for download on their websites.\"\n\n\n-----\n\n###### If the names of the vendors that unwittingly spread Havex were made public, the wide coverage would likely reach most of the affected asset owners.\n\n### Dale PetersonDale Peterson\n\n###### Smart ICS Security guy, former NSA geekSmart ICS Security guy, former NSA geek\n\n\n-----\n\n### Havex Trojan #1\n\n\n\n###### ● Symantec: \"a product used to provide VPN access\n to programmable logic controller (PLC) type devices.\"\n\n ● Their site was compromised for ten days\n beginning in January 2014 when approximately 250 copies of the malicious software were downloaded\n\n\n-----\n\n### Havex Trojan #1\n\n\n###### Product: Talk2M eCatcher 4.0.0.13073\n\n Company: eWON\n\n MD5: eb0dacdc8b346f44 c8c370408bad4306\n\n SHA256: 70103c1078d6eb28 b665a89ad0b3d11c 1cbca61a05a18f87 f6a16c79b501dfa9\n\n\n-----\n\n### Havex Trojan #2\n\n\n\n###### ● Symantec: \"European manufacturer of specialist\n PLC type devices.\"\n\n ● \"the Trojanized software was available for\n download for at least six weeks in June and July 2013.\"\n\n\n-----\n\n### Havex Trojan #2\n\n\n###### Product: Swiss Ranger 1.0.14.706 (libMesaSR)\n\n Company: MESA Imaging\n\n MD5: e027d4395d9ac9cc 980d6a91122d2d83\n\n SHA256: 398a69b8be2ea2b4 a6ed23a55459e046 9f657e6c7703871f 63da63fb04cefe90\n\n\n-----\n\n### Havex Trojan #3\n\n\n\n###### ● Symantec: \"European company which develops\n systems to manage wind turbines, biogas plants, and other energy infrastructure.\"\n\n ● Trojan available during ten days in April 2014\n\n\n-----\n\n### Havex Trojan #3.1\n\n\n###### Product: mbCONFTOOL v1.0.1\n\n Company: MB Connect Line GmbH\n\n MD5: 0a9ae7fdcd9a9fe0 d8c5c106e8940701\n\n SHA256: c32277fba70c82b2 37a86e9b542eb11b 2b49e4995817b7c2 da3ef67f6a971d4a\n\n\n-----\n\n### Havex Trojan #3.2\n\n\n###### Product: mbCHECK v1.1.1\n\n Company: MB Connect Line GmbH\n\n MD5: 1d6b11f85debdda2 7e873662e721289e\n\n SHA256: 0b74282d9c03affb 25bbecf28d5155c5 82e246f0ce21be27 b75504f1779707f5\n\n\n-----\n\n### Havex Trojan #3.3\n\n\n###### Product: VCOM_LAN2 <unknown version>\n\n Company: MB Connect Line GmbH\n\n MD5: <unknown hash>\n\n SHA256: <unknown hash>\n\n\n-----\n\n###### many other SCADA systems have been compromised because they don't really have cyber forensics.\n\n (Joe Weiss, 2012)\n\n### Joe WeissJoe Weiss\n\n###### Very important Control System Security guyVery important Control System Security guy\n\n\n-----\n\n# Cyber Forensics\n\n### \\ sī-b r f - ren-siks\\ ˈ ə ə ˈ\n\n\n-----\n\n### Digital Forensics\n\n\n-----\n\n### Disk Forensics for ICS\n\n\n-----\n\n### Memory Forensics\n\n|F:\\>winpmem_1.6.0.exe ramdump.raw Will generate a RAW image CR3: 0x0000122000 3 memory ranges: Start 0x00001000 - Length 0x0009D000 Start 0x00100000 - Length 0x03904000 $ python vol.py --profile=Win7SP0x86 -f ra Start 0x03C00000 - Length 0x7A1FF000 Volatile Systems Volatility Framework 2.0 Acquitision mode \\\\.\\PhysicalM eOmfofrsyet(V) Name PID PP Padding from 0x00000000 to 0x0-0-0-0-1-0-0-0--- -------------------- ------ --- 00% 0x00001000 . 0x74133a30 System 4 0x752e7020 smss.exe 252 Padding from 0x0009E000 to 0x00100000 0x759f3d40 csrss.exe 352 00% 0x00100000 .................................................. 0x75a5a530 wininit.exe 392 02% 0x03300000 ........ 0x75a5f530 csrss.exe 400 Padding from 0x03A04000 to 0x03C00000 0x759f5bc0 winlogon.exe 464 92% 0x74400000 ...............0.x.7.5.b.0.b.3.18. .s.e.r.v.i.c.e.s...ex.e. . . . . . . . . . . .5.0.8. 94% 0x77600000 ...............0.x.7.5.d.3.9.3.f8. .l.s.a.s.s...e.x.e. . . . . . . . . . . . . .5.1.6. 0x741d1750 lsm.exe 524 97% 0x7A800000 .................................................. 0x75d5b8f8 svchost.exe 628 99% 0x7DA00000 .... 0x750c67e0 svchost.exe 688 F:\\> $|Col2|Col3|\n|---|---|---|\n||3904000 $ python vol.py --profile=Win7SP0x86 -f ra A1FF000 Volatile Systems Volatility Framework 2.0 M eOmfofrsyet(V) Name PID PP 0-0-0-0-1-0-0-0--- -------------------- ------ --- 0x74133a30 System 4 0x752e7020 smss.exe 252 00100000 0x759f3d40 csrss.exe 352 .................................... 0x75a5a530 wininit.exe 392 0x75a5f530 csrss.exe 400 03C00000 0x759f5bc0 winlogon.exe 464 .0.x.7.5.b.0.b.3.18. .s.e.r.v.i.c.e.s...ex.e. . . . . . . . . . . .5.0.8. .0.x.7.5.d.3.9.3.f8. .l.s.a.s.s...e.x.e. . . . . . . . . . . . . .5.1.6. 0x741d1750 lsm.exe 524 .................................... 0x75d5b8f8 svchost.exe 628 0x750c67e0 svchost.exe 688 $||\n\n\n-----\n\n### Network Forensics\n\n\n-----\n\n### Enabling Network Forensics\n\n\n###### ----------------------------+--------{Enterprise Network}               |             [Firewall]               |  [Historian]  [MES]   [TAP]--->[sniffer]    |     |     |  ----+----------+---------+------{Process Info Network}               |            [Firewall]               |  [HMI]  [Eng Stn]   [TAP]--->[sniffer]   |     |      |  --+----+-----+-----------+------{Plant Network}      |         |   [ICS Server]     [TAP]--->[sniffer]               |   --+-----+--------+-----+------{Basic Control}    |   |    |      [PLC] [PLC]  [RTU]      \n\n\n-----\n\n### Network TAP?\n\n\n-----\n\n### Penguin + Bull = Sniffer\n\n\n-----\n\n### Enabling Network Forensics\n\n\n###### ----------------------------+--------{Enterprise Network}               |             [Firewall]               |  [Historian]  [MES]   [TAP]--->[sniffer]    |     |     |  ----+----------+---------+------{Process Info Network}               |            [Firewall]               |  [HMI]  [Eng Stn]   [TAP]--->[sniffer]   |     |      |  --+----+-----+-----------+------{Plant Network}      |         |   [ICS Server]     [TAP]--->[sniffer]               |   --+-----+--------+-----+------{Basic Control}    |   |    |      [PLC] [PLC]  [RTU]      \n\n\n-----\n\n### Protocol: IEC-104\n\n\n#### IEC 60870-5-104 (aka IEC-104)\n\n##### INTERNATIONAL\n\n ELECTROTECHNICAL\n\n COMMISSION\n\n\n-----\n\n### IEC-104 Network Forensics\n\n\n###### $ tshark -R \"104asdu.float\" -Eoccurrence=f -T fields -e frame.number -e ip.src -e ip.dst -e 104asdu.causetx -e 104asdu.ioa -e 104asdu.float -r iec104.pcap 18   192.168.45.33  192.168.45.251 20   3002  0 20   192.168.45.33  192.168.45.251 20   3005  0 30   192.168.45.33  192.168.45.251 20   3002  0 405   192.168.45.33  192.168.45.251 20   3002  0 407   192.168.45.33  192.168.45.251 20   3004  0 419   192.168.45.33  192.168.45.251 20   3002  0 421   192.168.45.33  192.168.45.251 20   3004  0 460   192.168.45.33  192.168.45.251 3    3002  119,633 462   192.168.45.33  192.168.45.251 3    3002  480,819 464   192.168.45.33  192.168.45.251 3    3008  391,858 468   192.168.45.33  192.168.45.251 3    3002  1701,86 471   192.168.45.33  192.168.45.251 3    3008  1703,7 473   192.168.45.33  192.168.45.251 3    3002  1931,82 475   192.168.45.33  192.168.45.251 3    3008  1934,11\n [...]\n\n\n-----\n\n### IEC-104 in NetworkMiner\n\n\n-----\n\n### Protocol: OPC\n\n\n#### OPC = OLE for Process Control\n\n\n-----\n\n-----\n\n### Malware Lab Network\n\n\n######             +----[OPC Server]             |   (scanned)\n [OPC Client]----[TAP]---+ (infected) |   | |   +----[INetSim] | (simulated Internet) | V        [Sniffer] (full content packet capture)\n\n\n-----\n\n### Havex OPC Scan\n\n\n$ tshark -nr havex_6bfc42f7cb1364ef0bfd749776ac6d38.pcap -R dcerpc.cn_bind_to_uuid -T\nfields -e ip.src -e ip.dst -e dcerpc.cn_bind_to_uuid -Eoccurrence=f -Eheader=y\nip.src ip.dst dcerpc.cn_bind_to_uuid\n192.168.0.111  192.168.0.112  000001a0-0000-0000-c000-000000000046\n192.168.0.111  192.168.0.112  9dd0b56c-ad9e-43ee-8305-487f3188bf7a <- OPC Server List 2\n192.168.0.111  192.168.0.112  55c382c8-21c7-4e88-96c1-becfb1e3f483 <- OPC Enum GUID\n192.168.0.111  192.168.0.112  00000143-0000-0000-c000-000000000046\n192.168.0.111  192.168.0.112  00000143-0000-0000-c000-000000000046\n192.168.0.111  192.168.0.112  39c13a4d-011e-11d0-9675-0020afd8adb3 <- OPC Server\n192.168.0.111  192.168.0.112  39227004-a18f-4b57-8b0a-5235670f4468 <- OPC Browse\n$\n\n\n-----\n\n### Havex C&C Traffic\n\n\n###### $ tshark -nr havex_0a9ae7fdcd9a9fe0d8c5c106e8940701.pcap -R http.request -T fields -e ip.src -e http.host -e http.request.method -e http.request.uri 192.168.0.111 rapidecharge.gigfa.com POST   /blogs/wp-content/plugins/buddypress/bp-settings/bp- settings-src.php?id=84651193834787196090098FD80- c8a7af419640516616c342b13efab &v1=043&v2=170393861&q=45474bca5c3a10c8e94e56543c2bd $\n\n\n-----\n\n### Havex IDS Signature\n\n\n###### Emerging Threats IDS signature 2018251:\n\n #alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:\"ET DELETED Havex Rat Check-in URI Struct\"; flow:established,to_server; content:\"POST\"; http_method; content:!\"Referer|3a 20|\"; content:\".php?id\"; http_uri; content:\"&v1=\"; http_uri; content:\"&v2=\"; http_uri; content:\"&q=\"; http_uri; pcre:\"/\\.php\\? id=[A-F0-9]+\\-[A-F0-9]+&v1=[A-F0-9]+&v2=[A-F0- 9]+&q=[A-F0-9]+$/U\"; reference:md5,6557d6518c3f6bcb8b1b2de77165c962; classtype:trojan-activity; sid:2018251; rev:1;)\n\n\n-----\n\n### Enabling Network Forensics\n\n\n###### ----------------------------+--------{Enterprise Network}               |             [Firewall]               |  [Historian]  [MES]   [TAP]--->[sniffer]    |     |     |  ----+----------+---------+------{Process Info Network}               |            [Firewall]               |  [HMI]  [Eng Stn]   [TAP]--->[sniffer]   |     |      |  --+----+-----+-----------+------{Plant Network}      |         |   [ICS Server]     [TAP]--->[sniffer]               |   --+-----+--------+-----+------{Basic Control}    |   |    |      [PLC] [PLC]  [RTU]      \n\n\n-----\n\n### More ICS in NetworkMiner\n\n\n-----\n\n###### CONTACT INFO E-mail: erik.hjelmvik [at] netresec.com Twitter: @netresec\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/ICS SCADA/Havex/SCADA Network Forensics.pdf"
    ],
    "report_names": [
        "SCADA Network Forensics.pdf"
    ],
    "threat_actors": [
        {
            "id": "5cbf6c32-482d-4cd2-9d11-0d9311acdc28",
            "created_at": "2023-01-06T13:46:38.39927Z",
            "updated_at": "2025-03-27T02:00:02.823829Z",
            "deleted_at": null,
            "main_name": "ENERGETIC BEAR",
            "aliases": [
                "DYMALLOY",
                "TG-4192",
                "Crouching Yeti",
                "Group 24",
                "Havex",
                "IRON LIBERTY",
                "Blue Kraken",
                "ALLANITE",
                "Koala Team",
                "G0035",
                "ATK6",
                "ITG15",
                "Ghost Blizzard",
                "BERSERK BEAR"
            ],
            "source_name": "MISPGALAXY:ENERGETIC BEAR",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "649b5b3e-b16e-44db-91bc-ae80b825050e",
            "created_at": "2022-10-25T15:50:23.290412Z",
            "updated_at": "2025-03-27T02:00:55.431037Z",
            "deleted_at": null,
            "main_name": "Dragonfly",
            "aliases": [
                "TEMP.Isotope",
                "DYMALLOY",
                "Berserk Bear",
                "TG-4192",
                "Crouching Yeti",
                "IRON LIBERTY",
                "Energetic Bear",
                "Ghost Blizzard"
            ],
            "source_name": "MITRE:Dragonfly",
            "tools": [
                "MCMD",
                "Impacket",
                "CrackMapExec",
                "Backdoor.Oldrea",
                "Mimikatz",
                "PsExec",
                "Trojan.Karagany",
                "netsh"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "1a76ed30-4daf-4817-98ae-87c667364464",
            "created_at": "2022-10-25T16:47:55.891029Z",
            "updated_at": "2025-03-27T02:05:17.408867Z",
            "deleted_at": null,
            "main_name": "IRON LIBERTY",
            "aliases": [
                "ATK6 ",
                "BROMINE ",
                "CASTLE ",
                "Crouching Yeti ",
                "DYMALLOY ",
                "Dragonfly ",
                "Energetic Bear / Berserk Bear ",
                "Ghost Blizzard ",
                "TEMP.Isotope ",
                "TG-4192 ",
                "ALLANITE "
            ],
            "source_name": "Secureworks:IRON LIBERTY",
            "tools": [
                " Ddex Loader",
                " Havex",
                " Karagany",
                " Loek",
                " MCMD",
                " Sysmain",
                " xfrost",
                "ClientX"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "3a0be4ff-9074-4efd-98e4-47c6a62b14ad",
            "created_at": "2022-10-25T16:07:23.590051Z",
            "updated_at": "2025-03-27T02:02:09.878211Z",
            "deleted_at": null,
            "main_name": "Energetic Bear",
            "aliases": [
                "ATK 6",
                "Blue Kraken",
                "Crouching Yeti",
                "Dragonfly",
                "Electrum",
                "Energetic Bear",
                "Ghost Blizzard",
                "Group 24",
                "ITG15",
                "Iron Liberty",
                "Koala Team",
                "TG-4192"
            ],
            "source_name": "ETDA:Energetic Bear",
            "tools": [
                "Backdoor.Oldrea",
                "CRASHOVERRIDE",
                "Commix",
                "CrackMapExec",
                "CrashOverride",
                "Dirsearch",
                "Dorshel",
                "Fertger",
                "Fuerboos",
                "Goodor",
                "Havex",
                "Havex RAT",
                "Hello EK",
                "Heriplor",
                "Impacket",
                "Industroyer",
                "Karagany",
                "Karagny",
                "LightsOut 2.0",
                "LightsOut EK",
                "Listrix",
                "Oldrea",
                "PEACEPIPE",
                "PHPMailer",
                "PsExec",
                "SMBTrap",
                "Subbrute",
                "Sublist3r",
                "Sysmain",
                "Trojan.Karagany",
                "WSO",
                "Webshell by Orb",
                "Win32/Industroyer",
                "Wpscan",
                "nmap",
                "sqlmap",
                "xFrost"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673536232,
    "ts_updated_at": 1743041499,
    "ts_creation_date": 1414427867,
    "ts_modification_date": 0,
    "files": {
        "pdf": "https://archive.orkl.eu/de19196333f502668ad7dac555bba9ace77d8cab.pdf",
        "text": "https://archive.orkl.eu/de19196333f502668ad7dac555bba9ace77d8cab.txt",
        "img": "https://archive.orkl.eu/de19196333f502668ad7dac555bba9ace77d8cab.jpg"
    }
}