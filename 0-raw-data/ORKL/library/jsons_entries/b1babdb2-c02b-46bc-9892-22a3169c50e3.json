{
    "id": "b1babdb2-c02b-46bc-9892-22a3169c50e3",
    "created_at": "2023-01-12T15:09:38.748057Z",
    "updated_at": "2025-03-27T02:05:26.478028Z",
    "deleted_at": null,
    "sha1_hash": "d1adcc4505270a603f29a4a18f0380279d51e9d8",
    "title": "2022-07-05 - Lockbit 3.0 – Ransomware Group Launches New Version",
    "authors": "",
    "file_creation_date": "2022-07-18T18:22:51Z",
    "file_modification_date": "2022-07-18T18:22:51Z",
    "file_size": 4130929,
    "plain_text": "# Lockbit 3.0 – Ransomware group launches new version\n\n**[blog.cyble.com/2022/07/05/lockbit-3-0-ransomware-group-launches-new-version/](https://blog.cyble.com/2022/07/05/lockbit-3-0-ransomware-group-launches-new-version/)**\n\n## “Lockbit Black” actively targeting BFSI Sector\n\n\nJuly 5, 2022\n\n\nLockBit ransomware is currently one of the most popular and active ransomware groups in the wild.\nThis ransomware variant was first detected in September 2019 and used by Threat Actors (TAs) to\ntarget multiple sectors and organizations worldwide. The TAs behind LockBit operate under the\nRansomware-as-a-Service (RaaS) business model.\n\nIn the figure below, we have prepared a breakdown of the industries targeted by the LockBit\nransomware. As per our investigation, we determine that over 1/3 of the ransomware gang’s victimsrd\nare from the BFSI sector, followed by the Professional Services sector.\n\n\n-----\n\nFigure 1 – Industries Targeted by the LockBit Ransomware\n[In August 2021, LockBit 2.0 ransomware was analyzed by Cyble Research Labs. In March 2022, the](https://blog.cyble.com/2021/08/16/a-deep-dive-analysis-of-lockbit-2-0/)\nTAs behind LockBit announced that LockBit 3.0 would be released shortly. Last week, the TAs updated\ntheir leak site with information about their latest version and its features (shown below).\n\nFigure 2 – LockBit 3.0 Ransomware Functionalities\nWhile searching for the latest LockBit 3.0 sample, Cyble Research Labs came across a [Twitter post](https://twitter.com/vxunderground/status/1543661557883740161)\nwherein a researcher mentioned that a new version of ransomware named “LockBit 3.0” (also referred\nto as “LockBit Black”) is now active in the wild.\n\nLockBit 3.0 encrypts files on the victim’s machine and appends the extension of encrypted\nfiles as “HLJkNskOq.”\n\n\n-----\n\nLockBit ransomware requires a key from the command-line argument -pass to execute. The below\nfigure shows the process chain of the LockBit ransomware file.\n\nFigure 3 – LockBit 3.0 Ransomware Process Tree\n\n## Technical Analysis\n\nThe sample hash (SHA256),\n**_80e8defa5377018b093b5b90de0f2957f7062144c83a09a56bba1fe4eda932cewas taken for this_**\nanalysis.\n\nBased on static analysis, we identified that the ransomware is encrypted and decrypts the strings and\ncode during runtime.\n\nThe ransomware resolves its API functions dynamically, as shown below.\n\nFigure 4 – Resolved API functions of LockBit 3.0\nAfter that, it creates a mutex to ensure that only one instance of malware is running on the victim’s\nsystem at any given time.\n\nThe malware exits if the mutex is already present. The below figure shows the created mutex name.\n\nFigure 5 – Mutex Creation\nThe ransomware creates multiple threads using the CreateThread() API to perform several tasks in\nparallel for faster file encryption, as shown in Figure 6.\n\nEach thread is responsible for querying system information, getting drive details, ransom note creation,\ngetting file attributes, deleting services, file search, encryption, etc.\n\n\n-----\n\nFigure\n\n6 – Multiple Thread Creation\nBefore encrypting the files, the ransomware uses the WMI query to enumerate Volume Shadow copies\nusing the command “select * from Win32_ShadowCopy”.\n\nIt then deletes the copies using “Win32_ShadowCopy.ID,” as shown in Figure 7.\n\nThe ransomware performs this operation to prevent any attempts at system restoration after encrypting\nthe files.\n\nFigure 7 – Delete ShadowCopy\nLockBit 3.0 ransomware deletes a few services to encrypt the files successfully. To delete these\nservices, the ransomware calls the OpenSCManagerA()API to get the service control manager\ndatabase access.\n\nAfter gaining access, the ransomware enumerates the services and fetches the service names from the\nvictim’s machine.\n\nIt then checks for the presence of these services and deletes them if they are actively running on the\nvictim’s machine. The below image shows the list of some service names targeted by ransomware.\n\n\n-----\n\nFigure\n\n8 – List of Services for Deletion\nAfter deleting the services, the ransomware drops two files named “HLJkNskOq.ico” and\n“HLJkNskOq.bmp” in the %programdata% location.\n\nThe ransomware creates a “DefaultIcon” registry key for the extension “HLJkNskOq” shown in the\nfigure below.This operation changes the icons of the encrypted files, which have the extension\n“HLJkNskOq.”\n\nFigure 9 – Registry Modification of Default Icon\nBefore initiating the encryption process, the ransomware drops the below ransom note in multiple\nfolders with the file name “HLJkNskOq.README.txt.”\n\n\n-----\n\nFigure 10 – LockBit 3.0 Ransomware Note\nThe ransomware then encrypts the victim’s files, appends the extension “.HLJkNskOq,” and changes\nthe file’s icon as shown below.\n\n\n-----\n\nFigure 11 – Encrypted Files\nFinally, the ransomware changes the victim’s wallpaper leveraging the file “HLJkNskOq.bmp” using the\n_systemparametersinfoW() API function._\n\nFigure 12 – LockBit 3.0 Changing Desktop Background\nIn the dropped ransom note, victims are instructed on how to pay the ransom to decrypt their encrypted\nfiles. Additionally, the TAs threaten the victims stating that their personal data will be posted on their\nleak site if the ransom is not paid within the specified window.\n\n\n-----\n\nAfter visiting the TOR link mentioned in the ransom note, it opens the TAs leak site page, which is\nupdated with new features containing a Twitter icon to search for posts related to this ransomware on\nTwitter.\n\nAdditionally, TAs created a link on their leak site, redirecting users to a page where they have\nannounced the Bug Bounty program. This program invites all\n\nsecurity researchers/ethical and unethical hackers to find flaws in their ransomware project to make it\nbug-free and more stable.\n\nFigure 13 – LockBit 3.0 Ransomware Home Page\nThe affiliate rules page of the leak site includes ransomware functionalities and affiliate program details,\nwhich support languages such as English, Chinese, Spanish, etc.\n\nThe TAs behind LockBit 3.0 suggest that their victims buy Bitcoin using the payment options shown in\nthe figure below.\n\n\n-----\n\nFigure 14 – Ways to Buy Bitcoin to decrypt files\nThe figure below shows the chat option on the leak site for communication with the TAs. Also, the “Trial\nDecrypt” option is available to victims to test an encrypted file’s decryption.\n\nFigure 15 – Trial Decryption & Chat Options\n\n## Conclusion\n\n\n-----\n\nRansomware is becoming an increasingly common and effective attack method to target organizations\nand adversely impact their productivity.\n\nLockBit 3.0 is a highly sophisticated form of ransomware that uses various techniques to conduct its\noperations. Cyble will closely monitor the campaign and continue to update our readers with the latest\ninformation on ransomware.\n\n## Our Recommendations\n\nWe have listed some essential cybersecurity best practices that create the first line of control against\nattackers. We recommend that our readers follow the best practices given below:\n\n**Safety Measures Needed to Prevent Ransomware Attacks**\n\nConduct regular backup practices and keep those backups offline or in a separate network.\nTurn on the automatic software update feature on your computer, mobile, and other connected\ndevices wherever possible and pragmatic.\nUse a reputed anti-virus and Internet security software package on your connected devices,\nincluding PC, laptop, and mobile.\nRefrain from opening untrusted links and email attachments without verifying their authenticity.\n\n**Users Should Take the Following Steps After the Ransomware Attack**\n\nDetach infected devices on the same network.\nDisconnect external storage devices if connected.\nInspect system logs for suspicious events.\n\n**Impacts And Cruciality of LockBit 3.0 Ransomware**\n\nLoss of Valuable data.\nLoss of the organization’s reputation and integrity.\nLoss of the organization’s sensitive business information.\nDisruption in organization operation.\nFinancial loss.\n\n## MITRE ATT&CK® Techniques\n\n**Tactic** **Technique ID** **Technique Name**\n\nExecution [T1204](https://attack.mitre.org/techniques/T1204/) User Execution\n\n\nDefence Evasion [T1112](https://attack.mitre.org/techniques/T1112/)\n\n[T1497](https://attack.mitre.org/techniques/T1497/)\n\nDiscovery [T1082](https://attack.mitre.org/techniques/T1082/)\n\n[T1083](https://attack.mitre.org/techniques/T1083)\n\n\nModify Registry\n\nVirtualization/Sandbox Evasion\n\nSystem Information Discovery\n\nFile and Directory Discovery\n\n\nImpact [T1486](https://attack.mitre.org/techniques/T1486/) Data Encrypted for Impact\n\nCNC [T1071](https://attack.mitre.org/techniques/T1071/) Application Layer Protocol\n\n\n-----\n\nDefense Evasion [T1070](https://attack.mitre.org/techniques/T1070/) Indicator Removal on Host\n\n## Indicator Of Compromise (IOCs)\n\n**Indicators** **Indicator**\n\n**Type**\n\n\n**Description**\n\nLockBit 3.0\n\nEXE file\n\n\n38745539b71cf201bb502437f891d799\n\nf2a72bee623659d3ba16b365024020868246d901\n\n80e8defa5377018b093b5b90de0f2957f7062144c83a09a56bba1fe4eda932ce\n\n\nMD5\n\nSHA1\n\nSha256\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-07-05 - Lockbit 3.0 – Ransomware Group Launches New Version.pdf"
    ],
    "report_names": [
        "2022-07-05 - Lockbit 3.0 – Ransomware Group Launches New Version.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673536178,
    "ts_updated_at": 1743041126,
    "ts_creation_date": 1658168571,
    "ts_modification_date": 1658168571,
    "files": {
        "pdf": "https://archive.orkl.eu/d1adcc4505270a603f29a4a18f0380279d51e9d8.pdf",
        "text": "https://archive.orkl.eu/d1adcc4505270a603f29a4a18f0380279d51e9d8.txt",
        "img": "https://archive.orkl.eu/d1adcc4505270a603f29a4a18f0380279d51e9d8.jpg"
    }
}