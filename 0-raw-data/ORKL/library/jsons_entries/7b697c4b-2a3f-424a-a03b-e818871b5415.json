{
    "id": "7b697c4b-2a3f-424a-a03b-e818871b5415",
    "created_at": "2023-01-12T15:09:57.111068Z",
    "updated_at": "2025-03-27T02:05:53.205052Z",
    "deleted_at": null,
    "sha1_hash": "60cb54b90d886604119776b76f47af195ab41876",
    "title": "2020-04-12 - Dynamic analysis technique to get decrypted KPOT Malware",
    "authors": "",
    "file_creation_date": "2022-05-29T01:13:13Z",
    "file_modification_date": "2022-05-29T01:13:13Z",
    "file_size": 349840,
    "plain_text": "# SANS ISC: InfoSec Handlers Diary Blog - SANS Internet Storm Center SANS Site Network Current Site SANS Internet Storm Center Other SANS Sites Help Graduate Degree Programs Security Training Security Certification Security Awareness Training Penetration Testing Industrial Control Systems Cyber Defense Foundations DFIR Software Security Government OnSite Training InfoSec Handlers Diary Blog\n\n**isc.sans.edu/diary/26010**\n\n## Reader Analysis: \"Dynamic analysis technique to get decrypted KPOT Malware.\"\n\n**Published: 2020-04-12**\n\n**Last Updated: 2020-04-12 09:11:26 UTC**\n\n**by** [Didier Stevens (Version: 1)](https://isc.sans.edu/handler_list.html#didier-stevens)\n\n[0 comment(s)](https://isc.sans.edu/forums/diary/Reader+Analysis+Dynamic+analysis+technique+to+get+decrypted+KPOT+Malware/26010/#comments)\nReader Vinnie shared his analysis of KPOT malware with us:\n\nIn a previous write up, I documented a PowerShell downloader (shown below) pushing KPOT malware. Since then,\nall of the files have been submitted to VirusTotal allowing for further analysis. This has also been recently\ndocumented by ISC Handler Didier Stevens (ISC Links below).\n\nPowerShell Downloader:\n\nISC Links:\n\n- [https://isc.sans.edu/forums/diary/More+COVID19+Themed+Malware/25930/](https://isc.sans.edu/forums/diary/More+COVID19+Themed+Malware/25930/)\n\n- [https://isc.sans.edu/forums/diary/KPOT+Deployed+via+AutoIt+Script/25934/](https://isc.sans.edu/forums/diary/KPOT+Deployed+via+AutoIt+Script/25934/)\n\nURLs from PowerShell Downloader:\n\nhxxp://show1[.]website/OerAS.dat (Obfuscated AutoIt script, Base64 encoded as a certificate)\n\nhxxp://show1[.]website/HeyaL.dat (AutoIt Interpreter) – Legitimate\n\nhxxp://show1[.]website/iPYOy.dat (Encrypted KPOT Malware)\n\nExcerpt from Base64 decoded AutoIt script(‘i8ek7’) showing obfuscation:\n\nDecode function at the bottom of AutoIt script:\n\n\n-----\n\nThe string is split from and then each encoded character is subtracted from the number after the\ncomma($integer) before being converted from Unicode.\nDecoded sample:\n\nAll files necessary in the same folder ‘Temp’ – Windows 7 Virtual Machine:\n\nUtilizing PowerShell to initiate infection chain:\n\nProcess chain showing ‘dllhost.exe’ process hollowing:\nCreateProcess: powershell.exe:2428 > \"%UserProfile%\\Downloads\\Temp\\r17mi.com i8ek7 \"\n\n- [Child PID: 2452]\nCreateProcess: r17mi.com:2452 > \"%UserProfile%\\Downloads\\Temp\\r17mi.com i8ek7 \"\n\n- [Child PID: 2064]\nCreateProcess: r17mi.com:2064 > \"%WinDir%\\SysWOW64\\dllhost.exe\"\n\n- [Child PID: 2244]\nCreateProcess: dllhost.exe:2244 > \"%WinDir%\\system32\\cmd.exe /c ping 127.0.0.1 && del\n%WinDir%\\SysWOW64\\dllhost.exe\"\n\n- [Child PID: 536]\nCreateProcess: cmd.exe:536 > \"ping 127.0.0.1 \"\n\n“dllhost.exe” process dump via Task Manager:\n\n\n-----\n\nString analysis via “strings” show command and control (C2) servers:\n\nExtract executables via “foremost”:\n\nThe decrypted KPOT malware has the SHA256 Hash\n“3fd4aa339bdfee23684ff495d884aa842165e61af85fd09411abfd64b9780146” and VT score of 34/71.\nhttps://www.virustotal.com/gui/file/3fd4aa339bdfee23684ff495d884aa842165e61af85fd09411abfd64b9780146/detection\n\nSampled VirusTotal signatures:\n\nString analysis of KPOT malware via “FLOSS”:\n\n\n-----\n\nStrings indicative of information stealers:\n\nDidier Stevens\nSenior handler\nMicrosoft MVP\n[blog.DidierStevens.com](http://blog.didierstevens.com/) [DidierStevensLabs.com](http://didierstevenslabs.com/)\n\n[Keywords: kpot](https://isc.sans.edu/tag.html?tag=kpot) [malware](https://isc.sans.edu/tag.html?tag=malware)\n[0 comment(s)](https://isc.sans.edu/forums/diary/Reader+Analysis+Dynamic+analysis+technique+to+get+decrypted+KPOT+Malware/26010/)\n\nJoin us at SANS! Attend [with Didier Stevens in starting](https://isc.sans.edu/diary/26010)\n\nTop of page\n×\n\n[Diary Archives](https://isc.sans.edu/diaryarchive.html)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2020/2020-04-12 - Dynamic analysis technique to get decrypted KPOT Malware.pdf"
    ],
    "report_names": [
        "2020-04-12 - Dynamic analysis technique to get decrypted KPOT Malware.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673536197,
    "ts_updated_at": 1743041153,
    "ts_creation_date": 1653786793,
    "ts_modification_date": 1653786793,
    "files": {
        "pdf": "https://archive.orkl.eu/60cb54b90d886604119776b76f47af195ab41876.pdf",
        "text": "https://archive.orkl.eu/60cb54b90d886604119776b76f47af195ab41876.txt",
        "img": "https://archive.orkl.eu/60cb54b90d886604119776b76f47af195ab41876.jpg"
    }
}