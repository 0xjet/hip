{
    "id": "ceeb9eea-4339-4e41-88e3-c2d2b11aef18",
    "created_at": "2023-01-12T15:10:39.204285Z",
    "updated_at": "2025-03-27T02:05:18.998252Z",
    "deleted_at": null,
    "sha1_hash": "4fc4cb48b27615f8fcb04b10211b9aface4c98bf",
    "title": "2021-03-18 - Convuster- macOS adware now in Rust",
    "authors": "",
    "file_creation_date": "2022-05-28T16:11:33Z",
    "file_modification_date": "2022-05-28T16:11:33Z",
    "file_size": 1125008,
    "plain_text": "# Convuster: macOS adware now in Rust\n\n**securelist.com/convuster-macos-adware-in-rust/101258/**\n\nAuthors\n\n\n-----\n\nIlya Mogilin\n\nMikhail Kuzin\n\n## Introduction\n\nTraditionally, most malicious objects detected on the macOS platform are adware: besides\n[the already familiar Shlayer family, the TOP 10 includes Bnodlero, Cimpli, Adload and Pirrit](https://securelist.com/shlayer-for-macos/95724/)\nadware. As a rule, most tend to be written in C, Objective-C or Swift. Recently, however,\ncybercriminals have been paying increased attention to new programming languages,\nseemingly in the hope that such code will be more opaque to virus analysts who have little or\nno experience with the newer languages. We have already seen quite a few samples written\nin Go, and recently cybercriminals turned their attention to Rust as well.\n\nThe first to write about suspicious files in this programming language was a Twitter user,\n@gorelics:\n\n[Suspicious agent (rust compiler)#macos](https://twitter.com/hashtag/macos?src=hash&ref_src=twsrc%5Etfw)\n[#malwarehttps://t.co/9PZ6v9u0Yshttps://t.co/uylt2w6TUJ](https://twitter.com/hashtag/malware?src=hash&ref_src=twsrc%5Etfw) [pic.twitter.com/OgZIzlgVmA](https://t.co/OgZIzlgVmA)\n\n[— gorelics (@gorelics) August 16, 2020](https://twitter.com/gorelics/status/1295018198081966082?ref_src=twsrc%5Etfw)\n\nIn the screenshot the tweet shows, one can see that several samples of suspicious code are\nrun by configuration PLIST files through the LaunchAgents/LaunchDaemons mechanism.\nAlongside the suspicious names of the PLIST files, this is the first wakeup call that the\nprogram is dangerous, given the low popularity of Rust-based executables.\n\nWe examined these samples for malicious behavior. The analysis showed these executables\nto be a new adware program, that has subsequently been called Convuster.\n\n## Technical details\n\n### Sample in Rust\n\nIt can be deduced that the analyzed sample was written in Rust from the frequent use of the\nlanguage’s standard library, as well as several code lines containing paths to files with the .rs\nextension, which is the standard Rust source file extension.\n\n\n-----\n\n**_Rust artifacts in the sample_**\n\nAt startup, the executable checks the configuration PLIST files\n**~/Library/LaunchAgents/com.ist.up.plist and /Library/LaunchDaemons/com.ist.up.plist**\nfor keys needed to run the sample, such as RunAtLoad, StartInterval and Version. We were\nnot able to retrieve these files, but presumably they are used to run the sample under\ninvestigation when the user logs in to the system.\n\nAfter these checks, the program obtains the device ID, as well as the system version and\nbitness, and forwards the gathered data to the following server:\n**hxxps://post.convstats[.]com/hb/. In response, Convuster receives a JSON file and sends**\na request to the host specified in this file. The response to this request is a Bash script that\ngets executed by the Bash shell and then removed from the system.\n\n\n-----\n\n**_Request generation_**\n\nAt the time of analysis, the server was not responding to requests. However, after examining\ninformation about the suspicious convstats[.]com domain, we detected the\n**update.convstats[.]com and trk.convstats[.]com subdomains (in addition to the already**\nknown post.convstats[.]com).\n\n### Sample in Swift\n\nIn the update.convstats[.]com subdomain, at the address\n**hxxps://update.convstats[.]com/Player.dmg, we found a DMG disk image containing**\nanother Convuster executable, this time in the Swift programming language.\n\nThe payload of the executable was encrypted:\n\n**_XOR encryption_**\n\nHaving decrypted the data, Convuster runs the code obtained, first of all checking that the\nDMG image was downloaded specifically from the address\n**hxxps://update.convstats[.]com/Player.dmg with either the ?_=1390081 or &_=1390081**\nparameter. It does so by accessing the quarantine database of the macOS Gatekeeper\nsecurity feature using the following query:\n\n**_select LSQuarantineAgentBundleIdentifier, LSQuarantineDataURLString from_**\n**_LSQuarantineEvent order by LSQuarantineTimeStamp desc limit 3_**\n\n\n-----\n\n**_Typical Gatekeeper database content_**\n\nUsually, this macOS database serves as a log for all files downloaded from untrusted\nsources. However, Convuster’s creators use it to protect their handiwork from being\nanalyzed. If it was not downloaded from an “official” server, but rather got into the system\nsome other way, it may mean that the program is in a test or virtual environment, that is,\nunder investigation by virus analysts.\n\nIf the file source check is successful, the user is shown a window prompting to install Flash\nPlayer. Otherwise, the program prompts to continue the installation later, and then exits.\n\n**_The installer mimics a Flash Player update_**\n\nRegardless of whether the user agrees to the installation or attempts to close the window,\nConvuster sends a request to hxxps://post.convstats[.]com/dis/ to download the\ninstallation script and then runs it in the Bash shell\n\n\n-----\n\n**_Running the script in the Bash shell_**\n\n## Distribution\n\nConvuster is run through LaunchAgents, but the program does not try to add itself to startup\nindependently. This means that the file in question was most likely neither downloaded nor\ninstalled directly by the user. In our view, Convuster could have been installed by some other\nadware.\n\nAt the time of the study, we were aware of the following domain names performing redirects\nto the update.convstats[.]com subdomain:\n\nstoreoverlyadvancedapplication[.]best\nstreamgreatlyadvancedprogram[.]best\nstreamstrongcompletelyprogram[.]best\nsyncextremelysophisticatedsoftware[.]icu\nstreamquickcompletelyprogram[.]best\ngetnewestextremelyapp[.]best\nlaunchfreeextremelyfreeware[.]best\nloadsophisticated-thecompletelyfile[.]best\n\nBesides, forum users complain about other domains prompting to install a fake Flash Player\nupdate:\n\n\n-----\n\n**_User complaints about advertising redirects_**\n\n## Conclusion\n\nBased on the behavior of the Convuster samples in Rust and Swift, we classify this program\nas adware. Despite their supposed exoticism, these languages lack nothing in terms of\nfunctionality from an adware developer’s point of view: Rust, for instance, has the tools not\nonly for authoring adware, but for carrying out more sophisticated attacks.\n\nBesides the choice of programming language, it is noteworthy that cybercriminals have\nlearned to use built-in macOS tools and technologies, such as Gatekeeper, for their own\npurposes (for example, to verify the source of a file). Although this family is no longer active,\nit is a clear illustration of how attackers are constantly honing their threats to evade analysis\nand deliver adware to as many devices as possible.\n\nKaspersky security solutions detect this adware with the following verdict: not-avirus:HEUR:AdWare.OSX.Convuster.a.\n\n### IoCs\n\n**SHA-256**\n\n**Swift samples**\n\nMach-O executables:\n\n[f9615ce5f1038afd4e19d3e35643c98af1a2ee53d9bf45958c84e5a7c4529e62](https://opentip.kaspersky.com/f9615ce5f1038afd4e19d3e35643c98af1a2ee53d9bf45958c84e5a7c4529e62/?utm_source=SL&utm_medium=SL&utm_campaign=SL)\n\nDisk Images:\n\n[02a0842beaf5ee9ed4f0f693ba276b73d53717eca821d2506efcdef7711d66da](https://opentip.kaspersky.com/02a0842beaf5ee9ed4f0f693ba276b73d53717eca821d2506efcdef7711d66da/?utm_source=SL&utm_medium=SL&utm_campaign=SL)\n\n\n-----\n\nArchives:\n[e5871655465e31c57e27900254e281233787f44bcec5604607b0b3bbbf5a9b16](https://opentip.kaspersky.com/e5871655465e31c57e27900254e281233787f44bcec5604607b0b3bbbf5a9b16/?utm_source=SL&utm_medium=SL&utm_campaign=SL)\n[182d8821182a143770e60a901486f262f63d2cfdc8bc9de3c076a80d36d02049](https://opentip.kaspersky.com/182d8821182a143770e60a901486f262f63d2cfdc8bc9de3c076a80d36d02049/?utm_source=SL&utm_medium=SL&utm_campaign=SL)\n[6bc8fc9fb7693379666049659e83f25b336b6b0b5e8073e1dd69e5b3dcb9826d](https://opentip.kaspersky.com/6bc8fc9fb7693379666049659e83f25b336b6b0b5e8073e1dd69e5b3dcb9826d/?utm_source=SL&utm_medium=SL&utm_campaign=SL)\n[cbd6fb1075fc3e57ea7ac886ca218a105c307b75c37e10ca86a5779f4abeca3a](https://opentip.kaspersky.com/cbd6fb1075fc3e57ea7ac886ca218a105c307b75c37e10ca86a5779f4abeca3a/?utm_source=SL&utm_medium=SL&utm_campaign=SL)\n[02e6f4388387c940b30c9afb911686d6bee5b3a7249e986f239bbd73d9003a0d](https://opentip.kaspersky.com/02e6f4388387c940b30c9afb911686d6bee5b3a7249e986f239bbd73d9003a0d/?utm_source=SL&utm_medium=SL&utm_campaign=SL)\n[31526cfba9202086feeb658f92941b1ecd7ae1b646c75886600a991f86a843a4](https://opentip.kaspersky.com/31526cfba9202086feeb658f92941b1ecd7ae1b646c75886600a991f86a843a4/?utm_source=SL&utm_medium=SL&utm_campaign=SL)\n\n**Rust samples**\n\nMach-O executables:\n[947ae8f075fd0d1e5be0341b922c0173f0c5cfd771314ebe220207f3ed53466a](https://opentip.kaspersky.com/947ae8f075fd0d1e5be0341b922c0173f0c5cfd771314ebe220207f3ed53466a/?utm_source=SL&utm_medium=SL&utm_campaign=SL)\n[77bc8b0e17e1c56fba70d8707de9718cd5c10565454fdb85c862a7f3d7e82983](https://opentip.kaspersky.com/77bc8b0e17e1c56fba70d8707de9718cd5c10565454fdb85c862a7f3d7e82983/?utm_source=SL&utm_medium=SL&utm_campaign=SL)\n[8898f499f334a3231695b8a60dfdfb289836da1de7a4e4e334df83a748c11e07](https://opentip.kaspersky.com/8898f499f334a3231695b8a60dfdfb289836da1de7a4e4e334df83a748c11e07/?utm_source=SL&utm_medium=SL&utm_campaign=SL)\n[d511e44ee6ae06228170aef1bef567e059596d259e205295b99e85de8c966354](https://opentip.kaspersky.com/d511e44ee6ae06228170aef1bef567e059596d259e205295b99e85de8c966354/?utm_source=SL&utm_medium=SL&utm_campaign=SL)\n\n**Domains**\n\npost.convstats[.]com\n\nupdate.convstats[.]com\n\ntrk.convstats[.]com\n\n[Adware](https://securelist.com/tag/adware/)\n[Apple MacOS](https://securelist.com/tag/apple-macos/)\n[Malware Descriptions](https://securelist.com/tag/malware-descriptions/)\n[Malware Technologies](https://securelist.com/tag/malware-technologies/)\n\nAuthors\n\nIlya Mogilin\n\nMikhail Kuzin\n\nConvuster: macOS adware now in Rust\n\nYour email address will not be published. Required fields are marked *\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-03-18 - Convuster- macOS adware now in Rust.pdf"
    ],
    "report_names": [
        "2021-03-18 - Convuster- macOS adware now in Rust.pdf"
    ],
    "threat_actors": [
        {
            "id": "b5b24083-7ba6-44cc-9d11-a6274e2eee00",
            "created_at": "2022-10-25T16:07:24.337332Z",
            "updated_at": "2025-03-27T02:02:10.177597Z",
            "deleted_at": null,
            "main_name": "Tortoiseshell",
            "aliases": [
                "Crimson Sandstorm",
                "Curium",
                "Houseblend",
                "Imperial Kitten",
                "Marcella Flores",
                "Operation Fata Morgana",
                "TA456",
                "Yellow Liderc"
            ],
            "source_name": "ETDA:Tortoiseshell",
            "tools": [
                "IMAPLoader",
                "Infostealer",
                "IvizTech",
                "LEMPO",
                "MANGOPUNCH",
                "SysKit",
                "get-logon-history.ps1",
                "liderc",
                "stereoversioncontrol"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673536239,
    "ts_updated_at": 1743041118,
    "ts_creation_date": 1653754293,
    "ts_modification_date": 1653754293,
    "files": {
        "pdf": "https://archive.orkl.eu/4fc4cb48b27615f8fcb04b10211b9aface4c98bf.pdf",
        "text": "https://archive.orkl.eu/4fc4cb48b27615f8fcb04b10211b9aface4c98bf.txt",
        "img": "https://archive.orkl.eu/4fc4cb48b27615f8fcb04b10211b9aface4c98bf.jpg"
    }
}