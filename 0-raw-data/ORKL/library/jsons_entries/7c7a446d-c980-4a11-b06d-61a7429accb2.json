{
    "id": "7c7a446d-c980-4a11-b06d-61a7429accb2",
    "created_at": "2023-01-12T15:01:09.435924Z",
    "updated_at": "2025-03-27T02:09:18.188583Z",
    "deleted_at": null,
    "sha1_hash": "ab751e047b54ea48ef69f68495fc8ab6310d10f8",
    "title": "2022-02-28 - CoinMiner Being Distributed to Vulnerable MS-SQL Servers",
    "authors": "",
    "file_creation_date": "2022-05-28T23:22:11Z",
    "file_modification_date": "2022-05-28T23:22:11Z",
    "file_size": 2387722,
    "plain_text": "# CoinMiner Being Distributed to Vulnerable MS-SQL Servers\n\n**asec.ahnlab.com/en/32143/**\n\nFebruary 28, 2022\n\nThe ASEC analysis team is constantly monitoring malware distributed to vulnerable MS-SQL\nservers. The previous blogs explained the distribution cases of Cobalt Strike and Remcos\nRAT, but the majority of the discovered attacks are CoinMiners.\n\n**– [ASEC Blog]** **[Remcos RAT Being Distributed to Vulnerable MS-SQL Servers](https://asec.ahnlab.com/ko/31461/)**\n\n**– [ASEC Blog]** **[Cobalt Strike Being Distributed to Vulnerable MS-SQL Servers](https://asec.ahnlab.com/en/31811/)**\n\n**– [ASEC Blog]** **[Cobalt Strike Being Distributed to Vulnerable MS-SQL Servers (2)](https://asec.ahnlab.com/en/32062/)**\n\nThis blog will explain a specific form of CoinMiner that has been consistently distributed\nsince last year up until now, which also makes up the majority of attacks. According to\nAhnLab’s ASD infrastructure, in systems installed with this specific CoinMiner, detection logs\nof Vollgar CoinMiner are also being found. Vollgar is a typical CoinMiner that is installed via\nbrute force attacks against MS-SQL servers with vulnerable account credentials, and it\nappears that the CoinMiner of focus will also use the same method.\n\n\n-----\n\n**Figure 1. Attack flow**\nThe precise attack method and the command that was used cannot be confirmed, but\naccording to the collected logs of file creation and execution, the attacker first created a\nsqlbase folder in MS-SQL data folder (E.g. %ProgramFiles%\\microsoft sql\nserver\\mssql13.mssqlserver\\mssql\\data) and created a malware named SqlBase.exe in the\npath. The malware is then created and executed in the path by the sqlservr.exe, which is a\nMS-SQL server process.\n\nSqlBase.exe is a downloader malware of a simple form developed with .NET (See figure\nbelow), which downloads settings data and CoinMiner from C&C server and installs them.\n\n\n-----\n\n**Figure**\n\n**2. Main routine of SqlBase.exe**\nThe settings data is downloaded from the URL below, but as it is encrypted with Base64 and\nAES, it needs to be decrypted.\n\n**Settings data download URL: hxxp://dl.love-network[.]cc/config.txt**\n\n**Figure 3. Data encrypted with Base64 and AES and its decryption routine**\n\n\n-----\n\nThe decrypted data is in XML format and contains the version information and the argument\nthat will be used when executing XMRig CoinMiner.\n\nFigure 4. Decrypted settings data\nIt then downloads XMRig malware packed with VMP in the following URL. The data.mdf file\nis a compressed file in the zip format, and it contains XMRig CoinMiner. Sqlbase.exe\ndecompresses XMRig in the same path under the name of sqlconn.exe.\n\n**XMRig download URL: hxxp://dl.love-network[.]cc/data.mdf**\n\n**Figure 5. Settings data used by the downloader**\nThe compressed data.mdf file disguised by the attacker has the mdf extension, which is a\nprimary data file used in MS-SQL. Upon looking at the actual MS-SQL data folder\n%ProgramFiles%\\microsoft sql server\\mssql13.mssqlserver\\mssql\\data\\, numerous MS-SQL\nrelated data files such as mdf files and ldf (log file) can be seen.\n\n**Figure 6. Data files in the data**\n\n**folder**\nWhen all the processes above are over, it assigns hidden and system properties to the\nXMRig file and executes XMRig along with the user account credentials and URL of the\nargument of the settings data obtained above (a.k.a the mining pool) to perform mining in the\ninfected system.\n\n\n-----\n\n**Figure 7. Coin mining packet**\nTypical attacks that target MS-SQL servers include brute force attacks and dictionary attacks\nto systems where account credentials are poorly being managed. Although it seems like\nthese methods make up the majority of the attacks, there can be vulnerability attacks against\nsystems where their vulnerability has not been patched.\n\nBecause of this, administrators should use passwords that are difficult to guess for their\naccounts and change them periodically to protect the database server from brute force\nattacks and dictionary attacks, and maintain the latest patch to prevent vulnerability attacks.\nAdministrators should also use security programs such as firewalls for database servers\naccessible from outside to restrict access of external attackers.\n\nThe following are paths where the SqlBase.exe file, the initial malware installed by the\nattacker was created in. These show the MS-SQL systems that were targeted for attack.\n\n%ProgramFiles%\\microsoft sql\nserver\\mssql13.mssqlserver\\mssql\\data\\sqlbase\\sqlbase.exe\n\n%ProgramFiles%\\microsoft sql server\\mssql12.sqlexpress\\mssql\\data\\sqlbase\\sqlbase.exe\n\n%ProgramFiles%\\microsoft sql server\\mssql10_50.d*****20\\mssql\\data\\sqlbase\\sqlbase.exe\n\n%ProgramFiles%\\microsoft sql\nserver\\mssql10_50.d*****016\\mssql\\data\\sqlbase\\sqlbase.exe\n\n%ProgramFiles%\\microsoft sql server\\mssql10_50.i***e\\mssql\\data\\sqlbase\\sqlbase.exe\n\n%ProgramFiles%\\microsoft sql server\\mssql10_50.i*****20\\mssql\\data\\sqlbase\\sqlbase.exe\n\n%ProgramFiles%\\microsoft sql server\\mssql14.d*****e\\mssql\\data\\sqlbase\\sqlbase.exe\n\n%ProgramFiles% (x86)\\microsoft sql server\\mssql10_50.o—\n**em\\mssql\\data\\sqlbase\\sqlbase.exe**\n\nMS-SQL is sometimes manually downloaded for a certain purpose, but it can also be\ninstalled by other programs that need a database management system. Upon looking at the\nlogs above, it appears that other than the paths of normal MS-SQL servers, MS-SQL servers\n\n\n-----\n\nthat have been installed by ERP and work-purpose solutions were targeted for attack as well.\n\nAs MS-SQL installed by other work-purpose programs can be attacked as well as manuallyinstalled MS-SQL, users must pay attention to vulnerability patching and account\nmanagement.\n\nAhnLab detects and blocks the malware above using the aliases below.\n\n**[File Detection]**\n– CoinMiner/Win.Agent.C4420300 (2021.04.24.00)\n– CoinMiner/Win.LoveMiner.R472804 (2022.02.16.01)\n– CoinMiner/Win.XMRig.R424798 (2021.08.07.00)\n\n**[IOC]**\n**MD5**\n– SqlBase.exe : fe3659119e683e1aa07b2346c1f215af\n– sqlconn.exe : b11d7ac5740401541bc1be33dd475e00\n\n**XMRig Mining Pool**\n– serv1.love-network[.]cc:2082\n\n**Download**\n– hxxp://dl.love-network[.]cc/config.txt\n– hxxp://dl.love-network[.]cc/data.mdf\n\n[Categories:Malware Information](https://asec.ahnlab.com/en/category/malware-information/)\n\n[Tagged as:BruteForcing,](https://asec.ahnlab.com/tag/bruteforcing/) [CoinMiner,](https://asec.ahnlab.com/en/tag/coinminer-en/) [LoveMiner,](https://asec.ahnlab.com/tag/loveminer/) [MS-SQL,](https://asec.ahnlab.com/tag/ms-sql/) [MSSQL,](https://asec.ahnlab.com/tag/mssql/) [XMRig](https://asec.ahnlab.com/tag/xmrig/)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-02-28 - CoinMiner Being Distributed to Vulnerable MS-SQL Servers.pdf"
    ],
    "report_names": [
        "2022-02-28 - CoinMiner Being Distributed to Vulnerable MS-SQL Servers.pdf"
    ],
    "threat_actors": [
        {
            "id": "610a7295-3139-4f34-8cec-b3da40add480",
            "created_at": "2023-01-06T13:46:38.608142Z",
            "updated_at": "2025-03-27T02:00:02.87217Z",
            "deleted_at": null,
            "main_name": "Cobalt",
            "aliases": [
                "Cobalt Gang",
                "GOLD KINGSWOOD",
                "COBALT SPIDER",
                "G0080",
                "Mule Libra",
                "Cobalt Group"
            ],
            "source_name": "MISPGALAXY:Cobalt",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673535669,
    "ts_updated_at": 1743041358,
    "ts_creation_date": 1653780131,
    "ts_modification_date": 1653780131,
    "files": {
        "pdf": "https://archive.orkl.eu/ab751e047b54ea48ef69f68495fc8ab6310d10f8.pdf",
        "text": "https://archive.orkl.eu/ab751e047b54ea48ef69f68495fc8ab6310d10f8.txt",
        "img": "https://archive.orkl.eu/ab751e047b54ea48ef69f68495fc8ab6310d10f8.jpg"
    }
}