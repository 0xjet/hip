{
    "id": "1d145108-893a-4271-b397-616123a7f1e1",
    "created_at": "2022-10-25T16:48:11.681424Z",
    "updated_at": "2025-03-27T02:16:53.072391Z",
    "deleted_at": null,
    "sha1_hash": "37fb4bfd4dd3010f5f23e7af93412e06dbfd02c6",
    "title": "",
    "authors": "",
    "file_creation_date": "2018-11-07T09:05:50Z",
    "file_modification_date": "2018-11-07T09:06:04Z",
    "file_size": 10565724,
    "plain_text": "# Inside Magecart:\n\n#### Profiling the Groups Behind the Front Page Credit Card Breaches and the Criminal Underworld that Harbors Them\n\n###### Authors:\n\n Yonathan Klijnsma, RiskIQ Vitali Kremez, Flashpoint Jordan Herman, RiskIQ\n\n\n-----\n\n##### Executive Summary\n\nMagecart is an umbrella term given to at least seven cybercriminal groups that are placing digital credit\ncard skimmers on compromised e-commerce sites at an unprecedented rate and with frightening success.\nIn a few short months, Magecart has gone from relative obscurity to dominating national headlines and\nascending to the top of the e-commerce industry's public enemy list.\n\nResponsible for recent high-profile breaches of global brands Ticketmaster, British Airways, and Newegg,\nin which its operatives intercepted thousands of consumer credit card records, Magecart is only now\nbecoming a household name. However, its activity isn't new and points to a complex and thriving criminal\nunderworld that has operated in the shadows for years.\n\nIn this RiskIQ and Flashpoint joint report, we'll build a timeline of the Magecart phenomenon from the\ninception of digital credit-card skimming—its evolution from a Cart32 shopping cart software backdoor to\nMagecart's current all-out assault on e-commerce that compromises thousands of sites both directly and\nvia breaches of third-party suppliers.\n\nWe'll also profile the six leading Magecart groups along with notable related unclassified threat groups,\nhighlighting their skimmers, tactics, targets, and what makes them unique:\n\n- **Group 1 & 2 - Casts a wide net for targeting, likely using automated tools to breach and skim sites.**\nMonetizes with a sophisticated reshipping scheme.\n\n- **Group 3 - Goes for a high volume of targets to go for as many victims as possible, but is unique in the**\nway its skimmer works.\n\n- **Group 4 - Extremely advanced, this group blends in with its victims' sites to hide in plain sight and**\nemploys methods to avoid detection.\n\n- **Group 5 - Implicated in the breach of Ticketmaster, this group hacks third-party suppliers to breach as**\nmany targets as it can.\n\n- **Group 6 - Extremely selective, only going for top-tier targets, such as British Airways and Newegg to**\nsecure a high-volume of traffic and transactions.\n\nFrom there, Flashpoint will delve into the commercial side of Magecart operations—the sale and\ndistribution of stolen cards on underground shops, the monetization of Magecart operations through\nmule-handling and shipping goods, and the dynamics of an underground supply chain offering operatives\nskimmer kits and compromised e-commerce sites as a service.\n\n\n-----\n\n##### Table of Contents\n\nExecutive Summary............................................................................................................................................................................................................2\nTable of Contents................................................................................................................................................................................................................3\nForeword...............................................................................................................................................................................................................................4\nIntroduction.........................................................................................................................................................................................................................5\nOrigins ......................................................................................................................................................................................................................................................................5\nGoing Where the Money Is............................................................................................................................................................................................................................... 6\nThreat Groups......................................................................................................................................................................................................................7\nA word of caution...................................................................................................................................................................................................................................................7\nGroup 1 ......................................................................................................................................................................................................................................................................8\n\n  - Modus Operandi.............................................................................................................................................................................................................................................8\n\n  - The Skimmer.....................................................................................................................................................................................................................................................8\n\n  - Victims................................................................................................................................................................................................................................................................ 9\n\n  - Profit.................................................................................................................................................................................................................................................................... 9\nGroup 2 ....................................................................................................................................................................................................................................................................10\nGroup 3 ..................................................................................................................................................................................................................................................................... 11\n\n  - Modus Operandi............................................................................................................................................................................................................................................ 11\n\n  - The Skimmer.................................................................................................................................................................................................................................................... 11\nGroup 4 ....................................................................................................................................................................................................................................................................13\n\n  - Modus Operandi...........................................................................................................................................................................................................................................13\n\n  - The Skimmer...................................................................................................................................................................................................................................................13\n\n  - Anti-Analysis, Fingerprinting and a Link to the Past.................................................................................................................................................................. 17\nGroup 5 ....................................................................................................................................................................................................................................................................19\n\n  - Modus Operandi...........................................................................................................................................................................................................................................19\n\n  - The Skimmer...................................................................................................................................................................................................................................................19\n\n  - Victims............................................................................................................................................................................................................................................................... 21\n\n     - Conversions On Demand..............................................................................................................................................................................................................22\n\n     - Annex Cloud........................................................................................................................................................................................................................................24\n\n     - SAS Net Reviews...............................................................................................................................................................................................................................25\n\n     - flashtalking...........................................................................................................................................................................................................................................26\n\n     - SociaPlus...............................................................................................................................................................................................................................................26\n\n     - Inbenta...................................................................................................................................................................................................................................................27\n\n     - PushAssist............................................................................................................................................................................................................................................27\n\n     - Clarity Connect..................................................................................................................................................................................................................................28\n\n     - ShopBack..............................................................................................................................................................................................................................................28\n\n     - CompanyBe.........................................................................................................................................................................................................................................29\n\n     - Feedify....................................................................................................................................................................................................................................................29\n\n     - Shopper Approved...........................................................................................................................................................................................................................30\nGroup 6 ...................................................................................................................................................................................................................................................................32\n\n  - Modus Operandi..........................................................................................................................................................................................................................................32\n\n  - The Skimmer..................................................................................................................................................................................................................................................32\n\n  - Victims..............................................................................................................................................................................................................................................................33\n\n  - Profit..................................................................................................................................................................................................................................................................33\nGroup 7 ...................................................................................................................................................................................................................................................................35\n\n  - Modus Operandi..........................................................................................................................................................................................................................................35\n\n  - The Skimmer..................................................................................................................................................................................................................................................35\nRelated Unclassified Threat Groups.............................................................................................................................................................................37\n\n  - Brand Impersonation.................................................................................................................................................................................................................................37\nUnderground Supply Chain & Skimmer Kits.............................................................................................................................................................. 41\nSales of Stolen Credit Cards on Underground Shops............................................................................................................................................. 50\nDrop Projects: Effective Method of Mule-Handling and Shipping Goods from Credit Card Shops.............................................................52\nDisruption of Magecart Activities.................................................................................................................................................................................53\n\n  - A Global Effort: We Need to Work Together.................................................................................................................................................................................54\nConclusions....................................................................................................................................................................................................................... 55\nThank you.......................................................................................................................................................................................................................... 56\n\n  - Darren Spruell & William MacArthur..................................................................................................................................................................................................56\n\n  - AbuseCH & Shadowserver......................................................................................................................................................................................................................56\n\n  - Anonymous....................................................................................................................................................................................................................................................56\nIndicators of Compromise (IOCs).................................................................................................................................................................................57\n\n  - IOCs associated with Group 1 (and 2)...............................................................................................................................................................................................57\n\n  - IOCs associated with Group 3..............................................................................................................................................................................................................57\n\n  - IOCs associated with Group 4..............................................................................................................................................................................................................57\n\n  - IOCs associated with Group 5..............................................................................................................................................................................................................57\n\n  - IOCs associated with Group 6..............................................................................................................................................................................................................57\n\n  - IOCs associated with Group 7...............................................................................................................................................................................................................58\n\n  - IOCs associated with Brand Impersonation Card Skimmer...................................................................................................................................................58\n\n\n-----\n\n##### Foreword\n\nBefore starting this report we would like to explain a few things which should clear up some elements that\nmight seem confusing to readers:\n\n- We documented six groups in this report, with the last group designated as Group 7. Group 1 and Group\n2 have been collapsed into the same group which is explained in the Group 2 section of this report.\n\n- When we note the victims in the header section of each group, we are referring to the number of stores\nthe skimmer has reached according to our data. We do not count the consumers whose payment\ninformation was skimmed because that number is impossible to accurately quantify.\n\n- In certain campaigns, not every site hit with a skimmer has payment information stolen. If the skimmer\ndoes not end up on the payment page, as is the case in many Group 5 campaigns, payment information\nwill not be intercepted.\n\n- Flashpoint has purposely not identified identities of sellers or group operators in this report as it relates\nto the active criminal investigation. The information provided is contextual and meant to illuminate a\nmore vivid picture of Magecart group and their operations.\n\n- We continue to work and share relevant victim information with impacted organization and law\nenforcement to ensure proper notification and aid active criminal investigation. We will not identify\nvictims unless we have contacted them before publishing this report, or the victims have already made a\npublic announcement of their breach.\n\n- Throughout our journey tracking and identifying these groups and the threat they pose, Flashpoint\nand RiskIQ have actively worked to prevent and mitigate the threats. However, given the sheer scale of\nvictims affected by Magecart, it’s not possible to reach out to all of them. For that reason, we focused\non taking on Magecart at its source by taking down its infrastructure with the help of AbuseCH and\nShadowServer.\n\n- Any organization that suspects they've been affected by Magecart can reach out to RiskIQ at any time—\nwe're happy to provide free data, information, and guidance to help combat this growing threat.\n\n*The information provided herein is for general information and informational purposes only. It is not intended and should not be\nconstrued to constitute legal or any other professional advice. RiskIQ, Flashpoint, and the authors (collectively, the “Authors”) reserve\nthe right to modify the contents of this document at any time without prior notice.\n\nAlthough the Authors have used reasonable efforts to include accurate and up-to-date information herein, none of the Authors make\nany warranties or representations of any kind as to its accuracy, currency, or completeness. You expressly agree that access to and\nuse of and reliance on this document and the content thereof is at your own risk. To the full extent permissible by applicable law,\nthe Authors disclaim all warranties of any kind, express or implied. None of the Authors shall be liable for any consequence, loss,\nor damage, including direct, indirect, special, consequential, loss of business profits, or special damages, whatsoever arising out of\naccess to, use of, or inability to use, or in connection with the use of this document, or any errors or omissions in the content thereof.\nUse of this information constitutes acceptance for use in an “as is” condition.\n\nAs a convenience to you, some of the pages contain links to websites not maintained by the Authors. The linked sites are not under\nthe control of, and the Authors are not responsible for, the contents of any website to which it is linked. The inclusion of any link does\nt i l d t l hi b f th A th th li k d it f th\n\n\n-----\n\n##### Introduction\n\nThe name Magecart has become well known as of late. Recent high-profile compromises have brought the\nthreat of online card skimming to the forefront of security conversations and news publications. There are\nmany reasons for this. First, there are fortunes to be made via card data theft. Secondly, compromising\nvendors or third-party suppliers that are unable to defend themselves or detect the compromise is often a\ntrivial task. Thirdly, there has been little threat of consequence to those behind these compromises.\n\nIn short, the rewards are too great, the hurdles too low, and the consequences largely non-existent for\nthis threat to go away any time soon. Thus, the scope of online card skimming and the number of victims\nclaimed by Magecart continues to increase even as we learn more about them and our picture of their past\nactivities and the breadth of victims becomes clearer. However, it’s important to note that card data theft\nfrom online vendors did not begin with Magecart—it’s been going on for a long time.\n\n###### Origins\n\nIn April 2000, it was revealed that a backdoor in the Cart32 shopping cart software had existed for more\nthan a year, exposing the credit card information of thousands of customers of many small and medium\ne-commerce vendors who used the software to manage payments for their online stores.[1] This early case of\nthird-party shopping cart software exposing online shoppers’ credit card information foretold a trend that\nwould increase during the next 18 years.\n\nChatter on osCommerce community forums in 2007 pointed to increasing and persistent attacks on,\nand compromises of, shopping cart software via different vulnerabilities and techniques.[2] Analysis from\nTrend Micro in 2011 revealed that mass compromises of osCommerce implementations were used to inject\niframes into legitimate vendor pages which then pushed users to downloads of data-stealing malware.[3] In\nDecember 2013, attackers targeted and compromised Magento PHP scripts for the first time. The modified\nscripts pulled personal and card data from checkout forms and dumped it to drop servers such as javae-shop[.]com.[4] This activity continued through 2015 and evolved with some simple obfuscation and data\nexfiltration via email.[5] Another skimmer, called Visbot, also emerged at this time. It limited its targets to\nthose running Visvo implementations, and bundled stolen data into fake image files stored on the server for\nthe attacker to retrieve later.[6]\n\nThe Magecart threat grew out of a single group’s activities in 2015 when it began compromising vendor\nwebsites and injecting skimmers. Several thousand stores were affected during that time. RiskIQ became\naware of the threat and began tracking it in 2015. A new group emerged in 2016 with a skimmer and\ninfrastructure distinct from the first group. The evolution of skimmers and the multiplication of groups\ncontinues to this day. Some of these groups cast wide nets and hit as many vendors as possible. Some\ncarefully conceal their skimmer. Some target third parties to gain access to the thousands of vendors\nthey serve. Some limit their victims to a few high-value organizations and use specially tailored skimmers,\ndomains, and attacks against them. The threat actors continue to grow, evolve, and learn.\n\n1.  https://www.wired.com/2000/04/backdoor-exposes-credit-cards/\n2 https://forums.oscommerce.com/topic/283542-successful-hack-attacks/\n3. https://www.trendmicro.com/vinfo/us/threat-encyclopedia/web-attack/100/oscommerce-mass-compromise-leads-to-datastealing-malware-infections\n4. https://www.atwix.com/magento/credit-card-numbers-leak/\n5. https://blog.sucuri.net/2015/04/impacts-of-a-hack-on-a-magento-ecommerce-website.html,\n\n\n-----\n\n###### Going Where the Money Is\n\nThe advent of online purchasing altered the global economy, shifting spending away from brick-and-mortar\nestablishments to digital storefronts. Massive online spending gave rise to shopping behemoths such as\nAmazon and Alibaba, as well as multitudes of small- and medium-sized shops. It also created a space for a\nnew hidden economy to grow around the theft and sale of credit card data.\n\nAs with other business supply chains, we see specialization in the criminal cyber community. Software\ndevelopers create kits for stealing card data from compromised stores but take no part in the actual\ncompromise. They earn money by either selling their kits or entering into profit-sharing agreements with\ngroups or individuals who compromise organizations and then use their kit to inject the skimmer and steal\ncard data. Criminals may compromise stores through their own means or they may simply purchase access\nto compromised vendor sites through illicit stores on the dark web where such access is sold. The price for\neach compromised vendor site is set according to its value as determined by those running the illicit stores.\n\nOnce the card data is stolen it must be monetized. There are further illicit stores that specialize in the\nsale of stolen card data. Presumably, the parties that buy the cards use them to make purchases. Criminal\ngroups may also cut out the middleman and instead recruit unwitting persons to receive goods purchased\nwith stolen card data and re-ship them overseas to the criminal group, who then sell the goods in their\nhome countries.\n\nThis economy is currently supporting multiple groups and individuals that have moved to capitalize on the\nopportunity presented by card theft in the era of online shopping.\n\n\n-----\n\n##### Threat Groups\n\nWhile Magecart is the umbrella name we use to describe multiple criminal groups that perform skimming\nattacks to obtain payment information, we actively track each individual group performing these attacks.\nWe define these groups based on a number of different factors and pick one or more that clearly\ndifferentiates a group for us. The following is a list of criteria we use for this classification:\n\n1. Infrastructure is unique:\na. There is a unique pool of IP addresses\nb. There is a unique pool of domains\nc. There is a specific server setup fingerprint\n\n2. Skimmer is unique:\na. A unique obfuscation technique is used\nb. The skimmer is unique in its functioning or approach to getting data\nc. The skimmer is loaded in a unique way\n\n3. Targeting is unique:\na. Their pool of targets has a unique presence/fingerprint\nb. The way they gain access to their targets is unique\nc. The way they place the skimmer on their victim’s site is unique\nd. The method they use to reach their victims is differentiated\n\n###### A Word of Caution\n\nWhile we have well-defined groups in the report, this list is not definitive or complete. We break down the\nfirst six groups of the set we track, but there are many more groups and individuals taking part in Magecart\nweb skimming. This report is meant to provide insight into the tactics of some of the criminal groups in this\nspace and the scale at which they operate.\n\nSome of the groups we cover in this report began web skimming because they saw that others were\nsuccessful at it, and bought or built their kits to get in on the action. Currently, these groups compete with\none another in a space that's getting more crowded by the day.\n\nWe provide victim counts with each group that represent what we have observed in our crawl data but\ncan be lower than the actual victim count. The reason for this is that we don’t crawl every website on the\ninternet; we try to but we don’t see everything. This means that at times we will not find obscure webshops\nalso affected.\n\n8. https://gwillem.gitlab.io/2015/11/17/widespread-credit-card-hijacking-discovered/\n\n\n-----\n\nVictims:\n### 2,500+\n\n\n## Group 1\n\n###### Modus Operandi\n\n\nFirst Seen:\n### 2015\n\n\nThe first Magecart group emerged in 2015, with data on its activities beginning in April or early May as\nreported by Willem de Groot.[7] However, it may have been active as early as 2014 based on the creation of\ndomains it used as part of a reshipping scheme. In this scheme, the group fooled job seekers in the U.S.\ninto shipping items purchased with stolen credit cards to Eastern Europe where the goods were sold.\n\nRiskIQ began tracking the Magecart threat in November 2015 and flagged a domain hosting an early\nskimmer incarnation as the earliest incident. The domain identified by RiskIQ shared infrastructure with\nthe domains used in the re-shipping monetization scheme. Because of this, we were able to use passive\nDNS data inside RiskIQ Community Edition to see the infrastructure connections between the domains and\ndiscover the extent of the fraudulent reshipping scheme.[8] This connection also allowed us to determine\nthat two of the Magecart groups we had identified were actually a single group.\n\nDuring 2016, Group 1’s operations and infrastructure evolved to the point where, in late 2016, some of its\nactivities began taking the form of Magecart Group 2. Finally, the creation of the uslogisticexpress.com\ndomain in December 2015 and the use of it in conjunction with its 2016 activities allowed us to determine\ndefinitively that the two groups were one.\n\nGroup 1 cast a wide net with its skimmer, most likely using automated tools to attack and compromise sites\nand then upload the skimmer code. Several thousand sites were compromised during this early campaign.\n\n###### The Skimmer\n\nThe original Magecart skimmer was comprised of javascript embedded into e-commerce pages. Whenever\ncard data was entered into a form, the skimmer copied the form and sent the stolen card data to a drop\nserver. In this skimmer version, the drop server was the same as the one serving the skimmer. Though it has\nevolved over the years, tailored by other groups to better fit their needs, the basic elements of the skimmer\nare still in use.\n\n\n-----\n\nThe skimmer contains the following elements:\n\n1. A timeout function is set to 5000. After the timeout period has elapsed, the skimmer will restart its\nfunctionality and run through the script again.\n\n2. The skimmer checks to see if it is on a payments page and inspects specific payment form fields to\ndetermine if data has been entered.\n\n3. If payment data has been entered into the form, it is extracted.\n\n4. The skimmed data is sent to the drop server at js-save.link via a POST request. In this case, the drop\nserver is the same as that serving the skimmer script to the compromised website.\n\n###### Victims\n\nAs stated earlier, Group 1 compromised several thousand stores. Some of the more prominent ones\nincluded the National Republican Senate Committee, Guess (Australia), and Everlast. It is unlikely that any\nof the victims were specifically targeted, but were instead swept up by the group’s automated attack and\ncompromise setup.\n\n###### Profit\n\nIn July of that year, Magecart Group 1 created useaglelogistics.com, a website purporting to be a\nlegitimate shipping company, as part of its scheme for monetizing stolen credit card data.\n\nThis reshipping scheme used false job postings to recruit unwitting persons in the United States to receive\nelectronics or other goods purchased with stolen card data. These mules then re-shipped the goods to\nEastern Europe where the criminal group sold them for profit. The domain uslogisticexpress.com was\nlater registered for the same purpose.\n\n\n-----\n\n## Group 2\n\nWe merged Group 2 with Group 1 after we found a link in the way the group made it profits. The reshipping\ncompany for Group 1 was the same as the one for Group 2 but relabelled after the name it used for their\nphony business, US Eagle Logistic, was discovered by a legitimate reshipping company by the same name.\nAfter the legitimate company became aware of the abuse of its brand, it posted the following notice on\ntheir website:\n\nAfter dropping this name and domain, the group switched the name to US Logistic Express and simply\nswapped out the name and logo from the old US Eagle Express website. The new reshipping company\nwebsite looked like this:\n\n\n-----\n\nVictims:\n### 800+\n\n\n## Group 3\n\n###### Modus Operandi\n\n\nFirst Seen:\n### 2016\n\n\nGroup 3 operates similarly to some of the other groups in that it goes for high volumes of compromises\nto grab as many cards as possible. However, they do not target high-end web stores. The group is\ndifferentiated in the way its skimmer works which, along with its unique infrastructure, is the reason we\ndesignate it as a separate group.\n\n###### The Skimmer\n\nGroup 3’s skimmer takes a different approach to skimming compared to other Magecart skimmers. Instead\nof checking if the skimmer is running on a checkout page by evaluating the URL location of the page,\nGroup 3’s skimmer checks if any of the forms on that page hold payment information. To do this, the group\nhas defined what the fields in certain payment forms look like. In the skimmer, it looks like this:\n\nThe list contains a set of field IDs per item which map to a certain payment form. What is interesting about\nthis approach is that while it has some generic input field names such as cardNumber, it also has specific\nfilters for known payment-processing companies. This allows the skimmer to be website agnostic and\nidentify any payment field the skimmer encounters.\n\n\n-----\n\nTo give an idea of its scope, this is a list of payment vendors whose payment forms are currently supported\nby Group 3’s skimming abilities. Many of these vendors are active in Latin America, possibly indicating a\nfocus in that region:\n\n- Adyen\n\n- Stripe\n\n- eWay\n\n- Braintree\n\n- Heidel Pay\n\n- Fat Zebra\n\n- Radweb\n\n- Pagar.me\n\n- Cryozonic\n\n- Authorize Net\n\n- Paymetric\n\n- Moip Pagementos\n\n- EBANX\n\n- Cielo\n\nThe skimmer executes every 700 milliseconds and goes through three steps of data collection. Any\nof these steps can be enabled or disabled by global flags at the top of the skimmer. These individual\nskimming steps are:\n\n1. Check if there is a generic form that contains billing in its name. If so, it will extract the billing\ninformation from that form and store it in the local storage of the browser under the key __billing123.\n\n2. Check if there is a generic form that contains shipping in its name. If so, it will extract the\nshipping information from that form and store it in the local storage of the browser under the key\n__shipping123.\n\n3. Check if any form matches any of the payment form field names in the list discussed above. If there is a\nmatch the information is extracted.\n\nGroup 3 performs these three steps to ensure it has the name and address for the person paying, which\nmay be entered in a different step and on a different page than the one in which payment details are\nentered. By putting the data in local storage, the Magecart operators can confirm that they have all the\ndata they need before sending it off. Even if all the information is entered on the same page, this method\nwould work. Group 3 is the only group we've seen taking these steps.\n\nThe final step is exfiltrating the skimmed data. The data from all three steps is concatenated into one large\nJSON object. This data is then sent to the drop server in a POST request, with the body of the request\ncontaining the stolen data formatted as JSON.\n\n\n-----\n\nVictimized webshops:\n### 3000+\n\n\n## Group 4\n\n###### Modus Operandi\n\n\nFirst Seen:\n### 2017\n\n\nGroup 4 is advanced. Once the group has access, it is extremely careful about how it places the skimmer.\nThis group focuses on high volumes of compromises with the goal of getting as many cards as possible\nwithout specific targeting. However, it doesn’t shy away from targeting altogether.\n\nGroup 4 tries to blend in with normal web traffic, so it registers domains mimicking ad providers, analytics\nproviders, victim’s domains, and anything else that can be used to hide in plain sight. The group will change\nhow its skimmer appears and will also change what the URLs look like. As a way to blend in with network\ntraffic, Group 4 changes the file paths to image file extensions instead of normal javascript extensions. Here\nis an example where the skimmer is loaded as an image:\n\nThis group has more tricks up its sleeve to check for attempted analysis of its skimmers, which we’ll detail\nlater in this section.\n\nWe strongly believe this group originates from another crime business involved in malware distribution\nand hijacking of banking sessions using web injects. The skimmer and method of operation have a strong\nsimilarity to how banking malware groups operate. We will break down our conclusions and thoughts\nabout this in the sections below\n\n###### The Skimmer\n\nThe way Group 4 uses its skimmer is different from other Magecart groups. The skimmer isn’t shown to just\nanyone—you can’t request it without knowing a victim and having a valid user-agent at the bare minimum.\nHowever, there’s more to it.\n\nSending a request to one of the Group 4 servers with an invalid user-agent or without the request coming\nfrom a victimized store as a referrer will present you with a 403 forbidden page from the injection server:\n\n\n-----\n\nIf you request the skimmer with a valid referrer from one of the webshops victimized by this group but are\nnot on the checkout page, you are served a benign piece of JavaScript. The returned JavaScript is often an\nobscure jQuery Mask module (although we have seen other code used) that doesn’t affect the webshop’s\nnormal functionality.\n\nHere is one example screenshot of the resource being served when visiting a victimized webshop:\n\n\n-----\n\nThe benign script is key to Group 4 s operation: hiding and avoiding detection. If a shopper hits the\ncheckout page on a web store that was injected with its skimmer host, they will see something like this:\n\nThe top part of the script, which can be tens of thousands of lines, is benign and is a combination of\nvarious legitimate scripts. At the end of these padding scripts is the skimmer. However, sometimes this\npadding isn’t done, and just the skimmer is served.\n\nFor Group 4, this skimmer is expansive—fewer than 1,500 lines after cleaning up the obfuscation layer.\nWe will discuss important parts of the skimmer, but analyzing the whole thing would be enough for a\nseparate report.\n\n\n-----\n\nIn essence, the skimmer for Group 4 overlays the payment form and manually validates all the payment\ninformation input, which is the main reason the skimmer is so big. Let’s start at the top. The skimmer\nstarts by establishing some basic information it will need including where to send the skimmed payment\ninformation.\n\nWe’ve substituted and renamed some variables in the skimmer because the real names the authors gave\nthe variables were no longer in place due to obfuscation. In the header section, the skimmer builds the\npath along which the payment data is sent. The URL is constructed as follows:\n\n1. Grab the schema used on the web store—if the victimized web store uses HTTPS, the skimmer drop. If\nthe web store does not use HTTPS, neither will the drop URL.\n\n2. Select one random drop server out of a list of servers.\n\n3. Get the victim’s checkout path on the webstore, remove the webstore hostname and append /\nsaveOrder to it\n\n4. Construct the URL by appending the schema, drop server hostname, and drop path constructed\npreviously.\n\nGroup 4’s method of setting up the drop server is also all about blending in. When the data is sent to the\ndrop server, this URL will have one more text string appended to it. This string is the form key, a randomized\ntext string that is directly appended behind the saveOrder text, which makes it somewhat unique.\n\nTo hook up and initialize the skimmer so it can skim data once a user submits a form, Group 4 uses a\ndifferent set of methods. It can go as far as to re-initialize the skimmer in case something changes in the\nbody of the page to make sure it can overlay the payment form properly (which could be affected by a\nchange in the page content). Here is the initialization of the skimmer:\n\nThe first part of the setup_skimmer function performs a check we’ve seen with many other Magecart\nskimmers, validating the URL on which it’s functioning. Even though the back end of the infrastructure\nalready performs checks to see if a user is requesting the skimmer from a checkout page, this check is\nalso performed in the skimmer setup function. Group 4’s skimmer currently checks for the following list\nof keywords to be present in the page URL. This list has been added to over time and most likely will be\nadded to again:\n\n- onepage - onestepcheckout\n\n- firecheckout - onepagecheckout\n\n- osc - checkout\n\n- Checkout - oscheckout\n\n- awesomecheckout - idecheckoutvm\n\n\n-----\n\nIf the URL validates, the skimmer continues on with the next steps of its work which are:\n\n1. Hook every submit button or form submission event with the skim functionality\n\n2. Setup the replacement payment form\n\nWhile step one is not particularly interesting, step two is. Step two is something we have not seen with\nany other group: Group 4’s skimmer will search for the active payment form on the page and replace\nit with one prepped for skimming (which matches the payment processor used). For the skimmer, this\nstandardizes the data to pull out, as the skimmer also validates the form input.\n\nThe way the data is exfiltrated once a user completes their transaction is through a POST request in\nwhich the group URL-encodes the form data. In this data, the skimmer also sends the visitor’s (victim)’s IP\naddress. Here is the exfiltration code:\n\nOne interesting thing to note is the fact that the data being exfiltrated is quickly checked to make sure it\ncontains a possible credit card number despite the form itself also validating this.\n\n###### Anti-Analysis, Fingerprinting and a Link to the Past\n\nIn September, we noticed Group 4 start doing something fascinating: fingerprinting visitors to find people\nwho might be analyzing its skimmer. This fingerprinter was injected at the bottom of the benign script\nnormally served as a decoy until a shopper hits the payment page.\n\nThe script itself was an attempt at anti-analysis but done in an odd way. The code added to the bottom\nof the benign script would check if the user visiting were on a mobile device and if this person had their\ndeveloper toolbar open. But even more interesting is that Group 4 was performing a timing anti-analysis\ntrick. The concept behind it is that when a piece of code runs a CPU, it's rather fast at executing all the\ninstructions, but when a human analyzes the code or some trace analyzers run the code, it tends to execute\nslower. Group 4’s fingerprinter tested for this slowdown in code, which is something we had never seen\nused in JavaScript before:\n\nThis method was used quite a lot before, however, with malware. An old, trivial trick is timing the execution\nof code in your malware to see if someone was analyzing it.\n\nAfter running these timing, mobile device, and developer toolbar checks, the user is eventually presented\nwith this fingerprinter function which sends a profile of their browser and from where they’re connecting\n\n\n-----\n\nto a server owned by Group 4. However, the path to where the data is sent is nothing like the one to where\npayment data normally goes:\n\nSomething to note: You don’t just jump into the business of web skimming, and with many of these\nMagecart groups—especially the more sophisticated ones—it’s clear they have a deep history in\ndigital crime.\n\nWithin the malware world, there are categories of malware that go after money by victimizing people\nwho are opening banking sessions in their browser. The concept to inject additional scripts in the banking\nsession webpage to manipulate what the infected user is seeing. Often, these scripts would overlay the\nlogin or transaction pages.\n\nOne example of the overlay technique at log-in is asking the user for an additional step of authentication\nafter they already logged in. What the scripts were doing was hiding a transaction in the background and\noverlaying a fake second step of authentication page the user thinks is for their security, and requesting a\nTAN or OTP code. What the user would unwittingly be doing is confirming the transaction performed in the\nbackground by which the criminals could transfer funds from the victim’s account.\n\nThis technique of overlaying payment information is something the web skimmer for Group 4 does. The\ngroup also seems to be using methods to detect and avoid analysis. To us, these advanced methods\ncombined with sophisticated infrastructure indicates a likely history in the banking malware ecosystem\nwith regard to webinjects. It can be that they are still active in this ecosystem, but it could also be that they\ntransferred their MO toward card skimming because it is a lot easier than banking fraud.\n\n\n-----\n\nVictims:\n### 12+\n\n\n## Group 5\n\n###### Modus Operandi\n\n\nFirst Seen:\n### 2016\n\n\nGroup 5 is a strategic group with a unique approach to getting a large volume of victims. That said, they\nwill not shy away from targeting one specific victim if there is a high return—the breach of Ticketmaster is a\ngood example of this.\n\nGroup 5 performs supply-chain attacks against online merchants. The web supply chain is unique in that\nany service providing ads, static content, analytics or additional functionality to a website is a part of it.\nThese services have the ability to execute scripts on the site with which they are integrated. Unfortunately,\nthis makes them the perfect target for Group 5. While the group generally targets anyone that provides\nonline services for other websites, they’ve specialized in targeting those that provide services specifically\nto online merchants.\n\nThe idea behind the targeting of third parties is that they can, with a single compromise, hit thousands of\nsites at once instead of having to compromise individual merchant websites.\n\n###### The Skimmer\n\nGroup 5’s skimmer is fairly typical among Magecart groups and one we’ve seen many times. In fact, Group\n5 most likely purchased the same kit as the others. We’ll dive deeper into the underground supply chain\nsection later in this report. The group almost always obfuscates its skimmer with free obfuscation services\nfrom javascriptobfuscator.com. In rare cases, the group forgets this obfuscation. One such instance is\nthe compromise of a third-party service called Shopper Approved. This error gave us a clean look at the\nversion of the skimmer used by the operators.\n\nThe skimmer is not that big but for clarity, we will break it down piece by piece starting at the bottom\nof the code to better describe the flow. Here we see its activation switch. The skimmer will only work if\nthe URL path (location) matches one or more keywords which indicates the page on which the script is\nrunning is most likely a checkout page. It looks like this:\n\nThe regex check has changed over time with new keywords added. We have seen the skimmer activation\ncheck contain one of the following keywords for Group 5:\n\n- onepage - ymix\n\n- book - pay\n\n- booking - check\n\n- checkout - bill\n\n- onestep - pay\n\n- firecheckout - cart\n\n\n-----\n\nThese keywords most likely come from experience as the group reaches and compromises more\nmerchants, and observes how these merchants structure their web store checkout process.\n\nIf the skimmer is activated, the script is running on a “valid” page and it will call the send function of the\nskimmer object. The send function looks like this:\n\nWe’ve split up the functionality in three parts:\n\n1. This section looks up all clickable elements and forms in the page and attaches events or event listeners\nto ensure that when any of these items are clicked or submitted, the clk function is called. The clk\nfunction extracts the payment information from the forms and input fields.\n\n2. In this section, if data payment information is extracted by the clk function, the skimmer will encode\nthe data with base64 encoding and exfiltrate the data via POST to the drop server. Additionally, it\nincludes the hostname the data was skimmed from and a unique ID for the user.\n\n3. This section empties the skimmed data variables and sets a timeout before calling itself, the send\nfunction, to start the skimming process again in case the first attempt didn’t hold data.\n\nIn section 1, we also described a function called clk which extracts the payment information from the page.\nThis function grabs any type of input field and takes the field name and value. It looks like this in the script:\n\nSimplified, the above skimmer hooks any submit button or form submission, extracts the input field data\nwhen it is submitted and sends it to the drop server.\n\n\n-----\n\n###### Victims\n\nAs we explained in the Modus Operandi section, Group 5 compromises third-party suppliers instead\nof individual stores to greatly extend its reach. The victims we denoted in the top section are the\ncompromised third-party providers, which is a relatively low number. However, we expect the actual\nnumber of victims that were running these third-party plugins exceeds 100,000. This group compromised\nsuch a wide variety of services that we’ve even seen the skimmer appear in advertisements and on major\nCDNs.\n\nThe following list shows the victims we have observed and investigated along with all the information we\nhave for each compromise. However, we are confident there are more compromised providers out there.\nThe start and end of each compromise are rounded off to the month in which they occur so bear in mind\nthat it may be in the beginning or end of the month.\n\n\n-----\n\n##### Conversions On Demand\n\n###### Start of compromise: December 2016 End of compromise: April 2017 Drop server domain: webfotce.me\n\nThis is the first provider we saw compromised by Group 5. The reach of this supplier is concerning to us\nbecause, in addition to the sites with which it integrates, it’s embedded in offerings from other solutions\nproviders. For example, Yahoo uses Conversions on Demand during its payment checkout process, but also\noffers a service called Small Business which our crawl data shows has been using Conversions on Demand\nsince early 2016. Below is a RiskIQ web crawl showing a store using Yahoo Small Business, which includes\nConversions on Demand with the Magecart skimmer.\n\nThe crawl starts by RiskIQ’s virtual user clicking around on the store and hitting the checkout button, which\ntakes the crawler to the Yahoo order processing page. What follows is a request for a JavaScript resource\nwhich in turn loads Conversions on Demand:\n\n\n-----\n\nThe red box below contains the skimmer code injected in the Conversions on Demand script:\n\n\n-----\n\n##### Annex Cloud\n\n###### Start of compromise: December 2017 End of compromise: July 2018 Drop server domain: webfotce.me\n\nAnnex Cloud (or Social Annex) is a provider of two services for online merchants: customer loyalty\nprograms by which a customer can earn points for purchases, and advocacy programs by which customers\ncan get discounts by referring their friends. A large base of major retailers uses Annex Cloud as shown\nby the logos present on its website. Below is an example of one of Annex Clouds customers reporting\nthe result of the breach to the government, which is required by some states when personal information\nis leaked. On Sept. 14, Stein Mart disclosed a breach of customer information through Annex Cloud to the\nOffice of the Vermont Attorney General:\n\nSource:\nhttp://ago.vermont.gov/blog/2018/09/14/2018-09-14-stein-mart-inc-notice-of-data-breach-to-consumers/\n\n\n-----\n\n##### SAS Net Reviews\n\n###### Start of compromise: April 2017 End of compromise: July 2017 Drop server domain: web-rank.pw\n\nThe company SAS Net Reviews has an international reach that was successfully exploited by Group 5. SAS\nNet Reviews goes by different names in different countries or continents. Here is the list of company names\nunder which SAS Net Reviews operates in different countries:\n\n- Verified Reviews: United States, Australia, and New Zealand\n\n- Avis Vérifiés: France and Chile,\n\n- Recensioni Verificate: Italy,\n\n- Echte Bewertungen: Germany,\n\n- Echte Beoordelingen: The Netherlands,\n\n- Opinoes Verificadas: Brazil and Portugal,\n\n- Opiniones Verificadas: Spain, Colombia, Mexico, Chile, and Peru\n\nWe observed the Group 5 skimmer on several of its international review sites. While we haven’t seen\nthe skimmer on all of the company’s sites, we believe all of them were compromised. Our conclusion is\nsupported by the fact that for five of the companies operating under SAS Net Reviews, we saw the same\nfile path containing the skimmer. The file path was a script that was used by all of the internationally\noperating companies. We believe Group 5 compromised each company individually, or, more likely the\ncodebase of the mother company that all the affiliated companies use. We suspect that Avis Vérifiés, based\nout of France, is the organization that was compromised for this breach, based on the following a snippet\nin the skimmer, which is normally dynamic:\n\nIn the second to last line, which starts with http.send, the URL arguments for the POST request to\nexfiltrate the stolen payment information are set. Inside this string, there are two variables used, keym and\nskimmer.myid. Normally, another variable is used as well, called domm, which is put behind the &hostname=\nportion of the URL arguments. You can see that the skimmer script still assigns the domm variable, which\nwill contain the hostname of the site on which the skimmer is running. The reason the group is hard coding\nthe URL argument to be avis-verifies instead of the hostname is because it wants to group the skimmed\ndata from all the company domains operating under SAS Net Reviews under one ID in its database.\n\nAn interesting part of this compromise is how merchants use SAS Net Reviews. We observed two ways by\nwhich these sites were affected by the skimmer:\n\n- The merchant manually applied for the service and added the code to the site to make use of it.\n\n- The merchant was using a known e-commerce platform, e.g. Magento, for which SAS Net Reviews has\nstandard plugins and installs the service as a plugin\n\n\n-----\n\nWith the explanation above, we can say with high certainty that this qualifies as one of the widest reaches\nvia a single breach that Group 5 has achieved. For one of the SAS Net Reviews domains, close to 8,000\nsites were affected. That number grows when you factor in the service operating in other countries.\n\n##### flashtalking\n\n###### Start of compromise: July 2018 End of compromise: August 2018 Drop server domain: infostat.pw\n\nWhile the name may not be familiar, the compromise of flashtalking is, in fact, a big deal, because it is not\nonly a provider of content for advertisements but also serves advertisements. Through this compromise,\nGroup 5’s reach was increased. However, we don’t believe this breach was very effective in capturing\npayment data because advertisements and their content aren’t usually active on payment pages.\n\nOne thing to note about flashtalking is that a lot of other providers make use of it. As with SAS Net\nReviews, that means we cannot even begin to track how far the skimmer spread. We saw flashtalking\nas third, fourth, fifth, and even sixth-party inclusions on websites, indicating the impact of this breach\nreverberated across the web.\n\n##### SociaPlus\n\n###### Start of compromise: December 2017 End of compromise: June 2018 Drop server domain: webfotce.me\n\nThe compromise of SociaPlus was interesting from an analyst's perspective because it showed us the\ndedication and targeting of Group 5. When Group 5 compromised SociaPlus, it did not target all customers\non affected sites. It started with one organization, skimmed them for a period, then moved on to a second\norganization, and eventually, the third and fourth. The fourth customer of SociaPlus was Ticketmaster. Once\nGroup 5 inserted the skimmer into the Ticketmaster-specific script, it stopped targeting other SociaPlus\ncustomers.\n\nMost likely, Group 5 saw the amount of traffic and card details it was skimming and focused on\nTicketmaster. While keeping the skimmer in the SociaPlus scripts the group actually targeted Inbenta,\nwhich we’ve detailed in this list, specifically to expand its reach into Ticketmaster’s website. They\ncompromised Inbenta but only targeted Ticketmaster from Inbenta’s infrastructure even though Inbenta\nhad a lot of other customers.\n\n\n-----\n\n##### Inbenta\n\n###### Start of compromise: February 2018 End of compromise: June 2018 Drop server domain: webfotce.me\n\nInbenta is a service providing a first-line helpdesk or support line. The service is automated using artificial\nintelligence in the sense that it will be able to give answers for most questions and only when it is not\nable to provide an answer (or one that satisfies the customer) it will loop in the actual support desk. The\ncompromise of Inbenta can be attributed to the targeting of Ticketmaster as we described in the SociaPlus\nsection. Inbenta became a target for Group 5 as it was expanding its attack against Ticketmaster’s\ncustomers.\n\n##### PushAssist\n\n###### Start of compromise: June 2018 End of compromise: August 2018 Drop server domain: webfotce.me\n\nPushAssist is a provider of push notifications to re-engage customers on e-commerce websites. The\nbreach only lasted a little more than two months, and Group 5 took the same approach as with SociaPlus,\none organization at a time was compromised and the skimmer added. We saw the skimmer appear in six\ndifferent customer scripts but nothing more from there on.\n\n\n-----\n\n##### Clarity Connect\n\n###### Start of compromise: May 2017 End of compromise: July 2018 Drop server domain: web-stats.pw\n\nClarity Connect is a company that helps merchants in the horticulture industry to establish a web presence\nin the form of a website or webshop. We saw Group 5 target Clarity Connect in 2017, but it seems it was\nactually compromised before but their administrators removed skimmer. Group 5, for the first and only\ntime that we have observed them, left a message for the Clarity Connect administrators:\n\n##### ShopBack\n\n###### Start of compromise: January 2018 End of compromise: May 2018 Drop server domain: web-rank.pw\n\nShopBack Brazil was compromised and serving the skimmer from early 2018. ShopBack is a retargeting\ncompany helping merchants to re-engage with customers to promote additional products.\n\n\n-----\n\n##### CompanyBe\n\n###### Start of compromise: May 2018 End of compromise: September 2018 Drop server domain: web-stats.pw\n\nCompanyBe provides an e-commerce platform for merchants to establish an online presence including\nPOS integration and inventory tracking. Group 5 injected its script on the CompanyBe checkout page and\nuses it to target on a per-customer basis, similar to the tactics we observed with SociaPlus.\n\n##### Feedify\n\n###### Start of compromise: August 2018 End of compromise: September 2018 Drop server domain: info-stat.ws\n\nFeedify is an Indian company that is also active in the e-commerce world, providing cross-platform and\nbrowser-based customer survey and notification services. Feedify was repeatedly compromised; Group 5\nadded its skimmer three additional times after Feedify initially removed it, which shows that it had ongoing\ncontrol of Feedify’s infrastructure. Unbeknownst to Feedify, removing the script was not enough to solve\nthe issue.\n\nOnce Group 5 has control of a supplier’s infrastructure, it will stay there as long as it can. Remediation of a\nbreach of Group 5 means taking the proper incident response steps to identify how and where Magecart\ngained access rather than simply removing the skimmer code.\n\n\n-----\n\n##### Shopper Approved\n\n###### Start of compromise: September 15th, 2018 End of compromise: September 17th, 2018 Drop server domain: info-stat.ws\n\nShopper Approved is a third-party supplier of approval ratings. It’s a site seal placed on a customer’s\nwebsites showing how that merchant’s customers rate the store. Group 5 compromised Shopper Approved\nand modified the script that sets up the site seal call-out to Shopper Approved.\n\nFortunately, Group 5 forgot something important (and helpful to us) when it compromised Shopper\nApproved. At 04:48:25 GMT on Sept. 15, it placed the skimmer into the Shopper Approved codebase, but\nforgot to obfuscate it:\n\n\n-----\n\nThe group returned at 05:13:52 GMT, 25 minutes later, to quickly replace the skimmer with an obfuscated\nversion, but it was already too late to avoid us seeing it:\n\n\n-----\n\nVictims:\n### 2\n\n\n## Group 6\n\n###### Modus Operandi\n\n\nFirst Seen:\n### 2018\n\n\nGroup 6 is perhaps the most high-profile Magecart group and its impact has been massive. This group’s\napproach is to be selective, only going for top-tier targets, such as British Airways and Newegg so that\neven if they only manage to hold the skimmer in place for a short period, the sheer volume of transactions\non the victim website will yield a high return on investment.\n\n###### The Skimmer\n\nGroup 6’s skimmer is simple compared to the other groups. While the concept is the same as other\nMagecart skimmers, Group 6 operatives have good knowledge of how their victim processes payments\nwhich allows them to integrate their skimmer in a much more elegant—and less detectable—way.\n\nIn general, below is what the skimmer looks like. We have substituted certain parts that are modified for\neach victim, which we explain below:\n\n- %SUBMIT_BUTTON_ID% — This is the ID for the button that submits the form and/or starts the\npayment process. The skimmer binds the mouseup and touchend events to the skimming function. The\nidea behind this is that once a consumer fills out their payment information, the skimmer grabs and\nexfiltrates the payment details right before they hit the button to purchase their items. Binding these\ntwo events ensures the skimmer works for desktop computers and mobile/touch devices.\n\n- %FORM_ID% - This is the form ID on the web page that contains the payment information. At times,\nGroup 6 will extract more than one form, because certain victim sites require their customers to fill out\nseveral forms in the payment process. If this is the case, the group will simply combine the data of the\nmultiple forms and fields.\n\n- %EXFIL_URL% - This is the URL location to which the skimmed data goes. Group 6 makes this\nexfiltration URL match exactly with the one for their victim’s site.\n\n\n-----\n\n###### Victims\n\nAs of publishing, the identities of the two victims, British Airways and Newegg, are public knowledge.\nRiskIQ covered both incidents in blog posts below detailing the operations.\n\n- British Airways - https://www.riskiq.com/blog/labs/magecart-british-airways-breach/\n\n- Newegg - https://www.riskiq.com/blog/labs/magecart-newegg/\n\n###### Profit\n\nGroup 6 makes its profit by selling skimmed payment data on a dump and credit card shop. This dump\nshop and their owners remain to be the most prominent underground vendors of compromised payment\ninformation from both compromised brick-and-mortar point-of-sale merchants and breached e-commerce\npayment details.\n\nAlmost immediately following its inception in October 2014, this shop became one of the most popular\nshops among international cybercriminals to buy stolen credit card and dump data. Advertised on\ninternational and Russian-language carding forums, the shop has always maintained an image of\ngeopolitical neutrality with underground forum updates written in flawless English, alerting customers of\nnew released of compromised cards for sale. The shop also maintains friendly, English-speaking customer\nsupport that allows the shop to promote its compromised data for international cybercriminals\n\nHere are examples for the two victims that have been observed to date:\n\n- British Airways - Data put up for sale a little over a week after cleanup\n\n\n-----\n\n- Newegg - Data put up for sale a little over a week after cleanup\n\n\n-----\n\nVictims:\n### 100+\n\n\n## Group 7\n\n###### Modus Operandi\n\n\nFirst Seen:\n### 2018\n\n\nGroup 7 doesn’t have a well-defined modus operandi other than compromising any e-commerce site\nit can find. Unlike Group 6, it does not go for top-tier websites, but it does not shy away from large\nmedium-tier sites.\n\nHow Group 7 exfiltrates the stolen payment information is interesting. Instead of using a dedicated host for\nthe injection and the drop, this group uses compromised sites as proxies for its stolen data. Because Group\n7 uses compromised sites, they are difficult to take down. Doing so requires cooperation with the site\nowner to remove the skimmer without destroying forensic evidence. Usually, RiskIQ remediates Magecart\nby taking over and sinkholing its domains, but because these domains are legitimate, the process of\nremediation for Group 7 victims takes much longer.\n\n###### The Skimmer\n\nGroup 7’s skimmer is simple and built for the specific type of checkout process each victim merchant uses.\nIn essence, the skimmer works much the same as other Magecart skimmers but will exfiltrate payment data\nin GET requests which are embedded in images.\n\nGroup 7 does not use servers, adding the script tag directly on the website, so a victim normally\nencounters this skimmer as a small snippet of script on their website.\n\nThe skimmer is below, cleaned up and with the obfuscation layer removed. We have substituted the parts\nthat are interchangeable with each victim (explained below). The first section of the skimmer is a header,\nwhich is always found at the top of the skimmer:\n\nHere is the breakdown of the variable functionality:\n\n- xzm_dmn — This is the domain of the store where the data is skimmed from\n\n- xzm_checkoutpage — This is the pattern of the checkout path for the website it skims on\n\n- xzm_procl1 & xzm_procl2 — These are the compromised sites used to proxy the stolen payment data\n\n- sedj74 — This is a global flag that enables or disables the skimmer. If set to false, the skimmer will work.\nThis flag will set after skimming data successfully so the skimmer won’t send the data twice.\n\n- intervalId — This holds the interval timer which calls the skimmer code every 500 milliseconds. This is\ncleared once the data is successfully skimmed.\n\n\n-----\n\nAfter the header comes the skimmer and exfiltration code. We ll start with the skimmer:\n\nThe skimmer is simple in that it will check if a certain element with the ID checkout-step-review is\ndisplayed, ensuring the victim has reviewed the products they are paying for, reviewed the shipping details,\nand finally, filled out the payment information. If the form is active and populated, the skimmer will go\nthrough the individual form fields to grab the information.\n\nAt the end, all the stolen data is concatenated into one long string, with each data item separated by a pipe\nsymbol (|), encoded into base64, and prepared for URL encoding.\n\nAfter the data is extracted and turned into a large data blob, the exfiltration takes place. Exfiltration of\ndata is done in the form of a GET request instead of the POST requests we’ve seen with other Magecart\nskimmers. The skimmer creates two image elements which then get their source URLs set to the\ncompromised websites used for proxying. The encoded stolen data is appended to the URL, along with the\nhostname of the store the data came from.\n\nHere is the code:\n\n\n-----\n\n##### Related Unclassified Threat Groups\n\nIn the previous section, we summarized some of the different threat groups we see operating under the\nMagecart umbrella and analyzed their modus operandi. However, web-skimming isn’t unique to Magecart.\nIn July, Volexity published an article on JS Sniffer[9], which is a kit designed to skim information from web\npages, but unlike Magecart, is not focused solely on payment information. Based on Veloxity's findings,\nwe’ll highlight one other group we’ve been tracking that, while they do focus on payment information, are\nnot related to Magecart.\n\n###### Brand Impersonation\n\nBrand impersonation is a persistent problem on the internet—RiskIQ detects thousands of incidents as we\ncontinuously help customers combat false and fraudulent use of their brand across the web and mobile\necosystem.\n\nIn our investigations of credit card skimming, we ran across a new, widespread brand-impersonation\ncampaign making use of skimming scripts we previously observed used by Magecart groups. Rather than\ncompromising stores, the group behind the brand-impersonation campaign sets up stores that mimic\nlegitimate vendors such as Nike, Adidas, The North Face, and others. We have observed more than 800\nsites hosting these brand impersonation/skimming stores since June 2018.\n\nThis group’s strategy appears rather simple: the perpetrators set up a large number of stores\nimpersonating as many popular brands as possible and drive traffic to these fake stores with a variety\nof methods. Some visitors will attempt to make purchases, entering their payment information into the\npayment form where the skimmer copies it and sends it to a drop server. The payment page even displays\nbadges from various security companies in order to appear more legitimate.\n\n\n-----\n\nThe skimmer used by this group is an altered version of the Magecart skimmer first observed as part of\nGroup 1’s activities in 2015 and later as part of the ongoing Group 5 campaign.\n\n\n-----\n\n-----\n\nThe drop server domain, jquery-cloud.net, has been in use off and on since 2015 and was one of the\ndomains used in the skimming campaign that compromised the National Senate Republican Committee’s\nstore, along with several thousand other sites back in 2015-2016. It appears to be the only drop server in\nuse by the brand impersonation skimming campaign. It is also currently the sole domain hosted on five\nseparate CloudFlare addresses. Despite the use of a drop server and skimmer script that has been seen\nin conjunction with Group 1 campaigns, we believe the changes in MO, hosting infrastructure, and domain\nregistration point to a new group perpetrating credit card fraud that is unrelated to the Magecart threat.\n\n\n-----\n\n##### Underground Supply Chain & Skimmer Kits\n\nThrough visibility into the criminal underground, analysts continue to conduct investigations into the\ncriminal ecosystem surrounding and facilitating e-commerce breaches involving credit card sniffers\nfrom technical penetration, compromised credit card sales, mule networks, and reshipping. By and large,\ne-commerce websites running on the popular open-source Magento platform are being commonly\ntargeted by attackers who are using brute-force password and enumeration attacks to access\nadministration panels to scrape credit card numbers on high-value targets (HVT), and install malware that\nmines cryptocurrency on others.\n\nCompromised and backdoored websites and databases are not only used to proliferate scams, carry\nout spam email campaigns, and mine cryptocurrency, but also as a means of providing access to victim\nnetwork peripheries. During the past several years, Flashpoint analysts have observed that various\ne-commerce, hospitality, retail, and online payment services have been breached as a result of criminal\nsyndicates using fraudulently obtained access to web resources. This access could potentially allow actors\naccess to proprietary internal documents or resources, as well as entry points through which they can\ndrop various malicious payloads. However, the types of vulnerabilities and the ways in which they can be\nexploited depend on the threat actor's specific capability, motivation, targeting, and goals.\n\nRoutinely, criminals gain access to various compromised websites with e-commerce content management\nsystems (CMS) trying to maximize their access by stealing customer credit card data.\n\nThe commonly observed scenario, where one cybercriminal gaining access to the CMS panel is seeking\nassistance from other vetted criminal members, is as follows:\n\n\n_I have access to a shop on Magento. I need to place a sniffer on it that will get me the data used by_\n_customers to place orders._\n\n_I haven't worked with this platform before and can't figure out where this data is processed and in_\n_which file, so I can intercept it and send to my server._\n\n\n-----\n\nThe solution is routinely around placing custom JavaScript code to intercept credit card data and pass it to\nthe criminal backend leveraging a set of turnkey options available for sale on the underground.\n\n- Recent “MagBo” Breach Platform\n\nUnderground communities and marketplaces selling access to compromised websites are increasingly\npopular in the cybercriminal ecosystem. One of the most recent emerging breach marketplaces is called\nMagBo (\"mag\" is short for \"magazin,\" the Russian word for store).\n\n\n-----\n\nMagBo has become a popular venue for various threat actors to sell and auction access to breached\nwebsites, databases, and admin panels. Its strong reputation across the cybercriminal underground and the\nvarying levels of access available provide additional credibility to offers posted to the platform. As such,\nmany cybercriminals prefer to use this shop to sell their breached access.\n\n_Image 1: The actor advertises the shop as \"The best thing on the dark side.\"_\n\nThe earliest advertisements related to this shop date back to a March 16 post on a top-tier Russianlanguage hacking and malware forum in which the owner offered to test their marketplace as a primary\ndestination for website breach access sales. MagBo primarily advertises access to websites that were\nbreached via the following means:\n\n- PHP shell access\n\n- Hosting control access\n\n- Domain control access\n\n- File Transfer Protocol (FTP) access\n\n- Secure Socket Shell (SSH) access\n\n- Admin panel access\n\n- Database or Structured Query Language (SQL) access\n\nAdditionally, each offer for breached access describes its privilege levels from \"full access permissions\" to\n\"abilities to edit content\" and \"add your content,\" including possible content management system (CMS)\nprivilege level.\n\nPrices for compromised websites range from $0.50 to $1,000 per access, depending on a website\nranking listing various host parameters. These parameters allow the buyer to purchase the exact breach\nthey need depending on the website value as determined and checked by the store. During Flashpoint's\ninvestigation into MagBo, analysts uncovered approximately 3,000 breached websites offered for sale on\nthe marketplace, with more than a dozen sellers and hundreds of buyers operating on the platform. Some\nof the most known website breaches are offered through the MagBo underground shop.\n\n- Credit Card Skimmer Vendors on the Criminal Underground\n\nWhile Magecart and their groups likely leverage their customized card sniffer scripts and methods, there\nare plenty of underground vendors offering turnkey solutions for stealing credit card data from breached\ne-commerce websites. These threat actors have a large customer base and Flashpoint analysts assess with\nhigh confidence that their customer network is likely involved in digital skimmer attacks.\n\nDuring the investigation into possible vendors, analysts identified at least four major actors involved in\nthe sales of such tools. Among the most prolific threat actors operating in the underground who sell\ncustomized skimmers are members of the top-tier Russian-language hacking underground. Analysts have\n\n\n-----\n\nobserved these actors advertise customized digital skimmers, which they refer to as sniffers. These threat\nactors have a large customer base and Flashpoint analysts assess with high confidence that their customer\nnetwork is likely involved in digital skimmer attacks. Customers have provided positive and negative\nfeedback related to the skimmers advertised on the underground. The price for the sniffer kits ranges from\n$250 to $5,000 depending on the kit complexity and its vendor unique pricing models.\n\nI. Sniffer Toolkit Vendor No. 1\n\nSince March 3, 2016, this underground vendor offers a web panel and JavaScript code that can capture\ncredit card data once installed on the host. The sniffer, which is selling for $400 (to be paid in Bitcoin),\ncan allegedly harvest credit card data in transit. More recently, the vendor updated its offering to include\nadditional features to check the stolen cards for the Luhn algorithm to make sure the cards are valid.\nAdditionally, the vendor also works directly with the criminal groups on a percentage-basis profit-sharing\nmodel. The actor describes their position on working only with larger breaches as follows:\n\n\n_Because a lot of potential clients want to work on a percentage basis and want to install the sniffer on_\n_a bunch of tiny shops where it’s going to take 100 shops to get 20 orders per day, I am instituting a_\n_new policy where I will only work on a percentage basis with individuals who process over 50 orders_\n_per day._\n\n\n_Image 2: The actor advertises the panel with the English-language and Russian-language control setup._\n\n\n-----\n\nVendor No. 1 describes their credit card sniffer offering as follows (translated from Russian):\n\n_• Works purely in JavaScript_\n\n_• Cards are validated on the client (Luhn)_\n\n_• RSA-2048 encryption of cards in the control panel_\n\n_• User-Friendly interface to add new stores (your programmer doesn’t even need access to server)_\n\n_• Extensive manual for safe server set up_\n\n_• Proxy PHP script_\n\n_• Checks stores for other sniffers. Notifies you via jabber or telegram_\n\n_• Extensive manual for programmers for checkers_\n\n_• Autoscans netsparker. Is able to launch unlimited amount of copies of Netsparker_\n\n_• List of clean VDS and VPS, which won’t ban for scans and accept bitcoin_\n\n_• Extensive manual for setting up VDS_\n\n_• Checks for expiration date, Luhn, cvv right on server_\n\n_• Can format all incoming data (Name starting with capital letters, cities, states)_\n\n_• I will encrypt your JS for free using the top encryption from Caesar+_\n\n_• The info from the stores is masked when sent, not via PHP script_\n\n_• Logs IP and User Agent_\n\n_• Duplicate use of cards don’t create new entries_\n\n_• Is not burned by AV_\n\n_• No vulnerabilities (Yes, I checked)_\n\n_• Free support and free updates_\n\nII. Sniffer Toolkit Vendor No. 2\n\nAnother prolific underground vendor offers budget versions of credit card sniffers on the underground.\n\n\n-----\n\n_Image 3-4: The developer advertises the turnkey offering providing an intuitive panel_\n_on how to control compromise panels and derive credit card from the injected scripts_\n\nVendor No. 2 advertises their offering as follows:\n\n_Sniffer is written in native JS, this is the first version of the product, updates are planned and will be._\n\n_Description of the sniffer:_\n\n_1. Without jquery_\n\n_2. Addition of data (if the data is filled on several pages)_\n\n_Description of the panel:_\n\n_1. Homepage:_\n\n_Short statistics of sites and cards._\n\n_2. The cards view page:_\n\n_Display a list of cards, with the ability to view all card information, delete cards._\n\n_3. Settings:_\n\n_Settings of sites:_\n\n_Displays a list of sites that send data to the panel. In the configuration of the site, you can determine the_\n_type of data._\n\n_Settings of users:_\n\n_Displays the list of users in the panel. The administrator can add / change/delete users._\n\n_Additional users can be restricted to access to view data._\n\n_A common user can only change the password and the name that are displayed in the panel._\n\n_4. Export:_\n\n_The section is intended for export CC from the database._\n\n_In the first version, the format of the export data is: num | exp_month | exp_year | cvv | name | country |_\n_state | city | address | zip | phone_\n\n\n-----\n\n_The following updates will include firstly filters for the cards view page,_\n\n_customizing your own export formats and adding additional filters._\n\n_Adding graphs to the main page with other useful information._\n\n_Disclaimer:_\n\n_In violation of the law of any country, all responsibility lies with the user_\n\n_Cost:_\n\n_$250 (the first 4 clients get a discount of $ 50, in case of writing a review)_\n\n_The updates described above are free for those who bought the first version. Next, the sale price will be_\n_$300._\n\nIII. Sniffer Toolkit Vendor No. 3\n\nThe underground vendor advertises their offering as follows:\n\n_Sniffer is written in pure JS. It is intended to steal credit cards from website forms. Completely written_\n_from scratch:_\n\n_Sniffer:_\n\n_• Small code weight, pure JS without dependencies_\n\n_• Several methods of credit card stealing, including connection through jQuery and bypassing any_\n_possible website protection_\n\n_• Quiet mode of operation_\n\n_• Exfiltration of the stolen credit card data is done indirectly - through an image request_\n\n_• Simple encryption_\n\n_• Luhn_\n\n_• It is self-evident - work through the gate. There is an admin area where all the data is collected._\n\n_• I'll help with the installation (except for the moment of inserting your resources - this I do not do.) I'll_\n_tell you how to insert one JS file, but I personally do not undertake it). I do not think that there will be_\n_any difficulties at all._\n\n_The first 3 participants price tag $450 per package (JS + admin, gate + instructions)_\n\n_Further - $650 per package._\n\n_Updates are of course free._\n\n\n-----\n\nIV. Sniffer Toolkit Vendor No. 4\n\nAnother prolific vendor offers the full credit card sniffer kit (known internally as “SnifFall”) for the base\nprice of $5,000 USD offering extensive turnkey card sniffer functionality. It is notable that the developer\ndoes not participate in profit-sharing schemes, only selling the sniffer source code.\n\nThe actor advertises the kit as follows:\n\n_• The JS code is rewritten: it does not affect “DOM” and does not hang events on the fields, it resets the_\n_activity when the browser console is open._\n\n_• Added sniffer manager controller for easy website_\n\n_• The proxy settings is changed, if it does not give “file_get_contents, then sends curl_\n_Checker script for all incoming cards_\n\n_• Exports of cards are checked on exports, cards are given in one format_\n_(month 7 - 07, year 2022 - 22 etc)._\n\n_• Removes duplicate cards: if permanent customers buy one card in the shop, but the address changes,_\n_then all the old ones are deleted and only the new card is saved._\n\n_• One SQL and LFI bugs are fixed on php old versions which was in theory possible after authorization_\n_in the admin panel_\n\n_• Captcha removed and extended session_\n\n_• Update for those who have already bought the previous versions of $5,000 USD_\n\n_• Collects cards without sending Ajax or WebSocket request. Clean Javascript and no jQuery._\n\n\n-----\n\n_Image 5-6: Previously known as “SniFFall,” the sniffer offers various credit card skimming_\n_functionality with the embedded Javascript injection code generation functionality._\n\n\n-----\n\n##### Sales of Stolen Credit Cards on Underground Shops\n\nAnother stage in the sale of compromised credit cards from such scripts includes the reselling of the data\non underground credit card shops.\n\nA large number of shops for compromised credit card information exist in the underground. The\ninformation sold by these shops varies and may include dumps (information skimmed from the magnetic\nstripe of a card) for in-store fraud schemes or cards (card number and associated information, also called\nCVV) for card-not-present (CNP) transactions, such as online purchases. Different tiers of shops are based\non overall card validity, the newness of breaches, and the range of selection.\n\nIn cases involving credit card sniffers, criminals sell the stolen data through various credit card shops. In\nthe cybercriminal underground, cards/CVV refers to the card number and associated information (in some\ncases, certain personal information is available). A CVV purchase generally includes:\n\n- The payment card number\n\n- CVV code\n\n- Expiration date\n\n- Cardholder name\n\n- Address\n\n\n-----\n\n_Image 5: One underground shop routinely offers credit cards that can be filtered via various means._\n\n\n-----\n\n##### Drop Projects: Effective Method of Mule-Handling and Shipping Goods from Credit Card Shops\n\nIn many cases, once the criminals procure stolen credit cards, they start mule (also called drop) recruitment\nwith the subsequent shipping of stolen purchased goods to their destinations.\n\nOne common cashout scheme involves enlisting various residents willing to accept fraudulently purchased\nmerchandise, many of whom are duped into believing that they work for a legitimate logistics firm.\n\nOftentimes recruited through employment websites, and in desperate need of supplemental income,\nmany unsuspecting individuals fall for such criminal schemes, accepting an invitation to become a parttime reshipping agent with a flexible schedule and decent pay. Most of the time, after initial training and\nseveral successfully received packages, the firm will cease all communications with the reshipper, leaving\nthem without the promised pay and having to deal with law enforcement. The cycle then repeats, with the\nfraudsters moving onto another unwitting victim.\n\n_Image 6: The criminal provides panel access to the “Stuff Control Panel”_\n_tracking mules and their reshipment of stolen goods._\n\nFor example, to initiate the process, the fraudster has to reserve a shipping address and within 48\nhours provide tracking information for an incoming package. In case of a failure to update the required\ninformation, the reservation is automatically canceled and address released to other users.\n\nReshipping rates are based on the value and liquidity of the items. The cost of a single received and\nforwarded package is $80 for most electronics, as well as LEGO toys, and $50 for anything deemed nonliquid or unpopular. Shipping costs to the final destination are not included and must be covered separately\nby providing a legitimate or grey (purchased with stolen credit card information) shipping label and\nacquired from a trusted seller. Prior to being shipped, all packages received within a single day may be\nconsolidated into a single package for an additional $30.\n\n\n-----\n\n##### Disruption of Magecart Activities\n\nBecause of the scale of the breaches that have occurred, it is just not feasible to reach out to every single\nvictim within a sensible time of the compromise. For this reason, we focus on mitigation and disruption by\ntaking over the domains used to inject skimmers to web pages or receive the stolen data.\n\nThis process of sinkholing is a standard solution to online threats and effectively kills off the ability of the\noperators/attackers to control their attack infrastructure. As we felt it was not our position to ingest this\ndata, we partnered with two non-commercial organizations, AbuseCH and Shadowserver, which perform\nthe sinkholing and reporting. We are merely a data provider; they do the heavy lifting.\n\nWe also partnered with them because they provide automated reporting to affected organizations. As an\norganization, you can sign up with Shadowserver to claim your IP space and domains to receive your own\nreporting on what they see in their datasets. These reporting services are free.\n\nIf you would like to sign up visit this page:\nhttps://www.shadowserver.org/wiki/pmwiki.php/Involve/GetReportsOnYourNetwork\n\n\n-----\n\n##### A Global Effort: We Need to Work Together\n\nWhile RiskIQ has good insight into the Magecart groups and their operations, that doesn’t mean we will be\nable to spot every instance and every attack. For this reason, we’d like to call on the industry and everyone\nwho encounters these attacks to help take it down. We can do this by continuously sinkholing and taking\ndomains from the criminals behind it.\n\nIf you encounter domains associated with Magecart activities that are not sinkholed, or are not in our\nreport, feel free to contact us and we will ensure these domains are taken down and sinkholed.\n\n\n-----\n\n##### Conclusions\n\nThe lack of visibility by most organizations into their internet-facing attack surface means they're unaware\nof their vulnerabilities and if they've been breached. Today's e-commerce landscape is a fertile ground for\nmagecart attacks, especially amongst the vast number of small and mid-sized online stores.\n\nTo combat the Magecart threat, e-commerce companies should practice general good security practices,\nbut also perform additional integrity checking such as monitoring servers for any file modifications. RiskIQ\nmonitors all resources on web pages to detect changes, both locally hosted or remote, so we can notify\nwebsite owners as soon as tey occur.\n\nAs a consumer, given the scope of these breaches, there's a good chance your credit card number has\nbeen compromised. Consumers should get new cards from their bank and consider setting up additional\nverification steps on their payment accounts. Banks don’t always have two-factor authentification enabled\nby default, but bank customers can add a second step to their payment process in which they have to\nprovide additional proof of identity. This way, even when a card is skimmed, payments cannot go through\nas the attackers cannot perform this second step of verification.\n\n###### A Unique Approach to a Unique Threat\n\nRiskIQ’s network of web crawlers, which crawls more than two billion web pages a day, views and interacts\nwith websites from the perspective of a user. It’s this unique perspective that allows us to detect webbased attacks like Magecart while no one else can.\n\nWhen crawling a page, RiskIQ maps its structure and breaks it down to its smallest elements. This data is\ncaptured and stored in our massive databases to provide a point-in-time snapshot of how a page appears\nand functions, including its javascript. With this reference, we can observe changes, such as the addition\nof a Magecart skimmer, as they happen. It’s this proprietary historical data that allowed us to amend the\nofficial timeline of the Ticketmaster attack and prove that the Magecart skimmer was live on Newegg’s\nwebsite for over a month.\n\nOur researchers direct RiskIQ’s crawlers with custom detection policies they write while hunting for\nMagecart and taking note of their skimmers’ unique Javascript signatures. From the petabytes of data\nthese crawls collect, RiskIQ builds out static indexes including passive DNS, SSL certificates, host pairs\n(redirects), and web components. Pivoting on these data sets allows us to uncover Magecart’s tactics\nand identify victims. For example, our Components data set shows us all the sites running a third-party\nanalytics script compromised by Magecart, and our Host Pairs dataset shows relationships between\nwebsites running the Magecart skimmer.\n\nVisit the RiskIQ blog for more information on the Magecart threat.\n\n\n-----\n\n##### Thank you\n\nWe’d like to thank the following individuals and organizations who have helped us during our research and\nmitigation of Magecart during the past three to four years.\n\n###### Darren Spruell & William MacArthur\n\nFor the original 2015 research of Magecart once the skimmers started to appear and cataloging all of the\ninformation as well as naming the threat MO.\n\n###### AbuseCH & Shadowserver\n\nFor helping to mitigate the Magecart infrastructure by performing sinkholing, automating reporting to\naffected organizations, and maintaining these datasets for law enforcement investigations. All of this work\nwas done under a non-profit label, which shows a high level of dedication. Both of these organizations are\nunsung heroes of Magecart mitigation and have never taken public credit for their work.\n\n###### Anonymous\n\nThere have been several researchers and individuals who, under the terms of anonymity, reached out to\nshare information, give context, or offered help in other ways. While we cannot name you, please be aware\nthat your help is greatly valued.\n\n\n-----\n\n##### Indicators of Compromise (IOCs)\n\nThe list below denotes the IOCs for the different groups. After listing the IOCs per group, the full set of\nIOCs will also be listed as a single set. One thing to note is that we are only supplying domain name IOCs.\nThe groups operate these domains on different subdomains and spread out over multiple IP addresses. IP\naddresses hold no value for detection because many groups rotate these en masse.\n\nBecause the majority of groups have a very expansive infrastructure, we will not be including the actual\nIOCs in this document. Instead, we will provide RiskIQ Community Projects which contain all the IOCs. The\nprojects are public and no authentication is required to get these IOCs.\n\n###### IOCs associated with Group 1 (and 2)\n\nThe list of IOCs provided is a combination of the drop servers as well as the injection servers; both can\nhave overlap (a drop server functioning to deliver injections as well). Additionally, this list of IOCs contains\nthe domains associated with the reshipping companies that were operated by this group\n\nURL: https://community.riskiq.com/projects/44bd58f7-d24c-7092-7db4-0271bd4fc6c6\n\n###### IOCs associated with Group 3\n\nThe list of IOCs provided is a combination of the drop servers as well as the injection servers; both can\nhave overlap (a drop server functioning to deliver injections as well).\n\nURL: https://community.riskiq.com/projects/48b09759-49f9-c1a9-d1bb-dee04ae6155e\n\n###### IOCs associated with Group 4\n\nThe list of IOCs provided is a combination of the drop servers as well as the injection servers; both can\nhave overlap (a drop server functioning to deliver injections as well).\n\nURL: https://community.riskiq.com/projects/281cd3d6-96ab-9262-fb36-edb4d5bfaf37\n\n###### IOCs associated with Group 5\n\nThe list of IOCs provided includes the drop servers used by this group because its MO is to abuse thirdparty services to add their skimmer code. For this reason, we do not have injection-server IOCs.\n\nURL: https://community.riskiq.com/projects/33f9475f-c0c7-39f8-598a-11ec689b9d2b\n\n###### IOCs associated with Group 6\n\nThe list of IOCs provided includes the drop servers used by this group because its MO is to add its skimmer\ndirectly into the payment process of their victims. For this reason, we do not have injection-server IOCs.\n\nURL: https://community.riskiq.com/projects/bcc6e10d-c3e2-c9d8-8dde-c885b3ab173b\n\n\n-----\n\n###### IOCs associated with Group 7\n\nSadly as Group 7 does not own its infrastructure we currently do not have IOCs to share. More importantly,\nthe subsection on the skimmer for Group 7 contains information of what it looks like on pages; this\ninformation can be used to identify Group 7.\n\n###### IOCs associated with Brand Impersonation Card Skimmer\n\nThe list of IOCs are domains hosting fake stores and the drop server along with hosting infrastructure to\nwhich skimmed card data is dropped.\n\nURL: https://community.riskiq.com/projects/854679ea-9445-9582-2d88-56961073ae38\n\n\n-----\n\n###### About RiskIQ\n\n RiskIQ is the leader in digital threat management, providing the most comprehensive discovery, intelligence, and mitigation of threats associated with an organization’s digital presence. With more than 75 percent of attacks originating outside the firewall, RiskIQ allows enterprises to gain unified insight and control over web, social and mobile exposures. Trusted by tens of thousands of security analysts, security teams and CISO’s, RiskIQ’s platform combines advanced internet data reconnaissance and analytics to expedite investigations, understand digital attack surfaces, assess risk and take action to protect the business, brand and customers. Based in San Francisco, the company is backed by Summit Partners, Battery Ventures, Georgian Partners and MassMutual Ventures. Visit https://www.riskiq.com or follow us on Twitter. Try RiskIQ Community Edition for free by visiting https://www.riskiq.com/community/.\n\n About Flashpoint\n\n Flashpoint delivers Business Risk Intelligence (BRI) to empower organizations worldwide with meaningful intelligence and information that combats threats and adversaries. The company’s sophisticated technology, advanced data collections, and human-powered analysis uniquely enables large enterprises and the public sector to bolster cybersecurity, confront fraud, detect insider threats and build insider threat programs, enhance physical security, improve executive protection, and address vendor risk and supply chain integrity. Flashpoint is backed by Georgian Partners, Greycroft Partners, TechOperators, K2 Intelligence, Jump Capital, Leaders Fund, Bloomberg Beta, and Cisco Investments. For more information, visit  https://www.flashpoint-intel.com/ or follow us on Twitter at @FlashpointIntel.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "5910e58f-4bc9-4e4e-9dbb-887804094a01",
            "created_at": "2022-10-25T16:32:58.457399Z",
            "updated_at": "2022-10-25T16:32:58.457399Z",
            "deleted_at": null,
            "name": "OTX",
            "url": "https://otx.alienvault.com",
            "description": "Alienvault Open Threat Exchange (OTX)",
            "reports": null
        }
    ],
    "references": [
        "https://cdn.riskiq.com/wp-content/uploads/2018/11/RiskIQ-Flashpoint-Inside-MageCart-Report.pdf"
    ],
    "report_names": [
        "RiskIQ-Flashpoint-Inside-MageCart-Report.pdf"
    ],
    "threat_actors": [
        {
            "id": "67bf0462-41a3-4da5-b876-187e9ef7c375",
            "created_at": "2022-10-25T16:07:23.44832Z",
            "updated_at": "2025-03-27T02:02:09.806007Z",
            "deleted_at": null,
            "main_name": "Careto",
            "aliases": [
                "Careto",
                "The Mask",
                "Ugly Face"
            ],
            "source_name": "ETDA:Careto",
            "tools": [
                "Careto"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "77b28afd-8187-4917-a453-1d5a279cb5e4",
            "created_at": "2022-10-25T15:50:23.768278Z",
            "updated_at": "2025-03-27T02:00:55.5423Z",
            "deleted_at": null,
            "main_name": "Inception",
            "aliases": [
                "Inception Framework",
                "Cloud Atlas"
            ],
            "source_name": "MITRE:Inception",
            "tools": [
                "PowerShower",
                "VBShower",
                "LaZagne"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "aa73cd6a-868c-4ae4-a5b2-7cb2c5ad1e9d",
            "created_at": "2022-10-25T16:07:24.139848Z",
            "updated_at": "2025-03-27T02:02:10.120505Z",
            "deleted_at": null,
            "main_name": "Safe",
            "aliases": [],
            "source_name": "ETDA:Safe",
            "tools": [
                "DebugView",
                "LZ77",
                "OpenDoc",
                "SafeDisk",
                "TypeConfig",
                "UPXShell",
                "UsbDoc",
                "UsbExe"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "5a0483f5-09b3-4673-bb5a-56d41eaf91ed",
            "created_at": "2023-01-06T13:46:38.814104Z",
            "updated_at": "2025-03-27T02:00:02.925972Z",
            "deleted_at": null,
            "main_name": "MageCart",
            "aliases": [],
            "source_name": "MISPGALAXY:MageCart",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "761d1fb2-60e3-46f0-9f1c-c8a9715967d4",
            "created_at": "2023-01-06T13:46:38.269054Z",
            "updated_at": "2025-03-27T02:00:02.789278Z",
            "deleted_at": null,
            "main_name": "APT3",
            "aliases": [
                "TG-0110",
                "Group 6",
                "Buckeye",
                "Boyusec",
                "BORON",
                "BRONZE MAYFAIR",
                "Red Sylvan",
                "GOTHIC PANDA"
            ],
            "source_name": "MISPGALAXY:APT3",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "ee3363a4-e807-4f95-97d8-b603c31b9de1",
            "created_at": "2023-01-06T13:46:38.485884Z",
            "updated_at": "2025-03-27T02:00:02.845851Z",
            "deleted_at": null,
            "main_name": "FIN6",
            "aliases": [
                "Camouflage Tempest",
                "MageCart Group 6",
                "G0037",
                "TA4557",
                "SKELETON SPIDER",
                "ITG08",
                "White Giant",
                "GOLD FRANKLIN",
                "ATK88"
            ],
            "source_name": "MISPGALAXY:FIN6",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "cf7fc640-acfe-41c4-9f3d-5515d53a3ffb",
            "created_at": "2023-01-06T13:46:38.228042Z",
            "updated_at": "2025-03-27T02:00:02.775905Z",
            "deleted_at": null,
            "main_name": "APT1",
            "aliases": [
                "GIF89a",
                "G0006",
                "PLA Unit 61398",
                "Group 3",
                "TG-8223",
                "Comment Group",
                "ShadyRAT",
                "COMMENT PANDA",
                "Comment Crew",
                "Byzantine Candor",
                "Brown Fox"
            ],
            "source_name": "MISPGALAXY:APT1",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "b3acfb48-b04d-4d3d-88a8-836d7376fa2e",
            "created_at": "2024-06-19T02:03:08.052814Z",
            "updated_at": "2025-03-27T02:05:17.368029Z",
            "deleted_at": null,
            "main_name": "GOLD FRANKLIN",
            "aliases": [
                "ITG08 ",
                "MageCart Group 6 ",
                "Skeleton Spider ",
                "White Giant ",
                "FIN6 "
            ],
            "source_name": "Secureworks:GOLD FRANKLIN",
            "tools": [
                " Metasploit",
                " Meterpreter",
                " Mimikatz",
                " PowerSploit",
                " PowerUpSQL",
                " RemCom",
                "FrameWorkPOS"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "3fff98c9-ad02-401d-9d4b-f78b5b634f31",
            "created_at": "2023-01-06T13:46:38.376868Z",
            "updated_at": "2025-03-27T02:00:02.818071Z",
            "deleted_at": null,
            "main_name": "Cleaver",
            "aliases": [
                "Cobalt Gypsy",
                "G0003",
                "Operation Cleaver",
                "Op Cleaver",
                "Tarh Andishan",
                "Alibaba",
                "TG-2889"
            ],
            "source_name": "MISPGALAXY:Cleaver",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "ea7bfe06-7c23-481d-b8ba-eafa6cda3bc9",
            "created_at": "2022-10-25T15:50:23.317961Z",
            "updated_at": "2025-03-27T02:00:55.440858Z",
            "deleted_at": null,
            "main_name": "FIN6",
            "aliases": [
                "FIN6",
                "Magecart Group 6",
                "ITG08",
                "Skeleton Spider",
                "TAAL",
                "Camouflage Tempest"
            ],
            "source_name": "MITRE:FIN6",
            "tools": [
                "FlawedAmmyy",
                "GrimAgent",
                "FrameworkPOS",
                "More_eggs",
                "Cobalt Strike",
                "Windows Credential Editor",
                "AdFind",
                "PsExec",
                "LockerGoga",
                "Ryuk",
                "Mimikatz"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "06f622cb-3a78-49cf-9a4c-a6007a69325f",
            "created_at": "2022-10-25T16:07:23.315239Z",
            "updated_at": "2025-03-27T02:02:09.733197Z",
            "deleted_at": null,
            "main_name": "APT 3",
            "aliases": [
                "APT 3",
                "Bronze Mayfair",
                "Buckeye",
                "Gothic Panda",
                "Group 6",
                "Operation Clandestine Fox",
                "Operation Clandestine Fox, Part Deux",
                "Operation Clandestine Wolf",
                "Operation Double Tap",
                "Red Sylvan",
                "TG-0110",
                "UPS Team"
            ],
            "source_name": "ETDA:APT 3",
            "tools": [
                "APT3 Keylogger",
                "Agent.dhwf",
                "BKDR_HUPIGON",
                "Backdoor.APT.CookieCutter",
                "Badey",
                "Bemstour",
                "CookieCutter",
                "Destroy RAT",
                "DestroyRAT",
                "DoublePulsar",
                "EXL",
                "EternalBlue",
                "HTran",
                "HUC Packet Transmit Tool",
                "Hupigon",
                "Hupigon RAT",
                "Kaba",
                "Korplug",
                "LaZagne",
                "MFC Huner",
                "OSInfo",
                "Pirpi",
                "PlugX",
                "RedDelta",
                "RemoteCMD",
                "SHOTPUT",
                "Sogu",
                "TIGERPLUG",
                "TTCalc",
                "TVT",
                "Thoper",
                "Xamtrav",
                "remotecmd",
                "shareip",
                "w32times"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "3aaf0755-5c9b-4612-9f0e-e266ef1bdb4b",
            "created_at": "2022-10-25T16:07:23.480196Z",
            "updated_at": "2025-03-27T02:02:09.826059Z",
            "deleted_at": null,
            "main_name": "Comment Crew",
            "aliases": [
                "APT 1",
                "BrownFox",
                "Byzantine Candor",
                "Byzantine Hades",
                "Comment Crew",
                "Comment Panda",
                "GIF89a",
                "Group 3",
                "Operation Oceansalt",
                "Operation Seasalt",
                "Operation Siesta",
                "Shanghai Group",
                "TG-8223"
            ],
            "source_name": "ETDA:Comment Crew",
            "tools": [
                "Auriga",
                "Cachedump",
                "Chymine",
                "CookieBag",
                "Darkmoon",
                "GDOCUPLOAD",
                "GLOOXMAIL",
                "GREENCAT",
                "Gen:Trojan.Heur.PT",
                "GetMail",
                "Hackfase",
                "Hacksfase",
                "Helauto",
                "Kurton",
                "LETSGO",
                "LIGHTBOLT",
                "LIGHTDART",
                "LOLBAS",
                "LOLBins",
                "LONGRUN",
                "Living off the Land",
                "Lslsass",
                "MAPIget",
                "ManItsMe",
                "Mimikatz",
                "MiniASP",
                "Oceansalt",
                "Pass-The-Hash Toolkit",
                "Poison Ivy",
                "ProcDump",
                "Riodrv",
                "SPIVY",
                "Seasalt",
                "ShadyRAT",
                "StarsyPound",
                "TROJAN.COOKIES",
                "TROJAN.FOXY",
                "TabMsgSQL",
                "Tarsip",
                "Trojan.GTALK",
                "WebC2",
                "WebC2-AdSpace",
                "WebC2-Ausov",
                "WebC2-Bolid",
                "WebC2-Cson",
                "WebC2-DIV",
                "WebC2-GreenCat",
                "WebC2-Head",
                "WebC2-Kt3",
                "WebC2-Qbp",
                "WebC2-Rave",
                "WebC2-Table",
                "WebC2-UGX",
                "WebC2-Yahoo",
                "Wordpress Bruteforcer",
                "bangat",
                "gsecdump",
                "pivy",
                "poisonivy",
                "pwdump",
                "zxdosml"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1666716491,
    "ts_updated_at": 1743041813,
    "ts_creation_date": 1541581550,
    "ts_modification_date": 1541581564,
    "files": {
        "pdf": "https://archive.orkl.eu/37fb4bfd4dd3010f5f23e7af93412e06dbfd02c6.pdf",
        "text": "https://archive.orkl.eu/37fb4bfd4dd3010f5f23e7af93412e06dbfd02c6.txt",
        "img": "https://archive.orkl.eu/37fb4bfd4dd3010f5f23e7af93412e06dbfd02c6.jpg"
    }
}