{
    "id": "8b80a0c9-9e01-4c54-94c1-fcb07c1983b2",
    "created_at": "2023-01-12T15:06:23.533613Z",
    "updated_at": "2025-03-27T02:09:58.787542Z",
    "deleted_at": null,
    "sha1_hash": "8509f4f8732dbad5341b3aebbe52e75d366760c1",
    "title": "2020-10-13 - Overcoming the Challenges of Detecting P2P Botnets on Your Network",
    "authors": "",
    "file_creation_date": "2022-05-28T17:38:49Z",
    "file_modification_date": "2022-05-28T17:38:49Z",
    "file_size": 5234179,
    "plain_text": "# Overcoming the Challenges of Detecting P2P Botnets on Your Network\n\n**[nozominetworks.com/blog/overcoming-the-challenges-of-detecting-p2p-botnets-on-your-network/](https://www.nozominetworks.com/blog/overcoming-the-challenges-of-detecting-p2p-botnets-on-your-network/)**\n\nBy October 13, 2020\n\nIn the first six months of 2020, the Mozi, DDG and FritzFrog botnets were very active, and\nexhibiting some pretty interesting behaviors.\n\nThreat actors use peer-to-peer (P2P) botnets like these to build a platform that can later be\nused to carry out malicious operations, such as large-scale Distributed Denial of Service\n(DDoS) or mining for crypto currencies.\n\nEarly-generation botnets followed a client-server model for command and control (C&C),\nmaking use of popular protocols like IRC and HTTP, or implementing custom ones. However,\nthe simplicity of this architecture offered little resilience.\n\nAnalyzing the new architectural designs of recent botnets can help us understand emerging\nbotnet techniques, and how to use network artifacts to detect and mitigate their activity.\n\nTo increase their resiliency, botnet operators are now using a hybrid approach where some\nnodes have special roles, but they’re not absolutely critical to the botnet’s survival.\n\n\n-----\n\n## Recent Evolution of Botnet Platforms\n\nOne of the first countermeasures taken by botnet operators to address the architectural\nweaknesses involved relying on so-called bulletproof hosting. In laymen’s terms, it meant\nfinding a hosting provider willing to turn a blind eye to client activity.\n\nA second, often complementary solution involved using Domain Generating Algorithms\n(DGAs) as failsafes for situations where the C&C became unreachable. This technique\nconsisted of embedding an algorithm within the bot to generate a series of domains that the\nmalware would attempt to contact. The operator of the botnet only needed to register one of\nthese domains and make it accessible to the bots.\n\nThis new situation, where the C&C could change over time, also meant that each and every\nbot required a strategy to verify the identity of the controller. To avoid hostile takeovers,\nbotnets started relying on digital signatures to validate each command received from the\nnetwork or a configuration update.\n\nThe need for increased takedown resistance eventually drove botnet operators to adapt and\nexplore peer-to-peer approaches. A further evolution involved using a hybrid model, rather\nthan a pure peer-to-peer model. In a P2P hybrid network topology, the botnet can survive a\ntakedown of nodes with specialized roles, and reorganize itself accordingly.\n\n## Why Peer-to-peer Botnets Are Challenging to Disrupt\n\nIn general, it can be quite challenging to disrupt the malicious activities of P2P botnets. Take,\nfor example, the effort coordinated by Microsoft in March 2020. The company called on its1\ntechnical and legal partners in 35 countries to disrupt Necurs, a popular hybrid peer-to-peer\nbotnet.\n\nAccording to Microsoft: “This was accomplished by analyzing a technique used by Necurs to\nsystematically generate new domains through an algorithm. We were then able to accurately\npredict over six million unique domains that would be created in the next 25 months.\nMicrosoft reported these domains to their respective registries in countries around the world\nso the websites can be blocked and thus prevented from becoming part of the Necurs\ninfrastructure. By taking control of existing websites and inhibiting the ability to register new\nones, we have significantly disrupted the botnet.”\n\nWhile dismantling a peer-to-peer botnet might not be feasible for the average organization,\nthere is still a lot that your security teams can do.\n\nStart by considering the three main phases used by botnets, and where network artifacts are\ntypically left behind:\n\n**Bot deployment: this is where the bot is deployed into a target system member of the**\nnetwork, for instance through an exploit, or by brute-forcing the credentials\n\n\n-----\n\n**Communication with the peer-to-peer botnets: this occurs during peer discovery,**\nconfiguration updates and while receiving commands\n**Malicious activity: the actual malicious activity the botnet was created for, such as**\nsending spam, distributing ransomware or bot propagation towards other systems\n\nUsing the right tools, your security teams can detect and disrupt botnet activity. To better\nunderstand these concepts, let’s look into some practical examples.\n\n## DDG Botnet\n\nDDG is a mining botnet that has been extensively documented by the researchers at 360\nNetlab. While DDG originally used DNS for command and control, it now uses a hybrid2\npeer-to-peer model to control the nodes in its network. DDG’s method of infection involves\nbrute-forcing the root user password against SSH servers using a significantly large wordlist.\nAlternatively, DDG uses exploits against Redis, Nexus Repository Manager and Supervisord.\n\nOne of the first noticeable anomalies occurs when DDG receives its configuration from a\nsuper node by leveraging HTTP on non-standard ports. Another interesting and useful\ncharacteristic for tracking down DDG is the use of a domain that was never resolved through\nthe DNS, in the HTTP host header.\n\nOne of the first noticeable anomalies occurs when DDG receives its configuration from a\nsuper node by leveraging HTTP on non-standard ports.\n\nDDG Detection Tool: The Snort rule below, provided by the Nozomi Networks Labs team,\ncan be used freely by the security community to detect DDG activity:\n\n\n-----\n\n```\n# Nozomi Networks Labs\nalert tcp any any -> any 8000 (msg:\"Detected DDG botnet traffic.\";\ncontent:\"POST\"; http_method; content:\"|2f 73 6c 61 76 65|\"; http_uri;\ncontent:\"User-Agent: Go-http-client/\"; fast_pattern; http_header;\ncontent:\"X-Hub\"; http_header; content:\"X-Uid\"; http_header; content:\"XPort\"; http_header; content:\"X-Relay\"; http_header; content:\"Uid\";\nhttp_header; content:\"Content-Length: 0\"; http_header;)\n\n## FritzFrog Botnet\n\n```\nFritzFrog is another example of a recently discovered peer-to-peer botnet. It is written in the\nGo programming language and relies on SSH credential brute-forcing as its propagation\nmechanism. The rate at which it is targeting SSH on standard and non-standard (2222) tcp\nports makes FritzFrog a pretty noisy bot.\n\nTo detect the anomalous network behavior, we don’t need FritzFrog to find an open SSH\nserver and try several credentials. The raw number of connection attempts alone is sufficient,\nas you can see in the Wireshark screenshots below.\n\nThe raw number of FritzFrog botnet connection attempts are sufficient to detect its\nanomalous OT network behavior.\n\n\n-----\n\n## Mozi Botnet\n\nThe Mozi malware family makes use of a custom P2P protocol built on top of Distributed\nHash Tables (DHT) in order to build a network of infected nodes. DHT is typically used by\nBitTorrent clients to identify peers using a key (infohash), so at first glance, Mozi’s\ncommunication can hide among what looks like normal DHT traffic. Additionally, to bootstrap\nthe overlay network, Mozi relies on well-known BitTorrent nodes such as\nrouter.bittorrent.com, as shown in the screenshot below.\n\nMozi botnet attempts to guess credentials and initiate a number of connections to hosts not\npreviously seen in the network, leaving a noticeable trail.\n\nThere are ARM and MIPS variants of the Mozi malware. Like most botnets targeting IoT\ndevices, Mozi uses weak Telnet credential brute-forcing as a way to propagate. Additionally,\na number of exploits affecting IoT devices such as CCTV, DVR, NVR and routers are\nincluded as a supplemental infection method.\n\nThe HTTP requests format strings above are a subset of the exploits that Mozi samples\n[include and use. Specifically, these malicious requests target CCTV/DVR RCE,](https://www.exploit-db.com/exploits/39596) MVPower\nDVR Shell Unauthenticated Command Execution and [Vacron NVR RCE.](https://ssd-disclosure.com/ssd-advisory-vacron-nvr-remote-command-execution/)\n\n\n-----\n\nThe communication with the peer-to-peer botnet through DHT might not be trivial to\ninvestigate in a network where DHT is allowed. However, its attempts to guess credentials\nand initiate a number of connections to hosts not previously seen in the network leave a\nnoticeable trail.\n\n## More Free Security Community Tools from Nozomi Networks Labs\n\nWe hope you’ve found our exploration of the architectural designs typically employed by\nbotnet operators helpful. The important takeaway is that these operations, by their very\nnature, give security defenders multiple starting points for investigating the network artifacts\nthey leave behind.\n\nTo learn more about defending your OT network against botnets, please watch the webinar\n[below, “P2P Botnets: Following the Network Trail.”](https://www.youtube.com/watch?v=ZA1RZSicUR4)\n\nTo tap into additional security community resources including threat advisories, security\nreports, podcasts, and other free tools developed by the Nozomi Networks Labs Security\n[Research team, subscribe to Nozomi Networks Labs.](https://www.nozominetworks.com/blog/overcoming-the-challenges-of-detecting-p2p-botnets-on-your-network/www.nozominetworks.com/labs)\n\n**Related Content**\n\nWEBINAR & PODCAST\n\n## P2P Botnets: Following the Network Trail\n\n\n-----\n\n[Webinar](https://www.youtube.com/watch?v=ZA1RZSicUR4)\n[Podcast](https://www.buzzsprout.com/1012066/6226174-p2p-botnets-following-the-network-trail)\nIt can be challenging to disrupt the malicious activities of P2P botnets, but there are some\nproven strategies to follow when a specific network has been affected.\n\n**Join us to learn about:**\n\nHow P2P/hybrid botnets operate\nSpotting P2P/hybrid botnet infections on your network\nEffective ways to disrupt botnets\n\n**Panelists**\n\nIvan Speziale, Security Researcher\nGiannis Tsaraias, Security Researcher\nChris Grove, Technology Evangelist\n\n**Related Links**\n\n[Research Report: OT/IoT Security Report 2020](https://info.nozominetworks.com/ot-iot-security-report-1h-lp-0)\nBlog: [CISA-Sponsored CVE Program Grants Nozomi Networks CNA Status](https://www.nozominetworks.com/blog/cisa-sponsored-cve-program-grants-nozomi-networks-cna-status/)\nBlog: [Your Guide to the MITRE ATT&CK Framework for ICS](https://www.nozominetworks.com/blog/your-guide-to-the-mitre-attack-framework-for-ics/)\nWebinar: How to Use the MITRE ATT&CK Framework for ICS\n[Webpage: Nozomi Networks Labs](https://www.nozominetworks.com/labs/)\n[Webpage: Guardian OT and IoT Security and Visibility](https://www.nozominetworks.com/products/guardian/)\n[Webpage: Threat Intelligence](https://www.nozominetworks.com/products/threat-intelligence/)\n\n**References:**\n\n1. Blog: “New action to disrupt world’s largest online criminal network,” Microsoft, March\n\n202\n2. Blog: “DDG: A Collection of 14 Posts,” Netlab360.com\n\n[Alessandro Di Pinto](https://www.nozominetworks.com/author/alessandro-dipinto/)\n**Security Research Manager, Nozomi Networks**\n**[@adipinto](https://twitter.com/adipinto)**\n\nAlessandro Di Pinto is an Offensive Security Certified Professional (OSCP) with an extensive\nbackground in malware analysis, ICS/SCADA security, penetration testing and incident\nresponse. He holds GIAC Reverse Engineering Malware (GREM) and GIAC Cyber Threat\n\n\n-----\n\nIntelligence (GCTI) certifications. Alessandro co-authored the research paper TRITON: The\nFirst ICS Cyber Attack on Safety Instrument Systems” and “Analyzing the GreyEnergy\nMalware: from Maldoc to Backdoor”.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2020/2020-10-13 - Overcoming the Challenges of Detecting P2P Botnets on Your Network.pdf"
    ],
    "report_names": [
        "2020-10-13 - Overcoming the Challenges of Detecting P2P Botnets on Your Network.pdf"
    ],
    "threat_actors": [
        {
            "id": "4d9cdc7f-72d6-4e17-89d8-f6323bfcaebb",
            "created_at": "2023-01-06T13:46:38.82716Z",
            "updated_at": "2025-03-27T02:00:02.928984Z",
            "deleted_at": null,
            "main_name": "GreyEnergy",
            "aliases": [],
            "source_name": "MISPGALAXY:GreyEnergy",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673535983,
    "ts_updated_at": 1743041398,
    "ts_creation_date": 1653759529,
    "ts_modification_date": 1653759529,
    "files": {
        "pdf": "https://archive.orkl.eu/8509f4f8732dbad5341b3aebbe52e75d366760c1.pdf",
        "text": "https://archive.orkl.eu/8509f4f8732dbad5341b3aebbe52e75d366760c1.txt",
        "img": "https://archive.orkl.eu/8509f4f8732dbad5341b3aebbe52e75d366760c1.jpg"
    }
}