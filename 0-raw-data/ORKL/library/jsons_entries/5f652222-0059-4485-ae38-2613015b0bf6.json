{
    "id": "5f652222-0059-4485-ae38-2613015b0bf6",
    "created_at": "2023-01-12T15:09:35.391342Z",
    "updated_at": "2025-03-27T02:15:35.474311Z",
    "deleted_at": null,
    "sha1_hash": "2c45876883bc2c53a0f0e07fcfc910e34c1159be",
    "title": "2019-10-14 - Is Emotet gang targeting companies with external SOC-",
    "authors": "",
    "file_creation_date": "2022-05-28T17:54:24Z",
    "file_modification_date": "2022-05-28T17:54:24Z",
    "file_size": 2350352,
    "plain_text": "# Is Emotet gang targeting companies with external SOC?\n\n**[marcoramilli.com/2019/10/14/is-emotet-gang-targeting-companies-with-external-soc/](https://marcoramilli.com/2019/10/14/is-emotet-gang-targeting-companies-with-external-soc/)**\n\nView all posts by marcoramilli October 14, 2019\n\n## Introduction\n\n[The group behind Emotet malware is getting smarter and smarter in the way the deliver such a Malware. While](https://marcoramilli.com/2019/04/05/step-by-step-office-dropper-dissection/)\nthe infection schema looks alike from years; the way the group tries to infect victims improves from day to day.\n\nToday I’d like to share a quick analysis resulted by a very interesting email which claimed to deliver a SOC\n**“weekly report” on the victim email. First of all the attacker knew the target organization was protected by a SOC**\n(Security Operation Center) so she sent a well crafted email claiming to deliver a Microsoft document wrapping\nout the weekly SOC report as a normal activity in order to induce the victim to open-it.\n\n**SOC report 10 12 2019.doc (** `6125489453c1824da3e28a54708e7c77875e500dd82a59c96c1d1e5ee88dcad7 ) is`\nthe delivered file sent on Oct 11, 2019, 11:06:09 PM from `grecia@ambientehomedecor.com . I believe that`\n```\nambientehomedecor.com is not a malicious domain but mostly a new compromised one.\n\n## Technical Analysis\n\n```\nHash 6125489453c1824da3e28a54708e7c77875e500dd82a59c96c1d1e5ee88dcad7\n\nThreat Word document Dropper (Emotet)\n\nBrief Description First stage of Emotet campaign targeting organization with Security Operation Centers\n\n\n-----\n\nSsdeep 6144:tkPNPASKUzSRnLx3Q4td9pB8LGme764XNNHBly:tkPNPAfUGRt3b3B8LGL6CNJ\n\nFollowing the original eMail headers from `grecia@ambientehomedecor.com to victim’s email box it is possible to`\nfigure-out the attacker used a SMPT client who left trace about the original sender IP address which happens to\nbe: `81.48.36.59 . According to IPLocation that address is related to a very nice town in northern France: Thury-`\nHarcourt, France.\n\nThury-Harcourt, France. Sender IP\nThe attached document is a well obfuscated Microsoft Word document which asks to enable macros in order to\nview its content. The `autoopen function begins a complex obfuscated chain which tries to deter analyst by`\nintroducing junk code, junk variable assignments and fake apparent real comments. The following image proves\nthe adopted obfuscation technique. The function `c878cxx90590 is the “Real Code” by meaning is not part of`\njunk code but actually is the function who really performs malicious actions. As you might see being in the middle\nof hundreds similar lines of code it gets hard to spot.\n\nObfuscated Macro\n\n\n-----\n\nThe obfuscated macro creates on memory objects and runs them without passing through temporary files. The\nfollowing image shows the auto-run created object before the Drop’n Execute. The analysed variable in the\nfollowing image is the `c0639047895c6 which, in that specific run, holds the Win32_ProcessStartup created`\nObject for fulfill persistence on the victim machine.\n\nObject Building\nOnce the dropper assured the persistence and to run during the start-up, it carves from itself the following\npowershell script. The script runs an encoded string hiding the dropping ULRs. The base64 decoded string shows\na romantic `foreach statement looping through a list of compromised websites hosting the real payload :`\n```\nde6a8b8612b5236a18eea1a6a8f53e117d046cf2ad95e079a6715af68f8d2216 (VT 6/69). It finally saves the\n\n```\ndropped file in a userprofile location as placed in the variable `xc0x57b38b2x7, before running it. The following`\nimage shows the powershell script before and after the encoding by giving a quick description on it.\n\n\n-----\n\nFinal Deobfuscated Dropper\nAccording to VT, the final run looks like Emotet, a banking trojan who steals credentials, cookies and eCoin\nwallets. Emotet is also able to access to saved credentials of the major browser like Chromium, Firefox, Opera,\nVivaldi to exfiltrate cookies, and to send back to command and control found victim information. But let’s try to\nquickly check it.\n\n### Analysis of dropped and executed file (emotet)\n\nHash de6a8b8612b5236a18eea1a6a8f53e117d046cf2ad95e079a6715af68f8d2216\n\nThreat Emotet. Data Exfiltration\n\n\nBrief\nDescription\n\n\nDropped and Executed by previous stage\n\n\nSsdeep 3072:2xUIvfl2nnKJFddS2TZGjRurmOEfRtaG/70Jfm4JuLYwO9/+Tl:2lvfUnKJFddhAjYrmOEpzcflQu1+\n\nThe dropped file (VT 12/69), grabbed from the dropping URLs inside the previous powershell script, is an\nexecutable packed by internal functions which uses several techniques to avoid static and dynamic analysis. For\nexample it deletes the original file once executed, it resolves an unusual very high number of APIs and it\ndynamically resolves functions avoiding static analysis.\n\n\n-----\n\nEmotet Depacked\nDuring the running phase the analyzed sample records many information on the hosting machine, it asks for local\npublic IP address by querying an external resource: http[://185[.42[.221[.78:443/whoami.php and finally it pushes\nout those information to external Command and Control (please refer to IoC section for the complete C2 list).\n\nRecorded Information\nThe sample starts a local service called `khmerdefine and assures its persistence by adding that file in`\n```\nc:\\Windows\\SysWOW64 and setting up a system service in autorun. AV and plenty static traffic signatures confirm\n\n```\nwe are facing a new encrypted version of Emotet trojan.\n\n## Conclusion\n\nEmotet gang is getting smarter and smarter in delivery artifacts. That time they addressed companies having an\nexternal Security Operation Center (SOC) pretending to simulate an external SOC operator who sends periodic\nreports to the company. The delivery content was a Microsoft word document within heavily obfuscated Macros\nwho eventually drops and executes Emotet Malware. The following image represent the compiled MITRE\nATT&CK matrix in order to qualify stages and to describe the overall behavior.\n\nMITRE ATT&CK\n\n## IoC\n\n\n-----\n\nemail:\ngrecia@ambientehomedecor.com\n\nHash:\n6125489453c1824da3e28a54708e7c77875e500dd82a59c96c1d1e5ee88dcad7 (.doc)\nde6a8b8612b5236a18eea1a6a8f53e117d046cf2ad95e079a6715af68f8d2216 (.exe)\nDrop URLs:\nhttp[://xsnonline[.us/blogs/4x466v/\nhttp[://obbydeemusic[.com/aqoeivj4fd/us5htvn/\nhttp[://veeplan[.com/wp-content/dW0o3RoJNG/\nhttp[://wwwkmacobd[.com/u9r/\nhttp[://aijdjy[.com/dup-installer/t0/\n\nC2 (Emotet):\nhttp[://186[.75[.241[.230/cone/loadan/splash/merge/\nhttp[://186[.75[.241[.230/results/json/\nhttp[://186[.75[.241[.230/balloon/json/\nhttp[://186[.75[.241[.230/enable/arizona/splash/merge/\nhttp[://186[.75[.241[.230/acquire/\nhttp[://181[.143[.194.[138:443/health/splash/sess/merge/\nhttp[://85[.104[.59[.244:20/enable/rtm/sess/merge/\n\n## Yara Rules\n\n\n-----\n\n```\n       _ _ {\n  meta:\n   date = \"2019-10-13\"\n   hash1 = \"de6a8b8612b5236a18eea1a6a8f53e117d046cf2ad95e079a6715af68f8d2216\"\n  strings:\n   $x1 = \"c:\\\\Users\\\\User\\\\Desktop\\\\2003\\\\Efential\\\\Release\\\\EFENTIAL.pdb\" fullword ascii\n   $s2 = \"EFENTIAL.exe\" fullword ascii\n   $s3 =\n\"ZNtlsIkbp2bxIIBXLbRtd3e85g7mJ73gSFPnybocDj/xsKVPWxzllXY/FdB150/ewzkkdzDw5VMbiVfS/SPd0FlXp+VqpDpPDXxNH3cc9\n ascii\n   $s4 =\n\"tblJgbnpgZmZCaHxmfEpoaS9Cb31DfHpZfVJobW5SYG56YGZmQmh8ZnxKaGkvQm99Q3x6WX1SaG1uUmBuemBmZkJofGZ8SmhpL0JvfUN8\n ascii /* base64 encoded string\n'nR`nz`ffBh|f|Jhi/Bo}C|zY}RhmnR`nz`ffBh|f|Jhi/Bo}C|zY}RhmnR`nz`ffBh|f|Jhi/Bo}C|zY}RhmnR`nz`ffBh|' */\n   $s5 =\n\"C9813Hcfx1BkY3VrYVwfB4tWs+/Eb93UVwdvrbdywicNqMdPSiMzJFXbZbSLG6cDA/O9Vy2ob3d3PeVLcie95EpT50oKkSE/8bynT1sLO\n ascii\n   $s6 =\n\"G+MfTPu8J3chkKdvVwmN7R/fNdx3H8cxWUFva2FcHweLIPfrnG/d1FcHb/FxEOQnDajHT0qu26c122W0ixunZpkE2lctqG93dy4Z7jMnv\n ascii\n   $s7 =\n\"RSVloG9h6HM56NP1tCMFZKs69gEEW+JoiOCz9U3uI3uYsb+mL2+97Wf903wpFDCKiBjjtt/TznbwXOcnHS87rh7rG4N2wHiRqPj2AReKM\n ascii\n   $s8 =\n\"iOC7W7cnZWhtQTw5nu3bSa/eHxvVFB3RfZP9CFkKs3KWazNkXJPk+HTPmTvpWFcnpLn2DUFtp2v1ELP9acqRoKOXIXMJCNtYpiEdTEP7n\n ascii\n   $s9 =\n\"6RzgkjSOWDNk6FtXIb1gBQ0oTx93sMelCVJYrG9ZEJB07FiwoYhZkKiSkNh3DQweyOCz9UXEmKjkHOXYfeRY2qT4p4UUBtCIA0+o00Fj/\n ascii\n   $s10 =\n\"StOEJiPbZbiKG6dLTcWrVy28bnd3MRHI6Se9+EtT5xnfnbI/8aimT1vHvvS1PxXYdudP5QazN3cw+OZTG6WMoPkj3ehaV6ftpUvyTw1ET\n ascii\n   $s11 =\n\"mQOhiAgYsPyI4DhFgdYtLdGQ1W9Bxmd6m3lnTJcfr4gYGLD8iOA41oOuIaXdCNnnTaphWJ1HYWqR+qqIKBiwmIjgOPiFFCgT1NbQLUTYb\n ascii\n   $s12 =\n\"Jd812HQfx5Qv5tVrYSAcB4t1CVi1b93QVAdvpSmDyCcNpMRPSpcCbzzbZbCIG6fu/FMSVy20bHd3ShSspye94ElT56m+fUo/8bCkT1t+M\n ascii\n   $s13 =\n\"f64odyFEoG9XrrnC4d81EHAfx9MLlPdrYegYB4s9h95Cb91oUAdvuYg3nCcNHMBPSk5z9mnbZfiNG6fklZhYVy38aXd3FwtmSie9uExT5\n ascii\n   $s14 =\n\"G5WtAP8+00dbvQhs6PgZzXSo8WjM1YD2S2wk9prpUJn8oG0I4laYrNKGZTi4kPTVMKbGcImVZllhx5Tj+amkWDhXp2+bKhvFcO9Gasz1g\n ascii\n   $s15 =\n\"3ie9qEhT593fXyw/8filT1s1hgetPxWodedPR5foK3cwiOVTG/Eyi+Yj3ZhZV6cVyoNtTw00TR93mxbYI2udnBnjHxLYp+x3IZylb1e4q\n ascii\n   $s16 =\n\"RpFqNpYQapubxqPNu6yDXrsXC6qB7CzF0GzVj0FjbT6RdW15ncWnY7/vh92xHgE5j7MjB9mZ3mVK5FiwlKhYoKj4kIq4A4DduIQLc4bcL\n ascii\n   $s17 =\n\"5Ewf7cgaGLAv7VSjeroTTJAjcpy+a7Ql2VPnU2HVntv/mUgzY6rVrB/TYQX35L9Xj+N9SPwkjLT2k+D48S0nWy/tVNKTKO5FA2W4Yy0Mx\n ascii\n   $s18 =\n\"5Ewf7cgaGLAv7VSjeroTTJAjcpy+a7Ql2VPnU2HVntv/mUgzY6rVrB/TYQX35L9Xj+N9SPwkjLT2k+D48S0nWy/tVNKTKO5FA2W4Yy0Mx\n ascii\n   $s19 =\n\"iBunjDe9gVct7Gx3d65SQF8nvahJU+cRqKveP/H4pE9bLL3YAz8VqHTnT7v1JHR3MIjkUxv0uwvjI92YWFenoW2yzU8NNEwfd/JCOHlrn\n ascii\n   $s20 =\n\"pKjTapsqZ36hVbhZOPU4sD5ekeEYE2WaixuncUK41ZSfp87TA/3tI91r1DvwoBcDoQywknwbTexd6FjAV+2Ac8gY7SPda9RPwKByrBsJv\n ascii\n  condition:\n   uint16(0) == 0x5a4d and filesize < 800KB and\n   ( pe.imphash() == \"ffcd1ab4ae5e052202d6af1ea2767498\" or ( 1 of ($x*) or 4 of them ) )\n}\n\n```\n\n-----\n\n```\n       _ _ {\n  meta:\n   date = \"2019-10-13\"\n   hash1 = \"6125489453c1824da3e28a54708e7c77875e500dd82a59c96c1d1e5ee88dcad7\"\n  strings:\n   $x1 = \"*\\\\G{0D452EE1-E08F-101A-852E-02608C4D0BB4}#2.0#0#C:\\\\windows\\\\system32\\\\FM20.DLL#Microsoft\nForms 2.0 Object Library\" fullword wide\n   $x2 = \"Customer50041 Keeling Bypass, North Christellefort, Tunisia Global128 Manuel Stravenue, New\nNicholasfort, Montserrat\" fullword ascii\n   $x3 = \"*\\\\G{00020430-0000-0000-C000-000000000046}#2.0#0#C:\\\\Windows\\\\system32\\\\stdole2.tlb#OLE\nAutomation\" fullword wide\n   $x4 = \"Forward297 German Trail, West Miloshire, Germany Product44796 Chesley Bypass, East Santos,\nAntigua and Barbudan\" fullword ascii\n   $x5 = \"Regional1198 Rahsaan Motorway, Klockoburgh, Czech Republic Human326 Olson Bypass, North\nNicholaus, Zimbabwe\" fullword ascii\n   $x6 = \"Dynamic6743 Hickle Bypass, West Karliborough, United States Minor Outlying Islands\nProduct6344 Zieme Inlet, Gloverfurt, Taiwan\" fullword ascii\n   $x7 = \"*\\\\G{3D3F9F38-A9F3-48A3-AE6038AE7491F39A}#2.0#0#C:\\\\Users\\\\ADMINI~1\\\\AppData\\\\Local\\\\Temp\\\\Word8.0\\\\MSForms.exd#Microsoft Forms\" wide\n   $s8 = \"Central080 Ari Ranch, Port Sarinachester, Saint Vincent and the Grenadines Product4773\nCornelius Ford, Maybelleville, Morocco\" fullword ascii\n   $s9 = \"Senior75970 Kiehn Brook, Port Joaquin, Comoros Forward6656 Parker Extension, Halvorsonton,\nZambia\" fullword ascii\n   $s10 = \"6868686868686868686868\" ascii /* reversed goodware string '8686868686868686868686' */ /*\nhex encoded string 'hhhhhhhhhhh' */\n   $s11 = \"*\\\\G{2DF8D04C-5BFA-101B-BDE5-00AA0044DE52}#2.8#0#C:\\\\Program Files\\\\Common Files\\\\Microsoft\nShared\\\\OFFICE16\\\\MSO.DLL#Microsoft \" wide\n   $s12 = \"Dynamic98251 Karli Mission, Deronhaven, Democratic People's Republic of Korea Chief1365\nHermann Passage, Rickyport, Oman24 \" fullword ascii\n   $s13 = \"Forward0973 Nienow Dam, Walkermouth, Egypt Customer976 MacGyver Mountain, Schoentown,\nNorthern Mariana Islands+ Lo \" fullword ascii\n   $s14 = \"Corporate28089 Etha Bypass, Jastbury, Turkmenistan Dynamic764 Price Cliffs, Welchtown,\nAlgeriaog(1 \" fullword ascii\n   $s15 = \"National4629 Brianne Locks, Port Shadburgh, Bangladesh Forward481 Ashton Course, Lake\nJudson, Pakistana Pr\" fullword ascii\n   $s16 = \"Forward563 Sasha Mountains, Nitzschestad, Palau Lead58549 Lesch Parkways, Port Archburgh,\nBurundi\" fullword ascii\n   $s17 = \"Forward00009 Labadie Valley, Lake Othaview, Brunei Darussalam Future796 Fritsch Road,\nMertzchester, Montserrat1831 \" fullword ascii\n   $s18 = \"Central9007 Leland Isle, Laurynview, Morocco Product75313 Mueller Harbors, West Nakiafort,\nLithuania+ Log( \" fullword ascii\n   $s19 = \"Regional973 Aubrey Squares, South Simoneville, Svalbard & Jan Mayen Islands Dynamic7842\nMadilyn Course, O'Harastad, Armenia\" fullword ascii\n   $s20 = \"Lead7617 Nicolas Meadows, West Odell, Saint Pierre and Miquelon Product9412 Stamm Cove,\nSouth Katlynnport, Comoros \" fullword ascii\n  condition:\n   uint16(0) == 0xcfd0 and filesize < 900KB and\n   1 of ($x*) and 4 of them\n}\n\n```\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2019/2019-10-14 - Is Emotet gang targeting companies with external SOC-.pdf"
    ],
    "report_names": [
        "2019-10-14 - Is Emotet gang targeting companies with external SOC-.pdf"
    ],
    "threat_actors": [
        {
            "id": "059b16f8-d4e0-4399-9add-18101a2fd298",
            "created_at": "2022-10-25T15:50:23.29434Z",
            "updated_at": "2025-03-27T02:00:55.431907Z",
            "deleted_at": null,
            "main_name": "Evilnum",
            "aliases": [
                "Evilnum"
            ],
            "source_name": "MITRE:Evilnum",
            "tools": [
                "More_eggs",
                "EVILNUM",
                "LaZagne"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "39ea99fb-1704-445d-b5cd-81e7c99d6012",
            "created_at": "2022-10-25T16:07:23.601894Z",
            "updated_at": "2025-03-27T02:02:09.882982Z",
            "deleted_at": null,
            "main_name": "Evilnum",
            "aliases": [
                "Jointworm",
                "Operation Phantom in the [Command] Shell",
                "TA4563"
            ],
            "source_name": "ETDA:Evilnum",
            "tools": [
                "Bypass-UAC",
                "Cardinal RAT",
                "ChromeCookiesView",
                "EVILNUM",
                "Evilnum",
                "IronPython",
                "LaZagne",
                "MailPassView",
                "More_eggs",
                "ProduKey",
                "PyVil",
                "PyVil RAT",
                "SONE",
                "SpicyOmelette",
                "StealerOne",
                "Taurus Loader Stealer Module",
                "Taurus Loader TeamViewer Module",
                "Terra Loader",
                "TerraPreter",
                "TerraStealer",
                "TerraTV"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "9f101d9c-05ea-48b9-b6f1-168cd6d06d12",
            "created_at": "2023-01-06T13:46:39.396409Z",
            "updated_at": "2025-03-27T02:00:03.074969Z",
            "deleted_at": null,
            "main_name": "Earth Lusca",
            "aliases": [
                "CHROMIUM",
                "ControlX",
                "Red Dev 10",
                "RedHotel",
                "Red Scylla",
                "TAG-22",
                "BRONZE UNIVERSITY",
                "AQUATIC PANDA",
                "Charcoal Typhoon",
                "BountyGlad"
            ],
            "source_name": "MISPGALAXY:Earth Lusca",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "8ce861d7-7fbd-4d9c-a211-367c118bfdbd",
            "created_at": "2023-01-06T13:46:39.153487Z",
            "updated_at": "2025-03-27T02:00:03.009422Z",
            "deleted_at": null,
            "main_name": "Evilnum",
            "aliases": [
                "TA4563",
                "EvilNum",
                "Jointworm",
                "KNOCKOUT SPIDER",
                "DeathStalker"
            ],
            "source_name": "MISPGALAXY:Evilnum",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "6abcc917-035c-4e9b-a53f-eaee636749c3",
            "created_at": "2022-10-25T16:07:23.565337Z",
            "updated_at": "2025-03-27T02:02:09.868522Z",
            "deleted_at": null,
            "main_name": "Earth Lusca",
            "aliases": [
                "Bronze University",
                "Charcoal Typhoon",
                "Chromium",
                "Red Dev 10",
                "Red Scylla"
            ],
            "source_name": "ETDA:Earth Lusca",
            "tools": [
                "Agentemis",
                "AntSword",
                "BIOPASS",
                "BIOPASS RAT",
                "BadPotato",
                "Behinder",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "Doraemon",
                "FRP",
                "Fast Reverse Proxy",
                "FunnySwitch",
                "HUC Port Banner Scanner",
                "KTLVdoor",
                "Mimikatz",
                "NBTscan",
                "POISONPLUG.SHADOW",
                "PipeMon",
                "RbDoor",
                "RibDoor",
                "RouterGod",
                "SAMRID",
                "ShadowPad Winnti",
                "SprySOCKS",
                "WinRAR",
                "Winnti",
                "XShellGhost",
                "cobeacon",
                "fscan",
                "lcx",
                "nbtscan"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "d53593c3-2819-4af3-bf16-0c39edc64920",
            "created_at": "2022-10-27T08:27:13.212301Z",
            "updated_at": "2025-03-27T02:00:55.529662Z",
            "deleted_at": null,
            "main_name": "Earth Lusca",
            "aliases": [
                "Earth Lusca",
                "TAG-22",
                "Charcoal Typhoon",
                "CHROMIUM",
                "ControlX"
            ],
            "source_name": "MITRE:Earth Lusca",
            "tools": [
                "Mimikatz",
                "PowerSploit",
                "Tasklist",
                "certutil",
                "Cobalt Strike",
                "Winnti for Linux",
                "Nltest",
                "NBTscan",
                "ShadowPad"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1673536175,
    "ts_updated_at": 1743041735,
    "ts_creation_date": 1653760464,
    "ts_modification_date": 1653760464,
    "files": {
        "pdf": "https://archive.orkl.eu/2c45876883bc2c53a0f0e07fcfc910e34c1159be.pdf",
        "text": "https://archive.orkl.eu/2c45876883bc2c53a0f0e07fcfc910e34c1159be.txt",
        "img": "https://archive.orkl.eu/2c45876883bc2c53a0f0e07fcfc910e34c1159be.jpg"
    }
}