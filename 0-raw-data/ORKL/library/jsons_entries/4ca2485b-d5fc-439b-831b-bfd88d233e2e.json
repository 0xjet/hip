{
    "id": "4ca2485b-d5fc-439b-831b-bfd88d233e2e",
    "created_at": "2022-10-25T16:48:15.88322Z",
    "updated_at": "2025-03-27T02:17:15.036461Z",
    "deleted_at": null,
    "sha1_hash": "f5ba5f8240569e08da4796deb95b89ee1340d03d",
    "title": "APT41 Resurfaces as Earth Baku With New Cyberespionage Campaign",
    "authors": "Trend Micro",
    "file_creation_date": "2021-08-19T10:55:26Z",
    "file_modification_date": "2021-08-19T10:55:38Z",
    "file_size": 5121971,
    "plain_text": "-----\n\n**TREND MICRO LEGAL DISCLAIMER**\n\nThe information provided herein is for general information\n\nand educational purposes only. It is not intended and\n\nshould not be construed to constitute legal advice. The\n\ninformation contained herein may not be applicable to all\n\nsituations and may not reflect the most current situation.\n\nNothing contained herein should be relied on or acted\n\nupon without the benefit of legal advice based on the\n\nparticular facts and circumstances presented and nothing\n\nherein should be construed otherwise. Trend Micro\n\nreserves the right to modify the contents of this document\n\nat any time without prior notice.\n\nTranslations of any material into other languages are\n\nintended solely as a convenience. Translation accuracy\n\nis not guaranteed nor implied. If any questions arise\n\nrelated to the accuracy of a translation, please refer to\n\nthe original language official version of the document. Any\n\ndiscrepancies or differences created in the translation are\n\nnot binding and have no legal effect for compliance or\n\nenforcement purposes.\n\nAlthough Trend Micro uses reasonable efforts to include\n\naccurate and up-to-date information herein, Trend Micro\n\nmakes no warranties or representations of any kind as\n\nto its accuracy, currency, or completeness. You agree\n\nthat access to and use of and reliance on this document\n\nand the content thereof is at your own risk. Trend Micro\n\ndisclaims all warranties of any kind, express or implied.\n\nNeither Trend Micro nor any party involved in creating,\n\nproducing, or delivering this document shall be liable\n\nfor any consequence, loss, or damage, including direct,\n\nindirect, special, consequential, loss of business profits,\n\nor special damages, whatsoever arising out of access to,\n\nuse of, or inability to use, or in connection with the use of\n\nthis document, or any errors or omissions in the content\n\nthereof. Use of this information constitutes acceptance for\n\nuse in an “as is” condition.\n\nPublished by\n###### Trend Micro Research\n\nWritten by\n###### Hara Hiroaki Ted Lee\n\nStock image used under license from\n\nShutterstock.com\n\n\n### Contents\n\n#### 4\n\n###### Background\n\n#### 6\n\n###### Attack Vectors\n\n#### 11\n\n###### Technical Analysis of the Loaders\n\n#### 27\n\n###### Technical Analysis of the Payloads\n\n#### 35\n\n###### Attribution\n\n#### 40\n\n###### Conclusion and Security Recommendations\n\n#### 42\n\n###### Appendix\n\n\n-----\n\nCyberespionage has become a more prevalent threat in today’s security landscape, putting\n\nprivate enterprises and public agencies alike at risk of major upsets to their operations.\n\nThis research paper covers the technical details of a new cyberespionage campaign that\n\nwe believe can be traced back to the notorious advanced persistent threat (APT) group\n\nEarth Baku. In this campaign, Earth Baku’s attacks have been leveled against companies in\n\nvarious countries in the Indo-Pacific region.\n\nTrend Micro has previously covered the various methodologies employed by this APT\n\ngroup, which also operates under the alias APT41. Its exploits have been well documented;\n\nthe group has garnered a reputation for its use of advanced, self-developed tools.[1] In fact,\n\nEarth Baku has been associated with a slew of cybercrimes such as watering hole attacks[2]\n\nand spear phishing attacks.[3] Its previous targets include companies in the pharmaceutical\n\nand telecommunications industries.\n\nEarth Baku has yet again updated its arsenal, as evidenced by the latest additions of two\n\nshellcode loaders, which we have named StealthVector and StealthMutant, and a modular\n\nWindows backdoor, which we have dubbed ScrambleCross. Our in-depth analysis of these\n\nnewfound malware tools revealed that they have easily customizable features and are\n\ndistributed through different attack vectors, making it convenient for malicious actors to\n\ntailor them to specific victims.\n\nThis report aims to shed light on the sophisticated toolset involved in this new campaign,\n\nalthough Earth Baku’s motives behind the development of the shellcode loaders and\n\nbackdoor are not entirely clear. While these have been probably used as part of state-\n\nbacked attacks to collect competitive intelligence, the inner workings of Earth Baku itself\n\nremain unknown. It is likely that the group is composed of threat actors who collaborate by\n\nsharing tools with diverse attack infrastructures,[4] but their use of the new shellcode loaders\n\nand backdoor suggests that they have recruited members with specific areas of expertise.\n\n\n-----\n\n## Background\n\nLate last year, we discovered a new shellcode loader designed to execute an arbitrary shellcode with a\n\nstealth mode feature. Since then, we have found multiple variants of this loader, which we have named\n\nStealthVector, and, in addition, a shellcode loader written in C#, which we have named StealthMutant.\n\nThese shellcode loaders have two different payloads: the Cobalt Strike beacon and a newly found modular\n\nbackdoor, which we have dubbed ScrambleCross.\n\nBased on their indicators, we have concluded that the threat actors behind this campaign are linked\n\nto Earth Baku, an APT group that also goes by the name APT41. Earth Baku, a cyberespionage and\n\ncybercriminal group, was charged by the US Department of Justice in August 2020 with computer\n\nintrusion offenses related to data theft, ransomware, and cryptocurrency mining attacks.[5]\n\nEarth Baku’s new campaign, which has been active since at least July 2020, is related to a previous one\n\nreported by Positive Technologies[6] and FireEye,[7] which had used a different shellcode loader, which we\n\nhad named LavagokLdr, as shown in Figure 1. However, since the group has fully updated its toolset, we\n\nrecognize this attack as an entirely new campaign.\n\n**New campaign**\n\n**StealthMutant**\n\nJul 2020\nonward Cobalt Strike\n\nScrambleCross\n\n**LavagokLdr** **StealthVector**\n\nNov 2018 Oct 2020\nonward Cobalt Strike onward Cobalt Strike\n\nCrosswalk ScrambleCross\n\nMetasploit\n\n###### 2020 2021\n\nFigure 1. A timeline of Earth Baku’s use of LavagokLdr in its previous campaign and of StealthMutant,\nStealthVector, and ScrambleCross in its new campaign\n\n|Col1|New campaign|\n|---|---|\n|Jul 2020 onward LavagokLdr Nov 2018 onward Cobalt Strike Crosswalk Metasploit|StealthMutant Cobalt Strike ScrambleCross StealthVector Oct 2020 onward Cobalt Strike ScrambleCross|\n|||\n\n\n**New campaign**\n\n**StealthMutant**\n\nJul 2020\nonward Cobalt Strike\n\nScrambleCross\n\n**LavagokLdr** **StealthVector**\n\nNov 2018 Oct 2020\nonward Cobalt Strike onward Cobalt Strike\n\nCrosswalk ScrambleCross\n\nMetasploit\n\n\n-----\n\nThis campaign affects some Indo-Pacific countries, including India, Indonesia, Malaysia, the Philippines,\n\nTaiwan, and Vietnam, as illustrated in Figure 2. It targets both enterprises and government entities,\n\nincluding organizations in the airline, computer hardware, automotive, infrastructure, publishing, media,\n\nand IT industries. From a geopolitical point of view, many of the countries affected by this recent campaign\n\noverlap with those reported in the aforementioned indictment of Earth Baku by the US.\n\nFigure 2. The countries affected by the Earth Baku campaign, all in the Indo-Pacific region\n\n_Source: Trend Micro™ Smart Protection Network™ infrastructure_\n\n\n-----\n\n## Attack Vectors\n\nWe have observed that Earth Baku has been using multiple attack vectors for this campaign.\n\n##### Exploitation Against a Web Application\n\nUpon studying one of the incident responses from the campaign, we found that Earth Baku performed\n\nan SQL injection attack on the victim’s web application to gain a foothold in the network, as depicted in\n\nFigure 3.\n\nThe attacker VBS decodes the The BAT file installs\nexploits public Base64-encoded StealthVector\nMicrosoft SQL text and drops as a\nServer via sqlmap. the components. Windows service.\n\n**1** **2** **3**\n\n\nBAT launcher\n\nStealthVector\n\nEncrypted payload\n\n\nAttacker SQL injection\n\n\nVBS dropper\n\nBase64-encoded\ntext\n\n\nFigure 3. Earth Baku’s attack chain using SQL injection as the attack vector\n\n\n-----\n\nBased on the Visual Basic Script (VBS) scripts used in this attack (Figure 4), we believe that the actors\n\nused sqlmap, a Python-based SQL penetration testing tool, to upload a malicious file (Figure 5).[8]\n\nFigure 4. The VBS file that is dropped in a victim’s machine\n\nFigure 5. The script in sqlmap\n\n\n-----\n\nThis dropper decodes a specified Base64-encoded file, and then drops it in a specified file path. In such\n\nan attack, the malware creates install.bat, which installs StealthVector as a Windows service (Figure 6).\n\nFigure 6. StealthVector installed as a Windows service\n\n##### Exploitation of a Microsoft Exchange Server\n\n Vulnerability\n\nAnother method involves a China Chopper web shell that is uploaded to Microsoft Exchange Server by\n\nexploiting the ProxyLogon vulnerability CVE-2021-26855.[9] We also detected StealthVector on Microsoft\n\nExchange Server, from which we inferred that Earth Baku likely deployed China Chopper using the\n\nProxyLogon exploit, and then uploaded StealthVector using a web shell (Figure 7). This was not the first\n\ntime that Earth Baku had capitalized on the ProxyLogon exploit in its operations, as this was also reported\n\nby ESET in March 2021.[10] We believe that the group’s usage of this exploit is likely to continue unless\n\nenterprises address this flaw by updating their systems with the released patch.\n\nThe attacker The StealthVector\n\nThe China Chopper\n\nexploits the malware is\n\nweb shell is\n\nMicrosoft Exchange uploaded via\n\ndeployed.\n\nServer vulnerability. China Chopper.\n\n**1** **2** **3**\n\nAttacker ProxyLogon ASP Web Shell StealthVector\n\nFigure 7. Earth Baku’s attack chain using exploitation of the ProxyLogon vulnerability\nas the attack vector\n\n\n-----\n\n##### Possible Email Vector\n\nUpon further investigation on VirusTotal, we discovered that it is possible that the same threat actors have\n\nattempted to distribute StealthVector through LNK (link) files sent as email attachments (Figure 8).\n\nThe decoy\nis opened and\nStealthVector\nis executed.\n\nThe LNK file **2**\ndownloads files\nusing the renamed\n_CertUtil.exe._\n\n**1**\n\nDecoy\nEmail?\n\nAttacker LNK downloader\n\nStealthVector\n\nFigure 8. Earth Baku’s attack chain possibly using an LNK file as the attack vector\n\nThe LNK file renames CertUtil.exe, a legitimate Microsoft command-line tool, and uses the renamed tool\n\nto download both a decoy document and StealthVector (Figure 9). However, we have never seen this type\n\nof infection vector in the wild.\n\nFigure 9. The LNK file renaming CertUtil.exe\n\n##### InstallUtil.exe via a Scheduled Task\n\nStealthMutant, for its part, is executed using a different mechanism. Although we are still not certain\n\nhow an attacker gains access to a system, we have discovered that StealthMutant is executed by\n\n_InstallUtil.exe through a scheduled task, as illustrated in Figure 10._\n\n\n-----\n\n**1** **2**\n\n???\n\nAttacker Scheduled task _InstallUtil.exe_\n\nStealthMutant\n\nEncrypted payload\n\nFigure 10. The execution of StealthMutant through InstallUtil.exe\n\n_InstallUtil.exe is a legitimate installer application under Microsoft’s .NET Framework, but it is also known_\n\nas a living-off-the-land binary (LOLBin) that is used in the proxy execution of .NET Framework programs.\n\nIn a scheduled task, InstallUtil.exe is registered to run StealthMutant, as demonstrated in Figure 11.\n\nFigure 11. InstallUtil.exe being registered to run StealthMutant via a scheduled task\n\n\n-----\n\n## Technical Analysis of the Loaders\n\nEarth Baku’s new campaign takes advantage of the various capabilities of two shellcode loaders,\n\nStealthMutant and StealthVector.\n\n##### StealthMutant\n\nStealthMutant is an evasive shellcode loader written in C# that has been in use since at least July 2020. It\n\nreads a file that is encrypted by AES-256-ECB, decrypts the file in memory, injects its malicious payload\n\ninto a remote process, and then executes it. We have observed that its payload has been either the\n\nCobalt Strike beacon or the ScrambleCross backdoor. Most of the StealthMutant samples we have come\n\nacross are obfuscated by ConfuserEx, an open-source obfuscator for .NET Framework applications.\n\nAfter deobfuscating these samples, we have observed raw namespaces and classes that describe their\n\npurpose (Figure 12).\n\nFigure 12. The namespaces and classes from the deobfuscated samples\n\n\n-----\n\nAll the strings in StealthMutant are encrypted with the encryption algorithm AES-256-ECB and are\n\ndecrypted on the spot, as shown in Figure 13. The decrypted strings are as follows:\n\n1. The MagicString class provides a getter property, which decrypts strings on access.\n\n2. The MagicString class has an encrypted string field.\n\n3. The MagicString class provides __Decrypt, a wrapper method for decryption.\n\n4. If it is StealthMutant’s first time to use the __Decrypt method, the AES (Advanced Encryption Standard)\n\nkey and initialization vector (IV) will be initialized based on the hard-coded __factory value, although\n\nthis IV is meaningless in Electronic Code Block (ECB) mode. The key is the SHA-256 hash, while the IV\n\nis the MD5 hash. The values of the SHA-256 and MD5 hashes vary with each StealthMutant sample.\n\n5. The __Decrypt method calls the Crypto.DecryptData method.\n\n6. The Crypto.DecryptData method decrypts the given data by the hard-coded mode or, in this case,\n\nthe ECB mode.\n\nFigure 13. The decrypted StealthMutant strings\n\nThe main purpose of StealthMutant is to execute the second stage of the shellcode under stealth mode.\n\nTo this end, StealthMutant patches the EtwEventWrite function’s API to disable Event Tracing for Windows\n\n(ETW), making it invisible to Windows’ built-in logging system.\n\nStealthMutant appears to support both 32-bit and 64-bit architectures. In the _DoPatch method,_\n\nStealthMutant determines the architecture dynamically, as demonstrated in Figure 14. If it is running on a\n\n32-bit operating system, StealthMutant patches the system with “C2 14 00 (ret 0x14)”, whereas it patches\n\na 64-bit system with “48 31 C0 C3 (xor rax, rax; ret)”.\n\n\n-----\n\nFigure 14. StealthMutant patching based on the architecture\n\nThe file names of the encrypted payload are hard-coded, but these differ with each StealthMutant sample.\n\nThe file name string is also encrypted using AES-256-ECB. If the target encrypted file exists in a current\n\nrunning directory, StealthMutant reads and decrypts it in memory.\n\nMost of the StealthMutant samples use AES-256-ECB for decryption (Figure 15), but the earlier versions of\n\nthe malware used XOR for decryption (Figure 16). However, we have not spotted these previous iterations\n\nof StealthMutant since July 2020.\n\nFigure 15. The version of StealthMutant that uses AES-256-ECB\n\n\n-----\n\nFigure 16. An older version of StealthMutant that used XOR\n\nThe StealthMutant variants that use AES-256-ECB and XOR share the same decryption steps. The\n\nStealthMutant samples that use AES have an encrypted file containing junk bytes, the signature, the\n\nseed for the key, the seed for the IV, and the encrypted payload body. The sizes of the junk bytes, the\n\nseed for the key, and the seed for the IV vary among the samples. The decryption algorithm of one such\n\nStealthMutant sample (Figure 17), which has a junk bytes size of 128, a key seed size of 12, and an IV\n\nseed size of 12, is as follows:\n\n1. Calculate the MD5 hash of the encrypted payload body. The body is composed of the key seed, the\n\nIV seed, and the encrypted payload.\n\n2. Compare the MD5 hash with the signature in the encrypted file to check its integrity.\n\n3. Copy the specified size of bytes following the signature, and then calculate the SHA-256 hash for the\n\nAES key.\n\n4. Copy the specified size of bytes following the seed for the key, and then calculate the MD5 hash for\n\nAES IV. However, this is meaningless in ECB mode.\n\n5. Decrypt the rest of the bytes using AES-256-ECB with the generated SHA-256 key.\n\n6. Compare the specified size of bytes at the top of the decrypted bytes with that of the hard-coded\n\nbytes, which can be found in the Protocol.Flag field.\n\n7. If StealthMutant passes all these verifications, read the specified size of the payload.\n\n\n-----\n\n|Junk|Col2|\n|---|---|\n|||\n\n|Encrypted payload|Col2|\n|---|---|\n|||\n\n|Size|Col2|\n|---|---|\n|||\n\n|Signature|Col2|\n|---|---|\n|||\n\n|Shellcode|Col2|\n|---|---|\n|||\n\n\n**Junk**\n\n**Signature**\n\n**Bytes to generate key**\n\n**Bytes to generate IV**\n\n**Encrypted payload**\n\nAES-256-ECB\n\n**Size** Key = SHA-256 (bytes to generate key)\n\n**Signature**\n\n**Shellcode**\n\n\nAfter the decryption of its payload, StealthMutant executes this shellcode payload in a remote process by\n\nusing the process hollowing technique. As shown in Figure 18, StealthMutant performs process hollowing\n\nthrough the following steps:\n\n1. It creates a specified process, which is hard-coded in binary, in suspended mode.\n\n2. It creates a new section, maps a view of it in the local process by using _NtCreateSection and_\n\n_ZwMapViewOfSection, and copies the decrypted shellcode onto this section._\n\n3. It maps the section to the remote process, which also results in mapping of the shellcode in the\n\nremote process.\n\n4. It looks for the entry point of the remote suspended process and patches it to change the execution\n\nflow into the entry of the mapped payload.\n\n5. Finally, it resumes the main thread of the suspended process and executes the payload.\n\n\n**Signature**\n\n**Shellcode**\n\nFigure 17. A StealthMutant sample’s decryption algorithm\n\nAfter the decryption of its payload, StealthMutant executes this shellcode payload in a remote process by\n\nusing the process hollowing technique. As shown in Figure 18, StealthMutant performs process hollowing\n\nthrough the following steps:\n\n1. It creates a specified process, which is hard-coded in binary, in suspended mode.\n\n2. It creates a new section, maps a view of it in the local process by using _NtCreateSection and_\n\n_ZwMapViewOfSection, and copies the decrypted shellcode onto this section._\n\n3. It maps the section to the remote process, which also results in mapping of the shellcode in the\n\n\n-----\n\nLegitimate process\n\n\nPatch entry point\nto jump payload\nin DLL, and then\nresume thread.\n\n\nDecrypt 1\n\n\nStealthMutant\n\nCode\n\nPayload\n\n3 Create section, map to local\nprocess, and then copy payload.\n\n|Col1|Code Payload|2 Spawn process in suspended mode.|Col4|Col5|jmp Legitimate code Payload|\n|---|---|---|---|---|---|\n||||Payload|||\n|||Map view of 4 section to remote process.||||\n\n\nEncrypted payload\n\nFigure 18. StealthMutant performing process hollowing to execute its payload\n\nThis technique is widely used as a red-team tool in C#. Based on its code, we assume that the author of\n\nStealthMutant possibly reused an open-source process hollowing implementation from GitHub.[11]\n\n##### StealthVector\n\nIn October 2020, we discovered StealthVector, an evasive shellcode loader written in C/C++. This malware\n\nimplements various evasion techniques and is still actively being developed. We have observed that its\n\npayload is either the Cobalt Strike beacon or the malware ScrambleCross. (The Japanese security service\n\ncompany LAC previously published a blog post discussing the Cobalt Strike beacon.[12])\n\nStealthVector is designed to execute the second stage of the payload in stealth mode. This means that its\n\nevasive techniques can be enabled and disabled by its embedded configuration. Because of this, malicious\n\nactors can easily customize this loader for their targets. The configuration of StealthVector (Figure 19) is\n\nembedded in its data section with ChaCha20 encryption, which is decrypted upon initialization (Figure\n\n20). This ChaCha20 routine notably uses a fixed custom value of 0x13 for the initial counter (Figure 21).\n\nFigure 19. The configuration of StealthVector\n\n\n-----\n\n|ChaCha20 nonce for config|Col2|\n|---|---|\n|||\n\n|CRC-32 of encrypted config|Col2|\n|---|---|\n|||\n\n|Size of encrypted config|Col2|\n|---|---|\n|||\n\n|Encrypted config|Col2|\n|---|---|\n|||\n\n|Key for ChaCha20|Col2|\n|---|---|\n|||\n\n\n**for config** **encrypted config**\n\n\nFigure 20. The locations of StealthVector’s encrypted configuration and ChaCha20 key information\n\nFigure 21. The fixed custom value used in the ChaCha20 routine\n\n\n-----\n\nAccording to RFC7539, the Internet Engineering Task Force (IETF) specification for the ChaCha20 stream\n\ncipher and the Poly1305 authenticator,[13] the ChaCha20 algorithm uses a 32-bit initial counter. This counter\n\ncan be any number but is usually 0 or 1. As far as we have observed, StealthVector always uses 0x13\n\nfor its initial counter, which is an uncommon practice. This makes it difficult to decrypt the malware’s\n\nconfiguration using common methods such as the Python library pycryptodome, which does not support\n\ncustom initial counters.\n\nThe decrypted configuration data is copied onto a newly allocated buffer, which determines its behavior.\n\nThere are two types of configurations found in the wild. One is for a local shellcode runner, which has a\n\nsize of 0x38. This type of configuration has fields for checksum, flags for context awareness, flags for\n\nevasive features, and information for the payload (Figure 22 and Figure 23).\n\nFigure 22. The configuration that loads the encrypted payload from StealthVector’s own binary\n\nFigure 23. The configuration that loads the encrypted payload from a defined file path\n\nThe other is for a remote shellcode injector, which has a size of 0x44. This type of configuration has\n\nfields for checksum, flags for context awareness, flags for evasive features, information for injection, and\n\ninformation for the payload (Figure 24 and Figure 25).\n\n\n-----\n\nFigure 24. The configuration that loads the encrypted payload from a defined file path but no injection\n\nFigure 25. The configuration that loads the encrypted payload from a defined file path and performs\nprocess injection\n\n###### Configurable Features\n\nStealthVector has various configurable features that enable malicious actors to easily modify its behavior.\n\nWe believe this design is meant to keep malware development simple, as the actors will not need to\n\nchange its source code in order to implement these features. We discuss these features in the succeeding\n\nsubsections.\n\n###### Disabling Event Tracing for Windows\n\nStealthVector can disable ETW to cover its tracks, as shown in Figure 26.\n\nFigure 26. StealthVector configured to disable ETW\n\n\n-----\n\n###### Context Awareness\n\nA common feature of other malware, such as mutual exclusion object (mutex) checking or username\n\nchecking for context awareness, can also be configured into StealthVector, as shown in Figure 27.\n\nFigure 27. StealthVector configured for context awareness\n\n###### Logic to Determine Payload Location\n\nStealthVector decrypts and executes its payload in memory, but it can also be configured to load its\n\nencrypted payload in a specific location. Some variants embed the payload in its binary, while others load\n\nit to another file in the same directory, whose file name is specified in the malware’s configuration (Figure\n\n28). The decryption logic is the same for all variants of StealthVector: It reads the specific size of data\n\nfrom a specific offset. The values for the offset and the size of the encrypted payload are already defined\n\nin the malware’s configuration. Afterward, the payload will be decrypted by ChaCha20. This same routine\n\nis used in decrypting StealthVector’s configuration, but the nonce for its payload is already defined in the\n\nconfiguration (Figure 29).\n\nFigure 28. A StealthVector variant that embeds its encrypted payload into a specific file\n\n\n-----\n\nFigure 29. Stealthvector’s decryption logic\n\n\n-----\n\n###### Self-Uninstallation\n\nStealthVector can also uninstall itself based on its configuration, as shown in Figure 30.\n\nFigure 30. StealthVector’s uninstall configuration\n\n###### Shellcode Execution Techniques\n\nStealthVector implements various shellcode execution techniques. We discuss these techniques in the\n\nsucceeding subsections.\n\n###### Execution Using CreateThread\n\nThe simplest way for StealthVector to execute its shellcode payload is by using the CreateThread function,\n\nas shown in Figure 31.\n\nFigure 31. Execution of the shellcode using CreateThread\n\n###### Module Stomping in Local Process\n\nSome variants of StealthVector implement an evasive technique called module stomping, which is\n\ndesigned to bypass the detection of reflective loading. Module stomping is well known because Cobalt\n\nStrike has implemented this feature in its version 3.11.[14] In the case of StealthVector, however, the injected\n\npayload is a shellcode instead of a dynamic link library (DLL). To perform this technique, StealthVector\n\nlooks for a legitimate DLL that has sufficient space for its payload, “(payload_size + 2048)”, as shown in\n\nFigure 32.\n\n\n-----\n\nFigure 32. StealthVector looking for a DLL with enough space for its payload\n\nOnce it finds one that meets its space requirement, StealthVector loads that DLL using the LoadLibraryExW\n\nfunction, with the flag _DONT_RESOLVE_DLL_REFERENCES. As shown in Figure 33, when this flag is_\n\nenabled, the system does not call the DllMain of the target DLL upon loading.\n\nFigure 33. StealthVector enabling DONT_RESOLVE_DLL_REFERENCES after finding its target DLL\n\n\n-----\n\nOnce it loads the target DLL, StealthVector changes the protection settings of the DLL using read, write,\n\nand execute (RWX) permissions. It then copies its payload onto the legitimate DLL and executes the\n\npayload through the CreateThread function, as illustrated in Figure 34.\n\n###### StealthVector\n\nDLL\n\nOverwrite with Payload Legitimate DLL\nshellcode and 3\nexecute.\n\nCode\n\nFind DLL and\n2\n_LoadLibraryExW._\n\nDecrypt. 1 Encrypted payload\nor\n\n###### Encrypted payload\n\nFigure 34. StealthVector’s process of overwriting the target DLL with its malicious payload\n\n###### Bypassing Control Flow Guard\n\nAs shown in Figure 35, some variants of StealthVector run their shellcode by bypassing Microsoft’s\n\nControl Flow Guard (CFG), an exploit mitigation technology. CFG makes it difficult for malware to run\n\ncode on Windows operating systems by restricting indirect calls to an unapproved address. In this case,\n\nStealthVector executes its shellcode using CreateThread, which checks the target address.\n\nIn order to sidestep attempts to verify its indirect call, StealthVector will then patch the\n\n_LdrpHandleInvalidUserCallTarget API in ntdll.dll with “48 FF E0 CC 90 (jmp rax; int3; nop)”, as shown in_\n\nFigure 36. LdrpHandleInvalidUserCallTarget is called when CFG, through the LdrpValidateUserCallTarget\n\nfunction, determines that the target address is invalid. StealthVector can patch this API without crashing\n\nthe application.\n\n\n-----\n\nFigure 35. StealthVector bypassing CFG to execute its shellcode\n\nFigure 36. StealthVector patching LdrpHandleInvalidUserCallTarget\n\n###### Phantom DLL Hollowing in Remote Process\n\nSome variants of StealthVector can also inject their shellcode payload into a remote process using\n\nphantom DLL hollowing, a technique that is a combination of process hollowing and module stomping\n\n(Figure 37). To do this, StealthVector spawns a new process, which is specified in its configuration, in\n\nsuspended mode. StealthVector uses the _NtCreateSection and_ _ZwMapViewOfSection APIs to load a_\n\nlegitimate DLL into this newly created process. The logic of finding its target DLL is the same as that\n\nin module stomping: It checks if the code section, or (.text section size), is large enough. Afterward, it\n\noverwrites the code section of the loaded DLL with its own payload and executes it in the DLL’s memory\n\nspace. It then patches the entry point of the legitimate process in order to modify the shellcode’s execution\n\nflow to this entry point in the DLL. Using this method, malicious actors can hide StealthVector’s payload\n\nwithin the memory space of an image, which often goes unnoticed by common memory scan engines,\n\nand execute it like a normal module.\n\n\n-----\n\nLegitimate process\n\n\nPatch entry point\nto call payload in\nDLL, and then\nresume thread.\n\n\nDecrypt 1\n\nor\n\nEncrypted payload\n\n\nStealthVector\n\n2 Spawn process in\nsuspended mode.\n\nCode 3 Map legitimate\n\nDLL to section.\n\nDLL\n\nMap view of\n\nEncrypted payload 4 section toremote process.\n\nOverwrite specific\n5 function with shellcode.\n\n\nFigure 37. StealthVector performing phantom DLL hollowing\n\n\n-----\n\n## Technical Analysis of the Payloads\n\nOur analysis has revealed that StealthMutant and StealthVector can contain two different payloads. One\n\nis the Cobalt Strike beacon and the other is the newly found malware ScrambleCross.\n\n##### Cobalt Strike Beacon\n\nAmong most of the samples we have come across, there are two types of Cobalt Strike beacons: a hybrid\n\nHTTP DNS (Domain Name System) and HTTPS. Interestingly, all the Cobalt Strike beacons in memory\n\nare in a Portable Executable (PE) file format with a characteristic header, as shown in Figure 38. While it\n\nappears as a valid MZ header, it can also be executed as machine code.\n\nFigure 38. The Cobalt Strike beacon in a PE file format\n\n\n-----\n\nThis assembly, much like a PE header, calculates the address of a specific function, which serves as the\n\nentry point for the reflective loader to dynamically initialize and execute a DLL. It should also be noted\n\nthat some of the samples have PE files with broken headers, although they still operate in the same way\n\n(Figure 39).\n\nFigure 39. A broken PE header\n\nThe Cobalt Strike beacons in the samples we have uncovered bear similarities to those used in attacks\n\ncarried out by the Chimera APT group, as reported by Cycraft.[15] However, it remains uncertain whether this\n\ncampaign can definitively be linked to Chimera, as many similar Cobalt Strike beacons and Meterpreter\n\nshellcodes can also be found on VirusTotal (Figure 40).\n\nFigure 40. Search results for Cobalt Strike beacons on VirusTotal\n\nThe Cobalt Strike beacon found in the StealthMutant and StealthVector samples has two types of\n\nwatermarks. One is “305419896”, which is that of a cracked version, and is widely used by a variety of\n\nother malicious actors, according to research conducted by VMware Carbon Black.[16] The other watermark\n\nis “426352781”, which has been in use since at least May 2021 but has never been attributed to malicious\n\nactors before.\n\n\n-----\n\n##### ScrambleCross, or a Refactored Crosswalk\n\nDuring our analysis, we found a never-before-seen shellcode as a payload of StealthMutant and\n\nStealthVector. Upon closer study, we learned that this payload uses similar techniques to those of the\n\nCrosswalk backdoor. A modularized shellcode-based backdoor that is known to be used by Earth Baku,\n\nCrosswalk can execute additional shellcodes on memory as a plug-in. According to an indictment by the\n\nUS Department of Justice,[17] Crosswalk was also used by members of Chengdu 404 Network Technology,\n\na network security business. The similarities between Crosswalk and ScrambleCross indicate that the\n\nactual entity behind this campaign could be or is linked to members of Chengdu 404 Network Technology.\n\nFollowing our analysis, we have concluded that this unknown payload is a new version, or rather a\n\nfully refactored version, of Crosswalk. It still has many of the same capabilities as Crosswalk, but these\n\nare implemented differently. Considering this, we have named this new backdoor ScrambleCross to\n\ndistinguish it from its predecessor.\n\nScrambleCross shares the following features with Crosswalk:\n\n- It is designed as fully position-independent code.\n\n- It has encrypted code, data, and configuration.\n\n- It calculates the hash of the code section as an anti-debugging technique.\n\n- It supports multiple types of network communication protocols.\n\n- It uses message queues to asynchronously receive commands from worker threads.\n\nCrosswalk’s capabilities have been documented at length by the likes of Positive Technologies,\n\nZScaler,[18] and VMware Carbon Black.[19] But there are some key differences between this backdoor and\n\nScrambleCross. Much like Crosswalk, ScrambleCross also embeds encrypted code in itself, but it uses\n\na slightly different encryption algorithm to do so. To decode its functions and global values, including\n\nimports or strings, ScrambleCross uses a 16-byte XOR, as shown in Figure 41.\n\n\n-----\n\n|XOR key for global values|Col2|\n|---|---|\n|||\n\n\n**Signature of code** **Signature of global values (cleared right after use)**\n\n**XOR key for code**\n\n**Imports**\n\nFigure 41. ScrambleCross using a 16-byte XOR to decode its functions and global values\n\nHowever, for its network configuration, ScrambleCross uses ChaCha20 for decryption instead of XOR\n\n(Figure 42). The encrypted network configuration is embedded at offset 0x1028 from the top of the\n\nconfiguration.\n\n|Signature of code|Col2|\n|---|---|\n|||\n\n|Signature of global values (cleared right after use)|Col2|\n|---|---|\n|||\n\n|XOR key for code|Col2|\n|---|---|\n|||\n\n|Imports|Col2|\n|---|---|\n|||\n\n\n**XOR key for global values**\n\n**XOR (size = 0x1014)**\n\n**Signature of code** **Signature of global values (cleared right after use)**\n\n\n-----\n\n|Size|Col2|\n|---|---|\n\n\n**ChaCha20 key**\n\n**MDS of encrypted config**\n\n**IP address in** **# of Config** **# of Config** **Enable TLS for** **Enable TLS for**\n\n**ChaCha20 nonce** **network byte order** **Type 1** **Type 2** **Config Type 1** **Config Type 2**\n\n**23**\n\n**Size** **(counter = 0xB)ChaCha20** **6C4E62** **Config Type 1Port for**\n\n**e** **Port for**\n\n**Size of** **Config Type 2**\n**hostname**\n\n**Hostname for**\n\n**Size of** **Config Type 2**\n**object name**\n\n\nFigure 42. ScrambleCross using ChaCha20 for decryption in its network configuration\n\nLike StealthVector, ScrambleCross uses a fixed value of 0xB for its initial counter. The ChaCha20 routine\n\nshown in Figure 43 is used for encryption and decryption.\n\nFigure 43. The ChaCha20 routine\n\n\n-----\n\nWith regard to its command-and-control (C&C) server communication, Crosswalk supports TCP\n\n(Transmission Control Protocol) and HTTP for application layer protocols, and uses AES-128 for transport\n\nlayer encryption. ScrambleCross similarly supports TCP, HTTP, and HTTPS for application layer protocols,\n\nbut it instead uses ChaCha20 and a custom message structure for transport layer encryption. Regardless\n\nof whether TCP or HTTP protocols are used, both the client request and the C&C server response have\n\nthe same message structure.\n\nThe client request data is compiled in the following nine steps, as illustrated in Figure 44. On the other\n\nhand, after deconstructing the server response data, we found that it is compiled in reverse order.\n\n1. Receive a 16-byte challenge from the server, or generate a 16-byte null key instead.\n\n2. Generate a random 16-byte ChaCha20 nonce.\n\n3. Generate a 32-byte ChaCha20 key.\n\n4. Compress the raw request data using the LZ4 compression algorithm.\n\n5. Encrypt the payload chunk with ChaCha20, using the key generated in Step 3. The nonce is the first\n\n12 random bytes generated in Step 2.\n\n6. Calculate the MD5 hash of the victim information. The victim information consists of the globally\n\nunique identifier (GUID), botID, and computer name of the victim’s device.\n\n7. Encrypt the header chunk with ChaCha20, using the key embedded in the network configuration. The\n\nnonce is the last 12 random bytes generated in Step 2.\n\n8. Calculate the total size of the MD5 hash, which is the sum of 13, the nonce, the encrypted header\n\nchunk, and the encrypted payload chunk. Copy the MD5 hash onto the top of the message data.\n\n9. If the message is sent in TCP, add the size of the message data on top of the message data.\n\n**Payload chunk**\n\n\nSize of message (DWORD)\n\nMessage\n\n|Nonce [0:12]|Col2|Nonce [4:16]|\n|---|---|---|\n\n\nHTTP header\n\nMessage\n\n\nFigure 44. ScrambleCross’ compilation of request data\n\n\n-----\n\nScrambleCross, like Crosswalk, also receives backdoor commands from its C&C server, as shown in\n\nFigure 45, but these are very different from those for Crosswalk. In the case of ScrambleCross, the purpose\n\nof its backdoor commands is to receive plug-ins from the C&C server and to manipulate these plug-ins, as\n\nindicated in Table 1. However, since a backdoor command’s capacity for manipulating plug-ins depends\n\non the specific plug-in it receives, and we have been unable to retrieve any plug-ins from the server, we\n\nhave yet to determine the full extent of the commands’ plug-in manipulation functions.\n\nFigure 45. ScrambleCross receiving backdoor commands from its C&C server\n\n|Command|Action|\n|---|---|\n|0x0 0x64 0x5C 0x66 0x68 0x70 0x74|Do nothing. Run all the loaded plug-in’s entry at offset 0x48, which possibly tries to close sessions in the plug-in and close current sessions. Update the ChaCha20 key for message encryption and decryption on C&C communication. Change the current status based on the Base64-like string in response. Change the unknown DWORD value. Update the maximum interval period. Possibly uninstall all the plug-ins. Enumerate the loaded plug-ins, run the plug-in’s entry at offset 0x38 if it is already initialized, and then unload the plug-in.|\n\n\n-----\n\n|Command|Action|\n|---|---|\n|0x78 0x7C 0x7E 0x80 0x82 0x84 0x8C 0x8E None of the above|Find a plug-in by ID and, if it is already initialized, run the plug-in’s entry offset at 0x38. If the plug-in’s entry offset at 0x38 returns false, it will be unloaded. Possibly initialize a new plug-in. It receives new plug-in data from the C&C server and runs the plug-in’s entry at offset 0x30. Possibly try to remove a specified server challenge from the server challenge list. Find a plug-in by ID (or if 0xFF is specified, all plug-ins will be targeted) and, if it is already initialized, run the plug-in’s entry offset at 0x50. Afterward, look for the given challenge bytes in the registered challenge list and remove them from the list. Find a plug-in by ID and, if it is already initialized, run the plug-in’s entry offset at 0x38. If the plug-in’s entry offset at 0x38 returns false, the plug-in and related registered server challenge will be unloaded. Enumerate the user information and send it back to the C&C server. Change the unknown DWORD value. Send the current configuration values to the C&C server. Load additional configuration from the message and try to save to file. Enumerate all the loaded plug-ins and run the plug-in’s entry offset at 0x40.|\n\n\nTable 1. A list of backdoor commands for ScrambleCross\n\nBecause ScrambleCross supports HTTPS, some variants of this backdoor abuse Cloudflare Workers, a\n\ncomputing platform, to obscure their C&C server activity. Cloudflare Workers can prove to be a powerful\n\nand accessible tool for malicious actors for the following reasons:\n\n- Cloudflare Workers provides better scalability, making it useful for malicious actors who want to build\n\ntheir C&C infrastructure.\n\n- The malware will not communicate with the C&C server directly, posing a challenge for security\n\nanalysts to find the actual IP address to block. C&C traffic on Cloudflare Workers makes blocking of\n\nScrambleCross’ C&C server much more difficult because the observed IP address is a Cloudflare IP\n\naddress rather than that of the actual C&C server.\n\n- The Cloudflare Workers platform is allowed by many security products. Connections to Cloudflare\n\nWorkers are often considered legitimate and thus will likely be overlooked by network monitoring\n\nsolutions.\n\n\n-----\n\n## Attribution\n\nAs previously mentioned, we have concluded that the threat actors behind this malware are linked to\n\nEarth Baku. This attribution is supported by the following key findings.\n\n##### Use of install.bat\n\nDuring an incident response, we found the installer script for StealthVector called install.bat (Figure 46).\n\nThis is the same batch file used in a previous cyberespionage campaign carried out by APT41, according\n\nto the aforementioned FireEye report (Figure 47).\n\nFigure 46. The install.bat script\n\n\n-----\n\nFigure 47. The batch file used by APT41, according to FireEye’s report\n\n##### Code Similarities to the Shellcode Loader Used\n\n by APT41\n\nWe have observed that Storesyncsvc.dll, the DLL version used by StealthVector, has an entry point for\n\nservice (Figure 48) that resembles the one mentioned in FireEye’s report (Figure 49). There are also similar\n\nprocedures for loading the necessary APIs between the Storesyncsvc.dll versions of the StealthVector\n\nsample (Figure 50) and the one from the FireEye report (Figure 51).\n\n\n-----\n\nFigure 48. Storesyncsvc.dll in StealthVector\n\nFigure 49. Storesyncsvc.dll in the FireEye report sample\n\n\n-----\n\nFigure 50. Storesyncsvc.dll’s procedure for loading APIs in the StealthVector sample\n\nFigure 51. Storesyncsvc.dll’s procedure for loading APIs in the FireEye report sample\n\n##### Technique Similarities to Crosswalk\n\nCrosswalk and ScrambleCross implement similar techniques. Both pieces of malware decode their main\n\nfunctions and strings with XOR, after which they check the signature of the decoded section, as shown\n\nin Figure 52 and Figure 53.\n\n\n-----\n\nFigure 52. Crosswalk code that checks the signature of its decoded section\n\nFigure 53. ScrambleCross code that checks the signature of its decoded section\n\n\n-----\n\n## Conclusion and Security Recommendations\n\nThe discovery of these new pieces of malware demonstrates that Earth Baku consists of members with\n\nvaried skill sets. The group’s use of the StealthMutant and StealthVector loaders indicates that among\n\ntheir ranks is at least one member who is familiar with tools and techniques used by red teams. Likewise,\n\nthe group’s use of the ScrambleCross backdoor points to at least one member who likely has a deep\n\nknowledge of low-level programming and complex software development.\n\nEvidence of members with these collective skills obscures the true purpose behind this new campaign.\n\nEven though Earth Baku engaged in ransomware attacks in early 2020,[20] we have not observed the use\n\nof ransomware in this new campaign. Instead, as a report by Group-IB suggests,[21] this latest campaign\n\nby Earth Baku may be focused on cyberespionage. It is our hope that this report will encourage other\n\nsecurity researchers to publish further research about this threat actor group and its activities.\n\nHere are several measures that end users and organizations can take to defend their networks and\n\nsystems against cyberespionage tactics and minimize the risk of compromise:\n\n- **Practice the principle of least privilege. Limit access to sensitive data and carefully monitor user**\n\npermissions to make lateral movement more difficult for attackers who want to infiltrate a corporate\n\nnetwork.\n\n- **Be mindful of security gaps. Regularly update systems and applications, and enforce strict patch**\n\nmanagement policies. Practice virtual patching to secure any legacy systems for which patches are\n\nnot yet available.\n\n- **Have a proactive incident response strategy. Implement defensive measures that are designed to**\n\nassess threats and mitigate their impact in the event of a breach. Routinely carry out security drills to\n\ntest the efficiency of the organization’s incident response plan.\n\n- **Enforce the 3-2-1 rule. Store at least three copies of corporate data in two different formats, with**\n\none air-gapped copy located off-site. Routinely update and test these copies to ensure that there are\n\nno errors in the backup process.\n\n\n-----\n\nEnterprises and government agencies can benefit from advanced Trend Micro solutions that can proactively\n\nkeep IT environments protected from a wide range of cybersecurity threats. The Trend Micro™ XDR\n\nservice effectively protects connected emails, endpoints, servers, cloud workloads, and networks.[22] It\n\nuses powerful AI and expert security analytics to correlate data, and deliver fewer yet higher-fidelity alerts\n\nfor early threat detection. In a single console, it provides a broader perspective of enterprise systems\n\nwhile at the same time giving a more focused and optimized set of alerts. This allows IT security teams to\n\nhave better context for identifying threats more quickly and therefore to understand and remediate impact\n\nmuch more effectively.\n\nThe Trend Micro™ Managed XDR service, meanwhile, provides expert threat monitoring, correlation,\n\nand analysis from skilled and seasoned managed detection and response analysts.[23] Managed XDR\n\nis a flexible, 24/7 service that allows organizations to have a single source of detection, analysis, and\n\nresponse. Analyst expertise is enhanced by Trend Micro solutions that are optimized by AI and enriched\n\nby global threat intelligence. The Managed XDR service allows organizations to expand with the cloud\n\nwithout sacrificing security or overburdening IT teams.\n\n\n-----\n\n##### Appendix\n\n###### MITRE ATT&CK Tactics, Techniques, and Procedures\n\n|Tactic|ID|Technique|Procedure|Used by|\n|---|---|---|---|---|\n|Initial access|T1190|Exploit public- facing application|Earth Baku exploits SQL injection or CVE-2021-26855 to intrude on the network.|-|\n||T1566.001|Phishing: spear phishing attachment|Earth Baku possibly distributes spam with LNK attachments that download StealthVector.|-|\n|Execution|T1059.003|Command and scripting interpreter: Windows Command Shell|Earth Baku uses a batch file to install StealthVector.|-|\n||T1059.005|Command and scripting interpreter: Visual Basic|Earth Baku uses VBS to drop StealthVector.|-|\n||T1569.002|Service execution|Some variants of StealthVector are designed to be executed as a service.|StealthVector|\n||T1053.005|Scheduled task/ job: scheduled task|StealthMutant is executed via a scheduled task.|-|\n|Defense evasion|T1574.002|DLL sideloading|Some variants of StealthVector are designed to be executed by DLL sideloading.|StealthVector|\n||T1055.012|Process injection: process hollowing|StealthMutant and StealthVector can perform process hollowing and phantom DLL hollowing to inject the shellcode in a remote process.|StealthMutant, StealthVector|\n||T1562.006|Impair defenses: indicator blocking|StealthMutant and StealthVector can patch EtwEventWrite to disable logging by ETW.|StealthMutant, StealthVector|\n||T1027|Obfuscated files or information|StealthMutant uses XOR or AES-256-ECB to decrypt the payload. StealthVector uses ChaCha20 to decrypt both the configuration and the payload. The main function of ScrambleCross is encoded by XOR and its configuration is encrypted by ChaCha20.|StealthMutant, StealthVector, ScrambleCross|\n||T1218.004|Signed binary proxy execution: InstallUtil|Some variants of StealthVector, including its C# implementation StealthMutant, are executed by InstallUtil.|StealthMutant|\n\n\n-----\n\n|Tactic|ID|Technique|Procedure|Used by|\n|---|---|---|---|---|\n||T1036.003|Masquerading: rename system utilities|Earth Baku renames the legitimate CertUtil.exe to bypass detection.|-|\n||T1027.002|Obfuscated files or information: software packing|StealthMutant is packed by ConfuserEx.|StealthMutant|\n|Command and control|T1573.001|Encrypted channel: symmetric cryptography|ScrambleCross uses ChaCha20 for packet encryption.|ScrambleCross|\n||T1071.001|Application layer protocol: web protocols|The Cobalt Strike beacon uses HTTPS to communicate with the C&C server. ScrambleCross uses HTTP/HTTPS to communicate with the C&C server.|Cobalt Strike, ScrambleCross|\n||T1071.004|Application layer protocol: DNS|The Cobalt Strike beacon uses DNS to communicate with the C&C server.|Cobalt Strike|\n||T1090.004|Proxy: domain fronting|ScrambleCross abuses a legitimate CDN service to tunnel traffic to the actual C&C server.|ScrambleCross|\n||T1105|Ingress tool transfer|Earth Baku uses CertUtil.exe to download components from a URL.|-|\n\n\n###### Indicators of Compromise\n\n LNK Downloader Files\n\n**SHA-256**\n\n59fa89a19aa236aec216f0c8e8d59292b8d4e1b3c8b5f94038851cc5396d6513\n\n###### BAT Launcher Files\n\n|SHA-256|Detection|\n|---|---|\n|59fa89a19aa236aec216f0c8e8d59292b8d4e1b3c8b5f94038851cc5396d6513|Trojan.LNK.STEALTHVECTOR.ZYIF|\n\n|SHA-256|Detection|\n|---|---|\n|49e338c5ae9489556ae8f120a74960f3383381c91b8f03061ee588f6ad97e74c|Trojan. BAT.SVCLAUNCHER.ZYIF|\n|c8e3e27401ae87cbd891b46505b89f2970f8890de4b09cbaa538d827caa86b26|Trojan. BAT.SVCLAUNCHER.ZYIF|\n|d1175b88744606363f6fdf2df5980ca5a0898a3944fcf15f5c4c014473b043ca|Trojan. BAT.SVCLAUNCHER.ZYIF|\n|62d9e8f6e8ade53c6756f66beaaf4b9d93da6d390bf6f3ae1340389178a2fa29|Trojan. BAT.SVCLAUNCHER.ZYIF|\n|da4b86b9367151e0c36b90cb7329aca2d05f2984ce0e0181dd355b728acc4428|Trojan. BAT.SVCLAUNCHER.ZYIF|\n\n\n-----\n\n###### StealthMutant and Payloads\n\n**SHA-256**\n\n24ac3cc305576493beefab026d1cb7cce84f3bfcbcc51cdb5e612c290499390a\n\n209521bc350e7f5b28decba46bad81090a13f42eed396db3ca9a97eaf7902fe8\n\n34f95e0307959a376df28bc648190f72bccc5b25e0e00e45777730d26abb5316\n\nb7b2aa801dea2ec2797f8cf43b99c4bf8d0c1effe532c0c800b40336e9012af2\n\n8284c44f87ab8471918da564152ffcc28348a671e3a9316876b075cdf03c3607\n\ne66adbc6ca13dab9915aca30360c86b75e63e9c0845ac89217299fed556810cc\n\n6c5192a478bd7eca95f83ab3ebf036d4c1ffcc81e0354fa05f02f5fe4e8bfdf5\n\nce16e9a2d3722bb5f5b3636f307bd386ed24abafea72aeb6dd002d51eeca16df\n\n9269dc68d46630c0d534bf62a299037fd3a124a6459d97692c25ffb89ccd1f08\n\n04f6fc49da69838f5b511d8f996dc409a53249099bd71b3c897b98ad97fd867c\n\n730f4d8c1e774406105bbaad3cb4b466c27e0a50cf8345c236b42a80b437e2a8\n\n###### StealthVector\n\n|SHA-256|Detection|Payload|\n|---|---|---|\n|24ac3cc305576493beefab026d1cb7cce84f3bfcbcc51cdb5e612c290499390a|Backdoor.Win64. SCRAMBLECROSS.ZYIF. enc|Cobalt Strike beacon (HTTP)|\n|209521bc350e7f5b28decba46bad81090a13f42eed396db3ca9a97eaf7902fe8|Backdoor.Win64. COBEACON.ZYIF.enc|-|\n|34f95e0307959a376df28bc648190f72bccc5b25e0e00e45777730d26abb5316|Trojan.MSIL. STEALTHMUTANT.ZYIF|Encrypted payload not found|\n|b7b2aa801dea2ec2797f8cf43b99c4bf8d0c1effe532c0c800b40336e9012af2|Trojan.MSIL. STEALTHMUTANT.ZYIF|Encrypted payload not found|\n|8284c44f87ab8471918da564152ffcc28348a671e3a9316876b075cdf03c3607|Trojan.MSIL. STEALTHMUTANT.ZYIF|Encrypted payload not found|\n|e66adbc6ca13dab9915aca30360c86b75e63e9c0845ac89217299fed556810cc|Trojan.MSIL. STEALTHMUTANT.ZYIF|ScrambleCross|\n|6c5192a478bd7eca95f83ab3ebf036d4c1ffcc81e0354fa05f02f5fe4e8bfdf5|Backdoor.Win64. SCRAMBLECROSS.ZYIF. enc|-|\n|ce16e9a2d3722bb5f5b3636f307bd386ed24abafea72aeb6dd002d51eeca16df|Trojan.MSIL. STEALTHMUTANT.ZYIF|Cobalt Strike beacon (HTTPS)|\n|9269dc68d46630c0d534bf62a299037fd3a124a6459d97692c25ffb89ccd1f08|Backdoor.Win64. COBEACON.ZYIF.enc|-|\n|04f6fc49da69838f5b511d8f996dc409a53249099bd71b3c897b98ad97fd867c|Trojan.MSIL. STEALTHMUTANT.ZYIF|ScrambleCross|\n|730f4d8c1e774406105bbaad3cb4b466c27e0a50cf8345c236b42a80b437e2a8|Backdoor.Win64. SCRAMBLECROSS.ZYIF. enc|-|\n\n|SHA-256|Detection|Payload|\n|---|---|---|\n|9e178bb966f101e8c8ed020fbb2fb5878e2a969f7eaf47bc990f0472e85a3533|Trojan.Win64. STEALTHVECTOR. SMZTID-B|Encrypted payload not found|\n|d9d269a199ca0841fc71fef045c3dc5701a5042bea46d05a657b6db43fe55acc|Trojan.Win64. STEALTHVECTOR. SMZTID-B|Encrypted payload not found|\n|8da88951322fa7f464c13cb4a173d0c178f5e34a57957c9117b393133dd19925|Trojan.Win64. STEALTHVECTOR. SMZTID-B|Encrypted payload not found|\n\n\n-----\n\n|SHA-256|Detection|Payload|\n|---|---|---|\n|e009ef76fb9402fe379280ed9c6a4d81748fb259475b9048937f3d7c7f0f0f32|Trojan.Win64. STEALTHVECTOR. SMZTID-B|Encrypted payload not found|\n|e2ae201bd6a7397dcc5036260122e7d67046569b90c4f1b79ef8e34914729888|Trojan.Win64. STEALTHVECTOR. SMZTID-B|ScrambleCross|\n|c1b587a922691c7e01db3e57f223fa2b5d2df2121736922ff97141571c550cfc|Trojan.Win64. STEALTHVECTOR. SMZTID-B|Encrypted payload not found|\n|02378f64fd1083491cf5558397aae763ff047a5fa9fcaf624d1710b86f440777|Trojan.Win64. STEALTHVECTOR. SMZTID-B|Encrypted payload not found|\n|560a96e4577d09eb13416e5c4d649c346ca11a2459f09c8a3495d7c377c1f31d|Trojan.Win64. STEALTHVECTOR. SMZTID-B|Cobalt Strike beacon (Hybrid HTTP DNS)|\n|91aa05e3666c7e2443fc1f0f0142f1829f5ec51e289c95b10811531da50eb2b3|Trojan.Win64. STEALTHVECTOR. SMZTID-B|Cobalt Strike beacon (HTTPS)|\n|98f6be546c5191b67014e3d0f7f8df86715d970aa326a6a438d0be234daf8841|Trojan.Win64. STEALTHVECTOR. SMZTID-B|Encrypted payload not found|\n|477882b41e10aef0fcd0d5d33715dfb4eb7f8f3277057978ac77d3ec5914c6f9|Trojan.Win64. STEALTHVECTOR. SMZTID-B|Encrypted payload not found|\n|bf34dfb4140c00d23554b03ebb986b2734a2c396877681d526e2ac80b372268a|Trojan.Win64. STEALTHVECTOR. SMZTID-B|Encrypted payload not found|\n|d981edf78680f46616574b46ac3d0ab58a509430c155905761058152a24f091d|Trojan.Win64. STEALTHVECTOR.ZYIG|Cobalt Strike beacon (HTTPS)|\n\n\n###### Domains/IP addresses\n\n\n-----\n\n###### Cobalt Strike Configuration\n\n\n###### Hybrid HTTP DNS beacon\n\nBeaconType - Hybrid HTTP DNS\n\nPort - 1\n\nSleepTime - 300000\n\nMaxGetSize - 1404878\n\nJitter - 37\n\nMaxDNS - 255\n\nPublicKey_MD5 - df50953714f29628a7f6a6c97eb0bc2e\n\nC2Server - ns.cloud01.tk,/users/sign_in,ns.cloud20.tk,/users/sign_in\n\nUserAgent - Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; rv:11.0) like Gecko\n\nHttpPostUri - /signup/custom\n\nMalleable_C2_Instructions - Remove 3405 bytes from the end\n\nRemove 3366 bytes from the beginning\n\nBase64 URL-safe decode\n\nXOR mask w/ random key\n\nHttpGet_Metadata - ConstHeaders\n\nHost: fortawesome.com\n\nxhtml+xml,application/xml;q=0.9,*/*;q=0.8\n\nReferer: https://fortawesome.com/\n\nMetadata\n\nbase64url\n\nprepend “_fortawesome_session=”\n\nheader “Cookie”\n\nHttpPost_Metadata - ConstHeaders\n\n\n-----\n\nxml;q=0.9,*/*;q=0.8\n\n\nHost: fortawesome.com\n\nAccept: text/html,application/xhtml+xml,application/\n\nSessionId\n\nmask\n\nbase64url\n\nparameter “__uid”\n\nOutput\n\nmask\n\nbase64url\n\nprepend “remember_me=on&authenticity_token=”\n\nprint\n\n\nPipeName \nDNS_Idle - 8.8.8.8\n\nDNS_Sleep - 0\n\nSSH_Host - Not Found\n\nSSH_Port - Not Found\n\nSSH_Username - Not Found\n\nSSH_Password_Plaintext - Not Found\n\nSSH_Password_Pubkey Not Found\n\nSSH_Banner \nHttpGet_Verb - GET\n\nHttpPost_Verb - POST\n\nHttpPostChunk - 0\n\nSpawnto_x86 - %windir%\\syswow64\\rundll32.exe\n\nSpawnto_x64 - %windir%\\sysnative\\rundll32.exe\n\n\n-----\n\nCryptoScheme - 0\n\nProxy_configuration - Not Found\n\nProxy_User - Not Found\n\nProxy_Password - Not Found\n\nProxy_Behavior - Use IE settings\n\nWatermark - 305419896\n\nbStageCleanup - True\n\nbCFGCaution - False\n\nKillDate - 0\n\nbProcInject_StartRWX - False\n\nbProcInject_UseRWX - False\n\nbProcInject_MinAllocSize - 17500\n\nProcInject_PrependAppend_x86 - b’\\x90\\x90\\x90\\x90’\n\nEmpty\n\nProcInject_PrependAppend_x64 - b’\\x90\\x90\\x90\\x90’\n\nEmpty\n\nProcInject_Execute - ntdll:RtlUserThreadStart\n\nCreateThread\n\nNtQueueApcThread-s\n\nCreateRemoteThread\n\nRtlCreateUserThread\n\nProcInject_AllocationMethod - NtMapViewOfSection\n\nbUsesCookies - True\n\nHostHeader \nheadersToRemove - Not Found\n\nDNS_Beaconing - Not Found\n\n\n-----\n\nDNS_get_TypeA - Not Found\n\nDNS_get_TypeAAAA - Not Found\n\nDNS_get_TypeTXT - Not Found\n\nDNS_put_metadata - Not Found\n\nDNS_put_output - Not Found\n\nDNS_resolver - Not Found\n\nDNS_strategy - Not Found\n\nDNS_strategy_rotate_seconds - Not Found\n\nDNS_strategy_fail_x - Not Found\n\nDNS_strategy_fail_seconds - Not Found\n\n\n###### HTTPS beacon\n\nBeaconType - HTTPS\n\nPort - 443\n\nSleepTime - 60000\n\nMaxGetSize - 1404878\n\nJitter - 37\n\nMaxDNS - 255\n\nPublicKey_MD5 - df50953714f29628a7f6a6c97eb0bc2e\n\nC2Server - work.cloud01.tk,/users/sign_in,work.cloud20.tk,/\n\nusers/sign_in,185.118.166.205,/users/sign_in\n\nUserAgent - Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0;\n\nrv:11.0) like Gecko\n\nHttpPostUri - /signup/custom\n\nMalleable_C2_Instructions - Remove 3405 bytes from the end\n\nRemove 3366 bytes from the beginning\n\n\n-----\n\nBase64 URL-safe decode\n\nXOR mask w/ random key\n\nHttpGet_Metadata - ConstHeaders\n\nHost: fortawesome.com\n\nAccept: text/html,application/xhtml+xml,application/\n\nxml;q=0.9,*/*;q=0.8\n\nAccept-Encoding: gzip, deflate\n\nReferer: https://fortawesome.com/\n\nMetadata\n\nbase64url\n\nprepend “_fortawesome_session=”\n\nheader “Cookie”\n\nHttpPost_Metadata - ConstHeaders\n\nHost: fortawesome.com\n\nAccept: text/html,application/xhtml+xml,application/\n\nxml;q=0.9,*/*;q=0.8\n\nAccept-Encoding: gzip, deflate\n\nSessionId\n\nmask\n\nbase64url\n\nparameter “__uid”\n\nOutput\n\nmask\n\nbase64url\n\nprepend “remember_me=on&authenticity_token=”\n\nprint\n\nPipeName \n\n-----\n\nDNS_Idle - 8.8.8.8\n\nDNS_Slee - 0\n\nSSH_Host - Not Found\n\nSSH_Port - Not Found\n\nSSH_Username - Not Found\n\nSSH_Password_Plaintext - Not Found\n\nSSH_Password_Pubkey - Not Found\n\nSSH_Banner \nHttpGet_Verb - GET\n\nHttpPost_Verb - POST\n\nHttpPostChunk - 0\n\nSpawnto_x86 - %windir%\\syswow64\\rundll32.exe\n\nSpawnto_x64 - %windir%\\sysnative\\rundll32.exe\n\nCryptoScheme - 0\n\nProxy_configuration - Not Found\n\nProxy_User - Not Found\n\nProxy_Password - Not Found\n\nProxy_Behavior - Use IE settings\n\nWatermark - 305419896\n\nbStageCleanup - True\n\nbCFGCaution - False\n\nKillDate - 0\n\nbProcInject_StartRWX - False\n\nbProcInject_UseRWX - False\n\nbProcInject_MinAllocSize - 17500\n\nProcInject_PrependAppend_x86 - b’\\x90\\x90\\x90\\x90’\n\n\n-----\n\nEmpty\n\nProcInject_PrependAppend_x64 - b’\\x90\\x90\\x90\\x90’\n\nEmpty\n\nProcInject_Execute - ntdll:RtlUserThreadStart\n\nCreateThread\n\nNtQueueApcThread-s\n\nCreateRemoteThread\n\nRtlCreateUserThread\n\nProcInject_AllocationMethod - NtMapViewOfSection\n\nbUsesCookies - True\n\nHostHeader \nheadersToRemove - Not Found\n\nDNS_Beaconing - Not Found\n\nDNS_get_TypeA - Not Found\n\nDNS_get_TypeAAAA - Not Found\n\nDNS_get_TypeTXT - Not Found\n\nDNS_put_metadata - Not Found\n\nDNS_put_output - Not Found\n\nDNS_resolver - Not Found\n\nDNS_strategy - Not Found\n\nDNS_strategy_rotate_seconds - Not Found\n\nDNS_strategy_fail_x - Not Found\n\nDNS_strategy_fail_seconds - Not Found\n\n\n-----\n\n##### References\n\n1 Trend Micro. (April 19, 2017). Trend Micro. “Examining a Possible Member of the Winnti Group.” Accessed on July 9, 2021, at\n[https://www.trendmicro.com/en_us/research/17/d/pigs-malware-examining-possible-member-winnti-group.html.](https://www.trendmicro.com/en_us/research/17/d/pigs-malware-examining-possible-member-winnti-group.html)\n\n2 Joseph C. Chen et al. (July 9, 2021). Trend Micro. “BIOPASS RAT: New Malware Sniffs Victims via Live Streaming.” Accessed\n[on July 9, 2021, at https://www.trendmicro.com/en_us/research/21/g/biopass-rat-new-malware-sniffs-victims-via-live-](https://www.trendmicro.com/en_us/research/21/g/biopass-rat-new-malware-sniffs-victims-via-live-streaming.html)\n[streaming.html.](https://www.trendmicro.com/en_us/research/21/g/biopass-rat-new-malware-sniffs-victims-via-live-streaming.html)\n\n3 Benson Sy. (June 29, 2015). Trend Micro. “MERS News Used in Targeted Attack against Japanese Media Company.”\n[Accessed on July 9, 2021, at https://blog.trendmicro.com/trendlabs-security-intelligence/mers-news-used-in-targeted-attack-](https://blog.trendmicro.com/trendlabs-security-intelligence/mers-news-used-in-targeted-attack-against-japanese-media-company/)\n[against-japanese-media-company/.](https://blog.trendmicro.com/trendlabs-security-intelligence/mers-news-used-in-targeted-attack-against-japanese-media-company/)\n\n4 Daniel Lunghi et al. (Feb. 18, 2020). Trend Micro. “Uncovering DRBControl: Inside the Cyberespionage Campaign Targeting\n[Gambling Operations.” Accessed on July 9, 2021, at https://www.trendmicro.com/vinfo/us/security/news/cyber-attacks/](https://www.trendmicro.com/vinfo/us/security/news/cyber-attacks/operation-drbcontrol-uncovering-a-cyberespionage-campaign-targeting-gambling-companies-in-southeast-asia)\n[operation-drbcontrol-uncovering-a-cyberespionage-campaign-targeting-gambling-companies-in-southeast-asia.](https://www.trendmicro.com/vinfo/us/security/news/cyber-attacks/operation-drbcontrol-uncovering-a-cyberespionage-campaign-targeting-gambling-companies-in-southeast-asia)\n\n5 The United States Department of Justice. (Sept. 16, 2020). The United States Department of Justice. “Seven International\nCyber Defendants, Including ‘Apt41’ Actors, Charged In Connection With Computer Intrusion Campaigns Against More Than\n[100 Victims Globally.” Accessed on July 16, 2021, at https://www.justice.gov/opa/pr/seven-international-cyber-defendants-](https://www.justice.gov/opa/pr/seven-international-cyber-defendants-including-apt41-actors-charged-connection-computer)\n[including-apt41-actors-charged-connection-computer.](https://www.justice.gov/opa/pr/seven-international-cyber-defendants-including-apt41-actors-charged-connection-computer)\n\n6 Positive Technologies. (Jan. 14, 2021). Positive Technologies. “Higaisa or Winnti? APT41 backdoors, old and new.” Accessed\n[on July 16, 2021, at https://www.ptsecurity.com/ww-en/analytics/pt-esc-threat-intelligence/higaisa-or-winnti-apt-41-](https://www.ptsecurity.com/ww-en/analytics/pt-esc-threat-intelligence/higaisa-or-winnti-apt-41-backdoors-old-and-new)\n[backdoors-old-and-new.](https://www.ptsecurity.com/ww-en/analytics/pt-esc-threat-intelligence/higaisa-or-winnti-apt-41-backdoors-old-and-new)\n\n7 Christopher Glyer et al. (March 25, 2020). FireEye Threat Research Blog. “This Is Not a Test: APT41 Initiates Global Intrusion\n[Campaign Using Multiple Exploits.” Accessed on July 16, 2021, at https://www.fireeye.com/blog/threat-research/2020/03/](https://www.fireeye.com/blog/threat-research/2020/03/apt41-initiates-global-intrusion-campaign-using-multiple-exploits.html)\n[apt41-initiates-global-intrusion-campaign-using-multiple-exploits.html.](https://www.fireeye.com/blog/threat-research/2020/03/apt41-initiates-global-intrusion-campaign-using-multiple-exploits.html)\n\n8 Bernardo Damele, Miroslav Stampar, and Alessandro Tanasi. (Jan. 19, 2021). Github. “sqlmap/plugins/dbms/mssqlserver/\n[filesystem.py.” Accessed on July 16, 2021, at https://github.com/sqlmapproject/sqlmap/blob/master/plugins/dbms/](https://github.com/sqlmapproject/sqlmap/blob/master/plugins/dbms/mssqlserver/filesystem.py#L281-L333)\n[mssqlserver/filesystem.py#L281-L333.](https://github.com/sqlmapproject/sqlmap/blob/master/plugins/dbms/mssqlserver/filesystem.py#L281-L333)\n\n9 Nitesh Surana. (April 14, 2021). Trend Micro. “Could the Microsoft Exchange breach be stopped?” Accessed on July 22, 2021,\n[at https://www.trendmicro.com/en_us/devops/21/d/could-the-microsoft-exchange-breach-be-stopped.html.](https://www.trendmicro.com/en_us/devops/21/d/could-the-microsoft-exchange-breach-be-stopped.html)\n\n10 Thomas Dupuy, Matthieu Faou, and Mathieu Tartare. (March 10, 2021). WeLiveSecurity. “Exchange servers under siege from\n[at least 10 APT groups.” Accessed on July 16, 2021, at https://www.welivesecurity.com/2021/03/10/exchange-servers-under-](https://www.welivesecurity.com/2021/03/10/exchange-servers-under-siege-10-apt-groups)\n[siege-10-apt-groups.](https://www.welivesecurity.com/2021/03/10/exchange-servers-under-siege-10-apt-groups)\n\n[11 ambray. (Oct 24, 2017). GitHub. “ProcessHollowing/ShellLoader/Loader.cs.” Accessed on July 16, 2021, at https://github.](https://github.com/ambray/ProcessHollowing/blob/master/ShellLoader/Loader.cs)\n[com/ambray/ProcessHollowing/blob/master/ShellLoader/Loader.cs.](https://github.com/ambray/ProcessHollowing/blob/master/ShellLoader/Loader.cs)\n\n12 Yoshihiro Ishikawa. (May 21, 2021). LAC. “Microsoft社のデジタル署名を悪用した「Cobalt Strike loader」による標的型攻撃〜\n[攻撃者グループAPT41.” Accessed on July 16, 2021, at https://www.lac.co.jp/lacwatch/report/20210521_002618.html.](https://www.lac.co.jp/lacwatch/report/20210521_002618.html)\n\n13 Internet Research Task Force. (May 2015). IETF Trust. “ChaCha20 and Poly1305 for IETF Protocols.” Accessed on July 16,\n[2021, at https://datatracker.ietf.org/doc/html/rfc7539.](https://datatracker.ietf.org/doc/html/rfc7539)\n\n14 Raphael Mudge. (April 9, 2018). CobaltStrike. “Cobalt Strike 3.11 – The snake that eats its tail.” Accessed on July 16, 2021, at\n\n[https://blog.cobaltstrike.com/2018/04/09/cobalt-strike-3-11-the-snake-that-eats-its-tail.](https://blog.cobaltstrike.com/2018/04/09/cobalt-strike-3-11-the-snake-that-eats-its-tail)\n\n15 CyCraft Research Team. (April 15, 2020). Cycraft. “APT Group Chimera - APT Operation Skeleton Key Targets Taiwan\n[Semiconductor Vendors.” Accessed on July 16, 2021, at https://cycraft.com/download/%5BTLP-White%5D20200415%20](https://cycraft.com/download/%5BTLP-White%5D20200415%20Chimera_V4.1.pdf)\n[Chimera_V4.1.pdf.](https://cycraft.com/download/%5BTLP-White%5D20200415%20Chimera_V4.1.pdf)\n\n16 Takahiro Haruyama. (2021). VMware Carbon Black. “Knock, knock, Neo. - Active C2 Discovery Using Protocol Emulation.”\n[Accessed on July 16, 2021, at https://jsac.jpcert.or.jp/archive/2021/pdf/JSAC2021_201_haruyama_jp.pdf.](https://jsac.jpcert.or.jp/archive/2021/pdf/JSAC2021_201_haruyama_jp.pdf)\n\n17 The United States Department of Justice. (Aug. 13, 2020). The United States Department of Justice. “Seven International\nCyber Defendants, Including ‘Apt41’ Actors, Charged In Connection With Computer Intrusion Campaigns Against More Than\n[100 Victims Globally.” Accessed on July 16, 2021, at https://www.justice.gov/opa/pr/seven-international-cyber-defendants-](https://www.justice.gov/opa/pr/seven-international-cyber-defendants-including-apt41-actors-charged-connection-computer)\n[including-apt41-actors-charged-connection-computer.](https://www.justice.gov/opa/pr/seven-international-cyber-defendants-including-apt41-actors-charged-connection-computer)\n\n\n-----\n\n18 Sudeep Singh and Atinderpal Singh. (June 11, 2020). ZScaler. “The Return of the Higaisa APT.” Accessed on July 16, 2021, at\n\n[https://www.zscaler.com/blogs/security-research/return-higaisa-apt.](https://www.zscaler.com/blogs/security-research/return-higaisa-apt)\n\n19 VMware. (Sept. 30, 2019). VMware. “CB Threat Analysis Unit: Technical Analysis of ‘Crosswalk.’” Accessed on July 16, 2021,\n[at https://www.carbonblack.com/blog/cb-threat-analysis-unit-technical-analysis-of-crosswalk.](https://www.carbonblack.com/blog/cb-threat-analysis-unit-technical-analysis-of-crosswalk)\n\n20 CyCraft Technology Corp. (June 2, 2021). Medium. “China-Linked Threat Group Targets Taiwan Critical Infrastructure,\n[Smokescreen Ransomware.” Accessed on July 16, 2021, at https://medium.com/cycraft/china-linked-threat-group-targets-](https://medium.com/cycraft/china-linked-threat-group-targets-taiwan-critical-infrastructure-smokescreen-ransomware-c2a155aa53d5)\n[taiwan-critical-infrastructure-smokescreen-ransomware-c2a155aa53d5.](https://medium.com/cycraft/china-linked-threat-group-targets-taiwan-critical-infrastructure-smokescreen-ransomware-c2a155aa53d5)\n\n21 Nikita Rostovcev. (June 10, 2021). Group-IB. “Big airline heist: APT41 likely behind massive supply chain attack.” Accessed\n[on July 16, 2021, at https://blog.group-ib.com/colunmtk_apt41.](https://blog.group-ib.com/colunmtk_apt41)\n\n[22 Trend Micro. (n.d.). Trend Micro. “XDR.” Accessed on July 22, 2021, at https://www.trendmicro.com/en_us/business/](https://www.trendmicro.com/en_us/business/products/detection-response/xdr.html)\n[products/detection-response/xdr.html.](https://www.trendmicro.com/en_us/business/products/detection-response/xdr.html)\n\n[23 Trend Micro. (n.d.). Trend Micro. “Managed XDR.” Accessed on July 22, 2021, at https://www.trendmicro.com/en_us/](https://www.trendmicro.com/en_us/business/products/detection-response/managed-xdr-mdr.html)\n[business/products/detection-response/managed-xdr-mdr.html.](https://www.trendmicro.com/en_us/business/products/detection-response/managed-xdr-mdr.html)\n\n\n-----\n\n© S\n\n\n**TREND MICRO[TM] RESEARCH**\n\nTrend Micro, a global leader in cybersecurity, helps to make the world safe for exchanging digital information.\n\nTrend Micro Research is powered by experts who are passionate about discovering new threats, sharing key insights, and supporting\nefforts to stop cybercriminals. Our global team helps identify millions of threats daily, leads the industry in vulnerability disclosures,\nand publishes innovative research on new threat techniques. We continually work to anticipate new threats and deliver thought-\nprovoking research.\n\n[www.trendmicro.com](https://www.trendmicro.com)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "d63ae2b7-445f-460d-965d-2676dacdb6de",
            "created_at": "2022-10-25T15:59:19.552139Z",
            "updated_at": "2022-10-25T15:59:19.552139Z",
            "deleted_at": null,
            "name": "APTnotes",
            "url": "https://github.com/aptnotes/data",
            "description": "APTnotes data",
            "reports": null
        },
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        },
        {
            "id": "6fc23d14-23a6-4870-8fad-b291b182596f",
            "created_at": "2022-10-25T16:07:18.480113Z",
            "updated_at": "2022-10-25T16:07:18.480113Z",
            "deleted_at": null,
            "name": "ETDA",
            "url": "https://apt.etda.or.th",
            "description": "Threat Group Cards: A Threat Actor Encyclopedia",
            "reports": null
        },
        {
            "id": "bf5be533-fa31-4590-ae37-5761c97ffa34",
            "created_at": "2022-10-25T16:13:58.389257Z",
            "updated_at": "2022-10-25T16:13:58.389257Z",
            "deleted_at": null,
            "name": "Malpedia",
            "url": "https://malpedia.caad.fkie.fraunhofer.de",
            "description": "Malpedia is a free service offered by Fraunhofer FKIE",
            "reports": null
        },
        {
            "id": "5910e58f-4bc9-4e4e-9dbb-887804094a01",
            "created_at": "2022-10-25T16:32:58.457399Z",
            "updated_at": "2022-10-25T16:32:58.457399Z",
            "deleted_at": null,
            "name": "OTX",
            "url": "https://otx.alienvault.com",
            "description": "Alienvault Open Threat Exchange (OTX)",
            "reports": null
        },
        {
            "id": "99593a68-7f6e-400e-9a9f-a707f66d2e72",
            "created_at": "2022-11-23T11:07:14.353321Z",
            "updated_at": "2022-11-23T11:07:14.353321Z",
            "deleted_at": null,
            "name": "AGRO",
            "url": "https://apt.threattracking.com",
            "description": "APT Groups and Operations Spreadsheet",
            "reports": null
        }
    ],
    "references": [
        "https://app.box.com/s/qtqlwejty7xz8wj8osz98webycgo5j9x",
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2021/2021.08.24.Earth_Baku_Returns/wp-earth-baku-an-apt-group-targeting-indo-pacific-countries.pdf",
        "https://documents.trendmicro.com/assets/white_papers/wp-earth-baku-an-apt-group-targeting-indo-pacific-countries.pdf"
    ],
    "report_names": [
        "TrendMicro_earth-baku-indo-pacific-countries(08-24-2021)",
        "wp-earth-baku-an-apt-group-targeting-indo-pacific-countries",
        "wp-earth-baku-an-apt-group-targeting-indo-pacific-countries.pdf"
    ],
    "threat_actors": [
        {
            "id": "67bf0462-41a3-4da5-b876-187e9ef7c375",
            "created_at": "2022-10-25T16:07:23.44832Z",
            "updated_at": "2025-03-27T02:02:09.806007Z",
            "deleted_at": null,
            "main_name": "Careto",
            "aliases": [
                "Careto",
                "The Mask",
                "Ugly Face"
            ],
            "source_name": "ETDA:Careto",
            "tools": [
                "Careto"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "873a6c6f-a4d1-49b3-8142-4a147d4288ef",
            "created_at": "2022-10-25T16:07:23.455744Z",
            "updated_at": "2025-03-27T02:02:09.811933Z",
            "deleted_at": null,
            "main_name": "Chimera",
            "aliases": [
                "Operation Skeleton Key"
            ],
            "source_name": "ETDA:Chimera",
            "tools": [
                "Agentemis",
                "Cobalt Strike",
                "CobaltStrike",
                "SkeletonKeyInjector",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "610a7295-3139-4f34-8cec-b3da40add480",
            "created_at": "2023-01-06T13:46:38.608142Z",
            "updated_at": "2025-03-27T02:00:02.87217Z",
            "deleted_at": null,
            "main_name": "Cobalt",
            "aliases": [
                "Cobalt Gang",
                "GOLD KINGSWOOD",
                "COBALT SPIDER",
                "G0080",
                "Mule Libra",
                "Cobalt Group"
            ],
            "source_name": "MISPGALAXY:Cobalt",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "aa73cd6a-868c-4ae4-a5b2-7cb2c5ad1e9d",
            "created_at": "2022-10-25T16:07:24.139848Z",
            "updated_at": "2025-03-27T02:02:10.120505Z",
            "deleted_at": null,
            "main_name": "Safe",
            "aliases": [],
            "source_name": "ETDA:Safe",
            "tools": [
                "DebugView",
                "LZ77",
                "OpenDoc",
                "SafeDisk",
                "TypeConfig",
                "UPXShell",
                "UsbDoc",
                "UsbExe"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "f88b16bc-df4b-48e7-ae35-f4117240ff24",
            "created_at": "2022-10-25T15:50:23.556699Z",
            "updated_at": "2025-03-27T02:00:55.499173Z",
            "deleted_at": null,
            "main_name": "Chimera",
            "aliases": [
                "Chimera"
            ],
            "source_name": "MITRE:Chimera",
            "tools": [
                "PsExec",
                "esentutl",
                "Mimikatz",
                "Cobalt Strike"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "5bbced13-72f7-40dc-8c41-dcce75bf885e",
            "created_at": "2022-10-25T15:50:23.695735Z",
            "updated_at": "2025-03-27T02:00:55.525839Z",
            "deleted_at": null,
            "main_name": "Winnti Group",
            "aliases": [
                "Winnti Group"
            ],
            "source_name": "MITRE:Winnti Group",
            "tools": [
                "PipeMon",
                "Winnti for Windows",
                "PlugX"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "873919c0-bc6a-4c19-b18d-c107e4aa3d20",
            "created_at": "2023-01-06T13:46:39.138138Z",
            "updated_at": "2025-03-27T02:00:03.005534Z",
            "deleted_at": null,
            "main_name": "Higaisa",
            "aliases": [],
            "source_name": "MISPGALAXY:Higaisa",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "945a572f-ebe3-4e2f-a288-512fe751cfa8",
            "created_at": "2022-10-25T16:07:24.413971Z",
            "updated_at": "2025-03-27T02:02:10.212853Z",
            "deleted_at": null,
            "main_name": "Winnti Group",
            "aliases": [
                "Wicked Panda",
                "Winnti Group"
            ],
            "source_name": "ETDA:Winnti Group",
            "tools": [
                "Agentemis",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "FunnySwitch",
                "RbDoor",
                "RibDoor",
                "RouterGod",
                "Winnti",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "30c9c492-afc6-4aa1-8fe6-cecffed946e0",
            "created_at": "2022-10-25T15:50:23.400822Z",
            "updated_at": "2025-03-27T02:00:55.461334Z",
            "deleted_at": null,
            "main_name": "Higaisa",
            "aliases": [
                "Higaisa"
            ],
            "source_name": "MITRE:Higaisa",
            "tools": [
                "PlugX",
                "certutil",
                "gh0st RAT"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "4c68ccd0-caba-4189-9ead-86ac4c2d9b70",
            "created_at": "2024-05-01T02:03:07.930196Z",
            "updated_at": "2025-03-27T02:05:17.251237Z",
            "deleted_at": null,
            "main_name": "BRONZE ATLAS",
            "aliases": [
                "Axiom",
                "BARIUM ",
                "Blackfly ",
                "CTG-2633",
                "GREF",
                "Group 72 ",
                "Red Kelpie ",
                "TG-2633 ",
                "Wicked Panda ",
                "Winnti",
                "APT41 "
            ],
            "source_name": "Secureworks:BRONZE ATLAS",
            "tools": [
                " CCleaner v5.33 backdoor",
                " ChinaChopper",
                " Cobalt Strike",
                " Dicey MSDN",
                " ForkPlayground",
                " HUC Proxy Malware (Htran)",
                " Mimikatz",
                " PipeMon",
                " PlugX",
                " PortReuse",
                " Powershell Empire",
                " RCMD",
                " RbDoor",
                " SPEEDBOAT",
                " ShadowPad",
                " Sidewalk",
                " Speculoos",
                " TeamViewer",
                " Winnkit",
                " Winnti",
                " reg save",
                " vssadmin",
                "Acehash"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "c0cedde3-5a9b-430f-9b77-e6568307205e",
            "created_at": "2022-10-25T16:07:23.528994Z",
            "updated_at": "2025-03-27T02:02:09.847683Z",
            "deleted_at": null,
            "main_name": "DarkHotel",
            "aliases": [
                "APT-C-06",
                "ATK 52",
                "CTG-1948",
                "Dubnium",
                "Fallout Team",
                "Higaisa",
                "Luder",
                "Operation DarkHotel",
                "Operation Daybreak",
                "Operation Inexsmar",
                "Operation PowerFall",
                "Operation The Gh0st Remains the Same",
                "SIG25",
                "Shadow Crane",
                "T-APT-02",
                "Tungsten Bridge",
                "Zigzag Hail"
            ],
            "source_name": "ETDA:DarkHotel",
            "tools": [
                "Asruex",
                "DarkHotel",
                "DmaUp3.exe",
                "GreezeBackdoor",
                "Karba",
                "Nemain",
                "Nemim",
                "Ramsay",
                "Retro",
                "Tapaoux",
                "Trojan.Win32.Karba.e",
                "Virus.Win32.Pioneer.dx",
                "igfxext.exe",
                "msieckc.exe"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "c7d9878a-e691-4c6f-81ae-84fb115a1345",
            "created_at": "2022-10-25T16:07:23.359506Z",
            "updated_at": "2025-03-27T02:02:09.752427Z",
            "deleted_at": null,
            "main_name": "APT 41",
            "aliases": [
                "BrazenBamboo",
                "Bronze Atlas",
                "Double Dragon",
                "Earth Baku",
                "Grayfly",
                "Operation ColunmTK",
                "Operation CuckooBees",
                "Operation ShadowHammer",
                "Red Kelpie",
                "SparklingGoblin",
                "TA415",
                "TG-2633"
            ],
            "source_name": "ETDA:APT 41",
            "tools": [
                "9002 RAT",
                "ADORE.XSEC",
                "ASPXSpy",
                "ASPXTool",
                "AceHash",
                "Agent.dhwf",
                "Agentemis",
                "AndroidControl",
                "AngryRebel",
                "AntSword",
                "BIOPASS",
                "BIOPASS RAT",
                "BLUEBEAM",
                "Barlaiy",
                "BlackCoffee",
                "Bladabindi",
                "BleDoor",
                "CCleaner Backdoor",
                "CHINACHOPPER",
                "COLDJAVA",
                "China Chopper",
                "ChyNode",
                "Cobalt Strike",
                "CobaltStrike",
                "Crackshot",
                "CrossWalk",
                "CurveLast",
                "CurveLoad",
                "DAYJOB",
                "DBoxAgent",
                "DEADEYE",
                "DEADEYE.APPEND",
                "DEADEYE.EMBED",
                "DEPLOYLOG",
                "DIRTCLEANER",
                "DUSTTRAP",
                "Derusbi",
                "Destroy RAT",
                "DestroyRAT",
                "DodgeBox",
                "DragonEgg",
                "ELFSHELF",
                "EasyNight",
                "Farfli",
                "FunnySwitch",
                "Gh0st RAT",
                "Ghost RAT",
                "HDD Rootkit",
                "HDRoot",
                "HKDOOR",
                "HOMEUNIX",
                "HUI Loader",
                "HidraQ",
                "HighNoon",
                "HighNote",
                "Homux",
                "Hydraq",
                "Jorik",
                "Jumpall",
                "KEYPLUG",
                "Kaba",
                "Korplug",
                "LATELUNCH",
                "LOLBAS",
                "LOLBins",
                "LightSpy",
                "Living off the Land",
                "Lowkey",
                "McRAT",
                "MdmBot",
                "MessageTap",
                "Meterpreter",
                "Mimikatz",
                "MoonBounce",
                "MoonWalk",
                "Motnug",
                "Moudour",
                "Mydoor",
                "NTDSDump",
                "PACMAN",
                "PCRat",
                "PINEGROVE",
                "PNGRAT",
                "POISONPLUG",
                "POISONPLUG.SHADOW",
                "POTROAST",
                "PRIVATELOG",
                "PipeMon",
                "PlugX",
                "PortReuse",
                "ProxIP",
                "ROCKBOOT",
                "RbDoor",
                "RedDelta",
                "RedXOR",
                "RibDoor",
                "Roarur",
                "RouterGod",
                "SAGEHIRE",
                "SPARKLOG",
                "SQLULDR2",
                "STASHLOG",
                "SWEETCANDLE",
                "ScrambleCross",
                "Sensocode",
                "SerialVlogger",
                "ShadowHammer",
                "ShadowPad Winnti",
                "SinoChopper",
                "Skip-2.0",
                "SneakCross",
                "Sogu",
                "Speculoos",
                "Spyder",
                "StealthReacher",
                "StealthVector",
                "TERA",
                "TIDYELF",
                "TIGERPLUG",
                "TOMMYGUN",
                "TVT",
                "Thoper",
                "Voldemort",
                "WIDETONE",
                "WINNKIT",
                "WINTERLOVE",
                "Winnti",
                "WyrmSpy",
                "X-Door",
                "XDOOR",
                "XMRig",
                "XShellGhost",
                "Xamtrav",
                "ZXShell",
                "ZoxPNG",
                "certutil",
                "certutil.exe",
                "cobeacon",
                "gresim",
                "njRAT",
                "pwdump",
                "xDll"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "5c13338b-eaed-429a-9437-f5015aa98276",
            "created_at": "2022-10-25T16:07:23.582715Z",
            "updated_at": "2025-03-27T02:02:09.875151Z",
            "deleted_at": null,
            "main_name": "Emissary Panda",
            "aliases": [
                "APT 27",
                "ATK 15",
                "Bronze Union",
                "Budworm",
                "Earth Smilodon",
                "Emissary Panda",
                "Group 35",
                "Iron Taurus",
                "Iron Tiger",
                "LuckyMouse",
                "Operation DRBControl",
                "Operation Iron Tiger",
                "Operation PZChao",
                "Operation SpoiledLegacy",
                "Operation StealthyTrident",
                "Red Phoenix",
                "TEMP.Hippo",
                "TG-3390",
                "ZipToken"
            ],
            "source_name": "ETDA:Emissary Panda",
            "tools": [
                "ASPXSpy",
                "ASPXTool",
                "Agent.dhwf",
                "AngryRebel",
                "Antak",
                "CHINACHOPPER",
                "China Chopper",
                "Destroy RAT",
                "DestroyRAT",
                "FOCUSFJORD",
                "Farfli",
                "Gh0st RAT",
                "Ghost RAT",
                "HTTPBrowser",
                "HTran",
                "HUC Packet Transmit Tool",
                "HighShell",
                "HttpBrowser RAT",
                "HttpDump",
                "HyperBro",
                "HyperSSL",
                "HyperShell",
                "Kaba",
                "Korplug",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "Mimikatz",
                "Moudour",
                "Mydoor",
                "Nishang",
                "OwaAuth",
                "PCRat",
                "PlugX",
                "ProcDump",
                "PsExec",
                "RedDelta",
                "SEASHARPEE",
                "Sensocode",
                "SinoChopper",
                "Sogu",
                "SysUpdate",
                "TIGERPLUG",
                "TVT",
                "Thoper",
                "Token Control",
                "TokenControl",
                "TwoFace",
                "WCE",
                "Windows Credential Editor",
                "Windows Credentials Editor",
                "Xamtrav",
                "ZXShell",
                "gsecdump",
                "luckyowa"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "4d5f939b-aea9-4a0e-8bff-003079a261ea",
            "created_at": "2023-01-06T13:46:39.04841Z",
            "updated_at": "2025-03-27T02:00:02.985296Z",
            "deleted_at": null,
            "main_name": "APT41",
            "aliases": [
                "G0096",
                "Grayfly",
                "BARIUM",
                "BRONZE ATLAS",
                "BRONZE EXPORT",
                "Red Kelpie",
                "HOODOO",
                "Brass Typhoon",
                "TA415",
                "WICKED SPIDER",
                "WICKED PANDA",
                "G0044",
                "Earth Baku"
            ],
            "source_name": "MISPGALAXY:APT41",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "e698860d-57e8-4780-b7c3-41e5a8314ec0",
            "created_at": "2022-10-25T15:50:23.287929Z",
            "updated_at": "2025-03-27T02:00:55.43005Z",
            "deleted_at": null,
            "main_name": "APT41",
            "aliases": [
                "APT41",
                "Wicked Panda",
                "Brass Typhoon",
                "BARIUM"
            ],
            "source_name": "MITRE:APT41",
            "tools": [
                "ASPXSpy",
                "BITSAdmin",
                "PlugX",
                "Impacket",
                "gh0st RAT",
                "netstat",
                "PowerSploit",
                "ZxShell",
                "KEYPLUG",
                "ipconfig",
                "sqlmap",
                "China Chopper",
                "ShadowPad",
                "MESSAGETAP",
                "Mimikatz",
                "certutil",
                "njRAT",
                "Cobalt Strike",
                "pwdump",
                "BLACKCOFFEE",
                "ROCKBOOT",
                "dsquery",
                "Winnti for Linux",
                "DUSTTRAP",
                "Derusbi",
                "ftp"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "d11c89bb-1640-45fa-8322-6f4e4053d7f3",
            "created_at": "2022-10-25T15:50:23.509601Z",
            "updated_at": "2025-03-27T02:00:55.487991Z",
            "deleted_at": null,
            "main_name": "Turla",
            "aliases": [
                "Turla",
                "IRON HUNTER",
                "Group 88",
                "Waterbug",
                "WhiteBear",
                "Krypton",
                "Venomous Bear",
                "Secret Blizzard",
                "BELUGASTURGEON"
            ],
            "source_name": "MITRE:Turla",
            "tools": [
                "PsExec",
                "nbtstat",
                "ComRAT",
                "netstat",
                "certutil",
                "KOPILUWAK",
                "IronNetInjector",
                "LunarWeb",
                "Arp",
                "Uroburos",
                "PowerStallion",
                "Kazuar",
                "Systeminfo",
                "LightNeuron",
                "Mimikatz",
                "Tasklist",
                "LunarMail",
                "HyperStack",
                "NBTscan",
                "TinyTurla",
                "Penquin",
                "LunarLoader"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "0639667a-fb3f-43d9-a38c-6c123fd19c7f",
            "created_at": "2022-10-25T16:07:23.335869Z",
            "updated_at": "2025-03-27T02:02:09.743237Z",
            "deleted_at": null,
            "main_name": "APT 19",
            "aliases": [
                "APT 19",
                "Bronze Firestone",
                "C0d0so0",
                "Codoso",
                "Deep Panda",
                "Operation Kingslayer",
                "Red Pegasus",
                "Sunshop Group",
                "TG-3551"
            ],
            "source_name": "ETDA:APT 19",
            "tools": [
                "Agentemis",
                "C0d0so0",
                "Cobalt Strike",
                "CobaltStrike",
                "Derusbi",
                "EmPyre",
                "EmpireProject",
                "Fire Chili",
                "PowerShell Empire",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "e254cf33-e7f5-407b-a8a1-1a856a9f1c71",
            "created_at": "2025-01-21T02:00:03.599871Z",
            "updated_at": "2025-03-27T02:00:03.480307Z",
            "deleted_at": null,
            "main_name": "Operation DRBControl",
            "aliases": [],
            "source_name": "MISPGALAXY:Operation DRBControl",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "6d2910b0-9fea-46a2-84e6-a043b1e023e4",
            "created_at": "2022-10-25T16:07:23.946958Z",
            "updated_at": "2025-03-27T02:02:10.044112Z",
            "deleted_at": null,
            "main_name": "Operation DRBControl",
            "aliases": [],
            "source_name": "ETDA:Operation DRBControl",
            "tools": [],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1666716495,
    "ts_updated_at": 1743041835,
    "ts_creation_date": 1629370526,
    "ts_modification_date": 1629370538,
    "files": {
        "pdf": "https://archive.orkl.eu/f5ba5f8240569e08da4796deb95b89ee1340d03d.pdf",
        "text": "https://archive.orkl.eu/f5ba5f8240569e08da4796deb95b89ee1340d03d.txt",
        "img": "https://archive.orkl.eu/f5ba5f8240569e08da4796deb95b89ee1340d03d.jpg"
    }
}