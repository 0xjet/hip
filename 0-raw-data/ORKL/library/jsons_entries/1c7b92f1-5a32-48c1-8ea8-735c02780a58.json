{
    "id": "1c7b92f1-5a32-48c1-8ea8-735c02780a58",
    "created_at": "2022-10-25T16:48:24.595674Z",
    "updated_at": "2025-03-27T02:15:45.344433Z",
    "deleted_at": null,
    "sha1_hash": "441f48b969b4448c18c6382282db8ac548f8a3e5",
    "title": "",
    "authors": "",
    "file_creation_date": "2020-01-14T06:28:33Z",
    "file_modification_date": "2020-01-14T06:28:33Z",
    "file_size": 1435954,
    "plain_text": "# APT27 ZxShell RootKit module updates\n\n**lab52.io/blog/apt27-rootkit-updates**\n\nJagaimoKawaii\n\nWithin the toolset of the different APT groups, one of the most interesting elements and the one\nthat generally worries the most, are their capabilities in Ring0, generally RootKit/Bootkit type\nthreats that act with the maximum level of privileges.\n\nAn example of this type of threats is the RootKit module of ZxShell RAT used by Emissary Panda\n(APT27), of which there is a relatively recent sample (Uploaded to Virustotal since 2019-09-21\n17:59:39) that is also correctly signed, so it can be loaded in the latest version of Windows 10 and\nis perfectly functional as far as we have been able to check.\n\nSysmon DriverLoaded event\n\nA complete analysis of this threat can be found made by the analyst Ori Damari (@0xrepnz) in his\n[blog (https://repnz.github.io/posts/autochk-rootkit-analysis/). After analyzing this threat and](https://repnz.github.io/posts/autochk-rootkit-analysis/)\ndescribing its capabilities, he has rewritten the source code from a sample of this threat uploaded\nin 2018 to Virustotal, and published it in GitHub, which greatly facilitates the analysis of newer\nversions. As he describes in his blog, the capabilities of this Rootkit are basically the following:\n\n**File Redirection – Redirect malicious files to benign files. If you try to call CreateFile() to**\nopen a malicious file you’ll get a handle to a benign file.\n\n**Network Connection Hiding – Hide network connections from tools like**\nnetstat,proceshacker…\n\n\n-----\n\nWe found interesting to analyze the differences between the 2018 version and the most recent\n2019 version in order to try to identify new capabilities or changes in its capabilities. After\ncomparing both samples using the GitHub source code, we have been able to see that most of\nthe functions are identical, except for 5 of them (including the Driver’s entrypoint):\n\nIdentical functions in both versions\n\nDifferent functions\n\nAfter analyzing the differences between this 5 funtcions, we have been able to observe that all the\nchanges are focused on avoiding detections by slightly “obfuscating” some IOCs hardcoded as\nstrings and code modification without impact in the capabilities on the driver…\n\nIn total, there are three notable changes between the two versions:\n\nThe first one basically consists in that they have reversed the list of strings that identify the\nfiles that the Driver hides by default when it is loaded:\n\nOld and New list of file names\n\n\n-----\n\nAt code level, the impact this has had is that the function that redirects these files, now uses the\n“wcrev” function that flips the strings before passing them to the function that hides the files:\n\nNew code (Red) and old code (Green)\n\nSecondly, they have tried to disguise their use of the undocumented Microsoft API\n“ObReferenceObjectByName”, which is used to get the pointer to the different\nDriver_Object drivers they intend to hook in each case. Until now, they had the name of this\nfunction in their strings, and used it to resolve it by passing its name to the\nMmGetSystemRoutineAddress API which returns a pointer to it. Now they only keep part of\nthe name, and complete the rest in a slightly more complex way before calling\nMmGetSystemRoutineAddress by building it from characters they store in the registers and\nother areas of the binary:\n\n_New code (Red) and old code (Green)_\n\n\n-----\n\nFinally, they have moved part of the logic of some functions to another point, maintaining\nthe same functionality. An example is the end of the driver entry function, where untill now,\nat the end they only called two functions that initialized the logic of hiding connections and\nredirecting files, and now, they have extracted part of the logic of these functions and\nmoved it right after each one of them, but without any impact on the capabilities and\nbehavior of the Driver:\n\n_New code (Red) and old code (Green)_\n\n\n## x64 Sample\n\n x86 Sample\n\n\n## 42eab05c611bf24d86bb6c985‐ caa2ad7380ed7d98340c7f08de9361be14dc244\n\n 9b7c1e37d5f56c‐ c0b5e5e22ce9805e237a189297e78405b9c392a0953b6e0321\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        }
    ],
    "references": [
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2020/2020.01.13.APT27_ZxShell_RootKit/APT27%20ZXShell%20RootKit%20module%20updates.pdf"
    ],
    "report_names": [
        "APT27 ZXShell RootKit module updates"
    ],
    "threat_actors": [
        {
            "id": "2f07a03f-eb1f-47c8-a8e9-a1a00f2ec253",
            "created_at": "2022-10-25T16:07:24.277669Z",
            "updated_at": "2025-03-27T02:02:10.157972Z",
            "deleted_at": null,
            "main_name": "TA428",
            "aliases": [
                "Operation LagTime IT",
                "Operation StealthyTrident",
                "ThunderCats"
            ],
            "source_name": "ETDA:TA428",
            "tools": [
                "8.t Dropper",
                "8.t RTF exploit builder",
                "8t_dropper",
                "Agent.dhwf",
                "Albaniiutas",
                "BlueTraveller",
                "Chymine",
                "Cotx RAT",
                "CoughingDown",
                "Darkmoon",
                "Destroy RAT",
                "DestroyRAT",
                "Gen:Trojan.Heur.PT",
                "Kaba",
                "Korplug",
                "LuckyBack",
                "PhantomNet",
                "PlugX",
                "Poison Ivy",
                "RedDelta",
                "RoyalRoad",
                "SManager",
                "SPIVY",
                "Sogu",
                "TIGERPLUG",
                "TManger",
                "TVT",
                "Thoper",
                "Xamtrav",
                "pivy",
                "poisonivy"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "e3492534-85a6-4c87-a754-5ae4a56d7c8c",
            "created_at": "2022-10-25T15:50:23.819113Z",
            "updated_at": "2025-03-27T02:00:55.552554Z",
            "deleted_at": null,
            "main_name": "Threat Group-3390",
            "aliases": [
                "Threat Group-3390",
                "Earth Smilodon",
                "TG-3390",
                "Emissary Panda",
                "BRONZE UNION",
                "APT27",
                "Iron Tiger",
                "LuckyMouse"
            ],
            "source_name": "MITRE:Threat Group-3390",
            "tools": [
                "Systeminfo",
                "gsecdump",
                "PlugX",
                "ASPXSpy",
                "Cobalt Strike",
                "Mimikatz",
                "Impacket",
                "gh0st RAT",
                "certutil",
                "China Chopper",
                "HTTPBrowser",
                "Tasklist",
                "netstat",
                "SysUpdate",
                "HyperBro",
                "ZxShell",
                "RCSession",
                "ipconfig",
                "Clambling",
                "pwdump",
                "NBTscan",
                "Pandora",
                "Windows Credential Editor"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "2c980ea7-04c4-4193-8535-52f87e66a96e",
            "created_at": "2024-05-01T02:03:07.994126Z",
            "updated_at": "2025-03-27T02:05:17.293799Z",
            "deleted_at": null,
            "main_name": "BRONZE UNION",
            "aliases": [
                "Budworm ",
                "Emissary Panda ",
                "Iron Tiger ",
                "Lucky Mouse ",
                "TG-3390 ",
                "Temp.Hippo ",
                "APT27 "
            ],
            "source_name": "Secureworks:BRONZE UNION",
            "tools": [
                " ASPXSpy",
                " China Chopper",
                " Enfal",
                " Gh0st RAT",
                " HttpBrowser",
                " Hunter",
                " HyperBro",
                " OwaAuth",
                " PlugX",
                " PoisonIvy",
                " Sysupdate",
                " ZxShell",
                "9002"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "c63ab035-f9f2-4723-959b-97a7b98b5942",
            "created_at": "2023-01-06T13:46:38.298354Z",
            "updated_at": "2025-03-27T02:00:02.798255Z",
            "deleted_at": null,
            "main_name": "APT27",
            "aliases": [
                "TG-3390",
                "EMISSARY PANDA",
                "TEMP.Hippo",
                "Budworm",
                "Group 35",
                "BRONZE UNION",
                "Lucky Mouse",
                "Iron Taurus",
                "GreedyTaotie",
                "Red Phoenix",
                "ZipToken",
                "Iron Tiger",
                "G0027",
                "Earth Smilodon"
            ],
            "source_name": "MISPGALAXY:APT27",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "5c13338b-eaed-429a-9437-f5015aa98276",
            "created_at": "2022-10-25T16:07:23.582715Z",
            "updated_at": "2025-03-27T02:02:09.875151Z",
            "deleted_at": null,
            "main_name": "Emissary Panda",
            "aliases": [
                "APT 27",
                "ATK 15",
                "Bronze Union",
                "Budworm",
                "Earth Smilodon",
                "Emissary Panda",
                "Group 35",
                "Iron Taurus",
                "Iron Tiger",
                "LuckyMouse",
                "Operation DRBControl",
                "Operation Iron Tiger",
                "Operation PZChao",
                "Operation SpoiledLegacy",
                "Operation StealthyTrident",
                "Red Phoenix",
                "TEMP.Hippo",
                "TG-3390",
                "ZipToken"
            ],
            "source_name": "ETDA:Emissary Panda",
            "tools": [
                "ASPXSpy",
                "ASPXTool",
                "Agent.dhwf",
                "AngryRebel",
                "Antak",
                "CHINACHOPPER",
                "China Chopper",
                "Destroy RAT",
                "DestroyRAT",
                "FOCUSFJORD",
                "Farfli",
                "Gh0st RAT",
                "Ghost RAT",
                "HTTPBrowser",
                "HTran",
                "HUC Packet Transmit Tool",
                "HighShell",
                "HttpBrowser RAT",
                "HttpDump",
                "HyperBro",
                "HyperSSL",
                "HyperShell",
                "Kaba",
                "Korplug",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "Mimikatz",
                "Moudour",
                "Mydoor",
                "Nishang",
                "OwaAuth",
                "PCRat",
                "PlugX",
                "ProcDump",
                "PsExec",
                "RedDelta",
                "SEASHARPEE",
                "Sensocode",
                "SinoChopper",
                "Sogu",
                "SysUpdate",
                "TIGERPLUG",
                "TVT",
                "Thoper",
                "Token Control",
                "TokenControl",
                "TwoFace",
                "WCE",
                "Windows Credential Editor",
                "Windows Credentials Editor",
                "Xamtrav",
                "ZXShell",
                "gsecdump",
                "luckyowa"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1666716504,
    "ts_updated_at": 1743041745,
    "ts_creation_date": 1578983313,
    "ts_modification_date": 1578983313,
    "files": {
        "pdf": "https://archive.orkl.eu/441f48b969b4448c18c6382282db8ac548f8a3e5.pdf",
        "text": "https://archive.orkl.eu/441f48b969b4448c18c6382282db8ac548f8a3e5.txt",
        "img": "https://archive.orkl.eu/441f48b969b4448c18c6382282db8ac548f8a3e5.jpg"
    }
}