{
    "id": "252e425c-10b3-4967-9f45-d76ae1875bbb",
    "created_at": "2023-01-12T15:04:57.636554Z",
    "updated_at": "2025-03-27T02:17:23.238048Z",
    "deleted_at": null,
    "sha1_hash": "549dfeaac59975fd0fe31de5c07a55b1cb17e991",
    "title": "2017-05-16 - Wannacryptor Ransomworm",
    "authors": "",
    "file_creation_date": "2022-05-28T19:30:05Z",
    "file_modification_date": "2022-05-28T19:30:05Z",
    "file_size": 1069934,
    "plain_text": "# WanaCrypt0r Ransomworm\n\n**[baesystemsai.blogspot.de/2017/05/wanacrypt0r-ransomworm.html](https://baesystemsai.blogspot.de/2017/05/wanacrypt0r-ransomworm.html)**\n\n_Written by Sergei Shevchenko and Adrian Nish_\n\nBACKGROUND\n\nSince the release of the ETERNALBLUE exploit by ‘The Shadow Brokers’ last month security\nresearchers have been watching for a mass attack on global networks. This came on Friday 12th\nMay when it was bundled with ransomware called WanaCrypt0r and let loose. Initial reports of attacks\nwere highlighted by Telefonica in Spain but the malware quickly spread to networks in the UK where\nthe National Health Service (NHS) was impacted, followed by many other networks across the world.\n\nThe infographic below illustrates the key components of the WanaCrypt0r ransomware. This is\ndescribed in further detail in subsequent sections of this report along with initial clues on attribution.\n\nANALYSIS: Initial Vector\n\nThe initial infection vector is still unknown. Reports by some of phishing emails have been dismissed\nby other researchers as relevant only to a different (unrelated) ransomware campaign, called Jaff.\n\n\n-----\n\nThere is also a working theory that initial compromise may have come from SMB shares exposed to\nthe public internet. Results from Shodan show over 1.5 million devices with port 445 open – the\n[attacker could have infected those shares directly.](https://www.shodan.io/search?query=port%3A445)\n\nThe Dropper/Worm\n\nThe infection starts from a 3.6Mb executable file named `mssecsvc.exe or` `lhdfrgui.exe .`\nDepending on how it's executed, it can function as a dropper or as a worm.\n\nWhen run, the executable first checks if it can connect to the following URL:\n```\nhttp://www.iuqerfsodp9ifjaposdfjhgosurijfaewrwergwea[.]com\n\n```\nThe connection is checked with the `WinINet functions, shown below:`\n```\n 01 qmemcpy(&szUrl,\n 02     \"http://www.iuqerfsodp9ifjaposdfjhgosurijfaewrwergwea[.]com\",\n 03     57u);\n 04 h1 = InternetOpenA(0, INTERNET_OPEN_TYPE_DIRECT, 0, 0, 0);\n 05 h2 = InternetOpenUrlA(h1, &szUrl, 0, 0,\n 06            INTERNET_FLAG_RELOAD | INTERNET_FLAG_NO_CACHE_WRITE,\n 07            0);\n 08 if (h2)\n 09 {\n 10  InternetCloseHandle(h1);   // if connection succeeds, then quit\n 11  InternetCloseHandle(h2);\n 12  result = 0;\n 13 }\n 14 else\n 15 {\n 16  InternetCloseHandle(h1);   // if connection fails\n 17  InternetCloseHandle(0);\n 18  PAYLOAD();          // then call the payload\n 19  result = 0;\n 20 }\n 21 return result;\n\n```\n\n-----\n\nThat means that if the executable is unable to connect to the URL above, it will call the payload.\nAlternatively, it will activate a payload on an air-gapped system, such as a system within a hospital\nnetwork.\n\nIt is also worth noting that this connection is not proxy aware, therefore in an enterprise IT\nenvironment it is unlikely to be able to connect to the domain triggering the payload.\n\nIf the executable is run with no command line parameters, it will register and then run itself as a\nservice:\n```\nService name: \"mssecsvc2.0\"\nService Description: \"Microsoft Security Center (2.0) Service\"\nService executable: \"%ORIGINAL_NAME% -m security\"\n\n```\nwhere `%ORIGINAL_NAME% is the original name of the executable, such as` `mssecsvc.exe or`\n```\nlhdfrgui.exe .\n\n```\nNext, it will start the created service. The payload of the executable will load its own resource called\n```\n\"R/1831\", and save it as:\nc:\\windows\\tasksche.exe\n\n```\nThe original `c:\\windows\\tasksche.exe file is renamed into` `c:\\windows\\qeriuwjhrf .`\n\nFinally, the executable will execute the dropped resource as:\n```\n\"c:\\windows\\tasksche.exe /i\"\n\n```\nIf this executable is started as a service, its service handling procedure will invoke a network\nreplication code, explained below.\n\nEternalBlue Port\n\nSince the Shadow Brokers leaked the EquationGroup / NSA FuzzBunch software, a researcher with\n[the handle @zerosum0x0 has](https://twitter.com/zerosum0x0) [reverse engineered the ETERNALBLUE SMBv1/SMBv2 exploit](https://zerosum0x0.blogspot.com/2017/04/doublepulsar-initial-smb-backdoor-ring.html)\nagainst Windows Server 2008 R2 SP1 x64. This was released on 21st April 2017.\n\nAs @zerosum0x0 predicted:\n\n_“Every major malware family, from botnets to ransomware to banking spyware, will eventually add the_\n_exploits in the FuzzBunch toolkit to their arsenal. This payload is simply a mechanism to load more_\n_malware with full system privileges... This is a jewel compared to the scraps that were given to_\n_Stuxnet. It comes in a more dangerous era than the days of Conficker. Given the persistence of the_\n_missing MS08-067 patch, we could be in store for a decade of breaches emanating from MS17-010_\n_exploits. It is the perfect storm for one of the most damaging malware infections in computing history.”_\n\nThis work was further expanded on with an open-source project \"MS17-010 Windows SMB RCE\",\n[developed by RiskSense Operations, and includes both a Metasploit scanner and a Python port.](https://github.com/RiskSense-Ops/MS17-010)\n\n\n-----\n\nOn 9th of May 2017, the Python port was further improved to _Store original shellcode in binary,_\n_rather than python string representation\"._\n\n[In order to \"Make it faster\", the shellcode was now declared as binary, further lowering the barrier of](https://github.com/RiskSense-Ops/MS17-010/blob/master/exploits/eternalblue/eternalblue.dat)\nporting it into C++ code.\n\nIt appears that the ransomware took advantage of the published Python source, along with the\nshellcode binaries – the SMB structures found in the ransomware are identical to the published ones\n(e.g. the “Exploits” section of this project was used to infect remote hosts with DOUBLEPULSAR\nbackdoor). The published raw SMB packets appear to be copy-pasted into C++ code, and then\nrecompiled using ported blobs – most likely without even understanding how the EternalBlue\nSMBv1/SMBv2 exploit actually works.\n\nA detailed description of the network replication and worm functionality is described in Appendix B.\n\nThe Payload\n\nThe payload is a 3.4Mb file called `tasksche.exe, created from the worm's resource` `\"1831\" .`\nSuch a large size is explained by the bundled TOR executables along with other tools and\nconfiguration files.\n\nInternal name of this executable is `diskpart.exe .`\n\nThis file contains another embedded resource in it, named as `\"XIA/2058\" . This resource is a ZIP`\nfile.\n\nIf the file detects it was executed without the `\"/i\" switch – that is, it was not executed by the worm,`\nit will register itself as a service to provide itself with a persistence mechanism that does not require\nthe worm.\n\nFor that, it will first generate a pseudo-random name that is derived from the current computer name.\nFor example:\n```\ntdyhddeaprj852\n\n```\nNext, it will create read-only directories, and copy itself into those directories, such as:\n\n     - `c:\\ProgramData\\%RANDOM_NAME%\\%EXE_NAME%`\n     - `c:\\Intel\\%RANDOM_NAME%\\%EXE_NAME%`\n\nwhere `%RANDOM_NAME% is the previously generated pseudo-random name, and` `%EXE_NAME% is the`\nname of its own executable.\n\n\n-----\n\nFor example:\n\n     - `c:\\ProgramData\\tdyhddeaprj852\\tasksche.exe`\n     - `c:\\Intel\\tdyhddeaprj852\\tasksche.exe`\n\nNext, it will create a new service:\n```\nService name: %RANDOM_NAME% Service Description: %RANDOM_NAME% Service executable:\n\"cmd.exe /c %FULL_PATH_FILENAME%\"\n\n```\nwhere `%FULL_PATH_FILENAME% is the full path filename of the malicious executable.`\n\nFollowing this, it starts the service or directly runs the newly created executable as:\n```\n\"cmd.exe /c %FULL_PATH_FILENAME%\"\n\n```\nTo make sure there is only one copy of the executable running, it relies on a mutex named as:\n```\n\"Global\\MsWinZonesCacheCounterMutexA\"\n\n```\nEncryption Phase\n\nThe malware then proceeds to its file encryption phase.\n\nIt will register its working directory in the registry value:\n```\nHKLM\\SOFTWARE\\WanaCrypt0r\\wd: \"%WORKING_DIR%\"\n\n```\nNext, it will unzip its embedded resource `\"XIA/2058\" into the working directory, using ZIP`\npassword `\"WNcry@2ol7\" .`\n\nThis will create a number of the files, such as a command line TOR executable, required libraries,\nransom messages in various languages, and other tools:\n\n     - `b.wnry – a bitmap image with the ransom note in it`\n     - `c.wnry – binary configuration file`\n     - `r.wnry – a text file with the ransom note in it`\n     - `s.wnry – a ZIP file with command line TOR executable, required libraries`\n     - `t.wnry – encrypted ransomware DLL`\n     - `taskdl.exe – an executable that enumerates and deletes temp files on each drive,`\nlooking for files with `.WNCRYT extension in` `%DRIVE%:\\$RECYCLE and` `%TEMP% directories`\n     - `taskse.exe – an executable that starts` `@WanaDecryptor@.exe`\n     - `u.wnry – ransomware’s decryptor executable that opens a GUI with a ransom note in it`\n     - `msg\\m_*.wnry – a directory with ransom notes in different languages`\n\nIt will then read the unzipped configuration file `c.wnry – this file contains the following list of`\n```\n.onion domains:\n\n```\n\n-----\n\n```\ngx7ekbenv2riucmf.onion\n57g7spgrzlojinas.onion\nxxlvbrloxvriy2c5.onion\n76jdd2ir2embyv47.onion\ncwwnhwhlz52maqm7.onion\n\n```\nNext, it picks up a random Bitcoin address out of three hard-coded ones – the list below shows the\nbalances at the time of analysis:\n```\n13AM4VW2dhxYgXeQepoHkHSQuy6NgaEb94 - 15.13562354 BTC = $26410\n12t9YDPgwueZ9NyMgw519p7AA8isjr6SMw - 13.78022431 BTC = $24045\n115p7UMMngoj1pMvkpHijcRdfJNXj6LrLn - 5.98851225 BTC = $17361\n\n```\nHence, the total amount of the collected ransom at the time of writing is ~USD$68K.\n\nThe selected Bitcoin address is then saved back into `c.wnry file. Thus, the purpose of this file is to`\nstore configuration.\n\nNext, the ransomware runs the following commands to assign 'hidden' attribute to all of its files and to\nallow full access rights for all users:\n```\n\"attrib +h .\"\n\"icacls . /grant Everyone:F /T /C /Q\"\n\n```\nIt then imports a 2048-bit public RSA key from a hard-coded 1,172-byte blob, stored within the\nexecutable. Next, it reads the unzipped resource file `t.wnry that starts from a` `\"WANACRY!\"`\nmarker, and decrypts an AES key from here, using an RSA public key.\n\nThe recovered AES key is then used to decrypt the rest of `t.wnry file contents, using AES-128`\n(CBC).\n\nThe blob decrypted from `t.wnry turns out to be a PE-file - the malware parses its PE header, then`\ndynamically loads into a newly allocated memory, and calls its entry point.\n\n\n-----\n\nThis PE file is a DLL, and the called entry point corresponds to its DllEntryPoint() export.\n\nInternal name of this DLL is `kbdlv.dll . The malware locates and then calls its export TaskStart().`\n\nThe Ransomware DLL\n\nThe main DLL module of the ransomware has an internal name `kbdlv.dll . Its export TaskStart() is`\ncalled to invoke the ransomware’s file encryption logic.\n\nThe DLL first creates a mutex `\"MsWinZonesCacheCounterMutexA\" to make sure there is only one`\ncopy of ransomware activated. Next, it reads `c.wnry - a configuration file that stores the list of TOR`\nservices.\n\nThe ransomware will attempt to terminate a number of processes, such as SQL server and MS\n_Exchange server, by running commands:_\n```\ntaskkill.exe /f /im mysqld.exe\ntaskkill.exe /f /im sqlwriter.exe\ntaskkill.exe /f /im sqlserver.exe\ntaskkill.exe /f /im MSExchange*\ntaskkill.exe /f /im Microsoft.Exchange.*\n\n```\nIt will then spawn a number of threads, including a file encryption thread.\n\nIt will not attempt to encrypt files within directories that contain following strings in their names:\n\n     - `\\Intel`\n     - `\\ProgramData`\n     - `\\WINDOWS`\n     - `\\Program Files`\n     - `\\Program Files (x86)`\n     - `\\AppData\\Local\\Temp`\n     - `\\Local Settings\\Temp`\n     - `This folder protects against ransomware. Modifying it will reduce`\n```\n   protection\n\n```\n     - `Temporary Internet Files`\n     - `Content.IE5`\n\nBefore the encrypted files are written, the ransomware checks the free disk space with\n_GetDiskFreeSpaceExW() to make sure it does not run out of free space._\n\nFinally, the DLL creates a copy of the previously unzipped file `u.wnry, saving and then running it as`\n\n```\n@WanaDecryptor@.exe.\n\n```\n\nThe Ransomware EXE\n\nThe EXE module `@WanaDecryptor@.exe is run by the DLL (a copy of the previously unzipped file`\n```\nu.wnry ). It is a GUI application with the window name being \"Wana Decrypt0r 2.0\" .\n\n```\n\n-----\n\nTo delete Windows shadow copies, it runs the commands:\n```\ncmd.exe /c vssadmin delete shadows /all /quiet &\nwmic shadowcopy delete &\nbcdedit /set {default} bootstatuspolicy ignoreallfailures &\nbcdedit /set {default} recoveryenabled no &\nwbadmin delete catalog -quiet\n\n```\nThis executable will connect to C&C via TOR `.onion domains, in order to anonymise its C&C`\ntraffic.\n\nOnce the ransom is paid, the executable is able to check the status of the payment, and allow file\ndecryption.\n\nAttribution\n\nThe WanaCrypt0r ransomware released on 12th May is not the only version. Earlier this year, there\nwas another version released (example MD5: `9c7c7149387a1c79679a87dd1ba755bc ).`\n\n[The older version has a timestamp of 9th February 2017, and was first submitted to VirusTotal on](https://virustotal.com/en/file/3e6de9e2baacf930949647c399818e7a2caea2626df6a468407854aaa515eed9/analysis/)\n10th February 2017.\n\nSimilar to the latest version, it also relies on external files, only the used extension is `.wry instead`\nof `.wnry :`\n\n     - `n.wry`\n     - `cg.wry`\n     - `t1.wry`\n     - `t2.wry`\n\nThe latest version downloads a TOR client from:\n```\nhttps://dist.torproject.org/torbrowser/6.5.1/tor-win32-0.2.9.10.zip\n\n```\nThe older version downloads a TOR client from:\n```\nhttps://www.torproject.org/dist/torbrowser/6.0.8/tor-win32-0.2.8.11.zip\n\n```\nBoth old and new version extract the ZIP file into the `TaskData folder.`\n\nIt's worth noting that the older variant of ransomware also attempted to replicate across\n```\n\\\\%IP%\\ipc$ network shares. Hence, the idea of the network replication was brewing in the\n\n```\nattackers' minds long before 'The Shadow Brokers' release.\n\nThe older version of WanaCrypt0r ransomware relies on a function that generates a random buffer,\nusing an internal table that consists of 75 WORDs:\n\n\n-----\n\nThe implementation of this function is very unique - it cannot be found in any legitimate software. The\nonly other sample where this function can also be found (almost identical, but with minor tweaks) is a\nsample of Contopee backdoor (MD5: `ac21c8ad899727137c4b94458d7aa8d8 ), first submitted to`\nVirusTotal on 15th August 2015.\n\n[This code overlap was first noticed and tweeted by Google researcher Neel Mehta. This was quickly](https://twitter.com/neelmehta/status/864164081116225536)\n[followed up on by Kaspersky Labs in a blogpost.](https://securelist.com/blog/research/78431/wannacry-and-lazarus-group-the-missing-link/)\n\nThe Contopee backdoor sample uses this function as part of its communication protocol with the C&C\nserver. This backdoor family is a tool from the Lazarus threat actors.\n\n\n-----\n\nThe re-use of code is a characteristic of the Lazarus group we noted in our report last year on attacks\nagainst SWIFT [systems. This re-use is at the source-code level, providing strong evidence of](https://baesystemsai.blogspot.co.uk/2016/05/cyber-heist-attribution.html)\ncommon development environment.\n\nThis, along with other overlaps with Lazarus’ previous campaigns is described below:\n\nCharacteristic Lazarus code example WanaCrypt0r example\n\n\nRandom buffer\ngenerator\nfunction\n\nCode /\nCompiler\n\n\nAugust 2015\n\nContopee backdoor:\n```\nac21c8ad899727137c4b94458d7aa8d8\n\n```\n\nJanuary 2017\n\nWanaCrypt0r:\n```\n9c7c7149387a1c79679a87dd1ba755bc\n\n```\n\nC++ / Visual Studio 6.0 C++ / Visual Studio 6.0\n\n\n‘leetspeak’ `y0uar3@s!llyid!07`\n\n[Referenced in US-CERT alert following](https://www.us-cert.gov/ncas/alerts/TA14-353A)\nSONY attack.\n\n\n-----\n\nCryptoCurrency Lazarus has targeted Bitcoin related\ncompanies in recent months – possibly\nlooking for ways to steal/launder funds.\n\nA watering-hole (same as described in\nour [blog) was setup in February on a](https://baesystemsai.blogspot.co.uk/2017/02/lazarus-watering-hole-attacks.html)\npopular Bitcoin website.\n\n\nWanaCrypt0r uses Bitcoin addresses to\nreceive ransom payments.\n\n\nAs noted in our [attribution post last year, use of Visual Studio 6.0 is not a significant observation on](https://baesystemsai.blogspot.co.uk/2016/05/cyber-heist-attribution.html)\nits own – however, this development environment dates from 1998 and is rarely used by malware\ncoders. Nonetheless, it has been seen repeatedly with Lazarus attacks.\n\nCONCLUSIONS\n\nCoupling an SMB worm to ransomware has created a highly effective threat – albeit one which\nwreaks havoc for relatively little monetary gain. Even though $68K may represent a modest profit for\nthe attackers, moving the money from those bitcoin wallets will attract significant attention from lawenforcement and could identify their money-laundering networks. It is very likely they will not get their\nhands on any money once this is all over.\n\nWhilst the SMB worm code has been copy/pasted from elsewhere, the ransomware author is clearly\nan experienced malware-dev. They include checks such as filepaths for anti-ransomware products to\navoid detection of their operation. There are mistakes though, such as the “kill-switch” which has\nbeen widely discussed. Assuming they used the Python port of code released on 9th May, it implies a\nvery short turn around between development and attack; it is therefore possible the worm got loose\nwhilst the code was still in testing. Either way, the attackers will learn from this campaign, and may\nreturn with updated code whilst vulnerabilities remain unpatched.\n\nThe linkages to the Lazarus campaign are tantalising clues as to who may be ultimately behind this.\nFollowing on from last year's attacks on SWIFT systems and this year's attacks on banks in Poland &\nMexico they continue to demonstrate that they are a considerable menace to network defenders.\nUnderstanding their tools, techniques and procedures is challenging given the shifting nature of\nattacks seen, however deserves maximum focus and co-operation across the security community.\n\nThe biggest lesson to be learned from this attack though is the on-going challenge which\norganisations running critical infrastructure face with patching. This isn’t the first case of selfpropagating malware impacting healthcare networks we’ve investigated; indeed this reminds us a lot\nof the QBot/Qakbot [episode last year. Then, as now, hospitals are exposed by running on out-of-date](http://www.baesystems.com/en/cybersecurity/feature/the-return-of-qbot)\nsystems and with minimal resources to spend on security. The WanaCrypt0r campaign has brought\nthis to international attention – how to fix the problem going forward will need swift debate among\ntechnology experts and policy makers to avert similar crises in future.\n\nRECOMMENDATIONS\n\n    - [Install patch MS17-010 as a matter of urgency. For out of support operating systems such as](http://10.10.0.46/://technet.microsoft.com/en-us/library/security/ms17-010.aspx)\n[XP, Win8 and Server 2003 apply the out of band patch.](https://blogs.technet.microsoft.com/msrc/2017/05/12/customer-guidance-for-wannacrypt-attacks/%20%20)\n   - Add in the following SNORT Rules to IDS devices:\n\n[http://doc.emergingthreats.net/bin/view/Main/2024218](http://doc.emergingthreats.net/bin/view/Main/2024218)\n\n\n-----\n\n   - Block all outgoing connections on port 137,139, 445 and 3389 (i.e. internal to external) to\nstop the worm spreading externally.\n   - Block all incoming connections on ports 137,139, 445 and 3389 (i.e external to internal) to\nstop the worm coming into the network.\n   - Consider blocking connections on port 445 (SMB shares) internally if not business critical\nuntil the worm has subsided.\n   - Ensure that connections to the domain:\n```\n   www.iuqerfsodp9ifjaposdfjhgosurijfaewrwergwea[.]com are permitted, This is site is\n\n```\nreported to act as a kill switch, for some variants, preventing encryption. Connectivity can be\ntested with the [following python script.](https://gist.github.com/dfirfpi/54cae73f590be7e3b06c05436d368f79)\n\nWe also suggest noting the recommendations from:\n\nNCSC-UK: https://www.ncsc.gov.uk/news/latest-statement-international-ransomware-cyberattack-0\nCIRCL: [https://www.circl.lu/pub/tr-41/](https://www.circl.lu/pub/tr-41/)\nMicrosoft: blogs.technet.microsoft.com/mmpc/2017/05/12/wannacrypt-ransomware-wormtargets-out-of-date-systems/\n\nAPPENDIX A – Indictors of compromise\n\nC&C Domain\n\n```\ngx7ekbenv2riucmf[.]onion\n\n```\n```\n57g7spgrzlojinas[.]onion\n\n```\n```\nxxlvbrloxvriy2c5[.]onion\n\n```\n```\n76jdd2ir2embyv47[.]onion\n\n```\n```\ncwwnhwhlz52maqm7[.]onion\n\n```\n```\niuqerfsodp9ifjaposdfjhgosurijfaewrwergwea[.]com\n\n```\n\nMD5 Hashes\n\n```\n4fef5e34143e646dbf9907c4374276f5\n\n```\n```\n509c41ec97bb81b0567b059aa2f50fe8\n\n```\n```\n7bf2b57f2a205768755c07f238fb32cc\n\n```\n```\n7f7ccaa16fb15eb1c7399d422f8363e8\n\n```\n```\n8495400f199ac77853c53b5a3f278f3e\n\n```\n```\n84c82835a5d21bbcf75a61706d8ab549\n\n```\n\n-----\n\n```\ndb349b97c37d22f5ea1d1841e3c89eb4\n\n```\n```\nf107a717f76f4f910ae9cb4dc5290594\n\n```\n\nAPPENDIX B – The Network Replicator\n\nThe worm replicates across the network using two threads: the first one provides replication across\nthe local network, and the second one - across random IP ranges, thus affecting external addresses\n(such as honeypots or other exposed SMB shares).\n\nTo replicate across internal network, the worm first calls GetAdaptersInfo() to obtain network\nconfiguration for each network adapter associated with the system.\n\nThe network configuration allows it to use current IP address and mask to build a list of local IP\naddresses.\n\nFor example, if the local IP address is `192.168.78.132, and the subnet mask is` `255.255.255.0,`\nthe worm may build a list of 254 IP addresses that are displayed below in their binary format, such as\n```\n014EA8C0 ( \"192.168.78.1\" ), 024EA8C0 ( \"192.168.78.2\" ), and up to FE4EA8C0\n\n```\n( \"192.168.78.254\" ):\n\nNOTE: the constructed list is trailed with the `BAADF00D markers.`\n\nThis list is then passed to a newly spawned thread to enumerate it, and the worm will then attempt to\nreplicate to each target in the list.\n\nThe second network replication thread is spawned each 2 seconds up to 128 times. Each instance of\nthis thread will generate a random IP consisting of 4 octets:\n```\nIP1.IP2.IP3.IP4\n\n```\nEach octet is a random value from 0 to 255, generated using CryptGenRandom() API - a\ncryptographically secure pseudorandom number generator.\n\n\n-----\n\nFirst octet `IP1 cannot be set to` `127,` `224, or` `225 . If the worm is able to connect to a target with`\nIP address `IP1.IP2.IP3.IP4 over port` `445, it will then enumerate 255 IP addresses from`\n```\nIP1.IP2.IP3.1 to IP1.IP2.IP3.255 . The worm will attempt to replicate to each enumerated\n\n```\ntarget.\n\nThis thread is spawned 128 times - the round number is passed to the thread as an argument, so it is\naware about the current round of its own execution. The thread uses it along with an internal timer\n(using 20 and 40 minute intervals) to define the logic of regeneration of `IP1 and` `IP2 parts of the`\nrandom IPs.\n\nBoth threads rely on the same network propagation mechanism: for each target IP, the worm first\nattempts to connect on port 445 and submit it two SMB requests, with an attempt to establish if the\nMS17_010 SMB Vulnerability exists:\n\n     - `negotiate_proto_request`\n     - `session_setup_andx_request`\n\nThe code below shows how these packets are submitted:\n```\n 01  name.sa_family = 2;\n 02  *(_DWORD *)&name.sa_data[2] = inet_addr(cp);\n 03  *(_WORD *)&name.sa_data[0] = htons(hostshort);\n 04  hSocket = socket(2, 1, 0);\n 05  __hSocket = hSocket;\n 06  if ( hSocket != -1 )\n 07  {\n 08   if ( connect(hSocket, &name, 16) != -1\n 09    && send(__hSocket, negotiate_proto_request, 88, 0) != -1\n 10    && recv(__hSocket, &buf, 1024, 0) != -1\n 11    && send(__hSocket, session_setup_andx_request, 103, 0) != -1\n 12    && recv(__hSocket, &buf, 1024, 0) != -1 )\n\n```\nOn a network level, WireShark recognises these two packets as Negotiate Protocol Request and\n_Session Setup AndX Request._\n\n_Negotiate Protocol Request:_\n\n\n-----\n\n_Session Setup AndX Request:_\n\nThe disassembled source of the worm shows how the Negotiate Protocol Request is built:\n\nThe disassembled source shows the Session Setup AndX Request (only the end of it is shown):\n\nThe Session Setup AndX Request will get a response, and the code parses it to extract the\n```\nnative_os field from it.\n\n```\nFollowing this, the worm composes an IPC share name such as:\n\n\n-----\n\n```\n \\\\%IP_ADDRESS%\\IPC\n\n```\nNext, the ransomware submits two other SMB requests:\n\n     - `tree_connect_andx_request`\n     - `peeknamedpipe_request`\n\nFirst, the Tree Connect AndX Request:\n\nOnce the host responds, the code will read `tree_id,` `process_id,` `user_id, and`\n```\nmultiplex_id, in order construct a new SMB request. In that new request, the following\n\n```\nplaceholders within request templates will be replaced with the extracted values:\n\n     - `__TREEID__PLACEHOLDER__`\n     - `__USERID__PLACEHOLDER__`\n     - `__TREEPATH_REPLACE__`\n\nThe PeekNamedPipe Request is then submitted, recognised in WireShark as:\n\nThe SMB header extracted from the received response is then parsed to see if `nt_status`\ncontained in it equals `0x0C000205 . Here is how the malware parses the four bytes of such status`\n(bytes `05,` `02,` `00,` `0C ):`\n```\n 01 if (send(__hSocket, peeknamedpipe_request, 78, 0) != -1 // if sent\n 02   && recv(__hSocket, &buf, 1024, 0) != -1 // and recv() is Ok\n 03   && nt_status_0 == 5        // and nt_status byte #0=05\n 04   && nt_status_1 == 2        // and nt_status byte #1=02\n 05   && !nt_status_2          // and nt_status byte #2=00\n 06   && nt_status_3 == 0xC0u)      // and nt_status byte #3=0C\n\n```\n\n-----\n\n```\n 07   {                 // if nt_status==0x0C000205\n 08      closesocket(__hSocket);\n 09      return 1; // return TRUE, host is vulnerable to MS17-010\n 10   }\n 11 ...\n 12 return 0; // return FALSE – the host is NOT vulnerable\n\n```\nIf the host is vulnerable to MS17-010, the worm waits for three seconds and then checks if it is\nalready infected with DOUBLEPULSAR – in order to replicate itself, it needs an active\nDOUBLEPULSAR backdoor to be installed at the host.\n\nIn order to check that, it builds and then submits SMB Trans2 Request or `trans2_request .`\n\nAs seen below, the `subcommand field within` `trans2_request request is set to` `SESSION_SETUP,`\nwhich is a covert beacon request to the DOUBLEPULSAR backdoor:\n\nIf the host is infected with DOUBLEPULSAR, the response will contain `\"Multiplex ID\" set to` `81`\n( 0x51 ). Here, the worm sends `trans2_request request, and checks if` `multiplex_id equals`\n```\n0x51 :\n 01 if (send(hSocket, trans2_request, 82, 0) != -1 // if send() Ok\n 02   && recv(hSocket, &buf, 1024, 0) != -1   // and recv() Ok\n 03   && multiplex_id == 0x51)   // and DoublePulsar is active\n 04 ...\n 05   return 1;          // return TRUE, is backdoored\n\n```\nIf the scanned host is infected with DOUBLEPULSAR, the worm will calculate an XOR key from the\nSMB’s `Signature1 field ( sig ):`\n```\n 01 unsigned int calculate_doublepulsar_xor_key(unsigned int sig)\n 02 {\n 03  return 2 * sig ^ ((((sig >> 16) | sig & 0xFF0000) >> 8) |\n 04           (((sig <\n\n```\n\n-----\n\n```\n 05 }\n\n```\nThis XOR key will later be used as a basic stream cipher to encrypt the payload submitted over SMB:\n```\n 01 int xor_payload(int xor_key, int buf, int size)\n 02 {\n 03   int i;\n 04   char __xor_key[5];\n 05   i = 0;\n 06   *&__xor_key[1] = 0;\n 07   *__xor_key = xor_key;\n 08   if (size <= 0)\n 09     return 0;\n 10   do\n 11   {\n 12     *(i + buf) ^= __xor_key[i % 4];\n 13     ++i;\n 14   }\n 15   while ( i\n 16   return 0;\n 17 }\n\n```\nThe worm next constructs a new SMB packet. The data contained in the packet will contain malicious\nshellcode. For example, if the target is x64, the shellcode will first walk backwards to find\n```\nntoskrnl.exe in kernel memory:\n\n```\n\n-----\n\nNext, it parses `ntoskrnl.exe ’s export table, and dynamically obtains addresses for a number of its`\nexports – the exports are found by hashes, a common approach used in shellcode. The hash\ncalculation function is reconstructed below:\n```\n 01 __int64 get_name_hash(_BYTE *arg_name)\n 02 {\n 03  _BYTE *name;\n 04  int i;\n 05  __int64 hash;\n 06  name = arg_name;\n 07  for (i = 0; ; i = (unsigned __int8)*name++ + (_DWORD)hash)\n 08  {\n 09   hash = (unsigned int)(127 * i);\n 10   if (!*name)\n 11    break;\n 12  }\n 13  return hash;\n 14 }\n\n```\nFor example, a hash of `3E1481DFh corresponds to PsLookupProcessByProcessID(), as` [explained](https://countercept.com/our-thinking/analyzing-the-doublepulsar-kernel-dll-injection-technique/)\nin an article from Countercept.\n\nNOTE: the 32-bit version of the code is identical in its functionality to its x64 version.\n\nThe shellcode will then use kernel’s ZwQuerySystemInformation() API to obtain the list of loaded\ndrivers. Among those drivers, it will be looking for a driver named `Srv.sys – the driver is also found`\nby its hash name:\n\n\n-----\n\nIt will then locate the `Srv.sys driver’s` `.data section with the purpose of patching its`\n```\nSrvTransaction2DispatchTable – namely, placing a hook on its SrvTransactionNotImplemented()\n\n```\nfunction, making sure that the shellcode is invoked as a hook handler, as explained by\n```\n@zerosum0x0 .\n\n```\nNext, the worm will construct a payload wrapped into a new SMB packet. For this, it will build a new\nDLL out of its own `.data section. The internal name of the DLL is` `launcher.dll, and its only`\nexport is PlayGame(). The DLL is built using the worm's own file contents, and thus, the DLL is\nconstructed as a thin wrapper around the worm's own executable.\n\nThe constructed DLL will be passed to the remote host along with the shellcode to load it up, via\nSMB, in 4Kb chunks, making sure each chunk is encrypted with the earlier derived XOR key.\n\nWith the hook in place, when such a payload packet arrives via SMB, it will be seen by `Srv.sys (an`\nSMB driver) as an invalid SMB request. Therefore, it will call SrvTransactionNotImplemented()\nfunction from its own dispatch table. Since this function will be hooked, the shellcode with DLL\ninjection logic will be invoked instead, that in turn relies on KeInsertQueueApc().\n\nAs a result, the shellcode invoked as a hook handler will allocate memory in the executable region of\nmemory, extract the received DLL in it, and run it in the userspace. This will lead to the execution of\nthe ransomware on the remote host.\n\nThe newly built DLL `launcher.dll delivered and executed at the host has very little functionality:`\nwhen its PlayGame() export is called, it only loads up its own resource `\"W/101\", saves and then`\nruns it under a fixed name:\n```\nC:\\WINDOWS\\mssecsvc.exe\n\n```\nSince `mssecsvc.exe is extracted from the DLL resource, which in turn is built by worm from its own`\nbody, it will be equivalent to the worm executable itself.\n\nIf it turns out that the remote host is not infected with DOUBLEPULSAR, the worm will attempt to\ninfect the host with DOUBLEPULSAR, using the same technique as ETERNALBLUE explained\nabove. This attempt will be repeated up to 5 times, with a 3 second interval between the attempts.\n\nA high-level description of the worm’s logic is shown below:\n```\n 01 if (IS_VULNERABLE_TO_MS17_010(&target, 445))\n 02 {\n\n```\n\n-----\n\n```\n 03  i = 0;\n 04  do\n 05  {\n 06    Sleep(3000);            // wait for 3 seconds\n 07    if (IS_BACKDOORED(&target, 1, 445)) // DoublePulsar installed?\n 08      break;              // then quit the loop\n 09    Sleep(3000);            // otherwise, wait 3 sec.\n 10    INFECT_WITH_DOUBLEPULSAR(&target, 445);// install DoublePulsar\n 11    ++i;\n 12  }\n 13  while ( i // repeat up to 5 times\n 14 }                     // ..until backdoor-ed\n 15 Sleep(3000);                // wait for 3 seconds\n 16 if (IS_BACKDOORED(&target, 1, 445))    // finally backdoor-ed?\n 17  SEND_PAYLOAD_RANSOMWARE(&target, 1, 445);// send WCry as DLL\n 18 endthreadex(0, *&target);         // quit the thread\n\n```\nAccording to this logic, if the host already has DOUBLEPULSAR backdoor installed on it, the worm\nwill send it the ransomware payload to execute it on the remote host. In turn, that instance of the\nransomware will try to further replicate.\n\nIf the DOUBLEPULSAR backdoor is not installed on the remote host, the worm will try to install it.\nOnly if the DOUBLEPULSAR backdoor is found to be installed on the remote host, only then the\nworm will try to replicate to it, via the backdoor.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2017/2017-05-16 - Wannacryptor Ransomworm.pdf"
    ],
    "report_names": [
        "2017-05-16 - Wannacryptor Ransomworm.pdf"
    ],
    "threat_actors": [
        {
            "id": "b740943a-da51-4133-855b-df29822531ea",
            "created_at": "2022-10-25T15:50:23.604126Z",
            "updated_at": "2025-03-27T02:00:55.505366Z",
            "deleted_at": null,
            "main_name": "Equation",
            "aliases": [
                "Equation"
            ],
            "source_name": "MITRE:Equation",
            "tools": null,
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "d4f7cf97-9c98-409c-8b95-b80d14c576a5",
            "created_at": "2022-10-25T16:07:24.561104Z",
            "updated_at": "2025-03-27T02:02:10.281202Z",
            "deleted_at": null,
            "main_name": "Shadow Brokers",
            "aliases": [],
            "source_name": "ETDA:Shadow Brokers",
            "tools": [],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "32a223a8-3c79-4146-87c5-8557d38662ae",
            "created_at": "2022-10-25T15:50:23.703698Z",
            "updated_at": "2025-03-27T02:00:55.528031Z",
            "deleted_at": null,
            "main_name": "Lazarus Group",
            "aliases": [
                "Lazarus Group",
                "Labyrinth Chollima",
                "HIDDEN COBRA",
                "Guardians of Peace",
                "NICKEL ACADEMY",
                "Diamond Sleet"
            ],
            "source_name": "MITRE:Lazarus Group",
            "tools": [
                "RawDisk",
                "Proxysvc",
                "BADCALL",
                "FALLCHILL",
                "WannaCry",
                "HOPLIGHT",
                "TYPEFRAME",
                "Dtrack",
                "HotCroissant",
                "HARDRAIN",
                "Dacls",
                "KEYMARBLE",
                "TAINTEDSCRIBE",
                "AuditCred",
                "netsh",
                "ECCENTRICBANDWAGON",
                "AppleJeus",
                "BLINDINGCAN",
                "ThreatNeedle",
                "Volgmer",
                "Cryptoistic",
                "RATANKBA",
                "Bankshot",
                "Torisma",
                "Mimikatz"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "08623296-52be-4977-8622-50efda44e9cc",
            "created_at": "2023-01-06T13:46:38.549387Z",
            "updated_at": "2025-03-27T02:00:02.859535Z",
            "deleted_at": null,
            "main_name": "Equation Group",
            "aliases": [
                "Tilded Team",
                "EQGRP",
                "G0020"
            ],
            "source_name": "MISPGALAXY:Equation Group",
            "tools": [
                "EquationLaser",
                "EquationDrug",
                "DoubleFantasy",
                "TripleFantasy",
                "GrayFish"
            ],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "171b85f2-8f6f-46c0-92e0-c591f61ea167",
            "created_at": "2023-01-06T13:46:38.830188Z",
            "updated_at": "2025-03-27T02:00:02.929729Z",
            "deleted_at": null,
            "main_name": "The Shadow Brokers",
            "aliases": [
                "Shadow Brokers",
                "ShadowBrokers",
                "The ShadowBrokers",
                "TSB"
            ],
            "source_name": "MISPGALAXY:The Shadow Brokers",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "9e767b38-12ae-4ef7-9878-5ce1701066d7",
            "created_at": "2024-05-01T02:03:08.131819Z",
            "updated_at": "2025-03-27T02:05:17.413497Z",
            "deleted_at": null,
            "main_name": "NICKEL ACADEMY",
            "aliases": [
                "COVELLITE ",
                "CTG-2460 ",
                "Diamond Sleet ",
                "Guardians of Peace",
                "HIDDEN COBRA ",
                "High Anonymous",
                "Labyrinth Chollima ",
                "NNPT Group",
                "New Romanic Cyber Army Team",
                "Temp.Hermit ",
                "The Lazarus Group ",
                "UNC577 ",
                "Who Am I?",
                "Whois Team",
                "ZINC ",
                "Black Artemis "
            ],
            "source_name": "Secureworks:NICKEL ACADEMY",
            "tools": [
                " DarkMessenger",
                " Destover",
                " Duuzer",
                " HOPLIGHT",
                " Joanap",
                " KorHigh",
                " LiveJinx",
                " Volgmer",
                "Brambul"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "8bc1a044-a23b-4904-903c-13f463605cb3",
            "created_at": "2024-05-01T02:03:08.136237Z",
            "updated_at": "2025-03-27T02:05:17.415795Z",
            "deleted_at": null,
            "main_name": "NICKEL GLADSTONE",
            "aliases": [
                "Bluenoroff ",
                "CTG-6459 ",
                "Citrine Sleet ",
                "HIDDEN COBRA ",
                "Lazarus Group",
                "Sapphire Sleet ",
                "Stardust Chollima ",
                "APT38 "
            ],
            "source_name": "Secureworks:NICKEL GLADSTONE",
            "tools": [
                " Bankshot",
                " CATCH22",
                " CCGC_Proxy",
                " Cur1Agent",
                " Ratankba",
                " Server_TrafficForwarder",
                " Wcry",
                "AlphaNC"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "a2b92056-9378-4749-926b-7e10c4500dac",
            "created_at": "2023-01-06T13:46:38.430595Z",
            "updated_at": "2025-03-27T02:00:02.831633Z",
            "deleted_at": null,
            "main_name": "Lazarus Group",
            "aliases": [
                "Operation DarkSeoul",
                "APT38",
                "ATK117",
                "DEV-1222",
                "G0032",
                "APT 38",
                "Stardust Chollima",
                "APT-C-26",
                "ATK3",
                "Diamond Sleet",
                "Hidden Cobra",
                "Unit 121",
                "Subgroup: Bluenoroff",
                "NICKEL GLADSTONE",
                "DEV-0139",
                "Andariel",
                "Operation Troy",
                "COVELLITE",
                "TA404",
                "Lazarus group",
                "Dark Seoul",
                "G0082",
                "NewRomanic Cyber Army Team",
                "Bluenoroff",
                "Appleworm",
                "Nickel Academy",
                "COPERNICIUM",
                "Hastati Group",
                "Bureau 121",
                "Operation AppleJeus",
                "Whois Hacking Team",
                "Citrine Sleet",
                "Sapphire Sleet",
                "Group 77",
                "Labyrinth Chollima",
                "Operation GhostSecret",
                "BeagleBoyz"
            ],
            "source_name": "MISPGALAXY:Lazarus Group",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "e0fed6e6-a593-4041-80ef-694261825937",
            "created_at": "2022-10-25T16:07:23.593572Z",
            "updated_at": "2025-03-27T02:02:09.879892Z",
            "deleted_at": null,
            "main_name": "Equation Group",
            "aliases": [
                "APT-C-40",
                "Platinum Colony",
                "Tilded Team"
            ],
            "source_name": "ETDA:Equation Group",
            "tools": [
                "Bvp47",
                "DEMENTIAWHEEL",
                "DOUBLEFANTASY",
                "DanderSpritz",
                "DarkPulsar",
                "DoubleFantasy",
                "DoubleFeature",
                "DoublePulsar",
                "Duqu",
                "EQUATIONDRUG",
                "EQUATIONLASER",
                "EQUESTRE",
                "Flamer",
                "GRAYFISH",
                "GROK",
                "OddJob",
                "Plexor",
                "Prax",
                "Regin",
                "Skywiper",
                "TRIPLEFANTASY",
                "Tilded",
                "UNITEDRAKE",
                "WarriorPride",
                "sKyWIper"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "f32df445-9fb4-4234-99e0-3561f6498e4e",
            "created_at": "2022-10-25T16:07:23.756373Z",
            "updated_at": "2025-03-27T02:02:09.966155Z",
            "deleted_at": null,
            "main_name": "Lazarus Group",
            "aliases": [
                "APT-C-26",
                "ATK 3",
                "Appleworm",
                "Citrine Sleet",
                "DEV-0139",
                "Diamond Sleet",
                "Gleaming Pisces",
                "Gods Apostles",
                "Gods Disciples",
                "Group 77",
                "Guardians of Peace",
                "Hastati Group",
                "Hidden Cobra",
                "ITG03",
                "Jade Sleet",
                "Labyrinth Chollima",
                "Lazarus Group",
                "NewRomanic Cyber Army Team",
                "Operation 99",
                "Operation AppleJeus",
                "Operation AppleJeus sequel",
                "Operation Blockbuster: Breach of Sony Pictures Entertainment",
                "Operation CryptoCore",
                "Operation Dream Job",
                "Operation Dream Magic",
                "Operation Flame",
                "Operation GhostSecret",
                "Operation In(ter)caption",
                "Operation LolZarus",
                "Operation Marstech Mayhem",
                "Operation No Pineapple!",
                "Operation North Star",
                "Operation Phantom Circuit",
                "Operation Sharpshooter",
                "Operation Ten Days of Rain / DarkSeoul",
                "Operation Troy",
                "SectorA01",
                "Slow Pisces",
                "TA404",
                "TraderTraitor",
                "UNC2970",
                "UNC4034",
                "UNC4736",
                "UNC4899",
                "UNC577",
                "Whois Hacking Team"
            ],
            "source_name": "ETDA:Lazarus Group",
            "tools": [
                "3CX Backdoor",
                "3Rat Client",
                "3proxy",
                "AIRDRY",
                "ARTFULPIE",
                "ATMDtrack",
                "AlphaNC",
                "Alreay",
                "Andaratm",
                "AngryRebel",
                "AppleJeus",
                "Aryan",
                "AuditCred",
                "BADCALL",
                "BISTROMATH",
                "BLINDINGCAN",
                "BTC Changer",
                "BUFFETLINE",
                "BanSwift",
                "Bankshot",
                "Bitrep",
                "Bitsran",
                "BlindToad",
                "Bookcode",
                "BootWreck",
                "BottomLoader",
                "Brambul",
                "BravoNC",
                "Breut",
                "COLDCAT",
                "COPPERHEDGE",
                "CROWDEDFLOUNDER",
                "Castov",
                "CheeseTray",
                "CleanToad",
                "ClientTraficForwarder",
                "CollectionRAT",
                "Concealment Troy",
                "Contopee",
                "CookieTime",
                "Cyruslish",
                "DAVESHELL",
                "DBLL Dropper",
                "DLRAT",
                "DRATzarus",
                "DRATzarus RAT",
                "Dacls",
                "Dacls RAT",
                "DarkComet",
                "DarkKomet",
                "DeltaCharlie",
                "DeltaNC",
                "Dembr",
                "Destover",
                "DoublePulsar",
                "Dozer",
                "Dtrack",
                "Duuzer",
                "DyePack",
                "ECCENTRICBANDWAGON",
                "ELECTRICFISH",
                "Escad",
                "EternalBlue",
                "FALLCHILL",
                "FYNLOS",
                "FallChill RAT",
                "Farfli",
                "Fimlis",
                "FoggyBrass",
                "FudModule",
                "Fynloski",
                "Gh0st RAT",
                "Ghost RAT",
                "Gopuram",
                "HARDRAIN",
                "HIDDEN COBRA RAT/Worm",
                "HLOADER",
                "HOOKSHOT",
                "HOPLIGHT",
                "HOTCROISSANT",
                "HOTWAX",
                "HTTP Troy",
                "Hawup",
                "Hawup RAT",
                "Hermes",
                "HotCroissant",
                "HotelAlfa",
                "Hotwax",
                "HtDnDownLoader",
                "Http Dr0pper",
                "ICONICSTEALER",
                "Joanap",
                "Jokra",
                "KANDYKORN",
                "KEYMARBLE",
                "Kaos",
                "KillDisk",
                "KillMBR",
                "Koredos",
                "Krademok",
                "LIGHTSHIFT",
                "LIGHTSHOW",
                "LOLBAS",
                "LOLBins",
                "Lazarus",
                "LightlessCan",
                "Living off the Land",
                "MATA",
                "MBRkiller",
                "MagicRAT",
                "Manuscrypt",
                "Mimail",
                "Mimikatz",
                "Moudour",
                "Mydoom",
                "Mydoor",
                "Mytob",
                "NACHOCHEESE",
                "NachoCheese",
                "NestEgg",
                "NickelLoader",
                "NineRAT",
                "Novarg",
                "NukeSped",
                "OpBlockBuster",
                "PCRat",
                "PEBBLEDASH",
                "PLANKWALK",
                "POOLRAT",
                "PSLogger",
                "PhanDoor",
                "Plink",
                "PondRAT",
                "PowerBrace",
                "PowerRatankba",
                "PowerShell RAT",
                "PowerSpritz",
                "PowerTask",
                "Preft",
                "ProcDump",
                "Proxysvc",
                "PuTTY Link",
                "QUICKRIDE",
                "QUICKRIDE.POWER",
                "Quickcafe",
                "QuiteRAT",
                "R-C1",
                "ROptimizer",
                "Ratabanka",
                "RatabankaPOS",
                "Ratankba",
                "RatankbaPOS",
                "RawDisk",
                "RedShawl",
                "Rifdoor",
                "Rising Sun",
                "Romeo-CoreOne",
                "RomeoAlfa",
                "RomeoBravo",
                "RomeoCharlie",
                "RomeoCore",
                "RomeoDelta",
                "RomeoEcho",
                "RomeoFoxtrot",
                "RomeoGolf",
                "RomeoHotel",
                "RomeoMike",
                "RomeoNovember",
                "RomeoWhiskey",
                "Romeos",
                "RustBucket",
                "SHADYCAT",
                "SHARPKNOT",
                "SIGFLIP",
                "SIMPLESEA",
                "SLICKSHOES",
                "SORRYBRUTE",
                "SUDDENICON",
                "SUGARLOADER",
                "SheepRAT",
                "SierraAlfa",
                "SierraBravo",
                "SierraCharlie",
                "SierraJuliett-MikeOne",
                "SierraJuliett-MikeTwo",
                "SimpleTea",
                "SimplexTea",
                "SmallTiger",
                "Stunnel",
                "TAINTEDSCRIBE",
                "TAXHAUL",
                "TFlower",
                "TOUCHKEY",
                "TOUCHMOVE",
                "TOUCHSHIFT",
                "TOUCHSHOT",
                "TWOPENCE",
                "TYPEFRAME",
                "Tdrop",
                "Tdrop2",
                "ThreatNeedle",
                "Tiger RAT",
                "TigerRAT",
                "Trojan Manuscript",
                "Troy",
                "TroyRAT",
                "VEILEDSIGNAL",
                "VHD",
                "VHD Ransomware",
                "VIVACIOUSGIFT",
                "VSingle",
                "ValeforBeta",
                "Volgmer",
                "Vyveva",
                "W1_RAT",
                "Wana Decrypt0r",
                "WanaCry",
                "WanaCrypt",
                "WanaCrypt0r",
                "WannaCry",
                "WannaCrypt",
                "WannaCryptor",
                "WbBot",
                "Wcry",
                "Win32/KillDisk.NBB",
                "Win32/KillDisk.NBC",
                "Win32/KillDisk.NBD",
                "Win32/KillDisk.NBH",
                "Win32/KillDisk.NBI",
                "WinorDLL64",
                "Winsec",
                "WolfRAT",
                "Wormhole",
                "YamaBot",
                "Yort",
                "ZetaNile",
                "concealment_troy",
                "http_troy",
                "httpdr0pper",
                "httpdropper",
                "klovbot",
                "sRDI"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535897,
    "ts_updated_at": 1743041843,
    "ts_creation_date": 1653766205,
    "ts_modification_date": 1653766205,
    "files": {
        "pdf": "https://archive.orkl.eu/549dfeaac59975fd0fe31de5c07a55b1cb17e991.pdf",
        "text": "https://archive.orkl.eu/549dfeaac59975fd0fe31de5c07a55b1cb17e991.txt",
        "img": "https://archive.orkl.eu/549dfeaac59975fd0fe31de5c07a55b1cb17e991.jpg"
    }
}