{
    "id": "79b53be1-646a-45d4-a3a5-5f0904813fce",
    "created_at": "2023-01-12T15:07:18.44876Z",
    "updated_at": "2025-03-27T02:05:46.109998Z",
    "deleted_at": null,
    "sha1_hash": "3a79f6e90f3daa4c22dfedce3ccb69584029d465",
    "title": "2021-05-11 - Quick analysis note about DealPly (Adware)",
    "authors": "",
    "file_creation_date": "2022-05-28T15:23:35Z",
    "file_modification_date": "2022-05-28T15:23:35Z",
    "file_size": 1085248,
    "plain_text": "# Quick analysis note about DealPly (Adware)\n\n**[kienmanowar.wordpress.com/2021/05/11/quick-analysis-note-about-dealply-adware/](https://kienmanowar.wordpress.com/2021/05/11/quick-analysis-note-about-dealply-adware/)**\n\nOverview\n\n## Some information about DealPly can be found here:\n\n The post focuses on the following main sections:\n\n Unpack wrapper/loader to get main Dll payload. Decrypt C2url and strings are used in the malware code.\n\n Sample:\n\n\nMay 11, 2021\n\n\n## SHA-256: 40584f79d109a18b1c4ea7e75a945324978652b6afcc9efbe62241717f0b4685\n\n\n-----\n\nUnpacking wrapper/loader to get main DLL payload\n\n## Most of the DealPly loaders are coded in Delphi. When it runs without parameter, it only shows the following form:\n\n When executing with parameters, it unpacks a DLL to allocated memory. This DLL will be mainly responsible for connecting and interacting with C2. For unpacking, place breakpoint at VirtualAlloc, execute the program and follow the allocated memory region. Keep watching until the loader unpack a new PE (which is a dll), but it was destroyed all relevant information about DOS_HEADER and NT_HEADERS :\n\n\n-----\n\n## Dump and fix DOS_HEADER and NT_HEADERS will get the correct main Dll:\n\nAnalysis of DLL payload\n\nDecrypt C2Url\n\n## Load the above dumped Dll file into IDA, go to the code of the Run function. Here, it calls\n```\nf_main_proc function. The f_main_proc accepts the passed parameters, in which the\n\n third parameter is encoded C2.\n\n```\n\n-----\n\n## Diving into the code of f_main_proc will find the function responsible for performing the decoding of the malware’s C2:\n\n The code at the f_tranform_c2Url function will recalculate the bytes of enC2Url :\n\n\n-----\n\n## After completing the transform process, call to f_decrypt_c2Url function to perform decoding to C2. In essence, the function f_decrypt_c2Url function will perform xor to decrypt, xor_key is calculated from the last 2 bytes of the transformed enC2Url above:\n\n With all the above information and pseudo-code, I rewrote the code that performs decoding C2 in Python as follows:\n\n\n-----\n\n```\nimport numpy as np\n#---------------------------------------------------------------------def calc_value(c, val_0x2C):\n  \"\"\"\"\"\"\n  tmp = val_0x2C - 0x2B\n  if tmp:\n    tmp2 = tmp - 2\n    if tmp2:\n      if (tmp2 == 1):\n        c = c + 0x85\n      else:\n        c = c & 0xFF\n    else:\n      c = c + 0x4B\n  else:\n    c = c - 0x30\n  if (c < 0 or c > 0xFF):\n    c = 0x3F\n  return c  \n#---------------------------------------------------------------------def int_to_bytes(value, length):\n  \"\"\"\"\"\"\n  result = []\n  for i in range(0, length):\n    result.append(value >> (i * 8) & 0xff)\n  return result\n#---------------------------------------------------------------------def decrypt_c2url(encUrl, xor_tbl):\n  \"\"\"\"\"\"\n  c2_url = \"\"\n  dec_c2 = []\n  j = 0\n  len_c2 = len(encUrl)\n  if len_c2 >= 4:\n    i = len_c2 / 4    \n    if (len_c2/4 -1 >= 0):\n      counter = len_c2/4\n      while counter:\n        for k in range(len(xor_tbl)):          \n          dec_c2.append(encUrl[j] ^ xor_tbl[j%len(xor_tbl)])\n          j+=1\n        counter-=1\n  j = 0\n  if (len_c2 >= 4 *i +1):\n    counter = len_c2 - 4 * i\n    idx = 4 * i + 1\n\n```\n\n-----\n\n```\n    while counter:\n      dec_c2.append(encUrl[idx-1] ^ xor_tbl[j])\n      j = (j + 1) % 4\n      idx +=1\n      counter-=1\n  for i in dec_c2:\n    c2_url += chr(i)\n  return c2_url\n#---------------------------------------------------------------------def main():\n  \"\"\"\"\"\"\n  C2_transform = [0] * len(encC2)\n  tmp_tbl = []\n  val_0x2C = 0x2C\n  i = 1\n  j = 1\n  while j <= len(encC2):\n    c = encC2[j -1]\n    j+=1\n    if ((c - 0x2B) >= 4):\n      calced_val = calc_value(c, val_0x2C)\n      C2_transform[i-1] = calced_val\n      i+=1\n    elif (c == val_0x2C):\n      if (j > len(encC2)):\n        break\n      C2_transform[i-1] = encC2[j-1]\n      i+=1\n      j+=1\n    else:\n      val_0x2C = c\n  C2_transform = np.trim_zeros(C2_transform)\n  tmp_tbl = C2_transform[len(C2_transform)-2:len(C2_transform)]\n  C2_transform = C2_transform[:len(C2_transform)-2]\n  tmp_val = ((tmp_tbl[1] + (tmp_tbl[0] << 8)) & 0xF) + 0x10 * (tmp_tbl[1] & 0xF0) +\n(((tmp_tbl[1] + (tmp_tbl[0] << 8)) & 0xF00) << 8) + (((tmp_tbl[1] + (tmp_tbl[0] <<\n8)) & 0xF000) << 0xC)\n  xor_tbl = int_to_bytes(tmp_val, 4)\n  print decrypt_c2url(C2_transform, xor_tbl)\n\n## Execute the above script and check the results. As the result, this sample will connect to\nbuluw[.]com :\n\n```\n\n-----\n\nDecrypt strings\n\n## All strings used by malware are encrypted and only decrypt when needed. Through the analysis of the code will find the function responsible for decoding:\n\n The code at this function is as follows:\n\n\n-----\n\n## As above picture, f_decrypt_string function will take as the argument of the address that contains the pointer to the encrypted string (ex: off_41C174 ). The function responsible for performing the decryption is f_decrypt_str, which takes an additional parameter\n```\ng_calc_tbl – this is table contains 256 elements, used for the calculation. The code at\nf_decrypt_str function looks like this:\n\n Based on the pseudo-code analyzed above, I rewrote the idapython script that decodes all the strings as follows:\n\n```\n\n-----\n\n```\nimport idc\nimport idautils\ndec_routine = 0x00414AA8\ncalc_tbl = [0x00, 0xD3, 0xBA, 0x30, 0xD7, 0xD8, 0xC1, 0xC9, 0xEB, 0x84, 0xAD, 0x88,\n0x9C, 0x47, 0x74, 0xBC, 0x6D, 0x43, 0x40, 0x2B, 0xAE, 0x4B, 0x60, 0x5D, 0x5A, 0xEC,\n0x31, 0xF3, 0x9F, 0x56, 0x1F, 0x1E, 0x93, 0x57, 0x5B, 0xF7, 0xC0, 0x2C, 0x7C, 0xC5,\n0x69, 0x29, 0x90, 0x13, 0x25, 0xE4, 0xA7, 0x99, 0x03, 0x1A, 0xCA, 0x4C, 0xDA, 0x9A,\n0x9E, 0xF4, 0xDB, 0x9D, 0xA0, 0x65, 0xAF, 0xB3, 0xF5, 0x51, 0x12, 0x58, 0x7D, 0x11,\n0x6A, 0x5C, 0xF0, 0x0D, 0x85, 0x7E, 0xBE, 0x15, 0x33, 0xB4, 0x7A, 0xFD, 0xAC, 0x3F,\n0x81, 0xFF, 0xED, 0x5E, 0x1D, 0x21, 0x41, 0xAA, 0x18, 0x22, 0x45, 0x17, 0x55, 0x96,\n0x16, 0xA3, 0x95, 0xA1, 0xD4, 0x3B, 0xEA, 0xE6, 0xBF, 0x28, 0x44, 0x89, 0xD9, 0x10,\n0xE7, 0xA8, 0xAB, 0x8A, 0xCE, 0xD2, 0x0E, 0xCF, 0x8D, 0xA2, 0xDC, 0xC8, 0x4E, 0xDD,\n0x26, 0x42, 0x49, 0xE5, 0x8B, 0x52, 0xA4, 0xA5, 0x09, 0x48, 0xF8, 0xA6, 0x0B, 0x6B,\n0x71, 0x80, 0x92, 0x76, 0xB5, 0xF9, 0x2A, 0xB6, 0x8C, 0x20, 0xCB, 0x62, 0x5F, 0xC6,\n0xEE, 0x2F, 0x35, 0xBB, 0x0C, 0x39, 0x36, 0x1C, 0x3A, 0x63, 0x77, 0x61, 0x82, 0x83,\n0x87, 0x2E, 0x6F, 0xC2, 0x59, 0x70, 0x50, 0x0A, 0x14, 0x3C, 0xCC, 0xC7, 0xE8, 0x3D,\n0x4D, 0x8E, 0x91, 0xC3, 0xD0, 0xE9, 0x02, 0x9B, 0x0F, 0xCD, 0x4A, 0x68, 0x24, 0x06,\n0xA9, 0xB7, 0xEF, 0x27, 0x97, 0xB1, 0x79, 0x07, 0x32, 0x94, 0xB0, 0xBD, 0x72, 0x75,\n0xB8, 0xF1, 0x73, 0x01, 0x64, 0xF6, 0xDE, 0x04, 0x05, 0x6C, 0x34, 0x38, 0x78, 0x7B,\n0xD6, 0xFA, 0xF2, 0xFB, 0xFE, 0xFC, 0x2D, 0x7F, 0x67, 0x6E, 0xB2, 0xB9, 0x66, 0x08,\n0x19, 0x54, 0x98, 0xC4, 0x46, 0xD1, 0xE0, 0x1B, 0x37, 0x3E, 0xD5, 0x23, 0x86, 0x8F,\n0xDF, 0xE1, 0xE3, 0x4F, 0xE2, 0x53]\n#---------------------------------------------------------------------def get_encrypted_bytes(addr):\n  \"\"\"\"\"\"\n  enc_bytes = []\n  enc_bytes_addr = idc.get_wide_dword(idc.get_operand_value(addr,1))\n  while idc.get_wide_byte(enc_bytes_addr) != 0x0:\n    enc_bytes.append(idc.get_wide_byte(enc_bytes_addr))\n    enc_bytes_addr += 1\n  return enc_bytes  \n#---------------------------------------------------------------------def decrypt(enc_str):\n  \"\"\"\"\"\"\n  plaint_t = \"\"\n  decStr = [0] * len(enc_str)\n  calc_tbl_val = calc_tbl[enc_str[0]]\n  tmp1 = calc_tbl_val % 7\n  tmp2 = calc_tbl_val % 9\n  strLen = len(enc_str) - 1\n  j = 2\n  for i in range(strLen):\n    c = calc_tbl[enc_str[j-1]] - tmp2 * (j - 1)\n    decStr[j-1] = c & 0xFF\n    j+= 1\n  for i in decStr[tmp1+1:]:\n    plaint_t+= chr(i)\n\n```\n\n-----\n\n```\n  return plaint_t\n#---------------------------------------------------------------------def decrypt_strings(func_addr):\n  \"\"\"\"\"\"\n  for x in idautils.XrefsTo(func_addr, 0):\n    org_addr = x.frm\n    curr_addr = x.frm\n    addr_minus_20 = curr_addr - 20\n    while curr_addr >= addr_minus_20:\n      curr_addr = idc.prev_head(curr_addr)\n      if 'edx' in idc.print_operand(curr_addr, 0) and\nidc.get_operand_type(curr_addr, 1) == idc.o_mem:\n        enc_bytes = get_encrypted_bytes(curr_addr)\n        dec_str = decrypt(enc_bytes)\n        print(\"org_addr: %s, decrypted string: %s\" % (hex(org_addr),\ndec_str))\n        idc.set_cmt(org_addr, dec_str, 0)\n      elif 'eax' in idc.print_operand(curr_addr, 0) and\nidc.get_operand_type(curr_addr, 1) == idc.o_mem:\n        enc_bytes = get_encrypted_bytes(curr_addr)\n        dec_str = decrypt(enc_bytes)\n        print(\"org_addr: %s, decrypted string: %s\" % (hex(org_addr),\ndec_str))\n        idc.set_cmt(org_addr, dec_str, 0)\n#---------------------------------------------------------------------def main():\n  \"\"\"\"\"\"\n  decrypt_strings(dec_routine)\nif __name__ == '__main__':\n  main()\n\n## Executing the above script:\n\n```\n\n-----\n\n## All the strings are decrypted:\n\n\n-----\n\n```\norg_addr: 0x405529, decrypted string: IPHLPAPI.dll\norg_addr: 0x40555f, decrypted string: GetIfTable\norg_addr: 0x40558e, decrypted string: GetAdaptersInfo\norg_addr: 0x4055bd, decrypted string: GetNetworkParams\norg_addr: 0x4059a1, decrypted string: 00155D\norg_addr: 0x4059c7, decrypted string: 0003FF\norg_addr: 0x4059ed, decrypted string: 0050F2\norg_addr: 0x405a13, decrypted string: 000D3A\norg_addr: 0x405a38, decrypted string: AZR\norg_addr: 0x405a51, decrypted string: 123139\norg_addr: 0x405a77, decrypted string: 22000A\norg_addr: 0x405a9c, decrypted string: AMZ\norg_addr: 0x405ab5, decrypted string: 000C29\norg_addr: 0x405adb, decrypted string: 000569\norg_addr: 0x405b01, decrypted string: 001C14\norg_addr: 0x405b27, decrypted string: 005056\norg_addr: 0x405b4c, decrypted string: VMW\norg_addr: 0x405b65, decrypted string: 001C42\norg_addr: 0x405b8a, decrypted string: PRL\norg_addr: 0x405ba3, decrypted string: 00163E\norg_addr: 0x405bc8, decrypted string: XEN\norg_addr: 0x405be1, decrypted string: 080027\norg_addr: 0x405c0c, decrypted string: VBX\norg_addr: 0x405cbd, decrypted string: VMW\norg_addr: 0x405ce2, decrypted string: XEN\norg_addr: 0x405d80, decrypted string: 00059A3C7800\norg_addr: 0x405da4, decrypted string: 000000\norg_addr: 0x405dc1, decrypted string: 000000\norg_addr: 0x405de6, decrypted string: 005345000000\norg_addr: 0x405e0a, decrypted string: 00F1D000F1D0\norg_addr: 0x405e2e, decrypted string: 00A0C6000000\norg_addr: 0x405e52, decrypted string: 000000000010\norg_addr: 0x405e76, decrypted string: 000000000030\norg_addr: 0x405e9a, decrypted string: 028037EC0200\norg_addr: 0x405ebe, decrypted string: FFFFFFF\norg_addr: 0x405edb, decrypted string: FFFFF\norg_addr: 0x406355, decrypted string: ldr1\norg_addr: 0x406398, decrypted string: ldr2\norg_addr: 0x406444, decrypted string: ShellExecuteA\norg_addr: 0x406461, decrypted string: shell32.dll\norg_addr: 0x4064d4, decrypted string: ShellExecuteExA\norg_addr: 0x4064f1, decrypted string: shell32.dll\norg_addr: 0x4069c6, decrypted string: wininet.dll\norg_addr: 0x4069fa, decrypted string: http://\norg_addr: 0x406a20, decrypted string: https://\norg_addr: 0x406a46, decrypted string: InternetOpenA\norg_addr: 0x406a72, decrypted string: InternetConnectA\norg_addr: 0x406a9e, decrypted string: HttpOpenRequestA\norg_addr: 0x406aca, decrypted string: HttpAddRequestHeadersA\norg_addr: 0x406af6, decrypted string: HttpSendRequestA\norg_addr: 0x406b22, decrypted string: HttpQueryInfoA\norg_addr: 0x406b4e, decrypted string: InternetReadFile\norg_addr: 0x406b7a, decrypted string: InternetCloseHandle\norg_addr: 0x407369, decrypted string: POST\norg_addr: 0x4073a0, decrypted string: GET\n\n```\n\n-----\n\n```\norg_addr: 0x4074bb, decrypted string: Host: \norg_addr: 0x4074f8, decrypted string: Accept: */*\norg_addr: 0x407575, decrypted string: Host: \norg_addr: 0x4075ca, decrypted string: Accept: \norg_addr: 0x409145, decrypted string: kernel32.dll\norg_addr: 0x40916e, decrypted string: VirtualAlloc\norg_addr: 0x409235, decrypted string: $SIG\norg_addr: 0x409495, decrypted string: kernel32.dll\norg_addr: 0x4094be, decrypted string: VirtualAlloc\norg_addr: 0x409585, decrypted string: $SIG\norg_addr: 0x409700, decrypted string: Run\norg_addr: 0x409947, decrypted string: RunEX\norg_addr: 0x409982, decrypted string: https://\norg_addr: 0x40999d, decrypted string: http://\norg_addr: 0x4099fe, decrypted string: Run\norg_addr: 0x409af4, decrypted string: $UpdateSRV\norg_addr: 0x409b21, decrypted string: $UpdateLTR\norg_addr: 0x409c53, decrypted string:\nSoftware\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Advanced\\\norg_addr: 0x409c73, decrypted string: Hidden\norg_addr: 0x409cd0, decrypted string: HideFileExt\norg_addr: 0x409d2a, decrypted string: ShowSuperHidden\norg_addr: 0x409e5c, decrypted string: CD_UIDC\norg_addr: 0x409e80, decrypted string: CD_ins_guid\norg_addr: 0x409ea4, decrypted string: CD_host_guid\norg_addr: 0x409ec8, decrypted string: CD_iv\norg_addr: 0x409eec, decrypted string: CD_aflt\norg_addr: 0x409f16, decrypted string: a\norg_addr: 0x409f40, decrypted string: aflt\norg_addr: 0x409f64, decrypted string: uidp\norg_addr: 0x409f88, decrypted string: IDT\norg_addr: 0x409fbd, decrypted string: UID=\norg_addr: 0x409ff3, decrypted string: &UID2=\norg_addr: 0x40a02c, decrypted string: &UIDC=\norg_addr: 0x40a067, decrypted string: &mguid=\norg_addr: 0x40a0b0, decrypted string: &uidp=\norg_addr: 0x40a0eb, decrypted string: &AppName=\norg_addr: 0x40a116, decrypted string: &State=\norg_addr: 0x40a151, decrypted string: &ins_guid=\norg_addr: 0x40a17c, decrypted string: &host_guid=\norg_addr: 0x40a1b7, decrypted string: &iv=\norg_addr: 0x40a1e2, decrypted string: &aflt=\norg_addr: 0x40a21d, decrypted string: &IDT=\norg_addr: 0x40a248, decrypted string: &IRTYP=\norg_addr: 0x40a286, decrypted string: &IRVER=\norg_addr: 0x40a2c3, decrypted string: &OS=\norg_addr: 0x40a308, decrypted string: &SV=\norg_addr: 0x40a359, decrypted string: &lptp=1\norg_addr: 0x40a38b, decrypted string: &lptp=0\norg_addr: 0x40a3c1, decrypted string: &btry=1\norg_addr: 0x40a3f3, decrypted string: &btry=0\norg_addr: 0x40a426, decrypted string: &VMC=\norg_addr: 0x40a46f, decrypted string: &REG=\norg_addr: 0x40a4a0, decrypted string: CDATA\norg_addr: 0x40a4da, decrypted string: SOFTWARE\\\n\n```\n\n-----\n\n```\norg_addr: 0x40a564, decrypted string: &Src \norg_addr: 0x40a5b6, decrypted string: src.dat\norg_addr: 0x40a642, decrypted string: &Lang=\norg_addr: 0x40a690, decrypted string: &Lang=\norg_addr: 0x40a6de, decrypted string: &ADVF=\norg_addr: 0x40a734, decrypted string: &FS=\norg_addr: 0x40a79f, decrypted string: &sha=\norg_addr: 0x40a7f6, decrypted string: &st_dt=\norg_addr: 0x40a867, decrypted string: &ParamALL=\norg_addr: 0x40a9e9, decrypted string: UnNM\norg_addr: 0x40accc, decrypted string: Date:\norg_addr: 0x40af23, decrypted string: &Admin=1\norg_addr: 0x40af49, decrypted string: &Admin=0\norg_addr: 0x40af70, decrypted string: &Idle=\norg_addr: 0x40afac, decrypted string: &TDY=\norg_addr: 0x40afe3, decrypted string: &LTDY=\norg_addr: 0x40b028, decrypted string: &TDYC=\norg_addr: 0x40b0c3, decrypted string: https://\norg_addr: 0x40b0e4, decrypted string: http://\norg_addr: 0x40b158, decrypted string: Location:\norg_addr: 0x40b377, decrypted string: script\norg_addr: 0x40b3ac, decrypted string: Flags=\norg_addr: 0x40b3ed, decrypted string: CHECK\norg_addr: 0x40b589, decrypted string: DFN\norg_addr: 0x40b81a, decrypted string: UpdTask.exe\norg_addr: 0x40b840, decrypted string: SynHelper.exe\norg_addr: 0x40b866, decrypted string: Updane.exe\norg_addr: 0x40b892, decrypted string: Sync.exe\norg_addr: 0x40b8be, decrypted string: ProductUpdt.exe\norg_addr: 0x40b8ea, decrypted string: SyncTask.exe\norg_addr: 0x40b913, decrypted string: SyncVersion.exe\norg_addr: 0x40b956, decrypted string: .exe\norg_addr: 0x40ba7e, decrypted string: https://\norg_addr: 0x40ba99, decrypted string: http://\norg_addr: 0x40bae0, decrypted string: CR\norg_addr: 0x40bb1a, decrypted string: CD\norg_addr: 0x40bb94, decrypted string: &uid=\norg_addr: 0x40bbc3, decrypted string: &ins_guid=\norg_addr: 0x40bbf2, decrypted string: &host_guid=\norg_addr: 0x40bc21, decrypted string: &iv=\norg_addr: 0x40bc59, decrypted string: &AL=\norg_addr: 0x40bc8e, decrypted string: a\norg_addr: 0x40bcc4, decrypted string: aflt\norg_addr: 0x40bcf4, decrypted string: CD_UIDC\norg_addr: 0x40bd27, decrypted string: CD_ins_guid\norg_addr: 0x40bd5a, decrypted string: CD_host_guid\norg_addr: 0x40bd8d, decrypted string: CD_iv\norg_addr: 0x40bdc0, decrypted string: CD_aflt\norg_addr: 0x40bdf3, decrypted string: CD_AL\norg_addr: 0x40be3b, decrypted string: CD\norg_addr: 0x40be8a, decrypted string: Local_Inst_DT\norg_addr: 0x40bebb, decrypted string: SNR_FAIL\norg_addr: 0x40bef0, decrypted string: URL\norg_addr: 0x40bf23, decrypted string: AppName\norg_addr: 0x40bf59, decrypted string: uidp\n\n```\n\n-----\n\n```\norg_addr: 0x40bf9c, decrypted string: UDAT0\norg_addr: 0x40bfee, decrypted string: UDAT0\norg_addr: 0x40c021, decrypted string: RKL\norg_addr: 0x40c06c, decrypted string: RVL\norg_addr: 0x40c0ad, decrypted string: RKL\norg_addr: 0x40c0e0, decrypted string: RVL\norg_addr: 0x40c113, decrypted string: RLM\norg_addr: 0x40c158, decrypted string: RLM\norg_addr: 0x40c1eb, decrypted string: Inst_DT\norg_addr: 0x40c221, decrypted string: IRVER\norg_addr: 0x40c26d, decrypted string: IRBVER\norg_addr: 0x40c2b5, decrypted string: IRTYP\norg_addr: 0x40c2f4, decrypted string: TodayFN\norg_addr: 0x40c327, decrypted string: TodayCntFN\norg_addr: 0x40c906, decrypted string: SDT\norg_addr: 0x40c9c2, decrypted string: Src\norg_addr: 0x40c9fc, decrypted string: src.dat\norg_addr: 0x40cad5, decrypted string: .del\norg_addr: 0x40cbb2, decrypted string: nosct\norg_addr: 0x40cd96, decrypted string: noun\norg_addr: 0x40cde6, decrypted string: /Uninstall\norg_addr: 0x40ce13, decrypted string: DelSelfDir\norg_addr: 0x40ce40, decrypted string: /GID=\norg_addr: 0x40ce9d, decrypted string: ProdName\norg_addr: 0x40cefd, decrypted string: prod.dat\norg_addr: 0x40d01e, decrypted string: BkScript\norg_addr: 0x40d13f, decrypted string: Flags=\norg_addr: 0x40d19c, decrypted string: Install\norg_addr: 0x40d52b, decrypted string: UReg\norg_addr: 0x40d610, decrypted string: UFile\norg_addr: 0x40d6a8, decrypted string: UDAT\norg_addr: 0x40d749, decrypted string: UExFile\norg_addr: 0x40d8e2, decrypted string: Uninstall\norg_addr: 0x40d918, decrypted string: Update Service\norg_addr: 0x40d93a, decrypted string: Uninstall completed successfully. Please\nrestart your computer to clean up files.\norg_addr: 0x40d9a3, decrypted string: &APN=\norg_addr: 0x40d9cb, decrypted string: &S=Uninstall&IDT=\norg_addr: 0x40d9f3, decrypted string: IDT\norg_addr: 0x40da3c, decrypted string: &DT=\norg_addr: 0x40da67, decrypted string: &IRTYP=\norg_addr: 0x40daa5, decrypted string: &IRVER=\norg_addr: 0x40dad2, decrypted string: &UID=\norg_addr: 0x40db49, decrypted string: BkScript\norg_addr: 0x40dba9, decrypted string: config.dat\norg_addr: 0x40dd1c, decrypted string: DelSelfDir\norg_addr: 0x40dea9, decrypted string: Update Service\norg_addr: 0x40decb, decrypted string: Uninstall\norg_addr: 0x40defd, decrypted string: update process?\norg_addr: 0x40df56, decrypted string: Uninstall must Reboot your computer to delete\nfiles.\norg_addr: 0x40df75, decrypted string: Continue with uninstall?\norg_addr: 0x40dfec, decrypted string: Uninstall necessario riavviare il computer per\neliminare i file.\norg_addr: 0x40e00b, decrypted string: Continuare con la disinstallazione?\n\n```\n\n-----\n\n```\norg_addr: 0x40e02f, decrypted string: Désinstaller devez redémarrer votre ordinateur\npour supprimer les fichiers.\norg_addr: 0x40e04e, decrypted string: Continuer la désinstallation?\norg_addr: 0x40e072, decrypted string: Uninstall müssen Starten Sie Ihren Computer, um\nDateien zu löschen.\norg_addr: 0x40e091, decrypted string: Fahren Sie mit dem deinstallieren?\norg_addr: 0x40e0b5, decrypted string: Uninstall deve reiniciar o computador para\napagar arquivos.\norg_addr: 0x40e0d4, decrypted string: Continue com a desinstalação?\norg_addr: 0x40e0f5, decrypted string: Desinstalación debe reiniciar el equipo para\neliminar archivos. \norg_addr: 0x40e114, decrypted string: Continúe con la desinstalación?\norg_addr: 0x40e135, decrypted string: Desinstalación debe reiniciar el equipo para\neliminar archivos. \norg_addr: 0x40e154, decrypted string: Continúe con la desinstalación?\norg_addr: 0x40e17b, decrypted string: Update Service\norg_addr: 0x40e1e0, decrypted string: noun\norg_addr: 0x40e210, decrypted string: GID\norg_addr: 0x40e2a9, decrypted string: /DoUninstall\norg_addr: 0x40e2d2, decrypted string: /Uninstall\norg_addr: 0x40e497, decrypted string: $UpdateSRV\norg_addr: 0x40e4e1, decrypted string: $UpdateLTR\norg_addr: 0x40e66d, decrypted string: script\norg_addr: 0x40e6a2, decrypted string: Flags=\norg_addr: 0x40e6e3, decrypted string: CHECK\norg_addr: 0x40eac4, decrypted string: Update\norg_addr: 0x40eadf, decrypted string: Install\norg_addr: 0x40eaf8, decrypted string: Flags=\norg_addr: 0x40eb50, decrypted string: IDT\norg_addr: 0x40ec04, decrypted string: https://\norg_addr: 0x40ec1f, decrypted string: http://\norg_addr: 0x40ec41, decrypted string: /sanity/\norg_addr: 0x40ef16, decrypted string: Ver\norg_addr: 0x40ef38, decrypted string: DT:\norg_addr: 0x40ef69, decrypted string: Ver:\norg_addr: 0x40ef9f, decrypted string: BVer:\norg_addr: 0x40efd5, decrypted string: Typ:\norg_addr: 0x40f14e, decrypted string: nx\norg_addr: 0x41045c, decrypted string: user32.dll\norg_addr: 0x41048e, decrypted string: OemToCharA\norg_addr: 0x41092a, decrypted string: kernel32.dll\norg_addr: 0x410966, decrypted string: GetVersionExA\norg_addr: 0x410a6b, decrypted string: ProductName\norg_addr: 0x410a93, decrypted string: \\Software\\Microsoft\\Windows NT\\CurrentVersion\\\norg_addr: 0x410e2c, decrypted string: kernel32.dll\norg_addr: 0x410e54, decrypted string: GetFileSize\norg_addr: 0x411055, decrypted string: <?xml version=\"1.0\" encoding=\"UTF-16\"?>\norg_addr: 0x411075, decrypted string: <Task version=\"1.1\"\nxmlns=\"http://schemas.microsoft.com/windows/2004/02/mit/task\">\norg_addr: 0x4110ae, decrypted string: <RegistrationInfo>\norg_addr: 0x4110dd, decrypted string: <Description><#DESC#></Description>\norg_addr: 0x41110c, decrypted string: </RegistrationInfo>\norg_addr: 0x41113a, decrypted string: <#DESC#>\norg_addr: 0x411171, decrypted string: <#TRIGGERS#>\norg_addr: 0x4111a0, decrypted string: <Principals>\n\n```\n\n-----\n\n```\norg_addr: 0x4111cf, decrypted string: <Principal id Author >\norg_addr: 0x411202, decrypted string: <UserId>SYSTEM</UserId>\norg_addr: 0x411233, decrypted string: <LogonType>InteractiveToken</LogonType>\norg_addr: 0x411260, decrypted string: <RunLevel>HighestAvailable</\norg_addr: 0x411291, decrypted string: <RunLevel>LeastPrivilege</RunLevel>\norg_addr: 0x4112c0, decrypted string: </Principal>\norg_addr: 0x4112ef, decrypted string: </Principals>\norg_addr: 0x411327, decrypted string: <Settings>\norg_addr: 0x411362, decrypted string: <Enabled>true</Enabled>\norg_addr: 0x41139d, decrypted string: <Hidden>false</Hidden>\norg_addr: 0x4113d8, decrypted string: <RunOnlyIfIdle>false</RunOnlyIfIdle>\norg_addr: 0x411413, decrypted string: <WakeToRun>false</WakeToRun>\norg_addr: 0x41144e, decrypted string: <ExecutionTimeLimit>PT0S</ExecutionTimeLimit>\norg_addr: 0x411489, decrypted string:\n<DisallowStartIfOnBatteries>false</DisallowStartIfOnBatteries>\norg_addr: 0x4114c4, decrypted string:\n<StopIfGoingOnBatteries>false</StopIfGoingOnBatteries>\norg_addr: 0x4114ff, decrypted string: <Priority>5</Priority>\norg_addr: 0x41153a, decrypted string: </Settings>\norg_addr: 0x411575, decrypted string: <Actions Context=\"Author\">\norg_addr: 0x4115b0, decrypted string: <Exec>\norg_addr: 0x4115eb, decrypted string: <Command><#PROGRAM#></Command>\norg_addr: 0x411626, decrypted string: <Arguments><#PARAMS#></Arguments>\norg_addr: 0x411661, decrypted string: </Exec>\norg_addr: 0x41169c, decrypted string: </Actions>\norg_addr: 0x4116d7, decrypted string: </Task>\norg_addr: 0x411729, decrypted string: <#PROGRAM#>\norg_addr: 0x41176f, decrypted string: <#PARAMS#>\norg_addr: 0x411833, decrypted string: <Triggers>\norg_addr: 0x411854, decrypted string: <CalendarTrigger>\norg_addr: 0x411899, decrypted string: <Repetition>\norg_addr: 0x4118ca, decrypted string: <Interval>PT\norg_addr: 0x4118f3, decrypted string: M</Interval>\norg_addr: 0x411924, decrypted string: <Duration>P1D</Duration>\norg_addr: 0x411955, decrypted string: <StopAtDurationEnd>false</StopAtDurationEnd>\norg_addr: 0x411986, decrypted string: </Repetition>\norg_addr: 0x4119ab, decrypted string: <StartBoundary><#YEAR#>-<#MONTH#><#DAY#>T<#HOUR#>:<#MI\norg_addr: 0x4119dc, decrypted string: <Enabled>true</Enabled>\norg_addr: 0x411a17, decrypted string: <ScheduleByDay>\norg_addr: 0x411a4e, decrypted string: <DaysInterval>1</DaysInterval>\norg_addr: 0x411a88, decrypted string: </ScheduleByDay>\norg_addr: 0x411ac5, decrypted string: </CalendarTrigger>\norg_addr: 0x411b02, decrypted string: </Triggers>\norg_addr: 0x411c13, decrypted string: <#HOUR#>\norg_addr: 0x411c5d, decrypted string: <#MIN#>\norg_addr: 0x411ca7, decrypted string: <#SEC#>\norg_addr: 0x411cf1, decrypted string: <#YEAR#>\norg_addr: 0x411d3b, decrypted string: <#MONTH#>\norg_addr: 0x411d85, decrypted string: <#DAY#>\norg_addr: 0x411de6, decrypted string: <#TRIGGERS#>\norg_addr: 0x411e94, decrypted string: SYSTEM\norg_addr: 0x411f7a, decrypted string: Tasks\\\norg_addr: 0x411fd5, decrypted string: *.job\norg_addr: 0x412461, decrypted string: /interactive\n\n```\n\n-----\n\n```\norg_addr: 0x4124af, decrypted string: at.exe\norg_addr: 0x412551, decrypted string: Tasks\\\norg_addr: 0x4125a8, decrypted string: AT\norg_addr: 0x4125d3, decrypted string: .job\norg_addr: 0x41292f, decrypted string: .xml\norg_addr: 0x41296e, decrypted string: /create /F /tn\norg_addr: 0x412992, decrypted string: \" /xml \"\norg_addr: 0x4129c7, decrypted string: schtasks.exe\norg_addr: 0x412a25, decrypted string: /create /F /tn\norg_addr: 0x412a52, decrypted string: \" /tr \"\norg_addr: 0x412a97, decrypted string: /sc DAILY /ST\norg_addr: 0x412aea, decrypted string: /RU SYSTEM\norg_addr: 0x412b29, decrypted string: /IT\norg_addr: 0x412b62, decrypted string: schtasks.exe\norg_addr: 0x412d34, decrypted string: /query /xml\norg_addr: 0x412d51, decrypted string: schtasks.exe\norg_addr: 0x412d9c, decrypted string: </Task>\norg_addr: 0x412e04, decrypted string: </Command>\norg_addr: 0x412e21, decrypted string: <Command>\norg_addr: 0x412ea5, decrypted string: /delete /F /TN \"\norg_addr: 0x412eda, decrypted string: schtasks.exe\norg_addr: 0x412f28, decrypted string: </Task>\norg_addr: 0x413074, decrypted string: SHGetSpecialFolderPathW\norg_addr: 0x413091, decrypted string: shell32.dll\norg_addr: 0x413c5a, decrypted string:\nSOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\\norg_addr: 0x413d72, decrypted string: SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\\norg_addr: 0x413d8e, decrypted string: Uninstall\norg_addr: 0x413e1b, decrypted string: DisplayIcon\norg_addr: 0x413e6a, decrypted string: DisplayName\norg_addr: 0x413eb9, decrypted string: UninstallString\norg_addr: 0x413f20, decrypted string: Publisher\norg_addr: 0x414108, decrypted string: cmd.exe /Q /D /c del \"\norg_addr: 0x414178, decrypted string:\nSOFTWARE\\Microsoft\\Windows\\CurrentVersion\\RunOnce\norg_addr: 0x4141ad, decrypted string: cmd.exe /Q /D /c del \"\norg_addr: 0x41421d, decrypted string:\nSOFTWARE\\Microsoft\\Windows\\CurrentVersion\\RunOnce\norg_addr: 0x414636, decrypted string: GetPwrCapabilities\norg_addr: 0x414824, decrypted string: open\norg_addr: 0x4163d5, decrypted string: 000000000000\norg_addr: 0x416449, decrypted string: 000000\norg_addr: 0x4164cd, decrypted string: FFFFFFFF\norg_addr: 0x4169f5, decrypted string: dir\norg_addr: 0x416a16, decrypted string: /S \"\norg_addr: 0x416a35, decrypted string: *.*\norg_addr: 0x416a6b, decrypted string: TIMEOUT\norg_addr: 0x416bc2, decrypted string: cmd.exe\norg_addr: 0x416bf3, decrypted string: /d /c\norg_addr: 0x416c1c, decrypted string: & cmd /d /c del\norg_addr: 0x416c71, decrypted string: CreateProcessA\norg_addr: 0x416c9a, decrypted string: kernel32.dll\norg_addr: 0x416dad, decrypted string: cmd.exe\norg_addr: 0x416dde, decrypted string: /d /c\norg_addr: 0x416e0d, decrypted string: & cmd /d /c rd /S /Q\n\n```\n\n-----\n\n```\norg_addr: 0x416e6e, decrypted string: CreateProcessA\norg_addr: 0x416e97, decrypted string: kernel32.dll\norg_addr: 0x4170a7, decrypted string: MachineGuid\norg_addr: 0x4170cf, decrypted string: Software\\Microsoft\\Cryptography\norg_addr: 0x417116, decrypted string: MachineGuid\norg_addr: 0x41713e, decrypted string: Software\\Microsoft\\Cryptography\norg_addr: 0x417253, decrypted string: user32.dll\norg_addr: 0x41727f, decrypted string: GetLastInputInfo\norg_addr: 0x41734c, decrypted string: GetUserDefaultUILanguage\norg_addr: 0x417369, decrypted string: kernel32.dll\norg_addr: 0x417a58, decrypted string: .ini\norg_addr: 0x417ab4, decrypted string: .txt\norg_addr: 0x417ad7, decrypted string: .txt\norg_addr: 0x4182d5, decrypted string: cmd.exe\norg_addr: 0x418376, decrypted string: 1.dat\norg_addr: 0x4183a9, decrypted string: 2.dat\norg_addr: 0x418448, decrypted string: /d /c\norg_addr: 0x4184a3, decrypted string: cmd /d /c copy /B /Y /V\norg_addr: 0x4184fd, decrypted string: & cmd /d /c del \"\norg_addr: 0x418528, decrypted string: \" & cmd /d /c del \"\norg_addr: 0x41857b, decrypted string: CreateProcessA\norg_addr: 0x4185a4, decrypted string: kernel32.dll\norg_addr: 0x41878f, decrypted string: psapi.dll\norg_addr: 0x4187ce, decrypted string: GetModuleFileNameExA\norg_addr: 0x4187f6, decrypted string: EnumProcessModules\norg_addr: 0x418d30, decrypted string: mnprstghklbcdf\norg_addr: 0x418d56, decrypted string: iuaaooee\norg_addr: 0x41a1e7, decrypted string: kernel32.dll\norg_addr: 0x41a20d, decrypted string: FreeLibrary\norg_addr: 0x41a237, decrypted string: EnterCriticalSection\norg_addr: 0x41a261, decrypted string: LeaveCriticalSection\norg_addr: 0x41a28b, decrypted string: WaitForSingleObject\norg_addr: 0x41a2b5, decrypted string: CloseHandle\norg_addr: 0x41a2df, decrypted string: GetExitCodeProcess\norg_addr: 0x41a309, decrypted string: GetSystemDirectoryW\norg_addr: 0x41a333, decrypted string: GetModuleFileNameW\norg_addr: 0x41a35d, decrypted string: DeleteFileA\norg_addr: 0x41a387, decrypted string: CreateFileW\norg_addr: 0x41a3b1, decrypted string: CreateFileA\norg_addr: 0x41a3db, decrypted string: ReadFile\norg_addr: 0x41a405, decrypted string: WriteFile\norg_addr: 0x41a42f, decrypted string: SetFilePointer\norg_addr: 0x41a459, decrypted string: MoveFileW\norg_addr: 0x41a48c, decrypted string: MoveFileA\norg_addr: 0x41a4c2, decrypted string: FindFirstFileW\norg_addr: 0x41a4f8, decrypted string: FindNextFileW\norg_addr: 0x41a52e, decrypted string: FindClose\norg_addr: 0x41a564, decrypted string: CreateProcessW\norg_addr: 0x41a59a, decrypted string: CreateProcessA\norg_addr: 0x41a5d0, decrypted string: GetStartupInfoA\norg_addr: 0x41a606, decrypted string: CopyFileW\norg_addr: 0x41a63c, decrypted string: GetTempPathA\norg_addr: 0x41a6cf, decrypted string: PeekNamedPipe\norg_addr: 0x41a705, decrypted string: CreatePipe\norg_addr: 0x41a73b, decrypted string: GetFileAttributesW\n\n```\n\n-----\n\n```\norg_addr: 0x41a771, decrypted string: GetShortPathNameA\norg_addr: 0x41a7a7, decrypted string: GetShortPathNameW\norg_addr: 0x41a7dd, decrypted string: GetComputerNameA\norg_addr: 0x41a813, decrypted string: CreateDirectoryA\norg_addr: 0x41a849, decrypted string: CreateDirectoryW\norg_addr: 0x41a87f, decrypted string: RemoveDirectoryA\norg_addr: 0x41a8b5, decrypted string: GetCurrentProcess\norg_addr: 0x41a8eb, decrypted string: SetFileTime\norg_addr: 0x41a921, decrypted string: GetVolumeInformationA\norg_addr: 0x41a957, decrypted string: GetTickCount\norg_addr: 0x41a98d, decrypted string: ExitThread\norg_addr: 0x41a9c3, decrypted string: CreateThread\norg_addr: 0x41a9f9, decrypted string: ResumeThread\norg_addr: 0x41aa2f, decrypted string: GetLocalTime\norg_addr: 0x41aa65, decrypted string: OpenProcess\norg_addr: 0x41aa9b, decrypted string: GetSystemPowerStatus\norg_addr: 0x41aad1, decrypted string: GetWindowsDirectoryW\norg_addr: 0x41ab07, decrypted string: SetFileAttributesW\norg_addr: 0x41ab3d, decrypted string: Sleep\norg_addr: 0x41ab73, decrypted string: TerminateProcess\norg_addr: 0x41ac02, decrypted string: advapi32.dll\norg_addr: 0x41ac28, decrypted string: RegCloseKey\norg_addr: 0x41ac52, decrypted string: RegOpenKeyExW\norg_addr: 0x41ac7c, decrypted string: RegDeleteKeyW\norg_addr: 0x41aca6, decrypted string: RegCreateKeyExW\norg_addr: 0x41acd0, decrypted string: RegSetValueExW\norg_addr: 0x41acfa, decrypted string: RegQueryValueExW\norg_addr: 0x41ad24, decrypted string: RegDeleteValueW\norg_addr: 0x41ad4e, decrypted string: RegEnumValueW\norg_addr: 0x41ad78, decrypted string: RegEnumKeyW\norg_addr: 0x41ae05, decrypted string: user32.dll\norg_addr: 0x41ae2b, decrypted string: GetWindowThreadProcessId\norg_addr: 0x41ae55, decrypted string: EnumWindows\norg_addr: 0x41ae7f, decrypted string: WaitForInputIdle\norg_addr: 0x41afaa, decrypted string: kernel32.dll\norg_addr: 0x41afeb, decrypted string: LoadLibraryA\norg_addr: 0x41b01c, decrypted string: GetProcAddress\n\n## End.\n\n m4n0w4r\n\n```\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-05-11 - Quick analysis note about DealPly (Adware).pdf"
    ],
    "report_names": [
        "2021-05-11 - Quick analysis note about DealPly (Adware).pdf"
    ],
    "threat_actors": [
        {
            "id": "f8dddd06-da24-4184-9e24-4c22bdd1cbbf",
            "created_at": "2023-01-06T13:46:38.626906Z",
            "updated_at": "2025-03-27T02:00:02.877001Z",
            "deleted_at": null,
            "main_name": "Tick",
            "aliases": [
                "Stalker Taurus",
                "PLA Unit 61419",
                "Nian",
                "BRONZE BUTLER",
                "REDBALDKNIGHT",
                "STALKER PANDA",
                "G0060"
            ],
            "source_name": "MISPGALAXY:Tick",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "d4e7cd9a-2290-4f89-a645-85b9a46d004b",
            "created_at": "2022-10-25T16:07:23.419513Z",
            "updated_at": "2025-03-27T02:02:09.790389Z",
            "deleted_at": null,
            "main_name": "Bronze Butler",
            "aliases": [
                "Bronze Butler",
                "CTG-2006",
                "Operation ENDTRADE",
                "RedBaldNight",
                "Stalker Panda",
                "Stalker Taurus",
                "TEMP.Tick",
                "Tick"
            ],
            "source_name": "ETDA:Bronze Butler",
            "tools": [
                "8.t Dropper",
                "8.t RTF exploit builder",
                "8t_dropper",
                "9002 RAT",
                "AngryRebel",
                "Blogspot",
                "Daserf",
                "Datper",
                "Elirks",
                "Farfli",
                "Gh0st RAT",
                "Ghost RAT",
                "HOMEUNIX",
                "HidraQ",
                "HomamDownloader",
                "Homux",
                "Hydraq",
                "Lilith",
                "Lilith RAT",
                "McRAT",
                "MdmBot",
                "Mimikatz",
                "Minzen",
                "Moudour",
                "Muirim",
                "Mydoor",
                "Nioupale",
                "PCRat",
                "POISONPLUG.SHADOW",
                "Roarur",
                "RoyalRoad",
                "ShadowPad Winnti",
                "ShadowWali",
                "ShadowWalker",
                "SymonLoader",
                "WCE",
                "Wali",
                "Windows Credential Editor",
                "Windows Credentials Editor",
                "XShellGhost",
                "XXMM",
                "gsecdump",
                "rarstar"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "bf0489c5-1c07-41e6-91c9-855ad96ccc6a",
            "created_at": "2022-10-25T16:47:55.541639Z",
            "updated_at": "2025-03-27T02:05:17.253496Z",
            "deleted_at": null,
            "main_name": "BRONZE BUTLER",
            "aliases": [
                "Daserf",
                "Stalker Panda ",
                "Tick ",
                "CTG-2006 "
            ],
            "source_name": "Secureworks:BRONZE BUTLER",
            "tools": [
                " DGet",
                " Daserf",
                " Datper",
                " Gofarer",
                " MSGet",
                " Mimikatz",
                " RarStar",
                " Screen Capture Tool",
                " ShadowPad",
                " T-SMB",
                " WinRAR",
                " Windows Credential Editor",
                " gsecdump",
                " xmm downloader",
                " xxmm",
                "ABK"
            ],
            "source_id": "Secureworks",
            "reports": null
        }
    ],
    "ts_created_at": 1673536038,
    "ts_updated_at": 1743041146,
    "ts_creation_date": 1653751415,
    "ts_modification_date": 1653751415,
    "files": {
        "pdf": "https://archive.orkl.eu/3a79f6e90f3daa4c22dfedce3ccb69584029d465.pdf",
        "text": "https://archive.orkl.eu/3a79f6e90f3daa4c22dfedce3ccb69584029d465.txt",
        "img": "https://archive.orkl.eu/3a79f6e90f3daa4c22dfedce3ccb69584029d465.jpg"
    }
}