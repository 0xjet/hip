{
    "id": "4d6c5cac-30e5-459f-b339-9a3fb6f613d0",
    "created_at": "2023-01-12T14:59:09.532674Z",
    "updated_at": "2025-03-27T02:05:55.116703Z",
    "deleted_at": null,
    "sha1_hash": "49e8a16e6ba3afefd1b05edfb581e25443b6be7d",
    "title": "2019-03-01 - Threat Alert- AVE Maria infostealer on the rise",
    "authors": "",
    "file_creation_date": "2022-05-28T02:08:15Z",
    "file_modification_date": "2022-05-28T02:08:15Z",
    "file_size": 2398902,
    "plain_text": "# Threat Alert: AVE Maria infostealer on the rise\n\n**[blog.morphisec.com/threat-alert-ave-maria-infostealer-on-the-rise-with-new-stealthier-delivery](http://blog.morphisec.com/threat-alert-ave-maria-infostealer-on-the-rise-with-new-stealthier-delivery)**\n\nPosted by [Alon Groisman on March 1, 2019](https://blog.morphisec.com/author/alon-groisman)\nFind me on:\n[LinkedIn](https://www.linkedin.com/in/alon-groisman-84a78727/)\n\n[Tweet](https://twitter.com/share)\n\n\n-----\n\nOver the past two weeks, Morphisec Labs has identified an increase in AVE_MARIA\n**malware infecting victims through a variety of phishing methods. One of the downloader**\n[components and C2 metadata are similar to those we saw in the Orcus RAT attacks last](https://blog.morphisec.com/new-campaign-delivering-orcus-rat)\nmonth and we believe they are by the same threat actor.\n\nAVE_MARIA is an advanced information stealer malware, described in this Yoroi Lab post\nabout an earlier attack on an Italian oil and gas company. It is a relatively new malware, with\nits first documented appearance towards the end of 2018.\n\nWhile previous coverage of the malware reported the use of AutoIt as part of the\nAVE_MARIA downloader stage, the campaign identified by Morphisec uses additional, more\nadvanced stealth methods to deliver the same information stealer. More specifically, we have\n[identified the adoption of Orcus RAT delivery stages and Revenge RAT fileless components](https://blog.morphisec.com/new-campaign-delivering-orcus-rat)\nthat execute reconnaissance and hollowing attacks on legitimate Windows processes to\navoid being detected.\n\n## TECHNICAL ANALYSIS:\n\n### Phishing\n\nFollowing a successful email phishing campaign, a malicious VBScript is executed. This\nVBScript contains a PowerShell command that downloads an initial Recon stage component.\n\n->\n\n\n-----\n\n->\n\n-> After additional deobfuscation steps, we get to the final PowerShell execution.\n\n## First Stage Recon Download\n\nThe first stage PowerShell command downloads the RevengeRat component directly into\nmemory (filename â€“ Nuclear Explosion.exe) from pastee.ee, a popular free available text\nstorage site. This component is identified by its Mutex and strings metadata (RV_MUTEX).\n\n\n-----\n\nThe component communicates with its C2, sends all the basic information from the computer\n(what are the running processes, installed AVs, Username, Machine, system drives and\nmore) as part of a reconnaissance stage, then executes the next stage PowerShell\ncommand.\n\n## Second Stage Downloader\n\nBoth the AVE_MARIA and the downloader are not part of the original second stage\nPowerShell command that is executed following the described first stage. This makes it very\nunlikely that runtime detection solutions will detect the malware. The same downloader and\nthe information stealer are stored on paste.ee and therefore also cannot be categorized as\nlow reputation URL. The first URL represents the Downloader, which executes a known\nprocess hollowing technique on a legitimate Windows process (RegAsm.exe). This is done\nto bypass whitelisting. The same module was also used as part of the previously described\n[Orcus RAT campaign.](http://blog.morphisec.com/new-campaign-delivering-orcus-rat)\n\n\n-----\n\nThe Downloader is obfuscated by automatic tools and can easily be de-obfuscated by\n[de4dot. After deobfuscation, we clearly see that the script calls C.M method and invoke R](https://github.com/0xd4d/de4dot)\nfunction. This, in turn, executes process hollowing by the book on a 32 bit process,\nCreateProcess in suspend, Unmap and Map and then resume thread on the written data.\n\n\n-----\n\n## AVE_MARIA\n\nThe Information stealer is the same as that [described by Yoroi Lab in a previous attack.](https://blog.yoroi.company/research/the-ave_maria-malware/)\n\nAs reported, the privilege escalation used by the malware is an old fashion elevated PkgMgr[>DISM Dll hijacking vulnerability for UAC bypass. The privilege escalation itself is executed](https://github.com/FuzzySecurity/PowerShell-Suite/tree/master/Bypass-UAC)\nby an additional executable, which is embedded as resource inside the malware.\n\n\n-----\n\nThe malware communicates with 194.5.98[.]139, which was previously identified as a C2 for\nthe Orcus RAT campaign.\n\n## Conclusions\n\nThere is an obvious adaptation of various memory evasion techniques by the different\nhacker groups. The only way to combat this type of evasion is change the game on attackers\nand make their target unpredictable.\n\nMorphisec applies Moving Target Defense and deterministically prevents this type of attacks\nwithout prior knowledge\n\n\n-----\n\n### Artifacts\n\n**_VBS_**\n\nhxxps://paste[.]ee/r/d8Xpk/0\n\n**_Revenge RAT Recon Downloader_**\n\nhxxps://paste[.]ee/r/YoY3z/0\n\n**_AVE_MARIA Downloader -_**\n\nhxxps://paste[.]ee/r/cbaHS\n\nhxxps://paste[.]ee/r/VsX9H\n\n**_AVE_MARIA_**\n\nhxxps://paste[.]ee/r/4AIl0\n\nhxxps://paste[.]ee/r/T36RL\n\n**_Domains_**\n\nlist131.ignorelist[.]com\n\n194.5.98[.]139\n\n[Contact SalesInquire via Azure](http://10.10.0.46/mailto:sales@morphisec.com)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2019/2019-03-01 - Threat Alert- AVE Maria infostealer on the rise.pdf"
    ],
    "report_names": [
        "2019-03-01 - Threat Alert- AVE Maria infostealer on the rise.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673535549,
    "ts_updated_at": 1743041155,
    "ts_creation_date": 1653703695,
    "ts_modification_date": 1653703695,
    "files": {
        "pdf": "https://archive.orkl.eu/49e8a16e6ba3afefd1b05edfb581e25443b6be7d.pdf",
        "text": "https://archive.orkl.eu/49e8a16e6ba3afefd1b05edfb581e25443b6be7d.txt",
        "img": "https://archive.orkl.eu/49e8a16e6ba3afefd1b05edfb581e25443b6be7d.jpg"
    }
}