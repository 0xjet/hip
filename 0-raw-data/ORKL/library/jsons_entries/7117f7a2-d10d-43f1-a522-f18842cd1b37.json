{
    "id": "7117f7a2-d10d-43f1-a522-f18842cd1b37",
    "created_at": "2023-01-12T15:10:40.417949Z",
    "updated_at": "2025-03-27T02:08:41.500368Z",
    "deleted_at": null,
    "sha1_hash": "77d87a25b67c6e776f43e480ec16078b6687161a",
    "title": "2021-12-02 - Magnat campaigns use malvertising to deliver information stealer, backdoor and malicious Chrome extension",
    "authors": "",
    "file_creation_date": "2022-05-28T17:31:15Z",
    "file_modification_date": "2022-05-28T17:31:15Z",
    "file_size": 4624391,
    "plain_text": "# Magnat campaigns use malvertising to deliver information stealer, backdoor and malicious Chrome extension\n\n**[blog.talosintelligence.com/2021/12/magnat-campaigns-use-malvertising-to.html](https://blog.talosintelligence.com/2021/12/magnat-campaigns-use-malvertising-to.html)**\n\nBy [Tiago Pereira.](https://twitter.com/t14g0p)\n\n\n-----\n\nTalos recently observed a malicious campaign offering fake installers of popular\nsoftware as bait to get users to execute malware on their systems.\nThis campaign includes a set of malware distribution campaigns that started in late\n2018 and have targeted mainly Canada, along with the U.S., Australia and some EU\ncountries.\nTwo undocumented malware families (a backdoor and a Google Chrome extension)\nare consistently delivered together in these campaigns.\nAn unknown actor with the alias \"magnat\" is the likely author of these new families and\nhas been constantly developing and improving them.\nThe attacker's motivations appear to be financial gain from selling stolen credentials,\nfraudulent transactions and Remote Desktop access to systems.\n\n## Introduction\n\nTalos recently observed a malware distribution campaign that tries to trick users into\nexecuting fake software installers of popular software on their systems. We believe with\nmoderate confidence that online advertising is used to reach potential victims that are\nsearching for software to install on their systems. The combination of advertising and fake\nsoftware installers is particularly tricky, as the users reached by the ads are already\npredisposed to execute an installer on their systems.\n\nOnce the fake installers run, they execute three pieces of malware on the victim's system:\n\nA password stealer that collects all the credentials available on the system.\nA \"backdoor\" that sets up remote access via a stealth Microsoft Remote Desktop\nsession by forwarding the RDP port through an SSH tunnel, allowing access to\nsystems even when behind a firewall.\nA malicious browser extension that contains several information-stealing features, such\nas keylogging and taking screenshots.\n\nPassword stealers have long presented a risk to individuals and to companies. The\ncompromised accounts are frequently sold in underground forums and may lead to additional\ncompromise using the stolen accounts and through password reuse. The chrome extension\nadds to this risk by allowing the theft of credentials used on the web that may not be stored\nin the system. Additionally, the use of an SSH tunnel to forward RDP to an external server\nprovides attackers with a reliable way to login remotely to a system, bypassing firewall\ncontrol.\n\n## The campaigns\n\n\n-----\n\nThe attack begins when a victim looks for a particular piece of software for download. Talos\nbelieves the attacker has set up an advertising campaign that will present links to a web\npage, offering the download of a software installer. The installer has many different file\nnames. For example: viber-25164.exe, wechat-35355.exe, build_9.716-6032.exe,\nsetup_164335.exe, nox_setup_55606.exe and battlefieldsetup_76522.exe.\n\nWhen executed, this installer does not install the actual software it announces, but instead\nexecutes a malicious loader on the system.\n\n\n-----\n\nThe installer/loader is an SFX-7-Zip archive or a nullsoft installer that decodes and drops a\nlegitimate AutoIt interpreter, and three obfuscated AutoIt scripts that decode the final\npayloads in memory and inject them into the memory of another process.\n\nThe final payloads are almost always the same three specific pieces of malware:\n\n[A commodity password stealer. Initially Azorult and currently](https://malpedia.caad.fkie.fraunhofer.de/details/win.azorult) [Redline. Both steal all the](https://malpedia.caad.fkie.fraunhofer.de/details/win.redline_stealer)\ncredentials it can find on the system. These password stealers are widely known and\ndocumented and we will analyse them further on this post.\nA backdoor, or backdoor installer that we are calling \"MagnatBackdoor,\" that configures\nthe system for stealthy RDP access, adds a new user and sets a scheduled task to\nperiodically ping the C2 and, when instructed, create an outbound ssh tunnel\nforwarding the RDP service.\nAn installer for a chrome extension, that we are calling \"MagnatExtension,\" that packs\nseveral features useful for stealing data from the web browser: a form grabber,\nkeylogger, screenshotter, cookie stealer and arbitrary JavaScript executor, among\nothers.\n\n### Campaign timeline\n\nBased on our telemetry and on build dates of analyzed samples, we built a timeline that\nhelps us understand the actor's activities.\n\nOur telemetry is focused only on MagnatBackdoor activity and shows that at the end of 2019,\nMagnatBackdoor was being distributed through early 2020. From that moment on, we had\nlittle to no visibility of MagnatBackdoor again until April 2021 when the activity seems to have\nrestarted.\n\n\n-----\n\nThe telemetry data aligns with the build dates of the samples we have found through OSINT.\nWe found almost no samples built between February and October 2020. However, we found\nsamples built in late 2020 and early 2021, for which we had no visibility in the telemetry.\nThere are several possible reasons for this — most likely, these may have been used in test\nor smaller scale campaigns.\n\nWe also found several interesting pieces of information:\n\nThe oldest MagnatExtension sample we found was dated August 2018. From that date\nuntil late 2019, we found several samples that delivered the extension and Azorult\nstealer.\nThe oldest MagnatBackdoor sample we found is from October 2019. From that\nmoment on, all samples we found contain the trio\nMagnatBackdoor/MagnatExtension/Azorult.\nIn February 2020, just before the large activity gap, Azorult stopped being part of the\ntrio of malware. This was possibly a consequence of the release of Chrome 80 that is\nknown to have broken several malware families.\nWe found a small number of samples built in February that include Vidar Stealer and\nGozi, suggesting that the attacker may have been testing Azorult replacements.\nIn October 2020 the actor started testing Redline Stealer, creating some samples using\nRedline configured with the ID \"testing\";\nThe campaigns that followed used the Redline / MagnatBackdoor / MagnatExtension\ntrio. Interestingly, these campaigns contain Redline IDs that are allusive to advertising\ncampaigns (e.g., ads, ads3, ads5, ads6, ads7, ads8, eumix3, eumix4).\n\nWe are not sure if the use of [malvertising started in October, after the Redline introduction,](https://blog.talosintelligence.com/2019/07/malvertising-deepdive.html)\nwith the \"ads\" bot ID. However, we believe with moderate confidence (although evidence\nsuggests it, we have not seen the actual ads), that malvertising is a delivery method used by\nthe author.\n\nWe started suspecting of [malvertising after analysing a few compromised systems. The](https://open.spotify.com/episode/6onElssJNa8cA1fv03HETj?si%3DoDl9FY2ZSNynvjquIz9tuw)\nmalicious installer had been downloaded using google chrome, and there was no local email\nclient open. The browser had communicated only with cloudflare and google IPs at the\nmoment of the download and in one case, a few seconds prior to the download the browser\nhad visited a software review website.\n\nThese behaviours are not conclusive and they can be explained by other reasons (e.g.\nblackhat SEO, a webmail link). However, we later found the Redline botnet IDs (ads, ads3,\nads5, etc.) which strengthened the malvertising theory. Finally, we found a [tweet from August](https://twitter.com/securityaura/status/1424782425239007239)\n2021 by a security researcher mentioning an ongoing malvertising campaign, posting\nscreenshots of the ads and sharing one of the downloaded samples.\n\n\n-----\n\nAfter analyzing the sample referred to in this tweet, we verified that it is one of the samples\nthat includes MagnatBackdoor, MagnatExtension and Redline (botnet: ads7).\n\n### Victimology\n\nBecause we are looking at a trio of malware with activity since 2018 with multiple C2\naddresses used in every month of activity, it's not easy to find a way to study the targets of\nthese campaigns. However, the domain stataready[.]icu has been used as the\nMagnatExtension C2 since January 2019 and it is still used today in the settings received\nfrom the C2 servers as the updated C2. It aggregates the traffic from infected systems in\n\n\n-----\n\nseveral campaigns, providing a good overall picture of the infection distribution through\nPassive DNS.\n\nPassive DNS shows us the frequency of DNS queries for the C2 address. By looking at the\nrelative distribution of the origin of these queries we can have a picture of the Countries more\naffected by the malware.\n\nThe relatively focused distribution of this malware is consistent with the use of advertising as\na distribution channel. There is a clear focus on Canada (roughly 50 percent of the\ninfections), followed by the U.S. and Australia.\n\nThere are also several infections in Italy, Spain and Norway (Redline's ID \"eumix\" hinted at\nsome interest in European countries).\n\nMore than 50 percent of the infections are in Canada, which leads us to wonder if there is\nany more specific target in that country. However, there is no domain specified in the\nMagnatExtension settings that is specific to Canada, and neither MagnatBackdoor or Redline\nstealer provide any hints.\n\n## Malware analysis\n\n### The loader\n\n\n-----\n\nThe loader is a .exe or a .iso file pretending to be a software installer. When executed, it\ncreates several files and executes a set of commands that ultimately lead to the execution of\nthe final malware payloads.\n\nWe have seen similar loaders delivering other malware and documented by other\nresearchers and believe that the loader is not specific to these campaigns.\n\nThere are two loader types that, although different in the installer technology used, are very\nsimilar in the technique that obfuscates and executes the payloads. A 7-Zip sfx (selfextracting archive) is on one loader, and on the other is a NSI (NullSoft Installer) file.\n\n[Opening one of the 7-Zip SFX-based loaders with the 7Z SFX builder, we can see the](https://sourceforge.net/projects/s-zipsfxbuilder/)\ncommands that are set to be executed on extraction.\n\nIn this case, the loader uses certutil to decode three of the contained files (dera, sfera and\nbruto) into three files that are very large and highly obfuscated autoIT scripts. Finally, the file\ndos.com (a legitimate autoIT interpreter) is used to execute each of the scripts.\n\nOn the NSI based loader, opening the file with 7-Zip, we can see the contents of the archive.\nThe $APPDATA folder contains the files to be dropped and the $PLUGINSDIR contains NSI\nspecific files. Finally, the [NSIS].nsi file contains the commands that will be executed.\n\n\n-----\n\nAs seen in the image above, copto.vsdm seems to be the only cmd file executed. Extracting\nthis file from the $APPDATA folder and opening it reveals a set of commands that are similar\nin sequence to the one in the 7-Zip file.\n\nLike before, the script performs three times the same actions, with different files:\n\nFIrst, a new file is created containing only the \"MZ\" chars in it.\nThen, findstr extracts only the relevant parts from a file filled with junk data and writes\nthem to the file with \"MZ.\" This action decodes and writes the legitimate AutoIt\ninterpreter to the system.\n\n\n-----\n\nThen, a large AutoIt script is copied to a new file with a name of only one character.\nFinally, as before, the AutoIt interpreter is used to execute the AutoIt script.\n\nIn both cases, the created script contains the final payload and is very obfuscated. Once\nexecuted, it creates a new process (usually the AutoIt interpreter that started it) and injects\nthe final payload into its memory where it will be executed.\n\n### MagnatBackdoor\n\nMagnatBackdoor is an AutoIt-based installer that prepares a system for remote Microsoft\nRemote Desktop access and forwards the RDP service port on an outbound SSH tunnel. As\na result of this installer's actions there is a way for the attacker to access the system\nremotely via RDP, which is why we call it a backdoor.\n\nThis malware applies this technique by setting up a scheduled task that periodically contacts\na C2 server and sets up the tunnel if instructed by the C2 response. The following image\nsummarizes the actions taken by the backdoor.\n\n\n-----\n\nAnalysing the malware sample we find that it was built using AutoIt scripting and then\ntransformed into an executable file. This process leaves several artifacts in the binary that\nprovide useful information.\n\n[The previous image shows the result of the AutoIt extractor tool. It reveals:](https://gitlab.com/suvaditya/autoit-extractor)\n\nThe build path, including the username magnat. This is the same on all samples we\nfound and it's the reason we call it MagnatBackdoor and, by extension, the magnat\ncampaigns.\nThe build path also includes a string \"\\rdp\\new\\\" that reveals the malware version\n(\"new\") and a string \"vago2\" that we believe to be an organizational path, equivalent to\na botnet \"group\" or \"id.\"\nThe time of file creation and last write. This date was key in building the campaign\ntimeline.\nThe list of files packed within the executable.\n\nBased on the build path string, we found samples containing the following versions:\n\"rdp/rdp,\" \"rdp/3.5,\" \"rdp/3.6\" and \"rdp/new.\" The changes between versions seemed to be\nmostly bug fixes and improvements, such as adding some obfuscation to the network\nprotocol. We will focus on the version \"new\" as it is built upon all previous versions.\n\nThe main AutoIt script contains all code and logic needed to install the files we observed in\nthe file list into the file system and to execute several scripts. The final objective is to have a\nset of scheduled tasks (STs) configured on the system that ensure persistence and that\n\n\n-----\n\nconnect to the C2 requesting a command for execution. The following schema shows the key\nsections of the main installer code.\n\nAll the scripts starting with PERFORMSCRIPT are very similar. They receive as parameters\na set of file paths and variables and create a scheduled task XML descriptor by invoking one\nof the create_xml files and then register the scheduled task using the schtasks.exe\ncommand with the generated XML.\n\nThere are three files that create scheduled tasks. By creating these as scheduled tasks,\nsome additional resiliency is added to the malware. For example, if the added user is\nremoved, it will be re-added after some time.\n\nThe first of the scheduled files is add_user.js. This script is responsible for creating a new\nuser, assigning the appropriate permissions and groups and finally configuring the windows\nfirewall to allow RDP communication.\n\n\n-----\n\nThe second scheduled script is obf_pinger_part2.vbs. This script uses some very simplistic\nobfuscation and is mostly responsible for installing RDPWrapper. RDPWrapper is an opensource tool that makes very useful improvements to RDP. From the project's GitHub:\n\nThe third and last scheduled script is checkFscr.vbs. The checkFscr.vbs script has two main\nresponsibilities: installing plink.exe (an SSH command line tool for Windows) and requesting\na command from the C2 server, as shown in the following image.\n\n\n-----\n\nThe function will receive an obfuscated string containing the username, password and\npinger_id on the first line of the snippet. It will then build a string that includes the C2 domain\ndeclared in line 2, information about the OS, the system user, the pinger file version and the\nreceived string and perform an HTTP GET request to the C2 server, sending all this\ninformation in the querystring.\n\nIf the server responds with an HTTP status code of 201, the response body will be appended\nto the \"plink.exe\" command. This allows the attacker to send a plink command that creates\nan ssh tunnel to a remote server, forwarding the local RDP port to be used for remote\naccess.\n\n### MagnatExtension\n\nWe also found a malicious Google Chrome extension delivered in all these campaigns.\nBecause of its prevalence in samples that deliver MagnatBackdoor and because we have\nnot seen it elsewhere, we call it MagnatExtension.\n\nMagnatExtension is delivered by an executable whose only function is to prepare the system\nand install the extension. Notice that this extension is installed from the malware itself and\nnot from the Chrome Extension Store. Once installed, the extension is visible in the\nextensions settings as \"Google's Safe browsing.\"\n\n\n-----\n\nThe extension itself is made of three files — a manifest file, an icon and a background.js file\nthat contains the malicious code that runs in the background while the browser is running.\n\nThe extension code is obfuscated using several techniques, such as function redirects,\nencrypted substitution arrays, function wrappers and string encoding.\n\nWe deobfuscated the JavaScript using a custom Python script. After deobfuscation, we\nanalyzed the code to understand the extension's capabilities.\n\n**Features**\n\nThis extension is very similar in its features to a banking trojan. It periodically connects to a\nC2 to receive the updated configuration settings. Those settings are then used to control the\nbehavior of the features that allow stealing data from the browser, such as a form grabber,\n\n\n-----\n\nkeylogger and screenshotter, among others. The following image summarizes the extension\nbehavior and features.\n\nIn the extension code, at the end of the file, there is a code section where the extension sets\nup the event listeners shown in the previous image.\n\nGoing through each of the listeners is an effective way to cover most of the extension\nfeatures:\n\nForm grabber: The extension listener will capture the onBeforeRequest event whenever a\nweb request is about to be made. This allows it to look at the configuration and, if the current\nURL is in the \"form_URL_filter\" list, it will read the form using the window[\"requestBody\"]\n\n[\"formData\"] property and send it to the C2 in a \"form\" action message type.\n\n\n-----\n\nHistory and scripts: When a browser tab is updated, the extension checks if the tab is loading\na URL. If so, the extension sends a \"history\" request to the C2, which tells the C2 the URL\nthe browser is loading. Finally, it compares the tab URL with the URLs in the \"URL_mask\"\nfield of each item in the \"script\" section of the config. If there is a match, the code in the\n\"code\" field of the matching item is executed in the tab. This way, the extension can\ncompletely replace the content of a page while leaving the address bar URL and the SSLl\nicon untouched.\n\nKeylogger: When a browser tab is updated, the extension checks if the tab is loading a URL.\nIf so, the extension compares the tab URL with the URLs in the \"keylogger\" section of the\nconfig. If there is a match, the extension executes the keylogger code in the tab.\n\nThe keylogger code running in the tab captures all keys pressed by the user and it then\nsends the log back to the extension code through a chrome message, for which there is a\nlistener set up.\n\nScreenshoter: When a browser tab is updated, the extension checks if the tab has completed\na URL loading. If so, the extension compares the tab URL with the URLs in the\n\"screenshoter\" section of the config. If there is a match, the extension executes the\nchrome['tabs']['captureVisibleTab'] function to capture a screenshot and then sends it to the\nC2 in a \"screenshoter\" type request.\n\nThe C2 communication happens as a result of one of the previously described features and\nin two additional moments:\n\nPeriodic ping: The extension sets up an alarm that will trigger every minute that sends a\n\"plugin\" type message to the C2 server that contains the extension ID version. The server\nreply is a JSON string that contains the fields cookie and keylogger. If the cookie variable is\ntrue, the extension will collect and send all cookies to the C2 server. The keylogger field\nswitches on or off a global boolean variable. In earlier versions, this was used to disable the\nkeylogger but it has been deactivated in the latest version.\n\nRequest settings: The extension sets up an alarm that will trigger every 30 minutes and will\ntrigger an HTTP GET request to the C2 server settings path without any additional data. If\nnew settings are received, they will be stored in the browser's local storage.\n\n**Bot settings**\n\nAs previously mentioned, most features use the settings file to check if a particular web page\nrequires action or not. This setting is provided by the C2 server and stored locally. It has the\nfollowing structure:\n\n\n-----\n\nThe settings have changed slightly over time. However, the C2 servers are still the same and\nhave been working for around three years, so the old settings are still available.\n\nThe most recent version - settings3.json:\n\nEarlier version - settings2.json:\n\nFirst version - settings.json:\n\n\n-----\n\nThe first settings version (settings.json) does not contain a server because it was not\npossible to update the C2 via the settings file. The settings2.json adds the server field and\nthe latest version (settings3.json) contains a form grabber active for Facebook URLs. The\nscreenshotter has been active since the first version for the same set of URLs. This suggests\nthe attacker's motivation is to observe the balances of PayPal accounts and cryptocurrency\nwallets and, possibly, request the cookies of those systems.\n\n**C2 communications**\n\nThe C2 address is hardcoded in the sample, and it can be updated by the current C2 with a\nlist of additional C2 files. Interestingly, although this is disabled in recent versions, when the\nserver check fails, the extension can try to obtain a new C2 address from a Twitter hashtag\nsearch.\n\nThe following tweets show the hashtags we found in use:\n\n\n-----\n\nThe algorithm for getting the domain from the tweet is very simple: concatenating the first\nletter of each word. Using the previous tweets as an example, the domains are:\nstataready.icu and bolshebolshezolota.club.\n\nOnce an active C2 is available, the data is sent in json format in the body of an HTTP POST\nrequest. This json string is encrypted. In the next section we will describe the encryption\nused. The following json message types exist:\n\nEach message type \"action\" value matches one of the previously described features.\nAdditionally, the \"plugin\" action is used for the periodic ping message type and its reply\ncontains only two fields used to request the browser cookies and to disable the keylogger.\n\n\n-----\n\nThe settings request is different. An HTTP GET request to the settings path (settings.json,\nsettings2.json or settings3.json) without any extra data. The response is the configuration file\nas described in the previous section.\n\n**Communication encryption**\n\nCommunication with the C2 is done via HTTP (SSL is used in all the samples we saw) and\ncryptography is used to protect the message contents. In all communication to the c2, the\nHTTP body contains a JSON string containing the encryption key encrypted with the server's\npublic key, the AES encrypted text, the initialization vector and a salt.\n\nThe code used to encrypt the data is:\n\nThe communication from C2 to bot is unencrypted on the pinger replies but the settings\nresponse contains a json with encrypted data in the following format.\n\nThe key is not sent this time, it is hardcoded in the decryption function as follows.\n\n\n-----\n\nAfter some research we have concluded that the encryption library and the json string\nformats used by the extension are based on the cryptojs library, an open source javascript\ncryptography library.\n\n## Conclusion\n\nThis research documents a set of malicious campaigns that have been going on for around\nthree years, delivering a trio of malware, including two previously undocumented families\n(MagnatBackdoor and MagnatExtension). During this time, these two families have been\nsubject to constant development and improvement by their authors — this is likely not the\nlast we hear of them.\n\nWe believe these campaigns use malvertising as a means to reach users that are interested\nin keywords related to software and present them links to download popular software. This\ntype of threat can be very effective and requires that several layers of security controls are in\nplace, such as, endpoint protection, network filtering and security awareness sessions.\n\nBased on the use of password stealers and a Chrome extension that is similar to a banking\ntrojan, we assess that the attacker's goals are to obtain user credentials, possibly for sale or\nfor his own use in further exploitation. The motive for the deployment of an RDP backdoor is\nunclear. The most likely are the sale of RDP access, the use of RDP to work around online\nservice security features based on IP address or other endpoint installed tools or the use of\nRDP for further exploitation on systems that appear interesting to the attacker.\n\n## Coverage\n\nWays our customers can detect and block this threat are listed below.\n\n\n-----\n\n[Cisco Secure Endpoint (formerly AMP for Endpoints) is ideally suited to prevent the](https://blog.talosintelligence.com/2021/12/url?q=https://www.cisco.com/c/en/us/products/security/amp-for-endpoints/index.html)\n[execution of the malware detailed in this post. Try Secure Endpoint for free here.](http://10.10.0.46/hhttps://www.cisco.com/c/en/us/products/security/amp-for-endpoints/free-trial.html?utm_medium%3Dweb-referral?utm_source%3Dcisco%26utm_campaign%3Damp-free-trial%26utm_term%3Dpgm-talos-trial%26utm_content%3Damp-free-trial)\n\n[Cisco Secure Web Appliance web scanning prevents access to malicious websites and](https://www.cisco.com/c/en/us/products/security/web-security-appliance/index.html)\ndetects malware used in these attacks.\n\n\n-----\n\n[Cisco Secure Email (formerly Cisco Email Security) can block malicious emails sent by](https://www.cisco.com/c/en/us/products/security/email-security/index.html)\nthreat actors as part of their campaign. You can try Secure Email for free [here.](https://www.cisco.com/c/en/us/products/security/cloud-mailbox-defense?utm_medium%3Dweb-referral%26utm_source%3Dcisco%26utm_campaign%3Dcmd-free-trial-request%26utm_term%3Dpgm-talos-trial)\n\n[Cisco Secure Firewall (formerly Next-Generation Firewall and Firepower NGFW) appliances](https://www.cisco.com/c/en/us/products/security/firewalls/index.html)\nsuch as [Threat Defense Virtual,](https://www.cisco.com/c/en/us/products/collateral/security/firepower-ngfw-virtual/datasheet-c78-742858.html) [Adaptive Security Appliance and](https://www.cisco.com/c/en/us/products/security/adaptive-security-appliance-asa-software/index.html) [Meraki MX can detect](https://meraki.cisco.com/products/appliances)\nmalicious activity associated with this threat.\n\n[Cisco Secure Network/Cloud Analytics (Stealthwatch/Stealthwatch Cloud) analyzes network](https://www.cisco.com/c/en/us/products/security/stealthwatch/index.html)\ntraffic automatically and alerts users of potentially unwanted activity on every connected\ndevice.\n\n[Cisco Secure Malware Analytics (Threat Grid) identifies malicious binaries and builds](https://www.cisco.com/c/en/us/products/security/threat-grid/index.html)\nprotection into all Cisco Secure products.\n\n[Umbrella, Cisco's secure internet gateway (SIG), blocks users from connecting to malicious](https://umbrella.cisco.com/)\ndomains, IPs and URLs, whether users are on or off the corporate network. Sign up for a\n[free trial of Umbrella here.](https://signup.umbrella.com/?utm_medium%3Dweb-referral?utm_source%3Dcisco%26utm_campaign%3Dumbrella-free-trial%26utm_term%3Dpgm-talos-trial%26utm_content%3Dautomated-free-trial)\n\n[Cisco Secure Web Appliance (formerly Web Security Appliance) automatically blocks](https://www.cisco.com/c/en/us/products/security/web-security-appliance/index.html)\npotentially dangerous sites and tests suspicious sites before users access them.\n\nAdditional protections with context to your specific environment and threat data are available\nfrom the [Firewall Management Center.](https://www.cisco.com/c/en/us/products/security/firepower-management-center/index.html)\n\n[Cisco Duo provides multi-factor authentication for users to ensure only those authorized are](https://signup.duo.com/?utm_source%3Dtalos%26utm_medium%3Dreferral%26utm_campaign%3Dduo-free-trial)\naccessing your network.\n\nOpen-source Snort Subscriber Rule Set customers can stay up to date by downloading the\n[latest rule pack available for purchase on Snort.org.](https://www.snort.org/products)\n\n## IOCs\n\nSamples:\n\n0cae9a4e0e73ff75f3ffa7f2d58ee67df34bc93e976609162cd6381ea9eb6f5b\n\nc997d6ca731762b6eb874296b8dea931095bb5d59f6e2195f02cfad246994a07\n\ncb40a5957081d6030e983bcc3e13122660236379858024cfda932117f8d6125f\n\n9b89464c0543e98d6a96ffaa34b78ef62e48182736482ddd968db17dc9e3076e\n\na3b5da275b97840a1e9e5f553d638bfb8e095102edd305008ca2875294b4deb1\n\nba7bb63b7cf08cfe48aead5ec65e81b35b89f4559d16257ba283f77251c15e32\n\nd06ea637979440edf76a679c0e8608e00dae877bfc10e642a4d9d509be2bb2a9\n\ned5abe5b0b9fb82a455ef0e750f44838e1272e743f079871161a2fa179b081f3\n\n1c602fc24a980135f9736d55986d694a4b542d69e6caa225d99c3e9e9c251a1a\n\n\n-----\n\n42178057b6914172e9101ddd265d88501e4518a92e854ad2ef6e8401d3bdbd15\n45b9894e4cac3c21f28308ee48a0095e9516f8b1c26483c1a58b47a9fbbe27e9\n0fde03bd190b9601983c97c4138c5953429a672530f585e53b5725b241c35cbb\nb6cf71093407d3548e25adc93ccc867602d5d5860753d480308a81273a483bee\n933ac399735239f00815637995c752757d867cc601b80274e62ef613c54cd510\n09158bf9c73f856f8a310ffa7238042d08d3a475ea34ffa6cee9e88d841c4a7e\nef44590fa6f19431c0b2182627f95b6b9568bd2700124bfc7abe4a979a363bb6\nc8864081450fbf75d2757716ef237e81c4f419c2e2a3e2deb86432e78412f109\nea3d8e8c07e87fab40fc0e30daea0307c1f0119c6b63a50759625a1edb777a58\n13ce97767c92b0f048b0cb4bf55ce8e928a77dc209c428b02de0a890f8f1ec13\nc7e703543814e6b70c0f1b2fe990f0251246dbe7931d7d7ee53b0e559d00e405\nf12649de9f93f6dc29a1c6838779885b733c95d4157f95bc92d3f81f52b41788\na70525f4aaf688588a65cb60fb18f9cc69b895d12da87cd39ba58f17db37d531\n28529e85f66ccfcc1b3ef43f37398cac1716f191775487a99bfe83a66554397a\n6ffc9bacb24ec4484a006dc3183984af2b7eaef0244fa5c0e96020081287ca62\n65784e672ccaa01697d47837ef036a06e180b394da60011374a7f4e8f3649492\nfbaa11e154c41b8b3e18e6db587d7c9f612ec7a1983aca8ec8a9dbb2322a3a9f\n7d22568c2d8f94852b59f5b01b12289419dc2e617c7977d2262e1061906d3fb3\n794833762b3a94a9b1e88ffb915352823b7192255aa7ac86bbe9f93a64395854\nc915342445a40722379bf91cf3ae3b846c6cd7bac069ad1040e2c22addbca1fd\n1109f4f612577ba61a8437309fd8bbd164d942090a10d490d6339f6ffb05f2cf\ndf3e587781523f2b9a2080caa9856d52b103302ebf311bbfeea54acb89f4b90d\ne2e66789c7f6627bfb270c609bae28cd9df7d369a5ba504dccc623eb11f9e3f2\n68aebb2f33f1475abc863495a1bf4a43de6fa267bedad1e64a037f60e3da707d\n41f9f0dd85b9d1860cbf707471572619218343e1113fa85158f7083d83fcaa0c\nAc1df77c0d6d3c35da7571f49f0f66f144fbcfd442411585e48a82e2f61b1fc1\n\nC2s\n\nMagnatBackdoor:\n\nhttps://chocolatepuma[.]casa/api/ping\nhttps://wormbrainteam[.]club/api/ping\nhttps://430lodsfb[.]xyz/api/ping\nhttps://softstatistic[.]xyz/api/ping\nhttps://happyheadshot[.]club/api/ping\nhttps://aaabasick[.]fun/api/ping\nhttps://nnyearhappy[.]club/api/ping\nhttps://teambrainworm[.]club/api/ping\nhttps://yanevinovat[.]club/api/ping\nhttps://fartoviypapamojetvse[.]club/api/ping\nhttps://hugecarspro[.]space/api/ping\nhttps://burstyourbubble[.]icu/api/ping\n\n\n-----\n\nhttps://boogieboom[.]host/api/ping\nhttps://cgi-lineup[.]website/api/ping\nhttps://newdawnera[.]fun/api/ping/\nhttps://bhajhhsy6[.]site/api/ping/\nhttps://iisnbnd7723hj[.]digital/api/ping\nhttps://sdcdsujnd555w[.]digital/api/ping\n\nMagnatExtension:\n\nstataready[.]icu\nbolshebolshezolota[.]club\nluckydaddy[.]xyz\nadamantbarbellmethod[.]com\n\nRedline:\n\nuserauto[.]space\n22231jssdszs[.]fun\nhssubnsx[.]xyz\ndshdh377dsj[.]fun\n\nAzorult:\n\nhttp://0-800-email[.]com/index.php\nhttp://430lodsfb[.]club/index.php\nhttp://ifugonnago[.]site/index.php\nhttp://paydoor[.]space/index.php\nhttp://430lodsposlok[.]online/index.php\nhttp://linkonbak[.]site/index.php\nhttp://430lodsposlok[.]site/index.php\nhttp://dontbeburrow[.]space/index.php\nhttp://430lodsposlok[.]monster/index.php\nhttp://430lodsposlok[.]store/index.php\nhttp://luckydaddy[.]club/index.php\nhttp://metropolibit[.]monster/index.php\nhttp://inpriorityfit[.]site/index.php\nhttp://maskofmistery[.]icu/index.php\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-12-02 - Magnat campaigns use malvertising to deliver information stealer, backdoor and malicious Chrome extension.pdf"
    ],
    "report_names": [
        "2021-12-02 - Magnat campaigns use malvertising to deliver information stealer, backdoor and malicious Chrome extension.pdf"
    ],
    "threat_actors": [
        {
            "id": "d90307b6-14a9-4d0b-9156-89e453d6eb13",
            "created_at": "2022-10-25T16:07:23.773944Z",
            "updated_at": "2025-03-27T02:02:09.974695Z",
            "deleted_at": null,
            "main_name": "Lead",
            "aliases": [
                "Casper",
                "TG-3279"
            ],
            "source_name": "ETDA:Lead",
            "tools": [
                "Agentemis",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "RbDoor",
                "RibDoor",
                "Winnti",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "aa73cd6a-868c-4ae4-a5b2-7cb2c5ad1e9d",
            "created_at": "2022-10-25T16:07:24.139848Z",
            "updated_at": "2025-03-27T02:02:10.120505Z",
            "deleted_at": null,
            "main_name": "Safe",
            "aliases": [],
            "source_name": "ETDA:Safe",
            "tools": [
                "DebugView",
                "LZ77",
                "OpenDoc",
                "SafeDisk",
                "TypeConfig",
                "UPXShell",
                "UsbDoc",
                "UsbExe"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "bfded1cf-be73-44f9-a391-0751c9996f9a",
            "created_at": "2022-10-25T15:50:23.337107Z",
            "updated_at": "2025-03-27T02:00:55.445946Z",
            "deleted_at": null,
            "main_name": "FIN7",
            "aliases": [
                "FIN7",
                "GOLD NIAGARA",
                "ITG14",
                "Carbon Spider",
                "ELBRUS",
                "Sangria Tempest"
            ],
            "source_name": "MITRE:FIN7",
            "tools": [
                "Mimikatz",
                "AdFind",
                "JSS Loader",
                "HALFBAKED",
                "REvil",
                "PowerSploit",
                "CrackMapExec",
                "Carbanak",
                "Pillowmint",
                "Cobalt Strike",
                "POWERSOURCE",
                "RDFSNIFFER",
                "SQLRat",
                "Lizar",
                "TEXTMATE",
                "BOOSTWRITE"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "bb8702c5-52ac-4359-8409-998a7cc3eeaf",
            "created_at": "2023-01-06T13:46:38.405479Z",
            "updated_at": "2025-03-27T02:00:02.82533Z",
            "deleted_at": null,
            "main_name": "FIN7",
            "aliases": [
                "JokerStash",
                "ATK32",
                "G0046",
                "Coreid",
                "Carbanak",
                "Sangria Tempest",
                "CARBON SPIDER",
                "GOLD NIAGARA",
                "G0008",
                "ELBRUS",
                "Carbon Spider"
            ],
            "source_name": "MISPGALAXY:FIN7",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "d85adfe3-e1c3-40b0-b8bb-d1bacadc4d82",
            "created_at": "2022-10-25T16:07:23.619566Z",
            "updated_at": "2025-03-27T02:02:09.890982Z",
            "deleted_at": null,
            "main_name": "FIN7",
            "aliases": [
                "APT-C-11",
                "ATK 32",
                "Gold Niagara",
                "ITG14",
                "TAG-CR1"
            ],
            "source_name": "ETDA:FIN7",
            "tools": [
                "7Logger",
                "Agentemis",
                "Anunak",
                "Astra",
                "BIOLOAD",
                "BIRDWATCH",
                "Bateleur",
                "Boostwrite",
                "CROWVIEW",
                "Carbanak",
                "Cobalt Strike",
                "CobaltStrike",
                "DICELOADER",
                "DNSMessenger",
                "FOWLGAZE",
                "HALFBAKED",
                "JSSLoader",
                "KillACK",
                "LOADOUT",
                "Lizar",
                "Meterpreter",
                "Mimikatz",
                "POWERPLANT",
                "POWERSOURCE",
                "RDFSNIFFER",
                "SQLRAT",
                "Sekur",
                "Sekur RAT",
                "TEXTMATE",
                "Tirion",
                "VB Flash",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673536240,
    "ts_updated_at": 1743041321,
    "ts_creation_date": 1653759075,
    "ts_modification_date": 1653759075,
    "files": {
        "pdf": "https://archive.orkl.eu/77d87a25b67c6e776f43e480ec16078b6687161a.pdf",
        "text": "https://archive.orkl.eu/77d87a25b67c6e776f43e480ec16078b6687161a.txt",
        "img": "https://archive.orkl.eu/77d87a25b67c6e776f43e480ec16078b6687161a.jpg"
    }
}