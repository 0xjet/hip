{
    "id": "2df7b758-4c13-45d5-a607-b72fd2a565f9",
    "created_at": "2023-01-12T15:02:20.294169Z",
    "updated_at": "2025-03-27T02:09:18.47436Z",
    "deleted_at": null,
    "sha1_hash": "d5e26bbcbce159d58a1cc6ed173b42cf77bc5a95",
    "title": "2022-04-25 - THREAT ANALYSIS REPORT- SocGholish and Zloader – From Fake Updates and Installers to Owning Your Systems",
    "authors": "",
    "file_creation_date": "2022-05-28T16:05:35Z",
    "file_modification_date": "2022-05-28T16:05:35Z",
    "file_size": 2950218,
    "plain_text": "# THREAT ANALYSIS REPORT: SocGholish and Zloader – From Fake Updates and Installers to Owning Your Systems\n\n**[cybereason.com/blog/threat-analysis-report-socgholish-and-zloader-from-fake-updates-and-installers-to-owning-your-systems](https://www.cybereason.com/blog/threat-analysis-report-socgholish-and-zloader-from-fake-updates-and-installers-to-owning-your-systems)**\n\nWritten By\nCybereason Global SOC Team\n\nApril 25, 2022 | 14 minute read\n\n\n-----\n\nThe [Cybereason Global Security Operations Center (GSOC) Team issues Cybereason Threat Analysis](https://www.cybereason.com/blog/authors/cybereason-global-soc-team)\nreports to inform on impacting threats. The Threat Analysis reports investigate these threats and provide\npractical recommendations for protecting against them.\n\nThis Threat Analysis report provides insight into three selected attacks, which involve the SocGholish\nand Zloader malware masquerading as legitimate software updates and installers of popular\napplications. We present the deployment of the malware on compromised systems and the activities of\nthe malware operators, including an activity timeline.\n\n## Key Points\n\n**Masquerading malware: Infections with SocGholish start by end-users executing JavaScript**\nscripts with filenames that relate to known browsers and browser updates, such as\n_Opera.Update.js and Firefox.js. Infections with Zloader start by end-users executing a fake installer_\nof a popular application, such as TeamViewer.\n**Intensive reconnaissance and data exfiltration: SocGholish operators conduct intensive**\nreconnaissance activities and redirect the output of executed commands to files with the filename\nextension .tmp for exfiltration.\n**Detected and prevented: The** [Cybereason XDR Platform effectively detects and prevents](https://www.cybereason.com/platform#graphic)\ninfections with SocGholish and Zloader.\n**Cybereason Managed Detection and Response (MDR): The Cybereason GSOC team has a**\nzero-tolerance policy towards attacks involving SocGholish and Zloader, and categorizes such\n[attacks as critical, high-severity incidents. The Cybereason GSOC MDR team issues a](https://www.cybereason.com/services/managed-detection-response-mdr)\ncomprehensive report to customers when such an incident occurs. The report provides an in-depth\noverview of the incident, which helps to understand the scope of the compromise and the impact on\nthe customer’s environment. The report also provides attribution information whenever possible, as\nwell as recommendations for threat mitigation and isolation.\n\n## Introduction\n\n[SocGholish is an attack framework that malicious actors have used since at least 2020. The term Soc](https://www.menlosecurity.com/blog/increase-in-attack-socgholish/)\nrefers to the use of social engineering to deploy malware on systems. SocGholish operators host a\nmalicious website that implements a drive-by-download mechanism, such as JavaScript code or uniform\nresource locator (URL) redirections, to trigger the download of an archive file that contains malware.\n\nThe website displays content that might lure end-users, such as critical browser updates. To infect the\nsystem, an end-user has to first manually decompress the archive file and then execute the malware by\ndouble-clicking. An infection with SocGholish may result in the deployment of the Cobalt Strike\nframework and ransomware.\n\nZloader is a malware primarily designed to steal credentials and sensitive data, but it also has backdoor\ncapabilities and it can act as a malware loader to deliver further malware on compromised systems. For\nexample, in the past, Zloader has distributed the destructive Egregor and Ryuk ransomware.\n\n[First discovered in 2016, Zloader is under continuous development with more recent versions featuring](https://www.proofpoint.com/us/blog/threat-insight/zloader-loads-again-new-zloader-variant-returns)\ndetection evasion capabilities, such as disabling Windows Defender and using living-off-the-land\nexecutables to conduct malicious activities. In the past, malicious actors have distributed the Zloader\nmalware as malicious attachments to emails.\n\n\n-----\n\nIn the period between December 2021 and the time of writing, the Cybereason MDR team has observed\nan increase in the number of attacks involving SocGholish and Zloader. In the attacks involving Zloader,\nmalicious actors had distributed Zloader to systems through malicious websites that have the malware\n[masquerading as an installer of popular applications, such as TeamViewer.](https://www.crowdstrike.com/blog/falcon-overwatch-uncovers-ongoing-night-spider-zloader-campaign/)\n\nThe figure below depicts the number of SocGholish-related sample submissions to VirusTotal between\nNovember 2021 and March 2022. The global trend of increase in the number of infections with\nSocGholish starting in December 2021 aligns with the increase in the number of infections with\nSocGholish that the Cybereason MDR has observed:\n\n_Number of SocGholish-related sample submissions to VirusTotal between November 2021 and March_\n_2022_\n\nThis report provides a unique insight into real infections with SocGholish and Zloader that the\nCybereason MDR team has recently observed. We present the deployment of the malware on\ncompromised systems and the activities of the malware operators in three selected attacks. For the\nattacks that involve SocGholish, this report documents the timelines of the malware operator’s activities\nand provides an overview of the common tactics and techniques in SocGholish infections.\n\n## Analysis\n\n### SocGholish\n\n**Infection**\n\nThe flowchart below depicts a typical system infection with the SocGholish framework:\n\n\n-----\n\n_Infection with the SocGholish framework_\n\nSocGholish operators host a malicious website that implements a drive-by-download mechanism.\nPrevious research shows that the SocGholish operators use a legitimate website and host another,\nmalicious website in its context, for example, in an inline frame (iframe) object. The legitimate website\n[displays content to which end-users may be lured, such as critical browser updates. The malicious](https://isc.sans.edu/forums/diary/Fake+browser+update+pages+are+still+a+thing/25774/)\nwebsite may implement, for example, JavaScript code, or conduct URL redirections to trigger the\ndownload of an archive file that stores a malicious JavaScript script.\n\nTo infect the system, an end-user has to first manually decompress the JavaScript script, for example, by\n[using the Windows built-in archive utility or third-party utilities such as WinRAR, and then execute the](https://www.win-rar.com/start.html?&L=0)\nscript. If the Microsoft Windows Script Host (WSH) mechanism is not disabled on the system, WSH\nexecutes the script using the wscript or the [cscript utility and the WSH JavaScript/JScript execution](https://docs.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2012-r2-and-2012/ff920171(v=ws.11))\nengine:\n\n_An end-user_\n\n_decompresses and executes a JavaScript script that SocGholish operators distribute (as seen in the_\n_Cybereason XDR Platform)_\n\nThe figure below depicts a typical JavaScript script (Chrome.Update.d37fc6.js) that a malicious website\nwith a browser update theme has been distributing to end-users:\n\n\n-----\n\n_Content of the_\n\n_Chrome.Update.d37fc6.js script (excerpt)_\n\nWe emphasize that the Chrome.Update.d37fc6.js script is representative of many other scripts that\nmalicious websites with browser update themes have been distributing to end-users:\n\nThe scripts have filenames that relate to known browsers and browser updates, such as\n_Opera.Update.a99283.js and Firefox.js._\nThe scripts establish connections to attacker-controlled endpoints, for example, by using ActiveX\nXMLHTTP objects, and issue POST requests to download and execute further content using the\n_eval JavaScript function. In the SocGholish infections that we have analyzed, the JavaScript scripts_\ndownload and execute content after issuing a POST request to a resource named pixel.png. The\nscripts communicate with the endpoints with the following IP addresses:\n\n_87.249.50[.]201, located in Russia (known associated host domain names: xen.hill-family[.]us,_\n_apps.weightlossihp[.]com, and upstream.fishslayerjigco[.]com)._\n\n\n-----\n\n_91.219.236[.]202, located in Hungary (known associated host domain names:_\n_host.integrativehealthpartners[.]com, platform.windsorbongvape[.]ca,_\n_widget.windsorbongvape[.]com)._\nThe JavaScript code of the scripts is obfuscated by using random variable names and string\nmanipulation, such as string reversal and encoding. For example, the script authors have\nobfuscated the host domain names of the attacker-controlled endpoints by reversing them and\nplacing the individual string characters at the odd index positions in the obfuscated string:\n\n_An obfuscated host domain name in Chrome.Update.d37fc6.js and the domain name’s deobfuscated_\n_form_\n\n**Post Infection: First Attack**\n\nThe flowchart below depicts an overview of the activities that SocGholish operators have conducted on\nan infected system:\n\n_SocGholish: An attack overview (1)_\n\n\n-----\n\nAs we have seen in the Infection Section, the wscript.exe utility first executed a JavaScript script named\n_Chrome.Update.fd1967.js that resided in an archive file. Soon after the script executed and until_\napproximately 57 minutes later, wscript.exe conducted information gathering activities and stored the\ngathered information in the files radF9A4F.tmp and rad994D1.tmp, placed in the end-user’s AppData\nfolder, for potential future exfiltration:\n\n_whoami /all >> \"C:\\Users\\<user>\\AppData\\Local\\Temp\\radF9A4F.tmp_\n\n_\"systeminfo|findstr Registered&nltest /dclist:&nltest /domain_trusts&cmdkey /list&net group \"Domain_\n_Admins\" /domain&net group \"Enterprise Admins\" /domain&net localgroup Administrators /domain&net_\n_localgroup Administrators\" >>\"C:\\Users\\<user>\\AppData\\Local\\Temp\\rad994D1.tmp\"_\n\nApproximately one hour and 27 minutes later, wscript.exe first renamed a file with the .tmp file extension,\n_rad63F7D.tmp, to ef32e4cf.js and then executed the JavaScript script ef32e4cf.js using the wscript.exe_\nutility.\n\nApproximately 9 minutes later, the wscript.exe instance that had executed the ef32e4cf.js script obtained\nuser and filesystem information by executing the following commands:\n\n_whoami /all >> \"C:\\Users\\<user>\\AppData\\Local\\Temp\\rad2AC3D.tmp\"_\n\n_dir C:\\programdata\\ >> \"C:\\Users\\<user>\\AppData\\Local\\Temp\\radB9CD4.tmp\"_\n\n_wscript.exe also renamed a file with the .tmp file extension, radCC48D.tmp, to the Windows dynamic-link_\nlibrary (DLL) file wimgapi.dll and then executed the DLL through the WIMDeleteImageMounts entry point\nby capturing the output in the C:\\Users\\<user>\\AppData\\Local\\Temp\\rad5FAF1.tmp file. wscript.exe also\ncopied the rundll32.exe executable to the wim.exe file in the %ProgramData%\\wim folder:\n\n_wscript.exe executes wimgapi.dll (as seen in the Cybereason XDR Platform)_\n\nDuring the execution of the wscript.exe instances that had executed the Chrome.Update.fd1967.js and\nthe ef32e4cf.js scripts, the wscript.exe instances communicated with the attacker-controlled endpoint\nwith an IP address of 91.219.236[.]202 (domain name:\n\n_0bfd796f.host.integrativehealthpartners[.]com), located in Hungary._\n\nApproximately 12 minutes after the wimgapi.dll DLL was executed, the DLL injected code into the\nfollowing legitimate Windows processes: werfault.exe, explorer.exe, outlook.exe, svchost.exe, and\n_taskhostw.exe._\n\nOver a period of 8 hours and 30 minutes:\n\n\n-----\n\n_[wimgapi.dll injected the SharpView Tool into an instance of the werfault.exe process. SharpView](https://github.com/tevora-threat/SharpView)_\ncan conduct reconnaissance activities and gather information about Active Directory (AD)\ndeployments:\n\n_wimgapi.dll injects the SharpView tool into an instance of the werfault.exe process (as seen in the_\n_Cybereason XDR Platform)_\n\n_wimgapi.dll injected code into outlook.exe. The code gathered AD-related information by executing_\nthe command net group \"domain admins\" /domain:\n\n_The code that_\n\n_outlook.exe hosts conducts reconnaissance activities (as seen in the Cybereason XDR Platform)_\n\n_wimgapi.dll injected malicious code into svchost.exe. The code conducted targeted reconnaissance_\nactivities by executing the whoami, ping, nltest, and net commands using target-specific\nconfigurations, such as hostnames and usernames.\n\n\n-----\n\n_wimgapi.dll injected code into taskhostw.exe. The code searched for the cpassword field in Group_\nPolicy files stored in the Policies folder in shared system volume folders (SYSVOL) by executing\nthe command findstr /s /i /m \"cpassword\" \\\\<domain>\\sysvol\\<domain>\\Policies\\*.*, where\n_<domain> is the domain name of an AD domain controller. In AD infrastructures, the SYSVOL_\nfoldersare present on domain controllers and the domain controllers share the folders with domain\nmembers to deliver domain configuration data, such as policy settings. The cpassword field stores\na valid credential required to configure certain Group Policy preference settings at domain\nmembers - settings that system users can change. In certain Windows versions, the cpassword\nfield stores the password in an Advanced Encryption Standard (AES) encrypted form that malicious\nactors can decrypt using a publicly disclosed encryption key.\n\nIn addition to the activities above, the code that ran in explorer.exe, outlook.exe, svchost.exe, and\n_taskhostw.exe executed instances of the werfault.exe process and injected the following tools into the_\ninstances:\n\n_[SharpView and](https://github.com/tevora-threat/SharpView)_ _[Rubeus, a tool for attacking Kerberos deployments.](https://github.com/GhostPack/Rubeus)_\n_[Stracciatella: a tool for executing PowerShell commands with detection evasion capabilities.](https://github.com/mgeeky/Stracciatella)_\n_[Seatbelt: a tool that enumerates the security posture of systems.](https://github.com/GhostPack/Seatbelt)_\n_[PowerShellRunner: a tool that is capable of executing PowerShell commands using Windows](https://github.com/dievus/PowerShellRunner)_\nDefender evasive techniques.\n_[SharpChromium: a tool for stealing browser data, such as cookies, saved logins, and browsing](https://github.com/djhohnstein/SharpChromium)_\nhistory.\n\nApproximately 7 hours after wimgapi.dll DLL was executed, over a period of approximately 24 minutes,\nthe operators conducted further reconnaissance activities by executing the commands ipconfig and\n_nltest. The operators also searched for the cpassword field in Group Policy files stored in the Policies_\nfolder in SYSVOL folders by executing the command findstr /s /i /m \"cpassword\" \\\\<domain>\\sysvol\\\n_<domain>\\Policies\\*.*, where <domain> is the domain name of an AD domain controller._\n\nIn addition to searching for the cpassword field, the operators copied the files Centrifydc_settings.xml,\n_Groups.xml, and ScheduledTasks.xml from shared SYSVOL folders to the ProgramData folder. These_\nfiles may contain cpassword fields, which store passwords that the malicious actors can decrypt, as well\nas additional settings data that is relevant from an information-gathering perspective.\n\nApproximately 23 hours after wimgapi.dll was executed, the %ProgramData%\\wim\\wim.exe executable,\nthat is, rundll32.exe, executed the wimgapi.dll DLL through the WIMDeleteImageMounts entry point\nagain to conduct further reconnaissance activities by executing the net and ping commands.\n\nDuring their operation, the wimgapi.dll DLL as well as the injected code into svchost.exe and\n_taskhostw.exe transferred over 30 MB of data to an endpoint with the IP address 5.53.125[.]173 (domain_\nname: sikescomposites[.]com), which is located in Russia.\n\n**Post Infection: Second Attack**\n\nThe flowchart below depicts an overview of the activities that SocGholish operators have conducted on\nan infected system:\n\n\n-----\n\n_SocGholish: An attack overview (2)_\n\nAs we have seen in the Infection section, the wscript.exe utility first executed a JavaScript script named\n_Chrome.Update.2022d8.js that resided in an archive file. Soon after the script was executed and until_\napproximately 10 minutes later, wscript.exe gathered current user information and stored the gathered\ninformation in the file radFFBA5.tmp, placed in the user’s AppData folder, for potential future exfiltration:\n\n_whoami /all >> \"C:\\Users\\<user>\\AppData\\Local\\Temp\\radFFBA5.tmp_\n\n_wscript.exe gathers current user information as seen (in the Cybereason XDR Platform)_\n\nApproximately 3 days and 10 minutes after wscript.exe gathered user information, wscript.exe\nenumerated the services that ran on the compromised machine using a PowerShell command that\ninvoked Windows Management Instrumentation (WMI) functionalities and stored the output in the file\n_radD4878.tmp:_\n\n\n-----\n\n_wscript.exe enumerates services (as seen in the Cybereason XDR Platform)_\n\nApproximately 3 days and 1 hour after wscript.exe gathered user information, wscript.exe gathered ADrelated information, including credentials, by executing the following commands: systeminfo|findstr\n_Registered; nltest /dclist:; nltest /domain_trusts; cmdkey /list; net group \"Domain Admins\" /domain; net_\n_group \"Enterprise Admins\" /domain; net localgroup Administrators /domain; and net localgroup_\n_Administrators/:_\n\n_wscript.exe gathers AD-related information (as seen in the Cybereason XDR Platform)_\n\nApproximately 3 days and 2 hours after wscript.exe gathered user information, wscript.exe first renamed\na file with the .tmp file extension, rad0C41E.tmp, to vgauthservice.exe and then executed\n_vgauthservice.exe._\n\nDuring the execution of wscript.exe, wscript.exe communicated with the attacker-controlled endpoint with\nan IP address of 87.249.50[.]201 (domain name: [random hexadecimal value].xen.hill-family[.]us),\nlocated in Russia.\n\n\n-----\n\nApproximately 1 hour after vgauthservice.exe was executed, over a period of approximately 4 hours,\n_vgauthservice.exe created11 werfault.exe processes and injected code into them, such as the_\n[TruffleSnout tool. TruffleSnout is a tool for gathering AD-related information to support offensive](https://github.com/dsnezhkov/TruffleSnout)\noperations:\n\n_vgauthservice.exe creates werfault.exe processes and injects code into them (in the Cybereason XDR_\n_Platform)_\n\nDuring its operation, the vgauthservice.exe process transferred over 9 MB of data to an endpoint with the\nIP address 77.223.98[.]12 over TCP port 443 (domain name: pastorq[.]com), which is located in Russia.\n\n**Summary**\n\nThe table below summarizes the activities that are most prevalent across all infections with SocGholish\nthat the Cybereason MDR team has observed:\n\n\nArchive file and\nJavaScript\nscript\n\nIntensive\nreconnaissance\n\nOutput\nredirection\n\nInjection of\ncode into\n_werfault.exe_\n\nTwo attackercontrolled\nendpoints per\ninfection\n\n\nTo infect the system, an end-user has to download an archive file that stores a\nmalicious JavaScript script. The script has a filename that relates to known browsers\nand browser updates, such as Opera.Update.a99283.js and Firefox.js. The end-user\nthen has to manually decompress and execute the JavaScript script to infect the\nsystem.\n\nSocGholish operators conduct intensive reconnaissance activities and gather ADrelated information by executing the commands whoami, systeminfo, nltest, net, and\n_cmdkey._\n\nThe SocGholish operators redirect the output of executed commands to files with\nthe filename extension .tmp, placed in the end-user’s AppData folder, for potential\nfuture exfiltration, such as C:\\Users\\<user>\\AppData\\Local\\Temp\\radF9A4F.tmp.\n\nInfections with SocGholish involve an injection of code into multiple instances of the\n_werfault.exe process. The injected code typically implements tools with offensive_\ncapabilities.\n\nOver the course of an infection with SocGholish, the infected system communicates\nwith two separate attacker-controlled endpoints, located in Hungary and/or Russia.\n\n\n-----\n\n### Zloader\n\nThe Cybereason MDR team observed malicious actors distributing Zloader to systems through malicious\nwebsites that have masqueraded the malware as an installer of popular applications, such as\nTeamViewer. When an end-user downloads and executes a malicious software installer that delivers\nZloader – an executable in Microsoft Installer (msi) format, for example, TeamViewer.msi – the installer\nwrites a Windows executable file named internal.exe on the hard disk and executes it.\n\n_internal.exe establishes a connection to an attacker-controlled endpoint to download further malware, a_\nscript called launch.bat. launch.bat downloads a Windows Batch (.bat) script from the attacker-controlled\nendpoint clouds222[.]com – flash.bat, which conducts the following activities:\n\n_flash.bat evaluates whether the malware executes with administrative privileges by executing the_\ncommand %SYSTEMROOT%\\system32\\cacls.exe %SYSTEMROOT%\\system32\\config\\system.\n\nIf the malware does not execute with administrative privileges, the malware executes a\nVisualBasic script (.vbs) named getadmin.vbs. The getadmin.vbs script attempts to elevate\nthe malware’s privileges.\n_flash.bat establishes connection to the attacker-controlled endpoint clouds222[.]com to download_\nthree files – apiicontrast.dll (in Windows Portable Executable format), appContast.dll (in Windows\nPortable Executable format), and flashupdate.ps1 (a PowerShell script) – and executes\n_flashupdate.ps1._\n_flash.bat deletes the file that implements the flash.bat script from the filesystem._\n\n_flashupdate.ps1 executes the command wmic.exe_ _computersystem get domain to determine whether it_\nexecutes in an Active Directory (AD) environment.\n\nIf flashupdate.ps1 does not execute in an AD environment, the script downloads a GNU Privacy Guard\n(gpg)-encrypted file that implements Zloader (filename: zoom.dll). Otherwise, the script downloads gpgencrypted files that implement a CobaltStrike module and an Atera remote access component\n[(filenames: zoom1.msi and zoom2.dll). The PowerShell script then downloads the gpg4win tool for](https://www.gpg4win.org/)\ndecryption purposes and runs a Windows Batch script named ais.bat.\n\n_[ais.bat downloads the NSudo tool (executable: adminpriv.exe) from the attacker-controlled endpoint](https://github.com/M2Team/NSudo)_\n_commandaadmin[.]com and uses the tool to conduct a variety of activities with administrative privileges,_\nsuch as disabling the Windows Defender security solution.\n\n_ais.bat also executes the apiicontrast.dll and appContast.dll files. Note that apiicontrast.dll and_\n_[appContast.dll are digitally signed by Microsoft and are therefore masquerading as legitimate files – the](https://research.checkpoint.com/2022/can-you-trust-a-files-digital-signature-new-zloader-campaign-exploits-microsofts-signature-verification-putting-users-at-risk/)_\n[vulnerability CVE-2013-3900 allows for malicious actors to append malicious script content to the digital](https://msrc.microsoft.com/update-guide/vulnerability/CVE-2013-3900)\nsignature section of legitimate Windows Portable Executable files without invalidating the digital\nsignature.\n\n_apiicontrast.dll and appContast.dll store malicious scripts that execute when the mshta.exe Windows_\nutility executes apiicontrast.dll and appContast.dll as follows:\n\n_cmd /c C:\\Windows\\System32\\mshta.exe C:\\Users\\<user>\\AppData\\Roaming\\appContast.dll_\n\n_cmd /c C:\\Windows\\System32\\mshta.exe C:\\Users\\<user>AppData\\Roaming\\apiicontrast.dll_\n\n\n-----\n\nThe malicious script in appContast.dll modifies Windows Defender settings, such as excluding processes\nfrom Windows Defender scans. The table below lists the commands that the malicious script in\n_appContast.dll executes:_\n\n_powershell.exe -Command Add-MpPreference -ExclusionExtension '.exe'_\n\n_powershell.exe -Command Add-MpPreference -ExclusionProcess '*.dll'_\n\n_powershell.exe -Command Add-MpPreference -ExclusionProcess '*.exe'_\n\n_powershell.exe -Command Add-MpPreference -ExclusionProcess '.dll'_\n\n_powershell.exe -Command Add-MpPreference -ExclusionProcess '.exe'_\n\n_powershell.exe -Command Add-MpPreference -ExclusionProcess 'explorer.exe'_\n\n_powershell.exe -Command Set-MpPreference -DisableBehaviorMonitoring $true_\n\n_powershell.exe -Command Set-MpPreference -Disable IOAVProtection $true_\n\n_powershell.exe -Command Set-MpPreference -DisableIntrusionPreventionSystem $true_\n\n_powershell.exe -Command Set-MpPreference -DisablePrivacyMode $true_\n\n_powershell.exe -Command Set-MpPreference -DisableRealTimeMonitoring $true_\n\n_powershell.exe -Command Set-MpPreference -DisableScriptScanning $true_\n\n_powershell.exe -Command Set-MpPreference -EnableControlledFolderAccess Disabled_\n\n_powershell.exe -Command Set-MpPreference -HighThreatDefaultAction 6 -Force_\n\n_powershell.exe -Command Set-MpPreference -LowThreatDefaultAction 6_\n\n_powershell.exe -Command Set-MpPreference -MAPSReporting 0_\n\n_powershell.exe -Command Set-MpPreference -ModerateThreatDefaultAction 6_\n\n_powershell.exe -Command Set-MpPreference -PUAProtection disable_\n\n_powershell.exe -Command Set-MpPreference -ScanScheduleDay 8_\n\n\n-----\n\n_powershell.exe -Command Set-MpPreference -SevereThreatDefaultAction 6_\n\n_powershell.exe -Command Set-MpPreference -SignatureDisableUpdateOnStartupWithoutEngine $true_\n\n_powershell.exe -Command Set-MpPreference -SubmitSamplesConsent 2_\n\n_powershell.exe -inputformat none -outputformat none -NonInteractive -Command Add-MpPreference -_\n_ExclusionPath 'C:\\Users\\<user>'_\n\n_powershell.exe -inputformat none -outputformat none -NonInteractive -Command Add-MpPreference -_\n_ExclusionPath 'C:\\Users\\<user>\\*'_\n\n_powershell.exe -inputformat none -outputformat none -NonInteractive -Command Add-MpPreference -_\n_ExclusionPath 'C:\\Users\\<user>\\AppData\\Roaming'_\n\n_powershell.exe -inputformat none -outputformat none -NonInteractive -Command Add-MpPreference -_\n_ExclusionPath 'C:\\Users\\<user>\\AppData\\Roaming*'_\n\n_powershell.exe -inputformat none -outputformat none -NonInteractive -Command Add-MpPreference -_\n_ExclusionPath 'C:\\Users\\<user>\\AppData\\Roaming\\*'_\n\n_powershell.exe -inputformat none -outputformat none -NonInteractive -Command Add-MpPreference -_\n_ExclusionPath 'C:\\Windows\\System32\\WindowsPowerShell\\'_\n\n_powershell.exe -inputformat none -outputformat none -NonInteractive -Command Add-MpPreference -_\n_ExclusionPath 'C:\\Windows\\System32\\WindowsPowerShell\\*'_\n\n_Commands that modify Windows Defender settings_\n\nAfter a sleeping phase, the malicious script in apiicontrast.dll decrypts the gpg-encrypted files\n_zoom1.msi, zoom.dll, and/or zoom2.dll (i.e., a Cobalt Strike module, an Atera remote access_\ncomponent, and the Zloader malware) using gpg4win, and executes the executables:\n\n\n-----\n\n_The malicious script in apiicontrast.dll decrypts and executes zoom1.msi, zoom.dll, and zoom2.dll (as_\n_seen in the Cybereason XDR Platform)_\n\n## Detection and Prevention\n\n### Cybereason XDR Platform\n\nThe [Cybereason XDR Platform is able to detect and prevent infections with SocGholish and Zloader](https://www.cybereason.com/platform)\nusing multi-layer protection that detects and blocks malware with threat intelligence, machine learning,\nand Next-Gen Antivirus (NGAV) capabilities:\n\n\n-----\n\n_The_\n\n_Cybereason XDR Platform labels as suspicious the execution of a malicious SocGholish JavaScript_\n_script using the wscript utility_\n\n_The_\n\n_Cybereason XDR Platform detects SocGholish injecting code into werfault.exe instances_\n\n\n-----\n\n_The_\n\n_Cybereason XDR Platform detects the deployment of the Zloader malware_\n\n## Cybereason GSOC MDR\n\nThe Cybereason GSOC recommends the following:\n\nEnable the Anti-Malware feature on the Cybereason NGAV and enable the Detect and\nPrevent modes of this feature.\nSecurely handle files downloaded from the Internet and email messages that originate from\nexternal sources.\nThreat Hunting with Cybereason: The Cybereason MDR team provides its customers with custom\nhunting queries for detecting specific threats - to find out more about threat hunting and Managed\nDetection and Response with the Cybereason Defense Platform, contact a Cybereason Defender\nhere.\n\n[For Cybereason customers: More details available on the NEST including custom threat](https://nest.cybereason.com/knowledgebase/5782001)\nhunting queries for detecting this threat.\n\nCybereason is dedicated to teaming with defenders to end cyber attacks from endpoints to the enterprise\nto everywhere. [Schedule a demo today to learn how your organization can benefit from an operation-](https://www.cybereason.com/request-a-demo)\ncentric approach to security.\n\n## Indicators of Compromise\n\n\n-----\n\n**Executables** SHA-1 hash:\n\n_3918a9ebe88ba272718a14c02eae148eaafbe51b_\n\nSHA-1 hash:\n\n_db6e1a1dbb0e351c44b49db79b8bad3321d673a1_\n\nSHA-1 hash:\n\n_57d0c737686cf01bd6aa0ef206d3f81aee93cbbd_\n\nSHA-1 hash:\n\n_0cdaee46f8d898c253ba3427256d430de3ff7791_\n\nSHA-1 hash:\n\n_3e481043bc981eae8f0b977477024abb6e1e132e_\n\nSHA-1 hash:\n\n_a187d9c0b4bdb4d0b5c1d2bdbcb65090dcee5d8c_\n\nSHA-1 hash:\n\n_41e99216782434354a16015c33dcd6550bff0a35_\n\nSHA-1 hash:\n\n_7150a4c32f401a7d924083094c3c3796a392556f_\n\n**Domains** _.xen.hill-family[.]us_\n\n_apps.weightlossihp[.]com_\n\n_upstream.fishslayerjigco[.]com_\n\n_.host.integrativehealthpartners[.]com_\n\n_platform.windsorbongvape[.]ca_\n\n_widget.windsorbongvape[.]com_\n\n_sikescomposites[.]com_\n\n_pastorq[.]com_\n\n_clouds222[.]com_\n\n_commandaadmin[.]com_\n\n\n-----\n\n**IP addresses** _87.249.50[.]201_\n\n_91.219.236[.]202_\n\n_77.223.98[.]12_\n\n_5.53.125[.]173_\n\n_178.21.11[.]77_\n\n_193.124.18[.]128_\n\n## MITRE ATT&CK Techniques\n\n**Initial Access** **Execution** **Defense**\n**Evasion**\n\n\n**Discovery** **Collection** **Exfiltration**\n\n\nRemote\n[System](https://attack.mitre.org/techniques/T1018/)\nDiscovery\n\nSystem\n[Owner/User](https://attack.mitre.org/techniques/T1033/)\nDiscovery\n\nProcess\nDiscovery\n\nSystem\n[Information](https://attack.mitre.org/techniques/T1082/)\nDiscovery\n\nAccount\nDiscovery\n\n\nDrive-by\nCompromise\n\nPhishing:\n[Spearphishing](https://attack.mitre.org/techniques/T1566/002/)\nLink\n\n\nUser\n[Execution:](https://attack.mitre.org/techniques/T1204/001/)\nMalicious Link\n\nUser\n[Execution:](https://attack.mitre.org/techniques/T1204/002/)\nMalicious File\n\nCommand and\nScripting\nInterpreter:\nPowerShell\n\nCommand and\nScripting\nInterpreter:\nWindows\nCommand\nShell\n\nCommand and\nScripting\nInterpreter:\nJavaScript\n\n\nMasquerading:\nMasquerade\nTask or\nService\n\nMasquerading:\nMatch\n[Legitimate](https://attack.mitre.org/techniques/T1036/005/)\nName or\nLocation\n\nProcess\nInjection\n\nSigned Binary\nProxy\nExecution:\nRundll32\n\nReflective\nCode Loading\n\n\n**Credential**\n**Access**\n\nCredentials\nfrom\nPassword\n[Stores:](https://attack.mitre.org/techniques/T1555/003/)\nCredentials\nfrom Web\nBrowsers\n\nSteal or\nForge\nKerberos\nTickets\n\nSteal Web\n[Session](https://attack.mitre.org/techniques/T1539/)\nCookie\n\nUnsecured\nCredentials:\nCredentials\nIn Files\n\n\nData from\n[Local](https://attack.mitre.org/techniques/T1005/)\nSystem\n\n\nExfiltration\nOver\nAlternative\nProtocol\n\n\n-----\n\nWindows\n[Management](https://attack.mitre.org/techniques/T1047/)\nInstrumentation\n\n## About the Researchers\n\n\nDomain\n[Trust](https://attack.mitre.org/techniques/T1482/)\nDiscovery\n\nGroup\n[Policy](https://attack.mitre.org/techniques/T1615/)\nDiscovery\n\n\n**Aleksandar Milenkoski, Senior Malware and Threat Analyst, Cybereason**\n\n**Global SOC**\n\nAleksandar Milenkoski is a Senior Malware and Threat Analyst with the Cybereason Global SOC team.\nHe is involved primarily in reverse engineering and threat research activities. Aleksandar has a PhD in\nsystem security. For his research activities, he has been awarded by SPEC (Standard Performance\nEvaluation Corporation), the Bavarian Foundation for Science, and the University of Würzburg, Germany.\nPrior to Cybereason, his work focussed on research in intrusion detection and reverse engineering\nsecurity mechanisms of the Windows operating system.\n\n**Loïc Castel, Senior Security Analyst, Cybereason Global SOC**\n\nLoïc Castel is a Senior Security Analyst with the Cybereason Global SOC team. Loïc analyses and\nresearches critical incidents and cybercriminals, in order to better detect compromises. In his career, Loïc\nworked as a security auditor in well-known organizations such as ANSSI (French National Agency for the\nSecurity of Information Systems) and as Lead Digital Forensics & Incident Response at Atos. Loïc loves\ndigital forensics and incident response, but is also interested in offensive aspects such as vulnerability\nresearch.\n\n\n-----\n\n**Yonatan Gidnian, Senior Security Analyst and Threat Hunter, Cybereason**\n\n**Global SOC**\n\nYonatan Gidnian is a Senior Security Analyst and Threat Hunter with the Cybereason Global SOC team.\nYonatan analyses critical incidents and hunts for novel threats in order to build new detections. He began\nhis career in the Israeli Air Force where he was responsible for protecting and maintaining critical\ninfrastructures. Yonatan is passionate about malware analysis, digital forensics, and incident response.\n\nAbout the Author\n\n**Cybereason Global SOC Team**\n\nThe Cybereason Global SOC Team delivers 24/7 Managed Detection and Response services to\ncustomers on every continent. Led by cybersecurity experts with experience working for government, the\nmilitary and multiple industry verticals, the Cybereason Global SOC Team continuously hunts for the\nmost sophisticated and pervasive threats to support our mission to end cyberattacks on the endpoint,\nacross the enterprise, and everywhere the battle moves.\n\n\n-----\n\n[All Posts by Cybereason Global SOC Team](https://www.cybereason.com/blog/authors/cybereason-global-soc-team)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-04-25 - THREAT ANALYSIS REPORT- SocGholish and Zloader – From Fake Updates and Installers to Owning Your Systems.pdf"
    ],
    "report_names": [
        "2022-04-25 - THREAT ANALYSIS REPORT- SocGholish and Zloader – From Fake Updates and Installers to Owning Your Systems.pdf"
    ],
    "threat_actors": [
        {
            "id": "610a7295-3139-4f34-8cec-b3da40add480",
            "created_at": "2023-01-06T13:46:38.608142Z",
            "updated_at": "2025-03-27T02:00:02.87217Z",
            "deleted_at": null,
            "main_name": "Cobalt",
            "aliases": [
                "Cobalt Gang",
                "GOLD KINGSWOOD",
                "COBALT SPIDER",
                "G0080",
                "Mule Libra",
                "Cobalt Group"
            ],
            "source_name": "MISPGALAXY:Cobalt",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "9f101d9c-05ea-48b9-b6f1-168cd6d06d12",
            "created_at": "2023-01-06T13:46:39.396409Z",
            "updated_at": "2025-03-27T02:00:03.074969Z",
            "deleted_at": null,
            "main_name": "Earth Lusca",
            "aliases": [
                "CHROMIUM",
                "ControlX",
                "Red Dev 10",
                "RedHotel",
                "Red Scylla",
                "TAG-22",
                "BRONZE UNIVERSITY",
                "AQUATIC PANDA",
                "Charcoal Typhoon",
                "BountyGlad"
            ],
            "source_name": "MISPGALAXY:Earth Lusca",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673535740,
    "ts_updated_at": 1743041358,
    "ts_creation_date": 1653753935,
    "ts_modification_date": 1653753935,
    "files": {
        "pdf": "https://archive.orkl.eu/d5e26bbcbce159d58a1cc6ed173b42cf77bc5a95.pdf",
        "text": "https://archive.orkl.eu/d5e26bbcbce159d58a1cc6ed173b42cf77bc5a95.txt",
        "img": "https://archive.orkl.eu/d5e26bbcbce159d58a1cc6ed173b42cf77bc5a95.jpg"
    }
}