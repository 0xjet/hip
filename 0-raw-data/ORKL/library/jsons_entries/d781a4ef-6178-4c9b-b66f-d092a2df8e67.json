{
    "id": "d781a4ef-6178-4c9b-b66f-d092a2df8e67",
    "created_at": "2022-10-25T16:48:12.536872Z",
    "updated_at": "2025-03-27T02:09:30.296177Z",
    "deleted_at": null,
    "sha1_hash": "d491a0602abb0061170b4170a0b74a3b71062a74",
    "title": "",
    "authors": "",
    "file_creation_date": "2016-05-10T20:10:04Z",
    "file_modification_date": "2016-05-10T20:10:07Z",
    "file_size": 982184,
    "plain_text": "# Backdoor as a Software Suite: How TinyLoader Distributes and Upgrades PoS Threats\n\n#### TrendLabs Security Intelligence Blog\n\n Jay Yaneza and Erika Mendoza Trend Micro Cyber Safety Solutions Team\n May 2016\n\n\n-----\n\n## Contents\n\n### Introduction ............................................................................................................1\n\n TinyLoader—the not-so-missing link? ...................................................................1\n\n Method of operations: testing first before mass deployment .................................2\n\n Ties that bind: the TinyPOS-AbaddonPOS connection .........................................6\n\n Widespread distribution ...................................................................................... 10\n\n Challenges and Recommendations ................................................................... 11\n\n Appendix ............................................................................................................ 13\n\nTREND MICRO LEGAL DISCLAIMER\n\nThe information provided herein is for general information and educational purposes only. It is not intended and should not be construed to constitute legal advice.\nThe information contained herein may not be applicable to all situations and may not reflect the most current situation. Nothing contained herein should be relied\non or acted upon without the benefit of legal advice based on the particular facts and circumstances presented and nothing herein should be construed otherwise.\nTrend Micro reserves the right to modify the contents of this document at any time without prior notice.\n\nTranslations of any material into other languages are intended solely as a convenience. Translation accuracy is not guaranteed nor implied. If any questions arise\nrelated to the accuracy of a translation, please refer to the original language official version of the document. Any discrepancies or differences created in the\ntranslation are not binding and have no legal effect for compliance or enforcement purposes.\n\nAlthough Trend Micro uses reasonable efforts to include accurate and up-to-date information herein, Trend Micro makes no warranties or representations of any\nkind as to its accuracy, currency, or completeness. You agree that access to and use of and reliance on this document and the content thereof is at your own risk.\nTrend Micro disclaims all warranties of any kind, express or implied. Neither Trend Micro nor any party involved in creating, producing, or delivering this document\nshall be liable for any consequence, loss, or damage, including direct, indirect, special, consequential, loss of business profits, or special damages, whatsoever\narising out of access to, use of, or inability to use, or in connection with the use of this document, or any errors or omissions in the content thereof. Use of this\ninformation constitutes acceptance for use in an “as is” condition.\n\n\n-----\n\n## Introduction\n\nThe tandem of TinyLoader backdoor and a point-of-sale (PoS) threat, AbaddonPOS was first\nreportedly seen in November 2015. When we noticed a sudden spike in AbaddonPOS\ndetections just this January, TinyPOS, another PoS malware strain, has also reared its ugly\nhead that time. This prompted us to probe further on these threats and check if they are in any\nway related to one another.\n\nOur analysis reveals that TinyLoader, a backdoor used for secondary malware infection, is\ndistributing and managing the upgrades of AbaddonPOS. Likewise, TinyLoader is also\nspreading TinyPOS variants. This leads us to conclude that the operators behind TinyPOS and\nAbaddonPOS are one and the same.\n\nIn this technical brief, we’ll discuss the ties that bind TinyLoader with two notorious PoS\nthreats—AbaddonPOS and TinyPOS, including how the perpetrators behind this operation\ndeployed their arsenals.\n\n## TinyLoader—The Not-So-Missing Link?\n\nIt’s always good to examine the entry points of PoS malware in their target environment to\nunderstand these threats better. Initial information on AbaddonPOS details its links to\nTinyLoader backdoor, which Trend Micro detects as BKDR_TINY, BKDR64_TINY or\nTROJ_TINY.\n\nTinyLoader can run any shellcode on the system and its primary function is to introduce\nsecondary infections on the environment. That being said, seeing TinyLoader in an environment\nis not the leading or sole indicator of PoS threats as it can be directed to do other malicious\nactivities. For the purpose of this write-up, we checked any indicator connecting AbaddonPOS\nand TinyPOS.\n\nBased on our Smart Protection Network data, there are more TinyLoader-related infections in\nAsia-Pacific and North America from the period of January-April 2016. Our data also indicate\nthat 64% of our detections on TinyLoader infections are mostly Windows 7 (64 Bit) platforms.\n\n1\n\n\n-----\n\n_Figure 1. Global distribution of TinyLoader-related infections (January-April 2016)_\n\n## Method of Operations: Testing First Before Mass Deployment\n\nAs seen in the geographical map above, there’s a widespread presence of TinyLoader-related\ninfections across the globe. With this established footprint, TinyLoader can selectively introduce\nsecondary infections based on what’s interesting in the environment it is running on. This\nbusiness model is true to any malware as a service.\n\nTinyLoader used two very small components: a module that can take a screenshot (grabber),\nand a module that functions as a process enumerator. Both modules are very small in size and\nsimply loaded into memory. But these modules do not necessarily have any malicious payload.\nThey are just used to gather information or reconnaissance on infected systems. During our\nresearch, we identified that screenshot grabber were deployed several times a day for over an\nextended period for collecting data on the system.\n\n2\n\n\n-----\n\n_Figure 2. TinyLoader uses two small components for reconnaissance_\n\nAfter TinyLoader identifies an infected system, the operator then may choose to deploy a\nsecondary payload. In this particular case, it was AbaddonPOS first, followed by TinyPOS. We\nhave identified two periods where AbaddonPOS variants were massively distributed:\n\n3\n\n\n-----\n\n_Figure 3. North America is heavily affected by the first wave of AbaddonPOS attacks, around_\n_January 29-30, 2016_\n\n\n4\n\n\n-----\n\n_Figure 3. The second wave of AbaddonPOS attacks mostly hit countries in Europe, around_\n_March 31 – April 1, 2016_\n\nSince most of the infected environment run on Windows 7 operating system (OS), AbaddonPOS\nis stored in %PROGRAMDATA%. In its initial wave, it used the file name, scheduler.exe and the\nmutex, MR_D, resembling some of the documented behaviors of this PoS malware in 2015.\nAfter this initial mass-deployment, there were small incremental file variations being introduced\nthroughout February 2016.\n\nAround March of this year, we started seeing similar detections on %PROGRAMDATA%\nstemming from TinyLoader. However, it used a different file name—conhost.exe. Our analysis\nshows that this is still AbaddonPOS with very slight modifications. It uses now the mutex,\n_MR_X. This modified version of AbaddonPOS was mass-deployed at the start of April 2016._\n\nWe also noticed a binary (Sha1: 7fd44fdcc12988cb1f0811f79ec8f41bec65800f) referencing the\nfile names, scheduler.exe and conhost.exe. The said binary was downloaded on the same site\nhosting AbaddonPOS. This binary, which we dubbed as updater component, was distributed\n\n5\n\n\n-----\n\naround February 29, 2016, a month after the initial wave. The file’s logic was quite simple:\n\n_Figure 4. The update component enumerates running processes and checks for familiar file_\n_names in All User's application data folder. It then terminates these if found._\n\nAside from %ProgramData%\\scheduler.exe, the updater component looks for another file,\n_conhost.exe in the same directory, which seemed unusual. However, this made sense when_\nAbaddonPOS was deployed with the file name, %PROGRAMDATA% \\conhost.exe last March\n2016. TinyLoader was preparing to upgrade the existing installations of the said PoS malware.\nWe saw that TinyLoader not only distributed AbaddonPOS but also managed the upgrades of\nthis PoS threat.\n\n\n6\n\n\n-----\n\n## Ties that Bind: The TinyPOS-AbaddonPOS Connection\n\nWhen a new PoS malware strain, TinyPOS emerged in threat landscape, we checked its\nconnection to AbaddonPOS. Since TinyPOS is hosted on the same server as AbaddonPOS\n(see diagram below), it prompted us to dig deeper into these threats. We were able to identify\nthat TinyLoader was distributing both PoS threats.\n\n_Figure 5. Mapping of file sources and C&C servers_\n\nIn addition, we also saw the updater component that cleans up process names used by\nAbaddonPOS (scheduler.exe and conhost.exe) and TinyPOS (wmi_service.exe).\n\n\n7\n\n\n-----\n\n_Figure 6. New updater component logic_\n\nLast April 2016, TinyPOS started sporting tactics commonly associated with PoS RAM scraper.\nPoS RAM scrapers usually look for process names either for exclusion (similar to what\nAbaddonPOS did) or for targeting. Targeting is a selective method of seeking out a known\nprocess.\n\n8\n\n\n-----\n\nIn this modification or improvement (sha1: 5b65d0a2df243412f95965f5e2cd1a17676960b1),\nTinyPOS used a particular binary in memory: resdbs.exe. This binary otherwise known as\nMICROS ® Database Service is part of several MICROS® software solutions. Various\nindustries like retail typically use these software solutions.\n\nTinyPOS scans all other processes not included in the whitelist. It also creates a separate\nthread that only monitors the Micros service. With this dedicated thread, this malware increases\nits chances of capturing credit card information from the resdbs.exe process memory.\n\n_Figure 7. TinyPOS creates a separate thread dedicated to resdbs.exe monitoring._\n\nIt is also worth noting that AbaddonPOS also has a separate thread for monitoring specific\nprocesses. However, our samples show that its list is blank. The only difference between\nTinyPOS and AbaddonPOS in this particular context is the coding approach. It seems that\nTinyPOS is a simplified version of AbbadonPOS.\n\n9\n\n\n-----\n\n_Figure 8. AbaddonPOS coding approach_\n\n[Targeting PoS software components are very common. MalumPOS and RawPOS are some](http://blog.trendmicro.com/trendlabs-security-intelligence/trend-micro-discovers-malumpos-targets-hotels-and-other-us-industries/)\nexamples of PoS threats that employed the same technique. Both TinyPOS and AbaddonPOS\nmodified the process list to match the target environment’s point-of-sale software, similar to\nwhat RawPOS did.\n\nWe looked at how newer versions of AbaddonPOS were distributed and found that the initial\nversions of TinyPOS were distributed the same way. AbaddonPOS were tested first via\nselective deployment and only when these deployments were proven successful will they only\ngo for wide distribution. We have yet to see a mass deployment of TinyPOS but we’re already\nseeing infections within the United States and some parts of Europe.\n\n10\n\n\n-----\n\n## Widespread Distribution\n\nThrough our research, we established that AbaddonPOS and TinyPOS are one and the same\nPoS family. They cast a wide net to hit as many environments as possible and to prepare that\nenvironment for secondary infections. This tactic is reminiscent of another PoS threat,\n[GamaPOS.](http://blog.trendmicro.com/trendlabs-security-intelligence/new-gamapos-threat-spreads-in-the-us-via-andromeda-botnet/)\n\nThe combined infections of AbaddonPOS and TinyPOS have struck various industries:\n\n  - Technology\n\n  - Healthcare\n\n  - Transportation\n\n  - Education\n\n  - Manufacturing\n\n  - Fast-Moving Consumer Goods (FMCG)\n\n  - Government\n\nThis list of affected industries seems extensive but not surprising, particularly in the United\n[States. According to a survey released by the Strawhecker Group (TSG), only 37% of US](http://www.businesswire.com/news/home/20160217005243/en/EMV-Merchant-Adoption-Slower-Expected)\nmerchant locations are EMV-ready after the October 1, 2015 liability shift. The same survey also\nrevealed that the implementation has been slower than expected. The estimated adoption rate\nshould be at least 90% by 2017.\n\nAs merchants tried to catch up to EMV implementation, attackers are already showing a keen\ninterest at other verticals to hit before higher adoption takes place. They (attackers) are using\ntheir malicious tools to infect as many PoS systems as possible before point-to-point encryption\nwill be fully adopted.\n\nWhen the card data is not encrypted in the reader, this makes a terminal even with Chip-andPin susceptible to PoS RAM scraper malware. A non-EMV enabled terminal also allows anyone\nwho has duplicated card data (card-in-hand) to walk in an establishment and use that duplicated\ncard. He/she can also place an online transaction where details such as the three-digit security\ncode and billing address are not verified.\n\n11\n\n\n-----\n\n## Challenges and Recommendations\n\nOn their own, a backdoor and a point-of-sale (PoS) malware can pose great threats to\nenterprises and small and medium-sized businesses (SMBs). As a tandem, these two can lead\nto stealthier and more flexible attacks.\n\nThe use of TinyLoader with a PoS threat is quite effective. Its multicomponent architecture\nallows several small modules to be built depending on the need. This makes attacks less\nnoticeable, thus avoiding detection. The small modules also enable the secondary infection to\nbe successful.\n\nThe command-and-control (C&C) server of TinyLoader needs not to be a server where it gets\nthe components. It can be directed to connect to another site for downloading the component.\nThe downloaded component (secondary malware) can then report to its own C&C server.\n\nAs detailed above, TinyLoader was used like a software management suite to manage the\ndeployment and upgrade of both AbaddonPOS/TinyPOS. Analyzing these samples individually\nwould not lead to any conclusion. Acquiring only the TinyLoader executable absolutely made\nno sense because one has to observe how other components are being used.\n\nThis presents challenges in both static and dynamic analysis. In static analysis of TinyLoader,\nonly a TCP socket connection to a pre-defined IP address and port is visible. In dynamic\nanalysis (where most sandboxes can only run the sample for a few minutes), a similar raw\nsocket connection is also seen. This means that only through actual infection can one observe\nthe complete infection chain—from launching tools and gathering information on the system to\nsecondary infection.\n\nThe businesses affected by this combined backdoor and point-of-sale threat were spread out\nbetween single seat infections and SMBs. TinyLoader used a high numbered port to\ncommunicate back to its own C&C server while being able to introduce additional files in the\nenvironment via HTTP requests. This spells the importance of looking into outbound requests\n(or traffic leaving the environment) aside from the common practice of restricting inbound and\noutbound requests to certain known services.\n\nTrend Micro protects customers from all threats related to TinyLoader. To protect enterprises\nfrom malware with PoS RAM-scraping capabilities, it is best to employ [endpoint application](http://www.trendmicro.com/us/enterprise/product-security/endpoint-application-control/)\n[control that reduces attack exposure by ensuring only updates associated with whitelisted](http://www.trendmicro.com/us/enterprise/product-security/endpoint-application-control/)\n[applications can be installed. Endpoint solutions such as Trend Micro™ Security, Trend](http://www.trendmicro.com/us/home/products/software/index.html)\n[Micro™ Smart Protection Suites, and Trend Micro Worry-Free™ Business Security can protect](http://www.trendmicro.com.ph/ph/business/complete-user-protection/index.html)\nusers systems from AbaddonPOS, TinyPOS, and TinyLoader backdoor by detecting these\nmalicious files. While Trend Micro detects all indicators that were discussed here, we still are\nmonitoring the progression of this threat.\n\n12\n\n\n-----\n\n## Appendix: Example Indicators of Compromise\n\n**SHA1** **Threat**\n5b65d0a2df243412f95965f5e2cd1a17676960b1 TinyPOS\n30D265E5471011AE8DCC196D3BB16DB6F1F1CF21 AbaddonPOS\n1B64812ACA45F531AF3382677F4AFE6C1B32F2E8 TinyLoader\n387d16fe19c36b30fa7752c86a825be93a8adb5e TinyLoader screen grabber\n3b9dd85a476bee26abed3366ce5e9763b4de84e4 Tiny Loader process\nenumerator\n7fd44fdcc12988cb1f0811f79ec8f41bec65800f TinyLoader Update module for\nTinyPOS/AbaddonPOS\n\n|SHA1|Threat|\n|---|---|\n|5b65d0a2df243412f95965f5e2cd1a17676960b1|TinyPOS|\n|30D265E5471011AE8DCC196D3BB16DB6F1F1CF21|AbaddonPOS|\n|1B64812ACA45F531AF3382677F4AFE6C1B32F2E8|TinyLoader|\n|387d16fe19c36b30fa7752c86a825be93a8adb5e|TinyLoader screen grabber|\n|3b9dd85a476bee26abed3366ce5e9763b4de84e4|Tiny Loader process enumerator|\n|7fd44fdcc12988cb1f0811f79ec8f41bec65800f|TinyLoader Update module for TinyPOS/AbaddonPOS|\n\n\n13\n\n\n-----\n\nTrend Micro Incorporated, a global leader in security software, strives to make the\nworld safe for exchanging digital information. Our innovative solutions for consumers,\nbusinesses and governments provide layered content security to protect information\non mobile devices, endpoints, gateways, servers and the cloud. All of our solutions\nare powered by cloud-based global threat intelligence, the Trend Micro™ Smart\nProtection Network™, and are supported by over 1,200 threat experts around the\nglobe. For more information, visit www.trendmicro.com.\n\n©2016 by Trend Micro, Incorporated. All rights reserved. Trend Micro and the Trend\nMicro t-ball logo are trademarks or registered trademarks of Trend Micro,\nIncorporated. All other product or company names may be trademarks or registered\ntrademarks of their owners.\n\n\n10101 N. De Anza Blvd.\nCupertino, CA 95014\n\nU.S. toll free: 1 +800.228.5651\nPhone: 1 +408.257.1500\nFax: 1 +408.257.2003\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        }
    ],
    "references": [
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2016/2016.05.10.tinyPOS_tinyloader/tinypos-abaddonpos-ties-to-tinyloader.pdf"
    ],
    "report_names": [
        "tinypos-abaddonpos-ties-to-tinyloader"
    ],
    "threat_actors": [
        {
            "id": "d90307b6-14a9-4d0b-9156-89e453d6eb13",
            "created_at": "2022-10-25T16:07:23.773944Z",
            "updated_at": "2025-03-27T02:02:09.974695Z",
            "deleted_at": null,
            "main_name": "Lead",
            "aliases": [
                "Casper",
                "TG-3279"
            ],
            "source_name": "ETDA:Lead",
            "tools": [
                "Agentemis",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "RbDoor",
                "RibDoor",
                "Winnti",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "aa73cd6a-868c-4ae4-a5b2-7cb2c5ad1e9d",
            "created_at": "2022-10-25T16:07:24.139848Z",
            "updated_at": "2025-03-27T02:02:10.120505Z",
            "deleted_at": null,
            "main_name": "Safe",
            "aliases": [],
            "source_name": "ETDA:Safe",
            "tools": [
                "DebugView",
                "LZ77",
                "OpenDoc",
                "SafeDisk",
                "TypeConfig",
                "UPXShell",
                "UsbDoc",
                "UsbExe"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1666716492,
    "ts_updated_at": 1743041370,
    "ts_creation_date": 1462911004,
    "ts_modification_date": 1462911007,
    "files": {
        "pdf": "https://archive.orkl.eu/d491a0602abb0061170b4170a0b74a3b71062a74.pdf",
        "text": "https://archive.orkl.eu/d491a0602abb0061170b4170a0b74a3b71062a74.txt",
        "img": "https://archive.orkl.eu/d491a0602abb0061170b4170a0b74a3b71062a74.jpg"
    }
}