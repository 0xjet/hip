{
    "id": "22bc2208-9542-4462-b9f9-1490c6e8a2d6",
    "created_at": "2023-01-12T15:05:11.619173Z",
    "updated_at": "2025-03-27T02:11:01.435403Z",
    "deleted_at": null,
    "sha1_hash": "f3d8c965c69d11a8fbff5076f77fd1511c9fa30e",
    "title": "2020-07-14 - RATicate upgrades “RATs as a Service” attacks with commercial “crypter”",
    "authors": "",
    "file_creation_date": "2022-05-28T17:36:59Z",
    "file_modification_date": "2022-05-28T17:36:59Z",
    "file_size": 2203952,
    "plain_text": "# RATicate upgrades “RATs as a Service” attacks with commercial “crypter”\n\n**news.sophos.com/en-us/2020/07/14/raticate-rats-as-service-with-commercial-crypter/**\n\nJuly 14, 2020\n\nIn May, we reported initial findings on RATicate, a group of actors spreading remote administration tools (RATs) and other information-stealing\nmalware at least since last year. We tracked multiple malicious spam (“malspam”) email campaigns from the group, with attached installers\nthat usually posed as documents related to financial transactions.\n\nIn recent campaigns, the group’s tactics have shifted, as the actors employed a new malware “loader” in order to unpack and install RAT and\n[infostealer payloads in a more stealthy way. As discussed in our original report, the RATicate group had since last November been packing](https://news.sophos.com/en-us/2020/05/14/raticate/)\ntheir RAT and infostealer payloads for deployment via e-mail exclusively with custom NSIS installers. But in February, the group started to\n[switch to a new delivery mechanism. Initially identified (by researchers at CheckPoint) as Guloader, the new Visual Basic 6-based installer was](https://research.checkpoint.com/2020/threat-actors-migrating-to-the-cloud/)\ntied to a publicly-marketed installation builder called CloudEyE.\n\nIt was also during this period that we saw the RATicate actors begin to use the COVID-19 pandemic as a hook to get victims to open the\ninstallers. An email campaign attempting to distribute the Lokibot password-stealing malware used a message attempting to spoof company\nemails on COVID-19 response policy as a lure to get targeted users to open the malicious attachment:\n\nA COVID-19 themed email carrying a RATicate-authored malware installer.\nOn June 10, CloudEyE announced that they had suspended sale of their installer because of “abuse” of their platform, and were refunding\ncustomers for unused portions of their licenses. We contacted the individuals associated with the Italian company behind CloudEyE in an\nattempt to gain further information about the RATicate actors. They confirmed that the malware signatures we provided were associated with\nthree accounts that used their service, with the majority of them associated with a single account. But the CloudEyE developers would provide\nno further data, citing Italian privacy law. CloudEyE has recently returned to service, claiming tighter controls on customer accounts.\n\n\n-----\n\nesp te t e suspe s o o C oud y ope at o s, cate e a s e y act e e g oup as s tc ed bac to t e S S sta e o ts ost\nrecent campaigns, and is continuously making improvements to its infrastructure and distribution methods. We continue to monitor the group to\nensure that its malspam messages remain blocked by Sophos.\n\n### Change in delivery\n\nBetween November 2019 (when we began to track the activity of this group) and March 2020, we identified at least 14 separate RATicate\ncampaigns connected to the same set of command and control (C2) infrastructure. These campaigns, detailed in our previous report,\ndistributed payloads that included AgentTesla, Formbook, Lokibot, Netwire and Betabot.\n\nHowever, starting in February 2020, we began to see the actors shift to a different delivery vehicle for their malware. CloudEyE is a multi-stage\n“loader” with a wrapper written in Visual Basic. It contains a shellcode which is responsible for downloading encrypted payloads and injecting\nthem into a remote process.\n\nBecause the download URL used by the loader was short-lived, it was difficult to recover the payload they were downloading at the moment.\nHowever, we were able to recover downloaded files connected to these installers [from Virus Total submissions] and to decrypt them in order\nto analyze the final payloads.\n\nDespite the new delivery method, we were able to link the campaigns to the RATicate group based on a number of factors. The payloads of the\ncampaigns using both types of installers delivered the same families of remote administration tool (RAT) and information stealing malware, and\nthey shared the same command and control (C&C) infrastructure. For example, these two campaigns used the exact same C&C URL:\n\nNSIS Campaign 14 (2020-03-01): allenservice.ga/~zadmin/lmark/jl2/link.php\nCloudEyE Campaign (2020-03-19): allenservice.ga/~zadmin/lmark/jl2/link.php\n\nAnother detail pointing to the connection to RATicate was the overlap in the companies targeted by the campaigns using both installers. And\n[both the NSIS and CloudEyE campaigns used the same infection chain methodologies (outlined in our first report on RATicate).](https://news.sophos.com/en-us/2020/05/14/raticate/)\n\nWe also that during initial deployment of CloudEyE, there was an overlap with the NSIS campaigns. This led us to believe that the group was\ntesting CloudEyE before fully switching from NSIS-based to CloudEyE-based campaigns. As the CloudEyE campaigns increased, the NSISbased campaigns ended. And when CloudEyE’s developers suspended operations, the NSIS-based campaigns tied to RATicate resumed.\n\n### The curious “legitimate” malware installer\n\nCloudEyE’s developers, Sebastiano Dragna and Ivano Mancini, have been marketing “protector” services for software developers for at least\n[the past five years. Their original product was called DarkEyE Protector, intended to allow developers of commercial or shareware software to](https://web.archive.org/web/20151228052730/http://www.securitycode.eu/)\nenforce software licensing schemes, prevent the copying or reuse of software components, and harden applications against reverse\nengineering or analysis.\n\nA screenshot of the website for DarkEyE from 2017.\n\nDarkEyE’s touted features included memory\n\nencryption, anti-analysis and anti-reversing for Windows executables packaged with the tool.\n\n\n-----\n\nU o tu ate y, t as a so usab e as a a a e c ypte a d ope ato s ge e a y p a sed ts use as a u y u detectab e ( U ) c ypte,\neven as a subscription service. Various versions of DarkEyE were offered “cracked” on hacker websites and boards as well.\n\nA strong endorsement on a private web board for\n\nDarkEye.\nLate last year, Dragna and Mancini evolved DarkEyE into CloudEyE with the addition of cloud and web-based software installation features.\nUnlike DarkEyE (or NSIS), CloudEyE is a tool for building a two-stage installer—Instead of having the final payload embedded, as NSIS does,\nthe CloudEyE loader pulls the final payload down from a remote URL.\n\nCloudEyE can be used to deploy the encrypted payload to a webserver, or to a cloud storage service such as Google Drive, Dropbox or\nMicrosoft’s One Drive. Since the payload is an encrypted blob, it evades detection by cloud storage security checks. The RATicate actor used\nGoogle Drive in an early campaign that appeared to be a test-run with CloudEyE.\n\nBelow: A video posted by the developers of CloudEyE demonstrating deployment of an encrypted payload using Google Drive.\n\nA similar demonstration showing the use of CloudEyE to deploy a “protected” executable to a private web server.\n\nWhen used in a malware campaign, this approach significantly complicates analysis. Network analysis of a CloudEyE payload in an email\nwould only yield the URL used for the second stage. If the URL is no longer working because the server is down or the protected file has been\nremoved it’s impossible to retrieve what would have been the final payload. Furthermore, deploying payloads through a cloud service or other\nlegitimate third-party service provider (as RATicate did with Google Drive) makes it even more difficult to track the group behind the malware.\n\nHowever, there were a number of things that made identifying RATicate as the actor group straightforward:\n\n1. The use of the same C&C infrastructure as used in previous campaigns,\n2. The commonality of infection chains across both NSIS and CloudEyE campaigns (with the installers either contained in a .zip archive file\n\nattached to an email, or downloaded by a weaponized document attached to an email from RATicate’s C&C infrastructure)\n\nWhen presented with data from all of the campaigns associated with RATicate, the developers of CloudEyE confirmed that all of the\ncampaigns they had data to verify came from three CloudEyE user accounts—with the majority coming from a single account.\n\n### Profiling CloudEyE campaigns\n\nThere were several artifacts of CloudEyE that made it possible to track the RATicate actors’ use of the tool. For web server deployments of the\npayload via CloudEyE, the name of the encrypted payload is linked to the URL for the payload’s C&C, as shown in these examples from the\nRATicate campaigns we found:\n\n**Encrypted payload name** **Payload C&C**\n\n\n-----\n\n**gold_encrypted_41109B0.bin** allenservice.ga/~zadmin/lmark/gld/link.php\n\n**bill_encrypted_9743D3F.bin** allenservice.ga/~zadmin/lmark/bill/link.php\n\n**apslo_encrypted_2A0A9B0.bin** allenservice.ga/~zadmin/lmark/ap0s/link.php\n\n**j2_encrypted_6637930.bin** allenservice.ga/~zadmin/lmark/jl2/link.php\n\n**pope_encrypted_5A46720.bin** stngpetty.ga/~zadmin/bud/pope/logout.php\n\n**frega_encrypted_30238C0.bin** castmart.ga/~zadmin/lmark/frega/link.php\n\nWe noted the same relationship in CloudEyE campaigns from other threat actors, so it’s apparent that the CloudEyE builder uses a pattern to\ngenerate the name it uses for encrypted payloads.\n\nAdditionally, the hexadecimal number at the end of the payload name generated by CloudEyE is always 7 characters long, and appears to be\na randomly-generated number, or is the result of a hash, timestamp or other build-specific input. It can be used to tag or identify specific\ncampaigns or builds of the payload, and used in tracking campaigns and analyzing how the actors operate. For example, the following table\nshows names of encrypted payloads that all connect to the same C&C URL. Since these files were seen on different dates, we believe that\nthey were different campaigns using the same payload, allowing us to track and cluster the campaigns.\n\n**Date** **Encrypted payload name** **Payload C&C**\n\n2020-03-16 apslo_encrypted_83062FF.bin allenservice.ga/~zadmin/lmark/ap0s/link.php\n\n2020-03-19 apslo_encrypted_31439B0.bin allenservice.ga/~zadmin/lmark/ap0s/link.php\n\n2020-03-23 apslo_encrypted_2506950.bin allenservice.ga/~zadmin/lmark/ap0s/link.php\n\n2020-04-15 apslo_encrypted_2A0A9B0.bin allenservice.ga/~zadmin/lmark/ap0s/link.php\n\nIn other cases, we found CloudEyE samples with different versions of the installer which point to same encrypted payload name. This could\nmean that they were used as part of the same campaigns, but that the installers were rebuilt in CloudEyE in order to avoid detection based on\na hash of the file.\n\n**FirstSeen** **Encrypted payload name** **Final Payload C&C** **Hash**\n\n\n2020-0331\n\n2020-0408\n\n2020-0415\n\n\napslo_encrypted_2A0A9B0.bin allenservice.ga/~zadmin/lmark/ap0s/link.php f521d91130e9f9d78e90a78f0744044051e0e64c212c\n\napslo_encrypted_2A0A9B0.bin allenservice.ga/~zadmin/lmark/ap0s/link.php 6291b8da2debcf4e4e03607f4bd32fdf56a07e408b5c\n\napslo_encrypted_2A0A9B0.bin allenservice.ga/~zadmin/lmark/ap0s/link.php 84d01e09fce89380d755c8e3c69055ab8c07ce547c3\n\n\n## Profiling the threat actor\n\nIn our [first report on RATicate, we noted that we suspected this threat actor may be acting as a Malware as as Service (MaaS) provider, selling](https://news.sophos.com/en-us/2020/05/14/raticate/)\nthird-party threat actors both the delivery and command and control infrastructure for malware packages. It was one explanation for why each\nRATicate campaign we identified delivered very different malware families.\n\nDuring our initial investigation of RATicate, we were able to use junk files packaged with the installer to identify campaigns. That wasn’t\npossible with the CloudEyE installer, but we were able to track the full infrastructure used, and use that and the filenames generated by\nCloudEyE as the basis for analysis of campaigns.\n\nWhat we found further suggested that RATicate was acting as a MaaS, and third party threat actors were using RATicate’s infrastructure to\ndeploy the malware of their choice. We can see there was no synchronization between the different campaigns, and that each of the different\nmalware families used specific URLs in the C&C infrastructure that include a directory name that could be associated with each specific thirdparty actor, or with a specific campaign:\n\n**C&C** **Family** **Analysis Option 1** **Analysis Option 2**\n\nallenservice.ga/~zadmin/lmark/lanre/link.php Lokibot **actor_tag: lmark campaign_tag: lanre** **actor_tag: lanre**\n\ncastmart.ga/~zadmin/lmark/frega/link.php Lokibot **actor_tag: lmark campaign_tag: frega** **actor_tag: frega**\n\nallenservice.ga/~zadmin/lmark/ap0s/link.php Lokibot **actor_tag: lmark campaign_tag: ap0s** **actor_tag: ap0s**\n\nallenservice.ga/~zadmin/lmark/gld/link.php Lokibot **actor_tag: lmark campaign_tag: gld** **actor_tag: gld**\n\n\n-----\n\nallenservice.ga/~zadmin/lmark/bill/link.php Lokibot **actor_tag: lmark campaign_tag: bill** **actor_tag: bill**\n\nallenservice.ga/~zadmin/lmark/jl2/link.php Lokibot **actor_tag: lmark campaign_tag: jl2** **actor_tag: jl2**\n\nallenservice.ga/~zadmin/lmark/h0ly/link.php Lokibot **actor_tag: lmark campaign_tag: h0ly** **actor_tag: h0ly**\n\nstngpetty.ga/~zadmin/bud/pope/logout.php Betabot **actor_tag: bud campaign_tag: pope** **actor_tag: pope**\n\nstngpetty.ga/~zadmin/bud/aus/logout.php Betabot **actor_tag: bud campaign_tag: aus** **actor_tag: aus**\n\nstngpetty.ga/~zadmin/bud/fit/logout.php Betabot **actor_tag: bud campaign_tag: fit** **actor_tag: fit**\n\nstngpetty.ga/~zadmin/bud/moh/logout.php Betabot **actor_tag: bud campaign_tag: moh** **actor_tag: moh**\n\nstngpetty.ga/~zadmin/bud/kha/logout.php Betabot **actor_tag: bud campaign_tag: kha** **actor_tag: kha**\n\nstngpetty.ga/~zadmin/bud/cyc/logout.php Betabot **actor_tag: bud campaign_tag: cyc** **actor_tag: cyc**\n\nstngpetty.ga/~zadmin/covid/cl/fre.php Lokibot **actor_tag: covid campaign_tag: cl** **actor_tag: cl**\n\nggautosrep.ga/~zadmin/amo/logout.php Betabot **actor_tag: amo campaign_tag: –** **actor_tag: amo**\n\ncastmart.ga/~zadmin/beta/aps/logout.php Betabot **actor_tag: beta campaign_tag: aps** **actor_tag: aps**\n\nggautosrep.ga/~zadmin/am/logout.php Betabot **actor_tag: am campaign_tag: –** **actor_tag: am**\n\nThe relationship between encrypted file names and payloads’ C&C URLs and the patterns they follow, suggest two possible scenarios. Either\nall this infrastructure belongs to one threat actor—RATicate group—and the group operates all these campaigns, or the RATicate group sells\nMaaS services—providing the infrastructure to other threat actors which finally use the infrastructure to infects the targets they want. Based on\nthe research and the information we’ve collected until now, all evidence points to the second option.\n\n### Back to old tricks (for now)\n\nA message from CloudEyE’s developers\n\nannouncing the termination of the service.\nOn June 10, Dragna and Mancini shut down CloudEyE accounts after being informed that their tool was being used by multiple malware\noperators. The CloudEyE packaging tool had been provided as a subscription service, with central control over functionality maintained by a\nlicensing API. They claimed they were alerted by press shortly after their service was identified by CheckPoint as being “Guloader.”\n\nShortly after CloudEyE’s shutdown, we observed new RATicate campaigns based on the NSIS installer. The group remains active. Based on\nour observations thus far, we believe RATicate group will continue to look for ways to apply new tools to its service and continuously attempt to\nimprove its delivery of malware for its customers.\n\nOn July 11, CloudEyE resumed operation with the following note from Dragna and Mancini: “Following an internal investigation aimed at\nverifying abuses carried out with our protection software, we decided to intensify our internal control policies aimed at limiting possible future\nabuses. Each contribution or report will be analyzed by the staff with the utmost attention and if ascertained, the account will be suspended\nimmediately.”\n\nThe new measures include the use of a hardware fingerprinting tool, called a hardware ID (HWID) grabber. However, those wanting to\ndownload this new “security feature” required to use the CloudEyE service will have to turn off malware protection, as it is currently detected as\nmalware by 17 security tools—including Sophos and Microsoft’s Windows Defender.\n\nEven with the new “security features,” there is no guarantee that CloudEyE will not not be used once again as a tool by RATicate and other\nmalware operators. While Dragna and Mancini told us they were moving to ban bad actors from using the service—including the ones we\npointed out to them—our assessment is that bad actors have long made up a significant portion (if not, as CheckPoint recently asserted, a\nmajority) of their customer base. Abuse of legitimate services is difficult to prevent by simply requiring hardware tokens, banning IP addresses\nand locking out specific user accounts. Given the reputation of their previous tool, the illicit demand for the service will not fade away.\n\n\n-----\n\n### u st o d cato s o co p o se o C oud y based cate a a e d st but o s ca be ou d o SophosLabs’ GitHub page.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2020/2020-07-14 - RATicate upgrades “RATs as a Service” attacks with commercial “crypter”.pdf"
    ],
    "report_names": [
        "2020-07-14 - RATicate upgrades “RATs as a Service” attacks with commercial “crypter”.pdf"
    ],
    "threat_actors": [
        {
            "id": "0d07b30c-4393-4071-82fb-22f51f7749e0",
            "created_at": "2022-10-25T16:07:24.097096Z",
            "updated_at": "2025-03-27T02:02:10.106625Z",
            "deleted_at": null,
            "main_name": "RATicate",
            "aliases": [],
            "source_name": "ETDA:RATicate",
            "tools": [
                "AgenTesla",
                "Agent Tesla",
                "AgentTesla",
                "BetaBot",
                "BlackRAT",
                "BlackRemote",
                "Bladabindi",
                "CloudEyE",
                "ForeIT",
                "Formbook",
                "GuLoader",
                "Jorik",
                "Loki",
                "Loki.Rat",
                "LokiBot",
                "LokiPWS",
                "NSIS",
                "Negasteal",
                "NetWeird",
                "NetWire",
                "NetWire RAT",
                "NetWire RC",
                "NetWired RC",
                "Neurevt",
                "Nullsoft Scriptable Install System",
                "Origin Logger",
                "Recam",
                "Remcos",
                "RemcosRAT",
                "Remvio",
                "Socmer",
                "ZPAQ",
                "njRAT",
                "vbdropper",
                "win.xloader"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535911,
    "ts_updated_at": 1743041461,
    "ts_creation_date": 1653759419,
    "ts_modification_date": 1653759419,
    "files": {
        "pdf": "https://archive.orkl.eu/f3d8c965c69d11a8fbff5076f77fd1511c9fa30e.pdf",
        "text": "https://archive.orkl.eu/f3d8c965c69d11a8fbff5076f77fd1511c9fa30e.txt",
        "img": "https://archive.orkl.eu/f3d8c965c69d11a8fbff5076f77fd1511c9fa30e.jpg"
    }
}