{
    "id": "872b52b8-71a5-4a61-b2ac-f94571e3fecd",
    "created_at": "2023-01-12T15:05:31.870225Z",
    "updated_at": "2025-03-27T02:16:06.525669Z",
    "deleted_at": null,
    "sha1_hash": "e90442753123b25145a8e357ef812420866dbed3",
    "title": "2018-08-07 - DarkHydrus Uses Phishery to Harvest Credentials in the Middle East",
    "authors": "",
    "file_creation_date": "2022-05-28T00:34:57Z",
    "file_modification_date": "2022-05-28T00:34:57Z",
    "file_size": 714885,
    "plain_text": "# DarkHydrus Uses Phishery to Harvest Credentials in the Middle East\n\n**[unit42.paloaltonetworks.com/unit42-darkhydrus-uses-phishery-harvest-credentials-middle-east/](https://unit42.paloaltonetworks.com/unit42-darkhydrus-uses-phishery-harvest-credentials-middle-east/)**\n\nRobert Falcone August 7, 2018\n\nBy [Robert Falcone](https://unit42.paloaltonetworks.com/author/robertfalcone/)\n\nAugust 7, 2018 at 5:00 AM\n\n[Category: Unit 42](https://unit42.paloaltonetworks.com/category/unit42/)\n\nTags: [DarkHydrus,](https://unit42.paloaltonetworks.com/tag/darkhydrus/) [Phishery](https://unit42.paloaltonetworks.com/tag/phishery/)\n\nThis post is also available in: 日本語 [(Japanese)](https://unit42.paloaltonetworks.jp/unit42-darkhydrus-uses-phishery-harvest-credentials-middle-east/)\n\nLast week, Unit 42 released a blog on a newly named threat group called DarkHydrus that\nwe observed targeting government entities in the Middle East. The attack that we discussed\n[in our previous publication involved spear-phishing to deliver a PowerShell payload we call](https://blog.paloaltonetworks.com/2018/07/unit42-new-threat-actor-group-darkhydrus-targets-middle-east-government/)\nRogueRobin; however, we are aware of DarkHydrus carrying out a credential harvesting\nattack in June 2018. It also appears that this an ongoing campaign, as we have evidence of\nprevious credential harvesting attempts using the same infrastructure dating back to the Fall\nof 2017. These attacks were targeting government entities and educational institutions in the\nMiddle East.\n\nThe credential harvesting attacks used spear-phishing emails that contained malicious\nMicrosoft Office documents that leveraged the “attachedTemplate” technique to load a\ntemplate from a remote server. When attempting to load this remote template, Microsoft\nOffice will display an authentication dialog box to ask the user to provide login credentials.\n\n\n-----\n\nWhen entered, these credentials are then sent to the C2 server, which allows DarkHydrus to\ncollect the user account credentials.\n[Based on Unit 42’s analysis, DarkHydrus used the open-source Phishery tool to create two](https://github.com/ryhanson/phishery)\nof the known Word documents used in these credential harvesting attacks. As discussed in\nour previous blog, this further strengthens DarkHydrus’ use of the open source for their\nattack tools.\nA phishing attack to steal credentials like this is not new: US-CERT [warned of the same](https://www.us-cert.gov/sites/default/files/publications/MIFR-10128830_TLP_WHITE.pdf)\ntechnique by a different threat group in 2017. What is noteworthy is DarkHydrus’ use of an\nopen-source tool to carry out targeted attacks against these entities in the Middle East, which\nis fitting of their reliance of open source tools and these attacks are consistent in terms of\ntargeting with what we reported last week. Based on this, we can reasonably presume this\ngroup will continue to carry out attacks against these kinds of targets in the Middle East in\nthe near-future.\n\nCredential Harvesting Attack\nOn June 24, 2018, Unit 42 observed DarkHydrus carrying out a credential harvesting attack\non an educational institution in the Middle East. The attack involved a spear-phishing email\nwith a subject of “Project Offer” and a malicious Word document (SHA256:\nd393349a4ad00902e3d415b622cf27987a0170a786ca3a1f991a521bff645318) as an\nattachment. When opened, the malicious Word document displays a dialog box that asks the\nuser for their credentials, as seen in Figure 1.\n\n_Figure 1. Authentication dialog box presented to the user when opening document_\n\n\n-----\n\nAs you can see in Figure 1, the authentication prompt says Connecting to <redacted>.\n0utl00k[.]net”, which is a DarkHydrus C2 server. If the user enters their credentials in this\ndialog box and presses ‘Ok’, the credentials are sent to the C2 server via the URL\nhttps://<redacted>.0utl00k[.]net/download/template.docx. With the authentication dialog box\ngone, Word displays the contents of the document, which in this specific case was an empty\ndocument. While this document was empty, the authentication prompt may have made the\ntargeted user more likely to enter their credentials, thinking it’s necessary to view the\ncontents of the document.\nDarkHydrus also created their C2 domain carefully in an attempt to further trick the targeted\nuser to enter their credentials. Firstly, the redacted subdomain was the domain of the\ntargeted educational institution. Also, the 0utl00k[.]net domain resembles Microsoft’s\nlegitimate \"outlook.com” domain that provides free email services, which also make the user\nless suspicious and more likely to enter their credentials. Some users may not even notice\nwhat domain the dialog states they are connecting to and habitually type their Windows\ncredentials.\nWe found two additional Word documents using the 0utl00k[.]net domain to harvest\ncredentials, seen in Table 1. We first saw these related Word documents in September and\nNovember 2017, which suggests that DarkHydrus has been carrying out this credential\nharvesting campaign for almost a year.\n\n**First Seen** **SHA256** **Filename** **Remote Template**\n\n11/12/2017 9eac37a5c6.. PasswordHandoverForm.docx https://0utl00k[.]net/docs\n\n09/18/2017 0b1d5e1744..اﺳﺘﻄﻼع.docx https://0utl00k[.]net/docs\n\n_Table 1. Additional DarkHydrus Word documents used to steal credentials_\n\nBoth of these related documents use the attachedTemplate technique to steal credentials by\nsending them to a URL https://0utl00k[.]net/docs. Unlike the June 2018 document that\ndisplayed no content after credential theft, both of these documents displayed content that\nappears pertinent to the targeted organization. The September 2017 document displays an\nemployee survey, which can be seen in Figure 2.\n\n\n-----\n\n_Figure 2. Employee survey displayed after credential theft_\n\nThe November 2017 document displays a password handover document after credential\ntheft occurs, as seen in Figure 3. We were unable to find the displayed document via open\nsource research, which may suggest that the actor gathered this password handover form\nfrom a prior operation.\n\n\n-----\n\n_Figure 3. Password handover form displayed after credential theft_\n\nThe infrastructure used in these credential harvesting attacks used the domain 0utl00k[.]net,\nwhich at the time of the attacks resolved to 107.175.150[.]113 and 195.154.41[.]150. This\n[same infrastructure was discussed in the Campaign Analysis of our previous blog.](https://blog.paloaltonetworks.com/2018/07/unit42-new-threat-actor-group-darkhydrus-targets-middle-east-government/)\n\nPhishery Tool\n\nWhile analyzing the three malicious Word documents, we determined that two of the\n[documents were created using an open source tool called Phishery. The Phishery tool is](https://github.com/ryhanson/phishery)\ncapable of the following:\n\n1. Creating malicious Word documents by injecting a remote template URL\n2. Hosting a C2 server to gather credentials entered into authentication dialog boxes\n\ndisplayed when attempting to obtain the remote template\n\nWe were able to confirm that DarkHydrus used Phishery to create these Word documents by\nusing the open source tool to create a document and host a C2 ourselves. The DarkHydrus\ndocument used in the June 2018 attacks had a remote template URL added, as seen in\n\n\n-----\n\nFigure 4.\n\n_Figure 4. Remote template URL seen in the DarkHydrus document from June 2018_\n\nWe were able to replicate the remote template path seen in Figure 4 by using Phishery to\ncreate a weaponized delivery document. Figure 5 shows Phishery’s output to the command\nthat injects a URL into a file named “good_test.docx”, which it will save the resulting file to\n“bad_test.docx”.\n\n_Figure 5. Phishery command used to create a document that has same remote template_\n_URL as DarkHydrus_\n\n\n-----\n\nTo confirm, we used Phishery s C2 server and opened DarkHydrus Word document from the\nJune 2018 attacks. When presented with the authentication dialog box, we entered\n“fakename” and “fakepass” as credentials, as seen in Figure 6 and pressed enter.\n\n_Figure 6. Authentication dialog box with fake credentials entered_\n\nOn the C2 server, we observed Phishery receiving the inbound request and capturing the\ncredentials, as seen in Figure 7. The C2 server was able to obtain the “fakename” and\n“fakepass” credentials entered into the authentication dialog box displayed when opening\nDarkHydrus’ Word document.\n\n_Figure 7. Output of Phishery C2 showing captured credentials_\n\nConclusion\n\nDarkHydrus is a threat group carrying out attack campaigns targeting organizations in the\nMiddle East. We discovered DarkHydrus carrying out credential harvesting attacks that use\nweaponized Word documents, which they delivered via spear-phishing emails to entities\nwithin government and educational institutions. This threat group not only used the Phishery\ntool to create these malicious Word documents, but also to host the C2 server to harvest\n\n\n-----\n\ncredentials. The use of Phishery further shows Dark Hydrus reliance on open source tools to\nconduct their operations.\nPalo Alto Networks customers are protected from Dark Hydrus by:\n\nThe C2 server 0utl00k[.]net is classified as Malware\nAll Phishery documents created by DarkHydrus have malicious verdicts in WildFire\nAutoFocus customers can monitor this threat group’s activity via the [DarkHydrus tag](https://autofocus.paloaltonetworks.com/#/tag/Unit42.DarkHydrus)\n\nIndicators of Compromise\n**Samples**\nd393349a4ad00902e3d415b622cf27987a0170a786ca3a1f991a521bff645318\n9eac37a5c675cd1750cd50b01fc05085ce0092a19ba97026292a60b11b45bf49\n0b1d5e17443f0896c959d22fa15dadcae5ab083a35b3ff6cb48c7f967649ec82\n\n**Infrastructure**\n0utl00k[.]net\n107.175.150[.]113\n195.154.41[.]150\n\n**Get updates from**\n**Palo Alto**\n**Networks!**\n\nSign up to receive the latest news, cyber threat intelligence and research from us\n\n[By submitting this form, you agree to our Terms of Use and acknowledge our Privacy](https://www.paloaltonetworks.com/legal-notices/terms-of-use)\nStatement.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2018/2018-08-07 - DarkHydrus Uses Phishery to Harvest Credentials in the Middle East.pdf"
    ],
    "report_names": [
        "2018-08-07 - DarkHydrus Uses Phishery to Harvest Credentials in the Middle East.pdf"
    ],
    "threat_actors": [
        {
            "id": "4fe925e8-95e5-4a63-9f96-4d0f9bedac08",
            "created_at": "2022-10-25T15:50:23.469077Z",
            "updated_at": "2025-03-27T02:00:55.478056Z",
            "deleted_at": null,
            "main_name": "DarkHydrus",
            "aliases": [
                "DarkHydrus"
            ],
            "source_name": "MITRE:DarkHydrus",
            "tools": [
                "Mimikatz",
                "RogueRobin",
                "Cobalt Strike"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "6efb28db-4d91-46cb-8ab7-fe9e8449ccfc",
            "created_at": "2023-01-06T13:46:38.772861Z",
            "updated_at": "2025-03-27T02:00:02.914846Z",
            "deleted_at": null,
            "main_name": "DarkHydrus",
            "aliases": [
                "Obscure Serpens",
                "LazyMeerkat",
                "G0079"
            ],
            "source_name": "MISPGALAXY:DarkHydrus",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "5b04780e-7b64-4e62-b776-c6749ff7dec8",
            "created_at": "2022-10-25T16:07:23.531741Z",
            "updated_at": "2025-03-27T02:02:09.84903Z",
            "deleted_at": null,
            "main_name": "DarkHydrus",
            "aliases": [
                "ATK 77",
                "DarkHydrus",
                "LazyMeerkat",
                "Obscure Serpens"
            ],
            "source_name": "ETDA:DarkHydrus",
            "tools": [
                "Agentemis",
                "Cobalt Strike",
                "CobaltStrike",
                "Mimikatz",
                "Phishery",
                "RogueRobin",
                "RogueRobinNET",
                "Trojan.Phisherly",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535931,
    "ts_updated_at": 1743041766,
    "ts_creation_date": 1653698097,
    "ts_modification_date": 1653698097,
    "files": {
        "pdf": "https://archive.orkl.eu/e90442753123b25145a8e357ef812420866dbed3.pdf",
        "text": "https://archive.orkl.eu/e90442753123b25145a8e357ef812420866dbed3.txt",
        "img": "https://archive.orkl.eu/e90442753123b25145a8e357ef812420866dbed3.jpg"
    }
}