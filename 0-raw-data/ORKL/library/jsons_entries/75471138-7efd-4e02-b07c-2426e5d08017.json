{
    "id": "75471138-7efd-4e02-b07c-2426e5d08017",
    "created_at": "2023-01-12T14:59:09.702458Z",
    "updated_at": "2025-03-27T02:05:36.175872Z",
    "deleted_at": null,
    "sha1_hash": "3dc248fda5dbce21e488fba99f969fbd7fd7f36c",
    "title": "2021-03-11 - Image File Trickery Part II- Fake Icon Delivers NanoCore",
    "authors": "",
    "file_creation_date": "2022-05-28T15:19:29Z",
    "file_modification_date": "2022-05-28T15:19:29Z",
    "file_size": 1178424,
    "plain_text": "# Image File Trickery Part II: Fake Icon Delivers NanoCore\n\n**[trustwave.com/en-us/resources/blogs/spiderlabs-blog/image-file-trickery-part-ii-fake-icon-delivers-nanocore/](https://www.trustwave.com/en-us/resources/blogs/spiderlabs-blog/image-file-trickery-part-ii-fake-icon-delivers-nanocore/)**\n\nThe .zipx file extension is used to denote that the ZIP archive format is compressed using\n[advanced methods of the WinZip archiver. In 2019, we published a blog about this file](https://www.trustwave.com/en-us/resources/blogs/spiderlabs-blog/spammed-png-file-hides-lokibot/)\nextension being abused to deliver Lokibot malware. In this blog, we outline another .zipx\nattachment we recently encountered with spam messages, and we will show the result of\nour investigation in comparison to the previous .zipx sample we observed.\n\n_Figure 1: The email sample containing a .zipx attachment_\n\n\n-----\n\nThe emails, claiming to be from the Purchase Manager of certain organizations that the\ncybercriminals are spoofing, look like usual malspams except for their attachment. The\nattachments, which have a filename format “NEW PURCHASE ORDER.pdf*.zipx”, are\nactually image (Icon) binary files, with attached extra data, which happens to be RAR. This\n[file format abuse is similar to what we have seen previously.](https://www.trustwave.com/en-us/resources/blogs/spiderlabs-blog/spammed-png-file-hides-lokibot/)\n\n_Figure 2: The attachment’s contents viewed in the Hiew tool_\n\nIf the attachment successfully evades any scanning email gateways, the next hurdle is the\nvictim’s machine, which needs to have an unzip tool that can extract the executable file\ninside the attachment. We tried using the same tools from the previous blog to extract the\nEXE file and here is the result:\n\nThe archive utility WinZip and WinRAR yield similar results when extracting the EXE file\nfrom the previous and current .zipx files. WinZip does not support unzipping either of\nsamples whereas WinRAR managed to extract the EXE file contained in both samples.\n\n\n-----\n\n_Figure 3: The executable contained in the attachment NEW PURCHASE ORDER.pdf.zipx_\n_is recognized by WinRAR_\n\nInterestingly, 7Zip can also extract the content of the latest .zipx sample. 7Zip initially tries to\nopen the files as a ZIP archive and fails, but afterward, 7Zip recognizes the .zipx files as\nRar5 archives and can get their contents unpacked. Unlike in the previous blog, there is no\nneed for the extension of the recent attachments to be renamed to something else other\nthan .zipx or .zip just for their executables to be extracted using 7Zip.\n\n\n-----\n\n_Figure 4: Opening the attachment NEW PURCHASE ORDER.pdf.zipx using the 7Zip tool_\n\nThe executables we gathered have a similar name to that of the .zipx attachment, “NEW\n_PURCHASE ORDER*.exe”. Also, the icon at the start of the .zipx files is actually the icon_\nused on the EXE files within the archive.\n\nAnalyzing the EXE files indicates that they are samples of NanoCore RAT version 1.2.2.0.\nThis RAT create copies of itself at the AppData folder and inject its malicious code at\nRegSvcs.exe process. The data stolen by this RAT is sent to the command and control\nservers listed below:\n\nshtf[.]pw\nuyeco[.]pw\n\n_Figure 5: Memory dump of RegSvcs processes where NanoCore malware is injected_\n\n## Summary\n\nThe recent malspams have the same goal like the ones we investigated almost two years\nago and that is to effectively hide the malicious executable from anti-malware and email\nscanners by abusing the file format of the “.zipx” attachment, which in this case is an Icon\nfile with added surprises. In a slight twist, enclosing the executable into a RAR archive\n\n\n-----\n\ninstead of a ZIP file, the content of the .zipx attachment can be extracted by another\npopular archiving tool, 7Zip. If the end-user uses 7Zip or WinRAR, the NanoCore malware\ncould be installed onto the system, if the user decides to run and extract it. It all works\nbecause various archive utilities try their darndest to find something to unzip within files.\nYou might even argue they try too hard!\n\nThe Trustwave Secure Email Gateway flagged the messages as malicious and detected\nthis threat.\n\n## IOCs\n\nAttachment:\n\nNEW PURCHASE ORDER.pdf.zipx (480092 bytes) SHA1:\nDF46A893B51D8ADE0CCDEF7E375FB387E2560720\n\nNew Purchase Order.pdf (2).zipx (403050 bytes) SHA1:\nC93FBA54357E90235202F58DA1FEFF7AB1142F65\n\nNanoCore RAT:\n\nNEW PURCHASE ORDER.exe (635904 bytes) SHA1:\nE99F6B9BD787679666F8C54B9A834D6ACECFA622\n\nNew purchase order (3).exe (431104 bytes) SHA1:\nFD958C365B6BFA5EF34779831773EC92C041A5D5\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-03-11 - Image File Trickery Part II- Fake Icon Delivers NanoCore.pdf"
    ],
    "report_names": [
        "2021-03-11 - Image File Trickery Part II- Fake Icon Delivers NanoCore.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673535549,
    "ts_updated_at": 1743041136,
    "ts_creation_date": 1653751169,
    "ts_modification_date": 1653751169,
    "files": {
        "pdf": "https://archive.orkl.eu/3dc248fda5dbce21e488fba99f969fbd7fd7f36c.pdf",
        "text": "https://archive.orkl.eu/3dc248fda5dbce21e488fba99f969fbd7fd7f36c.txt",
        "img": "https://archive.orkl.eu/3dc248fda5dbce21e488fba99f969fbd7fd7f36c.jpg"
    }
}