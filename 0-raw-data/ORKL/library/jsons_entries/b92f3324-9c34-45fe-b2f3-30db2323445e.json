{
    "id": "b92f3324-9c34-45fe-b2f3-30db2323445e",
    "created_at": "2023-01-12T15:03:34.432837Z",
    "updated_at": "2025-03-27T02:14:11.700535Z",
    "deleted_at": null,
    "sha1_hash": "b147e8a9007286c55059a19f644a294052c16e36",
    "title": "2013-01-14 - The “Red October” Campaign – An Advanced Cyber Espionage Network Targeting Diplomatic and Government Agencies",
    "authors": "",
    "file_creation_date": "2022-09-01T10:17:27Z",
    "file_modification_date": "2022-09-01T10:17:27Z",
    "file_size": 1596262,
    "plain_text": "# The “Red October” Campaign – An Advanced Cyber Espionage Network Targeting Diplomatic and Government Agencies\n\n**securelist.com/the-red-october-campaign/57647**\n\nAuthors\n\nGReAT\n\n**Here’s a** **[link to the full paper (part 1) about our Red October research. During the next](https://securelist.com/red-october-diplomatic-cyber-attacks-investigation/36740/)**\n**days, we’ll be publishing Part 2, which contains a detailed technical analysis of all the**\n**known modules. Please stay tuned.**\n\nDuring the past five years, a high-level cyber-espionage campaign has successfully\ninfiltrated computer networks at diplomatic, governmental and scientific research\norganizations, gathering data and intelligence from mobile devices, computer systems and\nnetwork equipment.\n\nKaspersky Lab’s researchers have spent several months analyzing this malware, which\ntargets specific organizations mostly in Eastern Europe, former USSR members and\ncountries in Central Asia, but also in Western Europe and North America.\n\n\n-----\n\nThe campaign, identified as “Rocra”, short for “Red October”, is currently still active with data\nbeing sent to multiple command-and-control servers, through a configuration which rivals in\ncomplexity the [infrastructure of the Flame malware. Registration data used for the purchase](https://securelist.com/the-flame-questions-and-answers/34344/)\nof C&C domain names and PE timestamps from collected executables suggest that these\nattacks date as far back as May 2007.\n\nSome key findings from our investigation:\n\nThe attackers have been active for at least five years, focusing on diplomatic and\ngovernmental agencies of various countries across the world. Information harvested\nfrom infected networks is reused in later attacks. For example, stolen credentials were\ncompiled in a list and used when the attackers needed to guess passwords and\nnetwork credentials in other locations. To control the network of infected machines, the\nattackers created more than 60 domain names and several server hosting locations in\ndifferent countries (mainly Germany and Russia). The C&C infrastructure is actually a\nchain of servers working as proxies and hiding the location of the true -mothershipcommand and control server.\nThe attackers created a multi-functional framework which is capable of applying quick\nextension of the features that gather intelligence. The system is resistant to C&C server\ntakeover and allows the attacker to recover access to infected machines using\nalternative communication channels.\n\n\n-----\n\nBeside traditional attack targets (workstations), the system is capable of stealing data\nfrom mobile devices, such as smartphones (iPhone, Nokia, Windows Mobile); dumping\nenterprise network equipment configuration (Cisco); hijacking files from removable disk\ndrives (including already deleted files via a custom file recovery procedure); stealing email databases from local Outlook storage or remote POP/IMAP server; and siphoning\nfiles from local network FTP servers.\nWe have observed the use of at least three different exploits for previously known\nvulnerabilities: CVE-2009-3129 (MS Excel), CVE-2010-3333 (MS Word) and CVE**2012-0158 (MS Word). The earliest known attacks used the exploit for MS Excel and**\ntook place in 2010 and 2011, while attacks targeting the MS Word vulnerabilities\nappeared in the summer of 2012.\n\nThe exploits from the documents used in spear phishing were created by other\nattackers and employed during different cyber attacks against Tibetan activists as well\nas military and energy sector targets in Asia. The only thing that was changed is the\nexecutable which was embedded in the document; the attackers replaced it with their\nown code.\n\n\n-----\n\nSample fake image used in one of the Rocra spear phishing attacks.\n\nDuring lateral movement in a victim’s network, the attackers deploy a module to\nactively scan the local area network, find hosts vulnerable for MS08-067 (the\nvulnerability exploited by Conficker) or accessible with admin credentials from its own\npassword database. Another module used collected information to infect remote hosts\nin the same network.\nBased on registration data of the C&C servers and numerous artifacts left in\nexecutables of the malware, we strongly believe that the attackers have Russianspeaking origins. Current attackers and executables developed by them have been\nunknown until recently, they have never related to any other targeted cyber attacks.\nNotably, one of the commands in the Trojan dropper switches the codepage of an\ninfected machine to 1251 before installation. This is required to address files and\ndirectories that contain Cyrillic characters in their names.\n\n## Rocra FAQ:\n\n**What is Rocra? Where does the name come from? Was Operation Rocra targeting any**\n**specific industries, organizations or geographical regions?**\n\nRocra (short for “Red October”) is a targeted attack campaign that has been going on for at\nleast five years. It has infected hundreds of victims around the world in eight main\ncategories:\n\n\n-----\n\n1. Government\n2. Diplomatic / embassies\n3. Research institutions\n4. Trade and commerce\n5. Nuclear / energy research\n6. Oil and gas companies\n7. Aerospace\n8. Military\n\nIt is quite possible there are other targeted sectors which haven’t been discovered yet or\nhave been attacked in the past.\n\n**How and when was it discovered?**\n\nWe have come by the Rocra attacks in October 2012, at the request of one of our partners.\nBy analysing the attack, the spear phishing and malware modules, we understood the scale\nof this campaign and started dissecting it in depth.\n\n**Who provided you with the samples?**\n\nOur partner who originally pointed us to this malware prefers to remain anonymous.\n\n**How many infected computers have been identified by Kaspersky Lab? How many**\n**victims are there? What is the estimated size of Operation Red October on a global**\n**scale?**\n\nDuring the past months, we’ve counted several hundreds of infections worldwide – all of\nthem in top locations such as government networks and diplomatic institutions. The\ninfections we’ve identified are distributed mostly in Eastern Europe, but there are also reports\ncoming from North America and Western European countries such as Switzerland or\nLuxembourg.\n\nBased on our Kaspersky Security Network (KSN) here’s a list of countries with most\ninfections (only for those with more than 5 victims):\n\n**Country** **Infections**\n\nRUSSIAN FEDERATION 35\n\nKAZAKHSTAN 21\n\nAZERBAIJAN 15\n\nBELGIUM 15\n\n\n-----\n\nINDIA 14\n\nAFGHANISTAN 10\n\nARMENIA 10\n\nIRAN; ISLAMIC REPUBLIC OF 7\n\nTURKMENISTAN 7\n\nUKRAINE 6\n\nUNITED STATES 6\n\nVIET NAM 6\n\nBELARUS 5\n\nGREECE 5\n\nITALY 5\n\nMOROCCO 5\n\nPAKISTAN 5\n\nSWITZERLAND 5\n\nUGANDA 5\n\nUNITED ARAB EMIRATES 5\n\nFor the sinkhole statistics see below.\n\n**Who is behind/responsible for this operation? Is this a nation-state sponsored attack?**\n\nThe information we have collected so far does not appear to point towards any specific\nlocation, however, two important factors stand out:\n\nThe exploits appear to have been created by Chinese hackers.\nThe Rocra malware modules have been created by Russian-speaking operatives.\n\nCurrently, there is no evidence linking this with a nation-state sponsored attack. The\ninformation stolen by the attackers is obviously of the highest level and includes geopolitical\ndata which can be used by nation states. Such information could be traded in the\nunderground and sold to the highest bidder, which can be of course, anywhere.\n\n**Are there any interesting texts in the malware that can suggest who the attackers are?**\n\nSeveral Rocra modules contain interesting typos and mis-spellings:\n\n\n-----\n\nnetwork_scanner: SUCCESSED, Error_massage, natrive_os, natrive_lan\nimapispool: “UNLNOWN_PC_NAME”, “WinMain: error CreateThred stop”\nmapi_client: “Default Messanger”, “BUFEER IS FULL”\nmsoffice_plugin: “my_encode my_dencode”\nwinmobile: “Zakladka injected”, “Cannot inject zakladka, Error: %u”\nPswSuperMailRu: “——-PROGA START—–“, “——-PROGA END—–“\n\nThe word “PROGA” used in here might refer to transliteration of Russian slang “ПРОГА”,\nwhich literally means an application or a program among Russian-speaking software\nengineers.\n\nIn particular, the word “Zakladka” in Russian can mean:\n\n“bookmark”\n(more likely) a slang term meaning “undeclared functionality”, i.e. in software or\nhardware. However, it may also mean a microphone embedded in a brick of the\nembassy building.\n\nThe C++ class that holds the C&C configuration parameters is called “MPTraitor” and the\ncorresponding configuration section in the resources is called “conn_a”. Some examples\ninclude:\n\nconn_a.D_CONN\nconn_a.J_CONN\nconn_a.D_CONN\nconn_a.J_CONN\n\n**What kind of information is being hijacked from infected machines?**\n\nInformation stolen from infected systems includes documents with extensions:\n\ntxt, csv, eml, doc, vsd, sxw, odt, docx, rtf, pdf, mdb, xls, wab, rst, xps, iau,\n\ncif, key, crt, cer, hse, pgp, gpg, xia, xiu, xis, xio, xig, acidcsa, acidsca,\n\naciddsk, acidpvr, acidppr, acidssa.\n\nIn particular, the “acid*” extensions appear to refer to the classified software “Acid\nCryptofiler”, which is used by several entities such as the European Union and/or NATO.\n\n**What is the purpose/objective of this operation? What were the attackers looking for**\n**by conducting this sustained cyber-espionage campaign for so many years?**\n\nThe main purpose of the operation appears to be the gathering of classified information and\ngeopolitical intelligence, although it seems that the information gathering scope is quite wide.\nDuring the past five years, the attackers collected information from hundreds of high profile\nvictims although it’s unknown how the information was used.\n\n\n-----\n\nIt is possible that the information was sold on the black market, or used directly.\n\n**What are the infection mechanisms for the malware? Does it have self-propagating**\n**(worm) capabilities? How does it work? Do the attackers have a customized attack**\n**platform?**\n\nThe main malware body acts as a point of entry into the system which can later download\nmodules used for lateral movement. After initial infection, the malware won’t propagate by\nitself – typically, the attackers would gather information about the network for a few days,\nidentify key systems and then deploy modules which can compromise other computers in the\nnetwork, for instance by using the MS08-067 exploit.\n\nIn general, the Rocra framework is designed for executing “tasks” that are provided by its\nC&C servers. Most of the tasks are provided as one-time PE DLL libraries that are received\nfrom the server, executed in memory and then immediately discarded.\n\nSeveral tasks however need to be constantly present in the system, i.e. waiting for the\niPhone or Nokia mobile to connect. These tasks are provided as PE EXE files and are\ninstalled in the infected machine.\n\n**Examples of “persistent” tasks**\n\nOnce a USB drive is connected, search and extract files by mask/format, including\ndeleted files. Deleted files are restored using a built in file system parser\nWait for an iPhone or a Nokia phone to be connected. Once connected, retrieve\ninformation about the phone, its phone book, contact list, call history, calendar, SMS\nmessages, browsing history\nWait for a Windows Mobile phone to be connected. Once connected, infect the phone\nwith a mobile version of the Rocra main component\nWait for a specially crafted Microsoft Office or PDF document and execute a malicious\npayload embedded in that document, implementing a one-way covert channel of\ncommunication that can be used to restore control of the infected machine\nRecord all the keystrokes, make screenshots\nExecute additional encrypted modules according to a pre-defined schedule\nRetrieve e-mail messages and attachments from Microsoft Outlook and from reachable\nmail servers using previously obtained credentials\n\n**Examples of “one-time” tasks**\n\nCollect general software and hardware environment information\nCollect filesystem and network share information, build directory listings, search and\nretrieve files by mask provided by the C&C server\n\n\n-----\n\nCollect information about installed software, most notably Oracle DB, RAdmin, IM\nsoftware including Mail.Ru agent, drivers and software for Windows Mobile, Nokia,\nSonyEricsson, HTC, Android phones, USB drives\nExtract browsing history from Chrome, Firefox, Internet Explorer, Opera\nExtract saved passwords for Web sites, FTP servers, mail and IM accounts\nExtract Windows account hashes, most likely for offline cracking\nExtract Outlook account information\nDetermine the external IP address of the infected machine\nDownload files from FTP servers that are reachable from the infected machine\n(including those that are connected to its local network) using previously obtained\ncredentials\nWrite and/or execute arbitrary code provided within the task\nPerform a network scan, dump configuration data from Cisco devices if available\nPerform a network scan within a predefined range and replicate to vulnerable machines\nusing the MS08-067 vulnerability\nReplicate via network using previously obtained administrative credentials\n\nThe Rocra framework was designed by the attackers from scratch and hasn’t been used in\nany other operations.\n\n**Was the malware limited to only workstations or did it have additional capabilities,**\n**such as a mobile malware component?**\n\nSeveral mobile modules exist, which are designed to steal data from several types of\ndevices:\n\nWindows Mobile\niPhone\nNokia\n\nThese modules are installed in the system and wait for mobile devices to be connected to\nthe victim’s machine. When a connection is detected, the modules start collecting data from\nthe mobile phones.\n\n**How many variants, modules or malicious files were identified during the overall**\n**duration of Operation Red October?**\n\nDuring our investigation, we’ve uncovered over 1000 modules belonging to 30 different\nmodule categories. These have been created between 2007 with the most recent being\ncompiled on 8th Jan 2013.\n\nHere’s a list of known modules and categories:\n\n\n-----\n\n**Were initial attacks launched at select “high-profile” victims or were they launched in**\n**series of larger (wave) attacks at organizations/victims?**\n\nAll the attacks are carefully tuned to the specifics of the victims. For instance, the initial\ndocuments are customized to make them more appealing and every single module is\nspecifically compiled for the victim with a unique victim ID inside.\n\n\n-----\n\nLater, there is a high degree of interaction between the attackers and the victim – the\noperation is driven by the kind of configuration the victim has, which type of documents the\nuse, installed software, native language and so on.\nCompared to Flame and Gauss, which are highly automated cyberespionage campaigns,\nRocra is a lot more “personal” and finely tuned for the victims.\n\n**Is Rocra related in any way to the Duqu, Flame and Gauss malware?**\n\nSimply put, we could not find any connections between Rocra and the Flame / Tilded\nplatforms.\n\n**How does Operation Rocra compare to similar campaigns such as Aurora and Night**\n**Dragon? Any notable similarities or differences?**\n\nCompared to Aurora and Night Dragon, Rocra is a lot more sophisticated. During our\ninvestigation we’ve uncovered over 1000 unique files, belonging to about 30 different module\ncategories. Generally speaking, the Aurora and Night Dragon campaigns used relatively\nsimple malware to steal confidential information.\n\nWith Rocra, the attackers managed to stay in the game for over 5 years and evade detection\nof most antivirus products while continuing to exfiltrate what must be hundreds of Terabytes\nby now.\n\n**How many Command & Control servers are there? Did Kaspersky Lab conduct any**\n**forensic analysis on them?**\n\nDuring our investigation, we uncovered more than 60 domain names used by the attackers\nto control and retrieve data from the victims. The domain names map to several dozen IPs\nlocated mostly in Russia and Germany.\n\nHere’s an overview of the Rocra’s command and control infrastructure, as we believe it looks\nfrom our investigations:\n\n\n-----\n\nMore detailed information about the Command and Control servers will be revealed at a later\ndate.\n\n**Did you sinkhole any of the Command & Control servers?**\n\nWe were able to sinkhole six of the over 60 domains used by the various versions of the\nmalware. During the monitoring period (2 Nov 2012 – 10 Jan 2013), we registered over\n55,000 connections to the sinkhole. The number of different IPs connecting to the sinkhole\nwas 250.\n\nFrom the point of view of country distribution of connections to the sinkhole, we have\nobserved victims in 39 countries, with most of IPs being from Switzerland. Kazakhstan and\nGreece follow next.\n\n\n-----\n\nSinkhole statistics – 2 Nov 2012 – 10 Jan 2013\n\n**Is Kaspersky Lab working with any governmental organizations, Computer**\n**Emergency Response Teams (CERTs), law enforcement agencies or security**\n**companies as part of the investigation and disinfection efforts?**\n\nKaspersky Lab, in collaboration with international organizations, Law Enforcement,\nComputer Emergency Response Teams (CERTs) and other IT security companies is\ncontinuing its investigation of Operation Red October by providing technical expertise and\nresources for remediation and mitigation procedures.\n\nKaspersky Lab would like to express their thanks to: US-CERT, the Romanian CERT and the\nBelarusian CERT for their assistance with the investigation.\n\nIf you are a CERT and would like more information about infections in your country, please\ncontact us at theflame@kaspersky.com.\n\n**Here’s a** **[link to the full paper (part 1) about our Red October research. During the next](https://securelist.com/red-october-diplomatic-cyber-attacks-investigation/36740/)**\n**days, we’ll be publishing Part 2, which contains a detailed technical analysis of all the**\n**known modules. Please stay tuned.**\n\nA list of MD5s of known documents used in the Red October attacks:\n\n\n-----\n\n114ed0e5298149fc69f6e41566e3717a\n1f86299628bed519718478739b0e4b0c\n\n2672fbba23bf4f5e139b10cacc837e9f\n\n350c170870e42dce1715a188ca20d73b\n\n396d9e339c1fd2e787d885a688d5c646\n\n3ded9a0dd566215f04e05340ccf20e0c\n\n44e70bce66cdac5dc06d5c0d6780ba45\n\n4bfa449f1a351210d3c5b03ac2bd18b1\n\n4ce5fd18b1d3f551a098bb26d8347ffb\n\n4daa2e7d3ac1a5c6b81a92f4a9ac21f1\n\n50bd553568422cf547539dd1f49dd80d\n\n51edea56c1e83bcbc9f873168e2370af\n\n5d1121eac9021b5b01570fb58e7d4622\n\n5ecec03853616e13475ac20a0ef987b6\n\n5f9b7a70ca665a54f8879a6a16f6adde\n\n639760784b3e26c1fe619e5df7d0f674\n\n65d277af039004146061ff01bb757a8f\n\n6b23732895daaad4bd6eae1d0b0fef08\n\n731c68d2335e60107df2f5af18b9f4c9\n\n7e5d9b496306b558ba04e5a4c5638f9f\n\n82e518fb3a6749903c8dc17287cebbf8\n\n85baebed3d22fa63ce91ffafcd7cc991\n\n91ebc2b587a14ec914dd74f4cfb8dd0f\n\n93d0222c8c7b57d38931cfd712523c67\n\n9950a027191c4930909ca23608d464cc\n\n9b55887b3e0c7f1e41d1abdc32667a93\n\n9f470a4b0f9827d0d3ae463f44b227db\n\na7330ce1b0f89ac157e335da825b22c7\n\nb9238737d22a059ff8da903fbc69c352\n\nc78253aefcb35f94acc63585d7bfb176\n\nfc3c874bdaedf731439bbe28fc2e6bbe\n\nbb2f6240402f765a9d0d650b79cd2560\n\nbd05475a538c996cd6cafe72f3a98fae\n\nc42627a677e0a6244b84aa977fbea15d\n\ncb51ef3e541e060f0c56ac10adef37c3\n\nceac9d75b8920323477e8a4acdae2803\n\ncee7bd726bc57e601c85203c5767293c\n\nd71a9d26d4bb3b0ed189c79cd24d179a\n\nd98378db4016404ac558f9733e906b2b\n\ndc4a977eaa2b62ad7785b46b40c61281\n\ndc8f0d4ecda437c3f870cd17d010a3f6\n\nde56229f497bf51274280ef84277ea54\n\n\n-----\n\nec98640c401e296a76ab7f213164ef8c\nf0357f969fbaf798095b43c9e7a0cfa7\n\nf16785fc3650490604ab635303e61de2\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2013/2013-01-14 - The “Red October” Campaign – An Advanced Cyber Espionage Network Targeting Diplomatic and Government Agencies.pdf"
    ],
    "report_names": [
        "2013-01-14 - The “Red October” Campaign – An Advanced Cyber Espionage Network Targeting Diplomatic and Government Agencies.pdf"
    ],
    "threat_actors": [
        {
            "id": "ea844ee6-eb12-42c0-8426-11395fe81e6f",
            "created_at": "2022-10-25T15:50:23.300796Z",
            "updated_at": "2025-03-27T02:00:55.434471Z",
            "deleted_at": null,
            "main_name": "Night Dragon",
            "aliases": [
                "Night Dragon"
            ],
            "source_name": "MITRE:Night Dragon",
            "tools": [
                "at",
                "gsecdump",
                "zwShell",
                "PsExec",
                "ASPXSpy",
                "gh0st RAT"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "02c9f3f6-5d10-456b-9e63-750286048149",
            "created_at": "2022-10-25T16:07:23.722884Z",
            "updated_at": "2025-03-27T02:02:09.945869Z",
            "deleted_at": null,
            "main_name": "Inception Framework",
            "aliases": [
                "ATK 116",
                "Blue Odin",
                "Clean Ursa",
                "Cloud Atlas",
                "Inception Framework",
                "Operation Cloud Atlas",
                "Operation RedOctober",
                "The Rocra"
            ],
            "source_name": "ETDA:Inception Framework",
            "tools": [
                "Lastacloud",
                "PowerShower",
                "VBShower"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "09a8f8fe-e907-47b4-8709-a97717dde3cc",
            "created_at": "2022-10-25T16:07:23.90252Z",
            "updated_at": "2025-03-27T02:02:10.020919Z",
            "deleted_at": null,
            "main_name": "Night Dragon",
            "aliases": [],
            "source_name": "ETDA:Night Dragon",
            "tools": [
                "ASPXSpy",
                "ASPXTool",
                "Cain & Abel",
                "gsecdump",
                "zwShell"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "020794ec-7315-47de-818c-2032c362fd15",
            "created_at": "2023-01-06T13:46:38.306576Z",
            "updated_at": "2025-03-27T02:00:02.800515Z",
            "deleted_at": null,
            "main_name": "Night Dragon",
            "aliases": [
                "G0014"
            ],
            "source_name": "MISPGALAXY:Night Dragon",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673535814,
    "ts_updated_at": 1743041651,
    "ts_creation_date": 1662027447,
    "ts_modification_date": 1662027447,
    "files": {
        "pdf": "https://archive.orkl.eu/b147e8a9007286c55059a19f644a294052c16e36.pdf",
        "text": "https://archive.orkl.eu/b147e8a9007286c55059a19f644a294052c16e36.txt",
        "img": "https://archive.orkl.eu/b147e8a9007286c55059a19f644a294052c16e36.jpg"
    }
}