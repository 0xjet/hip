{
    "id": "04951c45-f969-4d65-9fad-31cf4465df99",
    "created_at": "2023-01-12T15:06:16.769894Z",
    "updated_at": "2025-03-27T02:15:35.573444Z",
    "deleted_at": null,
    "sha1_hash": "72b7490e012937d8ea12604e5da35c1ca984492d",
    "title": "2021-06-03 - FontPack- A dangerous update Attribution secrets- Who is behind stealing credentials and bank card data by asking to install fake Flash Player, browser or font updates-",
    "authors": "",
    "file_creation_date": "2022-05-28T18:29:40Z",
    "file_modification_date": "2022-05-28T18:29:40Z",
    "file_size": 5795268,
    "plain_text": "# FontPack: A dangerous update\n\n**blog.group-ib.com/fontpack**\n\n03.06.2021\n\nAttribution secrets: Who is behind stealing credentials and bank card data by asking to install\nfake Flash Player, browser or font updates?\n\nAttribution is our main focus here at Group-IB Threat Intelligence & Attribution, and it\nbecomes harder every year. The number of unique malicious programs is decreasing while\naffiliate programs (collaborations between threat actors) are on the rise, with the number and\nquality of attacks both going up. Today Nikita Rostovtsev, an analyst at Group-IB Threat\nIntelligence, will show you attribution in practice by examining a malicious landing page that\nGroup-IB specialists are tracking as FontPack. You will see what this page distributes and\nhow it does so, as well as learn other interesting things that Group-IB has uncovered.\n\nFirst and foremost we need to find out who is behind the landing page, down to the specific\nhacking group or particular threat actor. All we know so far is that the page is hosted on\ncompromised websites by injecting JS scripts. The scripts imitate a website crashing and\ndisplay a message saying that users must update their software, e.g., the browser, Adobe\nFlash Player, or fonts. The code name used by our team, FontPack, is based on the decoy\nmethods employed in the campaign we will analyze in this report.\n\n\n-----\n\nThreat actors decide what particular fake to show their victim and how often to do so by\nchanging relevant variables in the script code. According to our data, multiple unconnected\nhackers use the tool.\n\nLet us focus on one campaign whose goal was to deliver the RedLine stealer to victim\ndevices. When successful, threat actors were able to collect their victims' credentials,\nautocomplete field data, and bank card information. Our analysis revealed that, since\nNovember 2020, FontPack has infected at least 20 websites, including six that were involved\nin one campaign. But first things first.\n\nWhat is FontPack?\n\nBy \"landing page\" we mean a target webpage that is shown to users and urges them to\ndownload a malicious file that will then be executed. The FontPack landing page has been\n[known to Threat Intelligence & Attribution researchers since 2018. Other specialists may](https://blog.malwarebytes.com/threat-analysis/2020/02/domen-toolkit-gets-back-to-work-with-new-malvertising-campaign/)\nknow it as \"Domen toolkit\" because of its variable called \"var domen\".\nHow is FontPack injected into websites?\n\nAttacks start with injecting FontPack-containing JS scripts into websites created and\ncontrolled by the threat actors. Compromised legitimate websites are also used for the same\npurpose.\n\n\n-----\n\nA fake window urging the user to update their browser, shown on top of a legitimate website\n\nOften, victims visit websites that they trust and that they have already been visiting for\nmonths, until one day the website asks them to update an outdated plugin. When they do so,\nmalware is downloaded to their computer. This type of attack is the most effective for threat\nactors and the most dangerous for regular users because victims do not suspect an infection\nfrom a website they trust. Readers who do not yet understand what such websites can look\nlike might find the gif below helpful:\n\nSo, what exactly happened there? We see that a user goes to a website that they have\nvisited before. After the victim spends some time there, the website contents starts to visually\n\"break\" and the browser asks the user to update Flash Player so that everything works\nproperly again. The victim does so.\n\n\n-----\n\nLanding page code analysis\n\nTo understand how such attacks work, we looked at the contents of the malicious JS script.\nBy analyzing the website contents, we detected a JS script called \"wp-kernel.js\".\n\nExample of FontPack landing page code showing that a fake website created using it will\nwork both on desktop computers and mobile devices\n\nThe script contents clearly show that, in addition to personal computers, it can infect mobile\ndevices running Android and Blackberry OS, as well as devices that use the mobile browsers\nIEMobile and Opera Mini. The script identifies what browser is used for the connection and\nbased on this information provides the victim with a link to the relevant file. The script\nchanges fake windows by changing the value of the variable var banner:\n\n_Fake browser update window_\n\n\n-----\n\n_Fake font update window_\n\n_Fake Adobe Flash Player update window_\n\nThe variable var startTime sets the time (in milliseconds) after which the user will be shown a\nfake window.\n\nThe variable var linkMobile creates a link to an app for mobile devices (the link is not active\nin this particular case). As a result, in this particular campaign, we could only identify an\ninfection designed for the Windows operating system.\n\nAs mentioned above, when the script is working website contents are visually distorted —\nthis is what the variable var bugs does. For this to happen, the variable must be set to True.\nWhen the variable is set to False, there are no changes to the website.\n\nThe variable oneTimeShow, sets the frequency with which the script functions. If the variable\nis set to True, the script will only function once for every user.\n\n\n-----\n\nIn addition, the script contains a set of 27 language systems for which the fake windows will\nbe shown. Spoiler alert: you will not find anything related to the post-Soviet region there.\n\nThe aim of the report is not to describe how the script works in detail, however, so let us\nmove on.\n\nThe JS script code has the variable var domen with the value browsertelemetry[.]tk. The\ndomain contains an admin panel hosted at https://browsertelemetry[.]tk/admin/login.\n\nThe admin panel uses the Cyrillic alphabet on the authentication page:\n\n_Admin panel used in the FontPack campaign_\n\nUnderground platform profile analysis\n\nIn a report released on February 28, 2020, Malwarebytes researchers showed that the\nlanding page in question was put up for sale on April 10, 2019. In a screenshot provided by\nthe researchers, the thread author is a user with the username xxbtc. The same landing\npage was distributed by users with the usernames grinGo and holeo. It is noteworthy that the\nitem was put up for sale by three different users on different underground platforms.\n\n\n-----\n\nEvery screenshot above has roughly the same text (with some variation) about selling a\nRussian-language landing page with the following content:\n\n\"Script for achieving EXE/APK installations!\n\nThe script is designed for achieving installations from websites/shells/fakes\n\nIt is adapted to both computers and mobile devices\n\nThe JS script connects to any website through <script>\"\n\nInterestingly, six days later xxbtc invited forum users to test MagBo, an exchange for trading\nshells. Let us note this fact and return to it later.\n\n\n-----\n\nMagBo is slowly entering our story…\n\nThe user shared an invite code: CTXDDYMGFJ. According to our data, six users on various\nplatforms posted similar messages with the same invite code.\n\n_Xxtbc, xenys, gonleen, amlogic, grinGo, and pacificcc._\n\nIn addition, a uniting factor for some of these usernames are Jabber and Telegram\nmentioned for communication purposes.\n\nxxxbtc@exploit.im and @xengf\n\n_Xxbtc, kista, holeo, xenys, amlogic, exynos, gringo, and pacificcc._\n\nThe same Telegram account associated with different usernames. \"For the last two days of\nthe offer, the price is $50. Telegram @xengf. A big set for a very low price!\"\n\nIt is highly likely that the above means that these accounts belong to one person. Below is a\nmind map we created that makes our conclusion clearer.\n\n\n-----\n\nInterrelations between different profiles that highly likely belong to one person\n\nHow does MagBo factor in?\n\nAccording to our data, since November 2020 the landing page in question has infected at\nleast 20 websites, including six involved in one campaign, i.e. linked to the domain\nbrowsertelemetry[.]tk. It is worth noting that access to some of these websites was sold on\nMagBo. In addition, posts made by xxxbtc on MagBo included messages about selling logs\nfor November–December 2020.\n\n\n-----\n\nLogs sold on MagBo by a user we are already familiar with: хххbtc. \"Over 6,000 logs for\nNovember December. 800-1,200 logs had cryptos extracted – the rest hasn't been touched\nand hasn't even been checked\"\n\nSo who is the author of the landing page?\n\nA more in-depth analysis revealed that the landing page we call FontPack was put up for\nsale by a seller with the username DR.PREDATOR in January 2018.\n\n\n-----\n\nHistorical data from our TI&A system: the landing page in question was first put up for sale\nas early as January 2018.\n\nIn late 2019, the project was shut down and made publicly available, which meant that\nanyone could download it for free.\n\n_In late 2019, the user DR.PREDATOR made the landing page publicly available. \"Because_\n_the service has closed (…), I would like to publish Install Pack (with no obfuscation and_\n_binding) + Instructions in an archive (…) Enjoy, because some have already started reselling_\n_it\"_\n\nThe structure of the published project is extremely similar to what xxbtc offers. Since October\n10, 2019, however, xxbtc has been offering a set that includes the script from\nDR.PREDATOR.\n\n\n-----\n\nAn amazing coincidence: xxbtc also published a pack that included DR.PREDATOR's script.\n\"Scam websites for delivering your exe! LAST DAYS OF THE OFFER. I AM SELLING A SET\nOF 15 websites for delivering exe with different topics + a script for exe/apk from dr.predator\n(...) Telegram @xengf\n\nWhat does the landing page distribute?\n\nAt the time of our analysis, it was established that one of the campaigns involving this\nlanding page distributed several types of malware called RedLine Stealer. We will return to\nthis later.\n\nThe campaign involves the following domains:\n\nAs can be seen, two bitbucket.org repositories were used for downloading:\n\nhttps://bitbucket[.]org/FlashPlayerUpdate/flashplayer\n\nhttps://bitbucket[.]org/AdobeFlashUpdate/flashplayer\n\nBelow are screenshots taken on April 19, 2021 showing the two repositories.\n\nThe download links led to a file and a malware-containing archive.\n\nFlashPlayer.exe (from the zip file) – SHA1 1ea09cd229b34951007f81c8e5acd323386e4fb6\n\nFlashPlayer.exe - SHA1 36d08c8ab8e161923403cd89bdf3600fccd6629a\n\nDetonation in Group-IB THF Polygon, our system for launching malware in an isolated\nenvironment, revealed that these files are samples of RedLine Stealer.\n\n\n-----\n\n_Identifying the type of malware: The screenshot shows the result of detonating the files in_\n_Group-IB THF Polygon, our system for launching malware in an isolated environment. The_\n_files are RedLine Stealer samples._\n\nWhen executed, the files send the following type of HTTP requests to their command-andcontrol (C&C) server:\n\n\n-----\n\nIn summary, so far our analysis revealed that:\n\nThe FontPack landing page is a set of fake webpages designed for tricking users into\ndownloading a malicious file.\n\nFontPack is distributed as a JS script.\n\nThe JS script can be installed on a compromised or threat actor-controlled server.\n\nFontPack contains fakes mimicking a browser, font or Adobe Flash Player update.\n\nFontPack works on both desktops and mobile browsers.\n\nThe aim of the landing page is to determine what browser version is used and, based on that\ninformation, to provide a link for downloading a particular file.\n\n\n-----\n\nOne of the analyzed campaigns involved delivering RedLine Stealer.\n\nWhat is RedLine Stealer capable of?\n\nThe hacker community learned about RedLine Stealer in early 2020, when it was put up for\nsale for the first time on multiple underground forums.\n\nThe first post about selling RedLine Stealer made on an underground forum on February 19,\n2019\n\nRedLine quickly became popular and has involved over 230 C&C servers since October\n2020 according to our data. The stealer is written in C# and its functionality is typical for this\ntype of malware:\n\n1\n\nIt collects credentials, cookies, autocomplete field data, and credit card information from all\nChromium/Gecko-based browsers\n\n2\n\nIt collects data from FTP and IM clients\n\n3\n\nIt identifies countries where the stealer will not function\n\n4\n\n\n-----\n\nIt collects information about the victim s PC\n\n5\n\nIt manages anti-duplicate logs settings in the admin panel\n\n6\n\nIt deletes itself\n\n7\n\nIt performs tasks in four different ways:\n\nThese ways are:\n\n1. It downloads a file to a specified path through a direct link\n2. It injects a 32-bit file downloaded through a direct link into another file, which must be\n\nspecified\n3. It downloads a file to a specified path through a direct link and later launches it\n4. It opens a link in the default browser\n\nInterestingly, websites compromised as early as February 2021 still deliver payloads despite\nthe stealer's C&C server no longer being available.\n\nAs a closing remark, the campaign is only one of many that involve this landing page. The\nfake updates are especially interesting considering that Flash Player support was\ndiscontinued in early 2021.\n\n\n-----\n\nIndicators of compromise\n\nShare\n\nReceive insights on the latest cybercrime trends\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-06-03 - FontPack- A dangerous update Attribution secrets- Who is behind stealing credentials and bank card data by asking to install fake Flash Player, browser or font updates-.pdf"
    ],
    "report_names": [
        "2021-06-03 - FontPack- A dangerous update Attribution secrets- Who is behind stealing credentials and bank card data by asking to install fake Flash Player, browser or font updates-.pdf"
    ],
    "threat_actors": [
        {
            "id": "9f101d9c-05ea-48b9-b6f1-168cd6d06d12",
            "created_at": "2023-01-06T13:46:39.396409Z",
            "updated_at": "2025-03-27T02:00:03.074969Z",
            "deleted_at": null,
            "main_name": "Earth Lusca",
            "aliases": [
                "CHROMIUM",
                "ControlX",
                "Red Dev 10",
                "RedHotel",
                "Red Scylla",
                "TAG-22",
                "BRONZE UNIVERSITY",
                "AQUATIC PANDA",
                "Charcoal Typhoon",
                "BountyGlad"
            ],
            "source_name": "MISPGALAXY:Earth Lusca",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "6abcc917-035c-4e9b-a53f-eaee636749c3",
            "created_at": "2022-10-25T16:07:23.565337Z",
            "updated_at": "2025-03-27T02:02:09.868522Z",
            "deleted_at": null,
            "main_name": "Earth Lusca",
            "aliases": [
                "Bronze University",
                "Charcoal Typhoon",
                "Chromium",
                "Red Dev 10",
                "Red Scylla"
            ],
            "source_name": "ETDA:Earth Lusca",
            "tools": [
                "Agentemis",
                "AntSword",
                "BIOPASS",
                "BIOPASS RAT",
                "BadPotato",
                "Behinder",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "Doraemon",
                "FRP",
                "Fast Reverse Proxy",
                "FunnySwitch",
                "HUC Port Banner Scanner",
                "KTLVdoor",
                "Mimikatz",
                "NBTscan",
                "POISONPLUG.SHADOW",
                "PipeMon",
                "RbDoor",
                "RibDoor",
                "RouterGod",
                "SAMRID",
                "ShadowPad Winnti",
                "SprySOCKS",
                "WinRAR",
                "Winnti",
                "XShellGhost",
                "cobeacon",
                "fscan",
                "lcx",
                "nbtscan"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "d53593c3-2819-4af3-bf16-0c39edc64920",
            "created_at": "2022-10-27T08:27:13.212301Z",
            "updated_at": "2025-03-27T02:00:55.529662Z",
            "deleted_at": null,
            "main_name": "Earth Lusca",
            "aliases": [
                "Earth Lusca",
                "TAG-22",
                "Charcoal Typhoon",
                "CHROMIUM",
                "ControlX"
            ],
            "source_name": "MITRE:Earth Lusca",
            "tools": [
                "Mimikatz",
                "PowerSploit",
                "Tasklist",
                "certutil",
                "Cobalt Strike",
                "Winnti for Linux",
                "Nltest",
                "NBTscan",
                "ShadowPad"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1673535976,
    "ts_updated_at": 1743041735,
    "ts_creation_date": 1653762580,
    "ts_modification_date": 1653762580,
    "files": {
        "pdf": "https://archive.orkl.eu/72b7490e012937d8ea12604e5da35c1ca984492d.pdf",
        "text": "https://archive.orkl.eu/72b7490e012937d8ea12604e5da35c1ca984492d.txt",
        "img": "https://archive.orkl.eu/72b7490e012937d8ea12604e5da35c1ca984492d.jpg"
    }
}