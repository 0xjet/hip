{
    "id": "6e50a796-b0a8-4ce6-88ed-1ca899f86186",
    "created_at": "2023-01-12T14:59:16.034769Z",
    "updated_at": "2025-03-27T02:15:47.803335Z",
    "deleted_at": null,
    "sha1_hash": "63f015121943ead54cab77405b18a8df03857b6a",
    "title": "2021-03-23 - ModPipe Malware has a new module that siphons Credit Card Data",
    "authors": "",
    "file_creation_date": "2022-05-28T16:55:57Z",
    "file_modification_date": "2022-05-28T16:55:57Z",
    "file_size": 1603737,
    "plain_text": "# ModPipe Malware has a new module that siphons Credit Card Data\n\n**[foregenix.com/blog/modpipe-malware-has-a-new-module-that-siphons-payment-card-data](https://www.foregenix.com/blog/modpipe-malware-has-a-new-module-that-siphons-payment-card-data)**\n\n23/03/21 11:58\n\nBy [Mark Shelhart](https://www.foregenix.com/blog/author/mark-shelhart)\nCybersecurity researchers at Foregenix have discovered what appears to be a new module\n[for the ModPipe malware, previously reported by ESET in November 2020. Alarmingly, this](https://www.eset.com/us/about/newsroom/press-releases/eset-research-discovers-modpipe-backdoor-targeting-pos-software-used-by-thousands-of-restaurants/)\nnew module has the ability to siphon sensitive Track1 and Track2 data from payment\n\n\n-----\n\nsystems, a featureset that had not previously been disclosed. Like the originally analysed\nand documented ModPipe, this module is most prevalent in the hospitality sector. This\nmalware should be considered a high risk.\n\nThe CCSiphon (aka “JHook”) module was observed in the wild targeting the CCS.exe\napplication which is at the core of the RES 3700 POS management system, made by\nOracle’s Micros (Oracle Food and Beverage and Oracle Hospitality). What’s fascinating\nabout the module is that it strategically inserts itself between the Micros application and the\ndecryption mechanism used by the system. This “app in the middle” listens when the Micros\napplication needs to decrypt the payment card data. While Micros thinks it’s talking to the\nofficial Microsoft DPAPI decryption routine, it is actually passing data that requires decryption\ndirectly to the malware. The siphon then leverages the actual crypto routines, quietly\nexamining the data returned for evidence that it contains Track data. If Track data is found,\nthe CCSiphon malware quietly writes the data to a buffered communications channel to be\nharvested later.\n\nForegenix researchers point out that while this sample of the new module is targeting the\nMicros RES 3700 system specifically, it’s dynamic mode of operation, (controlled by a\nconfiguration string presented to the malware module) enables it to attack any payment\nprocessing application. This “configuration string” defines the details of how the application\nhook should be implemented and which payment process should be targeted.\n\nThe malware even has a fallback mechanism that could be used where a similar hooking\napproach is applied to the fundamental mechanism the system uses to move memory\ncontents around. Should a more specific approach be unsuitable, this backup will provide\naccess to the target data.\n\nThis siphon module is basically “file-less” in its design. The module is inserted into memory\ndirectly from the C2 channel. The siphoned data is also written to a location in memory so it\nleaves little-or-no footprint on the system to be detected. At the time of this article, none of\nthe antivirus companies seem to have detected this code.\n\nWhile the original ModPipe malware was not attributed to any particular attack group,\nForegenix identified similarities comparing CCSiphon to the RDFScanner module in the\n_Boostwrite malware reported by Mandiant in 2019. That attack was attributed to Fin7, and_\ntargeted NCR’s Aloha Point of Sale system. Additional research performed by Foregenix\nsuggests that ModPipe may have passed unnoticed for a considerable period of time, with\nsimilar variants being available on VirusTotal also going back to 2019.\n\n“Attackers are certainly getting more sophisticated”, says Chris Hague, Global Manager\nDigital Forensics & Incident Response at Foregenix. “...This may be a game changer for PCI\nSSF (formerly PA-DSS) and other security standards.”. It was also pointed out that the\napproach taken by this malware differs significantly from traditional “memory scrapers”. The\nlatter generally scan memory on some form of timed cycle, leaving small windows of\n\n\n-----\n\nopportunity where payment details are missed by the malware. With the approach\nimplemented by this variant of ModPipe every payment card processed can and would be\nintercepted by the malware. Coupled with it’s stealthy operation, this could pose a significant\nrisk to retailers.\n\nForegenix is a cybersecurity company; specializing in Incident Response and Digital\nForensics.\n\nContact: info@foregenix.com.\n\nResearch/Authors: Niall Newman and Mark Shelhart\n[Forensics and Incident Response](https://www.foregenix.com/blog/topic/forensics-and-incident-response)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-03-23 - ModPipe Malware has a new module that siphons Credit Card Data.pdf"
    ],
    "report_names": [
        "2021-03-23 - ModPipe Malware has a new module that siphons Credit Card Data.pdf"
    ],
    "threat_actors": [
        {
            "id": "bfded1cf-be73-44f9-a391-0751c9996f9a",
            "created_at": "2022-10-25T15:50:23.337107Z",
            "updated_at": "2025-03-27T02:00:55.445946Z",
            "deleted_at": null,
            "main_name": "FIN7",
            "aliases": [
                "FIN7",
                "GOLD NIAGARA",
                "ITG14",
                "Carbon Spider",
                "ELBRUS",
                "Sangria Tempest"
            ],
            "source_name": "MITRE:FIN7",
            "tools": [
                "Mimikatz",
                "AdFind",
                "JSS Loader",
                "HALFBAKED",
                "REvil",
                "PowerSploit",
                "CrackMapExec",
                "Carbanak",
                "Pillowmint",
                "Cobalt Strike",
                "POWERSOURCE",
                "RDFSNIFFER",
                "SQLRat",
                "Lizar",
                "TEXTMATE",
                "BOOSTWRITE"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "f4f16213-7a22-4527-aecb-b964c64c2c46",
            "created_at": "2024-06-19T02:03:08.090932Z",
            "updated_at": "2025-03-27T02:05:17.387119Z",
            "deleted_at": null,
            "main_name": "GOLD NIAGARA",
            "aliases": [
                "Carbanak",
                "Carbon Spider ",
                "FIN7 ",
                "Navigator ",
                "Sangria Tempest ",
                "TelePort Crew ",
                "Calcium "
            ],
            "source_name": "Secureworks:GOLD NIAGARA",
            "tools": [
                " Carbanak",
                " Cobalt Strike",
                " DICELOADER",
                " DRIFTPIN",
                " GGLDR",
                " GRIFFON",
                " JSSLoader",
                " Meterpreter",
                " OFFTRACK",
                " PILLOWMINT",
                " POWERTRASH",
                " SUPERSOFT",
                " TAKEOUT",
                " TinyMet",
                "Bateleur"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "bb8702c5-52ac-4359-8409-998a7cc3eeaf",
            "created_at": "2023-01-06T13:46:38.405479Z",
            "updated_at": "2025-03-27T02:00:02.82533Z",
            "deleted_at": null,
            "main_name": "FIN7",
            "aliases": [
                "JokerStash",
                "ATK32",
                "G0046",
                "Coreid",
                "Carbanak",
                "Sangria Tempest",
                "CARBON SPIDER",
                "GOLD NIAGARA",
                "G0008",
                "ELBRUS",
                "Carbon Spider"
            ],
            "source_name": "MISPGALAXY:FIN7",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "d85adfe3-e1c3-40b0-b8bb-d1bacadc4d82",
            "created_at": "2022-10-25T16:07:23.619566Z",
            "updated_at": "2025-03-27T02:02:09.890982Z",
            "deleted_at": null,
            "main_name": "FIN7",
            "aliases": [
                "APT-C-11",
                "ATK 32",
                "Gold Niagara",
                "ITG14",
                "TAG-CR1"
            ],
            "source_name": "ETDA:FIN7",
            "tools": [
                "7Logger",
                "Agentemis",
                "Anunak",
                "Astra",
                "BIOLOAD",
                "BIRDWATCH",
                "Bateleur",
                "Boostwrite",
                "CROWVIEW",
                "Carbanak",
                "Cobalt Strike",
                "CobaltStrike",
                "DICELOADER",
                "DNSMessenger",
                "FOWLGAZE",
                "HALFBAKED",
                "JSSLoader",
                "KillACK",
                "LOADOUT",
                "Lizar",
                "Meterpreter",
                "Mimikatz",
                "POWERPLANT",
                "POWERSOURCE",
                "RDFSNIFFER",
                "SQLRAT",
                "Sekur",
                "Sekur RAT",
                "TEXTMATE",
                "Tirion",
                "VB Flash",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535556,
    "ts_updated_at": 1743041747,
    "ts_creation_date": 1653756957,
    "ts_modification_date": 1653756957,
    "files": {
        "pdf": "https://archive.orkl.eu/63f015121943ead54cab77405b18a8df03857b6a.pdf",
        "text": "https://archive.orkl.eu/63f015121943ead54cab77405b18a8df03857b6a.txt",
        "img": "https://archive.orkl.eu/63f015121943ead54cab77405b18a8df03857b6a.jpg"
    }
}