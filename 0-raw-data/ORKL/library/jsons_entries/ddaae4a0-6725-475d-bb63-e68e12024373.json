{
    "id": "ddaae4a0-6725-475d-bb63-e68e12024373",
    "created_at": "2023-01-12T14:58:58.761906Z",
    "updated_at": "2025-03-27T02:05:57.384063Z",
    "deleted_at": null,
    "sha1_hash": "2054ac1dde0baa5860f18ad93551041fd149bc57",
    "title": "2010-03-10 - ZeuS Banking Trojan Report",
    "authors": "",
    "file_creation_date": "2022-05-28T19:53:23Z",
    "file_modification_date": "2022-05-28T19:53:23Z",
    "file_size": 359126,
    "plain_text": "# ZeuS Banking Trojan Report\n\n**secureworks.com/research/zeus**\n\nWednesday, March 10, 2010\n\n**Author: Kevin Stevens and Don Jackson, Security Researchers**\n\nSecureWorks Counter Threat Unit SM (CTU)\n**Date: March 10, 2010**\n\n## Introduction\n\n\nThis Threat Analysis from the SecureWorks CTUSM provides a brief overview of the current\nversion of ZeuS and its modules, along with the market pricing. We will then see how ZeuS is\nactively being used and the irony of how the criminals themselves can sometimes be the\nvictims.\n\nZeuS is a well-known banking Trojan horse program, also known as crimeware. This trojan\nsteals data from infected computers via web browsers and protected storage. Once infected,\nthe computer sends the stolen data to a bot command and control (C&C) server, where the\ndata is stored.\n\nZeuS is sold in the criminal underground as a kit for around $3000-4000, and is likely the one\nmalware most utilized by criminals specializing in financial fraud. ZeuS has evolved over time\nand includes a full arsenal of information stealing capabilities:\n\nSteals data submitted in HTTP forms\nSteals account credentials stored in the Windows Protected Storage\nSteals client-side X.509 public key infrastructure (PKI) certificates\nSteals FTP and POP account credentials\nSteals/deletes HTTP and Flash cookies\nModifies the HTML pages of target websites for information stealing purposes\nRedirects victims from target web pages to attacker controlled ones\nTakes screenshots and scrapes HTML from target sites\nSearches for and uploads files from the infected computer\nModifies the local hosts file (%systemroot%\\system32\\drivers\\etc\\hosts)\nDownloads and executes arbitrary programs\nDeletes crucial registry keys, rendering the computer unable to boot into Windows\n\n## Zeus Author Protects Code with Hardware-Based Licensing System\n\n\n-----\n\nThe latest version of ZeuS as of this date is 1.3.4.x and is privately sold. The author has\ngone to great lengths to protect this version using a Hardware-based Licensing System. The\nauthor of Zeus has created a hardware-based licensing system for the Zeus Builder kit that\nyou can only run on one computer. Once you run it, you get a code from the specific\ncomputer, and then the author gives you a key just for that computer. This is the first time we\nhave seen this level of control for malware.\n\n## Zeus Versions\n\nThe version number breakdown is as follows (from the ZeuS manual):\n\nWhat do the numbers [signify] in the version?\n\na.b.c.d\n\na(1) - a complete change in the bot. This has never changed from 1.\n\nb(3) - Major changes that cause complete or partial incompatibility with the previous\n\nversions. Recently we moved from version 2 to version 3.\n\nc(2) - This is for bug fixes, improvements, and adding features.\n\nd(1) - This for a small revision in the code to make the malware undetectable by AV vendors.\n\nThe latest public version the CTU has encountered is 1.2.7.19. This version is actively being\ntraded and has the Firefox form grabber module enabled. The Firefox module allows the\nZeuS trojan to grab data out of any forms completed on the Firefox web browser. The\nwebinjects text file, which allows for the injection of fields into the Internet Explorer (IE) web\nbrowser, does not work with Firefox and only works with IE. The function of the webinjects\ntext file is to display an extra field for a victim to complete when they log onto a banking site\n(see Figures 1 and 2). The extra field asks for data in addition to the username and\npassword. This technique is similar to phishing, but the extra field is not part of the original\nsite.\n\nThe current list of modules that work with ZeuS are as follows:\n\n**Zeus Kit for Version 1.3.4.x ($3,000 to $4,000)**\n\nThe Private Version of the Zeus Kit is running between $3,000 and $4,000. The latest\nprivate version of ZeuS, as of this date, is 1.3.4.x. This private version seems to be\nonly sold by the author, and he is protecting all of its functionality through the hardware\nl I.D., locking which we mentioned previously.\n**Backconnect $1500**\n\nThe backconnect module allows an attacker to 'connect back' to the infected computer\nand make financial transactions from it. This way, banks that try to track where money\ntransfers originate will always trace it back to the computer of the account holder.\n\n\n-----\n\n**Firefox form grabber $2000**\nThe Firefox form grabber module grabs data out of fields that are submitted using the\nFirefox web browser. This data can include personally identifiable information (PII) as\nwell as usernames and passwords for bank accounts, trading accounts, online\npayment accounts, and anything else that would require the use of a username and\npassword.\n**Jabber (IM) chat notifier $500**\nThe Jabber module allows an attacker to receive stolen data in \"real time\". If a bank\naccount is being protected with a token that generates random numbers, then the\nattacker can access the victim's account in real time after the victim logs in using the\ntoken. An example of what would be sent via the Jabber module is:\n\nRequest Type :Domestic Wire\nName :John Smith\nAddress :1234 Main Street\nCity :Atlanta GA 12345\nPayee Name :Some Bank\nMemo :Credit to acc:1111111111\n\nBeneficiary Account :Checking #0000001234\nBeneficiary Address 1 :Georgia\nPayee Bank ID :0123456\nBank Name :Some Bank\nAddr1 :Atlanta Some Bank\nAmount :1500000.00\nFrom Account :My Money Market #123456789\nDate Posted :01/01/10\nTime Posted :2:00 PM\n\n### VNC (Virtual Network Computing) private module $10,000\n\nThe VNC module is similar to the backconnect module, except that it allows you to establish\na fully functioning virtual connection. The attacker can take control of the infected computer\nwithout the victim being aware of it. Essentially, the VNC provides the hacker with not just a\nNetwork Proxy but with a Total Presence Proxy (it is the total package), allowing the hacker\nto use all of the victim's hardware and software, including its browser, so as to avoid a bank's\nfraud detection systems. Essentially, it allows the hacker to get around many hardwarebased authentication systems. Additionally, if the victim is doing large dollar transactions and\nis required to insert a smartcard into their computer that the bank will recognize, the hacker\nwill have access to that smartcard via the VNC module.\n\n### Windows 7/Vista Support $2000\n\n\n-----\n\nThis module allows the ZeuS trojan to infect these Windows 7 and Vista systems. Without it,\nthe botnet controller is limited to Windows XP systems.\n\n## ZeuS 1.4 Adds Polymorphic Encryption and Web Injects for Firefox\n\nThe authors of ZeuS are currently developing 1.4 which is being beta tested. It includes two\nkey components which make the ZeuS Banking Trojan even more stealthy and\ncomprehensive, due to its ability to also do web injects for the Firefox browser. The\ncomponents are:\n\n1. Web Injects for Firefox\n2. Polymorphic Encryption: The 1.4 version of ZeuS will enable the ZeuS Trojan to re\nencrypt itself each time it infects a victim, thus making each infection unique. The 1.4\nversion also enables the ZeuS file names to be randomly generated, thus each\ninfection will contain different file names. This will make it very difficult for anti-virus\nengines to identify the ZeuS Banking Trojan on the victims' system.\n\n## How Zeus Works\n\nZeuS performs stolen data exfiltration and remote commands via encrypted HTTP POST\nrequests to a Command and Control web server. The encryption ZeuS uses is RC4, with a\nkey that is embedded in the binary. While the primary function of this malware is to commit\nfinancial fraud, its general information stealing behaviors make it a threat to all enterprises.\nBasic credential theft is not targeted, meaning the ZeuS botnet controller does not run the\nbotnet to just see what it can get. The botnet controller usually has a financial target in mind.\nThe criminals typically search for data of interest to directly derive value or to sell the data to\nanother criminal.\n\nSeveral of these tasks can be done \"on-demand\" via the HTTP-based control panel, and\ndirected to selected infected computers. These on-demand tasks may be performed via\nspecial scripts that can be executed on select systems. These scripts can be used to take\nscreenshots of infected systems or to do ZeuS binary updates.\n\n\n-----\n\n_Figure 1. View of a login page for a financial site._\n\n_Figure 2. View of the same page from a computer infected with ZeuS. Note it includes three_\n_new fields._\n\nZeuS includes these capabilities to assist with automated clearing house (ACH) fraud. ACH\nis an electronic network for financial transactions in the United States. It is used for online bill\npayments, payroll direct deposits from employers and to transfer money from one account to\nanother. ZeuS is aimed at taking advantage of ACH to transfer money to criminal accounts.\n\n### How to detect the ZeuS Banking Trojan on your computer\n\n\n-----\n\nComputers infected with this version of ZeuS will have the following files and folders\ninstalled. The location depends on whether the victim has Administrator rights. The files will\nmost likely have the HIDDEN attribute set to hide them from casual inspection.\n\nWith Administrator rights:\n\n%systemroot%\\system32\\sdra64.exe (malware)\n%systemroot%\\system32\\lowsec\n%systemroot%\\system32\\lowsec\\user.ds (encrypted stolen data file)\n%systemroot%\\system32\\lowsec\\user.ds.lll (temporary file for stolen data)\n%systemroot%\\system32\\lowsec\\local.ds (encrypted configuration file)\n\nWithout Administrator rights:\n\n%appdata%\\sdra64.exe\n%appdata%\\lowsec\n%appdata%\\lowsec\\user.ds\n%appdata%\\lowsec\\user.ds.lll\n%appdata%\\lowsec\\local.ds\n\nZeuS also makes registry changes to ensure that it starts up with Administrator privileges:\n\nHKLM\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\nFrom:\n\"Userinit\" = \"C:\\WINDOWS\\system32\\userinit.exe\"\nTo:\n\"Userinit\" =\n\"C:\\WINDOWS\\system32\\userinit.exe,C:\\WINDOWS\\system32\\sdra64.exe\"\n\nWithout Administrator rights:\n\nHKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\nAdd:\n\"Userinit\" = \"C:\\Documents and Settings\\&lt;user&gt;\\Application Data\\sdra64.exe\"\n\nThe sdra64.exe program uses process injection to hide its presence in the list of running\nprocesses. Upon startup, it will inject code into winlogon.exe (if Administrator rights\navailable) or explorer.exe (for non-Administrators) and exit. The injected code infects other\nprocesses to perform its data theft capabilities.\n\n### Types of data being targeted by ZeuS\n\n\n-----\n\nThe following figures illustrate what type of data is stolen and collected from infected\ncomputers. The list of infected systems shown in Figure 3 can range from the hundreds to\nthousands. The number of infected systems usually depends on how long the botnet is\nactive and how well the bot controller spreads the malware.\n\n_Figure 3. List of infected systems. Each system is a folder on the C&C server._\n\n_Figure 4. Sample of collected information from an infected system for a social networking_\n_site._\n\nFigure 4 illustrates a fragment of information collected from an infected system.\n\nThis listing begins with the bot id, which is usually the name of the affected computer.\nNext is the name of the botnet that includes the affected computer. Also listed is the bot\nversion.\nNext appears the IPv4 IP address of the affected computer and the country it belongs\nto. This information is not always accurate because a host with an internal IP will not\ndisplay correctly.\nFurther down the list appears the OS\n\n\n-----\n\nThis log was captured from an Internet Explorer web browser used to visit a popular\nsocial networking website.\nZeuS captured the language used, full page parameters, email address, password, and\nanything else that was being generated from the login attempt.\n\n_Figure 5. Sample of banking information collected from an infected system._\n\nFigure 5 is similar in function to the previous listing, but this time ZeuS is stealing the login\ninformation for a bank account. Figure 6 shows the same user transferring money from\nchecking to savings. These examples demonstrate the risks that infected computers and\ntheir users are susceptible to.\n\n_Figure 6. Sample of banking transaction information collected from an infected system._\n\n\n-----\n\n_Figure 7. PFX (PKCS #12) Digital Certificate file collected from an infected system._\n\nZeuS even steals PFX (PKCS #12) Digital Certificates that the victim's web browser uses to\nauthenticate to a site (Figure 7). So the victim is still vulnerable if their banking site uses\nassigned certificates.\n\n_Figure 8. ZeuS server control panel, operating system statistics._\n\nFigure 8 shows a ZeuS server using the 1.2.4.2 version control panel. The screen displays\ntotals of the bots and what OS version they are running, the most popular being Windows XP\nProfessional SP3. This ZeuS bot also infected Vista users, which means the bot controller\npaid extra for the Vista/Windows 7 module.\n\n\n-----\n\n_Figure 9. ZeuS server control panel, statistics summary._\n\nFigure 9 shows the same botnet, listing bots by country. It lists the most prevalent country as\nBG (Bulgaria), but according to reports from bot operators, this value is not accurate\nbecause ZeuS could not determine the country listing from internal IP addresses. Note that\nthis botnet has 1,827 infected computers (bots) in it and has logged 551,492 reports.\n\n### Stolen ZeuS data cache\n\nNow we will take a look at how botnet data gets stolen and leaked. Figure 10 shows a botnet\ncontroller looking for a partner for his ZeuS botnet.\n\n_Figure 10. Message from botnet controller looking for business partner._\n\nNow his ZeuS server gets hacked and the database is posted online. The download contains\nthe entire database plus the server-side ZeuS PHP files. The attacker is even happy enough\nto tell you what server he got it from.\n\n\n-----\n\n_Figure 11. Message advertising hacked ZeuS server content._\n\n### Data Stolen by ZeuS\n\nThe total size of the PHP files for the ZeuS server is 20MB, and the stolen database is\n900MB. The database contained login credentials from 1,827 victims located in the US, UK,\nCanada, Europe, etc. These login credentials were for banking, stock trading, credit union,\nonline payment, insurance, social networking, government, and military accounts. The bank\naccount, credit union, stock trading, and online payment credentials were for many large and\nmedium sized institutions in the US, UK and Canada.\n\n\n-----\n\n_Figure 12. Message listing account credentials from the ZeuS database._\n\nFigure 12 shows the same user posting account usernames and passwords to try to prove\nthat there is valuable data in the stolen ZeuS database file.\n\n\n-----\n\n_Figure 13. Message explaining how to import the ZeuS database in MySQL._\n\nThe same user then gives details on how to import the database into a MySQL server so that\nanyone can start sorting through the data. He also gives the username and password for the\nlogin. Figure 13 mentions the same person that was looking for a partner in Figure 10. The\nCTU has observed other ZeuS databases for sale on various underground black markets.\nTheir size is typically over 10GB, which is a botnet of approximately 23,000 infected\ncomputers (bots).\n\n## How to Protect Yourself from ZeuS\n\nThe CTU recommends that businesses and home users carry out online banking and\nfinancial transactions on isolated workstations that are not used for general Internet\nactivities, such as web browsing and reading email which could increase the risk of infection.\n\nBusinesses may even consider using an alternative operating system for workstations\naccessing sensitive or financial accounts. Keep your antivirus, operating system and\nsoftware patches up to date. Also do not open suspicious e-mail attachments or links from\npeople that you do not know and even if you do know them, check with them to find out if\nthey sent you something prior to opening the email. Additionally, awareness for both\ncustomers and employees is crucial. In particular, employees who interface with clients\nshould be made aware of these types of threats to help triage potential victims.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2010/2010-03-10 - ZeuS Banking Trojan Report.pdf"
    ],
    "report_names": [
        "2010-03-10 - ZeuS Banking Trojan Report.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673535538,
    "ts_updated_at": 1743041157,
    "ts_creation_date": 1653767603,
    "ts_modification_date": 1653767603,
    "files": {
        "pdf": "https://archive.orkl.eu/2054ac1dde0baa5860f18ad93551041fd149bc57.pdf",
        "text": "https://archive.orkl.eu/2054ac1dde0baa5860f18ad93551041fd149bc57.txt",
        "img": "https://archive.orkl.eu/2054ac1dde0baa5860f18ad93551041fd149bc57.jpg"
    }
}