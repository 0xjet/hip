{
    "id": "94eb3d2e-61fd-4b93-9a93-5f484a5a2213",
    "created_at": "2022-11-23T12:04:47.522178Z",
    "updated_at": "2025-03-27T02:12:36.945685Z",
    "deleted_at": null,
    "sha1_hash": "0c20814ecd9a30f2a6851d52215b9a112e73f704",
    "title": "VB2021 paper: The Keksec botnets we observed in the past year",
    "authors": "",
    "file_creation_date": "2021-08-23T14:41:22Z",
    "file_modification_date": "2021-08-23T14:45:45Z",
    "file_size": 10661341,
    "plain_text": "#### tulingming@360.cn\n\n\n**7 - 8 October, 2021 / vblocalhost.com**\n\n\n-----\n\n**ABSTRACT**\n\nThe Keksec group was created in 2016 by a number of experienced botnet actors. They kept silent for a period of time in\n2020, and resumed activity after August 2020 with nearly 20 botnet campaigns detected by us. In this paper we will study\nthose campaigns in detail in terms of samples, exploits and C2 servers. Our analysis depicts the big picture of Keksec\nbotnets since August 2020 and we believe that it will help defenders to better detect and mitigate against future botnet\nthreats from Keksec and other similar groups.\n\n**1. INTRODUCTION**\n\nWe have seen a rapid proliferation of Linux malware/botnets in recent years. While it’s not uncommon to find that many of\nthem were created by script kiddies using easily obtained malware kits (e.g. Mirai and Gafgyt source code), according to\nour data over 50% of them were created by a relatively small number of professional actors who have persistence in\noperating Linux botnets. Compared with script kiddies, they usually have more resources and are more skilful, and are thus\nworthy of more attention.\n\nThe Keksec group is just one such threat actor. It became well known for building the Necro/Freakout botnet early this\nyear. Further digging shows that it has a long history of running DDoS botnets, with the first one traced back to 2016.\nInterestingly, the members of the Keksec group were very open in showing off their attacking activities. For example, they\nused to publicize their invasions to a public billboard on social media. They also created an open directory in pastebin.com\nto hold their source and attack tools. The ease of accessing this information has helped us summarize the high profile group\nas follows:\n\n - Keksec group was built in 2016 by a few experienced botnet actors.\n\n - They preferred DDoS and miner types of botnets.\n\n - They had a rich set of popular botnet kits targeting both Windows and Linux machines.\n\nFor reasons unknown to us, the group kept silent for a period in 2020. Our data shows that their hacking activities were not\nresumed until August 2020. We detected nearly 20 botnet campaigns after that time. Detailed studies have been carried out\non the collected data in terms of samples, exploits, and C2 servers. With the help of passive DNS, we obtained interesting\nresults, which make us believe that it is possible to depict the big picture of Keksec botnets since August 2020.\n\nThe remainder of this paper is organized as follows: in Section 2, we summarize the nearly 20 campaigns we detected since\n2020/08; in Sections 3, 4, and 5, we analyse those campaigns separately in terms of exploits, malware families and operations.\n\nTo summarize, the contributions of this paper are as follows:\n\n - We analyse how the Keksec group exploited a large number of vulnerabilities to attack both Linux and Windows\nmachines, especially how they quickly used some 1-day exploits.\n\n - We summarize the three major botnet families that have been heavily used by Keksec.\n\n - We demonstrate their techniques in terms of code reuse, IRC protocol, DGA and Tor.\n\n - We deduce the sample delivering and updating patterns.\n\n - Plenty of C2 infrastructure was owned by this group.\n\nThe C2 infrastructures we found are given in the Appendix.\n\n**2. CAMPAIGNS**\n\nWe analysed the historical activities of Keksec by combing the attack activities from 2020/08 to the present, starting with\nsamples and exploits.\n\nFirst, we summarized the corresponding YARA rules by analysing the historical samples, and scanned back through the\nsample database to find the hit samples. Then we grouped them by sample similarity clustering and, using manual\ninspection, removed the false positive samples that clearly did not belong to Keksec, leaving about 5,000. We use this as a\nseed to expand the sample set through our own threat intelligence mining system, correlating queries on capture time,\nexploit, and some other relevant attributes. In the past year we captured a total of 23 exploits, 5,564 samples, and three\nmalware families (ignoring variant classification).\n\nWe use these data as a basis to comb through Keksec’s historical attack activity. We generated a chart showing chronicled\nKeksec attacks (Figure 1).\n\nWe can see that Keksec launched scans and attacks on targets across the network almost non-stop. Our honeypots see new\nvariants and exploits all the time, with the exception of some occasional breaks. When a new exploit is introduced, the\nscans increase significantly.\n\nThe year-long attack campaign can be divided into two phases; high-frequency attacks are maintained until December\n2020, and resumed in January 2021, when Keksec starts spreading the brand new malware family Necro [1].\n\n\n-----\n\n_Figure 1: Chronicled Keksec attacks._\n\n**3. EXPLOITS**\n\nKeksec launches two types of scanning attacks, one using a dedicated scanning server, and the other using the sample’s\nbuilt-in scanning capabilities. We do not distinguish between these two scanning methods, and only focus on the scan\npayload information for statistics.\n\nWe counted the new exploits and the corresponding propagated families in chronological order.\n\n**First seen** **Exploit (CVE)** **Exposure time** **Target device / software** **Family**\n\n1 2020.8.26 Realtek Tsunami\n\n2 2020.9.3 Realtek Gafgyt\n\n3 2020.9.20 Huawei_Router Gafgyt\n\n4 2020.9.25 Avtech_Camera_RCE Gafgyt\n\n5 2020.10.21 ThinkPHP_RCE Gafgyt\n\n6 2020.11.2 JAWS_DVR_RCE Gafgyt\n\n7 2020.11.11 ZTE_Router_RCE Gafgyt\n\n8 2020.11.19 yarn_api Gafgyt\n\n9 2020.11.19 Avtech_IP_Camera_ACI Gafgyt\n\n10 2020.11.24 Zyxel_VIEWLOG_RCE Gafgyt\n\n11 2020.11.26 ZeroShell_Kerbynet_RCE Gafgyt\n\n12 2021.1.8 CVE-2020-7961 2020.7 Liferay Portal Necro\n\n13 2021.1.8 CVE-2020-35665 2020.12.23 TerraMaster Necro\n\n14 2021.1.8 CVE-2021-3007 2021.1.3 Zend Framework Necro\n\n15 2021.3.10 WebLogic RCE Necro\n\n16 2021.3.20 CVE-2021-21972 2021.2.27 VMware_vCenterServer Necro\n\n17 2021.3.23 SonicWALL_XMLRPC_settimeconfig_RCE Gafgyt\n\n18 2021.4.26 F5_iControl_mgmt_RCE Gafgyt\n\n19 2021.5.1 VestaCP Necro\n\n20 2021.5.1 SCO Openserver Necro\n\n21 2021.5.1 Genexis PLATINUM Necro\n\n22 2021.5.1 OTRS 6.0.1 Necro\n\n23 2021.5.1 Unknown (Nrdh.php) Necro\n\n_Table 1: Exploit stats._\n\nComparing the point in time when the new exploit was added and the POC exposure time we can see that Keksec’s\nutilization of 1-days is very fast. Especially after the start of Necro propagation, the attack activity can often be seen within\ntwo to three days of POC exposure.\n\n**4. MALWARE FAMILIES**\n\nKeksec developed several families of malicious programs across Window and Linux systems, involving PC, server, multiple\nIoT platforms, and created a complicated botnet platform, here are some breakdowns:\n\n|Col1|First seen|Exploit (CVE)|Exposure time|Target device / software|Family|\n|---|---|---|---|---|---|\n|1|2020.8.26|||Realtek|Tsunami|\n|2|2020.9.3|||Realtek|Gafgyt|\n|3|2020.9.20|||Huawei_Router|Gafgyt|\n|4|2020.9.25|||Avtech_Camera_RCE|Gafgyt|\n|5|2020.10.21|||ThinkPHP_RCE|Gafgyt|\n|6|2020.11.2|||JAWS_DVR_RCE|Gafgyt|\n|7|2020.11.11|||ZTE_Router_RCE|Gafgyt|\n|8|2020.11.19|||yarn_api|Gafgyt|\n|9|2020.11.19|||Avtech_IP_Camera_ACI|Gafgyt|\n|10|2020.11.24|||Zyxel_VIEWLOG_RCE|Gafgyt|\n|11|2020.11.26|||ZeroShell_Kerbynet_RCE|Gafgyt|\n|12|2021.1.8|CVE-2020-7961|2020.7|Liferay Portal|Necro|\n|13|2021.1.8|CVE-2020-35665|2020.12.23|TerraMaster|Necro|\n|14|2021.1.8|CVE-2021-3007|2021.1.3|Zend Framework|Necro|\n|15|2021.3.10|||WebLogic RCE|Necro|\n|16|2021.3.20|CVE-2021-21972|2021.2.27|VMware_vCenterServer|Necro|\n|17|2021.3.23|||SonicWALL_XMLRPC_settimeconfig_RCE|Gafgyt|\n|18|2021.4.26|||F5_iControl_mgmt_RCE|Gafgyt|\n|19|2021.5.1|||VestaCP|Necro|\n|20|2021.5.1|||SCO Openserver|Necro|\n|21|2021.5.1|||Genexis PLATINUM|Necro|\n|22|2021.5.1|||OTRS 6.0.1|Necro|\n|23|2021.5.1|||Unknown (Nrdh.php)|Necro|\n\n\n-----\n\n  - _Linux-based: Tsunami (Capsaicion, Ziggy), Gafgyt (LULzbOT, Oreo, Gafgyt_tor)_\n\n  - _Windows-based: DarkIRC (AutoIt packed) [2], DarkHTTP (AutoIt packed)_\n\n - Developed in Python to target dual systems: Necro\n\n - From open-sourced projects: Rootkit, Miner, JS Bot\n\nKeksec actively maintains three main families, Gafgyt, Tsunami and Necro, with new features constantly being added.\nWhile Necro’s framework is developed by Keksec itself, the threat group inherits the other two families from opensource code. Our analysis shows that Keksec has extraordinarily strong code management capabilities, using opensource or leaked code to develop different variants extensively, which leads to variant chaos. For example, Freak, a key\nmember of Keksec, developed and open-sourced two Tsunami (a.k.a. Kaiten, a long established IRC botnet family)\nvariants of Capsaicion [3] and Ziggy Redo. However, we found some Tsunami samples that mix codes of both\nCapsaicion and Ziggy.\n\n_Figure 2: Tsunami variant of Capsaicion._\n\n_Figure 3: Tsunami variant of Ziggy Redo._\n\nThe same sort of chaos also exists in Gafgyt variants including LulZBoT, Oreo, bigB04t and Simps. Some variants even\nreuse Tsunami code. As for Necro, the purely Python developed family not only reuses the IRC protocol for C2\ncommunication, but also borrows many key features from open-source projects. Due to that complication, we do not follow\nthe naming of Keksec to classify the variants, but break down their samples into the three main families of Gafgyt, Tsunami\nand Necro to summarize and analyse the technical points and design ideas they share.\n\n**Scanners**\n\nThe scanners used by Keksec are mainly telnet and SSH weak password scan and exploit scan.\n\n**_Telnet scan_**\n\nThe telnet weak password scan of the open-source version of Tsunami uses a function called BurnTheJews, as shown in\nFigure 4.\n\nIn the captured sample we found that Keksec uses a function called ak47telscan, shown in Figure 5. The two sets of code\nalgorithms are almost identical, only the standard output section has any difference.\n\nThe sample first detects if the device supports raw sockets, and if it does, it uses Mirai’s telnet scan code, scanner_init. It if\ndoesn’t support raw sockets, ak47telscan will be used.\n\nIn fact, the ak47telscan function is also from publicly available source, not created by Keksec. The relevant code is shown\nin Figure 6.\n\n\n-----\n\n_Figure 4: Telnet scan function of BurnTheJews()._\n\n_Figure 5: Keksec’s scan function of ak47telscan()._\n\n\n-----\n\n_Figure 6: The publicly available ak47 scan function._\n\n**_SSH scan_**\n\nThe SSH weak password scan is done by the Necro botnet. Necro first tries to install the paramiko library on the device,\nand if it succeeds, it adds port 22 to the list of scanned ports, and if it fails to install the library, it just gives up the 22 scan.\n\n_Figure 7: Necro code for installing paramiko._\n\nAfter receiving the scan command, the built-in weak password brute force starts, as shown in Figure 8.\n\nSSH weak passwords are constantly updated by version upgrades, and new weak passwords are added to replace some of\nthe less effective ones.\n\n\n-----\n\n_Figure 8: Necro SSH weak password scan code._\n\n**_Exploit scan_**\n\nAll samples contain an exploit scan. In Tsunami and Gafgyt, the exploit scan is placed in ak47scan. There is scanning code\nfor Huawei and Realtek devices. According to our observation and analysis, Keksec does not have 0-day discovery\ncapabilities, so most of the POC codes are publicly available. If the POC is implemented in C, it can be integrated into\nTsunami and Gafgyt with simple modifications, and if the POC code is implemented in Python, it can be integrated into the\nNecro family. In some individual variants the number of exploits implemented can go up to dozens.\n\nThe three more popular exploits integrated by Necro can be seen in Figures 9–11, and the original POCs for these codes\ncan be found online.\n\n1. TerraMaster RCE: CVE-2020-28188\n\n\n-----\n\n2. VMware vCenter Server RCE: CVE-2021-21972\n\n3. WebLogic RCE: CVE-2020-14882\n\n_Figure 9: Necro TerraMaster RCE scan code._\n\n_Figure 10: Necro VMware vCenter Server RCE scan code._\n\n_Figure 11: Necro WebLogic RCE scan code._\n\n**Sniffer**\n\nPacket sniffing is one of the more favoured features of Keksec, and the code can be seen in all three families. The basic\nfunction is to capture TCP traffic after filtering out some specified ports and IPs, and to send the remaining data to the C2.\n\nFigure 12 shows the sniffer code used in Tsunami and Gafgyt. You can see that the same set of code is used.\n\n_Figure 12: Gafgyt sniffer code._\n\n\n-----\n\nFigure 13 shows the sniffer code used by Necro. The code for this function can also be found on GitHub with similar open\nsource code.\n\n_Figure 13: Necro sniffer code._\n\nWe can see that the data is reported on the same port 1337, and since Necro also uses the IRC protocol, we can see that\nNecro may share the same C2 as Tsunami. Although we did not analyse DarkIRC in depth, it is easy to see that Keksec\nwants to build a botnet management platform based on the IRC protocol that can infect all architectures and operating\nsystems and can act as a unified management platform for botnet management.\n\n**Disguising processes**\n\n**_Change process name_**\n\nA very traditional technique on Linux systems is to use random strings to override argv parameters and prctl(PR_SET_\nNAME,buf) to change the process name and start parameters in order to disguise the process.\n\n_Figure 14: Code using prctl() to change the process name._\n\n\n-----\n\n**_Use of rootkit to hide process_**\n\nThe open-source project r77 rootkit is used directly on Windows systems. It is a ring3 layer rootkit that intercepts and filters\ninformation about the target process by globally hooking some functions of ntdll.dll.\n\n_Figure 15: r77 rootkit code to hook system APIs._\n\nNecro first downloads the corresponding version of the rootkit file, which is dynamically loaded and run directly in\nmemory by process injection.\n\n_Figure 16: Necro code to download r77 rootkit._\n\n**Process injection**\n\nNecro uses process injection to load the rootkit by wrapping the dll file into a shellcode and then injecting the whole\nshellcode into the process memory; the loading of the rootkit is done by the shellcode, which comes from an open-source\nproject on GitHub named RDI.\n\n_Figure 17: Necro code for injecting code into other process._\n\n\n-----\n\n**DGA**\n\nIn its historical versions Necro used DGA to evade C2 interception. The relevant algorithm is described below.\n\n**_Random_**\n\nThe first algorithm is a purely random one that picks 16 characters at random from a custom alphabet to generate a C2\ndomain name with the top-level domain ‘xyz’. Because the seed of the random algorithm is fixed 0-3, the random number\ngenerated has a stable result.\n\n_Figure 18: Necro random DGA algorithm._\n\n**_DDNS + random_**\n\nThe second algorithm is based on the DDNS service, and the random algorithm picks 10 to 19 characters randomly from a\ncustom alphabet. This method is cheaper and more flexible.\n\n_Figure 19: Necro DDNS + random DGA algorithm._\n\n**Tor**\n\nWe found Tor proxy being used to communicate with the C2 in both Gafgyt and Necro.\n\n**_Gafgyt_**\n\nIn Gafgyt Tor proxy is used to talk to the C2 through a built-in proxy list. Up to 173 proxy IPs can be used for a single\nsample. Figure 20 shows Gafgyt’s Tor initialization code.\n\nA communication is established by randomly selecting one from the list of candidate proxies and if successful, a\nconnection to the onion C2 will follow. Figure 21 shows the connecting code and Figure 22 shows captured Gafgyt onion\ncommunication data.\n\n\n-----\n\n_Figure 20: Gafgyt Tor initialization code._\n\n_Figure 21: Gafgyt Tor connecting code._\n\n_Figure 22: The captured Gafgyt onion communication data._\n\n**_Necro_**\n\nNecro also uses Tor proxy to reach an onion C2, and IRC protocol is used for the C2 communication. Figure 23 shows the\ncode Necro uses to contact the C2 with Tor.\n\n_Figure 23: Necro code to contact C2 with Tor._\n\n\n-----\n\n**Obfuscation and packer**\n\n**_UPX_**\n\nMost of the Gafgyt and Tsunami samples we captured were not packed and had no stripped symbolic information, while a\nfew of the packed samples used the standard UPX shell, which can be removed directly using open-source tools. The\nunpacked samples were also not stripped.\n\n**_String encoding_**\n\nGafgyt and Tsunami samples encrypt sensitive strings (such as C2 addresses) with a simple mapping algorithm, and\nencrypt them with the decode function when using strings.\n\n_Figure 24: Gafgyt C2 decryption._\n\nThis algorithm is also not developed by Keksec, it is used by a Tsunami variant called ziggystartux. In the early variants of\nKeksec this code table was identical to the one in the original ziggystartux code.\n\n_Figure 25: Ziggystartux’s cipher code table._\n\nAfter several iterations this code table was changed to \"'%q*KC)&F98fsr2to4b3yi_:wB>z=;k?\n\"EAZ7.D-md<ex5U~h,j|$v6c1ga+p@un0'\".\n\nNecro also cryptographically protects the string by first performing character substitution and then doing zip compression.\nThe relevant algorithms are shown in Figure 26.\n\n_Figure 26: Necro string encryption code._\n\n**_Polymorphic engine_**\n\nNecro uses a Python source code obfuscation technique exposed in 2015, referred to by Keksec as ‘polymorph engine’, and\nthis algorithm is updated and improved during Necro upgrades. So far we have observed two versions of polymorphic\nmorphing.\n\nThe old version uses a random string to replace a predefined list of key object names, as shown in Figure 27.\n\nThe new version, shown in Figure 28, uses Python’s own AST library to dynamically traverse and replace the global objects\nwith random strings. As we can see, there is no need to manually filter the object names, and the strings can automatically\nbe traversed and encrypted.\n\n\n-----\n\n_Figure 27: Necro’s old polymorphism code._\n\n_Figure 28: Necro’s new polymorphism code based on AST._\n\n**C2 protocol**\n\nKeksec’s malware mainly uses Gafgyt and IRC protocols to send commands.\n\n**_Gafgyt_**\n\nThis protocol is mainly used by the Gafgyt variant. Interestingly, the commands in the sample are encrypted using the\nencode function. After receiving the instructions, the local instructions need to be decrypted and then parsed. Gafgyt’s\nencrypted and decrypted commands are shown in Figure 29.\n\n\n-----\n\n_Figure 29: Gafgyt encrypted and decrypted commands._\n\n**_IRC_**\n\nThe IRC protocol is the most widely used protocol in Keksec, and is supported by the Tsunami, Necro and DarkIRC\nfamilies. This means that only one C2 system needs to be developed and maintained to control all families.\n\n**Spread**\n\n**_Exploit_**\n\nKeksec attacks the target device mainly through exploits, so the network-wide vulnerability scan is its main means of\nspreading malicious samples, while the worm-like propagation through the infected device is also an important function of\nthe malware. In addition to this, there are some horizontal propagation methods.\n\n**_Infect page_**\n\nWe found that Necro can infect web files (.js, .html, .htm, .php) on the target device.\n\n_Figure 30: Necro code for infecting web files._\n\nAfter receiving the infection command, it inserts a JS code, hxxp[:]//ublock-referer.dev/campaign.js, into the\nfile. Campaign.js is a highly obfuscated code which, after decoding, is a JavaScript-based trojan (Cloud9).\n\n\n-----\n\n_Figure 31: Necro code for injecting JavaScript code into web files._\n\n**_SMB scan_**\n\nNecro added the SMB scan code in one of its versions to achieve the function of horizontal propagation in the intranet.\n\n_Figure 32: Necro SMB scan code._\n\nPerhaps the actual effect was not satisfactory, as this feature was removed in subsequent versions. This code can also be\nfound on GitHub [4].\n\n_Figure 33: The publicly available SMB scan code._\n\n\n-----\n\n**Others**\n\nKeksec not only enriches it functionality with a lot of references to third-party code, but also delivers the complete\nopen-source project directly to the target device to complete the corresponding functionality.\n\n**_JS Bot_**\n\nNecro’s goal in infecting web files is to spread JS Bot (Cloud9). The bot is loaded when the user accesses an infected page\nthrough a browser. The bot is very feature-rich, recording keyboard information, stealing forms, clipboards, cookies and\nother data, faking web access behaviour, and launching HTTP DDoS attacks through the browser.\n\nWe discovered a fake Firefox plug-in on the download server, and found through reverse engineering that this plug-in is\nalso injecting Cloud9 [5] malicious code into the browser. It is not clear through what channel this plug-in is propagated.\n\n_Figure 34: Fake Firefox plug-in install page._\n\n**_Miner_**\n\nKeksec also contains the popular mining function, which is not deeply integrated in the bot but directly implemented by\nreleasing a third-party miner program.\n\n_Figure 35: Necro XMR wallet._\n\nMost of the samples are after Monroe coins; occasionally we see some other coins, such as XTZ coins.\n\n_Figure 36: Necro XTZ wallet._\n\nChecking the relevant wallet addresses we found that the returns are not ideal.\n\nThrough the above technical analysis points we can summarize the characteristics of the relevant families into the following\ntable.\n\n**Feature\\FN** **Necro** **Tsunami** **Gafgyt**\n\nIRC         -         Tor           -           String encode            -            -            Polymorphic           UPX        -        Not stripped            -            DGA       DGA+DDNS        Sniffer             -             -             Ak47Scan          -          Telnet scan            -            SSH scan           Exploit scan            -            -            SMB scan          \n_Table 2: Feature comparisons across families._\n\n|Feature\\FN|Necro|Tsunami|Gafgyt|\n|---|---|---|---|\n|IRC|*|*||\n|Tor|*||*|\n|String encode|*|*|*|\n|Polymorphic|*|||\n|UPX||*|*|\n|Not stripped||*|*|\n|DGA|*|||\n|DGA+DDNS|*|||\n|Sniffer|*|*|*|\n|Ak47Scan||*|*|\n|Telnet scan||*|*|\n|SSH scan|*|||\n|Exploit scan|*|*|*|\n|SMB scan|*|||\n\n\n-----\n\nWe can see that Necro has the most comprehensive functions and features, but Keksec is still maintaining and developing\nTsunami and Gafgyt. We suspect that Necro relies on the Python runtime environment and some low-power devices do not\nsupport Python. In order to cover more platforms, the botmaster has to operate multiple families of botnet at the same time.\n\n**5. OPERATIONS**\n\n**Delivery**\n\nWe counted the number of new samples captured by day starting from August 2020.\n\n_Figure 37: Stats on delivered x86 and x64 samples._\n\nWe can see a significant increase in the number of samples over the last year. This is not simply a repetitive propagation of\nthe same samples, as the code is adjusted almost on a daily basis – sometimes several upgraded samples can be captured in\none day. This indicates that the Keksec group has sufficient manpower and resources and is becoming increasingly active.\n\n**Infrastructure**\n\nWe collected the x86 and x64 samples of the Tsunami and Gafgyt families, extracted the C2 information, and looked at the\nhistory of their C2 activity.\n\n_Figure 38: Stats on Keksec C2 activity._\n\nBy correlating the domain name resolution records of C2 IP addresses in 2020 through PDNS, we can get two key domain\nnames, gxbrowser.net and cnc.c25e6559668942.xyz, as shown in Figure 39. Most of the IPs have resolution association\nwith these two domain names. From 2021 onwards Keksec drops the use of these two domains in favour of the Tor network\nand DGA domains.\n\n\n-----\n\n_Figure 39: Mapping of key C2 domains and IPs._\n\nUsing the above graphical information, we find a clear pattern of activity:\n\n1. Each C2 IP survival cycle varies from one month to three months.\n\n2. The preference is to use IP resources in the same network segment within the same cycle.\n\n3. The deployment of C2s used domain names and IPs until March 2021, then shifted to using Tor proxies from March\nonwards.\n\n4. After Tor is introduced, the onion C2 domains get updated at high frequency, for example, 10 onion domains were\nused in March alone.\n\n\n-----\n\n**Family reuse statistic**\n\nWe also found some patterns when tracking the delivery of the samples.\n\n1. The Tsunami sample appeared in mid-August 2020 and was active for a short period of time.\n\n2. The Gafgyt sample was active intermittently from September to December 2020.\n\n3. A malicious family named Necro suddenly appeared in January 2021.\n\n4. From early to mid-February 2021, first the Tsunami sample resumed propagation, then Gafgyt, followed by\nGafgyt_tor.\n\n5. There are many similarities between the Gafgyt_tor variant and the previously captured Gafgyt sample, with code\nthat is clearly homologous.\n\nEach family is constantly switching between development and propagation cycles. In the development cycle a large range\nof improvements are made to the samples. This ‘change-as-you-distribute’ approach is used to continuously improve botnet\nfunctionality, resulting in a large number of different samples being distributed in a short period of time.\n\n_Figure 40: Fam ily reuse history._\n\n**6. CONCLUSIONS**\n\nKeksec is trying to make profit from DDoS, mining, stealing user information and selling malware. Through long-term\ntracking we can see that DDoS attack activity is the most prominent, which is probably its biggest source of revenue.\nHowever, Keksec has not given up on other means and has kept expanding into new directions. It seems to be a highly\norganized, productive and aggressive group. Although it has no 0-day discovery capabilities, its strong code integration and\nbot operations make it a serious hacking group. We will continue to keep an eye on it.\n\n**REFERENCES**\n\n[1] [https://blog.netlab.360.com/not-really-new-pyhton-ddos-bot-n3cr0m0rph-necromorph/.](https://blog.netlab.360.com/not-really-new-pyhton-ddos-bot-n3cr0m0rph-necromorph/)\n\n[2] [https://pastebin.com/XUBLGuFT.](https://pastebin.com/XUBLGuFT)\n\n[3] [https://pastebin.com/HMD7z6FR.](https://pastebin.com/HMD7z6FR)\n\n[4] [https://github.com/adithyan-ak/MS17-010-Manual-Exploit/](https://github.com/adithyan-ak/MS17-010-Manual-Exploit/blob/9b7b0ea5434bca066612f8fc84112a1b84a9507a/42315.py)\nblob/9b7b0ea5434bca066612f8fc84112a1b84a9507a/42315.py.\n\n[5] [https://github.com/Antonio24/Cloud9/blob/master/.](https://github.com/Antonio24/Cloud9/blob/master/)\n\n**APPENDIX: KEKSEC C2s**\n\n107.174.133.119\n107.175.31.130\n143.198.120.58\n185.10.68.175\n192.210.163.201\n193.239.147.211\n193.239.147.224\n198.144.190.116\n198.144.190.5\n23.94.190.101\n45.145.185.221\n\n\n-----\n\n45.145.185.229\n45.145.185.83\n45.153.203.124\n5.253.84.197\n55pnros74tawlmqn.onion\n70.66.139.68\n83.97.20.90\n84.16.79.130\nb4bzpyrhc65airpg.onion\ncjoy2cks2bhtyibj.onion\ndimumdjenyy4jwlc.onion\nfaw623ska5evipvarobhpzu4ntoru5v6ia5444krr6deerdnvpa3p7ad.onion\nfpv4a2q6wqxx7jdh.onion\nfxiiouorymolxsqcjltq2mqaz3il5uqs3ynlabh5onfw3irbqltot6ad.onion\nks5wtmd7bbuybajg.onion\ntzfue66fa5khu44z.onion\nwvp3te7pkfczmnnl.onion\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "99593a68-7f6e-400e-9a9f-a707f66d2e72",
            "created_at": "2022-11-23T11:07:14.353321Z",
            "updated_at": "2022-11-23T11:07:14.353321Z",
            "deleted_at": null,
            "name": "AGRO",
            "url": "https://apt.threattracking.com",
            "description": "APT Groups and Operations Spreadsheet",
            "reports": null
        }
    ],
    "references": [
        "https://vblocalhost.com/uploads/VB2021-Jin-Tu.pdf"
    ],
    "report_names": [
        "VB2021-Jin-Tu.pdf"
    ],
    "threat_actors": [
        {
            "id": "33f527a5-a5da-496a-a48c-7807cc858c3e",
            "created_at": "2022-10-25T15:50:23.803657Z",
            "updated_at": "2025-03-27T02:00:55.550132Z",
            "deleted_at": null,
            "main_name": "PLATINUM",
            "aliases": [
                "PLATINUM"
            ],
            "source_name": "MITRE:PLATINUM",
            "tools": [
                "JPIN",
                "Dipsind",
                "adbupd"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "5a270f6c-2c13-4abf-861e-7d44dcfa5ceb",
            "created_at": "2023-11-03T02:00:07.794425Z",
            "updated_at": "2025-03-27T02:00:03.146871Z",
            "deleted_at": null,
            "main_name": "Keksec",
            "aliases": [],
            "source_name": "MISPGALAXY:Keksec",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "7d8ef10e-1d7b-49a0-ab6e-f1dae465a1a4",
            "created_at": "2023-01-06T13:46:38.595679Z",
            "updated_at": "2025-03-27T02:00:02.869216Z",
            "deleted_at": null,
            "main_name": "PLATINUM",
            "aliases": [
                "TwoForOne",
                "G0068",
                "ATK33"
            ],
            "source_name": "MISPGALAXY:PLATINUM",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "e61c46f7-88a1-421a-9fed-0cfe2eeb820a",
            "created_at": "2022-10-25T16:07:24.061767Z",
            "updated_at": "2025-03-27T02:02:10.094583Z",
            "deleted_at": null,
            "main_name": "Platinum",
            "aliases": [
                "ATK 33",
                "Operation EasternRoppels",
                "TwoForOne"
            ],
            "source_name": "ETDA:Platinum",
            "tools": [
                "AMTsol",
                "Adupib",
                "Adupihan",
                "Dipsind",
                "DvDupdate.dll",
                "JPIN",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "RedPepper",
                "RedSalt",
                "Titanium",
                "adbupd",
                "psinstrc.ps1"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1669205087,
    "ts_updated_at": 1743041556,
    "ts_creation_date": 1629729682,
    "ts_modification_date": 1629729945,
    "files": {
        "pdf": "https://archive.orkl.eu/0c20814ecd9a30f2a6851d52215b9a112e73f704.pdf",
        "text": "https://archive.orkl.eu/0c20814ecd9a30f2a6851d52215b9a112e73f704.txt",
        "img": "https://archive.orkl.eu/0c20814ecd9a30f2a6851d52215b9a112e73f704.jpg"
    }
}