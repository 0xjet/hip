{
    "id": "04d2934a-b8ca-46a7-a899-4cc08818bd31",
    "created_at": "2022-10-25T16:48:15.988156Z",
    "updated_at": "2025-03-27T02:13:58.88264Z",
    "deleted_at": null,
    "sha1_hash": "4fa97bcbbda216a683c7b1b4105870086422bc8a",
    "title": "",
    "authors": "",
    "file_creation_date": "2020-09-25T09:36:43Z",
    "file_modification_date": "2020-09-25T09:36:43Z",
    "file_size": 832858,
    "plain_text": "# MAR-10292089-1.v2 – Chinese Remote Access Trojan: TAIDOOR\n\n**us-cert.cisa.gov/ncas/analysis-reports/ar20-216a**\n\nOfficial website of the Department of Homeland Security\n\n## Notification\n\nThis report is provided \"as is\" for informational purposes only. The Department of Homeland\nSecurity (DHS) does not provide any warranties of any kind regarding any information contained\nherein. The DHS does not endorse any commercial product or service referenced in this bulletin\nor otherwise.\n\nThis document is marked TLP:WHITE--Disclosure is not limited. Sources may use TLP:WHITE\nwhen information carries minimal or no foreseeable risk of misuse, in accordance with applicable\nrules and procedures for public release. Subject to standard copyright rules, TLP:WHITE\ninformation may be distributed without restriction. For more information on the Traffic Light\nProtocol (TLP), see http://www.us-cert.gov/tlp.\n\n## Summary\n\nDescription\n\nThis Malware Analysis Report (MAR) is the result of analytic efforts between the Cybersecurity\nand Infrastructure Security Agency (CISA), the Federal Bureau of Investigation (FBI), and the\nDepartment of Defense (DoD). Working with U.S. Government partners, CISA, FBI, and DoD\nidentified a malware variant used by Chinese government cyber actors, which is known as\nTAIDOOR. For more information on Chinese malicious cyber activity, please visit\nhttps[:]//www[.]us-cert.gov/china.\n\nFBI has high confidence that Chinese government actors are using malware variants in\nconjunction with proxy servers to maintain a presence on victim networks and to further network\nexploitation. CISA, FBI, and DoD are distributing this MAR to enable network defense and reduce\nexposure to Chinese government malicious cyber activity.\n\nThis MAR includes suggested response actions and recommended mitigation techniques. Users\nor administrators should flag activity associated with the malware and report the activity to the\nCybersecurity and Infrastructure Security Agency (CISA) or the FBI Cyber Watch (CyWatch), and\ngive the activity the highest priority for enhanced mitigation.\n\nMalicious binaries identified as a x86 and x64 version of Taidoor were submitted for analysis.\nTaidoor is installed on a target’s system as a service dynamic link library (DLL) and is comprised\nof two files. The first file is a loader, which is started as a service. The loader decrypts the second\nfile, and executes it in memory, which is the main Remote Access Trojan (RAT).\n\n[For a downloadable copy of IOCs, see MAR-10292089-1.v2.stix.](https://us-cert.cisa.gov/sites/default/files/publications/MAR-10292089-1.v2.stix.xml)\n\nS b itt d Fil (4)\n\n\n-----\n\n0d0ccfe7cd476e2e2498b854cef2e6f959df817e52924b3a8bcdae7a8faaa686 (svchost.dll)\n\n363ea096a3f6d06d56dc97ff1618607d462f366139df70c88310bbf77b9f9f90 (svchost.dll)\n\n4a0688baf9661d3737ee82f8992a0a665732c91704f28688f643115648c107d4 (ml.dll)\n\n6e6d3a831c03b09d9e4a54859329fbfd428083f8f5bc5f27abbfdd9c47ec0e57 (rasautoex.dll)\n\nDomains (2)\n\ncnaweb.mrslove.com\n\ninfonew.dubya.net\n\nIPs (1)\n\n210.68.69.82\n\n## Findings\n\n**4a0688baf9661d3737ee82f8992a0a665732c91704f28688f643115648c107d4**\n\nTags\n\nbackdoorloadertrojan\n\nDetails\n\n**Name** ml.dll\n\n**Size** 43520 bytes\n\n**Type** PE32 executable (DLL) (GUI) Intel 80386, for MS Windows\n\n**MD5** 6aa08fed32263c052006d977a124ed7b\n\n**SHA1** 9a6795333e3352b56a8fd506e463ef634b7636d2\n\n**SHA256** 4a0688baf9661d3737ee82f8992a0a665732c91704f28688f643115648c107d4\n\n\n**SHA512**\n\n**ssdeep**\n\n\n179e9d9ccbc268cc94a7f6d31f29cf0f7a163db829a4557865f3c1f98614f94ceb7b90273d33eb49ef569cfc9013b76c7de32d7511639a7ab2c352f3137d51b6\n\n768:uGRVnBnwS5kBKsl4anxKFhx3W3kGmifmUED7Bn5f6dBywFmZb:fDeSnbx3okvxVwFI\n\n\n**Entropy** 5.864467\n\nAntivirus\n\n**Ahnlab** Trojan/Win32.Agent\n\n**Avira** TR/Agent.aavma\n\n**BitDefender** Trojan.GenericKD.34284857\n\n**ClamAV** Win.Packer.Taidoor-9209869-0\n\n\n-----\n\n**Comodo** Malware\n\n**Cyren** W32/Trojan.DRSK-8300\n\n**ESET** a variant of Win32/Agent.ACFH trojan\n\n**Emsisoft** Trojan.GenericKD.34284857 (B)\n\n**Ikarus** Trojan.Win32.Agent\n\n**K7** Trojan ( 0056be3e1 )\n\n**Lavasoft** Trojan.GenericKD.34284857\n\n**McAfee** RDN/Generic trojan.ks\n\n**Microsoft Security Essentials** Trojan:Win32/Taidoor.DA!MTB\n\n**NANOAV** Trojan.Win32.Dllhijacker.hqfyaa\n\n**Quick Heal** Trojan.Taidoor.S15351536\n\n**Sophos** Mal/Taidoor-A\n\n**Symantec** Trojan Horse\n\n**Systweak** trojan-backdoor.taidoor\n\n**TrendMicro** Trojan.2826E77D\n\n**TrendMicro House Call** Trojan.2826E77D\n\n**VirusBlokAda** Trojan.Dllhijacker\n\n**Zillya!** Trojan.Agent.Win32.1363180\n\nYARA Rules\n\nNo matches found.\n\nssdeep Matches\n\nNo matches found.\n\nPE Metadata\n\n**Compile Date** 2019-01-03 07:16:12-05:00\n\n**Import Hash** dbb469cb14550e6085a14b4b2d41ede9\n\nPE Sections\n\n**MD5** **Name** **Raw Size** **Entropy**\n\n62ab3bae7859f6f6dc68366d283ad53e header 1024 2.511204\n\n63550f7c47453c2809834382e228637d .text 23040 6.442964\n\na30bb3ac9b6694a8980c39c0267c9a83 .rdata 11264 4.926331\n\n\n-----\n\nad5814673b8579de78be5b6b929d2405 .data 3072 2.629944\n\n619ecca9c8d1073a0b90f5fffac42ec8 .rsrc 512 5.105029\n\n0f292021853e7ca76c4196bcbe9afdaf .reloc 4608 3.712197\n\nPackers/Compilers/Cryptors\n\nMicrosoft Visual C++ DLL *sign by CodeRipper\n\nRelationships\n\n4a0688baf9... Used 363ea096a3f6d06d56dc97ff1618607d462f366139df70c88310bbf77b9f9f90\n\nDescription\n\nThis file is a 32-bit Windows DLL file. The file “ml.dll” is a Taidoor loader. The file utilizes the\nexport function called “MyStart” to decrypt and load “svchost.dll”\n(8CF683B7D181591B91E145985F32664C), which was identified as Taidoor malware. Taidoor is a\ntraditional RAT.\n\nThe “MyStart” function looks for the file name “svchost.dll” in its running directory. If that file is\nlocated, the DLL will read “svchost.dll” into memory. After the file is read into memory, the DLL\nuses a RC4 encryption algorithm to decrypt the contents of the file. The RC4 key used for\ndecryption is, “ar1z7d6556sAyAXtUQc2”.\n\nAfter the loader has finished decrypting “svchost.dll”, the loader now has a decrypted version of\nTaidoor, which is a DLL. The loader then uses the API calls GetProcessHeap, GetProcAddress,\nand LoadLibrary to load the following DLLs, KERNEL32.dll, ADVAPI32.dll, and WS2_32.dll,\nwhich Taidoor will utilize.\n\nNext, the loader looks for the export “Start” in the Taidoor DLL and executes that function.\n\n**363ea096a3f6d06d56dc97ff1618607d462f366139df70c88310bbf77b9f9f90**\n\nTags\n\nremote-access-trojantrojan\n\nDetails\n\n**Name** svchost.dll\n\n**Size** 158208 bytes\n\n**Type** data\n\n**MD5** 8cf683b7d181591b91e145985f32664c\n\n**SHA1** f0a20aaf4d2598be043469b69075c00236b7a89a\n\n**SHA256** 363ea096a3f6d06d56dc97ff1618607d462f366139df70c88310bbf77b9f9f90\n\n\n-----\n\n**SHA512**\n\n\nb75401d591caee812c5c1a669ce03c47f78f1c40a2fa31cf58a0318ffbfc032b82cb1b6d2a599ce1b3547be5a404f55212156640b095f895a9aac3c58ec4bad8\n\n\n**ssdeep** 3072:fRxYk0d5+6/kdGyfitoxNsUZE2XZ+4Duz6fCKmjjwF5PaT:JqkoiGiZxE4qRKqgIT\n\n**Entropy** 7.998691\n\nAntivirus\n\n**Ahnlab** Data/BIN.EncPe\n\n**Antiy** Trojan/Win32.Taidoor\n\n**Avira** TR/Taidoor.BD\n\n**BitDefender** Trojan.Agent.EUMT\n\n**ClamAV** Win.Packed.Taidoor-9209834-1\n\n**Cyren** W32/Taidoor.A.enc!Camelot\n\n**Emsisoft** Trojan.Agent.EUMT (B)\n\n**Ikarus** Trojan.Win32.Taidoor\n\n**Lavasoft** Trojan.Agent.EUMT\n\n**McAfee** Trojan-Taidoor\n\n**Microsoft Security Essentials** Trojan:Win32/Taidoor.DC!MTB\n\n**Sophos** Troj/Taidoor-A\n\n**Symantec** Trojan Horse\n\n**TrendMicro** Backdoo.7F53B305\n\n**TrendMicro House Call** Backdoo.7F53B305\n\n**Zillya!** Trojan.Taidoor.Win32.6\n\nYARA Rules\n\n\n-----\n\nrule CISA_10292089_01 : rat loader TAIDOOR\n{\nmeta:\nAuthor = \"CISA Code & Media Analysis\"\nIncident = \"10292089\"\nDate = \"2020-06-18\"\nLast_Modified = \"20200616_1530\"\nActor = \"n/a\"\nCategory = \"Trojan Loader Rat\"\nFamily = \"TAIDOOR\"\nDescription = \"Detects Taidoor Rat Loader samples\"\nMD5_1 = \"8cf683b7d181591b91e145985f32664c\"\nSHA256_1 =\n\"363ea096a3f6d06d56dc97ff1618607d462f366139df70c88310bbf77b9f9f90\"\nMD5_2 = \"6627918d989bd7d15ef0724362b67edd\"\nSHA256_2 =\n\"0d0ccfe7cd476e2e2498b854cef2e6f959df817e52924b3a8bcdae7a8faaa686\"\nstrings:\n$s0 = { 8A 46 01 88 86 00 01 00 00 8A 46 03 88 86 01 01 00 00 8A 46 05 88 86 02 01\n00 00 8A 46 07 88 86 03 01 00 00 }\n$s1 = { 88 04 30 40 3D 00 01 00 00 7C F5 }\n$s2 = { 0F BE 04 31 0F BE 4C 31 01 2B C3 2B CB C1 E0 04 0B C1 }\n$s3 = { 8A 43 01 48 8B 6C 24 60 88 83 00 01 00 00 8A 43 03 }\n$s4 = { 88 83 01 01 00 00 8A 43 05 88 83 02 01 00 00 8A 43 07 88 83 03 01 00 00 }\n$s5 = { 41 0F BE 14 7C 83 C2 80 41 0F BE 44 7C 01 83 C0 80 C1 E2 04 0B D0 }\n$s6 = { 5A 05 B2 CB E7 45 9D C2 1D 60 F0 4C 04 01 43 85 3B F9 8B 7E }\ncondition:\n($s0 and $s1 and $s2) or ($s3 and $s4 and $s5) or ($s6)\n}\n\nssdeep Matches\n\nNo matches found.\n\nRelationships\n\n363ea096a3... Used_By 4a0688baf9661d3737ee82f8992a0a665732c91704f28688f643115648c107d4\n\n\n363ea096a3... Connected_To\n\n363ea096a3... Connected_To\n\nDescription\n\n\ncnaweb.mrslove.com\n\n210.68.69.82\n\n\nThis encrypted file has been identified as the Taidoor RAT loaded by “ml.dll”\n(6AA08FED32263C052006D977A124ED7B). After the loader has finished decrypting this file,\nthe loader has a decrypted version of Taidoor, which is a DLL. The loader then uses the API calls\nGetProcessHeap, GetProcAddress, and LoadLibrary to load the following DLLs, KERNEL32.dll,\nADVAPI32.dll, and WS2_32.dll, which this file will utilize.\n\n\n-----\n\nNext, the loader “ml.dll” (6AA08FED32263C052006D977A124ED7B) looks for the export “Start”\nin the Taidoor DLL and executes that function. Taidoor’s “Start” function kicks off by decrypting a\nmultitude of import strings that it will use to dynamically import functions from the DLLs that\nhave been loaded. A complex stream cipher is used to decrypt the encrypted strings utilized by\nthis malware. The 85 strings include APIs and strings used by other structures, such as a\nstructure capable of allowing the malware to load external plugin payloads. The malware utilizes\nthe following 7-byte key to generate a 256-byte initial stream cipher value: “19 34 F4 D2 E9 B3\n0F”.\n\nNext, the algorithm pads the 256 initial cipher value out to 260 bytes utilizing 4-bytes already\ncontained within the 256-byte block (Figure 2). The algorithm performs the encryption 2-bytes at\na time from the encrypted string blocks. It compresses the 2-bytes into 1 byte before the\ndecryption process by subtracting the first byte and second byte by 0x80h. The result of the\nperforming the subtraction on the first byte is then shifted left by four. Both values are then\nadded together by using Boolean addition (OR) resulting in a single byte that is decrypted by the\ncipher.\n\nUsing a simple Exclusive OR (XOR) operation, the 260-byte block is shuffled and modified to\nproduce the byte that is used to decrypt the newly compressed byte. The byte being decrypted is\nthen placed back into the 260-byte cipher block buffer. This effectively produces a recurrent block\nshifting effect where the 260-byte cipher block value changes as a result of the sequence of bytes\nit receives. This is an effective method of thwarting heuristic or brute force attacks.\n\nTaidoor also uses the AES algorithm to decrypt a \"1616 byte\" configuration file. This configuration\nfile contains the command and control (C2) servers and possibly another encryption key used\nlater. The AES key used in hex is, “2B 7E 15 16 28 AE D2 A6 AB F7 15 88 09 CF 4F 3C” IV: “00”.\n\n--Begin C2-cnaweb.mrslove.com\n210.68.69.82\n--End C2-\nAfter completing this decryption function Taidoor iterates through the System Event Log.\nLooking specifically for event IDs 6005 (event service started) and 6006 (event service stopped).\nAfter completing its decryption functions, Taidoor tries to connect to its C2 server. Once Taidoor\nand the C2 server finish the TCP handshake, Taidoor waits for at least one byte of data to be sent\nfrom the C2 server. This byte or bytes are not checked by Taidoo, anything can be sent.\n\nAfter Taidoor has confirmed it has received at least one byte of data form the server, Taidoor\nsends a custom formatted packet over port 443. Note: this packet does not follow TLS protocol,\nand is easily identifiable. The initial packet sent from Taidoor to the C2 server in this case always\nstarts with “F::” followed by the encryption key that Taidoor, and the C2 server will use to encrypt\nall following communications.\n\nAfter sending the encryption key to the C2 server, Taidoor expects the server to respond with\n“200 OK\\r\\n\\r\\n”. Note: This response is over port 443, but is not encrypted, it is sent in clear\ntext.\n\nAfter Taidoor has successfully connected to its C2, it creates a Windows INI configuration file,\nand copies cmd.exe into the system temp folder.\n\n\n-----\n\n--Begin Windows INI file created-C:\\ProgramData\\Microsoft\\~svc_.TMp\n--End Windows INI file created-\n--Begin contents of INI file-\n[Micros]\nsource=c:\\temp\\cmd.exe\n--End contents of INI file-\nNote: Taidoor does not have a function built it that enables it to persist past a system reboot. It\nappears from the memory dump of the infected system, it was installed as a service DLL by some\nother means.\n\nThe malware author never removed the symbol file for the “ml.dll” build. This artifact provides\nadditional information that the malware author intended this binary to do,\n“DllHijackPlushInject”.\n\n--Begin symbol file artifact-c:\\Users\\user\\Desktop\\DllHijackPlushInject\\version\\Release\\MemoryLoad.pdb\n--End symbol file artifact-\nThe following IDA script can be used to decrypt all the encrypted strings and demonstrate how a\nsequence of bytes is encrypted utilizing the initial 260 byte cipher block generated from the key\nvalue “19 34 F4 D2 E9 B3 0F”:\n\n--Begin IDA script-import os\nimport sys\nimport idaapi\ncwd = os.getcwd()\ncwd = '/Users/terminator/PycharmProjects/rc4_test//'\ncipherblock = []\npb_fname = cwd + \"//\" + 'pristine_block.bin'\nes_fname = cwd + \"//\" + 'encrypted_strings.bin'\nsecure_strings_func = 0x10003cb7\nencrypted_strings_block = 0x1001c434\nenc_string_size = 2875\nglobal_decrypted_stringz = []\ntry:\nfh = open(pb_fname, 'rb')\nread_bitez = fh.read()\nfh.close()\nexcept Exception as e:\nprint(\"Couldnt read filename. Reading from code (Attempt)\")\nprint(\"Cipher Block len: \" + str(len(cipherblock)))\nfor idx in read_bitez: # convert them to ords to do the math!\nidx = ord(idx)\ncipherblock.append(idx)\ndef decrypt(encrypted_string, cipherblock): # **CALL THIS FUNC to decrypt stuff!\n\n\n-----\n\nstring_len = len(encrypted_string)\nstring_len = string_len / 2\nthrottle = 0\nda_string = \"\"\nwhile True:\ncipherblock, decoded_byte = decrypt_it(cipherblock, encrypted_string, throttle)\ntry:\ncharr = chr(decoded_byte)\nif throttle:\nda_string += charr\nexcept Exception as e:\npass\nthrottle += 1 # INCREMENT before doing the compare\nif throttle == string_len:\nglobal_decrypted_stringz.append(da_string)\nreturn da_string\ndef decrypt_it(cipherblock, encoded_data, throttle):\nebx = 128 # *0x80\necx = throttle\necx = ecx + ecx\neax = encoded_data[ecx]\necx = encoded_data[ecx + 1]\neax = eax - ebx\necx = ecx - ebx\neax = eax << 4\neax = eax | ecx\ncipherblock, decoded_byte = outter_shuffle_func(cipherblock, eax)\nreturn cipherblock, decoded_byte\ndef outter_shuffle_func(cipherblock, encoded_bite):\n# before inner func\ncipherblock = inner_shuffle_func(cipherblock)\n# after inner func\neax = cipherblock[258]\necx = cipherblock[eax]\neax = cipherblock[260]\neax = cipherblock[eax]\nedx = cipherblock[257]\nedi = cipherblock[256]\nedx = cipherblock[edx]\nedi = cipherblock[edi]\necx = eax + ecx\neax = cipherblock[259]\neax = cipherblock[eax]\necx = eax + ecx\neax = 255\necx = ecx & eax\necx = cipherblock[ecx]\ncl = cipherblock[ecx]\n\n\n-----\n\nedx = edx + edi\nedx = edx & eax\ncl = cipherblock[edx] ^ cl # **actual manipulation here\nal = encoded_bite\ncl = cl ^ al\ncipherblock[260] = al\ncipherblock[259] = cl\nal = cl\ndecoded_byte = al\nreturn cipherblock, decoded_byte\ndef wrap_around_strip(da_byte):\nda_byte_str = str(hex(da_byte))\nda_byte_str = da_byte_str.split(\"x\")\nda_byte_str = da_byte_str[1]\nstr_length = len(da_byte_str)\nif str_length > 2:\ngot_em = \"0x\"\ngot_em += da_byte_str[str_length - 2]\ngot_em += da_byte_str[str_length - 1]\ngot_em = int(got_em, 16)\nreturn got_em\nreturn da_byte\ndef add_bites(a, b):\nfor_return = a + b\nfor_return = wrap_around_strip(for_return)\nreturn for_return\ndef inner_shuffle_func(cipherblock_orig): # *SHUFFLE The cipher block here!\ncipherblock = []\nfor idx in cipherblock_orig: # lets make a copy!\ncipherblock.append(idx)\nal = cipherblock[256]\nesi = cipherblock[260]\ndl = cipherblock[esi]\nal = al & 0xffffff\nedi = al\nbl = cipherblock[edi]\nda_byte = cipherblock[257]\nda_byte = add_bites(da_byte, bl)\ncipherblock[257] = da_byte\nal += 1\ncipherblock[256] = al\neax = cipherblock[257]\nal = cipherblock[eax]\ncipherblock[esi] = al\nesi = cipherblock[259]\nbl = cipherblock[esi]\nedi = cipherblock[257]\ncipherblock[edi] = bl\n\n\n-----\n\nesi = cipherblock[256]\neax = cipherblock[259]\nbl = cipherblock[esi]\ncipherblock[eax] = bl\neax = cipherblock[256]\ncipherblock[eax] = dl\neax = dl\nal = cipherblock[eax]\ntemp_byte = cipherblock[258]\ntemp_byte = add_bites(temp_byte, al)\ncipherblock[258] = temp_byte\nreturn cipherblock\ndef decode_from_addr(target_addr, label_loc, pointer_addr, label_them):\ninit_bitez = []\nord_bitez = []\nwhile True:\ntemp_bite = idaapi.get_byte(target_addr)\nif not temp_bite:\nbreak\ninit_bitez.append(temp_bite)\ntarget_addr += 1\nfor idx in init_bitez:\nord_bitez.append(idx)\ncipher_block_copy = []\nfor idx in cipherblock:\ncipher_block_copy.append(idx)\ndec_string = decrypt(ord_bitez, cipher_block_copy)\nif label_them:\nSetColor(label_loc, CIC_ITEM, 0xc7c7ff)\nMakeComm(label_loc, dec_string)\nSetColor(pointer_addr, CIC_ITEM, 0xc7c7ff)\nMakeComm(pointer_addr, dec_string)\nprint(dec_string)\ndef find_initial_loc(target_addr):\naddr = target_addr\ngive_up = 5\nattempts = 0\nwhile True:\naddr = idc.PrevHead(addr)\nif GetMnem(addr) == \"push\" and \"off_\" in GetOpnd(addr, 0):\nstring_addr = GetOperandValue(addr, 0)\nprint(\"Found String Loc: \" + str(hex(string_addr)))\npointer_addr = idaapi.get_dword(string_addr)\nprint(hex(pointer_addr))\ndecode_from_addr(pointer_addr, addr, string_addr, 1)\nreturn string_addr\nattempts += 1\nif attempts == give up:\n\n\n-----\n\nreturn 0\nenc_stringz_data = []\ntry:\nfh = open(es_fname)\nda_data = fh.read()\nfh.close()\nfor idx in da_data:\nx = ord(idx)\nenc_stringz_data.append(x)\nexcept Exception as e:\nprint(\"Couldnt read encrypted strings file. Reading from Malware!\")\naddr_throttle = encrypted_strings_block\nwhile len(enc_stringz_data) < enc_string_size:\nx = idaapi.get_byte(addr_throttle)\nenc_stringz_data.append(x)\nencrypted_stringz = [] # *list of lists\ntemp_string = []\nfor idx in enc_stringz_data:\nif idx:\ntemp_string.append(idx)\nif not idx:\nif len(temp_string):\nencrypted_stringz.append(temp_string)\ntemp_string = []\ndecrypted_stringz = []\ndebug_it = False\nif debug_it:\nfor enc_string in encrypted_stringz:\ncipher_block_copy = []\nfor idx in cipherblock:\ncipher_block_copy.append(idx)\ndec_string = decrypt(enc_string, cipher_block_copy)\ndecrypted_stringz.append(dec_string)\nprint(\"----------------------\")\nfor idx in decrypted_stringz:\nprint(idx)\nprint(\"Complete\")\naddresses_to = []\nfor addr in XrefsTo(secure_strings_func):\nprint(\"---------\")\nprint(hex(addr.frm))\nfind_initial_loc(addr.frm)\nprint(\"---------\")\nprint(\"\\n\")\naddresses_to.append(addr.frm)\nprint(\"IDA IDB Labeled. Decrypted Strings Below:\")\nprint(\"-----------------------------\")\n\n\n-----\n\nfor idx in global_decrypted_stringz:\nprint idx\n--End IDA script-\nString decrypted by the IDA script are displayed below:\n\n--Begin decrypted strings-kernel32.dll\nInitializeCriticalSection\nGetLocalTime\nLeaveCriticalSection\nGetModuleFileNameA\nSleep\nExpandEnvironmentStringsA\nGetSystemTime\nSystemTimeToFileTime\nGetTickCount\nCreatePipe\nDuplicateHandle\nGetCurrentProcess\nDisconnectNamedPipe\nTerminateProcess\nPeekNamedPipe\nReadFile\nCreateFileA\nSetFileTime\nOpenProcess\nGetFileTime\nWaitForSingleObject\nWriteFile\nDeleteFileA\nGetCurrentProcessId\nGetAdaptersInfo\nadvapi32.dll\nRegOpenKeyExA\nRegQueryValueExA\nRegCloseKey\nOpenEventLogA\nReadEventLogA\nCloseEventLog\nRegDeleteValueA\nRegCreateKeyExA\nRegNotifyChangeKeyValue\nCan't open update file.\nFile too small.\nSOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\nRValue\nSOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\n\n\n-----\n\nRValue\n%temp%\\~lpz.zp\nCan't find plug file\nCan't find plug file\nCan't load more plug\nLoad Dll Plug Failed\n%s\\uaq*.dll\n\\services.exe\nCreate File Failed\nCreate File Failed\nrundll32.exe\nSOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\nRValue\nRValue\n%SystemRoot%\\system32\\cmd.exe\nsource\nMicros\nCmdPage\nInfoPage\ncmd.exe\nsource\nMicros\navp.exe\nshell process Terminated\nReadShellThread closed\nCreate result file failed\nCreate result file failed\nCreateProcess Error: %d\nCreateProcess Error: %d\nCreateProcess succ\nOpen file Failed\nFile Size is 0\nOpen file Failed\nCreate File Failed\nCreate File Failed\nno shell\n\\services.exe\n200\nF::\n200 OK\n--End decrypted strings-\nScreenshots\n\n\n-----\n\n**Figure 1 - Screenshot of the following strings that are used as imports.**\n\n**Figure 2 - Screenshot of the complex stream cipher padding the initial cipher value.**\n\n\n-----\n\n**Figure 3 - Screenshot of the complex steam cipher compressing 2-bytes into 1-byte.**\n\n**cnaweb.mrslove.com**\n\nTags\n\ncommand-and-control\n\nPorts\n\n443 TCP\n\nWhois\n\nQueried whois.publicdomainregistry.com with \"mrslove.com\"...\n\nDomain Name: MRSLOVE.COM\nRegistry Domain ID: 70192241_DOMAIN_COM-VRSN\nRegistrar WHOIS Server: whois.publicdomainregistry.com\nRegistrar URL: www.publicdomainregistry.com\nUpdated Date: 2020-02-26T08:01:27Z\nCreation Date: 2001-05-02T02:10:12Z\nRegistrar Registration Expiration Date: 2021-05-02T02:10:12Z\nRegistrar: PDR Ltd. d/b/a PublicDomainRegistry.com\nRegistrar IANA ID: 303\nDomain Status: OK https://icann.org/epp#OK\nRegistry Registrant ID: Not Available From Registry\nRegistrant Name: changeip operations\nRegistrant Organization: changeip.com\nRegistrant Street: 1200 brickell ave\nRegistrant City: miami\n\n\n-----\n\nRegistrant State/Province: florida\nRegistrant Postal Code: 33131\nRegistrant Country: US\nRegistrant Phone: +1.800791337\nRegistrant Phone Ext:\nRegistrant Fax:\nRegistrant Fax Ext:\nRegistrant Email: noc@changeip.com\nRegistry Admin ID: Not Available From Registry\nAdmin Name: changeip operations\nAdmin Organization: changeip.com\nAdmin Street: 1200 brickell ave\nAdmin City: miami\nAdmin State/Province: florida\nAdmin Postal Code: 33131\nAdmin Country: US\nAdmin Phone: +1.800791337\nAdmin Phone Ext:\nAdmin Fax:\nAdmin Fax Ext:\nAdmin Email: noc@changeip.com\nRegistry Tech ID: Not Available From Registry\nTech Name: changeip operations\nTech Organization: changeip.com\nTech Street: 1200 brickell ave\nTech City: miami\nTech State/Province: florida\nTech Postal Code: 33131\nTech Country: US\nTech Phone: +1.800791337\nTech Phone Ext:\nTech Fax:\nTech Fax Ext:\nTech Email: noc@changeip.com\nName Server: ns1.changeip.com\nName Server: ns2.changeip.com\nName Server: ns3.changeip.com\nName Server: ns4.changeip.com\nName Server: ns5.changeip.com\nDNSSEC: Unsigned\nRegistrar Abuse Contact Email: abuse-contact@publicdomainregistry.com\nRegistrar Abuse Contact Phone: +1.2013775952\nURL of the ICANN WHOIS Data Problem Reporting System: http://wdprs.internic.net/\n\nRelationships\n\n\ncnaweb.mrslove.com\n\n\nConnected_From\n\n\n363ea096a3f6d06d56dc97ff1618607d462f366139df70c88310bbf77b9f9f90\n\n\n-----\n\nDescription\n\nsvchost.dll (8cf683b7d181591b91e145985f32664c) attempts to connect to the following domain.\n\n**210.68.69.82**\n\nTags\n\ncommand-and-control\n\nPorts\n\n443 TCP\n\nWhois\n\nQueried whois.apnic.net with \"210.68.69.82\"...\n\n% Information related to '210.68.0.0 - 210.68.255.255'\n\n% Abuse contact for '210.68.0.0 - 210.68.255.255' is 'hostmaster@twnic.net.tw'\n\ninetnum:    210.68.0.0 - 210.68.255.255\nnetname:    SEEDNET\ndescr:     Digital United Inc.\ndescr:     9F, No. 125, Song Jiang Road\ndescr:     Taipei, Taiwan\ncountry:    TW\nadmin-c:    JC256-AP\ntech-c:     JC256-AP\nmnt-by:     MAINT-TW-TWNIC\nmnt-irt:    IRT-TWNIC-AP\nstatus:     ALLOCATED PORTABLE\nlast-modified: 2018-12-12T06:04:02Z\nsource:     APNIC\n\nirt:      IRT-TWNIC-AP\naddress:    Taipei, Taiwan, 100\ne-mail:     hostmaster@twnic.net.tw\nabuse-mailbox: hostmaster@twnic.net.tw\nadmin-c:    TWA2-AP\ntech-c:     TWA2-AP\nauth:     # Filtered\nremarks:    Please note that TWNIC is not an ISP and is not empowered\nremarks:    to investigate complaints of network abuse.\nmnt-by:     MAINT-TW-TWNIC\nlast-modified: 2015-10-08T07:58:24Z\nsource:     APNIC\n\nperson:     Jonas Chou\nnic-hdl:    JC256-AP\ne-mail:     Jonaschou@fareastone.com.tw\naddress:    2F, No.218, Rueiguang Road\naddress: Taipei 114 R O C\n\n\n-----\n\nphone:     +886-2-7700-8888\nfax-no:     +886-2-7700-8888\ncountry:    TW\nmnt-by:     MAINT-TW-TWNIC\nlast-modified: 2012-12-18T10:10:01Z\nsource:     APNIC\n\n% Information related to '210.68.69.80 - 210.68.69.87'\n\ninetnum:    210.68.69.80 - 210.68.69.87\nnetname:    42888423-TW\ndescr:     Taipei Taiwan\ncountry:    TW\nadmin-c:    NN3251-TW\ntech-c:     NN3251-TW\nmnt-by:     MAINT-TW-TWNIC\nremarks:    This information has been partially mirrored by APNIC from\nremarks:    TWNIC. To obtain more specific information, please use the\nremarks:    TWNIC whois server at whois.twnic.net.\nchanged:    DavidLin1@fareastone.com.tw 20180330\nstatus:     ASSIGNED NON-PORTABLE\nsource:     TWNIC\n\nperson:     NULL\naddress:    N/A Taiwan\ncountry:    TW\ne-mail:     joy25488@gmail.com\nnic-hdl:    NN3251-TW\nchanged:    hostmaster@twnic.net.tw 20180331\nsource:     TWNIC\n\n% This query was served by the APNIC Whois Service version 1.88.15-SNAPSHOT (WHOIS-US4)\n\nRelationships\n\n\n210.68.69.82 Connected_From\n\nDescription\n\n\n363ea096a3f6d06d56dc97ff1618607d462f366139df70c88310bbf77b9f9f90\n\n\nsvchost.dll (8cf683b7d181591b91e145985f32664c) attempts to connect to the following IP\naddress.\n\n**6e6d3a831c03b09d9e4a54859329fbfd428083f8f5bc5f27abbfdd9c47ec0e57**\n\nTags\n\nloadertrojan\n\nDetails\n\n**Name** rasautoex.dll\n\n\n-----\n\n**Size** 50176 bytes\n\n**Type** PE32+ executable (DLL) (GUI) x86-64, for MS Windows\n\n**MD5** 4ec8e16d426a4aaa57c454c58f447c1e\n\n**SHA1** 5c89629e5873072a9ca3956b67cf7b5080312c80\n\n**SHA256** 6e6d3a831c03b09d9e4a54859329fbfd428083f8f5bc5f27abbfdd9c47ec0e57\n\n\n**SHA512**\n\n**ssdeep**\n\n\n284e0dff33f4ffb6d55f2fdb1de81d5644fb2671aa358dfb72b34a50632f708b7b071202202efec0b48bc0f622c6947f8ccf0818ebaff7277eda854cee67eeaa\n\n768:DN5oCkAI3effi5djegTXLzAl78S3ge0eYUi3EaQkDdXptOKeosAmMotwEX1:DN\n5oCk1eyTXn+qXUi3pptJMwE\n\n\n**Entropy** 5.681253\n\nAntivirus\n\n**Ahnlab** Trojan/Win64.Loader\n\n**Avira** TR/Agent.ojanf\n\n**BitDefender** Trojan.GenericKD.34284956\n\n**ClamAV** Win.Packer.Taidoor-9209869-0\n\n**Comodo** Malware\n\n**Cyren** W64/Kryptik.AVM\n\n**ESET** a variant of Win64/Agent.ACK trojan\n\n**Emsisoft** Trojan.GenericKD.34284956 (B)\n\n**Ikarus** Trojan.Win64.Agent\n\n**K7** Trojan ( 0056be3d1 )\n\n**Lavasoft** Trojan.GenericKD.34284956\n\n**McAfee** RDN/Generic trojan.ks\n\n**Microsoft Security Essentials** Trojan:Win32/Taidoor.DA!MTB\n\n**NANOAV** Trojan.Win64.Mlw.hqmqtg\n\n**Quick Heal** Trojan.Taidoor.S15351536\n\n**Sophos** Mal/Taidoor-A\n\n**Symantec** Trojan Horse\n\n**TACHYON** Trojan/W64.Dllhijacker.50176\n\n**TrendMicro** Trojan.161033AF\n\n\n-----\n\n**TrendMicro House Call** Trojan.161033AF\n\n**VirusBlokAda** Trojan.Win64.Dllhijacker\n\n**Zillya!** Trojan.Agent.Win64.5841\n\nYARA Rules\n\nNo matches found.\n\nssdeep Matches\n\nNo matches found.\n\nPE Metadata\n\n**Compile Date** 2019-01-04 02:11:55-05:00\n\n**Import Hash** 956b48719c7be61f48572c8fa464e00c\n\nPE Sections\n\n**MD5** **Name** **Raw Size** **Entropy**\n\na9b389fc8171131551c6570d2395de57 header 1024 2.619293\n\n8dabe7bfc2ee6b9819f554b2694c98eb .text 26624 6.217867\n\n8e63e6b885c3d270ccfb7607b9662601 .rdata 14848 4.618383\n\nd44f2a519c2649244a8c87581872b483 .data 4096 2.280898\n\n0aa4114597794059e1d4a2c246c7d7a5 .pdata 2048 4.331432\n\n7197f896bddfd6e434b1d5703bf0c5a2 .rsrc 512 5.097979\n\n54bb45b94c64d3717b1be8194fb4a6a7 .reloc 1024 3.689756\n\nDescription\n\nThis file is a 64-bit Windows DLL file. The file \"rasautoex.dll\" is a Taidoor loader and will decrypt\nand execute the 64-bit version of Taidoor “svchost.dll\" (6627918d989bd7d15ef0724362b67edd)\nin memory.\n\n**0d0ccfe7cd476e2e2498b854cef2e6f959df817e52924b3a8bcdae7a8faaa686**\n\nTags\n\nremote-access-trojantrojan\n\nDetails\n\n**Name** svchost.dll\n\n**Size** 183808 bytes\n\n**Type** data\n\n\n-----\n\n**MD5** 6627918d989bd7d15ef0724362b67edd\n\n**SHA1** 21e29034538bb4e3bc922149ef4312b90b6b4ea3\n\n**SHA256** 0d0ccfe7cd476e2e2498b854cef2e6f959df817e52924b3a8bcdae7a8faaa686\n\n\n**SHA512**\n\n**ssdeep**\n\n\n83ee751b15d8fd8477b8ecf8d33a4faf30b75aceb90c0e58ebf9dbbfc1d354f7e772f126b8462fd5897a4015a6f5e324d34900ff7319e8cc791fb239ca603ddc\n\n3072:7PR4kaQOrd41zdruwiAyr/Ta1XxKH3zVrWvcfWslmOLdXFKY8SIMjUPpF5:3a\nQLgwiAyr/TiXxMsvcrxbnjUPP5\n\n\n**Entropy** 7.999011\n\nAntivirus\n\n**Ahnlab** Data/BIN.EncPe\n\n**Antiy** Trojan/Win32.Taidoor\n\n**Avira** TR/Taidoor.AO\n\n**BitDefender** Trojan.Agent.EUMT\n\n**ClamAV** Win.Malware.Agent-9376986-0\n\n**Cyren** W32/Taidoor.A.enc!Camelot\n\n**Emsisoft** Trojan.Agent.EUMT (B)\n\n**Ikarus** Trojan.Win32.Taidoor\n\n**Lavasoft** Trojan.Agent.EUMT\n\n**McAfee** Trojan-Taidoor\n\n**Microsoft Security Essentials** Trojan:Win32/Taidoor.DB!MTB\n\n**Sophos** Troj/Taidoor-A\n\n**Symantec** Trojan Horse\n\n**TrendMicro** Backdoo.4FA5823A\n\n**TrendMicro House Call** Backdoo.4FA5823A\n\nYARA Rules\n\n\n-----\n\nrule CISA_10292089_01 : rat loader TAIDOOR\n{\nmeta:\nAuthor = \"CISA Code & Media Analysis\"\nIncident = \"10292089\"\nDate = \"2020-06-18\"\nLast_Modified = \"20200616_1530\"\nActor = \"n/a\"\nCategory = \"Trojan Loader Rat\"\nFamily = \"TAIDOOR\"\nDescription = \"Detects Taidoor Rat Loader samples\"\nMD5_1 = \"8cf683b7d181591b91e145985f32664c\"\nSHA256_1 =\n\"363ea096a3f6d06d56dc97ff1618607d462f366139df70c88310bbf77b9f9f90\"\nMD5_2 = \"6627918d989bd7d15ef0724362b67edd\"\nSHA256_2 =\n\"0d0ccfe7cd476e2e2498b854cef2e6f959df817e52924b3a8bcdae7a8faaa686\"\nstrings:\n$s0 = { 8A 46 01 88 86 00 01 00 00 8A 46 03 88 86 01 01 00 00 8A 46 05 88 86 02 01\n00 00 8A 46 07 88 86 03 01 00 00 }\n$s1 = { 88 04 30 40 3D 00 01 00 00 7C F5 }\n$s2 = { 0F BE 04 31 0F BE 4C 31 01 2B C3 2B CB C1 E0 04 0B C1 }\n$s3 = { 8A 43 01 48 8B 6C 24 60 88 83 00 01 00 00 8A 43 03 }\n$s4 = { 88 83 01 01 00 00 8A 43 05 88 83 02 01 00 00 8A 43 07 88 83 03 01 00 00 }\n$s5 = { 41 0F BE 14 7C 83 C2 80 41 0F BE 44 7C 01 83 C0 80 C1 E2 04 0B D0 }\n$s6 = { 5A 05 B2 CB E7 45 9D C2 1D 60 F0 4C 04 01 43 85 3B F9 8B 7E }\ncondition:\n($s0 and $s1 and $s2) or ($s3 and $s4 and $s5) or ($s6)\n}\n\nssdeep Matches\n\nNo matches found.\n\nRelationships\n\n0d0ccfe7cd... Connected_To infonew.dubya.net\n\nDescription\n\nThis encrypted file has been identified as the Taidoor RAT loaded by “rasautoex.dll\"\n(4ec8e16d426a4aaa57c454c58f447c1e). This file contains the same functionality and encryption\nkeys as the 32-bit version “svchost.dll” (8CF683B7D181591B91E145985F32664C).\n\nThis file calls out to a different C2. This C2 was also observed in memory of the infected system\nprovided for analysis.\n\n--Begin C2-infonew.dubya.net\n--End C2-\n\n-----\n\nThe malware author never removed the symbol file for “rasautoex.dll” as with the 32-bit version.\nHowever, this artifact provides some additional information that the malware author intended\nthis binary to do, “MemLoad(pass symantec)”.\n\n--Begin symbol file artifact-C:\\Users\\user\\Desktop\\MemLoad(pass symantec)\\version\\x64\\Release\\MemoryLoad.pdb\n--End symbol file artifact-\n**infonew.dubya.net**\n\nTags\n\ncommand-and-control\n\nWhois\n\nQueried whois.publicdomainregistry.com with \"dubya.net\"...\n\nDomain Name: DUBYA.NET\nRegistry Domain ID: 1861808123_DOMAIN_NET-VRSN\nRegistrar WHOIS Server: whois.publicdomainregistry.com\nRegistrar URL: www.publicdomainregistry.com\nUpdated Date: 2020-04-02T07:01:52Z\nCreation Date: 2014-06-06T17:44:43Z\nRegistrar Registration Expiration Date: 2021-06-06T17:44:43Z\nRegistrar: PDR Ltd. d/b/a PublicDomainRegistry.com\nRegistrar IANA ID: 303\nDomain Status: OK https://icann.org/epp#OK\nRegistry Registrant ID: Not Available From Registry\nRegistrant Name: changeip operations\nRegistrant Organization: changeip.com\nRegistrant Street: 1200 brickell ave\nRegistrant City: miami\nRegistrant State/Province: florida\nRegistrant Postal Code: 33131\nRegistrant Country: US\nRegistrant Phone: +1.800791337\nRegistrant Phone Ext:\nRegistrant Fax:\nRegistrant Fax Ext:\nRegistrant Email: noc@changeip.com\nRegistry Admin ID: Not Available From Registry\nAdmin Name: changeip operations\nAdmin Organization: changeip.com\nAdmin Street: 1200 brickell ave\nAdmin City: miami\nAdmin State/Province: florida\nAdmin Postal Code: 33131\nAdmin Country: US\nAdmin Phone: +1.800791337\nAdmin Phone Ext:\n\n\n-----\n\nAdmin Fax:\nAdmin Fax Ext:\nAdmin Email: noc@changeip.com\nRegistry Tech ID: Not Available From Registry\nTech Name: changeip operations\nTech Organization: changeip.com\nTech Street: 1200 brickell ave\nTech City: miami\nTech State/Province: florida\nTech Postal Code: 33131\nTech Country: US\nTech Phone: +1.800791337\nTech Phone Ext:\nTech Fax:\nTech Fax Ext:\nTech Email: noc@changeip.com\nName Server: ns1.changeip.com\nName Server: ns2.changeip.com\nName Server: ns3.changeip.com\nName Server: ns4.changeip.com\nName Server: ns5.changeip.com\nDNSSEC: Unsigned\nRegistrar Abuse Contact Email: abuse-contact@publicdomainregistry.com\nRegistrar Abuse Contact Phone: +1.2013775952\nURL of the ICANN WHOIS Data Problem Reporting System: http://wdprs.internic.net/\n\nRelationships\n\n\ninfonew.dubya.net\n\nDescription\n\n\nConnected_From\n\n\n0d0ccfe7cd476e2e2498b854cef2e6f959df817e52924b3a8bcdae7a8faaa686\n\n\nsvchost.dll (6627918d989bd7d15ef0724362b67edd) attempts to connect to the following domain.\n\n## Relationship Summary\n\n4a0688baf9... Used 363ea096a3f6d06d56dc97ff1618607d462f366139df70c88310bbf77b9f9f90\n\n363ea096a3... Used_By 4a0688baf9661d3737ee82f8992a0a665732c91704f28688f643115648c107d4\n\n\n363ea096a3... Connected_To\n\n363ea096a3... Connected_To\n\n\ncnaweb.mrslove.com\n\n\nConnected_From\n\n\ncnaweb.mrslove.com\n\n210.68.69.82\n\n363ea096a3f6d06d56dc97ff1618607d462f366139df70c88310bbf77b9f9f90\n\n\n-----\n\n210.68.69.82 Connected_From\n\n0d0ccfe7cd... Connected_To\n\n\ninfonew.dubya.net\n\n## Mitigation\n\n\nConnected_From\n\n\n363ea096a3f6d06d56dc97ff1618607d462f366139df70c88310bbf77b9f9f90\n\ninfonew.dubya.net\n\n0d0ccfe7cd476e2e2498b854cef2e6f959df817e52924b3a8bcdae7a8faaa686\n\n\nalert tcp 210.68.69.82 any <> $HOME_NET any (msg:\" Malicious traffic \"; sid:#########;\nrev:1; classtype:tcp-event;)\n\nalert tcp 156.238.3.162 any <> $HOME_NET any (msg:\"Malicious traffic\"; sid:#########;\nrev:1; classtype:tcp-event;)\n\nalert udp any any 53 <> $HOME_NET any (msg:\"Attempt to connect to malicious domain\";\ncontent:\"|03|www|07|infonew|05|dubya|03|net|00|\"; sid:#########; rev:1;)\n\nalert udp any any 53 <> $HOME_NET any (msg:\"Attempt to connect to malicious domain\";\ncontent:\"|03|www|06|cnaweb|07|mrslove|03|com|00|\"; sid:#########; rev:1;)\n\nNote: At the time of analysis, one of the domains resolved to the IP address 156.238.3.162.\n\n## Recommendations\n\nCISA recommends that users and administrators consider using the following best practices to\nstrengthen the security posture of their organization's systems. Any configuration changes should\nbe reviewed by system owners and administrators prior to implementation to avoid unwanted\nimpacts.\n\nMaintain up-to-date antivirus signatures and engines.\nKeep operating system patches up-to-date.\nDisable File and Printer sharing services. If these services are required, use strong\npasswords or Active Directory authentication.\nRestrict users' ability (permissions) to install and run unwanted software applications. Do\nnot add users to the local administrators group unless required.\nEnforce a strong password policy and implement regular password changes.\nExercise caution when opening e-mail attachments even if the attachment is expected and\nthe sender appears to be known.\nEnable a personal firewall on agency workstations, configured to deny unsolicited\nconnection requests.\nDisable unnecessary services on agency workstations and servers.\nScan for and remove suspicious e-mail attachments; ensure the scanned attachment is its\n\"true file type\" (i.e., the extension matches the file header).\nMonitor users' web browsing habits; restrict access to sites with unfavorable content.\nExercise caution when using removable media (e.g., USB thumb drives, external drives,\nCDs, etc.).\nScan all software downloaded from the Internet prior to executing.\n\n\n-----\n\nMaintain situational awareness of the latest threats and implement appropriate Access\nControl Lists (ACLs).\n\nAdditional information on malware incident prevention and handling can be found in National\nInstitute of Standards and Technology (NIST) Special Publication 800-83, \"Guide to Malware\n**Incident Prevention & Handling for Desktops and Laptops\".**\n\n## Contact Information\n\nCISA continuously strives to improve its products and services. You can help by answering a very\nshort series of questions about this product at the following URL:\n[https://www.cisa.gov/forms/feedback/](https://www.cisa.gov/forms/feedback/)\n\n## Document FAQ\n\n**What is a MIFR? A Malware Initial Findings Report (MIFR) is intended to provide**\norganizations with malware analysis in a timely manner. In most instances this report will\nprovide initial indicators for computer and network defense. To request additional analysis,\nplease contact CISA and provide information regarding the level of desired analysis.\n\n**What is a MAR? A Malware Analysis Report (MAR) is intended to provide organizations with**\nmore detailed malware analysis acquired via manual reverse engineering. To request additional\nanalysis, please contact CISA and provide information regarding the level of desired analysis.\n\n**Can I edit this document? This document is not to be edited in any way by recipients. All**\ncomments or questions related to this document should be directed to the CISA at 1-888-282[0870 or CISA Service Desk](mailto:CISAservicedesk@cisa.dhs.gov) .\n\n**Can I submit malware to CISA? Malware samples can be submitted via three methods:**\n\n[Web: https://malware.us-cert.gov](https://malware.us-cert.gov/)\n[E-Mail: submit@malware.us-cert.gov](mailto:submit@malware.us-cert.gov)\nFTP: ftp.malware.us-cert.gov (anonymous)\n\nCISA encourages you to report any suspicious activity, including cybersecurity incidents, possible\nmalicious code, software vulnerabilities, and phishing-related scams. Reporting forms can be\n[found on CISA's homepage at www.cisa.gov.](http://www.cisa.gov/)\n\n## Revisions\n\nAugust 3, 2020: Initial Version\n\nAugust 3, 2020: Corrected Snort rules\n\nAugust 31, 2020: Updated\n\n[This product is provided subject to this Notification and this Privacy & Use policy.](https://us-cert.cisa.gov/privacy/notification)\n\n[Was this document helpful? Yes | Somewhat | No](https://us-cert.cisa.gov/forms/feedback?helpful=yes&document=AR20-216A:%20MAR-10292089-1.v2%20%E2%80%93%20Chinese%20Remote%20Access%20Trojan:%20TAIDOOR&trackingNumber=&url=https://us-cert.cisa.gov/ncas/analysis-reports/ar20-216a&site_name=US-CERT)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        }
    ],
    "references": [
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2020/2020.08.03.TAIDOOR/MAR-10292089-1.v2%20%E2%80%93%20Chinese%20Remote%20Access%20Trojan_%20TAIDOOR%20_%20CISA.pdf"
    ],
    "report_names": [
        "MAR-10292089-1.v2 – Chinese Remote Access Trojan_ TAIDOOR _ CISA"
    ],
    "threat_actors": [
        {
            "id": "71b19e59-b5f7-4bc6-816d-194be0f02af0",
            "created_at": "2022-10-25T16:07:24.301036Z",
            "updated_at": "2025-03-27T02:02:10.165121Z",
            "deleted_at": null,
            "main_name": "Taidoor",
            "aliases": [
                "Budminer",
                "Earth Aughisky"
            ],
            "source_name": "ETDA:Taidoor",
            "tools": [
                "Dripion",
                "Masson",
                "Taidoor",
                "simbot"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "f8dddd06-da24-4184-9e24-4c22bdd1cbbf",
            "created_at": "2023-01-06T13:46:38.626906Z",
            "updated_at": "2025-03-27T02:00:02.877001Z",
            "deleted_at": null,
            "main_name": "Tick",
            "aliases": [
                "Stalker Taurus",
                "PLA Unit 61419",
                "Nian",
                "BRONZE BUTLER",
                "REDBALDKNIGHT",
                "STALKER PANDA",
                "G0060"
            ],
            "source_name": "MISPGALAXY:Tick",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "50bd4a6c-7542-4bdd-8b37-ab468fc428ef",
            "created_at": "2023-01-06T13:46:38.998658Z",
            "updated_at": "2025-03-27T02:00:02.973354Z",
            "deleted_at": null,
            "main_name": "Taidoor",
            "aliases": [
                "G0015",
                "Earth Aughisky"
            ],
            "source_name": "MISPGALAXY:Taidoor",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "478e9b27-39b9-49e4-a3c5-81569a767275",
            "created_at": "2022-10-25T15:50:23.417339Z",
            "updated_at": "2025-03-27T02:00:55.464624Z",
            "deleted_at": null,
            "main_name": "Taidoor",
            "aliases": [
                "Taidoor"
            ],
            "source_name": "MITRE:Taidoor",
            "tools": null,
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "d4e7cd9a-2290-4f89-a645-85b9a46d004b",
            "created_at": "2022-10-25T16:07:23.419513Z",
            "updated_at": "2025-03-27T02:02:09.790389Z",
            "deleted_at": null,
            "main_name": "Bronze Butler",
            "aliases": [
                "Bronze Butler",
                "CTG-2006",
                "Operation ENDTRADE",
                "RedBaldNight",
                "Stalker Panda",
                "Stalker Taurus",
                "TEMP.Tick",
                "Tick"
            ],
            "source_name": "ETDA:Bronze Butler",
            "tools": [
                "8.t Dropper",
                "8.t RTF exploit builder",
                "8t_dropper",
                "9002 RAT",
                "AngryRebel",
                "Blogspot",
                "Daserf",
                "Datper",
                "Elirks",
                "Farfli",
                "Gh0st RAT",
                "Ghost RAT",
                "HOMEUNIX",
                "HidraQ",
                "HomamDownloader",
                "Homux",
                "Hydraq",
                "Lilith",
                "Lilith RAT",
                "McRAT",
                "MdmBot",
                "Mimikatz",
                "Minzen",
                "Moudour",
                "Muirim",
                "Mydoor",
                "Nioupale",
                "PCRat",
                "POISONPLUG.SHADOW",
                "Roarur",
                "RoyalRoad",
                "ShadowPad Winnti",
                "ShadowWali",
                "ShadowWalker",
                "SymonLoader",
                "WCE",
                "Wali",
                "Windows Credential Editor",
                "Windows Credentials Editor",
                "XShellGhost",
                "XXMM",
                "gsecdump",
                "rarstar"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "bf0489c5-1c07-41e6-91c9-855ad96ccc6a",
            "created_at": "2022-10-25T16:47:55.541639Z",
            "updated_at": "2025-03-27T02:05:17.253496Z",
            "deleted_at": null,
            "main_name": "BRONZE BUTLER",
            "aliases": [
                "Daserf",
                "Stalker Panda ",
                "Tick ",
                "CTG-2006 "
            ],
            "source_name": "Secureworks:BRONZE BUTLER",
            "tools": [
                " DGet",
                " Daserf",
                " Datper",
                " Gofarer",
                " MSGet",
                " Mimikatz",
                " RarStar",
                " Screen Capture Tool",
                " ShadowPad",
                " T-SMB",
                " WinRAR",
                " Windows Credential Editor",
                " gsecdump",
                " xmm downloader",
                " xxmm",
                "ABK"
            ],
            "source_id": "Secureworks",
            "reports": null
        }
    ],
    "ts_created_at": 1666716495,
    "ts_updated_at": 1743041638,
    "ts_creation_date": 1601026603,
    "ts_modification_date": 1601026603,
    "files": {
        "pdf": "https://archive.orkl.eu/4fa97bcbbda216a683c7b1b4105870086422bc8a.pdf",
        "text": "https://archive.orkl.eu/4fa97bcbbda216a683c7b1b4105870086422bc8a.txt",
        "img": "https://archive.orkl.eu/4fa97bcbbda216a683c7b1b4105870086422bc8a.jpg"
    }
}