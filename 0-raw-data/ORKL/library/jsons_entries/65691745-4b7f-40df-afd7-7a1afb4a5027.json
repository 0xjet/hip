{
    "id": "65691745-4b7f-40df-afd7-7a1afb4a5027",
    "created_at": "2023-01-12T15:00:18.735736Z",
    "updated_at": "2025-03-27T02:17:14.959761Z",
    "deleted_at": null,
    "sha1_hash": "89261aa74b30d0298e919e3b32c48daba9e825a9",
    "title": "2020-03-10 - Kimsuky group- tracking the king of the spear phishing",
    "authors": "",
    "file_creation_date": "2022-05-28T03:53:57Z",
    "file_modification_date": "2022-05-28T03:53:57Z",
    "file_size": 4243733,
    "plain_text": "# VB2019 paper: Kimsuky group: tracking the king of the spear phishing\n\n**[virusbulletin.com/virusbulletin/2020/03/vb2019-paper-kimsuky-group-tracking-king-spearphishing/](https://www.virusbulletin.com/virusbulletin/2020/03/vb2019-paper-kimsuky-group-tracking-king-spearphishing/)**\n\n### Jaeki Kim, Kyoung-Ju Kwak & Min-Chang Jang\n\n_Financial Security Institute, Republic of Korea_\n\nTable of contents\n\nAbstract\n\n1. Introduction\n\n2. Related cases\n\n3. Toolset characteristics\n\nServer-side toolkits\n\nMailer (shape & core), beaconer, phisher, logger\n\nMalware\n\nDropper (malicious or camouflaged HWP documents), script, infostealer\n\n4. Tracking malware and monitoring C&C servers\n\nAttacker ≠ defender: OpSec failures\nOpSec failure case 1: Directory listing\n\nCase 1.1: After DOKKAEBI campaign: H-DS (distribution) type\n\nCase 1.2: Malware camouflaged as HWP documents\n\nOpSec failure case 2: Leaked FTP access information\n\nOpSec failure case 3: File download vulnerability\n\nRelationships analysis\n\nConclusion\n\nReferences\n\n## Abstract\n\nThe Kimsuky group is a threat group that is known to have been behind the KHNP (Korea Hydro & Nuclear Power) cyber\nterrorism attacks of 2014 and is still active in 2019.\n\nSince 2018, we have been profiling and tracking spear-phishing emails and malicious code related to the Kimsuky group.\n\nThe spear-phishing emails used by the group have been determined to have the purpose of stealing web portal account\ninformation and delivering malicious code. The main targets are government and military officials, as well as journalists.\n\nWe have analysed the changing behaviour of the Kimsuky group through ongoing tracking of the IoCs related to Kimsuky,\nincluding simple account hijacking.\n\nIn this paper, we present the results of an analysis not only of the malware used by the Kimsuky group but also of serverside samples (tools and templates that send out spear-phishing emails, like a phishing rod) which we recently\ninvestigated.\n\nWe have also confirmed that the C&C server used for the earlier attack continues to be used for various purposes, such\nas distribution of malicious code, logging of infections, and sending phishing mail.\n\n## 1. Introduction\n\nIn September 2013, Kaspersky Lab announced an APT attack targeting major Korean agencies [1]. According to the data,\nthe Kimsuky group was using malicious Hangul documents, like other attack groups targeting Korea, and the attack\nfeatured remote control tools (such as Team Viewer) and communication channel configuration using webmail. In\n\n\n-----\n\nFebruary and March 2014, attacks that seemed to have been carried out by the same group against Korean public\ninstitutions continued to occur [2].\n\nIn December 2014, an attempt was made to destroy PC disks by sending 5,986 spear-phishing emails to 3,571\nemployees of Korea Hydro & Nuclear Power Co., Ltd. However, only eight PCs were infected with malware, of which five\nhard disks were initialized.\n\nThe malware used in this spear-phishing attack was similar in structure and operation to the malware used by the\nKimsuky group, and the Hangul word processor vulnerability used in the malware was the same as that used in the\nKimsuky malware. From these results, we inferred that the focus of the Kimsuky group was on social confusion and\nmonitoring of North Korean defectors and politicians, rather than acquiring money.\n\nIn June 2015, a number of web portal email accounts were hacked, sending emails with malicious Hangul document files\nand phishing emails to steal portal account credentials. In January 2016, a large number of emails with malicious\nattachments were sent under the guise of ‘Office of National Security at the Blue House’ to government research\ninstitutes. Analysis by related organizations identified the malicious attachment as Kimsuky malware [3].\n\n## 2. Related cases\n\nIn January 2019, an email suspected to be carrying malicious code was sent to dozens of journalists, most of whom were\ncovering South Korea’s ministry in charge of relations with North Korea, prompting an investigation into the incident. The\nemail, which was entitled ‘TF reference info’ and had a compressed file attached, was sent to more than 70 reporters,\nmost of whom were members of the unification ministry’s press corps. It was sent through a private email address from a\nperson named ‘Yoon Hong-geun’. The ministry suspected that it contained malicious code designed for hacking [4]. This\nissue was known variously as Operation Cobra Venom [5], Operation Kitty Phishing [6] and Operation Kabar Cobra [7].\n\n## 3. Toolset characteristics\n\nIn the process of tracking the Kimsuky group, we were able to acquire the mail-sending tools and malware used in various\nspear-phishing attacks. The attack tools used by the Kimsuky group can be broadly categorized into server-side toolkits\nand malware.\n\n### Server-side toolkits\n\n**Mailer (shape & core), beaconer, phisher, logger**\n\nThe Kimsuky group created a mailing toolkit for attack and used it repeatedly. We found that, when constructing phishing\npages for account takeover, they reused the existing source code of the original site and specific arguments in the URL.\n\n\n-----\n\nFigure 1: Daum portal phishing page.\n\n### Malware\n\n**Dropper (malicious or camouflaged HWP documents), script, infostealer**\n\nThe malware used by the Kimsuky group in recent spear-phishing attacks includes a dropper that is a malicious or\ncamouflaged HWP file; a malicious script, which logs and downloads additional malware to the C&C server; and an\ninfostealer. Some infostealers have a module that downloads additional malware.\n\nExamples of the flow of malware used in spear-phishing attacks are shown in Figure 2.\n\n\n-----\n\nFigure 2: The flow of malware used in spear-phishing attacks.\n\nA classification of the attack tools used by the Kimsuky group is shown in Table 1.\n\n|Name|No.|Type|Details|\n|---|---|---|---|\n|Mailer (shape)|1|Mailer|Mailer (just shape)|\n|Mailer (core)|2|Mailer|Mailer (actual function) 1) Attachment of malwa re 2) Link to phishing page fo r account hijack|\n|Beaconer|3|Web beacon|Beacon to check whether mail is being viewed|\n|Phisher|4|Account stealer, phishing|Phishing toolkit(lod) phishing page for account stealing|\n|Logger|5|Logging, phishing|Logging of phishing target information|\n\n\nMalicious\nHWP\n\n\n6 Dropper, spear phishing Malicious HWP documents\n\n\n-----\n\n|Camouflaged HWP|7|Dropper, spear phishing|Camouflaged HWP documents (e.g. sfx, exe)|\n|---|---|---|---|\n|Script|8|Downloader, logging|Downloads additional malware and logs (e.g. *.vbs, *.wsf, *.jse, *.ps1)|\n|Infostealer|9|C&C, DLL, downloader, FTP logging|Steals information from infected target and downloads additional malware (in some cases using FTP)|\n\n\nTable 1: Kimsuky toolset.\n\n## 4. Tracking malware and monitoring C&C servers\n\n### Attacker ≠ defender: OpSec failures\n\nThe attacker and defender are on different sides [8]. In addition, an attacker who continues to attack does not have a\ngood understanding of defence. There can be a difference between an attacking position and a defending position.\n\nAfter all, attackers are also in the position of developing malware and server-side toolkits.\n\nAttackers who develop various attack tools are in the same position as those in general development. While working\nwithin a limited timeframe and with limited resources, information leakage and vulnerabilities can occur naturally due to\ncode reuse or C&C server operation mistakes.\n\nIn the course of investigating and analysing the C&C server, several security weaknesses were discovered, which\nprovided us with good information for investigation and tracking. We will look at the following cases of OpSec failure:\n\n1. Directory listing\n2. Leaked FTP access information\n3. File download vulnerability\n\n### OpSec failure case 1: Directory listing\n\n**Case 1.1: After DOKKAEBI campaign: H-DS (distribution) type**\n\n**Name** **No.** **Type** **Details**\n\nMalicious HWP 6 Dropper, spear-phishing Malicious HWP documents\n\nScript 8 Downloader, logging Downloads additional malware and logs (e.g.\n\n*.vbs, *.wsf, *.jse, *.ps1)\n\nTable 2: Related toolset.\n\n|Name|No.|Type|Details|\n|---|---|---|---|\n|Malicious HWP|6|Dropper, spear-phishing|Malicious HWP documents|\n|Script|8|Downloader, logging|Downloads additional malware and logs (e.g. *.vbs, *.wsf, *.jse, *.ps1)|\n\n\n-----\n\nFigure 3: Profiling of malicious Hangul files.\n\nFollowing the DOKKAEBI campaign, malicious Hangul documents were continuously analysed [9]. During this process,\nwe tracked a C&C server (suppcrt-seourity[.]esy.es) and malware related to malicious Hangul documents.\n\nThe file name of the malicious Hangul sample uploaded to VirusTotal on 23 May 2018 (shown in Figure 4) is ‘종전선\n언.hwp’ (‘Declaration of war end’) [10].\n\nFigure 4: Malicious Hangul sample 종전선언.hwp.\n\nThe overall flow of the sample is as follows [11].\n\n\n-----\n\nFigure 5: Sample flow.\n\n**Name** **No.** **Type** **MD5**\n\n‘Second Road to Go: Building a Peace System for 1 Initial 8332be776617364c16868c1ad6b4efe7\nUnification’ dropper\n\ncore.dll (OneDll.dll) 2 DLL 4de21c3af64b3b605446278de92dfff4\n(dropper)\n\nfontchk.jse 3 Script f22db1e3ea74af791e34ad5aa0297664\n\nbrid.ige (zerodll.dll) 4 DLL 2FB20830564AC781AFB7D5F422BECFC9\n\nTable 3: Malware.\n\nThe malware fontchk.jse records the infection information (date, time, IP address, MAC address, etc.) in the path\n\n[C&C]/update/fonts/log.txt, as shown in Figure 6. In this way, the files (including the malware) and log files that exist on\nthe C&C server can easily be obtained.\n\nFigure 6:\n\nFontchk.jse records the infection information in the path [C&C]/update/fonts/log.txt.\n\nSince a lot of resources are required to build and verify (check the actual operation of) the C&C servers used by\nattackers, we monitor them continuously, based on the assumption that they are likely to be recycled (reused) rather than\nbeing used once and then destroyed.\n\nA new log was recorded on the C&C server on 2018-07-10 (D+49), leading us to conduct further investigation and\nanalysis.\n\nFigure 7: New infection log.\n\nThe C&C server leaked its directory listing and didn’t have proper access control, so it was possible to check the\nremaining logs following an infection.\n\n|Name|No.|Type|MD5|\n|---|---|---|---|\n|‘Second Road to Go: Building a Peace System for Unification’|1|Initial dropper|8332be776617364c16868c1ad6b4efe7|\n|core.dll (OneDll.dll)|2|DLL (dropper)|4de21c3af64b3b605446278de92dfff4|\n|fontchk.jse|3|Script|f22db1e3ea74af791e34ad5aa0297664|\n|brid.ige (zerodll.dll)|4|DLL|2FB20830564AC781AFB7D5F422BECFC9|\n\n\n-----\n\nFigure 8: MAC address look-up [12].\n\nPreviously, we analysed C&C servers, and we saw that the MAC address is used as the directory path. Using this\ninformation, we were able to obtain additional malware by using the MAC address written in the infection log.\n\n**Name** **No.** **Type** **MD5** **Details**\n\nzerobase 1 Binary 53ac231e8091abcd0978124f9268b4e4 XOR encoding\n\nHanyangUpload_script.dll 2 DLL 8b59ea1ee28e0123da82801abc0cce4d XOR decoding - 0x09FD8477\n\ncac.wsf 3 Script fa2ffcd70fba43dd0653a0ec87863d8a File upload to C&C server\n\nTable 4: Malware obtained using MAC address C485088EXXXX.\n\nFigure 9: Tracking the C&C server and discovering new\n\nmalware zerobase (not found in VirusTotal).\n\nWe confirmed that zerobase (MD5: 53ac231e8091abcd0978124f9268b4e4) had four-byte XOR encoding (key:\n0x09FD8477), and a PE file was obtained through decoding, as shown in Figure 10.\n\nFigure 10: The file had four-byte XOR encoding (key: 0x09FD8477) a PE file was obtained through decoding.\n\nThe original DLL name identified in the four-byte XOR-decoded malware is HanyangUpload_script.dll.\n\n|Name|No.|Type|MD5|Details|\n|---|---|---|---|---|\n|zerobase|1|Binary|53ac231e8091abcd0978124f9268b4e4|XOR encoding|\n|HanyangUpload_script.dll|2|DLL|8b59ea1ee28e0123da82801abc0cce4d|XOR decoding - 0x09FD8477|\n|cac.wsf|3|Script|fa2ffcd70fba43dd0653a0ec87863d8a|File upload to C&C server|\n\n\n-----\n\nFigure 11: HanyangUpload_script.dll.\n\nThe function of the malware (HanyangUpload_script.dll) is as follows:\n\n1. Collect information from infected computers.\n\nFigure 12: Collecting information.\n\n2. Scan specific files.\n\nFigure 13: Scanning files.\n\n3. Upload files (AllList_[MAC Address]_YYMMDD_HHMMSS) to the C&C server using a script (cac.wsf)\n\n\n-----\n\nFigure 14: Uploading files to C&C server.\n\n**Case 1.2: Malware camouflaged as HWP documents**\n\n|Name|No.|Type|Details|\n|---|---|---|---|\n\n\n-----\n\n|Mailer (shape)|1|Mailer|Mailer (just shape)|\n|---|---|---|---|\n|Mailer (core)|2|Mailer|Mailer (actual function) 1) Attachment of malwa re 2) Link to phishing page fo r account hijack|\n|Beaconer|3|Web beacon|Beacon to check whether mail is being viewed|\n|Camouflaged HWP|7|Dropper, spear phishing|Camouflaged HWP documents (e.g. sfx, exe)|\n|Script|8|Downloader, logging|Downloads additional malware and logs (e.g. *.vbs, *.wsf, *.jse, *.ps1)|\n|Infostealer|9|C&C, DLL, FTP|Steals information from infected target and downloads additional malware (in some cases using FTP)|\n\n\nTable 5: Related toolset.\n\nAmong the tools described above, this malware is camouflaged as an HWP document [13].\n\nFigure 15: Malware camouflaged as an HWP document.\n\n**Name** **No.** **Type** **MD5** **Details**\n\n111.scr 1 SFX 10a120f573874c2af6b9172a26fdc597 Camouflaged as HWP documents\n\n1.hwp 2 HWP ae5ddda3749dcd72bc6cf6d658c5e31c Normal HWP\n\n1.vbs 2 Script 0718bfc5957758d22af02e726cb25fe3 Base64 decoding ⇒ ps1\n\nPowershell 3 Script fa2ffcd70fba43dd0653a0ec87863d8a Additional malware download (C&C: primaryhelp[.]esy.es)\n\nTable 6: Malware.\n\nAt the time of analysing the malware, additional malware was downloaded from the C&C server.\n\n|Name|No.|Type|MD5|Details|\n|---|---|---|---|---|\n|111.scr|1|SFX|10a120f573874c2af6b9172a26fdc597|Camouflaged as HWP documents|\n|1.hwp|2|HWP|ae5ddda3749dcd72bc6cf6d658c5e31c|Normal HWP|\n|1.vbs|2|Script|0718bfc5957758d22af02e726cb25fe3|Base64 decoding ⇒ ps1|\n|Powershell|3|Script|fa2ffcd70fba43dd0653a0ec87863d8a|Additional malware download (C&C: primary- help[.]esy.es)|\n\n\n-----\n\nFigure 16: Additional malware being downloaded from the C&C server.\n\nAs in the previous case, we continued to monitor the server, based on the assumption that the attacker would reuse the\nC&C server they had built.\n\nAs a result of our continued monitoring, we confirmed that a new file was uploaded to the C&C server on 2019-04-01\n(D+42) and conducted further investigation and analysis.\n\nFigure 17: Mailer (shape): mail.php.\n\nThe C&C server (primary-help[.]esy.es) is also a directory listing as shown in Figure 8.\n\nWe checked that the new files, mail.php and mail_ok.php, were uploaded to the C&C server.\n\nFigure 18: The new files were uploaded to the C&C server.\n\nWe confirmed that these files are tools for sending mail (i.e. mailers).\n\nIf we enter the sender and receiver information (name/email), title and contents and select ‘COMMIT’, then we can\nconfirm that mail.php is a mailer – the actual operation is performed by mail_ok.php.\n\n\n-----\n\nFigure 19: Mail.php is a mailer. The actual operation is performed by mail_ok.php.\n\nWhen using the mailer, the mail was indeed sent the normal way, but with new malware attached.\n\n\n-----\n\nFigure 20: The mail was sent normally\n\nand new malware was attached.\n\nIn addition, we confirmed that the web beacon was applied to check whether the mail was read, using reading.php\ndefined in the <img> tag in the mail sent by the mailer.\n\n\n-----\n\nFigure 21: The web beacon was applied to check whether the mail was read.\n\n### OpSec failure case 2: Leaked FTP access information\n\n**Name** **No.** **Type** **Details**\n\nMailer 1 Mailer Mailer (just shape)\n(shape)\n\nMailer 2 Mailer Mailer (actual function)\n(core) 1) Attachment of malware\n\n2) Link to phishing page for account hijack\n\nBeaconer 3 Web beacon Beacon to check whether mail is being viewed\n\nPhisher 4 Account stealer, Phishing toolkit(lod) phishing page for account stealing\nphishing\n\nLogger 5 Logging, phishing Logging of phishing target information\n\nScript 8 Downloader, Downloads additional malware and logs (e.g. *.vbs, *.wsf, *.jse, *.ps1)\nlogging\n\nInfostealer 9 C&C, DLL, FTP Steals information from infected target and downloads additional malware (in\nsome cases using FTP)\n\nTable 7: Related toolset.\n\nAmong infostealers used by the Kimsuky group, some samples have been found that use FTP to download additional\nmalware after logging infected targets to the C&C [14, 15].\n\nThe malware uses the Hostinger free hosting service as a C&C server, and there is a security weakness in that the\n[account (u428325809 ) and password ([email protected]#) used for FTP communication are exposed in plain text.](https://www.virusbulletin.com/cdn-cgi/l/email-protection)\n\n|Name|No.|Type|Details|\n|---|---|---|---|\n|Mailer (shape)|1|Mailer|Mailer (just shape)|\n|Mailer (core)|2|Mailer|Mailer (actual function) 1) Attachment of malwa re 2) Link to phishing page fo r account hijack|\n|Beaconer|3|Web beacon|Beacon to check whether mail is being viewed|\n|Phisher|4|Account stealer, phishing|Phishing toolkit(lod) phishing page for account stealing|\n|Logger|5|Logging, phishing|Logging of phishing target information|\n|Script|8|Downloader, logging|Downloads additional malware and logs (e.g. *.vbs, *.wsf, *.jse, *.ps1)|\n|Infostealer|9|C&C, DLL, FTP|Steals information from infected target and downloads additional malware (in some cases using FTP)|\n\n\n-----\n\nFigure 22: The account (u428325809 ) and\n\n[password ([email protected]#) used for FTP communication are exposed in plain text.](https://www.virusbulletin.com/cdn-cgi/l/email-protection)\n\nThe same (or similar) FTP account information was identified in the other malware found after this malware (2019-04-03).\n\n_MD5:_\n\n_MD5:_\n_0b65e3f7a40261232dd93f472933fb72_\n\n_f38a8ba888c5732236a5e0653826a267_\n\nFigure 23: The same or similar FTP account information was used.\n\n**C&C** **Date** **Login ID** **Password** **Details**\n\nuser-daum-center[.]pe.hu @2019/04/03 u859027282 [[email protected]#](https://www.virusbulletin.com/cdn-cgi/l/email-protection) Same password (1)\n\nuser-protect-center[.]pe.hu @2019/04/09 u428325809 [[email protected]#](https://www.virusbulletin.com/cdn-cgi/l/email-protection) Same password (1)\n\nnid-protect-team[.]pe.hu @2019/04/17 u621356999 [[email protected]#](https://www.virusbulletin.com/cdn-cgi/l/email-protection) Same password (1)\n\noeks39402[.]890m.com @2019/05/15 u487458083 rhdwn111 Same password (2) same UID\n\nnid-management- @2019/05/16 u142759695 [[email protected]#](https://www.virusbulletin.com/cdn-cgi/l/email-protection) Same password (1)\nteam[.]890m.com\n\nnaiei-aldiel[.]16mb.com @2019/05/27 u487458083 [[email protected]#](https://www.virusbulletin.com/cdn-cgi/l/email-protection) Similar password (1) same\nUID\n\n|C&C|Date|Login ID|Password|Details|\n|---|---|---|---|---|\n|user-daum-center[.]pe.hu|@2019/04/03|u859027282|[email protected]#|Same password (1)|\n|user-protect-center[.]pe.hu|@2019/04/09|u428325809|[email protected]#|Same password (1)|\n|nid-protect-team[.]pe.hu|@2019/04/17|u621356999|[email protected]#|Same password (1)|\n|oeks39402[.]890m.com|@2019/05/15|u487458083|rhdwn111|Same password (2) same UID|\n|nid-management- team[.]890m.com|@2019/05/16|u142759695|[email protected]#|Same password (1)|\n\n\n-----\n\nvkcxvkweo[.]96.lt @2019/06/07 u487458083 rhdwn111 Same password (2) same UID\n\nTable 8: Leaked FTP authentication information.\n\nThe FTP account information used in the malware can expose the C&C server to attacks. The string ‘victory’ used in the\npassword has also been found in the b374k webshell used by the Kimsuky group.\n\nFigure 24: The b374k webshell.\n\n### OpSec failure case 3: File download vulnerability\n\n**Name** **No.** **Type** **Details**\n\nMailer 1 Mailer Mailer (just shape)\n(shape)\n\nMailer 2 Mailer Mailer (actual function)\n(core) 1) Attachment of malware\n\n2) Link to phishing page for account\n\nMalicious 6 Dropper, spear Malicious HWP documents\nHWP phishing\n\nScript 8 Downloader, Downloads additional malware and logs (e.g. *.vbs, *.wsf, *.jse, *.ps1)\nlogging\n\nInfostealer 9 C&C, DLL, FTP Steals information from infected target and downloads additional malware (in\nsome cases using FTP)\n\nTable 9: Related toolsets.\n\nWe captured the situation where the mailer and attachments used the same C&C server (member-authorize[.]com) when\nthe Kimsuky group also sent attachments with spear-phishing emails.\n\n|Name|No.|Type|Details|\n|---|---|---|---|\n|Mailer (shape)|1|Mailer|Mailer (just shape)|\n|Mailer (core)|2|Mailer|Mailer (actual function) 1) Attachment of malwa re 2) Link to phishing page fo r account|\n|Malicious HWP|6|Dropper, spear phishing|Malicious HWP documents|\n|Script|8|Downloader, logging|Downloads additional malware and logs (e.g. *.vbs, *.wsf, *.jse, *.ps1)|\n|Infostealer|9|C&C, DLL, FTP|Steals information from infected target and downloads additional malware (in some cases using FTP)|\n\n\n-----\n\nFigure 25: The mailer and attachments used the same C&C server (member-authorize[.]com).\n\nThe C&C server had directory listings enabled, and there was a file download vulnerability in download.php, the file used\nto downloaded the .hwp attachment.\n\nFigure 26: Index of the /security/downloads directory\n\non the C&C server.\n\n|Name|No.|Type|MD5|Details|\n|---|---|---|---|---|\n|1234.eml|0|EML|b90ed8fe3160ce49d69d000b1005c0c5|Spear-phishing email|\n|20190312_Japanrelated daily trends(FN).hwp|1|HWP|abafa0cbfbe18afe6dd635d14e7d03d3|Malicious Hangul documents (malicious postscript)|\n|Powershell|2|Script|6d73e394762022f3cc426b0a37c4e694|GET ddlove[.]kr/bbs/data/1|\n|1.wsf|3|Script|e3dcfd19a6054f7b436b09e8ea9f37a5|(a) Set var (b) Check Extract Util – WinRAR / ALZip (c) Check response (d) Save file & extract (e) or Save file & decode (f) Execute file|\n|Romanic.fm|4|Encoded PE|9d453684e78ae95b0833c16ef8df6c4f|Base64 encoding|\n|Romanic.ft|4|RAR|da2eefeb7ff5a13c0d890d4ccc0e35e1|Extract P/W: 201811|\n\n\n-----\n\nFreedom.dll 5 PE 05075cb9a05d0cce7263842c43f5cf8b Export name: GrapHouse Check\nEnv (32/64) 64bit :\n/bbs/data/font/exts.fmt Process\nHollowing (explorer.exe) - [SND]:\n/register.php?\nWORD=com_XXXXXXXX&NOTE=\n[GET]:\n/bbs/data/ariaK[T]_XXXXXXXX \n[DEL]: /join.php?file=\n\nariaK_XXXXXXXX 6 Encoded e8d9d604615bd85862dce00bd8121b92 XOR TABLE encoding\nPE\n\nOnlyFileList.dll 7 PE cd5bee99bcae12da1d92cd252f30bd86 Export name: GrapHouse\nFileUpload(AllList_[MAC\nAddress]_YYMMDD_HHMMSS) to\nC&C server\n\nTable 10: Malware.\n\nThe attacker has built a mailer in the path of the name of each phishing target.\n\nFigure 27: Phishing targets include Daum, KINU and\n\nNaver.\n\nThe mailer was found on the C&C server just as in the first OpSec failure case.\n\n|Col1|Col2|Col3|Col4|/register.php? WORD=com_XXXXXXXX&NOTE=- [GET]: /bbs/data/ariaK[T]_XXXXXXXX - [DEL]: /join.php?file=|\n|---|---|---|---|---|\n|ariaK_XXXXXXXX|6|Encoded PE|e8d9d604615bd85862dce00bd8121b92|XOR TABLE encoding|\n|OnlyFileList.dll|7|PE|cd5bee99bcae12da1d92cd252f30bd86|Export name: GrapHouse FileUpload(AllList_[MAC Address]_YYMMDD_HHMMSS) to C&C server|\n\n\n-----\n\nFigure 28: Mailer found on the C&C server.\n\n## Relationships analysis\n\nIn the process of tracking the Kimsuky group attack, we analysed the relationships of a large quantity of data, and\ninvestigated C&C servers located in South Korea through an investigation agency. Figure 29 show the associations that\nwere found between the toolsets and C&C servers classified in our research.\n\n\n-----\n\nFigure 29: Relationships between C&C servers and toolsets.\n\nSome of the results of analysing the relationships between toolsets and C&C servers used by the Kimsuky group in\nspear-phishing attacks are as follows.\n\ngyjmc[.]com (KR) → member-authorize[.]com (HOSTINGER) →\nddlovke[.]kr (KR) → military[.]co.kr (KR) ← suppcrt-seourity[.]esy.es(HOSTINGER)\n\nFigure 30 shows a graphical representation of the relationships.\n\n\n-----\n\nFigure 30: Graphical representation of the Kimsuky relationships.\n\nThrough its reuse of resources, we were able to track the attack performed by the Kimsuky group.\n\n## Conclusion\n\nDue to the particular circumstances of South Korea, the Kimsuky group continuously conducts malicious acts by abusing\n(or camouflaging) documents created in Hangul and phishing for email account credentials in order to hijack accounts.\nSimilar attacks have continued.\n\nHowever, in the process of tracking the Kimsuky group, we have obtained various pieces of important information through\ncases of OpSec failure on the part of the attackers.\n\nThe information obtained in this way can be used to infer to what extent the next attack will proceed, and, if such a new\nspear-phishing attack occurs, the appropriate proactive response can be taken by analysing correlations with various\nindicators found in previous attacks.\n\nWe will continue to strive to prevent the future spread of spear-phishing attacks by the Kimsuky group, and we hope that\nthis paper will help in responding to threats in many areas including domestic.\n\n\n-----\n\n## References\n\n[[1] The Kimsuky Operation: a North Korean APT? https://securelist.com/the-kimsuky-operation-a-north-koreanapt/57915/.](https://securelist.com/the-kimsuky-operation-a-north-koreanapt/57915/)\n\n[2] [http://asec.ahnlab.com/993.](http://asec.ahnlab.com/993)\n\n[3] [http://www.hani.co.kr/arti/PRINT/730395.html.](http://www.hani.co.kr/arti/PRINT/730395.html)\n\n[4] South Korean reporters get malware emails; North Korea suspected.\n[http://www.koreatimes.co.kr/www/nation/2019/01/356_261573.html.](http://www.koreatimes.co.kr/www/nation/2019/01/356_261573.html)\n\n[[5] Operation Cobra Venom. https://blog.alyac.co.kr/2066.](https://blog.alyac.co.kr/2066)\n\n[6] The Double Life of SectorA05 Nesting in Agora (Operation Kitty Phishing).\n[https://threatrecon.nshc.net/2019/01/30/operation-kitty-phishing/.](https://threatrecon.nshc.net/2019/01/30/operation-kitty-phishing/)\n\n[7] Operation Kabar Cobra. https://global.ahnlab.com/global/upload/download/techreport/[Analysis_Report]Operation\nKabar Cobra (1).pdf.\n\n[8] Writing Secure Code - The Attacker’s Advantage and the Defender’s Dilemma (2002).\n[https://www.oreilly.com/library/view/writing-secure-code/0735617228/.](https://www.oreilly.com/library/view/writing-secure-code/0735617228/)\n\n[9] DOKKAEBI: Documents of Korean and Evil Binary.\n[https://www.virusbulletin.com/conference/vb2018/abstracts/dokkaebi-documents-korean-and-evil-binary.](https://www.virusbulletin.com/conference/vb2018/abstracts/dokkaebi-documents-korean-and-evil-binary)\n\n[10] VirusTotal (5f2ac8672e19310bd532c47d209272bd75075696dea6ffcc47d1d37f18aff141).\n[https://www.virustotal.com/gui/file/5f2ac8672e19310bd532c47d209272bd75075696dea6ffcc47d1d37f18aff141/de.](https://www.virustotal.com/gui/file/5f2ac8672e19310bd532c47d209272bd75075696dea6ffcc47d1d37f18aff141/de)\n\n[11] Hybrid-Analysis (8332be776617364c16868c1ad6b4efe7).\nhttps://www.hybridanalysis.com/sample/5f2ac8672e19310bd532c47d209272bd75075696dea6ffcc47d1d37f18aff141?\nenvironmentId=110.\n\n[12] OUI Lookup. [https://ip.rst.im/oui/C48508.](https://ip.rst.im/oui/C48508)\n\n[13] VirusTotal (f7d2780bc7bb24d7525012a566a37c5baeeba79e0d199120c9f3ccaf5ae3448c).\n[https://www.virustotal.com/gui/file/f7d2780bc7bb24d7525012a566a37c5baeeba79e0d199120c9f3ccaf5ae3448c/d.](https://www.virustotal.com/gui/file/f7d2780bc7bb24d7525012a566a37c5baeeba79e0d199120c9f3ccaf5ae3448c/d)\n\n[[14] Twitter @anyrun. https://twitter.com/anyrun_app/status/1115513990711521280.](https://twitter.com/anyrun_app/status/1115513990711521280)\n\n[15] Anyrun. [https://app.any.run/tasks/680af12b-e8c3.](https://app.any.run/tasks/680af12b-e8c3)\n\n## Latest articles:\n\n### Cryptojacking on the fly: TeamTNT using NVIDIA drivers to mine cryptocurrency\n\nTeamTNT is known for attacking insecure and vulnerable Kubernetes deployments in order to infiltrate organizations’\ndedicated environments and transform them into attack launchpads. In this article Aditya Sood presents a new module\nintroduced by…\n\n### Collector-stealer: a Russian origin credential and information extractor\n\nCollector-stealer, a piece of malware of Russian origin, is heavily used on the Internet to exfiltrate sensitive data from enduser systems and store it in its C&C panels. In this article, researchers Aditya K Sood and Rohit Chaturvedi present a\n360…\n\n### Fighting Fire with Fire\n\n\n-----\n\nIn 1989, Joe Wells encountered his first virus: Jerusalem. He disassembled the virus, and from that moment onward, was\nintrigued by the properties of these small pieces of self-replicating code. Joe Wells was an expert on computer viruses,\nwas partly…\n\n### Run your malicious VBA macros anywhere!\n\nKurt Natvig wanted to understand whether it’s possible to recompile VBA macros to another language, which could then\neasily be ‘run’ on any gateway, thus revealing a sample’s true nature in a safe manner. In this article he explains how he\nrecompiled…\n\n### Dissecting the design and vulnerabilities in AZORult C&C panels\n\nAditya K Sood looks at the command-and-control (C&C) design of the AZORult malware, discussing his team's findings\nrelated to the C&C design and some security issues they identified during the research.\n\n[Bulletin Archive](https://www.virusbulletin.com/virusbulletin/archive)\n\n[We have placed cookies on your device in order to improve the functionality of this site, as outlined in our cookies policy.](https://www.virusbulletin.com/about-vb/privacy-policy/cookies)\nHowever, you may delete and block all cookies from this site and your use of the site will be unaffected. By continuing to\n[browse this site, you are agreeing to Virus Bulletin's use of data as outlined in our privacy policy.](https://www.virusbulletin.com/about-vb/privacy-policy/)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2020/2020-03-10 - Kimsuky group- tracking the king of the spear phishing.pdf"
    ],
    "report_names": [
        "2020-03-10 - Kimsuky group- tracking the king of the spear phishing.pdf"
    ],
    "threat_actors": [
        {
            "id": "aa73cd6a-868c-4ae4-a5b2-7cb2c5ad1e9d",
            "created_at": "2022-10-25T16:07:24.139848Z",
            "updated_at": "2025-03-27T02:02:10.120505Z",
            "deleted_at": null,
            "main_name": "Safe",
            "aliases": [],
            "source_name": "ETDA:Safe",
            "tools": [
                "DebugView",
                "LZ77",
                "OpenDoc",
                "SafeDisk",
                "TypeConfig",
                "UPXShell",
                "UsbDoc",
                "UsbExe"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "f809bfcb-b200-4988-80a8-be78ef6a52ef",
            "created_at": "2023-01-06T13:46:39.186988Z",
            "updated_at": "2025-03-27T02:00:03.016358Z",
            "deleted_at": null,
            "main_name": "TeamTNT",
            "aliases": [
                "Adept Libra"
            ],
            "source_name": "MISPGALAXY:TeamTNT",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "c3ca592f-0669-49bd-ab5c-310007ab2fb4",
            "created_at": "2022-10-25T15:50:23.334495Z",
            "updated_at": "2025-03-27T02:00:55.445098Z",
            "deleted_at": null,
            "main_name": "TeamTNT",
            "aliases": [
                "TeamTNT"
            ],
            "source_name": "MITRE:TeamTNT",
            "tools": [
                "Peirates",
                "MimiPenguin",
                "LaZagne",
                "Hildegard"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "dc78f675-b309-431d-8160-b8dcff037d4f",
            "created_at": "2024-05-01T02:03:08.142224Z",
            "updated_at": "2025-03-27T02:05:17.417972Z",
            "deleted_at": null,
            "main_name": "NICKEL KIMBALL",
            "aliases": [
                "Black Banshee ",
                "Crooked Pisces ",
                "Emerald Sleet ",
                "Kimsuky ",
                "Opal Sleet ",
                "SharpTongue ",
                "TA427 ",
                "THALLIUM ",
                "Velvet Chollima ",
                "APT43 "
            ],
            "source_name": "Secureworks:NICKEL KIMBALL",
            "tools": [
                " KONNI",
                " KimJongRAT",
                " Kimsuky",
                "BabyShark"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "760f2827-1718-4eed-8234-4027c1346145",
            "created_at": "2023-01-06T13:46:38.670947Z",
            "updated_at": "2025-03-27T02:00:02.888195Z",
            "deleted_at": null,
            "main_name": "Kimsuky",
            "aliases": [
                "Thallium",
                "G0086",
                "APT43",
                "Springtail",
                "Sparkling Pisces",
                "Velvet Chollima",
                "Black Banshee",
                "Operation Stolen Pencil",
                "Emerald Sleet",
                "THALLIUM"
            ],
            "source_name": "MISPGALAXY:Kimsuky",
            "tools": [
                "RevClient",
                "xrat",
                "QUASARRAT",
                "RDP Wrapper",
                "TightVNC",
                "BabyShark"
            ],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "191d7f9a-8c3c-442a-9f13-debe259d4cc2",
            "created_at": "2022-10-25T15:50:23.280374Z",
            "updated_at": "2025-03-27T02:00:55.423485Z",
            "deleted_at": null,
            "main_name": "Kimsuky",
            "aliases": [
                "Kimsuky",
                "Black Banshee",
                "Velvet Chollima",
                "Emerald Sleet",
                "THALLIUM",
                "APT43",
                "TA427"
            ],
            "source_name": "MITRE:Kimsuky",
            "tools": [
                "schtasks",
                "Amadey",
                "Brave Prince",
                "CSPY Downloader",
                "gh0st RAT",
                "AppleSeed",
                "NOKKI",
                "QuasarRAT",
                "Gold Dragon",
                "PsExec",
                "KGH_SPY",
                "Mimikatz",
                "BabyShark"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "71a1e16c-3ba6-4193-be62-be53527817bc",
            "created_at": "2022-10-25T16:07:23.753455Z",
            "updated_at": "2025-03-27T02:02:09.963016Z",
            "deleted_at": null,
            "main_name": "Kimsuky",
            "aliases": [
                "APT 43",
                "Black Banshee",
                "Emerald Sleet",
                "ITG16",
                "KTA082",
                "Kimsuky",
                "Larva-24005",
                "Operation Baby Coin",
                "Operation Covert Stalker",
                "Operation DEEP#DRIVE",
                "Operation DEEP#GOSU",
                "Operation Kabar Cobra",
                "Operation Mystery Baby",
                "Operation Red Salt",
                "Operation Smoke Screen",
                "Operation Stealth Power",
                "Operation Stolen Pencil",
                "SharpTongue",
                "Sparkling Pisces",
                "Springtail",
                "TA406",
                "TA427",
                "Thallium",
                "UAT-5394",
                "Velvet Chollima"
            ],
            "source_name": "ETDA:Kimsuky",
            "tools": [
                "AngryRebel",
                "AppleSeed",
                "BITTERSWEET",
                "BabyShark",
                "BoBoStealer",
                "CSPY Downloader",
                "Farfli",
                "FlowerPower",
                "Gh0st RAT",
                "Ghost RAT",
                "Gold Dragon",
                "GoldDragon",
                "GoldStamp",
                "JamBog",
                "KGH Spyware Suite",
                "KGH_SPY",
                "KPortScan",
                "KimJongRAT",
                "Kimsuky",
                "LATEOP",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "Lovexxx",
                "MailPassView",
                "Mechanical",
                "Mimikatz",
                "MoonPeak",
                "Moudour",
                "MyDogs",
                "Mydoor",
                "Network Password Recovery",
                "PCRat",
                "ProcDump",
                "PsExec",
                "ReconShark",
                "Remote Desktop PassView",
                "SHARPEXT",
                "SWEETDROP",
                "SmallTiger",
                "SniffPass",
                "TODDLERSHARK",
                "TRANSLATEXT",
                "Troll Stealer",
                "TrollAgent",
                "VENOMBITE",
                "WebBrowserPassView",
                "xRAT"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "f3d402c5-5b55-4029-a639-cf38a2f5f0e1",
            "created_at": "2023-01-06T13:46:38.922371Z",
            "updated_at": "2025-03-27T02:00:02.952084Z",
            "deleted_at": null,
            "main_name": "Operation Kabar Cobra",
            "aliases": [],
            "source_name": "MISPGALAXY:Operation Kabar Cobra",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673535618,
    "ts_updated_at": 1743041834,
    "ts_creation_date": 1653710037,
    "ts_modification_date": 1653710037,
    "files": {
        "pdf": "https://archive.orkl.eu/89261aa74b30d0298e919e3b32c48daba9e825a9.pdf",
        "text": "https://archive.orkl.eu/89261aa74b30d0298e919e3b32c48daba9e825a9.txt",
        "img": "https://archive.orkl.eu/89261aa74b30d0298e919e3b32c48daba9e825a9.jpg"
    }
}