{
    "id": "ccdb7d04-7aa7-40f9-8847-5d866d3981e7",
    "created_at": "2023-01-12T15:05:57.161447Z",
    "updated_at": "2025-03-27T02:16:44.54448Z",
    "deleted_at": null,
    "sha1_hash": "647f1c4fde42eb26b2d810fb00dd634bf0c87534",
    "title": "2020-01-28 - Ragnarok Ransomware Targets Citrix ADC, Disables Windows Defender",
    "authors": "",
    "file_creation_date": "2022-05-27T01:59:32Z",
    "file_modification_date": "2022-05-27T01:59:32Z",
    "file_size": 333902,
    "plain_text": "# Ragnarok Ransomware Targets Citrix ADC, Disables Windows Defender\n\n**[bleepingcomputer.com/news/security/ragnarok-ransomware-targets-citrix-adc-disables-windows-defender/](https://www.bleepingcomputer.com/news/security/ragnarok-ransomware-targets-citrix-adc-disables-windows-defender/)**\n\nLawrence Abrams\n\nBy\n[Lawrence Abrams](https://www.bleepingcomputer.com/author/lawrence-abrams/)\n\nJanuary 28, 2020\n03:30 AM\n0\n\nA new ransomware called Ragnarok has been detected being used in targeted attacks\nagainst unpatched Citrix ADC servers vulnerable to the CVE-2019-19781 exploit.\n\nLast week, FireEye released a report about new attacks exploiting the now patched Citrix\nADC vulnerability to [install the new Ragnarok Ransomware on vulnerable networks.](https://www.bleepingcomputer.com/news/security/citrix-releases-final-patch-as-ransomware-attacks-ramp-up/)\n\nWhen attackers can compromise a Citrix ADC device, various scripts would be downloaded\nand executed that scan for Windows computers vulnerable to the EternalBlue vulnerability.\n\nIf detected, the scripts would attempt to exploit the Windows devices, and if successful,\ninject a DLL that downloads and installs the Ragnarok ransomware onto the exploited\ndevice.\n\n[After Head of SentinelLabs Vitali Kremez extracted the](https://twitter.com/VK_Intel) [ransomware's configuration file, we](https://github.com/k-vitali/Malware-Misc-RE/blob/master/2020-01-26-ragnarok-cfg-vk.notes.raw)\nwere able to discover some interesting behavior not commonly seen in other ransomware,\nwhich we detail below.\n\n## Excludes both Russia and China from encryption\n\n\n-----\n\nMany ransomware operations are created by developers based out of Russia or other CIS\ncountries.\n\nTo fly under the authority's radar, it is common for ransomware developers to exclude users\nin Russia and other former Soviet Union countries from being encrypted if they become\ninfected.\n\n[Ragnarok operates similarly by checking the installed Windows language ID and if it](https://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-lcid/70feba9f-294e-491e-b6eb-56532684c37f)\nmatches one of the following will not perform an encryption of the computer.\n```\n0419 = Russia \n0423 = Belarus\n0444 = Russia\n0442 = Turkmenistan\n0422 = Ukraine\n0426 = Latvia\n043f = Kazakhstan\n042c = Azerbaijan\n\n```\nStrangely, in addition to the CIS countries, Ragnarok will also avoid encrypting victims who\nhave the 0804 language ID for China installed.\n\nRansomware excluding both Russia and China at the same time is rare and it is not known\nif this being done as a decoy for law enforcement or if the ransomware operates out of both\ncountries.\n\n## Attempts to disable Windows Defender\n\nAs Microsoft's Windows Defender has become a solid and reliable antivirus and security\nprogram, we are finding that numerous malware programs are attempting to disable or\nbypass it to more easily conduct malicious operations.\n\n[For example, we have seen GootKit,](https://www.bleepingcomputer.com/news/security/gootkit-malware-bypasses-windows-defender-by-setting-path-exclusions/) [TrickBot, and the](https://www.bleepingcomputer.com/news/security/new-trickbot-version-focuses-on-microsofts-windows-defender/) [Novter infections all utilizing some](https://www.bleepingcomputer.com/news/security/novter-trojan-sets-its-sights-on-microsoft-windows-defender/)\nsort of Windows Defender bypass.\n\nIt is rare, though, to see ransomware infections themselves attempt to disable the\nfunctionality of Windows Defender, which is what Ragnarok attempts.\n\nIt does this by adding the following Windows group policies that disable various protection\noptions in Windows Defender:\n```\nHKLM\\SOFTWARE\\Policies\\Microsoft\\Windows Defender \"DisableAntiSpyware\" = 1\nHKLM\\SOFTWARE\\Policies\\Microsoft\\Windows Defender\\Real-Time Protection\n\"DisableRealtimeMonitoring\" = 1\nHKLM\\SOFTWARE\\Policies\\Microsoft\\Windows Defender\\Real-Time Protection\n\"DisableBehaviorMonitoring\" = 1\nHKLM\\SOFTWARE\\Policies\\Microsoft\\Windows Defender\\Real-Time Protection\n\"DisableOnAccessProtection\" = 1\n\n```\n\n-----\n\n[The good news is that if you have Windows 10 s Tamper Protection feature enabled, these](https://www.bleepingcomputer.com/news/microsoft/microsoft-now-enables-windows-10-tamper-protection-by-default/)\nmethods will not work and Windows will simply ignore any attempts to bypass Windows\nDefender.\n\nIn addition to Windows Defender, Ragnarok will also attempt to clear Shadow Volume\nCopies, disable Windows automatic startup repair, and turn off the Windows Firewall with\nthe following commands:\n```\ncmd.exe /c vssadmin delete shadows /all /quiet\ncmd.exe /c bcdedit /set {current} bootstatuspolicy ignoreallfailures\ncmd.exe /c bcdedit /set {current} recoveryenabled no\ncmd.exe /c netsh advfirewall set allprofiles state off\n\n## Strange Unix file references\n\n```\nAnother strange aspect of this ransomware is the numerous references in the Windows\nexecutable to various Unix/Linux file paths such as:\n```\n  \"no_name4\": \"/proc\",\n  \"no_name5\": \"/proc/%s/status\",\n  \"no_name8\": \"/tmp/crypt.txt\",\n  \"no_name9\": \"/proc/%s\",\n  \"rand_path\": \"/dev/random\",\n  \"home_path\": \"/home/\",\n\n```\nIt is not clear as of yet why these paths are included and what they are used for, but\nKremez believes it could be a possible in-development cross-platform targeting being used\nby the attackers.\n\n\"I believe \"no_name5\": \"/proc/%s/status\" specifically demonstrates that the actors are\nchecking if the malware is running on the system via Unix command\n\"/proc/[proccess_id]/status.\" Given that Citrix is exploited cross-platform and might be\nrunning on both Unix and Windows systems. This specific \"no_name\" setup allows the\ncross-platform targeting and checks for both Windows and Unix systems in mind. By and\nlarge, this targeting and any Unix payloads might be still in development; however, criminals\nbehind Ragnarok appear to be as modular and adaptive as possible given this configuration\nsetup to affect more systems,\" Kremez told BleepingComputer in a conversation.\n\n## A standard encryption routine\n\nThe rest of the Ragnarok encryption process is similar to what we see in other ransomware\ninfections.\n\nWhen encrypting files it will use AES encryption and the generated key will be encrypted\nwith a bundled RSA encryption key. This makes it so only the ransomware developers can\ndecrypt the victim's encryption key.\n\n\n-----\n\nWhen scanning for files to encrypt, Ragnarok will skip any files that have the .exe, .dll,\n\".sys\", and \".ragnarok\" extensions. It will also skip any files whose path contains the\nfollowing strings:\n```\ncontent.ie5\n\\temporary internet files\n\\local settings\\temp\n\\appdata\\local\\temp\n\\program files\n\\windows\n\\programdata\n$\n\n```\nEach encrypted file will have the .ragnarok extension appended to the file name. For\nexample, 1.doc would be encrypted and renamed to 1.doc.ragnarok.\n\n**Folder encrypted by Ragnarok**\nWhile encrypting the computer, it will create a ransom note in every traversed folder called\n**!!ReadMe_To_Decrypt_My_Files.txt.**\n\nThis ransom note contains instructions on what happened to a victim's files, their encrypted\ndecryption key, and three email addresses to contact for payment instructions. It is not\nknown how many bitcoins the attackers are demanding for a decryptor.\n\n\n-----\n\n**Ragnarok Ransom Note**\nAt this time, it appears that the Ragnarok's encryption can't be broken, but will be further\nresearched for any weaknesses.\n\n### Related Articles:\n\n[Magniber ransomware gang now exploits Internet Explorer flaws in attacks](https://www.bleepingcomputer.com/news/security/magniber-ransomware-gang-now-exploits-internet-explorer-flaws-in-attacks/)\n\n[Darknet market Versus shuts down after hacker leaks security flaw](https://www.bleepingcomputer.com/news/security/darknet-market-versus-shuts-down-after-hacker-leaks-security-flaw/)\n\n[The Week in Ransomware - May 20th 2022 - Another one bites the dust](https://www.bleepingcomputer.com/news/security/the-week-in-ransomware-may-20th-2022-another-one-bites-the-dust/)\n\n[Zyxel fixes firewall flaws that could lead to hacked networks](https://www.bleepingcomputer.com/news/security/zyxel-fixes-firewall-flaws-that-could-lead-to-hacked-networks/)\n\n[Critical F5 BIG-IP vulnerability exploited to wipe devices](https://www.bleepingcomputer.com/news/security/critical-f5-big-ip-vulnerability-exploited-to-wipe-devices/)\n\n## IOCs\n\n### Hashes:\n```\nb7319f3e21c3941fc2a960b67a150b02f1f3389825164140e75dfa023a73d34c\n\n```\n\n-----\n\n### Files:\n```\n!!ReadMe_To_Decrypt_My_Files.txt\nC:\\Users\\public\\Files\\rgnk.dvi\n\n Email addresses:\nasgardmaster5@protonmail.com\nragnar0k@ctemplar.com\nj.jasonm@yandex.com\n\n Ransom note text:\nIt's not late to say happy new year right? but how didn't i bring a gift as the\nfirst time we met :)\n#what happend to your files?\nUnfortunately your files are encrypted with rsa4096 and aes encryption,you won't\ndecrypt your files without our tool\nbut don't worry,you can follow the instructions to decrypt your files \n1.obviously you need a decrypt tool so that you can decrypt all of your files\n2.contact with us for our btcoin address and send us your DEVICE ID after you decide\nto pay\n3.i will reply a specific price e.g 1.0011 or 0.9099 after i received your mail\nincluding your DEVICE ID\n4.i will send your personal decrypt tool only work on your own machine after i had\ncheck the ransom paystatus\n5.you can provide a file less than 1M for us to prove that we can decrypt your files\nafter you paid\n6.it's wise to pay as soon as possible it wont make you more losses\nthe ransome: 1 btcoin for per machine,5 bitcoins for all machines\nhow to buy bitcoin and transfer? i think you are very good at googlesearch\nasgardmaster5@protonmail.com\nragnar0k@ctemplar.com\nj.jasonm@yandex.com\nAttention:if you wont pay the ransom in five days, all of your files will be made\npublic on internet and will be deleted\nYOUR DEVICE ID:\nxx\n\n```\n[Citrix ADC](https://www.bleepingcomputer.com/tag/citrix-adc/)\n\n\n-----\n\n[ETERNALBLUE](https://www.bleepingcomputer.com/tag/eternalblue/)\n[Exploit](https://www.bleepingcomputer.com/tag/exploit/)\n[Ragnarok](https://www.bleepingcomputer.com/tag/ragnarok/)\n[Ransomware](https://www.bleepingcomputer.com/tag/ransomware/)\n[Vulnerability](https://www.bleepingcomputer.com/tag/vulnerability/)\n[Windows Defender](https://www.bleepingcomputer.com/tag/windows-defender/)\n\n[Lawrence Abrams](https://www.bleepingcomputer.com/author/lawrence-abrams/)\n\nLawrence Abrams is the owner and Editor in Chief of BleepingComputer.com. Lawrence's\narea of expertise includes Windows, malware removal, and computer forensics. Lawrence\nAbrams is a co-author of the Winternals Defragmentation, Recovery, and Administration\nField Guide and the technical editor for Rootkits for Dummies.\n\n[Previous Article](https://www.bleepingcomputer.com/news/security/ourmine-hackers-are-back-hijack-nfl-teams-social-accounts/)\n[Next Article](https://www.bleepingcomputer.com/news/security/ring-android-app-sent-sensitive-user-data-to-3rd-party-trackers/)\n\nPost a Comment [Community Rules](https://www.bleepingcomputer.com/posting-guidelines/)\n\nYou need to login in order to post a comment\n\n[Not a member yet? Register Now](https://www.bleepingcomputer.com/forums/index.php?app=core&module=global&section=register)\n\n### You may also like:\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2020/2020-01-28 - Ragnarok Ransomware Targets Citrix ADC, Disables Windows Defender.pdf"
    ],
    "report_names": [
        "2020-01-28 - Ragnarok Ransomware Targets Citrix ADC, Disables Windows Defender.pdf"
    ],
    "threat_actors": [
        {
            "id": "d90307b6-14a9-4d0b-9156-89e453d6eb13",
            "created_at": "2022-10-25T16:07:23.773944Z",
            "updated_at": "2025-03-27T02:02:09.974695Z",
            "deleted_at": null,
            "main_name": "Lead",
            "aliases": [
                "Casper",
                "TG-3279"
            ],
            "source_name": "ETDA:Lead",
            "tools": [
                "Agentemis",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "RbDoor",
                "RibDoor",
                "Winnti",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "e4ccfe5c-4d77-4503-bf1c-36076dbd78d0",
            "created_at": "2022-10-25T16:07:24.522697Z",
            "updated_at": "2025-03-27T02:02:10.271394Z",
            "deleted_at": null,
            "main_name": "OurMine",
            "aliases": [
                "ATK 128",
                "TAG-HA10"
            ],
            "source_name": "ETDA:OurMine",
            "tools": [],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "74f1da67-5bc9-49ee-ba8e-b7e8b452a2c2",
            "created_at": "2023-01-06T13:46:39.021238Z",
            "updated_at": "2025-03-27T02:00:02.979195Z",
            "deleted_at": null,
            "main_name": "OurMine",
            "aliases": [],
            "source_name": "MISPGALAXY:OurMine",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673535957,
    "ts_updated_at": 1743041804,
    "ts_creation_date": 1653616772,
    "ts_modification_date": 1653616772,
    "files": {
        "pdf": "https://archive.orkl.eu/647f1c4fde42eb26b2d810fb00dd634bf0c87534.pdf",
        "text": "https://archive.orkl.eu/647f1c4fde42eb26b2d810fb00dd634bf0c87534.txt",
        "img": "https://archive.orkl.eu/647f1c4fde42eb26b2d810fb00dd634bf0c87534.jpg"
    }
}