{
    "id": "49815f2b-d9d8-40b8-b827-fb1d10f2772c",
    "created_at": "2023-01-12T15:06:25.851183Z",
    "updated_at": "2025-03-27T02:09:18.550999Z",
    "deleted_at": null,
    "sha1_hash": "81b37203bf2d9158febc10799108154c05abd8e5",
    "title": "2020-11-03 - Attackers Exploiting WebLogic Servers via CVE-2020-14882 to install Cobalt Strike",
    "authors": "",
    "file_creation_date": "2022-05-28T15:41:18Z",
    "file_modification_date": "2022-05-28T15:41:18Z",
    "file_size": 1326729,
    "plain_text": "# SANS ISC: InfoSec Handlers Diary Blog - SANS Internet Storm Center SANS Site Network Current Site SANS Internet Storm Center Other SANS Sites Help Graduate Degree Programs Security Training Security Certification Security Awareness Training Penetration Testing Industrial Control Systems Cyber Defense Foundations DFIR Software Security Government OnSite Training InfoSec Handlers Diary Blog\n\n**isc.sans.edu/diary/26752**\n\n## Attackers Exploiting WebLogic Servers via CVE-2020-14882 to install Cobalt Strike\n\n**Published: 2020-11-03**\n\n**Last Updated: 2020-11-04 13:50:55 UTC**\n\n**by** [Renato Marinho (Version: 1)](https://isc.sans.edu/handler_list.html#renato-marinho)\n\n[0 comment(s)](https://isc.sans.edu/forums/diary/Attackers+Exploiting+WebLogic+Servers+via+CVE202014882+to+install+Cobalt+Strike/26752/#comments)\nStarting late last week, we observed a large number of scans against our WebLogic\nhoneypots to detect if they are vulnerable to CVE-2020-14882. CVE-2020-14882 was\npatched about two weeks ago as part of Oracle's quarterly critical patch update. In addition\nto scans simply enumerating vulnerable servers, we saw a small number of scans starting on\nFriday (Oct. 30th) attempting to install crypto-mining tools [1].\n\nOn Friday, Oracle amended its patch for CVE-2020-14882 [2]. A new variation of the\nvulnerability (CVE-2020-14750) can be used to exploit WebLogic servers with a trivial\nmodification of the exploit code.\n\nLast Saturday we started seeing a campaign using a chain of Powershell obfuscated scripts\nto download a Cobalt Strike payload. According to Cisco Talos Q4 2020 CTIR report, 66% of\nall ransomware attacks this quarter involved the use of Cobalt Strike [3]. Thus, as expected,\nthere is a high probability ransomware gang included CVE-2020-14882 exploit in their\narsenal.\n\nThe attack, as seen in Figure 1, exploits the vulnerability to execute a PowerShell payload\nbase64-encoded.\n\n\n-----\n\nFigure 1 - Payload delivery\n\nDecoding the base64 content, we can find the following code. As seen, there is another\nencoding layer using base64 and gzip compression. I usually make some adjustments to the\noriginal malicious script to make it save the decoded content to a file. So, replacing “IEX” by\n“$content =” and appending the script with “$content |out-file -filepath decoded_script.ps1” is\nenough to accomplish this result for this case.\n\nFigure 2 - First stage decoding\n\nPart of the resulting code is shown in Figure 3. Notice that there is another protected code.\nThere is a loop decrypting each byte of the code using an XOR function with the byte 0x35.\n\n\n-----\n\nFigure 3 - Second stage decoding\n\nThe result of this operation is a shellcode to download and execute a Cobalt Strike payload\nhosted at http://185[.]205.210.179:4321/Z8qZ.\n\nFigure 4 - Cobalt Strike payload download\n\nSubmitting the binary to VirusTotal, we had the following result:\n\n\n-----\n\n]\n\nFigure 5 - Cobalt Strike payload submitted to Virus Total\n\nRunning the malicious scripts in a controlled environment, it was possible to see connections\nestablished from time to time with the C2 at http://185[.]205.210.179/en_US/all.js.\n\n**References**\n\n**[1] https://isc.sans.edu/forums/diary/PATCH+NOW+CVE202014882+Weblogic+Actively**\n**+Exploited+Against+Honeypots/26734/**\n\n[2] [https://www.oracle.com/security-alerts/alert-cve-2020-14750.html#AppendixFMWl](https://www.oracle.com/security-alerts/alert-cve-2020-14750.html#AppendixFMWl)\n\n[3] [https://blog.talosintelligence.com/2020/09/CTIR-quarterly-trends-Q4-2020.html](https://blog.talosintelligence.com/2020/09/CTIR-quarterly-trends-Q4-2020.html)\n\nIOCs:\n\nNetwork:\n\n45[.]134.26.174\n\nhttp://185[.]205.210.179:4321/Z8qZ\n\nhttp://185[.]205.210.179/en_US/all.js\n\nFiles:\n\nZ8qZ:\n\n8ca0251bc340fc207e6f832eb6165b8d (MD5)\n\n8f4654952833b7d7b7db02ca7cb6c2f6cb9c3c545dc51124b0f18588b3c4e1c0 (SHA256)\n\n[The malicious requests are available at https://isc.sans.edu/WebLogicPS.log.zip](https://isc.sans.edu/WebLogicPS.log.zip)\n\nKeywords:\n\n\n-----\n\n[0 comment(s)](https://isc.sans.edu/forums/diary/Attackers+Exploiting+WebLogic+Servers+via+CVE202014882+to+install+Cobalt+Strike/26752/)\n\nJoin us at SANS! Attend [with Renato Marinho in starting](https://isc.sans.edu/diary/26752)\n\nTop of page\n×\n\n[Diary Archives](https://isc.sans.edu/diaryarchive.html)\n\n[Diary](https://isc.sans.edu/diaryarchive.html)\n[Podcasts](https://isc.sans.edu/podcast.html)\n[Jobs](https://isc.sans.edu/jobs)\n[Forums](https://isc.sans.edu/forums/)\n\n[Auditing](https://isc.sans.edu/forums/Auditing/)\n[Diary Discussions](https://isc.sans.edu/forums/Diary+Discussions/)\n[Forensics](https://isc.sans.edu/forums/Forensics/)\n[General Discussions](https://isc.sans.edu/forums/General+Discussion/)\n[Industry News](https://isc.sans.edu/forums/Industry+News/)\n[Network Security](https://isc.sans.edu/forums/Network+Security/)\n[Penetration Testing](https://isc.sans.edu/forums/Penetration+Testing/)\n[Software Security](https://isc.sans.edu/forums/Software+Security/)\n[SANS.edu Research](https://www.sans.edu/cyber-security-research)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2020/2020-11-03 - Attackers Exploiting WebLogic Servers via CVE-2020-14882 to install Cobalt Strike.pdf"
    ],
    "report_names": [
        "2020-11-03 - Attackers Exploiting WebLogic Servers via CVE-2020-14882 to install Cobalt Strike.pdf"
    ],
    "threat_actors": [
        {
            "id": "610a7295-3139-4f34-8cec-b3da40add480",
            "created_at": "2023-01-06T13:46:38.608142Z",
            "updated_at": "2025-03-27T02:00:02.87217Z",
            "deleted_at": null,
            "main_name": "Cobalt",
            "aliases": [
                "Cobalt Gang",
                "GOLD KINGSWOOD",
                "COBALT SPIDER",
                "G0080",
                "Mule Libra",
                "Cobalt Group"
            ],
            "source_name": "MISPGALAXY:Cobalt",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673535985,
    "ts_updated_at": 1743041358,
    "ts_creation_date": 1653752478,
    "ts_modification_date": 1653752478,
    "files": {
        "pdf": "https://archive.orkl.eu/81b37203bf2d9158febc10799108154c05abd8e5.pdf",
        "text": "https://archive.orkl.eu/81b37203bf2d9158febc10799108154c05abd8e5.txt",
        "img": "https://archive.orkl.eu/81b37203bf2d9158febc10799108154c05abd8e5.jpg"
    }
}