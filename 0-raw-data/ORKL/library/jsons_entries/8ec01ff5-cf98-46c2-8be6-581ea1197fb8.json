{
    "id": "8ec01ff5-cf98-46c2-8be6-581ea1197fb8",
    "created_at": "2023-01-12T15:10:53.76167Z",
    "updated_at": "2025-03-27T02:05:18.323773Z",
    "deleted_at": null,
    "sha1_hash": "2800b4291e29f4cdf7431b7c81ed74726196aba4",
    "title": "2020-11-04 - Persistent Actor Targets Ledger Cryptocurrency Wallets",
    "authors": "",
    "file_creation_date": "2022-05-28T22:07:52Z",
    "file_modification_date": "2022-05-28T22:07:52Z",
    "file_size": 1545276,
    "plain_text": "# Persistent Actor Targets Ledger Cryptocurrency Wallets\n\n**[proofpoint.com/us/blog/threat-insight/persistent-actor-targets-ledger-cryptocurrency-wallets](https://www.proofpoint.com/us/blog/threat-insight/persistent-actor-targets-ledger-cryptocurrency-wallets)**\n\n\nNovember 4, 2020\n\n\n-----\n\n[Blog](https://www.proofpoint.com/us/blog)\n[Threat Insight](https://www.proofpoint.com/us/blog/threat-insight)\nPersistent Actor Targets Ledger Cryptocurrency Wallets\n\n\n-----\n\nNovember 04, 2020 The Proofpoint Threat Research Team\n\n[In July 2020, cryptocurrency wallet company Ledger revealed a breach of 9500 customers’ names and contact](https://www.ledger.com/addressing-the-july-2020-e-commerce-and-marketing-data-breach)\n[information. In their announcement, they caution users to be aware of credential phishing attempts and state that](https://www.proofpoint.com/sites/default/files/proofpoint-credential-phishing-ebook.pdf)\nthey will “never ask [users] for the 24 words of [their] recovery phrase.”\n\nOn October 25, 2020, Proofpoint researchers discovered several thousand messages claiming to be from\nLedger with subjects like, “Your Ledger Live client may be compromised” and “Your Ledger assets may be at\nrisk”. The messages don’t appear to be targeted at any specific industry or geography.\n\n\n-----\n\n## Lures\n\n_Figure 1: Email lure claiming to be from Ledger_\n\nThe messages claim that Ledger has experienced a breach and that recipients should assume their\n“cryptocurrency assets are at risk of being stolen.” The suggested remediation is to download the latest version\nof Ledger Live and set up a new PIN. In line with Ledger’s real statement following the June breach, the\nmessage never suggests that the user will be asked to share their recovery phrase. Instead, at the bottom of the\nmessage, a button prompts the recipient to “Download latest version” of Ledger Live.\n\n\n-----\n\n_Figure 2: Additional email lure claiming to be from Ledger_\n\n## Landing page and malicious files\n\nThe button takes the user to a spoofed Ledger Live download page with links to malicious downloads for\nWindows, MacOS, and Linux. The fake download page is hosted at “hxxps://xn--ledgr-9za[.]com/ledgerlive/download/”, and when punycode is rendered in a user’s browser, it appears extremely similar to the real\ndownload page URL:\n\nFigure 3: Malicious URL with punycode character\n\n\n-----\n\n_Figure 4: Real Ledger Live download URL_\n\nBeyond the URL, the landing page for the malicious download closely mirrors the legitimate Ledger page,\nappearing to offer downloads for a variety of desktop platforms and mobile. However, there is one notable\nchange.\n\n_Figure 5: Spoofed Ledger Live download page with links to malicious executables_\n\n\n-----\n\nThe spoofed version removes the warning to users to beware of fake Ledger Live applications, seen on the real\npage below.\n\n_Figure 6: Real Ledger Live download page_\n\nUpon clicking the download button on the spoofed page, the installer is downloaded to the user’s machine.\n\nThe fake installer and fake Ledger Live have the following digital signature:\n\n_Figure 7: Signature for the installer and spoofed Ledger Live downloads_\n\nWhile Proofpoint researchers have not conducted a full analysis on the malware, at the very\nleast the backdoored Ledger Live application is capable of stealing recovery phrases. The Ledger hardware\nwallets themselves are not targeted in this campaign, instead users may be tricked into revealing their recovery\n\n\n-----\n\n[passphrase through social engineering. A stolen recovery phrase may be used by an actor to generate a copy of](https://www.proofpoint.com/us/corporate-blog/post/cybersecurity-101-what-social-engineering)\nthe user’s private keys, allowing them to steal any digital currencies associated with those private keys.\n\nTo achieve this, the threat actor modified the Ledger Live application to trick users into selecting the “Restore\ndevice from Recovery phrase” option (Figure 8). The legitimate Ledger Live application typically has two\nadditional options (Figure 9) on the “Get started with your Ledger device” page: “Set up as new device” and “Skip\ndevice setup,” which were removed in the backdoored application.\n\n_Figure 8: Backdoored Ledger Live “Get started with your Ledger device” with removed options_\n\n\n-----\n\n_Figure 9: Legitimate Ledger Live “Get started with your Ledger device” page_\n\nAfter selecting the “Restore device from Recovery phrase” and choosing a Ledger wallet, the backdoor\napplication’s next step is the “Recovery phrase” (Figure 10), which is normally the third step in the legitimate\napplication (Figure 11). If a user is tricked into providing their recovery phrase in this stage of the\nbackdoored application, the phrase is sent to actor-controlled infrastructure where they may then freely steal any\ndigital currencies associated with that phrase.\n\n\n-----\n\n_Figure 10: Backdoored Ledger Live “Recovery phrase” as second step_\n\n\n-----\n\n_Figure 11: Legitimate Ledger Live “PIN” as second step_\n\nTo backdoor the application, the actor inserted malicious JavaScript code into renderer.bundle.js, which can be\nfound in Ledger Live’s [app.asar file.](https://www.electronjs.org/docs/tutorial/application-packaging) [Version 2.15.0 of Ledger Live was likely used as the basis for the](https://github.com/LedgerHQ/ledger-live-desktop/releases/tag/v2.15.0)\nbackdoored application, with the legitimate renderer.bundle.js consisting of 405,057 lines while the backdoored\nrender.bundle.js consists of 411,736 lines (6,679 additional).\n\nThe malicious code modifies the number of options available on the “Get started with your Ledger device” page\nbased on whether the installation has been “registered” with the attacker’s command and control (C2) server.\nThis is accomplished first with a HTTP GET request to the C2 server and checks for the following response\nstring: “unregistered” (Figure 12). If the server responds with “unregistered” then only the “noDevice” and\n“restoreDevice” options are displayed (Figure 8), otherwise the full list of options is displayed (Figure 9). This\nrequest is also sent at every onboarding check (Figure 13).\n\n\n-----\n\n_Figure 12: Backdoored Ledger Live GET request and response (dogcowbat[.]com)_\n\n_Figure 13: OnboardingOrElse in backdoored Ledger Live (loldevs[.]com)_\n\nIf a user is tricked into entering their recovery phrase, the malicious code will check each entered word against a\n[hardcoded list of BIP-39 valid words. If the word is found in the list (Figure 14), then a malicious “work()” function](https://en.wikipedia.org/wiki/Cryptocurrency_wallet)\nis executed until enough words making up the completed mnemonic sentence have been entered. Once all the\nwords have been entered then the full mnemonic sentence is sent to the actor controlled C2 via a HTTP POST\nrequest (Figure 15). Once a recovery phrase has been stolen, the actor is free to generate a private key with that\nphrase and are then be able to transfer any associated digital currencies to their own wallet.\n\n_Figure 14: Hardcoded BIP-39 words in backdoored Ledger Live_\n\n\n-----\n\n_Figure 15: Backdoored Ledger Live POST request (dogcowbat[.]com)_\n\nSometime on or before October 31, 2020, the actor launched a new campaign that similarly attempts to trick their\ntargets into revealing their recovery phrase. Instead of using a backdoored Ledger Live, however, this campaign\nis purely web-based. At the time of writing, this campaign has not been observed via email. The landing pages\n[that redirect to a recovery phrase-stealing webpage were likely sent through SMS messages. One recovery](https://www.reddit.com/r/ledgerwallet/comments/jmdcov/now_its_usaledgercom_hope_the_noobies_dont_fall/)\nphrase-stealing website was hosted at the following punycode URL: hxxps://xn--ldgr-vvac[.]com/update/\n(Figure 16). Similar to the spoofed Ledger Live download page, the decoded text from the punycode domain was\nmade to look like the official Ledger website (ledger[.]com): lėdgėr[.]com.\n\n\n-----\n\n_Figure 16: Fake Ledger Wallet landing page used to steal recovery phrases_\n\nAfter selecting a wallet, the webpage navigates to a time locked page requesting the target to connect their\ndevice (Figure 17). Regardless of whether a device is connected, the page will eventually unlock the Continue\nbutton. When clicked, the button presents a fake error message asking the target to select their recovery phrase\nlength (Figure 18). The final page asks for each word to be entered separately (Figure 19), and after all the\nwords are entered then they are sent via a POST request to the same server.\n\n\n-----\n\n_Figure 17: Fake “Connect your device” page_\n\n\n-----\n\n_Figure 18: Recovery phrase length prompt_\n\n\n-----\n\n_Figure 19: Prompt to enter in each recovery phrase word separately_\n\nCryptocurrency wallets and related services have long been attractive targets for threat actors, taking advantage\nof platforms that may not have the most robust security measures in place. In this case, the actor used wellcrafted lures and landing pages attempting to convince the recipient to download a fake update or\ndirectly reveal their recovery phrase. The Ledger breach in June may have inadvertently added legitimacy to\nthese messages, as it’s likely still fresh in the minds of Ledger users.\n\n\n**IOC** **IOC**\n**Type**\n\n0b4578ea4ef643c06a38e28e32791366b72154c00e5dee4ca1a5504d6464de34 SHA\n256\n\n6a7329062603df5ecec5ac18721621e89c44de594fd639bb3f2669312ef627a1 SHA\n256\n\ncc04fd1e8e724836e8899d2d64ef96751ba4ab6460e7b82980b17560ba3fa383 SHA\n256\n\n307d9f5e4b85d1209753a90220cb3cf6e590288af57d81fb6a282c5d1a6d68df SHA\n256\n\n1af3f4a139deef1054879aa754ffc71a63b3a1d1492ed4682c1526d37b3be3ff SHA\n256\n\n\n**Description**\n\nWindows executable\nfile\n\nWindows executable\nfile\n\nWindows executable\nfile\n\nWindows executable\nfile\n\nMacOS DMG file\n\n\n-----\n\n4b85edf75077876a0fae88db7799efa24dae7a9c84a19eb9f73c19779af4cb8f SHA\n256\n\n2575a121711d6d5651cf15c0e39f18762251a1211a20763c4afd802d644e9153 SHA\n256\n\nd35433a803d4a417d41ff04b20f490d003cdc93027be61a2eed0581e65b06b19 SHA\n256\n\n82f0fbb88b972a9235370e7011303a4588c84cde8fa2a33ed6e24241af2e009b SHA\n256\n\n0e8866d42d999e240ce358e872581fc5e63ac9fd2750ee3b9a66bd0ad118552e SHA\n256\n\n9afec97203b8571dda7c38aaa7c8ddb7b5387632e2d83f99f630f8634a2178d3 SHA\n256\n\n\nMacOS DMG file\n\nMacOS DMG file\n\nMacOS DMG file\n\nLinux AppImage file\n\nLinux AppImage file\n\nLinux AppImage file\n\n\nhxxps://xn--ledgr-9za[.]com/ledger-live/download/ URL Spoofed Ledger\nlanding page\n\nt-mobile-sq[.]com Domain Actor infrastructure\n\nhomeandfamilyuniverse[.]com Domain Actor infrastructure\n\nkryptosproject[.]or Domain Actor infrastructure\n\nledger-live[.]io Domain Actor infrastructure\n\nquikview-update[.]com Domain Actor infrastructure\n\nquikview[.]app Domain Actor infrastructure\n\nlmao[.]money Domain Actor infrastructure\n\ndogcat[.]space Domain Actor infrastructure\n\nxn--ledgr-9za[.]com Domain Actor infrastructure\n\nxn--ledgr-q51b[.]com Domain Actor infrastructure\n\nloldevs[.]com Domain Actor infrastructure\n\nledgersupport[.]io Domain Actor infrastructure\n\n\n-----\n\nfunnerhere[.]com Domain Actor infrastructure\n\nlegder[.]com Domain Actor infrastructure\n\ndogcowbat[.]com Domain Actor infrastructure\n\ntheironshop[.]net Domain Actor infrastructure\n\nledger[.]medio Domain Actor infrastructure\n\ntmobile[.]digital Domain Actor infrastructure\n\nquikview[.]work Domain Actor infrastructure\n\nxn--ldger-n51b[.]com Domain Actor infrastructure\n\nsecure[.]hbccing[.]com Domain Actor infrastructure\n\nledger-support[.]io Domain Actor infrastructure\n\nledger[.]deals Domain Actor infrastructure\n\nledger[.]legal Domain Actor infrastructure\n\nledgermailer[.]io Domain Actor infrastructure\n\nledger[.]buzz Domain Actor infrastructure\n\nxn--ledge-xbb[.]com Domain Actor infrastructure\n\nxn--ldger-6za[.]com Domain Actor infrastructure\n\nlegder-support[.]io Domain Actor infrastructure\n\nledger[.]report Domain Actor infrastructure\n\ncom-client[.]email Domain Actor infrastructure\n\nnumisconsult[.]com Domain Actor infrastructure\n\nusa-ledger[.]com Domain Actor infrastructure\n\nledger-chain[.]info Domain Actor infrastructure\n\n\n-----\n\nledger-chain[.]com Domain Actor infrastructure\n\nfr-ledger[.]com Domain Actor infrastructure\n\nxn--ldgr-vvac[.]com Domain Actor infrastructure\n\nledger[.]uk[.]com Domain Actor infrastructure\n\nau-ledger[.]com Domain Actor infrastructure\n\nledger[.]jpn[.]com Domain Actor infrastructure\n\nus-ledger[.]com Domain Actor infrastructure\n\nca-ledger[.]com Domain Actor infrastructure\n\nde-ledger[.]com Domain Actor infrastructure\n\nledger[.]org[.]pl Domain Actor infrastructure\n\nnl-ledger[.]com Domain Actor infrastructure\n\nit-ledger[.]com Domain Actor infrastructure\n\nnz-ledger[.]com Domain Actor infrastructure\n\nledger[.]us[.]org Domain Actor infrastructure\n\nSubscribe to the Proofpoint Blog\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2020/2020-11-04 - Persistent Actor Targets Ledger Cryptocurrency Wallets.pdf"
    ],
    "report_names": [
        "2020-11-04 - Persistent Actor Targets Ledger Cryptocurrency Wallets.pdf"
    ],
    "threat_actors": [
        {
            "id": "529c1ae9-4579-4245-86a6-20f4563a695d",
            "created_at": "2022-10-25T16:07:23.702006Z",
            "updated_at": "2025-03-27T02:02:09.93109Z",
            "deleted_at": null,
            "main_name": "Hafnium",
            "aliases": [
                "Red Dev 13",
                "Silk Typhoon"
            ],
            "source_name": "ETDA:Hafnium",
            "tools": [],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "7c969685-459b-4c93-a788-74108eab6f47",
            "created_at": "2023-01-06T13:46:39.189751Z",
            "updated_at": "2025-03-27T02:00:03.017103Z",
            "deleted_at": null,
            "main_name": "HAFNIUM",
            "aliases": [
                "ATK233",
                "G0125",
                "Operation Exchange Marauder",
                "Red Dev 13",
                "Silk Typhoon"
            ],
            "source_name": "MISPGALAXY:HAFNIUM",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "2704d770-43b4-4bc4-8a5a-05df87416848",
            "created_at": "2022-10-25T15:50:23.306305Z",
            "updated_at": "2025-03-27T02:00:55.43633Z",
            "deleted_at": null,
            "main_name": "HAFNIUM",
            "aliases": [
                "HAFNIUM",
                "Operation Exchange Marauder",
                "Silk Typhoon"
            ],
            "source_name": "MITRE:HAFNIUM",
            "tools": [
                "Tarrask",
                "ASPXSpy",
                "Impacket",
                "PsExec",
                "China Chopper"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1673536253,
    "ts_updated_at": 1743041118,
    "ts_creation_date": 1653775672,
    "ts_modification_date": 1653775672,
    "files": {
        "pdf": "https://archive.orkl.eu/2800b4291e29f4cdf7431b7c81ed74726196aba4.pdf",
        "text": "https://archive.orkl.eu/2800b4291e29f4cdf7431b7c81ed74726196aba4.txt",
        "img": "https://archive.orkl.eu/2800b4291e29f4cdf7431b7c81ed74726196aba4.jpg"
    }
}