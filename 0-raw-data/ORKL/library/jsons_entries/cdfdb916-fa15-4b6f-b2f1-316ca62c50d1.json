{
    "id": "cdfdb916-fa15-4b6f-b2f1-316ca62c50d1",
    "created_at": "2023-01-12T15:09:59.010614Z",
    "updated_at": "2025-03-27T02:06:05.542264Z",
    "deleted_at": null,
    "sha1_hash": "36ab622f3586fb9b855eb1160721d8405c0afa13",
    "title": "2014-08-28 - Scanbox- A Reconnaissance Framework Used with Watering Hole Attacks",
    "authors": "",
    "file_creation_date": "2022-05-27T21:37:48Z",
    "file_modification_date": "2022-05-27T21:37:48Z",
    "file_size": 1333697,
    "plain_text": "# Scanbox: A Reconnaissance Framework Used with Watering Hole Attacks\n\n**[alienvault.com/blogs/labs-research/scanbox-a-reconnaissance-framework-used-on-watering-hole-attacks](https://www.alienvault.com/blogs/labs-research/scanbox-a-reconnaissance-framework-used-on-watering-hole-attacks)**\n\n[1. AT&T Cybersecurity](https://cybersecurity.att.com/)\n[2. Blog](https://cybersecurity.att.com/blogs)\n\nAugust 28, 2014 | [Jaime Blasco](https://www.alienvault.com/blogs/author/jaime-blasco)\nA few days ago we detected a watering hole campaign in a website owned by one\nbig industrial company.\n\nThe website is related to software used for simulation and system engineering in a wide\nrange of industries, including automotive, aerospace, and manufacturing.\n\nThe attackers were able to compromise the website and include code that loaded a\nmalicious Javascript file from a remote server. This Javascript file is a framework for\nreconnaissance that the attackers call \"Scanbox\" and includes some of the techniques we\ndescribed in a previous blog post: Attackers abusing Internet Explorer to enumerate\nsoftware and detect security products\n\nThe Scanbox framework first configures the remote C&C server that it will use and collects\na small amount of information about the victim that is visiting the compromised website\nincluding:\n\nReferer\nUser-Agent\nLocation\nCookie\nTitle (To identify specific content that the victim is visiting)\nDomain\nCharset\nScreen width and height\nOperating System\nLanguage\n\nResulting in something like this:\n\n\n-----\n\nBefore sending the information to the C&C server, Scanbox encodes and encrypts the data\nwith the following function:\n\nProducing the following request:\n\n\n-----\n\nIf we decrypt the data it translates to:\n\nAfter the first request, the framework contains several plugins to extract different information\nfrom the victim.\n\n**Pluginid 1: Enumerates software installed in the system using the technique we explained**\nbefore that affects Internet Explorer. It also checks if the system is running different versions\nof EMET (Enhanced Mitigation Experience Toolkit):\n\nProducing the list of security software on the target\n\n\n-----\n\n**Pluginid 2: Enumerates Adobe Flash versions**\n\n**Pluginid 5: Enumerates Microsoft Office versions**\n\n**Pluginid 6: Enumerates Acrobat Reader versions**\n\n**Pluginid 8: Enumerates Java versions**\n\n**Pluginid 21: Implements a “keylogger” functionality trough Javascript that logs all the**\nkeystrokes the victim is typing inside the compromised website.\n\n\n-----\n\n-----\n\nWhile the user is browsing the compromised website, all keystrokes are being recorded and\nsent to the C&C periodically. It will also send keystrokes when the user submits web forms\nthat can potentially include passwords and other sensitive data.\n\nAs we have seen, this is a very powerful framework that gives attackers a lot of insight into\nthe potential targets that will help them launching future attacks against them.\n\nWe have also seen several Metasploit-produced exploits that target different versions of\nJava in the same IP address that hosts the Scanbox framework (122.10.9[.]109).\n\nWe recommend you look for this type of activity against the following machines in your\nnetwork:\n\nmail[.]webmailgoogle.com\njs[.]webmailgoogle.com\n122[.]10.9.109\n\n## Share this with others\n\nTags: [watering hole,](https://www.alienvault.com/blogs/tag/watering+hole) [scanbox](https://www.alienvault.com/blogs/tag/scanbox)\n\n## Featured resources\n\n\n-----\n\nINDUSTRY REPORT\n\nAT&T Cybersecurity Insights™ Report:\n\n5G and the Journey to the Edge\n\n[Learn more](https://www.alienvault.com/resource-center/industry-reports/cybersecurity-insights-report-tenth-edition)\n\nSELF ASSESSMENT\n\n\n-----\n\n[Benchmark your cybersecurity maturity](https://www.alienvault.com/resource-center/security-maturity-assessment?utm_internal=blog-rail-assess)\n\n[Explore](https://www.alienvault.com/resource-center/security-maturity-assessment?utm_internal=blog-rail-assess)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2014/2014-08-28 - Scanbox- A Reconnaissance Framework Used with Watering Hole Attacks.pdf"
    ],
    "report_names": [
        "2014-08-28 - Scanbox- A Reconnaissance Framework Used with Watering Hole Attacks.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673536199,
    "ts_updated_at": 1743041165,
    "ts_creation_date": 1653687468,
    "ts_modification_date": 1653687468,
    "files": {
        "pdf": "https://archive.orkl.eu/36ab622f3586fb9b855eb1160721d8405c0afa13.pdf",
        "text": "https://archive.orkl.eu/36ab622f3586fb9b855eb1160721d8405c0afa13.txt",
        "img": "https://archive.orkl.eu/36ab622f3586fb9b855eb1160721d8405c0afa13.jpg"
    }
}