{
    "id": "b49b0d9e-1509-4497-a965-b86831f27bb7",
    "created_at": "2023-01-12T15:04:06.776155Z",
    "updated_at": "2025-03-27T02:15:45.419164Z",
    "deleted_at": null,
    "sha1_hash": "d93b09b770b91c7e24d22107ece6172745369b3c",
    "title": "2015-08-05 - Threat Group 3390 Cyberespionage",
    "authors": "",
    "file_creation_date": "2022-05-28T21:51:55Z",
    "file_modification_date": "2022-05-28T21:51:55Z",
    "file_size": 428277,
    "plain_text": "# Threat Group 3390 Cyberespionage\n\n**[secureworks.com/research/threat-group-3390-targets-organizations-for-cyberespionage](https://www.secureworks.com/research/threat-group-3390-targets-organizations-for-cyberespionage)**\n\nDell SecureWorks Counter Threat Unit™ Threat Intelligence\n\n_Dell SecureWorks Counter Threat Unit™ (CTU) Investigated Activities Associated with_\n_Threat Group-3390 Wednesday, August 5, 2015 By: Dell SecureWorks Counter Threat_\n_Unit™ Threat Intelligence_\n\n**Author: Dell SecureWorks Counter Threat Unit™ Threat Intelligence**\n**Date: August 5, 2015**\n\n## Summary\n\nDell SecureWorks Counter Threat Unit(TM) (CTU) researchers investigated activities\nassociated with Threat Group-3390[1] (TG-3390). Analysis of TG-3390's operations,\ntargeting, and tools led CTU researchers to assess with moderate confidence the group is\nlocated in the People's Republic of China. The threat actors target a wide range of\norganizations: CTU researchers have observed TG-3390 actors obtaining confidential data\non defense manufacturing projects, but also targeting other industry verticals and attacking\norganizations involved in international relations. The group extensively uses long-running\nstrategic web compromises[2] (SWCs), and relies on whitelists to deliver payloads to select\nvictims. In comparison to other threat groups, TG-3390 is notable for its tendency to\ncompromise Microsoft Exchange servers using a custom backdoor and credential logger.\n\n[CTU researchers divided the threat intelligence about TG-3390 into two sections: strategic](https://www.gartner.com/doc/2487216/definition-threat-intelligence)\nand tactical. Strategic threat intelligence includes an assessment of the ongoing threat posed\nby the threat group. Executives can use this assessment to determine how to reduce risk to\ntheir organization's mission and critical assets. Tactical threat intelligence is based on\nincident response investigations and research, and is mapped to the kill chain. Computer\nnetwork defenders can use this information to reduce the time and effort associated with\nresponding to TG-3390.\n\n### Key points\n\nExplanations of how CTU researchers identify attribution and gauge confidence levels are\navailable in the Appendix A.\n\nCTU researchers assess with moderate confidence that TG-3390 is based in the\nPeople's Republic of China.\n\n\n-----\n\nCTU researchers have evidence that the threat group compromised U.S. and UK\norganizations in the following verticals: manufacturing (specifically aerospace (including\ndefense contractors), automotive, technology, energy, and pharmaceuticals),\neducation, and legal, as well as organizations focused on international relations. Based\non analysis of the group's SWCs, TG-3390 operations likely affect organizations in\nother countries and verticals.\nTG-3390 operates a broad and long-running campaign of SWCs and has compromised\napproximately 100 websites as of this publication. Through an IP address whitelisting\nprocess, the threat group selectively targets visitors to these websites.\nAfter the initial compromise, TG-3390 delivers the HttpBrowser backdoor to its victims.\nThe threat actors then move quickly to compromise Microsoft Exchange servers and to\ngain complete control of the target environment.\nThe threat actors are adept at identifying key data stores and selectively exfiltrating all\nof the high-value information associated with their goal.\nCTU researchers recommend the following practices to prevent or detect TG-3390\nintrusions:\n\nSearch web log files for evidence of web server scanning using the URIs listed in\nthe Exploitation section and evidence of exfiltration using the User-Agent in the\nActions on objective section.\nRequire two-factor authentication for all remote access solutions, including OWA.\nAudit ISAPI filters and search for web shells on Microsoft Exchange servers.\n\n## Strategic threat intelligence\n\nCTU researchers assess the threat posed by a threat group by reviewing intent and\ncapability (see Figure 1). Threat groups pose varying threats to different organizations, and\neven a very capable group may pose a low threat if it does not have the intent to target a\nparticular organization.\n\n_Figure 1. Threat is based on a threat group's intent and capability. (Source: Dell_\n_SecureWorks)_\n\n### Intent\n\nCTU researchers infer intent by aggregating observations, analyzing a threat group's activity,\nand placing the information in a wider context.\n\n\n-----\n\nLike many threat groups, TG-3390 conducts strategic web compromises (SWCs), also\nknown as watering hole attacks, on websites associated with the target organization's\nvertical or demographic to increase the likelihood of finding victims with relevant information.\nCTU researchers assess with high confidence that TG-3390 uses information gathered from\nprior reconnaissance activities to selectively compromise users who visit websites under its\ncontrol. Most websites compromised by TG-3390 actors are affiliated with five types of\norganizations around the world:\n\nlarge manufacturing companies, particularly those supplying defense organizations\nenergy companies\nembassies in Washington, DC representing countries in the Middle East, Europe, and\nAsia, likely to target U.S.-based users involved in international relations\nnon-governmental organizations (NGOs), particularly those focused on international\nrelations and defense\ngovernment organizations\n\nBased on this information, CTU researchers assess that TG-3390 aims to collect defense\ntechnology and capability intelligence, other industrial intelligence, and political intelligence\nfrom governments and NGOs.\n\n_Attribution_\n\nTo assess attribution, CTU researchers analyze observed activity, third-party reporting, and\ncontextual intelligence. For the following reasons, CTU researchers assess with moderate\nconfidence that TG-3390 has a Chinese nexus:\n\nThe SWC of a Uyghur cultural website suggests intent to target the Uyghur ethnic\ngroup, a Muslim minority group primarily found in the Xinjiang region of China. Threat\ngroups outside of China are unlikely to target the Uyghur people.\nTG-3390 uses the PlugX remote access tool. The menus for PlugX's server-side\ncomponent are written exclusively in Standard Chinese (Mandarin), suggesting that\nPlugX operators are familiar with this language.\nCTU researchers have observed TG-3390 activity between 04:00 and 09:00 UTC,\nwhich is 12:00 to 17:00 local time in China (UTC +8). The timeframe maps to the\nsecond half of the workday in China.\nThe threat actors have used the Baidu search engine, which is only available in\nChinese, to conduct reconnaissance activities.\nCTU researchers have observed the threat group obtaining information about specific\nU.S. defense projects that would be desirable to those operating within a country with a\nmanufacturing base, an interest in U.S. military capability, or both.\n\n\n-----\n\nCTU researchers recognize that the evidence supporting this attribution is circumstantial. It is\npossible that TG-3390 is false-flag operation by a threat group outside of China that is\ndeliberately planting indications of a Chinese origin.\n\n### Capability\n\nTo assess a threat group's capability, CTU researchers analyze its resources, technical\nproficiency, and tradecraft.\n\n_Resources_\n\nTG-3390 has access to proprietary tools, some of which are used exclusively by TG-3390\nand others that are shared among a few Chinese threat groups. The complexity and\ncontinual development of these tools indicates a mature development process. TG-3390 can\nquickly leverage compromised network infrastructure during an operation and can conduct\nsimultaneous intrusions into multiple environments. This ability is further demonstrated by\nanalysis of interactions between TG-3390 operators and a target environment. CTU\nresearchers found no evidence of multiple operators working simultaneously against a single\norganization. This efficiency of operation (a 1:1 ratio of operator to observed activity)\nsuggests that TG-3390 can scale to conduct the maximum number of simultaneous\noperations. These characteristics suggest that the threat group is well resourced and has\naccess to a tools development team and a team focused on SWCs.\n\n_Technical proficiency_\n\nTG-3390's obfuscation techniques in SWCs complicate detection of malicious web traffic\nredirects. Malware used by the threat group can be configured to bypass network-based\ndetection; however, the threat actors rarely modify host-based configuration settings when\ndeploying payloads. CTU researchers have observed the threat actors installing a credential\nlogger and backdoor on Microsoft Exchange servers, which requires a technical grasp of\n[Internet Information Services (IIS). TG-3390 uses older exploits to compromise targets, and](http://en.wikipedia.org/wiki/Internet_Information_Services)\nCTU researchers have not observed the threat actors using zero-day exploits as of this\npublication. The threat actors demonstrated the ability to adapt when reentering a network\nafter an eviction, overcoming technical barriers constructed by network defenders.\n\n_Tradecraft_\n\nIn addition to using SWCs to target specific types of organizations, TG-3390 uses\nspearphishing emails to target specific victims. CTU researchers assess with high\nconfidence that the threat actors follow an established playbook during an intrusion. They\nquickly move away from their initial access vector to hide their entry point and then target\nExchange servers as a new access vector. As of this publication, CTU researchers have not\ndiscovered how TG-3390 keeps track of the details associated with its compromised assets\nand credentials. However, the threat actors' ability to reuse these assets and credentials,\nsometimes weeks or months after the initial compromise indicates the group is disciplined\n\n\n-----\n\nand well organized. After gaining access to a target network in one intrusion analyzed by\nCTU researchers, TG-3390 actors identified and exfiltrated data for specific projects run by\nthe target organization, indicating that they successfully obtained the information they\nsought. Data exfiltration occurred almost four weeks after the initial compromise and\ncontinued for two weeks (see Figure 2).\n\n_Figure 2. Data exfiltration timeline. (Source: Dell SecureWorks)_\n\nNote: The adversary's end goal is to exfiltrate, not infiltrate. Organizations often miss\nmultiple opportunities to detect and disrupt the threat actors before they can achieve their\nobjective. Alerts for credential theft tools and privileged account lockouts should be\ninvestigated.\n\n## Tactical threat intelligence\n\n### Known tools\n\nCTU researchers have observed TG-3390 actors using tools that are favored by multiple\nthreat groups:\n\nPlugX — A remote access tool notable for communications that may contain HTTP\nheaders starting with \"X-\" (e.g., \"X-Session: 0\"). Its presence on a compromised\nsystem allows a threat actor to execute a wide variety of commands, including\nuploading and downloading files, and spawning a reverse shell. The malware can be\nconfigured to use multiple network protocols to avoid network-based detection. DLL\nside loading is often used to maintain persistence on the compromised system.\n\n\n-----\n\nHttpBrowser (also known as TokenControl) — A backdoor notable for HTTPS\ncommunications with the HttpBrowser/1.0 User-Agent (see Figure 3). HttpBrowser's\nexecutable code may be obfuscated through structured exception handling and returnoriented programming. Its presence on a compromised system allows a threat actor to\nspawn a reverse shell, upload or download files, and capture keystrokes. Antivirus\ndetection for HttpBrowser is extremely low and is typically based upon heuristic\nsignatures. DLL side loading has been used to maintain persistence on the\ncompromised system. More information about HttpBrowser is available in Appendix B.\n\n_Figure 3. HttpBrowser URI. (Source: Dell SecureWorks)_\n\nChinaChopper web shell — A web-based executable script (see Figure 4) that allows a\nthreat actor to execute commands on the compromised system. The server-side\ncomponent provides a simple graphical user interface for threat actors interacting with\nweb shells.\n\n_Figure 4. ChinaChopper web shell. (Source: Dell SecureWorks)_\n\nPasswords, like \"admin-na-google123!@#\" shown in Figure 4, are required to interact\nwith the web shell. TG-3390 has used additional web shells containing similarly\nformatted passwords.\n\nHunter — A web application scanning tool written by @tojen to identify vulnerabilities in\nApache Tomcat, Red Hat JBoss Middleware, and Adobe ColdFusion (see Figure 5). It\ncan also identify open ports, collect web banners, and download secondary files.\n\n_Figure 5. Hunter usage. (Source: Dell SecureWorks)_\n\nThe following tools appear to be exclusive to TG-3390:\n\nOwaAuth web shell — A web shell and credential stealer deployed to Microsoft\nExchange servers. It is installed as an ISAPI filter. Captured credentials are DESencrypted using the password \"12345678\" and are written to the log.txt file in the root\ndirectory. Like the ChinaChopper web shell, the OwaAuth web shell requires a\npassword. However, the OwaAuth web shell password contains the victim\norganization's name. More information about the OwaAuth web shell is available in\nAppendix C.\n\n\n-----\n\nASPXTool — A modified version of the ASPXSpy web shell (see Figure 6). It is\ndeployed to internally accessible servers running Internet Information Services (IIS).\n\n_Figure 6. ASPXTool web shell. (Source: Dell SecureWorks)_\n\nTG-3390 actors have also used the following publicly available tools:\n\nWindows Credential Editor (WCE) — obtains passwords from memory\ngsecdump — obtains passwords from memory\nwinrar — compresses data for exfiltration\nnbtscan — scans NetBIOS name servers\n\n### Tactics, techniques, and procedures\n\nIncident response engagements have given CTU researchers insight into the tactics TG3390 employs during intrusions.\n\n_Reconnaissance_\n\nCTU researchers have not observed TG-3390 actors performing reconnaissance prior to\ncompromising organizations. As discussed in the Actions on objectives section, the threat\nactors appear to wait until they have established a foothold.\n\n_Development_\n\nTG-3390 actors use command and control (C2) domains for extended periods of time but\nfrequently change the domains' IP addresses. The new IP addresses are typically on the\nsame subnet as the previous ones.\n\nTG-3390 is capable of using a C2 infrastructure that spans multiple networks and registrars.\nThe most common registrar used by the adversary is HiChina Zhicheng Technology Ltd. The\nthreat actors have a demonstrated ability to move from one network provider to another,\nusing some infrastructure for extended periods of time and other domains for only a few\ndays. Seemingly random activity patterns in infrastructure deployment and usage, along with\nthe ability to use a wide variety of geographically diverse infrastructure, help the threat actors\navoid detection.\n\nTG-3390 SWCs may be largely geographically independent, but the group's most frequently\nused C2 registrars and IP net blocks are located in the U.S. Using a U.S.-based C2\ninfrastructure (see Figure 7) to compromise targets in the U.S. helps TG-3390 actors avoid\n\n\n-----\n\ngeo-blocking and geo-flagging measures used in network defense.\n\n_Figure 7. Geolocation of TG-3390 infrastructure observed by CTU researchers. The dark_\n_green signifies a high count of C2 registrars and IP net blocks, while the light green_\n_represents a smaller count. (Source: Dell SecureWorks)_\n\nThe threat actors create PlugX DLL stub loaders that will run only after a specific date. The\ncompile dates of the samples analyzed by CTU researchers are all later than the hard-coded\nAugust 8, 2013 date, indicating that the code might be reused from previous tools.\n\nThe OwaAuth web shell is likely created with a builder, given that the PE compile time of the\nbinary does not change between instances and the configuration fields are padded to a\nspecific size. The adversaries modify publicly available tools such as ASPXSpy to remove\nidentifying characteristics that network defenders use to identify web shells.\n\n_Weaponization_\n\nAs of this publication, CTU researchers are unsure if TG-3390 relies on weaponizers to\npackage tools and exploits.\n\n_Delivery_\n\nTG-3390 conducts SWCs or sends spearphishing emails with ZIP archive attachments. The\nZIP archives have names relevant to the targets and contain both legitimate files and\nmalware. One archive sample analyzed by CTU researchers contained a legitimate PDF file,\na benign image of interest to targets (see Figure 8), and an HttpBrowser installer disguised\nas an image file.\n\n\n-----\n\n_Figure 8. Decoy image. (Source: Dell SecureWorks)_\n\n[In SWCs analyzed by CTU researchers, the threat actors added the Dean Edwards packed](http://dean.edwards.name/download/#packer)\nJavaScript code shown in Figure 9 to the end of a legitimate website's menu page.\n\n_Figure 9. SWC code. (Source: Dell SecureWorks)_\n\n[As shown in Figure 10, the unpacked JavaScript code reveals an iframe pointing to an IP](http://dean.edwards.name/unpacker/)\naddress that is hosting the exploit.\n\n_Figure 10. Unpacked JavaScript code. (Source: Dell SecureWorks)_\n\nBoth the redirect code on the compromised site and the exploit code appear and disappear,\nindicating that the adversaries add the code when they want to leverage the SWC and\nremove the code when it is not in use to limit the visibility of their operations. The threat\nactors have evolved to whitelisting IP addresses and only delivering the exploit and payload\nto specific targets of interest. CTU researchers have observed TG-3390 compromising a\ntarget organization's externally and internally accessible assets, such as an OWA server, and\nadding redirect code to point internal users to an external website that hosts an exploit and\ndelivers malware.\n\n_Exploitation_\n\nTG-3390 actors have used Java exploits in their SWCs. In particular, the threat actors have\n[exploited CVE-2011-3544, a vulnerability in the Java Runtime Environment, to deliver the](http://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2011-3544)\n[HttpBrowser backdoor; and CVE-2010-0738, a vulnerability in JBoss, to compromise](http://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2010-0738)\ninternally and externally accessible assets used to redirect users' web browsers to exploit\ncode.\n\nIn activity analyzed by CTU researchers, TG-3390 executed the Hunter web application\nscanning tool against a target server running IIS. Hunter queried the following URIs in a\nspecific order to determine if the associated software configurations are insecure, and all\nqueries contained the HttpClient User-Agent:\n\nGET /manager/html/ — Tomcat web application manager\nGET /jmx-console/ — JBoss configuration\nGET /CFIDE/administrator/login.cfm — ColdFusion configuration\n\n\n-----\n\n_Installation_\n\nTG-3390 uses DLL side loading, a technique that involves running a legitimate, typically\ndigitally signed, program that loads a malicious DLL. CTU researchers have observed the\nthreat actors employing legitimate Kaspersky antivirus variants in analyzed samples. The\nDLL acts as a stub loader, which loads and executes the shell code. The adversaries have\nused this technique to allow PlugX and HttpBrowser to persist on a system.\n\nNote: DLL side loading is a prevalent persistence technique that is used to launch a\nmultitude of backdoors. The challenge is detecting known good software loading and\nrunning malware. As security controls have improved, DLL side loading has evolved to\nload a payload stored in a different directory or from a registry value.\n\nIn other cases, threat actors placed web shells on externally accessible servers, sometimes\nbehind a reverse proxy, to execute commands on the compromised system. TG-3390 actors\nhave deployed the OwaAuth web shell to Exchange servers, disguising it as an ISAPI filter.\nThe IIS w3wp.exe process loads the malicious DLL, which CTU researchers have observed\nin the Program Files\\Microsoft\\Exchange Server\\ClientAccess\\Owa\\Bin directory.\n\n_Command and control_\n\nTo traverse the firewall, C2 traffic for most TG-3390 tools occurs over ports 53, 80, and 443.\nThe PlugX malware can be configured to use HTTP, DNS, raw TCP, or UDP to avoid\nnetwork-based detection. In one sample analyzed by CTU researchers, PlugX was\nconfigured with hard-coded user credentials to bypass a proxy that required authentication.\nNewer HttpBrowser versions use SSL with self-signed certificates to encrypt network\ncommunications.\n\nTG-3390 actors frequently change the C2 domain's A record to point to the loopback IP\naddress 127.0.0.1, which is a variation of a technique known as \"parking.\" Other variations of\nparking point the IP address to Google's recursive name server 8.8.8.8, an address\nbelonging to Confluence, or to other non-routable addresses. When the adversaries'\noperations are live, they modify the record again to point the C2 domain to an IP address\nthey can access. A domain name parking example is available in Appendix D.\n\n_Actions on objective_\n\nCTU researchers have discovered numerous details about TG-3390 operations, including\nhow the adversaries explore a network, move laterally, and exfiltrate data. As shown in\nFigure 11, after compromising an initial victim's system (patient 0), the threat actors use the\nBaidu search engine to search for the victim's organization name. They then identify the\n\n\n-----\n\nExchange server and attempt to install the OwaAuth web shell. If the OwaAuth web shell is\nineffective because the victim uses two-factor authentication for webmail, the adversaries\nidentify other externally accessible servers and deploy ChinaChopper web shells. Within six\nhours of entering the environment, the threat actors compromised multiple systems and stole\ncredentials for the entire domain.\n\n_Figure 11. Timeline, in Eastern Time, of TG-3390's initial entry into a victim's network._\n_(Source: Dell SecureWorks)_\n\nThe threat actors use the Hunter and nbtscan tools, sometimes renamed, to conduct network\nreconnaissance for vulnerable servers and online systems (see Figure 12). TG-3390 actors\nfavor At.exe to create scheduled tasks for executing commands on remote systems.\n\n_Figure 12. nbtscan batch script (renamed ipcan.exe) used to profile network. (Source: Dell_\n_SecureWorks)_\n\nOver a few days' span, the threat actors install remote access tools on additional systems\nbased upon the results of the network reconnaissance. They use At.exe to schedule tasks to\nrun self-extracting RAR archives, which install either HttpBrowser or PlugX. CTU researchers\nobserved the threat actors collecting Cisco VPN profiles to use when accessing the victim's\nnetwork via VPN (see Figure 13).\n\n_Figure 13. Copying of .pcf files. (Source: Dell SecureWorks)_\n\nTo facilitate lateral movement, the adversaries deploy ASPXTool web shells to internally\naccessible systems running IIS.\n\nCTU researchers have observed the threat actors encrypting data using the password\n\"admin-windows2014\" and splitting the RAR archives into parts in the recycler directory, with\nthe same name as the uncompressed data (see Figure 14).\n\n\n-----\n\n_Figure 14. Batch script used to archive data. (Source: Dell SecureWorks)_\n\nThe number at the end of the password corresponds to the year of the intrusion. For\nexample, the password \"admin-windows2014\" shown in Figure 14 was changed to \"adminwindows2015\" for TG-3390 intrusions conducted in 2015.\n\nNote: CTU researchers frequently observe threat actors renaming archiving tools and\nstoring data for exfiltration in uncommon directories. In some instances, adversaries\nexceed disk space limits during the exfiltration process, requiring the staging of archives\non multiple systems. Unexplained disk quota alerts on typically underutilized systems\nwarrants immediate investigation.\n\nAnother batch script run by a scheduled task renames the archives on the file server (see\nFigure 15).\n\n_Figure 15. Batch script used to rename exfiltrated data. (Source: Dell SecureWorks)_\n\nCTU researchers have observed TG-3390 actors staging RAR archives, renamed with a .zip\nfile extension, on externally accessible web servers. The adversaries then issue HTTP GET\nrequests, sometimes with the User-Agent MINIXL, to exfiltrate the archive parts from the\nvictim's network (see Figure 16).\n\n_Figure 16. Example GET request from IIS log. (Source: Dell SecureWorks)_\n\nIn other intrusions, data was exfiltrated using the PlugX remote access tool. Figure 17 shows\nnetwork data transfer sizes for a month-long period beginning with TG-3390's re-entry into a\nnetwork. Approximately 300 GB of data was exfiltrated during that span.\n\n\n-----\n\n_Figure 17. Network data transfer sizes to C2 servers after TG-3390 reentry into a network._\n_(Source: Dell SecureWorks)_\n\n### CTU observations\n\nFigure 18 is a UTC time wheel depicting which hours the threat actors actively operated in\none target environment during a three-day intrusion observed by CTU researchers. The\nconcentric bands represent the days of the week, with Saturday as the outside band and\nSunday as the innermost band, and each cell represents an hour. The darker the cell color,\nthe higher the activity level; white indicates no observed activity. TG-3390 was most active\nbetween 04:00 and 09:00 UTC.\n\n\n-----\n\n_Figure 18. Mapping of TG-3390's interactions with web shells during an intrusion responded_\n_to by CTU researchers. The legend across the bottom of the figure lists the upper bound of_\n_interactions that are represented by each color variation on the wheel. Times are based on_\n_UTC. (Source: Dell SecureWorks)_\n\n_Response to eviction_\n\nSuccessfully evicting TG-3390 from an environment requires a coordinated plan to remove\nall access points, including remote access tools and web shells. Within weeks of eviction, the\nthreat actors attempt to access their ChinaChopper web shells from previously used IP\naddresses. Finding the web shells inaccessible, the adversaries search google.co.jp for\nremote access solutions. CTU researchers discovered the threat actors searching for \"\n\n[company] login,\" which directed them to the landing page for remote access. TG-3390\nattempts to reenter the environment by identifying accounts that do not require two-factor\nauthentication for remote access solutions, and then brute forcing usernames and\npasswords. After reestablishing access, the adversaries download tools such as gsecudmp\nand WCE that are staged temporarily on websites that TG-3390 previously compromised but\nnever used. CTU researchers believe legitimate websites are used to host tools because\nweb proxies categorize the sites as benign.\n\n\n-----\n\nNote: Numerous threat groups use legitimate remote access solutions (VPN, Citrix, OWA,\netc.) to enter or reenter a network. After executing an eviction plan, it is paramount to reset\nall credentials, including those for third-party accounts, preferably after implementing twofactor authentication.\n\nTG-3390 actors keep track of and leverage existing ASPXTool web shells in their operations,\npreferring to issue commands via an internally accessible web shell rather than HttpBrowser\nor PlugX. After reentering an environment, the threat actors focus on obtaining the active\ndirectory contents. Figure 19 shows a timeline of TG-3390 attempting to regain a foothold in\na network in a span of only five hours.\n\n_Figure 19. Timeline, in Eastern Time, of TG-3390's reentry into a compromised network._\n_(Source: Dell SecureWorks)_\n\nNote: Relying primarily on network-based security controls will not deter most threat\ngroups from achieving their objective. Adversaries can overcome blacklisted infrastructure\nin minutes, as TG-3390 actors did when they staged tools on compromised web servers.\n\n_Team member or team identifier_\n\nAnalysis of the OwaAuth web shell revealed a PDB string with the \"SyberSpace\" username\n(see Figure 20).\n\n_Figure 20. OwaAuth web shell PDB string. (Source: Dell SecureWorks)_\n\nFurther research revealed additional tools containing the same username (see Figure 21).\n\n\n-----\n\n_Figure 21. PDB strings containing the 'SyberSpace' username. (Source: Dell SecureWorks)_\n\nCTU researchers have no evidence to determine if these tools are also used by TG-3390.\n\n## Conclusion\n\nTG-3390 is known for compromising organizations via SWCs and moving quickly to install\nbackdoors on Exchange servers. Despite the group's proficiency, there are still many\nopportunities to detect and disrupt its operation by studying its modus operandi. The threat\nactors work to overcome existing security controls, or those put in place during an\nengagement, to complete their mission of exfiltrating intellectual property. Due to TG-3390's\ndetermination, organizations should formulate a solid eviction plan before engaging with the\nthreat actors to prevent them from reentering the network.\n\n## Threat indicators\n\nThe indicators in Table 1 are associated with TG-3390 activity. The domains and IP\naddresses may contain malicious content, so consider the risks before opening them in a\nbrowser.\n\nIndicator Type Context\n\namerican.blackcmd.com Domain name TG-3390 infrastructure\nConfidence: High\n\napi.apigmail.com Domain name TG-3390 infrastructure\nConfidence: High\n\napigmail.com Domain name TG-3390 infrastructure\nConfidence: High\n\nbackup.darkhero.org Domain name TG-3390 infrastructure\nConfidence: High\n\nbel.updatawindows.com Domain name TG-3390 infrastructure\nConfidence: High\n\nbinary.update-onlines.org Domain name TG-3390 infrastructure\nConfidence: High\n\nblackcmd.com Domain name TG-3390 infrastructure\nConfidence: High\n\n\n-----\n\ncastle.blackcmd.com Domain name TG-3390 infrastructure\nConfidence: High\n\nctcb.blackcmd.com Domain name TG-3390 infrastructure\nConfidence: High\n\ndarkhero.org Domain name TG-3390 infrastructure\nConfidence: High\n\ndav.local-test.com Domain name TG-3390 infrastructure\nConfidence: High\n\ntest.local-test.com Domain name TG-3390 infrastructure\nConfidence: High\n\ndev.local-test.com Domain name TG-3390 infrastructure\nConfidence: High\n\nocean.local-test.com Domain name TG-3390 infrastructure\nConfidence: High\n\nga.blackcmd.com Domain name TG-3390 infrastructure\nConfidence: High\n\nhelpdesk.blackcmd.com Domain name TG-3390 infrastructure\nConfidence: High\n\nhelpdesk.csc-na.com Domain name TG-3390 infrastructure\nConfidence: High\n\nhelpdesk.hotmail-onlines.com Domain name TG-3390 infrastructure\nConfidence: High\n\nhelpdesk.lnip.org Domain name TG-3390 infrastructure\nConfidence: High\n\nhotmail-onlines.com Domain name TG-3390 infrastructure\nConfidence: High\n\njobs.hotmail-onlines.com Domain name TG-3390 infrastructure\nConfidence: High\n\njustufogame.com Domain name TG-3390 infrastructure\nConfidence: High\n\nlnip.org Domain name TG-3390 infrastructure\nConfidence: High\n\nlocal-test.com Domain name TG-3390 infrastructure\nConfidence: High\n\n\n-----\n\nlogin.hansoftupdate.com Domain name TG-3390 infrastructure\nConfidence: High\n\nlong.update-onlines.org Domain name TG-3390 infrastructure\nConfidence: High\n\nlonglong.update-onlines.org Domain name TG-3390 infrastructure\nConfidence: High\n\nlongshadow.dyndns.org Domain name TG-3390 infrastructure\nConfidence: High\n\nlongshadow.update-onlines.org Domain name TG-3390 infrastructure\nConfidence: High\n\nlongykcai.update-onlines.org Domain name TG-3390 infrastructure\nConfidence: High\n\nlostself.update-onlines.org Domain name TG-3390 infrastructure\nConfidence: High\n\nmac.navydocument.com Domain name TG-3390 infrastructure\nConfidence: High\n\nmail.csc-na.com Domain name TG-3390 infrastructure\nConfidence: High\n\nmantech.updatawindows.com Domain name TG-3390 infrastructure\nConfidence: High\n\nmicr0soft.org Domain name TG-3390 infrastructure\nConfidence: High\n\nmicrosoft-outlook.org Domain name TG-3390 infrastructure\nConfidence: High\n\nmtc.navydocument.com Domain name TG-3390 infrastructure\nConfidence: High\n\nnavydocument.com Domain name TG-3390 infrastructure\nConfidence: High\n\nmtc.update-onlines.org Domain name TG-3390 infrastructure\nConfidence: High\n\nnews.hotmail-onlines.com Domain name TG-3390 infrastructure\nConfidence: High\n\noac.3322.org Domain name TG-3390 infrastructure\nConfidence: High\n\n\n-----\n\nocean.apigmail.com Domain name TG-3390 infrastructure\nConfidence: High\n\npchomeserver.com Domain name TG-3390 infrastructure\nConfidence: High\n\nregistre.organiccrap.com Domain name TG-3390 infrastructure\nConfidence: High\n\nsecurity.pomsys.org Domain name TG-3390 infrastructure\nConfidence: High\n\nservices.darkhero.org Domain name TG-3390 infrastructure\nConfidence: High\n\nsgl.updatawindows.com Domain name TG-3390 infrastructure\nConfidence: High\n\nshadow.update-onlines.org Domain name TG-3390 infrastructure\nConfidence: High\n\nsonoco.blackcmd.com Domain name TG-3390 infrastructure\nConfidence: High\n\ntest.logmastre.com Domain name TG-3390 infrastructure\nConfidence: High\n\nup.gtalklite.com Domain name TG-3390 infrastructure\nConfidence: High\n\nupdatawindows.com Domain name TG-3390 infrastructure\nConfidence: High\n\nupdate-onlines.org Domain name TG-3390 infrastructure\nConfidence: High\n\nupdate.deepsoftupdate.com Domain name TG-3390 infrastructure\nConfidence: High\n\nupdate.hancominc.com Domain name TG-3390 infrastructure\nConfidence: High\n\nupdate.micr0soft.org Domain name TG-3390 infrastructure\nConfidence: High\n\nupdate.pchomeserver.com Domain name TG-3390 infrastructure\nConfidence: High\n\nurs.blackcmd.com Domain name TG-3390 infrastructure\nConfidence: High\n\n\n-----\n\nwang.darkhero.org Domain name TG-3390 infrastructure\nConfidence: High\n\nwebs.local-test.com Domain name TG-3390 infrastructure\nConfidence: High\n\nword.apigmail.com Domain name TG-3390 infrastructure\nConfidence: High\n\nwordpress.blackcmd.com Domain name TG-3390 infrastructure\nConfidence: High\n\nworking.blackcmd.com Domain name TG-3390 infrastructure\nConfidence: High\n\nworking.darkhero.org Domain name TG-3390 infrastructure\nConfidence: High\n\nworking.hotmail-onlines.com Domain name TG-3390 infrastructure\nConfidence: High\n\nwww.trendmicro-update.org Domain name TG-3390 infrastructure\nConfidence: High\n\nwww.update-onlines.org Domain name TG-3390 infrastructure\nConfidence: High\n\nx.apigmail.com Domain name TG-3390 infrastructure\nConfidence: High\n\nykcai.update-onlines.org Domain name TG-3390 infrastructure\nConfidence: High\n\nykcailostself.dyndns-free.com Domain name TG-3390 infrastructure\nConfidence: High\n\nykcainobody.dyndns.org Domain name TG-3390 infrastructure\nConfidence: High\n\nzj.blackcmd.com Domain name TG-3390 infrastructure\nConfidence: High\n\nlaxness-lab.com Domain name TG-3390 infrastructure\nConfidence: High\n\ngoogle-ana1ytics.com Domain name TG-3390 infrastructure\nConfidence: High\n\nwww.google-ana1ytics.com Domain name TG-3390 infrastructure\nConfidence: High\n\n\n-----\n\nftp.google-ana1ytics.com Domain name TG-3390 infrastructure\nConfidence: High\n\nhotmailcontact.net Domain name TG-3390 infrastructure\nConfidence: High\n\n208.115.242.36 IP address TG-3390 infrastructure\nConfidence: High\n\n208.115.242.37 IP address TG-3390 infrastructure\nConfidence: High\n\n208.115.242.38 IP address TG-3390 infrastructure\nConfidence: High\n\n66.63.178.142 IP address TG-3390 infrastructure\nConfidence: High\n\n72.11.148.220 IP address TG-3390 infrastructure\nConfidence: High\n\n72.11.141.133 IP address TG-3390 infrastructure\nConfidence: High\n\n74.63.195.236 IP address TG-3390 infrastructure\nConfidence: High\n\n74.63.195.236 IP address TG-3390 infrastructure\nConfidence: High\n\n74.63.195.237 IP address TG-3390 infrastructure\nConfidence: High\n\n74.63.195.238 IP address TG-3390 infrastructure\nConfidence: High\n\n103.24.0.142 IP address TG-3390 infrastructure\nConfidence: High\n\n103.24.1.54 IP address TG-3390 infrastructure\nConfidence: High\n\n106.187.45.162 IP address TG-3390 infrastructure\nConfidence: High\n\n192.151.236.138 IP address TG-3390 infrastructure\nConfidence: High\n\n192.161.61.19 IP address TG-3390 infrastructure\nConfidence: High\n\n\n-----\n\n192.161.61.20 IP address TG-3390 infrastructure\nConfidence: High\n\n192.161.61.22 IP address TG-3390 infrastructure\nConfidence: High\n\n103.24.1.54 IP address TG-3390 infrastructure\nConfidence: High\n\n67.215.232.179 IP address TG-3390 infrastructure\nConfidence: High\n\n96.44.177.195 IP address TG-3390 infrastructure\nConfidence: High\n\n49.143.192.221 IP address TG-3390 infrastructure\nConfidence: Moderate\n\n67.215.232.181 IP address TG-3390 infrastructure\nConfidence: Moderate\n\n67.215.232.182 IP address TG-3390 infrastructure\nConfidence: Moderate\n\n96.44.182.243 IP address TG-3390 infrastructure\nConfidence: Moderate\n\n96.44.182.245 IP address TG-3390 infrastructure\nConfidence: Moderate\n\n96.44.182.246 IP address TG-3390 infrastructure\nConfidence: Moderate\n\n49.143.205.30 IP address TG-3390 infrastructure\nConfidence: Moderate\n\nworking_success@163.com Email address TG-3390 email address\nConfidence: High\n\nykcaihyl@163.com Email address TG-3390 email address\nConfidence: High\n\nworking_success@163.com Email address TG-3390 email address\nConfidence: High\n\nyuming@yinsibaohu.aliyun.com Email address TG-3390 email address\nConfidence: Low\n\n1cb4b74e9d030afbb18accf6ee2bfca1 MD5 hash HttpBrowser RAT dropper\n\nb333b5d541a0488f4e710ae97c46d9c2 MD5 hash HttpBrowser RAT dropper\n\n\n-----\n\n86a05dcffe87caf7099dda44d9ec6b48 MD5 hash HttpBrowser RAT dropper\n\n93e40da0bd78bebe5e1b98c6324e9b5b MD5 hash HttpBrowser RAT dropper\n\nf43d9c3e17e8480a36a62ef869212419 MD5 hash HttpBrowser RAT dropper\n\n57e85fc30502a925ffed16082718ec6c MD5 hash HttpBrowser RAT dropper\n\n4251aaf38a485b08d5562c6066370f09 MD5 hash HttpBrowser RAT dropper\n\nbbfd1e703f55ce779b536b5646a0cdc1 MD5 hash HttpBrowser RAT dropper\n\n12a522cb96700c82dc964197adb57ddf MD5 hash HttpBrowser RAT dropper\n\n728e5700a401498d91fb83159beec834 MD5 hash HttpBrowser RAT dropper\n\n2bec1860499aae1dbcc92f48b276f998 MD5 hash HttpBrowser RAT dropper\n\n014122d7851fa8bf4070a8fc2acd5dc5 MD5 hash HttpBrowser RAT\n\n0ae996b31a2c3ed3f0bc14c7a96bea38 MD5 hash HttpBrowser RAT\n\n1a76681986f99b216d5c0f17ccff2a12 MD5 hash HttpBrowser RAT\n\n380c02b1fd93eb22028862117a2f19e3 MD5 hash HttpBrowser RAT\n\n40a9a22da928cbb70df48d5a3106d887 MD5 hash HttpBrowser RAT\n\n46cf2f9b4a4c35b62a32f28ac847c575 MD5 hash HttpBrowser RAT\n\n5436c3469cb1d87ea404e8989b28758d MD5 hash HttpBrowser RAT\n\n692cecc94ac440ec673dc69f37bc0409 MD5 hash HttpBrowser RAT\n\n6a39a4e9933407aef31fdc3dfa2a2a95 MD5 hash HttpBrowser RAT\n\n8b4ed3b392ee5da139c16b8bca38ea5e MD5 hash HttpBrowser RAT\n\n8ea5d8bb6b28191e4436456c35477e39 MD5 hash HttpBrowser RAT\n\n9271bcfbba056c8f80c7f04d72efd62d MD5 hash HttpBrowser RAT\n\n996843b55a7c5c7a36e8c6956e599610 MD5 hash HttpBrowser RAT\n\na554efc889714c70e9362bdc81fadd6a MD5 hash HttpBrowser RAT\n\nc9c93c2d62a084031872aab96202ee3e MD5 hash HttpBrowser RAT\n\nddbdf0efdf26e0c267ef6155edb0e6b8 MD5 hash HttpBrowser RAT\n\ne7df18a17d8e7c2ed541a57020444068 MD5 hash HttpBrowser RAT\n\n\n-----\n\nea4dcafc224f604c096032dde33a1d6d MD5 hash HttpBrowser RAT\n\nf658bb17d69912404f34532901edad0e MD5 hash HttpBrowser RAT\n\nf869a1b40f6438dfdd89e73480103211 MD5 hash HttpBrowser RAT\n\n81ed752590752016cb1c12f3e9ab3454 MD5 hash HttpBrowser RAT\n\n5ef719f8aeb9bf97beb24a5c2ed19173 MD5 hash HttpBrowser RAT\n\n7ec91768376324be2bad4fd30b1c2051 MD5 hash HttpBrowser RAT\n\n20c446ad2d7d1586138b493ecddfbbc7 MD5 hash HttpBrowser RAT\n\n44cf0793e05ba843dd53bbc7020e0f1c MD5 hash HttpBrowser RAT\n\n02826bb6636337963cc5162e6f87745e MD5 hash HttpBrowser RAT\n\n1606ab7a54735af654ee6deb7427f652 MD5 hash HttpBrowser RAT\n\n1539b3a5921203f0e2b6c05d692ffa27 MD5 hash HttpBrowser RAT\n\nc66e09429ad6669321e5c69b1d78c082 MD5 hash HttpBrowser RAT\n\n225e10e362eeee15ec64246ac021f4d6 MD5 hash HttpBrowser RAT\n\na631fc7c45cbdf80992b9d730df0ff51 MD5 hash HttpBrowser RAT\n\naf785b4df71da0786bcae233e55cf6c1 MD5 hash HttpBrowser RAT\n\ne3e0f3ad4ff3b981b513cc66b37583e8 MD5 hash HttpBrowser RAT\n\n5cd0e97a1f09001af5213462aa3f7eb1 MD5 hash HttpBrowser RAT\n\n15fd9c04d6099273a9acf8feab81acfe MD5 hash HttpBrowser RAT\n\nea8b9e0bf95fc0c71694310cb685cd3b MD5 hash HttpBrowser RAT\n\n5c3ab475be110ec59257617ee1388e01 MD5 hash HttpBrowser RAT\n\n6aac7417ea1eb60a869597af9049b8fa MD5 hash HttpBrowser RAT\n\n372f5370085a63f5b660fab635ce6cd7 MD5 hash HttpBrowser RAT\n\nfac4885324cb67bd421d6250fdc9533c MD5 hash HttpBrowser RAT\n\ne7e555615a07040bb5dbe9ce59ac5d11 MD5 hash HttpBrowser RAT\n\nff34cb1d90d76a656546293e879afe22 MD5 hash HttpBrowser RAT\n\n2abf7421c34c60d48e09325a206e720e MD5 Hash HttpBrowser RAT\n\n\n-----\n\n396b4317db07cc8a2480786160b33044 MD5 hash HttpBrowser RAT\n\ne404873d3fcd0268db10657b53bdab64 MD5 hash HttpBrowser RAT\n\n6e4189b20adb253b3c1ad7f8fdc95009 MD5 hash HttpBrowser RAT\n\nbff424289c38d389a8cafb16b47dfe39 MD5 hash HttpBrowser RAT\n\n7294c7f3860315d51f74152e8ad353df MD5 hash HttpBrowser RAT\n\n40092f76fea082b05e9631d91975a401 MD5 hash HttpBrowser RAT\n\ne42fce74bbd637c35320cf4e95f5e055 MD5 hash HttpBrowser RAT\n\nd0dafc3716a0d0ce393cde30b2b14a07 MD5 hash HttpBrowser RAT\n\nae66bad0c7de88ab0ab1050c4bec9095 MD5 hash HttpBrowser RAT\n\nc7c2be1cd3780b2ba4638cef9a5422c7 MD5 hash HttpBrowser RAT\n\n405949955b1cb65673c16bf7c8da2f4d MD5 hash HttpBrowser RAT\n\nff4f052dbe73a81403df5e98313000fb MD5 hash HttpBrowser RAT\n\nb30fcd362c7b8ac75b7dddfe6cb448c7 MD5 hash HttpBrowser RAT\n\n1d24f4d20b80562de46a8ac95d0ff8c2 MD5 hash HttpBrowser RAT\n\n9538bbdb3a73201b40296e9d4dc80ade MD5 hash HttpBrowser RAT\n\n46bb2caeda30c09a6337fd46ec98c32c MD5 hash HttpBrowser RAT\n\n0c8842e48e80643d91dd290d0f786147 MD5 hash HttpBrowser RAT\n\n0fc975c3c4e6c546b4f2b5aaed50dd78 MD5 hash HttpBrowser RAT\n\n41be449f687828466ed7d87f0f30a278 MD5 hash HttpBrowser RAT\n\n2b95caf3307ebd36cf405b1133b30aa8 MD5 hash HttpBrowser RAT\n\nccc715a4d9d0157b9776deacdb26bf78 MD5 hash HttpBrowser RAT\n\n37933acfa8d8e78c54413d88ca705e17 MD5 hash HttpBrowser RAT\n\n2813c5a1c87f7e3d33174fed8b0988a1 MD5 hash HttpBrowser RAT\n\n8f22834efe52ccefb17e768569eb36b9 MD5 hash HttpBrowser RAT\n\n6f01628a0b5de757a8dbe99020499d10 MD5 hash HttpBrowser RAT\n\n7f8d9f12f41156512b60ab17f8d85fe9 MD5 hash HttpBrowser RAT\n\n\n-----\n\ndebe5ef2868b212f4251c58be1687660 MD5 hash HttpBrowser RAT\n\ne136d4ebab357fd19df8afe221460571 MD5 hash HttpBrowser RAT\n\na86a906cfafaf1d7e3725bb0161b0cfe MD5 hash HttpBrowser RAT\n\n03e1eac3512a726da30fff41dbc26039 MD5 hash HttpBrowser RAT\n\nbaac5e5dd3ce7dae56cab6d3dac14e15 MD5 hash HttpBrowser RAT\n\n0f7dde31fbeb5ddbb6230c401ed41561 MD5 hash HttpBrowser RAT\n\n36d957f6058f954541450f5a85b28d4b MD5 hash HttpBrowser RAT\n\n42d874f91145bd2ddf818735346022d8 MD5 hash HttpBrowser RAT\n\n3468034fc3ac65c60a1f1231e3c45107 MD5 hash HttpBrowser RAT\n\n4e3b51a6a18bdb770fc38650a70b1883 MD5 hash HttpBrowser RAT\n\n3647068230839f9cadf0fd4bd82ade84 MD5 hash HttpBrowser RAT\n\n550922107d18aa4caad0267997709ee5 MD5 hash HttpBrowser RAT\n\nd8f0a6450f9df637daade521dc90d29d MD5 hash HttpBrowser RAT\n\nbf2e2283b19b0febc4bd1f47aa82a94c MD5 hash HttpBrowser RAT\n\nd0eec2294a70ceff84ca8d0ed7939fb5 MD5 hash HttpBrowser RAT\n\ne91d2464c8767552036dd0294fc7e6fb MD5 hash HttpBrowser RAT\n\nf627bc2db3cab34d97c8949931cb432d MD5 hash HttpBrowser RAT\n\nb313bbe17bd5ee9c00acff3bfccdb48a MD5 hash PlugX RAT dropper\n\nf7a842eb1364d1269b40a344510068e8 MD5 hash PlugX RAT dropper\n\n8dacca7dd24844935fcd34e6c9609416 MD5 hash PlugX RAT dropper\n\n7cffd679599fb8579abae8f32ce49026 MD5 hash PlugX RAT dropper\n\n462fd01302bc40624a44b7960d2894cd MD5 hash PlugX RAT dropper\n\n_Table 1. TG-3390 indicators._\n\n## Appendix A — Identifying attribution and gauging confidence\n\n### Identifying attribution\n\n\n-----\n\nIn most cases, CTU researchers not have intelligence to directly attribute a threat group, so\nattribution relies on circumstantial evidence and is an assessment rather than a fact. CTU\nresearchers draw on three distinct intelligence bases for evidence of attribution:\n\nObserved activity is gathered from CTU researchers' observation and investigation of a\nthreat group's activity on a target network and across Dell SecureWorks data, and\nanalysis of tactics, techniques, and procedures (TTPs) the threat group employs.\nThird-party intelligence is gained from trusted relationships within the security industry\nand with other private and public sector organizations, as well as analysis of open\nsource intelligence.\nContextual analysis compares threat group targets against intelligence requirements of\nnation states and other threat actors and compares tradecraft employed by a threat\ngroup to tradecraft of known threat actors.\n\n### Gauging confidence level\n\n[CTU researchers have adopted the grading system published by the U.S. Office of the](http://www.dni.gov/files/documents/Newsroom/Press%20Releases/2007%20Press%20Releases/20071203_release.pdf)\nDirector of National Intelligence to indicate confidence in their assessments:\n\n**High confidence generally indicates that judgments are based on high-quality**\ninformation, and/or that the nature of the issue makes it possible to render a solid\njudgment. A \"high confidence\" judgment is not a fact or a certainty, however, and such\njudgments still carry a risk of being wrong.\n**Moderate confidence generally means that the information is credibly sourced and**\nplausible but not of sufficient quality or corroborated sufficiently to warrant a higher\nlevel of confidence.\n**Low confidence generally means that the information's credibility and/or plausibility is**\nquestionable, or that the information is too fragmented or poorly corroborated to make\nsolid analytic inferences, or that [there are] significant concerns or problems with the\nsources.\n\n## Appendix B — HttpBrowser analysis\n\nHttpBrowser is a remote access tool whose name originates from the hard-coded\n\"HttpBrowser/1.0\" User-Agent. CTU researchers also identified a PDB string in the binaries,\nJ:\\TokenControlV3\\ServerDll\\Release\\ServerDll.pdb, which implies that the threat actors may\nrefer to the tool as \"TokenControl.\" Table 2 lists the commands available to threat actors in\none of the HttpBrowser variants.\n\nCommand Functionality\n\n\n-----\n\nInit Create a reverse shell\n\nWrite Write a file to the compromised system from the C2 server\n\nList List the files in a directory\n\nUpload Upload a file from the compromised system to the C2 server\n\n_Table 2. HttpBrowser command set. (Source: Dell SecureWorks)_\n\nOther variants of the backdoor may include additional commands such as setcmd, settime,\nuninstall, and down. Table 3 shows the unencrypted URL parameters, along with sample\ndata and a description of the data.\n\n\nURL\nparameter\n\n\nSample data Description\n\n\nc= Victim->Administrator Hostname and username\n\nl= 192.168.1.100 Compromised system's IP address\n\no= 5,1,1,32 Windows major and minor version, coupled\nwith\n\narchitecture (32 v. 64)\n\n\nu= {B5B70BD7-87FC-499AB4D198163306F0D8}\n\n\nA GUID\n\n\nr= 1 Boolean value if the malware is running as\ninjected code\n\nt= 8035187 Number of milliseconds the computer has been\nrunning\n\n_Table 3. HttpBrowser parameters. (Source: Dell SecureWorks)_\n\n## Appendix C — OwaAuth web shell analysis\n\nOwaAuth is a web shell that is installed as an ISAPI filter on Exchange servers and shares\ncharacteristics with the ChinaChopper web shell. Like ChinaChopper, it parses HTTP\nrequests for the Z1 and Z2 parameters (see Table 4). The legitimate owaauth.dll file resides\nin %ProgramFiles%\\Microsoft\\Exchange Server\\ClientAccess\\Owa\\Auth\\ while CTU\nresearchers have observed the backdoor using the same filename in the\n%ProgramFiles%\\Microsoft\\Exchange Server\\ClientAccess\\Owa\\bin\\ directory. In addition to\nacting as a web shell, the malware captures and DES-encrypts credentials before writing the\nusername and password to disk. The OwaAuth web shell enables a threat actor to upload\nand download files launch processes and execute SQL queries\n\n\n-----\n\nEach web shell instance is configured to contain SP, Key, and Log variables. The SP variable\nis a string containing the victim's username. When the malicious ISAPI filter captures a\nusername matching this variable, it knows to handle the incoming HTTP request as a\ncommand to the web shell. The DES key to encrypt the credentials in the configuration\nobserved by CTU researchers is 12345678, and the log file is c:\\log.txt. The decrypted\ncontents of the log file adhere to the format in Figure 22.\n\n_Figure 22. Decrypted OwaAuth log file format. (Source: Dell SecureWorks)_\n\nTable 4 lists the OwaAuth web shell commands available to the adversary.\n\nCommand Functionality\n\nA List logical drives\n\nB List directory (Z1 = directory name to list)\n\nC Read data from file (Z1 = filename to read)\n\nD Write content to file (Z1 = filename to write, Z2 = content to write)\n\nE Delete file in directory (Z1 = file)\n\nF Generate custom web response \"->|value in Z1|<-\"\n\nG Write hex-encoded content to file (Z1 = filename to write, Z2 = hex encoded\ncontent to write)\n\nH Call _Notice(Z1, Z2)\n\nI Move/rename file or directory (Z1 = target, Z2 = new name)\n\nJ Create directory (Z1 = directory name)\n\nK Timestomp file or directory (Z1 = target, Z2 = time/date string to stomp to)\n\nL Download file from Internet (Z1 = URL, Z2 = filename to write to)\n\nM Launch process (Z1 = process name, Z2 = arguments)\n\nN Test connect to SQL database (Z1 = SqlConnect String)\n\nO SQL Get database table scheme (Z1 = \\r delimited parameters to command)\n\nP SQL Get database table scheme with restrictions (Z1 = \\r delimited\nparameters to command)\n\nQ SQL execute SQL command (Z1 = \\r delimited parameters to command)\n\n_Table 4. OwaAuth web shell command set. (Source: Dell SecureWorks)_\n\n\n-----\n\n## Appendix D — Domain name parking example\n\nCTU researchers have observed TG-3390 parking domains by pointing their A record to a\nnon-routable IP space, including the 127.0.0.[x] loopback address. Table 5 demonstrates\nhow the threat actors change one of their C2 domains to point to routable and non-routable\nIP addresses over time.\n\nStart date End date IP change Location\n\n7/9/13 7/31/13 210.116.106.66 Seoul, Korea\n\n7/31/13 10/12/13 127.0.0.1 N/A\n\n10/12/13 11/5/13 122.10.10.196 Hong Kong\n\n11/5/13 1/12/14 198.100.107.107 California, U.S.\n\n1/12/14 3/5/14 127.0.0.1 N/A\n\n3/5/14 3/31/14 103.24.0.142 Hong Kong\n\n3/31/14 10/27/14 103.24.1.54 Hong Kong\n\n10/27/14 11/9/14 127.0.0.1 N/A\n\n11/9/14 5/25/15 127.0.0.3 N/A\n\n5/25/15 Current as of this publication 127.0.0.1 N/A\n\n_Table 5. Example parking of trendmicro-update . org (Source: Dell SecureWorks)_\n\n## Endnotes\n\n[1] The Dell SecureWorks Counter Threat Unit(TM) (CTU) research team tracks threat\ngroups by assigning them four-digit randomized numbers (3390 in this case), and compiles\ninformation from first-hand incident response observations and from external sources.\n\n[2] Threat groups use strategic web compromises (SWCs), also known as watering hole\nattacks, to target a wide array of potential victims. Threat actors compromise a website used\nby their target demographic (e.g., compromising a website specializing in oil and gas industry\nnews when targeting the energy vertical). Visitors to the compromised website are redirected\nto a server under the threat group's control, where their system is compromised with the\nthreat group's malware. With this tactic, a threat group increases the likelihood of\ncompromising systems that possess desired information.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2015/2015-08-05 - Threat Group 3390 Cyberespionage.pdf"
    ],
    "report_names": [
        "2015-08-05 - Threat Group 3390 Cyberespionage.pdf"
    ],
    "threat_actors": [
        {
            "id": "1a76ed30-4daf-4817-98ae-87c667364464",
            "created_at": "2022-10-25T16:47:55.891029Z",
            "updated_at": "2025-03-27T02:05:17.408867Z",
            "deleted_at": null,
            "main_name": "IRON LIBERTY",
            "aliases": [
                "ATK6 ",
                "BROMINE ",
                "CASTLE ",
                "Crouching Yeti ",
                "DYMALLOY ",
                "Dragonfly ",
                "Energetic Bear / Berserk Bear ",
                "Ghost Blizzard ",
                "TEMP.Isotope ",
                "TG-4192 ",
                "ALLANITE "
            ],
            "source_name": "Secureworks:IRON LIBERTY",
            "tools": [
                " Ddex Loader",
                " Havex",
                " Karagany",
                " Loek",
                " MCMD",
                " Sysmain",
                " xfrost",
                "ClientX"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "e3492534-85a6-4c87-a754-5ae4a56d7c8c",
            "created_at": "2022-10-25T15:50:23.819113Z",
            "updated_at": "2025-03-27T02:00:55.552554Z",
            "deleted_at": null,
            "main_name": "Threat Group-3390",
            "aliases": [
                "Threat Group-3390",
                "Earth Smilodon",
                "TG-3390",
                "Emissary Panda",
                "BRONZE UNION",
                "APT27",
                "Iron Tiger",
                "LuckyMouse"
            ],
            "source_name": "MITRE:Threat Group-3390",
            "tools": [
                "Systeminfo",
                "gsecdump",
                "PlugX",
                "ASPXSpy",
                "Cobalt Strike",
                "Mimikatz",
                "Impacket",
                "gh0st RAT",
                "certutil",
                "China Chopper",
                "HTTPBrowser",
                "Tasklist",
                "netstat",
                "SysUpdate",
                "HyperBro",
                "ZxShell",
                "RCSession",
                "ipconfig",
                "Clambling",
                "pwdump",
                "NBTscan",
                "Pandora",
                "Windows Credential Editor"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "2c980ea7-04c4-4193-8535-52f87e66a96e",
            "created_at": "2024-05-01T02:03:07.994126Z",
            "updated_at": "2025-03-27T02:05:17.293799Z",
            "deleted_at": null,
            "main_name": "BRONZE UNION",
            "aliases": [
                "Budworm ",
                "Emissary Panda ",
                "Iron Tiger ",
                "Lucky Mouse ",
                "TG-3390 ",
                "Temp.Hippo ",
                "APT27 "
            ],
            "source_name": "Secureworks:BRONZE UNION",
            "tools": [
                " ASPXSpy",
                " China Chopper",
                " Enfal",
                " Gh0st RAT",
                " HttpBrowser",
                " Hunter",
                " HyperBro",
                " OwaAuth",
                " PlugX",
                " PoisonIvy",
                " Sysupdate",
                " ZxShell",
                "9002"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "c63ab035-f9f2-4723-959b-97a7b98b5942",
            "created_at": "2023-01-06T13:46:38.298354Z",
            "updated_at": "2025-03-27T02:00:02.798255Z",
            "deleted_at": null,
            "main_name": "APT27",
            "aliases": [
                "TG-3390",
                "EMISSARY PANDA",
                "TEMP.Hippo",
                "Budworm",
                "Group 35",
                "BRONZE UNION",
                "Lucky Mouse",
                "Iron Taurus",
                "GreedyTaotie",
                "Red Phoenix",
                "ZipToken",
                "Iron Tiger",
                "G0027",
                "Earth Smilodon"
            ],
            "source_name": "MISPGALAXY:APT27",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "5c13338b-eaed-429a-9437-f5015aa98276",
            "created_at": "2022-10-25T16:07:23.582715Z",
            "updated_at": "2025-03-27T02:02:09.875151Z",
            "deleted_at": null,
            "main_name": "Emissary Panda",
            "aliases": [
                "APT 27",
                "ATK 15",
                "Bronze Union",
                "Budworm",
                "Earth Smilodon",
                "Emissary Panda",
                "Group 35",
                "Iron Taurus",
                "Iron Tiger",
                "LuckyMouse",
                "Operation DRBControl",
                "Operation Iron Tiger",
                "Operation PZChao",
                "Operation SpoiledLegacy",
                "Operation StealthyTrident",
                "Red Phoenix",
                "TEMP.Hippo",
                "TG-3390",
                "ZipToken"
            ],
            "source_name": "ETDA:Emissary Panda",
            "tools": [
                "ASPXSpy",
                "ASPXTool",
                "Agent.dhwf",
                "AngryRebel",
                "Antak",
                "CHINACHOPPER",
                "China Chopper",
                "Destroy RAT",
                "DestroyRAT",
                "FOCUSFJORD",
                "Farfli",
                "Gh0st RAT",
                "Ghost RAT",
                "HTTPBrowser",
                "HTran",
                "HUC Packet Transmit Tool",
                "HighShell",
                "HttpBrowser RAT",
                "HttpDump",
                "HyperBro",
                "HyperSSL",
                "HyperShell",
                "Kaba",
                "Korplug",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "Mimikatz",
                "Moudour",
                "Mydoor",
                "Nishang",
                "OwaAuth",
                "PCRat",
                "PlugX",
                "ProcDump",
                "PsExec",
                "RedDelta",
                "SEASHARPEE",
                "Sensocode",
                "SinoChopper",
                "Sogu",
                "SysUpdate",
                "TIGERPLUG",
                "TVT",
                "Thoper",
                "Token Control",
                "TokenControl",
                "TwoFace",
                "WCE",
                "Windows Credential Editor",
                "Windows Credentials Editor",
                "Xamtrav",
                "ZXShell",
                "gsecdump",
                "luckyowa"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535846,
    "ts_updated_at": 1743041745,
    "ts_creation_date": 1653774715,
    "ts_modification_date": 1653774715,
    "files": {
        "pdf": "https://archive.orkl.eu/d93b09b770b91c7e24d22107ece6172745369b3c.pdf",
        "text": "https://archive.orkl.eu/d93b09b770b91c7e24d22107ece6172745369b3c.txt",
        "img": "https://archive.orkl.eu/d93b09b770b91c7e24d22107ece6172745369b3c.jpg"
    }
}