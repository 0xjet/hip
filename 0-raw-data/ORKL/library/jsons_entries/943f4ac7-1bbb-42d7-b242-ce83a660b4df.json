{
    "id": "943f4ac7-1bbb-42d7-b242-ce83a660b4df",
    "created_at": "2023-01-12T14:59:03.301017Z",
    "updated_at": "2025-03-27T02:16:59.248802Z",
    "deleted_at": null,
    "sha1_hash": "32f7352205e861bef4d60aa8a40cf27b9f61068f",
    "title": "2016-07-08 - GootKit- Bobbing and Weaving to Avoid Prying Eyes",
    "authors": "",
    "file_creation_date": "2022-05-28T03:51:58Z",
    "file_modification_date": "2022-05-28T03:51:58Z",
    "file_size": 1459505,
    "plain_text": "# Bobbing and Weaving to Avoid Prying Eyes\n\n**[securityintelligence.com/gootkit-bobbing-and-weaving-to-avoid-prying-eyes/](https://securityintelligence.com/gootkit-bobbing-and-weaving-to-avoid-prying-eyes/)**\n\n[Banking & Finance July 8, 2016](https://securityintelligence.com/category/topics/banking-financial-services-industry/)\nBy [Limor Kessem 7 min read](https://securityintelligence.com/author/limor-kessem/)\n\n\nJuly 8, 2016\n\n\n-----\n\n_[GootKit research was performed by Tomer Agayev and](https://securityintelligence.com/author/tomer-agayev/)_ _[Gadi Ostrovsky.](https://securityintelligence.com/author/gadi-ostrovsky/)_\n\nDiscovered in the wild in the summer of 2014, GootKit is believed to be a privately held\ncybercrime tool that is not sold to other criminals in underground forums and is operated by a\nclosed gang. Considering its stealth, data theft and browser manipulation capabilities,\nGootKit is one of the most advanced banking Trojans active nowadays. It is used in online\nbanking fraud attacks that target consumer and business bank accounts primarily located in\nEurope.\n\nIn online banking fraud attacks witnessed throughout 2016, GootKit’s masters leverage this\nmalware’s capabilities to infiltrate the endpoints of retail and business banking customers,\nsteal their personal authentication credentials and manipulate their online banking sessions\nwith social engineering. They eventually take over those accounts and transfer cash to mule\naccounts they control.\n\nBeyond its overall modus operandi, GootKit is a malware project that implements stealth and\npersistency alongside real-time, web-based activities like dynamic webinjections, which\nmodify the banking website as rendered in the infected machine’s browser. Since it is\noperated by one gang, GootKit is believed to have its own in-house developers focused on\nevolving its stealth mechanisms, security evasion techniques and fraud capabilities.\n\n[IBM X-Force Research analysis of the GootKit Trojan showed some interesting changes](https://www.ibm.com/security/xforce/)\nwere made to the code in June 2016, including:\n\nGootKit’s lighter video-grabbing module;\n\nEnhanced VM detection capability; and\n\nInstallation flow modifications designed for continued evasion.\n\n## Lightening the Video Grabber’s Load\n\nX-Force researchers who analyzed GootKit believe that in an effort to shrink the size of\nvideos captured on infected victim machines, GootKit’s developers made some cosmetic\nchanges to their video-grabbing module.\n\nUp until its recent variants, GootKit recorded videos of the victim’s desktop and exfiltrated\nthem to its command-and-control (C&C) server in MP4 files. These files are typically hefty in\nsize.\n\n**Related:** [GootKit Launches Redirection Attacks in the UK](https://securityintelligence.com/gootkit-launches-redirection-attacks-in-the-uk/)\nA new format enforced by GootKit’s developer is .ivf files, which are encoded by using the\nIndeo codec from Ligos Corporation. This is a peculiar move on GootKit’s part because .ivf\nfiles are quite an old format. The codec was popular in the 1990s since it was the first to\nallow full-speed video playback without using hardware acceleration. This standard was\n\n\n-----\n\nsuperseded by newer formats and became rare. It s possible that .ivf files were selected for\nsmaller size, and also for being a format that most modern-day security software may not\ninspect or block upon exfiltration to the criminal’s servers.\n\nOnce GootKit has a video in this format, it compresses the file to .lzma for a lighter file that\ncan preserve the video’s quality. LZMA files are similar to other compression algorithms,\nsuch as ZIP, that compress data to save disk space. However, LZMA compression is known\nto provide faster decompression times than other algorithms. These types of files are mostly\nused in Unix-based operating systems.\n\n## GootKit’s Strong Suit: Security Evasion\n\nIt appears that keeping itself as elusive as possible is a top concern for GootKit. One of\nGootKit’s most advanced malware capabilities lies in its security and research tool evasion\ntechniques.\n\nIt is evident to IBM X-Force researchers that GootKit’s developers have built and continue to\nbuild high walls around the malware to keep it away from researchers’ prying eyes. In recent\nGootKit builds, we can clearly observe these capabilities.\n\n## Serving Up VM Detection\n\n### Phase One: VM Checks by GootKit’s Dropper\n\nThe first check for virtual machine (VM) values takes place at the dropper phase before\nGootKit’s payload is deployed. The dropper verifies the system’s processor value inside the\nWindows Registry, searching for a specific name used in servers.\n\nThe dropper further checks for VM resources on disk and for additional specific values in the\nRegistry. For example, it checks the target device’s basic input/output system (BIOS) to find\nvalues that may indicate a virtual machine client installed on it, including:\n\nAMI;\n\nBOCHS;\n\nVBOX;\n\nQEMU;\n\nSMCI;\n\nINTEL – 6040000;\n\n\n-----\n\nFTNT-1; and\n\nSONI.\n\nThe next check goes over the machine’s MAC address, looking for a list of values that\nusually appear when the endpoint is a virtual machine.\n\nIf any of the suspect values are found, GootKit raises a VM flag and quits its activity. The info\nis sent to the C&C to allow the botmaster to take action on the issue — like blacklist the\nendpoint.\n\nAt this point, if all checks are clear, the dropper unpacks the GootKit payload and deploys its\nmodules on the infected endpoint.\n\n### Phase Two: VM Checks by the GootKit Trojan\n\nAfter the GootKit payload is deployed, some VM checks are repeated and others are added.\nFor example, the malware scans for telling BIOS Registry values. It then checks for a white\nlist of names acceptable for the central processing unit (CPU); any other name would raise a\nVM flag. This check is performed because VMs typically attribute a specific name to the CPU\nthat would differ from names used in physical endpoints.\n\n[This verification of CPU-related information is not unique. In mid-2015, the Dyre malware](https://threatpost.com/dyre-banking-trojan-jumps-out-of-sandbox/112533/)\nchecked for processor cores on the target devices before fully installing, aiming to detect\nVMs that typically only run on one core to save resources. That sets VMs apart from most\nuser machines that would run on at least two cores.\n\nIn the next check, GootKit scans for [IDE/SCSI hard drives on target machines. GootKit’s](http://www.computerhope.com/issues/ch001240.htm)\ndevelopers are looking to scan for VM values (specifically VMWare, VBOX and SONI) that\nare more deeply embedded in the target system and cannot easily be modified by crafty\nresearchers who would set up a VM to appear identical to a potential victim’s device. For\nGootKit, this means reliability: It can better detect whether the device it is being run on is a\nphysical machine or a VM iteration.\n\n## Take the Road Less Traveled to Look Less Familiar\n\nTo ensure its successful deployment to as many machines as possible, the malware is\nconstantly changing things up, keeping static and signature-based security software\nguessing.\n\nThe twists implemented into GootKit’s most recent build include changes to the file type and\nthe process into which the malware is injected. For example:\n\nThe malware loader is injected to SVCHOST.EXE.\n\n\n-----\n\nMalware is written in the form of a DLL file to:\n\nLUA Rights: %APPDATA%\\Microsoft\\Internet Explorer\\\n\nADMIN Rights: %WINDIR%\\System32\n\nMost modern-day banking malware — GootKit included — are executable files that get\ndeployed on the infected machines by a dropper. But recent changes to GootKit modified the\nessence of deployment. Instead of executing a .exe file, GootKit only loads a DLL into a\npoisoned process of its choice.\n\nThis is where the next change comes into effect. Instead of the common method — used by\nalmost all banking malware — of injecting its malicious code into the explorer.exe process,\nGootKit injects into a service host (svchost) process.\n\nWhile both processes are commonly run by the system at all times, and both are able to be\ninjected into, perhaps loading GootKit’s DLL through a process that runs multiple different\ninstances at the same time can be confusing to detect. Explorer.exe, in contrast, is a process\nthat only runs as one instance at a time.\n\n## Switching Up the Persistence Mechanism\n\nAnother refreshed function for this advanced malware is the persistence mechanism. All\nmalware aims to survive reboots and attempted deletion. In the past, GootKit used to persist\nby writing a user shell registry key that executed when the user logged in to the machine.\n[This has been switched up to resemble a method previously used by Dyre: setting up the](https://securityintelligence.com/dyre-summer-renovation-randomized-config-file-names-keep-antivirus-engines-guessing/)\nmalware as a scheduled task of the operating system.\n\nIn its new build, GootKit presents two persistence options.\n\nFirst, when deploying the malware with least-privilege user account (LUA) rights, GootKit\nuses a scheduled task written under a randomized name. The task is triggered to run every\nminute, acting as a watchdog. It also runs after every boot to ensure GootKit’s presence on\nthe endpoint after virus scans or system updates.\n\nIn cases where GootKit is deployed with Windows admin rights, it can write its payload as a\nWindows service. The biggest advantage to running an application as a service is that it will\nstart running before a user logs on and continue running even after the current user logs off.\nThus, in the case of malware like GootKit, the Trojan is more persistent overall.\n\n\n-----\n\nThe service s name here is randomized, allowing GootKit to appear vague enough to a user\nopening the running processes list and benign to any security software that may be running a\nscan.\n\nThe malicious file’s service properties window appears below:\n\n## Conclusion\n\nGootKit is a constantly evolving malware. Its developers have been upgrading its evasion\nand persistence mechanisms often and with sophistication to maintain this Trojan’s\ndeployment rates and stealth. The malware’s dropper is typically delivered into user\nendpoints via well-known exploit kits such as Neutrino and Angler, making it relatively\neffective in compromising users who may not have fully patched their operating systems.\n\nIn terms of its targets, GootKit configuration file analysis reveals that it mostly targets French\nand U.K. banks. Some of this malware’s configurations also target Italian and Spanish\nbanks, according to IBM X-Force Research. X-Force data indicated the malware was further\ndetected in infections on Japanese endpoints. However, those seemed opportunistic rather\nthan deliberate since Japanese banks did not appear in GootKit configurations and the gang\ncontinues to focus on Europe.\n\nOverall, GootKit is known to be deployed in limited regions. As a result, it only accounts for 4\npercent of the global attack volume by financial malware.\n\nX-Force Research expects to see GootKit continue to evolve. IBM Security can help banks\nand targeted organizations learn more about this high-risk threat.\n\nTo help stop threats such as GootKit, banks and service providers can use adaptive malware\ndetection solutions. They can also [protect customer endpoints with malware intelligence that](https://www.ibm.com/software/products/en/trusteer-rapport?ce=ISM0484&ct=SWG&cmp=IBMSocial&cm=h&cr=Security&ccy=US&ce=ISM0484&ct=SWG&cmp=IBMSocial&cm=h&cr=Security&ccy=US)\nprovides real-time insight into fraudster techniques and capabilities, designed to address the\nrelentless evolution of the threat landscape.\n\nUsers looking to prevent advanced malware infections on their endpoints must keep their\noperating system up to date at all times, update frequently used programs and delete those\nthey no longer use. The best browsing hygiene for the prevention of Trojan infection includes\ndisabling ads and avoiding susceptible sites typically used as infection hubs.\n\nSince GootKit and banking malware like it are usually delivered as email attachments, it is\ncritically important to never click on links or attachments in unsolicited email.\n\n\n-----\n\n## Relevant Sample MD5\n\nebe4babd813271e3c93906c4244d2140;\n\n15e43c836e25f91990ccad5779f21960;\n\nca18863391c96a6f1afec35a108f4257;\n\n59d0ae7370cdff2c672a09c4aeba39ca;\n\ne7689bf5b51c34a8b03242da4d50bf4c;\n\nf7125a3c9e780a460644bbbe181786d5; and\n\nbbab0810bfb2d1aa14d06d41fbd1f08e.\n\n[IBM X-Force Research will be updating information and indicators of compromise on GootKit](https://exchange.xforce.ibmcloud.com/collection/Gootkit-June-2016-422ab7991b937f35b89923f928b79702)\nvia the [X-Force Exchange platform. Join XFE today to keep up to date about this threat and](https://exchange.xforce.ibmcloud.com/#/)\nother findings from our cybercrime labs.\n\n[Limor Kessem](https://securityintelligence.com/author/limor-kessem/)\nExecutive Security Advisor, IBM\n\nLimor Kessem is an Executive Security Advisor at IBM Security. She is a widely sought-after\nsecurity expert, speaker and author and a strong advocate for wom...\n\n\n-----\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2016/2016-07-08 - GootKit- Bobbing and Weaving to Avoid Prying Eyes.pdf"
    ],
    "report_names": [
        "2016-07-08 - GootKit- Bobbing and Weaving to Avoid Prying Eyes.pdf"
    ],
    "threat_actors": [
        {
            "id": "2ed8d590-defa-4873-b2de-b75c9b30931e",
            "created_at": "2023-01-06T13:46:38.730137Z",
            "updated_at": "2025-03-27T02:00:02.903261Z",
            "deleted_at": null,
            "main_name": "MuddyWater",
            "aliases": [
                "Boggy Serpens",
                "Mango Sandstorm",
                "TEMP.Zagros",
                "Static Kitten",
                "G0069",
                "TA450",
                "Earth Vetala",
                "Seedworm",
                "COBALT ULSTER",
                "ATK51"
            ],
            "source_name": "MISPGALAXY:MuddyWater",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "02e1c2df-8abd-49b1-91d1-61bc733cf96b",
            "created_at": "2022-10-25T15:50:23.308924Z",
            "updated_at": "2025-03-27T02:00:55.437268Z",
            "deleted_at": null,
            "main_name": "MuddyWater",
            "aliases": [
                "MuddyWater",
                "Earth Vetala",
                "Static Kitten",
                "Seedworm",
                "TEMP.Zagros",
                "Mango Sandstorm",
                "TA450"
            ],
            "source_name": "MITRE:MuddyWater",
            "tools": [
                "STARWHALE",
                "POWERSTATS",
                "Out1",
                "PowerSploit",
                "Small Sieve",
                "Mori",
                "Mimikatz",
                "LaZagne",
                "PowGoop",
                "CrackMapExec",
                "ConnectWise",
                "SHARPSTATS",
                "RemoteUtilities",
                "Koadic"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "3c430d71-ab2b-4588-820a-42dd6cfc39fb",
            "created_at": "2022-10-25T16:07:23.880522Z",
            "updated_at": "2025-03-27T02:02:10.010443Z",
            "deleted_at": null,
            "main_name": "MuddyWater",
            "aliases": [
                "ATK 51",
                "Boggy Serpens",
                "Cobalt Ulster",
                "ITG17",
                "Mango Sandstorm",
                "MuddyWater",
                "Operation BlackWater",
                "Operation Earth Vetala",
                "Operation Quicksand",
                "Seedworm",
                "Static Kitten",
                "T-APT-14",
                "TA450",
                "TEMP.Zagros",
                "Yellow Nix"
            ],
            "source_name": "ETDA:MuddyWater",
            "tools": [
                "Agentemis",
                "BugSleep",
                "CLOUDSTATS",
                "ChromeCookiesView",
                "Cobalt Strike",
                "CobaltStrike",
                "CrackMapExec",
                "DELPHSTATS",
                "EmPyre",
                "EmpireProject",
                "FruityC2",
                "Koadic",
                "LOLBAS",
                "LOLBins",
                "LaZagne",
                "Living off the Land",
                "MZCookiesView",
                "Meterpreter",
                "Mimikatz",
                "MuddyC2Go",
                "MuddyRot",
                "Mudwater",
                "POWERSTATS",
                "PRB-Backdoor",
                "PhonyC2",
                "PowGoop",
                "PowerShell Empire",
                "PowerSploit",
                "Powermud",
                "QUADAGENT",
                "SHARPSTATS",
                "SSF",
                "Secure Socket Funneling",
                "Shootback",
                "Smbmap",
                "Valyria",
                "chrome-passwords",
                "cobeacon",
                "prb_backdoor"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "f9806b99-e392-46f1-9c13-885e376b239f",
            "created_at": "2023-01-06T13:46:39.431871Z",
            "updated_at": "2025-03-27T02:00:03.08926Z",
            "deleted_at": null,
            "main_name": "Watchdog",
            "aliases": [
                "Thief Libra"
            ],
            "source_name": "MISPGALAXY:Watchdog",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673535543,
    "ts_updated_at": 1743041819,
    "ts_creation_date": 1653709918,
    "ts_modification_date": 1653709918,
    "files": {
        "pdf": "https://archive.orkl.eu/32f7352205e861bef4d60aa8a40cf27b9f61068f.pdf",
        "text": "https://archive.orkl.eu/32f7352205e861bef4d60aa8a40cf27b9f61068f.txt",
        "img": "https://archive.orkl.eu/32f7352205e861bef4d60aa8a40cf27b9f61068f.jpg"
    }
}