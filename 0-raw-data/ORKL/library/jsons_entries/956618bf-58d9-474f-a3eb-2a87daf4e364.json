{
    "id": "956618bf-58d9-474f-a3eb-2a87daf4e364",
    "created_at": "2023-01-12T15:08:15.047178Z",
    "updated_at": "2025-03-27T02:09:18.257259Z",
    "deleted_at": null,
    "sha1_hash": "29232a18e802287688244eea2d63bc58ec2b34fc",
    "title": "2020-11-25 - Egregor RaaS Continues the Chaos with Cobalt Strike and Rclone",
    "authors": "",
    "file_creation_date": "2022-05-29T01:20:05Z",
    "file_modification_date": "2022-05-29T01:20:05Z",
    "file_size": 2037568,
    "plain_text": "# Egregor RaaS Continues the Chaos with Cobalt Strike and Rclone\n\n**[labs.sentinelone.com/egregor-raas-continues-the-chaos-with-cobalt-strike-and-rclone/](https://labs.sentinelone.com/egregor-raas-continues-the-chaos-with-cobalt-strike-and-rclone/)**\n\nJim Walter\n\n## Overview\n\nEgregor ransomware is an offshoot of the Sekhmet malware family that has been active\nsince mid-September 2020. The ransomware operates by compromising organizations,\nstealing sensitive user data, encrypting said data, and demanding a ransom to exchange\nencrypted documents. Egregor is ransomware associated with the cyberattacks against\nGEFCO and Barnes & Noble, Ubisoft, and numerous others.\n\n\n-----\n\nMultiple intelligence and security companies believe that there are ties between past, now\ndefunct, [Maze affiliates and Egregor. There have been reports of ties to](https://www.sentinelone.com/wp-content/uploads/enter-the-maze-demystifying-an-affiliate-involved-in-maze-snow/) [Sekhmet,](https://securityboulevard.com/2020/10/egregor-sekhmets-cousin/) [ProLock,](https://www.helpnetsecurity.com/2020/11/23/egregor-ransomware/)\n[and LockBit as well (both of which have also been tied to Maze). With regard to Sekhmet,](https://www.recordedfuture.com/)\nthere are deep similarities in the configuration format and obfuscation style. SentinelOneaffiliated security researcher Vitali Kremez noted these similarities in an early November\ntweet.\n\n\n-----\n\nAs with other modern ransomware groups, the actors behind Egregor exfiltrate victim data\nand theaten to expose it publically should the victim fail to comply with the ransom demands.\n\n## Egregor Distribution Methods\n\nThe primary distribution method for Egregor is Cobalt Strike. Targeted environments are\n[previously compromised through various means (RDP exploit,](https://www.sentinelone.com/wp-content/uploads/case-study-catching-a-human-operated-maze-ransomware-attack-in-action/) [Phishing) and once the Cobalt](https://www.sentinelone.com/blog/technical-analysis-paypal-phishing-scam/)\nStrike beacon payload is established and persistent, it is then utilized to deliver and launch\nthe Egregor payloads.\n\nThat being said, since Egregor is a RaaS with multiple affiliates, delivery and weaponization\ntactics can therefore vary. There have been limited and uncorroborated reports of Egregor\n[utilizing CVE-2020-0688 (a remote code execution flaw in Microsoft Exchange). Some](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-0688)\n[sources also report the possible exploitation of CVE-2018-8174 (VBScript Engine), CVE-](https://nvd.nist.gov/vuln/detail/CVE-2018-8174)\n[2018-4878 (Adobe Flash Player) & CVE-2018-15982 (Adobe Flash Player). They have also](https://nvd.nist.gov/vuln/detail/CVE-2018-15982)\n[been shown to use LOTL (Living off the Land) tools such as bitsadmin to download or](https://www.sentinelone.com/blog/how-do-attackers-use-lolbins-in-fileless-attacks/)\nupdate DLL components. In addition, some larger malware families and frameworks such as\n[QBot have been observed distributing Egregor in recent campaigns.](https://www.bleepingcomputer.com/news/security/qbot-partners-with-egregor-ransomware-in-bot-fueled-attacks/)\n\n## Egregor Payload Analysis\n\nEgregor payloads (DLLs) are highly obfuscated, including Salsa20 encrypted configuration\ndata. File encryption is achieved via a combination of the ChaCha stream cipher and RSA.\nEach payload contains a RSA-2048 public key.\n\nDLL-based payloads require a key/password upon launch, with that key being specific to\neach sample. The `-p parameter is passed to the payload concatenated with said key. For`\nexample, if the key is 123EVILBADGUYS the parameter `-p123EVILBADGUYS is required to`\nsuccessfully launch the payload.\n\nThis methodology also adds to the malware’s ability to evade analysis by way of humans and\ndynamic systems. Without the valid key passed, the payload will decrypt incorrectly and fail\nto launch or terminate. This is a critical point to consider in the context of static and dynamic\nanalysis of Egregor payloads. With no key, voluntary detonation and dynamic analysis\nbecome far more complex if not infeasible.\n\nAdditional parameters appear to be present in memory when the payloads are launched.\nSome of these are borderline self-explanatory, while others are still undergoing analysis. We\nhave summarized the parameter usage below where possible.\n\n\n-----\n\n```\n nomimikatz\n--fast\n--full ; encryption of entire system (local & network-accessible), no exclusions\n--multiproc\n--killrdp\n--nonet ; exclude encryption of network drives\n--path ; encrypt only specific path in this parameter\n--target\n--append ; customize the file extension to be used for encrypted files\n--norename ; skip the process of renaming encrypted files\n--greetings ; directly address target (by victim company name, typically)\n--samba\n\n```\nInitial analysis of Egregor payloads indicates that the ransomware will avoid encrypting\nsystems where the primary device language is one of the following:\n\nArmenian\nAzerbaijani\nBelarusian\nGeorgian\nKazakh\nKyrgyz\nRomanian\nRussian\nTajik\nTatar\nTurkmen\nUkrainian\nUzbek\n\n[The primary method of data exfiltration appears to be Rclone, which is an open source utility](https://rclone.org/)\nthat can be used to manage remote storage. Egregor payloads depost their own copy of\nRclone along with unique configuration data, controlling the exfiltration process.\n\n## Post-Compromise Behavior\n\n\n-----\n\nEgregor maintains a victim blog, which they use to threaten victims and post exfiltrated data\nin the event that victims fail to comply with their ransom demands. As of November 24th,\n2020 there were 152 companies listed on the Egregor blog, spanning numerous industries\nacross the globe. They do not appear to discriminate when it comes to industry or\ngeography. The most frequently represented industries are:\n\nInformation Technology and Services\nConstruction\nRetail\nConsumer Goods\nAutomotive\n\n\n-----\n\n-----\n\nThe Egregor ransom notes follow a familiar template as other ransomware families. Victims\nare instructed to visit their TOR-based payment portal for further instructions. There is also\nan encrypted blob at the bottom of each ransom note containing victim-specific system data,\nalong with the encoded RSA public key.\n\nExample:\n```\n---EGREGOR--pWEzuKkw9nY82VRKYfrw4f4wvrnfnKEApQ5JTkf/YQPzxJtJmwKUjXV759aYQnPIZdGN1RUckdpMZWiYGmsWFY\n---EGREGOR--\n```\nThis ‘blob’ includes data pertaining to the victim’s available local drives, the space and total\nsize of those drives, the hostname, the names of any AV or Security products discovered,\nand the user/domain context. The ‘blob’ is primarily base64-encoded. When decoded the\npertinent data is visible at the end of the plaintext.\n\n\n-----\n\n## Conclusion\n\nEgregor is one of the more aggressive and complex ransomware families to hit in the last 6\nto 8 months. As with other contemporary threats, the damage being done extends well\n[beyond the cost of the ransom (which you should avoid), and now also includes any](https://www.sentinelone.com/blog/ransomware-to-pay-or-not-to-pay-lets-discuss/)\n[penalties associated with data breaches, public posting of private data, GDPR / compliance](https://www.sentinelone.com/blog/another-business-risk-from-ransomware-beware-ofac-sanctions-before-paying-the-cyber-criminals/)\nfallout, and beyond.\n\nThe [SentinelOne Singularity Platform fully protects our customers from this ransomware and](https://www.sentinelone.com/platform/)\nrelated families.\n\n## Indicators of Compromise\n\n**SHA256 Hashes**\n\n8483aaf9e1fa5b46486c9f2a14c688c30d2006e88de65d0295a57892de0bf4c9\n\n3fd510a3b2e0b0802d57cd5b1cac1e61797d50a08b87d9b5243becd9e2f7073f\n\n2b3518937fd231560c7dc4f5af672a033b1c810d7f2f82c8151c025ce75775bf\n\n444a6897058fd4965770167b15a2ab13e6fd559a3e6f6cf5565d4d3282587459\n\nc3c50adcc0a5cd2b39677f17fb5f2efca52cc4e47ccd2cdbbf38815d426be9e1\n004a2dc3ec7b98fa7fe6ae9c23a8b051ec30bcfcd2bc387c440c07ff5180fe9a\n\n608b5bf065f25cd1c6ac145e3bcdf0b1b6dc742a08e59ec0ce136fe5142774e9\n\n3e5a6834cf6192a987ca9b0b4c8cb9202660e399ebe387af8c7407b12ae2da63\n\n4ea8b8c37cfb02ccdba95fe91c12fb68a2b7174fdcbee7ddaadded8ceb0fdf97\n\n9017c070ad6ac9ac52e361286b3ff24a315f721f488b53b7aaf6ac35de477f44\n\nee06c557f1acd5c4948b1df0413e49f3885f8ac96185a9d986b91a1231444541\n\n765327e1dc0888c69c92203d90037c5154db9787f54d3fc8f1097830be8c76ab\n\n14e547bebaa738b8605ba4182c4379317d121e268f846c0ed3da171375e65fe4\n\n3fc382ae51ceca3ad6ef5880cdd2d89ef508f368911d3cd41c71a54453004c55\n\nf0adfd3f89c9268953f93bfdfefb84432532a1e30542fee7bddda14dcb69a76c\n\na9d483c0f021b72a94324562068d8164f8cce0aa8f779faea304669390775436\n\n3aad14d200887119f316be71d71aec11735dd3698a4fcaa50902fce71bdccb07\n\n6ad7b3e0873c9ff122c32006fdc3675706a03c4778287085a020d839b74cd780\n\n932778732711cd18d5c4aabc507a65180bf1d4bd2b7d2d4e5506be4b8193596e\n\n\n-----\n\n**SHA1 Hashes**\n3c03a1c61932bec2b276600ea52bd2803285ec62\nf0215aac7be36a5fedeea51d34d8f8da2e98bf1b\n948ef8caef5c1254be551cab8a64c687ea0faf84\n50c3b800294f7ee4bde577d99f2118fc1c4ba3b9\n38c88de0ece0451b0665f3616c02c2bad77a92a2\n95aea6b24ed28c6ad13ec8d7a6f62652b039765e\n3cc616d959eb2fe59642102f0565c0e55ee67dbc\n5c99dc80ca69ce0f2d9b4f790ec1b57dba7153c9\nbeb48c2a7ff957d467d9199c954b89f8411d3ca8\n03cdec4a0a63a016d0767650cdaf1d4d24669795\nc9da06e3dbf406aec50bc145cba1a50b26db853a\nceca1a691c736632b3e98f2ed5b028d33c0f3c64\nf6ad7b0a1d93b7a70e286b87f423119daa4ea4df\n56eed20ea731d28d621723130518ac00bf50170d\nfa33fd577f5eb4813bc69dce891361871cda860c\nf7bf7cea89c6205d78fa42d735d81c1e5c183041\nf1603f1ddf52391b16ee9e73e68f5dd405ab06b0\n8768cf56e12a81d838e270dca9b82d30c35d026e\nac6d919b313bbb18624d26745121fca3e4ae0fd3\n\n**IP Addresses**\n45[.]153.242.129\n217[.]8.117.148\n45[.]153.242.129\n45[.]11.19.70\n49[.]12.104.241:81\n185[.]238.0.233\n\n**Full URL Examples**\nh t t p://185.238.0[.]233/p.dll\nh t t p://185.238.0[.]233/b.dll\nh t t p://185.238.0[.]233/sed.dll\nh t t p://185.238.0[.]233/hnt.dll\nh t t p://185.238.0[.]233/88/k057.exe\nh t t p://185.238.0[.]233/newsvc.zip\n\n**Victim Blog / Archive**\nh t t p://egregoranrmzapcv[.]onion\nh t t p s://egregornews[.]com/\n\n**Payment Portal**\nh t t p://egregor4u5ipdzhv[.]onion/\n\n\n-----\n\n**MITRE ATT&CK**\n[Indicator Removal on Host: File Deletion T1070.004](https://attack.mitre.org/techniques/T1107/)\nModify Registry [T1112](https://attack.mitre.org/techniques/T1112/)\n[Query Registry T1012](https://attack.mitre.org/techniques/T1012/)\n[System Information Discovery T1082](https://attack.mitre.org/techniques/T1082/)\nNative API [T1106](https://attack.mitre.org/techniques/T1106/)\n[Hijack Execution Flow: DLL Side-Loading T1574.002](https://attack.mitre.org/techniques/T1574/002/)\n[Process Injection T1055](https://attack.mitre.org/techniques/T1055/)\n[Masquerading T1036](https://attack.mitre.org/techniques/T1036/)\n[System Time Discovery T1124](https://attack.mitre.org/techniques/T1124/)\n[Archive Collected Data T1560](https://attack.mitre.org/techniques/T1560/)\n[Virtualization/Sandbox Evasion T1497](https://attack.mitre.org/techniques/T1497/)\n[Software Discovery: Security Software Discovery T1518.001](https://attack.mitre.org/techniques/T1518/001/)\n[Peripheral Device Discovery T1120](https://attack.mitre.org/techniques/T1120/)\n[Inhibit System Recovery T1490](https://attack.mitre.org/techniques/T1490/)\n[Create or Modify System Process: Windows Service T1031](https://attack.mitre.org/techniques/T1031/)\n[Exfiltration TA0010](https://attack.mitre.org/tactics/TA0010/)\n\n**Miscellaneous**\nRansom Note example (RECOVER-FILES.txt)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2020/2020-11-25 - Egregor RaaS Continues the Chaos with Cobalt Strike and Rclone.pdf"
    ],
    "report_names": [
        "2020-11-25 - Egregor RaaS Continues the Chaos with Cobalt Strike and Rclone.pdf"
    ],
    "threat_actors": [
        {
            "id": "610a7295-3139-4f34-8cec-b3da40add480",
            "created_at": "2023-01-06T13:46:38.608142Z",
            "updated_at": "2025-03-27T02:00:02.87217Z",
            "deleted_at": null,
            "main_name": "Cobalt",
            "aliases": [
                "Cobalt Gang",
                "GOLD KINGSWOOD",
                "COBALT SPIDER",
                "G0080",
                "Mule Libra",
                "Cobalt Group"
            ],
            "source_name": "MISPGALAXY:Cobalt",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673536095,
    "ts_updated_at": 1743041358,
    "ts_creation_date": 1653787205,
    "ts_modification_date": 1653787205,
    "files": {
        "pdf": "https://archive.orkl.eu/29232a18e802287688244eea2d63bc58ec2b34fc.pdf",
        "text": "https://archive.orkl.eu/29232a18e802287688244eea2d63bc58ec2b34fc.txt",
        "img": "https://archive.orkl.eu/29232a18e802287688244eea2d63bc58ec2b34fc.jpg"
    }
}