{
    "id": "c156f5b6-f603-4590-b482-8def7f91f2a9",
    "created_at": "2023-01-12T15:10:59.169366Z",
    "updated_at": "2025-03-27T02:13:50.028247Z",
    "deleted_at": null,
    "sha1_hash": "7a7b524586751b7059d7956754bc62a4bbf918f5",
    "title": "2020-05-04 - Changes in REvil ransomware version 2.2",
    "authors": "",
    "file_creation_date": "2022-05-28T22:04:22Z",
    "file_modification_date": "2022-05-28T22:04:22Z",
    "file_size": 419128,
    "plain_text": "# Changes in REvil ransomware version 2.2\n\n**[intel471.com/blog/changes-in-revil-ransomware-version-2-2](https://intel471.com/blog/changes-in-revil-ransomware-version-2-2)**\n\nMay 04, 2020\n\nBy the Intel 471 Malware Intelligence team.\n\n## Summary\n\nThe REvil ransomware-as-a-service (RaaS) operation continues to impact businesses\nworldwide. The threat actors responsible for developing and maintaining the malware have\nreleased an updated ransomware, namely version 2.2. In this short blog post, we will cover\nthe significant changes from the previous version, which we covered in detail in an earlier\nblog post (see: https://blog.intel471.com/2020/03/31/revil-ransomware-as-a-service-ananalysis-of-a-ransomware-affiliate-operation/).\n\n## Persistence mechanism\n\nREvil ransomware persists on a machine if the arn configuration field is set to true. It writes\nits path to the registry key SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run. An\nexample of the value name of the registry key entry is mjOObKp0yy.\n\n\n-----\n\nIn version 2.1, first collected by our systems March 15, 2020, this persistence mechanism\nwas removed. It seems this little experiment didn’t go as planned, because the new version\n2.2 brings the same persistence mechanism back!\n\n## Restart Manager to terminate processes\n\nOne of the more interesting new features of REvil version 2.2 is the use of the Windows\nRestart Manager to terminate processes and services that can lock files targeted for\nencryption. If a process has an open file handle for a specific file, then writes to that file by\nanother process (in this case, a ransomware) it will be prevented by the Windows operating\nsystem (OS). To circumvent this, the REvil developers have implemented a technique using\nthe Windows Restart Manager also used by other ransomware such as SamSam and\nLockerGoga (see: https://www.crowdstrike.com/blog/an-in-depth-analysis-of-samsamransomware-and-boss-spider/).\n\n\n-----\n\nREvil ransomware opens files for encryption with no sharing (dwShareMode equals 0). As a\nresult, the Restart Manager is invoked whenever a sharing violation occurs when opening an\nalready opened file.\n\nThe function prototype for rvl_restart_manager is:\n```\nVOID rvl_restart_manager(LPCWSTR Filename, BOOL DoEndSession)\n\n```\nThe following explains how REvil employs this technique:\n\nCall OpenSCManagerW to open the “ServicesActive” database.\nStart a new Restart Manager session by calling RmStartSession and save the\nreturned handle in a global variable for future calls.\nInvoke RmRegisterResources with the target file name to register it to the Restart\nManager session.\nRetrieve the list of all applications currently using the file by calling RmGetList. This\napplication programming interface (API) returns an array of RM_PROCESS_INFO\nstructures.\nIf a normal process is using the file, it is terminated by a call to TerminateProcess.\nIf a service is encountered, ControlService is invoked with the\n**SERVICE_CONTROL_STOP control code to stop the service followed by a call to**\n**DeleteService.**\nIf a critical process is encountered, its critical status is removed by calling\n**ZwSetInformationProcess with the information class ProcessBreakOnTermination**\nbefore terminating it. This may lead to undefined behavior on the victim system.\n\n**New ‘-silent’ flag**\n\nA new command-line option -silent was added that skips termination of blacklisted\nprocesses, services and shadow copy deletion. However, this flag does not impact the new\nRestart Manager functionality.\n\n\n-----\n\n## Indicators of compromise\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2020/2020-05-04 - Changes in REvil ransomware version 2.2.pdf"
    ],
    "report_names": [
        "2020-05-04 - Changes in REvil ransomware version 2.2.pdf"
    ],
    "threat_actors": [
        {
            "id": "eb8697fd-882a-4323-9eb8-8e20222cfd91",
            "created_at": "2022-10-25T16:07:23.416834Z",
            "updated_at": "2025-03-27T02:02:09.788953Z",
            "deleted_at": null,
            "main_name": "Boss Spider",
            "aliases": [
                "Boss Spider",
                "CTG-0007",
                "Gold Lowell"
            ],
            "source_name": "ETDA:Boss Spider",
            "tools": [
                "Mimikatz",
                "PsExec",
                "SDelete",
                "SamSam",
                "Samas"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "d90307b6-14a9-4d0b-9156-89e453d6eb13",
            "created_at": "2022-10-25T16:07:23.773944Z",
            "updated_at": "2025-03-27T02:02:09.974695Z",
            "deleted_at": null,
            "main_name": "Lead",
            "aliases": [
                "Casper",
                "TG-3279"
            ],
            "source_name": "ETDA:Lead",
            "tools": [
                "Agentemis",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "RbDoor",
                "RibDoor",
                "Winnti",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "4116df25-aff6-46ee-a5dd-926254a78e89",
            "created_at": "2023-01-06T13:46:38.894033Z",
            "updated_at": "2025-03-27T02:00:02.94496Z",
            "deleted_at": null,
            "main_name": "BOSS SPIDER",
            "aliases": [
                "GOLD LOWELL"
            ],
            "source_name": "MISPGALAXY:BOSS SPIDER",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "bfded1cf-be73-44f9-a391-0751c9996f9a",
            "created_at": "2022-10-25T15:50:23.337107Z",
            "updated_at": "2025-03-27T02:00:55.445946Z",
            "deleted_at": null,
            "main_name": "FIN7",
            "aliases": [
                "FIN7",
                "GOLD NIAGARA",
                "ITG14",
                "Carbon Spider",
                "ELBRUS",
                "Sangria Tempest"
            ],
            "source_name": "MITRE:FIN7",
            "tools": [
                "Mimikatz",
                "AdFind",
                "JSS Loader",
                "HALFBAKED",
                "REvil",
                "PowerSploit",
                "CrackMapExec",
                "Carbanak",
                "Pillowmint",
                "Cobalt Strike",
                "POWERSOURCE",
                "RDFSNIFFER",
                "SQLRat",
                "Lizar",
                "TEXTMATE",
                "BOOSTWRITE"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "1b20199b-07ae-42f1-ad22-bbe2dd471df8",
            "created_at": "2024-06-04T02:03:07.872554Z",
            "updated_at": "2025-03-27T02:05:17.383011Z",
            "deleted_at": null,
            "main_name": "GOLD LOWELL",
            "aliases": [
                "CTG-0007 ",
                "Boss Spider "
            ],
            "source_name": "Secureworks:GOLD LOWELL",
            "tools": [
                "Samas"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "bb8702c5-52ac-4359-8409-998a7cc3eeaf",
            "created_at": "2023-01-06T13:46:38.405479Z",
            "updated_at": "2025-03-27T02:00:02.82533Z",
            "deleted_at": null,
            "main_name": "FIN7",
            "aliases": [
                "JokerStash",
                "ATK32",
                "G0046",
                "Coreid",
                "Carbanak",
                "Sangria Tempest",
                "CARBON SPIDER",
                "GOLD NIAGARA",
                "G0008",
                "ELBRUS",
                "Carbon Spider"
            ],
            "source_name": "MISPGALAXY:FIN7",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "d85adfe3-e1c3-40b0-b8bb-d1bacadc4d82",
            "created_at": "2022-10-25T16:07:23.619566Z",
            "updated_at": "2025-03-27T02:02:09.890982Z",
            "deleted_at": null,
            "main_name": "FIN7",
            "aliases": [
                "APT-C-11",
                "ATK 32",
                "Gold Niagara",
                "ITG14",
                "TAG-CR1"
            ],
            "source_name": "ETDA:FIN7",
            "tools": [
                "7Logger",
                "Agentemis",
                "Anunak",
                "Astra",
                "BIOLOAD",
                "BIRDWATCH",
                "Bateleur",
                "Boostwrite",
                "CROWVIEW",
                "Carbanak",
                "Cobalt Strike",
                "CobaltStrike",
                "DICELOADER",
                "DNSMessenger",
                "FOWLGAZE",
                "HALFBAKED",
                "JSSLoader",
                "KillACK",
                "LOADOUT",
                "Lizar",
                "Meterpreter",
                "Mimikatz",
                "POWERPLANT",
                "POWERSOURCE",
                "RDFSNIFFER",
                "SQLRAT",
                "Sekur",
                "Sekur RAT",
                "TEXTMATE",
                "Tirion",
                "VB Flash",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673536259,
    "ts_updated_at": 1743041630,
    "ts_creation_date": 1653775462,
    "ts_modification_date": 1653775462,
    "files": {
        "pdf": "https://archive.orkl.eu/7a7b524586751b7059d7956754bc62a4bbf918f5.pdf",
        "text": "https://archive.orkl.eu/7a7b524586751b7059d7956754bc62a4bbf918f5.txt",
        "img": "https://archive.orkl.eu/7a7b524586751b7059d7956754bc62a4bbf918f5.jpg"
    }
}