{
    "id": "67c44b63-a6e3-4103-86bd-8527bf8d4865",
    "created_at": "2023-01-12T15:02:47.442288Z",
    "updated_at": "2025-03-27T02:16:20.728077Z",
    "deleted_at": null,
    "sha1_hash": "fc1aa901ac6e96ed8217c960f63827c05612a68c",
    "title": "2021-11-05 - The BigBoss Rules- Something about one of the Uroburos’ RPC-based backdoors",
    "authors": "",
    "file_creation_date": "2022-05-28T15:21:34Z",
    "file_modification_date": "2022-05-28T15:21:34Z",
    "file_size": 337363,
    "plain_text": "# The BigBoss Rules: Something about one of the Uroburos’ RPC-based backdoors\n\n**[emanueledelucia.net/the-bigboss-rules-something-about-one-of-the-uroburos-rpc-based-backdoors/](https://www.emanueledelucia.net/the-bigboss-rules-something-about-one-of-the-uroburos-rpc-based-backdoors/)**\n\nNovember 5, 2021\n\nBigBoss is one of the RPC-based backdoors used by Uroburos (aka Turla, Snake, Venomous Bear,\n_Pacifier). It was first spotted out in 2018 and was observed to include new features in the last quarter of_\n2020. During operations usually it’s used in combination with R.A.T. (Remote Administration Tools)\nsuch as Kazuar and Carbon. Several months ago I had the opportunity to analyze some versions of\nthese pieces of malware and have now decided to publish an excerpt based solely on some specific\ntechnical characteristics observed. The activity had as objective the production of detection and\nattribution rules one of which is shared in this post.\n\n**Insights**\n\nBigBoss implants exports basically (3) three functions. The Start() one is designed to retrieve basic\ninformation and to call sub_407E50 at 0040B0D3. First of all modulenamekernel32.dll is dexored\nthrough the key 0x4d4e and an handle to kernel32.dll is obtained through GetModuleHandle. Malware\nwriter chose to dynamically resolve certain API functions likely in order to hide information, from static\nanalysis, about libraries and functions that are used by the implant and normally stored in IAT. In this\ncase IsWow64Process is found through GetProcAddress to retrieve OS bitness.\n\n\n-----\n\nShortly after a call to sub_409C70 where the path of the .inf file is retrieved.\n\nBigBoss writes a configuration file named backport.inf. The configuration file is written to\n**_%SystemRoot%\\INF\\backport.inf (as reported in screenshot above) and contains a [Version] section_**\nwith various configuration entries. At this point instructions performed call\nthe StartServiceCtrlDispatcher function in order to connect to the SCM (Service Control Manager)\nand start the control dispatcher thread. The dispatcher thread loops, waiting for incoming control\nrequests for the services specified in the dispatch table.\n\nService name is SWCheckState. Further API functions is then dynamically resolved. One of them is\n**CreateService retrieved even in this case through a GetProcAddress call after to have obtained an**\nhandle to advapi32.dll at sub_408790. After the service is created OpenService function is called in\norder to interact with the service just created and\n**_ChangeServiceConfig2W & ChangeServiceConfigW are subsequently used to modified parameters_**\n\n\n-----\n\nof the same. Finally, StartService starts the service. In ServiceMain a\n**_RegisterServiceCtrlHandlerEx_** function is used to register a control handler with the control\ndispatcher. SetServiceStatus is called to set the status of the service and the CreateEvent function is\nthen responsible to create the event object.\n\nSMB Server is then enabled by creating the RegKey HKEY_LOCAL_MACHINE\n_“SYSTEM\\\\CurrentControlSet\\\\Services\\\\lanmanserver\\\\parameters on sub_40AB90. Named pipes are_\nused for interprocess communication (IPC) both locally and remotely. Access to the remote named\npipes is done via SMB. RegKey HKLM\\SYSTEM\\CurrentControlSet\\Control\\LSA\\Restrict Anonymous\nis then set to 0 in order to permit anonymous logon users can access all shared resources on a remote\nshare\n\n\n-----\n\nThe RegKey\n_HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\services\\LanmanServer\\Parameters\\NullSessionPipes_\nis also written in order to add the following values\n\n_COMNAP_\n\n_COMNODE_\n\n_SQLQUERY_\n\n_SPOOLSS_\n\n_LLSRPC_\n\n_browser_\n\n**sub_40AAE0 is responsible for connections to remote devices via IPC$. via WNetAddConnection2**\n\n\n-----\n\nBigBoss supports connections through null sessions or via default credentials. A thread is then created\nhaving sub_408830 as StartAddress. This thread is mainly responsible to handle communications\nwith CnC (Command and Control) server. CreateNamedPipeW and ConnectNamedPipe are used to\ntest connection. If successfull it’s able to get additional payloads and write operation results into log\nfiles created and written under %temp% path.\n\n**Conclusions**\n\nBigBoss is an integral part of the Turla team’s attack and persistence suite. Its development and\nevolution have probably shared practices and logic with other implants linked to its main cluster such\nas the second stage backdoor called Carbon. For example, by analyzing both, it can be noted that it\nshares with it not only a partial overlap in some internal functions, as shown below\n\n\n-----\n\nbut in some cases whole code chunks having a full overlap\n\nI based one of my hunting rules for this family on this piece of code. The rule is released in the\n“Detection” section\n\n**Indicators**\n\n\n-----\n\n**Type** **Value**\n\nSHA256 3b8bd0a0c6069f2d27d759340721b78fd289f92e0a13965262fea4e8907af122\n\nSHA256 a679dbde0f4411396af54ea6ac887bd0488b2339cd8a4b509a01ca5e906f70bd\n\n**Detection**\n\nrule Turla_Code_00325_00291 {\nmeta:\nauthor = “Emanuele De Lucia”\ndescription = “Yara hunting rule for Turla shared code chunk”\nhash1 = “3b8bd0a0c6069f2d27d759340721b78fd289f92e0a13965262fea4e8907af122”\nhash2 = “a679dbde0f4411396af54ea6ac887bd0488b2339cd8a4b509a01ca5e906f70bd”\nhash3 = “c819ec7743e2f5db13f277749961dffad08dba6dd21450eea33a27403386c959”\nhash4 = “7bb65fe9421af04c5546b04a93aa0e517356c0a85856f1265587983ce2bf8aef”\nhash5 = “94421ccb97b784c43d92c4b1438481eee9c907db6b13f6cfc4b86a6bb057ddcd”\nstrings:\n$hex = { 8B (4C 24 ??|55 ??) (51|52) 8D (54 24 ??|45 ??) (52|50) 56 E8 ?? ?? ?? ?? 83 C4 ?? 8D (44\n24 ??|4D ??) (50|51) 6A ?? 8D (4C 24 ??|55 ??) (51|52) 6A ?? 8D (54 24 ??|45 ??) (52|50) 8B (54 24\n??|45 ??) 6A ?? 8D (44 24 ?? | 4D ??) (50|51) 6A ?? 8D (4C 24 ??|55 ??) (51|52) 56 (52|50) FF 15 ??\n?? ?? ?? 85 C0 (0F 85 ?? ?? ?? ??|75 ??)}\ncondition:\n$hex\n}\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-11-05 - The BigBoss Rules- Something about one of the Uroburos’ RPC-based backdoors.pdf"
    ],
    "report_names": [
        "2021-11-05 - The BigBoss Rules- Something about one of the Uroburos’ RPC-based backdoors.pdf"
    ],
    "threat_actors": [
        {
            "id": "a97cf06d-c2e2-4771-99a2-c9dee0d6a0ac",
            "created_at": "2022-10-25T16:07:24.349252Z",
            "updated_at": "2025-03-27T02:02:10.184406Z",
            "deleted_at": null,
            "main_name": "Turla",
            "aliases": [
                "ATK 13",
                "Belugasturgeon",
                "Blue Python",
                "CTG-8875",
                "Group 88",
                "ITG12",
                "Iron Hunter",
                "Krypton",
                "Makersmark",
                "Operation Epic Turla",
                "Operation Moonlight Maze",
                "Operation Penguin Turla",
                "Operation Satellite Turla",
                "Operation Skipper Turla",
                "Operation Turla Mosquito",
                "Operation WITCHCOVEN",
                "Pacifier APT",
                "Pensive Ursa",
                "Popeye",
                "SIG15",
                "SIG2",
                "SIG23",
                "Secret Blizzard",
                "TAG-0530",
                "Turla",
                "UNC4210",
                "Venomous Bear",
                "Waterbug"
            ],
            "source_name": "ETDA:Turla",
            "tools": [
                "ASPXSpy",
                "ASPXTool",
                "ATI-Agent",
                "AdobeARM",
                "Agent.BTZ",
                "Agent.DNE",
                "BigBoss",
                "COMpfun",
                "Chinch",
                "Cloud Duke",
                "CloudDuke",
                "CloudLook",
                "Cobra Carbon System",
                "ComRAT",
                "DoublePulsar",
                "EmPyre",
                "EmpireProject",
                "Epic Turla",
                "EternalBlue",
                "EternalRomance",
                "GoldenSky",
                "Group Policy Results Tool",
                "HTML5 Encoding",
                "HyperStack",
                "IcedCoffee",
                "IronNetInjector",
                "KSL0T",
                "Kapushka",
                "Kazuar",
                "KopiLuwak",
                "Kotel",
                "LOLBAS",
                "LOLBins",
                "LightNeuron",
                "Living off the Land",
                "Maintools.js",
                "Metasploit",
                "Meterpreter",
                "MiamiBeach",
                "Mimikatz",
                "MiniDionis",
                "Minit",
                "NBTscan",
                "NETTRANS",
                "NETVulture",
                "Neptun",
                "NetFlash",
                "NewPass",
                "Outlook Backdoor",
                "Penquin Turla",
                "Pfinet",
                "PowerShell Empire",
                "PowerShellRunner",
                "PowerShellRunner-based RPC backdoor",
                "PowerStallion",
                "PsExec",
                "PyFlash",
                "QUIETCANARY",
                "Reductor RAT",
                "RocketMan",
                "SMBTouch",
                "SScan",
                "Satellite Turla",
                "SilentMoon",
                "Sun rootkit",
                "TTNG",
                "TadjMakhal",
                "Tavdig",
                "TinyTurla",
                "TinyTurla Next Generation",
                "TinyTurla-NG",
                "Topinambour",
                "Tunnus",
                "Turla",
                "Turla SilentMoon",
                "TurlaChopper",
                "Uroburos",
                "Urouros",
                "WCE",
                "WITCHCOVEN",
                "WhiteAtlas",
                "WhiteBear",
                "Windows Credential Editor",
                "Windows Credentials Editor",
                "Wipbot",
                "WorldCupSec",
                "XTRANS",
                "certutil",
                "certutil.exe",
                "gpresult",
                "nbtscan",
                "nbtstat",
                "pwdump"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "8aaa5515-92dd-448d-bb20-3a253f4f8854",
            "created_at": "2024-06-19T02:03:08.147099Z",
            "updated_at": "2025-03-27T02:05:17.408118Z",
            "deleted_at": null,
            "main_name": "IRON HUNTER",
            "aliases": [
                "Belugasturgeon ",
                "Blue Python ",
                "CTG-8875 ",
                "ITG12 ",
                "KRYPTON ",
                "MAKERSMARK ",
                "Pensive Ursa ",
                "Secret Blizzard ",
                "Turla",
                "UAC-0003 ",
                "UAC-0024 ",
                "UNC4210 ",
                "Venomous Bear ",
                "Waterbug ",
                "ATK13 "
            ],
            "source_name": "Secureworks:IRON HUNTER",
            "tools": [
                " ComRAT",
                " Kazuar",
                " KopiLuwak",
                " LightNeuron",
                " Mosquito",
                " Nautilus",
                " Neuron",
                " Penquin",
                " PoisonFrog",
                " PyFlash",
                " Skipper",
                " Snake",
                " Tavdig",
                " TinyTurla",
                " Tunnus",
                "Carbon-DLL"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "a97fee0d-af4b-4661-ae17-858925438fc4",
            "created_at": "2023-01-06T13:46:38.396415Z",
            "updated_at": "2025-03-27T02:00:02.823045Z",
            "deleted_at": null,
            "main_name": "Turla",
            "aliases": [
                "Uroburos",
                "Hippo Team",
                "Pacifier APT",
                "MAKERSMARK",
                "ATK13",
                "UAC-0003",
                "IRON HUNTER",
                "Waterbug",
                "TAG_0530",
                "KRYPTON",
                "Popeye",
                "SIG23",
                "UAC-0144",
                "G0010",
                "Blue Python",
                "VENOMOUS Bear",
                "Group 88",
                "Pfinet",
                "ITG12",
                "UNC4210",
                "Secret Blizzard",
                "UAC-0024"
            ],
            "source_name": "MISPGALAXY:Turla",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "d11c89bb-1640-45fa-8322-6f4e4053d7f3",
            "created_at": "2022-10-25T15:50:23.509601Z",
            "updated_at": "2025-03-27T02:00:55.487991Z",
            "deleted_at": null,
            "main_name": "Turla",
            "aliases": [
                "Turla",
                "IRON HUNTER",
                "Group 88",
                "Waterbug",
                "WhiteBear",
                "Krypton",
                "Venomous Bear",
                "Secret Blizzard",
                "BELUGASTURGEON"
            ],
            "source_name": "MITRE:Turla",
            "tools": [
                "PsExec",
                "nbtstat",
                "ComRAT",
                "netstat",
                "certutil",
                "KOPILUWAK",
                "IronNetInjector",
                "LunarWeb",
                "Arp",
                "Uroburos",
                "PowerStallion",
                "Kazuar",
                "Systeminfo",
                "LightNeuron",
                "Mimikatz",
                "Tasklist",
                "LunarMail",
                "HyperStack",
                "NBTscan",
                "TinyTurla",
                "Penquin",
                "LunarLoader"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1673535767,
    "ts_updated_at": 1743041780,
    "ts_creation_date": 1653751294,
    "ts_modification_date": 1653751294,
    "files": {
        "pdf": "https://archive.orkl.eu/fc1aa901ac6e96ed8217c960f63827c05612a68c.pdf",
        "text": "https://archive.orkl.eu/fc1aa901ac6e96ed8217c960f63827c05612a68c.txt",
        "img": "https://archive.orkl.eu/fc1aa901ac6e96ed8217c960f63827c05612a68c.jpg"
    }
}