{
    "id": "e7b1f1e5-a00d-4f52-b920-b9aca998b600",
    "created_at": "2023-01-12T15:07:20.043229Z",
    "updated_at": "2025-03-27T02:05:43.165652Z",
    "deleted_at": null,
    "sha1_hash": "0d864173b2ea553e0fcb357410b1076e89818768",
    "title": "2021-06-10 - Detecting Password Spraying Attacks- Threat Research Release May 2021",
    "authors": "",
    "file_creation_date": "2022-05-28T23:12:12Z",
    "file_modification_date": "2022-05-28T23:12:12Z",
    "file_size": 241530,
    "plain_text": "# Detecting Password Spraying Attacks: Threat Research Release May 2021\n\n**[splunk.com/en_us/blog/security/detecting-password-spraying-attacks-threat-research-release-may-2021.html](https://www.splunk.com/en_us/blog/security/detecting-password-spraying-attacks-threat-research-release-may-2021.html)**\n\nJune 10, 2021\n\nSECURITY\n\nBy [Splunk Threat Research Team June 10,](https://www.splunk.com/en_us/blog/author/secmrkt-research.html)\n\n2021\n\n\n-----\n\n[The Splunk Threat Research team recently developed a new analytic story to help security](https://docs.splunk.com/Documentation/ESSOC/3.22.0/stories/UseCase#Active_directory_password_spraying)\noperations center (SOC) analysts detect adversaries executing password spraying attacks\nagainst Active Directory environments. In this blog, we’ll walk you through this analytic story,\n[demonstrate how we can simulate these attacks using PurpleSharp, collect and analyze the](https://github.com/mvelazc0/PurpleSharp)\nWindows event logs, and highlight a few detections from the May 2021 releases.\n\nWatch the video below to learn more about how we can simulate and detect password\n[spraying attacks using PurpleSharp in a lab environment built with the Splunk Attack](https://github.com/mvelazc0/PurpleSharp)\nRange.\n\n[Password spraying (T1110.003) is a technique by which adversaries leverage a single](https://attack.mitre.org/techniques/T1110/003/)\npassword or a small list of commonly used passwords against a large group of usernames\nto acquire valid account credentials. Unlike a brute force attack that targets a specific user\nor small group of users with a large number of passwords, password spraying follows the\nopposite approach and increases the chances of obtaining valid credentials while avoiding\naccount lockouts. This allows adversaries to remain undetected if the target organization\ndoes not have the proper monitoring and detection controls in place. Penetration testers,\ncybercriminals as well as nation-state actors have been known to leverage this effective\ntechnique.\n\nPassword spraying can be leveraged by adversaries across different stages in a breach. It\ncan be used to obtain initial access to an environment but can also be used to escalate\nprivileges when access has been already achieved. In many scenarios, this technique\nironically capitalizes on a common security control deployed by organizations: password\nrotation. As enterprise users change their passwords when they expire, some of them may\npick predictable, seasonal passwords such as “Summer2021”.\n\n\n-----\n\nSpecifically, this Analytic Story is focused on detecting potential password spraying attacks\nagainst Active Directory environments in two scenarios where an attacker has obtained\naccess to the target network:\n\nAn adversary has obtained physical access to the network with a rogue device and\ncan perform spraying attacks against internal hosts.\nAn adversary is controlling a domain endpoint previously compromised and is\nleveraging it to perform spraying attacks.\n\nIn properly monitored Active Directory environments, there are several detection\nopportunities to identify password spraying attacks. This analytic story presents eight\ndifferent detection analytics that leverage Windows event logs which can aid defenders in\nidentifying instances where a single user, source host, or source process attempts to\nauthenticate against a target or targets using a high and unusual number of unique users. A\nuser, host, or process attempting to authenticate with multiple users is not common\nbehavior for legitimate systems, and should be monitored by security teams. Possible false\npositive scenarios include but are not limited to vulnerability scanners, remote\nadministration tools, multi-user systems and misconfigured systems.\n\n\n**Name** **Technique**\n**ID**\n\n\n**Tactic** **Description**\n\n\nMultiple users\nfailing to\nauthenticate\nfrom host\nusing\nkerberos\n\nMultiple users\nfailing to\n[authenticate](https://github.com/splunk/security_content/blob/develop/detections/endpoint/multiple_users_failing_to_authenticate_from_host_using_ntlm.yml)\nfrom host\nusing NTLM\n\nMultiple\ndisabled users\nfailing to\n[authenticate](https://github.com/splunk/security_content/blob/develop/detections/endpoint/multiple_disabled_users_failing_to_authenticate_from_host_using_kerberos.yml)\nfrom host\nusing\nKerberos\n\n\nT1110.003 Credential\nAccess\n\nT1110.003 Credential\nAccess\n\nT1110.003 Credential\nAccess\n\n\nIdentifies one source endpoint failing to\nauthenticate with multiple valid users using the\nKerberos protocol. This detection will only\ntrigger on domain controllers, not on member\nservers or workstations.\n\nIdentifies one source endpoint failing to\nauthenticate with multiple valid users using the\nNTLM protocol. This detection will only trigger\non domain controllers, not on member servers\nor workstations.\n\nIdentifies one source endpoint failing to\nauthenticate with multiple disabled domain\nusers using the Kerberos protocol. This\ndetection will only trigger on domain\ncontrollers, not on member servers or\nworkstations.\n\n\n-----\n\nMultiple\ninvalid users\nfailing to\n[authenticate](https://github.com/splunk/security_content/blob/develop/detections/endpoint/multiple_invalid_users_failing_to_authenticate_from_host_using_kerberos.yml)\nFrom host\nusing\nKerberos\n\nMultiple\ninvalid users\nfailing to\nauthenticate\nfrom host\nusing NTLM\n\nMultiple users\nattempting to\n[authenticate](https://github.com/splunk/security_content/blob/develop/detections/endpoint/multiple_users_attempting_to_authenticate_using_explicit_credentials.yml)\nusing explicit\ncredentials\n\nMultiple users\nfailing to\nauthenticate\nfrom process\n\nMultiple users\nremotely\n[failing to](https://github.com/splunk/security_content/blob/develop/detections/endpoint/multiple_users_remotely_failing_to_authenticate_from_host.yml)\nauthenticate\nfrom host\n\n\nT1110.003 Credential\nAccess\n\nT1110.003 Credential\nAccess\n\nT1110.003 Credential\nAccess\n\nT1110.003 Credential\nAccess\n\nT1110.003 Credential\nAccess\n\n\nIdentifies one source endpoint failing to\nauthenticate with multiple invalid domain users\nusing the Kerberos protocol. This detection\nwill only trigger on domain controllers, not on\nmember servers or workstations.\n\nIdentifies one source endpoint failing to\nauthenticate with multiple invalid users using\nthe NTLM protocol. This detection will only\ntrigger on domain controllers, not on member\nservers or workstations.\n\nIdentifies a source user failing to authenticate\nwith multiple users using explicit credentials\non a host. This detection will trigger on the\npotentially malicious host, perhaps controlled\nvia a trojan or operated by an insider threat,\nfrom where a password spraying attack is\nbeing executed.\n\nIdentifies a source process name failing to\nauthenticate with multiple users. This\ndetection will trigger on the potentially\nmalicious host, perhaps controlled via a trojan\nor operated by an insider threat, from where a\npassword spraying attack is being executed.\n\nIdentifies a source host failing to authenticate\nagainst a remote host with multiple users. This\ndetection will trigger on the host that is the\ntarget of the password spraying attack. This\ncould be a domain controller as well as a\nmember server or workstation.\n\n\n## Why Should You Care?\n\n[Password spraying is leveraged by all sorts of offensive actors including penetration testing](https://twitter.com/strandjs/status/1363942354374127620)\n[consultants,](https://www.ired.team/offensive-security-experiments/active-directory-kerberos-abuse/active-directory-password-spraying) [cyber crime](https://us-cert.cisa.gov/ncas/alerts/TA18-086A) [actors as well as cyber](https://www.cyber.gov.au/acsc/view-all-content/advisories/2019-130-password-spray-attacks-detection-and-mitigation-strategies) [espionage](https://us-cert.cisa.gov/ncas/alerts/TA18-086A) [actors. It’s an effective](https://us-cert.cisa.gov/ncas/alerts/AA20126A)\ntechnique available to adversaries to obtain valid account credentials. Unlike other\n\n\n-----\n\npassword-based attacks like brute forcing, spraying accounts allows adversaries to remain\nundetected by avoiding account lockouts.\n\n[According to the Verizon’s 2020 Data Breach Investigations Report, more than 80 percent](https://enterprise.verizon.com/resources/reports/2020-data-breach-investigations-report.pdf)\nof breaches within the “Hacking” category “involve brute force or the use of lost or stolen\ncredentials.”\n\nCyber defenders need to design and deploy effective monitoring capabilities that allow them\nto detect and respond to password spraying attacks against Active Directory as well as\nother authentication services.\n\n## Learn More\n\n[You can find the latest content about security analytic stories on GitHub and in Splunkbase.](https://github.com/splunk/security-content/releases/tag/v3.12.0)\n[Splunk Security Essentials also has all these detections now available via push update. In](https://splunkbase.splunk.com/app/3435/)\nthe upcoming weeks, the Splunk Threat Research team will be releasing a more detailed\nblog post on this analytic story. Stay tuned!\n\nFor a full list of security content, check out the [release notes on](https://docs.splunk.com/Documentation/ESSOC/3.21.0/RN/Enhancements) [Splunk Docs.](https://docs.splunk.com/Documentation/ESSOC)\n\n## Feedback\n\nAny feedback or requests? Feel free to put in an issue on Github and we’ll follow up.\nAlternatively, join us on the [Slack channel #security-research. Follow these instructions If](https://splunk-usergroups.slack.com/)\nyou need an invitation to our Splunk user groups on Slack.\n\n## Contributors\n\n[We would like to thank Mauricio Velazco for his contributions to this post and open source](https://twitter.com/mvelazco)\nsecurity tools.\n\n\n-----\n\nPosted by\n\n**[Splunk Threat Research Team](https://www.splunk.com/en_us/blog/author/secmrkt-research.html)**\n\nThe Splunk Threat Research Team is an active part of a customer’s overall defense\nstrategy by enhancing Splunk security offerings with verified research and security content\nsuch as use cases, detection searches, and playbooks. We help security teams around the\nglobe strengthen operations by providing tactical guidance and insights to detect,\ninvestigate and respond against the latest threats. The Splunk Threat Research Team\nfocuses on understanding how threats, actors, and vulnerabilities work, and the team\n[replicates attacks which are stored as datasets in the Attack Data repository.](https://github.com/splunk/attack_data/)\n\nOur goal is to provide security teams with research they can leverage in their day to day\noperations and to become the industry standard for SIEM detections. We are a team of\nindustry-recognized experts who are encouraged to improve the security industry by\nsharing our work with the community via conference talks, open-sourcing projects, and\nwriting white papers or blogs. You will also find us presenting our research at conferences\nsuch as Defcon, Blackhat, RSA, and many more.\n\n[Read more Splunk Security Content.](https://github.com/splunk/security_content)\n\n**Join the Discussion**\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-06-10 - Detecting Password Spraying Attacks- Threat Research Release May 2021.pdf"
    ],
    "report_names": [
        "2021-06-10 - Detecting Password Spraying Attacks- Threat Research Release May 2021.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673536040,
    "ts_updated_at": 1743041143,
    "ts_creation_date": 1653779532,
    "ts_modification_date": 1653779532,
    "files": {
        "pdf": "https://archive.orkl.eu/0d864173b2ea553e0fcb357410b1076e89818768.pdf",
        "text": "https://archive.orkl.eu/0d864173b2ea553e0fcb357410b1076e89818768.txt",
        "img": "https://archive.orkl.eu/0d864173b2ea553e0fcb357410b1076e89818768.jpg"
    }
}