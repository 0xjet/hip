{
    "id": "839fc7b2-9af2-4c0c-bf22-d20724209825",
    "created_at": "2023-01-12T15:08:54.56999Z",
    "updated_at": "2025-03-27T02:06:01.216188Z",
    "deleted_at": null,
    "sha1_hash": "d2825f9a643ff861c6f2cc02ef0eddc2442a5f23",
    "title": "2018-05-23 - VPNFilter- New Router Malware with Destructive Capabilities",
    "authors": "",
    "file_creation_date": "2022-05-28T21:56:48Z",
    "file_modification_date": "2022-05-28T21:56:48Z",
    "file_size": 341539,
    "plain_text": "# VPNFilter: New Router Malware with Destructive Capabilities\n\n**[symantec.com/blogs/threat-intelligence/vpnfilter-iot-malware](https://www.symantec.com/blogs/threat-intelligence/vpnfilter-iot-malware)**\n\nSymantec Security ResponseSecurity Response Team\n\n**UPDATE: September 26, 2018:**\n\n_This blog has been updated to include new information that was released by Cisco Talos on_\n_seven new Stage 3 modules. For further details see below._\n\n**UPDATE: June 6, 2018:**\n\n_This blog has been updated to include new information that was released by Cisco Talos._\n_This includes an expanded list of vulnerable devices and details on a newly discovered stage_\n_3 module known as “ssler” which could permit the attackers to perform man-in-the-middle_\n_(MitM) attacks on traffic going through vulnerable routers and allow them to intercept web_\n_traffic and insert malicious code into it. For further details see below._\n\n\n-----\n\nA new threat which targets a range of routers and network-attached storage (NAS) devices is\ncapable of knocking out infected devices by rendering them unusable. The malware, known\nas VPNFilter, is unlike most other IoT threats because it is capable of maintaining a\npersistent presence on an infected device, even after a reboot. VPNFilter has a range of\ncapabilities including spying on traffic being routed through the device. Its creators appear to\nhave a particular interest in SCADA industrial control systems, creating a module which\nspecifically intercepts Modbus SCADA communications.\n\nAccording to new research from Cisco Talos, activity surrounding the malware has stepped\nup in recent weeks and the attackers appear to be particularly interested in targets in\nUkraine. While VPNFilter has spread widely, data from Symantec's honeypots and sensors\nindicate that unlike other IoT threats such as Mirai, it does not appear to be scanning and\nindiscriminately attempting to infect every vulnerable device globally.\n\n**Q: What devices are known to be affected by VPNFilter?**\n\nA: To date, VPNFilter is known to be capable of infecting enterprise and small office/home\noffice routers from Asus, D-Link, Huawei, Linksys, MikroTik, Netgear, TP-Link, Ubiquiti,\nUpvel, and ZTE, as well as QNAP network-attached storage (NAS) devices. These include:\n\nAsus RT-AC66U\nAsus RT-N10\nAsus RT-N10E\nAsus RT-N10U\nAsus RT-N56U\nAsus RT-N66U\n\nD-Link DES-1210-08P\nD-Link DIR-300\nD-Link DIR-300A\nD-Link DSR-250N\nD-Link DSR-500N\nD-Link DSR-1000\nD-Link DSR-1000N\n\nHuawei HG8245\n\nLinksys E1200\nLinksys E2500\nLinksys E3000\nLinksys E3200\nLinksys E4200\nLinksys RV082\n\n\n-----\n\nLinksys WRVS4400N\n\nMikroTik CCR1009\nMikroTik CCR1016\nMikroTik CCR1036\nMikroTik CCR1072\nMikroTik CRS109\nMikroTik CRS112\nMikroTik CRS125\nMikroTik RB411\nMikroTik RB450\nMikroTik RB750\nMikroTik RB911\nMikroTik RB921\nMikroTik RB941\nMikroTik RB951\nMikroTik RB952\nMikroTik RB960\nMikroTik RB962\nMikroTik RB1100\nMikroTik RB1200\nMikroTik RB2011\nMikroTik RB3011\nMikroTik RB Groove\nMikroTik RB Omnitik\nMikroTik STX5\n\nNetgear DG834\nNetgear DGN1000\nNetgear DGN2200\nNetgear DGN3500\nNetgear FVS318N\nNetgear MBRN3000\nNetgear R6400\nNetgear R7000\nNetgear R8000\nNetgear WNR1000\nNetgear WNR2000\nNetgear WNR2200\nNetgear WNR4000\nNetgear WNDR3700\nNetgear WNDR4000\nNetgear WNDR4300\n\n\n-----\n\nNetgear WNDR4300-TN\nNetgear UTM50\n\nQNAP TS251\nQNAP TS439 Pro\nOther QNAP NAS devices running QTS software\n\nTP-Link R600VPN\nTP-Link TL-WR741ND\nTP-Link TL-WR841N\n\nUbiquiti NSM2\nUbiquiti PBE M5\n\nUpvel Devices -unknown models\n\nZTE Devices ZXHN H108N\n\n**Q: How does VPNFilter infect affected devices?**\n\nA: Most of the devices targeted are known to use default credentials and/or have known\nexploits, particularly for older versions. There is no indication at present that the exploit of\nzero-day vulnerabilities is involved in spreading the threat.\n\n**Q: What does VPNFilter do to an infected device?**\n\nA: VPNFilter is a multi-staged piece of malware. Stage 1 is installed first and is used to\nmaintain a persistent presence on the infected device and will contact a command and\ncontrol (C&C) server to download further modules.\n\nStage 2 contains the main payload and is capable of file collection, command execution,\ndata exfiltration, and device management. It also has a destructive capability and can\neffectively “brick” the device if it receives a command from the attackers. It does this by\noverwriting a section of the device’s firmware and rebooting, rendering it unusable.\n\nThere are several known Stage 3 modules, which act as plugins for Stage 2. These include a\npacket sniffer for spying on traffic that is routed through the device, including theft of website\ncredentials and monitoring of Modbus SCADA protocols. Another Stage 3 module allows\nStage 2 to communicate using Tor.\n\nA newly discovered (disclosed on June 6) Stage 3 module known as “ssler” is capable of\nintercepting all traffic going through the device via port 80, meaning the attackers can snoop\non web traffic and also tamper with it to perform man-in-the-middle (MitM) attacks. Among its\nfeatures is the capability to change HTTPS requests to ordinary HTTP requests, meaning\ndata that is meant to be encrypted is sent insecurely. This can be used to harvest credentials\n\n\n-----\n\nand other sensitive information from the victim s network. The discovery of this module is\nsignificant since it provides the attackers with a means of moving beyond the router and on\nto the victim’s network.\n\nA fourth Stage 3 module known as “dstr” (disclosed on June 6) adds a kill command to any\nStage 2 module which lacks this feature. If executed, dstr will remove all traces of VPNFilter\nbefore bricking the device.\n\nDetails on seven more Stage 3 modules were released on September 26, 2018. These\ninclude:\n\n**“htpx”: Similar to ssler, it redirects and inspects all HTTP traffic transmitted through**\nthe infected device to identify and log any Windows executables. This may be used to\nTrojanize executables as they pass through infected routers, providing attackers with a\nway of installing malware on computers connected to the same network.\n**“ndbr”: A multi-function SSH tool.**\n**“nm”: A network mapping tool which can be used to scan and map the local subnet.**\n**“netfilter”: A denial of service utility which may be used to block access to some**\nencrypted applications.\n**“portforwarding”: Module which forwards network traffic to attacker-specified**\ninfrastructure.\n**“socks5proxy”: Module to enable establishment of a SOCKS5 proxy on compromised**\ndevices.\n\n**“tcpvpn”: Allows establishment of a Reverse-TCP VPN on compromised devices, enabling**\nremote attacker to access internal networks behind infected devices.\n\n**Q: What should I do if I’m concerned my router is infected?**\nConcerned users are advised to use Symantec's free online tool to help check if their router\nis impacted by VPNFilter. This also includes instructions on what to do if the router is\ninfected.\n\n**Q: What do the attackers intend to do with VPNFilter’s destructive capability?**\n\nA: This is currently unknown. One possibility is using it for disruptive purposes, by bricking a\nlarge number of infected devices. Another possibility is more selective use to cover up\nevidence of attacks.\n\n**Q: Do Symantec/Norton products (Win/Mac/NMS) protect against this threat?**\n\n[A: Symantec and Norton products detect the threat as Linux.VPNFilter.](https://www.symantec.com/security-center/writeup/2018-053113-3755-99)\n\n**_Acknowledgement: Symantec wishes to thank Cisco Talos and the Cyber Threat Alliance_**\nfor sharing information on this threat in advance of publication.\n\n\n-----\n\n**UPDATE: Netgear is advising customers that, in addition to applying the latest firmware**\nupdates and changing default passwords, users should ensure that remote management is\nturned off on their router. Remote management is turned off by default and can only be\nturned on using the router's advanced settings. To turn it off, they should go to\nwww.routerlogin.net in their browser and log in using their admin credentials. From there,\nthey should click \"Advanced\" followed by \"Remote Management\". If the check box for \"Turn\nRemote Management On\" is selected, clear it and click \"Apply\" to save changes.\n\n**UPDATE May 24, 2018: The** [FBI has announced that it has taken immediate action to](https://www.justice.gov/opa/pr/justice-department-announces-actions-disrupt-advanced-persistent-threat-28-botnet-infected)\ndisrupt the VPNFilter, securing a court order, authorizing it to seize a domain that is part of\nthe malware's C&C infrastructure.\n\nMeanwhile, Linksys is advising customers to change administration passwords periodically\nand ensure software is regularly updated. If they believe they have been infected, a factory\nreset of their router is recommended. Full instructions can be found here.\n\nMikroTik has said that it is highly certain that any of its devices infected by VPNFilter had the\nmalware installed through a vulnerability in MikroTik RouterOS software, which was patched\nby MikroTik in March 2017. Upgrading RouterOS software deletes VPNFilter, any other thirdparty files and patches the vulnerability.\n**[UPDATE May 25, 2018: QNAP has published a security advisory on VPNFilter. It contains](https://www.qnap.com/en/security-advisory/nas-201805-24)**\nguidance on how to use the company’s malware removal tool to remove any infections.\n\n## About the Author\n\n### Symantec Security Response\n\n**Security Response Team**\n\nSymantec's Security Response organization develops and deploys new security content to\nSymantec customers. Our team of global threat analysts operate 24x7 to track developments\non the threat landscape and protect Symantec customers.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2018/2018-05-23 - VPNFilter- New Router Malware with Destructive Capabilities.pdf"
    ],
    "report_names": [
        "2018-05-23 - VPNFilter- New Router Malware with Destructive Capabilities.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673536134,
    "ts_updated_at": 1743041161,
    "ts_creation_date": 1653775008,
    "ts_modification_date": 1653775008,
    "files": {
        "pdf": "https://archive.orkl.eu/d2825f9a643ff861c6f2cc02ef0eddc2442a5f23.pdf",
        "text": "https://archive.orkl.eu/d2825f9a643ff861c6f2cc02ef0eddc2442a5f23.txt",
        "img": "https://archive.orkl.eu/d2825f9a643ff861c6f2cc02ef0eddc2442a5f23.jpg"
    }
}