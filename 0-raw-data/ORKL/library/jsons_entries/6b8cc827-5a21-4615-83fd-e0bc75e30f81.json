{
    "id": "6b8cc827-5a21-4615-83fd-e0bc75e30f81",
    "created_at": "2023-01-12T15:01:23.477595Z",
    "updated_at": "2025-03-27T02:06:06.129453Z",
    "deleted_at": null,
    "sha1_hash": "6fd5dbf5102aaa8d61ea6e60be0f9213dcce0e15",
    "title": "2022-03-08 - Record breaking DDoS Potential Discovered- CVE-2022-26143",
    "authors": "",
    "file_creation_date": "2022-05-28T19:27:18Z",
    "file_modification_date": "2022-05-28T19:27:18Z",
    "file_size": 97327,
    "plain_text": "# Record breaking DDoS Potential Discovered: CVE-2022- 26143\n\n**[team-cymru.com/blog/2022/03/08/record-breaking-ddos-potential-discovered-cve-2022-26143/](https://team-cymru.com/blog/2022/03/08/record-breaking-ddos-potential-discovered-cve-2022-26143/)**\n\nJames Shank View all posts by James Shank March 8, 2022\n\nCVE-2022-26143: TP240PhoneHome Reflection/Amplification DDoS Attack Vector\n\n## Executive summary\n\nA new reflection/amplification distributed denial-of-service (DDoS) vector with a recordbreaking potential amplification ratio of 4,294,967,296:1 has been abused by attackers\nin the wild to launch multiple high-impact DDoS attacks.\nSecurity researchers, network operators, and security vendors observed these attacks\nand formed a task force to investigate the new DDoS vector and provide mitigation\nguidance.\nApproximately 2,600 Mitel MiCollab and MiVoice Business Express collaboration\nsystems acting as PBX-to-internet gateways were incorrectly deployed with an\nabusable system test facility exposed to the public internet.\nAttackers were actively leveraging these systems to launch reflection/amplification\nDDoS attacks of more than 53 million packets per second (Mpps). With optimal attack\ntuning, the potential traffic yield for this DDoS vector is significantly higher.\nAttacks have been observed on broadband access ISPs, financial institutions, logistics\ncompanies, gaming companies, and organizations in other vertical markets.\nThe attacks can be mitigated using standard DDoS-defense techniques.\nMitel has released patched software that disables the abusable test facility, and is\nactively engaged in remediation efforts with their customers.\nResearch and mitigation task force contributors include Akamai SIRT, Cloudflare,\nLumen Black Lotus Labs, Mitel, NETSCOUT Arbor ASERT, TELUS, Team Cymru, and\nThe Shadowserver Foundation.\n\n## Introduction\n\nBeginning in mid-February 2022, security researchers, network operators, and security\nvendors observed a spike in DDoS attacks sourced from UDP port 10074 targeting\nbroadband access ISPs, financial institutions, logistics companies, and organizations in other\nvertical markets.\n\nUpon further investigation, it was determined that the devices abused to launch these attacks\nare MiCollab and MiVoice Business Express collaboration systems produced by  which\nincorporate TP-240 VoIP-processing interface cards and supporting software; their primary\nfunction is to provide internet-based site-to-site voice connectivity for PBX systems.\n\n\n-----\n\nApproximately 2600 of these systems have been incorrectly provisioned so that an\nunauthenticated system test facility has been inadvertently exposed to the public internet,\nallowing attackers to leverage these PBX VoIP gateways as DDoS reflectors/amplifiers.\n\nMitel is aware that these systems are being abused to facilitate high-pps DDoS attacks, and\nhave been actively working with customers to remediate abusable devices with patched\nsoftware that disables public access to the system test facility.\n\nIn this blog, we will further explore the observed activity, explain how the driver has been\nabused, and share recommended mitigation steps. This research was created cooperatively\namong a team of researchers from Akamai SIRT, Cloudflare, Lumen Black Lotus Labs,\nNETSCOUT Arbor ASERT, TELUS, Team Cymru, and The Shadowserver Foundation.\n\n## DDoS attacks in the wild\n\nWhile spikes of network traffic associated with the vulnerable service were observed on\nJanuary 8 and February 7, 2022, we believe the first actual attacks leveraging the exploit\nbegan on February 18.\n\nObserved attacks were primarily predicated on pps, or throughput, and appeared to be UDP\nreflection/amplification attacks sourced from UDP/10074 that were mainly directed toward\ndestination ports UDP/80 and UDP/443. The single largest observed attack of this type\npreceding this one was approximately 53 Mpps and 23 Gbps. The average packet size for\nthat attack was approximately 60 bytes, with an attack duration of approximately 5 minutes.\nThe amplified attack packets are not fragmented.\n\nThis particular attack vector differs from most UDP reflection/amplification attack\nmethodologies in that the exposed system test facility can be abused to launch a sustained\nDDoS attack of up to 14 hours in duration by means of a single spoofed attack initiation\n_packet, resulting in a record-setting packet amplification ratio of 4,294,967,296:1. A_\ncontrolled test of this DDoS attack vector yielded more than 400 Mpps of sustained DDoS\nattack traffic.\n\nIt should be noted that this single-packet attack initiation capability has the effect of\nprecluding network operator traceback of the spoofed attack initiator traffic. This helps mask\nthe attack traffic generation infrastructure, making it less likely that the attack origin can be\ntraced compared with other UDP reflection/amplification DDoS attack vectors.\n\n## Abusing the tp240dvr driver\n\nThe abused service on affected Mitel systems is called tp240dvr (“TP-240 driver”) and\nappears to run as a software bridge to facilitate interactions with TDM/VoIP PCI interface\ncards. The service listens for commands on UDP/10074 and is not meant to be exposed to\n\n\n-----\n\nthe internet, as confirmed by the manufacturer of these devices. It is this exposure to the\ninternet that ultimately allows it to be abused.\n\nThe tp240dvr service exposes an unusual command that is designed to stress test its clients\nin order to facilitate debugging and performance testing. This command can be abused to\ncause the tp240dvr service to send this stress test to attack victims. The traffic consists of a\nhigh rate of short informative status update packets that can potentially overwhelm victims\nand cause the DDoS scenario.\n\nThis command can also be abused by attackers to launch very high-throughput attacks.\nAttackers can use specially crafted commands to cause the tp240dvr service to send larger\ninformative status update packets, significantly increasing the amplification ratio.\n\nBy extensively testing isolated virtual TP-240–based systems in a lab setting, researchers\nwere able to cause these devices to generate massive amounts of traffic in response to\ncomparatively small request payloads. We will cover this attack scenario in greater technical\ndepth in the following sections.\n\n## Calculating the potential attack impact\n\nAs previously mentioned, amplification via this abusable test facility differs substantially from\nhow it is accomplished with most other UDP reflection/amplification DDoS vectors. Typically,\nreflection/amplification attacks require the attacker to continuously transmit malicious\npayloads to abusable nodes for as long as they wish to attack the victim. In the case of TP240 reflection/amplification, this continuous transmission is not necessary to launch highimpact DDoS attacks.\n\nInstead, an attacker leveraging TP-240 reflection/amplification can launch a high-impact\nDDoS attack using a single packet. Examination of the tp240dvr binary reveals that, due to\nits design, an attacker can theoretically cause the service to emit 2,147,483,647 responses\nto a single malicious command. Each response generates two packets on the wire, leading\nto approximately 4,294,967,294 amplified attack packets being directed toward the attack\nvictim.\n\nFor each response to a command, the first packet contains a counter that increments with\neach sent response. As the counter value increments, the size of this first packet will grow\nfrom 36 bytes to 45 bytes. The second packet contains diagnostic output from the function,\nwhich can be influenced by the attacker. By optimizing each initiator packet to maximize the\nsize of the second packet, every command will result in amplified packets that are up to\n1,184 bytes in length.\n\nIn theory, a single abusable node generating the upper limit of 4,294,967,294 packets at a\nrate of 80 thousand packets per second (Kpps) would result in an attack duration of roughly\n14 hours. Over the course of the attack, the “counter” packets alone would generate roughly\n\n\n-----\n\n95.5 GB of amplified attack traffic destined for the targeted network. The maximally padded\n“diagnostic output” packets would account for an additional 2.5 TB of attack traffic directed\ntoward the target.\n\nThis would yield a sustained flood of just under 393 Mbps of attack traffic from a single\nreflector/amplifier, all resulting from a single spoofed attack initiator packet of only 1,119\nbytes in length. This results in a nearly unimaginable amplification ratio of 2,200,288,816:1\n— a multiplier of 220 billion percent, triggered by a single packet.\n\n## Upper boundaries of attack volume and simultaneity\n\nThe tp240dvr service processes commands using a single thread. This means they can only\nprocess a single command at a time, and thus can only be used to launch one attack at a\ntime. In the example scenario presented above, during the 14 hours that the abused device\nwould be attacking the target, it cannot be leveraged to attack any other target. This is\nsomewhat unique in the context of DDoS reflection/amplification vectors.\n\nAlthough this characteristic also causes the tp240dvr service to be unavailable to legitimate\nusers, it is much preferable to having these devices be leveraged in parallel by multiple\nattackers — and leaving legitimate operators of these systems to wonder why their outbound\ninternet data capacity is being consumed at much higher rates.\n\nAdditionally, it appears these devices are on relatively low-powered hardware in terms of\ntheir traffic-generation capabilities. On an internet where 100 Gbps links, dozens of CPU\ncores, and multithreading capabilities have become commonplace, we can all be thankful\nthis abusable service is not found on top-of-the-line hardware platforms capable of\nindividually generating Mpps, and running with thousands of parallelized threads.\n\nLastly, it is also good news that of the tens of thousands of these devices that have been\npurchased and deployed historically by governments, commercial enterprises, and other\norganizations worldwide, a relatively small number of them have been configured in a\nmanner that leaves them in this abusable state, and of those, many have been properly\nsecured and taken offline from an attacker’s perspective.\n\n## Collateral impact\n\nThe collateral impact of TP-240 reflection/amplification attacks is potentially significant for\norganizations with internet-exposed Mitel MiCollab and MiVoice Business Express\ncollaboration systems that are abused as DDoS reflectors/amplifiers.\n\nThis may include partial or full interruption of voice communications through these systems,\nas well as additional service disruption due to transit capacity consumption, state-table\nexhaustion of network address translations, stateful firewalls, and so forth.\n\n\n-----\n\nWholesale filtering of all UDP/10074-sourced traffic by network operators may potentially\noverblock legitimate internet traffic, and is therefore contraindicated.\n\n[During the testing and research phases, an UTRS participant network got hit with an attack](https://team-cymru.com/community-services/utrs/)\nand used UTRS to successfully mitigate the attack. The corresponding network graphs are a\ndramatic testament to the success of UTRS.\n\n[More can be found about this Team Cymru Community Service here.](https://team-cymru.com/community-services/utrs/)\n\n## Recommended actions\n\nTP-240 reflection/amplification DDoS attacks are sourced from UDP/10074 and destined for\nthe UDP port of the attacker’s choice. This amplified attack traffic can be detected, classified,\ntraced back, and safely mitigated using standard DDoS defense tools and techniques.\n\nFlow telemetry and packet capture via open-source and commercial analysis systems can\nalert network operators and end customers of TP-240 reflection/amplification attacks.\n\nNetwork access control lists (ACLs), flowspec, destination-based remotely triggered\nblackhole, source-based remotely triggered blackhole, and intelligent DDoS mitigation\nsystems can be used to mitigate these attacks.\n\nNetwork operators should perform reconnaissance to identify and facilitate remediation of\nabusable TP-240 reflectors/amplifiers on their networks and/or the networks of their\ncustomers. Operators of Mitel MiCollab and MiVoice Business Express collaboration\nsystems should proactively contact Mitel to receive specific remediation instructions from the\nvendor.\n\nOrganizations with business-critical public-facing internet properties should ensure that all\nrelevant network infrastructure, architectural, and operational best current practices (BCPs)\nhave been implemented, including situationally specific network access policies that only\npermit internet traffic via required IP protocols and ports. Internet access network traffic\nto/from internal organizational personnel should be isolated from internet traffic to/from\npublic-facing internet properties, and served via separate upstream internet transit links.\n\nDDoS defenses for all public-facing internet properties and supporting infrastructure should\nbe implemented in a situationally appropriate manner, including periodic testing to ensure\nthat any changes to the organization’s servers/services/applications are incorporated into its\nDDoS-defense plan.\n\nIt is imperative that organizations operating mission-critical public-facing internet properties\nand/or infrastructure ensure that all servers/services/application/datastores/infrastructure\nelements are protected against DDoS attack, and are included in periodic, realistic tests of\nthe organization’s DDoS mitigation plan. Critical ancillary supporting services such as\nauthoritative and recursive DNS servers must be included in this plan.\n\n\n-----\n\nNetwork operators should implement ingress and egress source address validation in order\nto prevent attackers from initiating reflection/amplification DDoS attacks.\n\nAll potential DDoS attack mitigation measures described in this document MUST be tested\nand customized in a situationally appropriate manner prior to deployment on production\nnetworks.\n\n## Mitigating factors\n\nOperators of internet-exposed TP-240–based Mitel MiCollab and MiVoice Business Express\ncollaboration systems can prevent abuse of their systems to launch DDoS attacks by\nblocking incoming internet traffic destined for UDP/10074 via ACLs, firewall rules, and other\nstandard network access control policy enforcement mechanisms.\n\nMitel has provided patched software versions that prevent TP-240–equipped MiCollab and\nMiVoice Business Express collaboration systems from being abused as DDoS\nreflectors/amplifiers by preventing exposure of the service to the internet. Mitel customers\nshould contact the vendor for remediation instructions.\n\nCollateral impact to abusable TP-240 reflectors/amplifiers can alert network operators and/or\nend customers to remove affected systems from “demilitarized zone” networks or internet\ndata centers or to disable relevant UDP port–forwarding rules that allow specific UDP/10074\ntraffic sourced from the public internet to reach these devices, thereby preventing them from\nbeing abused to launch reflection/amplification DDoS attacks.\n\nThe amplified attack traffic is not fragmented, so there is no additional attack component\nconsisting of non initial fragments, as is the case with many other UDP\nreflection/amplification DDoS vectors.\n\nImplementation of ingress and egress source-address validation (SAV; also known as antispoofing) can prevent attackers from launching reflection/amplification DDoS attacks.\n\n## Conclusion\n\nUnfortunately, many abusable services that should not be exposed to the public internet are\nnevertheless left open for attackers to exploit. This scenario is yet another example of realworld deployments that do not adhere to vendor guidance. Vendors can prevent this situation\nby adopting “safe by default” postures on devices before shipping.\n\nReflection/amplification DDoS attacks would be impossible to launch if all network operators\nimplemented ingress and egress SAV (or anti-spoofing). The ability to spoof the IP\naddress(es) of the intended attack target(s) is required to launch such attacks. Service\nproviders must continue to implement SAV in their own networks, and require that their\ndownstream customers do so as well.\n\n\n-----\n\nAs is routinely the case with newer DDoS attack vectors, it appears that after an initial period\nof employment by advanced attackers with access to bespoke DDoS attack infrastructure,\nTP-240 reflection/amplification has been weaponized and added to the arsenals of so-called\n“booter/stresser” DDoS-for-hire services, placing it within the reach of the general attacker\npopulation.\n\nCollaboration across the operational, research, and vendor communities is central to the\ncontinued viability of the internet. The quick response to and ongoing remediation of this\nhigh-impact DDoS attack vector has only been possible as a result of such collaboration.\nOrganizations with a vested interest in the stability and resiliency of the internet should\nembrace and support cross-industry cooperative efforts as a core principle.\n\nThe combined efforts of the research and mitigation task force demonstrates that successful\ncollaboration across industry peers to quickly remediate threats to availability and resiliency\nis not only possible, but is also increasingly critical for the continued viability of the global\ninternet.\n\n## Sources\n\n[https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-26143/](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-26143/)\n\nhttps://www.mitel.com/en-ca/support/security-advisories/mitel-product-security-advisory-220001\n\n[https://www.cisa.gov/uscert/ncas/alerts/TA14-017A](https://www.cisa.gov/uscert/ncas/alerts/TA14-017A)\n\n[https://www.senki.org/ddos-attack-preparation-workbook/](https://www.senki.org/ddos-attack-preparation-workbook/)\n\n[https://www.manrs.org/resources/](https://www.manrs.org/resources/)\n\n[https://www.rfc-editor.org/info/bcp84](https://www.rfc-editor.org/info/bcp84)\n\n[https://datatracker.ietf.org/doc/html/rfc7039](https://datatracker.ietf.org/doc/html/rfc7039)\n\n## Research and mitigation task force contributors\n\nResearchers from the following organizations have contributed to the findings and\nrecommendations described in this document:\n\nIn particular, the mitigation task force would like to cite Mitel for their exemplary cooperation,\nrapid response, and ongoing participation in remediation efforts. Mitel quickly created and\ndisseminated patched software, worked with their customers and partners to update affected\nsystems, and supplied valuable expertise as the task force worked to formulate this\ndocument.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-03-08 - Record breaking DDoS Potential Discovered- CVE-2022-26143.pdf"
    ],
    "report_names": [
        "2022-03-08 - Record breaking DDoS Potential Discovered- CVE-2022-26143.pdf"
    ],
    "threat_actors": [
        {
            "id": "aa73cd6a-868c-4ae4-a5b2-7cb2c5ad1e9d",
            "created_at": "2022-10-25T16:07:24.139848Z",
            "updated_at": "2025-03-27T02:02:10.120505Z",
            "deleted_at": null,
            "main_name": "Safe",
            "aliases": [],
            "source_name": "ETDA:Safe",
            "tools": [
                "DebugView",
                "LZ77",
                "OpenDoc",
                "SafeDisk",
                "TypeConfig",
                "UPXShell",
                "UsbDoc",
                "UsbExe"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535683,
    "ts_updated_at": 1743041166,
    "ts_creation_date": 1653766038,
    "ts_modification_date": 1653766038,
    "files": {
        "pdf": "https://archive.orkl.eu/6fd5dbf5102aaa8d61ea6e60be0f9213dcce0e15.pdf",
        "text": "https://archive.orkl.eu/6fd5dbf5102aaa8d61ea6e60be0f9213dcce0e15.txt",
        "img": "https://archive.orkl.eu/6fd5dbf5102aaa8d61ea6e60be0f9213dcce0e15.jpg"
    }
}