{
    "id": "73cff09b-c273-49dd-9967-a0adf2a57f2c",
    "created_at": "2022-10-25T16:48:24.473237Z",
    "updated_at": "2025-03-27T02:17:01.054614Z",
    "deleted_at": null,
    "sha1_hash": "df14862e85f709fbba2b4c9a66ed9cf590baf6c9",
    "title": "VMware Exposing Malware In Linux Based Multi Cloud Environments",
    "authors": "",
    "file_creation_date": "2022-02-08T14:13:49Z",
    "file_modification_date": "2022-02-08T14:14:10Z",
    "file_size": 1948765,
    "plain_text": "|Col1|Col2|Col3|Col4|Col5|Col6|Col7|Col8|Col9|Col10|Col11|Col12|Col13|Col14|Col15|Col16|Col17|Col18|Col19|Col20|Col21|Col22|Col23|Col24|Col25|Col26|Col27|Col28|Col29|Col30|Col31|Col32|Col33|Col34|Col35|\n|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|\n||||||||||||||||||||||||||||||||||||\n||||||||||||||||||||||||||||||||||||\n||||||||||||||||||||||||||||||||||||\n||||||||||||||||||||||||||||||||||||\n|||||po||||||||||||w||ar||e|||||||||||||||\n||||||||||||||||||||||||||||||||||||\n||||||||||||||||||||||||||||||||||||\n|||||||x-||Ba||se||d|||M|||ul||||||ou|||||||||||\n||||||||||||||||||||||||||||||||||||\n|||En||||||nm||||nt|||||||||||||||||||||||\n||||||||||||||||||||||||||||||||||||\n||||||||||||||||||||||||||||||||||||\n|T||||nica||l Th||reat||||por||t|||||||||||||||||||||\n||||||||||||||||||||||||||||||||||||\n||||||||||||||||||||||||||||||||||||\n||||||||||||||||||||||||||||||||||||\n||||||||||||||||||||||||||||||||||||\n||||||||||||||||||||||||||||||||||||\n||||||||||||||||||||||||||||||||||||\n||||||||||||||||||||||||||||||||||||\n||||||||||||||||||||||||||||||||||||\n||||||||||||||||||||||||||||||||||||\n||||||||||||||||||||||||||||||||||||\n||||||||||||||||||||||||||||||||||||\n||||||||||||||||||||||||||||||||||||\n||||||||||||||||||||||||||||||||||||\n||||||||||||||||||||||||||||||||||||\n||||||||||||||||||||||||||||||||||||\n||||||||||||||||||||||||||||||||||||\n\n\n# Exposing Malware in Linux-Based Multi-Cloud Environments\n\n###### Technical Threat Report\n\n\n-----\n\n### Table of contents\n\n###### Executive summary............................................................................................ 3\n\n Key findings ...................................................................................................... 4\n\n Ransomware and cryptominers........................................................................... 5\n\nRansomware ...................................................................................................................................... 5\n\nRansomware families ..................................................................................................................6\n\nCharacterizing similarity...............................................................................................................6\n\nCharacterizing behavior...............................................................................................................9\n\nDetecting and mitigating the threat...............................................................................................10\n\nCryptominers...................................................................................................................................... 10\n\nCryptominer families....................................................................................................................10\n\nCharacterizing similarity ..............................................................................................................14\n\nCharacterizing behavior...............................................................................................................17\n\nDetecting and mitigating the threat...............................................................................................17\n\nMethodology....................................................................................................................................... 18\n\nStatic and dynamic analysis..........................................................................................................18\n\nMalware datasets ........................................................................................................................18\n\n###### Remote access tools – Implants.......................................................................... 20\n\nTactics used by implants..............................................................................................................21\n\nAttack stages..............................................................................................................................22\n\nAttack management tools............................................................................................................23\n\nA deeper look at Cobalt Strike – Vermilion Strike................................................................................... 23\n\nVermilion Strike configuration details............................................................................................24\n\nVermilion Strike setup..................................................................................................................26\n\nCobalt Strike/Vermilion Strike C2 communication..........................................................................27\n\nVermilion Strike Windows and Linux differences............................................................................28\n\nMetadata....................................................................................................................................29\n\nVermilion Strike compatibility with Cobalt Strike team server..........................................................29\n\nThe VMware Threat Analysis Unit Cobalt Strike threat intelligence collection........................................... 30\n\nProtocol overview and our approach.............................................................................................30\n\nObservations since February 2020...............................................................................................32\n\nAttribution to the specific threat actors.........................................................................................35\n\nIdentifying potential targets.........................................................................................................37\n\nDetecting and mitigating the threat...............................................................................................38\n\n###### VMware recommendations................................................................................. 39\n\n References........................................................................................................ 41\n\n|t ... ... ... .... .... .... .... .... .... .... .... .... ....|s .. .. .. .... ... ... ... ... .... ... ... ... ...|... ... ... ... .... .... .... .... ... .... .... .... ....|... ... ... .... ... ... ... ... .... ... ... ... ...|.. .. .. ... .... .... .... .... ... .... .... .... ....|... ... ... ... ... ... ... ... ... ... ... ... ...|.. .. .. .... .... .... .... .... .... .... .... .... ....|... ... ... ... ... ... ... ... ... ... ... ... ...|... ... ... .... ... ... ... ... .... ... ... ... ...|.. .. .. ... .... .... .... .... ... .... .... .... ....|... ... ... .... ... ... ... ... .... ... ... ... ...|... ... ... ... .... .... .... .... ... .... .... .... ....|.. .. .. .... ... ... ... ... .... ... ... ... ...|... ... ... ... ... ... ... ... ... ... ... ... ...|... ... ... .... .... .... .... .... .... .... .... .... ....|.. .. .. ... ... ... ... ... ... ... ... ... ...|... ... ... .... .... .... .... .... .... .... .... .... ....|... ... ... ... ... ... ... ... ... ... ... ... ...|.. .. .. .... ... ... ... ... .... ... ... ... ...|... ... ... ... .... .... .... .... ... .... .... .... ....|... ... ... ... ... ... ... ... ... ... ... ... ...|.. .. .. .... .... .... .... .... .... .... .... .... ....|... ... ... ... ... ... ... ... ... ... ... ... ...|... ... ... .... .... .... .... .... .... .... .... .... ....|.. .. .. ... ... ... ... ... ... ... ... ... ...|... ... ... .... ... ... ... ... .... ... ... ... ...|3 4 5 5 .6 .6 .9 .10 10 .10 .14 .17 .17|Col28|Col29|Col30|Col31|Col32|Col33|Col34|Col35|\n|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|\n\n\n-----\n\nIn the past five years, Linux® has become the most common operating system\n(OS) in multi-cloud environments. It has even bypassed Windows on\nMicrosoft Azure to power more than 78 percent of the most popular\nwebsites.[1] Malicious actors have taken notice and are increasingly targeting\nvulnerable Linux-based systems in multi-cloud environments to infiltrate\ncorporate and government networks.\n\nThreat actors know that current malware countermeasures are mostly focused\non addressing Windows-based threats, leaving many public and private cloud\ndeployments vulnerable to Linux-based attacks. These public and private clouds\nare high-value targets for cybercriminals, providing access to critical\ninfrastructure services and substantial computational resources.\n\nIn fact, cloud infrastructures and data centers host key components, such as email\nservers and customer databases, that have been the target of high-profile\nintelligence-gathering breaches. The large-scale campaign carried out in early\n2021, which targeted Exchange servers,[2] and the Cybersecurity and Infrastructure\nSecurity Agency (CISA) alert about BlackMatter,[3] which targeted the U.S. food\nand agriculture sector, are good examples of how attacks to vulnerable cloud\ninfrastructure can disrupt an organization’s value-delivery pipeline.\n\nThese threats take advantage of weak authentication, vulnerabilities and\nmisconfigurations in container-based infrastructures to infiltrate the environment\nwith remote access tools (RATs). Once the attackers have obtained a foothold in\ntheir target cloud environment, they often look to perform two types of attacks:\nexecute ransomware or deploy cryptomining components.\n\nOrganizations need to bolster their ability to identify and defend against these\ntypes of attacks. Given the distributed, dynamic and heterogeneous nature of\ntoday’s enterprise workloads and networks, organizations need to extend\ntelemetry across the entire infrastructure—from endpoints to multi-cloud\nenvironments. This will allow organizations to better monitor traffic and identify\nabnormal behavior to mitigate the impact of attacks on the enterprise, while\nincreasing overall efficiencies and reducing operational costs.\n\nThis report, based on VMware’s experience with a diverse customer base, offers\na comprehensive look at Linux-based malware threats to multi-cloud\nenvironments. It highlights the unique characteristics of this class of threats and\nprovides guidance on how combining endpoint detection and response (EDR)\nand network detection and response (NDR) solutions can help organizations stay\nahead of the threats Linux-based malware poses.\n\n\n## 78%\n##### of the most popular websites are powered by Linux[1 ]\n\nLinux-based malware is a fastgrowing threat to multi-cloud\nenvironments, including data\ncenters, that must be addressed\nto protect an organization’s assets\nand operations. This report details\n[the research that the VMware](https://www.vmware.com/security/threat-analysis-unit-tau.html)\n[Threat Analysis Unit™ has done](https://www.vmware.com/security/threat-analysis-unit-tau.html)\ninto the latest threats to Linuxbased systems, documenting\nkey findings that can help\norganizations better understand\nand prepare to defend themselves\nagainst these rising threats.\n\n|Col1|Col2|Col3|Col4|Col5|Col6|Col7|Col8|Col9|Col10|Col11|Col12|Col13|Col14|Col15|Col16|Col17|Col18|Col19|Col20|Col21|Col22|Col23|Col24|Col25|Col26|Col27|Col28|Col29|Col30|Col31|Col32|Col33|\n|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|\n||||||||||||||||||||||||||||||||||\n||||||||||||||||||||||||||||||||||\n||||||||||||||||||||||||||||||||||\n||||||||||||||||||||||||||||||||||\n||||||||||||||||||||||||||||||||||\n||||||||||||||||||||||||||||||||||\n||||||||||||||||||||||||||||||||||\n||||||||||||||||||||||||||||||||||\n||||||||||||||||||||||||||||||||||\n||||||||||||||||||||||||||||||||||\n||||||||||||||||||||||||||||||||||\n|||||||E||x|e|c|u||t|i||v|e|||s|u|m||m||a|r|y|||||\n||||||||||||||a d o u b v w n e g||s e a s r h o ts|||u n s y n ur a o c|||||||||||||||\n\n\n-----\n\n#### Key findings\n\n###### Linux-based systems are fast becoming an attacker’s way into high- value, multi-cloud environments.\n\n- Linux is the most common OS across multi-cloud\n\nenvironments.[4]\n\n- Malware targeting Linux-based systems is increasing\n\nin volume and complexity, but it is still less\nsophisticated than Windows threats.\n\n- There is a lack of focus on the detection of threats\n\nthat target Linux-based systems, making existing\ntools inadequate.\n\n- The main threats in most multi-cloud environments\n\nare ransomware, cryptominers and RATs.\n\n- Existing attack characterization techniques based on\n\nstatic information, such as strings and APIs, are\nuseful but easily evaded by sophisticated threats.\n\n- Defense evasion is the most common tactic used in\n\nransomware and cryptominers. Various encryption\nor obfuscation techniques, such as Base64 encoding\nand AES-based encryption, are used by attackers to\nconceal code and data.\n\n###### Ransomware is becoming more sophisticated.\n\n- Ransomware has recently evolved to target Linux\n\nhost images that are used to spin workloads in\nvirtualized environments.\n\n- Ransomware attacks against cloud deployments are\n\ntargeted, not opportunistic.\n\n- Ransomware attacks against cloud environments are\n\noften combined with data exfiltration, implementing\na double-extortion scheme that improves their odds\nof success.\n\n- The detection of sophisticated threats targeting\n\nLinux-based systems requires dynamic analysis and\ncontinuous host monitoring—capabilities that work\nwell with the Linux kernel.\n\n\nWindows, its expansion to other operating\nsystems, such as Linux, is notable. It\ndemonstrates the desire of threat actors to use\nreadily available remote-control tools to target\nas many platforms as possible.\n\n- VMware Threat Analysis Unit discovered\n\nmore than 14,000 active Cobalt Strike team\nservers on the internet since the end of\nFebruary 2020.\n\n- The most popular protocol for the Cobalt\n\nStrike beacon is HTTPS.\n\n- Close to 90 percent of the Cobalt Strike server\n\npopulation is version 4 or later.\n\n- The total percentage of cracked and leaked\n\nCobalt Strike customer IDs is 56 percent. This\nmeans that more than half of the Cobalt Strike\nusers are using illegitimately obtained versions\nof the commercial software.\n\n- Vermilion Strike is just the first of many\n\nmalware targeting Linux-based systems that\nwill mimic the actions of other well-known\nRATs to simplify an adversary’s work.\n\n|o s. clo cr hre isti nm|hi ud ea at ng en|gh sin s ts|- g|Col5|Col6|Col7|C t • • R L •|r o Cr st M M m an cr A in As|yp m yp ole ost on ost d yp T u C|t o toj n cr er c res to s x- ob|oj st ac CP yp o c om ea mi ar b alt|ac ly ki U to ry m rc ner e a S|k m ng cy jac pto on h f s a se tri|in i at cle ki cu ly ou us n d ke|g n tac s t ng rr us nd ed in s is|a e ks o at en ed th X cr ys su|tt M fo mi ta cy to at MR e te ch|ac o cu ne cks (o ol 8 ig as m a|k ne s cr fo r X fo 9 p -re in s ub|s r on yp cu M r c er lat g . iq|us o. m to s R) ry ce ed t uit|e on cu on . X pto nt li hr ou|X et rre m M m of br e s t|M izi nc ini Rig ini ari at hr|R ng ie ng is ng es. t eat|i s. th th , o o|g e e n|Col29|Col30|Col31|Col32|Col33|Col34|Col35|\n|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|\n\n\n-----\n\n#### Ransomware and cryptominers\n\n\nThe impact of a ransomware attack can range from being a nuisance (e.g.,\nhaving to restore data from backups and clean up the network) to being\ndevastating (e.g., having to pay large sums of money to regain access to key\nassets). Unfortunately, when talking about cloud environments, the results tend\nto be more on the devastating side. Recently, cybercriminals have started\ncalculating the damage they might cause to the valuation of a company going\nthrough a financial event to make the potential impact of their attack clear and\nincentivize ransom payments.[5] At the same time, they’ve been honing their\ntactics with increasingly sophisticated techniques to target victim organizations.\n\nLarge-scale ransomware attacks on cloud deployments, however, have some\ndistinct characteristics that make them harder to spot and stop. First, ransomware\nattacks against cloud deployments are targeted, not opportunistic. Unlike general\nransomware, which plays a numbers game (e.g., sending malicious email\nattachments to millions of users in hopes that some will inadvertently click and\ninfect their systems), attacks on cloud infrastructures are more targeted and\ncarefully planned.\n\nThese attacks are designed for maximum impact. The cybercriminals make\nsure that their target systems have been fully compromised before starting\nthe file encryption process. This allows them to simultaneously encrypt the\nwhole network to inundate response resources and make incident response\nmore difficult.\n\nRansomware has recently evolved to target the Linux host images used to spin\nup workloads in virtualized environments. This new and worrisome development\nshows how attackers look for the most valuable assets in cloud environments to\ninflict the maximum damage on their target. Examples include the Defray777\nransomware family, which encrypted host images on VMware ESXi servers,[6] and\nthe DarkSide ransomware family, which crippled Colonial Pipeline’s networks\nand caused a nationwide gasoline shortage in the U.S.[7]\n\n\nThe basic profile of a ransomware\nattack is so popular that even\nnon-technical people know\nhow it works: a network is\ncompromised, sensitive files are\nencrypted, and a ransom note\nis presented to the victim that\nasks for money/cryptocurrency\nin exchange for a decryption key\nthat will unlock access to the\nfiles. (For a peek into what victim\norganizations go through, check\n[out the blog post, HelloKitty: The](https://blogs.vmware.com/networkvirtualization/2021/09/hellokitty-the-victims-perspective.html/)\n[Victim’s Perspective.[8])](https://blogs.vmware.com/networkvirtualization/2021/09/hellokitty-the-victims-perspective.html/)\n\n|Col1|Col2|Col3|Col4|Col5|Col6|Col7|Col8|Col9|Col10|Col11|Col12|Col13|Col14|Col15|Col16|Col17|Col18|Col19|Col20|Col21|Col22|Col23|Col24|Col25|Col26|Col27|Col28|Col29|Col30|Col31|Col32|Col33|\n|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|\n||||||||||||||||||||||||||||||||||\n||||||||||||||||||||||||||||||||||\n||||||||||||||||||||||||||||||||||\n||||||||||||||||||||||||||||||||||\n||||||||||||||||||||||||||||||||||\n||||||||||||||||||||||||||||||||||\n||||||||||||||||||||||||||||||||||\n||||||||||||||||||||||||||||||||||\n||||||||||||||||||||||||||||||||||\n||||||||||||||||||||||||||||||||||\n||||||||||||||||||||||||||||||||||\n||||||||||||||||||||||||||||||||||\n||||||||||||||n d h t||o a v y v|||r m o e t|||||||||||||||\n\n\n-----\n\nMany ransomware attacks against cloud environments involve exfiltrating data,\nallowing the attacker to implement a double-extortion scheme. Essentially, the\nattacker uses the data they collect as leverage to incent the victim into paying\nthe ransom. If the victim does not comply, the attacker leaks the information,\nmaking it public on the internet to damage the victim’s reputation.[9]\n\n###### Ransomware families\n\nFor this report, the VMware Threat Analysis Unit analyzed nine ransomware\nfamilies that target Linux systems, characterizing their evolution and crosspollination. A brief description of the families covered is included in the sidebar.\nWe started analyzing the different characteristics of the ransomware samples of\neach of these nine families by looking at the static information extracted from\ntheir ELF files. While threats can be a combination of shell scripts, Python\nscripts, and binaries, this report focuses on the binaries. Binaries are usually the\ncomponents that carry out the file system encryption in a ransomware attack.\n\n###### Characterizing similarity\n\nAs a first step, we used telfhash[10] to characterize the code sharing among\nsamples. The approach used by telfhash applies a locality-sensitive hashing\nfunction, namely TLSH, to the symbols contained in the ELF files. In the case of\nstatically linked and stripped files that contain no symbols, the hashing function\nis applied to the target addresses of the call instructions observed in the binary\ncode of the program. One of the advantages of telfhash is that it is architectureindependent, so it can operate on binaries compiled for different platforms,\nsuch as x86 32bit, x86 64bit, and ARM.\n\nBecause of the locality-sensitive nature of TLSH, files with similar sets of symbols\nproduce similar telfhash values. These values can be used as a similarity metric\nto identify closely related samples and cluster together malware families. Note\nthat telfhash does not produce a normalized value between two fixed values\n(e.g., 0.0 to 1.0), but instead defines two samples as similar when their distance\nis below a certain number (the default is 50).\n\nFigure 1 shows the confusion matrix of the ransomware families. Lighter colors\nindicate samples that were more similar. Note that this graph orders the samples\nby time of appearance to highlight their evolution over time.\n\n\nREvil\nThe REvil ransomware, also\nknown as Sodinokibi, originally\ntargeted Windows hosts, but\nreleased a Linux version in spring\n2021.[29] Interestingly, this threat\nrelies on the esxcli commandline tool to stop the current ESXi\nvirtual machines (VMs). It then\nencrypts their on-disk images to\nprevent the recovery of running\nVMs. Recently, REvil actors have\nbeen targeted by a coordinated\ntake-down operation[30] that may\nimpact future variants.\n\nDarkSide\nThe actors behind DarkSide\ninitially distributed REvil\nransomware but grew tired\nof sharing the profits with the\nREvil ransomware-as-a-service\n(RaaS) operator, so decided to\ncreate their own ransomware.[31]\nThe DarkSide ransomware has\nbeen used to target a wide\nvariety of organizations across\nNorth America and Europe.\nMost famously, the U.S. fuel\ndistribution company, Colonial\nPipeline, was held ransom by\nDarkSide, dramatically affecting\ngasoline distribution on the East\nCoast.[32] DarkSide initially targeted\nWindows hosts but quickly\nevolved to include Linux targets—\nand in particular, those running on\nESXi servers.[33] These servers are\nusually targeted after the threat\nactors gain access to a VMware\nvCenter® deployment, often by\nmeans of stolen credentials.\n\n|on ext e t e a e v ni in co tic tat ati e ry|m or o i tta ic t a g t ve s ic on bin pti|en tio nc ck tim na he re of t inf o ar on|ts n en er ’s lyz ir d i he or f s ies in|in sc t t le re e ev s i r m he . a|vol he he ak pu d n olu ncl an ati ll s Bin ra|ve me vi s t ta in tio ud so on cri ar ns|e . cti he tio e r n ed mw ex pt ies om|xfil Ess m i in n.9 an an in a tr s, a w|tra en nt for so d t re act Py re ar|tin ti o p m m cro he sa ed th us e a|g ally a ati wa ss si mp fr on ua tt|da , t yin on re - de le om lly ack|ta he g , ba s o th .|, r. f e|Col16|l|Ra RE Th kn tar rel 20 rel in vir en pr VM be tak|ns vil e ow ge ea 21. ies e t tua cry ev s. en e-|o RE n te se 29 o oo l pt ent R ta do|m vil as d d a Int n t l t ma s t th ec rg w|wa ra So Wi L er he o s ch he e en et n o|re ns di nd in est e to in ir re tly ed p|fa om no ow ux in sxc p t es on co , R by era|m w ki s ve gly li he (V -d ve Ev a tio|ilie ar bi, ho rsi , t co c Ms isk ry il co n3|s e, or sts on his m urr ). im of act or 0 t|als igi , b in th ma en It t a ru or di ha|o na ut sp re nd t E he ge nn s h na t m|lly ri at - SX n s t ing av ted a|ng i o e y|Col32|Col33|Col34|Col35|\n|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|\n\n\n-----\n\n|Col1|Col2|1 0 0|.0 .8 .6|Col5|Col6|Col7|Col8|Ra Bla Bla an ran act su the ve|ns ck ck ev so or re y rtic|o M M ol m s b to we al|m at att uti wa e pu re s,|wa ter er on re hin bl n su|re is of .34 d icl ot ch|fa co th In Bla y a tar as|m ns e te ck nn ge h|ilie id Da res M ou tin eal|s ere rk tin att nc g th|d Si gl er e sp car|de y, m th ec e,|th ad at ific|e e|Col23|Col24|Col25|Col26|\n|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|\n\n\n**Figure 1: Code similarity between ransomware samples, based on telfhash (lighter color/lower**\ndistance corresponds to higher similarity).\n\nFrom the confusion matrix in Figure 1, it is clear that samples that belong to the\nsame family have a strong telfhash similarity. This indicates that one can build an\neffective classification system using telfhash. However, in some cases, the\nsimilarities diminish as time passes, showing that evolution within a family might\nlead to new code being introduced—possibly invalidating signatures developed\nfor early versions of a threat.\n\nFrom the graph, we see how DarkSide and BlackMatter samples share\nsubstantial portions of code, and that ViceSociety shares some code fragments\nwith REvil. This accounts for the relationship between threats that have been\nhighlighted in previous reports.\n\nTo further characterize the relationships between families of ransomware, we\ndeveloped a similarity measure that leverages the term frequency–inverse\ndocument frequency (TF-IDF) algorithm applied to the hashes of the strings\ncontained in the samples. This allows us to find the strings that best\ncharacterize each family. The confusion matrix in Figure 2 is based on the\ncosine similarity computed over the TF-IDF values for each string in the\nransomware dataset we analyzed.\n\n\nBlackMatter\nBlackMatter is considered\nan evolution of the DarkSide\nransomware.[34] Interestingly, the\nactors behind BlackMatter made\nsure to publicly announce that\nthey were not targeting specific\nverticals, such as healthcare,\noil and gas, government, and\ncritical infrastructure companies—\npossibly following the backlash\nthat the Colonial Pipeline attack\ncreated, and the unwanted\nattention that the DarkSide\noperators received.\n\nDefray777\nDefray ransomware is another\nLinux-based threat that targets\nESXi VMs.[35] An interesting\nproperty of some of its samples\nis that it doesn’t strip or tamper\nwith ELF binaries, which\nmakes it easier to analyze. This\nransomware family is closely\nrelated to RansomEXX[36]—to the\npoint that sometimes the two\nfamilies are considered to be\nvariations of the same threat.\n\n\n-----\n\n|Col1|Col2|Col3|1.0 0.8 0.6|Col5|Col6|Col7|Col8|Ra He Th ran no att ma vid of|ns llo e a so tor ac ke eo a|o Ki ct m ie kin rs g Wi|m tty or wa ty g of am nd|wa s b re aft CD th e. ow|re eh h er P e It s-|fa in av su ro Cy ’s ba|m d e a cc je be an se|ilie He ch es kt rp oth d t|s llo ie sfu Re un er hr|Kit ve lly d, k e ea|ty d th 20 xa t|e 77 mp|le|Col23|Col24|Col25|Col26|\n|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|\n\n\n**Figure 2: Similarity among ransomware samples based on TF-IDF applied to string hashes**\n(lighter color/lower distance corresponds to higher similarity).\n\nThe use of string hashes for similarity shows that, in some cases, strings are\nbetter than telfhash to capture similarity among samples. For example, the REvil\nfamily is better characterized using this technique instead of relying on telfhash.\n\nThe use of the TF-IDF algorithm over the strings in the samples provides an\nopportunity for the creation of YARA rules for the identification of samples. We\nevaluated the YARA rules generated using our corpus of ransomware samples\nfound running on Linux-based systems against the samples in the benign\ndataset, and we obtained a very low 0.01 percent false positive rate.\n\nAnother interesting way to characterize Linux-based ransomware threats is to\nlook at the directories they avoid during the encryption process. For example,\nthe /proc file system is a pseudo-file system that provides access to kernellevel information, using a file system-like interface. Attempting to encrypt the\nfiles under this directory could create an unstable system, jeopardizing the\nattack. The same issue is true for other directories, such as /bin, /usr/bin,\nand /lib, so they are explicitly avoided by ransomware targeting\nLinux-based systems.\n\n\nHelloKitty\nThe actors behind HelloKitty\nransomware have achieved\nnotoriety after successfully\nattacking CD Projekt Red, the\nmakers of the Cyberpunk 2077\nvideo game. It’s another example\nof a Windows-based threat\nthat evolved and expanded\ninto the Linux world, targeting\nLinux-based systems and ESXi\nservers.[37] Like other samples\nthat target ESXi VMs, HelloKitty\nuses the esxcli tool to stop the\nVMs currently running before\nencrypting their files.\n\nViceSociety\nThe actors behind ViceSociety\nransomware are believed to have\nbroken away from the HelloKitty\ngroup. Not surprisingly, their\nmalware shows substantial\nsimilarities with the HelloKitty\nransomware. This ransomware\nfamily was responsible for\nattacking the United Health\nCenters in the San Joaquin Valley\nin California, among other targets,\nwhich resulted in the leaking of\nsensitive patient records.[38]\n\n\n-----\n\nWe also looked at other paths that could indicate the use of specific tools as part\nof the attack. Most notably, the /sbin/esxcli command is used in ESXi\nenvironments to shut down existing virtual workloads so their on-disk images\ncan be encrypted. Therefore, the presence of a reference to this tool is likely an\nindication of ransomware-like behavior.\n\n###### Characterizing behavior\n\nWe used CAPA[11] to detect the capabilities of the Linux-based ransomware\nsamples. Figure 3 shows the typical behaviors detected by CAPA aligned to the\nMITRE ATT&CK tactics and techniques framework. As we see from Figure 3,\ndefense evasion is the most common tactic used in the samples. We also found\nvarious encryption or obfuscation techniques, such as Base64 encoding and\nAES-based encryption, used by the attacks to hide their code and data.\n\nDefense Evasion::Obfuscated Files or Information\n\n                             - T1027.005, 59.1% (220)\n\nDiscovery::System Information Discovery - T1082,\n18.0% (67)\n\nDefense Evasion::Deobfuscate/Decode Files or\nInformation - T1140, 10.8% (40)\n\n\nGonnaCry\nGonnaCry is an open source\nransomware sample written in C\nand Python.[40] While the Python\nversion is mostly used as a way to\nshowcase some of the behaviors\nassociated with ransomware,\nthe C version has actually been\nobserved in the wild.\n\neCh0raix\neCh0raix ransomware targets\nQNAP network-attached\nstorage (NAS) devices with\nweak credentials.[41] This family\nis written in the Go language,\nand its features are simpler than\nother ransomware families. For\nexample, it appears that this\nthreat does not have a way to\ndistinguish among victims.[42]\n\n|cat l ork a th s wo se, s o h ens 027|e t i c lo re e det rk d i uc id e E .00|he o ad fer Lin ec . n h e t vas 5,|u mm s s en ux te As the as he ion 59.|se a o t ce -b d w s Ba ir ::O 1%|of nd he to as by e s am se co bfu (22|sp is ir t ed C ee pl 64 de scat 0)|e us on his ra AP fr es e a ed|cifi ed -d to ns A om . nc nd File|c t in isk ol o ali F We od d s o|oo E i is mw gn ig al in ata r In|ls SX ma lik ar ed ur so g a . for|as i ge ely e to e 3 fo n mat|pa s a t, un d ion|rt n he d|Col16|i|Ra Er Er ra tar ev Lin un na the the nt so ra|ns eb eb ns ge olv ux iq tur r ir er me ns|o us us om te ed v ue e. an ac est b om|m is w d i ari be W so tiv in eh w|wa a are Wi n 2 an ca hi m ity g s av are|re rel f nd 01 t.3 us le wa, i a io f|fa ati am o 6 9 T e th re t is mp rs am|m ve ily ws to hi of e a ha s le wi ili|ilie ly . I ho in s t its ct ve till th th es.|s ol t in st clu hr m or s an at ot|de iti s de ea ul s b to sh he|r all bu a t is tili eh pp ar r|y t ng in ed es|ua d|l|Col33|Col34|Col35|\n|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|\n\n\n(A)\n\n(B)\n\n\nDiscovery::File and Directory Discovery - T1083,\n8.1% (30)\n\nExecution::Shared Modules - T1129, 1.6% (6)\n\nDiscovery::System Network Configuration\nDiscovery - T1016, 1.3% (5)\n\nDefense Evasion::Virtualization/Sandbox Evasion T1497.001, 1.1% (4)\n\nbase64, 25.0% (55)\n\naes, 22.3% (49)\n\nxor, 20.5% (45)\n\nrc4 prga, 17.7% (39)\n\nsosemanuk, 7.3% (16)\n\nsalsa20 or chacha, 3.6% (8)\n\nstackstrings, 3.6% (8)\n\n\n**Figure 3: Malicious behaviors of the ransomware samples in the dataset: (A) Typical MITRE**\nATT&CK tactics and techniques leveraged by the samples; (B) Various encryption/obfuscation\ntechniques used for defense evasion.\n\n\n-----\n\n###### Detecting and mitigating the threat\n\nThe solution to the ransomware threat is a combination of approaches,\nmechanisms and policies. Beyond having a solid data backup and recovery\nprocess, deploying an EDR solution that monitors the actions performed by\nprocesses on cloud workloads is critical to a defense-in-depth strategy. This\nmust be complemented by an effective segmentation and NDR system that can\nrecognize network-based evidence of attacks and ideally block the malware\nbefore it can take hold of the target hosts.\n\n###### Cryptominers\n\nCybercriminals are not indifferent to the frenzy surrounding cryptocurrencies. The\nadvantage of targeting cryptocurrencies is that successful attacks can be\nimmediately and directly turned into cyber cash. Cybercriminals get instant reward\nwithout the need to perform cumbersome scams using stolen information, such as\npersonal data, or by having to interact with victims of ransomware.[12]\n\nAttacks targeting cryptocurrencies typically take one of two approaches. The first\nis to include wallet-stealing functionality in malware, sometimes posing as\ncryptocurrency-based applications.[13] The second is to monetize stolen CPU cycles\nto successfully mine cryptocurrencies, sometimes called cryptojacking. One of\nthe first cryptojacking attacks was against Tesla’s public cloud[14]—a Kubernetes\ndeployment was hijacked and dedicated to mining the currency, while the\ncomputational costs were paid by Tesla. This notorious event was just the first in\na series of incidents that targeted the CPU cycles of cloud environments. A report\nfrom Palo Alto Networks[15] indicated that cryptojacking affected “at least 23\npercent of organizations that maintain cloud infrastructures.”\n\nMonero is the coin of the realm\n\nMost cryptojacking attacks focus on mining the Monero currency, also known as\nXMR. Monero is an attractive target because it is known for preserving the\nprivacy of its users, thanks to its use of Ring Confidential Transactions (RingCT),\nwhich hides the amount of each transaction, and stealth addresses that make\ntransactions much more difficult to trace.[16]\n\nAnother driver behind the popularity of Monero among cryptojacking operators\nis the fact that it can be mined without needing specialized hardware. This\ndiffers from mining Bitcoin, which requires specific hardware, such as\napplication-specific integrated circuits (ASICs), that can cost thousands of\ndollars.[17] With Monero, cryptominers can simply use the CPU or GPU cycles of\nordinary computers, making compromised cloud workloads suitable for mining\nthis cybercurrency.\n\n\nSysrv\nSysrv is a botnet written in Go\nwith cryptomining capabilities[44]\nthat has been recently deployed\nagainst Kubernetes pods running\nWordPress.[45] The actors behind\nSysrv rely on shell scripts to\nobtain persistency and hide\nthe presence of the miner\n(e.g., by providing a modified\nversion of the top command\nthat doesn’t show the CPUhungry processes). This threat\nhas also worm-like capabilities,\nattempting to spread to different\nhosts by leveraging SSH keys\nfound on compromised hosts,\nperforming password dictionary\nattacks against vulnerable\nservices, and using an everincreasing database of exploits\nagainst known remote code\nexecution (RCE) vulnerabilities.\n\n|mb olid ito ef en a s t s h. ms|in d rs en tat nd urr uc Cy u|ati at th se io id ou ce be sin|on a b e a -in n a ea nd ssf rc g|o ac ct -d nd lly in ul rim sto|f a ku ion ep N bl g c att in le|pp p s th D oc ry ac al n i|ro an pe st R s k t pt ks s g nfo|ac d rfo rat ys he oc ca et rm|he rec rm eg te m urr n in at|s, ov e y. m al en be sta io|er d b T th wa cie nt n,|y y his at re s. re su|ca Th wa ch|n e rd as|Col16|Col17|Cr XM XM av ma a t co as to oft cry pr ca sp|yp R Ri ail c hr mp pa pe en pt efe n b eci|to ig g4 abl OS eat o rt rfo u oc rr e ali|m 3 is e f . W b ne of rm se ur ed mi ze|in a or h y i nt cr t d t re ta ne d|er n o W ile tse is yp he o ncy rg d har|fa p in th lf, oft toj m min , et wit d|mi en do is a en ac ini e wh be ho wa|lie so ws mi va d kin ng th ich ca ut re.|s ur , L ne ria ep g . X e is us n|ce in r is nt loy att M Mo th e i ee|m ux n of ed ac Ri ne e t din|in an ot thi ks g i ro g|er d s s|Col32|Col33|Col34|Col35|\n|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|\n\n\n-----\n\nXMRig\n\nThe most common application used to mine Monero currency is the open\nsource XMRig miner.[18] This popular application can mine different types of\ncryptocurrencies, but it’s mostly used to mine Monero. Many of the cryptomining\nsamples from Linux-based systems have some relationship to the XMRig\napplication. Therefore, when XMRig-specific libraries and modules in Linux\nbinaries are identified, it is likely evidence of potential cryptomining behavior.\n\nIf a binary is dynamically linked and not stripped, the task of identifying XMRigrelated libraries and modules is trivial. However, stripped, statically linked binaries\nare challenging to analyze. In Table 1, we noted that all the cryptominers in our\ndataset are stripped. As a result, we needed to use function signature models,\nsuch as the ones produced by FLIRT,[19] to identify known libraries in C/C++\nbinaries, and tools, such as redress[20] to identify relevant modules in Go binaries.\n\nWe developed FLIRT signatures for the libraries used by XMRig when compiled\non various Linux distributions. We also developed Go module detectors to\nidentify relevant crypto-related modules.\n\nWhen we checked for the presence of these components (written in both C/C++\nand Go), we found that 89 percent of cryptomining attacks used XMRig-related\nlibraries. None of the benign Linux binaries linked those components, making\nthe presence of these libraries and modules an effective way to identify\ncryptomining behavior.\n\nMining pools\n\nWhen a cryptomining program is deployed on a compromised host, the program\nconnects to a mining pool. By joining a mining pool, the malware can contribute\nto the overall mining process and share the benefits of collective mining—the\ncomputing power of a single host would likely be insufficient to achieve any\nmeaningful results. Some common, well-known mining pools are minexmr[.]com,\nnanopool[.]com, and supportxmr[.]com.\n\n\nMexalz\nMexalz threat actors are likely\n[based in Romania,[48] exploiting](https://www.bitdefender.com/blog/labs/how-we-tracked-a-threat-group-running-an-active-cryptojacking-campaign)\nweak credentials to compromise\nhosts and deploy cryptomining\nmalware, which is mostly\ncustomized versions of XMRig.[49]\nThe name of this threat is derived\nfrom the host that they use to\nstore the components of the\nattacks, mexalz[.]us.\n\n## 89%\n##### of cryptomining attacks used XMRig-related libraries\n\n|Mo n M e r lib pot ed, r, d t o u tify y r ies|ne ca on el rar en th str ha se k ele u|ro n m er ati ie tia e t ip t a fu no va se|cu in o. on s a l c as pe ll t nc wn nt d b|rr e M sh nd ry k d, he tio li m y|en dif an ip m pt of i sta cr n s bra od XM|cy fer y to od om de tic yp ig rie ul R|is en of t th ul in nt all to na s es ig|th t t he e X es in ifyi y l mi tur in in wh|e o yp c M in g b ng ink ne e C/ Go e|p es ry Ri Li eh X e rs mo C+ b n c|en o pto g nu av M d b in d + ina om|f m x io Rig in ou els ri p|ini r. - ari r , es. ile|ng es d|Col16|l|Cr Te Te op Do XM de ib sp file wit cry Me Me|yp am am en ck Ri te rar eci s h pt xa xa|to T T K er g cti y l fic yst the om lz lz|m NT NT ub de cry on, oa di em p in th|in th er pl pt th di re , ro er rea|er re ne oy om is ng cto wh ce s.4 t|fa at tes m in th m ri ic ss 7 act|mi ac p en er re ec es h a es or 4|lie tor od ts s.4 at ha in re ru s a 8|s s t s to 6 T hij nis th as nn re|ar an de o ac m e / so ing lik|ge d pl ev ks to pr cia t el|t oy ad th hi oc te he y|e e de d|Col32|Col33|Col34|Col35|\n|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|\n\n\n-----\n\nIn Table 1, we show the cryptomining pools associated with the families analyzed\nin this report.\n\n\nMining Pool Port Family Note\n\n\n194.145.227[.]21 5443 Sysrv Proxy\n\n80.211.206[.]105 6666 WatchDog Private pool\n\nmonerohash[.]com Mexalz, TeamTNT, XMRig Public pool\n\nmoneroocean[.]stream TeamTNT Public pool\n\npool.hashvault[.]pro XMRig Public pool\n\npool.minexmr[.]com 5555 Sysrv Public pool\n\npool.supportxmr[.]com 443 Mexalz, TeamTNT Public pool\n\nxmr-eu1.nanopool[.]org 14444 Sysrv Public pool\n\nxmr-eu2.nanopool[.]org 14444 Sysrv, WatchDog Public pool\n\nxmr.f2pool[.]com 13531 Sysrv, WatchDog Public pool\n\nxmr.pool.gntl[.]co.uk 40009 WatchDog Public pool\n\n\nWatchDog\nWatchDog represents one of the\nlongest running cryptomining\noperations.[51] The name of this\nthreat, which is written in Go,\nis derived from the presence\nof a component that is tasked\nto monitor the execution of the\nactual cryptomining program,\nsimilar to the Linux utility\n“watchdog.” This operation has\nbeen running for more than two\nyears, starting in January 2019,\ntargeting both Windows and\nLinux hosts.\n\nKinsing\nThreat actors behind the Kinsing\ncryptominer family are known\nto target vulnerable containerbased deployments.[52] More\nspecifically, the attack exploits\nDocker API endpoints that are\nopen to the world to download\nand install a number of shell\nscripts that aid in persistence and\nlateral movement, and ultimately\nlead to the download of a\ncryptomining component.\n\n|Col1|so|ci|ate|d|wi|th|th|e f|am|ili No Pro|es te xy|an|al|yz|ed|Col17|l|Cr O O wo vul an ve oth rel ho W W on op thr|yp me me rm ne d rsi er ati sts atc atc g er ea|to let let t ra Co on s on ” h hD est ati t,|m te te5 ha bil nfl s o yst sh SS Do o ru on wh|in 0 i t e itie ue f X em ip H g g r nn s.5 ic|er s a xp s nc M s s ( co ep in 1 T h i|fa cr loi in e t Ri by e.g nfi re g he s w|mi yp ts Ex o i g. e ., g f se cry n rit|lie to kn im ns It xpl th ile nt pt am te|s mi ow, W tal spr oit e “ ). s o om e n i|ni n e l m ea in kn ne in of n|ng bL o ds g t ow o in thi Go|og dif to ru n f t g s,|ic ied st _ he|Col33|Col34|Col35|Col36|\n|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|\n|.211.206[.]105 6666 WatchD onerohash[.]com Mexalz,|og Te|am|TN|T,|X|MR|ig|||Pri Pu|vat blic|e p p|oo ool|l||||||||||||||||||||||\n|oneroocean[.]stream TeamTN|T|||||||||Pu|blic|p|ool|||||||||||||||||||||||\n|ol.hashvault[.]pro XMRig||||||||||Pu|blic|p|ool|||||||||||||||||||||||\n|ol.minexmr[.]com 5555 Sysrv||||||||||Pu|blic|p|ool|||||||||||||||||||||||\n|ol.supportxmr[.]com 443 Mexalz,|Te|am|TN|T||||||Pu|blic|p|ool|||||||||||||||||||||||\n|r-eu1.nanopool[.]org 14444 Sysrv||||||||||Pu|blic|p|ool|||||||||||||||||||||||\n\n\n**Table 1: Mining pools observed in the analyzed cryptominers.**\n\n\n-----\n\nIn Table 2, we show the wallets that the analyzed cryptominers used to collect the mined currency. Even\nthough these wallets can be used to identify relationships between different campaigns, the anonymous and\ntransient nature of these indicators is a real barrier to meaningful tracking and attribution.\n\n\nMonero Wallet Address Family Note\n\n\n428uyvSqdpVZL7HHgpj2T5SpasCcoHZNTTzE3Lz2H5ZkiMzqayy19sYDcBGDCjobTfLBnc3t­\nc9rG4Y8gXQ8fJiP5tqeBda\n\n43Xbgtym2GZWBk87XiYbCpTKGPBTxYZZWi44SWrkqqvzPZV6Pfmjv3UHR6FD­\nwvPgePJyv9N5PepeajfmKp1X71EW7jx4Tpz\n\n43zqYTWj1JG1H1idZFQWwJZLTos3hbJ5iR3tJpEtwEi43UBbzPeaQxCRysdjYTt dc8aHao7csi­\nWa5BTP9PfNYzyfSbbrwoR\n\n49dnvYkWkZNPrDj3KF8fR1BHLBfiVArU6Hu61N9gtrZWgbRptntwht5JUrXX1ZeofwPw­\nC6fXNxPZfGjNEChXttwWE3WGURa\n\n4BrL51JCc9NGQ71kWhnYoDRffsDZy7m1HUU7MRU4nUMXAHNFBEJhkTZV9H­\ndaL4gfuNBxLPc3BeMkLGaPbF5vWtANQn3gTBhyMDeJJJSvog\n\n82etS8QzVhqdiL6LMbb85BdEC3KgJeRGT3X1F3DQBnJa2tzgBJ54bn4aNDju­\nWDtpygBsRqcfGRK4gbbw3xUy3oJv7TwpUG4\n\n85X7JcgPpwQdZXaK2TKJb8baQAXc3zBsnW7JuY7MLi9VYSamf4bFwa7SEAK­\n9Hgp2P53npV19w1zuaK5bft5m2NN71CmNLoh\n\n87q6aU1M9xmQ5p3wh8Jzst5mcFfDzKEuuDjV6u7Q7UDnAXJR7FLeQH2UY­\nFzhQatde2WHuZ9LbxRsf3PGA8gpnGXL3G7iWMv\n\n88ZrgnVZ687Wg8ipWyapjCVRWL8yFMRaBDrxtiPSwAQrNz5ZJBRozBSJrCYffurn1Qg7Jn­\n7WpRQSAA3C8aidaeadAn4xi4k\n\n|Col1|ze el arr H|d c ati ier 5Zk|ry on to iM|pt shi m zq|om ps e ay|in b ani y19|er et ng sY|s u we fu Dc|se en l tr BG|d t di ac DC|o ffe ki jo|co re ng bTf|lle nt an LB|ct ca d nc|th m att 3t­|e m pa rib|in ign ut|ed s, io Fa Te|c th n. mi am|urr e ly TN|en an T|cy on|. ym|Ev o N|en us ote|an|d|Col29|Col30|Col31|Col32|Col33|Col34|Col35|Col36|\n|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|\n|Xbgtym2GZWBk87XiYbCpTKGPBTxYZZWi44S vPgePJyv9N5PepeajfmKp1X71EW7jx4Tpz zqYTWj1JG1H1idZFQWwJZLTos3hbJ5iR3tJpEtw a5BTP9PfNYzyfSbbrwoR|Wr Ei|kq 43|qvz UB|PZ bz|V6 Pe|Pf aQ|mj xC|v3U Ry|H sdj|R6 YT|FD t d|­ c8a|H|ao7|csi|­||Wa Wa|tc tc|hD hD|og og|||Ac|tiv|e||||||||||\n|dnvYkWkZNPrDj3KF8fR1BHLBfiVArU6Hu61N9 fXNxPZfGjNEChXttwWE3WGURa|gtr|ZW|gb|Rp|tn|tw|ht5|JU|rX|X1Z|eo|fw|Pw|­||||Sys|rv|||||||||||||||||\n|rL51JCc9NGQ71kWhnYoDRffsDZy7m1HUU7MR|U4|nU|MX|A|HN|FB|EJ|hk|TZ|V9|H­|||||||Me|xal|z||||Ac|tiv|e||||||||||\n\n\nSysrv,\nWatchDog\n\nTeamTNT\n\nWatchDog\n\nTeamTNT\n\n\nActive\n\n\n**Table 2: Monero wallet addresses observed in the analyzed cryptominers.**\n\n\n-----\n\nInterestingly, at the time of writing, the Monero wallet address 82etS8QzVh…3oJv7TwpUG4 was actively\nmining on xmr.nanopool[.]org, as shown in Figure 4.\n\n**Figure 4: Current cryptomining operation on xmr.nanopool.org.**\n\nEven more interesting, the first payment was made in October 2020, more than a year ago (see Figure 5). This\nshows how long-lasting and difficult it is to eradicate these mining operations.\n\n**Figure 5: History of payments to the cryptominer’s Monero wallet.**\n\n###### Characterizing similarity\n\nWe used both telfhash and our TF-IDF-based metric to characterize the similarity across the analyzed\ncryptominer families; the findings are shown in Figure 6. Because many of the cryptominers were packed,\nthe analysis produced very poor results. For example, the similarity among samples of the Sysrv family was\nnot captured.\n\n|ro igu|w re|alle 4|t .|ad|dr|ess|8|2e|tS|8Q|zV|h|…3|oJ|v7|Tw|p|UG|4|wa|s a|ct|ive|ly|Col26|Col27|Col28|Col29|Col30|Col31|Col32|Col33|Col34|Col35|\n|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|\n\n\n-----\n\n**Figure 6: Code-based and string-based similarity between cryptominer samples (lighter color/lower distance corresponds to higher**\nsimilarity).\n\nApplying dynamic analysis makes it possible to unpack most of the samples, and Figure 7 shows the code and\nstring similarity between samples after the unpacking process. The confusion matrix shows how some clusters\nof samples are clearly identifiable and how the samples evolve over time (see, for example, the various Sysrv\nfamily clusters). The results also show that, while telfhash is considered the state of the art for code similarity\namong ELF files, TF-IDF, which looks for similarity based on string hashes, provides a more useful\ncharacterizing metric.\n\nApplyistring omelette_0eaa4omelette_e2964omelette_71604watchdog_d5415watchdog_ed1e4watchdog_6f282kinsing_af3cckinsing_dd603kinsing_63643teamtnt_78f92teamtnt_a22c2teamtnt_d5870teamtnt_acbb4mexalz_dcc52mexalz_ed2aemexalz_b7a5emexalz_7c3a8mexalz_7edffsysrv_62ba6sysrv_18bc0sysrv_7e765sysrv_5f809sysrv_8bc38sysrv_40d2asysrv_afb6esysrv_17fbcsysrv_d5ce8sysrv_b8fe2sysrv_322ccsysrv_59737sysrv_72483sysrv_c42e5sysrv_6750esysrv_21f57sysrv_8f921sysrv_47183sysrv_3e66bsysrv_e627asysrv_2d5desysrv_d3196sysrv_ba469sysrv_6eaabsysrv_3bcbdsysrv_f487bsysrv_f640csysrv_77a9fsysrv_feb38sysrv_61e35sysrv_875f0sysrv_d93afsysrv_9df43sysrv_658bdsysrv_d5086sysrv_46276sysrv_a392asysrv_427ccsysrv_2d9c1sysrv_1ebfdsysrv_63162sysrv_35213sysrv_8c8eesysrv_f8472sysrv_d429asysrv_0cca2sysrv_f425fsysrv_dfeafsysrv_6ed86sysrv_0d3b0sysrv_1a7besysrv_ba518sysrv_896fdsysrv_0bca3xmrig_a34aexmrig_7579fxmrig_ee4a1xmrig_ef11cxmrig_b2e51xmrig_e7f40xmrig_6abddxmrig_1489cxmrig_42834xmrig_3d2e8xmrig_4484axmrig_cd37fxmrig_f72baxmrig_b1a5axmrig_65296xmrig_eb108xmrig_75253 similarity between samples after the unpang dynamic analysis makes it possible to unpack most ocking1.00.80.60.40.20.0 process.omelette_0eaa4omelette_e2964omelette_71604watchdog_d5415watchdog_ed1e4watchdog_6f282kinsing_af3cckinsing_dd603kinsing_63643teamtnt_78f92teamtnt_a22c2teamtnt_d5870teamtnt_acbb4mexalz_dcc52mexalz_ed2aemexalz_b7a5emexalz_7c3a8mexalz_7edffsysrv_62ba6sysrv_18bc0sysrv_7e765sysrv_5f809sysrv_8bc38sysrv_40d2asysrv_afb6esysrv_17fbcsysrv_d5ce8sysrv_b8fe2sysrv_322ccsysrv_59737sysrv_72483sysrv_c42e5sysrv_6750esysrv_21f57sysrv_8f921sysrv_47183sysrv_3e66bsysrv_e627asysrv_2d5desysrv_d3196sysrv_ba469sysrv_6eaabsysrv_3bcbdsysrv_f487bsysrv_f640csysrv_77a9fsysrv_feb38sysrv_61e35sysrv_875f0sysrv_d93afsysrv_9df43sysrv_658bdsysrv_d5086sysrv_46276sysrv_a392asysrv_427ccsysrv_2d9c1sysrv_1ebfdsysrv_63162sysrv_35213sysrv_8c8eesysrv_f8472sysrv_d429asysrv_0cca2sysrv_f425fsysrv_dfeafsysrv_6ed86sysrv_0d3b0sysrv_1a7besysrv_ba518sysrv_896fdsysrv_0bca3xmrig_a34aexmrig_7579fxmrig_ee4a1xmrig_ef11cxmrig_b2e51xmrig_e7f40xmrig_6abddxmrig_1489cxmrig_42834xmrig_3d2e8xmrig_4484axmrig_cd37fxmrig_f72baxmrig_b1a5axmrig_65296xmrig_eb108xmrig_75253 f the samples, and Figure 7 shows the code and 1.00.80.60.40.20.0\n\n**Figure 7: Code-based and string-based similarity between cryptominer samples after unpacking (lighter color/lower distance**\ncorresponds to higher similarity).\n\n|Col1|1.0 0.8 0.6 0.4 0.2 0.0|oookkk mmmmmmmmiii eee wwwttttaaaeeeettt|xxxxxxxxxxxxxxxxxeeeeennn mmmmmmmmmmmmmmmmmxxxxxsss rrrrrrrrrrrrrrrrraaaaaiii iiiiiiiiiiiiiiiiilllllnnn gggggggggggggggggzzzzzggg _________________________ a7eebe61434cfb6e7deb77ad6 aaaalll mmmmeee ttttttt nnnnttt tttteee _______ 7ada0e7 ssssssssssssssssssssssssssssssssssssssssssssssssssssss cccyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyy hhhssssssssssssssssssssssssssssssssssssssssssssssssssssss dddrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrr ooovvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvv ggg______________________________________________________ ___16789d1bd0b97567a1beddb98f152482175c98479d90081c3521a5 de6|35ef27a42d4d715b5cd7cefd3 4741efb882832a212c2a3d366 a9a154d93e47b59055a5afc04 ef1c10dc48afaa6832ee8fc33 82dce21 f28ba96 9c0ba60 2234444 a723dd3cdcec2f7a9df643ab24822f49cf4559d97e44b1b7aff6ff 5df6f05858b31a945559d22214228a0ed869f45fb681c5c6e2e61a37c 41230335b4013ab8d0492c709603788f3ed15d79ced06c10591bd5ec4 1e8f348b472bb0735e6dc4a96921b7c97d3ef20f85162df3b03718f5c 542 oookkk mmmmmmmmiii eee ssssssssssssssssssssssssssssssssssseeeeennn lll yyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyxxxxxsss eee sssssssssssssssssssssssssssssssssssaaaaaiii ttt rrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrlllllnnn ttt vvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvzzzzzggg eee ___________________________________________ ___ 571284251f89bddeb1a76579b0db1d9876177bed6da 7e0 4fc94f22842ba346fd9a7f2cecdc3dd327aec7dc3df 12e 4f968de0a82241222d955549a13b85850f6d3a2c663 69a d51de3f887306907c2940d8ba3104b53303fa5a540c 06a 2fe3d79c7b12969a4cd6e5370bb274b843ff8ee233c 444|aaaa mmmm tttt nnnn tttt ____ ada7 cd28 b82f b0c9 4322 wwwtttt aaaeeee ttt ccc hhh ddd ooo ggg ___ 6ed fd5 214 8e1 245 xxxxxxxxxxxxxxxxxsssssssssssssssssss mmmmmmmmmmmmmmmmmyyyyyyyyyyyyyyyyyyy rrrrrrrrrrrrrrrrrsssssssssssssssssss iiiiiiiiiiiiiiiiirrrrrrrrrrrrrrrrrrr gggggggggggggggggvvvvvvvvvvvvvvvvvvv ____________________________________ 7e6bfc43416ebee7a5a1253c18009d97489c 5b517d4d24a72fe53ff6ffa7b1b44e79d955 212a238288bfe1474c73a16e2e6c5c186bf5 5095b74e39d451a9a4ce5db19501c60dec97 386aafa84cd01c1fec5f81730b3fd26158f0|Col7|1.0 0.8 0.6 0.4 0.2 0.0|Col9|Col10|Col11|Col12|Col13|Col14|Col15|Col16|\n|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|\n|||||||||||||||||\n\n\ne and\n\n\n-----\n\nWhen we ordered the samples by similarity, not by\ntime, the clusters became even more evident, as\nshown in Figure 8. In particular, the similarity\nbetween some TeamTNT samples, Mexalz and\nXMRig, as well as the similarities between WatchDog\nand XMRig, are clearly emphasized.\n\nIn addition to unpacking the cryptominer samples,\n[we also monitored their execution in our sandbox.](https://blogs.vmware.com/networkvirtualization/2021/12/introducing-darth-distributed-analysis-for-research-and-threat-hunting.html/)\nWe found that a subset of the samples was\nde-obfuscating and executing additional code at\nruntime. We extracted these code fragments and\nanalyzed their similarity against the model we built\nfor the existing cryptominers. Note that the similarity\nis based only on the strings. The dynamically\ngenerated code is not in ELF format, therefore\ntelfhash cannot be applied. This further shows that\nTF-IDF analysis on strings is an effective and flexible\napproach with wider applicability than telfhash.\n\nThe results of the analysis are shown in Figure 9. It\nshows that the generated code has a few clusters\nthat represent small variations of the deployed code.\n\n|not, a d tc|b s hD|y og|Col4|Col5|Col6|Col7|1.0 0.8 0.6 0.4 0.2 0.0|Col9|Col10|kkkmmmmmtwxxxxxxtxxssssssssssssssssssssssssssiiieeeeeeammmmmmemmyyyyyyyyyyyyyyyyyyyyyyyyyynnnxxxxxatrrrrrrarrssssssssssssssssssssssssss|sssaaaaamciiiiiimiirrrrrrrrrrrrrrrrrrrrrrrrrriiilllllthggggggtggvvvvvvvvvvvvvvvvvvvvvvvvvvnnnzzzzznd______n____________________________ggg_____toee61e4tbc5c62842d963e3f7f686d4a601b___deb77_gefa474_1d9471f7d3dee6b67e175963edaaad6cd7ec7_41b8f8da3725f9151fa62c4abe58329d375fd3c2ad386a1d9445573e0528d94a67b0933fba728bb13665a5faff1cdc0a8af75e713e63bbadcf850df6a60e8|c042eef892c33 282 70|Col14|Col15|Col16|Col17|\n|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|\n||||||||||||||||||\n||||||||||||||||||\n\n\n**Figure 8: Cryptominers ordered based on string similarity (instead of**\nfamily and time), showing the dendrograms that cluster together similar\nsamples (lighter color/lower distance corresponds to higher similarity).\n\n1.0\n\n0.8\n\n0.6\n\n0.4\n\n0.2\n\n0.0\n\nomelette_43c22\n\nsysrv_e4e76\n\nteamtnt_d9e3b\n\nsysrv_97f95\n\nsysrv_255f8\n\nsysrv_980b8\n\nsysrv_56c64\n\nsysrv_b5ecc\n\nsysrv_d5407\n\nsysrv_9ec38\n\nsysrv_09783\n\nsysrv_6ee80\n\nsysrv_3141e\n\nsysrv_373c3\n\nsysrv_776d0\n\nsysrv_7b70e\n\nsysrv_e951b\n\nsysrv_0498d\n\nsysrv_e64f8\n\nsysrv_d0e1b\n\nsysrv_d13d3\n\nsysrv_96e62\n\nsysrv_e5732\n\nsysrv_a1bc5\n\nsysrv_fa72f\n\nsysrv_fe059\n\nsysrv_88d1d\n\nsysrv_f6f89\n\nsysrv_8d6d1\n\nsysrv_a5bb7\n\nsysrv_8627a\n\nsysrv_76d61\n\nsysrv_e9d5a\n\nsysrv_32aa0\n\nsysrv_e19b2\n\nsysrv_fde31\n\nsysrv_8d1b0\n\nsysrv_07ef1\n\nsysrv_08f6a\n\nsysrv_d27c1\n\nsysrv_3f199\n\nsysrv_e106e\n\nsysrv_64225\n\nteamtnt_03d7e\n\n**Figure 9: Similarity analysis of dynamically generated code.**\n\n\nkinsing_af3cckinsing_dd603kinsing_63643mexalz_dcc52mexalz_ed2aemexalz_b7a5emexalz_7edffmexalz_7c3a8teamtnt_78f92watchdog_6f282xmrig_ee4a1xmrig_ef11cxmrig_6abddxmrig_1489cxmrig_e7f40xmrig_4484ateamtnt_d5870xmrig_b1a5axmrig_cd37fsysrv_59737sysrv_c42e5sysrv_6750esysrv_21f57sysrv_8f921sysrv_47183sysrv_2d5desysrv_d3196sysrv_9df43sysrv_6eaabsysrv_3e66bsysrv_e627asysrv_3bcbdsysrv_f640csysrv_77a9fsysrv_feb38sysrv_61e35sysrv_875f0sysrv_658bdsysrv_d93afsysrv_46276sysrv_a392asysrv_6ed86sysrv_0d3b0sysrv_1a7besysrv_ba518sysrv_896fdsysrv_0bca3sysrv_427ccsysrv_2d9c1sysrv_1ebfdsysrv_63162sysrv_f8472sysrv_35213sysrv_8c8eesysrv_d429asysrv_0cca2sysrv_f425fsysrv_dfeafsysrv_d5086sysrv_62ba6sysrv_7e765sysrv_5f809sysrv_40d2asysrv_8bc38sysrv_afb6esysrv_17fbcsysrv_d5ce8sysrv_b8fe2sysrv_322ccsysrv_18bc0teamtnt_a22c2teamtnt_acbb4watchdog_d5415watchdog_ed1e4xmrig_a34aexmrig_65296xmrig_7579fxmrig_b2e51xmrig_42834xmrig_3d2e8xmrig_f72baxmrig_eb108xmrig_75253omelette_0eaa4omelette_e2964omelette_71604sysrv_72483sysrv_ba469sysrv_f487b\n\n\n-----\n\n###### Characterizing behavior\n\nWe also used CAPA to examine the behaviors of cryptomining samples. The malicious behaviors of the\ncryptomining samples are shown in Figure 10. Similar to the behaviors observed in the ransomware samples,\ndefense evasion is the most commonly used technique by cryptominers. In terms of the encryption methods\nassociated with defense evasion, it appears the techniques cryptominers use to obfuscate data are more\ndiversified (Figure 10 (B)) in comparison to the ransomware samples discussed earlier (Figure 3 (B)).\n\nDefense Evasion::Obfuscated Files or Information T1027.005, 57.6% (200)\n\nDiscovery::System Information Discovery - T1082,\n15.0% (52)\n\nDiscovery::System Network Configuration\nDiscovery - T1016, 6.9% (24)\n\n(A)\n\nExecution::Shared Modules - T1129, 6.3% (22)\n\nDefense Evasion::Deobfuscate/Decode Files or\nInformation - T1140, 5.5% (19)\n\nImpact::Resource Hijacking - T1496, 5.5% (19)\n\nDiscovery::File and Directory Discovery - T1083,\n3.2% (11)\n\n|s o . S te he e r|f c im ch te an|ry ila niq ch so De T10 Dis 15. Dis Dis Ex De Inf|pt r t u niq m fen 27 co 0% co co ecu fen orm|om o t e b ue wa se .00 ver (5 ver ver tio se ati|ini he y s re Eva 5, y::S 2) y::S y - n::S Eva on|ng b cry cry sa sio 57. yst yst T10 ha sio - T|s eh pt pt m n:: 6% em em 16, red n:: 114|am av o o ple Ob (20 In N 6. M De 0, 5|pl ior min min s fus 0) for etw 9% odu obf .5|es s er er dis cat mat ork (24 les usc % (1|. T ob s. s cu ed ion Co ) - T ate 9)|he ser In use ss File Di nfi 112 /D|m ve te t ed s o sco gur 9, eco|ali d rm o o e r In ver ati 6.3 de|ci in s bf arli for y - on % ( Fil|ou th of us er ma T1 22) es|s b e r th ca (F tio 082 or|eh an e e te ig n -,|av so nc da ur|io m ry ta e 3|rs wa pti ar (B|of re on e )).|th sa m mo|e m et re|ple ho|s, ds|Col28|Col29|Col30|Col31|Col32|Col33|Col34|Col35|\n|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|\n\n\n(B)\n\n\naes, 18.5% (37)\nbase64, 18.5% (37)\nrc4 prga, 10.0% (20)\nxor, 10.0% (20)\nrc4 ksa, 9.5% (19)\ncurve25519, 8.5% (17)\nsalsa20 or chacha, 6.5% (13)\nblowfish, 6.0% (12)\ncamelia, 6.0% (12)\nstackstrings, 6.0% (12)\nupx, 0.5% (1)\n\n\n**Figure 10: Malicious behaviors of the cryptominer samples in the dataset: (A) Typical MITRE ATT&CK tactics and techniques**\nleveraged by the samples; (B) Various encryption/obfuscation techniques used for defense evasion.\n\n###### Detecting and mitigating the threat\n\nA cryptojacking attack might result in higher energy bills, stalled operations, or higher cloud computing costs.\nUnfortunately, these attacks can be tricky to detect because they do not completely disrupt the operations of\ncloud environments, like ransomware does, or raise alarms, like a data breach might when unauthorized or\nanomalous access to sensitive data is detected.\n\nThe best way to detect cryptojacking attacks is to use network traffic analytics (NTA) to identify internal hosts\nthat are communicating the results of mining work to the outside, as this communication is required to monetize\nthe attack. The communications to look for are connections to mining pools. However, many cryptomining\n\n\n-----\n\nmalware samples connect to a command-and-control host that acts as a network proxy to avoid being detected.\nIn these cases, more sophisticated anomaly detection techniques are necessary to identify the threat. EDR\nsolutions may be able to identify abnormal CPU usage patterns that can be directly associated with the\ncalculations related to blockchain mining. Once again, the concerted monitoring of cloud environments using\nboth host-based and network-based detection techniques can help keep these attacks at bay.\n\n###### Methodology\n\n Static and dynamic analysis\n\nLinux programs, malicious or not, can be analyzed with a number of different techniques that can be\ncategorized into two classes: static and dynamic analysis.\n\nStatic analysis looks at Linux binaries without executing them. These techniques either extract the metainformation provided by the ELF binary format or investigate the code and data segments that are part of the\nbinary (e.g., looking for strings used by the program). For example, pyelftools[21] is a Python library that can\nextract information from ELF files. Another example is the FLIRT technology provided by the IDA Pro\ndisassembler[22] that enables the identification of specific libraries in statically linked, stripped binaries, where all\nthe symbols associated with the source code have been removed. Another interesting tool is redress,[23] which\ncan be used to analyze Linux programs written in the Go language.\n\nThe advantage of static analysis techniques is that they are typically fast and don’t require the execution of the\nprogram’s code, which might include malicious actions. For example, the CAPA tool[24] can extract interesting\nbehaviors without having to execute a sample. However, the main disadvantage of static analysis is that it is\nrelatively easy to foil, using layers of obfuscation, packing and encryption. For example, the most used codesimilarity function for ELF files, telfhash,[25] is of limited effectiveness when the files are packed.\n\nDynamic analysis looks at the actual execution of a program, usually in a controlled environment, such as a\nsandbox. These techniques are often resource-intensive and require extreme care to avoid the “spill out” of\nmalicious actions or the fingerprinting of the analysis environment. However, the main advantage of dynamic\nanalysis techniques is that they have the potential to expose the hidden behavior of malicious programs (e.g.,\nencrypted portions of code).\n\nThe Linux kernel has recently introduced a technology, called eBPF,[26] that allows for the monitoring of\n[programs with minimal overhead. Tools built on top of eBPF, such as Tracee,[27] can identify specific malicious](https://github.com/aquasecurity/tracee)\nbehaviors, such as the unpacking of code or the presence of suspicious sequences of system calls.\n\nIn this report, we have applied a composition of static and dynamic techniques to characterize various families\nof malware observed on Linux-based systems.\n\n###### Malware datasets\n\nAs part of this report, we are releasing a curated dataset of metadata associated with Linux binaries. All the\n[samples in this dataset are public and therefore they can be easily accessed using VirusTotal[28] or various](https://www.virustotal.com/)\nwebsites of major Linux distributions.\n\n|-c ete U e n t lyz mic ex at ro|on ct us ag ec ed a ec or gra|tro ion ag ain hn w na uti inv m|l h t e , t iq ith lys ng es ).|os ec pat he ue a is. th tig Fo|t t hni te co s c nu e at r e|ha qu rn n an m m. e t xa|t a es s t cer h be Th he m|cts ar hat te elp r o es c ple|a e c d k f e od , p|s a ne an mo ee diff tec e a ye|n ce be ni p t er h n lft|etw ss d tor he en niq d d oo|o ary ire in se t t ue at ls2|rk to ctl g o at ec s a s 1 is|pr id y a f c tac hn eit eg a|ox e ss lo ks iq he m P|y t ntif oc ud a ue r e en yth|o a y t iat e t b s t xtr ts on|vo he ed nvi ay hat ac th li|id th w ro . c t t at br|b re ith nm an he ar ary|ein at t e be m e p th|g . E he nts et ar at|de DR us a- t o ca|tec in f t n|te g he|d.|Col29|Col30|Col31|Col32|Col33|Col34|Col35|\n|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|\n\n\n-----\n\nWe started by collecting more than 11,000 benign samples from several Linux distributions, namely Ubuntu,\nDebian, Mint, Fedora, CentOS and Kali. We then collected a dataset of samples for two classes of threats,\nnamely ransomware and cryptominers. These datasets have been manually labeled and vetted. This is a\nresource-intensive process that provides better labels than the ones provided by most automated analysis\ntools, which can be noisy and imprecise. Finally, we collected a dataset of malicious ELF binaries from\nVirusTotal that we used as a test malicious dataset. We started collecting the dataset in June 2021 and\nconcluded in November 2021.\n\nFor each sample in each dataset, we looked at the general characteristics of the program, such as the\narchitecture, the type of linking (static or dynamic), the presence or absence of symbols, the use of UPX for\npacking, and other traits. Figure 11 displays the characteristics of the files in our datasets, which show how\ndifferent the characteristics of each group are.\n\n**Figure 11: Characteristics of the samples in the datasets.**\n\n|enign hen c e dat ter la lly, w ataset at the amic) he ch e.|sa ol ase be e . g , t ara|m lec ts ls co We en he ct|ple te ha tha lle st er pr eri|s d v n ct ar al e st|fro a d e b th ed te ch se ics|m se atase een m e one a dat d colle aracte nce or of th|veral L t of sa anual s provi aset of cting ristics absen e files i|inu mp ly l de m the of ce n o|x distrib les for t abeled a d by mo alicious dataset the prog of symb ur datas|utions, n wo class nd vett st autom ELF bina in June ram, su ols, the ets, whi|a es ed a ri 2 ch us ch|me of . T te es 02 a e s|ly Ub threa his is a d analy from 1 and s the of UPX how h|untu, ts, sis for ow|Col16|Col17|Col18|Col19|Col20|Col21|Col22|Col23|\n|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|\n\n\n-----\n\n#### Remote access tools – Implants\n\n\nAn important aspect of an adversary’s activity is how they compromise systems to gain control. This control\nallows them to persist within the environment, establishing a staging server they can use to pivot and target\nadditional systems. Once an adversary has gained initial access to an environment, they enter the most difficult\nportion of the attack. They will need to find a way to leverage this limited access to gain a stronger foothold,\nwhile attempting to map out and find resources to accomplish their goal.\n\nAttackers look to install an implant on a compromised system that gives them partial control of the machine.\nAn implant, also known as a beacon, is what is generally regarded as the malware component of an attack. Its\ngoal is to simply make regular network connections out to the command-and-control (C2) server to obtain new\ncommands to execute and pass along the results.\n\nIn the context of an attack, what is an implant? Malware, webshells, remote access Trojans, and even knowngood RATs can all be implants that install themselves on a compromised system to allow for remote access. An\nimplant is deployed in a persistent manner to allow an adversary to keep control of that infected system. This is\ntypically done in two ways: passive and active. A passive implant awaits an external connection, such as a\nwebshell on a compromised server. Conversely, an active implant will continually try to send beacon messages\nto a preset C2 server and await further instructions. Analysis of RATs in the wild shows that most act as active\nimplants that will communicate with known C2 servers to gather further instructions. Very few RATs make use\nof passive implants that rely on a service to listen for commands. While such malware could create its own\nlistener, often they install a component into an existing service, such as a web server, to piggyback on existing\nnetwork connectivity. However, the adversary would need to perform additional research of the infected\nsystem and face the risk of insufficient account privileges to install. Because a passive implant has no guarantee\nthat the system will allow incoming connections, an active implant is the preferred tactic for malware.\n\nFrom a malware analysis perspective, what is interesting is determining the number of implants that interact via\nwell-known HTTP protocols, and those that create their own specialized protocols. An implant’s purpose is farreaching, depending on its author. Many are used for very simplistic purposes, such as to show files on the\nsystem, download new files, upload existing files, or execute commands.\n\nOthers allow for more advanced tactics, such as mapping out the local network and pivoting from the infected\nsystem into new systems on the network. Overall, depending on the adversary and their ability, an implant can\ncontain a great amount of functionality, as documented in Figure 12.\n\n|Col1|Col2|Col3|Col4|Col5|Col6|Col7|Col8|Col9|Col10|Col11|Col12|Col13|Col14|Col15|Col16|Col17|Col18|Col19|Col20|Col21|Col22|Col23|Col24|Col25|Col26|Col27|Col28|Col29|Col30|Col31|Col32|Col33|\n|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|\n||||||||||||||||||||||||||||||||||\n||||||||||||||||||||||||||||||||||\n||||||||||||||||||||||||||||||||||\n||||||||||||||||||||||||||||||||||\n||||||||||||||||||||||||||||||||||\n||||||||||||||||||||||||||||||||||\n||||||||||||||||||||||||||||||||||\n||||||||||||||||||||||||||||||||||\n||||||||||||||||||||||||||||||||||\n||||||||||||||||||||||||||||||||||\n||||||||||||||||||||||||||||||||||\n||||||||||||||||||||||||||||||||||\n||||||||||||||e rs s. c o n n||o t m ta w|||a i a u i a|||||||||||||||\n\n\n-----\n\nCommunicate with C2 server\nusing HTTP, HTTPS or other custom protocol\n\n**Main**\n\n**Exfiltration** **Reconnaissance**\n\n\nEncrypts send\nand receive\ndata/file\n\n**Lateral**\n**Movement**\n\nDeploy additional malicious payload\nto all system/network\n\nServer\n\nComputer\n\nComputer\n\n**Figure 12: Malicious implant diagram.**\n\n###### Tactics used by implants\n\n|HT|Con Com TP, in C|nec mun HTT Mali vic red|t wi icate PS or Main ciou tim’ ent|th wi o s i s m ia|C2 th C ther mpl ac l T|ser 2 se cus ant hin heft|ver rve tom e|r pro|toc|ol|Col12|Col13|Rec En|on tre|nai nch|ssa me|nce nt|leg|C s Ins itim loa|olle yste tall/ ate d its|ct a m in|nd g for|ath mati itse /ser me|er on lf as vice mory|s or|Col27|Col28|Col29|Col30|Col31|Col32|Col33|Col34|Col35|\n|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|\n||||||||||||||||||||||exec proc elf i|ute ess nto|||||||||||||\n\n\nSteal victim’s\ncredential\n\n\nElevate\nprivileges\n\nKeylogging\n\n\nImplants often perform reconnaissance on systems in the area. For instance, they may scan an entire set of IP\naddresses to collect systems information and grab TCP port banner data. This can also allow the implant to\ncollect IP addresses, hostnames, active user accounts, and specific operating systems and software versions of\nall the systems it detects.\n\nImplants also rely on their ability to entrench themselves within their infected systems to persist. Their hope is\nto become background noise within a typical day’s activity, showing up as just another Windows service or\napplication to operate undetected. They can hide themselves in various ways, but on Linux-based multi-cloud\nenvironments, we often see their activities performed as routine cron jobs. Like the Scheduled Tasks within\nWindows, cron allows Linux, macOS and Unix environments to schedule processes to be executed at regular\nintervals. In this way, malware can implant itself onto a compromised system with a restart frequency of 15\nminutes, so it can relaunch if it is ever terminated.\n\n\n-----\n\nOne of the more advanced tactics used by implants is that of lateral movement.\nAlso known as pivoting, this allows an adversary to install additional implants\nwithin the environment, allowing them to jump to another system internally.\nFrom here, they can start gathering additional data about the environment from\nsystems that may have additional access. In incident responses seen in the past,\nthere are specific systems that have higher privileges to connect into protected\nenclaves for more sensitive data. These protected enclaves do not have remote\naccess but could be accessed via multiple pivots, allowing a patient and careful\nadversary the ability to test access and find the weak center of the infrastructure.\n\nImplants could be active for weeks, or even months, as the adversary figures out\nhow best to carry out their objectives. In a typical smash-and-grab ransomware\nscenario, the actor may get lucky—they could sit dormant on a Windows server\nthey’ve compromised and scan logons for just a few days before they catch a\ndomain administrator. Once they’ve got these stolen credentials, they can\nquickly pivot and use them to force ransomware across an entire environment\nusing built-in PowerShell scripting capabilities. However, this task is more\ndifficult in a multi-cloud environment. The actor typically must remain quiet and\nunnoticed for as long as possible while they discover all the required resources.\n\nImplants are also invaluable for collecting and exfiltrating data. Unlike largescale data collection, which is typically done through tools such as rclone,\nimplants may have the ability to exfiltrate directory listings of existing files and\nindividual files. This allows a malware operator to collect superficial data for a\nmalicious analyst to identify critical assets to steal.\n\n###### Attack stages\n\nThese implants allow for additional stages of attack. While a first stage may be to\nexploit a vulnerability and install an implant, a second stage may be to download\nadditional malware. This is often seen in Windows attacks via malware, such as\nTrickBot and QBot. The same exists in multi-cloud environments, as adversaries\ntend to specialize their toolsets based on functionality. The initial implant may\nhave very specific capabilities, but it can be leveraged to download and execute\nransomware or a cryptomining application, such as those mentioned earlier in\nthis report.\n\nWithin the data center, adversaries may have to juggle access and connections\nto a variety of operating systems and services. In some cases, it could be\nnecessary to pivot between systems instead of making direct connections,\nespecially if some services are virtually segmented and only allow connections\nfrom a hard-coded set of systems. Lucky for them, it is completely possible to\n\n|pla ary p t l d nci ivi ct ots e o ic si t a e s are|nt t o at de leg ed, a we nth al t d fe tol a|s i o i an a a nt es en llo ak s, sm or w en cr|s t nst ot b re t cl w c as as m da cr oss|ha all he out sp o c av ing en th h- an ys ed a|t o a r s th on on es a ter e an t o b e n e|f l ddi yst e se ne do p of ad d- n a efo nti nt|ate tio e en s s ct n ati th ve gr W re als ire|ra na m i vir ee in ot en e rsa ab in th, t e|l m l i nte on n to ha t a inf ry ra d ey he nv|o mp rn m in pr ve nd ra fi ns ow c y c iro|ve la all en th ot re c str gu om s s atc an n|me nt y. t f e p ect m are uc re w er h me|nt s ro as ed ot fu tur s o ar ve a nt|. m t, e l e. ut e r|Col16|Col17|Im Co Ve Co we re as bu an fro Ve thr on ma Str|pl ba rm ba ll- d t a l sin d m rm ea C ki ik|an lt ili lt kn ea eg es DN a ili t e ob ng e s|ts St on Str ow m iti se S co on m alt it er|us rik S ik n to ma s. to mp St ula St co ver|e e a tri e is an ols te It ex ro rik tio rik m s.|d n ke o d o se us fil m e i n e’ pa|by d ne we n t rv es inf ise s a so s p tib|th of ll- he ice HT or d n ftw ro le|re th re m to T ma ne op ar to wi|at e gar ar s P, tio tw en e col th|ac m de ket ele HT n or s ba s, Co|to ost d, s ct TP k. ou se ba|rs ol S rc d lt|d e|Col33|Col34|Col35|\n|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|\n\n\nMerlin\n[Merlin[74 ]is a post-exploit C2 tool](https://github.com/Ne0nd0g/merlin)\nthat communicates using the\nHTTP/1.1, HTTP/2 and HTTP/3\nprotocols. The server and\nimplant are written in Go, so they\ncan be cross-compiled to run on\nany OS platform.\n\n\n-----\n\ntraverse an environment using simple command lines and built-in accessibility\ntools, such as SSH. However, mapping out an environment, as well as the\nresources found on each system, is difficult for someone using direct connection\ntechniques. This creates the need for an attack management tool.\n\n###### Attack management tools\n\nAttack management tools are good for both attackers and red team operations.\nThey provide the ability to graphically organize assets, store collections of notes,\nand easily transmit properly structured commands to multiple compromised\nsystems. At a basic level, they allow the actor to map out accessible IP addresses\nand hostnames within an environment and identify their operating systems. The\nactor can then target specific systems for exploitation, track legitimate user\naccounts and credentials, and document which systems have what assets.\n\n###### A deeper look at Cobalt Strike – Vermilion Strike\n\nThe primary implant that this report focuses on is Cobalt Strike and its recent\nLinux-based variant, Vermilion Strike. To fully understand its impact on a multicloud environment, this report will dive into the implant’s capabilities and\nmethods of operation.\n\nCobalt Strike is a commercial penetration testing and red team tool. It allows a\nred team to simulate real attacks during their testing. Unfortunately, threat\nactors have found the tool useful, as well, thanks to its robust feature set, which\nmakes it easy to remotely control victim machines once they are infected. Cobalt\nStrike uses an implant named beacon that, once deployed on a machine, will\nphone home to retrieve tasks to execute. Many threat actors simply use the\nCobalt Strike beacon for their final payload delivery. The beacon implant is a\nWindows-only application.\n\n[In September 2021, Intezer reported[53] that they had discovered malware that](https://www.intezer.com/blog/malware-analysis/vermilionstrike-reimplementation-cobaltstrike/)\nappeared to be a Linux re-implementation of the Cobalt Strike beacon implant.\n[Open source versions of Cobalt Strike’s beacon implant exist, such as Geacon[54]](https://github.com/darkr4y/geacon)\n[and CrossC2,[55] but Vermilion Strike appears to be the first re-implementation of](https://github.com/gloxec/CrossC2)\nthe Cobalt Strike protocol in the wild. Because Cobalt Strike is such a ubiquitous\nthreat on Windows, its expansion to other operating systems, such as Linux, is\nnotable. It demonstrates the desire of threat actors to use readily available\nremote-control tools to target as many platforms as possible.\n\nVermilion Strike appears to be implemented against version 3 of the Cobalt\nStrike team server. Its C2 configuration and communication appear to be the\nsame as Cobalt Strike, but it only supports a handful of commands. These\ncommands are explained in more detail in the technical analysis in Figure 13.\n\n\nSSH backdoor implant\n[An SSH backdoor implant[75] can](https://blogs.juniper.net/en-us/threat-research/linux-servers-hijacked-to-implant-ssh-backdoor)\nbe loaded when a malicious actor\nexploits a control web panel\n(CWP) server administration web\napplication and downloads a\nsshins installer binary. This drops a\nmalicious shared library,\n/lib64/libs.so, and writes the\nname of the dropped file in the\ndirectory as /etc/ld.so.preload.\nWhen the OpenSSH service\nrestarts, the malicious library will\nload and have the ability to inject\nits own code whenever sshd calls\nbind(). It then uses this hook to\nperiodically beacon to the C2\nserver and exfiltrate sensitive data,\nsuch as CPU and OS information,\nOpenSSH configuration, and other\ncritical data.\n\nLinux C2 malware – RedXOR\n[RedXOR[76] masquerades as](https://securityboulevard.com/2021/04/detect-c2-redxor-with-state-based-functionality/)\na polkit daemon. It is named\nfor its network data encoding\nscheme, which is based on\nXOR. It communicates with a\nC2 server over a TCP socket\nand makes the traffic look like\nHTTP traffic. The C2 server sends\ncommands to the implant via a\ncommand code that is returned\nin a JSESSIONID cookie. These\ncommands can include collect\nsystem information, upload file,\nopen file, execute shell command,\nand other tasks.\n\n|nd e r s k att e an to en loi ch|li nv o ma ac as ds m tify tat sy Ve|ne iro me na ker set to ap t io ste r|s a n on ge s s, m o hei n, m m|nd me e m an st ul ut r o tra s h ili|b nt, usi en d r ore tip ac p ck av o|uil a ng t t ed c le ce era le e n|t-i s w d oo te oll co ssi tin git wh St|n a el ire l. a ec m bl g im at ri|cc l a ct m tio pr e I sy at as ke|es s t co op ns om P a ste e u se|si he nn era of is d m se ts.|bili ec ti n ed dre s. r|ty tio on ote ss Th|n s. s, es e|Col16|l|Im SS An be ex (C ap ssh ma /lib na dir W res oa|pl H S|an ba SH|ts ck b|us do ac|e or kd|d im oo|by p r i|th lan mp|re t la|at nt7|ac 5 c s a el n a dr e t oa e ry in|to an ct we op he d. wi je|rs or b s ll ct|a|Col33|Col34|Col35|\n|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|\n|||||||||||||||||||lo plo W pli in lic 6 me ec he ta d|ad its P) ca s i io 4/li o tor n t rts an|ed a ser tio nst us bs f t y he , t d|w co ve n a all sh .s he as O he ha|he nt r a nd er ar o, dr /e pe m ve|n rol d d bi ed an op tc/ nS ali th|a m w mi ow na lib d w pe ld. SH cio e a|al eb nis nl ry. ra ri d so s us bil|ici p tra oa T ry, tes file .p er lib ity|ou an tio ds his th in rel vic ra to||||||||\n\n\n-----\n\n```\nFile Name : 294b8db1f2702b60fb2e42fdc50c2cee­\n         6a5046112da9a5703a548a4fa50477bc\nFile Size : 89,416 bytes\nMD5 : 3db3e55b16a7b1b1afb970d5e77c5d98\nSHA256 : 294b8db1f2702b60fb2e42fdc50c2cee­\n         6a5046112da9a5703a548a4fa50477bc\nFuzzy : 1536:tMCIVGxHiGZsz9ZLTSKKTrcAFgtzgrSWUnCTOPS:tMCIVUbi\n         z9VT1KTwAFgtzgrFO\nMagic : ELF 64-bit LSB executable, x86-64, version 1 (SYSV),\n         dynamically linked, interpreter /lib64/\n         ld-linux-x86-64.so.2, for GNU/Linux 2.6.32, BuildID[s\n         ha1]=2322a87e5a86ac36f71d745a4b290772f4b3614e,\n         stripped\n\n```\n\n**Figure 13: Analysis of Vermilion Strike file on Linux.**\n\n###### Vermilion Strike configuration details\n\nThe malware has multiple encoded blocks of data that it loads at start-up. The\nfirst is a 4,096-byte block of data that is XOR-encoded with the key 0x69. After\ndecoding this first block, we can see that it is a group of type-length-value (TLV)\nencoded values consistent with a Cobalt Strike beacon. The use of the 0x69\ndecryption key implies that this beacon might be similar to Cobalt Strike 3.x\nbeacons. Cobalt Strike 4.x beacons make use of the 0x2e key to decrypt.\n\nNext, the malware decodes five separate blocks of string data. These chunks of\ndata have 12 bytes of a header and a variable length chunk of XOR-encoded\ndata. As shown in Figures 14 and 15, the first 4 bytes always appear to be “80\n```\n80 00 00”. The second 4 bytes make up a 4-byte key to be used with XORing\n\n```\nthe encrypted data. The third 4 bytes indicate the length of the data. In the\nexample shown in Figure 14 and 15, we can see a key of “e2 16 a2 de” used\nto decode 181 (0xb5) bytes of data.\n\n\nBlackTech – ELF_Plead\nELF_Plead[78] is a Linux version of\na RAT used by the threat actor\nBlackTech. The configuration\nis RC4-encrypted, and a\n32-byte encryption key can be\nfound before the encrypted\nconfiguration. It uses a custom\nprotocol to communicate with\na C2 server. The data sent to\nthe C2 server is RC4-encrypted\nand then LZO-compressed.\nThe ELF_Plead command can\nprovide arbitrary shell command\nexecution and send/receive files,\namong other things.\n\n|c50 a50 e77 c50 a50 KTr e, rpr r G d74|c2 47 c5 c2 47 cA x8 et NU 5a|ce 7b d9 ce 7b Fg 6- er /L 4b|e­ c 8 e­ c tz 64 / in 29|gr , li ux 07|SW ve b6 2 72|Un rs 4/ .6 f4|CT io .3 b3|OP n 2, 61|S: 1 B 4e|tM (S ui ,|CIV YSV ldI|Ub ), D[|i s|Col15|Col16|Col17|Im AC AC|pl B B|an ac ack|ts kd d|us oo oo|e r r77 cu ar er u m es T io od E 8 is|d ma pr tio bit sis pd ise w PS n it ed LF a|by lw ov n rar te at d ith pr c p _ Li|th ar id of y nc e m sy a ot oll ay Ple nu|re e es sh bin e, al ste C2 oc ect loa ad x v|at ell ar an w m s ol s a d. er|ac y d are . It erv to s sio|to er se a n|rs nd of|Col32|Col33|Col34|Col35|\n|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|\n||||||||||||||||||arb co ex the on co usi the Ba Bla EL|itr m ec a a m ng in se ck F_|ar ma uti bil co mu th fo 64 T Pl|y e nd on ity m ni e rm -e ec ea|xe s, , p to pro cat HT at nc h – d7||||||||||||||\n\n\n-----\n\n```\n00000000 80 80 00 00 e2 16 a2 de b5 00 00 00 cd 75 c3 fe |....â.¢Þµ...ÍuÃþ|\n00000010 cd 49 fd ab 96 7b 8c b9 8b 70 82 f1 92 7f da bb |ÍIý«.{.¹.p.ñ..Ú»|\n00000020 8e 38 c5 b7 84 36 8d b9 cc 66 cb a6 87 7a 82 f1 |.8Å·.6.¹ÌfË¦.z.ñ|\n00000030 86 79 d6 f0 85 7f c4 fe cd 63 d2 ba 83 62 c7 ad |.yÖð..ÄþÍcÒº.bÇ.|\n00000040 cc 64 d1 ad c2 39 c4 a9 8e 7f cc b5 c2 39 c1 b3 |ÌdÑ.Â9Ä©..ÌµÂ9Á³|\n00000050 c2 39 c1 a6 c2 39 d2 b7 9a 73 ce fe cd 7b c3 aa |Â9Á¦Â9Ò·.sÎþÍ{Ãª|\n00000060 81 7e 82 f1 94 7f d1 b7 96 38 c8 ad c2 39 ce b1 |.~.ñ..Ñ·.8È.Â9Î±|\n00000070 83 72 82 f1 92 63 d1 b6 c2 39 d2 aa 88 36 8d b4 |.r.ñ.cÑ¶Â9Òª.6.´|\n00000080 cc 77 c6 fe cd 71 c3 f0 88 65 82 f1 87 78 fd 8b |ÌwÆþÍqÃð.e.ñ.xý.|\n00000090 b1 39 c3 b2 8e 38 c8 ad c2 39 c3 bd 96 7f d4 b7 |±9Ã².8È.Â9Ã½..Ô·|\n000000a0 96 6f 82 f1 ab 53 9b 9d 8d 7b d2 bf 96 40 cb bb |.o.ñ«S...{Ò¿.@Ë»|\n000000b0 95 5a cb ad 96 |.ZË..|\n\n```\n\n**Figure 14: Vermilion Strike encrypted string data.**\n\n```\n00000000 2f 63 61 20 2f 64 70 69 78 65 6c 20 2f 5f 5f 75 |/ca /dpixel /__u|\n00000010 74 6d 2e 67 69 66 20 2f 70 69 78 65 6c 2e 67 69 |tm.gif /pixel.gi|\n00000020 66 20 2f 67 2e 70 69 78 65 6c 20 2f 64 6f 74 2e |f /g.pixel /dot.|\n00000030 67 69 66 20 2f 75 70 64 61 74 65 73 2e 72 73 73 |gif /updates.rss|\n00000040 20 2f 66 77 6c 69 6e 6b 20 2f 63 6d 20 2f 63 78 | /fwlink /cm /cx|\n00000050 20 2f 70 69 78 65 6c 20 2f 6d 61 74 63 68 20 2f | /pixel /match /|\n00000060 76 69 73 69 74 2e 6a 73 20 2f 6c 6f 61 64 20 2f |visit.js /load /|\n00000070 70 75 73 68 20 2f 70 74 6a 20 2f 6a 2e 61 64 20 |push /ptj /j.ad |\n00000080 2f 67 61 2e 6a 73 20 2f 65 6e 5f 55 53 2f 61 6c |/ga.js /en_US/al|\n00000090 6c 2e 6a 73 20 2f 61 63 74 69 76 69 74 79 20 2f |l.js /activity /|\n000000a0 49 45 39 43 6f 6d 70 61 74 56 69 65 77 4c 69 73 |IE9CompatViewLis|\n000000b0 74 2e 78 6d 6c |t.xml|\n\n```\n|00 70 66 63 7f 73 38 39 65 39 7b|0 8 c d c c c d 8 c d|0 2 b 2 c e 8 2 2 3 2|00 f1 a6 ba b5 fe ad aa f1 bd bf|c 9 8 8 c c c 8 8 9 9|d 2 7 3 2 d 2 8 7 6 6|75 7f 7a 62 39 7b 39 36 78 7f 40|c d 8 c c c c 8 f d c|3 a 2 7 1 3 e d d 4 b|fe bb f1 ad b3 aa b1 b4 8b b7 bb|Col11|Col12||. |Í |. |. |Ì |Â |. |. |Ì |± |. |.|... Iý« 8Å· yÖð dÑ. 9Á¦ ~.ñ r.ñ wÆþ 9Ã² o.ñ ZË.|â. .{ .6 .. Â9 Â9 .. .c Íq .8 «S .||¢Þ .¹ .¹ Äþ Ä© Ò· Ñ· Ñ¶ Ãð È. ..|µ. .p Ìf Íc .. .s .8 Â9 .e Â9 .{|.. .ñ Ë¦ Òº Ìµ Îþ È. Òª .ñ Ã½ Ò¿|Íu .. .z .b Â9 Í{ Â9 .6 .x .. .@|Ãþ Ú» .ñ Ç. Á³ Ãª Î± .´ ý. Ô· Ë»|| | | | | | | | | | ||Col22|Col23|Col24|Col25|Col26|Col27|Col28|Col29|Col30|Col31|Col32|Col33|Col34|Col35|\n|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|\n\n\n**Figure 15: Vermilion Strike decrypted string data.**\n\nThese five chunks of data are either separated by a space or comma, and contain the rest of the configuration\ndata the malware uses when communicating with its C2 server:\n\n- DNS servers\n\n- GET URLs\n\n- POST URLs\n\n- Subdomains to use with DNS C2 traffic\n\nFinally, the malware parses the beacon configuration. Although the malware uses the same structure as a real\nCobalt Strike beacon, it only loads the configuration types shown in Table 3 from the beacon data.\n\n\n-----\n\nType Name Description\n\n\n01 BeaconType How to communicate with the C2\n\n02 Port What port to use when communicating with the C2\n\n03 SleepTime How often to check in with the C2\n\n07 PublicKey An RSA public key used to encrypt communication with the C2\n\n08 C2Server A list of server names and GET URL paths to use to check in\n\n09 UserAgent The User-Agent string to use in HTTP communication\n\n10 HttpPostUri The POST URL to use to send responses to the C2\n\n\n13 HttpPost_Metadata Additional data to set in POST requests to the C2\n\n**Table 3: Vermilion Strike configuration types.**\n\n###### Vermilion Strike setup\n\nAfter loading the configuration, the malware proceeds to initialize the additional values it needs to\ncommunicate with the C2. These steps are similar to what a real Cobalt Strike beacon does.[56] The setup\nconsists of the following steps:\n\n1. Generate an array of 16 random bytes\n\n2. Generate a SHA256 of the bytes\n\n3. Use the first half of the SHA256 for AES keys\n\n4. Use the second half of the SHA256 for HMAC keys\n\n5. Load the RSA key from the beacon configuration\n\n6. Collect and encrypt victim machine information:\n\n– Random number\n\n– PID\n\n– OS name\n\n– IP address\n\n– User name\n\n– Host name\n\n– Malware version number\n\nThe version number used in this specific sample of the malware is 1.0.1.LR.\n\n|Col1|mu|nic|ate|w|ith|th|e C|2|Col10|Col11|Col12|Col13|Col14|Col15|Col16|Col17|Col18|Col19|Col20|Col21|Col22|Col23|Col24|Col25|Col26|Col27|Col28|Col29|Col30|Col31|Col32|Col33|Col34|Col35|Col36|\n|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|\n|Port What port to SleepTime How often to|us ch|e ec|wh k i|en n w|co ith|mm th|u e|nic C2|atin|g|wit|h t|he|C2||||||||||||||||||||||\n|PublicKey An RSA publ|ic|key|u|sed|to|e|ncr|yp|t c|om|mu|ni|cat|ion|wi|th|the|C|2|||||||||||||||||\n|C2Server A list of serv|er|na|me|s a|nd|GE|T|UR|L p|at|hs|to|use|to|ch|ec|k i|n||||||||||||||||||\n|UserAgent The User-Ag|en|t st|rin|g t|o u|se|in|HT|TP|c|om|mu|ni|cat|ion|||||||||||||||||||||\n|HttpPostUri The POST U|RL|to|us|e t|o s|en|d r|esp|on|se|s to|th|e|C2||||||||||||||||||||||\n|HttpPost_Metadata Additional d|ata|to|se|t in|P|OS|T r|eq|ues|ts|to|the|C|2||||||||||||||||||||||\n|le 3: Vermilion Strike configuration types.||||||||||||||||||||||||||||||||||||\n\n\n-----\n\n###### Cobalt Strike/Vermilion Strike C2 communication\n\nAfter loading the configuration and performing the additional setup, the malware enters its main processing\nloop. Each time through the main loop, the malware will attempt to check in with the C2 server and then go to\nsleep for the time specified in the SleepTime beacon configuration. Depending on the BeaconType value,\nas previously mentioned, the C2 communication method will change. The malware currently supports hybrid\nHTTP DNS, HTTPS, and HTTP communication. There is an additional ICMP communication method in\n[the code but no configuration option to select it. As Intezer noted, this might indicate this code is under](https://www.intezer.com/blog/malware-analysis/vermilionstrike-reimplementation-cobaltstrike/)\ndevelopment.\n\nIn the case of HTTP or HTTPS communications, a GET request is made to the server to check in. A cookie value\nis set with Base64-encoded data collected from the victim machine. The server responds to the GET request\nwith any queued-up commands. The commands shown in Table 4 are supported by the malware.\n\nCommand Name Description\n\n02 shell Execute the command\n\n04 sleep Change how often the beacon calls home\n\n05 cd Change directory on host\n\n10 upload Upload a file to host (first chunk)\n\n11 download Download a file\n\n19 cancel Cancels a download that is currently in progress\n\n39 pwd Displays the current working directory\n\n53 ls List files in a folder\n\n55 drives List drives on current system\n\n67 upload Upload a file to host (subsequent chunks)\n\n**Table 4: Vermilion Strike supported commands.**\n\nThe malware will execute the commands sent to it from the server and then send a POST request back with the\nrequested information.\n\n|m g al e ion n. t it s, m nd tio he|u th wa be m Th . A a th s s n co|ni e a re ac et er s I GE e ho m|ca dd wi on ho e is nt|ti iti ll a co d a ez|on on tt nf wi n a er|al em ig ll c d no|se pt ura ha dit te|tu to tio ng ion d, m ne 4|p, c n. e. al thi ad . T ar|the he D T IC s e h e s|m ck ep he M mi to e s up|al in en m P c gh th er po|wa wi di alw o t in e s ver rt|re th ng a mm di er r ed|e th o re u ca ve esp b|nte e n t cu nic te r t o y t|rs C2 he rre at thi o c nd he|it se B nt ion s he s t m|s m rv ea ly m co ck o t alw|ai er co su et de in he a|n an n pp ho is . A G re.|pro d Ty or d un c ET|ce th pe ts in de oo re|ss en v hy r ki q|in go alu br e v ue|g t e, id al st|o ue|Col29|Col30|Col31|Col32|Col33|Col34|Col35|\n|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|\n||||T vic w ma|re tim n i nd|qu m n T|est a ab|is chi le||||||||||||||||||||||||||||\n\n\n-----\n\n```\nFile Name : 7129434afc1fec276525acfeee5bb08923ccd9b32269638a54c7b452f5493492\nFile Size : 238,080 bytes\nMD5 : 4baec501cd3c6318c8bceb4cf5c8b394\nSHA256 : 7129434afc1fec276525acfeee5bb08923ccd9b32269638a54c7b452f5493492\nCompiled Time : Wed Jun 26 02:59:19 2019 UTC\nPE Sections (5) : Name Size MD5\n             .text 165,888 856639ce9212eb1329c8a59f89f0f97e\n             .rdata 51,200 590ccfa17cf705285509a4ae3ae50f38\n             .data 7,168 bfcb5a68d595cf49d2b372f35bbaacc5\n\n```\n`.rsrc` `512` 09a004fff9ae1f2b5ff7ded5bcfaf389\n```\n             .reloc 12,288 f6d8de448cad7e9a2587b75d8894c69d\nOriginal DLL : gigabigsvc.dll\nDLL Exports (1) : Ordinal Name\n             1  ServiceMain\nMagic : PE32 executable (DLL) (GUI) Intel 80386, for MS Windows\n\n```\n\n**Figure 16: Vermilion Strike Windows file.**\n\n###### Vermilion Strike Windows and Linux differences\n\nAs an aside, the Windows version of the malware is almost identical to the Linux version with only a few\ndifferences. For instance, when collecting and encrypting victim machine information, the Windows version\nuses the following malware version numbers:\n\n- 1.0.1.WR\n\n- W1.0.1\n\nAdditionally, before entering the main loop, the Windows version will start a thread that attempts to read\ninformation from a named pipe and send the data to the C2 server using standard communication methods.\nTable 5 shows three additional commands the Windows version understands that are not available in the Linux\nvariant due to differences in how the two operating systems manage named pipes.\n\nCommand Name Description\n\n20 create_pipe Create a named pipe\n\n21 resume_pipe ResumeThread on the named pipe thread\n\n23 suspend_pipe SuspendThread on the named pipe thread\n\n**Table 5: Vermilion Strike commands for named pipes.**\n\nThese additional commands and threads seem to be related to Cobalt Strike functionality that allows the\nbeacon to be injected into other processes and use a named pipe to communicate back to the main beacon\nwhen sending responses to the C2. Although the commands exist for controlling the named pipe thread in\nLinux, there doesn’t seem to be any ability for the beacon to inject itself into other processes.\n\n|52 8b 52 19 88 0 8 DL|5a ce 5a 2 L)|cf b4 cf 01 (|ee cf ee 9 M 8 5 b 0 f GU|e5b 5c8 e5b UTC D5 56 90 fc 9a 6d I)|b0 b3 b0 63 cc b5 00 8d In|89 94 89 9c fa a6 4ff e4 te|23 23 e9 17 8d f9 48 l|cc cc 21 cf 59 ae ca 80|d9 d9 2e 70 5c 1f d7 38|b3 b3 b13 528 f49 2b5 e9a 6,|22 22 29 55 d2 f7f 25 f|69 69 c8 09 b3 de 87 or|63 63 a5 a4 72 d5 b7 M|8a 8a 9f ae f3 bc 5d S|54c 54c 89 3a 5b fa 88 Win|7b 7b f0 e5 ba f3 94 do|45 45 f9 0f ac 89 c6 ws|2f 2f 7e 38 c5 9d|54 54|93 93|49 49|2 2|Col24|Col25|Col26|Col27|Col28|Col29|Col30|Col31|Col32|Col33|Col34|Col35|\n|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|\n\n\n-----\n\n###### Metadata\n\nThe Windows version also provides additional metadata that might be useful. First is a PDB path, shown\nbelow. A PDB value is a file path stored within a Windows executable that has debugging enabled. This refers\nback to the original path on the malware developer’s computer where the malware was compiled, which can\nprovide insightful clues to the actor.\n\nC:\\workspace\\spy\\cobaltstrike-client-vc2008\\Release\\gigabigsvc.pdb\n\nSecond is the compilation timestamps of the beacons and stager binaries. The following unique timestamps\nare seen on the Windows binaries:\n\n- 2019-06-26 02:59:19\n\n- 2019-06-26 02:59:26\n\n- 2020-09-12 14:35:36\n\n- 2020-09-12 14:36:10\n\nThe fact that a lot of the compilation timestamps of the samples come from 2019 is a clue that this Cobalt Strike\nclone might have been written to be compatible with version 3.x.\n\n###### Vermilion Strike compatibility with Cobalt Strike team server\n\nBased on the analysis of malware samples, it appears this malware is most compatible with Cobalt Strike 3.x.\nAfter testing, a sample can connect and retrieve commands from the server but does not properly send back\nresponses. There appears to be two problems.\n\nThe first problem is even though the beacon configuration is read and the POST URI decoded, the malware does\nnot use this value. Instead, it selects at random from an array of POST URIs, which are loaded from the .rodata\nsection. When sending responses to the server, it most often gets a 404 error returned, as seen in Figure 17.\n\n**Figure 17: C2 POST error.**\n\n|l m n a elo \\R be ps ble|et W pe el ac o w|ad in r’s ea on f t ith|at do c se s a he v|a t w om \\gi nd sa ers|ha s e p ga s m io|t xe ute bi tag ple n 3|mig cu r gs er s .x|ht ta wh vc. b co .|b ble er pd ina me|e u th e t b ri fr|se at he es. o|fu h m T m 2|l. as al he 01|Fir de wa fo 9|st i bu re llo is|s g w wi a c|a P gin as ng lu|D g co u e t|B p en m niq ha|at ab pil ue t t|h, le ed ti his|sh d. , w me C|o Th hi st ob|wn is r ch am alt|ef ca p St|er n s rik|s e|Col29|Col30|Col31|Col32|Col33|Col34|Col35|\n|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|\n\n\n-----\n\nThe second issue is that the POST URI is supposed to include a session ID, but the malware just uses a random\nnumber for this session ID. The result is that, even if the correct POST URI is picked at random, the server\ndoesn’t process the results because the session ID is unknown.\n\n###### The VMware Threat Analysis Unit Cobalt Strike threat intelligence collection\n\nSecurity practitioners often rely on the reputation of IP addresses to determine if traffic to and from that\nindicator of compromise (IOC) is malicious. However, the reputation is not effective for catching fresh\nmalware C2 servers. In the example shown in Figure 18, antivirus (AV) engines detected an IP address as\n[harmless (0/87)[57] on VirusTotal in September 2021, but in the VMware Threat Analysis Unit, we were able to](https://www.virustotal.com/gui/ip-address/52.157.171.98)\nidentify it as a Cobalt Strike team server (C2).\n\n**Figure 18: VirusTotal result against one IP address.**\n\nWe looked at the DNS protocol, which we had reversed, and saw the protocols of high-profile malware\nfamilies were emulated, especially those used for cyberespionage to discover real-time C2 instances on the\ninternet. We utilized this intelligence to not only detect the threats but to also support incident response cases.\nThe following section describes our findings on these Cobalt Strike threats.\n\n###### Protocol overview and our approach\n\nCobalt Strike is split into a client and server component called a team server. An operator using a client GUI\nprogram connects to a team server after authenticating with a password through the TLS protocol.\n\nA Cobalt Strike stager then downloads a main RAT module, the beacon, from the team server. The beacon will\nreceive task (command) information from the team server and send back the results of the executed command.\nBoth stager and beacon protocols for C2 communications are implemented in HTTP/HTTPS/DNS.\n\nAdditionally, Cobalt Strike allows third-party programs to act as a communication layer for the beacon’s\n[payload. In those cases, the beacon session is forwarded to a team server’s External C2[58] service function,](https://www.cobaltstrike.com/help-externalc2)\n[using a third-party client and controller. (For more Cobalt Strike protocol details, please see our presentation[59]](https://jsac.jpcert.or.jp/archive/2021/pdf/JSAC2021_201_haruyama_jp.pdf)\nfor the Japan Security Analyst Conference (JSAC) 2021.)\n\n|os ev on it ati o F 2|ed en ID C on we ig 02|t if is o of ve ure 1,|o i th u b IP r, t 1 bu|ncl e c nk al a he 8, t i|ud or no t dd r an n t|e re wn St re ep tiv he|a s ct . ri ss uta iru V|es PO ke es ti s ( Mw|sio ST t to on A a|n U hr de is V) re|ID RI e te no en Th|, b is at rm t e gi re|ut pi i in ff ne at|th ck nt e i ect s d An|e ed el f t iv et al|ma at li raf e f ec ysi|lw ra ge fic or te s|ar n n to ca d a Un|e j do c a tc n I it,|ust m, e nd hin P w|u th co fr g ad e w|se e ll om fre dr er|s a ser ec t sh es e|ra ve ti hat s a ab|nd r o s le|o n to|m|Col29|Col30|Col31|Col32|Col33|Col34|Col35|\n|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|\n\n\n-----\n\nTo identify Cobalt Strike team servers, we\nfocused on the staging process of each protocol, **Beacon Download**\n(HTTP/HTTPS/DNS/External C2) to ensure we: **(HTTP/HTTPS/DNS)**\n\n**Stager**\n**(Downloader)** **Client Authentication**\n\n- Did not circumvent any technological measure, **(TLS)**\n\nsuch as authentication for the discovery.\nThe client authentication protocol was not in **(HTTP/HTTPS/DNS)Task Execution** **Team Server**\nour options because the emulation could be a **Beacon (RAT)**\nlogin attempt by an unauthorized user to the\nteam servers. **External C2**\n\n**Named** **(TCP)**\n\n- Avoided false positives. Previous research **Pipe**\n\n[(e.g., Fox-IT[60] and ZoomEye[61]) didn’t](https://blog.fox-it.com/2019/02/26/identifying-cobalt-strike-team-servers-in-the-wild/)\ndifferentiate the Cobalt Strike team servers and\nNanoHTTPD servers because they rely solely\n\n**Third-Party**\n\non the HTTP response header data. Similarly, **Third-Party** **Command & Control** **Third-Party**\nwe obtained responses from the team servers **Client** **Controller**\nby sending requests based on the beacon\nprotocol, such as HTTP/HTTPS GET requests, **Figure 19: Cobalt Strike protocols overview.**\nwith the correct URI paths or arbitrary DNS A\nrecord queries. The team servers answered with a 200 OK status code in HTTP/HTTPS or a dns_idle value in\nDNS. However, we knew that a simple confirmation, without RSA/AES encryption in the beacon protocol\nwould produce many false positives.\n\n- Discovered team servers silently. We emulated the beacon session encryption and then downloaded task\n\ninformation from the servers. However, once the emulation code checked in at the servers, an entry was\ncreated on the Cobalt Strike GUI console. Such a noticeable method is unfavorable for this purpose.\n\n[Therefore, we took the same approach as the one used by the Cobalt Strike developers[62] to emulate the stager](https://blog.cobaltstrike.com/2019/02/19/cobalt-strike-team-server-population-study/)\nprotocol. Our implementation downloads beacon executables from Cobalt Strike team servers, and then\ndecodes and parses their configuration blocks to obtain further information. The protocol requires no\nauthentication, and the method will not lead to any false positives. We recognize that some security\nresearchers and organizations analyze the Cobalt Strike team servers in the wild, using the stager protocol, but\nthat doesn’t cover DNS and External C2 protocols, and threat actors tend to prefer them to HTTP/HTTPS.\n\nAdditionally, since version 3.5.1, Cobalt Strike has an option to disable the hosting of payload stages for HTTP/\nHTTPS/DNS protocols (except External C2). Specifically, users are able to disable the stager protocol by just\n[setting a line in the Malleable C2 Profile:[63]](https://www.cobaltstrike.com/help-malleable-c2)\n\n|co e: ur a e an y y, rs|l, e, d|Col3|Na Pi|(Do Be med pe Th|Sta wnl aco ird- Cli|ger oad n ( Par ent|er RA ty|) T)|(H|B (HT Ta TT|eaco TP sk E P/H|n D /HT xec TTP|ow TPS utio S/D|nloa /D n NS|d NS) )|Tea Thir Co|m S d-P ntro|erver Exte ( arty ller|Col20|Cli|ent|Au (T|then LS)|tica|tio|n|(O|Col29|Col30|)|Col32|Col33|Col34|\n|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|\n||||||||||||||||||||rnal TCP)|C2||||||||Cli pe|ent rator|||||\n||||||||||Com|Thi ma|rd- nd|Part & C|y ontr|ol||||||||||||||||||||\n\n```\nset host_stage \"false\";\n\n```\n\nWhen disabled, it is impossible to detect the server by our method, but it gives Cobalt Strike users an\nalternative mechanism to deliver their beacons.\n\n\n-----\n\n###### Observations since February 2020\n\nBetween February 2020 to November 2021, we discovered more than 14,000 active Cobalt Strike team\nservers on the internet.\n\nPopulations by protocol, version and customer ID\n\nThe percentage of each stager/beacon protocol is shown in Figure 20. The most popular protocol is HTTPS;\nthe HTTP ratio increased 31 percent in January 2021 to 37 percent in November. We hypothesize Cobalt Strike\nusers try to avoid a detection technique based on TLS\n[handshakes, called JARM.[64]](https://github.com/salesforce/jarm) External C2\n\n1%\n\n|we er col|di ID is|sc sh|ov o|er wn|ed in|m Fi|or gu|e t re|ha 2|n 1 0.|4, Th|0 e|00 mo|ac st|tiv po|e p|Co ula|ba r p|lt S ro|tr to|ik co|e t l is|ea H|m TT|P|S;|Col28|Col29|Col30|Col31|Col32|Col33|Col34|Col35|\n|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|\n\n\nOur discovery system guesses Cobalt Strike versions based\non the collected beacon’s configuration values. For\nexample, if a SETTING_WATERMARK value (i.e., the\n[customer ID[65]) is included in the configuration, the version](https://www.cobaltstrike.com/help-authorization-files)\nmust be 3.9 and later at minimum. In addition, a SETTING_\nDOMAIN_STRATEGY value indicates that the version is 4.3\nand later. From our sample datasets, we found that close to\n90 percent are version 4 and later (Figure 21). Regarding\ncustomer IDs, we found at least five customer Cobalt Strike\nIDs were cracked and leaked:\n\n- 1873433027\n\n- 305419896\n\n- 16777216\n\n- 1359593325\n\n\n**Figure 20: Population by protocol.**\n\n\n\n- 0 (trial)\n\n\n3.9-3.13 3.8 and below\n\n2% 0%\n\n\n3.9-3.13\n\n2%\n\n6% 8%\n\n16777216\n\n1% 1873433027\n\n\n305419896\n\n25%\n\n16%\n\n0 (trial and cracked)\n\n\n**Figure 21: Cobalt Strike server population by version.**\n\n\n**Figure 22: Population by customer ID.**\n\n\n-----\n\nAs shown in Figure 22, the total percentage of cracked and leaked customer IDs is 56 percent. This means that\nmore than half of the observed Cobalt Strike users are using illegitimately obtained versions of the\ncommercial software.\n\nAdditionally, it should be noted that cracked trial license cases are increasing lately. Since Cobalt Strike version\n[3.6, the encryption of the beacon protocol is disabled[66] in the trial license. It can be checked by looking at the](https://blog.cobaltstrike.com/2015/10/14/the-cobalt-strike-trials-evil-bit/)\nconfig value SETTING_CRYPTO_SCHEME. If it's 1, it's disabled. However, we noticed there are a lot of team\nservers with the value 0, even if the customer ID is 0 and the version is newer than 3.6, such as in the following\nparsed config output:\n\n```\n...\nword CRYPTO_SCHEME (1 = disable encryption) at 0x746: 0 (0x0)\n...\ndword WATERMARK at 0x798: 0 (0x0)\n...\n\n```\n\nWe counted these servers as a part of the cracked customer IDs in Figure 22.\n\nChange in the number of team servers obtained by a single scan\n\nWe discovered Cobalt Strike team servers targeting multiple protocols and ports. In Figure 23, we display the\nchanges in the result of a single scan, which focuses on typical ports (HTTPS/443, HTTP/80, DNS/53 and\nExternalC2/2222), and a scan that covers other ports as well.\n\n900\n\n800\n\n700\n\n600\n\n500\n\n400\n\n300\n\n200\n\n100\n\n0\n\nFeb-20 Mar-20 Apr-20 May-20 Jun-20 Jul-20 Aug-20 Sep-20 Oct-20 Nov-20 Dec-20 Jan-21 Feb-21 Mar-21 Apr-21 May-21 Jun-21 Jul-21 Aug-21 Sep-21 Oct-21 Nov-21\n\nHTTPS/443 HTTP/80 DNS/53 ExternalC2/2222\n\n**Figure 23: Change in the result of a single scan.**\n\nSince December 2020, the numbers look to decrease. However, we understand a part of Cobalt Strike users\njust disabled the stager protocol, rather than halting its usage. Security researchers should pay attention to the\nstager-disabled team servers to detect any changes.\n\n|f c us tria dis|ra er l li ab|ck s a ce le|ed re ns d66 's a t|a u e in di nd 0x|nd sin cas th sa th 74|le g es e ble e v 6:|ak ille a tri d. er 0|ed gi re al l H sio (|cu tim in ice ow n 0x|st a cr n e is 0)|om tel eas se ver ne|e y in . It , w w|r ID obt g l ca e er t|s ai at n no h|is ne ely be tic an|56 d . S c ed 3.|p ver inc hec th 6,|er si e k e su|ce on Co ed re ch|nt. s o b by ar as|Th f t alt lo e a in|is he St ok lo th|m rik in t o e|ea e v g a f t fol|ns er t t ea lo|th sio he m win|at n g|Col29|Col30|Col31|Col32|Col33|Col34|Col35|\n|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|\n|it' ID ti|s 1 is on|, it 0 ) a|||||||||||||||||||||||||||||||||\n\n\n-----\n\nDomain fronting observation (e.g., Microsoft Azure, Fastly)\n\n[Domain fronting[67] is a technique that obfuscates the intended destination of HTTPS traffic. Domain fronting](https://attack.mitre.org/techniques/T1090/004/)\ntakes advantage of routing schemes in content delivery networks (CDNs) and other services.\n\nSpecifically, the Cobalt Strike beacon configuration has different hostnames in C2 hostname (SETTING_\nDOMAINS) and HOST header values. Users can set the header values in either of two locations: in the\n[HTTP config or the GUI menu. The Malleable C2 Profile[68] setting is part of the HTTP transform data](https://blog.cobaltstrike.com/2017/02/06/high-reputation-redirectors-and-domain-fronting/)\nof the config, while the config value SETTING_HOST_HEADER is part of the GUI menu setting.\nThe latter setting will overwrite the former one.\n\nWe found the most popular CDN abused by Cobalt Strike was Microsoft Azure, followed by Fastly.\n\n\nCDN Host header value C2 hostname examples\n\n\nMicrosoft Azure *.azureedge.net *.microsoft.com, *.msn.com, *.skype.com, *.visualstudio.com, *.azure.com\n\n\nFastly *.global.prod.fastly.net *nytimes.com, *yelp.com, *bbc.com, *usatoday.com, *forbes.com,\n*theguardian.com, *cnn.com, *stackexchange.com, *reddit.com\n\n**Table 6: Azure/Fastly domain fronting settings observed in Cobalt Strike team servers.**\n\n|Col1|Az tes nt rat an C2|ur th de io se P|e, e liv n h t t ro|Fa int ery as he file|stl en n di h 68 HE ik me om|y) de et ffe ea se A e e, *|d wo re de tti DE wa xa .m|de rk nt r v ng R s m sn|sti s ( ho al is is Mic ple .co|na CD st ues pa par ro s m,|tio N na in rt t so *.|n s) m e of of ft sky|of an es ith th the Az pe|H d in er e G ur .co|TT oth C2 of HT UI e, m|PS er h tw TP m fol, *.|tra se ost o tr en lo vis|ff rv n lo an u we ual|ic. ice am ca sf se d stu|D s. e ( tio or tti by di|om SE ns m d ng F o.c|ai T : in at . ast om|n f TIN th a ly., *|ro G e .az|nti _ ur|ng e.c|om|Col29|Col30|Col31|Col32|Col33|Col34|Col35|Col36|\n|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|\n||_H e. Co 2 mi|O ba ho cro|ST lt stn so|_ Str a ft.c||||||||||||||||||||||||||||||||\n|stly *.global.prod.fastly.net * *t|nyt he|im gu|es. ard|co ia|m, n.c|*ye om|lp, *|.co cn|m, n.c|*b om|bc, *|.co sta|m, ck|*u exc|sa ha|tod ng|ay. e.c|co om|m,, *|*f re|orb ddi|es t.c|.co om|m,||||||||||||\n\n\nWe found multiple Azure-fronted team\nservers with cracked and leaked customer\nIDs that were likely to be managed by\nthreat actors, not red teamers. VMware\nresearchers worked directly with Microsoft\nin January 2021 and, two months later,\n[Microsoft stated[69] that the company](https://www.microsoft.com/security/blog/2021/03/26/securing-our-approach-to-domain-fronting-within-azure/)\ndecided to make a change to their policy\nto ensure that domain fronting will be\nstopped and prevented within Azure.\nSince then, the new Azure-fronted cases\nhave been on a downward slope. From\nAugust to October 2021, they have been\nreduced to zero. Based on our monitoring,\nwe hypothesize that Cobalt Strike users\nthat were using Azure have migrated to\nFastly or other services hiding a real IP\naddress, such as Cloudflare Workers.\n\n\n0 20 40 60 80 100 120 140 160\n\nMicrosoft Azure\n(until Jan. 2021)\n\nMicrosoft Azure\n(since Feb. 2021)\n\nFastly\n(until Jan. 2021)\n\nFastly\n(since Feb. 2021)\n\n**Figure 24: The change in number of new domain-fronted team servers.**\n\n\n-----\n\n###### Attribution to the specific threat actors\n\nWe parsed configuration blocks of beacons downloaded from team servers to categorize them into clusters\nbased on config values. The clusters could be attributed to specific threat actors or campaigns. We primarily\nfocused on two values in the configuration for this purpose: SETTING_PUBKEY and SETTING_WATERMARK.\n\nSETTING_PUBKEY is an RSA public key in a DER format utilized in the beacon protocol encryption. The RSA\nkey pair is created as a file, .cobaltstrike.beacon_keys, when starting and logging on to a team server for the\nfirst time. After that, if the team server directory is copied to another host, the copied one will have the same\nkey pair file and the public key will be reused. Therefore, the two servers, whose beacons have the same\npublic key, are likely to be managed by the same person or organization, unless the key pair file is leaked. If\n[the file is leaked, the number of servers using the same public key can be huge.[70] We can exclude such a key](https://blog.nviso.eu/2021/10/21/cobalt-strike-using-known-private-keys-to-decrypt-traffic-part-1/)\nfor clustering.\n\nSETTING_WATERMARK is a customer ID extracted from the authorization file, cobaltstrike.auth on a team\n[server. According to Cobalt Strike’s developers,[71] the ID is assigned to every team server of Cobalt Strike,](https://www.cobaltstrike.com/help-authorization-files)\nversion 3.9 and later, and is changed when running the update program. If a team server’s WATERMARK is\nmatched with another one, it means they are operated by a single actor. Even if the software package is not\nvalid (leaked or cracked), the activities utilizing an invalid package are probably malicious. This is how we can\ndifferentiate servers managed by valid customers and ones abused by criminals.\n\nOther than these values, some values in the configuration, such as HTTP header information, and the jar path\nhash value (SETTING_PROCINJ_STUB) may be beneficial for attribution work.\n\nThe undisclosed team servers owned by the threat actors (e.g., APT41)\n\nBased on the SETTING_PUBKEY sharing, we were able to identify the undisclosed team servers owned by\nAPT41 in the two attack campaigns.\n\nCase 1: Campaign ColunmTK\n\n[Group-IB[72] discovered and shared a cyberattack on Air India and attributed it with moderate confidence to](https://blog.group-ib.com/colunmtk_apt41)\nAPT41 in June 2021. The campaign was codenamed ColunmTK. Based on the published network indicators, we\nfound two undisclosed Cobalt Strike team servers.\n\nThe identification procedure is simple:\n\n1. Search for the known IP addresses/domains in our datasets.\n\n2. Obtain customer ID and public key MD5 values from the records.\n\n3. Search for other IP addresses sharing the same values.\n\nIn this case, we utilized the four public key MD5 values extracted from three known servers. The customer IDs\nwere not available for clustering as they were all cracked and leaked.\n\n|Col1|s ow at th DE on ry T m th ra rs,|nl tri is R _ is he e e cte 71 t in|oa bu pu fo ke co ref pe sa d he g t|de te rp rm ys, pi or rso me fro I he|d d t os at w ed e, n p m D i u|fro o e: ut he to th or ub th s a pd|m sp S iliz n a e t or lic e ssi at|te eci ET ed sta no wo ga ke aut gn e p|am fic TI in rti th s ni y ho ed ro|s th NG th ng er er zat ca ri t gr|er re _ e a ho ver io n b zat o e am|ve at PU be nd st, s, n, e io ve .|rs ac BK ac lo th w un hu|to to E on gg e ho les ge|ca rs Y a p in co se s t .70 c am a|te or n rot g o pi be he W ob s m|go ca d S oc n ed ac k e alt er ser|riz m ET ol to on on ey ca str ve ve|e t pai TI en a t e s p n ik r o r’s|he gn N cr ea wil ha air ex e.a f C W|m s. G_ yp m l h ve fil clu ut o A|in W W tio se av th e is de h o bal TE|to e AT n. rv e t e le s n t S R|clu pri E T er he sa ak uc a t tri MA|st m RM he fo s me ed h a ea ke R|er ari A RS r t am . I k m , K i|s ly RK A he e f ey s|.|Col30|Col31|Col32|Col33|Col34|Col35|Col36|\n|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|\n||||||||||||||n fi ry If a|le, te te||||||||||||||||||||||\n|d when ru|nn|||||||||||||||||||||||||||||||||||\n\n\n-----\n\nC2 IP address Protocol/port First seen Last seen Customer ID Public key MD5\n\n\n104.224.169.214 HTTP and 2020/03/16 2020/09/03 0 (trial and\nDNS/5353, cracked),\nHTTP/80, 305419896\nHTTPS/443, (cracked and\nDNS/53 leaked)\n\n185.118.164.198 HTTPS/443 2021/01/12 2021/01/12 305419896\n(cracked and\nleaked)\n\n185.118.166.66 HTTPS/443, 2020/12/06 2021/04/09 305419896\nHTTPS/8443 (cracked and\n\n\n**Table 7: Known team servers reported by Group-IB and observed by the VMware Threat Analysis Unit system.**\n\nBy using the public key MD5 values, we obtained two undisclosed server IPs, which are shown in Table 8. We\nwere able to even catch a new server (45.144.31.31) deployed after the Group-IB report publication.\n\nC2 IP address Protocol/port First seen Last seen Public key MD5\n\n149.248.62.83 HTTPS/443 2020/04/04 2020/04/04 90419b03b90efe0c2c708294b40ced50\n\n45.144.31.31 HTTPS/8443 2021/06/14 2021/06/14 9cdb3fca6156c6cbed2f01d6431b3dfb\n\n**Table 8: Two undisclosed servers sharing the public keys.**\n\nCase 2: Cobalt Strike loader used by APT41\n\n[LAC,[73] a cybersecurity company in Japan, reported the campaign by APT41 using Cobalt Strike loaders in May](https://www.lac.co.jp/lacwatch/report/20210521_002618.html)\n2021. Our system detected seven other servers, which are likely to be managed by the same actor.\n\n|Col1|6|Col3|La 20|st 20|se /0|en 9/0|3|( l|Cu 0 (t cra 30 cra ea|st ria ck 541 ck ke|om l a ed) 98 ed d)|er nd, 96 an|ID d|Col15|P 9 b 6 3|ub 04 40 4e d7|lic 19b ce 69 d9|k 0 d5 b0 da|ey 3b9 0, 7e1 4|M 0e 59|D5 fe 40|0c bd|2c7 b2|08 1e4|29 4b|4 d|Col28|Col29|Col30|Col31|Col32|Col33|Col34|Col35|Col36|\n|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|\n|5.118.164.198 HTTPS/443 2021/01/12|||20|21/|01/|12||( l|30 cra ea|541 ck ke|98 ed d)|96 an|d||9 d|96 b6|83 1cd|53 6|3be|31|7f5|13|a70|f4|0fb|­||||||||||\n|5.118.166.66 HTTPS/443, 2020/12/0 HTTPS/8443|6||20|21/|04|/0|9|( l|30 cra ea|541 ck ke|98 ed d)|96 an|d||9 4|cd 31b|b3f 3d|ca fb|615|6c|6c|be|d2f|01|d6|||||||||||\n|le 7: Known team servers reported by Group-IB an using the public key MD5 values, we obtai|d ne|obs d|er tw|ved o u|by n|th dis|e V clo|M se|wa d|re se|Thr rv|ea er|t A IPs|nal,|ysi wh|s U ich|nit a|sy re|ste sh|m. ow|n|in|Ta|bl|e 8|.|We|||||||||\n\n\n185.118.166.205 DNS/53 2020/12/12 2021/09/11 305419896\n(cracked and\nleaked)\n\n\ndf50953714f29628a7f6a6c\n97eb0bc2e\n\n\n**Table 9: Known team servers reported by LAC and observed by the Threat Analysis Unit system.**\n\n\n-----\n\n|Col1|Col2|Col3|Col4|Col5|Col6|Col7|Col8|Col9|Col10|Col11|Col12|Col13|F 2|irs 02|t s 1/0|ee 5/|n 20|Col19|Col20|Col21|Col22|La 20|st 21/|se 06|en /0|3|Col28|Col29|Col30|Col31|Col32|Col33|Col34|Col35|Col36|Col37|\n|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|\n|18|5.250.151.18 HTTP/80||||||||||||2|02|0/|12/|31|||||20|20|/12|/31||||||||||||\n|45|.142.214.242 HTTPS/443, HTTP/80,|HT|TP|S/|844|3,|D|NS|/53||||2|02|1/0|4/|25|||||20|21/|07|/0|2|||||||||||\n|45|.142.214.56 HTTPS/443, HTTP/80||||||||||||2|02|1/0|6/1|8|||||20|21/|07|/19||||||||||||\n|45|.67.229.168 HTTPS/443||||||||||||2|02|0/|12/|03|||||20|20|/12|/0|3|||||||||||\n|45|.153.231.194 DNS/53||||||||||||2|02|1/0|2/|03|||||20|21/|02|/0|3|||||||||||\n|19|4.156.98.214 HTTP/80||||||||||||2|02|1/0|1/2|6|||||20|21/|01/|26||||||||||||\n|Tab Mo tea Ide We|le 10: Seven undisclosed servers sharing the public reover, it should be noted that the earliest m server discovery, using protocol emulat ntifying potential targets collected manual proxy settings of the be|ke se ion ac|y rv s, on|531 er en co|c72 w a nf|0a as ble ig|ae ac s u ur|6e tiv s ati|05 e to on|3b9 at ta s f|db le ke ro|9b ast pr m|e8 si oa tea|e7 x cti m|b5 mo ve s|6f78 nt c erv|f. hs ou er|ah nte s.|ea rm Th|d e e n|of as u|bo ur mb|th es. er|re of|p se|ort tti|s. ng|Th s i|e s||||||||\n|sm use Vi Fi|all; however, they can be useful for identifying the victim organizations, based on the internal domain name, rname and password. The victim information, based on the proxy settings, is listed in Table 11. ctim industry Victim country Time period Cracked/leaked customer ID? nancial services ES 2020/03-2020/06 No||||||||||||||||||||||||||||||||||||\n|V|ertical transportation CH 2020/04 No||||||||||||||||||||||||||||||||||||\n|A|utomotive DE 2020/04-2020/08 No||||||||||||||||||||||||||||||||||||\n\n\n**Table 11: Victim information included in the manual proxy configuration.**\n\n\n-----\n\nMost team servers with the settings were likely to be owned by red teams, judging from the customer IDs. We\ncontacted the victims and shared our findings – the team server had a cracked/leaked customer ID and was\nactive at that time – so they could take steps to address the ongoing attack that was happening.\n\n###### Detecting and mitigating the threat\n\nRATs, such as Cobalt Strike and Vermilion Strike, pose a significant threat to enterprises. They are often used\nas the first stage of an attack, delivering additional information or even malware that allows threat actors to\npivot and spread to other internal infrastructure. RATs typically gain an initial foothold via simple attacks, such\nas phishing emails.\n\nWe have discovered Cobalt Strike team servers in the wild for more than a year and a half. The fact that more\nthan half of the servers have cracked and leaked customer IDs tells us that Cobalt Strike has become a\ncommodity tool among criminals. A robust combination of NDR software and EDR solutions can help stop\nthese attacks before they begin.\n\nLooking for unknown applications executing in the environment or abnormal network connections is often\nan indicator of something larger going on. By actively monitoring and locking down the environment with NDR\nand EDR solutions, these malicious applications can be stopped before they have a chance to do real harm.\n\n|ly t – to ik io re rs ked m n t|o th ad e, nal . R in c bin he|be e t dr po in A th us at e|o ea es se fo Ts e to io nv|wn m s t a rm ty wil me n o iro|ed se he sig ati pic d f r I f n|b rv o nif on all or Ds ND me|y r er ng ic o y g m te R nt|ed ha oin an r e ai or lls so or|te d g t th ve n e t u ftw ab|a a c att re n an ha s t ar n|ms ra ac at ma ini n ha e or|, ju ck k t to lw tia a y t C an ma|d ed ha e ar l f ea ob d l n|gin /le t nte e t oo r a al ED et|g ak wa rp ha th nd t S R wo|fro ed s h ris t a old a tri sol rk|m c ap es llo vi ha ke ut co|th us p . T w a s lf. ha ion n|e c to eni he s t im T s s ne|us me ng y hre pl he be ca cti|to r I . ar at e fa co n h on|m D e o a att ct m el s i|er an fte cto ac tha e a p s s o|ID d n rs ks, t to fte|s. wa us to s mo p n|W s ed uc re|e h|Col29|Col30|Col31|Col32|Col33|Col34|Col35|\n|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|\n\n\n-----\n\n#### VMware recommendations\n\n\nOrganizations need to think of security as an inherent and distributed part of the modern enterprise, which\nmust be incorporated into all aspects of the environment. Protecting multi-cloud environments starts with\ncomplete visibility into all workloads with detailed system context that makes it easier to understand and\nprioritize mitigation efforts. Information from all sources must be combined in an intelligent fashion that adds\nvalue, while enabling the sharing of this contextual data across teams to reduce silos.\n\nThis requires an EDR solution that can monitor the actions performed by processes on cloud workloads and\nimplement effective segmentation to contain risks. In addition, organizations need an NDR system that can\nrecognize network-based evidence of attacks and malicious lateral movements to ideally block the malware\nbefore it can take hold of the target hosts.\n\nA secure multi-cloud environment requires securing all workload access and communications, both inside and\nacross multiple clouds. Easily operationalizing security across clouds requires a scale-out architecture with\nsoftware that gives the underlying infrastructure—firewalls, network detection and response, meshes, and load\nbalancers—the same elasticity as modern, distributed applications.\n\nA Zero Trust strategy can help organizations embed security throughout their infrastructure. Zero Trust offers a\nconnected approach—joining users, devices, workloads and networks—to help organizations systematically\naddress the threat vectors that make up their attack surface. Organizations can ensure they are implementing\ncontrol points and distributing security across the infrastructure to better protect data and operations. With\nvisibility, context, actionable insights, and control points embedded throughout the environment, organizations\ncan start to spot and stop many of today’s threats before they can even get started.\n\n###### How VMware can help\n\nVMware can deliver security as a built-in distributed service across your control points of users, devices,\nworkloads and networks. With VMware, you can implement Zero Trust with fewer tools and silos, and scale\nresponse with confidence, speed and accuracy. When security becomes intrinsic, you reduce your attack\nsurface to mitigate security risk, ensure compliance, and simplify security operations.\n\nWith VMware Security, you can deliver the speed and security required of the modern enterprise. You can\ntransition to next-gen systems and modern applications, without increasing security complexity, and with\ndramatically fewer blind spots or choke points. Through vendor, agent and tool consolidation, you can achieve\nbetter security outcomes and deliver better employee and customer experiences, while spending less time on\nadministrative tasks.\n\n|Col1|Col2|Col3|Col4|Col5|Col6|Col7|Col8|Col9|Col10|Col11|Col12|Col13|Col14|Col15|Col16|Col17|Col18|Col19|Col20|Col21|Col22|Col23|Col24|Col25|Col26|Col27|Col28|Col29|Col30|Col31|Col32|Col33|\n|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|\n||||||||||||||||||||||||||||||||||\n||||||||||||||||||||||||||||||||||\n||||||||||||||||||||||||||||||||||\n||||||||||||||||||||||||||||||||||\n||||||||||||||||||||||||||||||||||\n||||||||||||||||||||||||||||||||||\n||||||||||||||||||||||||||||||||||\n||||||||||||||||||||||||||||||||||\n||||||||||||||||||||||||||||||||||\n||||||||||||||||||||||||||||||||||\n||||||||||||||||||||||||||||||||||\n||||||||||||||||||||||||||||||||||\n||||||||||||||r d t i n i D v k h||e o d o f s a l|||k a w . h i e e h|||||||||||||||\n\n\n-----\n\nWith VMware, you operationalize more of your security through your IT and development teams by creating a\ncommon source of truth and dramatically increasing your capacity to protect and defend your infrastructure.\nThe authoritative context from the visibility, depth and accuracy of VMware’s data collection enables security\nteams to confidently respond to events occurring within the organization’s assets. This allows an organization’s\nmost critical assets—its people—to focus on high-value activities, using VMware’s intelligent risk correlation\nwith proactive prevention, detection and response capabilities.\n\nVMware Security provides many capabilities to protect organizations from advanced threats targeting\nmulti-cloud environments, such as ransomware, cryptominers, and remote access tools, as described in this\nthreat report:\n\n- Organizations focusing on protecting end-user solutions can utilize VMware Workspace ONE®, VMware\n\nHorizon®, and VMware Carbon Black Cloud[™] to stop advanced threats from entering the environment.\n\n- VMware vSphere®, VMware NSX® Advanced Threat Prevention[™], VMware Carbon Black Cloud,\n\nCloudHealth® Secure State[™], VMware Tanzu®, VMware vRealize® Suite, and VMware NSX provide\norganizations with robust capabilities to protect against, detect and respond to advanced threats in multicloud environments.\n\nBy partnering with VMware, organizations can capitalize on enterprise modernization efforts, continuously\nincorporating security into all aspects of the technology stack to accelerate Zero Trust strategies and achieve a\nmore effective security posture.\n\n|ur ea ep rin ig on to ar se ™ d u® tec|se sin th g h- se p e, r s to Th , V t|cu g an wit val c ro cr olu st re M ag|rit yo d hi ue ap te yp tio op at w ain|y t ur ac n t a ab ct to n ad Pr are st,|hro ca cu he cti ilit or mi s c va ev v d|u p rac or viti ies ga ne an nc en Re et|gh aci y ga es . niz rs, ut ed tio ali ect|yo ty of ni , u at a iliz t n™ ze a|ur to V za sin io nd e hre , ® nd|IT pr Mw tio g ns re VM at VM Sui re|a ot ar n’s V fro m w s f w te sp|nd ec e’ a Mw m ot ar ro ar , a on|d t a s d ss ar a e a e m e C nd d|ev nd at ets e’ dv cc Wo en ar V to|elo d a c . T s in an es rk te bo M ad|p efe oll hi te ce s t sp rin n wa va|me nd ec s a lli d oo ac g t Bl re nc|nt y tio llo ge thr ls e he ac N ed|te ou n ws nt ea , a ON e k C SX th|am r i en a ris ts s d E nv lo pr re|s nfr ab n o k c ta e ®, iro ud ov at|by as le rg or rg scr V nm , id s i|cr tru s s an re eti ib Mw e e n|ea ct ec iz lat ng ed ar nt. mu|tin ur uri ati ion in e lti-|g e. ty on th|a ’s is|Col29|Col30|Col31|Col32|Col33|Col34|Col35|\n|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|\n\n\n-----\n\n#### References\n\n1 W3Techs. “Usage statistics of operating systems for web sites.” Dec. 2021.\n\n2 Microsoft. \"HAFNIUM targeting Exchange Servers.\" March 2, 2021.\n\n3 Cybersecurity and Infrastructure Security Agency. \"Alert (AA21-291A BlackMatter Ransomware.\" Oct. 18, 2021.\n\n4 CBT Nuggets. \"Why Linux runs 90 percent of the public cloud workload.\" August 10, 2018.\n\n5 Federal Bureau of Investigation. \"Ransomware Actors Use Significant Financial Events and Stock Valuation to Facilitate Targeting and Extortion\nof Victims.” Nov. 1, 2021.\n\n6 VMware. \"Deconstructing Defray777 Ransomware.\" Threat Analysis Unit. March 11, 2021.\n\n7 Mandiant. \"Shining a Light on Darkside Ransomware Operations.” Jordan Nuce, Jeremy Kennelly, Kimberly Goody, Andrew Moore,Brendan\nMcKeague, Jared Wilson. May 11, 2021.\n\n8 VMware. “HelloKitty: The Victim’s Perspective.” Threat Analysis Unit. Sept. 9, 2021.\n\n9 VMware. \"Moving Left of the Ransomware Boom.\" Oct. 11, 2021.\n\n10 Github. \"trendmicro / telfhash.\"\n\n11 Github. \"mandiant / capa.\"\n\n12 Security Affairs. \"HelloKitty ransomware now targets VMware ESXi servers.\" Pierluigi Paganini. July 15, 2021.\n\n13 Intezer. “Operation ElectroRAT: Attacker Creates Fake Companies to Drain Your Crypto Wallets.” Avigayil Mechtinger. Jan. 5, 2021.\n\n14 Wired. \"Hack Brief: Hackers Enlisted Tesla's Public Cloud to Mine Cryptocurrency.\" Lily Hay Newman. Feb. 20, 2018.\n\n15 Palo Alto Networks. \"Highlights from the Unit 42 Cloud Threat Report, 2H 2020.\" Oct. 6, 2020.\n\n16 Investopedia. “The 6 Most Private Cryptocurrencies.” Shobhit Seth. July 4, 2021.\n\n17 Miner Daily. \"How Much Does it Cost to Mine a Bitcoin?\" Sam Ling. May 4, 2021.\n\n18 Github. \"xmrig / xmrig.\"\n\n19 hex-rays. \"IDA F.L.I.R.T. Technology: In-Depth.\"\n\n20 Github. \"goretk / redress.\"\n\n21 Github. \"eliben / pyelftools\"\n\n22 hex-rays. \"F.L.I.R.T.\"\n\n23 Github. \"goretk / redress\"\n\n24 Github. \"mandiant / capa\"\n\n25 Github. \"trendmicro / telfhash.\"\n\n26 ebpf.io.\n\n27 Github. \"aquasecurity / tracee.\"\n\n28 virustotal.com\n\n29 Bleeping Computer. “REvil ransomware’s new Linux encryptor targets ESXi virtual machines.” Lawrence Abrams. June 28, 2021.\n\n30 ARS Technica. \"FBI, others crush REvil using ransomware gang's favorite tactic against it.” Tim De Chant. Oct. 22, 2021.\n\n31 Crowdstrike. \"Hypervisor Jackpotting, Part 1: CARBON SPIDER and SPRITE SPIDER Target ESXi Servers with Ransomware to Maximize Impact.\"\n\nEric Loui-Sergei Frankoff. Feb. 26, 2021.\n\n32 VMware. \"Critical Infrastructure Remains at Risk Following Ransomware Attack.” Rick McElroy. May 11, 2021.\n\n33 Mandiant. \"Shining a Light on Darkside Ransomware Operations.\" Jordan Nuce, Jeremy Kennelly, Kimberly Goody, Andrew Moore, Brendan\n\nMcKeague, Jared Wilson. May 11, 2021.\n\n34 Insikt Group. \"BlackMatter Ransomware Emerges as Successor to DarkSide, REvil.\" July 27, 2021.\n\n35 VMware. \"Deconstructing Defray777 Ransomware.\" Threat Analysis Unit. March 11, 2021.\n\n36 Bleeping Computer. “RansomEXX Ransomware Linux encryptor may damage victims’ files.” Lawrence Abrams. Sept. 30, 2021.\n\n37 Security Affairs. \"HelloKitty ransomware now targets VMware ESXi servers.\" Pierluigi Paganini. July 15, 2021.\n\n38 HIPPAA Journal. \"Vice Society Ransomware Gang Attacks United Health Centers of San Joaquin Valley.\" Sept. 27, 2021.\n\n39 Trend Micro. “Erebus Resurfaces as Linux Ransomware.” Ziv Chang, Gilbert Sison, Jeanne Jocson. June 19, 2017.\n\n40 Github. \"tarcisio-marinho / GonnaCry.\"\n\n41 Anomali Threat Research. \"The eCh0raix Ransomware.\" July 10, 2019.\n\n|sit ch 2 (A clou e S at A erat nal 1, 2 wa om to hre obh|es.” , 2 A21 d ign na ion ysi 021 re E pan Mi at it S|De 021 -29 wor ific lysi s.” s U . SX ies ne Rep eth|c. . 1A klo ant s U Jor nit. i se to Cry ort . J|202 Bla ad. Fin nit. da Se rve Dra pto , 2 uly|1. ckM \" A an M n N pt. rs. in Y cur H 2 4, 2|at ugu cial arch uce 9, 2 \" Pi ou ren 020 02|ter st 1 Ev 11, , J 02 erlu r C cy. .\" 1.|Ran 0, ent 20 ere 1. igi ryp \" Li Oct|so 201 s a 21. my Pa to ly H . 6,|mw 8. nd Ke gan Wal ay 20|are Sto nne ini lets Ne 20.|.\" O ck V lly, . Ju .” wm|ct. alu Ki ly 1 Avi an|18 ati mb 5, 2 gay . Fe|, 20 on erly 02 il M b.|21. to F Go 1. ec 20,|aci od htin 20|lita y, A ger 18.|te T nd . Ja|arg rew n.|eti M 5, 2|ng oor 02|and e,B 1.|Ex ren|tor da|tio n|n|Col29|Col30|Col31|Col32|Col33|Col34|Col35|\n|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|\n\n\n-----\n\n42 Bleeping Computer. \"New eCh0raix Ransomware Brute-Forces QNAP NAS Devices.\" Sergiu Gatlan. July 10, 2019.\n\n43 Github. \"xmrig / xmrig.\"\n\n44 Cujo AI. “The Sysrv Botnet and How it Evolved.” September 22, 2021.\n\n45 Sysdig. \"THREAT ALERT: Crypto miner attack – Sysrv-Hello Botnet targeting WordPress pods.\" Stefano Chierici. August 26, 2021.\n\n46 Palo Alto Networks. \"Hildegard: New TeamTNT cryptojacking Malware Targeting Kubernetes.\" Jay Chen, Aviv Sasson, Ariel Zelivansky. Feb. 3,\n\n2021.\n\n47 Anomali Threat Research. “Inside TeamTNT’s Impressive Arsenal: A Look into a TeamTNT Server.” Tara Gould. Oct. 6, 2021,\n\n48 hex-rays. \"IDA F.L.I.R.T. Technology: In-Depth.\"\n\n49 Bitdefender. “How We Tracked a Threat Group Running an Active Cryptojacking Campaign.\" July 14, 2021.\n\n50 AT&T Business. “AT&T Alient Labs analysis of an active cryptomining work.” Fernando Dominguez. Jan. 9, 2020.\n\n51 Unit 42, Palo Alto Networks. \"Exposing a Cryptojacking Campaign That's Operated for Two Years.\" Nathaniel Quist. Feb. 17, 2021.\n\n52 Aqua Security. “Kinsing Malware Attacks Container Environments.” Gal Singer. April 3, 2020.\n\n53 Intezer. \"Vermilion Strike: Linux and Windows Re-implementation of Cobalt Strike.\" Avigayil Mechtinger, Ryan Robinson, Joakim Kennedy. Sept.\n\n13, 2021.\n\n54 Github. \"darkr4y / geacon.\"\n\n55 Github. \"gloxec / CrossC2.\"\n\n56 NCC Group. “Striking Back at Retired Cobalt Strike: A look at a legacy vulnerability.” June 15, 2020.\n\n57 virustotal.com. \"52.157.171.98.\"\n\n58 Cobalt Strike User Guide. \"External C2.\"\n\n59 VMware Carbon Black. “Knock, knock, Neo. Active C2 Discovery Using Protocol Emulation.” Takahiro Haruyama,\n\n60 Fox IT. \"Identifying Cobalt Strike team servers in the wild.\" Feb. 26, 2019.\n\n61 Medium. “Identifying Cobalt Strike team servers in the wild by using ZoomEye (Part 2).\" heige, KnownSec 404 Team. April 10, 2020.\n\n62 Cobalt Strike. \"Cobalt Strike Team Server Population Study.\" Raphael Mudge. Feb. 19, 2019.\n\n63 Cobalt Strike User Guide. “Malleable Command and Control.”\n\n64 Github. \"Salesforce / jarm.\"\n\n65 Cobalt Strike User Guide. \"License Authorization Files.\"\n\n66 Cobalt Strike. “Cobalt Strike Trial’s Evil Bit.” Raphael Mudge. Oct. 14, 2015.\n\n67 MITRE ATT&CK. “Proxy: Domain Fronting.”.\n\n68 Cobalt Strike. “High-reputation Redirectors and Domain Fronting.” Raphael Mudge.Feb. 6, 2017.\n\n69 Microsoft. \"Securing our approach to domain fronting within Azure.\" Eric Doerr. March 26, 2021.\n\n70 NVISO Labs. “Cobalt Strike: Using Known Private Keys to Decrypt Traffic – Part 1.\" Didier Stevens. Oct. 21, 2021.\n\n71 Cobalt Strike User Guide. “License Authorization Files.”\n\n72 Group IB. “Big airline heist.” Nikita Rostovcev. Oct. 6, 2021.\n\n73 LAC Watch. “Targeted attack by \"Cobalt Strike loader\" that abuses Microsoft's digital signature ~ Attacker group APT41.\" Yoshihiro Ishikawa. May\n\n21, 2021.\n\n74 Github. \"Ne0nd0g / merlin.\"\n\n75 Juniper Networks. “Linux Servers Hijacked to Implant SSH Backdoor.” Asher Langton. April 26, 2021.\n\n76 Security Boulevard. \"Detect C2 ‘RedXOR’ with state-based functionality.” Ben Reardon. April 20, 2021.\n\n77 Intezer. “ACBackdoor: Analysis of a New Multiplatform Backdoor.” Ignacio Sanmillan. Nov. 18, 2019.\n\n78 JPCERT CC. “ELF_PLEAD – Linux MalwareUsed by BlackTech.” Nov. 16, 2020.\n\nThis report may contain hyperlinks to non-VMware websites that are created and maintained by third parties who are solely responsible for the content\non such websites.\n\nLinux® is the registered trademark of Linus Torvalds in the U.S. and other countries.\n\n|For ber ello kin Ars an A ypt Cam on en k a|ces 22, Bo g M en cti om pa men tati t a|Q 20 tne al al: ve inin ign ts. on leg|NA 21. t ta war A L Cry g Th ” G of C acy|P N rge e T ook pto wor at's al S ob vu|AS tin arg int jac k.” O ing alt lne|De g W etin o a kin Fer per er. Str rab|vic or g K Te g C na ate Ap ike. ility|es.\" dPr ub am am ndo d fo ril 3 \" A .” J|Se ess ern TN pai Do r T , 2 vig un|rgi po ete T Se gn. mi wo 020 ayil e 15|u G ds. s.\" rv \" Ju ngu Yea . Me , 2|atla \" St Jay er.” ly ez rs. ch 020|n. efa Ch Tar 14, . Ja \" N ting .|Jul no en a G 202 n. ath er,|y 10 Chi , Av ou 1. 9, 2 ani Ry|, 2 eri iv ld. 02 el Q an|019 ci. Sas Oct 0. uis Rob|. Aug son . 6 t. F ins|ust , A , 20 eb on|26 riel 21, . 17 , Jo|, 2 Ze , 20 aki|021 liva 21. m|. nsk Ken|y. ne|Feb dy.|. 3, Sep|t.|Col29|Col30|Col31|Col32|Col33|Col34|Col35|\n|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|\n\n\n-----\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "bf5be533-fa31-4590-ae37-5761c97ffa34",
            "created_at": "2022-10-25T16:13:58.389257Z",
            "updated_at": "2022-10-25T16:13:58.389257Z",
            "deleted_at": null,
            "name": "Malpedia",
            "url": "https://malpedia.caad.fkie.fraunhofer.de",
            "description": "Malpedia is a free service offered by Fraunhofer FKIE",
            "reports": null
        }
    ],
    "references": [
        "https://www.vmware.com/content/dam/digitalmarketing/vmware/en/pdf/docs/vmw-exposing-malware-in-linux-based-multi-cloud-environments.pdf"
    ],
    "report_names": [
        "vmw-exposing-malware-in-linux-based-multi-cloud-environments.pdf"
    ],
    "threat_actors": [
        {
            "id": "2646f776-792a-4498-967b-ec0d3498fdf1",
            "created_at": "2022-10-25T15:50:23.475784Z",
            "updated_at": "2025-03-27T02:00:55.479958Z",
            "deleted_at": null,
            "main_name": "BlackTech",
            "aliases": [
                "BlackTech",
                "Palmerworm"
            ],
            "source_name": "MITRE:BlackTech",
            "tools": [
                "Kivars",
                "PsExec",
                "TSCookie",
                "Flagpro",
                "Waterbear"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "529c1ae9-4579-4245-86a6-20f4563a695d",
            "created_at": "2022-10-25T16:07:23.702006Z",
            "updated_at": "2025-03-27T02:02:09.93109Z",
            "deleted_at": null,
            "main_name": "Hafnium",
            "aliases": [
                "Red Dev 13",
                "Silk Typhoon"
            ],
            "source_name": "ETDA:Hafnium",
            "tools": [],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "d90307b6-14a9-4d0b-9156-89e453d6eb13",
            "created_at": "2022-10-25T16:07:23.773944Z",
            "updated_at": "2025-03-27T02:02:09.974695Z",
            "deleted_at": null,
            "main_name": "Lead",
            "aliases": [
                "Casper",
                "TG-3279"
            ],
            "source_name": "ETDA:Lead",
            "tools": [
                "Agentemis",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "RbDoor",
                "RibDoor",
                "Winnti",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "eb3f4e4d-2573-494d-9739-1be5141cf7b2",
            "created_at": "2022-10-25T16:07:24.471018Z",
            "updated_at": "2025-03-27T02:02:10.24394Z",
            "deleted_at": null,
            "main_name": "Cron",
            "aliases": [],
            "source_name": "ETDA:Cron",
            "tools": [
                "Catelites",
                "Catelites Bot",
                "CronBot",
                "TinyZBot"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "d3a7123c-f519-49a0-a234-de24a1ef052a",
            "created_at": "2022-10-25T16:47:55.545211Z",
            "updated_at": "2025-03-27T02:05:17.254744Z",
            "deleted_at": null,
            "main_name": "BRONZE CANAL",
            "aliases": [
                "CTG-6177 ",
                "Circuit Panda ",
                "Palmerworm ",
                "Shrouded Crossbow ",
                "BlackTech"
            ],
            "source_name": "Secureworks:BRONZE CANAL",
            "tools": [
                " DRIGO",
                " Flagpro",
                " Gh0stTimes",
                " PLEAD",
                " Spiderpig",
                " Waterbear",
                "Bifrose"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "610a7295-3139-4f34-8cec-b3da40add480",
            "created_at": "2023-01-06T13:46:38.608142Z",
            "updated_at": "2025-03-27T02:00:02.87217Z",
            "deleted_at": null,
            "main_name": "Cobalt",
            "aliases": [
                "Cobalt Gang",
                "GOLD KINGSWOOD",
                "COBALT SPIDER",
                "G0080",
                "Mule Libra",
                "Cobalt Group"
            ],
            "source_name": "MISPGALAXY:Cobalt",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "7c969685-459b-4c93-a788-74108eab6f47",
            "created_at": "2023-01-06T13:46:39.189751Z",
            "updated_at": "2025-03-27T02:00:03.017103Z",
            "deleted_at": null,
            "main_name": "HAFNIUM",
            "aliases": [
                "ATK233",
                "G0125",
                "Operation Exchange Marauder",
                "Red Dev 13",
                "Silk Typhoon"
            ],
            "source_name": "MISPGALAXY:HAFNIUM",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "75024aad-424b-449a-b286-352fe9226bcb",
            "created_at": "2023-01-06T13:46:38.962724Z",
            "updated_at": "2025-03-27T02:00:02.964002Z",
            "deleted_at": null,
            "main_name": "BlackTech",
            "aliases": [
                "CIRCUIT PANDA",
                "Temp.Overboard",
                "G0098",
                "Red Djinn",
                "HUAPI",
                "Palmerworm",
                "T-APT-03",
                "Manga Taurus",
                "Earth Hundun"
            ],
            "source_name": "MISPGALAXY:BlackTech",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "f809bfcb-b200-4988-80a8-be78ef6a52ef",
            "created_at": "2023-01-06T13:46:39.186988Z",
            "updated_at": "2025-03-27T02:00:03.016358Z",
            "deleted_at": null,
            "main_name": "TeamTNT",
            "aliases": [
                "Adept Libra"
            ],
            "source_name": "MISPGALAXY:TeamTNT",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "efa7c047-b61c-4598-96d5-e00d01dec96b",
            "created_at": "2022-10-25T16:07:23.404442Z",
            "updated_at": "2025-03-27T02:02:09.781478Z",
            "deleted_at": null,
            "main_name": "BlackTech",
            "aliases": [
                "BlackTech",
                "Circuit Panda",
                "Earth Hundun",
                "Manga Taurus",
                "Operation PLEAD",
                "Operation Shrouded Crossbow",
                "Operation Waterbear",
                "Palmerworm",
                "Radio Panda",
                "Red Djinn",
                "T-APT-03",
                "TEMP.Overboard"
            ],
            "source_name": "ETDA:BlackTech",
            "tools": [
                "BIFROST",
                "BUSYICE",
                "BendyBear",
                "Bluether",
                "CAPGELD",
                "DRIGO",
                "Deuterbear",
                "Flagpro",
                "GOODTIMES",
                "Gh0stTimes",
                "IconDown",
                "KIVARS",
                "LOLBAS",
                "LOLBins",
                "Linopid",
                "Living off the Land",
                "TSCookie",
                "Waterbear",
                "XBOW",
                "elf.bifrose"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "84aa9dbe-e992-4dce-9d80-af3b2de058c0",
            "created_at": "2024-02-02T02:00:04.041676Z",
            "updated_at": "2025-03-27T02:00:03.297502Z",
            "deleted_at": null,
            "main_name": "Vanilla Tempest",
            "aliases": [
                "DEV-0832",
                "Vice Society"
            ],
            "source_name": "MISPGALAXY:Vanilla Tempest",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "7268a08d-d4d0-4ebc-bffe-3d35b3ead368",
            "created_at": "2022-10-25T16:07:24.225216Z",
            "updated_at": "2025-03-27T02:02:10.144446Z",
            "deleted_at": null,
            "main_name": "Sprite Spider",
            "aliases": [
                "Gold Dupont",
                "Sprite Spider"
            ],
            "source_name": "ETDA:Sprite Spider",
            "tools": [
                "Agentemis",
                "Cobalt Strike",
                "CobaltStrike",
                "Coroxy",
                "Defray 2018",
                "Defray777",
                "DroxiDat",
                "Glushkov",
                "LaZagne",
                "Metasploit",
                "PyXie",
                "PyXie RAT",
                "Ransom X",
                "RansomExx",
                "SharpHound",
                "Shifu",
                "SystemBC",
                "Target777",
                "Vatet",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "bfded1cf-be73-44f9-a391-0751c9996f9a",
            "created_at": "2022-10-25T15:50:23.337107Z",
            "updated_at": "2025-03-27T02:00:55.445946Z",
            "deleted_at": null,
            "main_name": "FIN7",
            "aliases": [
                "FIN7",
                "GOLD NIAGARA",
                "ITG14",
                "Carbon Spider",
                "ELBRUS",
                "Sangria Tempest"
            ],
            "source_name": "MITRE:FIN7",
            "tools": [
                "Mimikatz",
                "AdFind",
                "JSS Loader",
                "HALFBAKED",
                "REvil",
                "PowerSploit",
                "CrackMapExec",
                "Carbanak",
                "Pillowmint",
                "Cobalt Strike",
                "POWERSOURCE",
                "RDFSNIFFER",
                "SQLRat",
                "Lizar",
                "TEXTMATE",
                "BOOSTWRITE"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "2704d770-43b4-4bc4-8a5a-05df87416848",
            "created_at": "2022-10-25T15:50:23.306305Z",
            "updated_at": "2025-03-27T02:00:55.43633Z",
            "deleted_at": null,
            "main_name": "HAFNIUM",
            "aliases": [
                "HAFNIUM",
                "Operation Exchange Marauder",
                "Silk Typhoon"
            ],
            "source_name": "MITRE:HAFNIUM",
            "tools": [
                "Tarrask",
                "ASPXSpy",
                "Impacket",
                "PsExec",
                "China Chopper"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "c3ca592f-0669-49bd-ab5c-310007ab2fb4",
            "created_at": "2022-10-25T15:50:23.334495Z",
            "updated_at": "2025-03-27T02:00:55.445098Z",
            "deleted_at": null,
            "main_name": "TeamTNT",
            "aliases": [
                "TeamTNT"
            ],
            "source_name": "MITRE:TeamTNT",
            "tools": [
                "Peirates",
                "MimiPenguin",
                "LaZagne",
                "Hildegard"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "27e51b73-410e-4a33-93a1-49cf8a743cf7",
            "created_at": "2023-01-06T13:46:39.210675Z",
            "updated_at": "2025-03-27T02:00:03.022315Z",
            "deleted_at": null,
            "main_name": "GOLD DUPONT",
            "aliases": [
                "SPRITE SPIDER"
            ],
            "source_name": "MISPGALAXY:GOLD DUPONT",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "f4f16213-7a22-4527-aecb-b964c64c2c46",
            "created_at": "2024-06-19T02:03:08.090932Z",
            "updated_at": "2025-03-27T02:05:17.387119Z",
            "deleted_at": null,
            "main_name": "GOLD NIAGARA",
            "aliases": [
                "Carbanak",
                "Carbon Spider ",
                "FIN7 ",
                "Navigator ",
                "Sangria Tempest ",
                "TelePort Crew ",
                "Calcium "
            ],
            "source_name": "Secureworks:GOLD NIAGARA",
            "tools": [
                " Carbanak",
                " Cobalt Strike",
                " DICELOADER",
                " DRIFTPIN",
                " GGLDR",
                " GRIFFON",
                " JSSLoader",
                " Meterpreter",
                " OFFTRACK",
                " PILLOWMINT",
                " POWERTRASH",
                " SUPERSOFT",
                " TAKEOUT",
                " TinyMet",
                "Bateleur"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "07775b09-acd9-498e-895f-f10063115629",
            "created_at": "2024-06-04T02:03:07.817613Z",
            "updated_at": "2025-03-27T02:05:17.351811Z",
            "deleted_at": null,
            "main_name": "GOLD DUPONT",
            "aliases": [
                "Sprite Spider "
            ],
            "source_name": "Secureworks:GOLD DUPONT",
            "tools": [
                " ArtifactExx",
                " Cobalt Strike",
                " Defray",
                " Metasploit",
                " PyXie",
                " Shifu",
                " SystemBC",
                " Vatet",
                "777"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "4c68ccd0-caba-4189-9ead-86ac4c2d9b70",
            "created_at": "2024-05-01T02:03:07.930196Z",
            "updated_at": "2025-03-27T02:05:17.251237Z",
            "deleted_at": null,
            "main_name": "BRONZE ATLAS",
            "aliases": [
                "Axiom",
                "BARIUM ",
                "Blackfly ",
                "CTG-2633",
                "GREF",
                "Group 72 ",
                "Red Kelpie ",
                "TG-2633 ",
                "Wicked Panda ",
                "Winnti",
                "APT41 "
            ],
            "source_name": "Secureworks:BRONZE ATLAS",
            "tools": [
                " CCleaner v5.33 backdoor",
                " ChinaChopper",
                " Cobalt Strike",
                " Dicey MSDN",
                " ForkPlayground",
                " HUC Proxy Malware (Htran)",
                " Mimikatz",
                " PipeMon",
                " PlugX",
                " PortReuse",
                " Powershell Empire",
                " RCMD",
                " RbDoor",
                " SPEEDBOAT",
                " ShadowPad",
                " Sidewalk",
                " Speculoos",
                " TeamViewer",
                " Winnkit",
                " Winnti",
                " reg save",
                " vssadmin",
                "Acehash"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "600a0c3b-b595-4d10-b84b-cc2cf89289ac",
            "created_at": "2024-06-19T02:03:08.134296Z",
            "updated_at": "2025-03-27T02:05:17.402638Z",
            "deleted_at": null,
            "main_name": "GOLD VICTOR",
            "aliases": [
                "STAC5279 ",
                "Vanilla Tempest ",
                "Vice Society",
                "DEV-0832 "
            ],
            "source_name": "Secureworks:GOLD VICTOR",
            "tools": [
                " Advanced Port Scanner",
                " HelloKitty ransomware",
                " MEGAsync",
                " Neshta",
                " PAExec",
                " PSexec",
                " PortStarter",
                " SystemBC",
                " Zeppelin ransomware",
                "Advanced IP Scanner"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "bb8702c5-52ac-4359-8409-998a7cc3eeaf",
            "created_at": "2023-01-06T13:46:38.405479Z",
            "updated_at": "2025-03-27T02:00:02.82533Z",
            "deleted_at": null,
            "main_name": "FIN7",
            "aliases": [
                "JokerStash",
                "ATK32",
                "G0046",
                "Coreid",
                "Carbanak",
                "Sangria Tempest",
                "CARBON SPIDER",
                "GOLD NIAGARA",
                "G0008",
                "ELBRUS",
                "Carbon Spider"
            ],
            "source_name": "MISPGALAXY:FIN7",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "4d5f939b-aea9-4a0e-8bff-003079a261ea",
            "created_at": "2023-01-06T13:46:39.04841Z",
            "updated_at": "2025-03-27T02:00:02.985296Z",
            "deleted_at": null,
            "main_name": "APT41",
            "aliases": [
                "G0096",
                "Grayfly",
                "BARIUM",
                "BRONZE ATLAS",
                "BRONZE EXPORT",
                "Red Kelpie",
                "HOODOO",
                "Brass Typhoon",
                "TA415",
                "WICKED SPIDER",
                "WICKED PANDA",
                "G0044",
                "Earth Baku"
            ],
            "source_name": "MISPGALAXY:APT41",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "e698860d-57e8-4780-b7c3-41e5a8314ec0",
            "created_at": "2022-10-25T15:50:23.287929Z",
            "updated_at": "2025-03-27T02:00:55.43005Z",
            "deleted_at": null,
            "main_name": "APT41",
            "aliases": [
                "APT41",
                "Wicked Panda",
                "Brass Typhoon",
                "BARIUM"
            ],
            "source_name": "MITRE:APT41",
            "tools": [
                "ASPXSpy",
                "BITSAdmin",
                "PlugX",
                "Impacket",
                "gh0st RAT",
                "netstat",
                "PowerSploit",
                "ZxShell",
                "KEYPLUG",
                "ipconfig",
                "sqlmap",
                "China Chopper",
                "ShadowPad",
                "MESSAGETAP",
                "Mimikatz",
                "certutil",
                "njRAT",
                "Cobalt Strike",
                "pwdump",
                "BLACKCOFFEE",
                "ROCKBOOT",
                "dsquery",
                "Winnti for Linux",
                "DUSTTRAP",
                "Derusbi",
                "ftp"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "ed3810b7-141a-4ed0-8a01-6a972b80458d",
            "created_at": "2022-10-25T16:07:23.443259Z",
            "updated_at": "2025-03-27T02:02:09.801771Z",
            "deleted_at": null,
            "main_name": "Carbanak",
            "aliases": [
                "Anunak",
                "Carbanak",
                "Carbon Spider",
                "ELBRUS",
                "Gold Waterfall",
                "Sangria Tempest"
            ],
            "source_name": "ETDA:Carbanak",
            "tools": [
                "AVE_MARIA",
                "Agentemis",
                "AmmyyRAT",
                "Antak",
                "Anunak",
                "Ave Maria",
                "AveMariaRAT",
                "BABYMETAL",
                "BIRDDOG",
                "Backdoor Batel",
                "Batel",
                "Bateleur",
                "BlackMatter",
                "Boostwrite",
                "Cain & Abel",
                "Carbanak",
                "Cl0p",
                "Cobalt Strike",
                "CobaltStrike",
                "DNSMessenger",
                "DNSRat",
                "DNSbot",
                "DRIFTPIN",
                "DarkSide",
                "FOXGRABBER",
                "FlawedAmmyy",
                "HALFBAKED",
                "JS Flash",
                "KLRD",
                "MBR Eraser",
                "Mimikatz",
                "Nadrac",
                "Odinaff",
                "POWERPIPE",
                "POWERSOURCE",
                "PsExec",
                "SQLRAT",
                "Sekur",
                "Sekur RAT",
                "SocksBot",
                "SoftPerfect Network Scanner",
                "Spy.Agent.ORM",
                "TEXTMATE",
                "TeamViewer",
                "TiniMet",
                "TinyMet",
                "Toshliph",
                "VB Flash",
                "WARPRISM",
                "avemaria",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "a6c351ea-01f1-4c9b-af75-cfbb3b269ed3",
            "created_at": "2023-01-06T13:46:39.390649Z",
            "updated_at": "2025-03-27T02:00:03.072899Z",
            "deleted_at": null,
            "main_name": "Kinsing",
            "aliases": [
                "Money Libra"
            ],
            "source_name": "MISPGALAXY:Kinsing",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "f9806b99-e392-46f1-9c13-885e376b239f",
            "created_at": "2023-01-06T13:46:39.431871Z",
            "updated_at": "2025-03-27T02:00:03.08926Z",
            "deleted_at": null,
            "main_name": "Watchdog",
            "aliases": [
                "Thief Libra"
            ],
            "source_name": "MISPGALAXY:Watchdog",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1666716504,
    "ts_updated_at": 1743041821,
    "ts_creation_date": 1644329629,
    "ts_modification_date": 1644329650,
    "files": {
        "pdf": "https://archive.orkl.eu/df14862e85f709fbba2b4c9a66ed9cf590baf6c9.pdf",
        "text": "https://archive.orkl.eu/df14862e85f709fbba2b4c9a66ed9cf590baf6c9.txt",
        "img": "https://archive.orkl.eu/df14862e85f709fbba2b4c9a66ed9cf590baf6c9.jpg"
    }
}