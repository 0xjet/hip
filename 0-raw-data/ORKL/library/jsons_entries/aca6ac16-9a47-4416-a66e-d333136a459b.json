{
    "id": "aca6ac16-9a47-4416-a66e-d333136a459b",
    "created_at": "2023-01-12T15:03:13.964092Z",
    "updated_at": "2025-03-27T02:05:53.4088Z",
    "deleted_at": null,
    "sha1_hash": "4d392330b6cd1f70000d436c0bb7200b986df4e3",
    "title": "2021-10-27 - Vidar stealer campaign targeting Baltic region and NATO entities",
    "authors": "",
    "file_creation_date": "2022-05-27T22:31:39Z",
    "file_modification_date": "2022-05-27T22:31:39Z",
    "file_size": 3440326,
    "plain_text": "# Vidar stealer campaign targeting Baltic region and NATO entities\n\n**cert.pl/en/posts/2021/10/vidar-campaign/**\n\n### While working on our automatic configuration extractors, we came across a rather strange- looking Vidar sample.\n\n The decrypted strings included domain names of such organizations as the NATO Strategic Communications Centre of Excellence, Border Guard of Poland, Estonia and Latvia, and Ministry of the Interior of Lithuania.\n\n\n-----\n\n### Automatically extracted strings from a Vidar sample\n\n List of targeted hostnames:\n```\nccdcoe.ee\nccdcoe.org\nstratcomcoe.org\nenseccoe.org\nsab.gov.lv\nmidd.gov.lv\ndp.gov.lv\nrs.gov.lv\nvp.gov.lv\nmod.gov.lv\ncert.lv\nmil.lv\ngov.lt\nmil.lt\nvsd.lt\nvrm.lt\nstt.lt\nkapo.ee\npolitsei.ee\naw.gov.pl\nabw.gov.pl\nstrazgraniczna.pl\nbbn.gov.pl\nsww.gov.pl\nmon.gov.pl\nskw.gov.pl\ncert.pl\n\n```\n\n-----\n\n## Vidar Stealer\n\n### During this analyiss we'll be looking at sample\n```\nb115531ef23c109fb58c392379b7f55eff11169e1317b263da60edd9ac98f6b1 .\n\n Vidar Stealer, as the name suggests, is a malware family that is designed to steal and exfiltrate user information. This includes data such as credentials, cryptocurrency wallets and browser cookies.\n\n It's widely believed that the family evolved from Arkei Stealer - another infostealer with similar capabilities. There is an excellent blogpost1 by @fumik0_ describing the similarities and differences.\n\n While previous versions of the malware used to have C&C server address hardcoded directly in the sample, these days, it uses a bit more novel approach where the address is fetched from a social media platform like FACEIT or Mastodon.\n\n## String decryption and usage\n\n### Let's see how the strings in question were extracted and what are the semantics behind their usage.\n\n The encryption is pretty straightforward. Each blob is produced by xoring two static strings located in the .rdata section.\n\n Xor string decryption\n\n```\n\n-----\n\n### The decoded strings are then used in a subsequent section of the binary, where they are compared with hostnames of stolen credentials.\n\n Iteration over stolen credentials\n\n If at least one domain is matched, a global flag is incremented.\n\n Hostname needle search\n\n\n-----\n\n### What s unusual about these Vidar samples is the use of a second C&C server responsible for handling credentials used when the global flag is set.\n\n Alternative C&C server lookup\n\n For the Vidar version analyzed, the C&C address is not stored directly in the sample but fetched from a specific user profile on the Mastodon platform.\n\n In this specific sample, the default profile is @oleg98, and for reporting credentials from hosts of interest, @artemida is used.\n\n\n-----\n\n### Mastadon artemida profile - pointing to 167.86.127.231\n\n Mastadon oleg98 profile - pointing to 65.108.80.190\n\n## Campaign background\n\n### Unfortunately, we don't have much information on how the campaign was delivered and which entities were targeted directly. What is interesting, though, is that the actor used several other malware families.\n\n\n-----\n\n### Let s take a look at source samples in MWDB. We ll use mwdblib to quickly find the files that were extracted into the config in question.\n```\nmwdb search files 'child:(child:\n(config.dhash:abed3750173760a9bcc5f6d78ccdd3557ce27135c8c5e6e593a9a7387e738c4e))'\n\n All matched samples and accompanying tags:\n\n```\n\n-----\n\n```\n 77737d30b68a8fa75847570bfaa2c718875c532de61d7a5643504a1ac892a330,\n['feed:malwarebazaar', 'ripped:raccoon', 'ripped:vidar', 'runnable:win32:exe',\n'yara:win_karius', 'yara:win_raccoon', 'yara:win_smokeloader']\n'9405f9084c8ec3eff442b83c20928fceb3e6372d504381b0527a7512a9889231',\n['feed:malwarebazaar', 'feed:urlhaus', 'ripped:vidar', 'runnable:win32:exe',\n'urlhaus:arkeistealer', 'urlhaus:exe']\n'062c573497b73b4feaa77a78c2c76f6b095e51de635ac936e034f72afa081ecf',\n['feed:malwarebazaar', 'ripped:vidar', 'runnable:win32:exe', 'yara:win_stop']\n'c8aa42e07176d24c933d1e2bc4f0052b2973f98fc6e395d90f09e07dbf7c0585',\n['feed:malwarebazaar', 'ripped:vidar', 'runnable:win32:exe']\n'736b919068232acf7aae67e3ca5e915c89faade4110b31ff75c249ade1991ef6',\n['et:smokeloader', 'feed:malwarebazaar', 'feed:urlhaus', 'ripped:vidar',\n'runnable:win32:exe', 'urlhaus:32', 'urlhaus:exe', 'yara:win_smokeloader']\n'ebe82a7d2f2f9989a5e4ef6a4602a8224abdff7aef5baa6beacb5977c02ac3e0',\n['et:raccoon_stealer', 'et:redline', 'feed:malwarebazaar', 'ripped:raccoon',\n'ripped:vidar', 'runnable:win32:exe', 'yara:win_raccoon']\n'dbc78e2174ea6ef2807de19d0c1c60d0d027ce3d83a001d0d1bb603afad2f961', ['et:avecaesar',\n'et:raccoon_stealer', 'et:redline', 'feed:urlhaus', 'ripped:redlinestealer',\n'ripped:vidar', 'runnable:win32:exe']\n'106d93ced41d81795f66bb29ad5c847a25a1e2c094fe28a67dc576f1c33fcad4',\n['et:raccoon_stealer', 'et:redline', 'feed:urlhaus', 'ripped:raccoon',\n'ripped:vidar', 'runnable:win32:exe', 'yara:win_raccoon']\n'd7480662bc7ee6dc38227ea381978553b1774774e4a0a70ea3bf6aebbca48622', ['et:bitrat',\n'et:redline', 'feed:malwarebazaar', 'ripped:vidar', 'runnable:win32:exe']\n'4bc52cd8296fcffc22b5ca8ebf2b161260d71c8d34658f45c9c93cf6d65749e9',\n['feed:malwarebazaar', 'ripped:vidar', 'runnable:win32:exe']\n'4b3e6a191ab050a87aeeb8a650290c4e217e9508971beeb929417d13d89292e2',\n['feed:malwarebazaar', 'ripped:vidar', 'runnable:win32:exe', 'yara:win_stop']\n'c95d04ae659ff27da971c970ec072ffbec37551120fe8c395d5455fba4139d0d',\n['et:smokeloader', 'feed:malwarebazaar', 'ripped:vidar', 'runnable:win32:exe',\n'yara:win_smokeloader']\n'6aae67d87cd2ef23c4b9265c8e83db5142f00154e66e47b1e54219cea794682b',\n['feed:malwarebazaar', 'ripped:vidar', 'runnable:win32:exe', 'yara:win_stop']\n'aad6294207c2facfebf440fa5d52804422edbf9c9e9adb4a7aaff0310b1c5d11',\n['feed:malwarebazaar', 'ripped:vidar', 'runnable:win32:exe', 'yara:win_stop']\n'43b31ea75f3c0666523aefc13e216a651e8e93feaeff1165cb35ed374365cdd6',\n['feed:malwarebazaar', 'ripped:vidar', 'runnable:win32:exe', 'yara:win_stop']\n'd7b0380241e4d47fc00e72faa08831b51b0ae360d5ccc45717f39f3106c3020a',\n['feed:malwarebazaar', 'ripped:vidar', 'runnable:win32:exe', 'yara:win_karius',\n'yara:win_smokeloader']\n'995d009e2fa6b510a0251895e0e71d0709ebfdeac782eae91caa3b4ee30bd29b',\n['feed:malwarebazaar', 'ripped:redlinestealer', 'ripped:vidar', 'runnable:win32:exe',\n'yara:win_karius', 'yara:win_smokeloader']\n'6c2ad98af84288aff6f49ae92f9f71befbfaa4ac35d1a05b1441f1ce15124ee0',\n['feed:malwarebazaar', 'ripped:raccoon', 'ripped:redlinestealer', 'ripped:vidar',\n'runnable:win32:exe', 'yara:win_raccoon', 'yara:win_smokeloader', 'yara:win_stop']\n'3276f5cb5545e19704b1ef2897c17d721d6e156323f48f19275997d3cc62d005',\n['feed:malwarebazaar', 'ripped:vidar', 'runnable:win32:exe']\n'ee6cb977e78651d7b9a3fd412a40f6e2cd1501f05b04c49e744db35c83181132',\n['et:raccoon_stealer', 'et:redline', 'feed:malwarebazaar', 'ripped:raccoon',\n'ripped:redlinestealer', 'ripped:vidar', 'runnable:win32:exe', 'yara:win_raccoon',\n'yara:win_smokeloader']\n'22dbf29f7b7ee63da9418ab462b83e242823b83af7d697e7cf34796febc4d884',\n['feed:malwarebazaar', 'ripped:vidar', 'runnable:win32:exe']\n'149d9555994e5930d863674a2c55d295d5a19446bed86ef1079ccbbbdae9975f',\n\n```\n\n-----\n\n```\n[ feed:malwarebazaar, ripped:vidar, runnable:win32:exe ]\n'90618d3aa5146d27b46476a4c7bfcc2e5323b74dcbcf2c0af6b4f00c4c2d9297',\n['et:raccoon_stealer', 'et:redline', 'feed:malwarebazaar', 'ripped:vidar',\n'runnable:win32:exe']\n'7a5444f5316764d3960132052abe097784a29b7390e0ece10c86b804c125100f',\n['feed:malwarebazaar', 'ripped:vidar', 'runnable:win32:exe']\n'98ee19dbbe959081f2d95b7f56af58fcb7ecdc5b85bb9ee13775376b9bad1ccf',\n['feed:malwarebazaar', 'ripped:vidar', 'runnable:win32:exe']\n'9fefd930a1cc7b257fe5a65bc3eda3167bc0f82895f288fc34eaca3411b2688b',\n['feed:malwarebazaar', 'ripped:vidar', 'runnable:win32:exe']\n'11a83b7f651c007cef7ca9490fc560dbfda8cd6b538199e277047c8087c7cee0',\n['feed:malwarebazaar', 'ripped:vidar', 'runnable:win32:exe', 'yara:win_stop']\n'611796a36903059a2d1725d7849a375b9aa2902254c0d5f5fa2122e83570ea3a',\n['feed:malwarebazaar', 'ripped:vidar', 'runnable:win32:exe']\n'7ec5f24e6f59719e6c071ec719dcfcbe8e48f5293f493b903f19446c1815048b',\n['feed:malwarebazaar', 'ripped:vidar', 'runnable:win32:exe']\n'518e682b4f0226db5e1abb7b62a32a2f46db719b6c407317273cbef56c811657', ['feed:urlhaus',\n'ripped:vidar', 'runnable:win32:exe', 'urlhaus:arkeistealer', 'urlhaus:exe']\n'bf4d1dcd4b9129f47ec4239fa5a33e00c981e5fac5b8be880b76d2a1f5753c34',\n['feed:malwarebazaar', 'ripped:vidar', 'runnable:win32:exe']\n'd9b6823ca8e13b78c269c5d21e948dbab625ea87d3370d163eeabeb3822aef56',\n['feed:malwarebazaar', 'ripped:vidar', 'runnable:win32:exe']\n'8a2abfa467352b278a1233aead9dffbb23a6d17bd50fe22e275ca92a1911c23c', ['feed:urlhaus',\n'ripped:vidar', 'runnable:win32:exe', 'urlhaus:arkeistealer', 'urlhaus:exe']\n'1fbbaa6cfa20d6e11a3e5e4ba0702f608d474cbf5a86eef891fb57a671c684be',\n['feed:malwarebazaar', 'ripped:vidar', 'runnable:win32:exe']\n'2692f4594cebfa3afca882274dc1432fea1ccbc7d3f37db3e15059722db1d97b',\n['feed:malwarebazaar', 'ripped:vidar', 'runnable:win32:exe']\n'9cffbade290f88c34b8a5e2e551fd9ae035eeda9d49d0eb0fecec8e40ecf2e84',\n['feed:malwarebazaar', 'ripped:vidar', 'runnable:win32:exe']\n\n### We can see that besides Vidar, MWDB was also able to detect and extract configurations from the following malware families:\n\n Raccoon RedLine Stealer SmokeLoader STOP ransomware\n\n All of the recognized samples were uploaded as a part of the URLhaus,2 and MalwareBazaar3 feeds, both developed by abuse.ch.\n\n```\n\n## Indicators of Compromise\n\n### C&C profile proxies\n\n hxxps://mas.to/@sslam hxxps://mas.to/@serg4325 hxxps://mas.to/@xeroxxx hxxps://mas.to/@oleg98\n\n\n-----\n\n### hxxps://mas.to/@artemida\n\n C&C servers\n\n 65.108.80[.]190 167.86.127[.]231\n\n Samples\n```\n16c3f8999141beee55afdb49670b9e44b4916816faeb643639a7ace81c13806a\n1d4ecd52ab85b7f5229f00ee10d438286e361d4c304000abca8b3dcbe1d7c720\n77737d30b68a8fa75847570bfaa2c718875c532de61d7a5643504a1ac892a330\n9405f9084c8ec3eff442b83c20928fceb3e6372d504381b0527a7512a9889231\n062c573497b73b4feaa77a78c2c76f6b095e51de635ac936e034f72afa081ecf\nc8aa42e07176d24c933d1e2bc4f0052b2973f98fc6e395d90f09e07dbf7c0585\n736b919068232acf7aae67e3ca5e915c89faade4110b31ff75c249ade1991ef6\nebe82a7d2f2f9989a5e4ef6a4602a8224abdff7aef5baa6beacb5977c02ac3e0\ndbc78e2174ea6ef2807de19d0c1c60d0d027ce3d83a001d0d1bb603afad2f961\n106d93ced41d81795f66bb29ad5c847a25a1e2c094fe28a67dc576f1c33fcad4\nd7480662bc7ee6dc38227ea381978553b1774774e4a0a70ea3bf6aebbca48622\n4bc52cd8296fcffc22b5ca8ebf2b161260d71c8d34658f45c9c93cf6d65749e9\n4b3e6a191ab050a87aeeb8a650290c4e217e9508971beeb929417d13d89292e2\nc95d04ae659ff27da971c970ec072ffbec37551120fe8c395d5455fba4139d0d\n6aae67d87cd2ef23c4b9265c8e83db5142f00154e66e47b1e54219cea794682b\naad6294207c2facfebf440fa5d52804422edbf9c9e9adb4a7aaff0310b1c5d11\n43b31ea75f3c0666523aefc13e216a651e8e93feaeff1165cb35ed374365cdd6\nd7b0380241e4d47fc00e72faa08831b51b0ae360d5ccc45717f39f3106c3020a\n995d009e2fa6b510a0251895e0e71d0709ebfdeac782eae91caa3b4ee30bd29b\n6c2ad98af84288aff6f49ae92f9f71befbfaa4ac35d1a05b1441f1ce15124ee0\n3276f5cb5545e19704b1ef2897c17d721d6e156323f48f19275997d3cc62d005\nee6cb977e78651d7b9a3fd412a40f6e2cd1501f05b04c49e744db35c83181132\n22dbf29f7b7ee63da9418ab462b83e242823b83af7d697e7cf34796febc4d884\n149d9555994e5930d863674a2c55d295d5a19446bed86ef1079ccbbbdae9975f\n90618d3aa5146d27b46476a4c7bfcc2e5323b74dcbcf2c0af6b4f00c4c2d9297\n7a5444f5316764d3960132052abe097784a29b7390e0ece10c86b804c125100f\n98ee19dbbe959081f2d95b7f56af58fcb7ecdc5b85bb9ee13775376b9bad1ccf\n9fefd930a1cc7b257fe5a65bc3eda3167bc0f82895f288fc34eaca3411b2688b\n11a83b7f651c007cef7ca9490fc560dbfda8cd6b538199e277047c8087c7cee0\n611796a36903059a2d1725d7849a375b9aa2902254c0d5f5fa2122e83570ea3a\n7ec5f24e6f59719e6c071ec719dcfcbe8e48f5293f493b903f19446c1815048b\n518e682b4f0226db5e1abb7b62a32a2f46db719b6c407317273cbef56c811657\nbf4d1dcd4b9129f47ec4239fa5a33e00c981e5fac5b8be880b76d2a1f5753c34\nd9b6823ca8e13b78c269c5d21e948dbab625ea87d3370d163eeabeb3822aef56\n8a2abfa467352b278a1233aead9dffbb23a6d17bd50fe22e275ca92a1911c23c\n1fbbaa6cfa20d6e11a3e5e4ba0702f608d474cbf5a86eef891fb57a671c684be\n2692f4594cebfa3afca882274dc1432fea1ccbc7d3f37db3e15059722db1d97b\n9cffbade290f88c34b8a5e2e551fd9ae035eeda9d49d0eb0fecec8e40ecf2e84\n446d53cdc62a86025835e93938afeb9c1b24f28f2bade4980c01ac517b76c760\n\n## References\n\n```\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-10-27 - Vidar stealer campaign targeting Baltic region and NATO entities.pdf"
    ],
    "report_names": [
        "2021-10-27 - Vidar stealer campaign targeting Baltic region and NATO entities.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673535793,
    "ts_updated_at": 1743041153,
    "ts_creation_date": 1653690699,
    "ts_modification_date": 1653690699,
    "files": {
        "pdf": "https://archive.orkl.eu/4d392330b6cd1f70000d436c0bb7200b986df4e3.pdf",
        "text": "https://archive.orkl.eu/4d392330b6cd1f70000d436c0bb7200b986df4e3.txt",
        "img": "https://archive.orkl.eu/4d392330b6cd1f70000d436c0bb7200b986df4e3.jpg"
    }
}