{
    "id": "f1144e0b-bd7d-4003-a08e-1aa3c1d42be5",
    "created_at": "2023-01-12T15:04:18.035456Z",
    "updated_at": "2025-03-27T02:16:25.694212Z",
    "deleted_at": null,
    "sha1_hash": "ba652c72dbcb8c6423ee5e91d8814f8af2d5077c",
    "title": "2019-01-30 - Matrix- Targeted, small scale, canary in the coalmine ransomware",
    "authors": "",
    "file_creation_date": "2022-05-27T21:51:03Z",
    "file_modification_date": "2022-05-27T21:51:03Z",
    "file_size": 940903,
    "plain_text": "# Matrix: Targeted, small-scale, canary in the coal mine ransomware\n\n**[news.sophos.com/en-us/2019/01/30/matrix-targeted-small-scale-canary-in-the-coal-mine-ransomware/](https://news.sophos.com/en-us/2019/01/30/matrix-targeted-small-scale-canary-in-the-coal-mine-ransomware/)**\n\nAndrew Brandt January 30, 2019\n\nThis morning, Sophos published a report about a relatively small player in the ransomware\nspace. The ransomware, called Matrix, doesn’t produce the high returns of the better-known\nSamSam (whose creators were indicted by US law enfocement authorities last fall), and it\ndoesn’t have the “get rich quick” spin of the better known GandCrab ransomware-as-aservice. What it does demonstrate, however, is that a small team of malware developers and\nattackers can successfully leverage the low hanging fruit of Remote Desktop to breach\nnetworks and cause damage and mayhem.\n\n[You can download the report now; Analysts may wish to retrieve our](https://www.sophos.com/en-us/medialibrary/PDFs/technical-papers/sophoslabs-matrix-report.pdf) list of Matrix\nransomware IoCs they can use for threat hunting in their environment. Our friends at Naked\n[Security have also published a story about Matrix.](https://nakedsecurity.sophos.com/2019/01/30/matrix-under-the-microscope-what-a-niche-ransomware-can-teach-us/)\n\nMatrix is a curious case, because while its creators clearly understand the principles involved\nin creating a ransomware Trojan, their creation demonstrates a mix of differing levels of\ncompetencies in carrying out attacks. Unlike its more high-profile brethren, Matrix has not\nadopted techniques that would permit it to spread widely inside networks, where machines\nvulnerable to wormable exploits (like EternalBlue) might be running. But the constant level of\nimprovement indicates that may not remain the case forever.\n\n\n-----\n\nThe biggest problem Matrix highlights is that, despite the wide publicity that SamSam, Ryuk,\nand other targeted ransomware have gained, large enterprise networks still rely on security\nby obscurity, and permit Windows computers with passwords of dubious strength to be\nexposed to the unfiltered internet, where they can be attacked from outside with impunity.\nThese machines then can become a foothold to the attacker, who can use it to target bigger\nfish inside the firewall.\n\n## Post attack interaction\n\nIn its earliest incarnations, Matrix curiously attempted to replicate an earlier generation of\nransomware. The now-abandoned ransom note claimed that the ransomware originated with\nlaw enforcement, a practice that hasn’t been used for many years. The more recent versions\nof the malware now have given up this pretense and simply make demands.\n\nEarly versions of the ransomware used an email address with the phrase “The Matrix has\nyou” – a reference to the film trilogy of the same name\nThe malware authors ask the victims to contact them for the ransom amount, so it’s unknown\nat this time how much they’ve earned. We do know, however, that for much of the time that\nMatrix existed, its attackers had a preferred method of contact which is now unavailable to\nthem: A niche private messaging service called bitmsg.me used to afford them some\nmeasure of privacy, but after that service shut down last month, the attackers fell back on\nusing email accounts on free webmail services exclusively.\n\nAfter running a sample in a test environment, research analyst and reverse engineer Luca\nNagy, the report’s author and the primary investigator for this project, contacted the attackers\nat the email addresses they provided. The attackers demanded $2500 initially, and\nthreatened to raise the ransom to $3500 if the payment wasn’t received right away, or\n(notably) if the victim asked “stupid questions ”\n\n\n-----\n\nNote to self: Only ask smart questions\nAfter Luca failed to respond to emails for several days, the attackers emailed back, offering\nher a discount price of $1000 if she still wanted to decrypt her files.\n\n## Technical capabilities\n\nThe Matrix ransomware package has a huge resource section; Its creators have embedded\nthe kitchen sink of what it might need in these resources: instructions, tools, and documents\nlike the ransom note. The resource section also contains some of the cryptographic keys that\nare used during the malicious encryption phase of the attack. Importantly, the creators have\nengaged in the questionable application of cryptographic principles, using the same,\nhardcoded string as both the key and as a nonce in the encryption algorithm.\n\n\n-----\n\nSome of the domain names used for Matrix command-and-control may be a play on the\nRussian word for “Americans” and were hosted by an ISP in Russia. Data source: VirusTotal\nAlso included in the resource section are several components of what more competent\nransomware creators have built into their competing malware: There’s a priority list of file\nextensions targeted for attack, another list of filesystem paths and files to be excluded, and a\ncheck to make sure the ransomware doesn’t accidentally run on a machine that is being\nused in Russia or any of several former-Soviet republics, based on the language settings of\nthe operating system. Unfortunately for the attackers, that means all it takes to prevent the\nmalware from running is to set a system preference to the Kazakh language, for instance.\n\nThe malware’s creators also wanted to try to evade detection by endpoint antivirus products,\nso they eventually also added an exclusion list that prevents the malware from encrypting\nanything in a folder named SOPHOS (or named after any of several other AV products). The\nlaw of unintended consequences rules here: if you put your documents in a folder named\nafter any of these companies, Matrix won’t encrypt them.\n\nAfter the malicious encryption is complete, the malware invokes one of the resources it has\nembedded — a Windows shell .cmd file — to securely wipe deleted, unencrypted files.\n\nThe .cmd file uses a standard Windows executable called cipher.exe to do this. Windows\nuses cipher.exe to manage encrypted files on NTFS partitions, but it isn’t always needed. A\nGroup Policy rule that restricts the situations in which cipher.exe can be invoked would, at\n\n\n-----\n\nthe very least, give an incident responder a chance to recover the unencrypted files marked\nas deleted from the hard drive.\n\nBut despite these many shortcomings, it’s not fair to say the ransomware isn’t harmful. It is\ncapable of doing damage to infected computers; Its only truly saving grace is that the\nransomware isn’t effective at spreading itself around rapidly.\n\nIt doesn’t hurt matters that Sophos products are able to detect its presence during the\nearliest stages of infection, when the malware hasn’t yet had a chance to do any real\ndamage, but the fact that it takes some manual effort for the attackers to get Matrix onto\neach computer does limit its effectiveness.\n\nBut the thing that would eliminate its effectiveness: Systems administrators need to block all\ndirect access to Windows machines whose RDP is accessible through the firewall (no matter\nwhich port is it running on), and instead require users who need to remotely access their\ncomputers connect to a VPN to do so.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2019/2019-01-30 - Matrix- Targeted, small scale, canary in the coalmine ransomware.pdf"
    ],
    "report_names": [
        "2019-01-30 - Matrix- Targeted, small scale, canary in the coalmine ransomware.pdf"
    ],
    "threat_actors": [
        {
            "id": "75108fc1-7f6a-450e-b024-10284f3f62bb",
            "created_at": "2024-11-01T02:00:52.756877Z",
            "updated_at": "2025-03-27T02:00:55.544216Z",
            "deleted_at": null,
            "main_name": "Play",
            "aliases": null,
            "source_name": "MITRE:Play",
            "tools": [
                "Nltest",
                "AdFind",
                "PsExec",
                "Wevtutil",
                "Cobalt Strike",
                "Playcrypt",
                "Mimikatz"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1673535858,
    "ts_updated_at": 1743041785,
    "ts_creation_date": 1653688263,
    "ts_modification_date": 1653688263,
    "files": {
        "pdf": "https://archive.orkl.eu/ba652c72dbcb8c6423ee5e91d8814f8af2d5077c.pdf",
        "text": "https://archive.orkl.eu/ba652c72dbcb8c6423ee5e91d8814f8af2d5077c.txt",
        "img": "https://archive.orkl.eu/ba652c72dbcb8c6423ee5e91d8814f8af2d5077c.jpg"
    }
}