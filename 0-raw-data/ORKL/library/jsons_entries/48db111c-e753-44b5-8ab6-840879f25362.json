{
    "id": "48db111c-e753-44b5-8ab6-840879f25362",
    "created_at": "2023-01-12T15:02:00.605734Z",
    "updated_at": "2025-03-27T02:06:15.645376Z",
    "deleted_at": null,
    "sha1_hash": "8d6fa99e8a2cfe57ebdcfd0ef53c010947c8ecee",
    "title": "2022-05-10 - A Malware Analysis in RU-AU conflict",
    "authors": "",
    "file_creation_date": "2022-11-28T19:09:26Z",
    "file_modification_date": "2022-11-28T19:09:26Z",
    "file_size": 1531040,
    "plain_text": "# A Malware Analysis in RU-AU conflict\n\n**[marcoramilli.com/2022/05/10/a-malware-analysis-in-ru-au-conflict/](https://marcoramilli.com/2022/05/10/a-malware-analysis-in-ru-au-conflict/)**\n\nView all posts by marcoramilli May 10, 2022\n\n**Introduction**\n\nWe are living difficult times. From pandemic to Russia-Ukraine war. I was tempt to let a white\npost for remembering such a devastating times in my personal web corner, but I came out\nwith the idea to remember these times by analyzing an involved sample in current cyberconflicts. I start looking for Malware and finally I found this interesting EXCEL file (md5\nahead) which took my attention for its name and for the first AV submission geo-location.\n\n**Analysis**\n\n\n-----\n\nThe spread -over email- artifact is named `Військові на Азовсталі.xls which translated`\nfrom Ukrainian to English results in `Military on Azovstal.xls . The file name links that`\nsample to the current Russian – Ukraine conflict. Indeed on 18-04-2022, CERT-UA released\n[HERE a public note on this specific threat confirming both: the target (Ukraine government)](https://cert.gov.ua/article/39708)\nand the malicious intent of the email threat.\n\nBut let’s analyze the infection phases and see if something really characteristics will come\nout. The following table sums up the first observable stage.\n\n**md5** 877f834e8788d05b625ba639b9318512\n\n**OS** Winows\n\n**Format** xls\n\n**Arch** Office\n\nInitial Infection Vector\nA romantic .xls file within MACRO is abused to deliver the second infection stage. Looking\nfor static file indicators it is possible to appreciate the following naming conventions:\n```\nЭтаКнига, Лист1 and yevhejcum . According to google translate the first two strings\n\n```\nrepresent the classic location based values that Microsoft Office automatically adds to file\nstructure depending on your local configurations. In this specific case `ЭтаКнига translates`\nfrom Russian to English in `This book while` `Лист1 translates from Russian to English in`\n```\nSheet1 . It could be a significant indicator of a strong probability that the involved threat\n\n```\nactor was using a Russian speaking environment. From meta-tag analysis it comes out that\ncreation time ( 2022-04-18 10:52:06 ) match the “last_saved_time” which could highlight\nthe presence of some automated tool to create the final payload (a normal behavior in\ncriminal activities).\n\n\n-----\n\nMeta Tag Analysis\nThe following image shows the extracted MACRO behavior. Once you decoded strings from\n```\nhex to unicode (for example by using cybercheff or your favorite tool) you would notice\n\n```\nthree main steps:\n\n(1) the sample downloads an external file named `pe.dll (IoC follows)`\n\n(2) the MACRO cuts and pastes such a file into a `Windows Tasks directory and`\n\n(3) it runs pe.dll through `rundll32 .`\n\nUsually having the `.dll without the “running command” results in a complicated reverse`\nengineering exercise, in fact you have to decompile public exposed functions and later make\nassumptions on the ordered calls. But this is not the case. We do have the running command\nwhich turns to be: `undll32 C:\\Windows\\Tasks\\pe.dll, DllRegisterServer . I bet most`\nof you would easily recognize from the calling function `DllRegisterServer that we are`\nfacing a CobaltStrike beacon stager. The following image shows the the hex encoded\nMACRO function\n\n\n-----\n\nEmbedded Macros\nThe following table shows two interesting indicators decoded from `hex strings found in the`\nfirst stage. Fascinating to find-out that only from specific IP addresses you would download\nthe stager ( pe.dll ). For example from Ukraine IP space you would get the artifact while\nyou get a redirection to classic NGNX index page if you try to access from the UK IP address\nspace. This is a nice indicator of targeting attack against Ukraine IP space. As mentioned the\ndropping website responds on plain port 80, no SSL involved so no certificate analysis, and\nthe used Internet Protocol address is quite interesting as well. It is `138.68.229.0 . The final`\naddress `0 is used to address an entire network and not for a single host, I believe it’s an`\ninteresting choice made by threat actor. The used IP is resolved by\n```\nkitchenbath.mckillican.com, a Canadian based kitchen maker. In fact\nhttp://kitchenbath.mckillican.com/pe.dll makes you download the second stager\n\n```\n( pe.dll ) as well.\n\nHEX ASCII\n\n74703a2f2f3133382e36382e3232392e302f70652e646c6c [http://138.68.229.0/pe.dll](http://138.68.229.0/pe.dll)\n\n5c57696e646f77735c5461736b735c70652e646c6c \\Windows\\Tasks\\pe.dll\n\nSignificative Strings\nThe McKillican website is made in aspx technology and it looks like a custom website, it’s\nhard from this stage, to say if it has been compromised or if the threat actor compromised a\nDNS access by registering a new sub-domain ( kitchenbath.mckillican.com ) or maybe\nperforming a subdomain takeover attack. Another interesting IoC comes from the windows\ntask creation. No renaming and no hidden links, just a plain and simple cut and paste to\ntasks directory. The second stager ( pe.dll ) is a Windows PE file called through\n\n\n-----\n\n```\nDllRegisterServer entry point without any parameters. The DllRegisterServer\n\n```\nfunction is a void input function which tries to connect on Command and Control servers as\n[follows. The sample clearly represent a CobaltStrike Beacon.](https://www.virustotal.com/gui/file/9990fe0d8aac0b4a6040d5979afd822c2212d9aec2b90e5d10c0b15dee8d61b1/behavior/C2AE)\n\n**sha256** 9990fe0d8aac0b4a6040d5979afd822c2212d9aec2b90e5d10c0b15dee8d61b1\n\n**OS** Winows\n\n**Format** PE\n\n**Arch** amd64\n\nThe following image shows a quick and dirty extract of a dynamic analysis in where we\nappreciate the requests to Command and Control. The calls are built on top of the memory\nand called in “round robin” until the first connection. The first try is on `dezword.com which`\nresolves (during the analysis time) in `LT at` `84.32.188.29 . On Command and Control an`\nSSL certificate (id: `433591488225082751283964515969855882309258 ) is issued on date`\n```\n2022-03-22, issuer R3, made by Let's Encrypt .\n\n```\n\n-----\n\nCert UA made a nice VirusTotal graph linking many of the found indicators of compromise in\n[its article 39708 available HERE and extracted to the following image.](https://cert.gov.ua/article/39708)\n\nThe used IPs and Certificates are quite unique, no additional OSINT have been found (at the\nanalysis time). The CobaltStrike beacon was pretty plain and no specific obfuscation\ntechniques where found (beside the classic obfuscation practice mandatory in every\nmalicious content in nowadays attacks). I believe this attack could be attributed to one of the\ncriminal gangs supporting Russia, I hardly believe it’s something coming from government\nteams.\n\n**Conclusions**\n\nI have analyzed a malicious excel document aiming to attract military “clicks”. The document\nhad a thematic Ukrainian name and, according to relative findings (meta tags), it looks like\nwritten from a Russian locale system. The dropped document comes from a -high probable\ncompromised- Canadian based company website and implements CobaltStrike beacon\nwhich is run from a MACRO routine injected in a malicious excel file.\n\nThe used infection chain follows cyber-criminal malicious patterns, no complex attack\npatterns were found during the analysis. The command and control had restrictions on\ncountry but does not implement sophisticated controls on connected VPN providers or\nspecific user agents. Moreover the used IP address for the dropping website ending with a\n```\n0 result quite original choice, definitely not coming from a network experienced\n\n```\nprofessional.\n\n\n-----\n\nVT Graph By CERT UA\nIt was possible to add two/IoC compared to the shared bulletin: domain name of staging\nserver, certificate of staging server and command line executed by the first stage. From\nthese indicators (especially from certificate) you might look for similarities in other servers\nand try to map a wide range of operations belonging with similar threat actor. This activity is\nout of scope for this post so not followed.\n\n**IoC**\n\nhxxp://138[.]68.229.0/pe.dll\n\nhxxps://dezword[.]com/apiv8/getStatus\n\nhxxps://dezword[.]com/apiv8/updateConfig\n\n139[.]60.161.225\n\n139[.]60.161.74\n\n\n-----\n\n139[.]60.161.62\n139[.]60.161.99\n\n139[.]60.161.57\n\n139[.]60.161.75\n\n139[.]60.161.24\n\n139[.]60.161.89\n\n139[.]60.161.209\n\n139[.]60.161.85\n\n139[.]60.160.51\n\n139[.]60.161.226\n\n139[.]60.161.216\n\n139[.]60.161.163\n\n139[.]60.160.8\n\n139[.]60.161.32\n\n139[.]60.161.45\n\n139[.]60.161.60\n\n139[.]60.160.17\n\ndezword[.]com\n\nagreminj[.]com\n\nakaluij[.]com\n\nanidoz[.]com\n\napeduze[.]com\n\napokil[.]com\n\narentuk[.]com\n\naxikok[.]com\n\nazimurs[.]com\n\nbaidencult[.]com\n\nbilliopa[.]com\n\nblinkij[.]com\n\nblopik[.]com\n\nborizhog[.]com\n\nbritxec[.]com\n\ndrimzis[.]com\n\nfluoxi[.]com\n\nshikjil[.]com\n\nshormanz[.]com\n\nverofes[.]com\n\nrundll32 C:\\Windows\\Tasks\\pe.dll, DllRegisterServer\n\nkitchenbath[.]mckillican.com\n\ncertificate id: 433591488225082751283964515969855882309258\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-05-10 - A Malware Analysis in RU-AU conflict.pdf"
    ],
    "report_names": [
        "2022-05-10 - A Malware Analysis in RU-AU conflict.pdf"
    ],
    "threat_actors": [
        {
            "id": "610a7295-3139-4f34-8cec-b3da40add480",
            "created_at": "2023-01-06T13:46:38.608142Z",
            "updated_at": "2025-03-27T02:00:02.87217Z",
            "deleted_at": null,
            "main_name": "Cobalt",
            "aliases": [
                "Cobalt Gang",
                "GOLD KINGSWOOD",
                "COBALT SPIDER",
                "G0080",
                "Mule Libra",
                "Cobalt Group"
            ],
            "source_name": "MISPGALAXY:Cobalt",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673535720,
    "ts_updated_at": 1743041175,
    "ts_creation_date": 1669662566,
    "ts_modification_date": 1669662566,
    "files": {
        "pdf": "https://archive.orkl.eu/8d6fa99e8a2cfe57ebdcfd0ef53c010947c8ecee.pdf",
        "text": "https://archive.orkl.eu/8d6fa99e8a2cfe57ebdcfd0ef53c010947c8ecee.txt",
        "img": "https://archive.orkl.eu/8d6fa99e8a2cfe57ebdcfd0ef53c010947c8ecee.jpg"
    }
}