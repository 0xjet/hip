{
    "id": "c92a1a48-6f44-4e1c-b060-addaf7038138",
    "created_at": "2023-01-12T15:05:34.750128Z",
    "updated_at": "2025-03-27T02:05:42.958773Z",
    "deleted_at": null,
    "sha1_hash": "c0ee75f5f084bffe475268e4e02defe99e1d4ee6",
    "title": "2016-08-25 - Shakti Trojan - Technical Analysis",
    "authors": "",
    "file_creation_date": "2016-05-11T09:30:32Z",
    "file_modification_date": "2016-05-11T09:30:32Z",
    "file_size": 406824,
    "plain_text": "# THREAT REPORT\n\n#### THE TIP OF THE ICEBERG:\n###### WILD EXPLOITATION & CYBER-ATTACKS ON SAP BUSINESS APPLICATIONS\n\n MAY | 2016\nVersion 1.0\n\n\n-----\n\n## TABLE OF CONTENTS\n\n\n###### EXECUTIVE SUMMARY  2\n\n ANALYSIS OF THE OBSERVED ATTACK VECTOR   3\n\n ANALYZING THE BUSINESS IMPACT  4\n\n MITIGATION - PROTECTING YOUR SAP BUSINESS APPLICATIONS 5\n\n STRATEGIC RECOMMENDATIONS  5\n\n CONCLUSION  7\n\n\n-----\n\n## EXECUTIVE SUMMARY\n\n###### SAP business applications run a vast number of commercial and government organizations that sustain global economies. SAP customers include 87% of Forbes Global 2000 companies, 98% of the 100 most valued brands and 44 of the world’s military forces. SAP customers produce 78% of the world’s food, 82% of the world’s medical devices whilst 76% of the world’s transaction revenue is processed by an SAP system [1]\n\n\nAs the leading provider of SAP and Oracle cybersecurity\nresearch and solutions, Onapsis is exclusively focused in\nsecuring these business-critical applications. As an SAP\npartner and the first to lecture on advanced SAP cyber\nthreats, Onapsis experts have helped SAP SE by\ndiscovering, reporting and helping to mitigate more than\n250 security vulnerabilities in SAP software, enabling SAP\nand its customers be more secure from the increasing risk\nof cyber-attacks.\n\n\n###### IN EARLY 2016, THE ONAPSIS RESEARCH LABS DISCOVERED INDICATORS OF UNAUTHORIZED EXPLOITATION OF SAP VULNERABILITIES AT 36 GLOBAL ENTERPRISES.\n\n These enterprises are located in, or are co-owned by corporations in the United States, United Kingdom, Germany, China, India, Japan, and South Korea, and span a number of industries including Oil & Gas, Telecommunications, Utilities, Retail, Automotive, Life Sciences, Consumer Products, Chemicals, High Tech, Engineering, Construction, Operations, Industrial Machinery and Components, Public Sector, and Higher Education.\n\n\nWhile several threat reports disclose security incidents as\nthe result of nation-state sponsored cyber campaigns, in\nthis case, the reality (and what we believe makes this\nresearch even more interesting) is that these indicators\nhad been silently sitting in the public domain for several\nyears, until now. We regard these indicators as just the tip\nof the iceberg, as well as an irrefutable answer to the\nquestion “are SAP applications being attacked?”\n\n\nThe exploitation of the affected organizations’ SAP systems\nwas publicly disclosed during 2013-2016 at a digital forum\nregistered in China. In all cases, the individuals leveraged a\npublicly-known SAP application vulnerability, for which SAP had\nreleased a security patch more than five years ago.\n\nThe exploitation of this vulnerability gives remote\nunauthenticated attackers full access to the affected SAP\nplatforms, providing them with complete control of the\nbusiness information and processes run by them, as well as\npotentially further access to connected SAP and non-SAP\nsystems.\n\nDuring April and May 2016, Onapsis alerted its customers and\nhas worked in collaboration with the US Department of\nHomeland Security (DHS), in order to ensure that affected\ncompanies were informed and could mitigate the identified\ncybersecurity risks. Furthermore, the US-CERT has released an\nalert which summarizes the risks and solutions described in this\ndocument to further inform security professionals.\n\n###### The goal of this threat report is to help Information Security, Internal Audit, and SAP teams protect their business-critical SAP applications from real-world cyber-attacks.\n\nThis document describes the specific vulnerability that is\nactively being exploited, the types of SAP systems affected,\npotentially compromised business processes and information,\nand the key recommendations on how to mitigate this\nvulnerability to minimize business risk.\n\n\n-----\n\n### ANALYSIS OF THE OBSERVED ATTACK VECTOR\n\n\nAll security incidents described in this threat report exploited the same\nfundamental vulnerability. In this section we analyze the nature of this\nvulnerability, the affected SAP solutions and the impact resulting from\na successful exploitation.\n\nSAP Java platforms have a wide of set of built-in functionality, providing\na comprehensive framework of libraries and services to support the\ndevelopment and deployment of SAP applications in Java.\n\nOne of these functionalities is the Invoker Servlet, which is part of the\nstandard J2EE specification of Sun (now Oracle). It was conceived as a\nrapid development instrument, allowing developers to test their\ncustom Java applications. When enabled, developers and users can call\nservlets directly, without authentication or authorization controls.\n\nThe observed exploitations targeted SAP systems that had the Invoker\nServlet enabled, and bypassed authentication controls to access a\nsensitive SAP Java application called Configuration Wizard/Template\nInstaller, which provided functionality to execute arbitrary operating\nsystems commands and create SAP user accounts.\n\nThe exploits can be performed by sending specific HTTP(S) requests to\nthe vulnerable SAP system, which further increases the risk of attacks\nfrom remote locations and networks such as the Internet.\n\n\n###### KEY TAKEAWAYS\n\n COMPANIES IMPACTED\n\nSome of the largest global companies were\nimpacted, including:\n\nOne of the top ten highest annually grossing\ncompanies.\n\n13 enterprises which each generate over $10B\nin annual revenue.\n\nMembers of the Oil & Gas,\nTelecommunications, Utilities, Retail,\nAutomotive, Life Sciences, Consumer Products,\nChemicals, High Tech, Engineering\nConstruction, Operations, Industrial Machinery\nand Components, Public Sector, and Higher\nEducation.\n\n###### THE ATTACK VECTOR\n\nApplications exploited were outdated and/or\nmisconfigured SAP NetWeaver Application\nServer Java systems (“SAP Java platforms”).\nThese serve as the foundational technology\nstack for several key SAP business solutions,\ninformation and processes.\n\nThe vulnerability exploited has been identified\nas the Invoker Servlet vulnerability which was\npatched by SAP in 2010, and is being leveraged\nin tandem with a sensitive SAP Java application\nto remotely gain full administrative access to\nthe SAP systems.\n\n\n###### In summary, the impact of this attack is the worst possible outcome: a remote attacker can execute arbitrary operating systems commands with high-privileges and/or create SAP administration users, simply using a web browser and without the need to initially have a valid SAP user id and password in the target system.\n\n\nAs described before, SAP released security patches for these attack\nvectors several years ago. They have also disabled the Invoker Servlet\nfunctionality by default in newer SAP Java platforms.\n\nThe Onapsis Research Labs warned about this threat in 2011, publishing\nan SAP security in-depth whitepaper titled “The Invoker Servlet – A\nDangerous Detour into SAP Java Solutions”[2].\n\nIt is very important to note that while the Invoker Servlet may be\ndisabled globally, this setting may be overridden by specific or custom\nSAP Java applications. This introduces additional risks and makes it\ncritical to also review custom applications and to deploy a continuous\nmonitoring solution to ensure custom applications are not jeopardizing\n\n\n-----\n\nThe SAP Java platform is a technology stack, which may not be easily recognized by business executives as being part of their\nSAP implementation. However, depending on the solution version, it is possible that this platform could be providing the base\nframework for many SAP business solutions that are currently in use by the organization. These include:\n\n\nSAP Enterprise Portal (EP)\nSAP Process Integration (PI)\nSAP Exchange Infrastructure (XI)\nSAP Solution Manager (SolMan)\nSAP Enterprise Resource Planning (ERP)\nSAP Customer Relationship Management (CRM)\nSAP Supply Chain Management (SCM)\nSAP Supplier Relationship Management (SRM)\nSAP NetWeaver Business Warehouse (BW)\n\n\nSAP Business Intelligence (BI)\nSAP NetWeaver Mobile Infrastructure (MI)\nSAP NetWeaver Development Infrastructure (NWDI)\nSAP Central Process Scheduling (CPS)\nSAP NetWeaver Composition Environment (CE)\nSAP NetWeaver Enterprise Search\nSAP NetWeaver Identity Management (IdM)\nSAP Governance, Risk & Control 5.x (GRC)\n\n\nIf any of these solutions are in use at your organization, it is highly recommended that you analyze whether they are\nleveraging the SAP Java platform (also referred to as the SAP J2EE Engine), regardless of whether it is in single stack or\ndual-stack mode. If these solutions are in use, and are not properly secured, they may be exposed to the attack vector\ndescribed in this document.\n\n### ANALYZING THE BUSINESS IMPACT \n\n###### As described in the previous section, a wide range of business solutions run on top of SAP Java platforms. This means that a significant number of critical business processes and information could be breached if these applications are compromised.\n\n\nWhile many executives and security professionals consider\nSAP as a “backoffice financial system”, in reality SAP\napplications are the lifeblood of many businesses, managing\ncritical information such as intellectual property, HR data,\npricing, purchasing agreements, bank accounts, credit cards,\nfinancial reports, manufacturing recipes, strategic plans, etc.\nFurthermore, they support and run processes related with\nareas such as sales & distribution, materials management,\nlogistics execution, financial and managerial accounting,\nsupply chain, payroll, e-recruiting, and many other functions.\n\nFailing to properly secure SAP installations could have huge\ncost implications for an organization, including economic\nimpact and compliance violations.\n\nEconomic impact will vary by organization depending on\nspecific circumstances and use of the SAP applications, such\nas value chain affected. As a reference point, the CISO of a\nFortune 100 company has estimated losses from an attacker\n\n\nbreaking into and shutting down his organization’s SAP\nsystems at $22 million per minute.\n\nAdditional C-Level contacts at various Fortune 500\nenterprises have disclosed that a compromise or termination\nof SAP-enabled processes could cease essential business\nfunctions and would potentially be categorized as an\n“extinction event” for their organization.\n\nMoreover, as SAP runs several of the largest commercial and\ngovernmental organizations globally, a wide-scale attack\nagainst these applications could have macro-economic impact\non most modern economies.\n\nIf SAP systems are taken offline, the expected average financial\nconsequence for companies is $4.5 million. These costs include\ndirect cash outlays, direct labor expenditures, indirect labor\ncosts, overhead costs and lost business opportunity.\n\n\n-----\n\n###### MITIGATION PROTECTING YOUR SAP BUSINESS APPLICATIONS\n Mitigating the Invoker Servlet (and related) vulnerabilities\n\nTo mitigate this vulnerability, it is necessary to disable the Invoker Servlet. This can be done by following the steps below:\n\nCheck if the property \"EnableInvokerServletGlobally\" is present in the SAP Java system. In case it is not, implement SAP\nNote 1445998. The implementation of this note will create the property that enables the disabling of the Invoker Servlet.\nIt’s important to note that SAP has disabled Invoker Servlet by default in 7.20 (in the patch levels described in SP Patch\n\n##### 1\n\nLevel section of Note 1445998) and in the initial shipment of 7.30 version of the J2EE Engine. However, administrators\ncould have changed this setting due to technical or business requirements and rendered the systems insecure.\n\nStart the SAP J2EE configuration tool, select the “Global Server Configuration” in the cluster-data tree. Click on the\nservices node and select “servlet_jsp”. In the global properties list set the “EnableInvokerServletGlobally” to FALSE. Save\nthe options and restart the instance.\n\n##### 2\n\nSeveral business applications run on top of SAP Java systems. In the case that one of the following applications is running\non your environment, make sure the mentioned SAP Security Notes are reviewed and implemented, otherwise business\nfunctionality may be disrupted or certain risks may remain active:\n\n##### 3\n\nSAP Enterprise Portal - SAP Note 1467771\n\nSAP BillerDirect – SAP Notes 1537663 and 1802092\n\nSAP Virus Scan Engine – SAP Note 1900752\n\nSAP CRM – SAP Notes 1598246 and 1488846\n\nSAP Classified Advertising Management – SAP Note 1535301\n\nStart the SAP J2EE configuration tool, select the “Global Server Configuration” in the cluster-data tree. Click on the\nservices node and select “servlet_jsp”. In the global properties list set the “EnableInvokerServletGlobally” to FALSE. Save\n\n##### 4 the options and restart the instance.\n\nFurthermore, as described before, specific or custom SAP Java applications may override the global setting for the Invoker\nServlet, therefore it is important to review and mitigate these risks. These applications should use local specific servlets\nwithin their web.xml files. In order to achieve this, locate the <servlet-name>invoker</servlet-name> configuration in the\nweb.xml file of the application and set its parameter InvokerServletLocallyEnabled to “false”. Bear in mind that this may\nrequire reengineering the code of the application. More information can be found in the attachment in SAP Note 1445998.\n\n## STRATEGIC RECOMMENDATIONS\n\nThese findings highlight the existence of a dangerous blind spot for CISOs and CIOs: how can the applications which house an\norganization’s crown jewels and run the most important business processes be exposed to such a critical security vulnerability, for which\nthe vendor provided a patch more than five years ago? In light of these risks, we highly recommend SAP customers to:\n\nUnderstand their SAP implementation, its primary usage and processes as well as the key informational assets it manages.\n\nContinuously identify existing vulnerabilities and SAP interfaces to understand the attack surface.\n\nCorrelate vulnerabilities to corporate risk posture to determine top risks to the business and prioritize remediation efforts\nand potential compensating controls.\n\nMaintain SAP cybersecurity standards, guidelines and patching processes to stay aligned with the latest security patches and\nimprovements provided by SAP.\n\nImplement detective monitoring capabilities to gain visibility into indicators of compromise regarding the use of known SAP\nexploits, zero-days and suspicious SAP user activity.\n\n\n-----\n\n## CONCLUSIONS\n\n###### Business-critical applications running on SAP house the “crown jewels” of any large organization, and they are no longer confined to “internal” or isolated networks. SAP implementations have transformed through trends like cloud, mobile, big data and IoT, all of which expand the attack surface of a company and these applications. Effectively securing SAP applications is critical to accelerate the adoption of these new technology paradigms and to enable companies to realize the maximum value from their investment in SAP solutions.\n\n\nAs the leading SAP partner in cybersecurity, Onapsis has seen\nfirst-hand how SAP is significantly increasing its efforts in\nproviding more secure business software. At the same time, it\nis important for customers to recognize that SAP is not a\ncybersecurity company and, just like with any other major\nsoftware vendor, applying security patches and\nrecommended security configurations depends on your own\norganization and cybersecurity partners.\n\n**These findings are a clear example of how attackers are**\n**leveraging an organizations’ lack of governance over the**\n**security of business applications, as SAP made a security**\n**patch available several years ago.**\n\nWhile this is the first threat report that undercovers the\nactive exploitation of SAP systems publicly, we know for a\nfact that this is just the tip of the iceberg. These findings only\nrefer to the exploitation of a single vulnerability. SAP has\nreleased over 3,000 security patches to date, issuing on\naverage over ~30 security patches per month .\n\nBased on our experience engaging with large SAP customers,\nwe often find vulnerabilities present in systems despite SAP\nhaving released patches as far back as 10 years ago. This is\nvery common in a vast majority of the implementations we’ve\nseen, and provides both insiders and remote attackers with\nwide-open doors into the heart of large enterprises. Our\nteam has also been engaged in a number of SAP forensics &\nincidents response projects, resulting from real-world\nbreaches to SAP applications.\n\nStill, many organizations lack the proper preventative,\ndetective and corrective controls to secure a company’s SAP\napplications, and have a reigning false sense of security\nprovided by generic security products, GRC solutions and\ntraditional Segregation of Duties controls and audits. While\nall these efforts, processes and technology are necessary to\nprotect SAP systems, they are not designed to provide deep\nvisibility, control and protection against remote cyber\nattackers and malicious insiders targeting SAP business\napplications.\n\nThe status-quo is not sustainable. According to IDC “because\nover 75% of all transactions occur on business-critical\napplications, data from these systems is endlessly valuable to\nattackers”. In this scenario, business applications provide the\n\n\nbest possible economics for cyber attackers: The world's\nlargest organizations running on the same highly-complex\ntechnology platform, which is usually exposed to known\nvulnerabilities and has high-value business assets and\nprocesses by definition. On top of that, attackers enjoy of\nreduced chances of being detected, due to several\norganizations still missing the right governance model and\nspecialized solutions.\n\nGiven the cross-functional nature of these applications, it is\nimperative to implement a proper SAP cybersecurity\nprogram that is aligned to effectively secure SAP\napplications and data. As with any security initiative, it takes\nthe right combination of people, process and technology to\nbe successful.\n\n\n-----\n\n## ABOUT ONAPSIS\n\n###### Onapsis provides the most comprehensive solutions for securing SAP and Oracle enterprise applications. As the leading experts in SAP and Oracle cybersecurity, Onapsis’ patented solutions enable security and audit teams to have visibility, confidence and control of advanced threats, cyber-risks and compliance gaps affecting their enterprise applications.\n\n Onapsis provides the most comprehensive solutions applications into existing vulnerability, risk and for securing SAP and Oracle enterprise applications. incident response management programs. As the leading experts in SAP and Oracle\n These solutions are powered by the Onapsis Research\n cyber-security, Onapsis’ patented solutions enable\n Labs which continuously provide leading intelligence\n security and audit teams to have visibility, confidence\n on security threats affecting SAP and Oracle\n and control of advanced threats, cyber-risks and\n enterprise applications. Experts of the Onapsis\n compliance gaps affecting their enterprise\n Research Labs were the first to lecture on SAP\n applications.\n cyber-attacks and have uncovered and helped fix hundreds of security vulnerabilities to-date affecting\n HEADQUARTERED IN BOSTON, ONAPSIS SERVES SAP Business Suite, SAP HANA, SAP Cloud and SAP OVER 200 GLOBAL CUSTOMERS INCLUDING MANY Mobile applications, as well as Oracle JD Edwards and For more information, please visit www.onapsis.com, or OF THE GLOBAL 2000. Oracle E-Business Suite platforms.connect with us on Twitter, Google+, or LinkedIn.\n Onapsis has been issued U.S. Patent No. 9,009,837\n Onapsis solutions include the Onapsis Security entitled “Automated Security Assessment of Platform, which is the most widely-used SAP-certified Business-Critical Systems and Applications,” which cyber-security solution in the market. Unlike generic describes certain algorithms and capabilities behind security products, Onapsis’ context-aware solutions the technology powering the Onapsis Security deliver both preventative vulnerability and Platform™ and Onapsis X1™ software platforms. This compliance controls, as well as real-time detection patented technology is recognized industry wide and and incident response capabilities to reduce risks has gained Onapsis the recognition as a 2015 SINET affecting critical business processes and data. 16 Innovator. Through open interfaces, the platform can be integrated with leading SIEM, GRC and network security products, seamlessly incorporating enterprise\n\n\n###### For more information, please visit www.onapsis.com, or connect with us on Twitter, Google+, or LinkedIn.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/ICS SCADA/Other/Exploitation on SAP Business Apps.pdf"
    ],
    "report_names": [
        "Exploitation on SAP Business Apps.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673535934,
    "ts_updated_at": 1743041142,
    "ts_creation_date": 1462959032,
    "ts_modification_date": 1462959032,
    "files": {
        "pdf": "https://archive.orkl.eu/c0ee75f5f084bffe475268e4e02defe99e1d4ee6.pdf",
        "text": "https://archive.orkl.eu/c0ee75f5f084bffe475268e4e02defe99e1d4ee6.txt",
        "img": "https://archive.orkl.eu/c0ee75f5f084bffe475268e4e02defe99e1d4ee6.jpg"
    }
}