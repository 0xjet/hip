{
    "id": "80d172ed-5af9-42fc-839d-aa466e534334",
    "created_at": "2023-01-12T15:10:57.755536Z",
    "updated_at": "2025-03-27T02:05:44.00026Z",
    "deleted_at": null,
    "sha1_hash": "a5fba59eb821ad9f2e7c0dfaf389af2bff6bae37",
    "title": "2022-01-12 - Forensics Analysis of the NSO Group’s Pegasus Spyware",
    "authors": "",
    "file_creation_date": "2022-05-28T15:13:42Z",
    "file_modification_date": "2022-05-28T15:13:42Z",
    "file_size": 411277,
    "plain_text": "# Forensics Analysis of the NSO Group’s Pegasus Spyware\n\n**[lifars.com/2022/01/forensics-analysis-of-the-nso-groups-pegasus-spyware/](https://lifars.com/2022/01/forensics-analysis-of-the-nso-groups-pegasus-spyware/)**\n\nJanuary 12, 2022\n\nNSO’s Group Pegasus spyware was mentioned multiple times during 2021 in the media. It\nhas been heavily analyzed by organizations such as Amnesty International [1] and the\nUniversity of Toronto’s Citizen Lab [2] [3] [4] [5].\n\nThe targets included journalists from Azerbaijan, France, Hungary, India, French human\nrights lawyers, French human rights activists, Rwandan activists, and Indian human rights\nactivists. Citizen Lab also identified Bahraini activists, New York Times Journalist Ben\nHubbard, and Palestinian human rights defenders as victims.\n\nThe Pegasus spyware has been distributed via one-click attacks (the target needs to click on\na malicious link received via SMS messages, WhatsApp, etc.) and zero-click attacks (no\ninteraction needed). Some of the recently used 0-day exploits developed by NSO Group\ninclude KISMET and FORCEDENTRY (also called Megalodon). It’s important to mention that\nApple patched all the vulnerabilities submitted regarding these attacks, and it’s crucial to\nupdate your iOS devices regularly.\n\n\n-----\n\nThe FORCEDENTRY exploit has been analyzed by Google [6] and TrendMicro [7]. It has\nbeen attributed a CVE identifier of CVE-2021-30860 and represents a vulnerability in the\nCoreGraphics PDF parser. It is an integer overflow vulnerability which leads to out-of-bounds\nwrite. The crashing point inside the function JBIG2Stream::readTextRegionSeg is displayed\nbelow:\n\nSource: TrendMicro\n\nThe Google Project Zero team performed a deep dive into the exploit and explained that the\nattackers could define a small computer architecture with registers and a 64-bit adder and\ncomparator. It is computationally equivalent to JavaScript, and the team concluded that this\nis one of the most technically sophisticated exploits they’ve ever analyzed.\n\nLIFARS team analyzed a suspected infection with Pegasus using the Mobile Verification\nToolkit released by the Amnesty International Security Lab [8]. We’ve also used the NSO\nGroup Pegasus IOCs (domains, iCloud accounts, files, process names) in our investigation\n\n[9].\n\nWe were able to identify six Pegasus processes that ran on the victim’s iPhone. The infection\noccurred on February 1st, which coincided with when the NSO group deployed the\nFORCEDENTRY iMessage Zero-Click mentioned by the CitizenLab in their report [3].\n\n\nWifi In\n(MB)\n\n\nWifi Out\n(MB)\n\n\nWan In\n(MB)\n\n\nWan Out\n(MB)\n\n\nTimestamp\n(UTC)\n\n\nProcess\nName\n\n\n-----\n\n1.6554 0.178541 0 0 2/1/2021\n13:02:30\n\n0.007 0.0019 0 0 2/1/2021\n13:02:31\n\n29.8661 99.8687 1.2749 1.0464 2/1/2021\n13:03:00\n\n1.6548 0.1939 0 0 2/11/2021\n23:31:38\n\n0.007 0.0019 0 0 2/11/2021\n23:31:38\n\n75.6967 58.8612 7.6284 4.99 2/11/2021\n23:32:04\n\n\nwifip2ppd\n\nABSCarryLog\n\nmisbrigd\n\ncfprefssd\n\ngssdp\n\nlibbmanaged\n\n\nAs shown in the table above, two processes performed data exfiltration. The libbmanaged\nprocess was running for over a week, based on a record from\nthe DataUsage.sqlite database:\n\n\nWifi In\n(MB)\n\n\nWifi Out\n(MB)\n\n\nWan In\n(MB)\n\n\nWan Out\n(MB)\n\n\nTimestamp (UTC) Process\nName\n\n\n0 0 7.99 5.07 2/19/2021 1:16:18 libbmanaged\n\nBefore the malicious processes ran, we’ve identified the following process related to\niMessage processing:\n\n\nWifi In\n(MB)\n\n\nWifi Out\n(MB)\n\n\nWan In\n(MB)\n\n\nWan Out\n(MB)\n\n\nTimestamp\n(UTC)\n\n\nProcess Name\n\nIMTransferAgent\n\n\n0 0 15.0895 0.4087 2/1/2021\n12:52:55\n\n\nThe file\n“/private/var/mobile/Library/Preferences/com.apple.identityservices.idstatuscache.plist” used\nby Amnesty International’s Security Lab to extract the suspicious iMessage account lookups\nis missing in our case. The netusage.sqlite SQLite database is also missing, and we couldn’t\nextract records from the Cache.db databases because we couldn’t jailbreak the device.\n\nThe Pegasus spyware remains an active threat even if the NSO Group has been sanctioned\nby the United States. We recommend rebooting your iPhone daily in order to remove nonpersistent malware.\n\nReferences\n\n\n-----\n\n[1] https://www.amnesty.org/en/latest/research/2021/07/forensic-methodology-report-how-tocatch-nso-groups-pegasus/\n\n[2] https://citizenlab.ca/2020/12/the-great-ipwn-journalists-hacked-with-suspected-nso-groupimessage-zero-click-exploit/\n\n[3] https://citizenlab.ca/2021/08/bahrain-hacks-activists-with-nso-group-zero-click-iphoneexploits/\n\n[4] https://citizenlab.ca/2021/10/breaking-news-new-york-times-journalist-ben-hubbardpegasus/\n\n[5] https://citizenlab.ca/2021/11/palestinian-human-rights-defenders-hacked-nso-groupspegasus-spyware/\n\n[6] [https://googleprojectzero.blogspot.com/2021/12/a-deep-dive-into-nso-zero-click.html](https://googleprojectzero.blogspot.com/2021/12/a-deep-dive-into-nso-zero-click.html)\n\n[7] https://www.trendmicro.com/en_us/research/21/i/analyzing-pegasus-spywares-zero-clickiphone-exploit-forcedentry.html\n\n[8] [https://github.com/mvt-project/mvt](https://github.com/mvt-project/mvt)\n\n[9] [https://github.com/AmnestyTech/investigations/tree/master/2021-07-18_nso](https://github.com/AmnestyTech/investigations/tree/master/2021-07-18_nso)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-01-12 - Forensics Analysis of the NSO Group’s Pegasus Spyware.pdf"
    ],
    "report_names": [
        "2022-01-12 - Forensics Analysis of the NSO Group’s Pegasus Spyware.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673536257,
    "ts_updated_at": 1743041144,
    "ts_creation_date": 1653750822,
    "ts_modification_date": 1653750822,
    "files": {
        "pdf": "https://archive.orkl.eu/a5fba59eb821ad9f2e7c0dfaf389af2bff6bae37.pdf",
        "text": "https://archive.orkl.eu/a5fba59eb821ad9f2e7c0dfaf389af2bff6bae37.txt",
        "img": "https://archive.orkl.eu/a5fba59eb821ad9f2e7c0dfaf389af2bff6bae37.jpg"
    }
}