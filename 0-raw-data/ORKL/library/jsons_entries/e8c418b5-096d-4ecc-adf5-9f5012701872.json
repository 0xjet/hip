{
    "id": "e8c418b5-096d-4ecc-adf5-9f5012701872",
    "created_at": "2023-01-12T15:02:28.216342Z",
    "updated_at": "2025-03-27T02:15:06.185545Z",
    "deleted_at": null,
    "sha1_hash": "93c4ad9fa0ee5779f0c97f5a3936aba16c53891d",
    "title": "2022-01-07 - Patchwork APT caught in its own web",
    "authors": "",
    "file_creation_date": "2022-05-28T23:19:55Z",
    "file_modification_date": "2022-05-28T23:19:55Z",
    "file_size": 1208777,
    "plain_text": "# Patchwork APT caught in its own web\n\n**[blog.malwarebytes.com/threat-intelligence/2022/01/patchwork-apt-caught-in-its-own-web/](https://blog.malwarebytes.com/threat-intelligence/2022/01/patchwork-apt-caught-in-its-own-web/)**\n\nThreat Intelligence Team January 7, 2022\n\n[Patchwork is an Indian threat actor that has been active since December 2015 and usually](https://attack.mitre.org/groups/G0040/)\ntargets Pakistan via spear phishing attacks. In its most recent campaign from late November\nto early December 2021, Patchwork has used malicious RTF files to drop a variant of the\nBADNEWS (Ragnatela) Remote Administration Trojan (RAT).\n\nWhat is interesting among victims of this latest campaign, is that the actor has for the first\ntime targeted several faculty members whose research focus is on molecular medicine and\nbiological science.\n\nInstead of focusing entirely on victimology, we decided to shade some light on this APT.\nIronically, all the information we gathered was possible thanks to the threat actor infecting\nthemselves with their own RAT, resulting in captured keystrokes and screenshots of their\nown computer and virtual machines.\n\n## Ragnatela\n\nWe identified what we believe is a new variant of the BADNEWS RAT called Ragnatela being\ndistributed via spear phishing emails to targets of interest in Pakistan. Ragnatela, which\nmeans spider web in Italian, is also the project name and panel used by Patchwork APT.\n\n\n-----\n\nFigure 1: Patchwork’s Ragnatela panel\nRagnatela RAT was built sometime in late November as seen in its Program Database (PDB)\npath “E:\\new_ops\\jlitest __change_ops -29no – Copy\\Release\\jlitest.pdb”. It features the\nfollowing capabilities:\n\nExecuting commands via cmd\nCapturing screenshots\nLogging Keystrokes\nCollecting list of all the files in victim’s machine\nCollecting list of the running applications in the victim’s machine at a specific time\nperiods\nDowning addition payloads\nUploading files\n\n\n-----\n\nFigure 2:\n\nRagnatela commands\nIn order to distribute the RAT onto victims, Patchwork lures them with documents\nimpersonating Pakistani authorities. For example, a document called EOIForm.rtf was\nuploaded by the threat actor onto their own server at karachidha[.]org/docs/.\n\nFigure 3: Threat\n\nactor is logged into their web control panel\n\n\n-----\n\nThat file contains an exploit (Microsoft Equation Editor) which is meant to compromise the\nvictim’s computer and execute the final payload (RAT).\n\nFigure 4: Malicious document triggers exploit\nThat payload is stored within the RTF document as an OLE object. We can deduce the file\nwas created on December 9 2021 based on the source path information.\n\n\n-----\n\nFigure\n\n5: OLE object containing RAT\nRagnatela RAT communicates with the attacker’s infrastructure via a server located at\nbgre.kozow[.]com. Prior to launching this campaign (in late November), the threat actor\ntested that their server was up and running properly.\n\nFigure 6:\n\nLog of threat actor typing a ping command\n\n\n-----\n\nThe RAT (jli.dll) was also tested in late November before its final compilation on 2021-12-09,\nalong with MicroScMgmt.exe used to side-load it.\n\nFigure 7:\n\nDLL for the RAT being compiled\nAlso in late November, we can see the threat actor testing the side-loading in a typical victim\nmachine.\n\n\n-----\n\nFigure 8: Threat actor tests RAT\n\n## Victims and victim\n\nWe were able to gain visibility on the victims that were successfully compromised:\n\nMinistry of Defense- Government of Pakistan\nNational Defense University of Islam Abad\nFaculty of Bio-Science, UVAS University, Lahore, Pakistan\nInternational center for chemical and biological sciences\nHEJ Research institute of chemistry, International center for chemical and biological\nsciences, univeristy of Karachi\nSHU University, Molecular medicine\n\n\n-----\n\nAnother – unintentional – victim is the threat actor himself which appears to have infected is\nown development machine with the RAT. We can see them running both VirtualBox and\nVMware to do web development and testing. Their main host has dual keyboard layouts\n(English and Indian).\n\nFigure 9: Virtual\n\nmachine running on top of threat actor’s main computer\nOther information that can be obtained is that the weather at the time was cloudy with 19\ndegrees and that they haven’t updated their Java yet. On a more serious note, the threat\nactor uses VPN Secure and CyberGhost to mask their IP address.\n\nFigure 10: Threat\n\nactor uses VPN-S\nUnder the VPN they log into their victim’s email and other accounts stolen by the RAT.\n\nFigure 11: Threat actor logs into\n\nhis victim’s email using CyberGhost VPN\n\n## Conclusion\n\n\n-----\n\nThis blog gave an overview of the latest campaign from the Patchwork APT. While they\ncontinue to use the same lures and RAT, the group has shown interest in a new kind of\ntarget. Indeed this is the first time we have observed Patchwork targeting molecular medicine\nand biological science researchers.\n\nThanks to data captured by the threat actor’s own malware, we were able to get a better\nunderstanding about who sits behind the keyboard. The group makes use of virtual\nmachines and VPNs to both develop, push updates and check on their victims. Patchwork,\nlike some other East Asian APTs is not as sophisticated as their Russian and North Korean\ncounterparts.\n\n## Indicators of Compromise\n\n**Lure**\n\nkarachidha[.]org/docs/EOIForm.rtf\n\n5b5b1608e6736c7759b1ecf61e756794cf9ef3bb4752c315527bcc675480b6c6\n\n**RAT**\n\njli.dll\n\n3d3598d32a75fd80c9ba965f000639024e4ea1363188f44c5d3d6d6718aaa1a3\n\n**C2**\n\nbgre[.]kozow[.]com\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-01-07 - Patchwork APT caught in its own web.pdf"
    ],
    "report_names": [
        "2022-01-07 - Patchwork APT caught in its own web.pdf"
    ],
    "threat_actors": [
        {
            "id": "b740943a-da51-4133-855b-df29822531ea",
            "created_at": "2022-10-25T15:50:23.604126Z",
            "updated_at": "2025-03-27T02:00:55.505366Z",
            "deleted_at": null,
            "main_name": "Equation",
            "aliases": [
                "Equation"
            ],
            "source_name": "MITRE:Equation",
            "tools": null,
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "8492b1a0-126f-4113-b8f7-101d28559629",
            "created_at": "2023-01-06T13:46:38.864213Z",
            "updated_at": "2025-03-27T02:00:02.938147Z",
            "deleted_at": null,
            "main_name": "GRIM SPIDER",
            "aliases": [
                "GOLD ULRICK"
            ],
            "source_name": "MISPGALAXY:GRIM SPIDER",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "7ea1e0de-53b9-4059-802f-485884180701",
            "created_at": "2022-10-25T16:07:24.04846Z",
            "updated_at": "2025-03-27T02:02:10.090459Z",
            "deleted_at": null,
            "main_name": "Patchwork",
            "aliases": [
                "APT-C-09",
                "ATK 11",
                "Capricorn Organisation",
                "Chinastrats",
                "Dropping Elephant",
                "Maha Grass",
                "Quilted Tiger",
                "TG-4410",
                "Thirsty Gemini",
                "Zinc Emerson"
            ],
            "source_name": "ETDA:Patchwork",
            "tools": [
                "AndroRAT",
                "Artra Downloader",
                "ArtraDownloader",
                "AutoIt backdoor",
                "BADNEWS",
                "BIRDDOG",
                "Bahamut",
                "Bozok",
                "Bozok RAT",
                "Brute Ratel",
                "Brute Ratel C4",
                "CinaRAT",
                "Crypta",
                "ForeIT",
                "JakyllHyde",
                "Loki",
                "Loki.Rat",
                "LokiBot",
                "LokiPWS",
                "NDiskMonitor",
                "Nadrac",
                "PGoShell",
                "PowerSploit",
                "PubFantacy",
                "Quasar RAT",
                "QuasarRAT",
                "Ragnatela",
                "Ragnatela RAT",
                "SocksBot",
                "TINYTYPHON",
                "Unknown Logger",
                "WSCSPL",
                "Yggdrasil"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "9c884c88-2c9f-49c5-856a-2383ad1d8ef8",
            "created_at": "2024-05-01T02:03:08.152Z",
            "updated_at": "2025-03-27T02:05:17.422887Z",
            "deleted_at": null,
            "main_name": "ZINC EMERSON",
            "aliases": [
                "Dropping Elephant ",
                "EHDevel ",
                "Manul ",
                "Monsoon ",
                "Operation Hangover ",
                "Patchwork ",
                "TG-4410 ",
                "Viceroy Tiger ",
                "Confucius "
            ],
            "source_name": "Secureworks:ZINC EMERSON",
            "tools": [
                " Hanove",
                " Mac OS X KitM Spyware",
                " Proyecto2",
                " YTY Backdoor",
                "Enlighten Infostealer"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "e6a21528-2999-4e2e-aaf4-8b6af14e17f3",
            "created_at": "2022-10-25T16:07:24.422115Z",
            "updated_at": "2025-03-27T02:02:10.216817Z",
            "deleted_at": null,
            "main_name": "Wizard Spider",
            "aliases": [
                "DEV-0193",
                "Gold Blackburn",
                "Gold Ulrick",
                "Grim Spider",
                "ITG23",
                "Operation BazaFlix",
                "Periwinkle Tempest",
                "TEMP.MixMaster",
                "Wizard Spider"
            ],
            "source_name": "ETDA:Wizard Spider",
            "tools": [
                "AdFind",
                "Agentemis",
                "Anchor_DNS",
                "BEERBOT",
                "BazarBackdoor",
                "BazarCall",
                "BazarLoader",
                "Cobalt Strike",
                "CobaltStrike",
                "Conti",
                "Diavol",
                "Dyranges",
                "Dyre",
                "Dyreza",
                "Dyzap",
                "Gophe",
                "Invoke-SMBAutoBrute",
                "KEGTAP",
                "LaZagne",
                "LightBot",
                "PowerSploit",
                "PowerTrick",
                "PsExec",
                "Ryuk",
                "SessionGopher",
                "TSPY_TRICKLOAD",
                "Team9Backdoor",
                "The Trick",
                "TheTrick",
                "Totbrick",
                "TrickBot",
                "TrickLoader",
                "TrickMo",
                "Upatre",
                "bazaloader",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "2b29dd16-a06f-4830-81a1-365443bc54b8",
            "created_at": "2023-01-06T13:46:38.460047Z",
            "updated_at": "2025-03-27T02:00:02.839173Z",
            "deleted_at": null,
            "main_name": "QUILTED TIGER",
            "aliases": [
                "ATK11",
                "G0040",
                "Orange Athos",
                "Chinastrats",
                "Sarit",
                "Dropping Elephant",
                "APT-C-09",
                "Thirsty Gemini",
                "ZINC EMERSON"
            ],
            "source_name": "MISPGALAXY:QUILTED TIGER",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "c81067e0-9dcb-4e3f-abb0-80126519c5b6",
            "created_at": "2022-10-25T15:50:23.285448Z",
            "updated_at": "2025-03-27T02:00:55.42906Z",
            "deleted_at": null,
            "main_name": "Patchwork",
            "aliases": [
                "Hangover Group",
                "Dropping Elephant",
                "Chinastrats",
                "Operation Hangover"
            ],
            "source_name": "MITRE:Patchwork",
            "tools": [
                "NDiskMonitor",
                "QuasarRAT",
                "BackConfig",
                "TINYTYPHON",
                "AutoIt backdoor",
                "PowerSploit",
                "BADNEWS",
                "Unknown Logger",
                "Socksbot"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "3aaf0755-5c9b-4612-9f0e-e266ef1bdb4b",
            "created_at": "2022-10-25T16:07:23.480196Z",
            "updated_at": "2025-03-27T02:02:09.826059Z",
            "deleted_at": null,
            "main_name": "Comment Crew",
            "aliases": [
                "APT 1",
                "BrownFox",
                "Byzantine Candor",
                "Byzantine Hades",
                "Comment Crew",
                "Comment Panda",
                "GIF89a",
                "Group 3",
                "Operation Oceansalt",
                "Operation Seasalt",
                "Operation Siesta",
                "Shanghai Group",
                "TG-8223"
            ],
            "source_name": "ETDA:Comment Crew",
            "tools": [
                "Auriga",
                "Cachedump",
                "Chymine",
                "CookieBag",
                "Darkmoon",
                "GDOCUPLOAD",
                "GLOOXMAIL",
                "GREENCAT",
                "Gen:Trojan.Heur.PT",
                "GetMail",
                "Hackfase",
                "Hacksfase",
                "Helauto",
                "Kurton",
                "LETSGO",
                "LIGHTBOLT",
                "LIGHTDART",
                "LOLBAS",
                "LOLBins",
                "LONGRUN",
                "Living off the Land",
                "Lslsass",
                "MAPIget",
                "ManItsMe",
                "Mimikatz",
                "MiniASP",
                "Oceansalt",
                "Pass-The-Hash Toolkit",
                "Poison Ivy",
                "ProcDump",
                "Riodrv",
                "SPIVY",
                "Seasalt",
                "ShadyRAT",
                "StarsyPound",
                "TROJAN.COOKIES",
                "TROJAN.FOXY",
                "TabMsgSQL",
                "Tarsip",
                "Trojan.GTALK",
                "WebC2",
                "WebC2-AdSpace",
                "WebC2-Ausov",
                "WebC2-Bolid",
                "WebC2-Cson",
                "WebC2-DIV",
                "WebC2-GreenCat",
                "WebC2-Head",
                "WebC2-Kt3",
                "WebC2-Qbp",
                "WebC2-Rave",
                "WebC2-Table",
                "WebC2-UGX",
                "WebC2-Yahoo",
                "Wordpress Bruteforcer",
                "bangat",
                "gsecdump",
                "pivy",
                "poisonivy",
                "pwdump",
                "zxdosml"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535748,
    "ts_updated_at": 1743041706,
    "ts_creation_date": 1653779995,
    "ts_modification_date": 1653779995,
    "files": {
        "pdf": "https://archive.orkl.eu/93c4ad9fa0ee5779f0c97f5a3936aba16c53891d.pdf",
        "text": "https://archive.orkl.eu/93c4ad9fa0ee5779f0c97f5a3936aba16c53891d.txt",
        "img": "https://archive.orkl.eu/93c4ad9fa0ee5779f0c97f5a3936aba16c53891d.jpg"
    }
}