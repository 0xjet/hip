{
    "id": "07e04656-9d85-45ee-9f71-ea6a4f787881",
    "created_at": "2023-01-12T14:59:08.781995Z",
    "updated_at": "2025-03-27T02:05:44.921496Z",
    "deleted_at": null,
    "sha1_hash": "3105f2974e74847d5fee5d0f1e468cd982b8bac7",
    "title": "2022-03-11 - New Wiper Malware Attacking Russia- Deep-Dive Into RURansom Malware",
    "authors": "",
    "file_creation_date": "2022-05-27T23:06:35Z",
    "file_modification_date": "2022-05-27T23:06:35Z",
    "file_size": 1613808,
    "plain_text": "# New Wiper Malware Attacking Russia: Deep-dive into RURansom Malware\n\n**[blog.cyble.com/2022/03/11/new-wiper-malware-attacking-russia-deep-dive-into-ruransom-malware/](https://blog.cyble.com/2022/03/11/new-wiper-malware-attacking-russia-deep-dive-into-ruransom-malware/)**\n\nMarch 11, 2022\n\n[During our regular OSINT research, Cyble Research Labs came across a twitter post by the MalwareHunter](https://twitter.com/malwrhunterteam/status/1498678603613155343)\nteam, highlighting a ransomware named RURansom which was found attacking Russia. This malware is\ncalled RURansom as the file’s Program Database (PDB) contains a sub string “RURansom”, as shown\nbelow:\n\n**C:\\Users\\Admin1\\source\\repos\\RURansom\\RURansom\\obj\\Debug\\RURansom.pdb**\n\nThe ongoing cyber warfare between Russia and Ukraine has witnessed a series of different Wiper Malware\n[attacks including WhisperGate,](https://blog.cyble.com/2022/02/01/whispergate-malware-deep-dive-analysis/) [HermeticWiper, and IsaacWiper malware. Adding to this existing list of](https://blog.cyble.com/2022/03/04/ongoing-cyberwarfare-a-look-at-the-key-cyberattacks/)\ndestructive malware, researchers have now found the RURansom wiper malware.\n\nThe RURansom malware operates by wiping the files present in the victim’s computer and spreads like a\nworm within the network or through connected USB devices. Finally, the malware drops ransom notes in the\nVictim’s machine as shown in Figure 1.\n\n\n-----\n\n_Figure 1 Ransom_\n\n_Note written in Russian_\n\n## Technical Analysis\n\nIn this blog, we will conduct a deep-dive technical analysis of the RURansom Malware used in the attack. We\nhave analysed the sample SHA256**107da216ad99b7c0171745fe7f826e51b27b1812d435b55c3ddb801e23137d8, which is a 32-bit PE file**\nwritten in the .NET programming language.\n\n_Figure 2: File Info of_\n\n_RURansom Malware_\n\n### Geolocation Identification\n\nThe RURansom malware traces the IP location of the victim machine and is executed only if it detects an IP\n[belonging to Russia. For IP identification, the malware uses two APIs named https://api.ipify.org and](https://api.ipify.org/)\n[https://ip-api.com that are hardcoded within its code.](https://ip-api.com/)\n\n\n-----\n\n_Figure 3: IP Geo_\n\n_Location Identification_\n\n### Privilege Escalation\n\nAfter identifying the geolocation of the machine, the malware further checks for the Administrator rights in the\ninfected machine, as shown in Figure 4 and 5.\n\n_Figure 4: Administrator Check Used in the_\n\n_Malware_ _Figure 5:_\n\n_IsElevated Function_\nIf the malware does not get Admin privileges, it tries to execute itself in the elevated mode using the following\nPowerShell command.\n\n_cmd.exe /c powershell stART-PRoceSS Assembly.GetExecutingAssembly().Location -veRB rUnAS_\n\n_Figure 6: Code to_\n\n_get Elevated Privilege_\n\n### Discovery of connected Drives\n\n\n-----\n\nThe RURansom wiper malware proceeds to scan the drives in the victim s system, including the removable\nand network drives connected to the victim’s machine.\n\n_Figure 7: Searching_\n\n_for Drives_\n\n### Encryption and Deletion\n\nAfter scanning the drives, the malware encrypts all the files from the identified directories and sub-directories\nin the victim’s machine. To prevent the recovery of the encrypted data from the backup files, the malware also\ndeletes the .bak files from the infected machines.\n\n_Figure 8: File_\n\n_Encryption & Deletion_\n\n### Encryption Algorithm\n\nOur research indicated that the malware uses the AES-CBC encryption algorithm to encrypt files in the\nvictim’s machine.\n\n\n-----\n\n_Figure 9: AES_\n\n_Encryption_\n\n### Ransom Note\n\nFinally, the RURansom malware drops a ransom note file named Полномасштабное_кибервторжение.txt\n(Full-blown_cyber-invasion.txt). The note is written in Russian and dropped in all the directories where the\nfiles are encrypted. The ransom note and file name are shown in the figure below.\n\n_Figure 10: Ransom_\n\n_Note in Russian_\nThe image below showcases the English translation of the ransom note dropped by RURansom malware.\n\n_Figure 11: Ransom Note Translation in English_\n\n### Encryption Key\n\nAs per our research, we have observed that the files are encrypted using a randomly generated AES key.\nThe key is calculated using the hard-coded strings such as FullScaleCyberInvasion, RU_Ransom, and 2022\nalong with Victim’s Machine Name and UserName. Figure 12 shows the code that generates random AES\nkey.\n\n\n-----\n\n_Figure 12: AES Key_\n\n_Generation_\n\n### Spreading Mechanism\n\nThe malware renames itself as Россия-Украина_Война-Обновление.doc.exe (Russia-Ukraine_WarUpdate.doc.exe) and spreads to all connected systems.\n\n_Figure 13: Code for_\n\n_Spreading_ _Figure_\n\n_14: Ransom Note and the Copy of Malware used for Spreading_\n\n### Similarities with dnWiper\n\nAfter a deep-dive analysis of the Tactics, techniques and procedures (TTPs) identified in the RURansom\nwiper malware, we have observed that it has several similarities with dnWiper. Researchers at TrendMicro\n[also believe that the same Threat Actors are behind the two wiper malware, as stated in their report.](https://www.trendmicro.com/en_us/research/22/c/new-ruransom-wiper-targets-russia.html)\n\nThe major difference between the RURansom & dnWiper malware is that the latter targets only specific\nextensions such as .doc, .docx, .png, .gif, .jpeg, .jpg, .mp4, etc., while RuRansom encrypts all file extensions.\n\n_Figure 15: dnWiper_\n\n_Sample Code_\n\n## Conclusion \n\n\n-----\n\nThe files encrypted by the RURansom wiper malware are irreversible. Based on the ransom note and the\ntechnical specifications of the malware, we suspect that it has been devised to target Russia, but the identity\nof the Threat Actors behind this malware is still unknown.\n\nGiven the continued conflict and geopolitical tensions between Russia and Ukraine, we expect an increase in\ncyber warfare with both nations targeting each other.\n\n## Our Recommendations \n\nWe have listed some essential cybersecurity best practices that create the first line of control against\nattackers. We recommend that our readers follow the suggestions given below:\n\nDon’t keep important files at common locations such as the Desktop, My Documents, etc.\nUse strong passwords and enforce multi-factor authentication wherever possible.\nTurn on the automatic software update feature on your computer, mobile, and other connected devices\nwherever possible and pragmatic.\nUse a reputed anti-virus and Internet security software package on your connected devices, including\nPC, laptop, and mobile.\nRefrain from opening untrusted links and email attachments without verifying their authenticity.\nConduct regular backup practices and keep those backups offline or in a separate network.\n\n## MITRE ATT&CK® Techniques \n\nTactic Technique ID\n\n**Execution** [T1204](https://attack.mitre.org/techniques/T1204/) User Execution\n\n**Discovery** [T1518](https://attack.mitre.org/techniques/T1518) Security Software Discovery\n\n[T1087](https://attack.mitre.org/techniques/T1087) Account Discovery\n\n[T1083](https://attack.mitre.org/techniques/T1083) File and Directory Discovery\n\n**Impact** [T1485](https://attack.mitre.org/techniques/T1485) Data Destruction\n\n[T1486](https://attack.mitre.org/techniques/T1486) Data Encrypted for Impact\n\n[T1565](https://attack.mitre.org/techniques/T1565) Data Manipulation\n\n## Indicators Of Compromise (IoCs)\n\n\n**Indicators** **Indicator**\n**type**\n\n\n**Description**\n\n\n6cb4e946c2271d28a4dee167f274bb80 MD5 RURansom.exe\n\n0bea48fcf825a50f6bf05976ecbb66ac1c3daa6b SHA1\n\n979f9d1e019d9172af73428a1b3cbdff8aec8fdbe0f67cba48971a36f5001da9 SHA256\n\nfe43de9ab92ac5f6f7016ba105c1cb4e MD5 RURansom.exe\n\n27a16e1367fd3e943a56d564add967ad4da879d8 SHA1\n\n\n-----\n\n8f2ea18ed82085574888a03547a020b7009e05ae0ecbf4e9e0b8fe8502059aae SHA256\n\n9c3316a9ff084ed4d0d072df5935f52d MD5 RURansom.exe\n\nc6ef59aa3f0cd1bb727e2464bb728ab79342ad32 SHA1\n\n696b6b9f43e53387f7cef14c5da9b6c02b6bf4095849885d36479f8996e7e473 SHA256\n\n191e51cd0ca14edb8f06c32dcba242f0 MD5 dnWIPE.exe\n\nfbeb9eb14a68943551b0bf95f20de207d2c761f6 SHA1\n\n610ec163e7b34abd5587616db8dac7e34b1aef68d0260510854d6b3912fb0008 SHA256\n\n01ae141dd0fb97e69e6ea7d6bf22ab32 MD5 RURansom.exe\n\nc35ab665f631c483e6ec315fda0c01ba4558c8f2 SHA1\n\n1f36898228197ee30c7b0ec0e48e804caa6edec33e3a91eeaf7aa2c5bbb9c6e0 SHA256\n\n8fe6f25fc7e8c0caab2fdca8b9a3be89 MD5 RURansom.exe\n\na30bf5d046b6255fa2c4b029abbcf734824a7f15 SHA1\n\n107da216ad99b7c0171745fe7f826e51b27b1812d435b55c3ddb801e23137d8f SHA256\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-03-11 - New Wiper Malware Attacking Russia- Deep-Dive Into RURansom Malware.pdf"
    ],
    "report_names": [
        "2022-03-11 - New Wiper Malware Attacking Russia- Deep-Dive Into RURansom Malware.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673535548,
    "ts_updated_at": 1743041144,
    "ts_creation_date": 1653692795,
    "ts_modification_date": 1653692795,
    "files": {
        "pdf": "https://archive.orkl.eu/3105f2974e74847d5fee5d0f1e468cd982b8bac7.pdf",
        "text": "https://archive.orkl.eu/3105f2974e74847d5fee5d0f1e468cd982b8bac7.txt",
        "img": "https://archive.orkl.eu/3105f2974e74847d5fee5d0f1e468cd982b8bac7.jpg"
    }
}