{
    "id": "c45a4cbc-47b5-4155-bcbb-a8d2ab5dba5d",
    "created_at": "2023-01-12T14:59:39.847063Z",
    "updated_at": "2025-03-27T02:05:58.817066Z",
    "deleted_at": null,
    "sha1_hash": "ba3c96217686f2d9a78cdc94798469191135f526",
    "title": "2022-04-27 - Emotet Returns With New TTPs And Delivers .Lnk Files To Its Victims",
    "authors": "",
    "file_creation_date": "2022-05-27T23:07:11Z",
    "file_modification_date": "2022-05-27T23:07:11Z",
    "file_size": 543190,
    "plain_text": "# Emotet Returns With New TTPs And delivers .lnk files to its victims\n\n**[blog.cyble.com/2022/04/27/emotet-returns-with-new-ttps-and-delivers-lnk-files-to-its-victims/](https://blog.cyble.com/2022/04/27/emotet-returns-with-new-ttps-and-delivers-lnk-files-to-its-victims/)**\n\nApril 27, 2022\n\n[On 2024-04-22, the @malware_traffic posted on their Twitter handle that the epoch4 Emotet server started spamming](https://twitter.com/malware_traffic/status/1517622327000846338)\nand delivering zipped .lnk files to its victims through spam email, as shown in Figure 1. The .lnk file further executes\nVBScript or PowerShell script to download the Emotet payload in the victims’ machine. The use of a .lnk file and\nPowerShell or VBScript is a new combination that has not been used by the Emotet before.\n\n\n-----\n\nFigure 1 – Spam Email\n\n[The Cyble Research Labs has already published a blog about Emotet TTPs in February 2022. During this time, the](https://blog.cyble.com/2022/02/26/emotet-malware-back-in-action/)\nEmotet was delivered to users with a spam email containing an MS excel attachment.\n\n## Technical Analysis\n\n### Infection Chain-1\n\nSHA256: 115d7891a2abbe038c12ccc9ed3cfeedfdd1242e51bcc67bfa22c7cc2567fb10\n\nThe initial infection starts when the user extracts the password-protected zip file and executes the link file in the\nmachine. Upon execution, the .lnk file has commands to drop a malicious VB script file in the Temp location of the\ntarget machine, as shown in the below figure.\n\n\n-----\n\nFigure 2 – Command to Drop VBScript\n\nThe dropped VB script further executes with the help of WScript.exe, downloads the Emotet payload from the remote\nserver, and executes it using regsvr32.exe. The payload URLs are encoded using base64 and decoded during\nruntime for downloading the Emotet payload. The below Figure shows the VBS file.\n\nFigure 3 – Downloads and\n\nExecutes Payload\nThe below Figure depicts the execution flow of Emotet malware through WScript.\n\nFigure 4 – Execution FlowThrough\n\nWScript\n\n### Infection Chain-2\n\n**SHA256:09f44c33ba0a5f1e22cd5b8b0d40c9808e2668ee9050ac855a6ae0744bc9e924**\n\n\n-----\n\nOn 2024 04 26, the Emotet campaigns started using .lnk and PowerShell combinations for delivering the payloads. In\nthis campaign, the .lnk file drops a PowerShell file in the Temp folder, which further downloads the Emotet payload\nfrom the remote server and executes it using regsvr32.exe. The below Figure shows the PowerShell command used\nby the malware.\n\nFigure 5 – Downloads and\n\nExecute Emotet Payload\nThe below Figure depicts the execution flow of Emotet malware through PowerShell.\n\nFigure 6 – Execution\n\nFlowThrough PowerShell\n\n## Conclusion\n\nEmotet is a sophisticated and long-lasting malware that has impacted users globally. Threat Actors are constantly\nadapting their techniques to stay one step of cybersecurity entities – Emotet is one such example. Cyble Research\nLabs is continuously monitoring the activity of Emotet and other malware and will keep our readers updated.\n\n## Our Recommendations\n\nWe have listed some essential cybersecurity best practices that create the first line of control against attackers. We\nrecommend that our readers follow the best practices given below:\n\nDon’t keep important files in common locations such as the Desktop, My Documents, etc.\nUse strong passwords and enforce multi-factor authentication wherever possible.\nTurn on the automatic software update feature on your computer, mobile, and other connected devices\nwherever possible and pragmatic.\nUse a reputed anti-virus and Internet security software package on your connected devices, including PC,\nlaptop, and mobile.\nRefrain from opening untrusted links and email attachments without verifying their authenticity.\nConduct regular backup practices and keep those backups offline or in a separate network.\n\n## MITRE ATT&CK® Techniques\n\n**Tactic** **Technique ID** **Technique Name**\n\n\n**Initial Access** [T1566](https://attack.mitre.org/techniques/T1566/)\n\n[T1566.001](https://attack.mitre.org/techniques/T1566/001/)\n\n\n– Phishing\n\n– Phishing: Spearphishing Attachment\n\n\n**Execution** [T1059](https://attack.mitre.org/techniques/T1059/) – Command and Scripting Interpreter\n\n\n**Credential Access** [T1573](https://attack.mitre.org/techniques/T1573/)\n\n[T1571](https://attack.mitre.org/techniques/T1571/)\n\n[T1110.001](https://attack.mitre.org/techniques/T1110/001/)\n\n\n– Encrypted Channel\n\n– Non-Standard Port\n\n– Brute Force: Password Guessing\n\n\n-----\n\n**Discovery** [T1087](https://attack.mitre.org/techniques/T1087/) – Account Discovery\n\n**Collection** [T1560](https://attack.mitre.org/techniques/T1560/) – Archive Collected Data\n\n**Privilege Escalation** [T1547.001](https://attack.mitre.org/techniques/T1547/001/) – Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder\n\n## Indicators of Compromise (IOCs)\n\n\n**Indicators** **Indicator**\n**Type**\n\n\n**Description**\n\n\n**95e0286c6c38320d9673b6492f9e2284** MD5 Datos-2504.lnk\n\n**7ae2cf1d20de3a965b1c5f41368aa29e12eba450** SHA1 Datos-2504.lnk\n\n**115d7891a2abbe038c12ccc9ed3cfeedfdd1242e51bcc67bfa22c7cc2567fb10** SHA256 Datos-2504.lnk\n\n**3952caf999263773be599357388159e0** MD5 SRW735125373WM.lnk\n\n**76c39a3a4823beab79e497bfcdbc2367188d95c4** SHA1 SRW735125373WM.lnk\n\n**09f44c33ba0a5f1e22cd5b8b0d40c9808e2668ee9050ac855a6ae0744bc9e924** SHA256 SRW735125373WM.lnk\n\n**hxxps://creemo.pl/wp-admin/ZKS1DcdquUT4Bb8Kb/** URL Emotet Dropper URL\n\n**hxxp://filmmogzivota.rs/SpryAssets/gDR/** URL Emotet Dropper URL\n\n**hxxp://demo34.ckg.hk/service/hhMZrfC7Mnm9JD/** URL Emotet Dropper URL\n\n**hxxp://focusmedica.in/fmlib/IxBABMh0I2cLM3qq1GVv/** URL Emotet Dropper URL\n\n**hxxp://cipro.mx/prensa/siZP69rBFmibDvuTP1L/** URL Emotet Dropper URL\n\n**hxxp://colegiounamuno.es/cgi-bin/E/** URL Emotet Dropper URL\n\n**hxxp://focusmedica.in/fmlib/IxBABMh0I2cLM3qq1GVv/** URL Emotet Dropper URL\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-04-27 - Emotet Returns With New TTPs And Delivers .Lnk Files To Its Victims.pdf"
    ],
    "report_names": [
        "2022-04-27 - Emotet Returns With New TTPs And Delivers .Lnk Files To Its Victims.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673535579,
    "ts_updated_at": 1743041158,
    "ts_creation_date": 1653692831,
    "ts_modification_date": 1653692831,
    "files": {
        "pdf": "https://archive.orkl.eu/ba3c96217686f2d9a78cdc94798469191135f526.pdf",
        "text": "https://archive.orkl.eu/ba3c96217686f2d9a78cdc94798469191135f526.txt",
        "img": "https://archive.orkl.eu/ba3c96217686f2d9a78cdc94798469191135f526.jpg"
    }
}