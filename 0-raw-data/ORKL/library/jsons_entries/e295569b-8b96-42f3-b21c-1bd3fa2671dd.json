{
    "id": "e295569b-8b96-42f3-b21c-1bd3fa2671dd",
    "created_at": "2022-10-25T16:48:16.174753Z",
    "updated_at": "2025-03-27T02:16:39.981982Z",
    "deleted_at": null,
    "sha1_hash": "f379aa885d52567de38ad7ffe6be90aca2140f56",
    "title": "",
    "authors": "",
    "file_creation_date": "2021-01-28T15:45:41Z",
    "file_modification_date": "2021-01-28T15:45:41Z",
    "file_size": 1661743,
    "plain_text": "# “Lebanese Cedar” APT\n## Global Lebanese Espionage Campaign Leveraging\n Web Servers\n\n### January 2021\n\n#### TLP:WHITE\n\n(C) All rights reserved for ClearSky Cyber Security ltd 2021\n\n[www.clearskysec.com](http://www.clearskysec.com/)\ninfo@clearskysec.com\n\n____________________________________________________________________________________________________\n\n**[www.clearskysec.com](http://www.clearskysec.com/)** **© All rights reserved to ClearSky Cyber Security ltd. 2021**\n\n\n-----\n\n##### Table of Contents\n\nIntroduction .................................................................................................................................................. 3\n\nCurrent Toolset ............................................................................................................................................. 8\n\nMITRE ATT&CK Categorization ................................................................................................................. 9\n\nModus Operandi ......................................................................................................................................... 11\n\nInstallation & C&C ................................................................................................................................... 12\n\nCustomized WebShell – \"Caterpillar\" 2.0 ........................................................................................... 13\n\nWebShell Containing Modules Taken from Iranian Hacktivist Groups ............................................... 17\n\nOpen-Source WebShell Obtained Online ................................................................................................ 19\n\nOpen-Source Management Panels ..................................................................................................... 19\n\nThe \"Explosive\" Custom RAT ................................................................................................................... 20\n\nAnti-Debugging ................................................................................................................................... 21\n\nNew Modules ...................................................................................................................................... 21\n\nCommunication with C2 over SSL ....................................................................................................... 21\n\nAttribution................................................................................................................................................... 22\n\nSummary and Insights ................................................................................................................................. 24\n\nIndicators of Compromise ........................................................................................................................... 25\n\nHashes ..................................................................................................................................................... 25\n\n____________________________________________________________________________________________________\n\n**[www.clearskysec.com](http://www.clearskysec.com/)** **© All rights reserved to ClearSky Cyber Security ltd. 2021**\n\n\n-----\n\n###### Introduction\n\nLebanese Cedar is an APT group that has been operating for almost a decade attacking companies and\norganizations around the world.\n\nThe group's main attack vector is intrusion into Oracle and Atlassian WEB servers. We assess that the\n\nintrusion into these systems was done by exploiting known vulnerabilities in systems that were not\n\npatched and detecting loopholes using open-source hacking tools.\n\nIn early 2020, suspicious network activities and hacking tools were found in a range of companies.\n\nComprehensive forensic research of the infected systems revealed a strong connection to Lebanese Cedar\nand a new version of the \"Explosive” V4 RAT (Remote Access Tool) or \"Caterpillar\" V2 WebShell was found\nwithin the victim’s networks.\n\nLebaneseCedar Timeline\n\nBased on a modified JSP file browser with a unique string that the adversary used to deploy ‘Explosive\nRAT’ into the victims’ network, we found some 250 servers that were apparently breached by Lebanese\nCedar. Our report reveals a partial list of the companies that the group has attacked. The target companies\nare from many countries including: The United States, the United Kingdom, Egypt, Jordan, Lebanon, Israel,\nand the Palestinian Authority. We assess that there are many more companies that have been hacked and\n\nthat valuable information was stolen from these companies over periods of months and years.\n\nLebanese Cedar APT has been operating since 2012. These operations were first discovered by Check-Point\n\nresearchers and Kaspersky labs in 2015. Since 2015 Lebanese Cedar APT - also referred to as “Volatile\n\nCedar” – maintained a low profile and operated under the radar. According to Check-Point’s report, the\n\ngroup is motivated by political and Ideological interests, targeting individuals, companies, and institutions\n\nworldwide. We endorse Check Point’s strong case attributing Lebanese Cedar APT to the Lebanese\n\ngovernment or a political group in Lebanon. Moreover, there are several indications that link Lebanese\nCedar APT to the Hezbollah Cyber Unit[1].\n\n1 https://www.defensenews.com/2015/06/24/israel-confirms-it-was-cyber-attack-target/\n\n____________________________________________________________________________________________________\n\n**[www.clearskysec.com](http://www.clearskysec.com/)** **© All rights reserved to ClearSky Cyber Security ltd. 2021**\n\n\n-----\n\nKnown for its highly evasive, selectively targeted, and carefully managed operations, Lebanese Cedar\nfollows courses of action associated with Advanced Persistent Threat groups (APTs) funded by nationstates or political groups.\n\n“Caterpillar WebShell” was found in most of the victims we investigated, in many of the systems we also\n\nfound traces of “Explosive” RAT. We identified the specific open-source JSP file browser[2] that was modified\n\nfor the hackers’ purposes. We found that Lebanese Cedar deployed the payload of Explosive RAT into the\n\nvictims’ network. Lebanese Cedar is the only known threat actor that uses this code.\n\nThese files were installed on the victims’ Oracle servers, thus exposing them, and enabling hackers to\ninstall new files within the server. We used the same pattern and the unique strings of a publicly available\n\nJSP file browser to detect infected servers. To identify the targets, we queried public-facing web servers of\nOracle 10g for specific directories and filenames, including the unique hash of the file we identified in the\n\ncompromised network, that included the unique strings of Lebanese Cedar.\n\nThe operation enabled us to fingerprint the targets of Lebanese Cedar APT and categorize them based on\n\nsector and country of origin. We identified 254 infected servers worldwide, 135 of them shared the same\n\nhash as the files we identified in the victims’ network during our IR investigation. Some of the servers\n\nrepresent countries that were attacked – among them, many Middle Eastern countries (most of them in\nEgypt, Saudi Arabia, Israel, and Jordan) – and others represent hosting servers hacked by the APT. A map\n\nof all the servers we identified during our scan is presented below:\n\n2 https://github.com/SvetlinZarev/jsp-file-browser/blob/master/Browser.jsp\n\n____________________________________________________________________________________________________\n\n**[www.clearskysec.com](http://www.clearskysec.com/)** **© All rights reserved to ClearSky Cyber Security ltd. 2021**\n\n\n-----\n\nMost of the victims we identified are from the Telecommunications and IT industry, Hosting providers,\nCommunications companies and Managed Hosting and Applications companies. Examples of telecom\nproviders whose servers were observed in our scans and share the same hash as the one we identified in\n\nthe IR investigation include the following:\n\nCountry Victims’ examples Details about the company\n\nOklahoma Office of Management & A government agency which manages and\n\nEnterprise Service supports the basic functioning of the\n\ngovernment of Oklahoma\n\nUnited States\n\nSecured Servers LLC Web hosting and infrastructure solutions\n\nFrontier Communications American telecommunications company\n\nIomart Cloud Services Limited A company managed infrastructure, data\n\nUnited Kingdom protection, security, and connectivity solutions\n\nto help business transformation\n\nTE Data Internet service provider\n\nVodafone Egypt Mobile network operator\n\nMobily Telecommunications services company\n\nSaudiNet Telecommunications services company\nSaudi Arabia\n\nMiddle East Internet Company Limited Telephone voice and data communications\n\nservices\n\n____________________________________________________________________________________________________\n\n**[www.clearskysec.com](http://www.clearskysec.com/)** **© All rights reserved to ClearSky Cyber Security ltd. 2021**\n\n|Country|Victims’ examples|Details about the company|\n|---|---|---|\n|United States|Oklahoma Office of Management & Enterprise Service|A government agency which manages and supports the basic functioning of the government of Oklahoma|\n||Secured Servers LLC|Web hosting and infrastructure solutions|\n||Frontier Communications|American telecommunications company|\n|United Kingdom|Iomart Cloud Services Limited|A company managed infrastructure, data protection, security, and connectivity solutions to help business transformation|\n|Egypt|TE Data|Internet service provider|\n||Vodafone Egypt|Mobile network operator|\n|Saudi Arabia|Mobily|Telecommunications services company|\n||SaudiNet|Telecommunications services company|\n||Middle East Internet Company Limited|Telephone voice and data communications services|\n\n\n-----\n\n|Country|Victims’ examples|Details about the company|\n|---|---|---|\n||Arabian Internet & Communications Services Co.ltd|Telecommunications services company|\n|Jordan|Vtel Holdings Limited/Jordan Co.|Telecommunications service provider|\n||National Information Technology Center|Data storage, sharing computing resources, email/internet, and website hosting|\n||Jordanian Universities Network L.L.C.|Private organization aimed to serve public and private universities in Jordan through shared services framework model|\n|United Arab Emirates|Etisalat|Telecommunication Group Company|\n|Palestinian Authority|Hadara|Internet Services|\n\n\nIn our analysis, we identified two types of JSP files with the unique string – test.jsp, that was installed in\nthe servers between 2018-2019 and yup.jsp that was installed in the servers after 2020. In most cases, the\nfiles were installed on the following four dates: January 24[th], 2019, January 06[th] 2020, February 25[th], 2020\nand August 3[rd], 2020. The files were installed simultaneously on multiple ports that redirect to the Oracle\nserver. The focus on both specific victims and common dates, leads to the conclusion that Lebanese Cedar\nspecifically target their victims, and install the malicious files with automatic scripts.\n\nAn example for the JSP file browsers installed in one of victims’ oracle server.\n\nThe oracle servers that the group accessed are still open. This allows other hackers and criminals to attack\n\nthese networks and view and access all the files in the server (including deleting and downloading them).\n\nAlthough we assume that the group kept operating since it was exposed in 2015, we could not find any\n\nevidence supporting this assumption. It appears that during the past five years, the group successfully\n\n____________________________________________________________________________________________________\n\n**[www.clearskysec.com](http://www.clearskysec.com/)** **© All rights reserved to ClearSky Cyber Security ltd. 2021**\n\n\n-----\n\n**remained unnoticed by the security community. ClearSky analysts have several assumptions as to how**\nthe group had managed to maintain a consistently low profile:\n\n  - The utilization of common WebShell as the group’s primary hacking tool, while rarely using other\ntools, led researchers to a dead-end in terms of attribution.\n\n  - Lebanese Cedar has shifted its focus significantly, initially they attacked computers as an initial\npoint of access then progressed to the victim’s network then further progressing to targeting\n\nvulnerable, public facing web servers. Among these, the most commonly attacked server is a\n\nvulnerable version of an Oracle web server.\n\n  - Known for its ‘radio silence’ periods, the group had probably ceased its operations for long enough\n\nto avoid researchers’ attention.\n\n____________________________________________________________________________________________________\n\n**[www.clearskysec.com](http://www.clearskysec.com/)** **© All rights reserved to ClearSky Cyber Security ltd. 2021**\n\n\n-----\n\n###### Current Toolset\n\nLebanese Cedar APT’s arsenal consists of a fully-fledged WebShell, a custom-developed RAT and a set of\ncarefully selected complementary tools, including URI brute force tools. The group uses open-source tools\n\nalongside their own custom tools, including custom WebShell, most likely created by Iranian hacktivist\n\ngroups such as ‘ITSecTeam’ and ‘Persian Hacker’. The nature of the relations between Lebanese Cedar\n\nand these groups is still vague.\n\nMost of the tools deployed in the recent campaign were developed by the group itself. In addition, some\n\nmore common tools have been used. The tools used by the group can be divided into the following\ncategories:\n\n1. **Self-developed tools – tools tailored for the attack process of Lebanese Cedar APT only.**\n\n`o` **Caterpillar 2.0 by N.T – Self developed WebShell embedded in the victims’**\n\ncompromised servers.\n`o` **Explosive – Remote Access Tool (RAT) that has been used by this threat actor since 2015**\n\nand was modified over time to include new features.\n2. **Open-source tools – tools available online used by the group. In this category, we include the**\n\nWebShell’ code that was embedded in Caterpillar V2, as well as the following.\n\n`o` **Web hacking tools**\n\n         - GoBuster – a tool used to brute-force website URIs (directories and files), DNS\nsubdomains (with wildcard support) and Virtual Host names on target web\nservers.\n\n         - DirBuster – a multi-threaded java application designed to brute force directories\nand file names on web and application servers.\n`o` **WebShell**\n\n         - Open-source WebShell and Management GUIs\n\n             - JSP file browser - allows remote web-based file access and manipulation\nand deploys the Explosive RAT to the system.\n\n             - SharPyShell – an obfuscated ASP.NET WebShell that executes\n\ncommands received by an encrypted channel compiling them in\n\nmemory at runtime and deploys a privilege escalation tool.\n\n             - ASPXspy – provides control over a compromised web server.\n\n             - Adminer (formerly phpMinAdmin) – a full-featured database\n\nmanagement tool written in PHP.\n\n         - Iranian based WebShell\n\n             - ITsecTeam WebShell – a WebShell formerly used by the hacking group\nITsecTeam, embedded in Caterpillar 2.\n\n             - Mamad Warning Sheller – a WebShell used by the Persian Hacker\n\nhacktivist group, similar to Caterpillar but less functional.\n\n____________________________________________________________________________________________________\n\n**[www.clearskysec.com](http://www.clearskysec.com/)** **© All rights reserved to ClearSky Cyber Security ltd. 2021**\n\n\n-----\n\n`o` **Privilege escalation tools**\n\n    - RottenPotato – Local Privilege Escalation tool from Windows Service Accounts to\nSYSTEM.\n\n    - JuicyPotato - Local Privilege Escalation tool from a Windows Service Accounts to\n\nNT AUTHORITY\\SYSTEM.\n\n\n###### MITRE ATT&CK Categorization\n\n\nThe following is a table that presents the Lebanese Cedar APT TTP’s as observed in recent operations:\n\nKill Chain Phase Techniques, Tools, TTPs sub-Category MITRE ATT&CK Tool Origin\n\nand Procedures\n(TTPs)\n\nReconnaissance Vulnerability Censys Tactic: Technical Information Gathering SaaS,\nScanners / OSINT Shodan ID: TA0015 Legitimate\nTools ZoomEye Techniques: Determine 3rd party\n\ninfrastructure services\nID: T1260\nAcquire OSINT data sets and\ninformation.\nID: T1247\n\nWeb Hacking - URI DirBuster Tactic: Discovery Open Source\nBrute Force ID: TA0007\n\nTechnique: File and Directory Discovery\nID: T1083\n\nGoBuster Open Source\nDelivery & Exploit Atlassian Confluence Tactic: Initial Access  Exploitation vulnerabilities. Server CVE-2019-3396 ID: TA0001\n\n(1 day) Atlassian Jira Server Technique: Exploit Public-Facing              \nor Data Center Application\nCVE-2019-11581 ID: T1190\n\nTactic: Collection\n\nOracle 10g 11.1.2.0 ID: TA0009\nCVE-2012-3152 Technique: Data from Information\n\nRepositories: Confluence\nID: T1213.001\n\nInstallation and WebShell ASPXSpy ID: TA0003 Open Source\nC&C Caterpillar Technique: Persistence ASPXspy\n\nServer Software Component: WebShell Customizati\nID: T1505.003 on\n\nCaterpillar OPERATE\nmodules\n\nCaterpillar\nGO TO\nmodules\n\nCaterpillar DATABASE\nmodules\nCaterpillar TOOL\nmodules\nCaterpillar ITSecTeam Contains\nmodule Iranian\n\n____________________________________________________________________________________________________\n\n**[www.clearskysec.com](http://www.clearskysec.com/)** **© All rights reserved to ClearSky Cyber Security ltd. 2021**\n\n|Kill Chain Phase|Techniques, Tools, and Procedures (TTPs)|TTPs sub-Category|MITRE ATT&CK|Tool Origin|\n|---|---|---|---|---|\n|Reconnaissance|Vulnerability Scanners / OSINT Tools|Censys Shodan ZoomEye|Tactic: Technical Information Gathering ID: TA0015 Techniques: Determine 3rd party infrastructure services ID: T1260 Acquire OSINT data sets and information. ID: T1247|SaaS, Legitimate|\n||Web Hacking - URI Brute Force|DirBuster|Tactic: Discovery ID: TA0007 Technique: File and Directory Discovery ID: T1083|Open Source|\n|||GoBuster||Open Source|\n|Delivery & Exploitation|Exploit vulnerabilities. (1 day)|Atlassian Confluence Server CVE-2019-3396|Tactic: Initial Access ID: TA0001 Technique: Exploit Public-Facing Application ID: T1190 Tactic: Collection ID: TA0009 Technique: Data from Information Repositories: Confluence ID: T1213.001|-|\n|||Atlassian Jira Server or Data Center CVE-2019-11581||-|\n|||Oracle 10g 11.1.2.0 CVE-2012-3152|||\n|Installation and C&C|WebShell|ASPXSpy|ID: TA0003 Technique: Persistence Server Software Component: WebShell ID: T1505.003|Open Source|\n|||Caterpillar||ASPXspy Customizati on|\n|||Caterpillar OPERATE modules|||\n|||Caterpillar GO TO modules|||\n|||Caterpillar DATABASE modules|||\n|||Caterpillar TOOL modules|||\n|||Caterpillar ITSecTeam module||Contains Iranian|\n\n\n-----\n\n|Col1|Col2|Col3|Col4|Hacktivist Modules|\n|---|---|---|---|---|\n|||Mamad Warning Sheller||Contains Iranian Hacktivist Modules|\n|||JSP file browser3||Open Source - modified|\n||Database Management Tool|Adminer|Tactic: Collection ID: TA0009 Technique: Data from Local System ID: T1005|Open Source, Legitimate|\n||Post-Exploitation Framework|SharPyShell|Tactics: Privilege Escalation ID: TA0004 Discovery ID: TA0007 Lateral Movement ID: TA0008|Open Source|\n||Remote Access Trojan (RAT)|Explosive|Tactic: Build Capabilities ID: TA0024 Technique: Remote Access Tool development ID: T1351 Fallback Channels ID: T1008|Custom|\n\n\n3 https://github.com/SvetlinZarev/jsp-file-browser/blob/master/Browser.jsp\n\n____________________________________________________________________________________________________\n\n**[www.clearskysec.com](http://www.clearskysec.com/)** **© All rights reserved to ClearSky Cyber Security ltd. 2021**\n\n\n-----\n\n###### Modus Operandi\n\nLebanese Cedar APT conducts their attack to reach a wide range of targets. We observed a highly selective\ntargeting process that points to extensive reconnaissance efforts. Knowing that the group scans public\nfacing web servers for known vulnerabilities, we deduce that Lebanese Cedar, like other attackers, uses\n\npublic tools such as Shodan, Censys and ZoomEye. We have no indication of active vulnerability scanning\n\nagainst our clients in this context. At the same time, the attackers utilize URI Brute Force tools such as\n\nGoBuster and DirBuster to identify open directories that could be used as a platform for WebShell injection.\n\nAt the exploitation stage, the attackers exploit vulnerabilities to gain access to the web server. Our research\nindicates a regular use of critical 1-day vulnerabilities based on the vulnerable versions of the services in\n\nthe compromised servers. These 1-day vulnerabilities include:\n\n  - Atlassian Confluence Server (CVE-2019-3396)\n\n  - Atlassian Jira Server or Data Center (CVE-2019-11581)\n\n  - Oracle 10g 11.1.2.0 (CVE-2012-3152)\n\nMoreover, we identified the same pattern in other Oracle Web Application 10g servers like 10.1.2.0.2\n\nversion. In these cases we cannot determine whether one-day vulnerabilities or web-hacking techniques\nwere used. We suppose that the likelihood that zero-day vulnerabilities were used is very low. We assess\nthat the adversary exploits a few different vulnerabilities in Oracle 10g servers, as can be presented from\nthe victims’ map.\n\nAt the injection stage, there are two main attacking vectors:\n\n  - ‘Caterpillar 2’ WebShell Installation\n\n  - JSP File Browser and deploying ‘Explosive RAT’\n\nActing as a focal point, the group usually attacks web servers via a custom WebShell, namely Caterpillar –\n\na variant of the open source WebShell ‘ASPXspy’. By using WebShell, the attackers leave their fingerprint\non the web server and the internal network, move laterally, and deploy additional tools. On each\n\ncompromised network the attacker installed one or more WebShell, supposedly to gain persistence and\n\ndiversify the use of similar tools. The attackers use the WebShell to communicate with their C&C server for\nrunning commands and exfiltrating sensitive information. Connection to the WebShell is made using\n\nNordVPN or ExpressVPN services.\n\nThe attacker installed a modified version of ‘test.jsp’ or ‘yup.jsp’ file browser on the servers of victims that\nhave Oracle web application 10g servers, mainly 10.1.2.0.2 or 11.1.2.0 versions. These file browsers allow\n\nthe group to deploy its custom RAT – Explosive. We assess that the attackers use both WebShell and RATs.\n\nIn our research, we found that Caterpillar 2.0 WebShell was used more often than the Explosive RAT.\n\nDeployment of the Explosive RAT provides the attackers with higher visibility and functionality at the\n\nendpoint level. The malware executes commands such as keylogging, screenshot capture and command\n\n____________________________________________________________________________________________________\n\n**[www.clearskysec.com](http://www.clearskysec.com/)** **© All rights reserved to ClearSky Cyber Security ltd. 2021**\n\n\n-----\n\nexecution. Explosive utilizes multiple evasion techniques to avoid detection and maintain persistence,\nsuch as obfuscation, communication encryption and using a separate DLL for API activity. Since 2015, the\ntool had been minorly changed in obfuscation and communication encryption. The RAT’s control network\nis well thought out. It consists of default hard-coded C&C servers, static update servers and DGA-based\n\ndynamic update servers.\n\n\n###### Installation & C&C\n\n\nThe primary attack vector utilized by the Lebanese Cedar group is taking over a target organization’s\nvulnerable web server by exploiting a security flaw, followed by a WebShell installation. Once the WebShell\nis installed, the attacker establishes a connection over HTTP using compromised credentials and activates\nthe WebShell modules via a visual GUI.\n\nEach of the WebShell modules has several key functions, primarily designed to obtain escalated privileges\n\n(LPE), and perform a variety of espionage functions, such as file password theft within the target network.\nThe WebShell is a key component of the attack process - it replaces the need for installing a RAT in the\n\ncompromised machine. The WebShell is used to execute remote commands within the target network and\n\nescalate privileges. However, in some cases a RAT (Remote Access Tool) and an LPE tool (Local Privilege\n\nEscalation) had been observed in the victims’ network in addition to the WebShell.\n\nThe WebShell we observed can be divided into three categories:\n\n1. Custom-made WebShell\n\n2. Existing WebShell\n\n3. Open-source WebShell\n\n____________________________________________________________________________________________________\n\n**[www.clearskysec.com](http://www.clearskysec.com/)** **© All rights reserved to ClearSky Cyber Security ltd. 2021**\n\n\n-----\n\nWe estimate that the primary WebShell utilized by the Lebanese Cedar APT is “Caterpillar” V2. In some\ncases, when extensive operations within the target network are required, the attackers use Yup.jsp to\ninstall a RAT for remote activities. Other WebShells are used mainly to assure persistency and redundancy.\n\nSome of the WebShells we traced contain code snippets associated with tools used by Iranian hacktivist\n\ngroups such as “Iranian Hacker”[4] and “ITSecTeam”. While we are unable to determine the nature of the\n\nrelationship between these groups and the Lebanese Cedar APT, we find it important to highlight this\n\nconnection, as it may point to a connection between the APT, which is associated with Hezbollah, and the\n\nIranian regime.\n\n###### Customized WebShell – \"Caterpillar\" 2.0\n\nAs previously indicated, Caterpillar Shell 2.0 by N.T is the main WebShell in the Lebanese Cedar APT attack\ninfrastructure. It is a WebShell written in Visual Basic. First observed in 2015, the WebShell is used to carry\n\nout various espionage operations over the attacked web server, including potential asset location for\nfurther attacks, file installation server configuration and more.\n\nAccording to our findings, the group currently uses the WebShell’s second version, which is characterized\nby the ASPX file type, unlike the first version, that used both ASPX and ASP file types. The WebShell can be\n\nfound within the target file by its original name ‘Caterpillar.aspx’ or alternatively, less prominent names\nsuch as 405.aspx, resume.aspx and more.\n\nScreenshot from an exposed WebShell found in a Saudi website, showing the connection to “Caterpillar”\n\nWhile accessing the WebShell, the attackers are prompted to type a designated user and password, usually\n\nembedded within the source code of the file as an md5 hash. In many cases, duplicate user and password\nwere observed.\n\nScreenshot from the GUI of Caterpillar WebShell\n\n4 BAX26\n\n____________________________________________________________________________________________________\n\n**[www.clearskysec.com](http://www.clearskysec.com/)** **© All rights reserved to ClearSky Cyber Security ltd. 2021**\n\n\n-----\n\nAs can be seen above, the management panel of the WebShell is divided into four module groups:\n\n  - Operate – modules that run on the compromised server, such as file download and upload, file\nsearch and more. These modules are used to install further malware or attack tools for privilege\nescalation. Among these modules is “RottenPotato”.\n\n  - Go To – modules used to select the desired hard drive among those installed on the compromised\nserver.\n\n  - Database - two modules used to control datasets; only one of them is currently functional.\n\n  - Tool – the broadest module group, that enables the attackers to characterize the current\n\nworkspace and perform actions for lateral movement, command execution and more.\n\nEach WebShell module has several properties. First, the technical properties – the module’s form ID, the\nhttp request (GET/POST) used by the attackers to communicate with the server in every command, and\nthe designated parameters of the desired URI. Then, verbal instructions will be displayed. The instructions\ncontain explanations about the module and the parameters the attacker must fill in order to execute\ncommands, or in some cases attacks. Our research of the “Caterpillar” WebShell, uncovered modules that\nwere fully copied from other sources. These modules were attached a note such as “This function has fixed\n\nby Tatra has not detected” as well as a date, in this case, from 2009. These notes enabled ClearSky\nresearchers to identify the names of three developers involved in writing the tools used by the Lebanese\nCedar APT - Nido, Zero Lord and Tatra.\n\nIn the following chapter, we present a review of the module groups, including a description of the modules\nand a summary of the parameters of each of them.\n\nOPERATE Modules\n\nOperate is a module group used to perform various espionage functionalities such as file creation, file\ndownload and upload, file search in selected hard drives (Chosen via the ‘Go To’ module group) and file\n\ndownload from external links.\n\nScreenshot from the Operate module group\n\nScreenshot showing a file download process from an external link, such as an embedded website\n\n**GUI Input parameter** **Webshell Module Description** **Action (URI)** **HTTP** **Form ID (Webshell Module)**\n\n**Request**\n\n - Creating new file or directory ?action=new POST New\n\n____________________________________________________________________________________________________\n\n**[www.clearskysec.com](http://www.clearskysec.com/)** **© All rights reserved to ClearSky Cyber Security ltd. 2021**\n\n|GUI Input parameter|Webshell Module Description|Action (URI)|HTTP Request|Form ID (Webshell Module)|\n|---|---|---|---|---|\n|-|Creating new file or directory|?action=new|POST|New|\n\n\n-----\n\n|File|Upload file from hacker’s computer to the directory|?action=upfile|POST|UpLoadFile|\n|---|---|---|---|---|\n|Paste information to the directory|?action=paste|POST|Paste|Paste|\n|Search term (String)|Search File in the directory|?action=search|POST|Search|\n|A link to a file on a server|Download file from the directory|?action=goto|GET|DownloadfileRemote|\n|-|Go to a file's directory||POST|GoBackDir|\n|-|Go to Document and Settings folder||POST|Documents and Settings|\n|-|Go to Temp folder||POST|Temp|\n\n\nDATABASE Modules\n\nThe Database module group is responsible for the management of datasets on the server infected with the\nWebShell, or alternatively, datasets accessible via the WebShell.\n\nScreenshot from the Data Base module group\n\n**Input parameter** **WebShell Command** **Action (URI)** **Method** **Form ID**\n\n**Description** **(WebShell Module)**\n\nServer Name (IP) Connect to a Database ?action=DbManager GET Dbase Manager\nDatabase Name server\n\nUsername\n\nPassword\n\nPage size\n\nAction\n\nConnection\nString\n\nRead database ?action=ReadDbMana POST Read DB Manager\n\nger\n\nUser list (embedded in Connect to a SQL server ?action=DbEnumerate GET User SQL Enum Login\n\nthe code) from a user list Login\n\nTOOL Modules\n\nThe Tool module group is responsible for executing commands over the compromised server, selected by\n\nthe attackers to gain persistent access to the server and the organizational network, perform\n\nreconnaissance activities and execute modules related to gaining control over the network. This module\n\ngroup contains functions similar to those of a RAT (Remote Access Tool).\n\nScreenshot from the Tool module group\n\nIt is the broadest module group, containing 25 modules divided into the following categories:\n\n____________________________________________________________________________________________________\n\n**[www.clearskysec.com](http://www.clearskysec.com/)** **© All rights reserved to ClearSky Cyber Security ltd. 2021**\n\n|Input parameter|WebShell Command Description|Action (URI)|Method|Form ID (WebShell Module)|\n|---|---|---|---|---|\n|Server Name (IP) Database Name Username Password Page size Action Connection String|Connect to a Database server|?action=DbManager|GET|Dbase Manager|\n||Read database|?action=ReadDbMana ger|POST|Read DB Manager|\n|User list (embedded in the code)|Connect to a SQL server from a user list|?action=DbEnumerate Login|GET|User SQL Enum Login|\n\n\n-----\n\n1. Server & Network Fingerprinting  - Modules used to obtain information about the compromised\n\nserver and network.\n\n2. Rootkit and server command execution modules - Modules used to perform a variety of actions\n\nover the network servers\n\n3. Network Shell creation - Modules feature the Shell Connection module, meant to enable attacker\n\nto create a Network Shell\n\n4. Network server’s brute forcing – Modules used to preform brute force attack against a verity of\n\nusers and servers over the network\n\n**Input Parameter** **WebShell Command** **Action (URI)** **HTTP** **Form ID (WebShell**\n\n**Description** **Request** **Module)**\n\nServer & Network Fingerprinting\n\nUsername General information ?action=information GET System info\n\nPassword about the\n\ncompromised asset\nincludes computer\n\nversion, computer\n\nname, IIS version, IP\n\naddress and more\n\n    - List of Processes ?action=pro GET List Processes\n\n    - List of Services ?action=srv GET List Services\n\n    - List of User Accounts ?action=user GET List user accounts\n\nPort List Port Scanner ?action=PortScan GET PORT Scan\n\nIP Address\n\n    - Logs of running ?action=applog GET Application Event Log\napplication\n\n    - System Log ?action=syslog GET System Log\n\n    - ?action=auser GET IIS List Anonymous\n\n    - ?action=iisspy GET IIS Spy\n\n    - Ip Config ?action=ipconfig GET Ip Config\n\n    - List of Local Group of ?action=localgroup GET Local Group\n\nusers\n\n    - User home directory ?action=homedirectory GET User Home Directory\n\naccounts detection\n\nIP HTTP Fingerprint ?action=HttpFinger GET Http Finger\n\ndetection\n\n    - Scanning sub-net ?action=GetNTPC GET GetNetworkComputers\n\nassets\n\nFTP Server IP Change the label of an ?action=FtpSwitch GET Ftp Switch\nUsername FTP server\n\nPassword\n\nFTP root\n\nRootkit and Server Command Execution Modules\n\n____________________________________________________________________________________________________\n\n**[www.clearskysec.com](http://www.clearskysec.com/)** **© All rights reserved to ClearSky Cyber Security ltd. 2021**\n\n|Input Parameter|WebShell Command Description|Action (URI)|HTTP Request|Form ID (WebShell Module)|\n|---|---|---|---|---|\n|Server & Network Fingerprinting|||||\n|Username Password|General information about the compromised asset includes computer version, computer name, IIS version, IP address and more|?action=information|GET|System info|\n|-|List of Processes|?action=pro|GET|List Processes|\n|-|List of Services|?action=srv|GET|List Services|\n|-|List of User Accounts|?action=user|GET|List user accounts|\n|Port List IP Address|Port Scanner|?action=PortScan|GET|PORT Scan|\n|-|Logs of running application|?action=applog|GET|Application Event Log|\n|-|System Log|?action=syslog|GET|System Log|\n|-||?action=auser|GET|IIS List Anonymous|\n|-||?action=iisspy|GET|IIS Spy|\n|-|Ip Config|?action=ipconfig|GET|Ip Config|\n|-|List of Local Group of users|?action=localgroup|GET|Local Group|\n|-|User home directory accounts detection|?action=homedirectory|GET|User Home Directory|\n|IP|HTTP Fingerprint detection|?action=HttpFinger|GET|Http Finger|\n|-|Scanning sub-net assets|?action=GetNTPC|GET|GetNetworkComputers|\n|FTP Server IP Username Password FTP root|Change the label of an FTP server|?action=FtpSwitch|GET|Ftp Switch|\n|Rootkit and Server Command Execution Modules|||||\n\n\n-----\n\n|Input Parameter|WebShell Command Description|Action (URI)|HTTP Request|Form ID (WebShell Module)|\n|---|---|---|---|---|\n|Username Password Host Command|Run commands in SQL Server (local/remote)|?action=sqlrootkit|POST|SqlRootKit|\n|Username Password Host Command WMI classes|Run commands on remote server|?action=adminrk|POST|AdminRootKit|\n|Command|Run commands on the compromised asset with CMD functions|CMD ?action=cmd CMD.W32 ?action=cmdw32 CMD.WSH ?action=cmdwsh CMD.WMI ?action=cmdwmi|POST|CMD*|\n|Command line|Change Registry Key|?action=regshell|POST|Registry Shell|\n|Rework file or Dir Copied Filed or Dir|Copy files to another directory|?action=clonetime|POST|Clone Time|\n|Network Shell Creation|||||\n|-|-|?action=RvConnect|-|Shell Connection|\n|BruteForce|||||\n|Multiple – Open Source based|Brute Force on a user on server|?action=UserEnumLogin|Post|User Enum Login|\n|Multiple – Open Source based|Brute Force on an FTP server|?action=FtpBrute|Post|FTP Brute|\n|Multiple – Open Source based|Brute Force on an POP3 server|?action=POP3Brute|Post|POP3 Brute|\n\n\n###### WebShell Containing Modules Taken from Iranian Hacktivist Groups\n\n\"Caterpillar\" variant - ITSecTeam Module\n\nOne of the WebShells we found in our research is a variant of the “Caterpillar” WebShell that contains an\n\nadditional module, taken from a WebShell developed by the known Iranian hacktivist group ‘ITSecTeam’.\n\nThe module, named ‘ITSecTeam.WS’, is used by the Lebanese Cedar APT to deploy additional tools,\n\nincluding the ‘Explosive’ RAT.\n\nAs mentioned above, the code snippet belongs to ‘ITSecTeam’ - a group associated with the IRGC (Iranian\nRevolutionary Guard Corps). The signature reveals that the code was written by an individual called ‘Amin\n\nShokoni’, a member of the group. The group gained publicity from reports published by the United States\nDepartment of Justice – according to those, members of the group were convicted for conducting DDoS\n\nattacks against United States financial sector institutions between 2011-2013.\n\n____________________________________________________________________________________________________\n\n**[www.clearskysec.com](http://www.clearskysec.com/)** **© All rights reserved to ClearSky Cyber Security ltd. 2021**\n\n\n-----\n\nThese WebShells point at the timestamp 07/07/2014. Please note that the date on the timestamp is\nhardcoded into the original code of the Caterpillar WebShell, as well as a specific URL.\n\nScreenshot from the ‘ITSecTeam’ module\n\nWe cannot determine why this code snippet had been embedded into the WebShell, and whether it was\n\nprovided to Lebanese Cedar APT by ITSecTeam or obtained unknowingly.\n\n“Mamad Warning Sheller” WebShell\n\nDuring a response to a recent Incident, ClearSky researchers detected an ASPX file called ‘Pars.aspx’. An\nin-depth analysis of the file revealed that it is a WebShell developed by a hacker dubbed ‘Mamad Warning’.\nThe WebShell name provides a basis for our assumption that the hacker is a member of the Iranian\nhacktivist group ‘Persian Hacker’ or ‘Iranian Hacker’, also dubbed ‘Pars’. This hacker has been actively\ndefacing Middle East websites, often government owned.\n\nIn September 2020, the United States Justice Department Indicted two hackers that are part of the group,\nfor defacing websites world-wide with pro-Iranian messages, such as promoting Ghasem Soleimani’s\nphoto. The first hacker is Mrb3hz4d from Iran, and the second is Mrwn007, allegedly a stateless national of\n\nthe Palestinian Authority. Mamad himself was not indicted by the Justice Department, and we do not know\n\nif his origin is Iran, the Palestinian Authority or Lebanon. Unlike the other two hackers, Mamad is still active\n\nin ‘Iranian Hackers’, which also goes by the handle ‘Bax 026’[5].\n\n###### The WebShell features three key modules:\n\n  - BindShell – The module is almost identical to the ‘Shell Connection’ module of the “Caterpillar”\n\nWebShell, which had been reviewed in detail above.\n\n  - Replicate – The module enables an attacker to create a new folder within the WebShell.\n\n5 https://www.justice.gov/opa/pr/two-alleged-hackers-charged-defacing-websites-following-killing-qasemsoleimani\n\n____________________________________________________________________________________________________\n\n**[www.clearskysec.com](http://www.clearskysec.com/)** **© All rights reserved to ClearSky Cyber Security ltd. 2021**\n\n\n-----\n\n###### • Upload – The module enables an attacker to download files from their own machine or from a\n\nselected URL.\n\n\n###### Open-Source WebShell Obtained Online\n\n\nDuring our investigation, we found two open-source WebShell used by the attackers for various purposes.\n\nThe first WebShell is called “ASPXSpy”. According to Check Point, this WebShell is the basis of the custom\n\n“Caterpillar” WebShell. The second WebShell we tracked is called “SharPyShell”. This WebShell enables\n\nthe attackers to download a ‘Juicy Potato’ file to the compromised machine so as to obtain extended\nprivileges.\n\nFurther information about the “ASPXSpy” WebShell can be found in the hackingscripts[ 1] website. Further\ninformation about the “SharPyShell” WebShell can be found on GitHub[2].\n\n###### Open-Source Management Panels\n\nWe found two management web panels on the networks that we investigated, that allow the attackers to\nperform varied operations on the compromised servers and are not WebShell like those previously\ndiscussed in our report.\n\nAdminer\n\nAdminer is a web-based database management panel, capable of managing the following data sources SimpleDB, Firebird, Oracle, MySQL, SQLite, PostgreSQL, MariaDB, MS SQL, Elasticsearch and MongoDB[3].\n\nJSPFile Browser\n\nThe modified JSP file browser, mainly named test.jsp or yup.jsp is a variant of the management panel open\n\nsource based JSP File Browser[6]. The system allows its users, in our case the attackers, web-based access\n\nand manipulation of files stored on a remote server, including uploading, copying, shifting, and even\ndeleting files. The system also provides the ability to download new files to the server – in this case, the\n\n‘Explosive’ RAT. The panel is the installed in 2 different paths, which helped us to identify these JSP files in\nthe wild.\n\nThe panel was found in GitHub, however, a code comparison between the tool found on the compromised\n\nserver and the GitHub code revealed that the attackers have added an additional function to the system \nCheckConUrl, which performs a file transfer over HTTP. We cannot determine if Lebanese Cedar created\n\nthis function, however, we did not identify any other usage of this function that was not attributed to this\n\nAPT. Therefore, we estimate that this file browser was edited by the group. Based on this edition, we were\n\nable to identify more servers world-wide that were attacked by the adversary. ‘test.jsp/yup.jsp’ is first\n\ninjected to the compromised public-facing web server, and then used to deploy the ‘Explosive’ RAT.\n\n6 http://www.vonloesch.de/filebrowser.html\n\n____________________________________________________________________________________________________\n\n**[www.clearskysec.com](http://www.clearskysec.com/)** **© All rights reserved to ClearSky Cyber Security ltd. 2021**\n\n\n-----\n\nThe code snippet of the new function added by the attackers to the system\n\n\n###### The \"Explosive\" Custom RAT\n\n\n‘Explosive’ is a RAT (Remote Access Tool) first revealed in 2015 by Check Point, in a report reviewing the\nactivities of the Lebanese Cedar APT, referred to in the report is ‘Volatile Cedar’. The campaign probably\n\nbegan in late 2012, targeting carefully chosen individuals, companies, and state institutions worldwide,\n\nusing a range of attack techniques, that revolve around the group’s custom-designed malware, Explosive.\n\nExplosive is implanted on the target server – a public facing web server - by the JSP file (WebShell) as the\n\ninitial point of access to the target network and used to gather information.\n\nThe malware’s data collection capabilities are both passive and active – it harvests data found on the\n\ncompromised machine and features the ability to search for data on-demand. Explosive runs a keylogger\n\non the compromised machine as of its installation and sends the data to the attackers via a C&C server. Its\n\ninfrastructure includes both static and dynamic C&C servers. It also has multiple stealth and detection\nevasion capabilities – including a self-destruct mechanism - that can be activated upon command by its\n\noperators. Explosive also features functionalities such as machine fingerprinting, memory usage\n\nmonitoring to assure stealth, remote shell, and arbitrary code execution.\n\n____________________________________________________________________________________________________\n\n**[www.clearskysec.com](http://www.clearskysec.com/)** **© All rights reserved to ClearSky Cyber Security ltd. 2021**\n\n\n-----\n\nDuring our analysis, we identified only a few changes between the 2015 version of Explosive RAT and its\ncurrent version. We identified three major changes: Anti-debugging methods, 2 new modules and\nencrypted communication between the compromised machine to the C2.\n\n###### Anti-Debugging\n\nThe major add-on of the new version is the presence of multiple anti-debugging methods, part of which,\n\nare operating as a never-ending thread. First, Explosive will check the window name of each process. The\n\nRAT will search for a few debuggers, such as Immunity, Ollydebug and Phantom (We did not identify any\nsearch for IDA pro). Then, Explosive will run the function “IsdebuggerPresent” and will check for flags in the\n\nProcess Environment Block.\n\n###### New Modules\n\nIn our analysis, we were able to identify two new modules.\n\n1. NTCommand – Run a function named ReadSocket in the DLL module. Read.socket is a function\n\nthat reads a string from the specified socket.\n\n2. RenF – Rename file in the system.\n\n###### Communication with C2 over SSL\n\nIn CheckPoint’s report from 2015, they identify two communications methods: Communication over HTTP\n(Port 80) to a dynamic C&C server update server, and communication with a static update server. Moreover,\nthe identified using of RAW TCP for communication with the C&C server. The URL and IP addresses were\n\nhard-coded stings in the explosive file.\n\nIn our analysis, we found a new method – communication over HTTPS (Port 443). The data is encrypted\nwith RC4 method. Similar to the original methods, the RC4 decryption key is a hard-coded string as well.\n\nFurther information about the malware can be found in the CheckPoint’s technical [report.](https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2015/03/20082004/volatile-cedar-technical-report.pdf)\n\n____________________________________________________________________________________________________\n\n**[www.clearskysec.com](http://www.clearskysec.com/)** **© All rights reserved to ClearSky Cyber Security ltd. 2021**\n\n\n-----\n\n##### Attribution \n\nLebanese Cedar APT is a stealth threat actor, which is active for more than 8 years. In this report, we\nuncover the updated malicious activity of this threat actor in Israel and other countries world-wide. As\npresented in the map on the executive summary, Lebanese Cedar operates under the radar for more than\n\n5 years, since the last report that covered their operation.\n\nWe attributed the operation to Lebanese Cedar (also known as Volatile Cedar), mainly based on the code\n\noverlaps between the 2015 variants of Explosive RAT and Caterpillar WebShell, to the 2020 variants of these\n\nmalicious files. We identified a high degree of similarity between the RAT we identified to the original\n\nExplosive RAT. On Intezer for example, 11 genes were identified as Explosive and 6 as Cedar. Examining the\nunique strings presents even greater similarity. For example, in 2015 Lebanese Cedar encoded their\ncommunication with the C2 server in 3 stages: Reverse the text of the domain, Encode the domain with\nBase64 and then reverse the text again. In our analysis, we identified the same method, used to encode\nboth communication’s strings and functions.\n\nAn example for the encoded string in Explosive RAT 2020 variant\n\nWe identified multiple strings, starting with the word “Exploiter”, two equals signs and then a text:\n\nExploiter==APqoSRuRGVhN3aqoiP\n\nReversing the text revealed a decodable base64 code:\n\nPioqa3NhVGRuRSoqPA==\n\nDecoding the text returned letters, which were needed to reverse again (>**ksaTdnE**<). In the end of the\nprocess, the function “EndTask” will be presented.\n\nThe second code overlaps are between the 2015 Volatile Cedar WebShell and the Caterpillar 2 WebShell.\n\nThis WebShell is an updated version of CaterPillar.asp, the WebShell that was exposed in recent campaign.\n\nThe code itself is similar, however, it indicates more maturity in the code-writing techniques and more\n\nfunctionality for the WebShell.\n\nThe TTP itself was changed. In 2015, Lebanese Cedar relied mostly on Explosive RAT as their main tool. In\nthe recent campaign, we identified multiple Caterpillar WebShells and less utilization of Explosive RAT\n\n(based on our scans). Accordingly, we propose that the main vector of Lebanese Cedar in 2020 is utilization\nof WebShell.\n\n____________________________________________________________________________________________________\n\n**[www.clearskysec.com](http://www.clearskysec.com/)** **© All rights reserved to ClearSky Cyber Security ltd. 2021**\n\n\n-----\n\n____________________________________________________________________________________________________\n\n**[www.clearskysec.com](http://www.clearskysec.com/)** **© All rights reserved to ClearSky Cyber Security ltd. 2021**\n\n\n-----\n\n##### Summary and Insights\n\nLebanese Cedar APT has been orchestrating sophisticated, well-designed attacks using custom-made\nattack tools since 2012, often with no disruptions by the global security community for long consecutive\nperiods of time. The group’s ability to remain under the radar is not coincidental – it is the result of a clever\n\nselection of targets, tools, and attack vectors. Previous research of this APT attributed the group to a\n\nLebanese threat actor (In some reports about the group, they were attributed particularly to the Hezbollah\n\nCyber Unit[7]). The targets of Lebanese Cedar are from multiple sectors and spread globally.\n\nLebanese Cedar APT uses vulnerable public-facing web servers as their initial attack vector. After gaining\n\naccess to the server using 1-day vulnerabilities, extensive reconnaissance of the target is carried out using\na variety of tools. Their WebShell 's are also used by the group to gain persistency and to evade detection.\n\nMany of the tools in Lebanese Cedar APT’s arsenal are open source, however, the group relies mainly on\ntwo prominent tools that are custom-made. These tools include:\n\n  - “Caterpillar” WebShell, used to collect system and network information, locate assets within the\nnetwork and install additional files.\n\n  - “Explosive” RAT which used to harvest sensitive information of multiple types.\n\nOur research of Caterpillar WebShell revealed that the tool contains a code snippet taken from a WebShell\nassociated to the infamous Iranian hacking group ‘ITSecTeam’. Another WebShell utilized by the group\nwas most likely developed by another Iranian hacking group dubbed ‘Persian Hacker’.\n\nClearSky’s research reveals that the group had been active recently, using a 4[th] version of the Explosive RAT\nand a 2[nd] version of the Caterpillar WebShell. Scanning the web for vulnerable public-facing web servers\nand analyzing the results based on our research of the group’s patterns revealed more victims.\n\nServers likely compromised by the group were detected mainly in Europe, but also in the United Arab\n\nEmirates, Egypt, Saudi Arabia and more.\n\n7 https://www.inss.org.il/he/wpcontent/uploads/sites/2/systemfiles/Cyberattack%20tied%20to%20Hezbollah%20ups%20the%20ante%20for%20Israel's%20di\ngital%20defenses%20-%20Citing%20Daniel%20Cohen%20in%20The%20Christian%20Science%20Monitor.pdf\n\n____________________________________________________________________________________________________\n\n**[www.clearskysec.com](http://www.clearskysec.com/)** **© All rights reserved to ClearSky Cyber Security ltd. 2021**\n\n\n-----\n\n##### Indicators of Compromise\n\n\n###### Hashes\n\n|MD5|File Name|Type|\n|---|---|---|\n|WebShell|||\n|33AF1CD4585DA9ED804068B2A45FC8B4|404.aspx|Caterpillar 2|\n|6BA944E9D3D96A46509204CD06EA2B11|405.aspx|Caterpillar 2|\n|61F46FA93083D3A160AC8356FBC15722|-|Caterpillar 2 + ITSecTeam|\n|150DC0141B8A0010BB5A82419B3293EB|-|ASPXSpy|\n|7D58573B98597A010597423652AE3394|-|ASPXSpy|\n|F30F2184ED83929CF96157BC91210DAA|Mamad.aspx|Mamad Warning|\n|8ED3D1CADC4C2251EC606B9D6EB5D272|-|Caterpillar 2|\n|2D804386DE4073BAD642DFC816876D08|-|Caterpillar 2|\n|2ADF71947E977B85E269D5962243215C|-|SharPyShell|\n|93448B89C592985E22F60AB0D654787D|CV.php|Adminer|\n|2D804386DE4073BAD642DFC816876D08|-|File Browser JSP|\n|39887492C5C70977C0C0CF0AA0E7154B|test.jsp|File Browser JSP|\n|Explosive RAT|||\n|a97fdcb6493c2012aeebdeef0e09625a|Communicate.DLL|dll|\n|1316d35f6472eb323ae2c8b75199fbb5|spmpm.dll syslib.tmp|dll|\n|09a0970bfc1bc8acec1ec609d8d98fda|Mir.exe|exe|\n|fef76a8027e07c7a51b312a26c488653|dzip|exe|\n|902bcc27ed86bc623e20532239895da7|917951-f2030832.dll|dll|\n|8ac64a171736252b81c4a559df1f9bae|-||\n|65954b4c60031fb857a09761497ff641|rspr||\n|4147d6beb17b507a5df345dae5f15c41|symlock||\n|544fdcce998fc7f4bb2914b3ec5b4761|symlock||\n|1aebf9d07fe6e82d97e062cdbe656a36|vvzip||\n|5d1f75bfc7cbd96891f26b1041fd5994|vvzip||\n|b54346cdaf9556eb88f3d95e0bad2be5|vvzip||\n|1aebf9d07fe6e82d97e062cdbe656a36|vwupd.tmp||\n|e9f0260409c6c964985fa4df926d7e04|wsinhelpd||\n|3188df195d09ee38d89707501e330c2f|dllhost.exe wvwupd.exe|exe|\n\n\nHere are some of the original servers used by the hackers which we identified in our comprehensive\n\nresearch:\n\n68.65.122[.]109  74.208.73[.]149 191.101.5[.]183 198.101.242[.]72  169.50.13[.]61\n\n____________________________________________________________________________________________________\n\n**[www.clearskysec.com](http://www.clearskysec.com/)** **© All rights reserved to ClearSky Cyber Security ltd. 2021**\n\n\n-----\n\n# Lebanese Cedar APT\n\n##### Global Campaign Leveraging\n\n Public Facing Web Servers\n\n(C) all rights reserved to ClearSky Cyber Security 2021\n\nTLP:White\n\n____________________________________________________________________________________________________\n\n**[www.clearskysec.com](http://www.clearskysec.com/)** **© All rights reserved to ClearSky Cyber Security ltd. 2021**\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "99fdc3ef-333d-48f5-a4a1-becd788c7b80",
            "created_at": "2022-10-25T15:28:29.802983Z",
            "updated_at": "2022-10-25T15:28:29.802983Z",
            "deleted_at": null,
            "name": "MITRE",
            "url": "https://github.com/mitre-attack/attack-stix-data",
            "description": "MITRE ATT&CK STIX Data",
            "reports": null
        },
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        },
        {
            "id": "6fc23d14-23a6-4870-8fad-b291b182596f",
            "created_at": "2022-10-25T16:07:18.480113Z",
            "updated_at": "2022-10-25T16:07:18.480113Z",
            "deleted_at": null,
            "name": "ETDA",
            "url": "https://apt.etda.or.th",
            "description": "Threat Group Cards: A Threat Actor Encyclopedia",
            "reports": null
        },
        {
            "id": "bf5be533-fa31-4590-ae37-5761c97ffa34",
            "created_at": "2022-10-25T16:13:58.389257Z",
            "updated_at": "2022-10-25T16:13:58.389257Z",
            "deleted_at": null,
            "name": "Malpedia",
            "url": "https://malpedia.caad.fkie.fraunhofer.de",
            "description": "Malpedia is a free service offered by Fraunhofer FKIE",
            "reports": null
        },
        {
            "id": "5910e58f-4bc9-4e4e-9dbb-887804094a01",
            "created_at": "2022-10-25T16:32:58.457399Z",
            "updated_at": "2022-10-25T16:32:58.457399Z",
            "deleted_at": null,
            "name": "OTX",
            "url": "https://otx.alienvault.com",
            "description": "Alienvault Open Threat Exchange (OTX)",
            "reports": null
        },
        {
            "id": "6825b8cb-7d82-43d2-b0b0-d51c7e255b42",
            "created_at": "2023-01-06T13:46:37.642134Z",
            "updated_at": "2023-01-06T13:46:37.642134Z",
            "deleted_at": null,
            "name": "MISPGALAXY",
            "url": "https://www.misp-project.org/galaxy.html",
            "description": "MISP Galaxy Clusters",
            "reports": null
        }
    ],
    "references": [
        "https://www.clearskysec.com/wp-content/uploads/2021/01/Lebanese-Cedar-APT.pdf",
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2021/2021.01.28.Lebanese_Cedar_APT/Lebanese-Cedar-APT.pdf"
    ],
    "report_names": [
        "Lebanese-Cedar-APT.pdf",
        "Lebanese-Cedar-APT"
    ],
    "threat_actors": [
        {
            "id": "42a6a29d-6b98-4fd6-a742-a45a0306c7b0",
            "created_at": "2022-10-25T15:50:23.710403Z",
            "updated_at": "2025-03-27T02:00:55.531313Z",
            "deleted_at": null,
            "main_name": "Silence",
            "aliases": [
                "Whisper Spider"
            ],
            "source_name": "MITRE:Silence",
            "tools": [
                "Winexe",
                "SDelete"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "88e53203-891a-46f8-9ced-81d874a271c4",
            "created_at": "2022-10-25T16:07:24.191982Z",
            "updated_at": "2025-03-27T02:02:10.13692Z",
            "deleted_at": null,
            "main_name": "Silence",
            "aliases": [
                "ATK 86",
                "Contract Crew",
                "TAG-CR8",
                "TEMP.TruthTeller",
                "Whisper Spider"
            ],
            "source_name": "ETDA:Silence",
            "tools": [
                "EDA",
                "EmpireDNSAgent",
                "Farse",
                "Ivoke",
                "Kikothac",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "Meterpreter",
                "ProxyBot",
                "ReconModule",
                "Silence.Downloader",
                "TiniMet",
                "TinyMet",
                "TrueBot",
                "xfs-disp.exe"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "5e7c75c6-097f-4d80-8c98-73485fe2a729",
            "created_at": "2022-10-25T16:07:24.386715Z",
            "updated_at": "2025-03-27T02:02:10.203847Z",
            "deleted_at": null,
            "main_name": "Volatile Cedar",
            "aliases": [
                "Dancing Salome",
                "DeftTorero"
            ],
            "source_name": "ETDA:Volatile Cedar",
            "tools": [
                "ASPXSpy",
                "ASPXTool",
                "Adminer",
                "DirBuster",
                "GoBuster",
                "JuicyPotato",
                "RottenPotato",
                "SharPyShell"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "9663cdbf-646e-4579-881a-a8ebc3aabf63",
            "created_at": "2023-01-06T13:46:38.360862Z",
            "updated_at": "2025-03-27T02:00:02.814167Z",
            "deleted_at": null,
            "main_name": "Cutting Kitten",
            "aliases": [
                "ITsecTeam"
            ],
            "source_name": "MISPGALAXY:Cutting Kitten",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "2864e40a-f233-4618-ac61-b03760a41cbb",
            "created_at": "2023-12-01T02:02:34.272108Z",
            "updated_at": "2025-03-27T02:02:10.209072Z",
            "deleted_at": null,
            "main_name": "WildCard",
            "aliases": [],
            "source_name": "ETDA:WildCard",
            "tools": [
                "RustDown",
                "SysJoker"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "bc5c22a8-29eb-4a87-acd6-4817060e80f2",
            "created_at": "2022-10-25T15:50:23.658256Z",
            "updated_at": "2025-03-27T02:00:55.514297Z",
            "deleted_at": null,
            "main_name": "Volatile Cedar",
            "aliases": [
                "Volatile Cedar",
                "Lebanese Cedar"
            ],
            "source_name": "MITRE:Volatile Cedar",
            "tools": [
                "Caterpillar WebShell"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "17b152bc-6f7e-463c-8b4c-a4844caea6df",
            "created_at": "2023-01-06T13:46:38.498795Z",
            "updated_at": "2025-03-27T02:00:02.849085Z",
            "deleted_at": null,
            "main_name": "Volatile Cedar",
            "aliases": [
                "Lebanese Cedar",
                "DeftTorero"
            ],
            "source_name": "MISPGALAXY:Volatile Cedar",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "256a6a2d-e8a2-4497-b399-628a7fad4b3e",
            "created_at": "2023-11-30T02:00:07.299845Z",
            "updated_at": "2025-03-27T02:00:03.257794Z",
            "deleted_at": null,
            "main_name": "WildCard",
            "aliases": [],
            "source_name": "MISPGALAXY:WildCard",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1666716496,
    "ts_updated_at": 1743041799,
    "ts_creation_date": 1611848741,
    "ts_modification_date": 1611848741,
    "files": {
        "pdf": "https://archive.orkl.eu/f379aa885d52567de38ad7ffe6be90aca2140f56.pdf",
        "text": "https://archive.orkl.eu/f379aa885d52567de38ad7ffe6be90aca2140f56.txt",
        "img": "https://archive.orkl.eu/f379aa885d52567de38ad7ffe6be90aca2140f56.jpg"
    }
}