{
    "id": "03d71fd4-8d8a-4dd6-9746-374a84e73c8a",
    "created_at": "2022-10-25T16:48:17.330498Z",
    "updated_at": "2025-03-27T02:16:39.970018Z",
    "deleted_at": null,
    "sha1_hash": "fa008c2924f69b019af1924b429744d76ca11e1f",
    "title": "",
    "authors": "",
    "file_creation_date": "2019-10-07T15:45:18Z",
    "file_modification_date": "2019-10-10T09:14:00Z",
    "file_size": 993726,
    "plain_text": "# CONNECTING THE DOTS\n\n## Exposing the arsenal and methods of the Winnti Group\n\n\n### Marc-Etienne M.Léveillé Mathieu Tartare\n\n42\n41\n\n43\n\n77\n\n\n115\n\n129\n\n36\n37\n\n\n113\n\n132\n\n111\n\n\n112\n\n\n114\n\n130\n\n118\n\n52\n\n\n131\n\n133\n\n\n99\n\n\n97\n\n\n30\n\n31\n\n\n98\n\n\n103 102\n\n104\n\n\n76\n\n44\n\n\n29\n\n\n32 33\n\n20\n19\n\n21\n\n\n55\n\n126\n\n\n27 28\n\n26\n25 24\n\n23\n\n\n74\n\n\n79\n\n\n78\n\n95\n\n80\n\n\n96\n\n94\n\n\n75\n\n100\n\n\n101\n\n83\n\n46\n\n85\n\n\n22\n\n\n108\n\n124\n\n\n62\n\n86\n\n\n122\n\n\n93\n\n\n73 71\n72\n\n\n123\n\n\n81\n\n\n50\n\n\n53\n\n\n51\n\n\n57\n\n\n64 65\n\n\n90\n\n\n49\n\n91\n\n58\n\n89\n\n\n87\n\n\n61 59\n60\n\n88\n\n\n-----\n\n### TABLE OF CONTENTS\n\n1. Executive summary .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   . 4\n\n2. Overview of latest Winnti activities .   .   .   .   .   .   .   .   .   .   .   .   .   .   . 4\n\n2.1 Naming .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .  4\n\n2.2 Court cases .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   . 5\n\n2.3 Targets  .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .  5\n\n3. The Winnti Group arsenal .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  . 6\n\n4. Winnti’s custom packer  .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   . 7\n\n5. PortReuse backdoor .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  . 8\n\n5.1 Modular architecture  .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .  8\n\n5.2 Distribution  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  9\n\n5.3 InnerLoader  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  9\n\n5.4 NetAgent and raw TCP hooking .   .   .   .   .   .   .   .   .   .   .   .   .   .   10\n\n5.5 SK3  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  11\n\n5.6 UserFunction and ProcTran .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  12\n\n5.7 Passive HTTP listening  .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   . 13\n\n5.8 Multiple variants to target different ports .  .  .  .  .  .  .  .  .  .  .  14\n\n5.9 Finding victims of PortReuse  .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   15\n\n6. VMProtected packer used in targeted organizations .   .   .   .   .   .   .   .   . 15\n\n6.1 PortReuse backdoor .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   16\n\n6.2 ShadowPad .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   16\n\n6.3 Persistence  .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   19\n\n7. Winnti variants  .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   . 20\n\n7.1 Several variants, same dropper .   .   .   .   .   .   .   .   .   .   .   .   .   .   . 20\n\n7.2 Dropper (Install.exe)  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  . 20\n\n7.3 Payloads .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .  20\n\n7.4 C&C servers and campaign ID .  .  .  .  .  .  .  .  .  .  .  .  .  .  . 20\n\n7.5 PlugX-like encryption .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  21\n\n7.6 Use of custom AceHash builds .  .  .  .  .  .  .  .  .  .  .  .  .  .  . 21\n\n8. 3rd stage of the 2018 supply-chain attacks:\n\nWin64/Winnti.BN’s encrypted payload  .   .   .   .   .   .   .   .   .   .   .   .   .   . 21\n\n8.1 Same cryptography implementation  .   .   .   .   .   .   .   .   .   .   .   .   . 21\n\n8.2 Monero miner  .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .  22\n\n9. Conclusion  .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   . 22\n\n10. References  .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .  23\n\n11. Indicators of Compromise .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  . 24\n\n11.1 ESET detection names  .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   24\n\n11.2 File names .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   . 24\n\n11.3 C&C servers  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  . 24\n\n11.4 PortReuse HTTP response .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .  24\n\n11.5 PortReuse backdoor .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .  24\n\n\n-----\n\n11.6 VMProtected samples .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   . 25\n\n11.7 ShadowPad backdoor  .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   . 25\n\n11.8 PortReuse backdoor .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .  25\n\n11.9 Winnti droppers (Install.exe) .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   26\n\n11.10 Winnti .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  . 26\n\n11.11 AceHash .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .  26\n\n11.12 XMRig .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  . 26\n\n12. MITRE ATT&CK techniques  .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .  27\n\n### LIST OF TABLES\n\nTable 1 _Packer configurations found in video-games and gaming apps .  .  .  .  .  .  7_\n\nTable 2 _Inner-Loader packer embedded configuration .   .   .   .   .   .   .   .   .   .   .   9_\n\nTable 3 _NetAgent and SK3 packer embedded configuration  .   .   .   .   .   .   .   .   .   10_\n\nTable 4 _Commands supported by SK3  .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   12_\n\nTable 5 _UserFunction and ProcTran packer configurations .  .  .  .  .  .  .  .  .  . 12_\n\nTable 6 _Commands supported by ProcTran  .   .   .   .   .   .   .   .   .   .   .   .   .   .   . 13_\n\nTable 7 _Hooking techniques and targeted ports .   .   .   .   .   .   .   .   .   .   .   .   .  14_\n\nTable 8 _Module ID and their respective names and timestamps .   .   .   .   .   .   .   .   17_\n\nTable 9 _Module ID and their respective names and timestamps .   .   .   .   .   .   .   .   17_\n\nTable 10 _Updated module ID and their respective names and timestamps .   .   .   .   .   17_\n\nTable 11 _URL of pages containing encrypted C&C and their respective decrypted C&C . 18_\n\nTable 12 _Winnti C&C servers and their corresponding campaign IDs .  .  .  .  .  .  . 20_\n\n### LIST OF FIGURES\n\nFigure 1 _Overview of artefacts, techniques, events and their relationships_\n_used by the Winnti Group .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   . 6_\n\nFigure 2 _Structure used by the custom packer .  .  .  .  .  .  .  .  .  .  .  .  .  .  7_\n\nFigure 3 _PortReuse backdoor architecture .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   8_\n\nFigure 5 _DNS structure of the magic packet .   .   .   .   .   .   .   .   .   .   .   .   .   .   . 11_\n\nFigure 6 _Decompiled PortReuse hooking procedure .   .   .   .   .   .   .   .   .   .   .   .   . 11_\n\nFigure 7 _Decompiled UrlPrefix registration procedure  .   .   .   .   .   .   .   .   .   .   .   . 13_\n\nFigure 8 _Decompiled procedure for handling the HTTP response on GET requests  .   .   14_\n\nFigure 9 _History of a public Google Docs docuement containing encrypted C&C URL .   19_\n\nFigure 10 Steam profile controlled by the operators  .   .   .   .   .   .   .   .   .   .   .   .   19\n\nFigure 11 PlugX-like decryption used by a decrypted wmi2.dat shellcode .  .  .  .  .  . 21\n\nFigure 12 Strings from a XMRig decrypted sample .  .  .  .  .  .  .  .  .  .  .  .  . 22\n\n\n-----\n\n### 1. EXECUTIVE SUMMARY\n\nIt seems the past few years have shown an increase in supply-chain attacks to distribute malware.\nIs this a reality, or because the industry is getting better at detecting and documenting them? Regardless\nof the answer, one of the groups that has been shown to be quite effective at conducting supply-chain\nattacks is the Winnti Group. Not only they have compromised multiple high-profile targets, but in each case,\nthey were able to stay under the radar for many months before they were found and disrupted.\n\nThis report describes in detail some of the new malware used by this group in the organizations they target.\nAnother one of their backdoors, ShadowPad, was also updated recently. This report will also expose the new\ntechniques they use to hide their payloads.\n\nBy analyzing their tools and techniques, ESET researchers were able to infer some relationships between\neach reported supply-chain incident.\n\n###### Key Findings\n\n- One of the goals of the group, or its subgroups, is cryptocurrency mining. The Winnti Group has deployed\n[cryptocurrency mining software using the backdoor they added in games and software in 2018.](https://www.welivesecurity.com/2019/03/11/gaming-industry-scope-attackers-asia/)\n\n- There are strong links in the tools and the techniques used in multiple major supply-chain attacks in past\nyears. These links indicate that the following incidents were likely performed by the same group:\n_[CCleaner, NetSarang, Asus and games and software in 2018.](https://blog.talosintelligence.com/2017/09/avast-distributes-malware.html)_\n\n- This report documents a previously unanalyzed backdoor used by the Winnti Group. Called PortReuse\nby its authors, this Windows backdoor is a passive network implant that injects itself into a process that is\nalready listening on a network port and waits for an incoming magic packet to trigger the malicious code.\n\n- [With the help of Censys, ESET researchers identified and notified a victim of PortReuse: a major Asian](https://censys.io/)\nmobile hardware and software vendor.\n\n- The ShadowPad malware is still being updated by its author and was updated and used multiple times\nin 2019. It has the same modular approach and includes additional obfuscation techniques.\n\n### 2. OVERVIEW OF LATEST WINNTI ACTIVITIES\n\nSince the original report by Kaspersky in 2013 “Winnti. More than just a game” [1], there have been numerous\nreports on the Winnti Group activities.\n\n#### 2.1 Naming\n\nWhen reading the multiple reports on the Winnti Group activities, it is sometime difficult to realize that\nsome discuss about the same malware family or component. This report tries to use existing names as much\nas possible, by using the name as it was first reported. We understand that some of the names are different\ndue to the naming schemes used by different vendors or the fact that the visibility during research couldn’t\nallow mapping an analysis to a specific existing name. There is also the problem of tools versus the name\nof the operation, which sometimes bear the same name. It is worth spending some time to define the terms\nwe are going to use.\n\n- Winnti Group: For ESET researchers, this is the group that performed the attacks on multiple organizations\nusing the tools and techniques described in this paper, regardless of their intent. Whether they are part\nof a single group or multiple subgroups is of less importance. The relationships that can be drawn around\ntheir different attacks is sufficient to show they were at least in contact.\n\nAliases:\n\n   - Winnti Umbrella — 401TRG\n\n   - Axiom — Novetta\n\n   - BARIUM and LEAD — Microsoft. According to Microsoft [2], BARIUM targets the gaming\nand technology industry while LEAD’s objective is more to steal sensitive data.\n\n\n-----\n\n   - Group 72 — Cisco Talos\n\n   - Blackfly and Suckfly — Symantec\n\n   - APT41 — FireEye\n\n- Winnti malware: A malware family described by Kaspersky in 2013 [3]. This malware uses a rootkit\ncomponent to hide its activity.\n\nAliases:\n\n   - RbDoor (name seen in PDB path of early Winnti variants)\n\n   - RibDoor — Microsoft’s detection name\n\n   - HIGHNOON — FireEye\n\n- ShadowPad: A malware family used at a later stage in targeted attacks performed by the Winnti Group.\nIt was first described by Kaspersky in the NetSarang incident in 2017 [4].\n\nAliases:\n\n   - Barlaiy — Microsoft\n\n   - POISONPLUG — FireEye\n\n- ShadowHammer: Malware embedded in Asus Live Update in 2018 [5]. ShadowHammer triggers\nits malicious behavior only if the computer it is running on has a network adapter with the MAC address\nwhitelisted by the attacker.\n\n#### 2.2 Court cases\n\nThere are currently two open court cases in the US against the alleged perpetrator behind this group.\n\n_[The first one, dated October 26th 2017, not long after the NetSarang incident, is a civil case filed by Microsoft.](https://www.noticeofpleadings.net/barium/)_\nWithout going into attribution, it describes how the ShadowPad malware operates and how it uses\nlegitimate web sites to store the address of its C&C server.\n\n_[The second one has more details about attribution. The indictment was filed by US federal attorneys, in the](https://www.justice.gov/opa/press-release/file/1106491/download)_\nDistrict Court of Southern California, in October 2018. It accuses ten Chinese individuals of compromising\ncompanies mostly in the aerospace and technology industry. According to the indictment, the intentions\nwere to steal intellectual property from the victims. The incidents they describe go from 2010 to 2015,\nwhere they used the Sakula, PlugX, and Winnti malware in the different organizations. Some of their attacks\ninvolved compromising the DNS registrar to change the nameservers of their target. We cannot be certain\nthat the same individuals are behind the supply-chain attacks, but given that they were using the same\ntoolset, they probably belong to the same organization.\n\n#### 2.3 Targets\n\nBy following their activities over the years, it is intriguing to see that the Winnti Group has had victims\nin a wide range of industries. They include:\n\n- Aviation\n\n- Gaming\n\n- Pharmaceuticals\n\n- Technology\n\n- Telecommunication\n\n- Software development\n\nThis shows that the group may have lot of different intents. For example, there is no explanation we can\nthink of to target the gaming industry to perform espionage operations. This is one of the reasons ESET\nresearchers and researchers for other vendors tend to agree that the Winnti Group may not be monolithic;\nit is plausible that there are multiple subgroups and that operations are not conducted by the same group\nthat is authoring the malware they use.\n\nBased on ESET’s telemetry and public reporting, it seems they focus their efforts to compromise private\norganizations in Asia, with South Korea being one of the most targeted countries.\n\n\n-----\n\n### 3. THE WINNTI GROUP ARSENAL\n\nDuring the course of our research, we were able to find different malware artifacts using the same\ntechniques or code. To better visualize the full picture, we have created a diagram showing the relationships\nbetween all of them.\n\n|Col1|Uses|\n|---|---|\n\n|Drops Uses Uses|Col2|\n|---|---|\n||Uses|\n|||\n\n|Col1|Uses|\n|---|---|\n|Uses||\n\n\n**INCIDENT**\n\n\n**ARTEFACT**\n\n\nSupply-chain incident **PE** Portable Executable (PE)\n\nPosition independent code\n\n\n**TIMELINE**\n\nNew\n\n\nUpdated\n\nDescribed in March 2019 article\n\n\nTechnique\n\n\nFigure 1 // Overview of artefacts, techniques, events and their relationships used by the Winnti Group\n\nSome of the components shown in this graphic have already been documented before. This report will\ndig into the new or updated ones. It will also describe techniques that are used and are important because\nthey allow to link several incidents together.\n\n\n-----\n\n### 4. WINNTI’S CUSTOM PACKER\n\nIn our previous research [1] on the Winnti Group, we discussed a custom packer used in payloads embedded\nin compromised videogames and gaming application. It uses a unique structure seen in Figure 1 to embed\na PE file. In addition to an RC4 key and the encrypted PE, this structure contains encrypted metadata such as\npath to the embedded PE file and a launch type value. The packer’s configuration structure is shown in Figure 2.\n\n**0** **16** **20** **24** **28** **32** **36** **40**\n\n\nRC4 Key Packer\nshellcode\nsize\n\n**40**\n\nPayload\noriginal file\nname\n\n\nPayload\noriginal file\nname lenght\n\nPayload\n\n\nPayload\noriginal file\nname lenght\n(wide)\n\n\nPayload size\n\n\nPayload type\n(DLL or EXE)\n\n\n**...**\n\n\nRC4 key size\n\nPayload\noriginal file\nname (wide)\n\n\nFigure 2 // Structure used by the custom packer\n\nThe RC4 key (which is XOR-ed with 0x37) contained in the structure is used to decrypt the PE as well\nas the encrypted file name and path. The launch type value can be either 1 or 2 and indicates to the unpacking code, to be able to load it properly, whether the PE is an executable or a DLL. It’s interesting to note that\nthe RC4 key contains only digits.\n\nIt is also worth noting that there are 32- and 64-bits versions of this packer. Examples of the packer’s\nconfiguration found in video-games and gaming apps discussed in our previous blogpost [1] are shown\nin Table 1.\n\n\nTable 1 _Packer configurations found in video-games and gaming apps_\n\n\nPayload SHA-1 `8272c1f41f7c223316c0d78bd3bd5744e25c2e9f`\n\nRC4 key `1729131071`\n\nFile name `111.bin.tmp`\n\nLaunch type `1 (PE)`\n\n[We developed a standalone unpacking Python script that can be found in our GitHub repository.](https://github.com/eset/malware-research/tree/master/winnti_group)\n\n\n-----\n\n### 5. PORTREUSE BACKDOOR\n\nAfter analyzing the custom packer used by the Winnti Group, we started hunting for more executable\nfiles with this packer, in the hope of unearthing other compromised software used in supply-chain attacks.\nWhat we’ve found is not exactly what we were looking for to begin with. Instead of finding compromised\nsoftware, we discovered a new listening-mode modular backdoor that uses the same packer. We believe\nits author call it PortReuse. This is not a random name: this backdoor injects into a running process already\nlistening on a TCP port, “reusing” an already open port. It hooks the receiving function and waits for\na “magic” packet to trigger the malicious behavior. The legitimate traffic is forwarded to the real application,\nso it is effectively not blocking any legitimate activity on the compromised server. This type of backdoor\nis sometimes called a passive network implant.\n\nAs we mentioned, this backdoor is using the same packing structure as the one used in 2018. It’s actually\nusing it in a recursive way: packed components also contain packed components. The metadata of the\npacked PE files are actually interesting here: the file name field contains meaningful values and even absolute\npaths in some cases. In this report, we will be describing each component using the names the malware\nauthors have given to these components.\n\n#### 5.1 Modular architecture\n\nThe PortReuse backdoor exhibits a modular architecture, since all its components are separate processes\ncommunicating through named pipes, as shown in Figure 3. This allows reusing existing binary components\nand replacing only the components that need customization. For instance, we have seen multiple PortReuse\nvariants with a different NetAgent but using the same SK3. ProcTran and UserFunction exist in 32- and 64-bits\nversions but can communicate with any SK3 regardless of its version, since they share a common protocol\nthrough the named pipe.\n\n\nInner-Loader.dll\n\n|Col1|Col2|\n|---|---|\n|Injects||\n\n\nFigure 3 // PortReuse backdoor architecture\n\nThere is no C&C server in the backdoor. We have only seen NetAgent listening on open sockets. The attacker\nneeds to connect directly to the compromised host.\n\n\n-----\n\n#### 5.2 Distribution\n\nOnly a single file is written to disk to start PortReuse. All other components exist in memory only.\nThe initial launch file was found in different formats:\n\n- Embedded in a .NET application launching the initial Winnti packer shellcode\n\n- In a VB script that deserializes and invokes a .NET object that launches the shellcode\n\n- In an executable that has the shellcode directly at the entry point\n\n#### 5.3 InnerLoader\n\n_InnerLoader is the first component to be decrypted and launched. As InnerLoader.dll is found packed_\nwith the custom packer, we were able to extract the packer metadata. The metadata from the packer,\nincluding absolute file path when it was packed, is shown in Table 2.\n\n\nTable 2 _Inner-Loader packer embedded configuration_\n\n\nPayload SHA-1 `252640016faeff97fa22eb2b736973ed16d73fbe`\n\nRC4 key `876426830`\n```\n                    E:\\code\\PortReuse\\3389-share\\DeviceIOContrl-Hook\\\n\n```\nFile name\n```\n                    v1.3-53\\Inner-Loader\\x64\\Release\\Inner-Loader.dll\n\n```\nLaunch type `2`\n\nAs shown in the absolute file path, the name of the project from which InnerLoader belongs is called\n_PortReuse. InnerLoader will look for a given process to inject two payloads. In the case of the .NET injector,_\n_InnerLoader targets a process called GameServer_NewPoker.exe and in the case of the VBS injector_\nit will look for a process listening on port 53 (DNS). These payloads are, again, packed using the same packer\nand are called NetAgent and SK3 according the packer configuration. These packer configurations are shown\nin Table 3.\n\n\n-----\n\nTable 3 _NetAgent and SK3 packer embedded configuration_\n\n\nPayload SHA-1 `e0f276ed16027ed2953a7b0e5274d3f563a75a9d`\n\nRC4 key `250574172`\n```\n                    E:\\code\\PortReuse\\3389-share\\DeviceIOContrl-Hook\\\n\n```\nFile name\n```\n                    v1.3-53\\SK3.x\\x64\\Release\\SK3.x.exe\n\n```\nLaunch type `1`\n\n#### 5.4 NetAgent and raw TCP hooking\n\n_NetAgent is the module responsible for handling TCP hooking. Depending on the NetAgent version,_\ntwo different hooking techniques are used.\n\n_NetAgent will hook either WSARecv or NtDeviceIoControlFile. In both cases, the hook will first check_\nif the received packet complies to a given magic packet format as already seen in the case of the Winnti\nmalware [6].\n\nThe magic packet should contain the following binary data (14 bytes):\n```\n   2c af da 56 16 3b 3a 76 27 73 59 54 96 b9\n\n```\nThis format was also observed in samples hooking data received on port 53 (DNS) (12 bytes):\n```\n   ff ff 01 00 00 01 00 00 00 00 00 00\n\n```\nThis packet is actually a valid DNS request header with transaction ID 65535 (0xFFFF), the recursion desired\nflag set (Flags = 0x0100) and one question, as shown in Figure 5.\n\n\n-----\n\n**0** **2** **4** **6** **8** **10** **12**\n0xFFFF 0x0100 0x0001 0x0000 0x0000 0x0000\n\n|2 0 0xFFFF|2 4 0x0100|4 6 0x0001|6 8 0x0000|8 10 0x0000|0 12 0x0000|\n|---|---|---|---|---|---|\n|||||||\n|||||||\n\n\nTransaction ID\n\n\nFlags\n\n\nQuestion count\n\n\nAnswer count\n\n\nNS count\n\n\nAR count\n\n\nFigure 5 // DNS structure of the magic packet\n\nThis allows blending into the network traffic to avoid detection. A request to the backdoor must have\nthe specific transaction ID to trigger which, in normal circumstances, should be chosen at random\nby DNS clients.\n\nAfter having received the magic packet, the hook will start forwarding network traffic through the named\npipe “Microsoft Ole Object {30000-7100-12985-00000-00002}” to the SK3 module. Until the magic\npacket is received, the hook passes the execution to the hooked function.\n\nOne of the NetAgent variants also tries to hide its activity by disabling Event Tracing for Windows (ETW)\nfor the injected process by patching the beginning of EtwEventWrite function with “MOV RAX, 0; RET”\nwhich will then always blindly return zero as shown in Figure 6.\n\nFigure 6 // Decompiled PortReuse hooking procedure\n\n#### 5.5 SK3\n\nThe communication between the backdoor and its client is RC4-encrypted using the key “CreateThread”\nand XOR-encoded with 0x77. The SK3 module is responsible for decrypting and processing the traffic\nforwarded by NetAgent through the named pipe. The decrypted command format is CMD_ID CMD_ARGS\nwhere CMD_ID is an integer. The list of the supported commands is shown in Table 4.\n\n\n-----\n\nTable 4 _Commands supported by SK3_\n\n\nCMD_ID CMD_ARGS Behavior\n\n`cd path` Set current working directory\n\n`dir` List file in the current directory\n\n```\n200\n\n```\n\n`copy from_path to_path` Copy file\n\n`move from_path to_path` Move file\n\n`del path` Remove file\n\n`systeminfo` Execute systeminfo.exe\n\n```\n201 PID\n\n```\n\nInject UserFunction.dll to the process with the PID provided as\nargument and send the command to it through named pipe, otherwise\nexecute the command directly with cmd.exe\n\n\n`202` `FilePath DataToWrite` Write data to the file provided as argument\n\n`203` `FilePath` Read data from file\n\n`207` `N/A` Close the named pipe with ProcTran and all the connections\n\nConnect to Hostname:Port via TCP and forward the received traffic via\n```\n 210 Hostname Port\n```\nHTTP. Map the connection with an ID\n\nSend data through the named pipe connected to ProcTran if present;\n```\n 211 Id Data\n```\notherwise, use the connection mapped with the provided ID\n\n`214` `Id` Shutdown the connection mapped to the provided ID\n\n`250` `N/A` List processes and their modules\n\n`251` `PID` Kill the process with the given PID\n\n`252` `Timestamp` Change the timestamp of the file\n\nExecute the following WQL query: SELECT Name,ProcessId,Session```\n 253 N/A\n                      Id,CommandLine,ExecutablePath FROM Win32_Process\n\n```\nInject ProcTran to the process with the PID provided as argument and\n```\n 261 PID\n```\nsend back the traffic received through the named pipe via HTTP\n\nExcept in the case of systeminfo, the commands with ID 200 are custom implementations of standard\nWindows commands.\n\n#### 5.6 UserFunction and ProcTran\n\nThe SK3 module also contains two packed executables with the following packer configuration:\n\n\nTable 5 _UserFunction and ProcTran packer configurations_\n\n\nPayload SHA-1 `44DDBF7AA256A4B0E25DE585E95EA520BF2C4891`\n\nRC4 key 852679796\n\nFile name ProcTran.dll\n\nLaunch type 2\n\n\n-----\n\n_UserFunction and ProcTran are started by SK3 and are responsible for executing commands in other_\nprocesses (see command 201) and proxying communications. Communication between SK3 and ProcTran\nand UserFunction is done through the named pipes “Microsoft Ole Object {30000-7100-12985```\n00000-00001}” and “Microsoft Ole Object {30000-7100-12985-00000-00000}” respectively.\n\n```\nCommands supported by ProcTran to handle network forwarding are shown in Table 6.\n\n\nTable 6 _Commands supported by ProcTran_\n\n\nCommand ID Arguments Decription\n\nInitiate a new connection to Hostname:Port and start forwarding\n```\n 210 Hostname Port\n```\nreceived data. The connection is associated to an ID\n\nSend the data received through the named pipe to the connection\n```\n 211 ID Data\n```\ncorresponding to the given ID\n\n`214` `ID` Close the connection corresponding to the given ID\n\n#### 5.7 Passive HTTP listening\n\nIn addition to the variants using NetAgent to handle the network hook and forwarding the traffic through\na named pipe to SK3, we also found PortReuse variants where NetAgent and SK3 were merged in one single\nmodule responsible for both, it uses a Windows Server API functionality to route requests for a given\n[URL to the backdoor by using the following UrlPrefix:](https://docs.microsoft.com/en-us/windows/win32/http/urlprefix-strings)\n```\n   http://+:[port]/requested.html\n\n```\nWhen routing traffic, the strong wildcard (+) matches all possible host names and will always be applied\nfirst, since it takes precedence over the weak wildcard (*) and explicit hostnames [7]. Every connection\nto this URL will then be redirected to SK3.\n\nThe decompiled procedure used to register a UrlPrefix is shown in Figure 7:\n\nFigure 7 // Decompiled UrlPrefix registration procedure\n\nIn the case where a GET request matching the UrlPrefix is received, the backdoor will send back\na custom HTTP response faking a Microsoft IIS 10.0 response—Content-Length header being the result\nof (GetTickCount() % 700 + 600) << 20:\n```\n   HTTP/1.1 200 OK\n   Content-Length: 1034944512\n   Content-Type: application/octet-stream\n   Server: Microsoft-IIS/ 10.0 Microsoft-HTTPAPI/2.0\n   Date: Wed, 20 Mar 2019 20:02:49 GMT\n\n```\nNote that there is a space between Microsoft-IIS/ and 10.0 and that Microsoft-HTTPAPI/2.0\nis appended to the server header—in Figure 8.\n\n\n-----\n\nFigure 8 // Decompiled procedure for handling the HTTP response on GET requests\n\nIn the case where a POST request matching the UrlPrefix is received, the backdoor will initiate\ncommunication and execute commands.\n\n#### 5.8 Multiple variants to target different ports\n\nThe PortReuse backdoor is targeting various commonly used ports such as 53 (DNS over TCP), 80, 443,\n3389 (Remote Desktop Protocol), and 5985 (Windows Remote Management). One of the variants\nwe found is also port-agnostic: it parses the TCP header and triggers only if the source port is less than 22.\nThe backdoor must first be injected into a running process that, in order to install the networking hook,\nis already listening on the targeted port. In Table 7 are shown various targets of the PortReuse backdoor\nalong with their filenames from the custom packer and the port reuse technique used:\n\n\nTable 7 _Hooking techniques and targeted ports_\n\n\nSHA-1 and file name Target Port reuse technique\n\n\nSHA-1\n```\n395e87c5bd00f78bf4c63880c6982a7941a2ecd0\n\n```\nFile name\n```\nE:\\code\\PortReuse\\3389-share\\DeviceIO\nContrl-Hook\\v1.3-WSAAccept\\Inner-Loader\\\nx64\\Release\\Inner-Loader.dll\n\n```\nSHA-1\n```\n252640016faeff97fa22eb2b736973ed16d73fbe\n\n```\nFile name\n```\nE:\\code\\PortReuse\\3389-share\\DeviceIO\nContrl-Hook\\v1.3-53\\Inner-Loader\\x64\\\nRelease\\Inner-Loader.dll\n\n```\n\nTCP with source port less\nthan 22\n\nInject into a process\nnamed\n```\nGameServer_NewPoker\n.exe\n\n```\nPort 53\n\nInject into a process\nlistening on port 53\n\n```\nWSARecv hook\nDeviceIOControl hook\n\n```\n\n-----\n\nSHA-1 and file name Target Port reuse technique\n\n\nSHA-1\n```\nf5ba05240b1609d4131d5dca7f5e6e90b5748004\n\n```\nFile name\n```\nInner-Loader.dll\n\n```\nSHA-1\n```\n52a8c38890360d0b32993a44c9e94e660f3fa8f4\n\n```\nFile name\n```\nE:\\code\\PortReuse\\iis-share\\2.5\\\nIIS_Share\\x64\\Release\\IIS_Share.dll\n\n```\nSHA-1\n```\ndbe3eece00c255a3fdf924b82621394377b0e865\n\n```\nFile name\n```\n80.dll\n\n```\nSHA-1\n```\nA5B756F1EC956A00934D68940D4559694FAA8ED6\n\n```\nFile name\nN/A\n\nSHA-1\n```\n1AECD365F5D0DEBA62026D84189BD180814D7292\n\n```\nFile name\nN/A\n\n\nPort 3389\n\nInject into a process\nthat have loaded\n```\ntermsrv.dll RDP server\n\n```\nPort 80\n\nPosing as Microsoft IIS 10.0\n\nPort 80\n\nPosing as Microsoft IIS 10.0\n\nPort 443\n\nPosing as Microsoft IIS 10.0\n\nPort 5985\n\nPosing as Microsoft IIS 10.0\n\n```\nDeviceIOControl hook\nUrlPrefix\nhttp://+:80/requested.html\nUrlPrefix\nhttp://+:80/requested.html\nUrlPrefix\nhttp://+:443/requested\n.html\nUrlPrefix\nhttp://+:5985/requested\n.html\n\n```\n\nIt is worth noting that the Winnti malware used a kernel driver to hijack network communications while\nin that case the port reuse technique allows the backdoor to operate from userland.\n\n#### 5.9 Finding victims of PortReuse\n\nSince the “magic” used to trigger the PortReuse code is now known, we can use it to find hosts connected\nto the Internet that could be compromised by this backdoor. In the case of the variants injecting in IIS it can\nbe achieved by performing a GET request and inspecting the Server and Content-Length headers.\n\nSince, based on all the samples we have analyzed, performing such a request does not produce any side\neffects, we asked the help of Censys to perform an Internet-wide scan so to identify potential victims.\n\nThanks to the Censys team, we were able to identify eight IP addresses that replied with an HTTP response\nmatching the signature of PortReuse. We found that all eight of these IP addresses belonged to a single\norganization: a major mobile hardware and software manufacturer based in Asia. We notified the company\nand are working with the victim to remediate. It is possible that the Winnti Group was planning\na devastating supply-chain attack by compromising this organization.\n\n### 6. VMPROTECTED PACKER USED IN TARGETED ORGANIZATIONS\n\nIn addition to the Winnti malware, organizations targeted by Winnti were found to be compromised\nwith a VMProtected DLL. Kaspersky mentions this VMProtected technique in the detailed article about\nShadowHammer [5].\n\nThese VMProtected samples are actually responsible for decrypting a payload that is either embedded\nin its PE file overlay or read from [Drive]:\\$Recycle.Bin\\COM1:NULL.DAT. This file (NULL.DAT)\nis an NTFS Alternate Data Stream (ADS) on a file named “COM1”, which has the special meaning of being\nthe first serial port it is a reserved name not to be used as a filename [8]. This makes working with the file\na bit more difficult than usual.\n\n\n-----\n\nTo be able to read COM1 from the command prompt, its path needs to be prefixed with “\\\\.\\”.\n\nRegardless of the location of the payload, the key derivation and decryption algorithms are always the same.\nThe payloads are encrypted using RC5 in ECB mode and the decryption key is derived from the volume ID\nof the targeted machine as follows:\n\n```\n# Generate RC5 key from volume serial number\nimport os\nvolume_serial_number = os.stat(\"C:\").st_dev\nsecret_string = \"f@Ukd!rCto R$.\"\nrc5_key = \"\"\npos = 0\nfor char in secret_string:\n    byte_from_serial = (volume_serial_number >> ((pos & 3)*8)) & 0xff\n    xored_value = (ord(char) ^ byte_from_serial)\n    if pos % 4 == 0:\n         rc5_key += \"%02X\" % xored_value\n    else:\n         rc5_key += \"%02x\" % xored_value\n    pos += 1\nprint rc5_key\n\n```\n\nIn most of the VMProtected samples we found, the string used to derive the decryption key from the volume\nID is the same (“f@Ukd!rCto R$.”). In some more recent cases the derivation string was “d37lo{r”.\nOnce decrypted, the payload is position-independent codes executed in a separate thread.\n\nThe derivation string, key derivation from the volume ID and RC5 implementation are the same as used\nin Win64/Winnti.BN, which is the known second stage of the compromised videogames and gaming\napplications and are used to decrypt the third stage. Unlike the samples we are looking at here, Win64/\nWinnti.BN is not packed with VMProtect, but uses exactly the same key derivation and encryption algorithm.\n\nESET researchers were able to decrypt several payloads packed using this custom VMProtected packer.\nWe found that the payload was either the PortReuse backdoor or the ShadowPad malware [4].\n\n#### 6.1 PortReuse backdoor\n\nThe PortReuse backdoors dropped by the VMProtected samples were all using the UrlPrefix technique\non various ports and the Server header of the backdoor response was Microsoft-IIS/ 10.0\n```\nMicrosoft-HTTPAPI/2.0. The backdoor was observed to be in use at least two organizations.\n\n```\nConsidering that the PortReuse backdoor was found in VMProtected droppers similar to what was previously\ndescribed by Kaspersky with Operation ShadowHammer [5], in addition to the fact that the same decryption\nalgorithm is used by the 2nd stage from the compromised video-games and also by the gaming application\nuncovered by ESET, strongly suggests that Operation ShadowHammer and these supply-chain attacks\nare connected and that the PortReuse backdoor is part of the Winnti Group arsenal.\n\n#### 6.2 ShadowPad\n\nAs mentioned previously, some of the payloads dropped by the VMProtected samples were similar\nto the ShadowPad malware, using the same plugin architecture with identical module ID, similar embedded\nconfigurations and encryption schemes.\n\nInterestingly, if we look at the modules timestamps, we can see that public webpages to retrieve the C&C\nserver instead of DGA (Domain Generation Algorithm) started to be used from at least the 25th August 2017,\nless than two weeks after the publication on the NetSarang compromise by Kaspersy [4]. The Module IDs\nalong with their names and timestamps from various samples are shown in Table 8, Table 9 and Table 10.\n\n\n-----\n\nTable 8 _Module ID and their respective names and timestamps_\n\n\nModule ID Module name Module timestamp\n\n100 Root Fri 25 Aug 2017 04:40:54 AM UTC\n\n101 Plugins Fri 25 Aug 2017 04:39:02 AM UTC\n\n102 Config Fri 25 Aug 2017 04:39:10 AM UTC\n\n103 Install Fri 25 Aug 2017 04:40:15 AM UTC\n\n104 Online Fri 25 Aug 2017 04:39:27 AM UTC\n\n200 TCP Fri 25 Aug 2017 04:40:15 AM UTC\n\n201 HTTP Fri 25 Aug 2017 04:35:45 AM UTC\n\n202 UDP Fri 25 Aug 2017 04:35:54 AM UTC\n\n\nTable 9 _Module ID and their respective names and timestamps_\n\n\nModule ID Module name Module timestamp\n\n100 Root Wed 21 Mar 2018 11:09:32 AM UTC\n\n101 Plugins Wed 21 Mar 2018 10:53:13 AM UTC\n\n102 Config Wed 21 Mar 2018 10:53:17 AM UTC\n\n103 Install Wed 21 Mar 2018 10:54:07 AM UTC\n\n104 Online Wed 21 Mar 2018 10:53:30 AM UTC\n\n200 TCP Wed 21 Mar 2018 10:50:44 AM UTC\n\n201 HTTP Wed 21 Mar 2018 10:50:52 AM UTC\n\n202 HTTPS Wed 21 Mar 2018 10:50:58 AM UTC\n\nIn addition to these ShadowPad variants using the same IDs as described in [4], we found an updated version\nwith modules that, according to their timestamps, were compiled in 2019 according to their timestamps,\nwith additional obfuscations and using random module IDs.\n\n\nTable 10 _Updated module ID and their respective names and timestamps_\n\n\nModule ID Module name Module timestamp\n\n58338 DNS Fri 15 Mar 2019 05:22:19 PM UTC\n\n3331 TCP Fri 15 Mar 2019 05:21:40 PM UTC\n\n22707 UDP Fri 15 Mar 2019 05:22:13 PM UTC\n\n48503 HTTP Fri 15 Mar 2019 05:21:48 PM UTC\n\n33173 HTTPS Fri 15 Mar 2019 05:21:56 PM UTC\n\n4626 Root Fri 15 Mar 2019 05:23:15 PM UTC\n\n12996 Config Fri 15 Mar 2019 05:23:26 PM UTC\n\n61013 Plugins Fri 15 Mar 2019 05:23:21 PM UTC\n\n5176 Online Fri 15 Mar 2019 05:23:49 PM UTC\n\n35573 Install Fri 15 Mar 2019 05:23:43 PM UTC\n\nThe Config module maintains an encrypted string pool that contains two URLs of a public profile or publicly\nposted document on legitimate websites, which are used to retrieve and decrypt the real C&C server URL.\n\n\n-----\n\nIn addition to these URL, the string pool contains a string similar to a campaign identifier that was related\nto the targeted victims. In previous versions of the backdoor, the string pool starts at offset 0x56 relative\nto the beginning of the configuration block, while for the updated version, the offset is 0x5c.\n\nThe algorithm to decrypt the C&C address is similar to the one used in older versions of ShadowPad.\nFirst, the string enclosed between consecutive ‘$’ delimiters from the publicly posted document is extracted.\nThen each character is decremented by 0x61 (‘a’) and each resulting pair of four bits is then concatenated\ninto a byte and the resulting buffer decrypted using the decryption routine that is also used to decrypt\nthe strings from rest of the code.\n\nThe string decryption algorithms used differ between samples, but follows a pattern similar to the following\nPython transcription:\n\n```\ndecryption_buf = []\nxor_key = (0xff & cyphertext[0]) | (0xff00 & (cyphertext[1] << 8))\nfor byte in cyphertext[2:]:\n  decryption_buf.append((0xff & xor_key) ^ byte)\n  xor_key = (0xffffffff & (0xffffffff & (0x8CC70000 * xor_key))\n         - (0xffffffff & (0x1B507339 * ((xor_key >> 16))))\n         - 0x70A927AC)\nprint \"\".join(map(chr, decryption_buf))\n\n```\n\nThe pages used to retrieve the C&C from the payloads we decrypted are shown in Table 11.\n\n\nTable 11 _URL of pages containing encrypted C&C and their respective decrypted C&C_\n\n\nURL Decrypted C&C\n\nFrom document history:\n\n```\nURL://https://docs.google[.]com/\ndocument/d/1jcRsFZM59x_4AKJabmz8sPFsKOZArV4bTn3WsYonUns\n\n```\n```\nHTTPS://154.223.131[.]237:443\nUDP://117.16.142[.]9:443\nUDP://103.19.3.109:443\n\n```\n```\nURL://https://docs.google[.]com/\n\n```\nAccess denied\n```\ndocument/d/1KJ_RJRtkKhcuJjXOCKtEOLuwH3sRi72PUhtfukncyRc\n\n```\nFrom document history:\n```\n                                   UDP://110.45.146.253:443\n                                   UDP://110.45.146.254:443\n                                   TCP://110.45.146.254:443\n                                   UDP://117.16.142.69:443\n\n```\n```\nURL://https://docs.google[.]com/\ndocument/d/1T5P3SS-QTO1nOS6IlKFA_chimnMPmhon8E_kuRSodWw\n\n```\n```\nUDP://122.10.117.206:443\nUDP://207.148.125.56:443\nUDP://118.193.236.206:443\nUDP://167.88.176.205:443\nUDP://167.88.176.205:443\nUDP://103.224.83.95:443\nUDP://103.19.3.21:443\nTCP://103.19.3.21:443\n\n```\n\n`URL://https://steamcommunity[.]com/id/869406565` C&C removed\n\n`URL://https://steamcommunity[.]com/id/61198869528` C&C altered\n```\nURL://https://raw.githubusercontent[.]com/Enterprise\n```\nC&C removed\n```\nBackup/windows/master/Readme.html\n\n```\n\n-----\n\n`URL://https://pastebin[.]com/JgduT7NH` C&C removed\n```\n URL://https://docs.google[.]com/\n\n```\nC&C removed\n```\n document/d/1-vFbL5nw85uJeS-X9sYEJ0CAsUzJE3kidJg6Gg_vZ7s\n\n```\n`URL://https://social.msdn.microsoft[.]com/profile/Pf9Je@` C&C removed\n\nUnfortunately, the attackers cleaned all the page content before we had access to the malware samples.\nHowever, two documents hosted on Google Docs contained information in the document history that\nenabled us to list the C&C servers they used for that campaign. The supported protocols to contact\nthe C&C server are HTTP, HTTPS, UDP, TCP and DNS.\n\nFigure 9 // History of a public Google Docs document containing encrypted C&C URL\n\nFigure 10 // Steam profile controlled by the operators\n\n\n-----\n\n#### 6.3 Persistence\n\nThese VMProtected samples persist on the system by using a DLL hijacking technique [7] similar to what\nwas used by the 2nd stage of the CCleaner backdoor as described by CrowdStrike [8]. The DLL has an\nexported function that is used to copy itself to C:\\Windows\\System32\\TSVIPSrv.DLL. It will then be\nloaded when the SessionEnv service which tries to load TSVIPSrv.DLL from the System32 directory.\n\n### 7. WINNTI VARIANTS\n\n#### 7.1 Several variants, same dropper\n\nSome of the victims in the gaming industry were found to be compromised by different Winnti\nvariants installed using the same dropper named Install.exe and Install64.exe for the 32- and 64-bits\nversions respectively.\n\n#### 7.2 Dropper (Install.exe)\n\nThis dropper uses a decryption key from the command line argument to decrypt the payload as follows:\n```\n   c:\\Install.exe {AES key} {path to encrypted payload}\n\n```\nThe decryption key was always the same regardless of the Winnti variant dropped or the victim,\nand the decryption algorithm used by Install.exe is AES-256-CTR. This dropper has been used since\nat least mid-2017 and is still in use as of the time of writing.\n\n#### 7.3 Payloads\n\nSeveral different Winnti versions are dropped by Install.exe and exhibit similarities shared with other\nvariants previously uncovered such as:\n\n- Decryption password of the dropper component is passed from command line argument [6]\n\n- AES-encrypted payload [6].\n\n- Use of DPAPI encryption [9] .\n\n- Use of PlugX-like encryption [9].\n\n- 32- and 64-bit versions of the rootkit are embedded in the loader [10].\n\n- Copies itself to %WINDIR%\\system32\\wbem\\wbemcomn.dll and replaces the original Windows DLL [9].\n\n- Leverages the WMI performance adapter service (wmiAPSrv) [9].\n\n- C&C URL and campaign ID are embedded in the configuration [6].\n\n#### 7.4 C&C servers and campaign ID\n\nWinnti samples contain a configuration containing the C&C domain and a campaign ID. From the various\nsamples we collected that were dropped by Install.exe, we were able to extract the following C&Cs\nand campaign IDs:\n\n\nTable 12 _Winnti C&C servers and their corresponding campaign IDs_\n\n\nC&C Campaign ID\n\nxp101.dyn-dns[.]co:443 `AA TT 0926`\n\nsvn-dns.ahnlabinc[.]com:443 `GRA KR 0629`\n\ndns1-1.7release[.]com:443 `ENA KR2 0629`\n\ndns1-1.7release[.]com:443 `EOS TW 0629`\n\nssl.dyn-dns[.]co:80 `gx DE 0705`\n\n\n-----\n\n#### 7.5 PlugX-like encryption\n\nIn some cases, the payload decrypted by Install.exe is a position-independent code with an embedded\nencrypted payload. This embedded payload is decrypted using the PlugX decryption algorithm before\nexecuting it, as shown in Figure 11.\n\nFigure 11 // PlugX-like decryption used by a decrypted wmi2.dat shellcode\n\nThe PlugX-like encryption algorithm is similar to the one mentioned in the Operation ShadowHammer\nblogpost, which suggests another link between the ShadowHammer campaign and the campaigns against\nin the video game industry previously uncovered by ESET. Moreover, Trend Micro also mentioned the use\nof PlugX-like encryption for the Winnti GitHub abuse campaign [9].\n\n#### 7.6 Use of custom AceHash builds\n\nWinnti is also known to use custom AceHash builds [11]. 32- and 64-bit signed builds of this password\ndumper were also found among several victims compromised by Winnti variants installed from\nthe Install.exe dropper, sometimes in conjunction with Mimikatz.\n\n### 8. 3RD STAGE OF THE 2018 SUPPLY-CHAIN ATTACKS: WIN64/WINNTI.BN’S ENCRYPTED PAYLOAD\n\nIn our previous research [1], we mentioned that the 2nd stage delivered to the victims appends\nthe extension .mui to its DLL path, reads that file and decrypts it using RC5 by deriving the decryption key\nfrom the volume ID of the victim’s hard drive.\n\n#### 8.1 Same cryptography implementation\n\nThe RC5 and key derivation implementation are the same as the one used in the ShadowPad VMProtected\nlauncher. The string “f@Ukd!rCto R$.” is used to derive the decryption key from the volume ID ID – the\nsame key used by the PortReuse and ShadowPad VMProtected launcher. These findings add another\nconnection between operation ShadowHammer and compromise campaign in the video-game industry.\n\n\n-----\n\n#### 8.2 Monero miner\n\nWe were able to obtain and decrypt the .mui files loaded by Win64/Winnti.BN. They were actually\nXMRig executables, again packed using the same custom packer as the one used to pack the 1st stage\nof compromised games as well as the PortReuse backdoor.\n\nFigure 12 // Strings from a XMRig decrypted sample\n\nXMRig is an open-source Monero (XMR) CPU miner and is launched with the following command line:\n```\n   x -c wcnapi.mui\n\n```\nwhere wcnapi.mui is the configuration file provided to XMRig. Unfortunately, we do not have a sample\nof the configuration file. In any event, this sheds some light on the financial motivation behind this campaign.\n\nEven though we observed only XMRig as final payload, we cannot exclude the possibility that attackers\nmay have sent different payload to victims of interest based on the MAC addresses collected by the 1st stage.\n\n### 9. CONCLUSION\n\nThe Winnti group is capable of breaching large organizations via many different means. Given how complex\nthe backdoor and methods they use are, we think they have significant resources and time allocated\nto malicious activities.\n\nThere are a lot of discussions among malware researchers regarding attribution. More specifically,\nwhether or not the different attacks, both espionage and for financial gain, are performed by the same\npeople or organization. Given the amount of work required, we know these attacks aren’t performed by\na single individual. The perpetrators running the different operations may or may not be the authors\nof the actual malware we see. They may share tools among different teams and what we see is only\na representation of what they accomplish as a team. Or is it multiple teams?\n\nThe fact that clustering is hard here doesn’t mean we can’t link the different incidents. Given the code\nand techniques they reuse, we can make strong correlations between incidents. However, by looking only\nat samples and events, it would be speculation to try to find out how the organization actually works.\nWho profits from financial gain? Do they mine cryptocurrencies to finance their own activities or do they\nuse the same malware outside of their work hours? There is currently no evidence that would help answer\nthese questions with certainty.\n\nThe Winnti Group is still very active in 2019 and continues to target both gaming and other industries.\nThe update to the ShadowPad malware shows they are still developing and using it. The relatively new\nPortReuse malware also shows they update their arsenal and give themselves an additional way\nto compromise their victims for a long period of time.\n\n\n-----\n\n### 10. REFERENCES\n\n1 M-E. M.Léveillé, ESET, “Gaming industry still in the scope of attackers in Asia,” 11 March 2019. [Online].\n[Available: https://www.welivesecurity.com/2019/03/11/gaming-industry-scope-attackers-asia/.](https://www.welivesecurity.com/2019/03/11/gaming-industry-scope-attackers-asia/)\n\n2 Microsoft Defender ATP Research Team, “Detecting threat actors in recent German industrial attacks\n[with Windows Defender ATP,” 25 January 2017. [Online]. Available: https://www.microsoft.com/security/](https://www.microsoft.com/security/blog/2017/01/25/detecting-threat-actors-in-recent-german-industrial-attacks-with-windows-defender-atp/)\n_[blog/2017/01/25/detecting-threat-actors-in-recent-german-industrial-attacks-with-windows-defender-atp/.](https://www.microsoft.com/security/blog/2017/01/25/detecting-threat-actors-in-recent-german-industrial-attacks-with-windows-defender-atp/)_\n\n3 GReAT, “Winnti. More than just a game,” 11 April 2013. [Online].\n[Available: https://securelist.com/winnti-more-than-just-a-game/37029/.](https://securelist.com/winnti-more-than-just-a-game/37029/)\n\n4 GReAT, “ShadowPad: popular server management software hit in supply chain attack,” 15 August 2017.\n\n[[Online]. Available: https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2017/08/07172148/](https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2017/08/07172148/ShadowPad_technical_description_PDF.pdf)\n_[ShadowPad_technical_description_PDF.pdf.](https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2017/08/07172148/ShadowPad_technical_description_PDF.pdf)_\n\n5 GReAT, “Operation ShadowHammer: a high-profile supply chain attack,” 23 April 2019. [Online].\n[Available: https://securelist.com/operation-shadowhammer-a-high-profile-supply-chain-attack/90380/.](https://securelist.com/operation-shadowhammer-a-high-profile-supply-chain-attack/90380/)\n\n6 T. Haruyama, “Winnti Polymorphism,” 2016. [Online].\n[Available: https://hitcon.org/2016/pacific/0composition/pdf/1201/1201%20R2%201610%20winnti%20polymorphism.pdf.](https://hitcon.org/2016/pacific/0composition/pdf/1201/1201%20R2%201610%20winnti%20polymorphism.pdf)\n\n7 D. Hohnstein, “Lateral Movement — SCM and DLL Hijacking Primer,” 18 April 2019. [Online].\n[Available: https://posts.specterops.io/lateral-movement-scm-and-dll-hijacking-primer-d2f61e8ab992.](https://posts.specterops.io/lateral-movement-scm-and-dll-hijacking-primer-d2f61e8ab992)\n\n8 K. Sood, “CCleaner Stage 2: In-Depth Analysis of the Payload,” 10 November 2017. [Online]. Available:\n_[https://www.crowdstrike.com/blog/in-depth-analysis-of-the-ccleaner-backdoor-stage-2-dropper-and-its-payload/.](https://www.crowdstrike.com/blog/in-depth-analysis-of-the-ccleaner-backdoor-stage-2-dropper-and-its-payload/)_\n\n9 C. Pernet, “Winnti Abuses GitHub for C&C Communications,” 22 March 2017. [Online].\n[Available: https://blog.trendmicro.com/trendlabs-security-intelligence/winnti-abuses-github/.](https://blog.trendmicro.com/trendlabs-security-intelligence/winnti-abuses-github/)\n\n10 Macnica Networks, “Japan Security Analyst Conference 2018,” 25 January 2018. [Online].\n[Available: https://www.jpcert.or.jp/present/2018/JSAC2018_09_yanagishita-takeuchi.pdf.](https://www.jpcert.or.jp/present/2018/JSAC2018_09_yanagishita-takeuchi.pdf)\n\n11 Hiroshi Takeuchi, Hajime Yanagishita - Macnica Networks, “Catch Painful TTPs for Adversaries,” 2018. [Online].\n[Available: https://hitcon.org/2018/pacific/downloads/1214-R2/1330-1400.pdf.](https://hitcon.org/2018/pacific/downloads/1214-R2/1330-1400.pdf)\n\n12 Novetta, “Winnti Analysis,” April 2015. [Online].\n[Available: https://www.novetta.com/wp-content/uploads/2015/04/novetta_winntianalysis.pdf.](https://www.novetta.com/wp-content/uploads/2015/04/novetta_winntianalysis.pdf)\n\n13 T. Hegel, “Burning Umbrella: An Intelligence Report on the Winnti Umbrella and Associated State-Sponsored\n[Attackers,” 3 May 2018. [Online]. Available: https://401trg.com/burning-umbrella/.](https://401trg.com/burning-umbrella/)\n\n\n-----\n\n### 11. INDICATORS OF COMPROMISE\n\n#### 11.1 ESET detection names\n```\n  Win32/Winnti trojan\n  Win64/Winnti trojan\n  MSIL/Injector.UNL trojan\n  Win32/CoinMiner.DV potentially unwanted application\n  Win32/Spy.Agent.ORQ trojan\n  Win64/Agent.HE trojan\n  Win64/Agent.HH trojan\n  Win64/Agent.NM trojan\n  Win64/CoinMiner.DN potentially unwanted application\n  Win64/Injector.BS trojan\n  Win64/Injector.BT trojan\n  Win64/Packed.VMProtect.FH trojan\n  Win64/Packed.VMProtect.FI trojan\n  Win64/Spy.Agent.F trojan\n  Win64/TrojanDropper.Agent.AM trojan\n  Win64/TrojanDropper.Agent.CJ trojan\n\n 11.2 File names\n  [Drive]:\\$Recycle.Bin\\Com1:NULL.DAT\n  wcnapi.mui\n\n 11.3 C&C servers\n  154.223.131[.]237\n  117.16.142[.]9\n  103.19.3[.]109\n  110.45.146[.]253\n  117.16.142[.]69\n  122.10.117[.]206\n  207.148.125[.]56\n  118.193.236[.]206\n  167.88.176[.]205\n  103.224.83[.]95\n  103.19.3[.]21\n  xp101.dyn-dns[.]com\n  svn-dns.ahnlabinc[.]com\n  dns1-1.7release[.]com\n  ssl.dyn-dns[.]com\n\n 11.4 PortReuse HTTP response\n  Server: Microsoft-IIS/ 10.0 Microsoft-HTTPAPI/2.0\n\n 11.5 PortReuse backdoor\n\n###### .NET injector\n  395E87C5BD00F78BF4C63880C6982A7941A2ECD0\n\n VBS injector\n  08B825C87171500E694798527E17A849160B0A72\n\n```\n\n-----\n\n###### InnerLoader\n```\n  97709D62531D12A6994BCE5787D519DB52435A62\n  252640016FAEFF97FA22EB2B736973ED16D73FBE\n  F5BA05240B1609D4131D5DCA7F5E6E90B5748004\n\n NetAgent\n  E14A6A8447CE1D45494E613D6327430D9025A2E5\n  74A68DAD4BC87EACCA93106832F8B4AEE82843A2\n  5AB3461B17EE3806ABBB06B8966F6B0011F3D8F2\n\n SK3\n  A1AED6FD6990A74590864F9D2A6E714A715FCE3E\n  E0F276ED16027ED2953A7B0E5274D3F563A75A9D\n  14C32D0C0346EF4A2B1993FDA9AAB670806B9284\n\n Merged NetAgent & ProcTran\n  52A8C38890360D0B32993A44C9E94E660F3FA8F4\n  20CA6EAE9D6CF2275F9BFD24A0E07F75BEE119BA\n  DBE3EECE00C255A3FDF924B82621394377B0E865\n\n UserFunction\n  A08922372042B4C3C0FAA120E9DD626823CDB3C7\n  93F623C91F579D33788F84A9A83478CD2E9646AA\n\n ProcTran\n  44DDBF7AA256A4B0E25DE585E95EA520BF2C4891\n  75B7A4B7E01CECC9AFBDAB01C49E9D7FCCACFDC0\n\n#### 11.6 VMProtected samples\n\n 11.7 ShadowPad backdoor\n\n###### Payload in Overlay\n  82072CB53416C89BFEE95B239F9A90677A0848DF\n  634344FAFD6E16F171B0857962149659639FDF41\n  ED0C9354D34D6E9F09B7038D391E846CDD9E0EAE\n  E6D43344A354EB17E0E0E76AD391FBCAF9C34119\n  22B82AE0819DA2FD887BE55A8508FFB46D02CA99\n  F14694BDDE921B31030300CC9BDC5574BA3D9F74\n  971BB08196BBA400B07CF213345F55CE0A6EEDC8\n  438178A5816D3EF6AC02D4DB929A48FA558E514C\n  4DC5FADECE500CCD8CC49CFCF8A1B59BAEE3382A\n  C44D06F79E5E42B08BE17A8A7DBAF61400F1DE28\n  672BB391B92681ADCFCFB4F2F728EDF32F2FB8FE\n\n##### 11.8 PortReuse backdoor\n\n###### Payload in ADS\n  9E8883A6DE72D338E2C0C1A0E291D013A0CE9058\n  B09ADDDE1523C223C4F8FBF0E541C627E4A04400\n\n```\n\n-----\n\n###### Payload in Overlay\n```\n  BD1F1494B8D18DAF07DE7D47549A7E27FF3FFD05\n  757FF5EC3DC53ABBB62391B14883EF460F6FD404\n  BDBADB2E3EEDD72DD6F8D9235699A139CAB69AAE\n  4D090E6B749D4D3D8E413F44EB2DE6925C78CD82\n  B4446480813D3BFC8DE4049A32A72CC0EB0D8094\n\n#### 11.9 Winnti droppers (Install.exe)\n  95A41FDDDC8CAF097902B484F8440BDDAD0C5B32\n  D9A54F79CA15C7E363DBE62B4D1C5C8D103103A2\n  DAF1CD345F44CB2BF1CFA8D68EECAF1961CBD51F\n  3DF753F56BB53F72D3DF735A898D7221C3B5272E\n  6C10C9D46531FBC5F0C2372A116AB31C730ED4B7\n  D74F1C8257409AD964DB22087A559609C2D0D978\n  E6677E5E2D68BC544B210E69D9C8DF6A2752C20A\n  EC0E4A6E2E630267C13B449ED4CF3F04598E40DF\n  F61403E7730D17B967DA3143BC7CB33EEBE826C0\n  FD9DED44C47585541B89FFD25907A9A2ED41A995\n  E0B1005DA5B35E31F09FC82A694F188A92CCA85D\n  CD36CAF7F7CD9F161743348D2EA69A9E0254C3B5\n  2C35E28FBA5D05F10430C4D70E4938426F38E228\n  1AE6FBAD7AF15FB7E60DBBFEA964F0E49372AE53\n  1EC1B5A902869ED5D51012826A34FFA9225853CB\n\n 11.10 Winnti\n  B08D72576B93687DFC61ABFA740DD39490D6A262\n  DE197A5DC5B38E4B72BC37C14CF38E577DDEB8B5\n  4EA2ED895111A70B9A59DF37343440E4A3A97A47\n  DE197A5DC5B38E4B72BC37C14CF38E577DDEB8B5\n  C452BDF6FF99243A12789FF4B99AC71A5DA5F696\n  B08D72576B93687DFC61ABFA740DD39490D6A262\n  24AA07A0B3665BF97A1545B0F2749CD509F1B4CA\n  E26B59789029D23BD9232FA6B1C90EC9379B9066\n  C262D297EAEC622E3FB8E1FC2A0017E28168879A\n  645720EC88C993B28D982C0AD89A5ACA79CE7E16\n  B6819C870DF88A973EB48B572AD1CFEAEB6A655A\n  8DF84B01B08EE983C66BECC59C0F361D246A96ED\n  723B27ABA08CBB3A9CA42F7E8350451D00829E5A\n  55155C3A7B993584A07ACDBF92F2200804C00E02\n  5105F3020B5E680FA66D664C7F8C811F072933CF\n  D62A0BD08C5B435D1B8A0505E8018D58A9667B2C\n  C262D297EAEC622E3FB8E1FC2A0017E28168879A\n  7B0AAE2AA17BD5712DD682F35C7A8E3E1CDCC57C\n\n 11.11 AceHash\n  47A262BAE22BB77850A1E3E38F8E529189D291F6\n  35C026F8C35BFCEECD23EACE19F09D3DF2FD72DA\n  43FF18CEB3814F1DAE940AD977C59A96BB016E76\n  D24BBB898A4A301870CAB85F836090B0FC968163\n\n 11.12 XMRig\n  70B21E3AC69F0220784228375BA6BEF37FE0C488\n  9BFB1C92489DA812DBE53B2A8E2CC2724CF74B4E\n  EE5FEB8E9428A04C454966F6E19E202CCB33545F\n\n```\n\n-----\n\n### 12. MITRE ATT&CK TECHNIQUES\n\nTactic ID Name Description\n\nInitial The Winnti Group has compromised multiple software\n_[T1195](https://attack.mitre.org/techniques/T1195/)_ Supply Chain Compromise\nAccess packages.\n\n\nPersistence\n\nDefense\nEvasion\n\n\nVMProtected samples persist on the system by using\n_[T1038](https://attack.mitre.org/techniques/T1038/)_ DLL Search Order Hijacking a DLL hijacking technique similar to what was used\nby the 2nd stage of the CCleaner backdoor.\n\n_[T1179](https://attack.mitre.org/techniques/T1179/)_ Hooking PortReuse backdoor performs raw TCP hooking.\n\nThe Winnti Group signs its malware using stolen\n_[T1116](https://attack.mitre.org/techniques/T1116/)_ Code Signing\ncode-signing certificates.\n\nDeobfuscate/Decode Files or\n_[T1140](https://attack.mitre.org/techniques/T1140/)_ The victim’s volume ID is used to decrypt payloads.\nInformation\n\nSome VMProtected samples load their payloads\n_[T1158](https://attack.mitre.org/techniques/T1158/)_ Hidden Files and Directories\nfrom Alternate Data Streams.\n\nSeveral obfuscation techniques are used by the Winnti\n_[T1027](https://attack.mitre.org/techniques/T1027/)_ Obfuscated Files or Information Group, such as the use of VMProtect and a custom\npacker.\n\nPortReuse backdoor is injected into a process listening\n_[T1055](https://attack.mitre.org/techniques/T1055/)_ Process Injection\non a given port.\n\nThe Winnti Group uses a custom packer for the PortReuse\n_[T1045](https://attack.mitre.org/techniques/T1045/)_ Software Packing\nbackdoor and compromised software.\n\n_[T1089](https://attack.mitre.org/techniques/T1089/)_ Disabling Security Tools PortReuse backdoor disables Event Tracing for Windows.\n\n\nPortReuse backdoor searches for processes listening\nDiscovery _[T1057](https://attack.mitre.org/techniques/T1057/)_ Process Discovery\non a particular port.\n\nPortReuse backdoor communicates through commonly\n_[T1043](https://attack.mitre.org/techniques/T1043/)_ Commonly Used Port\nused ports.\n\nWinnti malware and ShadowPad use custom cryptographic\n_[T1024](https://attack.mitre.org/techniques/T1024/)_ Custom Cryptographic Protocol\nprotocols such as ZXShell-like encryption.\n\n_[T1001](https://attack.mitre.org/techniques/T1001/)_ Data Obfuscation ShadowPad C&C server URL is hidden in public webpages.\n\n\nCommand\nAnd Control\n\nImpact\n\n\nShadowPad uses public web pages to retrieve\n_[T1104](https://attack.mitre.org/techniques/T1104/)_ Multi-Stage Channels\nits second stage C&C server.\n\nStandard Application Layer Standard Application Layer Protocols are used\n_[T1071](https://attack.mitre.org/techniques/T1071/)_\nProtocol by PortReuse and ShadowPad.\n\nThe Winnti Group uses standard cryptographic protocols\n_[T1032](https://attack.mitre.org/techniques/T1032/)_ Standard Cryptographic Protocol\nsuch as RC4, RC5 and AES.\n\nExfiltration Over Command and PortReuse backdoor exfiltrates data over the Command\n_[T1041](https://attack.mitre.org/techniques/T1041/)_\nControl Channel and Control Channel.\n\nThe final stage of hijacked video games\n_[T1496](https://attack.mitre.org/techniques/T1496/)_ Resource Hijacking\nis a Monero miner (XMRig).\n\nThe Winnti Group introduces malicious code into\n_[T1492](https://attack.mitre.org/techniques/T1492/)_ Stored Data Manipulation\nlegitimate software.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        },
        {
            "id": "6fc23d14-23a6-4870-8fad-b291b182596f",
            "created_at": "2022-10-25T16:07:18.480113Z",
            "updated_at": "2022-10-25T16:07:18.480113Z",
            "deleted_at": null,
            "name": "ETDA",
            "url": "https://apt.etda.or.th",
            "description": "Threat Group Cards: A Threat Actor Encyclopedia",
            "reports": null
        },
        {
            "id": "bf5be533-fa31-4590-ae37-5761c97ffa34",
            "created_at": "2022-10-25T16:13:58.389257Z",
            "updated_at": "2022-10-25T16:13:58.389257Z",
            "deleted_at": null,
            "name": "Malpedia",
            "url": "https://malpedia.caad.fkie.fraunhofer.de",
            "description": "Malpedia is a free service offered by Fraunhofer FKIE",
            "reports": null
        },
        {
            "id": "5910e58f-4bc9-4e4e-9dbb-887804094a01",
            "created_at": "2022-10-25T16:32:58.457399Z",
            "updated_at": "2022-10-25T16:32:58.457399Z",
            "deleted_at": null,
            "name": "OTX",
            "url": "https://otx.alienvault.com",
            "description": "Alienvault Open Threat Exchange (OTX)",
            "reports": null
        }
    ],
    "references": [
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2019/2019.10.10.Winnti_Group/ESET_Winnti.pdf",
        "https://www.welivesecurity.com/wp-content/uploads/2019/10/ESET_Winnti.pdf"
    ],
    "report_names": [
        "ESET_Winnti",
        "ESET_Winnti.pdf"
    ],
    "threat_actors": [
        {
            "id": "aada2650-7bef-45e4-8371-18c4318a7056",
            "created_at": "2022-10-25T15:50:23.422502Z",
            "updated_at": "2025-03-27T02:00:55.465428Z",
            "deleted_at": null,
            "main_name": "Suckfly",
            "aliases": [
                "Suckfly"
            ],
            "source_name": "MITRE:Suckfly",
            "tools": [
                "Nidiran"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "cea5ceec-0f14-4e34-bd0e-4074bc1a707d",
            "created_at": "2022-10-25T15:50:23.629983Z",
            "updated_at": "2025-03-27T02:00:55.509459Z",
            "deleted_at": null,
            "main_name": "Axiom",
            "aliases": [
                "Group 72"
            ],
            "source_name": "MITRE:Axiom",
            "tools": [
                "ZxShell",
                "gh0st RAT",
                "Zox",
                "PlugX",
                "Hikit",
                "PoisonIvy",
                "Derusbi",
                "Hydraq"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "cf0704ab-99e4-44d7-96d9-3cba91339229",
            "created_at": "2022-10-25T15:50:23.485375Z",
            "updated_at": "2025-03-27T02:00:55.482473Z",
            "deleted_at": null,
            "main_name": "Group5",
            "aliases": [
                "Group5"
            ],
            "source_name": "MITRE:Group5",
            "tools": [
                "njRAT",
                "NanoCore"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "9aa9b489-a297-4dbd-8601-8fc0370201a6",
            "created_at": "2022-10-25T16:07:23.696796Z",
            "updated_at": "2025-03-27T02:02:09.928416Z",
            "deleted_at": null,
            "main_name": "Group5",
            "aliases": [],
            "source_name": "ETDA:Group5",
            "tools": [
                "Atros2.CKPN",
                "Bladabindi",
                "DroidJack",
                "Jorik",
                "Nancrat",
                "NanoCore",
                "NanoCore RAT",
                "Zurten",
                "njRAT"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "4b076dcb-516e-42fb-9c8f-f153902cd5e9",
            "created_at": "2022-10-25T16:07:23.708745Z",
            "updated_at": "2025-03-27T02:02:09.935617Z",
            "deleted_at": null,
            "main_name": "Hidden Lynx",
            "aliases": [
                "Aurora Panda",
                "Group 8",
                "Hidden Lynx",
                "Operation SMN"
            ],
            "source_name": "ETDA:Hidden Lynx",
            "tools": [
                "AGENT.ABQMR",
                "AGENT.AQUP.DROPPER",
                "AGENT.BMZA",
                "AGENT.GUNZ",
                "BlackCoffee",
                "HiKit",
                "MCRAT.A",
                "Mdmbot.E",
                "Moudoor",
                "Naid",
                "PNGRAT",
                "Trojan.Naid",
                "ZoxPNG",
                "gresim"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "d90307b6-14a9-4d0b-9156-89e453d6eb13",
            "created_at": "2022-10-25T16:07:23.773944Z",
            "updated_at": "2025-03-27T02:02:09.974695Z",
            "deleted_at": null,
            "main_name": "Lead",
            "aliases": [
                "Casper",
                "TG-3279"
            ],
            "source_name": "ETDA:Lead",
            "tools": [
                "Agentemis",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "RbDoor",
                "RibDoor",
                "Winnti",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "a4a3c2a4-992d-4ce6-8c97-e39b23da9a26",
            "created_at": "2022-10-25T16:07:24.242051Z",
            "updated_at": "2025-03-27T02:02:10.148675Z",
            "deleted_at": null,
            "main_name": "Suckfly",
            "aliases": [],
            "source_name": "ETDA:Suckfly",
            "tools": [
                "Backdoor.Nidiran",
                "Nidiran",
                "WCE",
                "Windows Credential Editor",
                "Windows Credentials Editor",
                "gsecdump",
                "smbscan"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "1c97ccfd-1888-492c-b7b9-bb52c4c3809b",
            "created_at": "2023-01-06T13:46:38.940529Z",
            "updated_at": "2025-03-27T02:00:02.957652Z",
            "deleted_at": null,
            "main_name": "Operation ShadowHammer",
            "aliases": [],
            "source_name": "MISPGALAXY:Operation ShadowHammer",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "2864e40a-f233-4618-ac61-b03760a41cbb",
            "created_at": "2023-12-01T02:02:34.272108Z",
            "updated_at": "2025-03-27T02:02:10.209072Z",
            "deleted_at": null,
            "main_name": "WildCard",
            "aliases": [],
            "source_name": "ETDA:WildCard",
            "tools": [
                "RustDown",
                "SysJoker"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "5bbced13-72f7-40dc-8c41-dcce75bf885e",
            "created_at": "2022-10-25T15:50:23.695735Z",
            "updated_at": "2025-03-27T02:00:55.525839Z",
            "deleted_at": null,
            "main_name": "Winnti Group",
            "aliases": [
                "Winnti Group"
            ],
            "source_name": "MITRE:Winnti Group",
            "tools": [
                "PipeMon",
                "Winnti for Windows",
                "PlugX"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "49822165-5541-423d-8808-1c0a9448d588",
            "created_at": "2022-10-25T16:07:23.384093Z",
            "updated_at": "2025-03-27T02:02:09.772829Z",
            "deleted_at": null,
            "main_name": "Barium",
            "aliases": [
                "Brass Typhoon",
                "Pigfish"
            ],
            "source_name": "ETDA:Barium",
            "tools": [
                "Agent.dhwf",
                "Agentemis",
                "Barlaiy",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "Destroy RAT",
                "DestroyRAT",
                "Kaba",
                "Korplug",
                "POISONPLUG",
                "PlugX",
                "RbDoor",
                "RedDelta",
                "RibDoor",
                "Sogu",
                "TIGERPLUG",
                "TVT",
                "Thoper",
                "Winnti",
                "Xamtrav",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "f8dddd06-da24-4184-9e24-4c22bdd1cbbf",
            "created_at": "2023-01-06T13:46:38.626906Z",
            "updated_at": "2025-03-27T02:00:02.877001Z",
            "deleted_at": null,
            "main_name": "Tick",
            "aliases": [
                "Stalker Taurus",
                "PLA Unit 61419",
                "Nian",
                "BRONZE BUTLER",
                "REDBALDKNIGHT",
                "STALKER PANDA",
                "G0060"
            ],
            "source_name": "MISPGALAXY:Tick",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "5c74936a-79d1-41b8-81eb-01d03c90a26b",
            "created_at": "2022-10-25T16:07:23.371052Z",
            "updated_at": "2025-03-27T02:02:09.766782Z",
            "deleted_at": null,
            "main_name": "Axiom",
            "aliases": [
                "Group 72",
                "Operation SMN"
            ],
            "source_name": "ETDA:Axiom",
            "tools": [
                "9002 RAT",
                "Agent.dhwf",
                "AngryRebel",
                "BlackCoffee",
                "BleDoor",
                "Chymine",
                "Darkmoon",
                "DeputyDog",
                "Derusbi",
                "Destroy RAT",
                "DestroyRAT",
                "Farfli",
                "Fexel",
                "Gen:Trojan.Heur.PT",
                "Gh0st RAT",
                "Ghost RAT",
                "Gresim",
                "HOMEUNIX",
                "HiKit",
                "HidraQ",
                "Homux",
                "Hydraq",
                "Kaba",
                "Korplug",
                "McRAT",
                "MdmBot",
                "Moudour",
                "Mydoor",
                "PCRat",
                "PNGRAT",
                "PlugX",
                "Poison Ivy",
                "RbDoor",
                "RedDelta",
                "RibDoor",
                "Roarur",
                "SPIVY",
                "Sensocode",
                "Sogu",
                "TIGERPLUG",
                "TVT",
                "Thoper",
                "Winnti",
                "Xamtrav",
                "ZXShell",
                "Zox",
                "ZoxPNG",
                "ZoxRPC",
                "gresim",
                "pivy",
                "poisonivy"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "761d1fb2-60e3-46f0-9f1c-c8a9715967d4",
            "created_at": "2023-01-06T13:46:38.269054Z",
            "updated_at": "2025-03-27T02:00:02.789278Z",
            "deleted_at": null,
            "main_name": "APT3",
            "aliases": [
                "TG-0110",
                "Group 6",
                "Buckeye",
                "Boyusec",
                "BORON",
                "BRONZE MAYFAIR",
                "Red Sylvan",
                "GOTHIC PANDA"
            ],
            "source_name": "MISPGALAXY:APT3",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "945a572f-ebe3-4e2f-a288-512fe751cfa8",
            "created_at": "2022-10-25T16:07:24.413971Z",
            "updated_at": "2025-03-27T02:02:10.212853Z",
            "deleted_at": null,
            "main_name": "Winnti Group",
            "aliases": [
                "Wicked Panda",
                "Winnti Group"
            ],
            "source_name": "ETDA:Winnti Group",
            "tools": [
                "Agentemis",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "FunnySwitch",
                "RbDoor",
                "RibDoor",
                "RouterGod",
                "Winnti",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "7b039cc0-33b6-495a-b4ca-649d096b993d",
            "created_at": "2023-01-06T13:46:38.482654Z",
            "updated_at": "2025-03-27T02:00:02.845093Z",
            "deleted_at": null,
            "main_name": "APT22",
            "aliases": [
                "BRONZE OLIVE",
                "Group 46",
                "G0039",
                "Suckfly"
            ],
            "source_name": "MISPGALAXY:APT22",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "a7aefdda-98f1-4790-a32d-14cc99de2d60",
            "created_at": "2023-01-06T13:46:38.281844Z",
            "updated_at": "2025-03-27T02:00:02.792526Z",
            "deleted_at": null,
            "main_name": "APT17",
            "aliases": [
                "G0025",
                "AURORA PANDA",
                "Group 72",
                "G0001",
                "HELIUM",
                "Group 8",
                "Hidden Lynx",
                "Tailgater Team",
                "BRONZE KEYSTONE"
            ],
            "source_name": "MISPGALAXY:APT17",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "1d0f389f-2f6c-415d-91f4-633bd6c645f7",
            "created_at": "2024-05-01T02:03:07.974188Z",
            "updated_at": "2025-03-27T02:05:17.280317Z",
            "deleted_at": null,
            "main_name": "BRONZE OLIVE",
            "aliases": [
                "Barista",
                "Group 46 ",
                "Suckfly ",
                "APT22 "
            ],
            "source_name": "Secureworks:BRONZE OLIVE",
            "tools": [
                " DestroyRAT",
                " PlugX",
                " TCP/ICMP RAT",
                "Angryrebel"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "4c68ccd0-caba-4189-9ead-86ac4c2d9b70",
            "created_at": "2024-05-01T02:03:07.930196Z",
            "updated_at": "2025-03-27T02:05:17.251237Z",
            "deleted_at": null,
            "main_name": "BRONZE ATLAS",
            "aliases": [
                "Axiom",
                "BARIUM ",
                "Blackfly ",
                "CTG-2633",
                "GREF",
                "Group 72 ",
                "Red Kelpie ",
                "TG-2633 ",
                "Wicked Panda ",
                "Winnti",
                "APT41 "
            ],
            "source_name": "Secureworks:BRONZE ATLAS",
            "tools": [
                " CCleaner v5.33 backdoor",
                " ChinaChopper",
                " Cobalt Strike",
                " Dicey MSDN",
                " ForkPlayground",
                " HUC Proxy Malware (Htran)",
                " Mimikatz",
                " PipeMon",
                " PlugX",
                " PortReuse",
                " Powershell Empire",
                " RCMD",
                " RbDoor",
                " SPEEDBOAT",
                " ShadowPad",
                " Sidewalk",
                " Speculoos",
                " TeamViewer",
                " Winnkit",
                " Winnti",
                " reg save",
                " vssadmin",
                "Acehash"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "06f622cb-3a78-49cf-9a4c-a6007a69325f",
            "created_at": "2022-10-25T16:07:23.315239Z",
            "updated_at": "2025-03-27T02:02:09.733197Z",
            "deleted_at": null,
            "main_name": "APT 3",
            "aliases": [
                "APT 3",
                "Bronze Mayfair",
                "Buckeye",
                "Gothic Panda",
                "Group 6",
                "Operation Clandestine Fox",
                "Operation Clandestine Fox, Part Deux",
                "Operation Clandestine Wolf",
                "Operation Double Tap",
                "Red Sylvan",
                "TG-0110",
                "UPS Team"
            ],
            "source_name": "ETDA:APT 3",
            "tools": [
                "APT3 Keylogger",
                "Agent.dhwf",
                "BKDR_HUPIGON",
                "Backdoor.APT.CookieCutter",
                "Badey",
                "Bemstour",
                "CookieCutter",
                "Destroy RAT",
                "DestroyRAT",
                "DoublePulsar",
                "EXL",
                "EternalBlue",
                "HTran",
                "HUC Packet Transmit Tool",
                "Hupigon",
                "Hupigon RAT",
                "Kaba",
                "Korplug",
                "LaZagne",
                "MFC Huner",
                "OSInfo",
                "Pirpi",
                "PlugX",
                "RedDelta",
                "RemoteCMD",
                "SHOTPUT",
                "Sogu",
                "TIGERPLUG",
                "TTCalc",
                "TVT",
                "Thoper",
                "Xamtrav",
                "remotecmd",
                "shareip",
                "w32times"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "c7d9878a-e691-4c6f-81ae-84fb115a1345",
            "created_at": "2022-10-25T16:07:23.359506Z",
            "updated_at": "2025-03-27T02:02:09.752427Z",
            "deleted_at": null,
            "main_name": "APT 41",
            "aliases": [
                "BrazenBamboo",
                "Bronze Atlas",
                "Double Dragon",
                "Earth Baku",
                "Grayfly",
                "Operation ColunmTK",
                "Operation CuckooBees",
                "Operation ShadowHammer",
                "Red Kelpie",
                "SparklingGoblin",
                "TA415",
                "TG-2633"
            ],
            "source_name": "ETDA:APT 41",
            "tools": [
                "9002 RAT",
                "ADORE.XSEC",
                "ASPXSpy",
                "ASPXTool",
                "AceHash",
                "Agent.dhwf",
                "Agentemis",
                "AndroidControl",
                "AngryRebel",
                "AntSword",
                "BIOPASS",
                "BIOPASS RAT",
                "BLUEBEAM",
                "Barlaiy",
                "BlackCoffee",
                "Bladabindi",
                "BleDoor",
                "CCleaner Backdoor",
                "CHINACHOPPER",
                "COLDJAVA",
                "China Chopper",
                "ChyNode",
                "Cobalt Strike",
                "CobaltStrike",
                "Crackshot",
                "CrossWalk",
                "CurveLast",
                "CurveLoad",
                "DAYJOB",
                "DBoxAgent",
                "DEADEYE",
                "DEADEYE.APPEND",
                "DEADEYE.EMBED",
                "DEPLOYLOG",
                "DIRTCLEANER",
                "DUSTTRAP",
                "Derusbi",
                "Destroy RAT",
                "DestroyRAT",
                "DodgeBox",
                "DragonEgg",
                "ELFSHELF",
                "EasyNight",
                "Farfli",
                "FunnySwitch",
                "Gh0st RAT",
                "Ghost RAT",
                "HDD Rootkit",
                "HDRoot",
                "HKDOOR",
                "HOMEUNIX",
                "HUI Loader",
                "HidraQ",
                "HighNoon",
                "HighNote",
                "Homux",
                "Hydraq",
                "Jorik",
                "Jumpall",
                "KEYPLUG",
                "Kaba",
                "Korplug",
                "LATELUNCH",
                "LOLBAS",
                "LOLBins",
                "LightSpy",
                "Living off the Land",
                "Lowkey",
                "McRAT",
                "MdmBot",
                "MessageTap",
                "Meterpreter",
                "Mimikatz",
                "MoonBounce",
                "MoonWalk",
                "Motnug",
                "Moudour",
                "Mydoor",
                "NTDSDump",
                "PACMAN",
                "PCRat",
                "PINEGROVE",
                "PNGRAT",
                "POISONPLUG",
                "POISONPLUG.SHADOW",
                "POTROAST",
                "PRIVATELOG",
                "PipeMon",
                "PlugX",
                "PortReuse",
                "ProxIP",
                "ROCKBOOT",
                "RbDoor",
                "RedDelta",
                "RedXOR",
                "RibDoor",
                "Roarur",
                "RouterGod",
                "SAGEHIRE",
                "SPARKLOG",
                "SQLULDR2",
                "STASHLOG",
                "SWEETCANDLE",
                "ScrambleCross",
                "Sensocode",
                "SerialVlogger",
                "ShadowHammer",
                "ShadowPad Winnti",
                "SinoChopper",
                "Skip-2.0",
                "SneakCross",
                "Sogu",
                "Speculoos",
                "Spyder",
                "StealthReacher",
                "StealthVector",
                "TERA",
                "TIDYELF",
                "TIGERPLUG",
                "TOMMYGUN",
                "TVT",
                "Thoper",
                "Voldemort",
                "WIDETONE",
                "WINNKIT",
                "WINTERLOVE",
                "Winnti",
                "WyrmSpy",
                "X-Door",
                "XDOOR",
                "XMRig",
                "XShellGhost",
                "Xamtrav",
                "ZXShell",
                "ZoxPNG",
                "certutil",
                "certutil.exe",
                "cobeacon",
                "gresim",
                "njRAT",
                "pwdump",
                "xDll"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "d4e7cd9a-2290-4f89-a645-85b9a46d004b",
            "created_at": "2022-10-25T16:07:23.419513Z",
            "updated_at": "2025-03-27T02:02:09.790389Z",
            "deleted_at": null,
            "main_name": "Bronze Butler",
            "aliases": [
                "Bronze Butler",
                "CTG-2006",
                "Operation ENDTRADE",
                "RedBaldNight",
                "Stalker Panda",
                "Stalker Taurus",
                "TEMP.Tick",
                "Tick"
            ],
            "source_name": "ETDA:Bronze Butler",
            "tools": [
                "8.t Dropper",
                "8.t RTF exploit builder",
                "8t_dropper",
                "9002 RAT",
                "AngryRebel",
                "Blogspot",
                "Daserf",
                "Datper",
                "Elirks",
                "Farfli",
                "Gh0st RAT",
                "Ghost RAT",
                "HOMEUNIX",
                "HidraQ",
                "HomamDownloader",
                "Homux",
                "Hydraq",
                "Lilith",
                "Lilith RAT",
                "McRAT",
                "MdmBot",
                "Mimikatz",
                "Minzen",
                "Moudour",
                "Muirim",
                "Mydoor",
                "Nioupale",
                "PCRat",
                "POISONPLUG.SHADOW",
                "Roarur",
                "RoyalRoad",
                "ShadowPad Winnti",
                "ShadowWali",
                "ShadowWalker",
                "SymonLoader",
                "WCE",
                "Wali",
                "Windows Credential Editor",
                "Windows Credentials Editor",
                "XShellGhost",
                "XXMM",
                "gsecdump",
                "rarstar"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "4d5f939b-aea9-4a0e-8bff-003079a261ea",
            "created_at": "2023-01-06T13:46:39.04841Z",
            "updated_at": "2025-03-27T02:00:02.985296Z",
            "deleted_at": null,
            "main_name": "APT41",
            "aliases": [
                "G0096",
                "Grayfly",
                "BARIUM",
                "BRONZE ATLAS",
                "BRONZE EXPORT",
                "Red Kelpie",
                "HOODOO",
                "Brass Typhoon",
                "TA415",
                "WICKED SPIDER",
                "WICKED PANDA",
                "G0044",
                "Earth Baku"
            ],
            "source_name": "MISPGALAXY:APT41",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "bf0489c5-1c07-41e6-91c9-855ad96ccc6a",
            "created_at": "2022-10-25T16:47:55.541639Z",
            "updated_at": "2025-03-27T02:05:17.253496Z",
            "deleted_at": null,
            "main_name": "BRONZE BUTLER",
            "aliases": [
                "Daserf",
                "Stalker Panda ",
                "Tick ",
                "CTG-2006 "
            ],
            "source_name": "Secureworks:BRONZE BUTLER",
            "tools": [
                " DGet",
                " Daserf",
                " Datper",
                " Gofarer",
                " MSGet",
                " Mimikatz",
                " RarStar",
                " Screen Capture Tool",
                " ShadowPad",
                " T-SMB",
                " WinRAR",
                " Windows Credential Editor",
                " gsecdump",
                " xmm downloader",
                " xxmm",
                "ABK"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "1edcac0b-efd9-47b1-9aca-33827d5bd085",
            "created_at": "2024-05-01T02:03:07.964773Z",
            "updated_at": "2025-03-27T02:05:17.273595Z",
            "deleted_at": null,
            "main_name": "BRONZE KEYSTONE",
            "aliases": [
                "Aurora Panda ",
                "DeputyDog ",
                "Group 72 ",
                "Hidden Lynx ",
                "Shell Crew",
                "TG-8153 ",
                "Tailgater Team",
                "APT17 "
            ],
            "source_name": "Secureworks:BRONZE KEYSTONE",
            "tools": [
                " BlackCoffee",
                " DeputyDog",
                " Derusbi",
                " Gh0stHTTPSDropper",
                " HiKit",
                " InternalCMD",
                " PlugX",
                " PoisonIvy",
                " ZxShell",
                "9002"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "e698860d-57e8-4780-b7c3-41e5a8314ec0",
            "created_at": "2022-10-25T15:50:23.287929Z",
            "updated_at": "2025-03-27T02:00:55.43005Z",
            "deleted_at": null,
            "main_name": "APT41",
            "aliases": [
                "APT41",
                "Wicked Panda",
                "Brass Typhoon",
                "BARIUM"
            ],
            "source_name": "MITRE:APT41",
            "tools": [
                "ASPXSpy",
                "BITSAdmin",
                "PlugX",
                "Impacket",
                "gh0st RAT",
                "netstat",
                "PowerSploit",
                "ZxShell",
                "KEYPLUG",
                "ipconfig",
                "sqlmap",
                "China Chopper",
                "ShadowPad",
                "MESSAGETAP",
                "Mimikatz",
                "certutil",
                "njRAT",
                "Cobalt Strike",
                "pwdump",
                "BLACKCOFFEE",
                "ROCKBOOT",
                "dsquery",
                "Winnti for Linux",
                "DUSTTRAP",
                "Derusbi",
                "ftp"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "256a6a2d-e8a2-4497-b399-628a7fad4b3e",
            "created_at": "2023-11-30T02:00:07.299845Z",
            "updated_at": "2025-03-27T02:00:03.257794Z",
            "deleted_at": null,
            "main_name": "WildCard",
            "aliases": [],
            "source_name": "MISPGALAXY:WildCard",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1666716497,
    "ts_updated_at": 1743041799,
    "ts_creation_date": 1570463118,
    "ts_modification_date": 1570698840,
    "files": {
        "pdf": "https://archive.orkl.eu/fa008c2924f69b019af1924b429744d76ca11e1f.pdf",
        "text": "https://archive.orkl.eu/fa008c2924f69b019af1924b429744d76ca11e1f.txt",
        "img": "https://archive.orkl.eu/fa008c2924f69b019af1924b429744d76ca11e1f.jpg"
    }
}