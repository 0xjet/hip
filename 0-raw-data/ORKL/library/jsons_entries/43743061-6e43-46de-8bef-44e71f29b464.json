{
    "id": "43743061-6e43-46de-8bef-44e71f29b464",
    "created_at": "2023-01-12T15:00:23.105731Z",
    "updated_at": "2025-03-27T02:16:39.998841Z",
    "deleted_at": null,
    "sha1_hash": "fec1cab00acf3a57f1667ff0cf2b7bb021aade93",
    "title": "2021-12-10 - BlackCatConf - Static Configuration Extractor for BlackCat Ransomware",
    "authors": "",
    "file_creation_date": "2022-05-28T01:29:21Z",
    "file_modification_date": "2022-05-28T01:29:21Z",
    "file_size": 313261,
    "plain_text": "# blackCatConf\n\n**github.com/f0wl/blackCatConf**\n\nf0wl\n\n[go reportgo report A+A+](https://goreportcard.com/report/github.com/f0wl/blackCatConf)\n\nblackCatConf is a static configuration extractor implemented in Golang for BlackCat Ransomware\n(targeting Microsoft Windows and GNU/Linux + VMware ESXi). By default the script will print the\nextracted information to stdout. It is also capable of dumping the malware configuration to disk as a\nJSON file with the `-j flag.`\n\n**[Info: This tool does currently not support the new version of BlackCat/ALPHV ransomware.](https://twitter.com/vxunderground/status/1504207503734804484)**\n\n### Usage\n```\ngo run blackcatconf.go [-j] path/to/blackcat_sample.bin\n\n## Screenshots\n\n```\nSensitive victim information in the screenshot below and the example config file has been redacted.\n\n\n-----\n\n## Configuration structure\n\nWith these novel BlackCat Ransomware samples this config extractor could easily be replaced by a\nbash one-liner (e.g. `strings ... | grep \"{\\\"config_id\" > config.json ), but I expect that there`\nwill be config obfuscation/encryption added in future samples of BlackCat, similar to e.g. the changes\nmade in Darkside Ransomware over time. If this is the case here as well having a structure to\nunmarshal the json config into will save me some time down the road.\n\nSpeaking of Darkside/BlackMatter: The configuration structure and values of BlackCat share significant\nsimilarities with those found in BlackMatter. The Korean Threat Intelligence company S2W Lab\n[published a thorough analysis of the similarities between these two Ransomware strains.](https://medium.com/s2wlab/blackcat-new-rust-based-ransomware-borrowing-blackmatters-configuration-31c8d330a809)\n\n**Key** **Value / Purpose** **Type**\n\n\nconfig_id Configuration ID, empty up until now (= Victim\nIdentifier?)\n\n\nunknown\n\n\npublic_key RSA Public Key (Base64 encoded) string\n\nextension Extension for encrypted files string\n\nnote file name Filename of the Ransomnote string\n\n\n-----\n\n**Key** **Value / Purpose** **Type**\n\nnote_full_text Long version of the Ransomnote string\n\nnote_short_text Short version of the Ransomnote string\n\n\ndefault_file_mode File Encryption Mode (observed: \"auto\" and\n\"Smartpattern\")\n\n\nstring or\n\n[]int\n\n\ndefault_file_cipher File Encryption Cipher (observed: \"Best\") string\n\n\ncredentials Array of compromised credentials for escalation and\npropagation\n\n\n\n[][]string\n\n\nkill_services List of services to be terminated []string\n\nkill_processes List of processes to be terminated []string\n\n\nexclude_directory_names Directories that are excluded from the encryption\nprocess\n\n\n\n[]string\n\n\nexclude_file_names Files that are excluded from the encryption process []string\n\n\nexclude_file_extensions File extensions that are excluded from the encryption\nprocess\n\n\n\n[]string\n\n\nexclude_file_path_wildcard Filepaths to be excluded via wildcard []string (?)\n\nenable_network_discovery Switch to enable/disable network discovery bool\n\nenable_self_propagation Switch to enable/disable self propagation bool\n\nenable_set_wallpaper Switch to enable/disable wallpaper change bool\n\nenable_esxi_vm_kill Switch to enable/disable VM termination on ESXi Hosts bool\n\n\nenable_esxi_vm_snapshot_kill Switch to enable/disable Snapshot deletion on ESXi\nHosts\n\n\nbool\n\n\nstrict_include_paths Hardcoded filepaths (likely victim-specific) []string (?)\n\nesxi_vm_kill_exclude Exclusion list for virtual machines on ESXi Hosts []string (?)\n\n## Testing\n\nThis configuration extractor has been tested successfully with the following samples:\n\n**SHA-256** **OS** **Sample**\n\n59868f4b346bd401e067380cac69080709c86e06fae219bfb5bc17605a71ab3f Windows Malware\nBazaar\n\n731adcf2d7fb61a8335e23dbee2436249e5d5753977ec465754c6b699e9bf161 Windows Malware\nBazaar\n\n5121f08cf8614a65d7a86c2f462c0694c132e2877a7f54ab7fcefd7ee5235a42 Linux VXUnderground\n\n\n-----\n\n**SHA-256** **OS** **Sample**\n\nf8c08d00ff6e8c6adb1a93cd133b19302d0b651afd73ccb54e3b6ac6c60d99c6 Linux VXUnderground\n\nIf you encounter an error with blackCatConf, please file a bug report via an issue. Contributions are\nalways welcome :)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-12-10 - BlackCatConf - Static Configuration Extractor for BlackCat Ransomware.pdf"
    ],
    "report_names": [
        "2021-12-10 - BlackCatConf - Static Configuration Extractor for BlackCat Ransomware.pdf"
    ],
    "threat_actors": [
        {
            "id": "2864e40a-f233-4618-ac61-b03760a41cbb",
            "created_at": "2023-12-01T02:02:34.272108Z",
            "updated_at": "2025-03-27T02:02:10.209072Z",
            "deleted_at": null,
            "main_name": "WildCard",
            "aliases": [],
            "source_name": "ETDA:WildCard",
            "tools": [
                "RustDown",
                "SysJoker"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "6e23ce43-e1ab-46e3-9f80-76fccf77682b",
            "created_at": "2022-10-25T16:07:23.303713Z",
            "updated_at": "2025-03-27T02:02:09.727245Z",
            "deleted_at": null,
            "main_name": "ALPHV",
            "aliases": [
                "ALPHV",
                "ALPHVM",
                "BlackCat Gang",
                "UNC4466"
            ],
            "source_name": "ETDA:ALPHV",
            "tools": [
                "ALPHV",
                "ALPHVM",
                "BlackCat",
                "GO Simple Tunnel",
                "GOST",
                "Impacket",
                "LaZagne",
                "MEGAsync",
                "Mimikatz",
                "Munchkin",
                "Noberus",
                "PsExec",
                "Remcom",
                "RemoteCommandExecution",
                "WebBrowserPassView"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "256a6a2d-e8a2-4497-b399-628a7fad4b3e",
            "created_at": "2023-11-30T02:00:07.299845Z",
            "updated_at": "2025-03-27T02:00:03.257794Z",
            "deleted_at": null,
            "main_name": "WildCard",
            "aliases": [],
            "source_name": "MISPGALAXY:WildCard",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673535623,
    "ts_updated_at": 1743041799,
    "ts_creation_date": 1653701361,
    "ts_modification_date": 1653701361,
    "files": {
        "pdf": "https://archive.orkl.eu/fec1cab00acf3a57f1667ff0cf2b7bb021aade93.pdf",
        "text": "https://archive.orkl.eu/fec1cab00acf3a57f1667ff0cf2b7bb021aade93.txt",
        "img": "https://archive.orkl.eu/fec1cab00acf3a57f1667ff0cf2b7bb021aade93.jpg"
    }
}