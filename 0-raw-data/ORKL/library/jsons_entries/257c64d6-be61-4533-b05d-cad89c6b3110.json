{
    "id": "257c64d6-be61-4533-b05d-cad89c6b3110",
    "created_at": "2023-01-12T15:09:11.316578Z",
    "updated_at": "2025-03-27T02:05:34.22727Z",
    "deleted_at": null,
    "sha1_hash": "52be3fdc42a5b6801012cb132c744d6c44d31584",
    "title": "2014-08-07 - Innaput Actors Utilize Remote Access Trojan Since 2016, Presumably Targeting Victim Files",
    "authors": "",
    "file_creation_date": "2022-05-28T21:51:32Z",
    "file_modification_date": "2022-05-28T21:51:32Z",
    "file_size": 371240,
    "plain_text": "# Innaput Actors Utilize Remote Access Trojan Since 2016, Presumably Targeting Victim Files\n\n**[asert.arbornetworks.com/innaput-actors-utilize-remote-access-trojan-since-2016-presumably-targeting-victim-files/](https://asert.arbornetworks.com/innaput-actors-utilize-remote-access-trojan-since-2016-presumably-targeting-victim-files/)**\n\n\nNETSCOUT Blog\n\n\nby [ASERT Team on April 4th, 2018](https://www.netscout.com/blog/asert/asert-team)\n\n## Overview\n\nASERT recently identified a campaign targeting commercial manufacturing in the US and\npotentially Europe in late 2017.  The threat actors used phishing and downloader(s) to install\na Remote Access Trojan (RAT) ASERT calls InnaputRAT on the target's machine. The RAT\ncontained a series of commands that includes machine profiling and the ability to exfiltrate\ndocuments from the victims’ machines. We believe this activity ties to a specific set of actors\nwith defined campaign goals. We’ve also observed similarities in binaries dating back to\n2016, a clear indication that these threat actors have operated for nearly two years.\n\n## Key Findings\n\n\n-----\n\nInnaputRAT, a RAT capable of exfiltrating files from victim machines, was distributed by\nthreat actors using phishing and Godzilla Loader.\nThe RAT has evolved through multiple variants dating back to 2016.\nRecent campaigns distributing InnaputRAT beaconed to live C2 as of March 26, 2018.\n\nFigure 1: InnaputRAT communicating to TOP\n\ndomains.\n\n## Attribution\n\nASERT identified potential actors, or personas, tied to this campaign through domains\nregistrations, Facebook, and Twitter accounts possibly tied to an email address used. We\ninitially identified the campaign through several phishing attempts that led to additional\ninfrastructure within the same campaign. This campaign shared a common malware payload,\nInnaputRAT. Some of the recent malware samples were attributed to the campaign through\nsimilarities in the binary rather than connected infrastructure. The phishing emails appear to\nlure victims with a geopolitical-theme. Sender email addresses and subject lines often\nreference the United Nations (UN). Further, while most of the domains associated with\nAigul(Aygul) Akulova and Slabodan Miloshevich attempt to mimic Google or Microsoft\nproducts, a few of them were more specific in mimicking diplomacy related targets, notably\nun-booklet[.]com and us-embassy-report[.]com, suggesting a more specific audience. We\nidentified the initial campaign through domains highlighted in the Phishing Domains section\nbelow. After analysis of the original infrastructure, we identified the InnaputRAT payload on\nadditional infrastructure highlighted in the Additional Domains Section.\n\n## Phishing Domains\n\n1. mfa-events[.]com\n2. officeonlaine[.]com\n3. blockhain[.]name\n4. iceerd[.]com\n\nAll of these domains are tied to the email address s.miloshevich[@]yandex.ru with the\nregistration name Slabodan Miloshevich. Each of the domains used Kazakhstan as the\nregistrant's country. Additional domains registered by the same entity resolved to 4 distinct\n\n\n-----\n\nIP addresses (as of March 24. 2017). Figure 2:\n\nDomains registered by s.miloshevich[@]yandex.ru\n\n## Additional Domain Analysis\n\n1. mfa-events[.]top\n2. officemicroupdate[.]com\n3. ico-investmen[.]com\n\nIn the prior section we associated the first domain with s.miloshevich[@]yandex.ru. The\nactor behind innaput69[@]gmail.com registered domains two and three. All three domains\nhosted either a variant or the primary sample we analyzed, thus tying them together as part\nof the same activity. Looking at the domains registered by innaput69[@]gmail.com, the\nnames on the account use the same last name but use two different first names. Notice all\n\nbut one list the registrant contact country as RU.\n\n[Figure 3: Domains tied to innaput69@gmail[.]com](http://10.10.0.46/mailto:innaput69@gmail)\n\nTo find officemicroupdate[.]com we must dig through some historical domain registrar\ninformation. From March 1, 2017 – November 2, 2017 the registrant email was\ninnaput69[@]gmail.com (according to Domain Tools) before the URL was taken over by\nMicrosoft. Prior to March 1 of 2017 the registrant info was hidden behind a Privacyst\nProtected Record so it is possible it was registered at one time by someone other than the\nactor behind innaput69[@]gmail.com.\n\n### GodZilla Loader Link\n\n\n-----\n\nPivoting off of the phone number for Aygul A Akulova in figure 3 we find another email\naddress, jemesn[@]mail.ru. This email address is tied to a couple of other domains as well.\n\nFigure 4: Registrant info for jemesn[@]mail.ru\n\nOne of the domains associated with jemesn[@]mail.ru, update-app[.]top, hosted a copy of\nGodzilla Loader which we observed distributing InnaputRAT late March 2018.\n\n## InnaputRAT Evolution\n\nAll of the infrastructure and registrants were tied together with a common malware payload,\nInnaputRAT. We identified a recent version of the InnaputRAT through the initial phishing\ncampaigns, infastructure correlation, and binary analysis. We then found several variations\nof the malware dating back to 2016. The binaries are listed below in chronological order. Our\nstarting sample (5249a165de139c62cb9615c0e787a856) is listed as Sample 3 (below). We\ncompared the binaries using Diaphora, an open source tool for comparing programs in a\ndecompiler, and extracted relevant information showing the RAT’s evolution.\n\n## Sample 1 - May, 29 2016\n\n**MD5** 2939d7350f611263596bdc0917296aa3\n\n**Compile date** 2016-05-29 13:38:07\n\n**PDB** N/A\n\n**ITW** N/A\n\n**C2s:** officemicroupdate[.]com\n\n\n**Communication**\n**Port:**\n\n\n5876\n\n\n**File Name:** msupdate.exe\n\n**Persistence:** Maldoc (27dac1fa017006933eaf2b044df0b443) drops a Dropper that\ncreates a Windows Service (OfficeUpdateService) and executes the\npayload\n\n\n-----\n\n**Command**\n**Options**\n\n**Diaphora**\n**Function Match**\n**Stats**\n\n\nFunction Name: sub_401737\n\n1. GetDriveAndVolInfo\n2. GetFileAttributeW\n3. EnumDirectory\n4. ReadFile (CreateFileMapping -> MapViewOfFile)\n5. WriteFile\n6. DeleteFile\n7. ShellExecuteW\n8. GetSystemInfo\n\nMatches: 14 Unmatched: 30 - Includes sub_401737\n\n\n**Notes:** Dropped via: 27dac1fa017006933eaf2b044df0b443\nLinked to officemicroupdate[.]com via 185[.]61[.]151[.]110\n\nTable 1: Sample 1 Analysis\n\nWe believe this to be an earlier variant of for the following reasons:\n\nThe “Command Options” used reflect later variants. The order of the options also\nreflects other variants.\nAlthough it doesn’t share as many matching functions as other samples, some of the\nbinary structure matched newer variants.\n\nWhile we believe this sample is from the same family as Samples 2 through 5 (below),\nthere are some notable differences that suggest the malware evolved over time:\n\nPersistence method\n\nThis sample makes use of a service installed by a dropper file. In contrast, other\nsamples use the Windows registry to install an Autorun key.\nNotably, the payload requires the dropper for execution and remains dormant if it\nis not present on the victim machine.\nWindows API Calls\n\nThe Read File command for this sample used CreateFileMapping and\nMapViewOfFile while newer samples used CreateFileW and ReadFile.\n\nThe key functionality of the payload remains the same across all binaries: browse the victim\nfile system with the intent to exfiltrate desired data.\n\n## Sample 2 - June 5, 2017\n\nSample 2 looks more like our starting point (Sample 3).\n\n\n-----\n\n**MD5** 8c3d37676f8f7711b381abf00155ef25\n\n**Compile date** 2017-06-05 16:57:38\n\n**PDB** D:\\Arena\\RobotNet\\FileTransferStream\\Release\\FileTransfer.pdb\n\n**ITW** hxxp://best-online-tv[.]com/1.exe\n\n**C2s:** worlwidesupport[.]top ninjagames[.]top ajdhsfhiudsfhsi[.]top\n\n\n**Communication**\n**Port:**\n\n\n52100\n\n\n**File Name:** SafeApp.exe\n\n**Persistence:** HKU\\<SID>\\Software\\Microsoft\\Windows\\CurrentVersion\\Run:\n%appdata%\\SafeApp\\SafeApp.exe\n\n**Command Options:** Function Name: sub_401B46\n\n1. GetDriveVolInfo\n2. GetFileAttributesW\n3. EnumDirectory\n4. ReadFile (CreateFileW + ReadFile)\n5. WriteFile\n6. DeleteFile\n7. ShellExecuteW\n8. GetSystemInfo\n\n\n**Diaphora Function**\n**Match Stats**\n\nTable 2: Sample 2 Analysis\n\n\nMatches: 36  - Includes sub_401B46 Unmatched: 4\n\n\nPerforming a diffing operation using Diaphora, most of the functions in the binary matched,\nincluding “Command Options” and C2s used. This provides an increased level of confidence\nthat Sample 2 is a variant of the “ground zero” binary in Sample 3 (below). The key\ndifference between later variants and Sample 1, involve the persistence mechanism used\nand a change in the Read File “Command Option”. Later variants no longer rely on the\ndropper to set persistence via Windows Service, but instead create the Windows Registry\nkey as seen in Table 2 and execute the malware.\n\n## Sample 3 - August 22, 2017\n\nSample 3, our starting sample, is a near exact match with Sample 2, but seen hosted on a\ndifferent server.\n\n\n-----\n\n**MD5** 5249a165de139c62cb9615c0e787a856\n\n**Compile date** 2017-08-22 15:58:14\n\n**PDB** N/A\n\n**ITW** hxxp://mfa-events[.]com/upd.exe\n\n**C2s:** worlwidesupport[.]top ninjagames[.]top ajdhsfhiudsfhsi[.]top\n\n\n**Communication**\n**Port**\n\n\n52100\n\n\n**File Name** NeutralApp.exe\n\n**Persistence** HKU\\<SID>\\Software\\Microsoft\\Windows\\CurrentVersion\\Run:\n%appdata%\\NeutralApp\\NeutralApp.exe\n\n**Command Options** Function Name: sub_401E39\n\n1. GetDriveVolInfo\n2. GetFileAttributesW\n3. EnumDirectory\n4. ReadFile (CreateFileW + ReadFile)\n5. WriteFile\n6. DeleteFile\n7. ShellExecuteW\n8. GetSystemInfo\n\n\n**Diaphora Function**\n**Match Stats**\n\nTable 3: Sample 3 Analysis\n\n\nNot done as this is the starting sample.\n\n\nThe primary difference between Sample 2 and this sample is the file name used by the\npayload. The prior version used the name SafeApp.exe and installed the binary into\n%AppData% and added a Windows auto run registry entry against that file. Sample 3 does\nthe same thing but makes the file name NeutralApp.exe. This is notable, because the\nmalware checks for a copy of itself, and the name is static making it simple to identify\ninfection. Due to the name change, the newer version runs even if SafeApp.exe is currently\nrunning on the victim machine.\n\n## Sample 4 - January 22, 2018\n\nContinuing binary matching and infrastructure analysis, we found a fourth sample that\nshowed more evolution of the binary by obfuscating some of the API names and strings. This\nbinary also shared the same NeutralApp.exe file name and the same C2s as the prior\nvariant. The “Command Options” also remained the same in this variant.\n\n\n-----\n\n**MD5** 4e61d5d9c2e0386a872232f8d33e76bc\n\n**Compile date** 2018-01-22 20:46:41\n\n**PDB** D:\\Arena\\RobotNet\\FileTransferStream\\Release\\FileTransfer.pdb\n\n**ITW** hxxp://ico-investmen[.]com/1.exe\n\n**C2s:** worlwidesupport[.]top ninjagames[.]top ajdhsfhiudsfhsi[.]top\n\n\n**Communication**\n**Port:**\n\n\n52100\n\n\n**File Name:** NeutralApp.exe\n\n**Persistence:** HKU\\<SID>\\Software\\Microsoft\\Windows\\CurrentVersion\\Run:\n%appdata%\\NeutralApp\\NeutralApp.exe\n\n**Command Options** Function Name: sub_401F95 No change\n\n\n**Diaphora Function**\n**Match Stats**\n\n\nMatches: 33 - sub_401F95 Unmatched: 13\n\n\n**Notes:** Some API names and registry strings are obfuscated.\n\nTable 4: Sample 4 Analysis\n\nThe PDB string contained in this fourth sample is identical to Sample 2, further lending\ncredence to the evolution of the InnaputRAT.\n\n### API & String Obfuscation\n\nThis variant uses an 8-byte XOR key to obfuscate API names and other strings within the\n\npayload (Figure 5). Figure 5: 8-Byte XOR Key for\n\nobfuscation\n\n## Sample 5 - March 13, 2018\n\nThe most recent variant of the InnaputRAT also shared the same C2s as the previous two\nsamples, the same NeutralApp.exe name, and the same Registry Key creation. At the time\nof our analysis of this sample, the payload was being distributed by Godzilla Loader (Figure\n\n\n-----\n\n6), a tool sold in underground forums and used in multiple campaigns to distribute malware\nsuch as Dridex, Trickbot, and Panda Banker.\n\n**MD5** eec8e585ffdefb79a40ddb337ea852c6\n\n**Compile date** 2018-03-13 18:45:45\n\n**PDB** N/A\n\n**ITW** N/A\n\n**C2s:** worlwidesupport[.]top ninjagames[.]top ajdhsfhiudsfhsi[.]top\n\n\n**Communication**\n**Port:**\n\n\n52100\n\n\n**File Name:** NeutralApp.exe\n\n**Persistence:** HKU\\<SID>\\Software\\Microsoft\\Windows\\CurrentVersion\\Run:\n%appdata%\\NeutralApp\\NeutralApp.exe\n\n**Command Options** Function Name: sub_401DA0 No change\n\n\n**Diaphora Function**\n**Match Stats**\n\n\nBest Matches: 26 - sub_401DA0 Unmatched: 27\n\n\n**Notes:** More string and API Name obfuscation\n\nTable 5: Sample 5 Analysis\n\nFigure 6: GodZilla Loader Login Panel\n\nPrimary differences between this sample and the previous two are diminishing matched\nfunctions using Diaphora (likely a result of the attackers obfuscating more API calls and\n\n\n-----\n\nstrings) and a change in the 8-Byte XOR key used to obfuscate the API names and other\n\nstrings. Figure 7: 8-Byte XOR key change\n\n## Summary\n\nASERT believes the attackers behind the InnaputRAT are primarily targeting files for\nexfiltration from victim machines. The initial targeting of commercial manufacturing entities\npossibly suggests a goal of intellectual property theft. Since 2016 the malware has\nundergone significant changes. The attackers continue to improve the sophistication of the\nbot and its operation with the inclusion of an intermediary loader, Godzilla Loader, and\nobfuscation of key elements in the binary. We assess with moderate confidence that this\noperation will continue and the InnaputRAT will continue to evolve.\n\n## Appendix A:\n\n IOCs:\n\nalert-login-gmail[.]com\nblockhain[.]name\nbest-online-tv[.]com\ndockooment[.]com\ndocsautentification[.]com\ng000glemail[.]com\ngoogldraive[.]com\ngoogledockumets[.]com\ngoogledraive[.]com\ngooglesuport[.]com\ngooglmaile[.]com\ngooglsupport[.]com\ngovreportst[.]com\niceerd[.]com\nlogin-googlemail[.]com\nmail-redirect.com[.]kz\nmfa-events[.]com\nmsoficceupdate[.]com\nofficemicroupdate[.]com\n\n\n-----\n\nofficeonlaine[.]com\nosc-e[.]com\npwdrecover[.]com\nsuporteng[.]com\nun-booklet[.]com\nupdate-app[.]top\nusaid[.]info\nus-embassy-report[.]com\nworlwidesupport[.]top\n\nThe activity described in this blog was derived from the ATLAS Intelligence Feed and\noriginal research by the ASERT Team. The indicators and signatures related to the activity\nenable Arbor APS to block the activity.\n\nPosted In\n\nUncategorized\n\n## Subscribe\n\n_Sign up now to receive the latest notifications and updates from NETSCOUT's ASERT._\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2014/2014-08-07 - Innaput Actors Utilize Remote Access Trojan Since 2016, Presumably Targeting Victim Files.pdf"
    ],
    "report_names": [
        "2014-08-07 - Innaput Actors Utilize Remote Access Trojan Since 2016, Presumably Targeting Victim Files.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673536151,
    "ts_updated_at": 1743041134,
    "ts_creation_date": 1653774692,
    "ts_modification_date": 1653774692,
    "files": {
        "pdf": "https://archive.orkl.eu/52be3fdc42a5b6801012cb132c744d6c44d31584.pdf",
        "text": "https://archive.orkl.eu/52be3fdc42a5b6801012cb132c744d6c44d31584.txt",
        "img": "https://archive.orkl.eu/52be3fdc42a5b6801012cb132c744d6c44d31584.jpg"
    }
}