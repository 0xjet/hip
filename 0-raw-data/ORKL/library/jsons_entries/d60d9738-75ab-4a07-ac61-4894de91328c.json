{
    "id": "d60d9738-75ab-4a07-ac61-4894de91328c",
    "created_at": "2022-10-25T16:48:22.940202Z",
    "updated_at": "2025-03-27T02:05:51.752201Z",
    "deleted_at": null,
    "sha1_hash": "abe3c0fd4fb29ba970c896d542fe8e9e4edf5f15",
    "title": "Attacks on SWIFT Banking System Benefit From Insider Knowledge",
    "authors": "McAfee",
    "file_creation_date": "2019-11-20T16:48:01Z",
    "file_modification_date": "0001-01-01T00:00:00Z",
    "file_size": 168710,
    "plain_text": "# Attacks on SWIFT Banking System Benefit From Insider Knowledge\n\n**[securingtomorrow.mcafee.com/mcafee-labs/attacks-swift-banking-system-benefit-insider-knowledge](https://securingtomorrow.mcafee.com/mcafee-labs/attacks-swift-banking-system-benefit-insider-knowledge/)**\n\nMay 20,\n\n2016\n\n[By Christiaan Beek on May 20, 2016](https://securingtomorrow.mcafee.com/blogs/author/christiaan-beek/)\nIn recent months, we’ve seen headlines about the compromise of a bank in Bangladesh\nfrom which cybercriminals attempted to steal US$951 million. The malware they used was\nable to manipulate and read unique messages from SWIFT (Society for Worldwide Interbank\nFinancial Telecommunication), as well as adjust balances and send details to a remote\ncontrol server. BAE Systems wrote a detailed analysis and concluded that the malware must\nbe based on a framework of different modules that could be used for multiple targets.\n\nThis week SWIFT sent another warning without details about another bank, this time in\nVietnam that was compromised. According to a bank spokesperson, they detected in a\ntimely manner the fraudulent transfer of $1.13 million in December 2015. Because we know\nthe attackers had some insight into the Bangladesh attack, McAfee assumed the attackers\nalso knew something beforehand about the Vietnamese bank. We investigated possible\nmalware indicators for the latter attack.\n\nFiles used for the investigation:\n\nMD5: 0b9bf941e2539eaa34756a9e2c0d5343\nMD5: 909e1b840909522fe6ba3d4dfd197d93\n\nWe focused our analysis primarily on the first sample. The file’s compile timestamp is 201512-04 02:04:23. The first submission of the file from Vietnam was on December 22, 2015.\n\nIn the case of the Vietnamese bank, the file used for the attack is a fake version of the\npopular PDF reader Foxit. The malware installs itself in the original Foxit installation\ndirectory and renames the original file to FoxltReader.exe.\n\nOnce the user starts using the fake reader, the malware executes and writes to a log file in\nthe temp directory C:\\\\Windows\\temp\\\\WRTU\\ldksetup.tmp. Analyzing this file, we see the\nlog data is XOR encoded using the value 0x47.\n\n\n-----\n\nAs in the case of the Bangladeshi bank, the malware uses the configuration file\nLmutilps32.dat, which can also be found in C:\\\\Windows\\\\temp\\WRTU\\. This file is also XOR\nencoded, with the value 0x7C4D5978.\n\nWas this malware part of a targeted attack? Yes, absolutely. As in the malware used against\nthe Bangladeshi bank, we found the SWIFT code for the target in multiple places in the\nmalware:\n\nThe code TPBVVNVX is the SWIFT code for the Tienphong Commercial Joint Stock Bank, in\nHanoi.\n\nWe also noticed that there were more SWIFT codes in the code:\n\nThese banks are based in Australia, Singapore, Japan, Korea, Vietnam, Italy, and the United\nStates. We wondered why the actors would put this particular list in the malware. Further\nanalyzing the working of the malware, we discovered an interesting part in the code\nconcerning ”Executing the real Foxit reader” and the next section in the code states\n“PDFmodulation success. …” This hints of the manipulation of PDF files.\n\nIn the code, we found that the malware uses the original driver fpdsdk.dll from the Foxit\nSDK to execute the transformation of the files.\n\n\n-----\n\nWe discovered functionality in the code that converts PDF files to XML files, which are\nstored in the folder C:\\Documents and Settings\\Test\\Local Settings\\Temp\\. The filenames\nstart with XXX or RSP followed by a value between 0-F and finish with the extension .tmp.\n\nLet’s return to our list of SWIFT codes of other banks. The malware reads the SWIFT\nmessages and checks if the sender of the message is one of the listed banks. Once it finds\nthese messages, it reads their information:\n\nThe malware can manipulate these messages: deleting transactions, transaction history,\nand system logs, and prevent the printing of the fraudulent transactions:\n\nAs in the Bangladeshi attack, we found some typos:\n\nBangladesh: “fandation” instead of “foundation” and “alreay” instead of “already”\nVietnam: “FilleOut” instead of “FileOut”\n\n\n-----\n\nDoes this analysis tell us anything about the actors? It might, but these details form a weak\nindicator. How easy is it to misspell some words on purpose to mislead investigators?\n\n**Conclusion**\n\nIn both attacks we can see that the attackers have done their reconnaissance properly and\nmay have used an insider to get the details they needed to prepare their attacks. In the\nBangladeshi case, for example, the malware samples are tuned to the environment and\nhow the banking system operates, including the supported software, databases, and\nprinter. In the Vietnamese case, the malware is also tuned to fit the environment. The\nattackers knew that the bank used Foxit and replaced it with a fake version. The attackers\nhave a very good understanding of the SWIFT messaging system and how to manipulate the\nsystem to prevent the detection of their fraudulent attempts of transferring the money. The\nmalware in each attack was compiled just before the attack happened.\n\nAlthough both attacks were discovered at some point during the attempts to transfer large\namounts of money, the actors may well have executed a few test runs to check their\noperations before the real attacks.\n\nThe operation in Vietnam happened in December 2015 and was discovered after an\ninvestigation of the incident in February 2016 in Bangladesh. The Vietnamese attack was\nreported to the banking world in May 2016. Would logs still be available for an incident that\nhappened about six months ago? Would the possible test runs be traceable? These are\nsome of the many questions that arise. One lesson from both cases is that when a fraud\nalert is triggered by either an internal system or by transaction authorities, a thorough\nanalysis— including an in-depth analysis of the malware—of the tactics and procedures\nused by the attackers is needed. In this case, investigators can share indicators such as MD5\nsums, but because the attackers have customized their malware, sharing would be of little\nvalue. On the other hand, sharing the methods used by the attackers, the inner working of\nthe malware, and its manipulation of the systems should teach us where to look and adapt\nour defenses.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "d63ae2b7-445f-460d-965d-2676dacdb6de",
            "created_at": "2022-10-25T15:59:19.552139Z",
            "updated_at": "2022-10-25T15:59:19.552139Z",
            "deleted_at": null,
            "name": "APTnotes",
            "url": "https://github.com/aptnotes/data",
            "description": "APTnotes data",
            "reports": null
        }
    ],
    "references": [
        "https://app.box.com/s/0dgvhevjt5e6all9h1zq1dsgyo2awzy7"
    ],
    "report_names": [
        "McAfee_SWIFT-Insider-Knowledge(05-20-2016)"
    ],
    "threat_actors": [],
    "ts_created_at": 1666716502,
    "ts_updated_at": 1743041151,
    "ts_creation_date": 1574268481,
    "ts_modification_date": 0,
    "files": {
        "pdf": "https://archive.orkl.eu/abe3c0fd4fb29ba970c896d542fe8e9e4edf5f15.pdf",
        "text": "https://archive.orkl.eu/abe3c0fd4fb29ba970c896d542fe8e9e4edf5f15.txt",
        "img": "https://archive.orkl.eu/abe3c0fd4fb29ba970c896d542fe8e9e4edf5f15.jpg"
    }
}