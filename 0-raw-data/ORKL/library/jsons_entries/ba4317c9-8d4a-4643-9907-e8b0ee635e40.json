{
    "id": "ba4317c9-8d4a-4643-9907-e8b0ee635e40",
    "created_at": "2023-01-12T15:10:40.801704Z",
    "updated_at": "2025-03-27T02:16:58.024513Z",
    "deleted_at": null,
    "sha1_hash": "2e11ec83965d1af3d750cf20ddc8f8c3337220b1",
    "title": "2017-11-01 - Silence – a new Trojan attacking financial organizations",
    "authors": "",
    "file_creation_date": "2022-05-28T02:02:47Z",
    "file_modification_date": "2022-05-28T02:02:47Z",
    "file_size": 502324,
    "plain_text": "# Silence – a new Trojan attacking financial organizations\n\n**securelist.com/the-silence/83009/**\n\nAuthors\n\nGReAT\n\n_More information about the Silence Trojan is available to customers of Kaspersky Intelligence_\n_Reporting Service. Contact:_ _[intelreports@kaspersky.com](http://10.10.0.46/mailto:intelreports@kaspersky.com)_\n\nIn September 2017, we discovered a new targeted attack on financial institutions. Victims are\nmostly Russian banks but we also found infected organizations in Malaysia and Armenia.\nThe attackers were using a known but still very effective technique for cybercriminals looking\nto make money: gaining persistent access to an internal banking network for a long period of\ntime, making video recordings of the day to day activity on bank employees’ PCs, learning\nhow things works in their target banks, what software is being used, and then using that\nknowledge to steal as much money as possible when ready.\n\nWe saw that technique before in Carbanak, and other similar cases worldwide. The infection\nvector is a spear-phishing email with a malicious attachment. An interesting point in the\nSilence attack is that the cybercriminals had already compromised banking infrastructure in\n\n\n-----\n\norder to send their spear-phishing emails from the addresses of real bank employees and\nlook as unsuspicious as possible to future victims.\n\nThe attacks are currently still ongoing.\n\n## Technical details\n\nThe cybercriminals using Silence send spear-phishing emails as initial infection vectors,\noften using the addresses of employees of an already infected financial institution, with a\nrequest to open an account in the attacked bank. The message looks like a routine request.\nUsing this social engineering trick, it looks unsuspicious to the receiver:\n\n_Spear-phishing email in Russian._\n\n## Malicious .chm attachment\n\nmd5 dde658eb388512ee9f4f31f0f027a7df\n\nType Windows help .chm file\n\nThe attachment we detected in this new wave is a “Microsoft Compiled HTML Help” file. This\nis a Microsoft proprietary online help format that consists of a collection of HTML pages,\nindexing and other navigation tools. These files are compressed and deployed in a binary\nformat with the .CHM (compiled HTML) extension. These files are highly interactive and can\nrun a series of technologies including JavaScript, which can redirect a victim towards an\nexternal URL after simply opening the CHM. Attackers began exploiting CHM files to\nautomatically run malicious payloads once the file is accessed. Once the attachment is\n\n\n-----\n\nopened by the victim, the embedded .htm content file ( start.htm ) is executed. This file\ncontains JavaScript, and its goal is to download and execute another stage from a\nhardcoded URL:\n\n_Part of start.htm embedded file_\n\nThe goal of the script is to download and execute an obfuscated .VBS script which again\ndownloads and executes the final dropper\n\n_Obfuscated VBS script that downloads binary dropper_\n\n## Dropper\n\nmd5 404D69C8B74D375522B9AFE90072A1F4\n\nCompilation Thu Oct 12 02:53:12 2017\n\nType Win32 executable\n\n\n-----\n\nThe dropper is a win32 executable binary file, and its main goal is to communicate with the\ncommand and control (C&C) server, send the ID of the infected machine and download and\nexecute malicious payloads.\n\nAfter executing, the dropper connects to the C&C using a GET request, sends the generated\nvictim ID, downloads the payloads and executes them using the CreateProcess function.\n\n_C&C connect request string with ID_\n\n_C&C connect procedure_\n\n## Payloads\n\nThe payloads are a number of modules executed on the infected system for various tasks\nlike screen recording, data uploading etc.\n\nAll the payload modules we were able to identify are registered as Windows services.\n\n## Monitoring and control module\n\n\n-----\n\nmd5 242b471bae5ef9b4de8019781e553b85\n\nCompilation Tue Jul 19 15:35:17 2016\n\nType Windows service executable\n\nThe main task for this module is to monitor the activity of the victim. In order to do so it takes\nmultiple screenshots of the victim´s active screen, providing a real-time pseudo-video stream\nwith all the victim´s activity. A very similar technique was used in the Carbanak case, where\nthis monitoring was used to understand the victim´s day to day activity.\n\nThe module is registered and started by a Windows service named “Default monitor”.\n\n_Malicious service module name_\n\nAfter the initial startup, it creates a Windows named pipe with a hardcoded value – “\\\\.\\pipe\\\n{73F7975A-A4A2-4AB6-9121-AECAE68AABBB}”. This pipe is used for sharing data in\nmalicious inter-process communications between modules.\n\n_Named pipe creation_\n\nThe malware decrypts a block of data and saves it as a binary file with the hardcoded name\n“mss.exe” in a Windows temporary location, and later executes it using the\nCreateProcessAsUserA function. This dropped binary is the module responsible for the realtime screen activity recording.\n\nThen, the monitoring module waits for a new dropped module to start in order to share the\nrecorded data with other modules using the named pipe.\n\n## Screen activity gathering module\n\n\n-----\n\nmd5 242b471bae5ef9b4de8019781e553b85\n\nCompilation Tue Jul 19 15:35:17 2016\n\nType Windows 32 executable\n\nThis module uses both the Windows Graphics Device Interface (GDI) and the Windows API\nto record victim screen activity. This is done using the CreateCompatibleBitmap and\nGdipCreateBitmapFromHBITMAP functions. Then the module connects to the named pipe\ncreated by the previously described module and writes the data in there. This technique\nallows for the creation of a pseudo-video stream of the victim’s activity by putting together all\nthe collected bitmaps.\n\n_Writing bitmaps to pipe_\n\n### C&C communication module with console backconnect\n\nmd5 6A246FA30BC8CD092DE3806AE3D7FC49\n\nCompilation Thu Jun 08 03:28:44 2017\n\nType Windows service executable\n\nThe C&C communication module is a Windows service, as are all the other modules. Its\nmain functionality is to provide backconnect access to the victim machine using console\ncommand execution. After the service initialization, it decrypts the needed Windows API\nfunction names, loads them with LoadLibrary and resolves with GetProcAddress functions.\n\n\n-----\n\n_WinAPI resolving_\n\nAfter successful loading of the WinAPI functions, the malware tries to connect to the C&C\nserver using a hardcoded IP address (185.161.209[.]81).\n\n_C&C IP_\n\nThe malware sends a special request to the command server with its ID and then waits for a\nresponse, which consists of a string providing the code of what operation to execute. The\noptions are:\n\n**“htrjyytrn” which is the transliteration of “reconnect” (“реконнект” in russian layout).**\n**“htcnfhn” which is the transliteration of “restart” (“рестарт” in russian layout).**\n**“ytnpflfybq” which is the transliteration of “нет заданий” meaning “no tasks”**\n\nFinally the malware receives instructions on what console commands to execute, which it\ndoes using a new cmd.exe process with a parameter command.\n\n\n-----\n\n_Instruction check_\n\nThe described procedure allows attackers to install any other malicious modules. That can\nbe easily done using the “sc create” console command.\n\nWinexecsvc tool\n\nmd5 0B67E662D2FD348B5360ECAC6943D69C\n\nCompilation Wed May 18 03:58:26\n\nType Windows 64 executable\n\nAlso, on some infected computers we found a tool called the Winexesvc tool. This tool\nbasically provides the same functionality as the well-known “psexec” tool. The main\ndifference is that the Winexesvc tool enables the execution of remote commands from Linuxbased operating system. When the Linux binary “winexe” is run against a Windows server,\nthe winexesvc.exe executable is created and installed as a service.\n\n## Conclusion\n\nAttacks on financial organization remain a very effective way for cybercriminals to make\nmoney. The analysis of this case provides us with a new Trojan, apparently being used in\nmultiple international locations, which suggests it is an expanding activity of the group. The\nTrojan provides monitoring capabilities similar to the ones used by the Carbanak group.\n\nThe group uses legitimate administration tools to fly under the radar in their post-exploitation\nphase, which makes detection of malicious activity, as well as attribution more complicated.\nThis kind of attack has become widespread in recent years, which is a very worrisome trend\nas it demonstrates that criminals are successful in their attacks. We will continue monitoring\nthe activity for this new campaign.\n\nThe spear-phishing infection vector is still the most popular way to initiate targeted\ncampaigns. When used with already compromised infrastructure, and combined with .chm\nattachments, it seems to be a really effective way of spreading, at least among financial\norganizations.\n\n\n-----\n\n## Recommendations\n\nThe effective way of protection from targeted attacks focused on financial organizations are\npreventive advanced detection capabilities such as a solution that can detect all types of\nanomalies and scrutinize suspicious files at a deeper level, be present on users’ systems.\nThe Kaspersky Anti Targeted Attack solution (KATA) matches events coming from different\ninfrastructure levels, discerns anomalies and aggregates them into incidents, while also\nstudying related artifacts in a safe environment of a sandbox. As with most Kaspersky\nproducts, KATA is powered by HuMachine Intelligence, which is backed by on premise and in\nlab-running machine learning processes coupled with real-time analyst expertise and our\nunderstanding of threat intelligence big data.\n\nThe best way to prevent attackers from finding and leveraging security holes, is to eliminate\nthe holes altogether, including those involving improper system configurations or errors in\nproprietary applications. For this, Kaspersky Penetration Testing and Application Security\nAssessment services can become a convenient and highly effective solution, providing not\nonly data on found vulnerabilities, but also advising on how to fix it, further strengthening\ncorporate security.\n\n## IOC’s\n\nKaspersky lab products detects the Silence trojan with the following verdicts:\n\nBackdoor.Win32.Agent.dpke\n\nBackdoor.Win32.Agent.dpiz\n\nTrojan.Win32.Agentb.bwnk\n\nTrojan.Win32.Agentb.bwni\n\nTrojan-Downloader.JS.Agent.ocr\n\nHEUR:Trojan.Win32.Generic\n\nFull IOC’s and YARA rules delivered with private report subscription.\n\n**MD5**\n\nDde658eb388512ee9f4f31f0f027a7df\n\n404d69c8b74d375522b9afe90072a1f4\n\n15e1f3ce379c620df129b572e76e273f\n\nD2c7589d9f9ec7a01c10e79362dd400c\n\n1b17531e00cfc7851d9d1400b9db7323\n\n242b471bae5ef9b4de8019781e553b85\n\n324D52A4175722A7850D8D44B559F98D\n\n6a246fa30bc8cd092de3806ae3d7fc49\n\nB43f65492f2f374c86998bd8ed39bfdd\n\ncfffc5a0e5bdc87ab11b75ec8a6715a4\n\n\n-----\n\n[Backdoor](https://securelist.com/tag/backdoor/)\n[Dropper](https://securelist.com/tag/dropper/)\n[Financial malware](https://securelist.com/tag/financial-malware/)\n[Targeted attacks](https://securelist.com/tag/targeted-attacks/)\n\nAuthors\n\nGReAT\n\nSilence – a new Trojan attacking financial organizations\n\nYour email address will not be published. Required fields are marked *\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2017/2017-11-01 - Silence – a new Trojan attacking financial organizations.pdf"
    ],
    "report_names": [
        "2017-11-01 - Silence – a new Trojan attacking financial organizations.pdf"
    ],
    "threat_actors": [
        {
            "id": "42a6a29d-6b98-4fd6-a742-a45a0306c7b0",
            "created_at": "2022-10-25T15:50:23.710403Z",
            "updated_at": "2025-03-27T02:00:55.531313Z",
            "deleted_at": null,
            "main_name": "Silence",
            "aliases": [
                "Whisper Spider"
            ],
            "source_name": "MITRE:Silence",
            "tools": [
                "Winexe",
                "SDelete"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "c9617bb6-45c8-495e-9759-2177e61a8e91",
            "created_at": "2022-10-25T15:50:23.405039Z",
            "updated_at": "2025-03-27T02:00:55.462193Z",
            "deleted_at": null,
            "main_name": "Carbanak",
            "aliases": [
                "Carbanak",
                "Anunak"
            ],
            "source_name": "MITRE:Carbanak",
            "tools": [
                "Carbanak",
                "Mimikatz",
                "PsExec",
                "netsh"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "88e53203-891a-46f8-9ced-81d874a271c4",
            "created_at": "2022-10-25T16:07:24.191982Z",
            "updated_at": "2025-03-27T02:02:10.13692Z",
            "deleted_at": null,
            "main_name": "Silence",
            "aliases": [
                "ATK 86",
                "Contract Crew",
                "TAG-CR8",
                "TEMP.TruthTeller",
                "Whisper Spider"
            ],
            "source_name": "ETDA:Silence",
            "tools": [
                "EDA",
                "EmpireDNSAgent",
                "Farse",
                "Ivoke",
                "Kikothac",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "Meterpreter",
                "ProxyBot",
                "ReconModule",
                "Silence.Downloader",
                "TiniMet",
                "TinyMet",
                "TrueBot",
                "xfs-disp.exe"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "aa73cd6a-868c-4ae4-a5b2-7cb2c5ad1e9d",
            "created_at": "2022-10-25T16:07:24.139848Z",
            "updated_at": "2025-03-27T02:02:10.120505Z",
            "deleted_at": null,
            "main_name": "Safe",
            "aliases": [],
            "source_name": "ETDA:Safe",
            "tools": [
                "DebugView",
                "LZ77",
                "OpenDoc",
                "SafeDisk",
                "TypeConfig",
                "UPXShell",
                "UsbDoc",
                "UsbExe"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "f4f16213-7a22-4527-aecb-b964c64c2c46",
            "created_at": "2024-06-19T02:03:08.090932Z",
            "updated_at": "2025-03-27T02:05:17.387119Z",
            "deleted_at": null,
            "main_name": "GOLD NIAGARA",
            "aliases": [
                "Carbanak",
                "Carbon Spider ",
                "FIN7 ",
                "Navigator ",
                "Sangria Tempest ",
                "TelePort Crew ",
                "Calcium "
            ],
            "source_name": "Secureworks:GOLD NIAGARA",
            "tools": [
                " Carbanak",
                " Cobalt Strike",
                " DICELOADER",
                " DRIFTPIN",
                " GGLDR",
                " GRIFFON",
                " JSSLoader",
                " Meterpreter",
                " OFFTRACK",
                " PILLOWMINT",
                " POWERTRASH",
                " SUPERSOFT",
                " TAKEOUT",
                " TinyMet",
                "Bateleur"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "bb8702c5-52ac-4359-8409-998a7cc3eeaf",
            "created_at": "2023-01-06T13:46:38.405479Z",
            "updated_at": "2025-03-27T02:00:02.82533Z",
            "deleted_at": null,
            "main_name": "FIN7",
            "aliases": [
                "JokerStash",
                "ATK32",
                "G0046",
                "Coreid",
                "Carbanak",
                "Sangria Tempest",
                "CARBON SPIDER",
                "GOLD NIAGARA",
                "G0008",
                "ELBRUS",
                "Carbon Spider"
            ],
            "source_name": "MISPGALAXY:FIN7",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "ed3810b7-141a-4ed0-8a01-6a972b80458d",
            "created_at": "2022-10-25T16:07:23.443259Z",
            "updated_at": "2025-03-27T02:02:09.801771Z",
            "deleted_at": null,
            "main_name": "Carbanak",
            "aliases": [
                "Anunak",
                "Carbanak",
                "Carbon Spider",
                "ELBRUS",
                "Gold Waterfall",
                "Sangria Tempest"
            ],
            "source_name": "ETDA:Carbanak",
            "tools": [
                "AVE_MARIA",
                "Agentemis",
                "AmmyyRAT",
                "Antak",
                "Anunak",
                "Ave Maria",
                "AveMariaRAT",
                "BABYMETAL",
                "BIRDDOG",
                "Backdoor Batel",
                "Batel",
                "Bateleur",
                "BlackMatter",
                "Boostwrite",
                "Cain & Abel",
                "Carbanak",
                "Cl0p",
                "Cobalt Strike",
                "CobaltStrike",
                "DNSMessenger",
                "DNSRat",
                "DNSbot",
                "DRIFTPIN",
                "DarkSide",
                "FOXGRABBER",
                "FlawedAmmyy",
                "HALFBAKED",
                "JS Flash",
                "KLRD",
                "MBR Eraser",
                "Mimikatz",
                "Nadrac",
                "Odinaff",
                "POWERPIPE",
                "POWERSOURCE",
                "PsExec",
                "SQLRAT",
                "Sekur",
                "Sekur RAT",
                "SocksBot",
                "SoftPerfect Network Scanner",
                "Spy.Agent.ORM",
                "TEXTMATE",
                "TeamViewer",
                "TiniMet",
                "TinyMet",
                "Toshliph",
                "VB Flash",
                "WARPRISM",
                "avemaria",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673536240,
    "ts_updated_at": 1743041818,
    "ts_creation_date": 1653703367,
    "ts_modification_date": 1653703367,
    "files": {
        "pdf": "https://archive.orkl.eu/2e11ec83965d1af3d750cf20ddc8f8c3337220b1.pdf",
        "text": "https://archive.orkl.eu/2e11ec83965d1af3d750cf20ddc8f8c3337220b1.txt",
        "img": "https://archive.orkl.eu/2e11ec83965d1af3d750cf20ddc8f8c3337220b1.jpg"
    }
}