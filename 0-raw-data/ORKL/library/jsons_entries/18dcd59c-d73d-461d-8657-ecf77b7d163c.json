{
    "id": "18dcd59c-d73d-461d-8657-ecf77b7d163c",
    "created_at": "2023-01-12T15:08:24.876611Z",
    "updated_at": "2025-03-27T02:14:39.246465Z",
    "deleted_at": null,
    "sha1_hash": "134ad6d332323636ea31b3199d9d1324d7e64931",
    "title": "2017-10-20 - OSX-Proton spreading again through supply‑chain attack",
    "authors": "",
    "file_creation_date": "2022-05-28T18:06:07Z",
    "file_modification_date": "2022-05-28T18:06:07Z",
    "file_size": 448364,
    "plain_text": "# OSX/Proton spreading again through supply‑chain attack\n\n**welivesecurity.com/2017/10/20/osx-proton-supply-chain-attack-elmedia/**\n\nOctober 19, 2017\n\nOur researchers noticed that the makers of the Elmedia Player software have been distributing a version of their app\ntrojanized with the OSX/Proton malware.\n\n[ESET Research](https://www.welivesecurity.com/author/esetresearch/)\n20 Oct 2017 - 01:56AM\n\nOur researchers noticed that the makers of the Elmedia Player software have been distributing a version of their app\ntrojanized with the OSX/Proton malware.\n\n[On 19 October 2017, ESET researchers noticed that Eltima, the makers of the Elmedia Player software, were distributing](https://www.eltima.com/)\n[a version of their application trojanized with the OSX/Proton malware on their official website. ESET contacted Eltima as](http://www.virusradar.com/en/OSX_Proton)\nsoon as the situation was confirmed. Eltima was very responsive and maintained an excellent communication with us\nthroughout the incident.\n\n\n-----\n\nTimeline\n\n2017-10-19 : Trojanized package confirmed\n2017-10-19 10:35am EDT: Eltima informed via email\n2017-10-19 2:25pm EDT: Eltima acknowledged the issue and initiated remediation efforts\n2017-10-19 3:10pm EDT: Eltima confirms their infrastructure is cleaned up and serving the legitimate applications\nagain\n2017-10-19 10:12am EDT: [Eltima publishes an announcement about the event](https://www.eltima.com/blog/2017/10/elmedia-player-and-folx-malware-threat-neutralized.html)\n2017-10-20 12:15pm EDT: Added references to Folx that was also distributed with the Proton malware\n\n_Note: This blog was initially_ _posted despite our research being incomplete. Hence, this information is preliminary and the_\n_blogpost will be updated as new facts emerge._\n\n## Am I compromised?\n\nESET advises anyone who downloaded Elmedia Player or Folx software recently to verify if their system is compromised\nby testing the presence of any of the following files or directories:\n\n/tmp/Updater.app/\n/Library/LaunchAgents/com.Eltima.UpdaterAgent.plist\n/Library/.rand/\n/Library/.rand/updateragent.app/\n\nIf any of them exists, it means the trojanized Elmedia Player or Folx application was executed and that OSX/Proton is\nmost likely running.\n\nIf you have downloaded that software on October 19th before 3:15pm EDT and run it, you are likely compromised.\n\nAs far as we know, the trojanized version of the application was only downloadable from the Eltima website, between\n08:00 and 15:15 EDT on 19 October 2017. The built-in automatic update mechanism seems unaffected.\n\n## What does the malicious payload do to a compromised system?\n\nOSX/Proton is a backdoor with extensive data-stealing capabilities. It gains persistence on the system and can steal the\nfollowing:\n\nOperating system details: hardware serial number (IOPlatformSerialNumber), full name of the current user,\nhostname, System Integrity Protection status (csrutil status), gateway information (route -n get default | awk\n‘/gateway/ { print $2 }’), current time & timezone\nBrowser information from Chrome, Safari, Opera and Firefox: history, cookies, bookmarks, login data, etc.\nCryptocurrency wallets:\n\nElectrum: ~/.electrum/wallets\nBitcoin Core: ~/Library/Application Support/Bitcoin/wallet.dat\nArmory: ~/Library/Application Support/Armory\nSSH private data (entire .ssh content)\n[macOS keychain data using a modified version of chainbreaker](https://github.com/n0fate/chainbreaker/)\nTunnelblick VPN configuration (~/Library/Application Support/Tunnelblick/Configurations)\nGnuPG data (~/.gnupg)\n1Password data (~/Library/Application Support/1Password 4 and ~/Library/Application Support/1Password 3.9)\nList of all installed applications.\n\n### How do I clean my system?\n\nAs with any compromise of an administrator account, a full OS reinstall is the only sure way to get rid of the malware.\nVictims should also assume at least all the secrets outlined in the previous section are compromised and take appropriate\nmeasures to invalidate them.\n\n## Supply-chain attack revisited on the Mac\n\n\n-----\n\nLast year, the Mac Bittorrent client Transmission was abused twice to spread malware, first the OSX/KeRanger\n[ransomware followed by OSX/Keydnap password stealer. Then this year, the Handbrake video-transcoder application was](https://www.welivesecurity.com/2016/08/30/osxkeydnap-spreads-via-signed-transmission-application/)\n[found bundled with OSX/Proton.](https://blog.malwarebytes.com/threat-analysis/mac-threat-analysis/2017/05/handbrake-hacked-to-drop-new-variant-of-proton-malware/)\n\nToday, ESET discovered another popular Mac software package being used to spread OSX/Proton: Elmedia Player, a\nmedia player that reached the 1,000,000 users milestone this summer:\n\n## Technical analysis\n\nOSX/Proton is a RAT (Remote Access Trojan) sold as a kit on underground forums. It was very briefly documented by\n[Sixgill earlier this year and then further analyzed by Thomas Reed at MalwareBytes,](https://www.cybersixgill.com/proton-a-new-mac-os-rat/) [Amit Serper at CyberReason and](https://www.cybereason.com/labs-blog/labs-proton-b-what-this-mac-malware-actually-does)\n[Patrick Wardle at Objective-See.](https://objective-see.com/blog/blog_0x1F.html)\n\nIn the current case of Eltima trojanized software, the attacker built a signed wrapper around the legitimate Elmedia Player\nand Proton. In fact, we observed what seems to be real-time repackaging and signing of the wrappers, all with the same\nvalid Apple Developer ID. See the history of currently known samples below. Eltima and ESET confirmed they are working\nwith Apple to invalidate the Developer ID used to sign the malicious application. (Apple revoked the certificate.)\n\n(timestamps are all in EDT timezone)\n\nClean application:\n\n**Timestamp** **Developper ID** **SHA-1**\n\n\n-----\n\n**Timestamp** **Developper ID** **SHA-1**\n\n\nTimestamp=Jul 24,\n2017, 4:56:24 AM\n\nTrojanized application:\n\n\nAuthority=Developer ID Application:\nELTIMA LLC (N7U4HGP254)\n\n```\n0603353852e174fc0337642e3957c7423f182a8c\n\n```\n\n**Timestamp** **Developper ID** **SHA-1 (dmg file)**\n\n\nTimestamp=Oct 19,\n2017, 8:00:05 AM\n\nTimestamp=Oct 19,\n2017, 12:22:24 PM\n\nTimestamp=Oct 19,\n2017, 2:00:38 PM\n\n\nAuthority=Developer ID Application:\nClifton Grimm (9H35WM5TA5)\n\nAuthority=Developer ID Application:\nClifton Grimm (9H35WM5TA5)\n\nAuthority=Developer ID Application:\nClifton Grimm (9H35WM5TA5)\n\n```\ne9dcdae1406ab1132dc9d507fd63503e5c4d41d9\n\n```\n\nFirst, the wrapper launches the real Elmedia Player application stored in the Resources folder of the application:\n\nAnd finally extracts & launches OSX/Proton:\n\nAs seen in previous cases, OSX/Proton shows a fake Authorization window to gain root privileges:\n\n\n-----\n\n### Persistance\n\nOSX/Proton ensures persistence by adding a LaunchAgent for all users when the administrator types their password. It\ncreates the following files on the system:\n\n/Library/LaunchAgents/com.Eltima.UpdaterAgent.plist\n/Library/.rand/updateragent.app\n\n\n1\n\n2\n\n3\n\n4\n\n5\n\n6\n\n7\n\n8\n\n9\n\n\n$ plutil -p /Library/LaunchAgents/com.Eltima.UpdaterAgent.plist\n\n{\n\n\"ProgramArguments\" => [\n\n0 => \"/Library/.rand/updateragent.app/Contents/MacOS/updateragent\"\n\n]\n\n\"KeepAlive\" => 1\n\n\"RunAtLoad\" => 1\n\n\"Label\" => \"com.Eltima.UpdaterAgent\"\n\n}\n\n\n### Backdoor commands\n\nAs mentioned at the beginning of the post, OSX/Proton is a backdoor with extensive information stealing capabilities. The\nbackdoor component we observed supports the following commands:\n\n`archive` Archive files using zip\n\n\n-----\n\n`force_update` Self-update with digital signature validation\n```\n phonehome\n\n```\n`remote_execute` Execute the binary file inside a .zip file or a given shell command\n\n`tunnel` Create SSH tunnel using port 22 or 5900\n\n`upload` Upload file to C&C server\n\n## C&C server\n\nProton uses a C&C domain that mimics the legitimate Eltima domain, which is consistent with the Handbrake case:\n\n**Legitimate domain** **Proton C2 domain**\n\nEltima eltima.com eltima[.]in\n\nHandbrake handbrake.fr handbrakestore[.]com\n\nhandbrake[.]cc\n\n## IOCs\n\nURL distributing the trojanized application at the time of discovery:\n\nhxxps://mac[.]eltima[.]com/download/elmediaplayer.dmg\nhxxp://www.elmedia-video-player.[.]com/download/elmediaplayer.dmg\nhxxps://mac.eltima[.]com/download/downloader_mac.dmg\n\n### C&C servers\n\neltima[.]in / 5.196.42.123 (domain registered 2017-10-15)\n\n### Hashes\n\n\n**Path** **SHA-1**\n\n\n**ESET**\n**Detection**\n**name** **Description**\n\n\nElmedia\nPlayer.app/Contents/Resources/.pl.zip\n\nElmedia\nPlayer.app/Contents/MacOS/Elmedia\nPlayer\n\n\n`9E5378165BB20E9A7F74A7FCC73B528F7B231A75` multiple\nthreats\n\n`10A09C09FD5DD76202E308718A357ABC7DE291B5` multiple\nthreats\n\n\n`C9472D791C076A10DCE5FF0D3AB6E7706524B741` OSX/Proton.D Launcher\n(or wrapper)\n\n`30D77908AC9D37C4C14D32EA3E0B8DF4C7E75464` OSX/Proton.D Launcher\n(or wrapper)\n\n\nZIP archive\nwith the\nProton\nmalware\nand Python\nscripts\n\nZIP archive\nwith the\nProton\nmalware\nand Python\nscripts\n\n\nUpdater.app/Contents/MacOS/Updater `3EF34E2581937BABD2B7CE63AB1D92CD9440181A` OSX/Proton.C Proton\nmalware,\nnot signed\n\n\n-----\n\n**Path** **SHA-1**\n\n\n**ESET**\n**Detection**\n**name** **Description**\n\n\n`EF5A11A1BB5B2423554309688AA7947F4AFA5388` OSX/Proton.C Proton\nmalware,\nnot signed\n\nHat tip to Michal Malik, Anton Cherepanov, Marc-Étienne M. Léveillé, Thomas Dupuy & Alexis Dorais-Joncas for their work\non this investigation.\n\n20 Oct 2017 - 01:56AM\n\n### Sign up to receive an email update whenever a new article is published in our Ukraine Crisis – Digital Security Resource Center\n\n Newsletter\n\n Discussion\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2017/2017-10-20 - OSX-Proton spreading again through supply‑chain attack.pdf"
    ],
    "report_names": [
        "2017-10-20 - OSX-Proton spreading again through supply‑chain attack.pdf"
    ],
    "threat_actors": [
        {
            "id": "a66438a8-ebf6-4397-9ad5-ed07f93330aa",
            "created_at": "2022-10-25T16:47:55.919702Z",
            "updated_at": "2025-03-27T02:05:17.412024Z",
            "deleted_at": null,
            "main_name": "IRON VIKING",
            "aliases": [
                "ATK14 ",
                "BlackEnergy Group",
                "Blue Echidna ",
                "CTG-7263 ",
                "ELECTRUM ",
                "FROZENBARENTS ",
                "Hades/OlympicDestroyer ",
                "IRIDIUM ",
                "Qudedagh ",
                "Sandworm Team ",
                "Seashell Blizzard ",
                "TEMP.Noble ",
                "Telebots ",
                "Voodoo Bear ",
                "APT44 "
            ],
            "source_name": "Secureworks:IRON VIKING",
            "tools": [
                " BlackEnergy",
                " GCat",
                " GreyEnergy",
                " Industroyer",
                " KillDisk",
                " NotPetya",
                " PSCrypt",
                " TeleBot",
                " TeleDoor",
                " xData",
                "BadRabbit"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "b3e954e8-8bbb-46f3-84de-d6f12dc7e1a6",
            "created_at": "2022-10-25T15:50:23.339976Z",
            "updated_at": "2025-03-27T02:00:55.446795Z",
            "deleted_at": null,
            "main_name": "Sandworm Team",
            "aliases": [
                "Sandworm Team",
                "ELECTRUM",
                "Telebots",
                "IRON VIKING",
                "BlackEnergy (Group)",
                "Quedagh",
                "Voodoo Bear",
                "IRIDIUM",
                "Seashell Blizzard",
                "FROZENBARENTS",
                "APT44"
            ],
            "source_name": "MITRE:Sandworm Team",
            "tools": [
                "Bad Rabbit",
                "Mimikatz",
                "Exaramel for Linux",
                "Exaramel for Windows",
                "GreyEnergy",
                "PsExec",
                "Prestige",
                "P.A.S. Webshell",
                "VPNFilter",
                "Cyclops Blink",
                "SDelete",
                "AcidRain",
                "Industroyer",
                "Industroyer2",
                "BlackEnergy",
                "Cobalt Strike",
                "NotPetya",
                "KillDisk",
                "PoshC2",
                "Impacket",
                "Invoke-PSImage",
                "Olympic Destroyer"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "3a0be4ff-9074-4efd-98e4-47c6a62b14ad",
            "created_at": "2022-10-25T16:07:23.590051Z",
            "updated_at": "2025-03-27T02:02:09.878211Z",
            "deleted_at": null,
            "main_name": "Energetic Bear",
            "aliases": [
                "ATK 6",
                "Blue Kraken",
                "Crouching Yeti",
                "Dragonfly",
                "Electrum",
                "Energetic Bear",
                "Ghost Blizzard",
                "Group 24",
                "ITG15",
                "Iron Liberty",
                "Koala Team",
                "TG-4192"
            ],
            "source_name": "ETDA:Energetic Bear",
            "tools": [
                "Backdoor.Oldrea",
                "CRASHOVERRIDE",
                "Commix",
                "CrackMapExec",
                "CrashOverride",
                "Dirsearch",
                "Dorshel",
                "Fertger",
                "Fuerboos",
                "Goodor",
                "Havex",
                "Havex RAT",
                "Hello EK",
                "Heriplor",
                "Impacket",
                "Industroyer",
                "Karagany",
                "Karagny",
                "LightsOut 2.0",
                "LightsOut EK",
                "Listrix",
                "Oldrea",
                "PEACEPIPE",
                "PHPMailer",
                "PsExec",
                "SMBTrap",
                "Subbrute",
                "Sublist3r",
                "Sysmain",
                "Trojan.Karagany",
                "WSO",
                "Webshell by Orb",
                "Win32/Industroyer",
                "Wpscan",
                "nmap",
                "sqlmap",
                "xFrost"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "8941e146-3e7f-4b4e-9b66-c2da052ee6df",
            "created_at": "2023-01-06T13:46:38.402513Z",
            "updated_at": "2025-03-27T02:00:02.824555Z",
            "deleted_at": null,
            "main_name": "Sandworm",
            "aliases": [
                "G0034",
                "IRIDIUM",
                "Blue Echidna",
                "FROZENBARENTS",
                "Seashell Blizzard",
                "IRON VIKING",
                "ELECTRUM",
                "TeleBots",
                "UAC-0113",
                "UAC-0082",
                "APT44",
                "Quedagh",
                "VOODOO BEAR",
                "TEMP.Noble"
            ],
            "source_name": "MISPGALAXY:Sandworm",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673536104,
    "ts_updated_at": 1743041679,
    "ts_creation_date": 1653761167,
    "ts_modification_date": 1653761167,
    "files": {
        "pdf": "https://archive.orkl.eu/134ad6d332323636ea31b3199d9d1324d7e64931.pdf",
        "text": "https://archive.orkl.eu/134ad6d332323636ea31b3199d9d1324d7e64931.txt",
        "img": "https://archive.orkl.eu/134ad6d332323636ea31b3199d9d1324d7e64931.jpg"
    }
}