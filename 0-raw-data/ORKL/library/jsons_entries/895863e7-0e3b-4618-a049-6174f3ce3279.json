{
    "id": "895863e7-0e3b-4618-a049-6174f3ce3279",
    "created_at": "2023-01-12T14:59:20.399995Z",
    "updated_at": "2025-03-27T02:14:34.051955Z",
    "deleted_at": null,
    "sha1_hash": "e2b435b9d39be5ae766eeea3f703284602b6a4ae",
    "title": "2019-05-09 - Technical Analysis- Pacha Group Competing against Rocke Group for Cryptocurrency Mining Foothold on the Cloud",
    "authors": "",
    "file_creation_date": "2022-05-28T19:04:46Z",
    "file_modification_date": "2022-05-28T19:04:46Z",
    "file_size": 1866579,
    "plain_text": "# Technical Analysis: Pacha Group Competing against Rocke Group for Cryptocurrency Mining Foothold on the Cloud\n\n**[intezer.com/blog-technical-analysis-cryptocurrency-mining-war-on-the-cloud/](https://www.intezer.com/blog-technical-analysis-cryptocurrency-mining-war-on-the-cloud/)**\n\nMay 9, 2019\n\nWritten by Ignacio Sanmillan - 9 May 2019\n\n## Get Free Account\n\nJoin Now\n\n**Pacha Group is a crypto-mining threat actor we at Intezer discovered and profiled in a blog**\npost published on February 28, 2019. This threat actor targeted Linux servers dating back\nto September 2018 and implemented advanced evasion and persistence techniques.\n\n\n-----\n\nWe have continued to monitor this threat actor and new findings show that Pacha Group is\nalso targeting cloud-based environments and conducting great efforts to disrupt other\n[crypto-mining groups, namely Rocke Group who is also known to target cloud](https://unit42.paloaltonetworks.com/malware-used-by-rocke-group-evolves-to-evade-detection-by-cloud-security-products/)\nenvironments.\n\nWe believe that these findings are relevant within the context of bringing awareness about\ncloud-native threats and our research may imply that cloud environments are increasingly\nbecoming a common target for adversaries.\n\n**Technical Analysis**\nIn monitoring Pacha Group we have identified new, undetected Linux.GreedyAntd\nvariants that share code with previous variants.\n\nDespite sharing nearly 30% of code with previous variants, detection rates of the new\n**Pacha Group variants are low:**\n\n\n-----\n\nThe main malware infrastructure appears to be identical to previous Pacha Group\ncampaigns, although there is a distinguishable effort to detect and mitigate Rocke Group’s\nimplants. Rocke Group was first reported by [Cisco Talos researchers and has deployed](https://blog.talosintelligence.com/2018/08/rocke-champion-of-monero-miners.html)\nsophisticated crypto-mining campaigns in Linux servers and cloud-based environments as\nreported by [Palo Alto Unit 42. The following image is a blacklist of miners in which](https://unit42.paloaltonetworks.com/malware-used-by-rocke-group-evolves-to-evade-detection-by-cloud-security-products/)\n**Linux.GreedyAntd searches to eradicate. We have recognized several file names in this**\nblacklist known to be used for Rocke Group’s implants:\n\nFurthermore, there are other strings within this file path blacklist which are used to search\n[for and disable cloud protection solutions, such as Alibaba Server Guard Agent. Strings of](https://www.intezer.com/)\n[malware implants known to have abused the Atlassian vulnerability were also found. Rocke](https://www.reddit.com/r/linuxquestions/comments/bknurg/is_is_exploit_or_what/)\n**[Group is known to hunt for similar security products and to have abused the same](https://community.atlassian.com/t5/Confluence-questions/How-come-my-confluence-installation-was-hacked-by-Kerberods/qaq-p/1054605#M141274)**\nvulnerability.\n\n\n-----\n\nAnother interesting update in Pacha Group’s infrastructure in comparison to previous\ncampaigns is that further implants would only be able to be downloaded from Pacha\n**Group’s servers if the HTTP GET request was completed with a specific User-Agent. In the**\nfollowing screenshot we can see how files can not be downloaded unless the correct UserAgent is used:\n\nIn addition, Pacha Group’s component update seems to include a lightweight user-mode\n[rootkit known as Libprocesshider, which is an open source project hosted on GitHub and](https://github.com/gianlucaborello/libprocesshider)\nhas also been used by Rocke Group.\n\n\n-----\n\nThe malware updates /etc/ld.preload to include the path of the dropped library\nmasquerading libconv.so, a unicode conversion library.\n\nThis shared object will export customized versions of readdir and readdir64 functions that\nwill attempt to hide a process name from /proc filesystem of one of the main components\nof the malware’s infrastructure, in charge to download further implants in intervals along\nwith enforcing process, file path and IP blacklisting:\n\n\n-----\n\nAlong with process and file path blacklisting measures seen in previous variants, we also\nobserved that newer variants implement IP blacklisting using an interesting technique.\n\n\n-----\n\nRight after process and file path black listing has been accomplished, we find the following\ncode:\n\nEach of the IPs in the blacklist IP table is decoded and then added to the system routing\ntable with host scope via ioctl.\n\n\n-----\n\nThis is more conveniently shown by observing the following system call trace:\n\nWhen we check the routing table of a compromised system we see the following:\n\n\n-----\n\nEach of the decoded IPs have been added to the routing table with host scope. This implies\nthat when any of these IPs will be requested, each request will be routed back to the host to\nbe resolved instead of redirecting them to the gateway, causing a failure in the routing\nprocess.\n\nIn the following screenshot we can see the effect of this methodology by using the ping\nutility:\n\nAfter analyzing the IP blacklist we discovered that some of these IPs, even though they may\nnot necessarily be malicious, are known to have been used by Rocke Group in the past.\nAs an example, systemten.org is in this blacklist and it is known that Rocke Group has\nused this domain for their crypto-mining operations. The following are some domains that\ncorrespond to their hardcoded IPs in Linux.GreedyAntd’s blacklist that have Rocke Group\ncorrelations:\n\n\n-----\n\n**Conclusion**\n\nWe have presented evidence that Pacha Group is targeting cloud-based environments and\nbeing especially aggressive towards Rocke Group. We have based this conclusion on the\nprocess blacklist used by Pacha Group and the newly added IP blacklist which contains\n**Rocke Group correlated artifacts.**\n\n[We have also provided a YARA rule in order to detect Pacha Group’s](https://github.com/intezer/yara-rules/blob/master/GreedyAntd.yar) **Linux.GreedyAntd**\nimplants based on reused code among the implants.\n\nFor additional recommendations on how to mitigate this threat, please refer to our nontechnical blog post on this subject: https://www.intezer.com//blog-competition-forcryptocurrency-mining-foothold-on-the-cloud.\n\nCloud infrastructure is quickly becoming a common target for threat actors, particularly on\nvulnerable Linux servers. Unfortunately the detection rates of Linux-based malware remain\nlow and the security community needs more awareness in order to more effectively mitigate\nthese threats.\n\n**IOCs**\n\n195.154.187[.]169\n\n165.227.140[.]184\n\nf46a9d2c3c9bfcc409534e0856f4614d6b42e792134dcf0f40df7295a777c879\n\nd2e373c1341a28e18158272208a15decfa397640b6092b56158e0f52e4ff73a4\n\nc098d5aeef316c3564b0b40a8a102147dae9c606fa92a2e2f0ad5c94cfe30222\n\n\n-----\n\n42612f41befc57619646da5e91e7758dcc83cbaafbe5fdfa19d9f43a71f2504f\nce10e7a0fb517309b1e1141b44d3f9f7759e0f8889c0392774a5869f41006a3f\nd94a6537adcea2f8ef3ed5ed41a548bc2b26b3acdeca9aaf6da4c933e7f47174\nf83d75ab09634a7b818ef87c6509cca2c6f26f5f65b8d3448ebc86b52be62253\ne5f6fbeb3981c9dfa126dc0a71a0aa41b56a09a89228659a7ea5f32aff4b2058\n\n**GreedyAntd Embedded IP Blacklist**\nThe following are IPs that the Pacha Group attempts to block to prevent operation of other\ncrypto-mining implants (notice not to block these IPs. See the IPs to block in the above\nIOCs section):\n\n139.99.120[.]73\n47.95.85[.]22\n62.210.75[.]99\n113.55.8[.]24\n62.210.75[.]99\n42.56.76[.]104\n198.204.231[.]250\n47.90.213[.]21\n116.62.232[.]226\n134.209.104[.]20\n198.12.156[.]218\n207.148.76[.]229\n188.165.254[.]85\n58.56.187[.]66\n89.35.39[.]78\n37.139.22[.]136\n37.44.212[.]223\n54.36.137[.]146\n139.99.120[.]50\n37.120.131[.]220\n104.20.209[.]21\n198.12.156[.]218\n34.196.173[.]143\n34.193.88[.]221\n35.168.52[.]211\n104.248.4[.]162\n130.61.54[.]136\n139.99.120[.]50\n198.12.156[.]218\n166.62.38[.]167\n185.193.125[.]146\n132.148.148[.]79\n\n\n-----\n\n188.165.254[.]85\n104.20.208[.]21\n37.187.95[.]110\n158.69.25[.]62\n104.31.93[.]26\n104.25.140[.]10\n60.191.25[.]101\n104.248.53[.]213\n60.191.13[.]119\n104.130.210[.]206\n193.56.28[.]207\n37.187.95[.]110\n89.35.39[.]78\n81.4.122[.]134\n37.44.212[.]223\n148.251.133[.]246\n52.41.214[.]241\n52.25.124[.]181\n54.68.226[.]153\n136.243.89[.]164\n104.20.209[.]21\n176.9.2[.]144\n37.59.43[.]136\n78.46.89[.]102\n37.59.45[.]174\n91.121.2[.]76\n176.9.53[.]68\n37.59.55[.]60\n178.63.48[.]196\n37.187.154[.]79\n37.59.44[.]93\n78.46.91[.]134\n37.59.54[.]205\n23.175.0[.]142\n104.140.244[.]186\n136.243.102[.]157\n5.254.96[.]150\n51.15.56[.]161\n\n**Ignacio Sanmillan**\n\n\n-----\n\nNacho is a security researcher specializing in reverse engineering and malware analysis.\nNacho plays a key role in Intezer\\'s malware hunting and investigation operations, analyzing\nand documenting new undetected threats. Some of his latest research involves detecting\nnew Linux malware and finding links between different threat actors. Nacho is an adept ELF\nresearcher, having written numerous papers and conducting projects implementing state-ofthe-art obfuscation and anti-analysis techniques in the ELF file format.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2019/2019-05-09 - Technical Analysis- Pacha Group Competing against Rocke Group for Cryptocurrency Mining Foothold on the Cloud.pdf"
    ],
    "report_names": [
        "2019-05-09 - Technical Analysis- Pacha Group Competing against Rocke Group for Cryptocurrency Mining Foothold on the Cloud.pdf"
    ],
    "threat_actors": [
        {
            "id": "7c053836-8f50-4d40-bc5c-7088967e1b57",
            "created_at": "2022-10-25T16:07:24.549525Z",
            "updated_at": "2025-03-27T02:02:10.278474Z",
            "deleted_at": null,
            "main_name": "Rocke",
            "aliases": [
                "Aged Libra",
                "Iron Group",
                "Rocke"
            ],
            "source_name": "ETDA:Rocke",
            "tools": [
                "Godlua",
                "Kerberods",
                "LSD",
                "Pro-Ocean",
                "Xbash"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "484c5fed-029e-4504-b75a-bbdbc9460595",
            "created_at": "2022-10-25T16:07:24.529893Z",
            "updated_at": "2025-03-27T02:02:10.273182Z",
            "deleted_at": null,
            "main_name": "Pacha Group",
            "aliases": [],
            "source_name": "ETDA:Pacha Group",
            "tools": [
                "Antd",
                "DDG",
                "GreedyAntd",
                "Korkerds",
                "XMRig"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "18bcbaa6-8e7b-43c4-9db7-8b0b315ee5a3",
            "created_at": "2023-01-06T13:46:39.024086Z",
            "updated_at": "2025-03-27T02:00:02.980081Z",
            "deleted_at": null,
            "main_name": "Pacha Group",
            "aliases": [],
            "source_name": "MISPGALAXY:Pacha Group",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "905eabd9-2b7f-483d-86bd-0c72f96b4162",
            "created_at": "2023-01-06T13:46:39.02749Z",
            "updated_at": "2025-03-27T02:00:02.980813Z",
            "deleted_at": null,
            "main_name": "Rocke",
            "aliases": [
                "Aged Libra"
            ],
            "source_name": "MISPGALAXY:Rocke",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "0b02af5f-2027-42b7-a6f2-51e2fd49ba7f",
            "created_at": "2022-10-25T15:50:23.360509Z",
            "updated_at": "2025-03-27T02:00:55.45329Z",
            "deleted_at": null,
            "main_name": "Rocke",
            "aliases": [
                "Rocke"
            ],
            "source_name": "MITRE:Rocke",
            "tools": null,
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "3fff98c9-ad02-401d-9d4b-f78b5b634f31",
            "created_at": "2023-01-06T13:46:38.376868Z",
            "updated_at": "2025-03-27T02:00:02.818071Z",
            "deleted_at": null,
            "main_name": "Cleaver",
            "aliases": [
                "Cobalt Gypsy",
                "G0003",
                "Operation Cleaver",
                "Op Cleaver",
                "Tarh Andishan",
                "Alibaba",
                "TG-2889"
            ],
            "source_name": "MISPGALAXY:Cleaver",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673535560,
    "ts_updated_at": 1743041674,
    "ts_creation_date": 1653764686,
    "ts_modification_date": 1653764686,
    "files": {
        "pdf": "https://archive.orkl.eu/e2b435b9d39be5ae766eeea3f703284602b6a4ae.pdf",
        "text": "https://archive.orkl.eu/e2b435b9d39be5ae766eeea3f703284602b6a4ae.txt",
        "img": "https://archive.orkl.eu/e2b435b9d39be5ae766eeea3f703284602b6a4ae.jpg"
    }
}