{
    "id": "8e3e1a9a-d15f-4277-bb71-fd9cda4ede3b",
    "created_at": "2023-01-12T15:06:49.219081Z",
    "updated_at": "2025-03-27T02:05:57.931659Z",
    "deleted_at": null,
    "sha1_hash": "c57375b62eecc85ef0f479f582a6d2372c6edba7",
    "title": "2020-03-05 - GuLoader- A Popular New VB6 Downloader that Abuses Cloud Services",
    "authors": "",
    "file_creation_date": "2022-05-28T22:03:23Z",
    "file_modification_date": "2022-05-28T22:03:23Z",
    "file_size": 2390042,
    "plain_text": "# GuLoader: A Popular New VB6 Downloader that Abuses Cloud Services\n\n**[proofpoint.com/us/threat-insight/post/guloader-popular-new-vb6-downloader-abuses-cloud-services](https://www.proofpoint.com/us/threat-insight/post/guloader-popular-new-vb6-downloader-abuses-cloud-services)**\n\nMarch 5, 2020\n\n\n-----\n\n[Blog](https://www.proofpoint.com/us/blog)\n[Threat Insight](https://www.proofpoint.com/us/blog/threat-insight)\nGuLoader: A Popular New VB6 Downloader that Abuses Cloud Services\n\n\n-----\n\nMarch 05, 2020 Proofpoint Threat Research Team\n\nProofpoint researchers have observed a new downloader in the wild that we and other\nresearchers are calling “GuLoader.” Our researchers first observed GuLoader in late\nDecember 2019 being used to deliver Parallax RAT, which itself had recently been released.\nWhile we regularly observe new loaders, GuLoader has gained popularity quickly and is in\nactive use by multiple threat actors. GuLoader is a downloader, written partly in VB6, which\ntypically stores its encrypted payloads on Google Drive or Microsoft OneDrive (underscoring\nthat threat actors continue to adopt the cloud just like legitimate businesses are).\n\nGuLoader is a portable executable (PE) file that is often observed embedded in a container\nfile such as an .iso or .rar file. We have also observed it being downloaded directly from\nvarious cloud hosting platforms. GuLoader is used predominantly to download remote\naccess Trojans (RATs) and information stealers such as Agent Tesla/Origin Logger,\nFormBook, NanoCore RAT, Netwire RAT, Remcos RAT, Ave Maria/Warzone RAT and\nParallax RAT.\n\n**Analysis**\n\nThe GuLoader executable is a Visual Basic 6 wrapper which decrypts (XORing with a\nDWORD, 4-byte key) some shellcode containing the main functionality.\n\n\n-----\n\nThe loader uses sophisticated injection techniques to make analysis difficult. For example, it\n\n1. spawns a child process copy of itself (in suspended state)\n2. maps the image of a system DLL (typically \"msvbvm60.dll\" or \"mstsc.exe\") over the\n\nchild at 0x400000 (instead of a normal high load address)\n3. injects the unpacking code into the child\n4. modifies a register within the context of the suspended child thread to redirect\n\nexecution into the injected code\n5. resumes the child\n6. the child overwrites the system DLL image at 0x400000 with the unpacked code\n\nThe downloaded files consist of 64 hex digits followed by a PE executable encoded with\nXOR, where the XOR key is stored in the shellcode.\n\n**Payload Encoding**\n\nThe payload URI paths (other than Google Drive or OneDrive ones) and downloaded\nfilename frequently have the form \"<something>_encrypted_XXXXXX.bin\" where\n\"XXXXXXX\" are hexadecimal digits.\n\nThe downloaded payloads consist of\n\n\n-----\n\n64 lower-case hex digits\n\n- the XORed PE binary\n\nThe XOR key was fixed at 96 bytes in early versions of the loader\n\nLater versions have longer keys, typically 512-768 bytes long, usually consisting of a 256byte key repeated to give the required length. The key is stored completely in the decoded\nshellcode.\n\n**IOCs**\n\nParallax Sample - 2019-12-23\n\nSHA256: e8f8cc178425c55c03c76d0a2a11918371bba8f2d6f400752ca1cea5e663da2e\n\nURLs: hxxps://drive.google[.]com/uc?export=download&id=1dtlMCyozUPBepcAtEdirGENZBpWesAi\n\nC2: 185.140.53[.]134:7776\n\nRemcos Sample - 2020-02-20\n\nSHA256: 26f7bfe041a3d8a2b620d0ed2af4e2ef54b004202ec479362939b9154b1c8758\n\nURLS: hxxps://drive.google[.]com/uc?\nexport=download&id=1N8gVOM5p8Ubm1HwolChxHidT7YoN29EE\n\nC2: droptop1[.]com:2500\n\nC2: droptop2[.]com:2500\n\nC2: droptop3[.]com:2500\n\n\n-----\n\nC2: droptop4[.]com:2500\n\nC2: droptop5[.]com:2500\n\nC2: droptop6[.]com:2500\n\nC2: droptop7[.]com:2500\n\nC2: droptop8[.]com:2500\n\nC2: droptop9[.]com:2500\n\nC2: droptop10[.]com:2500\n\nSubscribe to the Proofpoint Blog\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2020/2020-03-05 - GuLoader- A Popular New VB6 Downloader that Abuses Cloud Services.pdf"
    ],
    "report_names": [
        "2020-03-05 - GuLoader- A Popular New VB6 Downloader that Abuses Cloud Services.pdf"
    ],
    "threat_actors": [
        {
            "id": "7ba9e3e3-1cef-4e20-be7e-95f05e8295d7",
            "created_at": "2022-10-25T16:07:23.821494Z",
            "updated_at": "2025-03-27T02:02:09.993311Z",
            "deleted_at": null,
            "main_name": "Mabna Institute",
            "aliases": [
                "Cobalt Dickens",
                "Mabna Institute",
                "Silent Librarian",
                "TA407",
                "TA4900",
                "Yellow Nabu"
            ],
            "source_name": "ETDA:Mabna Institute",
            "tools": [],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "adc8bb1a-6ded-4b27-8163-8069d5a6d492",
            "created_at": "2022-10-25T15:50:23.566869Z",
            "updated_at": "2025-03-27T02:00:55.500642Z",
            "deleted_at": null,
            "main_name": "Silent Librarian",
            "aliases": [
                "Silent Librarian",
                "TA407",
                "COBALT DICKENS"
            ],
            "source_name": "MITRE:Silent Librarian",
            "tools": null,
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "42e41377-c64c-4be9-87a0-ee903e4b9055",
            "created_at": "2023-01-06T13:46:38.950322Z",
            "updated_at": "2025-03-27T02:00:02.960397Z",
            "deleted_at": null,
            "main_name": "Silent Librarian",
            "aliases": [
                "TA4900",
                "Yellow Nabu",
                "COBALT DICKENS",
                "Mabna Institute",
                "TA407"
            ],
            "source_name": "MISPGALAXY:Silent Librarian",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673536009,
    "ts_updated_at": 1743041157,
    "ts_creation_date": 1653775403,
    "ts_modification_date": 1653775403,
    "files": {
        "pdf": "https://archive.orkl.eu/c57375b62eecc85ef0f479f582a6d2372c6edba7.pdf",
        "text": "https://archive.orkl.eu/c57375b62eecc85ef0f479f582a6d2372c6edba7.txt",
        "img": "https://archive.orkl.eu/c57375b62eecc85ef0f479f582a6d2372c6edba7.jpg"
    }
}