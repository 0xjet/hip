{
    "id": "5b87e750-0f57-464a-9bbd-f34380e79251",
    "created_at": "2023-01-12T15:06:35.631757Z",
    "updated_at": "2025-03-27T02:05:40.569419Z",
    "deleted_at": null,
    "sha1_hash": "775140e6d23ba4f2e06902a6e1e6b799ae61d212",
    "title": "2021-07-29 - Talos Spotlight- Solarmarker",
    "authors": "",
    "file_creation_date": "2022-05-29T01:31:11Z",
    "file_modification_date": "2022-05-29T01:31:11Z",
    "file_size": 6196727,
    "plain_text": "# Threat Spotlight: Solarmarker\n\n**[blog.talosintelligence.com/2021/07/threat-spotlight-solarmarker.html](https://blog.talosintelligence.com/2021/07/threat-spotlight-solarmarker.html#more)**\n\n_By_ _[Andrew Windsor, with contributions from](https://twitter.com/hostiledata)_ _[Chris Neal.](https://twitter.com/g0jirasan)_\n\n## Executive summary\n\nCisco Talos has observed new activity from Solarmarker, a highly modular .NET-based\ninformation stealer and keylogger.\n\n\n-----\n\nA previous staging module, d.m, used with this malware has been replaced by a new\nmodule dubbed \"Mars.\"\nAnother previously unreported module named \"Uranus\" has been identified.\nThe threat actor behind Solarmarker continues to evolve while remaining relatively\nundetected.\nCisco Talos has created full coverage in response to this evolving threat, protecting\nCisco customers\n\nTalos is actively tracking a malware campaign with the Solarmarker information-stealer\ndating back to September 2020. Some DNS telemetry and related activity even point back to\nApril 2020. At the time, we discovered three primary DLL components and multiple variants\nutilizing similar behavior.\n\nFirst, the initial malicious executable injects the primary component, typically named \"d.m.\"\nThis serves as a stager on the victim host for command and control (C2) communications\nand further malicious actions. The second component, commonly referred to as \"Jupyter,\"\nwas observed being injected by the stager and possesses browser form and other\ninformation-stealing capabilities. Another secondary module, named \"Uran\" (likely in\nreference to Uranus), is a keylogger and was discovered on some of the older campaign\ninfrastructure. Uran was previously undiscovered despite deep analysis on Solarmarker and\nthe Jupyter module.\n\n## Modules\n\nTo provide a more comprehensive description of Solarmarker, we'll break down known and\nunreported modules. Information regarding coverage and defense are detailed at the end of\nthis blog post.\n\n**Staging module \"d.m\"**\n\nThe staging component of Solarmarker serves as the central execution hub, facilitating initial\ncommunications with the C2 servers and enabling other malicious modules to be dropped\nonto the victim host. Within our observed data, the stager is deployed as a .NET assembly\nnamed \"d\" and a single executing class named \"m\" (referred to jointly in this analysis as\n\"d.m\"). The malware extracts a number of files to the victim host's \"AppData\\Local\\Temp\"\ndirectory on execution, including a TMP file with the same name as the original downloaded\n\n\n-----\n\nfile, and a PowerShell script file (PS1), from which the rest of the execution chain spawns.\nThe TMP file executing process issues a PowerShell command that loads the content of the\ndropped PS1 script and runs it before deleting the loaded file. The resulting binary blob is\nthen decoded by XORing its byte array with a hardcoded key and injected into memory\nthrough reflective assembly loading. The \"run\" method of the contained module \"d.m\" is then\ncalled to complete the initial infection.\n\n_Reconstructing the malicious DLL \"d.m\" and invoking it through reflection._\n\nThe module \"d.m\" acts as a system profiler and staging ground for additional action by the\nactor. One particularly interesting operation (as well as the namesake of the campaign) is the\nfile write of \"AppData\\Roaming\\solarmarker.dat,\" which serves as a victim host identification\ntag. When the class method \"GetHWID\" is called, the sample checks if \"solarmarker.dat\"\nexists already on the host. If it does not, a randomly generated 32-character string will be\nwritten to the file \"solarmarker.dat\" at that path. It should be noted that some of the older\nvariants of Solarmarker don't actually use this file for storing the victim ID and instead use\nvarying forms of concatenating and encoding the collected system information strings.\n\nThe newly created or existing string is then returned back as the value for the \"hwid\" field in\na JSON object also containing fields for collected system information. This object is\nsubsequently encoded by XORing the byte array with a hardcoded key, similar to how the\nfirst stage PowerShell script constructed the malicious DLL. This new byte array is then\nfurther encoded in base64 in preparation for transmission to a hardcoded C2 IP address —\n45.135.232[.]131 at the time in many of our samples — through HTTP POST requests.\n\n\n-----\n\n_HTTP POST communications with the C2 using encoded JSON._\n\nThe stager also possesses the ability to remotely receive execution commands by dropping\nnew PS1 or PE files onto the victim system at \"\\AppData\\Local\\Temp\\\" directory with a\nfilename of 24 randomly generated alphanumeric characters and executing them either\nthrough PowerShell or process hollowing, or through directly receiving PowerShell text\ncommands.\n\n**Jupyter information-stealing module**\n\nThe Jupyter information stealer is Solarmarker's second most-dropped module. During the\nexecution of many of the Solarmarker samples, we observed the C2 sending an additional\nPS1 payload to the victim host. Responses from the C2 are encoded in the same manner as\nthe JSON object containing the victim's system information. After reversing the base64 and\nXOR encoding, it writes this byte stream to a PS1 file on disk, runs it, and subsequently\ndeletes the file. This new PowerShell script contains a base64-encoded .NET DLL, which\nwas also injected through .NET's reflective assembly loading. Analysis of the DLL module,\nnamed \"Jupyter,\" shows that it contains capabilities to steal personal information, credentials,\n\n\n-----\n\nand form submission values from the victim s Firefox and Chrome installation and user\ndirectories.\n\n_Decompiled source of one version of the Jupyter DLLs._\n\nLike the \"d.m\" DLL, this module sends information to its C2 server through HTTP POST\nrequests, using a similarly encoded JSON stream containing additional system information\nand stolen data. However, the previous version of the Jupyter DLL we analyzed opts to use a\nhardcoded domain, \"vincentolife[.]com\" in one case, rather than use the same hardcoded IP\naddress as the stager component. The Jupyter module also adds a POST request at the end\nof its execution loop, which queries the C2 domain for additional information and/or\ncommands that could add to the data gathered from its primary execution loop.\n\nUnlike the \"d.m\" DLL, rather than use a similar XOR encoding scheme, the versions of\nJupyter we analyzed use the .NET \"ProtectedData\" class to encrypt the data being sent to\nSolarmarker's C2 servers. This keeps the encoding scheme less exposed to static and\nmanual analysis by using .NET's native APIs, in contrast to the hard-coded key values and\ncustom encoding logic in the PowerShell scripts and \"d.m\" DLL. Additionally, by including the\n\"CurrentUser\" flag for the data protection scope argument in the \"Unprotect\" method call, the\nencryption key is effectively binded to a specific user. This complicates any attempts at\noutside decryption and analysis of the raw data being communicated between the victim host\nand the C2 server, even with possession of the \"Jupyter\" DLL itself.\n\n**Previously Unreported Module: Uran/Uranus**\n\n\n-----\n\nFurther research into the actor's infrastructure revealed a previously unreported second\npotential payload, \"Uranus,\" keeping in line with Solarmarker's penchant for space-themed\nnames. It is derived from the file \"Uran.PS1\" (Uran is the Russian word for Uranus) hosted\non Solarmarker's infrastructure at \"on-offtrack[.]biz/get/uran.ps1.\" Like our observed\ninstances of the Jupyter module being dropped, Uranus starts off as a PS1 file served\nthrough the staging DLL. Similar to the other components, the PS1 file was encoded through\na simple bitwise XOR of each byte in the file. Going back through some of the encodedecode class methods found in both the variants of the staging component and Jupyter\nmodule allowed us to match Uranus with the correct decoding method. Upon execution, the\nPowerShell script reflectively loads the DLL class, \"Uran,\" on the victim host and initiates its\n\"Run\" method.\n\nAnalysis of the Uranus module reveals it to be a form of keylogging malware. When the\n\"Run\" method is executed, the malware instantiates a \"LogCollector\" class object. Its\nfunctionality is relatively straightforward, but makes impressive use of a variety of tools within\nthe .NET runtime API. The \"LogCollector\" makes use of other utility classes contained within\nthe Uranus DLL to capture the user's keystrokes and relevant metadata in order to\ncontextualize and sort the actions better. For example, it will look for available input\nlanguages and keyboard layouts installed on the victim host and attach their two letter ISO\ncodes as additional attributes to the keylogging data collected. Interestingly, in this case, the\nactor checks specifically for German and Russian character sets, before defaulting to an\nEnglish label. The current foreground window titles are also used as sorting keys in the\ndictionary object that the \"LogCollector\" class uses to store its captured input text.\n\n\n-----\n\n_Decompiled source of the Uranus keylogger DLL._\n\nExtraction is set to occur every 10,000 seconds using a thread sleep call to delay Uranus'\nevent loop. This module also uses HTTP POST requests as its primary method of\ncommunications with Solarmarker's C2 infrastructure. This version of the DLL has the\nhostname \"hxxp://spacetruck[.]biz:82/postk?q=\" hard-coded as the destination for the data\nheld by \"LogCollector.\" The query string consists of two components. First, a grouping of\nsystem metadata, such as the victim ID, version string, and computer name are constructed\nas a JSON object and converted to base64. Unlike the variants that used the\n\"solarmarker.dat\" file filled with random characters as a victim identifier, this version of the\nmodule instead uses a combined string of the victim host's username, computer name and\nhard drive serial number. The byte representation of this string is then run through a byteshift and XOR algorithm to produce the victim identification string. Secondly, the dictionary\nobject containing the keylogging data created by \"LogCollector\" is also converted to base64\nand appended to the query string text. Finally, the POST request is sent and the event loop\nbegins again.\n\n## Previously unreported activity\n\nSolarmarker's general execution flow hasn't significantly changed between versions, updates\n\n\n-----\n\nand variants. The actor wants to install a backdoor in memory on the victim host so that it\nmay be used as a staging ground for further payloads, such as Jupyter. However, around the\nend of May and beginning of June 2021, Talos began observing surges of new Solarmarker\nactivity in our telemetry. In these recent iterations, the actor tweaked the download method of\nthe initial parent dropper and has made noticeable upgrades to the staging component, now\ncalled \"Mars.\" During our research on earlier campaign activity, Talos initially believed that\nvictims were downloading Solarmarker's parent malicious PE files through generic-looking,\nfake file-sharing pages hosted across free site services, but many of the dummy accounts\nhad become inactive between the time we found the filenames used by Solarmarker's\ndroppers in our telemetry and attempting to find their download URLs. This method of\n[delivery was later corroborated by malware analysts at CrowdStrike in their own reporting on](https://www.crowdstrike.com/blog/solarmarker-backdoor-technical-analysis/)\nSolarmarker. For example, we saw several download pages being hosted under suspicious\naccounts on Google Sites. In these cases, the URL for a given file took the form of:\n```\nhxxps://sites[.]google[.]com/view/{random characters}/{file name}\n\n```\nThese links direct the victim to a page offering the ability to download the file as either a PDF\nor Microsoft Word file. Following the download link sends the victim through multiple redirects\nacross varying domains before landing on a final download page.\n\nThis general methodology hasn't changed, many of the parent file names found in our\ntelemetry can be found on suspicious web pages hosted on Google Sites, although the actor\nhas changed their final lure pages a bit.\n\n_Example of one of the initial landing pages hosted on Google Sites._\n\n\n-----\n\nPreviously, the Solarmarker samples from our telemetry would be downloaded from a final\npage with an overly generic header name, \"PdfDocDownloadsPanel.\" In this more recent\ncampaign, Solarmarker's operators have put some additional effort into making their final\ndownload page more legitimate looking, as well as differentiating it from the older pages\nexposed in public reporting. The final download page now attempts to mimic a download file\nrequest from Google Drive, although the page is hosted under a rotating actor-controlled\ndomain.\n\n_Example of a final lure page meant to mimic Google Drive._\n\n**Mars staging module**\n\nUpdated Solarmarker variants possessing the newly observed Mars DLL, which took the\nplace of the original stager component \"d.m,\" infect a victim host through two currently\nknown execution chains. The first uses a second-stage dropper after initial execution of the\nparent file that contains a decoy program PDFSam as well as the Mars DLL bytes and\nsubsequently executed PowerShell to complete Solarmarker's later stages and persistence\nmeasures. The second version has the same overall execution chain as the first, but\nhardcodes all of the data and instructions from the second-stage dropper into the parent file\nitself, cutting out the need to write an additional file to disk and execute it. These are based\non observations within available telemetry. Given the actor's penchant for deploying many\n\n\n-----\n\ndifferent versions of Solarmarker and its modules, it is likely that the adversary added\nvariations on the execution chain and different paths and names for the dropped files.\n\nUsing the version with the second-stage dropper as an example, the main file drops a\nsecond stage PE, named \"pk.exe,\" which acts as the springboard for the rest of this\nSolarmarker variant's execution chain. It writes a copy of the utility program PDFSam to\n\"\\AppData\\Local\\Temp\\gkNjg0918jkd.exe.\" This program is executed in tandem with the rest\nof Solarmarker's initialization to act as misdirection for the victim by attempting to look like a\nlegitimate document. The main PowerShell script that will serve as the next execution stage\nis also written to disk at \"\\AppData\\Local\\Temp\\tskAjbflM1jj.\" The PE then opens a shell and\nexecutes a PowerShell constructed from inside the binary).\n\n_Powershell embedded in pk.exe used in the next stage of execution._\n\nThe PowerShell command executed will read in the base64-encoded text from the\n\"tskAjbflM1jj\" file and subsequently delete this file from the victim's hard drive. Next, it will\nXOR the decoded bytes using a hardcoded alphanumeric key string, in this case:\nxk='ovRsNQkSWZXFaYUDHPAdmlhGfrjOenBtbzEqpwIxMycTCgiuKJLV.'\n\nAfter the bytes are XOR'd, the resulting string is another PowerShell script, which is then\nexecuted through the Invoke-Expression cmdlet.\n\nThis second PowerShell script contains the Mars DLL hardcoded within it, along with the final\nstages of Solarmarker's initial execution. The DLL file is written to disk at:\n\n\"%USER%\\APPDATA\\ROAMING\\MiCrOSofT\\<Random string of 5-20 characters>\\<Random\nstring of 10-20 characters>\"\n\nThe actual file write is done by looping through the Mars DLL byte array while injecting\nrandom bytes into the file so that the actual malicious DLL doesn't sit on the victim's disk.\nThe script will then construct a PowerShell command that reads the newly written file and\n\n\n-----\n\nreverses the byte manipulation, as well as performing byte XORing with another hardcoded\nkey, similar to the previous PowerShell command. The result is the actual Mars DLL, which is\nloaded through assembly reflection and executed by calling the \"Interact\" method from the\n\"Mars.Deimos\" class. Finally, the script sets up persistence measures by creating a startup\ntask that copies the final PowerShell command and re-runs the execution of the Mars DLL. It\nwill try to create this through the PowerShell Register-ScheduledTask cmdlet, and upon that\naction failing, will instead create a WScript object containing the PowerShell command to\nload and execute the Mars DLL and write it to a shortcut file in the victim's startup folder\nnamed \"a8a85b041dc4c2bfc00abf64d546d.LnK\".\n\n_PowerShell script setting up persistence measures and invoking the Mars DLL._\n\nAfter the dropper's intermediate stages of execution are completed, the Mars module is\nreconstructed from a file written to disk after being run through an XOR algorithm in\nPowerShell, similar to the campaign's previous execution chains. The resulting malicious\nDLL file is loaded through .NET's assembly reflection using PowerShell and invoked by\ncalling the \"Interact\" method of the \"Mars.Deimos\" class.\n\nAs mentioned above, the second version of the execution chain forgoes the secondary\ndropper file and instead has the information contained in \"pk.exe\" encoded in the parent PE\nfile. In these samples, the decoy program PDFSam was written to the hardcoded location of\n\"%USER%\\AppData\\Local\\Temp\\CMmnnjAi1984unbd.exe,\" while the encoded PS1 file is\nwritten to disk at \"%USER%\\AppData\\Local\\Temp\\FkJB11kdJJhbdDl.\" The remainder of the\nexecution is similar to the one stemming from \"pk.exe.\"\n\n\n-----\n\n_Second stage PowerShell code now embedded in the parent PE file._\n\nDecompilation of the DLL shows that it first gathers some initial system information about the\nvictim host, such as the Workgroup name, is the user a system administrator, system name,\ncurrent user, and Windows version. This information is collected through execution calls to\ndifferent methods inside of the Deimos class and the results are collected into a JSON text\nstring and sent to Solarmarker's C2 server through HTTP POST requests. Previous\ncomponents would alternate between using hostnames and IP addresses to contact the C2\nserver. In this case, these versions of the Mars module use a hardcoded IP value:\n46[.]102[.]152[.]102. This C2 host had not been observed in older versions of Solarmarker's\ncomponents previously analyzed.\n\n\n-----\n\n_Decompiled code from a non-obfuscated Mars DLL._\n\nLike the previous stager, the Mars module also remotely receives execution commands by\ndropping new files onto the victim system and spawning processes to run them, or through\ndirect PowerShell text commands. During the execution of the DLL's \"Begin\" method, if the\n\"flag\" boolean variable is set to \"false,\" the malware on the victim host is set to receive a file\nor command response from the C2. For file responses, the sample expects either a PS1 or\nPE file based on the values associated with the \"status,\" \"task_id\" and \"type\" keys in the\nJSON object. The received bytes are written to the \"\\AppData\\Local\\Temp\\\" directory with a\nfilename of 24 randomly generated alphanumeric characters. If Mars receives a PowerShell\ncommand string, the command is executed directly without writing anything to disk. These\nfiles are then subsequently deleted from the victim's hard drive. In inspecting network\ncommunication from the earlier Solarmarker campaign, we observed the Jupyter module\ndropping through a PS1 file.\n\nThe Mars module also uses a more complex encryption scheme than its predecessor to\nbetter obfuscate the data sent to and from the C2 server. Previously, Solarmarker would use\na combination of base-64 encoding and a bitwise XOR algorithm, or a simple implementation\nof .NET's default encryption scheme, to encode the JSON being sent back and forth in the\nHTTP POST traffic. The actor now uses a 16 byte, randomly generated AES symmetric key\nto encrypt the data sent to and from the C2 host, which is created during the Mars DLL's\ninitial execution. This key is sent with the victim identification string back to the actor's C2 in\nthe first HTTP request, which is itself encrypted using an RSA asymmetric key pair. The\npublic key is hardcoded within the Mars DLL, making the symmetric key, and thus, a\nreadable version of the POST JSON data much more difficult to obtain in general practice.\n\n\n-----\n\nLike the d.m and Jupyter modules, the Mars DLL has a few different versions. At the time of\nwriting, five different variants are seen in our telemetry and VirusTotal data. These\npossessed the identifiers: \"IN-1,\" \"IN-2,\" \"IN-3,\" \"IN-9\" and \"IN-10.\" Most of Solarmarker's\nvariants have left the \"solarmarker.dat\" artifact on disk that makes it easy to identify the\nactor's activity. As previously mentioned, some of the older variants of Solarmarker don't\nactually use this file for storing the victim ID and instead use varying forms of concatenating\nand encoding the collected system information strings, but for most of the observed\ninstances between October 2020 and June 2021 this file is present. However, Solarmarker's\noperators appear to have noticed this and have attempted to further obfuscate their modules,\nmaking it more difficult for defensive measures to detect specifically on the \"solarmarker.dat\"\nfile.\n\nThe higher versioned variants of Mars, \"IN-9'' and \"IN-10,\" no longer use the\n\"solarmarker.dat\" file to house the victim's identification string. Instead, they use the\nrandomly generated 32-character string as the text file name and the file's contents. The\ncheck to see if \"solarmarker.dat\" already exists on a victim has also been changed to cycle\nthrough all the file names in the path \"%USER%\\APPDATA\\ROAMING\" and look for a file\nwhose name is equivalent to the extracted text within it. These versions also attempt to\nobfuscate the C# code itself by using the Dotfuscator packer, thereby frustrating efforts at\nanalyzing its decompiled form.\n\n_Mars DLL that has been obfuscated through Dotfuscator._\n\n## Targets\n\nAt its core, the Solarmarker campaign appears to be conducted by a fairly sophisticated\nactor largely focused on credential and residual information theft. The specific extraction of\nbrowser forum captures, cookie data, and credential database files in the Jupyter module,\nalong with the keylogging component of the Uranus module lends further credence to a\nspecific interest in credential harvesting The targeted language component of the keylogger\n\n\n-----\n\nsuggests that the actor could have a heightened geographical interest in Europe, or it does\nnot have the ability to process text in languages outside of English, German or Russian.\nDuring initialization, the class object responsible for monitoring the victim's keypresses\nchecks specifically whether the current host's keyset language code is one of those three\nlanguages. If the returned language code is none of these, it defaults to labeling its captured\ntext as English. This really only attaches specificity to German or Russian-speaking victims,\nas it indiscriminately mixes other language sets that use variants of the Latin script and nonLatin languages, such as the CJK group, all under the umbrella of \"English.\" Regardless,\nthey are not particular or overly careful as to which victims are infected with their malware.\nThis is evidenced by the large variety of composition for the parent file names and the\nabsence of similar geographical checks on the victim systems before dropping and executing\nany of the later-stage modules.\n\nDuring this recent surge in the campaign, Talos observed the health care, education, and\nmunicipal governments verticals being targeted the most often. These sectors were followed\nby a smaller grouping of manufacturing organizations, along with a few individual\norganizations in religious institutions, financial services and construction/engineering.\nDespite what appears to be a concentration of victimology among a few verticals, we assess\nwith moderate confidence that this campaign is not targeting any specific industries, at least\nnot intentionally. The variety of naming in Solarmarker's lure files is too great to be of any\nspecific relevance to a targeted industry. To this point, we originally suspected that the actor\nmay have been scraping document file names across the web to use as file names for its\n[dropper. Researchers at Microsoft have also stated they believe the Solarmarker campaign](https://mobile.twitter.com/MsftSecIntel/status/1403461414899970051)\nis using SEO poisoning in order to make their dropper files highly visible in search engine\nresults. This could also potentially skew what types of organizations are likely to come\nacross the malicious files depending on what is topically popular at the time.\n\nOrganizations should be particularly concerned about the modular nature and information\nstealing capabilities of this malware family. Solarmarker has so far shown to split, not only its\nstaging activity, but also final payloads of varying functionality into separate DLL\ncomponents. Using the staging DLL, the malware can then execute whichever payload\nmodule they choose, some of which may be previously undiscovered. The modules already\nobserved make potential victims vulnerable to having sensitive information stolen, including\nsensitive browser usage, such as if they enter their credit card number or other personal\ninformation. These attackers may also look to steal login credentials, which could then be\nused for lateral movement into other systems or to access and steal even more enticing\ndata, such as a customer or patient medical information database.\n\n## Threat actor\n\nThere are indicators and evidence suggesting that Russian language speakers created\nSolarmarker, or the creators at least designed it to look that way. Static and dynamic analysis\n\n\n-----\n\nof Solarmarker s droppers revealed attributes in the executables resource section that\nindicate the files were created on a system with Russian language support. The keylogging\nmodule's name, \"Uran,\" is a transliteration of the Russian word for Uranus, \"Уран,\" and\nRussian was listed as a targeted language in the module itself. The name of the browser\ncredential and information stealer, \"Jupyter,\" could also be an attempted transliteration or\ntranslation of the Russian equivalent for Jupiter, \"Юпитер,\" albeit an odd one. A more\ncommonly accepted transliteration for a native Russian speaker would be \"Yupiter.\" The\nnames for the \"Mars\" module and its class object \"Deimos\" work both as direct English words\nand possible transliterations of their Russian equivalents, \"Марс\" and \"Деймос.\"\n\nCharacter use and substitution doesn't have universally applied rules in Russian when using\nthe Latin alphabet. Therefore, the naming scheme is not all that odd within the given context.\n[Security researchers from Morphisec, in their analysis of the Jupyter module, also pointed](https://www.morphisec.com/hubfs/eBooks_and_Whitepapers/Jupyter%20Infostealer%20WEB.pdf)\nout similar indicators of the actor potentially being Russia-based, such as possibly\nmisspelling the English \"Jupiter\" and the hardcoded IP addresses being hosted on\n\"SELECTEL,\" a Russian ASN, which was also true for IP addresses found in other modules\nand Solarmarker variants during earlier stages of the campaign. While it is interesting to\nhighlight this pattern, and other circumstantial evidence, it is important to note that this is not\nsufficient to assign any high-confidence attribution. All of these components are fairly easy to\nmanipulate into arbitrary values by the actor, and thus, without additional evidence, could just\nas well be false flags.\n\n## Conclusion\n\nThe actor behind the Solarmarker campaign possesses moderate to advanced capabilities.\nMaintaining the amount of interconnected and rotating infrastructure and generating a\nseemingly limitless amount of differently named initial dropper files requires substantial effort.\nThe actor also exhibits determination in ensuring the continuation of their campaign, such as\nupdating the encryption methods for the C2 communication in the Mars DLL after\nresearchers had publicly picked apart previous components of the malware, in addition to the\nmore typical strategy of cycling out the C2 infrastructure hosts.\n\nThere are several proactive and remedial actions to mitigate the risk of infection, data theft,\nand potential further action post-infection by Solarmarker. Initial execution of Solarmarker is\nseemingly reliant on the user willingly downloading and opening its parent file. Organizations\nneed to educate users on the risks of downloading and executing files from unvetted or\nsuspicious sources on the internet.\n\nThere are other aspects to the malware that are more susceptible to active defense\nmeasures. Restricting the use of administrative tools, in this case PowerShell, can help\nprevent any of Solarmarker's numerous scripts from executing. Solarmarker's observed C2\ncomponents are hardcoded into their respective DLLs. Monitoring for any traffic to either the\nIP address or domain name can reveal which endpoints have been affected on a network\n\n\n-----\n\nand how far the infection has progressed. Blocking traffic to and from both of these indicators\neffectively hamstrings Solarmarker's ability to receive further instructions from its operators\nand to exfiltrate any collected data from the victim host. Using multi-factor authentication can\nhelp prevent immediate account compromise if a victim believes their information and\ncredentials have already been stolen. This also provides cover time to cycle out the\ncredentials for any affected accounts. Finally, ensuring that sensitive systems are properly\nsegmented, have correct privilege requirements, and are not unnecessarily facing the\ninternet can prevent lateral movement by the actor using stolen credentials and data\nexfiltration to their C2 server.\n\nSolarmarker's ongoing campaign and associated family of malware are concerning. It was\ninitially able to operate and evolve over a significant amount of time while remaining\nrelatively undetected. Its ability to receive and drop additional files, in addition to executing\nPowerShell commands from the actor's C2, opens up the possibility of future updates and\nevolutions of Solarmarker's child modules, as well as additional functionalities through new\nmalicious components being developed by the actor. We expect the actor behind\nSolarmarker to continue to refine their malware and tools, as well as alternate their C2\ninfrastructure, in order to prolong their campaign for the foreseeable future. As stated above,\nSolarmarker's operators have already shown a willingness and ability to update their tactics,\ntechniques, and procedures (TTPs) based on points of exposure in previous iterations.\n\n## Coverage\n\nWays our customers can detect and block this threat are listed below.\n\n\n-----\n\n[Cisco Secure Endpoint is ideally suited to prevent the execution of the malware detailed in](https://www.cisco.com/c/en/us/products/security/amp-for-endpoints/index.html)\n[this post. New users can try Cisco Secure Endpoint for free here.](https://www.cisco.com/c/en/us/products/security/amp-for-endpoints/free-trial.html?utm_medium%3Dweb-referral%26utm_source%3Dcisco%26utm_campaign%3Damp-free-trial%26utm_term%3Dpgm-talos-trial%26utm_content%3Damp-free-trial)\n\n[Cisco Secure Web Appliance web scanning prevents access to malicious websites and](https://www.cisco.com/c/en/us/products/security/web-security-appliance/index.html)\ndetects malware used in these attacks.\n\n[Cisco Secure Firewall and](https://www.cisco.com/c/en/us/products/security/firewalls/index.html) [Meraki MX can detect malicious activity associated with this](https://meraki.cisco.com/products/appliances)\nthreat.\n\n[Cisco Secure Malware Analytics helps identify malicious binaries and build protection into all](https://www.cisco.com/c/en/us/solutions/enterprise-networks/amp-threat-grid/index.html)\nCisco Security products.\n\n[Cisco Umbrella, our secure internet gateway (SIG), blocks users from connecting to](https://umbrella.cisco.com/)\nmalicious domains, IPs, and URLs, whether users are on or off the corporate network.\n\nAdditional protections with context to your specific environment and threat data are available\nfrom the [Cisco Secure Firewall Management Center.](https://www.cisco.com/c/en/us/products/security/firepower-management-center/index.html)\n\nOpen Source Snort Subscriber Rule Set customers can stay up to date by downloading the\n[latest rule pack available for purchase on Snort.org.](https://www.snort.org/products)\n\nThe following ClamAV signatures have been released to detect this threat as well as tools\nand malware related to these campaigns:\n\n\n-----\n\nWin.Trojan.Solarmarker-9832983-0\nWin.Dropper.SolarMarker-9867952-0\nWin.Trojan.Jupiter-9858780-0\n\nOpen Source Snort Subscriber Rule Set customers can stay up to date by downloading the\n[latest rule pack available for purchase on Snort.org.](https://www.snort.org/products)\n\nThe following SIDs have been released to detect this threat: 57973-57974\n\n[Cisco Secure Endpoint (AMP) users can use Orbital Advanced Search to run complex](https://orbital.amp.cisco.com/help/%2523:~:text%253DCisco%252520Orbital%252520(%2525E2%252580%25259COrbital%2525E2%252580%25259D),(Creators%252520Update)%252520or%252520later.)\nOSqueries to see if their endpoints are infected with this specific threat. For specific\n[OSqueries on this threat, click here](https://github.com/Cisco-Talos/osquery_queries/commit/74e240eb0ce8fff10bae80b9b5c5557ec5ad0ad4)\n\n**IOCs**\n\nIPs:\n\n45.135.232[.]131\n\n46.102.152[.]102\n\nHostnames:\n\nhxxp://on-offtrack[.]biz/get/uran.ps1\n\nhxxp://spacetruck[.]biz:82\n\nhxxp://vincentolife[.]com\n\nSHA256:\n\n99e5a83a5f8e9fb7850922aed9a44bbc2b2a03f5fdda215db4d375bd1952536d - parent\ndropper\n\n3b79aab07b9461a9d4f3c579555ee024888abcda4f5cc23eac5236a56bf740c7 - parent\ndropper\n\n77fa1b6fc7f192b0c983d1f8ecc73effae4f688a49439a7df27e76cfba870d23 - parent dropper\n\n032b09bbf1c63afc06afb011d69bafc096d7d925d99e24e3785db5a2957358ec - parent\ndropper\n\na871b7708b7dc1eb6fd959946a882a5af7dafc5ac135ac840cfbb60816024933 - parent\ndropper\n\n187e204c5c30b9b56ccc82df510c4c215cdfd37b475d1edba9a0631a4d82ae2e - parent\ndropper\n\n1252f2bf3817714a8303f7e448930d6d4f797a70ec7effc80f2b1db5e49b9077 - parent dropper\n\n7240e51c027e498e71da4006e261409fcf3a5cf5b912d493a9da91199c840059 - parent\ndropper\n\n3039dddbcfb26326ba2e8692316ca674753fa6e1d141c887dc1e9f1ae546ca17 - \"pk.exe\"\n\n\n-----\n\nsecond stage dropper\n056f373077ca5b6a070975b22839d6f427cbcaeaec4dc31df86231cd3757f7e3 - Mars DLL\n10fc8f8cf1b45a6a6b2b929414a84fc513f80d31b988c3d70f9a21968e943bf2 - Mars DLL\n1bd39e3ee0d59ac691cc644c026b6c5bb3d0713f6e4e2136b94f161558a4444f - Mars DLL\ne7d165f3728b96921b43984733a92a51148ec87aec900c519a547c470e2a12d9 - Mars DLL\neebaec0f28addac39549ebf9be659e105046b1c9801381d4c4dd07cfc74d25d6 - Mars DLL\n870f691ec9a83e9c4acce142e0acbf110260e6c8e707410c23c02076244f3973 - Mars DLL\n573631c92d34e7ca2dfc1a590606bd66194d517f8d97dd319169262ac46b3e2e - Mars DLL\nconstruction PS1 script\nb29e6b570a96224c874b9fae36b65db9e9b8c6e1081f18cf87e56bd996470c22 - Mars DLL\nconstruction PS1 script\n0a11002a0f390fb6e4933fead0521032f8a9ede7ced27f75011d8a30c5772376 - Uran DLL\n721bb4554f8e6615dd9e10e28765cf42882c00e1d04f808d8f766b51fdf4d7e6 - Uran\nconstruction PS1 script\n83b50b18ebfa4402b2c0d2d166565ee90202f080d903fd15cccd1312446a636e \"CMmnnjAi1984unbd.exe\" and \"gkNjg0918jkd.exe\" decoy program \"PDFSam\"\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-07-29 - Talos Spotlight- Solarmarker.pdf"
    ],
    "report_names": [
        "2021-07-29 - Talos Spotlight- Solarmarker.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673535995,
    "ts_updated_at": 1743041140,
    "ts_creation_date": 1653787871,
    "ts_modification_date": 1653787871,
    "files": {
        "pdf": "https://archive.orkl.eu/775140e6d23ba4f2e06902a6e1e6b799ae61d212.pdf",
        "text": "https://archive.orkl.eu/775140e6d23ba4f2e06902a6e1e6b799ae61d212.txt",
        "img": "https://archive.orkl.eu/775140e6d23ba4f2e06902a6e1e6b799ae61d212.jpg"
    }
}