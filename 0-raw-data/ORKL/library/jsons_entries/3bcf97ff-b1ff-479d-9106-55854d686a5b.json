{
    "id": "3bcf97ff-b1ff-479d-9106-55854d686a5b",
    "created_at": "2023-01-12T15:05:15.26838Z",
    "updated_at": "2025-03-27T02:09:30.015711Z",
    "deleted_at": null,
    "sha1_hash": "9b085b9070fd887bd75f7191d71a9788c59b230a",
    "title": "2022-08-03 - Gwisin Ransomware Targeting Korean Companies",
    "authors": "",
    "file_creation_date": "2022-09-01T10:28:32Z",
    "file_modification_date": "2022-09-01T10:28:32Z",
    "file_size": 1894081,
    "plain_text": "# Gwisin Ransomware Targeting Korean Companies\n\n**asec.ahnlab.com/en/37483**\n\nAugust 3, 2022\n\nThe cases of Gwisin ransomware attacking Korean companies are recently on the rise. It is being distributed to target\nspecific companies. It is similar to Magniber in that it operates in the MSI installer form. Yet unlike Magniber which\ntargets random individuals, Gwisin does not perform malicious behaviors on its own, requiring a special value for the\nexecution argument. The value is used as key information to run the DLL file included in the MSI.\n\nAs such, the file alone does not perform ransomware activities on security products of various sandbox environments,\nmaking it difficult to detect Gwisin. The ransomware’s internal DLL operates by being injected into a normal Windows\nprocess. The process is different for each infected company.\n\nThe following shows the characteristics of Gwisin that have been identified so far.\n\n(1) Distributed in an MSI installer file form\n\n(2) Uses the argument value used to run MSI to run internal DLL\n(3) Performs ransomware behaviors by being injected into a Windows system process\n\n(4) Contains the information of the infected company inside the DLL (displayed in the ransom note)\n\n(5) Supports a feature to encrypt files in safe mode\n\nWhen the MSI file is run, it calls the export function update() of the internal ransomware DLL. The function checks the\nexecution argument. If it is abnormal, the function will not operate.\n\n\n-----\n\nFigure 1. Routine for checking argument upon running MSI\n\nAt the moment of the encryption process, the ransomware is executed with the following arguments (some parts of the\narguments are hidden).\n\n- msiexec /qn /i C:\\ProgramData\\*****.msi SERIAL=463f********7ce7 LICENSE=7f21********5071 SMM=0 ORG=***\n\nAmong arguments that are needed to run Gwisin, SMM can have a value of 0 or 1. Normally, the routine for encrypting\nfiles is processed if the value is 0. If SMM is 1, the ransomware is installed to operate on safe mode. It first copies\nitself to a certain path of ProgramData and is registered as a service. It then uses bcdedit to set the boot option as\nsafe mode. The computer is forcibly rebooted after 5 seconds. After the system is rebooted in safe mode, the\nregistered service starts encrypting files.\n\n**Service Name** **Command**\n\na35f23725b5feab2 - msiexec /qn /i\nC:\\ProgramData\\*****.msi SERIAL=463f********7ce7 LICENSE=7f21********5071 SMM=0 ORG=***\n\nRegistered service\nWhen the process for verifying the argument ends, the ransomware decrypts the internal shellcode using the\narguments. It then runs a normal program “certreq.exe” to inject the decrypted shellcode. The injected shellcode\nultimately decrypts Gwisin to run it in the memory (besides “certreq.exe”, various normal Window processes are used\nto run the ransomware).\n\nFigure 2. Process tree of Gwisin\n\nAfter encrypting files, the ransomware changes the extension name to the name of the targeted company.\n\nFigure 3. Encrypted files\n\nThe folder chosen to be encrypted contains a ransom note. The name of the note also contains the extension string\nsuch as “!!!_HOW_TO_UNLOCK_******_FILES_!!!.TXT“. The note file shows a list of stolen information and contacts.\n\n\n-----\n\nFigure 4. Ransom note of Gwisin\n\nFigure 5. Desktop after being infected\nThe Gwisin cases show that the anti-malware products are neutralized before the infection process begins. As V3\nproducts block Gwisin ransomware using such a method in the injection process through behavior-based detection, it\nis necessary to enable the ‘Behavior-based Detection’ option.\n\nBecause the ransomware is installed and executed in various systems after dominating the internal system,\ncompanies must analyze how the infection happened in the first place. If the cause of the infection cannot be analyzed\nafter a breach had occurred, another ransomware may infect the system in the future and cause a similar incident.\n\n\n-----\n\n**[File Detection]**\n– Ransomware/Win.Gwisin.C5214965 (2022.07.27.03)\n\n**[Behavior Detection]**\n\n– Injection/MDP.Event.M4387 (2022.07.28.00)\n\n**Subscribe to AhnLab’s next-generation threat intelligence platform ‘AhnLab TIP’ to check related IOC and**\n**detailed analysis information.**\n\n[Categories:Malware Information](https://asec.ahnlab.com/en/category/malware-information/)\n\n[Tagged as:APT,](https://asec.ahnlab.com/en/tag/apt-en/) [Gwisin,](https://asec.ahnlab.com/tag/gwisin/) [Ransomware](https://asec.ahnlab.com/en/tag/ransomware-en/)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-08-03 - Gwisin Ransomware Targeting Korean Companies.pdf"
    ],
    "report_names": [
        "2022-08-03 - Gwisin Ransomware Targeting Korean Companies.pdf"
    ],
    "threat_actors": [
        {
            "id": "aa73cd6a-868c-4ae4-a5b2-7cb2c5ad1e9d",
            "created_at": "2022-10-25T16:07:24.139848Z",
            "updated_at": "2025-03-27T02:02:10.120505Z",
            "deleted_at": null,
            "main_name": "Safe",
            "aliases": [],
            "source_name": "ETDA:Safe",
            "tools": [
                "DebugView",
                "LZ77",
                "OpenDoc",
                "SafeDisk",
                "TypeConfig",
                "UPXShell",
                "UsbDoc",
                "UsbExe"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535915,
    "ts_updated_at": 1743041370,
    "ts_creation_date": 1662028112,
    "ts_modification_date": 1662028112,
    "files": {
        "pdf": "https://archive.orkl.eu/9b085b9070fd887bd75f7191d71a9788c59b230a.pdf",
        "text": "https://archive.orkl.eu/9b085b9070fd887bd75f7191d71a9788c59b230a.txt",
        "img": "https://archive.orkl.eu/9b085b9070fd887bd75f7191d71a9788c59b230a.jpg"
    }
}