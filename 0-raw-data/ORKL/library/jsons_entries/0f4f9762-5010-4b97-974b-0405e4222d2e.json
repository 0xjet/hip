{
    "id": "0f4f9762-5010-4b97-974b-0405e4222d2e",
    "created_at": "2022-10-25T16:48:11.865705Z",
    "updated_at": "2025-03-27T02:12:36.951339Z",
    "deleted_at": null,
    "sha1_hash": "c8f8d4cea73e6941d5b6bfe0caffbdd26d0ace2d",
    "title": "PLATINUM continues to evolve, find ways to maintain invisibility",
    "authors": "Microsoft",
    "file_creation_date": "2017-06-28T03:45:56Z",
    "file_modification_date": "0001-01-01T00:00:00Z",
    "file_size": 256668,
    "plain_text": "#, y invisibility\n\n**blogs.technet.microsoft.com** [/mmpc/2017/06/07/platinum-continues-to-evolve-find-ways-to-maintain-invisibility/](https://blogs.technet.microsoft.com/mmpc/2017/06/07/platinum-continues-to-evolve-find-ways-to-maintain-invisibility/)\n\n\nmsft-mmpc\n\n\nJune 7,\n2017\n\n\nBack in April 2016, we released the paper _[PLATINUM: Targeted attacks in South and Southeast Asia](http://download.microsoft.com/download/2/2/5/225BFE3E-E1DE-4F5B-A77B-71200928D209/Platinum feature article - Targeted attacks in South and Southeast Asia April 2016.pdf)_, where we\ndetailed the tactics, techniques, and procedures of the PLATINUM activity group.\n\nWe described a group that was well-resourced and quickly adopted advanced techniques, such as [hot patching to](https://blogs.technet.microsoft.com/mmpc/2016/04/26/digging-deep-for-platinum/)\nsilently inject code into processes. They used hot patching even when traditional injection techniques could have\nbeen sufficient and less costly to develop.\n\nSince the 2016 publication, Microsoft has come across an evolution of PLATINUM’s file-transfer tool, one that uses\nthe Intel® Active Management Technology (AMT) Serial-over-LAN (SOL) channel for communication. This channel\nworks independently of the operating system (OS), rendering any communication over it invisible to firewall and\nnetwork monitoring applications running on the host device. Until this incident, no malware had been discovered\nmisusing the AMT SOL feature for communication.\n\nUpon discovery of this unique file-transfer tool, Microsoft shared information with Intel, and the two companies\ncollaborated to analyze and better understand the purpose and implementation of the tool. We confirmed that the\ntool did not expose vulnerabilities in the management technology itself, but rather misused AMT SOL within target\nnetworks that have already been compromised to keep communication stealthy and evade security applications.\n\nThe updated tool has only been seen in a handful of victim computers within organizational networks in Southeast\nAsia—PLATINUM is known to customize tools based on the network architecture of targeted organizations. The\ndiagram below represents the file-transfer tool’s updated channel and network flow.\n\n\n-----\n\n_Figure 1. PLATINUM file-transfer tool network flow_\n\nThe AMT SOL feature is _not enabled by default and requires administrator privileges to provision for usage on_\nworkstations. It is currently unknown if PLATINUM was able to provision workstations to use the feature or\npiggyback on a previously enabled workstation management feature. In either case, PLATINUM would need to have\ngained administrative privileges on targeted systems prior to the feature’s misuse.\n\n## AMT Serial-over-LAN (SOL) communication channel\n\nActive Management Technology (AMT) enables remote management of devices and is provided as a feature of\nIntel® vPro™ processors and chipsets. AMT runs in the Intel Management Engine (ME), which runs its own\noperating system to execute on an embedded processor located in the chipset (Platform Controller Hub, PCH). As\nthis embedded processor is separate from the primary Intel processor, it can execute even when the main processor\nis powered off and is therefore able to provide out-of-band (OOB) remote administration capabilities such as remote\npower-cycling and keyboard, video, and mouse control (KVM).\n\nAMT h S i l LAN (SOL) f t th t i t l i l d i ith hi t id d h l\n\n\n-----\n\n_Figure 2. AMT SOL device_\n\nThis functionality works independently of the device host operating system networking stack—the ME makes use of\nits own networking stack and has access to the hardware network interface. This means that even if networking is\ndisabled on the host, SOL will still function as long as the device is physically connected to the network.\n\n_Figure 3. AMT SOL component stack_\n\nFurthermore, as the SOL traffic bypasses the host networking stack, it cannot be blocked by firewall applications\nrunning on the host device. To enable SOL functionality, the device AMT must be provisioned. Also, establishment of\na SOL session requires a username and password—usually selected during device provisioning. The tool would\ntherefore require the relevant credentials to establish such a session.\n\nOne possibility is that PLATINUM might have obtained compromised credentials from victim networks. Another\n\n\n-----\n\nThere are several methods for provisioning AMT. The most straightforward is _host-based provisioning_ _(HBP), which_\ncan be done from within the host Windows OS itself and requires administrator permissions. During the provisioning\nprocess, PLATINUM could select whichever username and password they wish. HBP enables access to a subset of\nAMT functionality, which includes SOL but restricts access to other features such as KVM redirect.\n\n## How PLATINUM uses SOL\n\nIn the first version of the file-transfer tool, which we described in the [original paper, network communication is done](http://download.microsoft.com/download/2/2/5/225BFE3E-E1DE-4F5B-A77B-71200928D209/Platinum feature article - Targeted attacks in South and Southeast Asia April 2016.pdf)\nover TCP/IP by utilizing the regular network APIs. The presentation layer protocol is straightforward: the buffer is\nmade up of a two-byte header—the indication length—and the Blowfish-encrypted payload data itself.\n\n_Figure 4. TCP protocol length header and payload_\n\nThe new SOL protocol within the PLATINUM file-transfer tool makes use of the AMT Technology SDK’s Redirection\nLibrary API (imrsdk.dll). Data transactions are performed by the calls IMR_SOLSendText()/IMR_SOLReceiveText(),\nwhich are analogous to networking send() and recv() calls. The SOL protocol used is identical to the TCP protocol\nother than the addition of a variable-length header on the data for error detection. Also, the updated client sends an\nunencrypted packet with the content “007″ before authentication.\n\n_Figure 5. AMT SOL protocol error-detection header, length header, and payload_\n\nThe new header has various fields to detect possible data corruption errors, including a CRC-16 and a binary index\nof the bytes having the set of most significant bits (MSB).\n\n\n-----\n\nThe following video demonstrates how the PLATINUM tool can be used to transfer malware to a computer with AMT\nprovisioned:\n\n## Detecting unusual binaries that use AMT\n\nIf an attacker who has access to AMT credentials attempts to use the SOL communication channel on a computer\n[running Windows Defender ATP](http://aka.ms/wdatp), behavior analytics coupled with machine learning can detect the targeted attack\nactivity. Windows Defender ATP displays an alert similar to the one shown below. Windows Defender ATP can\ndifferentiate between legitimate usage of AMT SOL and targeted attacks attempting to use it as a communication\nchannel.\n\n_Figure 7. Windows Defender ATP detection of malicious AMT SOL channel activity_\n\nThe PLATINUM tool is, to our knowledge, the first malware sample observed to misuse chipset features in this way.\nWhile the technique used here by PLATINUM is OS independent, Windows Defender ATP can detect and notify\nnetwork administrators of attempts to leverage the AMT SOL communication channel for unauthorized activity,\nspecifically when used against a computer running Windows.\n\nAt Microsoft, we continuously monitor the threat landscape for novel techniques used for malicious purposes. We\nalso constantly build mechanisms that mitigate resulting risks and protect customers. The discovery of this new\nPLATINUM technique and the development of detection capabilities highlight the work the Windows Defender ATP\nteam does to provide customers greater visibility into suspicious activities transpiring on their networks.\n\n_Microsoft reiterates that the PLATINUM tool does not expose flaws in Intel® Active Management Technology (AMT),_\n_but uses the technology within an already compromised network to evade security monitoring tools._\n\n**S** **f** **S**\n\n\n-----\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "d63ae2b7-445f-460d-965d-2676dacdb6de",
            "created_at": "2022-10-25T15:59:19.552139Z",
            "updated_at": "2022-10-25T15:59:19.552139Z",
            "deleted_at": null,
            "name": "APTnotes",
            "url": "https://github.com/aptnotes/data",
            "description": "APTnotes data",
            "reports": null
        }
    ],
    "references": [
        "https://app.box.com/s/iryvk6gcqx4qyzfn245ruoo7syyex2yv"
    ],
    "report_names": [
        "Microsoft_PLATINUM-evolve-find-ways-to-maintain-invisibility(06-07-2017)"
    ],
    "threat_actors": [
        {
            "id": "33f527a5-a5da-496a-a48c-7807cc858c3e",
            "created_at": "2022-10-25T15:50:23.803657Z",
            "updated_at": "2025-03-27T02:00:55.550132Z",
            "deleted_at": null,
            "main_name": "PLATINUM",
            "aliases": [
                "PLATINUM"
            ],
            "source_name": "MITRE:PLATINUM",
            "tools": [
                "JPIN",
                "Dipsind",
                "adbupd"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "7d8ef10e-1d7b-49a0-ab6e-f1dae465a1a4",
            "created_at": "2023-01-06T13:46:38.595679Z",
            "updated_at": "2025-03-27T02:00:02.869216Z",
            "deleted_at": null,
            "main_name": "PLATINUM",
            "aliases": [
                "TwoForOne",
                "G0068",
                "ATK33"
            ],
            "source_name": "MISPGALAXY:PLATINUM",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "e61c46f7-88a1-421a-9fed-0cfe2eeb820a",
            "created_at": "2022-10-25T16:07:24.061767Z",
            "updated_at": "2025-03-27T02:02:10.094583Z",
            "deleted_at": null,
            "main_name": "Platinum",
            "aliases": [
                "ATK 33",
                "Operation EasternRoppels",
                "TwoForOne"
            ],
            "source_name": "ETDA:Platinum",
            "tools": [
                "AMTsol",
                "Adupib",
                "Adupihan",
                "Dipsind",
                "DvDupdate.dll",
                "JPIN",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "RedPepper",
                "RedSalt",
                "Titanium",
                "adbupd",
                "psinstrc.ps1"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1666716491,
    "ts_updated_at": 1743041556,
    "ts_creation_date": 1498621556,
    "ts_modification_date": 0,
    "files": {
        "pdf": "https://archive.orkl.eu/c8f8d4cea73e6941d5b6bfe0caffbdd26d0ace2d.pdf",
        "text": "https://archive.orkl.eu/c8f8d4cea73e6941d5b6bfe0caffbdd26d0ace2d.txt",
        "img": "https://archive.orkl.eu/c8f8d4cea73e6941d5b6bfe0caffbdd26d0ace2d.jpg"
    }
}