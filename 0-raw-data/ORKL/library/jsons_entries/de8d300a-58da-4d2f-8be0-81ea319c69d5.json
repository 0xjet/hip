{
    "id": "de8d300a-58da-4d2f-8be0-81ea319c69d5",
    "created_at": "2022-10-25T16:48:11.295586Z",
    "updated_at": "2025-03-27T02:16:05.86967Z",
    "deleted_at": null,
    "sha1_hash": "07798378a61e5b51e15ec24e0c28cdfba50fedf1",
    "title": "",
    "authors": "",
    "file_creation_date": "2017-10-24T06:27:22Z",
    "file_modification_date": "2017-10-24T06:27:22Z",
    "file_size": 4536260,
    "plain_text": "##### E[vidence Aurora Operation Still Active Part 2: More] Ties Uncovered Between CCleaner Hack & Chinese Hackers\n\n# 02\n\n#### OCT 2017\n\n###### Since my last post, we have found new evidence in the next stage\n\n payloads of the CCleaner supply chain attack that provide a stronger link\n\n between this attack and the Axiom group.\n\n First of all, our researchers would like to thank the entire team at Cisco\n\n Talos for their excellent work on this attack (their post regarding stage 2\n\n can be found here) as well as their cooperation by allowing us access to\n\n the stage 2 payload. Also, we would like to give a special thanks to\n\n Kaspersky Labs for their collaboration.\n\n\n-----\n\n###### Starting from the stage 2 payload, I reverse engineered the module,\n\n extracting other hidden shellcode and binaries within. After uploading the\n\n di�erent binaries to Intezer Analyze™, the �nal payload (that I have access\n\n to) had a match with a binary relating to the Axiom group.\n\n At �rst glance, I believed it was going to be the same custom base64\n\n function as mentioned in my previous blog post. A deeper look in the\n\n shared code proved otherwise.\n\n Binary in screenshot:\n\n f0d1f88c59a005312faad902528d60acbf9cd5a7b36093db8ca811f763e129\n\n 2a\n\n Related APT17 samples:\n\n 07f93e49c7015b68e2542fc591ad2b4a1bc01349f79d48db67c53938ad4b5\n\n 25d\n\n 0375b4216334c85a4b29441a3d37e61d7797c2e1cb94b14cf6292449fb25c\n\n 7b2\n\n 20cd49fd0f244944a8f5ba1d7656af3026e67d170133c1b3546c8b2de38d4f\n\n 27\n\n ee362a8161bd442073775363bf5fa1305abac2ce39b903d63df0d7121ba60\n\n 550\n\n\n-----\n\n###### Not only did the �rst payload have shared code between the Axiom group\n\n and CCBkdr, but the second did as well. The above photo shows the same\n\n function between two binaries. Let me put this into better context for you:\n\n out of all the billions and billions of pieces of code (both trusted and\n\n malicious) contained in the Intezer Code Genome Database, we found this\n\n code in only these APTs. It is also worth noting that this isn’t a standard\n\n method one would use to call an API. The attacker used the simple\n\n technique of employing an array to hide a string from being in clear sight\n\n of those analyzing the binary (although to those who are more\n\n experienced, it is obvious) and remain undetected from antivirus\n\n\n-----\n\n###### what often happens to avoid duplicative e�orts: rewriting the same code\n\n for the same functionality twice.\n\n Due to the uniqueness of the shared code, we strongly concluded that the\n\n code was written by the same attacker.\n\n Technical Analysis:\n\n The stage two payload that was analyzed in this report\n\n (dc9b5e8aa6ec86db8af0a7aa897ca61db3e5f3d2e0942e319074db1aaccfd\n\n c83), after launching the infected version of CCleaner, was dropped to\n\n only a selective group of targets, as reported by Talos. Although there is\n\n an x64 version, the following analysis will only include the x86 version\n\n because they are nearly identical. I will not be going too far in depth as full\n\n comprehension of the technical analysis will require an understanding of\n\n reverse engineering.\n\n Instead of using the typical API (VirtualAlloc) to allocate memory, the\n\n attackers allocated memory on the heap using LocalAlloc, and then copied\n\n a compressed payload to the allocated memory.\n\n\n-----\n\n###### It looks like the attackers used version 1.1.4 of zlib to decompress the\n\n payload into this allocated memory region.\n\n\n-----\n\n###### Depending on if you’re running x86 or x64 Windows, it will drop a\n\n di�erent module. (32-bit\n\n 07fb252d2e853a9b1b32f30ede411f2efbb9f01e4a7782db5eacf3f55cf3490\n\n 2, 64-bit\n\n 128aca58be325174f0220bd7ca6030e4e206b4378796e82da460055733bb\n\n 6f4f) Both modules are actually legitimate software with additional code\n\n and a modi�ed execution �ow.\n\n\n-----\n\n###### The last modi�ed time on the modules is changed to match that of the\n\n msvcrt.dll that is located in your system32 folder–a technique to stay\n\n under the radar by not being able to check last modi�ed �les.\n\n\n-----\n\n###### Some shellcode and another module are written to the registry.\n\n\n-----\n\n###### After the module is successfully dropped, a service is created under the\n\n name Spooler or SessionEnv, depending upon your environment, which\n\n then loads the newly dropped module.\n\n\n-----\n\n###### The new module being run by the service allocates memory, reads the\n\n registry where the other payload is located, and then copies it to memory.\n\n\n-----\n\n###### The next payload is executed, which decrypts another module and loads\n\n it. If we look at the memory of the next decrypted payload, we can see\n\n something that looks like a PE header without the MZ signature. From\n\n here, it is as simple as modifying the �rst two bytes to represent MZ and\n\n we have a valid PE �le.\n\n (f0d1f88c59a005312faad902528d60acbf9cd5a7b36093db8ca811f763e129\n\n 2a)\n\n\n-----\n\n###### The next module is a essentially another backdoor that connects to a few\n\n domains; before revealing the true IP, it will connect to for the next stage\n\n payload.\n\n\n-----\n\n###### It starts by ensuring it receives the correct response from\n\n https://www.microsoft.com and https://update.microsoft.com.\n\n\n-----\n\n###### The malware proceeds to decrypt two more URLs.\n\n The malware authors used steganography to store the IP address in a\n\n ptoken �eld of the HTML.\n\n Here you can see the GitHub page with the ptoken �eld.\n\n\n-----\n\n###### The value is then XOR decrypted by 0x31415926 which gives you\n\n 0x5A093B0D or the IP address: 13.59.9.90\n\n Conclusion:\n\n The complexity and quality of this particular attack has led our team to\n\n conclude that it was most likely state-sponsored. Considering this new\n\n evidence, the malware can be attributed to the Axiom group due to both\n\n the nature of the attack itself and the speci�c code reuse throughout that\n\n our technology was able to uncover.\n\n IOCs:\n\n Stage 2 Payload:\n\n dc9b5e8aa6ec86db8af0a7aa897ca61db3e5f3d2e0942e319074db1aaccfdc\n\n 83\n\n x86 Trojanized Binary:\n\n 07fb252d2e853a9b1b32f30ede411f2efbb9f01e4a7782db5eacf3f55cf3490\n\n 2\n\n\n-----\n\n###### f0d1f88c59a005312faad902528d60acbf9cd5a7b36093db8ca811f763e129\n\n 2a\n\n x64 Trojanized Binary:\n\n 128aca58be325174f0220bd7ca6030e4e206b4378796e82da460055733bb\n\n 6f4f\n\n x64 Registry Payload:\n\n 75eaa1889dbc93f11544cf3e40e3b9342b81b1678af5d83026496ee6a1b2ef\n\n 79\n\n Registry Keys:\n\n HKLM\\Software\\Microsoft\\Windows NT\\CurrentVersion\\WbemPerf\\001\n\n HKLM\\Software\\Microsoft\\Windows NT\\CurrentVersion\\WbemPerf\\002\n\n HKLM\\Software\\Microsoft\\Windows NT\\CurrentVersion\\WbemPerf\\003\n\n HKLM\\Software\\Microsoft\\Windows NT\\CurrentVersion\\WbemPerf\\004\n\n HKLM\\Software\\Microsoft\\Windows NT\\CurrentVersion\\WbemPerf\\HBP\n\n About Intezer:\n\n Through its ‘DNA mapping’ approach to code, Intezer provides enterprises\n\n with unparalleled threat detection that accelerates incident response and\n\n eliminates false positives, while protecting against �leless malware, APTs,\n\n code tampering and vulnerable software.\n\n Curious to learn what’s next for Intezer? Join us on our journey toward achieving\n\n these endeavors here on the blog or request a community free edition invite\n\n\n-----\n\nJay Rosenberg is a self-taught reverse engineer from a very young\nage (12 years old), specializing in Reverse Engineering and Malware\nAnalysis. Currently working as a Senior Security Researcher in\nIntezer.\n\n\n[Evidence Aurora Operatio…](http://www.intezer.com/evidence-aurora-operation-still-active-supply-chain-attack-through-ccleaner/) [North Korea And Iran Use …](http://www.intezer.com/north-korea-iran-use-codeproject-develop-malware/)\n\n##  \n\n\n###### Home\n\n Products\n\n Intezer Analyze™\n\n Intezer Immune™\n\n Technology\n\n Company\n\n\n-----\n\n###### News and Events\n\n Contact Us\n\n Blog\n\n Terms of Use\n\n Privacy Policy\n\n[](https://twitter.com/intezerlabs) [](https://www.linkedin.com/company/intezer-labs) [](https://www.facebook.com/IntezerLabs/)\n\n\n© Intezer.com 2017 All rights reserved\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        }
    ],
    "references": [
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2017/2017.10.02.Aurora_Operation_CCleaner_II/Aurora_Operation_CCleaner_II.pdf"
    ],
    "report_names": [
        "Aurora_Operation_CCleaner_II"
    ],
    "threat_actors": [
        {
            "id": "cea5ceec-0f14-4e34-bd0e-4074bc1a707d",
            "created_at": "2022-10-25T15:50:23.629983Z",
            "updated_at": "2025-03-27T02:00:55.509459Z",
            "deleted_at": null,
            "main_name": "Axiom",
            "aliases": [
                "Group 72"
            ],
            "source_name": "MITRE:Axiom",
            "tools": [
                "ZxShell",
                "gh0st RAT",
                "Zox",
                "PlugX",
                "Hikit",
                "PoisonIvy",
                "Derusbi",
                "Hydraq"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "2150d1ac-edf0-46d4-a78a-a8899e45b2b5",
            "created_at": "2022-10-25T15:50:23.269339Z",
            "updated_at": "2025-03-27T02:00:55.416524Z",
            "deleted_at": null,
            "main_name": "APT17",
            "aliases": [
                "APT17",
                "Deputy Dog"
            ],
            "source_name": "MITRE:APT17",
            "tools": [
                "BLACKCOFFEE"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "5c74936a-79d1-41b8-81eb-01d03c90a26b",
            "created_at": "2022-10-25T16:07:23.371052Z",
            "updated_at": "2025-03-27T02:02:09.766782Z",
            "deleted_at": null,
            "main_name": "Axiom",
            "aliases": [
                "Group 72",
                "Operation SMN"
            ],
            "source_name": "ETDA:Axiom",
            "tools": [
                "9002 RAT",
                "Agent.dhwf",
                "AngryRebel",
                "BlackCoffee",
                "BleDoor",
                "Chymine",
                "Darkmoon",
                "DeputyDog",
                "Derusbi",
                "Destroy RAT",
                "DestroyRAT",
                "Farfli",
                "Fexel",
                "Gen:Trojan.Heur.PT",
                "Gh0st RAT",
                "Ghost RAT",
                "Gresim",
                "HOMEUNIX",
                "HiKit",
                "HidraQ",
                "Homux",
                "Hydraq",
                "Kaba",
                "Korplug",
                "McRAT",
                "MdmBot",
                "Moudour",
                "Mydoor",
                "PCRat",
                "PNGRAT",
                "PlugX",
                "Poison Ivy",
                "RbDoor",
                "RedDelta",
                "RibDoor",
                "Roarur",
                "SPIVY",
                "Sensocode",
                "Sogu",
                "TIGERPLUG",
                "TVT",
                "Thoper",
                "Winnti",
                "Xamtrav",
                "ZXShell",
                "Zox",
                "ZoxPNG",
                "ZoxRPC",
                "gresim",
                "pivy",
                "poisonivy"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "a7aefdda-98f1-4790-a32d-14cc99de2d60",
            "created_at": "2023-01-06T13:46:38.281844Z",
            "updated_at": "2025-03-27T02:00:02.792526Z",
            "deleted_at": null,
            "main_name": "APT17",
            "aliases": [
                "G0025",
                "AURORA PANDA",
                "Group 72",
                "G0001",
                "HELIUM",
                "Group 8",
                "Hidden Lynx",
                "Tailgater Team",
                "BRONZE KEYSTONE"
            ],
            "source_name": "MISPGALAXY:APT17",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "4c68ccd0-caba-4189-9ead-86ac4c2d9b70",
            "created_at": "2024-05-01T02:03:07.930196Z",
            "updated_at": "2025-03-27T02:05:17.251237Z",
            "deleted_at": null,
            "main_name": "BRONZE ATLAS",
            "aliases": [
                "Axiom",
                "BARIUM ",
                "Blackfly ",
                "CTG-2633",
                "GREF",
                "Group 72 ",
                "Red Kelpie ",
                "TG-2633 ",
                "Wicked Panda ",
                "Winnti",
                "APT41 "
            ],
            "source_name": "Secureworks:BRONZE ATLAS",
            "tools": [
                " CCleaner v5.33 backdoor",
                " ChinaChopper",
                " Cobalt Strike",
                " Dicey MSDN",
                " ForkPlayground",
                " HUC Proxy Malware (Htran)",
                " Mimikatz",
                " PipeMon",
                " PlugX",
                " PortReuse",
                " Powershell Empire",
                " RCMD",
                " RbDoor",
                " SPEEDBOAT",
                " ShadowPad",
                " Sidewalk",
                " Speculoos",
                " TeamViewer",
                " Winnkit",
                " Winnti",
                " reg save",
                " vssadmin",
                "Acehash"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "1edcac0b-efd9-47b1-9aca-33827d5bd085",
            "created_at": "2024-05-01T02:03:07.964773Z",
            "updated_at": "2025-03-27T02:05:17.273595Z",
            "deleted_at": null,
            "main_name": "BRONZE KEYSTONE",
            "aliases": [
                "Aurora Panda ",
                "DeputyDog ",
                "Group 72 ",
                "Hidden Lynx ",
                "Shell Crew",
                "TG-8153 ",
                "Tailgater Team",
                "APT17 "
            ],
            "source_name": "Secureworks:BRONZE KEYSTONE",
            "tools": [
                " BlackCoffee",
                " DeputyDog",
                " Derusbi",
                " Gh0stHTTPSDropper",
                " HiKit",
                " InternalCMD",
                " PlugX",
                " PoisonIvy",
                " ZxShell",
                "9002"
            ],
            "source_id": "Secureworks",
            "reports": null
        }
    ],
    "ts_created_at": 1666716491,
    "ts_updated_at": 1743041765,
    "ts_creation_date": 1508826442,
    "ts_modification_date": 1508826442,
    "files": {
        "pdf": "https://archive.orkl.eu/07798378a61e5b51e15ec24e0c28cdfba50fedf1.pdf",
        "text": "https://archive.orkl.eu/07798378a61e5b51e15ec24e0c28cdfba50fedf1.txt",
        "img": "https://archive.orkl.eu/07798378a61e5b51e15ec24e0c28cdfba50fedf1.jpg"
    }
}