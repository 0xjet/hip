{
    "id": "05fa3f8b-3757-4b7e-a9bc-8e96112f704d",
    "created_at": "2023-01-12T14:59:26.123387Z",
    "updated_at": "2025-03-27T02:05:33.928385Z",
    "deleted_at": null,
    "sha1_hash": "3bc4eb19ca12dedba299125f3a5299f2f4f3b357",
    "title": "2018-05-23 - New VPNFilter malware targets at least 500K networking devices worldwide",
    "authors": "",
    "file_creation_date": "2022-05-28T21:43:58Z",
    "file_modification_date": "2022-05-28T21:43:58Z",
    "file_size": 340499,
    "plain_text": "# New VPNFilter malware targets at least 500K networking devices worldwide\n\n**blog.talosintelligence.com/2018/05/VPNFilter.html**\n\n## Intro\n\nFor several months, Talos has been working with public- and private-sector threat\nintelligence partners and law enforcement in researching an advanced, likely statesponsored or state-affiliated actor's widespread use of a sophisticated modular malware\nsystem we call \"VPNFilter.\" We have not completed our research, but recent events have\nconvinced us that the correct way forward is to now share our findings so that affected\nparties can take the appropriate action to defend themselves. In particular, the code of this\n\n\n-----\n\nmalware overlaps with versions of the BlackEnergy malware — which was responsible for\nmultiple large-scale attacks that targeted devices in Ukraine. While this isn't definitive by any\nmeans, we have also observed VPNFilter, a potentially destructive malware, actively\ninfecting Ukrainian hosts at an alarming rate, utilizing a command and control (C2)\ninfrastructure dedicated to that country. Weighing these factors together, we felt it was best to\npublish our findings so far prior to completing our research. Publishing early means that we\ndon't yet have all the answers — we may not even have all the questions — so this blog\nrepresents our findings as of today, and we will update our findings as we continue our\ninvestigation.\n\nBoth the scale and the capability of this operation are concerning. Working with our partners,\nwe estimate the number of infected devices to be at least 500,000 in at least 54 countries.\nThe known devices affected by VPNFilter are Linksys, MikroTik, NETGEAR and TP-Link\nnetworking equipment in the small and home office (SOHO) space, as well at QNAP\nnetwork-attached storage (NAS) devices. No other vendors, including Cisco, have been\nobserved as infected by VPNFilter, but our research continues. The behavior of this malware\non networking equipment is particularly concerning, as components of the VPNFilter\nmalware allows for theft of website credentials and monitoring of Modbus SCADA protocols.\nLastly, the malware has a destructive capability that can render an infected device unusable,\nwhich can be triggered on individual victim machines or en masse, and has the potential of\ncutting off internet access for hundreds of thousands of victims worldwide.\n\nThe type of devices targeted by this actor are difficult to defend. They are frequently on the\nperimeter of the network, with no intrusion protection system (IPS) in place, and typically do\nnot have an available host-based protection system such as an anti-virus (AV) package. We\nare unsure of the particular exploit used in any given case, but most devices targeted,\nparticularly in older versions, have known public exploits or default credentials that make\ncompromise relatively straightforward. All of this has contributed to the quiet growth of this\nthreat since at least 2016.\n\nThis post provides the technical findings you would normally see in a Talos blog. In addition,\nwe will detail some thoughts on the tradecraft behind this threat, using our findings and the\nbackground of our analysts, to discuss the possible thought process and decisions made by\nthe actor. We will also discuss how to defend against this threat and how to handle a device\nthat may be infected. Finally, we will share the IOCs that we have observed to this point,\nalthough we are confident there are more that we have not seen.\n\n### Brief technical breakdown\n\nThe VPNFilter malware is a multi-stage, modular platform with versatile capabilities to\nsupport both intelligence-collection and destructive cyber attack operations.\n\n\n-----\n\nThe stage 1 malware persists through a reboot, which sets it apart from most other malware\nthat targets internet-of-things devices because malware normally does not survive a reboot\nof the device. The main purpose of stage 1 is to gain a persistent foothold and enable the\ndeployment of the stage 2 malware. Stage 1 utilizes multiple redundant command and\ncontrol (C2) mechanisms to discover the IP address of the current stage 2 deployment\nserver, making this malware extremely robust and capable of dealing with unpredictable C2\ninfrastructure changes.\n\nThe stage 2 malware, which does not persist through a reboot, possesses capabilities that\nwe have come to expect in a workhorse intelligence-collection platform, such as file\ncollection, command execution, data exfiltration and device management. However, some\nversions of stage 2 also possess a self-destruct capability that overwrites a critical portion of\nthe device's firmware and reboots the device, rendering it unusable. Based on the actor's\ndemonstrated knowledge of these devices, and the existing capability in some stage 2\nversions, we assess with high confidence that the actor could deploy this self-destruct\ncommand to most devices that it controls, regardless of whether the command is built into\nthe stage 2 malware.\n\nIn addition, there are multiple stage 3 modules that serve as plugins for the stage 2 malware.\nThese plugins provide stage 2 with additional functionality. As of this writing, we are aware of\ntwo plugin modules: a packet sniffer for collecting traffic that passes through the device,\nincluding theft of website credentials and monitoring of Modbus SCADA protocols, and a\ncommunications module that allows stage 2 to communicate over Tor. We assess with high\nconfidence that several other plugin modules exist, but we have yet to discover them.\n\n\n-----\n\n### Tradecraft discussion\n\nWe assess with high confidence that this malware is used to create an expansive, hard-toattribute infrastructure that can be used to serve multiple operational needs of the threat\nactor. Since the affected devices are legitimately owned by businesses or individuals,\nmalicious activity conducted from infected devices could be mistakenly attributed to those\nwho were actually victims of the actor. The capabilities built into the various stages and\nplugins of the malware are extremely versatile and would enable the actor to take advantage\nof devices in multiple ways.\n\nAdvanced threat actors, including nation-states, will try to make attribution of their cyber\nactivities extremely difficult, unless it is in their interest for it to be openly known that they\nconducted a specific act. To this end, advanced threat actors use multiple techniques,\nincluding co-opting infrastructure owned by someone else to conduct their operations. The\nactor could easily use devices infected with this malware as hop points before connecting to\ntheir final victim in order to obfuscate their true point of origin.\n\nThe malware can also be leveraged to collect data that flows through the device. This could\nbe for straightforward data-collection purposes, or to assess the potential value of the\nnetwork that the device serves. If the network was deemed as having information of potential\ninterest to the threat actor, they may choose to continue collecting content that passes\n\n\n-----\n\nthrough the device or to propagate into the connected network for data collection. At the time\nof this posting, we have not been able to acquire a third-stage plugin that would enable\nfurther exploitation of the network served by the device. However, we have seen indications\nthat it does exist, and we assess that it is highly likely that such an advanced actor would\nnaturally include that capability in malware that is this modular.\n\nFinally, this malware could be used to conduct a large-scale destructive attack by using the\n\"kill\" command, which would render some or all of the physical devices unusable. This\ncommand is present in many of the stage 2 samples we've observed, but could also be\ntriggered by utilizing the \"exec\" command available in all stage 2 samples. In most cases,\nthis action is unrecoverable by most victims, requiring technical capabilities, know-how, or\ntools that no consumer should be expected to have. We are deeply concerned about this\ncapability, and it is one of the driving reasons we have been quietly researching this threat\nover the past few months.\n\n### Observed activities of concern\n\nAs we have researched this threat, we have put into place monitoring and scanning to gain\nan understanding of the scope of this threat and the behaviors of infected devices. Our\nanalysis has shown that this is a global, broadly deployed threat that is actively seeking to\nincrease its footprint. While our research continues, we have also observed activity\npotentially associated with this actor that indicates possible data exfiltration activity.\n\nIn early May, we observed infected devices conducting TCP scans on ports 23, 80, 2000 and\n8080. These ports are indicative of scanning for additional Mikrotik and QNAP NAS devices,\nwhich can be found using these ports. These scans targeted devices in more than 100\ncountries.\n\nWe also used our telemetry to discover potentially infected devices globally. We evaluated\ntheir collective behavior to try and identify additional features of the C2 infrastructure. Many\nof these victim IPs appeared to demonstrate behavior that strongly indicated data exfiltration.\n\nFinally, on May 8, we observed a sharp spike in VPNFilter infection activity. Almost all of the\nnewly acquired victims were located in Ukraine. Also of note, a majority of Ukrainian\ninfections shared a separate stage 2 C2 infrastructure from the rest of the world, on IP\n46.151.209[.]33. By this point, we were aware of the code overlap between BlackEnergy and\nVPNFilter and that the timing of previous attacks in Ukraine suggested that an attack could\nbe imminent. Given each of these factors, and in consultation with our partners, we\nimmediately began the process to go public before completing our research.\n\nAs we continued to move forward with the public disclosure, we observed another substantial\nincrease in newly acquired VPNFilter victims focused in Ukraine on May 17. This continued\nto drive our decision to publish our research as soon as possible.\n\n\n-----\n\nDiagram 1. New observed VPNFilter infections over time\n\n### Defending against this threat\n\nDefending against this threat is extremely difficult due to the nature of the affected devices.\nThe majority of them are connected directly to the internet, with no security devices or\nservices between them and the potential attackers. This challenge is augmented by the fact\nthat most of the affected devices have publicly known vulnerabilities which are not\nconvenient for the average user to patch. Additionally, most have no built-in anti-malware\ncapabilities. These three facts together make this threat extremely hard to counter, resulting\nin extremely limited opportunities to interdict malware, remove vulnerabilities, or block\nthreats.\n\nDespite these challenges, Talos has released protections for this threat from multiple angles,\nto try to take advantage of the limited options that exist. We developed and deployed more\nthan 100 Snort signatures for the publicly known vulnerabilities for the devices that are\nassociated with this threat. These rules have been deployed in the public Snort set, and can\nbe used by anyone to help defend their devices. In addition, we have done the usual\nblocklisting of domains/IPs as appropriate and convicting of the hashes associated with this\nthreat to cover those who are protected by the Cisco Security ecosystem. We have reached\nout to Linksys, Mikrotik, Netgear, TP-Link and QNAP regarding this issue. (Note: QNAP has\nbeen aware of certain aspects of VPNFilter and previously done work to counter the threat )\n\n\n-----\n\nFinally, we have also shared these indicators and our research with international law\n[enforcement and our fellow members of the Cyber Threat Alliance in advance of this](https://www.cyberthreatalliance.org/)\npublication so they could move quickly to help counter this threat more broadly.\n\n### Recommendations\n\nWe recommend that:\n\nUsers of SOHO routers and/or NAS devices reset them to factory defaults and reboot\nthem in order to remove the potentially destructive, non-persistent stage 2 and stage 3\nmalware.\nInternet service providers that provide SOHO routers to their users reboot the routers\non their customers' behalf.\nIf you have any of the devices known or suspected to be affected by this threat, it is\nextremely important that you work with the manufacturer to ensure that your device is\nup to date with the latest patch versions. If not, you should apply the updated patches\nimmediately.\nISPs work aggressively with their customers to ensure their devices are patched to the\nmost recent firmware/software versions.\n\nDue to the potential for destructive action by the threat actor, we recommend out of an\nabundance of caution that these actions be taken for all SOHO or NAS devices, whether or\nnot they are known to be affected by this threat.\n\n### Multi-Stage Technical Details\n\n**Exploitation**\n\nAt the time of this publication, we do not have definitive proof on how the threat actor is\nexploiting the affected devices. However, all of the affected makes/models that we have\nuncovered had well-known, public vulnerabilities. Since advanced threat actors tend to only\nuse the minimum resources necessary to accomplish their goals, we assess with high\nconfidence that VPNFilter required no zero-day exploitation techniques.\n\n**Stage 1 (persistent loader)**\n\nVPNFilter's stage 1 malware infects devices running firmware based on Busybox and Linux,\nand is compiled for several CPU architectures. The main purpose of these first-stage\nbinaries is to locate a server providing a more fully featured second stage, and to download\nand maintain persistence for this next stage on infected devices. It is capable of modifying\nnon-volatile configuration memory (NVRAM) values and adds itself to crontab, the Linux job\nscheduler, to achieve persistence. This is a departure from previous IoT malware, like Mirai,\nwhich is ephemeral and disappears with a simple device reboot.\n\n\n-----\n\nTalos analyzed samples for MIPS and x86 processors. The C2 communication and additional\nmalware downloads occur over Tor or SSL-encrypted connections. While the binaries\nthemselves are not obfuscated beyond being stripped, some strings are stored in an\nencrypted form, and are only decrypted at runtime. The decryption routine looked\nsuspiciously similar to RC4 in the static analysis, but it looks like the malware authors got the\ninitialization of the S-boxes wrong. During the permutation step, values are XOR’d, but not\nswapped. Analysis of this RC4 implementation shows that it is identical to the\nimplementation used in BlackEnergy, which is believed by law enforcement agencies to\noriginate with a state actor.\n\nThe RC4 initialization XORs the values in the permutation phase of the internal state\ninitialization. As you can see in the last basic block, the code doesn't swap the values of S[i]\nand S[j] (compared to the RC4 pseudo code below).\n\n\n-----\n\nOnce the malware has completed initialization, it starts to download pages from the seed\nURLs. In the MIPS sample cache and all but one URL of the x86 sample, the URLs pointed\nto Photobucket.com, an image-sharing host. The malware downloads the first image from\nthe gallery the URL is referencing, and then proceeds to extract the download server's IP\naddress. The IP address is extracted from six integer values for GPS latitude and longitude\nin the EXIF information.\n\nIf stage 1 fails to connect to, download an image from, or successfully acquire an IP address\nvia an image from Photobucket, the malware reaches out to a backup domain,\ntoknowall[.]com, to download an image and attempt the same process.\n\nIf the attempt to the backup domain fails, stage 1 opens a listener that waits for a specific\ntrigger packet to open a connection for the actor to connect interactively to the device. When\nthe listener opens, it checks its public IP from api.ipify[.]org and stores it for later comparison.\nThen, when any packet arrives on any port, the listener performs a series of checks to\nidentify a trigger packet. If the packet meets a predefined set of criteria, it will extract an IP\naddress from the packet and attempt a stage 2 download.\n\n**Listener actions:**\n\n1. Inspects all TCP/IPv4 packets with a SYN flag set\n2. Checks that the destination IP matches what it found when the listener opened (Note: if\n\nthe listener failed to get an IP from api.ipify[.]org it will skip this check)\n3. Makes sure the packet has eight or more bytes\n4. Scans the data for the bytes \\x0c\\x15\\x22\\x2b\n5. The bytes directly after that 4-byte marker are interpreted as an IP so \\x01\\x02\\x03\\x04\n\nbecomes -> 1.2.3[.]4\n6. Calls out to the newly received IP as usual for stage 2\n7. Confirms that stage 2 is at least 1,001 bytes (Note: this is much smaller than the other\n\ncallout methods which require the stage 2 to be 100,000 or more)\n\n**Stage 2 (non-persistent)**\n\nThe stage 2 malware first sets up the working environment by creating a modules folder\n(/var/run/vpnfilterm) and a working directory (/var/run/vpnfilterw). Afterward, it will run in a\nloop, where it first reaches out to a C2 server, and then executes commands retrieved from\n\n\n-----\n\nthe C2. The command names are encrypted with the same broken RC4 function as in stage\n1. Fortunately, older versions of x86 stage 2 sample were very verbose, and debug printed\nall the steps it performed. Newer versions of the x86 stage 2 did not contain the debug prints,\nnor did the MIPS sample.\n\nThe x86 sample can perform the following operations:\n\nkill: Overwrites the first 5,000 bytes of /dev/mtdblock0 with zeros, and reboots the\ndevice (effectively bricking it).\nexec: Executes a shell command or plugin.\ntor: Sets the Tor configuration flag (0 or 1).\ncopy: Copies a file from the client to the server.\nseturl: Sets the URL of the current configuration panel.\nproxy: Sets the current proxy URL.\nport: Sets the current proxy port.\ndelay: Sets the delay between main loop executions.\nreboot: Reboots the device if it has been up for more than 256 seconds, and the build\nname is specified in the parameter.\ndownload: Downloads a URL to a file. This can be applied to all devices or just a\ncertain build name.\n\nThe MIPS sample has the following additional operations:\n\nstop: Terminate the malware process.\nrelay: A misspelled version of the `delay` command from the x86 version.\n\nUntil the Tor module is installed, stage 2 will use one or more IPs stored in its configuration\nas SOCKS5 proxies to Tor and attempt to communicate with a control panel also found in its\nconfiguration. Like in stage 1, the communication between the malware and the proxy will\nconnect over a verified SSL connection. When the Tor module is installed, it will connect to\n.onion domains through the local SOCKS5 proxy provided by the module over plain HTTP\ninstead. We used a fake SOCKS5 proxy, which redirects all traffic to INetSim for analysis.\n\nAn example request from the malware to the server:\n\n{\n\n\"uq\":\"px(01:02:03:04:05:06)\",\n\n\"pv\":\"pPRXi686QNAPX86\",\n\n\"ad\":\"10.0.0.1\",\n\n\"bv\":\"0.11.1a/0.3.9qa\",\n\n\"nn\":\"YnVpbGRyb290\",\n\n\n-----\n\ntn :,\n\n\"on\":\"1\"\n\n}\n\nThe malware encodes this request into a JSON object, which is then base64-encoded and\nsent to the path /bin32/update.php in the HTTP POST parameter \"me\". The user agent used\nin the request is peculiar (Mozilla/6.1 (compatible; MSIE 9.0; Windows NT 5.3; Trident/5.0)),\nas a version \"Windows NT 5.3\" doesn't exist.\n\nuq: A unique ID for the infected device (the MAC address of the malware's network\ninterface).\npv: The platform version the malware is running on\nad: The public IP address of the malware's device\nbv: Version of the stage 1 loader (0.3.9qa) and the stage 2 binary (0.11.1a)\nnn: The node name\ntn: The Tor flag\non: The onion flag\n\nThe server's response to the message:\n\n{\n\n\"tr\":3060,\n\n\"pxs\":[\"217.12.202.40\",\"94.242.222.68\",\"91.121.109.209\"],\n\n\"tor\":\"tor 1\",\n\n\"mds\":[]\n\n}\n\ntr: Sets the delay for the main loop.\npxs: List of panels to connect to. These are the C2 servers.\ntor: Sets the name and version of the Tor module.\nmds: A list of modules to fetch. Each entry is in the format \"<command_id>\n<module_id> <module_name> <module_args (base64-encoded)>\". The malware will\ndownload the module from /bin32/update.php by setting the POST form parameter me\nto the module name with the architecture appended, e.g., tor_i686 for the Tor module,\nand execute it in each iteration. A blank list of commands (as in the example response\nabove) will clear any existing commands by deactivating them and killing any running\nprocesses associated with them.\n\n**Stage 3 (non-persistent)**\n\n\n-----\n\nWe have analyzed two plugin modules for the malware, a packet sniffer and a\ncommunication plugin that allows the malware to communicate over Tor. We assess with\nhigh confidence that there are likely several more that we have not yet discovered. Among\nthe initial samples Talos acquired, there was a plugin for the MIPS stage 2, which is a packet\nsniffer. It intercepts all network traffic through a raw socket and looks for strings used in\nHTTP basic authentications. Further, it specifically tracks Modbus TCP/IP packets. The\nresulting log file is placed in the stage 2 working directory, /var/run/vpnfilterw. This allows the\nattackers to understand, capture, and track the traffic flowing through the device.\n\nThe Tor plugin module is partially linked into stage 2, but has a separate Tor executable,\nwhich is downloaded to /var/run/tor and run in a process separate from stage 2. The Tor\nbinary looks like the standard Tor client, in the form of a statically linked and stripped binary.\nIt creates a configuration file in /var/run/torrc and a working directory in /var/run/tord.\n\n## Conclusion\n\nVPNFilter is an expansive, robust, highly capable, and dangerous threat that targets devices\nthat are challenging to defend. Its highly modular framework allows for rapid changes to the\nactor's operational infrastructure, serving their goals of misattribution, intelligence collection,\nand finding a platform to conduct attacks.\n\nThe destructive capability particularly concerns us. This shows that the actor is willing to burn\nusers' devices to cover up their tracks, going much further than simply removing traces of the\nmalware. If it suited their goals, this command could be executed on a broad scale,\npotentially rendering hundreds of thousands of devices unusable, disabling internet access\nfor hundreds of thousands of victims worldwide or in a focused region where it suited the\nactor's purposes.\n\nWhile the threat to IoT devices is nothing new, the fact that these devices are being used by\nadvanced nation-state actors to conduct cyber operations, which could potentially result in\nthe destruction of the device, has greatly increased the urgency of dealing with this issue.\nWe call on the entire security community to join us in aggressively countering this threat.\n\nWe will continue to monitor VPNFilter and work with our partners to understand the threat as\nit continues to evolve in order to ensure that our customers remain protected and the public\nis informed.\n\n### IOCs\n\nAs stated previously, we highly suspect that there are additional IOCs and versions of this\nmalware that we are not currently aware of. The following list of IOCs comprises what we\nknow as of this date.\n\n### Known C2 Domains and IPs\n\n\n-----\n\n**Associated with the 1st Stage**\n\nphotobucket[.]com/user/nikkireed11/library\n\nphotobucket[.]com/user/kmila302/library\n\nphotobucket[.]com/user/lisabraun87/library\n\nphotobucket[.]com/user/eva_green1/library\n\nphotobucket[.]com/user/monicabelci4/library\n\nphotobucket[.]com/user/katyperry45/library\n\nphotobucket[.]com/user/saragray1/library\n\nphotobucket[.]com/user/millerfred/library\n\nphotobucket[.]com/user/jeniferaniston1/library\n\nphotobucket[.]com/user/amandaseyfried1/library\n\nphotobucket[.]com/user/suwe8/library\n\nphotobucket[.]com/user/bob7301/library\n\ntoknowall[.]com\n\n**Associated with the 2nd Stage**\n\n91.121.109[.]209\n\n217.12.202[.]40\n\n94.242.222[.]68\n\n82.118.242[.]124\n\n46.151.209[.]33\n\n217.79.179[.]14\n\n91.214.203[.]144\n\n95.211.198[.]231\n\n195.154.180[.]60\n\n5.149.250[.]54\n\n91.200.13[.]76\n\n94.185.80[.]82\n\n62.210.180[.]229\n\nzuh3vcyskd4gipkm[.]onion/bin32/update.php\n\n### Known File Hashes\n\n**1st Stage Malware**\n\n50ac4fcd3fbc8abcaa766449841b3a0a684b3e217fc40935f1ac22c34c58a9ec\n\n0e0094d9bd396a6594da8e21911a3982cd737b445f591581560d766755097d92\n\n\n-----\n\n**2nd Stage Malware**\n\n9683b04123d7e9fe4c8c26c69b09c2233f7e1440f828837422ce330040782d17\n\nd6097e942dd0fdc1fb28ec1814780e6ecc169ec6d24f9954e71954eedbc4c70e\n\n4b03288e9e44d214426a02327223b5e516b1ea29ce72fa25a2fcef9aa65c4b0b\n\n9eb6c779dbad1b717caa462d8e040852759436ed79cc2172692339bc62432387\n\n37e29b0ea7a9b97597385a12f525e13c3a7d02ba4161a6946f2a7d978cc045b4\n\n776cb9a7a9f5afbaffdd4dbd052c6420030b2c7c3058c1455e0a79df0e6f7a1d\n\n8a20dc9538d639623878a3d3d18d88da8b635ea52e5e2d0c2cce4a8c5a703db1\n\n0649fda8888d701eb2f91e6e0a05a2e2be714f564497c44a3813082ef8ff250b\n\n**3rd Stage Plugins**\n\nf8286e29faa67ec765ae0244862f6b7914fcdde10423f96595cb84ad5cc6b344\n\nafd281639e26a717aead65b1886f98d6d6c258736016023b4e59de30b7348719\n\n**Self-Signed Certificate Fingerprints**\n\nd113ce61ab1e4bfcb32fb3c53bd3cdeee81108d02d3886f6e2286e0b6a006747\n\nc52b3901a26df1680acbfb9e6184b321f0b22dd6c4bb107e5e071553d375c851\n\nf372ebe8277b78d50c5600d0e2af3fe29b1e04b5435a7149f04edd165743c16d\n\nbe4715b029cbd3f8e2f37bc525005b2cb9cad977117a26fac94339a721e3f2a5\n\n27af4b890db1a611d0054d5d4a7d9a36c9f52dffeb67a053be9ea03a495a9302\n\n110da84f31e7868ad741bcb0d9f7771a0bb39c44785055e6da0ecc393598adc8\n\nfb47ba27dceea486aab7a0f8ec5674332ca1f6af962a1724df89d658d470348f\n\nb25336c2dd388459dec37fa8d0467cf2ac3c81a272176128338a2c1d7c083c78\n\ncd75d3a70e3218688bdd23a0f618add964603736f7c899265b1d8386b9902526\n\n110da84f31e7868ad741bcb0d9f7771a0bb39c44785055e6da0ecc393598adc8\n\n909cf80d3ef4c52abc95d286df8d218462739889b6be4762a1d2fac1adb2ec2b\n\n044bfa11ea91b5559f7502c3a504b19ee3c555e95907a98508825b4aa56294e4\n\nc0f8bde03df3dec6e43b327378777ebc35d9ea8cfe39628f79f20b1c40c1b412\n\n8f1d0cd5dd6585c3d5d478e18a85e7109c8a88489c46987621e01d21fab5095d\n\nd5dec646c957305d91303a1d7931b30e7fb2f38d54a1102e14fd7a4b9f6e0806\n\nc0f8bde03df3dec6e43b327378777ebc35d9ea8cfe39628f79f20b1c40c1b412\n\n### Known Affected Devices\n\nThe following devices are known to be affected by this threat. Based on the scale of this\nresearch, much of our observations are remote and not on the device, so it is difficult to\ndetermine specific version numbers and models in many cases. It should be noted that all of\nthese devices have publicly known vulnerabilities associated with them.\n\n\n-----\n\nGiven our observations with this threat, we assess with high confidence that this list is\nincomplete and other devices could be affected.\n\n**Linksys Devices:**\n\nE1200\n\nE2500\n\nWRVS4400N\n\n**Mikrotik RouterOS Versions for Cloud Core Routers:**\n\n1016\n\n1036\n\n1072\n\n**Netgear Devices:**\n\nDGN2200\n\nR6400\n\nR7000\n\nR8000\n\nWNR1000\n\nWNR2000\n\n**QNAP Devices:**\n\nTS251\n\nTS439 Pro\n\nOther QNAP NAS devices running QTS software\n\n**TP-Link Devices:**\n\nR600VPN\n\n## Coverage\n\nCisco customers are protected by this threat by Cisco Advanced Malware Protection (AMP),\nCloud Web Security (CWS), Network Security, ThreatGrid, Umbrella, and Web Security\nAppliance (WSA). Additionally, StealthWatch and StealthWatch Cloud can be utilized to find\ndevices communicating with the known C2 IP addresses and domains.\n\n\n-----\n\nIn StealthWatch, two items need to be configured to send an alert that there are\ncommunications to nefarious IP addresses.\n\nThe first step is to create a new Host Group named \"VPNFilter C2\" under Outside\nHosts using the Java user interface.\nOnce this is created, you will likely want to validate that there are no active\ncommunications presently occurring.\nThis validation can be achieved by right-clicking on the recently created \"VPNFilter C2\"\nHost Group and navigating to Top -> Conversations -> Total.\nOnce you are viewing these top conversations, you will easily be able to see if there is\nactive traffic.\nIn the event that there is no active traffic, an alarm can be created to generate alerts in\nthe event that traffic to or from any of the \"VPNFilter C2\" hosts is observed.\nThis alarm can be configured by creating a custom event and selecting the appropriate\nhosts or objects in the web user interface.\n\n**VPNFilter specific Snort detection:**\n\n45563 45564 46782 46783\n\n**Snort rules that protect against known vulnerabilities in affected devices:**\n\n25589 26276 26277 26278 26279 29830 29831 44743 46080 46081 46082 46083 46084\n46085 46086 46287 46121 46122 46123 46124 41445 44971 46297 46298 46299 46300\n46301 46305 46306 46307 46308 46309 46310 46315 46335 46340 46341 46342 46376\n46377 37963 45555 46076 40063 44643 44790 26275 35734 41095 41096 41504 41698\n41699 41700 41748 41749 41750 41751 44687 44688 44698 44699 45001 46312 46313\n46314 46317 46318 46322 46323 40866 40907 45157\n\n**ClamAV Signatures:**\n\n\n-----\n\nUnix.Trojan.Vpnfilter-6425811-0\nUnix.Trojan.Vpnfilter-6425812-0\nUnix.Trojan.Vpnfilter-6550590-0\nUnix.Trojan.Vpnfilter-6550591-0\nUnix.Trojan.Vpnfilter-6550592-0\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2018/2018-05-23 - New VPNFilter malware targets at least 500K networking devices worldwide.pdf"
    ],
    "report_names": [
        "2018-05-23 - New VPNFilter malware targets at least 500K networking devices worldwide.pdf"
    ],
    "threat_actors": [
        {
            "id": "b3e954e8-8bbb-46f3-84de-d6f12dc7e1a6",
            "created_at": "2022-10-25T15:50:23.339976Z",
            "updated_at": "2025-03-27T02:00:55.446795Z",
            "deleted_at": null,
            "main_name": "Sandworm Team",
            "aliases": [
                "Sandworm Team",
                "ELECTRUM",
                "Telebots",
                "IRON VIKING",
                "BlackEnergy (Group)",
                "Quedagh",
                "Voodoo Bear",
                "IRIDIUM",
                "Seashell Blizzard",
                "FROZENBARENTS",
                "APT44"
            ],
            "source_name": "MITRE:Sandworm Team",
            "tools": [
                "Bad Rabbit",
                "Mimikatz",
                "Exaramel for Linux",
                "Exaramel for Windows",
                "GreyEnergy",
                "PsExec",
                "Prestige",
                "P.A.S. Webshell",
                "VPNFilter",
                "Cyclops Blink",
                "SDelete",
                "AcidRain",
                "Industroyer",
                "Industroyer2",
                "BlackEnergy",
                "Cobalt Strike",
                "NotPetya",
                "KillDisk",
                "PoshC2",
                "Impacket",
                "Invoke-PSImage",
                "Olympic Destroyer"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1673535566,
    "ts_updated_at": 1743041133,
    "ts_creation_date": 1653774238,
    "ts_modification_date": 1653774238,
    "files": {
        "pdf": "https://archive.orkl.eu/3bc4eb19ca12dedba299125f3a5299f2f4f3b357.pdf",
        "text": "https://archive.orkl.eu/3bc4eb19ca12dedba299125f3a5299f2f4f3b357.txt",
        "img": "https://archive.orkl.eu/3bc4eb19ca12dedba299125f3a5299f2f4f3b357.jpg"
    }
}