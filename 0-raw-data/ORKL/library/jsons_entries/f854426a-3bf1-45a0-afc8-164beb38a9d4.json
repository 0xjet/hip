{
    "id": "f854426a-3bf1-45a0-afc8-164beb38a9d4",
    "created_at": "2023-01-12T15:05:24.77254Z",
    "updated_at": "2025-03-27T02:05:29.761049Z",
    "deleted_at": null,
    "sha1_hash": "82b3d7c2b1f9ef69970e8488910e162d038016b9",
    "title": "2021-03-18 - Alert (AA21-077A)- Detecting Post-Compromise Threat Activity Using the CHIRP IOC Detection Tool",
    "authors": "",
    "file_creation_date": "2022-05-29T01:06:30Z",
    "file_modification_date": "2022-05-29T01:06:30Z",
    "file_size": 92056,
    "plain_text": "# Detecting Post-Compromise Threat Activity Using the CHIRP IOC Detection Tool\n\n**us-cert.cisa.gov/ncas/alerts/aa21-077a**\n\n## Summary\n\n**_Updated April 15, 2021: The U.S. Government attributes this activity to the Russian_**\n**_Foreign Intelligence Service (SVR). Additional information may be found in a_**\n**_[statement from the White House. For more information on SolarWinds-related activity,](https://www.whitehouse.gov/briefing-room/statements-releases/2021/04/15/fact-sheet-imposing-costs-for-harmful-foreign-activities-by-the-russian-government/)_**\n**_go to_** **_[https://us-cert.cisa.gov/remediating-apt-compromised-networks and](https://us-cert.cisa.gov/remediating-apt-compromised-networks)_**\n**_[https://www.cisa.gov/supply-chain-compromise.](https://www.cisa.gov/supply-chain-compromise)_**\n\nThis Alert announces the CISA Hunt and Incident Response Program (CHIRP) tool. CHIRP\nis a forensics collection tool that CISA developed to help network defenders find indicators of\ncompromise (IOCs) associated with activity detailed in the following CISA Alerts:\n\nAA20-352A: Advanced Persistent Threat Compromise of Government Agencies,\nCritical Infrastructure, and Private Sector Organizations, which primarily focuses on an\nadvanced persistent threat (APT) actor’s compromise of SolarWinds Orion products\naffecting U.S. government agencies, critical infrastructure entities, and private network\norganizations.\n\nAA21-008A: Detecting Post-Compromise Threat Activity in Microsoft Cloud\nEnvironments, which addresses APT activity within Microsoft 365/Azure environments\nand offers an overview of—and guidance on—available open-source tools. The Alert\n[includes the CISA-developed Sparrow tool that helps network defenders detect](https://github.com/cisagov/Sparrow)\npossible compromised accounts and applications in the Azure/M365 environment.\n\n[Similar to Sparrow—which scans for signs of APT compromise within an M365 or Azure](https://github.com/cisagov/Sparrow)\nenvironment—CHIRP scans for signs of APT compromise within an on-premises\nenvironment.\n\nIn this release, CHIRP, by default, searches for IOCs associated with malicious activity\ndetailed in AA20-352A and AA21-008A that has spilled into an on-premises enterprise\nenvironment.\n\n[CHIRP is freely available on the CISA GitHub Repository. For additional guidance watch](https://github.com/cisagov)\nCISA's [CHIRP Overview video. Note: CISA will continue to release plugins and IOC](https://www.youtube.com/watch?v=UGYSNiNOpds)\npackages for new threats via the CISA GitHub Repository.\n\nCISA advises organizations to use CHIRP to:\n\nExamine Windows event logs for artifacts associated with this activity;\n\n\n-----\n\nExamine Windows Registry for evidence of intrusion;\nQuery Windows network artifacts; and\nApply YARA rules to detect malware, backdoors, or implants.\n\nNetwork defenders should review and confirm any post-compromise threat activity detected\nby the tool. CISA has provided confidence scores for each IOC and YARA rule included with\nCHIRP’s release. For confirmed positive hits, CISA recommends collecting a forensic image\nof the relevant system(s) and conducting a forensic analysis on the system(s).\n\nIf an organization does not have the capability to follow the guidance in this Alert, consider\nsoliciting third-party IT security support. Note: Responding to confirmed positive hits is\nessential to evict an adversary from a compromised network.\n\n[Click here for a PDF version of this report.](https://us-cert.cisa.gov/sites/default/files/publications/AA21-077A-Detecting_Post-Compromise_Threat_Activity_Using_CHIRP_508.pdf)\n\n## Technical Details\n\n**How CHIRP Works**\n\nCHIRP is a command-line executable with a dynamic plugin and indicator system to search\nfor signs of compromise. CHIRP has plugins to search through event logs and registry keys\nand run YARA rules to scan for signs of APT tactics, techniques, and procedures. CHIRP\nalso has a YAML file that contains a list of IOCs that CISA associates with the malware and\nAPT activity detailed in CISA Alerts [AA20-352A and](https://us-cert.cisa.gov/ncas/alerts/aa20-352a) [AA21-008A.](https://us-cert.cisa.gov/ncas/alerts/aa21-008a)\n\nCurrently, the tool looks for:\n\n[The presence of malware identified by security researchers as TEARDROP and](https://us-cert.cisa.gov/ncas/analysis-reports/ar21-039b)\nRAINDROP;\nCredential dumping certificate pulls;\nCertain persistence mechanisms identified as associated with this campaign;\nSystem, network, and M365 enumeration; and\nKnown observable indicators of lateral movement.\n\nNetwork defenders can follow step-by-step instructions on the CISA CHIRP GitHub\nrepository to add additional IOCs, YARA rules, or plugins to CHIRP to search for postcompromise threat activity related to the SolarWinds Orion supply chain compromise or new\nthreat activity.\n\n**Compatibility**\n\nCHIRP currently only scans Windows operating systems.\n\n**Instructions**\n\nCHIRP is available on CISA’s GitHub repository in two forms:\n\n\n-----\n\n1. A compiled executable\n\n2. A python script\n\nCISA recommends using the compiled version to easily scan a system for APT activity. For\ninstructions to run, read the README.md in the CHIRP GitHub repository.\n\nIf you choose to use the native Python version, see the detailed instructions on the CHIRP\nGitHub repository.\n\n## Mitigations\n\n**Interpreting the Results**\n\nCHIRP provides results of its scan in JSON format. CISA encourages uploading the results\ninto a security information and event management (SIEM) system, if available. If no SIEM\nsystem is available, results can be viewed in a compatible web browser or text editor. If\nCHIRP detects any post-compromise threat activity, those detections should be reviewed\nand confirmed. CISA has provided confidence scores for each IOC and YARA rule included\nwith CHIRP’s release. For confirmed positive hits, CISA recommends collecting a forensic\nimage of the relevant system(s) and conducting a forensic analysis on the system(s).\n\nIf you do not have the capability to follow the guidance in this Alert, consider soliciting thirdparty IT security support. Note: Responding to confirmed positive hits is essential to evict an\nadversary from a compromised network.\n\n**Frequently Asked Questions**\n\n1. What systems should CHIRP run on?\n\nSystems running SolarWinds Orion or believed to be involved in any resulting lateral\nmovement.\n\n2. What should I do with results?\n\nIngest the JSON results into a SIEM system, web browser, or text editor.\n\n3. Are there existing tools that CHIRP complements and/or provide the same\n\n**benefit as CHIRP?**\n\n1. Antivirus software developers may have begun to roll out detections for the\n\nSolarWinds post-compromise activity. However, those products can miss\nhistorical signs of compromise. CHIRP can provide a complementary benefit to\nantivirus when run.\n\n2. CISA previously released the Sparrow tool that scans for APT activity within\n\nM365 and Azure environments related to activity detailed in CISA Alerts AA20352A and AA21-008A. CHIRP provides a complementary capability to Sparrow\nby scanning for on-premises systems for similar activity\n\n\n-----\n\n4. How often should I run CHIRP?\n\nCHIRP can be run once or routinely. Currently, CHIRP does not provide a mechanism\nto run repeatedly in its native format.\n\n5. Do I need to configure the tool before I run it?\n\nNo.\n\n6. Will CHIRP change or affect anything on the system(s) it runs on?\n\nNo, CHIRP only scans the system(s) it runs on and makes no active changes.\n\n7. How long will it take to run CHIRP?\n\nCHIRP will complete its scan in approximately 1 to 2 hours. Duration will be dependent\non the level of activity, the system, and the size of the resident data sets. CHIRP will\nprovide periodic progress updates as it runs.\n\n8. If I have questions, who do I contact?\n\nFor general questions regarding CHIRP, please contact CISA via email at\n[central@cisa.dhs.gov or by phone at 1-888-282-0870. For reporting indicators of](http://10.10.0.46/mailto:central@cisa.dhs.gov)\npotential compromise, contact us by submitting a report through our website at\n[https://us-cert.cisa.gov/report. For all technical issues or support for CHIRP, please](https://us-cert.cisa.gov/report)\n[submit issues at the CISA CHIRP GitHub Repository.](https://github.com/cisagov/CHIRP)\n\n## Revisions\n\nMarch 18, 2021: Initial Publication\n\nApril 9, 2021: Fixed PDF (not related to content)\n\nApril 15, 2021: Updated with Attribution Statement\n\n[This product is provided subject to this Notification and this](https://us-cert.cisa.gov/privacy/notification) [Privacy & Use policy.](https://www.dhs.gov/privacy-policy)\n\n**Please share your thoughts.**\n\n[We recently updated our anonymous product survey; we'd welcome your feedback.](https://www.surveymonkey.com/r/CISA-cyber-survey?product=https://us-cert.cisa.gov/ncas/alerts/aa21-077a)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-03-18 - Alert (AA21-077A)- Detecting Post-Compromise Threat Activity Using the CHIRP IOC Detection Tool.pdf"
    ],
    "report_names": [
        "2021-03-18 - Alert (AA21-077A)- Detecting Post-Compromise Threat Activity Using the CHIRP IOC Detection Tool.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673535924,
    "ts_updated_at": 1743041129,
    "ts_creation_date": 1653786390,
    "ts_modification_date": 1653786390,
    "files": {
        "pdf": "https://archive.orkl.eu/82b3d7c2b1f9ef69970e8488910e162d038016b9.pdf",
        "text": "https://archive.orkl.eu/82b3d7c2b1f9ef69970e8488910e162d038016b9.txt",
        "img": "https://archive.orkl.eu/82b3d7c2b1f9ef69970e8488910e162d038016b9.jpg"
    }
}