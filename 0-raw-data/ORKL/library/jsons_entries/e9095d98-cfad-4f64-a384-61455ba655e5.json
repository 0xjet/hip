{
    "id": "e9095d98-cfad-4f64-a384-61455ba655e5",
    "created_at": "2023-01-12T15:07:38.410094Z",
    "updated_at": "2025-03-27T02:05:25.021665Z",
    "deleted_at": null,
    "sha1_hash": "dfd7ac695de1bc7a5c0e13c932e4dd4b9edd57a8",
    "title": "2022-08-04 - GwisinLocker ransomware targets South Korean industrial and pharma firms",
    "authors": "",
    "file_creation_date": "2022-08-18T04:00:14Z",
    "file_modification_date": "2022-08-18T04:00:14Z",
    "file_size": 917174,
    "plain_text": "# GwisinLocker ransomware targets South Korean industrial and pharma firms\n\n**[blog.reversinglabs.com/blog/gwisinlocker-ransomware-targets-south-korean-industrial-and-pharmaceutical-companies](https://blog.reversinglabs.com/blog/gwisinlocker-ransomware-targets-south-korean-industrial-and-pharmaceutical-companies)**\n\n[Threat Research](https://blog.reversinglabs.com/blog/tag/threat-research)\n| August 9, 2022\n\nBlog Author\n[Joseph Edwards, Senior Malware Researcher at ReversingLabs. Read More...](https://blog.reversinglabs.com/blog/author/joseph-edwards)\n\n\n-----\n\nTaking its name from “Gwisin,” a Korean term for “ghost” or “spirit,” GwisinLocker is a new ransomware family that targets South Korean\nindustrial and pharmaceutical companies.\n\n## Executive Summary\n\nReversingLabs researchers discovered a new ransomware family targeting Linux-based systems. The malware, dubbed GwisinLocker was\ndetected in successful campaigns targeting South Korean industrial and pharmaceutical firms. The malware is notable for being a new\nmalware variant produced by a previously little known threat actor, dubbed “Gwisin” (귀신) — a Korean word meaning ‘ghost’ or ‘spirit’ — and\ntargeting systems running the open source Linux operating system. The ransomware is deployed following a substantial network compromise\nand data exfiltration.\n\n## Analysis\n\nBackground\n\nOn July 19th in the course of threat hunting, ReversingLabs researchers discovered an undetected Linux ransomware sample which bore the\nmarkers of a Gwisin campaign. We have chosen to name this malware GwisinLocker.Linux for clarity, as versions of the malware affecting\nWindows systems have also been identified.\n\nGwisin is a ransomware group targeting South Korean industrial and pharmaceutical companies. The name \"Gwisin” (귀신) refers to the\n[Korean term for a ghost or spirit. The Gwisin group was first referenced in a report on new ransomware actors in Q3 2021, but have](https://www.boannews.com/media/view.asp?idx=108704)\nmaintained a relatively low profile. To date, there has not been a public technical analysis of the group’s ransomware. This blog post will\nattempt to describe the new threat based on samples obtained in the wild and analyzed by ReversingLabs, as well as published reports\ndescribing attacks associated with the malware.\n\nConfiguration\n\nThe GwisinLocker.Linux samples can be run with the following options (descriptions were removed by the malware authors, but inferred from\nanalysis):\n\nUsage: Usage\n\n-h, --help  show this help message and exit\n\nOptions\n\n-p, --vp=<str> Comma-separated list of paths to encrypt\n\n-m, --vm=<int> Kills VM processes if 1; Stops services and processes if 2\n\n-s, --vs=<int> Seconds to sleep before execution\n\n-z, --sf=<int> Skip encrypting ESXi-related files (those excluded in the configuration)\n\n-d, --sd=<int> Self-delete after completion\n\n-y, --pd=<str> Writes the specified text to a file of the same name\n\n-t, --tb=<int> Enters loop if Unix time is < 4 hours since epoch\n\nOperation\n\n\n-----\n\nst, t e a a e ed ects t e sta da d put, sta da d output a d sta da d e o e desc pto s to /de / u to a o d outputt g debug o\nerror strings. Both the 32-bit and 64-bit samples used the file /tmp/.66486f04-bf24-4f5e-ae16-0af0fdb3d8fe as a mutex, writing a lock to the file.\nIf GwisinLocker reads a lock set on this file, it exits immediately.\n\nNext, the GwisinLocker.Linux ransomware decrypts its configuration data. GwisinLocker.Linux's configuration is embedded in the malware,\nencrypted with a hard-coded RC4 key. The JSON configuration was the same in both samples and includes a list of excluded and targeted\nfiles.\n\nThe following directories are excluded from encryption to prevent Linux operating system crashes:\n\n\"bin\",\"boot\",\"dev\",\"etc\",\"lib\",\"lib64\",\"proc\",\"run\",\"sbin\",\"srv\",\"sys\",\"tmp\",\"usr\",\"var\",\"bootbank\",\"mbr\",\"tardisks\",\"tardisks.noauto\",\"vmimages\"\n\nThese services and related processes are killed before encryption (if the --vm=2 option is set) to ensure open file handles are closed:\n\n\"apache\",\"httpd\",\"nginx\",\"oracle\",\"mysql\",\"mariadb\",\"postgres\",\"mongod\",\"elasticsearch\",\"jenkins\",\"gitlab\",\"docker\",\"svnserve\",\"yona\",\"zabbix\",\"gray\n\nThe following filenames are excluded from encryption (if the --sf option is set), as they are important for VMWare ESXI operations. Perhaps the\nthreat actors intended to maintain access to ESXi virtual machines. The ransom notes are also excluded.\n\n\"imgdb.tgz\",\"onetime.tgz\",\"state.tgz\",\"useropts.gz\",\"jumpstrt.gz\",\"imgpayld.tgz\",\"features.gz\",\"!!!_HOW_TO_UNLOCK_MCRGNX_FILES_!!!.TXT\"\n\nThese directories were specifically targeted by Gwisin to encrypt operational data:\n\n\"/Information/Database/\",\"/Information/korea_data/\",\"/Information/\",\"/Infra/\",\"/var/www/\",\"/var/opt/\",\"/var/lib/mysql/\",\"/var/lib/postgresql/\",\"/var/log/\",\"/u\nserver/\",\"/usr/local/\"\n\nOnce the command-line arguments are parsed, GwisinLocker enumerates the number of processors and creates up to 100 threads. The\ndirectories to be encrypted are specified with the --vp option, or by default include the list of directories in the configuration.\n\nIf the --vm=1 option is supplied, the ransomware executes the following commands to shut down VMWare ESXi machines before encryption:\n\nesxcli --formatter=csv --format-param=fields==\"DisplayName,WorldID\" vm process list\n\nesxcli vm process kill --type=force --world-id=\"[ESXi] Shutting down - %s\"\n\nImpact\n\nFiles encrypted in this GwisinLocker campaign carry the extension .mcrgnx, and the file's corresponding key is stored (encrypted) in a separate\n256-byte file with the extension .mcrgnx0. GwisinLocker employs AES to encrypt victim files, hiding the key to prevent convenient decryption.\nIn addition, compromised endpoints are renamed 'GWISIN Ghost,’ according to published reports.\n\n## Encryption\n\nGwisinLocker combines AES symmetric-key encryption with SHA256 hashing, generating a unique key for each file. The following steps occur\nwhen a file is encrypted:\n\n1.\n\n1. 1. Initialize RSA context from embedded public key\n2. 2. Generate random AES key and IV:\n\nInitialize new SHA256 context\nRead 32 bytes from /dev/urandom, hash with SHA256 context\nUtilize SHA256 digest as a key to initialize AES context and generate AES key\nRepeat steps 1-3 with 16 new bytes from /dev/urandom to generate an Initialization Vector\n1. 3. Rename the target file to [targetfile].mcrgnx\n2.\n\n4. Encrypt and store the AES key in the file [targetfile].mcrgnx0:\nInitialize new SHA256 context\nRead 32 bytes from /dev/urandom, hash with SHA256 context\nUtilize SHA256 digest as a key to initialize AES context and generate AES key 2\nEncrypt AES key from Part 1 with AES key 2\nEncrypt the resulting buffer with RSA context\nWrite encrypted key to [targetfile].mcrgnx0\n1. 5. Lastly, encrypt [targetfile].mcrgnx with the unencrypted AES key and IV generated in step 1.\n\n2. Targets\n\n\n-----\n\ncco d g to pub s ed epo ts [Sout](https://www.boannews.com/media/view.asp?idx=108704) o ea ed a, t e G s t eat acto s ocus e c us e y o Sout o ea s e g oup attac ed\nlarge domestic pharmaceutical companies in 2022. In those incidents, it often launched attacks on public holidays and during the early morning\nhours (Korean time) - looking to take advantage of periods in which staffing and monitoring within target environments were relaxed.\n\nIn communications with its victims, the Gwisin group claim to have deep knowledge of their network and claim that they exfiltrated data with\nwhich to extort the company. Ransom notes associated with GwisinLocker.Linux contain detailed internal information from the compromised\nenvironment. Encrypted files use file extensions customized to use the name of the victim company.\n\n## Ransom Note\n\nAccording to published reports, GwisinLocker.Linux ransom notes are text format files written in English and created in the same target folder\nas encrypted files. The name of the ransom note is typically “!!!_HOW_TO_UNLOCK_******_FILES_!!!.TXT.” The note includes contact\ninformation, along with a list of data and intellectual property stolen from within the company.\n\nThough the ransom notes are written in English, they contain references that make clear the intended targets are South Korean firms. That\nincludes the use of Hangul (Korean language script) characters and explicit warnings to victims not to contact a range of South Korean law\nenforcement or government agencies including the Korean police, the National Intelligence Service, and KISA.\n\nSample Ransom Note\n\nThe following is a (redacted) copy of a GwisinLocker ransom note.\n\nHello [REDACTED],\n\nYou have been visited by GWISIN.\n\nWe have exfiltrated a lot of sensitive data from your networks,\n\nincluding, but not limited to:\n\nI. Production applications, source (Git/SVN), files and DBs\n\n[1] [REDACTED] (all regions) + [REDACTED] and other internal platforms\n\nBy combining lab [REDACTED] data and the primary big customer platform\n\n[REDACTED], it is easy to identify customer projects, credentials and data.\n\nDespite ISO27001 and ISMS-P with a good PIMS strategy, you have failed to protect customer data across all services.\n\nYour privacy policy assures customers their data security and privacy is top priority, reality seems very different.\n\nWe wonder what your customers will have to say about that?\n\n[2] [REDACTED] and general DTC related data\n\nOnce again failing to protect very sensitive data and communications of your customers.\n\n[3] Infrastructure and sequencing pipeline data / scripts\n\nEverything from documentation to project specs to produced VCFs and PDF reports post-analysis were collected.\n\nMore importantly, a full deep dive of your network infrastructure documentation and access.\nThe only way to kick us out is to buy all new hardware, including network equipment (UTM / switches) and sequencing / data storage systems.\n\nSomeone could have quietly modified your [REDACTED] pipeline instead of contacting you, causing you much bigger issues (legal, financial\nand otherwise).\nCan you really trust your results, if you can't trust your input data and processing pipelines?\n\nII. Internal Data & Communications\n\n[1] ERP/CRM Systems (NEOE, Dynamics)\n\n[2] Active Directory dump with credential history (NTDS + passive credential collection)\n\n[3] DO GW with DB (your groupware contains a lot of data)\n\n[4] Exchange email communications (PST) of targeted important employees in various roles\n\n[5] Financial / Accounting / Research / IT / Customer / Etc. documents\n\n- A lot of documents and other files were collected from SHARE/NEWSHARE machines among other servers\n\n- Your DLP and monitoring was rendered effectively useless and could not stop us, neither could your security team and defensive products\n\nWe have also encrypted critical Windows and Linux servers.\n\nWe recommend that you do NOT restart servers or recovery may be slower.\n\nThe good news for you is that we can:\n\n- Decrypt all files with extension \".mcrgnx\" very quickly\n\n- Delete all sensitive data we have exfiltrated, instead of selling it\n\n- Help you improve your security\n\n- Disappear and not be your problem anymore\n\n\n-----\n\nyou a e to do s o o t e st uct o s\n1.) Download Tor Browser: https[://]www[.]torproject.org/download/\n\n2.) Go to our website: http[://]gwisin:fa5d9dfc@gwisin4yznpdtzq424i3la6oqy5evublod4zbhddzuxcnr34kgfokwad[.]onion\n\n3.) Login with username: mcrgnx, password: [REDACTED]\n\n4.) Change password (one time setup)\n\n5.) Setup end-to-end message encryption password\n\n6.) Read the full instructions on the website and contact us using the message system provided there\n\n[WARNING - #1]\n\nIf you are having trouble reaching our website, attempt closing and re-opening the Tor browser.\n\nIf you are still unable to reach our website, create a DNS TXT record @ mcrgnx.[REDACTED].com containing a hex-encoded email address\nand we will contact you.\n\nHowever, eventually we will need to communicate using our website to preserve the privacy of all parties involved.\n\n[WARNING - #2]\n\nDo NOT contact law enforcement (such as NPA, KISA or SMPA) or threat intelligence organizations as they may prevent you from recovering\nquickly.\n\nThey can't really help you and they don't care if your business is destroyed in the process.\n\nContact us within 72 working hours, so we can negotiate in good faith and resolve this quickly.\n\n## Campaign Markers\n\n Indicators of Compromise\n\nThe following are indicators of compromise (IOCs) assembled from GwisinLocker.Linux samples used in the wild.\n\n### Filesystem\n\nThe following hashes and strings correspond to files associated with active GwisinLocker.Linux variants and attacks.\n\n**SHA1 Hash (Filename)** **Description**\n\n(/tmp/.66486f04-bf24-4f5e-ae16-0af0fdb3d8fe) Mutex\n\n(!!!_HOW_TO_UNLOCK_MCRGNX_FILES_!!!.TXT) Ransom Note\n\nce6036db4fee35138709f14f5cc118abf53db112 GwisinLocker Ransomware (32-bit ELF)\n\ne85b47fdb409d4b3f7097b946205523930e0c4ab GwisinLocker Ransomware (64-bit ELF)\n\nProcesses\n\nThe following processes are associated with active GwisinLocker.Linux variants.\n\nesxcli --formatter=csv --format-param=fields==\"DisplayName,WorldID\" vm process list\n\nesxcli vm process kill --type=force --world-id=\"[ESXi] Shutting down - %s\"\n\nPayment\n\nGwisinLocker.Linux victims are required to log into a portal operated by the group and establish private communications channels for\ncompleting ransom payments. As a result, little is known about the payment method used and/or cryptocurrency wallets associated with the\ngroup.\n\n## Significance\n\n\n-----\n\nG s oc e u s otab e o be g a e a so a e a a t o a e eto o e tt e o t eat acto e a a e s e c us e ocus\non prominent South Korean firms and references to South Korean law enforcement entities as well as the use of Korean (Hangul) script in\nransom notes suggest the threat actor is familiar with both South Korean language and culture. That could suggest that Gwisin group is a\nNorth Korea based threat actor, given that nation’s aggressive use of offensive hacking, including the use of ransomware, to target South\nKorean government agencies and private sector firms.\n\nThe group’s apparent ability to compromise and maintain persistent access to victim environments prior to deploying the GwisinLocker.Linux\nransomware, as well as the group’s use of double extortion attacks involving the theft of sensitive data suggest that Gwisin possesses\nsophisticated offensive cyber capabilities. South Korean firms in sectors targeted by Gwisin including heavy industry and pharmaceuticals\nshould be particularly alert for attacks and indicators of compromise. However, the risk posed by Gwisin likely extends to South Korean firms in\nother sectors, as well.\n\n## Conclusions\n\nGwisinLocker is a significant new ransomware family that has been used in attacks on prominent South Korean industrial and pharmaceutical\nfirms. Our analysis of a variant of GwisinLocker that targets Linux-based systems reveals a sophisticated piece of malware with features\nspecially designed to manage Linux hosts and operate and interact with VMWare ESXI virtual machines.\n\nAnalysis and public reporting of the larger GwisinLocker campaign suggests the ransomware is in the hands of sophisticated threat actors who\ngain access to- and control over target environments prior to the deployment of the ransomware. That includes identifying and stealing\nsensitive data for use in so-called “double extortion” campaigns. Details in samples of the group’s ransom notes suggest a familiarity with the\nKorean language as well as South Korean government and law enforcement. This has led to speculation that Gwisin may be a North Koreanlinked advanced persistent threat (APT) group.\n\nThis threat should be of particular concern to industrial and pharmaceutical companies in South Korea, which account for the bulk of Gwisin’s\nvictims to date. However, it is reasonable to assume that this threat actor may expand its campaigns to organizations in other sectors, or even\noutside of South Korea.\n\nFirms concerned with GwisinLocker should review the Indicators of Compromise in this report and make those available to internal- or external\nthreat hunting teams.\n\nTags:\n[Threat Research](https://blog.reversinglabs.com/blog/tag/threat-research)\n[Ransomware](https://blog.reversinglabs.com/blog/tag/ransomware)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-08-04 - GwisinLocker ransomware targets South Korean industrial and pharma firms.pdf"
    ],
    "report_names": [
        "2022-08-04 - GwisinLocker ransomware targets South Korean industrial and pharma firms.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673536058,
    "ts_updated_at": 1743041125,
    "ts_creation_date": 1660795214,
    "ts_modification_date": 1660795214,
    "files": {
        "pdf": "https://archive.orkl.eu/dfd7ac695de1bc7a5c0e13c932e4dd4b9edd57a8.pdf",
        "text": "https://archive.orkl.eu/dfd7ac695de1bc7a5c0e13c932e4dd4b9edd57a8.txt",
        "img": "https://archive.orkl.eu/dfd7ac695de1bc7a5c0e13c932e4dd4b9edd57a8.jpg"
    }
}