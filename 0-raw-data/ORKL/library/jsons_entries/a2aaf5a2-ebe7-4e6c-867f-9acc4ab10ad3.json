{
    "id": "a2aaf5a2-ebe7-4e6c-867f-9acc4ab10ad3",
    "created_at": "2023-01-12T15:10:48.666736Z",
    "updated_at": "2025-03-27T02:08:36.162759Z",
    "deleted_at": null,
    "sha1_hash": "e3185b40762db850174c340b1eafc7089328e485",
    "title": "2021-04-01 - Avaddon RaaS - Breaks Public Decryptor, Continues On Rampage",
    "authors": "",
    "file_creation_date": "2022-05-29T01:20:12Z",
    "file_modification_date": "2022-05-29T01:20:12Z",
    "file_size": 2285476,
    "plain_text": "# Avaddon RaaS | Breaks Public Decryptor, Continues On Rampage\n\n**[labs.sentinelone.com/avaddon-raas-breaks-public-decryptor-continues-on-rampage/](https://labs.sentinelone.com/avaddon-raas-breaks-public-decryptor-continues-on-rampage/)**\n\nJim Walter\n\nThe Avaddon ransomware family was first sighted in the wild in February 2020, but fully\nemerged as a robust Ransomware-as-a-Service (RaaS) model in June of that year. Over the\nlast 9 months or so, the operator behind Avaddon has been successful in building a strong\nand reliable brand, moving quickly to support affiliates with an update after security\nresearchers released a public decryptor in February 2021. Since then, we have observed a\nspike in Avaddon activity and note that the actor is actively engaged in developing “Version\n2” of this aggressive RaaS offering.\n\nIn this post, we detail the rapid development of Avaddon, highlighting the malware author’s\nability to adapt to circumstances and maximize payouts for Avaddon affiliates.\n\n\n-----\n\n## Avaddon RaaS Overview\n\nAfter initial sightings in attacks from February 2020 onwards, Avaddon fully emerged as a\nRaaS in June of 2020. It was heavily promoted in underground markets as a fast, bespoke,\nhighly-configurable, and well-supported ransomware service.\n\nThe Avaddon operator offered partners fairly standard terms with the RaaS taking an initial\n25% cut but willing to drop that percentage for higher volume affiliates. Over the following\nmonths, Avaddon became one of the more aggressive ransomware groups targeting both\nindividuals and businesses. Following the model of other RaaS families that came before it,\nAvaddon soon put up a blog site dedicated to leaking victim data should victims fail to pay\nthe ransom demand.\n\n\n-----\n\nSince its inception, Avaddon refused to accept affiliates targeting CIS (Commonwealth of\nIndependant States) countries. This is in addition to being critical of any dealings with nonRussian-native speaking individuals.\n\nRight out of the gate, Avaddon touted their speed, configurability, and robust feature set. The\nfirst version of Avaddon was advertised with the following features:\n\nUnique payloads written in C++\nFile encryption via AES256 + RSA2048, supporting full-file encryption & custom\nparameters\nFull offline support, initial contact to C2 not required\n“Impossible” 3rd party decryption\nSupport for Windows 7 and higher\nMulti-threaded file encryption for max performance\nEncryption of all local and remote (and accessible) drives\nIOCP Support for parallel file encryption\nPersistently encrypts newly written files and newly connected media\nAbility to spread across network shares (SMB, DFS)\nMultiple delivery options (script, PowerShell, .EXE payload, .DLL)\nPayload executes as administrator\nEncrypts hidden files and volumes\nRemoves trash, Volume Shadow Copies (VSS), and other restore points\nTermination of processes which inhibit encryption of files\nConfigurable ransom note behavior\n\nInitially, affiliates were able to build and manage their payload via an elegant administration\npanel hosted via TOR (.onion). The panel allowed for management of specific campaigns,\npayment types and behaviors, victim tracking and management. It also served as the portal\nto Avaddon’s technical support resources.\n\nOver the following weeks, Avaddon picked up a great amount of momentum, continued to\nadvertise for recruitments and boasted about their coverage in the press.\n\n\n-----\n\nIn the second half of 2020, Avaddon continued to build its infected base, while also\ncontinuing to upgrade the service and payloads.\n\nAs AV engines began adding detection rules for Avaddon, the operator responded with\nfrequent updates to ensure the desired level of stealth. In late June 2020, the malware added\nthe option to launch payloads via PowerShell.\n\nIn August 2020, some more significant upgrades to the service came in the form of 24/7\nsupport. The actors indicated at the time that 24×7 support for affiliates was now available\nvia chat and ticketing systems.\n\nIn addition, Avaddon was one of the early adopters of additional extortion methods to taunt\nand advertise the breach of non-compliant victims, including the use of targeted\nadvertisements. The authors continued to improve the payloads themselves with better\n\n\n-----\n\nDistributed File System (DFS) support, different encryption mechanisms, and DLL payload\nsupport.\n\nNew Year 2021 brought further changes to the Avaddon platform. In January, the actor\nadded support for Windows XP and 2003 in the payloads, as well as tweaks to the\nencryption feature set. Notably, Avaddon was one of the first to add DDoS attacks as yet\nanother intimidation mechanism to their arsenal: If clients failed to comply with the ransom\ndemands, they stood to experience a damaging DDoS attack in addition to their data being\nleaked to the public, and any tarnishing of their reputation as a result of the breach.\n\nEverything seemed to be going well for the Avaddon RaaS, but then they hit a hurdle.\n\n## Avaddon Public Decrypter\n\nIn early 2021, a decryption tool for Avaddon was released by Bitdefender. Additionally, an\n[open-source decryptor was also released by researcher Javier Yuste based on his extensive](https://github.com/JavierYuste/AvaddonDecryptor)\npaper detailing the internals of Avaddon.\n\nUnder the hood, Avaddon payloads were storing the ‘secret’ session keys for encryption in\nmemory. This allowed analysts and researchers to locate the data and extract the key for\nanalysis and eventual development of the decryption tool. The tool was widely released, and\nposted to [NoMoreRansom.org.](https://www.nomoreransom.org/en/decryption-tools.html)\n\n[During this period, we even observed actors behind Babuk ransomware offering technical](https://www.sentinelone.com/blog/the-good-the-bad-and-the-ugly-in-cybersecurity-week-2-2/)\nassistance to the Avaddon actors.\n\nThose behind Avaddon were quick to pivot and move to a different model altogether,\nnullifying the effect of the decryptor. They also offered affiliates an 80% cut for a full month as\ncompensation.\n\n\n-----\n\nFollowing the requisite upgrades to address the encryption issues, Avaddon continued to\nupdate their services and toolset, in addition to becoming more aggressive with recruitment.\nFebruary 2021 also saw the addition of Monero support.\n\nSubsequently, we have observed a spike in Avaddon activity, including new victim entries on\ntheir blog. The actor’s most recent public statements indicate that the development of\nAvaddon V2 is well underway.\n\n## Avaddon RaaS Technical Breakdown\n\nIn the majority of cases, the initial delivery vector for Avaddon is via phishing email. However,\naffiliates have been known to use RDP along with exploitation of network-centric\nvulnerabilities. We have observed malicious emails with attached .js payloads, which in turn\nretrieve the Avaddon payloads from a remote location. In some cases, threat actors have\nsimply attached the ransomware directly to the email messages.\n\nAvaddon payloads perform checks to insure they are not executing on a victim device\nlocated in certain regions of CIS.\n\n\n-----\n\nThe `GetUserDefaultLCID() function (and/or` `GetKeyboardLayout() ) is used to`\ndetermine the users’ default locale. The following countries are most frequently excluded\nfrom execution:\n\nRussia\nCherokee Nation\nUkraine\nTatar\nYakut\nSakha\n\nA commonly used UAC bypass technique is utilized to ensure that the threat is running with\nthe required privileges. Specifically, this is a [UAC bypass via CMSTPLUA COM interface.](https://gist.github.com/api0cradle/d4aaef39db0d845627d819b2b6b30512)\n\nExisting Windows tools and utilities are used to manipulate and disable system recovery\noptions, backups, and Volume Shadow Copies. Some syntax can vary across\nvariants. WMIC.EXE is typically used to remove VSS via SHADOWCOPY DELETE\n/nointeractive.\n\nWe have also observed the following commands issued by Avaddon payloads:\n\nbcdedit.exe /set {default} recoveryenabled No\nbcdedit.exe /set {default} bootstatuspolicy ignoreallfailures\nvssadmin.exe Delete Shadows /All /Quiet\nwbadmin DELETE SYSTEMSTATEBACKUP -deleteOldest\n\n\n-----\n\nWhile there have been changes to Avaddon’s encryption routine to combat 3rd party\ndecryption, the historic flow, simplified, would be:\n\n1. Generation of session Key (AES 256)\n2. Update master key (AES 256)\n3. Master key encrypts relevant user and environment data, along with the ransom note\n\n(typically Base64)\n4. Files are encrypted via the session key\n5. Append encrypted session key (RSA 2048) to the end of each encrypted file\n\n\n-----\n\n## Avaddon Evasion Techniques\n\nAvaddon can be configured to terminate specific processes. This is frequently done to target\nsecurity products or processes which might interfere with the encryption process. An\nexample process list would be:\n```\n  DefWatch\n  ccEvtMgr\n  ccSetMgr\n  SavRoam\n  dbsrv12\n  sqlservr\n  sqlagent\n  Intuit.QuickBooks.FCS\n  dbeng8\n  sqladhlp\n  QBIDPService\n  Culserver\n  RTVscan\n  vmware-usbarbitator64\n  vmware-converter\n  VMAuthdService\n  VMnetDHCP\n  VMUSBArbService\n  VMwareHostd\n  sqlbrowser\n  SQLADHLP\n  sqlwriter\n  msmdsrv\n  tomcat6\n  QBCFMonitorService\n\n```\n\n-----\n\nAvaddon has also been known to prioritize the encryption of Microsoft Exchange-related\ndirectories.\n\nMost Avaddon payloads will exclude the following critical OS locations from encryption:\n```\n  C:PERFLOGS\n  C:PROGRAM FILES (X86)\n  C:PROGRAMDATA\n  C:USERS<USER>APPDATA\n  C:USERS<USER>APPDATALOCALTEMP\n  C:USERSPUBLIC\n  C:WINDOWS\n\n```\nPersistence mechanisms can also vary, and we have observed variations of Avaddon that\nutilize the creation of a new Windows service, as well as the use of scheduled tasks for\npersistence.\n\n## Avaddon Post-Infection Behavior\n\nInfected files are renamed with an extension consisting of randomly generated letters. These\nextensions are unique for each victim.\n\nEarlier versions of Avaddon would also replace the infected hosts’ wallpaper image. The\ncurrent version presents victims with a ransom note as shown below. Victims are warned that\naside from their data being encrypted, the actors “have also downloaded a lot of private data\nfrom your network”.\n\n\n-----\n\nVictims are instructed to visit the Avaddon payment portal via the TOR browser, where they\nmust enter their unique ID (found in the ransom note) to proceed.\n\nThe actors behind Avaddon do not wait for victims to become non-compliant before they are\nnamed and shamed on the blog. Company names appear with a timer, counting down to the\nposting time for any data stolen from the targeted environment.\n\n\n-----\n\nIt is important to note that victims appear on the leak site at the point when they are\nbreached, and not just when the actor decides to release their data. This means that a\ncompany breach could easily become public knowledge regardless of any action taken by\nthe victim, and potentially at a time where the target company would rather ‘control the\nrelease’ of that type of information.\n\nAt the time of writing, there are just over sixty companies listed, 19 of which include fully\nreleased dumps of sensitive information.\n\nAvaddon does not appear to have any particular preference or scruples when it comes to\ntargets. Whereas some ransomware groups have backed off certain types of targets during\nthe ongoing pandemic, Avaddon victims to date include healthcare-related entities. That\nsaid, the most represented industries in their victimology are Information Technology &\nServices, Food Production, Legal Services, and Manufacturing.\n\n## Conclusion\n\nAvaddon is another successful example of the current RaaS model. lt has appeared on the\nscene and made an impact very quickly. The actors are disciplined with regard to whom they\nwill accept as an affiliate, which ensures some degree of longevity and exclusivity. In\naddition, they very quickly adopted the more aggressive extortion techniques tied to modern\nransomware families. This not only includes the public leaking of data but also the threat of\nDDoS attacks, personal threats, and advertisement-based taunting.\n\nAll of these, along with tight payment requirements for the victims, have put Avaddon in a\npotentially powerful position. They have yet to garner quite the same amount of media\n[attention as predecessors such as Maze and](https://www.sentinelone.com/wp-content/uploads/maze-ransomware-update-extorting-and-exposing-victims/) [Egregor, but there is no reason to believe that](https://www.sentinelone.com/wp-content/uploads/egregor-raas-continues-the-chaos-with-cobalt-strike-and-rclone/)\nAvaddon is any less dangerous. At this time, those behind Avaddon are highly-engaged with\n\n\n-----\n\ntheir community and actively developing and iterating in response to security research and\ndetection. With Avaddon version 2 on the horizon, we only expect to see increased activity\nfrom this actor as we move further into 2021.\n\n## Indicators of Compromise\n\n**SHA1:**\n\nc41d5b04b8219df57249ecdba8faa97c3d4a7fc2\n\nc1f6f1e1a27e7be32a3f18440c05951fa7e52eb9\n\nc0fc01350ae774f3817d71710d9a6e9adaba441f\n\n4915feb5b5cccd9e75f0bd4af5e35211353a207e\n\nfc12d7ad112ddabfcd8f82f290d84e637a4d62f8\n\nf540a1f2fdc0670e1a7a3d55e335e70ebe3089f7\n\n880e40932e56e0aa0b0ad8c413b50fca7d771bbe\n\n7e835d1813f2eaf82c5e38eebf3bfd06ed6513e0\n\na1d6461e833813ccfb77a6929de43ab5383dbb98\n\na37a3b88a15d31a8951243cd6f3f08149244a67d\n\n3b575420ceea4203152041be00dc80519d1532b5\n\ndd2cce7e2f5dcf0a00e4ec9cdbc028476ceb3583\n\n48385b39f2ad900377aba7442d93663506c2b9c5\n\n60ab0dd2ef31cfb96d52fa0a429c3803417db5c2\n\n5ddb793327e1e89ef8f406be11f97e5489f7a5c1\n\nd680d790167a7f84f7e531b2d16db0a0e3359f73\n\ncf5920569b7d802763463b2faf4bbd2cdc21cfad\n\nf94fda611b71bd565c1d603864e21e9cfd3ca99e\n\n40e0fff64ba685d97fe143880a7b01c0137b4ceb\n\n9087d7b5f8b62a2afa4f229b7e254971d4d9b5c3\n\n6a6956aff077aeda5b22873cfb891632fbce6bc7\n\n35831310fa4f11909c44b5db64c44b1064ac1d35\n\n**SHA256:**\n\n28adb5fa487a7d726b8bad629736641aadbdacca5e4f417acc791d0e853924a7\n\n0a052eff71641ff91897af5bdecb4a98ed3cb32bcb6ff86c4396b1e3ceee0184\n\n0ff4058f709d278ed662719b9627618c48e7a656c59f6bfecda9081c7cbd742b\n\n146e554f0d56db9a88224cd6921744fdfe1f8ee4a9e3ac79711f9ab15f9d3c7f\n\n165c5c883fd4fd36758bcba6baf2faffb77d2f4872ffd5ee918a16f91de5a8a8\n\n2946ef53c8fec94dcdf9d3a1afc077ee9a3869eacb0879cb082ee0ce3de6a2e7\n\n29b5a12cda22a30533e22620ae89c4a36c9235714f4bad2e3944c38acb3c5eee\n\n331177ca9c2bf0c6ac4acd5d2d40c77991bb5edb6e546913528b1665d8b501f3\n\n46a8c1e768f632d69d06bfbd93932d102965c9e3f7c37d4a92e30aaeca905675\n\n5252cc9dd3a35f392cc50b298de47838298128f4a1924f9eb0756039ce1e4fa2\n\n61126de1b795b976f3ac878f48e88fa77a87d7308ba57c7642b9e1068403a496\n\n64cfe726643c7783b0f13a2927ab330e35e94a9125122b0cc230eec2bea27dd1\n\n\n-----\n\n6884d700284bc3158dbeb8745bcda3e3b17b69ad049528b125b36e2455bb6b27\n6a4875ddaceaa91fb3369f0f6d962f77442daf1b1d97733457d12bcabdf79441\n8d14c0c8faf6249b67a1d19b7bd1404eb416304d8f5c73b3bdc9c69367e829de\n98388773dc5da7f73a32a08613404029c7cd23078d697700aec6b573b2fa8e09\na5e4cb2f47de005570110b7f3ef1f4b600894469d0561b7e5653671a484a913b\ncaf57646723fe7c34f89618d96af3c2b82816f5d995fd7b951f32571166d3768\ndab7eb2503e0d61d02e6156a47361da97afc53c1dee17c420a0a05de891172c3\nde48c7d7f4865099dba96b6e2c6dca54187fb64e07c319660f072b851ec8b3b3\nf9b748cf35278dc4bfaa2127ca1d6016fafbeb768b1a09c7ab58560632dbd637\nfa4bc4a1dd461ecaadd094a9a21668ecdbb60022fb1b088854a8d13c09155a5c\n\n## MITRE ATT&CK\n\n[T1027 Obfuscated Files or Information](https://attack.mitre.org/techniques/T1027)\n\n[T1497.001 Virtualization/Sandbox Evasion / System Checks](https://attack.mitre.org/techniques/T1497/001/)\n\n[T1202 Indirect Command Execution](https://attack.mitre.org/techniques/T1202/)\n\n[T1078 Valid Accounts](https://attack.mitre.org/techniques/T1078/)\n\n[T1562.001 Impair Defenses: Disable or Modify Tools](https://attack.mitre.org/techniques/T1562/001/)\n\n[T1070.004 Indicator Removal on Host / File Deletion](https://attack.mitre.org/techniques/T1070/004/)\n\n[T1112 Modify Registry](https://attack.mitre.org/techniques/T1112/)\n\n[T1012 Query Registry](https://attack.mitre.org/techniques/T1012/)\n\n[T1082 System Information Discovery](https://attack.mitre.org/techniques/T1082/)\n\n[T1120 Peripheral Device Discovery](https://attack.mitre.org/techniques/T1120/)\n\n[T1490 Inhibit System Recovery](https://attack.mitre.org/techniques/T1490/)\n\n[T1548.002 Abuse Elevation Control Mechanism / Bypass User Account Control](https://attack.mitre.org/techniques/T1548/002/)\n\n[T1566 Phishing](https://attack.mitre.org/techniques/T1566/)\n\n[T1498.001 Network Denial of Service / Direct Network Flood](https://attack.mitre.org/techniques/T1498/001/)\n\n[T1486 Data Encrypted for Impact](https://attack.mitre.org/techniques/T1486/)\n\n[T1543.003 Create or Modify System Process: Windows Service](https://attack.mitre.org/techniques/T1543/003/)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-04-01 - Avaddon RaaS - Breaks Public Decryptor, Continues On Rampage.pdf"
    ],
    "report_names": [
        "2021-04-01 - Avaddon RaaS - Breaks Public Decryptor, Continues On Rampage.pdf"
    ],
    "threat_actors": [
        {
            "id": "77b28afd-8187-4917-a453-1d5a279cb5e4",
            "created_at": "2022-10-25T15:50:23.768278Z",
            "updated_at": "2025-03-27T02:00:55.5423Z",
            "deleted_at": null,
            "main_name": "Inception",
            "aliases": [
                "Inception Framework",
                "Cloud Atlas"
            ],
            "source_name": "MITRE:Inception",
            "tools": [
                "PowerShower",
                "VBShower",
                "LaZagne"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1673536248,
    "ts_updated_at": 1743041316,
    "ts_creation_date": 1653787212,
    "ts_modification_date": 1653787212,
    "files": {
        "pdf": "https://archive.orkl.eu/e3185b40762db850174c340b1eafc7089328e485.pdf",
        "text": "https://archive.orkl.eu/e3185b40762db850174c340b1eafc7089328e485.txt",
        "img": "https://archive.orkl.eu/e3185b40762db850174c340b1eafc7089328e485.jpg"
    }
}