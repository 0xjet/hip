{
    "id": "df1b98db-e7f8-4fd2-b928-49730a231754",
    "created_at": "2023-01-12T15:09:51.079512Z",
    "updated_at": "2025-03-27T02:05:37.508526Z",
    "deleted_at": null,
    "sha1_hash": "549653c0542dcff24eba80f3899edc6290e2e25f",
    "title": "2021-09-27 - Fake Installers Drop Malware and Open Doors for Opportunistic Attackers",
    "authors": "",
    "file_creation_date": "2022-05-28T15:27:13Z",
    "file_modification_date": "2022-05-28T15:27:13Z",
    "file_size": 326607,
    "plain_text": "# Fake Installers Drop Malware and Open Doors for Opportunistic Attackers\n\n**[trendmicro.com/en_us/research/21/i/fake-installers-drop-malware-and-open-doors-for-opportunistic-attackers.html](https://www.trendmicro.com/en_us/research/21/i/fake-installers-drop-malware-and-open-doors-for-opportunistic-attackers.html)**\n\nSeptember 27, 2021\n\n[It is widely known that with regard to cybersecurity, a user is often identified as the weakest link. This means that they become typical entry](https://www.sans.org/blog/this-is-why-the-human-is-the-weakest-link/)\nvectors for attacks and common social-engineering targets for hackers. Enterprises can also suffer from these individual weak links.\nEmployees are sometimes unaware of online threats, or are unfamiliar with cybersecurity best practices, and attackers know exactly how to\ntake advantage of this gap in security.\n\nOne way that attackers trick users is by luring them with unauthorized apps or installers carrying malicious payloads. We recently spotted\nsome of these fake installers being used to deliver bundles of malware onto victims’ devices. These fake installers are not a new technique\nused by attackers; in fact, they are old and widely used lures that trick users into opening malicious documents or installing unwanted\napplications. Some users fall into this trap when they search the internet for free or cracked versions of paid applications.\n\nLooking inside the fake installers\n\nWe saw users trying to download cracked versions of non-malicious applications that had limited free versions and paid full versions,\nspecifically, TeamViewer (a remote connectivity and engagement solutions app), VueScan Pro (an app for scanner drivers), Movavi Video\nEditor (an all-in-one video maker), and Autopano Pro for macOS (an app for automated picture stitching).\n\nOne example that we dive into here involves a user who tried to download an unauthorized version of TeamViewer (an app that has actually\n[been used as camouflage for trojan spyware before). The user downloaded a malicious file disguised as a crack installer for the application.](https://www.trendmicro.com/vinfo/us/security/news/cybercrime-and-digital-threats/modified-teamviewer-tool-drops-trojan-spyware-on-victims)\n\nFigure 1. Malicious files\n\ndownloaded by user\nAfter downloading and executing these files, one of the child processes created other files and the executable setup.exe/setup**installv1.3.exe, which was extracted from 320yea_Teamviewer_15206.zip via WinRAR.exe. This file seems to be the source of most of the**\ndownloaded malicious files, as seen in the following figure.\n\nFigure 2. Unpacking of setup-installv1.3.exe via WinRar.exe\n\nAfterward, the file aae15d524bc2.exe was dropped and executed via Command Prompt. It then spawned a file, C:\\Users\\\n**{username}\\Documents\\etiKyTN_F_nmvAb2DF0BYeIk.exe, which sequentially initiated the BITS admin download. BITS admin is a**\ncommand-line tool that can help monitor progress and create, download, and upload jobs. The tool also allows a user to obtain arbitrary files\nfrom the internet, a feature that attackers can abuse.\n\n\n-----\n\nFigure 3. BITS admin\n\nexecution detection\nWe also observed that information in the browser's credential store was taken by the attacker. Specifically, the stored data in C:\\Users\\\n**{username}\\AppData\\Local\\Microsoft\\Edge\\User Data\\Default\\Login was copied. Credentials stored in browsers are often critical personal**\ndata that could be leveraged by attackers to gain access into personal, business, or financial accounts. Attackers can even compile and sell\nthis information in underground markets.\n\nTo maintain persistence, an executable file was entered in the AutoStart registry and a scheduled task was created:\n\nCreate scheduled task: C:\\Windows\\System32\\schtasks.exe /create /f/sc onlogon /rl highest /tn\"services64\"/tr '\"C:\\Users\\\n{username}\\AppData\\Roaming\\services64.exe\"'\nAutoStart registry: HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\\prun:C:\\WINDOWS\\PublicGaming\\prun.exe\n\nAs previously mentioned, these cases come about because users search for free applications and trust that someone is going to put the\ncracked or stolen full version online as a gesture of good will. But as we can see, attackers simply take advantage of those who download\nthese files.\n\nIn Figure 4, we can see that a trojanized VueScan file is already in a Downloads folder and is executed by legitimate user.\n\nFigure 4. Unpacking of 61193b_VueScan-Pro-974.zip which created a new process\nFollowing the execution of setup_x86_x64_install.exe, it created and executed a new file named setup_installer.exe that dropped several\nfiles and queried several domains. Most of these domains are malicious, as evidenced in Figure 5.\n\n\n-----\n\nFigure 5. Dropped malicious files querying\n\nseveral domains\nThis malicious payload also exhibits backdoor behavior. We can see that the attackers are listening on these channels: 127.0.0.1:53711 and\n127.0.0.1:53713. This lets the attacker keep a foothold in the computer; through this, they can possibly move laterally across the network and,\nif it is an enterprise device, compromise a critical company asset.\n\nThe other fake installers also had similar behavior that exploits users that attempt to download either an unauthorized application\ncracker/activator or an illegal full version. These infections then create persistence for later access.\n\nHow widespread is the threat?\n\nCamouflaged malicious installers and apps are often used to load malware onto victim’s devices. A few recent examples are widespread fake\n[cryptocurrency-mining applications that took advantage of neophyte cryptominers and fake Covid-19 update apps. In tracking this current](https://www.trendmicro.com/en_us/research/20/d/coronavirus-update-app-leads-to-project-spy-android-and-ios-spyware.html)\nbatch of fake installers, we were able to detect incidents around the world. We initially do not classify these particular events as targeted\nattacks, mostly because in all cases the users actively searched for application crackers or unlocked versions of software. But even if these\nwere not initially targeted attacks, they can later lead to opportunistic hacks because the attacker already has a presence in the computer.\nAside from loading malware, the attackers can use their initial access to conduct malicious activity, like compromising a company’s virtual\nprivate network (VPN). They could even sell the access to other cybercrime gangs, such as ransomware operators. It’s important to stress that\n[attackers use every tool within reach, and even legitimate applications can be weaponized.](https://www.trendmicro.com/vinfo/us/security/news/cybercrime-and-digital-threats/locked-loaded-and-in-the-wrong-hands-legitimate-tools-weaponized-for-ransomware-in-2021)\n\n\n-----\n\nFigure 6. Unique detections per region of the indicators of compromise (IOCs) listed in the following. The data is sourced from Trend Micro™\nSmart Protection Network™ for the month of August.\nOf course, we also know that software piracy is prevalent in many regions. From the data in Figure 6, we can surmise that it is still a major\nthreat to security. Users have to be more aware of the threats these illegal installers can hold and implement stricter security practices for\ninstalling and executing applications from the internet onto their personal and work devices.\n\nThe global pandemic has pushed users out of offices and into work-from-home (WFH) situations where there are other “physically” connected\ndevices like the internet of things (IoT), personal mobiles, and personal computers that have weak security. These present a problem because\nmalware can quickly spread from personal devices to business computers on the same network.\n\nMalicious capabilities of the fake installers\n\nWe were able to analyze some of the malicious files bundled into the installers. Their capabilities are varied, from cryptocurrency mining to\nstealing credentials from social media applications. We enumerate them in this table:\n\nMalicious file Actions\n\nTrojan.Win32.MULTDROPEX.A **Main dropper of the malicious file**\n**Disguised as cracker/installer of legitimate applications**\n\nTrojan.Win32.SOCELARS.D **Gathers information regarding the machine**\n**Collects browser information**\n**Collects information from Steam application**\n**Drops Google Chrome extension responsible for further stealing of Facebook/credit**\n**card/payment credentials**\n\nTrojan.Win32.DEALOADER.A Malware downloader\n\nURL inactive, but based on research possibly another stealer\n\nTrojanSpy.Win32.BROWALL.A Collects browser information\n\nCollects cryptocurrency wallet information\n\nTrojanSpy.Win32.VIDAR.D Collects browser information\nCollects credentials\n\n\n-----\n\nTrojan.Win64.REDLINESTEALER.N\n\n\nExecutes command from remote user\nGathers information regarding the machine\nCollects browser information\nCollects FTP client information\nCollects VPN information\nCollects cryptocurrency wallet information\nCollects information from other applications (Discord, Steam, Telegram)\n\n\nCoinminer.MSIL.MALXMR.TIAOODBL Downloads miner module hosted on Discord\n\nXMR miner\nInstalls persistence via scheduled tasks and AutoRun registry\n\nHow to protect yourself from the threat of malware\n\nAs aforementioned, fake installers are not new, but they are still a widely used delivery system for malware. Attackers are uploading more and\nmore of these files for a simple reason: They work. Users download and execute these installers, and this lets attackers maintain persistence\nin personal devices and gives them a way into company networks as well.\n\nTo combat this threat, it is important for users to be educated on the effects of downloading files from untrusted websites. There are also other\nsecurity measures to take:\n\nA multilayered security approach is necessary when protecting the environment. If one layer of protection fails, there are still others in\nplace that can prevent the threat.\nApplication control will help prevent execution of suspicious files.\nRestricting admin rights for users that do not need access is also a good preventive measure.\n\nIndicators of Compromise\n\n**File name** **SHA256** **Detection name**\n\nsetup-installv1.3.exe 787939d2fc30c7b6ff6ddb7f4e7f981c2a2bad0788b2f4d858c3bb10186d42f6 Trojan.Win32.MULTDROPEX.A\n\nsetup_installer.exe bdf727b2ac0b42a955c4744bf7768cbb9fa67167321e4fb5639ee5529ccbcfa4 Trojan.Win32.MULTDROPEX.A\n\nsetup_install.exe 97f18d430b68ac9379ecd267492e58734b3c57ffd66615e27ff621ea2bce8e6b Trojan.Win32.MULTDROPEX.A\n\n5f9a813bc385231.exe 9dcacda3913e30cafd92c909648b5bffde14b8e39e6adbfb15628006c0d4d3c2 Trojan.Win32.SOCELARS.CDK\n\nsqlite.dll 5c41a6b98890b743dd67caa3a186bf248b31eba525bec19896eb7e23666ed872 TrojanSpy.Win32.SOCELARS.CDK\n\nb5203513d7.exe a5f373f8bcfae3d9f4895c477206de63f66f08e66b413114cf2666bed798eb71 Coinminer.MSIL.MALXMR.TIAOOD\n\n5f9a813bc38523010.exe 8bd8f7a32de3d979cae2f487ad2cc5a495afa1bfb1c740e337c47d1e2196e1f2 Trojan.Win32.DEALOADER.A\n\naae15d524bc2.exe 1cdddf182f161ab789edfcc68a0706d0b8412a9ba67a3f918fe60fab270eabff TrojanSpy.Win32.BROWALL.A\n\nbf2e8642ac5.exe e3c9119e809a1240caaaf4b6d5420352f037cc2585cb321cb746f05ed0ec0e43 TrojanSpy.Win32.SOCELARS.D\n\n745d0d3ff9cc2c3.exe b151ffd0f57b21600a05bb28c5d1f047f423bba9750985ab6c3ffba7a33fa0ff TrojanSpy.Win32.VIDAR.D\n\n438dc1669.exe e254914f5f7feb6bf10041e2c705d469bc2b292d709dc944381db5911beb1d9f Trojan.Win64.REDLINESTEALER.N\n\n1cr.exe 949eec48613bd1ce5dd05631602e1e1571fa9d6b0034ab1bffe313e923aff29c TrojanSpy.MSIL.REDLINESTEALER\n\na6168f1f756.exe c5483b2acbb352dc5c9a811d9616c4519f0e07c13905552be5ec869613ada775 Coinminer.MSIL.MALXMR.TIAOOD\n\nf65dc44f3b4.exe dc5bbf1ea15c5235185184007d3e6183c7aaeb51e6684fbd106489af3255a378 Mal_HPGen-50\n\na070c3838.exe 9e1a149370efe9814bf2cbd87acfcfa410d1769efd86a9722da4373d6716d22e TROJ_GEN.R053C0PHC21\n\n**Malicious URLs:**\n\nhxxp://fsstoragecloudservice[.]com/data/data[.]7z\n\nhxxp://3[.]128[.]66[.]194/\n45[.]14[.]49[.]68\nplugnetx[.]com\nznegs[.]xyz\niryarahara[.]xyz\nswiftlaunchx[.]com\nbluewavecdn[.]com\nsproutfrost[.]com\n\n\n-----\n\np //3 [ ]0[ ] [ ]8/\nhxxp://52[.]51[.]116[.]220/\n195[.]181[.]169[.]68\n88[.]99[.]66[.]31\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-09-27 - Fake Installers Drop Malware and Open Doors for Opportunistic Attackers.pdf"
    ],
    "report_names": [
        "2021-09-27 - Fake Installers Drop Malware and Open Doors for Opportunistic Attackers.pdf"
    ],
    "threat_actors": [
        {
            "id": "d90307b6-14a9-4d0b-9156-89e453d6eb13",
            "created_at": "2022-10-25T16:07:23.773944Z",
            "updated_at": "2025-03-27T02:02:09.974695Z",
            "deleted_at": null,
            "main_name": "Lead",
            "aliases": [
                "Casper",
                "TG-3279"
            ],
            "source_name": "ETDA:Lead",
            "tools": [
                "Agentemis",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "RbDoor",
                "RibDoor",
                "Winnti",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673536191,
    "ts_updated_at": 1743041137,
    "ts_creation_date": 1653751633,
    "ts_modification_date": 1653751633,
    "files": {
        "pdf": "https://archive.orkl.eu/549653c0542dcff24eba80f3899edc6290e2e25f.pdf",
        "text": "https://archive.orkl.eu/549653c0542dcff24eba80f3899edc6290e2e25f.txt",
        "img": "https://archive.orkl.eu/549653c0542dcff24eba80f3899edc6290e2e25f.jpg"
    }
}