{
    "id": "0acb8f40-3d9b-4ab3-bc9a-86318eab5f67",
    "created_at": "2023-01-12T15:08:30.901389Z",
    "updated_at": "2025-03-27T02:10:49.322608Z",
    "deleted_at": null,
    "sha1_hash": "69d8bc8b6e71d6eaf2399253663dc929bb1ea812",
    "title": "2021-02-02 - Credit card skimmer piggybacks on Magento 1 hacking spree",
    "authors": "",
    "file_creation_date": "2022-05-28T19:21:36Z",
    "file_modification_date": "2022-05-28T19:21:36Z",
    "file_size": 748048,
    "plain_text": "# Credit card skimmer piggybacks on Magento 1 hacking spree\n\n**[blog.malwarebytes.com/cybercrime/2021/02/credit-card-skimmer-piggybacks-on-magento-1-hacking-spree/](https://blog.malwarebytes.com/cybercrime/2021/02/credit-card-skimmer-piggybacks-on-magento-1-hacking-spree/)**\n\nJérôme Segura February 2, 2021\n\nBack in the fall of 2020 threat actors started to massively exploit a vulnerability in the nolonger maintained Magento 1 software branch. As a result, thousands of e-commerce shops\nwere compromised and many of them injected with credit card skimming code.\n\nWhile monitoring activities tied to this Magento 1 campaign, we identified an e-commerce\nshop that had been targeted twice by skimmers. This in itself is not unusual, multiple\ninfections on the same site are common.\n\nHowever this case was different. The threat actors devised a version of their script that is\naware of sites already injected with a Magento 1 skimmer. That second skimmer will simply\nharvest credit card details from the already existing fake form injected by the previous\nattackers.\n\nIn the incident we describe in this post, the threat actors also took into account that an ecommerce site may get cleaned up from a Magento 1 hack. When that happens, an alternate\nversion of their skimmer injects its own fields that mimic a legitimate payments platform.\n\n## Mass Magento 1 infections\n\n\n-----\n\nThe [Magento 1 end-of-life coupled with a popular exploit turned out to be a huge boon for](https://magento.com/blog/magento-news/support-magento-1-software-ends-june-30-2020)\nthreat actors. A large number of sites have been hacked indiscriminately just because they\nwere vulnerable.\n\nRiskIQ [attributed these incidents to Magecart Group 12, which has a long history of web](https://community.riskiq.com/article/fda1f967)\n[skimming using various techniques including supply-chain attacks.](https://www.riskiq.com/blog/labs/magecart-adverline/?_ga=2.197233007.1381696202.1611076272-1204866355.1496853547)\n\nFigure 1: Skimming code injected in Magento 1 sites\nThis skimmer is rather lengthy and contains various levels of obfuscation that make\n[debugging it more challenging. Although there are variations, the format and decoy payment](https://antoinevastel.com/fraud/2020/09/20/analyzing-magento-skimmer.html)\nform are very much the same.\n\n## No honor among thieves\n\nCostway is a retailer that started to sell its own name-brand products via platforms such as\nAmazon and later rolled out costway.com and subsequent localized online stores. Their\n[French portal (costway[.]fr) attracted about 180K visitors last December.](https://www.similarweb.com/website/costway.fr/#overview)\n\nOur crawlers identified that the websites for Costway France, UK, Germany and Spain,\nwhich run the Magento 1 software, had been compromised around the same time frame.\n\n\n-----\n\nWe can see the credit card skimmer injection directly on the checkout page for costway[.]fr\nas it stands out in English while the rest of the site is in French. This is not surprising\nconsidering that the Magento 1 hacking campaign is automated and fairly indiscriminate.\n\nFigure 2: Costway site already hacked with Magento 1 skimmer\nBut what’s more interesting is that another skimmer is also present on the site (loaded\nexternally from securityxx[.]top) and targeting the Magento 1 skimmer.\n\nIt’s possible that the threat actors’ level of access to e-commerce sites differs. The former\nexploit a core vulnerability that grants them root access while perhaps the latter can only\nperform specific types of injections. If that is the case, this would explain why they simply\nleave the fake form alone and grab credentials from it.\n\n\n-----\n\nThere s an additional twist here where the criminals also planned for the scenario where the\ne-commerce site gets cleaned up from the Magento 1 injection.\n\nFigure 3: Costway site cleaned up from Magento 1 hack but with external skimmer\n\n\n-----\n\nThe skimmer creates its own form fields which closely ressemble the legitimate ones from\nthe [Adyen payments platform that Costway uses. Visually, only a very small style change](https://www.adyen.com/)\n(font size) gives it away, but there are more significant implications under the hood.\n\nFigure 4: External skimmer mimics Adyen payments form\n\n\n-----\n\nAdyen encrypts the form fields using their proprietary technology. The threat actors wanted to\nrecreate the same look and feel from Adyen but be able to harvest the credit card information\nin their own way.\n\nTo summarize, from a victim’s perspective, there are 3 different skimmers that get loaded\nwhen they proceed to the checkout page.\n\n1. Magento 1 hack skimmer injected directly in checkout page\n2. Custom skimmer (securityxx[.]top/security.js) that steals from Magento 1 skimmer\n3. Custom skimmer (securityxx[.]top/costway.js) that alters legitimate payment iframe\n\nFigure 5: Web traffic\n\nshowing all 3 skimmers\n\n## Previous skimmer\n\nThe same threat actors were already busy working on Costway’s compomise at least in late\n[December 2020 as recorded in this urlscanio crawl. They used the custom domain](https://urlscan.io/result/c0fe6e77-b4aa-416b-bd4d-6231e8ba2523/#transactions)\ncostway[.]top to host their code.\n\nFigure 6: Earliest documented instance of compromise via custom domain\nThe domain costway[.]top is related to a family we have come across before. There is\noverlap with the skimmer code they use, naming conventions and even infrastructure.\n\n\n-----\n\nFigure 7:\n\nRelationship graph showing previous connections\nAt the moment, this group is quite active and continues with the same techniques we have\nseen several months ago.\n\n## Competing for resources\n\nA large number of Magento 1 sites have been hacked but yet are not necessarily being\nmonetized. Other threat actors that want access will undoubtedly attempt to inject their own\nmalicious code. When that happens, we see criminals trying to access the same resources\n[and sometimes fighting with one another.](https://blog.malwarebytes.com/threat-analysis/2018/11/web-skimmers-compete-umbro-brasil-hack/)\n\nWe informed Costway during our investigation but also witnessed their site getting\nreinfected. The costway[.]top domain was discarded in favor of securityxx[.]top where threat\nactors customized the skimmer specifically for them.\n\nAt the time of writing, costway[.]fr is still compromised but Malwarebytes users are protected\nthanks to our [Browser Guard extension and general web protection available in our software.](https://www.malwarebytes.com/browserguard/)\n\n\n-----\n\n_[We would like to thank Jordan Herman over at](https://twitter.com/TracerSpiff)_ _[RiskIQ for sharing additional indicators with](https://www.riskiq.com/)_\n_us._\n\n## Indicators of Compromise (IOCs)\n\nsecurityxx[.]top\n\ncostway[.]top\n\nhdpopulation[.]com\n\ncdnanalyze[.]com\n\nhdenvironement[.]com\n\ncrazyvaps[.]info\n\ncdnchecker[.]org\n\ncdnoptimize[.]com\n\nhdanalyse[.]com\n\ncdnapis[.]org\n\ncookiepro[.]cloud\n\ncdndoubleclick[.]net\n\n149[.]248[.]7[.]219\n\n95[.]179[.]142[.]28\n\n45[.]76[.]75[.]35\n\n136[.]244[.]110[.]105\n\n149[.]248[.]0[.]74\n\n149[.]28[.]64[.]156\n\n95[.]179[.]139[.]29\n\n209[.]250[.]246[.]214\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-02-02 - Credit card skimmer piggybacks on Magento 1 hacking spree.pdf"
    ],
    "report_names": [
        "2021-02-02 - Credit card skimmer piggybacks on Magento 1 hacking spree.pdf"
    ],
    "threat_actors": [
        {
            "id": "5a0483f5-09b3-4673-bb5a-56d41eaf91ed",
            "created_at": "2023-01-06T13:46:38.814104Z",
            "updated_at": "2025-03-27T02:00:02.925972Z",
            "deleted_at": null,
            "main_name": "MageCart",
            "aliases": [],
            "source_name": "MISPGALAXY:MageCart",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673536110,
    "ts_updated_at": 1743041449,
    "ts_creation_date": 1653765696,
    "ts_modification_date": 1653765696,
    "files": {
        "pdf": "https://archive.orkl.eu/69d8bc8b6e71d6eaf2399253663dc929bb1ea812.pdf",
        "text": "https://archive.orkl.eu/69d8bc8b6e71d6eaf2399253663dc929bb1ea812.txt",
        "img": "https://archive.orkl.eu/69d8bc8b6e71d6eaf2399253663dc929bb1ea812.jpg"
    }
}