{
    "id": "6edd82cd-5992-41ee-a745-94498602df93",
    "created_at": "2023-01-12T15:10:41.60207Z",
    "updated_at": "2025-03-27T02:06:01.51893Z",
    "deleted_at": null,
    "sha1_hash": "4f667ff1e78cde3a06e8152196c64221edcc9177",
    "title": "2013-03-05 - Russian ransomware takes advantage of Windows PowerShell",
    "authors": "",
    "file_creation_date": "2022-05-27T18:57:35Z",
    "file_modification_date": "2022-05-27T18:57:35Z",
    "file_size": 979205,
    "plain_text": "# Russian ransomware takes advantage of Windows PowerShell\n\n**[nakedsecurity.sophos.com/2013/03/05/russian-ransomware-windows-powershell/](https://nakedsecurity.sophos.com/2013/03/05/russian-ransomware-windows-powershell/)**\n\nBy Anand Ajjan 05 Mar 2013\n\nFor us in SophosLabs, ransomware is a common sight. We see many different versions\nevery day. But as to be expected, the authors think up a new gimmick that makes us take\nnotice. This is one of those cases.\n\nRecently we received a ransomware sample from one of our\ncustomers, which immediately piqued our interest as it used\nWindows PowerShell program to perform file encryption.\n\nFor those who may not be aware, Windows PowerShell is a\nscripting language from Microsoft designed to help system\nadministrators automate some the tasks required to run a\nWindows network. It’s included with Windows 7 and later but can\nbe installed on earlier Windows operating systems too.\n\nThis latest ransomware uses this Windows PowerShell program to perform file encryption\nusing “Rijndael symmetric key encryption”. This variant also targets Russian users with a\nransom message displayed in the Russian language.\n\n**Here’s how this ransomware works:**\n\nIt arrives as spam containing an HTA file attachment. The HTA file contains a pair of Base64\nencoded strings. These are decoded to two scripts that do the bulk of the ransomware’s\nwork.\n\nThe first script checks whether the system has Windows PowerShell installed or not. If not, it\ndownloads a copy from a Dropbox.com account and installs it.\n\n\n-----\n\nThe second Base64 decoded string is the PowerShell script that performs file encryption. It\nuses “Rijndael symmetric key encryption” using PowerShell’s CreateEncryptor() function.\n\n\n-----\n\nAs with most file-encrypting ransomware, this one chooses files that may contain information\nof value to the victim. In this case, an extensive list of 163 file types ranging from documents\nand spreadsheets to pictures and videos.\n\nThe ransom demand takes the form of a text file named READ_ME_NOW.txt, created in\neach encrypted file folder which contains encrypted files. The message is in Russian and\ninstructs the victim to visit the webpage shown below.\n\nTranslation:\n\n\n-----\n\n```\n  Your files are encrypted?\n  Do you want to unlock your files and do not know how?\n  You can get the decryption program in fully automatic mode in a\n  few minutes!\n  To decrypt your files must have a unique code, which is\n  contained in the file READ_ME_NOW.txt, so we can learn the code\n  please upload the file READ_ME_NOW.txt the form below. This file\n  is in any directory that has encrypted files.\n\n```\nIf the user uploads the READ_ME_NOW.txt file as instructed they will be taken to a second\npage of instructions.\n\nTranslation:\n```\n  You are logged in!\n  We successfully read your unique lock code. For you, there is\n  good news and bad news:\n  The good news is that you can get the program and fully unlock\n  and clean your PC in just a few minutes.\n  The bad news - a program to unlock costs 10 TR for one PC\n  To prove to you that we can provide the unique program for your\n  PC that will unlock all of your files - you can upload any one\n  of the encrypted files no larger than 1 megabyte, and we will\n  automatically decode it.\n\n```\n\n-----\n\nAt this point the true desire of the attackers becomes apparent – and costly – a 10,000 Ruble\ncharge for undoing the damage they have done. (At today’s rate 10,000 Rubles converts to\nabout £217, €250, or $326 USD. Not exactly ‘priced to sell’.)\n\nWe have also seen two types of encryption key used by this ransomware.\n\n1. Uses a Universally Unique Identifier (UUID) as the encryption key and renames it with\n\nan extension .FTCODE\n2. Uses a randomly generated string, 50 characters long and including 4 non alpha\n\nnumeric values as encryption key and renames it with an extension .BTCODE. This\nkey is generated using the GeneratePassword() command. This handy function takes 2\nparameters: length of the password to create and the number of non-alphanumeric\ncharacters to include. Very useful if you have a hard time coming up with strong\npasswords by yourself.\n\nBut there’s good news. In both cases the encryption key can be recovered without paying for\nit. In fact, this can be done using the same PowerShell tool that the attackers used.\n\nThe first, UUID, key can be retrieved with this command.\n```\n  Get-wmiobject Win32_ComputerSystemProduct UUID\n\n```\nThe second with:\n```\n  Gwmi win32_computerSystem Model\n\n```\nThus the encryption keys can be relatively simple to retrieve by anyone who would rather not\npay 10,000 Rubles/£217/€250/$326 to get their files back.\n\nWe always advise against paying the ransom to the criminals behind ransomware. Even if\nyou pay there’s no guarantee that they will uphold their end of the bargain. It’s more likely\nthat you’ll be left with a bunch of encrypted files and lighter wallet.\n\nSophos customers, take note that our security products detect these variants as\nTroj/Ransom-NY.\n\nAnd if you want to know more about the inner-workings of ransomware, why not take a\n[gander at our new technical paper “Ransomware: Next Generation Fake Antivirus” – no](http://www.sophos.com/en-us/why-sophos/our-people/technical-papers/ransomware-next-generation-fake-antivirus.aspx)\nregistration or Rubles required.\n\n[Windows image from Shutterstock.](http://www.shutterstock.com/pic.mhtml?id=847885)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2013/2013-03-05 - Russian ransomware takes advantage of Windows PowerShell.pdf"
    ],
    "report_names": [
        "2013-03-05 - Russian ransomware takes advantage of Windows PowerShell.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673536241,
    "ts_updated_at": 1743041161,
    "ts_creation_date": 1653677855,
    "ts_modification_date": 1653677855,
    "files": {
        "pdf": "https://archive.orkl.eu/4f667ff1e78cde3a06e8152196c64221edcc9177.pdf",
        "text": "https://archive.orkl.eu/4f667ff1e78cde3a06e8152196c64221edcc9177.txt",
        "img": "https://archive.orkl.eu/4f667ff1e78cde3a06e8152196c64221edcc9177.jpg"
    }
}