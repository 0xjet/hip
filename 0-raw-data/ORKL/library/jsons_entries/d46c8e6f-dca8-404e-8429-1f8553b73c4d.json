{
    "id": "d46c8e6f-dca8-404e-8429-1f8553b73c4d",
    "created_at": "2023-01-12T14:59:19.723615Z",
    "updated_at": "2025-03-27T02:05:31.448123Z",
    "deleted_at": null,
    "sha1_hash": "4183d1b2edbd9d4a014f7947f71282507950dcdd",
    "title": "2017-10-26 - BACKSWING - Pulling a BADRABBIT Out of a Hat",
    "authors": "",
    "file_creation_date": "2022-05-29T01:10:25Z",
    "file_modification_date": "2022-05-29T01:10:25Z",
    "file_size": 1274758,
    "plain_text": "# BACKSWING - Pulling a BADRABBIT Out of a Hat\n\n**fireeye.com/blog/threat-research/2017/10/backswing-pulling-a-badrabbit-out-of-a-hat.html**\n\n**Executive Summary**\n\nOn Oct. 24, 2017, coordinated strategic web compromises started to distribute BADRABBIT ransomware to unwitting users. FireEye\nappliances detected the download attempts and blocked our user base from infection. During our investigation into the activity, FireEye\nidentified a direct overlap between BADRABBIT redirect sites and sites hosting a profiler we’ve been tracking as BACKSWING. We’ve\nidentified 51 sites hosting BACKSWING and four confirmed to drop BADRABBIT. Throughout 2017, we observed two versions of\nBACKSWING and saw a significant increase in May with an apparent focus on compromising Ukrainian websites. The pattern of deployment\nraises the possibility of a strategic sponsor with specific regional interests and suggest a motivation other than financial gain. Given that many\ndomains are still compromised with BACKSWING, we anticipate that there is a risk that they will be used for future attacks.\n\n**Incident Background**\n\nBeginning on Oct. 24 at 08:00 UTC, FireEye detected and blocked attempts to infect multiple clients with a drive-by download masquerading\nas a Flash Update (install_flash_player.exe) that delivered a wormable variant of ransomware. Users were redirected to the infected site from\nmultiple legitimate sites (e.g. http://www.mediaport[.]ua/sites/default/files/page-main.js) simultaneously, indicating a coordinated and\nwidespread strategic web compromise campaign.\n\nFireEye network devices blocked infection attempts at over a dozen victims primarily in Germany, Japan, and the U.S. until Oct. 24 at 15:00\nUTC, when the infection attempts ceased and attacker infrastructure – both 1dnscontrol[.]com and the legitimate websites containing the rogue\ncode – were taken offline.\n\n**BACKSWING Framework Likely Connected to BADRABBIT Activity**\n\nStrategic web compromises can have a significant amount of collateral targeting. It is common for threat actors to pair a strategic web\ncompromise with profiling malware to target systems with specific application versions or victims. FireEye observed that BACKSWING, a\nmalicious JavaScript profiling framework, was deployed to at least 54 legitimate sites starting as early as September 2016. A handful of these\nsites were later used to redirect to BADRABBIT distribution URLs.\n\nFireEye iSIGHT Intelligence tracks two distinct versions of BACKSWING that contain the same functionality, but differ in their code styles. We\nconsider BACKSWING a generic container used to select attributes of the current browsing session (User-Agent, HTTP Referrer, Cookies, and\nthe current domain). This information is then relayed to a “C2” sometimes to referred to as a “receiver.” If the receiver is online, the server\nreturns a unique JSON blob to the caller which is then parsed by the BACKSWING code (Figure 1).\n\n\n-----\n\nFigure 1: BACKSWING Reply\n\nBACKSWING anticipates the JSON blob to have two fields, “InjectionType” (expected to be an integer) and “InjectionString” (expected to be\nstring containing HTML content). BACKSWING version 1 (Figure 2) explicitly handles the value of “InjectionType” into two code paths:\n\nIf InjectionType == 1 (Redirect browser to URL)\nIf InjectionType != 1 (render HTML into the DOM)\n\nFigure 2: Backswing Version 1\n\n\n-----\n\ne s o ( gu e 3), C S G eta s s a og c, but ge e a es t e ject o St g to be a d ed st ct y to e de t e ep y to t e\nDOM.\n\nFigure 3: BACKSWING Version 2\n\n_Version 1:_\n\nFireEye observed the first version of BACKSWING in late 2016 on websites belonging to a Czech Republic hospitality organization in\naddition to a government website in Montenegro. Turkish-tourism websites were also injected with this profiler.\nBACKSWING v1 was commonly injected in cleartext to affected websites, but over time, actors began to obfuscate the code using the\nopen-source Dean-Edwards Packer and injected it into legitimate JavaScript resources on affected websites. Figure 4 shows the\ninjection content.\nBeginning in May 2017, FireEye observed a number of Ukrainian websites compromised with BACKSWING v1, and in June 2017, began\nto see content returned from BACKSWING receivers.\nIn late June 2017, BACKSWING servers returned an HTML div element with two distinct identifiers. When decoded, BACKSWING v1\nembedded two div elements within the DOM with values of 07a06a96-3345-43f2-afe1-2a70d951f50a and 9b142ec2-1fdb-4790-b48cffdf22911104. No additional content was observed in these replies.\n\n\n-----\n\nFigure 4: BACKSWING Injection Content\n\n_Version 2:_\n\nThe earliest that FireEye observed BACKSWING v2 occurred on Oct. 5, 2017 across multiple websites that previously hosted\nBACKSWING v1\nBACKSWING v2 was predominantly injected into legitimate JavaScript resources hosted on affected websites; however, some instances\nwere injected into the sites’ main pages\nFireEye observed limited instances of websites hosting this version were also implicated in suspected BADRABBIT infection chains\n(detailed in Table 1).\n\nMalicious profilers allow attackers to obtain more information about potential victims before deploying payloads (in this case, the BADRABBIT\n“flash update” dropper). While FireEye has not directly observed BACKSWING delivering BADRABBIT, BACKSWING was observed on\nmultiple websites that were seen referring FireEye customers to 1dnscontrol[.]com, which hosted the BADRABBIT dropper.\n\nTable 1 highlights the legitimate sites hosting BACKSWING that were also used as HTTP referrers for BADRABBIT payload distribution.\n\n**Compromised Website** **BACKSWING Receiver** **BACKSWING Version** **Observed BADRABBIT Redirect**\n\n**blog.fontanka[.]ru** Not Available Not Available 1dnscontrol[.]com\n\n**www.aica.co[.]jp** http://185.149.120[.]3/scholargoogle/ v2 1dnscontrol[.]com\n\n**www.fontanka[.]ru** http://185.149.120[.]3/scholargoogle/ v2 1dnscontrol[.]com\n\n**www.mediaport[.]ua** http://172.97.69[.]79/i/ v1 1dnscontrol[.]com\n\n**www.mediaport[.]ua** http://185.149.120[.]3/scholargoogle/ v2 1dnscontrol[.]com\n\n**www.smetkoplan[.]com** http://172.97.69[.]79/i/ v1 1dnscontrol[.]com\n\n**www.smetkoplan[.]com** http://38.84.134[.]15/Core/Engine/Index/default v1 1dnscontrol[.]com\n\n**www.smetkoplan[.]com** http://185.149.120[.]3/scholargoogle/ v2 1dnscontrol[.]com\n\nTable 1: Sites hosting BACKSWING profilers and redirected users to a BADRABBIT download site\n\n\n-----\n\ne co p o sed ebs tes sted ab e de o st ate o e o t e st t es t at e a e obse ed t e pote t a eapo at o o\nBACKSWING. FireEye is tracking a growing number of legitimate websites that also host BACKSWING underscoring a considerable footprint\nthe actors could leverage in future attacks. Table 2 provides a list of sites also compromised with BACKSWING\n\n**Compromised Website** **BACKSWING Receiver** **BACKSWING Version**\n\n**akvadom.kiev[.]ua** http://172.97.69[.]79/i/ v1\n\n**bahmut.com[.]ua** http://dfkiueswbgfreiwfsd[.]tk/i/ v1\n\n**bitte.net[.]ua** http://172.97.69[.]79/i/ v1\n\n**bon-vivasan.com[.]ua** http://172.97.69[.]79/i/ v1\n\n**bonitka.com[.]ua** http://172.97.69[.]79/i/ v1\n\n**camp.mrt.gov[.]me** http://38.84.134[.]15/Core/Engine/Index/two v1\n\n**Evrosmazki[.]ua** http://172.97.69[.]79/i/ v1\n\n**forum.andronova[.]net** http://172.97.69[.]79/i/ v1\n\n**forum.andronova[.]net** http://91.236.116[.]50/Core/Engine/Index/two v1\n\n**grandua[.]ua** http://172.97.69[.]79/i/ v1\n\n**grupovo[.]bg** http://185.149.120[.]3/scholargoogle/ v2\n\n**hr.pensionhotel[.]com** http://38.84.134[.]15/Core/Engine/Index/default v1\n\n**i24.com[.]ua** http://172.97.69[.]79/i/ v1\n\n**i24.com[.]ua** http://185.149.120[.]3/scholargoogle/ v2\n\n**icase.lg[.]ua** http://172.97.69[.]79/i/ v1\n\n**montenegro-today[.]com** http://38.84.134[.]15/Core/Engine/Index/two v1\n\n**montenegro-today[.]ru** http://172.97.69[.]79/i/ v1\n\n**most-dnepr[.]info** http://172.97.69[.]79/i/ v1\n\n**most-dnepr[.]info** http://185.149.120[.]3/scholargoogle/ v2\n\n**obereg-t[.]com** http://172.97.69[.]79/i/ v1\n\n**sarktur[.]com** http://104.244.159[.]23:8080/i v1\n\n**sarktur[.]com** http://38.84.134[.]15/Core/Engine/Index/default v1\n\n**school12.cn[.]ua** http://172.97.69[.]79/i/ v1\n\n**sinematurk[.]com** http://91.236.116[.]50/Core/Engine/Index/two v1\n\n**vgoru[.]org** http://172.97.69[.]79/i/ v1\n\n\n-----\n\n**www.2000[.]ua** http://172.97.69[.]79/i/ v1\n\n**www.444android[.]com** http://172.97.69[.]79/i/ v1\n\n**www.444android[.]com** http://91.236.116[.]50/Core/Engine/Index/two v1\n\n**www.aica.co[.]jp** http://38.84.134[.]15/Core/Engine/Index/default v1\n\n**www.alapli.bel[.]tr** http://91.236.116[.]50/Core/Engine/Index/two v1\n\n**www.ambilet[.]ro** http://185.149.120[.]3/scholargoogle/ v2\n\n**www.andronova[.]net** http://91.236.116[.]50/Core/Engine/Index/two v1\n\n**www.chnu.edu[.]ua** http://172.97.69[.]79/i/ v1\n\n**www.dermavieskin[.]com** https://bodum-online[.]gq/Core/Engine/Index/three v1\n\n**www.evrosmazki[.]ua** http://172.97.69[.]79/i/ v1\n\n**www.hercegnovi[.]me** http://38.84.134[.]15/Core/Engine/Index/two v1\n\n**www.len[.]ru** http://185.149.120[.]3/scholasgoogle/ v2\n\n**www.montenegro-today[.]com** http://38.84.134[.]15/Core/Engine/Index/two v1\n\n**www.montenegro-today[.]com** http://91.236.116[.]50/Core/Engine/Index/two v1\n\n**www.otbrana[.]com** http://38.84.134[.]15/Core/Engine/Index/default v1\n\n**www.pensionhotel[.]be** http://38.84.134[.]15/Core/Engine/Index/default v1\n\n**www.pensionhotel[.]cz** http://38.84.134[.]15/Core/Engine/Index/default v1\n\n**www.pensionhotel[.]de** http://172.97.69[.]79/i/ v1\n\n**www.pensionhotel[.]de** http://38.84.134[.]15/Core/Engine/Index/default v1\n\n**www.pensionhotel[.]dk** http://38.84.134[.]15/Core/Engine/Index/default v1\n\n**www.pensionhotel[.]nl** http://38.84.134[.]15/Core/Engine/Index/default v1\n\n**www.pensionhotel[.]pl** http://38.84.134[.]15/Core/Engine/Index/default v1\n\n**www.pensionhotel[.]ro** http://46.20.1[.]98/scholargoogle/ v1\n\n**www.pensionhotel[.]sk** http://38.84.134[.]15/Core/Engine/Index/default v1\n\n**www.sinematurk[.]com** http://91.236.116[.]50/Core/Engine/Index/two v1\n\n**www.t.ks[.]ua** http://172.97.69[.]79/i/ v1\n\n**www.teknolojihaber[.]net** http://91.236.116[.]50/Core/Engine/Index/two v1\n\n\n-----\n\n**www.uscc[.]ua** http://172.97.69[.]79/i/ v1\n\n**www.vertizontal[.]ro** http://91.236.116[.]50/Core/Engine/Index/three v1\n\n**www.visa3777[.]com** http://172.97.69[.]79/i/ v1\n\n**www.www.pensionhotel[.]de** http://38.84.134[.]15/Core/Engine/Index/default v1\n\nTable 2: Additional sites hosting BACKSWING profilers and associated receivers\n\nThe distribution of sites compromised with BACKSWING suggest a motivation other than financial gain. FireEye observed this framework on\ncompromised Turkish sites and Montenegrin sites over the past year. We observed a spike of BACKSWING instances on Ukrainian sites, with\na significant increase in May 2017. While some sites hosting BACKSWING do not have a clear strategic link, the pattern of deployment raises\nthe possibility of a strategic sponsor with specific regional interests.\n\n**BADRABBIT Components**\n\nBADRABBIT is made up of several components, as described in Figure 5.\n\nFigure 5: BADRABBIT components\n\nInstall_flashPlayer.exe (MD5: FBBDC39AF1139AEBBA4DA004475E8839)\n\nThe install_flashplayer.exe payload drops infpub.dat (MD5: C4F26ED277B51EF45FA180BE597D96E8) to the C:\\Windows directory and\n[executes it using rundll32.exe with the argument C:\\Windows\\infpub.dat,#1 15. This execution format mirrors that of EternalPetya.](https://www.fireeye.com/blog/threat-research/2017/06/petya-ransomware-spreading-via-eternalblue-exploit.html)\n\ninfpub.dat (MD5: 1D724F95C61F1055F0D02C2154BBCCD3)\n\nThe infpub.dat binary is the primary ransomware component responsible for dropping and executing the additional components shown in the\nBADRABBIT Components section. An embedded RSA-2048 key facilitates the encryption process, which uses an AES-128 key to encrypt\nfiles. The extensions listed below are targeted for encryption:\n\n.3ds.7z.accdb.ai.asm.asp.aspx.avhd.back.bak.bmp.brw.c.cab.cc.cer.cfg.conf.cpp.crt.cs.ctl.cxx.dbf.der.dib.disk.djvu.doc.docx.dwg.eml.fdb.gz.h.hdd\n\nThe following directories are ignored during the encryption process:\n\n\\Windows\n\\Program Files\n\\ProgramData\n\\AppData\n\nThe malware writes its ransom message to the root of each affected drive with the filename Readme.txt.\n\n\n-----\n\ne pub dat s capab e o pe o g ate a o e e t a o S a ested c ede t a s p o ded by a e bedded at\nexecutable facilitate the infection of other systems on the network. The malware contains lists of common usernames, passwords, and named\npipes that it can use to brute-force other credentials for lateral movement.\n\nIf one of four Dr.Web antivirus processes is present on the system, file encryption is not performed. If the malware is executed with the “-f”\ncommand line argument, credential theft and lateral movement are bypassed.\n\ndispci.exe (MD5: B14D8FAF7F0CBCFAD051CEFE5F39645F)\n\nThe dispci.exe binary interacts with the DiskCryptor driver (cscc.dat) to install the malicious bootloader. If one of three McAfee antivirus\nprocesses is running on the system, dispci.exe is written to the %ALLUSERSPROFILE% directory; otherwise, it is written to C:\\Windows. The\nsample is executed on system start using a scheduled task named rhaegal.\n\ncscc.dat (MD5s: B4E6D97DAFD9224ED9A547D52C26CE02 or EDB72F4A46C39452D1A5414F7D26454A)\n\n[A 32 or 64-bit DiskCryptor driver named cscc.dat facilitates disk encryption. It is installed in the :\\Windows directory as a kernel driver service](https://diskcryptor.net/)\nnamed cscc.\n\nMimikatz usage (MD5s: 37945C44A897AA42A66ADCAB68F560E0 or 347AC3B6B791054DE3E5720A7144A977)\n\nA 32 or 64-bit Mimikatz variant is written a temporary file (e.g., 651D.tmp) in the C:\\Windows directory and executed by passing a named pipe\nstring (e.g., \\\\.\\pipe\\{8A93FA32-1B7A-4E2F-AAD2-76A095F261DC}) as an argument. Harvested credentials are passed back to infpub.dat via\nthe named pipe, similar to EternalPetya.\n\n**BADRABBIT Compared to EternalPetya**\n\nThe infpub.dat contains a checksum algorithm like the one used in EternalPetya. However, the initial checksum value differs slightly:\n0x87654321 in infpub.dat, 0x12345678 in EternalPetya. infpub.dat also supports the same command line arguments as EternalPetya with the\naddition of the “-f” argument, which bypasses the malware’s credential theft and lateral movement capabilities.\n\nLike EternalPetya, infpub.dat determines if a specific file exists on the system and will exit if found. The file in this case is cscc.dat. infpub.dat\ncontains a wmic.exe lateral movement capability, but unlike EternalPetya, does not contain a PSEXEC binary used to perform lateral\nmovement.\n\nBoth samples utilize the same series of wevtutil and fsutil commands to perform anti-forensics:\n\nwevtutil cl Setup & wevtutil cl System & wevtutil cl Security & wevtutil cl Application & fsutil usn deletejournal /D %SYSTEMDRIVE%\n\n**FireEye Detections**\n\n**Product** **Detection Names**\n\nNX,EX,AX,FX,ETP malware.binary.exe, Trojan.Ransomware.MVX, Exploit.PossibleWaterhole.BACKSWING\n\n\n-----\n\nHX BADRABBIT RANSOMWARE (FAMILY), Gen:Heur.Ransom.BadRabbit.1, Gen:Variant.Ransom.BadRabbit.1\n\nTAP WINDOWS METHODOLOGY [Scheduled Task Created], WINDOWS METHODOLOGY [Service Installation],\nWINDOWS METHODOLOGY [Audit Log Cleared], WINDOWS METHODOLOGY [Rundll32 Ordinal Arg], WINDOWS\nMETHODOLOGY [Wevtutil Clear-log], WINDOWS METHODOLOGY [Fsutil USN Deletejournal], WINDOWS\nMETHODOLOGY [Multiple Admin Share Failures]\n\nWe would like to thank Edward Fjellskål for his assistance with research for this blog.\n\n**Indicators**\n\nFile: Install_flashPlayer.exe\n\nHash: FBBDC39AF1139AEBBA4DA004475E8839\n\nDescription: install_flashplayer.exe drops infpub.dat\n\nFile: infpub.dat\n\nHash: 1D724F95C61F1055F0D02C2154BBCCD3\n\nDescription: Primary ransomware component\n\nFile: dispci.exe\n\nHash: B14D8FAF7F0CBCFAD051CEFE5F39645F\n\nDescription: Interacts with the DiskCryptor driver (cscc.dat) to install the malicious bootloader, responsible for file decryption.\n\nFile: cscc.dat\n\nHash: B4E6D97DAFD9224ED9A547D52C26CE02 or EDB72F4A46C39452D1A5414F7D26454A\n\nDescription: 32 or 64-bit DiskCryptor driver\n\nFile: <rand_4_hex>.tmp\n\nHash: 37945C44A897AA42A66ADCAB68F560E0 or 347AC3B6B791054DE3E5720A7144A977\n\nDescription: 32 or 64-bit Mimikatz variant\n\nFile: Readme.txt\n\nHash: Variable\n\nDescription: Ransom note\n\nCommand: \\system32\\rundll32.exe C:\\Windows\\infpub.dat,#1 15\n\nDescription: Runs the primary ransomware component of BADRABBIT. Note that “15” is the default value present in the malware and may be\naltered by specifying a different value on command line when executing install_flash_player.exe.\n\nCommand: %COMSPEC% /c schtasks /Create /RU SYSTEM /SC ONSTART /TN rhaegal /TR \"<%COMSPEC%> /C Start \\\"\\\" \\\"\n<dispci_exe_path>\\\" -id\n\nDescription: Creates the rhaegal scheduled task\n\nCommand: %COMSPEC% /c schtasks /Create /SC once /TN drogon /RU SYSTEM /TR \"%WINDIR%\\system32\\shutdown.exe /r /t 0 /f\" /ST\n<HH:MM:00>\n\nDescription: Creates the drogon scheduled task\n\nCommand: %COMSPEC% /c schtasks /Delete /F /TN drogon\n\nDescription: Deletes the drogon scheduled task\n\nCommand: %COMSPEC% /c wswevtutil cl Setup & wswevtutil cl System & wswevtutil cl Security & wswevtutil cl Application & fsutil usn\ndeletejournal /D <current_drive_letter>:\n\nDescription: Anti-forensics\n\nScheduled Task Name: rhaegal\nScheduled Task Run: \"<%COMSPEC%> /C Start \\\"\\\" \\\"<dispci_exe_path>\\\" -id <rand_task_id> && exit\"\n\nDescription: Bootloader interaction\n\nScheduled Task Name: drogon\n\nScheduled Task Run: \"%WINDIR%\\system32\\shutdown.exe /r /t 0 /f\"\n\nDescription: Forces a reboot\n\nService Name: cscc\n\nService Display Name: Windows Client Side Caching DDriver\n\nService Binary Path: cscc.dat\n\nEmbedded usernames from infpub.dat (1D724F95C61F1055F0D02C2154BBCCD3)\n\n\n-----\n\nAdministrator\n\nAdmin\nGuest\n\nUser\n\nUser1\n\nuser-1\nTest\nroot\n\nbuh\n\nboss\n\nftp\n\nrdp\n\nrdpuser\n\nrdpadmin\n\nmanager\n\nsupport\n\nwork\n\nother user\n\noperator\n\nbackup\n\nasus\n\nftpuser\n\nftpadmin\n\nnas\n\nnasuser\n\nnasadmin\n\nsuperuser\n\nnetguest\n\nalex\n\nEmbedded passwords from infpub.dat (1D724F95C61F1055F0D02C2154BBCCD3)\n\n\n-----\n\nAdministrator\n\nadministrator\n\nGuest\n\nguest\n\nUser\n\nuser\n\nAdmin\nadminTest\n\ntest\n\nroot\n\n123\n\n1234\n\n12345\n\n123456\n\n1234567\n\n12345678\n\n123456789\n\n1234567890\n\nAdministrator123\n\nadministrator123\n\nGuest123\n\nguest123\n\nUser123\n\nuser123\n\nAdmin123\n\nadmin123Test123\n\ntest123\n\npassword\n\n111111\n\n55555\n\n77777\n\n777\n\nqwe\nqwe123\n\nqwe321\n\nqwer\n\nqwert\n\nqwerty\n\nqwerty123\n\nzxc\n\nzxc123\n\nzxc321\n\nzxcv\n\nuiop\n\n123321\n\n321\n\nlove\nsecret\n\nsex\n\ngod\n\nEmbedded pipe names from infpub.dat (1D724F95C61F1055F0D02C2154BBCCD3)\n\natsvc\nbrowser\n\neventlog\n\nlsarpc\n\nnetlogon\n\nntsvcs\nspoolss\n\nsamr\n\nsrvsvc\n\nscerpc\n\nsvcctl\n\nwkssvc\n\n**Yara Rules**\n\nrule FE_Hunting_BADRABBIT {\n\nmeta:version=\".2\"\n\nfiletype=\"PE\"\n\nauthor=\"ian.ahl @TekDefense & nicholas.carr @itsreallynick\"\n\ndate=\"2017-10-24\"\n\nmd5 = \"b14d8faf7f0cbcfad051cefe5f39645f\"\n\nstrings:\n\n// Messages\n\n\n-----\n\ng p\n$msg2 = \"Oops! Your files have been encrypted.\" ascii wide\n$msg3 = \"If you see this text, your files are no longer accessible.\" ascii wide\n$msg4 = \"You might have been looking for a way to recover your files.\" ascii wide\n$msg5 = \"Don't waste your time. No one will be able to recover them without our\" ascii wide\n$msg6 = \"Visit our web service at\" ascii wide\n$msg7 = \"Your personal installation key#1:\" ascii wide\n$msg8 = \"Run DECRYPT app at your desktop after system boot\" ascii wide\n$msg9 = \"Password#1\" nocase ascii wide\n$msg10 = \"caforssztxqzf2nm.onion\" nocase ascii wide\n$msg11 = /partition (unbootable|not (found|mounted))/ nocase ascii wide\n\n// File references\n$fref1 = \"C:\\\\Windows\\\\cscc.dat\" nocase ascii wide\n$fref2 = \"\\\\\\\\.\\\\dcrypt\" nocase ascii wide\n$fref3 = \"Readme.txt\" ascii wide\n$fref4 = \"\\\\Desktop\\\\DECRYPT.lnk\" nocase ascii wide\n$fref5 = \"dispci.exe\" nocase ascii wide\n$fref6 = \"C:\\\\Windows\\\\infpub.dat\" nocase ascii wide\n// META\n$meta1 = \"http://diskcryptor.net/\" nocase ascii wide\n$meta2 = \"dispci.exe\" nocase ascii wide\n$meta3 = \"GrayWorm\" ascii wide\n$meta4 = \"viserion\" nocase ascii wide\n//commands\n$com1 = \"ComSpec\" ascii wide\n$com2 = \"\\\\cmd.exe\" nocase ascii wide\n$com3 = \"schtasks /Create\" nocase ascii wide\n$com4 = \"schtasks /Delete /F /TN %ws\" nocase ascii wide\ncondition:\n(uint16(0) == 0x5A4D)\nand\n(8 of ($msg*) and 3 of ($fref*) and 2 of ($com*))\nor\n(all of ($meta*) and 8 of ($msg*))\n}\n\nrule FE_Trojan_BADRABBIT_DROPPER\n{\nmeta:\nauthor = \"muhammad.umair\"\nmd5 = \"fbbdc39af1139aebba4da004475e8839\"\nrev = 1\nstrings:\n$api1 = \"GetSystemDirectoryW\" fullword\n$api2 = \"GetModuleFileNameW\" fullword\n$dropped_dll = \"infpub.dat\" ascii fullword wide\n$exec_fmt_str = \"%ws C:\\\\Windows\\\\%ws,#1 %ws\" ascii fullword wide\n$extract_seq = { 68 ?? ?? ?? ?? 8D 95 E4 F9 FF FF 52 FF 15 ?? ?? ?? ?? 85 C0 0F 84 C4 00 00 00 8D 85 A8 ED FF FF 50 8D 8D\nAC ED FF FF E8 ?? ?? ?? ?? 85 C0 0F 84 AA 00 00 00 }\ncondition:\n(uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and filesize < 500KB and all of them\n}\n\nrule FE_Worm_BADRABBIT\n{\nmeta:\nauthor = \"muhammad.umair\"\nmd5 = \"1d724f95c61f1055f0d02c2154bbccd3\"\nrev = 1\nstrings:\n$api1 = \"WNetAddConnection2W\" fullword\n$api2 = \"CredEnumerateW\" fullword\n$api3 = \"DuplicateTokenEx\" fullword\n$api4 = \"GetIpNetTable\"\n$del_tasks = \"schtasks /Delete /F /TN drogon\" ascii fullword wide\n$dropped_driver = \"cscc.dat\" ascii fullword wide\n$exec_fmt_str = \"%ws C:\\\\Windows\\\\%ws,#1 %ws\" ascii fullword wide\n$iter_encrypt = { 8D 44 24 3C 50 FF 15 ?? ?? ?? ?? 8D 4C 24 3C 8D 51 02 66 8B 31 83 C1 02 66 3B F7 75 F5 2B CA D1 F9 8D 4C\n4C 3C 3B C1 74 07 E8 ?? ?? ?? ?? }\n$share_fmt_str = \"\\\\\\\\%ws\\\\admin$\\\\%ws\" ascii fullword wide\ncondition:\n(uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and filesize < 500KB and all of them\n}\n\nrule FE_Trojan_BADRABBIT_MIMIKATZ\n{\nmeta:\n\nth \" h d i \"\n\n\n-----\n\nrev = 1\nstrings:\n$api1 = \"WriteProcessMemory\" fullword\n$api2 = \"SetSecurityDescriptorDacl\" fullword\n$api_str1 = \"BCryptDecrypt\" ascii fullword wide\n$mimi_str = \"CredentialKeys\" ascii fullword wide\n$wait_pipe_seq = { FF 15 ?? ?? ?? ?? 85 C0 74 63 55 BD B8 0B 00 00 57 57 6A 03 8D 44 24 1C 50 57 68 00 00 00 C0 FF 74 24 38\n4B FF 15 ?? ?? ?? ?? 8B F0 83 FE FF 75 3B }\ncondition:\n(uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and filesize < 500KB and all of them\n}\n\nrule FE_Trojan_BADRABBIT_DISKENCRYPTOR\n{\nmeta:\nauthor = \"muhammad.umair\"\nmd5 = \"b14d8faf7f0cbcfad051cefe5f39645f\"\nrev = 1\nstrings:\n$api1 = \"CryptAcquireContextW\" fullword\n$api2 = \"CryptEncrypt\" fullword\n$api3 = \"NetWkstaGetInfo\" fullword\n$decrypt_seq = { 89 5D EC 78 10 7F 07 3D 00 00 00 01 76 07 B8 00 00 00 01 EB 07 C7 45 EC 01 00 00 00 53 50 53 6A 04 53 8B\nF8 56 89 45 FC 89 7D E8 FF 15 ?? ?? ?? ?? 8B D8 85 DB 74 5F }\n$msg1 = \"Disk decryption progress...\" ascii fullword wide\n$task_fmt_str = \"schtasks /Create /SC ONCE /TN viserion_%u /RU SYSTEM /TR \\\"%ws\\\" /ST %02d:%02d:00\" ascii fullword wide\n$tok1 = \"\\\\\\\\.\\\\dcrypt\" ascii fullword wide\n$tok2 = \"C:\\\\Windows\\\\cscc.dat\" ascii fullword wide\ncondition:\n(uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and filesize < 150KB and all of them\n}\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2017/2017-10-26 - BACKSWING - Pulling a BADRABBIT Out of a Hat.pdf"
    ],
    "report_names": [
        "2017-10-26 - BACKSWING - Pulling a BADRABBIT Out of a Hat.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673535559,
    "ts_updated_at": 1743041131,
    "ts_creation_date": 1653786625,
    "ts_modification_date": 1653786625,
    "files": {
        "pdf": "https://archive.orkl.eu/4183d1b2edbd9d4a014f7947f71282507950dcdd.pdf",
        "text": "https://archive.orkl.eu/4183d1b2edbd9d4a014f7947f71282507950dcdd.txt",
        "img": "https://archive.orkl.eu/4183d1b2edbd9d4a014f7947f71282507950dcdd.jpg"
    }
}