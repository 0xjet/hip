{
    "id": "4e3631e4-182e-40c3-8d12-d13b79d87107",
    "created_at": "2023-01-12T15:00:08.261959Z",
    "updated_at": "2025-03-27T02:16:03.317262Z",
    "deleted_at": null,
    "sha1_hash": "4feee2e337632b06ebf1d966686932bce00d6b5d",
    "title": "2022-01-24 - Investigating APT36 or Earth Karkaddan’s Attack Chain and Malware Arsenal",
    "authors": "",
    "file_creation_date": "2022-05-28T16:01:49Z",
    "file_modification_date": "2022-05-28T16:01:49Z",
    "file_size": 7526817,
    "plain_text": "# Investigating APT36 or Earth Karkaddan’s Attack Chain and Malware Arsenal\n\n**[trendmicro.com/en_us/research/22/a/investigating-apt36-or-earth-karkaddans-attack-chain-and-malware.html](https://www.trendmicro.com/en_us/research/22/a/investigating-apt36-or-earth-karkaddans-attack-chain-and-malware.html)**\n\nJanuary 24, 2022\n\nAPT & Targeted Attacks\n\nWe investigated the most recent activities of APT36, also known as Earth Karkaddan, a\npolitically motivated advanced persistent threat (APT) group, and discuss its use of\nCapraRAT, an Android RAT with clear similarities in design to the group’s favored Windows\nmalware, Crimson RAT.\n\nBy: Trend Micro January 24, 2022 Read time: ( words)\n\nAPT36, also known as Earth Karkaddan, a politically motivated advanced persistent threat\n(APT) group, has historically targeted Indian military and diplomatic resources. This APT\n[group (also referred to as Operation C-Major, PROJECTM,](https://www.trendmicro.com/en_us/research/16/c/indian-military-personnel-targeted-by-information-theft-campaign.html) Mythic Leopard, and Transparent\nTribe) has been known to use social engineering and phishing lures as an entry point, after\nwhich, it deploys the Crimson RAT malware to steal information from its victims.\n\nIn late 2021, we saw the group leverage CapraRAT, an Android RAT with clear similarities in\ndesign to the group’s favored Windows malware, Crimson RAT. It is interesting to see the\ndegree of crossover in terms of function names, commands, and capabilities between the\n[tools, which we cover in more detail in our technical brief, “Earth Karkaddan APT.”](https://www.trendmicro.com/content/dam/trendmicro/global/en/research/22/a/investigating-apt36-or-earth-karkaddan-attack-chain-and-malware-arsenal/Earth%20Karkaddan%20Technical%20Brief.pdf)\n\nOur investigation is based on Trend Micro Smart Protection Network (SPN) data gathered\nfrom January 2020 to September 2021.\n\n## Looking into one of Earth Karkaddan’s recent campaigns\n\nTypically, Earth Karkaddan’s arrival methods include the use of spear-phishing emails and a\nUSB worm that would then drop and execute a remote access trojan (RAT).\n\n\n-----\n\nFigure 1. Earth Karkaddan’s attack chain\nThe malicious emails feature a variety of lures to deceive victims into downloading malware,\nincluding fraudulent government documents, honeytraps showing profiles of attractive\nwomen, and recently, coronavirus-themed information.\n\nFigure 2. An example of a fake\n\ngovernment-related spear-phishing email\n\n\n-----\n\nFigure 3. An example of a coronavirus-related spear-phishing email attachment\nOnce the victim downloads the malicious macro, it will decrypt an embedded executable\ndropper that is hidden inside a text box, which will then be saved to a hardcoded path prior to\nit executing in the machine.\n\n\n-----\n\nFigure 4. Malicious macro that decrypts an executable hidden inside a text box\n\n\n-----\n\nFigure 5. Examples of encrypted Crimson RAT executables hidden inside text boxes\nOnce the executable file is executed, it will proceed to unzip a file named mdkhm.zip and\nthen execute a Crimson RAT executable named dlrarhsiva.exe.\n\nFigure 6. The dlrarhsiva.exe Crimson RAT executable\n\n\n-----\n\nEarth Karkaddan actors are known to use the Crimson RAT malware in its campaigns to\ncommunicate with its command-and-control (C&C) server to download other malware or\nexfiltrate data.\n\nOur analysis shows that the Crimson RAT malware is compiled as a .NET binary with\nminimal obfuscation. This could indicate that the cybercriminal group behind this campaign is\npossibly not well-funded.\n\nFigure 7. A list of\n\nminimally obfuscated commands, function names, and variables from a Crimson RAT\nmalware sample\nCrimson RAT can steal credentials from browsers, collect antivirus information, capture\nscreenshots, and list victim drives, processes, and directories. We have observed how an\ninfected host communicates with a Crimson RAT C&C server to send exfiltrated information\nincluding PC name, operating system (OS) information, and the location of the Crimson RAT\nmalware inside the system.\n\nFigure 8. Network traffic from a Crimson\n\nRAT malware sample\n\n### ObliqueRat Malware Analysis\n\nAside from the Crimson RAT malware, the Earth Karkaddan APT group is also known to use\nthe [ObliqueRat malware in its campaigns.](https://blog.talosintelligence.com/2021/02/obliquerat-new-campaign.html)\n\nThis malware is also commonly distributed in spear-phishing campaigns using social\nengineering tactics to lure victims into downloading another malicious document. In one of its\nmost recent campaigns, the lure used was that of the Centre for Land Warfare Studies\n(CLAWS) in New Delhi, India.\n\n\n-----\n\nFigure 9. Initial spear-phishing\n\ndocument with a link to another malicious document\nOnce the victim clicks the link, it will download a document laced with a malicious macro.\nUpon enabling the macro, it will then download the ObliqueRat malware that is hidden inside\nan image file.\n\nFigure 10. The\n\ndownloaded \"1More-details.doc\" contains malicious macros that will download and execute\nthe ObliqueRat malware in a victim’s machine\nThe macros inside the file will then download a bitmap image (BMP) file where the\nObliqueRAT malware is hidden, decode the downloaded BMP file, then create a persistence\nmechanism by creating a Startup URL which will automatically run the ObliqueRAT malware.\n\n\n-----\n\nFigure 11. Malicious\n\nmacro codes will download, decode, and execute the ObliqueRat malware\nFigure 12 shows a summary of the ObliqueRat malware’s infection chain:\n\nFigure 12. ObliqueRat attack chain\nBelow is a list of backdoor commands that this particular ObliqueRAT malware variant can\nperform:\n\n\n-----\n\n**Command (v5.2)** **Info**\n\n**0** System information\n\n**1** List drive and drive type\n\n**3** Find certain files and file sizes\n\n**4** Send back zip files (specified filename)\n\n**4A/4E** Send back zip files\n\n**5** Find certain files and file sizes\n\n**6** Zip certain folder, send back to C&C, then delete it\n\n**7** Execute commands\n\n**8** Receive file from C&C\n\n**BACKED** Back up the file lgb\n\n**RNM** Rename file\n\n**TSK** List running processes\n\n**EXIT** Stop execution\n\n**RESTART** Restart connection to C&C\n\n**KILL** Kill certain processes\n\n**AUTO** Find certain files\n\n**RHT** Delete files\n\n\n-----\n\nNote that in this specific campaign, both the Crimson RAT malware downloader document\nand the ObliqueRat malware downloader share the same download domain, which is\nsharingmymedia[.]com. This indicates that both malware types were actively used in Earth\nKarkaddan APT campaigns.\n\nFigure 13. Crimson RAT\n\nand ObliqueRat spear-phishing email attachments that feature the same download domain\n\n### CapraRAT, One of Earth Karkaddan’s custom Android RAT\n\nAside from using spear-phishing emails and a USB worm as arrival vectors, Earth\nKarkaddan also uses Android RATs that could be deployed by means of malicious phishing\n[links. This is not particularly novel for the APT group — in 2018, it used StealthAgent](https://www.amnesty.org/en/documents/asa33/8366/2018/en/)\n(detected by Trend Micro as AndroidOS_SMongo.HRX), an Android spyware that can\nintercept phone calls and messages, track victims’ locations, and steal photos. In 2020,\n[Earth Karkaddan used an updated version of the AhMyth Android RAT to target Indian](https://securelist.com/transparent-tribe-part-2/98233/)\nmilitary and government personnel via a disguised porn app and a fraudulent national Covid19 tracking app.\n\nWe observed this group using another Android RAT — TrendMicro has named this\n“CapraRat”— which is possibly a modified version of an open-source RAT called AndroRAT.\nWhile analyzing this android RAT, we saw several similar capabilities to the CrimsonRat\nmalware that the group usually uses to infect Windows systems.\n\nWe have been observing CapraRAT samples since 2017, and one of the first samples we\nanalyzed (SHA-256:\nd9979a41027fe790399edebe5ef8765f61e1eb1a4ee1d11690b4c2a0aa38ae42, detected by\nTrend Micro as as AndroidOS_Androrat.HRXD) revealed some interesting things in that year:\nthey used \"com.example.appcode.appcode\" as the APK package name and used a possible\npublic certificate “74bd7b456d9e651fc84446f65041bef1207c408d,” which possibly meant the\nsample was used for testing, and they just started to use it for their campaigns during that\nyear.\n\n\n-----\n\nThe C&C domain android[.]viral91[.]xyz, where the malware was connecting to also shows\nthat it is very likely that the APT team uses subdomains to host or connect to Android\nmalware. In previous years, some CrimsonRAT samples were also found to be hosted on the\nviral91[.]xyz domain.\n\nFigure 14. CrimsonRAT malware hosted\n\nin viral91[.]xyz\n[We were also able to source a phishing document, “csd_car_price_list_2017,” that is related](https://www.hybrid-analysis.com/sample/16f3a362b75a93d1090a8ba8c78578766c3384ef976e980089add2c46a46a87f?environmentId=100)\nto this domain and has been seen in the wild in 2017. This file name is interesting as “csd” is\nlikely to be associated to \"Canteen Stores Department\" in Pakistan, which is operated by the\nPakistani Ministry of Defence. This is a possible lure for the Indian targets to open the\nmalicious attachment, also used in a similar attack in 2021.\n\nUpon downloading this malicious app that possibly arrived via a malicious link, the user will\nneed to grant permissions upon installation to allow the RAT access to stored information.\nThe malware can do the following on a compromised device:\n\nAccess the phone number\nLaunch other apps’ installation packages\nOpen the camera\nAccess the microphone and record audio clips\nAccess the unique identification number\nAccess location information\nAccess phone call history\nAccess contact information\n\nOnce the Android RAT is executed, it will attempt to establish a connection to its C&C server,\n209[.]127[.]19[.]241[:]10284. We have observed that the Remote Desktop Protocol (RDP)\ncertificate associated in this deployment, “WIN-P9NRMH5G6M8,” is a common string found\nin [previously identified Earth Karkaddan C&C servers.](https://team-cymru.com/blog/2021/07/02/transparent-tribe-apt-infrastructure-mapping-2/)\n\n\n-----\n\nFigure 15. Decompiled code from CapraRAT connecting to its C&C server\n\nFigure 16. CapraRAT config showing its C&C server and port information\n\n\n-----\n\nFigure 17. Backdoor commands found in CapraRAT\nThis APK file also has the ability to drop mp4 or APK files from asset directory.\n\n\n-----\n\nFigure 18. CapraRAT APK file drops\n\nan mp4 file\nThe RAT also has a persistence mechanism that always keeps the app active. It checks\nwhether the service is still running every minute, and if it is not, the service will be launched\nagain.\n\nFigure 19. CapraRAT’s\n\npersistence mechanism\n\n## Reducing risks: How to defend against APT attacks\n\nEarth Karkaddan has been stealing information since 2016 by means of creative social\nengineering lures and file-stealing malware. Users can adopt the following security best\npractices to thwart Earth Karkaddan attacks:\n\nBe careful of opening unsolicited and unexpected emails, especially those that call for\nurgency\nWatch out for malicious email red flags, which include atypical sender domains and\ngrammatical and spelling lapses\nAvoid clicking on links or downloading attachments in emails, especially from unknown\nsources\nBlock threats that arrive via email such as malicious links using hosted email security\nand antispam protection\nDownload apps only from trusted sources\nBe wary of the scope of app permissions\nGet multilayered mobile security solutions that can protect devices against online\nthreats, malicious applications, and even data loss\n\nThe following security solutions can also protect users from email-based attacks:\n\n**[Trend Micro™ Cloud App Security– Enhances the security of Microsoft Office 365](https://www.trendmicro.com/en_us/business/products/user-protection/sps/email-and-collaboration/cloud-app-security.html)**\nand other cloud services via computer vision and real-time scanning. It also protects\norganizations from email-based threats.\n\n\n-----\n\n**[Trend Micro™ Deep Discovery™ Email Inspector– Defends users through a](https://www.trendmicro.com/en_us/business/products/user-protection/sps/email-and-collaboration/email-inspector.html)**\ncombination of real-time scanning and advanced analysis techniques for known and\nunknown attacks.\n[Trend Micro™](https://www.trendmicro.com/us/enterprise/product-security/mobile-security/) [Mobile Security for Enterprise suite – Provides device, compliance and](https://www.trendmicro.com/us/enterprise/product-security/mobile-security/)\napplication management, data protection, and configuration provisioning, as well as\nprotects devices from attacks that exploit vulnerabilities, prevents unauthorized access\nto apps and detects and blocks malware and fraudulent websites.\n[Trend Micro’s Mobile App Reputation Service (MARS) – Covers Android and iOS](https://mars.trendmicro.com/)\n[threats using leading sandbox and machine learning technologies to protect users](https://www.trendmicro.com/vinfo/us/security/definition/machine-learning)\nagainst malware, zero-day and known exploits, privacy leaks, and application\nvulnerability.\n\n## Indicators of Compromise\n\n[A list of indicators can be found in this text file.](https://www.trendmicro.com/content/dam/trendmicro/global/en/research/22/a/investigating-apt36-or-earth-karkaddan-attack-chain-and-malware-arsenal/IoCs_Investigating%20APT36%20or%20Earth%20Karkaddan%20Attack%20Chain%20and%20Malware%20Arsenal.rtf)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-01-24 - Investigating APT36 or Earth Karkaddan’s Attack Chain and Malware Arsenal.pdf"
    ],
    "report_names": [
        "2022-01-24 - Investigating APT36 or Earth Karkaddan’s Attack Chain and Malware Arsenal.pdf"
    ],
    "threat_actors": [
        {
            "id": "fce5181c-7aab-400f-bd03-9db9e791da04",
            "created_at": "2022-10-25T15:50:23.759799Z",
            "updated_at": "2025-03-27T02:00:55.540135Z",
            "deleted_at": null,
            "main_name": "Transparent Tribe",
            "aliases": [
                "Transparent Tribe",
                "COPPER FIELDSTONE",
                "APT36",
                "Mythic Leopard",
                "ProjectM"
            ],
            "source_name": "MITRE:Transparent Tribe",
            "tools": [
                "DarkComet",
                "ObliqueRAT",
                "njRAT",
                "Peppy"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "c68fa27f-e8d9-4932-856b-467ccfe39997",
            "created_at": "2023-01-06T13:46:38.450585Z",
            "updated_at": "2025-03-27T02:00:02.836543Z",
            "deleted_at": null,
            "main_name": "Operation C-Major",
            "aliases": [
                "C-Major",
                "Transparent Tribe",
                "Mythic Leopard",
                "ProjectM",
                "APT 36",
                "TMP.Lapis",
                "Green Havildar",
                "COPPER FIELDSTONE",
                "APT36",
                "Earth Karkaddan",
                "Storm-0156"
            ],
            "source_name": "MISPGALAXY:Operation C-Major",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "66fc98f4-8978-401e-9b73-81c3d5f1e44c",
            "created_at": "2024-05-01T02:03:08.050109Z",
            "updated_at": "2025-03-27T02:05:17.327953Z",
            "deleted_at": null,
            "main_name": "COPPER FIELDSTONE",
            "aliases": [
                "Gorgon Group",
                "Green Havildar ",
                "Mythic Leopard ",
                "Operation C-Major ",
                "Operation Transparent Tribe ",
                "Pasty Draco ",
                "ProjectM ",
                "Storm-0156 ",
                "APT36 "
            ],
            "source_name": "Secureworks:COPPER FIELDSTONE",
            "tools": [
                " DarkComet",
                " LuminosityLink",
                " Peppy",
                " njRAT",
                "Crimson RAT"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "abb24b7b-6baa-4070-9a2b-aa59091097d1",
            "created_at": "2022-10-25T16:07:24.339942Z",
            "updated_at": "2025-03-27T02:02:10.179404Z",
            "deleted_at": null,
            "main_name": "Transparent Tribe",
            "aliases": [
                "APT 36",
                "APT-C-56",
                "Copper Fieldstone",
                "Earth Karkaddan",
                "Green Havildar",
                "Mythic Leopard",
                "Operation C-Major",
                "Operation Honey Trap",
                "Operation Transparent Tribe",
                "ProjectM",
                "STEPPY-KAVACH",
                "Storm-0156",
                "TEMP.Lapis",
                "Transparent Tribe"
            ],
            "source_name": "ETDA:Transparent Tribe",
            "tools": [
                "Amphibeon",
                "Android RAT",
                "Bezigate",
                "Bladabindi",
                "Bozok",
                "Bozok RAT",
                "BreachRAT",
                "Breut",
                "CapraRAT",
                "CinaRAT",
                "Crimson RAT",
                "DarkComet",
                "DarkKomet",
                "ElizaRAT",
                "FYNLOS",
                "Fynloski",
                "Jorik",
                "Krademok",
                "Limepad",
                "Luminosity RAT",
                "LuminosityLink",
                "MSIL",
                "MSIL/Crimson",
                "Mobzsar",
                "MumbaiDown",
                "Oblique RAT",
                "ObliqueRAT",
                "Peppy RAT",
                "Peppy Trojan",
                "Quasar RAT",
                "QuasarRAT",
                "SEEDOOR",
                "Scarimson",
                "SilentCMD",
                "Stealth Mango",
                "UPDATESEE",
                "USBWorm",
                "Waizsar RAT",
                "Yggdrasil",
                "beendoor",
                "klovbot",
                "njRAT"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535608,
    "ts_updated_at": 1743041763,
    "ts_creation_date": 1653753709,
    "ts_modification_date": 1653753709,
    "files": {
        "pdf": "https://archive.orkl.eu/4feee2e337632b06ebf1d966686932bce00d6b5d.pdf",
        "text": "https://archive.orkl.eu/4feee2e337632b06ebf1d966686932bce00d6b5d.txt",
        "img": "https://archive.orkl.eu/4feee2e337632b06ebf1d966686932bce00d6b5d.jpg"
    }
}