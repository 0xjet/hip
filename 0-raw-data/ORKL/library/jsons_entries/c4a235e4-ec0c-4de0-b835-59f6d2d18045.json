{
    "id": "c4a235e4-ec0c-4de0-b835-59f6d2d18045",
    "created_at": "2023-02-02T02:08:56.353709Z",
    "updated_at": "2025-03-27T02:09:18.255056Z",
    "deleted_at": null,
    "sha1_hash": "a2540a23ce199a8f673d5024a27196ab7c3c65d9",
    "title": "2022-04-15 - Revisiting BatLoader C2 structure",
    "authors": "",
    "file_creation_date": "2023-02-01T07:55:44Z",
    "file_modification_date": "2023-02-01T07:55:44Z",
    "file_size": 243445,
    "plain_text": "# Revisiting BatLoader C2 structure\n\n**[medium.com/walmartglobaltech/revisiting-batloader-c2-structure-52f46ff9893a](https://medium.com/walmartglobaltech/revisiting-batloader-c2-structure-52f46ff9893a)**\n\nJason Reaves April 15, 2022\n\n[Jason Reaves](https://medium.com/@jason.reaves?source=post_page-----52f46ff9893a--------------------------------)\n\nApr 15, 2022\n\n\n2 min read\n\nBy: Jason Reaves and Joshua Platt\n\nBatLoader, named by Mandiant[7], is an interesting distribution/loading system that has been\ndiscussed previously[1,2] and leveraged by various actors. Recent media headlines show\nthe connection to Zloader[3] after a disruption was done by multiple organizations[4] but this\nis not a Zloader exclusive service.\n\nReports of the disruption included brief mentions of BatLoader in their reporting. We assume\nthat was not the target of their recent disruption campaign because the service is still\nfunctioning. While looking into new BatLoader campaigns, we noticed they changed the C2\nstructure of the loading process since our last blog[1]:\n\n\n-----\n\nRef: Virustotal.com\nThe structure looks similar to what we reported previously, but some of the data now looks\nlike a hash value.\n\nPreviously:\n```\n/processingSetRequestBat1/?servername=/processingSetRequestBat2/?\nservername=/processingSetRequestBat3/?servername=/processingSetRequestBat4/?\nservername=/processingSetRequestBat5/?servername=/processingSetRequestBat6/?\nservername=/processingSetRequestBot/?servername=/processingSetRequestCoba/?\nservername=/processingSetRequestDownload/?servername=/processingSetRequestAtera/?\nservername=\n\n```\nSo these hash values aren’t just the hash of the processing strings right?\n```\n>>>\nhashlib.md5('processingSetRequestBat1').hexdigest()'e6a5614c379561c94004c531781ee1c5'\n\n```\nAh, so they are. Then we can create new suricata rules based on the new patterns.\nHowever, I noticed if the hash starts with a number then the developer changes it to a\ncharacter, for example:\n```\n>>>\nhashlib.md5('processingSetRequestBat3').hexdigest()'73874ddb552a5b45cade5a2700d15587'\n\n```\nThe hash used in traffic patterns however is:\n```\na3874ddb552a5b45cade5a2700d15587\n\n```\nGoing by the other Bat requests it appears they are going in order; a,b,c,d… So we can\ncontinue mapping hash values to new request structure:\n```\n/e6a5614c379561c94004c531781ee1c5/?servername=/f69af5bc8498d0ebeb37b801d450c046/?\nservername=/a3874ddb552a5b45cade5a2700d15587/?\nservername=/fa777fbbb8f055cb8bfcba6cb41c62e7/?\nservername=/b1eeec75ef1488e2484b14c8fd46ddce/?\nservername=/c003996958c731652178c7113ad768b7/?\nservername=/d2ef590c0310838490561a205469713d/?\nservername=/fa0a24aafe050500595b1df4153a17fb/?\nservername=/i850c923db452d4556a2c46125e7b6f2/?\nservername=/b5e6ec2584da24e2401f9bc14a08dedf/?\nservername=/e747834ae24a1a43e044ea7b070048f0/?servername=\n\n```\nWith the addition of deploying a stealer this maps like:\n\nMost of the reporting has also shown that the templating for the msi installers has been\nZoom and Teamviewer based fake installers, however as we have previously mentioned\nthere are many affiliates involved in this service. A more exhaustive list of fake software\ntemplates for the initial MSI files can be found below:\n\n\n-----\n\n```\nzoomteamviewerAnyDeskTelegramyoutubecheatsccleanerdiscordthunderbirdluminaradobe\nreaderchromefirefoxbravegeminigrammarlyquickenrobinhoodamazonsmbcfidelitylogmein\n\n```\n**References:**\n\n1: [https://medium.com/walmartglobaltech/signed-dll-campaigns-as-a-service-7760ac676489](https://medium.com/walmartglobaltech/signed-dll-campaigns-as-a-service-7760ac676489)\n\n2: https://news.sophos.com/en-us/2022/01/19/zloader-installs-remote-access-backdoorsand-delivers-cobalt-strike/\n\n3: https://www.microsoft.com/security/blog/2022/04/13/dismantling-zloader-how-maliciousads-led-to-disabled-security-tools-and-ransomware/\n\n4: https://blogs.microsoft.com/on-the-issues/2022/04/13/zloader-botnet-disrupted-malwareukraine/\n\n5: https://www.welivesecurity.com/2022/04/13/eset-takes-part-global-operation-disruptzloader-botnets/\n\n6: [https://decoded.avast.io/vladimirmartyanov/zloader-the-silent-night/](https://decoded.avast.io/vladimirmartyanov/zloader-the-silent-night/)\n\n7: [https://www.mandiant.com/resources/seo-poisoning-batloader-atera](https://www.mandiant.com/resources/seo-poisoning-batloader-atera)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-04-15 - Revisiting BatLoader C2 structure.pdf"
    ],
    "report_names": [
        "2022-04-15 - Revisiting BatLoader C2 structure.pdf"
    ],
    "threat_actors": [
        {
            "id": "610a7295-3139-4f34-8cec-b3da40add480",
            "created_at": "2023-01-06T13:46:38.608142Z",
            "updated_at": "2025-03-27T02:00:02.87217Z",
            "deleted_at": null,
            "main_name": "Cobalt",
            "aliases": [
                "Cobalt Gang",
                "GOLD KINGSWOOD",
                "COBALT SPIDER",
                "G0080",
                "Mule Libra",
                "Cobalt Group"
            ],
            "source_name": "MISPGALAXY:Cobalt",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1675303736,
    "ts_updated_at": 1743041358,
    "ts_creation_date": 1675238144,
    "ts_modification_date": 1675238144,
    "files": {
        "pdf": "https://archive.orkl.eu/a2540a23ce199a8f673d5024a27196ab7c3c65d9.pdf",
        "text": "https://archive.orkl.eu/a2540a23ce199a8f673d5024a27196ab7c3c65d9.txt",
        "img": "https://archive.orkl.eu/a2540a23ce199a8f673d5024a27196ab7c3c65d9.jpg"
    }
}