{
    "id": "cfd03a12-7f5e-4d93-941e-f4a69568ef61",
    "created_at": "2023-01-12T15:03:54.242214Z",
    "updated_at": "2025-03-27T02:05:18.719377Z",
    "deleted_at": null,
    "sha1_hash": "2802d556d6ca89c7aaf4a159a33efda776f94821",
    "title": "2022-03-07 - Distribution of Remcos RAT Disguised as Tax Invoice",
    "authors": "",
    "file_creation_date": "2022-05-27T20:56:07Z",
    "file_modification_date": "2022-05-27T20:56:07Z",
    "file_size": 623409,
    "plain_text": "# Distribution of Remcos RAT Disguised as Tax Invoice\n\n**asec.ahnlab.com/en/32376/**\n\nMarch 7, 2022\n\nThe ASEC analysis team has discovered Remcos RAT being distributed under the disguise\nof a tax invoice. The content and the type of phishing email are similar to the type that has\nbeen consistently discussed in previous blogs. Within the email, it has a short message\nwritten in awkward grammar. As users who are doing tax-related work may run the\nexecutable without a second thought about what’s written within the email, caution is\nadvised.\n\n\n-----\n\nFigure 1. Phishing email attached with malware disguised as a tax invoice\n\nFigure 2. Attachment\n\n\n-----\n\nUpon decompressing the attachment Tax.gz, an executable named Tax.com is shown to\nexist, and code below is shown when debugged. If the execution environment is a 64-bit\nenvironment, it downloads and executes the malware\n(1df2bf9313decafd0249d6a4556010bc) that is appropriate for the environment from\n‘hxxp://zhost.polycomusa[.]com/Chrimaz.exe’, and if not a 64-bit environment, it downloads a\npowershell file named ‘3xp1r3Exp.ps1’ and performs additional malicious behaviors.\n\nFigure 3. Code shown upon debugging the file\nThe powershell script (see Figure 4) consists of content that downloads an additional file\n(version.dll) for UAC Bypass. UAC Bypass is a privilege escalation technique that uses\nvarious tricks to execute malware as administrator without UAC prompt pop-up. Detailed\nanalysis on UAC Bypass can be found in AhnLab’s TI report published last year in July, and\nthe following is an excerpt from the report.\n\n**Excerpt from ATIP – Analysis Report on Privilege Escalation Using UAC Bypass**\n**‘Abstract’**\n\nThere are features among the behaviors of malware that do not require admin\nprivilege, however, if the admin privilege does exist, it can perform more malicious\nbehaviors. Simply put, depending on the privilege, the encryption target paths of\nransomware (files that can be encrypted) differ. Because of this, malware aims to be\nexecuted with admin privilege, but when configured to do so, the UAC prompt pops up,\nwhich could allow the user to recognize it.\n\nAttackers have created various techniques to bypass UAC since its introduction and\nthese techniques are referred to as UAC Bypass.\n\n\n-----\n\n**Excerpt from ATIP – Analysis Report on Privilege Escalation Using UAC Bypass**\n**‘Basic Concept’**\n\nProcesses such as sysprep.exe, cliconfg.exe are examples of autoElevate programs,\nand programs with such property are automatically executed with admin privilege\nwithout the UAC prompt. Most UAC Bypass techniques abuse these kinds of\nautoElevate programs. For example. attackers can change the settings of the registry\nthat is used by such programs and execute it as a child process or use the DLL\nhijacking method to make the programs load the malicious DLL.\n\nFigure 4. Powershell script downloaded from an external URL\nAmong the various UAC Bypass techniques, the powershell script above creates a trick\nfolder (Mock Directory) and uses the DLL hijacking method. For a more detailed explanation\nabout this method, upon looking at line 15 of the powershell script (see Figure 4), a\npowershell command that creates a certain path is found as shown below.\n\nNew-Item “\\?\\C:\\Windows \\System32” -ItemType Directory\n\nThe meaning of ‘Mock (fake) Directory’ that refers to a trick folder is as follows: Although the\ncommand appears to be a command that creates a System32 folder in the C drive Windows\nsubfolder, upon a close look, it is not the ‘Windows’ folder but ‘Windows folder ‘ with a\nwhitespace at the end. It is impossible to create a folder with a whitespace at the back in its\nfilename via Windows UI Explorer, and it is also not possible to create ‘C:\\Windows ‘ via\ncommand. However, the attacker used the fact that creating ‘C:\\Windows \\System32’ with an\nexisting subdirectory is possible via command.\n\n\n-----\n\nFigure 5. Testing trick folder creation via powershell command (Windows 10)\nOne of the conditions that determine whether or not privilege escalation is needed upon file\nexecution is checking if it was executed in a trusted folder (E.g. C:\\Windows\\System32). This\nis a method that abuses the fact that the directory validation logic that judges the conditions\nfor automatic privilege escalation (autoElevate) scans “\\System32” first, in which it\nautomatically deletes the whitespace if there is one at the end of a filename in the processing\nprocedure via GetLongPathNameW API of AIS(Application Information Service: AppInfo.dll).\nOn the contrary, if the attacker can bypass this condition, it means that they can escalate\ntheir privilege without asking the user and execute the file.\n\nThe relevant operation method of WastedLocker ransomware was introduced in detail in the\nblog post below. [2. If not executed as administrator, performs UAC Bypass (*Privilege\nescalation mechanism)]\n\n[[Caution] Distribution of WastedLocker Ransomware Targeting Specific Companies](https://asec.ahnlab.com/en/17493/)\n\nUpon checking from line 17 of the powershell script, it shows that it copies winsat.exe within\nthe normal System32 folder into the fake System32 folder, then executes the winsat.exe file\n\n\n-----\n\nvia hidden window property in the copied directory. As the winsat.exe (Windows System\nAssessment Tool) is one of the AIS Whitelist files, the UAC prompt does not pop up when it\nis executed, which is a reason why it is often used in UAC Bypass techniques.\n\nAs a result, the whitespace at the back of the Windows filename in the directory (C:\\Windows\n\\System32) is deleted and is thus considered as a trusted directory. With the trick folder\nchanged to a trusted directory, the DLL hijacking method where a normal program loads a\nmalicious DLL (version.dll) can be used.\n\nAdditional malicious behaviors cannot be confirmed as access to the transit point is currently\nunavailable, however, when version.dll was loaded and executed when access was still\navailable, ‘Chrimaz.exe’ file execution command of the directory that refers to\n‘C:\\ProgramData\\Chrimaz\\Chrimaz.exe’ was found (see below). Upon analyzing the relevant\nfile via AhnLab and external infrastructure, it was confirmed that this file is Remcos RAT.\n\npowershell.exe -windowstyle hidden -NoProfile -ExecutionPolicy bypass -Command\n$mydir = [System.Environment]::GetFolderPath(‘CommonApplicationData’);\n$bitdir = ‘\\Chrimaz’;\n$fulldir = $mydir+$bitdir; Add-MpPreference -ExclusionPath $fulldir;\n\nUpon checking related files via AhnLab’s infrastructure, it was found that around February\n24th, a similar powershell script and files similar to version.dll were distributed via various\nexternal URLs. It is worth noting that there are more and more distribution methods that go\nthrough various steps with the purpose of UAC Bypass.\n\nUAC Bypass is a typical method used to escalate privilege, and malware attempts at\nprivilege escalation with various purposes. Users must patch their Windows OS to the latest\nversion to prevent UAC Bypass attacks. At the basic level, users should refrain from opening\nattachments in emails from unknown sources and update the anti-malware program to the\nlatest version to prevent malware infection in advance.\n\nAhnLab’s anti-malware software, V3, detects and blocks the malware above using the\naliases below.\n\n**[File Detection]**\nTrojan/Win.MSIL.R472890\nTrojan/Win.BitMin.C4970105\nDownloader/PowerShell.Generic\nTrojan/Win.UACByPass.C4970059\nTrojan/Win.RemcosRAT.R475423\n\n**[IOC]**\n98cf9ab79e33c04a4934628f6aa3161d\n1df2bf9313decafd0249d6a4556010bc\n9cdcaa1c51bfa4ce6d6abb9376ba26a8\n\n\n-----\n\na0f177bfd53ee82d20233bd362fdf024\n150744df32e4a57bb169f91cba45697c\n824a79fc5bebeb7b508247619eca82cd\nhxxp://zhost.polycomusa[.]com\nhxxp://giraffebear.polycomusa[.]com\n\n**Subscribe to AhnLab’s next-generation threat intelligence platform ‘AhnLab TIP’ to**\n**check related IOC and detailed analysis information.**\n\n[Categories:Malware Information](https://asec.ahnlab.com/en/category/malware-information/)\n\n[Tagged as:DLLHijacking,](https://asec.ahnlab.com/tag/dllhijacking/) [malware,](https://asec.ahnlab.com/en/tag/malware-en/) [Phishing email,](https://asec.ahnlab.com/tag/phishing-email/) [UAC Bypass,](https://asec.ahnlab.com/tag/uac-bypass/) [Vulnerability](https://asec.ahnlab.com/en/tag/vulnerability-en/)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-03-07 - Distribution of Remcos RAT Disguised as Tax Invoice.pdf"
    ],
    "report_names": [
        "2022-03-07 - Distribution of Remcos RAT Disguised as Tax Invoice.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673535834,
    "ts_updated_at": 1743041118,
    "ts_creation_date": 1653684967,
    "ts_modification_date": 1653684967,
    "files": {
        "pdf": "https://archive.orkl.eu/2802d556d6ca89c7aaf4a159a33efda776f94821.pdf",
        "text": "https://archive.orkl.eu/2802d556d6ca89c7aaf4a159a33efda776f94821.txt",
        "img": "https://archive.orkl.eu/2802d556d6ca89c7aaf4a159a33efda776f94821.jpg"
    }
}