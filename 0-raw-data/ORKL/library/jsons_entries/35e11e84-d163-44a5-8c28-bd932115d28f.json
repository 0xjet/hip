{
    "id": "35e11e84-d163-44a5-8c28-bd932115d28f",
    "created_at": "2023-01-12T15:09:37.958822Z",
    "updated_at": "2025-03-27T02:05:32.572037Z",
    "deleted_at": null,
    "sha1_hash": "695f03ed46aadea09cda0851b2cb021c6fb9d07f",
    "title": "2021-07-01 - TrickBot and Zeus",
    "authors": "",
    "file_creation_date": "2022-05-28T23:12:42Z",
    "file_modification_date": "2022-05-28T23:12:42Z",
    "file_size": 109605,
    "plain_text": "# TrickBot and Zeus - Kryptos Logic\n\n**kryptoslogic.com/blog/2021/07/trickbot-and-zeus/**\n\n## TrickBot and Zeus\n\n[Authored by: Kryptos Logic Vantage Team on Thursday, July 1, 2021](https://twitter.com/kryptoslogic)\n\nTags: [TrickBot](https://www.kryptoslogic.com/blog/tag/trickbot)\n\n## Overview\n\nTrickBot is an established and widespread multi-purpose trojan. Active since 2016 and modular in nature,\nit can accomplish a variety of goals ranging from credential theft to lateral movement. Many of the\nmalware’s capabilities come as self-contained modules, which the malware is instructed to download\nfrom the C2. Initially, TrickBot’s main focus was bank fraud, but this later shifted toward corporate\ntargetted ransomware attacks, eventually resulting in the discontinuation of their fraud operation.\n\nIn June 2021, Kryptos Logic Threat Intelligence team began observing new developments to the TrickBot\nwebinject module. TrickBot’s webinject module supports both static and dynamic configuration for injects.\nThe static inject type causes the victim to be redirected to an attacker-controlled replica of the intended\ndestination site, where credentials can then be harvested. The dynamic inject type transparently forwards\nthe server response to the TrickBot C2, where the source is then modified to contain malicious\ncomponents, before being returned to the victim as though it came from the legitimate site. In the current\niteration of the webinject module, injects are achieved by proxying traffic through a local SOCKS server, if\nthe traffic matches a list of target URLs the traffic is modified accordingly.\n\n\n-----\n\nThrough our monitoring, we were able to obtain a debug version of the module, which contained new\nfeatures being tested. In this evolution of their webinject capabilities, TrickBot has added support for\nZeus-style webinject configs. During development the module was served under a test name and\nsupported parsing configs named `zeus . We have since observed the updated module being pushed out`\nto real victims under the name `injectDll, superseding their old webinject module. Previously,`\nwebinject configs were stored in two files named `sinj (static injects) and` `dinj (dynamic injects).`\nNow, there exists a single config file named `winj containing Zeus-style webinjects.`\n\n## InjectDLL\n\nWe began observing new changes to their webinject module when we came across a debug build\nuploaded to 1VirusTotal. This module was different from the previous known webinjects, since it makes\nreference to a config by the name of `winj .`\n\nHowever, we were not able to pull down such a debug build from the C2 servers, since we were not\naware of the base name that was given to the module. Base names are the names given to modules by\nTrickBot, and are used by the main bot to fetch these modules from TrickBot’s plugin servers.\n\nCurrently we are seeing the bot pull down the released versions of webinject module as `injectDll32`\nand `injectDll64 for the 32-bit and 64-bit module respectively.`\n\nAn example for a module request made by the main bot is as follows:\n\n```\nhttps://<c2_address>/<gtag>/<unique_bot_id>/5/injectDll64/\n\n```\n\nIn this blog we will not go into detail on how the main bot communicates to its C2, since it has already\nbeen covered .2\n\n## winj Config\n\nIn this module we see the introduction of Zeus webinject configs, in addition to the regular webinject\nconfigs that TrickBot previously used. A good description on how the webinject config works can be found\nin its leaked manual .3\n\n\nDue to Zeus having been the gold standard for banking malware, Zeus-style webinjects are extremely\npopular. It is not uncommon for other malware families to support Zeus-style webinject syntax for crosscompatibility ( Z4 loader, C5 itadel, to name a few).\n\nIn the debug version, the module referred to this new config simply as `zeus ; however in the release`\nversion this has been renamed to `winj . As with the previous webinjects, the module is able to parse`\nthe usual webinject configs `dinj and` `sinj . Additionally, they continue to use the` `dpost configs in`\norder to send the results of the webjects to the handler C2s.\n\nExample `winj :`\n\n\n-----\n\n```\nset_url target website url GP\ndata_before\ndata_end\ndata_after\n</head>\ndata_end\ndata_inject\n<script></script>\ndata_end\n\n## MitM\n\n```\nAs previously reported,6 the module shares substantial code with IcedID/Bokbot’s Man-in-the-Browser\nwebinject module. To MitM TLS connections, it creates a self-signed TLS certificate and adds it to the\ncertificate store. The module contains a packed payload that is injected into the victim’s browser, where it\nhooks socket APIs to redirect traffic to a locally listening SOCKS proxy, it also hooks\n```\nCertVerifyCertificateChainPolicy and CertGetCertificateChain to ensure no certificate\n\n```\nerrors are shown to the victim.\n\n## Conclusion\n\nThe resumption of development of the webinject module indicates that TrickBot intends to revive its bank\nfraud operation, which appears to have been shelved for over a year. The addition of Zeus-style\nwebinjects may suggest expansion of their Malware-as-a-Service platform, enabling users to bring their\nown webinjects.\n\n## IOCs\n\n\n**SHA256**\n\n\n**Module**\n**Base**\n**Name** **Description**\n\n\ndd268740958fe3829c927054b900f6287235662cd93c1e91d51c38c44eb2571b n/a 32-bit\nWebinject\nDebug\nModule\n\n3bd5117466a9bcd539a482343957f8c9a74ad2fa0d5da959fcfa0d42beb9133d n/a 64-bit\nWebinject\nDebug\nModule\n\nc79f016996b45cd7cc88aa3ce6c4d1ab247a1d803de4b742f64f3bf1e183ffb0 injectDll32 32-bit\nWebinject\nModule\n\n19f4f1ca50b3306c9d953e12e573b1e65670b110b358d0240e55331c7ed0d76f injectDll64 64-bit\nWebinject\nModule\n\n## YARA\n\n\n-----\n\n```\nrule TrickBot__Webinject\n{\n  meta:\n    id = \"7eKHCSumVp7QRXF0z7BC1i\"\n    fingerprint = \"8a66f290d84a54e8ee148c461513627e83b8f092acebe8251c6098a88d8c4eba\"\n    version = \"1.0\"\n    first_imported = \"2021-07-01\"\n    last_modified = \"2021-07-01\"\n    status = \"RELEASED\"\n    sharing = \"TLP:WHITE\"\n    source = \"KRYPTOS LOGIC\"\n    author = \"KRYPTOS LOGIC\"\n    description = \"Detects TrickBot updated Webinject module\"\n    category = \"MALWARE\"\n    malware = \"BOT\"\n    hash = \"c79f016996b45cd7cc88aa3ce6c4d1ab247a1d803de4b742f64f3bf1e183ffb0\"\n  strings:\n    $a = \"c:\\\\developer\\\\webinject\\\\http-lib\\\\parser.c\" wide\n    $zeus1 = \"data_before\"\n    $zeus2 = \"data_after\"\n    $zeus3 = \"data_inject\"\n    $zeus4 = \"data_end\"\n    $name = /wbi-x(86|64).dll/\n  condition:\n    all of them\n}\n\n## References\n\n```\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-07-01 - TrickBot and Zeus.pdf"
    ],
    "report_names": [
        "2021-07-01 - TrickBot and Zeus.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673536177,
    "ts_updated_at": 1743041132,
    "ts_creation_date": 1653779562,
    "ts_modification_date": 1653779562,
    "files": {
        "pdf": "https://archive.orkl.eu/695f03ed46aadea09cda0851b2cb021c6fb9d07f.pdf",
        "text": "https://archive.orkl.eu/695f03ed46aadea09cda0851b2cb021c6fb9d07f.txt",
        "img": "https://archive.orkl.eu/695f03ed46aadea09cda0851b2cb021c6fb9d07f.jpg"
    }
}