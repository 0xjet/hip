{
    "id": "62cf907e-0582-4cc2-b4d3-1f5738ae293b",
    "created_at": "2022-10-25T16:48:15.732532Z",
    "updated_at": "2025-03-27T02:05:50.476416Z",
    "deleted_at": null,
    "sha1_hash": "fefd7ff6b2b254bd2e05784b51758c5d90acc06f",
    "title": "Vulnerability, Malicious Code Appeared In The Mbr Destruction Function Using Hangul File",
    "authors": "AhnLab",
    "file_creation_date": "2014-12-24T15:58:28Z",
    "file_modification_date": "2014-12-24T15:58:28Z",
    "file_size": 562536,
    "plain_text": "# function using Hangul file\n\n## Malware Information 2014/12/10 18:12\n\n Vulnerabilities recently received a file with the destruction and MBR destruction capabilities for major extension to the existing file in addition to the backdoor functionality that existed in Hangul document file is received attention is required.\n\n December 9, 2014 received the first vulnerability Hangul document files were used for both groups known vulnerabilities, patching does not work on the latest products. Total of 9 document file has been received, and all of the same malicious file therein.\n\n 1. The files and services that generate\n\n % System% registered the generated DLL as a service to the folder / drive upon, information that is used has a list on the inside of malicious code, and select one of the items below at random.\n\n [Service name]\n\n - BitLocker Drive Decryption Service\n - Internet Connection Service\n - Media Center Service\n - Network Storage Service\n - Peer Networking Address\n - PNRP Machine Name\n - Power Policy\n - Program Compatibility Service\n - Remote Registry Configuration\n - Smart Card Management Service\n - Tablet PC Management Service\n - Task Schedule Manager\n - Thread Ordering Service\n - WebClient Manage Service\n - Windows Color Adjustment\n - Windows Modules Management\n - Windows Time Synchronization\n - Wired Config Service\n - WLAN Config Service\n - Workstation Management\n\n [Create file]\n\n - Bddsvc.dll\n\n\n-----\n\n## - netstsvc.dll\n - pnas.dll\n - pnrpmchname.dll\n - pwpsvc.dll\n - pcssvc.dll\n - rregconf.dll\n - scardmngsvc.dll\n - tcpmsvc.dll\n - tschmng.dll\n - mmthread .dll\n - wcmngsvc.dll\n - coladj.dll\n - wndmodmng.dll\n - timesyncsvc.dll\n - wiredconfsvc.dll\n - wlanconf.dll\n - wstmng.dll\n\n Service Description\n\n - BDESVC hosts the BitLocker Drive Decryption service.\n - Provides network address Translation, Addressing, name resolution and / or Intrusion Prevention Services for a home or Small Office network.\n - Allows Media Center to Locate and Connect to the Computer.\n - This service Delivers network Notifications (E.\n - Enables Multi-party using Peer-to-Peer Communication Connecting.\n - This service publishes a machine name using the Peer Name Resolution Protocol.\n - MANAGES power policy and power policy Delivery Notification.\n - This service Provides Support for the Program Compatibility Assistant (PCA).\n - Enables remote users to modify Registry configurations on this Computer.\n - Access to Smart Cards MANAGES read by this Computer.\n - Enables Tablet PC Ink PEN and functionality\n - Enables a user to Configure and Schedule Automated tasks on this Computer.\n - Provides Execution ordered for a Group of threads within a specific period of time.\n - Enables Windows-based Programs to create, Access, and modify Internet- Files based.\n - The service hosts third-party WcasPlugInService Windows Color System color and gamut map Device Model Model Plug-in modules.\n - Enables Installation, modification, and Removal of Windows updates and Optional Components.\n - Maintains date and time Synchronization on all clients and Servers in the network.\n - The Wired AutoConfig (dot3svc) service is responsible for Performing IEEE 802.1X\n - The WLANSVC service Logic Provides the Required to Configure, Discover, Connect to, and disconnect from a Wireless local Area network.\n - Creates and maintains client network connections to remote server using the SMB protocol\n\n 2. MBR destruction time\n\n\n-----\n\n## if the destructive behavior than the largest value) is set to '0' value at the time of initial infection. The following [Figure 1] shows the contents of the registry key 'PcaSvcc' items registered by the malware. MBR destruction operations to determine the value of number entry through the time information of the user's system after December 10, 2014 11:00 a.m. when a, is set to non-zero value is, the MBR is destroyed feature to work .\n\n Figure -1] MBR destruction upon reference to the registry value\n\n In [Figure 2] shows a code section that compares the time information for determining a destruction inside MBR infection. Malicious code stored in the internal \"0x780D0C33\" value and the operation to compare the time information through a specific operation of the system time obtained by the GetLocalTime function call can be seen that true.\n\n\n-----\n\n## Figure -2] MBR destruction timecode to compare\n\n 3. MBR destruction techniques\n\n MBR destruction is overwritten for the 0x200 (512 bytes), it can be seen the data filled in as shown in [Figure 3] below. Infection, 'A' ~ 'Z', the same process is repeated for all the drives.\n\n Figure -3] MBR data\n\n The following [Figure 4] is overwritten with the contents of the MBR code, and has the ability to output the\n\n\n-----\n\n## Figure -4] MBR code\n\n The following [Figure 5] After MBR infection, a screen visible to the user reboots.\n\n [Figure 5] boot screen\n\n 4. File destructive features\n\n Malicious code can destroy the functionality of a file having a particular extension in addition to destruction together also has functions for the MBR. Destroy the target file identified to date are:\n\n - HWP\n - doc\n\n\n-----\n\n## - ALZ\n - ZIP\n - RAR\n - egg\n - iso\n - EXE\n - dll\n - sys\n\n Locate the files with the extension of the above 'A' ~ 'Z' drive changes and performs a process to fill a NULL value to 4096 bytes (4K) size.\n\n 5. Hangul vulnerability information\n\n Received nine vulnerabilities Hangul document and the contents hereof are both used the same vulnerability varies. In [Figure 6] shows the portion of the shell part and the operation code for generating a vulnerability. The layout of paragraphs in Hangul document and vulnerability occurs in the course of processing the part that is responsible ('HWPTAG_PARA_LINE_SEG') and, shellcode (ShellCode) and heap spray insert a paragraph of text for (Heap Spray) ('HWPTAG_PARA_TEXT') is used was.\n\n [Figure 6] vulnerability occurs Hangul part\n\n\n-----\n\n## MD5 and V3 diagnostic information on malicious files identified vulnerability Hangul file and generated by the current is as follows.\n```\n- 54783422cfd7029a26a3f3f5e9087d8a (V3: HWP / Exploit, 2014.12.10.06)\n- b5b6e93ab27cec75f07af2a3a6a40926 (V3: HWP / Exploit, 2014.12.10.02)\n- 800866bbab514657969996210bcf727b (V3: HWP / Exploit, 2014.12.10.02)\n- ead682b889218979b1f2f1527227af9b (V3: HWP / Exploit, 2014.12. 10.02)\n- f09ea2a841114121f32211faac553e1b (V3: HWP / Exploit, 2014.12.09.06)\n- 9daf088fe4c9a9580216e98dbb7d1fca (V3: HWP / Exploit, 2014.12.09.06)\n- 3ec69ee7135272e5bed3ea5378ade6ee (V3: HWP / Exploit, 2014.12.11.05)\n- 33874577bf54d3c209925c9def880eb9 (V3: HWP / Exploit, 2014.12.11.05)\n- af792a34548a2038f034ea9a6ff0639a (V3: HWP / Exploit, 2014.12.11.05)\n- 3BA8A6815F828DFC518A0BDBD27BBA5B (V3: Trojan / Win32.Destroyer,\n2014.12.10.00)\n\n 7. Countermeasures\nIn order to prevent a malware infection is necessary to always maintain a\nHangul program, and program-to-date antivirus update state. In addition,\nthe vulnerability has been identified as Hangul document files are\ndisseminated in the form of a person to e-mail attachments. For\nunascertained sender or unresolved attachment, the procedure to ensure\nthat there is no problem in security is required before execution.\n\n```\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "d63ae2b7-445f-460d-965d-2676dacdb6de",
            "created_at": "2022-10-25T15:59:19.552139Z",
            "updated_at": "2022-10-25T15:59:19.552139Z",
            "deleted_at": null,
            "name": "APTnotes",
            "url": "https://github.com/aptnotes/data",
            "description": "APTnotes data",
            "reports": null
        },
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        }
    ],
    "references": [
        "https://app.box.com/s/q8gx5wedudaui491qn6i4d7dxsnmuyla",
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2014/2014.12.10_South_Korea_MBR_Wiper/korea_power_plant_wiper.pdf"
    ],
    "report_names": [
        "korea_power_plant_wiper"
    ],
    "threat_actors": [
        {
            "id": "9e767b38-12ae-4ef7-9878-5ce1701066d7",
            "created_at": "2024-05-01T02:03:08.131819Z",
            "updated_at": "2025-03-27T02:05:17.413497Z",
            "deleted_at": null,
            "main_name": "NICKEL ACADEMY",
            "aliases": [
                "COVELLITE ",
                "CTG-2460 ",
                "Diamond Sleet ",
                "Guardians of Peace",
                "HIDDEN COBRA ",
                "High Anonymous",
                "Labyrinth Chollima ",
                "NNPT Group",
                "New Romanic Cyber Army Team",
                "Temp.Hermit ",
                "The Lazarus Group ",
                "UNC577 ",
                "Who Am I?",
                "Whois Team",
                "ZINC ",
                "Black Artemis "
            ],
            "source_name": "Secureworks:NICKEL ACADEMY",
            "tools": [
                " DarkMessenger",
                " Destover",
                " Duuzer",
                " HOPLIGHT",
                " Joanap",
                " KorHigh",
                " LiveJinx",
                " Volgmer",
                "Brambul"
            ],
            "source_id": "Secureworks",
            "reports": null
        }
    ],
    "ts_created_at": 1666716495,
    "ts_updated_at": 1743041150,
    "ts_creation_date": 1419436708,
    "ts_modification_date": 1419436708,
    "files": {
        "pdf": "https://archive.orkl.eu/fefd7ff6b2b254bd2e05784b51758c5d90acc06f.pdf",
        "text": "https://archive.orkl.eu/fefd7ff6b2b254bd2e05784b51758c5d90acc06f.txt",
        "img": "https://archive.orkl.eu/fefd7ff6b2b254bd2e05784b51758c5d90acc06f.jpg"
    }
}