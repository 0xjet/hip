{
    "id": "7e3255d2-87c9-48ee-960e-f1f7c40a8e20",
    "created_at": "2023-01-12T15:04:55.603346Z",
    "updated_at": "2025-03-27T02:13:58.305275Z",
    "deleted_at": null,
    "sha1_hash": "91bdd1fef66bfe9313a7c1de826f2c62c89c68fa",
    "title": "2021-01-07 - TA551- Email Attack Campaign Switches from Valak to IcedID",
    "authors": "",
    "file_creation_date": "2022-05-28T00:21:49Z",
    "file_modification_date": "2022-05-28T00:21:49Z",
    "file_size": 8448643,
    "plain_text": "# TA551: Email Attack Campaign Switches from Valak to IcedID\n\n**unit42.paloaltonetworks.com/ta551-shathak-icedid/**\n\nBrad Duncan January 7, 2021\n\nBy [Brad Duncan](https://unit42.paloaltonetworks.com/author/bduncan/)\n\nJanuary 7, 2021 at 12:01 AM\n\n[Category: Malware,](https://unit42.paloaltonetworks.com/category/malware-2/) [Unit 42](https://unit42.paloaltonetworks.com/category/unit-42/)\n\nTags: [IcedID,](https://unit42.paloaltonetworks.com/tag/icedid/) [Shathak,](https://unit42.paloaltonetworks.com/tag/shathak/) [TA551,](https://unit42.paloaltonetworks.com/tag/ta551/) [Ursnif,](https://unit42.paloaltonetworks.com/tag/ursnif/) [Valak](https://unit42.paloaltonetworks.com/tag/valak/)\n\nThis post is also available in: 日本語 [(Japanese)](https://unit42.paloaltonetworks.jp/ta551-shathak-icedid/)\n\n## Executive Summary\n\nTA551 (also known as Shathak) is an email-based malware distribution campaign that often targets English-speaking victims. The\ncampaign discussed in this blog has targeted German, Italian and Japanese speakers. TA551 has historically pushed different\n[families of information-stealing malware like Ursnif and Valak. After mid-July 2020, this campaign has exclusively pushed IcedID](https://unit42.paloaltonetworks.com/wireshark-tutorial-examining-ursnif-infections/)\nmalware, another information stealer.\n\nThis blog provides an overview of TA551, as well as previous activity from this campaign. We also examine changes from this\n[campaign since our previous blog about TA551 pushing Valak in July 2020.](https://unit42.paloaltonetworks.com/valak-evolution/)\n\n[Palo Alto Networks Next-Generation Firewall customers are protected from this threat with the](https://www.paloaltonetworks.com/network-security/next-generation-firewall) [Threat Prevention security](https://www.paloaltonetworks.com/products/secure-the-network/subscriptions/threat-prevention)\n[subscription, which detects the malware. AutoFocus customers can track this activity using the](https://www.paloaltonetworks.com/cortex/autofocus) [TA551 and](https://autofocus.paloaltonetworks.com/#/tag/Unit42.TA551) [IcedID tags.](https://autofocus.paloaltonetworks.com/#/tag/Unit42.IcedID)\n\n## Infection Chain of Events\n\nFrom mid-July through November 2020, TA551 has remained consistent in its infection process. A flow chart for the chain of\nevents is shown in Figure 1.\n\n\n-----\n\nFigure 1. Chain of events for TA551 (Shathak) from July through November 2020.\nThe initial lure is an email spoofing an email chain. These email chains are retrieved from email clients on previously infected\nhosts. The message has an attached ZIP archive and a message informing the user of a password necessary to open the\nattachment.\n\nAfter opening the ZIP archive, the victim finds a Microsoft Word document with macros. If the victim enables macros on a\nvulnerable Windows computer, the victim’s host retrieves an installer DLL for IcedID malware. This will infect a vulnerable Windows\ncomputer. See FIgures 2-7 for a recent example targeting a Japanese-speaking victim.\n\nFigure 2. An example of TA551 email targeting a Japanese-speaking victim on Nov. 4, 2020.\n\n\n-----\n\nFigure 3. Using password from the message to open the ZIP archive.\n\nFigure 4. Screenshot of Word document from the ZIP archive.\n\n\n-----\n\nFigure 5. Traffic from an infection filtered in Wireshark.\n\nFigure 6. Files and directories created during the infection process on a Windows host.\n\n\n-----\n\nFigure 7. Scheduled task to keep the IcedID infection persistent on an infected Windows host.\n\n## TA551 Switches to IcedID\n\n[We have a GitHub repository where we track recent TA551 activity. The repository contains information on each wave of attack](https://github.com/pan-unit42/iocs/tree/master/TA551)\nfrom TA551 since July 6, 2020. Starting on July 14, 2020, we have only seen IcedID malware from these waves of attack.\n\n[Since July 14, 2020, these waves of malspam consistently targeted English-speaking victims until Oct. 27, 2020, when we started](https://github.com/pan-unit42/iocs/blob/master/TA551/2020-10-27-TA551-IOCs-for-IcedID.txt)\nseeing Japanese templates for the Word documents. TA551 consistently targeted Japanese-speaking victims from Oct. 27-Nov.\n20, 2020. After approximately three weeks of Japanese-focused attacks, TA551 switched back to English-speaking victims starting\non [Nov. 24, 2020.](https://github.com/pan-unit42/iocs/blob/master/TA551/2020-11-24-TA551-IOCs-for-IcedID.txt)\n\nRegardless of the targeted group, TA551 continues to push IcedID as its malware payload.\n\n## History of TA551\n\nWe have traced TA551 as far back as February 2019, and since that time, we have noted the following characteristics:\n\n[TA551 has distributed different families of malware, including Ursnif (Gozi/ISFB),](https://isc.sans.edu/forums/diary/Ursnif+infection+with+Dridex/25566/) [Valak and](https://unit42.paloaltonetworks.com/valak-evolution/) [IcedID.](https://isc.sans.edu/forums/diary/TA551+Shathak+Word+docs+push+IcedID+Bokbot/26438/)\nTA551 malspam spoofs legitimate email chains based on data retrieved from previously infected Windows hosts. It sends\ncopies of these email chains to recipients of the original email chain.\nThe spoofed email includes a short message as the most recent item in the chain. This is a generic statement asking the\nrecipient to open an attached ZIP archive using the supplied password.\nFile names for the ZIP archives use the name of the company being spoofed in the email. For example, if the spoofed sender\nis someone@companyname.com, the ZIP attachment would be named companyname.zip.\nIn 2020, we also started seeing emails with info.zip or request.zip as the attached ZIP archive names.\nThese password-protected ZIP attachments contain a Word document with macros to install malware.\nFile names for the extracted Word documents follow noticeable patterns that have evolved as this campaign has progressed.\nURLs generated by the associated Word macros also follow noticeable patterns that have also evolved as this campaign has\nprogressed.\n\n## TA551 in 2019\n\nFigure 8 shows the earliest email we can confirm from this campaign, dated Feb. 4, 2019. It targeted an English-speaking recipient\nand pushed Ursnif malware.\n\n\n-----\n\nFigure 8. Example of TA551 malspam from February 2019.\nThe following files are associated with the above example:\n\nSHA256 hash: 3dab8a906b30e1371b9aab1895cd5aef75294b747b7291d5c308bb19fbc5db10\nFile size: 157,696 bytes\nFile name: Request11.doc\nFile description: Word doc with macro for Ursnif (Gozi/ISFB)\nSHA256 hash: 3afc28d4613e359b2f996b91eeb0bbe1a57c7f42d2d4b18e4bb6aa963f58e3ff\nFile size: 284,160 bytes\nFile location: hxxp://gou20lclair[.]band/xap_102b-AZ1/704e.php?l=zyteb12.gas\n\nFile description: Example of Windows EXE retrieved by Word macro – an installer for Ursnif\n\nFigure 9 shows an email from this campaign dated April 2, 2019. It targeted an Italian-speaking recipient and pushed Ursnif\nmalware.\n\n\n-----\n\nFigure 9. Example of TA551 malspam from April 2019.\nThe following files are associated with the above example:\n\nSHA256 hash: 582213137bebc93192b0429f6687c859f007ef03e6a4c620eada8d98ca5d76ba\nFile size: 91,136 bytes\nFile name: doc_02.04.doc\nFile description: Word doc with macro for Ursnif\nSHA256 hash: 8c72d5e5cb81f7a7c2b4881aff3be62cdc09caa52f93f9403166af74891c256e\nFile size: 606,208 bytes\nFile location: hxxp://seauj35ywsg[.]com/2poef1/j.php?l=zepax4.fgs\nFile description: Example of Windows EXE to install Ursnif retrieved by a macro associated with this wave of Word\ndocuments\n\nFigure 10 shows an email from this campaign dated Oct. 30, 2019. It targeted a German-speaking recipient and pushed Ursnif\nmalware.\n\n\n-----\n\nFigure 10. Example of TA551 malspam from October 2019.\nThe following files are associated with the above example:\n\nSHA256 hash: 10ed909ab789f2a83e4c6590da64a6bdeb245ec9189d038a8887df0dae46df2a\nFile size: 269,312 bytes\nFile name: info_10_30.doc\nFile description: Word doc with macro for Ursnif\nSHA256 hash: 9e5008090eaf25c0fe58e220e7a1276e5501279da4bb782f92c90f465f4838cc\nFile size: 300,032 bytes\nFile location: hxxp://onialisati[.]com/deamie/ovidel.php?l=brelry2.cab\nFile description: Example of Windows EXE retrieved by Word macro – an installer for Ursnif\n\nNote how the URL from the above example ends in .cab. This pattern was fairly consistent for URLs generated by macros from\nTA551 Word docs until late October 2020.\n\nFigure 11 shows an email from this campaign dated Dec. 17, 2019. It targeted a Japanese-speaking recipient and pushed Ursnif\nmalware.\n\n\n-----\n\nFigure 11. Example of TA551 malspam from December 2019.\nThe following files are associated with the above example:\n\nSHA256 hash: 3b28f3b1b589c9a92940999000aa4a01048f2370d03c4da0045aabf61f9e4bb6\nFile size: 101,528 bytes\nFile name: info_12_18.doc\nFile description: Word doc with macro for Ursnif\nSHA256 hash: 3a22d206858773b45b56fc53bed5ee4bb8982bb1147aad9c2a7c57ef6c099512\nFile size: 1,650,176 bytes\nFile location: hxxp://vestcheasy[.]com/koorsh/soogar.php?l=weecum5.cab\nFile description: Example of Windows EXE retrieved by Word macro – an installer for Ursnif\n\n[Note that Ursnif-infected hosts occasionally retrieve follow-up malware. For example, on Dec. 19, 2019, a Windows host infected](https://unit42.paloaltonetworks.com/wireshark-tutorial-examining-ursnif-infections/)\n[with Ursnif by way of TA551 was also infected with IcedID and Valak as follow-up malware.](https://www.malware-traffic-analysis.net/2019/12/19/index.html)\n\n## TA551 in 2020\n\nFigure 12 shows an email from TA551 dated March 26, 2020. It targeted a German-speaking recipient and pushed ZLoader (Silent\nNight) malware.\n\n\n-----\n\nFigure 12. Example of TA551 malspam from March 2020.\nThe following files are associated with the above example:\n\nSHA256 hash: 62ecc8950e8be104e250304fdc32748fcadaeaa677f7c066be1baa17f940eda8\nFile size: 127,757 bytes\nFile name: information_03.26.doc\nFile description: Word doc with macro for ZLoader (Silent Night)\nSHA256 hash: 9b281a8220a6098fefe1abd6de4fc126fddfa4f08ed1b90d15c9e0514d77e166\nFile size: 486,400 bytes\nFile location: hxxp://x0fopmxsq5y2oqud[.]com/kundru/targen.php?l=swep7.cab\nFile description: Windows DLL for ZLoader retrieved by Word macro\n\nFigure 13 shows an email from this campaign dated April 28, 2020. It targeted an English-speaking recipient and pushed Valak\nmalware.\n\n\n-----\n\nFigure 13. Example of TA551 malspam from April 2020.\nThe following files are associated with the above example:\n\nSHA256 hash: bd58160966981dd4b04af8530e3320edbddfc2b83a82b47a76f347d0fb4ca93a\nFile size: 61,233 bytes\nFile name: docs,04.20.doc\nFile description: Word doc with macro for Valak\nSHA256 hash: 9ce4835ef1842b7407b3c8777a6495ceb1b69dac0c13f7059c2fec1b2c209cb1\nFile size: 418,816 bytes\nFile location: hxxp://qut6oga5219bf00e[.]com/we20lo85/aio0i32p.php?l=nok4.cab\nFile description: Example of Windows DLL retrieved by Word macro -- an installer for Valak\n\nAt this point, the document names had changed format. This is when we started seeing several different names for the extracted\nWord documents from each day of attack.\n\nFigure 14 shows an email from this campaign dated May 22, 2020. It targeted an English-speaking recipient and pushed Valak\nmalware.\n\n\n-----\n\nFigure 14. Example of TA551 malspam from May 2020.\nThe following files are associated with the above example:\n\nSHA256 hash: 3562023ab563fc12d17981a1328f22a3d3e4c358535b9a0c28173a6e4ad869ba\nFile size: 74,338 bytes\nFile name: file_05.20.doc\nFile description: Word doc with macro for Valak\nSHA256 hash: 4468edc18de42e61b64441c75aedcb15d553410d473e77fc8ae31b358acd506a\nFile size: 184,832 bytes\nFile location: hxxp://s6oo5atdgmtceep8on[.]com/urvave/cennc.php?l=haao1.cab\nFile description: Example of Windows DLL retrieved by Word macro -- an installer for Valak\n\nBy this time, the password format for ZIP attachments changed to three digits followed by two letters, and the template style had\nalso been updated.\n\n[We continued to see Valak pushed by TA551 through early July 2020. Of note, Valak is a malware downloader, and we frequently](https://www.malware-traffic-analysis.net/2020/07/01/index.html)\nsaw IcedID as follow-up malware from these infections.\n\nHowever, by mid-July 2020, TA551 started pushing IcedID directly from the Word document macros.\n\n## Recent Developments\n\nIn recent weeks, TA551 has changed traffic patterns. For several months prior to [Oct. 19, 2020, URLs generated by Word macros](https://github.com/pan-unit42/iocs/blob/master/TA551/2020-10-19-TA551-IOCs-for-IcedID.txt)\nto retrieve installer binaries followed a noticeable pattern. This pattern includes:\n\n.php?l= in the URL path\nURLs end with .cab\n\n[Since Oct. 20, 2020, these patterns have changed dramatically. Table 1 shows the changes starting in October.](https://github.com/pan-unit42/iocs/blob/master/TA551/2020-10-20-TA551-IOCs-for-IcedID.txt)\n\nDate URL example\n\n\n202010-14\n\n\nGET /docat/hyra.php?l=dybe18.cab\n\n\n-----\n\n202010-16\n\n202010-19\n\n202010-20\n\n202010-27\n\n202010-28\n\n202010-29\n\n202011-03\n\n202011-04\n\n202011-05\n\n202011-19\n\n202011-24\n\n\nGET /muty/sohaq.php?l=tali18.cab\n\nGET /biwe_zibofyra/ripy_lani.php?l=qedux18.cab\n\nGET /_bxlzcpjlmpxlkzblf_zhlsplspz/wtlmwrqnnxfwgzzlkvzdbvnp_mphdqpggxfljvffj_.php?\nl=chfon4.ppt&lhe=hcqjvtfezhsogtrdxdfs\n\nGET /update/qqOQccpolFmwCmTnTmURcfZPByI_lqzPNvPfTfvLQjqdJtpOYeWT/WRFlVYjJTKqWAf_KhCjsSselY/tbqxj12\n\nGET /update/djMqKxc_BZCF_BJlRmjKmdcihghiSj/wJuzcnBhc/MD/qE_ZWFKbwfWZMCCWgfHU_DNxAcBRlHncRHr/csyj9\n\nGET /update/XTZrbyvClXzcfZcJGZSmDWBthSBXjRKw/chti6\n\nGET /update/VvZWoYOIotoWV_KUywQtEUVUPjvNYMYYnLnvWWOLA/fZcXYRwGyzMRZcvzHZrDe/gzlov4\n\nGET /update/JvYqBVMJCxSDX/nNBk/XhEfjPMvaV_dDFlXqGZNCDTLhTXlPWxEsGjTdzfQBUZCvkBqWOgjo/xrei12\n\nGET\n/update/jcja/yCGHnwRmyMVTeCqljgln/JTHBIgVESrNVdrgJMGGNdiqqGxCNACjXDBjkMJKFPKvJNYXFVbcxYvbS/iuyala13\n\nGET /share/ZSzE0sjR23GkF3VwZi_nqFH2B5lqPUVKxwNC/ahtap3\n\nGET /share/kvNqzh1tF4Y8zyxtL/HQpK6K42Wr8SP9PLJSqxc5h/ROwPcKsG/dbULREqlb1Kj0_RRT/Dfnj/lxnt10\n\n\n_Table 1. URL patterns generated by macros from Word docs distributed by TA551._\n\nBy Oct. 27, 2020, URLs generated by TA551 macros include English terms like update or share at the beginning of the HTTP GET\nrequest. These URLs end with a series of four to six lowercase English letters followed by a number as low as 1 to as high as 18.\nThese URLs are not consistent in length, and they can be very short or very long.\n\n[Since November 2020, we have also noticed minor changes in artifacts generated during IcedID infections, including those outside](https://twitter.com/malware_traffic/status/1329298956162129922)\nof the TA551 campaign.\n\nFor example, through early November 2020, IcedID DLLs created by installer DLLs were initially saved to the victim’s\nAppData\\Local\\Temp directory, and the file name started with a tilde (~) and ended with .dll as illustrated earlier in Figure 6. In\nNovember 2020, we started to see a change: the initial IcedID DLLs saved to the victim’s AppData\\Local directory with a file name\nending in .dat as shown in Figure 15.\n\n\n-----\n\nFigure 15. Artifacts seen from a TA551 IcedID infection on Nov. 24, 2020.\nThese changes may be an effort by malware developers to evade detection. At the very least, they might confuse someone\nconducting forensic analysis on an infected host.\n\nSuch changes are commonly seen in malware families as they evolve over time. We can expect to see more changes with IcedID\nmalware and the TA551 campaign during the coming months.\n\nFinally, the run method for installer DLLs retrieved by TA551 Word macros changed during November 2020:\n\nOld method: regsvr32.exe [installer DLL filename]\nNew method: rundll32.exe [installer DLL filename],ShowDialogA -r\n\nHowever, up-to-date information is necessary to ensure proper detection for a constantly-evolving campaign like TA551.\n\n## Conclusion\n\n[TA551 has evolved since we last reviewed this threat actor deploying Valak malware in July 2020. We frequently saw IcedID as](https://unit42.paloaltonetworks.com/valak-evolution/)\nfollow-up malware in previous months from Valak and Ursnif infections installed by TA551. This threat actor appears to have\neliminated malware downloaders like Valak and Ursnif and is now deploying IcedID directly.\n\nAlthough TA551 has settled on IcedID as its malware payload, we continue to see changes in traffic patterns and infection artifacts\nas this campaign evolves.\n\nOrganizations with adequate spam filtering, proper system administration and up-to-date Windows hosts have a much lower risk of\ninfection. Palo Alto Networks Next-Generation Firewall customers are further protected from this threat with the Threat Prevention\nsecurity subscription, which detects the malware. AutoFocus customers can track this activity using the TA551 and IcedID tags.\n\n## Indicators of Compromise\n\n[This GitHub repository currently has more than 50 text files containing various indicators associated with TA551 from mid-July](https://github.com/pan-unit42/iocs/tree/master/TA551)\n2020-November 2020. Each text file represents a specific day the campaign was active, and it contains SHA256 hashes,\ndocument names, associated URLs and other related data, some of which we’ve also shared through our Twitter handle\n[@Unit42_Intel.](https://twitter.com/Unit42_Intel)\n\n**Get updates from**\n\n**Palo Alto**\n\n**Networks!**\n\nSign up to receive the latest news, cyber threat intelligence and research from us\n\n\n-----\n\n[By submitting this form, you agree to our Terms of Use and acknowledge our Privacy Statement.](https://www.paloaltonetworks.com/legal-notices/terms-of-use)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-01-07 - TA551- Email Attack Campaign Switches from Valak to IcedID.pdf"
    ],
    "report_names": [
        "2021-01-07 - TA551- Email Attack Campaign Switches from Valak to IcedID.pdf"
    ],
    "threat_actors": [
        {
            "id": "26a04131-2b8c-4e5d-8f38-5c58b86f5e7f",
            "created_at": "2022-10-25T15:50:23.579601Z",
            "updated_at": "2025-03-27T02:00:55.50292Z",
            "deleted_at": null,
            "main_name": "TA551",
            "aliases": [
                "TA551",
                "GOLD CABIN",
                "Shathak"
            ],
            "source_name": "MITRE:TA551",
            "tools": [
                "QakBot",
                "IcedID",
                "Valak",
                "Ursnif"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "04e34cab-3ee4-4f06-a6f6-5cdd7eccfd68",
            "created_at": "2022-10-25T16:07:24.578896Z",
            "updated_at": "2025-03-27T02:02:10.286803Z",
            "deleted_at": null,
            "main_name": "TA551",
            "aliases": [
                "Gold Cabin",
                "Monster Libra",
                "Shathak",
                "TA551"
            ],
            "source_name": "ETDA:TA551",
            "tools": [
                "BokBot",
                "CRM",
                "Gozi",
                "Gozi CRM",
                "IceID",
                "IcedID",
                "Papras",
                "Snifula",
                "Ursnif",
                "Valak",
                "Valek"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "90f216f2-4897-46fc-bb76-3acae9d112ca",
            "created_at": "2023-01-06T13:46:39.248936Z",
            "updated_at": "2025-03-27T02:00:03.031127Z",
            "deleted_at": null,
            "main_name": "GOLD CABIN",
            "aliases": [
                "Shakthak",
                "TA551",
                "ATK236",
                "G0127",
                "Monster Libra"
            ],
            "source_name": "MISPGALAXY:GOLD CABIN",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "40b623c7-b621-48db-b55b-dd4f6746fbc6",
            "created_at": "2024-06-19T02:03:08.017681Z",
            "updated_at": "2025-03-27T02:05:17.342829Z",
            "deleted_at": null,
            "main_name": "GOLD CABIN",
            "aliases": [
                "TA551 ",
                "Shathak"
            ],
            "source_name": "Secureworks:GOLD CABIN",
            "tools": [
                ""
            ],
            "source_id": "Secureworks",
            "reports": null
        }
    ],
    "ts_created_at": 1673535895,
    "ts_updated_at": 1743041638,
    "ts_creation_date": 1653697309,
    "ts_modification_date": 1653697309,
    "files": {
        "pdf": "https://archive.orkl.eu/91bdd1fef66bfe9313a7c1de826f2c62c89c68fa.pdf",
        "text": "https://archive.orkl.eu/91bdd1fef66bfe9313a7c1de826f2c62c89c68fa.txt",
        "img": "https://archive.orkl.eu/91bdd1fef66bfe9313a7c1de826f2c62c89c68fa.jpg"
    }
}