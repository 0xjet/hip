{
    "id": "9f2b0524-f8ef-44a0-9921-1e51f1e098ea",
    "created_at": "2023-01-12T15:02:10.874821Z",
    "updated_at": "2025-03-27T02:15:45.348371Z",
    "deleted_at": null,
    "sha1_hash": "f168904752d26870bfe49dc6d64fe0b79fd08b88",
    "title": "2019-03-06 - Internet of Termites",
    "authors": "",
    "file_creation_date": "2022-05-27T23:22:40Z",
    "file_modification_date": "2022-05-27T23:22:40Z",
    "file_size": 765919,
    "plain_text": "# Internet of Termites\n\n**alienvault.com/blogs/labs-research/internet-of-termites**\n\n[1. AT&T Cybersecurity](https://cybersecurity.att.com/)\n[2. Blog](https://cybersecurity.att.com/blogs)\n\nMarch 6, 2019 | [Chris Doman](https://www.alienvault.com/blogs/author/chris-doman)\n[Termite is a tool used to connect together chains of machines on a network. You can run Termite on a](http://rootkiter.com/Termite/)\nsurprising number of platforms including mobile devices, routers, servers and desktops.\n\nThat means it can be used used to bounce a connection between multiple machines, to maintain a\nconnection that otherwise wouldn’t be possible:\n\nTermite is a useful networking and penetration testing tool, but we’re seeing it used in attacks to\nenable access to machines too. There has been little reporting on Termite, beyond a brief mention in\na [report by Kaspersky of an earlier version of Termite called “EarthWorm”. Below, we’ve provided an](https://securelist.com/luckymouse-ndisproxy-driver/87914/)\noutline on some of the attackers we’re seeing deploying Termite.\n\n**[Note: As we were publishing this, Symantec released a report on attackers using Termite in the 2018](https://www.symantec.com/blogs/threat-intelligence/whitefly-espionage-singapore)**\nattack [stealing the health data of a quarter of the Singapore population.](https://www.bbc.co.uk/news/world-asia-44900507)\n\n\n-----\n\n## How Termite and EarthWorm Work\n\nTermite and EarthWorm are [publicly available tools written by](http://rootkiter.com/Termite/) [an employee of 360NetLab. They can](https://twitter.com/rookiter)\n[be considered an updated version of the well known packet relay tool HTRAN.](https://www.secureworks.com/research/htran)\n\nTermite popped up on our radar when we were reviewing malicious binaries compiled to run on IoT\narchitectures. Termite is available for a range https://github.com/rootkiter/Binaryfiles/tree/master/Termite/release/agent of different operating systems and architectures including x86\nARM, PowerPC, Motorola, SPARC and Renesas.\n\nThis means an attacker can use a long chain of desktop, mobile and IoT devices to be able to\nconnect through networks and DMZs.\n\nTermite can act as a SOCKS proxy to bounce traffic, as well as a lightweight backdoor that can\nupload and download files, and execute shell commands:\n\nThe Termite help function\n\nFor example, this is a typical sequence of commands you may see when investigating a compromised\nmachine:\n\n\n-----\n\n**Victim Host**\n\nOn a victim host, the attacker listens for\nincoming connections:\n\nagent.exe -l 8888\n\n\n**Attacker Host**\n\nThen the attacker connects to the compromised\nmachine:\n\nadmin.exe -c [target_ip] -p 8888\n\nAnd selects which compromised system to interact\nwith:\n\ngoto 1\n\nThen they start a SOCKS proxy on the system to\nroute traffic through it:\n\nsocks 1080\n\nAnd a shell on the compromised system that they can\nconnect to with netcat:\n\nshell 6666\n\n\nTermite uses a distinctive binary protocol to initiate connections, as can be seen in this network traffic\nstream:\n\nNetwork traffic generated by Termite\n\nThere is a good description of the command line arguments of EarthWorm [here, and the source code](https://seiscode.iris.washington.edu/projects/ew2ringserver/wiki/A_SeedLink_server_for_Earthworm)\n[of the agent is on GitHub.](https://github.com/anhilo/xiaogongju/tree/422136c014ba6b95ad3a746662be88372eb11b09)\n\n## Malware\n\n**Mobile EarthWorm used to Spy on Targets in Taiwan**\n\nWe were surprised to find EarthWorm also packed into malware - presumably to provide packet relay\nfunctionality.\n\nIn one [Android application, EarthWorm is hidden inside an image file called box_07.png. The](https://www.virustotal.com/gui/file/f8478ce363f824fc8dc14cebe84c29a4d12e66536c0250b9f12540e3a511935b/detection)\n[Application communicates with the hostname apache2013.qpoe[.]com - which resolves to a](https://otx.alienvault.com/indicator/hostname/apache2013.qpoe.com) server in\nTaiwan.\n\n[We’ve previously investigated this server when it was hosting Android malware known as Xsser. The](https://www.virustotal.com/#/file/8774f27021146a863accbf34199a378a28ed28a1c616b8741a1dc8021783a4ec/behavior)\n[Xsser malware communicates with a familiar hostname apache2012.epac[.]to and impersonates an](https://www.virustotal.com/#/file/8774f27021146a863accbf34199a378a28ed28a1c616b8741a1dc8021783a4ec/behavior)\n[application from a Taiwanese travel service:](http://en.liontravel.com/)\n\n\n-----\n\n[The same server has also previously been associated associated with a group known as “BlackTech”](https://otx.alienvault.com/indicator/hostname/zany.strangled.net)\nthat primarily targets Taiwan.\n\n**Windows EarthWorm**\n\n[We’ve also seen EarthWorm packed in with malware from crypto-mining campaigns.](https://www.virustotal.com/#/file/b1988efb8f1debd239e0c563f94d22362e43af77284796899f9987622ffb1463/detection)\n\n[This malware is linked to a campaign previously reported on by TenCent. Machines at a University](https://s.tencent.com/research/report/503.html)\nHospital in Guangzhou China, and a children's hospital in Chongqing China, were infected with\ncrypto-mining malware.\n\n**Will Cross-Platform Malware Become a Thing?**\n\n[Network operators report that a significant amount of malicious traffic on their networks are now](https://www.infosecurity-magazine.com/news/iot-botnets-78-of-malware-on/)\ndriven by IoT malware. So far this has been driven by IoT and Linux specific malware such as Mirai\nand Xor DDoS\n\n\n-----\n\n## Detection\n\nWe detect network traffic across the various Windows, Linux, OSX, mobile and IoT platforms with:\n\nAV TROJAN EarthWorm/Termite IoT Agent Reporting Infection\n\nAdditionally our host agent detects EarthWorm/Termite activity on hosts, and generically detects shell\nconnections.\n\n### OTX Pulse\n\n[You can view indicators in OTX.](https://otx.alienvault.com/pulse/5c6d2c0cd70d64283c424e7a)\n\n### Yara Rules\n\nrule EarthWorm : LinuxMalware\n\n{\n\nmeta:\n\nauthor = \"AlienVault Labs\"\n\ncopyright = \"Alienvault Inc. 2019\"\n\nlicense = \"Apache License, Version 2.0\"\n\nsha256 = \"f4dd44bc19c19056794d29151a5b1bb76afd502388622e24c863a8494af147dd\"\n\ndescription = \"EarthWorm Packet Relay Tool\"\n\nstrings:\n\n$elf = {7f 45 4c 46}\n\n$string_1 = \"I_AM_NEW_RC_CMD_SOCK_CLIENT\"\n\n$string_2 = \"CONFIRM_YOU_ARE_SOCK_CLIENT\"\n\n$string_3 = \"SOCKSv4 Not Support now!\"\n\n$string_4 = \"rssocks cmd_socket OK!\"\n\ncondition:\n\n$elf at 0 and 2 of them\n\n}\n\nrule Termite : LinuxMalware\n\n{\n\n\n-----\n\nmeta:\n\nauthor = \"AlienVault Labs\"\n\ncopyright = \"Alienvault Inc. 2019\"\n\nlicense = \"Apache License, Version 2.0\"\n\nsha256 = \"6062754dbe5503d375ad0e61f6b4342654624f471203fe50eb892e0029451416\"\n\ndescription = \"Termite Packet Relay Tool\"\n\nstrings:\n\n$elf = {7f 45 4c 46}\n\n$string_1 = \"File data send OK!\"\n\n$string_2 = \"please set the target first\"\n\n$string_3 = \"It support various OS or CPU.For example\"\n\n$string_4 = \"xxx -l [lport] -n [name]\"\n\ncondition:\n\n$elf at 0 and 2 of them\n\n}\n\n### Suricata Rule\n\nalert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"AV TROJAN EarthWorm/Termite IoT\nAgent Reporting Infection\"; flow:established,to_server; content:\"|00 00 00 01|\"; offset:1; depth:4;\ncontent:\"|00 00 00 01 6b 00 00 00 01|\"; distance:7; within:9; content:\"agent\"; distance:4; within:5;\npcre:\"/+?[ -]+?+?$/R\";�\nreference:url,https://github.com/anhilo/xiaogongju/tree/422136c014ba6b95ad3a746662be88372eb11b09;\nclasstype:trojan-activity; sid:xxx; rev:1;)\n\n### EarthWorm and Termite\n\n**SHA256 Hash**\n\n381774ed8d6d69975694247acc80e42831ee68b43583c8734af52adff8f73373\n\n980fd1e947a8dd578c45bc76254b6aaa95b35e6ec33b8f41da268623500bd0f1\n\n3d9aaac0a8e5c7eadd79d8d5c16119d04f4e9db7107fc44a1e32a8746a1ec375\n\n1ae62dbec330695d2eddc7cb9a65d47bad5f45af95e6c8a803f0780e0749a3ad\n\n27cd70b47588aa0a1c8d737cde89fe8de1351af49aa8f11378a1e26a40f268eb\n\n\n-----\n\n3537b3eaad16d59c1f0c22d6cbcfe5a1b4542cc4f6a1e3135e26873c0dd4b06f\n\n459333b4765363526b2f76353941a5e1346e9a71433bd16c1e34a03c3c13bf6b\n\n3141ce911e3da8b0bf9744ef0603f7fac55be157eafc54995a752759882da1b2\n\n18c3accc4f65aae7bf7897adef35abdcca3697884860a6b5360e4f2d07bc26ed\n\n46af7c0674c69df2af1905ea58288f24d2d10e644d5446d8d2b71b251e8e70bd\n\ne05ef2747f973d6ae9e4bd5fbeede55b27afd44882b83b4aee79330e856757e8\n\na585eb434239e5c1714192482f20ec2483bf8eae4654ef77973524b3a151b455\n\n73fc266095e6d582b79db226145d0990129ad72c584863a61f3bd0e8056a0435\n\n58fcbf640b58a45f2fed22fdd70c5d73ae781274927a2def5f71cb3e4ce02a15\n\nd57cbbc5b6f0d223b5a3470a6a444ea4ef49dad718cbe992c92cca935cfdac7d\n\nef1d610dd78efae3dfa2eebade2ee76882b7e2b5df140aa068e25519d800bc63\n\n825790dbcdf9b7a69b9a566f71bc167a0a8353e735390c5815b247ac58efa817\n\nda584a49609de5985f5ba64cfb215f0c30c93fac11563ea32afa3820b3327139\n\na487628dc7647507f77cff66269d5d4588c7647e408b07ec0c4b1f16a93eefc4\n\n8b6d83c919ad123d4b27f3404604e99eeba9196cf81f3210a65d8ae1b89465a6\n\n7aa2f4a66d72adefd632e15dee392cbeab0a843a4890598a9610660897b398f1\n\nafb55dc8b4bcff758082efde93e5ca9c2a6a725b16a4c82e7675393bf46fecfd\n\nd21cccc6cb3f8313098da5b7ad6a37b5349835a702b5caf8e794a7c6903f40c5\n\n5bcac0a74645424d26b217b7725be826b7d558ecbce7ec5d3072d802e1834181\n\n44370c394c70f88cd9ecfb23f9d6570e2134761d1a04deea5205cec31469cfb0\n\n3af0857c9fae7e41683d34af7e04c6ed29439466761512ebbf28bad7561d092b\n\n9b3d82bb1aff3a17a490dd4da09cd315d8e94a52b8caa31ef7a7cf2a89c9d87a\n\n### Android Malware\n\n**SHA256 Hash**\n\n8774f27021146a863accbf34199a378a28ed28a1c616b8741a1dc8021783a4ec\n\nad560a69ad6aa327b59c123683189dec416889616b652beaa666a5919fe13935\n\nf8478ce363f824fc8dc14cebe84c29a4d12e66536c0250b9f12540e3a511935b\n\n\n-----\n\n**Hostnames**\n\nzany.strangled[.]net\n\napache2012.epac[.]to\n\napache2013.qpoe[.]com\n\n### Cryptomining Malware\n\n**SHA256 Hash**\n\nb1988efb8f1debd239e0c563f94d22362e43af77284796899f9987622ffb1463\n\n**Hostnames**\n\nlogv586[.]cc\n\nsock5[.]co\n\n### Share this with others\n\nTags: [malware,](https://www.alienvault.com/blogs/tag/malware) [otx,](https://www.alienvault.com/blogs/tag/otx) [penetration testing,](https://www.alienvault.com/blogs/tag/penetration+testing) [attacks](https://www.alienvault.com/blogs/tag/attacks)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2019/2019-03-06 - Internet of Termites.pdf"
    ],
    "report_names": [
        "2019-03-06 - Internet of Termites.pdf"
    ],
    "threat_actors": [
        {
            "id": "ad5c6ff2-0646-4b29-88bb-d88c75e4866d",
            "created_at": "2022-10-25T15:50:23.662882Z",
            "updated_at": "2025-03-27T02:00:55.515808Z",
            "deleted_at": null,
            "main_name": "Whitefly",
            "aliases": [
                "Whitefly"
            ],
            "source_name": "MITRE:Whitefly",
            "tools": [
                "Mimikatz"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "2646f776-792a-4498-967b-ec0d3498fdf1",
            "created_at": "2022-10-25T15:50:23.475784Z",
            "updated_at": "2025-03-27T02:00:55.479958Z",
            "deleted_at": null,
            "main_name": "BlackTech",
            "aliases": [
                "BlackTech",
                "Palmerworm"
            ],
            "source_name": "MITRE:BlackTech",
            "tools": [
                "Kivars",
                "PsExec",
                "TSCookie",
                "Flagpro",
                "Waterbear"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "d3a7123c-f519-49a0-a234-de24a1ef052a",
            "created_at": "2022-10-25T16:47:55.545211Z",
            "updated_at": "2025-03-27T02:05:17.254744Z",
            "deleted_at": null,
            "main_name": "BRONZE CANAL",
            "aliases": [
                "CTG-6177 ",
                "Circuit Panda ",
                "Palmerworm ",
                "Shrouded Crossbow ",
                "BlackTech"
            ],
            "source_name": "Secureworks:BRONZE CANAL",
            "tools": [
                " DRIGO",
                " Flagpro",
                " Gh0stTimes",
                " PLEAD",
                " Spiderpig",
                " Waterbear",
                "Bifrose"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "75024aad-424b-449a-b286-352fe9226bcb",
            "created_at": "2023-01-06T13:46:38.962724Z",
            "updated_at": "2025-03-27T02:00:02.964002Z",
            "deleted_at": null,
            "main_name": "BlackTech",
            "aliases": [
                "CIRCUIT PANDA",
                "Temp.Overboard",
                "G0098",
                "Red Djinn",
                "HUAPI",
                "Palmerworm",
                "T-APT-03",
                "Manga Taurus",
                "Earth Hundun"
            ],
            "source_name": "MISPGALAXY:BlackTech",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "cd9f8d91-c55c-4086-a1a0-23e78d194d46",
            "created_at": "2023-01-06T13:46:38.943454Z",
            "updated_at": "2025-03-27T02:00:02.958535Z",
            "deleted_at": null,
            "main_name": "Whitefly",
            "aliases": [],
            "source_name": "MISPGALAXY:Whitefly",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "efa7c047-b61c-4598-96d5-e00d01dec96b",
            "created_at": "2022-10-25T16:07:23.404442Z",
            "updated_at": "2025-03-27T02:02:09.781478Z",
            "deleted_at": null,
            "main_name": "BlackTech",
            "aliases": [
                "BlackTech",
                "Circuit Panda",
                "Earth Hundun",
                "Manga Taurus",
                "Operation PLEAD",
                "Operation Shrouded Crossbow",
                "Operation Waterbear",
                "Palmerworm",
                "Radio Panda",
                "Red Djinn",
                "T-APT-03",
                "TEMP.Overboard"
            ],
            "source_name": "ETDA:BlackTech",
            "tools": [
                "BIFROST",
                "BUSYICE",
                "BendyBear",
                "Bluether",
                "CAPGELD",
                "DRIGO",
                "Deuterbear",
                "Flagpro",
                "GOODTIMES",
                "Gh0stTimes",
                "IconDown",
                "KIVARS",
                "LOLBAS",
                "LOLBins",
                "Linopid",
                "Living off the Land",
                "TSCookie",
                "Waterbear",
                "XBOW",
                "elf.bifrose"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "df9bfbf1-bb9d-492f-b381-95b9e1482267",
            "created_at": "2022-10-25T16:07:24.394491Z",
            "updated_at": "2025-03-27T02:02:10.207352Z",
            "deleted_at": null,
            "main_name": "Whitefly",
            "aliases": [
                "ATK 83",
                "Bronze Walker",
                "Mofang",
                "SectorM04",
                "TEMP.Mimic"
            ],
            "source_name": "ETDA:Whitefly",
            "tools": [
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "Mimikatz",
                "Nibatad",
                "Shim RAT",
                "ShimRAT",
                "Vcrodat"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "e3492534-85a6-4c87-a754-5ae4a56d7c8c",
            "created_at": "2022-10-25T15:50:23.819113Z",
            "updated_at": "2025-03-27T02:00:55.552554Z",
            "deleted_at": null,
            "main_name": "Threat Group-3390",
            "aliases": [
                "Threat Group-3390",
                "Earth Smilodon",
                "TG-3390",
                "Emissary Panda",
                "BRONZE UNION",
                "APT27",
                "Iron Tiger",
                "LuckyMouse"
            ],
            "source_name": "MITRE:Threat Group-3390",
            "tools": [
                "Systeminfo",
                "gsecdump",
                "PlugX",
                "ASPXSpy",
                "Cobalt Strike",
                "Mimikatz",
                "Impacket",
                "gh0st RAT",
                "certutil",
                "China Chopper",
                "HTTPBrowser",
                "Tasklist",
                "netstat",
                "SysUpdate",
                "HyperBro",
                "ZxShell",
                "RCSession",
                "ipconfig",
                "Clambling",
                "pwdump",
                "NBTscan",
                "Pandora",
                "Windows Credential Editor"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "5c13338b-eaed-429a-9437-f5015aa98276",
            "created_at": "2022-10-25T16:07:23.582715Z",
            "updated_at": "2025-03-27T02:02:09.875151Z",
            "deleted_at": null,
            "main_name": "Emissary Panda",
            "aliases": [
                "APT 27",
                "ATK 15",
                "Bronze Union",
                "Budworm",
                "Earth Smilodon",
                "Emissary Panda",
                "Group 35",
                "Iron Taurus",
                "Iron Tiger",
                "LuckyMouse",
                "Operation DRBControl",
                "Operation Iron Tiger",
                "Operation PZChao",
                "Operation SpoiledLegacy",
                "Operation StealthyTrident",
                "Red Phoenix",
                "TEMP.Hippo",
                "TG-3390",
                "ZipToken"
            ],
            "source_name": "ETDA:Emissary Panda",
            "tools": [
                "ASPXSpy",
                "ASPXTool",
                "Agent.dhwf",
                "AngryRebel",
                "Antak",
                "CHINACHOPPER",
                "China Chopper",
                "Destroy RAT",
                "DestroyRAT",
                "FOCUSFJORD",
                "Farfli",
                "Gh0st RAT",
                "Ghost RAT",
                "HTTPBrowser",
                "HTran",
                "HUC Packet Transmit Tool",
                "HighShell",
                "HttpBrowser RAT",
                "HttpDump",
                "HyperBro",
                "HyperSSL",
                "HyperShell",
                "Kaba",
                "Korplug",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "Mimikatz",
                "Moudour",
                "Mydoor",
                "Nishang",
                "OwaAuth",
                "PCRat",
                "PlugX",
                "ProcDump",
                "PsExec",
                "RedDelta",
                "SEASHARPEE",
                "Sensocode",
                "SinoChopper",
                "Sogu",
                "SysUpdate",
                "TIGERPLUG",
                "TVT",
                "Thoper",
                "Token Control",
                "TokenControl",
                "TwoFace",
                "WCE",
                "Windows Credential Editor",
                "Windows Credentials Editor",
                "Xamtrav",
                "ZXShell",
                "gsecdump",
                "luckyowa"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535730,
    "ts_updated_at": 1743041745,
    "ts_creation_date": 1653693760,
    "ts_modification_date": 1653693760,
    "files": {
        "pdf": "https://archive.orkl.eu/f168904752d26870bfe49dc6d64fe0b79fd08b88.pdf",
        "text": "https://archive.orkl.eu/f168904752d26870bfe49dc6d64fe0b79fd08b88.txt",
        "img": "https://archive.orkl.eu/f168904752d26870bfe49dc6d64fe0b79fd08b88.jpg"
    }
}