{
    "id": "7d49f823-a982-47e0-9c2e-ed4a24f382bb",
    "created_at": "2023-03-03T02:05:47.387556Z",
    "updated_at": "2025-03-27T02:10:54.385382Z",
    "deleted_at": null,
    "sha1_hash": "227627619bc98a672aaf9340792735d50588470c",
    "title": "2022-12-30 - A Quick Look at ELF Bifrose (Part 1)",
    "authors": "",
    "file_creation_date": "2023-03-01T09:12:04Z",
    "file_modification_date": "2023-03-01T09:12:04Z",
    "file_size": 789722,
    "plain_text": "# A Quick Look at ELF Bifrose (Part 1)\n\n**[cyberandramen.net/2022/12/30/a-quick-look-at-elf-bifrose/](https://cyberandramen.net/2022/12/30/a-quick-look-at-elf-bifrose/)**\n\nDecember 30, 2022\n\nBifrose or Bifrost is a backdoor initially targeting Windows systems with a long history. First\nidentified in the early 2000’s, it is believed a hacking group (likely BlackTech), purchased the\nsource code or gained access to it around 2010, and enhanced the malware for use in its\nown campaigns.\n\nBlackTech has long targeted both Windows and Unix-based systems with a variety of\nmalicious software, tailoring different malware to each campaign.\n\n## It Started With A Tweet\n\nOn 24 November, Twitter user @strinsert1Na tweeted that a recent ELF Bifrose sample had\nbeen uploaded to VirusTotal.\n\nFigure 1: Tweet courtesy of @strinsert1Na\n\n\n-----\n\nWhile the reuse of command and control (C&C) infrastructure is nothing new for BlackTech,\nthe operators have consistently added new features to the backdoor, while seemingly not\nchanging the targets of their attacks.\n\n## “udevd-10.138.61.156”\n\nAs of the time of writing, the latest Bifrose sample is detected by about half of the vendors on\nVirusTotal, scoring a 36 out of 64.\n\nFigure2: VirusTotal Results\nAlthough we have a good idea the file in question is an ELF file, running the file command\nwill provide us with confirmation of the file type as well as if the file has been stripped.\n\nFigure 3: Output of file command\nSure enough, the output identifies the executable has been stripped; in other words, the\nsymbols containing human-readable function names have been removed to slow down\nanalysis.\n\nIf you’re still unsure the file is stripped, try running readelf -s filename. In this case, no output\nconfirms the file’s symbols have been tampered with.\n\nRunning readelf with the “-p” argument on the .comment section will provide the compiler\nversion and development environment.\n\n\n-----\n\nFigure 4: Output of readelf -p .comment filename\nFrom the above output, we can infer that this sample is likely targeting Red Hat distributions.\n\nProbably one of the best analysis tools, the strings command can assist in identifying the\nfunctionality of the executable, as well as indicators (think Windows APIs for PEs, & syscalls\nfor Unix). The output in Figure 5 provides a small snapshot of running strings.\n\n\n-----\n\nFigure 5: Output of strings\n\nIn addition to the hard-coded IP addresses, standard strings indicating first contact with the\nC&C server, notably unix|, 5.0.0.0|, and what appear to be C&C commands (recvData and\nsend data), are visible in the output.\n\nAdditionally, we can see signs of reconnaissance of the infected system, viewing the version\nand OS release, as well as the kernel version, and the timezone the target is located in.\n\n## Bifrose Capabilities\n\nIf you don’t have Sysmon for Linux setup in a VM, or aren’t quite ready to upload the sample\nto a public sandbox, one great option is to utilize strace to run the sample and redirect the\noutput to a separate file.\n\n\n-----\n\nstrace output will include operations such as any network connections or attempts, system\ncalls, file read and write operations, etc., all information that is extremely valuable to\nunderstand the program’s behavior.\n\nThe command strace -o strace_results.txt ./elf_file is all you need, along with Wireshark,\nTCPDump, or any other tool that can capture network traffic. Explaining the syscalls\nidentified in the strace output would be an article or two, and I would like to keep this short. If\nyour interested in strace, see the below links section.\n\nFigure 6 and 7 show snippets of interesting system calls Bifrose makes when run.\n\nFigure 6: strace output (1)\n\nstrace output (2)\nTo keep things simple, we’ll use Mandiant’s CAPA tool to get an idea of what Bifrose is up to.\n\n\n-----\n\nFigure 8: CAPA output\nIn the next post, I’ll use Cutter to look at some of the capabilities identified in the above\nimage and see if we can map out the execution of Bifrose, to help defenders get an idea of\nwhat indicators will assist in identifying a possible intrusion.\n\n## Links\n\n[https://man7.org/linux/man-pages/man2/syscalls.2.html](https://man7.org/linux/man-pages/man2/syscalls.2.html)\n\n[ELF Malware Analysis 101: Part 3 – Advanced Analysis](https://www.intezer.com/blog/malware-analysis/elf-malware-analysis-101-part-3-advanced-analysis/)\n\n[https://www.pentesteracademy.com/video?id=881](https://www.pentesteracademy.com/video?id=881)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-12-30 - A Quick Look at ELF Bifrose (Part 1).pdf"
    ],
    "report_names": [
        "2022-12-30 - A Quick Look at ELF Bifrose (Part 1).pdf"
    ],
    "threat_actors": [
        {
            "id": "2646f776-792a-4498-967b-ec0d3498fdf1",
            "created_at": "2022-10-25T15:50:23.475784Z",
            "updated_at": "2025-03-27T02:00:55.479958Z",
            "deleted_at": null,
            "main_name": "BlackTech",
            "aliases": [
                "BlackTech",
                "Palmerworm"
            ],
            "source_name": "MITRE:BlackTech",
            "tools": [
                "Kivars",
                "PsExec",
                "TSCookie",
                "Flagpro",
                "Waterbear"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "d3a7123c-f519-49a0-a234-de24a1ef052a",
            "created_at": "2022-10-25T16:47:55.545211Z",
            "updated_at": "2025-03-27T02:05:17.254744Z",
            "deleted_at": null,
            "main_name": "BRONZE CANAL",
            "aliases": [
                "CTG-6177 ",
                "Circuit Panda ",
                "Palmerworm ",
                "Shrouded Crossbow ",
                "BlackTech"
            ],
            "source_name": "Secureworks:BRONZE CANAL",
            "tools": [
                " DRIGO",
                " Flagpro",
                " Gh0stTimes",
                " PLEAD",
                " Spiderpig",
                " Waterbear",
                "Bifrose"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "75024aad-424b-449a-b286-352fe9226bcb",
            "created_at": "2023-01-06T13:46:38.962724Z",
            "updated_at": "2025-03-27T02:00:02.964002Z",
            "deleted_at": null,
            "main_name": "BlackTech",
            "aliases": [
                "CIRCUIT PANDA",
                "Temp.Overboard",
                "G0098",
                "Red Djinn",
                "HUAPI",
                "Palmerworm",
                "T-APT-03",
                "Manga Taurus",
                "Earth Hundun"
            ],
            "source_name": "MISPGALAXY:BlackTech",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "efa7c047-b61c-4598-96d5-e00d01dec96b",
            "created_at": "2022-10-25T16:07:23.404442Z",
            "updated_at": "2025-03-27T02:02:09.781478Z",
            "deleted_at": null,
            "main_name": "BlackTech",
            "aliases": [
                "BlackTech",
                "Circuit Panda",
                "Earth Hundun",
                "Manga Taurus",
                "Operation PLEAD",
                "Operation Shrouded Crossbow",
                "Operation Waterbear",
                "Palmerworm",
                "Radio Panda",
                "Red Djinn",
                "T-APT-03",
                "TEMP.Overboard"
            ],
            "source_name": "ETDA:BlackTech",
            "tools": [
                "BIFROST",
                "BUSYICE",
                "BendyBear",
                "Bluether",
                "CAPGELD",
                "DRIGO",
                "Deuterbear",
                "Flagpro",
                "GOODTIMES",
                "Gh0stTimes",
                "IconDown",
                "KIVARS",
                "LOLBAS",
                "LOLBins",
                "Linopid",
                "Living off the Land",
                "TSCookie",
                "Waterbear",
                "XBOW",
                "elf.bifrose"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1677809147,
    "ts_updated_at": 1743041454,
    "ts_creation_date": 1677661924,
    "ts_modification_date": 1677661924,
    "files": {
        "pdf": "https://archive.orkl.eu/227627619bc98a672aaf9340792735d50588470c.pdf",
        "text": "https://archive.orkl.eu/227627619bc98a672aaf9340792735d50588470c.txt",
        "img": "https://archive.orkl.eu/227627619bc98a672aaf9340792735d50588470c.jpg"
    }
}