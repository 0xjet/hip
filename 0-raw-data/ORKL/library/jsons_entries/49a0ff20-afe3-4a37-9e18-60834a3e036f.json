{
    "id": "49a0ff20-afe3-4a37-9e18-60834a3e036f",
    "created_at": "2022-10-25T16:48:15.328049Z",
    "updated_at": "2025-03-27T02:05:39.824387Z",
    "deleted_at": null,
    "sha1_hash": "1dfbec592268d6634dfc6864da48f41e3477b6ed",
    "title": "",
    "authors": "",
    "file_creation_date": "2018-06-13T17:09:01Z",
    "file_modification_date": "2019-05-23T13:51:10Z",
    "file_size": 1875512,
    "plain_text": "第3 号/2018 春\n\n# サイバー救急センターレポート\n\n#### - 脅威管理とインシデント対応をする人へ -\n\n## 第3 号\n\n##### 2018 春\n\n###### 01\n 2018 年6 月14 日\n\n\n-----\n\n第3 号/2018 春\n\n### サイバー救急センターレポート\n\n 第3 号 / 2018 春\n\n##### 目   次\n\n###### 03 はじめに\n\n 04 サイバー救急センターの出動傾向\n\n 07 攻撃者の残した痕跡に学ぶ\n\n 09 脅威分析報告\n\n 16 コラム：セキュリティ百景\n\n #5 IRDF オンライン講座\n\n #6 サンドボックス講座\n\n 19 編集後記\n\nサイバー救急センターレポート（以下、本文書）は、情報提供を目的としており、記述を利用した結果生じるいかなる損失についても、\n\n株式会社ラックは責任を負いかねます。\n\n本文書に記載された情報は初回掲載時のものであり、閲覧・提供される時点では変更されている可能性があることをご了承ください。\n\nLAC、ラック、サイバー救急センターは、株式会社ラックの商標または登録商標です。\n\nこの他、本文書に記載した会社名・製品名は各社の商標または登録商標です。\n\n表紙、裏表紙の写真は、skyseeker.net の著作物です。\n\n本文書を引用する際は出典元を必ず明記してください。\n\n本文書の一部または全部を著作権法が定める範囲を超えて複製・転載することを禁じます。\n\nⒸ 2018 LAC Co., Ltd. All Rights Reserved.\n\n###### 02\n\n\n-----\n\n第3 号/2018 春\n\n\n### はじめに\n\n#### 内田 法道\n\n株式会社ラック\n\nサイバー救急センター長\n\nサイバー救急センターでインシデント対応を支援させていただいた際の報告会などにおいて、最後にお\n\n客様からよくかけられる言葉があります。\n\n「支援ありがとうございました。ただ、内田さんとは、もう会わないようにしたい。」\n\n表現はお客様によって微妙に変わりますが、その意味するところは同じでして、二度とインシデントは発\n\n生させないという想いになります。\n\n私たちとしても想いは同じでして、「今後ともよろしくお願いいたします。」のような表現は、意図的に避\n\nけるようになりました。もちろんサイバー救急センターとしては、「便りがないのは良い便り」です。ただ、サイバ\n\nー空間の脅威は減ることはなく種類も多様化しており、お客様の担当者は変化する脅威と日々戦ってい\n\nるのが実情です。\n\nお客様の対応力を超えて私たちに「便り」があった際に、即時かつ適切にお客様を支援できるようサイ\n\nバー救急センターも日々備えています。\n\n最後になりますが、編集後記（P.19）にアンケートのお願いについて記載しています。ぜひ、本書の\n\n感想について皆様のご意見をお聞かせください。\n\n###### 03\n\n\n-----\n\n第3 号/2018 春\n\n### サイバー119 の出動傾向\n\n#### 2018 年1 月～3 月の出動傾向\n\nインターネットに公開しているサーバを対象とした不正侵入のインシデントが、引き続き増加傾向にあり\n\nます。\n\n不正侵入後の被害としては、引き続き「金銭」を狙ったビットコインやオルトコイン等の仮想通貨を発\n\n掘するソフトウェア（コインマイナー）がインストールされているインシデントが多く見られました。加えて、\n\nWeb サーバの不正侵入インシデントにおいては、閲覧者のリソースを利用して仮想通貨を発掘させるスク\n\nリプトが埋め込まれるインシデントも発生しています。\n\n不正侵入の原因としては、脆弱性の悪用などではなく、通信のアクセス制御の不備やアカウント管理\n\nの不備といった運用管理上のミスが増加しています。構築時には適切な管理状況であったものの、運用\n\n中に管理が甘くなってしまったサーバがないか、改めて確認してください。\n\nその他 **マルウェア**\n\n14% **19%**\n\n**APT** **ランサム**\n\n**その他** **4%** **6%** **不正送金**\n\n**14%** **2%**\n\n内部犯行 **その他**\n\n**8%**\n\n12% **内部犯行**\n\n**12%**\n\n**PF脆弱性 4%**\n\n**Webアプリ脆弱性**\n\n**4%**\n\n**ID不正利用**\n\n**18%**\n**その他**\n\n**29%**\n\nサーバ不正侵入\n\n55%\n\n**図1-1 2018 年1 月～3 月のインシデント傾向**\n\n###### 04\n\n|A 4|PT %|\n|---|---|\n\n\n**8%**\n\n**内部犯行**\n\n**12%**\n\n**PF脆弱性 4%**\n\n**Webアプリ脆弱性**\n\n**4%**\n\n**ID不正利用**\n\n**18%**\n**その他**\n\n**29%**\n\nサーバ不正侵入\n\n55%\n\n\nその他\n\n14%\n\n**その他**\n\n**14%**\n\n\nサーバ不正侵入\n\n55%\n\n\n**マルウェア**\n\n**19%**\n\n\n-----\n\n第3 号/2018 春\n\n#### マルウェア関連のインシデント傾向\n\nAdvanced Persistent Threat 攻撃（APT 攻撃）と推測されるインシデントの相談を、複数の組\n\n織から受けています。\n\n攻撃の手法としては、巧妙なやり取り型の標的型メール、認証サーバに対するブルートフォース攻撃が\n\n確認されています。しかし、標的にされたアカウント情報を攻撃者がどのように窃取したかは特定に至って\n\nいません。\n\nバラマキ型ウイルスメールのケースにおいては、企業内の全社員宛てにメールが送信されたというケース\n\nもあることから、攻撃者は定常的にターゲットとした企業のメールアドレスやアカウント情報を窃取する活動\n\nを行っていると考えられます。\n\n不正侵入の手法が巧妙になるに伴い、入口対策での侵入防御は困難になります。不正侵入される\n\nことを前提に、ネットワーク内部の通信のアクセス制御や、重要情報のセグメント分離といった対策を検討\n\nし、もし、不正侵入された場合においても、被害範囲を最小にするようにしてください。\n\n#### 公開サーバ関連のインシデント傾向\n\n2017 年10 月～12 月の期間から継続して、公開サーバの脆弱性を悪用して不正侵入した攻撃者\n\nが、コインマイナーを設置するインシデントの相談を複数受けています。また、Web サーバの閲覧者のPC\n\n上で仮想通貨を発掘するスクリプトを、Web コンテンツに埋め込むインシデントも発生しています。金銭を\n\n目的とした攻撃者グループの、金銭を獲得する方法が多様化しています。\n\n脆弱性を悪用する手法としては、WebLogic Server における任意コード実行の脆弱性(CVE-20\n\n17-10271)が2017 年12 月に引き続き発生していました。しかし、それ以上に、「通信のアクセス制御\n\n不備」と「アカウント管理の不備」が原因のインシデントが増加しています。\n\n特に、クラウド環境におけるサーバにおいては、通信のアクセス制御不備が多く見られ、簡単なパスワー\n\nドを設定してい場合には、サーバ構築後、数日で複数の攻撃者に侵入されて、重要情報の窃取、Web\n\nコンテンツの改ざん、マルウェアの設置といった被害が発生しています。\n\nクラウド環境を利用している場合は、以下の資料を参考に、特に「認証」、「アクセス制御」、「アカウン\n\n###### 05\n\n\n-----\n\n第3 号/2018 春\n\n\nト管理」の対応が十分にできているか、改めて確認することを推奨します。\n\n - 考：クラウドサービス安全利用のすすめ（IPA）\n\nhttps://www.ipa.go.jp/files/000011594.pdf\n\n - 考：クラウドコンピューティングのためのセキュリティガイダンス（CSA ジャパン）\n\nhttp://www.cloudsecurityalliance.jp/guidance.html\n\n###### 06\n\n\n-----\n\n第3 号/2018 春\n\n### 攻撃者の残した痕跡に学ぶ\n\nフォレンジック調査では、調査目的に応じてWeb閲覧履歴、USB接続履歴等様々な履歴を調査し\n\nますが、特にマルウェア感染事案においてはプログラム実行履歴の調査が重要です。マルウェアが実際に\n\n実行されたのかどうか、いつ実行されたのか、どのようなプログラムが動作したのか、などを調べることで感染\n\nによる影響範囲を評価するためです。\n\nプログラム実行履歴の調査に役立つアーティファクトには様々なものがありますが、有名なものは\n\nPrefetch（プリフェッチ）です。C:\\Windows\\Prefetch フォルダには実行ファイル毎にPF ファイル\n\n（.pf 拡張子のファイル）が存在し、実行されたプログラム名、ファイルパス、実行時の関連ファイル、実行\n\n時刻、実行回数などの情報が記録されています。\n\n**図2-1 PF ファイルのパース結果**\n\n上記はフォレンジックツールでPF ファイルの一つをパースした結果ですが、ユーザのデスクトップ上に存在\n\nしたPUTTY.EXE という実行ファイルが一回、2018 年1 月16 日09:31:45 に実行されていたことが\n\nわかります。PUTTY.EXE が調査時点で削除済みでもPF ファイルは残っているため1、この時刻が攻撃者\n\nの侵入時刻付近であれば、攻撃者が実行したと考えることができます。\n\nプログラム実行履歴に関するアーティファクトには、Prefetch の他にもAmcache（エーエムキャッシュ）\n\nと呼ばれるものがあります。Amcache はPrefetch と異なり、実行時刻は記録されていないのですが、実\n\n1 PF ファイルには個数の制限があり古いものから削除されるため、上書きされて残っていない場合や、サーバ系OS のようにPrefetch が\n\n無効になっておりPF ファイルが全く残っていない場合もある\n\n###### 07\n\n\n-----\n\n第3 号/2018 春\n\n行プログラムのSHA-1 ハッシュ値が記録されています。\n\n**図2-2 Amcache のパース結果**\n\n上記はフォレンジックツールでAmcache をパースをした結果ですが、PUTTY.EXE が削除済みの場\n\n合であっても、SHA-1 ハッシュ値を得ることができます。そのためVirusTotal のようなハッシュ値で検索で\n\nきるサービスを利用したり、各種ホワイトリスト、ブラックリストと照合することで、どのような実行ファイルだった\n\nのか調べるのに役立ちます。\n\n実際に、上記の例で挙げているPUTTY.EXE のハッシュ値をVirusTotal で検索してみると、多くのア\n\nンチウイルスソフトで悪性のファイルと検知されることがわかり、その検知名からファイル暗号機能を持つラン\n\nサムウェアの一種の可能性が高いと判断することができます。\n\nフォレンジック調査では、このように記録されている情報が異なるアーティファクトを複数組み合わせるこ\n\nとで侵害当時の状況を紐解き、侵害原因や影響範囲を特定することが可能になります。\n\n###### 08\n\n\n-----\n\n第3 号/2018 春\n\n### 脅威分析報告\n\n#### 新たなGolang マルウェアの発見\n\n###### (1)はじめに\n\nGoogle によって開発されたプログラミング言語 Go (以降、Golang)で作成されたマルウェア（以降、\n\nGolang マルウェア）といえば、IoT マルウェアであるMirai が有名ですが、サイバー救急センターの脅威分\n\n析チーム(CTT: Counter CyberThreat Team)は2018 年に入ってからサイバー救急センターが取り\n\n扱った事案において、クライアントPC やサーバ上で動作するGolang マルウェアの存在を確認しています。\n\nGolang には多様なライブラリが存在しており、複数のOS で動作するプログラムの実装やリファクタリングが\n\n比較的容易なため、今後もGolang マルウェアが増加すると考えています。今回は、弊社で「WellMess」\n\nと呼称している新たなGolang マルウェアの解析結果を紹介します。\n\n###### (2)Golang マルウェア「WellMess」の解析\n\n「WellMess」は、遠隔操作やファイルの転送などの機能を有しており、下記の特徴があります。\n\n**2.1** **文字列に関わる特徴**\n\nGolang で作成されたプログラムでは、ビルドする際に含まれる文字列が図3-1 のように連続した1 つ\n\nの文字列ブロックになっており、「\\x00」のようなNULL 文字区切りでは無いのが特徴的です。図3-1 の\n\n文字列ブロックを参照ごとに区切って見やすく整形したものが図3-2 です。図3-2 から、ハードコードされ\n\nたC2 サーバ、ユーザーエージェント、BASE64 でエンコードされたRC6 の鍵を確認できます。\n\n###### 09\n\n\n-----\n\n第3 号/2018 春\n\n**図3-1 連続した1 つの文字列ブロック例**\n\n**図3-2 連続した1 つの文字列ブロックを区切った後の文字列例**\n\nさらに、マルウェア内に含まれる文字列を調査すると、このマルウェアは「wellMess」、「UDFile」、\n\n「FromNormalToBase64」など、関数に特徴的な名称を使用していることが確認できます（図\n\n3-1）。その中の1 つである「wellMess」は「Wellcome Message」の略であると推測され、マルウェア\n\n作成者が考えた特徴的な関数名であると推測しています。この他、マルウェア内の文字列を調査すると\n\n「choise」など英語のスペルミスと考えられる名称も見受けられます。\n\n###### 10\n\n\n-----\n\n第3 号/2018 春\n\n**図3-3 「WellMess」の特徴的な関数名の例**\n\nまた、マルウェアがC2 コマンドを授受するために利用するタグ表現も特徴的です。タグ表現は、\n\n「<;service;>」、「<;head;>」といったようなXML 形式のタグに似た作りで、これらのタグがコマンドの\n\n識別に使用されます。図3-4 はタグのマッチングに使用される正規表現のルールです。\n\n**図3-4 タグの正規表現ルール**\n\n**2.2** **通信に関わる特徴**\n\n「WellMess」はHTTP のPOST リクエストを使用してC2 サーバとやり取りを行います。コマンド操作\n\nにはPOST リクエストにおけるCookie ヘッダのデータ、およびリクエストボディ内に含まれるデータの2 つを\n\n組み合わせて使用します。ファイル転送などのコマンドを識別する情報は、Cookie ヘッダに格納され、コマ\n\nンドの実行結果やファイルのペイロードは、主にPOST リクエストのボディ部分に情報が格納されます。\n\n図3-5 に「WellMess」とC2 サーバとのやり取りの流れを示します。\n\n###### 11\n\n\n-----\n\n第3 号/2018 春\n\n**図3-5 「WellMess」とC2 サーバとのやり取りの流れ**\n\n「WellMess」の特徴的な動作として、端末が感染した際の初期通信を2 段階に分けて発生させると\n\nいうものがあります。初期通信の1 段階目と2 段階目では、POST リクエストのボディ部分で送信される\n\n情報が異なっており、1段階目の通信ではランダムで生成されたAES鍵および初期ベクトル、2段階目の\n\n通信には端末情報が送信されます。このうち、1 段階目の初期通信を図3-6 に示します。\n\n**図3-6 初期通信の1 段目例**\n\n###### 12\n\n\n-----\n\n第3 号/2018 春\n\n「WellMess」が送信するデータの難読化については、CookieヘッダもPOSTリクエストのボディ部分に\n\n含まれるどちらのデータにおいても、「/」を「:」に、「+」を「,」に置換するという点が共通しています。以降で\n\nは、Cookie ヘッダおよびPOST リクエストのボディ部分に含まれるデータについて見ていきます。\n\n**2.2.1** **Cookie ヘッダに関わる特徴**\n\nCookie ヘッダに含まれるデータは「;」によって2 つのブロックに区切られており、「=」より前の文字列は\n\n使用されません。また、そのデータはハードコードされたRC6 の鍵を使用して暗号化されています。詳細は\n\n後述しますが、図3-6 の初期通信ではホスト名、ドメイン名、ユーザ名などの端末情報をC2 サーバに送\n\n信しています。\n\n図3-7 は、Cookie ヘッダに含まれる情報を復号する流れを示しています。復号したデータの中には、\n\n「<;head;>」や「<;service;>」といった前述の特徴的なタグ文字列が含まれていることを確認できま\n\nす。また、意図は不明ですが、データの末尾にはSHA256 ハッシュ値における空文字に相当する\n\n「e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855 」が\n\n格納されていることがわかります。\n\n**難読化解除（文字列置換)**\n\n**BASE64 および RC6 で復号**\n\n**図3-7 データ復号の流れ（Cookie ヘッダ）**\n\n**2.2.2** **POST リクエストのボディ部分に関わる特徴**\n\n「WellMess」は1 段階目の初期通信において、ランダムに生成されたAES 鍵、およびモードCBC で\n\n使用される初期ベクトルを、RSA 公開鍵によって暗号化してPOST リクエストのボディ部分に含めてC2\n\nサーバへ送信します。そして、初期通信以降のPOST リクエストのボディ部分のデータ（gzip により圧縮）\n\nは、このAES 鍵と初期ベクトルで暗号化されています。\n\n図3-8 では、POST リクエストのボディ部分のデータを復号する流れを示します。\n\n###### 13\n\n\n-----\n\n第3 号/2018 春\n\n**難読化解除（文字列置換）**\n\n**BASE64 および RSA で復号**\n\n**赤枠をBASE64 で復号**\n\n**図3-8 データ復号の流れ（POST リクエストのボディ部分）**\n\n**2.3** **コマンド実行に関わる特徴**\n\n遠隔からのコマンド実行に使用される特徴的な文字列のタグには、「<;service;> 」、\n\n「<;head;>」、「<;title;>」、「<;body;>」の4 種類が存在します。表3-1 にタグと機能の対応表を\n\n示します。このうち、「<;service;>」および「<;head;>」は、コマンドの識別に使用されます。\n\n**表3-1 タグと機能の対応表**\n\n**タグ** **コマンド** **機能**\n\n**<;head;>** C 「<;service;>」タグと共に使用される\n\nG コマンド待機\n\n**<;service;>** p AES 鍵などの再初期化を行う\n\nfu（※1） C2 サーバから感染PC へファイルを転送する\n\nfd 感染PC からC2 サーバへファイルを転送する\n\nm 一回あたりの通信の分割サイズの変更\n\nu ユーザーエージェントの変更\n\nhi 用途不明\n\n上記以外の場合（※2） 「cmd.exe」、「/bin/sh」などを指定し任意の操作実行\n\n**<;title;>（※3）** 分割通信の項番情報\n\n**<;body;>** コマンドに付加されるペイロード部分\n\n当該タグでペイロードを授受するか、POST リクエストのボディ\n\n部分でデータを授受するか2 通りの方法がある\n\n###### 14\n\n|タグ|コマンド|機能|\n|---|---|---|\n|<;head;>|C|「<;service;>」タグと共に使用される|\n||G|コマンド待機|\n|<;service;>|p|AES 鍵などの再初期化を行う|\n||fu（※1）|C2 サーバから感染PC へファイルを転送する|\n||fd|感染PC からC2 サーバへファイルを転送する|\n||m|一回あたりの通信の分割サイズの変更|\n||u|ユーザーエージェントの変更|\n||hi|用途不明|\n||上記以外の場合（※2）|「cmd.exe」、「/bin/sh」などを指定し任意の操作実行|\n|<;title;>（※3）||分割通信の項番情報|\n|<;body;>||コマンドに付加されるペイロード部分 当該タグでペイロードを授受するか、POST リクエストのボディ 部分でデータを授受するか2 通りの方法がある|\n\n\n-----\n\n第3 号/2018 春\n\n※1 パスを指定せずに、ただファイル名「test.txt」と指定して、ファイルを感染PCに転送した場合は、\n\nファイル名「upload.test.txt」というファイルが作成される。\n\n※2 「cmd.exe」や「/bin/sh」などを実行する場合は、下記正規表現のルールに従う。\n\nfileName:(?P<fn>.*?)\\sargs:(?P<arg>.*?)\\snotwait:(?P<nw>.*)\n\n「fileName:」は「cmd.exe」や「/bin/sh」といった文字列を指定します。「args:」は、実行ファ\n\nイルの引数を指定します。「notwait:」は、弊社で解析した「WellMess」において、空の文字\n\n列を入れることが前提のようです。\n\n例) fileName:cmd.exe␣args:ipconfig␣notwait:\n\n※3 「<;title;>」タグには、1 コマンドの通信が分割された場合の総通信回数、および、何番目の通\n\n信かを示す項番情報が入ります。例えば、「<;title;>a:1_0<;title;>」の場合は、通信は合\n\n計2 回に分けられて送信され、1 番目の通信を送信することを意味します。\n\n###### (3)おわりに\n\n今回は、Golang マルウェアの解析結果を紹介しました。攻撃者は積極的に新たなプログラミング言\n\n語を採用し、攻撃に活用していることが伺えます。これに対して防御側の組織は適切な検知ルールを作\n\n成し、マルウェア感染を防ぐまたは早期に発見する必要があります。今回紹介した解析結果が、プロキシ\n\nログやファイアウォールログにおける異常な通信の検出や、エンドポイント製品にて特徴的な文字列のマッ\n\nチング、不審なコマンドプロンプトの呼び出しなどの検出に活用していただければ幸いです。\n\n###### (4)IOC 情報\n\n**4.1** **「WellMess」のSHA-256 ハッシュ値**\n\nbec1981e422c1e01c14511d384a33c9bcc66456c1274bbbac073da825a3f537d\n\nf622d031207d22c633ccec187a24c50980243cb4717d21fad6588dacbf9c29e9\n\n**4.2** **「WellMess」の通信先**\n\n103.13.240[.]46\n\n191.101.180[.]78\n\n###### 15\n\n\n-----\n\n第3 号/2018 春\n\n\n### コラム：セキュリティ百景 #5\n\n\n#### IRDF オンライン講座\n\n2018 年3 月より、LAC セキュリティアカデミー\n\nで『IR DF(インシデントレスポンス デジタルフォレ\n\nンジック)演習ドリル』というオンラインコースを開始\n\nいたしました。\n\n主にマルウェアに関連した事案対応で利用で\n\nきるデジタルフォレンジック(DF)技術について扱う\n\nコースとなっています。DF 技術全般に関して、包\n\n括的に学ぶことを目的としたコースでは“なく”、あく\n\nまでインシデントレスポンスで必要となる基本的な\n\n技術情報を扱っています。\n\n受講者の方は、サンプルの仮想ディスクや、演\n\n習用ファイルをダウンロードしていただき、お手元の\n\n環境で手順について学んでいただく形式です。\n\nコース内では主にオープンソース系ツールを利\n\n用した方法をご説明しておりますが、ダウンロードし\n\nたサンプルのデータを利用し、任意のツールで解析\n\nしていただく事が可能です。\n\n動画には字幕を設定しておりますので、音声\n\nを出さずに視聴いただく事も可能です。\n\n\nまた、動画の内容と、補足説明を追加した内\n\n容をPDF 形式テキストで参照できるようにしてお\n\nります。\n\n現時点では、ファイルシステム基礎1～8 と、\n\n基本的な知識に関する部分を順次公開しており\n\nますが、コンテンツ自体は年間を通じてアップデー\n\nトされます。特に手順書は、ツール類のアップデー\n\nトに伴い変更が発生するケースがありますので、\n\n適宜対応していく予定です。\n\n従来のオープンコースでは、ご提供した資料を\n\n後から更新するといった事が出来ておりませんでし\n\nたが、オンラインコースの特徴を生かし常に最新版\n\nの資料を電子データでご提供できます。\n\nオンラインでどの様な内容が提供されているか\n\nご興味がある方は、無料体験コースも公開してお\n\nりますので、ぜひ下記URL からお申込みください。\n\nラックセキュリティアカデミー オンライン\n\nhttps://lac.etudes.jp/jp/\n\n最後に個人的な事となりますが、2018 年4\n\n月より、新設されたAdvanced Cyber Threat\n\nResearch Center(ACTR) Threat Hunting\n\nTeam(THT)へ異動しました。\n\nセキュリティアカデミーオンラインのIR DF コース、\n\nオープンコースのDF コースは、引き続き担当させ\n\nていただきますので、宜しくお願いいたします。\n\nAdvanced Cyber Threat Research Center\n\nThreat Hunting Team\n\n伊原 秀明\n\n###### 16\n\n\n-----\n\n第3 号/2018 春\n\n\n### コラム：セキュリティ百景 #6\n\n\n#### サンドボックス講座\n\n皆さんは、「サンドボックス」を利用したことはあ\n\nりますか。「サンドボックス」は、通常の利用環境か\n\nら隔離された疑似環境上で検証やテストを実施\n\nする仕組みを指しています。\n\nLAC セキュリティアカデミーでは、2017 年度よ\n\nり、マルウェア解析講座の一つとして「マルウェア解\n\n析ハンズオン入門コース実践編 ～サンドボックス\n\nを用いたマルウェア機能の解析～」講座を新たに\n\n開始しています。\n\n私は2018 年2 月8 日～9 日の二日間に\n\nわたって開催した当講座の講師を、担当しまし\n\nた。\n\n当講座では、無償で利用可能な「Cuckoo\n\nSandbox」を教材として、構築から解析までの利\n\n用方法を学んでいただきます。受講後、受講生\n\nがすぐに「サンドボックス」を実践で利用できるよう\n\nにカリキュラムを組んでおり、不審ファイルの挙動を\n\n読み解く事例解析に多くの時間を割り当て、解\n\n析ノウハウを学んでいただくことに重点を置いてい\n\nます。\n\n\n当日は「サンドボックス」を初めて使用する受\n\n講生が大半でしたが、二日間の講座で、受講生\n\nの皆さんが、効率よく解析結果を読み解いている\n\n様子を拝見して、「Cuckoo Sandbox」を使用\n\nした解析手順やノウハウを習得していただけたので\n\nはないかと感じています。\n\nマルウェア解析技術は、短期間で身につくもの\n\nではなく、長い学習と経験を重ねて習得します。\n\n「サンドボックス」は、このようなマルウェアの技術習\n\n得や解析時間を考慮することなく、不審なファイル\n\nを読み込ませるだけで、「一定時間」後、「自動\n\n的」に解析レポートを出力します。CEC においても、\n\nマルウェアによる通信先の特定、TTPs（作成ファ\n\nイル等の特定）等に「Cuckoo Sandbox」を利\n\n用しています。\n\n解析レポートを効率的に、かつ正確に読み解\n\nくことで、不審なファイルの機能を効果的に洗い出\n\nすことができます。（サンドボックス上で動作しない\n\nという解析結果もまた一つの特徴です）\n\nぜひ、不審ファイルなどの確認にご活用いただ\n\nければ幸いです。また、解析レポートの一例を次\n\nページに掲載しましたので、読者の皆さんも解析\n\nに挑戦してみてください。\n\n当講座の次回の開催は2018 年7 月18\n\n日～19 日を予定しております。皆さんに有意義\n\nな時間を過ごしていただけますよう準備し、お待ち\n\nしております。\n\nAdvanced Cyber Threat Research Center\n\nThreat Hunting Team\n\n芝村 崇\n\n\n###### 17\n\n\n-----\n\n第3 号/2018 春\n\n#### 解析レポートの例\n\n**例：CuckooSandbox から出力される解析レポートの一部を記載します。どのような不審なファイルが**\n\n動作したか、機能やマルウェア名を推測してみてください（回答は当頁の最後に記載しています）。\n\n図Summay は、解析時に変更されたファイル名です。\n\n図DNS は、解析時に発生したDNS への問い合わせ時に名前解決したホスト名とIP アドレスです。\n\n図Signature は、危険な振る舞いを検知したシグネチャの一覧です。\n\n図ScreenShot は解析処理時にサンドボックスが定期的に取得した画面キャプチャです。\n\n - **左：図Summary ／ 右：図DNS**\n\n - **左：図Signature ／ 右：図ScreenShot**\n\n※回答：ランサムウェア「CERBER」の解析結果となります。図Summary に暗号化されたファイル\n\n名、図DNS に攻撃サーバのホスト名、図Signature には機能、図ScreenShot には脅迫文（マ\n\nルウェア名を含む）が出力されています。サンドボックスを利用する利点として、検体の通信先からC2\n\nサーバのアドレスを特定し、組織内での影響範囲を迅速に調査することが可能となります。\n\n###### 18\n\n\n-----\n\n第3 号/2018 春\n\n### 編集後記\n\n読者の皆様にお伝えしたいコンテンツは色々とあるのですが、扱う内容がインシデントに関連する内容\n\nのため、どこまで記載するかいつも悩みながら編集しています。伝える事による価値と、機密保持による顧\n\n客の保護との狭間で、インシデント対応や脅威管理をしている方々へこれからも有用と思われる情報を\n\n提供し続けられたらと考えています。（法）\n\n最後になりますが、本号でもアンケートへのご協力をお願いいたします。\n\n#### アンケートのお願い\n\n今後のよりよい記事づくりの参考とさせていただくため、以下のURL またはQR コードから、アンケートに\n\n回答いただけると幸甚です。忌憚のないご意見・ご感想をお寄せください。\n\nhttps://jp.surveymonkey.com/r/2WKRCL3\n\n編集長 内田 法道\n\n編集者・執筆者 伊原 秀明、関 宏介、高松 啓、芝村 崇、Counter Cyber Threat Team\n\n###### 19\n\n\n-----\n\n第3 号/2018 春\n\n###### 株式会社ラック\n\n〒102-0093 東京都千代田区平河町 2-16-1 平河町森タワー\n\nE-MAIL: sales@lac.co.jp\n\nhttps://www.lac.co.jp/\n\n###### 20\n\n\n-----",
    "language": "JA",
    "sources": [
        {
            "id": "6fc23d14-23a6-4870-8fad-b291b182596f",
            "created_at": "2022-10-25T16:07:18.480113Z",
            "updated_at": "2022-10-25T16:07:18.480113Z",
            "deleted_at": null,
            "name": "ETDA",
            "url": "https://apt.etda.or.th",
            "description": "Threat Group Cards: A Threat Actor Encyclopedia",
            "reports": null
        },
        {
            "id": "bf5be533-fa31-4590-ae37-5761c97ffa34",
            "created_at": "2022-10-25T16:13:58.389257Z",
            "updated_at": "2022-10-25T16:13:58.389257Z",
            "deleted_at": null,
            "name": "Malpedia",
            "url": "https://malpedia.caad.fkie.fraunhofer.de",
            "description": "Malpedia is a free service offered by Fraunhofer FKIE",
            "reports": null
        }
    ],
    "references": [
        "https://www.lac.co.jp/lacwatch/pdf/20180614_cecreport_vol3.pdf"
    ],
    "report_names": [
        "20180614_cecreport_vol3.pdf"
    ],
    "threat_actors": [
        {
            "id": "6fbff48b-7a3e-4e54-ac22-b10f11e32337",
            "created_at": "2022-10-25T16:07:23.318008Z",
            "updated_at": "2025-03-27T02:02:09.734465Z",
            "deleted_at": null,
            "main_name": "APT 4",
            "aliases": [
                "APT 4",
                "Bronze Edison",
                "Maverick Panda",
                "Salmon Typhoo",
                "Sodium",
                "Sykipot",
                "TG-0623",
                "Wisp Team"
            ],
            "source_name": "ETDA:APT 4",
            "tools": [
                "Getkys",
                "Sykipot",
                "Wkysol",
                "XMRig"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1666716495,
    "ts_updated_at": 1743041139,
    "ts_creation_date": 1528909741,
    "ts_modification_date": 1558619470,
    "files": {
        "pdf": "https://archive.orkl.eu/1dfbec592268d6634dfc6864da48f41e3477b6ed.pdf",
        "text": "https://archive.orkl.eu/1dfbec592268d6634dfc6864da48f41e3477b6ed.txt",
        "img": "https://archive.orkl.eu/1dfbec592268d6634dfc6864da48f41e3477b6ed.jpg"
    }
}