{
    "id": "f6d7310f-f731-428b-b32c-1b266ce73024",
    "created_at": "2023-01-12T15:00:06.958446Z",
    "updated_at": "2025-03-27T02:05:33.90673Z",
    "deleted_at": null,
    "sha1_hash": "4afcaec83dd27f1f6b4235b1157e54c9f375d165",
    "title": "2021-02-16 - ApoMacroSploit- Apocalyptical FUD race",
    "authors": "",
    "file_creation_date": "2022-05-28T18:10:43Z",
    "file_modification_date": "2022-05-28T18:10:43Z",
    "file_size": 3931774,
    "plain_text": "# ApoMacroSploit : Apocalyptical FUD race\n\n**[research.checkpoint.com/2021/apomacrosploit-apocalyptical-fud-race/](https://research.checkpoint.com/2021/apomacrosploit-apocalyptical-fud-race/)**\n\nFebruary 16, 2021\n\n## 1.1   Introduction\n\n\nFebruary 16, 2021\n\n\nAt the end of November, Check Point Research detected a new Office malware builder\ncalled APOMacroSploit, which was implicated in multiple malicious emails to more than 80\ncustomers worldwide.\n\nIn our investigation, we found that this tool includes features to evade detection by Windows\nDefender and is updated daily to ensure low detection rates. In this article, we reveal the\nthreat actors’ malicious intentions and disclose the real identity of one attacker. We reported\nthis information to the relevant law enforcement authorities.\n\nThe malware infection begins when the dynamic content of the attached XLS document is\nenabled, and an XLM macro automatically starts downloading a Windows system command\nscript.\n\nBased on the number of customers and the lowest option price for this product, we estimate\nthat the two main threat actors made at least $5000 in 1.5 months, just by selling the\nAPOMacroSploit product\n\n\n-----\n\nWe followed multiple cases of attacks related to this tool, which we discuss here, and we\ndescribe a popular RAT used in this campaign to control the victim’s machine remotely and\nsteal information.\n\n## 1.2   The campaign\n\n_Figure 1: Graph of the total number of attacks_\nApproximately 40 different hackers are involved in this campaign, and utilize 100 different\nemail senders in the attacks. Overall, our telemetry reports attacks occurred in more than 30\ndifferent countries.\n\n## 1.3    The malicious document\n\nThe initial malicious document our customer received was an XLS file containing an\nobfuscated XLM macro called Macro 4.0. The macro is triggered automatically when the\nvictim opens the document, and downloads a BAT file from cutt.ly:\n\n_Figure 2: Malicious Macro4.o obfuscated_\n\n_Figure 3: Malicious Macro4.0 deobfuscated_\nThe execution of the command “attrib” enables the BAT script to hide in the victim’s machine.\nWe assume the reordering of the PowerShell instructions via the Start-Sleep command\n(visible after deobfuscation) is seen by the attacker as another static evasion.\n\n\n-----\n\n## 1.4   BAT file downloaded from cutt.ly website\n\nAt this stage of the attack, the attackers made a key mistake. The cutt[.]ly domain directly\nredirects to a download server and does not perform the request on the back end. These\nservers host the BAT files:\n\nFor each file, the nickname of the customer was inserted inside of the filename (the list can\nbe seen below).\n\n_Figure 4: hxxp://193[.]239[.]147[.]76/bat_\n\n_content_\nZombie99, seen in the file name, is the nickname of one of the attackers.\n\nFrom this, we obtained a list of all customers’ nicknames.\n\nCOLAFORCE1010 moonlight kingshakes\n\nZaiTsev motolux laudable\n\napo93 nitrix legranducki\n\nbambobimpel nullptr libinvip\n\nbawbaw pr3torian makaveli\n\nbayalbatros retroferon mcavy\n\nbirchfresh rroki123 mcdon\n\nboblarsers2 siemaziuta mcoode55\n\n\n-----\n\nborah silenthide mic12\n\nbtcjune skiw53 mikky\n\ncentank slipperynick xavierdev\n\ncovv somasekharraddyn zilla07\n\ncrownking spicytorben zombie99\n\ndanmill5241 t5samsung2020\n\ndemomode thecabal1 [[email protected]](https://research.checkpoint.com/cdn-cgi/l/email-protection#0563777c646b6176606969456268646c692b666a68)\n\nduksquad tozmac jew\n\nfrankie777 warlords jonathanandy77\n\nfteenetx xaa\n\n_Figure 5: List of customers_\n\nThe BAT script file checks which Windows version the victim has and downloads fola.exe if\nthe version is:\n\nWindows 10\nWindows 8.1\nWindows 8\nWindows 7\n\nIt adds the malware location in the exclusion path of Windows Defender, bypasses UAC and\nthen executes the malware.\n\n_Figure 6 : Bat File_\n\nIn addition, We also noticed some usage of rebrand[.]ly that redirects and download the bat\nfile from cdn.discordapp.com.\n\n## 1.5    APOMacroSploit\n\n\n-----\n\nWhen we searched for the usernames that were in the BAT file names, we found an\nadvertisement for a malware builder called APOMacroSploit. This is a macro exploit\ngenerator that allows the user to create an XLS file which bypasses AVs, Windows Defender,\nbypass AMSIs, Gmail and other mail phishing detection, and more.\n\nThis tool has a “WD disabler” option, which disables Windows Defender on the targeted\nmachine before executing the payload, and a “WD exclusion” option, which adds the file to\nWindows Defender so it can bypass WD as well.\n\nAPOMacroSploit administrators justified their AV bypass claim with links from a questionable\nwebsite: avcheck[.]net. Those links allege full none-detection (FUD) from AVs [Figure 7].\n\n_Figure 7: avcheck[.]net on XLS created by the APOMacroSploit_\nAPOMacroSploit is sold on HackForums.net by two users: Apocaliptique (Apo) and Nitrix.\n\nWe also found a Discord channel in which Nitrix is named as the tool developer and Apo is\nthe admin: https://discord.com/channels/764830353927569409/764832717267140629\n\n\n-----\n\n_Figure 8: Discord channel members_\n\nIn this channel, both Nitrix and Apocaliptique assist buyers with how to use the tool.\n\nMany of the customer nicknames visible on the download server were also found on the\nchannel.\n\n## 1.6   About the actors\n\nFor each customer, Apocaliptique and Nitrix created a BAT file to use in the attack (see the\nprocedure description below):\n\nThis screenshot shows that not only did these hackers sell their attack tools, but they also\nparticipated in building and hosting the malware.\n\n\n-----\n\n_Figure 9: Apo Bypass team helps their customers._\n\n_Figure 10: Apo Bypass owns the hosting server seen above_\nApocaliptique uses Apo Bypass YouTube channel to advertise his tool’s features.\n\n\n-----\n\n_Figure 11: Apo Bypass YouTube channel_\nAs you can see, this YouTube channel subscribes to 55 other YouTube channels. One of\nthese channels, called Ntx Stevy, attracted our attention because it has only 6 subscribers,\nincluding Apo Bypass.\n\n_Figure 12: Ntx Stevy YouTube channel_\n\n\n-----\n\nBy drilling down a bit more, we found an old Skype address for the NTx Stevy channel, in the\naccount name there is sequence of numbers, 93160, which is associated with a French area,\nSeine Saint Denis, and more specifically, Noisy-Le-Grand city.\n\n_Figure 13: Conversations inside the NTx Stevy YouTube channel_\nAnother channel also showed us some interesting data:\n\n_Figure 14: Conversations inside the NTx & Stevy YouTube channel_\nBut so far, there is no clear connection between Apo and Ntx Stevy.\n\nWe do, however, know that the developer of APOMacroSploit is called Nitrix.\n\nBy searching Nitrix’s conversations, we saw the following message:\n\n_Figure 15: Nitrix talking about LOL (League of Legends) on_\n\n_HackForums_\nSo here is the first link from Nitrix to NTx.\n\n\n-----\n\n_Figure 16: Nitrix tweeting his Skype account_\nIn this screenshot, it appears that the Skype account, we found before, on the YouTube\ncomment, is associated with this Twitter page.\n\nSo Ntx Stevy is actually Nitrix and plays LOL (League of Legends) using the same\nsummoner name! Nitrix and Apo even played games together:\n\n_Figure 17: Nitrix and Apocaliptique playing LOL (League of Legends) together_\nNow, the link becomes clear. This channel of 6 subscribers was followed by Apo because it\nbelonged to his friend, developer Nitrix.\n\nFinally, we found another Skype account (blurred in the picture) associated with Nitrix that\nconfirms what we already know.\n\n\n-----\n\n_Figure 18: Another_\n\n_Skype account associated with Nitrix_\nBy searching on Skype for Nitrix’s identity, we found his first name.\n\n_Figure 19: Nitrix Skype account_\n\nAfter digging in Nitrix Twitter account, we finally obtained his identity: he revealed his actual\nname when he posted a picture of a ticket he bought for a concert in December 2014:\n\n\n-----\n\n_Figure 20: Nitrix tweet_\n\nWe looked for this name on social media and found an account on Facebook, which had the\nsame picture. According to his Facebook account, Nitrix was indeed living in Noisy-LeGrand.\n\n_Figure 21:_\n\n_Nitrix Facebook account_\nWe tracked Nitrix LinkedIn page that shows where he studied and that he has 4 years’ worth\nof experience as a software developer.\n\n\n-----\n\n_Figure 22: Nitrix LinkedIn account_\nNow, let’s take a look at Apo, whose nickname in HackForums.net is “Apocaliptique.” Here\nwe can see Apo using this nickname and responding to questions about his product:\n\n_Figure 23: Apocaliptique’s answers to potential customers on HackForums_\nWe found out his Skype nickname: apocaliptique93.\n\n\n-----\n\nWe assume that Apocaliptique is a French resident like Nitrix. First, the language used in the\nadvertisement videos is French (figure 11). Moreover, the pseudo he used above is either\n“apo93” or “apocaliptique93“ and as seen above, “93” is a common suffix for French citizens\nliving in Seine Saint Denis.\n\n_Figure 24: Apocaliptique’s Skype nickname_\nWe also saw that he plays and sells League of Legends accounts with this nickname and\nSkype name.\n\n## 1.7   Example of APOMacroSploit usage by Mic12 :\n\nThis section describes in more detail an example of a popular second stage seen in several\nattacks related to this campaign.\n\n_Figure 25: Infection chain_\n**1.7.1    The Document**\n\n\n-----\n\nThe attacker sent via email with variety of subjects: поръчка за доставка (delivery order in\nBulgarian),\nbio tech inquiry, royal mail notification – 30/11/2020, boat inquiry.\n\nThe file names of the documents are corresponding to the email subject: spetsifikatsiya.xls,\nbiotech.xls, royalmail.xls, boat.xls\n\n_Figure 26: screenshot of the XLS malicious file_\n**1.7.2    Malware hosted server**\n\nOne of the BAT files downloads the malware from the following location:\nhxxp://XXXXXXXX/royal1/helper/gd/zt/fola[.]exe. This is a Bulgarian website for medical\nequipment and supplies.\n\n_Figure 27: Bulgarian website home page_\nThe website looks legitimate and might have been hacked by the attacker to store the\nmalware:\n\n\n-----\n\n_Figure 28: Malware stored on the Bulgarian website_\n**1.7.3    The Malware**\n\nThe malware in question is a DelphiCrypter followed by a BitRAT.\n\n**Anti-detection mechanisms**\n\nThe DelphiCrypter came with a number of anti-analysis techniques that didn’t fool our\nengines. Among them:\n\nA call of RtlAddVectorizedExceptionHandler followed by a division by 0 to generate a\ncrash to disrupt debuggers.\n\nCheck of the BeingDebugged flag.\n\nQueryInformationProcess call with the argument 0h1E / 0h1F to search for debuggers.\n\n\n-----\n\nA search for the keywords « sample », « malware » or « sandbox » in the path location\nof the malware. If found, the execution stops.\n\nSearch for a set of antivirus or analysis programs. If they are running, the execution\nstops :\n\nList of antiviruses and analysis programs:\n\nAvast\n\nAvastui.exe\nAvastsvc.exe\nAswidsagent.exe\nkaspersky\n\nAvgsvc.exe\nAvgui.exe\nAVP\n\nAvp.exe\nBit Defender\n\nBdwtxag.exe\nBdagent.exe\n\n\n-----\n\nWindows Defender\n\nMsmpeng\nMpcmdrun\nNissrv.exe\nDr Web\n\nDwengine.exe\nESET\n\nEquiproxy\nEkrn\nAnalysis tools\n\nProcexp.exe\nWindbg.exe\nProcmon.exe\nOllydbg.exe\n\nMultiple delays of the malware execution.\n\n**Persistency**\n\nA Notepad.exe injected shellcode drops a VBS file in the startup folder to ensure the\nmalware persistency.\n\n_Figure 29: VBS file in the startup folder_\n\n_Figure 30: Content of the VBS dropped file_\nThen, the notepad shellcode starts the malicious ernm.exe.\n\n_Figure 31: Duplicate the malware at the persistence path_\n\n\n-----\n\nThis ernm.exe malware is statically identical to fola.exe. During its execution, it compares its\npath with %appdata%/Roaming/rtgb/ernm.exe. If it is equal, it unpacks itself to a BitRAT.\n(MD5 : B6AD351A3EA35CAE710E124021A77CA8)\n\nFigure 32: BitRAT\n\nadvertisement\n\n_Figure 33: Example of BitRAT Attacker dashboard_\nThe BitRAT functionalities include:\n\n\n-----\n\nSSL encryption\nXMR mining\nWebcam hacking\nRemote control\nKeylogging\nDownload and upload of files\nCompatibility with TOR\n\n### 1.7.4    The C&C\n\nThe C&C of this malware is located at the following IP: 185[.]157[.]161[.]109\n\nThis IP was resolved to a domain, which is a sub domain of a legitimate Bulgarian website\nfor video surveillance systems.\n\n_Figure 34: The Bulgarian website_\n\n## 1.8   Protections\n\nCheck Point customers are protected against this attack.\n\n[SandBlast Network](https://www.checkpoint.com/products/advanced-network-threat-prevention/)\n\nTrojan.Wind.Generic.A/H/F\nRAT.Win.BitRat.A\nSignature_xlm_char_macro_4\nSignature_xlm_macro_4_concat_exec\nAP.malicious.xls.a\n\n## 1.9   IOCs\n\n**Document:**\n\n37951f4d601c647c284a431b582f5aebc3d0e13e\n\n\n-----\n\n0f7901078941f167b318f4fb37349503ec62b45d\ne4b03e2689bf54d97195c4b1bf94d7e047fb0926\ne56157faa2d9c5c9a0a30f321b442794860576e0\n2b753299c8824cc1dd0c48c2552e67df2db0800a\n583e84e1376147dfc21bab53026cd2bd0250dca5\ne14e89d16fb6632659ffe2bb2b8b82741ace5478\nfea838fecb16a23717429f25967b5d9f21b9b5f8\n4e6c98140eeb64351740e7b62e6863659abbb591\ncdb97b35bdedcb6318cf6ed11b706a12df2e95be\nd05bb0a47b5f43ae9c2ffd72c9245ee6675bc798\nee5dc839a6565d26b6eb8d07744c4886f646721d\nf8f92986f49a19f58a3114a19f4c0af48ab59e43\n1d884a8beb4f84a6a5fb12dd9d3b3ff3108b6874\n6ebb625de65f3a8ce66122d10dcccdfad8cdf5d6\nd529134cdf6837081ead1219a74128e5ccb31ce9\n6cb9af64cb0c86ca2238e01d1452b9d6513b7ea3\n9529b21240d9986c32527a589d38029c608dd253\n433144bc02374a186ffcb91d3beaabcba0cd160d\nc3b19195228f75b437a9c5b3df2028df1b1cbdc5\neca08346b447fc927fdad8cc944178e85c83496a\n129226d22bb541495ff427e9f4a421cb09557a12\n9809ea270285d08732dacc3ca572d9d272fec6fa\n1982ba2694cd6b25bb057f89b29ded8225c997cd\n0f7901078941f167b318f4fb37349503ec62b45d\n0b6cb46c92dbb0075f2524c8397e44236c37eebd\n25ed4d9fca33c1ccdf6b6a6793df14d2e07e5e97\n3a4e2469a56dcd0b9a287f8bde8be78aec6ab397\n\n**Malwares:**\n\na359796eacef161e75ce3f5094e1dd2bff37389c\n9a8b2be1f45b4d3d5a9a772ce45a01caa0a1b6e2\n\n**C&Cs:**\n\n185[.]157[.]161[.]109\n185[.]57[.]162[.]81\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-02-16 - ApoMacroSploit- Apocalyptical FUD race.pdf"
    ],
    "report_names": [
        "2021-02-16 - ApoMacroSploit- Apocalyptical FUD race.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673535606,
    "ts_updated_at": 1743041133,
    "ts_creation_date": 1653761443,
    "ts_modification_date": 1653761443,
    "files": {
        "pdf": "https://archive.orkl.eu/4afcaec83dd27f1f6b4235b1157e54c9f375d165.pdf",
        "text": "https://archive.orkl.eu/4afcaec83dd27f1f6b4235b1157e54c9f375d165.txt",
        "img": "https://archive.orkl.eu/4afcaec83dd27f1f6b4235b1157e54c9f375d165.jpg"
    }
}