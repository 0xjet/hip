{
    "id": "3b6b40de-334c-4033-bc76-05aa05411166",
    "created_at": "2023-01-12T15:05:33.247456Z",
    "updated_at": "2025-03-27T02:05:52.183172Z",
    "deleted_at": null,
    "sha1_hash": "0db5d386c172964bd472a8d5583827929c589d35",
    "title": "2022-03-09 - Daxin Backdoor- In-Depth Analysis, Part Two",
    "authors": "",
    "file_creation_date": "2022-05-28T23:22:50Z",
    "file_modification_date": "2022-05-28T23:22:50Z",
    "file_size": 1103802,
    "plain_text": "# Daxin Backdoor: In-Depth Analysis, Part Two\n\n**[symantec-enterprise-blogs.security.com/blogs/threat-intelligence/daxin-backdoor-espionage-analysis](https://symantec-enterprise-blogs.security.com/blogs/threat-intelligence/daxin-backdoor-espionage-analysis)**\n\nThreat Hunter TeamSymantec\n\n## In the second of a two-part series of blogs, we examine the communications and networking features of Daxin.\n\nThis is the concluding part of our in-depth analysis of Backdoor. Daxin, advanced malware\nthat is being used by a China-linked espionage group.\n\nIn this blog, we will analyze the communications and network features of the malware.\n\n## Communications protocol\n\nIn our [previous blog, we set up a lab consisting of four separate networks and five machines.](https://symantec-enterprise-blogs.security.com/blogs/threat-intelligence/daxin-malware-espionage-analysis)\nSome of the machines had two network interfaces to communicate with different networks,\nbut all packet forwarding functionality was disabled. Each machine ran various network\nservices that were reachable from its neighbors only.\n\n\n-----\n\nFigure 1. Test setup to illustrate Daxin’s backdoor capabilities.\nIn this section we will dissect the network traffic between two backdoor instances running on\nthe separate computers “Alice-PC” and “Bob-PC”. The traffic was initiated by the Daxin\nbackdoor running on “Alice-PC” when it was instructed to create a communication channel to\n“Dave-PC” passing via two intermediate nodes, “Bob-PC” and “Charlie-PC”, as described\npreviously.\n\n\n-----\n\nFigure 2. Wireshark capture of traffic between two backdoor instances. The screenshot and\nexamples below are reused from a private report prepared by us that discussed an earlier\nsample, so certain details may not match.\nUsing Wireshark, we captured traffic between two backdoor instances, one running on “AlicePC” and the other on “Bob-PC”, as shown in Figure 2.\n\n\n-----\n\nStarting with the key exchange, all backdoor communication is carried out by exchanging\nmessages that follow the same underlying format:\n\nThe magic value is always 0x9910 or 0x9911.\n\nThe kind value identifies the state transition during key exchange. Then, once the encrypted\ncommunication channel is established, it encodes the purpose of each message and\ndetermines the formatting of the data that follows the fixed-size header.\n\nThe initial message of the key exchange in the Wireshark capture is not encrypted:\n\nIt can be decoded as follows:\n\nThe fields magic and kind correspond to the first three bytes of TCP data, 0x10 0x99 0x11.\nOn the target computer, in case it is infected with a copy of the malicious driver, this\nsequence causes the TCP connection to be hijacked, as explained in part one of this blog\nseries.\n\nThe target checks that the received message is valid according to the session state machine,\nensuring that magic is the expected constant 0x9910 and kind matches any of two supported\nvalues: 0x10 or 0x11. Next, it generates a nonce to use when encrypting any future incoming\nmessages. Finally, it sends a response message with the nonce, its own details, and the\ninformation about the infected machine.\n\nParts of the response message are encrypted using a combination of the following\nalgorithms:\n\nThe details of this response message are as follows:\n\nThe message includes the backdoor login that is recognized during the following key\nexchange step, and what looks like malware build and version numbers.\n\nLooking at the decoded message, we find references to “XRT” and these reassemble the\nhardcoded Name “NDISXRPT” that we documented when discussing the\n_NdisRegisterProtocol() call during driver initialization:_\n\nThe initiator responds with the backdoor login and hashed password:\n\n## Want to comment on this post?\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-03-09 - Daxin Backdoor- In-Depth Analysis, Part Two.pdf"
    ],
    "report_names": [
        "2022-03-09 - Daxin Backdoor- In-Depth Analysis, Part Two.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673535933,
    "ts_updated_at": 1743041152,
    "ts_creation_date": 1653780170,
    "ts_modification_date": 1653780170,
    "files": {
        "pdf": "https://archive.orkl.eu/0db5d386c172964bd472a8d5583827929c589d35.pdf",
        "text": "https://archive.orkl.eu/0db5d386c172964bd472a8d5583827929c589d35.txt",
        "img": "https://archive.orkl.eu/0db5d386c172964bd472a8d5583827929c589d35.jpg"
    }
}