{
    "id": "32b25185-0c99-4d5a-beb1-e82ceac16b16",
    "created_at": "2023-01-12T15:10:32.136435Z",
    "updated_at": "2025-03-27T02:05:40.148138Z",
    "deleted_at": null,
    "sha1_hash": "b1e630e7b26ccbcbadf4dc92609732515e4f6a53",
    "title": "2020-11-19 - Hiding in the Noise",
    "authors": "",
    "file_creation_date": "2022-05-28T23:41:31Z",
    "file_modification_date": "2022-05-28T23:41:31Z",
    "file_size": 144113,
    "plain_text": "# Hiding in the Noise | Corey Thuen\n\n**ioactive.com/guest-blog-hiding-in-the-noise-corey_thuen/**\n\nGreetings! I’m Corey Thuen. I spent a number of years\nat Idaho National Laboratory, Digital Bond, and IOActive\n(where we affectionately refer to ourselves as pirates,\nhence the sticker). At these places, my job was to find 0day vulnerabilities on the offensive side of things.\n\n\nNovember 19, 2020\n\n\nNow, I am a founder of [Gravwell, a data analytics](https://www.gravwell.io/)\nplatform for security logs, machine, and network data.\nIt’s my background in offensive security that informs my\nnew life on the defensive side of the house. I believe that\ndefense involves more than looking for how threat actor\nXYZ operates, it requires an understanding of the\nenvironment and maximizing the primary advantage that\ndefense has—this is your turf and no one knows it like\n[you do. One of my favorite quotes about security comes from Dr. Eugene Spafford at Purdue](https://www.cs.purdue.edu/people/faculty/spaf)\n(affectionately known in the cybersecurity community as “Spaf”) who said, “A system is good\nif it does what it’s supposed to do, and secure if it doesn’t do anything else.” We help our\ncustomers use data to make their systems good and secure, but for this post let’s talk bad\nguys, 0-days, and hiding in the noise.\n\nA very important part of cybersecurity is threat actor analysis and IOC generation. Security\npractitioners benefit from knowledge about how adversary groups and their toolkits behave.\nHaving an IOC for a given vulnerability is a strong signal, useful for threat detection and\nmitigation. But what about for one-off actors or 0-day vulnerabilities? How do we sort through\nthe million trillion events coming out of our systems to find and mitigate attacks?\n\nIOActive has a lot of great folks in the pirate crew, but at this point I want to highlight a prepandemic talk from Jason Larsen about actor inflation. His thesis and discussion are both\n[interesting and hilarious; the talk is certainly worth a watch. But to tl;dr it for you, APT groups](https://youtu.be/UQceYzbhOkA?t=1325)\nare not the only attackers interested in, or capable of, compromising your systems. Not by a\nlong shot.\n\nWhen I was at IOActive (also Digital Bond and Idaho National Laboratory), it was my job as a\nvulnerability researcher to find 0-days and provide detailed technical write-ups for clients so\nvulnerabilities could be discovered and remediated. It’s this work that gives me a little\ndifferent perspective when it comes to event collection and correlation for security purposes.\nI have a great appreciation for weak signals. As an attacker, I want my signals to the\n\n\n-----\n\ndefenders to be as weak as possible. Ideally, they blend into the noise of the target\nenvironment. As a defender, I want to filter out the noise and increase the fidelity of attacker\nsignals.\n\n## Hiding in the Data: Weak Signals\n\nWhat is a weak signal? Let’s talk about an example vulnerability in some ICS equipment.\nExploiting this particular vulnerability required sending a series of payloads to the equipment\nuntil exploitation was possible. Actually exploiting the vulnerability did not cause the device to\ncrash (which often happens with ICS gear), nor did it cause any other obvious functionality\nissues. However, the equipment would terminate the network communication with an RST\npacket after each exploit attempt. Thus, one might say an IOC would be an “unusual number\nof RST packets.”\n\nNow, any of you readers who have actually been in a SOC are probably painfully aware of\nthe problems that occur when you treat weak signals as strong signals. Computers do weird\nshit sometimes. Throw in users and weird shit happens a lot of the time. If you were to set up\nalerts on RST packet indicators, you would quickly be inundated; that alert is getting\nswitched off immediately. This is one area where AI/ML can actually be pretty helpful, but\nthat’s a topic for another post.\n\nThe fact that a given cyber-physical asset has an increased number of RST packets is a\nweak signal. Monitoring RST packet frequency itself is not that helpful and, if managed\npoorly, can actually cause decreased visibility. This brings us to the meat of this post:\n**_multiple disparate weak signals can be fused into a strong signal._**\n\n\n-----\n\nLet s add in a fictitious attacker who has a Metasploit module to exploit the vulnerability I just\ndescribed. She also has the desire to participate in some DDoS, because she doesn’t\nactually realize that this piece of equipment is managing really expensive and critical\nindustrial processes (such a stretch, I know, but let’s exercise our imaginations). Once\nexploited, the device attempts to communicate with an IP address to which it has never\ncommunicated previously—another weak signal. Network whitelisting can be effective in\ncertain environments, but an alert every time a whitelist is violated is going to be way way too\nmany alerts. You should still collect them for retrospective analysis (get yourself an analytics\nplatform that doesn’t charge for every single event you put in), but every network whitelist\nchange isn’t going to warrant action by a human.\n\nAs a final step in post-exploitation, the compromised device initiates multiple network sockets\nto a slack server, above the “normal” threshold for connection counts coming out of this\ndevice on a given day. Another weak signal.\n\nSo what has the attacker given a defender? We have an increased RST packet count, a\npost-exploitation download from a new IP address, and then a large uptick in outgoing\nconnections. Unless these IP addresses trigger on some threat list, they could easily slide by\nas normal network activity hidden in the noise.\n\nAn analyst who has visibility into NetFlow and packet data can piece these weak signals\ntogether into a strong signal that actually warrants getting a human involved; this is now a\nthreat hunt. This type of detection can be automated directly in an analytics platform or\nconducted using an advanced IDS that doesn’t rely exclusively on IOCs. When it comes to\ncybersecurity, the onus is on the defender to fuse these weak signals in their environment.\nOut-of-the-box security solutions are going to fail in this department because, by nature, they\nare built for very specific situations. No two organizations have exactly the same network\narchitecture or exactly the same vendor choices for VPNs, endpoints, collaboration software,\netc. The ability to fuse disparate data together to create meaningful decisions for a given\norganization is crucial to successful defense and successful operations.\n\n## Hiding Weak Signals in Time\n\nOne other very important aspect of weak signals is time. As humans, we are particularly\nsusceptible to this problem but the detection products on the market face challenges here\ntoo. A large amount of activity or a large change in a short amount of time becomes very\napparent. The frame of reference is important for human pattern recognition and anomaly\ndetection algorithms. Just about any sensor will throw a “port scan happened” alert if you\n`nmap -T5 -p- 10.0.0.1-255.` What about if you only send one packet per second? What\nabout one per day? Detection sensors encounter significant technical challenges keeping\ncontext over long periods of time when you consider that some organizations are generating\nmany terabytes of data every day.\n\n\n-----\n\nAn attacker willing to space activity out over time is much less likely to be detected unless\ndefenders have the log retention and analytics capability to make time work for defense.\nPlatforms like Gravwell and Splunk were built for huge amounts of time series data, and\nthere are open-source time series databases, like InfluxDB, that can provide these kinds of\n[time-aware analytics. Key/value stores like ELK can also work, but they weren’t explicitly](https://www.elastic.co/blog/elasticsearch-as-a-time-series-data-store)\n[built for time series, and time-series-first is probably necessary at scale. It’s also possible to](https://www.gravwell.io/blog/benchmarking-gravwell)\ndo these kinds of time-based data science activities using Python scripts, but I wouldn’t\nrecommend it.\n\n## Conclusion\n\nComing from a background in vulnerability research, I understand how little it can take to\ncompromise a host and how easily that compromise can be lost in the noise when there are\nno existing, high-fidelity IOCs. This doesn’t just apply to exploits, but also lost credentials and\nuser behavior.\n\nRelying exclusively on pre-defined IOCs, APT detection mechanisms or other “out-of-thebox” solutions causes a major gap in visibility and gives up the primary advantage that you\nhave as a defender: this is your turf. Over time, weak signals are refined and automated\nanalysis can be put in place to make any attacker stepping foot into your domain stand out\nlike a sore thumb.\n\nData collection is the first step to detecting and responding to weak signals. I encourage\norganizations to collect as much data as possible. Storage is cheap and you can’t know\nahead of time which logfile or piece of data is going to end up being crucial to an\ninvestigation.\n\nWith the capability to fuse weak signals into a high-fidelity, strong signal on top of pure strong\nsignal indicators and threat detection, an organization is poised to be successful and make\nsure their systems “do what they’re supposed to do, and don’t do anything else.”\n\n_-Corey Thuen_\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2020/2020-11-19 - Hiding in the Noise.pdf"
    ],
    "report_names": [
        "2020-11-19 - Hiding in the Noise.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673536232,
    "ts_updated_at": 1743041140,
    "ts_creation_date": 1653781291,
    "ts_modification_date": 1653781291,
    "files": {
        "pdf": "https://archive.orkl.eu/b1e630e7b26ccbcbadf4dc92609732515e4f6a53.pdf",
        "text": "https://archive.orkl.eu/b1e630e7b26ccbcbadf4dc92609732515e4f6a53.txt",
        "img": "https://archive.orkl.eu/b1e630e7b26ccbcbadf4dc92609732515e4f6a53.jpg"
    }
}