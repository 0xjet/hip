{
    "id": "16e0365a-7341-4325-b5d8-5af17810724f",
    "created_at": "2023-01-12T14:59:06.997263Z",
    "updated_at": "2025-03-27T02:16:34.99547Z",
    "deleted_at": null,
    "sha1_hash": "8b2af98bd5344d3e54dbba50a5f9b3092c4c8d41",
    "title": "2020-12-16 - SUNBURST- SolarWinds Supply-Chain Attack",
    "authors": "",
    "file_creation_date": "2022-05-28T15:54:14Z",
    "file_modification_date": "2022-05-28T15:54:14Z",
    "file_size": 356194,
    "plain_text": "# SUNBURST: SolarWinds’ Supply-Chain Attack\n\n**cyborgsecurity.com/blog/sunburst-solarwinds-supply-chain-attack/**\n\n## Threat Detection Packages\n\n**SUNBURST Known Malicious DNS Activity**\n\n- Splunk\n\n- Elastic Lucene\n\n- Elastic DSL\n\n**SUNBURST Suspicious Processes for SolarWinds Orion Software**\n\n- Splunk\n\n- Elastic Lucene\n\n- Elastic DSL\n\n**SUNBURST Named Pipe Indicator**\n\n- Splunk\n\n- Elastic Lucene\n\n- Elastic DSL\n\n## Introduction\n\n\nDecember 16, 2020\n\n\nLast week FireEye shared that they experienced unauthorized access and theft of their offensive\nsecurity tools used by their red team, by a sophisticated state-sponsored adversary. Although the theft of these\nsophisticated tools will have an impact on future attacks carried out by the adversary, how they accessed the tools\nwas a much bigger problem. Over the weekend FireEye shared more details of their compromise and broke the\nnews that they fell victim to a supply-chain attack involving the IT services company SolarWinds. FireEye reported\nthe SolarWinds Orion software update had a backdoor injected into its code, which SolarWinds believed to have\nbeen included in updates released between March and June 2020. It should be noted, however, that some\nresearchers have reported [seeing activity as early as late 2019. The backdoor was dubbed SUNBURST by](https://www.volexity.com/blog/2020/12/14/dark-halo-leverages-solarwinds-compromise-to-breach-organizations/)\nFireEye.\n\nThis supply-chain attack still has an unknown impact. According to SolarWinds’ website their\ncustomers include many U.S. Government agencies, as well as a significant percentage of the Fortune\n500. According to [a recent filing with the US Securities and Exchange Commission (SEC) it is estimated that at](https://www.sec.gov/ix?doc=/Archives/edgar/data/1739942/000162828020017451/swi-20201214.htm)\nleast 18,000 installed the malicious update.\nDue to the nature of the attack, including the supply-chain compromise, the actor’s extreme attention to detail and\noperational security, as well as the high-profile targets who were successfully compromised as a result of the\nattack, it is suspected that it was conducted by a nation-state sponsored\ngroup. [Volexity researchers have attributed this attack to a threat actor under the name of Dark Halo, whom they](https://www.volexity.com/blog/2020/12/14/dark-halo-leverages-solarwinds-compromise-to-breach-organizations/)\nhave been tracking since late 2019.\n\nSUNBURST, the implant delivered via the backdoored SolarWinds Orion update, was found in one of the DLL files\ncontained in the update, specifically “SolarWinds.Orion.Core.BusinessLayer.dll”. According to [FireEye, the](https://www.fireeye.com/blog/threat-research/2020/12/evasive-attacker-leverages-solarwinds-supply-chain-compromises-with-sunburst-backdoor.html)\nbackdoor has a dormant period of up to two weeks, and then will attempt to resolve a subdomain\nof avsvmcloud[.]com, which will return a DNS CNAME record pointing to a command and control (C2) domain. We\n[go into detail on the functionality of SUNBURST in our Cyborg Labs Threat Hunt Deep Dive, in which we review](https://www.cyborgsecurity.com/cyborg_labs/threat-hunt-deep-dives-solarwinds-supply-chain-compromise-solorigate-sunburst-backdoor/)\nthe SolarWinds supply-chain compromise, and examine the SUNBURST implant and how it behaves in an\nenvironment.\n\n\n-----\n\n## UPDATE: 17 December 2020\n\nWe are releasing 3 threat detection packages that will allow organizations to detect SUNBURST activity in their\nenvironment.\n\n## Threat Detection Packages\n\n SUNBURST Known Malicious DNS Activity\n\n**Splunk**\n\n(query_type IN (“CNAME”,”A”) AND (query=”*avsvmcloud.com” OR answer=”*avsvmcloud.com”)) OR\n(query_type=”A” AND query IN (“deftsecurity.com”,”freescanonline.com”, “thedoccloud.com”, “websitetheme.com”,\n“highdatabase.com”, “incomeupdate.com”, “databasegalore.com”, “panhardware.com”, “zupertech.com”,\n“freescanonline.com”, “deftsecurity.com”, “thedoccloud.com”))\n\n| stats values(_time) as occurrences count by src, query, query_type, answer\n\n| convert ctime(occurrences)\n\n**Elastic Lucene**\n\n((dns.question.name:”/.*avsvmcloud\\\\.com/” or dns.answer.name:”/.*avsvmcloud\\\\.com/”) and\n(dns.question.type:”/[Cc][Nn][Aa][Mm][Ee]|[Aa]/” or dns.answer.type:”/[Cc][Nn][Aa][Mm][Ee]|[Aa]/”)) or\n(dns.question.name:(“deftsecurity.com” or “freescanonline.com” or “thedoccloud.com” or “websitetheme.com” or\n“highdatabase.com” or “incomeupdate.com” or “databasegalore.com” or “panhardware.com” or “zupertech.com” or\n“freescanonline.com” or “deftsecurity.com” or “thedoccloud.com”) and (dns.question.type:”/[Aa]/” or\ndns.answer.type:”/[Aa]/”))((dns.question.name:”/.*avsvmcloud\\\\.com/” or dns.answer.name:”/.*avsvmcloud\\\\.com/”)\nand (dns.question.type:”/[Cc][Nn][Aa][Mm][Ee]|[Aa]/” or dns.answer.type:”/[Cc][Nn][Aa][Mm][Ee]|[Aa]/”)) or\n(dns.question.name:(“deftsecurity.com” or “freescanonline.com” or “thedoccloud.com” or “websitetheme.com” or\n“highdatabase.com” or “incomeupdate.com” or “databasegalore.com” or “panhardware.com” or “zupertech.com” or\n“freescanonline.com” or “deftsecurity.com” or “thedoccloud.com”) and (dns.question.type:”/[Aa]/” or\ndns.answer.type:”/[Aa]/”))\n\n**Elastic DSL**\n\n\n-----\n\n```\n{\n \"bool\": {\n  \"should\": [\n   {\n    \"bool\": {\n     \"must\": [\n      {\n       \"query_string\": {\n        \"fields\": [\n         \"dns.question.type\",\n         \"dns.answer.type\"\n        ],\n        \"query\": \"/[Cc][Nn][Aa][Mm][Ee]|[Aa]/\"\n       }\n      },\n      {\n       \"query_string\": {\n        \"fields\": [\n         \"dns.question.name\",\n         \"dns.answers.name\"\n        ],\n        \"query\": \"/.*avsvmcloud\\\\.com/\"\n       }\n      }\n     ]\n    }\n   },\n   {\n    \"bool\": {\n     \"filter\": [\n      {\n       \"terms\": {\n        \"dns.question.name\": [\n         \"deftsecurity.com\",\n         \"freescanonline.com\",\n         \"thedoccloud.com\",\n         \"websitetheme.com\",\n         \"highdatabase.com\",\n         \"incomeupdate.com\",\n         \"databasegalore.com\",\n         \"panhardware.com\",\n         \"zupertech.com\",\n         \"freescanonline.com\",\n         \"deftsecurity.com\",\n         \"thedoccloud.com\"\n        ]\n       }\n      }\n     ],\n     \"must\": [\n      {\n       \"query_string\": {\n        \"fields\": [\n         \"dns.answer.type\",\n         \"dns.question.type\"\n        ],\n        \"query\": \"/[Aa]/\"\n       }\n      }\n     ]\n    }\n   }\n  ]\n }\n}\n\n## SUNBURST Suspicious Processes for SolarWinds Orion Software\n\n```\n\n-----\n\n**Splunk**\n\nindex=sysmon sourcetype=”sysmon:xml” ParentImage = “SolarWinds.BusinessLayerHost.exe” AND NOT Image\nIN (“*\\\\SolarWinds\\\\Orion\\\\APM\\\\APMServiceControl.exe”,\n“*\\\\SolarWinds\\\\Orion\\\\ExportToPDFCmd.Exe”,”*\\\\SolarWinds.Credentials\\\\SolarWinds.Credentials.Orion.WebApi.exe”,\n“*\\\\SolarWinds\\\\Orion\\\\Topology\\\\SolarWinds.Orion.Topology.Calculator.exe”, “*\\\\SolarWinds\\\\Orion\\\\DatabaseMaint.exe”, “*\\\\SolarWinds.Orion.ApiPoller.Service\\\\SolarWinds.Orion.ApiPoller.Service.exe”,\n“*\\\\Windows\\\\SysWOW64\\\\WerFault.exe”)\n\n| stats values(_time) as occurrences, values(Image) as ChildProcesses, values(CommandLine) as CommandLines\ncount by host, ParentImage\n\n| convert ctime(occurrences)\n\n**Elastic Lucene**\n\nparent.process.executable:”/.*[Ss][Oo][Ll][Aa][Rr][Ww][Ii][Nn][Dd][Ss]\\\\.[Bb][Uu][Ss][Ii][Nn][Ee][Ss]+[Ll][Aa][Yy][Ee]\n\n[Rr][Hh][Oo][Ss][Tt]\\\\.[Ee][Xx][Ee]/” and not (process.executable:”/.*\\\\\\\\Windows\\\\\\\\SysWOW64\\\\\\\\WerFault\\\\.exe/”\nOR\nprocess.executable:”/.*\\\\\\\\SolarWinds\\\\.Orion\\\\.ApiPoller\\\\.Service\\\\\\\\SolarWinds\\\\.Orion\\\\.ApiPoller\\\\.Service\\\\.exe/”\nor process.executable:”/.*\\\\\\\\SolarWinds\\\\\\\\Orion\\\\\\\\Database-Maint\\\\.exe/” or\nprocess.executable:”/.*\\\\\\\\SolarWinds\\\\\\\\Orion\\\\\\\\Topology\\\\\\\\SolarWinds\\\\.Orion\\\\.Topology\\\\.Calculator\\\\.exe/” or\nprocess.executable:”/.*\\\\\\\\SolarWinds\\\\\\\\Orion\\\\\\\\ExportToPDFCmd\\\\.exe/” or\nprocess.executable:”/.*\\\\\\\\SolarWinds\\\\\\\\Orion\\\\\\\\APM\\\\\\\\APMServiceControl\\\\.exe/” or\nprocess.executable:”/.*\\\\\\\\SolarWinds.Credentials\\\\\\\\SolarWinds\\\\.Credentials\\\\.Orion\\\\.WebApi\\\\.exe/”)\n\n**Elastic DSL**\n\n\n-----\n\n```\n{\n \"bool\": {\n  \"must\": [\n   {\n    \"query_string\": {\n     \"query\": \"/.*[Ss][Oo][Ll][Aa][Rr][Ww][Ii][Nn][Dd][Ss]\\\\.[Bb][Uu][Ss][Ii][Nn][Ee][Ss]+[Ll][Aa]\n[Yy][Ee][Rr][Hh][Oo][Ss][Tt]\\\\.[Ee][Xx][Ee]/\",\n     \"fields\": [\n      \"process.parent.executable\"\n     ]\n    }\n   }\n  ],\n  \"must_not\": [\n   {\n    \"query_string\": {\n     \"query\": \"/.*\\\\\\\\SolarWinds\\\\\\\\Orion\\\\\\\\APM\\\\\\\\APMServiceControl\\\\.exe/\",\n     \"fields\": [\n      \"process.executable\"\n     ]\n    }\n   },\n   {\n    \"query_string\": {\n     \"query\": \"/.*\\\\\\\\SolarWinds\\\\\\\\Orion\\\\\\\\ExportToPDFCmd\\\\.exe/\",\n     \"fields\": [\n      \"process.executable\"\n     ]\n    }\n   },\n   {\n    \"query_string\": {\n     \"query\":\n\"/.*\\\\\\\\SolarWinds\\\\\\\\Orion\\\\\\\\Topology\\\\\\\\SolarWinds\\\\.Orion\\\\.Topology\\\\.Calculator\\\\.exe/\",\n     \"fields\": [\n      \"process.executable\"\n     ]\n    }\n   },\n   {\n    \"query_string\": {\n     \"query\": \"/.*\\\\\\\\SolarWinds\\\\\\\\Orion\\\\\\\\Database-Maint\\\\.exe/\",\n     \"fields\": [\n      \"process.executable\"\n     ]\n    }\n   },\n   {\n    \"query_string\": {\n     \"query\":\n\"/.*\\\\\\\\SolarWinds\\\\.Orion\\\\.ApiPoller\\\\.Service\\\\\\\\SolarWinds.Orion\\\\.ApiPoller\\\\.Service\\\\.exe/\",\n     \"fields\": [\n      \"process.executable\"\n     ]\n    }\n   },\n   {\n    \"query_string\": {\n     \"query\": \"/.*\\\\\\\\Windows\\\\\\\\SysWOW64\\\\\\\\WerFault\\\\.exe/\",\n     \"fields\": [\n      \"process.executable\"\n     ]\n    }\n   },\n   {\n    \"query_string\": {\n     \"query\": \"/.*\\\\\\\\SolarWinds.Credentials\\\\\\\\SolarWinds\\\\.Credentials\\\\.Orion\\\\.WebApi\\\\.exe/\",\n\n```\n\n-----\n\n```\n            [\n      \"process.executable\"\n     ]\n    }\n   }\n  ]\n }\n}\n\n## SUNBURST Named Pipe Indicator\n\n```\n**Splunk**\n\nindex=sysmon sourcetype=sysmon:xml (EventID=17 OR EventID=18) PipeName=”583da945-62af-10e8-4902a8f205c72b2e”\n\n| stats values(_time) as occurrences, values(EventID) as eventID, values(PipeName) as pipeName count by host\n\n| convert ctime(occurrences)\n\n**Elastic Lucene**\n\nevent.code:(“17” or “18”) and file.name:”583da945-62af-10e8-4902-a8f205c72b2e”\n\n**Elastic DSL**\n```\n{\n \"bool\": {\n  \"must\": [\n   {\n    \"query_string\": {\n     \"query\": \"17\",\n     \"fields\": [\n      \"event.code\"\n     ]\n    }\n   },\n   {\n    \"query_string\": {\n     \"query\": \"18\",\n     \"fields\": [\n      \"event.code\"\n     ]\n    }\n   },\n   {\n    \"query_string\": {\n     \"query\": \"583da945-62af-10e8-4902-a8f205c72b2e\",\n     \"fields\": [\n      \"file.name\"\n     ]\n    }\n   }\n  ]\n }\n}\n\n```\nCyborg Security’s research and development team has built dozens of threat detection packages for the\nSUNBURST implant and additional malicious behaviours described by FireEye. These packages come tailored to\nyour unique environment and can be immediately downloaded and deployed.\n\nYou can find these detections, in addition to all known indicators of compromise (IOC), on the HUNTER platform.\n\n\n-----\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2020/2020-12-16 - SUNBURST- SolarWinds Supply-Chain Attack.pdf"
    ],
    "report_names": [
        "2020-12-16 - SUNBURST- SolarWinds Supply-Chain Attack.pdf"
    ],
    "threat_actors": [
        {
            "id": "b43e5ea9-d8c8-4efa-b5bf-f1efb37174ba",
            "created_at": "2022-10-25T16:07:24.36191Z",
            "updated_at": "2025-03-27T02:02:10.1909Z",
            "deleted_at": null,
            "main_name": "UNC2452",
            "aliases": [
                "Dark Halo",
                "Nobelium",
                "SolarStorm",
                "StellarParticle",
                "UNC2452"
            ],
            "source_name": "ETDA:UNC2452",
            "tools": [],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "70872c3a-e788-4b55-a7d6-b2df52001ad0",
            "created_at": "2023-01-06T13:46:39.18401Z",
            "updated_at": "2025-03-27T02:00:03.01553Z",
            "deleted_at": null,
            "main_name": "UNC2452",
            "aliases": [
                "DarkHalo",
                "StellarParticle",
                "NOBELIUM",
                "Solar Phoenix",
                "Midnight Blizzard"
            ],
            "source_name": "MISPGALAXY:UNC2452",
            "tools": [
                "SNOWYAMBER",
                "HALFRIG",
                "QUARTERRIG"
            ],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "1d3f9dec-b033-48a5-8b1e-f67a29429e89",
            "created_at": "2022-10-25T15:50:23.739197Z",
            "updated_at": "2025-03-27T02:00:55.536417Z",
            "deleted_at": null,
            "main_name": "UNC2452",
            "aliases": [
                "UNC2452",
                "NOBELIUM",
                "StellarParticle",
                "Dark Halo"
            ],
            "source_name": "MITRE:UNC2452",
            "tools": [
                "Sibot",
                "Mimikatz",
                "Cobalt Strike",
                "AdFind",
                "GoldMax"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "a241a1ca-2bc9-450b-a07b-aae747ee2710",
            "created_at": "2024-06-19T02:03:08.150052Z",
            "updated_at": "2025-03-27T02:05:17.409596Z",
            "deleted_at": null,
            "main_name": "IRON RITUAL",
            "aliases": [
                "Blue Dev 5 ",
                "BlueBravo ",
                "Cloaked Ursa ",
                "CozyLarch ",
                "Dark Halo ",
                "Midnight Blizzard ",
                "NOBELIUM ",
                "StellarParticle ",
                "UNC2452 ",
                "APT29"
            ],
            "source_name": "Secureworks:IRON RITUAL",
            "tools": [
                " Cobalt Strike",
                " EnvyScout",
                " GoldFinder",
                " GoldMax",
                " NativeZone",
                " RAINDROP",
                " SUNBURST",
                " Sibot",
                " TEARDROP",
                " VaporRage",
                "Brute Ratel C4"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "20d3a08a-3b97-4b2f-90b8-92a89089a57a",
            "created_at": "2022-10-25T15:50:23.548494Z",
            "updated_at": "2025-03-27T02:00:55.49688Z",
            "deleted_at": null,
            "main_name": "APT29",
            "aliases": [
                "APT29",
                "IRON RITUAL",
                "IRON HEMLOCK",
                "NobleBaron",
                "Dark Halo",
                "NOBELIUM",
                "UNC2452",
                "YTTRIUM",
                "The Dukes",
                "Cozy Bear",
                "CozyDuke",
                "SolarStorm",
                "Blue Kitsune",
                "UNC3524",
                "Midnight Blizzard"
            ],
            "source_name": "MITRE:APT29",
            "tools": [
                "PinchDuke",
                "ROADTools",
                "WellMail",
                "CozyCar",
                "Mimikatz",
                "Tasklist",
                "OnionDuke",
                "FatDuke",
                "POSHSPY",
                "EnvyScout",
                "SoreFang",
                "GeminiDuke",
                "GoldMax",
                "FoggyWeb",
                "SDelete",
                "PolyglotDuke",
                "AADInternals",
                "MiniDuke",
                "SeaDuke",
                "Sibot",
                "RegDuke",
                "CloudDuke",
                "GoldFinder",
                "AdFind",
                "PsExec",
                "NativeZone",
                "Systeminfo",
                "ipconfig",
                "Impacket",
                "Cobalt Strike",
                "PowerDuke",
                "QUIETEXIT",
                "HAMMERTOSS",
                "BoomBox",
                "CosmicDuke",
                "WellMess",
                "VaporRage",
                "LiteDuke"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "f27790ff-4ee0-40a5-9c84-2b523a9d3270",
            "created_at": "2022-10-25T16:07:23.341684Z",
            "updated_at": "2025-03-27T02:02:09.74554Z",
            "deleted_at": null,
            "main_name": "APT 29",
            "aliases": [
                "APT 29",
                "ATK 7",
                "Blue Dev 5",
                "BlueBravo",
                "Cloaked Ursa",
                "CloudLook",
                "Cozy Bear",
                "Dark Halo",
                "Earth Koshchei",
                "Grizzly Steppe",
                "Group 100",
                "ITG11",
                "Iron Hemlock",
                "Iron Ritual",
                "Midnight Blizzard",
                "Minidionis",
                "Nobelium",
                "NobleBaron",
                "Operation Ghost",
                "Operation Office monkeys",
                "Operation StellarParticle",
                "SilverFish",
                "Solar Phoenix",
                "SolarStorm",
                "StellarParticle",
                "TEMP.Monkeys",
                "The Dukes",
                "UNC2452",
                "UNC3524",
                "Yttrium"
            ],
            "source_name": "ETDA:APT 29",
            "tools": [
                "7-Zip",
                "ATI-Agent",
                "AdFind",
                "Agentemis",
                "AtNow",
                "BEATDROP",
                "BotgenStudios",
                "CEELOADER",
                "Cloud Duke",
                "CloudDuke",
                "CloudLook",
                "Cobalt Strike",
                "CobaltStrike",
                "CosmicDuke",
                "Cozer",
                "CozyBear",
                "CozyCar",
                "CozyDuke",
                "Danfuan",
                "EnvyScout",
                "EuroAPT",
                "FatDuke",
                "FoggyWeb",
                "GeminiDuke",
                "Geppei",
                "GoldFinder",
                "GoldMax",
                "GraphDrop",
                "GraphicalNeutrino",
                "GraphicalProton",
                "HAMMERTOSS",
                "HammerDuke",
                "LOLBAS",
                "LOLBins",
                "LiteDuke",
                "Living off the Land",
                "MagicWeb",
                "Mimikatz",
                "MiniDionis",
                "MiniDuke",
                "NemesisGemina",
                "NetDuke",
                "OnionDuke",
                "POSHSPY",
                "PinchDuke",
                "PolyglotDuke",
                "PowerDuke",
                "QUIETEXIT",
                "ROOTSAW",
                "RegDuke",
                "Rubeus",
                "SNOWYAMBER",
                "SPICYBEAT",
                "SUNSHUTTLE",
                "SeaDaddy",
                "SeaDask",
                "SeaDesk",
                "SeaDuke",
                "Sharp-SMBExec",
                "SharpView",
                "Sibot",
                "Solorigate",
                "SoreFang",
                "TinyBaron",
                "WINELOADER",
                "WellMail",
                "WellMess",
                "cobeacon",
                "elf.wellmess",
                "reGeorg",
                "tDiscoverer"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535546,
    "ts_updated_at": 1743041794,
    "ts_creation_date": 1653753254,
    "ts_modification_date": 1653753254,
    "files": {
        "pdf": "https://archive.orkl.eu/8b2af98bd5344d3e54dbba50a5f9b3092c4c8d41.pdf",
        "text": "https://archive.orkl.eu/8b2af98bd5344d3e54dbba50a5f9b3092c4c8d41.txt",
        "img": "https://archive.orkl.eu/8b2af98bd5344d3e54dbba50a5f9b3092c4c8d41.jpg"
    }
}