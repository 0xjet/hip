{
    "id": "faeb46ee-901f-4feb-a25f-d5fff5143ed3",
    "created_at": "2023-01-12T15:04:29.347729Z",
    "updated_at": "2025-03-27T02:16:26.563175Z",
    "deleted_at": null,
    "sha1_hash": "9f09fc31c6380ab50bcff884340c865ef7a7a0fc",
    "title": "2018-09-21 - VIGILANTE MALWARE REMOVES CRYPTOMINERS FROM THE INFECTED DEVICE",
    "authors": "",
    "file_creation_date": "2022-05-28T21:57:37Z",
    "file_modification_date": "2022-05-28T21:57:37Z",
    "file_size": 231911,
    "plain_text": "# Vigilante malware removes cryptominers from the infected device\n\n**[securitynews.sonicwall.com/xmlpost/vigilante-malware-removes-cryptominers-from-the-infected-device/](https://securitynews.sonicwall.com/xmlpost/vigilante-malware-removes-cryptominers-from-the-infected-device/)**\n\nSeptember 21, 2018\n\nSonicWall CaptureLabs Threats Research Team observed an interesting Android malware\nthat acts an an anti-hero. Upon infecting a mobile device, it checks for the presence of\nspecific cryptominers and removes the miner infection from the device and saves the day …\nor does it ?\n\nThe complete infection cycle can be summarized in two stages as below:\n\n## Stage I\n\nOnce the malware infects a device it downloads the first stage of the attack payload from\none of the following two sources as of now:\n\n1. hxxp://188.209.52.142/w\n2. hxxp://188.209.52.142/c\n\n\n-----\n\nThis script performs the following tasks:\n\n1. Check the architecture of the infected system and download the second stage of the\n\nattack using wget or curl commands\n2. Give appropriate permissions to the second stage and executes it on the device\n3. Remove the file downloaded for the second stage and uninstall an app with package\n\n[name com.ufo.miner which is a miner similar to ADB miner that we blogged about in](https://www.mysonicwall.com/sonicalert/searchresults.aspx?ev=article&id=1123)\nthe past\n\n## Stage II\n\nApart from the above mentioned miner, the malware seeks the presence of other miners as\nwell. It performs device forensics via:\n\nChecking the contents of the memory region for a particular process via\n/proc/<pid>/maps\nChecking the folders on the device for specific files that are present when a crypto\nminer infects a system:\n\n/data/local/tmp/smi\n/data/local/tmp/rig\n/data/local/tmp/trinity\n\nThe malware created a hidden file on the device\nnamed .HqMBksnBExR82Ja with its contents simply\nbeing – ’“”.\n\nIt deletes the ELF file (linux executable) from the disk\nonce it is executed:\n\n\n-----\n\nSince the malware executes an ELF file (linux executable) there is no easy way for the user\nto determine if this file is running on the device. As shown below, the code runs on the\nsystem using a long alphanumeric process name:\n\nEven though it appears that the malware cleans the system from previously installed\ncryptominers it is doing so without the user’s permission thereby violating the security\nmodel of Android. It is likely that the malware is cleaning up the system and making room\nfor something more potent and damaging that may surface in the near future. Regardless,\napps that perform dangerous/suspicious actions in the background without informing the\nuser cannot be trusted.\n\nIt is advisable to keep our Android devices up-to-date with latest security patches and\nalways ensure that Google Play Protect is running on the device as it provides an added\nlayer of security by periodically scanning the device for malicious threats.\n\n**SonicWall Capture Labs provides protection against this threat via the following**\n**signatures:**\n\n**GAV: AndroidOS.Fbot.ST1 (Trojan)**\n**GAV: AndroidOS.Fbot.ST2 (Trojan)**\n**GAV: AndroidOS.Fbot.ST2_2 (Trojan)**\n\n**Indicators Of Compromise (IOC):**\n\n**c480feeb89bd9e63940c079124ee20f8 – Script from hxxp://188.209.52.142/c**\n**c33b06c762d2240771cc748f5d8f09c3 – Script from hxxp://188.209.52.142/w**\n**99a8afcf640f65dda77646623d38f182 – fbot.mipsel**\n**c4d306820f08692ac527c7ec27adb858- fbot.aarch64**\n**156d9b75df8efa4eb20fe79d90aadabd – fbot.arm7**\n**cae2ddcac530bd13d8cb562422f59c35 – fbot.x86**\n**2143c9125908a7283ef5b1152ff78d66 – fbot.x86_64**\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2018/2018-09-21 - VIGILANTE MALWARE REMOVES CRYPTOMINERS FROM THE INFECTED DEVICE.pdf"
    ],
    "report_names": [
        "2018-09-21 - VIGILANTE MALWARE REMOVES CRYPTOMINERS FROM THE INFECTED DEVICE.pdf"
    ],
    "threat_actors": [
        {
            "id": "b69037ec-2605-4de4-bb32-a20d780a8406",
            "created_at": "2023-01-06T13:46:38.790766Z",
            "updated_at": "2025-03-27T02:00:02.919758Z",
            "deleted_at": null,
            "main_name": "MUSTANG PANDA",
            "aliases": [
                "TEMP.HEX",
                "TA416",
                "TANTALUM",
                "Twill Typhoon",
                "Earth Preta",
                "Stately Taurus",
                "LuminousMoth",
                "Polaris",
                "BRONZE PRESIDENT",
                "HoneyMyte",
                "Red Lich"
            ],
            "source_name": "MISPGALAXY:MUSTANG PANDA",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "9baa7519-772a-4862-b412-6f0463691b89",
            "created_at": "2022-10-25T15:50:23.354429Z",
            "updated_at": "2025-03-27T02:00:55.45162Z",
            "deleted_at": null,
            "main_name": "Mustang Panda",
            "aliases": [
                "Mustang Panda",
                "TA416",
                "RedDelta",
                "BRONZE PRESIDENT"
            ],
            "source_name": "MITRE:Mustang Panda",
            "tools": [
                "Cobalt Strike",
                "RCSession",
                "NBTscan",
                "PoisonIvy",
                "PlugX"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "75108fc1-7f6a-450e-b024-10284f3f62bb",
            "created_at": "2024-11-01T02:00:52.756877Z",
            "updated_at": "2025-03-27T02:00:55.544216Z",
            "deleted_at": null,
            "main_name": "Play",
            "aliases": null,
            "source_name": "MITRE:Play",
            "tools": [
                "Nltest",
                "AdFind",
                "PsExec",
                "Wevtutil",
                "Cobalt Strike",
                "Playcrypt",
                "Mimikatz"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "2ee03999-5432-4a65-a850-c543b4fefc3d",
            "created_at": "2022-10-25T16:07:23.882813Z",
            "updated_at": "2025-03-27T02:02:10.0116Z",
            "deleted_at": null,
            "main_name": "Mustang Panda",
            "aliases": [
                "Bronze President",
                "Camaro Dragon",
                "Earth Preta",
                "HoneyMyte",
                "Mustang Panda",
                "Operation SMUGX",
                "Operation SmugX",
                "PKPLUG",
                "Red Lich",
                "Stately Taurus",
                "TEMP.Hex"
            ],
            "source_name": "ETDA:Mustang Panda",
            "tools": [
                "9002 RAT",
                "AdFind",
                "Agent.dhwf",
                "Agentemis",
                "CHINACHOPPER",
                "China Chopper",
                "Chymine",
                "ClaimLoader",
                "Cobalt Strike",
                "CobaltStrike",
                "DCSync",
                "DOPLUGS",
                "Darkmoon",
                "Destroy RAT",
                "DestroyRAT",
                "Farseer",
                "Gen:Trojan.Heur.PT",
                "HOMEUNIX",
                "Hdump",
                "HenBox",
                "HidraQ",
                "Hodur",
                "Homux",
                "HopperTick",
                "Hydraq",
                "Impacket",
                "Kaba",
                "Korplug",
                "LadonGo",
                "MQsTTang",
                "McRAT",
                "MdmBot",
                "Mimikatz",
                "NBTscan",
                "NetSess",
                "Netview",
                "Orat",
                "POISONPLUG.SHADOW",
                "PUBLOAD",
                "PVE Find AD Users",
                "PlugX",
                "Poison Ivy",
                "PowerView",
                "QMAGENT",
                "RCSession",
                "RedDelta",
                "Roarur",
                "SPIVY",
                "ShadowPad Winnti",
                "SinoChopper",
                "Sogu",
                "TIGERPLUG",
                "TONEINS",
                "TONESHELL",
                "TVT",
                "TeamViewer",
                "Thoper",
                "TinyNote",
                "WispRider",
                "WmiExec",
                "XShellGhost",
                "Xamtrav",
                "Zupdax",
                "cobeacon",
                "nbtscan",
                "nmap",
                "pivy",
                "poisonivy"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535869,
    "ts_updated_at": 1743041786,
    "ts_creation_date": 1653775057,
    "ts_modification_date": 1653775057,
    "files": {
        "pdf": "https://archive.orkl.eu/9f09fc31c6380ab50bcff884340c865ef7a7a0fc.pdf",
        "text": "https://archive.orkl.eu/9f09fc31c6380ab50bcff884340c865ef7a7a0fc.txt",
        "img": "https://archive.orkl.eu/9f09fc31c6380ab50bcff884340c865ef7a7a0fc.jpg"
    }
}