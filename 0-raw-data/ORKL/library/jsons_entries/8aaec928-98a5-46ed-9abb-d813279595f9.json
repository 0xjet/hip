{
    "id": "8aaec928-98a5-46ed-9abb-d813279595f9",
    "created_at": "2023-01-12T15:07:49.149338Z",
    "updated_at": "2025-03-27T02:09:44.476806Z",
    "deleted_at": null,
    "sha1_hash": "cb8107ca3268bf1047e71a0fbe402664ee44f053",
    "title": "2021-07-22 - DoNot APT Group Delivers A Spyware Variant Of Chat App",
    "authors": "",
    "file_creation_date": "2022-05-27T23:05:15Z",
    "file_modification_date": "2022-05-27T23:05:15Z",
    "file_size": 1136515,
    "plain_text": "# DoNot APT Group Delivers a Spyware Variant of Chat App\n\n**[blog.cyble.com/2021/07/22/donot-apt-group-delivers-a-spyware-variant-of-chat-app/](https://blog.cyble.com/2021/07/22/donot-apt-group-delivers-a-spyware-variant-of-chat-app/)**\n\nJuly 22, 2021\n\nDoNot APT Group, also known as APT-C-35, is an Advanced Persistent Threat (APT) group\ntargeting government-related organizations. DoNot has a reputation for carrying out APT\nattacks against India, Pakistan, Argentina, and countries in South Asia. This group mainly\nspreads malware using malicious programs developed in C++, Python, .NET, and other\nlanguages.\n\nDoNot APT mainly spreads malware via spear-phishing emails containing malicious\ndocuments and files. In addition to spreading malware via spear-phishing emails with\nattachments that contain either a vulnerability or a malicious macro, this APT group\nleverages malicious Android APKs in their target attacks.\n\nAndroid-based Spyware applications are often disguised as system tools and in some cases\nas fake apps, counterfeit mobile games, and fake news apps. Post installation, these\napps perform Trojan functions in the background and can remotely control\nthe victim’s system, besides stealing confidential information from the targeted device.\n\nDuring our Open-Source Intelligence (OSINT) research, Cyble researchers found a malware\n[sample of the DoNot APT group posted on Twitter. Upon analyzing the malware sample, the](https://twitter.com/ShadowChasing1/status/1417296126852567049)\nCyble Research Lab discovered that it is a fake app disguised as a legitimate messaging app\nthat collects sensitive information from the victim’s device.\n\nThe APT group uses the deobfuscation code along with some packers within the application\nto conceal malicious functionalities. This prevents the spyware from being detected during\nthe static analysis of the app.\n\n**Technical Analysis:**\n\nWe performed the technical analysis of an APK, with the following hash value:\n\n**fdb67688d92900226bf834ce67f4112f03e981611ee50e9c3102636574b05280.**\n\nApp name:\n\n**Mecaller.apk**\n\nPackage name:\n\n\n-----\n\n**com.chat.nsgnest**\n\nSome of the applications’ permissions, activities, and services that may be used to perform\nmalicious activities are listed below:\n\n**Permissions:**\n\nandroid.permission.READ_CALENDAR\nandroid.permission.PROCESS_OUTGOING_CALLS\nandroid.permission.ACCESS_COARSE_LOCATION\nandroid.permission.INTERNET\nandroid.permission.ACCESS_FINE_LOCATION\nandroid.permission.READ_CALL_LOG\nandroid.permission.WRITE_EXTERNAL_STORAGE\nandroid.permission.RECEIVE_SMS\nandroid.permission.AUTHENTICATE_ACCOUNTS\nandroid.permission.CALL_PHONE\nandroid.permission.READ_PHONE_STATE\nandroid.permission.READ_SMS\nandroid.permission.RECORD_AUDIO\nandroid.permission.READ_CONTACTS\n\n**Activities:**\n\nime.serviceinfo.app.MainActivity\nime.serviceinfo.app.qsharehong.qsharelackhong\n\n**Services:**\n\nime.serviceinfo.app.qsynchong.qSyncServicehong\nime.serviceinfo.app.qsynchong.qAuthenticatorServicehong\nime.serviceinfo.app.qaleolehong.qdcerthong\nime.serviceinfo.app.qaleolehong.qnqwerhong\nime.serviceinfo.app.qstunthong.qSensorServicehong\nime.serviceinfo.app.qsharehong.qsttrServicehong\nime.serviceinfo.app.qsharehong.qServicehong\nime.serviceinfo.app.qaleolehong.qhepjshong\nime.serviceinfo.app.qhelphong.qgarohong\nime.serviceinfo.app.qaihihihong.tknnotify.sfsSr\n\nWe also performed a dynamic analysis and discovered that the app has an emulator check\nthat avoids running the app in an emulator or VirtualBox, and only runs this app on legitimate\ndevices. Further, on bypassing the scripts using Frida and on loading the application, it\ndisplays a message as shown in the figure below\n\n\n-----\n\nFigure 1 Error Message from The App on Loading It Through Frida Scripts\n\nUsing the same Frida scripts and on loading the various activities, the app requests users to\nenable the accessibility service and on activating, it displays the below message as shown in\nFigure 2.\n\nFigure 2 – Message displayed on turning on the Accessibility Service\n\n\n-----\n\nThe malware then initiates malicious behavior from the application main\nclass, “ime.serviceinfo.app.MainActivity“. The entry point of the app is this class, which\ngets executed at first when the user starts the application.\n\nUsing the above permissions granted from users, the following data is fetched from the\ndevices:\n\nTracking the user’s location along with network operator details, device location,\nlatitude, and longitude from the compromised device.\n\nFigure 3 Code to track the location of the device with Latitude and Longitude\n\nChecking for the availability of internet connection from the device to collect the\nnetwork and connectivity information.\n\nFigure 4 Checks for Internet connection Availability\n\nThe application also has the capability to record audio and collect media files from the\ninfected device without the user’s knowledge.\n\n\n-----\n\nFigure 5 Code to Record Audio/Media Files from the Infected Device\n\nSending text messages using permissions and SMS manager.\n\nFigure 6 Sends text Messages using SMS Manager and Android Permissions\n\n\n-----\n\nTracking the Service/Receiver that are registered post device reboot.\n\nFigure 7 Registers the service/receiver on phone reboot\n\nAfter the accessibility service is enabled, the application launcher icon is removed from\nthe main screen, thereby allowing the app to stay hidden.\n\nFigure 8 Hides the Application launcher Icon from View\n\nCollecting the information on the running application processes or tasks.\n\n\n-----\n\nFigure 9 Collects list of running processes\n\nVerifying the infected device fingerprint, hardware, and model to find out whether the\napplication is executed through emulator or through VirtualBox. If it is executed through\nemulator, the application will not be performing any malicious activity to avoid any kind\nof detection.\n\nFigure 10 Code to detect the analysis device (Emulator Check)\n\nMonitoring the device phone number from both outgoing and incoming calls using\nbroadcastreceiver and storing the collected data into “CallLogs.txt“.\n\nFigure 11 Code that queries phone numbers from incoming and outgoing calls\n\n\n-----\n\nFigure 12 Code that monitors and collects call logs\n\nMonitoring the incoming messages, creating Protocol data unit (PDU), intercepting\nSMSes to collect information from them and storing the information in “sms.txt“.\n\nFigure 13 Code that monitors and collects SMS data\n\n\n-----\n\nFigure 14 Stores the collected SMS data\n\nCollecting phone contacts from the infected device and storing it in “contacts.txt” file.\n\nFigure 15 Collects and stores Phone contacts\n\nAlong with the above sensitive information, this malicious app has the code to fetch\nstored mail accounts and application accounts like Gmail, WhatsApp, besides storing\nthe information in “accounts.txt“.\n\n\n-----\n\nFigure 16 Code that collects and stores mail, application accounts\n\nBase64 Encryption technique used in multiple classes and methods.\n\nFigure 17 Encrypted strings using Base64 encryption technique\n\nUpon decrypting the encrypted strings, we were able to determine that the data being\ncollected by this app is sent to the C2 link through which the application communicates and\nuploads the information to the server.\n\nC2 Server: hxxp[:]//tinyshort[.]icu/\n\n## CONCLUSION:\n\n\n-----\n\nSpyware apps have been around for a long time, yet they still pose a significant threat to\nsensitive data on victim devices. The APT groups responsible for creating the spyware are\nconstantly adapting and using various encryption techniques to avoid detection. This makes\nremoval of the spyware nearly impossible, thus users should exercise caution while installing\napplications.\n\n**SAFETY** **RECOMMENDATIONS:**\n\nKeep your anti-virus software updated to detect and remove malicious software.\nUninstall the application if you find this malware in your device.\nKeep your system and applications updated to the latest versions.\nUse strong passwords and enable two-factor authentication.\nDownload and install software only from trusted sites and official app stores.\nVerify the privileges and permissions requested by apps before granting them access.\nPeople concerned about the exposure of their stolen credentials in the dark web can\nregister at [AmIBreached.com to ascertain their exposure.](https://amibreached.com/)\n\n**MITRE ATT&CK® Techniques- for Mobile**\n\n**Tactic** **Technique ID** **Technique Name**\n\n\nDefense Evasion [T1406](https://attack.mitre.org/techniques/T1406)\n[T1418](https://attack.mitre.org/techniques/T1418)\n\nCredential Access [T1409](https://attack.mitre.org/techniques/T1409)\n[T1412](https://attack.mitre.org/techniques/T1412)\n\nCollection [T1507](https://attack.mitre.org/techniques/T1507)\n[T1430](https://attack.mitre.org/techniques/T1430)\n[T1412](https://attack.mitre.org/techniques/T1412)\n[T1429](https://attack.mitre.org/techniques/T1429/)\n[T1432](https://attack.mitre.org/techniques/T1432/)\n[T1433](https://attack.mitre.org/techniques/T1433/)\n\nDiscovery [T1421](https://attack.mitre.org/techniques/T1421/)\n[T1430](https://attack.mitre.org/techniques/T1430/)\n[T1426](https://attack.mitre.org/techniques/T1426/)\n[T1418](https://attack.mitre.org/techniques/T1418)\n[T1424](https://attack.mitre.org/techniques/T1424)\n\nCommand and Control [T1573](https://attack.mitre.org/techniques/T1573)\n[T1571](https://attack.mitre.org/techniques/T1571/)\n\n\nObfuscated Files or Information\nApplication Discovery\n\nAccess Stored Application Data\nCapture SMS Messages\n\nNetwork Information Discovery\nLocation Tracking\nCapture SMS Messages\nCapture Audio\nAccess Contact List\nAccess Call Log\n\nSystem Network Connections\nDiscovery Location Tracking\nSystem Information Discovery\nApplication Discovery\nProcess Discovery\n\nEncrypted Channel\nNon-Standard Port\n\n\nExfiltration [T1532](https://attack.mitre.org/techniques/T1532/) Data Encrypted\n\n**Indicators of Compromise (IoCs):**\n\n**IOCs** **IOC type**\n\n\n-----\n\nfdb67688d92900226bf834ce67f4112f03e981611ee50e9c3102636574b05280 SHA256\n\nhxxp[:]//tinyshort[.]icu/ Interesting\nURL\n\n45.61.137[.]7 IP\naddress\n\n**About Cyble**\n\n[Cyble is a global threat intelligence SaaS provider that helps enterprises protect themselves](https://cyble.com/)\nfrom cybercrimes and exposure in the darkweb. Cyble’s prime focus is to provide\norganizations with real-time visibility into their digital risk footprint. Backed by Y Combinator\nas part of the 2021 winter cohort, Cyble has also been recognized by Forbes as one of the\ntop 20 Best Cybersecurity Startups to Watch in 2020. Headquartered in Alpharetta, Georgia,\nand with offices in Australia, Singapore, and India, Cyble has a global presence. To learn\n[more about Cyble, visit www.cyble.com.](https://cyble.com/)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-07-22 - DoNot APT Group Delivers A Spyware Variant Of Chat App.pdf"
    ],
    "report_names": [
        "2021-07-22 - DoNot APT Group Delivers A Spyware Variant Of Chat App.pdf"
    ],
    "threat_actors": [
        {
            "id": "2ac63ef4-a7b8-4a30-96ad-b30ccb2073fc",
            "created_at": "2022-10-25T16:07:23.546262Z",
            "updated_at": "2025-03-27T02:02:09.856624Z",
            "deleted_at": null,
            "main_name": "Donot Team",
            "aliases": [
                "APT-C-35",
                "SectorE02"
            ],
            "source_name": "ETDA:Donot Team",
            "tools": [
                "BackConfig",
                "EHDevel",
                "Jaca",
                "yty"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "cfdd350b-de30-4d29-bbee-28159f26c8c2",
            "created_at": "2023-01-06T13:46:38.433736Z",
            "updated_at": "2025-03-27T02:00:02.832565Z",
            "deleted_at": null,
            "main_name": "VICEROY TIGER",
            "aliases": [
                "OPERATION HANGOVER",
                "Donot Team",
                "APT-C-35",
                "SectorE02",
                "Orange Kala"
            ],
            "source_name": "MISPGALAXY:VICEROY TIGER",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673536069,
    "ts_updated_at": 1743041384,
    "ts_creation_date": 1653692715,
    "ts_modification_date": 1653692715,
    "files": {
        "pdf": "https://archive.orkl.eu/cb8107ca3268bf1047e71a0fbe402664ee44f053.pdf",
        "text": "https://archive.orkl.eu/cb8107ca3268bf1047e71a0fbe402664ee44f053.txt",
        "img": "https://archive.orkl.eu/cb8107ca3268bf1047e71a0fbe402664ee44f053.jpg"
    }
}