{
    "id": "641f119a-d954-4062-afcf-59efb274288c",
    "created_at": "2023-01-12T15:07:39.340782Z",
    "updated_at": "2025-03-27T02:16:59.252043Z",
    "deleted_at": null,
    "sha1_hash": "13b8fb17dec659251a40f511f8b10170c18fec4e",
    "title": "2016-09-14 - BkSoD by Ransomware- HDDCryptor Uses Commercial Tools to Encrypt Network Shares and Lock HDDs",
    "authors": "",
    "file_creation_date": "2011-02-21T16:39:03Z",
    "file_modification_date": "2011-02-21T16:39:03Z",
    "file_size": 4788170,
    "plain_text": "### Tofino Security | Abterra Technologies | ScadaHacker.com\n# White Paper\n\n### Version 1.0 Published February 22, 2011\n\n## How Stuxnet Spreads – A Study of Infection Paths in Best Practice Systems\n\n### Contents\n\nExecutive Summary ........................................................................................................................ 1\n\nIntroduction .................................................................................................................................... 2\n\nMethodology ................................................................................................................................... 2\n\nWhat is the Siemens PCS 7 Industrial Control Systems – A Primer .............................................. 3\n\nWhat is Stuxnet – A Primer ............................................................................................................ 6\n\nThe Target – A High-Security Site ................................................................................................. 8\n\nCompromising the Network .......................................................................................................... 11\n\nDiscussion ..................................................................................................................................... 18\n\nLooking Forward .......................................................................................................................... 23\n\nDisclaimers ................................................................................................................................... 24\n\nReferences..................................................................................................................................... 24\n\n### Authors\n\nEric Byres, P. Eng. ISA Fellow   Andrew Ginter, CISSP           Joel Langill, CEH, CPT, CCNA\nCTO, Byres Security Inc.         CTO, Abterra Technologies       CSO, SCADAhacker.com\neric@byressecurity.com         aginter@abterra.ca              joel@scadahacker.com\nwww.tofinosecurity.com         www.abterra.ca                  www.scadahacker.com\n\n\n-----\n\nTofino Security | Abterra Technologies | ScadaHacker.com **White Paper: How Stuxnet Spreads**\n\n#### Executive Summary\n\nThe Stuxnet worm is a sophisticated piece of computer malware designed to sabotage industrial\nprocesses controlled by Siemens SIMATIC WinCC and PCS 7 control systems. The worm used both\nknown and previously unknown vulnerabilities to install, infect and propagate, and was powerful\nenough to evade state-of-the-practice security technologies and procedures.\n\nSince its discovery, there has been extensive analysis of Stuxnet’s internal workings. What has not\nbeen discussed is how the worm might have migrated from the outside world to supposedly isolated\nand secure industrial control systems (ICS). Understanding the routes that a directed worm takes as\nit targets an ICS is critical if these vulnerable pathways are to be closed for future worms.\n\nTo help address this knowledge gap, this White Paper describes a hypothetical industrial site that\nfollows the high security architecture and best practices defined in vendor documents. It then\nshows the ways that the Stuxnet worm could make its way through the defenses of the site to take\ncontrol of the process and cause physical damage.\n\nIt is important to note that the analysis presented in this paper is based on a security model that,\nthough it is accepted in industry as a best practice, is often not implemented in practice. System\narchitectures in the real world are typically much less secure than the one presented in this paper.\n\nThe paper closes with a discussion of what can be learned from the analysis of pathways in order to\nprevent infection from future ICS worms. Key findings include the following:\n\n        - A modern ICS or SCADA system is highly complex and interconnected, resulting in\nmultiple potential pathways from the outside world to the process controllers.\n\n        - Assuming an air-gap between ICS and corporate networks is unrealistic, as information\nexchanges are essential for process and business operations to function effectively.\n\n        - All mechanisms for transfer of electronic information (in any form) to or from an ICS must\nto be evaluated for security risk. Focusing security efforts on a few obvious pathways (such\nas USB storage drives or the Enterprise/ICS firewall) is a flawed defense.\n\n        - Industry must accept that the complete prevention of ICS infection is probably impossible\nand that instead of complete prevention, industry must create a security architecture that\ncan respond to the full life cycle of a cyber breach.\n\n        - Industry must address the containment of attacks when prevention fails and aggressively\nsegment control networks to limit the consequences of compromise. In particular, securing\nlast-line-of-defense critical systems, such as safety integrated systems (SIS), is essential.\n\n        - Combining control and safety functionality in highly integrated ICS equipment exposes\nsystems to common-cause security failures. For critical systems, diversity is important.\n\n        - Providing security by simply blocking or allowing entire classes of protocols between\nmanufacturing areas is no longer sufficient. Stuxnet highlights the need for the deep packet\ninspection (DPI) of key SCADA and ICS protocols.\n\n        - The Remote Procedure Call (RPC) protocol is an ideal vector for SCADA and ICS attacks\nbecause it is used for so many legitimate purposes in modern control systems.\n\n        - Industry should start to include security assessments and testing as part of the system\ndevelopment and periodic maintenance processes in all ICS.\n\n        - There is a need to improve the culture of industrial security among both management and\ntechnical teams.\n\nIf the critical infrastructures of the world are to be safe and secure, then the owners and operators\nneed to recognize that their control systems are now the target of sophisticated attacks. Improved\ndefense-in-depth postures for industrial control systems are needed urgently. Waiting for the next\nworm may be too late.\n\nFebr ar 22 2011 1\n\n\n-----\n\nTofino Security | Abterra Technologies | ScadaHacker.com **White Paper: How Stuxnet Spreads**\n\n#### Introduction\n\nThe Stuxnet worm is a sophisticated piece of computer malware designed to sabotage industrial\nprocesses controlled by Siemens SIMATIC WinCC, S7 and PCS 7 control systems. The worm used\nboth known and previously unknown vulnerabilities to spread, and was powerful enough to evade\nstate-of-the-practice security technologies and procedures.\n\nSince the discovery of the Stuxnet worm in July 2010, there has been extensive analysis by\nSymantec, ESET, Langner and others of the worm’s internal workings and the various\nvulnerabilities it exploits. From the antivirus point of view, this makes perfect sense. Understanding\nhow the worm was designed helps antivirus product vendors make better malware detection\nsoftware.\n\nWhat has not been discussed in any depth is how the worm might have migrated from the outside\nworld to a supposedly isolated and secure industrial control system (ICS). To the owners and\noperators of industrial control systems, this matters. Other worms will follow in Stuxnet’s footsteps\nand understanding the routes that a directed worm takes as it targets an ICS is critical if these\nvulnerable pathways are to be closed. Only by understanding the full array of threats and pathways\ninto a SCADA or control network can critical processes be made truly secure.\n\nIt is easy to imagine a trivial scenario and a corresponding trivial solution:\n\n**Scenario: Joe finds a USB flash drive in the parking lot and brings it into the control room**\n_where he plugs it into the PLC programming station._\n\n**Solution: Ban all USB flash drives in the control room.**\n\nWhile this may be a possibility, it is far more likely that Stuxnet travelled a circuitous path to its\nfinal victim. Certainly, the designers of the worm expected it to – they designed at least seven\ndifferent propagation techniques for Stuxnet to use. Thus, a more realistic analysis of penetration\nand infection pathways is needed.\n\nThis White Paper is intended to address this gap by analyzing a range of potential “infection\npathways” in a typical ICS system. Some of these are obvious, but others less so. By shedding light\non the multitude of infection pathways, we hope that the designers and operators of industrial\nfacilities can take the appropriate steps to make control systems much more secure from all threats.\n\n#### Methodology\n\nThe first part of the analysis starts with an introduction to the Siemens SIMATIC PCS 7 product\nline, since this was the target of the Stuxnet worm.\n\nIn the second part, we provide an overview of the worm and how it infects a system. We outline how\nit spreads between computers as it attempts to locate its ultimate victim. Finally, we briefly describe\nhow the worm affects a control system using Siemens SIMATIC products.\n\nIn the third part of the paper, we propose a hypothetical “high security site” that is the target of\nStuxnet or the next generation of Stuxnet-like worms. The architecture used in the paper assumes\nthis fictitious site is following all the guidance provided in Siemens SIMATIC “Security Concept PCS\n7 and WinCC – Basic Document.” From a security point of view, this assumption is probably\noptimistic, as the gap between guidance and reality in the ICS world is often large. However, it is a\ngood model for two reasons – it provides a conservative starting point and it highlights that current\n“best practices” in ICS security might still have a way to go.\n\nPart four proposes several ways Stuxnet could move from an infected computer of little importance\non the corporate network to deep inside the control system. We also look at how the Peer-to-Peer\n(P2P) and Command and Control (CC) components of Stuxnet could be effective in an otherwise\nisolated industrial plant.\n\nFinally, we close with a brief analysis of what this means for the security of industrial control\nsystems in the longer term. In particular, we discuss how other “non-Siemens” systems should\n\nFebr ar 22 2011 2\n\n\n-----\n\nTofino Seccurity | Abterraa Technologiees | ScadaHackker.com\n\n\n**White PPaper: How Stuxnet Sprreads**\n\n\nconsider thee vulnerabilitiees exploited by Stuxnet on aa Siemens archhitecture and prepare for d\nwith the nexxt generation wworm that couuld exploit otheer ICS platformms.\n\n\nealing\n\n\n#### What is the Siemenns PCS 7 Inndustrial Coontrol Systeems – A Primer\n\n\nIn order to uunderstand thhe directed atttack Stuxnet pperformed agaiinst Siemens IICS systems, aa brief\noverview of the Siemens SSIMATIC PCS 7 architecturee is in order.\n\nSIMATIC iss a comprehennsive term ussed by Siemenns, which inclludes their coomplete portfoolio of\nindustrial aautomation soolutions rangiing from macchine vision tto distributedd I/O systems and\nprogrammabble controllerrs. SIMATIC WinCC is a specialized pprocess visualiization systemm that\ncomprises thhe core Supervvisory Controll and Data Acqquisition Systeem (SCADA). It can be usedd with\nSiemens-braanded controll equipment, ssuch as the S77 line of progrrammable logiic controllers (PLC)\nor it can be uused independdently with othher control prooducts.\n\n\n**_Figure 1:_** **_Some Produucts in the_** **_Siemens SIIMATIC linee, including_**\n**_Stations and Engineerring Stationns_**\n\n\n**_PLCs, Operrator_**\n\n\nThe SIMATTIC STEP 7 ssoftware envirronment is uused specificallly for the prrogramming oof the\nSiemens S7 line of controollers. An inteegrated solutioon, composed of S7 PLC's, WWinCC visualizzation\nsoftware, annd STEP 7 connfiguration sofftware, is thenn referred to aas SIMATIC PCS 7. All commputer\nsoftware commponents run on Microsoft Windows opeerating systemms, including XXP, Server 20003 and\nWindows 7.\n\nIn understannding the SIMMATIC PCS 7 system, it is immportant to sepparate the functional compoonents\nthat are caalled “systemss” from theirr platform coomponents thhat commonlyy carry namees like\n“stations” orr “servers”.\n\n\nThe basis of the SIMATIIC PCS 7 conttrol system is\nshown in Figgure 2:\n\n\ndivided into three functioonal componennts as\n\n\n\n- Opeerator System (OS)\n\n\n\n- Auttomation Systeem (AS)\n\n\n\n- Enggineering System (ES)\n\n\nFeb a 222 2011\n\n\n3\n\n\n-----\n\nTofino Security | Abterra Technologies | ScadaHacker.com **White Paper: How Stuxnet Spreads**\n\n**_Figure 2: Core Functional Components of the Siemens SIMATIC PCS 7 Control_**\n**_System_**\n\nThe Operator System (OS) permits the secure interaction of the operator with the process under\ncontrol of PCS 7. Operators can monitor the manufacturing process using various visualization\ntechniques to monitor, analyze and manipulate data as necessary. The Operator System\narchitecture is highly flexible, but always consists of a client and server function, which may be\nimplemented on the same or separate physical platforms.\n\nThe Automation System (AS) is the name given to the class of programmable logic controllers\n(PLC) used with PCS 7. This includes both the Microbox solution based on a software controller\nrunning on a standard computer, and the S7-300 and S7-400 lines of hardware controllers.\n\nThe Engineering System (ES) consists of software that is responsible for configuring the various\nPCS 7 system components. The ES is further broken down into the engineering software required\nto configure either the Operator System (OS) or Automation System (AS), since the OS requires\ndifferent engineering software for configuration than the AS. The ES allows for configuration and\nmanagement of the following PCS components and functions:\n\n        - Control system hardware including I/O and field devices\n\n        - Communication networks\n\n        - Automation functionality for continuous and batch processes (Application System\nengineering via STEP 7 software)\n\n        - HMI functionality (Operator System engineering via WinCC software)\n\n        - Safety applications (Safety Integrated for Process Automation)\n\n        - Diagnostics and asset management functionality\n\n        - Batch processes, automated with SIMATIC BATCH\n\n        - Material transport, controlled by SIMATIC Route Control\n\nFebr ar 22 2011 4\n\n\n-----\n\nTofino Security | Abterra Technologies | ScadaHacker.com **White Paper: How Stuxnet Spreads**\n\n        - Cooperation with host CAD/CAE planning tools (import and export of process tags and\nexample solutions)\n\nSince the ES functions are so broad, and cover such a wide range of tasks, Figure 3 below helps\nclarify the individual components of the ES.\n\n**_Figure 3: Components of the SIMATIC PCS 7 Engineering System_**\n\nA few Siemens SIMATIC PCS 7 _software or_ _platform components that are important to note in_\nunderstanding this paper include the following:\n**OS Server: The OS Server is one of the two components utilized within the PCS 7 Operator**\nSystem. The OS Server is used to establish communication with and access basic system level\ninformation from the AS components. This includes basic data collection functions for project\ndata, process values, archives, alarms and messages, as well as limited historical trend\ncapabilities. The OS Servers provide all process data to OS Clients. The OS Server can also be\nused for data collection and archival. However, this data can only be retrieved on OS Clients.\nOS Servers connect to both the Process Control Network (sometimes called the “terminal\nbus”) and the Control System Network (or “plant bus”). AS controllers are also connected to\nthe Control System Network.\n\n**OS Client: The OS Client is the operator terminal that receives data from one or more OS**\nServers. The OS Server and OS Client may be installed on the same hardware platform in\nsmaller systems, or may be distributed into a true client-server configuration on larger\nconfigurations. OS Clients are connected to the Process Control Network.\n\n**WinCC Server: The WinCC Server is the second major component comprising the Operator**\nSystem. It acts as the core server for the Human Machine Interface client/server system,\nallowing multiple, coordinated HMI client stations to be operated together with process data,\narchive data, messages, screens and reports. The WinCC Server, like the OS Servers, connects\nto both the Process Control Network and the Control System Network.\n\n**WinCC Client: The WinCC Client is part of the general-purpose WinCC SCADA**\nvisualization package used to provide monitoring and control of a particular manufacturing\nprocess. When installed with other PCS 7 and OS components, it provides an integrated\nautomation solution incorporating reliable communications, diagnostics functions, and\nintegrated engineering activities. In a typical system, the WinCC client is installed on the\nsame hardware platform as the OS Client, and is connected to the Process Control Network.\n\n**Web Navigation Server: The Web Navigation Server provides the capability to monitor**\n\nFebr ar 22 2011 5\n\n\n-----\n\nTofino Security | Abterra Technologies | ScadaHacker.com **White Paper: How Stuxnet Spreads**\n\nand control the process from external workstations interconnected via an Enterprise Control\nNetwork like a company Intranet or even the Internet using standard browser technology.\nThis allows access to the PCS 7 system without the need to install PCS software on the\nworkstations. The Web Navigation Server is installed on a WinCC Server that manages the\nconnection to the PCS 7 system, and allows external access without the clients connecting\ndirectly to the PCS 7 system used for real-time control. The Web Navigation Server is\nconnected to the Perimeter Network.\n\n**OS Web Server: The OS Web Server provides the ability to access PCS 7 information**\nremotely functioning in a similar fashion to the Web Navigation Server. Unlike the clients\nusing the Web Navigation Server for access to visualization displays of the underlying PCS 7\nsystem, the OS Web Server provides standard Internet access to PCS 7 data functions like\nprocess values, archives, alarms and messages, historical trend data, etc. This may include\nconnections from systems such as Manufacturing Execution Systems (MES) or Enterprise\nResource Planning (ERP) systems that reside on the Enterprise Control Network. The OS\nWeb Server is connected to the Perimeter Network.\n\n**CAS Server: The Central Archive Server (CAS) is used to provide central data management**\nand long-term data archival. This data is then accessible on local PCS 7 OS stations (OS\nClient, WinCC Client) on the Process Control Network and external workstations on the\nEnterprise Control Network using a standard Internet browser. The CAS Server is connected\nto the Perimeter Network.\n\n**Engineering Station: An Engineering Station can either be connected to the Process**\nControl Network, or it can reside remotely, where it is referred to as a Support Station. This\nplatform contains all PCS 7 client software components, including the OS Client, WinCC\nClient, and STEP 7 configuration tools.\n\n#### What is Stuxnet – A Primer[i]\n\nStuxnet is a computer worm designed to infect Siemens SIMATIC WinCC and S7 PLC products,\neither installed as part of a PCS 7 system, or operating on their own. It starts by taking advantage of\nvulnerabilities in the Windows operating systems and Siemens products. Once it detects a suitable\nvictim, it modifies control logic in specific models of Siemens PLCs. The objective appears to be to\nsabotage a specific industrial process using two vendors’ variable-frequency drive controllers, along\nwith a supervising safety system for the overall process. While there has been much speculation on\nStuxnet’s intended target, recent information suggests it was Iran’s nuclear program and more\nspecifically, its uranium enrichment process.\n\nStuxnet is capable of infecting both unsupported/legacy and current versions of Windows including\nWindows 2000, Windows XP, Windows Server 2003, Windows Vista, Windows Server 2008 and\nWindows 7. It also infects the Siemens STEP 7 project files in such a way that it automatically\nexecutes when the STEP 7 project is loaded by an uninfected Siemens system.\n\n**How Does Stuxnet Spread?**\n\nStuxnet is considered by many to be one of the most complex and well-engineered worms ever seen.\nIt took advantage of at least four zero-day vulnerabilities[ii] and showed considerable sophistication\n\ni For a detailed analysis of Stuxnet’s internal design, see the Symantec paper “w32_stuxnet_dossier.pdf”at\nhttp://www.symantec.com/content/en/us/enterprise/media/security_response/whitepapers/w32_stuxnet_dossier.\npdf\n\nii Zero-day vulnerabilities are defined in this paper as vulnerabilities for which no patch has been issued by the\nvendor.\n\nFebr ar 22 2011 6\n\n\n-----\n\nTofino Security | Abterra Technologies | ScadaHacker.com **White Paper: How Stuxnet Spreads**\n\nin its exploitation of both the Windows platform and the Siemens systems. Some of the important\ncharacteristics of the worm are:\n\n        - It propagates slowly between sites, typically via USB flash drives and other “removable”\nmedia,\n\n        - It propagates quickly within a site via multiple network pathways,\n\n        - It searches for many vendors’ anti-virus technologies on machines being attacked and\nmodifies its behavior to avoid detection,\n\n        - It contacts a command and control server on the Internet for instructions and updates,\n\n        - It establishes a peer-to-peer network to propagate instructions and updates within a site,\neven to equipment without direct Internet connectivity,\n\n        - It modifies PLC programming logic, causing physical processes to malfunction,\n\n        - It hides the modified PLC programs from control engineers and system administrators who\nare trying to understand why their system has malfunctioned,\n\n        - It is signed with certificates stolen from one of two major hardware manufacturers, so that\nno warnings are raised when the worm is installed, and\n\n        - If a particular machine is not the intended target, the worm removes itself from the\nmachine after it has replicated itself to other vulnerable media and machines.\n\nThe worm propagates using three completely different mechanisms:\n\n1. Via infected Removable Drives (such as USB flash drives and external portable hard disks);\n\n2. Via Local Area Network communications (such as shared network drives and print spooler\nservices), and\n\n3. Via infected Siemens project files (including both WinCC and STEP 7 files).\n\nWithin these three, it uses seven different vulnerability exploitation techniques for spreading to\nnew computers in a system. The worm:\n\n1. Exploits a zero-day vulnerability in Windows Shell handling of LNK files; a vulnerability\npresent in all versions of Windows since at least Windows NT 4.0,\n\n2. Uses several techniques to try to copy itself to accessible network shares and spread from\nthere if at all possible,\n\n3. Copies itself to printer servers using a zero-day vulnerability,\n\n4. Uses an older “Conficker” RPC vulnerability to propagate through unpatched computers,\n\n5. Contacts Siemens WinCC SQLServer database servers and installs itself on those servers\nvia database calls, and\n\n6. Puts copies of itself into Siemens STEP 7 project files to auto-execute whenever the files are\nloaded.\n\n7. An earlier version of the worm used a variant of the old “autorun.inf” trick to propagate via\nUSB drives.\n\nIn addition to the propagation techniques described above, the worm used two zero-day\nvulnerabilities to escalate privilege on targeted machines. This provided the worm with “system”\naccess privileges so it could copy itself into system processes on compromised machines.\n\n**What Does Stuxnet do to Control Systems?**\n\nWhen first installed on a computer with any STEP 7 software installed, Stuxnet attempts to locate\nSiemens STEP 7 programming stations and infect these. If it succeeds, it replaces the STEP 7 DLL\n\nFebr ar 22 2011 7\n\n\n-----\n\nTofino Security | Abterra Technologies | ScadaHacker.com **White Paper: How Stuxnet Spreads**\n\nroutines on the programming stations, so that any person viewing a PLC’s logic would not see any\nchanges Stuxnet later makes to the PLC. These actions occur on all computers with STEP 7 software\ninstalled, irrespective of whether the compromised computers are connected to PLCs.\n\nStuxnet then looks for specific models of Siemens PLCs (6ES7-315-2 and 6ES7-417). If it is able to\nconnect to one of these two models, it “fingerprints” the PLC by checking for the existence of certain\nprocess configurations and strings in the PLC.\n\nIf Stuxnet finds what it is looking for in the PLC, it starts one of three sequences to inject different\nSTEP 7 code “payloads” into the PLC. The PLC’s PROFIBUS driver is replaced and the main PLC\nprogram block (Organizational Block 1) and the primary watchdog block (Organizational Block 35)\nare significantly modified. As well, depending on which sequence is selected, between 17 and 32\nadditional function blocks and data blocks are injected into the PLC.\n\nTwo of Stuxnet’s injected payloads are designed to change the output frequencies of specific\nVariable Frequency Drives (VFDs) and thus the speed of the motors connected to them, essentially\nsabotaging an industrial process[iii].\n\nA third payload appears to be designed to control the overall safety system for the centrifuges. This\npayload takes the inputs coming from the PLC’s I/O modules and modifies them so that the PLC\nsafety logic uses incorrect information. The Stuxnet logic then tells the PLC’s outputs to do what it\nwants. This is possibly to prevent a safety system from alarming on or overriding the changes the\nworm is making to the VFD operations.[ iv]\n\n#### The Target – A High-Security Site\n\nIn this part of the analysis, we propose a hypothetical site that is the worm’s target. As noted earlier,\nwe assume this site is following all the guidance provided for “high security” sites in Siemens’\n“Security Concept PCS 7 and WinCC – Basic Document.”\n\nIt is important to note that the Siemens recommendations for protecting control systems were\nselected both because the Stuxnet worm specifically targeted Siemens PLCs and because the\nSiemens recommendations are a good example of existing “best-practice” recommendations.\nNothing in this discussion is intended to imply that Siemens control systems are less secure than\ncompeting control system solutions. In fact, it is the opinion of the authors that a majority of\nindustrial sites are protected much less thoroughly than is the hypothetical Siemens site described\nin this paper.\n\n**Networks at a High Security Site**\n\nAccording to the Siemens documentation, the high security site is separated into at least four\nsecurity zones as illustrated in Figure 4:\n\n        - The pink “Enterprise Control Network” zone is the corporate network, which hosts\nmost business users and business accounting and planning systems, such as Enterprise\nResource Planning (ERP) systems. The Enterprise Control Network may itself be separated\ninto additional sub-networks, each with their own protections. Such segmentations and\nprotections are typically established and managed by the corporate IT group.\n\niii The target process is now widely believed to be the centrifuges at Iran’s Natanz uranium enrichment facility, but\nthis has not been confirmed.\n\niv Stuxnet experts currently disagree on whether the code path targeting 417 PLCs is actually disabled (blocked by an\nexception) in Stuxnet. If this is correct, why the author(s) disabled but did not remove the 417 code altogether is\nunknown.\n\nFebr ar 22 2011 8\n\n\n-----\n\nTofino Security | Abterra Technologies | ScadaHacker.com **White Paper: How Stuxnet Spreads**\n\n**_Figure 4: The Hypothetical ICS Network Architecture_**\n\n        - The yellow “Manufacturing Operations Network” zone hosts the SIMATIC IT\nservers, which exchange information between the control system, the ERP system, and\nother important applications on the Enterprise Control Network.\n\n        - The brown “Perimeter Network” zone hosts servers that manage equipment in the\ncontrol system, and servers that provide information to end users on the Enterprise\nControl Network. This is a common location for servers responsible for providing software\npatches and updates, including Windows security updates and anti-virus updates. Many of\nthe servers within this zone provide information to end users via web servers and web\nservices. People sometimes refer to this zone as a “demilitarized zone” or DMZ.\n\n        - The green security zone hosts two networks: the green “Process Control Network” and\nthe blue “Control System Network.” The Process Control Network hosts the 24x7 plant\noperators on their Human Machine Interface (HMI) workstations, and is also connected to\nthe WinCC/PCS 7 control system servers. The Control System Network is connected to a\nnumber of Programmable Logic Controllers (PLCs) and is also connected to the\nWinCC/PCS 7 control system servers.\n\nIn a large facility, there are frequently multiple “green” zones, one for each control center or\noperating area. For example, a large chemical plant may have as many as twenty or thirty operating\n\nFebr ar 22 2011 9\n\n\n-----\n\nTofino Security | Abterra Technologies | ScadaHacker.com **White Paper: How Stuxnet Spreads**\n\nareas, each with their own SIMATIC PCS 7 system, and each controlling a large portion of the\nfacility with both input and output storage facilities to help decouple operational disturbances\nbetween areas. These areas are able to operate independently of other portions of the large facility\nfor some period of time. The facility may have many control rooms and corresponding server\nrooms, each hosting one or more control centers or operating areas.\n\nThe corporate wide area network (WAN) connects sites to one another, and connects different kinds\nof security zones within sites. Corporate IT manages the various enterprise networks and the\ncorporate firewalls which protect enterprise network segments.\n\nNote that while the Process Control Network and the Control System Network are different\nnetworks, they are both in the same security zone. WinCC and PCS 7 control system servers have at\nleast two network interfaces, one for each kind of network. The two networks are separated for\nperformance and technological reasons, not security reasons. In other words, the Control System\nNetwork is dedicated to traffic specifically related to “automation” and “control” such as traffic\nto/from process controllers/PLCs and servers, while traffic on the Process Control Network is\nutilized for “information” and “display” such as that between HMI’s and servers.\n\n**Internet Security and Acceleration (ISA) Servers**\n\nIn the recommended architecture, Microsoft Internet Security and Acceleration (ISA) Servers\nprotect the plant zones from the WAN. They also protect zones from each other. All traffic between\nsecurity zones passes through an ISA server. Each ISA server hosts a number of functions, such as\nfirewall services, network address translation, web proxies, virus scanning and secure web server\npublishing.\n\nAll of the ISA servers are configured by default to block connections originating in less-trusted\nnetworks, such as the corporate WAN. The ISA servers allow connections, such as web services\nconnections, from clients on less-trusted networks to selected servers, such as web servers, in the\nPerimeter Network.\n\nServers that receive connections from less-trusted networks are specifically hardened. The ISA\nservers manage connections to servers in the Perimeter Network, and allow VPN and web\nconnections only for authorized users with legitimate credentials via the WAN.\n\nThe ISA servers are also configured to allow machines inside the protected networks to initiate\nconnections “outward” to specific machines and services on less trusted networks. Those\nconnections may pass through the corporate WAN to external servers such as vendor websites on\nthe public Internet. However, connections from protected equipment to arbitrary sites on the\nEnterprise Control Network or the Internet are not allowed. Just like inbound connections, the\noutbound connections through the ISA firewalls are “deny by default,” with only specific, approved\nconnections to external servers permitted.\n\nIt should be mentioned that Windows ISA Server was originally introduced in 2001 to run on the\nWindows 2000 platform. It was enhanced over the years with new editions released in 2004 and in\n2006, with both releases designed for the Windows Server 2003 platform. The Siemens Security\nConcept document is based on the ISA Server 2006 platform. Today, Microsoft offers the Forefront\nThreat Management Gateway which was released in 2009 and builds upon the ISA 2006 platform\noffering new features including support for the Windows Server 2008 and 2008R2 platforms. For\nadditional information on ISA and Forefront TMG, please consult Microsoft’s product\ndocumentation.\n\n**Virtual Private Network Connections**\n\nThe ISA servers also mediate Virtual Private Network (VPN) connections into protected networks.\nFrom time to time, workstations and laptops whose security is managed by third parties are allowed\nto connect to protected networks through the ISA servers. Such connections are labeled as “support\nstations” in Figure 4. Support stations are used most commonly for remote engineering activities or\nvendor support activities. The stations may be at the site, or at a remote corporate site, connected\nindirectly to the corporate WAN, with their access into corporate networks other than the WAN\n\nFebr ar 22 2011 10\n\n\n-----\n\nTofino Security | Abterra Technologies | ScadaHacker.com **White Paper: How Stuxnet Spreads**\n\nmediated by either corporate firewalls or the ISA servers. The vendors may also be at other “noncorporate” remote sites, connecting directly to the ISA servers from quarantine zones served by\nrouters.\n\nWhen these support stations access protected network zones through an ISA firewall, the firewall\nauthenticates the VPN connection. If the vendor uses WinCC or other process applications that\nrequire access to the Process Control Network, the firewall allows a small number of connections,\nincluding WinCC and STEP 7 database connections, to protected servers. For broader access to\nprotected networks, the ISA server allows only VPN connections to remote access servers running\nMicrosoft Terminal Services or Remote Desktop Services. These are sometimes referred to as\n“jump hosts”, and are intended to provide isolation between the untrusted hosts, such as support\nlaptops, and the trusted hosts such as the servers and workstations on protected networks.\n\n**Host Hardening and Malware Prevention**\n\nIn addition to the firewall and perimeter protections the ISA servers provide, a variety of host\nhardening and malware prevention mechanisms are also in place, as specified by the Siemens\nsecurity architecture. On the Enterprise Control Network, all hosts are part of a comprehensive\npatch management program that provides automated and managed installation of critical software\npatches and hot fixes. All hosts have anti-virus and anti-spyware products installed, and signatures\nfor these products are distributed to all hosts immediately upon receipt from the anti-malware\nvendors.\n\nHosts have only those applications installed and services enabled that are essential to business\nfunctions. Enterprise workstations have access to the open Internet, but all web, ftp and email\ntraffic into the Enterprise Control Network is scanned for spam and malware at the Enterprise\nControl Network firewall. Select workstations on the Enterprise Control Network have VPN access\nconfigured to hosts on the Manufacturing Operations Network and hosts on the Perimeter Network,\nbut no workstations on the Enterprise Control Network have VPN access directly into the Process\nControl or Control System Networks.\n\nOn the Manufacturing Operations Network and the Perimeter Network all hosts are part of the\nsecurity program implemented at the corporate level. All hosts are current with Siemens patches,\nMicrosoft operating system and application patches, third party application patches, anti-virus and\nanti-spyware signatures, and all hosts have been reviewed to ensure that only applications and\nservices needed for the correct operation of the host and appropriate network are running. On the\nProcess Control Network and Control System Network, hosts are hardened and are running antivirus software, but the hosts are not part of the corporate patch management system. Operations\nmanages patches on these critical networks, and subjects new Siemens, Microsoft and third-party\npatches to a rigorous testing process before approving the patches for deployment on critical system\ncomponents.\n\nThe Microsoft Windows Server Update Services (WSUS) servers manage deployment of approved\npatches, and such deployment is staged so that if unexpected problems arise when patches are\ndeployed, the affected equipment can be taken offline and rolled back without impacting the overall\nperformance of the control system. In addition, operations manages the anti-virus servers for\nProcess Control and Control System Networks, testing all new signature sets before approving them\nfor deployment, and staging deployment of signature sets just like patch deployment is staged. The\nWSUS servers also provide management of the deployment of patches allowing users to configure\nthe specific hosts and their timing and sequencing of installation in order to minimize any risk\nassociated with patch rollout. This ensures that equipment that develops unexpected problems\nbecause of new patches and signature sets can be taken offline and repaired without affecting the\noverall performance of the control system.\n\n#### Compromising the Network\n\nGiven the well-secured industrial control system described above, how could a worm like Stuxnet\never penetrate all the way to the PLCs? Yet clearly it did – Siemens reports that it is aware of at least\n22 sites that experienced infected control systems and certainly there were other sites, such as sites\n\nFebr ar 22 2011 11\n\n\n-----\n\nTofino Security | Abterra Technologies | ScadaHacker.com **White Paper: How Stuxnet Spreads**\n\nwith other vendors’ products, who would have not reported infections back to Siemens. Suggesting\npossible answers to this question is the goal of this paper.\n\nFor this analysis, assume that the date is May 1, 2010. At that date, the Stuxnet worm had been\nrefined over the course of about 12 months into its mature form, using the shortcut or LNK\nvulnerability rather than “autorun.inf” to propagate via USB drives. No patches existed for the zeroday vulnerabilities the worm used. No anti-virus signatures existed for the worm. No security\nresearchers knew the worm existed.\n\nWith the variety of propagation technologies available to the worm, many scenarios would lead to\nthe state-of-the-practice network described in the previous section to be compromised. The\ndiscussion that follows illustrates one way the target ICS could have been infiltrated. At each stage,\nalternative pathways are also noted.\n\n**_Figure 5: Compromising the Site’s Networks_**\n\nFebr ar 22 2011 12\n\n\n-----\n\nTofino Security | Abterra Technologies | ScadaHacker.com **White Paper: How Stuxnet Spreads**\n\n**Initial Handoff of the Worm[v]**\n\nIn our primary scenario, a company employee returns from an off-site visit to a contractor’s facility\nwith an infected USB flash drive. The employee has been given the infected drive deliberately by a\nsaboteur employed at the contractor facility.\n\n**Alternative pathways: the infected drive may have been simply targeted at the contractor with**\nthe assumption that the worm would eventually be transferred to the target site. Most\ncontractor/client relationships are well known in the industry, making selection of a suitable\ncontractor relatively easy.\n\nThe initial handoff of the worm to an employee of the target company could also occur at industry\ntradeshows. Free “branded” USB flash drives are commonly used as give-aways by vendors or as an\nalternative to CD’s for distribution of conference materials. In the past year, one of the authors of\nthis paper was given a “new” USB drive at a major control vendor tradeshow as a gift. The USB\ndrive was infected!\n\nThe worm could have also been sent to the organization through a targeted email that contained a\nspecial dropper program designed to install Stuxnet. For example, the authors have been able to\nconstruct a proof-of-concept dropper for of Stuxnet that is based on an infected PDF.\n\n**Infection of Initial Enterprise Computer**\n\nOnce the employee inserts the infected USB flash drive into his workstation and navigates to the\ndrive using Windows Explorer, the workstation is immediately infected. Anti-virus on the\nworkstation does not generate any alerts, because there are no signatures for the Stuxnet worm at\nthis time. The fact that the workstation is fully patched is of no help, because the LNK vulnerability\non shortcut files that the worm uses to infect the machine has no patch at this point in time. Nor do\nthe escalation of privilege vulnerabilities the worm uses to gain system-level access on the\nworkstation. The worm is also able to install what is called “rootkit” software that hides the files\nused by the worm when browsing the infected flash drive.\n\n**Alternative pathways: The initial infection of a computer on the target company network could**\nalso occur by the contractor supplying PLC project files that are infected. Due to the nature of\ncontractor/client relationships and the need for continuous collaboration, a variety of project files\nare freely exchanged between team members. These files not only include the PCS 7 project files\nthat the Stuxnet worm could piggy back on, but also other potentially vulnerable file formats\nincluding drawing, spreadsheet, database and PDF files that future worms could exploit. It is\nunlikely that the transfer of these files can be completely prevented, since many are essential to the\nengineering design process.\n\n**Propagation to other Enterprise Computers**\n\nAs noted earlier, once on a network, Stuxnet is designed to spread aggressively. Thus within a few\nhours, the worm would likely spread to printer servers and file servers on the Enterprise Control\nNetwork connected directly or indirectly to the compromised workstation.\n\nAt this point, the worm might lay dormant, infecting new USB flash drives as they are inserted into\ncompromised equipment, waiting for someone to carry such a flash drive and the worm to a\nprotected network. Alternatively, it may request new instructions from a command and control\nserver – see the section “Peer-to-Peer Networking” below. All personnel carrying and using\ninfected flash drives would be unaware that the worm is installed on their drives, because the\nrootkit hides the worm's files from the user.\n\n**Alternative pathways: Some additional alternative paths for infection of the Enterprise Control**\nNetwork include:\n\nv Analysis by Symantec indicates that the worm was initially handed off by its developers to at least five separate\norganizations inside Iran. Severally of these organizations were repeatedly targeted over a period of a year.\n\nFebr ar 22 2011 13\n\n\n-----\n\nTofino Security | Abterra Technologies | ScadaHacker.com **White Paper: How Stuxnet Spreads**\n\n        - The employee may have attached an “approved” external drive to an infected machine\nwhile visiting a contractor and subsequently brought this drive back into the company\nnetwork.\n\n        - The employee may have connected his or her laptop to a compromised network offsite, and\nthus infected the laptop and then subsequently connected it to the Enterprise Control\nNetwork on his or her return.\n\n        - A contractor may have visited the site, bringing and using a compromised external drive on\nthe site network.\n\n        - A contractor may have visited the site, bringing and using a compromised laptop on the\nsite network.\n\n        - A contractor or employee at another facility may have used a file share at this site over the\nWAN and so compromised the Enterprise Control Network.\n\n**Penetrating the Perimeter Network**\n\nIn our primary scenario, we will assume that one of the workstations on the Enterprise Control\nNetwork belongs to an employee who occasionally interacts with the person who manages the\nhistorian server on the Perimeter Network. As is commonly done in the industry, the manager has a\nfile share configured on his workstation, as do most employees in that group. The control system\nteam uses the shares on their own workstations to exchange large files with each other over the\nEnterprise Control Network, rather than exchange the files via the space-limited file servers located\non the Enterprise Control Network. Of course, only specific domain accounts are permitted to\naccess these shares.\n\nStuxnet uses the domain credentials of the user logged into the compromised machine to send a\ncopy of itself to the manager's workstation and activates that copy, compromising that workstation.\n\nIn many plants, the historian manager would routinely access the Siemens WinCC Central Archive\nServer (CAS) historian server from his workstation over a VPN. Typically, the administrator uses\nboth the web interface and Siemens OS Client to the historian to access the CAS server. The web\ninterface provides a view of functionality that the historian exposes to users, and the OS Client\nallows the administrator to access advanced features of the historian, used primarily for\nconfiguration and administration tasks.\n\nSince the manager’s workstation is now compromised, the Stuxnet worm contacts the local instance\nof the SQLServer database “client” on the compromised workstation and discovers the OS Clients'\nconnection to the WinCC database that is installed as part of all CAS servers. The worm contacts the\nWinCC SQLServer database on the CAS server and propagates to the CAS server on the Perimeter\nNetwork through that database connection. The worm installs itself on the CAS server by\nmanipulating both the CAS database contents and stored procedures within the database. The\nworm now has a foothold on the Perimeter Network.\n\n**Alternative pathways: Some alternate paths of infection of the Perimeter Network include:**\n\n        - At many “real world” sites, the Perimeter Network hosts are not patched routinely. As a\nresult, any VPN connection from a compromised host on the Enterprise Control Network\nto a host on the Perimeter Network using common Windows RPC communications is at\nrisk. Specifically any host on the Perimeter Network with no patch for the 2008 MS08-067\nvulnerability would allow the worm to compromise the Perimeter Network.\n\n        - While it does not follow the Siemens security recommendations, it is not unusual for the\nVPN connections from Enterprise Control Network workstations to the Perimeter Network\nto not aggressively restrict communications to specific ports and hosts. Often workstations\nwith VPN connections to the Perimeter Network can communicate with any port on any\nhost on the Perimeter Network. In such cases, any Enterprise Control Network workstation\nwith a VPN connection to the Perimeter Network puts at risk every server or workstation\non the Perimeter Network with file sharing enabled or a printer connected.\n\nFebr ar 22 2011 14\n\n\n-----\n\nTofino Security | Abterra Technologies | ScadaHacker.com **White Paper: How Stuxnet Spreads**\n\n        - A contractor or vendor using a remote access mechanism to provide assistance with the\nsupport of hosts on the Perimeter Network may remotely access that network from a\ncompromised laptop or workstation. If the contractor can communicate with any exposed\nfile shares or print spoolers on the Perimeter Network, that would permit compromise of\nthose hosts. If the contractor or vendor's workstation can communicate with any\nunpatched hosts exposing the MS08-067 vulnerability, that channel also permits\ncompromise of hosts on the Perimeter Network.\n\n        - While this does not follow the Siemens security recommendations, site administrators on\nthe Enterprise Control Network are known to use file shares to exchange information with\nservers on the Perimeter Network. Such file shares expose the Perimeter Network to\ncompromise.\n\n**Propagation to other Perimeter Network Computers**\n\nOnce the worm has a foothold in the Perimeter Network, it would attempt to infect any print servers\nand file servers it could discover. Next, the worm would identify the WinCC software installed on\nthe Web Navigation and CAS Servers, and would likely infect these local databases. It is also\npossible that if the Web Navigation Server is configured to use Terminal Services for remote access,\nthere could also be STEP 7 software installed on this host, offering the worm the opportunity to\ninstall itself inside the STEP 7 project files.\n\n**Propagation to Process Control Network and Control System Network**\n\nOnce the worm takes over the PCS 7 servers in the Perimeter Network, it is then trivial to utilize the\nnetwork connections that exist to the servers located in the Process Control Network to infect the\nservers within this zone.\n\nFurthermore, once the STEP 7 project files are infected, it is only a matter of time before an\nauthorized user copies a project file to the Process Control or Control System Networks. In\naddition, if an administrator were to copy these files to another plant at another site and use the\nfiles there, these STEP 7 project files would lead to compromise of that new site by the Stuxnet\nworm.\n\nIn addition, the WinCC Central Archive Server (CAS) on the Perimeter Network has database\nconnections configured through the ISA server, so that the historian server can request historical\ndata from Operator System (OS) Servers on the Process Control Network. The Stuxnet worm can\npropagate over these connections into these OS Servers and infect all servers on the Process Control\nNetwork which expose either print servers, file servers or which have WinCC or STEP 7 software\ninstalled on them. STEP 7 is typically installed on engineering stations, while WinCC is common on\nboth operator and engineering stations.\n\nSome of the compromised OS Servers manage connections to the S7 PLCs that control the physical\nprocess. The worm connects to those PLCs and modifies the programming in all the PLCs that\nmatch the worm's selection criteria. It also installs a special driver on the STEP 7 hosts effectively\nhiding any modified code from administrators or engineers querying the PLCs, making the worm\n“invisible” once it is installed on the PLC.\n\n**Alternative pathways: Alternative paths for infection of the Process Control and Control System**\nNetworks include:\n\n        - File shares or print spoolers may be exposed to hosts on the Perimeter Network. Even if a\nsite did not mean to expose such services on the Process Control Network to the Perimeter\nNetwork, WinCC components on the Perimeter Network make heavy use of Windows RPC\ncommunications to interact with components on the Process Control Network. Print\nspooling and file sharing use RPC communications. Any path through the ISA firewall that\npermits RPC communications would permit connections to print spoolers and file shares,\nregardless of whether such connections were anticipated by personnel designing ISA\nfirewall rules.\n\nFebr ar 22 2011 15\n\n\n-----\n\nTofino Security | Abterra Technologies | ScadaHacker.com **White Paper: How Stuxnet Spreads**\n\nFor example, if an OPC Classic server (such as OPC Data Access) on the Process Control\nNetwork serves information to an application on the Perimeter Network, that connection\nexposes the RPC communications path since it is the foundation of the OPC Classic\nprotocol.\n\n        - Most servers on the Perimeter Network use database connections to servers on the Process\nControl Network to acquire data for presentation to enterprise users. If any of those servers\nor workstations becomes compromised, the worm can propagate over that machine's\ndatabase connection to the Process Control Network.\n\n        - PLC programming projects may routinely be carried out on test beds for which security\nmeasures are weaker than those applied to production networks. Such test beds may\nbecome compromised by removable drives, remote vendors, connections to compromised\nenterprise hosts or other means. If those infected project files are communicated to hosts\non Process Control and Control System Networks, the worm compromises those new hosts.\n\n        - A contractor or vendor using a remote access mechanism to provide assistance with the\nsupport of hosts on the Process Control Network may remotely access that network from a\ncompromised laptop or workstation. If the contractor can communicate with any exposed\nfile shares or print spoolers on the Process Control Network that would permit\ncompromise of those hosts. If the contractor or vendor's workstation can communicate\nwith any unpatched hosts exposing the MS08-067 vulnerability, that channel also permits\ncompromise of hosts on the Process Control Network.\n\n        - Using an infected external drive on any single host on the Process Control Network would\ncompromise that host and the other computers on that network.\n\n**Peer-to-Peer Networking**\n\nAt this point in the scenario, the physical process may or may not immediately malfunction. The\nStuxnet worm was designed to contact one of two command and control (C&C) servers over the\nInternet for new instructions and updates. The worm exchanges information with these servers\nover the HTTP protocol, on port TCP/80. The payload of communications with those servers is\nencrypted, but the “envelope” for the communications is plain-text HTTP. None of the contents of\nthe HTTP traffic matches anti-spam or anti-malware rules in corporate Internet firewalls or\nintrusion monitoring systems (IPS/IDS), and so the traffic to the C&C servers is permitted through\nto the Internet.\n\nThe defense-in-depth posture of the example site however, forbids communication from any ISAprotected network with any machine on the open Internet, outside of a list of specifically authorized\nmachines. The C&C servers are not approved destinations, and direct communication between the\ninfected hosts on the trusted internal control networks and the C&C servers is effectively blocked.\nStuxnet works around this defense with a peer-to-peer (P2P) networking capability built into the\nworm, illustrated in Figure 6. The P2P network uses Windows remote procedure calls (RPC) as its\ntransport – the same protocol used by Windows file sharing, windows print spooling, OPC, and a\nnumber of Siemens proprietary data exchange protocols. RPC communications must be enabled\nwithin local area networks for the PCS 7 system to function. Thus, all of the infected equipment on\nthe Process Control and Control System Networks are interconnected by the P2P capability.\n\nIn this scenario, we will assume that one of the machines on the Process Control Network is used\nroutinely by a control system administrator on the Enterprise Control Network. The administrator\nconnects to the machine through a VPN connection configured to allow only Remote Desktop\n(RDC) traffic encrypted within the VPN tunnel. This way, a virus or worm on the administrator's\nmachine has minimal opportunity to propagate into the protected network. This administrator,\nhowever, routinely prints information from the OS Client machine on the Process Control Network\nwhile using the machine remotely. The printer is mapped to the administrator's Enterprise Control\nNetwork-connected workstation, and so an RPC connection has been allowed through the ISA\nfirewalls from the OS Client to the administrator's workstation.\n\nFebr ar 22 2011 16\n\n\n-----\n\nTofino Security | Abterra Technologies | ScadaHacker.com **White Paper: How Stuxnet Spreads**\n\nUnfortunately, this open RPC connection allows all RPC traffic, including the P2P RPC network that\nStuxnet uses. The administrator's workstation, being on the Enterprise Control Network, has no\nrestrictions on connectivity with new sites on the Internet. Since at the proposed time of this\nscenario (i.e. May 2010), no security researcher has yet discovered Stuxnet or the C&C servers;\nthose server addresses are not included in any list of banned sites on the corporate firewall.\n\n**_Figure 6: Command and Control Communications_**\n\nStuxnet takes over the administrator's workstation using the zero-day print spooler vulnerability,\nand uses the RPC connection with that workstation to extend the P2P network to the Enterprise\nControl Network. The P2P network now includes hosts that have contact with the C&C server, and\nthe entire network of compromised machines is put in contact with the Stuxnet authors' command\nand control servers.\n\nIt is important to point out that this path is successful because of the primary difference in\nphilosophy between the “deny by default” policy employed in the configuration of firewalls that\ninterface to trusted control system networks and the “allow outbound by default” policy commonly\nused in firewalls that connect corporate networks to the Internet.\n\nFebr ar 22 2011 17\n\n\n-----\n\nTofino Security | Abterra Technologies | ScadaHacker.com **White Paper: How Stuxnet Spreads**\n\nSome of the capabilities of the C&C servers have been determined through an examination of the\nStuxnet worm software, but nothing further has been published about any investigations into those\nservers. We know the Stuxnet worm's C&C communications and RPC communications software are\ncapable of receiving new versions of the worm and distributing those versions throughout the P2P\nnetwork. We also know the worm is capable of receiving new executables of any type, including PLC\nprogram function blocks, over those communications channels and is capable of executing them\nlocally.\n\nNo information is yet available as to what executables, besides new versions of the worm, may have\nbeen transmitted to infected sites. This ability to receive and run executables may have assisted in\nthe development of new versions of the worm, and could be used to help propagate the worm\nthrough specific target networks. That said, but nothing definitive has been published about how\nthe ability to run arbitrary files was in fact used.\n\n**Alternative pathways: Alternative paths of communications with command and control servers**\ninclude:\n\n        - WinCC components on the Perimeter Network make heavy use of Windows RPC\ncommunications to interact with components on the Process Control Network. All such\ncommunications paths through the ISA firewall, including OPC Classic connections, permit\nRPC P2P communications as well.\n\n        - While not described in the Siemens security recommendations, at many sites\nadministrators on the Enterprise Control Network use file shares to exchange information\nwith servers on Perimeter Network. Paths through the ISA firewall that permit such\ncommunications also permit Stuxnet P2P traffic.\n\n        - While not described in the Siemens security recommendations, at many sites the VPN\nconnections from Enterprise Control Network workstations to the Perimeter Network do\nnot aggressively restrict communications to specific ports and hosts; most workstations\nwith VPN connections to the Perimeter Network can communicate with any port on any\nhost on the Perimeter Network. In such cases, any compromised host on the Enterprise\nControl Network with a VPN connection to the Perimeter Network exposes its P2P\ncommunications capability to all compromised hosts on the Perimeter Network.\n\n        - Even if communications with command and control servers are successfully blocked, any\nroute the original infection either used or could have used can serve as a route through\nwhich updates to the worm are propagated. When new versions of the worm are installed\non compromised machines, they re-propagate just as the original worm did. This kind of\ncommunication path, however, can only be used to update copies of the worm, not to\ninteractively and remotely execute arbitrary files on compromised hosts.\n\n#### Discussion\n\nIf you have managed to stay with the analysis to this point, we congratulate you. One of the key\nlessons from this analysis is just how complex and interconnected a typical control system is.\nPotential pathways exist right from the outside world, through the Enterprise Control Network and\ndown to the process controllers.\n\n**SCADA/ICS Complexity: Many Roads Lead to Rome**\n\nBecause of this complexity, Stuxnet had many possible pathways to get to its target process. In\nFigure 7, we have attempted to summarize some of these pathways in an attack graph or infection\ndata flow diagram. As complicated as this diagram looks, it is certainly incomplete – there are likely\nmany other potential paths this worm (and future worms) might take that we have missed.\n\nFebr ar 22 2011 18\n\n\n-----\n\nTofino Security | Abterra Technologies | ScadaHacker.com **White Paper: How Stuxnet Spreads**\n\n**Worm** Targeted Email\n**Creator** Infected USB With Dropper\n\nDrive\n\nSabotage Sabotage Worm Creator\n\nExternal Source\n\n\nTargeted Email\nWith Dropper\n\n\nContractor\nRemote\nAccess\n\n\nExternal Source\nInitial Asset\n\nInitial\nAsset\nEnterprise\nControl Network\n\nEnterprise\nControl Network\nPerimeter\nNetwork\n\nPerimeter\nNetwork\nProcess Control\nNetwork\n\nProcess\nControl Network\nControl System\nNetwork\n\nControl\nSystem Network\nIndustrial\nProcess\n\n\nInfected\nUSB Drive Web Nav\n\nServer\n\nNetwork WinCC DB\nShare Exploit\n\nNetwork\nShare\n\nOS Network WinCC\nServer Share Server\n\nLogic Logic\nModification Modification\n\nS7-315\nPLCs\n\nI/O Modification\n\n**Target**\n**Industrial**\n**Process**\n\n**_Figure 7: Partial Stuxnet Attack Graph_**\n\n|Sab|Worm Creator Infec D otage Sabotage|Targeted Email ted USB With Dropper rive|Col4|\n|---|---|---|---|\n|Tradeshow Contractor rgeted Email Infected ith Dropper Infected USB Drive USB Drive S7 Project Files||||\n|S7 Project Infected S7 Project Files USB Drive Employee Files S7 Project Infected Files USB Drive Contractor Remote Access Employee External Cont Laptop Workstation Drive Re Ac||||\n|Network Print Server Server Share Vuln Service Vuln Network Print Server S7 Project Lnk Vuln Share Vuln Files ECN Servers Network Share Employee Remote Access Network Share Historian Employee Managers Remote Access Workstation WinCC DB Exploit||||\n|CAS Server WinCC DB Network Print Server Server S7 Project Exploit Share Vuln Service Vuln Files fected B Drive Web Nav Network Server Share Network WinCC DB S7 Project Share Exploit Files Network Server||||\n|Share Service Vuln OS Network WinCC Network Engineering Server Share Server Share Station Logic Logic Logic||||\n|Modification Modification Modification S7-315 S7-417 PLCs Safety PLCs||||\n|I/O Modification I/O Modification Target Industrial Process||||\n\n\nFebr ar 22 2011 19\n\n\n-----\n\nTofino Security | Abterra Technologies | ScadaHacker.com **White Paper: How Stuxnet Spreads**\n\nTo make matters worse, some of the stages might be completely bypassed by the worm. For\nexample, the infected USB storage drive might have first compromised one of the Support Stations\nand so gained direct entrance to Perimeter or Process Control networks[vi]. Alternatively, a PLC\nprogramming laptop, used and infected at another site, might have been carried directly into the\nControl Network and used to program the target PLCs. In these situations, many of the security\ncontrols proposed by the Siemens’ Security Concept documents would be completely circumvented.\n\n**Excessive Focus on the USB Drive as an Attack Vector**\n\nWhat can the SCADA or control engineer learn from such a complicated diagram? First, that\nfocusing on a single path is a flawed defense. For example, the topic discussed most heavily\nthroughout most of the early Stuxnet discourse was the LNK vulnerability in the Windows\noperation system and how USB drives spread the worm. This was understandable as the novelty,\nsimplicity and zero-day nature of the LNK generated widespread interest in the IT community.\n\nUnfortunately, some companies immediately focused on banning USB drives in their control\nsystems areas, failing to realize it was only one tool in Stuxnet’s toolkit of nasty tricks. As the above\ndiscussion and diagram illustrate, Stuxnet could have propagated to its target without ever needing\nto use a USB drive as a pathway, using for example a compact disc (CD) with infected project files to\nlaunch the initial infection. Focusing on one path and failing to address the others is a serious\nsecurity failing.\n\nFurthermore, while it is easy to decree that all USB drives are banned from the plant floor, there are\nmany cases when the drives are the lesser of many security evils. For example, imagine if the\nnetwork connection to a plant floor device, such as a switch, fails. The maintenance team needs\ndiagnostic data to diagnose the failure. Plugging in a USB drive to download the logs is much safer\nthan plugging in a laptop, but a complete ban on USB drives can force staff to either resort to the\nless secure option, or do without the diagnostic data and most likely take much longer to diagnose\nand repair the root problem.\n\n**Attack Opportunities using Remote Procedure Calls**\n\nThe fact that the worm’s authors made heavy use of the RPC protocol for both propagation and the\nP2P network provides important lessons. RPC is an ideal protocol for SCADA and ICS attacks\nbecause it is used for so many legitimate purposes in modern control systems. For example, the\ndominant industrial integration technology, OPC Classic, is based on DCOM and thus requires that\nRPC traffic be allowed between process areas. Furthermore, control system servers and\nworkstations are routinely configured to share files or printers using the Microsoft RPC/SMB\ntransport between networks. Perhaps most relevant in this example, all Siemens PCS 7 systems\nmake extensive use of a proprietary messaging technology that travels over RPC. Simple blocking of\nRPC traffic at control systems firewalls would result in a self-induced denial of service for the entire\nprocess.\n\nRPC will be a potential pathway for ICS worms for some time to come. The complexity of this\nprotocol and its heavy use in proprietary systems means the opportunities for new zero-day\nvulnerabilities are significant. Stuxnet’s easy paths, such as USB drives, may soon be blocked at\nmany sites, but future worms will have many other paths to choose from – RPC, easily infected\nproject files, and widespread use of hardcoded passwords to mention a few.\n\n**Common-Cause Security Failures in ICS**\n\nIt is also important to consider the fact Stuxnet needed to attack both control and safety functions\nin the target system in order to be successful. It is not known whether the target system had these\nfunctions integrated in the same controller (i.e. the S7-315 PLC) or the S7-315 PLC provided the\n\nvi Support Stations connecting via the Back-Firewall will have a trusted connection to the Process Control Network,\nwhereas the Support Stations connecting via the Front-Firewall are typically only granted access to the semi-trusted\nPerimeter Network.\n\nFebr ar 22 2011 20\n\n\n-----\n\nTofino Security | Abterra Technologies | ScadaHacker.com **White Paper: How Stuxnet Spreads**\n\ncontrol functions while the S7-417 PLC provided safety functions. What is known is that the worm\nwas able to use a common protocol and programming system to affect both control and safety\nfunctions. This significantly reduced the complexity of the worm and the likelihood of failure.\n\nIn the safety industry, Stuxnet would be considered common cause failure mode. An effective\nmitigation is to ensure that control and safety functions are independent and diverse in mission\ncritical systems. Unfortunately, the current trend in the industry is increasing integration and close\ncoupling of these two functions.\n\n**Protecting the Crown Jewels**\n\nIs the situation hopeless? We certainly do not think so; we do believe that ICS/SCADA security best\npractices must improve significantly.\n\nFirst, the industry needs to accept that the complete prevention of control system infection is\nprobably impossible. Determined worm developers have so many pathways available to them that\nsome assets will be compromised over the life of a system.\n\nInstead of complete prevention, the industry must create a security architecture that can respond to\nthe full life cycle of a cyber breach. One area that needs attention is in the early identification of\npotential attacks. Currently, there are limited products available that are designed specifically for\nICS environments, and in particular, little in terms of inspecting data in transit within control\nsystem networks. However, many benefits can be realized from network behavior analysis and\nexisting intrusion detection technologies that use normal traffic patterns to capture anomalies\nindicating potential threats. These early warning signs can then be integrated with security event\nmonitoring tools capable of reading and analyzing event information from multiple control system\nhosts further offering insight into the state of the system. Complex alarm annunciation systems are\ncommon for plant safety; it is time that these same tools are used to address security issues that can\ncompromise safety.\n\nNext, the industry needs to focus on containment of attacks when prevention fails. For example,\nassuming that Iran was Stuxnet’s target, no matter what its engineering teams did, Stuxnet would\nhave likely infected a number of computers. However, the number of infected systems in Iran\n(estimated at 60,000) would have been significantly reduced with good zone-based design, such as\nis suggested by the ANSI/ISA-99 standards. This is an important lesson for all industrial sites\nanywhere in the world, as the next worm may not be so selective when choosing its victims.\n\nFurthermore, if Stuxnet had been prevented from making that final hop to the Siemens S7 PLCs,\nparticularly the S7-417 PLC that was possibly the safety system, then the actual process would have\nbeen safe. This is an important lesson that all SCADA/ICS asset owners should consider – while\ninfected computers are bad, infected safety systems are deadly. The effort spent securing these\n“last-line-of-defense” critical systems needs to match the seriousness of the consequences if they\nare breached.\n\n**The Need for Better Firewall Granularity and Deployment**\n\nThe use of firewalls as suggested in the Siemens Security Concepts documents could also be\nimproved. For example, the widely followed “NISCC Good Practice Guide on Firewall Deployment\n_for SCADA and Process Control Networks” suggests:_\n\n_An extension to this concept is the idea of using “disjoint” protocols in all PCN-enterprise_\n_communications. That is, if a protocol is allowed between the PCN and DMZ then it is_\n_explicitly NOT allowed between DMZ and enterprise networks. This design greatly reduces_\n_the chance of a worm such as Slammer actually making its way into the PCN/SCADA_\n_network since the worm would have to deploy two different exploits over two different_\n_protocols._\n\nUnfortunately, in the security architecture proposed by Siemens (and many other vendors), the\nsame protocols (particularly RPC) are allowed through multiple firewalls and zones. Rules that\nenforce disjoint protocols probably would not have stopped Stuxnet, as it did have different exploits\navailable, but they could make life much harder for the next worm developer.\n\nFebr ar 22 2011 21\n\n\n-----\n\nTofino Security | Abterra Technologies | ScadaHacker.com **White Paper: How Stuxnet Spreads**\n\nFinally, it should be clear that the idea of providing security by simply blocking or allowing entire\nclasses of protocols between areas is no longer sufficient. The fact that RPC was both critical to PCS\n7 operations and at the same time a major vector for Stuxnet highlights the need for the deep\npacket inspection (DPI) of key SCADA and ICS protocols. This type of fine-grained control of\nnetwork traffic is currently available for a few protocols, such as Modbus TCP and OPC, but DPI for\nother protocols is also needed.\n\n**Weak Industrial Security Culture**\n\nIt is important to reiterate that the analysis presented in this paper is based on a security model\nthat, though it is accepted in industry as a best practice, is often not implemented in practice.\nSystem architectures in the real world are typically much less secure than the one presented in the\nSiemens Security Concept document.\n\nThere are a number of reasons for this. One reason is that there are often inaccurate perceptions\nabout cyber security. For example, senior management at many firms believe their control systems\nto be completely isolated from the outside world, or they believe that a firewall separates systems\nsecurely and therefore their situation is equivalent to being isolated from outside threats.\n\nTo date, the perceived risk from external threats has been low, and has not merited more than a\ncursory understanding by management. This low risk perception has led to most organizations not\nbudgeting sufficient funds or people to protect their control systems from the multiple infection\npathways of advanced threats.\n\nFor example, most operators today have not sufficiently segmented their control networks to limit\nthe consequences of the occasional infection, do not have early warning infection detection systems\nin place, and do not include security assessments and testing as part of system development.\n\nAnother example; most procurement processes do not include security processes or components in\ntheir specifications. Any vendor who includes extra components such as security servers, software\nand appliances which are not specified and which involve additional costs are at a competitive\ndisadvantage and will often lose their bid. Similarly, ICS vendors investing additional resources in\ncreating a highly secure ICS product are likely to be at a competitive disadvantage in a world largely\nunaware of the need for security.\n\nIn addition to increased capital costs, there are ongoing operational and maintenance costs\nincurred to ensure that a strong initial security posture is maintained throughout the life of a\ndeployment. Not all ICS management teams have understood the need for these expenses.\n\nThe fact that the Siemens SQLServer systems had an embedded password that could not be\nchanged is an excellent example of the conflict between what many ICS customers are willing to pay\nfor and what is needed. This password was available on the Internet as early as 2008 and yet has\nnot been addressed even today. Clearly default passwords that are both unknown to the end user\nand that cannot be changed even if they are known is not acceptable, so why are they still in the PCS\n7 system?\n\nThe reason is that the cost of creating a changeable internal password system between the PCS 7\ncomponents is expensive, in terms of product modifications and deployment costs. While Siemens\nwill likely release a new version of the PCS 7 that allows modifiable passwords, the bulk of the cost\nwill be on the customers who have to deploy these changes in live and highly distributed ICS\nsystems. Thus, most ICS users have not demanded secure password management from any of their\nsuppliers, with Siemens just an unfortunate example.\n\nIn a post-Stuxnet world, vendors, management teams and technical teams need to undertake frank\nconversations about the risk to their operations of advanced threats, and allocate resources\naccordingly. In short, they need to work together to improve their industrial security culture and\npractices.\n\nFebr ar 22 2011 22\n\n\n-----\n\nTofino Security | Abterra Technologies | ScadaHacker.com **White Paper: How Stuxnet Spreads**\n\n#### Looking Forward\n\nStuxnet is certainly not the last worm of its kind that the SCADA/ICS industry will face. If Stuxnet\nwas successful in damaging its target, whatever that target was, it is wishful thinking not to expect\nthe injured party to respond in kind. Even if Stuxnet was not successful, it is clear that the\ninfrastructure of the developed and developing world is vulnerable to attack by malware as\nsophisticated as Stuxnet, and that enemies of different countries and cultures now have an example\nof how to structure their own malware to carry out such attacks. This analysis also demonstrates\nthat control systems are vulnerable not only due to the weaknesses of a particular vendor, but in\ngeneral with any vendor due to shortcuts or omissions from accepted industry best practices\naddressing security.\n\nGovernment agencies are not the only potential threat. Organized crime rings in many geographies\nhave demonstrated amply over the last several years that the skills needed to construct most of the\ncomponents of the Stuxnet worm are readily available on the black market. Acquiring the\nremaining PLC programming skills is a matter of identifying the target technologies, purchasing\nexamples of them, and purchasing and attending vendor training in one of the many geographies\nsuch training is offered. The payoff would be a powerful new tool for extortion threats against the\nmajor infrastructure providers – a style of attack that the banking industry has been dealing with\nfor close to a decade.\n\nIntegrating individual components into a single package like Stuxnet is something we have not seen\nbefore, but the required skills seem comparable to the skills required to produce any complex\nsoftware application. Creating another threat like Stuxnet seems straightforward for any\norganization with sufficient funds and a bit of time. Modifying copies of the Stuxnet worm to target\nother industrial platforms is also possible and should likely cost far less than writing an entirely\nnew worm.\n\nIf the critical infrastructures of the world are to be safe and secure, then the owners and operators\nneed to recognize that their control systems are now the target of sophisticated attacks and need to\nadjust their security programs accordingly. In particular, security programs need to:\n\n        - Consider all possible infection pathways and have strategies for mitigating those pathways,\nrather than focusing on a single pathway such as USB keys,\n\n        - Recognize that no protective security posture is perfect, and take steps to aggressively\nsegment control networks to limit the consequences of compromise,\n\n        - Install ICS-appropriate intrusion detection technologies to detect attacks and raise an\nalarm when equipment is compromised or at risk of compromise,\n\n        - Deploy, operate and maintain at maximum effectiveness ICS-appropriate security\ntechnologies and practices, including firewalls, antivirus technology, patching systems and\nwhitelisting designed for SCADA/ICS, to make attacks by sophisticated malware much\nmore difficult,\n\n        - Look beyond traditional network layer firewalls, towards firewalls that are capable of deep\npacket inspection of key SCADA and ICS protocols,\n\n        - Focus on securing last-line-of-defense critical systems, particularly safety integrated\nsystems (SIS),\n\n        - Include security assessments and testing as part of the system development and periodic\nmaintenance processes. Identify and correct potential vulnerabilities, thereby decreasing\nthe likelihood of a successful attack, and\n\n        - Work to improve the culture of industrial security amongst management and technical\nteams.\n\nThese changes to improve defense-in-depth postures for industrial control systems are needed\nurgently. Waiting for the next worm may be too late.\n\nFebr ar 22 2011 23\n\n\n-----\n\nTofino Security | Abterra Technologies | ScadaHacker.com **White Paper: How Stuxnet Spreads**\n\n#### Disclaimers\n\nSiemens control systems and Siemens recommendations for protecting control systems were used\nextensively in this example both because the Stuxnet worm specifically targeted Siemens control\nsystems, and because the Siemens recommendations are a good example of existing “best-practice”\nrecommendations. This discussion is intended to show how a powerful worm can compromise even\nwell defended systems. Nothing in this discussion is intended to imply that Siemens control\nsystems are less secure than competing control system solutions.\n\nOn the contrary, it is the opinion of the authors that a majority of industrial sites are protected\nmuch less thoroughly than is the Siemens site described as an example in this paper, and that a\nsimilar attack is equally likely on any control system platform. Many of the exploits utilized by\nStuxnet would be equally effective on any state-of-the-art platform based on modern computer and\ncontrol system technologies.\n\nMany of the images in this document are based on images provided in Siemens documentation.\n\n#### References\n\nFor more information about Stuxnet, Siemens PCS7 technology, the Siemens Security Concept and\nrelated topics, see the following references:\n\n**Siemens Automation**\n\nSIMATIC WinCC / SIMATIC PCS 7: Information concerning Stuxnet Malware:\n\nhttp://support.automation.siemens.com/WW/view/en/43876783\n\nSecurity concept PCS 7 and WinCC - Basic document:\n\nhttp://support.automation.siemens.com/ww/view/en/26462131/\n\n**Tofino Security White Papers and Application Notes**\n\nhttp://www.tofinosecurity.com/stuxnet-central\n\nAnalysis of the Siemens PCS7 “Stuxnet” Malware for Industrial Control System Professionals:\n\nhttp://www.tofinosecurity.com/professional/siemens-pcs7-wincc-malware\n\nUsing Tofino to Control the Spread of the Stuxnet Malware - Application Note:\n\nhttp://www.tofinosecurity.com/professional/using-tofino-control-stuxnet\n\nStuxnet Mitigation Matrix - Application Note:\n\nhttp://www.tofinosecurity.com/professional/stuxnet-mitigation-matrix\n\n**Detailed discussion on Stuxnet internals and how the worm works:**\n\nhttp://www.langner.com/en/\n\nhttp://www.symantec.com/content/en/us/enterprise/media/security_response/whitepapers\n/w32_stuxnet_dossier.pdf\n\nhttp://www.eset.com/resources/white-papers/Stuxnet_Under_the_Microscope.pdf\n\n**Microsoft Security Bulletins**\n\nhttp://www.microsoft.com/technet/security/bulletin/MS08-067.mspx\n\nhttp://www.microsoft.com/technet/security/bulletin/MS10-046.mspx\n\nhttp://www.microsoft.com/technet/security/bulletin/MS10-061.mspx\n\nhttp://www.microsoft.com/technet/security/bulletin/MS10-073.mspx\n\nhttp://www.microsoft.com/technet/security/bulletin/MS10-092.mspx\n\nFebr ar 22 2011 24\n\n\n-----\n\nTofino Security | Abterra Technologies | ScadaHacker.com **White Paper: How Stuxnet Spreads**\n\n**Microsoft Security Advisory (2286198)**\n\nhttp://www.microsoft.com/technet/security/advisory/2286198.mspx\n\nhttp://support.microsoft.com/kb/2286198\n\nhttp://support.microsoft.com/kb/2347290\n\n**US-CERT**\n\nhttp://www.us-cert.gov/control_systems/pdf/ICSA-10-201-01C.pdf\n\nhttp://www.us-cert.gov/control_systems/pdf/ICSA-10-272-01.pdf\n\nhttp://www.us-cert.gov/control_systems/pdf/ICSA-10-238-01B.pdf\n\n**CVE References**\n\nhttp://www.cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2008-4250\n\nhttp://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2010-2568\n\nhttp://www.cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2010-2729\n\nhttp://www.cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2010-2772\n\nFebr ar 22 2011 25\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/ICS SCADA/Stuxnet/How Stuxnet Spreads v1.0.pdf"
    ],
    "report_names": [
        "How Stuxnet Spreads v1.0.pdf"
    ],
    "threat_actors": [
        {
            "id": "aa73cd6a-868c-4ae4-a5b2-7cb2c5ad1e9d",
            "created_at": "2022-10-25T16:07:24.139848Z",
            "updated_at": "2025-03-27T02:02:10.120505Z",
            "deleted_at": null,
            "main_name": "Safe",
            "aliases": [],
            "source_name": "ETDA:Safe",
            "tools": [
                "DebugView",
                "LZ77",
                "OpenDoc",
                "SafeDisk",
                "TypeConfig",
                "UPXShell",
                "UsbDoc",
                "UsbExe"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "f9806b99-e392-46f1-9c13-885e376b239f",
            "created_at": "2023-01-06T13:46:39.431871Z",
            "updated_at": "2025-03-27T02:00:03.08926Z",
            "deleted_at": null,
            "main_name": "Watchdog",
            "aliases": [
                "Thief Libra"
            ],
            "source_name": "MISPGALAXY:Watchdog",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673536059,
    "ts_updated_at": 1743041819,
    "ts_creation_date": 1298306343,
    "ts_modification_date": 1298306343,
    "files": {
        "pdf": "https://archive.orkl.eu/13b8fb17dec659251a40f511f8b10170c18fec4e.pdf",
        "text": "https://archive.orkl.eu/13b8fb17dec659251a40f511f8b10170c18fec4e.txt",
        "img": "https://archive.orkl.eu/13b8fb17dec659251a40f511f8b10170c18fec4e.jpg"
    }
}