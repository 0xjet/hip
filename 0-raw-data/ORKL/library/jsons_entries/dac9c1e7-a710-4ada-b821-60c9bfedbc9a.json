{
    "id": "dac9c1e7-a710-4ada-b821-60c9bfedbc9a",
    "created_at": "2023-01-12T15:10:53.98151Z",
    "updated_at": "2025-03-27T02:05:41.170984Z",
    "deleted_at": null,
    "sha1_hash": "a29bd82ba1082cfc9f4f2f05282f403e609cfee1",
    "title": "2021-12-22 - CrowdStrike Launches Free Targeted Log4j Search Tool",
    "authors": "",
    "file_creation_date": "2022-05-27T22:06:25Z",
    "file_modification_date": "2022-05-27T22:06:25Z",
    "file_size": 1229908,
    "plain_text": "# CrowdStrike Launches Free Targeted Log4j Search Tool\n\n**crowdstrike.com/blog/free-targeted-log4j-search-tool/**\n\nRandy Burton - Ian Barton December 22, 2021\n\n[The recently discovered Log4j vulnerability has serious potential to expose organizations](https://www.crowdstrike.com/blog/log4j2-vulnerability-analysis-and-mitigation-recommendations/)\nacross the globe to a new wave of cybersecurity risks as threat actors look to exploit this\nlatest vulnerability to execute their malicious payloads using remote code execution (RCE).\n\nAn immediate challenge that every organization faces is simply trying to understand exactly\nwhere you have applications that are using this very popular Java library — but you are not\nfacing this challenge alone.\n\nThe CrowdStrike Services team has been busy developing a community tool that can be\nused to quickly scan file systems looking for versions of the Log4j code libraries to help\norganizations understand what they need to patch in order to mitigate their risk.\n\n[The free CrowdStrike tool (dubbed the CrowdStrike Archive Scan Tool, or “CAST”) performs](https://github.com/CrowdStrike/CAST)\na targeted search by scanning a given set of directories for JAR, WAR, ZIP and EAR files,\nand then it performs a deeper scan on those file types matching against a known set of\nchecksums for Log4j libraries. We help organizations find any version of the affected Log4j\nlibrary anywhere on disk, even if it is deeply nested in multiple levels of archive files.\n\n\n-----\n\nCAST searches for approximately 6,500 SHA256 checksums unique to the known vulnerable\nreleases. It will walk the files or directories scanning inside of ZIP-format archives to find\nevery instance of these. As we developed the tool, we carefully considered the following:\n\nBe mindful of the resource consumption when running a scan to minimize the impact\non end-user systems.\nIntentionally allow a higher number of false-positive results, leaving the decision in the\nhands of the system owners whether a given result warrants further investigation.\n\nWe may see higher false positives because we identify any trace of vulnerable\nversions of Log4j, even if the vulnerability has been addressed by removing one\nor more classes from the deployment.\nThe results should be extremely reliable, as they’re based on cryptographic\nchecksums.\nAllow use of the tool with pre-indexed (e.g., “locate”) file systems to avoid scanning\nand simply pass the paths to known files on the command line.\n\nFor example, locate -0 *.jar | xargs -0 ./cast\nProvide the ability to tune memory usage — for example:\n\n-recursion 0 to disable scanning sub-archives\n-recursion 1 to scan only 1 sub-archive deep\n-maxmem 1000000 to limit sub-archive scanning to 1MB (compressed)\n\nThe tool is intentionally single-threaded as we have to be conscious of resource consumption\nand allow users or administrators to manage their own resources. One thread will (in our\nexperience) scan a file system quickly enough. One could scan multiple directories\nsimultaneously by executing multiple copies of the tool, but the file system load would likely\ncause a noticeable user impact.\n\nStaying true to CrowdStrike’s cross-platform focus, we developed CAST as a tool that will\nrun on Windows, Mac and Linux systems, and we are using the tool in CrowdStrike\nServices engagements to assist our clients who need support to find Log4j instances.\n\nThe tool is easily deployed by simply downloading the binary to your disk and then executing\nthe binary with the directories or files you want to scan.\n\nFor example: “./cast /opt /srv /path/to/java/application”\n\n[CrowdStrike Falcon® customers also have the option to deploy and run the tool using the](https://www.crowdstrike.com/endpoint-security-products/)\nFalcon Real Time Response (RTR) capabilities in the Falcon sensor. A companion\nPowerShell script “Find-VulnerableLog4J” is included with CAST. This script is designed to\nbe executed on Windows systems via RTR and provide actionable information to systems\nadministrators and incident responders.\n\n\n-----\n\nOur incident responders know that forensic triage is a continual process of casting\nincreasingly fine nets, and identifying systems that warrant further investigation. Hence,\nCAST was designed to be a first-cast tool, narrowing investigative scope to a handful of\nmachines (or paths) with known vulnerabilities.\n\nCAST reports back in the form of a JSON file when it locates vulnerable Log4j libraries.\nOrganizations can use this output to get an understanding of where the Log4j libraries exist\nacross their environment so they can prioritize the systems that need to be patched using the\nlatest security updates released by Apache.\n\nCrowdStrike investigators use our Humio solution to load and analyze the data, but you can\nuse any visualization solution (such as ELK). You can also work through the data with a\nprogramming language or JSON query language of your choice — the events are intended\nto be portable.\n\nAnd finally, CrowdStrike recommends that you fully document your Log4j patching process to\nstreamline future patch application repeatability. Since the initial discovery of the Log4j\nvulnerability, Apache has released three security updates (patches) at the time of this blog.\nOrganizations that patched systems early in the process may need to reapply the latest\npatches, hence the need to fully document the process.\n\nWe hope you find the resources and tools in this blog useful as you cast your own net in your\nquest to identify Log4j vulnerabilities across your environment. We stand together when it\ncomes to defeating adversaries that try to exploit this vulnerability against us.\n\nOne team, one fight!\n\n**Additional Resources**\n\n\n-----\n\n_Visit the_ _[CrowdStrike Log4j Vulnerability Learning Center.](https://www.crowdstrike.com/log4j2/)_\n_[Download the CrowdStrike Log4j Quick Reference Guide.](https://www.crowdstrike.com/resources/guides/quick-reference-guide-log4j-remote-code-execution-vulnerability/)_\n_Access the_ _[CrowdStrike Archive Scan Tool (CAST).](https://github.com/CrowdStrike/CAST)_\n_Learn about the powerful, cloud-native CrowdStrike Falcon® platform by visiting the_\n_product webpage._\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-12-22 - CrowdStrike Launches Free Targeted Log4j Search Tool.pdf"
    ],
    "report_names": [
        "2021-12-22 - CrowdStrike Launches Free Targeted Log4j Search Tool.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673536253,
    "ts_updated_at": 1743041141,
    "ts_creation_date": 1653689185,
    "ts_modification_date": 1653689185,
    "files": {
        "pdf": "https://archive.orkl.eu/a29bd82ba1082cfc9f4f2f05282f403e609cfee1.pdf",
        "text": "https://archive.orkl.eu/a29bd82ba1082cfc9f4f2f05282f403e609cfee1.txt",
        "img": "https://archive.orkl.eu/a29bd82ba1082cfc9f4f2f05282f403e609cfee1.jpg"
    }
}