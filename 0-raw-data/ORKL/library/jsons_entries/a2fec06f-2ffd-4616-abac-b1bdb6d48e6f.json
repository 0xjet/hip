{
    "id": "a2fec06f-2ffd-4616-abac-b1bdb6d48e6f",
    "created_at": "2023-01-12T15:05:14.932267Z",
    "updated_at": "2025-03-27T02:16:47.004321Z",
    "deleted_at": null,
    "sha1_hash": "d48ff517b5cdcae4a0e277affe9bb9ddad5d85cd",
    "title": "2020-06-02 - Mustang Panda Recent Activity- Dll-Sideloading trojans with temporal C2 servers",
    "authors": "",
    "file_creation_date": "2022-05-28T03:47:56Z",
    "file_modification_date": "2022-05-28T03:47:56Z",
    "file_size": 192666,
    "plain_text": "# Mustang Panda Recent Activity: Dll-Sideloading trojans with temporal C2 servers\n\n**[lab52.io/blog/mustang-panda-recent-activity-dll-sideloading-trojans-with-temporal-c2-servers/](https://lab52.io/blog/mustang-panda-recent-activity-dll-sideloading-trojans-with-temporal-c2-servers/)**\n\nRecently, from Lab52 we have detected a recent malware sample, using the Dll-Sideload\ntechnique with a legitimate binary, to load a threat.\n\nThis particular sample has a very small DLL, that loads an encrypted file, which after being\ndecrypted consists of a sample of the PlugX Trojan. This technique, and final threat together,\nconsists of one of the most common TTPs among some APT groups generally of Chinese\norigin such as APT1, APT27 and Mustang Panda.\n\nThe sample in question is downloaded from the following link\n“http://miandfish.]store/player/install_flash_player.exe” and although in previous months, it\nhad another hash, currently the sample hosted under that name has the following hash\n“c56ac01b3af452fedc0447d9e0fe184d093d3fd3c6631aa8182c752463de570c”.\n\nThe binary consists of an installer, which drops in the folder “C:\\ProgramData\\AAM\nUpdatesnnk” the legitimate binary vulnerable to dll sideload, the small dll that acts as a\nloader for the final threat, and the binary file, which consists of the encrypted PlugX sample.\n\nAfter deploying the three files, the installer runs the legitimate binary, causing the final PlugX\nthreat to be loaded by it.\n\n\n-----\n\nIn this case, the legitimate vulnerable binary is part of Adobe’s Swite which will load any\nlibrary named “hex.dll” that is next to the executable.\n\nThat hex.dll, in this case is a very simple and relatively small loader:\n\n\n-----\n\nIt has 4 exports that return 0 without doing anything, the Main function of the library, on the\nother hand, calls a function that checks the existence of the .dat file which is hardcoded\n(adobeupdate.dat in this case), loads it, extracts the first string of the binary and uses it as\nXOR key to decode the rest of the file, which consists on the final threat.\n\nThe [following code in python imitates the logic of decoding:](https://raw.githubusercontent.com/Bondey/PlugxScripts/master/PlugDecoder.py)\n\n\n-----\n\nWhen it finishes deciphering it, it loads the malware into memory, makes a “Memprotect” to\nmake it executable and launches its logic from the byte 0 of the binary.\n\nIt is a functional PE, so this should not work, since it starts with the “MZ” header of a normal\nbinary:\n\nBut in this case it uses a technique already seen before in tools like the Cobalt Strike Beacon\nthat by modifying some bytes of the MZ header, it becomes meaningful executable code.\n\nIf we open the binary as a shellcode (de-compiling from byte 0) we see how they have\nmodified the first bytes into a routine that jumps to a code zone, consisting of a PE loader:\n\n\n-----\n\nAfter loading the IAT and leaving everything ready as a normal executable, this threat\ndecrypts its own config, which is encrypted in XOR in the .data section of the binary. This\ntime the decryption key is hardcoded in the binary, and is the string “123456789”.\n\nAfter decrypting its configuration, it contains the folder where the binary must be installed, a\nXOR key that will use to encrypt it’s traffic and a list of up to 4 domains or IP addresses of\ncommand and control servers together with the port to be used. Generally the 4 C2 elements\nconsists of the same domain repeated 4 times or 2 domains repeated twice each.\n\nAfter the analysis, both the loader in DLL format and the final encrypted threat (after\ndecryption) have been compared with different campaign samples of groups known to use\nthis dll sideload technique, and it has been possible to verify how both the loader and the\nfinal threat coincide in a high percentage with the samples of the “Mustang Panda” group\n[analyzed in the following reports [1]](https://www.anomali.com/blog/covid-19-themes-are-being-utilized-by-threat-actors-of-varying-sophistication) [[2]](https://blog.vincss.net/2020/03/re012-phan-tich-ma-doc-loi-dung-dich-COVID-19-de-phat-tan-gia-mao-chi-thi-cua-thu-tuong-Nguyen-Xuan-Phuc.html) [[3]. In fact, the loader of this campaign is able to load](https://blog.vincss.net/2020/03/re012-phan-tich-ma-doc-loi-dung-dich-COVID-19-de-phat-tan-gia-mao-chi-thi-cua-thu-tuong-Nguyen-Xuan-Phuc-phan2.html)\nand run the samples of the campaigns analyzed in those reports, and the final threat uses\nexactly the same XOR key to decipher its configuration as the samples in those reports, so\nthere is a high probability that it is a new campaign from this same group.\n\nThis particular sample has the domains “www.destroy2013.]com” and “www.fitehook.]com”\nas c2 servers, and we have seen that they have a very characteristic behavior, since most of\nthe day they resolve to 127.0.0.1, but from 1-3 AM (UTC) to 8-9 AM (UTC) it resolves to the\nIP “107.150.112.]250, except for weekends that it resolves constantly to 127.0.0.1, which\ncould indicate that it is a campaign that is focused on a time zone in which those hours are\nworking hours.\n\nIP 81.16.28.]30\n\nIP 107.150.112.]250\n\nDOMAIN www.destroy2013.]com\n\nDOMAIN www.fitehook.]com\n\nDOMAIN miandfish.]store\n\nSHA256 c56ac01b3af452fedc0447d9e0fe184d093d3fd3c6631aa8182c752463de570c\n\n\n-----\n\nSHA256 9c0f6f54e5ab9a86955f1a4beffd6f57c553e34b548a9d93f4207e6a7a6c8135\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2020/2020-06-02 - Mustang Panda Recent Activity- Dll-Sideloading trojans with temporal C2 servers.pdf"
    ],
    "report_names": [
        "2020-06-02 - Mustang Panda Recent Activity- Dll-Sideloading trojans with temporal C2 servers.pdf"
    ],
    "threat_actors": [
        {
            "id": "610a7295-3139-4f34-8cec-b3da40add480",
            "created_at": "2023-01-06T13:46:38.608142Z",
            "updated_at": "2025-03-27T02:00:02.87217Z",
            "deleted_at": null,
            "main_name": "Cobalt",
            "aliases": [
                "Cobalt Gang",
                "GOLD KINGSWOOD",
                "COBALT SPIDER",
                "G0080",
                "Mule Libra",
                "Cobalt Group"
            ],
            "source_name": "MISPGALAXY:Cobalt",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "dabb6779-f72e-40ca-90b7-1810ef08654d",
            "created_at": "2022-10-25T15:50:23.463113Z",
            "updated_at": "2025-03-27T02:00:55.47619Z",
            "deleted_at": null,
            "main_name": "APT1",
            "aliases": [
                "APT1",
                "Comment Crew",
                "Comment Group",
                "Comment Panda"
            ],
            "source_name": "MITRE:APT1",
            "tools": [
                "Seasalt",
                "ipconfig",
                "Cachedump",
                "PsExec",
                "GLOOXMAIL",
                "Lslsass",
                "PoisonIvy",
                "WEBC2",
                "Mimikatz",
                "gsecdump",
                "Pass-The-Hash Toolkit",
                "Tasklist",
                "xCmd",
                "pwdump"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "cf7fc640-acfe-41c4-9f3d-5515d53a3ffb",
            "created_at": "2023-01-06T13:46:38.228042Z",
            "updated_at": "2025-03-27T02:00:02.775905Z",
            "deleted_at": null,
            "main_name": "APT1",
            "aliases": [
                "GIF89a",
                "G0006",
                "PLA Unit 61398",
                "Group 3",
                "TG-8223",
                "Comment Group",
                "ShadyRAT",
                "COMMENT PANDA",
                "Comment Crew",
                "Byzantine Candor",
                "Brown Fox"
            ],
            "source_name": "MISPGALAXY:APT1",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "e3492534-85a6-4c87-a754-5ae4a56d7c8c",
            "created_at": "2022-10-25T15:50:23.819113Z",
            "updated_at": "2025-03-27T02:00:55.552554Z",
            "deleted_at": null,
            "main_name": "Threat Group-3390",
            "aliases": [
                "Threat Group-3390",
                "Earth Smilodon",
                "TG-3390",
                "Emissary Panda",
                "BRONZE UNION",
                "APT27",
                "Iron Tiger",
                "LuckyMouse"
            ],
            "source_name": "MITRE:Threat Group-3390",
            "tools": [
                "Systeminfo",
                "gsecdump",
                "PlugX",
                "ASPXSpy",
                "Cobalt Strike",
                "Mimikatz",
                "Impacket",
                "gh0st RAT",
                "certutil",
                "China Chopper",
                "HTTPBrowser",
                "Tasklist",
                "netstat",
                "SysUpdate",
                "HyperBro",
                "ZxShell",
                "RCSession",
                "ipconfig",
                "Clambling",
                "pwdump",
                "NBTscan",
                "Pandora",
                "Windows Credential Editor"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "2c980ea7-04c4-4193-8535-52f87e66a96e",
            "created_at": "2024-05-01T02:03:07.994126Z",
            "updated_at": "2025-03-27T02:05:17.293799Z",
            "deleted_at": null,
            "main_name": "BRONZE UNION",
            "aliases": [
                "Budworm ",
                "Emissary Panda ",
                "Iron Tiger ",
                "Lucky Mouse ",
                "TG-3390 ",
                "Temp.Hippo ",
                "APT27 "
            ],
            "source_name": "Secureworks:BRONZE UNION",
            "tools": [
                " ASPXSpy",
                " China Chopper",
                " Enfal",
                " Gh0st RAT",
                " HttpBrowser",
                " Hunter",
                " HyperBro",
                " OwaAuth",
                " PlugX",
                " PoisonIvy",
                " Sysupdate",
                " ZxShell",
                "9002"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "1691c25f-1aa4-4168-8ce2-7aa8f23246e7",
            "created_at": "2024-06-04T02:03:07.724221Z",
            "updated_at": "2025-03-27T02:05:17.284601Z",
            "deleted_at": null,
            "main_name": "BRONZE PRESIDENT",
            "aliases": [
                "Mustang Panda ",
                "Red Lich ",
                "Temp.Hex ",
                "HoneyMyte "
            ],
            "source_name": "Secureworks:BRONZE PRESIDENT",
            "tools": [
                " Cobalt Strike",
                " ORat",
                " PlugX",
                " RCSession",
                "China Chopper"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "c63ab035-f9f2-4723-959b-97a7b98b5942",
            "created_at": "2023-01-06T13:46:38.298354Z",
            "updated_at": "2025-03-27T02:00:02.798255Z",
            "deleted_at": null,
            "main_name": "APT27",
            "aliases": [
                "TG-3390",
                "EMISSARY PANDA",
                "TEMP.Hippo",
                "Budworm",
                "Group 35",
                "BRONZE UNION",
                "Lucky Mouse",
                "Iron Taurus",
                "GreedyTaotie",
                "Red Phoenix",
                "ZipToken",
                "Iron Tiger",
                "G0027",
                "Earth Smilodon"
            ],
            "source_name": "MISPGALAXY:APT27",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "b69037ec-2605-4de4-bb32-a20d780a8406",
            "created_at": "2023-01-06T13:46:38.790766Z",
            "updated_at": "2025-03-27T02:00:02.919758Z",
            "deleted_at": null,
            "main_name": "MUSTANG PANDA",
            "aliases": [
                "TEMP.HEX",
                "TA416",
                "TANTALUM",
                "Twill Typhoon",
                "Earth Preta",
                "Stately Taurus",
                "LuminousMoth",
                "Polaris",
                "BRONZE PRESIDENT",
                "HoneyMyte",
                "Red Lich"
            ],
            "source_name": "MISPGALAXY:MUSTANG PANDA",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "9baa7519-772a-4862-b412-6f0463691b89",
            "created_at": "2022-10-25T15:50:23.354429Z",
            "updated_at": "2025-03-27T02:00:55.45162Z",
            "deleted_at": null,
            "main_name": "Mustang Panda",
            "aliases": [
                "Mustang Panda",
                "TA416",
                "RedDelta",
                "BRONZE PRESIDENT"
            ],
            "source_name": "MITRE:Mustang Panda",
            "tools": [
                "Cobalt Strike",
                "RCSession",
                "NBTscan",
                "PoisonIvy",
                "PlugX"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "2ee03999-5432-4a65-a850-c543b4fefc3d",
            "created_at": "2022-10-25T16:07:23.882813Z",
            "updated_at": "2025-03-27T02:02:10.0116Z",
            "deleted_at": null,
            "main_name": "Mustang Panda",
            "aliases": [
                "Bronze President",
                "Camaro Dragon",
                "Earth Preta",
                "HoneyMyte",
                "Mustang Panda",
                "Operation SMUGX",
                "Operation SmugX",
                "PKPLUG",
                "Red Lich",
                "Stately Taurus",
                "TEMP.Hex"
            ],
            "source_name": "ETDA:Mustang Panda",
            "tools": [
                "9002 RAT",
                "AdFind",
                "Agent.dhwf",
                "Agentemis",
                "CHINACHOPPER",
                "China Chopper",
                "Chymine",
                "ClaimLoader",
                "Cobalt Strike",
                "CobaltStrike",
                "DCSync",
                "DOPLUGS",
                "Darkmoon",
                "Destroy RAT",
                "DestroyRAT",
                "Farseer",
                "Gen:Trojan.Heur.PT",
                "HOMEUNIX",
                "Hdump",
                "HenBox",
                "HidraQ",
                "Hodur",
                "Homux",
                "HopperTick",
                "Hydraq",
                "Impacket",
                "Kaba",
                "Korplug",
                "LadonGo",
                "MQsTTang",
                "McRAT",
                "MdmBot",
                "Mimikatz",
                "NBTscan",
                "NetSess",
                "Netview",
                "Orat",
                "POISONPLUG.SHADOW",
                "PUBLOAD",
                "PVE Find AD Users",
                "PlugX",
                "Poison Ivy",
                "PowerView",
                "QMAGENT",
                "RCSession",
                "RedDelta",
                "Roarur",
                "SPIVY",
                "ShadowPad Winnti",
                "SinoChopper",
                "Sogu",
                "TIGERPLUG",
                "TONEINS",
                "TONESHELL",
                "TVT",
                "TeamViewer",
                "Thoper",
                "TinyNote",
                "WispRider",
                "WmiExec",
                "XShellGhost",
                "Xamtrav",
                "Zupdax",
                "cobeacon",
                "nbtscan",
                "nmap",
                "pivy",
                "poisonivy"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535914,
    "ts_updated_at": 1743041807,
    "ts_creation_date": 1653709676,
    "ts_modification_date": 1653709676,
    "files": {
        "pdf": "https://archive.orkl.eu/d48ff517b5cdcae4a0e277affe9bb9ddad5d85cd.pdf",
        "text": "https://archive.orkl.eu/d48ff517b5cdcae4a0e277affe9bb9ddad5d85cd.txt",
        "img": "https://archive.orkl.eu/d48ff517b5cdcae4a0e277affe9bb9ddad5d85cd.jpg"
    }
}