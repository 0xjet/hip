{
    "id": "0e082e5c-33cb-4822-855f-678d84d4b33d",
    "created_at": "2022-10-25T16:48:17.628882Z",
    "updated_at": "2025-03-27T02:16:59.262299Z",
    "deleted_at": null,
    "sha1_hash": "dc342c30cc53686416204d97ceb44156f1ecf5e8",
    "title": "",
    "authors": "",
    "file_creation_date": "2019-10-09T16:28:43Z",
    "file_modification_date": "2019-10-09T16:50:38Z",
    "file_size": 882646,
    "plain_text": "# AT COMMANDS, TOR-BASED COMMUNICATIONS:\n## MEET ATTOR, A FANTASY CREATURE AND ALSO A SPY PLATFORM\n\n###### Author: Zuzana Hromcová\n\n\n-----\n\n### In the fantasy book “A Court of Thorns and Roses” by\n\n Sarah J. Maas, Attor was an evil Faerie. In that book, the\n\n Faeries ruled over all the known world and humans were\n\n their slaves.\n\n In cybersecurity, Attor is a cyberespionage platform\n\n designed to exfiltrate valuable information from its\n\n victims.\n\nAuthor: Zuzana Hromcová\n\nOctober 2019\n\n\n-----\n\n#### CONTENTS\n\n1 SUMMARY.  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  2\n\n2 THE ESPIONAGE CAMPAIGN .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  2\n\n3 THE PLATFORM ARCHITECTURE.  .  .  .  .  .  .  .  .  .  .  .  .  .  . 4\n\n3.1 Persistence.  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  5\n\n3.2 Collection and exfiltration.  .  .  .  .  .  .  .  .  .  .  .  .  .  . 5\n\n3.3 Network communication .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  5\n\n4 TECHNICAL ANALYSIS.  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  . 7\n\n4.1 Dispatcher.  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  . 7\n\n4.1.1 Encryption methods .  .  .  .  .  .  .  .  .  .  .  .  .  .  . 7\n\n4.1.2 Evasion techniques.  .  .  .  .  .  .  .  .  .  .  .  .  .  . 7\n\n4.1.3 Interface for plugins.  .  .  .  .  .  .  .  .  .  .  .  .  .  9\n\n4.2 Shared resources.  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  . 11\n\n4.2.1 Plugin folder, Update folder .  .  .  .  .  .  .  .  .  .  .  11\n\n4.2.2 Upload folder.  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  . 12\n\n4.2.3 Resource folder .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  . 13\n\n4.3 Plugins .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  . 13\n\n4.3.1 Device monitor (ID 0x01) .  .  .  .  .  .  .  .  .  .  .  . 15\n\n4.3.2 Screengrabber (ID 0x02) .  .  .  .  .  .  .  .  .  .  .  . 18\n\n4.3.3 Audio recorder (ID 0x03) .  .  .  .  .  .  .  .  .  .  .  . 19\n\n4.3.4 File uploader (ID 0x05) .  .  .  .  .  .  .  .  .  .  .  .  . 19\n\n4.3.5 Command dispatcher/SOCKS proxy (ID 0x06) .  .  . 19\n\n4.3.6 Key/clipboard logger (ID 0x07).  .  .  .  .  .  .  .  .  20\n\n4.3.7 Tor client (ID 0x0D) .  .  .  .  .  .  .  .  .  .  .  .  .  . 20\n\n4.3.8 Installer/watchdog (ID 0x10).  .  .  .  .  .  .  .  .  .  21\n\n5 CONCLUSION.  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  . 21\n\n6 INDICATORS OF COMPROMISE (IOCS) .  .  .  .  .  .  .  .  .  .  .  . 21\n\n7 MITRE ATT&CK TECHNIQUES.  .  .  .  .  .  .  .  .  .  .  .  .  .  .  . 27\n\n\n-----\n\n#### 1 SUMMARY\n\nESET researchers have discovered a previously unreported cyberespionage platform used in targeted\n\nattacks since at least 2013. Focusing on diplomatic missions and governmental institutions, Attor is\n\ndesigned specifically to attack privacy-concerned targets. Its most interesting features are a complex\n\nmodular architecture, elaborate network communications, and a unique plugin to fingerprint GSM\n\ndevices.\n\nAttor’s core lies in its dispatcher, which serves as a management and synchronization unit for additional\n\nplugins. It also provides an interface for the plugins to call Windows APIs and cryptographic functions\n\nindirectly.\n\nPlugins themselves are heavily synchronized, with network communication alone being spread\n\nacross four different components, each implementing a different layer. This allows the malware\n\nto communicate with its FTP C&C server, which resides on an onion domain. Tor is used for\n\ncommunication, aiming for anonymity and untraceability, and the overall setup makes it impossible to\n\nanalyze the communication unless all pieces of the puzzle have been collected.\n\nApart from its dispatcher, all of Attor’s capabilities are provided as plugins. This allows the attackers\n\nto customize the platform on a per-victim basis. The most notable plugin can detect connected GSM/\n\nGPRS modems or mobile devices; this allows Attor to speak to them directly using the AT command set,\n\nin order to collect sensitive information such as the IMEI, IMSI or MSISDN numbers, possibly identifying\n\nboth the device and its subscriber. Other plugins provide persistence, an exfiltration channel, C&C\n\ncommunication and several further spying capabilities.\n\nWe gave Attor its name because of two notable features of the platform: the AT protocol used by the\n\nGSM plugin, and that Tor is employed for network communication.\n\n#### 2 THE ESPIONAGE CAMPAIGN\n\nAttor has been used in a highly targeted espionage campaign; we have only seen a few dozen victims.\n\nIn general, Attor seems to be targeting Russian-speaking users. This claim is supported by the fact that\n\nmost of the targets are located in Russia, and that the malware focuses on Russian applications: for\n\nexample, it takes screenshots of Russian Instant Messenger (IM) apps.\n\nOther targets are located in Eastern Europe, and they include diplomatic missions and governmental\n\ninstitutions.\n\nRussia\n\nUkraine\n\nSlovakia\n\nLithuania\n\nTurkey\n\nFigure 1 // Countries affected by Attor\n\n\n-----\n\nThe campaign has been active in two waves, with different implementations of the platform, and\n\nsubstantial changes in architecture. We saw the first activity in 2013, while the most recent version has\n\nbeen active at least since 2018, with the latest samples detected in July 2019.\n\nWe don’t know how the malware was initially distributed to its victims and executed. It is also difficult\n\nto establish the exact timeline of the operation, especially with such a small number of targets. The\n\nmalware may have been used much longer: it could have been in use for years before we encountered it.\n\nThe PE timestamp information in the samples suggests compilation dates between 2005 and 2009 for\n\nthe older version, and between 2011 and 2013 for the newer, but this information is likely fabricated. For\n\nexample, in one of the samples[1], the PE header contains July 14th, 2009 as the compilation date, which is\n\ninconsistent with other metadata. Namely, the product version 1.626.7601.17514 in the sample’s version\n\ninfo was apparently copied from a Windows 7 RTM library (usp10.dll), in an attempt to make the\n\nfile look more credible. However, that library was only released on November 20th, 2010, and thus its\n\nproduct version could not have been known in July 2009. This is a clear indicator that the timestamp is\n\nfake.\n\nTherefore, we rely solely on our telemetry, which suggests that samples of the older version were used\n\nbetween 2013 and 2017, while the updated, modernized version has been in use since 2018.\n\nFigure 2 // Metadata from the malicious file showing that the PE timestamp was forged to an older date\n\n1 SHA-1: 6DEC7C66CB5E6F86CDDBE313B604603731C78E20\n\n\n-----\n\n#### 3 THE PLATFORM ARCHITECTURE\n\nIn this paper, we focus on the newer version of Attor that has been active since 2018. This version\n\nconsists of a dispatcher and loadable plugins, that use shared folders for synchronization, and provide\n\nfunctionality to each other.\n\nIn the first step of a compromise, a dropper delivers the main dispatcher and a number of plugins, and\n\nthen loads the dispatcher, which is a dynamic-link library.\n\nThe dispatcher injects itself into almost all running processes and loads additional plugins within each of\n\nthese processes. Attor avoids some system processes and Symantec products.\n\nA feature characteristic to Attor is that the plugins then choose in which of the processes to activate\n\ntheir payload. For example, a Screengrabber plugin only captures screenshots of the window of a\n\nprocess in which it is injected, which allows monitoring only processes that are of interest of the\n\nattackers (such as IM applications or web browsers).\n\nAttor has built-in mechanisms for adding new plugins, for updating itself, and for automatically\n\nexfiltrating collected data and log files.\n\nIn subsequent sections, we explain how individual components of the platform contribute to these\n\nmechanisms, as is also illustrated in Figure 3.\n\n**ID 0x00** **EXFILTRATION** **COMMAND AND CONTROL**\nDispatcher\n\nLoads Installs\n\nFTP\n\n###### PLUGINS\n\n**ID 0x06** 127.0.0.1:5153\n\n**PERSISTENCE** SOCKS proxy\n\n**ID 0x10**\nInstaller/watchdog SOCKS\n\n**ID 0x0D** 127.0.0.1:8045\n\n**COLLECTION** Tor client\n\nUploads Downloads\n\n**ID 0x01** **ID 0x03** data commands\nDevice monitor Audio recorder\n\n**ID 0x02** **ID 0x07** **ID 0x05** **ID 0x06**\nScreengrabber Key/clipboard logger File uploader Command dispatcher\n\nStores downloaded plugins,\nupdates and other files\n\nStore\ncollected data Upload folder Plugins Updates Resources\n\nCollected Loaded by the main module Executed and deleted Miscellaneous files\ndata and logs with each execution by the main module\n\nFigure 3 // Attor’s architecture. Note that ID 0x06 represents a single plugin,\nbut the functionality is split here into two parts for clarity.\n\n|ID 0x00 EXFILTRATION COMMAND AND CONTROL Dispatcher Loads Installs FTP PLUGINS ID 0x06 127.0.0.1:5153 PERSISTENCE SOCKS proxy ID 0x10 Installer/watchdog SOCKS ID 0x0D 127.0.0.1:8045 COLLECTION Tor client Uploads Downloads ID 0x01 ID 0x03 data commands Device monitor Audio recorder ID 0x02 ID 0x07 ID 0x05 ID 0x06 Screengrabber Key/clipboard logger File uploader Command dispatcher Stores downloaded plugins, updates and other files Store|Col2|EXFILTRATION|Col4|COMMAND AND CONTROL|Col6|\n|---|---|---|---|---|---|\n|||ID 0x0 SOCKS pr ID 0x0 Tor client Uploads data ID 0x05 File uploader||127.0.0.1:5153 KS 127.0.0.1:8045 Downloads commands ID 0x06 Command dispatcher||\n||Store|||||\n\n\n-----\n\n##### 3.1 Persistence\n\nThe Installer/watchdog plugin is responsible for ensuring Attor’s persistence, by scheduling a task that\n\nloads the dispatcher.\n\nIn some versions of the malware, the dispatcher itself is responsible for this functionality, using one of\n\ntwo mechanisms depending on the privileges with which the malware was initially executed. Regardless\n\nof the persistence method, one of Attor’s threads monitors whether it is still installed on the system, and\n\nreinstalls it if not.\n\nThe first technique used by the dispatcher is to create a logon script that loads the dispatcher DLL (using\n```\nrundll32.exe) at each user logon. To achieve this, malware sets the UserInitMprLogonScript value\n\n```\nunder the HKEY_CURRENT_USER\\Environment registry key.\n\nIf running in a privileged context, it registers the dispatcher as a service, and installs it to be executed on\n\neach system start by adding the service name to the netsvcs group.\n\nNotably, Attor also instructs the service to be executed in Safe Mode and Safe Mode with Networking.\n\nThis is achieved by creating a subkey for the malicious service under the SafeBoot registry keys:\n```\n• HKEY_LOCAL_MACHINE\\SYSTEM\\*ControlSet*\\Control\\SafeBoot\\Minimal\n• HKEY_LOCAL_MACHINE\\SYSTEM\\*ControlSet*\\Control\\SafeBoot\\Network\n\n```\nAttor then sets the default value of these subkeys to Service, to indicate the malicious service should\n\nbe loaded during a safe mode boot.\n\nNote: In the provided registry keys, *ControlSet* represents all registry subkeys with the “ControlSet” substring in\n\n_their names, e.g. ControlSet001 or CurrentControlSet._\n\n##### 3.2 Collection and exfiltration\n\nSeveral plugins provide espionage capabilities; we refer to them as the Device monitor,\n\n**Screengrabber, Audio recorder and Key/clipboard logger plugins. These plugins store the collected**\n\ndata and log files in a central Upload folder.\n\nThese plugins do not communicate with the C&C server themselves. Instead, it is the File uploader\n\nplugin that automatically uploads these files to the C&C server.\n\nThe main module monitors if there is enough space on the disk where the Upload folder is located – if\n\nnot, the plugins do not proceed with creating additional files, in order to avoid suspicion by the user.\n\n##### 3.3 Network communication\n\nThere are only two Attor components that communicate with the C&C server: the aforementioned File\n\n**uploader, and the Command dispatcher that downloads commands and additional tools from the**\n\nC&C server.\n\nBoth plugins use FTP; files are uploaded to/downloaded from an FTP server that is protected by\n\ncredentials hardcoded in the configuration. Passive FTP mode is used, where the client initiates both\n\nconnections to the server.\n\nThe malware uses the Tor: Onion Service Protocol, with the C&C server having a .onion address, so the\n\ncommunication must be enabled by a Tor client plugin and relayed using a SOCKS proxy plugin. In\n\norder to communicate with the C&C server, any plugin must first establish a connection with the Tor\n\nclient (listening on the non-default localhost:8045) which is responsible for resolving the onion domain,\n\nchoosing a circuit and encrypting data in layers.\n\n\n-----\n\nThe Tor client plugin must communicate with the dispatcher, which implements the cryptographic\n\nfunctions. Furthermore, it communicates with the SOCKS proxy (listening on localhost:5153) that relays\n\nthe communication between the Tor client and the remote server.\n\nIn total, the infrastructure for C&C communication spans four Attor components – the dispatcher\n\nproviding encryption functions, and three plugins implementing the FTP protocol, the Tor functionality\n\nand the actual network communication. This mechanism is illustrated in Figure 4.\n\n\n###### ID 0x06\nSOCKS proxy\n\n\n127.0.0.1:5153\n\n\n###### ID 0x0D\nTor client\n\n\n127.0.0.1:8045\n\n\n###### ID 0x05\nFile uploader\n\n\n###### ID 0x06\nCommand dispatcher\n\n\n###### ID 0x00\nDispatcher\n\n\nProxy for Windows API\nand cryptographic functions\n\nFigure 4 // Four Attor components cooperate to enable communication with the C&C server\n\n\n-----\n\n#### 4 TECHNICAL ANALYSIS\n\nIn this section, we will provide technical details about the respective Attor components.\n\n##### 4.1 Dispatcher\n\nThe dispatcher, which is a dynamic-link library, is a central unit of the platform. Its name usually starts\n\nwith letters “SR”, followed by some random letters. Dispatcher names we have seen include SRnhm.dll,\n```\nSRSfxu.dll, SRzsp.dll, SRhhz.dll, SRanx.dll and sRWobwa.dll. For 64-bit versions, the “x64”\n\n```\nsuffix is added to the name, e.g., SRzspx64.dll.\n\nThe dispatcher contains encrypted configuration data with:\n\n- Paths to working folders (Upload folder, Plugin folder, Update folder, Resource folder)\n\n- FTP server domain and credentials (for C&C and exfiltration)\n\n- RSA public key\n\n- Name of the service under which the malware should be installed\n\nOther components retrieve the configuration data from the dispatcher via a designated interface.\n\nThe dispatcher injects itself into all processes (except some system processes and some processes\n\nbelonging to Symantec products). Subsequently, it loads all plugins from the Plugin folder (location of\n\nwhich is determined by the configuration).\n\nThe plugins then use functions implemented by the dispatcher, a reference to which is passed to the\n\nplugins on load.\n\nThere are both 32-bit and 64-bit versions of the main Attor dispatcher DLL. On 64-bit systems, both are\n\nloaded, which ensures the malware can inject itself into both 32-bit and 64-bit processes and monitor\n\nthem (e.g., by taking screenshots and collecting keystrokes).\n\n###### 4.1.1 Encryption methods\n\nStrings in the malware components are protected by an XOR cipher with a hardcoded key[2].\n\nThe configuration data (which is embedded in the main module), as well as the backdoor commands,\n\nare protected by a hybrid encryption scheme, where data is encrypted symmetrically using Blowfish and\n\nprepended with an RSA-encrypted Blowfish key.\n\nThe Blowfish cipher is used in OFB mode, with a 16-byte key randomly generated for each message. The\n\npublic RSA key[2] used for encrypting the Blowfish key is embedded in the main module.\n\nEncryption and decryption methods are implemented by the main module, but are also used by the\n\nloadable plugins via the interface provided by the main module (see Section 4.1.3). Attor’s plugins use the\n\nsame encryption scheme for encrypting the collected data.\n\n###### 4.1.2 Evasion techniques\n\nAttor has implemented measures to detect whether it is being executed in an analytical environment. It\n\nterminates itself if an emulator or virtual machine is detected.\n\nTo detect (some) emulators, Attor performs two similar tests:\n\n- It creates a randomly-named event, and then queries the event name via the NtQueryObject API\n\nfunction.\n\n- It opens the HKEY_LOCAL_MACHINE\\SYSTEM registry key and then queries its name by passing the key\n\nhandle to the same API function.\n\n2 See the IoCs section for the extracted keys\n\n\n-----\n\nIf there is a mismatch in the names in any of these cases, Attor assumes the presence of an emulator\n\nand exits.\n\nTo detect virtual machines, Attor utilizes the following methods for detecting VMware, VirtualBox and\n\nVirtual PC:\n\n- It calls the sldt _[instruction, which stores the address of the Local Descriptor Table in a register; the](https://www.aldeid.com/wiki/X86-assembly/Instructions/sldt)_\n\n[address should be zero on native systems and non-zero in VMware. This is illustrated in Figure 5a.](https://isc.sans.edu/diary/More+tricks+from+Conficker+and+VM+detection/5842)\n\n- It executes an undefined instruction vpcext that is valid in Virtual PC and VirtualBox environments,\n\nbut will generate an exception if executed in a native environment. This is illustrated in Figure 5b.\n\n- It attempts to retrieve the VMware version by communicating with I/O ports, using the in\n\ninstruction. If called in a VMware environment with the parameters seen in Figure 5c, the magic value\n```\n VMXh is returned as the result.\n\n```\n- It tries to read from the \\\\.\\VBoxMiniRdrDN pseudo-device, to discover whether it is running in\n\nVirtualBox. This is illustrated in Figure 5d.\n\nFigure 5 // Attor employs several techniques to detect specific virtual environments\n\nFurthermore, Attor uses other techniques to avoid detection:\n\n- Network communication plugins are injected into applications such as web browsers or IM\n\napplications, in order to blend in with legitimate network traffic.\n\n- To prevent suspicion, whenever Attor manipulates a file or a registry key, it then restores the original\n\nvalues of their last access time.\n\n- All files created by Attor have the hidden, system and archive attributes set in order to be hidden from\n\nWindows Explorer by default.\n\n\n-----\n\n###### 4.1.3 Interface for plugins\n\nAttor’s plugins use functions implemented by the main module, which makes them harder to detect and\n\nanalyze, because they call functions of the dispatcher instead of Windows API functions.\n\nThe functions are called using the function dispatcher, which takes as its arguments the function type\n\nand its numerical identifier. Figure 6 illustrates a part of one plugin, calling the function dispatcher on\n\nseveral occasions. In the disassembly on the right, we replaced the numeric identifiers with descriptive\n\nnames, that we recovered by reverse-engineering the dispatcher.\n\nA reference to the function dispatcher is passed to the plugin on load. Since the plugins are loaded into\n\nthe same process as the dispatcher, they share the same address space, and thus the plugins can call the\n\nfunctions of the dispatcher DLL directly. This design makes it harder to analyze individual components of\n\nAttor without access to the dispatcher, which translates the specified identifier to a meaningful function\n\nthat is then executed.\n\nFigure 6 // Additional plugins use functions implemented in the main module,\nby calling the function dispatcher (dubbed helperFnc here)\n\n\n-----\n\nAccording to our analysis, the dispatcher implements three to four dozen functions, depending on the\n\ndispatcher version (new functions are included in the newer samples). Table 1 lists functions recovered\n\nacross all samples examined.\n\nTable 1 // The interface provided by the dispatcher DLLs\n\nFunction type Function ID Functionality\n\n1 NtCreateFile wrapper\n\n2 NtClose wrapper\n\n3 SetFilePointer wrapper\n\n4 NtFlushBuffersFile wrapper\n\n5 Change file attributes\n\n6 NtReadFile wrapper\n\n7 NtWriteFile wrapper\n\n\n1 (resource\nmanipulation\nfunctions)\n\n2 (cryptographic\nprimitives)\n\n\n8 Create and close a file\n\n9 Create a session event\n\n10 Create a mutex\n\n11 Find first file\n\n12 Find next file\n\n13 Release all resources used by an unowned critical section object\n\n14 Delete a file\n\n15 NtOpenEvent wrapper\n\n1 Free a memory block\n\n2 Free a memory block and overwrite it with null bytes\n\n3 Generate a new Blowfish key and initialize the encryption routine\n\n4 Overwrite the Blowfish key with null bytes\n\n5 Encrypt the Blowfish key with RSA\n\n6 Encrypt/decrypt data with a previously initialized Blowfish key, in OFB mode\n\nHybrid decryption – decrypt the RSA-encrypted Blowfish key and then decrypt\n7\nthe Blowfish-encrypted data\n\n8 Generate an RSA key\n\n9 Hash data (SHA-1 or MD5)\n\n10 Hash data – init part (SHA-1 or MD5)\n\n11 Overwrite a memory block with null bytes\n\n12 Hash data – update part (SHA-1 or MD5)\n\n13 Hash data – final part (SHA-1 or MD5)\n\nHybrid encryption – generate a Blowfish key, encrypt it with RSA and then\n14\nencrypt the data with Blowfish in OFB mode\n\n\n-----\n\nFunction type Function ID Functionality\n\n1 Get path to the Upload folder (from the config)\n\n2 Get path to the Update folder (from the config)\n\n3 Get path to the Plugin folder (from the config)\n\n4 Get path to the Resource folder (from the config)\n\n5 Get 16 hardcoded bytes\n\n6 Get attributes of ntdll.dll file (to be used for forging file timestamps)\n\n\n3 (retrieving\nconfiguration\ndata and global\nvariables)\n\n##### 4.2 Shared resources\n\n\n7 Change file timestamps to those of ntdll.dll file\n\n8 Check if there is enough space on disk\n\n9 Get FTP directory name (from the config)\n\n10 Get user ID (from the config)\n\n11 Get structure with global variables and configuration data\n\n12 Get user security descriptor\n\n13 Get the specified config field\n\n14 Resolve import\n\n\nInstrumental for synchronization between the main module and plugins is a set of four central folders,\n\nwhere various resources are stored.\n\nThe precise locations are hardcoded in Attor’s configuration; most often we have seen the patterns in\n\nTable 2 used for naming these folders (x represents a variable lower-case letter).\n\nTable 2 // Naming convention for the folders\n\nFolder type Naming pattern\n\nPlugin folder `%ALLUSERSPROFILE%\\Oracle\\Java\\.NET35\\sxx`\n\nUpdate folder `%ALLUSERSPROFILE%\\Oracle\\Java\\.NET35\\vxx`\n\nResource folder `%ALLUSERSPROFILE%\\Oracle\\Java\\.NET35\\kxx`\n\nUpload folder `%ALLUSERSPROFILE%\\Oracle\\Java\\.NET35\\dxx`\n\n###### 4.2.1 Plugin folder, Update folder\n\nAll plugins are permanently stored – compressed and encrypted – in the Plugin folder. The dispatcher\n\nloads plugins from this folder on each execution.\n\nThe Update folder serves as a temporary store for additional files the attacker wants to execute on the\n\ncompromised machine. The files get pushed to this folder via the Command dispatcher plugin; once the\n\ndispatcher recognizes a DLL in the Update folder, it loads it automatically, and deletes it afterwards.\n\nAccording to the artifacts in the dispatcher, the thread responsible for this functionality is called\n```\nUpdate_th; thus, we believe this mechanism most likely is used for updating Attor’s components.\n\n```\n\n-----\n\n###### 4.2.2 Upload folder\n\nThe Upload folder is used, by the plugins tasked with collection, as a central folder to store collected\n\ndata, and by other plugins to store log files.\n\nThe File uploader plugin automatically uploads these files to the C&C server. Each file contains control\n\ndata including plugin ID, file creation timestamp and a control flag 3ff3 and is encrypted using\n\nBlowfish-OFB combined with RSA. The hidden, system and archive attributes of the log files are set; the\n\nlast access time is faked.\n\n\n###### RSA encryption\n\n Random 16-byte Blowfish key\n\n Blowfish-OFB encryption\n\n Timestamp\n\n “3ff3” flag\n\n Plugin ID\n\n Data\n\n\nFigure 7 // Hybrid encryption scheme used by Attor\n\nAdditionally, index files are used to keep track of log files – they store the number of log files of a certain\n\ngroup, and the counter values are then used to name the log files.\n\nPlugins usually store data in subdirectories of the Upload folder named by the plugin ID.\n\nFilenames are derived from user names, collected data (such as clipboard contents or device\n\ninformation), timestamp or counter value, and are mostly hexadecimal values.\n\n\n-----\n\nTable 3 // The properties of the files in the Upload folder\n\nFilename pattern Plugin ID File content\n\n`1.<device-hash>\\nm\\index.dat` 1 Index file for storage device metadata\n\nStorage device information (bus type, device type, total disk\n`1.<device-hash>\\<counter><data-hash>` 1\nsize, TrueCrypt version... )\n\nInformation about documents stored on the device (name,\n`1.<device-hash>\\<counter><data-hash><data-hash>` 1\nsize, creation & last modified time)\n\n`1.<com-device-hash>\\nm\\index.dat` 1 Index file for COM device metadata\n\nCOM device information (information about the phone/\n`1.<com-device-hash>\\<counter><data-hash>` 1\nmodem, information about the subscriber)\n\n`2.<user-name-hash>\\nm\\index.dat` 2 Index file for screenshots\n\n`2.<user-name-hash>\\<counter><data-hash>` 2 Screenshot file\n\n`7\\nm\\info` 7 Hash of last-stored clipboard data\n\n`7\\nm\\index.dat` 7 Index file for keylog/clipboard files\n\n`7\\<counter><data-hash>` 7 Keylog/clipboard data\n\n`nm\\0_skp_<user-name>\\index.dat` 3 Index file for audio recordings\n\n`0_skp_<variable-data>` 3 Audio recording file\n\nNote: We only analyzed the older version of the plugin with ID 0x03. The file paths may be slightly different in the\n\n_newer version, i.e., the one with the modern architecture._\n\n###### 4.2.3 Resource folder\n\nThis folder is used by all plugins to store miscellaneous resources that are not to be exfiltrated to the\n\nC&C server, such as scripts, timestamps or temporary files.\n\n##### 4.3 Plugins\n\nAttor’s architecture allows customization for individual targets, where the functionality of the platform\n\nrelies heavily on plugins deployed on the compromised machine.\n\nThe plugins are implemented as DLLs, loaded by the dispatcher. They are stored on the disk in a\n\ncompressed and encrypted form, with the valid form of the DLL only being recovered in memory, when\n\nthe dispatcher loads the plugin. This probably is an attempt to thwart detection, as the plugin DLLs are\n\nnever present unencrypted on disk.\n\nAll plugins export the same set of functions: DllCanUnloadNow, DllGetClassObject,\n```\nDllRegisterServer, DllUnregisterServer, DllEntryPoint. When the dispatcher loads a plugin\n\n```\n(DllEntryPoint), a start event is created, and several threads with the payload are started, which all\n\nwait until the event is signaled.\n\n\n-----\n\nFigure 8 // DllGetClassObject export of a plugin that is responsible for initialization and starting the actual payload\n\nThe plugins are activated by the main DLL calling the DllGetClassObject export (see Figure 8) with\n\nthe following actions happening:\n\n- The main DLL passes a reference to the helper function of the dispatcher, which the plugin will use for\n\nretrieving configuration data, for file manipulation, for encryption/decryption…\n\n- The start event is signaled, which activates the threads\n\n- The plugin returns the plugin ID and version, so that the main DLL can keep track of the active\n\nmodules\n\nThe version information of plugins recovered in the course of our investigation, along with the plugins’\n\nfunctionality, is listed in Table 4.\n\n\n-----\n\nTable 4 // The analyzed plugins and their versions\n\nPlugin ID Analyzed versions Functionality\n\n0x01 0x0E Device monitor\n\n0x02 (no version), 0x0C Screengrabber\n\n0x03 (no version), 0x08, 0x09, 0x0B, 0x0C Audio recorder\n\n0x05 0x0A File uploader\n\n0x06 0x0A Command dispatcher/SOCKS proxy\n\n0x07 0x02, 0x04, 0x09, 0x0A Key/clipboard logger\n\n0x0D 0x03 Tor client\n\n0x10 0x01 Installer/watchdog\n\nNote that if the numbering is continuous (which it might be, since 0x10 is the last we have seen and is\n\nonly version 1, while e.g., 0x03 is now on version 0x0C), there may be additional plugins available that\n\nwe haven’t seen.\n\nWe only can guess what functionality those plugins unknown to us might have. If we are to speculate,\n\nwe feel that missing is a remote shell functionality, and also functionality to exfiltrate specific files\n\nsilently; there may also be more victim-specific plugins available.\n\n###### 4.3.1 Device monitor (ID 0x01)\n\nThe most curious plugin in Attor’s arsenal collects information about connected modem/phone devices\n\nand connected storage drives, and about files present on these drives. It is responsible for collection of\n\nmetadata, not the files themselves, so we consider it a plugin used for device fingerprinting, used as a\n\nbase for further data theft.\n\nThe Device monitor plugin creates a new window and uses SHChangeNotifyRegister API to register\n\nShell-level notifications for that window on storage media insertion/removal, with a custom window\n\nmessage 0x421. The window procedure handles these events, and WM_DEVICECHANGE message, and\n\ncollects a specific set of information for either a modem or a phone device, or an external storage drive.\n\n1. External storage drive\n\nIn case a hard disk device is inserted, Device monitor collects the following information:\n\n- Bus type, device type, device type modifier, vendor ID, product ID, product revision string, serial\n\nnumber, device interfaces\n\n- Free space on disk, total disk size, filesystem used\n\n- If applicable, also TrueCrypt version\n\nThe TrueCrypt version is determined by sending IOCTLs to the TrueCrypt driver (0x222004\n\n(TC_IOCTL_GET_DRIVER_VERSION) and 0x72018 (TC_IOCTL_LEGACY_GET_DRIVER_VERSION)). As\n\nthese are TrueCrypt-specific control codes, not standard codes, the authors of the malware must have\n\nbeen familiar with the code of the TrueCrypt driver, or TrueCrypt installer. This technique is very rare.\n\n\n-----\n\nFigure 9 // Device monitor plugin sends non-standard, TrueCrypt-specific control codes to the TrueCrypt driver,\nin order to determine the TrueCrypt version\n\nFurther, it scans these hard disk devices for specific files and collects information about these files. It\n\ncollects metadata such as filename, file size, creation and last-modified time of documents having the\n\ntarget extensions: .xls, .xlsx, .xlsm, .doc, .docx, .docm, .ppt, and .pptx.\n\nThe information gathered by this plugin is stored in separate log files in the Upload folder, in order to be\n\nexfiltrated by another plugin.\n\n2. GSM/GPRS modem/phone device\n\nThe more unusual functionality of this plugin is the ability to fingerprint GSM devices. Whenever\n\na modem or a phone device is connected to the COM port, Device monitor uses AT commands to\n\ncommunicate with the device, via the associated serial port.\n\nAT commands, also known as Hayes command set, were originally developed in the 1980s to command\n\na modem to dial, hang up or change connection settings. The command set was subsequently extended\n\nto support additional functionality, both standardized and vendor-specific.\n\n\n-----\n\n[In a recent paper, it was discovered that the commands are still in use in most modern smartphones. The](https://atcommands.org/sec18-tian.pdf)\n\nresearchers were able to bypass security mechanisms and communicate with the smartphones using AT\n\ncommands through their USB interface. Thousands of commands were recovered and tested, including\n\nthose to send SMS messages, push touch events, or leak sensitive information.\n\nThis research illustrates that the old-school AT commands pose a serious risk when misused.\n\nAs for Attor’s plugin, however, we may only speculate why AT commands are employed. We have\n\ndetected a 64-bit version of this plugin in 2019, and we can confirm it is still a part of the modernized\n\nAttor platform (that we first saw in 2018). On the other hand, it seems unlikely it is targeting modern\n\nsmartphone devices. The plugin ignores devices connected via a USB port, and only contacts those\n\nconnected via a serial port (more precisely, devices with “COM*” in the friendly name).\n\nA more likely explanation of the plugin’s main motive is that it targets modems and older phones.\n\nAlternatively, it may be used to communicate with some specific devices (used by the victim or target\n\norganization) that are connected to the COM port or to the USB port using a USB-to-serial adaptor. In\n\nthis scenario, it is possible the attackers have learned about the victim’s use of these devices using some\n\nother reconnaissance techniques.\n\nIn any case, the plugin retrieves the following information from the connected devices, using the AT\n\ncommands listed in Table 5:\n\n- Basic information about the mobile phone or GSM/GPRS modem: name of manufacturer, model\n\nnumber, IMEI number and software version\n\n- Basic information about the subscriber: MSISDN and IMSI number\n\nTable 5 // The commands of the AT protocol used by the Device monitor plugin\n\nAT command Functionality\n\nAT Signals start of communication (AT for attention).\n\nAT+MODE=2 Prepares the phone for an extended AT+ command set.\n\nAT+CGSN Requests IMEI number (International Mobile Equipment Identity), which is a unique number to identify a device.\n\nAT+CGMM Requests information about the model of the device (model number).\n\nAT+CGMI Requests name of the device manufacturer.\n\nAT+CGMR Requests the version of the software loaded on the device.\n\nRequests MSISDN (Mobile Station International Subscriber Directory Number), which is the mapping of the telephone\nAT+CNUM\nnumber to the subscriber identity module in a mobile or cellular phone.\n\n\nAT+CIMI\n\n\nRequests IMSI (International Mobile Subscriber Identity), which is a unique number identifying a GSM subscriber. This\nnumber has two parts. The initial part is comprised of six digits in the North American standard and five digits in the\nEuropean standard. It identifies the GSM network operator in a specific country with whom the subscriber holds an\naccount. The second part is allocated by the network operator to uniquely identify the subscriber.\n\n\nNote that many more (vendor-specific) AT commands exist that are not used by this plugin. It is possible\n\nthat malware operators use the listed commands to fingerprint the connected devices, and then deploy\n\nanother plugin with more-specific commands to extract information from the device.\n\n\n-----\n\n###### 4.3.2 Screengrabber (ID 0x02)\n\nThis plugin captures screenshots of targeted applications and stores them encrypted in the Upload\n\nfolder. It is only activated in applications of the attackers’ choice, determined by the process name.\n\nAfter activation, the Screengrabber monitors the application’s foreground window and if it is a web\n\nbrowser with a specific window title, or if it is another from the list of target applications, captures a\n\nscreenshot every 10 seconds. For example, the plugin takes a screenshot if the victim is using an email\n\nclient or has opened an email attachment.\n\nTargeted are mostly web browsers, including all major (Firefox, Opera, Chrome, Safari, Internet Explorer)\n\nand a few less popular (Maxthon, Avant, SeaMonkey) ones. By checking the window title of the web\n\nbrowser, the malware can determine whether the user is visiting a website of interest.\n\nWe have encountered process names and window titles referring to these services:\n\n- Social networks and blogging platforms (Facebook, Twitter, Google+, Blogger, Livejournal)\n\n- Email services (Gmail, AOL Mail, Hotmail, Hotbox, Webmail, Yahoo! Mail)\n\n- Office software (MS Word, Powerpoint, Excel, Visio, Notepad, Notepad++, Wordpad)\n\n- Archiving utilities (WinRAR, WinZip, Hamster)\n\n- Cloud storage and file sharing services (Turbobit, Skydrive, RapidShare)\n\n- Messaging, VoIP applications and web-based messaging services (Skype, Viber, Miranda, Pidgin, QIP,\n\nqutIM)\n\nApart from these widely used applications, the list contains a number of irregularities, which can give us\n\nmore insight about the intended victims.\n\nFor example, having TrueCrypt on the list suggests that the attackers are specifically interested in\n\nprivacy-conscious users. Also targeted are encryption/digital signature utilities, a VPN application (HMA\n\nVPN), secure mail clients (The Bat! and HushMail) and a secure web browser (Dragon).\n\nFurthermore, the applications on the list show the attackers are targeting Russian-speaking users –\n\nwhich is also confirmed by the geographical distribution of Attor, as explained in Section 2. The strings\n\nfrom the list of services targeted by the Screengrabber, that support this claim, are documented\n\nin Table 6.\n\nTable 6 // Artifacts from Attor’s Screengrabber associated with Russian applications\n\nProcess name/window title substring Context\n\nОДНОКЛАССНИКИ (transl. Classmates) [Russian social network (Odnoklassniki)](https://ok.ru/)\n\nAGENTVKONTAKTE [Russian social network (VKontakte)](https://vk.com/)\n\nWEBMONEY [Online payment system used in Russia (WebMoney)](https://www.webmoney.ru/)\n\nMAIL.YANDEX, ЯНДЕКС.ПОЧТА (transl. Yandex.Mail),\n[Russian email services (Mail.ru, Yandex.Mail)](https://mail.ru/)\nMAIL.RU, POCHTA (transl. Mail), MAGENT\n\nПРИГЛАШЕНИЕ ДРУЖИТЬ (transl. Friend request) Russian text\n\nВАМ СООБЩЕНИЕ (transl. Message for you) Russian text\n\nMULTIFON Russian VoIP service\n\nQIP, INFIUM [Russian IM application (QIP)](https://qip.ru/)\n\nRAMBLER [Russian search engine (Rambler)](https://www.rambler.ru/)\n\n\n-----\n\nInterestingly, the list of targeted applications contains some services that are now defunct or less\n\npopular than 10 years ago, which may suggest that the Attor platform is much older than we think.\n\n###### 4.3.3 Audio recorder (ID 0x03)\n\nThis plugin creates audio recordings using available microphones and stores them encrypted in the\n\nUpload folder.\n\nThe plugin is only activated if executed within a process of a teleconferencing application, which is\n\ndetermined by comparing the process name against a hardcoded list that includes Skype, Facebook\n\nVideo Calling, Brosix or Cheap VoIP.\n\nThis may indicate the attackers are interested in eavesdropping on online calls.\n\nWith this mechanism, the attackers can also record the victim’s conversations outside of\n\nteleconferencing apps. In this case, running in a process of a teleconferencing application can be an\n\nattempt to stay undetected, as the user is less likely to become suspicious that these applications access\n\nthe microphone device.\n\n###### 4.3.4 File uploader (ID 0x05)\n\nThe File uploader plugin is responsible for exfiltration of collected data and log files to the C&C server.\n\nThe files are uploaded to the C&C server automatically, in batches. Files are uploaded in FTP passive\n\nmode, as binary content, and are deleted from the Upload folder after the exfiltration.\n\nThe C&C server and credentials are hardcoded in the configuration data; these credentials were used in\n\nall the collected plugins:\n\n- C&C server: “idayqh3zhj5j243t[.]onion”\n\n- username: “do”\n\n- password: [Redacted]\n\nThe plugin logs in to the FTP server and copies the contents of the upload directory to a directory on the\n\nFTP server hardcoded in the config, creating a subdirectory there, with the victim ID as its name.\n\nIn order to reach out to the C&C server in the Tor network, the File uploader plugin uses other\n\nplugins (0x0D and 0x06) that provide the Tor and SOCKS proxy functionality (see Figure 4. Network\n\ncommunication.)\n\nThe File uploader plugin is only activated if running within the process of a web browser or an instant\n\nmessaging application or other network applications (this is determined by checking the process name\n\nagainst a hardcoded list). This trick hides the exfiltration-related network communication in a stream of\n\nlegitimate communication made by that application, and thus reduces the risk of raising any suspicion.\n\n###### 4.3.5 Command dispatcher/SOCKS proxy (ID 0x06)\n\nThis plugin serves two purposes.\n\nFirst, it serves as a SOCKS proxy, used by the Tor client plugin (ID 0x0D) to communicate with the\n\nremote computer.\n\nSecond, it downloads commands from the C&C server and interprets them.\n\nJust as with other plugins involved in C&C communication, Command dispatcher also hides its network\n\ncommunication using the trick described in Section 4.3.4.\n\nThe Command dispatcher plugin communicates with the C&C server via the FTP protocol using the\n\n0x0D plugin (with Tor); the credentials are the same as those used by the File uploader plugin for\n\nexfiltration.\n\n\n-----\n\nAfter the communication is established, Command dispatcher downloads a file called WAND.bin from\n\nthe server, decrypts it (RSA + Blowfish) and parses the commands using the CommandLineToArgW API\n\nfunction.\n\nThe plugin supports four commands, as listed in Table 7.\n\nTable 7 // Commands supported by Attor’s Command dispatcher plugin\n\nCommand name Functionality\n\nSET Set the value of an internal variable\n\nMOVE Rename a local file\n\nDELETE Delete a local file\n\nCOPY Download a file from the FTP server to the specified location\n\nOf interest is the COPY command serves as a mechanism for the malware to download additional\n\nresources, namely:\n\n- New plugins that will be stored in the Plugin folder and loaded by the main module on its next\n\nexecution\n\n- Updates that will be stored in the Updates folder and immediately loaded and then deleted by the\n\ndispatcher\n\n- Miscellaneous files that will be stored in the Resource folder\n\n- New versions of the dispatcher, either 32-bit or 64-bit\n\nCommand dispatcher stores encrypted log data containing status/results of the executed commands in\n\nthe Upload folder, and timestamp of the last time the C&C server was contacted, in the Resource folder.\n\n###### 4.3.6 Key/clipboard logger (ID 0x07)\n\nThis plugin steals clipboard data, and collects keystrokes pressed within the process in which the DLL is\n\ninjected.\n\nDue to the fact the dispatcher injects itself into all running processes, and then loads additional plugins,\n\nthis logger’s DLL will be loaded into all processes as well.\n\nThis plugin scans the content of the clipboard and whenever a change is detected, it stores the data in a\n\nlog file. It is only concerned with user GUI desktop (“WinSta0”) and UNICODE format clipboard data (i.e.,\n\nnot files, objects etc.).\n\nFor keylogging, this plugin installs a hook function to the window of the current process that has the\n\n[keyboard focus. To avoid detection, it uses a less common technique: instead of hooking WH_KEYBOARD or](https://www.codeandsec.com/FinFisher-Malware-Analysis-Part-4)\n```\nWH_KEYBOARD_LL, it hooks WH_GETMESSAGE. Whenever the window receives WM_CHAR or WM_KEYDOWN\n\n```\nmessage, the plugin translates the pressed keystrokes into text.\n\nThe collected clipboard and keyboard data are stored in encrypted files in the Upload folder.\n\n###### 4.3.7 Tor client (ID 0x0D)\n\nThis plugin is based on the Tor client, customized to the design of this malware (tor.exe with added\n\ninteraction with Attor’s dispatcher).\n\nIt is responsible for computations, such as choosing a random circuit and providing multilayer\n\nencryption, and for establishing the communication with the Tor network by resolving the onion\n\nhostname.\n\n\n-----\n\nFor the actual network communication, it utilizes the SOCKS proxy implemented by plugin 0x06.\n\nThe attackers use Tor for C&C communication and exfiltration for anonymity and untraceability. Also,\n\nthe Tor client plugin hides its network communication using the trick described in Section 4.3.4.\n\n###### 4.3.8 Installer/watchdog (ID 0x10)\n\nThis plugin establishes and monitors persistence of the main module.\n\nIt schedules a task that loads the main module with each system start or each user logon (depending on\n\nthe process privileges). It then continues to monitor whether the task is still scheduled; if not, the plugin\n\nwill reschedule it.\n\nTo run with necessary privileges, the Installer/watchdog plugin is only activated if injected into one of\n\nthe following processes:\n\n- `%system%\\*`\n\n- `%windir%\\explorer.exe`\n\n- `%windir%\\regedit.exe`\n\nTo make the task scheduling functionality stealthier, it doesn’t utilize API calls; instead, it is implemented\n\nusing the ITaskScheduler COM interface, registered using XML specification.\n\n#### 5 CONCLUSION\n\nAttor is an espionage platform, used for highly targeted attacks, and has flown under the radar\n\nsuccessfully since 2013.\n\nAttor is professionally written malware with a loadable plugin architecture that can be used to\n\ncustomize the functionality to specific targets. It implements mechanisms for automated data collection\n\nand exfiltration, as well as for pushing additional plugins to the compromised machine.\n\nIts functionality includes an unusual plugin for GSM fingerprinting that utilizes a rarely used AT\n\ncommand set. Attor incorporates Tor with the aim of anonymity and untraceability, and scatters the\n\nnetwork communication functionality among several components, to make analysis rather difficult.\n\nWe were not able to recover the full operation timeline, nor the initial access vector. The versioning\n\ninformation in the plugins suggests there are other plugins that we have not yet seen. However, our\n\nresearch provides a deep insight into the malware, and suggests that it is well worth further tracking of\n\nthe operations of the group behind this malware.\n\n#### 6 INDICATORS OF COMPROMISE (IOCS)\n\n##### ESET detection names\n\nWin32/Attor\n\nWin64/Attor\n\n##### SHA-1\n\nNote: We only present SHA-1 of older-version plugins, which used a simplified architecture and appeared\n\n_unencrypted on disk._\n\n\n-----\n\n###### Dropper\n```\n47dc997d08d53e55b8450940d9de94e2b5db631e\n52213cab4954c850a1ac51974a24b878ca88eb59\n8a6829b8615c5f6661a84ea3af0e15ab28c5840c\nd0528b8777d556809ac64935fa6247164aaabb4f\nf7e30a3fa186361794699d7a4fac6a9b85ccbf40\n\n Dispatcher\n1f69ba8063853dd80953b7881f4df9759a025780\n37a1138f9ef575d3b7fc11d59473aea261be4aef\n3c417b299532e62844869c4e0f33f3d719682f46\n53c7232e00445fde63e7f7d75f6eecdb8a8a830e\n6dec7c66cb5e6f86cddbe313b604603731c78e20\n6f640e5acd1592424962df781707556f2c02cb17\n87ded0f812ced722e86ff4a4f36bf8217c480388\n9d8126148089646717c84f313fd52c1a9fec2aca\na922558735227abe61754b02a6917a1aed18358a\nb7f1f151c3206e823fcaefcd0dab963be4efeb2f\nd1ca68eee49a4d25072855ebecc79d31f92efb2e\ne7371badae22c0ed0d93de2f1393c3e47dcee2d0\n\n Screengrabber plugin\n7b1e48154b93b6b374dd35bf821b2670ad1d0f69\n\n Audio recorder plugin\n02631dedb28c8d704ba689fc9efae057d2e8c8de\n09d220b7da92a177d03eb6ca6711c500fe34667b\n16b4c4da770991cc94e763ffec2a3fc418f9dc46\n472eef198c8da7ea233d3f21393f5823968a8a0e\n921e237b7e7c9945fb7cf5dd8960548a99896555\nb194b2cdae26f5c65d62fe8f0204d1e80cd7a41f\nbd2845b2e7178da92c9014d0e8921b7efba5a924\nc2371eb7a01149e87220bc7e62263266ee48be46\nc3d7391863838fbbd88660392d114ab7536ca373\ne64af8db5b6ccd076327a7c58c59e73eeb90be9b\nf9e9c4e45697880d8f601096e9dfc90e46557dcc\n\n Key/clipboard logger plugin\n5316abf8c4c148ce4d18419bb4e5057cf7535dcf\na8112bd5e7dd78161c8b77638826c7cfc730f95f\n\n##### C&C server\n\n```\nidayqh3zhj5j243t[.]onion\n\n\n-----\n\n##### File-based indicators\n\n###### Dispatcher filenames\n```\nARMccl.dll\nARMcclx64.dll\nodbccfg32.dll\noledboz.dll\nSRanx.dll\nSRanxx64.dll\nSRhhz.dll\nSRhhzx64.dll\nSRnhm.dll\nSRnhmx64.dll\nSRSfxu.dlll\nSRSfxux64.dll\nsRWobwa.dll\nsRWobwax64.dll\nSRzsp.dll\nSRzspx64.dll\n\n Plugin folder paths\n%COMMONAPPDATA%\\Lenovo\\ImController\\shared\\US-df\n%COMMONAPPDATA%\\Adobe\\Setup\\Replicate\\US-sf\n%ALLUSERSPROFILE%\\Oracle\\Java\\.NET35\\sup\n%ALLUSERSPROFILE%\\Oracle\\Java\\.NetFX\\svn\n%ALLUSERSPROFILE%\\Oracle\\Java\\.NET35\\sgp\n%ALLUSERSPROFILE%\\Oracle\\Java\\.NET35\\ssw\n%ALLUSERSPROFILE%\\Oracle\\Java\\.NET35\\ssm\n%ALLUSERSPROFILE%\\Sun\\Java\\Java Update\\Caches\\s3x\n\n Upload folder paths\n%COMMONAPPDATA%\\Lenovo\\ImController\\shared\\US-vv\n%COMMONAPPDATA%\\Adobe\\Setup\\Replicate\\US-nh\n%ALLUSERSPROFILE%\\Oracle\\Java\\.NET35\\dmx\n%ALLUSERSPROFILE%\\Oracle\\Java\\.NetFX\\dtr\n%ALLUSERSPROFILE%\\Oracle\\Java\\.NET35\\dnf\n%ALLUSERSPROFILE%\\Oracle\\Java\\.NET35\\dtl\n%ALLUSERSPROFILE%\\Oracle\\Java\\.NET35\\deu\n%ALLUSERSPROFILE%\\Sun\\Java\\Java Update\\Caches\\d5l\n\n Update folder paths\n%COMMONAPPDATA%\\Lenovo\\ImController\\shared\\US-fu\n%COMMONAPPDATA%\\Adobe\\Setup\\Replicate\\US-zn\n%ALLUSERSPROFILE%\\Oracle\\Java\\.NET35\\vhb\n%ALLUSERSPROFILE%\\Oracle\\Java\\.NetFX\\vau\n%ALLUSERSPROFILE%\\Oracle\\Java\\.NET35\\vtt\n%ALLUSERSPROFILE%\\Oracle\\Java\\.NET35\\vzu\n\n```\n\n-----\n\n```\n%ALLUSERSPROFILE%\\Oracle\\Java\\.NET35\\vwq\n%ALLUSERSPROFILE%\\Sun\\Java\\Java Update\\Caches\\v1e\n\n###### Resource folder paths\n%COMMONAPPDATA%\\Lenovo\\ImController\\shared\\US-ba\n%COMMONAPPDATA%\\Adobe\\Setup\\Replicate\\US-pq\n%ALLUSERSPROFILE%\\Oracle\\Java\\.NET35\\knz\n%ALLUSERSPROFILE%\\Oracle\\Java\\.NetFX\\kcw\n%ALLUSERSPROFILE%\\Oracle\\Java\\.NET35\\kya\n%ALLUSERSPROFILE%\\Oracle\\Java\\.NET35\\kub\n%ALLUSERSPROFILE%\\Oracle\\Java\\.NET35\\kmm\n%ALLUSERSPROFILE%\\Sun\\Java\\Java Update\\Caches\\k7f\n\n##### Synchronization object names\n\n```\nNote: xx represents a byte expressed in hexadecimal notation (a module ID or an object ID)\n```\nGlobal\\{6A2B597F-1C2F-4f78-AC94-7E1C8F136B0F}\nGlobal\\{3B68B0E9-08C4-4f23-B84C-CD76CCC4D362}\nGlobal\\{E5C403BC-555E-4162-8F18-EFF27A6957C1}\nGlobal\\{DC006092-9E86-4c20-8601-F643AF574444}\nGlobal\\{C4AE71DA-D55C-4a41-9F86-9F97D3CD47D9}\nGlobal\\{7D715AC5-B909-4aaf-90C9-882CC4423F8C}\nGlobal\\{377142C5-B7BD-42da-A8B3-4CAD9DA53326}\nGlobal\\{343D67FA-567D-415e-9FAE-622153EFE241}\nGlobal\\{144DB9C5-A3B7-4eab-AD9A-0E80B3FF7853}\nGlobal\\{7BD3390E-05C1-43a0-B938-94F52C3F3D32}\nGlobal\\Root#SYSTEM#0000#{43850F15-CB8E-4a88-9BA0-F11FB0xxA2xx}\n{770F45C0-D879-4d4d-9F03-3AC9F2CA4ECB}\n{69DB17B0-4DA5-43b6-8A63-76B483AE7D5A}\n[HKEY_CURRENT_USER\\Software\\Classes\\CLSID\\{A7F7DE86-C5BF-4239-A220-BF7523F5501E}]\n[HKEY_CURRENT_USER\\Software\\Classes\\CLSID\\{A8F7DE86-C5BF-4239-A220-BF7523F5501E}]\n[HKEY_CURRENT_USER\\Software\\Classes\\CLSID\\{A7E7DE86-C5BF-4239-A220-BF7523F5501E}]\n[HKEY_CURRENT_USER\\Software\\Classes\\CLSID\\{A8E7DE86-C5BF-4239-A220-BF7523F5501E}]\n\n##### Service display names\n\n```\nAdobe Acrobat Update v3.17.lkws\n\nAdobe Acrobat Update Service v3.2.muitnl\n\nMicrosoft .NET Framework NGEN v3.5.10549_X64_86\n\nMicrosoft .NET Framework NGEN v4.0_X64_86\n\nMicrosoft .NET Framework NGEN v3.5.10549_X64_86\n\nMicrosoft .NET Framework NGEN v3.5.10549_X64_86\n\nMicrosoft .NET Framework NGEN v3.5.10549_X64_86\n\n\n-----\n\n##### Cryptographic keys\n\n###### XOR cipher keys\n```\nCE2064368387DE357A3752F5\n9EF725BA7881049E72F7A92C924403B0\n9E772541AB8C93301F50D1CC942A1954720B8CDA\n34695948760973CC78077E64576B934344E2525072DB71897F848EF3B823BCDF\n53427F93B3716DB92511666C379758B5473790FFBB29811C4E8C9607B7CF385F\n7C7B55DBA50A286B71F86EA5691580287FF0A8C5407D656540EAB3FC96582215\n88EA7F35861891EF7AE62BA541545939B92E85BC24FD59E3B1C2991F99A14E9C\nAB783BBF82C9320F376A3D45B3CD402EA2D3AFFE648BBBBA5E9B724520A3627E\nAEB1A7C9BF3F61777B8B820C74ED6C62A838A2D5A0B56A2195552CA7713D40FE\nBEB05E4C303A65902E57A2C570465BD3993E5BCBB295BCF06AD167997A175247\n\n RSA public keys\n-----BEGIN PUBLIC KEY----MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAowPQz4fof3j6eFMysdwU\ns9fXAiij6dRC4yYFm32OSKaYGFSEJLoln+prl7Dx5YCI7MTYa1aAQtTkWpSTTgsl\ntF174pGFl7+ycxbCILAOZiHeCoEmk0463WJaLaNq27nQYSo4tCmdHy8DOH/ZYPwH\ncNM/8TsHFJjYsagVgrZXGdjdT78nxDDAORy5ey2Fb6tovVdT5oFGn3fJLcpyRzQK\n\n```\n0QL4/GeLis53IC8tlflGjnChT2R5rbecKk1d4b+AkhawwmOgsCsZJtgh+MpSyVAH\n```\nKMqk5F30u7QjsxP50mw4hzDyEPTFgNvtlekQuyYeutU8/45p933tD08jJviqqOpi\n8wIDAQAB\n-----END PUBLIC KEY---------BEGIN PUBLIC KEY----MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAq+wyxqkGYGSrU6wbMz5y\nI2FfwmsFM8MbhU/73LSo/U0TYcecX7CGtT+yi+aG0Bddox4GKFebPYHqnOr0fVaB\nFxfjyDx359qgrtfbeGH4qUlVCheHWt890urb8m5SntqGN3m1PniK5u7Vvg8vvihw\n20Z/FXUPjzvf99w45FeBSSj/FoOp7wHGA+HLArbpfRHHadj6MaxrCGqCXJZHFLYy\n6j3Y0LFtRkw6dOGAfgSM4w10NLbzR1O37zUZ4kkJ1itnNDBzfDJlx4IbZo82ale+\nfFiHYywxwIlLpbPzqcKHCwpx6rrz6t/Twp7FGNldRxV4AjlGxLyevQnMeCAnKgjg\nWwIDAQAB\n-----END PUBLIC KEY---------BEGIN PUBLIC KEY----MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEArFYkoqZrdAm4zDI/hYT5\np2WfqOSzrD+bdr6VuZYYa1CInG1xciAwAZcDZi+wB8bFoCWIsVf7v6d6eTJ84DO8\ne8av4RKt26mXwWglm0znmWuGEGsrsmbBNjWJgl5jI2qb0hcMtLPc4LV/ngz8KWbE\nqxwPfnFYrhhYgCgFjWbJ1A8azRyOYWLo7qhFYeO+Fmvb480/9lZ4hYEhPRzKL3nW\nsTR8WFiDNKuMh9CxAFBsialMHKUCC9VO6J8T1mYC1f5e7Gj4Aaa+puEHtervPUdZ\nZhYURbAr8fEmH65gIat8iZVkUAqdRJetVpWnXypaoxP9ZeXc7T7vPMYzpf4l7l9u\nzQIDAQAB\n-----END PUBLIC KEY----\n```\n\n-----\n\n```\n-----BEGIN PUBLIC KEY----MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAru8YYbvLSqvQQTvDfNSU\nADtZ3K2aFtyurvHZcOipzm3BA9RC9YS3HV3WLIo6bH2TzO9mJA5piBtYWNiSasDu\n0zzS8TtrCWiBBOkdiimrrNBoJ4KeWJnFEjL1Md8sZmpNUoqvUY2RwEl7J3Fg2+z/\nd9hm23EX2LMLqDRDGFPKadD3GHCw9ZFoVbiUGzg2anEO3UebXHcWEZztktrRVcA0\nU4w1LBzBkbonwDYY1VJ98W2BO3qtXiUWmsFRBas88nPO9B4fCR0Urz92ocOf8WBh\nJPMCkM7qPxW+mnOL7LHhZMpFcLbIlKzNXvUBUJ6T3DvZ5eO28WGoD8AUMHF6J1jx\nQwIDAQAB\n-----END PUBLIC KEY---------BEGIN PUBLIC KEY----MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAvg5VRwJbmGuWCjGKBJFE\n\n```\nKBGdvXxdak4HnUzf+YiQmeqCeJVeR0fimcpf+Mvs1kKMT6LEpqzI3GknQca8V0Y+\n```\nvHe22NOZYqAVmHVZWgtg9Le2tOCqBLaTeRHO3SejzT3fwxcWshpvOM1QSXx6WP5V\nOlNw3XqOM7D1t/MZwo4hi+RaqQPgPLWXigtqDoQuuv/tP7vGOiKfVpjv6oQ4AlAX\nyTauktpktB4Q51nmm3hxy/pET2WjXpwPOXrl+Cpny5lZC44KRKvX8yume97zXZpg\ngf8rebKSvwipIIRVeD0ihpazjQ9V8AzPSYpbmk8oF8TUB/hFyYWQRq8+hKZ6IlKC\nwwIDAQAB\n-----END PUBLIC KEY---------BEGIN PUBLIC KEY----MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA1Kgs1+tUSi1Vh1zvJjcC\nD9Yj7X8vLBwf82XQ8be6gsew3SD3mrTQUBv5PaQWer6w5iJpkM0FLwx2kvLuLKtz\nx1cUWFcN2mSKCMHeJpdBPCEM7CwBjGjp9euSG+ZpvpOobvv/eggUVa68wm2HfNAk\n+WkpR/XKyOCBOQ7UzU7nHXka7MmdDLNuKrH+CSMGEK1VIuz6CjMPJkAwGpL1r1g3\na7nr4ihoLO2+r/dZUXgf7oyPLQdUiPH4I8eCzJVCMLi7kD7AqHvyOF/F9yYJ9DKO\nLEZrxG5wDnTKM+3Iwti6ULqCQwd/krlcSZkm+kwxN5htMwk2chmEONS6y7fwcMLW\nLwIDAQAB\n-----END PUBLIC KEY---------BEGIN PUBLIC KEY----MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA4rdRiBiEW7RKi+nGuQkQ\nzzy6B5M1patDsz8CplezC5ML4TGVjzU1IVpe/qzVoaYoDH5snjRuzcTWc4+BZlE3\n2+HAVzySXkTxIm6tBPR10NIj2xUMKyoKlswS45iSbnFyDfwRdoKTVy1PoFQ27HSR\nDB35SxIba7reQf3p44ByLoNByG19Qp0GNpKxY7x74pRJDe8rYF9rcqNjEGjhy4Pv\nwnzK/EItumjT9wuMcngHggG1T5hjgZQoLjVhAJ8zyNOmcVNsL9/DSUf1zg5SdGjv\nDV5/xFQGFeKegFKcZLukKA3et8y92NS2KLzQj3SIJVxFrSOK+rGfwy0pkr6qW00a\nTQIDAQAB\n-----END PUBLIC KEY----\n```\n\n-----\n\n##### Applications targeted by Screengrabber plugin\n\n###### Process name substrings:\n\n&RQ, 7ZFM, 7ZG, AGENTVKONTAKTE, AVANT, BROSIX, BROWSER, CHEAPVOIP, CHROME, DRAGON,\n\nEXCEL, FACEBOOKVIDEOCALLING, FINEREADER, FIREFOX, FIREFOXPORTABLE, FLOCK, GAJIM,\n\nGGAPP, HAMSTERARC, ICQ, IEXPLORE, INFIUM, LF30, MAGENT, MAXTHON, MIRANDA32, MOZILLA,\n\nMSIMN, MSMSGS, MSNMSGR, MULTIFON, MYIE, NERO, NICHROME, NIMBUZZ, NONOH, NOTEPAD,\n\nNOTEPAD++, OOVOO, OPERA, OUTLOOK, PGPKEYS, PGPTOOLS, PIDGIN, PIDGIN-PORTABLE,\n\nPOWERPNT, PSI, PUFF, QIP, QQ, QUTIM, R&Q, RUN, SAFARI, SEAMONKEY, SKYPE, TBB-FIREFOX,\n\nTEAMVIEWER, THEBAT, THUNDERBIRD, TRILLIAN, TRUECRYPT, TWEETDECK, TWITTER-WIN8, VIBER,\n\nVISIO, W8VK, WEBMONEY, WINMAIL, WINRAR, WINWORD, WINZIP32, WLMAIL, WORDPAD, WUALA,\n\nWWAHOST, X-LITE, YAHOOM, YAHOOMESSENGER\n\n###### Window title substrings:\n\n************, AOL MAIL, ATTACHMENT.GOOGLE, BLOGGER, BLOGSPOT, DEPOSIT FILES, FACEBOOK,\n\nFROMRU, GMAIL, GOOGLE+, HIDE MY ASS!, HIDEMYASS.COM, HOTBOX, HOTMAIL, HUSHMAIL, IMO,\n\nLIVEJOURNAL, MAIL.RU, MAIL.YANDEX, MESSENGER, MICROSOFT EXCEL WEB APP, MICROSOFT\n\nONENOTE WEB APP, MICROSOFT POWERPOINT WEB APP, MICROSOFT WORD WEB APP, MSN,\n\nPOCHTA, RAMBLER, RAPIDSHARE, SKYDRIVE, SKYPE, TURBOBIT, TWITTER, WEBMAIL, YAHOO! MAIL,\n\nВАМ СООБЩЕНИЕ, ОДНОКЛАССНИКИ, ПРИГЛАШЕНИЕ ДРУЖИТЬ, ЯНДЕКС.ПОЧТА\n\n#### 7 MITRE ATT&CK TECHNIQUES\n\nTactic ID Name Description\n\n_[T1106](https://attack.mitre.org/techniques/T1106/)_ Execution through API Attor’s dispatcher uses CreateProcessW API for execution.\n\n_[T1129](https://attack.mitre.org/techniques/T1129/)_ Execution through Module Load Attor’s dispatcher executes additional plugins by loading the respective DLLs.\n\n\nExecution\n\nPersistence\n\n\n_[T1085](https://attack.mitre.org/techniques/T1085/)_ Rundll32 Plugin 0x10 schedules rundll32.exe to load the dispatcher.\n\nPlugin 0x10 schedules rundll32.exe to be executed on each boot/logon,\n_[T1053](https://attack.mitre.org/techniques/T1053/)_ Scheduled Task\nand subsequently to load the dispatcher.\n\n_[T1035](https://attack.mitre.org/techniques/T1035/)_ Service Execution Attor’s dispatcher can be executed as a service.\n\n\n_[T1037](https://attack.mitre.org/techniques/T1037/)_ Logon Scripts\n\n_[T1050](https://attack.mitre.org/techniques/T1050/)_ New Service\n\n\nAttor’s dispatcher can establish persistence via adding a Registry key with a\nlogon script: HKEY_CURRENT_USER\\Environment\n```\n“UserInitMprLogonScript”\n\n```\nAttor’s dispatcher can establish persistence by registering a new service.\n```\nHKEY_LOCAL_MACHINE\\SYSTEM\\*ControlSet*\\Control\\SafeBoot\\\nMinimal registry keys are updated to execute the service even in Safe\n\n```\nmode and Safe mode with networking.\n\n\n_[T1053](https://attack.mitre.org/techniques/T1053/)_ Scheduled Task Plugin 0x10 schedules a new task that loads the dispatcher on boot/logon.\n\n\n-----\n\nTactic ID Name Description\n\nStrings are encrypted with a XOR cipher, using a hardcoded key.\n\nDeobfuscate/Decode Files or\n_[T1140](https://attack.mitre.org/techniques/T1140/)_ Information Configuration data, log files and plugins are encrypted using a hybrid\n\nencryption scheme – Blowfish-OFB combined with RSA.\n\n\nDefense\nEvasion\n\n\n_[T1107](https://attack.mitre.org/techniques/T1107/)_ File Deletion The collected files and log files are deleted after exfiltration by plugin 0x05.\n\nThe attributes of log files and directories are set to HIDDEN/SYSTEM/\n_[T1158](https://attack.mitre.org/techniques/T1158/)_ Hidden Files and Directories\nARCHIVE (or combination of those).\n\nAttor’s dispatcher disguises itself as a legitimate task (i.e., the task name and\n_[T1036](https://attack.mitre.org/techniques/T1036/)_ Masquerading\ndescription appear legitimate).\n\n_[T1112](https://attack.mitre.org/techniques/T1112/)_ Modify Registry Attor’s dispatcher can modify the Run registry key.\n\nAttor’s dispatcher injects itself into running processes, to gain higher\n_[T1055](https://attack.mitre.org/techniques/T1055/)_ Process Injection privileges and to evade detection. It avoids specific system and Symantec\nprocesses.\n\nBoth 32-bit and 64-bit versions of Attor’s dispatcher are executed; also they\nare injected into almost all processes.\n\n_[T1108](https://attack.mitre.org/techniques/T1108/)_ Redundant Access\n\nThere is a watchdog component, implemented in the dispatcher or as a\nseparate plugin, that reinstalls Attor if it has been removed.\n\nThe time of last access to files and registry keys is manipulated after they\n_[T1099](https://attack.mitre.org/techniques/T1099/)_ Timestomp\nhave been created/modified.\n\nAttor can detect whether it is executed in some virtualized or emulated\n_[T1497](https://attack.mitre.org/techniques/T1497/)_ Virtualization/Sandbox Evasion\nenvironments. If detected, it terminates itself immediately.\n\n\nCredential\n_[T1056](https://attack.mitre.org/techniques/T1056/)_ Input Capture User credentials can be collected by plugin 0x07 via capturing keystrokes.\nAccess\n\nPlugin 0x01 enumerates files with specific extensions on all hard disk drives\n_[T1083](https://attack.mitre.org/techniques/T1083/)_ File and Directory Discovery\nand stores file information in encrypted log files.\n\n\nDiscovery\n\nCollection\n\n\nPlugin 0x01 collects information about inserted storage devices, modems\n_[T1120](https://attack.mitre.org/techniques/T1120/)_ Peripheral Device Discovery\nand phone devices.\n\n_[T1082](https://attack.mitre.org/techniques/T1082/)_ System Information Discovery Attor monitors the free disk space on the system.\n\nPlugin 0x03 is capable of recording audio using available input sound\n_[T1123](https://attack.mitre.org/techniques/T1123/)_ Audio Capture\ndevices.\n\n_[T1119](https://attack.mitre.org/techniques/T1119/)_ Automated Collection Attor automatically collects data about the compromised system.\n\nPlugin 0x07 collects data stored in the Windows clipboard by using the\n_[T1115](https://attack.mitre.org/techniques/T1115/)_ Clipboard Data\n```\n                       OpenClipboard and GetClipboardData APIs.\n\n```\n_[T1074](https://attack.mitre.org/techniques/T1074/)_ Data Staged Collected data is staged in a central upload directory prior to exfiltration.\n\nPlugin 0x07 captures keystrokes pressed within the window of the process\n_[T1056](https://attack.mitre.org/techniques/T1056/)_ Input Capture\nwhere Attor is injected.\n\n_[T1113](https://attack.mitre.org/techniques/T1113/)_ Screen Capture Plugin 0x02 captures screenshots of target applications.\n\n\n-----\n\nTactic ID Name Description\n\n_[T1043](https://attack.mitre.org/techniques/T1043/)_ Commonly Used Port Attor uses port 21 for C&C communication.\n\n_[T1188](https://attack.mitre.org/techniques/T1188/)_ Multi-hop Proxy Attor uses Tor for C&C communication.\n\n\nCommand\nand Control\n\nExfiltration\n\n\nAttor sends encrypted traffic using Tor, which itself uses multiple layers of\n_[T1079](https://attack.mitre.org/techniques/T1079/)_ Multilayer Encryption\nencryption.\n\n_[T1105](https://attack.mitre.org/techniques/T1105/)_ Remote File Copy Attor can download additional plugins, updates and other files.\n\n_[T1071](https://attack.mitre.org/techniques/T1071/)_ Standard Application Layer Protocol FTP protocol is used for C&C communication.\n\n_[T1032](https://attack.mitre.org/techniques/T1032/)_ Standard Cryptographic Protocol A combination of Blowfish-OFB and RSA is used for data encryption.\n\nExfiltration of the collected data and log files is done automatically\n_[T1020](https://attack.mitre.org/techniques/T1020/)_ Automated Exfiltration\nby plugin 0x05.\n\nAttor encrypts data with a combination of Blowfish and RSA ciphers before\n_[T1022](https://attack.mitre.org/techniques/T1022/)_ Data Encrypted\nsending it to the C&C server.\n\nExfiltration Over Command and\n_[T1041](https://attack.mitre.org/techniques/T1041/)_ Attor exfiltrates data over the C&C channel.\nControl Channel\n\n\n-----\n\n#### ABOUT ESET\n\n[For 30 years, ESET® has been developing industry-leading IT security software and services for](http://www.eset.com/int/)\n\nbusinesses and consumers worldwide. With solutions ranging from endpoint and mobile security,\n\nto encryption and two-factor authentication, ESET’s high-performing, easy-to-use products give\n\nconsumers and businesses the peace of mind to enjoy the full potential of their technology. ESET\n\nunobtrusively protects and monitors 24/7, updating defenses in real time to keep users safe and\n\nbusinesses running without interruption. Evolving threats require an evolving IT security company.\n\n[Backed by R&D centers worldwide, ESET becomes the first IT security company to earn 100 Virus](https://www.eset.com/int/about/newsroom/awards/eset-first-to-break-magical-100-vb100-awards-threshold/)\n\n_[Bulletin VB100 awards, identifying every single “in-the-wild” malware without interruption since 2003.](https://www.eset.com/int/about/newsroom/awards/eset-first-to-break-magical-100-vb100-awards-threshold/)_\n\n[For more information, visit www.eset.com or follow us on LinkedIn, Facebook and Twitter.](https://www.linkedin.com/company/28967?trk=tyah&trkInfo=tarId%3A1402921556545%2Ctas%3AESET%2Cidx%3A2-1-4)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "99fdc3ef-333d-48f5-a4a1-becd788c7b80",
            "created_at": "2022-10-25T15:28:29.802983Z",
            "updated_at": "2022-10-25T15:28:29.802983Z",
            "deleted_at": null,
            "name": "MITRE",
            "url": "https://github.com/mitre-attack/attack-stix-data",
            "description": "MITRE ATT&CK STIX Data",
            "reports": null
        },
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        },
        {
            "id": "bf5be533-fa31-4590-ae37-5761c97ffa34",
            "created_at": "2022-10-25T16:13:58.389257Z",
            "updated_at": "2022-10-25T16:13:58.389257Z",
            "deleted_at": null,
            "name": "Malpedia",
            "url": "https://malpedia.caad.fkie.fraunhofer.de",
            "description": "Malpedia is a free service offered by Fraunhofer FKIE",
            "reports": null
        },
        {
            "id": "5910e58f-4bc9-4e4e-9dbb-887804094a01",
            "created_at": "2022-10-25T16:32:58.457399Z",
            "updated_at": "2022-10-25T16:32:58.457399Z",
            "deleted_at": null,
            "name": "OTX",
            "url": "https://otx.alienvault.com",
            "description": "Alienvault Open Threat Exchange (OTX)",
            "reports": null
        }
    ],
    "references": [
        "https://www.welivesecurity.com/wp-content/uploads/2019/10/ESET_Attor.pdf",
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2019/2019.10.10.Attor_GSM_fingerprinting_spy_platform/ESET_Attor.pdf"
    ],
    "report_names": [
        "ESET_Attor.pdf",
        "ESET_Attor"
    ],
    "threat_actors": [
        {
            "id": "89542ecf-606b-4913-87c5-21512f9b82b9",
            "created_at": "2022-10-25T15:50:23.681673Z",
            "updated_at": "2025-03-27T02:00:55.522794Z",
            "deleted_at": null,
            "main_name": "RTM",
            "aliases": [
                "RTM"
            ],
            "source_name": "MITRE:RTM",
            "tools": [
                "RTM"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "6a99bf81-8ed4-4233-82e2-575e4f9bf282",
            "created_at": "2022-10-25T16:07:24.137248Z",
            "updated_at": "2025-03-27T02:02:10.119569Z",
            "deleted_at": null,
            "main_name": "RTM",
            "aliases": [],
            "source_name": "ETDA:RTM",
            "tools": [
                "AtNow",
                "RTM",
                "RTM Banker",
                "Redaman"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "aa73cd6a-868c-4ae4-a5b2-7cb2c5ad1e9d",
            "created_at": "2022-10-25T16:07:24.139848Z",
            "updated_at": "2025-03-27T02:02:10.120505Z",
            "deleted_at": null,
            "main_name": "Safe",
            "aliases": [],
            "source_name": "ETDA:Safe",
            "tools": [
                "DebugView",
                "LZ77",
                "OpenDoc",
                "SafeDisk",
                "TypeConfig",
                "UPXShell",
                "UsbDoc",
                "UsbExe"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "a76ba723-d744-472a-b683-19d80e105d9f",
            "created_at": "2023-01-06T13:46:39.089347Z",
            "updated_at": "2025-03-27T02:00:02.994033Z",
            "deleted_at": null,
            "main_name": "Attor",
            "aliases": [],
            "source_name": "MISPGALAXY:Attor",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "f9806b99-e392-46f1-9c13-885e376b239f",
            "created_at": "2023-01-06T13:46:39.431871Z",
            "updated_at": "2025-03-27T02:00:03.08926Z",
            "deleted_at": null,
            "main_name": "Watchdog",
            "aliases": [
                "Thief Libra"
            ],
            "source_name": "MISPGALAXY:Watchdog",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1666716497,
    "ts_updated_at": 1743041819,
    "ts_creation_date": 1570638523,
    "ts_modification_date": 1570639838,
    "files": {
        "pdf": "https://archive.orkl.eu/dc342c30cc53686416204d97ceb44156f1ecf5e8.pdf",
        "text": "https://archive.orkl.eu/dc342c30cc53686416204d97ceb44156f1ecf5e8.txt",
        "img": "https://archive.orkl.eu/dc342c30cc53686416204d97ceb44156f1ecf5e8.jpg"
    }
}