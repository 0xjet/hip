{
    "id": "fde80a70-173c-446c-a8d8-b48aff268b82",
    "created_at": "2022-10-25T16:48:12.90307Z",
    "updated_at": "2025-03-27T02:16:37.130541Z",
    "deleted_at": null,
    "sha1_hash": "649457e4c53a882d29845bd545a5fded554684ad",
    "title": "",
    "authors": "",
    "file_creation_date": "2015-05-05T13:59:45Z",
    "file_modification_date": "2015-05-05T13:59:47Z",
    "file_size": 3359722,
    "plain_text": "# COOLREAPER:\n## The Coolpad Backdoor\n\nR E P O R T B Y\nCLAUD XIAO & RYAN OLSON\n\n\n-----\n\n## TABLE OF CONTENTS\n\n###### Executive Summary  3 Coolpad Background 4 User Reporting for this Threat  4 Coolpad Global Expansion  5 CoolReaper: The CoolPad Backdoor  6\n CoolReaper Files and Versions  7 Origin  8 CoolReaper Analysis  9\n System Application with System User ID  9 User Interface  10 Code Structure  10 Component Functionalities  11 Command and Control Servers and the Coolyun Service  13 CoolReaper Back-End  17 Hiding CoolReaper From Users  21\n Hidden From List of Installed Packages  21 Disable Notifications Menu  22 Evading Pre-Installed Antivirus Program  23 CoolReaper Reach and Impact  23\n Customer Reports  23 Geographic Range of Impact  25 Detection and Protection  28 Conclusions and Risks  29 Acknowledgements  30 Appendix A: Significant Malicious Behaviors  30\n\n\n-----\n\n### Executive Summary\n\nCoolpad™ is the sixth largest manufacturer of smartphones in the world, and the\nthird largest in China. We have recently discovered that the software installed on\nmany of Coolpad’s high-end phones include a backdoor which was installed and\noperated by Coolpad, we have named that backdoor “CoolReaper.”\n\nAfter reviewing Coolpad complaints on message boards about suspicious activities\non Coolpad devices, we downloaded multiple copies of the stock ROMs used by\nCoolpad phones sold in China. We found the majority of the ROMs contained the\nCoolReaper backdoor.\n\nCoolReaper can perform the following tasks:\n\n   - Download, install, or activate any Android application without user consent or\nnotification\n\n   - Clear user data, uninstall existing applications, or disable system applications\n\n   - Notify users of a fake Over-the-air (OTA) update that doesn’t update the\ndevice, but installs unwanted applications\n\n   - Send or insert arbitrary SMS or MMS messages into the phone\n\n   - Dial arbitrary phone numbers\n\n   - Upload information about device, its location, application usage, calling and\nSMS history to a Coolpad server\n\nWe expect device manufacturers to install software on top of Android that provides\nadditional functionality and customization, but CoolReaper does not fall into that\ncategory. Some mobile carriers install applications that gather usage statistics and\nother data on how their devices are performing. CoolReaper goes well beyond this\ntype of data collection and acts as a true backdoor into Coolpad devices.\n\nCoolpad customers in China have reported installation of unwanted applications and\npush-notification advertisements coming from the backdoor. Complaints about this\nbehavior have been ignored by Coolpad or deleted.\n\nCoolpad has also modified the Android OS contained in many of their ROMs. The\nmodifications are specifically tailored to hide CoolReaper components from the user\nand from other applications operating on the device. These modifications make the\nbackdoor much more difficult for antivirus programs to detect.\n\nIn November a white-hat security researcher identified a vulnerability in the back-end\ncontrol system for CoolReaper, which allowed him to see how Coolpad controls the\nbackdoor.\n\nThe known impact of CoolReaper thus far is limited to China and Taiwan, but\nCoolpad’s position in the market and global expansion plans mean this backdoor\npresents a threat to Android users all over the world.\n\n\n-----\n\n### Coolpad Background\n\n#### User Reporting for this Threat\n\nCoolpad is a smartphone brand of the Yulong Computer Telecommunication Scientific\n(Shenzhen) Co., Ltd. (“Yulong”), a wholly owned subsidiary of the Coolpad Group\nLimited (“Coolpad”). Yulong is a public company, listed on the main board of HKSE\nsince 2004, code: 02369.\n\nAccording to Wall Street Journal and Canalys, Coolpad is 6th largest smartphone\nmanufacturer in the world. In fact, based on a recent report from IDC, Coolpad\nhas a global market share of 3.7%. Since 2012, Coolpad has been the 3rd largest\nsmartphone maker in China, with a market share of 11.5% in the second quarter\nof 2014. It ranks behind only Lenovo and Xiaomi. In the first half of 2014, Coolpad\nranked first in the Chinese 4G phone market with a share of 15.78%.\n\nCoolpad’s flagship products are called the Halo series (also known as “Dazen”\nphones). This series includes multiple models that operate on both 3G and 4G\nnetworks.\n\nCoolpad also makes many lower-priced phones. The following phones are listed on\ntheir official online store (See Figure 1):\n\n   - The Halo (Dazen) series: Dazen F1, Dazen F1 Plus, Dazen 1S, Dazen F2,\nDazen Note\n\n   - The S series: Coolpad S6\n\n   - The K series: Coolpad K1\n\n  - The Magview series: Magview 9970, Magview 8971\n\n   - Others: Coolpad 8730L, Coolpad 8720L, Coolpad 7295, Coolpad 9150W,\nCoolpad 9080W, Coolpad 5951, Coolpad 7295C, Coolpad 8908\n\nFIGURE 1  +  Halo (Dazen) series phones produced by Coolpad\n\n\n-----\n\nIn addition to direct retail sales, Coolpad distributes phones through all three major\ncarriers in China: China Mobile, China Unicom, and China Telecom.\n\nAlthough it’s not as well known as Samsung or Apple, Coolpad outsells both\ncompanies in China and is expanding their global market, especially in the lucrative\nmarket for 4G phones: In the first half of 2014, Coolpad produced 29 new models, 12\nof which operate on 4G networks; Coolpad shipped 37.2 million units in the whole of\n2013; and in March of 2014 the company shipped 6 million units in a single month.\nCoolpad’s sales target in 2014 is 60 million phones worldwide, with the Halo (Dazen)\nseries alone expecting over 10 million sales.\n\n#### Coolpad Global Expansion\n\nAccording to the Wall Street Journal, Coolpad is planning to expand overseas to\nSoutheast Asia, Europe and the U.S.\n\nOn the official Coolpad Americas website, the company lists three models for sale in\nthe United States.\n\n   - Coolpad Quattro 4G (Coolpad 5860E)\n\n   - Coolpad Flo\n\n   - Coolpad Quattro II\n\nIn 2012, Coolpad cooperated with MetroPCS Communications (which was then\nmerged into T-Mobile), and sold more than 1.3 million units of Quattro 4G in the\nUnited States. In 2014, the company cooperated with GoSmart Mobile and began\nselling the Coolpad Flo in the United States.\n\nStarting in 2013, Coolpad began working with Vodafone and France Télécom to sell the\nCoolpad 8860U and Coolpad 8870U in more than ten European countries.\n\nBeginning in July of 2014, Coolpad began cooperating with South East Asian local\ncarriers in Taiwan, India and Indonesia, with plans to expand to Burma, Thailand and\nMalaysia. Through September 2014, over 500,000 of the Halo (Dazen) series have\nshipped to these countries.\n\n\n-----\n\n### CoolReaper: The Coolpad Backdoor\n\nReports of suspicious activity on Coolpad Android devices began appearing on Chinese\nuser forms in October of 2013. Users’ reported advertisements being pushed as\nnotifications, new applications appearing without the users knowledge and Over-TheAir (OTA) Updates that didn’t update the OS as expected. To locate the cause of these\nanomalies we began investigating both stock and modified ROM files that form the\nbase of the Coolpad Android installation.\n\nCoolpad provides ZIP-format stock ROMs for the Halo (Dazen) series, the K series and\nthe S series phones, and provides customized format stock ROMs for other models. All\nof these stock ROMs are available for download at Coolpad’s official support forum or\nin their official service center. Coolpad provides these ROMs for OTA updates and for\nfactory resets. We suspect — but have not confirmed — that these same ROMs were\nalso flashed into corresponding models of phones when Coolpad manufactured them.\n\nIn November 2014 we downloaded 45 stock ROMs for all 8 models of the Halo\n(Dazen) series from Coolpad’s official forum (Figure 2). To broaden our search, we\nalso downloaded 32 third-party ROMs for 20 other Coolpad models from two ROM\ndistribution sites in China: romzj.com and romzhijia.net. These ROMs are customized\nby the community but are based on the stock ROMs for each phone model.\n\nFIGURE 2  +  Stock ROMs of Dazen F1 can be downloaded from official forum\n\n\n-----\n\nIn total, we acquired 77 ROMs for the Chinese versions of Coolpad Android devices.\n64 of these ROMs contained the backdoor, (i.e., CoolReaper). 41 of the infected ROMs\nare the stock files for the 8 models of Dazen phones, and the other 23 are third-party\nROMs for the remaining 16 Coolpad models. In total, we’ve confirmed that at least 24\ndifferent Coolpad models contain the CoolReaper backdoor. Table 1 lists the models\nand ROM files analyzed and the number of those infected for each model.\n\nNAME AND MODEL NUMBER ANALYZED ROMS INFECTED ROMS\n\nDazen F2 8675 8 8\n\nDazen F2 8675-W00 1 1\n\nDazen 1S 9976A 8 5\n\nDazen 1S 9976T 5 4\n\nDazen F1 8297-C00 3 3\n\nDazen F1 8297 6 6\n\nDazen F1 8297W 8 8\n\nDazen Note 8670 6 6\n\nCoolpad 5950 2 2\n\nCoolpad 5950A 1 1\n\nCoolpad 5951 2 2\n\nCoolpad 7295A 2 1\n\nCoolpad 7295C 2 1\n\nCoolpad 7296 1 1\n\nCoolpad 7298A 3 3\n\nCoolpad 7298D 1 1\n\nCoolpad 7620L 4 3\n\nCoolpad 8079 1 1\n\nCoolpad 8089 1 1\n\nCoolpad 8190 2 1\n\nCoolpad 8295 1 1\n\nCoolpad 8705 1 1\n\nCoolpad 8720L 3 2\n\nCoolpad 8730L 1 1\n\nCoolpad 8060 1 0\n\nCoolpad 8150 1 0\n\nCoolpad 9070 1 0\n\nCoolpad 9970 1 0\n\nTABLE 1  Infected Models and ROMs number\n\n#### CoolReaper Files and Versions\n\nIn the various ROMs which included CoolReaper, the components are contained in\npackages with the following file names:\n\n  - /system/app/CP_DMP.apk\n\n  - /system/app/CP_DMP.odex\n\n  - /system/app/GoogleGmsFramework.apk\n\n  - /system/app/GoogleGmsFramework.odex\n\n   - /system/lib/libgmsframework.so\n\n\n-----\n\nThe libgmsframework.so file is not a library, but actually an APK file. The content of this file is\nalways identical to that of GoogleGmsFramework.apk in the same ROM. The only difference\nbetween the two, is that the fake library is signed by a common debug certificate.\n\nIn total we located 12 different versions of CoolReaper as shown in Table 2.\n\nNAME AND MODEL NUMBER ANALYZED ROMS INFECTED ROMS\n\nCP_DMP.apk 2013101120 V2.11.01.2013101120_VER_2013.10.12_19:51:14\n\nCP_DMP.apk 2013101122 V2.11.02.2013101122_VER_2013.10.12_20:45:09\n\nCP_DMP.apk 2013102521 V2.13.01.2013102521_VER_2013.10.25_21:55:37\n\nCP_DMP.apk 2013102521 V2.13.01.2013102521_VER_2013.10.29_20:08:29\n\nCP_DMP.apk 2013112015 V2.17.01.2013112015_VER_2013.11.23_13:12:49\n\nCP_DMP.apk 2013121921 V2.19.01.2013121921_VER_2013.12.20_14:00:37\n\nCP_DMP.apk 2014011320 V2.23.01.2014011320_VER_2014.01.13_23:39:57\n\nCP_DMP.apk 2014040220 V2.28.01.2014040220_VER_2014.04.02_19:28:28\n\nGoogleGmsFramework.apk 2014062321 V3.03.01.2014062321_VER_2014.06.24_09:30:13\nlibgmsframework.so\n\nGoogleGmsFramework.apk 2014072115 V3.04.01.2014072115_VER_2014.07.25_09:45:43\nlibgmsframework.so\n\nGoogleGmsFramework.apk 2014101611 V3.06.01.2014101611_VER_2014.10.16_15:38:38\nlibgmsframework.so\n\nGoogleGmsFramework.apk 2014102915 V3.07.01.2014102915_VER_2014.10.29_14:52:04\nlibgmsframework.so\n\nTABLE 2  Versions of CoolReaper Files\n\nThe developer used package-build date as its version code, and used a combination\nof build and integration time in its version name. Using these two identifiers we can\nsee that CoolReaper was developed on or before October 12, 2013.\n\nWe also observed that around May 2014, a new primary version of the backdoor was\nreleased (from 2.x to 3.0). At the same time, the name of the package was changed\nfrom CP_DMP.apk to GoogleGmsFramework.apk. We suspect this change was in\nresponse to customer reports of malicious actions by packages with the name\n“CP_DMP.apk”.\n\n#### Origin\n\nOne may suspect that the CoolReaper backdoor was created by a malicious third\nparty. However, for the following reasons we believe that the backdoor was created\nand installed by Coolpad.\n\nAll CoolReaper APK files we have identified were signed with a certificate that\nbelongs to Coolpad (see Table 3) and the 41 infected stock ROMs are also signed by\nthe same certificate.\n\nSome of the stock ROMs that included CoolReaper contained a modified version of\nAndroid that was changed specifically to hide CoolReaper from the user and from\nantivirus programs.\n\nThe two domains used as command and control servers for CoolReaper, coolyun.\ncom and 51Coolpad.com, are registered by Coolpad and used by Coolpad for their\npublic cloud services.\n\n\n-----\n\nIn November, a vulnerability in CoolReaper s backend control system was disclosed\n(see CoolReaper Back-End). Coolpad acknowledged the control systems existence\nwhen they agreed to patch the vulnerability. The control system is also hosted on\ncoolyun.com, which also hosts the command and control server for CoolReaper.\n\n### CoolReaper Analysis\n\nTo identify the functionality of this backdoor, we analyzed a CoolReaper sample that\ncame from a stock ROM for Dazen F2 (Coolpad 8675) based on Android 4.4. The\nROM was built on November 18, 2014 with the build ID 4.4.051.P2.141118.8675. The\nROM has a SHA-1 value of 39240a84070040c27221b477f101bf9b1555d7ce. Within\nthis ROM, the Coolreaper APK is located at /system/app/GoogleGmsFramework.apk.\nThat APK file has a SHA-1 value of 3753244484c4a8b2b2dc8c3b7e119eabd0490398.\n\nThe code in this APK file was obfuscated by ProGuard, a tool that is used to make\nreverse engineering more difficult by obfuscating symbol names. In the process of\nanalyzing this code we have renamed many of the symbols back to what we expect\ntheir original name was. Readers will see many of these names in screenshots\ncontained in this document. We renamed the functions based on the following\nprinciples.\n\n1. CoolReaper’s developer included many debugging strings that identify the\nname of original class or function; where possible, we have used these\nnames. (Figure 3)\n\n2. The code is high quality and the developer was very consistent about using\nspecific schemas; the renamed functions follow those schemas.\n\n3. Where we were unable to identify the author’s intended name we based the\nnew name on the functionality of the object.\n\nFIGURE 3  +  Many classes use a TAG field for debugging purposes.\n\nChanging the names of these functions makes the code more readable, but does not\nchange logic or functionality of the code.\n\n#### System Application with System User ID\n\nIn the infected ROMs, CoolReaper is installed as an Android system application. All\nof the samples also have the same package name, “com.android.update.dmp”. The\nidentifier “DMP” occurs in the file name, the package name, C2 URLs and other\nlocations. We suspect this is an acronym for “Data Management Platform.”\n\n\n-----\n\nIn the AndroidManifest.xml, which specifies how an App interacts with the Android\nsystem, CoolReaper declares an android:sharedUserId attribute with the value of\n“android.uid.system” (Figure 4). By doing this, the application will run with the uid\nof the system user which has system privileges on the device. This is intended for\napplications built into the operating system and not those installed by 3rd parties.\n\nFIGURE 4  +  Package name and UserId of CoolReaper.\n\nFigure 5 shows the certificate used to sign CoolReaper samples, which belongs to\nCoolpad and also signed the stock ROMs we have analyzed.\n\n```\nOwner: EMAILADDRESS=android@yulong.com, CN=YuLong, OU=YuLong, O=YuLong,\nL=ShenZhen, ST=GuangDong, C=CN\nIssuer: EMAILADDRESS=android@yulong.com, CN=YuLong, OU=YuLong, O=YuLong,\nL=ShenZhen, ST=GuangDong, C=CN\nSerial number: fb1ecd58cb8358f7\nValid from: Fri Oct 22 08:26:53 PDT 2010 until: Fri Sep 21 08:26:53 PDT 2035\n\n```\nCertificate fingerprints:\n```\n    MD5: DB:DB:3B:ED:34:72:B1:B3:C4:CA:59:BE:CD:33:9F:44\n    SHA1: 5D:F8:F0:82:12:61:A2:34:D1:11:02:8E:FD:DF:FA:3C:88:89:76:49\n    Signature algorithm name: SHA1withRSA\n    Version: 3\n\n```\n\nFIGURE 5  +  Coolpad certificate used to sign CoolReaper files.\n\n#### User Interface\n\nCoolReaper’s visible application name is “Android System”, and uses an icon from\nanother real system application, however, CoolReaper does not appear in the Android\nlauncher.\n\nCoolReaper has implemented very few components of the user interface. Some\nof them are non-effective, such as the com.android.update.dmp.MainActivity;\nand others are used for malicious or potentially unwanted functionalities. These\ncomponents include com.android.update.dmp.PretendedOTADialog, which is used to\nshow a false OTA update notification and com.android.update.dmp.weblinkhandler.\nWebLinkActivity, which opens a specific URL supplied by the command and control\nserver.\n\nApproximately half of CoolReaper’s malicious and potentially unwanted behaviors\nhave no user interface and provide no user notifications.\n\n#### Code Structure\n\nCoolReaper’s primary code can be split into two major components. The author refers\nto the first component as “DMP” and the second component as “ICU”.\n\n\n-----\n\nJava classes in the DMP component have a common prefix com.android.update.\ndmp”. They are responsible for fetching remote commands from the C2 server,\ndownloading related files, and performing local malicious behaviors. This component\nis triggered by common events such as BOOT_COMPLETED, CONNECTIVITY_\nCHANGE and USER_PRESENT. When these events occur, DMP starts a server\nnamed com.android.update.dmp.SystemOptService in the background.\n\nJava classes in the ICU component have a common prefix of “com.android.\nicu”. These are responsible for collecting user information and sending it to the\nC2 server. ICU operates as a system service named com.android.icu.service.\nSystemPipeService.\n\nIt appears that the DMP and ICU components are developed separately as they have\ndifferent functionalities, different code paths, different C2 server addresses, and do\nnot invoke each other.\n\n#### Component Functionalities\n\nWithin CoolReaper, the DMP and ICU components implement many capabilities that,\nwhen combined, make a very functional backdoor.\n\nThe DMP component functions are mainly for remotely controlling the device. This\ncomponent contains functions that allow it to take the following actions:\n\n   - Download a specified APK file, OTA update package and other kinds of files\nwithout user confirmation\n\n   - Install downloaded APK file in the background without user confirmation\n\n   - Launch any installed application without user confirmation\n\n   - Start specified service in any installed application without user confirmation\n\n   - Uninstall any application from the device in the background without user\nconfirmation\n\n   - Create a shortcut of installed application on the desktop, or delete any\nshortcut from the desktop\n\n   - Clear user data of any specified application without user confirmation\n\n   - Enable or disable specified system application without user confirmation\n\n   - Notify the user of a normal OTA update\n\n   - Notify the user of a fake OTA update\n\n   - Perform an OTA update using a previously downloaded package.\n\n   - Dial a specified phone number without user confirmation\n\n   - Send SMS with specified content to a specified phone number without user\nconfirmation\n\n   - Insert a new SMS or MMS into the inbox with specified content and specified\na phone number, and display a fake notification\n\n   - Open a specified URL with the default browser or with specified application\nwithout user confirmation\n\n   - Get or set specified system properties\n\n   - Popup a notification or a dialog, after user clicks it, download and install\nspecified APK\n\n   - Popup a notification, after user clicks it, dial specified phone number\n\n   - Popup a notification, after user clicks it, display a HTML\n\n\n-----\n\n   - Popup a notification, after user clicks it, launch any installed application\n\n   - Upload the device’s disk information to the C2 server\n\n   - Send information about whether the device was rooted or not (or not) to the\nC2 server\n\nOn the other hand, the ICU component mainly collects user information and sends it\nto the C2 server. ICU collects and uploads the following information:\n\n   - The device’s hardware information\n\n   - The device’s geographic information including city and province names\n\n   - Information about all installed applications and their usage frequency\n\n   - Count and duration of calls, count of SMS messages sent and received\n\n   - Network information, including all network connection types and time they\nbegan\n\nIt is clear from all of the functionalities listed above, that CoolReaper can act as a\nbackdoor. The operator can simply uninstall or disable all security applications in user\ndevices, install additional malware, steal information and inject content into the users\ndevice in multiple ways.\n\nBeyond this functionality, many of the debugging strings within the code itself\ninclude the words “backdoor”. For example, according to debugging code one class\nis named “BackDoorManager” and contains a method named “processBackDoor”\n(Figure 6).\n\n\n-----\n\nWhen performing the pretended OTA update function, the feedback report\nmessage is “the preset app back door is opened!” and in the default preference file\nan item is named “isBackDoorMsgSended” (Figure 7).\n\nFIGURE 7  +  Backdoor message and preference.\n\nThe debugging message, feedback message and preference name are of course,\nnot malicious by themselves. However, these strings indicate that the author of\nCoolReaper intended it to be a backdoor into these devices.\n\nCoolReaper contains far too much functionality to detail here. Appendix A contains\nscreenshots of the source code for the most significant functions implemented in\nthis backdoor.\n\n#### Command and Control Servers and the Coolyun Service\n\nThe DMP and ICU components of CoolReaper use two different groups of URLs as\ntheir command and control (C2) servers.\n\nThe DMP component configuration (Figure 8) lists the following domain names and IP\naddress:\n\n  - dmp.51Coolpad.com\n\n  - dmp.coolyun.com\n\n   - 13.142.37.149\n\n\n-----\n\nFIGURE 8  +  Some configurations about the C2 server.\n\nAt the time of our analysis, these domain names resolved to the IP address listed\nabove, 113.142.37.149. CoolReaper has the ability to update the C2 server at any time\n(Figure 9).\n\nFIGURE 9  +  Update C2 server address during running.\n\n\n-----\n\nThe DMP component uses an HTTP POST request to communicate with the C2 server.\nWhen fetching commands or uploading information, it uses a unique User-Agent:\n“UAC/1.0.0 (Android <Build.VERSION.RELEASE>; Linux)” (Figure 10). Here the <Build.\nVERSION.RELEASE> is the system version name in the Android OS installed on the\ndevice.\n\nFIGURE 10  +  User-Agent used in C2 traffic\n\nWithin the CMP component, CoolReaper uses 13 different URLs to register the device,\nretrieve the running configuration, fetch commands, report execution results, upload\nexception information, download APK files and perform other tasks. Those URLs are\nlisted below:\n\n   - http://dmp.51Coolpad.com/dmp/api/getfirstpushmsg\n\n   - http://dmp.coolyun.com/dmp/api/userregister\n\n   - http://dmp.coolyun.com/dmp/api/getstrategy\n\n   - http://dmp.coolyun.com/dmp/api/getpushmsg\n\n   - http://dmp.coolyun.com/dmp/api/reportpushmsg\n\n  - http://dmp.coolyun.com/dmp/api/updatepushmsg\n\n   - http://dmp.coolyun.com/dmp/api/exceptupload\n\n   - http://dmp.coolyun.com/dmp/api/setuserstate\n\n   - http://dmp.coolyun.com/dmp/api/getapkupdate\n\n   - http://dmp.coolyun.com/dmp/api/strategyandupdate\n\n   - http://dmp.coolyun.com/dmp/api/ctruleservlet\n\n   - http://dmp.coolyun.com/dmp/api/ctrulereportservlet\n\n   - http://dmp.coolyun.com/dmp/api/strategyandupdate\n\nThe ICU component uses the following URLs to download configuration data and\nupload user information:\n\n   - http://icudata.coolyun.com/\n\n   - http://icudata.51Coolpad.com/\n\n   - http://113.142.37.246/filereceiver\n\n   - http://icucfg.coolyun.com/\n\n   - http://icucfg.51Coolpad.com/\n\n   - http://113.142.37.246/icucfg\n\n   - http://file.Coolpadfuns.cn/actioncollect\n\n\n-----\n\nIn addition to hosting the command and control infrastructure for CoolReaper, coolyun.\ncom also hosts Coolpad’s public cloud service named “Coolyun.” (Figure 11)\n\nFIGURE 11  +  Coolyun.com the CoolReaper C2 belongs to Coolpad\n\nThrough Coolyun, Coolpad offers services and applications for Android users. We\ncompared CoolReaper to Coolyun client to confirm it was not a legitimate Coolyun\n“administration” application.\n\nThe Coolyun application package name is “com.android.coolwind”. It is available from\nCooyun.com and through various application stores. We registered a Coolyun account\nand saw that the user panel shows only a few services, including backup of contacts,\ncalendar, SMS, calling history, notes, bookmarks, photos, find my phone, and cloud\nstorage. These functions are very different from CoolReaper.\n\nIn fact, except for using the same C2 domain name, the only relationship between\nCoolReaper and the Coolyun service is that the ICU component collects the Coolyun\naccount name from infected devices and sends it to the C2 server.\n\n\n-----\n\n### CoolReaper Back-End\n\nTypically the backend control system for a backdoor like CoolReaper would not be\naccessible to researchers or the public, but recent developments have given us a\nglimpse into how Coolpad uses this tool.\n\nWooyun.org is a vulnerability assessment crowdsourcing website similar to\nBugcrowd. On November 19, 2014 an independent white hat researcher named\n“爱上平顶山” (Aishangpingdingshan) submitted a vulnerability (WooYun-2014-83824)\nto Coolpad with the title “A critical vulnerability in Coolpad’s official backend platform\nfor silently installing APK functionality” (Figure 12). That same day, Coolpad confirmed\nthe vulnerability, gave it the highest-ranking score (20) and made the comment\n“Thank you for providing the information, we will fix it ASAP. Thanks.” (Figure 13)\n\n\n-----\n\nFIGURE 13  +  Coolpad confirmed the vulnerability.\n\nWooyun practices responsible disclosure, meaning that the details of the vulnerability\nwere not made public. However, as a certified white-hat researcher registered with\nWooyun, we were able to view the details of the vulnerability submission 10 days\nafter Coolpad confirmed its existence.\n\nThe detailed vulnerability report describes it as an unauthorized access issue within\nauth.coolyun.com. Through this authentication gateway, the researcher was able to\nlog into a “Permission Management Platform” which had functionalities including:\n\n  - “Push App Through Fake OTA”\n\n   - “Silently Install APK”\n\n  - “Push Backend Command”\n\n   - “Push Activate the APK”\n\n\n-----\n\nThe screenshots (Figure 14) also showed some applications had recently been\npushed for silent installation. All these applications’ names ended with Chinese\ncharacters of “Silently Overwrite Update”.\n\nFIGURE 14  +  Screenshot of the backend control system in the vulnerability report.\n\n\n-----\n\nThe day after the vulnerability was submitted to Wooyun, Aqniu.com, a Chinese\nsecurity media website, published an article that contains another screenshot of this\nbackend control system (Figure 15). Through this unobfuscated screenshot, we can\nsee a full list of functionalities provided by this system:\n\n   - Silently install an APK\n\n   - Silently uninstall an APK\n\n   - Activate third-party applications in the background\n\n   - Activate third-party services in the background\n\n   - Issue configuration file in the background\n\n  - Issue backend command through push\n\n  - Prompt APK through push\n\n   - Activate APK through push\n\n  - Open webpage URL through push\n\n  - Prompt HTML through push\n\n   - Dial phone through push\n\n   - Insert fake SMS through push\n\n   - Insert fake MMS through push\n\n   - Prompt app in fake OTA update through push\n\n  - Prompt OTA update through push\n\n   - Prompt OTA update notification through push\n\nFIGURE 15  +  Screenshot of the backend control system published by Aqniu.com.\n\n\n-----\n\nNote that, all of these functionalities are implemented in the code of CoolReaper\nsamples we analyzed.\n\nOn November 21, 2014, Aqniu.com published a second article explaining that\nsomeone who claimed to be representing Coolpad public relations stated that the\ntool was “only used for internal testing” and asked Aqniu.com to withdraw the\narticle. Aqniu.com then requested a formal letter demanding the retraction, but the\nrepresentative did not respond.\n\n### Hiding CoolReaper from Users\n\nIn addition to including the CoolReaper backdoor, some of the CoolPad ROMs include\ncustomizations intended to hide the backdoor.\n\n#### Hidden from list of Installed Packages\n\nThe first customization exists in the /system/framework/services.odex file. This file\nimplements fundamental services and other components in the Android system.\nCoolpad has modified the getInstalledPackages method implemented in the Package\nManager Service that is used to retrieve a list of all packages installed on the Android\nservice. The modified version specifically looks for a package with the name “com.\nandroid.update.dmp” and prevents it from being returned to the requesting program.\n(Figure 16).\n\nFIGURE 16  +  Hiding from the installed packages list.\n\n\n-----\n\nThis modification not only hides the package from users but also from AntiVirus\nand Mobile Device Management (MDM) solutions. As a result, these tools will not\nlikely be aware of the backdoor package so they cannot scan it to determine if it is\nmalicious.\n\n#### Disable Notifications Menu\n\nThe second customization is performed to /system/app/SystemUI.odex, another\nimportant component of the Android OS that controls the phone’s user interface. In\nthis case Coolpad has modified the getNotificationLongClicker method in a internal\nclass named com.android.systemui.statusbar.BaseStatusBar.\n\nNormally, when an Android application places a notification in system’s notification\nbar, the user can view the application that generated it by “long clicking” on the\nnotification. This way the user can identify and disable notifications they do not want\nto receive.\n\nWith CoolPad’s modifications, any notification generated by CoolReaper will not\nshow this application information (Figure 17), preventing users from identifying the\napplication that generated it.\n\nFIGURE 17  +  Don’t show menu when long clicking the notification.\n\n\n-----\n\n#### Evading Pre-Installed Antivirus Program\n\nThe third customization is to a pre-installed security application “CoolManager”\nproduced by Coolpad itself. This application provides basic antivirus and other security\nservices. Each time an application is updated or installed, CoolManager will scan it to\nidentify malware. Similar to the previous modifications, if the package has the name\n“com.android.update.dmp”, the scanning thread will not begin (Figure 18). This allows\nCoolReaper to evade the built-in AV product when the backdoor is installed or updated.\n\nFIGURE 18  +  Modified CoolManager does not scan CoolReaper Package.\n\n### CoolReaper Reach and Impact\n\n#### Customer Reports\n\nSearching for the primary name of the CoolReaper package, “CP_DMP.apk”, through\nGoogle on November 30, 2014 we found 236 results. Most of these are customer\ndiscussions about the file on Chinese forums (Figure 19).\n\nFIGURE 19  +  Search results show many user reports.\n\n\n-----\n\nStarting in October 2013, customers began discussing strange phenomena on their\n\nCoolpad phones, including:\n\n   - Devices self updating\n\n   - Devices frequently pushing advertisements as notifications (Figure 20)\n\n   - Devices silently installing multiple games\n\n   - Devices prompting OTA update notifications; after rebooting, the system\nwasn’t updated yet about 11 new applications were installed\n\nOn May 5, May 7, May 20 and May 28, four customers reported the problem\n\nto Coolpad through their official support forum. Another user replied that these\n\nproblems are caused by the CP_DMP.apk application. However, Coolpad did not offer\n\nan official response to the reports.\n\nFIGURE 20  +  CoolReaper promote\nadvertisement in a user’s phone (From\nliuhuafang.com).\n\nShortly after these customer complaints, CoolReaper was upgraded from version\n\n2.x to version 3.0, and the APK file name was changed from CP_DMP.apk to\n\nGoogleGmsFramework.apk. We believe this intention of this update was to hide the\n\nbackdoor from users who had already located it. This tactic appears to have been\n\nsuccessful as customers could only identify the backdoor by the name “CP_DMP.\n\napk” at that time. In a discussion on August 24 a customer asked “I deleted the\n\nCP_DMP.apk. But after some days, advertisements occur again. What should I do?”\n\n\n-----\n\nFIGURE 21  +  A user report was deleted by Coolpad.\n\nFinally on October 23, a user reported the problem in Coolpad’s support forum again\n\nand an administrator deleted the report, but it is still accessible through Google\n\nsearches (Figure 21).\n\n#### Geographic Range of Impact\n\nWe do not know how many Coolpad devices contain the CoolReaper backdoor.\nConsidering that CoolReaper appears to have been developed and embedded into 24\nphone models in the last 12 months, and the Coolpad sales targets published by IDC,\nit’s possible that over 10 million users have been affected.\n\nMost of the infected devices should be located in China as the tool appears to\nspecifically target Chinese users. For instance, in one piece of code the backdoor\nchecks mobile device’s SIM card IMSI (International Mobile Subscriber Identity)\nnumber and compares it to those of three Chinese carriers. (Figure 22).\n\nFIGURE 22  +  Chinese carriers’ name in CoolReaper.\n\nOn November 25, 2014, we purchased a Coolpad Flo phone in California and found\n\nthat it did not contain the CoolReaper backdoor. This device was manufactured\n\nover a year ago, so it may simply have been built too early to contain the malicious\n\nsoftware. We have not been able to analyze the remaining two models sold in the US\n\nor those sold in Europe and the rest of Asia. Only the Chinese versions of Coolpad\n\nROM files are available for download.\n\n\n-----\n\nIt is possible that CoolReaper exists on Coolpad phones outside China for these\n\nreasons:\n\n   - On consumer-to-consumer websites like eBay, some Coolpad phones are\ndirectly sold from mainland China and Hong Kong to other countries or areas\nincluding the United States and Europe.\n\n   - CoolReaper may be directly embedded in phones sold outside China, just not\nin the devices we have analyzed.\n\n   - CoolReaper can be installed remotely through Coolpad’s devices’ official OTA\nupdate system that implemented in “CP_OTA.apk”. This package was installed\non the Coolpad Flo devices purchased in the US. One of the user complaints\nwe presented in the previous section showed that even after the user deleted\nthe CP_DMP.apk file, it was automatically re-installed. This re-installation could\noccur through the OTA mechanism.\n\nIn October 2014, two users in Taiwan reported that their Coolpad 5950T devices were\n\ninfected on the mobile01 forum (Figure 23).\n\nFIGURE 23  +  Two users at Taiwan reported infection.\n\n\n-----\n\nIn addition to reports from Taiwanese users, on December 11th we detected\n\nCoolReaper command and control traffic emanating from educational institutions in\n\nlocated in Taiwan. (Figure 24)\n\nFIGURE 24  +  C2 traffic generated by CoolReaper ICU component in Taiwan.\n\n\n-----\n\n### Detection and Protection\n\nCoolReaper is difficult for antivirus programs to detect and remove. In some cases\nthe Android OS has been modified to hide CoolReaper from security programs. The\nbackdoor files are signed with Coolpad’s official certificate, which may bypass some\nsecurity products that are based on white list mechanisms. Additionally, if an antivirus\nproduct was able to detect the backdoor, the product will not be able to remove\nthe application without first gaining root privileges, as CoolReaper is installed as a\nsystem application.\n\nIn April and July 2014, three samples of CoolReaper were uploaded into VirusTotal\n(link1, link2 and link3). As of August 23, 24 security vendors identified these samples\nas malicious or suspicious files. However, the samples were identified as “Generic”\nor “Agent” families, which indicates the vendors have no specific knowledge of the\nmalware. Some vendors identified one of the samples as “Trojan.Android.Andup.a”,\nwhich is inaccurate. (Figure 25).\n\nFIGURE 25  +  Some security vendors detected it as an unrelated family.\n\nPalo Alto Networks’ solutions to CoolReaper are based on detection and prevention\nin enterprise networks. These protections were deployed in three levels:\n\n1. All known samples of CoolReaper have been marked as malicious in our\nWildfire system. If a device downloads an updated CoolReaper package\nthrough one of our Next Generation Firewalls, the system will identify it as\nmalware.\n\n2. All known C2 URLs used by CoolReaper have been marked as malicious in\nour Threat Prevention AV and PANDB products.\n\n3. IPS Signatures 13891 and 13892 detect CoolReaper’s malicious C2 traffic.\nThis will detect and block CoolReaper C2 traffic even if the C2 server\nchanges to a new location.\n\n\n-----\n\nFor individuals who own Coolpad devices, we suggest checking for the following files\nin your phones file system using a utility like Root Explorer:\n\n  - /system/app/CP_DMP.apk\n\n  - /system/app/CP_DMP.odex\n\n  - /system/app/GoogleGmsFramework.apk\n\n  - /system/app/GoogleGmsFramework.apk\n\n   - /system/lib/libgmsframework.so\n\nIf any one of these files exists, the phone may contain the CoolReaper backdoor. If the\nphone is rooted, you can simply delete all of these files using your root privileges. However,\nCoolpad may still be able to install new malware in the future using an OTA update.\n\n### Conclusions and Risks\n\nBased on our analysis we can conclude the following about CoolReaper:\n\n   - The CoolReaper backdoor was signed using Coolpad digital certificates, built\ninto Coolpad stock ROMs and uses Coolpad servers for command and control.\n\n   - Coolpad acknowledges the existence of a phone management interface,\nwhich contains the same functionality as the CoolReaper backdoor. This\ninterface is on an Internet-facing server and recently contained a vulnerability\nthat allowed unauthorized access.\n\n   - Stock Coolpad ROMs contain modifications to help hide CoolReaper from\nusers and antivirus programs.\n\n   - Despite multiple user reports and complaints about unwanted applications and\nadvertisements, Coolpad has not addressed this issue with their customers.\n\nIt is possible that Coolpad created this program to help them update devices or\ngather statistics on how they are being used. Manufacturers are expected to install\ncustom software on Android devices, but CoolReaper has functionality well beyond\nwhat a user would expect. The backdoor gives Coolpad complete control over the\ndevices that contain it. Chinese customers have reported that the system is currently\nbeing used to show advertisements and install unwanted applications.\n\nThe fact that the CoolReaper management interface could be hijacked by malicious\nattackers through a vulnerability helps highlight the danger of pre-installing this type\nof backdoor program. While this vulnerability may be already fixed, others may exist\nthat could allow a malicious actor to take control Coolpad devices.\n\nThe known impact of CoolReaper thus far is limited to China and Taiwan, but\nCoolpad’s position in the market and global expansion plans mean this backdoor\npresents a threat to Android users all over the world.\n\n\n-----\n\n### Acknowledgements\n\nWe would like to thank Hui Gao and Zhaoyan Xu of Palo Alto Networks for ensuring that our\ncustomers are well protected by Palo Alto Networks’ Antivirus, Wildfire, IPS and URL Filtering\nproducts. We would also like to thank 6fc67ebcb6423efa0619877722ffc3ee and Zhi Xu of\nPalo Alto Networks for their help with the analysis of CoolReaper.\n\n### Appendix A:  Significant Malicious Behaviors\n\nMost of the functionalities implemented in CoolReaper should be classified as malicious or\npotentially unwanted. The following code segments show how the backdoor performs the\nmost significant actions.\n\nFIGURE 26  +  Install a downloaded APK package in background.\n\n\n-----\n\nFIGURE 28  +  Launch a specified application.\n\nFIGURE 29  +  Clear user data of specified application.\n\n\n-----\n\nFIGURE 30  +  Enable or disable specified system application.\n\nFIGURE 31  +  Perform “pretended” OTA update to “open back door.”\n\nFIGURE 32  +  Dial specified phone number.\n\n\n-----\n\nFIGURE 33  +  Send SMS with specified content to specified number.\n\nFIGURE 34  +  Insert a new SMS from specified number with specified content.\n\n\n-----\n\nFIGURE 36  +  Insert a new MMS message from specified number with specified content.\n\nFIGURE 37  +  Get or set specified system property.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "5910e58f-4bc9-4e4e-9dbb-887804094a01",
            "created_at": "2022-10-25T16:32:58.457399Z",
            "updated_at": "2022-10-25T16:32:58.457399Z",
            "deleted_at": null,
            "name": "OTX",
            "url": "https://otx.alienvault.com",
            "description": "Alienvault Open Threat Exchange (OTX)",
            "reports": null
        }
    ],
    "references": [
        "https://www.paloaltonetworks.com/content/dam/paloaltonetworks-com/en_US/assets/pdf/reports/Unit_42/unit42-cool-reaper.pdf"
    ],
    "report_names": [
        "unit42-cool-reaper.pdf"
    ],
    "threat_actors": [
        {
            "id": "f0bccc3d-ad77-49c4-8dfd-8a8a8d6fba26",
            "created_at": "2024-05-01T02:03:08.134022Z",
            "updated_at": "2025-03-27T02:05:17.415028Z",
            "deleted_at": null,
            "main_name": "NICKEL FOXCROFT",
            "aliases": [
                "Group 123 ",
                "Moldy Pisces ",
                "RICOCHET CHOLLIMA ",
                "Reaper ",
                "ScarCruft ",
                "APT37 "
            ],
            "source_name": "Secureworks:NICKEL FOXCROFT",
            "tools": [
                "ROKRAT"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "9b02c527-5077-489e-9a80-5d88947fddab",
            "created_at": "2022-10-25T16:07:24.103499Z",
            "updated_at": "2025-03-27T02:02:10.108504Z",
            "deleted_at": null,
            "main_name": "Reaper",
            "aliases": [
                "APT 37",
                "ATK 4",
                "Cerium",
                "Crooked Pisces",
                "Geumseong121",
                "Group 123",
                "ITG10",
                "InkySquid",
                "Moldy Pisces",
                "Opal Sleet",
                "Operation Are You Happy?",
                "Operation Battle Cruiser",
                "Operation Black Banner",
                "Operation Daybreak",
                "Operation Dragon messenger",
                "Operation Erebus",
                "Operation Evil New Year",
                "Operation Evil New Year 2018",
                "Operation Fractured Block",
                "Operation Fractured Statue",
                "Operation FreeMilk",
                "Operation Golden Bird",
                "Operation Golden Time",
                "Operation High Expert",
                "Operation Holiday Wiper",
                "Operation Korean Sword",
                "Operation North Korean Human Right",
                "Operation Onezero",
                "Operation Rocket Man",
                "Operation SHROUDED#SLEEP",
                "Operation STARK#MULE",
                "Operation STIFF#BIZON",
                "Operation Spy Cloud",
                "Operation Star Cruiser",
                "Osmium",
                "Red Eyes",
                "Ricochet Chollima",
                "Ruby Sleet",
                "ScarCruft",
                "TA-RedAnt",
                "TEMP.Reaper",
                "Venus 121"
            ],
            "source_name": "ETDA:Reaper",
            "tools": [
                "Agentemis",
                "BLUELIGHT",
                "Backdoor.APT.POORAIM",
                "CARROTBALL",
                "CARROTBAT",
                "CORALDECK",
                "Cobalt Strike",
                "CobaltStrike",
                "DOGCALL",
                "Erebus",
                "Exploit.APT.RICECURRY",
                "Final1stSpy",
                "Freenki Loader",
                "GELCAPSULE",
                "GOLDBACKDOOR",
                "GreezeBackdoor",
                "HAPPYWORK",
                "JinhoSpy",
                "KARAE",
                "KevDroid",
                "Konni",
                "MILKDROP",
                "N1stAgent",
                "NavRAT",
                "Nokki",
                "Oceansalt",
                "POORAIM",
                "PoohMilk",
                "PoohMilk Loader",
                "RICECURRY",
                "RUHAPPY",
                "RokRAT",
                "SHUTTERSPEED",
                "SLOWDRIFT",
                "SOUNDWAVE",
                "SYSCON",
                "Sanny",
                "ScarCruft",
                "StarCruft",
                "Syscon",
                "VeilShell",
                "WINERACK",
                "ZUMKONG",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1666716492,
    "ts_updated_at": 1743041797,
    "ts_creation_date": 1430834385,
    "ts_modification_date": 1430834387,
    "files": {
        "pdf": "https://archive.orkl.eu/649457e4c53a882d29845bd545a5fded554684ad.pdf",
        "text": "https://archive.orkl.eu/649457e4c53a882d29845bd545a5fded554684ad.txt",
        "img": "https://archive.orkl.eu/649457e4c53a882d29845bd545a5fded554684ad.jpg"
    }
}