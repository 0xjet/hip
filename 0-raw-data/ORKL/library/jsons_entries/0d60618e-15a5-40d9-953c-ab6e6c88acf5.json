{
    "id": "0d60618e-15a5-40d9-953c-ab6e6c88acf5",
    "created_at": "2023-01-12T15:03:47.120589Z",
    "updated_at": "2025-03-27T02:16:17.005296Z",
    "deleted_at": null,
    "sha1_hash": "a9fe1ee09dea9f6a707bcff3a0ed10f838df7d96",
    "title": "2022-04-04 - Spring4Shell (CVE-2022-22965)- details and mitigations",
    "authors": "",
    "file_creation_date": "2022-05-27T19:02:34Z",
    "file_modification_date": "2022-05-27T19:02:34Z",
    "file_size": 650091,
    "plain_text": "# Spring4Shell (CVE-2022-22965): details and mitigations\n\n**securelist.com/spring4shell-cve-2022-22965/106239/**\n\n[Incidents](https://securelist.com/category/incidents/)\n\n[Incidents](https://securelist.com/category/incidents/)\n\n04 Apr 2022\n\nminute read\n\n\n-----\n\nAuthors\n\nAMR\n\nLast week researchers found the critical vulnerability CVE-2022-22965 in Spring – the open\nsource Java framework. Using the vulnerability, an attacker can execute arbitrary code on a\nremote web server, which makes CVE-2022-22965 a critical threat, given the Spring\nframework’s popularity. By analogy with the [infamous Log4Shell threat, the vulnerability was](https://securelist.com/cve-2021-44228-vulnerability-in-apache-log4j-library/105210/)\nnamed Spring4Shell.\n\n## CVE-2022-22965 and CVE-2022-22963: technical details\n\nCVE-2022-22965 (Spring4Shell, SpringShell) is a vulnerability in the Spring Framework that\nuses data binding functionality to bind data stored within an HTTP request to certain objects\nused by an application. The bug exists in the getCachedIntrospectionResults method, which\ncan be used to gain unauthorized access to such objects by passing their class names via\nan HTTP request. It creates the risks of data leakage and remote code execution when\nspecial object classes are used. This vulnerability is similar to the long-closed CVE-20101622, where class name checks were added as a fix so that the name did not match\n_classLoader or protectionDomain. However, in a newer version of JDK an alternative method_\nexists for such exploitation, for example, through Java 9 Platform Module System\nfunctionality.\n\n\n-----\n\nSo an attacker can overwrite the Tomcat logging configuration and then upload a JSP web\nshell to execute arbitrary commands on a server running a vulnerable version of the\nframework.\n\nA vulnerable configuration consists of:\n\nJDK version 9+\nApache Tomcat for serving the application\nSpring Framework versions 5.3.0 to 5.3.17 and 5.2.0 to 5.2.19 and below\napplication built as a WAR file\n\nCVE-2022-22963 is a vulnerability in the routing functionality of Spring Cloud Function that\nallows code injection through Spring Expression Language (SpEL) by adding a special\n_spring.cloud.function.routing-expression header to an HTTP request. SpEL is a special_\nexpression language created for Spring Framework that supports queries and object graph\nmanagement at runtime. This vulnerability can also be used for remote code execution.\n\nA vulnerable configuration consists of:\n\nSpring Cloud Function 3.1.6, 3.2.2 and older versions\n\n## Mitigations for Spring vulnerabilities exploitation\n\n[CVE-2022-22965 is fixed in 2.6.6; see the Spring blog for details.](https://spring.io/blog/2022/03/31/spring-boot-2-6-6-available-now)\n\nTo fix CVE-2022-22963, you also need to install the new Spring Cloud Function versions;\nsee the [VMware website for details.](https://tanzu.vmware.com/security/cve-2022-22963)\n\nTo detect exploitation attempts, ensure that Advanced Exploit Prevention and Network Attack\nBlocker features are enabled. Some techniques used during exploitation can be seen in\nother exploits that we detect, which is why the verdict names can differ.\n\n## Indicators of Compromise\n\n**Verdicts**\nPDM:Exploit.Win32.Generic\nUMIDS:Intrusion.Generic.Agent.gen\nIntrusion.Generic.CVE-*.*\n\n**MD5 hashes of the exploits**\n7e46801dd171bb5bf1771df1239d760c – shell.jsp (CVE-2022-22965)\n3de4e174c2c8612aebb3adef10027679 – exploit.py (CVE-2022-22965)\n\n**Detection of the exploitation process with Kaspersky EDR Expert**\n\n\n-----\n\n[Java](https://securelist.com/tag/java/)\n[Malware Descriptions](https://securelist.com/tag/malware-descriptions/)\n[Vulnerabilities and exploits](https://securelist.com/tag/vulnerabilities-and-exploits/)\n\nAuthors\n\nAMR\n\nSpring4Shell (CVE-2022-22965): details and mitigations\n\nYour email address will not be published. Required fields are marked *\n\nTable of Contents\n\nCVE-2022-22965 and CVE-2022-22963: technical details\nMitigations for Spring vulnerabilities exploitation\nIndicators of Compromise\n\nGReAT webinars\n\n13 May 2021, 1:00pm\n\n\n-----\n\n### GReAT Ideas. Balalaika Edition\n\n26 Feb 2021, 12:00pm\n17 Jun 2020, 1:00pm\n26 Aug 2020, 2:00pm\n22 Jul 2020, 2:00pm\nSubscribe to our weekly e-mails\n\nThe hottest research right in your inbox\n\nReports\n\n### APT trends report Q1 2022\n\n\n-----\n\nThis is our latest summary of advanced persistent threat (APT) activity, focusing on events\nthat we observed during Q1 2022.\n\n### Lazarus Trojanized DeFi app for delivering malware\n\nWe recently discovered a Trojanized DeFi application that was compiled in November 2021.\nThis application contains a legitimate program called DeFi Wallet that saves and manages a\ncryptocurrency wallet, but also implants a full-featured backdoor.\n\n### MoonBounce: the dark side of UEFI firmware\n\nAt the end of 2021, we inspected UEFI firmware that was tampered with to embed a\nmalicious code we dub MoonBounce. In this report we describe how the MoonBounce\nimplant works and how it is connected to APT41.\n\n### The BlueNoroff cryptocurrency hunt is still on\n\nIt appears that BlueNoroff shifted focus from hitting banks and SWIFT-connected servers to\nsolely cryptocurrency businesses as the main source of the group’s illegal income.\n\nSubscribe to our weekly e-mails\n\n\n-----\n\nThe hottest research right in your inbox\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-04-04 - Spring4Shell (CVE-2022-22965)- details and mitigations.pdf"
    ],
    "report_names": [
        "2022-04-04 - Spring4Shell (CVE-2022-22965)- details and mitigations.pdf"
    ],
    "threat_actors": [
        {
            "id": "1bdb91cf-f1a6-4bed-8cfa-c7ea1b635ebd",
            "created_at": "2022-10-25T16:07:23.766784Z",
            "updated_at": "2025-03-27T02:02:09.971636Z",
            "deleted_at": null,
            "main_name": "Bluenoroff",
            "aliases": [
                "APT 38",
                "ATK 117",
                "Alluring Pisces",
                "Black Alicanto",
                "Bluenoroff",
                "CTG-6459",
                "Copernicium",
                "Nickel Gladstone",
                "Sapphire Sleet",
                "Selective Pisces",
                "Stardust Chollima",
                "T-APT-15",
                "TA444",
                "TAG-71",
                "TEMP.Hermit"
            ],
            "source_name": "ETDA:Bluenoroff",
            "tools": [],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "f426f0a0-faef-4c0e-bcf8-88974116c9d0",
            "created_at": "2022-10-25T15:50:23.240383Z",
            "updated_at": "2025-03-27T02:00:55.404232Z",
            "deleted_at": null,
            "main_name": "APT38",
            "aliases": [
                "APT38",
                "NICKEL GLADSTONE",
                "BeagleBoyz",
                "Bluenoroff",
                "Stardust Chollima",
                "Sapphire Sleet",
                "COPERNICIUM"
            ],
            "source_name": "MITRE:APT38",
            "tools": [
                "ECCENTRICBANDWAGON",
                "HOPLIGHT",
                "Mimikatz",
                "KillDisk",
                "DarkComet"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "8bc1a044-a23b-4904-903c-13f463605cb3",
            "created_at": "2024-05-01T02:03:08.136237Z",
            "updated_at": "2025-03-27T02:05:17.415795Z",
            "deleted_at": null,
            "main_name": "NICKEL GLADSTONE",
            "aliases": [
                "Bluenoroff ",
                "CTG-6459 ",
                "Citrine Sleet ",
                "HIDDEN COBRA ",
                "Lazarus Group",
                "Sapphire Sleet ",
                "Stardust Chollima ",
                "APT38 "
            ],
            "source_name": "Secureworks:NICKEL GLADSTONE",
            "tools": [
                " Bankshot",
                " CATCH22",
                " CCGC_Proxy",
                " Cur1Agent",
                " Ratankba",
                " Server_TrafficForwarder",
                " Wcry",
                "AlphaNC"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "4c68ccd0-caba-4189-9ead-86ac4c2d9b70",
            "created_at": "2024-05-01T02:03:07.930196Z",
            "updated_at": "2025-03-27T02:05:17.251237Z",
            "deleted_at": null,
            "main_name": "BRONZE ATLAS",
            "aliases": [
                "Axiom",
                "BARIUM ",
                "Blackfly ",
                "CTG-2633",
                "GREF",
                "Group 72 ",
                "Red Kelpie ",
                "TG-2633 ",
                "Wicked Panda ",
                "Winnti",
                "APT41 "
            ],
            "source_name": "Secureworks:BRONZE ATLAS",
            "tools": [
                " CCleaner v5.33 backdoor",
                " ChinaChopper",
                " Cobalt Strike",
                " Dicey MSDN",
                " ForkPlayground",
                " HUC Proxy Malware (Htran)",
                " Mimikatz",
                " PipeMon",
                " PlugX",
                " PortReuse",
                " Powershell Empire",
                " RCMD",
                " RbDoor",
                " SPEEDBOAT",
                " ShadowPad",
                " Sidewalk",
                " Speculoos",
                " TeamViewer",
                " Winnkit",
                " Winnti",
                " reg save",
                " vssadmin",
                "Acehash"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "a2b92056-9378-4749-926b-7e10c4500dac",
            "created_at": "2023-01-06T13:46:38.430595Z",
            "updated_at": "2025-03-27T02:00:02.831633Z",
            "deleted_at": null,
            "main_name": "Lazarus Group",
            "aliases": [
                "Operation DarkSeoul",
                "APT38",
                "ATK117",
                "DEV-1222",
                "G0032",
                "APT 38",
                "Stardust Chollima",
                "APT-C-26",
                "ATK3",
                "Diamond Sleet",
                "Hidden Cobra",
                "Unit 121",
                "Subgroup: Bluenoroff",
                "NICKEL GLADSTONE",
                "DEV-0139",
                "Andariel",
                "Operation Troy",
                "COVELLITE",
                "TA404",
                "Lazarus group",
                "Dark Seoul",
                "G0082",
                "NewRomanic Cyber Army Team",
                "Bluenoroff",
                "Appleworm",
                "Nickel Academy",
                "COPERNICIUM",
                "Hastati Group",
                "Bureau 121",
                "Operation AppleJeus",
                "Whois Hacking Team",
                "Citrine Sleet",
                "Sapphire Sleet",
                "Group 77",
                "Labyrinth Chollima",
                "Operation GhostSecret",
                "BeagleBoyz"
            ],
            "source_name": "MISPGALAXY:Lazarus Group",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "4d5f939b-aea9-4a0e-8bff-003079a261ea",
            "created_at": "2023-01-06T13:46:39.04841Z",
            "updated_at": "2025-03-27T02:00:02.985296Z",
            "deleted_at": null,
            "main_name": "APT41",
            "aliases": [
                "G0096",
                "Grayfly",
                "BARIUM",
                "BRONZE ATLAS",
                "BRONZE EXPORT",
                "Red Kelpie",
                "HOODOO",
                "Brass Typhoon",
                "TA415",
                "WICKED SPIDER",
                "WICKED PANDA",
                "G0044",
                "Earth Baku"
            ],
            "source_name": "MISPGALAXY:APT41",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "e698860d-57e8-4780-b7c3-41e5a8314ec0",
            "created_at": "2022-10-25T15:50:23.287929Z",
            "updated_at": "2025-03-27T02:00:55.43005Z",
            "deleted_at": null,
            "main_name": "APT41",
            "aliases": [
                "APT41",
                "Wicked Panda",
                "Brass Typhoon",
                "BARIUM"
            ],
            "source_name": "MITRE:APT41",
            "tools": [
                "ASPXSpy",
                "BITSAdmin",
                "PlugX",
                "Impacket",
                "gh0st RAT",
                "netstat",
                "PowerSploit",
                "ZxShell",
                "KEYPLUG",
                "ipconfig",
                "sqlmap",
                "China Chopper",
                "ShadowPad",
                "MESSAGETAP",
                "Mimikatz",
                "certutil",
                "njRAT",
                "Cobalt Strike",
                "pwdump",
                "BLACKCOFFEE",
                "ROCKBOOT",
                "dsquery",
                "Winnti for Linux",
                "DUSTTRAP",
                "Derusbi",
                "ftp"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1673535827,
    "ts_updated_at": 1743041777,
    "ts_creation_date": 1653678154,
    "ts_modification_date": 1653678154,
    "files": {
        "pdf": "https://archive.orkl.eu/a9fe1ee09dea9f6a707bcff3a0ed10f838df7d96.pdf",
        "text": "https://archive.orkl.eu/a9fe1ee09dea9f6a707bcff3a0ed10f838df7d96.txt",
        "img": "https://archive.orkl.eu/a9fe1ee09dea9f6a707bcff3a0ed10f838df7d96.jpg"
    }
}