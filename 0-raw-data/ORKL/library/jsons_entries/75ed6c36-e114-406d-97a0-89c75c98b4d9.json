{
    "id": "75ed6c36-e114-406d-97a0-89c75c98b4d9",
    "created_at": "2023-01-12T14:58:54.629916Z",
    "updated_at": "2025-03-27T02:08:36.025739Z",
    "deleted_at": null,
    "sha1_hash": "097cac3c639bce29c6b0699c526eeb9d8d40b041",
    "title": "2022-01-17 - The Chaos Ransomware Can Be Ravaging",
    "authors": "",
    "file_creation_date": "2022-05-28T15:38:17Z",
    "file_modification_date": "2022-05-28T15:38:17Z",
    "file_size": 575970,
    "plain_text": "# The Chaos Ransomware Can Be Ravaging\n\n**[blog.qualys.com/vulnerabilities-threat-research/2022/01/17/the-chaos-ransomware-can-be-ravaging](https://blog.qualys.com/vulnerabilities-threat-research/2022/01/17/the-chaos-ransomware-can-be-ravaging)**\n\nBajrang Mane January 17, 2022\n\n_The Qualys Research Team has observed a new version of Chaos ransomware in_\n_development. This blog reviews the malware’s updated functionality as well as its ongoing_\n_evolution._\n\nA ransomware builder called Chaos is still actively under development. The fourth version\nhas recently been observed being improved, as identified in underground forums as well as\ncode leaks in other community sites.\n\nWhile the builder bills itself as ransomware, its functions are more like wiper malware.\nTraditional ransomware is used by attackers to encrypt the victim’s file data and then\ndemand a ransom in exchange for its recovery. In recent years widespread examples of\nransomware have dominated the threat landscape – and the news headlines – with one\nmemorable example being DarkSide Ransomware.\n\nUnlike most ransomware, wipers overwrite or remove the data from the victim’s systems. An\nexample of a well-known wiper is Shamoon/DistTrack, which was observed being used to\ntarget Industrial Control Systems, steal information, and then destroy the victim’s systems.\n\nIn our analysis we have seen Chaos encrypting files of less than 2 MB but overwriting larger\nfiles with random bytes. Because of this behavior, we believe it is more accurate to call it a\nwiper.\n\n\n-----\n\n## A History of Chaos\n\nA [Trend Micro provides a summary analysis of the development of Chaos, which was first](https://www.trendmicro.com/en_us/research/21/h/chaos-ransomware-a-dangerous-proof-of-concept.html)\ndiscovered in June 2021. Since its inception four versions have been observed, the latest\niteration in August 2021. Even though it has not yet been used for an actual attack, it could\nbe highly disastrous if used in the future.\n\nThe four versions of Chaos described by TrendMicro are:\n\nVersion 1.0; released on 9 June 2021: Replaces file data with random bytes and then\nencodes it with Base-64. From the outset, it has worming capability, distributing itself to\nall drives.\nVersion 2.0; released on 17 June 2021: Administrative privileges are added, along with\nthe ability to delete all of the shadow copies.\nVersion 3.0; released on 5 July 2021: Includes encryption of files with AES/RSA\nalgorithms, but only files with a size less than 1MB.\nVersion 4.0; released on 5 August 2021: This latest version has put a limit of 2MB on\nthe files that will be encrypted.\n\nLooking at all these versions, we can infer that Chaos remains an in-development\nransomware builder that may soon be offered in an underground market on the Dark Web\nlike other well-known ransomware. There is little doubt that attackers will continue\ndeveloping its capabilities – potentially based on feedback from other forum members where\nit is being staged.\n\n## Technical Details\n\nIn the latest version of Chaos, the new extension given to encrypted/affected files is\n_CRYPTEDPAY, as the screenshot below reveals:_\n\n\n-----\n\nFig.1 Encrypted files\nHere is a list of extensions targeted by this malware:\n\nFig.2 Extensions supported\nFirst, it checks for any other instance already in execution. If yes, then the malware will\nterminate itself.\n\nIf not already running, it drops a copy at the below location and then executes itself.\n\n```\n“C:\\Users\\\\AppData\\Roaming\\svchost.exe”\n\n```\n\nNext, it terminates the current process.\n\nThen the newly created process (i.e svchost.exe) searches for all the drives present and\nstarts encrypting them. It performs encryption only if the extension of the file is present in the\nlist shown above.\n\nAs the screen below illustrates, it then checks the file size. Files are encrypted with AES only\nif the file size is less than ~2MB. The key used for AES encryption is randomly generated for\neach file, and the key is then encrypted with RSA.\n\n\n-----\n\nFig.3 Code for file size check and encryption\nThis RSA-encrypted key is then encoded in Base-64 and kept at the start of the file with the\ntags `<Encryptedkey>…<Encryptedkey> followed by the encrypted file data.`\n\nFig.4 Random bytes generation and encoding\n\n\n-----\n\nIf the file size is greater than ~2MB and less than ~200MB, random bytes of the length\n(filesize/4) are generated and written in the encrypted file in Base-64 encoded format. If the\nfile size is greater than ~200MB, random bytes with the length greater than ~200MB and less\nthan ~300MB are generated and kept in the file in Base-64 format. This makes these files\ncompletely useless.\n\nThe attacker then has Chaos drop the ransom note, in each encrypted folder as shown in\nthis screenshot:\n\nFig.5 Ransom note\nThe victim’s wallpaper is also changed to:\n\n\n-----\n\nFig.6 Desktop wallpaper set\nTo the victim’s dismay, Chaos takes steps to make recovery impossible by deleting shadow\ncopies, backup catalog, and disabling windows recovery mode by executing the following\ncommands:\n\n```\n“vssadmin delete shadows /all /quiet & wmic shadowcopy delete”\n\n```\n```\n“bcdedit /set {default} bootstatuspolicy ignoreallfailures & bcdedit /set\n{default} recoveryenabled no”\n\n```\n```\n“wbadmin delete catalog -quiet”\n\n```\n\nGiven the rapid and ongoing development of Chaos ransomware’s capabilities, it’s very clear\nthat if this ransomware ever used in cyber-attack, the victims may not be able to recover their\nimportant data. Security professionals must take the utmost precaution to protect their\norganizations from such destructive attackers.\n\n**TTP Map:**\n\n**Discovery** **Collection** **Impact**\n\n\nFile and Directory Discovery\n(T1083)\n\n\nData from Local System\n(T1005)\n\n\nData Encrypted for impact\n(T1486)\n\n\n**Mitigation or Additional Important Safety Measures:**\n\nNetwork\n\nKeep strong and unique passwords for login accounts.\n\n\n-----\n\nDisable RDP if not used. If required change the RDP port to a non-standard port.\nConfigure firewall in the following way,\n\nDeny access to External IPs trying to connect important ports (in this case RDP\nport 3389)\nAllow access to only IPs which are under your control.\nUse VPN to access the network, instead of exposing RDP to the Internet. Possibility to\nimplement Two Factor Authentication (2FA).\nSet lockout policy which hinders credentials guessing.\nCreate a separate network folder for each user when managing access to shared\nnetwork folders.\n\nTake regular data backup\n\nProtect systems from ransomware by periodically backing up important files regularly\nand keep a recent backup copy offline. Encrypt your backup.\nIf your computer gets infected with ransomware, your files can be restored from the\noffline backup once the malware has been removed.\nAlways use a combination of online and offline backup.\nDo not keep offline backups connected to your system as this data could be encrypted\nwhen ransomware strike.\n\nKeep software updated\n\nAlways keep your security software (antivirus, firewall, etc.) up to date to protect your\ncomputer from new variants of malware.\nRegularly patch and update applications, software, and operating systems to address\nany exploitable software vulnerabilities.\nDo not download cracked/pirated software as they risk backdoor entry for malware into\nyour computer.\nAvoid downloading software from untrusted P2P or torrent sites. In most cases, they\nare malicious software.\n\nHaving minimum required privileges\n\nDo not assign Administrator privileges to users. Most importantly, do not stay logged in as an\nadministrator unless it is strictly necessary. Also, avoid browsing, opening documents, or\nother regular work activities while logged in as an administrator.\n\nIndicators of Compromise (IOCs)\n```\n1ba5ab55b7212ba92a9402677e30e45f12d98a98f78cdcf5864a67d6c264d053\nb103fc649787eb1f6121df8174d0f16aaac736fb53f5f078d312871189285956\n17557537bcb33f2a0ad3ff0caf7b084e63468144b2e6cb8180f6598adfdc5c9a\n17557537bcb33f2a0ad3ff0caf7b084e63468144b2e6cb8180f6598adfdc5c9a\n\n## Contributor\n\n```\n**Ganesh Vetal, Senior Threat Research Engineer, Qualys**\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-01-17 - The Chaos Ransomware Can Be Ravaging.pdf"
    ],
    "report_names": [
        "2022-01-17 - The Chaos Ransomware Can Be Ravaging.pdf"
    ],
    "threat_actors": [
        {
            "id": "77b28afd-8187-4917-a453-1d5a279cb5e4",
            "created_at": "2022-10-25T15:50:23.768278Z",
            "updated_at": "2025-03-27T02:00:55.5423Z",
            "deleted_at": null,
            "main_name": "Inception",
            "aliases": [
                "Inception Framework",
                "Cloud Atlas"
            ],
            "source_name": "MITRE:Inception",
            "tools": [
                "PowerShower",
                "VBShower",
                "LaZagne"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1673535534,
    "ts_updated_at": 1743041316,
    "ts_creation_date": 1653752297,
    "ts_modification_date": 1653752297,
    "files": {
        "pdf": "https://archive.orkl.eu/097cac3c639bce29c6b0699c526eeb9d8d40b041.pdf",
        "text": "https://archive.orkl.eu/097cac3c639bce29c6b0699c526eeb9d8d40b041.txt",
        "img": "https://archive.orkl.eu/097cac3c639bce29c6b0699c526eeb9d8d40b041.jpg"
    }
}