{
    "id": "ccfebb4f-0e96-4274-af08-3786b15545e1",
    "created_at": "2022-10-25T16:48:16.913953Z",
    "updated_at": "2025-03-27T02:16:26.222525Z",
    "deleted_at": null,
    "sha1_hash": "7ad7b830384ad8e252c31e8a73573923a7cc15f5",
    "title": "",
    "authors": "",
    "file_creation_date": "2022-04-14T10:23:29Z",
    "file_modification_date": "2022-04-14T10:23:29Z",
    "file_size": 2194045,
    "plain_text": "# PYSA (Mespinoza) In-Depth Analysis\n\n\n-----\n\n### Contents\n\n**References** **2**\n\n**1** **Introduction** **3**\n\n**2** **Executive Summary** **4**\n\n**3** **Technical Analysis** **5**\n3.1 Public Leak Server . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 5\n3.1.1 Git Repository Analysis . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 6\n3.1.2 De-anonymizing TOR Hidden Service . . . . . . . . . . . . . . . . . . . . . . 7\n3.2 Leak Management Interface . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 9\n3.2.1 Development Activity . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 10\n3.2.2 Source Code Analysis . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 11\n3.2.3 Full-text Search Interface . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 12\n3.2.4 Infrastructure . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 14\n3.2.5 Encrypted Cloud Storage . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 15\n3.2.6 Auto-GIF Generation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 16\n3.2.7 Data Exfiltration via SMB Links . . . . . . . . . . . . . . . . . . . . . . . . . . 17\n3.2.8 Users . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 18\n3.3 Ransomware Software . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 19\n3.3.1 Encryption . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 19\n3.3.2 Decryption . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 23\n\n**4** **Statistics and Observations** **24**\n4.1 Victim Statistics . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 24\n4.2 Threat Actor Activity . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 24\n4.3 Author Profiling and Linguistic Evidence . . . . . . . . . . . . . . . . . . . . . . . . . 25\n4.3.1 Grammaticality . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 26\n4.3.2 Unnatural Statements . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 26\n4.3.3 Syntax . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 27\n\n**5** **Conclusion** **28**\n\n**6** **IOC** **30**\n6.1 Leak Management Infrastructure . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 30\n6.2 Public Leak Servers . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 30\n\n2 / 32\n\nDISCLAIMER : This document and its contents shall be deemed as proprietary and privileged information of PRODAFT and shall\n\nbe subjected to articles and provisions that have been stipulated in the General Data Protection Regulation and Personal\n\nData Protection Law No. 6698. It shall be noted that PRODAFT provides this information “as is” according to its findings, without\n\nproviding any legally applicable warranty regarding completeness or accuracy of the contents Therefore neither this report\n\n\n-----\n\n|Reference Number|CH-2022041101|\n|---|---|\n|Prepared By|PTI Team|\n|Investigation Date|25.09.2020 - 15.01.2022|\n|Initial Report Date|27.09.2020|\n|Last Update|11.04.2022|\n\n\n### 1 Introduction\n\nThe group behind PYSA ransomware has earned notoriety for targeting government\nagencies, educational institutions, and the healthcare sector. The group is known to\ncarefully research high-value targets before launching its attacks, compromising enterprise\nsystems and forcing organizations to pay large ransoms to restore their data. They are listed\nas one of the most advanced ransomware groups that carry out their operations off the radar.\n\nThe PRODAFT Threat Intelligence team detected and gained visibility into PYSA’s ransomware\ninfrastructure and analyzed its findings to gain insight into how the criminal operation works.\nThis report contains some of the latest information on how this destructive cybercriminal\nsyndicate operates and provides security professionals with crucial insight into detecting\nand mitigating the risk of attacks like PYSA’s. It also contains surprising information about the\nsophistication of PYSA’s development cycle and its dedication to providing threat actors\nwith new features and functionalities.\n\nPYSA is a ransomware variant related to the well-known Mespinoza ransomware. Threat\nintelligence professionals widely believe that the same group of individuals are behind both\ntechnologies. The PTI team has successfully gained visibility into many parts of the group’s\nransomware infrastructure, including its public leak server and its internal management\npanel. These insights will help high-value government, education, and healthcare targets\nprotect their systems from attacks that rely on PYSA’s techniques and technologies.\n\nWe started investigating PYSA group around September 2020. Our analysis lasted for\n16-months to identify every possible detail of the infrastructure used by the group. PYSA\nservers were taken offline around Jan-Feb 2022. Reports made public by our PTI team go\nthrough careful phases before the release. We are publishing this report only now to support\nother critical sectors to prepare for similar attacks in the future and provide insight into the\nmethods used by the crime gang.\n\n\nPlease note that this report has two versions. The ”Private Release” is provided to\nlaw enforcement agencies, applicable CERTS / CSIRTS, and members of our U.S.T.A.\nThreat Intel Platform (with appropriate annotations and reductions). Likewise, the\n_”Public Release” is publicly disseminated for the purpose of advancing the global fight_\nagainst high-end threat actors and APTs.\n\n\n3 / 32\n\nDISCLAIMER : This document and its contents shall be deemed as proprietary and privileged information of PRODAFT and shall\n\nbe subjected to articles and provisions that have been stipulated in the General Data Protection Regulation and Personal\n\nData Protection Law No. 6698. It shall be noted that PRODAFT provides this information “as is” according to its findings, without\n\nproviding any legally applicable warranty regarding completeness or accuracy of the contents Therefore neither this report\n\n\n-----\n\n### 2 Executive Summary\n\nThis report contains threat intelligence insight into how the cybercriminal syndicate\nbehind PYSA and Mespinoza operate. The PRODAFT Threat Intelligence team has gathered\nthis data by detecting and investigating systems used by PYSA threat actors.\n\nDespite a generally competent development approach, PYSA threat actors made\noperational security mistakes that exposed some elements of their infrastructure to our\nthreat intelligence team. We capitalized on these mistakes to research the group and\npublish highly sensitive data on their technologies and internal operations.\n\nBoth PYSA and Mespinoza first appeared in late 2019. PYSA appears to be the successor to\nMespinoza, and benefits from a professional development cycle that provides the group\nwith new functionalities on a regular basis. Our team has identified a five-stage cycle\nshowcasing PYSA activities starting from August 2020 :\n\n\n**18.09.2020**\n\nInitial project development.\n\nAmazon account creation.\n\n\nStage 1 Stage 3\n\n\n**2021**\n\nFull-text search capabilities.\n\nSMB Relays / Proxies.\nStream encryption/decryption.\n\n\n**08.08.2020** Stage 2 **25.09.2020** Stage 4\n\n\n**13.01.2022**\n\nLast operator activity.\n\nEnd of development.\n\nServer termination.\n\n\nInitial commit for public leak site.\n\nPrimitive data handling.\n\nExternal storage.\n\n\nFirst production-ready release.\n\nActive development started.\n\n\n**Figure 1. Timeline of the PYSA’s activity.**\n\nThis timeline shows that PYSA threat actors contributed to the development of its capabilities\nperiodically for nearly two years. Some of the group’s most interesting developments (like\nfull-text search capabilities) coincide with periods of high-intensity activity when the group\nattacked up to 90 different victims per month. This data is shown in greater detail in the\nfollowing sections, which break down PYSA’s operations into its technical components and\noffer behind-the-scenes insight into how the ransomware group structured its organization.\n\n4 / 32\n\nDISCLAIMER : This document and its contents shall be deemed as proprietary and privileged information of PRODAFT and shall\n\nbe subjected to articles and provisions that have been stipulated in the General Data Protection Regulation and Personal\n\nData Protection Law No. 6698. It shall be noted that PRODAFT provides this information “as is” according to its findings, without\n\nproviding any legally applicable warranty regarding completeness or accuracy of the contents Therefore neither this report\n\n\n-----\n\n### 3 Technical Analysis\n\nThis section contains valuable information about the PYSA team’s technical capabilities,\nincluding its public server and management system. The public leak server is responsible\nfor hosting the victim data PYSA releases when its demands are not met. The notorious\nransomware gang’s management system brings new details on group operations to light.\n\nWhile the PTI team successfully gained visibility to many parts of PYSA’s infrastructure,\nsome elements of the group’s operational environment remain hidden. These are excellent\ncandidates for further research in the threat intelligence community. We encourage other\nresearchers to follow our tracks and discover more about PYSA’s inner workings. PRODAFT\nmaintains a CIN [1] program for TI companies to collaborate on complex cases. The details for\nthe program can be found on our webpage.\n\n#### 3.1 Public Leak Server\n\nIf PYSA victims refuse to comply with the group’s demands, the PYSA team publishes\nconfidential victim data on a public leak server (as shown in Figure 2). PYSA has deployed\nseveral hidden onion services to host this content :\n\n## • [na47pldl5eoqxt42.onion]\n • [wqmfzni2nvbbpk25.onion]\n • [pysa2bitc5ldeyfak4seeruqymqs4sj5wt5qkcq7aoyg4h2acqieywad.onion]\n\n**Figure 2. Public leak server of the PYSA.**\n\n[1. https://www.prodaft.com/partners/cin-network](https://www.prodaft.com/partners/cin-network)\n\n5 / 32\n\nDISCLAIMER : This document and its contents shall be deemed as proprietary and privileged information of PRODAFT and shall\n\nbe subjected to articles and provisions that have been stipulated in the General Data Protection Regulation and Personal\n\nData Protection Law No. 6698. It shall be noted that PRODAFT provides this information “as is” according to its findings, without\n\nproviding any legally applicable warranty regarding completeness or accuracy of the contents Therefore neither this report\n\n\n-----\n\n**3.1.1** **Git Repository Analysis**\n\nOne of our investigation’s most important findings is a publicly available .git folder\nmanaged by PYSA operators. This is an obvious operational security mistake that is\nnonetheless common among cybercriminals. Our team found sufficient evidence to show\nthat this public folder is not an intentional decoy, but a genuine tool forgotten by a careless\nPYSA team member.\n\nAnyone can access the forgotten Git folder’s URL and extract the files that reside in the\nrepository to verify our findings. We encourage security researchers to use GitTools [2] or\nsimilar software to access this folder and review the data. The PTI team was also able to\nobtain the commit history associated with the author’s account. For the sake of simplicity,\nwe have arranged this data in Table 1.\n\n**Date** **Author** **Comment**\nSun Dec 27 23:06:01 2020 UTC+1 dodo@mail.pcc timer removed\nSat Dec 26 02:42:20 2020 UTC+1 dodo@mail.pcc added timer\nSat Nov 14 01:41:13 2020 UTC+1 dodo@mail.pcc announement fix\nSat Nov 14 00:37:18 2020 UTC+1 dodo@mail.pcc announcement\nWed Sep 16 13:14:26 2020 UTC+2 dodo@mail.pcc Teka && 2\nSun Sep 13 11:21:32 2020 UTC+2 dodo@mail.pcc Assured - CFC\nFri Sep 11 11:55:37 2020 UTC+2 dodo@mail.pcc Monty-Lindenwold added\nSun Sep 6 00:59:12 2020 UTC+2 dodo@mail.pcc Menu fix\nSat Sep 5 18:11:26 2020 UTC+2 dodo@mail.pcc IVCC, WSMIND, Alliance\nFri Aug 28 15:18:08 2020 UTC+2 dodo@mail.pcc Added Marselle and 2 other;\ndates added\nWed Aug 19 16:06:13 2020 UTC+2 dodo@mail.pcc MCLINC and XPress added\nSat Aug 8 10:14:59 2020 UTC+2 dodo@mail.pcc Upload script added\nSat Aug 8 09:56:19 2020 UTC+2 dodo@mail.pcc OrthoAtlanta and Q3 added\nSat Aug 8 09:22:56 2020 UTC+2 root@server.domain.comInitial\n\n**Table 1. Excerpt of commit history extracted from the git repository.**\n\nUpon analysis, the PTI team identified the project author as dodo@mail.pcc. It’s clear\nthat this user invented an invalid domain name, which probably represents the hostname\nassigned to the user’s computer. However, there is additional evidence that provides some\ninsight into internal PYSA operations.\n\nFor example, the time zone automatically changes from UTC+2 to UTC+1 between the 16th\nof September and the 14th of November. This correlates to daylight savings time, which\nsuggests the author is based in a country that observes daylight savings.\n\n[2. https://github.com/internetwache/GitTools](https://github.com/internetwache/GitTools)\n\n6 / 32\n\nDISCLAIMER : This document and its contents shall be deemed as proprietary and privileged information of PRODAFT and shall\n\nbe subjected to articles and provisions that have been stipulated in the General Data Protection Regulation and Personal\n\nData Protection Law No. 6698. It shall be noted that PRODAFT provides this information “as is” according to its findings, without\n\nproviding any legally applicable warranty regarding completeness or accuracy of the contents Therefore neither this report\n\n|Date Sun Dec 27 23:06:01 2020 UTC+1|Author dodo@mail.pcc|Comment timer removed|\n|---|---|---|\n|Sat Dec 26 02:42:20 2020 UTC+1|dodo@mail.pcc|added timer|\n|Sat Nov 14 01:41:13 2020 UTC+1|dodo@mail.pcc|announement fix|\n|Sat Nov 14 00:37:18 2020 UTC+1|dodo@mail.pcc|announcement|\n|Wed Sep 16 13:14:26 2020 UTC+2|dodo@mail.pcc|Teka && 2|\n|Sun Sep 13 11:21:32 2020 UTC+2|dodo@mail.pcc|Assured - CFC|\n|Fri Sep 11 11:55:37 2020 UTC+2|dodo@mail.pcc|Monty-Lindenwold added|\n|Sun Sep 6 00:59:12 2020 UTC+2|dodo@mail.pcc|Menu fix|\n|Sat Sep 5 18:11:26 2020 UTC+2|dodo@mail.pcc|IVCC, WSMIND, Alliance|\n|Fri Aug 28 15:18:08 2020 UTC+2|dodo@mail.pcc|Added Marselle and 2 other; dates added|\n|Wed Aug 19 16:06:13 2020 UTC+2|dodo@mail.pcc|MCLINC and XPress added|\n|Sat Aug 8 10:14:59 2020 UTC+2|dodo@mail.pcc|Upload script added|\n|Sat Aug 8 09:56:19 2020 UTC+2|dodo@mail.pcc|OrthoAtlanta and Q3 added|\n|Sat Aug 8 09:22:56 2020 UTC+2|root@server.domain|.cIonmitial|\n\n\n-----\n\nTorify [3] allows users to run applications on Tor network without native support. As shown\nin Figure 3, it plays a crucial role in PYSA’s management panel and public leak website\noperations. While obviously convenient from a usability point of view, its use also carries\nimportant operational security implications.\n\n**Figure 3. Torify usage in the deployment script.**\n\n**3.1.2** **De-anonymizing TOR Hidden Service**\n\nTor hidden services operate behind the TOR network. They are only accessible through\ntheir unique ”.onion” links. The architecture of the TOR network makes monitoring traffic and\nidentifying the IP addresses running hidden services on the TOR network almost impossible.\n\nWhile the architecture of the TOR network represents a considerable challenge, we can\nsuccessfully identify these so-called hidden networks when threat actors make infrastructural\nand operational security mistakes.\n\nIn the case of PYSA, our team successfully benefited from the ransomware group’s operational\nsecurity mistakes and identified its hidden service on the TOR network. The hidden service\ncorrelates to a hosting provider (Snel.com B.V.) located in the Netherlands.\n\nTo detect ransomware activities and notify the relevant authorities, we have been actively\nmonitoring all related server migrations associated with PYSA assets since September 2020.\nTheir infrastructure includes hidden services, management panels, monitoring systems and a\ndevelopment environment, all of which apparently reside in a single data center (Snel.com\nB.V.). Table 2 shows the list of management servers identified by the PTI team.\n\n**IP** **Country** **ISP** **First Seen**\n193.34.167.230 Netherlands Snel.com B.V. September 2020\n193.34.166.92 Netherlands Snel.com B.V. December 2020\n193.34.167.240 Netherlands Snel.com B.V. July 2021\n193.34.166.181 Netherlands Snel.com B.V. November 2021\n193.34.166.189 Netherlands Snel.com B.V. November 2021\n193.34.166.214 Netherlands Snel.com B.V. December 2021\n193.34.166.165 Netherlands Snel.com B.V. December 2021\n\n**Table 2. Management servers of the PYSA.**\n\n[3. https://gitlab.torproject.org/legacy/trac/-/wikis/doc/TorifyHOWTO](https://gitlab.torproject.org/legacy/trac/-/wikis/doc/TorifyHOWTO)\n\n7 / 32\n\nDISCLAIMER : This document and its contents shall be deemed as proprietary and privileged information of PRODAFT and shall\n\nbe subjected to articles and provisions that have been stipulated in the General Data Protection Regulation and Personal\n\nData Protection Law No. 6698. It shall be noted that PRODAFT provides this information “as is” according to its findings, without\n\nproviding any legally applicable warranty regarding completeness or accuracy of the contents Therefore neither this report\n\n|IP|Country|ISP|First Seen|\n|---|---|---|---|\n|193.34.167.230|Netherlands|Snel.com B.V.|September 2020|\n|193.34.166.92|Netherlands|Snel.com B.V.|December 2020|\n|193.34.167.240|Netherlands|Snel.com B.V.|July 2021|\n|193.34.166.181|Netherlands|Snel.com B.V.|November 2021|\n|193.34.166.189|Netherlands|Snel.com B.V.|November 2021|\n|193.34.166.214|Netherlands|Snel.com B.V.|December 2021|\n|193.34.166.165|Netherlands|Snel.com B.V.|December 2021|\n\n\n-----\n\n**Figure 4. Relationship between the hidden service and public IP address.**\n\nWe compared the unique URLs with package contents to produce additional evidence to\nsupport our findings. For example, the UUID value obtained from 193.34.166.92 is available as\na downloadable URL on the public leak server of the PYSA, as shown in Figure 4.\n\n8 / 32\n\nDISCLAIMER : This document and its contents shall be deemed as proprietary and privileged information of PRODAFT and shall\n\nbe subjected to articles and provisions that have been stipulated in the General Data Protection Regulation and Personal\n\nData Protection Law No. 6698. It shall be noted that PRODAFT provides this information “as is” according to its findings, without\n\nproviding any legally applicable warranty regarding completeness or accuracy of the contents Therefore neither this report\n\n\n-----\n\n#### 3.2 Leak Management Interface\n\nPYSA threat actors use a custom leak management system to quickly find confidential\ndocuments in the files exfiltrated from victims’ internal networks. The system (as shown in\nFigure 5) allows users to search for these files by extension, file name, and content.\n\n**Figure 5. Index page of the victim (project) management.**\n\nSince the beginning of our investigation, we observed numerous usability updates on PYSA’s\nsystems. This suggests that the group is supported by competent developers who apply\nmodern operational paradigms to the group’s development cycle.\n\nThis unexpected finding tells a different story about ransomware gangs than the one the\ncybersecurity industry is used to. It suggests a professional environment with well-organized\ndivision of responsibilities, rather than a loose network of semi-autonomous threat actors.\n\n9 / 32\n\nDISCLAIMER : This document and its contents shall be deemed as proprietary and privileged information of PRODAFT and shall\n\nbe subjected to articles and provisions that have been stipulated in the General Data Protection Regulation and Personal\n\nData Protection Law No. 6698. It shall be noted that PRODAFT provides this information “as is” according to its findings, without\n\nproviding any legally applicable warranty regarding completeness or accuracy of the contents Therefore neither this report\n\n\n-----\n\n**3.2.1** **Development Activity**\n\nThe PYSA team utilizes the Git [4] version control system to manage the management\npanel development processes. Figure 6 shows that they developed the system continuously,\ndespite occasional interruptions.\n\n**Figure 6. Development activity of the threat actors.**\n\nTable 3 shows the commit history extracted from the git repository of the management\nsystem. Closer inspection of the table shows the developer’s time zone and the date of the\nproject kickoff. The first commit occurred on September 25th, 2020, early in the morning on\nUS Central Time (UTC-6).\n\nTime zone data from this table does not correlate with the data in Table 1. A possible\nexplanation for this might be that the development team includes more than one person,\nwith individuals in multiple time zones responsible for managing different parts of the project.\n\n**Date** **Author** **Comment**\nSat Sep 26 00:02:24 2020 UTC-6 Your Name <you@example.com> view3\nSat Sep 26 00:00:57 2020 UTC-6 Your Name <you@example.com> view3\nFri Sep 25 23:59:50 2020 UTC-6 Your Name <you@example.com> view2\nFri Sep 25 23:57:53 2020 UTC-6 Your Name <you@example.com> view2\nFri Sep 25 23:56:17 2020 UTC-6 Your Name <you@example.com> view\nFri Sep 25 22:26:23 2020 UTC-6 Your Name <you@example.com> t\nFri Sep 25 21:31:13 2020 UTC-6 Your Name <you@example.com> x\nFri Sep 25 21:02:06 2020 UTC-6 Your Name <you@example.com> n\nFri Sep 25 20:59:10 2020 UTC-6 Your Name <you@example.com> p\nFri Sep 25 20:57:23 2020 UTC-6 Your Name <you@example.com> 2\nFri Sep 25 20:55:29 2020 UTC-6 Your Name <you@example.com> 1\nFri Sep 25 20:52:57 2020 UTC-6 Your Name <you@example.com> s\nFri Sep 25 20:51:43 2020 UTC-6 Your Name <you@example.com> add\nFri Sep 25 04:42:31 2020 UTC-6 Your Name <you@example.com> init\n\n**Table 3. Non-exhaustive list of commits extracted from the git repository.**\n\n[4. https://git-scm.com/](https://git-scm.com/)\n\n10 / 32\n\nDISCLAIMER : This document and its contents shall be deemed as proprietary and privileged information of PRODAFT and shall\n\nbe subjected to articles and provisions that have been stipulated in the General Data Protection Regulation and Personal\n\nData Protection Law No. 6698. It shall be noted that PRODAFT provides this information “as is” according to its findings, without\n\nproviding any legally applicable warranty regarding completeness or accuracy of the contents Therefore neither this report\n\n|Date Sat Sep 26 00:02:24 2020 UTC-6|Author Your Name <you@example.com>|Comment view3|\n|---|---|---|\n|Sat Sep 26 00:00:57 2020 UTC-6|Your Name <you@example.com>|view3|\n|Fri Sep 25 23:59:50 2020 UTC-6|Your Name <you@example.com>|view2|\n|Fri Sep 25 23:57:53 2020 UTC-6|Your Name <you@example.com>|view2|\n|Fri Sep 25 23:56:17 2020 UTC-6|Your Name <you@example.com>|view|\n|Fri Sep 25 22:26:23 2020 UTC-6|Your Name <you@example.com>|t|\n|Fri Sep 25 21:31:13 2020 UTC-6|Your Name <you@example.com>|x|\n|Fri Sep 25 21:02:06 2020 UTC-6|Your Name <you@example.com>|n|\n|Fri Sep 25 20:59:10 2020 UTC-6|Your Name <you@example.com>|p|\n|Fri Sep 25 20:57:23 2020 UTC-6|Your Name <you@example.com>|2|\n|Fri Sep 25 20:55:29 2020 UTC-6|Your Name <you@example.com>|1|\n|Fri Sep 25 20:52:57 2020 UTC-6|Your Name <you@example.com>|s|\n|Fri Sep 25 20:51:43 2020 UTC-6|Your Name <you@example.com>|add|\n|Fri Sep 25 04:42:31 2020 UTC-6|Your Name <you@example.com>|init|\n\n\n-----\n\n**3.2.2** **Source Code Analysis**\n\nThe PYSA’s management system is written in PHP 7.3.12, using the Laravel framework. The\nsystem uses the MariaDB database, Redis cache, and an Amazon Cloud environment, as\nshown in Figure 7. Moreover, we determined that the developers were using PHPStorm as their\nIDE after deep inspection of the Git repositories of the project. The app itself is apparently\nset to the Australia/Sydney time zone.\n\n**Figure 7. Environment variables of the management panel.**\n\nThe system includes several API endpoints to handle requests like public file download, SMB\nexplorer, full-text search interface, JSON feeds for tracking, auto-GIF generation, and more.\nFor the sake of simplicity, the table below shows a subset of the most relevant endpoints.\n\n**Endpoint** **Description**\n/upload-wekkmferokmsdderiuheoirhuiewiwnijnfrer Uploader index page.\n/uploader-zxczxczx Index page.\n/records List page of all the database records.\n/tree-df-dfdnnfpqowe-dsfdskwqehrw-sdfvdvdnkwker File list in tree format.\n/d2u039-8r-wh___efo389hfeos File list page.\n/uploader-zlist List all the items.\n/merge-qaszwerfeiun4i5yghydf Merge files.\n/smb-ero4tij5p9yhfgdejkr.t4irtueitdfbvcvrcf SMB explorer (viewer).\n/explorer-scan-awdfsdftjktdngjksdfd File explorer scan.\n/exportozirnosi-33388883333777-jisosei393 Export the file list.\n/archive-asdfvenrgdfgfd Archive JSON feed.\n/i-want-to-download-awesome-pysa-file/{uuid} Public file download.\n/gifhwdbhg4hugdkhfnksvdfetergtrwehfisuhew32r Generate animation for files.\n/analyze-keywords-ejkrgnekjns-sdbfr Analyze the files for full-text search.\n/asdfvenrgdfgfd-{id}.json Project JSON feed for tracking.\n\n**Table 4. Excerpt list of the endpoints.**\n\n11 / 32\n\nDISCLAIMER : This document and its contents shall be deemed as proprietary and privileged information of PRODAFT and shall\n\nbe subjected to articles and provisions that have been stipulated in the General Data Protection Regulation and Personal\n\nData Protection Law No. 6698. It shall be noted that PRODAFT provides this information “as is” according to its findings, without\n\nproviding any legally applicable warranty regarding completeness or accuracy of the contents Therefore neither this report\n\n|Endpoint|Description|\n|---|---|\n|/upload-wekkmferokmsdderiuheoirhuiewiwnijnfrer|Uploader index page.|\n|/uploader-zxczxczx|Index page.|\n|/records|List page of all the database records.|\n|/tree-df-dfdnnfpqowe-dsfdskwqehrw-sdfvdvdnkwker|File list in tree format.|\n|/d2u039-8r-wh___efo389hfeos|File list page.|\n|/uploader-zlist|List all the items.|\n|/merge-qaszwerfeiun4i5yghydf|Merge files.|\n|/smb-ero4tij5p9yhfgdejkr.t4irtueitdfbvcvrcf|SMB explorer (viewer).|\n|/explorer-scan-awdfsdftjktdngjksdfd|File explorer scan.|\n|/exportozirnosi-33388883333777-jisosei393|Export the file list.|\n|/archive-asdfvenrgdfgfd|Archive JSON feed.|\n|/i-want-to-download-awesome-pysa-file/{uuid}|Public file download.|\n|/gifhwdbhg4hugdkhfnksvdfetergtrwehfisuhew32r|Generate animation for files.|\n|/analyze-keywords-ejkrgnekjns-sdbfr|Analyze the files for full-text search.|\n|/asdfvenrgdfgfd-{id}.json|Project JSON feed for tracking.|\n\n\n-----\n\n**3.2.3** **Full-text Search Interface**\n\nOnce PYSA team members encrypt a target system, they must intimidate the victim into\npaying a ransom. Part of this process involves proving that the victim’s confidential data has\nbeen compromised successfully. PYSA has developed its own full-text search engine that\nextracts metadata and makes victim information easy to find and access.\n\nAn early version of the PYSA system only made file names and paths available. The version\nin use at the time of our investigation also includes content-based full-text search, but\nit is only available for administrators and has not yet been rolled out for the production\nenvironment. Figure 8 shows the full-text search interface of the management system, along\nwith some pre-defined keywords.\n\n**Figure 8. Full-text search interface of the management system.**\n\nThis innovative system makes it easier for a large-scale cybercriminal network to operate\nefficiently. However, it also provides insight into the mindset and ultimate goals of ransomware\noperators. Pre-defined keywords like ”government” show an obvious target categorization\nscheme at play, while more specific terms like ”1040”, ”1099”, and ”401(k)” refer to United\nStates tax documents and plans.\n\nFurther research into the predefined keywords (as shown in Table 5) may help pinpoint\nfuture targets and refine some of the assumptions cybersecurity professionals make about\ncybercrime groups like PYSA. For example, it’s clear that the list provided below is an\nextended version of the keyword list extracted from the PowerShell script PYSA used to\nexfiltrate data from the victim’s device. [3]\n\n12 / 32\n\nDISCLAIMER : This document and its contents shall be deemed as proprietary and privileged information of PRODAFT and shall\n\nbe subjected to articles and provisions that have been stipulated in the General Data Protection Regulation and Personal\n\nData Protection Law No. 6698. It shall be noted that PRODAFT provides this information “as is” according to its findings, without\n\nproviding any legally applicable warranty regarding completeness or accuracy of the contents Therefore neither this report\n\n\n-----\n\n1040 1099 1120 2020 2021\n401(k) 401K 4506-T 8822 8955\n941 9465 ABRH ARH Accou\nAddres Agreem Anal Annu Asse\nAssignment Author Balanc Bank*Statement Benef\nBill Biomet Book Budg Busi\nCDA CPF CRH Card Cash\nCell Cert Check Citiz Clien\nCompet Confi Contact Contr Covid\nDDRH DRH Daily Data Deal\nDemog Detail Disclo Doc Docum\nDrug EBITDA Emplo Enrol Equit\nExam FY2 Finan Form Grad\nHR Harassm Hir Human I-9\nI9 IRS Identi Img Incid\nIncom Info Insur Insurance Invest\nK-1 K1 List Mail Margin\nMonthly Mp4 NDA Non-discl Numb\nParent Partn Pass Pati Pay\nPerson Phone Princip Privat RHO\nRRHH Rat Recursos*Humanos Refer Repor\nResour Resul Reven SS SS#\nSS-4 SSA SSN SWIFT Salar\nSale Sec Sex Signed Soc\nStaf Stat Statement*Bank Stud Tax\nTeach Tort Trade Tranz Uniq\nValu Vend Verif Violen W-2\nW-4 W-7 W-8BEN W-9 W2\nW4 W9 Wage Work agreem\nbalanc bank billing budget bureau\ncard cash checking clandestine compilation\ncompromate concealed confid confident contact\ncontr emplo federal finance fraud\ngovernment hidden i-9 identi illegal\nimportant insider investigation letter mail\npassport passwd password pay payment\npayroll person privacy privat pwd\nreport resurses*human routing saving scans\nsec secret security seed sin\nsoc statement tax unclassified w-4\n\n**Table 5. Pre-defined keyword list of the system set by attackers.**\n\n13 / 32\n\nDISCLAIMER : This document and its contents shall be deemed as proprietary and privileged information of PRODAFT and shall\n\nbe subjected to articles and provisions that have been stipulated in the General Data Protection Regulation and Personal\n\nData Protection Law No. 6698. It shall be noted that PRODAFT provides this information “as is” according to its findings, without\n\nproviding any legally applicable warranty regarding completeness or accuracy of the contents Therefore neither this report\n\n\n-----\n\n**3.2.4** **Infrastructure**\n\nIn order to scale their infrastructure, the PYSA team deploys and manages a number of\ndockerized containers, including public leak servers, database, and management servers.\nThese containers are connected via internal networking on the same dedicated server. Figure\n9 shows an overview of PYSA’s infrastructure.\n\nDatabase\n(MariaDB)\n\n\nPublic Leak Server\n\n(Hidden Service)\n\n\nVictim Infrastructure\n\n\nEncrypted Cloud\n\n(Amazon S3)\n\n**Figure 9. PYSA’s network infrastructure.**\n\nSince December 2021, they have been deploying new management servers in order to\naddress scalability issues. Under this system, each threat actor is assigned a different\nmanagement server. The team uses external work queues like Amazon Simple Queue Service\n(SQS) to manage the workflow assigned to each individual. Simple deployment scripts (as\nshown in Figure 10) have been observed, allowing threat actors to deploy new management\npanels instantly.\n\n**Figure 10. Deployment script of the management panel.**\n\n14 / 32\n\nDISCLAIMER : This document and its contents shall be deemed as proprietary and privileged information of PRODAFT and shall\n\nbe subjected to articles and provisions that have been stipulated in the General Data Protection Regulation and Personal\n\nData Protection Law No. 6698. It shall be noted that PRODAFT provides this information “as is” according to its findings, without\n\nproviding any legally applicable warranty regarding completeness or accuracy of the contents Therefore neither this report\n\n\n-----\n\n**3.2.5** **Encrypted Cloud Storage**\n\nIt is surprising that the PYSA team utilized Amazon S3 cloud infrastructure to store their\nencrypted files. The group’s Amazon account was created on 18.09.2020 and the bucket\ndates to 21.09.2020. This bucket contains 31.47TB of encrypted data belonging to victims.\n\nThe system performs stream encryption and decryption services on the Amazon S3 cloud\nwhenever someone requests a file belonging to a victim. This request is made through a\nhidden onion server using a FileVault package as shown in Figure 11.\n\n**Figure 11. Sample code blocks that demonstrate the usage of the encrypted cloud.**\n\n15 / 32\n\nDISCLAIMER : This document and its contents shall be deemed as proprietary and privileged information of PRODAFT and shall\n\nbe subjected to articles and provisions that have been stipulated in the General Data Protection Regulation and Personal\n\nData Protection Law No. 6698. It shall be noted that PRODAFT provides this information “as is” according to its findings, without\n\nproviding any legally applicable warranty regarding completeness or accuracy of the contents Therefore neither this report\n\n\n-----\n\n**3.2.6** **Auto-GIF Generation**\n\nAfter ransom negotiations finish, many victims request proof of file deletion. PYSA can\nautomatically generate a GIF animation file (as shown in Figure 12) that appears to show the\nstolen file paths being deleted. Once the ransom is paid, PYSA threat actors generate this\nanimation and send it to victims along with the decryption software.\n\n**Figure 12. Auto-GIF generator to reassure the victim.**\n\nDespite the obvious reassurance this GIF offers to victims, it is an illusion. The PYSA team\ncannot delete the stolen files as shown in the animation. The PYSA team is free to use and\nreuse victim’s data as often as it feels necessary, and can even retarget victims using the\ndata it claims to have deleted. This is important because PYSA is known to use double\nextortion tactics against victims.\n\n16 / 32\n\nDISCLAIMER : This document and its contents shall be deemed as proprietary and privileged information of PRODAFT and shall\n\nbe subjected to articles and provisions that have been stipulated in the General Data Protection Regulation and Personal\n\nData Protection Law No. 6698. It shall be noted that PRODAFT provides this information “as is” according to its findings, without\n\nproviding any legally applicable warranty regarding completeness or accuracy of the contents Therefore neither this report\n\n\n-----\n\n**3.2.7** **Data Exfiltration via SMB Links**\n\nIn order to exfiltrate victim data from internal networks, the PYSA team uses SMB Links in\ntheir system. While most links are proxy or relay servers, some point directly to the victim’s\ninfrastructure.\n\nUpon filling the expected inputs as shown in Figure 13, the system executes asynchronous\ntasks to pull files from the link using the SMB protocol. The project ID field represents the\nvictim’s unique ID, which is set manually by attackers. The team also uses a token value to\nauthorize its affiliates. These function in a way similar to conventional API authorization keys.\n\n**Figure 13. SMB Link interface.**\n\nFigure 14 depicts a code snippet responsible for managing SMB links. The single most\nstriking observation to emerge from the code is the usage of work queues to transfer\nfiles simultaneously. We consider this approach a solid and speedy way to manage data\nexfiltration efficiently.\n\n**Figure 14. Source code excerpt responsible for SMB Links.**\n\n17 / 32\n\nDISCLAIMER : This document and its contents shall be deemed as proprietary and privileged information of PRODAFT and shall\n\nbe subjected to articles and provisions that have been stipulated in the General Data Protection Regulation and Personal\n\nData Protection Law No. 6698. It shall be noted that PRODAFT provides this information “as is” according to its findings, without\n\nproviding any legally applicable warranty regarding completeness or accuracy of the contents Therefore neither this report\n\n\n-----\n\n**3.2.8** **Users**\n\nWe identified 11 active users representing individual threat actors with different privilege\nlevels in the management system, as listed in Table 6. Each one is responsible only for its\nvictims (so-called projects), and only admin users can access another user’s content.\n\n**#** **Name** **Email** **Creation Date**\n1 admin admin@admin.com 2020-09-25 09:15:24\n2 t1 lmoen@goyette.info 2021-01-08 11:22:32\n3 t2 vonrueden.antonietta@gmail.com 2021-01-08 11:22:33\n4 t3 leanne.roob@hotmail.com 2021-01-08 11:22:33\n5 t4 wilderman.belle@gibson.com 2021-01-08 11:22:33\n6 t5 lesch.stephany@abshire.org 2021-01-08 11:22:33\n7 t6 plockman@medhurst.com 2021-01-08 11:22:33\n8 t7 jerrod19@yahoo.com 2021-01-08 11:22:33\n9 t8 collins.ike@corwin.com 2021-01-08 11:22:33\n10 t9 bosco.hipolito@wilkinson.com 2021-01-08 11:22:33\n11 t10 hayden.rempel@kunde.com 2021-01-08 11:22:33\n\n**Table 6. User list of the management panel.**\n\nOn the other hand, we detected the Faker [5] library in the source code, which can produce\nfake email addresses. As a result, we are highly skeptical of the validity of the email addresses\nprovided. We do not have further evidence suggesting that these email addresses belong\nto real accounts.\n\n[5. https://fakerphp.github.io/](https://fakerphp.github.io/)\n\n18 / 32\n\nDISCLAIMER : This document and its contents shall be deemed as proprietary and privileged information of PRODAFT and shall\n\nbe subjected to articles and provisions that have been stipulated in the General Data Protection Regulation and Personal\n\nData Protection Law No. 6698. It shall be noted that PRODAFT provides this information “as is” according to its findings, without\n\nproviding any legally applicable warranty regarding completeness or accuracy of the contents Therefore neither this report\n\n|#|Name|Email|Creation Date|\n|---|---|---|---|\n|1|admin|admin@admin.com|2020-09-25 09:15:24|\n|2|t1|lmoen@goyette.info|2021-01-08 11:22:32|\n|3|t2|vonrueden.antonietta@gmail.com|2021-01-08 11:22:33|\n|4|t3|leanne.roob@hotmail.com|2021-01-08 11:22:33|\n|5|t4|wilderman.belle@gibson.com|2021-01-08 11:22:33|\n|6|t5|lesch.stephany@abshire.org|2021-01-08 11:22:33|\n|7|t6|plockman@medhurst.com|2021-01-08 11:22:33|\n|8|t7|jerrod19@yahoo.com|2021-01-08 11:22:33|\n|9|t8|collins.ike@corwin.com|2021-01-08 11:22:33|\n|10|t9|bosco.hipolito@wilkinson.com|2021-01-08 11:22:33|\n|11|t10|hayden.rempel@kunde.com|2021-01-08 11:22:33|\n\n\n-----\n\n#### 3.3 Ransomware Software\n\nIn this section, we provide technical analysis of PYSA’s ransomware encryption and\ndecryption executables.\n\n**3.3.1** **Encryption**\n\nPYSA malware travels between hard drives recursively and looks for user files to encrypt.\nThe executable starts a new thread for an encryption routine on every new directory visit\nand puts a README ransom note in each directory. In order to keep the system functioning, it\ndoes not encrypt executable files along with necessary system files. It features hardcoded\nextensions that identify these files and excludes them from the encryption algorithm. Every\neligible file is encrypted and given a ”.pysa” extension. The recursive visit routine is shown\nbelow.\n\n**Figure 15. Recursively encrypting files.**\n\n19 / 32\n\nDISCLAIMER : This document and its contents shall be deemed as proprietary and privileged information of PRODAFT and shall\n\nbe subjected to articles and provisions that have been stipulated in the General Data Protection Regulation and Personal\n\nData Protection Law No. 6698. It shall be noted that PRODAFT provides this information “as is” according to its findings, without\n\nproviding any legally applicable warranty regarding completeness or accuracy of the contents Therefore neither this report\n\n\n-----\n\nPYSA ransomware generates a KEY and an IV value for each file. Key generation is done by\n**AutoSeededRandomPool. This is a randomly generated key later used for file encryption with**\n**AES CBC Mode algorithm. The generating process is shown below.**\n\n**Figure 16. Random KEY and IV generation.**\n\nThe ransomware executable encrypts files in blocks of 100 bytes. The block count loop starts\nby reading a block, encrypts that block, flushing it into the file and then starting back at the\ncorresponding position to prepare for the next block. The relevant code snippet is shown\nbelow.\n\n**Figure 17. File encryption.**\n\n20 / 32\n\nDISCLAIMER : This document and its contents shall be deemed as proprietary and privileged information of PRODAFT and shall\n\nbe subjected to articles and provisions that have been stipulated in the General Data Protection Regulation and Personal\n\nData Protection Law No. 6698. It shall be noted that PRODAFT provides this information “as is” according to its findings, without\n\nproviding any legally applicable warranty regarding completeness or accuracy of the contents Therefore neither this report\n\n\n-----\n\nOnce the routine described above successfully encrypts a file, the ransomware moves on to\nencrypt both KEY and IV values with an RSA public key. This information is needed later for\ndecryption. The ransomware moves to the beginning of the file and puts the encrypted KEY\nand IV values there.\n\nThe RSA public key is stored in encoded format. The RSA key content and decryption process\nis shown below.\n\n**Figure 18. Encoded RSA public key.**\n\n**Figure 19. Decoding RSA key.**\n\n21 / 32\n\nDISCLAIMER : This document and its contents shall be deemed as proprietary and privileged information of PRODAFT and shall\n\nbe subjected to articles and provisions that have been stipulated in the General Data Protection Regulation and Personal\n\nData Protection Law No. 6698. It shall be noted that PRODAFT provides this information “as is” according to its findings, without\n\nproviding any legally applicable warranty regarding completeness or accuracy of the contents Therefore neither this report\n\n\n-----\n\nThe process of encrypting KEY and IV values is shown below, as well. We have also included a\nscreenshot of the header process that puts encrypted parameters at the beginning of the file.\n\n**Figure 20. Encrypting KEY and IV values.**\n\n**Figure 21. Putting encrypted parameters at the beginning of the file.**\n\n22 / 32\n\nDISCLAIMER : This document and its contents shall be deemed as proprietary and privileged information of PRODAFT and shall\n\nbe subjected to articles and provisions that have been stipulated in the General Data Protection Regulation and Personal\n\nData Protection Law No. 6698. It shall be noted that PRODAFT provides this information “as is” according to its findings, without\n\nproviding any legally applicable warranty regarding completeness or accuracy of the contents Therefore neither this report\n\n\n-----\n\n**3.3.2** **Decryption**\n\nPYSA ransomware’s decryption method is straightforward and executes the reverse\nof the encryption process described above. The decryption software has an RSA private\nkey embedded in it, and this RSA private key is associated with the particular encryption\nexecutable unique to each victim, as shown below.\n\n**Figure 22. Embedded associated RSA private key.**\n\nThe decryption software recursively visits each file and runs its program. For every file, it must\nfirst retrieve input previously encrypted AES CBC Mode algorithm parameters. Using the RSA\nprivate key, it can decrypt KEY and IV values. Once it has the necessary parameters, it can\nsuccessfully restore file content and replace each filename with its original extension. The\ndecryption routine is shown below.\n\n**Figure 23. File decryption.**\n\n23 / 32\n\nDISCLAIMER : This document and its contents shall be deemed as proprietary and privileged information of PRODAFT and shall\n\nbe subjected to articles and provisions that have been stipulated in the General Data Protection Regulation and Personal\n\nData Protection Law No. 6698. It shall be noted that PRODAFT provides this information “as is” according to its findings, without\n\nproviding any legally applicable warranty regarding completeness or accuracy of the contents Therefore neither this report\n\n\n-----\n\n### 4 Statistics and Observations\n\nThis section provides the victim statistics by month, threat actor activity graph, and\nfindings on author profiling.\n\n#### 4.1 Victim Statistics\n\nSince September 2020, the PYSA team apparently exfiltrated the data from 747 victims\nto the management panel. December 2020 and June 2021 were the most active months,\nwith approximately 90 victims each month. The victim count remained elevated after June\n**2021, only tailing off at the end of the year.**\n\n**Figure 24. Victim statistics by month.**\n\nThe uptick in activity may coincide with the PYSA team’s development cycle initiatives for\nenabling full text search and other useful features. It’s plausible that PYSA’s leaders thought\nthis kind of functionality would give it a competitive edge in the cybercrime marketplace by\nmaking it easier for affiliates to operate large-scale attack campaigns.\n\nPYSA released the confidential files of 309 victims in their public leak server, and we\ndetected 747 victims in their management panel. According to the findings, we can roughly\ncalculate the success (ransom/payment) ratio of the ransomware gang, which is around\n**58%. Notwithstanding, the ratio raises intriguing questions regarding the nature and extent**\nof the cybercriminal’s motivations. Further studies, which take these variables into account,\nwill need to be undertaken.\n\n#### 4.2 Threat Actor Activity\n\nThe activity of individual threat actors suggests a group of four highly engaged users\nwith wide-ranging access. Together, these four users make up more than 90 percent of\nactivity on the group’s management panel. The other active users collectively make up the\nrest, which might mean there is a relatively small group of affiliates that are less involved in\nthe day-to-day operations of the PYSA group.\n\n24 / 32\n\nDISCLAIMER : This document and its contents shall be deemed as proprietary and privileged information of PRODAFT and shall\n\nbe subjected to articles and provisions that have been stipulated in the General Data Protection Regulation and Personal\n\nData Protection Law No. 6698. It shall be noted that PRODAFT provides this information “as is” according to its findings, without\n\nproviding any legally applicable warranty regarding completeness or accuracy of the contents Therefore neither this report\n\n\n-----\n\n**Figure 25. Threat actor activity statistics.**\n\nSince there appear to be multiple time zones represented throughout PYSA’s core\ninfrastructure, it’s likely that its primary users come from different parts of the world, and work\ntogether solely online. This would suggest that PYSA threat actors managed to sustain an\neffective and well-organized development cycle pipeline as a distributed global team.\n\n#### 4.3 Author Profiling and Linguistic Evidence\n\nDeep sensors planted by the PTI team can capture, interrupt, and react to information\ntraffic between the cybercriminals in secret and public communication channels. We\naccumulate linguistic evidence to strengthen our criminal profiling capabilities as part of our\ncyber attribution efforts. AUCH (Autorenprofile für die Untersuchung von Cyberkriminalität\nCH) is our recently developed deep neural networks empowered author profiling technology.\nAUCH can analyze the language of cybercriminals to reveal important information regarding\ntheir identities. It operates based on data and cyber-insight we have acquired over the\nyears with our unparalleled proactive approach against cybercrime.\n\n\nAUCH is currently a preliminary stage research project supported by the Swiss\nInnovation Agency, Innosuisse. We collaborate with our partners at the University\nof Zurich to integrate cutting-edge linguistics research into cybersecurity. In the\nupcoming months, we will be able to showcase more features we work on to support\nour investigations and consolidate our scientific approach against cybercrime.\n\n\n25 / 32\n\nDISCLAIMER : This document and its contents shall be deemed as proprietary and privileged information of PRODAFT and shall\n\nbe subjected to articles and provisions that have been stipulated in the General Data Protection Regulation and Personal\n\nData Protection Law No. 6698. It shall be noted that PRODAFT provides this information “as is” according to its findings, without\n\nproviding any legally applicable warranty regarding completeness or accuracy of the contents Therefore neither this report\n\n\n-----\n\n**Figure 26. PYSA ransomware statement from their website.**\n\nThe individuals behind the PYSA cybercrime group are known to be well-trained and\nwell-resourced. Most of the acquired messages were written by authors with an excellent\ncommand of the English language. However, as the linguistic evidence accumulated,\nAUCH was able to identify edge cases for author profiling. AUCH also exploits the\nrecent developments in XAI (Explainable artificial intelligence) to generate human-friendly\nexplanations based on gradient and perturbation methods to provide our threat intelligence\nanalysts with the necessary insights to work towards robust cyber-attribution. [2, 1] We will\nbe limiting our explainability discussion to three different meaningful examples generated by\nAUCH to show how our system captures different linguistic relationships.\n\n**4.3.1** **Grammaticality**\n\n**Ransom Note #1 : Every byte on any types of your devices was encrypted. Don’t try to use**\nbackups because it were encrypted too.\n\nOur inference engine detected the grammatical violations in the ransom messages found\nin compromised systems. Unlike the rest of the evidence, these messages included errors in\nthe English language’s fundamental aspects, such as subject-verb and pronoun-antecedent\nagreements. We do not see any evidence that these errors were replicated anywhere else in\nthe acquired messages.\n\n**4.3.2** **Unnatural Statements**\n\n**PYSA Victim Statements #1 : Don’t miss out on the most interesting (things) (leak), there is**\nsomething to please the sophisticated audience.\n\nThe non-existing noun in the (DET+ADVERB+ADJECTIVE) combination was flagged by the\nprofiling system. It is possible to introduce a noun from the phrase ”the most interesting” in\nGerman (das Interessanteste) but not in English. We think this linguistic innovation results\nfrom the native language of the author.\n\n26 / 32\n\nDISCLAIMER : This document and its contents shall be deemed as proprietary and privileged information of PRODAFT and shall\n\nbe subjected to articles and provisions that have been stipulated in the General Data Protection Regulation and Personal\n\nData Protection Law No. 6698. It shall be noted that PRODAFT provides this information “as is” according to its findings, without\n\nproviding any legally applicable warranty regarding completeness or accuracy of the contents Therefore neither this report\n\n\n-----\n\n**PYSA Victim Statements #2 : The main bonus from our partners is such information as**\ncriminal cases and material evidence on them, technical plans of buildings and structures\nof the city, confidential information about police officers. More than 20 GB of data that\nwill not leave you aside.\n\nThe phrasal verb ”leave you aside” was flagged as a linguistic anomaly by our profiling\nsystem. It is possible to ”leave something aside” but not ”leave someone aside” in the English\nlanguage. This is most likely a calque statement resulting from the influence of the native\nlanguage of the author.\n\n**PYSA Victim Statements #3 : Our partners will also not leave the opportunity to show**\nyou the calculations of budgets for future years, financial reports and documentation,\npersonal data of employees.\n\nThe term ”calculations of budgets” was flagged as a possible word order influence by our\nprofiling system. It is a very unnatural statement for an English native speaker in this context.\nA native speaker would probably prefer ”budget calculations” instead. In most European\nlanguages, it is possible to find root-for-root translations with the same word order. (DE :\n_Berechnung des Budgets, PT : cálculos de orçamentos, IT : calcolo dei bilanci, ESP : cálculo_\n_de los presupuestos)._\n\n**4.3.3** **Syntax**\n\n**PYSA Victim Statements - Author #1 : Here they will present for you (with) tax files, budget**\ncalculations and their formation, current settlements, payment orders, etc. 1.55 Gb files\nthat will not cease to be relevant at any time.\n\n**PYSA Victim Statements - Author #2 : One of the largest colleges in the State presents**\n(for) you with bank records, budget calculations, scanned documents, and photos of its\nemployees.\n\nTo further strengthen our claims, our inference engine has identified a prepositional\ninnovation by one of the authors. The first author uses the preposition combination ”present\n**for you” instead of ”present someone with” which is a distinctive dissimilarity for author**\nprofiling. However, this very linguistic innovation is not replicated in some of the other\nmessages on the victim announcement board, which brings the existence of multiple authors\ninto question. Upon inspection, our algorithm found that the linguistic style of the messages\nwithout innovations is different from the rest, confirming the existence of another author.\n\n\nBased on our first analysis, threat actors most likely have ties to Europe but also\nemploys different actors who are non-native English speakers.\n\n\n27 / 32\n\nDISCLAIMER : This document and its contents shall be deemed as proprietary and privileged information of PRODAFT and shall\n\nbe subjected to articles and provisions that have been stipulated in the General Data Protection Regulation and Personal\n\nData Protection Law No. 6698. It shall be noted that PRODAFT provides this information “as is” according to its findings, without\n\nproviding any legally applicable warranty regarding completeness or accuracy of the contents Therefore neither this report\n\n\n-----\n\n### 5 Conclusion\n\nPYSA has shown itself capable of highly destructive ransomware attacks on critical\ninfrastructure organizations, using a ”big game hunting” approach to extort large enterprises\ninto paying immense ransoms quickly. The PTI Team’s research offers a rare glimpse at\nhow the group’s techniques, tactics, and procedures enable it to achieve its goals. More\nimportantly, the gang does not delete the files even after receiving ransom money. Authorities\nalways underline ”Don’t pay the ransom” publicly to prevent financial support to ransomware\ngangs.\n\nUnlike highly automated threats that target huge numbers of victims at a time, PYSA is\na highly manual ransomware operator that focuses exclusively on high-value targets.\nNevertheless, the group’s development cycle shows that it prizes automation and workflow\nefficiency greatly, and has actively invested in improving its capabilities. Its development\nteam even created user-friendly tools like a full-text search engine to facilitate highly\nscalable automated workflows.\n\nMost ransomware gangs like PYSA use a double-extortion technique against their victims,\nand the victim’s data is both exfiltrated and encrypted. Almost 58% of the PYSA victims paid\nthe ransom, which presents the danger of this common technique. The data in this report will\nshape cybersecurity professionals’ understanding of how groups like PYSA work and what\nmotivates them. This adds considerable value to the insight threat intelligence operatives\ncan provide to the IT leaders who rely on them.\n\nPRODAFT and its threat intelligence platform USTA [6] deliver actionable insights to\ncybersecurity professionals to understand threat actors better, anticipate their next move,\nand respond faster once an incident occurs. To learn more about our platform or our CIN\nnetwork, you can contact us on our website.\n\n[6. https://www.prodaft.com/usta-trial-access](https://www.prodaft.com/usta-trial-access)\n\n28 / 32\n\nDISCLAIMER : This document and its contents shall be deemed as proprietary and privileged information of PRODAFT and shall\n\nbe subjected to articles and provisions that have been stipulated in the General Data Protection Regulation and Personal\n\nData Protection Law No. 6698. It shall be noted that PRODAFT provides this information “as is” according to its findings, without\n\nproviding any legally applicable warranty regarding completeness or accuracy of the contents Therefore neither this report\n\n\n-----\n\n**Acknowledgement**\nWe would like to thank our advisors for their valuable guidance and support throughout this\nresearch.\n\nThe public version of the report will be shared from our github page [7]. The readers can find\nnew samples, IOCs, and new versions of this report from our github page as we will constantly\nupdate our page based on new findings.\n\n[7. https://www.github.com/prodaft](https://www.github.com/prodaft)\n\n29 / 32\n\nDISCLAIMER : This document and its contents shall be deemed as proprietary and privileged information of PRODAFT and shall\n\nbe subjected to articles and provisions that have been stipulated in the General Data Protection Regulation and Personal\n\nData Protection Law No. 6698. It shall be noted that PRODAFT provides this information “as is” according to its findings, without\n\nproviding any legally applicable warranty regarding completeness or accuracy of the contents Therefore neither this report\n\n\n-----\n\n### 6 IOC\n\n#### 6.1 Leak Management Infrastructure\n```\n193.34.166.165\n193.34.166.214\n193.34.166.189\n193.34.166.181\n193.34.167.240\n193.34.166.92\n193.34.167.230\n\n 6.2 Public Leak Servers\nna47pldl5eoqxt42.onion\nwqmfzni2nvbbpk25.onion\npysa2bitc5ldeyfak4seeruqymqs4sj5wt5qkcq7aoyg4h2acqieywad.onion\n\n```\n30 / 32\n\nDISCLAIMER : This document and its contents shall be deemed as proprietary and privileged information of PRODAFT and shall\n\nbe subjected to articles and provisions that have been stipulated in the General Data Protection Regulation and Personal\n\nData Protection Law No. 6698. It shall be noted that PRODAFT provides this information “as is” according to its findings, without\n\nproviding any legally applicable warranty regarding completeness or accuracy of the contents Therefore neither this report\n\n\n-----\n\n### Références\n\n[1] Avanti Shrikumar, Peyton Greenside et Anshul Kundaje. « Learning important features\nthrough propagating activation differences ». In : International conference on machine\n_learning. PMLR. 2017, p. 3145-3153._\n\n[2] Mukund Sundararajan, Ankur Taly et Qiqi Yan. « Axiomatic attribution for deep networks ».\nIn : International conference on machine learning. PMLR. 2017, p. 3319-3328.\n\n[3] Bleeping Computer. Ransomware gang’s script shows exactly the files they’re after.\n[url : https://www.bleepingcomputer.com/news/security/ransomware-gangs-script-](https://www.bleepingcomputer.com/news/security/ransomware-gangs-script-shows-exactly-the-files-theyre-after/)\n```\n  shows-exactly-the-files-theyre-after/. (accessed : 22.03.2022).\n\n```\n31 / 32\n\nDISCLAIMER : This document and its contents shall be deemed as proprietary and privileged information of PRODAFT and shall\n\nbe subjected to articles and provisions that have been stipulated in the General Data Protection Regulation and Personal\n\nData Protection Law No. 6698. It shall be noted that PRODAFT provides this information “as is” according to its findings, without\n\nproviding any legally applicable warranty regarding completeness or accuracy of the contents Therefore neither this report\n\n\n-----\n\n### Historique\n\n**Version** **Date** **Auteur(s)** **Modifications**\n\n1.0 27.09.2020 PTI Team Initial TLP:RED DRAFT version.\n2.0 23.12.2020 PTI Team Law Enforcement version.\n2.1 06.01.2021 PTI Team Threat actor attribution.\n2.2 15.01.2022 PTI Team Redacted TLP:AMBER version.\n3.0 11.04.2022 PTI Team Public TLP:WHITE version of the report.\n\n32 / 32\n\nDISCLAIMER : This document and its contents shall be deemed as proprietary and privileged information of PRODAFT and shall\n\nbe subjected to articles and provisions that have been stipulated in the General Data Protection Regulation and Personal\n\nData Protection Law No. 6698. It shall be noted that PRODAFT provides this information “as is” according to its findings, without\n\nproviding any legally applicable warranty regarding completeness or accuracy of the contents Therefore neither this report\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "bf5be533-fa31-4590-ae37-5761c97ffa34",
            "created_at": "2022-10-25T16:13:58.389257Z",
            "updated_at": "2022-10-25T16:13:58.389257Z",
            "deleted_at": null,
            "name": "Malpedia",
            "url": "https://malpedia.caad.fkie.fraunhofer.de",
            "description": "Malpedia is a free service offered by Fraunhofer FKIE",
            "reports": null
        }
    ],
    "references": [
        "https://www.prodaft.com/m/reports/PYSA_TLPWHITE_3.0.pdf"
    ],
    "report_names": [
        "PYSA_TLPWHITE_3.0.pdf"
    ],
    "threat_actors": [
        {
            "id": "5cbf6c32-482d-4cd2-9d11-0d9311acdc28",
            "created_at": "2023-01-06T13:46:38.39927Z",
            "updated_at": "2025-03-27T02:00:02.823829Z",
            "deleted_at": null,
            "main_name": "ENERGETIC BEAR",
            "aliases": [
                "DYMALLOY",
                "TG-4192",
                "Crouching Yeti",
                "Group 24",
                "Havex",
                "IRON LIBERTY",
                "Blue Kraken",
                "ALLANITE",
                "Koala Team",
                "G0035",
                "ATK6",
                "ITG15",
                "Ghost Blizzard",
                "BERSERK BEAR"
            ],
            "source_name": "MISPGALAXY:ENERGETIC BEAR",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "3a0be4ff-9074-4efd-98e4-47c6a62b14ad",
            "created_at": "2022-10-25T16:07:23.590051Z",
            "updated_at": "2025-03-27T02:02:09.878211Z",
            "deleted_at": null,
            "main_name": "Energetic Bear",
            "aliases": [
                "ATK 6",
                "Blue Kraken",
                "Crouching Yeti",
                "Dragonfly",
                "Electrum",
                "Energetic Bear",
                "Ghost Blizzard",
                "Group 24",
                "ITG15",
                "Iron Liberty",
                "Koala Team",
                "TG-4192"
            ],
            "source_name": "ETDA:Energetic Bear",
            "tools": [
                "Backdoor.Oldrea",
                "CRASHOVERRIDE",
                "Commix",
                "CrackMapExec",
                "CrashOverride",
                "Dirsearch",
                "Dorshel",
                "Fertger",
                "Fuerboos",
                "Goodor",
                "Havex",
                "Havex RAT",
                "Hello EK",
                "Heriplor",
                "Impacket",
                "Industroyer",
                "Karagany",
                "Karagny",
                "LightsOut 2.0",
                "LightsOut EK",
                "Listrix",
                "Oldrea",
                "PEACEPIPE",
                "PHPMailer",
                "PsExec",
                "SMBTrap",
                "Subbrute",
                "Sublist3r",
                "Sysmain",
                "Trojan.Karagany",
                "WSO",
                "Webshell by Orb",
                "Win32/Industroyer",
                "Wpscan",
                "nmap",
                "sqlmap",
                "xFrost"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "75108fc1-7f6a-450e-b024-10284f3f62bb",
            "created_at": "2024-11-01T02:00:52.756877Z",
            "updated_at": "2025-03-27T02:00:55.544216Z",
            "deleted_at": null,
            "main_name": "Play",
            "aliases": null,
            "source_name": "MITRE:Play",
            "tools": [
                "Nltest",
                "AdFind",
                "PsExec",
                "Wevtutil",
                "Cobalt Strike",
                "Playcrypt",
                "Mimikatz"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1666716496,
    "ts_updated_at": 1743041786,
    "ts_creation_date": 1649931809,
    "ts_modification_date": 1649931809,
    "files": {
        "pdf": "https://archive.orkl.eu/7ad7b830384ad8e252c31e8a73573923a7cc15f5.pdf",
        "text": "https://archive.orkl.eu/7ad7b830384ad8e252c31e8a73573923a7cc15f5.txt",
        "img": "https://archive.orkl.eu/7ad7b830384ad8e252c31e8a73573923a7cc15f5.jpg"
    }
}