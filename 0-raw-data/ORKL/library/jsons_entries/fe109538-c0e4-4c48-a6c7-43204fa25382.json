{
    "id": "fe109538-c0e4-4c48-a6c7-43204fa25382",
    "created_at": "2023-01-12T15:07:51.616268Z",
    "updated_at": "2025-03-27T02:06:14.24275Z",
    "deleted_at": null,
    "sha1_hash": "a4aba5b034cd343e804162d8abc64b8e2a20131f",
    "title": "2021-07-09 - Serv-U Remote Memory Escape Vulnerability CVE-2021-35211 (exploited in the wild)",
    "authors": "",
    "file_creation_date": "2022-05-28T19:44:19Z",
    "file_modification_date": "2022-05-28T19:44:19Z",
    "file_size": 133949,
    "plain_text": "# SolarWinds Trust Center Security Advisories\n\n**[solarwinds.com/trust-center/security-advisories/cve-2021-35211](https://www.solarwinds.com/trust-center/security-advisories/cve-2021-35211)**\n\n**SolarWinds uses cookies on its websites to make your online experience easier and**\n**better. By using our website, you consent to our use of cookies. For more information**\n**on cookies, see our** **[Cookie Policy.](https://www.solarwinds.com/legal/privacy)**\n\nContinue\n\n**Serv-U Remote Memory Escape Vulnerability**\n\n**CVE-2021-35211**\n\nSecurity Vulnerability\n\n**Released: July 9, 2021 Last updated: July 15, 2021**\n\n**Assigning CNA: SolarWinds**\n\n**Security Advisory Summary**\n\n**UPDATE July 15, 20201: You can** **[Subscribe to this RSS Feed to be notified when we](https://www.solarwinds.com/shared-content/rss-feed/solarwinds-cve-rss-feed)**\n**update this page (note: you will need to cut and paste the \"Subscribe to this RSS**\n**feed\" URL into an RSS Feed Reader, e.g., Outlook's RSS Subscriptions, to monitor**\n**updates).**\n\n**UPDATE July 13, 20201: We've provided additional indicators of compromise (IOCs)**\n**below. You can also find additional details on the threat actor and their findings in a**\n**[blog post from Microsoft.](https://www.microsoft.com/security/blog/2021/07/13/microsoft-discovers-threat-actor-targeting-solarwinds-serv-u-software-with-0-day-exploit/)**\n\n**UPDATE July 10, 2021: NOTE: This security vulnerability only affects Serv-U Managed**\n**File Transfer and Serv-U Secure FTP and does not affect any other SolarWinds or N-**\n**able (formerly SolarWinds MSP) products.**\n\nSolarWinds was recently notified by Microsoft of a security vulnerability related to Serv-U\nManaged File Transfer Server and [Serv-U Secured FTP and have developed a hotfix to](https://www.solarwinds.com/ftp-server-software)\nresolve this vulnerability. While Microsoft’s research indicates this vulnerability exploit\ninvolves a limited, targeted set of customers and a single threat actor, our joint teams have\nmobilized to address it quickly.\n\n\n-----\n\nThe vulnerability exists in the latest Serv-U version 15.2.3 HF1 released May 5, 2021, and all\nprior versions. A threat actor who successfully exploited this vulnerability could run arbitrary\ncode with privileges. An attacker could then install programs; view, change, or delete data; or\nrun programs on the affected system.\n\nServ-U version 15.2.3 hotfix (HF) 2 has been released. Please see the Security Updates\ntable below for the applicable update for your system. We recommend you install these\nupdates immediately. If you are unable to install these updates, see the FAQ in this Security\nAdvisory for information on how to help protect your system from this vulnerability.\n\nAdditional details of the vulnerability will be published after giving customers sufficient time to\nupgrade for the protection of their environments.\n\n**Affected Products**\nServ-U 15.2.3 HF1 and all prior Serv-U versions\n\n**Fixed Software Release**\n[Serv-U 15.2.3 HF2](https://customerportal.solarwinds.com/)\n\n**Security Updates**\n\n**Software Version** **Upgrade Paths**\n\n\nServ-U 15.2.3\nHF1\n\n\nApply Serv-U 15.2.3 HF2, available in your Customer Portal\n\n\nServ-U 15.2.3 Apply Serv-U 15.2.3 HF1, then apply Serv-U 15.2.3 HF2, available in\nyour Customer Portal\n\n\nAll Serv-U\nversions prior to\n15.2.3\n\n\nUpgrade to Serv-U 15.2.3, then apply Serv-U 15.2.3 HF1, then apply\nServ-U 15.2.3 HF2, available in your Customer Portal\n\n\nFAQ\n\n**What happened?**\n\n\n-----\n\nMicrosoft reported to SolarWinds that they had discovered a remote code execution (RCE)\nvulnerability in the SolarWinds Serv-U product. Microsoft provided a proof of concept of the\nexploit. If exploited, a threat actor may be able to gain privileged access to the threat actor\non the machine hosting Serv-U.\n\nTo the best of our understanding, no other SolarWinds products have been affected by this\nvulnerability.\n\n**Have SolarWinds customers been affected?**\n\nMicrosoft has provided evidence of limited, targeted customer impact, though SolarWinds\ndoes not currently have an estimate of how many customers may be directly affected by the\nvulnerability. SolarWinds is unaware of the identity of the potentially affected customers.\n\n**Have N-able customers been affected?**\n\nNo, N-able customer who do not use Serv-U are not affected by this vulnerability.\n\n_Updated July 13, 2021_\n\n**What products are affected?**\n\n**Only SolarWinds Serv-U Managed File Transfer and Serv-U Secure FTP for Windows are**\naffected by this vulnerability. Please note the Serv-U Gateway is a component of these two\nproducts and is not a separate product.\n\nThe Linux versions of these products are not vulnerable to a RCE exploit of this security\nvulnerability. The Linux version of the Serv-U product crashes when the exploit is attempted\nby a threat actor.\n\n_Updated July 15, 2021_\n\n**What products are not affected?**\n\nAll other SolarWinds and N-able (formerly SolarWinds MSP) are not affected by this\nvulnerability. This includes the Orion Platform, and all Orion Platform modules. A complete\nlist of products not known to be affected by this security vulnerability follows:\n\n**SolarWinds product NOT AFFECTED by this security vulnerability:**\n\n8Man Network Operations Manager (NOM)\n\nAccess Rights Manager (ARM) Network Performance Monitor (NPM)\n\n\n-----\n\nApplication Centric Monitor (ACM) Network Topology Mapper (NTM)\n\nAppOptics Papertrail\n\nBackup Document Patch Manager\n\nBackup Profiler Pingdom\n\nBackup Server Pingdom Server Monitor\n\nBackup Workstation Server & Application Monitor (SAM)\n\nCatTools Server Configuration Monitor (SCM)\n\nDameware Mini Remote Control Security Event Manager (SEM)\n\nDameware Patch Manager Security Event Manager Workstation Edition\n\nDameware Remote Everywhere Service Desk\n\nDameware Remote Manager Server Profiler\n\nDatabase Performance Analyzer (DPA) Storage Manager\n\n\nDatabase Performance Analyzer\nIntegration Module*(DPAIM*)\n\n\nStorage Profiler\n\n\nDatabase Performance Monitor (DPM) Storage Resource Monitor (SRM)\n\nDNSstuff Threat Monitor\n\nEngineer’s Toolset Virtualization Manager (VMAN)\n\nEngineer's Web Toolset Virtualization Profiler\n\nEnterprise Operations Console (EOC) VoIP & Network Quality Manager (VNQM)\n\n\n-----\n\nFailOverEngine Web Help Desk\n\nFirewall Security Monitor Web Performance Monitor (WPM)\n\nHigh Availability (HA) SQL Sentry\n\nIdentity Monitor DB Sentry\n\nIP Address Manager (IPAM) V Sentry\n\nipMonitor Win Sentry\n\nKiwiCatTools BI Sentry\n\nKiwi Log Viewer SentryOneDocument\n\nKiwi Syslog Server SentryOneTest\n\nLANSurveyor Task Factory\n\nLibrato DBAxPress\n\nLog Analyzer (LA) Plan Explorer\n\nLog & Event Manager (LEM) APS Sentry\n\nLog&Event Manager Workstation Edition DW Sentry\n\nLoggly SQL Sentry Essentials\n\nMobile Admin SentryOneMonitor\n\nNetFlow Traffic Analyzer (NTA) BIxPress\n\n\nNetwork Automation Manager (NAM)\n\n\n-----\n\nNetwork Configuration Manager (NCM)\n\n\n***NOTE: Please note DPAIM is an integration module and is not the same as Database**\nPerformance Analyzer (DPA).\n\nWe have also found no evidence that any of our free tools, (TFTP/SCP), Orion agents, or\nWeb Performance Monitor (PM) Players are impacted by this security vulnerability.\n\n**N-able (formerly SolarWinds MSP) products NOT AFFECTED by this security**\n**vulnerability:**\n\nN-central – Probe Mail Assure\n\nN-central – Topology SpamExperts\n\nN-central –NetPath MSP Manager\n\nN-central PassPortal\n\nNetPath– Server Take Control\n\nRMM Patch\n\nBackup Disaster Recovery Automation Manager\n\nM365 Backup Webprotection\n\n\nBackup\n\n\n**How is SolarWinds addressing this?**\n\nSolarWinds released a hotfix Friday, July 9, 2021, and we recommend all customers using\n**Serv-U install this fix immediately for the protection of your environment.**\n\n_Updated July 10, 2021_\n\n**What actions should I take?**\n\n\n-----\n\nIf you are an active maintenance SolarWinds customer of the Serv-U product,\n[SolarWinds asks you to log into your Customer Portal to access your updates. This update](https://customerportal.solarwinds.com/)\nis expected to take only a few minutes to implement.\n\nIf you are not on active maintenance and currently using a Serv-U product, our\nCustomer Success team is available to help you with your questions. Please open a\n[customer service ticket with the subject \"Serv-U Assistance\" and our team will assist you](https://customerportal.solarwinds.com/support/submit-a-ticket?sid=satsn)\n(no login required).\n\n_Updated July 13, 2021_\n\n**How can I tell if my environment has been compromised?**\n\nThe following steps are steps you can take to determine if your environment has been\ncompromised:\n\n1. Is SSH enabled for your Serv-U installation? If SSH is not enabled in the environment,\nthe vulnerability does not exist.\n\n2. Is your environment throwing exceptions? This attack is a Return Oriented\nProgramming (ROP) attack. When exploited, the vulnerability causes the Serv-U product to\nthrow an exception and then intercepts the exception handling code to run commands.\nPlease note, several reasons exist for exceptions to be thrown, so an exception itself is not\nnecessarily an indicator of attack.\n\nPlease collect the DebugSocketlog.txt log file, which can be found in the following\nlocations:\nC:\\ProgramData\\RhinoSoft\\Serv-U\\DebugSocketlog.txt\nC:\\ProgramFiles\\RhinoSoft\\Serv-U\\DebugSocketlog.txt\n\nIn the log file DebugSocketlog.txt you may see an exception, such as:\n\n07] Tue 01Jun21 02:42:58 - EXCEPTION: C0000005; CSUSSHSocket::ProcessReceive();\nType: 30; puchPayLoad = 0x041ec066; nPacketLength = 76; nBytesReceived = 80;\nnBytesUncompressed = 156; uchPaddingLength = 5\n\nExceptions may be thrown for other reasons so please collect the logs to assist with\ndetermining your situation.\n\n3. Are you seeing potentially suspicious connections via SSH? Look for connections\nvia SSH from the following IP addresses, which have been reported as a potential indicator\nof attack by the threat actor:\n**98[.]176[.]196[.]89**\n**68[.]235[.]178[.]32**\n**208[.]113[.]35[.]58**\n\n\n-----\n\n**144[.]34[.]179[.]162**\n**97[.]77[.]97[.]58**\n\nOther indicators:\n\n**hxxp://144[.]34[.]179[.]162/a**\n**C:\\Windows\\Temp\\Serv-u.bat**\n**C:\\Windows\\Temp\\test\\current.dmp**\n\n4. Are you seeing potentially suspicious activity by Serv-U? Review your monitoring\ntools and/or EDR platforms for Serv-U.exe spawning anomalous processes, such as:\n\n_mshta.exe_\n_powershell.exe_\n_cmd.exe (or conhost.exe then spawning cmd.exe) with any of the following in the_\ncommand line:\n\n_whoami_\n_dir_\n_./Client/Common_\n_.\\Client\\Common_\n_type [a file path] > \"C:\\ProgramData\\RhinoSoft\\Serv-U\\Users\\Global Users\\[file_\n_name].Archive\"_\nAny process with the following in the command line:\n\n_C:\\Windows\\Temp\\_\nThe addition of any unrecognized Global users to Serv-U. This can be checked in the\nusers tab of the Serv-U Management Console, as shown below. It can also be\nchecked by looking for recently created files in C:\\ProgramData\\RhinoSoft\\Serv_U\\Users\\Global Users, which appears to store the Global users information._\n\nIf you observe this activity, investigate these processes further, and any traffic\noriginating from the Serv-U box. Please contact SolarWinds Customer Support with this\ninformation, and we will escalate for investigation.\n\n**Is this vulnerability related to the SUNBURST cyberattack?**\n\n\n-----\n\nNo. It s important to note this new vulnerability is completely unrelated to the SUNBURST\nsupply chain attack. Software vulnerabilities are quite common, range in severity levels, and\nare routinely resolved by software vendors as part of their ongoing maintenance release\nschedules.\n\n**What kind of vulnerability is this?**\n\nBased on our investigations, this is a remote code execution (RCE) exploit.\n\n**What versions of Serv-U are affected?**\n\nBased on our investigations, this RCE exploit affects all versions of Serv-U, prior to version\n15.2.3 HF2, which has been built to address this vulnerability, and to help protect your\nenvironment.\n\n_Updated July 13, 2021_\n\n**Where can I get additional information?**\n\nWe understand the desire for more information on this issue, and we’ll provide more\ninformation here as it’s available.\n\nIn the meantime, our Customer Success team is available to you. Please open a customer\nservice ticket with the subject \"Serv-U Assistance\" and our team will assist you (no login\nrequired).\n\n**Acknowledgements**\n\nSolarWinds would like to thank the Security Researcher below for reporting on the issue in a\nresponsible manner and working with our security, product, and engineering teams to fix the\nvulnerability.\n\n**Microsoft Threat Intelligence Center (MSTIC) and Microsoft Offensive Security**\n**Research teams**\n\n**Disclaimer**\n\nPlease note, any content posted herein is provided as a suggestion or recommendation to\nyou for your internal use. This is not part of the SolarWinds software or documentation that\nyou purchased from SolarWinds, and the information set forth herein may come from third\nparties. Your organization should internally review and assess to what extent, if any, such\ncustom scripts or recommendations will be incorporated into your environment. You elect to\nuse third-party content at your own risk, and you will be solely responsible for the\nincorporation of the same if any.\n\n\n-----\n\n**Revisions**\n\n**Version** **Revision**\n**Date**\n\n1.4 July 15,\n2021\n\n1.3 July 13,\n2021\n\n1.2 July 10,\n2021\n\n1.1 July 10,\n2021\n\n1.0 July 9,\n2021\n\n\n**Description**\n\nUpdated FAQ information. Added RSS feed instructions. These are\ninformational changes only.\n\nUpdated FAQ information. This is an informational change only.\n\nUpdated FAQ information. This is an informational change only.\n\nNotice added, updated FAQ information. This an informational\nchange only.\n\nInformation Published\n\n\nWe’re Geekbuilt.\n\n\n®\n\n\nDeveloped by network and systems engineers who know what it takes to manage today's\ndynamic IT environments, SolarWinds has a deep connection to the IT community.\n\nThe result? IT management products that are effective, accessible, and easy to use.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-07-09 - Serv-U Remote Memory Escape Vulnerability CVE-2021-35211 (exploited in the wild).pdf"
    ],
    "report_names": [
        "2021-07-09 - Serv-U Remote Memory Escape Vulnerability CVE-2021-35211 (exploited in the wild).pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673536071,
    "ts_updated_at": 1743041174,
    "ts_creation_date": 1653767059,
    "ts_modification_date": 1653767059,
    "files": {
        "pdf": "https://archive.orkl.eu/a4aba5b034cd343e804162d8abc64b8e2a20131f.pdf",
        "text": "https://archive.orkl.eu/a4aba5b034cd343e804162d8abc64b8e2a20131f.txt",
        "img": "https://archive.orkl.eu/a4aba5b034cd343e804162d8abc64b8e2a20131f.jpg"
    }
}