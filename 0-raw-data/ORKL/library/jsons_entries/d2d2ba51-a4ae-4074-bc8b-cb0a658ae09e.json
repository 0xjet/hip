{
    "id": "d2d2ba51-a4ae-4074-bc8b-cb0a658ae09e",
    "created_at": "2022-10-25T16:48:24.087461Z",
    "updated_at": "2025-03-27T02:17:14.583915Z",
    "deleted_at": null,
    "sha1_hash": "87f5158d77ea898b705d34760578696818ed5ad8",
    "title": "APT10 Targeted Norwegian MSP and US Companies in Sustained Campaign",
    "authors": "",
    "file_creation_date": "2019-02-06T12:21:49Z",
    "file_modification_date": "2019-02-06T12:26:04Z",
    "file_size": 3356762,
    "plain_text": "CYBER THREAT ANALYSIS\n\n# APT10 Targeted Norwegian MSP and US Companies in Sustained Campaign\n\n## Intrusions Highlight Ongoing Exposure of Third-Party Risk\n\n### By Insikt Group Co-Authored by Rapid7\n\n\n-----\n\n_Recorded Future analyzed an intrusion into one of our client’s networks and_\n_collaborated with Rapid7 to determine the scope of a cyberespionage campaign_\n_assessed to be conducted by a Chinese state-sponsored threat actor, APT10. This report_\n_details the campaign using data acquired from targeted host networks, the Recorded_\n_Future® Platform, network metadata, VirusTotal, Farsight DNS, Shodan, and other_\n_OSINT techniques._\n\n_Norwegian company Visma, which was targeted in the attack, and U.S. company_\n_Rapid7 provided support and extensive expertise throughout this research. Industry_\n_collaboration is a vital enabler in illuminating threats and offering protection to_\n_organizations at risk from hostile, state-sponsored economic cyberespionage._\n\n_This report will be of most value to network defenders and corporate risk executives_\n_within companies that utilize services from managed IT service providers and cloud_\n_hosting providers. The report will also be of interest to companies with an exposed_\n\n_third-party supply chain._\n\n#### Executive Summary\n\nA sustained cyberespionage campaign targeting at least three\ncompanies in the United States and Europe was uncovered\nby Recorded Future and Rapid7 between November 2017 and\nSeptember 2018. Based on the technical data uncovered, and in\nlight of recent disclosures by the U.S. Department of Justice on\nthe ongoing activities of Chinese state-sponsored threat actors, we\nassess with high confidence that these incidents were conducted by\nAPT10 (also known as Stone Panda, menuPass, CVNX) in an effort\nto gain access to networks and steal valuable intellectual property\nor gain commercial advantage.\n\nThe targeted companies included:\n\n - IT and business cloud services managed service provider\n\n(MSP) and Recorded Future client and supplier, Visma, a\nbillion-dollar Norwegian company with at least 850,000\ncustomers globally\n\n - An international apparel company\n\n - A U.S. law firm with strong experience in intellectual property\n\nlaw with clients in the pharmaceutical, technology, electronics,\nbiomedical, and automotive sectors, among others\n\nIn all three incidents, the attackers gained access to networks\nthrough deployments of Citrix and LogMeIn remote-access software\nusing stolen valid user credentials. The attackers then enumerated\naccess and conducted privilege escalation on the victim networks,\n\n\n-----\n\n[utilizing DLL sideloading techniques documented in a US-CERT alert](https://www.us-cert.gov/ncas/alerts/TA17-117A)\n[on APT10 to deliver malware. During the Visma intrusion, APT10](https://www.us-cert.gov/ncas/alerts/TA17-117A)\ndeployed their Trochilus malware with command and control (C2)\ncommunications encrypted using both RC4 and Salsa20 streaming\nciphers rather than the typically observed RC4 variant. On the two\nother victim networks, the attackers deployed a unique version of\nthe UPPERCUT (ANEL) backdoor, known to have only been used by\nAPT10.\n\nAPT10 actors then compressed proprietary data from Visma using\nWinRAR (deployed by the attackers) and exfiltrated to a Dropbox\naccount using the cURL for Windows command-line tool. The same\nDropbox account was also accessed in a similar fashion by the\nattackers during the apparel company intrusion. Dropbox was also\nused to store exfiltrated documents from the third victim, a U.S.\nlaw firm, with the files again exfiltrated using identical TTPs and\nuploaded using cURL for Windows.\n\nWe believe APT10 is the most significant Chinese state-sponsored\ncyber threat to global corporations known to date. On top of the\nbreadth, volume, and targets of attacks that APT10 has conducted\n[since at least 2016, we now know that these operations are being](https://www.justice.gov/opa/pr/two-chinese-hackers-associated-ministry-state-security-charged-global-computer-intrusion)\nrun by the Chinese intelligence agency, the Ministry of State Security\n(MSS).\n\n[Utilizing actors working for shell companies such as Huaying Haitai](https://intrusiontruth.wordpress.com/2018/08/15/apt10-was-managed-by-the-tianjin-bureau-of-the-chinese-ministry-of-state-security/)\n[Science and Technology Development Co Ltd (天津华盈海泰科技发展](https://intrusiontruth.wordpress.com/2018/08/15/apt10-was-managed-by-the-tianjin-bureau-of-the-chinese-ministry-of-state-security/)\n[有限公司), and under the direct supervision of their regional bureau](https://intrusiontruth.wordpress.com/2018/08/15/apt10-was-managed-by-the-tianjin-bureau-of-the-chinese-ministry-of-state-security/)\nin Tianjin, the MSS has conducted an [unprecedented campaign,](https://www.reuters.com/article/us-china-cyber-hpe-ibm-exclusive/exclusive-china-hacked-hpe-ibm-and-then-attacked-clients-sources-idUSKCN1OJ2OY)\ndubbed “Operation Cloud Hopper,” against managed IT service\nproviders (MSPs) designed to steal intellectual property and enable\nsecondary attacks against their clients. Access to the networks of\nthese third-party service providers grants the MSS the ability to\npotentially access the networks of hundreds, if not thousands,\nof corporations around the world. We assess that APT10 likely\ncompromised Visma with the primary goal of enabling secondary\nintrusions onto their client networks, and not of stealing Visma\nintellectual property.\n\nIn this same time frame, APT10 also targeted a U.S. law firm and\nan international apparel company, likely to gather information for\ncommercial advantage. In all three incidents, APT10 actors used\n\n\n-----\n\npreviously acquired legitimate credentials, possibly gained via a\nthird-party supply chain compromise in order to gain initial access\nto the law firm and the apparel company.\n\n_Recorded Future timeline of APT10 activity between August 2018 and January 2019._\n\n#### Key Judgments\n\n - We have identified a new variant of Trochilus malware, with\n\nits C2 communications encrypted using a combination of RC4\nand Salsa20 stream ciphers.\n\n - An UPPERCUT backdoor was identified in the targeting of\n\nan international apparel company and U.S. law firm. The\nbackdoor was deployed using the Notepad++ updater and\n[sideloading malicious DLL, as noted in APT10’s targeting of](https://www.fireeye.com/blog/threat-research/2018/09/apt10-targeting-japanese-corporations-using-updated-ttps.html)\n[Japanese corporations in July 2018.](https://www.fireeye.com/blog/threat-research/2018/09/apt10-targeting-japanese-corporations-using-updated-ttps.html)\n\n - In addition to using Trochilus and UPPERCUT, APT10 utilized a\n\nseries of previously known and associated attack TTPs for all\nthree of these intrusions. Some of these TTPs include:\n\n    - Transferring tools from the C2 to the host using\n\nBITSAdmin-scheduled tasks into C:\\ProgramData\\temp\n\n\n-----\n\n- Use of DLL sideloading by executing a legitimate\n\nbinary to load a renamed malicious DLL that decrypts,\ndecompresses, and injects a Trochilus payload into\nmemory\n\n- Use of legitimate credentials, possibly acquired through\n\nprevious MSP compromises, to log in to accessible Citrix\nRemote Desktop clients in targeted organizations\n\n\n-----\n\n-----\n\n#### Background\n\nAPT10 is a threat actor that has been active since at least 2009. It has\nhistorically targeted healthcare, defense, aerospace, government,\nheavy industry and mining, and MSPs and IT services, as well as\nother sectors, for probable intellectual property theft.\n\nIn early 2017, APT10 began [conducting attacks against global](https://www.pwc.co.uk/cyber-security/pdf/cloud-hopper-report-final-v4.pdf)\n[managed IT service providers (MSPs) that granted them](https://www.pwc.co.uk/cyber-security/pdf/cloud-hopper-report-final-v4.pdf)\nunprecedented access to MSPs and their customers’ networks.\nDuring this operation (dubbed “‘Cloud Hopper” because of the\ngroup’s use of popular western cloud-based services), APT10 utilized\nboth new malware (Quasar RAT, Trochilus, RedLeaves, ChChes) as\nwell as some familiar old tools (Poison Ivy, PlugX).\n\n[Most recently, on December 20, 2018, the U.S. Department of Justice](https://www.justice.gov/opa/pr/two-chinese-hackers-associated-ministry-state-security-charged-global-computer-intrusion)\n[charged two hackers associated with the Chinese Ministry of State](https://www.justice.gov/opa/pr/two-chinese-hackers-associated-ministry-state-security-charged-global-computer-intrusion)\nSecurity (MSS) with global computer intrusion campaigns targeting\nintellectual property. This indictment attributed the intrusions to\nAPT10, a group that had been conducting the malicious activities\nfor over a decade on behalf of the MSS, China’s civilian human\nintelligence agency. Some of the material included within the\nindictment corroborated information detailed in the Intrusion Truth\n[blog that provided strong evidence attributing APT10 to the Tianjin](https://intrusiontruth.wordpress.com/2018/08/15/apt10-was-managed-by-the-tianjin-bureau-of-the-chinese-ministry-of-state-security/)\nState Security Bureau, a provincial bureau of the Ministry of State\nSecurity. In the blog, Intrusion Truth identified APT10 as having\nutilized several Tianjin-based companies, including Huaying Haitai\nScience and Technology Development Co. Ltd. and Laoying Baichen\nInstruments Equipment Co. Ltd.\n\n\n-----\n\n_[U.S. Department of Justice indictment of APT10 threat actors. (Source: www.justice.gov)](https://www.justice.gov/opa/press-release/file/1121706/download)_\n\nThe use of suspected shell companies as a front for MSS-enabled\n[cyber activity isn’t a new observation, however. Our research from](https://www.recordedfuture.com/chinese-mss-behind-apt3/)\n[2017 concluded that Guangdong ITSEC (and therefore the MSS)](https://www.recordedfuture.com/chinese-mss-behind-apt3/)\ndirected the activities of a company named Boyusec, which was\nidentified as a shell company for APT3.\n\n_S_ _t d Ti_ _ji_ _St t S_ _it B_ _h_ _d_ _t_ _(S_ _I t_ _i_ _T_ _th)_\n\n\n-----\n\nThe December APT10 indictment noted that the group’s malicious\nactivities [breached at least 45 companies and managed service](https://www.fbi.gov/wanted/cyber/apt-10-group/)\nproviders in 12 countries, including Brazil, Canada, Finland, France,\nGermany, India, Japan, Sweden, Switzerland, the United Arab\nEmirates, the United Kingdom, and the United States.\n\n**About Visma**\n\nVisma offers software and services that simplify and digitize\ncore business processes in the private and public sector. The\nVisma group operates across the entire Nordic region along with\nBenelux, Central, and Eastern Europe. With 8,500 employees, more\n[than 850,000 customers, and a net revenue of NOK 8,537 million](https://www.visma.com/about-visma/organisation/the-visma-group/)\n(approximately $1 billion USD) in 2017, Visma is one of Europe’s\nleading software companies.\n\n**Intrusion Overview**\n\nRecorded Future’s Insikt Group has actively tracked APT10 for\nseveral years, focusing specifically on the group’s targeting of MSPs\nand global internet infrastructure providers since the Operation\nCloud Hopper report in 2017. We were particularly interested in\nidentifying whether any customers of the targeted MSPs were\nsubsequently compromised by APT10, given their potential access\nthrough compromised MSP networks.\n\nIn September 2018, one of our clients (and a supplier as well),\nVisma, reached out to us for assistance in investigating an incident\nuncovered on their network following a breach notification by\nRapid7. Visma provided us with malware samples and network logs\nfrom the event. Analysis of the data revealed that Visma’s Citrix\ninfrastructure had been probed and subsequently accessed using\nstolen credentials as early as August 17, 2018. This was followed\nby an initial exploitation, network enumeration, and malicious tool\ndeployment on various Visma endpoints within two weeks of initial\naccess. The theft of enterprise login credentials was conducted\nwithin two and a half weeks of initial access.\n\n\n-----\n\nOn August 30, 2018, APT10 deployed their first modified version\nof Trochilus that had its C2 communications encrypted using\nSalsa20 and RC4-encrypted Trochilus variant seen in the wild. This\nsample, similar to other Trochilus samples, was deployed using a\nDLL sideloading method utilizing three files, uploaded to the same\n[folder on the victim machine as identified in US-CERT advisory TA17-](https://www.us-cert.gov/ncas/alerts/TA17-117A)\n[117A (last revised on December 20, 2018). This method involves the](https://www.us-cert.gov/ncas/alerts/TA17-117A)\nuse of a legitimate binary (File 1) used to load a malicious DLL (File\n2). The malicious DLL is renamed to match the name of an expected\nDLL to be loaded by the executable. The malicious DLL then decrypts\nand decompresses shellcode contained within a third file placed by\nthe attackers in the same temporary folder. The configuration file\nthen loads the Trochilus payload into memory by injecting it into a\nvalid system process. This method of malicious payload installation\n[is a well-documented TTP of APT10.](https://www.pwc.co.uk/cyber-security/pdf/cloud-hopper-annex-b-final.pdf)\n\nThe attackers used Mimikatz (pd.exe) to enable credential theft and\nmade use of scheduled tasks via the Microsoft BITSAdmin utility\nto transfer files from their C2 to the Visma network. The attackers\npreferred to upload their malicious tooling to the C:\\ProgramData\\\ntemp or C:\\ProgramData\\media directories and executed commands\nusing batch files (x.bat). A full list of the filenames of the suspected\nattacker tooling can be found in the report appendices.\n\n_BITSAdmin example commands used by the attackers._\n\nIn order to exfiltrate the compromised data, the attackers employed\ncustom malware that used Dropbox as its C2. They also used\nWinRAR and cURL for Windows, both often renamed, to compress\nand upload the exfiltrated files from the Visma network to the\nDropbox API.\n\nOur research partner Rapid7 investigated the Dropbox use and\nfound that the attackers had used the same account to store\nexfiltrated data from a global apparel company. They also identified\n\n\n-----\n\nbroadly similar TTPs being used in the attack against a U.S. law firm\nspecializing in intellectual property law. The firm has a dedicated\nChina practice aimed at assisting Chinese companies entering the\nU.S. market.\n\nRapid7’s investigation revealed the law firm was first targeted in\nlate 2017, followed by the apparel company a few months later,\nand finally, the Visma attack in August 2018. In one of the attacks,\nRapid7 identified the attackers escaping a Citrix application in order\nto run the payload script on the victim desktop. Interestingly, in all\nthree attacks, the targeting of Citrix remote desktops was a common\nthread. Additionally, the same DLL sideloading technique observed\nin the Visma attack was used, and many of the tools deployed by\nthe attackers shared naming similarities as well (1.bat, cu.exe,\nss.rar, r.exe, pd.exe). Most interestingly, Rapid7 observed the use\nof the Notepad++ updater gup.exe as a legitimate executable to\nsideload a malicious DLL (libcurl.dll) in order to deploy a variant\nof the UPPERCUT backdoor (also known as ANEL). APT10 used\nthis approach to deploy UPPERCUT when [targeting Japanese](https://www.fireeye.com/blog/threat-research/2018/09/apt10-targeting-japanese-corporations-using-updated-ttps.html)\n[corporations in July 2018.](https://www.fireeye.com/blog/threat-research/2018/09/apt10-targeting-japanese-corporations-using-updated-ttps.html)\n\n**The Visma Attack**\n\nAPT10 actors gained initial access to the Visma network around\nAugust 17, 2018. Examination of network logs revealed an employee’s\ncredentials were stolen and used to authenticate to the network\noutside of her normal working hours. While we are confident that\nAPT10 actors gained access to the Visma network in August using\nstolen employee Citrix remote desktop credentials, it is not clear\nhow or when these credentials were initially compromised.\n\nThroughout August 2018, the APT10 actors regularly logged in to\nthe Visma network via accessible Citrix servers using two valid user\naccounts. The times of the logins were consistent with a GMT+8\ntimezone, indicative of typical Tianjin, China working hours. On\neach occasion, the logins were from one of eight VPN endpoints\nthat resolved to IPs in the following tightly defined subnets:\n\n\n-----\n\n|Subnet|Registration|AS|\n|---|---|---|\n|104.237.86.0/24|Los Angeles Cloud, HostAware|AS32181 — GigeNET|\n|45.56.155.0/24|VPN Consumer Network|AS32181 — GigeNET|\n|45.62.52.0/24|Los Angeles Cloud, HostAware|AS32181 — GigeNET|\n|173.239.198.0/24|VPN Consumer Network|AS36351 — SoftLayer Technologies Inc.|\n\n\nVPN Consumer Network is an ambiguous Panama-registered entity.\nBased on information in WHOIS registration records, the website for\nthe company is vpnconsumer.com, which is a nondescript landing\npage only containing the abuse contact details and a physical address\nin Panama. BGP routing information shows that the organization\nmanages 44/24 subnets hosted around the world, many of which\nresolve to low-cost VPN services, such as ExpressVPN.\n\nInsikt Group analysis of network metadata to and from the VPN\nendpoint IPs revealed consistent connectivity to Citrix-hosted\ninfrastructure from all eight VPN endpoint IPs starting on August\n17, 2018 — the same date the first authenticated login to Visma’s\nnetwork was made using stolen credentials.\n\nAfter almost two weeks, on August 30, 2018, APT10 attackers\nused their access to the network to move laterally and made their\nfirst deployment of an RC4- and Salsa20-encrypted variant of the\nTrochilus malware using a [previously associated DLL sideloading](https://www.pwc.co.uk/cyber-security/pdf/cloud-hopper-annex-b-final.pdf)\ntechnique. Two separate infection chains leveraging this specific\nDLL sideloading technique were identified on the Visma network\nusing legitimate known good binaries that had DLL search-order\npath issues. This means that APT10 actors had two separate access\npoints into the Visma network.\n\n**Infection Chain 1: August 30, 2018**\n\nOnce on the Visma network, APT10 attackers used the Microsoft\nBITSAdmin CLI tool to copy malicious tools from a suspected\nattacker-controlled C2 hosted on 173.254.236[.]158 to the \\\nProgramData\\temp\\ directory on the infected host.\n\n\n-----\n\nThe copied files included:\n\n - A legitimate binary for the uninstaller for PDF printing\n\napplication PDF-Xchange 2011 Lite DE, renamed from\nunins000.exe to CASTSP.exe (f6e0f076e27391a6e6eb23f23f77c\n2ff078488875113df388640aca8bf4dd64b)\n\n - An accompanying malicious DLL, version.dll (10182f0e64b765\n\ndb989c158402c76eb1e0e862cab407f7c5cec133d8e5cb73e3)\n\n - A DES-encrypted shellcode configuration containing the\n\nTrochilus implant into the same folder (42b5eb1f77a25ad73\n202d3be14e1833ef0502b0b6ae7ab54f5d4b5c2283429c6)\n\nAfter the files were copied across the attacker-executed CASTSP.exe,\nthis file sideloaded and ran version.dll, which in turn decrypted and\ndecompressed the encrypted shellcode and injected the Trochilus\npayload into memory.\n\n\nversion.dll decrypts\nshellcode and injects\nTrochilus payload\ninto memory\n\n\nTrochilus variant deployed\nin memory, with C2\ncommunications encrypted\nusing XOR, RC4, and Salsa20\n\n\nLegitimate binary for\nPDF-Xchange 2011 Lite DE\nuninstaller, unins000.exe,\nrenamed to CASTSP.exe\nby attackers\n\n_Infection Chain 1._\n\n\nCASTSP.exe executed\nwhich sideloads\nversion.dll\n\n\n**Infection Chain 2: September 4, 2018**\n\nA few days later, APT10 used an almost identical approach used\nduring Infection Chain 1 to deploy Trochilus onto another part\nof Visma’s network. While the deployed DLL and the encrypted\nshellcode were named differently, the underlying method\nof malware installation was the same as Infection Chain 1.\nThe files remotely copied into C:\\ProgramData\\temp\\ using\nBITSAdmin included:\n\n - Another dropper renamed to “CASTSP.exe” that this time\n\nwas a legitimately signed Microsoft Visual Studio binary\nTailoredDeploy.Host.exe (also known as TailoredDeploy.exe)\n(fc6a130504b54fa72cfc104c656fe2cd92d7998f42ca064e22\n167e1d402a1514)\n\n\n-----\n\n - A malicious DLL, vcruntime140.dll (eed0c7f7d36e75382c83\n\ne945a8b00abf01d3762b973c952dec05ceccb34b487d)\n\n - A DES-encrypted Trochilus payload\n\n(e6280de09f9adf79212409529eb25c0c2ea73e33a50281e222\n28a3db3998eecb)\n\nThe execution method was identical: CASTSP.exe sideloaded and\nran vcruntime140.dll, which decrypted and decompressed the\nencrypted shellcode configuration and injected the Trochilus\npayload into a system process in-memory on the host machine.\n\n\nvcruntime140.dll\ndecrypts shellcode and\ninjects Trochilus\npayload into memory\n\n\nTrochilus variant\ndeployed in memory, with\nC2 communications\nencrypted using XOR,\nRC4, and Salsa20\n\n\nLegitimate binary for\nMicrosoft Visual Studio,\nTailoredDeploy.Host.exe,\nrenamed to CASTSP.exe\nby attackers\n\n_Infection Chain 2._\n\n#### Malware Analysis\n\n\nCASTSP.exe executed\nwhich sideloads\nvcruntime140.dll\n\n\nThe malware sets used for both infection chains are nearly identical\nboth in infection method and code structure. Because the malware\nfor both infection chains were so similar, it is only necessary to\ninclude the in-depth analysis for one chain here, so we focused on\nInfection Chain 1. It included the binaries below:\n\n - CASTSP.exe: A valid and signed application that utilizes DLL\n\nsideloading to execute the malicious DLL, “version.dll”\n\n - Version.dll: Main functionality of “Version.dll” is to decrypt and\n\nexecute the Trochilus payload\n\n - CZYSOYKPOIKKZGUFOIUI: DES-encrypted Trochilus payload\n\n**Trochilus Implant**\n\nThe Trochilus loader, version.dll, has four entry points, as\nshown below. The malicious entrypoint called by CASTSP.exe is\nDllEntryPoint.\n\n\n-----\n\nAfter version.dll runs, it loads the file CZYSOYKPOIKKZGUFOIUI\ninto memory. The file “CZYSOYKPOIKKZGUFOIUI” is 387,094 bytes\nof binary code that is not human-readable.\n\nAfter the file is loaded, the next function, sub_6a351000, starts the\ndecryption routine for CZYSOYKPOIKKZGUFOIUI. The file is DESencrypted and the key can be identified being loaded into memory\nat the start of the decryption routine.\n\n\n-----\n\nOnce the payload is decrypted, version.dll creates a new process\nin a suspended state and writes the Trochilus payload into the\nsuspended process. Next, version.dll resumes the process,\nexecuting the Trochilus payload.\n\n_Trochilus attribution._\n\n\n-----\n\nThis variant of Trochilus is significantly different from some of the\nreported variants.[1] The C2 infrastructure, network communications,\nand encryption are different from prior versions, but the code\nsimilarities and the use of DLL sideloading demonstrate that this\nis just another variant of Trochilus. First, the libraries below are\nincluded in the Trochilus variant and are known to be a part of the\n[source code upon which Trochilus is based on.](https://github.com/m0n0ph1/malware-1/tree/master/Trochilus)\n\n - SelfDestruction.cpp\n\n - MySocket.cpp\n\n - CommManager.cpp\n\n - Common.cpp\n\n - Main.cpp\n\n - Manager.cpp\n\n - ServiceManager.cpp\n\n - TCPComm.cpp\n\n - UDPComm.cpp\n\nSecond, the unencrypted C2 beacon, _msgid.23.__serial.0.clientid.\nxxxxxxxxxxxxxxx, is a well-defined component of the Trochilus\nsource code.\n\nThe capabilities of Trochilus are well documented in other research\nreports, but the C2 infrastructure for this variant uses a combination\nof XOR, RC4, and Salsa20, which is different from what has previously\nbeen reported for Trochilus.\n\n**Command and Control Infrastructure**\n\nThe C2 domain www.miphomanager[.]com is hardcoded, and after\na successful DNS request for the IP address, the Trochilus implant\nwill use that IP address for communication.\n\n**[1 https://www.us-cert.gov/ncas/alerts/TA17-117A, https://www.carbonblack.](https://www.us-cert.gov/ncas/alerts/TA17-117A)**\n[com/2017/05/09/carbon-black-threat-research-dissects-red-leaves-malware-leverages-dll-](https://www.carbonblack.com/2017/05/09/carbon-black-threat-research-dissects-red-leaves-malware-leverages-dll-side-loading/)\n[side-loading/, https://blogs.jpcert.or.jp/en/2017/04/redleaves---malware-based-on-open-](https://www.carbonblack.com/2017/05/09/carbon-black-threat-research-dissects-red-leaves-malware-leverages-dll-side-loading/)\n[source-rat.html](https://blogs.jpcert.or.jp/en/2017/04/redleaves---malware-based-on-open-source-rat.html)\n\n\n-----\n\nThe encoding and encryption routines used in this variant are\ndifferent from other variants and use three stages of encryption.\nOther variants have typically used XOR encoding with RC4 encryption\nto obfuscate C2 communication.\n\n**Stage 1: Rolling XOR Function**\n\nThe first stage is a simple rolling XOR function. The rolling XOR key\nis computed by taking two initial values, Constant 1 and Constant\n2, and adding them together. The result is then divided against the\ndivisor 0xff. The remainder of this result is used as the XOR key. On\nthe second iteration, Constant 1 is now saved as Constant 2, and\nConstant 2 becomes the remainder from the previous operation.\nThey are added together and again divided by the divisor 0xff to\nproduce the next XOR key. This process repeats until the end of\nthe cleartext string. A Python script is provided below showing this\nencoding function.\n\n\n-----\n\nOur analysis revealed that the “__msgid.23.” cleartext string below\nwas sent to the XOR function above.\n\n**Stage 2: RC4 Encryption**\n\nThe resulting data then goes to the second stage, which is RC4\nencryption using the hard-coded string NASDKJF7832Hnkjsadf87\n8UHds89iujkhNHKJDHJDH8UIYE98uihwjshewde8w. The main\nroutine shown below takes the key and then sends it to the function\nsub_B49252, which initializes the key-scheduling algorithm (KSA)\nand pseudo-random generation algorithm (PRGA), which are the\ntwo key components of RC4 encryption.\n\n\n-----\n\n**Stage 3: Salsa20 Encryption**\n\nFor the final phase, the resulting data from the RC4 encryption is\nthen encrypted again, this time with Salsa20. Salsa20 is another\nstream cipher that encrypts data in 64-byte blocks. Salsa20 uses a\nsecret key and nonce to initialize the encryption. These values are\nhard-coded and are:\n\n - Secret Key: 0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8,0x9,0xA,0xB,0xC,\n\n0xD,0xE,0xF,0x10\n\n - Nonce: 0x65,0x66,0x67,0x68,0x69,0x6A,0x6B,0x6C (“efghijkl”)\n\n\n-----\n\nAfter the message is encrypted, it is then sent via an HTTP POST to\nthe C2 host, which in this case is the domain www.miphomanager[.]\ncom. The HTTP headers are provided in the figure below.\n\n\n-----\n\n**Infrastructure**\n\nDNS log data revealed that requests were made for the malicious\nTrochilus C2 domain, www.miphomanager[.]com, as early as August\n30, 2018 — only two weeks after Visma was initially compromised\non August 17, 2018. This slight delay may point to the handing over\nof active exploitation duties to other operator(s) in a multi-team\nAPT10 effort within the Ministry of State Security for the attack.\n\nAccording to WHOIS information, the malicious \"miphomanager\"\ndomain was registered with a relatively small Bahamas-based\ndomain registrar, internet.bs. This registrar is widely noted to host\n[a disproportionate number of rogue or malicious websites, with the](http://feedproxy.google.com/~r/KrebsOnSecurity/~3/pv1CQM15qmg/)\n[registrar aggressively marketing itself as an “offshore” registrar. Other](http://feedproxy.google.com/~r/KrebsOnSecurity/~3/pv1CQM15qmg/)\nexamples of malicious infrastructure registered with internet.bs\n[include domains for APT28’s VPNFilter malware campaign and the](https://www.slickrockweb.com/welcome-to-the-fancy-bear-den.php)\n[registration of the cyber-berkut[.]org domain that was affiliated](https://threatconnect.com/blog/russia-hacks-bellingcat-mh17-investigation/)\nwith the pro-Russian and potentially Russian state-linked threat\nactor CyberBerkut.\n\nThe registrant organization name was privacy protected using Whois\nPrivacy Corp, and the registered name servers for the malicious C2\nwere listed as:\n\n - Ns-canada.topdns[.]com\n\n - Ns-uk.topdns[.]com\n\n - Ns-usa.topdns[.]com\n\nInternet.bs and the name servers listed above were noted in the\n[registration of a malicious C2 used in a KHRAT campaign targeting](https://unit42.paloaltonetworks.com/unit42-updated-khrat-malware-used-in-cambodia-attacks/)\n[Cambodia. KHRAT is a backdoor trojan purported to be used with](https://unit42.paloaltonetworks.com/unit42-updated-khrat-malware-used-in-cambodia-attacks/)\nthe China-linked cyberespionage group DragonOK.\n\nAll three name servers appear in Recorded Future with an unusual\nrisk rating as they appear in the “Bambenek Consulting C&C\nNameserver Blocklist” threat list, because of their prevalence in\nbeing associated with a Zeus-based banking trojan, Sphinx.\n\n\n-----\n\n**Credential Harvesting and Exfiltration**\n\nDuring our investigation, we also found evidence of a legitimate\ndecompression utility typically packaged with Java named\n“unpack200.exe” being executed on the Visma network. This utility\nsideloaded Mimikatz (pd.exe) and enabled credential theft from\nVisma users. Interestingly, the same combination of unpack200.\nexe to deploy Mimikatz was used by the same attackers in both the\napparel company and U.S.-based law firm breaches.\n\nUsing the newly acquired credentials, the attacker accessed Visma’s\nMicrosoft Active Directory domain controller, deployed Trochilus,\nand made a copy of the “NTDS.DIT” database file containing Active\nDirectory data for Visma’s corporate network, including password\nhashes for all users in the domain.\n\nThe NTDS.DIT file and accompanying stolen data was then packaged\nup using a renamed WinRAR executable (r.exe) that was transferred\nacross by the attacker who then used cURL for Windows (renamed\nto “CU.exe”) to upload the exfil to content.dropboxapi.com. The\nRAR files followed a naming convention of a short run of repeating\ncharacters (for example, kkk.rar, ss.rar, pp.rar, dds.rar, gggg.rar,\netc).\n\nRapid7 research revealed the exfiltrated content from Visma was\nuploaded to a Dropbox account that contained files from another\nincident related to the compromise of an international apparel\ncompany that they were investigating.\n\n**US-Based Law Firm Attack**\n\nIn late 2017, Rapid7 responded to a breach at a U.S.-based law firm.\nThe attacker first gained access to the victim environment through\nCitrix servers. Once inside the victim network, the attacker deployed\ntheir own customized malware and also used known good binaries\nthat have DLL search order hijacking issues in order to perform DLL\nsideloading to execute customized versions of Mimikatz in order\nto retrieve passwords. The filename for the custom malware was\n“ccSEUPDT.exe” (MD5: d8e37f07fdc9827871f0f959519275e1), a\nlegitimate Symantec Security Submission Engine Update Module\nbinary. The custom malware also would have a DLL in the same staging\n\n\n-----\n\ndirectory and a randomized 15-character uppercase and lowercase\nalpha character set filename without an extension that contained the\nshellcode. The attacker used unpack200.exe (MD5: 6807be8466955b\nafffa568b6da0e785c), a decompression program that\ncomes with Java 8 and their copy of Mimikatz was placed\ninto MSVCR100.DLL (MD5: c8ea12ee884f274ca35fa54a073\ndf130).\n\nThese methods of initial ingress into the victim networks and the\nmethod of obtaining passwords remained consistent TTPs across\nall victims. The DLL sideloading technique can evade application\nwhitelisting and antivirus software. However, if deployed, systems\nthat perform process.start creation would log the command line\nbeing passed to the binary and could be reviewed, and then\nsignatures created that look for the common flags could be passed\nto Mimikatz. The attacker would also move laterally by mounting the\nremote drive on a system, copying “1.bat” to it, use task scheduler\nto execute, and then delete the batch script.\n\nIn order to perform exfiltration of the stolen data, the attacker used\ncommon file compression utilities (rar.exe) to create archives of\nthe information they intended to exfiltrate, and then used common\ncommand line-based web clients (curl.exe) to transfer the stolen\ndata to a cloud-based storage provider (Dropbox). This TTP for data\nexfiltration remained consistent across all victims.\n\nTo maintain access to the victim network from the external\npublic internet, the attacker deployed password-protected\nASP eval webshells (Filename “iisstart.aspx,” SHA256:\n243d47fc2a24b391e1153d5c7807c6e5de51aba65fc79465d7b3e\n5c64d5fac41) within the client environment in order to maintain\naccess.\n\n_Server-side ASPX payload of the China Chopper webshell. (Source: Rapid7)_\n\nThis resembled the server-side ASPX payload of the China Chopper\nwebshell [documented previously. Uploads to VirusTotal in late](https://www.fireeye.com/blog/threat-research/2013/08/breaking-down-the-china-chopper-web-shell-part-i.html)\nAugust 2018 resembling the same filename, iisstart.aspx, indicate\nthe deployed webshell was likely a version of the China Chopper\nwebshell known to have been used by several Chinese threat actors.\n\n\n-----\n\nThe attacker also used TeamViewer in order to maintain remote\naccess to compromised systems within the victim environment.\n\n**International Apparel Company Attack**\n\nIn early 2018, Rapid7 identified that the attackers compromised an\napparel company, based upon detections and intelligence gathered\nfrom the U.S.-based law firm breach. The attacker gained access to\nthe victim’s internet-accessible Citrix systems and authenticated to\nthem from networks associated with low-cost VPN providers owned\nby VPN Consumer Network. Rapid7 again observed the attackers\ndropping payloads named “ccSEUPDT.exe.” The attackers used\nidentical TTPs for executing malware and Mimikatz as observed\nbefore, by using DLL sideloading with known good binaries that had\nDLL search order path issues. The attackers used the Notepad++\nupdater GUP.exe (MD5: f5322b2f18605674b9a0c1757de5fd94),\nthe Java archive decompression utility unpack200.exe\n(MD5: 6807be8466955bafffa568b6da0e785c), renamed\nfrom “coInst.exe,” and Norton Identity Safe binary CASRTSP.\nexe (MD5: 1e3a57cff7cba8732364c26f4bbdcbe2). These\nbinaries were used to load malware from DLL files\nMSVCR100.DLL (MD5: 5739c1f17503e21e56667d53ea823401)\nand libcurl.dll (MD5: 8f07160febdb240909b27aa519b\nba575). Rapid7 reviewed malware discovered in the victim’s\nenvironment and found implants that used Dropbox as the C2.\nThe attackers used the same method of lateral movement by\nmounting the remote drive on a system, copying 1.bat to it, using\ntask scheduler to execute the batch script, and finally, deleting the\nbatch script.\n\nFor exfiltration of stolen data, the attacker used WinRAR and\nrenamed “rar.exe” to “r.exe” to create archives, upload them with\n“curl.exe” (renamed to “c.exe”), and again, use the cloud storage\nprovider Dropbox. Rapid7 discovered that additional data was\nplaced into the Dropbox accounts under control of the attacker\nduring the compromise and was able to attribute data that was\nplaced into it as being owned by Visma. Rapid7 then provided a\nbreach notification to Visma to alert them to this compromise in\nSeptember 2018.\n\n\n-----\n\n#### Outlook\n\nWe identified three victims of cyberespionage operations since\nlate 2017 across the managed IT service provider, retail, and legal\nsectors. The targeted sectors vary significantly, indicating a wide\nscope of targeting for the group. We assess with high confidence\nthat the attacks were conducted by Chinese MSS threat actor APT10,\nbased on the evidence outlined in this report, summarized below:\n\n1. The use of a variant of the Trochilus malware. While the\n\nvariant has not been noted publicly previously, Trochilus\n[is widely used by APT10.](https://www.crowdstrike.com/blog/two-birds-one-stone-panda/)\n\n2. The use of legitimate binaries to sideload malicious DLLs\n\nthat decrypt and decompress shellcode configuration files\ncontaining a Trochilus payload.\n\n3. The use of Notepad++ updater (filename “gup.exe”) to load\n\nmalicious DLL (libcurl.dll) in the deployment of the APT10\nbackdoor, UPPERCUT.\n\n4. Extensive use of command-line tools including, but not\n\nlimited to, Mimikatz, cURL for Windows, BITSAdmin, and\nWinRAR, to perform actions on-host.\n\n5. The targeting of a Norwegian MSP, which enabled potential\n\naccess to an extensive customer base. We believe that the\nAPT10 targeting of Visma is an extension of their 2017 Cloud\nHopper operation (which victimized some of the world’s\nlargest MSPs) and has continued into late 2018.\n\n6. The unauthorized access to Citrix remote desktop clients at\n\nVisma using stolen credentials occured at times\ncorresponding to Tianjin working hours (GMT +8).\n\nWe believe APT10 is the most significant known Chinese\nstate-sponsored cyber threat to global corporations. Their\nunprecedented campaign against MSPs, [alleged to have](https://www.reuters.com/article/us-china-cyber-hpe-ibm-exclusive/exclusive-china-hacked-hpe-ibm-and-then-attacked-clients-sources-idUSKCN1OJ2OY)\n[included some of the largest MSPs in the world, in order to](https://www.reuters.com/article/us-china-cyber-hpe-ibm-exclusive/exclusive-china-hacked-hpe-ibm-and-then-attacked-clients-sources-idUSKCN1OJ2OY)\nconduct secondary attacks against their clients, grants the\nChinese state the ability to potentially access the networks of\nhundreds (if not thousands) of corporations around the world.\n\n\n-----\n\nThis campaign brings to light further evidence supporting\nthe assertions made by the Five Eyes nations, led by the U.S.\nDepartment of Justice indictment against APT10 actors outlining the\nunprecedented scale of economic cyberespionage being conducted\nby the Chinese Ministry of State Security. Crucially, the variety\nof businesses targeted prove that these campaigns are being\nconducted against corporations across the commercial spectrum,\naimed at undermining international norms in trade to erode the\ncompetitive advantage of companies that have invested heavily in\npatented technology.\n\nThis report, alongside the plethora of other reporting on APT10\noperations, acutely highlights the vulnerability of organizational\nsupply chains. Often, third parties in the supply chain are less likely\nto adopt high-end, expensive security measures, and therefore offer\nan attacker a convenient access vector to target interconnected\norganizations. Also, the targeting of cloud providers exploits the\ntrust companies place in the security of the cloud services they use.\n\nBased on publicly available information, we assess that this intrusion\nwas conducted by the group that is known as APT10. However,\nduring the course of this investigation, we have had privileged\nconversations that lead us to believe that in the future, portions of\nwhat is now known as APT10 will be recategorized as a new group.\nThere is insufficient data at this time to make that distinction.\n\n#### Network Defense Recommendations\n\nRecorded Future recommends organizations conduct the following\nmeasures outlined in this section in conjunction with the advice\npublished by US-CERT[2] and the U.K.’s NCSC[3] when defending against\nAPT10 attempts to gain network access.\n\n - Configure your intrusion detection systems (IDS), intrusion\n\nprevention systems (IPS), or any network defense mechanisms\nin place to alert on — and upon review, consider blocking\nillicit connection attempts from — the external IP addresses\nand domains listed in Appendix A.\n\n**[2 https://www.us-cert.gov/ncas/alerts/TA17-117A, https://www.us-cert.gov/APTs-Targeting-](https://www.us-cert.gov/ncas/alerts/TA17-117A)**\n[IT-Service-Provider-Customers, https://www.us-cert.gov/ncas/alerts/TA18-276B](https://www.us-cert.gov/APTs-Targeting-IT-Service-Provider-Customers)\n\n**3** [https://www.ncsc.gov.uk/content/files/protected_files/article_files/APT10%20alert%20](https://www.ncsc.gov.uk/content/files/protected_files/article_files/APT10%20alert%20v2_0.pdf)\n[v2_0.pdf](https://www.ncsc.gov.uk/content/files/protected_files/article_files/APT10%20alert%20v2_0.pdf)\n\n\n-----\n\n- Implement the provided SNORT rules in Appendix B into your\n\nIDS and IPS appliance and investigate any alerts generated for\nactivity resembling the TTPs outlined in this report on APT10.\n\n- Conduct regular Yara scans across your enterprise for the new\n\nrules listed in Appendix C and those listed in the official U.S.\nand U.K. government advisories listed above.\n\n- Consider blocking any connection attempts emanating from\n\nIPs resolving to “VPN Consumer Network” (listed in Appendix\nB) and consider implementing a VPN whitelisting policy based\non approved vendors.\n\n- Detection of potential ASP eval webshells can be difficult, but\n\ncan be accomplished by deploying file integrity monitoring\nof the web root directories on all servers with a client\nenvironment.\n\n- Detection of exfiltration based on network flow data would be\n\ndifficult if the attacker chose to use the same cloud storage\nprovider that the victim has standardized upon. However, if\nSSL is proxied for monitoring, signatures can be created to\nidentify this activity by checking the user agent or method\nof client header construction against the Dropbox client\napplications themselves.\n\n- Ensure you have DNS response policy zones enabled for your\n\nenterprise. If so, consider detecting, alerting, and blocking\nrequests for the nameservers below associated with the\ndisproportionately malicious domain registrar internet.bs:\n\n   - ns-uk.topdns.com\n\n   - ns-usa.topdns.com\n\n   - ns-canada.topdns.com\n\n\n-----\n\n#### Appendix A — Indicators of Compromise\n\n\nIPv4\n173.254.236[.]158\n104.237.86[.]157\n104.237.86[.]183\n173.239.198[.]167\n45.56.155[.]117\n45.56.155[.]143\n45.56.155[.]147\n45.62.52[.]42\n45.62.52[.]7\n45.76.30[.]127\n\nDomains\nwww.miphomanager[.]com\nwww.llpsearch[.]com\n\nHashes\nMD5: C8ea12ee884f274ca35fa54a073df130 - MSVCR100.dll\nMD5: 8f07160febdb240909b27aa519bba575 - libcurl.dll\n\nSHA256: 42b5eb1f77a25ad73202d3be14e1833ef0502b0b6ae7ab54f5d4b5c2283429c6 - CZYSOYKPOIKKZGUFOIUI (Infection\nChain 1)\nSHA256: F6e0f076e27391a6e6eb23f23f77c2ff078488875113df388640aca8bf4dd64b - CASTSP.exe (Infection Chain 1)\nSHA256: 10182f0e64b765db989c158402c76eb1e0e862cab407f7c5cec133d8e5cb73e3 - version.dll (Infection Chain 1)\n\nSHA256: Fc6a130504b54fa72cfc104c656fe2cd92d7998f42ca064e22167e1d402a1514 - CASTSP.exe (Infection Chain 2)\nSHA256: E6280de09f9adf79212409529eb25c0c2ea73e33a50281e22228a3db3998eecb - RUTLFJPBTJSFZZAOJTYP (Infection Chain\n2)\nSHA256: Eed0c7f7d36e75382c83e945a8b00abf01d3762b973c952dec05ceccb34b487d - vcruntime140.dll (Infection Chain 2)\nSHA256: ad116485f9184c85fd28331edae629c41fc39ec5123f41b15f6507b139a883c1 - unpack200.exe\nSHA256: C77535e19e5655f6ef72de3b2318e580095ca396c4383287cf8b5d4896235756 - gup.exe\nSHA256: Bfeb6efee4891de135431091079e659631376953a46065f7e44335df10d16425 - CASRTSP.exe (renamed from coInst.exe)\nSHA256: 5c5618e680bc45654dd55f161f195afbac98a7e111e4ef536ed811656582168d - MSVCR100.dll\n\nFilenames\nat.exe\nat.exe.cfg\nC.bat\nCU.EXE\nlg.exe\nps.exe\nr.exe\nat.exe\nCU.EXE\n1.bat\nat.exe.cfg\nC.bat.cfg\ndd.dmp\ndds.rar\nlg.exe\nlg.exe.cfg\nns.exe\nns.exe.cfg\npd.exe\nsam.save\nss.rar\nvcruntime140.dll\nversion.dll\nunpack200.exe\nCASTSP.exe\nRUTLFJPBTJSFZZAOJTYP\nCZYSOYKPOIKKZGUFOIUI\nLibcurl.dll\nMsvcr100.dll\nGup.exe\nCASRTSP.exe\n\n\n-----\n\n#### Appendix B — Network Monitoring\n\nRedLeaves Snort Rules sourced from US-CERT alert TA17-117A\n\nalert tcp any any -> any any (msg: “REDLEAVES Implant”; content: “|00 00 7a 8d 9b dc|”; offset:\n2; depth: 6; content: “|00 00|”; offset: 10; depth: 2; sid: 314;)\n\nIP Ranges Resolving to “VPN Consumer Network”\n\n|98.159.233.0/24|45.56.149.0/24|173.244.55.0/24|104.238.45.0/24|\n|---|---|---|---|\n|85.203.23.0/24|45.56.148.0/24|173.239.199.0/24|104.238.32.0/24|\n|46.244.28.0/24|45.56.146.0/24|173.239.198.0/24|104.194.220.0/24|\n|45.56.158.0/24|45.56.143.0/24|173.239.197.0/24|104.194.218.0/24|\n|45.56.157.0/24|45.56.142.0/24|173.239.195.0/24|104.194.203.0/24|\n|45.56.156.0/24|45.56.141.0/24|157.97.121.0/24|104.143.95.0/24|\n|45.56.155.0/24|45.56.140.0/24|104.37.31.0/24|104.143.92.0/24|\n|45.56.154.0/24|45.56.136.0/24|104.37.30.0/24|104.143.84.0/24|\n|45.56.153.0/24|45.41.147.0/24|104.238.62.0/24||\n|45.56.152.0/24|45.41.145.0/24|104.238.59.0/24||\n|45.56.151.0/24|45.41.144.0/24|104.238.58.0/24||\n|45.56.150.0/24|185.198.240.0/24|104.238.51.0/24||\n\n\n-----\n\n#### Appendix C — Yara Rules\n\n\nimport “pe”\n\nrule YARA_CN_APT10_Trochilus_RC4Salsa20_decrypted_payload\n{\nmeta:\ndescription = “Rule to identify Trochilus variant configured with RC4+Salsa20 encrypted C2 comms used by APT10 in 2018”\nauthor = “Insikt Group, Recorded Future”\ntlp = “white”\ndate = “2019-01-10”\nhash1 = “42b5eb1f77a25ad73202d3be14e1833ef0502b0b6ae7ab54f5d4b5c2283429c6”\nstrings:\n$s1 = “NASDKJF7832Hnkjsadf878UHds89iujkhNHKJDHJDH8UIYE98uihwjshewde8w”\n$s2 = “www.miphomanager.com”\n$s3 = {01 02 03 04 05 06 07 08 09 0a 0b 0c 0d 0e 0f 10} // Trochilus Salsa20 secret key\n$s4 = {65 06 06 67 06 08 69 06 0a 6b 06 0c} // Trochilus Salsa20 Nonce\ncondition:\n( uint16(0) == 0x5a4d and filesize < 1000KB and ( 2 of them ) )\n}\n\n\nrule YARA_CN_APT10_Trochilus_vcruntime140_dll_injector\n{\nmeta:\ndescription = “Malicious DLL vcruntime140.dll launched using benign CASTSP.exe to inject encrypted shellcode containing\nTrochilus payload”\nauthor = “Insikt Group, Recorded Future”\ntlp = “white”\ndate = “2019-01-16”\nhash1 = “eed0c7f7d36e75382c83e945a8b00abf01d3762b973c952dec05ceccb34b487d”\nstrings:\n$s1 = “vcruntime140.dll” fullword ascii\n$s2 = “AppPolicyGetProcessTerminationMethod” fullword ascii\n$s3 = “CASTSP.exe” fullword ascii\n$s4 = “operator co_await” fullword ascii\n$s5 = “api-ms-win-appmodel-runtime-l1-1-2” fullword wide\n$s6 = “<!<(<3<=<E<” fullword ascii /* hex encoded string ‘>’ */\n$s7 = “RUTLFJPBTJSFZZAOJTYP” fullword ascii\ncondition:\nuint16(0) == 0x5a4d and filesize < 300KB and\n( pe.imphash() == “c326c208bc65e6309413d8e699062a39” or all of them )\n}\n\n\nrule YARA_CN_APT10_Trochilus_version_dll_injector {\nmeta:\ndescription = “Malicious DLL version.dll launched using benign CASTSP.exe to inject encrypted shellcode containing\nTrochilus payload”\nauthor = “Insikt Group, Recorded Future”\ntlp = “white”\ndate = “2019-01-16”\nhash1 = “10182f0e64b765db989c158402c76eb1e0e862cab407f7c5cec133d8e5cb73e3”\nstrings:\n$s1 = “AppPolicyGetProcessTerminationMethod” fullword ascii\n$s2 = “CASTSP.exe” fullword ascii\n$s3 = “(p!xLq {Lp ‘Lq h*r!iLq h*t!`Lq h*u!tLq G+y!~Lq G+u!xLq G+q!zLq G+s!zLq Rich{Lq “ fullword ascii\n$s4 = “operator co_await” fullword ascii\n$s5 = “api-ms-win-appmodel-runtime-l1-1-2” fullword wide\n$s6 = “CZYSOYKPOIKKZGUFOIUI” fullword ascii\ncondition:\nuint16(0) == 0x5a4d and filesize < 300KB and\n( pe.imphash() == “0df4d1c641594cfb0df9e8869fa35db8” or all of them )\n}\n\n\n-----\n\nrule YARA_CN_APT10_UPPERCUT_libcurl_injector {\nmeta:\ndescription = “Malicious DLL libcurl.dll launched using benign GUP.exe to inject UPPERCUT payload by APT10 in 2018\ncampaign”\nauthor = “Insikt Group, Recorded Future”\ntlp = “white”\ndate = “2019-01-16”\nhash1 = “465c4e72580f62a340e0555afc857a79ad8b9d86de228efe3627f26690cc45f7”\nstrings:\n$s1 = “hemas.microsoft.com/SMI/2005/WindowsSettings\\”>true</dpiAware></windowsSettings></application></\nassembly>” fullword ascii\n$s2 = “curity><requestedPrivileges><requestedExecutionLevel level=\\”asInvoker\\” uiAccess=\\”false\\”></\nrequestedExecutionLevel></requeste” ascii\n$s3 = “GUP.exe” fullword ascii\n$s4 = “winsta0\\\\Winlogon” fullword ascii\n$s5 = “operator co_await” fullword ascii\n$s6 = “: :$:(:,:0:4:@:D:H:L:P:T:X:\\\\:” fullword ascii\n$s7 = “qwertyuiop” fullword ascii\n$s8 = “5j5$7(7,7074787<7@7D7H7L7P7T7X7\\\\7`7d7h7l7p7t7x7|7” fullword ascii\n$s9 = “<assembly xmlns=\\”urn:schemas-microsoft-com:asm.v1\\” manifestVersion=\\”1.0\\”><trustInfo\nxmlns=\\”urn:schemas-microsoft-com:asm.v3” ascii\n$s10 = “CNSEOJAN286” fullword ascii\n$s11 = “vileges></security></trustInfo><application xmlns=\\”urn:schemas-microsoft-com:asm.\nv3\\”><windowsSettings><dpiAware xmlns=\\”http:/” ascii\n$s12 = “vLUkkDvRzmLFNWZ” fullword ascii\ncondition:\nuint16(0) == 0x5a4d and filesize < 400KB and\n( pe.imphash() == “1c6aa1b4dfcf6a901b9a00dc3fbbd5a9” or 8 of them )\n}\n\n\n-----\n\n#### Appendix D — Malware Metadata\n\n_Infection Chain 1_\n\n|MD5|fb922430eca89767438043450c56afcf|\n|---|---|\n|SHA1|7c5b35bd14c0633b8d544b5f19c435d0b05c0e1f|\n|SHA256|f6e0f076e27391a6e6eb23f23f77c2ff078488875113df388640aca8bf4dd64b|\n|imphash|8c4dc1fd8c5de32c5f78cf7b057b0119|\n|Compilation Timestamp|1992-06-19 22:22:17|\n|Type|Win32 EXE; PE32 executable for MS Windows (GUI) Intel 80386 32-bit|\n|Size|692.27KB|\n|Filename|unins000.exe renamed to CASTSP.exe|\n|C2|-|\n|Description|Legitimate PDF-XChange uninstaller. A valid and signed application that utilizes DLL sideloading to execute the malicious DLL, “Version.dll.”|\n\n|MD5|e8e59b44613b5af58688809f8cb6dfa8|\n|---|---|\n|SHA1|2e84fd87150a002df98233093f2842337c594604|\n|SHA256|10182f0e64b765db989c158402c76eb1e0e862cab407f7c5cec133d8e5cb73e3|\n|imphash|0df4d1c641594cfb0df9e8869fa35db8|\n|Compilation Timestamp|2018-08-28 08:31:00|\n|Type|Win32 DLL PE32 executable for MS Windows (DLL) (GUI) Intel 80386 32-bit|\n|Size|108KB|\n|Filename|version.dll|\n|C2|-|\n|Description|Malicious DLL, sideloaded using legitimate binary to decrypt, decompress, and inject DES-encrypted malicious Trochilus payload into memory.|\n\n\n-----\n\n|MD5|8998D76981C6006B994D6C13D0781EDB|\n|---|---|\n|SHA1|CE878FACCA3698A129E0633A93E8A9DC4105FE98|\n|SHA256|42b5eb1f77a25ad73202d3be14e1833ef0502b0b6ae7ab54f5d4b5c2283429c6|\n|imphash|-|\n|Compilation Timestamp|-|\n|Type|Binary Data|\n|Size|379KB|\n|Filename|CZYSOYKPOIKKZGUFOIUI|\n|C2|www.miphomanager[.]com|\n|Description|DES-encrypted Trochilus executable.|\n\n\n_Infection Chain 2_\n\n|MD5|bbd3c23b9f3451b2c96df24441c76359|\n|---|---|\n|SHA1|781069228a9271531cc3fe6b1ba7a5f75db486b6|\n|SHA256|fc6a130504b54fa72cfc104c656fe2cd92d7998f42ca064e22167e1d402a1514|\n|imphash|926ac3b9e79042520b69075417a4c157|\n|Compilation Timestamp|2018-05-04 07:11:30|\n|Type|Win32 EXE; PE32 executable for MS Windows (GUI) Intel 80386 32-bit|\n|Size|29.35KB|\n|Filename|TailoredDeploy.Host.exe renamed to CASTSP.exe|\n|C2|-|\n|Description|Legitimate Microsoft Visual Studio 6.0 binary. When executed on host device, sideloads colocated malicious DLL to kickstart injection of malicious payload into system processes.|\n\n\n-----\n\n|MD5|e4c0adce9258da655bef089ab0b697b0|\n|---|---|\n|SHA1|85377f8815f433a3f2a2028ba3d6d2a908b400a4|\n|SHA256|eed0c7f7d36e75382c83e945a8b00abf01d3762b973c952dec05ceccb34b487d|\n|imphash|c326c208bc65e6309413d8e699062a39|\n|Compilation Timestamp|2018-09-06 02:43:53|\n|Type|Win32 DLL; PE32 executable for MS Windows (DLL) (GUI) Intel 80386 32-bit|\n|Size|99.5KB|\n|Filename|vcruntime140.dll|\n|C2|-|\n|Description|Malicious DLL, sideloaded using legitimate binary to decrypt, decompress, and inject DES-encrypted malicious Trochilus payload into memory.|\n\n|MD5|C43F640BBB78CE5032ED15AFB3A9B868|\n|---|---|\n|SHA1|B5DD2DFE09A18E5E97FE0E3D0F8002882C8D056F|\n|SHA256|E6280de09f9adf79212409529eb25c0c2ea73e33a50281e22228a3db3998eecb|\n|imphash|-|\n|Compilation Timestamp|-|\n|Type|Binary Data|\n|Size|384KB|\n|Filename|RUTLFJPBTJSFZZAOJTYP|\n|C2|www.miphomanager[.]com|\n|Description|DES-encrypted Trochilus executable.|\n\n\n_Webshell_\n\n|MD5|ee6a293893724c8d719ca00aa45d72d6|\n|---|---|\n|SHA1|0c44c5c7cfa9f8e90fd851a68f343f0143a6896e|\n|SHA256|243d47fc2a24b391e1153d5c7807c6e5de51aba65fc79465d7b3e5c64d5fac41|\n|imphash|-|\n|Compilation Timestamp|-|\n|Type|ASCII text|\n|Size|77 bytes|\n|Filename|iisstart.aspx|\n|C2|-|\n|Description|Server-side component of China Chopper ASPX payload.|\n\n\n-----\n\n#### Appendix E — MITRE ATT&CK Mapping\n\nThe MITRE ATT&CK grid populated below identifies the techniques\nutilized by APT10 attackers in the targeting outlined in this research.\n\n**MITRE ATT&CK Mapping**\n\n**Initial Access** **Execution** **Persistence** **Privilege Escalation** **Defense Evasion** **Credential Access** **Discovery** **Lateral Movement** **Collection**\n\nDrive-by Compromise CMSTP Accessibility Features Access Token Manipulation Access Token Manipulation Account Manipulation Account Discovery Application Deployment Software Audio Capture\n\nExploit Public-Facing Application Command-Line Interface Account Manipulation Accessibility Features Binary Padding Brute Force Application Window Discovery Distributed Component Object Model\n\nHardware Additions Compiled HTML File AppCert DLLs AppCert DLLs BITS Jobs Credential Dumping Browser Bookmark Discovery Exploitation of Remote Services\n\nReplication Through Removable Media Control Panel Items AppInit DLLs AppInit DLLs Bypass User Account Control Credentials in Files File and Directory Discovery Log-on Scripts Repositories\n\nSpearphishing Attachment Dynamic Data Exchange Application Shimming Application Shimming CMSTP Credentials in Registry Network Service Scanning Pass the Hash\n\nSpearphishing Link Execution through API Authentication Package Bypass User Account Control Code Signing Exploitation for Credential Access Network Share Discovery Pass the Ticket Shared Drive\n\nSpearphishing via Service Execution through Module Load BITS Jobs DLL Search Order Hijacking Compiled HTML File Forced Authentication Network Sniffing Remote Desktop Protocol\n\nSupply Chain Compromise Exploitation for Client Execution Bootkit Exploitation for Privilege Component Firmware Hooking Password Policy Discovery Remote File Copy Data Staged\n\nTrusted Relationship Graphical User Interface Browser Extensions Escalation Extra Window Memory Injection Component Object Model Hijacking Input Capture Peripheral Device Discovery Remote Services\n\nValid Accounts InstallUtil Change Default File Association File System Permissions Weakness Control Panel Items Kerberoasting Permission Groups Discovery Replication Through Removable Media Input Capture\n\nLSASS Driver Component Firmware Hooking DCShadow LLMNR/NBT-NS Poisoning Process Discovery Shared Webroot\n\nMshta Component Object Model Hijacking Image File Execution Deobfuscate/Decode Files or Information Network Sniffing Query Registry Taint Shared Content\n\nPowerShell Create Account Options Injection Disabling Security Tools Password Filter DLL Remote System Discovery Third-party Software Video Capture\n\nRegsvcs/Regasm DLL Search Order Hijacking New Service DLL Search Order Hijacking Private Keys Security Software Discovery Windows Admin Shares\n\nRegsvr32 External Remote Services Path Interception DLL Side-Loading Two-Factor Authentication Interception System Information Discovery Windows Remote Management\n\nRundll32 File System Permissions Weakness Port Monitors Exploitation for Defense Evasion System Network Configuration Discovery\n\nScheduled Task Hidden Files and Directories Process Injection Extra Window Memory Injection System Network Connections Discovery\n\nScripting Hooking Scheduled Task File Deletion System Owner/User Discovery\n\nService Execution Hypervisor Service Registry Permissions Weakness File Permissions Modification System Service Discovery\n\nSigned Binary Proxy Execution Image File Execution Options Injection SID-History Injection File System Logical Offsets System Time Discovery\n\nSigned Script Proxy Execution Logon Scripts Valid Accounts Hidden Files and Directories\n\nThird-party Software LSASS Driver Web Shell Image File Execution Options Injection\n\nTrusted Developer Utilities Modify Existing Service Indicator Blocking\n\nUser Execution Netsh Helper DLL Indicator Removal from Tools\n\nWindows Management Instrumentation New Service Indicator Removal on Host\n\nWindows Remote Management Office Application Startup Indirect Command Execution\n\nXSL Script Processing Path Interception Install Root Certificate\n\nPort Monitors InstallUtil\n\nRedundant Access Masquerading\n\nRegistry Run Keys / Startup Folder Modify Registry\n\nScheduled Task Mshta\n\nScreensaver Network Share Connection Removal\n\nSecurity Support Provider NTFS File Attributes\n\nService Registry Obfuscated Files\nPermissions Weakness or Information\n\nShortcut Modification Process Doppelgänging\n\nSIP and Trust Provider Hijacking Process Hollowing\n\nSystem Firmware Process Injection\n\nTime Providers Redundant Access\n\nValid Accounts Regsvcs/Regasm\n\nWeb Shell Regsvr32\n\nWindows Management Instrumentation Rootkit\n\nEvent Subscription Rundll32\n\nWinlogon Helper DLL Scripting\n\nSigned Binary\nProxy Execution\n\nSigned Script Proxy Execution\n\nSIP and Trust Provider\nHijacking\n\nSoftware Packing\n\nTemplate Injection\n\nTimestomp\n\nTrusted Developer Utilities LEGEND\n\nValid Accounts\n\nWeb Service\n\nXSL Script Processing\n\nHighlighted with green are the new techniques used by APT10\nidentified during this campaign.\n\nIn yellow are the techniques that were observed during this\ncampaign and had previously been associated with APT10.\n\nIn blue are techniques used by APT10 in previous campaigns that\nweren’t observed in this campaign.\n\n|Initial Access|Execution|Persistence|Privilege Escalation|Defense Evasion|Credential Access|Discovery|Lateral Movement|Collection|Exfiltration|Command And Control|\n|---|---|---|---|---|---|---|---|---|---|---|\n|Drive-by Compromise|CMSTP|Accessibility Features|Access Token Manipulation|Access Token Manipulation|Account Manipulation|Account Discovery|Application Deployment Software|Audio Capture|Automated Exfiltration|Commonly Used Port|\n|Exploit Public-Facing Application|Command-Line Interface|Account Manipulation|Accessibility Features|Binary Padding|Brute Force|Application Window Discovery|Distributed Component Object Model|Automated Collection|Data Compressed|Communication Through Removable Media|\n|Hardware Additions|Compiled HTML File|AppCert DLLs|AppCert DLLs|BITS Jobs|Credential Dumping|Browser Bookmark Discovery|Exploitation of Remote Services|Clipboard Data|Data Encrypted|Connection Proxy|\n|Replication Through Removable Media|Control Panel Items|AppInit DLLs|AppInit DLLs|Bypass User Account Control|Credentials in Files|File and Directory Discovery|Log-on Scripts|Data from Information Repositories|Data Transfer Size Limits|Custom Command and Control Protocol|\n|Spearphishing Attachment|Dynamic Data Exchange|Application Shimming|Application Shimming|CMSTP|Credentials in Registry|Network Service Scanning|Pass the Hash|Data from Local System|Exfiltration Over Alternative Protocol|Custom Cryptographic Protocol|\n|Spearphishing Link|Execution through API|Authentication Package|Bypass User Account Control|Code Signing|Exploitation for Credential Access|Network Share Discovery|Pass the Ticket|Data from Network Shared Drive|Exfiltration Over Command and Control Channel|Data Encoding|\n|Spearphishing via Service|Execution through Module Load|BITS Jobs|DLL Search Order Hijacking|Compiled HTML File|Forced Authentication|Network Sniffing|Remote Desktop Protocol|Data from Removable Media|Exfiltration Over Other Network Medium|Data Obfuscation|\n|Supply Chain Compromise|Exploitation for Client Execution|Bootkit|Exploitation for Privilege|Component Firmware|Hooking|Password Policy Discovery|Remote File Copy|Data Staged|Exfiltration Over Physical Medium|Domain Fronting|\n|Trusted Relationship|Graphical User Interface|Browser Extensions|Escalation Extra Window Memory Injection|Component Object Model Hijacking|Input Capture|Peripheral Device Discovery|Remote Services|Email Collection|Scheduled Transfer|Fallback Channels|\n|Valid Accounts|InstallUtil|Change Default File Association|File System Permissions Weakness|Control Panel Items|Kerberoasting|Permission Groups Discovery|Replication Through Removable Media|Input Capture||Multi-hop Proxy|\n|LSASS Driver Component Firmware Hooking Mshta C Mo om dep lo Hn ie jan ct k O inb gject Image File Execution PowerShell Create Account Options Injection Regsvcs/Regasm DLL Search Order Hijacking New Service Regsvr32 External Remote Services Path Interception Rundll32 F Wil ee a S ky ns ete ssm Permissions Port Monitors Scheduled Task Hidden Files and Directories Process Injection Scripting Hooking Scheduled Task Service Execution Hypervisor S Pe er rv mic ise s R ioe ng sis Wtry e a kness S Pi rg on xe yd E B xein ca ur ty io n I Om pa tg ioe n F si l Ie n jE ex ce tic ou ntion SID-History Injection Signed Script Proxy Execution Logon Scripts Valid Accounts Third-party Software LSASS Driver Web Shell Trusted Developer Utilities Modify Existing Service User Execution Netsh Helper DLL W Insin trd uo mw es n M taa tn ioa ngement New Service W Main nd ao gw ems R ee nm tote Office Application Startup XSL Script Processing Path Interception Port Monitors Redundant Access Registry Run Keys / Startup Folder Scheduled Task Screensaver Security Support Provider Service Registry Permissions Weakness Shortcut Modification SIP and Trust Provider Hijacking System Firmware Time Providers Valid Accounts Web Shell Windows Management Instrumentation Event Subscription Winlogon Helper DLL|LSASS Driver|Component Firmware|Hooking|DCShadow|LLMNR/NBT-NS Poisoning|Process Discovery|Shared Webroot|Man in the Browser||Multi-Stage Channels|\n||Mshta|Component Object Model Hijacking|Image File Execution|Deobfuscate/Decode Files or Information|Network Sniffing|Query Registry|Taint Shared Content|Screen Capture||Multiband Communication|\n||PowerShell|Create Account|Options Injection|Disabling Security Tools|Password Filter DLL|Remote System Discovery|Third-party Software|Video Capture||Multilayer Encryption|\n||Regsvcs/Regasm|DLL Search Order Hijacking|New Service|DLL Search Order Hijacking|Private Keys|Security Software Discovery|Windows Admin Shares|||Remote Access Tools|\n||Regsvr32|External Remote Services|Path Interception|DLL Side-Loading|Two-Factor Authentication Interception|System Information Discovery|Windows Remote Management|||Remote File Copy|\n||Rundll32|File System Permissions Weakness|Port Monitors|Exploitation for Defense Evasion||System Network Configuration Discovery||||Standard Application Layer Protocol|\n||Scheduled Task|Hidden Files and Directories|Process Injection|Extra Window Memory Injection||System Network Connections Discovery||||Standard Cryptographic Protocol|\n||Scripting|Hooking|Scheduled Task|File Deletion||System Owner/User Discovery||||Standard Non-Application Layer Protocol|\n||Service Execution|Hypervisor|Service Registry Permissions Weakness|File Permissions Modification||System Service Discovery||||Uncommonly Used Port|\n||Signed Binary Proxy Execution|Image File Execution Options Injection|SID-History Injection|File System Logical Offsets||System Time Discovery||||Web Service|\n||Signed Script Proxy Execution|Logon Scripts|Valid Accounts|Hidden Files and Directories|||||||\n||Third-party Software|LSASS Driver|Web Shell|Image File Execution Options Injection|||||||\n||Trusted Developer Utilities|Modify Existing Service||Indicator Blocking|||||||\n||User Execution|Netsh Helper DLL||Indicator Removal from Tools|||||||\n||Windows Management Instrumentation|New Service||Indicator Removal on Host|||||||\n||Windows Remote Management|Office Application Startup||Indirect Command Execution|||||||\n||XSL Script Processing|Path Interception||Install Root Certificate|||||||\n|||Port Monitors||InstallUtil|||||||\n|||Redundant Access||Masquerading|||||||\n|||Registry Run Keys / Startup Folder||Modify Registry|||||||\n|||Scheduled Task||Mshta|||||||\n|||Screensaver||Network Share Connection Removal|||||||\n|||Security Support Provider||NTFS File Attributes|||||||\n|||Service Registry Permissions Weakness||Obfuscated Files or Information|||||||\n|||Shortcut Modification||Process Doppelgänging|||||||\n|||SIP and Trust Provider Hijacking||Process Hollowing|||||||\n|||System Firmware||Process Injection|||||||\n|||Time Providers||Redundant Access|||||||\n|||Valid Accounts||Regsvcs/Regasm|||||||\n|||Web Shell||Regsvr32|||||||\n|||Windows Management Instrumentation||Rootkit|||||||\n|||Event Subscription||Rundll32|||||||\n|||Winlogon Helper DLL||Scripting|||||||\n|||||Signed Binary Proxy Execution|||||||\n|||||Signed Script Proxy Execution|||||||\n|||||SIP and Trust Provider Hijacking|||||||\n|||||Software Packing|||||||\n|||||Template Injection|||||||\n|||||Timestomp|||||||\n|||||Trusted Developer Utilities|||||||\n|||||Valid Accounts|||||||\n|||||Web Service|||||||\n|||||XSL Script Processing|||||||\n\n\n-----\n\n#### Appendix F — Visma Statement\n\n_How Visma Managed the Case_\n\nAll timelines and methods are documented in this report from\nRecorded Future and Rapid7.\n\nVisma’s intelligence systems gave them warning about the theft\n(a threat hunter from Rapid7 used the Visma Global Responsible\nDisclosure Policy). Visma correlated the intelligence from Rapid7\nagainst their internal alerts and mitigated the threat. They soon\nconfirmed that none of their clients’ systems were affected.\n\nThe Visma Corporate Security Incident Response Team (Visma\nCSIRT) worked closely with their Product Security Operations Center\n(PSOC), NSM NorCERT, as well as the police.\n\nAfter initial attribution (using data from Recorded Future, among\nother systems), Visma decided to contract an external partner\n(Recorded Future) to dig deeper into the incident report and gather\nadditional intelligence in order to ensure proper attribution to\nbetter understand this threat actor.\n\nIn this case, no client data was compromised, and Visma chose not\nto issue a general alert before they had conclusive evidence on who\nperformed the theft.\n\nThey assisted NSM NorCERT and others in the investigation and\ngeneral cleanup of this case.\n\n\n-----\n\n#### Retrospective\n\nVisma does not see any reason to question Recorded Future or\nRapid7’s attribution in this case, but Visma wants to give a general\nwarning about general nation-state-backed advanced persistent\nthreat actors that seem to target businesses and governments alike\nwith their advanced attack methods.\n\nFrom Visma’s experience and data, it can be observed that\nmost threat actors seem to have their own methods, tools, and\nplaybooks that may be used to identify them when carrying out a\ndecent analysis of their actions. Their motivation for these actions\nis sometimes quite tricky to understand, but most can probably\nbe classified as espionage, preparations for later hybrid warfare\noperations, or similar.\n\nVisma sees evidence of similar attempts against their systems quite\noften, but since this one was successful in stealing something and\nwas quite advanced, they want to put out a warning about this\nparticular threat actor.\n\nThey are thankful for the guidance and advice from NSM NorCERT,\npolice, and other cooperating parties in this case and urge all\nbusiness entities to explore the opportunities that are available in\nCERT cooperation.\n\nVisma has transparency as a carrying principle for their business\nand will publish data on nation-state and criminal attacks against\nthem both now and in the future. They will share information to\nensure public awareness of these matters and to motivate others\nto do the same.\n\n**About Recorded Future**\n\nRecorded Future arms security teams with the only complete threat intelligence\n\nsolution powered by patented machine learning to lower risk. Our technology\n\nautomatically collects and analyzes information from an unrivaled breadth of\n\nsources and provides invaluable context in real time and packaged for human\n\nanalysis or integration with security technologies.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        },
        {
            "id": "6fc23d14-23a6-4870-8fad-b291b182596f",
            "created_at": "2022-10-25T16:07:18.480113Z",
            "updated_at": "2022-10-25T16:07:18.480113Z",
            "deleted_at": null,
            "name": "ETDA",
            "url": "https://apt.etda.or.th",
            "description": "Threat Group Cards: A Threat Actor Encyclopedia",
            "reports": null
        },
        {
            "id": "bf5be533-fa31-4590-ae37-5761c97ffa34",
            "created_at": "2022-10-25T16:13:58.389257Z",
            "updated_at": "2022-10-25T16:13:58.389257Z",
            "deleted_at": null,
            "name": "Malpedia",
            "url": "https://malpedia.caad.fkie.fraunhofer.de",
            "description": "Malpedia is a free service offered by Fraunhofer FKIE",
            "reports": null
        },
        {
            "id": "5910e58f-4bc9-4e4e-9dbb-887804094a01",
            "created_at": "2022-10-25T16:32:58.457399Z",
            "updated_at": "2022-10-25T16:32:58.457399Z",
            "deleted_at": null,
            "name": "OTX",
            "url": "https://otx.alienvault.com",
            "description": "Alienvault Open Threat Exchange (OTX)",
            "reports": null
        },
        {
            "id": "6825b8cb-7d82-43d2-b0b0-d51c7e255b42",
            "created_at": "2023-01-06T13:46:37.642134Z",
            "updated_at": "2023-01-06T13:46:37.642134Z",
            "deleted_at": null,
            "name": "MISPGALAXY",
            "url": "https://www.misp-project.org/galaxy.html",
            "description": "MISP Galaxy Clusters",
            "reports": null
        }
    ],
    "references": [
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2019/2019.02.06.APT10_Sustained_Campaign/cta-2019-0206.pdf",
        "https://go.recordedfuture.com/hubfs/reports/cta-2019-0206.pdf",
        "http://go.recordedfuture.com/hubfs/reports/cta-2019-0206.pdf"
    ],
    "report_names": [
        "cta-2019-0206",
        "cta-2019-0206.pdf"
    ],
    "threat_actors": [
        {
            "id": "afb851c4-b2e8-40e3-ac37-c55d8c0ab3cd",
            "created_at": "2022-10-25T16:07:23.516432Z",
            "updated_at": "2025-03-27T02:02:09.841372Z",
            "deleted_at": null,
            "main_name": "Cyber Berkut",
            "aliases": [
                "Kiberberkut"
            ],
            "source_name": "ETDA:Cyber Berkut",
            "tools": [],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "d90307b6-14a9-4d0b-9156-89e453d6eb13",
            "created_at": "2022-10-25T16:07:23.773944Z",
            "updated_at": "2025-03-27T02:02:09.974695Z",
            "deleted_at": null,
            "main_name": "Lead",
            "aliases": [
                "Casper",
                "TG-3279"
            ],
            "source_name": "ETDA:Lead",
            "tools": [
                "Agentemis",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "RbDoor",
                "RibDoor",
                "Winnti",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "aa73cd6a-868c-4ae4-a5b2-7cb2c5ad1e9d",
            "created_at": "2022-10-25T16:07:24.139848Z",
            "updated_at": "2025-03-27T02:02:10.120505Z",
            "deleted_at": null,
            "main_name": "Safe",
            "aliases": [],
            "source_name": "ETDA:Safe",
            "tools": [
                "DebugView",
                "LZ77",
                "OpenDoc",
                "SafeDisk",
                "TypeConfig",
                "UPXShell",
                "UsbDoc",
                "UsbExe"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "5ffe400c-6025-44c2-9aa1-7c34a7a192b0",
            "created_at": "2023-01-06T13:46:38.469688Z",
            "updated_at": "2025-03-27T02:00:02.84172Z",
            "deleted_at": null,
            "main_name": "DragonOK",
            "aliases": [
                "Moafee",
                "BRONZE OVERBROOK",
                "G0017",
                "G0002",
                "Shallow Taurus"
            ],
            "source_name": "MISPGALAXY:DragonOK",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "268479f9-6666-488e-a41e-14593ed4c2f7",
            "created_at": "2023-01-06T13:46:38.614508Z",
            "updated_at": "2025-03-27T02:00:02.873733Z",
            "deleted_at": null,
            "main_name": "Cyber Berkut",
            "aliases": [],
            "source_name": "MISPGALAXY:Cyber Berkut",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "61c4ddc4-156b-4828-8570-0979da81f3d0",
            "created_at": "2022-10-25T16:47:55.593828Z",
            "updated_at": "2025-03-27T02:05:17.275161Z",
            "deleted_at": null,
            "main_name": "BRONZE MAYFAIR",
            "aliases": [
                "Gothic Panda ",
                "TG-0110 ",
                "APT3 "
            ],
            "source_name": "Secureworks:BRONZE MAYFAIR",
            "tools": [
                " HUC Proxy Malware (Htran)",
                " Pirpi",
                " SplitVPN",
                " ctt",
                " ctx",
                "Cookiecutter"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "7ebda3c6-1789-4d84-97cf-47fb18a0cb28",
            "created_at": "2022-10-25T15:50:23.78829Z",
            "updated_at": "2025-03-27T02:00:55.547275Z",
            "deleted_at": null,
            "main_name": "DragonOK",
            "aliases": [
                "DragonOK"
            ],
            "source_name": "MITRE:DragonOK",
            "tools": [
                "PoisonIvy",
                "PlugX"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "60d9c778-488b-459e-a2f6-9e48c607ba45",
            "created_at": "2022-10-25T16:47:55.606462Z",
            "updated_at": "2025-03-27T02:05:17.281676Z",
            "deleted_at": null,
            "main_name": "BRONZE OVERBROOK",
            "aliases": [
                "DragonOK ",
                "Samurai Panda ",
                "Temp.DragonOK ",
                "Danti "
            ],
            "source_name": "Secureworks:BRONZE OVERBROOK",
            "tools": [
                " DDKONG",
                " HelloBridge",
                " IsSpace",
                " NFLog Trojan",
                " PLAINTEE",
                " PlugX",
                " Rambo",
                "Aveo"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "761d1fb2-60e3-46f0-9f1c-c8a9715967d4",
            "created_at": "2023-01-06T13:46:38.269054Z",
            "updated_at": "2025-03-27T02:00:02.789278Z",
            "deleted_at": null,
            "main_name": "APT3",
            "aliases": [
                "TG-0110",
                "Group 6",
                "Buckeye",
                "Boyusec",
                "BORON",
                "BRONZE MAYFAIR",
                "Red Sylvan",
                "GOTHIC PANDA"
            ],
            "source_name": "MISPGALAXY:APT3",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "ec14074c-8517-40e1-b4d7-3897f1254487",
            "created_at": "2023-01-06T13:46:38.300905Z",
            "updated_at": "2025-03-27T02:00:02.799108Z",
            "deleted_at": null,
            "main_name": "APT10",
            "aliases": [
                "TA429",
                "STONE PANDA",
                "POTASSIUM",
                "Red Apollo",
                "HOGFISH",
                "Cloud Hopper",
                "BRONZE RIVERSIDE",
                "ATK41",
                "G0045",
                "Menupass Team",
                "happyyongzi",
                "CVNX",
                "Granite Taurus"
            ],
            "source_name": "MISPGALAXY:APT10",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "2f07a03f-eb1f-47c8-a8e9-a1a00f2ec253",
            "created_at": "2022-10-25T16:07:24.277669Z",
            "updated_at": "2025-03-27T02:02:10.157972Z",
            "deleted_at": null,
            "main_name": "TA428",
            "aliases": [
                "Operation LagTime IT",
                "Operation StealthyTrident",
                "ThunderCats"
            ],
            "source_name": "ETDA:TA428",
            "tools": [
                "8.t Dropper",
                "8.t RTF exploit builder",
                "8t_dropper",
                "Agent.dhwf",
                "Albaniiutas",
                "BlueTraveller",
                "Chymine",
                "Cotx RAT",
                "CoughingDown",
                "Darkmoon",
                "Destroy RAT",
                "DestroyRAT",
                "Gen:Trojan.Heur.PT",
                "Kaba",
                "Korplug",
                "LuckyBack",
                "PhantomNet",
                "PlugX",
                "Poison Ivy",
                "RedDelta",
                "RoyalRoad",
                "SManager",
                "SPIVY",
                "Sogu",
                "TIGERPLUG",
                "TManger",
                "TVT",
                "Thoper",
                "Xamtrav",
                "pivy",
                "poisonivy"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "e90ec9cb-9959-455d-b558-4bafef64d645",
            "created_at": "2022-10-25T16:07:24.222081Z",
            "updated_at": "2025-03-27T02:02:10.14365Z",
            "deleted_at": null,
            "main_name": "Sphinx",
            "aliases": [
                "APT-C-15"
            ],
            "source_name": "ETDA:Sphinx",
            "tools": [
                "AnubisSpy",
                "Backdoor.Oldrea",
                "Bladabindi",
                "Fertger",
                "Havex",
                "Havex RAT",
                "Jorik",
                "Oldrea",
                "PEACEPIPE",
                "njRAT",
                "yellowalbatross"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "13354d3f-3f40-44ec-b42a-3cda18809005",
            "created_at": "2022-10-25T15:50:23.275272Z",
            "updated_at": "2025-03-27T02:00:55.418075Z",
            "deleted_at": null,
            "main_name": "APT3",
            "aliases": [
                "APT3",
                "Gothic Panda",
                "Pirpi",
                "UPS Team",
                "Buckeye",
                "Threat Group-0110",
                "TG-0110"
            ],
            "source_name": "MITRE:APT3",
            "tools": [
                "OSInfo",
                "schtasks",
                "PlugX",
                "LaZagne",
                "SHOTPUT",
                "RemoteCMD"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "ba3fff0c-3ba0-4855-9eeb-1af9ee18136a",
            "created_at": "2022-10-25T15:50:23.298889Z",
            "updated_at": "2025-03-27T02:00:55.433541Z",
            "deleted_at": null,
            "main_name": "menuPass",
            "aliases": [
                "menuPass",
                "POTASSIUM",
                "Stone Panda",
                "APT10",
                "Red Apollo",
                "CVNX",
                "HOGFISH",
                "BRONZE RIVERSIDE"
            ],
            "source_name": "MITRE:menuPass",
            "tools": [
                "certutil",
                "FYAnti",
                "UPPERCUT",
                "SNUGRIDE",
                "P8RAT",
                "RedLeaves",
                "SodaMaster",
                "pwdump",
                "Mimikatz",
                "PlugX",
                "PowerSploit",
                "ChChes",
                "cmd",
                "QuasarRAT",
                "AdFind",
                "Cobalt Strike",
                "PoisonIvy",
                "EvilGrab",
                "esentutl",
                "Impacket",
                "Ecipekac",
                "PsExec",
                "HUI Loader"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "ba9fa308-a29a-4928-9c06-73aafec7624c",
            "created_at": "2024-05-01T02:03:07.981061Z",
            "updated_at": "2025-03-27T02:05:17.28602Z",
            "deleted_at": null,
            "main_name": "BRONZE RIVERSIDE",
            "aliases": [
                "CTG-5938 ",
                "CVNX ",
                "Hogfish ",
                "MenuPass ",
                "POTASSIUM ",
                "Red Apollo ",
                "Stone Panda ",
                "APT10 "
            ],
            "source_name": "Secureworks:BRONZE RIVERSIDE",
            "tools": [
                " ChChes",
                " Cobalt Strike",
                " PlugX",
                " PoisonIvy",
                " QuasarRAT",
                " QuasarRAT Loader",
                " RedLeaves",
                "ANEL"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "e3767160-695d-4360-8b2e-d5274db3f7cd",
            "created_at": "2022-10-25T16:47:55.914348Z",
            "updated_at": "2025-03-27T02:05:17.411172Z",
            "deleted_at": null,
            "main_name": "IRON TWILIGHT",
            "aliases": [
                "ATK5 ",
                "Blue Athena ",
                "BlueDelta ",
                "FROZENLAKE ",
                "Fancy Bear ",
                "Fighting Ursa ",
                "Forest Blizzard ",
                "GRAPHITE ",
                "Group 74 ",
                "PawnStorm ",
                "STRONTIUM ",
                "Sednit ",
                "Snakemackerel ",
                "Sofacy ",
                "TG-4127 ",
                "Tsar Team ",
                "APT28 "
            ],
            "source_name": "Secureworks:IRON TWILIGHT",
            "tools": [
                " Downdelph",
                " Drovorub",
                " EVILTOSS",
                " HIDEDRV",
                " Headlace",
                " LoJack",
                " Powershell Empire",
                " SCONATO",
                " SEDUPLOADER",
                " SHARPFRONT",
                " Scaramouche",
                " Sedkit Exploit Kit",
                " Sofacy downloader",
                " X-Agent",
                " X-Tunnel",
                " Zebrocy",
                " reGeorg",
                "DEALERSCHOICE"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "730dfa6e-572d-473c-9267-ea1597d1a42b",
            "created_at": "2023-01-06T13:46:38.389985Z",
            "updated_at": "2025-03-27T02:00:02.821388Z",
            "deleted_at": null,
            "main_name": "APT28",
            "aliases": [
                "FROZENLAKE",
                "BlueDelta",
                "SNAKEMACKEREL",
                "TG-4127",
                "ITG05",
                "TA422",
                "Fancy Bear",
                "FANCY BEAR",
                "Sednit",
                "IRON TWILIGHT",
                "G0007",
                "Sofacy",
                "Forest Blizzard",
                "GruesomeLarch",
                "Pawn Storm",
                "Tsar Team",
                "STRONTIUM",
                "ATK5",
                "Blue Athena",
                "APT-C-20",
                "Group 74",
                "SIG40",
                "Grizzly Steppe",
                "Fighting Ursa",
                "T-APT-12",
                "UAC-0028"
            ],
            "source_name": "MISPGALAXY:APT28",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "ae320ed7-9a63-42ed-944b-44ada7313495",
            "created_at": "2022-10-25T15:50:23.671663Z",
            "updated_at": "2025-03-27T02:00:55.518748Z",
            "deleted_at": null,
            "main_name": "APT28",
            "aliases": [
                "APT28",
                "IRON TWILIGHT",
                "SNAKEMACKEREL",
                "Group 74",
                "Sednit",
                "Sofacy",
                "Pawn Storm",
                "Fancy Bear",
                "STRONTIUM",
                "Tsar Team",
                "Threat Group-4127",
                "TG-4127",
                "Forest Blizzard",
                "FROZENLAKE"
            ],
            "source_name": "MITRE:APT28",
            "tools": [
                "Wevtutil",
                "certutil",
                "Forfiles",
                "DealersChoice",
                "Mimikatz",
                "ADVSTORESHELL",
                "Komplex",
                "HIDEDRV",
                "JHUHUGIT",
                "Koadic",
                "Winexe",
                "XTunnel",
                "Drovorub",
                "CORESHELL",
                "OLDBAIT",
                "Downdelph",
                "XAgentOSX",
                "USBStealer",
                "Zebrocy",
                "Fysbis",
                "LoJax"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "340d1673-0678-4e1f-8b75-30da2f65cc80",
            "created_at": "2022-10-25T16:07:23.552036Z",
            "updated_at": "2025-03-27T02:02:09.85925Z",
            "deleted_at": null,
            "main_name": "DragonOK",
            "aliases": [
                "Bronze Overbrook",
                "Shallow Taurus"
            ],
            "source_name": "ETDA:DragonOK",
            "tools": [
                "Agent.dhwf",
                "CT",
                "Chymine",
                "Darkmoon",
                "Destroy RAT",
                "DestroyRAT",
                "FF-RAT",
                "FormerFirstRAT",
                "Gen:Trojan.Heur.PT",
                "HTran",
                "HUC Packet Transmit Tool",
                "HelloBridge",
                "IsSpace",
                "KHRAT",
                "Kaba",
                "Korplug",
                "Mongall",
                "NFlog",
                "NewCT",
                "NfLog RAT",
                "PlugX",
                "Poison Ivy",
                "Rambo",
                "RedDelta",
                "SPIVY",
                "Sogu",
                "SysGet",
                "TIGERPLUG",
                "TVT",
                "Thoper",
                "TidePool",
                "Xamtrav",
                "brebsd",
                "ffrat",
                "pivy",
                "poisonivy"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "d2516b8e-e74f-490d-8a15-43ad6763c7ab",
            "created_at": "2022-10-25T16:07:24.212584Z",
            "updated_at": "2025-03-27T02:02:10.141001Z",
            "deleted_at": null,
            "main_name": "Sofacy",
            "aliases": [
                "APT 28",
                "ATK 5",
                "Blue Athena",
                "BlueDelta",
                "FROZENLAKE",
                "Fancy Bear",
                "Fighting Ursa",
                "Forest Blizzard",
                "Grey-Cloud",
                "Grizzly Steppe",
                "Group 74",
                "GruesomeLarch",
                "ITG05",
                "Iron Twilight",
                "Operation DealersChoice",
                "Operation Dear Joohn",
                "Operation Komplex",
                "Operation Pawn Storm",
                "Operation Russian Doll",
                "Operation Steal-It",
                "Pawn Storm",
                "SIG40",
                "Sednit",
                "Snakemackerel",
                "Sofacy",
                "Strontium",
                "T-APT-12",
                "TA422",
                "TAG-0700",
                "TAG-110",
                "TG-4127",
                "Tsar Team",
                "UAC-0028",
                "UAC-0063"
            ],
            "source_name": "ETDA:Sofacy",
            "tools": [
                "ADVSTORESHELL",
                "AZZY",
                "Backdoor.SofacyX",
                "CHERRYSPY",
                "CORESHELL",
                "Carberp",
                "Computrace",
                "DealersChoice",
                "Delphacy",
                "Downdelph",
                "Downrage",
                "Drovorub",
                "EVILTOSS",
                "Foozer",
                "GAMEFISH",
                "GooseEgg",
                "Graphite",
                "HATVIBE",
                "HIDEDRV",
                "Headlace",
                "Impacket",
                "JHUHUGIT",
                "JKEYSKW",
                "Koadic",
                "Komplex",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "LoJack",
                "LoJax",
                "MASEPIE",
                "Mimikatz",
                "NETUI",
                "Nimcy",
                "OCEANMAP",
                "OLDBAIT",
                "PocoDown",
                "PocoDownloader",
                "Popr-d30",
                "ProcDump",
                "PythocyDbg",
                "SMBExec",
                "SOURFACE",
                "SPLM",
                "STEELHOOK",
                "Sasfis",
                "Sedkit",
                "Sednit",
                "Sedreco",
                "Seduploader",
                "Shunnael",
                "SkinnyBoy",
                "Sofacy",
                "SofacyCarberp",
                "SpiderLabs Responder",
                "Trojan.Shunnael",
                "Trojan.Sofacy",
                "USB Stealer",
                "USBStealer",
                "VPNFilter",
                "Win32/USBStealer",
                "WinIDS",
                "Winexe",
                "X-Agent",
                "X-Tunnel",
                "XAPS",
                "XTunnel",
                "Xagent",
                "Zebrocy",
                "Zekapab",
                "carberplike",
                "certutil",
                "certutil.exe",
                "fysbis",
                "webhp"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "04b07437-41bb-4126-bcbb-def16f19d7c6",
            "created_at": "2022-10-25T16:07:24.232628Z",
            "updated_at": "2025-03-27T02:02:10.146043Z",
            "deleted_at": null,
            "main_name": "Stone Panda",
            "aliases": [
                "APT 10",
                "ATK 41",
                "Bronze Riverside",
                "CTG-5938",
                "CVNX",
                "Cuckoo Spear",
                "Earth Kasha",
                "Granite Taurus",
                "Happyyongzi",
                "Hogfish",
                "ITG01",
                "Operation A41APT",
                "Operation Cache Panda",
                "Operation ChessMaster",
                "Operation Cloud Hopper",
                "Operation Cuckoo Spear",
                "Operation New Battle",
                "Operation Soft Cell",
                "Operation TradeSecret",
                "Potassium",
                "Red Apollo",
                "Stone Panda",
                "TA429",
                "menuPass",
                "menuPass Team"
            ],
            "source_name": "ETDA:Stone Panda",
            "tools": [
                "Agent.dhwf",
                "Agentemis",
                "Anel",
                "AngryRebel",
                "BKDR_EVILOGE",
                "BKDR_HGDER",
                "BKDR_NVICM",
                "BUGJUICE",
                "CHINACHOPPER",
                "ChChes",
                "China Chopper",
                "Chymine",
                "CinaRAT",
                "Cobalt Strike",
                "CobaltStrike",
                "DARKTOWN",
                "DESLoader",
                "DILLJUICE",
                "DILLWEED",
                "Darkmoon",
                "DelfsCake",
                "Derusbi",
                "Destroy RAT",
                "DestroyRAT",
                "Ecipekac",
                "Emdivi",
                "EvilGrab",
                "EvilGrab RAT",
                "FYAnti",
                "Farfli",
                "Gen:Trojan.Heur.PT",
                "Gh0st RAT",
                "Ghost RAT",
                "GreetCake",
                "HAYMAKER",
                "HEAVYHAND",
                "HEAVYPOT",
                "HTran",
                "HUC Packet Transmit Tool",
                "Ham Backdoor",
                "HiddenFace",
                "Impacket",
                "Invoke the Hash",
                "KABOB",
                "Kaba",
                "Korplug",
                "LODEINFO",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "MiS-Type",
                "Mimikatz",
                "Moudour",
                "Mydoor",
                "NBTscan",
                "NOOPDOOR",
                "Newsripper",
                "P8RAT",
                "PCRat",
                "PlugX",
                "Poison Ivy",
                "Poldat",
                "PowerSploit",
                "PowerView",
                "PsExec",
                "PsList",
                "Quarks PwDump",
                "Quasar RAT",
                "QuasarRAT",
                "RedDelta",
                "RedLeaves",
                "Rubeus",
                "SNUGRIDE",
                "SPIVY",
                "SharpSploit",
                "SigLoader",
                "SinoChopper",
                "SodaMaster",
                "Sogu",
                "TIGERPLUG",
                "TVT",
                "Thoper",
                "Trochilus RAT",
                "UpperCut",
                "Vidgrab",
                "WinRAR",
                "WmiExec",
                "Wmonder",
                "Xamtrav",
                "Yggdrasil",
                "Zlib",
                "certutil",
                "certutil.exe",
                "cobeacon",
                "dfls",
                "lena",
                "nbtscan",
                "pivy",
                "poisonivy",
                "pwdump"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1666716504,
    "ts_updated_at": 1743041834,
    "ts_creation_date": 1549455709,
    "ts_modification_date": 1549455964,
    "files": {
        "pdf": "https://archive.orkl.eu/87f5158d77ea898b705d34760578696818ed5ad8.pdf",
        "text": "https://archive.orkl.eu/87f5158d77ea898b705d34760578696818ed5ad8.txt",
        "img": "https://archive.orkl.eu/87f5158d77ea898b705d34760578696818ed5ad8.jpg"
    }
}