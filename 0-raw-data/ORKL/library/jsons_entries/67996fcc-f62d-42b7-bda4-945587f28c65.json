{
    "id": "67996fcc-f62d-42b7-bda4-945587f28c65",
    "created_at": "2024-11-01T02:06:05.44064Z",
    "updated_at": "2025-03-27T02:09:18.370362Z",
    "deleted_at": null,
    "sha1_hash": "056afc03b338c3e3c17f091cb47a966388dcd98a",
    "title": "",
    "authors": "",
    "file_creation_date": "2019-07-29T00:08:39Z",
    "file_modification_date": "2019-07-29T00:08:39Z",
    "file_size": 2201047,
    "plain_text": "### National Cybersecurity Assessments and Technical Services\n# Appref-ms Abuse for Code Execution & C2\n## William J. Burke IV Information Security Specialist Advanced Operations\n\n\n-----\n\n##### Table of Contents\n\nBackground ..................................................................................................................................... 4\n\nInitial Requirements .................................................................................................................................. 4\nProcess Summary ...................................................................................................................................... 4\n\nMicrosoft Applications Overview.................................................................................................... 5\n\nApplication Publishing Overview - Online & Offline Availability ............................................................... 5\nApplication Deployment Process .............................................................................................................. 7\nApplication Installation Process .............................................................................................................. 10\n\nAppref-ms abuse for payload delivery .......................................................................................... 12\n\nPre-Deployment Requirements............................................................................................................... 12\nInitial Access - Phishing via OLE Delivery................................................................................................. 15\nInitial Access - Phishing via Hyperlink Delivery ....................................................................................... 17\nInitial Access - Phishing via HTA Delivery ................................................................................................ 17\n\nC2 Management via .appref-ms ................................................................................................... 18\n\nEstablishing Persistence .......................................................................................................................... 18\nFoothold management via Forced Application Updates ........................................................................ 18\n\nConclusions ................................................................................................................................... 21\n\n\n-----\n\n##### Table of Figures\n\nFigure 1: OLE and Filetypes ............................................................................................................ 5\nFigure 2: Publish.htm ..................................................................................................................... 6\nFigure 3: PatchManager.appref-ms ............................................................................................... 6\nFigure 4: Application Settings ........................................................................................................ 7\nFigure 5: Code Signing Settings ...................................................................................................... 8\nFigure 6: Publish Settings ............................................................................................................... 8\nFigure 7: Update Settings ............................................................................................................... 9\nFigure 8: Application Deployment Validation .............................................................................. 10\nFigure 9: Deployment Manifest Snippet ...................................................................................... 11\nFigure 10: Application Manifest Snippet ..................................................................................... 11\nFigure 11: Application Install Prompt .......................................................................................... 11\nFigure 12: Application in Start Menu ........................................................................................... 12\nFigure 13: File and Folder Deletion .............................................................................................. 13\nFigure 14: Application Uninstall Registry Key .............................................................................. 13\nFigure 15: Key Tree Deletion ........................................................................................................ 14\nFigure 16: .appref-ms data in .application file ............................................................................. 14\nFigure 17: Generating an .appref-ms ........................................................................................... 15\nFigure 18: .appref-ms Word OLE................................................................................................... 15\nFigure 19: OLE Execution ............................................................................................................. 16\nFigure 20: ClickOnce Dialog Box.................................................................................................... 16\nFigure 21: SmartScreen ................................................................................................................ 16\nFigure 22: .application Hyperlink ................................................................................................. 17\nFigure 23: ClickOnce Delivery HTA ............................................................................................... 17\nFigure 24: C2 Example Phase 1 .................................................................................................... 19\nFigure 25: C2 Example Phase 2 .................................................................................................... 19\nFigure 26: C2 Example Phase 3 .................................................................................................... 20\nFigure 27: C2 Example Phase 4 .................................................................................................... 20\n\n\n-----\n\n#### Background\n\n###### Initial Requirements\n\nDue to the increase in detection or protection against currently used payload delivery mechanisms\nin the field, new methods needed to be developed to obtain code execution for initial access in red\nteam operations. The requirements for these new methods were that they must utilize the Cobalt\nStrike[1] framework, evade Windows Defender[2], work on both Windows 10 and Windows 7\nenvironments, and they must not use previously disclosed delivery mechanisms.\n\nIn support of this research a test environment was developed consisting of the following:\n\n  - Windows 10 victim host - Fully patched with Windows Defender enabled\n\n  - Windows 7 victim host - Fully patched with Symantec Antivirus enabled\n\n  - Windows 10 development host - Visual Studio 2017 environment\n\n  - Kali Linux host - Attack platform utilized for testing as a Cobalt Strike client\n\n  - Ubuntu cloud server - Cobalt Strike team server for C2 (Command & Control)\n\n  - E-mail capabilities - Gmail was predominantly used, with additional testing in Outlook\n\n  - Supporting Software - Microsoft office 365 was installed on each of the Windows hosts\n\nIn support of this research the following variables were established:\n\n  - A known valid payload was used for delivery via the .appref-ms filetype\n\n  - Code signing certificates were used as part of the deployment process\n\n  - Hosts maintained internet connectivity to provide an avenue for e-mail delivery and C2\n\n  - Each host stood individually - testing was not performed in a domain environment\n\n  - Firewall rules were set on the cloud server to only permit communications to and from the\n\ntest environment\n\nAs prior research was discovered that details ClickOnce abuse via .application Online Only\npublishing, this paper focuses on Online & Offline Availability to leverage abuse of the .apprefms filetype.\n\n###### Process Summary\n\nThe list of file extensions that Microsoft blocked for use as OLE’s[3] (Object Linking & Embedding)\nwas manually cross referenced against executable file extensions native to Windows 7 and 10.\nThis assisted with determining which executable extensions were still permitted as OLE’s and\nresulted in a number of file extensions for further research. Out of these results, the .appref-ms\n\n1 [https://www.cobaltstrike.com/](https://www.cobaltstrike.com/)\n2 [https://www.microsoft.com/en-us/windows/windows-defender/](https://www.microsoft.com/en-us/windows/windows-defender/)\n3 [https://support.office.com/en-us/article/packager-activation-in-office-365-desktop-](https://support.office.com/en-us/article/packager-activation-in-office-365-desktop-applications-52808039-4a7c-4550-be3a-869dd338d834)\n[applications-52808039-4a7c-4550-be3a-869dd338d834](https://support.office.com/en-us/article/packager-activation-in-office-365-desktop-applications-52808039-4a7c-4550-be3a-869dd338d834)\n\n\n-----\n\nfile format was discovered to be utilized by Microsoft ClickOnce to deploy and run remote\napplications[4].\n\n_Figure 1: OLE and Filetypes_\n\nResearch on established malicious use of the .appref-ms file format did not yield any results, and\ngeneral information discovered on the file format was considerably light. However, the Microsoft\nVisual Studio documentation for ClickOnce provided significant insight into the application\ndeployment process and file format relationships therein. Applying an attacker’s mindset to this\nprocess, coupled with supplementary information discovered throughout the research phase,\nultimately resulted in the development of multiple methods of payload delivery - to include\nutilization of the .appref-ms file as an OLE. Additional methods of abusing the .appref-ms file\nwere discovered, which led to the application of this filetype as a method of managing long term\nC2 (Command and Control) sessions with remote hosts.\n\n#### Microsoft Applications Overview\n\n###### Application Publishing Overview - Online & Offline Availability\n\nAn application can be published in C# with Visual Studio 2015 or Visual Studio 2017. The\napplication and any supporting files may either be published locally or to a remote server. If a\nremote server is chosen, the files may be uploaded via FTP (File Transfer Protocol) or to a file\nshare. Once published, a directory tree will be established and populated at the designated location.\nThe root folder of the directory will contain the setup.exe, publish.htm, and .application files.\n\n4 [https://fileinfo.com/extension/appref-ms](https://fileinfo.com/extension/appref-ms)\n\n\n-----\n\n  - Setup.exe is a direct download link for an executable that install the application\n\n  - The .application file which will run the installation via Microsoft’s ClickOnce\n\n  - Publish.htm is a web page that provides a link to both setup.exe and the .application\n\nFor each deployment there will also be directories published in the root folder that correspond to\nthe application version number. The publish.htm landing page will always link to the latest\ndeployed application version.\n\n_Figure 2: Publish.htm_\n\nOnce an application is published as “Online & Offline Availability”, it can be installed by the end\nuser. As part of the installation process, an .appref-ms file is generated within the user’s start menu\nunder a folder that shares the name of the application.\n\n_Figure 3: PatchManager.appref-ms_\n\nThe .appref-ms file can be ran to check for updates and run the application. This is the crux of the\nmalicious deployment mechanism, as an .appref-ms file can be ran even if the application was not\npreviously installed. Upon execution it will connect with the deployment server to install and run\nthe application in the same method as before. It should be noted that the .appref-ms file will only\nwork with applications published via the Online & Offline Availability deployment method.\n\n\n-----\n\n###### Application Deployment Process\n\nThere are multiple steps required to publish an application in this method. From Microsoft’s\nVisual Studio, an application can be published following the steps below.\n\nOpen the C# payload that will be deployed in Visual Studio. Select the “Project > Properties”\nmenu option to manipulate the required settings for deployment.\n\n_Figure 4: Application Settings_\n\nFrom the “Application” settings you can set the name for the application to be deployed. You can\nalso specify the .net framework to be used for deployment. Regarding the .net framework utilized:\n\n  - .net framework 4.5 is required for AES256 Code Signing Certificates\n\n  - .net framework version 3.5 and up can use any browser\n\n`o` prior versions are limited to Internet Explorer\n\n  - The .net framework utilized must be installed on the end user’s host\n\nFor the remaining settings, the output type should be set to “Windows Application” to limit\nunnecessary pop-ups. Additionally, an icon for the application can be set if preferred though this\nwill result in an additional file being dropped to disk and should be accounted for in any cleanup\nprocedures taken.\n\n\n-----\n\n_Figure 5: Code Signing Settings_\n\nIf code signing certificates will be used to sign the application, settings will need to be configured\nin the “Signing” section of the properties. Load your code signing certificate and specify that it\nshould also be used to sign the assembly. As additional layers, you can also specify a timestamp\nserver to be used in the publishing process and use your code signing certificates to sign the\nmanifest files that direct ClickOnce throughout the application installation process.\n\n_Figure 6: Publish Settings_\nThe next step is to establish the publish settings within the properties. Here you will specify the\ndirectory the application will be deployed to. If it is a remote server, it will need to be deployed\n\n\n-----\n\nover FTP (File Transfer Protocol). This section is also where you will specify that the application\nwill be deployed as “Online & Offline Availability”.\n\nOnline Only deployment does not perform an installation, and is utilized for one-time deployment\nof applications. Online & Offline Availability provides an installation of the application and is\nintended for more persistent use. Online Only can also be used maliciously via the .application\nlink[5], but does not provide an avenue for ClickOnce interaction via the .appref-ms filetype.\n\nThe publish version can be arbitrarily set to any version number, though upon publishing the\napplication the .appref-ms file, .application link, and setup.exe files generated will always refer to\nthe highest version.\n\nOnce these settings are configured, by clicking “Updates” from within the publish settings some\nadditional options are provided.\n\n_Figure 7: Update Settings_\n\nBy selecting “The application should check for updates” the application will always check in with\nthe deployment server to see if there is a more recent version of the application. By setting “Before\nthe application starts” it can be specified that the application will force install any established\nupdates before running the application should they be found. As long as the user approved of the\ninitial application installation, any updates to the application will not require user approval. In this\nsection a minimum version number can also be specified for updates, in addition to specifying a\nseparate location where the update is located if required.\n\n5 [https://www.slideshare.net/NetSPI/all-you-need-is-one-a-click-once-love-story-secure360-](https://www.slideshare.net/NetSPI/all-you-need-is-one-a-click-once-love-story-secure360-2015)\n[2015](https://www.slideshare.net/NetSPI/all-you-need-is-one-a-click-once-love-story-secure360-2015)\n\n\n-----\n\nWith all of these settings configured, the application is ready to be published. The “Publish\nWizard” or “Publish Now” buttons in the publish settings pane may be used to initiate the\npublishing process. Once enacted, Visual Studio will connect to the provided server and deploy\nall the associated files for the application and it is ready for delivery to the end user.\n\n_Figure 8: Application Deployment Validation_\n\n###### Application Installation Process\n\nFrom the end user’s perspective, the application can be installed via ClickOnce from two different\navenues. They could open the .application directly, via hyperlink, or through the “launch” link in\nthe publish.htm page. Or, they could locally run the .appref-ms file. In either case, ClickOnce\ndirects the installation for the application from there through the dfsvc.exe component.\n\nRunning either the .appref-ms file or the .application file will direct ClickOnce to run the\ndeployment manifest hosted on the deployment server. The deployment manifest will specify the\ndirectory where the latest version of the application manifest is hosted, along with the permissions\nin which the application will be executed.\n\n\n-----\n\n_Figure 9: Deployment Manifest Snippet_\n\nClickOnce then opens the application manifest as directed by the deployment manifest. The\napplication manifest provides the location of the application’s exe.deploy file, which is then\ndownloaded locally to the end user’s host and the application is installed then executed with the\nestablished permissions pending the end user’s approval.\n\n_Figure 10: Application Manifest Snippet_\n\nOnce ClickOnce performs this process, the end user is prompted to permit the installation itself.\nA dialog box appears asking if they will “Install” or “Don’t Install” the application.\n\n_Figure 11: Application Install Prompt_\n\n\n-----\n\nThe prompt displays the name of the application, deployment server, and the publisher information\nas determined by the code signing certificates. Once the user selects install, the following actions\ntake place:\n\n  - Application files are placed in the following directory:\n\n`o` C:\\Users\\<username>\\AppData\\Local\\Apps\\2.0\\<random string>\n\n  - A registry key is added under:\n\n`o` HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Uninstall\n\n  - A directory is placed in the start menu with the same name of the application:\n\n`o` The appref-ms file is located in this directory\n`o` There will also be a “Support URL” in this directory if one is published\n\n  - The application is executed\n\nPost deployment, in normal operations the end user may run the .appref-ms file to check for\nupdates then run the application again. They may also uninstall the application using the native\nWindows uninstall tool.\n\n#### Appref-ms abuse for payload delivery\n\n###### Pre-Deployment Requirements\n\nPrior to publishing and utilizing the malicious application, steps will need to be taken to limit\nactions that could notify the end user to the malicious activity and an appref-ms file will need to\nbe generated. With this activity, actions that could alert the end user were determined to be the\npopulation within the start menu folder and uninstall utility. Modifications can be made to the C#\ncode prior to deployment to remove these actions and further hide the execution of the payload.\n\nRegarding the start menu folder deployment, the folder and subsequent .appref-ms file will be\ngenerated to:\n\nC:\\Users\\<username>\\AppData\\Roaming\\Microsoft\\Windows\\Start\n\nMenu\\Programs\\<Application name>\\<Application Files>\n\n_Figure 12: Application in Start Menu_\n\nWe can remove this as part of the application deployment by specifying its deletion upon\napplication execution. From within the C# payload a section can be built where the user’s appdata\ndirectory is specified, and a path to the Start Menu folder is provided therein. The .appref-ms file\ncan then be directed for deletion, with additional iterations of it being set for deletion as well. This\n\n\n-----\n\nextra step is specified as there may be additional numbers added to the file on deployment should\nthe end user install the application numerous times.\n\n_Figure 13: File and Folder Deletion_\n\nWith the application folder void of contents, the folder itself can then be deleted as specified. A\ncatch is added with a specific error number to add in to the social engineering aspect of phishing,\nso if the end user reports back to the operator that the “application failed to run” the error number\ncan be specified to provide insight into how far the malicious application got in the process or if\nthere were any true errors with deployment.\n\nThe registry key is a slightly more involved process as the key tree name is provided a random\nstring upon installation. However, the display name within the key tree still matches the\napplication name.\n\n_Figure 14: Application Uninstall Registry Key_\n\nTo remove this key, code will need to be added that will parse through the display names of each\nof the key trees under HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Uninstall. Once the\ndisplay name for a key tree is found to be a match, the key tree can then be specified for deletion.\n\n\n-----\n\n_Figure 15: Key Tree Deletion_\n\nAs previously mentioned, an .appref-ms file will also need to be generated. This could be done by\ninstalling the application locally to a test system, however if the prior steps are followed it will be\nremoved as part of the installation process. To remedy this, an .appref-ms file may be generated\nlocally.\n\nAn .appref-ms file consists of the following in a single line:\n\n  - URL to the application in the format “<URL to .application>#<application name>”\n\n  - Culture\n\n  - Public key token\n\n  - Architecture\n\nThis required information can be found in the “Assembly Identification” section of the .application\nfile once it has been published.\n\n_Figure 16: .appref-ms data in .application file_\n\nOnce the line of text has been provided, to execute properly it will need to be saved as an .apprefms file with UTF-16 LE encoding. Once saved, this .appref-ms file will execute just as an .apprefms file deployed upon application installation will execute.\n\n\n-----\n\n_Figure 17: Generating an .appref-ms_\n\n###### Initial Access - Phishing via OLE Delivery\n\nAs the .appref-ms filetype is not flagged as malicious by Gmail or Outlook, you could attach it\ndirectly to an e-mail to gain initial access upon code execution on the end user’s host. However,\nto further give credence to the social engineering aspects of phishing it may be prudent to use the\n.appref-ms file as an OLE within a Word document.\n\nAs with any other OLE, the .appref-ms file is embedded within a Word document, named\nappropriately, and provided an icon of choice. It can then be delivered to the end user, and\nexecution will take place once the OLE is double clicked. To make the end user more susceptible\nto the phishing campaign the method of execution should be taken into account. As the one click\nrequired for execution will be the end user agreeing to install the application once it has been\nopened, the OLE naming convention and overall phishing campaign should lead the end user to\nperform that action.\n\n_Figure 18: .appref-ms Word OLE_\n\nRegardless of what the .appref-ms is named as an OLE, once the user executes it they will be\nprompted to “open” the file. The prompt will show the full filename, including the filetype. As\nsuch, targets selected for this method of phishing should be non-technical personnel, such as\nHuman Resources or financial assistants. Once the user clicks “Open”, they will be prompted to\ninstall the application.\n\n\n-----\n\n_Figure 19: OLE Execution_\n\nA small dialog box will briefly flash as ClickOnce performs its side of the operations. This dialog\nbox appears for roughly 1 to 2 seconds before installing and running the malicious application.\n\n_Figure 20: ClickOnce Dialog Box_\n\nWith code signing certificates in place, no further action past clicking “Install” is required by the\nend user. If code signing certificates are not used and Microsoft SmartScreen is enabled, then the\nuser will have an additional prompt they will need to approve before execution. The user will need\nto select “More info” followed by “Run Anyways”.\n\n_Figure 21: SmartScreen_\n\n\n-----\n\n###### Initial Access - Phishing via Hyperlink Delivery\n\nAs hyperlink delivery relies on the .application file and not .appref-ms, it is available in both\nOnline Only and Online & Offline Availability. By providing the end user a direct link to the\n.application file, they could click the link to perform the required code execution via ClickOnce.\nThe required steps will be similar to the execution process above. Once the hyperlink is delivered\nas part of the phishing campaign and ran, the user will be asked if they want to open the application.\n\n_Figure 22: .application Hyperlink_\n\nFrom there the required steps for code execution are the same as when the user clicked “Open” on\nthe Word document OLE. They will need to click install, the ClickOnce dialog box will briefly\nappear, and the payload will be executed.\n\n###### Initial Access - Phishing via HTA Delivery\n\nAnother example of using ClickOnce as a method of code delivery would be by creating an HTA\n(HTML Application) link. This would still require the end user to click a link in the same method\nreferenced in the prior section, though this may provide an additional avenue should the operator\nfind a direct .application link is blocked or not operating as intended.\n\nDfshim.dll is the library that ClickOnce uses to manage application downloads and updates.\nThrough a Visual Basic script, rundll32.exe can be called to invoke dfshim.dll and run the\napplication.\n\n_Figure 23: ClickOnce Delivery HTA_\n\nThe operator would need to provide the full URL to the .application file in the example code above\nand save / host it as an .hta file. From there a link to the .hta file could be sent to the end user for\nexecution. Upon clicking the link, the user’s browser would open and provide the “Do you want\nto open this application” prompt.  Once “Run” is selected, the same steps and requirements\nestablished in the prior delivery examples take place for code execution. It should be noted that\nthis specific script is a proof of concept of HTA delivery, and is more in-line with testing technical\n\n\n-----\n\ncontrols than for use in a red team operation. Rundll32 is monitored heavily and this specific script\nwould be flagged by Windows Defender.\n\n#### C2 Management via .appref-ms \n\n###### Establishing Persistence\n\nAs the .appref-ms filetype will run the application upon execution, there are different ways that it\ncould be incorporated into a pre-established method of persistence. Once the application has been\ninstalled, no additional approvals for execution or updates are required. As such the .appref-ms\nfile could be place in the user’s startup folder so it executes on boot, could be triggered for\nexecution by a scheduled task, or could be added to the startup through a registry modification.\n\nAs an example, the payload could be modified to automatically establish persistence by copying\nthe .appref-ms file to the user’s startup folder as part of the deployment process before deleting it\nfrom the Start Menu. This example, when coordinated with established means of lateral\nmovement, could provide a method for establishing sleeper footholds within the remote\nenvironment. However, initial application installation would still need to be approved by the end\nuser on any hosts moved to. Due to this, there will still be a level of social engineering involved\nto get the required initial approval when .appref-ms is used for lateral movement. The application\nshould be named appropriately to entice the end user to perform the install.\n\n###### Foothold management via Forced Application Updates\n\nAs the .appref-ms only needs approval from the end user on the initial installation, updates to the\napplication will be executed without any additional interaction. As long as the publishing settings\nrequire the latest version to be ran, any time the .appref-ms file checks in to the deployment server\nit will install and run any updates that have been pushed upon execution. When coupled with a\npersistence mechanism, this capability can be leveraged to provide remote management of C2\nfootholds within the network environment for further action.\n\nIn normal red team operations, it is common to manage multiple “lanes” of C2. Each lane could\nmanage multiple domains for traffic and host interaction, utilize separate methods of persistence\nor lateral movement, and more. Should defensive personnel become aware of the operator’s\nactivity, they may block communications to those domains or perform other actions of\nremediation. In these circumstances it is prudent to have other established footholds that operate\non separate lanes of C2, so other avenues of regaining access can be leveraged.\n\nSince an .appref-ms file does not require approval or user interaction after the initial installation,\nit is possible to use .appref-ms to initially deploy a non-malicious application to a host just for the\npurpose of establishing a foothold. Should the host be scanned or monitored, the only point of\ndetection would be the application checking with the deployment server at its pre-established time.\nAs the domain is utilizing a separate lane from the primary channels of C2, neither the application\nor the domain are being utilized to perform malicious activity at the time. As such, overall\ndetection should fly under the radar.\n\n\n-----\n\nTo illustrate this, see the graphic below. For this example, the first three hosts have an established\nlane of C2 maintaining communications with the red team. The fourth host has an .appref-ms\napplication that is set to run at 0800hrs each morning.\n\n_Figure 24: C2 Example Phase 1_\n\nOnce the red team’s activity has been discovered, the defenders block the domains used to maintain\ncommunications over that lane of C2.\n\n_Figure 25: C2 Example Phase 2_\n\nTo reestablish communications within the network, a malicious update can be pushed to the\ndeployment server. When the .appref-ms executes at 0800hrs and checks in with the server, the\napplication will be updated with the malicious payload.\n\n\n-----\n\n_Figure 26: C2 Example Phase 3_\n\nThis updated payload will establish communications over a separate lane of C2 from the initial\noperations, using domains for communications that have not been flagged by the defenders. This\nwill provide the red team an opportunity to re-entrench within the environment with relatively\nminimal effort and resume operations.\n\n_Figure 27: C2 Example Phase 4_\n\nRegardless of the number of hosts being utilized as sleeper footholds, it will only take a single\nupdate to deploy a malicious payload across them all as they check in with the deployment server.\nThis could provide a simple means of regaining access to multiple areas in the environment, but\nthe more hosts used with this tactic the higher the rate of detection overall. To further obfuscate\nthis activity, it is recommended that various hosts selected to be footholds utilize different\ndeployment servers and different persistence mechanisms when possible.\n\n\n-----\n\n#### Conclusions\n\nThe .appref-ms file format can be used to perform malicious activity in various ways, all while\ntechnically operating as it was intended to be used. It provides some additional avenues for code\nexecution through phishing, and could even be used to manage C2 sleeper footholds through its\napplication update capability. This research was undertaken to provide operators with some\nadditional tools to be used in their operations, and it should be specified that for a red team to be\nsuccessful no single technique should be relied upon. Innovation and variation in tactics are critical\nto success, and .appref-ms use is no exception. The abuse of the .appref-ms file type results in\ncode execution, but code to be executed will still need to be provided. When possible, using\ndifferent payloads with different campaigns could help further obfuscate this activity.\n\nAlthough requirements for user interaction are limited, they are crucial to execution and it may\nprove difficult to get a user to click “Install”. Catering social engineering campaigns around these\nnotions and establishing trust with a user before delivering the payload will help with overall\nsuccess. To that note, code signing certificates will assist greatly in this measure. Without them,\nSmartScreen on Windows 10 hosts will require the user to go through a difficult additional step\nbefore code execution takes place.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "99fdc3ef-333d-48f5-a4a1-becd788c7b80",
            "created_at": "2022-10-25T15:28:29.802983Z",
            "updated_at": "2022-10-25T15:28:29.802983Z",
            "deleted_at": null,
            "name": "MITRE",
            "url": "https://github.com/mitre-attack/attack-stix-data",
            "description": "MITRE ATT&CK STIX Data",
            "reports": null
        }
    ],
    "references": [
        "https://i.blackhat.com/USA-19/Wednesday/us-19-Burke-ClickOnce-And-Youre-In-When-Appref-Ms-Abuse-Is-Operating-As-Intended-wp.pdf?_gl=1*1jv89bf*_gcl_au*NjAyMzkzMjc3LjE3MjQ4MDk4OTQ.*_ga*MTk5OTA3ODkwMC4xNzI0ODA5ODk0*_ga_K4JK67TFYV*MTcyNDgwOTg5NC4xLjEuMTcyNDgwOTk1Ny4wLjAuMA..&_ga=2.256219723.1512103758.1724809895-1999078900.1724809894"
    ],
    "report_names": [
        "us-19-Burke-ClickOnce-And-Youre-In-When-Appref-Ms-Abuse-Is-Operating-As-Intended-wp.pdf?_gl=1*1jv89bf*_gcl_au*NjAyMzkzMjc3LjE3MjQ4MDk4OTQ.*_ga*MTk5OTA3ODkwMC4xNzI0ODA5ODk0*_ga_K4JK67TFYV*MTcyNDgwOTg5NC4xLjEuMTcyNDgwOTk1Ny4wLjAuMA..&_ga=2.256219723.1512103758.1724809895-1999078900.1724809894"
    ],
    "threat_actors": [
        {
            "id": "610a7295-3139-4f34-8cec-b3da40add480",
            "created_at": "2023-01-06T13:46:38.608142Z",
            "updated_at": "2025-03-27T02:00:02.87217Z",
            "deleted_at": null,
            "main_name": "Cobalt",
            "aliases": [
                "Cobalt Gang",
                "GOLD KINGSWOOD",
                "COBALT SPIDER",
                "G0080",
                "Mule Libra",
                "Cobalt Group"
            ],
            "source_name": "MISPGALAXY:Cobalt",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1730426765,
    "ts_updated_at": 1743041358,
    "ts_creation_date": 1564358919,
    "ts_modification_date": 1564358919,
    "files": {
        "pdf": "https://archive.orkl.eu/056afc03b338c3e3c17f091cb47a966388dcd98a.pdf",
        "text": "https://archive.orkl.eu/056afc03b338c3e3c17f091cb47a966388dcd98a.txt",
        "img": "https://archive.orkl.eu/056afc03b338c3e3c17f091cb47a966388dcd98a.jpg"
    }
}