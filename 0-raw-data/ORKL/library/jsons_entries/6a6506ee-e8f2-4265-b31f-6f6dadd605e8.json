{
    "id": "6a6506ee-e8f2-4265-b31f-6f6dadd605e8",
    "created_at": "2023-01-12T15:03:37.531898Z",
    "updated_at": "2025-03-27T02:10:49.37203Z",
    "deleted_at": null,
    "sha1_hash": "7cf5c318ac3142b8a3ada5fa392203d6319820da",
    "title": "2021-05-13 - Newly observed PHP-based skimmer shows ongoing Magecart Group 12 activity",
    "authors": "",
    "file_creation_date": "2022-05-28T19:21:49Z",
    "file_modification_date": "2022-05-28T19:21:49Z",
    "file_size": 1532734,
    "plain_text": "# Newly observed PHP-based skimmer shows ongoing Magecart Group 12 activity\n\n**blog.malwarebytes.com/cybercrime/2021/05/newly-observed-php-based-skimmer-shows-ongoing-magecart-group-12-**\nactivity/\n\nThreat Intelligence Team May 13, 2021\n\n_This blog post was authored by Jérôme Segura_\n\nWeb skimming continues to be a real and impactful threat to online merchants and shoppers.\nThe threat actors in this space greatly range in sophistication from amateurs all the way to\n[nation state groups like Lazarus.](https://blog.group-ib.com/btc_changer)\n\nIn terms of security, many e-commerce shops remain vulnerable because they have not\nupgraded their content management software (CMS) in years. The campaign we are looking\nat today is about a number of Magento 1 websites that have been compromised by a very\nactive skimmer group.\n\nWe believe that Magecart Group 12, identified as being behind the Magento 1 hacking spree\nlast fall, continues to distribute new malware that was observed by security researchers\nrecently. These web shells known as Smilodon or Megalodon are used to dynamically load\nJavaScript skimming code via server-side requests into online stores. This technique is\ninteresting as most client-side security tools will not be able to detect or block the skimmer.\n\n## Web shell hidden as favicon\n\nWhile performing a crawl of Magento 1 websites, we detected a new piece of malware\ndisguised as a favicon. The file named Magento.png attempts to pass itself as ‘image/png’\nbut does not have the proper PNG format for a valid image file.\n\n\n-----\n\nThe way it is injected in compromised sites is by replacing the legitimate shortcut icon tags\n[with a path to the fake PNG file. Unlike previous incidents where a fake favicon image was](https://blog.malwarebytes.com/threat-analysis/2020/05/credit-card-skimmer-masquerades-as-favicon/)\nused to hide malicious JavaScript code, this turned out to be a PHP web shell. However, in\nits current implementation this PHP script won’t be loaded properly.\n\n\n-----\n\nWeb shells are a very popular type of malware encountered on websites that allow an\nattacker to maintain remote access and administration. They are typically uploaded onto a\nweb server after exploitation of a vulnerability (i.e. SQL injection).\n\nTo better understand what this webshell is meant to do, we can decode the reverse Base64\nencoded blurb. We see that it retrieves data from an external host at zolo[.]pw.\n\n\n-----\n\nFurther looking into the m1_2021_force directory reveals additional code very specific to\ncredit card skimming.\n\n\n-----\n\n-----\n\nThe data exfiltration part matches what researcher Denis @unmaskparasites had found back\n[in March on WordPress sites (Smilodon malware) which also steals user credentials:](https://twitter.com/unmaskparasites/status/1370579966069383168?s=20)\n\n\n-----\n\n[A similar PHP file (Mage.php) was reported by SanSec as well:](https://twitter.com/sansecio/status/1367404202461450244?s=20)\n\n\n-----\n\n[That same path/filename was previously mentioned by SanSec during the Magento 1 EOL](https://twitter.com/sansecio/status/1305491408489451522?s=20)\nhacking spree:\n\n\n-----\n\nThis hints that we are possibly looking at the same threat actors then and now, which we can\nconfirm by looking at the infrastructure being used.\n\n## Magecart Group 12 again\n\nBecause we found the favicon webshells on Magento 1.x websites we thought there might\nbe a tie with the hacking that took place last year when exploits for the Magento 1 branch (no\n[longer maintained) were found. RiskIQ documented these compromises and linked them](https://community.riskiq.com/article/fda1f967)\nwith Magecart Group 12 at the time.\n\nThe newest domain name we found (zolo[.]pw) happens to be hosted on the same IP\naddress (217.12.204[.]185) as recaptcha-in[.]pw and google-statik[.]pw, domains previously\nassociated with Magecart Group 12.\n\n\n-----\n\nThere is a lot of publicly documented material on the activities of Group 1 also known for\n[their ‘ant and cockroach‘ skimmer, their](https://twitter.com/unmaskparasites/status/1234917686242619393?s=20) [decoy CloudFlare library or their](https://blog.malwarebytes.com/threat-analysis/2020/03/rocket-loader-skimmer-impersonates-cloudflare-library-in-clever-scheme/) abuse of favicon\nfiles.\n\n## Dynamically loaded skimmer\n\nThere are a number of ways to load skimming code but the most common one is by calling\nan external JavaScript ressource. When a customer visits an online store, their browser will\nmake a request to a domain hosting the skimmer. Although criminals will constantly expand\non their infrastructure it is relatively easy to block these skimmers using a domain/IP\ndatabase approach.\n\n\n-----\n\nIn comparison, the skimmer we showed in this blog dynamically injects code into the\nmerchant site. The request to the malicious domain hosting the skimming code is not made\nclient-side but server-side instead. As such a database blocking approach would not work\nhere unless all compromised stores were blacklisted, which is a catch-22 situation. A more\neffective, but also more complex and prone to false positives approach, is to inspect the\nDOM in real time and detect when malicious code has been loaded.\n\nWe continue to track this campaign and other activities from Magecart Group 12. Online\nmerchants need to ensure their stores are up-to-date and hardened, not only to pass PCI\nstandards but also to maintain the trust shoppers place in them. If you are shopping online\nit’s always good to exercize some vigilance and equip yourself with security tools such as our\n[Malwarebytes web protection and](https://www.malwarebytes.com/) [Browser Guard.](https://www.malwarebytes.com/browserguard/)\n\n## References\n\n[https://blog.group-ib.com/btc_changer](https://blog.group-ib.com/btc_changer)\n\n[https://twitter.com/unmaskparasites/status/1370579966069383168?s=20](https://twitter.com/unmaskparasites/status/1370579966069383168?s=20)\n\n[https://twitter.com/sansecio/status/1367404202461450244?s=20](https://twitter.com/sansecio/status/1367404202461450244?s=20)\n\n[https://twitter.com/unmaskparasites/status/1234917686242619393?s=20](https://twitter.com/unmaskparasites/status/1234917686242619393?s=20)\n\n[https://community.riskiq.com/article/fda1f967](https://community.riskiq.com/article/fda1f967)\n\n[https://blog.sucuri.net/2020/04/web-skimmer-with-a-domain-name-generator.html](https://blog.sucuri.net/2020/04/web-skimmer-with-a-domain-name-generator.html)\n\n[https://sansec.io/research/cardbleed](https://sansec.io/research/cardbleed)\n\nhttps://blog.malwarebytes.com/threat-analysis/2020/05/credit-card-skimmer-masqueradesas-favicon/\n\n## Indicators of Compromise\n\nfacedook[.]host\n\npathc[.]space\n\npredator[.]host\n\ngoogle-statik[.]pw\n\nrecaptcha-in[.]pw\n\nsexrura[.]pw\n\nzolo[.]pw\n\nkermo[.]pw\n\npsas[.]pw\n\npathc[.]space\n\npredator[.]host\n\ngooogletagmanager[ ]online\n\n\n-----\n\nimags[.]pw\ny5[.]ms\nautocapital[.]pw\nmyicons[.]net\nqr202754[.]pw\nthesun[.]pw\nredorn[.]space\nzeborn[.]pw\ngoogletagmanagr[.]com\nautocapital[.]pw\nhttp[.]ps\nxxx-club[.]pw\ny5[.]ms\n\n195[.]123[.]217[.]18\n217[.]12[.]204[.]185\n83[.]166[.]241[.]205\n83[.]166[.]242[.]105\n83[.]166[.]244[.]113\n83[.]166[.]244[.]152\n83[.]166[.]244[.]189\n83[.]166[.]244[.]76\n83[.]166[.]245[.]131\n83[.]166[.]246[.]34\n83[.]166[.]246[.]81\n83[.]166[.]248[.]67\n\njamal.budunoff@yandex[.]ru\nmuhtarpashatashanov@yandex[.]ru\nnikola-az@rambler[.]ru\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-05-13 - Newly observed PHP-based skimmer shows ongoing Magecart Group 12 activity.pdf"
    ],
    "report_names": [
        "2021-05-13 - Newly observed PHP-based skimmer shows ongoing Magecart Group 12 activity.pdf"
    ],
    "threat_actors": [
        {
            "id": "5a0483f5-09b3-4673-bb5a-56d41eaf91ed",
            "created_at": "2023-01-06T13:46:38.814104Z",
            "updated_at": "2025-03-27T02:00:02.925972Z",
            "deleted_at": null,
            "main_name": "MageCart",
            "aliases": [],
            "source_name": "MISPGALAXY:MageCart",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673535817,
    "ts_updated_at": 1743041449,
    "ts_creation_date": 1653765709,
    "ts_modification_date": 1653765709,
    "files": {
        "pdf": "https://archive.orkl.eu/7cf5c318ac3142b8a3ada5fa392203d6319820da.pdf",
        "text": "https://archive.orkl.eu/7cf5c318ac3142b8a3ada5fa392203d6319820da.txt",
        "img": "https://archive.orkl.eu/7cf5c318ac3142b8a3ada5fa392203d6319820da.jpg"
    }
}