{
    "id": "584eac90-07dc-4607-a434-db3a0ebecede",
    "created_at": "2023-01-12T15:09:00.175935Z",
    "updated_at": "2025-03-27T02:16:34.694639Z",
    "deleted_at": null,
    "sha1_hash": "d4752bf6e317b6f3b04205a5550ee9cbb903715a",
    "title": "2020-12-14 - SolarWinds Orion and UNC2452 – Summary and Recommendations",
    "authors": "",
    "file_creation_date": "2022-05-28T01:31:47Z",
    "file_modification_date": "2022-05-28T01:31:47Z",
    "file_size": 206402,
    "plain_text": "# SolarWinds Orion and UNC2452 – Summary and Recommendations\n\n**[trustedsec.com/blog/solarwinds-orion-and-unc2452-summary-and-recommendations/](https://www.trustedsec.com/blog/solarwinds-orion-and-unc2452-summary-and-recommendations/)**\n\nBy Nick Gilberti in Incident Response, Incident Response & Forensics December 14, 2020\n\nIn the wake of recent revelations regarding a supply chain compromise of the SolarWinds\nOrion platform by a nation-state actor, and subsequent targeting of private sector and\ngovernment organizations by said actor, the TrustedSec Incident Response team is releasing\nthe following summary and guidance. This guidance reflects information from industry\ncounterparts as well as recommendations derived from internal experience. To reiterate, this\ndocument represents a consolidation of the vast number of useful resources and information\nbeing shared by the community; it is intended to provide a convenient source of information\nand guidance as the situation develops, not to label existing research as our own.\n\nFor the purposes of this discussion, we will be referring to the threat actor dubbed\n“UNC2452” by FireEye and the corresponding malware identified as “SUNBURST,” which\nhas capabilities to deliver a memory-only dropper named “TEARDROP,” which in turn has\nbeen observed delivering Cobalt Strike Beacon and other malware.\n\n## Highlights\n\n\n-----\n\nUNC2452 has been observed leveraging a supply chain compromise to serve\nbackdoored updates for the SolarWinds Orion Platform software.\n\nAs such, the initial access vector into a target environment is the Orion software\nitself, rather than “traditional” access vectors such as RDP or phishing.\nCompromised builds of the SolarWinds Orion Platform include versions 2019.4 HF 5\nthrough 2020.2.1, released between March 2020 and June 2020.\n\nThe malicious update is digitally signed by SolarWinds and has been publicly\navailable since March 2020.\nThe threat actor has implemented extensive measures to blend their activity with\nlegitimate SolarWinds behavior, with the goal of evading detection.\nThe threat actor has been observed conducting a variety of post-exploitation activities\nto act on objectives and establish long-term access, including:\n\nAdding or modifying federation trusts in Azure AD to accept tokens signed with\nactor-owned certificates;\nAdding x509 keys/password credentials to OAuth Applications or Service\nPrincipals, often with the goal of reading mail content from Exchange Online\nservices; and\nLeveraging memory-only droppers to deploy Cobalt Strike BEACON and\npotentially other backdoors.\n\n## Recommendations Related to SolarWinds Orion Product\n\nUpgrade to Orion Platform version 2020.2.1 HF 1 as soon as possible. [1]\n\nDirections for checking which version of the Orion Platform you are using can be\nfound here: https://support.solarwinds.com/SuccessCenter/s/article/Determinewhich-version-of-a-SolarWinds-Orion-product-I-have-installed?language=en_US\nTo check which hotfixes you have applied, go here:\nhttps://support.solarwinds.com/SuccessCenter/s/article/Verify-hotfixes-that-havebeen-installed?language=en_US\nIf you cannot upgrade immediately, follow guidelines available here for hardening\nyour Orion Platform instance:\n\nhttps://www.solarwinds.com/-/media/solarwinds/swdcv2/landing-pages/trust[center/resources/secure-configuration-in-the-orion-platform.ashx?](https://www.solarwinds.com/-/media/solarwinds/swdcv2/landing-pages/trust-center/resources/secure-configuration-in-the-orion-platform.ashx?rev=32603e0c87d84085b081f99a33fe5f4d&hash=62A998B9753957D82BC0F07005D38368)\nrev=32603e0c87d84085b081f99a33fe5f4d&hash=62A998B9753957D82BC0F07005D38368\n\n\n-----\n\nNamely, ensure your Orion Platform installation is placed behind a firewall, disable\nInternet access to the Orion Platform, and limit the ports and connections only to what\nis necessary.\n\nSolarWinds expects to release an additional hotfix (2020.2.1 HF 2) on Tuesday,\nDecember 15, 2020.\n\nThis hotfix will replace the compromised software component and provide\nadditional security enhancements.\nMicrosoft recommends considering disabling SolarWinds in your environment\nentirely, “until you are confident that you have a trustworthy build free of injected\ncode.”\nIf SolarWinds infrastructure is not isolated, consider taking the following steps:\n\nRestrict scope of connectivity to endpoints from SolarWinds servers, especially\nthose that would be considered Tier 0/crown jewel assets;\nRestrict the scope of accounts that have local administrator privileges on\nSolarWinds servers; and\nBlock Internet egress from servers or other endpoints with SolarWinds software.\nConsider (at a minimum) changing passwords for accounts that have access to\nSolarWinds servers/infrastructure. Based upon further review/investigation, additional\nremediation measures may be required.\nIf SolarWinds is used to manage networking infrastructure, consider conducting a\nreview of network device configurations for unexpected/unauthorized modifications.\nNote, this is a proactive measure due to the scope of SolarWinds functionality, not\nbased on investigative findings.\n\n## Recommendations for General Investigation and Hunting\n\nBlock and cross-reference the list of command-and-control endpoints provided in the\nIndicators of Compromise resources below with remote access logs to identify\nunauthorized access.\n\nAttacker IP addresses will likely be in the same country as the target\norganization.\nUse geolocation data to identify instances of “impossible travel,” i.e., if an account\nlogged in from a distance after logging in nearby.\nUNC2452 has been observed mimicking victim hostnames in their command-andcontrol infrastructure[2]. Querying Internet scanning services such as Shodan for\ninternal hostnames may reveal attacker infrastructure used against your organization.\nCheck for a single system authenticating to multiple systems with multiple accounts.\n\nThis may be difficult without sufficient visibility into network and host-based\nactivity.\nSeveral antivirus and Endpoint Detection and Response (EDR) products have now\nimplemented detections for the “SUNBURST” malware. Ensuring that anti-virus and\nEDR data sources are up to date is critical.\n\n\n-----\n\n## Recommendations for Hardening Active Directory[3]\n\nEnsure that user accounts with administrative rights follow best practices, including the\nuse of privileged access workstations, Just-In-Time/Just-Enough-Admin, and strong\nauthentication.\n\nReduce the number of users that are members of highly privileged Directory\nRoles, like Global Administrator, Application Administrator, and Cloud Application\nAdministrator.\nMonitor your Active Directory environment for anomalous activity and protect sensitive\ncredentials.\n\nEnsure that service accounts and service principals with administrative rights use\nhigh entropy secrets, certificates, and are stored securely.\nMonitor for changes to secrets used for service accounts and service principals\nas part of your security monitoring program.\nMonitor for anomalous use of service accounts.\n\nMicrosoft Azure AD indicates session anomalies, as does Microsoft Cloud\nApp Security, if in use.\nReduce attack surface by removing/disabling unused or unnecessary applications and\nservice principals.\n\nReduce permissions on active applications and service principals, especially\napplications with AppOnly permissions.\n\n## Indicators of Compromise\n\nRefer to the FireEye GitHub repository for the latest Indicators of Compromise and\nsignatures:\n\n[https://github.com/fireeye/sunburst_countermeasures](https://github.com/fireeye/sunburst_countermeasures)\n\n### References and Suggested Reading\n\n[1] [https://www.solarwinds.com/securityadvisory](https://www.solarwinds.com/securityadvisory)\n\n[2] https://www.fireeye.com/blog/threat-research/2020/12/evasive-attacker-leveragessolarwinds-supply-chain-compromises-with-sunburst-backdoor.html\n\n[3] https://msrc-blog.microsoft.com/2020/12/13/customer-guidance-on-recent-nation-statecyber-attacks/\n\nFor a full Incident Response playbook on responding to the Sunburst backdoor, see\n[“SolarWinds Backdoor (Sunburst) Incident Response Playbook” by TrustedSec’s Incident](https://www.trustedsec.com/blog/solarwinds-backdoor-sunburst-incident-response-playbook/)\nResponse Team.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2020/2020-12-14 - SolarWinds Orion and UNC2452 – Summary and Recommendations.pdf"
    ],
    "report_names": [
        "2020-12-14 - SolarWinds Orion and UNC2452 – Summary and Recommendations.pdf"
    ],
    "threat_actors": [
        {
            "id": "b43e5ea9-d8c8-4efa-b5bf-f1efb37174ba",
            "created_at": "2022-10-25T16:07:24.36191Z",
            "updated_at": "2025-03-27T02:02:10.1909Z",
            "deleted_at": null,
            "main_name": "UNC2452",
            "aliases": [
                "Dark Halo",
                "Nobelium",
                "SolarStorm",
                "StellarParticle",
                "UNC2452"
            ],
            "source_name": "ETDA:UNC2452",
            "tools": [],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "610a7295-3139-4f34-8cec-b3da40add480",
            "created_at": "2023-01-06T13:46:38.608142Z",
            "updated_at": "2025-03-27T02:00:02.87217Z",
            "deleted_at": null,
            "main_name": "Cobalt",
            "aliases": [
                "Cobalt Gang",
                "GOLD KINGSWOOD",
                "COBALT SPIDER",
                "G0080",
                "Mule Libra",
                "Cobalt Group"
            ],
            "source_name": "MISPGALAXY:Cobalt",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "70872c3a-e788-4b55-a7d6-b2df52001ad0",
            "created_at": "2023-01-06T13:46:39.18401Z",
            "updated_at": "2025-03-27T02:00:03.01553Z",
            "deleted_at": null,
            "main_name": "UNC2452",
            "aliases": [
                "DarkHalo",
                "StellarParticle",
                "NOBELIUM",
                "Solar Phoenix",
                "Midnight Blizzard"
            ],
            "source_name": "MISPGALAXY:UNC2452",
            "tools": [
                "SNOWYAMBER",
                "HALFRIG",
                "QUARTERRIG"
            ],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "1d3f9dec-b033-48a5-8b1e-f67a29429e89",
            "created_at": "2022-10-25T15:50:23.739197Z",
            "updated_at": "2025-03-27T02:00:55.536417Z",
            "deleted_at": null,
            "main_name": "UNC2452",
            "aliases": [
                "UNC2452",
                "NOBELIUM",
                "StellarParticle",
                "Dark Halo"
            ],
            "source_name": "MITRE:UNC2452",
            "tools": [
                "Sibot",
                "Mimikatz",
                "Cobalt Strike",
                "AdFind",
                "GoldMax"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "5b748f86-ac32-4715-be9f-6cf25ae48a4e",
            "created_at": "2024-06-04T02:03:07.956135Z",
            "updated_at": "2025-03-27T02:05:17.407352Z",
            "deleted_at": null,
            "main_name": "IRON HEMLOCK",
            "aliases": [
                "ATK7 ",
                "Blue Kitsune ",
                "Cozy Bear ",
                "The Dukes",
                "UNC2452 ",
                "YTTRIUM ",
                "APT29 "
            ],
            "source_name": "Secureworks:IRON HEMLOCK",
            "tools": [
                " CozyCar",
                " CozyDuke",
                " DiefenDuke",
                " FatDuke",
                " HAMMERTOSS",
                " LiteDuke",
                " MiniDuke",
                " OnionDuke",
                " PolyglotDuke",
                " RegDuke",
                " RegDuke Loader",
                " SeaDuke",
                " Sliver",
                "CosmicDuke"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "a241a1ca-2bc9-450b-a07b-aae747ee2710",
            "created_at": "2024-06-19T02:03:08.150052Z",
            "updated_at": "2025-03-27T02:05:17.409596Z",
            "deleted_at": null,
            "main_name": "IRON RITUAL",
            "aliases": [
                "Blue Dev 5 ",
                "BlueBravo ",
                "Cloaked Ursa ",
                "CozyLarch ",
                "Dark Halo ",
                "Midnight Blizzard ",
                "NOBELIUM ",
                "StellarParticle ",
                "UNC2452 ",
                "APT29"
            ],
            "source_name": "Secureworks:IRON RITUAL",
            "tools": [
                " Cobalt Strike",
                " EnvyScout",
                " GoldFinder",
                " GoldMax",
                " NativeZone",
                " RAINDROP",
                " SUNBURST",
                " Sibot",
                " TEARDROP",
                " VaporRage",
                "Brute Ratel C4"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "20d3a08a-3b97-4b2f-90b8-92a89089a57a",
            "created_at": "2022-10-25T15:50:23.548494Z",
            "updated_at": "2025-03-27T02:00:55.49688Z",
            "deleted_at": null,
            "main_name": "APT29",
            "aliases": [
                "APT29",
                "IRON RITUAL",
                "IRON HEMLOCK",
                "NobleBaron",
                "Dark Halo",
                "NOBELIUM",
                "UNC2452",
                "YTTRIUM",
                "The Dukes",
                "Cozy Bear",
                "CozyDuke",
                "SolarStorm",
                "Blue Kitsune",
                "UNC3524",
                "Midnight Blizzard"
            ],
            "source_name": "MITRE:APT29",
            "tools": [
                "PinchDuke",
                "ROADTools",
                "WellMail",
                "CozyCar",
                "Mimikatz",
                "Tasklist",
                "OnionDuke",
                "FatDuke",
                "POSHSPY",
                "EnvyScout",
                "SoreFang",
                "GeminiDuke",
                "GoldMax",
                "FoggyWeb",
                "SDelete",
                "PolyglotDuke",
                "AADInternals",
                "MiniDuke",
                "SeaDuke",
                "Sibot",
                "RegDuke",
                "CloudDuke",
                "GoldFinder",
                "AdFind",
                "PsExec",
                "NativeZone",
                "Systeminfo",
                "ipconfig",
                "Impacket",
                "Cobalt Strike",
                "PowerDuke",
                "QUIETEXIT",
                "HAMMERTOSS",
                "BoomBox",
                "CosmicDuke",
                "WellMess",
                "VaporRage",
                "LiteDuke"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "f27790ff-4ee0-40a5-9c84-2b523a9d3270",
            "created_at": "2022-10-25T16:07:23.341684Z",
            "updated_at": "2025-03-27T02:02:09.74554Z",
            "deleted_at": null,
            "main_name": "APT 29",
            "aliases": [
                "APT 29",
                "ATK 7",
                "Blue Dev 5",
                "BlueBravo",
                "Cloaked Ursa",
                "CloudLook",
                "Cozy Bear",
                "Dark Halo",
                "Earth Koshchei",
                "Grizzly Steppe",
                "Group 100",
                "ITG11",
                "Iron Hemlock",
                "Iron Ritual",
                "Midnight Blizzard",
                "Minidionis",
                "Nobelium",
                "NobleBaron",
                "Operation Ghost",
                "Operation Office monkeys",
                "Operation StellarParticle",
                "SilverFish",
                "Solar Phoenix",
                "SolarStorm",
                "StellarParticle",
                "TEMP.Monkeys",
                "The Dukes",
                "UNC2452",
                "UNC3524",
                "Yttrium"
            ],
            "source_name": "ETDA:APT 29",
            "tools": [
                "7-Zip",
                "ATI-Agent",
                "AdFind",
                "Agentemis",
                "AtNow",
                "BEATDROP",
                "BotgenStudios",
                "CEELOADER",
                "Cloud Duke",
                "CloudDuke",
                "CloudLook",
                "Cobalt Strike",
                "CobaltStrike",
                "CosmicDuke",
                "Cozer",
                "CozyBear",
                "CozyCar",
                "CozyDuke",
                "Danfuan",
                "EnvyScout",
                "EuroAPT",
                "FatDuke",
                "FoggyWeb",
                "GeminiDuke",
                "Geppei",
                "GoldFinder",
                "GoldMax",
                "GraphDrop",
                "GraphicalNeutrino",
                "GraphicalProton",
                "HAMMERTOSS",
                "HammerDuke",
                "LOLBAS",
                "LOLBins",
                "LiteDuke",
                "Living off the Land",
                "MagicWeb",
                "Mimikatz",
                "MiniDionis",
                "MiniDuke",
                "NemesisGemina",
                "NetDuke",
                "OnionDuke",
                "POSHSPY",
                "PinchDuke",
                "PolyglotDuke",
                "PowerDuke",
                "QUIETEXIT",
                "ROOTSAW",
                "RegDuke",
                "Rubeus",
                "SNOWYAMBER",
                "SPICYBEAT",
                "SUNSHUTTLE",
                "SeaDaddy",
                "SeaDask",
                "SeaDesk",
                "SeaDuke",
                "Sharp-SMBExec",
                "SharpView",
                "Sibot",
                "Solorigate",
                "SoreFang",
                "TinyBaron",
                "WINELOADER",
                "WellMail",
                "WellMess",
                "cobeacon",
                "elf.wellmess",
                "reGeorg",
                "tDiscoverer"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673536140,
    "ts_updated_at": 1743041794,
    "ts_creation_date": 1653701507,
    "ts_modification_date": 1653701507,
    "files": {
        "pdf": "https://archive.orkl.eu/d4752bf6e317b6f3b04205a5550ee9cbb903715a.pdf",
        "text": "https://archive.orkl.eu/d4752bf6e317b6f3b04205a5550ee9cbb903715a.txt",
        "img": "https://archive.orkl.eu/d4752bf6e317b6f3b04205a5550ee9cbb903715a.jpg"
    }
}