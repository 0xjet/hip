{
    "id": "a1720d93-ef40-4cb9-baf9-e117a5093284",
    "created_at": "2023-01-12T15:10:49.820805Z",
    "updated_at": "2025-03-27T02:16:26.557268Z",
    "deleted_at": null,
    "sha1_hash": "66821472242ab4e33165b5065a4658d7b530c5f0",
    "title": "2022-08-29 - Malicious Cookie Stuffing Chrome Extensions with 1.4 Million Users",
    "authors": "",
    "file_creation_date": "2022-09-01T10:30:24Z",
    "file_modification_date": "2022-09-01T10:30:24Z",
    "file_size": 4036020,
    "plain_text": "# Malicious Cookie Stuffing Chrome Extensions with 1.4 Million Users\n\n**[mcafee.com/blogs/other-blogs/mcafee-labs/malicious-cookie-stuffing-chrome-extensions-with-1-4-million-users](https://www.mcafee.com/blogs/other-blogs/mcafee-labs/malicious-cookie-stuffing-chrome-extensions-with-1-4-million-users)**\n\nAugust 29, 2022\n\n[McAfee Labs](https://www.mcafee.com/blogs/author/mcafee-labs/)\n\nAug 29, 2022\n\n7 MIN READ\n\nAuthored by Oliver Devane and Vallabh Chole\n\n[A few months ago, we blogged about malicious extensions redirecting users to phishing sites](https://www.mcafee.com/blogs/other-blogs/mcafee-labs/imposter-netflix-chrome-extension-dupes-100k-users/)\nand inserting affiliate IDs into cookies of eCommerce sites. Since that time, we have\ninvestigated several other malicious extensions and discovered 5 extensions with a total\ninstall base of over 1,400,000\n\n\n-----\n\nThe extensions offer various functions such as enabling users to watch Netflix shows\ntogether, website coupons, and taking screenshots of a website. The latter borrows several\nphrases from another popular extension called GoFullPage\n\nApart from offering the intended functionality, the extensions also track the user’s browsing\nactivity. Every website visited is sent to servers owned by the extension creator. They do this\nso that they can insert code into eCommerce websites being visited. This action modifies the\n\n\n-----\n\ncookies on the site so that the extension authors receive affiliate payment for any items\npurchased.\n\nThe users of the extensions are unaware of this functionality and the privacy risk of every\nsite being visited being sent to the servers of the extension authors.\n\nThe 5 extensions are\n\nName Extension ID Users\n\nNetflix Party mmnbenehknklpbendgmgngeaignppnbe 800,000\n\nNetflix Party 2 flijfnhifgdcbhglkneplegafminjnhn 300,000\n\n\nFlipShope – Price Tracker\nExtension\n\nFull Page Screenshot Capture –\nScreenshotting\n\n\nadikhbfjdbjkhelbdnffogkobkekkkej 80,000\n\npojgkmkfincpdkdgjepkmdekcahmckjp 200,000\n\n\nAutoBuy Flash Sales gbnahglfafmhaehbdmjedfhdmimjcbed 20,000\n\n## Technical Analysis\n\nThis section contains the technical analysis of the malicious chrome extension\n‘mmnbenehknklpbendgmgngeaignppnbe’. All 5 extensions perform similar behavior.\n\n## Manifest.json\n\n\n-----\n\nThe manifest.json sets the background page as bg.html. This HTML file loads b0.js and this\nis responsible for sending the URL being visited and injecting code into the eCommerce\nsites.\n\n## B0.js\n\nThe b0.js script contains many functions. This blog will focus on the functions which are\nresponsible for sending the visited URLs to the server and processing the response.\n\nChrome extensions work by subscribing to events which they then use as triggers to perform\na certain activity. The extensions analyzed subscribe to events coming from\nchrome.tabs.onUpdated. chrome.tabs.onUpdated will trigger when a user navigates to a new\nURL within a tab.\n\n\n-----\n\nOnce this event triggers, the extension will set a variable called curl with the URL of the tab\nby using the tab.url variable. It creates several other variables which are then sent to\nd.langhort.com. The POST data is in the following format:\n\n**Variable** **Description**\n\nRef Base64 encoded referral URL\n\nCounty The county of the device\n\nCity The city of the device\n\nZip The zip code of the device\n\nApisend A random ID generated for the user.\n\nName Base64 encoded URL being visited\n\next_name The name of the chrome extensions\n\nThe random ID is created by selecting 8 random characters in a character set. The code is\nshown below:\n\n\n-----\n\nThe country, city, and zip are gathered using ip-api.com. The code is shown below:\n\nUpon receiving the URL, langhort.com will check if it matches a list of websites that it has an\naffiliate ID for, and If it does, it will respond to the query. An example of this is shown below:\n\nThe data returned is in JSON format. The response is checked using the function below and\nwill invoke further functions depending on what the response contains.\n\n\n-----\n\nTwo of the functions are detailed below:\n\n## Result[‘c’] – passf_url\n\nIf the result is ‘c’ such as the one in this blog, the extension will query the returned URL. It\nwill then check the response and if the status is 200 or 404, it will check if the query\nresponded with a URL. If it did, it would insert the URL that is received from the server as an\nIframe on the website being visited.\n\n## Result[‘e’] setCookie\n\nIf the result is ‘e’, the extension would insert the result as a cookie. We were unable to find a\nresponse of ‘e’ during our analysis, but this would enable the authors to add any cookie to\nany website as the extensions had the correct ‘cookie’ permissions.\n\n\n-----\n\n## Behavioral flow\n\nThe images below show the step-by-step flow of events while navigating to the BestBuy\nwebsite.\n\n\n-----\n\n1. The user navigates to bestbuy.com and the extension posts this URL in a Base64\n\nformat to d.langhort.com/chrome/TrackData/\n2. Langhort.com responds with “c” and the URL. The “c” means the extension will invoke\n\nthe function passf_url()\n3. passf_url() will perform a request against the URL\n4. the URL queried in step 3 is redirected using a 301 response to bestbuy.com with an\n\naffiliate ID associated with the Extension owners\n5. The extension will insert the URL as an Iframe in the bestbuy.com site being visited by\n\nthe user\n6. Shows the Cookie being set for the Affiliate ID associated with the Extension owners.\n\nThey will now receive a commission for any purchases made on bestbuy.com\n\nHere is a video of the events\n\n\n-----\n\nWatch Video At:\n\nhttps://youtu.be/-N7MW8tJBvQ\n\n## Time delay to avoid automated analysis\n\nWe discovered an interesting trick in a few of the extensions that would prevent malicious\nactivity from being identified in automated analysis environments. They contained a time\ncheck before they would perform any malicious activity. This was done by checking if the\ncurrent date is > 15 days from the time of installation.\n\n\n-----\n\n## Conclusion \n\nThis blog highlights the risk of installing extensions, even those that have a large install base\nas they can still contain malicious code.\n\nMcAfee advises its customers to be cautious when installing Chrome extensions and pay\nattention to the permissions that they are requesting.\n\n\n-----\n\nThe permissions will be shown by Chrome before the installation of the extension.\nCustomers should take extra steps to verify the authenticity if the extension is requesting\npermissions that enable it to run on every website you visit such as the one detailed in this\nblog\n\nMcAfee customers are protected against the malicious sites detailed in this blog as they are\nblocked with McAfee WebAdvisor as shown below.\n\nThe Malicious code within the extension is detected as JTI/Suspect. Please perform a ‘Full’\nscan via the product.\n\nType Value Product Detected\n\n\n-----\n\nChrome\nExtension\n\nChrome\nExtension\n\nChrome\nExtension\n\nChrome\nExtension\n\nChrome\nExtension\n\n\nNetflix Party –\nmmnbenehknklpbendgmgngeaignppnbe\n\nFlipShope – Price Tracker Extension –\nadikhbfjdbjkhelbdnffogkobkekkkej\n\nFull Page Screenshot Capture\npojgkmkfincpdkdgjepkmdekcahmckjp\n\nNetflix Party 2 –\nflijfnhifgdcbhglkneplegafminjnhn\n\nAutoBuy Flash Sales\ngbnahglfafmhaehbdmjedfhdmimjcbed\n\n\nTotal Protection\nand LiveSafe\n\nTotal Protection\nand LiveSafe\n\nTotal Protection\nand LiveSafe\n\nTotal Protection\nand LiveSafe\n\nTotal Protection\nand LiveSafe\n\n\nJTI/Suspect\n\nJTI/Suspect\n\nJTI/Suspect\n\nJTI/Suspect\n\nJTI/Suspect\n\nBlocked\n\nBlocked\n\nBlocked\n\nBlocked\n\nBlocked\n\nBlocked\n\nBlocked\n\n\nURL www.netflixparty1.com McAfee\nWebAdvisor\n\nURL netflixpartyplus.com McAfee\nWebAdvisor\n\nURL flipshope.com McAfee\nWebAdvisor\n\nURL goscreenshotting.com McAfee\nWebAdvisor\n\nURL langhort.com McAfee\nWebAdvisor\n\nURL Unscart.in McAfee\nWebAdvisor\n\nURL autobuyapp.com McAfee\nWebAdvisor\n\n\n[McAfee Labs\nThreat Research Team](https://www.mcafee.com/blogs/author/mcafee-labs/)\nMcAfee Labs is one of the leading sources for threat research, threat intelligence, and\ncybersecurity thought leadership. See our blog posts below for more information.\n\n## More from McAfee Labs\n\n\n-----\n\n[Technical Support Scams – What to look out for](https://www.mcafee.com/blogs/other-blogs/mcafee-labs/technical-support-scams-what-to-look-out-for/%20)\n\nAuthored by Oliver Devane Technical Support Scams have been targeting computer users\nfor many years. Their goal...\n\nAug 02, 2022 |  10 MIN READ\n\n[New HiddenAds malware affects 1M+ users and hides on the Google Play Store](https://www.mcafee.com/blogs/other-blogs/mcafee-labs/new-hiddenads-malware-that-runs-automatically-and-hides-on-google-play-1m-users-affected/%20)\n\nAuthored by Dexter Shin McAfee’s Mobile Research Team has identified new malware on the\nGoogle Play Store....\n\nJul 28, 2022 |  6 MIN READ\n\n[Rise of LNK (Shortcut files) Malware](https://www.mcafee.com/blogs/other-blogs/mcafee-labs/rise-of-lnk-shortcut-files-malware/%20)\n\nAuthored by Lakshya Mathur An LNK file is a Windows Shortcut that serves as a pointer to...\n\nJun 21, 2022 |  6 MIN READ\n\n\n-----\n\n[Instagram credentials Stealers: Free Followers or Free Likes](https://www.mcafee.com/blogs/other-blogs/mcafee-labs/instagram-credentials-stealers-free-followers-or-free-likes/%20)\n\nAuthored by Dexter Shin Instagram has become a platform with over a billion monthly active\nusers. Many...\n\nJun 10, 2022 |  6 MIN READ\n\n[Instagram credentials Stealer: Disguised as Mod App](https://www.mcafee.com/blogs/other-blogs/mcafee-labs/instagram-credentials-stealer-disguised-as-mod-app/%20)\n\nAuthored by Dexter Shin McAfee’s Mobile Research Team introduced a new Android\nmalware targeting Instagram users who...\n\nJun 10, 2022 |  4 MIN READ\n\n[Phishing Campaigns featuring Ursnif Trojan on the Rise](https://www.mcafee.com/blogs/other-blogs/mcafee-labs/phishing-campaigns-featuring-ursnif-trojan/%20)\n\nAuthored by Jyothi Naveen and Kiran Raj McAfee Labs have been observing a spike in\nphishing campaigns...\n\nJun 07, 2022 |  6 MIN READ\n\n\n-----\n\n[Crypto Scammers Exploit: Elon Musk Speaks on Cryptocurrency](https://www.mcafee.com/blogs/other-blogs/mcafee-labs/crypto-scammers-exploit-elon-musk-speaks-on-cryptocurrency/%20)\n\nBy Oliver Devane Update: In the past 24 hours (from time of publication) McAfee has\nidentified 15...\n\nMay 25, 2022 |  4 MIN READ\n\n[Scammers are Exploiting Ukraine Donations](https://www.mcafee.com/blogs/other-blogs/mcafee-labs/scammers-are-exploiting-ukraine-donations/%20)\n\nAuthored by Vallabh Chole and Oliver Devane Scammers are very quick at reacting to\ncurrent events, so...\n\nApr 01, 2022 |  7 MIN READ\n\n[Imposter Netflix Chrome Extension Dupes 100k Users](https://www.mcafee.com/blogs/other-blogs/mcafee-labs/imposter-netflix-chrome-extension-dupes-100k-users/%20)\n\nAuthored by Oliver Devane, Vallabh Chole, and Aayush Tyagi McAfee has recently\nobserved several malicious Chrome Extensions...\n\nMar 10, 2022 |  8 MIN READ\n\n\n-----\n\n[Why Am I Getting All These Notifications on my Phone?](https://www.mcafee.com/blogs/other-blogs/mcafee-labs/why-am-i-getting-all-these-notifications-on-my-phone/%20)\n\nAuthored by Oliver Devane and Vallabh Chole  Notifications on Chrome and Edge, both\ndesktop browsers, are commonplace,...\n\nFeb 25, 2022 |  5 MIN READ\n\n[Emotet’s Uncommon Approach of Masking IP Addresses](https://www.mcafee.com/blogs/other-blogs/mcafee-labs/emotets-uncommon-approach-of-masking-ip-addresses/%20)\n\nIn a recent campaign of Emotet, McAfee Researchers observed a change in techniques. The\nEmotet maldoc was...\n\nFeb 04, 2022 |  4 MIN READ\n\n[HANCITOR DOC drops via CLIPBOARD](https://www.mcafee.com/blogs/other-blogs/mcafee-labs/hancitor-doc-drops-via-clipboard/%20)\n\nHancitor, a loader that provides Malware as a Service, has been observed distributing\nmalware such as FickerStealer,...\n\nDec 13, 2021 |  6 MIN READ\n\n\n-----\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-08-29 - Malicious Cookie Stuffing Chrome Extensions with 1.4 Million Users.pdf"
    ],
    "report_names": [
        "2022-08-29 - Malicious Cookie Stuffing Chrome Extensions with 1.4 Million Users.pdf"
    ],
    "threat_actors": [
        {
            "id": "75108fc1-7f6a-450e-b024-10284f3f62bb",
            "created_at": "2024-11-01T02:00:52.756877Z",
            "updated_at": "2025-03-27T02:00:55.544216Z",
            "deleted_at": null,
            "main_name": "Play",
            "aliases": null,
            "source_name": "MITRE:Play",
            "tools": [
                "Nltest",
                "AdFind",
                "PsExec",
                "Wevtutil",
                "Cobalt Strike",
                "Playcrypt",
                "Mimikatz"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1673536249,
    "ts_updated_at": 1743041786,
    "ts_creation_date": 1662028224,
    "ts_modification_date": 1662028224,
    "files": {
        "pdf": "https://archive.orkl.eu/66821472242ab4e33165b5065a4658d7b530c5f0.pdf",
        "text": "https://archive.orkl.eu/66821472242ab4e33165b5065a4658d7b530c5f0.txt",
        "img": "https://archive.orkl.eu/66821472242ab4e33165b5065a4658d7b530c5f0.jpg"
    }
}