{
    "id": "37ea885b-4a5b-4503-9405-11a61a3b33b5",
    "created_at": "2023-01-12T15:09:09.95208Z",
    "updated_at": "2025-03-27T02:05:38.146821Z",
    "deleted_at": null,
    "sha1_hash": "22f57a17f52d8d2d510db074c816ba3c9d00179e",
    "title": "2022-03-09 - Raccoon Stealer- “Trash panda” abuses Telegram",
    "authors": "",
    "file_creation_date": "2022-05-28T15:44:36Z",
    "file_modification_date": "2022-05-28T15:44:36Z",
    "file_size": 1089176,
    "plain_text": "# Raccoon Stealer: “Trash panda” abuses Telegram\n\n**decoded.avast.io/vladimirmartyanov/raccoon-stealer-trash-panda-abuses-telegram**\n\nby [Vladimir MartyanovMarch 9, 20227 min read](https://decoded.avast.io/author/vladimirmartyanov/)\n\n\nMarch 9, 2022\n\n\nWe recently came across a stealer, called `Raccoon Stealer, a name given to it by its author. Raccoon Stealer uses the` `Telegram`\ninfrastructure to store and update actual `C&C addresses.`\n\nRaccoon Stealer is a password stealer capable of stealing not just passwords, but various types of data, including:\n\nCookies, saved logins and forms data from browsers\nLogin credentials from email clients and messengers\nFiles from crypto wallets\nData from browser plugins and extension\nArbitrary files based on commands from C&C\n\nIn addition, it’s able to download and execute arbitrary files by command from its C&C. In combination with active development and promotion\non underground forums, Raccoon Stealer is prevalent and dangerous.\n\nThe oldest samples of Raccoon Stealer we’ve seen have timestamps from the `end of April 2019 . Its authors have stated the same`\nmonth as the start of selling the malware on underground forums. Since then, it has been updated many times. According to its authors, they\nfixed bugs, added features, and more.\n\n## Distribution\n\nWe’ve seen Raccoon distributed via downloaders: `Buer Loader and` `GCleaner . According to some samples, we believe it is also being`\ndistributed in the form of `fake game cheats,` `patches for cracked software (including hacks and mods for` `Fortnite,` `Valorant,`\nand `NBA2K22 ), or other software. Taking into account that Raccoon Stealer is for sale, it’s distribution techniques are limited only by the`\nimagination of the end buyers. Some samples are spread unpacked, while some are protected using `Themida or malware packers. Worth`\n[noting is that some samples were packed more than five times in a row with the same packer!](https://twitter.com/AvastThreatLabs/status/1420372556142432257)\n\n## Technical details\n\nRaccoon Stealer is written in `C/C++ and built using` `Visual Studio . Samples have a size of about` `580-600 kB . The code quality is`\nbelow average, some strings are encrypted, some are not.\n\nOnce executed, Racoon Stealer starts checking for the default user locale set on the infected device and won’t work if it’s one of the following:\n\nRussian\nUkrainian\nBelarusian\nKazakh\nKyrgyz\nArmenian\nTajik\nUzbek\n\n## C&C communications\n\nThe most interesting thing about this stealer is its communication with C&Cs. There are four values crucial for its C&C communication, which\nare hardcoded in every Raccoon Stealer sample:\n\n\n-----\n\n`_` s a ue as bee c a ged ou t es du g t e yea\n```\n   URLs of Telegram gates with channel name. Gates are used not to implement a complicated Telegram protocol and not to store any\n\n```\ncredentials inside samples\n```\n   BotID – hexadecimal string, sent to the C&C every time\n   TELEGRAM_KEY – a key to decrypt the C&C address obtained from Telegram Gate\n\n```\nLet’s look at an example to see how it works:\n```\n447c03cc63a420c07875132d35ef027adec98e7bd446cf4f7c9d45b6af40ea2b unpacked to:\nf1cfcce14739887cc7c082d44316e955841e4559ba62415e1d2c9ed57d0c6232 :\n\n```\n1. First of all, `MAIN_KEY is decrypted. See the decryption code in the image below:`\n\nIn this example, the `MAIN_KEY is` `jY1aN3zZ2j . This key is used to decrypt Telegram Gates` `URLs and` `BotID .`\n\n1. This example decodes and decrypts Telegram Gate URLs. It is stored in the sample as:\n```\n   Rf66cjXWSDBo1vlrnxFnlmWs5Hi29V1kU8o8g8VtcKby7dXlgh1EIweq4Q9e3PZJl3bZKVJok2GgpA90j35LVd34QAiXtpeV2UZQS5VrcO7UWo0E1J\n\n```\nAfter decoding Base64 it has this form:\n\nDecrypting this binary data with `RC4 using` `MAIN_KEY gives us a string with Telegram Gates:`\n\n1. The stealer has to get it’s real C&C. To do so, it requests a Telegram Gate, which returns an HTML-page:\n\n\n-----\n\nHere you can see a Telegram channel name and its status in Base64: `e74b2mD/ry6GYdwNuXl10SYoVBR7/tFgp2f-v32`\n\nThe prefix (always five characters) and postfix (always six characters) are removed and it becomes `mD/ry6GYdwNuXl10SYoVBR7/tFgp The`\nBase64 is then decoded to obtain an encrypted C&C URL:\n\nThe `TELEGRAM_KEY in this sample is a string` `739b4887457d3ffa7b811ce0d03315ce and the Raccoon uses it as a key to` `RC4 algorithm`\nto finally decrypt the C&C URL: `http://91.219.236[.]18/`\n\n1. Raccoon makes a query string with PC information (machine GUID and user name), and `BotID`\n2. Query string is encrypted with `RC4 using a` `MAIN_KEY and then encoded with Base64.`\n3. This data is sent using POST to the C&C, and the response is encoded with Base64 and encrypted with the `MAIN_KEY . Actually, it’s a`\n\nJSON with a lot of parameters and it looks like this:\n\nThus, the Telegram infrastructure is used to store and update actual C&C addresses. It looks quite convenient and reliable until Telegram\ndecides to take action.\n\n## Analysis\n\n The people behind Raccoon Stealer\n\nBased on our analysis of seller messages on underground forums, we can deduce some information about the people behind the malware.\nRaccoon Stealer was developed by a team, some (or maybe all) members of the team are Russian native speakers. Messages on the forum\nare written in Russian, and we assume they are from former USSR countries because they try to prevent the Stealer from targeting users in\nthese countries.\n\nPossible names/nicknames of group members may be supposed based on the analysis of artifacts, found in samples:\n```\n   C:\\Users\\a13xuiop1337\\\n   C:\\Users\\David\\\n\n## Prevalence\n\n```\n\n-----\n\naccoo Stea e s qu te p e a e t o `a c` `3,` `0` `eb ua y` `,` `0` ou syste s detected `o e t a` `5,000` accoo\nrelated samples. We identified `more than 1,300 distinct configs during that period.`\n\nHere is a map, showing the number of systems Avast protected from Raccoon Stealer from `March 3, 2021 - February 17, 2022 . In this`\ntime frame, Avast protected nearly `600,000 Raccoon Stealer attacks.`\n\nThe country where we have blocked the most attempts is Russia, which is interesting because the actors behind the malware don’t want to\ninfect computers in Russia or Central Asia. We believe the attacks spray and pray, distributing the malware around the world. It’s not until it\nmakes it onto a system that it begins checking for the default locale. If it is one of the language listed above, it won’t run. This explains why\nwe detected so many attack attempts in Russia, we block the malware before it can run, ie. before it can even get to the stage where it\nchecks for the device’s locale. If an unprotected device that comes across the malware with its locale set to English or any other language\nthat is not on the exception list but is in Russia, it would stiIl become infected.\n\nScreenshot with claims about not working with CIS\n\n\n-----\n\n## Telegram Channels\n\nFrom the more than 1,300 distinct configs we extracted, 429 of them are unique Telegram channels. Some of them were used only in a single\nconfig, others were used dozens of times. The most used channels were:\n```\n   jdiamond13 – 122 times\n   jjbadb0y – 44 times\n   nixsmasterbaks2 – 31 times\n   hellobyegain – 25 times\n\n```\n`h_smurf1kman_1` – 24 times\n\nThus, five of the most used channels were found in about `19% of configs.`\n\n## Malware distributed by Raccoon\n\nAs was previously mentioned, Raccoon Stealer is able to download and execute arbitrary files from a command from C&C. We managed to\ncollect some of these files. We collected `185 files, with a total size` `265 Mb, and some of the groups are:`\n```\n   Downloaders – used to download and execute other files\n   Clipboard crypto stealers – change crypto wallet addresses in the clipboard – very popular (more than 10%)\n   WhiteBlackCrypt Ransomware\n\n### Servers used to download this software\n\n```\nWe extracted unique links to other malware from Raccoon configs received from C&Cs, it was `196 unique URLs . Some analysis results:`\n\n`43%` of URLs have `HTTP scheme,` `57% –` `HTTPS .`\n```\n   83 domain names were used.\n\n```\nAbout `20% of malware were placed on` `Discord CDN`\nAbout `10% were served from` `aun3xk17k[.]space`\n\n## Conclusion\n\nWe will continue to monitor Raccoon Stealer’s activity, keeping an eye on new C&Cs, Telegram channels, and downloaded samples. We\npredict it may be used wider by other cybercrime groups. We assume the group behind Raccoon Stealer will further develop new features,\nincluding new software to steal data from, for example, as well as bypass protection this software has in place.\n\n## IoC\n```\n447c03cc63a420c07875132d35ef027adec98e7bd446cf4f7c9d45b6af40ea2b\nf1cfcce14739887cc7c082d44316e955841e4559ba62415e1d2c9ed57d0c6232\n\n```\n\n[Tagged asmalware,](https://decoded.avast.io/tag/malware/) [Malware Analysis,](https://decoded.avast.io/tag/malware-analysis/) [Racoon,](https://decoded.avast.io/tag/racoon/) [reversing,](https://decoded.avast.io/tag/reversing/) [stealer,](https://decoded.avast.io/tag/stealer/) [telegram,](https://decoded.avast.io/tag/telegram/) [trash panda](https://decoded.avast.io/tag/trash-panda/)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-03-09 - Raccoon Stealer- “Trash panda” abuses Telegram.pdf"
    ],
    "report_names": [
        "2022-03-09 - Raccoon Stealer- “Trash panda” abuses Telegram.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673536149,
    "ts_updated_at": 1743041138,
    "ts_creation_date": 1653752676,
    "ts_modification_date": 1653752676,
    "files": {
        "pdf": "https://archive.orkl.eu/22f57a17f52d8d2d510db074c816ba3c9d00179e.pdf",
        "text": "https://archive.orkl.eu/22f57a17f52d8d2d510db074c816ba3c9d00179e.txt",
        "img": "https://archive.orkl.eu/22f57a17f52d8d2d510db074c816ba3c9d00179e.jpg"
    }
}