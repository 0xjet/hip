{
    "id": "59822164-9551-4acd-9222-35a3810e41d2",
    "created_at": "2022-10-27T08:36:05.701681Z",
    "updated_at": "2025-03-27T02:14:38.885592Z",
    "deleted_at": null,
    "sha1_hash": "79b1f4889149dcc079d3413e42f46c1736815a46",
    "title": "",
    "authors": "",
    "file_creation_date": "2022-05-05T16:58:07Z",
    "file_modification_date": "2022-05-05T16:49:28Z",
    "file_size": 2319705,
    "plain_text": "#### Whitepaper\n\n## PIPEDREAM: CHERNOVITE’S EMERGING MALWARE TARGETING INDUSTRIAL CONTROL SYSTEMS\n\n\n###### Dragos, Inc.\n\n**[info@dragos.com](mailto:info%40dragos.com?subject=)**\n\n**[@DragosInc](https://twitter.com/DragosInc?ref_src=twsrc%5Egoogle%7Ctwcamp%5Eserp%7Ctwgr%5Eauthor)**\n\n\n#### Whitepaper\n\n## PIPEDREAM: CHERNOVITE’S EMERGING MALWARE TARGETING INDUSTRIAL CONTROL SYSTEMS\n\n\n-----\n\n-----\n\n### EXECUTIVE SUMMARY\n\n\n##### PIPEDREAM is the seventh-known Industrial Control Systems (ICS)-specific malware and the fifth malware specifically developed to disrupt industrial processes. PIPEDREAM demonstrates significant adversary research and development focused on the disruption, degradation, and potentially, the destruction of industrial environments and physical processes.\n\n The Dragos-designated threat group CHERNOVITE developed PIPEDREAM, which consists of a collection of components. PIPEDREAM can impact a wide variety of Programmable Logic Controllers (PLC) and industrial software, including specific Omron and Schneider Electric PLCs, and poorly configured Open Platform Communications Unified Architecture (OPC-UA) servers.\n\n One of the Schneider Electric PLCs that PIPEDREAM targets, leverages CODESYS as its underlying system architecture. PIPEDREAM uses CODESYS as a key component to abuse due to its lack of security. CODESYS is a third-party software component used by hundreds of industrial equipment vendors. While PIPEDREAM can currently identify and target PLCs from Omron and Schneider Electric, its tooling may be used to target and attack controllers from hundreds of other vendors. In sum, PIPEDREAM can target a variety of PLCs in multiple verticals due to its versatility.\n\n Dragos assesses with high confidence that PIPEDREAM has not yet been employed for disruptive or destructive effects. This is a rare case of analyzing malicious capabilities before employment of effects against victim infrastructure, giving defenders a unique opportunity to prepare in advance. Dragos assesses with high confidence that this capability was developed by a state-sponsored adversary with the intention to leverage PIPEDREAM in future operations.\n\n\n-----\n\n### CHERNOVITE - THE THREAT GROUP BEHIND PIPEDREAM\n\n\n##### Based on current observations, CHERNOVITE focuses on manipulating industrial control systems and can achieve Stage 2 of the ICS Cyber Kill Chain. As an impact-focused team, CHERNOVITE would need access facilitated by other teams to ingress into target environments.\n\n CHERNOVITE’s observable infrastructure consists of compromised, adversary-controlled command-and-control infrastructure. Their activity is expected to shift to a malicious adversary-controlled domain or webserver. CHERNOVITE is likely to use service provider infrastructure; however, there are no indications of current active infrastructure. CHERNOVITE can use target infrastructure to facilitate interactive operations and lateral movement, access enablement in an operational technology (OT) environment, and the manipulation of processes to achieve adversary intent.\n\n\n-----\n\n### WHY ARE WE PUBLISHING THIS?\n\n\n#### Threats to industrial infrastructure security are an extremely sensitive matter. Given the unique realities of industrial operations, it is often harder for defenders to react than for adversaries to leverage public information. The more time the community has to implement mitigations before new malicious capabilities become public, the better the chance the adverse effects from any attempted attacks will be reduced.\n\n Dragos identified and analyzed PIPEDREAM’s capabilities through our normal business, independent research, and collaboration with various partners in early 2022. Our primary focus is informing industrial asset owners and operators with as much information as possible. It is the team’s stance never to be first to communicate detailed technical insights on ICS threats and capabilities until the information is already going to become public; this is done as the information can often be weaponized and industrial control system (ICS) defenders need as much time as possible. Once information about threats and new capabilities are made public, Dragos’s approach is to follow up with detailed analysis and advice to the security community. This report was proactively written and readied for release as the information became public through other avenues.\n\n\n-----\n\n-----\n\n|Product|Manufacturer|Description|PIPEDREAM Attack Module|\n|---|---|---|---|\n||Omron NX1P2 PLC|Compact Machine Controller Built in EtherCAT to simplify the wiring of up to eight servo systems including for single-axis position control.|BADOMEN|\n||Omron NX-SL3300|Safety Controller SIL-3 rated safety controller. Integrated safety over EtherCAT.|BADOMEN|\n||Omron NJ501-1300 PLC|Machine Automation Controller Native OPC-UA, EtherCAT, Ethernet/IP.|BADOMEN|\n||Omron NX-ECC, NX-EIC202, NX-ECC203|EtherCAT Couplers Provides an interface between a controller and connected EtherCAT Terminals.|BADOMEN|\n||Omron R88D- 1SN10F-ECT|1S Servo Drive 1 kW, , 3-400 VAC EtherCAT type servo drive.|BADOMEN|\n||Omron S8VK|Power Supply DC 24V 5.0A DIN Rail Power Supply.|BADOMEN|\n\n\n-----\n\nTable 1: Summary of the potentially impacted technology\n\n|Product|Manufacturer|Description|PIPEDREAM Attack Module|\n|---|---|---|---|\n||Schneider Modicon M241 (TM241)|IIoT Native Edge Logic Controller EtherNet/IP; RS 232/RS 485 serial link; USB mini-B programming port|EVILSCHOLAR|\n||Schneider Modicon M251 (TM251)|Programmable Logic Controller EtherNet/IP; CANopen (master) and SAE J1939; Serial link; USB mini-B programming port|EVILSCHOLAR|\n||Schneider Modicon M221 (TM221)|Logic Controller/IO Relay PLC for hardwired architectures. EtherNet/IP; RS 232/RS 485 serial link; USB mini-B programming port|EVILSCHOLAR|\n||Schneider Modicon (TM238)|Logic Controller Standalone / “all-in-one” solution in a compact unit. Ethernet Modbus/TCP, Profibus DP, DeviceNet, etc.|EVILSCHOLAR|\n||Schneider Modicon M258 (TM258)|Logic Controller 42 or 66 digital I/O; Embedded serial link and Ethernet port; 4 analog inputs|EVILSCHOLAR|\n||Schneider LMC058|Motion Controller Solution for axis control and positioning, including automation functions|EVILSCHOLAR|\n||Schneider LMC078|Motion Controller Designed for compact machines that require a high level of performance in motion control applications. Velocity and torque control, etc.|EVILSCHOLAR EVILSCHOLAR|\n\n\n-----\n\n### PIPEDREAM SUMMARY ANALYSIS\n\n\n[1https://wwwmodbusorg/specs php; 2https://opcfoundationorg/about/opc-technologies/opc-ua/; 3https://wwwcodesyscom; 4https://enwikipedia org/wiki/ASRock](https://www.modbus.org/specs.php)\n\n\n-----\n\nCHERNOVITE’s PIPEDREAM is a highly capable offensive ICS attack framework. It can execute 36\nknown ICS attack techniques (which is 46 percent of known ICS attack tactics) as measured against\nthe MITRE ATT&CK for the ICS behavior matrix, shown in Figure 1.\n\nINHIBIT IMPAIR\n\nPRIVILEGE LATERAL COMMAND &\n\nEXECUTION PERSISTENCE EVASION DISCOVERY COLLECTION RESPONSE PROCESS IMPACT\n\nESCALATION MOVEMENT CONTROL\n\nFUNCTION CONTROL\n\nChange Exploitation Change Network Activate\n\nModify Default Automated Commonly Brute Force Damage to\n\nOperating for Privilege Operating Connection Firmware\n\nProgram Credentials Collection Used Port I/O Property\n\nMode Escalation Mode Enumeration Update Mode\n\nExploitation Data from\n\nCommand- Module Exploitation Network Connection Alarm Modify Denial of\n\nHooking of Remote Information\n\nLine Interface Firmware for Evasion Sniffing Proxy Suppression Parameter Control\n\nServices Repositories\n\nIndicator Remote Detect Standard Block\n\nExecution Project File Lateral Tool Modify\n\nRemoval on System Operating Application Command Denial of View\n\nthrough API Information Transfer Formware\n\nHost Discovery Mode Layer Protocol Message\n\nRemote System Blockk Spoof\n\nGraphical User System Program Loss of\n\nMasquerading Information I/O Image Reporting Reporting\n\nInterface Firmware Download Availability\n\nDiscovery Message Message\n\nUnauthorized\n\nWireless Remote Man in the Block Serial Loss of\n\nHooking Valid Accounts Rootkit Command\n\nSniffing Services Middle COM Control\n\nMessage\n\nModify Spoof Loss of\n\nMonitor Data\n\nController Reporting Valid Accounts Productivity\n\nProcess State Destruction\n\nTasking Message and Revenue\n\nPoint & Tag Denial of Loss of\n\nNative API\n\nIdentification Service Protection\n\nDevice\n\nProgram\n\nScripting Restart/ Loss of Safety\n\nUpload\n\nShutdown\n\nUser Screen Manipulate\n\nLoss of View\n\nExecution Capture I/O Image\n\nWireless Modify Alarm Manipulation\nSniffing Settings of Control\n\nManipulation\n\nRootkit\n\nof View\n\nTheft of\n\nService Stop Operational\n\nInformation\n\nSystem\nFirmware\n\nFigure 1 - Mapping for CHERNOVITE/PIPEDREAM MITRE ATT&CK for ICS Techniques\n\nPIPEDREAM utilizes PLC implants to execute untrusted code on the PLC devices themselves beyond\nthe view of the host-based monitoring found on Windows and Linux assets. Implants could live on\nPLCs for years before they are discovered, as only a firmware forensic analysis of a PLC would reveal\nthe existence of the implant.\n\n|INITIAL ACCESS|EXECUTION|PERSISTENCE|PRIVILEGE ESCALATION|EVASION|DISCOVERY|LATERAL MOVEMENT|COLLECTION|COMMAND & CONTROL|INHIBIT RESPONSE FUNCTION|IMPAIR PROCESS CONTROL|IMPACT|\n|---|---|---|---|---|---|---|---|---|---|---|---|\n|Data Historian Compromise|Change Operating Mode|Modify Program|Exploitation for Privilege Escalation|Change Operating Mode|Network Connection Enumeration|Default Credentials|Automated Collection|Commonly Used Port|Activate Firmware Update Mode|Brute Force I/O|Damage to Property|\n|Drive-by Compromise|Command- Line Interface|Module Firmware|Hooking|Exploitation for Evasion|Network Sniffing|Exploitation of Remote Services|Data from Information Repositories|Connection Proxy|Alarm Suppression|Modify Parameter|Denial of Control|\n|Engineering Workstation Compromise|Execution through API|Project File Information||Indicator Removal on Host|Remote System Discovery|Lateral Tool Transfer|Detect Operating Mode|Standard Application Layer Protocol|Block Command Message|Modify Formware|Denial of View|\n|Exploit Public-Facing Application|Graphical User Interface|System Firmware||Masquerading|Remote System Information Discovery|Program Download|I/O Image||Blockk Reporting Message|Spoof Reporting Message|Loss of Availability|\n|Exploitation of Remote Services|Hooking|Valid Accounts||Rootkit|Wireless Sniffing|Remote Services|Man in the Middle||Block Serial COM|Unauthorized Command Message|Loss of Control|\n|Internet Accessible Device|Modify Controller Tasking|||Spoof Reporting Message||Valid Accounts|Monitor Process State||Data Destruction||Loss of Productivity and Revenue|\n|Remote Services|Native API||||||Point & Tag Identification||Denial of Service||Loss of Protection|\n|Replication via Removable Media|Scripting||||||Program Upload||Device Restart/ Shutdown||Loss of Safety|\n|Rogue Master|User Execution||||||Screen Capture||Manipulate I/O Image||Loss of View|\n|Spearphishing Attachment|||||||Wireless Sniffing||Modify Alarm Settings||Manipulation of Control|\n|Supply Chain Compromise|||||||||Rootkit||Manipulation of View|\n|Wireless Compromise|||||||||Service Stop||Theft of Operational Information|\n||||||||||System Firmware|||\n\n\n-----\n\n#### PIPEDREAM Utilities Explained\n\nThere are a few key design decisions about\nPIPEDREAM that indicate CHERNOVITE’s\ndevelopment team characteristics.\n\nBoth EVILSCHOLAR and BADOMEN are\nextensible and modular. This fact suggests that\ndevelopers intend to support the tool long term.\nThey are aware that the toolsets need to adapt\nto new operational requirements. In other words,\nthey may need to be extended for new target\ndevices. The design is comparable to common red\nteam tools such as Metasploit and Powershell\nEmpire. Furthermore, the tools are easy to use,\nwhich means the developers are likely aware\nthey may need to be used by operators less\nknowledgeable than the developers.\n\nMOUSEHOLE provides an interactive capability\nfor manipulating OPC-UA server nodes and\nthe associated devices. MOUSEHOLE is akin\nto an upgraded CRASHOVERRIDE and is the\nfirst time Dragos has witnessed a threat group\nlearning from another threat group, in this case,\nELECTRUM’s attack. This indicates that the\n\n\nadversary is aware of successful attacks and is\nactively seeking to develop a mature capability\nto achieve a similar impact.\n\nThe addition of DUSTTUNNEL and LAZYCARGO\nto PIPEDREAM indicates that CHERNOVITE\nis not only thinking about OT. They are also\nthinking about how it can achieve an end-to-end\nattack, starting with an IT intrusion, pivoting\ninto OT, and executing an attack that covers ICS\nKill Chain Stages 1 and 2.\n\nThe breadth of knowledge required to develop\nthese tools indicates that CHERNOVITE is highly\nknowledgeable of ICS protocols, devices, and\nhow to apply this knowledge to achieve an\neffect. They likely have a budget for acquiring\ndevices to test their toolset.\n\n**Given these indicators, Dragos**\n**assesses with high confidence**\n**that CHERNOVITE is highly motivated,**\n**skilled in software development methods,**\n**well versed in ICS protocols and intrusion**\n**techniques, and well-funded.**\n\n\nThe following is a list of the utilities with their capabilities. It is important to note that while the\nadversary could use these tools together, they are not required to be deployed together. PIPEDREAM\nshould be viewed as a toolkit rather than a holistic attack suite.\n\n\n**EVILSCHOLAR**\n\nA capability\ndesigned to discover,\naccess, manipulate,\nand disable\nSchneider Electric\nPLCs.\n\n\n**BADOMEN**\nA remote shell\ncapability designed\nto interact with\nOmron software and\nPLCs.\n\n\n**MOUSEHOLE**\nA tool for interacting\nwith OPC-UA servers. It\nis designed to read and\nwrite node attribute\ndata, enumerate the\nServer Namespace and\nassociated NodeIds,\nand brute force\ncredentials.\n\n\n**DUSTTUNNEL**\n\nA custom remote\noperational implant\ncapability to perform\nhost reconnaissance\nand command-andcontrol.\n\n\n**LAZYCARGO**\n\nA capability that\ndrops and exploits a\nvulnerable ASRock\ndriver to load an\nunsigned driver.\n\n\n-----\n\n**Dragos Platform Detections are designed to alert on PIPEDREAM behavior**\n**at these points in the ICS Cyber Kill Chain**\n\n### 01\nDEVELOP\n\nInitial Communication Attempt Unauthorized Login\n\nInitial Device Connectivity\n\n### 02\nTEST\n\nFile Transfer of PIPEDREAM Telnet Login Bypass\n\n### 03 HTTP Login Bypass File Upload\nDELIVER\n\nFile Transfer of LAZYCARGO\n\n### 04\nINSTALL/ Interrogate Windows System Get PLC Status\nMODIFY\n\nRead PLC Operation HTTP Encrypted Post\n\nActivate Telnet Password Brute Force Attempt\n\n### 05\nEXECUTE\n\nScan for Devices\n\nFigure 3: ICS Cyber Kill Chain\n\n#### Suspected Deployment Scenarios\n\nThe following provides an example scenario of the deployment of PIPEDREAM components, along\nwith the possible impact based on Dragos’ analysis of PIPEDREAM malware to date.\n\n\n###### PHASE 1: IT NETWORK INTRUSION\n\nCHERNOVITE could deploy DUSTTUNNEL within\nan enterprise network through phishing or\ncompromised remote access. Using DUSTTUNNEL's\ncommand-and-control functions, CHERNOVITE\ncould drop additional tools such as Mimikatz to\ngather credentials to access a legitimate account and\ngain a persistent foothold in the enterprise network.\nFrom there, DUSTTUNNEL can allow the adversary\nto enumerate the network to locate IT-OT DMZ and\nthen move laterally using captured credentials. At\nthis stage, CHERNOVITE may deploy LAZYCARGO\n\n\nto install a rootkit to protect the established foothold\nwithin the corporate network.\n\n###### PHASE 2: OT ENUMERATION\n\nDUSTTUNNEL can allow CHERNOVITE to traverse\nto operational technology (OT) networks or jump\nboxes in the IT-OT demilitarized zone (DMZ).\nLAZYCARGO could also be deployed at this stage on\noperator stations/Human-Machine Interface (HMI)\nto install unsigned device drivers to manipulate\ntraffic being sent between HMIs and field devices.\n\n\n-----\n\n###### PHASE 3: CONTROLLER COMPROMISE\n\nOnce in the OT network, CHERNOVITE can\nleverage MOUSEHOLE to identify and brute force\nauthentication to an OPC-UA server. CHERNOVITE\ncan then enumerate devices on the OT network and\nsee configurations, with the potential to manipulate\ntags and control points. Depending on the identified\nplant infrastructure, CHERNOVITE could deploy\nEVILSCHOLAR and/or BADOMEN to interact with\nSchneider Electric PLCs and Omron PLCs.\n\n\nused to pivot into protected network segments\nby abusing Schneider Electric controller routing\nbehavior. This functionality would allow further\nenumeration of controllers to be targeted in\nModbus enumeration and exploitation.\n\n###### PHASE 5: CROWN-JEWEL OBJECTIVES\n\n\nCapabilities to reprogram and potentially disable\nsafety controllers and other machine automation\ncontrollers could then be leveraged to disable\nemergency shutdown systems, and subsequently\nmanipulate the operational environment to\nunsafe conditions.\n\n\n###### PHASE 4: FURTHER COMPROMISE OF CONTROL NETWORKS\n\nEVILSCHOLAR proxy functionality could then be\n\n|SCADA & HMI|Col2|Col3|\n|---|---|---|\n||||\n||||\n|PPIIVVOOTT BAD UUSSIINNGG OMRON PPLLCC|||\n||||\n\n\n**EVILSCHOLAR**\nSCHNEIDER PLC EXPLOITATION\n\n\n**BADOMEN**\nOMRON PLC/SIS EXPLOITATION\n\n\n**MOUSEHOLE**\nENUMERATE PLCs AND\nOT NETWORKS\n\n\nFigure 4: CHERNOVITE scenario example\n\n\n**LAZYCARGO**\nUNSIGNED DRIVER LOADING\n\n\n-----\n\n### DEFENDING AGAINST PIPEDREAM – WHAT YOU CAN DO NOW\n\n\nThe Dragos Platform contains several detections for PIPEDREAM activity. Dragos customers employing\nthe most recent Knowledge Packs can find these detections in the Dragos platform under the Content\ntab. Managed service customers can go through OT Watch. Dragos has already searched through\nNeighborhood Keeper participants for activity. Asset owners who are not Dragos platform customers\nshould focus on identifying the Tactics, Techniques, and Procedures (TTP) detailed in this report and\nfollow the recommended actions to mitigate impacts to your environment in Table 2. Much of the\nguidance to the community in the form of standards, frameworks, and regulations heavily focuses on\npreventing cyber attacks. This means the community often puts very limited focus on detection and\nresponse. Given the type of threat, it is imperative to be able to detect and respond instead of simply\nattempting to prevent access.\n\n|Action|Target|\n|---|---|\n|Change default credentials|Where feasible, in conjunction with operations and site personnel for Schneider Electric TM2xx series PLCs: Beginning with firmware 5.0, the devices use default credentials' Administrator’/’Administrator', and these should be changed to a complex password using the EcoStruxure software.|\n|Restrict access to UDP/1740-1743, TCP/1105, and TCP/11740.|For all Schneider Electric TM2xx series PLCs|\n|Restrict access to TCP/11740.|For non-Schneider PLCs known to communicate with this port from the engineering workstation|\n|Disable the Schneider NetManage discovery service.|In conjunction with operations and site personnel, disable Schneider NetManage discovery service, as it is used by CHERNOVITE to discover PLCs (see VA-2019-02).|\n|Monitor affected PLCs for new outbound connections.|Look for communications to other PLCs on the network, on: UDP/1740-1743, TCP/1105, and TCP/11740.|\n|Validate the engineering workstation software - EcoStruxure Machine Expert.|Remove unnecessary software. If possible, apply application allow listing software on the workstation. Restrict the workstation from making outbound network connections, especially to Internet services.|\n\n\n-----\n\n#### Omron Technology Mitigations\n\nTable 3: Omron Technology Mitigations\n\n**Action** **Target**\n\nRestrict access to TCP/80, For all Omron PLCs. Only allow EWS systems to communicate on these ports.\nTCP/9600, and UDP/9600\n\nValidate the engineering Remove unnecessary software. If possible, apply application allow listing\nworkstation software - Omron software on the workstation. Restrict the workstation from making outbound\nSysmac/CX-One/NX IO network connections, especially to Internet services.\nConfigurator\n\n#### OPC-UA Mitigations\n\nTable 4: OPC-UA Mitigations\n\n|Action|Target|\n|---|---|\n|Restrict access to TCP/80, TCP/9600, and UDP/9600|For all Omron PLCs. Only allow EWS systems to communicate on these ports.|\n|Validate the engineering workstation software - Omron Sysmac/CX-One/NX IO Confgi urator|Remove unnecessary software. If possible, apply application allow listing software on the workstation. Restrict the workstation from making outbound network connections, especially to Internet services.|\n\n|Action|Target|\n|---|---|\n|Enable OPC-UA security|Ensure OPC-UA security is correctly configured with application authentication enabled and explicit trust lists. Ensure the certificate private keys and user passwords are stored securely. Ensure mDNS (which actively broadcasts the location of OPC-UA servers) is disabled on all machines. ICS operators can manage the security configuration for their OPC-UA devices using their engineering workstation software (in most cases). Using \"sign-only\" security mode with OPC-UA is optimal for ICS environments that leverage network monitoring solutions (like the Dragos Platform). Sign- only security mode sends messages unencrypted but with an authentication code that allows receivers to be sure the message came from a trusted sender. This protects against tools like MOUSEHOLE that send unauthorized messages to OPC-UA clients and servers while allowing the packets to be inspected by network security devices. Specific recommendations for OPC-UA security best practices can be found on the OPC-UA foundation’s website: https://opcfoundation.org/UA/Security/BestPractices.pdf|\n\n\n-----\n\n#### MITRE ATT&CK for ICS Techniques\n\nIn addition, focus detection and monitoring efforts on the TTPs outlined in this document, including the\nfollowing:\n\nTable 5: MITRE ATT&CK for ICS Technologies\n\n|Activity|MITRE ATT&CK for ICS Technique|\n|---|---|\n|File Transfer of PIPEDREAM|T1544 Remote File Copy; T1105 Ingress Tool Transfer|\n|PIPEDREAM Execution|T1059 Command and Scripting Interpreter|\n|PIPEDREAM Interrogate Windows System|T1047 Windows Management Instrumentation|\n|BADOMEN Telnet Login Bypass|T1552.001 Unsecured Credentials: Credentials in Files|\n|BADOMEN HTTP Login Bypass|T1552.001 Unsecured Credentials: Credentials in Files|\n|BADOMEN Get PLC Status|T0868 Detect Operating Mode|\n|BADOMEN PLC Read Operation|T0888 Remote System Information Discovery|\n|BADOMEN HTTP Encrypted Post|T1573 Encrypted Channel|\n|BADOMEN Activate Telnet|T1021 Remote Services|\n|BADOMEN File Upload|T1544 Remote File Copy|\n|EVILSCHOLAR Password Brute Force Attempt|T1110 Brute Force|\n|EVILSCHOLAR Denial of Service Attempt|T0814 Denial of Service|\n|EVILSCHOLAR Initial Communication Attempt|T0869 Standard Application Layer Protocol|\n|EVILSCHOLAR Unauthorized Login|T1078 Valid Accounts|\n|File Transfer of LAZYCARGO|T1544 Remote File Copy|\n|MOUSEHOLE Scan for Devices|T1046 Network Service Scanning|\n|MOUSEHOLE Initial Device Connectivity|T0869 Standard Application Layer Protocol|\n\n\n-----\n\n#### OT Best Practices\n\n###### MONITOR EAST-WEST ICS NETWORKS WITH ICS PROTOCOL AWARE TECHNOLOGIES\n\nPerform network traffic monitoring with a focus on East-West communications instead of simply NorthSouth (ingress/egress) communications. PIPEDREAM’s ability to move from Engineering Workstation to PLC\nand then PLC to PLC means that simply monitoring North-South communications or putting emphasis on\nsegregation will be insufficient. Specifically look for modifications to PLCs occurring outside of maintenance\nperiods such as the changing of logic using native ICS protocols.\n\n###### PLC NETWORK TELEMETRY ANALYSIS\n\nMonitor for unusual interactions with PLCs from non-standard workstations or accounts.\n\n###### ISOLATE MISSION CRITICAL SKID SYSTEMS\n\nConsider implementing hardwired I/O between critical skid systems and distributed control systems I/O in\nplace of direct communications if feasible.\n\n###### NETWORK ISOLATION OF SAFETY SYSTEMS\n\nEnsure network isolation for safety system components, monitor safety system networks for new connections\nor devices, and verify all configuration changes are compliant with change management procedures.\n\n#### Long-Term Readiness\n\n###### ICS-FOCUSED INCIDENT RESPONSE PLAN\n\nCreate and update an ICS-focused Incident Response (IR) plan with accompanying Standard Operating\nProcedures (SOP) and Emergency Operating Procedures (EOP) for operating with a hampered or degraded\ncontrol system. Conduct a table top exercise focused on CHERNOVITE’s ICS Cyber Kill Chain with an emphasis\non PIPEDREAM; use this opportunity to identify process and collection gaps that could hinder the detection\nand response efforts.\n\n###### SPARE PARTS INVENTORY\n\nCreate and update a spare parts inventory for critical control system components, including hardware,\nsoftware, firmware, configuration backups, and licensing information. Develop plans and procedures for\nsourcing and procurement of critical control system components. Consider the implementation of cold\nbackups for rapid replacement of ICS level one devices.\n\n\n-----\n\n### FREQUENTLY ASKED QUESTIONS\n\n\n**If I do not have Schneider Electric or Omron in**\n\nenvironment, or validate that the system has\n\n**my network, should I care about PIPEDREAM?**\n\nnot been modified, could we?\n\nYes, the capabilities are further reaching than\n\n- If the processes that use these devices\n\nSchneider Electric or Omron vendors. CODESYS\n\nor protocols are disrupted, is there a\n\nprotocol is used in hundreds of controllers far\n\ncybersecurity component in place to\n\nbeyond Schneider Electric and Omron.\n\ndetermine root cause analysis and if an attack\nhas occurred? Additionally, MOUSEHOLE targets and\n\ncompromises OPC-UA servers.\n\n- Do we have an incident response plan that\nfactors in the loss of any of these devices? OPC is an interoperability standard for the secure\nWhat monitoring do we have in place to exchange of industrial automation data. It is\nensure it is not impacted? designed to be platform-agnostic so devices from\n\ndifferent vendors can exchange information.\n\n[2https://wwwmotioncontroltipscom/what-is-opc-ua-and-how-does-it-compare-with-industrial-ethernet/](https://www.motioncontroltips.com/what-is-opc-ua-and-how-does-it-compare-with-industrial-ethernet/)\n\n\n-----\n\nMultiple Industrial Ethernet (IE) protocols in\nmanufacturing processes and plants — such\nas EtherNet/IP, PROFINET, or EtherCAT — are\nused across different networks to meet specific\ntopology requirements and communication\nspeeds or latency guarantees. Although these\ncommunication protocols are open, they are often\nincompatible, resulting in fragmented networks\nthat cannot “speak” to each other.\n\nOPC-UA was developed to solve this problem by\nallowing industrial devices operating with different\nprotocols and on different platforms (Windows,\nMac, or Linux, for example) to communicate\nwith each other. OPC-UA goes beyond Industrial\nEthernet in reach, including devices from the\nlowest level of the automation pyramid — such as\nfield devices that deal with real-world data, such\nas sensors, actuators, and motors — to the highest\nlevels, such as Supervisory Control and Data\nAcquisition (SCADA), Manufacturing Execution\nSystems (MES), and Enterprise Resource Planning\n(ERP) systems, as well as to the cloud.[1]\n\n\n**What’s the attribution?**\n\nDragos does not make assessments about\nattribution. It is Dragos’s position that what is\nvaluable to a significant majority of defenders\nis understanding the “what and how, not who.”\nAdditionally, given the unique geopolitical\nnature of malicious capabilities and operations\ntargeting critical national infrastructure, it could\nbe disruptive to security efforts to focus on\nattribution.\n\n**What could have the original equipment**\n**manufacturers done differently?**\n\nThe original equipment manufacturers (OEM)—\nSchneider Electric and Omron— were targets but\ndid not do anything wrong. Each time malware\nfamilies target ICS, conversations emerge about the\nOEM. However, product security is not the same\nthing as ICS security. CHERNOVITE takes advantage\nof the native functionality available in the industrial\nenvironment and does not rely on vulnerabilities\nin the ICS equipment to achieve its operations.\nAny focus on the OEMs is misplaced; based on the\nDragos analysis, it is likely that the adversary will\ndevelop modules against numerous equipment\nvendors.\n\n\n1 Source: https://wwwmotioncontroltipscom/what-is-opc-ua-and-how-does-it-compare-with-industrial-ethernet/\n\n\n-----\n\n# THANK YOU\n\n\n###### ABOUT DRAGOS, INC.\n\n\n###### OUR TECHNOLOGY,\n\n\n###### INTELLIGENCE FOR\n\n\n###### TO LEARN MORE\n\n\n###### PLEASE VISIT\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "99fdc3ef-333d-48f5-a4a1-becd788c7b80",
            "created_at": "2022-10-25T15:28:29.802983Z",
            "updated_at": "2022-10-25T15:28:29.802983Z",
            "deleted_at": null,
            "name": "MITRE",
            "url": "https://github.com/mitre-attack/attack-stix-data",
            "description": "MITRE ATT&CK STIX Data",
            "reports": null
        }
    ],
    "references": [
        "https://hub.dragos.com/hubfs/116-Whitepapers/Dragos_ChernoviteWP_v2b.pdf?hsLang=en"
    ],
    "report_names": [
        "Dragos_ChernoviteWP_v2b.pdf?hsLang=en"
    ],
    "threat_actors": [
        {
            "id": "d90307b6-14a9-4d0b-9156-89e453d6eb13",
            "created_at": "2022-10-25T16:07:23.773944Z",
            "updated_at": "2025-03-27T02:02:09.974695Z",
            "deleted_at": null,
            "main_name": "Lead",
            "aliases": [
                "Casper",
                "TG-3279"
            ],
            "source_name": "ETDA:Lead",
            "tools": [
                "Agentemis",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "RbDoor",
                "RibDoor",
                "Winnti",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "5cbf6c32-482d-4cd2-9d11-0d9311acdc28",
            "created_at": "2023-01-06T13:46:38.39927Z",
            "updated_at": "2025-03-27T02:00:02.823829Z",
            "deleted_at": null,
            "main_name": "ENERGETIC BEAR",
            "aliases": [
                "DYMALLOY",
                "TG-4192",
                "Crouching Yeti",
                "Group 24",
                "Havex",
                "IRON LIBERTY",
                "Blue Kraken",
                "ALLANITE",
                "Koala Team",
                "G0035",
                "ATK6",
                "ITG15",
                "Ghost Blizzard",
                "BERSERK BEAR"
            ],
            "source_name": "MISPGALAXY:ENERGETIC BEAR",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "091dc6fb-2650-4646-894a-41de0d463f94",
            "created_at": "2023-11-17T02:00:07.594612Z",
            "updated_at": "2025-03-27T02:00:03.230461Z",
            "deleted_at": null,
            "main_name": "Chernovite",
            "aliases": [],
            "source_name": "MISPGALAXY:Chernovite",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "a66438a8-ebf6-4397-9ad5-ed07f93330aa",
            "created_at": "2022-10-25T16:47:55.919702Z",
            "updated_at": "2025-03-27T02:05:17.412024Z",
            "deleted_at": null,
            "main_name": "IRON VIKING",
            "aliases": [
                "ATK14 ",
                "BlackEnergy Group",
                "Blue Echidna ",
                "CTG-7263 ",
                "ELECTRUM ",
                "FROZENBARENTS ",
                "Hades/OlympicDestroyer ",
                "IRIDIUM ",
                "Qudedagh ",
                "Sandworm Team ",
                "Seashell Blizzard ",
                "TEMP.Noble ",
                "Telebots ",
                "Voodoo Bear ",
                "APT44 "
            ],
            "source_name": "Secureworks:IRON VIKING",
            "tools": [
                " BlackEnergy",
                " GCat",
                " GreyEnergy",
                " Industroyer",
                " KillDisk",
                " NotPetya",
                " PSCrypt",
                " TeleBot",
                " TeleDoor",
                " xData",
                "BadRabbit"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "b3e954e8-8bbb-46f3-84de-d6f12dc7e1a6",
            "created_at": "2022-10-25T15:50:23.339976Z",
            "updated_at": "2025-03-27T02:00:55.446795Z",
            "deleted_at": null,
            "main_name": "Sandworm Team",
            "aliases": [
                "Sandworm Team",
                "ELECTRUM",
                "Telebots",
                "IRON VIKING",
                "BlackEnergy (Group)",
                "Quedagh",
                "Voodoo Bear",
                "IRIDIUM",
                "Seashell Blizzard",
                "FROZENBARENTS",
                "APT44"
            ],
            "source_name": "MITRE:Sandworm Team",
            "tools": [
                "Bad Rabbit",
                "Mimikatz",
                "Exaramel for Linux",
                "Exaramel for Windows",
                "GreyEnergy",
                "PsExec",
                "Prestige",
                "P.A.S. Webshell",
                "VPNFilter",
                "Cyclops Blink",
                "SDelete",
                "AcidRain",
                "Industroyer",
                "Industroyer2",
                "BlackEnergy",
                "Cobalt Strike",
                "NotPetya",
                "KillDisk",
                "PoshC2",
                "Impacket",
                "Invoke-PSImage",
                "Olympic Destroyer"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "3a0be4ff-9074-4efd-98e4-47c6a62b14ad",
            "created_at": "2022-10-25T16:07:23.590051Z",
            "updated_at": "2025-03-27T02:02:09.878211Z",
            "deleted_at": null,
            "main_name": "Energetic Bear",
            "aliases": [
                "ATK 6",
                "Blue Kraken",
                "Crouching Yeti",
                "Dragonfly",
                "Electrum",
                "Energetic Bear",
                "Ghost Blizzard",
                "Group 24",
                "ITG15",
                "Iron Liberty",
                "Koala Team",
                "TG-4192"
            ],
            "source_name": "ETDA:Energetic Bear",
            "tools": [
                "Backdoor.Oldrea",
                "CRASHOVERRIDE",
                "Commix",
                "CrackMapExec",
                "CrashOverride",
                "Dirsearch",
                "Dorshel",
                "Fertger",
                "Fuerboos",
                "Goodor",
                "Havex",
                "Havex RAT",
                "Hello EK",
                "Heriplor",
                "Impacket",
                "Industroyer",
                "Karagany",
                "Karagny",
                "LightsOut 2.0",
                "LightsOut EK",
                "Listrix",
                "Oldrea",
                "PEACEPIPE",
                "PHPMailer",
                "PsExec",
                "SMBTrap",
                "Subbrute",
                "Sublist3r",
                "Sysmain",
                "Trojan.Karagany",
                "WSO",
                "Webshell by Orb",
                "Win32/Industroyer",
                "Wpscan",
                "nmap",
                "sqlmap",
                "xFrost"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "8941e146-3e7f-4b4e-9b66-c2da052ee6df",
            "created_at": "2023-01-06T13:46:38.402513Z",
            "updated_at": "2025-03-27T02:00:02.824555Z",
            "deleted_at": null,
            "main_name": "Sandworm",
            "aliases": [
                "G0034",
                "IRIDIUM",
                "Blue Echidna",
                "FROZENBARENTS",
                "Seashell Blizzard",
                "IRON VIKING",
                "ELECTRUM",
                "TeleBots",
                "UAC-0113",
                "UAC-0082",
                "APT44",
                "Quedagh",
                "VOODOO BEAR",
                "TEMP.Noble"
            ],
            "source_name": "MISPGALAXY:Sandworm",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1666859765,
    "ts_updated_at": 1743041678,
    "ts_creation_date": 1651769887,
    "ts_modification_date": 1651769368,
    "files": {
        "pdf": "https://archive.orkl.eu/79b1f4889149dcc079d3413e42f46c1736815a46.pdf",
        "text": "https://archive.orkl.eu/79b1f4889149dcc079d3413e42f46c1736815a46.txt",
        "img": "https://archive.orkl.eu/79b1f4889149dcc079d3413e42f46c1736815a46.jpg"
    }
}