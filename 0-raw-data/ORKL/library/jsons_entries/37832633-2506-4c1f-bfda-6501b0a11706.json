{
    "id": "37832633-2506-4c1f-bfda-6501b0a11706",
    "created_at": "2022-10-25T16:48:14.426211Z",
    "updated_at": "2025-03-27T02:09:38.771795Z",
    "deleted_at": null,
    "sha1_hash": "980ab92472c6de302ade77423ce09abe58a258bc",
    "title": "",
    "authors": "",
    "file_creation_date": "2015-09-29T15:00:06Z",
    "file_modification_date": "2015-09-29T15:00:26Z",
    "file_size": 2827348,
    "plain_text": "# Proactive Threat Identification Neutralizes  Remote Access Trojan Efficacy\n\nSubnet – 197.205.47.239\n\nSignature match on port 1177\n\nxtremerat (105.106.75.181)\n\n## By Levi Gundert\n\nVice President of Threat Intelligence\n\n\n-----\n\n#### THREAT INTELLIGENCE REPORT\n\n# Proactive Threat Identification Neutralizes\n\n## By Levi Gundert\n# Remote Access Trojan Efficacy\n\n## Executive’s Business Case\n\nContinuously incorporating known remote access trojan (RAT) controller locations into operational defense workflow and\ndetection technologies is useful, and automating correlation with internal telemetry will identify potential infections, but the\ndeeper value to the business, that reduces risk, is to understand the adversary behind each RAT instance.\n\nAdversary attribution is difficult, but worthwhile, since motivation informs methodology. Exploring an attacker’s capabilities\nand infrastructure becomes an ancillary benefit. One of the best ways to achieve consistent attribution results is to develop\noriginal attribution methodologies. An example of one such methodology – proactive Internet services enumeration – and\nthe applied results for Trojans like njRAT and Dark Comet are detailed in this report.\n\n## Background\n\nA remote access trojan (RAT)[1] is a feature-rich controller/server software suite that facilitates surreptitious (as its name\nsuggests) and unauthorized access to a victim’s computer. RATs are generally leveraged by adversaries with malicious\nintent to record local victim audio, video, keystrokes (in addition to exfiltrating files), and more[2].\n\nThe full spectrum of threat actors – especially criminals and nation-state agents – continue to leverage commodity RATs\neven after the original author has been apprehended[3]. Nation-state campaigns have routinely included payloads like\nPoison Ivy[4 ]and close derivatives because they are easy to configure, highly re-usable, and the RAT remains an effective tool\nagainst anti-virus software. This is especially true of dictatorial regimes that use RATs to hunt for the identity and location\nof political dissidents[5] within their own borders.\n\nCriminals use RATs because the technical barriers to entry are low and the knowledge required to effectively operate a\nRAT can be quickly acquired from free Internet tutorials[6] which feature content such as packing/crypting[7] a RAT to evade\nanti-virus software; demonstrating capabilities with multiple victims[8]; and establishing infrastructure[9], like dynamic DNS\n(DDNS)[10], to support a long-term operation.\n\n1 A remote access tool (RAT) is legitimately used by system administrators. In this report’s context, RAT is used to refer only to Trojans that are used for\nmalicious purpose\n\n\nmalicious purpose\n\n2 [http://www.washingtonpost.com/news/morning-mix/wp/2014/05/20/5-scary-things-about-blackshades-malware/](http://www.washingtonpost.com/news/morning-mix/wp/2014/05/20/5-scary-things-about-blackshades-malware/)\n\n3 [http://www.darkreading.com/over-90-arrested-in-global-fbi-crackdown-on-blackshades-rat/d/d-id/1252912](http://www.darkreading.com/over-90-arrested-in-global-fbi-crackdown-on-blackshades-rat/d/d-id/1252912)\n\n4 [http://www.crn.com/news/security/240160369/poison-ivy-attack-toolkit-with-ties-to-china-linked-to-other-hacking-groups.htm](http://www.crn.com/news/security/240160369/poison-ivy-attack-toolkit-with-ties-to-china-linked-to-other-hacking-groups.htm)\n\n5 [http://www.seculert.com/blog/2014/01/xtreme-rat-strikes-israeli-organizations-again.html](http://www.seculert.com/blog/2014/01/xtreme-rat-strikes-israeli-organizations-again.html)\n[http://www.darkreading.com/over-90-arrested-in-global-fbi-crackdown-on-blackshades-rat/d/d-id/1252912](http://www.darkreading.com/over-90-arrested-in-global-fbi-crackdown-on-blackshades-rat/d/d-id/1252912)\n\n6 [http://www.reddit.com/r/hacking/comments/2acwpb/how_to_setup_dark_comet_rat_with_download_and/](http://www.reddit.com/r/hacking/comments/2acwpb/how_to_setup_dark_comet_rat_with_download_and/)\n\n7 [https://www.youtube.com/watch?v=QmH_ojSZoRU](https://www.youtube.com/watch?v=QmH_ojSZoRU)\n\n8 [https://www.youtube.com/watch?v=5szajA_Xbps](https://www.youtube.com/watch?v=5szajA_Xbps)\n\n9 [https://www.youtube.com/watch?v=fltTqccBmzY](https://www.youtube.com/watch?v=fltTqccBmzY)\n\n10 [https://www.youtube.com/watch?v=tXVGLb96WHU](https://www.youtube.com/watch?v=tXVGLb96WHU)\n\n\n-----\n\nIn a bit of a reversal from traditional botnet nomenclature, a commodity RAT file (executable) is typically labeled as the\n“server” when it is installed on a victim host (through any number of “spreading” mechanisms), and the client (control panel)\n“or controller” resides on the RAT operator’s computer.\n\nHistorically, the security community has generally relied upon passive malware collection methodologies to identify RAT\nfamilies and campaigns. Sources include customer telemetry, honeypots, and malware processing and aggregation\nservices like VirusTotal. While these are useful resources, using them makes it is difficult to quickly and proactively identify\nall live instances of a particular RAT campaign. Additionally, the derivative insight that businesses rely on is largely reactive\nand only as good as the sources collecting the malware.\n\nToday, threat intelligence teams continue to depend on the bulk processing of malware samples for derivative indicators of\ncompromise (IOCs) that support new rules in defensive technologies. This approach, while partially effective, relies on large\namounts of computing and Internet resources to process the tens (to hundreds) of thousands of daily malware samples\ncollected by security vendors. The problem is that even anti-virus companies encounter challenges processing the vast\namount of daily samples.\n\nThe solution is proactive and iterative large scale Internet enumeration (scanning), which allows businesses to identify\nhosts matching specific RAT signatures, and those hosts may lead to quick and direct operator attribution.\n\nThis scanning approach reveals a high number of RAT operator locations that were previously unknown to primary malware\nresources – VirusTotal and #totalhash. Additionally, many of the RAT controllers are located on residential ISP (Internet\nService Provider) subnets, potentially indicating the RAT operator’s physical location.\n\n## Originating Intelligence\n\nInternet scanning was largely impractical when Nmap[11] was the only available off-the-shelf option (short of writing a custom\nasynchronous multithreading scanner). The release of Unicorn Scan[12], and more recent releases of Zmap[13], and MASSCAN[14]\nrespectively, enabled the enumeration of the full IPv4 address space in a relatively short amount of time – minutes – from\na single connected device. In addition to open port discovery, these tools return daemon banner information that is highly\nuseful for identifying RAT controllers. Port scanning tools are often used to identify and count specific services available to\nthe public Internet, and using these same tools to identify and profile RATs is advantageous both for law enforcement and\noperational defenders.\n\nRATs return specific responses (strings) when a proper request is presented on the RAT controller’s listener port. Specific\nsignatures are withheld in this report to avoid adding a chapter to the threat actor playbook, but it is a straightforward\nprocess to profile a RAT family. In some cases, even a basic TCP three-way handshake[15] is sufficient to elicit a RAT controller\nresponse. The unique response is a fingerprint indicating that a RAT controller (control panel) is running on the computer\nin question. Therefore RAT controllers and their operators are inherently vulnerable because they are often operating\nopenly on the Internet and they generate unique response strings when properly interrogated.\n\nTo profile a specific RAT family, samples and/or full packet captures (PCAP) must be obtained. Fortunately, there\nare numerous security researchers that publicly and generously share malicious code (malware) generated network\npacket captures[16].\n\n\npacket captures[16].\n\n11 [https://nmap.org/](https://nmap.org/)\n\n12 [http://sectools.org/tool/unicornscan/](http://sectools.org/tool/unicornscan/)\n\n13 [https://zmap.io/](https://zmap.io/)\n\n14 [https://github.com/robertdavidgraham/masscan](https://github.com/robertdavidgraham/masscan)\n\n15 [https://support.microsoft.com/en-us/kb/172983](https://support.microsoft.com/en-us/kb/172983)\n\n16 [http://contagiodump.blogspot.com/2013/04/collection-of-pcap-files-from-malware.html](http://contagiodump.blogspot.com/2013/04/collection-of-pcap-files-from-malware.html)\n\n\n-----\n\nAnalysis of RAT controller responses within these packet captures leads to digital fingerprints that can be subsequently\nused in tandem with an Internet scanner to identify live instances of RAT controllers, and in some cases the RAT operator’s\nhome IP address and approximate geographic location.\n\nFor example, one version of a ubiquitous RAT returns a “0” subsequent to an HTTP GET method.\n\nEnumeration of a /20 subnet in Palestine with MASSCAN reveals a signature match with a specific host on port 1177.\n\nSimilarly, a scan of a /16 residential subnet in Algeria reveals multiple hosts listening on port 1177, but only one –\n197.205.47.239 – that matches the above signature.\n\n\nPositive matches can be further confirmed via Curl[17] or Python Scapy[18] to identify potential false positives.\n\n17 [http://curl.haxx.se/](http://curl.haxx.se/)\n\n18 [http://www.secdev.org/projects/scapy/](http://www.secdev.org/projects/scapy/)\n\n\n-----\n\nPotentially there are additional legitimate daemons that may also return a “0,” thus complete certainty about a positive RAT\nverdict in this case is absent. Rather, this is one example of RAT profiling with a fairly unique RAT controller response string.\n\nAnother example is Havex RAT[19]. Netresec produced an informative blog in 2014[20] dissecting Havex’s communication\npattern. Noticeably, the Havex response includes the string “havex.”\n\n## Scaling the Methodology\n\nShodan[21], the search engine for Internet services, created and currently maintained by John Matherly - is incorporated to\nscale RAT identification efforts. Shodan contains multiple benefits when compared to traditional scanning tools, including\nun-attributable tasking, continuous scanning without building and maintaining infrastructure, and Shodan contains\nhundreds of additional signatures for popular ports and services. Shodan’s Web application and command line interface\n(CLI) are both easy to use, and Shodan results include all available port information for any given host.\n\nShodan’s signatures also include RATs, specifically Black Shades, Dark Comet, njRAT, XtremeRAT, Poison Ivy, and Net Bus.\nThus Shodan is a valuable and useful originating intelligence source for identifying live RAT controllers. While the number\nof results varies, Shodan typically identifies between 400 and 600 individual RAT controllers on any given day. The results\n[from September 18, 2015, can be downloaded from Recorded Future’s GitHub page.](https://github.com/recordedfuture)\n\nA week’s worth of consolidated and unique RAT controller IP addresses from early July 2015 totaled 633. The week\nfollowing, VirusTotal returned derivative malware results for 153 of the 633 IP addresses or a 24% positive correlation\nrate[22]. Consequently, this originating methodology applied with Shodan identifies RAT controller instances often before the\nmalware sample is submitted to VirusTotal, making it useful as a unique threat source.\n\n\n19 [https://www.securityweek.com/attackers-using-havex-rat-against-industrial-control-systems](https://www.securityweek.com/attackers-using-havex-rat-against-industrial-control-systems)\n\n20 [http://www.netresec.com/?page=Blog&month=2014-11&post=Observing-the-Havex-RAT](http://www.netresec.com/?page=Blog&month=2014-11&post=Observing-the-Havex-RAT)\n\n21 [https://www.shodan.io/](https://www.shodan.io/)\n\n[22 The VirusTotal results can be downloaded from Recorded Future’s GitHub page.](https://github.com/recordedfuture)\n\n\n-----\n\nFurther, many of the RAT IP addresses are located on residential (and dynamically allocated) networks. RAT operators often\nrun the RAT control panel from home because proxies introduce latency which degrades performance, especially when\nthe RAT operator is interested in collecting live video feeds from a victim’s camera (“webcam”). In those countries where\nthe unauthorized access of a computer is a crime, law enforcement need only send a subpoena (or equivalent) to the\nrespective Internet Service Provider to identify the likely RAT operator’s identity and residential location.\n\nBetween August 17-21, 2015 Shodan RAT results were collected and a list of 471 unique RAT controller locations were\nidentified[23].\n\n\n-----\n\nUsing the results from July and August 2105, the RAT controller locations were further enriched to understand individual\ninstances, the corresponding RAT operators, and their respective motivations.\n\n## Enriching Intelligence\n\nAs previously mentioned, VirusTotal further confirms and enriches the RAT controller results with associated malware\nmetadata. Additional valuable enrichment sources that are programmatically available include Team Cymru and Recorded\nFuture.\n\nRecorded Future’s API offers valuable open source verdict confirmation and data enrichment. The Python API script used\n[to produce the full Recorded Future results for the consolidated list of RAT IP addresses is located on Recorded Future’s](https://github.com/recordedfuture)\n[GitHub page.](https://github.com/recordedfuture)\n\nA sampling of Record Future results from the consolidated list of Shodan’s RAT controller IP addresses in early July include:\n\n\n-----\n\n**RAT Controller IP**\n\n105.106.75.181\n\n37.139.52.43\n\n38.103.14.232\n\n212.83.167.112\n\n37.236.160.100\n\n83.87.20.225\n\n212.154.81.158\n\n197.2.24.60\n\n94.102.51.152\n\n212.154.81.158\n\n93.116.43.245\n\n\n**Document URI**\n\nhttp://forum.malekal.com/xtremerat-campagne-mails\nfrancais-credit-mutuel-t51664.html#p397641\n\nhttp://www.facebook.com/406287246141601/\n\nposts/536666376437020\n\nhttp://pastebin.com/tGT0nEvT\n\nhttp://pastebin.com/cU4WX0hs\n\nhttp://pastebin.com/2kGEjivz\n\nhttp://pastebin.com/F6KnVR1q\n\nhttps://twitter.com/atma_es/status/628301520853929985\n\nhttp://pastebin.com/xLTfgmrD\n\nhttps://twitter.com/netmenaces/\n\nstatus/612103433273917440\n\nhttps://twitter.com/atma_es/status/628301520853929985\n\nhttps://www.virustotal.com/en/file/\n\n\n**Fragment**\n\n- Re: xtremerat ( 105.106.75.181).\n\nKharkov S1 37.139.52.43 - Germany,\n\n10:09:17 - EVENT :: Moderator sleeperpi (sleeperpi)\n\n(38.103.14.232) has entered the room\n\nIP Address: 212.83.167.112 (Found from his Skype)\n\n37.236.160.100|Iraq|k1997.no-ip.biz|C2\n\n83.87.20.225 http://raidforums.com/showthread.php?tid=27\n\nTelnet attacked from 212.154.81.158 (http://t.co/BJAAPAaS9u)\n\nThis code was created on Saturday, March 21st, 2015\n\nat 15:59 UTC from IP 197.2.24.60 (tn)\n\nWebApp: SQLi attack from 94.102.51.152\n\n(NL, Noord-Holland - Amsterdam) #netmenaces 1.\n\nTelnet attacked from 212.154.81.158 (http://t.co/BJAAPAaS9u).\n\n93.116.43.245:3333 .\n\n\n-----\n\nTo enrich the list of RAT controller locations from August 17-21, 2015, the list of IP addresses was submitted to Recorded\nFuture and Virus Total. The Recorded Future IOC enrichment script returned “entity cards” (for relevant IP addresses) that\nsummarized available information. The enrichment script[24] also returned information for input domains retrieved from\nVirus Total results for the original RAT controller IP list.\n\n\n-----\n\n-----\n\n## Proactive RAT Operator Attribution\n\n**Example 1 – VirusTotal**\n\nEarlier this year Shodan identified a Dark Comet controller running on 90.212.68.218 (Sky Broadband) in the United Kingdom.\n\nQuick IP address enrichment included VirusTotal’s associated malware sample with filename, “DeathBotnet!.exe” and\ndomain – yobrohasan[.]ddns.net. “Yobrohasan” is a distinct string that leads to a cached image on the now defunct snog.\ncom of an individual using the moniker “yobrohasan.”\n\n\n-----\n\n**Example 2 – Team Cymru**\n\nIn July 2015, Team Cymru observed a high port UDP session between a njRAT controller IP address – 5.28.184.242 (Ramat\nGan Hot Internet, Israel) and a host at 196.36.153.134 (Internet Solutions, South Africa).\n\nIn addition to identifying njRAT on port 1177, Shodan further identified UPnP running on port 1900 and HTTP services\nrunning on port 80 and 8080 (“WWW-Authenticate: Basic realm=”NETGEAR DGN2200v2BEZEQ”) respectively, potentially\nindicating that the 5.28.184.242 host is also acting as a proxy.\n\nIn June, 2015, Team Cymru identified a DNS A record for xheemax.x64.me resolving to 5.28.184.242. The subdomain\n“xheemax” is a unique string used to produce a new domain from the DDNS service x64.me. The domain currently resolves\nto 149.78.239.193 (PSINet, Israel).\n\nThe online moniker “xheemax” appears in multiple forums beginning in 2011 when the actor asks for assistance in\n“disabling the small light on the laptop webcam.”[25] A profile is also maintained on CryptoSuite[26] as “xheemax Hakkinda” and\nthe “About Me” section contains “RAT” and “Cybergate.”\n\nIn 2014, Team Cymru’s #totalhash[27] also identified xheemax.no-ip.info (204.95.99.109), with corresponding SHA1 hash\n\n- 329ed5ef04535f5d11d0e59a361263545d740c61[28].\n\n**Example 3 – Maltego**\n\nImporting the RAT controller IP addresses – from Shodan results for August 17-21, 2015 – into Maltego reveals an enormous\namount of commonality.\n\n\n-----\n\nThe nodes with the highest number of links are related to IP address location checking. The native Maltego transforms\nspecifically correlate over 50 RAT controller IP addresses with websites that include localiser-ip[.]com and iplocationtools[.]\ncom. Multiple historic lists containing the IP addresses in question were also identified on pastebin[.]com.\n\n\n-----\n\n29 [http://www.eweek.com/security/how-do-booters-work-inside-a-ddos-for-hire-attack](http://www.eweek.com/security/how-do-booters-work-inside-a-ddos-for-hire-attack )\n\n\n-----\n\n## Conclusion\n\nOriginal, focused, and scalable intelligence methodologies are useful for law enforcement and for defending the enterprise,\nas demonstrated here. Identifying RAT controller locations and operators before their respective RAT spreading campaigns\nbegin reduces malware processing resources.\n\nThreat data enrichment sources such as Recorded Future increase attribution knowledge, in this case around RAT\noperators, which lead to enhanced understanding of motivations and derivative tools, techniques, and procedures.\n\nProactive and repeatable Internet enumeration for known RAT signatures is a viable methodology for producing an\noperational feed of malicious observables, and more importantly, also presenting further strategic opportunities to identify\nand understand the adversary.\n\nRAT operators are inherently vulnerable because they are often operating openly on the Internet and the RATs they buy\nor download generate unique response strings when properly interrogated. The vulnerability extends further because the\nRAT service listening on a specified port is an easy remote entry point to the attacker’s computer.\n\n_Special thanks to Shodan founder John Matherly for his support of this research._\n\n**Indicators of Compromise (IOC)**\n\n[All IOCs referenced in this report are located in the Recorded Future GitHub repository.](https://github.com/recordedfuture/raw-ioc/tree/master/rats)\n\n## About Recorded Future\n\nWe arm you with real-time threat intelligence so you can decrease operational risk. With billions of indexed facts, and more\nadded every day, our patented Web Intelligence Engine continuously analyzes the entire Web to give you unmatched insight into\nemerging threats. Recorded Future helps protect four of the top five companies in the world.\n\nRecorded Future, 363 Highland Avenue, Somerville, MA 02144 USA   |   © Recorded Future, Inc. All rights reserved. All trademarks remain property of their respective owners.   |   9/15\n\nREQUEST A DEMO\n\n\n## About Recorded Future\n\nWe arm you with real-time threat intelligence so you can decrease operational risk. With billions of indexed facts, and more\nadded every day, our patented Web Intelligence Engine continuously analyzes the entire Web to give you unmatched insight into\nemerging threats. Recorded Future helps protect four of the top five companies in the world.\n\nRecorded Future, 363 Highland Avenue, Somerville, MA 02144 USA   |   © Recorded Future, Inc. All rights reserved. All trademarks remain property of their respective owners.   |   9/15\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        }
    ],
    "references": [
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2015/2015.10.05.Proactive_Threat_Identification/threat-identification.pdf"
    ],
    "report_names": [
        "threat-identification"
    ],
    "threat_actors": [
        {
            "id": "d90307b6-14a9-4d0b-9156-89e453d6eb13",
            "created_at": "2022-10-25T16:07:23.773944Z",
            "updated_at": "2025-03-27T02:02:09.974695Z",
            "deleted_at": null,
            "main_name": "Lead",
            "aliases": [
                "Casper",
                "TG-3279"
            ],
            "source_name": "ETDA:Lead",
            "tools": [
                "Agentemis",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "RbDoor",
                "RibDoor",
                "Winnti",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "5cbf6c32-482d-4cd2-9d11-0d9311acdc28",
            "created_at": "2023-01-06T13:46:38.39927Z",
            "updated_at": "2025-03-27T02:00:02.823829Z",
            "deleted_at": null,
            "main_name": "ENERGETIC BEAR",
            "aliases": [
                "DYMALLOY",
                "TG-4192",
                "Crouching Yeti",
                "Group 24",
                "Havex",
                "IRON LIBERTY",
                "Blue Kraken",
                "ALLANITE",
                "Koala Team",
                "G0035",
                "ATK6",
                "ITG15",
                "Ghost Blizzard",
                "BERSERK BEAR"
            ],
            "source_name": "MISPGALAXY:ENERGETIC BEAR",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1666716494,
    "ts_updated_at": 1743041378,
    "ts_creation_date": 1443538806,
    "ts_modification_date": 1443538826,
    "files": {
        "pdf": "https://archive.orkl.eu/980ab92472c6de302ade77423ce09abe58a258bc.pdf",
        "text": "https://archive.orkl.eu/980ab92472c6de302ade77423ce09abe58a258bc.txt",
        "img": "https://archive.orkl.eu/980ab92472c6de302ade77423ce09abe58a258bc.jpg"
    }
}