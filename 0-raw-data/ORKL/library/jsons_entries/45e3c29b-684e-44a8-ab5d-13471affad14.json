{
    "id": "45e3c29b-684e-44a8-ab5d-13471affad14",
    "created_at": "2023-01-12T15:05:46.813158Z",
    "updated_at": "2025-03-27T02:05:47.286938Z",
    "deleted_at": null,
    "sha1_hash": "d729d5a1d3a747ecfda90b53bb6f48e18f6eaee9",
    "title": "2019-07-12 - TrickBooster – TrickBot’s Email-Based Infection Module",
    "authors": "",
    "file_creation_date": "2022-05-29T01:12:16Z",
    "file_modification_date": "2022-05-29T01:12:16Z",
    "file_size": 165540,
    "plain_text": "# TrickBooster – TrickBot’s Email-Based Infection Module\n\n**[deepinstinct.com/2019/07/12/trickbooster-trickbots-email-based-infection-module/](https://www.deepinstinct.com/2019/07/12/trickbooster-trickbots-email-based-infection-module/)**\n\nJuly 12, 2019\n\n## 100% Prevention Score in the 2022 MITRE ATT&CK Evaluation for\n Enterprise\n\n[Learn more](https://www.deepinstinct.com/news/deep-instinct-shows-100-percent-score-in-mitre-evaluations)\n\nJuly 12, 2019 | [adinah_b](https://www.deepinstinct.com/author/adinah_b)\n\n### 250 million Email addresses harvested and counting…\n\n**Author: Shaul Vilkomir-Preisman**\n\n**Supporting research: Tom Nipravski**\n\n**Update: Further developments on how** **[TrickBooster operates is accessible here.](https://www.deepinstinct.com/2019/07/22/trickbooster-a-deeper-dive-into-the-malware-that-successfully-harvested-over-250m-addresses/)**\n\nEver since its discovery in 2016 TrickBot has remained a continuously active and very\nadaptive actor in the cybercrime threat landscape. What was once a malware family focused\non financial data theft is now a robust, elaborate and sophisticated threat, multi-purposed for\nvarious types of malicious activity. Recent findings from a currently active and ongoing\n[TrickBot campaign, which features extensive use of signed malware binaries, indicate that it](https://twitter.com/malwrhunterteam/status/1144133289529237504)\n\n\n-----\n\n[now has a new variant. Alongside its recent addition of a cookie stealing module it has](https://www.bleepingcomputer.com/news/security/trickbot-trojan-now-has-a-separate-cookie-stealing-module/)\ngained a new partner in crime – a malicious email-based infection and distribution module\nthat shares its code signing certificates (details in IOC section below).\n\nThe module is employed to harvest Email credentials and contacts from a victim’s address\nbook, inbox, outbox, it can send out malicious spam Emails from the victim’s compromised\naccount, and finally delete the sent messages from both outbox and the trash folder, so as to\nremain hidden from the user. We believe this module is used by Trickbot for several\npurposes; prorogation and infection, spreading spam for monetization purposes, and\nharvesting email accounts which can then be traded and used by other campaigns.\n\nDuring our investigation of this new module and the network infrastructure associated with it,\nwe were able to access infection servers from which the malware is downloaded onto victim\nmachines, as well as command and control servers. We managed to recover a data base\ncontaining 250 million e-mail accounts harvested by TrickBot operators, which most likely\nwere also employed as lists of targets for malicious delivery and infection. The data base\nincludes millions of addresses from government departments and agencies in the US and\nthe UK.\n\nIn this blog post we will present our main findings so far based on research conducted in the\nlast 10 days. Our research and analysis into this module, its activity and capabilities\ncontinues, and we will update with more details as they become available.\n\n### Attack Flow\n\n\n-----\n\n_Infographic showing TrickBooster infection flow._\n\nStage 1 – Victim machine, infected with TrickBot, receives instruction from TrickBot\ncommand and control to download TrickBooster, which is signed with a valid certificate.\nStage 2 – TrickBooster reports back to dedicated command and control server, sending\nlists of harvested e-mail credentials and addresses.\nStage 3 – TrickBooster command and control server instructs bot to send malicious\nspam e-mails.\nStage 4 – TrickBooster bot sends malicious infection and spam e-mails.\n\n### Deep Instinct’s Investigation and Findings\n\n\n-----\n\nOur investigation started when Deep Instinct detected and prevented a TrickBooster infection\nattempt using a signed malware binary at a customer environment in the US almost two\nweeks ago.\n\nSeeing a signed malware binary delivered to a customer environment prompted us to\ninvestigate further. We analyzed the malware sample and found swaths of PowerShell code\nin its memory. Analysis of this PowerShell code immediately led us to the conclusion that we\nare dealing with a mail-bot.\n\n\n-----\n\n-----\n\n_PowerShell code snippets extracted from TrickBooster’s memory, showing functions to harvest e-mails_\n_addresses and send malicious spam e-mails._\n\nFollowing initial analysis, we started looking for more leads on the malware, cross\nreferencing certificate information, sample similarity, and infrastructure used to both deliver\nand control the malware. We discovered more samples of the malware, both signed and not,\nadditional infrastructure used in the campaign – both to distribute (infection points) and\ncontrol the malware (C2 Servers). TrickBot samples were also found, signed using the same\ncode signing certificates.\n\nThese code signing certificates were apparently issued to various small-to-medium\nbusinesses based in the UK. One of which seemingly has very little use for code signing\ncertificates, an air-conditioning, heating and plumbing company, while others do indeed may\nhave a legitimate use for them, according to their registrations.\n\nWe continued monitoring the campaign and the infrastructure involved in it, both its infection\npoints and C2 Servers, which were going on and off line, and employing various Geo-IP\nrestrictions and other mechanisms to hamper analysis It was at one of these servers that we\n\n\n-----\n\nfound something that made us realize how successful this campaign is - an Email dump\ncontaining approximately 250 million Email addresses.\n\n### The Email Database\n\nThe recovered Email dump contains massive amounts of commonly used mail provider\naddresses such as Gmail, Yahoo, etc., but is not limited to these alone. It also contains large\namounts of e-mail addresses from various Government departments and other high**profile targets in both the US and the UK.**\n\nOther organizations found include universities in the UK and Canada, and several provincial\nagencies and Governments in Canada.\n\nThe numbers of listing for common mail providers were as follows:\n\nGmail.com – 25,863,076 addresses\nYahoo.com – 19,079,339 addresses\nHotmail.com – 11,120,126 addresses\nAol.com – 7,135,831 addresses\nMsn.com – 3,512,034 addresses\nYahoo.co.uk – 2,070,848 addresses\n\nSpot checking a few thousands of these compromised Email addresses against previously\nrecorded leaks and breaches, leads us to believe that this is a new mass compromise of emails, not previously seen or reported before.\n\nThis case, and this significant finding, highlights the success and sophistication of TrickBot,\nan already very accomplished piece of malware. For a threat actor in the cybercrime sphere,\ncollaborating with a spam malware can bring many possible advantages. Chief among them\nis the increased ability to distribute your own malware, as spam-bots of all sorts, have been\nand will likely continue to be, a backbone of malware distribution in general.\n\nAs mentioned, TrickBooster is a powerful addition to TrickBot’s vast arsenal of tools, modules\n[and collaborations with other malware. This is not only due to the greatly increased](https://www.flashpoint-intel.com/blog/trickbot-icedid-collaborate-increase-impact/)\nspreading and information harvesting ability, but also due to the cover-up of the ‘implant’ left\nbehind. Following initial deployment of the malware on the victim machine, the implant left\nbehind by the malware, after it finishes initial execution and clean-up goes successfully\nundetected.\n\nThis clean-up is thorough and involves deleting the original infecting executable file, which is\na very common practice employed by many malware families. The result is that it is missed\nby nearly all scanning security vendors, an impressive stealth factor that is much desired\namong malware operators.\n\n\n-----\n\nThis file, whose main functionality appears to be an e-mail collector targeting\n_OUTLOOK.exe, begins its execution by creating an additional thread where this module is_\nlooking for an OUTLOOK.exe window by using \"FindWindow\" function with \"rctrl_renwnd32\"\nas class name (an identifier of the OUTLOOK.exe window).\n\nOn the other thread - this module is using COM objects to interact with OUTLOOK.exe. It\nstarts doing so by initializing a COM object (CoInitializeEx) and continuing to interact with it\nby creating an instance of \"Microsoft.Office.Interop.Outlook\" with \"CoCreateInstance\". It then\ntries to start OUTLOOK.exe by using \"OleRun\" function.\n\nWhen OUTLOOK.exe is executed - this module knows to start interacting with it by using\nMicrosoft Outlook Messaging API (MAPI).\n\nMAPI provides the messaging architecture for Microsoft Outlook 2013 and Outlook 2016. It\nprovides a set of interfaces, functions, and other data types to facilitate the development of\nOutlook messaging applications. Applications use MAPI to manipulate email data, to create\nemail messages and the folders to store them in, and to support notifications of changes to\nexisting MAPI-related data.\n\nThis, and more research and analysis of TrickBooster is still ongoing with more details to be\npublished in the near future.\n\nDuring our investigation of TrickBooster, we have contacted DigiCert/Thawte, who issued the\ncode signing certificates used to sign both TrickBot and TrickBooster samples used in this\ncampaign and requested their revocation. The offending certificates have been revoked by\nDigiCert/Thawte.\n\nWe are also in the process of reporting and providing details to CERTs and other relevant\nauthorities, and we will work with partners in the community to make available the e-mail\naddress dumps in a secure manner.\n\n**Indicators of compromise (IOCs)**\n\n**Shared Certificate Details**\n\nShared Cert 1\n\nCert SHA1: 5DE6E48A350F60CE11D9D3AC437BE8CCBC3D415C\nIssued to: [https://beta.companieshouse.gov.uk/company/08306316](https://beta.companieshouse.gov.uk/company/08306316)\nTrickBot signed sample (SHA256):\n3f651b525ceaa941c143b2adc3244b3d4b9af299ad09beea345867258dfbf5e7\nTrickBooster signed sample (SHA256):\n620020a21c8074d689e80fc1ae29acf8c34d3481ed380f20ad445b88a7bf442e\n\nShared Cert 2\n\n\n-----\n\nCert SHA1: 30A852583F8C2CA4710B431C800E4924C2C727EF\nIssued to: [https://beta.companieshouse.gov.uk/company/08549469](https://beta.companieshouse.gov.uk/company/08549469)\nTrickBot signed samples (SHA256):\n\n33eed709eb06f57d371fa97097f821858ad4143900c7aa4c302ce190d51370ff\n\ndcaa278d0dbbd0b068615aeef5a87db1cbe664a6f51c5e9cc6a09fe354990fa6\n\nTrickBooster signed sample (SHA256):\n\n65596dd44caa7fa9e8d048dfb5a5e46b04874060eb888d320ee2ced752669f5e\n\nShared Cert 3\n\nCert SHA1: 67ED536B62CFE6855F1821DB1FE084616F0592E4\nIssued to: [https://beta.companieshouse.gov.uk/company/08480288](https://beta.companieshouse.gov.uk/company/08480288)\nTrickBot signed sample (SHA256):\n\ne7e64753cf91d1d35c3098fcd491f53dda01e83c47f6bede3d5bfe6775fb20c8\n\nTrickBooster signed sample (SHA256):\n\nd96fd330c765b88f3503899755624cbe020ab3e2c53e28d7dee38e7b35f3eab2\n\n**TrickBooster Infection servers (servers known to host TrickBooster executables in**\n**this campaign)**\n\nhxxp://104.216.111.171/\n\nhxxp://85.204.116.92/\n\n**TrickBooster Command & Control servers (servers controlling TrickBooster bots**\n**involved in this campaign)**\n\n185.86.148.63:2050\n\n178.156.202.242:2050\n\n62.109.25.254 (likely Command & Control Server)\n\n**TrickBooster file hashes (SHA256, involved in this campaign)**\n\n620020a21c8074d689e80fc1ae29acf8c34d3481ed380f20ad445b88a7bf442e\n\n65596dd44caa7fa9e8d048dfb5a5e46b04874060eb888d320ee2ced752669f5e\n\nd96fd330c765b88f3503899755624cbe020ab3e2c53e28d7dee38e7b35f3eab2\n\nf7eeaee88c68056ab4087b4a5c7c5797f9075d0384b271f136776ff5249cb497\n\n\n-----\n\n48d591518b306a91853ac65697dd888a0afa442014b878d777879064091f73e1\n\nfe527937e1e512b72111102d9e18c10120b77cd9832230950ce55a718e75a9f0\n\n**FUD TrickBooster “Implant” file hashes (SHA256)**\n\n[4ba33bf8a5e8b065f5055dd2c655dc2a271e9587b037e9b3e548b6c51cab3e9e](https://www.virustotal.com/gui/file/4ba33bf8a5e8b065f5055dd2c655dc2a271e9587b037e9b3e548b6c51cab3e9e/detection)\n\n[702e96fef5b2ad643a0f702b26a3fd237592f778e4fbc707c80e93326fd08d58](https://www.virustotal.com/gui/file/702e96fef5b2ad643a0f702b26a3fd237592f778e4fbc707c80e93326fd08d58/detection)\n\n[6bf8f079021c8018f6ab37a29091e838918734bf9d1c532852561b6a0d71f12d](https://www.virustotal.com/gui/file/6bf8f079021c8018f6ab37a29091e838918734bf9d1c532852561b6a0d71f12d/detection)\n\n**Additional File hash IOCs (SHA256)**\n\n2787838d3eb2fd14e80eff102b3967c3e5f1ed9f26f0ecc856ee68dfa28b9fd5\n\n688b4a4ef3ac5de4f2c87bb5061f3f0729efe5818d2463437f4e742d9efbcf05\n\nef61dc27b55fb493c94ffd7022669c95e999fb6e60eb83a78fd462eab5f4b5d6\n\n98a60cb7e0a0337a132def0ad766b8c5dda0d6777bf531d2a5f2493bb3de4348\n\n00ba7cd7bb268fa6f6ef09fa679e5f5d68a27be512da24c556ea04673e852978\n\nb02494ffc1dab60510e6caee3c54695e24408e5bfa6621adcd19301cfc18e329\n\nfc0770975ca3337984c3d4912ef592c805333e8bdf76fd4d3256ebc4e5916be7\n\nf446f39223567f99ae2fb60f372583bc37d54ffe055f20eda8382c14eeea01f5\n\n688b4a4ef3ac5de4f2c87bb5061f3f0729efe5818d2463437f4e742d9efbcf05\n\n4abeab45c0503957e16373fe8f872d6055402614d317b1aa969becf07a6fdb05\n\n748891c0ea84b6f8e2b44ec78acd474338c16e8bc24a975b867ac56ad994d939\n\nddd9d1a3c2cf31e2d361922c91efc9be6a253ad5854bb2adfdb02bc21a43817b\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2019/2019-07-12 - TrickBooster – TrickBot’s Email-Based Infection Module.pdf"
    ],
    "report_names": [
        "2019-07-12 - TrickBooster – TrickBot’s Email-Based Infection Module.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673535946,
    "ts_updated_at": 1743041147,
    "ts_creation_date": 1653786736,
    "ts_modification_date": 1653786736,
    "files": {
        "pdf": "https://archive.orkl.eu/d729d5a1d3a747ecfda90b53bb6f48e18f6eaee9.pdf",
        "text": "https://archive.orkl.eu/d729d5a1d3a747ecfda90b53bb6f48e18f6eaee9.txt",
        "img": "https://archive.orkl.eu/d729d5a1d3a747ecfda90b53bb6f48e18f6eaee9.jpg"
    }
}