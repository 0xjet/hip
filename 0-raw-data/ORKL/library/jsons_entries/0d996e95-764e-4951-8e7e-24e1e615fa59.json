{
    "id": "0d996e95-764e-4951-8e7e-24e1e615fa59",
    "created_at": "2024-02-01T02:07:46.795732Z",
    "updated_at": "2025-03-27T02:11:06.189152Z",
    "deleted_at": null,
    "sha1_hash": "0a698810398b0b6c6f451d070e15a2a5121a0b0e",
    "title": "PowerPoint Presentation",
    "authors": "",
    "file_creation_date": "2024-01-12T16:21:07Z",
    "file_modification_date": "2024-01-12T16:21:07Z",
    "file_size": 2604052,
    "plain_text": "# A Study on Long-Term Trends about Amadey C2 Infrastructure\n\n##### BlackBerry Japan Principal Threat Researcher\n\n Masaki Kasuya Ph.D.\n\n\n-----\n\n### Outline\n\n##### • Background and motivation\n\n • What’s Amadey?\n\n • Evaluation\n\n • Lessons Learned\n\n • Conclusion\n\n\n-----\n\n### Background\n\n##### • A variety of malware families have emerged in recent years\n\n###### • Redline, Amadey, Emotet\n\n##### • We see\n\n\n\n###### • Deep-dive malware analysis\n\n Sh t t t d h\n\n\n###### https://any.run/malware-trends/\n\n\n-----\n\n### Difficulty of Long-term Trend Research\n\n#### • Long-term trend research is harder\n\n than deep-dive analysis / short-term trend research\n\n##### • C2 communication protocol changes due to version update\n\n • Encode / encrypt C2 communication\n\n • Scalability\n\n • Server-side evasion\n\n\n-----\n\n### Benefit to Understand Long-term Analysis Result\n\n#### • Security practitioners / researchers understand\n\n##### • Will a new malware family become a major threat?\n\n • What type of malware do attackers spread via bot network?\n\n • Time-to-Live of C2 servers\n\n • Where do attackers upload additional payload?\n\n\n-----\n\n### Motivation\n\n#### • Create an infrastructure for long-term trend research\n\n##### • This talk covers Amadey\n\n#### • Share lessons learned from findings from this project\n\n##### • Collected and analyzed long-term trend for 50 months\n\n\n-----\n\n### Amadey\n\n##### • Appeared in the second half of 2018\n\n###### • https://pastebin.com/U415KmF3\n\n##### • A Russian made malware\n\n###### https://blogs.blackberry.com/en/2020/01/threat-spotlight-amadey-bot Figure 11\n\n##### • The price was 600 USD at that time\n\n\n-----\n\n### Amadey as an Infostealer\n\n##### • Collect victim computer information\n\n\n-----\n\n### Plug-ins for Amadey\n\n#### • DLLs for\n\n##### • Credential stealer\n\n • Screenshot\n\n • 2020/May ~\n\n\n-----\n\n### Request Parameters\n\n##### • They contain basic victim information\n\n###### • Added some parameters due to version update\n\n Ver 1 Ver 3\n\n\n-----\n\n### Response Data\n\n##### • Amadey encrypts response data with RC4 recently\n\n###### • Confirmed Version 4.X since 2023/Nov\n\n RC4 + Base64\n\n RC4 + Hex string\n\n\n-----\n\n### Overview of Amadey Emulator\n\n##### • Create and send dummy C2 request\n\n###### • Give C2 URL, Version number, Amadey ID and RC4 key as “feed” data\n\n • Amadey emulator generates other parameters appropriately\n\n##### • VPN Destination\n\n###### • US, UK, JP and Others\n\n\n-----\n\n### Evaluation\n\n##### • Sent dummy request to 529 Amadey C2 servers (twice a day)\n\n###### • 2019/10/24 – 2023/11/18 (around 50 months)\n\n • Eliminated dead C2 servers appropriately\n\n • Checked whether C2 servers are active or not\n\n • Active: 335 C2 servers\n\n • In-active: 194 C2 servers\n\n • Downloaded unique 5,422 additional payloads\n\n\n-----\n\n### The Number of Active C2 Servers (Daily Basis)\n\n##### • Increased since 2022/Nov\n\n • It dropped on 2023/Nov due to Ver 4\n\n\n-----\n\n### VirusTotal Upload History about Amadey\n\n##### • Confirmed Amadey variants constantly since 2021\n\n • The number of variants increased dramatically since 2022/Oct\n\n\n-----\n\n### Additional Payloads via Amadey\n\n###### • Amadey users spread additional payloads actively since later 2021\n\n • The number of additional payloads increased dramatically in 2023\n\n\n-----\n\n### To Become a Major Threat in case of Amadey\n\n#### • Amadey has taken four years since it appeared\n\n##### • ~ 2021: it is not so active\n\n • 2021 ~: attackers tend to use Amadey\n\n • 2022/Oct ~ : Amadey became a major threat\n\n\n-----\n\n### Appeared Malware Families via Amadey\n\n##### • Confirmed 100 families for 50 months\n\n###### • Collected unique 5,422 samples\n RedlineStealer SystemBCProxy Ficker CinoshiStealer Cat4er Dropper EternityClipper TeamSpy PovertyStealer ImBetter Vidar ClipBanker Kronos Kraken r77Rootkit XMRig ManusCrypt QuasarRAT Kpot ObserverStealer Amadey Async_RAT HVNCRAT Tinynuke GurcuStealer SmokeLoader AuroraStealer AlphaIRCBot BanditStealer ArrowRAT RhadamanthysStealer zgRAT Keylogger ParallaxRAT LockBit Downloader EternityWorm Stealc Solarmarker LolMiner Remcos PandoraHVNC XWorm XFilesStealer Erica CoinMiner AveMaria BlackGuard PureCrypter BlackNET Raccoon StealthWorker Phonk TyphonStealer Osiris Clipper ServHelper njRAT xoCreatorStealer Colibri CryptOne Neoreklami ZLoader DjvuRansom Erbium Fabookie Taurus PredatorStealer StormKitty JesterStealer WindowsDefenderDisabler WhiteSnake EthereumMiner AgentTesla IcarusHVNC YTStealer DCRAT RedlineClipper TitanStealer GhostRAT MysticStealer Socelars Danabot LucaStealer Gminer EternityStealer DarkTortilla Trickbot Ursnif EvilExtractor ArechClient2 GoClipper MassLogger AZORult VectorStealer\n\n|• Collected u|unique 5,422 sa|amples|Col4|Col5|\n|---|---|---|---|---|\n|RedlineStealer|SystemBCProxy|Ficker|CinoshiStealer|Cat4er|\n|Dropper|EternityClipper|TeamSpy|PovertyStealer|ImBetter|\n|Vidar|ClipBanker|Kronos|Kraken|r77Rootkit|\n|XMRig|ManusCrypt|QuasarRAT|Kpot|ObserverStealer|\n|Amadey|Async_RAT|HVNCRAT|Tinynuke|GurcuStealer|\n|SmokeLoader|AuroraStealer|AlphaIRCBot|BanditStealer|ArrowRAT|\n|RhadamanthysStealer|zgRAT|Keylogger|ParallaxRAT|LockBit|\n|Downloader|EternityWorm|Stealc|Solarmarker|LolMiner|\n|Remcos|PandoraHVNC|XWorm|XFilesStealer|Erica|\n|CoinMiner|AveMaria|BlackGuard|PureCrypter|BlackNET|\n|Raccoon|StealthWorker|Phonk|TyphonStealer|Osiris|\n|Clipper|ServHelper|njRAT|xoCreatorStealer|Colibri|\n|CryptOne|Neoreklami|ZLoader|DjvuRansom|Erbium|\n|Fabookie|Taurus|PredatorStealer|StormKitty|JesterStealer|\n|WindowsDefenderDisabler|WhiteSnake|EthereumMiner|AgentTesla|IcarusHVNC|\n|YTStealer|DCRAT|RedlineClipper|TitanStealer|GhostRAT|\n|MysticStealer|Socelars|Danabot|LucaStealer|Gminer|\n|EternityStealer|DarkTortilla|Trickbot|Ursnif|EvilExtractor|\n\n\n-----\n\n### The Number of Additional Payloads per Year\n\n##### • The number of additional payloads via Amadey is increasing\n\n\n-----\n\n### Top 10 Malware\n\n##### • Redline was spread\n\n as an additional payload\n\n###### • Almost 2.5x more than anything else\n\n##### • Dropper contained several families\n\n • Info-stealer was spread frequently\n\n\n###### The count is daily unique cumulated number\n\n\n-----\n\n### Top 10 Malware Monthly Trend\n\n\n-----\n\n### Odd Situation in 2019\n\n##### • Spread installer program of AVG via Amadey\n\n###### • 2019/Oct/27 – 2019/Nov/23\n\n##### • Did the attacker check Amadey’s loader function?\n\n###### • We did not see any malicious additional payloads from the C2 server\n\n\n-----\n\n### Odd Situation in 2020\n\n##### • Found 3 URLs: NSA, FBI and CIA on 2020/Feb/27\n\n • Due to inappropriate configuration?\n\n\n-----\n\n### Amadey Spreads Some Payloads at Once\n\n##### • 6ac2… : Dropper\n\n###### • The dropper contained Redline Stealer and Mystic Stealer\n\n##### • 858d … : Mystic Stealer\n\n • 6131 … : SmokeLoader\n\n###### • It downloaded Redline Stealer and Mystic Stealer\n\n\n-----\n\n### Amadey C2 Server’s Location\n\n##### • The most used C2 server location was Russia\n\n\n-----\n\n### Amadey C2 Server’s Time-to-Live\n\n##### • 38 C2 servers were active for more than 90 days\n\n###### • 3 C2 servers were active for more than a year\n\n • Around 90% C2 servers were active for less than 90 days or equal\n\n\n-----\n\n## Domain Names to Save Additional Payload\n\n##### • Attackers tend to use legitimate services\n\n###### • Simple URL / Domain filtering won’t be effective\n\n\n-----\n\n## Correlation between Amadey and Redline\n\n##### • Investigated their additional payload spread campaigns\n\n###### • I did a similar research for Redline [DFRWS APAC 2023, Kasuya]\n\n##### • Extracted samples with same hash value, same URL and same\n\n day between the two families\n\n\n-----\n\n### Malware Spread Campaign of Amadey / Redline\n\n###### • Amadey C2: 45[.]15[.]156[.]208\n hXXp://194[.]180[.]49[.]153/udp/rdpcllp[.]exe\n • Redline C2: dmg[.]allwesoft [.]com hXXp://194[ ]180[ ]49[ ]153/udp/taskmask[ ]exe\n\n\n-----\n\n### Malware Spread Campaign of Amadey / Redline\n\n\n\n##### • C2 / Duration\n\n###### • Amadey C2\n\n • 45_15_156_208\n\n • Redline C2\n\n\n###### hXXp://165[.]232[.]162[.]31/udp/mntaskost[.]exe hXXp://165[.]232[.]162[.]31/udp/cltaskost[.]exe hXXp://165[.]232[.]162[.]31/udp/mtaskhost[.]exe hXXp://165[.]232[.]162[.]31/udp/cltaskhost[.]exe hXXp://165[.]232[.]162[.]31/udp/rdpcllp[.]exe hXXp://194[.]180[.]49[.]153/udp/rdpcllp[.]exe hXXp://194[.]180[.]49[.]153/udp/taskmask[.]exe\n\n\n\n###### • dmg_allwesoft_com:11615, 5_209_3_10:11615, oodlogs_neverever_ug:11615\n\n • 2023/06/11, 2023/06/14 - 2023/06/29, 2023/07/26 - 2023/07/31,\n\n 2023/08/11 - 2023/08/13\n\n##### • They spread Redline, XMRig, LaplasClipper at the same time\n\n\n-----\n\n### Malware Spread Campaign of Amadey / Redline\n\n###### • Attacker can spread malware with different bot network\n\n • Amadey\n\n • Late in October 2021, early in November 2021\n\n • CoinMiner\n\n • Middle – late in January 2022, early February 2022, early March 2022\n\n • Amadey, CoinMiner and DarkTerritoryClipper\n\n • Middle - late Feburary 2022, April 2022, Middle in May\n\n • LaplasClipper\n\n • Late in July 2023\n\n\n-----\n\n## Lessons Learned\n\n##### • New malware family can be a major threat a few years later\n\n • One malware infection brings other malware infections\n\n###### • Prevention-first approach is important to mitigate security risk\n\n##### • Attackers hosts malware on legitimate services\n\n###### • Simple URL / Domain filtering won’t be effective\n\n\n-----\n\n## Conclusion\n\n##### • Implemented Amadey emulator\n\n###### • Contributed to understand long-term additional payload trend\n\n##### • Amadey became a major threat since 2021\n\n###### • Spread a variety of malware families\n\n • Hosted additional payloads on legitimate services\n\n##### • Shared lessons learned with computer security community\n\n\n-----\n\n## Thank You\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "bf5be533-fa31-4590-ae37-5761c97ffa34",
            "created_at": "2022-10-25T16:13:58.389257Z",
            "updated_at": "2022-10-25T16:13:58.389257Z",
            "deleted_at": null,
            "name": "Malpedia",
            "url": "https://malpedia.caad.fkie.fraunhofer.de",
            "description": "Malpedia is a free service offered by Fraunhofer FKIE",
            "reports": null
        }
    ],
    "references": [
        "https://jsac.jpcert.or.jp/archive/2024/pdf/JSAC2024_1_1_kasuya_en.pdf"
    ],
    "report_names": [
        "JSAC2024_1_1_kasuya_en.pdf"
    ],
    "threat_actors": [
        {
            "id": "1d8dd2ca-5592-482e-b89d-6a7e1a49f4f6",
            "created_at": "2023-01-06T13:46:38.408359Z",
            "updated_at": "2025-03-27T02:00:02.826069Z",
            "deleted_at": null,
            "main_name": "TeamSpy Crew",
            "aliases": [
                "TeamSpy",
                "Team Bear",
                "Anger Bear",
                "IRON LYRIC"
            ],
            "source_name": "MISPGALAXY:TeamSpy Crew",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1706753266,
    "ts_updated_at": 1743041466,
    "ts_creation_date": 1705076467,
    "ts_modification_date": 1705076467,
    "files": {
        "pdf": "https://archive.orkl.eu/0a698810398b0b6c6f451d070e15a2a5121a0b0e.pdf",
        "text": "https://archive.orkl.eu/0a698810398b0b6c6f451d070e15a2a5121a0b0e.txt",
        "img": "https://archive.orkl.eu/0a698810398b0b6c6f451d070e15a2a5121a0b0e.jpg"
    }
}