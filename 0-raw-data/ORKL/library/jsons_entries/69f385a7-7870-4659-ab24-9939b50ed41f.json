{
    "id": "69f385a7-7870-4659-ab24-9939b50ed41f",
    "created_at": "2023-01-12T15:04:54.997472Z",
    "updated_at": "2025-03-27T02:05:40.192535Z",
    "deleted_at": null,
    "sha1_hash": "3fcefd17033094fd29e65f2a9a2fcc28b1d7e98c",
    "title": "2021-05-14 - Darkside Ransomware Victims Sold Short",
    "authors": "",
    "file_creation_date": "2022-05-28T19:03:13Z",
    "file_modification_date": "2022-05-28T19:03:13Z",
    "file_size": 1485559,
    "plain_text": "# DarkSide Ransomware Victims Sold Short\n\n**[mcafee.com/blogs/other-blogs/mcafee-labs/darkside-ransomware-victims-sold-short/](https://www.mcafee.com/blogs/other-blogs/mcafee-labs/darkside-ransomware-victims-sold-short/)**\n\nMay 14, 2021\n\nOver the past week we have seen a considerable body of work focusing on DarkSide, the\n[ransomware responsible for the recent gas pipeline shutdown. Many of the excellent](https://www.cnet.com/news/fbi-says-darkside-hacking-group-responsible-for-pipeline-cyberattack/)\ntechnical write-ups will detail how it operates an affiliate model that supports others to be\ninvolved within the ransomware business model (in addition to the developers). While this\nmay not be a new phenomenon, this model is actively deployed by many groups with great\neffect. Herein is the crux of the challenge: while the attention may be on DarkSide\n[ransomware, the harsh reality is that equal concern should be placed at Ryuk, or](https://www.mcafee.com/blogs/other-blogs/mcafee-labs/ryuk-ransomware-attack-rush-to-attribution-misses-the-point/) [REVIL, or](https://www.mcafee.com/blogs/other-blogs/mcafee-labs/mcafee-atr-analyzes-sodinokibi-aka-revil-ransomware-as-a-service-what-the-code-tells-us/)\n[Babuk, or](https://www.mcafee.com/blogs/other-blogs/mcafee-labs/babuk-ransomware/) [Cuba, etc. These, and other groups and their affiliates, exploit common entry](https://www.mcafee.com/blogs/other-blogs/mcafee-labs/mcafee-defenders-blog-cuba-ransomware-campaign/)\nvectors and, in many cases, the tools we see being used to move within an environment are\nthe same. While this technical paper covers DarkSide in more detail, we must stress the\nimportance of implementing best practices in securing/monitoring your network. These\nadditional publications can guide you in doing so:\n\n\n-----\n\nRDP Security Explained: https://www.mcafee.com/blogs/other-blogs/mcafee-labs/rdpsecurity-explained/\nDefending against CUBA Ransomware: https://www.mcafee.com/blogs/otherblogs/mcafee-labs/mcafee-defenders-blog-cuba-ransomware-campaign/\nRansomware Defenses: https://www.mcafee.com/blogs/other-blogs/mcafeelabs/mcafee-defenders-blog-reality-check-for-your-defenses/\nBuilding Adaptable Security Architecture Against NetWalker:\nhttps://www.mcafee.com/blogs/other-blogs/mcafee-labs/mcafee-defenders-blognetwalker/\nENS 10.7 Rolls Back the Curtain on Ransomware:\nhttps://www.mcafee.com/blogs/other-blogs/mcafee-labs/ens-10-7-rolls-back-thecurtain-on-ransomware/\n\n## DarkSide Ransomware: What is it?\n\nAs mentioned earlier, DarkSide is a Ransomware-as-a-Service (RaaS) that offers high\nreturns for penetration-testers that are willing to provide access to networks and\ndistribute/execute the ransomware. DarkSide is an example of a RaaS whereby they actively\ninvest in development of the code, affiliates, and new features. Alongside their threat to leak\ndata, they have a separate option for recovery companies to negotiate, are willing to engage\nwith the media, and are willing to carry out a Distributed Denial of Service (DDoS) attack\nagainst victims. Those victims who do pay a ransom receive an alert from DarkSide on\ncompanies that are on the stock exchange who are breached, in return for their payment.\nPotential legal issues abound, not to mention ethical concerns, but this information could\ncertainly provide an advantage in short selling when the news breaks.\n\n[The group behind DarkSide are also particularly active. Using MVISION Insights we can](https://www.mcafee.com/enterprise/en-us/lp/insights-preview.html)\nidentify the prevalence of targets. This map clearly illustrates that the most targeted\ngeography is clearly the United States (at the time of writing). Further, the sectors primarily\ntargeted are Legal Services, Wholesale, and Manufacturing, followed by the Oil, Gas and\n**Chemical sectors.**\n\n\n-----\n\n## Coverage and Protection Advice\n\n[McAfee’s market leading EPP solution covers DarkSide ransomware with an array of early](https://www.mcafee.com/blogs/enterprise/gartner-names-mcafee-a-leader-in-2021-magic-quadrant-for-endpoint-protection-platforms/)\nprevention and detection techniques.\n\nCustomers using MVISION Insights will find a threat-profile on this ransomware family that is\nupdated when new and relevant information becomes available.\n\n\n-----\n\n## Early Detection\n\nMVISION EDR includes detections on many of the behaviors used in the attack including\nprivilege escalation, malicious PowerShell and CobaltStrike beacons, and visibility of\ndiscovery commands, command and control, and other tactics along the attack chain. We\nhave EDR telemetry indicating early detection before the detonation of the Ransomware\npayload.\n\n## Prevention\n\nENS TP provides coverage against known indicators in the latest signature set. Updates on\nnew indicators are pushed through GTI.\n\nENS ATP provides behavioral content focusing on proactively detecting the threat while also\ndelivering known IoCs for both online and offline detections.\n\nENS ATP adds two (2) additional layers of protection thanks to JTI rules that provide attack\nsurface reduction for generic ransomware behaviors and RealProtect (static and dynamic)\nwith ML models targeting ransomware threats.\n\nFor the latest mitigation guidance, please review:\n\n[https://kc.mcafee.com/corporate/index?page=content&id=KB93354&locale=en_US](https://kc.mcafee.com/corporate/index?page=content&id=KB93354&locale=en_US)\n\n## Technical Analysis\n\nThe RaaS platform offers the affiliate the option to build either a Windows or Unix version of\nthe ransomware. Depending on what is needed, we observe that affiliates are using different\ntechniques to circumvent detection, by masquerading the generated Windows binaries of\nDarkSide. Using several packers or signing the binary with a certificate are some of the\ntechniques used to do so.\n\nAs peers in our industry have described, we also observed campaigns where the affiliates\nand their hacking crew used several ways to gain initial access to their victim’s network.\n\n1. Using valid accounts, exploit vulnerabilities on servers or RDP for initial stage\n2. Next, establish a beachhead in the victim’s network by using tools like Cobalt-Strike\n\n(beacons), RealVNC, RDP ported over TOR, Putty, AnyDesk and TeamViewer.\n**TeamViewer is what we also see back in the config of the ransomware sample:**\n\n\n-----\n\nThe configuration of the ransomware contains several options to enable or disable system\nprocesses, but also the above part where it states which processes should not be killed.\n\nAs mentioned before, a lot of the current Windows samples in the wild are the 1.8 version of\nDarkSide, others are the 2.1.2.3 version. In a chat one of the actors revealed that a V3\nversion will be released soon.\n\nOn March 23, 2021, on XSS, one of the DarkSide spokespersons announced an update ofrd\nDarkSide as a PowerShell version and a major upgrade of the Linux variant:\n\nIn the current samples we observe, we do see the PowerShell component that is used to\ndelete the Volume Shadow copies, for example.\n\n1. Once a strong foothold has been established, several tools are used by the actors to\n\ngain more privileges.\n\nTools observed:\n\nMimikatz\nDumping LSASS\nIE/FireFox password dumper\nPowertool64\nEmpire\nBypassing UAC\n\n1. Once enough privileges are gained, it is time to map out the network and identify the\n\nmost critical systems like servers, storage, and other critical assets. A selection of the\nbelow tools was observed to have been used in several cases:\n\nBloodHound\nADFind\nADRecon\n\n\n-----\n\nIP scan tools\nSeveral Windows native tools\nPowerShell scripts\n\nBefore distributing the ransomware around the network using tools like PsExec and\nPowerShell, data was exfiltrated to Cloud Services that would later be used on the DarkSide\nLeak page for extortion purposes. Zipping the data, using Rclone or WinSCP are some of the\nexamples observed.\n\nWhile a lot of good and in-depth analyses are written by our peers, one thing worth noting is\nthat when running DarkSide, the encryption process is fast. It is one of the areas the actors\nbrag about on the same forum and do a comparison to convince affiliates to join their\nprogram:\n\nDarkSide, like Babuk ransomware, has a Linux version. Both target *nix systems but in\nparticular VMWare ESXi servers and storage/NAS. Storage/NAS is critical for many\ncompanies, but how many of you are running a virtual desktop, hosted on a ESXi server?\n\nDarkside wrote a Linux variant that supports the encryption of ESXI server versions 5.0 – 7.1\nas well as NAS technology from Synology. They state that other NAS/backup technologies\nwill be supported soon.\n\nIn the code we clearly observe this support:\n\n\n-----\n\nAlso, the configuration of the Linux version shows it is clearly looking for Virtual Disk/memory\nkind of files:\n\nAlthough the adversary recently claimed to vote for targets, the attacks are ongoing with\npacked and signed samples observed as recently as today (May 12, 2021):\n\n\n-----\n\n## Conclusion\n\nRecently the [Ransomware Task Force, a partnership McAfee is proud to be a part of,](https://securityandtechnology.org/ransomwaretaskforce/)\nreleased a detailed paper on how ransomware attacks are occurring and how\ncountermeasures should be taken. As many of us have published, presented on, and\nreleased research upon, it is time to act. Please follow the links included within this blog to\napply the broader advice about applying available protection and detection in your\nenvironment against such attacks.\n\n### MITRE ATT&CK Techniques Leveraged by DarkSide:\n\nData Encrypted for Impact – T1486\n\nInhibit System Recovery – T1490\n\nValid Accounts – T1078\n\nPowerShell – T1059.001\n\nService Execution – T1569.002\n\nAccount Manipulation – T1098\n\nDynamic-link Library Injection – T1055.001\n\nAccount Discovery – T1087\n\nBypass User Access Control – T1548.002\n\n\n-----\n\nFile Permissions Modification – T1222\n\nSystem Information Discovery – T1082\n\nProcess Discovery – T1057\n\nScreen Capture – T1113\n\nCompile After Delivery – T1027.004\n\nCredentials in Registry – T1552.002\n\nObfuscated Files or Information – T1027\n\nShared Modules – T1129\n\nWindows Management Instrumentation – T1047\n\nExploit Public-Facing Application – T1190\n\nPhishing – T1566\n\nExternal Remote Services – T1133\n\nMulti-hop Proxy – T1090.003\n\nExploitation for Privilege Escalation – T1068\n\nApplication Layer Protocol – T1071\n\nBypass User Account Control – T1548.002\n\nCommonly Used Port – T1043\n\nCompile After Delivery – T1500\n\nCredentials from Password Stores – T1555\n\nCredentials from Web Browsers – T1555.003\n\nCredentials in Registry – T1214\n\nDeobfuscate/Decode Files or Information – T1140\n\nDisable or Modify Tools – T1562.001\n\nDomain Account – T1087.002\n\nDomain Groups – T1069.002\n\n\n-----\n\nDomain Trust Discovery – T1482\n\nExfiltration Over Alternative Protocol – T1048\n\nExfiltration to Cloud Storage – T1567.002\n\nFile and Directory Discovery – T1083\n\nGather Victim Network Information – T1590\n\nIngress Tool Transfer – T1105\n\nLinux and Mac File and Directory Permissions Modification – T1222.002\n\nMasquerading – T1036\n\nProcess Injection – T1055\n\nRemote System Discovery – T1018\n\nScheduled Task/Job – T1053\n\nService Stop – T1489\n\nSystem Network Configuration Discovery – T1016\n\nSystem Services – T1569\n\nTaint Shared Content – T1080\n\nUnix Shell – T1059.004\n\n[Raj Samani VP, Chief Technical Officer EMEA](https://www.mcafee.com/blogs/author/raj-samani/)\nRaj Samani is Chief Scientist and Fellow for the Enterprise business. He has assisted\nmultiple law enforcement agencies in cybercrime cases and is a special advisor to the\nEuropean Cybercrime...\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-05-14 - Darkside Ransomware Victims Sold Short.pdf"
    ],
    "report_names": [
        "2021-05-14 - Darkside Ransomware Victims Sold Short.pdf"
    ],
    "threat_actors": [
        {
            "id": "610a7295-3139-4f34-8cec-b3da40add480",
            "created_at": "2023-01-06T13:46:38.608142Z",
            "updated_at": "2025-03-27T02:00:02.87217Z",
            "deleted_at": null,
            "main_name": "Cobalt",
            "aliases": [
                "Cobalt Gang",
                "GOLD KINGSWOOD",
                "COBALT SPIDER",
                "G0080",
                "Mule Libra",
                "Cobalt Group"
            ],
            "source_name": "MISPGALAXY:Cobalt",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673535894,
    "ts_updated_at": 1743041140,
    "ts_creation_date": 1653764593,
    "ts_modification_date": 1653764593,
    "files": {
        "pdf": "https://archive.orkl.eu/3fcefd17033094fd29e65f2a9a2fcc28b1d7e98c.pdf",
        "text": "https://archive.orkl.eu/3fcefd17033094fd29e65f2a9a2fcc28b1d7e98c.txt",
        "img": "https://archive.orkl.eu/3fcefd17033094fd29e65f2a9a2fcc28b1d7e98c.jpg"
    }
}