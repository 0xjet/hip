{
    "id": "05cf4336-5a82-4489-9fdb-269acc55f198",
    "created_at": "2023-01-12T15:03:01.298678Z",
    "updated_at": "2025-03-27T02:09:45.619982Z",
    "deleted_at": null,
    "sha1_hash": "4adde67184d746c9a42e2b06ae4440f4a36d69bd",
    "title": "2021-05-19 - Tracking BokBot Infrastructure Mapping a Vast and Currently Active BokBot Network",
    "authors": "",
    "file_creation_date": "2022-05-28T02:44:37Z",
    "file_modification_date": "2022-05-28T02:44:37Z",
    "file_size": 671069,
    "plain_text": "# Tracking BokBot (IcedID) Infrastructure\n\n**[team-cymru.com/blog/2021/05/19/tracking-bokbot-infrastructure/](https://team-cymru.com/blog/2021/05/19/tracking-bokbot-infrastructure/)**\n\nS2 Research Team View all posts by S2 Research Team May 19, 2021\n\n**Co-authored by Josh Hopkins, Andy Kraus and Nick Byers**\n\nBokBot (also known as IcedID) started life as a banking trojan using man-in-the-browser\nattacks to steal credentials from online banking sessions and initiate fraudulent transactions.\nOver time, the operator(s) of BokBot have also developed its use as a delivery mechanism\nfor other malware, in particular ransomware.\n\nIn the past BokBot was itself primarily distributed via the Emotet botnet. Since the takedown\nof [Emotet earlier this year we have been tracking BokBot to see how the actors might react](https://team-cymru.com/blog/2021/01/27/taking-down-emotet/)\nto and seek to exploit the situation for personal gain.\n\nOver recent months we have been posting BokBot IOCs to our Twitter account\n[(@teamcymru_S2) as we identify them. However, in this blog we want to share some of our](https://twitter.com/teamcymru_S2)\nbroader techniques, as well as a brief insight into our recent view of the upward management\nof BokBot infrastructure. All ‘Tier 1’ BokBot domains and hosting IP addresses, which we\n[have identified over the past six months, are available through our public GitHub.](https://github.com/team-cymru/iocs/blob/master/bokbot/BokBot%20-%20Tier%201%20(May%20'21))\n\nPassive DNS\n\n\n-----\n\n[Our research started with a list of BokBot controller domains, identified in a blog post by](https://www.fireeye.com/blog/threat-research/2021/02/melting-unc2198-icedid-to-ransomware-operations.html)\nFireEye in February:\n\ncolombosuede[.]club\ncolosssueded[.]top\ngolddisco[.]top\njune85[.]cyou\n\nPivoting on these domain names within our Passive DNS (PDNS) data holdings, we were\nable to identify several dozen linked domains, as well as a handful of ‘Tier 1’ hosting IP\naddresses. A summary of these findings is illustrated in Figure 1 below.\n\nFigure 1: Initial PDNS Pivots\n\nAll of the domains we identified in this process used relatively uncommon top-level domains\n(TLDs) (Figure 2) and were registered through domain name registrars NameSilo and\nPorkbun. The majority of the Tier 1 IP addresses we identified were assigned to either Digital\nOcean or M247.\n\nThese three elements (TLD, domain registrar and hosting provider) provide us with a\nrepeating pattern, which gives us a degree of confidence that the identified domains are\nrelated.\n\n\n-----\n\nFigure 2: Most Frequently Occurring TLDs\n\nCertificate and Banner Information\n\nLooking more closely at the Tier 1 IP addresses hosting these domains, more patterns begin\nto emerge. Firstly, these IP addresses host a self-signed X.509 certificate with the subject:\n\nCN=localhost, C=AU, ST=Some State, O=Internet Widgits Pty Ltd\n\nWhilst not unique to BokBot hosts, the repeated appearance of this certificate provides\nanother indication that identified infrastructure is linked.\n\nSecondly, we often observed banner information on these IP addresses indicating the use of\nOpenResty (a web platform based on Nginx). OpenResty has previously been identified as a\n[tool favoured by the BokBot operator(s) for management activities – dating back to 2017.](https://securityintelligence.com/new-banking-trojan-icedid-discovered-by-ibm-x-force-research/)\n\nNetwork Traffic Analysis\n\nNext, we utilized our network traffic data holdings to look for common peers amongst the Tier\n1 IP addresses. Using this methodology, we identified several Tier 2 IP addresses which\nwere used to relay traffic from the Tier 1 IP addresses over TCP/443. The Tier 2 IP\naddresses hosted banner information indicating the use of OpenResty, similar to the Tier 1 IP\naddresses.\n\nWe subsequently discovered these Tier 2 IP addresses were exchanging network traffic with\ndozens of previously unknown Tier 1 IP addresses, which we then enriched with PDNS data\nto identify further BokBot domains. This process becomes repeatable – pivoting between\nnetwork traffic and PDNS data until all ‘new’ infrastructure identifications are exhausted.\n\nA common attribute amongst the Tier 2 IP addresses was the hosting of an X.509 certificate\nwith a CN value of ‘main.info’. This certificate was first observed on IP 185.103.110.172,\nassigned to Creanova Hosting Solutions Ltd in Finland, and subsequently observed on a\nfurther sixteen Tier 2 IP addresses (Table 1).\n\nIP Address Cert CN ASN Geolocation\n\n\n-----\n\n5.101.0.243 main.info PINDC Russia\n\n5.101.0.245 main.info PINDC Russia\n\n31.184.192.39 main.info PINDC Russia\n\n31.184.193.142 main.info PINDC Russia\n\n31.184.193.17 main.info PINDC Russia\n\n46.30.42.185 main.info EUROBYTE Russia\n\n80.66.83.166 main.info TRUENETWORK Poland\n\n185.186.141.140 main.info ASKONTEL Russia\n\n176.9.19.209 main.info HETZNER Germany\n\n45.128.151.15 main.info ITL-LV Latvia\n\n146.185.215.18 main.info GCORE Russia\n\n95.215.0.211 main.info PINDC Russia\n\n45.143.138.72 main.info GARANT-PARK-INTERNET Russia\n\n195.19.192.49 main.info DCE-AS Russia\n\n95.217.51.27 main.info HETZNER Finland\n\n185.18.54.134 main.info WORLDSTREAM Spain\n\n\n-----\n\nFigure 3: BokBot Infrastructure Discovery Process\n\nWe observed the Tier 2 IP addresses in Table 1 being used in the management of BokBot\ninfrastructure over a number of months. However, on 29 April 2021 we noticed a significant\ndrop-off in activity, which has remained consistent to the time of publishing (Figure 3).\n\nFigure 4: Tier 2 IP Address Activity Timeline\n\nConclusion\n\nIn conclusion, while BokBot operations may have been temporarily impacted by the Emotet\ntakedown, our analysis shows they are currently running a vast and active network which\nencompasses upwards of 1,500 domains hosted on over 250 Tier 1 IP addresses.\n\n\n-----\n\n[We hope that the releasing of these indicators proves helpful in identifying and mitigating](https://github.com/team-cymru/iocs/blob/master/bokbot/BokBot%20-%20Tier%201%20(May%20'21))\nexisting BokBot activities and also in disrupting the future operations of the BokBot actor(s).\n\nOur findings are summarized in Figure 5 below:\n\nFigure 5: BokBot Infrastructure Overview\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-05-19 - Tracking BokBot Infrastructure Mapping a Vast and Currently Active BokBot Network.pdf"
    ],
    "report_names": [
        "2021-05-19 - Tracking BokBot Infrastructure Mapping a Vast and Currently Active BokBot Network.pdf"
    ],
    "threat_actors": [
        {
            "id": "c3c864b3-fac9-4d56-8500-7c06c829fbf8",
            "created_at": "2023-01-06T13:46:39.071873Z",
            "updated_at": "2025-03-27T02:00:02.990045Z",
            "deleted_at": null,
            "main_name": "TA2101",
            "aliases": [
                "Storm-0216",
                "DEV-0216",
                "UNC2198",
                "Maze Team",
                "TWISTED SPIDER",
                "GOLD VILLAGE"
            ],
            "source_name": "MISPGALAXY:TA2101",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673535781,
    "ts_updated_at": 1743041385,
    "ts_creation_date": 1653705877,
    "ts_modification_date": 1653705877,
    "files": {
        "pdf": "https://archive.orkl.eu/4adde67184d746c9a42e2b06ae4440f4a36d69bd.pdf",
        "text": "https://archive.orkl.eu/4adde67184d746c9a42e2b06ae4440f4a36d69bd.txt",
        "img": "https://archive.orkl.eu/4adde67184d746c9a42e2b06ae4440f4a36d69bd.jpg"
    }
}