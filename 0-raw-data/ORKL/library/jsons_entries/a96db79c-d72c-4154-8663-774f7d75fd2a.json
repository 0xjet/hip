{
    "id": "a96db79c-d72c-4154-8663-774f7d75fd2a",
    "created_at": "2023-01-12T15:02:11.294757Z",
    "updated_at": "2025-03-27T02:09:29.594441Z",
    "deleted_at": null,
    "sha1_hash": "c5b2430fd860f304db56103fa703fdb4c866d1ae",
    "title": "2021-05-13 - Domain Blooms- Identifying Domain Name Themes Targeted By Threat Actors",
    "authors": "",
    "file_creation_date": "2022-05-28T02:35:41Z",
    "file_modification_date": "2022-05-28T02:35:41Z",
    "file_size": 452167,
    "plain_text": "# Domain Blooms: Identifying Domain Name Themes Targeted By Threat Actors\n\n**[domaintools.com/resources/blog/domain-blooms-identifying-domain-name-themes-targeted-by-threat-actors](https://www.domaintools.com/resources/blog/domain-blooms-identifying-domain-name-themes-targeted-by-threat-actors)**\n\n## Summary\n\nThreat actors have no qualms with taking advantage of any crisis in the world they can\ncapitalize on. Whether it's a hurricane, political unrest, or even a pandemic, threat actors\nwill try to blend into the world's online response and create fraudulent infrastructure in order\nto make money, steal PII, or even induce civil unrest. Mapping out the online response to\ndifferent world events is the first step in being able to identify what themes threat actors are\ntargeting at any given time.\n\nDomainTools conducted research into what we call Domain Blooms is our attempt to\nidentify new and trending themes in domain names being registered, and highlighting which\nones threat actors are potentially targeting for their malicious campaigns.\n\n_For an in depth analysis of some of the more notable domain blooms that occurred during_\n_[2020 take a look at the The DomainTools Report: Spring 2021 Edition.](https://www.domaintools.com/resources/domaintools-reports/domain-blooms-new-method-of-detecting-trending-bad-domains)_\n\n## Background\n\n\n-----\n\nBack in February 2020, when COVID-19 was rapidly gaining international awareness, threat\nactors were actively taking advantage of the situation and registering hundreds of malicious\nCOVID-19 related domains per day. The DomainTools Security Research Team was\nscanning newly registered COVID-19 related domains daily and ran across\n[coronavirusapp[.]site, which claimed to have a real-time Coronavirus tracker app available](https://www.domaintools.com/resources/blog/covidlock-mobile-coronavirus-tracking-app-coughs-up-ransomware)\nfor download.\n\n[The security researchers pulled down the Android app, went to town ripping it apart and](https://www.domaintools.com/resources/blog/covidlock-update-coronavirus-ransomware)\ndiscovered it was really a ransomware app that would lock the victim’s phone and demand\n$100 in Bitcoin to regain access to the device.\n\nThis was a valuable find and it raised a couple questions. First, security researchers need\nto have a good gut feeling for what words to lookup each day when scanning newly\nregistered domains. But what about other related words that threat actors are capitalizing\non that get missed? Second, the rapid increase in COVID-19 related domains was a visible\ntrend, but what about the next one that isn’t as obvious? How can we identify the next trend\nin domain names that threat actors are targeting and which words they are using?\n\n## Telling the Story of COVID-19 Through Domain Registrations\n\nWhen DomainTools first started analyzing COVID-19 related domains, one of the early\nvisualizations used was a histogram of the number of domains registered per day for a\nspecific word. Below is the histogram for the word “covid” for 2020 and it tells us several\nthings.\n\nFirst, prior to February, 2020 the word “covid” was almost never used in domain name\nregistrations. Then on February 11th, over 800 domains were suddenly registered using the\nword “covid”. This date corresponds to the day after the World Health Organization (WHO)\n\n\n-----\n\nofficially named the disease COVID-19 .\n\nBy February 14th, the number of daily “covid” domains dropped down to a couple dozen per\nday and remained steady for about a week and a half. Then in late February, the number of\ndomains started to increase again and continued to do so until March 12th, at which point\nthey skyrocketed to an unprecedented 2500 domains registered in a single day. This turns\nout to be the day after the WHO officially declared COVID-19 a pandemic.\n\nFrom mid March to early April the number of “covid” domain registrations exceeded 2,000\ndaily, and then started to gradually drop, eventually settling at a new baseline of around 200\ndomains per day where it has held steady ever since.\n\nYou might be asking yourself “what is the purpose or intent behind these domains?” Some\nwere official COVID-19 informational domains created by different municipalities, health and\nnonprofit organizations. Some were misinformation and disinformation domains; sketchy but\nnot a threat from a cyber security perspective. Many were the result of domain name\nspeculation that inevitably seems to follow any crisis or news event. But a large number of\nthese domains were created by threat actors for fraud, phishing, and Personally Identifiable\nInformation (PII) collection purposes.\n\n## Applying the Micro to the Macro\n\nOne of the primary goals of data science in cybersecurity is to analyze the tactics and\ntechniques that security researchers use every day and try to apply them algorithmically to\nthe data at scale.\n\nFollowing this modus operandi, instead of trying to guess which words to monitor each day\nto identify new themes in domain name registrations, we chose to monitor all words every\nday and analyze each word’s frequency distribution over time to identify outliers from their\nbaseline frequency.\n\nBut word frequency isn’t the only useful metric to measure. Understanding how unique a\nword or term is provides a lot of valuable insight. Before February 11th, 2020 the word\n“covid” was used in domain names only a couple hundred times; mostly as part of a larger\nword or as a by-product of the combination of two words. Identifying new unique trending\nwords could also be useful when trying to find trends threat actors are taking advantage of.\n\n## Measuring Word Importance in Domains\n\nOne of the most common statistical measures that covers both word frequency and\nuniqueness is TF-IDF. TF-IDF stands for Term Frequency-Inverse Document Frequency\nand is a measure of how important a word is to a single document, relative to a known set\nof documents (also known as a corpus).\n\n\n-----\n\nMore formally, Term Frequency (TF) is the count of a word within a single document. Words\nthat are used more often within a document can have more influence on the semantic\nmeaning of the document. Words that are used only once or twice within a document have\nless influence on the semantic meaning, especially for longer documents.\n\nInverse Document Frequency (IDF) is a measure of how much information a word provides\nrelative to the entire corpus of documents, and is calculated using the function:\n\nwhere N is the total number of documents in the corpus, and DFt is the number of\ndocuments containing the word t. The higher the number of documents the word appears\nwithin the corpus the lower its IDF score, and conversely the fewer documents the word\nappears in the higher its IDF score.\n\nTo put this all together with an example, let’s take Wikipedia.com. This year, Wikipedia\npassed 6 million english articles; so the Wikipedia corpus is 6,000,000 documents. It’s safe\nto assume the word “the” appears in every single document within the corpus. So “the” has\nan IDF score of: log(6,000,000 / 6,000,000 +1) = 0.30.\n\nLet's compare the IDF score for “the” to the word “dragon”. “Dragon” appears in 3,340\nWikipedia documents, giving it an IDF score of: log(6,000,000 / (3,340 + 1)) = 3.25.\n\n(Note: 1 is added to the denominator to protect against divide by zero errors in case a word\ndoesn’t appear in any document)\n\n[When looking at the Wikipedia article for Dungeons & Dragons, the TF-IDF score for “the”](https://en.wikipedia.org/wiki/Dragon_(Dungeons_%26_Dragons))\nand “dragon” can be calculated to show how important these two words are to the article.\n\nThe word “the” has a Term Frequency of 1,705 in the article, giving it a TF-DIF score of:\n1,705 * 0.30 = 511.5.\n\nThe word “dragon” has a Term Frequency of 1,092 in the article, giving it a TF-IDF score of:\n1,092 * 3.25 = 3549\n\nSo when comparing these two words within the context of the Dungeons & Dragons article,\nit can be seen that “dragon” is much more important than to the semantic context of the\narticle than the word “the.”\n\n## Defining a Document\n\nThis same statistical measure for measuring the importance of a word can be applied to\ndomain names, but first we have to define what a document is within the context of domain\nregistrations.\n\n\n-----\n\nSince the goal is to identify word trends in domain name registrations over time, one\napproach is to consider all the domains registered in a single day as a single document,\nand all the individual words that make up these domains as the set of words that make up\nthe document.\n\nFor example, take June 1, 2020; on this day 285,835 domains were registered. Once each\ndomain is split apart into its component (English) words, there are a total of 2,595,402\nwords used to register domains for that day. This would represent a single document within\nour corpus.\n\n_Note: to give a sense on how much repetition there is in words used to register domains_\n_each day, even though there were almost 2.6 million total words used to generate domains_\n_on June 1, 2020, there were only 213,244 unique words._\n\n## Defining a Corpus\n\nA corpus is defined as all the writings or works of a particular kind or on a particular subject.\nIn the Wikipedia.com example, the corpus was all the English articles in Wikipedia. The IDF\nscore tells us how important a word is within the entire corpus of all documents. So when\ncalculating IDF scores for words used to register domain names it’s important to define the\nscope of the corpus in order to calculate meaningful Inverse Document Frequency (IDF)\nscores.\n\nThe corpus could be defined as every day since some arbitrary date, but that has some\nissues. Since the goal is to identify new and trending words that threat actors might be\ntargeting, going too far back in time has the potential of down weighting IDF scores for\nwords that are currently trending, but have also trended in the past.\n\nTake the word “Christmas” for example. If the beginning of the corpus is set as July 1st,\n2018, the number of times “Christmas” is used per day looks like the following.\n\n\n-----\n\nNotice there is a predictable annual increase in the number of domains per day starting in\nearly September and lasting until the end of December.\n\nIf on October 1, 2020 one was looking for uniquely trending words, the IDF score for\nChristmas would have included counts from the trending peaks back in 2018 and 2019.\nThis can potentially lower Christmas’s IDF score to the point where it no longer identifies\nChristmas as a newly trending word.\n\nTo get around this problem, the IDF score is calculated based on a sliding 180 day historic\nwindow. So, for each day, for each word, the IDF calculation uses the prior 180 days as it’s\ncorpus of documents to calculate that word’s IDF score. For example, on October 1, 2020,\nChristmas’s IDF score is calculated based on the number of days it was used between April\n4, 2020 and October 1 2020.\n\nThis sliding 180 day historic window enables the TF-IDF score to identify words that are\nuniquely trending now, regardless of how the word trended during prior years.\n\n## Identifying Domain Name Words\n\nThe next challenge is breaking apart domain names into their component words. There are\nmultiple approaches to handling this problem, but the one that was most successful was to\ncompare newly registered domain names each day against a dictionary of all known words.\nIf a known word was found within a domain name, it was output into a list of all words\ncomprising that domain name.\n\nUnfortunately not every trending word can be found in even the most popular dictionaries.\nFor example, the word “covid” wasn’t added to most online dictionaries until after February\n11th, 2020. So to try and capture the most representative set of English words, the following\n\n\n-----\n\nsources of were parsed and merged into a gold standard dictionary:\n\nThree open source online dictionaries\n[Google n-gram dataset](http://commondatastorage.googleapis.com/books/syntactic-ngrams/index.html)\n[Urban Dictionary](https://www.urbandictionary.com/)\nParsed words from [Wikipedia’s current events page (updated daily)](https://en.wikipedia.org/wiki/Portal:Current_events)\n\nThe Wikipedia current events page has been a valuable source of new important words or\nphrases that were not represented in the other word sources.\n\nAnother challenge in identifying words in domain names is to algorithmically understand\nwhich words the registrant was targeting when they registered the domain name. Take the\nfictitious domain sharepoint-chasebank-login[.]com.\n\nThe list of all possible English words from this domain are:\n\nshare\nhare\npoint\nrepoint\nsharepoint\nchase\nbank\nlog\nlogin\n\nA threat analyst would immediately focus on the words “sharepoint” and “login” and not split\nthem into smaller words, but algorithmically it’s much harder to interpret what the registrant\nintended.\n\nThere are all sorts of different heuristics and probabilistic approaches to addressing this, but\neach have the drawback of potentially missing important words. Instead the naive approach\nof just using all words found in the domain name ends up working quite well.\n\nFrom this data TF-IDF model it is now possible to investigate how words are used in\ndomain name registrations over time.\n\n## Domain Blooms and Spikes\n\nWhenever noteworthy events happen, inevitably people will use words and themes to\nregister domains related to the event. If enough domains related to this theme are\nregistered over a short period of time, these domains can be described in one of two\ndifferent ways; domain spikes and domain blooms.\n\n## Baseline Word Frequency\n\n\n-----\n\nMost words have a baseline frequency in which they are used in domain registrations per\nday. This baseline is generally fairly stable over time, and is often characterized by a 7 day\ncycle as people register fewer domains on the weekends. For example, below is the term\nfrequency per day of the word “phone”.\n\nNotice how generally the word “phone” shows up in approximately 180 domains per day,\nfairly consistent over time. This pattern is what we call a word’s baseline frequency.\n\n## Domain Spikes\n\nWhat becomes interesting is when outliers are identified from this baseline. For example,\nthe below graph shows the term frequency for “phone” extended out to November. Notice\nhow on October 13 there was an increase in domains registered for “phone” that is 300\ndomains greater than the baseline. We call domain registration events like this spikes.\n\n\n-----\n\nA domain spike is a sharp increase in the number of domains registered per day for a\nspecific word relative to its baseline. Spikes happen usually the day after some event\noccurred related to that word and often last only one to two days. The above spike\ncorresponds to the October 13, 2020 release of Apple’s iPhone 12.\n\nAnother example of a news related spike is the one below for the word “beirut” which\ncorresponds with the explosion in Beirut of a fertilizer storage facility that killed more than\n200 people on August 4th, 2020.\n\nNotice that the Beirut spike didn’t appear until the day after the news event, while the phone\nspike was on the same day as the iPhone 12 release. These two domain spikes represent\ntwo different behaviors.\n\n\n-----\n\nThe iPhone 12 spike occurred on the same day as Apple s product event and digging into\nthe DomainTools database it turns out that a large number of them were actually registered\nby Apple Inc; most likely trying to take the domain names off the market so others can’t\nprofit off them or use them in ways that violate Apple’s trademarks.\n\nThe Beirut spike is in response to a tragic incident and looking at the domain names in this\nspike a lot of them are themed around helping the people of Beirut.\n```\nhelpbeirutlb[.]com\nhelp4beirut[.]com\nhope4beirut[.]com\nhelpforbeirut[.]com\nhopeforbeirut[.]com\ndonateforbeirut[.]com\ndonate-beirut[.]com\ndonatebeirut[.]com\ngivetobeirut[.]com\nfundbeirut[.]com\naidbeirut[.]com\nbeirutfund[.]com\n\n```\nUnfortunately, when looking at the domains today almost all of them are just parked\ndomains, most likely registered by domain speculators trying to snap up domains they felt\nsome relief organization might want to purchase.\n\n## DGA Domain Spikes\n\nA special category of domain spikes identified are those created by dictionary based\ndomain generating algorithms (DGAs). DGAs are algorithms that automatically generate\nand sometimes register domain names used by malware and botnets for communication\ncoordination. DGAs traditionally generated domain names with random alpha-numeric\nsequences. These were fairly easy to spot since their character distributions were so\ndifferent than legitimate domain names.\n\nDictionary based DGAs on the other hand try to get around this type of detection by\nrandomly combining dictionary words to create domain names that closely mirror character\ndistributions of legitimate domains. But these are also fairly easy to spot when you know\n\n\n-----\n\nwhat to look for. For example, look at the number of domains registered per day using the\nword “witness”.\n\nThere are several indicators that point to the fact that almost almost every spike was\ngenerated by a dictionary DGA. First, take a look at the baseline before May and after\nOctober; there is a consistent baseline of about 10 domains per day with the word\n“witness”. Next, if you look at the peak of each spike, each one is some multiple of 500\ndomains. Such exact patterns like this do not happen in the wild, and clearly point to some\nscript that automatically generates and registers domain names in batches of 500.\n\nAnother way to identify dictionary based DGAs is to visually scan the domain names that\nmake up a spike. Below is a sample of 16 domain names from the first spike that lasts from\nMay 11th to May 13 and consists of 1,500 domains.\n\n\n-----\n\n```\nultra outlinetowitnesstoday.info\nultraoutline-towitnesstoday.info\nultraoutlineto-witnesstoday[.]info\nultraoutlinetowitness-today[.]info\nbest-outlinetowitnesstoday[.]info\nbestoutline-towitnesstoday[.]info\nbestoutlineto-witnesstoday[.]info\nbestoutlinetowitness-today[.]info\nboss-outlinetowitnesstoday[.]info\nbossoutline-towitnesstoday[.]info\nbossoutlineto-witnesstoday[.]info\nbossoutlinetowitness-today[.]info\ncool-outlinetowitnesstoday[.]info\ncooloutline-towitnesstoday[.]info\ncooloutlineto-witnesstoday[.]info\ncooloutlinetowitness-today[.]info\n\n```\nWhen sorting the domains by length first, then alphabetically, the DDGA patterns usually\ngroup together very nicely and it is easy to spot the set of words that make up the dictionary\nused by the algorithm. Most importantly, none of these words correspond to any news\nevents for the day they are registered. These are just random “word salad” domains.\n\n## Domain Blooms\n\nDomain blooms start off similar to spikes. A word’s usage per day follows some baseline\nfrequency, then after some event occurs rapidly increases to an outlier level. But unlike a\nspike, after a few days the number of domains per day either continues to increase, or\nholds steady over a period of time. After a while the number of such domains registered per\nday gradually drops back to its baseline level, or potentially a new baseline level that\nremains steady.\n\nThe quintessential example of a domain bloom is the COVID-19 bloom described in detail\nat the beginning of this post.\n\n\n-----\n\nBlooms, especially those triggered by natural disasters are easy targets for threat actors. In\nthe early days of the COVID-19 pandemic, threat actors created hundreds of fraudulent\nfundraising and phishing domains pretending to be official domains for nonprofits and\nmunicipalities helping with the pandemic crisis.\n\n## Clustering Domain Blooms into Bouquets\n\nOne of the challenges during early COVID-19 was identifying other words that threat actors\nwere taking advantage of when registering related malicious domains. Security\nResearchers had to guess at different words and look at their bloom graphs to see if they\nfollowed the same trend as “covid”, but it was a guessing game at first until a more\nalgorithmic approach could be developed.\n\nA domain bloom is really just a time series histogram, or count of occurrences over time. In\ndata science this is called a vector, and for any given vector it is possible to search the\nvector space of all the known vectors to identify others that have very similar\ncharacteristics. In theory two blooms that start around the same time, have a similar shaped\npeak, and then end around the same time should be semantically related to each other.\n\nTo test this, a special type of machine learning algorithm called clustering was used which\ntries to group similar items together into clusters. To do this, bloom histogram vectors were\ngenerated for all words used in domain names registered during 2020. Then these bloom\nvectors were run through the clustering algorithm to generate groups of similar blooms.\n\nOnce the bloom clusters were generated, the cluster containing the bloom for “covid” was\nidentified and the 5 most similar bloom vectors were pulled out. The blooms for these words\nare shown below:\n\n\n-----\n\nNotice how not every bloom has the same magnitude as “covid”, but the general shape and\nduration are very similar.\n\nOther notable clusters identified during this analysis include this one around social\ndistancing:\n\nAnd this one around the Black Lives Matter movement:\n\n\n-----\n\n## Future Research\n\nNot every major event is going to be as large of a focus for threat actors like COVID-19\nwas. Further research needs to be done to better categorize different types of blooms and\nspikes, identify the defining characteristics behind them, and better understand the\nmotivations of the people who participated in registering these domains. Based on this\nlearning we can better classify malicious domains that are registered in response to\ndifferent events before they have the opportunity to become operational.\n\nFor an in depth analysis of some of the more notable domain spikes and blooms that\noccurred during 2020 take a look at The DomainTools Report: Spring 2021 Edition.\n\n[Download Now](https://www.domaintools.com/resources/domaintools-reports/domain-blooms-new-method-of-detecting-trending-bad-domains)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-05-13 - Domain Blooms- Identifying Domain Name Themes Targeted By Threat Actors.pdf"
    ],
    "report_names": [
        "2021-05-13 - Domain Blooms- Identifying Domain Name Themes Targeted By Threat Actors.pdf"
    ],
    "threat_actors": [
        {
            "id": "610a7295-3139-4f34-8cec-b3da40add480",
            "created_at": "2023-01-06T13:46:38.608142Z",
            "updated_at": "2025-03-27T02:00:02.87217Z",
            "deleted_at": null,
            "main_name": "Cobalt",
            "aliases": [
                "Cobalt Gang",
                "GOLD KINGSWOOD",
                "COBALT SPIDER",
                "G0080",
                "Mule Libra",
                "Cobalt Group"
            ],
            "source_name": "MISPGALAXY:Cobalt",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "aa73cd6a-868c-4ae4-a5b2-7cb2c5ad1e9d",
            "created_at": "2022-10-25T16:07:24.139848Z",
            "updated_at": "2025-03-27T02:02:10.120505Z",
            "deleted_at": null,
            "main_name": "Safe",
            "aliases": [],
            "source_name": "ETDA:Safe",
            "tools": [
                "DebugView",
                "LZ77",
                "OpenDoc",
                "SafeDisk",
                "TypeConfig",
                "UPXShell",
                "UsbDoc",
                "UsbExe"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535731,
    "ts_updated_at": 1743041369,
    "ts_creation_date": 1653705341,
    "ts_modification_date": 1653705341,
    "files": {
        "pdf": "https://archive.orkl.eu/c5b2430fd860f304db56103fa703fdb4c866d1ae.pdf",
        "text": "https://archive.orkl.eu/c5b2430fd860f304db56103fa703fdb4c866d1ae.txt",
        "img": "https://archive.orkl.eu/c5b2430fd860f304db56103fa703fdb4c866d1ae.jpg"
    }
}