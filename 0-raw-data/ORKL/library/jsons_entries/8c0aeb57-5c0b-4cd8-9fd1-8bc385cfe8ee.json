{
    "id": "8c0aeb57-5c0b-4cd8-9fd1-8bc385cfe8ee",
    "created_at": "2023-01-12T15:04:22.742234Z",
    "updated_at": "2025-03-27T02:14:05.248749Z",
    "deleted_at": null,
    "sha1_hash": "f8bbf26acfd11e3826b7aa555ae7044e693f1cb2",
    "title": "2019-11-01 - WIZARD SPIDER Adds New Features to Ryuk for Targeting Hosts on LAN",
    "authors": "",
    "file_creation_date": "2022-05-28T02:26:45Z",
    "file_modification_date": "2022-05-28T02:26:45Z",
    "file_size": 1099846,
    "plain_text": "# WIZARD SPIDER Adds New Features to Ryuk\n\n**[crowdstrike.com/blog/wizard-spider-adds-new-feature-to-ryuk-ransomware/](https://www.crowdstrike.com/blog/wizard-spider-adds-new-feature-to-ryuk-ransomware/)**\n\nNovember 1, 2019\n\n## WIZARD SPIDER Adds New Features to Ryuk for Targeting Hosts on LAN\n\nNovember 1, 2019\n\n[Alexander Hanel and Brett Stone-Gross](https://www.crowdstrike.com/blog/author/alexander-hanel-and-brett-stone-gross/) [Research & Threat Intel](https://www.crowdstrike.com/blog/category/threat-intel-research/)\n\n\nCrowdStrike Intelligence analyzed variants of ® _[Ryuk (a ransomware family distributed by](https://www.crowdstrike.com/blog/big-game-hunting-with-ryuk-another-lucrative-targeted-ransomware/)_\nWIZARD SPIDER) with new functionality for identifying and encrypting files on hosts in a\nlocal area network (LAN). These features target systems that have recently been placed in\na standby power state, as well as online systems on the LAN.\n\n## Magic Packet\n\nThe first new Ryuk feature attempts to wake LAN hosts that are in a standby power state by\n[sending them a Wake-on-LAN (WoL) magic packet. The affected machine must support](https://en.wikipedia.org/wiki/Wake-on-LAN#Magic_packet)\nWoL, and its network card must have the setting configured in the BIOS. To identify\nmachines on the LAN, Ryuk reads entries in the host Address Resolution Protocol (ARP)\ncache; in addition, for each address in the cache, it sends a WoL magic packet. The packet\nis sent over a User Datagram Protocol (UDP) socket with the socket option `SO_BROADCAST`\n\n\n-----\n\nusing destination port `7 . The WoL magic packet starts with` `FF FF FF FF FF FF,`\nfollowed by the target’s computer MAC address. An example WoL packet is highlighted in\nblue in Figure 1.\n\nFigure 1. Ryuk Wake-on-LAN Packet Example\n\nUDP packets observed being sent specifically to destination port `7 during a ransomware`\nincident may be an indication that Ryuk is present.\n\nThis Wake-On-LAN implementation is somewhat naive, because the default ARP cache\ntimeout is short-lived on modern versions of Windows. Thus, the number of systems that\nmay be impacted by this current implementation is likely to be limited, since only systems\nthat have recently been put to sleep would still have their MAC address present in a remote\nsystem’s ARP cache.\n\n## ARP Ping Scanner\n\nThe second Ryuk feature uses ARP ping scanning to identify hosts on the LAN. To identify\nthe proper subnet to scan, it checks each entry in the ARP cache to see whether it contains\nan IP address with the substrings “ 10.,” “ 172.16.,” or “ 192.168 .” in it. If an IP address\ncontains one of these strings, it starts sending ARP and PING requests to all IP addresses\nin the Class C network starting with that string value. For example, if the ARP cache entry\ncontained the IP address `192.168.240[.]57, it would start scanning at`\n```\n192.168.240[.]1 and increment the last octet by 1 until reaching the IP address\n192.168.240[.]254 . If a host responds, Ryuk attempts to mount it as a network drive,\n\n```\nusing Server Message Block (SMB), and encrypt its contents.\n\n\n-----\n\n## Conclusion\n\nBy attempting to wake systems and using ARP ping scanning combined with network drive\nmounting, WIZARD SPIDER is seeking to maximize the number of systems that can be\nimpacted by Ryuk’s file encryption. The Wake-on-LAN feature is a novel technique that\ndemonstrates WIZARD SPIDER’s continued focus on increasing the monetization of\n[infections via ransomware.](https://www.crowdstrike.com/epp-101/what-is-ransomware/)\n\nCrowdStrike Intelligence will continue to monitor any further development to Ryuk by\nWIZARD SPIDER. The CrowdStrike Falcon® endpoint protection platform detects and\nprevents against Ryuk. For Falcon endpoint customers, prevention settings should be set at\na minimum to the following:\n\nNext-Gen Antivirus: Cloud/Sensor Machine Learning: Set “Prevention” slider to\n“Moderate”\nMalware Protection: Execution Blocking: Toggle “Prevent Suspicious Processes” to\n“Enabled”\nAdd any hashes to your custom blacklist for added protection\n\nSHA256 HASH BUILD\nTIME\n\n74654957ba3c9f1ce8bb513954b9deea68a5a82217806977a1247fb342db109f 201910-09\n22:09:27\n\n7dc3fc208c41c946ac8238405fce25e04f0c2a7a9e1d2701986217bd2445487a 201910-10\n09:18:33\n\n**Additional Resources**\n\n_For more information on how to incorporate intelligence on dangerous threat actors_\n_[into your security strategy, please visit the Falcon X product page.](https://www.crowdstrike.com/endpoint-security-products/falcon-x-threat-intelligence/)_\n_Read the_ _[2020 Global Threat Report.](https://www.crowdstrike.com/resources/reports/2020-crowdstrike-global-threat-report/)_\n_Read the 2019 Falcon OverWatch Report:_ _“Observations From the Front Lines of_\n_Threat Hunting.”_\n_[Learn more about the CrowdStrike Falcon® Platform by visiting the product webpage.](https://www.crowdstrike.com/endpoint-security-products/falcon-platform/)_\n_[Test CrowdStrike next-gen AV for yourself. Start your free trial of Falcon Prevent™](https://go.crowdstrike.com/try-falcon-prevent.html)_\n_today._\n\n\n-----\n\nRelated Content\n\nWho is EMBER BEAR?\n\n\n-----\n\nA Tale of Two Cookies: How to Pwn2Own the Cisco RV340 Router\n\n\n-----\n\nPROPHET SPIDER Exploits Citrix ShareFile Remote Code Execution Vulnerability CVE 2021 22941 to\nDeliver Webshell\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2019/2019-11-01 - WIZARD SPIDER Adds New Features to Ryuk for Targeting Hosts on LAN.pdf"
    ],
    "report_names": [
        "2019-11-01 - WIZARD SPIDER Adds New Features to Ryuk for Targeting Hosts on LAN.pdf"
    ],
    "threat_actors": [
        {
            "id": "c28760b2-5ec6-42ad-852f-be00372a7ce4",
            "created_at": "2022-10-27T08:27:13.172734Z",
            "updated_at": "2025-03-27T02:00:55.511386Z",
            "deleted_at": null,
            "main_name": "Ember Bear",
            "aliases": [
                "Ember Bear",
                "UNC2589",
                "Bleeding Bear",
                "DEV-0586",
                "Cadet Blizzard",
                "Frozenvista",
                "UAC-0056"
            ],
            "source_name": "MITRE:Ember Bear",
            "tools": [
                "P.A.S. Webshell",
                "CrackMapExec",
                "ngrok",
                "WhisperGate",
                "Saint Bot",
                "PsExec",
                "Rclone",
                "Impacket",
                "OutSteel"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "056826cb-6e17-4954-a9b4-2cc8c6ae3cb8",
            "created_at": "2023-03-04T02:01:54.115678Z",
            "updated_at": "2025-03-27T02:00:03.125249Z",
            "deleted_at": null,
            "main_name": "Prophet Spider",
            "aliases": [
                "GOLD MELODY",
                "UNC961"
            ],
            "source_name": "MISPGALAXY:Prophet Spider",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "63061658-5810-4f01-9620-7eada7e9ae2e",
            "created_at": "2022-10-25T15:50:23.752974Z",
            "updated_at": "2025-03-27T02:00:55.538582Z",
            "deleted_at": null,
            "main_name": "Wizard Spider",
            "aliases": [
                "Wizard Spider",
                "UNC1878",
                "TEMP.MixMaster",
                "Grim Spider",
                "FIN12",
                "GOLD BLACKBURN",
                "ITG23",
                "Periwinkle Tempest",
                "DEV-0193"
            ],
            "source_name": "MITRE:Wizard Spider",
            "tools": [
                "TrickBot",
                "AdFind",
                "BITSAdmin",
                "Bazar",
                "LaZagne",
                "Nltest",
                "GrimAgent",
                "Dyre",
                "Ryuk",
                "Conti",
                "Emotet",
                "Rubeus",
                "Mimikatz",
                "Diavol",
                "PsExec",
                "Cobalt Strike"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "083d63b2-3eee-42a8-b1bd-54e657a229e8",
            "created_at": "2022-10-25T16:07:24.143338Z",
            "updated_at": "2025-03-27T02:02:10.12138Z",
            "deleted_at": null,
            "main_name": "SaintBear",
            "aliases": [
                "Ember Bear",
                "FROZENVISTA",
                "Lorec53",
                "Nascent Ursa",
                "Nodaria",
                "SaintBear",
                "Storm-0587",
                "TA471",
                "UAC-0056",
                "UNC2589"
            ],
            "source_name": "ETDA:SaintBear",
            "tools": [
                "Agentemis",
                "Cobalt Strike",
                "CobaltStrike",
                "Elephant Client",
                "Elephant Implant",
                "GraphSteel",
                "Graphiron",
                "GrimPlant",
                "OutSteel",
                "Saint Bot",
                "SaintBot",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "f6f91e1c-9202-4497-bf22-9cd5ef477600",
            "created_at": "2023-01-06T13:46:38.86765Z",
            "updated_at": "2025-03-27T02:00:02.938998Z",
            "deleted_at": null,
            "main_name": "WIZARD SPIDER",
            "aliases": [
                "FIN12",
                "UNC2053",
                "Pistachio Tempest",
                "TEMP.MixMaster",
                "GOLD BLACKBURN",
                "Periwinkle Tempest",
                "DEV-0193",
                "Storm-0193",
                "Trickbot LLC",
                "DEV-0237"
            ],
            "source_name": "MISPGALAXY:WIZARD SPIDER",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "eecf54a2-2deb-41e5-9857-fed94a53f858",
            "created_at": "2023-01-06T13:46:39.349959Z",
            "updated_at": "2025-03-27T02:00:03.057647Z",
            "deleted_at": null,
            "main_name": "SaintBear",
            "aliases": [
                "UAC-0056",
                "Nascent Ursa",
                "Nodaria",
                "FROZENVISTA",
                "Storm-0587",
                "Lorec53",
                "Lorec Bear",
                "UNC2589",
                "TA471",
                "DEV-0587",
                "Saint Bear",
                "EMBER BEAR",
                "Bleeding Bear"
            ],
            "source_name": "MISPGALAXY:SaintBear",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "e6a21528-2999-4e2e-aaf4-8b6af14e17f3",
            "created_at": "2022-10-25T16:07:24.422115Z",
            "updated_at": "2025-03-27T02:02:10.216817Z",
            "deleted_at": null,
            "main_name": "Wizard Spider",
            "aliases": [
                "DEV-0193",
                "Gold Blackburn",
                "Gold Ulrick",
                "Grim Spider",
                "ITG23",
                "Operation BazaFlix",
                "Periwinkle Tempest",
                "TEMP.MixMaster",
                "Wizard Spider"
            ],
            "source_name": "ETDA:Wizard Spider",
            "tools": [
                "AdFind",
                "Agentemis",
                "Anchor_DNS",
                "BEERBOT",
                "BazarBackdoor",
                "BazarCall",
                "BazarLoader",
                "Cobalt Strike",
                "CobaltStrike",
                "Conti",
                "Diavol",
                "Dyranges",
                "Dyre",
                "Dyreza",
                "Dyzap",
                "Gophe",
                "Invoke-SMBAutoBrute",
                "KEGTAP",
                "LaZagne",
                "LightBot",
                "PowerSploit",
                "PowerTrick",
                "PsExec",
                "Ryuk",
                "SessionGopher",
                "TSPY_TRICKLOAD",
                "Team9Backdoor",
                "The Trick",
                "TheTrick",
                "Totbrick",
                "TrickBot",
                "TrickLoader",
                "TrickMo",
                "Upatre",
                "bazaloader",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "bc119938-a79c-4e5f-9d4d-dc96835dfe2e",
            "created_at": "2024-06-04T02:03:07.799286Z",
            "updated_at": "2025-03-27T02:05:17.337094Z",
            "deleted_at": null,
            "main_name": "GOLD BLACKBURN",
            "aliases": [
                "Periwinkle Tempest ",
                "Wizard Spider ",
                "ITG23 "
            ],
            "source_name": "Secureworks:GOLD BLACKBURN",
            "tools": [
                " Buer Loader",
                " Dyre",
                " Team9",
                " TrickBot",
                "BazarLoader"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "47b52642-e5b8-4502-b714-b625002d86aa",
            "created_at": "2024-06-19T02:03:08.086579Z",
            "updated_at": "2025-03-27T02:05:17.385492Z",
            "deleted_at": null,
            "main_name": "GOLD MELODY",
            "aliases": [
                "UNC961",
                "PROPHET SPIDER"
            ],
            "source_name": "Secureworks:GOLD MELODY",
            "tools": [
                " 7-ZIP",
                " AUDITUNNEL",
                " BURP Suite",
                " GOTROJ",
                " JSP webshells",
                " Mimikatz",
                " Wget",
                "7-ZIP"
            ],
            "source_id": "Secureworks",
            "reports": null
        }
    ],
    "ts_created_at": 1673535862,
    "ts_updated_at": 1743041645,
    "ts_creation_date": 1653704805,
    "ts_modification_date": 1653704805,
    "files": {
        "pdf": "https://archive.orkl.eu/f8bbf26acfd11e3826b7aa555ae7044e693f1cb2.pdf",
        "text": "https://archive.orkl.eu/f8bbf26acfd11e3826b7aa555ae7044e693f1cb2.txt",
        "img": "https://archive.orkl.eu/f8bbf26acfd11e3826b7aa555ae7044e693f1cb2.jpg"
    }
}