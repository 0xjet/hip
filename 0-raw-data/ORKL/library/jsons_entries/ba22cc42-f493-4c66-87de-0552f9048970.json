{
    "id": "ba22cc42-f493-4c66-87de-0552f9048970",
    "created_at": "2023-01-12T15:03:34.913365Z",
    "updated_at": "2025-03-27T02:09:18.117781Z",
    "deleted_at": null,
    "sha1_hash": "cf94deb568d56184b3af08b60e5e32578b04c7dd",
    "title": "2022-03-31 - Suspected AsyncRAT Delivered via ISO Files Using HTML Smuggling Technique",
    "authors": "",
    "file_creation_date": "2022-05-29T00:53:32Z",
    "file_modification_date": "2022-05-29T00:53:32Z",
    "file_size": 953822,
    "plain_text": "# Suspected AsyncRAT Delivered via ISO Files Using HTML Smuggling Technique\n\n**[esentire.com/blog/suspected-asyncrat-delivered-via-iso-files-using-html-smuggling-technique](https://www.esentire.com/blog/suspected-asyncrat-delivered-via-iso-files-using-html-smuggling-technique)**\n\n[Adversaries don’t work 9-5 and neither do we. At eSentire, our 24/7 SOCs are staffed with](https://www.esentire.com/what-we-do/security-operations-center)\nElite Threat Hunters and Cyber Analysts who hunt, investigate, contain and respond to\nthreats within minutes.\n\nWe have discovered some of the most dangerous threats and nation state attacks in our\nspace – including the Kaseya MSP breach and the more_eggs malware.\n\nOur Security Operations Centers are supported with Threat Intelligence, Tactical Threat\nResponse and Advanced Threat Analytics driven by our Threat Response Unit – the TRU\nteam.\n\nIn TRU Positives, eSentire’s Threat Response Unit (TRU) provides a summary of a recent\nthreat investigation. We outline how we responded to the confirmed threat and what\nrecommendations we have going forward.\n\n**Here’s the latest from our TRU Team…**\n\n## What did we find?\n\n\n-----\n\nAn attempt to deliver malware using an HTML file that had an embedded disk image\nfile (.iso) containing VBS and PowerShell commands.\n[HTML Smuggling is a defense evasion technique where malicious code is embedded](https://attack.mitre.org/techniques/T1027/006)\nwithin HTML files and unknowingly extracted by a victim using their web browser.\nIn this recent incident, the final payload failed to download, and we were unable to\nretrieve a copy while analyzing this event. The activity described below aligns with\n[observations in January 2022 where AsyncRAT was delivered using HTML files](https://blog.morphisec.com/asyncrat-new-delivery-technique-new-threat-campaign)\ncontaining malicious VBS files within a disk image file (.iso). Furthermore, the\ncharacteristics involving file name patterns and PowerShell traits align closely with an\n[activity cluster labeled as Coral Crane.](https://redcanary.com/blog/intelligence-insights-february-2022/)\nThe event, identified in mid-March, involved the following stages:\n\n[1. The victim received an email containing “order_receipt.html”](https://www.virustotal.com/gui/file/5f2cc6fc3c08799154b5ba88f229d3d2f023064d29322e65c36161f72edc30f0/detection)\n2. The victim opened the HTML file using their web browser and was prompted to\n\ndownload a randomly named .iso file (figure 1)\n\n_Figure 1_\n\n_\"order_receipt.html\" opened in a web browser._\n\n\n-----\n\n3. The .iso file was mounted and opened in Windows file explorer and a Visual Basic file\n\nwas presented to the victim:\n\n_Figure 2 .iso retrieved from the HTML file is easily mounted by double-clicking the file._\n\n_Figure 3 De-Obfuscated VBS with PowerShell download cradle._\n[4. When opened by the victim, the VBS file was executed by Windows Script Host and a](https://en.wikipedia.org/wiki/Windows_Script_Host)\n\nPowerShell command attempted to download the next stage payload from\nhttps://www[.]asterglobal[.]com/.Fainl.txt.\n\n_Figure 4 Endpoint view of the obfuscated PowerShell download cradle._\n\n## How did we find it?\n\n\n-----\n\nOur Machine Learning PowerShell classifier detected malicious code execution\nresulting from the victim manually executing the malicious VBS file.\n\n## What did we do?\n\nOur [24/7 SOC cyber analysts alerted the customer and responded on the client’s](https://www.esentire.com/what-we-do/security-operations-center)\nbehalf by successfully isolating the host.\n\n## What can you learn from this TRU positive?\n\nThe HTML smuggling technique makes detection through content filters difficult since\npayloads are embedded within a local HTML file and not retrieved over the network.\nFurther complicating detection is the use of an .iso file within the HTML to hide the\npayload until mounted by the victim. Figure 5 shows a visual representation of this file\nstructure.\n\nNote that only the email and final payload are transmitted over the network layer.\n\n_Figure_\n\n_5 Visual representation of nested files._\nOur observations of adversaries using disk image files for code delivery is increasingly\n[common. In February TRU identified an IcedID campaign delivered using .iso images.](https://www.esentire.com/blog/icedid-to-cobalt-strike-in-under-20-minutes)\nMalware embedded inside of .iso files may evade security controls and is a known\ntechnique for bypassing the Mark-of-the-Web trust control.\nEarly detection of this evasive malware delivery method will be crucial to limiting\nimpact.\n\n## Recommendations from our Threat Response Unit (TRU) Team:\n\n\n-----\n\n[Display file extensions for known file types and consider showing hidden files to users](https://www.bleepingcomputer.com/news/microsoft/hiding-windows-file-extensions-is-a-security-risk-enable-now/)\nby default.\nConduct [Phishing and Security Awareness Training (PSAT) on a regular basis with](https://www.esentire.com/what-we-do/managed-vulnerability-and-risk/technical-testing/security-awareness-training-managed-phishing-training)\nyour employees, placing a special emphasis on spotting business email compromise\n(BEC) attacks. Warn users about the threat posed by .html and image files (.iso)\nattached or hyperlinked in emails.\nCreate new “Open With” parameters for script files (.js, .jse, .hta, .vbs) so they open\nwith notepad.exe. This setting is found in the Group Policy Management Console under\n**User Configuration > Preferences > Control Panel Settings > Folder Options.**\n\nBy default, these script files are executed automatically using Windows Script\nHost (wscript.exe) or Microsoft HTML Application host (mshta.exe) when doubleclicked by a user.\nSince .iso files are mounted as a drive when double-clicked by users by default,\n[consider deregistering this file extension in Windows File Explorer.](https://insights.sei.cmu.edu/blog/the-dangers-of-vhd-and-vhdx-files/)\n\n## Ask Yourself\n\n1. What level of visibility do you have across your network, endpoint, and overall\n\nenvironment to detect malicious behavior at scale?\n2. What tools are you employing for email filtering and how is that activity monitored?\n3. What level of managed endpoint support do you have in place?\n4. Are you monitoring your endpoints 24/7 and what degree of control do you have to\n\ninitiate a kill switch when required?\n\n## Indicators of Compromise\n\ndca4d47ed0714d3ab9e4ef17192f7f1d “Order_Receipt.html”\n\nhttps://www[.]asterglobal[.]com/.Fainl.txt Location for payload retrieved by PowerShell\ncommand\n\nIf you’re not currently engaged with a Managed Detection and Response provider, we highly\nrecommend you partner with us for security services in order to disrupt threats before they\nimpact your business.\n\n[Want to learn more? Connect with an eSentire Security Specialist.](https://www.esentire.com/get-started)\n\n|dca4d47ed0714d3ab9e4ef17192f7f1d|“Order_Receipt.html”|\n|---|---|\n|https://www[.]asterglobal[.]com/.Fainl.txt|Location for payload retrieved by PowerShell command|\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-03-31 - Suspected AsyncRAT Delivered via ISO Files Using HTML Smuggling Technique.pdf"
    ],
    "report_names": [
        "2022-03-31 - Suspected AsyncRAT Delivered via ISO Files Using HTML Smuggling Technique.pdf"
    ],
    "threat_actors": [
        {
            "id": "610a7295-3139-4f34-8cec-b3da40add480",
            "created_at": "2023-01-06T13:46:38.608142Z",
            "updated_at": "2025-03-27T02:00:02.87217Z",
            "deleted_at": null,
            "main_name": "Cobalt",
            "aliases": [
                "Cobalt Gang",
                "GOLD KINGSWOOD",
                "COBALT SPIDER",
                "G0080",
                "Mule Libra",
                "Cobalt Group"
            ],
            "source_name": "MISPGALAXY:Cobalt",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673535814,
    "ts_updated_at": 1743041358,
    "ts_creation_date": 1653785612,
    "ts_modification_date": 1653785612,
    "files": {
        "pdf": "https://archive.orkl.eu/cf94deb568d56184b3af08b60e5e32578b04c7dd.pdf",
        "text": "https://archive.orkl.eu/cf94deb568d56184b3af08b60e5e32578b04c7dd.txt",
        "img": "https://archive.orkl.eu/cf94deb568d56184b3af08b60e5e32578b04c7dd.jpg"
    }
}