{
    "id": "5f0f5ba8-5a74-406c-86bb-744da9830b3d",
    "created_at": "2023-01-12T15:10:42.107797Z",
    "updated_at": "2025-03-27T02:05:59.941786Z",
    "deleted_at": null,
    "sha1_hash": "f30981df0be35c537b06becaa74adf5c2e15f6b9",
    "title": "2022-08-16 - FluBot Android Malware Analysis",
    "authors": "",
    "file_creation_date": "2022-09-01T10:07:30Z",
    "file_modification_date": "2022-09-01T10:07:30Z",
    "file_size": 2082333,
    "plain_text": "# FluBot Android Zararlı Yazılım Analizi\n\n**infinitumit.com.tr/flubot-zararlisi/**\n\ninfinitumit 16 Ağustos 2022\n\n## FluBot Analiz Özeti\n\nFluBot zararlısı Android cihazları hedefleyen ve sahte SMS’ler aracılığıyla kurbanlara enjekte\nedilen bir zararlı yazılımdır. Oltalama (phishing) yöntemleri kullanılarak hazırlanan sahte\nSMS FluBot’un indirilmesini sağlayan bağlantıyı içerir. Bu bağlantıya tıklayan kurbanlar .apk\nuzantılı bir dosya indirirler. Kurulum işleminden sonra FluBot zararlısı komuta kontrol (C2)\nsunucusu ile iletişim kurarak cihazı uzaktan yönlendirir.\n\nGerçekleştirilen analizler sonucunda FluBot zararlısının kurban cihaz üzerinden SMS\ngönderme, gelen kısa mesajları okuma, arka plan uygulamalarını kapatma ve telefon\nrehberine erişme gibi yeteneklere sahip olduğu tespit edilmiştir.\n\nKurulum sonrası zararlı gerekli izinleri kurbandan aldıktan sonra ilgili oltalama senaryosu\ngereği kurbanı bir forma yönlendirir. Bu sayfada kurbandan doğum tarihi, ad-soyad, kredi\nkartı bilgisi ve telefon numarası gibi hassas bilgiler temin edilir. Ardından temin edilen bilgiler\n\n\n-----\n\nFluBot aracılığıyla saldırgana ait komuta kontrol sunucusuna gönderilir.\n\nSahte DHL SMS bilgilendirme mesajı (Phishing)\n\nBaşka bir örnekte ise FluBot’un sahe SMS ile kurban sisteme yüklenmesi işlemi göze\nçarpıyor. Hedef kullanıcı SMS ile gelen linke tıkladıktan sonra gelen web sayfası üzerinde,\nzararlı yazılımı indirmesi için hazırlanan sahte ve gerçekçi bir sayfa ile karşılaşıyor. (Örnek\noltalama sayfasına ilişkin ekran görüntüsü aşağıda şekilde yer almaktadır)\n\n\n-----\n\n-----\n\n## Bulaşma Sıklığı ve Hedef Ülkeler\n\nFluBot zararlısı yoğunluklu olarak ile Avrupa ülkelerini hedef seçmiştir. COVID sonrası artan\npaket dağıtım hizmetlerini phishing aracı olarak kötüye kullanmıştır böylece kısa bir zaman\niçinde çok hızlı bir yayılmaya sahip olmuştur.\n\n## FluBot Teknik Analizi\n\nFluBot zararlısı indirildikten sonra cihaz içinde “full access” yetkisi verilmesi için kullanıcı\nonayı istemektedir. Onay, hedef kullanıcı tarafından verildikten sonra hedef kullanıcı\nuygulamayı kapatsa bile zararlı yazılım arka planda çalışmaya devam etmektedir.\n\nArka planda çalışan “com.eg.android.AlipayGphone” (FluBot) zararlısına ait izin listesi şu\nşekildedir:\n\n\n-----\n\nandroid.permission.INTERNET\nandroid.permission.READ_CONTACTS\nandroid.permission.WRITE_SMS\nandroid.permission.READ_SMS\nandroid.permission.SEND_SMS\nandroid.permission.RECEIVE_SMS\nandroid.permission.READ_PHONE_STATE\nandroid.permission.QUERY_ALL_PACKAGES\nandroid.permission.WAKE_LOCK\nandroid.permission.FOREGROUND_SERVICE\nandroid.permission.REQUEST_IGNORE_BATTERY_OPTIMIZATIONS\nandroid.permission.CALL_PHONE\nandroid.permission.REQUEST_DELETE_PACKAGES\nandroid.permission.KILL_BACKGROUND_PROCESSES\nandroid.permission.ACCESS_NETWORK_STATE\n\nYukarıdaki izinlerle erişen, kötü amaçlı yazılım aşağıdaki eylemleri gerçekleştirebilir hale\ngelmektedir.\n\n- İnternet erişimi\n\n- SMS Okuma / Gönderme\n\n- Telefon rehberini okumak\n\n- Çağrı Yapma\n\n- Cihaz içinden uygulama silme\n\n- Erişilebilirlik hizmetini kullanma yeteneği\n\n- Cihaz bildirimlerini okuma\n\nHedef kullanıcıya ait Android cihaz artık sürekli olarak saldırganlara ait komuta kontrol\nsunucusu ile iletişim halindendir. Analizlerimiz sonucunda bu iletişimin saldırganın isteğine\ngöre SOCKS Proxy üzerinden devam edebildiği tespit edilmiştir.\n\n\n-----\n\n## 3.1- String Obfuscation (Karmaşıklaştırma)\n\nFluBot zararlısı incelemeyi zorlaştırmak ve anti virüs yazılımlarını bypass etmek (atlatmak)\niçin açık kaynak kodlu olan Paranoid isimli String obfuscator yazılımını kullanır böylece\nzararlı yazılıma çalışma aşamasında String verilerini gizleme özelliği kazandırılır.\n\nObfuscate edilen String veriler:\n\n- BotId\n\n- BrowserActivity\n\n\n-----\n\n- CardActivity\n\n- ComposeSmsActivity\n\n- ContactItem\n\n- DGA\n\n- ForegroundService\n\n- HttpCom\n\n- IntentStarter\n\n- LangTxt\n\n- MainActivity\n\n- MyAccessibilityService\n\n- MyNotificationListener\n\n- PanelReq\n\n- SmsReceiver\n\n- Spammer\n\n- Utils\n\n- SocksClient\n\n- PanelReq\n\n\n-----\n\n## 3.2 – String De-obfuscate\n\nFluBot zararlısına ait String veriler saldırganlar tarafından gizlenir, analiz sonuçlarının\ndoğrulu için Obfuscated olan String verilerim De-obfuscate edilmesi gerekmektedir. Bu işlem\niçin açık kaynak kodlu olan bir Java yazılımından yararlanılmıştır.\n\nJava yazılımı çalıştırıldığında chunks37 dizisi içerisinde bulunan veri matematiksel bir\nfonksiyon ile anlaşılır String veriye dönüştürülür. Sağ kısımda görüldüğü gibi çıktı olarak\nüretilen veri içerisinde farklı dillere ait phishing aşamasında kullanılan String veriler\nmevcuttur. (Card Number, CVV, Owner,Year vb.)\n\n\n-----\n\n## 3.3 – Command And Control (Komuta Kontrol)\n\nFluBot zararlısına ait en yeni versiyon 4.0 olarak ortaya çıkmıştır. FluBot hedef Android\ncihaza girdikten sonra saldırgan ile bağlantı kurmak için Domain Generation Algorithm\n**(DGA) isimli bir algoritma yardımı ile random sayı ve harflerden oluşan bir domain**\noluşturmakta ve böylece saldırganlara ait komuta kontrol sunucuları bot yazılımlardan\ngizlenebilmektedir. Bağlantı özellikle 4.0 versiyonunda DNS veya DNS over HTTPS şeklinde\ngerçekleşmektedir. Böylece zararlı yazılım hedef cihaza bağlantı istek paketleri gönderdiği\nzaman güvenlik duvarı, EDR veya Anti Virüs sistemlerinden kaçınmaktadır.\n\n2021-01-22 tarihinde başlayan yükseliş 4.0 versiyonu ile gerçekleşmiştir.\n\nGoogle DNS özelliği saldırganlar tarafından kötüye kullanılmış böylece Google DNS tünel\nolarak kullanılıp saldırgana ait Command and Control sunucularına DNS üzerinden\nbağlantı istekleri yapılmaktadır. HTTP isteklerine ilişkin ekran görüntüsü aşağıda yer\nalmaktadır.\n\n\n-----\n\nDGA ile oluşturulan Command And Control sunucuları:\n\n\n-----\n\nFluBot 4.0 versiyona ait **poll.php üzerinden yapılan bağlantı isteğini gerçekleştiren**\nfonksiyon, saldırgan C2 sunucusu üzerinden (PING,LOG,SMS_RATE,GET_SMS vb.)\nkomutlarını uzaktan çalıştırabilmektedir.\n\nAnalizlerimiz sonucunda ortaya çıkan, FluBot zararlısının hedef cihaza uzaktan erişmek için\nDNS over HTTPS bağlantısını sağlamak ile görevli decompile edilmiş fonksiyon aşşağıda yer\nalmaktadır.\n\n\n-----\n\nBu saldırı yöntemi özellikle İngiltere ve Amerika da bulunan hedefler için seçilmiştir. En\nönemli fark ise FluBot 4.0 zararlısına ait farklı bir örnekte saldırganların bağlantı almak için\nGoogle DNS yerine Cloudflare DNS’i seçmiş olmalıdır.\n\nFluBot zararlısının bir diğer özelliği cep telefonu numaralarında bulunan ülke bazlı kodları\nkullanarak o ülkeye ait spesifik saldırılar gerçekleştirmektir. Phishing saldırısı sırasında o\nülkede bulunan kargo servisleri ve konuşulan dil saldırganlar tarafından dikkate alınmakta ve\nbuna uygun bir ara yüz seçilmektedir.\n\n\n-----\n\nDecompile edilen FluBot görselinde görüldüğü gibi bu örnekte Rusya’da bulunan hedefleri\nseçmiştir.\n\nHedef kullanıcıdan kredi kartı numarası, CVV, cihaz bilgisi gibi bilgileri çalmaktadır.\n\n\n-----\n\nPhishing yöntemi ile kandırılan hedef kullanıcı bu bilgileri FluBot zararlısı içinde bulunan form\narayüzüne girdikten sonra “GetCredential_A05” fonksiyonu ile String veriler saldırganlara\niletilmektedir.\n\nFluBot zararlısı tarafından hedef kullanıcıdan istenilen verilere ilişkin form (Phishing formu)\naşağıdaki görselde yer almaktadır.\n\n\n-----\n\n## FluBot 3.7 Versiyonuna Ait HTTP Trafik Analizi\n\nHTTP bağlantısını Burp Suite Proxy ile yakalamak için Frida kullanılarak zararlı yazılıma\nJavaScript kodu enjekte edilir bu sayede bağlantı yakalanabilmekte ve Android SSL Pinning\nbypass edilmektedir. Bağlantı incelendiği zaman poll.php üzerinden base64 ile encode\nedilmiş String veriler ile hedef cihazdan bağlantı isteklerinin gönderildiği göze çarpmaktadır.\nPOST ve GET istekleri ile saldırganlar anlık olarak kurban cihaz ile haberleşmektedir.\n\n## 4- MITRE ATT&CK Teknik ve Taktikleri (Android Cihaz İçin)\n\n**Tactic** **Technique ID** **Technique Name**\n\n\n-----\n\nDefense Evasion [T1418](https://attack.mitre.org/techniques/T1418/) [T1406](https://attack.mitre.org/techniques/T1406/) 1. Application Discovery\n2. Obfuscated Files or Information\n\n\nCredential\naccess\n\n\n[T1409](https://attack.mitre.org/techniques/T1409/) 1.Access Stored Application Data\n\n\nDiscovery [T1421](https://attack.mitre.org/techniques/T1421) [T1422](https://attack.mitre.org/techniques/T1422/)\n\n[T1430](https://attack.mitre.org/techniques/T1430/) [T1418](https://attack.mitre.org/techniques/T1418/) [T1426](https://attack.mitre.org/techniques/T1426/)\n\n\n1.System Network Connections Discovery\n2. System Network Configuration Discovery\n\n3. Location Tracking\n\n4. Application Discovery\n\n5. System Information Discovery\n\n\nCollection [T1432](https://attack.mitre.org/techniques/T1432/) [T1430](https://attack.mitre.org/techniques/T1430/) [T1507](https://attack.mitre.org/techniques/T1507/) [T1409](https://attack.mitre.org/techniques/T1409/) 1. Access Contact List\n2. Location Tracking\n\n3. Network Information Discovery\n\n4. Access Stored Application Data\n\n\nCommand and\nControl\n\n\n[T1573](https://attack.mitre.org/techniques/T1573/) [T1071](https://attack.mitre.org/techniques/T1071/) [T1571](https://attack.mitre.org/techniques/T1571/) [T1219](https://attack.mitre.org/techniques/T1219/) 1. Encrypted Channel\n2. Application Layer Protocol\n\n3. Non-standard Port\n\n4. Remote Access Software\n\n\nImpact [T1447](https://attack.mitre.org/techniques/T1447/) [T1448](https://attack.mitre.org/techniques/T1448/) 1. Delete Device Data\n2. Carrier Billing Fraud\n\n## 5 – IOC Verisi\n\n**FluBot v3.7**\n\n**Phishing Correos Hash Verileri**\n\n446833e3f8b04d4c3c2d2288e456328266524e396adbfeba3769d00727481e80\n\nbb85cd885fad625bcd2899577582bad17e0d1f010f687fc09cdeb8fe9cc6d3e1\n\n8c14d5bc5175c42c8dd65601b4964953f8179cfe5e627e5c952b6afd5ce7d39d\n\n**Phishing Fedex Hash Verileri**\n\n\n-----\n\na601164199bbf14c5adf4d6a6d6c6de20f2ab35ec7301588bceb4ee7bb7d1fdc\n\nf0fa95c3b022fb4fee1c2328ffbc2a9567269e5826b221d813349ebf980b34da\n\n07ba6893c4ffc95638d4d1152f7c5b03aca4970474a95bf50942c619aa4382ae\n\nca5ba6098a2a5b49c82b7351920966009a99444da4d6f6e5a6649e5e2aeb3ff8\n\n8be8576c742f31d690d449ab317b8fb562d03bc7c9dc33fa5abf09099b32d7a0\n\n**Phishing DHL Hash Verileri**\n\n54ecabbff30b05a6a97531f7dec837891ce49ae89878eaf38714c1874f5f1d15\n\nc3838f9544e613917068f1b2e22ab647fd5a60701e1045b713767a92cf79f983\n\nab29813b1da1da48b4452c849eedc35b6c52044946d39392530573c540916f74\n\n**FluBot v4.0**\n\n**Phishing DHL Hash Verileri**\n\n3a4bdcb1071e8c29c62778101b7ae8746f3ee57cb1588e84d7ee1991964703e6\n\n22025590bbb4d3a30658fea45a936b6a346479c83d1c35f85521a1ac564342a0\n\n774acbfbedd2a37e636f6251af84a7abb2e64c2db9d6de5ce0fec4121064ea49\n\n3bf82acb8d511bfef3e083b73136824aab3612b516f150d916fe351b7e5bc9d3\n\n9b9b67a2b9ec5a15044430a9f5d9ce6a7f524e1feed186a96309256df686cfdd\n\n8bb8b1a1dc1487db610700f6b59ea4ab44ddc2f52e0eca06f8d1da663b312b58\n\n\n-----",
    "language": "TR",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-08-16 - FluBot Android Malware Analysis.pdf"
    ],
    "report_names": [
        "2022-08-16 - FluBot Android Malware Analysis.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673536242,
    "ts_updated_at": 1743041159,
    "ts_creation_date": 1662026850,
    "ts_modification_date": 1662026850,
    "files": {
        "pdf": "https://archive.orkl.eu/f30981df0be35c537b06becaa74adf5c2e15f6b9.pdf",
        "text": "https://archive.orkl.eu/f30981df0be35c537b06becaa74adf5c2e15f6b9.txt",
        "img": "https://archive.orkl.eu/f30981df0be35c537b06becaa74adf5c2e15f6b9.jpg"
    }
}