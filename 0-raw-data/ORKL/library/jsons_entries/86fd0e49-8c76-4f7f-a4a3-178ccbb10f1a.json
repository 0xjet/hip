{
    "id": "86fd0e49-8c76-4f7f-a4a3-178ccbb10f1a",
    "created_at": "2023-01-12T15:01:53.964848Z",
    "updated_at": "2025-03-27T02:16:20.663425Z",
    "deleted_at": null,
    "sha1_hash": "e5d0ca2b19a5e8f47c177cb120cee449fd03fe98",
    "title": "2019-04-19 - TDL (Turla Driver Loader) Repository",
    "authors": "",
    "file_creation_date": "2022-05-28T02:37:27Z",
    "file_modification_date": "2022-05-28T02:37:27Z",
    "file_size": 126252,
    "plain_text": "# Driver loader for bypassing Windows x64 Driver Signature Enforcement\n\n**github.com/hfiref0x/TDL**\n\nhfiref0x\n\n## TDL (Turla Driver Loader)\n\nFor more info see\n\nDefeating x64 Driver Signature Enforcement\n[http://www.kernelmode.info/forum/viewtopic.php?f=11&t=3322](http://www.kernelmode.info/forum/viewtopic.php?f=11&t=3322)\nWinNT/Turla [http://www.kernelmode.info/forum/viewtopic.php?f=16&t=3193](http://www.kernelmode.info/forum/viewtopic.php?f=16&t=3193)\n\n## System Requirements and limitations\n\nx64 Windows 7/8/8.1/10.\nTDL designed only for x64 Windows, Vista not listed as supported because it is\nobsolete.\nAdministrative privilege is required.\nLoaded drivers MUST BE specially designed to run as \"driverless\".\nNo SEH support for target drivers.\nNo driver unloading.\nOnly ntoskrnl import resolved, everything else is up to you.\nDummy driver examples provided.\n\n\n-----\n\nYou use it at your own risk. Some lazy AV may flag this loader as malware.\n\n## Differences between DSEFix and TDL\n\nWhile both DSEFix and TDL uses advantage of driver exploit they completely different on\nway of it use.\n\nDSEFix manipulate kernel variable called g_CiEnabled (Vista/7, ntoskrnl.exe) and/or\ng_CiOptions (8+. CI.DLL). Main advantage of DSEFix is it simplicity - you turn DSE off load your driver (or patched one) and nothing else required. Main disadvantage of\nDSEFix is that on the modern version of Windows (8+) g_CiOptions variable is subject\nof PatchGuard (KPP) protection, which mean DSEFix is a potential BSOD-generator.\nTDL does not patch any kernel variables, which makes it friendly to PatchGuard. It\nuses small shellcode which maps your driver to kernel mode without involving Windows\nloader (and as result without triggering any parts of DSE) and executes it. This is main\nadvantage of TDL - non invasive bypass of DSE. There are many disadvantages\nhowever - the first and main -> your driver MUST BE specially created to run as\n\"driverless\" which mean you will be unable to load any driver but only specially\ndesigned. Your driver will exist in kernel mode as executable code buffer, it won't be\nlinked to PsLoadedModuleList, there will be other limitations. However this code will\nwork at kernel mode and user mode application will be able communicate with it. You\ncan load multiple drivers, of course if they are not conflict with each other.\n\n## How it work\n\nIt uses WinNT/Turla VirtualBox kernel mode exploit technique to write code to the kernel\nmemory and after execute this code. TDL uses custom bootstrap shellcode to map your\nspecially designed driver and call it entry point (DriverEntry), note that DriverEntry\nparameters will be invalid and must not be used. Examples of specially designed drivers\navailable as DummyDrv and DummyDrv2. Your DriverEntry will run at IRQL\nPASSIVE_LEVEL up to Windows 10 RS1. Starting from Windows 10 RS2 your DriverEntry\ncode runs on IRQL DISPATCH_LEVEL.\n\n## Build\n\nTDL comes with full source code. In order to build from source you need Microsoft Visual\nStudio 2015 U1 and later versions. For driver builds you need Microsoft Windows Driver Kit\n8.1 and/or above.\n\n## Instructions\n\n\n-----\n\nSelect Platform ToolSet first for project in solution you want to build (Project>Properties->General):\n\nv120 for Visual Studio 2013;\nv140 for Visual Studio 2015;\nv141 for Visual Studio 2017.\nFor v140 and above set Target Platform Version (Project->Properties->General):\n\nIf v140 then select 8.1 (Note that Windows 8.1 SDK must be installed);\nIf v141 then select 10.0.17763.0 (Note that Windows 10.0.17763 SDK must be\ninstalled).\n\nRemove linker option /NOCOFFGRPINFO where it unsupported/unavailable.\n\n## Deprecation\n\nTDL based on old Oracle VirtualBox driver which was created in 2008. This driver wasn't\ndesigned to be compatible with newest Windows operation system versions and may work\nincorrectly. Because TDL entirely based on this exact VirtualBox driver version LPE it is not\nwise to use it on newest version of Windows. Consider this repository as\ndepricated/abandonware. The only possible updates can be related only to TDL loader itself.\n\n## Authors\n\n(c) 2016 - 2019 TDL Project\n\n## Credits\n\nR136a1\nN. Rin\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2019/2019-04-19 - TDL (Turla Driver Loader) Repository.pdf"
    ],
    "report_names": [
        "2019-04-19 - TDL (Turla Driver Loader) Repository.pdf"
    ],
    "threat_actors": [
        {
            "id": "a97cf06d-c2e2-4771-99a2-c9dee0d6a0ac",
            "created_at": "2022-10-25T16:07:24.349252Z",
            "updated_at": "2025-03-27T02:02:10.184406Z",
            "deleted_at": null,
            "main_name": "Turla",
            "aliases": [
                "ATK 13",
                "Belugasturgeon",
                "Blue Python",
                "CTG-8875",
                "Group 88",
                "ITG12",
                "Iron Hunter",
                "Krypton",
                "Makersmark",
                "Operation Epic Turla",
                "Operation Moonlight Maze",
                "Operation Penguin Turla",
                "Operation Satellite Turla",
                "Operation Skipper Turla",
                "Operation Turla Mosquito",
                "Operation WITCHCOVEN",
                "Pacifier APT",
                "Pensive Ursa",
                "Popeye",
                "SIG15",
                "SIG2",
                "SIG23",
                "Secret Blizzard",
                "TAG-0530",
                "Turla",
                "UNC4210",
                "Venomous Bear",
                "Waterbug"
            ],
            "source_name": "ETDA:Turla",
            "tools": [
                "ASPXSpy",
                "ASPXTool",
                "ATI-Agent",
                "AdobeARM",
                "Agent.BTZ",
                "Agent.DNE",
                "BigBoss",
                "COMpfun",
                "Chinch",
                "Cloud Duke",
                "CloudDuke",
                "CloudLook",
                "Cobra Carbon System",
                "ComRAT",
                "DoublePulsar",
                "EmPyre",
                "EmpireProject",
                "Epic Turla",
                "EternalBlue",
                "EternalRomance",
                "GoldenSky",
                "Group Policy Results Tool",
                "HTML5 Encoding",
                "HyperStack",
                "IcedCoffee",
                "IronNetInjector",
                "KSL0T",
                "Kapushka",
                "Kazuar",
                "KopiLuwak",
                "Kotel",
                "LOLBAS",
                "LOLBins",
                "LightNeuron",
                "Living off the Land",
                "Maintools.js",
                "Metasploit",
                "Meterpreter",
                "MiamiBeach",
                "Mimikatz",
                "MiniDionis",
                "Minit",
                "NBTscan",
                "NETTRANS",
                "NETVulture",
                "Neptun",
                "NetFlash",
                "NewPass",
                "Outlook Backdoor",
                "Penquin Turla",
                "Pfinet",
                "PowerShell Empire",
                "PowerShellRunner",
                "PowerShellRunner-based RPC backdoor",
                "PowerStallion",
                "PsExec",
                "PyFlash",
                "QUIETCANARY",
                "Reductor RAT",
                "RocketMan",
                "SMBTouch",
                "SScan",
                "Satellite Turla",
                "SilentMoon",
                "Sun rootkit",
                "TTNG",
                "TadjMakhal",
                "Tavdig",
                "TinyTurla",
                "TinyTurla Next Generation",
                "TinyTurla-NG",
                "Topinambour",
                "Tunnus",
                "Turla",
                "Turla SilentMoon",
                "TurlaChopper",
                "Uroburos",
                "Urouros",
                "WCE",
                "WITCHCOVEN",
                "WhiteAtlas",
                "WhiteBear",
                "Windows Credential Editor",
                "Windows Credentials Editor",
                "Wipbot",
                "WorldCupSec",
                "XTRANS",
                "certutil",
                "certutil.exe",
                "gpresult",
                "nbtscan",
                "nbtstat",
                "pwdump"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "8aaa5515-92dd-448d-bb20-3a253f4f8854",
            "created_at": "2024-06-19T02:03:08.147099Z",
            "updated_at": "2025-03-27T02:05:17.408118Z",
            "deleted_at": null,
            "main_name": "IRON HUNTER",
            "aliases": [
                "Belugasturgeon ",
                "Blue Python ",
                "CTG-8875 ",
                "ITG12 ",
                "KRYPTON ",
                "MAKERSMARK ",
                "Pensive Ursa ",
                "Secret Blizzard ",
                "Turla",
                "UAC-0003 ",
                "UAC-0024 ",
                "UNC4210 ",
                "Venomous Bear ",
                "Waterbug ",
                "ATK13 "
            ],
            "source_name": "Secureworks:IRON HUNTER",
            "tools": [
                " ComRAT",
                " Kazuar",
                " KopiLuwak",
                " LightNeuron",
                " Mosquito",
                " Nautilus",
                " Neuron",
                " Penquin",
                " PoisonFrog",
                " PyFlash",
                " Skipper",
                " Snake",
                " Tavdig",
                " TinyTurla",
                " Tunnus",
                "Carbon-DLL"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "a97fee0d-af4b-4661-ae17-858925438fc4",
            "created_at": "2023-01-06T13:46:38.396415Z",
            "updated_at": "2025-03-27T02:00:02.823045Z",
            "deleted_at": null,
            "main_name": "Turla",
            "aliases": [
                "Uroburos",
                "Hippo Team",
                "Pacifier APT",
                "MAKERSMARK",
                "ATK13",
                "UAC-0003",
                "IRON HUNTER",
                "Waterbug",
                "TAG_0530",
                "KRYPTON",
                "Popeye",
                "SIG23",
                "UAC-0144",
                "G0010",
                "Blue Python",
                "VENOMOUS Bear",
                "Group 88",
                "Pfinet",
                "ITG12",
                "UNC4210",
                "Secret Blizzard",
                "UAC-0024"
            ],
            "source_name": "MISPGALAXY:Turla",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "d11c89bb-1640-45fa-8322-6f4e4053d7f3",
            "created_at": "2022-10-25T15:50:23.509601Z",
            "updated_at": "2025-03-27T02:00:55.487991Z",
            "deleted_at": null,
            "main_name": "Turla",
            "aliases": [
                "Turla",
                "IRON HUNTER",
                "Group 88",
                "Waterbug",
                "WhiteBear",
                "Krypton",
                "Venomous Bear",
                "Secret Blizzard",
                "BELUGASTURGEON"
            ],
            "source_name": "MITRE:Turla",
            "tools": [
                "PsExec",
                "nbtstat",
                "ComRAT",
                "netstat",
                "certutil",
                "KOPILUWAK",
                "IronNetInjector",
                "LunarWeb",
                "Arp",
                "Uroburos",
                "PowerStallion",
                "Kazuar",
                "Systeminfo",
                "LightNeuron",
                "Mimikatz",
                "Tasklist",
                "LunarMail",
                "HyperStack",
                "NBTscan",
                "TinyTurla",
                "Penquin",
                "LunarLoader"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1673535713,
    "ts_updated_at": 1743041780,
    "ts_creation_date": 1653705447,
    "ts_modification_date": 1653705447,
    "files": {
        "pdf": "https://archive.orkl.eu/e5d0ca2b19a5e8f47c177cb120cee449fd03fe98.pdf",
        "text": "https://archive.orkl.eu/e5d0ca2b19a5e8f47c177cb120cee449fd03fe98.txt",
        "img": "https://archive.orkl.eu/e5d0ca2b19a5e8f47c177cb120cee449fd03fe98.jpg"
    }
}