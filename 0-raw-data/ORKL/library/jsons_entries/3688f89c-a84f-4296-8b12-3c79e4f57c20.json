{
    "id": "3688f89c-a84f-4296-8b12-3c79e4f57c20",
    "created_at": "2023-01-12T15:10:50.922337Z",
    "updated_at": "2025-03-27T02:15:06.251997Z",
    "deleted_at": null,
    "sha1_hash": "a42ff412daf020e3652201b3a6c10f58df4f6dda",
    "title": "2018-11-29 - Analysis Of Targeted Attack Against Pakistan By Exploiting InPage Vulnerability And Related APT Groups",
    "authors": "",
    "file_creation_date": "2022-05-27T22:20:22Z",
    "file_modification_date": "2022-05-27T22:20:22Z",
    "file_size": 2388140,
    "plain_text": "# 奇安信威胁情报中心\n\n**[ti.qianxin.com/blog/articles/analysis-of-targeted-attack-against-pakistan-by-exploiting-inpage-vulnerability-and-related-apt-groups-english/](https://ti.qianxin.com/blog/articles/analysis-of-targeted-attack-against-pakistan-by-exploiting-inpage-vulnerability-and-related-apt-groups-english/)**\n\n返回 TI 主页\nRESEARCH\n\n数 据 驱 动 安 全\n\n## Overview\n\nRecently, QiAnXin Threat Intelligence Center found a series of targeted attacks against Pakistan targets. Attacker\nexploited one vulnerability (CVE-2017-12824) of InPage to craft bait documents (.inp). InPage is a word processing\nsoftware designed specifically for Urdu speakers (official language in Pakistan). In addition, Office documents with\nCVE-2018-0798 vulnerability were also used in the attack. Kaspersky disclosed one target attack in which InPage\nvulnerability was exploited in November 2016[6] . However, first attack by using such software vulnerability can be\ntraced back to June 2016[14].\n\nThrough the analysis of this group of documents with InPage vulnerabilities and related attack activities, we can\nconclude that the attacker is BITTER APT organization disclosed by us in 2016 [5] . After further analysis, some\nsamples in the attack have strong connections with some APT groups, specifically Patchwork, Bahamut, and\nConfucius. That shows more connections among those 4 APT groups from South Asian.\n\n## Timeline\n\nQiAnXin Threat Intelligence Center sorts out the timeline of targeted attacks in which InPage vulnerability was\nexploited in the past two years as following:\n\n\n-----\n\n## InPage Vulnerability Analysis (CVE-2017-12824)\n\nThe scan result of documents with InPage vulnerability on VirusTotal:\n\nInPage is a word processing software specially designed for Urdu speakers, and the vulnerability number involved in\nthe wild attack sample is CVE-2017-12824.\n\nAfter the analysis of the vulnerability by QiAnXin Threat Intelligence Center, it was found that the vulnerability was\ncaused by the fact that InPage word processing software did not check the data type (Type) to be processed when it\nis processing document flow, which led to the out-of-bounds reading. Through carefully constructed InPage\ndocument, arbitrary code could be triggered to execute.\n\n\n-----\n\nWe used InPage 2015 software environment to analyze the vulnerability in detail, and the process is as follows.\n\nInPage 2015\n\n### Cause of Vulnerability: Out-of-bound Read\n\nThe essence of the CVE-2017-12824 vulnerability is out-of-bound Read. The InPage word processor does not check\nthe data type to be processed while processing the InPage100 stream in the document, and the data type to be\nprocessed is specified by a field in the InPage document. This allows an attacker to cause an InPage program to\nmake an out-of-bounds read error by setting a value outside the Type range.\n\nThe key data structures that trigger the vulnerability in document (.inp) are as follows. 0x7E and 0x72 represent a\nclass of type in the document stream to be processed. We mark 0x7E as Type1 and 0x72 as Type2:\n\nInPage processes a.inp file as follows:\n\nInPage first calls Ole!The StgCreateDocfile function parses the entire.inp file and then calls Ole! COleStreamFile: :\nOpenStream open InPage InPage100 data flow in the document:\n\n\n-----\n\nAll the processing logic related to the InPage100 stream will be carried out in PraseInPage100_432750 function, and\nthe data in the stream will be read with the callback function InPage100Read_440ED0:\n\nThe trigger vulnerability Type data, 0x7E and 0x72 mentioned earlier, is eventually processed by the function\nsub_453590.The buf in the figure below reads the data containing Type by calling InPage100Read_440ED0:\n\n\n-----\n\nThe vulnerability function sub_453590 will select the corresponding processing process according to Type1 and\nType2 (0x7E and 0x72 bytes). First, it reads the function pointer array according to Type1, then reads the function\nfrom the function pointer array according to Type2, and finally calls the function to process data:\n\nLet's look at the assignment and range of dword_656A28 in the figure above:\n\nType1 = ECX(0x1F8)>>2 = 0x7E(126), Type2 = EDI(0x72) :\n\n\n-----\n\nFind the assignment of dword_656A28[0x7E] through IDA Pro:\n\nYou can see that the actual size of the dword_656E60 array is 30 (0x1E) :\n\nSince the size of Type2 in the vulnerability document is set to 0x72, EDI=0x72, but the InPage does not judge the size\nof Type2 passed in, this will result in access to dword_656E60[0x72], and because 0x72>30(0x1E), an out-of-bounds\nread error occurs.\n\n### The Exploitation\n\nSince the attacker sets Type2 in the document to 0x72, after addressing calculation, the code at the function address\n0x00455AFA will be accessed across the line:\n\nYou can see that dword_656E60[0x72] (0x455AFA) is just a pop retn instruction:\n\n\n-----\n\nThe pop retn instruction sequence plays a role as \"jump\" address, when performing Type related processing function,\ndue to the incoming parameters (pointer: 0 x031e383f) pointing to a data InPage document flow, an attacker can fill\nthe controllable data flow with ShellCode, so after the pop retn instructions will be returned directly to the attacker set\nShellCode executed:\n\nHowever, the InPage program does not turn on DEP and ASLR protection, which results in ShellCode being directly\nexecuted:\n\n## Analysis of Four Types of Attack Framework Using InPage Vulnerability\n\nQiAnXin Threat Intelligence Center conducted analysis on the samples with InPage vulnerabilities in Pakistan, found\nthat a number of samples generated time, size, initial ShellCode InPage100 document flow and related flow label all\nconsistent. We can confirm that those samples come from same source.\n\n\n-----\n\nThrough the analysis of this batch of InPage vulnerability utilization documents and relevant malicious code, we found\nthat the malicious code carried by the vulnerability documents used four different types of attack frameworks: four\ntypes of completely different backdoor programs. The analysis is as follows.\n\n### WSCSPL:Full - featured Backdoor\n\nA decoy document captured by QiAnXin Threat Intelligence Center is called \"SOP for Retrieval of Mobile Data\nRecords. Inp\" (SOP for Mobile Data Records Retrieval). Cve-2017-12824 vulnerability utilization document will\neventually download and execute a full-featured back door program named WSCSPL.\n\nRelevant vulnerability utilization document information is as follows:\n\nMD5 863f2bfed6e8e1b8b4516e328c8ba41b\n\nThe file name For Retrieval of Mobile Data Records, SOP for Retrieval of Mobile Data Records. Inp\n\n**ShellCode**\n\nAfter the bug is successfully triggered, ShellCode will locate the main function ShellCode by searching the special\nlogo \"27862786\". Then it will download Payload from khurram.com.pk/js/drv and save it to c:\\conf\\ smss.exe for\nexecution:\n\n\n-----\n\n**Downloader**\n\nMD5 c3f5add704f2c540f3dd345f853e2d84\n\n\nCompile\ntime\n\n\n2018.9.24\n\n\nPDB path C: \\ Users \\ Asterix \\ Documents \\ 28 novdwn VisualStudio2008 \\ Projects \\ \\ Release \\ 28 novdwn\nPDB\n\nThe downloaded EXE file is mainly used to communicate with C2 and obtain the executables of other modules. After\nexecution, the registry key value (key: HKCU\\Environment, key value: AppId, data: c:\\ Intel \\drvhost. EXE) will be set\nfirst.\n\nPersistence is achieved by adding itself to the registry bootstrap:\n\n\n-----\n\nAnd determine whether the current process path is c:\\ Intel \\drvhost. Exe, if not, copy itself to the path and execute:\n\nWhen the process path meets the conditions, the machine GUID, computer user name and other information obtained\nfrom the registry are encrypted and concatenated into a string:\n\nThen send the constructed string to communicate with C2:nethosttalk.com and get the command to execute again:\n\n\n-----\n\nIn this case, the C2 server returns an AXE:# instruction. The native program determines whether the instruction is an\nAXE:# or an AXE.\n\nIf \"AXE:#\" is followed by the string content, the plug-in is downloaded and executed\n\nIn the process of debugging and analysis by QiAnXin Threat Intelligence Center analysts, we successfully obtained\nan executable plug-in named \"WSCSPL\" :\n\n\n-----\n\n**Backdoor - WSCSPL**\n\nMD5 1c2a3aa370660b3ac2bf0f41c342373b\n\nCompile time 2018.9.13\n\nOriginal file name Exe winsvc.\n\nThis Trojan has same functionality as the Trojan used by Patchwork APT group disclosed by us in 2016[5]. The Trojan\nsupports 17 commands, including uploading a list of hard disk, finding, reading, creating a specified file, enumerating\na list of processes, and ending a specified process. Trojan function analysis is as follows:\n\nSet two 10-second interval timers after the Trojan program runs:\n\nTimer 1: request the IP of C&C:wcnchost.ddns.net. If the request is successful, save the IP to the global variable\nand set the id variable to 1.\n\n\n-----\n\nTimer 2: check the value of the identifying variable, if 1, try to connect C&C:\n\nThen create two threads:\n\nThread 1: detects the connection status with C&C and receives the C&C command executable if the connection\nis successful\n\n\n-----\n\nThread 2: checks whether the global variable dword_C9618 has data, and if so, sends the data to C&C\n\nThe command execution code snippet is as follows:\n\n\n-----\n\nTrojan’s all commands and corresponding functions are shown in the following table:\n\n3000 Get RAT status information\n\n3001 Get computer hard disk information\n\n3002 Gets the list of files in the specified directory\n\n3004 Get RAT log 1\n\n3005 Create the specified file\n\n3006 Writes data to the create file\n\n3007 Open the specified file\n\n3009 Reads the contents of the specified file\n\n3012 Create remote console\n\n3013 Execute remote commands\n\n3015 Get RAT log 2\n\n3016 End remote console\n\n3017 Closes the specified handle\n\n3019 Gets a process that has an UPD active link\n\n3021 Get RAT log 3\n\n3032 End the specified process\n\n3023 Gets process information in the system\n\n3025 Get RAT log 4\n\n\n-----\n\n### Visual Basic Backdoor\n\nAnother captured vulnerability exploit document, CVE-2017-12824 named ‘AAT national assembly final.inp’, drop the\nbackdoor written by Visual Basic.\n\nRelevant vulnerability document information is as follows:\n\nMD5 ce2a6437a308dfe777dec42eec39d9ea\n\nThe file name The AAT national assembly final. Inp\n\n**ShellCode**\n\nFirst, ShellCode triggered by the vulnerability locates the main ShellCode through the memory global search string\n\"LuNdLuNd\" :\n\nLocate the main ShellCode and get the API functions you want to use, and ensure that only one instance runs by\ncreating the mutex \"QPONMLKJIH\" :\n\nThen extract a DLL module contained in the document and execute it by memory loading:\n\n**Dropper**\n\nMD5 43920ec371fae4726d570fdef1009163\n\nThe PDP path C: \\ users \\ mz \\ documents \\ visualstudio2013 \\ Projects \\ Shellcode \\ Release \\ Shellcode PDB\n\n\n-----\n\nThe DLL file loaded in memory is a Dropper, which contains two resource files, Bin and Bin2 :\n\nBin file is the back door program written by Visual Basic, while Bin2 is the normal inp decoy file released and opened\nafter the vulnerability is triggered. The contents of relevant decoy documents are as follows:\n\n**Backdoor - SMTPLDR. Exe**\n\nMD5 694040b229562b8dca9534c5301f8d73\n\nCompile time 2018.7.4\n\n\n-----\n\nOriginal file name Exe SMTPLDR.\n\nBin file is a backdoor program written by Visual Basic, which is mainly used to obtain command execution. After the\nTrojan horse runs, it first gets the installed application name of the current system from\n\"SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\\" :\n\nThen determine whether the installed application includes kaspersky, NORTON, trend technology and other related\nsoftware killing applications:\n\nThen WMI executes the select * from win32_computersystem command to get the application information and detect\nthe virtual machine environment by determining whether the word \"virtual\" is included in the name:\n\n\n-----\n\nIf the detection is in the virtual machine environment, the popover displays not a valid file and exits:\n\nIf the detection passes, \"SMTP Loader. LNK\" will be created in the directory of %Start% to achieve self-startup:\n\n\n-----\n\nFinally, it communicates with C&C: referfile.com to obtain subsequent instruction execution:\n\n### Delphi Backdoor Program\n\nQiAnXin Threat Intelligence Center found a batch of backdoor written by Delphi through big data correlation, which\nare also documents with InPage vulnerability. Relevant sample information is as follows:\n\nMD5 fec0ca2056d679a63ca18cb132223332\n\nOriginal file name Exe adobsuit.\n\nThe captured Delphi backdoor is the same as the backdoor written by Visual Basic, which is also released from the\nresource file by similar Dropper and created by creating Adobe creative suit. LNK file in the directory of %Start% and\npointing to the implementation of persistence:\n\nThe backdoor will Ducument in % % folder to create the users. The TXT file, and random write 30 bytes of the string:\n\n\n-----\n\nTrojan program will access to a computer user name and the computer user name after encrypting the Ducument to\n% % / SyLog. The log file:\n\nAfter that, I communicated with C2:errorfeedback.com and sent the contents of sylog.log file as POST:\n\nWhen C2 returned to Success, and C2 communication in the form of HTTP GET request again, if return a string,\ncontinued to from \"errorfeedback.com/ MarkQuality455 TTGKWoFdyQHEwpyYKmfVGtzQLfeqpJ/string\" perform\ndownload the following content:\n\n\n-----\n\n### A Backdoor Using Cobalt Strike\n\nAnother captured InPage vulnerability exploit document ends up executing a backdoor generated by Cobalt Strike,\nwith the following documentation information:\n\nMD5 74aeaeaca968ff69139b2e2c84dc6fa6\n\nThe file type InPage vulnerability exploit documentation\n\nFind the time 2018.11.02\n\n**ShellCode**\n\nAfter the vulnerability is successfully triggered, ShellCode first locates the main ShellCode with the special identifier\n\"LuNdLuNd\", and then loads the attached DLL in memory and executes.\n\n**Dropper**\n\nMD5 ec834fa821b2ddbe8b564b3870f13b1b\n\nPDB path C: \\ users \\ mz \\ documents \\ visualstudio2013 \\ Projects \\ Shellcode \\ Release \\ Shellcode PDB\n\nMemory loaded DLL file and the above Visual Basic/Delphi back door, is also from the resources to release Trojan\nfiles and execute:\n\n**Downloader - winopen. Exe**\n\n\n-----\n\nMD5 09d600e1cc9c6da648d9a367927e6bff\n\nCompile time 2018.10.12\n\nRelease the Downloader executive called winopen. Exe, it will get a normal JPEG file header from\njospubs.com/foth1018/simple.jpg encrypted files, if successful, is from the JPEG file 49th bytes begin with 0 x86 or\ndecryption:\n\nThe decrypted file is a DLL file, which is then loaded and executed.DLL program will first determine the running\nenvironment and check whether the DLL loading process is rundll32.exe:\n\nIf the loading process is not rundll32.dll, release the backdoor program named aflup64.dll under C:\nProgramData\\Adobe64:\n\n\n-----\n\nExe \"C:\\ ProgramData\\ Adobe64\\ aflup64.dll\", exe \"C:\\ ProgramData\\ Adobe64\\ aflup64.dll\"\n\nFinally, start rundll32.exe to load aflup64.dll and call its export function IntRun:\n\n**Backdoor - aflup64. DLL**\n\nMD5 91e3aa8fa918caa9a8e70466a9515666\n\nCompile time 2018.10.12\n\nExportation IntRun will do the same thing again, get the JPEG file, xor decrypt it, and then execute.Because it is\nthrough rundll32 starts, so will go to another branch, first create the mutex \"9 a5f4cc4b39b13a6aecfe4c37179ea63\" :\n\n\n-----\n\nThen, create \"nnp74DE. TMP\" file in the directory of %TEMP%. Then, execute the command tasklist, ipconfig./all, dir\nto get system process information, network information, file list and so on.\n\nThen get the machine ID, system version, current system time, connect all the acquired information beginning with\n\"tag FluffyBunny\", base64-encoded connect C&C and upload:\n\nAfter the information transmission is successful, Base64 encoding of the string \"OK\" will be returned:\n\n\n-----\n\nIf the request line is not successful, the request line is looped.After the successful launch, it will enter the second\nstage to send base64-encoded data of calculation name-user name to jospubs/foth1018/go.php and obtain the\ncommand execution:\n\nThe format of relevant commands that can be obtained is in the form of \"number: parameter\", which supports 5\ncommands in total. The list of relevant commands is as follows:\n\nThe command ID function\n\n103 Download the Plugin and drop it into the %TEMP% directory\n\n105 Gets the file memory load\n\n115 Gets the contents of the parameter file\n\n117 Delete the start. LNK file\n\n120 Download the file to the %temp% directory and delete start.lnk\n\n**The Plugins - jv77CF. TMP**\n\nMD5 c9c1ec9ae1f142a8751ef470afa20f15\n\nCompile time 2018.4.3\n\nIn the debugging process of QiAnXin Threat Intelligence Center analysts, we successfully acquired a Trojan horse\nplug-in which was executed on the ground.The Trojan plugin continues to get the encrypted file from pp5.zapto.org:\n\n\n-----\n\nUpon successful retrieval, hetero or decryption is performed, and the decrypted file is a remote back door generated\nby Cobalt Strike:\n\n\n-----\n\n## Analysis of CVE-2018-0798 Samples\n\n\n-----\n\nBy expanding the big data platform of QiAnXin Threat Intelligence Center, we found a vulnerability utilization\ndocument of Office CVE-2018-0798 belonging to the same series of attack activities.The document is called \"SOP for\nRetrieval of Mobile Data Records. Doc\", which is the same name as the InPage vulnerability for the release of the\nWSCSPL Trojan (with the same origin as the Retrieval of the impersonal Records). However, the vulnerability\ndocument is targeted at Microsoft Office.\n\nMD5 61a107fee55e13e67a1f6cbc9183d0a4\n\nThe file name For SOP for Retrieval of Mobile Data Records. Doc\n\nThe Objdata object information containing the vulnerability is as follows:\n\nAfter the vulnerability successfully triggers the execution, subsequent Payload executables will be obtained by means\nof the same download address as the SOP for Retrieval of Mobile Data Records. Inp (InPage) vulnerability makes use\nof the file for the Retrieval of Mobile Data Records:\n\n## Attribution and Correlation\n\n\n-----\n\nQiAnXin Threat Intelligence Center through the analysis of this batch of InPage vulnerability utilization documents and\nrelated attack activities, it is the \"BITTER\" APT organization disclosed by 360 company in 2016 that is the group\nbehind the targeted attack using WSCSPL backdoor program[5]And after further analysis, many samples in the series\nof attacks are also strongly related to APT organizations such as mahagrass, Bahamut and Confucius.\n\n### BITTER APT Group\n\nAfter in-depth analysis of several InPage vulnerability documents with a relatively short attack time by QiAnXin Threat\nIntelligence Center, it was found that the Trojan program released by the vulnerability document was the backdoor\nprogram used by APT organization \"manlinghua\" exposed by 360 company in 2016[5], is the analysis of the WSCSPL\nfull - featured backdoor program.\n\n**Command ID** **Function**\n\n2000 Retrieve RAT status information\n\n2001 Retrieve hard disk list\n\n2002 Retrieve file list in given directory\n\n2004 Retrieve RAT log 1\n\n2005 Create file by given filename\n\n2006 Write bytes into created file (2005)\n\n2007 Open file\n\n2009 Read file content (2007)\n\n2012 Create remote console\n\n2013 Execute remote command\n\n2015 Retrieve RAT log 2\n\n2016 Terminate remote console\n\n2017 Close handle\n\n2019 Retrieve a list of processes with UPD activity link\n\n2021 Retrieve RAT log 3\n\n2022 Terminate process by process ID\n\n2023 Retrieve a list of active processes\n\n2025 Retrieve RAT log 4\n\nIn addition, many of these C&C addresses are also strongly related to APT organization \"manlinghua\" in the internal\nanalysis platform of QiAnXin Threat Intelligence Center. These C&C addresses have been repeatedly used in attacks\nagainst China.Therefore, the relevant attack activities can be identified as \"vine spirit flower\".\n\n### Relation to Confucius\n\nDelphi backdoor attack framework used in the C&C address errorfeedback.com in Trend Micro exploring Confucius\nand mahagrass similarity[10]Appears that the domain name has been disclosed as a trend of Confucius use.\n\n### Relation to Patchwork\n\n\n-----\n\nThrough the in depth analysis and correlation of Delphi backdoor attack framework mentioned above, we also found\nthat the attack framework and sample also appeared in the InPage attack sample analyzed by Palo Alto in\n2017[13]Palo Alto thought the attack framework and backdoor might have something to do with mahagrass.\n\n### Relation to \"Bahamut\"\n\nA vulnerability document \"AAT national assembly final.inp\" analyzed by QiAnXin Threat Intelligence Center into the\nattack activity was finally executed by the Trojan horse (Visual Basic backdoor program) using the domain name\nreferfile.com as C2, which was published by Cisco Talos security research team in July 2018 as \"a case of targeted\nattack against Indian iOS users\".[9]It was revealed that Talos security research team associated with this domain\nname was also used by a Visual Basic backdoor program, and the related network assets were suspected to be\nowned by APT organization \"Bahamut\".\n\n## Summary and Conjecture\n\nQiAnXin Threat Intelligence Center analyzed a group of document samples with same attribution (timestamp,\nShellCode, InPage100 flow size, flow characteristics), and found that those samples use at least 4 different malicious\ncode framework, and have connections with \"PatchWork\", \"BITTER”, \"Confucius\", \"Bahamut\" APT organization has\nproduced more or less.Maybe these APT groups are actually one group? Or their digital weapons are provided by one\nvendor(Their supporter give them same exploitation tools)?\n\nThe following is a TTP summary of APT groups mentioned in this article:\n\nBITTER PatchWork Confucius Bahamut\n\nTarget China, Pakistan China, Pakistan South Asia South Asia (mainly Pakistan),\nMiddle East\n\nAttack platform PC/Android PC/Android PC/Android PC/Android/iOS\n\n\n-----\n\nProgramming\nlanguage\n\n\nC Delphi/c # Delphi Delphi/VB\n\n\nAttack vector Spear-phishing\nattack\n\n## IOC\n\n\nSocial networks, spearphishing attack\n\n\nSocial\nnetwork\n\n\nSocial networks, spearphishing attack\n\n\n**Documents with InPage vulnerability**\n\n863f2bfed6e8e1b8b4516e328c8ba41b\n\nce2a6437a308dfe777dec42eec39d9ea\n\n74aeaeaca968ff69139b2e2c84dc6fa6\n\n**Office vulnerability exploit documents**\n\n61a107fee55e13e67a1f6cbc9183d0a4\n\n**Trojans**\n\nc3f5add704f2c540f3dd345f853e2d84\n\nf9aeac76f92f8b2ddc253b3f53248c1d\n\n8dda6f85f06b5952beaabbfea9e28cdd\n\n25689fc7581840e851c3140aa8c3ac8b\n\n1c2a3aa370660b3ac2bf0f41c342373b\n\n43920ec371fae4726d570fdef1009163\n\n694040b229562b8dca9534c5301f8d73\n\nfec0ca2056d679a63ca18cb132223332\n\nec834fa821b2ddbe8b564b3870f13b1b\n\n09d600e1cc9c6da648d9a367927e6bff\n\n91e3aa8fa918caa9a8e70466a9515666\n\n4f9ef6f18e4c641621f4581a5989284c\n\nafed882f6af66810d7637ebcd8287ddc\n\n**C&C**\n\nkhurram.com.pk\n\nnethosttalk.com\n\nxiovo416.net\n\nnethosttalk.com\n\nnewmysticvision.com\n\nwcnchost.ddns.net\n\n\n-----\n\nreferfile.com\n\nerrorfeedback.com\n\nJospubs.com\n\ntraxbin.com\n\nreferfile.com\n\n## Reference\n\n[1]. https://ti.qianxin.com/\n\n[2]. http://www.inpage.com/\n\n[3]. https://en.wikipedia.org/wiki/InPage\n\n[4]. https://ti.qianxin.com/blog/articles/analysis-of-apt-campaign-bitter/\n\n[5]. https://www.anquanke.com/post/id/84910\n\n[6]. https://www.kaspersky.com/blog/inpage-exploit/6292/\n\n[7]. https://cloudblogs.microsoft.com/microsoftsecure/2018/11/08/attack-uses-malicious-inpage-document-andoutdated-vlc-media-player-to-give-attackers-backdoor-access-to-targets/\n\n[8]. https://blog.talosintelligence.com/2018/07/Mobile-Malware-Campaign-uses-Malicious-MDM.html\n\n[9]. https://blog.talosintelligence.com/2018/07/Mobile-Malware-Campaign-uses-Malicious-MDM-Part2.html\n\n[10]. https://blog.trendmicro.com/trendlabs-security-intelligence/confucius-update-new-tools-and-techniques-furtherconnections-with-patchwork/\n\n[11]. https://documents.trendmicro.com/assets/appendix-confucius-update-new-tools-techniques-connectionspatchwork-updated.pdf\n\n[12]. https://researchcenter.paloaltonetworks.com/2016/09/unit42-confucius-says-malware-families-get-further-byabusing-legitimate-websites/\n\n[13]. https://researchcenter.paloaltonetworks.com/2017/11/unit42-recent-inpage-exploits-lead-multiple-malwarefamilies/\n\n[14].\nhttps://www.virustotal.com/gui/file/9bf55fcf0a25a2f7f6d03e7ba6123d5a31c3e6c1196efae453a74d6fff9d43bb/submissions\n\n蔓灵花 BITTER APT INPAGE 摩诃草 CONFUCIUS BAHAMUT\n\n分享到：\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2018/2018-11-29 - Analysis Of Targeted Attack Against Pakistan By Exploiting InPage Vulnerability And Related APT Groups.pdf"
    ],
    "report_names": [
        "2018-11-29 - Analysis Of Targeted Attack Against Pakistan By Exploiting InPage Vulnerability And Related APT Groups.pdf"
    ],
    "threat_actors": [
        {
            "id": "caf95a6f-2705-4293-9ee1-6b7ed9d9eb4c",
            "created_at": "2022-10-25T15:50:23.472432Z",
            "updated_at": "2025-03-27T02:00:55.479021Z",
            "deleted_at": null,
            "main_name": "Confucius",
            "aliases": [
                "Confucius",
                "Confucius APT"
            ],
            "source_name": "MITRE:Confucius",
            "tools": [
                "WarzoneRAT"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "732bfd4b-8c15-42a5-ac4b-14a9a4b902e9",
            "created_at": "2022-10-25T16:07:23.38079Z",
            "updated_at": "2025-03-27T02:02:09.771357Z",
            "deleted_at": null,
            "main_name": "Bahamut",
            "aliases": [],
            "source_name": "ETDA:Bahamut",
            "tools": [
                "Bahamut",
                "DownPaper"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "bf6cb670-bb69-473f-a220-97ac713fd081",
            "created_at": "2022-10-25T16:07:23.395205Z",
            "updated_at": "2025-03-27T02:02:09.777308Z",
            "deleted_at": null,
            "main_name": "Bitter",
            "aliases": [
                "T-APT-17",
                "TA397"
            ],
            "source_name": "ETDA:Bitter",
            "tools": [
                "Artra Downloader",
                "ArtraDownloader",
                "Bitter RAT",
                "BitterRAT",
                "Dracarys"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "655f7d0b-7ea6-4950-b272-969ab7c27a4b",
            "created_at": "2022-10-27T08:27:13.133291Z",
            "updated_at": "2025-03-27T02:00:55.490812Z",
            "deleted_at": null,
            "main_name": "BITTER",
            "aliases": [
                "T-APT-17"
            ],
            "source_name": "MITRE:BITTER",
            "tools": [
                "ZxxZ"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "610a7295-3139-4f34-8cec-b3da40add480",
            "created_at": "2023-01-06T13:46:38.608142Z",
            "updated_at": "2025-03-27T02:00:02.87217Z",
            "deleted_at": null,
            "main_name": "Cobalt",
            "aliases": [
                "Cobalt Gang",
                "GOLD KINGSWOOD",
                "COBALT SPIDER",
                "G0080",
                "Mule Libra",
                "Cobalt Group"
            ],
            "source_name": "MISPGALAXY:Cobalt",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "f99641e0-2688-47b0-97bc-7410659d49a0",
            "created_at": "2023-01-06T13:46:38.802141Z",
            "updated_at": "2025-03-27T02:00:02.922907Z",
            "deleted_at": null,
            "main_name": "Bahamut",
            "aliases": [],
            "source_name": "MISPGALAXY:Bahamut",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "ada9e5d3-1cb2-4b70-a3c8-96808c304ac8",
            "created_at": "2022-10-25T15:50:23.6515Z",
            "updated_at": "2025-03-27T02:00:55.513513Z",
            "deleted_at": null,
            "main_name": "Windshift",
            "aliases": [
                "Windshift",
                "Bahamut"
            ],
            "source_name": "MITRE:Windshift",
            "tools": [
                "WindTail"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "7a8dbc5e-51a8-437a-8540-7dcb1cc110b8",
            "created_at": "2022-10-25T16:07:23.482856Z",
            "updated_at": "2025-03-27T02:02:09.827887Z",
            "deleted_at": null,
            "main_name": "Confucius",
            "aliases": [],
            "source_name": "ETDA:Confucius",
            "tools": [
                "ApacheStealer",
                "ByeByeShell",
                "ChatSpy",
                "Confucius",
                "MY24",
                "Sneepy",
                "remote-access-c3",
                "sctrls",
                "sip_telephone",
                "swissknife2"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "7ea1e0de-53b9-4059-802f-485884180701",
            "created_at": "2022-10-25T16:07:24.04846Z",
            "updated_at": "2025-03-27T02:02:10.090459Z",
            "deleted_at": null,
            "main_name": "Patchwork",
            "aliases": [
                "APT-C-09",
                "ATK 11",
                "Capricorn Organisation",
                "Chinastrats",
                "Dropping Elephant",
                "Maha Grass",
                "Quilted Tiger",
                "TG-4410",
                "Thirsty Gemini",
                "Zinc Emerson"
            ],
            "source_name": "ETDA:Patchwork",
            "tools": [
                "AndroRAT",
                "Artra Downloader",
                "ArtraDownloader",
                "AutoIt backdoor",
                "BADNEWS",
                "BIRDDOG",
                "Bahamut",
                "Bozok",
                "Bozok RAT",
                "Brute Ratel",
                "Brute Ratel C4",
                "CinaRAT",
                "Crypta",
                "ForeIT",
                "JakyllHyde",
                "Loki",
                "Loki.Rat",
                "LokiBot",
                "LokiPWS",
                "NDiskMonitor",
                "Nadrac",
                "PGoShell",
                "PowerSploit",
                "PubFantacy",
                "Quasar RAT",
                "QuasarRAT",
                "Ragnatela",
                "Ragnatela RAT",
                "SocksBot",
                "TINYTYPHON",
                "Unknown Logger",
                "WSCSPL",
                "Yggdrasil"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "9c884c88-2c9f-49c5-856a-2383ad1d8ef8",
            "created_at": "2024-05-01T02:03:08.152Z",
            "updated_at": "2025-03-27T02:05:17.422887Z",
            "deleted_at": null,
            "main_name": "ZINC EMERSON",
            "aliases": [
                "Dropping Elephant ",
                "EHDevel ",
                "Manul ",
                "Monsoon ",
                "Operation Hangover ",
                "Patchwork ",
                "TG-4410 ",
                "Viceroy Tiger ",
                "Confucius "
            ],
            "source_name": "Secureworks:ZINC EMERSON",
            "tools": [
                " Hanove",
                " Mac OS X KitM Spyware",
                " Proyecto2",
                " YTY Backdoor",
                "Enlighten Infostealer"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "c81067e0-9dcb-4e3f-abb0-80126519c5b6",
            "created_at": "2022-10-25T15:50:23.285448Z",
            "updated_at": "2025-03-27T02:00:55.42906Z",
            "deleted_at": null,
            "main_name": "Patchwork",
            "aliases": [
                "Hangover Group",
                "Dropping Elephant",
                "Chinastrats",
                "Operation Hangover"
            ],
            "source_name": "MITRE:Patchwork",
            "tools": [
                "NDiskMonitor",
                "QuasarRAT",
                "BackConfig",
                "TINYTYPHON",
                "AutoIt backdoor",
                "PowerSploit",
                "BADNEWS",
                "Unknown Logger",
                "Socksbot"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1673536250,
    "ts_updated_at": 1743041706,
    "ts_creation_date": 1653690022,
    "ts_modification_date": 1653690022,
    "files": {
        "pdf": "https://archive.orkl.eu/a42ff412daf020e3652201b3a6c10f58df4f6dda.pdf",
        "text": "https://archive.orkl.eu/a42ff412daf020e3652201b3a6c10f58df4f6dda.txt",
        "img": "https://archive.orkl.eu/a42ff412daf020e3652201b3a6c10f58df4f6dda.jpg"
    }
}