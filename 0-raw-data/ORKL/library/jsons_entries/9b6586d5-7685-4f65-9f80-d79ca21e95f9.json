{
    "id": "9b6586d5-7685-4f65-9f80-d79ca21e95f9",
    "created_at": "2023-01-12T15:04:12.958136Z",
    "updated_at": "2025-03-27T02:16:08.472332Z",
    "deleted_at": null,
    "sha1_hash": "499c42946d62bb50833f458e7dee871638a52970",
    "title": "2020-07-09 - More evil- A deep look at Evilnum and its toolset",
    "authors": "",
    "file_creation_date": "2022-05-28T17:42:12Z",
    "file_modification_date": "2022-05-28T17:42:12Z",
    "file_size": 517715,
    "plain_text": "# More evil: A deep look at Evilnum and its toolset\n\n**[welivesecurity.com/2020/07/09/more-evil-deep-look-evilnum-toolset/](https://www.welivesecurity.com/2020/07/09/more-evil-deep-look-evilnum-toolset/)**\n\nJuly 9, 2020\n\nESET research gives a detailed picture of the operations of the Evilnum group and its toolkit\ndeployed in attacks against carefully chosen targets in the fintech sector\n\n[Matías Porolli](https://www.welivesecurity.com/author/mporolli/)\n9 Jul 2020 - 11:30AM\n\nESET research gives a detailed picture of the operations of the Evilnum group and its toolkit\ndeployed in attacks against carefully chosen targets in the fintech sector\n\n\n-----\n\nESET has analyzed the operations of Evilnum, the APT group behind the Evilnum malware\npreviously seen in attacks against financial technology companies. While said malware has\nbeen seen in the wild since at least 2018 and documented previously, little has been\npublished about the group behind it and how it operates.\n\nIn this article we connect the dots and disclose a detailed picture of Evilnum’s activities. The\ngroup’s targets remain fintech companies, but its toolset and infrastructure have evolved\nand now consist of a mix of custom, homemade malware combined with tools purchased\nfrom Golden Chickens, a Malware-as-a-Service (MaaS) provider whose infamous\ncustomers include FIN6 and Cobalt Group.\n\n## Targets\n\nAccording to ESET’s telemetry, the targets are financial technology companies – for\nexample, companies that offer platforms and tools for online trading. Although most of the\ntargets are located in EU countries and the UK, we have also seen attacks in countries\nsuch as Australia and Canada. Typically, the targeted companies have offices in several\nlocations, which probably explains the geographical diversity of the attacks.\n\nThe main goal of the Evilnum group is to spy on its targets and obtain financial information\nfrom both the targeted companies and their customers. Some examples of the information\nthis group steals include:\n\nSpreadsheets and documents with customer lists, investments and trading operations\nInternal presentations\nSoftware licenses and credentials for trading software/platforms\nCookies and session information from browsers\nEmail credentials\nCustomer credit card information and proof of address/identity documents\n\nAccording to what we have seen during our investigation, the group has also gained access\nto IT-related information such as VPN configurations.\n\n## Overview of the attack\n\nTargets are approached with spearphishing emails that contain a link to a ZIP file hosted on\nGoogle Drive. That archive contains several LNK (aka shortcut) files that extract and\nexecute a malicious JavaScript component, while displaying a decoy document. These\nshortcut files have “double extensions” to try to trick the user into opening them, thinking\nthey are benign documents or pictures (in Windows, file extensions for known file types are\nhidden by default). The contents of one of the ZIP files are shown in Figure 1.\n\n\n-----\n\n_Figure 1. Malicious LNK files_\n\nOnce a shortcut file is opened (it doesn’t matter which one, as they all do the same thing), it\nlooks in the contents of its own file for lines with a specific marker and writes them to a .js\nfile. Then this malicious JavaScript file is executed and it writes and opens a decoy file with\nthe same name as the shortcut, but with the correct extension. It also deletes the shortcut\nfile. The documents used as decoys are mostly photos of credit cards, identity documents,\nor bills with proof of address, as many financial institutions require these documents from\ntheir customers when they join, according to regulations (this is known as “Know Your\nCustomer”). One such decoy is shown in Figure 2 (blurred for privacy).\n\n\n-----\n\n_Figure 2. Photo of the back of an ID card, used as a decoy_\n\nThese decoy documents seem genuine, and we assume that they have been collected by\nthis group during years of operation. Documents are collected actively in the group’s current\noperations, as it targets technical support representatives and account managers, who\nregularly receive these kinds of documents from their customers. The group reuses the\ndocuments on different targets, unless the targets are from different regions.\n\nThe JavaScript component is the first stage of the attack and can deploy other malware\n[such as a C# spy component, Golden Chickens components or several Python-based tools.](https://quointelligence.eu/2020/01/the-chicken-keeps-laying-new-eggs-uncovering-new-gc-maas-tools-used-by-top-tier-threat-actors/)\nThe name Evilnum was given to the C# component by other researchers in the past, but the\nJS component also has been referred to as Evilnum. We have named the group Evilnum as\nthat is the name of their flagship malware, and we’ll refer to the various malware pieces as\ncomponents. An overview of these is shown in Figure 3.\n\n\n-----\n\n_Figure 3. Evilnum components_\n\nEach of the various components has its own C&C server, and each component operates\nindependently. The operators of the malware manually send commands to install additional\ncomponents and use post-compromise scripts and tools if they consider them necessary.\n\nMost servers used by the malware are referenced by IP addresses; domain names have\nnot been used. The only exceptions are the C&C servers used by the Golden Chickens\ncomponents; malware purchased from a MaaS provider, as we describe later.\n\nThose referenced by an IP address can be split into two groups, based on the hosting\nprovider. The majority of them are hosted with FreeHost, a Ukrainian provider. The rest are\nhosted in the Netherlands, with Dotsi.\n\n## JS Component: First compromise\n\n\n-----\n\nThis component communicates with a C&C server and acts as a backdoor without the need\nfor any additional program. However, in most attacks that we have seen, the attackers\ndeployed additional components as they saw fit and used the JS malware only as a first\nstage.\n\nThe first known mention of this JavaScript malware was in May 2018 in this pwncode\narticle. The malware has changed since then and we illustrate these changes in Figure 4.\n\n_Figure 4. Timeline of changes in JS component_\n\nDifferences between version 1.3 and the others are noteworthy, as the server-side code for\nthe C&C was changed and commands are different. In that early version it was not possible\nto upload files to the C&C, only to download files to the victim’s computer. Also, as new\nversions appeared, the malware was extended with some Python scripts (see the Post_[compromise toolset section) and external tools such as ChromeCookiesView.](https://www.nirsoft.net/utils/chrome_cookies_view.html)_\n\n\n-----\n\nDespite the differences, the core functionalities remain the same in all versions, including\nthe retrieval of the C&C server’s address from GitHub, GitLab or Reddit pages created\nspecifically for that purpose. Figure 5 shows an example of a Reddit page that is parsed by\nthe malware to retrieve a C&C address.\n\n_Figure 5. Reddit page with the C&C server for the JS component_\n\nThis component achieves persistence through the Run registry key and has full backdoor\ncapabilities: it can download and execute binaries, run arbitrary commands or upload files\nfrom the victim computer to the C&C server. We will not go into details about the technical\naspects of this component, as a good analysis of the latest version was published recently\nby Prevailion.\n\n## C# Component: Evil, not so evil\n\n\n-----\n\n[In March 2019, Palo Alto Networks described malware with very similar functionality to the](https://unit42.paloaltonetworks.com/cardinal-rat-sins-again-targets-israeli-fin-tech-firms/)\nJS component, but coded in C#. That version (2.5) obtained the address of its C&C by\ndividing a number by 666, and was therefore named Evilnum by Palo Alto Networks\nresearchers. Since then there have been new versions of the C# malware, the latest of\nthem being version 4.0, which we first saw in April 2020. The number 666 is not used\nanymore and the PDB paths of the executables show that the developers call their malware\n“Marvel”. However, we will continue to name the malware Evilnum to avoid creating\nconfusion.\n\nThe latest version comes bundled in an MSI file (Windows Installer) and runs independent\nof the JS component. Furthermore, it has different C&Cs than the JS component. However,\nin all cases that we have seen, the C# component was downloaded and executed after the\nJavaScript malware gained initial access. The structure of this component is shown in\nFigure 6.\n\n\n-----\n\n_Figure 6. Parts of the C# component_\n\nWhen the MSI file is executed, three malicious components, along with some .NET\nFramework library files, are written to disk in %LOCALAPPDATA%\\Microsoft\\Mediia. The\nfile copier is the first to be executed and its only purpose is to move the files to another\nlocation in %LOCALAPPDATA% (see the Indicators of Compromise section for the folder\nnames). The loader is then executed and it loads and decrypts the contents of the file\nSystem.Memmory.dll, which is the actual malicious payload (DLL Agent) for the C#\ncomponent. AES encryption is used for the DLL and for obfuscation of the strings in the\npayload. The same key and initialization vector are used to encrypt the strings in all of the\ndifferent versions.\n\nThe IP address of the C&C server is hardcoded and in plain text. A GET request is sent for\n/Validate/valsrv and if the response body contains the text youwillnotfindthisanywhare, then\nthe server is accepted. Otherwise, a GitLab page is parsed to get the IP address of a\nsecond server.\n\nThe following capabilities are present in version 4.0:\n\nTake screenshots if the mouse has been moved in a period of time, and send them to\nthe C&C, base64 encoded. The image is stored in a file called SC4.P7D\nRun commands\nRun other binaries via cmd.exe\nSend information such as computer name, username and antivirus installed\nPersist in a compromised system by creating registry keys\n\n### Commands\n\nThe commands that can be sent to the malware are:\n\nkillme: stops the malware and removes persistence\nmouse: moves the mouse. With this action a screenshot will be taken\ncookies: sends Chrome cookies to the C&C\npasswords: sends Chrome saved passwords. We believe they focus on Chrome not\nbased on market share (after all, these are targeted attacks), but because of the ease\nof processing cookies and retrieving stored passwords\nOther commands to be run directly with cmd.exe\n\nVersion 2.5 was the first documented version of the C# component (first seen by ESET in\nDecember 2018). Then we saw v2.7.1 (November 2019), v3 (December 2019) and v4.0\n(April 2020). The most important differences between the latest version of the malware and\nprevious ones are:\n\nThe main payload is a 32-bit DLL. Previously, it was a 64-bit EXE file.\nHTTPS communication in the latest version\n\n\n-----\n\nThere is no reverse command anymore. It was used in previous versions to open a\nreverse shell. This is now done with other scripts\n\nThe JS and C# components are connected to each other: the latter takes screenshots\nwhereas the former doesn’t, but it has code that looks for screenshot files and sends them\nto its C&C server. The C# component also deletes all files with the .lnk extension in the\n%LOCALAPPDATA%\\Temp folder, cleaning leftovers from the initial compromise by the JS\ncomponent. So even if the C# component has limited functionalities (it can’t download or\nupload files), it provides redundancy with a different C&C server and extra persistence in\ncase the JS component is detected or removed from the victim’s computer.\n\n## Golden Chickens components: TerraLoader family\n\nIn a small number of cases, the Evilnum group has also deployed some tools purchased\nfrom a Malware‑as‑a‑Service provider. This term is used to describe malware authors who\noffer not only their malicious binaries, but also any necessary infrastructure (such as the\nC&C servers) and even technical support to their criminal customers.\n\nIn this case the MaaS provider is known as Golden Chickens and has other customers\n(apart from this group), such as [FIN6 and](https://attack.mitre.org/groups/G0037/) [Cobalt Group. Older versions of all the](https://attack.mitre.org/groups/G0080/)\ncomponents that we describe in the following sections were seen previously, in an attack\nagainst eCommerce merchants that Visa attributed to FIN6 in February 2019. We believe\nthat FIN6, Cobalt Group and Evilnum group are not the same, despite the overlaps in their\ntoolsets. They just happen to share the same MaaS provider.\n\nThe Golden Chickens tools come as ActiveX components (OCX files) and all of them\ncontain TerraLoader code, which serves as a common loader for the various payloads\navailable to Golden Chickens’ customers. These tools are used by Evilnum as follows:\n\nThe attackers manually send a command to the JS or C# component to drop and\nexecute a batch file from one of their servers.\nThat batch file writes a malicious INF file and supplies it as a parameter to the\nMicrosoft utility cmstp.exe, which executes a remote scriptlet specified in the INF file.\nThis technique has been documented in the MITRE ATT&CK knowledge base as\n[CMSTP; an example of how this technique is used may be found here. This technique](https://attack.mitre.org/techniques/T1191/)\n[has been used in the past by Cobalt, another financially motivated group.](https://attack.mitre.org/groups/G0080/)\nThe remote scriptlet contains obfuscated JS code that drops an OCX file and\nexecutes it via regsvr32.exe.\n\nThe TerraLoader code performs several integrity checks before dropping the payload.\nThese checks implement anti-debugging techniques and try to identify anomalies to prevent\nexecution in sandboxed environments. Some of these techniques range from detecting\n\n\n-----\n\nincorrect parameters, filenames and extensions, to detecting hardware breakpoints or\nidentifying specific modules loaded into the subject process. Should these checks all pass,\nthe actual payload is decrypted and executed.\n\nWe have seen Evilnum deploy the following Golden Chickens payloads in their attacks:\n\nMore_eggs\nA Meterpreter payload that we will call TerraPreter\nTerraStealer\nTerraTV\n\nResearchers from Positive Technologies recently analyzed some tools used by the Cobalt\ngroup, including More_eggs version 6.6, which is one of the versions used by Evilnum\n[group. They have a very good analysis of TerraLoader, so we suggest checking their report](https://www.ptsecurity.com/ww-en/analytics/pt-esc-threat-intelligence/cobalt_upd_ttps/)\n(section 4).\n\n### More_eggs\n\n[More_eggs is a JavaScript backdoor that communicates with a C&C server and accepts](https://attack.mitre.org/software/S0284/)\ncommands. It has been used in the past by other groups targeting financial companies.\nEvilnum uses it in conjunction with its homemade backdoors in order to provide redundancy\nand additional persistence on victim networks.\n\nWe have seen Evilnum use 32-bit ActiveX components with TerraLoader code that runs\nMore_eggs versions 6.5, 6.6 and 6.6b – the latest available versions. They do so by\ndropping msxsl.exe (a command line transformation utility that is a legitimate Microsoft\nexecutable) and having it execute the JavaScript code, very similar to what was described\nin [this article by IRIS.](https://securityintelligence.com/posts/more_eggs-anyone-threat-actor-itg08-strikes-again/)\n\nThe dropped JavaScript code is generated on the fly by the ActiveX component, and there\nare some considerations during analysis:\n\nThe initial JS code that executes exe has a hardcoded absolute path, so executing it\nfrom another location or with another user will fail.\nThe final More_eggs payload is encrypted with a key that has the hostname and\nprocessor family information appended at the end. An example key is:\n\ncvyLMmtGSKmPMfzJjGyg552DESKTOP-FQAT01XIntel64 Family 6 Model 94 Stepping 3,\nGenuineIntel\n\nThe core functionalities are the same as described in the article linked above, although\nthere is a new command, more_time, not mentioned there. This command is similar to the\ndocumented command via_c, which executes its parameter with cmd.exe /v /c\n<parameter>. The difference is that it additionally sends the output back to the C&C (via_c\nonly sends whether or not the command succeeded).\n\n\n-----\n\n### TerraPreter\n\nEvilnum group also uses 64-bit executables that decrypt and run a Meterpreter instance in\nmemory. The use of Meterpreter gives them flexibility and the ability to run various payloads\nin a stealthy and extensible way.\n\nThe structure of these components and the integrity checks implemented were identified as\nTerraLoader code. That’s why we refer to these components as TerraPreter. Decompiled\ncode of the main malicious routine is shown in Figure 7.\n\n_Figure 7. Decompiled code for Meterpreter Loader components_\n\nThe routine labeled Dummy calls a series of APIs that don’t do anything. The RC4 function\ninitialization brute-forces the key to use by taking a base string and appending a number to\nit that is incremented in each iteration. It then decrypts a 16-byte buffer with the candidate\n\n\n-----\n\nkey using RC4. If the decrypted buffer matches a hardcoded string, then that candidate key\nwill be the chosen RC4 key for later use. We believe this may be a time-wasting\ncountermeasure against emulators.\n\nAfter the embedded buffer with the payload is decrypted, the malware will finally set a\ncallback to the GrayStringW API function, pointing to the decrypted buffer. After going\nthrough many layers of decoding, Meterpreter’s metsrv.dll is loaded in memory. From this\npoint on, what we see is regular Meterpreter behavior that has not been modified. However,\nwe will continue to describe how communications are performed.\n\nTerraPreter communicates with a C&C server using HTTPS and retrieves a series of\ncommands. C&Cs we have seen contacted are cdn.lvsys[.]com and faxing-mon[.]best. The\nfirst one was redirected to d2nz6secq3489l.cloudfront[.]net. Every time a C&C receives a\nrequest, it sends different binary data XORed with a random 4-byte key. The malware reads\nthe key to be used for decryption from the first 4 bytes of a 32-byte header that prefixes the\nencrypted data. Figure 8 shows an example.\n\n\n-----\n\n_Figure 8. Data sent by the C&C_\n\nThe first command sent by the C&C is core_patch_url, which changes the last part of the\nURL for subsequent requests. Then core_negotiate_tlv_encryption is sent by the C&C,\nalong with its public key. From this point on, messages will be encrypted before they are\nXORed.\n\n### TerraStealer and TerraTV\n\nTerraStealer is also known as SONE or Stealer One. It scans for many browsers, email,\nFTP and file transfer applications, to steal cookies and credentials. One of the binaries we\nanalyzed had logging activated. Part of one such log is shown in Figure 9.\n\n\n-----\n\n_Figure 9. TerraStealer log_\n\nAnother component used by this group is a variant of TerraTV. It runs a legitimate\nTeamViewer application but hides its user interface elements, so that the operators of the\nmalware can connect to the compromised computer undetected.\n\nWhen executed, TerraTV drops several signed TeamViewer components into\nC:\\Users\\Public\\Public Documents\\57494E2D3850535046373333503532\\. The dropped\nfiles are shown in Figure 10.\n\n\n-----\n\n_Figure 10. TeamViewer files dropped by TerraTV_\n\nACTIVEDS.dll is not signed and it is where the malicious code resides. There is a Windows\nDLL with that same name in the system folder, but since the malicious DLL is in the same\ndirectory as the TeamViewer executable, it is found first, and therefore is loaded instead of\n[the Windows DLL. This is known as DLL search order hijacking. This ACTIVEDS.dll hooks](https://attack.mitre.org/techniques/T1038/)\nseveral API calls in the TeamViewer executable to hide the application’s tray icon and to\ncapture login credentials. The part of the code where the hooks are set is shown in Figure\n11.\n\n\n-----\n\n_Figure 11. Hooks set for TeamViewer_\n\nThe Windows API call DefWindowProcW (called several times by the TeamViewer\nexecutable to process messages directed to its main window) is hooked with a routine that\nwrites TeamViewer’s ID and password to the file %APPDATA%\\log_CZ72kGqTdU.txt. With\nthese credentials, and TeamViewer running with no visible tray icon or window, the\noperators of the malware can remotely control the computer, via its GUI, at any time.\n\n## Post-compromise toolset\n\nThe malicious components previously mentioned are frequently extended with several\nadditional tools in the Evilnum group’s arsenal. In most of the compromises we have seen,\nthe attackers utilized publicly available tools, but have also developed some custom scripts.\nUsually they keep their tools in password-protected archives on their servers and\ndecompress them on a victim’s PC as needed.\n\n\n-----\n\n### Python-based tools\n\nReverse shell over SSL script: A very short script that takes the server and port as\ncommand line arguments.\nSSL proxy that uses [PythonProxy,](https://code.google.com/archive/p/python-proxy/source/default/source) [junction,](https://docs.microsoft.com/en-us/sysinternals/downloads/junction) [plink and](https://www.putty.org/) [stunnel. It can also connect to](https://www.stunnel.org/)\nan FTP server or use [pysoxy. We have seen the script being used with the “proxy”](https://github.com/MisterDaneel/pysoxy)\nsetting and 185.62.189[.]210 as the server.\n[LaZagne to retrieve stored passwords](https://github.com/AlessandroZ/LaZagne/blob/master/Linux/laZagne.py)\n[IronPython along with libraries for taking screenshots, keylogging and recording](https://github.com/IronLanguages/ironpython2)\nDirectSound audio\n\n### Other publicly available tools\n\n[PowerShell scripts: for example, Bypass-UAC](https://github.com/FuzzySecurity/PowerShell-Suite/blob/master/Bypass-UAC/Bypass-UAC.ps1)\n[Several NirSoft utilities; for example, Mail PassView, to retrieve passwords from email](https://www.nirsoft.net/utils/mailpv.html)\nclients, and [ProduKey, to get Microsoft Office and Windows Licenses](https://www.nirsoft.net/utils/product_cd_key_viewer.html)\n\n## Conclusion\n\nThe Evilnum group has been operating for at least two years and was active at the time of\nthis writing. It has an infrastructure for its operations with several different servers: one for\ncommunications with the JS component, another for the C# component, a different one for\nstoring its tools and exfiltrated data, proxy server, and so on. This group targets fintech\ncompanies that provide trading and investment platforms for their customers. The targets\nare very specific and not numerous. This, and the group’s use of legitimate tools in its attack\nchain, have kept its activities largely under the radar. Thanks to our telemetry data we were\nable to join the dots and discover how the group operates, uncovering some overlaps with\nother known APT groups. We think this and other groups share the same MaaS provider,\nand the Evilnum group cannot yet be associated with any previous attacks by any other\nAPT group.\n\nA comprehensive list of Indicators of Compromise (IoCs) and samples can be found in our\nGitHub repository.\n\n_For any inquiries, or to make sample submissions related to the subject, contact us at_\n_threatintel@eset.com._\n\n_[Special thanks to Ignacio Sanmillan for his help with the analysis of the Golden Chickens](https://www.welivesecurity.com/author/isanmillan/)_\n_components._\n\n## MITRE ATT&CK techniques\n\n**Tactic** **ID** **Name** **Description**\n\n\n-----\n\n**Tactic** **ID** **Name** **Description**\n\n\nInitial\nAccess\n\n\n[T1192](https://attack.mitre.org/techniques/T1192/) Spearphishing Link Emails contain a link\nto download a\ncompressed file\nfrom an external\nserver.\n\n\nExecution [T1191](https://attack.mitre.org/techniques/T1191/) CMSTP cmstp.exe is used to\nexecute a remotely\nhosted scriptlet that\ndrops a malicious\nActiveX file.\n\n\n[T1059](https://attack.mitre.org/techniques/T1059/) Command-Line\nInterface\n\n[T1129](https://attack.mitre.org/techniques/T1129/) Execution through\nModule Load\n\n[T1061](https://attack.mitre.org/techniques/T1061/) Graphical User\nInterface\n\n\ncmd.exe is used to execute\ncommands and scripts.\n\nThe malicious payload for\nthe version 4.0 C#\ncomponent is loaded from\na DLL. TerraTV loads a\nmalicious DLL to enable\nsilent use of TeamViewer.\n\nTerraTV malware allows\nremote control using\nTeamViewer.\n\n\n[T1086](https://attack.mitre.org/techniques/T1086/) PowerShell Evilnum group executes\nLaZagne and other\nPowerShell scripts after\ntheir JS component has\ncompromised a target.\n\n[T1117](https://attack.mitre.org/techniques/T1117/) Regsvr32 Evilnum group uses\nregsvr32.exe to execute\ntheir Golden Chickens\ntools.\n\n[T1064](https://attack.mitre.org/techniques/T1064/) Scripting Initial compromise and\npost-compromise use\nseveral JavaScript, Python\nand PowerShell scripts.\n\n\n[T1218](https://attack.mitre.org/techniques/T1218/) Signed Binary Proxy\nExecution\n\n\nmsiexec.exe is used to\ninstall the malicious C#\ncomponent.\n\n\n[T1204](https://attack.mitre.org/techniques/T1204/) User Execution Victims are lured to open\nLNK files that will install a\nmalicious JS component.\n\n\n-----\n\n**Tactic** **ID** **Name** **Description**\n\n\n[T1047](https://attack.mitre.org/techniques/T1047/) Windows\nManagement\nInstrumentation\n\n[T1220](https://attack.mitre.org/techniques/T1220/) XSL Script\nProcessing\n\n\nWMI is used by the JS\ncomponent to obtain\ninformation such as which\nantivirus product is\ninstalled.\n\nMore_eggs malware uses\nmsxsl.exe to invoke JS\ncode from an XSL file.\n\n\nPersistence [T1060](https://attack.mitre.org/techniques/T1060/) Registry Run Keys /\nStartup Folder\n\n[T1108](https://attack.mitre.org/techniques/T1108/) Redundant Access Evilnum components are\nindependent and provide\nredundancy in case one of\nthem is detected and\nremoved.\n\n[T1179](https://attack.mitre.org/techniques/T1179/) Hooking TerraTV malware hooks\nseveral API calls in\nTeamViewer.\n\n\nRegistry Run keys\nare created in order\nto persist by the JS\nand C# components,\nas well as\nMore_eggs\n\nTerraTV malware\nhas TeamViewer\nload a malicious\nDLL placed in the\nTeamViewer\ndirectory, instead of\nthe original Windows\nDLL located in a\nsystem folder.\n\n\nDefense\nEvasion\n\n\n[T1038](https://attack.mitre.org/techniques/T1038/) DLL Search Order\nHijacking\n\n\n[T1088](https://attack.mitre.org/techniques/T1088/) Bypass User Access\nControl\n\n\nA PowerShell script is used\nto bypass UAC.\n\n\n[T1116](https://attack.mitre.org/techniques/T1116/) Code Signing Some of the Golden\nChickens components are\nmalicious signed\nexecutables. Also, Evilnum\ngroup uses legitimate\n(signed) applications such\nas cmstp.exe or msxsl.exe\nas a defense evasion\nmechanism.\n\n\n-----\n\n**Tactic** **ID** **Name** **Description**\n\n[T1090](https://attack.mitre.org/techniques/T1090/) Connection Proxy Connection to a proxy\nserver is set up with postcompromise scripts.\n\n\n[T1140](https://attack.mitre.org/techniques/T1140/) Deobfuscate/Decode\nFiles or Information\n\n\nEncryption, encoding and\nobfuscation are used in\nmany Evilnum malware\ncomponents.\n\n\n[T1107](https://attack.mitre.org/techniques/T1107/) File Deletion Both JS and C#\ncomponents delete\ntemporary files and folders\ncreated during the initial\ncompromise.\n\n[T1143](https://attack.mitre.org/techniques/T1143/) Hidden Window TerraTV runs TeamViewer\nwith its window and tray\nicon hidden.\n\n[T1036](https://attack.mitre.org/techniques/T1036/) Masquerading The C# component has its\npayload in\nsystem.memmory.dll,\nwhich masquerades as a\nbenign .NET Framework\nDLL.\n\n[T1112](https://attack.mitre.org/techniques/T1112/) Modify Registry Evilnum modifies the\nregistry for different\npurposes, mainly to persist\nin a compromised system\n(for example, by using a\nregistry's Run key).\n\n\n[T1027](https://attack.mitre.org/techniques/T1027/) Obfuscated Files or\nInformation\n\n[T1497](https://attack.mitre.org/techniques/T1497/) Virtualization/Sandbox\nEvasion\n\n\nEncryption, encoding and\nobfuscation is used in\nmany Evilnum malware\ncomponents.\n\nThe Golden Chickens\ncomponents implement\nseveral integrity checks\nand evasion techniques.\n\n\nCredential\nAccess\n\n\n[T1003](https://attack.mitre.org/techniques/T1003/) Credential Dumping Scripts and tools\nsuch as LaZagne\nare used to retrieve\nstored credentials.\n\n\n-----\n\n**Tactic** **ID** **Name** **Description**\n\n\n[T1503](https://attack.mitre.org/techniques/T1503/) Credentials from Web\nBrowsers\n\n\nThe C# component\nretrieves stored passwords\nfrom Chrome.\n\n\n[T1056](https://attack.mitre.org/techniques/T1056/) Input Capture Custom Python scripts\nhave been used for\nkeylogging.\n\n\n[T1539](https://attack.mitre.org/techniques/T1539/) Steal Web Session\nCookie\n\n\nEvilnum malware steals\ncookies from Chrome.\n\n\nDiscovery [T1012](https://attack.mitre.org/techniques/T1012/) Query Registry More_eggs queries\nthe registry to know\nif the user has\nadmin privileges.\n\n\n[T1063](https://attack.mitre.org/techniques/T1063/) Security Software\nDiscovery\n\n\nBoth the JS and C#\ncomponents search for\ninstalled antivirus software.\n\n\n[T1518](https://attack.mitre.org/techniques/T1518/) Software Discovery TerraStealer malware looks\nfor specific applications.\n\n\n[T1082](https://attack.mitre.org/techniques/T1082/) System Information\nDiscovery\n\n\nInformation about the\nsystem is sent to the C&C\nservers.\n\n\nCollection [T1074](https://attack.mitre.org/techniques/T1074/) Data Staged Data is stored in a\ntemporary location\nbefore it is sent to\nthe C&C.\n\n\n[T1005](https://attack.mitre.org/techniques/T1005/) Data from Local\nSystem\n\n\nThe JS component (v2.1)\nhas code to exfiltrate Excel\nfiles from the local system.\n\n\n[T1114](https://attack.mitre.org/techniques/T1114/) Email Collection TerraStealer malware\ntargets email applications.\n\n[T1056](https://attack.mitre.org/techniques/T1056/) Input Capture Keystrokes are logged with\na Python script.\n\n[T1113](https://attack.mitre.org/techniques/T1113/) Screen Capture Screenshots are taken by\nsome Evilnum malware\ncomponents.\n\n\nCommand\nand Control\n\n\n[T1043](https://attack.mitre.org/techniques/T1043/) Commonly Used Port HTTP and HTTPS\nare used for C&C\ncommunication.\n\n\n-----\n\n**Tactic** **ID** **Name** **Description**\n\n[T1132](https://attack.mitre.org/techniques/T1132/) Data Encoding Some of the data sent to\nthe C&C is base64encoded.\n\n[T1008](https://attack.mitre.org/techniques/T1008/) Fallback Channels The JS and C#\ncomponents can obtain a\nnew C&C by parsing thirdparty webpages if the\noriginal C&C is down.\n\n[T1104](https://attack.mitre.org/techniques/T1104/) Multi-Stage Channels Evilnum malware uses\nindependent C&C servers\nfor its various components.\n\n[T1219](https://attack.mitre.org/techniques/T1219/) Remote Access Tools TerraTV malware uses\nTeamViewer to give control\nof the compromised\ncomputer to the attackers.\n\n[T1105](https://attack.mitre.org/techniques/T1105/) Remote File Copy Files are uploaded\nto/downloaded from a C&C\nserver.\n\n\n[T1071](https://attack.mitre.org/techniques/T1071/) Standard Application\nLayer Protocol\n\n[T1032](https://attack.mitre.org/techniques/T1032/) Standard\nCryptographic\nProtocol\n\n\nHTTP and HTTPS are\nused for C&C.\n\nMore_eggs malware uses\nRC4 to encrypt data to be\nsent to the C&C.\n\n\n[T1102](https://attack.mitre.org/techniques/T1102) Web Service GitHub, GitLab, Reddit and\nother websites are used to\nstore C&C server\ninformation.\n\nExfiltration [T1022](https://attack.mitre.org/techniques/T1022/) Data Encrypted Some Evilnum\ncomponents encrypt\ndata before sending\nit to the C&C.\n\n\n[T1048](https://attack.mitre.org/techniques/T1048/) Exfiltration Over\nAlternative Protocol\n\n[T1041](https://attack.mitre.org/techniques/T1041/) Exfiltration Over\nCommand and\nControl Channel\n\n9 Jul 2020 - 11:30AM\n\n\nScripts are manually\ndeployed by the malware\noperators to send data to\nan FTP server.\n\nData is exfiltrated over the\nsame channel used for\nC&C.\n\n\n-----\n\n### Sign up to receive an email update whenever a new article is published in our Ukraine Crisis – Digital Security Resource Center\n\n Newsletter\n\n Discussion\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2020/2020-07-09 - More evil- A deep look at Evilnum and its toolset.pdf"
    ],
    "report_names": [
        "2020-07-09 - More evil- A deep look at Evilnum and its toolset.pdf"
    ],
    "threat_actors": [
        {
            "id": "059b16f8-d4e0-4399-9add-18101a2fd298",
            "created_at": "2022-10-25T15:50:23.29434Z",
            "updated_at": "2025-03-27T02:00:55.431907Z",
            "deleted_at": null,
            "main_name": "Evilnum",
            "aliases": [
                "Evilnum"
            ],
            "source_name": "MITRE:Evilnum",
            "tools": [
                "More_eggs",
                "EVILNUM",
                "LaZagne"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "39ea99fb-1704-445d-b5cd-81e7c99d6012",
            "created_at": "2022-10-25T16:07:23.601894Z",
            "updated_at": "2025-03-27T02:02:09.882982Z",
            "deleted_at": null,
            "main_name": "Evilnum",
            "aliases": [
                "Jointworm",
                "Operation Phantom in the [Command] Shell",
                "TA4563"
            ],
            "source_name": "ETDA:Evilnum",
            "tools": [
                "Bypass-UAC",
                "Cardinal RAT",
                "ChromeCookiesView",
                "EVILNUM",
                "Evilnum",
                "IronPython",
                "LaZagne",
                "MailPassView",
                "More_eggs",
                "ProduKey",
                "PyVil",
                "PyVil RAT",
                "SONE",
                "SpicyOmelette",
                "StealerOne",
                "Taurus Loader Stealer Module",
                "Taurus Loader TeamViewer Module",
                "Terra Loader",
                "TerraPreter",
                "TerraStealer",
                "TerraTV"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "610a7295-3139-4f34-8cec-b3da40add480",
            "created_at": "2023-01-06T13:46:38.608142Z",
            "updated_at": "2025-03-27T02:00:02.87217Z",
            "deleted_at": null,
            "main_name": "Cobalt",
            "aliases": [
                "Cobalt Gang",
                "GOLD KINGSWOOD",
                "COBALT SPIDER",
                "G0080",
                "Mule Libra",
                "Cobalt Group"
            ],
            "source_name": "MISPGALAXY:Cobalt",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "7a257844-df90-4bd4-b0f1-77d00ff82802",
            "created_at": "2022-10-25T16:07:24.376356Z",
            "updated_at": "2025-03-27T02:02:10.199451Z",
            "deleted_at": null,
            "main_name": "Venom Spider",
            "aliases": [
                "Golden Chickens",
                "Venom Spider"
            ],
            "source_name": "ETDA:Venom Spider",
            "tools": [
                "More_eggs",
                "PureLocker",
                "SONE",
                "SpicyOmelette",
                "StealerOne",
                "Taurus Builder",
                "Taurus Builder Kit",
                "Taurus Loader",
                "Taurus Loader Reconnaissance Module",
                "Taurus Loader Stealer Module",
                "Taurus Loader TeamViewer Module",
                "Terra Loader",
                "TerraCrypt",
                "TerraPreter",
                "TerraRecon",
                "TerraStealer",
                "TerraTV",
                "TerraWiper",
                "ThreatKit",
                "VenomKit",
                "VenomLNK",
                "lite_more_eggs"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "88802a4b-5b3d-42ee-99e6-8a4f5fd231f6",
            "created_at": "2023-01-06T13:46:38.851345Z",
            "updated_at": "2025-03-27T02:00:02.935087Z",
            "deleted_at": null,
            "main_name": "GC01",
            "aliases": [
                "Golden Chickens",
                "Golden Chickens01",
                "Golden Chickens 01"
            ],
            "source_name": "MISPGALAXY:GC01",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "2dfaa730-7079-494c-b2f0-3ff8f3598a51",
            "created_at": "2022-10-25T16:07:23.474746Z",
            "updated_at": "2025-03-27T02:02:09.822683Z",
            "deleted_at": null,
            "main_name": "Cobalt Group",
            "aliases": [
                "ATK 67",
                "Cobalt Gang",
                "Cobalt Spider",
                "Gold Kingswood",
                "Mule Libra",
                "TAG-CR3"
            ],
            "source_name": "ETDA:Cobalt Group",
            "tools": [
                "ATMRipper",
                "ATMSpitter",
                "Agentemis",
                "AmmyyRAT",
                "AtNow",
                "COOLPANTS",
                "CobInt",
                "Cobalt Strike",
                "CobaltStrike",
                "Cyst Downloader",
                "Fareit",
                "FlawedAmmyy",
                "Formbook",
                "Little Pig",
                "Metasploit Stager",
                "Mimikatz",
                "More_eggs",
                "NSIS",
                "Nullsoft Scriptable Install System",
                "Pony Loader",
                "Ripper ATM",
                "SDelete",
                "Siplog",
                "SoftPerfect Network Scanner",
                "SpicyOmelette",
                "Taurus Builder",
                "Taurus Builder Kit",
                "Taurus Loader",
                "Terra Loader",
                "ThreatKit",
                "VenomKit",
                "cobeacon",
                "win.xloader"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "ee3363a4-e807-4f95-97d8-b603c31b9de1",
            "created_at": "2023-01-06T13:46:38.485884Z",
            "updated_at": "2025-03-27T02:00:02.845851Z",
            "deleted_at": null,
            "main_name": "FIN6",
            "aliases": [
                "Camouflage Tempest",
                "MageCart Group 6",
                "G0037",
                "TA4557",
                "SKELETON SPIDER",
                "ITG08",
                "White Giant",
                "GOLD FRANKLIN",
                "ATK88"
            ],
            "source_name": "MISPGALAXY:FIN6",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "f5c90ccc-0f18-4e07-a246-b62101ab2f6f",
            "created_at": "2023-01-06T13:46:38.854407Z",
            "updated_at": "2025-03-27T02:00:02.935908Z",
            "deleted_at": null,
            "main_name": "GC02",
            "aliases": [
                "Golden Chickens",
                "Golden Chickens02",
                "Golden Chickens 02"
            ],
            "source_name": "MISPGALAXY:GC02",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "12517c87-040a-4627-a3df-86ca95e5c13f",
            "created_at": "2022-10-25T16:07:23.61665Z",
            "updated_at": "2025-03-27T02:02:09.889471Z",
            "deleted_at": null,
            "main_name": "FIN6",
            "aliases": [
                "ATK 88",
                "Camouflage Tempest",
                "FIN6",
                "Gold Franklin",
                "ITG08",
                "Skeleton Spider",
                "TAAL",
                "TAG-CR2",
                "White Giant"
            ],
            "source_name": "ETDA:FIN6",
            "tools": [
                "AbaddonPOS",
                "Agentemis",
                "AmmyyRAT",
                "Anchor_DNS",
                "BlackPOS",
                "CmdSQL",
                "Cobalt Strike",
                "CobaltStrike",
                "FlawedAmmyy",
                "FrameworkPOS",
                "Grateful POS",
                "JSPSPY",
                "Kaptoxa",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "LockerGoga",
                "MMon",
                "Magecart",
                "Meterpreter",
                "Mimikatz",
                "More_eggs",
                "NeverQuest",
                "POSWDS",
                "Reedum",
                "Ryuk",
                "SCRAPMINT",
                "SONE",
                "SpicyOmelette",
                "StealerOne",
                "Taurus Loader Stealer Module",
                "Terra Loader",
                "TerraStealer",
                "Vawtrak",
                "WCE",
                "Windows Credential Editor",
                "Windows Credentials Editor",
                "cobeacon",
                "grabnew"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "8ce861d7-7fbd-4d9c-a211-367c118bfdbd",
            "created_at": "2023-01-06T13:46:39.153487Z",
            "updated_at": "2025-03-27T02:00:03.009422Z",
            "deleted_at": null,
            "main_name": "Evilnum",
            "aliases": [
                "TA4563",
                "EvilNum",
                "Jointworm",
                "KNOCKOUT SPIDER",
                "DeathStalker"
            ],
            "source_name": "MISPGALAXY:Evilnum",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "b3acfb48-b04d-4d3d-88a8-836d7376fa2e",
            "created_at": "2024-06-19T02:03:08.052814Z",
            "updated_at": "2025-03-27T02:05:17.368029Z",
            "deleted_at": null,
            "main_name": "GOLD FRANKLIN",
            "aliases": [
                "ITG08 ",
                "MageCart Group 6 ",
                "Skeleton Spider ",
                "White Giant ",
                "FIN6 "
            ],
            "source_name": "Secureworks:GOLD FRANKLIN",
            "tools": [
                " Metasploit",
                " Meterpreter",
                " Mimikatz",
                " PowerSploit",
                " PowerUpSQL",
                " RemCom",
                "FrameWorkPOS"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "ea7bfe06-7c23-481d-b8ba-eafa6cda3bc9",
            "created_at": "2022-10-25T15:50:23.317961Z",
            "updated_at": "2025-03-27T02:00:55.440858Z",
            "deleted_at": null,
            "main_name": "FIN6",
            "aliases": [
                "FIN6",
                "Magecart Group 6",
                "ITG08",
                "Skeleton Spider",
                "TAAL",
                "Camouflage Tempest"
            ],
            "source_name": "MITRE:FIN6",
            "tools": [
                "FlawedAmmyy",
                "GrimAgent",
                "FrameworkPOS",
                "More_eggs",
                "Cobalt Strike",
                "Windows Credential Editor",
                "AdFind",
                "PsExec",
                "LockerGoga",
                "Ryuk",
                "Mimikatz"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "c11abba0-f5e8-4017-a4ee-acb1a7c8c242",
            "created_at": "2022-10-25T15:50:23.744036Z",
            "updated_at": "2025-03-27T02:00:55.537114Z",
            "deleted_at": null,
            "main_name": "Cobalt Group",
            "aliases": [
                "Cobalt Group",
                "GOLD KINGSWOOD",
                "Cobalt Gang",
                "Cobalt Spider"
            ],
            "source_name": "MITRE:Cobalt Group",
            "tools": [
                "Mimikatz",
                "More_eggs",
                "SpicyOmelette",
                "SDelete",
                "Cobalt Strike",
                "PsExec"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1673535852,
    "ts_updated_at": 1743041768,
    "ts_creation_date": 1653759732,
    "ts_modification_date": 1653759732,
    "files": {
        "pdf": "https://archive.orkl.eu/499c42946d62bb50833f458e7dee871638a52970.pdf",
        "text": "https://archive.orkl.eu/499c42946d62bb50833f458e7dee871638a52970.txt",
        "img": "https://archive.orkl.eu/499c42946d62bb50833f458e7dee871638a52970.jpg"
    }
}