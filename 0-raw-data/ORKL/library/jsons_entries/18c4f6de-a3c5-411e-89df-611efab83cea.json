{
    "id": "18c4f6de-a3c5-411e-89df-611efab83cea",
    "created_at": "2023-01-12T15:00:37.254975Z",
    "updated_at": "2025-03-27T02:05:59.558349Z",
    "deleted_at": null,
    "sha1_hash": "52f54db4b994277cbf6c1f5f4e76b5ea873c4b6c",
    "title": "2019-02-13 - Analyzing Amadey – a simple native malware",
    "authors": "",
    "file_creation_date": "2022-05-28T04:06:09Z",
    "file_modification_date": "2022-05-28T04:06:09Z",
    "file_size": 246305,
    "plain_text": "# Analyzing Amadey – a simple native malware\n\n**[krabsonsecurity.com/2019/02/13/analyzing-amadey-a-simple-native-malware/](https://krabsonsecurity.com/2019/02/13/analyzing-amadey-a-simple-native-malware/)**\n\n[Posted on February 13, 2019](https://krabsonsecurity.com/2019/02/13/)\nApparently there is a new Russian botnet floating around by the name of Amadey. Despite\nthe very high price tag on Russian forums, it is a very simplistic bot that is quite honestly\npoorly made.\n\nSHA-1: B7235E2981456D29412AD935BDBCA140B6AD0151\n\nCompiler info (from ExeInfo PE): Microsoft Visual C++ ver 5.0/6.0\n\n_Sample given by a friend._\n\nThe payload was not spreaded directly but rather was packed with a crypter. The crypter\nseems to be TitanCrypt, based on the storage method (appended section which contains\nthe payload which was encrypted and then base64 encoded). The crypter’s code is\nencrypted using a self-decryptor as well as heavily obfuscated, and is executed by using\nwindows API callbacks.\n\n_The code being passed as a callback function_\nThe code is put into a layer of self decryption loop, after which we jump into a very\nobfuscated region of code. After some (and by some I mean a lot) of manual analysis, the\nimportant code where the payload is decrypted is identified.\n\n\n-----\n\nThe decryption call:\n\n\n-----\n\nThe code decryption call\n\n\n-----\n\nAfter the call\nStepping over the call, we see the region decrypted rather clearly. Dumping this, we get the\nactual payload.\n\nSHA1: 3E4CD703DEEF2CFD1726095987766E2F062E9C57\n\nCompiler info: FreeBASIC Compiler v0.14 – 0.17\n\nThe malware in question is “Amadey”, a new bot that is sold on a Russian forum. Link to\nthread content in Russian. It goes for $600 for a license, and for the high price cap the\nauthor is extra nice in his customer service – he delivered the symbols for us within the\nbinary, allowing reverse engineers to inspect it with great ease : )\n\nMain function\n\n\n-----\n\nUAC bypass just runs\n\nself as admin…\n\nTerrible permission check by creating a file in a privileged folder\nStartup is added by executing the command “REG ADD\n“HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\User Shell Folders” /f /v\nStartup /t REG_SZ /d path_to_folder_containing_the_file”\n\n\n-----\n\nThe bot is not too interesting, it is in fact very simplistic. I would write more about the bot\nbut…there is nothing else to write about. The programmer was nice enough to ship the file\nwith symbols for us, making things a lot easier and in the process of doing so defeated the\npoint of him encrypting strings. All files are available on virustotal and virusbay as usual.\n\nView Comments ...\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2019/2019-02-13 - Analyzing Amadey – a simple native malware.pdf"
    ],
    "report_names": [
        "2019-02-13 - Analyzing Amadey – a simple native malware.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673535637,
    "ts_updated_at": 1743041159,
    "ts_creation_date": 1653710769,
    "ts_modification_date": 1653710769,
    "files": {
        "pdf": "https://archive.orkl.eu/52f54db4b994277cbf6c1f5f4e76b5ea873c4b6c.pdf",
        "text": "https://archive.orkl.eu/52f54db4b994277cbf6c1f5f4e76b5ea873c4b6c.txt",
        "img": "https://archive.orkl.eu/52f54db4b994277cbf6c1f5f4e76b5ea873c4b6c.jpg"
    }
}