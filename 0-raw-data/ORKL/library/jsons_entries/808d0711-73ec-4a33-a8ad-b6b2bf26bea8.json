{
    "id": "808d0711-73ec-4a33-a8ad-b6b2bf26bea8",
    "created_at": "2023-01-12T14:59:17.082715Z",
    "updated_at": "2025-03-27T02:06:01.800186Z",
    "deleted_at": null,
    "sha1_hash": "afe39fc183b931b338d8519e449d94a5916fee06",
    "title": "2017-07-14 - Keeping up with the Petyas- Demystifying the malware family",
    "authors": "",
    "file_creation_date": "2022-05-28T04:56:39Z",
    "file_modification_date": "2022-05-28T04:56:39Z",
    "file_size": 415559,
    "plain_text": "# Keeping up with the Petyas: Demystifying the malware family\n\n**[blog.malwarebytes.com/cybercrime/2017/07/keeping-up-with-the-petyas-demystifying-the-malware-family/](https://blog.malwarebytes.com/cybercrime/2017/07/keeping-up-with-the-petyas-demystifying-the-malware-family/)**\n\nMalwarebytes Labs July 14, 2017\n\n[Last June 27, there was a huge outbreak of a Petya-esque malware with WannaCry-style](https://blog.malwarebytes.com/cybercrime/2017/06/petya-esque-ransomware-is-spreading-across-the-world/)\ninfector in the Ukraine.\n\nSince there is still confusion about how exactly this malware is linked to the original Petya,\nwe have prepared this small guide on the background of the Petya family.\n\n## The origin of Petya\n\nThe first Petya ransomware was released around March 2016 by a person/group calling\nthemselves Janus Cybercrime Solutions. This group was advertising their affiliate program,\ngiving other criminals a chance to distribute their malware. Janus Cybercrime Solutions was\n[represented also on Twitter by appropriate accounts, first by @janussec, and then by](https://twitter.com/janussec)\n[@JanusSecretary.](https://twitter.com/JanusSecretary)\n\n[The names “Janus” and “Petya” were inspired by the James Bond movie, GoldenEye. The](http://www.imdb.com/title/tt0113189/)\nthreat actor was consistent with the chosen theme, too—the profile picture of the linked\nTwitter account was from one of the characters of the movie, a computer programmer/hacker\nnamed [Boris Grishenko.](http://jamesbond.wikia.com/wiki/Boris_Grishenko)\n\n\n-----\n\n## Unique features\n\n[From the very beginning, Petya has been a unique ransomware because it has features that](https://www.malwarebytes.com/ransomware)\nare not common for this type of malware. While most of the ransomware can only encrypt\nfiles one by one, Petya denies users access to the full system by attacking low-level\nstructures on the disk.\n\nPetya is always installed by some dropper, which is a Windows executable (on each version\nof Petya the dropper is replaced with a new one).\n\nDuring installation, the Petya installer overwrites the disk with Petya’s kernel and boot loader.\nBecause of this, the affected machine boots the malicious kernel instead of the legitimate\nOS. On the first run, it displays a fake CHKDSK screen:\n\n\n-----\n\nInstead of checking the disk, in reality, it encrypts the [Master File Table (MFT) with Salsa20.](https://en.wikipedia.org/wiki/NTFS#Master_File_Table)\nThis way, the ransomware makes the disk inaccessible. When encryption is finished, two\nscreens are displayed: a blinking skull followed by the ransom demand. This is how affected\nsystem screens look like in the first version of Petya:\n\n## Official releases\n\n\n-----\n\nSo far, there are 4 releases of Petya ransomware by its original author, Janus:\n\n[1.0 (Red Petya) – Attacks only MFT](https://blog.malwarebytes.com/threat-analysis/2016/04/petya-ransomware/)\n[2.0 (Green Petya + Mischa) – Attacks either the MFT or files (a variant of the attack](https://blog.malwarebytes.com/threat-analysis/2016/05/petya-and-mischa-ransomware-duet-p1/)\ndepends on the privileges with which the sample was deployed)\n2.5 (Green Petya + Mischa) – Same as 2.0 but with improvements\n[3.0 (Goldeneye) – Attacks both the MFT and files, using UAC bypass to auto-elevate](https://blog.malwarebytes.com/threat-analysis/2016/12/goldeneye-ransomware-the-petyamischa-combo-rebranded/)\nits privileges\n\nRecently, Janus released the master key that can unlock all official versions described\n[above. You can read more about it in this blog post.](https://blog.malwarebytes.com/cybercrime/2017/07/the-key-to-the-old-petya-has-been-published-by-the-malware-author/?utm_source=blog&utm_medium=social)\n\nThese Petya releases can be identified by the theme colors. We’ve put together a small\ngallery below:\n\n**Red Petya**\n\n\n-----\n\n**Green Petya**\n\n\n-----\n\n**GoldenEye**\n\n\n-----\n\nGoldenEye was the latest official release of Petya and was last seen around December\n2016.\n\n## Unofficial releases (pirated versions)\n\nSince Petya is powerful, other cybercriminals have been attracted to use it. However, not all\nof them want to join the affiliate program and pay its creator. Similar to legitimate software,\nPetya has pirated versions. So far, we observed two unofficial releases:\n\n[PetrWrap – uses Petya’s low-level component as well as patched Petya’s DLL,](https://securelist.com/petrwrap-the-new-petya-based-ransomware-used-in-targeted-attacks/77762/)\nwrapped by a new loader. It’s based on Green Petya.\n[EternalPetya – also called NotPetya, ExPetr, etc. The malware](https://blog.malwarebytes.com/threat-analysis/2017/06/eternalpetya-yet-another-stolen-piece-package/) [based on GoldenEye,](https://blog.malwarebytes.com/threat-analysis/2017/06/eternalpetya-yet-another-stolen-piece-package/)\nused in the attack on Ukraine. The high-level layer (PE file) has been rewritten.\n\nThe pirated versions can be identified by the modified look. In both cases, the original\nPetya’s skull has been removed.\n\n**PetrWrap**\n\n\n-----\n\n**EternalPetya**\n\nWhile PetrWrap was a fully-functional ransomware, EternalPetya seems unfinished or broken\n[on purpose because the Salsa key that used to encrypt the MFT cannot be recovered. Once](https://blog.malwarebytes.com/threat-analysis/2017/06/eternalpetya-lost-salsa20-key/)\nencrypted, data cannot be decrypted, even by the malware authors.\n\n\n-----\n\nSame as the original GoldenEye, EternalPetya encrypts also files with the selected\nextensions before attacking the MFT. Files are encrypted using different algorithms and keys\nthan the MFT (RSA + AES, while the MFT is encrypted using Salsa20). On July 4, the\ndistributors of EternalPetya raised the ransom demand and offered to sell the private RSA\nkey that can potentially help in unlocking encrypted files but not the MFT. Below is the\n[message from the attackers [source]:](https://depastedihrn3jtw.onion.link/show.php?md5=21d0a98b38765e1619868fb098f9833d)\n\n## Copycats\n\nIn addition to malware based on the original Petya, copycats also have started to appear.\nThey have nothing in common with Petya’s code, they only try to imitate its look or some of\n[its features. Some examples are SatanaRansomware or Petya+,](https://blog.malwarebytes.com/threat-analysis/2016/06/satana-ransomware/) [a .NET imitation of Petya](https://twitter.com/LawrenceAbrams/status/884591247087816704)\n[discovered by @LawrenceAbrams.](https://twitter.com/LawrenceAbrams/status/884591247087816704)\n\n## Conclusion\n\nRansomware piracy is becoming common and this triggers more problems to the victims.\nOften, the authors of such pirated malware don’t care to give the data back. They just use\nthe reputation of known ransomware to scam victims into paying. In addition to the described\n[cases, we have also encountered several versions of pirated DMALocker, wherein some of](https://blog.malwarebytes.com/cybercrime/malware/2017/05/stolen-version-dma-locker-making-rounds/)\nthe variants corrupt the data that make recovery hard or even impossible.\n\nPetya is a powerful malware. And to make things worse, it is also very easy to modify and\nrepurpose. Even if the official line of Petya has been discontinued, we can expect the pirated\nversions to still be around.\n\n_This was a guest post written by Hasherezade, an independent researcher and programmer_\n_with a strong interest in InfoSec. She loves going in details about malware and sharing threat_\n_[information with the community. Check her out on Twitter @hasherezade and her personal](https://twitter.com/hasherezade)_\n_[blog: https://hshrzd.wordpress.com.](https://hshrzd.wordpress.com/)_\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2017/2017-07-14 - Keeping up with the Petyas- Demystifying the malware family.pdf"
    ],
    "report_names": [
        "2017-07-14 - Keeping up with the Petyas- Demystifying the malware family.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673535557,
    "ts_updated_at": 1743041161,
    "ts_creation_date": 1653713799,
    "ts_modification_date": 1653713799,
    "files": {
        "pdf": "https://archive.orkl.eu/afe39fc183b931b338d8519e449d94a5916fee06.pdf",
        "text": "https://archive.orkl.eu/afe39fc183b931b338d8519e449d94a5916fee06.txt",
        "img": "https://archive.orkl.eu/afe39fc183b931b338d8519e449d94a5916fee06.jpg"
    }
}