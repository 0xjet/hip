{
    "id": "965c7488-9890-4c16-b9d6-ce146798510d",
    "created_at": "2023-01-12T15:06:51.341171Z",
    "updated_at": "2025-03-27T02:05:50.092368Z",
    "deleted_at": null,
    "sha1_hash": "57cbbb5b60820cba1767a580a2ed9bffafee34e5",
    "title": "2013-01-24 - Linux-SSHDoor.A Backdoored SSH daemon that steals passwords",
    "authors": "",
    "file_creation_date": "2022-05-28T00:24:06Z",
    "file_modification_date": "2022-05-28T00:24:06Z",
    "file_size": 631185,
    "plain_text": "# Linux/SSHDoor.A Backdoored SSH daemon that steals passwords\n\n**[welivesecurity.com/2013/01/24/linux-sshdoor-a-backdoored-ssh-daemon-that-steals-passwords/](https://www.welivesecurity.com/2013/01/24/linux-sshdoor-a-backdoored-ssh-daemon-that-steals-passwords/)**\n\nJanuary 24, 2013\n\nIn his summary of New Year predictions by security researchers here at ESET, Stephen\nCobb pointed to expanded efforts by malware authors to target the Linux operating system.\nLooks like that might be right: A blog post published by Sucuri yesterday describes a\nbackdoored version of the SSH daemon discovered on compromised servers. Interestingly,\nthis\n\n24 Jan 2013 - 12:54PM\n\nIn his summary of New Year predictions by security researchers here at ESET, Stephen\nCobb pointed to expanded efforts by malware authors to target the Linux operating system.\nLooks like that might be right: A blog post published by Sucuri yesterday describes a\nbackdoored version of the SSH daemon discovered on compromised servers. Interestingly,\nthis\n\n\n-----\n\nIn his summary of New Year predictions by security researchers here at ESET, Stephen\n[Cobb pointed to expanded efforts by malware authors to target the Linux operating system.](https://www.welivesecurity.com/2013/01/03/2013-forecast-malware-scams-security-and-privacy-concerns)\n[Looks like that might be right: A blog post published by Sucuri yesterday describes a](http://blog.sucuri.net/2013/01/server-side-iframe-injections-via-apache-modules-and-sshd-backdoor.html)\nbackdoored version of the SSH daemon discovered on compromised servers. Interestingly,\n[this backdoor was used in conjunction with the malicious Apache module Linux/Chapro.A](https://www.welivesecurity.com/2012/12/18/malicious-apache-module-used-for-content-injection-linuxchapro-a)\nthat we blogged about recently.\n\nThe Secure Shell Protocol (SSH) is a very popular protocol used for secure data\ncommunication. It is widely used in the Unix world to manage remote servers, transfer files,\netc. The modified SSH daemon described here, Linux/SSHDoor.A, is designed to steal\n**usernames and passwords and allows remote access to the server via either an**\nhardcoded password or SSH key.\n\nThe strings related to the hidden behaviors are XOR encoded. This is done to avoid easy\nidentification by searching the binary for suspicious strings. We identified a total of 16\nencoded strings. The figure below shows the part of the code responsible for decoding the\nhidden data by xoring it with the constant 0x23.\n\nThe HTTP protocol is used to send stolen data to a remote server. The information is first\nencrypted using a 1024-bit RSA key stored in the binary and then Base64 encoded. The\ndata is sent via an HTTP POST request to the server used for data exfiltration.\n\n\n-----\n\nThe binary we analyzed contains two hostnames for servers used to collect data:\nopenssh.info and linuxrepository.org. Both names were probably chosen to avoid raising\nsuspicions from the administrators of the compromised servers. At this point in time, both\nhostnames point to a server hosted in Iceland with IP 82.221.99.69.\n\nWhen the daemon is started, the backdoor sends the IP and port on which the service is\nrunning and the hostname of the server.\n\nWhenever a user successfully logs onto the compromised server, the username and\npassword are also sent to the remote server.\n\n\n-----\n\nIn addition to stealing credentials, the backdoor guarantees persistence on the\ncompromised host for the attacker in two different ways. First, it has a hard-coded password\ninserted in the code. If any user logs in using this password, he is automatically granted\naccess to the compromised server. The following figure shows the string comparison\nbetween the password provided by a user trying to log in and the hardcoded password.\n\nSecond, the modified binary also carries an SSH key. If a user logs into the server with the\nprivate key corresponding to the hard-coded public key, he is automatically granted access.\n\nThe backdoor can also retrieve configuration data from the file /var/run/.options. If this file\nexists the backdoor will use the hostname, backdoor password and SSH key stored in it.\nThe variables are stored one per line in cleartext.\n\nAs with Linux/Chapro.A, it is hard to tell how this Trojanized SSH daemon made its way on\na compromised server but outdated applications or weak passwords are probably to blame.\nFinding backdoored files can be problematic for most system administrators. We\nrecommend regular use of integrity checking tools plus monitoring of outgoing network\nconnections and regular scanning of all files by an antivirus product. This threat is detected\nby ESET as Linux/SSHDoor.A.\n\nSpecial thanks to Peter Kosinar, Pierre-Marc Bureau, and Olivier Bilodeau for their help.\n\n\n-----\n\nAnalyzed sample MD5 hash: 90dc9de5f93b8cc2d70a1be37acea23a\n\n24 Jan 2013 - 12:54PM\n\n## Sign up to receive an email update whenever a new article is published in our Ukraine Crisis â€“ Digital Security Resource Center\n\n Newsletter\n\n Discussion\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2013/2013-01-24 - Linux-SSHDoor.A Backdoored SSH daemon that steals passwords.pdf"
    ],
    "report_names": [
        "2013-01-24 - Linux-SSHDoor.A Backdoored SSH daemon that steals passwords.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673536011,
    "ts_updated_at": 1743041150,
    "ts_creation_date": 1653697446,
    "ts_modification_date": 1653697446,
    "files": {
        "pdf": "https://archive.orkl.eu/57cbbb5b60820cba1767a580a2ed9bffafee34e5.pdf",
        "text": "https://archive.orkl.eu/57cbbb5b60820cba1767a580a2ed9bffafee34e5.txt",
        "img": "https://archive.orkl.eu/57cbbb5b60820cba1767a580a2ed9bffafee34e5.jpg"
    }
}