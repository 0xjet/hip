{
    "id": "c368f49e-4ae2-430f-b9a5-92a81eeac311",
    "created_at": "2022-10-25T16:48:24.433709Z",
    "updated_at": "2025-03-27T02:05:46.660894Z",
    "deleted_at": null,
    "sha1_hash": "bc85a305011865d631c741a7583fa7e352fb81cd",
    "title": "",
    "authors": "",
    "file_creation_date": "2020-01-29T12:36:35Z",
    "file_modification_date": "2020-01-29T12:36:43Z",
    "file_size": 7070509,
    "plain_text": "**SECURITY RESEARCH REPORT**\n\n# Monokle\n\n#### The Mobile Surveillance Tooling of the Special Technology Center\n\n###### July 2019\n\n\n-----\n\n### Contents\n\n##### Executive Summary 3\n\n Key Findings 4\n\n Monokle Mobile Surveillanceware 5\n\n**Observed samples** 5\n\n**Potential targets** 6\n\n**Malicious functionality** 7\n\n**Evidence of iOS components** 11\n\n##### Special Technology Center (STC) 13\n\n**Background** 13\n\n**Security product suite by STC** 14\n\n**Links between monokle and security software         17**\n**developed by STC**\n\n**Potentially connected developers** 18\n\n##### Attacker Infrastructure 22\n\n**Attacker-controlled mobile devices** 22\n\n**Unique control phrases** 23\n\n##### Detailed Malware Analysis 23\n\n**Second stage encrypted DEX files** 23\n\n**Configuration files** 23\n\n**Inclusion of Xposed modules** 27\n\n**Communication and serialization protocols** 27\n\n**Server commands and responses** 31\n\n\n##### Contributors 35\n\n**Contact information** 35\n\n##### Appendix A: Indicators of Compromise\n\n36\n\n**SHA1s of Monokle APKs** 36\n\n**Command and control infrastructure** 36\n\n##### Appendix B: YARA Rules 37\n\n**Monokle Android samples** 37\n\n\n-----\n\n## Executive Summary\n\nLookout has discovered a highly targeted mobile malware threat that uses a new and sophisticated set of custom Android\n\nsurveillanceware tools called Monokle that has possible connections to Russian threat actors. Lookout research indicates\n\nthese tools are part of a targeted set of campaigns and are developed by the St. Petersburg, Russia-based company, Special\n\nTechnology Centre, Ltd. (STC, Ltd. or STC).\n\nIn late 2016, the amendment to Executive Order 13964 issued by then President Barack Obama, imposed sanctions on STC as\n\none of three companies that provided material support to the Main Intelligence Directorate (GRU) for alleged interference in\n\nthe 2016 U.S. presidential election. STC is a private defense contractor known for producing Unmanned Aerial Vehicles (UAVs)\n\nand Radio Frequency (RF) equipment for supply to the Russian military, as well as other government customers. STC has been\n\noperating in St. Petersburg since 2000 and has approximately 1500 employees.\n\nMonokle, developed by STC, is an advanced mobile surveillanceware that compromises a user’s privacy by stealing personal\n\ndata stored on an infected device and exfiltrating this information to command and control infrastructure. While most of its\n\nfunctionality is typical of a mobile surveillanceware, Monokle is unique in that it uses existing methods in novel ways in order to\n\nbe extremely effective at data exfiltration, even without root access. Among other things, Monokle makes extensive use of the\n\nAndroid accessibility services to exfiltrate data from third party applications and uses predictive-text dictionaries to get a sense of\n\nthe topics of interest to a target. Monokle will also attempt to record the screen during a screen unlock event so as to compromise\n\na user’s PIN, pattern or password.\n\nMonokle appears in a very limited set of applications which implies attacks using Monokle are highly targeted. Many of these\n\napplications are trojanized and include legitimate functionality, so user suspicion is not aroused. Lookout data indicates this tool\n\nis still being actively deployed.\n\nLookout is able to link STC to Monokle because it has also discovered that STC has been developing a set of Android security\n\napplications, including an antivirus solution, which share infrastructure with Monokle, among other links which are detailed in this\n\nreport. These applications were developed “for a government customer” according to an STC developer.\n\nLookout is providing, with this report, a list of more than 80 Indicators of Compromise (IOCs) that would allow cyber security\n\nsolutions to protect their customers from this threat. Lookout customers have been protected against Monokle since early 2018.\n\n\n-----\n\n## Key Findings\n\n**Lookout has discovered new mobile surveillanceware**\n\n**called Monokle**\n\n - Monokle is a sophisticated mobile surveillanceware\n\nthat possesses remote access trojan (RAT) functionality,\n\nadvanced data exfiltration techniques as well as the ability\n\nto install an attacker-specified certificate to the trusted\n\ncertificates on an infected device that would allow for\n\nman-in-the-middle (MITM) attacks.\n\n - Lookout has observed samples in the wild since March\n\n2016. Lookout sensors show that activity appears to\n\nremain small but consistent, peaking during the first half\n\nof 2018.\n\n - Monokle makes extensive use of Android accessibility\n\nservices to exfiltrate data from third party applications\n\nby reading text displayed on a device’s screen at any point\n\nin time.\n\n - There is evidence that an iOS version of Monokle is in\n\ndevelopment. Lookout has no evidence of active iOS\n\ninfections.\n\n - Monokle has likely been used to target individuals in the\n\nCaucasus regions and individuals interested in the Ahrar\n\nal-Sham militant group in Syria, among others.\n\n**Special Technology Center (STC) is a Russian defense**\n\n**contractor sanctioned by the U.S. Government in connection**\n\n**to alleged interference in the 2016 US presidential elections**\n\n - STC is known for producing Unmanned Aerial Vehicles\n\n(UAVs) and radio frequency (RF) measurement equipment.\n\n - STC was sanctioned by the US Government through an\n\namendment to Executive Order 13964, and is linked\n\nto providing material support to the Main Intelligence\n\nDirectorate (GRU) and assisting them in conducting\n\nsignals intelligence operations.\n\n\n**STC is developing both offensive and defensive Android**\n\n**security software**\n\n - Lookout researchers have discovered previously\n\nunknown mobile software development and\n\nsurveillance capabilities of STC, suggesting that it\n\noperates on both the offensive and defensive side\n\nof mobile tooling.\n\n - Its Android antivirus solution is called Defender and\n\nits mobile surveillanceware is called Monokle. It is\n\nthrough connections between these tools that Lookout\n\ncan establish conclusively that STC is the developer\n\nof Monokle.\n\n - Lookout has found strong links that tie STC’s Android\n\nsoftware development operations to Monokle’s IOCs\n\n - Lookout has found shared command and control\n\ninfrastructure used by both legitimate and malicious\n\nAndroid applications produced by STC.\n\n - The Defender application and related software has\n\nbeen referred to by an STC developer as developed\n\n“for a government customer”.\n\n - Lookout data indicates this tool is still being actively\n\ndeployed.\n\n**Lookout is releasing more than 80 indicators of**\n\n**compromise (IOC):**\n\n - 57 SHA-128 hashes and 1 YARA rule for Android\n\nmalware IOCs.\n\n - 22 domains and IP addresses.\n\n - Four Russian mobile phone numbers used as attacker\n\ncontrol phones for Monokle.\n\n\n-----\n\n## Monokle Mobile Surveillanceware\n\nThe Monokle surveillanceware family is a well-written and sophisticated piece of mobile malware. One of the most interesting\n\nparts of Monokle is that, with root access, it is capable of installing additional attacker-specified certificates to the trusted\n\ncertificates on an infected device, effectively opening up the target and the device to Man-In-The-Middle (MITM) attacks\n\nagainst TLS traffic. However, Lookout researchers were surprised at the lengths to which Monokle developers have gone to\n\noperate successfully without requiring root access. This allows the software to be incredibly flexible and useful in multiple\n\noperational scenarios.\n\nThis section of the report will detail some of its most interesting malicious functionality and potential targets.\n\n#### Observed samples\n\nTo date Monokle has only been seen in a handful of Android applications and many of the samples have titles and icons very\n\nspecifically targeted towards certain interests or regions. This leads Lookout researchers to believe that the surveillanceware is\n\nprobably being used in limited areas around the world. Titles are mostly in English with a handful in Arabic and Russian.\n\n\n-----\n\nTo date, while a small number of samples have been found in the wild, Lookout has found samples appearing to date as\n\nfar back as mid 2015 and, as shown below, has seen fairly regular releases since then.\n\nTimeline for the number of samples seen and their packaging dates for Monokle. Activity appears to remains small but consistent,\n\nrising to a peak during the first half of 2018.\n\n#### Potential targets\n\n\nWe were unable to access any of the data exfiltrated by this\n\nthreat and hence cannot state with certainty which individuals\n\nor groups have been targeted with Monokle. However,\n\nthere is some evidence pointing to potential targets within\n\nconfiguration files and titles of applications that contained\n\nMonokle. Since they were limited in number, contained\n\ncomplete functionality of the applications they trojanized\n\nand in some cases referenced very particular interests, it\n\nis reasonable to think that the titles and purpose of these\n\napplications played a role in convincing targets to install the\n\nmalware on their devices.\n\nBased on titles and icons of certain applications, we conclude\n\nthat individuals in the following groups are targets of Monokle:\n\n - Individuals that are interested in Islam.\n\n - Individuals that are interested in or associated with the\n\nAhrar al-Sham militant group in Syria.\n\n\n\n - Individuals living in or associated with the Caucasus\n\nregions of Eastern Europe.\n\n - Individuals that may be interested in a messaging\n\napplication called “UzbekChat” referencing the Central\n\nAsian nation and former Soviet republic Uzbekistan. A\n\nsimilar, non-trojanized, application which leverages a\n\ntelegram template for secure messaging with embedded\n\nadvertising SDKs is available on the free Android app\n\ncreation website, AppsGeyser.[1]\n\nWhile some indicators point to these groups, this is by no\n\nmeans an exhaustive list. More detail on two of these groups\n\nis provided below, along with Lookout findings that lead to\n\nthese conclusions.\n\n\n-----\n\n##### Ahrar al-Sham militant group\n\nInitial samples of Monokle acquired by Lookout in December\n\nof 2016 were titled Ahrar Maps. Lookout telemetry also shows\n\npresence of this application in Syria during early 2017. This\n\napplication is found to be offered through a third party site\n\nthat advertises association with the Ahrar al-Sham militant\n\ngroup. The group falls under the Syrian Islamic Front umbrella\n\nand is aimed at fighting against the Syrian Government and\n\nBashar al-Assad.[2]\n\n##### Individuals located within or associated with the Caucasus region\n\nThis is the icon of a sample of Monokle initially seen in\n\nOctober of 2017 and is simply titled ‘caucas’. The icon also\n\nreferences the Caucasus region in Arabic.[3] Along a similar\n\nvein, strings in the configuration script of another sample\n\nof Monokle contain a control phrase which also references\n\nIngushetia[4], a place in the Northern Caucasus region. That\n\nparticular app is a trojanized Flashlight application.\n\n#### Malicious functionality\n\nMonokle has numerous characteristics that distinguish it from other malware families seen in the wild; notably its ability to install\n\ntrusted certificates and exfiltrate several unique types of data, including user-defined words used for predictive text input and\n\nrecordings of the user unlocking their device. The application also uses accessibility services much more extensively than most\n\nother surveillanceware families to exfiltrate data from a large number of popular applications.\n\nAdditionally, apps belonging to the Monokle malware family were found to contain a comprehensive set of surveillanceware\n\ncapabilities, including:\n\n\n\n - Remounts system partition to install\n\nattacker specified certificate in /system/\n\netc/security/cacerts/).\n\n - Capable of hooking itself to appear\n\ninvisible to Process Manager.\n\n - Retrieve calendar information including\n\nname of event, when and where it is\n\ntaking place, and description.\n\n2 https://en.wikipedia.org/wiki/Ahrar_al-Sham\n\n\n\n- Get the salt that was used when\n\nstoring a user’s password at\n\nrest allowing for the plaintext\n\nretrieval of a user’s password /\n\npincode.\n\n- Receive out-of-band messages\n\nvia keywords (control phrases)\n\ndelivered via SMS or from\n\ndesignated control phones.\n\n\n\n- Reset a user’s pincode.\n\n- Retrieve user dictionary.\n\n- Record environment audio (and\n\nspecify if high, medium, or low\n\nquality).\n\n- Make outgoing calls.\n\n- Record calls.\n\n\n3 https://en.wikipedia.org/wiki/Caucasus#Endonyms and exonyms\n\n\n-----\n\n - Keylogger.\n\n - Delete arbitrary files.\n\n - Send text messages to an attacker\nspecified number.\n\n - Download attacker-specified files.\n\n - Reboot a device.\n\n - Interact with popular office applications\n\nto retrieve document text.\n\n - Accept commands from a set of ‘control\n\nphones’ specified in the sample settings.\n\n - Retrieve contacts.\n\n - Get device information including\n\nmake, model, power levels, whether\n\nconnectivity is wi-fi or mobile data,\n\nwhether screen is on or off, etc.\n\n##### Trusted certificate install\n\n\n\n- Retrieve e-mails.\n\n- Take photos and videos.\n\n- Track device location.\n\n- Take screenshots.\n\n- Get nearby cell tower info.\n\n- List installed applications.\n\n- Retrieve accounts and\n\nassociated passwords.\n\n- Get nearby Wi-Fi details.\n\n- Make screen recordings.\n\n- Suicide functionality and cleanup\n\nof staging files.\n\n\n\n- Retrieve browser history\n\n(includes doing some basic\n\nprofiling around frequency of\n\nsites visited, recency etc).\n\n- Retrieve call history.\n\n- Collect account information\n\nand retrieve messages for\n\nWhatsApp, Instagram, VK,\n\nSkype, imo.\n\n- Execute arbitrary shell\n\ncommands, as root, if root\n\naccess is available.\n\n\nOne of Monokle’s capabilities allows an adversary to add a certificate of their choosing to the set of those trusted on a compromised device. This would\n\ntheoretically allow them to conduct man-in-the-middle attacks against SSL-protected traffic if they are able to intercept network traffic.\n\n\n-----\n\n##### User-defined words for predictive text input\n\nSQLite databases used for predictive text input at /data/data/com.asus.ime/files/dictionary.dic and /data/data/com.android.\n\nproviders.userdictionary/databases/user_dict.db are copied to a temporary directory:\n\nThen words and word frequency information is extracted from the dictionary for transmission to the command and control server:\n\n\n-----\n\n##### Screen unlock recording\n\nThe malware application makes an attempt to record the screen during unlock events to compromise the device PIN, pattern,\n\nor password. On initialization, a BroadcastReceiver is registered for the following intents:\n\n - **android.intent.action.USER_PRESENT**\n\n - **android.intent.action.SCREEN_ON**\n\n - **android.intent.action.SCREEN_OFF**\n\nThis BroadcastReceiver calls methods in a ScreenPassword class which attempt to capture the screen contents when the screen\n\nis turned on. If the screen is turned off without being unlocked successfully, the capture is stopped and the video file is deleted.\n\nIf the screen is unlocked, the video is retained and future unlock attempts will not be recorded:\n\n\n-----\n\n##### Accessibility services usage\n\nThe malware is notable for its extensive use of\n\naccessibility services to capture data from third\n\nparty apps such as Microsoft Word, Google Docs,\n\nFacebook messenger, Whatsapp, imo, Viber,\n\nSkype, WeChat, VK, Line, and Snapchat.\n\n#### Evidence of iOS components\n\nIn several Android samples of Monokle, there are unused commands and data transfer objects (DTOs) defined which point to the\n\nexistence of an iOS version of the client. These classes and commands appear to serve no purpose as part of the Android client\n\nand may have been generated and included in it unintentionally.\n\n##### GetKeychain/SetKeychain\n\nAgentResponse contains a field named getKeychain that can contain a List of KeyChainItem objects. These appear to be\n\ndesigned to carry data which is consistent with an Apple keychain password item:\n\n\n-----\n\n##### GetHealthKit\n\nAgentResponse contains a field which is likely used to respond to a GetHealthKit command and contains data consistent with\n\nHealthKit characteristic and sample data which would be accessible through HKHealthStore on an iOS device:\n\n##### ShowiCloudLogin\n\nThis is a command associated with one field in the ServerCommand class which contains an object with a boolean value named\n\n“simulateFailedAttempt”.\n\n##### GetiWatchAccel\n\nThis command appears to be intended to send iWatch accelerometer data (x,y,z) back to the server with a timestamp.\n\n##### ApnsRegistration\n\nThis class defines fields for bundle ID, device token, and team ID which is consistent with data which may be required to send\n\nnotifications to a device using Apple Push Notification service (APNs):\n\n\n-----\n\n##### IOSPermissions\n\nThis DTO class is unused but defines one field name “permissions”.\n\n## Special Technology Center (STC)\n\n#### Background\n\nSpecial Technology Center LLC (a.k.a. STC, STLC Ltd., Special Technology Center St.\n\nPetersburg, and OOO Специальный Технологический Центр in Russian) is a privately\n\nowned company founded in 2000 and based in the Russian city of St. Petersburg. It is\n\npopularly known for its research and development of radio frequency (RF) measurement\n\nequipment and Unmanned Aerial Vehicles (UAVs) supplied to international markets, as well\n\nas the Government of Russia.[5][,][6] Its official address is 21-2 Gzhatskaya Street, St. Petersburg,\n\nRussia. Both the Glassdoor and LinkedIn profiles of STC claim that the company has\n\nbetween 1000 and 5000 employees, and is in the computer software industry.[7][,][8]\n\n5 https://www.stc-spb.ru/\n\n6 https://www.airforce-technology.com/projects/orlan-10-unmanned-aerial-vehicle-uav/\n\n7 https://www.glassdoor.ca/Overview/Working-at-%D0%A1%D0%BF%D0%B5%D1%86%D0%B8%D0%B0%D0%BB%D1%8C%D0%BD%D1%8B%D0%B9-%D0%A\n2%D0%B5%D1%85%D0%BD%D0%BE%D0%BB%D0%BE%D0%B3%D0%B8%D1%87%D0%B5%D1%81%D0%BA%D0%B8%D0%B9-%D0%A6%D0%B5%D0%B­\nD%D1%82%D1%80-EI_IE1716827.11,44.htm\n\n8 https://www.linkedin.com/company/stc-ltd./about/\n\n\n-----\n\n#### Security product suite by STC\n\nSTC is behind the creation of a suite of Android security software solutions, one of them known as Defender. According to our\n\nresearch, although STC has never publicly marketed their Android security suite, it is clear that STC is producing this software\n\nand that it is intended for government customers. Multiple Android developer positions have been advertised by STC on popular\n\nRussian job search sites in St. Petersburg and Moscow. The positions require both Android and iOS experience and advertise\n\nworking on a native antivirus solution for Android. In some cases, the professional profile of former employees of STC on social\n\nmedia sites such as LinkedIn have also corroborated being part of the team developing Defender (see the section on Potentially\n\nConnected Developers).\n\n\nAccording to public job offerings available on a particular\n\nRussian job search site, at the time of writing this report,\n\nSTC has had four active job postings for Android\n\ndevelopers within the last year. Details of the work\n\nbeing offered for these positions included development\n\nof a C++ antivirus engine for Android, among other\n\nspecifications. The above image is a screenshot of the\n\nEnglish translation of search results on a job search site\n\nthat refer to STC and its Android related positions.\n\n\nSTC’s Android security suite and Monokle are tied to one another with the help of signer certificates and overlapping command\n\nand control infrastructure. The Android security applications developed by STC provide important insight into the software STC\n\nproduces and yet more connections from Monokle to STC themselves.\n\n9 https://obamawhitehouse.archives.gov/the-press-office/2016/12/29/fact-sheet-actions-response-russian-malicious-cyber-activity-and\n\n\n-----\n\n##### App Control\n\n###### Package name: com.android.generalcontrol\n\nMain panel for App Control. The NetMonitor, PathFinder, and Defender options are greyed out unless those applications are installed. App Control also\n\nsearches a device for Monokle samples, and if found, can set off surveillance activities through the malware. The AppControl application also appears\n\nto interact with Monokle samples, if installed on the same device, and can enable certain surveillanceware activities by sending specific intents to the\n\nMonokle sample present.\n\n\n-----\n\n##### Defender\n\nDefender is the antivirus Android application produced by STC. The About page that comes with this application mentions STC\n\nexplicitly, lists the tool as a beta version (in the version being analyzed during this investigation), and also has the stc-spb.ru\n\nwebsite included in the contact information.\n\n###### Package name: defender.stc.com.defender\n\n\n-----\n\n#### Links between monokle and security software developed by STC\n\nSTC appears to offer a number of software products, but this report will focus on a suite of products that appears to be used\n\nas an Android defensive security solution, including a native antivirus engine, and a network monitor application, among\n\nothers. This particular software allows us to link the work of STC with Monokle samples.\n\n##### STC\n\n App Control\n\n Monokle\n\n Defender PathFinder NetMonitor\n\nSTC applications can all be managed from a central app, which in turn can be connected to the family Monokle.\n\nCommand and control infrastructure that communicates with the Defender application also communicates with Monokle\n\nsamples. The signing certificates used for signing Android application packages overlap between Defender and Monokle as well.\n\nAdditional overlap was observed by Lookout researchers between Monokle and the defensive security software produced by\n\nSTC in the authors’ development and implementation choices.\n\n\n##### STC\n\n App Control\n\n Monokle\n\n Defender PathFinder NetMonitor\n\n\n-----\n\n#### Potentially connected developers\n\nWhile conducting this investigation, Lookout researchers came across a number of potential developer names that appear to be\n\nlinked to Monokle or software connected to STC. Some of these leads provided Lookout with the evidence to link development\n\noperations within STC to IOCs associated with Monokle.\n\n###### A******** L*********\n\nIn some native components of Monokle, Lookout researchers found some developer references that were left behind. The\n\nreferences appear to name a developer and refer to the malware component as monokle-agent. This is why the name Monokle\n\nwas chosen.\n\n\n-----\n\n###### P**** W**********\n\nOne sample of Monokle initially seen by Lookout in August 2018 contains a configuration file with a test certificate but also\n\nspecifies a phone number of +79160077334 and the e-mail address p****.w**********@mail.ru. Both the e-mail and phone\n\nnumber could be used by Monokle to exfiltrate information to the attacker. No further public information was found on any\n\nindividual with this name and e-mail address.\n\n\nA screenshot of the extracted and decrypted configuration file for the sample of Monokle that mentions P**** W**********\n\n\n-----\n\n###### A**** U******\n\nAs we delved into applications that were related to both STC and Monokle, we came across a small subset of Android\n\napplications signed with the same certificate but that appeared to be associated with two different projects.\n\nThese were mostly STC-related applications with the exception of an application called TaskEdge, which was first seen by Lookout\n\nsensors in April of 2018. This appears to be the name of an Android application developed for the Samsung Galaxy Appstore.\n\nNormally this would mean that the same entity has had a hand in the signing of these applications.\n\nThe link appears to be a developer who claims to have worked at STC for a year in 2017-2018 on their “Defender” antivirus project.\n\nHe is also associated with the company developing TaskEdge.\n\n\n-----\n\nThe developer has an extensive social media presence and this, combined with the signer link between the unrelated apps, lead\n\nus to believe the Linkedin profile and work history is unlikely to be fictitious. This information further links STC to the Defender\n\nanti-virus software and, by extension, Monokle.\n\n\n-----\n\n#### Attacker Infrastructure\n\nThe vast majority of infrastructure that Lookout researchers found linked to Monokle is based on it being hard coded in\n\nencrypted configuration files. Some of these configurations also contain specific ports and TLS certificates for communicating\n\nto command and control servers, with the applications themselves making use of certificate pinning.\n\n\n**136.243.219.233**\n\n**149.154.65.55**\n\n**178.63.140.53**\n\n**185.23.17.13**\n\n**77.37.200.61**\n\n**185.117.89.238**\n\n\n**185.23.17.2**\n\n**185.48.56.81**\n\n**188.165.29.60**\n\n**192.168.49.24**\n\n**88.99.111.46**\n\n**188.165.165.246**\n\n\n**212.116.121.232**\n\n**217.172.20.24**\n\n**37.252.121.133**\n\n**46.4.180.48**\n\n**185.248.162.64**\n\n\n**flyinthesky.gotdns.ch**\n\n**oldserver.servepics.com**\n\n**southparks.servebeer.com**\n\n**Zebraland.myftp.biz**\n\n**109.167.231.10**\n\n\nCommand and control infrastructure extracted from Monokle samples. The Monokle domains above are all hosted on dynamic\n\nDNS services, mostly free and now offline.\n\n\nLooking closer at related infrastructure, it was found that samples of Defender (the defensive security solution developed by STC,\n\nsee “Security Product Suite By STC” section of this report) communicate to the IP address 109.167.231.10, which is also used as a\n\ncontrol server by Monokle samples.\n\nIn addition to socket information, configuration files also held control phone numbers and control phrases. The control phones\n\ncan be used to receive exfiltrated data from an infected device and can also send commands to a target device using control\n\nphrases. Specifics of how these are used by Monokle and the attacker can be found in the Detailed Malware Analysis section of\n\nthis report. Specific numbers and phrases will be listed in this section.\n\n##### Attacker-controlled mobile devices\n\nFour control phones that were found to be associated to Monokle are listed below. All these numbers have the country code +7\n\nwhich belongs to Russia. According to open source information online, all these numbers appear to be cellular phone numbers\n\nwith the mobile network operators Megafon and MTS Mobile. Both these companies provide service to Russian users, but in the\n\ncase of the latter, also to Armenia, Ukraine and Belarus.\n\n|Mobile number|Region in Russia|\n|---|---|\n|+79205916072|Belgorod Region/Nizhny Novgorod Region|\n|+79160077334|Moscow Region|\n|+79188107887|Ingushetia Region|\n|+79817606570|St. Petersburg and Leningrad Region|\n\n\n-----\n\n##### Unique control phrases\n\nConfiguration files found in Monokle samples came with ten unique control phrases:\n\n\n**connect**\n\n**delete**\n\n**location**\n\n\n**newaddress**\n\n**activate**\n\n**email**\n\n\n**audio**\n\n**.,.,.,.**\n\n**Hi!**\n\n\n**How are you?**\n\n\nA single configuration file contained control phrases that were in Russian and referred to a territory in the North Caucasus region\n\n- Ingushetia[10]. A screenshot of this configuration file can be seen in the Detailed Malware Analysis section of this report.\n\n## Detailed Malware Analysis\n\n#### Second stage encrypted DEX files\n\nMuch of the core malicious functionality in later samples of Monokle has been moved to an XOR obfuscated DEX file in the\n\nassets folder. The data.d file is the second stage encrypted DEX, while data.e is a set of 512 bytes which is XOR’d against every\n\nconsecutive 512 bytes in data.d. When unobfuscated, the secondary DEX file sometimes starts with an invalid DEX signature and\n\ncauses the popular tool dex2jar to throw errors when trying to convert it to a JAR file. But despite this issue, the DEX file is still\n\nloaded by Android correctly.\n\nThe functionality hidden in this DEX file includes all cryptographic functions implemented in the open source library\n\nspongycastle[11], various e-mail protocols, extraction and exfiltration of all data, serialisation and deserialisation of data using the\n\nThrift protocol, and rooting and hooking functionality, among others.\n\n#### Configuration files\n\nIn older samples, the configuration was stored in the encrypted file assets/config8261.lmt. Newer variants now load an initial\n\nconfiguration from assets/config2.acf. The configuration has been changed to be a Java object serialized using the Thrift\n\ncompact protocol and XOR encrypted.\n\nAfter the initial configuration is loaded, an additional group of settings can be configured by the command and control server or\n\nover SMS and the values retrieved initially from the configuration file can be altered. These settings are written to files/setts7465.\n\nlmt using Java serialization and the same XOR encryption scheme. Once the new file is written, the initial configuration file is\n\nignored on subsequent app launches.\n\n10 https://en.wikipedia.org/wiki/Ingushetia\n\n11 https://github.com/rtyley/spongycastle\n\n\n-----\n\nTracking the changes in configuration files over the lifetime of acquired Monokle samples provides valuable insight into how\n\nthis family has evolved over the past year. Configuration files seen in Monokle samples appear to get more elaborate with time,\n\nadding more features and at present, allow an attacker to interact with a device infected by Monokle with more flexibility and\n\noptions, as seen below.\n\n\nInitial configuration files have the structure shown in the top left image above. Configuration files from late 2018 (bottom left) also contain\n\nsocket information for various protocols, registered control phones and phrases, certificate information as well as the encryption key used\n\nin communication. The image on the right shows the additional configuration details found in samples of Monokle seen this year and not\n\nfound in older samples.\n\n\nCurrently, the following settings can be stored in the initial configuration file.\n\n\n-----\n\n|Setting|Description|\n|---|---|\n|agentId|An ID the agent receives on connection to the C2.|\n|period|The approximate interval, in seconds, that the client should wait to beacon out to the C2 using cellular data.|\n|wifiPeriod|The approximate interval, in seconds, that the client should wait to beacon out to the C2 on Wi-Fi.|\n|socketAddr|An object which stores the C2 IP and port the client should connect to as well as a cert used for TLS certificate pinning.|\n|emailAddr|Credentials, POP3 and SMTP server IPs and ports, and e-mail address to use for e-mail communication.|\n|controlPhones|A list of phone numbers to send outbound SMS communications to.|\n|controlPhrases|A list of phrases which identify an inbound SMS control message.|\n|communicationMode|Configures the client to use either the sockets protocol or e-mail for communication.|\n|usbTunnelPort|The local port the UsbSocketThread will listen on.|\n|needActivation|If enabled, the client must be activated via SMS before beaconing out to the C2.|\n|transportCrypto|An object which stores the AES key used for decryption/encryption of data transmitted over the network.|\n|fileCrypto|Controls whether files such as recordings, pictures, and screenshots will be encrypted and the RSA key which will be used for encryption.|\n|dataStore|The path where files such as recordings, pictures, and screenshots will be stored.|\n\n\nBy deobfuscating the configuration files of multiple samples from this malware family we found that they rely on at least 22\n\ndifferent command and control servers, have specified control phones that use the +7 country code of Russia, and use certificates\n\nfor pinning that have a CN field value of thorn-ca.\n\n\n-----\n\nThe dumped out deobfuscated configuration of a single sample is shown above. The associated values for the certificate used for pinning\n\n(shown at the top of the above image) is printed out in the image below. While it’s worth noting the control phones and infrastructure, the\n\ncontrol phrase МЧС Ингушетии просит Вас находиться дома caught our attention as it roughly translates to The Ministry of Emergency\n\n_Situations of Ingushetia asks you to stay at home. The other Russian control phrase seen in this configuration file roughly translates to_\n\n_Where are you?_\n\n\n-----\n\n#### Inclusion of Xposed modules\n\nXposed is a framework that allows a user of an Android device to apply add\nons, referred to as modules, to an Android device’s ROM(Read Only Memory)[12].\n\nXposed modules often modify the Android system, which likely requires the\n\ndevice to be rooted.\n\nSeveral recent Monokle applications come bundled with Xposed modules that\n\ncontain functionality for hooking and hiding presence in the process list.\n\n#### Communication and serialization protocols\n\n##### Overview\n\nThe client applications can be controlled by SMS messages, inbound TCP\n\nconnections to a listening thread, outbound beaconing TCP connections to a\n\ncommand and control, e-mail message exchange through POP3 and SMTP, and\n\nby incoming phone calls. Outbound traffic appears to always be tunnelled over\n\nTLS in most recent app samples.\n\nThree types of messages are exchanged between the client and C2 server as serialized Java objects in recent samples:\n\nAgentRegistration, ServerCommand and AgentResponse.\n\nFor outbound connections, the client initially sends an AgentRegistration object and then polls the server for a ServerCommand\n\nobject, which contains a task type field that determines what command the client is to run. Other fields in the ServerCommand\n\nobject may be populated, depending on the command that is being sent.\n\nIn response to a command, the agent may transmit a serialized AgentResponse object to the server, which will have one or more\n\nfields populated with the data requested.\n\nControl over e-mail works in the same way but SMTP and POP3 are used to exchange messages using servers and credentials\n\nspecified by the app configuration.\n\nIn addition to the beaconing behaviour, in some samples, a separate thread can listen on a local port (which is configuration\n\ndependent) for inbound connections. When a connection is made, the app will send an AgentRegistration message, process\n\nServerCommand messages, and send AgentResponse messages as needed. The same command processing logic is used for\n\ninbound and outbound connections. It would be possible to scan for a listening Monokle application, accepting connections, but\n\nit would require connecting to the appropriate port on a device and correctly parsing AgentRegistration messages.\n\nThere are two ways the application can be controlled via SMS. The first is by SMS messages containing a URL with a query string\n\nparameter “p” which contains a base64 encoded\n\nServerCommand. This uses the same task processing logic as commands sent over TCP and also has special functionality to pass\n\nback location data via SMS.\n\n\n-----\n\nThe other method of control via SMS is through configured control phrases sent from a control phone number. The phrases can\n\ntrigger one of the following six actions:\n\n**1.** Uninstall app\n\n**2.** Send GPS location via SMS\n\n**3.** Set C2 address and port\n\n**4.** Activate agent\n\n**5.** Configure e-mail communication settings\n\n**6.** Start audio recording\n\nSome functionality can also be triggered through phone calls. The applications are designed to answer calls from specific phone\n\nnumbers and delete these calls from the call logs. As these calls trigger headsets to be disconnected, this is likely a scheme\n\nintended to listen to ambient audio when an internet connection is unavailable. The applications can also be configured to take\n\nphotos when calls are received from particular phone numbers.\n\n##### Message Exchange\n\nThere are four major components to the Monokle network libraries: the Protocol class, the NetConnector class, the\n\nSessionManager and its nested classes, and the StreamHelper utility class.\n\n - NetConnector is responsible for abstracting all C2 communications and connection management. It supports either TLS 1.2\n\ncommunication with a C2 using an SSLSocket for communication through e-mail messages.\n\n - Protocol serializes and deserializes messages sent to and from the C2.\n\n - StreamHelper is responsible for decrypting messages from the server and encrypting messages before they are sent (with\n\nthe notable exception of registration messages).\n\n##### AgentRegistration\n\nThis message type is always the initial one exchanged. It is the only message type which is not encrypted beyond typically being\n\nsent over a TLS connection.\n\n###### Length (32 bits, Little Endian)\n\n Thrift Compact Protocol (Variable)\n\nIn the payload, a device ID is written using TCompactProtocol.writeString(String)[13], followed by an agent ID using\n\nTCompactProtocol.writeI32(int)[14], followed by at least one additional field.\n\n13 https://people.apache.org/~thejas/thrift-0.9/javadoc/org/apache/thrift/protocol/TCompactProtocol.html#writeString(java.lang.String)\n\n\n-----\n\nThis is decrypted, using AES, to:\n\n###### Length (16 bits, little endian) bytes\n\nWhere bytes is the Thrift message in Thrift compact protocol format. The message is deserialized into a ServerCommand object.\n\n|Length (16 bits, little endian)|bytes|\n|---|---|\n\n\n-----\n\n##### AgentResponse\n\nResponses sent to the server are encoded as:\n\nAnd then encrypted using AES:\n\n\n-----\n\n#### Server commands and responses\n\nThere are 78 task types defined, of which 61 are implemented in recent samples. Any unimplemented commands fall back to a\n\nmethod which returns a TErrorType.NOT_SUPPORTED error to the server. Any command can be received inbound through SMS,\n\ne-mail, and inbound/outbound TCP connections.\n\nResponses are not sent through SMS aside from for requests for location data.\n\n\n###### Task ID Description 00 AgentResponse Field ServerCommand Field\n\n\n1 Gathers call logs. baseSystem.getCallsList.calls N\\A\n\n2 Collects SMS messages baseSystem.getSmsList.messages N\\A\n\n3 Collects contacts baseSystem.getContactsList.contacts N\\A\n\nGets a list of files in particular\n4 baseSystem.getFilesList.files N\\A\ndirectories on the system.\n\n5 Retrieves calendar information. baseSystem.getMeetingsList.meetings N\\A\n\nRetrieves current and historical\n6 baseSystem.getLocation.location N\\A\nlocation data.\n\nCollects usernames and passwords for\n7 baseSystem.getAccountsList.accounts N\\A\nWhatsApp, Instagram, VK, Skype, imo.\n\nRetrieves device info, app package\n8 baseSystem.getDeviceInfo N\\A\nname, Wi-Fi IP\n\n\n9\n\n\nGets battery level and information\nabout whether the device is being\ncharged.\n\n\nbaseSystem.getInterfacesStates.states N\\A\n\n\nRetrieves a file, in chunks, from the file\n10 baseSystem.getFile baseSystem.getFile\nsystem.\n\n\nProvides the server with a list of tasks\n11\nthe client is capable of performing.\n\n\nbaseSystem.getCapabilities, baseSystem.\nN\\A\ngetCapabilities.taskCapabilities\n\nbaseSystem.getBrowserHistory N\\A\n\n\n12\n\n\nGets browser history from Firefox,\nHTC browser, Opera, Samsung\nbrowser, Dolphin browser.\n\n\nGets visited browser URLs collected\n13 baseSystem.getBrowserTracking.visits N\\A\nthrough accessibility services.\n\nbaseSystem.getBrowserBookmarks.\n14 Retrieves browser bookmarks. N\\A\nbookmarks\n\n\n-----\n\n15 Collects a list of installed apps. baseSystem.getApplicationsList.apps N\\A\n\nGet bluetooth MAC, Wi-Fi network\n16 baseSystem.getNetworkingData N\\A\ninformation, and Wi-Fi scan results.\n\n\n17\n\n18\n\n\nRetrieves messages from WhatsApp,\nViber, Skype, Telegram, imo,\nFacebook, Instagram, and VK.\n\nGets e-mail messages from the\nLenovo, HTC, LG, and Android mail\nclients.\n\n\nbaseSystem.getMmsList.messages N\\A\n\nbaseSystem.getEmailsList.emails N\\A\n\n\n19 Collects user dictionary data. baseSystem.getUserDictList N\\A\n\nLocation data collected using location\n20 baseSystem.getLocationTracking N\\A\ntracking code.\n\n21 Agent configuration data baseSystem.getAgentInfo N\\A\n\n22 Event tracking data baseSystem.getEventTracking.event N\\A\n\n23 Keylogging data baseSystem.getKeyLogging.log N\\A\n\n\nRecording of user unlocking the\n24\ndevice\n\n\nbaseSystem.getScreenPassword.\nN\\A\npasswords\n\n\n25 Configured geo-fences baseSystem.getGeofencesList.geofence N\\A\n\n\n26\n\n27\n\n28\n\n\nA list of data gathered from\nmonitoring the clipboard and\nnotification tickerText\n\nConfigures beaconing period:\nagentSettings.period and\nagentSetting.WifiPeriod\n\nRuns a shell command, as root,\ndepending on whether or not root\naccess is available.\n\n\nbaseSystem.getNotificationsList.\nN\\A\nnotifications\n\nbaseSystem.\nN\\A\ngetChangeConnectPeriod()\n\nbaseSystem.executeShellCommand.rows baseSystem.getExecuteShellCommand\n\n\n29 Configures GPS location listening N\\A baseSystem.setGpsMode.mode\n\n30 Toggle Wi-Fi connectivity N\\A baseSystem.toggleWifi\n\n31 Toggles bluetooth state N\\A baseSystem.toggleBluetooth\n\n\n-----\n\nResets either the device or the device\n32 N\\A deviceReset\npassword\n\n33 Shows a notification to the user N\\A baseSystem.showMessage\n\nEnables/disables keylogging\n34 N\\A baseSystem.setKeyLogging\nfunctionality\n\nChanges the location tracking\n35 N\\A baseSystem.setLocationTracking\nconfiguration\n\nConfigures the agent to require an\n36 N\\A N\\A\ninbound SMS for activation\n\nActivates the agent by setting the\n37 N\\A N\\A\n“needActivation” setting to false\n\nbaseSystem.changeControlPhones.\n38 Sets the controlPhones number N\\A\nphones\n\nConfigures either socketAddr or\n39 N\\A baseSystem.changeServerAddress\nserverMail settings.\n\n40 Changes transportCrypto settings. N\\A baseSystem.changeTransportCrypto\n\n41 Configures the agent ID. N\\A baseSystem.changeAgentId\n\nConfigures the agent communication baseSystem.\n42 N\\A\nmode (e-mail or TCP/IP) changeCommunicationMode\n\n43 Stops and uninstalls the agent. N\\A N\\A\n\nSends an SMS message to a control\n44 N\\A baseSystem.sendSms\nphone.\n\n45 Initiates an outgoing call. N\\A baseSystem.makeCall.phoneNumber\n\n46 Deletes a file on the device. N\\A baseSystem.deleteFile\n\n47 Change call recording settings. N\\A baseSystem.change\n\n\n48\n\n\nEither starts audio recording or\nschedules audio recording to be\nstarted through the SoundHub class.\n\n\nN\\A baseSystem.setAudioRecordMode\n\n\nControls video recording via front or baseSystem.setVideoRecordMode.\n49 N\\A\nrear camera. filename\n\n\n-----\n\n50 Configures screenshot settings. N\\A baseSystem.setScreenShotMod\n\n51 Configures photo capture settings. N\\A baseSystem.setPhotoShotMode\n\nEnables a setting which enables/\n52 N\\A baseSystem.setScreenPasswordMode\ndisables recording of screen unlock.\n\n\n53\n\n\nInstructs the agent to download a file\nfrom a specified URL to a location on\nthe file system.\n\n\nN\\A baseSystem.uploadFileToAgent\n\n\n54 Reboots, turns off, or locks the device. N\\A baseSystem.deviceControl\n\n55 Adds a CA cert to the device. N\\A baseSystem.installCertificate.fileName\n\n56 Configures geofences N\\A baseSystem.setGeofencesList\n\nInstalls an application from a specified\n57 N\\A baseSystem.installApplication.filePath\nlocation file path.\n\nbaseSystem.uninstallApplication.\n58 Uninstalls a specified application. N\\A\npackageName\n\nDeletes tracking data the application\n59 N\\A N\\A\nhas been collecting.\n\nConfigures streaming audio recording baseSystem.\n60 N\\A\nto stream to a particular server. changeAudioStreamingMode\n\n\n61\n\n\nAllows configuration of a filter used\nto collect targeted data through\ncommand which support data filtering\n\n\nN\\A N\\A\n\n\n-----\n\n#### Contributors\n\n**Adam Bauer, Sr. Staff Security Intelligence Engineer, Lookout**\n\n**Apurva Kumar, Staff Security Intelligence Engineer, Lookout**\n\n**Christoph Hebeisen, Head of Research, Lookout**\n\n**Michael Murray, Chief Security Officer, Lookout**\n\n**Michael Flossman, formerly of Lookout**\n\n**Contact information**\n\nthreatintel@lookout.com\n\n**lookout.com**\n\n© 2020 Lookout, Inc. LOOKOUT®, the Lookout Shield Design®, LOOKOUT with Shield Design®, SCREAM®, and SIGNAL FLARE® are registered trademarks of Lookout,\nInc. in the United States and other countries. EVERYTHING IS OK®, LOOKOUT MOBILE SECURITY®, POWERED BY LOOKOUT®, and PROTECTED BY LOOKOUT®, are\nregistered trademarks of Lookout Inc in the United States; and POST PERIMETER SECURITY ALLIANCE™and DAY OF SHECURITY™are trademarks of Lookout Inc\n\n\n-----\n\n#### Appendix A: Indicators of Compromise\n\n##### SHA1s of Monokle APKs\n\n722fa5222be0686150bf7ef62097035b35babcb3\n\n655e2a59c80c05baabd88b417a078a1f085d2ed9\n\n5b9d7d9b8110b245f5d53b4aab4f23a5812c4815\n\n72d4863a4df5337621440222a478fbf8fa6d2c9a\n\nfe0d426ee22c0a18d0cdcd81d9742a426f30ebcf\n\n8034857623f59a3804c7170095e9e792a75c442d\n\nb4993b08bbb0482723502c2a52da5d0a30a00f45\n\n8fd1211deda8214dc7b1bb81522756aa88e6d116\n\nd93f45ae0967c514ec0bf5ccc4987a0bd2b219b4\n\nd9bfe9a0bef9c0a0dc021b33cc2d2a7899aa08a0\n\n5bcaecf74d242c8b1accbdf20ac91cacb6b5570a\n\n60d5d2336321f12041192956b3e9d27ea37e61e7\n\na3af46875934a038e28cbf36153b6dd1a69d1d4b\n\n21e8a2aed43b66fbbeb1cf4839996e2d2dc27ed2\n\nf910d5a09b2f678df3f56106cef3e9c0c11ce62c\n\n9d7c44ef99054a208ce6e05cfd9ce4e16cf6f5fb\n\ne8fbf33849250900ea69e4b3cc0be96607d064ac\n\n501c295ec2d497ad87daa1d069885b945d372499\n\n5354a371c7a936daa26b2410bbf7812a31ae7842\n\nd13eda5c914dc5fec7984ff9a2e0987c357141d3\n\n9cbad8d15a6c96f8e587d4bf8d57882e57bf26d6\n\nb138dee2b40c8f1531098d6fb00b3d841fec5ed8\n\nbbbd7f1776bef967b93d7c381617310a62f5f6ff\n\n7a5421a20f834402e0ca318b921b7741b0493b34\n\nf9ab3ac4b67f512cde8dce50d2797eeddbc102f8\n\nf7e948a6100e11064094bf46eb21fb64b53db5d0\n\nf3541ce42f4197fd5363756b21c5ff74c7db295c\n\n0026ccb2c45f0dc67e41b736d8c0e1f0d8385146\n\nb1896570b50aca85af521fa1fb7ae86b8aeb26fe\n\n5feada28d38ee41b0b9f1a38458e838445201ef0\n\n025c427d354cbc0a2f473972d1b6a3a53f37017c\n\n3a350b419e9079c2cc6ec12f2430e4cee5446fa8\n\nd7db5c227ad23a43f2d3fe5e3cb7e3b31c82c86a\n\n6e186e713f38f3843735f576f5083f4f684cc077\n\nc70815dbdec80302d65d8cb46197a1d787479224\n\n04c8dcc62704526606d05037e1209b571e504792\n\n8ded74c9c7c61273adf9888506870911944ca541\n\n\n136.243.219[.]233\n\n149.154.65[.]55\n\n178.63.140[.]53\n\n185.23.17[.]13\n\n77.37.200[.]61\n\n185.117.89[.]238\n\n185.23.17[.]2\n\n185.48.56[.]81\n\n188.165.29[.]60\n\n192.168.49[.]24\n\n88.99.111[.]46\n\n188.165.165[.]246\n\n212.116.121[.]232\n\n217.172.20[.]24\n\n37.252.121[.]133\n\n\n4245d4d349152e9706419f03756cc52f1570d255\n\nd9114cea50febed7d51e15077a1893494e52f339\n\nf4f47c9fec3e85657cfbde92c965913c70c93867\n\nb0911d5eeab68723c1d9fcdada2a64b5eace5f54\n\n8af9997e20949e0cc8dfcb685b5c1746921ee5d1\n\n1e0ac49b78cf2fa5cab093d5a56f15765bbddf31\n\n09b4972a6ee426b974e78ca868c1937bd3c83236\n\ne288de6ec6759275b1af2c2a353577cc88b8dd93\n\nf837a54e761edafd10e7d4872f81e5c57c0585be\n\n44b999f4c9284b5c34cec3ffb439cb65f0da5412\n\n69a86eb70ebf888fdd13c910e287b3d60393012b\n\n01390cd14b0f17efb90d89bdd9ff7de46e008a8f\n\n8e34ad5b12783b8c2c5d57ae81d8e3c4fe8bf1f4\n\n4f2873780794d654961644fb9c2e2750213a69f8\n\n346fe37f451cd61cfc922eafc113798b59c807be\n\nef32335fd5457274ff65437aa1615c62c77772b4\n\n1bd8465f5020f75f0a84dfaf6e1e935954533368\n\nd618a5be838713d0a117c7db2775e7614a775924\n\n720b29792f80c02c42c48b7d085035cd1a28ec68\n\n##### Command and control infrastructure\n\n\n46.4.180[.]48\n\n185.248.162[.]64\n\n109.167.231[.]10\n\nflyinthesky.gotdns[.]ch\n\noldserver.servepics[.]com\n\nsouthparks.servebeer[.]com\n\nzebraland.myftp[.]biz\n\n\n-----\n\n#### Appendix B: YARA Rules\n\n##### Monokle Android samples\n\n\nrule Monokle_Android\n{\nmeta:\ndescription = “Rule for Monokle Android samples. Configuration information suggests actor has a presence in Russia. Campaigns\nappear highly targeted.”\nauth = “Flossman - SecInt <threatintel@lookout.com>”\ndate = “2018-04-24”\nversion = “1.0”\n\nstrings:\n$dex_file = { 64 65 78 0A 30 33 35 00 }\n\n$seq_security_update = { 00 20 4C 63 6F 6D 2F 73 79 73 74 65 6D 2F 73 65 63 75 72 69 74 79 5F 75 70 64 61 74 65\n2F 41 70 70 3B 00 }\n\n$str_recs_file = “recs233268”\n\n$str_sound_rec_fname = “nsr516336743.lmt”\n\n$str_nexus_6_recording = “Nexus 6 startMediaRecorderNexus”\n\n$str_next_connect_date_fname = “lcd110992264.d”\n\n$str_app_change_broadcast = “com.system.security.event.APP_CHANGE_STATE”\n\n$str_remove_presence_flag_1 = “Android/data/serv8202965/log9208846.txt”\n\n$str_remove_presence_flag_2 = “Android/data/serv8202965”\n\n$str_user_dict = “/data/local/tmp/5f2bqwko.tmp”\n\n$seq_failed_to_read_firefox = { 46 61 69 6C 65 64 20 74 6F 20 72 65 61 64 20 46 69 72 65 66 6F 78 20 42 72 6F 77 73 65 72 20 62 6F\n6F 6B 6D 61 72 6B 73 20 66 72 6F 6D 20 }\n\n$str_firefox_temp_default = “/data/local/tmp/fegjrexkk.tmp”\n\n$seq_failed_to_read_samsung = { 46 61 69 6C 65 64 20 74 6F 20 72 65 61 64 20 53 61 6D 73 75 6E 67 20 42 72 6F 77 73 65 72 20 62\n6F 6F 6B 6D 61 72 6B 73 20 66 72 6F 6D 20 }\n\n$str_get_bookmarks_api_log = “getBookmarksFromSBrowserApi23”\n\n$str_samsung_browser_temp = “/data/local/tmp/swbkxmsi.tmp”\n\n$str_samsung_browser_temp_2 = “/data/local/tmp/swnkxmsh.tmp”\n\ncondition:\n$dex_file and (any of ($seq*) or any of ($str*))\n}\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "99fdc3ef-333d-48f5-a4a1-becd788c7b80",
            "created_at": "2022-10-25T15:28:29.802983Z",
            "updated_at": "2022-10-25T15:28:29.802983Z",
            "deleted_at": null,
            "name": "MITRE",
            "url": "https://github.com/mitre-attack/attack-stix-data",
            "description": "MITRE ATT&CK STIX Data",
            "reports": null
        },
        {
            "id": "bf5be533-fa31-4590-ae37-5761c97ffa34",
            "created_at": "2022-10-25T16:13:58.389257Z",
            "updated_at": "2022-10-25T16:13:58.389257Z",
            "deleted_at": null,
            "name": "Malpedia",
            "url": "https://malpedia.caad.fkie.fraunhofer.de",
            "description": "Malpedia is a free service offered by Fraunhofer FKIE",
            "reports": null
        },
        {
            "id": "5910e58f-4bc9-4e4e-9dbb-887804094a01",
            "created_at": "2022-10-25T16:32:58.457399Z",
            "updated_at": "2022-10-25T16:32:58.457399Z",
            "deleted_at": null,
            "name": "OTX",
            "url": "https://otx.alienvault.com",
            "description": "Alienvault Open Threat Exchange (OTX)",
            "reports": null
        }
    ],
    "references": [
        "https://www.lookout.com/documents/threat-reports/lookout-discovers-monokle-threat-report.pdf"
    ],
    "report_names": [
        "lookout-discovers-monokle-threat-report.pdf"
    ],
    "threat_actors": [
        {
            "id": "d90307b6-14a9-4d0b-9156-89e453d6eb13",
            "created_at": "2022-10-25T16:07:23.773944Z",
            "updated_at": "2025-03-27T02:02:09.974695Z",
            "deleted_at": null,
            "main_name": "Lead",
            "aliases": [
                "Casper",
                "TG-3279"
            ],
            "source_name": "ETDA:Lead",
            "tools": [
                "Agentemis",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "RbDoor",
                "RibDoor",
                "Winnti",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1666716504,
    "ts_updated_at": 1743041146,
    "ts_creation_date": 1580301395,
    "ts_modification_date": 1580301403,
    "files": {
        "pdf": "https://archive.orkl.eu/bc85a305011865d631c741a7583fa7e352fb81cd.pdf",
        "text": "https://archive.orkl.eu/bc85a305011865d631c741a7583fa7e352fb81cd.txt",
        "img": "https://archive.orkl.eu/bc85a305011865d631c741a7583fa7e352fb81cd.jpg"
    }
}