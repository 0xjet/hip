{
    "id": "bca8c385-fb33-4433-ab99-ea0cc52678a8",
    "created_at": "2023-01-12T15:04:02.152387Z",
    "updated_at": "2025-03-27T02:09:18.090059Z",
    "deleted_at": null,
    "sha1_hash": "ea31761e551aebf6ae8f9a69ab534c8394280ff8",
    "title": "2021-08-23 - Hive Attacks - Analysis of the Human-Operated Ransomware Targeting Healthcare",
    "authors": "",
    "file_creation_date": "2022-05-29T01:20:14Z",
    "file_modification_date": "2022-05-29T01:20:14Z",
    "file_size": 1267244,
    "plain_text": "# Hive Attacks | Analysis of the Human-Operated Ransomware Targeting Healthcare\n\n**[labs.sentinelone.com/hive-attacks-analysis-of-the-human-operated-ransomware-targeting-healthcare/](https://labs.sentinelone.com/hive-attacks-analysis-of-the-human-operated-ransomware-targeting-healthcare/)**\n\nJim Walter\n\n**By Jim Walter & Juan Andres Guerrero-Saade**\n\n## Executive Summary\n\nHive is a double-extortion ransomware group that first appeared in June 2021.\nThe group is notable in its undiscerning choice of targets, having no limits when it\ncomes to healthcare providers and hospitals, as evidenced in a recent attack on\nMemorial Health System hospitals in Ohio.\nHive ransomware is written in Go to take advantage of the language’s concurrency\nfeatures to encrypt files faster.\nThis report offers an overview of Hive TTPs as well as a reverse engineering deep dive\ninto the ransomware payloads.\nHive remains active with as many as 30 victim companies listed on its Hive Leaks\nonion site at the time of writing.\n\n## Background\n\n\n-----\n\nWhile many active ransomware groups have committed to forgoing attacks on medical\n[targets in deference to the current global situation, Hive is not one of them. On August 15,](https://www.sentinelone.com/lp/covid-19/)\n2021, news broke of a Hive campaign against Memorial Health System, an Ohio healthcare\nprovider. As a result, the hospital was forced to advise some patients to seek treatment at\nseparate facilities.\n\nWhile some ransomware attacks hitting public health and critical infrastructure targets can be\nthe result of a shotgun approach to targetting – mass phishing campaigns that execute\nmalware blindly on victim devices without awareness of the victim environment – that is not\nthe case with Hive. This is a human-operated ransomware attack designed to take input from\nthe command line, indicating the attackers are both aware of the environment and tailoring\ntheir attacks for maximum impact.\n\n[Memorial Health Systems open statement on ransomware attack](https://mhsystem.org/cyberattack)\n\n## Who is Hive?\n\nHive or “HiveLeaks” is a relatively new ransomware outfit that made its appearance on the\nscene in late June, 2021. Hive is yet another double extortion group, making their money off\nof a two-pronged attack: exfiltrating sensitive data before locking up the victims’ systems.\nThis allows them to pressure the victim into paying greater sums than a conventional\nransomware attack as they also face the threat of a mass leak of sensitive data. Hive’s\nschemes have proven successful so far as multiple leaks are currently posted on their victim\nblog. As of the time of writing, there are 30 companies currently named on the HiveLeaks\nsite.\n\n\n-----\n\nHiveLeaks site showing the timer before releasing victim files\nWe can’t put the toothpaste back in the tube for Memorial Health Systems, but we can at\nleast contribute a breakdown of the Hive operators’ preferred techniques and a deep dive\ninto their ransomware toolkit to help other potential victims.\n\n## Technical Analysis\n\nInitial acces can vary. Cobalt Strike implants are most often the tool of choice. They are\ndelivered via phishing or emails in order to establish initial access. These beacons maintain\npersistence and allow the operators to expand their reach within the compromised\nenvironment. They are also used to launch the Hive payloads.\n\nRecent campaigns opt for the use of ConnectWise. ConnectWise is a legitimate commercial\nremote administration tool that has been abused by multiple ransomware operators in recent\nyears. This allows for persistence and management of their malware in environments where\nCobalt Strike hasn’t been successful.\n\nOnce inside, attackers will attempt to dump credentials by way of `consvcs.dll (MinDump)`\nthough `rundll32.exe :`\n```\nWindowssystem32cmd.exe /C rundll32.exe\nWindowsSystem32comsvcs.dll MinDump 752 lsass.dmp full\n\n```\n\n-----\n\nAdditionally, `WDigest may be manipulated to allow for the caching of cleartext credential`\ndata:\n```\nWindowssystem32cmd.exe /C reg add\nHKLMSYSTEMCurrentControlSetControlSecurityProvidersWDigest /v\nUseLogonCredential /t REG_DWORD /d 1 && gpupdate /force\n\n```\n[Additional tools like ADRecon may be used to further understand and traverse the](https://github.com/adrecon/ADRecon)\ncompromised Active Directory (AD) environment. ADRecon is an open-source tool designed\nto do just that– to map, traverse and enumerate an AD environment.\n\n## The Hive Payload\n\nWhile the tools, techniques, and procedures mentioned above are fairly standard for\nransomware groups these days, Hive utilizes their own closed-source ransomware. The\npayloads are written in Go and packed with UPX. After unpacking, the ransomware itself is\nover 2MB in size owing to the way Go packages statically-link all dependencies to create a\nreliably portable executable.\n\nThe developers are taking advantage of some of the native benefits of Go, particularly the\nability to implement easy and reliable concurrency. On the other hand, Go is known for\nenabling easy cross-compilation across different operating systems but the manner in which\nHive implements its functionality makes it Windows-specific, at this time.\n\nThe ransomware is designed to take input from the command line, indicating that it’s meant\nto be run directly by an operator or a script containing the desired parameters. The available\nflags are as follows.\n\nFlags used by Hive Ransomware\nThese flags are largely self-explanatory with the exception of the final option, no_cleanpollDesc. This refers to a final phase in the ransomware’s functionality that looks for a_\nfile named `swap.tmp in all logical drives and deletes it before the ransomware exits. The`\n\n\n-----\n\ndevelopers refer to this as cleaning space . At this time we don t know what this file does,\nwhether it’s a component generated during their operations, a native Windows file, or\nperhaps a reference to incomplete cross-platform functionality intended for future builds.\n\nGo malware is usually considered difficult to reverse engineer, primarily due to the wealth of\ntangentially-related imported code baked into every executable. It’s important to isolate the\ncode contributed by the malware developers. In this case, Hive devs contributed four\npackages orchestrated by the `main() function: encryptor, keys, winutils, and config.`\n\nCustom packages under ‘google.com’\n\nparent directory\nCursory examination might miss these as they’re housed under a parent package named\n**_google.com, perhaps to give the appearance that these are standard packages._**\n\nThe main function parses the flags provided by the operator and before initializing the\nransomware functionality under `encryptor.NewApp() . First it generates and exports the`\nencryption keys and generates the ransom note. It directs the victim to a password-protected\nOnion domain:\n```\nhttp://hivecust6vhekztbqgdnkks64ucehqacge3dij3gyrrpdp57zoq3ooqd[.]onion/\n\n```\nIt also warns the victim of the impending disclosure of their stolen data at the Hive Leaks\nsite:\n```\nhttp://hiveleakdbtnp76ulyhi52eag6c6tyc<redacted>.onion/\n\n```\nThe main functionally is housed under `encryptor.(*App).Run(), which does the`\nfollowing:\n\n1. `App.ExportKeys() wraps around standard go crypto functions, which it uses to`\n\ngenerate RSA keys. A key file is exported.\n2. `MountPoints() enumerates different types of drives and appends them to a slice (a`\n\ndynamically-sized array in Go). This includes native logical drives, removable drives,\nand remote shares\n\n\n-----\n\n3. Based on the kill flag, the malware proceeds to kill processes matching the regex\n\nprovided. If no custom value is provided, the following default is used:\n```\n   \"bmr|sql|oracle|postgres|redis|vss|backup|sstp\"\n\n```\n4. Based on the stop flag, the malware connects to the Windows service control manager\n\nand proceeds to stop services matching the regex provided.\n5. The malware creates a batch file to self-delete with the filename `hive.bat, removing`\n\nits own components from the disk via a new process.\n```\n        timeout 1 || sleep 1\n        del \"C:Usersadmin1Desktophmod4.exe\"\n        if exist \"C:Usersadmin1Desktophmod4.exe\" goto Repeat\n        del \"hive.bat\"\n\n```\n6. It creates a batch file to delete shadow copies under the filename `shadow.bat and`\n\nexecutes it as a separate process.\n```\n        vssadmin.exe delete shadows /all /quiet\n        del shadow.bat\n\n```\n7. In order to take advantage of Go’s concurrency features, the Hive devs run a\n```\n   Notify() function that is meant to watch the WaitGroup that keeps track of the\n\n```\nparallel threads. As long as there are threads pending, this function will keep the\nprogram running.\n8. Now onto the real business of ransomware. `ScanFiles() will populate a list of`\n\nabsolute filepaths fed into a channel (a queue of sorts). `EncryptFiles() will then`\nspawn threads that each take a file from that queue and encrypt it. This concurrency\nfeature is the main advantage of writing this ransomware in Go and allows for much\nfaster file encryption.\n9. Finally, the devs make sure to erase the encryption key from memory.\n\nRansom notes are deposited into each folder containing encrypted files (skipping the\n```\nC:windows ) directory.\n\n```\n\n-----\n\nThe ‘HOW_TO_DECRYPT.TXT’ ransom note\nThe ransom note instructs victims to visit the Hive portal via TOR and login with their\nassigned unique ID to continue the payment process.\n\nHive Victim Portal\n\nEach infection campaign is assigned unique credentials available in the ransom note. This\nportal leads the victim to the standard ransomware ‘support’ area where they can upload\nfreebie test files, communicate with their attackers, and receive their decryptor should they\n[choose to pay (which, in an ideal world, they shouldn’t).](https://assets.sentinelone.com/biden-exec-order/sentinel-one-ransomw-2)\n\n\n-----\n\nWatch Video At:\n\nhttps://youtu.be/MEi0QWuyLtw\n\n## Conclusion\n\nAs these attacks continue to escalate and become more egregious, the need for true attack\n‘prevention’ is all the more critical. While well-maintained and tested backup strategies are a\nmust, they are not enough in these double-extortion cases.\n\nOnce executed, most modern ransomware will go after backup and storage volumes in fairly\n[smart ways. Many have even evolved to target specific NAS devices and platforms. Some](https://www.sentinelone.com/blog/meet-darkside-and-their-ransomware-sentinelone-customers-protected/)\ngroups will bypass the encryption phase altogether and opt for pilfering data to openly extort\nvictims with. While the latter scenario may seem preferable due to a lack of disruption, the\nreputational damage, potential liability, and threat to business viability remains. Hence our\nemphasis on prevention.\n\nWe urge all defenders to explore and embrace modern endpoint protection technologies that\ngo beyond static checks, basic signatures, and other outdated components. Contextual\nawareness and automated behavioral classification are among the most powerful weapons\ndefenders should avail themselves of.\n\n## Indicators of Compromise\n\n**FILE HASHES**\n\n**SHA1**\n\n67f0c8d81aefcfc5943b31d695972194ac15e9f2\n\nedba1b73ddd0e32784ae21844c940d7850531b82\n\n\n-----\n\n2877b32518445c09418849eb8fb913ed73d7b8fb\ncd8e4372620930876c71ba0a24e2b0e17dcd87c9\neaa2e1e2cb6c7b6ec405ffdf204999853ebbd54a\n0f9484948fdd1b05bad387b14b27dc702c2c09ed\ne3e8e28a70cdfa2164ece51ff377879a5151abdf\n9d336b8911c8ffd7cc809e31d5b53796bb0cc7bb\n1cc80ad88a022c429f8285d871f48529c6484734\n3b40dbdc418d2d5de5f552a054a32bfbac18c5cc\n2f3273e5b6739b844fe33f7310476afb971956dd\n7777771aec887896be773c32200515a50e08112a\n5dbe3713b309e6ecc208e2a6c038aeb1762340d4\n480db5652124d4dd199bc8e775539684a19f1f24\nDc0ae41192272fda884a1a2589fe31d604d75af2\n\n_Hive.bat_\nC9471adc8db180a7da5a56966b156b440483856f\n\n_Shadow.bat_\n4714f1e6bb75a80a8faf69434726d176b70d7bd8\n\n**SHA256**\na0b4e3d7e4cd20d25ad2f92be954b95eea44f8f1944118a3194295c5677db749\n50ad0e6e9dc72d10579c20bb436f09eeaa7bfdbcb5747a2590af667823e85609\n5ae51e30817c0d08d03f120539aedc31d094b080eb70c0691bbfbaa4ec265ef3\n77a398c870ad4904d06d455c9249e7864ac92dda877e288e5718b3c8d9fc6618\ne1a7ddbf735d5c1cb9097d7614840c00e5c4d5107fa687c0ab2a2ec8948ef84e\ned614cba30f26f90815c28e189340843fab0fe7ebe71bb9b4a3cb7c78ff8e3d2\nc5fe23c626413a18cba8fb4ea93df81529c85f470577fb9c2336d6b692689d9d\n88f7544a29a2ceb175a135d9fa221cbfd3e8c71f32dd6b09399717f85ea9afd1\n2f7d37c22e6199d1496f307c676223dda999c136ece4f2748975169b4a48afe5\nfdbc66ebe7af710e15946e1541e2e81ddfd62aa3b35339288a9a244fb56a74cf\n1e21c8e27a97de1796ca47a9613477cf7aec335a783469c5ca3a09d4f07db0ff\nbf7bc94506eb72daec1d310ba038d9c3b115f145594fd271b80fbe911a8f3964\nc04509c1b80c129a7486119436c9ada5b0505358e97c1508b2cfb5c2a177ed11\n612e5ffd09ca30ca9488d802594efb5d41c360f7a439df4ae09b14bce45575ec\n0df750bf15895d410c3f6ce45279ab0329c5c723af38b99aadc9a60bcdc9a71d\n5954558d43884da2c7902ddf89c0cf7cd5bf162d6feefe5ce7d15b16767a27e5\n\n_Hive.bat_\n93852dbd3a977cf2662b0c4db26b627736ba51c0df627eb36b41fdbde093c3c3\n\n_Shadow.bat_\nD158f9d53e7c37eadd3b5cc1b82d095f61484e47eda2c36d9d35f31c0b4d3ff8\n\n\n-----\n\n**COMMUNICATIONS**\n\n**Cobalt Beacon: 176.123.8.228**\n\n**MITRE ATT&CK**\n\n[T1574.001 – Hijack Execution Flow: DLL Search Order Hijacking](https://attack.mitre.org/techniques/T1574/001/)\n\n[TA0005 – Defense Evasion](https://attack.mitre.org/tactics/TA0005/)\n\n[TA0004 – Privilege Escalation](https://attack.mitre.org/tactics/TA0004/)\n\n[T1486 – Data Encrypted for Impact](https://attack.mitre.org/techniques/T1486/)\n\n[T1027.002 – Obfuscated Files or Information: Software Packing](https://attack.mitre.org/techniques/T1027/002/)\n\n[T1003.001 – OS Credential Dumping: LSASS Memory](https://attack.mitre.org/techniques/T1003/001/)\n\n[T1007 – System Service Discovery](https://attack.mitre.org/techniques/T1007/)\n\n[T1059 – Command and Scripting Interpreter](https://attack.mitre.org/techniques/T1059/)\n\n[T1059.001 – Command and Scripting Interpreter: PowerShell](https://attack.mitre.org/techniques/T1059/001/)\n\n[T1059.003 – Command and Scripting Interpreter: Windows Command Shell](https://attack.mitre.org/techniques/T1059/003/)\n\n[T1490 – Inhibit System Recovery](https://attack.mitre.org/techniques/T1490/)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-08-23 - Hive Attacks - Analysis of the Human-Operated Ransomware Targeting Healthcare.pdf"
    ],
    "report_names": [
        "2021-08-23 - Hive Attacks - Analysis of the Human-Operated Ransomware Targeting Healthcare.pdf"
    ],
    "threat_actors": [
        {
            "id": "610a7295-3139-4f34-8cec-b3da40add480",
            "created_at": "2023-01-06T13:46:38.608142Z",
            "updated_at": "2025-03-27T02:00:02.87217Z",
            "deleted_at": null,
            "main_name": "Cobalt",
            "aliases": [
                "Cobalt Gang",
                "GOLD KINGSWOOD",
                "COBALT SPIDER",
                "G0080",
                "Mule Libra",
                "Cobalt Group"
            ],
            "source_name": "MISPGALAXY:Cobalt",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673535842,
    "ts_updated_at": 1743041358,
    "ts_creation_date": 1653787214,
    "ts_modification_date": 1653787214,
    "files": {
        "pdf": "https://archive.orkl.eu/ea31761e551aebf6ae8f9a69ab534c8394280ff8.pdf",
        "text": "https://archive.orkl.eu/ea31761e551aebf6ae8f9a69ab534c8394280ff8.txt",
        "img": "https://archive.orkl.eu/ea31761e551aebf6ae8f9a69ab534c8394280ff8.jpg"
    }
}