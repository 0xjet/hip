{
    "id": "7dc68196-9865-42f4-b20b-2117808f059d",
    "created_at": "2023-01-12T15:01:06.481762Z",
    "updated_at": "2025-03-27T02:05:53.181672Z",
    "deleted_at": null,
    "sha1_hash": "8ad008edf046db237ab913c3e3aabf068eab4a1e",
    "title": "2022-07-11 - Threat Actors Delivers New Rozena backdoor with Follina Bug – Detection & Response",
    "authors": "",
    "file_creation_date": "2022-07-18T18:08:26Z",
    "file_modification_date": "2022-07-18T18:08:26Z",
    "file_size": 602707,
    "plain_text": "# Threat Actors Delivers New Rozena backdoor with Follina Bug – Detection & Response\n\n**[socinvestigation.com/threat-actors-delivers-new-rozena-backdoor-with-follina-bug-detection-response/](https://www.socinvestigation.com/threat-actors-delivers-new-rozena-backdoor-with-follina-bug-detection-response/)**\n\nJuly 11, 2022\n\n#### IOC\n\n By\n\n BalaGanesh \n July 11, 2022 0\n\n Fortinet FortiGuard Labs researchers observed a phishing campaign that is leveraging the recently disclosed Follina security vulnerability (CVE-2022-30190, CVSS score 7.8) to distribute the Rozena backdoor on Windows systems. The Follina issue is a remote code execution vulnerability that resides in the Microsoft Windows Support Diagnostic Tool (MSDT).\n\n\n-----\n\n#### The Rozena backdoor is able to inject a remote shell connection back to the attacker s machine The attack chain leverages a weaponized Office document that once clicked, starts connecting to an external Discord CDN URL ( ‘hxxps://cdn[.]discordapp.com/attachments/986484515985825795/986821210044264468/index[.]htm ) to download an HTML file (index.htm).\n\n Then the HTML file invokes the msdt.exe tool with a PowerShell command which also invokes another web request to download the Rozena backdoor and save it as “Word.exe.”\n\n Also Read: Latest IOCs – Threat Actor URLs, IP’s & Malware Hashes\n\n “The PowerShell code will download one batch file cd.bat and start it with no window to hide. Then it invokes another web request to download Rozena and saves as “Word.exe” in the Windows Tasks folder.” reads the post published by Fortinet FortiGuard Labs.\n\n “the attacker decided to distract the victim. The original file has no content besides an external link in oleObject. To keep the victim from noticing anything odd the batch file downloads another Word document, 1c9c88f811662007.docx with a lot of pictures in it. To make it seem more real, this document is saved in directory C:\\users\\$env:USERNAME\\Downloads, with a shorter name, 18562.docx.”\n\n The main feature of the Rozena backdoor is to inject shellcode that launches a reverse shell to the attacker’s machine (“microsofto.duckdns[.]org”), in this way the attacker can take full control of the system.\n\n Once the Rozena executable is run, it will create a process for a PowerShell command, experts pointed out that the decoded command has only one job to do, injecting the shellcode.\n\n\n-----\n\n#### Source: https://www.fortinet.com Also Read: Threat Hunting Using Powershell and Fileless Malware Attacks\n\n## Indicator of Compromise:\n\n#### SHA256:\n\n 432bae48edf446539cae5e20623c39507ad65e21cb757fb514aba635d3ae67d6\n\n 5d8537bd7e711f430dc0c28a7777c9176269c8d3ff345b9560c8b9d4daaca002\n\n 3558840ffbc81839a5923ed2b675c1970cdd7c9e0036a91a0a728af14f80eff3\n\n 27f3bb9ab8fc66c1ca36fa5d62ee4758f1f8ff75666264c529b0f2abbade9133\n\n 69377adfdfa50928fade860e37b84c10623ef1b11164ccc6c4b013a468601d88\n\n CVE-2022-30190 is a high-severity vulnerability that lets a malicious actor deliver malware though an MS Word document. Microsoft already released a patch for it on June 14, 2022. In this blog we showed how an attacker exploits Follina and included details of Rozena and the SGN ShellCode. Users should apply the patch immediately and also apply FortiGuard protection to avoid the threat.” concludes the report.\n\n Also Read: Soc Interview Questions and Answers – CYBER SECURITY ANALYST\n\n## Detection & Response:\n\n#### Splunk:\n```\nsource=\"WinEventLog:*\" AND ((((CommandLine=\"*msdt.exe*\") AND\n(CommandLine=\"*PCWDiagnostic*\" OR CommandLine=\"*//*\" OR CommandLine=\"*./*\" OR\nCommandLine=\"*/.*\" OR CommandLine=\"*../*\")) OR Image=\"*\\\\word.exe\") OR\n(Image=\"*\\\\powershell.exe\" AND (CommandLine=\"*Invoke-Expression*\" OR\nCommandLine=\"*ExecutionPolicy Bypass*\" OR CommandLine=\"*invoke*\" OR\nCommandLine=\"*NoProfile*\" OR CommandLine=\"*JAB*\")))\n\n Qradar:\n\n```\n\n-----\n\n```\nSELECT UTF8(payload) from events where LOGSOURCETYPENAME(devicetype) Microsoft Windows\nSecurity Event Log' and ((((\"Process CommandLine\" ilike '%msdt.exe%') and (\"Process\nCommandLine\" ilike '%PCWDiagnostic%' or \"Process CommandLine\" ilike '%//%' or \"Process\nCommandLine\" ilike '%./%' or \"Process CommandLine\" ilike '%/.%' or \"Process CommandLine\"\nilike '%../%')) or \"Image\" ilike '%\\word.exe') or (\"Image\" ilike '%\\powershell.exe' and\n(\"Process CommandLine\" ilike '%Invoke-Expression%' or \"Process CommandLine\" ilike\n'%ExecutionPolicy Bypass%' or \"Process CommandLine\" ilike '%invoke%' or \"Process\nCommandLine\" ilike '%NoProfile%' or \"Process CommandLine\" ilike '%JAB%')))\n\n#### Elastic Query:\n(((process.command_line:*msdt.exe* AND process.command_line:(*PCWDiagnostic* OR *\\/\\/* OR\n*.\\/* OR *\\/.* OR *..\\/*)) OR process.executable:*\\\\word.exe) OR\n(process.executable:*\\\\powershell.exe AND process.command_line:(*Invoke\\-Expression* OR\n*ExecutionPolicy\\ Bypass* OR *invoke* OR *NoProfile* OR *JAB*)))\n\n Arcsight:\n(((((((deviceCustomString1 CONTAINS \"*msdt.exe*\" OR destinationServiceName CONTAINS\n\"*msdt.exe*\")) AND ((deviceCustomString1 CONTAINS \"*PCWDiagnostic*\" OR deviceCustomString1\nCONTAINS \"*//*\" OR deviceCustomString1 CONTAINS \"*./*\" OR deviceCustomString1 CONTAINS\n\"*/.*\" OR deviceCustomString1 CONTAINS \"*../*\" OR destinationServiceName CONTAINS\n\"*PCWDiagnostic*\" OR destinationServiceName CONTAINS \"*//*\" OR destinationServiceName\nCONTAINS \"*./*\" OR destinationServiceName CONTAINS \"*/.*\" OR destinationServiceName\nCONTAINS \"*../*\"))) OR ((destinationProcessName ENDSWITH \"\\\\word.exe\" OR sourceProcessName\nENDSWITH \"\\\\word.exe\" OR deviceProcessName ENDSWITH \"\\\\word.exe\")))) OR\n(((destinationProcessName ENDSWITH \"\\\\powershell.exe\" OR sourceProcessName ENDSWITH\n\"\\\\powershell.exe\" OR deviceProcessName ENDSWITH \"\\\\powershell.exe\")) AND\n((deviceCustomString1 CONTAINS \"*Invoke-Expression*\" OR deviceCustomString1 CONTAINS\n\"*ExecutionPolicy Bypass*\" OR deviceCustomString1 CONTAINS \"*invoke*\" OR\ndeviceCustomString1 CONTAINS \"*NoProfile*\" OR deviceCustomString1 CONTAINS \"*JAB*\" OR\ndestinationServiceName CONTAINS \"*Invoke-Expression*\" OR destinationServiceName CONTAINS\n\"*ExecutionPolicy Bypass*\" OR destinationServiceName CONTAINS \"*invoke*\" OR\ndestinationServiceName CONTAINS \"*NoProfile*\" OR destinationServiceName CONTAINS\n\"*JAB*\")))))\n\n CarbonBlack:\n(((process_cmdline:*msdt.exe* AND process_cmdline:(*PCWDiagnostic* OR *\\/\\/* OR *.\\/* OR\n*\\/.* OR *..\\/*)) OR process_name:*\\\\word.exe) OR (process_name:*\\\\powershell.exe AND\nprocess_cmdline:(*Invoke\\-Expression* OR *ExecutionPolicy\\ Bypass* OR *invoke* OR\n*NoProfile* OR *JAB*)))\n\n Crowdstike:\n(((((CommandLine=\"*msdt.exe*\") OR (CommandHistory=\"*msdt.exe*\")) AND\n((CommandLine=\"*PCWDiagnostic*\" OR CommandLine=\"*//*\" OR CommandLine=\"*./*\" OR\nCommandLine=\"*/.*\" OR CommandLine=\"*../*\") OR (CommandHistory=\"*PCWDiagnostic*\" OR\nCommandHistory=\"*//*\" OR CommandHistory=\"*./*\" OR CommandHistory=\"*/.*\" OR\nCommandHistory=\"*../*\"))) OR ImageFileName=\"*\\\\word.exe\") OR\n(ImageFileName=\"*\\\\powershell.exe\" AND ((CommandLine=\"*Invoke-Expression*\" OR\nCommandLine=\"*ExecutionPolicy Bypass*\" OR CommandLine=\"*invoke*\" OR\nCommandLine=\"*NoProfile*\" OR CommandLine=\"*JAB*\") OR (CommandHistory=\"*Invoke-Expression*\"\nOR CommandHistory=\"*ExecutionPolicy Bypass*\" OR CommandHistory=\"*invoke*\" OR\nCommandHistory=\"*NoProfile*\" OR CommandHistory=\"*JAB*\"))))\n\n```\n\n-----\n\n#### Fireeye:\n```\n(metaclass:`windows` (((args:`msdt.exe` args:[`PCWDiagnostic`,`//`,`./`,`/.`,`../`]) OR\nprocess:`*\\word.exe`) OR (process:`*\\powershell.exe` args:[`InvokeExpression`,`ExecutionPolicy Bypass`,`invoke`,`NoProfile`,`JAB`])))\n\n Graylog:\n(((CommandLine.keyword:*msdt.exe* AND CommandLine.keyword:(*PCWDiagnostic* *\\/\\/* *.\\/*\n*\\/.* *..\\/*)) OR Image.keyword:*\\\\word.exe) OR (Image.keyword:*\\\\powershell.exe AND\nCommandLine.keyword:(*Invoke\\-Expression* *ExecutionPolicy\\ Bypass* *invoke* *NoProfile*\n*JAB*)))\n\n Microsoft Defender:\nDeviceProcessEvents | where ((((ProcessCommandLine contains \"msdt.exe\") and\n(ProcessCommandLine contains \"PCWDiagnostic\" or ProcessCommandLine contains \"//\" or\nProcessCommandLine contains \"./\" or ProcessCommandLine contains \"/.\" or ProcessCommandLine\ncontains \"../\")) or FolderPath endswith @\"\\word.exe\") or (FolderPath endswith\n@\"\\powershell.exe\" and (ProcessCommandLine contains \"Invoke-Expression\" or\nProcessCommandLine contains \"ExecutionPolicy Bypass\" or ProcessCommandLine contains\n\"invoke\" or ProcessCommandLine contains \"NoProfile\" or ProcessCommandLine contains\n\"JAB\")))\n\n Microsoft Sentinel:\nSecurityEvent | where EventID == 4688 | where ((((CommandLine contains 'msdt.exe') and\n(CommandLine contains 'PCWDiagnostic' or CommandLine contains '//' or CommandLine contains\n'./' or CommandLine contains '/.' or CommandLine contains '../')) or NewProcessName\nendswith @'\\word.exe') or (NewProcessName endswith @'\\powershell.exe' and (CommandLine\ncontains 'Invoke-Expression' or CommandLine contains 'ExecutionPolicy Bypass' or\nCommandLine contains 'invoke' or CommandLine contains 'NoProfile' or CommandLine contains\n'JAB')))\n\n RSA Netwitness:\n((((CommandLine contains 'msdt\\.exe') && (CommandLine contains 'PCWDiagnostic', '//',\n'./', '/\\.', '.\\./')) || (Image contains 'word.exe')) || ((Image contains\n'powershell.exe') && (CommandLine contains 'Invoke-Expression', 'ExecutionPolicy Bypass',\n'invoke', 'NoProfile', 'JAB')))\n\n Google Chronicle:\n((((target.process.command_line = /.*msdt\\.exe.*/ and (target.process.command_line =\n/.*PCWDiagnostic.*/ or target.process.command_line = /.*\\/\\/.*/ or\ntarget.process.command_line = /.*\\.\\/.*/ or target.process.command_line = /.*\\/\\..*/ or\ntarget.process.command_line = /.*\\.\\.\\/.*/)) or target.process.file.full_path =\n/.*\\\\word\\.exe$/)) or (target.process.file.full_path = /.*\\\\powershell\\.exe$/ and\n(target.process.command_line = /.*Invoke-Expression.*/ or target.process.command_line =\n/.*ExecutionPolicy Bypass.*/ or target.process.command_line = /.*invoke.*/ or\ntarget.process.command_line = /.*NoProfile.*/ or target.process.command_line =\n/.*JAB.*/)))\n\n Aws OpenSearch:\n\n```\n\n-----\n\n```\n(((process.command_line: msdt.exe AND process.command_line:( PCWDiagnostic OR \\/\\/ OR\n*.\\/* OR *\\/.* OR *..\\/*)) OR process.executable:*\\\\word.exe) OR\n(process.executable:*\\\\powershell.exe AND process.command_line:(*Invoke\\-Expression* OR\n*ExecutionPolicy\\ Bypass* OR *invoke* OR *NoProfile* OR *JAB*)))\n\n#### Source/Credits: https://www.fortinet.com/blog/threat-research/follina-rozena-leveraging-discord- to-distribute-a-backdoor\n\n ht://securityaffairs.co/wordpress/133051/hacking/follina-bug-rozena-backdoor.html\n\n### LEAVE A REPLY\n\n#### Please enter your comment!\n\n Please enter your name here\n\n You have entered an incorrect email address!\n\n Please enter your email address here\n\n```\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-07-11 - Threat Actors Delivers New Rozena backdoor with Follina Bug – Detection & Response.pdf"
    ],
    "report_names": [
        "2022-07-11 - Threat Actors Delivers New Rozena backdoor with Follina Bug – Detection & Response.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673535666,
    "ts_updated_at": 1743041153,
    "ts_creation_date": 1658167706,
    "ts_modification_date": 1658167706,
    "files": {
        "pdf": "https://archive.orkl.eu/8ad008edf046db237ab913c3e3aabf068eab4a1e.pdf",
        "text": "https://archive.orkl.eu/8ad008edf046db237ab913c3e3aabf068eab4a1e.txt",
        "img": "https://archive.orkl.eu/8ad008edf046db237ab913c3e3aabf068eab4a1e.jpg"
    }
}