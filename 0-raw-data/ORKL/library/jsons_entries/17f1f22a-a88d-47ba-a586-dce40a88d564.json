{
    "id": "17f1f22a-a88d-47ba-a586-dce40a88d564",
    "created_at": "2023-01-12T14:59:53.086108Z",
    "updated_at": "2025-03-27T02:14:39.119276Z",
    "deleted_at": null,
    "sha1_hash": "0e3a57aba398d50ebbafd8c081b31b7ed620632f",
    "title": "2022-02-10 - Threat Thursday- BHunt Scavenger Harvests Victims’ Crypto Wallets",
    "authors": "",
    "file_creation_date": "2022-05-28T23:21:49Z",
    "file_modification_date": "2022-05-28T23:21:49Z",
    "file_size": 1276049,
    "plain_text": "# Threat Thursday: BHunt Scavenger Harvests Victims’ Crypto Wallets\n\n**[blogs.blackberry.com/en/2022/02/threat-thursday-bhunt-scavenger](https://blogs.blackberry.com/en/2022/02/threat-thursday-bhunt-scavenger)**\n\nThe BlackBerry Research & Intelligence Team\n\nThe fast-rising popularity of cryptocurrency is creating a gold-rush mentality among\nmalware authors. Crypto as a form of payment has become a backbone of the ransomware\nbusiness, but some criminals are taking a more direct approach, going straight at stealing\nthe contents of victims’ crypto wallets. To do this, BHunt scavenges systems for access to a\nvictim’s cryptocurrency, while trying to hide its activities on the system and to slow analysis\nin a variety of ways.\n\nBHunt’s primary goal is to harvest the victim’s crypto wallets. It also attempts to steal\nbrowser passwords in the process, which is likely intended to help it find login credentials\nstored there for online crypto accounts, along with online banking or social media accounts\nthat could be used for financial gains. In certain situations (which we will cover below),\nBHunt will also deploy a crypto miner to the victim’s device or monitor the victim’s clipboard\nfor security passphrases.\n\n\n-----\n\nThis threat tries to slow analysis by obfuscating files with commercial binary packers and\nsplitting its functionality across multiple files. BHunt also takes it a step further by leveraging\nlegitimate tools for nefarious purposes.\n\nIn this blog, we will delve into the inner workings of BHunt to show how it is built to achieve\nits goals.\n\n### Operating System\n\n Risk & Impact\n\n Technical Analysis\n\nBHunt was initially discovered late last year by Bitdefender, who reported that the infection\nbegan with a dropper that was likely packaged with Key Management Service (KMS)\ncracking utilities. These utilities are popular tools designed to bypass Microsoft’s KMS, to\nillegally activate Microsoft® products such as Windows® 10.\n\nThe droppers are written to C:\\\\Windows\\System32 as \"msn.exe” or “msh.exe,” to\nmasquerade as a Microsoft file that the victim might expect to find in a system directory. The\n[threat actors packed the sample with VMProtect to hide their contents, and they also](https://vmpsoft.com/)\nembedded a certificate from “Piriform Ltd” to help the file appear legitimate. Piriform\nSoftware Ltd. is the company that developed the popular PC optimization tool “CCleaner,”\nand was purchased by security company Avast in 2017.\n\nUpon closer inspection, we can see that the certificate shown below does not match the\nactual contents of the binary and is recognized as invalid, as seen in Figure 1.\n\n\n-----\n\n_Figure 1 - Piriform’s signature is recognized as invalid_\n\nNext, the dropper writes its core file, an un-obfuscated .NET executable named BHunt, to\nAppData\\Roaming\\mscrlib.exe. As shown in Figure 2, BHunt consists of multiple\nfunctions/modules:\n\n\n-----\n\n_Figure 2 - BHunt's modular functions_\n\nThe purpose of each module is as follows:\n\n**Log**\n\nThe Log function is an initial survey that reports back to BHunt’s command-and-control (C2)\nserver about the presence of various crypto wallets on targeted machines. It checks for the\npresence of wallets for cryptocurrencies including Atomic, Bitcoin, Electrum, Ethereum,\nExodus, Jaxx and Litecoin. This function also checks to see if BHunt has access to the\nuser’s clipboard, by attempting to store a string in the clipboard and then trying to retrieve it.\n\n**Blackjack**\n\nThe Blackjack function is responsible for stealing wallet files. Although the Log function\nreports on the discovery of specific crypto wallets, Blackjack sweeps the users %AppData%\nfolder for any files called “wallet.dat.” If a file by this name is found, both its contents and\nlocation are sent back to BHunt’s C2.\n\nThe malware authors also accounted for the fact that Exodus uses a different wallet-naming\nconvention, searching for an %AppData%\\Exodus\\exodus.wallet folder. It then sends any\nfiles in that folder back to the C2, again including both the contents and location.\n\n_Figure 3 - Blackjack’s original code_\n\nIn more recent versions of BHunt, the Blackjack function was updated to be more specific,\nsearching only for the presence of an %AppData%\\Exodus\\exodus.wallet\\seed.seco file,\nthus reducing the volume of files being sent back to the C2.\n\n\n-----\n\nExtra code was also added to search for an %AppData%\\Electrum\\wallets folder, sending\nback all files contained in that particular folder.\n\n_Figure 4 - Blackjack’s updated code_\n\n**Sweet_Bonanza**\n\nThe Sweet_Bonanza function attempts to steal the victim’s browser passwords. It starts by\nextracting a binary called “bonanza” out of its resources, which is then written to\n%AppData%\\bonanza.exe.\n\nThis file is then run with the following command line:\n\n“%AppData%\\\\bonanza.exe /stext %AppData%\\\\bonanza”\n\nThis binary, like those used in the other stages, is also packed. Upon running the binary, it\nbecomes clear that the file is NirSoft’s WebBrowserPassView tool. From their website, we\ncan see that the “/stext” command is used to “save the passwords list into a regular text\nfile.”\n\nAfter running the file, this output is sent back to the C2.\n\n**Golden7**\n\nGolden7 starts by searching across all Firefox profile data for the string “accountToken.”\nOnce it finds a file containing the string, it then searches for an associated .SQLITE\ndatabase file. Firefox often has handles to these files open, which prevents their deletion.\nThe malware terminates any running instances of Firefox, enabling it to delete these\ndatabase files after sending them back to the C2.\n\nGolden7 then searches for the presence of Google Chrome™ and an extension called\n[MetaMask, which is used to integrate an Ethereum wallet into the browser. If the extension](https://chrome.google.com/webstore/detail/metamask/nkbihfbeogaeaoehlefnkodbefgpgknn?hl=en)\nis found, then this stage terminates Chrome and searches the extension folder for any files\nwith “ldb” in their extension. These files are then sent to the C2 and deleted locally.\n\nIf either the Chrome or Firefox step is successful, then another resource named \"golden7” is\nwritten to “%appdata%\\\\MS Office.exe,” and persisted using an autorun registry key.\n\nLike the dropper stages, this binary is also obfuscated, this time with a packer called\nThemida. After dumping the unpacked executable from memory, we find that Golden7 is\nrevealed as another .NET executable.\n\n\n-----\n\nThe function of this program is to periodically check the victim s clipboard for a string\ncontaining 12 or 13 words. This string format is commonly used by crypto wallets for\nrecovery passphrases. Upon finding a string that matches the criteria, the string is sent\nback to the C2.\n\n**Chaos_crew**\n\nLike Sweet_Bonanza and Golden7, the Chaos_crew function also writes a binary from its\nresources to disk. The resource named “chaos_crew” is written to\n“%AppData%\\\\Outllook.exe” and is persisted via an autorun registry key.\n\nLike the Golden7 binary, Chaos_crew is also packed with Themida. After following the same\nunpacking technique, we find that it is yet another .NET binary. Chaos_crew is much more\ncomplicated than Golden7, but for brevity’s sake we will focus on its core functionality.\n\nChaos_crew reaches out to two unique Pastebin links to retrieve some encrypted data. The\nfirst encrypted blob is some configuration data with references to the CPU and GPU that the\nmalware saves into the registry. The second encrypted blob gets used in a function called\n“dwfiles,” which downloads files and places them in the “%AppData%\\Scype” folder.\n\nAfter this function, Chaos_crew attempts to create the following processes:\n\n“%AppData%\\Scype\\svx.exe”\n“%AppData%\\Scype\\a\\svc.exe”\n\nThese Pastebins are no longer hosted, so we have not been able to confirm exactly what\ndata was downloaded. Searching on VirusTotal revealed that a file with the name\n%AppData%\\scype\\a\\svc.exe had been seen previously.\n\n[Upon further investigation, we found this file to be XMRig, a high-performance crypto miner.](https://blogs.blackberry.com/en/2019/10/malicious-payloads-hiding-beneath-the-wav)\nThis lines up with our earlier findings about CPU and GPU configuration data. There is\nanother function in Chaos_crew called “vidcheck” which queries the GPU type, and which\nalso corroborates our findings. It appears that the purpose of the Chaos_crew function is to\nevaluate the suitability of the victim’s system for the purposes of installing a crypto miner.\n\n**Copier**\n\nDuring our research, we also found a peculiar .NET binary that we believe to be part of the\nsame malware campaign. Its sole purpose is to copy the file %AppData%\\Scype\\a\\svx.exe,\nif it exists, to %AppData%\\Scype\\a\\svc.exe.\n\nWhat the malware authors were hoping to achieve with this function is a mystery, given that\nthe path referenced in Chaos_crew is %AppData%\\Scype\\svx.exe (note the lack of an “a”\ndirectory in the path).\n\n\n-----\n\n_Figure 5: Copier’s sole functionality_\n\n### Conclusion\n\nBHunt’s strategy of dropping multiple files to disk is a devious way of spreading out the risk\nof detection across its components. Making use of legitimate tools such as Nirsoft’s\nWebBrowserPassView also makes it more difficult to detect these components of the\nmalware on the victim’s system. Security products need to distinguish the context in which\nthe legitimate binaries are being used, which is no easy feat for legacy antivirus software.\n\nAs cryptocurrencies continue to gain in popularity, threat actors will continue to pursue this\nfinancial incentive with increasingly complex and stealthy crypto-stealers keeping defenders\non their toes.\n\n### YARA Rule\n\n[The following YARA rule was authored by the BlackBerry Research & Intelligence Team to](https://blogs.blackberry.com/en/author/the-blackberry-research-and-intelligence-team)\ncatch the threat described in this document:\n\n\n-----\n\n**import \"pe\"**\n\n**rule Mal_Infostealer_Win64_BHunt_2022_01_28**\n\n**{**\n\n**meta:**\n\n**description = \"Detects BHunt Malware Infostealer\"**\n\n**author = \"BlackBerry Research & Intelligence Team\"**\n\n**date = \"Jan 28th 2022\"**\n\n**license = \"This Yara rule is provided under the Apache License 2.0**\n**(https://www.apache.org/licenses/LICENSE-2.0) and open to any user or**\n**organization, as long as you use it under this license and ensure originator credit**\n**in any derivative to The BlackBerry Research & Intelligence Team\"**\n\n**strings:**\n\n**// C2**\n\n**$s1 = \"http://minecraftsquid.hopto.org/ifo.php\" wide**\n\n**// Name of assembly in metadata**\n\n**$s2 = \"BHUNT\" wide**\n\n**// Outlook misspelled in reg key**\n\n**$s3 = \"Outllook\" wide**\n\n**condition:**\n\n**// MZ Header**\n\n**uint16(0) == 0x5a4d and**\n\n**// is a .NET binary**\n\n**pe.data_directories[pe.IMAGE_DIRECTORY_ENTRY_COM_DESCRIPTOR].size != 0**\n**and**\n\n**all of ($s*)**\n\n**}**\n\n### Indicators of Compromise (IoCs)\n\n\n-----\n\n**C2**\n\nhttp[://]minecraftsquid[.]hopto[.]org/ifo[.]php\n\n**Encrypted Data For Chaos_crew**\n\nhttps[://]pastebin[.]com/raw/EGRcZWCa\n\nhttps[://]pastebin[.]com/raw/HMaz9edN\n\n**BHunt**\n\nCFE45218711E6C3B01AC81548F0C96D43CFF41DBFE0FDC29E2CCDCBA61DC1C84\n\nB32C9C13AE27898F77BD6C3484FDE6539DDC142798EB697EF5CBBCBB63A121B3\n\nB1F1D05C13E416402AE7E32ADE9D49F2F058E04CFBF6880BA7719B4383E4AAC5\n\n**Bonanza.exe**\n\nBE43E2437578E7BE2E2D08E389B9C02394BD66782DC6508302696C68E1BC6AE0\n\n**Outllook.exe**\n\n5C275655655CC2A1ACC91D8FEC801E4D20EFB717484FF7897EE49BF155EC2141\n\n**MS Office.exe**\n\n23751B815EFC2330051CC516BAEF1E1AA36C5E9EB8F515229535AC962B7DD0C9\n\n**Mrpropper Cleaner**\n\nC8BD186C08BDB019CC1F6CF01CB94910082AE02A2A3AD065E90340723E9320FE\n\n**XMrig miner believed to be %APPDATA%\\scype\\a\\svc.exe**\n\n592F207C7A28AF0C70217B497356C10FE35A8677F68DA60650FDCEEE4D8310BE\n\n**Copier**\n\n70CC9D323EB0ABE1263B51D44DEEDD6D72EE87863176ED1C67746F35AEB41535\n\n### BlackBerry Assistance\n\nIf you’re battling this malware or a similar threat, you’ve come to the right place, regardless\nof your existing BlackBerry relationship.\n\n[The BlackBerry Incident Response team is made up of world-class consultants dedicated to](https://www.blackberry.com/us/en/services/incident-response)\nhandling response and containment services for a wide range of incidents, including\nransomware and Advanced Persistent Threat (APT) cases.\n\nWe have a global consulting team standing by to assist you, providing around-the-clock\nsupport where required, as well as local assistance. Please contact us\nhere: https://www.blackberry.com/us/en/forms/cylance/handraiser/emergency-incidentresponse-containment\n\n\n-----\n\n## About The BlackBerry Research & Intelligence Team\n\nThe BlackBerry Research & Intelligence team examines emerging and persistent threats,\nproviding intelligence analysis for the benefit of defenders and the organizations they serve.\n\nBack\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-02-10 - Threat Thursday- BHunt Scavenger Harvests Victims’ Crypto Wallets.pdf"
    ],
    "report_names": [
        "2022-02-10 - Threat Thursday- BHunt Scavenger Harvests Victims’ Crypto Wallets.pdf"
    ],
    "threat_actors": [
        {
            "id": "a66438a8-ebf6-4397-9ad5-ed07f93330aa",
            "created_at": "2022-10-25T16:47:55.919702Z",
            "updated_at": "2025-03-27T02:05:17.412024Z",
            "deleted_at": null,
            "main_name": "IRON VIKING",
            "aliases": [
                "ATK14 ",
                "BlackEnergy Group",
                "Blue Echidna ",
                "CTG-7263 ",
                "ELECTRUM ",
                "FROZENBARENTS ",
                "Hades/OlympicDestroyer ",
                "IRIDIUM ",
                "Qudedagh ",
                "Sandworm Team ",
                "Seashell Blizzard ",
                "TEMP.Noble ",
                "Telebots ",
                "Voodoo Bear ",
                "APT44 "
            ],
            "source_name": "Secureworks:IRON VIKING",
            "tools": [
                " BlackEnergy",
                " GCat",
                " GreyEnergy",
                " Industroyer",
                " KillDisk",
                " NotPetya",
                " PSCrypt",
                " TeleBot",
                " TeleDoor",
                " xData",
                "BadRabbit"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "b3e954e8-8bbb-46f3-84de-d6f12dc7e1a6",
            "created_at": "2022-10-25T15:50:23.339976Z",
            "updated_at": "2025-03-27T02:00:55.446795Z",
            "deleted_at": null,
            "main_name": "Sandworm Team",
            "aliases": [
                "Sandworm Team",
                "ELECTRUM",
                "Telebots",
                "IRON VIKING",
                "BlackEnergy (Group)",
                "Quedagh",
                "Voodoo Bear",
                "IRIDIUM",
                "Seashell Blizzard",
                "FROZENBARENTS",
                "APT44"
            ],
            "source_name": "MITRE:Sandworm Team",
            "tools": [
                "Bad Rabbit",
                "Mimikatz",
                "Exaramel for Linux",
                "Exaramel for Windows",
                "GreyEnergy",
                "PsExec",
                "Prestige",
                "P.A.S. Webshell",
                "VPNFilter",
                "Cyclops Blink",
                "SDelete",
                "AcidRain",
                "Industroyer",
                "Industroyer2",
                "BlackEnergy",
                "Cobalt Strike",
                "NotPetya",
                "KillDisk",
                "PoshC2",
                "Impacket",
                "Invoke-PSImage",
                "Olympic Destroyer"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "3a0be4ff-9074-4efd-98e4-47c6a62b14ad",
            "created_at": "2022-10-25T16:07:23.590051Z",
            "updated_at": "2025-03-27T02:02:09.878211Z",
            "deleted_at": null,
            "main_name": "Energetic Bear",
            "aliases": [
                "ATK 6",
                "Blue Kraken",
                "Crouching Yeti",
                "Dragonfly",
                "Electrum",
                "Energetic Bear",
                "Ghost Blizzard",
                "Group 24",
                "ITG15",
                "Iron Liberty",
                "Koala Team",
                "TG-4192"
            ],
            "source_name": "ETDA:Energetic Bear",
            "tools": [
                "Backdoor.Oldrea",
                "CRASHOVERRIDE",
                "Commix",
                "CrackMapExec",
                "CrashOverride",
                "Dirsearch",
                "Dorshel",
                "Fertger",
                "Fuerboos",
                "Goodor",
                "Havex",
                "Havex RAT",
                "Hello EK",
                "Heriplor",
                "Impacket",
                "Industroyer",
                "Karagany",
                "Karagny",
                "LightsOut 2.0",
                "LightsOut EK",
                "Listrix",
                "Oldrea",
                "PEACEPIPE",
                "PHPMailer",
                "PsExec",
                "SMBTrap",
                "Subbrute",
                "Sublist3r",
                "Sysmain",
                "Trojan.Karagany",
                "WSO",
                "Webshell by Orb",
                "Win32/Industroyer",
                "Wpscan",
                "nmap",
                "sqlmap",
                "xFrost"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "1a9c4f3f-2178-4c83-a9b5-d2135d90520a",
            "created_at": "2024-04-19T02:00:03.623733Z",
            "updated_at": "2025-03-27T02:00:03.350772Z",
            "deleted_at": null,
            "main_name": "BlackJack",
            "aliases": [],
            "source_name": "MISPGALAXY:BlackJack",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "8941e146-3e7f-4b4e-9b66-c2da052ee6df",
            "created_at": "2023-01-06T13:46:38.402513Z",
            "updated_at": "2025-03-27T02:00:02.824555Z",
            "deleted_at": null,
            "main_name": "Sandworm",
            "aliases": [
                "G0034",
                "IRIDIUM",
                "Blue Echidna",
                "FROZENBARENTS",
                "Seashell Blizzard",
                "IRON VIKING",
                "ELECTRUM",
                "TeleBots",
                "UAC-0113",
                "UAC-0082",
                "APT44",
                "Quedagh",
                "VOODOO BEAR",
                "TEMP.Noble"
            ],
            "source_name": "MISPGALAXY:Sandworm",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673535593,
    "ts_updated_at": 1743041679,
    "ts_creation_date": 1653780109,
    "ts_modification_date": 1653780109,
    "files": {
        "pdf": "https://archive.orkl.eu/0e3a57aba398d50ebbafd8c081b31b7ed620632f.pdf",
        "text": "https://archive.orkl.eu/0e3a57aba398d50ebbafd8c081b31b7ed620632f.txt",
        "img": "https://archive.orkl.eu/0e3a57aba398d50ebbafd8c081b31b7ed620632f.jpg"
    }
}