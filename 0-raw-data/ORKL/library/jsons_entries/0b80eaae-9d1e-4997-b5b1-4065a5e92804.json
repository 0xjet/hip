{
    "id": "0b80eaae-9d1e-4997-b5b1-4065a5e92804",
    "created_at": "2023-01-12T14:59:02.670388Z",
    "updated_at": "2025-03-27T02:14:02.706237Z",
    "deleted_at": null,
    "sha1_hash": "6a7e1026effe3ecd9d9e2f81a353ba8ca7a8a516",
    "title": "2019-03-11 - Gaming industry still in the scope of attackers in Asia",
    "authors": "",
    "file_creation_date": "2022-05-28T16:10:42Z",
    "file_modification_date": "2022-05-28T16:10:42Z",
    "file_size": 836575,
    "plain_text": "# Gaming industry still in the scope of attackers in Asia\n\n**welivesecurity.com/2019/03/11/gaming-industry-scope-attackers-asia/**\n\nAsian game developers again targeted in supply-chain attacks distributing malware in legitimately signed software\n\n[Marc-Etienne M.Léveillé](https://www.welivesecurity.com/author/marc-etienne/)\n11 Mar 2019 - 11:27AM\n\nAsian game developers again targeted in supply-chain attacks distributing malware in legitimately signed software\n\n\nMarch 11, 2019\n\n\nThis is not the first time the gaming industry has been targeted by attackers who compromise game developers, insert\nbackdoors into a game’s build environment, and then have their malware distributed as legitimate software. In April 2013,\n[Kaspersky Lab reported that a popular game was altered to include a backdoor in 2011. That attack was attributed to](https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2018/03/20134508/winnti-more-than-just-a-game-130410.pdf)\nperpetrators Kaspersky called the Winnti Group.\n\nYet again, new supply-chain attacks recently caught the attention of ESET Researchers. This time, two games and one gaming\nplatform application were compromised to include a backdoor. Given that these attacks were mostly targeted against Asia and\nthe gaming industry, it shouldn’t be surprising they are the work of the group described in Kaspersky’s “Winnti – More than just\na game”.\n\n\n-----\n\n## Three Cases, Same Backdoor\n\nAlthough the malware uses different configurations in each case, the three affected software products included the same\nbackdoor code and were launched using the same mechanism. While two of the compromised products no longer include the\nbackdoor, one of the affected developers is still distributing the trojanized version: ironically, the game is named Infestation, and\nis produced by Thai developer Electronics Extreme. We have tried informing them several times, through various channels,\nsince early February, but without apparent success.\n\nLet’s look at how the malicious payload is embedded and then look into the details of the backdoor itself.\n\n## Embedding the payload\n\nThe payload code is started very early during the execution of the backdoored executable file. Right after the PE entry point, the\nstandard call to the C Runtime initialization (__scrt_common_main_seh in Figure 1) is hooked to launch the malicious payload\nbefore everything else (Figure 2). This may suggest that the malefactor changed a build configuration rather than the source\ncode itself.\n\nFigure 1 Clean executable file entry point\n\nFigure 2 Compromised executable file entry point\n\nThe code added to the executable decrypts and launches the backdoor in-memory before resuming normal execution of the C\nRuntime initialization code and all the subsequent code of the host application. The embedded payload data has a specific\nstructure, seen in Figure 3, that is parsed by the added unpacking code.\n\nFigure 3 Embedded payload structure\n\nIt includes an RC4 key (which is XORed with 0x37) that is used to decrypt a filename and the embedded DLL file.\n\n\n-----\n\n## The malicious payload\n\nThe actual malicious payload is quite small and only contains about 17 KB of code and data.\n\n## Configuration\n\nIllustrated in Figure 4, the configuration data is simply a whitespace-separated list of strings.\n\nFigure 4 Payload configuration data\n\nThe configuration consists of four fields:\n\n1. C&C server URL.\n2. Variable (t) used to determine the time to sleep in milliseconds before continuing the execution. Wait time is chosen\n\nrandomly in the range 2/3 t to 5/3 t.\n3. A string identifying a campaign.\n4. A semicolon-separated list of executable filenames. If any of them are running, the backdoor stops its execution.\n\nESET researchers have identified five versions of the payload:\n\n**Truncated SHA-1** **PE Compile time (UTC)** **C&C server URL**\n\n`a045939f` 2018-07-11 15:45:57 https://bugcheck.xigncodeservice[.]com/Common/Lib/Common_bsod.php\n\n`a260dcf1` 2018-07-11 15:45:57 https://bugcheck.xigncodeservice[.]com/Common/Lib/Common_Include.php\n\n`dde82093` 2018-07-11 15:45:57 https://bugcheck.xigncodeservice[.]com/Common/Lib/common.php\n\n`44260a1d` 2018-08-15 10:59:09 https://dump.gxxservice[.]com/common/up/up_base.php\n\n`8272c1f4` 2018-11-01 13:16:24 https://nw.infestexe[.]com/version/last.php\n\nIn the first three variants, the code was not recompiled, but the configuration data was edited in the DLL file itself. The rest of\nthe content is a byte for byte copy.\n\n## C&C infrastructure\n\nDomain names were carefully chosen to look like they are related to the game or application publisher. The apex domain was\nset to redirect to a relevant legitimate site using the Namecheap redirection service, while the subdomain points to the malicious\nC&C server.\n\n**Domain name** **Registration date** **Redirection target**\n\nxigncodeservice.com 2018-07-10 09:18:17 https://namu.wiki/[w]/XIGNCODE\n\ngxxservice.com 2018-08-14 13:53:41 None or unknown\n\ninfestexe.com 2018-11-07 08:46:44 https://www.facebook.com/infest.[in].[th]\n\n**Subdomain name** **IP addresses** **Provider**\n\nbugcheck.xigncodeservice.com 167.99.106[.]49, 178.128.180[.]206 DigitalOcean\n\ndump.gxxservice.com 142.93.204[.]230 DigitalOcean\n\nnw.infestexe.com 138.68.14[.]195 DigitalOcean\n\nAt the time of writing, none of the domains resolve and the C&C servers are not responding.\n\n\n-----\n\n## Reconnaissance report\n\nA bot identifier is generated from the machine’s MAC address. The backdoor reports information about the machine such as the\nuser name, computer name, Windows version and system language to the C&C server and awaits commands. The data is\nXOR encrypted with the key “*&b0i0rong2Y7un1” and base64-encoded. The data received from the C&C server is encrypted\nusing the same key.\n\n## Commands\n\nThis simple backdoor has only four commands that can be used by the attacker:\n\nDownUrlFile\nDownRunUrlFile\nRunUrlBinInMem\nUnInstall\n\nThe commands are pretty much self-explanatory. They allow the attacker to run additional executables from a given URL.\n\nThe last one is perhaps less obvious. The UnInstall command doesn’t remove the malware from the system. After all, it is\nembedded inside a legitimate executable that still needs to run. Rather than removing anything, it disables the malicious code\nby setting the following registry value to 1:\n\nHKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\ImageFlag\n\nWhen the payload is started, the registry value is queried and execution is aborted if set. Perhaps the attackers are trying to\nreduce the load from their C&C servers by avoiding callbacks from uninteresting victims.\n\n## Second stage\n\nBased on ESET telemetry, one of the second stage payload delivered to victims is Win64/Winnti.BN. As far as we can tell, its\ndropper was downloaded over HTTPS from api.goallbandungtravel[.]com. We have seen it installed as a Windows service and\nas a DLL in C:\\Windows\\System32 using the following file names:\n\ncscsrv.dll\ndwmsvc.dll\niassrv.dll\nmprsvc.dll\nnlasrv.dll\npowfsvc.dll\nracsvc.dll\nslcsvc.dll\nsnmpsvc.dll\nsspisvc.dll\n\nThe samples we have analyzed were actually quite large, each of them about 60 MB. This is, however, only for appearance\nbecause the real size or the PE file is between 63 KB and 72 KB, depending on the version. The malware files simply have lots\nof clean files appended to them. This is probably done by the component that drops and installs this malicious service.\n\nOnce the service runs, it appends the extension .mui to its DLL path, reads that file and decrypts it using RC5. The decrypted\nMUI file contains position-independent code at offset 0. The RC5 key is derived from the hard drive serial number and the string\n“f@Ukd!rCto R$.” — we were not able to obtain any MUI files nor the code that installs them in the first place. Thus, we do not\nknow the exact purpose of this malicious service.\n\nRecent versions of the malware include an “auto-update” mechanism, using C&C server http://checkin.travelsanignacio[.]com.\nThat C&C server served the latest version of the MUI files encrypted with a static RC5 key. The C&C server was not responding\nduring our analysis.\n\n## Targets\n\n\n-----\n\nLet s start with who is not targeted. Early in the payload, the malware checks to see if the system language is Russian or\nChinese (Figure 5). In either case, the malware stops running. There is no way around this: the attackers are simply not\ninterested in computers configured with those languages.\n\nFigure 5 Language checks before running the payload\n\n## Distribution statistics\n\nESET telemetry shows victims are mostly located in Asia, with Thailand having the largest part of the pie. Given the popularity\nof the compromised application that is still being distributed by its developer, it wouldn’t be surprising if the number of victims is\nin the tens or hundreds of thousands.\n\n## Conclusion\n\nSupply-chain attacks are hard to detect from the consumer perspective. It is impossible to start analyzing every piece of\nsoftware we run, especially with all the regular updates we are encouraged or required to install. So, we put our trust in software\nvendors that the files they distribute don’t include malware. Perhaps that’s the reason multiple groups target software\ndevelopers: compromising the vendor results in a botnet as popular as the software that is hacked. However, there is a\ndownside of using such a technique: once the scheme is uncovered, the attacker loses control and computers can be cleaned\nthrough regular updates.\n\n\n-----\n\nWe do not know the motives of the attackers at this point. Is it simply financial gain? Are there any reasons why the three\naffected products are from Asian developers and for the Asian market? Do these attackers use a botnet as part of a larger\nespionage operation?\n\nESET products detect this threat as Win32/HackedApp.Winnti.A, Win32/HackedApp.Winnti.B, the payload as Win32/Winnti.AG,\nand the second stage as Win64/Winnti.BN.\n\n## Indicators of Compromise (IoCs)\n\n### Compromised file samples (Win32/HackedApp.Winnti.A and B)\n\n**SHA-1** **Compile Time (UTC)** **RC4 key** **Payload SHA-1**\n\n`7cf41b1acfb05064518a2ad9e4c16fde9185cd4b` Tue Nov 13 10:12:58 2018 `1729131071` `8272c1f4`\n\n`7f73def251fcc34cbd6f5ac61822913479124a2a` Wed Nov 14 03:50:18 2018 `19317120` `44260a1d`\n\n`dac0bd8972f23c9b5f7f8f06c5d629eac7926269` Tue Nov 27 03:05:16 2018 `1729131071` `8272c1f4`\n\nSome hashes were redacted per request from one of the vendor. If for a particular reason you need them, reach out to us at\nthreatintel@eset.com.\n\n### Payload Samples (Win32/Winnti.AG)\n\n**SHA-1** **C&C server URL**\n\n`a045939f53c5ad2c0f7368b082aa7b0bd7b116da` https://bugcheck.xigncodeservice[.]com/Common/Lib/Common_bsod.php\n\n`a260dcf193e747cee49ae83568eea6c04bf93cb3` https://bugcheck.xigncodeservice[.]com/Common/Lib/Common_Include.php\n\n`dde82093decde6371eb852a5e9a1aa4acf3b56ba` https://bugcheck.xigncodeservice[.]com/Common/Lib/common.php\n\n`8272c1f41f7c223316c0d78bd3bd5744e25c2e9f` https://nw.infestexe[.]com/version/last.php\n\n`44260a1dfd92922a621124640015160e621f32d5` https://dump.gxxservice[.]com/common/up/up_base.php\n\n### Second stage samples (Win64/Winnti.BN)\n\nDropper delivered by api.goallbandungtravel[.]com.\n\n**SHA-1** **Compile Time (UTC)** **C&C server URL prefix**\n\n`4256fa6f6a39add6a1fa10ef1497a74088f12be0` 2018-07-25 10:13:41 None\n\n`bb4ab0d8d05a3404f1f53f152ebd79f4ba4d4d81` 2018-10-10 09:57:31 http://checkin.travelsanignacio[.]com\n\n### MITRE ATT&CK matrix\n\n**ID** **Description**\n\nT1195 Supply Chain Compromise\n\nT1050 New Service\n\nT1022 Data Encrypted\n\nT1079 Multilayer Encryption\n\nT1032 Standard Cryptographic Protocol (RC4, RC5)\n\nT1043 Commonly Used Port (80,443)\n\nT1009 Binary Padding\n\n\n-----\n\n11 Mar 2019 11:27AM\n\n### Sign up to receive an email update whenever a new article is published in our Ukraine Crisis – Digital Security Resource Center\n\n Newsletter\n\n Discussion\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2019/2019-03-11 - Gaming industry still in the scope of attackers in Asia.pdf"
    ],
    "report_names": [
        "2019-03-11 - Gaming industry still in the scope of attackers in Asia.pdf"
    ],
    "threat_actors": [
        {
            "id": "5bbced13-72f7-40dc-8c41-dcce75bf885e",
            "created_at": "2022-10-25T15:50:23.695735Z",
            "updated_at": "2025-03-27T02:00:55.525839Z",
            "deleted_at": null,
            "main_name": "Winnti Group",
            "aliases": [
                "Winnti Group"
            ],
            "source_name": "MITRE:Winnti Group",
            "tools": [
                "PipeMon",
                "Winnti for Windows",
                "PlugX"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "945a572f-ebe3-4e2f-a288-512fe751cfa8",
            "created_at": "2022-10-25T16:07:24.413971Z",
            "updated_at": "2025-03-27T02:02:10.212853Z",
            "deleted_at": null,
            "main_name": "Winnti Group",
            "aliases": [
                "Wicked Panda",
                "Winnti Group"
            ],
            "source_name": "ETDA:Winnti Group",
            "tools": [
                "Agentemis",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "FunnySwitch",
                "RbDoor",
                "RibDoor",
                "RouterGod",
                "Winnti",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "4c68ccd0-caba-4189-9ead-86ac4c2d9b70",
            "created_at": "2024-05-01T02:03:07.930196Z",
            "updated_at": "2025-03-27T02:05:17.251237Z",
            "deleted_at": null,
            "main_name": "BRONZE ATLAS",
            "aliases": [
                "Axiom",
                "BARIUM ",
                "Blackfly ",
                "CTG-2633",
                "GREF",
                "Group 72 ",
                "Red Kelpie ",
                "TG-2633 ",
                "Wicked Panda ",
                "Winnti",
                "APT41 "
            ],
            "source_name": "Secureworks:BRONZE ATLAS",
            "tools": [
                " CCleaner v5.33 backdoor",
                " ChinaChopper",
                " Cobalt Strike",
                " Dicey MSDN",
                " ForkPlayground",
                " HUC Proxy Malware (Htran)",
                " Mimikatz",
                " PipeMon",
                " PlugX",
                " PortReuse",
                " Powershell Empire",
                " RCMD",
                " RbDoor",
                " SPEEDBOAT",
                " ShadowPad",
                " Sidewalk",
                " Speculoos",
                " TeamViewer",
                " Winnkit",
                " Winnti",
                " reg save",
                " vssadmin",
                "Acehash"
            ],
            "source_id": "Secureworks",
            "reports": null
        }
    ],
    "ts_created_at": 1673535542,
    "ts_updated_at": 1743041642,
    "ts_creation_date": 1653754242,
    "ts_modification_date": 1653754242,
    "files": {
        "pdf": "https://archive.orkl.eu/6a7e1026effe3ecd9d9e2f81a353ba8ca7a8a516.pdf",
        "text": "https://archive.orkl.eu/6a7e1026effe3ecd9d9e2f81a353ba8ca7a8a516.txt",
        "img": "https://archive.orkl.eu/6a7e1026effe3ecd9d9e2f81a353ba8ca7a8a516.jpg"
    }
}