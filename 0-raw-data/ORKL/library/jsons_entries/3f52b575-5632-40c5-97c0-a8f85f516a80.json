{
    "id": "3f52b575-5632-40c5-97c0-a8f85f516a80",
    "created_at": "2023-01-12T15:04:27.062531Z",
    "updated_at": "2025-03-27T02:05:56.670106Z",
    "deleted_at": null,
    "sha1_hash": "a39b56cc10360f23b3e03e13a9c53f75b8bead25",
    "title": "2022-05-05 - A Sticky Situation Part 1- The Pervasive Nature of Credit Card Skimmers",
    "authors": "",
    "file_creation_date": "2022-09-01T10:19:52Z",
    "file_modification_date": "2022-09-01T10:19:52Z",
    "file_size": 3777464,
    "plain_text": "# A Sticky Situation Part 1: The Pervasive Nature of Credit Card Skimmers\n\n**[domaintools.com/resources/blog/a-sticky-situation-part-1-the-pervasive-nature-of-credit-card-skimmers](https://www.domaintools.com/resources/blog/a-sticky-situation-part-1-the-pervasive-nature-of-credit-card-skimmers)**\n\nMay 5, 2022\n\n[Blog](https://www.domaintools.com/resources/blog/) [DomainTools Research](https://www.domaintools.com/resources/tag/domaintools-research/)\n\n\n-----\n\n[DomainTools Research @SecuritySnacks](https://www.domaintools.com/authors/domaintools-research/)\n\n## An Introduction to Credit Card Skimmers\n\n\n-----\n\n_Figure 1: One variation of CaramelCorp logo and branding, likely created by the threat actor_\n_“Mazafaker.”_\n\nCredit card skimmers running on compromised ecommerce websites continue to threaten\nfinancial institutions, online merchants, and consumers, leading to cycles of fraud and\nvictimization that can reverberate for years. Even with prompt detection and remediation, the\nmanner in which stolen data is exploited and distributed within cybercrime communities–\ntypically long before victims realize their payment details were obtained illegally–only\ncompounds this problem.\n\nSkimmers use seemingly benign JavaScript deployed on a legitimate, but compromised,\necommerce website that “skims” payment form data and sends it to a malicious host before\nsubmitting that form data to that same ecommerce website, leaving the victim none the\nwiser.\n\nSkimming has proven itself to be an extremely lucrative form of cybercrime. This success\ngave rise to a specialized underground economy with skimmer-as-a-service providers at its\ncore. These services provide everything an aspiring cybercriminal needs to steal payment\nform data–a skimmer script, methods for deploying that skimmer, and a management panel\nto track and validate skimming campaigns. The significance of skimming services cannot be\nunderstated. Technical barriers to entry that once existed are simply no longer there, making\nskimming all the more easy to commit.\n\nThe threat posed by credit card skimmers illustrates the interplay between adversary\ncreativity, technical execution, and human behavior, namely the exploitation of trust and\nperception of safety in everyday activities.\n\n\n-----\n\nSince skimming relies on a legitimate, though compromised, ecommerce website\nrunning malicious code, these attacks are often difficult to detect by user and\nadministrator alike.\n\nEven the most cautious user will often let their guard down on familiar websites. And, at the\nvery same time, the threat actors behind skimming attacks make similar mistakes. This is the\ncase here.\n\nThis series explores a number of obscure but premium services that enable cybercrime and\nonline fraud to thrive and scale. Here, we explore an obscure but noteworthy skimmer-as-aservice named Caramel sold by an organization named CaramelCorp.\n\n## A growing problem\n\nGiven the relative ease of deployment compared to more complex attack vectors and the\nhigh success rate such campaigns often have (especially when running on a high-volume\nseller’s website), skimming activity unsurprisingly continues to grow in popularity. Several\nfactors contribute to this trend, including:\n\n1. A supply of vulnerable ecommerce websites that are easy to identify en masse and\n\noften lack a dedicated security team are easy targets.\n2. The relative ease of malicious JavaScript injection, whether done programmatically or\n\nadded using a website’s administration panel, in addition to other techniques using a\nwide range of tools and services promoted within cybercrime communities.\n3. The potential for a significant return on investment for compromised high-volume\n\nsellers even when merchants promptly detect and remediate such an attack offsets the\nrisk of running such an operation.\n4. Exploiting and offloading stolen data is a “cheap and easy” endeavor compared to\n\ncomplex fraud but also can provide the foundation for high-value, targeted fraud\noperations.\n5. Skimming operations are nimble and adapt to counter defender detection methods,\n\nincluding thorough obfuscation and anti-analysis tactics, and frequently deploy\nskimmers in bulk.\n\nThese skimming campaigns can also be managed from a centralized panel, allowing\nattackers to monitor and adjust their activities to maximize profits. Additionally, centralized\nmanagement infrastructure used by skimming-as-a-service likely means stolen payment data\nends up in the hands of several criminals, perhaps without their knowledge.\n\n## Caramel Skimmer\n\n\n-----\n\n_Figure 2: Caramel management panel found at caramelcorp[.]cc._\n\nCaramelCorp is a Russian-language credit card skimming service with a significant\ncybercrime forum presence. They appear to screen prospective customers carefully and are\nreluctant to interact with non-Russian speakers. Like other cautious cybercrime services,\nCaramelCorp appears to use fluency and familiarity with modern idiomatic language and\n[cultural references as an initial vetting mechanism. Further, CaramelCorp generally refuses](https://www.domaintools.com/resources/blog/spm55-ascending-the-ranks-of-indonesian-phishing-as-a-service-offerings)\nto sell licenses to inexperienced carders, likely in order to mitigate potential exposure arising\nfrom customer incompetence. This reluctance is perhaps one reason Caramel avoids\nsignificant scrutiny from security vendors and researchers. Their purported selectivity,\nhowever, appears to contradict some artifacts discovered as part of this investigation.\n\nA lifetime subscription for Caramel sells for 2,000 USD, provided CaramelCorp agrees to\nsell. Their marketing claims to have a number of valuable features for supporting credit card\nskimming activities. These features broadly belong to four groups: (1) deployment, (2)\ncollection, (3) administration, and (4) anti-detection measures. Also noteworthy is the\nflexibility of their data processing and exfiltration. Code comments suggest more than one\ndeveloper works on the Caramel skimmer.\n\n\n-----\n\n_Figure 3: Russian language post promoting the Caramel skimmer._\n\nOne threat actor promoting CaramelCorp uses the handle “letsz0ck3r” and has a significant\npresence on a number of Russian-language cybercrime forums in addition to a Telegram\npresence. Such actor’s cybercrime activities are not limited to credit card skimming.\n\n_Figure 4: Profile header for “letsz0ck3r.”_\n\n\n-----\n\n_Figure 5: Forum post offloading spent and/or low value account credentials to other forum_\n_members._\n\n### Deployment\n\nCaramelCorp marketing materials include unverified claims that Caramel can bypass certain\nservices from Akamai, Cloudflare, and Incapsula, among others. Further, CaramelCorp\nclaims to provide easily deployable gateways to receive skimmed data and capabilities to\nmonitor them for downtime. Additionally, CaramelCorp offers a quickstart guide on JavaScript\nskimming methods targeting several ecommerce content management systems.\n\n### Collection\n\nLike other modern credit card skimmers, Caramel uses the setInterval() method that calls the\n“send” function every second regardless of whether a target submits form data. This method\nensures data exfiltration for even partially completed form fields.\n\nIn essence, even targets that decide not to purchase an item during a website’s\ncheckout flow still lose a portion of their payment data to the skimmer’s operators.\n\n\n-----\n\nCaramelCorp also claims that their skimmers can be deployed using a variety of file types to\nhelp evade detection.\n\n### Administration\n\nA management panel allows monitoring and management of compromised online merchants\nalong with performance tracking. CaramelCorp also claims to provide easily deployable\ngateways to receive skimmed data, though it appears that they merely provide a how-to and\nbasic configuration guide. This management panel focuses on minimizing attack surface by\neliminating unnecessary code, which may not be the case.\n\n### Anti-Detection Measures\n\nCaramelCorp claims their obfuscated JavaScript is undetected by most scanners. To achieve\nsome of these claims, CaramelCorp recommends the legitimate, albeit heavily abused,\n[JavaScript Obfuscator tool.](https://github.com/javascript-obfuscator)\n\n**A Small Misstep**\n\nA React application, CaramelCorp’s management panel contains several technical missteps\nrelated to authentication and what static content they chose to include for unauthenticated\nvisitors. Perhaps the most interesting of these is what CaramelCorp chose to include as\ncomments in their code. Also noteworthy are the form fields, support for several CMS\nplatforms, and how this skimmer processes data.\n\n_Figure 6: Open directory containing JavaScript and source map files for caramelcorp[.]cc._\n\nAn open directory exposed to the public web containing a sourcemap file also revealed at\nleast a portion of Caramel’s quickstart guide along with a glimpse into their skimming\napparatus.\n\n\n-----\n\n_Figure 7: Open directory containing image assets for caramelcorp[.]cc, including code_\n_screenshots._\n\nAn additional open directory revealed images contained in this quickstart guide as well,\nincluding what they claim to be a successfully deployed Caramel skimmer on a compromised\nNigerian ecommerce store.\n\n_Figure 8: A screenshot found in a caramelcorp[.]cc open directory allegedly showing a_\n_properly deployed and working skimmer deployment on what appears to be a compromised_\n_Nigerian ecommerce website._\n\nCaramelCorp also uploaded a screenshot of their recommended JavaScript Obfuscator\nsettings, included in part below. Including such a screenshot suggests their quickstart guide\nis focused on supporting less technically adept customers.\n\n\n-----\n\n_Figure 9: A partial screenshot of the preferred JavaScript Obfuscator tool settings to hide the_\n_Caramel card skimmer._\n\nThe JavaScript Obfuscator tool offers several transformations that make detection and\nanalysis more difficult, including string array rotation, array shuffling, string array encoding,\nunicode escape sequencing, control flow flattening, and dead code injection. Ultimately, such\nfunctionality–though robust–makes detection and analysis more difficult, but it does not\nnecessarily prevent it. This is especially true when a threat actor recommends specifically\nhow to use such a tool in conjunction with a credit card skimmer.\n\n\n-----\n\nCaramelCorp administrators also uploaded screenshots of JavaScript that match those\nanalyzed in this report and, notably, the baseURL https://caramelcorp[.]cc/api.\n\n_Figure 10: A code snippet screenshot uploaded by CaramelCorp administrators._\n\n\n-----\n\n_Figure 11: A code snippet showing one example of the mathBA and mathCC functions that_\n_the Caramel skimmer appears to be built around._\n\nCaramelCorp appears to recommend an extremely simple method for deployment:\naccessing a CMS administration panel and manually adding a script. A section of their\nquickstart guide includes a screenshot of a Magento administrator panel:\n\n\n-----\n\n_Figure 12: Screenshot demonstrating where Caramel customers should add their skimmer_\n_script if they have access to a Magento administrator panel. The quickstart guide appears_\n_focused on beginners and does not contain information on programmatic code injection._\n\nAnalysis of Caramel source map and Javascript files revealed significant amounts of\nencoded Cyrillic character text, specifically Russian. Translating this text to English revealed\na how-to guide on deploying the Caramel skimmer.\n\n_Figure 13: Screenshot of encoded Cyrillic character text._\n\nWe have included portions of this quickstart guide below along with English translations. For\nexample, when a customer attempts manual deployment of a skimming script using a\nMagento administrator panel, CaramelCorp includes a stern warning:\n\n\n-----\n\n```\n НИ В КОЕМ СЛУЧАЕ НЕ СТАВИТЬ СКРИПТ В ИСХОДНОМ ВИДЕ!\n\nМОЖЕТ ПРИВЕСТИ КМОМЕНТАЛЬНОМУ ДЕТЕКТУ.”\n\nTranslated:\n\n“DO NOT PUT THE SCRIPT IN THE SOURCE IN ANY CASE!\n\nMAY LEAD TO AN INSTANT DETECTION.”\n\n```\nOther noteworthy sections of the Caramel skimmer quickstart guide include:\n```\n“Функции mathCCи mathва ответственны за создания нужного массива, который будет\nотправлен на сервер. Почти всегда в форме оплаты на Magento используются такие\nнаименования id как billing:firstname... Для биллинга и для оплаты\nauthorizenet_cC_number и тд. В ситуации когда полей не совпадают надо только поменять\nимя Внутри скобках.”\n\n\"The functions mathCC and mathBA are responsible for creating the required array that\nwill be sent to the server. Almost always in the Magento payment form, id names such\nas billing:firstname… are used. For billing and payment, authorizenet_cc_number, etc.\nIn a situation where fields do not match, you only need to change the name inside the\nbrackets.”\n\n```\nCaramelCorp elaborates on the role of the mathCC and mathBA functions:\n```\n“ункция ѕеnd, вызывает mathCC и mathва для сохранения данных в 2 переменных и\nкодируется в base64 для отправки на сервер. Сервер декодирует этот токен в нужный\nформат для сохранения в базе данных.”\n\n\"The send function calls mathCC and mathBA to store the data in 2 variables and\nBase64 encode it to send it to the server. The server decodes this token into the\nproper format to store it in the database.\"\n\n```\nTo properly deploy, CaramelCorp reminds customers to change the skimmer gateway to one\nthe customer controls:\n```\n\"Для успешной отправки надо поменять только ссылку в переменной gateway.\"\n\n\"To successfully send, you only need to change the link in the gateway variable.\"\n\n\n```\nOn purchasing domains and hostings, CaramelCorp has the following recommendations:\n\n\n-----\n\n```\n Рекомендуется брать домен с www.epik.Com Выбор имени домена важен для привязки его к\nскрипту, где будут отсылаться запросы…\n\nПри покупке домена не забываем купить и SSL сертификат, его можно купить по\nадекватным деньгам на namecheap.com\n\nТакже для ПОДНЯТИЯ Гейта нам нужен и VPS. Ha bitlaunch.io конфигуратор Позволяет\nарендовать по хорошей цене приватный сервер со всеми нужными настройки.”\n\n\"It is recommended to acquire a domain from www.epik[.]com. The choice of a domain\nname is important for linking it to the script where requests will be sent…\n\nWhen buying a domain, do not forget to buy an SSL certificate. You can buy it for an\nacceptable price on namecheap[.]com.\n\nWe also need a VPS to RAISE the gate. [Bitlaunch] lets you rent a private server with\nall the necessary settings at a good price.”\n\n```\nWe assess that CaramelCorp and similar services will continue to grow their customer\nbases, selling tools and capabilities that lower the barriers to entry for a highly effective type\nof cybercrime, despite their marketing claims suggesting otherwise.\n\n## Appendix\n\nExample form fields targeted by the Caramel skimmer, spanning multiple CMS platforms\nfound in Caramel JS files:\n\n\n-----\n\n```\n billing:city\n\n\"billing:country_id”\n\n\"billing:firstname\"\n\n\"billing:lastname\"\n\n\"billing:postcode\"\n\n\"billing:region_id”\n\n\"billing:street1\"\n\n\"billing:telephone“\n\n\"cc_owner”\n\n\"input-payment-address-1”\n\n\"input-payment-city”\n\n\"input-payment-country”\n\n\"input-payment-telephone”\n\n\"input-payment-zone”\n\n\"traycheckoutapi_cc_owner”\n\n“authorizenet_cc_cid”\n\n“authorizenet_cc_number”\n\n“authorizenet_expiration_yr”\n\n“authorizenet_expiration”\n\n“billing:country_id\"\n\n“cc_cvv2”\n\n“cc_number”\n\n“checkout-step-review”\n\n“expiry”\n\n“input-payment-postcode”\n\n“journal-checkout-confirm-button”\n\n“traycheckoutapi_cc_cid”\n\n“traycheckoutapi_cc_number”\n\n“traycheckoutapi_expiration_yr”\n\n“traycheckoutapi_expiration”\n\n```\n© 2022 DomainTools\n\nDomainTools® and DomainTools™ are owned by DomainTools, all rights reserved.\n\nWe use cookies on our website to give you the most relevant experience by remembering\nyour preferences and repeat visits. By clicking “Accept All”, you consent to the use of ALL\nthe cookies. However, you may visit \"Cookie Settings\" to provide a controlled consent.\n\nCookie SettingsAccept All\n\n**Privacy Overview**\n\nThis website uses cookies to improve your experience while you navigate through the\nwebsite. Out of these, the cookies that are categorized as necessary are stored on your\nbrowser as they are essential for the working of basic functionalities of the website. We also\nuse third-party cookies that help us analyze and understand how you use this website.\nThese cookies will be stored in your browser only with your consent. You also have the\noption to opt-out of these cookies. But opting out of some of these cookies may affect your\nbrowsing experience\n\n\n-----\n\nNecessary cookies are absolutely essential for the website to function properly. These\ncookies ensure basic functionalities and security features of the website, anonymously.\n\n**Cookie** **Duration** **Description**\n\n\ncookielawinfocheckbox-analytics\n\ncookielawinfocheckbox-functional\n\ncookielawinfocheckbox-necessary\n\ncookielawinfocheckbox-others\n\ncookielawinfocheckboxperformance\n\n\n11\nmonths\n\n11\nmonths\n\n11\nmonths\n\n11\nmonths\n\n11\nmonths\n\n\nThis cookie is set by GDPR Cookie Consent plugin.\nThe cookie is used to store the user consent for the\ncookies in the category \"Analytics\".\n\nThe cookie is set by GDPR cookie consent to record\nthe user consent for the cookies in the category\n\"Functional\".\n\nThis cookie is set by GDPR Cookie Consent plugin.\nThe cookies is used to store the user consent for the\ncookies in the category \"Necessary\".\n\nThis cookie is set by GDPR Cookie Consent plugin.\nThe cookie is used to store the user consent for the\ncookies in the category \"Other.\n\nThis cookie is set by GDPR Cookie Consent plugin.\nThe cookie is used to store the user consent for the\ncookies in the category \"Performance\".\n\nThe cookie is set by the GDPR Cookie Consent plugin\nand is used to store whether or not user has\nconsented to the use of cookies. It does not store any\npersonal data.\n\n\nviewed_cookie_policy 11\nmonths\n\n\nFunctional cookies help to perform certain functionalities like sharing the content of the\nwebsite on social media platforms, collect feedbacks, and other third-party features.\n\nPerformance cookies are used to understand and analyze the key performance indexes of\nthe website which helps in delivering a better user experience for the visitors.\n\nAnalytical cookies are used to understand how visitors interact with the website. These\ncookies help provide information on metrics the number of visitors, bounce rate, traffic\nsource, etc.\n\nAdvertisement cookies are used to provide visitors with relevant ads and marketing\ncampaigns. These cookies track visitors across websites and collect information to provide\ncustomized ads.\n\nOther uncategorized cookies are those that are being analyzed and have not been classified\ninto a category as yet.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-05-05 - A Sticky Situation Part 1- The Pervasive Nature of Credit Card Skimmers.pdf"
    ],
    "report_names": [
        "2022-05-05 - A Sticky Situation Part 1- The Pervasive Nature of Credit Card Skimmers.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673535867,
    "ts_updated_at": 1743041156,
    "ts_creation_date": 1662027592,
    "ts_modification_date": 1662027592,
    "files": {
        "pdf": "https://archive.orkl.eu/a39b56cc10360f23b3e03e13a9c53f75b8bead25.pdf",
        "text": "https://archive.orkl.eu/a39b56cc10360f23b3e03e13a9c53f75b8bead25.txt",
        "img": "https://archive.orkl.eu/a39b56cc10360f23b3e03e13a9c53f75b8bead25.jpg"
    }
}