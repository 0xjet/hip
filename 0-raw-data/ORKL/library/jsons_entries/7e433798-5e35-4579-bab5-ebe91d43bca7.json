{
    "id": "7e433798-5e35-4579-bab5-ebe91d43bca7",
    "created_at": "2023-01-12T15:08:01.155654Z",
    "updated_at": "2025-03-27T02:06:03.361249Z",
    "deleted_at": null,
    "sha1_hash": "2115a7cff39bdf4a5449ceed47651489e327686a",
    "title": "2015-11-04 - “Offline” Ransomware Encrypts Your Data without C&C Communication",
    "authors": "",
    "file_creation_date": "2022-05-28T17:40:43Z",
    "file_modification_date": "2022-05-28T17:40:43Z",
    "file_size": 491551,
    "plain_text": "# “Offline” Ransomware Encrypts Your Data without C&C Communication\n\n**[blog.checkpoint.com/2015/11/04/offline-ransomware-encrypts-your-data-without-cc-communication/](https://blog.checkpoint.com/2015/11/04/offline-ransomware-encrypts-your-data-without-cc-communication/)**\n\nNovember 4, 2015\n\nEarly in September, Check Point obtained a sample of a ransomware. When the sample\nwas run, the following message, written in Russian, appeared:\n\n**Translation:**\n\n_“Your files are encrypted, if you wish to retrieve them, send 1 encrypted file to the following_\n_mail address:_\n\n_[[email protected]](https://blog.checkpoint.com/cdn-cgi/l/email-protection#6d3e081b08033221080a0402035f2d0c0201430e0200)_\n\n_ATTENTION!!! You have 1 week to mail me,_\n\n_after which the decryption will become impossible!!!!”_\n\n\n-----\n\nAll personal files were indeed encrypted, with each file renamed to the following format:\n\n**_email-[address to contact].ver-[Ransomware internal version].id-[Machine identifier]-_**\n\n**_[Date & Time][Random digits].randomname-[Random name given to the encrypted_**\n**_file].cbf_**\n\n_Example:_\n\n[[email protected]](https://blog.checkpoint.com/cdn-cgi/l/email-protection) [[email protected]@2015 [email protected]@19 AM5109895.randomname-](https://blog.checkpoint.com/cdn-cgi/l/email-protection)\nEFWMERGVKYNBPETHVKZNBQETHWKZNB.RGV.cbf\n\nWhen running, the ransomware does not interact with the user, other than changing the\nwallpaper. Furthermore, while most known ransomware requires Internet connection and\nsuccessful communication to their C&C servers before initiating the encryption, this sample\ndoes not need Internet connection to encrypt files and display the ransom message. This\nmeans that there is no key exchange between the infected machine and the attacker, which\neliminates one option of stopping the attack.\n\nCheck Point reached out anonymously to the attacker’s email, and received a reply\nrequesting a payment of 20,000 Russian Ruble (approx. $300) on the same day or 25,000\n(approx. $380) on the following day, to receive a decryption program and key.\n\nAs the behavior is quite different from most known samples, we decided to explore the\nransomware in greater depth, in both the intelligence and technical aspects.\n\nIntelligence Analysis\n\nDuring our research, we found many online references to this ransomware, especially in\nRussian language forums. This ransomware family appears to have been around for over a\nyear, with the first reference in June 2014 to the original version (no associated version\nnumber). Since then, 11 new versions have been reported. The chart below shows the\nversion history (dates according to first appearance in forums or reports online):\n\n\n-----\n\nNote: Between March and April 2015, the file version schema changed. A “CL” prefix was\nadded and the version numbers were restarted. A parallel change was also made to the\nformat of the encrypted file name. The older format (pre-April 2015) is as follows:\n\n**_[original file name].id-{[Machine identifier]-[Date]-[Time][Random digits]}-email-_**\n\n**_[address to contact]-ver-[ Ransomware internal version].cbf_**\n\n_Example:_\n\n[excel4.xls.id-{[email protected]@2014 [email protected]@473042530}[email protected]](https://blog.checkpoint.com/cdn-cgi/l/email-protection)\n\n*For the original version, which did not have a specific version number, the format was\nidentical to the older format, except for the lack of the version section at the end of the file\nname. For example:\n\n001.jpg.id-{NKYVGVEZRTCYMVENMHRALUDMXGPKJSBXWFAJ-03.09.2014\n\n[[email protected]@403928355}[email protected]](https://blog.checkpoint.com/cdn-cgi/l/email-protection)\n\nDifferences between the two formats:\n\nThe older encrypted file name includes the name of the original file. In the current\nformat, the file is given a random name.\nThe older format has the email address and the version at the end. The current format\nhas them at the beginning.\n\n\n-----\n\nMany email addresses, mainly AOL and Gmail accounts (but also others) have been\nassociated with this ransomware:\n\n[Note the email address [email protected], which is the only one found to be associated with](https://blog.checkpoint.com/cdn-cgi/l/email-protection)\na Russian email provider, and was also one of the email addresses associated with the\noriginal version of this ransomware. It has not appeared after version 4.0.0.0.\n\nThis ransomware (at least specific versions of it) has been given unique names by different\nvendors:\n\n**Ransomcrypt.U (Symantec) – See**\nhttps://www.symantec.com/security_response/writeup.jsp?docid=2015-092211-092799&tabid=2\n\nThis includes a comprehensive analysis of the ransomware behavior on the machine (not\nincluding the encryption mechanism).\n\n**Win32.VBKryjetor.wfa (Kaspersky) – Refers to version CL 1.0.0.0 (for the specific**\nsample we analyzed)\n**[Ninja Ransomware (Enigma Software) – Refers to the email [email protected],](https://blog.checkpoint.com/cdn-cgi/l/email-protection)**\nalthough there is no apparent difference from other emails.\n**Troj/Agent-AOTR (Sophos) – Refers to version CL 1.0.0.0**\n\n\n-----\n\n**Troj/Drop-HQ (Sophos) – Refers to version CL 1.0.0.0**\n**Troj/Ransom-AZT (Sophos) – Refers to version CL 1.0.0.0**\n**Troj/Ransom-BGX (Sophos) – Refers to version CL 1.0.0.0**\n**Troj/Ransom-BJQ (Sophos) – Refers to version CL 1.0.0.0**\n**Troj/Ransom-BJV (Sophos) – Refers to version CL 1.0.0.0**\n**Troj/Agent-ANBL (Sophos) – Refers to version CL 0.0.1.0**\n**Troj/Ruftar-H (Sophos) – Refers to version CL 1.0.0.0**\n**Troj/VB-IHK (Sophos) – Refers to version 6.1.0.0.b**\n**Mal/Delp-AI (Sophos) – Refers to version 4.0.0.0**\n\nTechnical Analysis (Encryption)\n\nRansomware Details\n\nThe ransomware sample investigated by Check Point was from version CL 1.0.0.0 (as can\nbe seen in the encrypted file name). It uses a protector that was written in Visual Basic\ncompiled language. To unpack the payload, the ransomware restarts its own process using\nsection mapping and overwrites four times. The payload that is responsible for file\nencryption is most likely written in Delphi language using some additional Pascal modules\n(for example, FGInt that is used to represent large numbers). We mention this fact as it is\nnot usual for ransomware to utilize Pascal-based languages. The ransomware does not\ncontain much functionality except for the file encryption capability.\n\nEncryption Functionality\n\nThe encryption functionality is built with several layers of encoding and encryption, including\ntwo separate levels of RSA:\n\n1. The beginning (first 30000 bytes) of each file is encrypted using two buffers of digits\n\nand letters that are randomly generated on the infected machine. The encryption\nprocess includes taking each original byte along with one byte from each of the\nrandomly generated buffers and performing mathematical operations on them.\n2. The remainder of each file (if it exists) is encrypted using an RSA public key (“local”)\n\nthat is randomly generated on the infected machine, along with the matching local\nRSA private key required for decryption of the data.\n3. The randomly generated buffers and the local RSA private key that are required for\n\ndecryption are added as metadata to each encrypted file, and are then encrypted\nusing three hardcoded RSA 768 public keys that the offender created in advance\n(“remote”). The matching remote RSA private keys required to unlock the metadata\nare located on the attacker’s side.\n\nDue to this functionality, the ransomware is able to encrypt all files locally without\nconnecting to a C&C server. Once the attacker receives a file from the infected machine, he\ncan easily decrypt the metadata using his remote RSA private keys, and find the buffers\n\n\n-----\n\nand local RSA private key that were randomly generated on the infected machine which can\nbe used to decrypt the file.\n\nIt is not feasible to try to decrypt the remote RSA encryption without the remote private key.\nThe necessary time frame would be approximately 2 years and would involve using many\ncomputers. Therefore, paying the ransom to get the decryption application and the\ndecryption keys from the attacker seems to be the only way to recover the encrypted files.\n\n**For More Details Read:** **[Check Point Technical Report](http://blog.checkpoint.com/wp-content/uploads/2015/11/Check-Point-Technical-Report-.pdf)**\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2015/2015-11-04 - “Offline” Ransomware Encrypts Your Data without C&C Communication.pdf"
    ],
    "report_names": [
        "2015-11-04 - “Offline” Ransomware Encrypts Your Data without C&C Communication.pdf"
    ],
    "threat_actors": [
        {
            "id": "ce10c1bd-4467-45f9-af83-28fc88e35ca4",
            "created_at": "2022-10-25T15:50:23.458833Z",
            "updated_at": "2025-03-27T02:00:55.475188Z",
            "deleted_at": null,
            "main_name": "APT34",
            "aliases": null,
            "source_name": "MITRE:APT34",
            "tools": [
                "netstat",
                "Systeminfo",
                "PsExec",
                "SEASHARPEE",
                "Tasklist",
                "Mimikatz",
                "POWRUNER",
                "certutil"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "cffb3c01-038f-4527-9cfd-57ad5a035c22",
            "created_at": "2022-10-25T15:50:23.38055Z",
            "updated_at": "2025-03-27T02:00:55.459558Z",
            "deleted_at": null,
            "main_name": "OilRig",
            "aliases": [
                "COBALT GYPSY",
                "IRN2",
                "APT34",
                "Helix Kitten",
                "Evasive Serpens",
                "Hazel Sandstorm",
                "EUROPIUM",
                "ITG13"
            ],
            "source_name": "MITRE:OilRig",
            "tools": [
                "ISMInjector",
                "RDAT",
                "Systeminfo",
                "QUADAGENT",
                "OopsIE",
                "Tasklist",
                "certutil",
                "ZeroCleare",
                "POWRUNER",
                "netstat",
                "ipconfig",
                "LaZagne",
                "BONDUPDATER",
                "SideTwist",
                "PsExec",
                "SEASHARPEE",
                "Mimikatz",
                "RGDoor",
                "ftp"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "67709937-2186-4a32-b64c-a5693d40ac77",
            "created_at": "2023-01-06T13:46:38.495593Z",
            "updated_at": "2025-03-27T02:00:02.848206Z",
            "deleted_at": null,
            "main_name": "OilRig",
            "aliases": [
                "IRN2",
                "Hazel Sandstorm",
                "EUROPIUM",
                "TA452",
                "Earth Simnavaz",
                "Cobalt Gypsy",
                "Crambus",
                "Helix Kitten",
                "APT 34",
                "APT34",
                "ATK40",
                "G0049",
                "Evasive Serpens",
                "Twisted Kitten"
            ],
            "source_name": "MISPGALAXY:OilRig",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673536081,
    "ts_updated_at": 1743041163,
    "ts_creation_date": 1653759643,
    "ts_modification_date": 1653759643,
    "files": {
        "pdf": "https://archive.orkl.eu/2115a7cff39bdf4a5449ceed47651489e327686a.pdf",
        "text": "https://archive.orkl.eu/2115a7cff39bdf4a5449ceed47651489e327686a.txt",
        "img": "https://archive.orkl.eu/2115a7cff39bdf4a5449ceed47651489e327686a.jpg"
    }
}