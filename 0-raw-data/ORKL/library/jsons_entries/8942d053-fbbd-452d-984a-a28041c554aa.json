{
    "id": "8942d053-fbbd-452d-984a-a28041c554aa",
    "created_at": "2023-01-12T15:06:08.152321Z",
    "updated_at": "2025-03-27T02:06:02.24751Z",
    "deleted_at": null,
    "sha1_hash": "266d53cd13007af75a2d9e904f0b22e7aabdf0d0",
    "title": "2022-02-08 - HawkEye Analysis",
    "authors": "",
    "file_creation_date": "2022-05-28T16:04:32Z",
    "file_modification_date": "2022-05-28T16:04:32Z",
    "file_size": 2610878,
    "plain_text": "# HawkEye\n\n**[github.com/itaymigdal/malware-analysis-writeups/blob/main/HawkEye/HawkEye.md](https://github.com/itaymigdal/malware-analysis-writeups/blob/main/HawkEye/HawkEye.md)**\n\nitaymigdal\n\n\n**Malware**\n**Name**\n\n\n**File**\n**Type** **SHA256**\n\n\nHawkEye x32\nexe\n(.NET)\n\n\nb9561f35b2fa188ed20de24bb67956e15858aeb67441fb31cbcfe84e1d4edc9a\n\n\n## Analysis process\n\nThe file is a Dotnet PE:\n\n\n-----\n\nOn execution the file spawns a child process of the legitimate Dotnet AppLaunch.exe:\n\nThere is only one reason to do that - Process Hollowing (A.K.A RunPE). As i learned from\nthe great [OALabs channel, whenever you want to break with a dubugger on an injection to](https://www.youtube.com/c/OALabs)\na remote process, `CreateProcessInternalW and` `WriteProcessMemory are the first`\ncalls that you want to put a break on. doing as i learned gave me a quick treat:\n\n\n-----\n\nThe malware is calling to `CreateProcessInternalW, pass AppLaunch.exe as a`\nparameter, and \"4\" as seventh argument which will make the process in suspended mode\n(Process Hollowing creates a process in suspended mode so it can hollows out the\nprocess, inject, and then execute).\n\nWe could manually find the unpacked PE in memory and dump it, and we also can be lazy\nand let great Hollows_Hunter.exe do it for us:\n\nðŸ˜Š\n\nDropping the unpacked (Dotnet as well) to Dnspy hollows out our eyes ðŸ˜¨:\n\nNot sure if the file dumped successfully or this one is perfectly obfuscated. Trying to\ndeobfuscate with De4dot:\n\n\n-----\n\nis throwing an error.. a closer look at the file in Dnspy reveals the obfuscator which\napparently is not supported / known by De4dot:\n\n[Some googling on deobfuscating ConfuserEx gives us this project which adds to De4dot](https://github.com/ViRb3/de4dot-cex)\nexactly this capability:\n\nNow the file is dumped and cleand (pretty much) ðŸ˜Ž.\n\nAnalyzing the code (which is still a bit obfuscated) reveals that this is a kelogger / stealer\n(with some RAT capabilities) named HawkEye Reborn version 8:\n\n[Description from Malpedia:](https://malpedia.caad.fkie.fraunhofer.de/details/win.hawkeye_keylogger)\n\n\n-----\n\nHawKeye is a keylogger that is distributed since 2013. Discovered by IBM X-Force, it\nis currently spread over phishing campaigns targeting businesses on a worldwide\nscale. It is designed to steal credentials from numerous applications but, in the last\nobserved versions, new \"loader capabilities\" have been spotted. It is sold by its\ndevelopment team on dark web markets and hacking forums.\n\nFrom here on i used only static analysis on the unpacked sample\n\n### Anti-Analysis capabilities\n\nChecks if it runs under process monitor software:\n\nChecks if it runs under Sandboxie (SbieDll.dll) or Wireshark:\n\nDisables Task Manager, Cmd, and Regedit:\n\n\n-----\n\nSets hidden + system attributes for itself:\n\nThe malware has the functionality to block websites by overriding the Hosts file and\nredirect them to the localhost address:\n\n### Stealing capabilities\n\nThe malware has Keylogging capabilities (Also called HawkEye Keylogger):\n\n\n-----\n\nTakes screenshots of the infected computer:\n\nSteals Chrome browser data:\n\n\n-----\n\nSteals Firefox browser data:\n\nSteals CoreFTP software data:\n\nSteals Minecraft data:\n\n\n-----\n\nCollects a plenty of more information: internal & external address, geolocation, installed\nsoftware, clipboard content, screenshots, passwords and more:\n\n\n-----\n\nAnd post all the data to the C2:\n\nC2: pomf.cat\n\n### Persistence:\n\nThe malware persist itself via a run key:\n\n### More capabilities:\n\nThe malware uses P/Invoke calls to native libraries to extend the capabilities and harden\nthe analysis:\n\n\n-----\n\nSeems like the next commands are used to be written into a .bat file that responsible for\nthe persistence via the run key, it's executes the malware, and then possibly deletes itself\n(and written back next execution, depending if is written to \"run\" or \"runonce\"):\n\nAlso, the malware seems to inject itself into a remote process due to these API calls:\n\n**That's it for today, hope you enjoyed â˜º**\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-02-08 - HawkEye Analysis.pdf"
    ],
    "report_names": [
        "2022-02-08 - HawkEye Analysis.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673535968,
    "ts_updated_at": 1743041162,
    "ts_creation_date": 1653753872,
    "ts_modification_date": 1653753872,
    "files": {
        "pdf": "https://archive.orkl.eu/266d53cd13007af75a2d9e904f0b22e7aabdf0d0.pdf",
        "text": "https://archive.orkl.eu/266d53cd13007af75a2d9e904f0b22e7aabdf0d0.txt",
        "img": "https://archive.orkl.eu/266d53cd13007af75a2d9e904f0b22e7aabdf0d0.jpg"
    }
}