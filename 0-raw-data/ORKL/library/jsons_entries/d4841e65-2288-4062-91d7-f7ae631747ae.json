{
    "id": "d4841e65-2288-4062-91d7-f7ae631747ae",
    "created_at": "2023-01-12T15:04:42.285785Z",
    "updated_at": "2025-03-27T02:16:59.198243Z",
    "deleted_at": null,
    "sha1_hash": "975ca9809bf1c0f076e0c3df085dfe6926eb4e61",
    "title": "2017-12-07 - A Peculiar Case of Orcus RAT Targeting Bitcoin Investors",
    "authors": "",
    "file_creation_date": "2022-05-27T21:07:57Z",
    "file_modification_date": "2022-05-27T21:07:57Z",
    "file_size": 2507664,
    "plain_text": "# A Peculiar Case of Orcus RAT Targeting Bitcoin Investors\n\n**[blog.fortinet.com/2017/12/07/a-peculiar-case-of-orcus-rat-targeting-bitcoin-investors](https://blog.fortinet.com/2017/12/07/a-peculiar-case-of-orcus-rat-targeting-bitcoin-investors)**\n\nDecember 7, 2017\n\nThreat Research\n\nBy [Floser Bacurio and](https://blog.fortinet.com/blog/search?author=Floser+Bacurio) [Joie Salvio | December 07, 2017](https://blog.fortinet.com/blog/search?author=Joie+Salvio)\n\nBitcoin has been the talk of the past few years, at least as far as crypto-currency is\nconcerned, primarily due to its growing acceptance and steady rise in value ($17,740 USD\nas of writing.) Inevitably, financial market traders and investors have found this to represent a\ngood opportunity for profits.\n\n\n-----\n\nHowever, active trading in bitcoin, as in any currency in the financial market, generally\nrequires a great deal of attention in order to maximize profitability. Throw the emotions\ninvolved with every trading decision into the mix and it can become a stressful ordeal.\nHence, the advent of automatic trading applications, popularly known as trading bots.\n\nIn simple terms, these bots monitor bitcoin price differences between different trading\nplatforms. If an opportunity for profit appears, they automatically buy or sell bitcoin between\nthe platforms, effectively arbitraging between the two. The criteria for an opportunity are still\nbased on parameters set by the user though. So obviously, they are not fully autonomous.\n\nBitcoin trading bots, or trading bots in general, however, are not at all new. But with bitcoin’s\nincreasing value and popularity, the market for them is.\n\nAnd as expected, as this parade of bandwagons grows larger, malware threat actors are\n[ready to jump on to get a piece of the profit. As evidence of this, FortiGuards Labs’ Kadena](https://fortiguard.com/)\nThreat Intelligence System (KTIS) has spotted a new phishing campaign that targets bitcoin\ninvestors by offering Gunbot, a relatively new bitcoin trading bot application. However,\ninstead of being a tool designed to ensure more profit, it serves an Orcus RAT malware that\nresults in the loss of investments and more.\n\n## Spam\n\n[The email spam arrives as an announcement of a new bitcoin trading bot called Gunbot,](https://gunthy.org/)\nwhich is a product developed by GuntherLab or Gunthy.\n\n\n-----\n\n_Fig1. Spam email disguised as a GunBot promotion_\n\nAn attachment with the filename sourcode.vbs.zip is actually an archive that contains a\nsimple VB Script with the same filename, which when executed downloads a file from\n_https[:]//bltcointalk.com/flashplayer27pp_ka_install.jpeg. Although the extension suggests it_\nis a JPEG image file, it is actually a PE binary file.\n\n\n-----\n\nThe comments on the script imply that the threat actors behind this campaign have no\nintention of hiding its behavior. It’s possible that they lack the technical knowledge and simply\nbought the components used in this campaign elsewhere. It can also be that they just simply\ndon’t care as long as there’s someone out there that double-clicks the file without any\ninspection, which may well be the case.\n\n_Fig2. Commented VBScript downloader_\n\n## Trojanized Inventory System\n\nAt first glance, the downloaded executable appears to be a benign inventory system tool with\na lot of references to SQL commands for inventory procedures. After further analysis,\nhowever, we found that it is a trojanized version of an open source inventory system tool\nnamed [TTJ-Inventory System.](https://www.sourcecodester.com/visual-basic-net/5861/ttj-inventory-system.html)\n\n\n-----\n\n_Fig3. Comparison between the downloaded executable and the TTJ-Inventory System_\n_source code_\n\nAs we dug deeper in the decompiled code, we found an access reference to a big chunk of\ndata named “Mastering” from a resource named “DVDImageBurn”. It contains encrypted\nbinary data from a resource name “Mastering” that will be decrypted using a hardcoded key.\nAs it turns out, this data is another .NET PE executable that is loaded and executed directly\nto memory.\n\n_Fig4. Decrypt Resource Data_\n\n\n-----\n\n_Fig5. Loading the decrypted MZ application_\n\nTo make sure that only one instance of the malware is running, the system checks for the\nexistence of a mutex named “dgonfUsV”.\n\nBefore the malware proceeds to its main payload, it first checks to see if it’s running from the\npath %APPDATA%\\Roaming\\Microsoft\\Windows\\DwiDesk\\nethost.exe. If not, it creates a\ncopy of itself in the said directory and executes from there instead.\n\nWe now turn our analysis to the previously mentioned embedded executable. Once it is\nloaded and executed in memory, it ensures that the malware is executed upon reboot. A\nshortcut file is created in the same directory which points to the newly created path. The path\nof the shortcut file is added as new entry\n_HKEY_CURRENT_USER\\\\Software\\Microsoft\\Windows|CurrentVersion\\RunOnce with the_\nvalue name “Load”.\n\n\n-----\n\n_Fig6. Creating Auto Start Registry_\n\nThis executable further contains three embedded PE executables in its resource where the\nactual Orcus RAT server can be found.\n\n_Fig7. Payload Resource File_\n\n_M – Orcus RAT server_\n_PkawjfiajsVIOefjsakoekAOEFKasoefjsa – persistence watchdog_\n_R – RunPE module_\n\nThe RunPE module is not only able to execute other modules without writing their physical\nfiles in the system, but also to execute them under legitimate executables. This is usually\ndone by executing an application in suspended mode, and then replacing the new process’\nmemory with the malicious code before resuming. It’s a common stealth technique. In this\ncase, it uses components of the Microsoft .NET framework, MSBuild.exe and RegAsm.exe,\nas shells to hide their malicious processes. However, as shown in the next figure, the path to\nthe mentioned executables are hardcoded, which means that if the system has a different\nversion of .NET framework (different path) the malware will not be able to proceed.\n\n\n-----\n\n_Fig8. Loading Orcus RAT by Process Hollowing_\n\nThe module from the PkawjfiajsVIOefjsakoekAOEFKasoefjsa resource acts as a watchdog to\nkeep the malware running by repeatedly executing it unless the client decides to stop it by\ndropping ”stop.txt” in its directory.\n\n\n-----\n\n_Fig9. Process Persistence_\n\n## Putting The ‘T’ in RAT\n\n\n-----\n\n_Fig10. Decompiled Orcus binary showing command modules_\n\nOrcus has been advertised as a Remote Administration Tool (RAT) since early 2016. It has\n[all the features that would be expected from a RAT and probably more. The long list of the](https://orcustechnologies.com/features.html)\ncommands is documented on their website. But what separates Orcus from the others is its\n[capability to load custom plugins developed by users, as well as plugins that are readily](https://orcustechnologies.com/developer.html)\navailable from the Orcus repository. In addition to that, users can also execute C# and\nVB.net code on the remote machine in real-time.\n\n\n-----\n\nBasically, if a server component gets installed to your system, the person on the other side\nis practically in front of your machine while seeing and hearing you at the same time – yes, it\ncan activate your microphone and webcam even without you knowing.\n\nOrcus, although advertised as a Remote Administration Tool, offers features that are beyond\nthat scope.For instance, the user has the ability to disable the light indicator on webcams so\nas to not alert the target that it’s active. It can also implement a watchdog that restarts the\nserver component or even trigger a Blue Screen of Death (BSOD) if the someone tries to kill\nits process. This makes it harder for targets to remove it from their systems. A plugin that can\nbe used to perform Distributed Denial of Service (DDOS) is also available directly from their\n[repository. These are, of course, on top of the obviously ominous features such as password](https://github.com/OrcusTechnologies)\nretrieval and key logging that are normally seen in Remote Access Trojans.\n\nInterestingly, this is not the first time that Orcus’ self-claimed status of being a benign tool\n[has been questioned. In July of 2016, KrebsonSecurity published an article tackling this](https://krebsonsecurity.com/2016/07/canadian-man-is-author-of-popular-orcus-rat/)\nsame issue.\n\n## The One-letter Modus\n\nIt is obvious that the malware download site https://bltcointalk.com is trying to imitate the\nbitcoin forum bitcointalk.org. When accessed, the website is just an open directory containing\nthe previously mentioned as well as an archive with the filename . Unfortunately, in the\nmiddle of writing this article, the contents of the website changed before we could download\nan updated copy.\n\n_Fig11. blcointalk.com contents listed on Dec. 1_\n\nDuring our access on Dec. 4, flashplayer27pp_ka_install.jpeg was no longer hosted.\nHowever, a new file with the filename Gunbot.XT.Edition.-.Windows.package.zip had been\nuploaded to the server and this time we were able to take a deeper look.\n\n\n-----\n\n_Fig12. bltcointalk.com contents listed on Dec. 4_\n\nAs it turns out, the contents of the package, which is disguised as the GunBot tool, contains\na similar trojanized “Inventory System” as well as the VB Script downloader. We speculate\nthis small change in the setup is being (will be) used in another campaign.\n\n_Fig13. Fake GunBot package contains similar malicious files_\n\nChecking the Whois information of the domain, we found its registrant to be “Cobainin\n_Enterprises” and other domains are laos registered under that entity._\n\n_Fig14. Whois information of bltcointalk.com_\n\nIt was no surprise, therefore, that we found other domains that use similar domain names\nwith replaced letters. When accessed, most of the sites display the “We’ll be back soon!”\nmessage, which is the same page that is displayed when “index.phptopic=3D1715214.0/” is\naccessed in “bltcointalk.com”.\n\n\n-----\n\n_Fig15. Domains registered under “Cobainin Enterprises”_\n\n_Fig16. Maintenance message from some of the “inactive” domains_\n\nIt’s possible that the threat actors cycle these sites between their malware campaigns. One\nof the websites on the list, “qunthy.org” leads to a fake website for Gunbot. On the legitimate\nGunbot website, interested clients are redirected to the developer’s Telegram profile, which is\ndone by clicking the “CONTACT” button. In the case of the fake website, that button is\nreplaced with a “GET IT” button that can be triggered just by hovering on it. This leads to a\nfile hosting website, “http[:]//desfichiers.com/?9onk0nboih”. However, as of this writing, the\nfile pointed to by the URL no longer exists, however it seems safe to assume that it’s\nnothing benign\n\n\n-----\n\n_Fig17. Official website of Gunbot_\n\n_Fig18. Fake website of Gunbot_\n\n\n-----\n\n_Fig19. Hosted file that no longer exists_\n\n## Conclusion\n\nThe rise of Bitcoin to the top of the burgeoning cryptocurrency market has paved the way to\nthe creation of bot trading applications such as Gunbot. Malicious counterfeit sites are\nsophisticated in terms of stealth and general infrastructure, and pose great risks to Bitcoin\ntraders who may be tricked by its schemes.\n\nIn our investigation of Orcus RAT, we have again proven again that its capabilities go beyond\nthe scope of a harmless administration tool. Regardless of the developer’s claim and\ndefense, the reality is that the application is being used in cybercrime campaigns.\n\n-= FortiGuard Lion Team =\n## Protection\n\n1. FortiSandbox rates all the samples with High Risk without additional reconfiguration.\n2. C&C’s and download sites are already blocked using Fortinet Web Filtering.\n\n## IOC\n\n5a87b68d38993a429fedf258198dce24ddffe4e9ba5e20b11bc78d7d045e85ca –\nMSIL/Orcus.KAD!tr\n\n457d8e6f3a4be23dd46c91bfc45c97c241bc741656d6192aca05dfeaecc17fa4 –\nMSIL/Orcus.KAD!tr\n\n\n-----\n\n5ef25d21925b2b116548fcc21fd3d8e47f2e540aaffae124da50787d124e62d5 –\nMSIL/Orcus.KAD!tr\n\n3941995e94d491968e95f19e6b0b0ded8b97084b219b722f6766a45e05f286db MSIL/Orcus.KAD!tr\n\na949b92d82e66816f791683aa40e4b20cf132ec190c2936463a15068c31d0588 –\nMSIL/Orcus.KAD!tr\n\n0a3280b85932d9aca690bb770a104c2d4123af37494a3af6ec469972f4907de6 –\nMSIL/Orcus.KAD!tr\n\n41104f7d0087ea6e2a973f91ab2f18fce3ba5d31d81ab18434e3fcd24d871fef –\nMSIL/Orcus.KAD!tr\n\nb98b1626071d7f6ef368813f4f5f6f77123c6243f6957be3aa3102aa012d5921 –\nMSIL/Orcus.KAD!tr\n\n9e50bdad057ce4e3e386a44e3ffbd644f59e03c252b244e783d03684bf91bd11 VBS/Agent.NYT!tr.dldr\n\n## C&C\n\n172.111.160.213\n\n_[Sign up for our weekly FortiGuard Labs intel briefs or to be a part of our](https://www.fortinet.com/fortiguard/threat-intelligence/threat-research.html)_ _[open beta of](https://www.fortinet.com/fortiguard/threat-intelligence/threat-research.html)_\n_Fortinet’s FortiGuard Threat Intelligence Service._\n\n## Related Posts\n\nCopyright © 2022 Fortinet, Inc. All Rights Reserved\n\n[Terms of ServicesPrivacy Policy](https://www.fortinet.com/corporate/about-us/legal.html)\n| Cookie Settings\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2017/2017-12-07 - A Peculiar Case of Orcus RAT Targeting Bitcoin Investors.pdf"
    ],
    "report_names": [
        "2017-12-07 - A Peculiar Case of Orcus RAT Targeting Bitcoin Investors.pdf"
    ],
    "threat_actors": [
        {
            "id": "aa73cd6a-868c-4ae4-a5b2-7cb2c5ad1e9d",
            "created_at": "2022-10-25T16:07:24.139848Z",
            "updated_at": "2025-03-27T02:02:10.120505Z",
            "deleted_at": null,
            "main_name": "Safe",
            "aliases": [],
            "source_name": "ETDA:Safe",
            "tools": [
                "DebugView",
                "LZ77",
                "OpenDoc",
                "SafeDisk",
                "TypeConfig",
                "UPXShell",
                "UsbDoc",
                "UsbExe"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "f9806b99-e392-46f1-9c13-885e376b239f",
            "created_at": "2023-01-06T13:46:39.431871Z",
            "updated_at": "2025-03-27T02:00:03.08926Z",
            "deleted_at": null,
            "main_name": "Watchdog",
            "aliases": [
                "Thief Libra"
            ],
            "source_name": "MISPGALAXY:Watchdog",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673535882,
    "ts_updated_at": 1743041819,
    "ts_creation_date": 1653685677,
    "ts_modification_date": 1653685677,
    "files": {
        "pdf": "https://archive.orkl.eu/975ca9809bf1c0f076e0c3df085dfe6926eb4e61.pdf",
        "text": "https://archive.orkl.eu/975ca9809bf1c0f076e0c3df085dfe6926eb4e61.txt",
        "img": "https://archive.orkl.eu/975ca9809bf1c0f076e0c3df085dfe6926eb4e61.jpg"
    }
}