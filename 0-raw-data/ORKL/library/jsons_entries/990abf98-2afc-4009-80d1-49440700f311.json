{
    "id": "990abf98-2afc-4009-80d1-49440700f311",
    "created_at": "2023-01-12T15:10:12.240598Z",
    "updated_at": "2025-03-27T02:16:20.705627Z",
    "deleted_at": null,
    "sha1_hash": "ae9440bab22e0b6a136fd9e00f78d711e78fbd71",
    "title": "2021-09-27 - Deobfuscating PowerShell Malware Droppers",
    "authors": "",
    "file_creation_date": "2022-05-27T22:58:45Z",
    "file_modification_date": "2022-05-27T22:58:45Z",
    "file_size": 3886766,
    "plain_text": "# Deobfuscating PowerShell Malware Droppers\n\n**[ryancor.medium.com/deobfuscating-powershell-malware-droppers-b6c34499e41d](https://ryancor.medium.com/deobfuscating-powershell-malware-droppers-b6c34499e41d)**\n\nRyan Cornateanu September 27, 2021\n\n[Ryan Cornateanu](https://ryancor.medium.com/?source=post_page-----b6c34499e41d--------------------------------)\n\nSep 26, 2021\n\n\n12 min read\n\nI recently saw a [video of](https://www.youtube.com/watch?v=K8n1xv1KxNI) [Ahmed S Kasmani dissecting a ComRAT PowerShell script to](https://www.youtube.com/channel/UC0vsNncAvJlPh2XGUi5s33Q)\nobtain the main malware that it drops onto the victim’s computer. If you haven’t seen the\nvideo yet, I highly encourage you to watch it. This paper is going to go into similar detail, as\nwell as my own approach to deobfuscating PowerShell scripts to get to the main payload. To\nfollow along, you can use this hash to download this script from VirusTotal:\n```\n134919151466c9292bdcb7c24c32c841a5183d880072b0ad5e8b3a3a830afef8\n\n```\nSo what is ‘ComRAT’ besides a city and municipality in Moldova and the capital of the\nautonomous region of Gagauzia? It was started by a Turla hacker group, one of Russia’s\nmost advanced state-sponsored hacking groups that began in 2007. Although the latest\nversion of ComRAT v4 was created in 2017, it is still being used a bit today.\n\nComRAT Timeline from ZDnet[.]com\n\n\n-----\n\nTurla hacking group s modus operandi was to target government and military facilities. Turla\nhas since been dubbed by other names such as Snake, Krypton, and Venomous Bear.\n\n## Attack Chain\n\nMechanism of Attack\nIn this paper, we will be going over how the dropper operates, and the logic on how the\nmalware gets to stage 2, which is the DLL payload. This cyber-kill chain graph will be a work\nin progress on my end as I did not fully reverse engineer much after the DLL was dropped.\nMaybe I will turn this into a series, where I go over every part of the chain, but for now let’s\nfocus on the first three components in the graphic above.\n\n## Diving into the PowerShell\n\nFor this lab exercise, we are going to use Visual Studio Code on a Windows VM since they\nhave a great linter for PowerShell scripts. Let’s open up the file, and dive in.\n\n\n-----\n\nOriginal PowerShell opened in VSC\nThree major things hit me at first… 1) this is a lot of base64, 2) the PowerShell is not\nformatted out correctly, and 3) the variable names are completely randomized. First let’s take\ncare of how many lines of code the base64 is taking up. We can easily fix this by going to\n```\nView->Toggle Word Wrap and uncheck it by simply clicking on it. Now, we want this to be\n\n```\nproperly formatted, this can be fixed by hitting `SHIFT+ALT+F .`\n\nPowerShell reformatted\nThis looks a lot cleaner! Time to break down the two functions inside this PowerShell and\nstart renaming function / variable names. Let’s start with the first one. It looks like some sort\nof string generator.\n\n\n-----\n\n## Obfuscation of Function & Variable Names\n```\nfunction TVM730egf([string[]]$GP50afa) {   $UC33gfa = ((1..(Get-Random -Min 2 -Max\n4) |     % { [Char](Get-Random -Min 0x41 -Max 0x5B) }) -join '');   $EQ33abh =\n((1..(Get-Random -Min 2 -Max 4) |     % { [Char](Get-Random -Min 0x30 -Max 0x3A)\n}) -join '');   $OFK689fa = ((1..(Get-Random -Min 2 -Max 4) |     % { [Char]\n(Get-Random -Min 0x61 -Max 0x6B) }) -join '');   $TTG32aa = $UC33gfa + $EQ33abh +\n$OFK689fa;   if ($GP50afa -contains $TTG32aa) {     $TTG32aa = Get-RandomVar\n$GP50afa;   }   $GP50afa += $TTG32aa;   return $TTG32aa, $GP50afa;}\n\n```\nThe first three lines look to be generating only capital letters ranging from 2 to 4 bytes. The\nsecond line does exactly the same thing as line 1 but only generates numbers. The third\ngenerator generates a 2 to 4 byte lowercase string. Let’s rename a few variables and see\nhow it looks.\n```\nfunction rand_string_generator([string[]]$param1_str) {   $rand_upper_str = ((1..\n(Get-Random -Min 2 -Max 4) ...   $rand_num_str = ((1..(Get-Random -Min 2 -Max 4)\n...   $rand_lower_str = ((1..(Get-Random -Min 2 -Max 4) ...   $rand_str_gen =\n$rand_upper_str           + $rand_num_str           +\n$rand_lower_str;   if ($param1_str -contains $rand_str_gen) {     \n$rand_str_gen = Get-RandomVar $param1_str;   }   $param1_str += $rand_str_gen; \nreturn $rand_str_gen, $param1_str;}\n\n```\nNow we can copy this function, and paste it into a PowerShell command line, and see what\nthe output will look like.\n```\nPS C:\\Users\\ryancor> rand_string_generator(\"test\")FN36ddtestFN36dd\n\n```\nEasy enough, this looks like it feeds in a string, and does a check to make sure the random\nstring it generates does not match the string parameter. If they are a match, it will get a\nrandom byte from the parameter string and add it to the random string. Looks like this\nfunction gets referenced about 10 times throughout the program.\n```\n$rand_string_array = @();[string]$PS061hh, [string[]]$rand_string_array =      \nrand_string_generator $rand_string_array;[string]$RPW45dij,\n[string[]]$rand_string_array =             rand_string_generator\n$rand_string_array;[string]$RIZ505ia, [string[]]$rand_string_array =         \nrand_string_generator $rand_string_array;...PS C:\\Users\\ryancor>\n$rand_string_arrayXLA320efeYUP59cgCB456fgbBW13chiNQG095ggNP120cehYG27gfOXN26bdVE440ihi\n\n```\nIf we look at the array and the single random strings returned, they never get referenced\nagain in the program. With that being said, if we pay attention to the how the function and\nvariable names are specifically labeled, we find a massive similarity to the output above. The\nstring generator takes in a string and concatenates an array of randomized bytes that start\nwith two to three uppercase letters, followed by two to three integers, then lastly, two to three\nlowercase letters. This entire script follows this `XXX000xxx naming convention. So it’s safe`\nto say this is how they obfuscated the entire dropper as I assume the author’s copy of this\nPowerShell script has debug symbols that helped the malware writers QA their work before\nshipping this out to their targets/victims.\n\n\n-----\n\n## Executing Embedded C# Code\n\nTime to move on over to `function PAZ488af which referenced the random string`\ngenerator, but we are going to start from the top as it has important information about what’s\ngoing to be dropped, while also renaming some variables to better understand what is\nhappening here. Starting with the first 10 lines, there is already so much going on:\n```\n$task_sched = New-Object ComObject('Schedule.Service');$task_sched.connect('localhost');$objFoldr =\n$task_sched.GetFolder($param2);$null_task = $task_sched.NewTask($null);\n[string]$filename = [System.IO.Path]::GetTempFileName();Remove-Item -Path $filename Force;[string]$ps1_name = [System.IO.Path]::GetFileName($filename);$ascii = NewObject System.Text.ASCIIEncoding;$base64_decoded_bytes =       \n[Convert]::FromBase64String(\"cHVibGljIHN0YXRpY....\");$ps_decoded_class =\n$ascii.GetString($base64_decoded_bytes, 0,                   \n$base64_decoded_bytes.Length);try {    Add-Type $ps_decoded_class -erroraction\n'silentlycontinue' } catch {   return; }\n\n```\nThe first four lines are dedicated to testing the presence of a folder, and scheduling a task at\n```\nMicrosoft\\Windows\\Customer Experience Improvement Program, we don’t know what\n\n```\nsignificance this has yet but maybe we will find out later. If you’re wondering how I found out\nwhat `$param2 was in` `$task_sched.GetFolder($param2); was, all I had to do was trace`\nout how this function was being called, and the second to last line of this PowerShell dropper\nshows the string arguments that were used.\n\nString Arguments Used\nThe next 3 lines will grab the PowerShell script name and remove the path from it until it is\njust a filename string. Now, the last few lines of the script above are decoding a large base64\nstring, so we can use [cyberchef to see this is.](https://gchq.github.io/CyberChef)\n\n\n-----\n\nLooks like some interesting embedded C#! So what I like to do since that classname will\nmost likely be referenced in our script, is copy and paste this into our dropper file. Yes, you\ncan execute C# functions from PowerShell, and that’s what the `try,except statement is`\nattempting to do. As shown in Microsoft’s documentation, the `Add-Type cmdlet lets you`\ndefine a Microsoft .NET Core class in your PowerShell session. You can then instantiate\nobjects, by using the `New-Object cmdlet, and use the objects just as you would use any`\n.NET Core object.\n\nSo let’s rename the classname `RZP645be to` `decryption_class, and the function within`\n```\nXD014ic to decrypt, since this looks to be a simple multi-key byte XOR decryption. You’ll\n\n```\nnotice as we are replacing this in the script, we can see it is being called a couple of times\nthroughout the PowerShell script.\n```\n$TEX262hh = 'H4sIAAAAAAAEAIy5xw7ETJIeeB9g3qEhCJAEzgy9KQ...'$HT29hh =\n[Convert]::FromBase64String($TEX262hh);$MO67cc =\n'H4sIAAAAAAAEAIy5xw7ETJIeeB9g3qEhCJAEzgy9KQ...'$PVU468aa =\n[Convert]::FromBase64String($MO67cc);$GS459ea = \"$((1..(Get-Random -Min 8 -Max 10) |\n%     {[Char](Get-Random -Min 0x3A -Max 0x5B)}) -join '')    $((1..(GetRandom -Min 5 -Max 8) | % {[Char](Get-Random     -Min 0x30 -Max 0x3A)}) -join '')\n$((1..(Get-Random -Min 8 -Max 10) | %{[Char](Get-Random     -Min 0x61 -Max\n0x7B)}) -join '')\";[byte[]]$JQ587aa = [decryption_class]::decrypt($HT29hh,      \n$ascii.GetBytes($GS459ea));[byte[]]$QIG418ba = [decryption_class]::decrypt($PVU468aa,\n$ascii.GetBytes($GS459ea));$AT85ced = [Convert]::ToBase64String($JQ587aa);$ARO88iab =\n[Convert]::ToBase64String($QIG418ba);\n\n```\n\n-----\n\nLet s break this down, we have two extremely large base64 strings, and so we will start with\nthose using cyberchef. Once you use the base64 decoder, you’ll notice both of these\nencoded strings have very similar headers, so it has to mean something:\n```\n...........¹Ç.ÄL..x.`Þ¡!...Î.½)\n\n```\nThe problem is, we have no idea what type of file format this is. So we can use cyberchef’s\n```\nDetect File Type plugin to help us identify.\n\n```\nDetecting file format of unknown bytes\n\n\n-----\n\nGunzip the bytes\nIt looks like we have more PowerShell code being decompressed. So we can start renaming\nvariables to make this script look cleaner.\n\nPowerShell Script Dropper Base64 Encoded Strings\nWe are not sure what it’s decrypting, given the fact that these are compressed bytes, and not\nencrypted bytes from what we were able to prove with cyberchef, but maybe it will become\nmore clear as we move along. At this point, I took the decompressed code, and moved it to a\nseparate file that I named `dropper_part_2.ps1, and reformatted it.`\n\n\n-----\n\nNew IOC dropper script\nLet’s go back to our main dropper script because we have to take a look at this function\n( [decryption_class]::decrypt ) a little closer. Once the script decrypts the decoded\nbytes, it assigns certain pointer values.\n```\n[byte[]]$decrypted_ps_bytes_1 =             \n[decryption_class]::decrypt($ps_decoded_1,                    \n$ascii.GetBytes($rand_key));[byte[]]$decrypted_ps_bytes_2 =             \n[decryption_class]::decrypt($ps_decoded_2,                    \n$ascii.GetBytes($rand_key));$base64_encoded_decrypted_bytes_1 =          \n[Convert]::ToBase64String($decrypted_ps_bytes_1);$base64_encoded_decrypted_bytes_2 = \n[Convert]::ToBase64String($decrypted_ps_bytes_2);...$sqmclient_reg_path =\n\"HKLM:\\SOFTWARE\\Microsoft\\SQMClient\\Windows\";if ([System.IntPtr]::Size -eq 4) {  \n$HQO388ea = $base64_encoded_decrypted_bytes_1;}else {  $HQO388ea =\n$base64_encoded_decrypted_bytes_2;}\n\n```\nWe have two ways of figuring out what is the purpose of the decryption, we can simply figure\nout what `[System.IntPtr]::Size does, or we can actually debug this. The lazy way is to`\nlook at the Microsoft docs. It states that the size of a pointer or handle in this process is\nmeasured in bytes. The value of this property is 4 in a 32-bit process, and 8 in a 64-bit\nprocess. You can define the process type by setting the `/platform switch when you`\ncompile your code with the C# and Visual Basic compilers. Now we know why there were\nbasically two identical PowerShell scripts being decoded, one will most likely drop a 64-bit\nDLL or EXE, and the other script will drop a 32-bit one.\n\n## Writing & Persistence Mechanisms\n\nAs you can see below, after renaming some variables, we can see the main purpose of the\nrest of the script is to create schedulers, triggers, and executions with the `wsqmcons binary,`\nwhich is a software component of Microsoft. Windows SQM consolidator is tasked with\n\n\n-----\n\ncollecting and sending usage data to Microsoft. `Wsqmcons is a file that runs the Windows`\nSQM consolidator, and is usually deemed as a safe file for your PC. In this case, it is used\nbeing used for malicious purposes. The modification of the scheduled task shown below\nindicates the primary purpose of this task modification is to decode and execute a\nPowerShell script contained within the registry key\n```\nHKLM:\\SOFTWARE\\Microsoft\\SQMClient\\Windows = WSqmCons and the script will inject\n\n```\nthe payload into the `WsqmCons registry key.`\n\nMalware disguising itself as a safe process\nKnowing this now, I feel comfortable to skip the rest of the main script we were looking at. So\nwe can focus our attention back to the script that we just decoded (the script that we dubbed\n```\ndropper_part_2.ps1 ).\n\n## PE Dropper\n\n```\nExecution of C# Script\nAnalyzing the first few lines, it looks fairly similar to what we saw before in the main script. I’ll\ntake this base64 string and decode it in cyberchef. Once you do this you’ll notice another\nblob of C# code.\n\n\n-----\n\nUnder the hood of the C# Script\nWhen we highlight some of the public classes and functions, we can see where they are\nbeing highlighted in the PowerShell script. `VO01bag, which has the functions` `XOP22aj &`\n```\nRJ85ige, looks like a simple gunzip compression and decompression, so we can rename\n\n```\nthose accordingly. The class `WQS70fb and function` `YQ498hff looks like it takes in an`\ninput of bytes and writes them out to a file. I’ve renamed them as well since we can see them\nbeing used throughout the file. Now if we go back to the decompression function from the\ndecoded C# with our renamed variables, it feels like we are getting closer to our PE file.\n```\npublic static byte[] decompress_array(byte[] arrayToDecompress){ using (MemoryStream\ninStream = newMemoryStream(arrayToDecompress)) using (GZipStream bigStream = new\nGZipStream(inStream,                        \nCompressionMode.Decompress)) using (MemoryStream bigStreamOut = new MemoryStream()) \n{   WriteClass.write_to_file(bigStream, bigStreamOut);   return\nbigStreamOut.ToArray(); }}\n\n```\nOur `WriteClass does not get called in the PowerShell script, but it does get called in C#`\ncode within the `DecompressionClass, which tells us that after certain bytes are`\ndecompressed, it gets written to a file because if we reference this `decompress_array`\nfunction, we can see it being used as such:\n```\n$FV18hi = [DecompressionClass]::decompress_array($TEM52cbe);....$PEBytes =\n[DecompressionClass]::decompress_array($PEbytes);\n\n```\nLooks like we found out where our PE bytes are being decompressed, written, and dropped.\n\n\n-----\n\nPE Dropper\nThe remainder of the script before the PE bytes get written to memory, is the use of a 3DES\ndecryption algorithm with an initialization vector of `FVADRCORAOSKBHPX to encrypt/decrypt`\nthe contents of another PowerShell script with a password and salt. It will then be stored in a\nWindows registry path as seen in the screenshot above. In turn, it will make analysis of the\nscript impossible without the correct password and salt combination. This command ( IEX )\non the last line will execute the dropped PE file onto the victim machine. You can find the\n[open-source PowerSploit script here.](https://github.com/PowerShellMafia/PowerSploit/blob/master/ScriptModification/Out-EncryptedScript.ps1)\n\nFor the moment we have all been waiting for, let’s take the base64 string I labeled as\n```\n$pe_encoded_bytes and throw it into cyber chef to decode and decompress.\n\n```\n\n-----\n\nDecoded & Decompressed PE\nIf we click the file save icon, we can download this binary. Now we can check the IOC on it,\nand see if anything pops up in VirusTotal.\n\n➜ file payload.binpayload.dll: PE32 executable (DLL) (GUI) Intel 80386, for MS\n```\nWindows➜ openssl sha1 payload.dllSHA1(payload.dll)=\nd117643019d665a29ce8a7b812268fb8d3e5aadb\n\n```\nLooks like we are dealing with a dynamic link library file, which we will not be able to reverse\nengineer for this paper (but we’ll still want to see this payload through eventually).\n\n\n-----\n\nVirusTotal Hit\n[Looks like we hit the jackpot, and I’m sure the DLL will show all the inner workings of how](https://www.virustotal.com/gui/file/b93484683014aca8e909c9b5648d8f0ac21a45d0c193f6ca40f0b01d2464c1c4/detection)\nComRAT works.\n\nDisassembly of DLL\nTaking a small peak under the hood of this DLL, we can see a lot of the imported API calls\nhave to do with cryptography and process injections, which could mean there are other\nstages to this malware, but as you can see to the right of the picture above, there is a\nfunction I reverse engineered already that is responsible for decrypting and resolving 100’s\nof APIs from Kernel32.\n\n## IOCs\n\nMain PowerShell Script\n```\n134919151466c9292bdcb7c24c32c841a5183d880072b0ad5e8b3a3a830afef\n\n```\n\n-----\n\nPE Dropper PowerShell Script\n```\n187bf95439da038c1bc291619507ff5e426d250709fa5e3eda7fda99e1c9854c\n\n```\nDropped DLL Backdoor\n```\nb93484683014aca8e909c9b5648d8f0ac21a45d0c193f6ca40f0b01d2464c1c4\n\n## Conclusion\n\n```\nThis PowerShell script that we went through installs a secondary PowerShell script, to which\nwe analyzed and figured that it decodes and loads either a 32-bit DLL or a 64-bit DLL that\nwill most likely be used as its communication module. It was stated by CISA that the FBI has\nhad high confidence that this malware is a Russian state sponsored APT (Advanced\nPersistent Threat) group that uses this malicious virus to exploit victim’s networks. With that\nbeing said, here are all the PowerShell scripts I deobfuscated for this research paper.\n[Dropper Part I &](https://gist.github.com/ryancor/96c127914807ac46d237c3dde5c74ef9) [Dropper Part II.](https://gist.github.com/ryancor/39a73746bb783d1101ab9444d7a08f58)\n\nThank you for following along! I hope you enjoyed it as much as I did. If you have any\nquestions on this article or where to find the challenge, please DM me at my Instagram:\n@hackersclub or Twitter: @ringoware\n\nHappy Hunting :)\n\n## References\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-09-27 - Deobfuscating PowerShell Malware Droppers.pdf"
    ],
    "report_names": [
        "2021-09-27 - Deobfuscating PowerShell Malware Droppers.pdf"
    ],
    "threat_actors": [
        {
            "id": "5d2bd376-fcdc-4c6a-bc2c-17ebbb5b81a4",
            "created_at": "2022-10-25T16:07:23.667223Z",
            "updated_at": "2025-03-27T02:02:09.916086Z",
            "deleted_at": null,
            "main_name": "GCHQ",
            "aliases": [
                "Government Communications Headquarters",
                "Operation Socialist"
            ],
            "source_name": "ETDA:GCHQ",
            "tools": [
                "Prax",
                "Regin",
                "WarriorPride"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "aa73cd6a-868c-4ae4-a5b2-7cb2c5ad1e9d",
            "created_at": "2022-10-25T16:07:24.139848Z",
            "updated_at": "2025-03-27T02:02:10.120505Z",
            "deleted_at": null,
            "main_name": "Safe",
            "aliases": [],
            "source_name": "ETDA:Safe",
            "tools": [
                "DebugView",
                "LZ77",
                "OpenDoc",
                "SafeDisk",
                "TypeConfig",
                "UPXShell",
                "UsbDoc",
                "UsbExe"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "2ed8d590-defa-4873-b2de-b75c9b30931e",
            "created_at": "2023-01-06T13:46:38.730137Z",
            "updated_at": "2025-03-27T02:00:02.903261Z",
            "deleted_at": null,
            "main_name": "MuddyWater",
            "aliases": [
                "Boggy Serpens",
                "Mango Sandstorm",
                "TEMP.Zagros",
                "Static Kitten",
                "G0069",
                "TA450",
                "Earth Vetala",
                "Seedworm",
                "COBALT ULSTER",
                "ATK51"
            ],
            "source_name": "MISPGALAXY:MuddyWater",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "a97cf06d-c2e2-4771-99a2-c9dee0d6a0ac",
            "created_at": "2022-10-25T16:07:24.349252Z",
            "updated_at": "2025-03-27T02:02:10.184406Z",
            "deleted_at": null,
            "main_name": "Turla",
            "aliases": [
                "ATK 13",
                "Belugasturgeon",
                "Blue Python",
                "CTG-8875",
                "Group 88",
                "ITG12",
                "Iron Hunter",
                "Krypton",
                "Makersmark",
                "Operation Epic Turla",
                "Operation Moonlight Maze",
                "Operation Penguin Turla",
                "Operation Satellite Turla",
                "Operation Skipper Turla",
                "Operation Turla Mosquito",
                "Operation WITCHCOVEN",
                "Pacifier APT",
                "Pensive Ursa",
                "Popeye",
                "SIG15",
                "SIG2",
                "SIG23",
                "Secret Blizzard",
                "TAG-0530",
                "Turla",
                "UNC4210",
                "Venomous Bear",
                "Waterbug"
            ],
            "source_name": "ETDA:Turla",
            "tools": [
                "ASPXSpy",
                "ASPXTool",
                "ATI-Agent",
                "AdobeARM",
                "Agent.BTZ",
                "Agent.DNE",
                "BigBoss",
                "COMpfun",
                "Chinch",
                "Cloud Duke",
                "CloudDuke",
                "CloudLook",
                "Cobra Carbon System",
                "ComRAT",
                "DoublePulsar",
                "EmPyre",
                "EmpireProject",
                "Epic Turla",
                "EternalBlue",
                "EternalRomance",
                "GoldenSky",
                "Group Policy Results Tool",
                "HTML5 Encoding",
                "HyperStack",
                "IcedCoffee",
                "IronNetInjector",
                "KSL0T",
                "Kapushka",
                "Kazuar",
                "KopiLuwak",
                "Kotel",
                "LOLBAS",
                "LOLBins",
                "LightNeuron",
                "Living off the Land",
                "Maintools.js",
                "Metasploit",
                "Meterpreter",
                "MiamiBeach",
                "Mimikatz",
                "MiniDionis",
                "Minit",
                "NBTscan",
                "NETTRANS",
                "NETVulture",
                "Neptun",
                "NetFlash",
                "NewPass",
                "Outlook Backdoor",
                "Penquin Turla",
                "Pfinet",
                "PowerShell Empire",
                "PowerShellRunner",
                "PowerShellRunner-based RPC backdoor",
                "PowerStallion",
                "PsExec",
                "PyFlash",
                "QUIETCANARY",
                "Reductor RAT",
                "RocketMan",
                "SMBTouch",
                "SScan",
                "Satellite Turla",
                "SilentMoon",
                "Sun rootkit",
                "TTNG",
                "TadjMakhal",
                "Tavdig",
                "TinyTurla",
                "TinyTurla Next Generation",
                "TinyTurla-NG",
                "Topinambour",
                "Tunnus",
                "Turla",
                "Turla SilentMoon",
                "TurlaChopper",
                "Uroburos",
                "Urouros",
                "WCE",
                "WITCHCOVEN",
                "WhiteAtlas",
                "WhiteBear",
                "Windows Credential Editor",
                "Windows Credentials Editor",
                "Wipbot",
                "WorldCupSec",
                "XTRANS",
                "certutil",
                "certutil.exe",
                "gpresult",
                "nbtscan",
                "nbtstat",
                "pwdump"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "8aaa5515-92dd-448d-bb20-3a253f4f8854",
            "created_at": "2024-06-19T02:03:08.147099Z",
            "updated_at": "2025-03-27T02:05:17.408118Z",
            "deleted_at": null,
            "main_name": "IRON HUNTER",
            "aliases": [
                "Belugasturgeon ",
                "Blue Python ",
                "CTG-8875 ",
                "ITG12 ",
                "KRYPTON ",
                "MAKERSMARK ",
                "Pensive Ursa ",
                "Secret Blizzard ",
                "Turla",
                "UAC-0003 ",
                "UAC-0024 ",
                "UNC4210 ",
                "Venomous Bear ",
                "Waterbug ",
                "ATK13 "
            ],
            "source_name": "Secureworks:IRON HUNTER",
            "tools": [
                " ComRAT",
                " Kazuar",
                " KopiLuwak",
                " LightNeuron",
                " Mosquito",
                " Nautilus",
                " Neuron",
                " Penquin",
                " PoisonFrog",
                " PyFlash",
                " Skipper",
                " Snake",
                " Tavdig",
                " TinyTurla",
                " Tunnus",
                "Carbon-DLL"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "a97fee0d-af4b-4661-ae17-858925438fc4",
            "created_at": "2023-01-06T13:46:38.396415Z",
            "updated_at": "2025-03-27T02:00:02.823045Z",
            "deleted_at": null,
            "main_name": "Turla",
            "aliases": [
                "Uroburos",
                "Hippo Team",
                "Pacifier APT",
                "MAKERSMARK",
                "ATK13",
                "UAC-0003",
                "IRON HUNTER",
                "Waterbug",
                "TAG_0530",
                "KRYPTON",
                "Popeye",
                "SIG23",
                "UAC-0144",
                "G0010",
                "Blue Python",
                "VENOMOUS Bear",
                "Group 88",
                "Pfinet",
                "ITG12",
                "UNC4210",
                "Secret Blizzard",
                "UAC-0024"
            ],
            "source_name": "MISPGALAXY:Turla",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "02e1c2df-8abd-49b1-91d1-61bc733cf96b",
            "created_at": "2022-10-25T15:50:23.308924Z",
            "updated_at": "2025-03-27T02:00:55.437268Z",
            "deleted_at": null,
            "main_name": "MuddyWater",
            "aliases": [
                "MuddyWater",
                "Earth Vetala",
                "Static Kitten",
                "Seedworm",
                "TEMP.Zagros",
                "Mango Sandstorm",
                "TA450"
            ],
            "source_name": "MITRE:MuddyWater",
            "tools": [
                "STARWHALE",
                "POWERSTATS",
                "Out1",
                "PowerSploit",
                "Small Sieve",
                "Mori",
                "Mimikatz",
                "LaZagne",
                "PowGoop",
                "CrackMapExec",
                "ConnectWise",
                "SHARPSTATS",
                "RemoteUtilities",
                "Koadic"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "3c430d71-ab2b-4588-820a-42dd6cfc39fb",
            "created_at": "2022-10-25T16:07:23.880522Z",
            "updated_at": "2025-03-27T02:02:10.010443Z",
            "deleted_at": null,
            "main_name": "MuddyWater",
            "aliases": [
                "ATK 51",
                "Boggy Serpens",
                "Cobalt Ulster",
                "ITG17",
                "Mango Sandstorm",
                "MuddyWater",
                "Operation BlackWater",
                "Operation Earth Vetala",
                "Operation Quicksand",
                "Seedworm",
                "Static Kitten",
                "T-APT-14",
                "TA450",
                "TEMP.Zagros",
                "Yellow Nix"
            ],
            "source_name": "ETDA:MuddyWater",
            "tools": [
                "Agentemis",
                "BugSleep",
                "CLOUDSTATS",
                "ChromeCookiesView",
                "Cobalt Strike",
                "CobaltStrike",
                "CrackMapExec",
                "DELPHSTATS",
                "EmPyre",
                "EmpireProject",
                "FruityC2",
                "Koadic",
                "LOLBAS",
                "LOLBins",
                "LaZagne",
                "Living off the Land",
                "MZCookiesView",
                "Meterpreter",
                "Mimikatz",
                "MuddyC2Go",
                "MuddyRot",
                "Mudwater",
                "POWERSTATS",
                "PRB-Backdoor",
                "PhonyC2",
                "PowGoop",
                "PowerShell Empire",
                "PowerSploit",
                "Powermud",
                "QUADAGENT",
                "SHARPSTATS",
                "SSF",
                "Secure Socket Funneling",
                "Shootback",
                "Smbmap",
                "Valyria",
                "chrome-passwords",
                "cobeacon",
                "prb_backdoor"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "d11c89bb-1640-45fa-8322-6f4e4053d7f3",
            "created_at": "2022-10-25T15:50:23.509601Z",
            "updated_at": "2025-03-27T02:00:55.487991Z",
            "deleted_at": null,
            "main_name": "Turla",
            "aliases": [
                "Turla",
                "IRON HUNTER",
                "Group 88",
                "Waterbug",
                "WhiteBear",
                "Krypton",
                "Venomous Bear",
                "Secret Blizzard",
                "BELUGASTURGEON"
            ],
            "source_name": "MITRE:Turla",
            "tools": [
                "PsExec",
                "nbtstat",
                "ComRAT",
                "netstat",
                "certutil",
                "KOPILUWAK",
                "IronNetInjector",
                "LunarWeb",
                "Arp",
                "Uroburos",
                "PowerStallion",
                "Kazuar",
                "Systeminfo",
                "LightNeuron",
                "Mimikatz",
                "Tasklist",
                "LunarMail",
                "HyperStack",
                "NBTscan",
                "TinyTurla",
                "Penquin",
                "LunarLoader"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1673536212,
    "ts_updated_at": 1743041780,
    "ts_creation_date": 1653692325,
    "ts_modification_date": 1653692325,
    "files": {
        "pdf": "https://archive.orkl.eu/ae9440bab22e0b6a136fd9e00f78d711e78fbd71.pdf",
        "text": "https://archive.orkl.eu/ae9440bab22e0b6a136fd9e00f78d711e78fbd71.txt",
        "img": "https://archive.orkl.eu/ae9440bab22e0b6a136fd9e00f78d711e78fbd71.jpg"
    }
}