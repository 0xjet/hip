{
    "id": "ded436c9-e87f-4f69-9b64-1fda81b0b9ce",
    "created_at": "2023-01-12T15:04:38.628607Z",
    "updated_at": "2025-03-27T02:12:03.876187Z",
    "deleted_at": null,
    "sha1_hash": "7fb261220b413399a7bb8221f107f98cca923462",
    "title": "2021-03-03 - Mass exploitation of on-prem Exchange servers -(",
    "authors": "",
    "file_creation_date": "2022-05-28T04:59:18Z",
    "file_modification_date": "2022-05-28T04:59:18Z",
    "file_size": 1510217,
    "plain_text": "# Mass exploitation of on-prem Exchange servers :(\n\n**[reddit.com/r/msp/comments/lwmo5c/mass_exploitation_of_onprem_exchange_servers](https://www.reddit.com/r/msp/comments/lwmo5c/mass_exploitation_of_onprem_exchange_servers)**\n\nlevel 1\nOp Â· [1 yr. ago Â· edited 1 yr. agoLocked](https://www.reddit.com/r/msp/comments/lwmo5c/comment/gpiak7u/?utm_source=reddit&utm_medium=web2x&context=3)\n\n2\n\nVendor Contributor\n\n**Update 16 - 03/12/2021 - 0458 ET**\n\n[On Thursday afternoon (March 11th), security researcher Michael Gillespie reported ID](https://twitter.com/demonslay335/status/1370125343571509250?s=20)\nRansomware received a sudden increase in ransomware notices coming from IPs belonging\nto Microsoft Exchange servers. The encrypted files can be identified by their `.CRYPT` file\nextension and the file marker `DEARCRY!` [(screenshot of the magic bytes). The ransom](https://pbs.twimg.com/media/EwOpYQgW8AM0mdi?format=png&name=900x900)\n[notice is named readme.txt and includes the following contact emails:](https://imgur.com/uY93cQf)\n\nkonedieyp@airmail[.]cc\n\nuenwonken@memail[.]com\n\n\n-----\n\nMicrosoft has since [confirmed this new family of ransomware is being used after the initial](https://twitter.com/MsftSecIntel/status/1370236539427459076?s=20)\ncompromise of unpatched on-premises Exchange Servers. Microsoft Defender has received\nupdates to detect this and may also be discoverable by the creation of a Service named\n\n`msupdate according to` [James Quinn.](https://pastebin.com/ZNuZvqZy)\n___\n\n**Update 15 - 03/11/2021 - 1504 ET**\n\nWe are observing an uptick in post-exploitation activity. Many of these TTPs were previously\n[disclosed in our March 9th Tradecraft Tuesday but the relevant slides can be found here:](https://www.huntress.com/resources/tradecraft-tuesday/exploiting-cves-and-on-prem-exchange-servers)\n\n[Opera Browser DLL Sideloading Services](https://i.imgur.com/riF1bOT.png)\n\n[Cobalt Strike Loading from VSPerfMon Scheduled Tasks](https://imgur.com/0ADcGTp)\n\n[Sapphire Pigeon Activity Leading to Mimikatz](https://imgur.com/8nLnb1F)\n\n[PowerShell Based Lateral Movement Over SMB](https://imgur.com/EtcliQf)\n\nWith that said, there are some amazing blogs which highlight additional TTPs. We strongly\nsuggest reading these resources:\n\n[Elastic Blog Highlighting Collection of Network Recon Data](https://discuss.elastic.co/t/detection-and-response-for-hafnium-activity/266289/3)\n\n[TrustedSec Blog with Awesome Post-Exploitation Details](https://blog.truesec.com/2021/03/07/exchange-zero-day-proxylogon-and-hafnium/)\n\n[ESET Diving into Multiple Reported Actors Exploiting This Situation](https://www.welivesecurity.com/2021/03/10/exchange-servers-under-siege-10-apt-groups/)\n\n___\n\n**Update 14 - 03/11/2021 - 1413 ET**\n\nThe last three days have been packed with mass analyzing verified intrusions of our\npartners. With this data, we've shared specific threat actor IOCs (not client data) with\nrelevant Law Enforcement, CERTs, and national security organizations. For public\norganizations looking to do their own logging/monitoring/blocking/response, we feel\ncomfortable sharing these observed exploit sources under TLP:WHITE. Huntress has direct\nevidence these IP addresses were used for exploitation and webshell interaction:\n\n103.137.63.195, Mar 3\n\n103.212.223.210, Mar 4\n\n103.213.247.41, Mar 3\n\n104.248.49.97, Feb 28\n\n\n-----\n\n118.189.41.34, Mar 4\n\n130.255.189.21, Mar 3\n\n137.116.145.209, Mar 3\n\n139.59.56.239, Mar 4\n\n139.162.98.150, Mar 4\n\n157.230.221.198, Feb 27\n\n161.35.1.207, Feb 28\n\n161.35.1.225, Feb 28\n\n161.35.51.41, Feb 28\n\n165.232.154.116, Feb 27\n\n167.99.239.29, Feb 28\n\n168.63.134.28, Mar 4\n\n178.20.181.209, Mar 4\n\n[182.239.123.241, Feb 28](https://twitter.com/KyleHanslovan/status/1370077442984001537?s=20)\n\n[182.239.124.180, Mar 3](https://twitter.com/KyleHanslovan/status/1370077442984001537?s=20)\n\n182.153.128.230, Mar 4\n\n185.250.151.192, Mar 2\n\n___\n\n**Update 13 - 03/08/2021 - 1610 ET**\n\n[If interested, tomorrow on Tradecraft Tuesday (March 9 at 1300 ET) we will be covering the](https://huntress.zoom.us/webinar/register/4315646077916/WN__F1p-Q_mSNG_iAkc5UwW9Q)\npost-exploitation techniques we have observed. Everything from the web shells to the\nmalware dropped.___\n\n**Update 12 - 03/06/2021 - 0632 ET**\n\n[Yesterday we started seeing multiple partners' on-prem Exchange servers receive malicious](https://twitter.com/KyleHanslovan/status/1368071668678201344?s=20)\nscheduled tasks that executed a PowerShell downloader from\n```\nhxxp://p.estonine[.]com/p?e . This server was hosted on Digital Ocean and resolved to\n\n```\n[IP address 188.166.162[.]201 and delivered a base64 encoded/compressed PowerShell](https://i.imgur.com/PHvN1e6.png)\n\n\n-----\n\n[script. Oddly enough, this PowerShell looked very similar to a previous coin miner campaign](https://i.imgur.com/PHvN1e6.png)\n[reported by Carbon Black in 2019. After reporting the incident to Digital Ocean (hosting) and](https://vulners.com/carbonblack/CARBONBLACK:6730D6EB8DF875C002A93DBC78C80B9D)\n[NameCheap (registrar), we started digging into Layer 4 of the delivered payload. After](https://i.imgur.com/WOkyU7f.png)\n[deobfucating this (which produced Layer 5) we learned there were two Mimikatz DLLs (x86](https://gist.github.com/JohnHammond/d4dba6b272bcae62d8946a0eb9af9220)\nand x64) embedded within the script which gets reflectively loaded/injected.\n\n32bit - D58A41A393F4B9A406226689F29C7017CA20F788\n\n64bit - FA8E53CB3497CBF81CFEE0DDBF171DE98B83211D\n\nStay vigilant because it looks like things may start to heat up ðŸ”¥\n\n___\n\n**Update 11 - 03/05/2021 - 2319 ET**\n\n[Brian Krebs' fantastic reporting estimates 30,000+ unique US organizations have been](https://krebsonsecurity.com/2021/03/at-least-30000-u-s-organizations-newly-hacked-via-holes-in-microsofts-email-software/)\ncompromised. Many researchers beyond the Huntress team are scratching their heads on\nwhy did this incident escalated from the \"limited and targeted\" attacks observed by Volexity\non Jan 6th, 2021 to this worldwide incident. Notable commenters include former CISA\nDirector Chris Krebs and Microsoft's Hafnium blog has been updated with additional\nresources to aid those performing investigations.\n\nAlso of note is Microsoft has updated their CSS Exchange repo on Github with their own\nNmap NSE to \"detect whether the specified URL is vulnerable to the Exchange Server SSRF\nVulnerability (CVE-2021-26855).\" Folks have reported improved accuracy but warned a bug\n[in Nmap could cause false inaccessibility errors. This is reportedly fixable by adding](https://twitter.com/GossiTheDog/status/1367602047609102341?s=20) `--min-`\n```\nrtt-timeout 3 to Nmap's parameters. We recommend using this Microsoft version going\n\n```\nforward to assist validating your patch status and will provide feedback if we discover better\nalternatives.\n\n___\n\n**Update 10 - 03/05/2021 - 1704 ET**\n\nJust a quick update to our 1254 ET post.\n\nWe've confirmed the Nmap NSE script will display \"potentially vulnerable\" for both fully\npatched server AND servers with only the most recent CU level (which is still vulnerable).\nThe script scrapes the OWA page to determine the version of Exchange. The OWA page\nonly includes the version number as major.minor.X but you need major.minor.X.Y to\nconfirm the fully patched version.\n\nThat said, the script is useful for finding unpatched versions quickly. Just be aware you need\nto verify the complete patch level for servers that have the most recent CU applied.\n\n\n-----\n\nAlso, the various Exchange registry keys, such as ClientAccessRole, are not completely\nreliable for patch verification. Here only the latest CU level version is reported, but patches to\na CU do not appear to update the version number stored in the registry.\n\n___\n\n**Update 9 - 03/05/2021 - 1254 ET**\n\nTons of folks couldn't join the webinar yesterday so we want to more useful points:\n\n[The internet is now mass scanning for these webshells](https://i.imgur.com/JEFOUTl.png)\n\n[Microsoft published a script to assist the detection of malicious Exchange activity](https://github.com/microsoft/CSS-Exchange/tree/main/Security)\n\nThe Nmap NSE to find vulnerable exchange boxes is not perfect (more on this shortly)\n\nUsing the registry's exchange build data is not perfect (more on this shortly)\n\nMore community resources are starting to pour in, so we'd like to highlight them:\n\n[NinjaRMM created great collection vendor knowledge. Check it out!](https://www.ninjarmm.com/blog/microsoft-exchange-0-day-vulnerabilities-mitigation/)\n\n[Shodan has added some detection capabilities. Unsure if it has the same accuracy](https://twitter.com/shodanhq/status/1367525621065261062?s=20)\nissues as the Nmap NSE released earlier this week.\n\n___\n\n**Update 8 - 03/04/2021 - 1628 ET**\n\nJust finished the webinar and our team is in the process of sending the slides and\nrecordings. In case you didn't make it, here's some of the most useful data\n\n[List of Huntress Discovered \"China Chopper\" ASPX Webshell Filenames - 04 March](https://gist.github.com/JohnHammond/0b4a45cad4f4ed3324939d72dc599883)\n\n[PDF Version of the Presented Slides - 04 March](https://www.huntress.com/resources/ebook/exchange-server-exploitation)\n\n[Microsoft Emergency Patches - 02 March](https://msrc-blog.microsoft.com/2021/03/02/multiple-security-updates-released-for-exchange-server/)\n\n___\n\n**Had to split this into two posts (hit the Reddit limit). See the** **[older updates here.](https://www.reddit.com/r/msp/comments/lwmo5c/mass_exploitation_of_onprem_exchange_servers/gptmzry/)**\n\n88\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-03-03 - Mass exploitation of on-prem Exchange servers -(.pdf"
    ],
    "report_names": [
        "2021-03-03 - Mass exploitation of on-prem Exchange servers -(.pdf"
    ],
    "threat_actors": [
        {
            "id": "529c1ae9-4579-4245-86a6-20f4563a695d",
            "created_at": "2022-10-25T16:07:23.702006Z",
            "updated_at": "2025-03-27T02:02:09.93109Z",
            "deleted_at": null,
            "main_name": "Hafnium",
            "aliases": [
                "Red Dev 13",
                "Silk Typhoon"
            ],
            "source_name": "ETDA:Hafnium",
            "tools": [],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "610a7295-3139-4f34-8cec-b3da40add480",
            "created_at": "2023-01-06T13:46:38.608142Z",
            "updated_at": "2025-03-27T02:00:02.87217Z",
            "deleted_at": null,
            "main_name": "Cobalt",
            "aliases": [
                "Cobalt Gang",
                "GOLD KINGSWOOD",
                "COBALT SPIDER",
                "G0080",
                "Mule Libra",
                "Cobalt Group"
            ],
            "source_name": "MISPGALAXY:Cobalt",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "7c969685-459b-4c93-a788-74108eab6f47",
            "created_at": "2023-01-06T13:46:39.189751Z",
            "updated_at": "2025-03-27T02:00:03.017103Z",
            "deleted_at": null,
            "main_name": "HAFNIUM",
            "aliases": [
                "ATK233",
                "G0125",
                "Operation Exchange Marauder",
                "Red Dev 13",
                "Silk Typhoon"
            ],
            "source_name": "MISPGALAXY:HAFNIUM",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "2704d770-43b4-4bc4-8a5a-05df87416848",
            "created_at": "2022-10-25T15:50:23.306305Z",
            "updated_at": "2025-03-27T02:00:55.43633Z",
            "deleted_at": null,
            "main_name": "HAFNIUM",
            "aliases": [
                "HAFNIUM",
                "Operation Exchange Marauder",
                "Silk Typhoon"
            ],
            "source_name": "MITRE:HAFNIUM",
            "tools": [
                "Tarrask",
                "ASPXSpy",
                "Impacket",
                "PsExec",
                "China Chopper"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1673535878,
    "ts_updated_at": 1743041523,
    "ts_creation_date": 1653713958,
    "ts_modification_date": 1653713958,
    "files": {
        "pdf": "https://archive.orkl.eu/7fb261220b413399a7bb8221f107f98cca923462.pdf",
        "text": "https://archive.orkl.eu/7fb261220b413399a7bb8221f107f98cca923462.txt",
        "img": "https://archive.orkl.eu/7fb261220b413399a7bb8221f107f98cca923462.jpg"
    }
}