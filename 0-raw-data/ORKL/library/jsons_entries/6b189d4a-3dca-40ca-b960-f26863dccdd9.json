{
    "id": "6b189d4a-3dca-40ca-b960-f26863dccdd9",
    "created_at": "2024-07-26T02:05:41.433716Z",
    "updated_at": "2025-03-27T02:14:43.612695Z",
    "deleted_at": null,
    "sha1_hash": "b9da9325aa7d7e8f3042b12b046c04aa2b4f7842",
    "title": "Arid Viper poisons Android apps with AridSpy",
    "authors": "",
    "file_creation_date": "2024-07-25T13:58:51Z",
    "file_modification_date": "2024-07-25T13:58:51Z",
    "file_size": 2871456,
    "plain_text": "# Arid Viper poisons Android apps with AridSpy\n\nESET researchers discovered Arid Viper espionage campaigns spreading trojanized apps to Android users\n\nin Egypt and Palestine\n\n[Lukas Stefanko](https://www.welivesecurity.com/en/our-experts/lukas-stefanko/)\n\n13 Jun 2024 • 25 min. read\n\n\n-----\n\ncarried out by the Arid Viper APT group, these campaigns started in 2022 and three of them are still ongoing at the\n\ntime of the publication of this blogpost. They deploy multistage Android spyware, which we named AridSpy, that\n\ndownloads first- and second-stage payloads from its C&C server to assist it avoiding detection. The malware is\n\ndistributed through dedicated websites impersonating various messaging apps, a job opportunity app, and a\n\nPalestinian Civil Registry app. Often these are existing applications that had been trojanized by the addition of\n\nAridSpy’s malicious code.\n\n\nArid Viper, also known as APT-C-23, Desert Falcons, or Two-tailed Scorpion, is a cyberespionage group that has\n\n[been active since at least 2013. Known for targeting countries in the Middle East, the group has drawn attention](https://securelist.com/the-desert-falcons-targeted-attacks/68817/)\n\n[over the years for its vast arsenal of malware for Android, iOS, and Windows platforms. We reported on the group](https://www.welivesecurity.com/2020/09/30/aptc23-group-evolves-its-android-spyware/)\n\n[and its then-newest spyware in a previous blogpost.](https://www.welivesecurity.com/2020/09/30/aptc23-group-evolves-its-android-spyware/)\n\n\n## Overview\n\n\nESET Research identified five Arid Viper campaigns targeting Android users. These campaigns delivered malware\n\nvia dedicated websites from which victims could download and manually install an Android application. Three\n\napps provided on these websites are legitimate apps trojanized with malicious code that we named AridSpy, whose\n\npurpose is espionage. You can see the overview scheme in Figure 1.\n\n\n-----\n\n_Figure 1. Infiltration overview_\n\n\n[AridSpy was first analyzed by Zimperium in 2021; at the time, the malware only consisted of a single stage, with](https://www.zimperium.com/blog/new-advanced-android-malware-posing-as-system-update/)\n\nall the malicious code implemented in the trojanized application.\n\n\n[The second occurrence of AridSpy that ESET Research identified was being used in 2022 (and later analyzed by](https://twitter.com/ESETresearch/status/1596222232384401408)\n\n[360 Beacon Labs in December 2022), where the malware operators targeted the FIFA World Cup in Qatar.](https://mp.weixin.qq.com/s/48Atw1b6Oe7A-vlsKHYWwg)\n\nImpersonating one of the many Kora applications, the campaign deployed the Kora442 app bundled with AridSpy.\n\nAs in the case of the sample analyzed by Zimperium, the malware still only had one stage at this time.\n\n\n[In March 2023, 360 Beacon Labs analyzed another Android campaign operated by Arid Viper and found a](https://www.ctfiot.com/106664.html)\n\nconnection between the Kora442 campaign and the Arid Viper group, based on use of the myScript.js file\n\ni d i Fi 1 W f d h i i h i di d i hi bl ( l i d i\n\n\n-----\n\nwebsites.\n\n\nIn August 2023 we logged a detection of AridSpy in our telemetry and investigated further. We identified targets in\n\nPalestine and Egypt. New in these campaigns, AridSpy was turned into a multistage trojan, with additional\n\npayloads being downloaded from the C&C server by the initial, trojanized app.\n\n\nAt the time of this publication, three out of the five discovered campaigns are still active; the campaigns used\n\ndedicated websites to distribute malicious apps impersonating NortirChat, LapizaChat, and ReblyChat, and the\n\nلغشلما قيبطت (machine translation: Operator application; we will refer to this as the job opportunity app) and لجسلا\n\nينيطسلفلا يندلما (machine translation: Palestinian Civil Registry) apps. We discovered the following distribution\n\n[websites via our telemetry, VirusTotal, and pivoting on the shared myScript.js script using the FOFA network](https://en.fofa.info/)\n\n[search engine (which is an alternative to Shodan and Censys):](https://en.fofa.info/)\n\n\n[Parallel to our investigation, the FOFA research team published a blogpost that discusses discovering seven](https://medium.com/@fofabot/practical-fofa-asset-expansion-apt-c-23-android-malware-7964b6625c6d)\n\ndistribution websites with the myScript.js JavaScript file responsible for retrieving the download paths for\n\nArid Viper payloads. Four of these websites distributed various versions of AridSpy. The following two were\n\npreviously unknown to us:\n\n\nIn this blogpost, we focus on AridSpy payloads that we could obtain from all the confirmed active distribution\n\nwebsites listed above.\n\n\nNote that these malicious apps have never been offered through Google Play and are downloaded from third-party\n\nsites. To install these apps, the potential victim is requested to enable the non-default Android option to install apps\n\nfrom unknown sources.\n\n\n### Victimology\n\n\nAltogether we detected six occurrences of AridSpy in our telemetry, from Palestine and Egypt. The majority of the\n\n\n-----\n\nbut with a different package name in Egypt. There was also another first-stage payload detected in Egypt, one that\n\nuses the same C&C servers as the samples in the LapizaChat and job opportunity campaigns.\n\n\n### Attribution\n\n\nWe attribute AridSpy to Arid Viper with medium confidence, based on these indicators:\n\n\n`myScript.js was first discovered and linked to Arid Viper in 360 Beacon Labs’ March 30, 2023 th` [analysis of a](https://www.ctfiot.com/106664.html)\n\ndifferent Android campaign operated by Arid Viper. The (unnamed) malicious Android code used in that campaign\n\n[was previously attributed to the Arid Viper group. myScript.js was found on one of the distribution websites](https://research.checkpoint.com/2020/hamas-android-malware-on-idf-soldiers-this-is-how-it-happened/)\n\nused in the campaign. The purpose of this JavaScript code was to download a malicious Android app hosted on the\n\ndistribution server.\n\n\nFigure 2 shows the part of the code that registers the handler for clicks on the website’s Download button, and\n\nFigure 3 displays JavaScript code that generates file paths to download the malicious app.\n\n\n_Figure 2. Registration of a click event handler for the Download button_\n\n\n-----\n\n_Figure 3. JavaScript code responsible for downloading the malicious app_\n\n\nAs pointed out by 360 Beacon Labs, this same JavaScript code was also used in the campaign that targeted the\n\n[FIFA World Cup in Qatar with an earlier version of AridSpy, which we reported in 2022. In both campaigns, the](https://twitter.com/ESETresearch/status/1596222496121925633)\n\ndistribution websites used this specific myScript.js script to retrieve a malicious app from a server, although\n\nthe final payload was different.\n\n\nFinally, we found a very similar piece of JavaScript on the distribution websites for the campaigns discussed in\n\nthis blogpost, distributing NortirChat, LapizaChat, and ReblyChat. During our investigation, this linkage was\n\nindependently confirmed by the research team of the FOFA search engine, who found seven of the same\n\ndistribution websites that contained the myScript.js responsible for downloading Android AridSpy,\n\n[and attributed this malware to Arid Viper.](https://medium.com/@fofabot/practical-fofa-asset-expansion-apt-c-23-android-malware-7964b6625c6d)\n\n\nWe have not been able to link the JavaScript code used in these campaigns to any legitimate or open-source\n\nproject, which leads us to believe that this script is most likely specific to various Arid Viper campaigns\n\ndistributing Android malware.\n\n\nIt is possible that Arid Viper reused this distribution method, but switched to a new tool, AridSpy, for its new\n\n[campaigns, since the (unnamed) malware family the group used before was disclosed and analyzed by various](https://www.ctfiot.com/106664.html)\n\nresearchers and security companies.\n\n\nInterestingly, we also discovered a different version of myScript.js on the AridSpy distribution site,\n\nmasquerading as a Palestinian Civil Registry app. In this case, the script had the same purpose but not the same\n\nJavaScript code: instead of downloading AridSpy, this script just returned a hardcoded link to AridSpy.\n\n\n[This version of the script is based on a script available online, contrary to the earlier versions that appear to use a](https://netparadis.com/javascript-tutorial-44-ajax/)\n\ncustom-developed myScript.js file. When the earlier versions of myScript.js were disclosed and\n\nattributed to Arid Viper, the threat actors most likely changed its code to avoid their new code being connected to\n\nthe group.\n\n\n-----\n\n### Initial access\n\n\nThe distribution mechanism is very similar for all campaigns mentioned in this section. In order to gain initial\n\naccess to the device, the threat actors try to convince their potential victim to install a fake, but functional, app.\n\nOnce the target clicks the site’s Download button, myScript.js, hosted on the same server, is executed to\n\ngenerate the correct download file path for the malicious AridSpy. This script makes an AJAX request\n\nto api.php located on the same server and returns a specific file directory and name.\n\n\n#### Trojanized messaging applications\n\n\nStarting chronologically, we will first look at the campaign posing as LapizaChat, a malicious Android application\n\nthat was available for download from the dedicated lapizachat[.]com website. This website was registered\n\non January 16, 2022 and is no longer active. Its interface can be seen in Figure 4.th\n\n\n-----\n\n_Figure 4. LapizaChat website_\n\n\nIn an open directory on the server, there was not one, but actually three LapizaChat Android apps, stored in\n\n[different directories. One of the apps was a copy of the legitimate StealthChat: Private Messaging app and had no](https://play.google.com/store/apps/details?id=com.rockliffe.stealth)\n\nmalicious functionality. It contained the same legitimate messaging code as StealthChat, but with different\n\napplication icon, name, and package name. This app has been available on the distribution website since January\n\n18, 2022.th\n\n\nThe other two apps were trojanized versions of StealthChat: Private Messaging bundled with AridSpy’s malicious\n\ncode. Based on the last modification date, they were available on the server since July 5, 2023 and Septemberth\n\n\n18, 2023 respectively, based on the last modification date. The two malicious apps are very similar to each other;th\n\nthe latter sample contains the same malicious code, with only minor, insignificant changes. It was this version that\n\nthe victim would download from the website after clicking the Download Now button. Filenames, last\n\nmodification dates, and hashes are listed in Table 1.\n\n\nTable 1. Samples available on lapizachat[.]com website\n\n\n**Filename** **Last modified** **SHA-1** **Description**\n\n```\n                      D99D9689A7C893AFCE84\n\n```\n`LapizaChat.apk` 2022‑01‑18\n```\n                      04D273D6BA31446C998D\n                      3485A0A51C6DAE251CDA\n\n```\n`LapizaChat_old.apk` 2023‑07‑05\n```\n                      D20B2F659B3815212162\n                      F49B00896C99EA030DCC\n\n```\n`LapizaChat.apk` 2023‑09‑18\n```\n                      A0808B87E414BBDE1549\n\n```\n\n[The legitimate StealthChat: Private](https://play.google.com/store/apps/details?id=com.rockliffe.stealth)\n[Messaging application, version 1.8.42](https://play.google.com/store/apps/details?id=com.rockliffe.stealth)\n(6008042).\n\nStealthChat trojanized with AridSpy,\ndistributed under the name LapizaChat.\n\n\nWe identified two other campaigns that started distributing AridSpy after LapizaChat, this time posing as\n\n\n-----\n\nregistered on April 30, 2023; see Figure 5.th\n\n\n_Figure 5. NortirChat (left) and ReblyChat (right) distribution websites_\n\n\nSimilar to the previous case, we were able to retrieve additional samples from open directories, including both the\n\nclean and trojanized versions of the messaging applications. NortirChat is based on the\n\n[legitimate Session messaging app, while ReblyChat is based on the legitimate Voxer Walkie Talkie Messenger. In](https://getsession.org/)\n\nboth cases, the trojanized applications have the same code but the malware developers changed the application\n\nicon, name, and package name. Table 2 and Table 3 list details of the applications retrieved from these servers.\n\n\nTable 2. Samples available on nortirchats[.]com website\n\n\n-----\n\n```\n                      13A89D28535FC1D53794\n\n```\n`NortirChat_old.apk` 2022‑09‑28\n```\n                      6D7D017DA02671227924\n                      1878F674F59E81E86986\n\n```\n`NortirChat.apk` 2023‑03‑19\n```\n                      0EB9A2269046DF5CE855\n                      2158D88BCE6368FAC3FC\n\n```\n`NortirChat_old.apk` 2023‑06‑14\n```\n                      B7F3A508FE6B96B0CF8A\n                      DB6B6326B772257FDDCB\n\n```\n`NortirChat.apk` 2023‑09‑11\n```\n                      4BE7CF1A0CC0322387D8\n\n```\n\n**p**\n\n[The legitimate Session messaging app,](https://getsession.org/)\nversion 1.16.5 (3331).\n\nSession app trojanized with AridSpy,\ndistributed under the name NortirChat.\n\n\nTable 3. Samples available on reblychat[.]com website\n\n\n**Filename** **Last modified** **SHA-1** **Description**\n\n```\n                   FFDD0E387EB3FEF7CBD2\n\n```\n`reblychat.apk` 2023‑06‑08\n```\n                   E3DCA5D8924275C3FB94\nreblychat- A64D73C43B41F9A5B938\n\n```\n2023‑06‑08\n```\nold.apk AE8558759ADC474005C1\n                   797073511A15EB85C1E9\n\n```\n`reblychat.apk` 2023‑06‑11\n```\n                   D8584B26BAA3A0B14C9E\n\n```\n\n[The legitimate Voxer Walkie Talkie](https://play.google.com/store/apps/details?id=com.rebelvox.voxer)\n[Messenger application, version 4.0.2.22408](https://play.google.com/store/apps/details?id=com.rebelvox.voxer)\n(3669119).\n\nThe Voxer Walkie Talkie Messenger app\ntrojanized with AridSpy, distributed under the\nname ReblyChat.\n\n\n#### Masquerading as a Palestinian Civil Registry application\n\n\nMoving on from trojanizing chat applications for the time being, the operators then launched a campaign\n\ndistributing an app purporting to be from the Palestinian Civil Registry (ينيطسلفلا يندلما لجسلا). The malicious app\n\nclaims to offer general information about the residents of Palestine, such as name, place of residence, date of birth,\n\nID number, and other information. This campaign provides a malicious Android app available for download\n\nfrom palcivilreg[.]com, registered on May 30, 2023; see Figure 6.th\n\n\n-----\n\n_Figure 6._ `palcivilreg[.]com` _website_\n\n\nMachine translation of the website from Figure 6: “Palestinian Civil Registry. To find out information about any\n\nperson or search for any person’s identity number or date of birth, download the application to search the\n\nPalestinian civil registry.”\n\n\n[This website is advertised via a dedicated Facebook page – see Figure 7 – that was created on July 25, 2023 andth](https://www.facebook.com/profile.php?id=100094945850705)\n\nlinks directly to palcivilreg[.]com. We have reported this page to Facebook.\n\n\n-----\n\n_Figure 7. Facebook page promoting the_ `palcivilreg[.]com` _website for every Palestinian to_\n\n_identify personal data_\n\n\nMachine translation of the cover photo visible in Figure 7: “Palestinian Civil Registry. Search for any person’s\n\nname and obtain his full data. Get date of birth and age of any person. Ease of searching and entering the\n\napplication.”\n\n\nSelecting the ليمحت (Download, in Arabic; see Figure 6) button executes myScript.js, initiating download from\n\na hardcoded URL; see Figure 8. This instance of myScript.js code is slightly changed, compared to previously\n\nmentioned campaigns, but achieves the same results – retrieving a file from a malicious link. This version of the\n\n[script can be found in many tutorials available online; one of its first occurrences seems to be from February 2019.](https://netparadis.com/javascript-tutorial-44-ajax/)\n\n\n-----\n\n_Figure 8. Content of myScript.js file_\n\n\n[The Palestinian Civil Registry app is inspired by an app on Google Play that has been available for download since](https://play.google.com/store/apps/details?id=com.zezsoft.palestinearchive)\n\nMarch 2020 and provides the same functionality as claimed on the palcivilreg[.]com site. The app on\n\nGoogle Play is linked to the website zezsoft.wuaze[.]com, which allows downloading iOS and Android\n\napps. At the time of this research, the iOS application was not available, and the Android app link refers to the file\nsharing storage site MediaFire, not to Google Play. This app was no longer available from MediaFire, so we are\n\nnot able to confirm whether that version was legitimate.\n\n\nBased on our investigation, the malicious app available on palcivilreg[.]com is not a trojanized version of\n\nthe app on Google Play; however, it uses that app’s legitimate server to retrieve information. This means that Arid\n\nViper was inspired by that app’s functionality but created its own client layer that communicates with the\n\n[legitimate server. Most likely, Arid Viper reverse engineered the legitimate Android app from Google Play and](https://play.google.com/store/apps/details?id=com.zezsoft.palestinearchive&hl=en)\n\nused its server for retrieving victims’ data.\n\n\n#### Masquerading as a job portal application\n\n\nThe last campaign we identified distributes AridSpy as an app named لغشلما قيبطت (machine translation: Operator\n\napplication; we refer to this as the job opportunity app), available for download from almoshell[.]website,\n\nregistered on August 19, 2023. This website claims to provide a job to anyone who applies through the Androidth\n\napp. In this case, the malicious app is not a trojanized version of any legitimate app. When supposedly applying for\n\na job, AridSpy makes requests to almoshell[.]website for registered users. This service runs on a malware\n\ndistribution website, so it is difficult to identify whether any relevant work offers are returned to the app’s user or\n\nnot. The website is shown in Figure 9.\n\n\n-----\n\n_Figure 9. Distribution website that allegedly provides a job by sending an application with the linked_\n\n_Android app_\n\n\nThe job opportunity app has been available for download from this distribution site since August 20, 2023; seeth\n\nFigure 10.\n\n\n-----\n\n### Toolset\n\n\nAll analyzed Android apps from these campaigns contain similar malicious code, and download first- and second\nstage payloads; our analysis focuses on the NortirChat and LapizaChat campaigns, where we were able to obtain\n\nthe final payloads.\n\n\n#### Trojanized application\n\n\nThe campaigns mostly deploy legitimate apps that have been trojanized. In the analyzed LapizaChat and\n\nNortirChat cases, malicious functionality responsible for downloading a payload is implemented in\n\nthe apputils subpackage inserted into the legitimate messaging apps, as can be seen in Figure 11.\n\n\n-----\n\n_Figure 11. Code comparison of legitimate StealthChat (left) and its trojanized version advertised as_\n\n_LapizaChat (right)_\n\n\nAfter the initial start of the app, the malware looks for installed security software based on a hardcoded list of\n\ndozens of security applications, and reports the results to the C&C server. The complete list of these apps, along\n\nwith their package names, is in Table 4.\n\n\nTable 4. List of security apps in the order that they appear in the code\n\n\n**App name** **Package name**\n\n**Bitdefender Mobile Security** `com.bitdefender.security`\n\n**Avast Antivirus & Security** `com.avast.android.mobilesecurity`\n\n**McAfee Security: Antivirus VPN** `com.wsandroid.suite`\n\n**Avira Security Antivirus & VPN** `com.avira.android`\n\n**Malwarebytes Mobile Security** `org.malwarebytes.antimalware`\n\n**Kaspersky: VPN & Antivirus** `com.kms.free`\n\n**ESET Mobile Security Antivirus** `com.eset.ems2.gp`\n\n**Sophos Intercept X for Mobile** `com.sophos.smsec`\n\n**Dr.Web Security Space** `com.drweb.pro`\n\n**Mobile Security & Antivirus** `com.trendmicro.tmmspersonal`\n\n\n-----\n\n**Antivirus and Mobile Security** `com.quickheal.platform`\n\n**Security Antivirus Max Cleaner** `com.maxdevlab.cleaner.security`\n\n**AVG AntiVirus & Security** `com.antivirus`\n\n**APUS Security:Antivirus Master** `com.guardian.security.pri`\n\n**Norton360 Mobile Virus Scanner** `com.symantec.mobilesecurity`\n\n**360 Security** `com.qihoo.security`\n\n**Lookout Life - Mobile Security** `com.lookout`\n\n**dfndr security: antivirus** `com.psafe.msuite`\n```\n                        phone.antivirus.virus.cleaner.junk.clean.speed.\n\n```\n**Virus Cleaner, Antivirus Clean**\n```\n                        booster.master\n\n```\n**Antivirus & Virus Cleaner Lock** `com.antivirus.mobilesecurity.viruscleaner.applock`\n\n**GO Security－AntiVirus, AppLock, Booster** `com.jb.security`\n\n**Zimperium MTD** `com.zimperium.zips`\n\n**Intune Company Portal** `com.microsoft.windowsintune.companyportal`\n\n**Active Shield Enterprise** `com.better.active.shield.enterprise`\n\n**Harmony Mobile Protect** `com.lacoon.security.fox`\n\n**Lookout for Work** `com.lookout.enterprise`\n\n\n-----\n\n**Microsoft Defender: Antivirus** `com.microsoft.scmx`\n\n**Sophos Mobile Control** `com.sophos.mobilecontrol.client.android`\n\n**Jamf Trust** `com.wandera.android`\n\n**SEP Mobile** `com.skycure.skycure`\n\n**Pradeo Security** `net.pradeo.service`\n\n\nIf security software on the list is installed on the device, the malware will send this information to the C&C server.\n\nIf the server returns the value 0, then the first-stage payload will not be downloaded. If the server returns the\n\nvalue 1, then AridSpy proceeds and downloads the first-stage payload. In all cases that we observed, when a\n\nsecurity app was installed on the device, the server returned the value 0 and payloads were not downloaded.\n\n\nAridSpy uses trivial string obfuscation, where each string is declared by converting a character array into a string.\n\nThis method was used in every sample and even in the first published analysis by Zimperium. That same\n\nobfuscation is also applied in the first- and second-stage payloads. Figure 12 shows an example.\n\n\n_Figure 12. String obfuscation_\n\n\nIf security software is not installed, AridSpy downloads the AES-encrypted first-stage payload from its C&C\n\nserver. This payload is then decrypted using a hardcoded key, and the potential victim is asked to install it\n\nmanually. The first-stage payload impersonates an update of Google Play services, as displayed in Figure 13.\n\n\n-----\n\n_Figure 13. Request to potential victim to install first-stage payload: left to right; LapizaChat, ReblyChat,_\n\n_and Palestinian Civil Registry_\n\n\n#### First-stage payload\n\n\nDuring installation of the malicious update, the first-stage payload displays app names such as Play\n```\nManager or Service Google. This payload works separately, without the necessity of having the trojanized\n\n```\napp installed on the same device. This means that if the victim uninstalls the initial trojanized app, for example\n\nLapizaChat, AridSpy will not be in any way affected.\n\n\nFunctionality-wise, the first-stage payload is similar to the trojanized application. It is responsible for downloading\n\nthe second-stage payload, which is then dynamically loaded and executed. The first-stage payload downloads an\n\nAES-encrypted second-stage payload from a hardcoded URL and controls its further execution.\n\n\n#### Second-stage payload\n\n\nThe second-stage payload is a Dalvik executable (dex); based on our observations, it always has the\n\nname prefLog.dex. The malicious functionality is implemented in this stage; however, it is operated by the\n\nfirst-stage payload, which loads it whenever necessary.\n\n\nAridSpy uses a Firebase C&C domain for receiving commands, and a different, hardcoded C&C domain, for data\n\nexfiltration. We reported the Firebase servers to Google, since it provides the service.\n\n\nWhen payloads are downloaded and executed, AridSpy sets listeners to monitor when the device screen is on and\n\n\n-----\n\nthe battery level is above 15%. By default, these pictures are taken using the front camera; however, this can be\n\nchanged by receiving a command from the Firebase C&C server to use the rear camera. Images are archived in\n\nthe data.zip file on internal storage and uploaded to the exfiltration C&C server.\n\n\nAridSpy has a feature intended to avoid network detection – specifically C&C communication. It can deactivate\n\nitself, as AridSpy states in the code, by changing the exfiltration C&C server used for data upload to a dummy\n\nhardcoded androidd[.]com domain (a currently registered typosquat). This action occurs based on a command\n\nreceived from the Firebase C&C server. The dummy domain would probably look more legitimate, is not flagged\n\nas malicious, and might not trigger network detection systems.\n\n\nData exfiltration is initiated either by receiving a command from the Firebase C&C server or when a specifically\n\ndefined event is triggered. These events are defined in AndroidManifext.xml and are caused when actions\n\noccur, such as: internet connectivity changes, the app is installed or uninstalled, a phone call is made or received,\n\nan SMS message is sent or received, a battery charger is connected or disconnected, or the device reboots.\n\n\nIf any of these events occurs, AridSpy starts to gather various victim data and uploads it to the exfiltration C&C\n\nserver. It can collect:\n\n\ndevice location,\n\ncontact list,\n\ncall logs,\n\ntext messages,\n\nthumbnails of photos,\n\nthumbnails of recorded videos,\n\nrecorded phone calls,\n\nrecorded surrounding audio,\n\nmalware-taken photos,\n\nfile structure of external storage,\n\nsix WhatsApp databases (wa.db-wal, wa.db-shm, wa.db, msgstore.db-wal, msgstore.db```\nshm, msgstore.db) that contain exchanged messages and user contacts, if the device is rooted,\n\n```\nbookmarks and search history from the default browser and Chrome, Samsung Browser, and Firefox apps if installed,\n\ndata in the clipboard,\n\n\n-----\n\n```\n.ppt, .pptx, and .opus,\n\n```\nthumbnails from the Samsung Gallery app stored in\n\nthe /storage/emulated/0/Android/data/com.sec.android.gallery3d/cache/ directory,\n\nall received notifications,\n\nFacebook Messenger and WhatsApp communication, and\n\nlogs of all text visible by misusing Accessibility services.\n\n\nBesides waiting for events to occur, the Arid Viper operator can extract specific information and upload it\n\nimmediately to the exfiltration C&C server by sending commands to the compromised device. AridSpy can receive\n\ncommands from its Firebase C&C server to obtain data or to control the malware. Operators can exfiltrate:\n\n\nBy receiving control commands, it can:\n\n\ndeactivate communication by replacing the exfiltration C&C domain with the dummy value androidd[.]com,\n\nactivate communication by replacing the dummy `d` `idd[ ]` C&C domain with another domain name\n\n\n-----\n\nchange the exfiltration C&C server for data upload.\n\n\nAridSpy can snoop on user activity by keylogging all text visible and editable in any application. On top of that, it\n\nspecifically focuses on Facebook Messenger and WhatsApp communications, which are stored and exfiltrated\n\nseparately. To accomplish this task, it misuses built-in accessibility services to record all text visible and uploads it\n\nto the exfiltration C&C server. Examples of stored WhatsApp communications can be seen in Figure 14.\n\n\n_Figure 14. Victim’s WhatsApp communication (right) logged by AridSpy (left)_\n\n\nBefore collected data is uploaded to the exfiltration C&C server, it is stored on internal storage,\n\nin /data/data/<package_name>/files/files/systems/, that belongs to AridSpy. The obtained\n\ncontact list, SMS, call logs, location, captured keys, file structures, and other text information are stored in plain\n\ntext as JSON files. All exfiltrated data is saved using specific filenames that might contain file IDs, filenames, time\n\nstamps, location, phone number, and AridSpy version. These values are divided by the delimiter #$&, as can be\n\nseen in Figure 15.\n\n\n-----\n\n_version number)_\n\n\nAll these files from any particular subdirectory are then zipped into data.zip and encrypted using custom\n\nencryption. Each of the encrypted files uses a randomly generated filename with the _Father.zip suffix. This\n\nstring is hardcoded and appended to every file. The files are then uploaded to the exfiltration C&C server and\n\nremoved from the device.\n\n\nWhile going through the decompiled AridSpy code, we identified a version number, which is used as part of the\n\nfilename when exfiltrating victim data (#$&V30#$&), also visible in Figure 15 (highlighted is the version\n\nnumber). The AridSpy version has been changing across the campaigns and was included even with its first variant\n\ndisclosed in 2021. For some of the AridSpy samples, the version number is present in the trojanized app and also\n\nin the second-stage payload. This version might be different, since the downloaded payload can be updated. In\n\nTable 5, you can see the package names and their versions. Some trojanized apps contained the version number\n\nonly in their payloads, not in the body of the executable.\n\n\nTable 5. Malware versions found in samples\n\n\n**App name** **Package name** **SHA-1** **Version**\n```\n                                  52A508FEF60082E1E4EC\n\n```\n**System Update** `com.update.system.important` `22`\n```\n                                  E9109D2CEC1D407A0B92\n                                  A934FB482F61D85DDA5E\n\n```\n**[without app name]** `com.weather.services.manager` `26`\n```\n                                  52A7015F1699BF55B5A9\n                                  5F0213BA62B84221C962\n\n```\n**[without app name]** `com.studio.manager.app` `26`\n```\n                                  8F7D0A0CF87F27A45A28\n                                  60B1DA6905857073C4C4\n\n```\n**Kora442** `com.app.projectappkora` `27`\n```\n                                  6E7E964699D9C7A74EC7\n                                  568E62ABC0948691D672\n\n```\n**لغشلما** **قيبطت** `com.app.workapp` `29`\n```\n                                  36D9290D68DE34BD6C75\n                                  DB6B6326B772257FDDCB\n\n```\n**NortirChat** `cx.ring` `30`\n```\n                                  4BE7CF1A0CC0322387D8\n                                  16C8725362D1EBC8443C\n\n```\n**fL** **d** `com services android handler` `30`\n\n\n-----\n\n```\n                                  E71F1484B1E3ACB4C8E8\n\n```\n**prefLog.dex** `com.setting.manager.admin.handler` `31`\n```\n                                  525BA1F5F8822AB7238B\n\n```\n\n## IoCs\n\n\n[A comprehensive list of Indicators of Compromise (IoCs) and samples can be found in our GitHub repository.](https://github.com/eset/malware-ioc/tree/master/aridspy)\n\n\n### Files\n\n\n-----\n\n`797073511A15EB85C1E9` AridSpy trojanized\ncom.rebelvox.rebly.apk Android/Spy.AridSpy.A\n`D8584B26BAA3A0B14C9E` application.\n\n`5F0213BA62B84221C962` The first stage of\ncom.studio.manager.app.apk Android/Spy.AridSpy.A\n`8F7D0A0CF87F27A45A28` AridSpy.\n\n```\nA934FB482F61D85DDA5E\n52A7015F1699BF55B5A9\n\n```\n\ncom.weather.services. The first stage of\nAndroid/Spy.AridSpy.A\nmanager.apk AridSpy.\n\n\n`F49B00896C99EA030DCC` AridSpy trojanized\ncom.chat.lapiza.apk Android/Spy.AridSpy.A\n`A0808B87E414BBDE1549` application.\n\n`3485A0A51C6DAE251CDA` AridSpy trojanized\ncom.chat.lapiza.apk Android/Spy.AridSpy.A\n`D20B2F659B3815212162` application.\n\n`568E62ABC0948691D672` AridSpy trojanized\ncom.app.workapp.apk Android/Spy.AridSpy.A\n`36D9290D68DE34BD6C75` application.\n\n`DB6B6326B772257FDDCB` AridSpy trojanized\ncx.ring.apk Android/Spy.AridSpy.A\n`4BE7CF1A0CC0322387D8` application.\n\n`2158D88BCE6368FAC3FC` AridSpy trojanized\ncx.ring.apk Android/Spy.AridSpy.A\n`B7F3A508FE6B96B0CF8A` application.\n\n`B806B89B8C44F4674888` AridSpy trojanized\ncom.app.civilpal.apk Android/Spy.AridSpy.A\n`8C1F8C3F05DF2387DF19` application.\n\n`E71F1484B1E3ACB4C8E8` The second stage of\nprefLog.dex Android/Spy.AridSpy.A\n`525BA1F5F8822AB7238B` AridSpy.\n\n`16C8725362D1EBC8443C` The second stage of\nprefLog.dex Android/Spy.AridSpy.A\n`97C5AB79A1B6428FF87D` AridSpy.\n\n`A64D73C43B41F9A5B938` AridSpy trojanized\ncom.rebelvox.rebly.apk Android/Spy.AridSpy.A\n`AE8558759ADC474005C1` application.\n\n`C999ACE5325B7735255D` The first stage of\nupdate.apk Android/Spy.AridSpy.A\n`9EE2DD782179AE21A673` AridSpy.\n\n\n-----\n\n`CA155377EEE06E228F58` AridSpy.\n\n`8FF57DC85A7732E4A9D1` The first stage of\nupdate.apk Android/Spy.AridSpy.A\n`44F20B68E5BC9E581300` AridSpy.\n\n### Network\n\n**Hosting**\n**IP** **Domain** **First seen** **Details**\n**provider**\n\nLeaseWeb USA,\n`23.106.223[.]54` `gameservicesplay[.]com` 2023‑05‑25 C&C server.\nInc. Seattle\n\nLeaseWeb USA,\n`23.106.223[.]135` `crashstoreplayer[.]website` 2023‑08‑19 C&C server.\nInc. Seattle\n\nDistribution\n`23.254.130[.]97` `reblychat[.]com` Hostwinds LLC. 2023‑05‑01\nwebsite.\n```\n              proj3              1e67a.firebaseio[.]com\n              proj-95dae.firebaseio[.]com\n\n```\n```\n35.190.39[.]113\n\n```\n```\nproj-2bedf.firebaseio[.]com\nproj-54ca0.firebaseio[.]com\nproject445ebbd.firebaseio[.]com\n\n```\n\nGoogle LLC 2024‑02‑15 C&C server.\n\n\nDistribution\n`45.87.81[.]169` `www.palcivilreg[.]com` Hostinger NOC 2023‑06‑01\nwebsite.\n\n```\n64.44.102[.]198 analyticsandroid[.]com\n\n```\n\nNexeon\nTechnologies,\nInc.\n\n\n2023‑04‑01 C&C server.\n\n\nDistribution\n`66.29.141[.]173` `almoshell[.]website` Namecheap, Inc. 2023‑08‑20\nwebsite.\n\n\n-----\n\n`68.65.121[.]120` `elsilvercloud[.]com` Namecheap, Inc. 2021‑11‑13 C&C server.\n\n```\n68.65.122[.]94\n\n```\n```\nwww.lapizachat[.]com\nlapizachat[.]com\n\n```\n\nDistribution\nNamecheap, Inc. 2022‑01‑19\nwebsite.\n\n\n`162.0.224[.]52` `alwaysgoodidea[.]com` Namecheap, Inc. 2022‑09‑27 C&C server.\n\nDistribution\n`198.187.31[.]161` `nortirchats[.]com` Namecheap, Inc. 2022‑09‑23\nwebsite.\n\n`199.192.25[.]241` `ultraversion[.]com` Namecheap, Inc. 2021‑10‑12 C&C server.\n\n\n## MITRE ATT&CK techniques\n\n\n[This table was built using version 15 of the MITRE ATT&CK framework.](https://attack.mitre.org/resources/versions/)\n\n\n**Tactic** **ID** **Name** **Description**\n\nAridSpy has been distributed using dedicated\n**Initial Access** [T1660](https://attack.mitre.org/versions/v15/techniques/T1660/) Phishing\nwebsites impersonating legitimate services.\n\n\nBoot or Logon\n[T1398](https://attack.mitre.org/versions/v15/techniques/T1398/)\nInitialization Scripts\n\n\n**Persistence**\n\n\n[T1624.001](https://attack.mitre.org/versions/v15/techniques/T1624/001/)\n\n\nEvent Triggered\nExecution: Broadcast\nReceivers\n\n\nDownload New Code at\n[T1407](https://attack.mitre.org/versions/v15/techniques/T1407/)\nRuntime\n\n\nAridSpy receives the BOOT_COMPLETED broadcast\nintent to activate at device startup.\n\nAridSpy registers to receive\nthe NEW_OUTGOING_CALL, PHONE_STATE,\n```\nSMS_RECEIVED, SMS_DELIVER,\nBOOT_COMPLETED, USER_PRESENT,\nCONNECTIVITY_CHANGE,\nACTION_POWER_CONNECTED,\nACTION_POWER_DISCONNECTED,\nPACKAGE_ADDED,\n\n```\nand PACKAGE_CHANGE broadcast intents to\nactivate itself.\n\nAridSpy can download first- and second-stage\npayloads.\n\n\n-----\n\nObfuscated Files or\n[T1406](https://attack.mitre.org/versions/v15/techniques/T1406/)\nInformation\n\n\nAridSpy decrypts a downloaded payload with\nobfuscated code and strings.\n\n\nAridSpy can identify whether Facebook Messenger\n[T1418](https://attack.mitre.org/versions/v15/techniques/T1418/) Software Discovery\nand WhatsApp apps are installed on a device.\n\n\nAridSpy can identify, from a predefined list, what\nsecurity software is installed.\n\nAridSpy can list files and directories on external\nstorage.\n\nAridSpy can extract information about the device\nincluding device model, device ID, and common\nsystem information.\n\n\n[T1418.001](https://attack.mitre.org/versions/v15/techniques/T1418/001/)\n\n\nSoftware Discovery:\nSecurity Software\nDiscovery\n\n\n**Discovery**\n\n**Collection**\n\n\nFile and Directory\n[T1420](https://attack.mitre.org/versions/v15/techniques/T1420/)\nDiscovery\n\nSystem Information\n[T1426](https://attack.mitre.org/versions/v15/techniques/T1426/)\nDiscovery\n\n\n[T1517](https://attack.mitre.org/versions/v15/techniques/T1517/) Access Notifications AridSpy can collect messages from various apps.\n\n[T1429](https://attack.mitre.org/versions/v15/techniques/T1429/) Audio Capture AridSpy can record audio from the microphone.\n\n[T1414](https://attack.mitre.org/versions/v15/techniques/T1414/) Clipboard Data AridSpy can obtain clipboard contents.\n\n[T1430](https://attack.mitre.org/versions/v15/techniques/T1430) Location Tracking AridSpy tracks device location.\n\n\nSystem Network\n[T1422](https://attack.mitre.org/versions/v15/techniques/T1422) AridSpy extracts the IMEI number.\nConfiguration Discovery\n\n[T1512](https://attack.mitre.org/versions/v15/techniques/T1512/) Video Capture AridSpy can take photos.\n\n[T1532](https://attack.mitre.org/versions/v15/techniques/T1532/) Archive Collected Data AridSpy encrypts data before extraction.\n\n[T1533](https://attack.mitre.org/versions/v15/techniques/T1533/) Data from Local System AridSpy can exfiltrate files from a device.\n\n\nInput Capture:\n[T1417.001](https://attack.mitre.org/versions/v15/techniques/T1417/001/)\nKeylogging\n\n\nAridSpy can log all text visible and specifically log\nFacebook Messenger and WhatsApp chat\ncommunication.\n\n\n-----\n\nProtected User Data:\n[T1636.003](https://attack.mitre.org/versions/v15/techniques/T1636/003/) AridSpy can extract the device’s contact list.\nContact List\n\nProtected User Data: SMS\n[T1636.004](https://attack.mitre.org/versions/v15/techniques/T1636/004/) AridSpy can extract SMS messages.\nMessages\n\n**Command and** Web Service: One-Way\n[T1481.003](https://attack.mitre.org/versions/v15/techniques/T1481/003/) AridSpy uses Google’s Firebase server as a C&C.\n**Control** Communication\n\nExfiltration Over C2\n**Exfiltration** [T1646](https://attack.mitre.org/versions/v15/techniques/T1646/) AridSpy exfiltrates data using HTTPS.\nChannel\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        }
    ],
    "references": [
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2024/2024.06.13.Arid_Viper_poisons_Android_apps_with_AridSpy/arid-viper-poisons-android-apps-with-aridspy.pdf"
    ],
    "report_names": [
        "arid-viper-poisons-android-apps-with-aridspy"
    ],
    "threat_actors": [
        {
            "id": "9ff60d4d-153b-4ed5-a2f7-18a21d2fa05d",
            "created_at": "2022-10-25T16:07:23.539852Z",
            "updated_at": "2025-03-27T02:02:09.853285Z",
            "deleted_at": null,
            "main_name": "Desert Falcons",
            "aliases": [
                "APT-C-23",
                "ATK 66",
                "Arid Viper",
                "Operation Arid Viper",
                "Operation Bearded Barbie",
                "Operation Rebound",
                "TAG-63",
                "TAG-CT1",
                "Two-tailed Scorpion"
            ],
            "source_name": "ETDA:Desert Falcons",
            "tools": [
                "AridSpy",
                "Barb(ie) Downloader",
                "BarbWire",
                "Desert Scorpion",
                "FrozenCell",
                "GlanceLove",
                "GnatSpy",
                "KasperAgent",
                "Micropsia",
                "PyMICROPSIA",
                "SpyC23",
                "Viper RAT",
                "ViperRAT",
                "VolatileVenom",
                "WinkChat",
                "android.micropsia"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "b1979c55-037a-415f-b0a3-cab7933f5cd4",
            "created_at": "2024-04-24T02:00:49.561432Z",
            "updated_at": "2025-03-27T02:00:55.493381Z",
            "deleted_at": null,
            "main_name": "APT-C-23",
            "aliases": [
                "APT-C-23",
                "Arid Viper",
                "Desert Falcon",
                "TAG-63",
                "Grey Karkadann",
                "Big Bang APT",
                "Two-tailed Scorpion"
            ],
            "source_name": "MITRE:APT-C-23",
            "tools": [
                "Micropsia"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "77c08a4a-b3f9-43ee-9d84-04ba572b7564",
            "created_at": "2024-05-01T02:03:07.927023Z",
            "updated_at": "2025-03-27T02:05:17.248836Z",
            "deleted_at": null,
            "main_name": "ALUMINUM SHADYSIDE",
            "aliases": [
                "Arid Viper ",
                "Desert Falcon ",
                "APT-C-23 "
            ],
            "source_name": "Secureworks:ALUMINUM SHADYSIDE",
            "tools": [
                " SpyC23",
                "Micropsia"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "efe6ff9a-822d-41a6-90c3-45265cac696b",
            "created_at": "2024-05-01T02:03:07.920302Z",
            "updated_at": "2025-03-27T02:05:17.246342Z",
            "deleted_at": null,
            "main_name": "ALUMINUM SARATOGA",
            "aliases": [
                "Arid Viper",
                "Desert Falcon",
                "Extreme Jackal ",
                "Gaza CyberGang",
                "Gaza CyberGang",
                "Molerats ",
                "Operation DustySky ",
                "TA402",
                "APT-C-23"
            ],
            "source_name": "Secureworks:ALUMINUM SARATOGA",
            "tools": [
                " BrittleBush",
                " DarkComet",
                " LastConn",
                " Micropsia",
                " NimbleMamba",
                " PoisonIvy",
                " QuasarRAT",
                " XtremeRat",
                "BlackShades"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "929d794b-0e1d-4d10-93a6-29408a527cc2",
            "created_at": "2023-01-06T13:46:38.70844Z",
            "updated_at": "2025-03-27T02:00:02.897573Z",
            "deleted_at": null,
            "main_name": "AridViper",
            "aliases": [
                "Arid Viper",
                "APT-C-23",
                "Bearded Barbie",
                "Desert Falcon"
            ],
            "source_name": "MISPGALAXY:AridViper",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1721959541,
    "ts_updated_at": 1743041683,
    "ts_creation_date": 1721915931,
    "ts_modification_date": 1721915931,
    "files": {
        "pdf": "https://archive.orkl.eu/b9da9325aa7d7e8f3042b12b046c04aa2b4f7842.pdf",
        "text": "https://archive.orkl.eu/b9da9325aa7d7e8f3042b12b046c04aa2b4f7842.txt",
        "img": "https://archive.orkl.eu/b9da9325aa7d7e8f3042b12b046c04aa2b4f7842.jpg"
    }
}