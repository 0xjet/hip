{
    "id": "81039a85-43b8-4b35-bac2-c9f315705c1b",
    "created_at": "2023-01-12T15:05:40.713207Z",
    "updated_at": "2025-03-27T02:05:29.785761Z",
    "deleted_at": null,
    "sha1_hash": "3e01d79c344ae868446eae83cb0c475c5bf8c9d8",
    "title": "2021-04-27 - RedLine Stealer Masquerades as Telegram Installer",
    "authors": "",
    "file_creation_date": "2022-05-28T05:00:12Z",
    "file_modification_date": "2022-05-28T05:00:12Z",
    "file_size": 331471,
    "plain_text": "# RedLine Stealer Masquerades as Telegram Installer\n\n**[blog.minerva-labs.com/redline-stealer-masquerades-as-telegram-installer](https://blog.minerva-labs.com/redline-stealer-masquerades-as-telegram-installer)**\n\n## Minerva Labs Blog\n\nNews & Reports\n\n[Tweet](https://twitter.com/share)\n\n\n-----\n\nStealers are pieces of malicious code written with a hit and run mentality - their main purpose\nis to find anything of value on an infected device and exfiltrate it back to its operator. The\n[common infection method of these nefarious viruses is either as a second stage payload or](https://blog.minerva-labs.com/hancitor-malware?hsLang=en-us)\nby [masquerading as legitimate software. Redline Stealer is one such stealer which is](https://blog.minerva-labs.com/preventing-fake-software-installers-with-minerva-labs?hsLang=en-us)\ncommonly used by attackers to harvest credentials from unsuspecting users. The .Net based\nmalware has recently been disguised as an installer of the popular secure messaging app,\nTelegram. In this blog we will unpack RedLine Stealer and show the evasive techniques it\nuses to bypass security products.\n\n**The Unpacking Process:**\n\nLike Most .Net malware, the fake setup file is packed and highly obfuscated. Using Detect-ItEasy, no known packer is identified, which means the unpacking should be done manually.\n\nDetect-It-Easy result:\n\nAfter decompiling the malware, we can see that most of the variable and function names\nwere scrambled, making it harder to understand the code. In order to induce a truly\nmiserable experience for any reverse engineering effort, the packer developer also decided\nto introduce control flow flattening into the packer. Control flow flattening takes the normal\nprogram control flow and modifies it using numerous if/while statements.\n\nA mild example of the control flow obfuscation:\n\n\n-----\n\nPackers usually employ stenography or encryption in their arsenal, this sample successfully\nuses both. In its resources directory lies what looks like malformed image files, but actually\ncontain the malicious payload, which will be decoded and decrypted by a custom algorithm.\n\nThe deobfuscated image decoding function:\n\nAs can be seen in the graphic above, the payloads data is hidden inside the RGB values of\nthe image pixels. The first four pixels contain the size of meaningful data inside the image,\nand the others are the actual data.\n\nAfter decoding the image, the packer uses RC2 stream cipher to decipher the payload, a file\nnamed “Lightning.dll” is revealed and loaded into the memory. From the in-memory DLL file,\nan object named “GameCore.Core” is instantiated and in it a function named “Game”\n\n\n-----\n\nreceives yet another image file from the binary s resources directory together with a\nhardcoded key. The “Game” function decrypts the final payload and will later use process\ninjection to load the malware into the memory space of another process.\n\nThe RC2 decryption function (deobfuscated):\n\nThe code responsible for loading and calling the “Game” function:\n\nFinally, the actual payload is revealed, and to our luck, its entirely un-obfuscated, allowing us\nto see its C&C address in cleartext:\n\n[Minerva prevents RedLine Stealer with our Memory Injection prevention module, thus](https://minerva-labs.com/)\nprotecting the user’s sensitive data:\n\n**IOCs:**\n\n\n-----\n\n**Hashes:**\n\nD516FA60F75B21B424D2D8DEB6CCE51A6620A603AA2A69E42E59DEA1961F11B9\n(TelegramInstaller)\n\nd82ad08ebf2c6fac951aaa6d96bdb481aa4eab3cd725ea6358b39b1045789a25 (Unpacked\nRedLine Stealer)\n\n2ff5de07a6c72fdc54ed5fb40e6bd3726bd7e272384c892f8950c760cae65948 (Lightning.dll)\n\n**DNS Names:**\n\ndilendekal[.]xyz:80\n\n[« Previous Post](https://blog.minerva-labs.com/hancitor-malware?hsLang=en-us)\n[Next Post](https://blog.minerva-labs.com/rigging-a-windows-installation?hsLang=en-us) »\n\n### Want to see how Minerva blocks Redline Stealer and other Malware?\n Just book a quick demo\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-04-27 - RedLine Stealer Masquerades as Telegram Installer.pdf"
    ],
    "report_names": [
        "2021-04-27 - RedLine Stealer Masquerades as Telegram Installer.pdf"
    ],
    "threat_actors": [
        {
            "id": "9ff60d4d-153b-4ed5-a2f7-18a21d2fa05d",
            "created_at": "2022-10-25T16:07:23.539852Z",
            "updated_at": "2025-03-27T02:02:09.853285Z",
            "deleted_at": null,
            "main_name": "Desert Falcons",
            "aliases": [
                "APT-C-23",
                "ATK 66",
                "Arid Viper",
                "Operation Arid Viper",
                "Operation Bearded Barbie",
                "Operation Rebound",
                "TAG-63",
                "TAG-CT1",
                "Two-tailed Scorpion"
            ],
            "source_name": "ETDA:Desert Falcons",
            "tools": [
                "AridSpy",
                "Barb(ie) Downloader",
                "BarbWire",
                "Desert Scorpion",
                "FrozenCell",
                "GlanceLove",
                "GnatSpy",
                "KasperAgent",
                "Micropsia",
                "PyMICROPSIA",
                "SpyC23",
                "Viper RAT",
                "ViperRAT",
                "VolatileVenom",
                "WinkChat",
                "android.micropsia"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "929d794b-0e1d-4d10-93a6-29408a527cc2",
            "created_at": "2023-01-06T13:46:38.70844Z",
            "updated_at": "2025-03-27T02:00:02.897573Z",
            "deleted_at": null,
            "main_name": "AridViper",
            "aliases": [
                "Arid Viper",
                "APT-C-23",
                "Bearded Barbie",
                "Desert Falcon"
            ],
            "source_name": "MISPGALAXY:AridViper",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673535940,
    "ts_updated_at": 1743041129,
    "ts_creation_date": 1653714012,
    "ts_modification_date": 1653714012,
    "files": {
        "pdf": "https://archive.orkl.eu/3e01d79c344ae868446eae83cb0c475c5bf8c9d8.pdf",
        "text": "https://archive.orkl.eu/3e01d79c344ae868446eae83cb0c475c5bf8c9d8.txt",
        "img": "https://archive.orkl.eu/3e01d79c344ae868446eae83cb0c475c5bf8c9d8.jpg"
    }
}