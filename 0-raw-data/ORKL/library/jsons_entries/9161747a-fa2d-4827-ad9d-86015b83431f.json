{
    "id": "9161747a-fa2d-4827-ad9d-86015b83431f",
    "created_at": "2022-10-25T16:48:12.288795Z",
    "updated_at": "2025-03-27T02:10:54.346157Z",
    "deleted_at": null,
    "sha1_hash": "9d6b4577326ac39d5d3bdc410b55ed6fc43274c3",
    "title": "JSAC2020_en_1.1rc",
    "authors": "",
    "file_creation_date": "2020-01-14T06:10:30Z",
    "file_modification_date": "2020-01-14T06:10:30Z",
    "file_size": 6127990,
    "plain_text": "###### CiYi \"YCY\" Yu Malware Researcher Aragorn Tseng\n\n\n-----\n\n###### Malware Researcher!\n\n CiYi \"YCY\" Yu\n Aragorn Tseng\n\n Malware Analysis Malware analysis Campaign Tracking Incident response 1P 2P\n\n\n-----\n\n### AGENDA\n\n###### Adversary Profile: HUAPI ✚\n Malware Profile: DBGPRINT ✚\n Evolution of DBGPRINT ✚\n In-Depth Analysis of DBGPRINT ✚\n\n Detection Warfare ✚\n Remediation & Detection ✚\n\n\n-----\n\n##### Adversary Profile: HUAPI\n\nu\n###### Alias BlackTech\n\nu\n###### Since 2007\n\nu\n###### Malware:\n\nu\n###### TSCOOKIE\n\nu\n###### KIVARS\n\nu\n###### CAPGELD\n\nu\n###### DBGPRINT\n\n\n-----\n\n##### Malware Profile: DBGPRINT\n\nu\n###### Alias Waterbear\n\nu\n###### Since at least 2009\n\nu\n###### DLL export name “DbgPrint”\n\nu\n###### Acted as second stage\n\nu\n###### Advanced malware design\n\nu\n###### Adopt shellcode stager\n\nu\n###### Able to load the plugins\n\n\n-----\n\n##### Malware Profile: DBGPRINT\n\n\n###### Government Education\n\n\n###### Think Tank\n\n\n###### Finance Technology Healthcare\n\n\n-----\n\n#### Evolution of DBGPRINT\n\n\n-----\n\n##### Version Changes in the Wild\n\n###### 0.13 0.17 0.1.0\n\n\n###### 1\n\n\n###### 2010 2011 2012 2013 2014 2015 2016 2017 2018 2019 2020\n\n Discovery time in the wild\n b.0.1\n\n\n###### 0.14\n\n\n###### 0.1.n 0.2b\n\n\n\n###### • Listen port\n\n\n-----\n\n##### Access Payload\n\n\n###### EXE\n\n\n###### EXE\n\n\n###### EXE\n\n\n###### DLL\n\n\n###### DLL\n\n\n###### DLL\n Stager Payload Stager Payload\n Stager Payload Stager Payload\n\n Inside EXE Inside DLL Standalone payload Double DLL Sideloading\n\n\n###### Stager Payload\n\n\n###### Stager Payload\n\n\n-----\n\n##### RC4 Key of Payload\n\n\n###### mov al, byte ptr [ecx] mov dl, al shr dl, 3 shl al, 5 or dl, al mov byte ptr [ecx], dl inc ecx dec esi jnz short 100010CD\n\n\n###### C:\\Program Files\\NVIDIA Corporation\\Display\\ nvwss.ptn\\x00\n\n\n###### Miss You! printupg.PNF\n\n|01|03|FF|89|\n|---|---|---|---|\n|13|72|D1|0A|\n|40|C0|21|BB|\n\n\n###### XOR / Shift Random 16 bytes File path String + File name\n\n\n-----\n\n#### In-Depth Analysis of DBGPRINT\n\n\n-----\n\n##### Execution Procedure\n\n\n###### DBGPRINT Controller\n\n ❶ Ask for DLL implant ❷ Wait for connection\n\n\n###### Payload\n\n\n-----\n\n##### Inside DBGPRINT Stager\n\n###### Check PEB!IsDebugged Test connection\n\n Relocate\n Generate session keys\n function table\n\n DBGPRINT Stager\n\n\n###### In some version\n\n Fail Drop connection\n\n\n-----\n\n##### Inside DBGPRINT Stager\n\n###### DBGPRINT Controller DBGPRINT Stager\n\n\n-----\n\n##### Inside DBGPRINT Stager\n\n###### DBGPRINT Controller DBGPRINT Stager\n\n\n-----\n\n##### Inside DBGPRINT Stager\n\n###### DBGPRINT Controller DBGPRINT Stager\n\n\n-----\n\n##### Inside DBGPRINT Stager\n\n###### DBGPRINT Controller DBGPRINT Stager\n\n\n-----\n\n##### Inside DBGPRINT Stager\n\n###### DBGPRINT Controller DBGPRINT Stager\n\n|Col1|Server challenge|\n|---|---|\n||58 88 dc e1 84 f7|\n|18 b2 50 8f 04 40 19 eb 47 a1||\n\n\n-----\n\n##### Inside DBGPRINT Stager\n\n###### DBGPRINT Controller DBGPRINT Stager\n\n\n-----\n\n##### Inside DBGPRINT Stager\n\n###### DBGPRINT Controller DBGPRINT Stager\n\n\n-----\n\n##### Inside DBGPRINT Stager\n\n###### DBGPRINT Controller DBGPRINT Stager\n\n\n-----\n\n##### Inside DBGPRINT Stager\n\n###### DBGPRINT Controller DBGPRINT Stager\n\n\n-----\n\n##### DBGPRINT Implant\n\n\n###### u File transfer / management\n\n|Command code|Capability|\n|---|---|\n|2|Enumerate disk drives|\n|3|List files|\n|4|Upload file to C2 server|\n|5|Download file from C2 server|\n|6|Rename file|\n|7|Create folder|\n|8|Delete file|\n|10|Execute file|\n|11|Move file|\n|12|NtSetInformationFile|\n\n\n-----\n\n##### DBGPRINT Implant\n\n###### u Windows management / Screenshot\n\n|Command code|Capability|\n|---|---|\n|807|Enumerate Windows|\n|808|Hide Windows|\n|809|Show Windows|\n|810|Close Windows|\n|811|Minimize Windows|\n|812|Maximize Windows|\n|814|Screenshot|\n|815|Set screenshot event signaled|\n\n\n-----\n\n##### DBGPRINT Implant\n\n###### u Remote desktop connection\n\n u Process / Network connection / Service management\n\n|Command code|Capability|\n|---|---|\n|816|Remote desktop|\n|817|Enumerate process|\n|818|Terminate process|\n|820|List network connection status|\n|821|Abort a network connection|\n|822|Enumerate services|\n|827|Manipulate service|\n\n\n-----\n\n##### DBGPRINT Implant\n\n###### u Remote shell / Registry management\n\n|Command code|Capability|\n|---|---|\n|1006|Start remote shell|\n|1007|Exit remote shell|\n|1008|Obtain remote shell PID|\n|2011|Enumerate registry|\n|2013|Create registry key|\n|2014|Set registry key|\n|2015|Delete registry key|\n|2016|Delete registry value|\n\n\n-----\n\n#### Detection Warfare\n\n\n-----\n\n##### Eliminate Patterns\n\n\n###### 1213141516...... èê..0.1......... ....Mutex....... ....login.narlla b.com........... ................ ................ ................ ................ ................ ............P.». ................ abcdefghijklmno.\n ./e.Oó{-cÓF5Ç².ä\n\n\n###### F.P...M...~...H1 ....b.0.1....... ....M........... ................ ................ ................ ................ ................ ................ ................ ................ ................ ........abcdefgh ijklmno../e.O.{\n\n###### }8ºýáÈÒß¶î3ù.¿R– ¸...0.24........ .... ........... ....ÎÏÑÍÏÑÎÎÈÑÎÎ ÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿ ÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿ ÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿ ÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿ ÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿ ÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿ ÿÿÿÿÿÿÿÿÿÿÿÿ©a.. ................ ................ ........q.ßä®;©ò Õ=uÌÓ.Wrê„.|žÚ„.\n Space (0x20)\n\n\n###### Mutex\n\n\n###### M\n\n\n-----\n\n##### Eliminate Patterns\n\n\n###### F.P...M...~...H1 ....b.0.1....... ....M........... ................ ................ ................ ................ ................ ................ ................ ................ ................ ........abcdefgh\n ijklmno../e.O�{- cF5...........V. Listen port ....%hM]........\n\n\n###### 1213141516...... è...0.1......... ....Mutex....... ....usr.narllab. com............. ................ ................ ................ ................ ................ ............».P. ................ abcdefghijklmno. ./e.Oó{-cÓF5Ç².ä\n\n\n###### ´Þ‹·CV•Ô©.²´w;Ôó\n ¸...0.17........ .... ........... ....ÎÏÑÇÑÉÑÌÍÿÿÿ ÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿ ÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿ ÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿ ÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿ ÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿ ÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿ ÿÿÿÿÿÿÿÿÿÿÿÿP... ................ ................ ........¸ñî®.¥îù\n\n\n###### Plain text\n\n\n###### XOR with 0xff\n\n\n-----\n\n##### x64 Version\n\n\n-----\n\n###### y g\n\nH.\\$.H.l$.H.t$ WATAUAVAWH..0.....XH..!.....H......H......QPH1......XI. ....!....P...ko....I_....GqI..@.U...#b7.;...-K(4q..)..%..\"......... .Z\n.u...I..C...M).L..PH..ATY.H1..........%h...X.(.eH.`.......PA\\A..$=.... ..O. C.U:<w....{.a.....N{.C...qgB.._.z......q....-N.a.b....s.7..&..s.#\nt.u..I......I....XYH..H...H...u...x...H..H........E1.E1.H....N........ cO.31c.d.~......[w\"S.-......V..`P...U..z....._#..VF.....U.`..&.A-/.}..\nH..(...H........E1.E1.H......|......E1.L......L..h...1.H......H.D$PH.. ......\"90...U..O.a1miH.Yr0E.4......Y.0=!...).!..O8.Hd..Y......mq......\nvH.........(...I..H........1.9+v3L.L$PL..(...A.M.L........I..$H..tY..I j..v>...z..........gA0%...g@'.3..|'.|...&......qk...qy1.q..8l...(77\"l.\n...I...A..;+r...H......r..q...H....H....p...H..H..I..H........A..H..H. .}.......d.X.7tF....]...,....l..........?4-.....}.+G+'........d. .....\n...P...H....h...H.\\$XH.l$`H.t$hH..0A_A^A]A\\_.H.\\$.WH.. 3.H..H..H;.t<D. ...f}....t.q.D...N.....Y.a-.........q...6......m.K..W.[{ygZ.<).y......\nC.H.L$@.D$8..D$9..D$:..D$;........D.8H..0D.?.D.?0D..H...|.H.\\$0H.. _.H 8L...N4dx......cc...........^..Z{..3.\".a.u.|D..eK..,....@..........p..\n.\\$.UVWH..@D......H......H......H........H........D......H......H..... .m.[.......kZ.|.<1.._W.Z{.)..kt.t.O.Y_.Z{.).....<1..I..Z{.).qkt.t.y...\n.......u.H........H...H.........D......H..8...H........H..H....8...D.. C.zH....y...I....Z3.l....]3.jB......./.\".5.0.C.|...../.\".tt.y.Y..Z{.).\n....H..8...H..................D......H..@...H........L.L$`L.D$hH..H... .kt.t.!{......).....<13..s[[{H..V.u.<y=....Z3.m.F.u.<};.....?l.gZ.<)..\n.@...D......H..@...H..............A...D......H......H........D.D$`H.T$ !.......z..j<).q.C.._...].ykt........Z?.%..jt....B......5..jt..u.#.|.~\nhH........D......H......H..H........H........D.D$`H.L$h3.......D...... ..)...l.<1..I3.Z{.)..kt.t.y.E/+..I./.......C.._._(...N....!.......j..j\nH.. ...H........A.....H..H.... ...D......H.. ...H..H........H..tv3.A.. <)...C.._......j5.41.C.|....]..kt.x.1..........j<).y=.1`|[{H..<....p.C\n...H........D......H..0...H......L._.H.G.H.L$(H..L.\\$ H.D$0H.|$8...... ......]..ht.x.1..........j</...C..Y.o./h.\"........]._h...ND..M.{1`|[{H\nL.L$ L..H..H....0...D......H..0...H........3.A.....H....8...H.L$h3.A.. ...NT......._......j0)...C.._.KI./...]...C.....H\"/.\".i...A....7l...+..\n.....8...H........H........H.\\$p.....H..@_^].@SH.. H..H.........H..D.. .1..Y..Z{.)...t.<1....C.yH.gZ6P..0.C..W.;..r.@SH.. H..H.........H..D..\n....H..p...H........L..I..A..p...H.C.H.K.3.A.......8...L.[.H..A....... ....H..p...H........L..I..A..p...H.C.H.K.3.A.......8...L.[.H..A.......\n....H.. [.H.\\$.H.l$.H.t$.WATAUH..p...D......H..X...H......H..3.......D ....H.. [...m.K.~.~k.+[.r#.hp..O..^{H..P.u.<y=....Z3..'.jt.....1d|[{H.\n.g.L..$P...A..H....X...D......H..X...H........D.G.H.T$@E3.H...........Only the wait-for-connection function is left..z8/...A......)...,.<1..M..Z{.)..kt.t.}.]_.Z{./h.\"...q.p.._...Z-.j.Z.\nu.3..F...D......H......H........H.T$@H........D......H......H......... D.p...Y{H..Rnv.<y=.V..Z3.i.B.u.<y;.......1..jt....A......./.\".i...B..T\n|$D&r...l$DH.T$HE3.D.E.H...........t.D......H..`...H.........U.L..$P.. &_..]ge...u......H.....<)..%............J=1..Ed.[{H......=1.......l.-.\n.H.L$E..`...D......H..`...H........A.MZ..fD9\\$E..A........H.L$ M...... j</p...]..Z{.).9kt.t.%#......].ykt.}.......B..j..5]....F.\\........U.2c\n\n..........k..+.@...@...H.T.@......D......H..X...H........L..$`...H.L$ .4._....,...........U.....n4]...C.._..I./....=1..E<+..I./....\\2.C.z.~[\nA....X...D......H..X...H..........h...D......H..P.....H..i.<.........H .)...,.<1..M..Z{.)..kt.t.}.]_.Z{.1G.jt...VB......./...........P.....j<\n.T$@A.....H....P...D......H..P...H........H.T$FH.L$0A.....M..D.d$@D.l$ /h...v..Z{.)...$.<1..M..Z{.)..kt.t.}.]_.Z{./{.,</p...s..Z{.).....|u>/.\n\n\n###### Before self-modifying After self-modifying\n\n\n-----\n\n##### Double DLL Sideloading\n\n###### (White) Benign EXE (Gray) Malicious DLL (Black) Malicious DLL\n\n\n-----\n\n##### Anti ”SecurityProduct”\n\n\n###### Malicious DLL\n\n\n###### Actor\n\n\n###### DBGPRINT Payload 2\n\n\n-----\n\n# Questions?\n\n\n###### ycy@teamt5.org aragorn@teamt5.org\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "bf5be533-fa31-4590-ae37-5761c97ffa34",
            "created_at": "2022-10-25T16:13:58.389257Z",
            "updated_at": "2022-10-25T16:13:58.389257Z",
            "deleted_at": null,
            "name": "Malpedia",
            "url": "https://malpedia.caad.fkie.fraunhofer.de",
            "description": "Malpedia is a free service offered by Fraunhofer FKIE",
            "reports": null
        }
    ],
    "references": [
        "https://jsac.jpcert.or.jp/archive/2020/pdf/JSAC2020_2_ycy-aragorn_en.pdf"
    ],
    "report_names": [
        "JSAC2020_2_ycy-aragorn_en.pdf"
    ],
    "threat_actors": [
        {
            "id": "2646f776-792a-4498-967b-ec0d3498fdf1",
            "created_at": "2022-10-25T15:50:23.475784Z",
            "updated_at": "2025-03-27T02:00:55.479958Z",
            "deleted_at": null,
            "main_name": "BlackTech",
            "aliases": [
                "BlackTech",
                "Palmerworm"
            ],
            "source_name": "MITRE:BlackTech",
            "tools": [
                "Kivars",
                "PsExec",
                "TSCookie",
                "Flagpro",
                "Waterbear"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "d3a7123c-f519-49a0-a234-de24a1ef052a",
            "created_at": "2022-10-25T16:47:55.545211Z",
            "updated_at": "2025-03-27T02:05:17.254744Z",
            "deleted_at": null,
            "main_name": "BRONZE CANAL",
            "aliases": [
                "CTG-6177 ",
                "Circuit Panda ",
                "Palmerworm ",
                "Shrouded Crossbow ",
                "BlackTech"
            ],
            "source_name": "Secureworks:BRONZE CANAL",
            "tools": [
                " DRIGO",
                " Flagpro",
                " Gh0stTimes",
                " PLEAD",
                " Spiderpig",
                " Waterbear",
                "Bifrose"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "75024aad-424b-449a-b286-352fe9226bcb",
            "created_at": "2023-01-06T13:46:38.962724Z",
            "updated_at": "2025-03-27T02:00:02.964002Z",
            "deleted_at": null,
            "main_name": "BlackTech",
            "aliases": [
                "CIRCUIT PANDA",
                "Temp.Overboard",
                "G0098",
                "Red Djinn",
                "HUAPI",
                "Palmerworm",
                "T-APT-03",
                "Manga Taurus",
                "Earth Hundun"
            ],
            "source_name": "MISPGALAXY:BlackTech",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "f8dddd06-da24-4184-9e24-4c22bdd1cbbf",
            "created_at": "2023-01-06T13:46:38.626906Z",
            "updated_at": "2025-03-27T02:00:02.877001Z",
            "deleted_at": null,
            "main_name": "Tick",
            "aliases": [
                "Stalker Taurus",
                "PLA Unit 61419",
                "Nian",
                "BRONZE BUTLER",
                "REDBALDKNIGHT",
                "STALKER PANDA",
                "G0060"
            ],
            "source_name": "MISPGALAXY:Tick",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "efa7c047-b61c-4598-96d5-e00d01dec96b",
            "created_at": "2022-10-25T16:07:23.404442Z",
            "updated_at": "2025-03-27T02:02:09.781478Z",
            "deleted_at": null,
            "main_name": "BlackTech",
            "aliases": [
                "BlackTech",
                "Circuit Panda",
                "Earth Hundun",
                "Manga Taurus",
                "Operation PLEAD",
                "Operation Shrouded Crossbow",
                "Operation Waterbear",
                "Palmerworm",
                "Radio Panda",
                "Red Djinn",
                "T-APT-03",
                "TEMP.Overboard"
            ],
            "source_name": "ETDA:BlackTech",
            "tools": [
                "BIFROST",
                "BUSYICE",
                "BendyBear",
                "Bluether",
                "CAPGELD",
                "DRIGO",
                "Deuterbear",
                "Flagpro",
                "GOODTIMES",
                "Gh0stTimes",
                "IconDown",
                "KIVARS",
                "LOLBAS",
                "LOLBins",
                "Linopid",
                "Living off the Land",
                "TSCookie",
                "Waterbear",
                "XBOW",
                "elf.bifrose"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "d4e7cd9a-2290-4f89-a645-85b9a46d004b",
            "created_at": "2022-10-25T16:07:23.419513Z",
            "updated_at": "2025-03-27T02:02:09.790389Z",
            "deleted_at": null,
            "main_name": "Bronze Butler",
            "aliases": [
                "Bronze Butler",
                "CTG-2006",
                "Operation ENDTRADE",
                "RedBaldNight",
                "Stalker Panda",
                "Stalker Taurus",
                "TEMP.Tick",
                "Tick"
            ],
            "source_name": "ETDA:Bronze Butler",
            "tools": [
                "8.t Dropper",
                "8.t RTF exploit builder",
                "8t_dropper",
                "9002 RAT",
                "AngryRebel",
                "Blogspot",
                "Daserf",
                "Datper",
                "Elirks",
                "Farfli",
                "Gh0st RAT",
                "Ghost RAT",
                "HOMEUNIX",
                "HidraQ",
                "HomamDownloader",
                "Homux",
                "Hydraq",
                "Lilith",
                "Lilith RAT",
                "McRAT",
                "MdmBot",
                "Mimikatz",
                "Minzen",
                "Moudour",
                "Muirim",
                "Mydoor",
                "Nioupale",
                "PCRat",
                "POISONPLUG.SHADOW",
                "Roarur",
                "RoyalRoad",
                "ShadowPad Winnti",
                "ShadowWali",
                "ShadowWalker",
                "SymonLoader",
                "WCE",
                "Wali",
                "Windows Credential Editor",
                "Windows Credentials Editor",
                "XShellGhost",
                "XXMM",
                "gsecdump",
                "rarstar"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "bf0489c5-1c07-41e6-91c9-855ad96ccc6a",
            "created_at": "2022-10-25T16:47:55.541639Z",
            "updated_at": "2025-03-27T02:05:17.253496Z",
            "deleted_at": null,
            "main_name": "BRONZE BUTLER",
            "aliases": [
                "Daserf",
                "Stalker Panda ",
                "Tick ",
                "CTG-2006 "
            ],
            "source_name": "Secureworks:BRONZE BUTLER",
            "tools": [
                " DGet",
                " Daserf",
                " Datper",
                " Gofarer",
                " MSGet",
                " Mimikatz",
                " RarStar",
                " Screen Capture Tool",
                " ShadowPad",
                " T-SMB",
                " WinRAR",
                " Windows Credential Editor",
                " gsecdump",
                " xmm downloader",
                " xxmm",
                "ABK"
            ],
            "source_id": "Secureworks",
            "reports": null
        }
    ],
    "ts_created_at": 1666716492,
    "ts_updated_at": 1743041454,
    "ts_creation_date": 1578982230,
    "ts_modification_date": 1578982230,
    "files": {
        "pdf": "https://archive.orkl.eu/9d6b4577326ac39d5d3bdc410b55ed6fc43274c3.pdf",
        "text": "https://archive.orkl.eu/9d6b4577326ac39d5d3bdc410b55ed6fc43274c3.txt",
        "img": "https://archive.orkl.eu/9d6b4577326ac39d5d3bdc410b55ed6fc43274c3.jpg"
    }
}