{
    "id": "162c0f10-e3f2-477e-b19c-5cdabc1e4dbf",
    "created_at": "2023-01-12T15:00:57.854747Z",
    "updated_at": "2025-03-27T02:09:17.850506Z",
    "deleted_at": null,
    "sha1_hash": "375cea229fed25d9690a4e36de815b37a36843a2",
    "title": "2021-05-03 - New Variant of Buer Loader Written in Rust",
    "authors": "",
    "file_creation_date": "2022-05-28T15:57:07Z",
    "file_modification_date": "2022-05-28T15:57:07Z",
    "file_size": 1938090,
    "plain_text": "# New Variant of Buer Loader Written in Rust\n\n**proofpoint.com/us/blog/threat-insight/new-variant-buer-loader-written-rust**\n\n\nApril 30, 2021\n\n\n-----\n\n[Blog](https://www.proofpoint.com/us/blog)\n[Threat Insight](https://www.proofpoint.com/us/blog/threat-insight)\nNew Variant of Buer Loader Written in Rust\n\nMay 03, 2021 Kelsey Merriman, Bryan Campbell, Selena Larson, and the Proofpoint Threat Research Team\n\n\n-----\n\n**O e** **e**\n\nProofpoint researchers identified a new variant of the Buer malware loader distributed via emails masquerading as shipping notices in early\nApril. [Buer is a downloader sold on underground marketplaces that is used as a foothold in compromised networks to distribute other malware,](https://malpedia.caad.fkie.fraunhofer.de/details/win.buer)\n[including ransomware. Proofpoint first](https://www.cert.ssi.gouv.fr/uploads/CERTFR-2021-CTI-006.pdf) [observed Buer in 2019.](https://www.proofpoint.com/us/threat-insight/post/buer-new-loader-emerges-underground-marketplace)\n\nIn the associated campaigns, the emails purported to be from DHL Support. They contained a link to a malicious Microsoft Word or Excel\ndocument download that used macros to drop the new malware variant. Proofpoint is calling this new variant RustyBuer. The emails impacted\nover 200 organizations across more than 50 verticals. The new strain is completely rewritten in a coding language called Rust, a departure\nfrom the previous C programming language. It is unusual to see common malware written in a completely different way.\n\n**Key Findings**\n\nThe new Buer variant is written in Rust, an efficient and easy-to-use programming language that is becoming increasingly popular.\nProofpoint is calling this variant RustyBuer.\nRewriting the malware in Rust enables the threat actor to better evade existing Buer detection capabilities.\nProofpoint observed RustyBuer campaigns delivering Cobalt Strike Beacon as a second-stage payload in some campaigns.\nResearchers assess some threat actors may be establishing a foothold with the Buer loader to then sell access to other threat actors.\nThis is known as “access-as-a-service.”\n\n**Campaign Details**\n\nProofpoint analysts observed a series of malicious campaigns that delivered the Buer malware loader. The campaigns generally used DHLthemed phishing emails to distribute malicious Word or Excel documents. While sharing similar email lure themes, the campaigns distributed\ntwo distinct variants of the Buer malware: one was written in C while the other was rewritten in the Rust programming language. Proofpoint\ndubbed this variant RustyBuer. The campaigns also used different lure techniques, with RustyBuer attachments containing more detailed\ncontent to better engage the recipient.\n\nThe rewritten malware, and the use of newer lures attempting to appear more legitimate, suggest threat actors leveraging RustyBuer are\nevolving techniques in multiple ways to both evade detection and attempt to increase successful click rates.\n\n\n-----\n\nFigure 1: Emails masquerading as DHL shipping themes used to distribute RustyBuer and Buer loaders.\n\n\n-----\n\nFigure 2: Malicious Excel attachment distributing RustyBuer containing multiple security software brand logos in an attempt to add legitimacy\nto the document.\n\nRustyBuer was embedded directly into the document macro and required user interaction to initiate the infection. This macro leveraged an\n[Application Bypass (Windows Shell DLL via LOLBAS) to evade detection from endpoint security mechanisms.](https://lolbas-project.github.io/lolbas/Libraries/Shell32/)\n\n**Example Script execution:**\n\nrundll32.exe shell32.dll,ShellExec_RunDLL C:\\ProgramData\\OfficeSignCheck.exe\n\nOnce RustyBuer is dropped, it establishes persistence by using a shortcut (.LNK) file which runs at startup.\n\nAll the identified campaigns used consistent naming conventions following the inclusion of “Office” in the dropped executable. Both the Rust\nand C versions of the malware followed this same pattern including:\n\n1. OfficeVerifySign.exe (3abed86f46c8be754239f8c878f035efaae91c33b8eb8818c5bbed98c4d9a3ac)\n2. Office_WorkForWestBank.exe (423790a4a722f3549d1dfc1026fa627d829c6dd8c26546d45f2ca4b6d6626acb)\n3. OfficeReleaseFix.exe (b3d510ef04275ca8e698e5b3cbb0ece3949ef9252f0cdc839e9ee347409a2209)\n4. OfficeConsultPlugin.exe (sha256:b3d510ef04275ca8e698e5b3cbb0ece3949ef9252f0cdc839e9ee347409a2209)\n\nProofpoint researchers observed RustyBuer distributing Cobalt Strike Beacon as a second-stage payload in some instances, like previous\nBuer campaigns. Cobalt Strike is a legitimate security tool used by penetration testers to emulate adversary activity in a network that is\nbecoming increasingly popular as a tool for threat actors.\n\nHowever, not all identified campaigns contained a second-stage payload. Researchers assess this may be due to threat actors in some\nspecific instances operating as access-as-a-service providers. These threat actors may be attempting to establish initial access in victim\n[environments to then sell their access to other threat actors in underground marketplaces. Other security firms have documented this behavior](https://news.sophos.com/en-us/2020/10/28/hacks-for-sale-inside-the-buer-loader-malware-as-a-service/)\nfrom threat actors using Buer loader previously.\n\n**Malware Analysis**\n\nProofpoint classified the new variant of Buer (RustyBuer) as a rewritten version in Rust based on present anti-analysis features, strings, and\nencoding and format of the command and control (C2) requests.\n\nIt is unclear why the threat actors took the time and effort to rewrite the malware in a new programming language, however Proofpoint\nresearchers identify two likely reasons:\n\n1. Rust is an increasingly popular programming language that is more efficient and has a broader feature set than C. (Microsoft, for\n\nexample, is [increasingly using it in its products and joined the Rust Foundation in February 2021.)](https://www.zdnet.com/article/microsoft-why-we-used-programming-language-rust-over-go-for-webassembly-on-kubernetes-app/)\n2. Rewriting the malware in Rust can enable the threat actor to evade existing Buer detections that are based on features of the malware\n\nwritten in C. The malware authors have programmed it in a way that it should maintain compatibility with existing Buer backend C2\nservers and panels.\n\n\n-----\n\nFigure 3: Example of select Rust dependencies\n\nThe following is a detailed analysis of the new variant.\n\nAnti-analysis features\n\nChecks for virtual machines (Figure 7)\nChecks locale to make sure the malware is not running in specific countries (Figure 8). These countries appear to be a part of the\nCommonwealth of Independent States (CIS).\n\nFigure 4: Virtual machine checks\n\n\n-----\n\ngu e 5 oca e c ec\n\n**Command and Control**\n\nThe C2 requests are nearly identical to the requests used in the latest version of Buer. The C2 functions are handled via HTTP(S) POST\nrequests. The initial POST request will be sent with POST data delimitated by the \"&\" and \"=\" characters. The POST request contains both\npseudorandom characters and encrypted information about the compromised system. An example command beacon can be seen in Figure 6:\n\nFigure 6: RustyBuer initial POST request\n\n\n-----\n\nFigure 7: Buer Loader initial POST request\n\nAn example of the plaintext parameter from Figure 8 with the pseudorandom characters removed is:\n\nYv3FHY+KQgL5YKs58+uRvGVZT8IS82xY+eij8SW/OhZd5Kk70Oryj8G4C5NB341+u9Xk8FFWvgdHoxrX68ZwZdrWO18fPzUeMJZvDfXcWKo0Wa\n\nThese request parameters are encrypted. They can be decrypted by:\n\n1. Base64 decoding\n2. Hex decoding\n3. RC4 decryption (the key used in the analyzed samples was “kpM5WOtfo”)\n\nThe decrypted plaintext parameter from Figure 6 is:\n\n299bc0beffe830d0871f8f6d7cadb40117208ea59f59cadd08b220b903f4e31c|e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b78\n7 Ultimate|x64|4|Admin|[Computer Name]|133/238|[AD Domain]|[User Name]|1\n\nIt contains pipe-delimited data consisting of:\n\n\n-----\n\not (S 56 e d gest o a ous syste pa a ete s suc as a d a e p o e GU a d a e, co pute a e, o u e se a\nnumber, and CPUID)\nAn SHA-256 hash of its own executable image\nWindows version\nArchitecture type\nNumber of processors\nUser privileges\nComputer name\nSpace used / total (suspected)\nAD Domain\nUser name\n\nThe response beacon can be decrypted similarly to the request parameter above, except that the hex-encoded bytes are separated by dash\ncharacters. As with Buer, the JSON object returned in the beacon response contains various options on how to download and execute a\npayload:\n\ntype - there are two types:\noptions - specifies options for the payload to download:\n\nHash - only applicable to “update” type to determine whether a new update is available\nx64 - whether the payload is 64-bit\nFileType - not used in analyzed samples\nAssemblyType - not used in analyzed samples\nAccessToken - used to download the payload\nExternal - indicates whether the payload is downloaded from the C&C or an external URL\nmethod - method of execution\nparameters - parameters to pass on the command line\npathToDrop - not used in analyzed samples\nautorun - indicates whether to setup Registry RunOnce persistence for the payload\nmodules\ntimeout - not used in analyzed samples\n\n**Conclusion**\n\nDespite existing since 2019, the new variant of Buer loader malware suggests threat actors continue to modify their payloads in a likely attempt\nto evade detection. When paired with the attempts by threat actors leveraging RustyBuer to further legitimize their lures, it is possible the\nattack chain may be more effective in obtaining access and persistence. RustyBuer and the original Buer loader have been observed as a firststage loader for additional payloads including Cobalt Strike and multiple ransomware strains, as well as possibly providing victim access to\nother threat actors in the underground marketplace. Proofpoint anticipates this activity will continue. Based on the frequency of RustyBuer\ncampaigns observed by Proofpoint, researchers anticipate we will continue to see the new variant in the future.\n\n**Indicators of Compromise (IOCs)**\n\n**IOC** **IOC Type** **Description**\n\nSerevalutinoffice[.]com Domain C&C (RustyBuer)\n\norderverification-api[.]com Domain C&C (RustyBuer)\n\nGerstaonycostumers[.]com Domain C&C (RustyBuer)\n\nauthcert-ca[.]com Domain C&C (RustyBuer)\n\ndocumentssign-api[.]com Domain C&C (RustyBuer)\n\ndocusigner-api[.]com Domain C&C (RustyBuer)\n\nMiyfandecompany[.]com URL C&C (RustyBuer)\n\nhttps://cembank-api[.]com URL C&C (RustyBuer)\n\nhttp://213.252.244[.]114/ayhtvcgcfcfrgcdxdxdrcrhj Payload Cobalt Strike Payload\n\n\n-----\n\n213.252.244[.]114 IP Cobalt Strike C&C\n\nhttps://techlog[.]xyz/page.icore URL Buer Payload\n\nRussell@simpleweb-online.co[.]uk Email Sender\n\nHernandez@ubstreasury[.]biz Email Sender\n\nFoster@simpleweb-online.co[.]uk Email Sender\n\nPatterson@ubstreasury[.]biz Email Sender\n\nCampbell@rockyourstay[.]net Email Sender\n\nHenderson@fossilqwanderer[.]org Email Sender\n\nPowell@onlinefundraisingtoday[.]org Email Sender\n\nEvans@onlinefundraisingtoday[.]org Email Sender\n\nBrooks@fossilqwanderer[.]org Email Sender\n\nEdwards@sun988info[.]com Email Sender\n\nA061180b16f89099da6d34c5a3976968c19a3977c84ce0711ddfef6f7c355cac SHA256 2021-04-12 Sample\n\n3abed86f46c8be754239f8c878f035efaae91c33b8eb8818c5bbed98c4d9a3ac SHA256 2021-04-19 Sample\n\n**ET Signatures**\n\n2848365 - RustyBuer Checkin\n\n_[Is your organization protected from Malware threats? Learn about Malware Prevention.](https://www.proofpoint.com/us/threat-reference/malware)_\n\nSubscribe to the Proofpoint Blog\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-05-03 - New Variant of Buer Loader Written in Rust.pdf"
    ],
    "report_names": [
        "2021-05-03 - New Variant of Buer Loader Written in Rust.pdf"
    ],
    "threat_actors": [
        {
            "id": "610a7295-3139-4f34-8cec-b3da40add480",
            "created_at": "2023-01-06T13:46:38.608142Z",
            "updated_at": "2025-03-27T02:00:02.87217Z",
            "deleted_at": null,
            "main_name": "Cobalt",
            "aliases": [
                "Cobalt Gang",
                "GOLD KINGSWOOD",
                "COBALT SPIDER",
                "G0080",
                "Mule Libra",
                "Cobalt Group"
            ],
            "source_name": "MISPGALAXY:Cobalt",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673535657,
    "ts_updated_at": 1743041357,
    "ts_creation_date": 1653753427,
    "ts_modification_date": 1653753427,
    "files": {
        "pdf": "https://archive.orkl.eu/375cea229fed25d9690a4e36de815b37a36843a2.pdf",
        "text": "https://archive.orkl.eu/375cea229fed25d9690a4e36de815b37a36843a2.txt",
        "img": "https://archive.orkl.eu/375cea229fed25d9690a4e36de815b37a36843a2.jpg"
    }
}