{
    "id": "12b1f7c8-03d3-4bc2-ada1-ea590e3404b9",
    "created_at": "2023-01-12T15:08:45.77011Z",
    "updated_at": "2025-03-27T02:13:09.669508Z",
    "deleted_at": null,
    "sha1_hash": "0b86e42f923c615ead1f99cc6f18bf4e71baadf8",
    "title": "2018-11-05 - Inception Attackers Target Europe with Year-old Office Vulnerability",
    "authors": "",
    "file_creation_date": "2022-09-01T10:19:44Z",
    "file_modification_date": "2022-09-01T10:19:44Z",
    "file_size": 359571,
    "plain_text": "# Inception Attackers Target Europe with Year-old Office Vulnerability\n\n**[unit42.paloaltonetworks.com/unit42-inception-attackers-target-europe-year-old-office-vulnerability](https://unit42.paloaltonetworks.com/unit42-inception-attackers-target-europe-year-old-office-vulnerability)**\n\nTom Lancaster November 5, 2018\n\nBy [Tom Lancaster](https://unit42.paloaltonetworks.com/author/tom-lancaster/)\n\nNovember 5, 2018 at 8:00 AM\n\n[Category: Unit 42](https://unit42.paloaltonetworks.com/category/unit42/)\n\nTags: [CVE-2012-1856,](https://unit42.paloaltonetworks.com/tag/cve-2012-1856/) [CVE-2017-11882,](https://unit42.paloaltonetworks.com/tag/cve-2017-11882/) [EMEA,](https://unit42.paloaltonetworks.com/tag/emea/) [Espionage,](https://unit42.paloaltonetworks.com/tag/espionage/) [Government,](https://unit42.paloaltonetworks.com/tag/government2/) [Inception,](https://unit42.paloaltonetworks.com/tag/inception/)\n[Powershell,](https://unit42.paloaltonetworks.com/tag/powershell/) [PowerShower,](https://unit42.paloaltonetworks.com/tag/powershower/) [RemoteTemplates](https://unit42.paloaltonetworks.com/tag/remotetemplates/)\n\nThis post is also available in: 日本語 [(Japanese)](https://unit42.paloaltonetworks.jp/unit42-inception-attackers-target-europe-year-old-office-vulnerability/)\n\nThe Inception attackers have been active since at least 2014 and have been documented\n[previously by both Blue Coat and](https://www.symantec.com/connect/blogs/blue-coat-exposes-inception-framework-very-sophisticated-layered-malware-attack-targeted-milit) [Symantec; historical attacks used custom malware for a](https://www.symantec.com/blogs/threat-intelligence/inception-framework-hiding-behind-proxies)\nvariety of platforms, and targeting a range of industries, primarily in Russia, but also around\nthe world. This blog describes attacks against European targets observed in October 2018,\nusing [CVE-2017-11882 and a new PowerShell backdoor we’re calling POWERSHOWER](https://nvd.nist.gov/vuln/detail/CVE-2017-11882)\ndue to the attention to detail in terms of cleaning up after itself, along with the malware being\nwritten in PowerShell.\n\nUnit 42 has previously observed attacks from the group in 2017 against government targets\nin Europe, Russia, and Central Asia and expects these to remain the primary regions this\nthreat is seen\n\n\n-----\n\nIn the last writeup by Symantec they describe a two-stage spear phishing process used by\nthe Inception attackers, whereby the attackers first send a reconnaissance spear phish, and\nfollow this up with a second spear phish containing a remote template, which if loaded\ndelivers a first stage payload.\n\nIn their most recent attacks it appears that only one document is used, but in a way that\nallows them to not reveal their final payload immediately; however, the use of templates\nremains the same.\n\nRemote Templates are Great\n\n[Remote templates are a feature of Microsoft Word which allow a document to load a](https://docs.microsoft.com/en-us/dotnet/api/documentformat.openxml.wordprocessing.attachedtemplate?view=openxml-2.8.1)\ntemplate to be used in a document – this template can be externally hosted, either on a file\nshare, or on the internet. The template is then loaded when the document is opened. The\nInception attackers use this feature in a malicious context as shown in Figure 1 below:\n\n_Figure 1. Overview of how the attack takes place._\n\nUsing a remote template in this way has been a consistent feature of the Inception attackers’\nattacks for the past 4 years and has three main benefits to the attacker:\n\n1. The initial document does not contain any explicitly malicious object, it simply\n\nreferences an external object, meaning it should bypass static analysis techniques, an\nexample of how this appears in the document is shown in Figure 2.\n2. The attacker has the option to deploy malicious content to the victim based upon initial\n\ndata received from the target, such as Microsoft Word version (sent in the User-Agent)\nand the IP address of the target, see: Figure 1.\n3. Once the attack is over, and the server hosting the remote template is down, it is\n\ndifficult for researchers to analyze the attack as the remote content is unlikely to be\navailable to them.\n\n\n-----\n\n_Figure 2. Example of how remote templates are referenced in Inception documents._\n\nWhen opened, the documents display decoy content and attempts to fetch a malicious\nremote payload via HTTP. The decoy content is usually copied from media reports, often with\npolitical themes in the target regions, some examples of decoys observed are shown in\nFigure 3, including invites to international conferences and news articles on the current\nsituation in Crimea.\n\n_Figure 3. Examples of decoys shown in Inception attacks in 2018. The first is taken from a_\n_[VGOPAD invitation sent on Facebook in 2017, the second is from a European Policy center](https://www.facebook.com/jltgroup/posts/dear-colleague-on-behalf-of-volunteer-group-on-peace-and-development-i-am-please/1855877617760413/)_\n_summary._\n\nOn most occasions the remote server did not return a malicious template, however we\nrecently observed two cases where a malicious template containing two exploits was served.\n[In both cases the template contained exploits for both CVE-2012-1856 and](https://blog.ropchain.com/2015/07/27/analyzing-vupens-cve-2012-1856/) CVE-201711882, which target vulnerabilities in Word disclosed and patched in 2012 and 2017\nrespectively.\n\nThe payload for the exploits was VBScript in an OLE package object, which in turn decodes\nand executes POWERSHOWER a simple PowerShell backdoor\n\n\n-----\n\nPOWERSHOWER – Malware that Cleans up After Itself\n\nEarlier, we mentioned that previous attacks were apparently delivered over two spear\nphishing emails, with the first only being used for reconnaissance. In the latest cases we only\nobserved a single document being sent to the targets, with reconnaissance, exploitation, and\npayload delivery happening on the first attempt.\n\nThe dropped payload, POWERSHOWER, acts as an initial reconnaissance foothold and is\nalmost certainly used to download and execute a secondary payload with a more complete\nset of features. By only using this simple backdoor to establish a foothold, the attacker can\nhold back their most sophisticated and complex malware for later stages, making them less\nlikely to be detected.\n\nIn a nutshell, POWERSHOWER allows the attacker to:\n\nFingerprint the machine, and upload this information to the initial C&C.\nClean up a significant amount of forensic evidence from the dropper process, as we\ndetail below.\nRun a secondary payload, if the attacker decides the target machine is sufficiently\ninteresting (based on analysis of the system data sent from the first beacon)\n\nPOWERSHOWER Analysis\n\nPOWERSHOWER first checks if Microsoft Word is currently running, if it is, then the malware\nassumes it is the first run through of the malware and performs the following operations:\n\n1. Writes itself to %AppData%\\Microsoft\\Word\\log.ps1\n2. Sets up persistence for this file, using a run key.\n3. Adds a registry key so that future powershell.exe instances are spawned off-screen by\n\n[default – this trick is explained here.](https://cantoriscomputing.wordpress.com/2016/07/22/powershell-malware/)\n4. Kills the Microsoft Word process.\n5. Removes all files created during the dropper process, including evidence the original\n\ndocument was opened, the initial .VBS file, and all temporary files associated with the\nretrieval of the remote template in the IE temporary files directory.\n6. Removes all registry entries that are left behind during the dropper process.\n7. Collects system information on the infected machine and POSTS it to the C2.\n\nIf Microsoft Word is not running, the malware enters its main communications loop,\nperforming the following actions in sequence, this loop should only be entered after a reboot\nof the machine:\n\n1. Collects system information and POSTs it to the C2.\n2. Performs a GET request\n\n\n-----\n\n3. Based on the status code of the GET request it will branch operations:\n\nIf the status code is not 200, the malware sleeps for a random amount of time\nbetween approximately 25 minutes and 35 minutes, based on a randomly\ngenerated number.\nIf the status code is 200 the malware expects the response to:\n\nBegin with an “P”; in which case the malware writes the response to disk,\npresumably to be executed or used in a subsequent command.\nBegin with an “O”; in which case the malware assumes the response\ncontains VBS code which is saved to disk, then executed.\nIf not beginning with either these characters, it is assumed to be an XML file\ncontaining PowerShell expression, which is written to disk, read into\nmemory, deleted, and then executed.\n\nThe code behind the main C&C loop is shown in Figure 4.\n\n_Figure 4. The main C&C loop._\n\nAlthough the malware is simple, it’s fairly effective, giving the attacker options on how to run\ntheir next, more sophisticated, payload.\n\nConclusion\n\nThe Inception attacks continue to mostly stay under the radar, which in part is down to the\neffort put in by the attackers to make their attacks harder to analyze. In the latest wave of\nattacks, they’ve done this through:\n\nUse of remote templates, hindering analysis of historical attacks.\n\n\n-----\n\nAnti-forensics techniques used during the dropper process to prevent clues as to how\nthe malware was installed - being left on disk or in the registry.\nUse of the new basic POWERSHOWER backdoor as a first stage, making it harder for\nresearchers to get copies of more sophisticated payloads used by the attackers.\n\nPalo Alto Networks customers are protected from this threat in the following ways:\n\nWildfire detects all current Inception remote template documents, and the downloaded\nCVE-2017-11882 RTFs with malware verdicts.\nTraps blocks all of the files we are aware of that are associated with this campaign.\n\nIndicators of Compromise\n\n**Remote Template Documents where we have the matching payload**\n\n13de9678279b6ce6d81aeb32c0dd9f7458ad1f92aee17f3e052be9f06d473bed\n\nd547773733abef19f2720d4def2356d62a532f64bcb002fb2b799e9ae39f805f\n\n**Remote templates analyzed.**\n\n687ee860fd5cd9902b441c26d72788d5a52052d03047a9b071808fc4c53a7e8b\n\n72eb022f395cc15bbe9582ee02f977ea0692932461a8b0bd608d9f0971125999\n\n**PowerShower sample**\n\n8aef4975d9c51821c4fa8ee1cbfe9c1f4a88c8784427d467ea99b2c1dabe15ae\n\n**Other related templates and exploit documents from 2018**\n\n49dbcf1fc8d3381e495089f396727a959885c1dd2ab6cd202cf3c4dbd1d27c4f\n\n8b212ee2d65c4da033c39aebaf59cc51ade45f32f4d91d1daa0bd367889f934d\n\ncc64a68ba52283f6cf5521cf75567b3c5b5143f324d37c59906ee63f1bbafcaf\n\n2bcb8a4ddc2150b25a44c292db870124c65687444f96e078f575da69bbf018e0\n\n**Infrastructure**\n\nFirst Seen IP Context\n\n20 July 2018th 51.255.139[.]194 Remote template host\n\n\n13 August 2018th 188.165.62[.]40 Remote template host\n\n10 October 2018th 200.122.128[.]208 POWERSHOWER C2\n\n\n-----\n\n22nd October 2018 108.170.52[.]158 Remote template host\n\n_Table 1 – IP Addresses associated with Inception Remote Template documents_\n\n**Get updates from**\n\n**Palo Alto**\n\n**Networks!**\n\nSign up to receive the latest news, cyber threat intelligence and research from us\n\n[By submitting this form, you agree to our Terms of Use and acknowledge our Privacy](https://www.paloaltonetworks.com/legal-notices/terms-of-use)\nStatement.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2018/2018-11-05 - Inception Attackers Target Europe with Year-old Office Vulnerability.pdf"
    ],
    "report_names": [
        "2018-11-05 - Inception Attackers Target Europe with Year-old Office Vulnerability.pdf"
    ],
    "threat_actors": [
        {
            "id": "02c9f3f6-5d10-456b-9e63-750286048149",
            "created_at": "2022-10-25T16:07:23.722884Z",
            "updated_at": "2025-03-27T02:02:09.945869Z",
            "deleted_at": null,
            "main_name": "Inception Framework",
            "aliases": [
                "ATK 116",
                "Blue Odin",
                "Clean Ursa",
                "Cloud Atlas",
                "Inception Framework",
                "Operation Cloud Atlas",
                "Operation RedOctober",
                "The Rocra"
            ],
            "source_name": "ETDA:Inception Framework",
            "tools": [
                "Lastacloud",
                "PowerShower",
                "VBShower"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "77b28afd-8187-4917-a453-1d5a279cb5e4",
            "created_at": "2022-10-25T15:50:23.768278Z",
            "updated_at": "2025-03-27T02:00:55.5423Z",
            "deleted_at": null,
            "main_name": "Inception",
            "aliases": [
                "Inception Framework",
                "Cloud Atlas"
            ],
            "source_name": "MITRE:Inception",
            "tools": [
                "PowerShower",
                "VBShower",
                "LaZagne"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "04a7ebaa-ebb1-4971-b513-a0c86886d932",
            "created_at": "2023-01-06T13:46:38.784965Z",
            "updated_at": "2025-03-27T02:00:02.91817Z",
            "deleted_at": null,
            "main_name": "Inception Framework",
            "aliases": [
                "ATK116",
                "Blue Odin",
                "Clean Ursa",
                "Cloud Atlas",
                "G0100"
            ],
            "source_name": "MISPGALAXY:Inception Framework",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673536125,
    "ts_updated_at": 1743041589,
    "ts_creation_date": 1662027584,
    "ts_modification_date": 1662027584,
    "files": {
        "pdf": "https://archive.orkl.eu/0b86e42f923c615ead1f99cc6f18bf4e71baadf8.pdf",
        "text": "https://archive.orkl.eu/0b86e42f923c615ead1f99cc6f18bf4e71baadf8.txt",
        "img": "https://archive.orkl.eu/0b86e42f923c615ead1f99cc6f18bf4e71baadf8.jpg"
    }
}