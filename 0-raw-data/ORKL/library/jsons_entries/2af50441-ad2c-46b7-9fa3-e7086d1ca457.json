{
    "id": "2af50441-ad2c-46b7-9fa3-e7086d1ca457",
    "created_at": "2023-01-12T15:00:38.633047Z",
    "updated_at": "2025-03-27T02:15:41.755625Z",
    "deleted_at": null,
    "sha1_hash": "6f3e7d5b4b2b226104148a6b34754f71e79e88bc",
    "title": "2019-05-30 - Bug in Malware “TSCookie” - Fails to Read Configuration - (Update)",
    "authors": "",
    "file_creation_date": "2022-05-28T23:44:27Z",
    "file_modification_date": "2022-05-28T23:44:27Z",
    "file_size": 251195,
    "plain_text": "# Bug in Malware “TSCookie” - Fails to Read Configuration\n - (Update)\n\n**blogs.jpcert.or.jp/en/2019/05/tscookie3.html**\n\n朝長 [秀誠 (Shusei Tomonaga)](https://blogs.jpcert.or.jp/en/shu_tom/)\n\nMay 30, 2019\n\n[BlackTech](https://blogs.jpcert.or.jp/en/tags/blacktech/)\n\n[Email](http://10.10.0.46/mailto:?subject=Bug%20in%20Malware%20%E2%80%9CTSCookie%E2%80%9D%20-%20Fails%20to%20Read%20Configuration%20-%20%28Update%29&body=https%3A%2F%2Fblogs.jpcert.or.jp%2Fen%2F2019%2F05%2Ftscookie3.html)\n\n[Our past article has presented a bug in malware “TSCookie”, which is reportedly used by](https://blogs.jpcert.or.jp/en/2018/11/tscookie2.html)\nBlackTech attack group. This article is to update the features of the malware.\n\nEven after we published the blog article in October 2018, the adversary had continued using\nthe malware as it was. Just in May 2019, we confirmed that the malware had its bug fixed\nand was used in some attack cases.\n\n## Details of the fix\n\nThe malware copies its configuration to the memory. In the previous version, the data size to\nbe copied was incorrectly set, which resulted in the configuration not displayed properly (see\nthe [article for more details). In the updated version, the data size is set to 0x1000 instead of](https://blogs.jpcert.or.jp/en/2018/11/tscookie2.html)\n0x8D4.\n\nFig 1: Updates in\n\nTSCookie (Left: Code with the bug / Right: Updated code)\n\n\n-----\n\nThis update enables TSCookie to decode the configuration correctly. Fig 2 is the comparison\nof decoded configuration. This update has also fixed the issue where the malware fails to\nreconnect to a C&C server for a few days.\n\nFig 2: Decoded\n\nconfigurations of TSCookie (Left: Sample with the bug / Right: Updated sample)\n\n## In closing\n\nAs we pointed out before, it is likely that adversaries also follow publications and blogs from\nsecurity vendors, etc. We assume that the adversary recognised the bug on our blog and\nfixed the issue accordingly. If we see any updates on the malware, we will introduce them\nhere.\n\nHash values of the samples described in the article are listed in Appendix A, along with C&C\nservers in Appendix B. Please make sure that none of your devices is accessing these hosts.\n\nThank you for reading.\n\nShusei Tomonaga\n\n(Translated by Yukako Uchida)\n\n**Appendix A: Hash value of the samples**\n\nMalware with the bug\n\n96723797870a5531abec4e99fa84548837e9022e9f22074cf99973ab7df2a2e7\n\nUpdated malware\n\n1ec19677d1e48e4f6ff5f9fe7808b13964059e2ffd48ece19f7305d78e04ec4a\nc2c062ff84a18ad02e92dea0d6e12cafa66ff167ea8d02663fc9aae44de7f4e0\n\n**Appendix B: List of C&C servers**\n\nwww.google.com.dns-report.com\n\n\n-----\n\nmicrosoft.com.appstore.dynamicdns.co.uk\ncartview.viamisoftware.com\n\n[Email](http://10.10.0.46/mailto:?subject=Bug%20in%20Malware%20%E2%80%9CTSCookie%E2%80%9D%20-%20Fails%20to%20Read%20Configuration%20-%20%28Update%29&body=https%3A%2F%2Fblogs.jpcert.or.jp%2Fen%2F2019%2F05%2Ftscookie3.html)\n\nAuthor\n\n朝長 [秀誠 (Shusei Tomonaga)](https://blogs.jpcert.or.jp/en/shu_tom/)\n\nSince December 2012, he has been engaged in malware analysis and forensics\ninvestigation, and is especially involved in analyzing incidents of targeted attacks. Prior to\njoining JPCERT/CC, he was engaged in security monitoring and analysis operations at a\nforeign-affiliated IT vendor. He presented at CODE BLUE, BsidesLV, BlackHat USA Arsenal,\nBotconf, PacSec and FIRST Conference. JSAC organizer.\n\nWas this page helpful?\n\n0 people found this content helpful.\n\nIf you wish to make comments or ask questions, please use this form.\n\nThis form is for comments and inquiries. For any questions regarding specific commercial\nproducts, please contact the vendor.\n\nplease change the setting of your browser to set JavaScript valid. Thank you!\n\n[Back](https://blogs.jpcert.or.jp/en/2019/05/visit-to-indonesia---everybody-can-hack-id-sirtiicc.html)\n[Top](https://blogs.jpcert.or.jp/en/)\n[Next](https://blogs.jpcert.or.jp/en/2019/06/darkhotel-lnk.html)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2019/2019-05-30 - Bug in Malware “TSCookie” - Fails to Read Configuration - (Update).pdf"
    ],
    "report_names": [
        "2019-05-30 - Bug in Malware “TSCookie” - Fails to Read Configuration - (Update).pdf"
    ],
    "threat_actors": [
        {
            "id": "1dadf04e-d725-426f-9f6c-08c5be7da159",
            "created_at": "2022-10-25T15:50:23.624538Z",
            "updated_at": "2025-03-27T02:00:55.508759Z",
            "deleted_at": null,
            "main_name": "Darkhotel",
            "aliases": [
                "Darkhotel",
                "DUBNIUM",
                "Zigzag Hail"
            ],
            "source_name": "MITRE:Darkhotel",
            "tools": null,
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "2646f776-792a-4498-967b-ec0d3498fdf1",
            "created_at": "2022-10-25T15:50:23.475784Z",
            "updated_at": "2025-03-27T02:00:55.479958Z",
            "deleted_at": null,
            "main_name": "BlackTech",
            "aliases": [
                "BlackTech",
                "Palmerworm"
            ],
            "source_name": "MITRE:BlackTech",
            "tools": [
                "Kivars",
                "PsExec",
                "TSCookie",
                "Flagpro",
                "Waterbear"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "d3a7123c-f519-49a0-a234-de24a1ef052a",
            "created_at": "2022-10-25T16:47:55.545211Z",
            "updated_at": "2025-03-27T02:05:17.254744Z",
            "deleted_at": null,
            "main_name": "BRONZE CANAL",
            "aliases": [
                "CTG-6177 ",
                "Circuit Panda ",
                "Palmerworm ",
                "Shrouded Crossbow ",
                "BlackTech"
            ],
            "source_name": "Secureworks:BRONZE CANAL",
            "tools": [
                " DRIGO",
                " Flagpro",
                " Gh0stTimes",
                " PLEAD",
                " Spiderpig",
                " Waterbear",
                "Bifrose"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "75024aad-424b-449a-b286-352fe9226bcb",
            "created_at": "2023-01-06T13:46:38.962724Z",
            "updated_at": "2025-03-27T02:00:02.964002Z",
            "deleted_at": null,
            "main_name": "BlackTech",
            "aliases": [
                "CIRCUIT PANDA",
                "Temp.Overboard",
                "G0098",
                "Red Djinn",
                "HUAPI",
                "Palmerworm",
                "T-APT-03",
                "Manga Taurus",
                "Earth Hundun"
            ],
            "source_name": "MISPGALAXY:BlackTech",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "efa7c047-b61c-4598-96d5-e00d01dec96b",
            "created_at": "2022-10-25T16:07:23.404442Z",
            "updated_at": "2025-03-27T02:02:09.781478Z",
            "deleted_at": null,
            "main_name": "BlackTech",
            "aliases": [
                "BlackTech",
                "Circuit Panda",
                "Earth Hundun",
                "Manga Taurus",
                "Operation PLEAD",
                "Operation Shrouded Crossbow",
                "Operation Waterbear",
                "Palmerworm",
                "Radio Panda",
                "Red Djinn",
                "T-APT-03",
                "TEMP.Overboard"
            ],
            "source_name": "ETDA:BlackTech",
            "tools": [
                "BIFROST",
                "BUSYICE",
                "BendyBear",
                "Bluether",
                "CAPGELD",
                "DRIGO",
                "Deuterbear",
                "Flagpro",
                "GOODTIMES",
                "Gh0stTimes",
                "IconDown",
                "KIVARS",
                "LOLBAS",
                "LOLBins",
                "Linopid",
                "Living off the Land",
                "TSCookie",
                "Waterbear",
                "XBOW",
                "elf.bifrose"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "b13c19d6-247d-47ba-86ba-15a94accc179",
            "created_at": "2024-05-01T02:03:08.149923Z",
            "updated_at": "2025-03-27T02:05:17.422065Z",
            "deleted_at": null,
            "main_name": "TUNGSTEN BRIDGE",
            "aliases": [
                "DUBNIUM ",
                "DarkHotel ",
                "CTG-1948 "
            ],
            "source_name": "Secureworks:TUNGSTEN BRIDGE",
            "tools": [
                "Nemim"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "2b4eec94-7672-4bee-acb2-b857d0d26d12",
            "created_at": "2023-01-06T13:46:38.272109Z",
            "updated_at": "2025-03-27T02:00:02.790029Z",
            "deleted_at": null,
            "main_name": "DarkHotel",
            "aliases": [
                "DUBNIUM",
                "Fallout Team",
                "Luder",
                "Tapaoux",
                "Shadow Crane",
                "APT-C-06",
                "SIG25",
                "Karba",
                "Nemim",
                "Nemin",
                "G0012",
                "ATK52",
                "T-APT-02",
                "TUNGSTEN BRIDGE",
                "Zigzag Hail"
            ],
            "source_name": "MISPGALAXY:DarkHotel",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "c0cedde3-5a9b-430f-9b77-e6568307205e",
            "created_at": "2022-10-25T16:07:23.528994Z",
            "updated_at": "2025-03-27T02:02:09.847683Z",
            "deleted_at": null,
            "main_name": "DarkHotel",
            "aliases": [
                "APT-C-06",
                "ATK 52",
                "CTG-1948",
                "Dubnium",
                "Fallout Team",
                "Higaisa",
                "Luder",
                "Operation DarkHotel",
                "Operation Daybreak",
                "Operation Inexsmar",
                "Operation PowerFall",
                "Operation The Gh0st Remains the Same",
                "SIG25",
                "Shadow Crane",
                "T-APT-02",
                "Tungsten Bridge",
                "Zigzag Hail"
            ],
            "source_name": "ETDA:DarkHotel",
            "tools": [
                "Asruex",
                "DarkHotel",
                "DmaUp3.exe",
                "GreezeBackdoor",
                "Karba",
                "Nemain",
                "Nemim",
                "Ramsay",
                "Retro",
                "Tapaoux",
                "Trojan.Win32.Karba.e",
                "Virus.Win32.Pioneer.dx",
                "igfxext.exe",
                "msieckc.exe"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535638,
    "ts_updated_at": 1743041741,
    "ts_creation_date": 1653781467,
    "ts_modification_date": 1653781467,
    "files": {
        "pdf": "https://archive.orkl.eu/6f3e7d5b4b2b226104148a6b34754f71e79e88bc.pdf",
        "text": "https://archive.orkl.eu/6f3e7d5b4b2b226104148a6b34754f71e79e88bc.txt",
        "img": "https://archive.orkl.eu/6f3e7d5b4b2b226104148a6b34754f71e79e88bc.jpg"
    }
}