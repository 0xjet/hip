{
    "id": "12833e07-c6ce-4176-a3d8-b0bff2ea262b",
    "created_at": "2023-01-12T14:59:52.862699Z",
    "updated_at": "2025-03-27T02:13:34.635795Z",
    "deleted_at": null,
    "sha1_hash": "8c3945c9a3007cf92c8aa4e24ce03eeb3da7baa8",
    "title": "2020-05-19 - The wolf is back...",
    "authors": "",
    "file_creation_date": "2022-05-28T15:56:20Z",
    "file_modification_date": "2022-05-28T15:56:20Z",
    "file_size": 1741072,
    "plain_text": "# The wolf is back...\n\n**[blog.talosintelligence.com/2020/05/the-wolf-is-back.html](https://blog.talosintelligence.com/2020/05/the-wolf-is-back.html)**\n\nBy [Warren Mercer,](https://twitter.com/SecurityBeard/) [Paul Rascagneres and](https://twitter.com/r00tbsd?lang%3Den) [Vitor Ventura.](https://twitter.com/_vventura)\n\n## News summary\n\n\n-----\n\nThai Android devices and users are being targeted by a modified version of DenDroid\nwe are calling \"WolfRAT,\" now targeting messaging apps like WhatsApp, Facebook\nMessenger and Line.\nWe assess with high confidence that this modified version is operated by the infamous\nWolf Research.\nThis actor has shown a surprising level of amateur actions, including code overlaps,\nopen-source project copy/paste, classes never being instanced, unstable packages\nand unsecured panels.\n\n## Executive summary\n\nCisco Talos has discovered a new Android malware based on a leak of the DenDroid\nmalware family. We named this malware \"WolfRAT\" due to strong links between this malware\n(and the command and control (C2) infrastructure) and Wolf Research, an infamous\norganization that developed interception and espionage-based malware and was publicly\n[described by CSIS during Virus Bulletin 2018. We identified infrastructure overlaps and string](https://www.virusbulletin.com/blog/2018/10/wolf-sheeps-clothing-undressed/)\nreferences to previous Wolf Research work. The organization appears to be shut down, but\nthe threat actors are still very active.\n\nWe identified campaigns targeting Thai users and their devices. Some of the C2 servers are\nlocated in Thailand. The panels also contain Thai JavaScript comments and the domain\nnames also contain references to Thai food, a tactic commonly employed to entice users to\nclick/visit these C2 panels without much disruption.\n\nWe identified a notable lack of sophistication in this investigation such as copy/paste,\nunstable code, dead code and panels that are freely open.\n\n### What's new?\n\n[WolfRAT is based on a previously leaked malware named DenDroid. The new malware](https://en.wikipedia.org/wiki/Dendroid_(malware))\nappears to be linked to the infamous Wolf Research organization and targets Android\ndevices located in Thailand.\n\n### How did it work?\n\nThe malware mimics legit services such as Google service, GooglePlay or Flash update. The\nmalware is not really advanced and is based on a lot of copy/paste from public sources\navailable on the Internet. The C2 infrastructure contains a lack of sophistication such as\nopen panels, reuse of old servers publicly tagged as malicious…\n\n### So what?\n\nAfter being publicly denounced by CSIS Group — a threat intelligence company in Denmark\n[— Wolf Research was closed and a new organization named LokD was created This new](https://cyprusregistry.com/companies/HE/378592)\n\n\n-----\n\norganization seems to work on securing Android devices. However, thanks to the\ninfrastructure sharing and forgotten panel names, we assess with high confidence that this\nactor is still active, it is still developing malware and has been using it from mid-June to\ntoday. On the C2 panel, we found a potential link between Wolf Research and another\nCyprus organization named Coralco Tech. This organization is also working on interception\ntechnology.\n\n## Links to Wolf Intelligence\n\nDuring the Virus Bulletin conference in 2018, CSIS researchers Benoît Ancel and Aleksejs\n[Kuprins did a presentation on Wolf Research and the offensive arsenal developed by the](https://www.virusbulletin.com/blog/2018/10/wolf-sheeps-clothing-undressed/)\norganization. They mentioned an Android, iOS and Windows remote access tool (RAT). Their\nfindings showed that Wolf is headquartered in Germany with offices in Cyprus, Bulgaria,\nRomania, India and (possibly) the U.S. The organization was closed after the CSIS\n[presentation. However, the director created a new organization in Cyprus named LokD. This](https://cyprusregistry.com/companies/HE/378592)\nnew organization proposed the creation of a more secure Android phone. Based on the\norganization website, it also proposes services and developed zero-day vulnerabilities to test\ntheir own products:\n\nZero-day research from lokd.com\n\nWe can see that the organization owner still has an interest in Android devices. Based on\ninfrastructure overlaps and leaked information, we assess with high confidence that the\nmalware we identified and present in this paper is linked to Wolf Research.\n\nOne of the samples\n(e19823a1ba4a0e40cf459f4a0489fc257720cc0d71ecfb7ad94b3ca86fbd85d1) uses the C2\nserver svcws[.]ponethus[.]com. Based on our research and Benoît Ancel's tracker, this C2\nwas used by Wolf Intelligence:\n\n\n-----\n\nAdditionally, we identified two empty panels on a C2 server. The new one with the title\n\"Coralco Archimedes,\" and an older version with the title \"Wolf Intelligence:\"\n\nNew panel\n\nOld panel\n\nThe new panel name contains \"Coralco\" in its name. Coralco Tech is an organization located\nin Cyprus and providing interception tools. We cannot say for sure if Wolf Research and\nCoralco Tech are linked, but this panel name, their offerings and the panel layout would\n\n\n-----\n\nsuggest it should be considered suspiciously linked.\n\n[Coralco Tech's services description.](https://www.coralco-tech.com/interception)\n\n## Victimology on the identified campaigns\n\nThe campaigns we analyzed targeted Android devices in Thailand.\n\n\n-----\n\nThe C2 server domain is linked to Thai food:\n\nNampriknum[.]net: Nam Phrik Num\n\n\n-----\n\nSomtum[.]today: Som Tum\n\nWe also identified comments in Thai on the C2 infrastructure mentioned in the previous\nchapter:\n\n## Malware\n\n### DenDroid\n\n\n-----\n\nThe Android malware is based on the DenDroid Android malware. Several analysis reports\nwere published on this malware in 2014 and, finally, the source code was leaked in 2015.\n[The original leak is no longer available on github.com, but a copy can be found here. The](https://github.com/qqshow/dendroid)\ntable below shows the commands available to the operator for tasking on infected devices.\n\nThis malware is simplistic in comparison to some modern-day Android malware. The best\nexample of that is that it doesn't take advantage of the accessibility framework, collecting\ninformation on non-rooted devices. The commands are self-explanatory and show the\nfeatures included in the malware. Some of them like takephoto, takevideo, recordaudio,\ngetsentsms and uploadpictures are focused on espionage activities. Others like transferbot,\npromptupdate and promptuninstall are meant to help the operator manage the malware.\n\n### Version #1: June 2019 — Domain: databit[.]today\n\nDuring our investigation, we identified at least four major releases of the RAT. The\npermissions on the first version of the malware lay out the foundations of a spying trojan.\n\n\n-----\n\nPermissions\n\nThe package name follows the original style name used on DenDroid. The code is\nobfuscated but not packed. This malware also contains a screen recorder.\n\nThis feature is implemented using another open-source software package that can be found\n[here. The service is implemented in the class](https://github.com/saki4510t/ScreenRecordingSample)\ncom.serenegiant.service.ScreenRecorderService which is declared in the package manifest.\nDuring our analysis of this sample, we did notice that the class itself is never called or used\nby the malware. It remains available within the source code but no method of use takes\nplace.\n\n### Version #2: June - Aug. 2019 — Domain: somtum[.]today\n\nThis is the first version that shows the code organization evolution that will continue to be\nused on all other functions throughout this malware.\n\n\n-----\n\nCode structure\n\nObviously, this code is not obfuscated when compared with the previous version it becomes\nclear that this is the same code base. One of the first changes that stands out is that the\nscreen recording feature mentioned in the previous sample has been removed. A new class\nwas added called com.utils.RestClient. This class is based on public code belonging to the\n[package praeda.muzikmekan,which can be found here among other places. Just like in](https://github.com/octopi/Capsules/blob/master/src/praeda/muzikmekan/RestClient.java)\nprevious examples, the malware author does not use this package.\n\nMissing permissions\n\n\n-----\n\nThe lack of the READ_FRAME_BUFFER permission can be justified by the removal of the\nscreen record feature. The ACCESS_SUPERUSER may have been removed because it was\ndeprecated upon the release of Android 5.0 Lollipop which happened in 2014. The reality is\nthat the RAT permissions can be implemented just with the permissions declared on the\nmanifest, thus there is no need for higher permissions.\n\n### Version #3: Sept. - Dec. 2019 — Domain: ponethus[.]com\n\nGiven that there is some overlap in the previous two versions, it came as no surprise to us\nthat we finally identified a sample which is an evolution based on both previous versions.\nThis sample is clearly a mix between the two. This is also the first version where the package\nname changes into something that a less aware user may be tricked by, com.android.playup.\n\nThis version brings back the ACCESS_SUPERUSER and READ_FRAME_BUFFER\npermissions. However, this time, the permission is actually used.\n\nWhatsApp message capture\n\nThe service com.serenegiant.service.ScreenRecorderService, is invoked by the\nScreenRecorderActivity. Upon creation, this activity launches a thread that will loop on a 50second interval. In the first iteration, the screen recording is started and will only stop when\nthe RAT determines that WhatsApp is not running. It's restarted in the next cycle\nindependently based on if WhatsApp is running.\n\n\n-----\n\nIn this version, the developer added more classes from the same package. Even though we\ncould not find indications of being in use, two stand out. Bluetooth — which allows the\ninteraction with the Bluetooth interface, and net/deacon — which implements a beaconing\nsystem based on UDP.\n\nAndroid shell\n\nA new package was added that allows the execution of commands in the Android shell.\n[Again, this package source code is publicly available and can be found here. One of the](https://github.com/jaredrummler/AndroidShell/tree/master/library/src/main/java/com/jaredrummler/android/shell)\nuses the malware gives to this package is the execution of the command \"dumpsys\" to\ndetermine if certain activities are running.\n\nCheck if chat apps are running\n\nIn the above example, the malware is searching for Line, Facebook Messenger and\nWhatsApp activities. This is part of a class called CaptureService, which already existed in\nthe previous version but it was not duly implemented.\n\n\n-----\n\nPrevious version\n\nThe capture service class implements the chat applications interception. Upon creation the\nclass will start to take screenshots that will be stopped and uploaded to the C2 once the\nservice can't find the targeted applications running. The core of this functionality is also\n[based on an open-source project that can be found here.](https://github.com/mtsahakis/MediaProjectionDemo/blob/master/src/com/mtsahakis/mediaprojectiondemo/ScreenCaptureImageActivity.java)\n\nAnother novelty is a VPN-related package, which is based on OrbotVPN. Once again, it\ndoesn't seem to actually be in use. The same happens with the package squareup.otto,\nwhich is an open-source bus implementation focused on Android implementation. Both\n[sources can be found here and](https://github.com/guardianproject/OrbotVPN/blob/master/src/org/torproject/android/vpn/OrbotVpnService.java) [here.](https://square.github.io/otto/)\n\n### Version #4: April 2020 — Domain: nampriknum.net\n\nFollowing the same pattern, this version has some added features and others, which were\nnot in use, removed. First of all the new package name is com.google.services, which can\neasily be confused with a legitimate Google service. The VPN package is no longer present,\nfurther reinforcing our conclusion that it was not in use.\n\n\n-----\n\nWolfRAT application screen\n\nThe Google GMS and Firebase service has been added, however, no configuration has been\nfound, even though services seem to be referenced in the of a new class. The new class is\ncalled NotificationListener and extends the NotificationListenerService class. This would\nallow the RAT to receive system notifications.\n\n\n-----\n\nNotification handling method\n\nThe class is only implemented in debug mode, pushing all captured information into the log.\nThe usage of the PlusShare API in 2020 denotes some unprofessional development, since\nthis is the API to access Google+. This service, along with the API, was fully\ndecommissioned in March 2019.\n\nThis version adds one significant class — it requests DEVICE_ADMIN privileges.\n\nDevice admin policies\n\nLooking at the policy's definition, we can see that it lists all the available policies even if most\nof them are deprecated on Android 10.0 and their usage results in a security exception. The\ncode implementation again seems that it has been added for testing purposes only\n\n\n-----\n\n### Versions overview\n\nThe DenDroid code base was kept to such an extent that even the original base64-encoded\npassword was kept.\n\nOriginal password\n\nThe main service follows the same structure as the first version, the anti-analysis features\nare primitive, only checking the emulator environment without any kind of packing or\nobfuscation.\n\nThe malware will start the main service if all the requested permissions and the device admin\nprivileges are granted. Otherwise, it will launch an ACTION_APPLICATION_SETTINGS\nintent trying to trick the user to grant the permissions.\n\nEach sample contains a userId hardcoded, meaning that each sample can only be used in a\nvictim. It seems, however, if the same victim has more than one device the malware can be\nreused since the IMEI is sent along with each data exfiltration.\n\nIt is clear that this RAT is under intense development, however, the addition and removal of\npackages, along with the huge quantity of unused code and usage of deprecated and old\ntechniques denotes an amateur development methodology.\n\n## Conclusion\n\nWe witness actors continually using open-source platforms, code and packages to create\ntheir own software. Some are carried out well, others, like WolfRAT, are designed with an\noverload of functionality in mind as opposed to factoring any sensible approach to the\ndevelopment aspect. After all, a working product is often more important than a stable\nproduct. We watched WolfRAT evolve through various iterations which shows that the actor\nwanted to ensure functional improvements — perhaps they had deadlines to meet for their\ncustomers, but with no thought given to removing old code blocks, classes, etc. throughout\nthe Android package.\n\nWolfRAT is a specifically targeted RAT which we assess to be aimed at Thai individuals and,\nbased on previous work from Wolf Research, most likely used as an intelligence-gathering\ntool or interception tool. This can be packaged and \"sold\" in many different ways to\ncustomers. A \"Tracking tool\" or an \"Admin tool\" are often cited for these kinds of tools for\n\"commercial\" or \"enterprise\" usage. Wolf Research claimed to shut down their operations but\nwe clearly see that their previous work continues under another guise\n\n\n-----\n\nThe ability to carry out these types of intelligence-gathering activities on phones represents a\nhuge score for the operator. The chat details, WhatsApp records, messengers and SMSs of\nthe world carry some sensitive information which people often forget when communicating\nwith their devices. We see WolfRAT specifically targeting a highly popular encrypted chat\napp in Asia, Line, which suggests that even a careful user with some awareness around endto-end encryption chats would still be at the mercy of WolfRAT and it's prying eyes.\n\n## Coverage\n\nWays our customers can detect and block this threat are listed below.\n\n[Advanced Malware Protection (AMP) is ideally suited to prevent the execution of the](https://www.cisco.com/c/en/us/products/security/advanced-malware-protection)\nmalware used by these threat actors. Exploit Prevention present within AMP is designed to\nprotect customers from unknown attacks such as this automatically.\n\n[Cisco Cloud Web Security (CWS) or Web Security Appliance (WSA) web scanning prevents](https://www.cisco.com/c/en/us/products/security/cloud-web-security/index.html)\naccess to malicious websites and detects malware used in these attacks.\n\n[Email Security can block malicious emails sent by threat actors as part of their campaign.](https://www.cisco.com/c/en/us/products/security/email-security-appliance/index.html)\n\n[Network Security appliances such as Next-Generation Firewall (NGFW), Next-Generation](https://www.cisco.com/c/en/us/products/security/firewalls/index.html)\n[Intrusion Prevention System (NGIPS), Cisco ISR, and Meraki MX can detect malicious](https://www.cisco.com/c/en/us/products/security/intrusion-prevention-system-ips/index.html)\nactivity associated with this threat.\n\n[AMP Threat Grid helps identify malicious binaries and build protection into all Cisco Security](https://www.cisco.com/c/en/us/solutions/enterprise-networks/amp-threat-grid/index.html)\nproducts.\n\n\n-----\n\n[Umbrella, our secure internet gateway (SIG), blocks users from connecting to malicious](https://umbrella.cisco.com/)\ndomains, IPs, and URLs, whether users are on or off the corporate network.\n\nOpen Source Snort Subscriber Rule Set customers can stay up to date by downloading the\n[latest rule pack available for purchase on Snort.org.](https://www.snort.org/products)\n\n## IOCs\n\n### Hashes\n\n139edb1bc033725539b117f50786f3d3362ed45845c57fe1f82e7ed72b044367\n\ne19823a1ba4a0e40cf459f4a0489fc257720cc0d71ecfb7ad94b3ca86fbd85d1\n\ne19823a1ba4a0e40cf459f4a0489fc257720cc0d71ecfb7ad94b3ca86fbd85d1\n\ne5f346d8f312cc1f93c2c6af611e2f50805c528934786ea173cabc6a39b14cda\n\n1849a50a6ac9b3eec51492745eeb14765fe2e78488d476b0336d8e41c2c581d4\n\nd328fca14c4340fcd4a15e47562a436085e6b1bb5376b5ebd83d3e7218db64e7\n\n59b9809dba857c5969f23f460a2bf0a337a71622a79671066675ec0acf89c810\n\n120474682ea439eb0b28274c495d9610a73d892a4b8feeff268c670570db97e2\n\ned234e61849dcb95223676abe2312e1378d6130c0b00851d82cda545b946ec83\n\n27410d4019251a70d38f0635277f931fb73f67ac9f2e1f3b475ce680ebfde12a\n\n6e6c210535b414c5aa2dd9e67f5153feeb43a8ac8126d8e249e768f501323a3e\n\n4a32ced20df7001da7d29edc31ca76e13eef0c9b355f62c44888853435e9794f\n\nac5abaebd9f516b8b389450f7d27649801d746fb14963b848f9d6dad0a505e66\n\n3a45d7a16937d4108b5b48f44d72bb319be645cbe15f003dc9e77fd52f45c065\n\n### Domains\n\ncvcws[.]ponethus[.]com\n\nsvc[.]ponethus[.]com\nwww[.]ponethus[.]com\n\nwebmail[.]ponethus[.]com\n\nnampriknum[.]net\n\nwww[.]nampriknum[.]net\n\nsvc[.]nampriknum[.]net\n\nsvcws[.]nampriknum[.]net\n\nsvc[.]somtum[.]today\n\nsvcws[.]somtum[.]today\n\nwww[.]somtum[.]today\n\nsomtum[.]today\n\nshop[.]databit[.]today\nsvc[.]databit[.]today\n\ntest[.]databit[.]today\n\nwww[.]databit[.]today\n\n\n-----\n\nadmin[.databit[.today\ncendata[.]today\nsvc[.]cendata[.]today\nsvcws[.]cendata[.]today\nwww[.]cendata[.]today\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2020/2020-05-19 - The wolf is back....pdf"
    ],
    "report_names": [
        "2020-05-19 - The wolf is back....pdf"
    ],
    "threat_actors": [
        {
            "id": "08c8f238-1df5-4e75-b4d8-276ebead502d",
            "created_at": "2023-01-06T13:46:39.344081Z",
            "updated_at": "2025-03-27T02:00:03.056208Z",
            "deleted_at": null,
            "main_name": "Copy-Paste",
            "aliases": [],
            "source_name": "MISPGALAXY:Copy-Paste",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673535592,
    "ts_updated_at": 1743041614,
    "ts_creation_date": 1653753380,
    "ts_modification_date": 1653753380,
    "files": {
        "pdf": "https://archive.orkl.eu/8c3945c9a3007cf92c8aa4e24ce03eeb3da7baa8.pdf",
        "text": "https://archive.orkl.eu/8c3945c9a3007cf92c8aa4e24ce03eeb3da7baa8.txt",
        "img": "https://archive.orkl.eu/8c3945c9a3007cf92c8aa4e24ce03eeb3da7baa8.jpg"
    }
}