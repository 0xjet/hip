{
    "id": "44755a01-2bd0-4cbc-88e3-41c8404c41d8",
    "created_at": "2023-01-12T15:10:04.543215Z",
    "updated_at": "2025-03-27T02:15:57.671389Z",
    "deleted_at": null,
    "sha1_hash": "9c4887304a34b7a24f922f2e2c9b898a4d0df049",
    "title": "2022-05-04 - Operation CuckooBees- A Winnti Malware Arsenal Deep-Dive",
    "authors": "",
    "file_creation_date": "2022-05-28T00:28:09Z",
    "file_modification_date": "2022-05-28T00:28:09Z",
    "file_size": 3479020,
    "plain_text": "# Operation CuckooBees: A Winnti Malware Arsenal Deep- Dive\n\n**[cybereason.com/blog/operation-cuckoobees-a-winnti-malware-arsenal-deep-dive](https://www.cybereason.com/blog/operation-cuckoobees-a-winnti-malware-arsenal-deep-dive)**\n\nWritten By\nCybereason Nocturnus\n\nMay 4, 2022 | 19 minute read\n\n\n-----\n\nIn [part one of this research, the](https://www.cybereason.com/blog/operation-cuckoobees-deep-dive-into-stealthy-winnti-techniques) [Cybereason Nocturnus Incident Response Team provided a](https://www.cybereason.com/services/incident-response)\nunique glimpse into the Winnti intrusion playbook, covering the techniques that were used by\nthe group from initial compromise to stealing the data, as observed and analyzed by the\nCybereason Incident Response team.\n\nThis part of the research zeroes in on the Winnti malware arsenal that was discovered during\nthe investigation conducted by the Cybereason IR and Nocturnus teams. In addition, our\nanalysis of the observed malware provides a deeper understanding of the elaborate and multilayered Winnti infection chain, including evasive maneuvers and stealth techniques that are\nbaked-in to the malware code, as well as the functionality of the various malware.\n\nPerhaps one of the most interesting and striking aspects of this report is the level of\nsophistication introduced by the malware authors. The infection and deployment chain is long,\ncomplicated and interdependent–should one step go wrong, the entire chain collapses - making\nit somewhat vulnerable, yet at the same time provides an extra level of security and stealth for\nthe operation.\n\nThese steps have proven themselves effective time and time again, as the operation remained\nunder-the-radar for years. While there have been past reports describing some aspects of\nthese intrusions, at the time of writing this report there was no publicly available research that\ndiscussed all of the tools and techniques and the manner in which they all fit together, as\nmentioned in this report.\n\n## Key Findings\n\n**Attribution to the Winnti APT Group: based on the analysis of the forensic artifacts,**\nCybereason estimates with medium-high confidence that the perpetrators of the attack\n[are linked to the notorious Winnti APT group, a group that has existed since at least 2010](https://attack.mitre.org/groups/G0044/)\nand is believed to be operating on behalf of Chinese state interests and specializes in\ncyberespionage and intellectual property theft.\n\n**Discovery of New Malware in the Winnti Arsenal: the report exposes previously**\nundocumented malware strain called DEPLOYLOG used by the Winnti APT group and\nhighlights new versions of known Winnti malware, including Spyder Loader,\nPRIVATELOG, and WINNKIT.\n**Rarely Seen Abuse of the Windows CLFS Feature: the attackers leveraged the**\nWindows CLFS mechanism and NTFS transaction manipulations which provided them\nwith the ability to conceal their payloads and evade detection by traditional security\nproducts.\n\n\n-----\n\n**Intricate and Interdependent Payload Delivery: the report includes an analysis of the**\ncomplex infection chain that led to the deployment of the WINNKIT rootkit composed of\nmultiple interdependent components. The attackers implemented a delicate “house of\ncards” approach, meaning that each component depends on the others to function\nproperly, making it very difficult to analyze each component separately. The malware from\nthe Winnti arsenal that are analyzed in this report include:\n\n**Spyder: A sophisticated modular backdoor**\n\n**STASHLOG: The initial deployment tool “stashing” payloads in Windows CLFS**\n\n**SPARKLOG: Extracts and deploys PRIVATELOG to gain privilege escalation and**\nachieve persistence\n\n**PRIVATELOG: Extracts and deploys DEPLOYLOG**\n\n**DEPLOYLOG: Deploys the WINNKIT Rootkit and serves as a userland agent**\n\n**WINNKIT: The Winnti Kernel-level Rootkit**\n\nThe following graph describes the infection chain presented in this attack:\n\n_Winnti infection chain as observed in Operation CuckooBees_\n\n## Initial Payload: Weaving in the Spyder Loader\n\n\n-----\n\nThe [Spyder loader is the first malicious binary the attackers execute on a targeted machine.](https://st.drweb.com/static/new-www/news/2021/march/BackDoor.Spyder.1_en.pdf)\nThis malware is executed from the batch files we discussed in our blog’s part 1 - cc.bat or\n_bc.bat:_\n\n_Batch_\n\n_file execution command_\n\nThe loader’s purpose is to decrypt and load additional payloads and is being delivered in 2\nvariations. The first variation, is a modified SQLite3 DLL, that uses the export’s ordinal number\n138 to serve malicious code, that loads and executes a file argument provided at runtime, in\nour case C:\\Windows\\System32\\x64.tlb:\n\n_Malicious export ordinal number 138 “sqlite3_profile_v2”_\n\nAs seen above, the loader is executed via the famous LOLBIN rundll32.exe, in the following\nmanner:\n\n_rundll32.exe <modified sqlite3.dll file>,#138 C:\\Windows\\System32\\x64.tlb_\n\nInterestingly, Cybereason found this loader in different names and in different locations across\ninfected machines:\n\nC:\\Windows\\System32\\iumatl.dll\nC:\\Windows\\System32\\msdupld.dll\nC:\\Windows\\System32\\mscuplt.dll\nC:\\Windows\\System32\\msdupld.dll\nC:\\Windows\\System32\\netapi.dll\nC:\\Windows\\System32\\rpcutl.dll\nC:\\Windows\\System32\\dot3utl.dll\nC:\\Windows\\System32\\nlsutl.dll\n\n\n-----\n\nC:\\Windows\\Branding\\Basebrd\\language.dll\nC:\\Program Files\\Internet Explorer\\SIGNUP\\install.dll\n\n[The attackers utilized the System32 directory, which holds a multitude of TLB and DLL files, to](https://docs.microsoft.com/en-us/windows/win32/midl/com-dcom-and-type-libraries)\nhide their external “TLB” payload and DLL loader to make it harder to detect.\n\nThis DLL wasn’t the only Spyder Loader we found, as Cybereason discovered a second\nvariation of this malware in the form of a standalone executable called sqlite3.exe,\nmasquerading as a SQLite3-related executable as well.\n\nThis version featured some improvements, such as logging messages, which shed some light\non some of its functionality and capabilities:\n\n\n-----\n\n_Malicious export ordinal number 138 “sqlite3_profile_v2”_\n\n### The Spyder Loader Bag of Tricks\n\nThroughout its execution, the Spider Loader implements a few interesting methods to evade\ndetection and to maintain stealth:\n\n\n-----\n\n**Anti Analysis/Sandboxing**\n\nAt the beginning of execution, the loader checks if the file argument exists:\n\n_File argument validation_\n\nIf it does, the loader checks for its size: if it is larger than 1.04 MB, it deletes it; if it is smaller\n[than 1.04 MB or equal to it, it decrypts it in memory using the open-source CryptoPP C++](https://cryptopp.com/)\nlibrary and then deletes it from disk.\n\nCybereason assesses this condition is intended to validate that the loader won’t try to decrypt\n[the wrong file, and as a precaution against analysis environments or](https://attack.mitre.org/techniques/T1523/) [Sandboxes.](https://attack.mitre.org/techniques/T1497/)\n\n**EDR Bypass Tricks**\n\nAfter decrypting the payload, the attackers copy the system ntdll.dll file to\n_C:\\Windows\\System32\\TN{random_characters}.dll, and load it to memory:_\n\n_Copying ntdll.dll to C:\\Windows\\System32\\TN{randoms_chars}.dll_\n\nThen, they acquire the NtProtectVirtualMemory address from the copied and loaded file and\ncall a specific routine (which we named as “BypassEdrHook”) multiple times using 2\narguments:\n\nThe acquired address of NtProtectVirtualMemory in the loaded, copied DLL.\n\n\n-----\n\nA string representing a native api function:\n\n_Calling for the BypassEdrHook routine_\n\nThe BypassEdrHook function will compare the first bytes in memory of the native API functions\nin the loaded ntdll.dll image to the first bytes in memory of the same function in the\nloaded/copied DLL memory image.\n\nIf the ntdll function’s first bytes are different from the first bytes of the copied DLL in memory,\nthe attackers will conclude that this native function is hooked by an EDR tool.\n\nTo override it, the attackers count the number of different bytes at the beginning of these two\nfunctions, then they change the permissions of the relevant patched bytes in the original ntdll.dll\nimage to READWRITE_EXECUTE, copy the original bytes from the loaded/copied DLL\nmemory, and restore the previous page protection settings:\n\n_Check for EDR hook and bypass if true_\n\nThis procedure will occur for the following native API functions:\n\nLdrLoadDll\n\n\n-----\n\nKiUserApcDispatcher\nNtAlpcConnectPort\nNtAllocateVirtualMemory\nNtFreeVirtualMemory\nNtMapViewOfSection\nNtQueueApcThread\nNtReadVirtualMemory\nNtSetContextThread\nNtUnmapViewOfSection\nNtWriteVirtualMemory\nRtlInstallFunctionTableCallback\n\nRight afterward, the Spyder Loader will execute the payload reflectively, and lastly, will delete\n_TN{random_characters}.dll to leave no traces._\n\n### Attribution of the Spyder Payloads\n\nThe above-mentioned PE files share similar code with other known Spyder loaders, such as the\n_[oci.dll payload mentioned in a SonicWall blog from March 2021:](https://securitynews.sonicwall.com/xmlpost/chinas-winnti-spyder-module/)_\n\n_Allocate memory and save WINAPI functions in array_\n\n\n-----\n\n_Jump to the payload_\n\nMoreover, our PE files also share a similar evasion technique in masquerading as a legitimate\nexecutable. In the aforementioned blog post, it disguised as D3D DLL - a Direct3D 11 runtime\nDLL, now it disguise as SQLite3:\n\n\n-----\n\n_Same method with different targeted DLLs_\n\nThese similarities, in addition to others, have led us to conclude that this file is an evolution of\nthe Winnti Spyder Loader.\n\n## A Long and Winnti(ng) Road: The Winnti Multi-Phased Arsenal Deployment\n\nAfter deploying the initial payload, Winnti employs a sophisticated and unique multi-staged\ninfection chain with numerous payloads. Each payload fulfills a unique role in the infection\nchain, which is successful only upon the complete deployment of all of the payloads.\n\nIn the upcoming sections, we will discuss the following payloads:\n\n**STASHLOG: Stashes encrypted data in a CLFS log**\n**SPARKLOG: Extracts data from the CLFS log and deploys PRIVATELOG while**\nescalating privileges\n**PRIVATELOG: Extracts data from the CLFS log and deploys DEPLOYLOG. This payload**\nalso enables persistence in some cases\n**DEPLOYLOG: Extracts data from the CLFS log, deploys the WINNKIT Rootkit driver, and**\nacts as the user-mode agent\n**WINNKIT: The Winnti Kernel-level Rootkit**\n\nSeveral unique techniques are used by the Winnti group to store data, evade detection, and\nthwart investigations during this infection flow. One of those techniques, which Winnti heavily\nuses, is the CLFS mechanism.\n\n### Abusing the Rarely Used CLFS Mechanism for Evasion\n\n**So what is CLFS?**\n\n[CLFS (Common Log File System) is a logging framework that was first introduced by Microsoft](https://docs.microsoft.com/en-us/windows-hardware/drivers/kernel/introduction-to-the-common-log-file-system)\nin Windows Server 2003 R2, and is included in later Windows operating systems.\n\nThis mechanism provides a high-performance logging system for a variety of purposes ranging\nfrom simple error logs to transactional systems and data stream collection.\n\n\n-----\n\nOne of the main uses of CLFS in the Windows operating system is in the Windows Kernel\nTransaction Manager (KTM) for both Transactional NTFS (TxF) and Transactional Registry\n(TxR) operations. Transactional operations bring the concept of atomic transactions to\nWindows, allowing Windows to log different operations on those components and support the\nability to roll back if needed.\n\nThe high-performance aspect of this framework is based on the concept of storing the log data\nin memory buffers for fast writing, reading and flushing them to disk–but not continuously,\naccording to a stated policy.\n\nCLFS employs a proprietary file format that isn't documented, and can only be accessed\nthrough the CLFS API functions. As of writing this report, there is no tool which can parse the\nflushed logs. This is a huge benefit for attackers, as it makes it more difficult to examine and\ndetect them while using the CLFS mechanism.\n\nOn disk, the CLFS log store consists of:\n\nBase Log File (BLF file): Contains the log metadata.\nOne or more Container files: Contains the log data, where the container file sizes are\nregistered in the BLF file.\n\nAs will be discussed, Winnti group used this mechanism to store and hide the payload that will\nbe extracted from the CLFS file and used by other PEs in the execution chain to build the\nattacker’s next steps.\n\n### STASHLOG: Stashing the Winnti Arsenal via CLFS\n\n[STASHLOG (shiver.exe / forsrv.exe) is a 32 bit executable that is being used to prepare the](https://www.mandiant.com/resources/unknown-actor-using-clfs-log-files-for-stealth)\nvictim machine for further compromise, and to “stash” a malicious, encrypted payload to a\nCLFS log file. This payload will be decrypted at each phase to deliver the next phase in the\ninfection.\n\n\n-----\n\nBoth STASHLOG and SPARKLOG, which will be described further in the next section, are\nexecuted using a second cc.bat file in the following form:\n\n_STASHLOG and SPARKLOG execution_\n\n**Different Modes of Execution**\n\nSTASHLOG has 2 modes of execution:\n\nWithout arguments to initialize the environment towards infection.\nWith one argument to store the CLFS file for further use.\n\nNo Arguments Mode\n\nWhen no arguments are passed, STASHLOG prints the following output:\n\n_Execution_\n\n_example of STASHLOG without an argument_\n\nThis output consists of the machine Globally Unique Identifier (GUID) along with a 56 byte\nstring:\n\nThe machine’s GUID - derived from the HKLM\\SOFTWARE\\Microsoft\\Cryptography\nregistry key.\nThe 56 byte string is generated from a random GUID created by the CoCreateGUID\nfunction. The string consists of the hex representation of the GUID, SHA1 hash of the hex\nGUID, and a SHA1 hash of the GUID + SHA1 of the GUID.\n\nThis example demonstrates the process of building the 56 byte string:\n\nLet’s take a random GUID: {4684A5A2-942A-4DF6-AF1D-2A672F78F73E}\nThe random GUID’s Hex representation will be:\nA2A584462A94F64DAF1D2A672F78F73E\nIts SHA1 will be: 12C736FE6C9165B1C1026FAAD0051FB9F51DFF35\n\n\n-----\n\nAnd finally the SHA1 of (GUID + SHA1(GUID)):\nFAB426F085460CEFD4A65B8A4396C05BF582CB20\n\nThe final string will be:\n\nA2A584462A94F64DAF1D2A672F78F73E\n12C736FE6C9165B1C1026FAAD0051FB9F51DFF35\nFAB426F085460CEFD4A65B8A4396C05BF582CB20\n\nThe random GUID is then registered as a global atom entry in the form of  win::{GUID}:\n\n_An_\n\n_example of added Global Atom by STASHLOG_\n\nIf an atom prefixed with win:: already exists during execution, then the existing atom will be\nused instead of the newly generated one.\n\nOne Argument Mode\n\nUpon execution with command line arguments, STASHLOG checks the existence of the global\natom table entry win::{GUID}, and the process will quit immediately unless the value exists.\n\nThen, STASHLOG loads the file found in the given argument into memory, checks its content,\nand stores it in a CLFS log file. STASHLOG prints log information about this process to the\nterminal:\n\nPreparing for log format transformation\nLog transform step 1 completed\nLog transform step 2 completed\nLog transform step 3 completed\nLog data transform completed\nSuccessful STASHLOG execution log\n\nThis output in this operation was redirected to a log file, as can be seen on cc.bat. Breaking\ndown the transformation steps from the log:\n\n**Step 1: Decrypt the given encrypted file and check the file validity**\n\nby looking for the destination BLF file location:\n_C:\\Users\\Default\\NTUSER.DAT{<GUID>}.TM.BLF. If the search yields no results,_\nSTASHLOG will create this file.\n**Step 2: Clear the targeted BLF file.**\n**Step 3: Encrypt the malicious data and write it to a CLFS file.**\n\nAnti-Analysis Techniques\n\n_String Obfuscation_\n\n\n-----\n\nThroughout the execution, STASHLOG uses the same string decryption technique used in\nother samples by XORing strings with pre-defined bytes, words or qwords, using the XMM\nregisters. This decryption sequence is present at the beginning of every function that uses\nstrings, where those strings are not saved globally, likely in an attempt to protect them.\n\nAs can be seen in the example below from STASHLOG, it uses it to decrypt several debug\nstrings:\n\n\n-----\n\n_String_\n\n\n_decryption algorithm from shiver exe_\n\n\n-----\n\nThis technique is also being used in other samples in the chain, including SPARKLOG,\nPRIVATELOG and DEPLOYLOG.\n\n_Anti-Disassembly_\n\nThis sample uses an interesting Anti-Disassembly technique which thwarts the disassembly\nprocess and makes the investigation job harder. Each function inside STASHLOG contains a\njump list of every node in the function:\n\n_Part of a Jump List from a function in STASHLOG_\n\nThis jump list is then used as a flow control during the function execution. In some cases the\naddress of the next node will be pushed to a register and then there will be a JMP to this\nregister:\n\n\n-----\n\n_Jump_\n\n_to register_\n\nThe more interesting use of the jump list is replacing the conditional jump commands like JZ\nand JNZ with a SET command that changes the register given as an argument to the value of\nthe corresponding checked flag. For example, when using SETZ eax, the EAX register will be\nchanged to “1” if the “0” flag is checked.\n\nUsing the set register, there will be a JMP to an address on the function’s jump list. This JMP is\nusually resolved for a switch-case mechanism, and IDA Pro disassembles it as one:\n\n\n-----\n\n_Example of jmp usage in IDA Pro_\n\nUsing this method, the disassembler displays all the available JMP options based on the\nfunction’s jump list even though there are only two jump options - when the assigned register is\neither 0 or 1 (in the example above it’s the ECX register). These methods make the\ndisassembled function very hard to read and investigate:\n\n\n-----\n\n_Single function_\n\n_tree as could be seen in IDA Pro_\n\n### SPARKLOG: Deploying PRIVATELOG, the Next Link in the Infection Chain\n\n[SPARKLOG (spark.exe) is a 32 bit executable written in C++, employed in this attack to extract](https://twitter.com/ESETresearch/status/1433819571207774209?s=20&t=vQjvuSCLkka_ZKrngChcYg)\na DLL from the CLFS file, decrypt it and then launch it for side-loading by Windows services\nrunning as SYSTEM. Executing this phase of the attack successfully enables the attackers to\n\n\n-----\n\ngain [Privilege Escalation and also](https://attack.mitre.org/tactics/TA0004/) [Persistence in a specific case.](https://attack.mitre.org/tactics/TA0003/)\n\n**SPARKLOG Execution Flow**\n\nThe execution of SPARKLOG starts by creating a non-visible window followed by a message\nposted to trigger the execution of the main thread:\n\n_Non-visible window creation_\n\nThe PE then retrieves an encrypted DLL content from the CLFS log file, decrypts it and gets the\nOS version in use. This OS version will be required later to understand how to deploy the DLL\nin the compromised machine. Then, it decrypts the strings Global\\HVID_ and Global\\APCI#.\nFirst, it uses the GetVolumeNameForVolumeMountPointA API call to get the GUID of the\noperating system volume and acquires a handle to a HVID <OS Volume GUID> event\n\n\n-----\n\nThen, it queries the MachineGUID value from the registry\n_HKLM\\SOFTWARE\\Microsoft\\Cryptography key and creates an event by the name of_\n_Global\\APCI#<Machine GUID>. Using these events is a means of communication between the_\nmodules in the attack, and it will be used in further modules as well:\n\n_Building the HVID_ and APCI# events_\n\nNext, it starts to deploy PRIVATELOG based on the OS version. From Windows Vista to\nWindows 7, SPARKLOG uses a popular DLL side loading technique that involves dropping the\nDLL with the name wlbsctrl.dll to the %SYSTEM32%\\WindowsPowershell\\v1.0 directory. It then\nstops [IKEEXT, a service that was compromised by WINNTI in the](https://github.com/securycore/Ikeext-Privesc) [past, changes the](https://speakerdeck.com/aragorntseng/winnti-is-coming-evolution-after-prosecution-at-hitcon2021?slide=23)\nconfiguration using ChangeServiceConfigA based on the argument count, then starts it again:\n\n_Stopped IKEEXT service_\n\n\n-----\n\n_Change IKEEXT service configuration based on argument count_\n\nAfter a successful service start, the service executes and triggers the DLL side-loading\nvulnerability using SYSTEM privileges. It is interesting to note that in this case, if a command\nline argument is provided, the DLL will be deleted after the execution starts. This might be due\nto the fact that [abusing wlbsctrl.dll is pretty common, and might trigger EDR vendors later on.](http://elastic.co/guide/en/security/current/suspicious-dll-loaded-for-persistence-or-privilege-escalation.html)\n\nFrom Windows Server 2012 to Windows 10, SPARKLOG acts in a similar fashion, but with a\ndifferent name and location:\n\nIt drops PRIVATELOG with the name prntvpt.dll to the %SYSTEM32%\\spool\\drivers\\x64\\3\ndirectory\nIt then stops, changes configuration and starts the PrintNotify service to side-load the DLL\n(PrintNotify is a legitimate Windows service like IKEEXT, also running as SYSTEM):\n\n_Opening and querying the PrintNotify service_\n\nIn both cases, the attackers gain stealth by deploying PRIVATELOG while masquerading\nlegitimate file names in privileged locations, as well as gaining persistence and privilege\nescalation to execute their next step as SYSTEM, the most privileged user in a local machine:\n\n\n-----\n\n_Spark.exe execution as seen in Cybereason’s XDR Platform_\n\n### PRIVATELOG: Extracting and Deploying DEPLOYLOG\n\n[PRIVATELOG is a module that exists in 2 forms:](https://www.mandiant.com/resources/unknown-actor-using-clfs-log-files-for-stealth)\n\n_Wlbsctrl.dll: A DLL to be side-loaded by the IKEEXT service, aiming to execute on_\nWindows Vista to Windows 7 operating systems.\n_Prntvpt.dll: A DLL to be side loaded by the PrintNotify service, aiming to execute on_\nWindows Server 2012 to Windows 10 operating systems.\n\nAs both of the DLLs are being loaded by native Windows services, they both live in the context\nof the [svchost process, but differ in their execution flow.](https://en.wikipedia.org/wiki/Svchost.exe)\n\n**The IKEEXT Hijacker**\n\nAt the beginning of its execution, wlbsctrl.dll is loaded by the IKEEXT service and verifies\nsimilarly to prntvpt.dll that it’s being executed from svchost using the right command line\n(netsvcs). After this check, wlbsctrl.dll goes straight to dropping DEPLOYLOG.\n\n**The PrintNotify Hijacker**\n\n\n-----\n\nAt the beginning of its execution, prntvpt.dll verifies it is being loaded by the correct process\nwith the right command line (svchost -k print), similar to wlbsctrl.dll. This command line is the\none being executed upon starting the PrintNotify service.\n\nWhen the PrintNotify service starts, it also loads PrintConfig.dll, which is being executed from\nits ServiceMain function. To hijack the execution flow, prntvpt.dll loads PrintConfig.dll and\nacquires the address of its ServiceMain function. Then, it patches this function, and adds a\njump instruction to itself, to continue its execution.\n\nThe prntvpt.dll component is different, as it is also the persistence tool for the infection, as\nopposed to the previous samples we discussed which execute only once to infect the machine,\nthis tool runs every time the PrintNotify service is executed. From this point on, the different\nDLL files act almost the same.\n\n**Dropping DEPLOYLOG**\n\nPRIVATELOG decrypts DEPLOYLOG in memory from the CLFS log file, then it copies\n_dbghelp.dll from its original place in C:\\Windows\\System32\\dbghelp.dll to_\n_C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\dbghelp.dll. Next, the attackers use a rather_\nunique technique to overwrite the copied dbghelp.dll with the aforementioned decrypted buffer\nusing [Windows Transactional NTFS (TxF).](https://docs.microsoft.com/en-us/windows/win32/fileio/transactional-ntfs-portal)\n\nTransactional NTFS is a component introduced in Windows Vista that allows developers to\ncreate, edit and delete files and directories while giving them the option to roll back in case of\nerrors. This mechanism is used in major operating system components like Windows Update,\nTask Scheduler and System Restore.\n\nUsing Transactional NTFS, the attackers can perform file operations using unconventional\nmethods that can be hard to detect for some security products. They leverage it to create a new\nmalicious dbghelp.dll using the following steps:\n\n\n-----\n\n1.\n\n1. A transaction handle is created for dbghelp.dll:\n\n_CreateTransaction: Creates a new transaction object_\n_CreateFileTransactedA: with GENERIC_READ_WRITE access._\n2. The file is overwritten with the decrypted payload:\n\n_WriteFile: On the transacted file handle._\n[3. Load the file to a memory section (more about this method is covered here):](https://www.ired.team/offensive-security/code-injection-process-injection/ntcreatesection-+-ntmapviewofsection-code-injection)\n\n_NtCreateSection: with the SEC_IMAGE section attribute._\n_NtMapViewOfSection: Mapping the file view in the created section which_\nvalidates the PE header and splits the section, but doesn’t build the import\naddress table and set section permissions.\n4. Set the right section permissions and resolve the imports of the DLL:\n\nFixing section permissions using VirtualProtect calls.\nBuilding the DLL’s import address table with LoadLibrary and GetProcAddress\ncalls.\n5. Execute the DEPLOYLOG payload entry point followed by the SvcMain.\n\n### DEPLOYLOG: The Winnti Rootkit Deployment and A Usermode Agent\n\nDEPLOYLOG (dbghelp.dll) is a 64 bit DLL, with two purposes:\n\nThe first one is responsible for extracting and executing the attackers’ rootkit, dubbed\nWINNKIT, from the CLFS log file.\nAfter a successful deployment of the WINNKIT rootkit, DEPLOYLOG switches to its\nsecond task, which is communicating both with the remote C2 and the kernel-level\nrootkit.\n\n\n-----\n\nIt s noteworthy to mention that to evade detection, the attackers deployed DEPLOYLOG as\n_dbghelp.dll, a generic, widely used name leveraged to masquerade as a legitimate file at the_\nsame location as PRIVATELOG (C:\\Windows\\System32\\WindowsPowerShell\\v1.0).\n\n**DEPLOYLOG Initialization**\n\nOnce DEPLOYLOG is executed, it starts with a sleep of 7777 milliseconds:\n\n_Figure #: Sleep_\n\n_before the main method_\n\nAfterward, it tries to acquire a handle to the earlier HVID_<OS Volume GUID> event, and If it\ndoesn’t exist it creates it. Then, it initializes the communication channel with the future deployed\nrootkit:\n\nFirst, it tries to acquire a handle to the Beep device object: \\\\?\n_\\GLOBALROOT\\Device\\Beep._\nIf it fails, it tries to do the same for \\\\?\\GLOBALROOT\\Device\\Null. To test if the rootkit\n[was deployed in the past and is running, DEPLOYLOG tries to send the IOCTL 15E030 to](https://en.wikipedia.org/wiki/Ioctl)\nthe acquired device handle:\n\n\n-----\n\n_DEPLOYLOG gets handles to device objects and sends an IOCTL_\n\n**WINNKIT Deployment**\n\nUpon succeeding the earlier steps, DEPLOYLOG extracts the rootkit from the CLFS log file,\ndecrypts its content, then stops the _[amdk8 service. This service is the AMD K8 processor](http://revertservice.com/7/amdk8/)_\nkernel driver service. Aiming for this specific service can tell something about the Winnti modus\noperandi, indicating they aim only for AMD-related machines to be infected, which could also\nindicate having a prior knowledge of the victim's infrastructure.\n\nThen, DEPLOYLOG decrypts the string SystemRoot\\System32\\drivers\\bqDsp.sys and changes\nthe amdk8 service configuration to point to this path:\n\n\n-----\n\n_Changing amdk8 service configuration to execute WINNKIT_\n\nNext, DEPLOYLOG writes the bqDsp.sys rootkit driver from the CLFS log file to the\n_C:\\WINDOWS\\system32\\drivers directory and starts the service again, this time to execute its_\nmalicious payload. By doing so, DEPLOYLOG finishes deploying the rootkit. To cover its tracks,\nDEPLOYLOG will then stop the service, restore its previous configuration to point to the\n_amdk8.sys driver, and finally delete WINNKIT:_\n\n\n-----\n\n_Sending WINNKIT the IOCTL 0x8000C004 using Pipe2PortCtrl_\n\n**DEPLOYLOG as a User-Mode Agent**\n\nOnce deployed, DEPLOYLOG turns to its second mission, effectively acting as a user-mode\nagent whose purpose is to bridge the newly deployed rootkit and the remote C2. The DLL will\nstart communicating with the C2 servers which will send data that will be intercepted by the\ndriver, as will be explained in the next section discussing WINNKIT. Using this agent, the\nattackers will load new modules, pop a CMD shell, drop MFSDLL.exe for credential grabbing\nand more:\n\n_DEPLOYLOG loaded by svchost.exe as seen in the Cybereason XDR Platform_\n\n\n-----\n\n### Behold WINNKIT, The Evasive Winnti Rootkit\n\nThe final payload deployed by Winnti is also the most evasive and sophisticated: a driver acting\n[as a rootkit, dubbed WINNKIT. WINNKIT’s previous version was researched in the past, and its](https://exatrack.com/public/winnti_EN.pdf)\npurpose is to act as a kernel-mode agent, interacting with the user-mode agent and intercepting\nTCP/IP requests, by talking directly to the network card. The almost zero detection rate in\nVirusTotal, together with the compilation timestamp from 2019, illustrates just how evasive this\nrootkit really is, staying in the shadows for 3 years:\n\n_Low detection rate in VirusTotal_\n\n\n-----\n\n_The_\n\n_rootkit’s compilation timestamp_\n\nWINNKIT contains an expired BenQ digital signature, which is leveraged to bypass the Driver\nSignature Enforcement (DSE) mechanism that requires drivers to be properly signed with\ndigital signatures in order to be loaded successfully. This mechanism was first introduced in\nWindows Vista 64-bit, and is affected for all versions of Windows since then:\n\n_Revoked rootkit certificate and file version_\n\n_information as seen in VirusTotal_\n\nAfter successfully loading, WINNKIT hooks network communication, and operates based on\ncustom commands that are being sent from the aforementioned user-mode agent,\nDEPLOYLOG.\n\n[At the beginning of its execution, the driver validates the NDIS version, making sure the system](https://docs.microsoft.com/en-us/windows-hardware/drivers/network/ndis-drivers)\nis Windows Vista or above. By using the NDIS API, it communicates directly with the network\ncard, skipping higher level communication protocols:\n\n\n-----\n\n_WINNKIT’s communication with the network card_\n\nAfter establishing a connection with the network card, the rootkit tries to open the event\n_\\\\BaseNamedObjects\\\\{75F09225-CD50-460B-BF90-5743B8404D73}. In case it fails, it creates_\nthis event, and then hooks the \\\\Device\\\\Null device. Hooking this device is somehow risky, as\nthis device is often being targeted by modern rootkit, thus making it relatively exposed to\ndetection. Nevertheless, it enabled the authors to stay undetected for years.\n\nUsing the above mentioned mechanisms enables WINNKIT a mean of communication with the\nuser mode agent:\n\n\n-----\n\n_WINNKIT event creation_\n\n_WINNKIT hooks the \\\\Device\\\\Null device object_\n\n\n-----\n\n_The switch case that handling different commands_\n\nA summary of the communication flow of DEPLOYLOG and WINNKIT, can be seen in the\nfollowing diagram:\n\n\n-----\n\n_Rootkit high level operation diagram_\n\nBelow are the functionality we believe that each code represents, according to our findings and\nprevious conducted research:\n\n**Command** **Operation**\n\n0x100 Hide driver\n\n0x200 Determine version\n\n0x300 Access IRQL shared data\n\n0x400 Map and allocate buffer\n\n\n-----\n\n0x500 Map a buffer\n\n0x800 Clean up\n\n### Winnti Auxiliary Plugins\n\nWinnti used reflective loading injection in order to evade detection. The malicious modules are\nreflectively injected into the legitimate svchost processes. The following modules were detected\n[by Cybereason and seem consistent with previously reported Winnti plugins:](https://securelist.com/winnti-1-0-technical-analysis/37002/)\n\n**Cmp2.o: The plugin's purpose is to provide access to the system command line and**\nappears to be a variant of the Winnti \"CmdPlus\" plugin.\n**Fmg2.o: This plugin is responsible for listing and modifying files on the targeted machine**\nand appears to be the Winnti \"ListFileManager\" module.\n**Srv2.o: The purpose of the plugin is to display information about system services and is**\nassessed to be the Winnti “ListService” plugin.\n**Sck2.o: The purpose of the plugin is to transfer data over the network using a SOCKS5**\nproxy server and is assessed to be the “Socks5Client” plugin.\n**Prc2.o: This plugin can list or kill running processes on the targeted machine.**\n**Trs2.o: This plugin was also used for data transfer via Socks5 proxy.**\n**Cme2.o: The purpose of this plugin is to enable Remote Desktop access to Winnti:**\n\n_Example: svchost process that loaded sck2.o and trs2.o modules reflectively, as seen in the_\n_Cybereason XDR Platform_\n\n## Conclusions\n\n\n-----\n\nIn part two of the research, we provided a deep dive into the Winnti malware arsenal that was\nobserved by the Cybereason IR and Nocturnus teams. Our analysis provides a unique and\nholistic view of Winnti operational aspects, capabilities and modus operandi. While some of the\ntools mentioned in the research were previously reported on, some tools such as DEPLOYLOG\nwere previously undocumented and first analyzed in this report. In addition, our analysis\nprovides further insights regarding some of the known Winnti tools.\n\nPerhaps one of the most interesting things to notice is the elaborate and multi-phased infection\nchain Winnti employed. The malware authors chose to break the infection chain into multiple\ninterdependent phases, where each phase relies on the previous one in order to execute\ncorrectly. This demonstrates the thought and effort that was put into both the malware and\noperational security considerations, making it almost impossible to analyze unless all pieces of\nthe puzzle are assembled in the correct order.\n\nFurthermore, the rare abuse of the Windows’ own CLFS logging system and NTFS\nmanipulations provided the attackers with extra stealth and the ability to remain undetected for\nyears.\n\nWe hope that this report helps to shed light on Winnti operations, tools and techniques, and that\nit will assist to expose further intrusions.\n\n## Acknowledgments\n\nThis research has not been possible without the tireless effort, analysis, attention to details and\ncontribution of the Cybereason Incident Response team. Special thanks and appreciation goes\nto Matt Hart, Yusuke Shimizu, Niamh O’Connor, Jim Hung, and Omer Yampel.\n\n## Indicators of Compromise\n\n_LOOKING FOR THE IOCs? CLICK ON THE CHATBOT DISPLAYED IN LOWER-RIGHT OF_\n_YOUR SCREEN FOR ACCESS. Due to the sensitive nature of the attack, not all IOCs_\n_observed by Cybereason can be shared in our public report. Please contact us for more_\n_information._\n\n## MITRE ATT&CK BREAKDOWN\n\n\n**Reconnaissance** **Initial**\n**Access**\n\n\n**Execution** **Persistence** **Privilege**\n**Escalation**\n\n\n**Defense**\n**Evasion**\n\n\n-----\n\nGather Victim\nIdentity\nInformation:\nCredentials\n\nGather Victim\n[Network](https://attack.mitre.org/techniques/T1590/)\nInformation\n\n\nExploit\nPublicFacing\nApplication\n\nSupply\nChain\nCompromise\n\n\nScheduled\nTask/Job\n\nInter-process\ncommunication\n\nExploitation for\nClient\nExecution\n\nCommand and\nScripting\nInterpreter:\nWindows\nCommand\nShell\n\nCommand and\nScripting\nInterpreter:\nVisual Basic\n\n\nServer\nSoftware\nComponent:\nWeb Shell\n\nScheduled\nTask/Job:\nScheduled\nTask\n\nValid\nAccounts:\nDomain\nAccounts\n\n\nCreate or\nModify\nSystem\nProcess:\nWindows\nService\n\nHijack\nExecution\n[Flow: DLL](https://attack.mitre.org/techniques/T1574/002/)\nSideLoading\n\nProcess\nInjection:\n[Dynamic-](https://attack.mitre.org/techniques/T1055/001/)\nlink Library\nInjection\n\nScheduled\nTask/Job:\nScheduled\nTask\n\nValid\nAccounts:\nDomain\nAccounts\n\nValid\nAccounts:\nLocal\nAccounts\n\n\nHijack\nExecution\nFlow: DLL\nSide-Loading\n\n[Rootkit](https://attack.mitre.org/techniques/T1014/)\n\nMasquerading:\nMatch\n[Legitimate](https://attack.mitre.org/techniques/T1036/005/)\nName or\nLocation\n\nProcess\nInjection:\n[Dynamic-link](https://attack.mitre.org/techniques/T1055/001/)\nLibrary\nInjection\n\nReflective\nCode Loading\n\nSigned Binary\nProxy\nExecution:\nRundll32\n\nValid\nAccounts:\nDomain\nAccounts\n\nValid\nAccounts:\nLocal\nAccounts\n\n\n[Native API](https://attack.mitre.org/techniques/T1106/) Valid\nAccounts:\nLocal\nAccounts\n\n\n-----\n\n**Credential**\n**Access**\n\nOS\n[Credential](https://attack.mitre.org/techniques/T1003/)\nDumping\n\n\n**Discovery** **Lateral**\n**movement**\n\n\nSystem\nNetwork\nConfiguration\nDiscovery\n\nRemote\n[System](https://attack.mitre.org/techniques/T1018/)\nDiscovery\n\nPassword\n[Policy](https://attack.mitre.org/techniques/T1201/)\nDiscovery\n\nPermission\n[Groups](https://attack.mitre.org/techniques/T1069/)\nDiscovery\n\nNetwork Share\nDiscovery\n\nSystem\n[Service](https://attack.mitre.org/techniques/T1007/)\nDiscovery\n\nSystem Time\nDiscovery\n\nSystem\nNetwork\nConnections\nDiscovery\n\nAccount\nDiscovery\n\n\n**Collection** **Exfiltration** **Command**\n**and**\n**Control**\n\n\nExploitation of\n[Remote](https://attack.mitre.org/techniques/T1210/)\nServices\n\nRemote\nServices:\n[Remote](https://attack.mitre.org/techniques/T1021/001/)\nDesktop\nProtocol\n\n\nArchive\nCollected\nData: Archive\nvia Utility\n\nAutomated\nCollection\n\n\nAutomated\nExfiltration\n\n\nApplication\nLayer\n[Protocol:](https://attack.mitre.org/techniques/T1071/001/)\nWeb\nProtocols\n\n[Proxy](https://attack.mitre.org/techniques/T1090/)\n\n\n-----\n\nSystem\n[Owner/User](https://attack.mitre.org/techniques/T1033/)\nDiscovery\n\nSystem\n[Information](https://attack.mitre.org/techniques/T1082/)\nDiscovery\n\nProcess\nDiscovery\n\n## About the Researchers:\n\n**Chen Erlich**\n\nChen has almost a decade of experience in Threat Intelligence & Research, Incident Response\nand Threat Hunting. Before joining Cybereason, Chen spent three years dissecting APTs,\ninvestigating underground cybercriminal groups and discovering security vulnerabilities in\nknown vendors. Previously, he served as a Security Researcher in the IDF.\n\nFusao Tanida\n\nFusao spent over 10 years in the security industry. Before joining, he worked as a mobile\nmalware researcher and a developer at the security vendor and then worked at the global\nmobile phone manufacturer for the development of AntiVirus, VPN client on their Android\nmobile phone\n\n\n-----\n\nFusao joined Cybereason in 2019 and was previously the Senior Security Analyst at the\nAdvanced Services Team in Cybereason Japan where delivered various security professional\nservices, Incident Response, consultation and triage malware activity alerts in SOC.\n\nOfir Ozer\n\nOfir is a Incident Response Engineer at Cybereason who has a keen interest in Windows\nInternals, reverse engineering, memory analysis and network anomalies. He has years of\nexperience in Cyber Security, focusing on Malware Research, Incident Response and Threat\nHunting. Ofir started his career as a Security Researcher in the IDF and then became a\nmalware researcher focusing on Banking Trojans.\n\nAkihiro Tomita\n\nAkihiro is the Senior Manager of Global Security Practice, leading Incident Response team in\nthe APAC region and Japan. Akihiro has led a substantial number of large-scale Incident\nResponse, Digital Forensics and Compromise Assessment engagements during recent years.\nAkihiro was also a former Team lead of Advanced Security Services team responsible for\nmanaging, developing, delivering a variety of professional services including Proactive threat\nhunting, Security Posture Assessment, Advanced security training and consulting services at\nCybereason.\n\n\n-----\n\nNiv Yona\n\nNiv, IR Practice Director, leads Cybereason's incident response practice in the EMEA region.\nNiv began his career a decade ago in the Israeli Air Force as a team leader in the security\noperations center, where he specialized in incident response, forensics, and malware analysis.\nIn former roles at Cybereason, he focused on threat research that directly enhances product\ndetections and the Cybereason threat hunting playbook, as well as the development of new\nstrategic services and offerings.\n\nDaniel Frank\n\nWith a decade in malware research, Daniel uses his expertise with malware analysis and\nreverse engineering to understand APT activity and commodity cybercrime attackers. Daniel\nhas previously shared research at RSA Conference, the Microsoft Digital Crimes Consortium,\nand Rootcon.\n\nASSAF DAHAN, HEAD OF THREAT RESEARCH\n\nAssaf has over 15 years in the InfoSec industry. He started his career in the Israeli Military 8200\nCybersecurity unit where he developed extensive experience in offensive security. Later in his\ncareer he led Red Teams, developed penetration testing methodologies, and specialized in\nmalware analysis and reverse engineering\n\n\n-----\n\n### Operation CuckooBees Indicators of Compromise (IOCs)\n\n**Hashes**\n\nBB93AE0FEE817FE56C31BDC997F3F7D57A48C187 - STASHLOG\n4D1B8791D0715FE316B43FC95BDC335CB31A82CA - STASHLOG\n2D336978AF261E07B1ECFAF65DC903B239E287A4 - STASHLOG\nF2D04FE529E2D8DAB96242305255CFB84CE81E9C - STASHLOG\nF8D46895E738254238473D650D99BDC92C34EE44 - SPARKLOG\n9267FE0BB6D367FC9186E89EA65B13BAA7418D87 - PRIVATELOG\nA009A0F5A385683AEA74299CBE6D5429C609F2D2 - PRIVATELOG\n1316F715D228AE6CC1FBA913C6CC309861F82E14 - PRIVATELOG\n1275894D8231FE25DB56598DDCF869F88DF5AD8D - WINNKIT\n9139C89B2B625E2CEEE2CBF72AEF6C5104707A26 - WINNKIT\n082DBCA2C3CA5C5410DE9951A5C681F0C42235C8 - WINNKIT\n\n**File Names & Paths**\n\nC:\\Windows\\temp\\bc.bat\nC:\\Windows\\AppPatch\\Custom\\Custom64\\cc.bat\nC:\\Windows\\temp\\cc.log\nC:\\Windows\\AppPatch\\Custom\\Custom64\\log.dat\nC:\\Windows\\Branding\\Basebrd\\x64.tlb\nC:\\Windows\\Branding\\Basebrd\\language.dll\nC:\\Windows\\System32\\mscuplt.dll\nC:\\Windows\\System32\\rpcutl.dll\nC:\\Windows\\System32\\dot3utl.dll\nC:\\Windows\\System32\\iumatl.dll\nC:\\Windows\\System32\\Nlsutl.dll\nC:\\Windows\\System32\\WindowsPowerShell\\v1.0\\dbghelp.dll\nC:\\Windows\\System32\\drivers\\bqDsp.sys\nC:\\Windows\\apppatch\\en-us\\MFSDLL.exe\nC:\\Windows\\System32\\spool\\drivers\\x64\\3\\prntvpt.dll\nC:\\Windows\\System32\\WindowsPowerShell\\v1.0\\wlbsctrl.dll\nC:\\Windows\\assembly\\gac_msil\\dfsvc\\foserv.exe\nC:\\Windows\\assembly\\temp\\foserv.exe\nC:\\Windows\\apppatch\\custom\\custom64\\shiver.exe\nC:\\Windows\\apppatch\\custom\\custom64\\spark.exe\nmktzx64.dll\n\n**Winnti Malware Modules Names**\n\nCmp2.o\nFmg2.o\nSrv2.o\n\n\n-----\n\nSck2.o\nPrc2.o\nTrs2.o\nCme2.o\n\n**Events**\n\n\\BaseNamedObjects\\{75F09225-CD50-460B-BF90-5743B8404D73}\n\\BaseNamedObjects\\{7D0DF5FC-3991-4047-921F-32308B1A0459}\n\\BaseNamedObjects\\{B73AB0F4-A1D0-4406-9066-41E00BA78E9F}\nGlobal\\APCI#<GUID>\nGlobal\\HVID_<GUID>\n\n**Named Pipes**\n\nPipe2PortCtrl\n\n**Scheduled Task Name**\n\ntest\n\nAbout the Author\n\n**Cybereason Nocturnus**\n\nThe Cybereason Nocturnus Team has brought the world’s brightest minds from the military,\ngovernment intelligence, and enterprise security to uncover emerging threats across the globe.\nThey specialize in analyzing new attack methodologies, reverse-engineering malware, and\nexposing unknown system vulnerabilities. The Cybereason Nocturnus Team was the first to\nrelease a vaccination for the 2017 NotPetya and Bad Rabbit cyberattacks.\n\n[All Posts by Cybereason Nocturnus](https://www.cybereason.com/blog/authors/cybereason-nocturnus)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-05-04 - Operation CuckooBees- A Winnti Malware Arsenal Deep-Dive.pdf"
    ],
    "report_names": [
        "2022-05-04 - Operation CuckooBees- A Winnti Malware Arsenal Deep-Dive.pdf"
    ],
    "threat_actors": [
        {
            "id": "d90307b6-14a9-4d0b-9156-89e453d6eb13",
            "created_at": "2022-10-25T16:07:23.773944Z",
            "updated_at": "2025-03-27T02:02:09.974695Z",
            "deleted_at": null,
            "main_name": "Lead",
            "aliases": [
                "Casper",
                "TG-3279"
            ],
            "source_name": "ETDA:Lead",
            "tools": [
                "Agentemis",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "RbDoor",
                "RibDoor",
                "Winnti",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "5bbced13-72f7-40dc-8c41-dcce75bf885e",
            "created_at": "2022-10-25T15:50:23.695735Z",
            "updated_at": "2025-03-27T02:00:55.525839Z",
            "deleted_at": null,
            "main_name": "Winnti Group",
            "aliases": [
                "Winnti Group"
            ],
            "source_name": "MITRE:Winnti Group",
            "tools": [
                "PipeMon",
                "Winnti for Windows",
                "PlugX"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "945a572f-ebe3-4e2f-a288-512fe751cfa8",
            "created_at": "2022-10-25T16:07:24.413971Z",
            "updated_at": "2025-03-27T02:02:10.212853Z",
            "deleted_at": null,
            "main_name": "Winnti Group",
            "aliases": [
                "Wicked Panda",
                "Winnti Group"
            ],
            "source_name": "ETDA:Winnti Group",
            "tools": [
                "Agentemis",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "FunnySwitch",
                "RbDoor",
                "RibDoor",
                "RouterGod",
                "Winnti",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "4c68ccd0-caba-4189-9ead-86ac4c2d9b70",
            "created_at": "2024-05-01T02:03:07.930196Z",
            "updated_at": "2025-03-27T02:05:17.251237Z",
            "deleted_at": null,
            "main_name": "BRONZE ATLAS",
            "aliases": [
                "Axiom",
                "BARIUM ",
                "Blackfly ",
                "CTG-2633",
                "GREF",
                "Group 72 ",
                "Red Kelpie ",
                "TG-2633 ",
                "Wicked Panda ",
                "Winnti",
                "APT41 "
            ],
            "source_name": "Secureworks:BRONZE ATLAS",
            "tools": [
                " CCleaner v5.33 backdoor",
                " ChinaChopper",
                " Cobalt Strike",
                " Dicey MSDN",
                " ForkPlayground",
                " HUC Proxy Malware (Htran)",
                " Mimikatz",
                " PipeMon",
                " PlugX",
                " PortReuse",
                " Powershell Empire",
                " RCMD",
                " RbDoor",
                " SPEEDBOAT",
                " ShadowPad",
                " Sidewalk",
                " Speculoos",
                " TeamViewer",
                " Winnkit",
                " Winnti",
                " reg save",
                " vssadmin",
                "Acehash"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "c7d9878a-e691-4c6f-81ae-84fb115a1345",
            "created_at": "2022-10-25T16:07:23.359506Z",
            "updated_at": "2025-03-27T02:02:09.752427Z",
            "deleted_at": null,
            "main_name": "APT 41",
            "aliases": [
                "BrazenBamboo",
                "Bronze Atlas",
                "Double Dragon",
                "Earth Baku",
                "Grayfly",
                "Operation ColunmTK",
                "Operation CuckooBees",
                "Operation ShadowHammer",
                "Red Kelpie",
                "SparklingGoblin",
                "TA415",
                "TG-2633"
            ],
            "source_name": "ETDA:APT 41",
            "tools": [
                "9002 RAT",
                "ADORE.XSEC",
                "ASPXSpy",
                "ASPXTool",
                "AceHash",
                "Agent.dhwf",
                "Agentemis",
                "AndroidControl",
                "AngryRebel",
                "AntSword",
                "BIOPASS",
                "BIOPASS RAT",
                "BLUEBEAM",
                "Barlaiy",
                "BlackCoffee",
                "Bladabindi",
                "BleDoor",
                "CCleaner Backdoor",
                "CHINACHOPPER",
                "COLDJAVA",
                "China Chopper",
                "ChyNode",
                "Cobalt Strike",
                "CobaltStrike",
                "Crackshot",
                "CrossWalk",
                "CurveLast",
                "CurveLoad",
                "DAYJOB",
                "DBoxAgent",
                "DEADEYE",
                "DEADEYE.APPEND",
                "DEADEYE.EMBED",
                "DEPLOYLOG",
                "DIRTCLEANER",
                "DUSTTRAP",
                "Derusbi",
                "Destroy RAT",
                "DestroyRAT",
                "DodgeBox",
                "DragonEgg",
                "ELFSHELF",
                "EasyNight",
                "Farfli",
                "FunnySwitch",
                "Gh0st RAT",
                "Ghost RAT",
                "HDD Rootkit",
                "HDRoot",
                "HKDOOR",
                "HOMEUNIX",
                "HUI Loader",
                "HidraQ",
                "HighNoon",
                "HighNote",
                "Homux",
                "Hydraq",
                "Jorik",
                "Jumpall",
                "KEYPLUG",
                "Kaba",
                "Korplug",
                "LATELUNCH",
                "LOLBAS",
                "LOLBins",
                "LightSpy",
                "Living off the Land",
                "Lowkey",
                "McRAT",
                "MdmBot",
                "MessageTap",
                "Meterpreter",
                "Mimikatz",
                "MoonBounce",
                "MoonWalk",
                "Motnug",
                "Moudour",
                "Mydoor",
                "NTDSDump",
                "PACMAN",
                "PCRat",
                "PINEGROVE",
                "PNGRAT",
                "POISONPLUG",
                "POISONPLUG.SHADOW",
                "POTROAST",
                "PRIVATELOG",
                "PipeMon",
                "PlugX",
                "PortReuse",
                "ProxIP",
                "ROCKBOOT",
                "RbDoor",
                "RedDelta",
                "RedXOR",
                "RibDoor",
                "Roarur",
                "RouterGod",
                "SAGEHIRE",
                "SPARKLOG",
                "SQLULDR2",
                "STASHLOG",
                "SWEETCANDLE",
                "ScrambleCross",
                "Sensocode",
                "SerialVlogger",
                "ShadowHammer",
                "ShadowPad Winnti",
                "SinoChopper",
                "Skip-2.0",
                "SneakCross",
                "Sogu",
                "Speculoos",
                "Spyder",
                "StealthReacher",
                "StealthVector",
                "TERA",
                "TIDYELF",
                "TIGERPLUG",
                "TOMMYGUN",
                "TVT",
                "Thoper",
                "Voldemort",
                "WIDETONE",
                "WINNKIT",
                "WINTERLOVE",
                "Winnti",
                "WyrmSpy",
                "X-Door",
                "XDOOR",
                "XMRig",
                "XShellGhost",
                "Xamtrav",
                "ZXShell",
                "ZoxPNG",
                "certutil",
                "certutil.exe",
                "cobeacon",
                "gresim",
                "njRAT",
                "pwdump",
                "xDll"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "4d5f939b-aea9-4a0e-8bff-003079a261ea",
            "created_at": "2023-01-06T13:46:39.04841Z",
            "updated_at": "2025-03-27T02:00:02.985296Z",
            "deleted_at": null,
            "main_name": "APT41",
            "aliases": [
                "G0096",
                "Grayfly",
                "BARIUM",
                "BRONZE ATLAS",
                "BRONZE EXPORT",
                "Red Kelpie",
                "HOODOO",
                "Brass Typhoon",
                "TA415",
                "WICKED SPIDER",
                "WICKED PANDA",
                "G0044",
                "Earth Baku"
            ],
            "source_name": "MISPGALAXY:APT41",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673536204,
    "ts_updated_at": 1743041757,
    "ts_creation_date": 1653697689,
    "ts_modification_date": 1653697689,
    "files": {
        "pdf": "https://archive.orkl.eu/9c4887304a34b7a24f922f2e2c9b898a4d0df049.pdf",
        "text": "https://archive.orkl.eu/9c4887304a34b7a24f922f2e2c9b898a4d0df049.txt",
        "img": "https://archive.orkl.eu/9c4887304a34b7a24f922f2e2c9b898a4d0df049.jpg"
    }
}