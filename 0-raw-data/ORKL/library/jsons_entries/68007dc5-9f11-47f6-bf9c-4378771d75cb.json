{
    "id": "68007dc5-9f11-47f6-bf9c-4378771d75cb",
    "created_at": "2022-10-25T16:48:20.304351Z",
    "updated_at": "2025-03-27T02:09:30.325827Z",
    "deleted_at": null,
    "sha1_hash": "26d978c0a67531862a41f9706f6bb722fdc60423",
    "title": "",
    "authors": "",
    "file_creation_date": "0001-01-01T00:00:00Z",
    "file_modification_date": "2014-09-13T09:12:55Z",
    "file_size": 7312601,
    "plain_text": "-----\n\n###### Information Security Consultant Incident Response, Penetration Testing\n\n\n###### Instructor SEC 560 & 542\n\n\n###### Royal Holloway, University of London Project: ATM Security assessment framework\n\n\n-----\n\n##### § About the project\n\n § ATM Introduction\n\n § Attacking the ATM\n\n § Common ATM system design\n\n § Assessing a sample ATM\n\n § Conclusion\n\n\n-----\n\n##### § About the project\n\n\n##### § ATM Introduction\n\n § Attacking the ATM\n\n § Common ATM system design\n\n § Assessing a sample ATM\n\n § Conclusion\n\n\n-----\n\n##### § “A security assessment framework for Automated\n\n### Teller Machines”\n\n##### § Finished it this year (2014)\n\n § Supervisor: Frederik Mennes\n\n\n-----\n\n-----\n\n##### § About the project\n\n\n##### § ATM Introduction\n\n\n##### § Attacking the ATM\n\n § Common ATM system design\n\n § Assessing a sample ATM\n\n § Conclusion\n\n\n-----\n\n### Automated Teller Machine\n\n Cash disposing & dispensing\n\n 2.2 million devices worldwide\n\n Different hardware & software vendors\n\n\n-----\n\n##### It was reintroduced in Ohio in 1959,\n with huge success.\n\n There are currently more then 2.2\n million ATM’s worldwide.\n\n\n##### The first ATM was installed in 1939 in New York City, known as “Bankograph”.\n\n Removed after 6 months because\n it was not used J\n\n\n##### J\n\n\n##### J\n\n\n-----\n\n##### The ATM is a “stupid” device, part of the bank’s overall architecture.\n It relies on back-end services for “important” decisions.\n\n\n-----\n\n### 1. ATM computer\n\n 2. (Touch)screen\n\n 3. Card-reader\n\n 4. PIN pad\n\n 5. Cash dispenser\n\n 6 Cash cassettes\n\n\n-----\n\n-----\n\n### ATM computer\n\n (Touch)screen\n\n Card-reader\n\n PIN pad\n\n Cash dispenser\n\n Cash cassettes\n\n\n-----\n\n-----\n\n##### § About the project\n\n § ATM Introduction\n\n § Attacking the ATM\n\n § Common ATM system design\n\n § Assessing a sample ATM\n\n § Conclusion\n\n\n-----\n\n-----\n\n### Handles interesting customer data as well, which could be abused to get MORE MONEY\n\n\n-----\n\n#### Blow up the safe\n\n Copy cards & steal PIN codes\n\n Steal the entire\n thing\n\n\n#### Attack back-end\n communication\n\n Attack the OS\n\n Access  “operator” mode\n\n\n#### ...\n\n\n-----\n\n#### Blow up the safe\n\n\n#### Attack back-end\n communication\n\n\n#### Copy cards & steal PIN codes\n\n\n#### Attack the OS\n\n\n#### Steal the entire\n thing\n\n\n#### Access  “operator” mode\n\n\n#### ...\n\n\n-----\n\n#### Attack back-end\n communication\n\n\n#### Attack the OS\n\n Access  “operator” mode\n\n\n#### Copy cards & steal PIN codes\n\n Steal the entire\n thing\n\n ...\n\n\n-----\n\n#### Copy cards & steal PIN codes\n\n Steal the entire\n thing\n\n ...\n\n\n-----\n\n#### communication\n\n ...\n\n\n#### Attack back-end\n communication\n\n Attack the OS\n\n Access  “operator” mode\n\n\n-----\n\n#### Copy cards &\n Attack the OS\n steal PIN codes\n\n Access \n Steal the entire “operator” mode\n thing\n\n ...\n\n\n-----\n\n-----\n\n#### Safe certification standards, bolts, video surveillance...\n\n\n-----\n\n-----\n\n#### Blow up the safe\n\n\n#### Copy cards & steal PIN codes\n\n\n#### Steal the entire\n thing\n\n\n#### Attack back-end\n communication\n\n Attack the OS\n\n Access  “operator” mode\n\n\n#### ...\n\n\n-----\n\n#### Blow up the safe\n\n\n#### Copy cards & steal PIN codes\n\n\n#### Steal the entire\n thing\n\n\n#### communication\n\n Attack the OS\n\n Access  “operator” mode\n\n\n#### ...\n\n\n-----\n\n#### Blow up the safe\n\n\n#### Copy cards & steal PIN codes\n\n\n#### Steal the entire\n thing\n\n\n#### communication\n\n Attack the OS\n\n Access  “operator” mode\n\n\n#### ...\n\n\n-----\n\n#### Blow up the safe\n\n\n#### Copy cards & steal PIN codes\n\n\n#### Steal the entire\n thing\n\n\n#### Attack back-end\n communication\n\n Attack the OS\n\n Access  “operator” mode\n\n ...\n\n\n-----\n\n#### Attack back-end\n communication\n\n Attack the OS\n\n Access  “operator” mode\n\n\n#### Steal the entire\n thing\n\n ...\n\n\n-----\n\n#### Attack back-end\n Blow up the safe\n communication\n\n Copy cards &\n Attack the OS\n steal PIN codes\n\n Access \n Steal the entire “operator” mode\n thing\n\n ...\n\n\n-----\n\n#### Anti-skimming devices\n\n\n-----\n\n-----\n\n#### Blow up the safe\n\n Copy cards & steal PIN codes\n\n Steal the entire\n thing\n\n\n#### Attack back-end\n communication\n\n\n#### Attack the OS\n\n\n#### Access  “operator” mode\n\n\n#### ...\n\n\n-----\n\n#### Attack back-end\n Blow up the safe\n communication\n\n Copy cards &\n Attack the OS\n steal PIN codes\n\n\n#### ...\n\n\n-----\n\n#### Attack back-end\n Blow up the safe\n communication\n\n Copy cards &\n Attack the OS\n steal PIN codes\n\n\n-----\n\n-----\n\n#### Blow up the safe\n\n Copy cards & steal PIN codes\n\n Steal the entire\n thing\n\n\n#### Attack back-end\n communication\n\n\n#### Attack the OS\n\n Access  “operator” mode\n\n\n#### ...\n\n\n-----\n\n#### Attack back-end\n communication\n\n\n#### Attack the OS\n\n Access  “operator” mode\n\n\n#### A\n Blow up the safe\n\n\n-----\n\n#### Attack back-end\n communication\n\n\n#### Attack the OS\n\n Access  “operator” mode\n\n\n#### Blow up the safe\n\n Copy cards & steal PIN codes\n\n Steal the entire\n thing\n\n\n#### ...\n\n\n-----\n\n#### Blow up the safe\n\n Copy cards & steal PIN codes\n\n Steal the entire\n thing\n\n\n#### “\n\n\n-----\n\n#### Blow up the safe\n communication\n\n Copy cards &\n Attack the OS\n steal PIN codes\n\n Access \n Steal the entire “operator” mode\n thing\n\n ...\n\n\n#### Network access?\n\n\n-----\n\n#### Blow up the safe\n communication\n\n Copy cards &\n Attack the OS\n steal PIN codes\n\n Shodan HQ (Internet search engine) lists 800+ ATMs\n Access \n available on the Internet\n Steal the entire “operator” mode\n thing\n\n ...\n\n\n#### Network access?\n\n Shodan HQ (Internet search engine) lists 800+ ATMs\n available on the Internet\n\n\n-----\n\n#### Attack back-end\n communication\n\n\n#### Attack the OS\n\n Access  “operator” mode\n\n\n#### Blow up the safe\n\n Copy cards & steal PIN codes\n\n\n#### Steal the entire\n CCC 2013\n thing\n “Electronic bank robberies”\n Boot ATMs from USB\n ...\n\n\n-----\n\n##### § About the project\n\n § ATM Introduction\n\n § Attacking the ATM\n\n\n##### § Common ATM system design\n\n\n##### § Assessing a sample ATM\n\n § Conclusion\n\n\n-----\n\n-----\n\n###### Vendor Independent\n\n Vendor Dependent\n\n\n#### CEN/XFS (eXtensions for Financial Services) provides a standard set\n of APIs that can be\n used by Windows applications to operate\n the ATM peripherals \n\n\n-----\n\n-----\n\n#### “How will you approach the Windows XP end-of-support?”\n\n###### (KAL 2013 – ATM Software Trends & Analysis)\n\n\n-----\n\n##### § About the project\n\n § ATM Introduction\n\n § Attacking the ATM\n\n § Common ATM system design\n\n\n##### § Assessing a sample ATM\n\n\n##### § Conclusion\n\n\n-----\n\n-----\n\n-----\n\n-----\n\n-----\n\n-----\n\n-----\n\n-----\n\n-----\n\n-----\n\n-----\n\n## Attack failed\n\n\n-----\n\n##### Using openly available forensic toolkits we managed to\n\n\n##### recover the majority of the original hard disk content.\n\n\n-----\n\n#### Sweet... But I don’t have a bank back-end (yet)\n\n\n-----\n\n-----\n\n-----\n\n-----\n\n###### WFSOpen(\"CurrencyDispenser1\", WFS_DEFAULT_HAPP, \"NVISOSPIT\", WFS_TRACE_NONE, WFS_INDEFINITE_WAIT, 0x0000FFFF, &serviceVersion, &spiVersion, &service);\n\n\n###### Set up XFS session with the\n “CurrencyDispenser1”, no\n logging is required J\n\n\n###### WFSCDMDISPENSE tDispense;\n\n\n###### Create a dispense object\n “tDispense”\n\n\n###### WFSCDMDENOMINATION tDenomination;\n\n\n###### Create a denomination object “tDenomination”\n\n\n-----\n\n###### tDispense.fwPosition =WFS_CDM_POSNULL; \n\n tDenomination.cCurrencyID[0]='E'; tDenomination.cCurrencyID[1]='U'; tDenomination.cCurrencyID[2]='R';\n\n\n###### tDispense.fwPosition =WFS_CDM_POSNULL; \n\n\n###### €€€\n\n I want “EUR” J\n\n\n###### tDenomination.ulAmount=nviso_amount;\n tDenomination.usCount=5; tDenomination.ulCashBox=0;\n\n\n###### The amount is specified dynamically by a command\n line argument\n\n\n###### ulaValues[0] =nviso_cassette1; ulaValues[1] =nviso_cassette2; ulaValues[2] =0;  ulaValues[3] =0;  ulaValues[4] =0;\n\n\n###### Specify how many notes you\n want per cassette\n\n\n-----\n\n###### tDenomination.lpulValues = ulaValues; tDispense.lpDenomination= &tDenomination;\n HRESULT hResult = WFSExecute(service,WFS_CMD_CDM_DISPENSE,&tDispense,WFS_INDEFINIT E_WAIT,&lpResult); \n\n\n###### Load the dispense with the specified denomination & execute the dispense operation\n\n\n-----\n\n-----\n\n###### TODO: Make it generic for different ATM devices\n (read custom config from registry J)\n\n\n-----\n\n# DEMONSTRATION\n\n\n-----\n\n##### § About the project\n\n § ATM Introduction\n\n § Attacking the ATM\n\n § Common ATM system design\n\n § Assessing a sample ATM\n\n\n##### § Conclusion\n\n\n-----\n\n###### Modern ATMs are standard, Windows-based, computers full of money\n\n\n###### Modern ATMs are\n\n\n###### ATM software is developed according to open standards\n\n\n###### Highly interesting target, protection is required!\n\n\n###### Patch management\n\n\n###### Application whitelisting\n\n\n###### Network segmentation\n\n\n###### Disk encryption\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "bf5be533-fa31-4590-ae37-5761c97ffa34",
            "created_at": "2022-10-25T16:13:58.389257Z",
            "updated_at": "2022-10-25T16:13:58.389257Z",
            "deleted_at": null,
            "name": "Malpedia",
            "url": "https://malpedia.caad.fkie.fraunhofer.de",
            "description": "Malpedia is a free service offered by Fraunhofer FKIE",
            "reports": null
        }
    ],
    "references": [
        "http://www.isg.rhul.ac.uk/dl/weekendconference2014/slides/Erik_VanBuggenhout.pdf"
    ],
    "report_names": [
        "Erik_VanBuggenhout.pdf"
    ],
    "threat_actors": [
        {
            "id": "aa73cd6a-868c-4ae4-a5b2-7cb2c5ad1e9d",
            "created_at": "2022-10-25T16:07:24.139848Z",
            "updated_at": "2025-03-27T02:02:10.120505Z",
            "deleted_at": null,
            "main_name": "Safe",
            "aliases": [],
            "source_name": "ETDA:Safe",
            "tools": [
                "DebugView",
                "LZ77",
                "OpenDoc",
                "SafeDisk",
                "TypeConfig",
                "UPXShell",
                "UsbDoc",
                "UsbExe"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1666716500,
    "ts_updated_at": 1743041370,
    "ts_creation_date": 0,
    "ts_modification_date": 1410599575,
    "files": {
        "pdf": "https://archive.orkl.eu/26d978c0a67531862a41f9706f6bb722fdc60423.pdf",
        "text": "https://archive.orkl.eu/26d978c0a67531862a41f9706f6bb722fdc60423.txt",
        "img": "https://archive.orkl.eu/26d978c0a67531862a41f9706f6bb722fdc60423.jpg"
    }
}