{
    "id": "c299a68e-b520-45c9-8678-ca75af12bb9a",
    "created_at": "2023-04-05T02:09:16.984907Z",
    "updated_at": "2025-03-27T02:06:15.541572Z",
    "deleted_at": null,
    "sha1_hash": "fc8f060e260edec523eb7c977c0b52671010f5c2",
    "title": "2022-01-19 - Malware vaccines can prevent pandemics, yet are rarely used",
    "authors": "",
    "file_creation_date": "2023-04-03T08:51:26Z",
    "file_modification_date": "2023-04-03T08:51:26Z",
    "file_size": 238004,
    "plain_text": "# Malware vaccines can prevent pandemics, yet are rarely used\n\n**gdatasoftware.com/blog/2022/01/malware-vaccines**\n\nVaccines have distinct advantages over detection based defense mechanisms, so we\ndeveloped a vaccine to protect from one of the most notorious ransomware familiesâ€”\nSTOP/DJVU. But unlike vaccines against biological viruses, malware vaccines are not\nparticularly common. This article explains why.\n\n## Inner workings of malware vaccines\n\nMalware vaccines apply harmless parts of malware to a system to trick malware into\nmalfunction. It is not a coincidence that the security industry adopted the term vaccine from\nmedicine because there is a resemblence to medical vaccines which apply inactive or\nweakened parts of viruses to a person in oder to protect. But the analogy stops there.\nMalware vaccines do not improve the security reponse of the system.\n\nThe harmless malware parts that vaccines apply are often so called infection markers.\nMalware usually tries not to infect a system twice because this has unintended\nconsequences. For that reason malware may place infection markers after a successful\ninfection. If the malware finds such a marker, it will refrain from installing itself again. A\nvaccine just places those infection markers without the malware, thus tricking the malware\ninto thinking it already infected the system (cf. p. 2 [wich12]).\n\nVaccines can use other things than infection markers, e.g., they may cause an error in the\nmalware by providing invalid data. Some malware writes data into the registry or into files like\nencryption keys, configuration settings, C2C servers. A vaccine may place invalid data that\ncauses the malware to crash, malfunction or simply not working as intended by the author. A\nsimple example would be the application of a non-existing C2C server for remotely controlled\nmalware. One well-described vaccine that crashed previous versions of Emotet with a buffer\n[overflow is called EmoCrash [quinn20].](https://www.binarydefense.com/emocrash-exploiting-a-vulnerability-in-emotet-malware-for-defense/)\n\nIn case of the STOP/DJVU ransomware vaccine, the ransomware is tricked into not\nencrypting files anymore. Without file encryption there is no leverage to demand a ransom,\nthus, the main malicious behavior is disabled by the vaccine.\n\nAnother, albeit different case, is the [Logout4Shell vaccine by Cybereason. This vaccine is a](https://www.cybereason.com/blog/cybereason-releases-vaccine-to-prevent-exploitation-of-apache-log4shell-vulnerability-cve-2021-44228)\n[benign malware akin toWelchia worm. Benign malware has malware characteristics like](https://en.wikipedia.org/wiki/Welchia)\nworm-propagation or virus replication, or exploitation, but the payload is meant to fix a\nproblem. Welchia worm got famous for using the same propagation mechanisms like Blaster\n_worm to clean Blaster infections as well as patching vulnerable systems. Logout4Shell is_\n\n\n-----\n\nsimilar to Welchia because it actively exploits the Log4Shell vulnerability in order to fix the\nsecurity hole. The exploitation itself is problematic because the changes can be applied\n[without consent of the system's owner. Cybereason states in a Bleepingcomputer article that](https://www.bleepingcomputer.com/news/security/researchers-release-vaccine-for-critical-log4shell-vulnerability/)\nthe benefits outweigh the ethical concerns considering the severety of Log4Shell exploit.\n\n## Advantages of vaccines over detection mechanisms\n\nMalware vaccines have some traits in common\n\nwith those administered to combat biological infections.\nVaccines have some unique advantages. They are passive, thus, unlike antivirus scanning\nthey have no performance overhead for the system. Depending on the malware they may\nalso work on already infected systems by shutting down the malicious behavior of the\ndormant infection (p.3 [wich12]). Vaccines also work independently from obfuscation,\npacking, polymorphism, metamorphism or similar evasion techniques.\n\nIn a study from 2012 at least 59.4% of the malware samples used infection markers (p.4\n\n[wich12]). This study is obviously outdated, but the only one I could find about infection\nmarker prevalence. I do believe that the magnitude did not change and vaccines could be\ndeveloped for a substantial amount of malware families.\n\n[Malware vaccines are actively developed by some security companies, e.g., Minerva,](https://blog.minerva-labs.com/using-vaccination-to-stop-malware)\nhowever, compared to other malware protection mechanism like signature based detection\nvaccinations seem rather unpopular. Why?\n\nTo understand this let's take a look at a specific vaccine first: The STOP/DJVU ransomware\nvaccine.\n\n## STOP/DJVU ransomware vaccine\n\nSTOP/DJVU ransomware vaccine was created by John Parol and me. We published a tool\non Github so that everyone can inspect and use it. Soon after publishing it, the tool got many\nfalse positive detections by antivirus vendors.\n\n\n-----\n\nAdditionally we added a section to our tool's readme to explain that systems are not entirely\nprotected from STOP/DJVU ransomware after using this vaccine. The ransomware will still\ndo things to the system that are not tied to encryption.\n\nin some cases the ransomware may still create ransom notes\nif files are smaller than 6 bytes, the ransomware will still rename them, but not change\ntheir contents\n[this ransomware is often not alone but ships with additional malware like Vidar stealer,](https://lordt.mk/2021/06/16/mabr-0x02-doubletrouble-analysis-of-stop-ransomware-vidar-stealer-unpacking/)\nso disinfection of the affected system is still necessary despite the vaccine\n\nSo the only thing that the vaccine prevents is the encryption and (for most files) renaming. It\nis not sure that the vaccine stays on the system because security products will likely remove\nit. STOP/DJVU ransomware itself may also get an update at some point so that the vaccine\ndoes not work anymore.\n\n## Vaccines are no silver bullet\n\nThe main problem of vaccines is that they make a system look infected to other security\nproducts. Many of the more tech-savvy users use malware scanners additionally to their\nmain antivirus product and these scanners detect infection markers as a sign of a prevalent\ninfection. Not only do they remove these infection markers, they will find them repeatedly\nwhen the antivirus product re-applies them. That turns using the products alongside each\nother into an unpleasant experience for the user, who may come to believe that their main\nantivirus does not work against this threat, and that their system is never properly cleaned.\n\n\n-----\n\nForcing malware scanners to not detect such infection markers is a bad idea because this\nwould eventually weaken their detection against real threats. These markers are actual\ninfection signs and should continue to be detected as such. Hoping and preaching that users\nonly use one security suite from one vendor is also not realistic. We have to live with crossusage of other scanners.\n\nAdditionally vaccine protection is oftentimes silent, which means users will never know that\nthere was an infection attempt. This is not desireable because users need to know that, e.g.,\nthe program they downloaded was a bad idea.\n\nMalware vaccines may stay a niche defense mechanism for the everyday malware, but they\nare specifically useful to combat pandemic outbreaks. In that regard they are not different to\nmedical vaccines.\n\n## References\n\n[quinn20] James Quinn, August 2020, \"EmoCrash: Exploiting a Vulnerability in Emotet\nMalware for Defense\", www.binarydefense.com/emocrash-exploiting-a-vulnerability-inemotet-malware-for-defense/\n\n[wich12] A. Wichmann and E. Gerhards-Padilla, \"Using Infection Markers as a Vaccine\nagainst Malware Attacks,\" 2012 IEEE International Conference on Green Computing and\nCommunications, 2012, pp. 737-742, doi: 10.1109/GreenCom.2012.121.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-01-19 - Malware vaccines can prevent pandemics, yet are rarely used.pdf"
    ],
    "report_names": [
        "2022-01-19 - Malware vaccines can prevent pandemics, yet are rarely used.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1680660556,
    "ts_updated_at": 1743041175,
    "ts_creation_date": 1680511886,
    "ts_modification_date": 1680511886,
    "files": {
        "pdf": "https://archive.orkl.eu/fc8f060e260edec523eb7c977c0b52671010f5c2.pdf",
        "text": "https://archive.orkl.eu/fc8f060e260edec523eb7c977c0b52671010f5c2.txt",
        "img": "https://archive.orkl.eu/fc8f060e260edec523eb7c977c0b52671010f5c2.jpg"
    }
}