{
    "id": "421a981a-29fb-4608-98c9-8f24c9860aca",
    "created_at": "2023-01-12T15:06:11.424323Z",
    "updated_at": "2025-03-27T02:05:36.60353Z",
    "deleted_at": null,
    "sha1_hash": "92a5f4538162f0b50f1a035f1594c2bf447cf556",
    "title": "2016-11-28 - A New All-in-One Botnet- Proteus",
    "authors": "",
    "file_creation_date": "2022-05-29T01:20:26Z",
    "file_modification_date": "2022-05-29T01:20:26Z",
    "file_size": 234239,
    "plain_text": "# A New All-in-One Botnet: Proteus\n\n**[fortinet.com/blog/threat-research/a-new-all-in-one-botnet-proteus.html](https://www.fortinet.com/blog/threat-research/a-new-all-in-one-botnet-proteus.html)**\n\nThreat Research\n\nBy [Donna Wang and](https://www.fortinet.com/blog/search?author=Donna+Wang) [Jacob (Kuan Long) Leong | November 28, 2016](https://www.fortinet.com/blog/search?author=+Jacob+%28Kuan+Long%29+Leong)\n**Introduction**\n\n\nNovember 28, 2016\n\n\nThe ART team at Fortinet has discovered a new malware named Proteus, a multifunctional\nbotnet written in .NET that appears to be a proxy, coin miner, e-commerce merchant account\nchecker, and keylogger. This particular botnet is downloaded by the Andromeda botnet. The\nhandful of malicious features densely packed in this new malware also includes the ability to\ndrop other malware. We have compiled its main features in this brief analysis.\n\n**Data Encryption**\n\nAll C&C communication is encrypted with a symmetrical algorithm. All strings used in this\nbotnet are also encrypted using the same algorithm. Part of the encrypted hostname string is\nshown below:\n\nFigure 1 Partial Encrypted Hostname\n\nAnd the encrypted hostname is: http://prot{removed}twork.ml/ which is used as the C&C\ndomain.\n\nA simple decryption Algorithm is provided below:\n\n\n-----\n\nFigure 2 Decryption Algorithm\n\n**Preparation**\n\nThe sample arrives obfuscated, drops a copy of itself in the %AppData% folder as\n_chrome.exe, and executes the copy. It then creates a hardcoded mutex to ensure there is_\nonly one instance of itself running.\n\nFigure 3 Mutex Name\n\nIn order to register the botnet with the C&C server, it sends an initial registration message\nwith several pieces of information regarding the infected machine. The packet for registering\nthe bot takes the format as below:\n```\n{\"m\":\"<Encrypted MachineName>\", \"o\":\"<Encrypted OperationSystem>\", \"v\":\"\n<Encrypted BotVersion>\"}\n\n```\nFigure 4 Bot Registering Function\n\nThe fingerprint consists of the processor, BIOS and baseboard information of the infected\nmachine, as shown below.\n\nFigure 5 Generating Fingerprint\n\n\n-----\n\nThe bot comes with a hardcoded default fingerprint, as shown below. However, it appears\nthat the default fingerprint is always overwritten by the above-mentioned newly generated\nfingerprint, which is a unique identifier for the infected machine. The fingerprint is included in\nthe HTTP header in the authorization field.\n\nFigure 6 Default Fingerprint\n\nMachineName is retrieved by calling the Win32 API GetComputerName, OperatingSystem is\nthe OS architecture x64 or x86. The BotVersion is obtained from the assembly version that\nthe code is executing in:\n\nFigure 7 Bot version\n\nThe C&C server responses with an encrypted string that reads “successful.” Then the bot\nplays ping pong with the server to make sure it’s live in order to carry out the rest of its\nmalicious actions.\n\nFigure 8 Ping Pong\n\n**Features & Tasks**\n\nProteus creates six threads for different tasks, as follows:\n\n**_Task_** **_Description_**\n\n_SocksTask_ creates a socket and sets up port forwarding\n\n_MiningTask_ appears to use SHA256 miner for mining digital currency *\n\n\n-----\n\n_EMiningTask_ appears to use CPUMiner and ZCashMiner for mining digital currency *\n\n_CheckerTask_ validates given accounts\n\n_CommandsTask_ kills current process or downloads and executes an executable on\nrequest\n\n_LoggerTask_ sets up keylogger\n\nTable 1 Tasks and Descriptions\n\n- The bot verifies with the server during runtime to determine which miner to use for mining\n_digital currency such as Bitcoin._\n\nFigure 9 Check Module for MiningTask\n\nFigure 10 Check Modules for EMiningTask\n\nFor SocksTask, MiningTask, EMiningTask and LoggerTask, the bot first sends a\nCheckModule message by providing its program fingerprint and corresponding module name\nto the C&C server. The server then sends a command back to the bot, indicating whether or\nnot the bot should proceed with the requested task.\n\nFor CheckerTask, the bot first requests an account from the C&C server. If the server replies\nwith an account to the bot, the bot will proceed to check the given account on some wellknown e-commerce websites including eBay, Amazon, and Netflix. Some of the websites\nare on German (.de) domains. Similarly, for CommandsTask, the bot first requests a\ncommand from the server and then executes the command if it is valid.\n\n**Conclusion**\n\nThe Proteus botnet has a combination of features including coin miner, proxy server,\nkeylogger, and many more. It is also capable of downloading and executing a file. All of this\nin one botnet may be even more harmful than one might first think, as it could download\nanything and execute it in the infected host. Our team will continue to monitor this botnet\nfamily and provide more information as it comes to light.\n\n**_Sample Information_**\n\nMD5: 49fd4020bf4d7bd23956ea892e6860e9\n\n\n-----\n\nSHA256: d23b4a30f6b1f083ce86ef9d8ff434056865f6973f12cb075647d013906f51a2\n\n_Fortinet AV Detection: MSIL/Proteus.A!tr_\n\n_Fortinet IPS Detection: Proteus.Botnet_\n\n--Advanced Research Team, Fortinet Canada\n\n## Related Posts\n\nCopyright © 2022 Fortinet, Inc. All Rights Reserved\n\n[Terms of ServicesPrivacy Policy](https://www.fortinet.com/corporate/about-us/legal.html)\n| Cookie Settings\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2016/2016-11-28 - A New All-in-One Botnet- Proteus.pdf"
    ],
    "report_names": [
        "2016-11-28 - A New All-in-One Botnet- Proteus.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673535971,
    "ts_updated_at": 1743041136,
    "ts_creation_date": 1653787226,
    "ts_modification_date": 1653787226,
    "files": {
        "pdf": "https://archive.orkl.eu/92a5f4538162f0b50f1a035f1594c2bf447cf556.pdf",
        "text": "https://archive.orkl.eu/92a5f4538162f0b50f1a035f1594c2bf447cf556.txt",
        "img": "https://archive.orkl.eu/92a5f4538162f0b50f1a035f1594c2bf447cf556.jpg"
    }
}