{
    "id": "5aedaaaa-9afd-4df5-9798-d313ab807cfb",
    "created_at": "2023-01-12T15:08:30.105851Z",
    "updated_at": "2025-03-27T02:06:14.18118Z",
    "deleted_at": null,
    "sha1_hash": "99c50d535c447d87a4f0cf420645d15f4796c2a1",
    "title": "2016-11-30 - Bladabindi Remains A Constant Threat By Using Dynamic DNS Services",
    "authors": "",
    "file_creation_date": "2022-05-28T15:52:30Z",
    "file_modification_date": "2022-05-28T15:52:30Z",
    "file_size": 1049205,
    "plain_text": "# Bladabindi Remains A Constant Threat By Using Dynamic DNS Services\n\n**[blog.fortinet.com/2016/11/30/bladabindi-remains-a-constant-threat-by-using-dynamic-dns-services](https://blog.fortinet.com/2016/11/30/bladabindi-remains-a-constant-threat-by-using-dynamic-dns-services)**\n\nNovember 30, 2016\n\nThreat Research\n\nBy [Lilia Elena Gonzalez Medina | November 30, 2016](https://blog.fortinet.com/blog/search?author=Lilia+Elena+Gonzalez+Medina)\nThe Fortinet research team has been developing a industrial-grade analysis system that\nallows us to concentrate information from samples collected from a variety of sources. Using\nthis tool, we recently started to see the recurrence of URLs from the domains hopto.org and\nmyftp.biz. In most cases, each sample was connected to a unique URL in one of the\ndomains, although we also found some samples that connected to the same URL.\n\n\n-----\n\nFigure 1. Examples of the domains and samples collected by the team’s FortiGuard analysis\nsystem\n\nThis threat, also known as njRAT, is detected as [MSIL/Bladabindi.U!tr or](https://www.virustotal.com/en/file/6e31148cc1b3235b71731c3944a7b06f861e104e978708d12c695ec09b5b3760/analysis/) [MSIL/Agent.LI!tr by](https://www.virustotal.com/en/file/88ae50176898a04cc982af3f23e67144e544a1224f5ac06c4abf61e59e54aa4a/analysis/)\nthe Fortinet AntiVirus service. If installed, the user’s private data is compromised because of\nthe malware’s capability to provide the malicious actor with unauthorized access to the\ninfected computer in order to collect different kinds of information, such as: screenshots,\nwords typed (which often include usernames, passwords, websites, documents, etc.),running\nprocesses, pictures taken with the webcam, etc.\n\n**Threat Description**\n\nThis malware family uses the .NET framework. And this sample in particular has two\nimportant classes called kl and OK.\n\n**kl**\n\nThis class uses the functions GetAsyncKeyState, GetKeyboardLayout, GetKeyboardState,\nGetWindowThreadProcessId, MapVirtualKey and ToUnicodeEx to capture keystrokes.\n\n**OK**\n\nThis class contains the other functionalities of the RAT. The important activities are\nsummarized below:\n\n\n-----\n\nMakes the following modifications to the registry:\n\nHKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\050ed846adcc1b8729af0a70a0fefe4d:\n“”C:\\Users\\\\AppData\\Local\\Temp\\server.exe” ..”\n\nHKCU\\Software\\050ed846adcc1b8729af0a70a0fefe4d\\[kl]: “”\n\nHKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\050ed846adcc1b8729af0a70a0fefe4d:\n“”C:\\Users\\\\AppData\\Local\\Temp\\server.exe” ..”\n\nHKCU\\di: “!”\n\nThe string “050ed846adcc1b8729af0a70a0fefe4d” is hardcoded in the sample.\n\nBesides storing the keylogger logs, the sub registry key\nHKCU\\Software\\050ed846adcc1b8729af0a70a0fefe4d\\ also contains malicious executables\nloaded from the sample as binary data.\n\nFigure 2. Malicious executables stored in Windows Registry\n\nAll those samples are, of course, detected by the Fortinet AntiVirus service:\n\n[2681e81bb4c4b3e6338ce2a456fb93a7 Detected as MSIL/Bladabindi.U!tr](https://www.virustotal.com/en/file/6e31148cc1b3235b71731c3944a7b06f861e104e978708d12c695ec09b5b3760/analysis/)\n\n[8e78a69ca187088abbea70727d268e90 Detected as MSIL/Bladabindi.U!tr](https://www.virustotal.com/en/file/6e31148cc1b3235b71731c3944a7b06f861e104e978708d12c695ec09b5b3760/analysis/)\n\n[b88ece4c04f706c9717bbe6fbda49ed2 Detected as W32/Agent.CPGR!tr](https://www.virustotal.com/en/file/a3e4bee1b6944aa9266bd58de3f534a4c1896df621881a5252a0d355a6e67c70/analysis/)\n\nc4d7f8abbf369dc795fc7f2fdad65003 Detected as MSIL/Bladabindi.U!tr\n\nThe strings in b88ece4c04f706c9717bbe6fbda49ed2 reference No-IP’s Dynamic Update\nClient (DUC) that automatically updates the IP address if it changes, but also contain lines\nlike “SELECT * FROM moz_logins” to obtain Firefox’s stored credentials.\n\n\n-----\n\nFigure 3. Part of a malicious executable stored as data\n\nCreates the mutex 050ed846adcc1b8729af0a70a0fefe4d. If the mutex already exists,\nthe sample calls ProjectData.EndApp to close all related files and stop the process.\nChecks whether a file called server.exe already exists in\nC:\\Users\\\\AppData\\Local\\Temp\\. If it exists, the sample deletes it. Otherwise, the file is\ncreated and executed. The file server.exe is a copy of the sample.\nCreates an environment variable called “SEE_MASK_NOZONECHECKS” and sets its\nvalue to 1.\nCreates a rule to allow the process server.exe on the Windows firewall.\n\nFigure 4. Command used by the sample to create a firewall rule\n\nCopies server.exe in the Startup folder.\nChecks the value of HKCU\\Software\\050ed846adcc1b8729af0a70a0fefe4d\\[kl]\nbecause the keylogger stores what it captures in this registry key, to later send to its\nC&C.\n\n\n-----\n\nFigure 5. Example of the keylogging functionality\n\nUses GetWindowText to copy the text of the active window's title bar to later send to\nthe remote server coded in base64.\nGets information about the C: drive, particularly the volume serial number.\nWhen all the necessary information has been collected, the sample generates a string\nwith the data coded in base64, and with this structure:\n\n“ll” + HacKed22_VolumeSerialNumber + ComputerName + Username +\nLastWriteTimeOfSampleinTemp + OSandServicePack + Architecture + Camera(Yes/No) +\n0.7d (PossiblyTheMalwareVersion) + .. + ActiveWindowName + ActiveWindowName…\n\nThis stolen information is sent to the malicious URL in hopto.org or myftp.biz domain using\nport 1177, 5552, or 5112, depending on the sample. The traffic can be detected by Fortinet\nIPS signature Bladabindi.Botnet.\n\n\n-----\n\nFigure 6. Fragment of the coded data sent to the C&C\n\nHere are some examples of the decoded windows names:\n\nTemp: VGVtcAA=\n\nRoaming: Um9hbWluZwA=\n\nRegshot 1.9.0 x86 Unicode: UmVnc2hvdCAxLjkuMCB4ODYgVW5pY29kZQA=\n\nLocal: TG9jYWwA\n\nProcess Monitor Filter: UHJvY2VzcyBNb25pdG9yIEZpbHRlcgA=\n\nApplying Event Filter: QXBwbHlpbmcgRXZlbnQgRmlsdGVyAA==\n\nEvent Properties: RXZlbnQgUHJvcGVydGllcwA=\n\nCreate dump of server.exe: Q3JlYXRlIGR1bXAgb2Ygc2VydmVyLmV4ZQA=\n\nUses the function capGetDriverDescriptionA to find out if the infected computer has a\nwebcam installed.\nDeletes the keys and files related to the infection.\nIt also includes functions to decompress zip files and obtain MD5 hashes.\n\n\n-----\n\nThe sample responds to the commands sent from its C&C. The following table explains\nsome of them:\n\nkl Sends the data collected by the keylogger.\n\n\nprof\n+\n“~”\n\nprof\n+ “!”\n\nprof\n+\n“@”\n\n\nAdds a value to the subkey HKCU\\Software\\050ed846adcc1b8729af0a70a0fefe4d\\\n\nAdds a value to the subkey HKCU\\Software\\050ed846adcc1b8729af0a70a0fefe4d\\\n\nSends data to the C&C.\n\nDeletes the specified registry key.\n\n\nrn Downloads a file and executes it.\n\nret Obtains the collected passwords.\n\nCAP Takes screenshot, saves it as JPEG, and sends it to its C&C.\n\n\nun +\n“~”\n\nUn\n+ “!”\n\nUn\n+\n“@”\n\n\nDeletes the registry keys, the file server.exe in the Startup folder and the firewall\nrule to allow it.\n\nEnds current process.\n\nEnds current process and starts a new one.\n\n\nUp Downloads file from a remote server and executes it. Afterwards it deletes the\nregistry keys and the files related to the infection. This command is used for\nupdates.\n\nEx Obtains information about the running processes, the services, and the active\nconnections.\n\n\n-----\n\nCH Opens a chat window so that the C&C can communicate with the infected\ncomputer.\n\nA fragment of the decompiled code for the “CAP” command to take screenshots can be seen\nbelow. It basically uses CopyFromScreen to copy the screen’s pixels to the bitmap through a\ngraphic object.\n\nFigure 7. Fragment of code to take screenshots\n\n**C&C interface**\n\nWhen active, the domain prosa15.myftp.biz is used by the sample to connect to its C&C\nthrough port 1177. To simulate the RAT behavior in a controlled environment, a sample of\nnjRAT was downloaded and installed. Once the sample connected to the C&C, the panel\ndisplayed information such as its IP address, its computer name, country, whether a webcam\nwas installed, the active window, and a small screenshot.\n\nFigure 8. njRAT’s administration panel\n\n\n-----\n\nThe picture below shows part of the data collected by the keylogger. Not only does it record\nthe pressed keys, but it also specifies the window in which the words were written.\n\nFigure 9. Keylogger window\n\nAs mentioned above, the malware is also capable of collecting active processes, services,\nand connections, accessing the registry keys, and executing commands with a remote shell.\n\nFigure 10. Other capabilities of the RAT\n\n**Statistics**\n\nBoth hopto.org and myftp.biz domains are available, amongst various other options, from the\ndynamic DNS provider called No-IP. The use of this service guarantees that an infected PC\nwill be able to maintain communication with its C&C even if it changes the IP address.\n\nFrom September 12 to November 16, our FortiGuard analysis system collected 194 samples\nconnecting to hopto.org or myftp.biz.\n\n\n-----\n\nOut of those, 166 were related to Bladabindi samples and the rest to different threats, which\nindicates that the use of dynamic DNS providers could now be more common amongst\nmalware writers.\n\nAlthough it is common for this malware family to report to its C&C using port 1177, the\ninformation gathered reveals that ports 5552 and 5112 are also now being used.\n\nFinally, the next chart shows the number of samples collected by our FortiGuard analysis\nsystem from September 12 to November 16.\n\n\n-----\n\n**Conclusion**\n\nThe Bladabindi malware family continues to be one of the most popular threats because of\nhow easy it is to download. In fact, there are plenty of videos and websites available that\nprovide detailed tutorials of how to use it. One proof of its ease of use is the fact that many of\nthe collected samples hadn’t been submitted to Virus Total at the time of the analysis.\nFurthermore, the samples we examined use dynamic DNS services that make it hard to\nmonitor and keep track of the domains and the IP addresses used.\n\n## Related Posts\n\nCopyright © 2022 Fortinet, Inc. All Rights Reserved\n\n[Terms of ServicesPrivacy Policy](https://www.fortinet.com/corporate/about-us/legal.html)\n| Cookie Settings\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2016/2016-11-30 - Bladabindi Remains A Constant Threat By Using Dynamic DNS Services.pdf"
    ],
    "report_names": [
        "2016-11-30 - Bladabindi Remains A Constant Threat By Using Dynamic DNS Services.pdf"
    ],
    "threat_actors": [
        {
            "id": "32a223a8-3c79-4146-87c5-8557d38662ae",
            "created_at": "2022-10-25T15:50:23.703698Z",
            "updated_at": "2025-03-27T02:00:55.528031Z",
            "deleted_at": null,
            "main_name": "Lazarus Group",
            "aliases": [
                "Lazarus Group",
                "Labyrinth Chollima",
                "HIDDEN COBRA",
                "Guardians of Peace",
                "NICKEL ACADEMY",
                "Diamond Sleet"
            ],
            "source_name": "MITRE:Lazarus Group",
            "tools": [
                "RawDisk",
                "Proxysvc",
                "BADCALL",
                "FALLCHILL",
                "WannaCry",
                "HOPLIGHT",
                "TYPEFRAME",
                "Dtrack",
                "HotCroissant",
                "HARDRAIN",
                "Dacls",
                "KEYMARBLE",
                "TAINTEDSCRIBE",
                "AuditCred",
                "netsh",
                "ECCENTRICBANDWAGON",
                "AppleJeus",
                "BLINDINGCAN",
                "ThreatNeedle",
                "Volgmer",
                "Cryptoistic",
                "RATANKBA",
                "Bankshot",
                "Torisma",
                "Mimikatz"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "a2b92056-9378-4749-926b-7e10c4500dac",
            "created_at": "2023-01-06T13:46:38.430595Z",
            "updated_at": "2025-03-27T02:00:02.831633Z",
            "deleted_at": null,
            "main_name": "Lazarus Group",
            "aliases": [
                "Operation DarkSeoul",
                "APT38",
                "ATK117",
                "DEV-1222",
                "G0032",
                "APT 38",
                "Stardust Chollima",
                "APT-C-26",
                "ATK3",
                "Diamond Sleet",
                "Hidden Cobra",
                "Unit 121",
                "Subgroup: Bluenoroff",
                "NICKEL GLADSTONE",
                "DEV-0139",
                "Andariel",
                "Operation Troy",
                "COVELLITE",
                "TA404",
                "Lazarus group",
                "Dark Seoul",
                "G0082",
                "NewRomanic Cyber Army Team",
                "Bluenoroff",
                "Appleworm",
                "Nickel Academy",
                "COPERNICIUM",
                "Hastati Group",
                "Bureau 121",
                "Operation AppleJeus",
                "Whois Hacking Team",
                "Citrine Sleet",
                "Sapphire Sleet",
                "Group 77",
                "Labyrinth Chollima",
                "Operation GhostSecret",
                "BeagleBoyz"
            ],
            "source_name": "MISPGALAXY:Lazarus Group",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "f32df445-9fb4-4234-99e0-3561f6498e4e",
            "created_at": "2022-10-25T16:07:23.756373Z",
            "updated_at": "2025-03-27T02:02:09.966155Z",
            "deleted_at": null,
            "main_name": "Lazarus Group",
            "aliases": [
                "APT-C-26",
                "ATK 3",
                "Appleworm",
                "Citrine Sleet",
                "DEV-0139",
                "Diamond Sleet",
                "Gleaming Pisces",
                "Gods Apostles",
                "Gods Disciples",
                "Group 77",
                "Guardians of Peace",
                "Hastati Group",
                "Hidden Cobra",
                "ITG03",
                "Jade Sleet",
                "Labyrinth Chollima",
                "Lazarus Group",
                "NewRomanic Cyber Army Team",
                "Operation 99",
                "Operation AppleJeus",
                "Operation AppleJeus sequel",
                "Operation Blockbuster: Breach of Sony Pictures Entertainment",
                "Operation CryptoCore",
                "Operation Dream Job",
                "Operation Dream Magic",
                "Operation Flame",
                "Operation GhostSecret",
                "Operation In(ter)caption",
                "Operation LolZarus",
                "Operation Marstech Mayhem",
                "Operation No Pineapple!",
                "Operation North Star",
                "Operation Phantom Circuit",
                "Operation Sharpshooter",
                "Operation Ten Days of Rain / DarkSeoul",
                "Operation Troy",
                "SectorA01",
                "Slow Pisces",
                "TA404",
                "TraderTraitor",
                "UNC2970",
                "UNC4034",
                "UNC4736",
                "UNC4899",
                "UNC577",
                "Whois Hacking Team"
            ],
            "source_name": "ETDA:Lazarus Group",
            "tools": [
                "3CX Backdoor",
                "3Rat Client",
                "3proxy",
                "AIRDRY",
                "ARTFULPIE",
                "ATMDtrack",
                "AlphaNC",
                "Alreay",
                "Andaratm",
                "AngryRebel",
                "AppleJeus",
                "Aryan",
                "AuditCred",
                "BADCALL",
                "BISTROMATH",
                "BLINDINGCAN",
                "BTC Changer",
                "BUFFETLINE",
                "BanSwift",
                "Bankshot",
                "Bitrep",
                "Bitsran",
                "BlindToad",
                "Bookcode",
                "BootWreck",
                "BottomLoader",
                "Brambul",
                "BravoNC",
                "Breut",
                "COLDCAT",
                "COPPERHEDGE",
                "CROWDEDFLOUNDER",
                "Castov",
                "CheeseTray",
                "CleanToad",
                "ClientTraficForwarder",
                "CollectionRAT",
                "Concealment Troy",
                "Contopee",
                "CookieTime",
                "Cyruslish",
                "DAVESHELL",
                "DBLL Dropper",
                "DLRAT",
                "DRATzarus",
                "DRATzarus RAT",
                "Dacls",
                "Dacls RAT",
                "DarkComet",
                "DarkKomet",
                "DeltaCharlie",
                "DeltaNC",
                "Dembr",
                "Destover",
                "DoublePulsar",
                "Dozer",
                "Dtrack",
                "Duuzer",
                "DyePack",
                "ECCENTRICBANDWAGON",
                "ELECTRICFISH",
                "Escad",
                "EternalBlue",
                "FALLCHILL",
                "FYNLOS",
                "FallChill RAT",
                "Farfli",
                "Fimlis",
                "FoggyBrass",
                "FudModule",
                "Fynloski",
                "Gh0st RAT",
                "Ghost RAT",
                "Gopuram",
                "HARDRAIN",
                "HIDDEN COBRA RAT/Worm",
                "HLOADER",
                "HOOKSHOT",
                "HOPLIGHT",
                "HOTCROISSANT",
                "HOTWAX",
                "HTTP Troy",
                "Hawup",
                "Hawup RAT",
                "Hermes",
                "HotCroissant",
                "HotelAlfa",
                "Hotwax",
                "HtDnDownLoader",
                "Http Dr0pper",
                "ICONICSTEALER",
                "Joanap",
                "Jokra",
                "KANDYKORN",
                "KEYMARBLE",
                "Kaos",
                "KillDisk",
                "KillMBR",
                "Koredos",
                "Krademok",
                "LIGHTSHIFT",
                "LIGHTSHOW",
                "LOLBAS",
                "LOLBins",
                "Lazarus",
                "LightlessCan",
                "Living off the Land",
                "MATA",
                "MBRkiller",
                "MagicRAT",
                "Manuscrypt",
                "Mimail",
                "Mimikatz",
                "Moudour",
                "Mydoom",
                "Mydoor",
                "Mytob",
                "NACHOCHEESE",
                "NachoCheese",
                "NestEgg",
                "NickelLoader",
                "NineRAT",
                "Novarg",
                "NukeSped",
                "OpBlockBuster",
                "PCRat",
                "PEBBLEDASH",
                "PLANKWALK",
                "POOLRAT",
                "PSLogger",
                "PhanDoor",
                "Plink",
                "PondRAT",
                "PowerBrace",
                "PowerRatankba",
                "PowerShell RAT",
                "PowerSpritz",
                "PowerTask",
                "Preft",
                "ProcDump",
                "Proxysvc",
                "PuTTY Link",
                "QUICKRIDE",
                "QUICKRIDE.POWER",
                "Quickcafe",
                "QuiteRAT",
                "R-C1",
                "ROptimizer",
                "Ratabanka",
                "RatabankaPOS",
                "Ratankba",
                "RatankbaPOS",
                "RawDisk",
                "RedShawl",
                "Rifdoor",
                "Rising Sun",
                "Romeo-CoreOne",
                "RomeoAlfa",
                "RomeoBravo",
                "RomeoCharlie",
                "RomeoCore",
                "RomeoDelta",
                "RomeoEcho",
                "RomeoFoxtrot",
                "RomeoGolf",
                "RomeoHotel",
                "RomeoMike",
                "RomeoNovember",
                "RomeoWhiskey",
                "Romeos",
                "RustBucket",
                "SHADYCAT",
                "SHARPKNOT",
                "SIGFLIP",
                "SIMPLESEA",
                "SLICKSHOES",
                "SORRYBRUTE",
                "SUDDENICON",
                "SUGARLOADER",
                "SheepRAT",
                "SierraAlfa",
                "SierraBravo",
                "SierraCharlie",
                "SierraJuliett-MikeOne",
                "SierraJuliett-MikeTwo",
                "SimpleTea",
                "SimplexTea",
                "SmallTiger",
                "Stunnel",
                "TAINTEDSCRIBE",
                "TAXHAUL",
                "TFlower",
                "TOUCHKEY",
                "TOUCHMOVE",
                "TOUCHSHIFT",
                "TOUCHSHOT",
                "TWOPENCE",
                "TYPEFRAME",
                "Tdrop",
                "Tdrop2",
                "ThreatNeedle",
                "Tiger RAT",
                "TigerRAT",
                "Trojan Manuscript",
                "Troy",
                "TroyRAT",
                "VEILEDSIGNAL",
                "VHD",
                "VHD Ransomware",
                "VIVACIOUSGIFT",
                "VSingle",
                "ValeforBeta",
                "Volgmer",
                "Vyveva",
                "W1_RAT",
                "Wana Decrypt0r",
                "WanaCry",
                "WanaCrypt",
                "WanaCrypt0r",
                "WannaCry",
                "WannaCrypt",
                "WannaCryptor",
                "WbBot",
                "Wcry",
                "Win32/KillDisk.NBB",
                "Win32/KillDisk.NBC",
                "Win32/KillDisk.NBD",
                "Win32/KillDisk.NBH",
                "Win32/KillDisk.NBI",
                "WinorDLL64",
                "Winsec",
                "WolfRAT",
                "Wormhole",
                "YamaBot",
                "Yort",
                "ZetaNile",
                "concealment_troy",
                "http_troy",
                "httpdr0pper",
                "httpdropper",
                "klovbot",
                "sRDI"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673536110,
    "ts_updated_at": 1743041174,
    "ts_creation_date": 1653753150,
    "ts_modification_date": 1653753150,
    "files": {
        "pdf": "https://archive.orkl.eu/99c50d535c447d87a4f0cf420645d15f4796c2a1.pdf",
        "text": "https://archive.orkl.eu/99c50d535c447d87a4f0cf420645d15f4796c2a1.txt",
        "img": "https://archive.orkl.eu/99c50d535c447d87a4f0cf420645d15f4796c2a1.jpg"
    }
}