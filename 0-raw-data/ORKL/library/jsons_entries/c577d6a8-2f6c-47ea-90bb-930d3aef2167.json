{
    "id": "c577d6a8-2f6c-47ea-90bb-930d3aef2167",
    "created_at": "2024-06-25T02:06:14.650724Z",
    "updated_at": "2025-03-27T02:13:11.780235Z",
    "deleted_at": null,
    "sha1_hash": "58cb9697a33612ca506f69acb860ac8d952af20d",
    "title": "SSTIC2024 - Rétro-ingénierie de code malveillant dans la CTI",
    "authors": "",
    "file_creation_date": "0001-01-01T00:00:00Z",
    "file_modification_date": "0001-01-01T00:00:00Z",
    "file_size": 2550543,
    "plain_text": "# La rétro-ingénierie de code malveillant dans la CTI\n##### Analyse de l’évolution d’une chaîne d’infection\n\n\n###### Charles Meslay\n\n\n-----\n\n## Cyber Threat Intelligence\n\n\n-----\n\n## Cyber Threat Intelligence Renseignement sur la menace cyber\n\n\n-----\n\n## Étudier le contexte et les capacités techniques\n des attaquants pour mieux se défendre\n\n\n-----\n\n#### Moyens techniques\n\n\n### INFRASTRUCTURE\n###### Quelle infrastructure est utilisée par l’acteur malveillant pour communiquer\n avec ses implants, effectuer des actions de reconnaissance ou exfiltrer\n des données du réseau ?\n\n\n-----\n\n#### Moyens techniques\n\n\n### INFRASTRUCTURE\n###### Quelle infrastructure est utilisée par l’acteur malveillant pour communiquer\n avec ses implants, effectuer des actions de reconnaissance ou exfiltrer\n des données du réseau ?\n\n\n### CODES MALVEILLANTS\n###### Quels outils, codes malveillants et vecteurs d’intrusion sont utilisés par un acteur malveillant afin de compromettre ses cibles, de se latéraliser et de réussir sa mission ?\n\n\n-----\n\n## Processus d’analyse d’un code\n\n\n-----\n\n## y\n\n###### > Comprendre ce qu’il fait\n > Signer le code\n > Pivoter / Trouver des nouveaux fichiers\n\n (> Extraire les serveurs C2)\n\n\n-----\n\n## y\n\n###### > Comprendre ce qu’il fait\n > Signer le code\n > Pivoter / Trouver des nouveaux fichiers\n\n (> Extraire les serveurs C2)\n\n\n-----\n\n## y\n\n###### > Comprendre ce qu’il fait\n > Signer le code\n > Pivoter / Trouver des nouveaux fichiers\n\n (> Extraire les serveurs C2)\n\n\n-----\n\n## y\n\n###### > Comprendre ce qu’il fait\n > Signer le code\n > Pivoter / Trouver des nouveaux fichiers\n\n (> Extraire les serveurs C2)\n\n\n-----\n\n## y\n\n###### > Comprendre ce qu’il fait\n > Signer le code\n > Pivoter / Trouver des nouveaux fichiers\n\n (> Extraire les serveurs C2)\n\n\n-----\n\n## Exemple : TA410\n\n\n-----\n\n-----\n\n-----\n\n###### > Menace supposée d’origine Chinoise.\n\n > Associée à APT10\n\n > Sous-groupe: FlowingFrog, LookingFrog, JollyFrog\n\n > Arsenal: Tendyron, FlowCloud, X4, LookBack, PlugX, QuasarRAT\n\n\n-----\n\n###### > Menace supposée d’origine Chinoise.\n\n > Associée à APT10\n\n > Sous-groupe: FlowingFrog, LookingFrog, JollyFrog\n\n > Arsenal: Tendyron, FlowCloud, X4, LookBack, PlugX, QuasarRAT\n\n\n-----\n\n## Chaîne d’exécution\n\n\n-----\n\n###### Création d’un\n service\n\n\n-----\n\n###### Création d’un\n service\n\n\n###### Application vulnérable DLL\n Side Loading\n\n\n###### Exécute\n\n\n-----\n\n###### Création d’un\n service\n\n\n###### Application vulnérable DLL\n Side Loading\n\n\n###### Charge\n\n\n###### DLL illégitime\n\n\n-----\n\n###### Création d’un\n service\n\n\n###### Application vulnérable DLL\n Side Loading\n\n\n###### DLL illégitime\n\n\n###### Backdoor FlowCloud\n\n\n###### Charge en\n mémoire\n\n\n-----\n\n###### Création d’un\n service\n\n\n###### Application vulnérable DLL\n Side Loading\n\n\n###### DLL illégitime\n\n\n###### Backdoor FlowCloud\n\n\n-----\n\n## Analyse initiale\n\n\n-----\n\n-----\n\n-----\n\n-----\n\n-----\n\n-----\n\n-----\n\n-----\n\n## p\n\n\n-----\n\n-----\n\n-----\n\n-----\n\n-----\n\n## Automatisation de la désobfuscation\n\n\n-----\n\n-----\n\n-----\n\n-----\n\n-----\n\n-----\n\n-----\n\n-----\n\n-----\n\n###### > Identification du mécanisme anti-analyse\n > La DLL charge puis exécute “setlangloc.dat”\n\n Problème :\n\n > “setlangloc.dat” introuvable\n\n\n-----\n\n## Signature du code\n\n\n-----\n\n## g\n\n###### > Langage de création de règles / signatures\n > Identification des patterns dans des fichiers\n > Utilisé pour la détection de malwares\n\n\n-----\n\n## g\n\n\n-----\n\n## g\n\n\n-----\n\n## g\n\n\n-----\n\n## g\n\n\n-----\n\n## g\n\n\n-----\n\n## g\n\n\n-----\n\n## Pivoter / Trouver des nouveaux samples\n\n\n## Pivoter / Trouver des nouveaux samples\n\n\n-----\n\n## Deux variants connus sur VirusTotal\n\n\n-----\n\n-----\n\n## Des nouveaux mécanismes d’obfuscation\n\n\n-----\n\n## p\n\n\n-----\n\n## p\n\n\n-----\n\n## p\n\n\n-----\n\n## p\n\n\n-----\n\n## p\n\n\n-----\n\n## p\n\n\n-----\n\n-----\n\n|Fichier|Motif 1|Motif 2|Motif 3|\n|---|---|---|---|\n|Initial|48|0|0|\n|Variant 1|69|136|136|\n|Variant 2|1|64|128|\n\n\n-----\n\n|Fichier|Motif 1|Motif 2|Motif 3|\n|---|---|---|---|\n|Initial|48|0|0|\n|Variant 1|69|136|136|\n|Variant 2|1|64|128|\n\n\n-----\n\n|Fichier|Motif 1|Motif 2|Motif 3|\n|---|---|---|---|\n|Initial|48|0|0|\n|Variant 1|69|136|136|\n|Variant 2|1|64|128|\n\n\n-----\n\n|Fichier|Motif 1|Motif 2|Motif 3|\n|---|---|---|---|\n|Initial|48|0|0|\n|Variant 1|69|136|136|\n|Variant 2|1|64|128|\n\n\n-----\n\n## Création d’une nouvelle signature\n\n\n-----\n\n-----\n\n-----\n\n-----\n\n-----\n\n-----\n\n-----\n\n-----\n\n-----\n\n-----\n\n-----\n\n-----\n\n-----\n\n-----\n\n-----\n\n-----\n\n#### Nouvelle signature YARA\n\n\n###### Basée sur :\n\n > L’algorithme de déchiffrement du nom de fichier\n > L’algorithme de dérivation de clé\n > Les mécanismes d’obfuscation\n > Le patch\n\n\n-----\n\n#### Nouvelle signature YARA\n\n\n-----\n\n#### Nouvelle signature YARA\n\n\n-----\n\n## Pivoter / Trouver des nouveaux samples\n\n\n## Pivoter / Trouver des nouveaux samples\n\n\n-----\n\n## Un nouveau fichier sur VirusTotal\n\n\n-----\n\n-----\n\n|Fichier|Motif 1|Motif 2|Motif 3|\n|---|---|---|---|\n|Initial|48|0|0|\n|Variant 1|69|136|136|\n|Variant 2|1|64|128|\n|Variant 3|0|280|280|\n\n\n-----\n\n|Fichier|Motif 1|Motif 2|Motif 3|\n|---|---|---|---|\n|Initial|48|0|0|\n|Variant 1|69|136|136|\n|Variant 2|1|64|128|\n|Variant 3|0|280|280|\n\n\n-----\n\n-----\n\n-----\n\n-----\n\n-----\n\n#### Nouveau fichier\n\n###### Nombreuses similarités :\n\n > 4 motifs sur 5 sont présents\n > seul l’algorithme de dérivation de clé absent\n\n Confiance assez élevée sur l’association avec TA410/FlowCloud\n\n\n-----\n\n## Possibilité d’aller plus loin ?\n\n\n## Possibilité d’aller plus loin ?\n\n\n-----\n\n-----\n\n## Est-ce que msedgeupdate.dat existe ?\n\n\n-----\n\n-----\n\n## Déchiffrement et chargement dans IDA Pro\n\n\n-----\n\n#### Shellcode\n\n###### > Algorithme de dérivation de clé\n > Déchiffre et charge l’étape suivante (FlowCloud)\n > Protégée par VMProtect\n > Extraction de l’adresse IP du C2\n\n\n-----\n\n#### Shellcode\n\n###### > Algorithme de dérivation de clé\n > Déchiffre et charge l’étape suivante (FlowCloud)\n > Protégée par VMProtect\n > Extraction de l’adresse IP du C2\n\n\n-----\n\n#### Shellcode\n\n###### > Algorithme de dérivation de clé\n > Déchiffre et charge l’étape suivante (FlowCloud)\n > Protégée par VMProtect\n > Extraction de l’adresse IP du C2\n\n\n-----\n\n#### Shellcode\n\n###### > Algorithme de dérivation de clé\n > Déchiffre et charge l’étape suivante (FlowCloud)\n > Protégée par VMProtect\n > Extraction de l’adresse IP du C2\n\n\n-----\n\n#### Shellcode\n\n###### > Algorithme de dérivation de clé\n > Déchiffre et charge l’étape suivante (FlowCloud)\n > Protégée par VMProtect\n > Extraction de l’adresse IP du C2\n\n\n-----\n\n## Bilan\n\n\n-----\n\n#### Bilan\n\n###### > Pivot via la création d’une règle YARA sur :\n\n > des mécanismes d’obfuscation\n > des algorithmes cryptographique\n\n > Un nouveau fichier trouvé avec 0 détection sur VirusTotal\n\n > Associé à FlowCloud/TA410 (confiance élevée)\n\n > Pivot via l’adresse IP compliqué\n\n\n-----\n\n#### Bilan\n\n###### > Pivot via la création d’une règle YARA sur :\n\n > des mécanismes d’obfuscation\n > des algorithmes cryptographique\n\n > Un nouveau fichier trouvé avec 0 détection sur VirusTotal\n\n > Associé à FlowCloud/TA410 (confiance élevée)\n\n > Pivot via l’adresse IP compliqué\n\n\n-----\n\n#### Bilan\n\n###### > Pivot via la création d’une règle YARA sur :\n\n > des mécanismes d’obfuscation\n > des algorithmes cryptographique\n\n > Un nouveau fichier trouvé avec 0 détection sur VirusTotal\n\n > Associé à FlowCloud/TA410 (confiance élevée)\n\n > Pivot via l’adresse IP compliqué\n\n\n-----\n\n## Conclusion\n\n\n-----\n\n## Conclusion\n\n###### > Présentation la démarche d’un reverser\n\n > Les attaquants mettent à jour leur code\n\n > Mais on peut réussir à les suivre\n\n > Panorama non exhaustif de l’analyse de malware\n\n\n-----\n\n# Questions?\n\n\n###### Charles Meslay\n\n\n-----",
    "language": "FR",
    "sources": [
        {
            "id": "bf5be533-fa31-4590-ae37-5761c97ffa34",
            "created_at": "2022-10-25T16:13:58.389257Z",
            "updated_at": "2022-10-25T16:13:58.389257Z",
            "deleted_at": null,
            "name": "Malpedia",
            "url": "https://malpedia.caad.fkie.fraunhofer.de",
            "description": "Malpedia is a free service offered by Fraunhofer FKIE",
            "reports": null
        }
    ],
    "references": [
        "https://www.sstic.org/media/SSTIC2024/SSTIC-actes/la_retro-ingnierie_de_code_malveillant_dans_la_cti/SSTIC2024-Slides-la_retro-ingnierie_de_code_malveillant_dans_la_cti_-_analyse_de_levolution_dune_chaine_dinfection-meslay.pdf"
    ],
    "report_names": [
        "SSTIC2024-Slides-la_retro-ingnierie_de_code_malveillant_dans_la_cti_-_analyse_de_levolution_dune_chaine_dinfection-meslay.pdf"
    ],
    "threat_actors": [
        {
            "id": "faa4a29b-254a-45bd-b412-9a1cbddbd5e3",
            "created_at": "2022-10-25T16:07:23.80111Z",
            "updated_at": "2025-03-27T02:02:09.985067Z",
            "deleted_at": null,
            "main_name": "LookBack",
            "aliases": [
                "FlowingFrog",
                "LookBack",
                "LookingFrog",
                "TA410",
                "Witchetty"
            ],
            "source_name": "ETDA:LookBack",
            "tools": [
                "FlowCloud",
                "GUP Proxy Tool",
                "SodomMain",
                "SodomMain RAT",
                "SodomNormal"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "9ffcbb0c-7a0f-419f-a174-f18a02ce47f1",
            "created_at": "2023-01-06T13:46:39.059774Z",
            "updated_at": "2025-03-27T02:00:02.98747Z",
            "deleted_at": null,
            "main_name": "TA410",
            "aliases": [],
            "source_name": "MISPGALAXY:TA410",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "3e8f802c-efba-45ff-8844-5ea4e4a5297d",
            "created_at": "2023-11-07T02:00:07.092751Z",
            "updated_at": "2025-03-27T02:00:03.170625Z",
            "deleted_at": null,
            "main_name": "Witchetty",
            "aliases": [
                "LookingFrog"
            ],
            "source_name": "MISPGALAXY:Witchetty",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "ec14074c-8517-40e1-b4d7-3897f1254487",
            "created_at": "2023-01-06T13:46:38.300905Z",
            "updated_at": "2025-03-27T02:00:02.799108Z",
            "deleted_at": null,
            "main_name": "APT10",
            "aliases": [
                "TA429",
                "STONE PANDA",
                "POTASSIUM",
                "Red Apollo",
                "HOGFISH",
                "Cloud Hopper",
                "BRONZE RIVERSIDE",
                "ATK41",
                "G0045",
                "Menupass Team",
                "happyyongzi",
                "CVNX",
                "Granite Taurus"
            ],
            "source_name": "MISPGALAXY:APT10",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "ba3fff0c-3ba0-4855-9eeb-1af9ee18136a",
            "created_at": "2022-10-25T15:50:23.298889Z",
            "updated_at": "2025-03-27T02:00:55.433541Z",
            "deleted_at": null,
            "main_name": "menuPass",
            "aliases": [
                "menuPass",
                "POTASSIUM",
                "Stone Panda",
                "APT10",
                "Red Apollo",
                "CVNX",
                "HOGFISH",
                "BRONZE RIVERSIDE"
            ],
            "source_name": "MITRE:menuPass",
            "tools": [
                "certutil",
                "FYAnti",
                "UPPERCUT",
                "SNUGRIDE",
                "P8RAT",
                "RedLeaves",
                "SodaMaster",
                "pwdump",
                "Mimikatz",
                "PlugX",
                "PowerSploit",
                "ChChes",
                "cmd",
                "QuasarRAT",
                "AdFind",
                "Cobalt Strike",
                "PoisonIvy",
                "EvilGrab",
                "esentutl",
                "Impacket",
                "Ecipekac",
                "PsExec",
                "HUI Loader"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "ba9fa308-a29a-4928-9c06-73aafec7624c",
            "created_at": "2024-05-01T02:03:07.981061Z",
            "updated_at": "2025-03-27T02:05:17.28602Z",
            "deleted_at": null,
            "main_name": "BRONZE RIVERSIDE",
            "aliases": [
                "CTG-5938 ",
                "CVNX ",
                "Hogfish ",
                "MenuPass ",
                "POTASSIUM ",
                "Red Apollo ",
                "Stone Panda ",
                "APT10 "
            ],
            "source_name": "Secureworks:BRONZE RIVERSIDE",
            "tools": [
                " ChChes",
                " Cobalt Strike",
                " PlugX",
                " PoisonIvy",
                " QuasarRAT",
                " QuasarRAT Loader",
                " RedLeaves",
                "ANEL"
            ],
            "source_id": "Secureworks",
            "reports": null
        }
    ],
    "ts_created_at": 1719281174,
    "ts_updated_at": 1743041591,
    "ts_creation_date": 0,
    "ts_modification_date": 0,
    "files": {
        "pdf": "https://archive.orkl.eu/58cb9697a33612ca506f69acb860ac8d952af20d.pdf",
        "text": "https://archive.orkl.eu/58cb9697a33612ca506f69acb860ac8d952af20d.txt",
        "img": "https://archive.orkl.eu/58cb9697a33612ca506f69acb860ac8d952af20d.jpg"
    }
}