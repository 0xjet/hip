{
    "id": "73230b15-4fc6-4472-aec1-bcee3ac8e499",
    "created_at": "2023-02-02T02:08:29.67238Z",
    "updated_at": "2025-03-27T02:06:10.651563Z",
    "deleted_at": null,
    "sha1_hash": "ba0af35deedaf007bbe44877588bb13c259a5223",
    "title": "2023-01-24 - The Year of the Wiper",
    "authors": "",
    "file_creation_date": "2023-02-01T07:52:37Z",
    "file_modification_date": "2023-02-01T07:52:37Z",
    "file_size": 573140,
    "plain_text": "# The Year of the Wiper\n\n**fortinet.com/blog/threat-research/the-year-of-the-wiper**\n\nJanuary 24, 2023\n\nFortiGuard Labs has been actively tracking wiper malware targeting Ukrainian organizations\nsince the start of the 2022 Russia-Ukraine conflict. The sudden spike in wiper malware\nbegan early in the year with numerous new wiper samples targeted at Ukraine. It displayed a\n[side of cyberattacks we rarely see: pure destruction. We published an article last April 2022](https://www.fortinet.com/blog/threat-research/the-increasing-wiper-malware-threat)\nto help people understand the context, history, and technical setup of wiper attacks. This\npost focuses on what happened the rest of the year and how wiper malware and their attack\nscenarios have changed.\n\n**Affected Platforms: Multiple**\n\n**Impacted Users: Large organizations**\n\n**Impact: Data loss and OS and file corruption**\n**Severity Level: High**\n\n\n-----\n\n## Recap\n\nSince that last report, quite a few new samples have been launched. Figure 1 shows an\nupdated version of a timeline we have used in the past. In April, we were already surprised\nby the significant increase in wipers. As you can see, it increased even further over the rest\nof the year.\n\nFigure 1 - Wiper malware timeline\n\n## Wipers in the War\n\nMuch of the wiper malware seen in the first half of 2022, whether attributed or not, was\ndeployed against Ukrainian organizations. These include HermeticWiper, CaddyWiper,\nIsaacWiper, WhisperGate, and others. When you think about it, the growth in wiper malware\nduring a conflict is hardly a surprise. It can scarcely be monetized. The only viable use case\nis destruction, sabotage, and cyberwar.\n\nOne interesting event was the AcidRain wiper malware that targeted the satellite modems of\na global satellite communications provider, which caused modems to lose connections to\ntheir satellite network. The message was clear: even if a cyberattack is used to target\nUkraine, its effects can easily spill over and affect other countries and organizations. It is vital\nthat we track these new highly malicious attacks.\n\n## Motivation: Hacktivism\n\nAs the year progressed, pro-Russian hacktivism also increased. We saw that in our\ntelemetry, showing, for example, an increase in DDOS attacks in Nordic countries, especially\nFinland (Figure 2).\n\nFigure 2 - Fortinet combined IPS, malware, and botnet detections in the Nordic countries\n\nHowever, hacktivism is usually associated with DoS and defacement attacks. But this time,\nsome actors began repurposing their ransomware as wipers by not providing a decryption\nkey. And if no decryption is provided, then ransomware essentially acts as a wiper. We saw\nactors begin to do this intentionally.\n\nFor instance, the Somnia ransomware was deployed at several Ukrainian organizations. The\nattackers compromised systems using a fake software installer and established a persistent\npresence. Like most ransomware attacks, they exfiltrated data and kept their access as long\nas needed. But at the end of the attack, no decryptor was offered, meaning the files\nremained encrypted and useless.\n\n## The Most Intriguing Wiper of the Year\n\n\n-----\n\nThe most intriguing wiper we documented in the second half of 2022 was one named Azov.\nIts second version quickly drew media attention because it delivered a message written in\nthe name of well-known security researchers. These researchers denied any connection to\nthe malware. It also delivered a pro-Ukrainian message claiming it was using the malware to\ndraw more attention to the Ukraine-Russia war. However, so far, no attribution has been\nmade.\n\nHowever, as it turned out, the message was not the most interesting part of the malware. It is\nalso very compelling from a technical perspective.\n\nFirst, it was written in the assembly language and built with the FASM tool. This is unusual\nbecause most new malware is written in languages such as python, .NET or C/C++. It also\ncontradicts everyone’s first impression that it was a prank used to blame security\nresearchers. However, it seems unlikely that anybody would go to the effort to write malware\nin assembly just for a joke.\n\nIt also implements polymorphic code creation to inject itself into legitimate EXE files on the\ninfected machine. It then executes a backdooring function by injecting a modified version of\nitself into EXE files. This provides persistence to the malware because it can run again once\nthe backdoored files are executed.\n\nIt also implements a variety of anti-analysis techniques:\n\nOpaque predicates\nAnti-debug\nSyntactic bloat and junk code\nUsing CALL instructions instead of RET or JMP\nDynamically creating the Import Address Table\n\nAll this demonstrates that this malware was not created for fun. It is a sophisticated wiper\nthat implements a variety of modern techniques, clearly showing that a sophisticated threat\nactor.\n\n## Improving Performance\n\nRansomware authors understand that encryption speed is often crucial for a successful\noperation. Once encryption is started, they are in a race against the incident response team,\nwho might detect them at any time. As a result, performance optimization was developed.\nSome new ransomware now implements a multi-threaded architecture that enables it to run\nmultiple encryption threads in parallel. Other operators have realized that encrypting files in\ntheir entirety is time-consuming—and may not even be necessary. The BlackCat\nransomware, for instance, implements multiple different encryption strategies with varying\n[improvements in performance (see this VirusBulletin presentation).](https://www.virusbulletin.com/conference/vb2022/abstracts/encryption-time-flies-when-youre-having-fun-case-exotic-blackcat-ransomware/)\n\n\n-----\n\nA similar problem exists for wipers. Traditionally, wipers would erase an entire disk using a\nkernel driver, delete files using different techniques, and/or alter the content of files (more on\n[techniques in our last article). These all take time. As a result, some authors began](https://www.fortinet.com/blog/threat-research/the-increasing-wiper-malware-threat)\nexperimenting with performance optimization.\n\nThe DoubleZero wiper, for instance, only erases the first 4096 bytes of targeted files. This\nmeans that most of the data in an average file would not be erased. However, it’s also true\nthat restoring these files at scale would be very impractical. For instance, modern Microsoft\n.docx files are essentially a collection of compressed XML files. Deleting the first 4096 bytes\nfrom them would corrupt the compression and the generic file structure, meaning these files\nwould not work anymore. Recreating a functioning file with manual forensic work might be\npossible, but it is simply not feasible when dealing with hundreds or thousands of files.\n\nThe Azov wiper also implemented a somewhat more optimized wiping process. It does not\nremove all data in each file. Instead, it only targets 666 bytes in an alternating pattern (666\nbytes overwritten, 666 bytes intact, 666 bytes overwritten, etc.) up to 4 GB.\n\n## Targeting OT\n\nOT environments also saw their fair share of wipers. We already mentioned the attack\nagainst the satellite provider (and, by extension, the German windmills). Another interesting\nattack using the Industroyer.V2 malware targeted a Ukrainian high-voltage electric\nsubstation. That attack aimed to manipulate the electric relays to take the substation offline.\nIn the context of OT, I would consider the use of the Industroyer.V2 malware in this context\nas a wiper. Traditional IT wipers have the goal of destroying the crown jewels of IT, the data.\nIndustroyer.V2 was used to destroy the crown jewel of that substation, its operation.\n\nIf this was not enough, the Industroyer.V2 malware was deployed along with three other\nwipers, potentially from different actors:\n\nCaddyWiper for Windows machines\nAWFULSHRED for Linux, Unix machines\nSOLOSHRED for Solaris machines\n\nThis helps serve as a reminder that OT environments are being actively targeted by different\nthreat actors, ranging from ransomware operators to state-sponsored APTs.\n\n## In Development\n\nAn interesting new project to pay attention to is the Endurance wiper. It is an open-source\nwiper that seemingly aspires to become ransomware. Figure 3 shows the malware’s features\nand readiness state as described by the author.\n\nFigure 3 - Endurance wiper/ransomware features\n\n\n-----\n\nCurrently, Endurance s file-wiping capabilities offer three wiping modes, with each mode\ndefining how many times content should be overwritten. It also offers CONTENT deletion and\nFILE deletion functions. The CONTENT deletion (Figure 4) function is responsible for\noverwriting the contents of a file on disk.\n\nFigure 4 - Loop to overwrite the file's content multiple times\n\nThe FILE deletion function (Figure 5) updates all file attributes and then erases the file from\nthe disk.\n\nFigure 5 - File deletion overwrites all file attributes and removes the file\n\nThis tool is actively in development, although at the time of testing, we had to fix the code\nbuild it. Since it is open-source, this could provide an easy entry point for attackers wanting\nto join the wiper/ransomware game.\n\n## Conclusion\n\n2022 provided us with new perspectives on destructive malware. We saw different wiping\ntechniques, different motivations, and differentmotivations, actors, and deployment\nscenarios. New wiper instances, such as the Azov and Endurance wipers, show that actors\nare actively engaged in increasingly malicious activity. They are also trying to address\nshorter threat detection and response time by effectively optimizing the performance of their\nwiping strategies. And we are also seeing increased attention being paid to OT networks,\nsuch as the example of the Industroyer.V2 malware. The point is clear. The gloves are off as\nthreat actors increasingly engage in attacks designed with one purpose: to destroy their\ntargets.\n\n## Fortinet Protection\n\nThe Fortinet Antivirus engine protects against all binaries discussed in this report using the\nfollowing signatures:\n\nW32/KillDisk.NCV!tr\n\nW32/Agent.OJC!worm\n\nW32/KillMBR.NHQ!tr\n\nW32/CaddyWiper.NCX!tr\n\nW32/KillFiles.NKU!tr.ransom\n\nW32/KillMBR.NGI!tr\n\n\n-----\n\nMSIL/Agent.FP!tr.dldr\n\nMSIL/Agent.QWILJV!tr\n\nW32/KillFiles.NKU!tr.ransom\n\nMSIL/VVH!tr\n\nMSIL/Agent.VVH!tr\n\nW32/DISTTRACK.C!tr\n\nW32/Generic.BQYIIWO!tr\n\nW64/DistTrack.A!tr\n\nW32/Ordinypt.5873!tr.ransom\n\nW32/OlympicDestroyer.A!tr\n\nW32/Petya.EOB!tr\n\nW32/Petya.A!tr.ransom\n\nW64/Petya.BG!tr\n\nW32/Agent.F0FC!tr\n\nW64/Dustman.KH!tr\n\nW32/Distrack!tr\n\nW32/Agent.XACVYS!tr\n\nW32/Distrack!tr\n\nMSIL/DZeroWiper.CK!tr\n\nELF/AcidRain.A!tr\n\nMSIL/KillMBR.X!tr\n\nMSIL/KillDisk.I!tr\n\nW32/PossibleThreat\n\nThe FortiGuard Web Filtering service rates the C2 server as ‘Malicious’ and blocks it\naccordingly.\n\n\n-----\n\nFortiMail and FortiSandbox detect and quarantine the malicious attachments in this\ncampaign, and Fortinet’s CDR (Content Disarm and Reconstruction) service can disable\nthem.\n\nFortiEDR natively detects and blocks the malicious executables identified in the report based\non their behavior.\n\nIn addition to these protections, Fortinet can help train users to detect and understand\nphishing threats:\n\nThe [FortiPhish Phishing Simulation Service uses real-world simulations to help organizations](https://www.fortinet.com/products/phishing-simulation)\ntest user awareness and vigilance to phishing threats and to train and reinforce proper\npractices when users encounter targeted phishing attacks.\n\nOur FREE [NSE training program—NSE 1 – Information Security Awareness—includes a](https://training.fortinet.com/?utm_source=blog&utm_campaign=nse-institute)\nmodule on Internet threats designed to help end users learn how to identify and protect\nthemselves from phishing attacks.\n\n## IOCs\n\n650f0d694c0928d88aeeed649cf629fc8a7bec604563bca716b1688227e0cc7e - Azov\n\n100c5e4d5b7e468f1f16b22c05b2ff1cfaa02eafa07447c7d83e2983e42647f0 Somnia_07_08_22_with_FunnySomnia.rar\n\nac5e68c15f5094cc6efb8d25e1b2eb13d1b38b104f31e1c76ce472537d715e08 Somnia_07_08_22_with_FunnySomnia.exe (Somnia)\n\n99cf5c03dac82c1f4de25309a8a99dcabf964660301308a606cdb40c79d15317 - 1.exe\n(Cobalt Strike Beacon)\n\n156965227cbeeb0e387cb83adb93ccb3225f598136a43f7f60974591c12fafcf funnysomnia.exe\n\ne449c28e658bafb7e32c89b07ddee36cadeddfc77f17dd1be801b134a6857aa9 - text.exe\n(Somnia*)\n\nfbed7e92caefbd74437d0970921bfd7cb724c98c90efd9b6d0c2ac377751c9e5 Ip_scanner.zip\n\n06fe57cadb837a4e3b47589e95bb01aec1cfb7ce62fdba1f4323bb471591e1d2 Ip_scanner.exe (Themida; Vidar)\n\n1e0facd62d1958ccf79e049270061a9fce3223f7986c526f6f3a93ef85180a72 Ip_scanner_unpacked.exe (Vidar)\n\n\n-----\n\n3b2e708eaa4744c76a633391cf2c983f4a098b46436525619e5ea44e105355fe – DoubleZero\n\n931b6b29e13d76a0e2e1e8b6910873d5ff7b88fd8c51cadf46057e47b695f187 – Endurance\n\nBDF8B53D73CA1ED1B649B32A61608B2CF952397EF3D5FC2E6E9F41AD98C40110 –\nCry Wiper\n\n91a9180a9cf7674c34ed53a8aa4e36b798334d1f448aeaf1afb9add4fd322b6e – Fantasy\n\n0ad0cd07ca69d8fd2b075fef6e6dd5e9f7debca92af3a6b84d83e51e23bc182d – Bruh Wiper\n\n_Learn more about Fortinet’s_ _[FortiGuard Labs threat research and global intelligence](https://www.fortinet.com/fortiguard/labs?utm_source=blog&utm_medium=blog&utm_campaign=fortiguard-labs)_\n_[organization and Fortinet’s FortiGuard AI-powered Security Services portfolio.](https://www.fortinet.com/solutions/enterprise-midsize-business/security-as-a-service/fortiguard-subscriptions?utm_source=blog&utm_medium=blog&utm_campaign=fortiguard-subscriptions)_ _[Sign up to](https://www.fortinet.com/blog/threat-research?utm_source=blog&utm_medium=blog&utm_campaign=threat-research)_\n_receive our threat research blogs._\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2023/2023-01-24 - The Year of the Wiper.pdf"
    ],
    "report_names": [
        "2023-01-24 - The Year of the Wiper.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1675303709,
    "ts_updated_at": 1743041170,
    "ts_creation_date": 1675237957,
    "ts_modification_date": 1675237957,
    "files": {
        "pdf": "https://archive.orkl.eu/ba0af35deedaf007bbe44877588bb13c259a5223.pdf",
        "text": "https://archive.orkl.eu/ba0af35deedaf007bbe44877588bb13c259a5223.txt",
        "img": "https://archive.orkl.eu/ba0af35deedaf007bbe44877588bb13c259a5223.jpg"
    }
}