{
    "id": "6e6b17a5-52b5-4da8-8951-745fed18454a",
    "created_at": "2023-03-04T02:07:16.355559Z",
    "updated_at": "2025-03-27T02:17:22.958299Z",
    "deleted_at": null,
    "sha1_hash": "9f0ac45dbfeeded1ad46f09e104640566c8f7eda",
    "title": "Lazarus group using public certificate vulnerability",
    "authors": "Ahnlab",
    "file_creation_date": "2023-03-01T17:04:54Z",
    "file_modification_date": "2023-03-01T17:04:54Z",
    "file_size": 913167,
    "plain_text": "# Lazarus attack group attack case using public certificate software vulnerability widely used by public institutions and universities\n\n**asec.ahnlab.com/ko/48416**\n\nnuno Feb 2023, 2\n\nSince last year (March 2021), the Lazarus attack group's malware has been found in a number of domestic companies\nsuch as defense, satellite, software, and media companies, and the AhnLab Security Emergency Response Center (ASEC)\nhas been continuously tracking and analyzing the activities of the Lazarus attack group and related malware.\n\nThe affected customer in this case had already been breached once by the Lazarus attack group in May 2022, and the\nbreach recurred due to a 5-day vulnerability in the same software. At the time of the May 0 breach, the customer was\nusing a weak version of the certificate-related program widely used in public institutions and universities, and all the\nsoftware was updated to the latest version after the accident. This time, however, it was breached by a 2022-day\nvulnerability in the software.\n\nASEC has reported the software to KISA, but the vulnerability has not been clearly identified, and the manufacturer and\nsoftware are not disclosed in this article because no software patch has been released yet.\n\nIn addition to this incident, the Lazarus Group is continuously researching various software vulnerabilities to infiltrate\ndomestic institutions and companies, and is continuously changing TTP by disabling security products, and using antiforensic technologies to hinder and delay detection and analysis.\n\nThis report is based on the victim's forensic analysis report. The report was prepared in January, but after delaying\ndisclosure due to software vulnerability patching issues, the company decided to release the software information after\nanonymizing it. When a software patch is released, we will redistribute a report of the version that released the\ninformation.\n\n## Outline of the incident\n\n|CATEGORY|DESCRIPTION|\n|---|---|\n|Duration of the incident|2022/10/21 ~ 2022/11/18|\n|Customer Type|Financial Business|\n|Damage System Type|Windows 10|\n|Damage Status|Backdoor malware infection and C2 communication|\n|Types of attacks|Lateral movement using 0-Day vulnerability of company A's certificate program ※ Since the patch has not yet been released, vulnerable soft ware information is not disclosed Disabling vaccines through BYOVD attacks Anti-forensics Timestamp operation Change the file name randomly and delete it Delete execution artifacts Use the same file name as the system file name|\n|assailant|Lazarus|\n\n\n-----\n\nIncident\nTAG\n\n\n#Lazarus #skypeserver.exe #0-day #루트킷 #BYOVD\n\n\n\n[table] analysis summary\n\n[Figure] Infringement Flow Chart\n\n### Lessons from examples\n\nThe attackers took advantage of a 0-Day vulnerability in the public certificate software widely used in the country.\nThis type of software does not update automatically, so be sure to patch the latest version of your software and\nuninstall it if you are not using it.\nThe attackers defeated the security product using a technique called BYOVD, which exploits a vulnerable driver\nkernel module.\nThe attackers performed anti-forensic acts, such as changing and deleting files to conceal malicious behavior, or\nmanipulating time information.\nThe victim was re-breached by the same attacker in a similar way. In addition to reactive measures, continuous\nmonitoring must prevent the threat from recurring.\n\n## Case Details\n\n\n-----\n\n**Summary of analysis results**\n\nAfter analyzing the two PCs received from the customer, it was confirmed that PC01 and PC02 were subjected to lateral\nmovement attacks using vulnerabilities in the certificate software. PC02 was attacked from an unidentified internal\nsystem on October 10, and PC21 was attacked by PC01 on November 11. Given that PC18 and PC02 had the latest version\nof certificate software installed, it is believed that the attacker used a 01-Day vulnerability. In addition, PC02 and PC0\nexperienced V01 incapacitation on November 02, but a different method was used.\n\nThe system analyzed this time was subjected to a lateral movement attack and was not related to the initial influx of\nattackers. It is believed that the victim's Internet network was threatened by the Lazarus attack group, which successfully\nbroke in in May.\n\nSYSTEM DATE DESCRIPTION\n\nPC01 2022/11/18 Lateral movement attack\n\ndue to certificate software\nvulnerability ( PC02 → PC01 )\n\n2022/11/18 V3 Disabling Occurs\n\nPC02 2022/10/21 Lateral movement attack\n\ndue to certificate software\nvulnerability ( unknown internal\nsystem → PC02 )\n\n2022/11/18 V3 Disabling Occurs\n\n[Table] Major malicious actions by each system\n\n**PC01 Analysis**\n\nPC01 is believed to have been compromised by a 2022-Day vulnerability attack in certificate software on 11/18/10\n00:35:0. Three network connection attempts were made from PC02 to the service TCP port of PC01's certificate software.\nIn the previous two connections, there was no special response from PC01, but when PC02 accessed PC11 at 18:10 on\n00/01 using skypeserver.exe (unsecured) created using svchost.exe, PC01 encountered an error (AppCrash) in the\ncertificate software, and malicious actions began thereafter. When AppCrash occurred, all error reports (WARs) and\nmemory dump files stored in the system were deleted and could not be checked. It appears to have been intentionally\ndeleted by the attackers.\n\nDATE DESCRIPTION REMARKS\nTIME\n\n2022/11/15 svchost.exe network Presumed\n16:18:52 connection to be an\n\n10.20.XXX.125:XXXXX attack\n\nfailure or\nconnection\ntest\n\n2022/11/18 svchost.exe network Presumed\n9:49:31 connection to be an\n\n10.20.XXX.125:XXXXX attack\n\nfailure or\nconnection\ntest\n\n2022/11/18 network connection .exe Successful\n10:00:27 skypeserver exploits\n\n10.20.XXX.125:XXXXX\n\n[Table] History of access from PC02 to certificate software service port of PC01 (V3 behavior log)\n\n|SYSTEM|DATE|DESCRIPTION|Col4|\n|---|---|---|---|\n|PC01|2022/11/18|Lateral movement attack due to certificate software vulnerability ( PC02 → PC01 )||\n||2022/11/18|V3 Disabling Occurs||\n|PC02|2022/10/21|Lateral movement attack due to certificate software vulnerability ( unknown internal system → PC02 )||\n||2022/11/18|V3 Disabling Occurs||\n\n|DATE TIME|DESCRIPTION|REMARKS|\n|---|---|---|\n|2022/11/15 16:18:52|svchost.exe network connection 10.20.XXX.125:XXXXX|Presumed to be an attack failure or connection test|\n|2022/11/18 9:49:31|svchost.exe network connection 10.20.XXX.125:XXXXX|Presumed to be an attack failure or connection test|\n|2022/11/18 10:00:27|network connection .exe skypeserver 10.20.XXX.125:XXXXX|Successful exploits|\n\n\n-----\n\n[Figure] Record of Crashdump File Generation in Certificate Software\n\nAmong the traces identified in PC01, the difference from the attack that occurred in May is that the process used after the\nvulnerability attack in the certificate software was svchost.exe rather than ftp .exe, and the vulnerable version of the\nsoftware was installed at the time, but this time all the latest versions were installed, so there is no known vulnerability\ninformation.\n\nTARGET INSTALL SOFTWARE COMPROMISED\nDATE VERSION DATE\n\nPC01 2022/07/01 Up-to-date 2022/11/18\n\nPC02 2022/08/30 Up-to-date 2022/10/21\n\n[table] Certificate software versions installed on PC01 and PC02\n\nAfter accessing PC01, the attacker injected a malicious thread into a normal process (svchost.exe) and used it for C2\ncommunication and backdoor. It then neutralized the V3 product installed on the system, and created and executed\nadditional malicious files.\n\nIn addition, in this analysis, traces of manipulation of the timestamp of malicious files were confirmed, and anti-forensic\nbehaviors such as randomly changing and deleting file names when deleting files were found, so it seems that attackers\nare actively interfering with the analysis.\n\n**TIMELINE (PC01)**\n\nThe timeline of the infringement identified in PC01 is as follows:\n\n|TARGET|INSTALL DATE|SOFTWARE VERSION|COMPROMISED DATE|\n|---|---|---|---|\n|PC01|2022/07/01|Up-to-date|2022/11/18|\n|PC02|2022/08/30|Up-to-date|2022/10/21|\n\n|TIME (22/11 /18)|CATEGORY|BEHAVIORS|\n|---|---|---|\n|10:00:37|injection|svchost.exe injects a malicious thread into a running process to start malicious activity|\n\n\n-----\n\n|10:00:37|C2 communication|svchost.exe connects to the attacker's C2 address  121.78.246.155(dalbinews.co.kr)|\n|---|---|---|\n|10:10:01|Malicious file creation|Malicious file creation C:\\ProgramData\\tszui. tmp (unsecured)|\n|10:17:55|Anti-forensics|Rename and delete malicious files Rena me: C:\\ProgramData\\tszui.tmp -> Delete phqghumeaFile : C:\\ProgramData\\phqghumea (unsecured)|\n|10:18:47|C2 communication|svchost.exe connects to the attacker C2 address 121.78.158.46 (www.studyholic.com)|\n|10:20:28|Neutralize security products|V3 detects security product incapacitation (Exploit/Win.Lazardoor.GEN)|\n|10:20:24|C2 communication|Network connection to attacker C2 183.1 10.224.172 (ctmnews.kr)|\n|10:27:58|Malicious file creation|Malicious file creation C:\\ProgramData\\perlc ritic.exe (unsecured)|\n|10:28:53|Generate vulnerable driver files|Malicious file execution C:\\ProgramData\\perlcrit ic.exe (unsecured)Driver file creation (not malicious) C\\Windows\\System32\\drivers\\PROCEXP152.SYS (secured)|\n|10:29:16|Malicious file creation|Malicious file creation C:\\ProgramData\\tds.tm p (unsecured)|\n|10:29:36|Anti-forensics|Rename and delete malicious files Rena me: C:\\ProgramData\\tds.tmp -> mxnsbqyDelete files: C:\\ProgramData\\mxnsbqy (unsecured)|\n|10:41:33|Anti-forensics|Delete AppCrash File Delete File : C:\\ProgramData\\Microsoft\\Windows\\WER\\ReportArchive\\AppCrash_XXXXXXXXXXXX.exe _9474ee13fbc7651aabaf2f3c9b1fedc9e7489e51_bc343f60_ddd4e0eb-714c-4cf4-ae23- 43cd18c59603 (unsecured)|\n|10:42:19|Anti-forensics|Rename and delete malicious files Rena me: C:\\ProgramData\\perlcritic.exe -> kxlmatmoynktxlDelete files: C:\\ProgramData\\kxlmatmoynktxl (unsecured)|\n|10:44:31|Malicious file creation|Create (secure) backdoor loader (LegacyUserManager.dll) Loading target file: C:\\ProgramData\\Microsoft\\Crypto\\Keys\\Keys.dat (secured) C: \\ProgramData\\Microsoft\\Settings\\Settings.vwx (secured)|\n|10:44:47|Anti-forensics|Timestamp (Standard Information) operation of the backdoor loader (LegacyUserManager.dll) (Secure)|\n|10:45:47|Malicious file creation|Creation (Secured) of backdoor program (Keys.dat) Creation of malware with C2 access and file download function|\n|10:45:56|Anti-forensics|Timestamp (Standard Information) manipulation (Secured) of backdoor program (Keys.dat)|\n|10:46:12|Malicious file creation|Creation of backdoor program (Settings.vwx) (secured) Creation of malware with C2 access and file download function|\n|10:46:30|Anti-forensics|Timestamp (Standard Information) manipulation (Secured) of backdoor program (Keys.dat)|\n\n\n\n[table] Malicious behavior of attackers found on PC01\n\n\n-----\n\n### PC02 Analysis\n\nThe attacker was found to have accessed PC10 by exploiting a vulnerability in the certificate software on 21/10 48:48:02.\nAppCrash occurred during the attack of the vulnerability, after which the ftp .exe was executed and malicious behavior\nbegan. This is the same method that occurred in the affected customer in May. The IP of the system that accessed PC5\nhas not been determined.\n\n[Picture] Certificate Software Error Log Verified on PC02 (Application.evtx)\n\n[Picture] Certificate software found in V02 MDP log on PC3 and malicious thread injection code in ftp .exe\n\nAfter first infiltrating PC10 on 21/02, the attacker created a malicious file that performed C2 server communication and\nbackdoor functions through an injected ftp .exe.\n\nOn 10/27, unlike the attack on the 21st, instead of ftp.exe, it injected a malicious thread into the SVChost.exe process,\nafter which it carried out malicious actions with control until 11/18.\n\nOn 11/15, it was confirmed that an FSWss file .exe was created to scan the internal network. After that, it was confirmed\nthat he used svchost.exe to connect to the service port of PC01's certificate software twice.\n\nOn 11/18, a skypeserver.exe file was created and the file was used to access PC01's TCP XXXXX, and at this time, an\nAppCrash of the certificate software occurred on PC01, and then PC02 confirmed traces of disabling antivirus, creating\nand executing malicious files, etc., the same as PC01.\n\n**TIMELINE (PC02)**\n\nThe timeline of the infringement identified in PC02 is as follows:\n\n|DATE|TIME|CATEGORY|BEHAVIORS|\n|---|---|---|---|\n||10:48:50||ftp.exe connects the attacker to the C2 address and the network 111.92.189.48 (www.scope.co.kr)|\n||10:48:51||ftp.exe connects the attacker C2 address and network 183.110.224.172 (ctmnews.kr)|\n\n\n-----\n\n|Col1|10:49:46|Col3|ftp.exe connects the attacker C2 address to the network 115.68.52.47  (www.artinsight.co.kr)|\n|---|---|---|---|\n||10:51:35||ftp.exe connects the attacker to C2 address and network 114.108.129.89 (www.kfcjn.com)|\n||10:52:31||ftp.exe connects the attacker to C2 address and network 114.108.129.89 (www.kfcjn.com)|\n||10:59:33||ftp.exe connects the attacker to C2 address and network 114.108.129.89 (www.kfcjn.com)|\n||12:52:38||ftp.exe connects the attacker to C2 address and network 119.207.79.175 (lightingmart.co.kr)|\n||14:21:58|Malicious file creation|ftp.exe create file C:\\Window s\\System32\\lecacyusermanager.dll (secured)|\n||14:59:07||ftp.exe file created C:\\Windows\\System 32\\wptsextensions.dll (secured)|\n||15:34:47|Anti-forensics|Rename a malicious file Rename: C:\\Windows\\System32\\legacyusermanager.dll -> C:\\Windows\\temp\\lum.tmp (secured)|\n|22/10/27|15:25:00|injection|Injecting malicious threads into normal processes (svchost.exe)|\n||15:26:05|C2 communication|svchost.exe connects the attacker with C2 address 115.68.5 2.47|\n||15:27:53|Malicious file creation|svchost.exe created malicious file C:\\Windows\\System32\\wptsextensions.dll (secured)|\n||11:32:36|Create a file|svchost.exe created malicious file C:\\Prog ramData\\fswss.exe (unsecured)|\n||11:32:48|File execution|Network scanning with fswss.exe C:\\ ProgramData\\fswss.exe /scan /UseIPAddressesRange 1 /IPAddressFrom 10.20.XXX.1 /IPAddressTo 10.20.XXX.255 /stext C:\\ProgramData\\fswss.log|\n||11:33:41|Anti-forensics|Rename malicious files Rename: C:\\ProgramDa ta\\fswss.exe -> xeudsgpfo (unsecured)|\n||12:50:13|Malicious file creation|svchost.exe creates file C:\\ProgramData\\ fmsysn.exe (not secured)|\n||12:51:04|Execution of malicious files|svchost.exe runs other processes C :\\ProgramData\\fmSysN.exe 10.20.XXX.1 10.20.XXX.36 XXXXX 10 c:\\programdata\\fmSysN.log|\n\n\n-----\n\n|Col1|13:06:49|Anti-forensics|Rename  malicious files: C:\\ProgramData\\fmsysn.exe -> yfvepuvxbi (not secured)|\n|---|---|---|---|\n||16:18:52|Network Access|svchost.exe attempts to access certificate s oftware port on PC01 10.20.XXX.125:XXXXX(PC01)|\n||16:33:06|Malicious file creation|svchost.exe creates file C:\\ProgramData\\ skypeserver.exe (unsecured)|\n|22/11/18|9:49:31|Network Access|svchost.exe attempts to access certificate s oftware port on PC01 10.20.XXX.125:XXXXX(PC01)|\n||9:51:07|악성파일 생성|svchost.exe created malicious file C:\\Prog ramData\\skypeserver.exe (unsecured)|\n||9:56:31||svchost.exe가 악성파일 생성 C:\\ProgramData\\sfbappsdk.dll (미확보)|\n||10:00:08|C2 통신|skypeserver.exe가 공격자 C2주소와 네트워크 연 결 121.78.246.155(dalbinews.co.kr)|\n||10:00:27|네트워크 접근|skypeserver.exe가 인증서 소프트웨어 포트에 접근 성공 10.20.XXX.125:XXXXX(PC01)|\n||10:06:14|안티 포렌식|악성파일 이름 변경 이름 변경: C:\\ProgramData\\sfbappsdk.dll -> bxikemvkqhcsz (미확보)|\n||10:06:42||악성파일 이름 변경 변경 전: C:\\ProgramData\\skypeserver.exe -> kqcfqbxrgbfmwem (미확보)|\n||11:04:32|인젝션 C2 연결|정상 프로세스(svchost.exe)에 악성 스레드 인젝션 svchost.exe가 공격자 C2주소와 네트워크 연결 121.78.158.46(studyholic.co.kr)|\n||11:05:45|보안 제품 무력화|V3가 보안 제품 무력화 행위 탐지 (Exploit/Win.Lazardoor.GEN)|\n||11:06:56|취약한 드라이버 파일 생성|악성코드 생성 C:\\ProgramData\\perlcritic.exe (미확보)|\n||11:07:02||악성코드 실행 C:\\ProgramData\\perlcritic.exe (미확보)취약한 드라 이버 파일 생성 C:\\Windows\\System32\\drivers\\PROCEXP152.SYS (확보)|\n||11:12:18||악성코드 생성 및 실행 C:\\ProgramData\\perlcritic64.exe (미확보)|\n\n\n\n[표] PC02에서 발견된 공격자의 악성 행위\n\n## Major malicious acts\n\n\n-----\n\n**Disabling V3 by BYOVD**\n\nIn the PC01 and PC02 systems, an attempt to disable V11 was detected (Exploit/Win.Lazardoor.GEN) at 18/10 20:28:11\nand 05:45:3, respectively, and the period after which V3 was disabled is as follows:\n\nPC01: 11/18 10:20:28 ~ 11/18 11:25:00 (about 1 hour)\nPC02: 11/18 11:05:45 ~ 11/21 14:07:08 (about 75 hours)\n\nDuring this period, V3-related processes are running, but normal behavior detection is not possible. However, after the\nsystem reboots, V3 returns to normal.\n\n[Picture] V01 Neutralization Detection Log Seen on PC3\n\nAttackers need access to kernel memory to manipulate kernel memory on Windows systems to disrupt the operation of\nsecurity products, and in May, Taiwanese component manufacturer ENE Technology's ene.sys was used in a BYOVD\nattack.\n\nAt the time of detection of V01 incapacitation of PC02 and PC3, no trace of the attack method was found. Rather, a\nvulnerable driver file was created on the system after the V3 outbreak, which is the driver file of Procexp152 of\nProcessExplorer, a process management utility provided .SYS free of charge by Microsoft, and is a vulnerable driver that\ncan be used for BYOVD attacks. However, this driver file was created after V01 defeat on both PC02 and PC3, and was\nused by the perlcritic.exe (unsecured) file generated by the attacker.\n\nIn other words, the order of V3 defeat occurrence time and driver file creation time does not match, so it is a BYOVD\nattack, PROCEXP152. It is not yet possible to say whether SYS was used to neutralize V3.\n\nThe method that occurred in May and the method that occurred in November have the following differences.\n\n\n-----\n\n|CATEGORY|ATTACK IN MAY, 2022|ATTACK IN NOVEMBER, 2022|\n|---|---|---|\n|Attack Techniques|BYOVD Technique|Not verified|\n|Vulnerable drivers|Drivers from ENE Technology ene.sys|Microsoft's ProcessExplorer driver was created after V3 disabled PROCEXP152.sys|\n|loader|sb_smbus_sdk.dll|perlcritic.exe (not secured) perlcritic64.exe (unsecured)|\n|Service registration|Service registered|No sign of service registration|\n\n\n\n[Table] Comparison of traces related to V5 incapacitation in May and November\n\n**Antiforensics**\n\nPC01 and PC02 were found to have performed antiforensic actions to erase the traces of the attack.\n\n|CATEGORY|SYSTEM|DESCRIPTION|\n|---|---|---|\n|Manipulating timestamps on files|PC01, PC02|[PC01] C:\\Windows\\System32\\LegacyUserManager.dll Manipulated creation time : 2019-03-19 13:49:35 C:\\ProgramData\\Microsoft\\Crypto\\Keys\\Keys.dat Manipulated creation time : 2019-03-19 13:49:35 Manipulated/created time : 2019-12-25 23:24:06 C:\\ProgramData\\Microsoft\\Settings\\Settings.vwx Manipulated creation time : 2022-05-13 16:09:19 [PC02] C:\\Windows\\system32\\wptsextensions.dll Manipulated creation time : 2019-03-19 13:49:35|\n|Delete a file after rena ming a file|PC01, PC02|[PC01] C:\\ProgramData\\tszui.tmp -> phqghumea C:\\ProgramData\\perlcritic.exe ->kxlmatmoynktxl C:\\ProgramData\\tds.tmp -> mxnsbqy [PC02] C:\\ProgramData\\fswss.exe -> xeudsgpfo C:\\ProgramData\\fmsysn.exe -> yfvepuvxbi C:\\ProgramData\\sfbappsdk.dll -> bxikemvkqhcsz C:\\ProgramData\\skypeserver.exe -> kqcfqbxrgbfmwem|\n|Delete Prefetch|PC01|MSIEXEC.EXE-8FFB1633.pf, PERLCRITIC.EXE- 2EB3AC0F.pf and many more|\n\n\n-----\n\n[Table] Antiforensic Behavior Identified in PC01, PC02\n\n## Malware used by attackers\n\n**List of malware**\n\n|CATEGORY|FILENAME|SYSTEM|DESCRIPTION|\n|---|---|---|---|\n|loader|wptsextensions.dll|PC02|Path: C:\\Windows\\System32\\wptsextensions.dll Load Backdoor File Keys.dat|\n||legacyusermanager.dll|PC01 PC02|Path: C:\\Windows\\System32\\legacyusermanager.dll Load Backdoor File Keys.dat|\n||lum.tmp|PC02|Path: C:\\Windows\\Temp\\lum.tmp Load the backdoor file configmanager.tlb|\n|backdoor|Keys.dat|PC01 PC02|Path: C:\\ProgramData\\Microsoft\\Crypto\\Keys\\Keys.dat loaded by wptsextensions.dll 2022/11/18 14:56:54 GMT Designed to run after +9, additional commands can be performed via cmd.exe Downloads additional binaries from the C2 server and runs them in fileless form|\n||Settings.vwx|PC02|Loaded in wptsextensions.dll Randomly access from the following 3 C2s hxxps://www.artinsight[.] co.kr/data/admin/list.php hxxps://www.kfcjn[.] com/member/process/sms.php hxxps://ctmnews[.] kr/member/process/success.php|\n||Settings.vwx|PC01|Loaded in legacyusermanager.dll Randomly access from the following 3 C2s hxxps://www.artinsight[.] co.kr/data/admin/list.php hxxps://www.kfcjn[.] com/member/process/sms.php hxxps://ctmnews[.] kr/member/process/success.php|\n|Exploited legitimate files|ProcEXP152.sys|PC01 PC02|Path: C:\\Windows\\System32\\drivers\\PROCEXP152.SYS Drivers in ProcessExplorer Vulnerable driver module enables antivirus neutralization through BYOVD attacks|\n||fswss.exe|PC02|Path: C:\\ProgramData\\fswss.exe NirSoft utility with the ability to scan the network or turn on a remote computer WakeMeOnLan: https://www.nirsoft.net/utils/wake_on_lan.html|\n\n\n-----\n\nUnsecured\n\nfiles\n\n\nconfigmanager.tlb PC02 Path: C:\\Windows\\System32\\configmanager.tlb\nBackdoor estimation loaded by lum.tmp\n\n|perlcritic.exe perlcritic64.e xe|PC01 PC02|Path: C:\\ProgramData\\perlcritic.exe Executed by cmd.exe and loads PROCEXP152.SYS|\n|---|---|---|\n|sfbappsdk.dll|PC02|Path: C:\\ProgramData\\sfbappsdk.dll Injected svchost.exe created|\n|fmSysN.exe|PC02|Path: C:\\ProgramData\\fmSysN.exe Injected svchost.exe created The following traces of execution have been identified: fmSysN.exe 10.20.XXX.1 10.20.XXX.36 XXXXX 10 c:\\programdata\\fmSysN.log|\n|skypeserver.exe|PC02|Path: C:\\ProgramData\\skypeserver.exe Injected svchost.exe created C2 Connection|\n|tds.tmp|PC01|Path: C:\\ProgramData\\tds.tmp Deleted after being changed to a random file name|\n|tszui.tmp|PC01|Path: C:\\ProgramData\\tszui.tmp Deleted after being changed to a random file name|\n\n\n\n[table] List of malware\n\n**C2 used by attackers**\n\nCATEGORY IP DOMAIN\n\nftp.exe 최초 접 111.92.189.48 www[.]scope.co.kr\n근\n\n무력화 관련 C2 121.78.158.46 www[.]studyholic.com\n추정\n\n121.78.246.155 dalbinews[.]co.kr\n\n백도어 C2 119.207.79.175 –\n\n183.110.224.172 ctmnews[.]kr\n\n211.249.220.83 ctmnews[.]kr\n\n1.254.179.18 www[.]artinsight.co.kr\n\n103.6.182.57 www[.]artinsight.co.kr\n\n104.109.245.186 www[.]artinsight.co.kr\n\n112.106.58.23 www[.]artinsight.co.kr\n\n115.68.52.47 www[.]artinsight.co.kr\n\n|CATEGORY|IP|DOMAIN|REMARKS|\n|---|---|---|---|\n|ftp.exe 최초 접 근|111.92.189.48|www[.]scope.co.kr||\n|무력화 관련 C2 추정|121.78.158.46|www[.]studyholic.com||\n||121.78.246.155|dalbinews[.]co.kr||\n||119.207.79.175|–|5월 공격에 도 사용됨|\n||183.110.224.172|ctmnews[.]kr||\n||211.249.220.83|ctmnews[.]kr||\n||1.254.179.18|www[.]artinsight.co.kr||\n||103.6.182.57|www[.]artinsight.co.kr||\n||104.109.245.186|www[.]artinsight.co.kr||\n||112.106.58.23|www[.]artinsight.co.kr||\n\n\n-----\n\n|125.209.218.167|www[.]artinsight.co.kr|Col3|\n|---|---|---|\n|3.39.49.255|www[.]artinsight.co.kr||\n|34.199.186.157|www[.]artinsight.co.kr||\n|52.148.148.114|www[.]artinsight.co.kr||\n|104.21.64.83|www[.]kfcjn.com||\n|112.106.58.23|www[.]kfcjn.com||\n|114.108.129.89|www[.]kfcjn.com||\n|117.52.137.138|www[.]kfcjn.com||\n|13.107.21.200|www[.]kfcjn.com||\n|162.247.241.2|www[.] kfcjn.com||\n|23.50.0.140|www[.] kfcjn.com||\n|52.79.120.37|www[.] kfcjn.com||\n\n\n\n[table] List of C2s used by attackers\n\n## MITRE ATT&CK MAPPING\n\n|Tactics|TID|DESCRIPTION|\n|---|---|---|\n|Reconnaissance|–|–|\n|Resource Development|T1587.001 Develop Capabilities: Malware|Backdoor and loader fabrication|\n||T1587.004 Develop Capabilities: Exploits|Prepare for certificate software vulnerabilities|\n||T1588.002 Obtain Capabilities: Tool|fswss.exe (wakemeonlan by Nirsoft.exe)|\n|Initial Access|N/A||\n|Execution|T1059.003 Command and Scripting Interpreter: Windows Command Shell|Run perlcritic.exe|\n||T1203 Exploitation for Client Execution|Certificate Software Exploits|\n|Persistence|N/A|–|\n\n\n-----\n\n|Privilege Escalation|T1068 Exploitation for Privilege Escalation|PROCEXP152.sys|\n|---|---|---|\n|Defense Evasion|T1562.001 Impair Defenses: Disable or Modify Tools|V3 Incapacitation|\n||T1070 Indicator Removal|Delete Prefetch files|\n||T1070.004 Indicator Removal: File Deletion|Delete malicio us files – sfbappsdk.dll, fswss.exe, fmSysN.exe, skypeserver.exe, perlcritic.exe, perlcritic64.exe Delete crashdu mp files|\n||T1070.006 Indicator Removal: Timestomp|Change malicious file time information|\n|Credential Access|N/A|–|\n|Discovery|T1046 Network Service Discovery|fswss.exe, fmSysN.exe|\n|Lateral Movement|T1210 Exploitation of Remote Services|Internal movement using certificate software vulnerabilities|\n|Collection|N/A|–|\n|Command and Control|T1071.001 Application Layer Protocol: Web Protocols|C2Server Communication|\n||T1102 Web Service|Exploiting legitimate domains as C2 servers|\n|Exfiltration|N/A|–|\n|Impact|N/A|–|\n\n\n## IoC\n\n**Malicious files**\n\n\n-----\n\n|No|MD5 Hash|File Name|AhnLab Detection Name|\n|---|---|---|---|\n|1|61B3C9878B84706DB5F871B4808E739A|wptsextensions.dll|Trojan/Win.Lazardoor.C5327680|\n|2|C7256A0FBAB0F437C3AD4334AA5CDE06|legacyusermanager.dll|Trojan/Win.Lazardoor.C5327680|\n|3|A6602EF2F6DC790EA103FF453EB21024|lum.tmp|Trojan/Win.Lazardoor.C5327681|\n|4|FC8B6C05963FD5285BCE6ED51862F125|Keys.dat (PC01)|Data/BIN. Lazarus|\n|5|6EA4E4AB925A09E4C7A1E80BAE5B9584|Keys.dat (PC02)|Data/BIN. Lazarus|\n|6|27DB56964E7583E19643BF5C98FFFD52|Settings.vwx (PC01)|Data/BIN. Lazarus|\n|7|BD47942E9B6AD87EB5525040DB620756|Settings.vwx (PC02)|Data/BIN. Lazarus|\n\n\n**Malicious IP/URL**\n\n|No|IP|URL|Country|\n|---|---|---|---|\n|1|111.92.189.48|www[.] scope.co.kr|KR|\n|2|121.78.158.46|www[.] studyholic.com|KR|\n|3|121.78.246.155|dalbinews[.] co.kr|KR|\n|4|119.207.79.175|–|KR|\n|5|183.110.224.172|ctmnews[.] kr|KR|\n|6|211.249.220.83|ctmnews[.] kr|KR|\n|7|1.254.179.18|www[.] artinsight.co.kr|KR|\n|8|103.6.182.57|www[.] artinsight.co.kr|KR|\n|9|104.109.245.186|www[.] artinsight.co.kr|US|\n|10|112.106.58.23|www[.] artinsight.co.kr|KR|\n|11|115.68.52.47|www[.] artinsight.co.kr|KR|\n|12|125.209.218.167|www[.] artinsight.co.kr|KR|\n|13|3.39.49.255|www[.] artinsight.co.kr|US|\n|14|34.199.186.157|www[.] artinsight.co.kr|US|\n|15|52.148.148.114|www[.] artinsight.co.kr|US|\n|16|104.21.64.83|www[.] kfcjn.com|US|\n|17|112.106.58.23|www[.] kfcjn.com|KR|\n|18|114.108.129.89|www[.] kfcjn.com|KR|\n|19|117.52.137.138|www[.] kfcjn.com|KR|\n|20|13.107.21.200|www[.] kfcjn.com|US|\n|21|162.247.241.2|www[.] kfcjn.com|US|\n|22|23.50.0.140|www[.] kfcjn.com|US|\n|23|52.79.120.37|www[.] kfcjn.com|US|\n\n\n-----\n\n**Detailed analysis information on related IOCs can be accessed through the subscription service of**\n**AhnLab's next-generation threat intelligence platform 'AhnLab TIP'.**\n\n[Categories:Malware Information](https://asec.ahnlab.com/ko/category/malware-information/)\n\n[Tagged as:A-FIRST,BYOVD,DFIR,Infringement Case,Lazarus](https://asec.ahnlab.com/ko/tag/lazarus/)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "d63ae2b7-445f-460d-965d-2676dacdb6de",
            "created_at": "2022-10-25T15:59:19.552139Z",
            "updated_at": "2022-10-25T15:59:19.552139Z",
            "deleted_at": null,
            "name": "APTnotes",
            "url": "https://github.com/aptnotes/data",
            "description": "APTnotes data",
            "reports": null
        }
    ],
    "references": [
        "https://app.box.com/s/ovpepub4io3zuwkn65viaoxcn18ifunk"
    ],
    "report_names": [
        "Ahnlab_Lazarus-using-public-certificate-vulnerability(02-27-2023)"
    ],
    "threat_actors": [
        {
            "id": "32a223a8-3c79-4146-87c5-8557d38662ae",
            "created_at": "2022-10-25T15:50:23.703698Z",
            "updated_at": "2025-03-27T02:00:55.528031Z",
            "deleted_at": null,
            "main_name": "Lazarus Group",
            "aliases": [
                "Lazarus Group",
                "Labyrinth Chollima",
                "HIDDEN COBRA",
                "Guardians of Peace",
                "NICKEL ACADEMY",
                "Diamond Sleet"
            ],
            "source_name": "MITRE:Lazarus Group",
            "tools": [
                "RawDisk",
                "Proxysvc",
                "BADCALL",
                "FALLCHILL",
                "WannaCry",
                "HOPLIGHT",
                "TYPEFRAME",
                "Dtrack",
                "HotCroissant",
                "HARDRAIN",
                "Dacls",
                "KEYMARBLE",
                "TAINTEDSCRIBE",
                "AuditCred",
                "netsh",
                "ECCENTRICBANDWAGON",
                "AppleJeus",
                "BLINDINGCAN",
                "ThreatNeedle",
                "Volgmer",
                "Cryptoistic",
                "RATANKBA",
                "Bankshot",
                "Torisma",
                "Mimikatz"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "9e767b38-12ae-4ef7-9878-5ce1701066d7",
            "created_at": "2024-05-01T02:03:08.131819Z",
            "updated_at": "2025-03-27T02:05:17.413497Z",
            "deleted_at": null,
            "main_name": "NICKEL ACADEMY",
            "aliases": [
                "COVELLITE ",
                "CTG-2460 ",
                "Diamond Sleet ",
                "Guardians of Peace",
                "HIDDEN COBRA ",
                "High Anonymous",
                "Labyrinth Chollima ",
                "NNPT Group",
                "New Romanic Cyber Army Team",
                "Temp.Hermit ",
                "The Lazarus Group ",
                "UNC577 ",
                "Who Am I?",
                "Whois Team",
                "ZINC ",
                "Black Artemis "
            ],
            "source_name": "Secureworks:NICKEL ACADEMY",
            "tools": [
                " DarkMessenger",
                " Destover",
                " Duuzer",
                " HOPLIGHT",
                " Joanap",
                " KorHigh",
                " LiveJinx",
                " Volgmer",
                "Brambul"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "8bc1a044-a23b-4904-903c-13f463605cb3",
            "created_at": "2024-05-01T02:03:08.136237Z",
            "updated_at": "2025-03-27T02:05:17.415795Z",
            "deleted_at": null,
            "main_name": "NICKEL GLADSTONE",
            "aliases": [
                "Bluenoroff ",
                "CTG-6459 ",
                "Citrine Sleet ",
                "HIDDEN COBRA ",
                "Lazarus Group",
                "Sapphire Sleet ",
                "Stardust Chollima ",
                "APT38 "
            ],
            "source_name": "Secureworks:NICKEL GLADSTONE",
            "tools": [
                " Bankshot",
                " CATCH22",
                " CCGC_Proxy",
                " Cur1Agent",
                " Ratankba",
                " Server_TrafficForwarder",
                " Wcry",
                "AlphaNC"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "a2b92056-9378-4749-926b-7e10c4500dac",
            "created_at": "2023-01-06T13:46:38.430595Z",
            "updated_at": "2025-03-27T02:00:02.831633Z",
            "deleted_at": null,
            "main_name": "Lazarus Group",
            "aliases": [
                "Operation DarkSeoul",
                "APT38",
                "ATK117",
                "DEV-1222",
                "G0032",
                "APT 38",
                "Stardust Chollima",
                "APT-C-26",
                "ATK3",
                "Diamond Sleet",
                "Hidden Cobra",
                "Unit 121",
                "Subgroup: Bluenoroff",
                "NICKEL GLADSTONE",
                "DEV-0139",
                "Andariel",
                "Operation Troy",
                "COVELLITE",
                "TA404",
                "Lazarus group",
                "Dark Seoul",
                "G0082",
                "NewRomanic Cyber Army Team",
                "Bluenoroff",
                "Appleworm",
                "Nickel Academy",
                "COPERNICIUM",
                "Hastati Group",
                "Bureau 121",
                "Operation AppleJeus",
                "Whois Hacking Team",
                "Citrine Sleet",
                "Sapphire Sleet",
                "Group 77",
                "Labyrinth Chollima",
                "Operation GhostSecret",
                "BeagleBoyz"
            ],
            "source_name": "MISPGALAXY:Lazarus Group",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "f32df445-9fb4-4234-99e0-3561f6498e4e",
            "created_at": "2022-10-25T16:07:23.756373Z",
            "updated_at": "2025-03-27T02:02:09.966155Z",
            "deleted_at": null,
            "main_name": "Lazarus Group",
            "aliases": [
                "APT-C-26",
                "ATK 3",
                "Appleworm",
                "Citrine Sleet",
                "DEV-0139",
                "Diamond Sleet",
                "Gleaming Pisces",
                "Gods Apostles",
                "Gods Disciples",
                "Group 77",
                "Guardians of Peace",
                "Hastati Group",
                "Hidden Cobra",
                "ITG03",
                "Jade Sleet",
                "Labyrinth Chollima",
                "Lazarus Group",
                "NewRomanic Cyber Army Team",
                "Operation 99",
                "Operation AppleJeus",
                "Operation AppleJeus sequel",
                "Operation Blockbuster: Breach of Sony Pictures Entertainment",
                "Operation CryptoCore",
                "Operation Dream Job",
                "Operation Dream Magic",
                "Operation Flame",
                "Operation GhostSecret",
                "Operation In(ter)caption",
                "Operation LolZarus",
                "Operation Marstech Mayhem",
                "Operation No Pineapple!",
                "Operation North Star",
                "Operation Phantom Circuit",
                "Operation Sharpshooter",
                "Operation Ten Days of Rain / DarkSeoul",
                "Operation Troy",
                "SectorA01",
                "Slow Pisces",
                "TA404",
                "TraderTraitor",
                "UNC2970",
                "UNC4034",
                "UNC4736",
                "UNC4899",
                "UNC577",
                "Whois Hacking Team"
            ],
            "source_name": "ETDA:Lazarus Group",
            "tools": [
                "3CX Backdoor",
                "3Rat Client",
                "3proxy",
                "AIRDRY",
                "ARTFULPIE",
                "ATMDtrack",
                "AlphaNC",
                "Alreay",
                "Andaratm",
                "AngryRebel",
                "AppleJeus",
                "Aryan",
                "AuditCred",
                "BADCALL",
                "BISTROMATH",
                "BLINDINGCAN",
                "BTC Changer",
                "BUFFETLINE",
                "BanSwift",
                "Bankshot",
                "Bitrep",
                "Bitsran",
                "BlindToad",
                "Bookcode",
                "BootWreck",
                "BottomLoader",
                "Brambul",
                "BravoNC",
                "Breut",
                "COLDCAT",
                "COPPERHEDGE",
                "CROWDEDFLOUNDER",
                "Castov",
                "CheeseTray",
                "CleanToad",
                "ClientTraficForwarder",
                "CollectionRAT",
                "Concealment Troy",
                "Contopee",
                "CookieTime",
                "Cyruslish",
                "DAVESHELL",
                "DBLL Dropper",
                "DLRAT",
                "DRATzarus",
                "DRATzarus RAT",
                "Dacls",
                "Dacls RAT",
                "DarkComet",
                "DarkKomet",
                "DeltaCharlie",
                "DeltaNC",
                "Dembr",
                "Destover",
                "DoublePulsar",
                "Dozer",
                "Dtrack",
                "Duuzer",
                "DyePack",
                "ECCENTRICBANDWAGON",
                "ELECTRICFISH",
                "Escad",
                "EternalBlue",
                "FALLCHILL",
                "FYNLOS",
                "FallChill RAT",
                "Farfli",
                "Fimlis",
                "FoggyBrass",
                "FudModule",
                "Fynloski",
                "Gh0st RAT",
                "Ghost RAT",
                "Gopuram",
                "HARDRAIN",
                "HIDDEN COBRA RAT/Worm",
                "HLOADER",
                "HOOKSHOT",
                "HOPLIGHT",
                "HOTCROISSANT",
                "HOTWAX",
                "HTTP Troy",
                "Hawup",
                "Hawup RAT",
                "Hermes",
                "HotCroissant",
                "HotelAlfa",
                "Hotwax",
                "HtDnDownLoader",
                "Http Dr0pper",
                "ICONICSTEALER",
                "Joanap",
                "Jokra",
                "KANDYKORN",
                "KEYMARBLE",
                "Kaos",
                "KillDisk",
                "KillMBR",
                "Koredos",
                "Krademok",
                "LIGHTSHIFT",
                "LIGHTSHOW",
                "LOLBAS",
                "LOLBins",
                "Lazarus",
                "LightlessCan",
                "Living off the Land",
                "MATA",
                "MBRkiller",
                "MagicRAT",
                "Manuscrypt",
                "Mimail",
                "Mimikatz",
                "Moudour",
                "Mydoom",
                "Mydoor",
                "Mytob",
                "NACHOCHEESE",
                "NachoCheese",
                "NestEgg",
                "NickelLoader",
                "NineRAT",
                "Novarg",
                "NukeSped",
                "OpBlockBuster",
                "PCRat",
                "PEBBLEDASH",
                "PLANKWALK",
                "POOLRAT",
                "PSLogger",
                "PhanDoor",
                "Plink",
                "PondRAT",
                "PowerBrace",
                "PowerRatankba",
                "PowerShell RAT",
                "PowerSpritz",
                "PowerTask",
                "Preft",
                "ProcDump",
                "Proxysvc",
                "PuTTY Link",
                "QUICKRIDE",
                "QUICKRIDE.POWER",
                "Quickcafe",
                "QuiteRAT",
                "R-C1",
                "ROptimizer",
                "Ratabanka",
                "RatabankaPOS",
                "Ratankba",
                "RatankbaPOS",
                "RawDisk",
                "RedShawl",
                "Rifdoor",
                "Rising Sun",
                "Romeo-CoreOne",
                "RomeoAlfa",
                "RomeoBravo",
                "RomeoCharlie",
                "RomeoCore",
                "RomeoDelta",
                "RomeoEcho",
                "RomeoFoxtrot",
                "RomeoGolf",
                "RomeoHotel",
                "RomeoMike",
                "RomeoNovember",
                "RomeoWhiskey",
                "Romeos",
                "RustBucket",
                "SHADYCAT",
                "SHARPKNOT",
                "SIGFLIP",
                "SIMPLESEA",
                "SLICKSHOES",
                "SORRYBRUTE",
                "SUDDENICON",
                "SUGARLOADER",
                "SheepRAT",
                "SierraAlfa",
                "SierraBravo",
                "SierraCharlie",
                "SierraJuliett-MikeOne",
                "SierraJuliett-MikeTwo",
                "SimpleTea",
                "SimplexTea",
                "SmallTiger",
                "Stunnel",
                "TAINTEDSCRIBE",
                "TAXHAUL",
                "TFlower",
                "TOUCHKEY",
                "TOUCHMOVE",
                "TOUCHSHIFT",
                "TOUCHSHOT",
                "TWOPENCE",
                "TYPEFRAME",
                "Tdrop",
                "Tdrop2",
                "ThreatNeedle",
                "Tiger RAT",
                "TigerRAT",
                "Trojan Manuscript",
                "Troy",
                "TroyRAT",
                "VEILEDSIGNAL",
                "VHD",
                "VHD Ransomware",
                "VIVACIOUSGIFT",
                "VSingle",
                "ValeforBeta",
                "Volgmer",
                "Vyveva",
                "W1_RAT",
                "Wana Decrypt0r",
                "WanaCry",
                "WanaCrypt",
                "WanaCrypt0r",
                "WannaCry",
                "WannaCrypt",
                "WannaCryptor",
                "WbBot",
                "Wcry",
                "Win32/KillDisk.NBB",
                "Win32/KillDisk.NBC",
                "Win32/KillDisk.NBD",
                "Win32/KillDisk.NBH",
                "Win32/KillDisk.NBI",
                "WinorDLL64",
                "Winsec",
                "WolfRAT",
                "Wormhole",
                "YamaBot",
                "Yort",
                "ZetaNile",
                "concealment_troy",
                "http_troy",
                "httpdr0pper",
                "httpdropper",
                "klovbot",
                "sRDI"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1677895636,
    "ts_updated_at": 1743041842,
    "ts_creation_date": 1677690294,
    "ts_modification_date": 1677690294,
    "files": {
        "pdf": "https://archive.orkl.eu/9f0ac45dbfeeded1ad46f09e104640566c8f7eda.pdf",
        "text": "https://archive.orkl.eu/9f0ac45dbfeeded1ad46f09e104640566c8f7eda.txt",
        "img": "https://archive.orkl.eu/9f0ac45dbfeeded1ad46f09e104640566c8f7eda.jpg"
    }
}