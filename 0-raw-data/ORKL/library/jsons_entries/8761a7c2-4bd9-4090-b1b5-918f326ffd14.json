{
    "id": "8761a7c2-4bd9-4090-b1b5-918f326ffd14",
    "created_at": "2022-10-25T16:48:14.208299Z",
    "updated_at": "2025-03-27T02:16:28.743885Z",
    "deleted_at": null,
    "sha1_hash": "667f1379170388a9984c24154da1507f02b5fd19",
    "title": "",
    "authors": "",
    "file_creation_date": "2018-09-20T20:43:03Z",
    "file_modification_date": "2018-09-20T20:43:03Z",
    "file_size": 6113368,
    "plain_text": "-----\n\n### 目录\n\n第 1 章 概述 ............................................................................................................................... 3\n1. 主要发现 ........................................................................................................................... 3\n2. 命名由来 ........................................................................................................................... 4\n第 2 章 攻击目的和受害分析 ................................................................................................... 5\n1. 攻击目的 ........................................................................................................................... 5\n2. 行业分布 ........................................................................................................................... 6\n3. 地域分布 ........................................................................................................................... 6\n第 3 章 持续 11 年的活动 ......................................................................................................... 8\n1. 初始攻击 ........................................................................................................................... 8\n1) 鱼叉式钓鱼邮件攻击 ............................................................................................... 8\n2) RLO 伪装文档扩展名 ............................................................................................. 16\n3) 伪装图标隐藏扩展名 ............................................................................................. 16\n2. 漏洞分析 ......................................................................................................................... 17\n1) CVE-2012-0158 漏洞 ............................................................................................... 17\n2) CVE-2014-6352 漏洞（0day） ............................................................................... 19\n3) CVE-2017-8759 漏洞 ............................................................................................... 24\n3. 持续渗透 ......................................................................................................................... 25\n1) RAT 演进.................................................................................................................. 25\n2) RAT 13 个版本分析 ................................................................................................. 27\n3) 脚本加载的攻击载荷分析 ..................................................................................... 36\n4) 最新控制木马分析 ................................................................................................. 44\n4. C&C 分析 ......................................................................................................................... 51\n1) 动态域名 ................................................................................................................. 51\n2) 域名涵义 ................................................................................................................. 52\n3) 云盘 ......................................................................................................................... 53\n4) 第三方博客 ............................................................................................................. 55\n5) C&C 的 IP（ASN） .................................................................................................. 56\n6) 其他 ......................................................................................................................... 56\n5. 关联分析 ......................................................................................................................... 57\n1) 整体关联 ................................................................................................................. 57\n2) RAT 迭代升级（对抗手法） .................................................................................. 58\n加密方法......................................................................................................................................... 59\n第 4 章 幕后始作俑者 ............................................................................................................. 65\n1. 资源方法 ......................................................................................................................... 65\n2. 相关关联信息 ................................................................................................................. 65\n1) 域名 whois 信息 ..................................................................................................... 65\n2) 关注的关键字 ......................................................................................................... 66\n3) PE 样本中繁体字体、BIG5 字符集 ....................................................................... 66\n4) 漏洞文档中繁体字体 ............................................................................................. 67\n5) 释放的迷惑文档 ..................................................................................................... 68\n第 5 章 组织能力或特性分析 ................................................................................................. 69\n附录 1：文件 MD5 列表 ................................................................................................................ 70\n\n**1 / 78**\n\n\n-----\n\n附录 2：C&C 列表 .......................................................................................................................... 72\n附录 3：360 追日团队（Helios Team） ....................................................................................... 75\n附录 4：360 安全监测与响应中心 ............................................................................................... 76\n附录 5：360 威胁情报中心 ........................................................................................................... 77\n\n**2 / 78**\n\n\n-----\n\n# 第1章 概述\n\n## 1. 主要发现\n\n从 2007 年开始至今，360 追日团队发现毒云藤组织对中国国防、政府、科技、教育以\n及海事机构等重点单位和部门进行了长达 11 年的网络间谍活动。该组织主要关注军工、中\n美关系、两岸关系和海洋相关领域，其关注的领域与我们之前发布的海莲花（OceanLotus）\nAPT 组织有一定相似的地方。\n\n360 追日团队捕获毒云藤的首个木马出现在 2007 年 12 月。在之后的 11 年中我们先后\n捕获到了 13 个版本的恶意代码，涉及样本数量 73 个。该组织在初始攻击环节主要采用鱼叉\n式钓鱼邮件攻击，攻击之前对目标进行了深入调研和精心挑选，选用与目标所属行业或领域\n密切相关的内容构造诱饵文件和邮件，主要是采用相应具体领域相关会议材料、研究成果或\n通知公告等主题。期间漏洞文档样本数量 10 个，其中包含 1 个 0day 漏洞。这些木马的感染\n者遍布国内 31 个省级行政区。C&C 域名数量为 59 个，回传的地址位于 4 个不同国家或地区。\n\n毒云藤在对中国持续 11 年的网络间谍活动中，下述相关时间点值得关注：\n 2007 年 12 月，首次发现与该组织相关的木马。涉及海洋相关领域（疑似对某大型船务\n公司进行相关攻击）\n 2008 年 3 月，对国内某高校重点实验室（某科研机构）\n 2009 年 2 月，开始对军工行业展开攻击（某知名军工类期刊杂志社）\n 2009 年 10 月，木马增加了特殊的对抗静态扫描的手法（API 字符串逆序），相关手法沿\n用到大部分版本的木马中，并持续应用到 2018 年\n 2011 年 12 月，木马增加了特殊的对抗动态检测的手法（错误 API 参数），相关手法沿\n用到大部分版本的木马中，并持续应用到 2015 年\n 2012 年 2 月，首次发现基于 zxshell 代码的修改版后门 1，其中关键功能是窃取\n如.doc\\.ppt\\.xls\\.wps 类文档文件\n 2013 年 3 月，对中科院，以及若干科技、海事等领域国家部委、局等进行了集中攻击\n 2013 年 10 月，对中国某政府网站进行水坑攻击\n 2014 年 5 月，发现 zxshell 修改版后门 1 的进化版本 2，其中除了基于修改版 1 功能，\n增加了如“军”，“航”，“报告”关键字的搜索\n 2014 年 9 月 12 日，首次发现与 CVE-2014-4114（0day 漏洞）相关事件和样本。\n 2014 年 10 月 14 日，iSIGHT 发布相关报告，并指出 CVE-2014-4114（0day 漏洞）。同日\n微软发布相关安全公告\n 2015 年 2 月 25 日，对某军工领域协会组织（国防科技相关）、中国工程院等攻击，同\n时发现酷盘版样本\n 2017 年 10 月，主要通过 CVE-2017-8759 漏洞文档对某大型媒体机构网站和泉州某机关\n相关人员实施鱼叉攻击\n 2018 年 4 月，360 威胁情报中心公开披露了该组织利用 CVE-2017-8759 漏洞文档的攻击\n恶意代码 [2]\n 2018 年 5 月，针对数家船舶重工企业、港口运营公司等海事行业机构发动攻击\n\n注：\n\n以上首次攻击时间，是基于我们对该组织了解掌握的现有数据进行统计的，不代表我们已经掌握了该\n\n**3 / 78**\n\n\n-----\n\n组织的全部攻击事件和行为。\n\n## 2. 命名由来\n\n自 2015 年，国内在 APT 方向的相关研究逐渐起步并加快。继“海莲花”、“蓝宝菇”等\n组织曝光之后，毒云藤组织（APT-C-01）是又一个针对政府、军工、海事等领域敏感信息持\n续发起攻击的 APT 组织。\n\n该组织是 360 独立发现的，并率先披露了该组织的部分相关信息（参见：\nhttps://ti.360.net/blog/articles/analysis-of-apt-c-01/，发布时间：2018 年 4 月），符合 360 对\nAPT 组织就行独立命名的条件。\n\n360 威胁情报中心将 APT-C-01 组织命名为“毒云藤”，主要是考虑了以下几方面的因素：\n一是该组织在多次攻击行动中，都使用了 Poison Ivy（毒藤）木马；二、该攻击组织在中转\n信息时，曾使用云盘作为跳板传输资料，这跟爬藤类植物凌空而越过墙体，颇有相似之处。\n根据 360 威胁情报中心对 APT 组织的命名规则（参见《2016 年中国高级持续性威胁研究报\n告》），同时结合该组织关联地区常见的蔓藤植物，将 APT-C-01 组织命名为“毒云藤”。\n\n另，国内安天实验室于 2018 年 9 月 19 日发布 APT 攻击组织“绿斑”（Green Spot）分\n析报告。根据 360 威胁情报中心与安天实验室之间达成的能力型厂商成果互认约定，360 威\n胁情报中心发现的“毒云藤”（APT-C-01）对应“绿斑”（Green Spot），二者是同一组织。因\n此，我们把监测到的情况与该组织攻击特点也公布出来，共同为中国提升 APT 防御能力而\n努力。\n\n**4 / 78**\n\n\n-----\n\n# 第2章 攻击目的和受害分析\n\n## 1. 攻击目的\n\n攻击组织的主要目的是窃取中国政府、科研相关行业领域的资料数据。相关数据主要以\n文档为主，关心的关键字主要包括以下关键字和扩展名的文件：\n\n关键字：\n\n“201”，“2014”，“2015 年”，“报”，“报告”，“兵”，“部队”，“对台”，“工作”，“规划”，\n“国”，“国际”，“航”，“合作”，“机”，“机场”，“基地”，“极地”，“军”，“军事”，“科技”，\n“密”，“内部”，“十”，“十三”，“台”，“台湾”，“铁路”，“无人”，“项”，“雪”，“研”，“运\n输”，“战”，“站”，“中”\n扩展名：\n“doc”，“ppt”，“xls”，“pdf”，“rtf”，“rar”，“wps”，“doc*”，“ppt*”，“xls*”\n\n窃取用户主机相关信息\n\n\nMAC Info：MAC 信息，主要包括 IP 地址、网关信息等\n\nHost Info：主机信息，主要包括操作系统信息、主机名称、本地用户名等\n\nProcess Info：当前进程信息\n\nVersion Info：相关版本信息，主要包括 Microsoft Office 和 Microsoft Internet Explorer 版本信息\n\nDisk Info：磁盘信息\n\n\n图 1 相关窃取用户主机信息截图（示例）\n\n**5 / 78**\n\n\n-----\n\n图 2 被感染用户月统计（2014 年 7 月-2015 年 6 月）\n\n## 2. 行业分布\n\n主要涉及：国防、政府、科技、教育等\n相关领域包括：海洋（南海、东海、测绘）、军工、涉台问题（两岸关系）、中美关系\n\n## 3. 地域分布\n\n图 3 中国被感染地区分布图（2014 年 7 月-2015 年 6 月）\n\n**6 / 78**\n\n\n-----\n\n福建\n\n7%\n\n\n图 4 中国被感染地区比例图\n\n地区 数量\n\n北京 296\n\n福建 55\n\n广东 43\n\n浙江 39\n\n上海 32\n\n**7 / 78**\n\n\n福建\n\n7%\n\n广\n\n\n-----\n\n# 第3章 持续 11 年的活动\n\n## 1. 初始攻击\n\n### 1) 鱼叉式钓鱼邮件攻击\n\n鱼叉式钓鱼邮件攻击是 APT 中常用的攻击手法，主要在 APT 的初始攻击环节。简单理\n解就是利用邮件作为攻击前导，其中正文、附件都可能携带恶意代码，进一步主要以附件携\n带漏洞文档文件为主，大约 90%的攻击都是该类攻击[1]。\n\n本小节主要介绍邮件携带漏洞文档和邮件携带二进制可执行文件这两种攻击方法。\n\n#### A. 携带漏洞文档\n\n**MD5** 文件名 病毒名\n\n\n邮件\n附件\n\n压缩\n包内\n\n**PE**\n\n释放\n的 **PE**\n\n\na5d9edaa1b6cf820d54c19b2c6bd246d 专业技术干部手册.rar\n\n2fa75fdf4d57c182bc6c0438dd6cbf27 HandBook.chm\n\nb04d7fa1c7e3a8274ba81f48f06a5f4e hh.exe Backdoor.Win32.Fa\nkeWinupdate\n\n\n1“Spear-Phishing Email: Most Favored APT Attack Bait”，\nhttp://www.trendmicro.com/cloud-content/us/pdfs/security-intelligence/white-papers/wp-spear-phishing-emailmost-favored-apt-attack-bait.pdf\n\n**8 / 78**\n\n\n-----\n\n图 5 携带漏洞文档案例 1 邮件截图\n\n图 6 携带漏洞文档案例 1 邮件附件压缩包截图\n\n**9 / 78**\n\n\n-----\n\n图 7 携带漏洞文档案例 1 诱饵 CHM 文档截图\n\n**MD5** 文件名 病毒名\n\n\n邮件\n附件\n\n释放\n的 **PE**\n\n\n19365fddc2fca8735d51def001704db3 2013 中国亚洲太平洋\n学会年会文件.doc\n\n\nvirus.exp.20120158\n\n\n07561810d818905851ce6ab2c115287\n1\n\n\nupdate.exe Backdoor.Win32.Zx\nShell\n\n\n**10 / 78**\n\n\n-----\n\n图 8 携带漏洞文档案例 1 邮件截图\n\n**MD5** 文件名 病毒名\n\n\n邮件\n附件\n\n释放\n的 **PE**\n\n\nf3ed0632cadd2d6beffb9d33db4188ed update.exe Backdoor.Win32.Po\nisonIvy\n\n**11 / 78**\n\n\n9fb6866c2cdd49387a520f421a04b882\n\n\n中科院 2013 年研究项\n目材料.doc\n\n\nvirus.exp.20120158\n\n\n-----\n\n图 9 携带漏洞文档案例 2 邮件截图\n\n图 10 携带漏洞文档案例 2 漏洞文档（释放后迷惑文档）截图\n\n**12 / 78**\n\n\n-----\n\n#### B. 携带 PE 二进制可执行程序\n\n**MD5** 文件名 病毒名\n\n\n邮件\n附件\n\n压缩\n包内\n\n**PE**\n\n释放\n的 **PE**\n\n\n954f50f7ed8b4c11b59560769de0ec36 关于推荐第十三届中\n国青年科技奖候选人\n的通知.rar\n\n\n6a37ce66d3003ebf04d249ab049acb22 svchoct.exe Backdoor.Win32.Ht\ntpBot\n\n图 11 携带 PE 二进制可执行程序案例邮件截图\n\n**13 / 78**\n\n\nDropper.Win32.Fak\neDoc\n\nDropper.Win32.Fak\neDoc\n\n\n8c9670fbe68ab8719077d480242e6b9\ne\n\n\n关于推荐第十三届中\n国青年科技奖候选人\n的通知.exe\n\n\n-----\n\n图 12 携带 PE 二进制可执行程序案例邮件附件压缩包截图\n\n图 13 携带 PE 二进制可执行程序案例中木马释放迷惑文档打开后截图\n\n攻击组织在发送钓鱼邮件通常登录 web 邮件和通过相关工具（PHPMailer[2]）进行攻击邮\n件的发送。\n\n2 PHPMailer，http://code.google.com/a/apache-extras.org/p/phpmailer/\n\n**14 / 78**\n\n\n-----\n\n#### C. 携带自解压文件\n\n攻击组织通过向目标邮箱发送压缩形态的 RAR 自解压格式程序。\n\n附件里面是木马文件：\n\n该文件实际是一个 RAR 自解压格式程序，参数如下，点击这个 exe，会直接运行里面的\nbat 文件：\n\n默认的批处理命令会把木马主体移动到 temp 目录下，然后执行起来，同时删除该批处理文\n件：\n\n**15 / 78**\n\n\n-----\n\n### 2) RLO[3]伪装文档扩展名\n\n**MD5** 文件名 病毒名\n\n\n邮件\n附件\n\n\n954f50f7ed8b4c11b59560769de0ec36 东海航保通信台站规\n划 补 充 材 料\nhangbaoexe.doc（真实\n扩展名 cod.exe）\n\n图 14 伪装文档扩展名（RLO）样本截图\n\n\nDropper.Win32.Fak\neDoc\n\n\n### 3) 伪装图标隐藏扩展名\n\n**MD5** 文件名 病毒名\n\n\n邮件\n附件\n\n\ncbeebf063f914eb3b5eba8b37302189f “军民融合深度发展战\n略研究”咨询项目正式\n启动 .exe\n\n图 15 伪装图标隐藏扩展名案例 1 截图\n\n\nDropper.Win32.Fak\neFolder\n\n\n**MD5** 文件名 病毒名\n\n3 RLO，http://en.wikipedia.org/wiki/Unicode_character_property\n\n**16 / 78**\n\n\n-----\n\n邮件\n附件\n\n\nae004a5d4f1829594d830956c55d6ae4 2014-03-18 中国系统仿\n真学会科研项目经费\n自 查 xls\n___________________\n__________.exe\n\n图 16 伪装图标隐藏扩展名案例 2 截图\n\n\nDropper.Win32.Fak\neXls\n\n\n图 17 伪装图标隐藏扩展名案例 2 木马释放的迷惑文档截图\n\n## 2. 漏洞分析\n\n### 1) CVE-2012-0158 漏洞\n\n漏洞编号 **CVE-2012-0158**\n\n说明 Windows 常用控件中存在一个远程执行代码漏洞。攻击者可通过构建特制网\n页来利用此漏洞。当用户查看网页时，该漏洞可能允许远程执行代码。成功\n利用此漏洞的攻击者可以获得与登录用户相同的用户权限。\n公布时间 2012 年 4 月 10 日\n参考链接 [https://technet.microsoft.com/zh-cn/library/security/ms12-027.aspx](https://technet.microsoft.com/zh-cn/library/security/ms12-027.aspx)\n[http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2012-0158](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2012-0158)\n\n**17 / 78**\n\n\n-----\n\n#### A. 漏洞文档执行流程\n\n图 18 漏洞文档（CVE-2012-0158）执行流程\n\n#### B. MHT 格式\n\n图 19 漏洞文档两种形态（上 MHT，下 RTF）对比图\n\nCVE-2012-0158 漏洞主要以 rtf 和 doc 格式为主，但本次攻击都是将 doc 文件保存为 mht\n格式，导致杀软在漏洞检查时，因前置逻辑不匹配而漏检。相关漏洞文档文件在当时都是较\n低检出率。\n\n**18 / 78**\n\n\n-----\n\n#### C. shellcode 对比\n\n相关对比项 共性描述\n\n**shellcode** 第一层 shellcode 都是异或 0xA3 用于解密，相关样本均为 3 层 shellcode，\n并且数据结构一致\n**Magic 值** 值为：0x22776655，0xCACACACA，0xA02005CA，均一致\n释放文件 路径一致：\n 正常文档文件：“%USERPROFILE%”，相关文档文件名会有变化，如：\n“关于对中船钦州大型海工修造及保障基地项目一期工程建设工\n作责任表的意见（37 号）.doc”、“两会重要发布报告.doc”、“123.doc”\n等\n PE 木马文件：“C:\\Documents and Settings\\All Users\\「开始」菜单\\\n程序\\启动\\update.exe”\n清除痕迹 解码相关注册表项，并删除。目的是为了清除 office 的打开失败等记录\n的历史信息。\n相关注册表项：\n\n\"Software\\Microsoft\\Office\\12.0\\Word\\Resiliency\\DisabledItems\"\n\"Software\\Microsoft\\Office\\12.0\\Word\\Resiliency\\StartupItems\"\n\"Software\\Microsoft\\Office\\11.0\\Word\\Resiliency\\DocumentRecovery\"\n\"Software\\Microsoft\\Office\\11.0\\Word\\Resiliency\\DisabledItems\"\n\"Software\\Microsoft\\Office\\11.0\\Word\\Resiliency\\StartupItems\"\n\n通过我们对漏洞文档的 shellcode 对比可以发现相关结构和功能都基本一致，进一步我\n们也能推断相关漏洞文档是同一组织开发。\n\n### 2) CVE-2014-6352 漏洞（0day）\n\n#### A. 背景介绍\n\nCVE-2014-4114 漏洞是 iSIGHT 公司[4]在 2014 年 10 月 14 日发布相关报告，报告其中提到\n一个 0day 漏洞（CVE-2014-4114）用于俄罗斯相关主要针对北约、欧盟、电信和能源相关领\n域的网络间谍活动。微软也是在 10 月 14 日发布相关安全公告。\n\n而 CVE-2014-6352 是可以认为绕过 CVE-2014-4114 补丁的漏洞，微软之前的修补方案首\n先在生成 Inf 和 exe 文件后添加 MakeFileUnsafe 调用，来设置文件 Zone 信息，这样随后在漏\n洞执行 inf 安装时，会有一个安全提示。而 CVE-2014-6352 漏洞样本抛弃了使用 inf 来安装\nexe，转而直接执行 exe。因为 xp 以上系统可执行文件的右键菜单第二项是以管理员权限执\n行，这样导致如果用户关闭了 uac 会导致没有任何安全提醒。所以微软 6352 的补丁是在调\n用右键菜单添加一个安全提示弹窗。\n\n漏洞编号 **CVE-2014-4114**\n\n4“iSIGHT discovers zero-day vulnerability CVE-2014-4114 used in Russian cyber-espionage campaign”，\nhttp://www.isightpartners.com/2014/10/cve-2014-4114/\n\n**19 / 78**\n\n\n-----\n\n说明 Windows OLE 中存在一个漏洞，如果用户打开包含特制 OLE 对象的文件，\n则该漏洞可能允许远程执行代码。成功利用此漏洞的攻击者可以获得与登录\n用户相同的用户权限。如果当前用户使用管理用户权限登录，则攻击者可随\n后安装程序；查看、更改或删除数据；或者创建拥有完全用户权限的新帐户。\n那些帐户被配置为拥有较少用户权限的用户比具有管理用户权限的用户受\n到的影响要小。\n公布时间 2014 年 10 月 14 日\n参考链接 [https://technet.microsoft.com/zh-cn/library/security/ms14-060.aspx](https://technet.microsoft.com/zh-cn/library/security/ms14-060.aspx)\n[https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-4114](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-4114)\n\n漏洞编号 **CVE-2014-6352**\n\n说明 在用户下载或接收，然后打开经特殊设计的包含 OLE 对象的 Microsoft\nOffice 文件时，会导致当前用户上下文中的远程执行代码漏洞。Microsoft 最\n初通过协调漏洞披露渠道了解到有关此漏洞的信息。此漏洞最初在 Microsoft\n安全通报 3010060 中进行了说明。Microsoft 获悉尝试使用此漏洞的有限攻\n击。此更新通过修改在访问 OLE 对象时受影响的操作系统验证内存使用的\n方式来解决这些漏洞。\n公布时间 2014 年 10 月 21 日\n参考链接 [https://technet.microsoft.com/zh-cn/library/security/3010060.aspx](https://technet.microsoft.com/zh-cn/library/security/3010060.aspx)\n[https://technet.microsoft.com/zh-cn/library/security/ms14-064.aspx](https://technet.microsoft.com/zh-cn/library/security/ms14-064.aspx)\n[http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-6352](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-6352)\n\n#### B. 本次行动中相关介绍\n\n**MD5** 文件名 病毒名\n\n\nvirus.exp.20146352\n\nvirus.exp.20146352\n\n\n**da807804fa5f53f7cbcaac82b901689c**\n\n\n指挥控制专委会评审责\n任书.ppsx\n\n\n**19f967e27e21802fe92bc9705ae0a770** 南海课题项目建议\n书.ppsx\n\n**20 / 78**\n\n\n-----\n\n图 20 漏洞文档（CVE-2014-6352）属性相关信息\n\n图 21 CVE-2014-6352 相关关键时间节点\n\n本次行动中的样本没有使用 inf[5]来做跳板，而是直接使用 exe，CVE-2014-4114 漏洞触发\n后，默认调用的是右键菜单第二项，Windows7 下正常是使用管理员权限打开，如果第二项\n是其他选项，则会将病毒路径作为参数传递，这也会产生部分兼容性问题。执行效果具体如\n下图所示：\n\n5 inf 是用来描述设备信息的文件，通过 inf 文件可以完成对文件以及注册表的一些操作\n\n**21 / 78**\n\n\n-----\n\n漏洞文档版本升级\n\n\n图 22 漏洞执行效果示意图\n\n图 23 沙虫漏洞文档样本（版本 A）相关截图\n\n**22 / 78**\n\n\n-----\n\n图 24 沙虫漏洞文档样本（版本 B）相关截图\n\n图 25 毒云藤漏洞文档样本（版本 C）相关截图\n\n版本 时间 厂商 描述\n\n\n版本 **A** 2014 年 10 月 14 日\n（报告发布时间）\n\n版本 **B** 2014 年 10 月 16 日\n（捕获样本时间）\n\n\niSIGHT UNC 下载 PE 木马，利用 inf 安装启动 PE\n木马\n\nXecure lab[6] 利用 inf 执行嵌入“.ppsx”文档内的 PE\n木马\n\n\n6http://blog.xecure-lab.com/2014/10/cve-2014-4114-pptx-apt-xecure-lab.html\n\n**23 / 78**\n\n\n-----\n\n版本 **C** 2014 年 9 月 12 日\n（捕获样本时间）\n\n### 3) CVE-2017-8759 漏洞\n\n A.背景介绍\n\n\n360 没有利用 inf，直接执行嵌入“.ppsx”文\n档内的 PE 木马\n\n\nCVE-2017-8759 漏洞是 FireEye 公司在 2017 年 9 月 12 日披露的一个 0Day 漏洞\n（CVE-2017-8759）。微软也在 9 月 12 日发布了相关的安全公告。\n\n漏洞编号 **CVE-2017-8759**\n\n说明 CVE-2017-8759 是 SOAP WSDL 分析器代码注入漏洞，在解析 SOAP WSDL 定义\n的内容中它允许攻击者注入任意代码，影响所有.net 环境。\n公布时间 2017 年 9 月 12 日\n参考链接 https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-8759\n\n### B.本次行动中相关介绍\n\n**MD5** 文件名 病毒名\n\n\n**5d0b4cadfb149695d9fbc71dd1b36bef** 2017 两岸关系新进展与\n问题(内部).rtf\n\n\nvirus.exp.20178759\n\n\nRtf 文档中通过 objautlink 和 objupdate 控制字段自动更新链接，漏洞触发后导致 mshta.exe\n执行远程指定的 HTA 文件。\n\nHTA 文件为一个嵌入了恶意 VBS 的 html 页面，该 VBS 调用 POWERSHELL 下载后续 exe loader。\n\n**24 / 78**\n\n\n-----\n\n## 3. 持续渗透\n\n### 1) RAT 演进\n\nRAT (Remote Access Trojan)：远程访问木马，俗称远控。\n\n图 26 相关 RAT 演进时间轴\n\n**RAT** 最早 最晚\n\n**ZxShell** 2007/12/26 2014/10/14\n\n**Poison Ivy** 2011/12/27 2014/9/10\n\n**kbox** 2015/2/11 2015/5/4\n\n**puppet** 2008/12/22 2009/2/12\n\n**httpbot** 2013/7/23 2013/10/2\n\n**gh0st** 2009/1/13 2013/4/21\n\n**AresRemote** 2009/5/5 2009/5/5\n\n**shellcode** 2011/7/13 2015/5/5\n\n**25 / 78**\n\n\n-----\n\n**XRAT** 2013/11/6 2013/11/6\n\n**FakeRising** 2009/5/15 2009/5/15\n\n**FakeWinupdate** 2009/10/21 2009/10/21\n\n**SBlog2014**\n\n**SBlog2015**\n\n相关后门程序总共涉及 11 个版本。相关比例数量如下：\n\n1% 1%\n1%\n1%\n\n3% ZxShell\n\nPoison Ivy\n\n5%\n\nkbox\n\n6% 32%\n\npuppet\n\nhttpbot\n\n6%\n\ngh0st\n\nFakeRising\n\nAresRemote\n\n21%\n\nshellcode\n\n23% XRAT\n\nFakeWinupdate\n\n图 27 11 个版本 RAT 分布比例\n\n**RAT** 数量\n\n**ZxShell** 23\n\n**Poison Ivy** 17\n\n**kbox** 15\n\n**puppet** 4\n\n**httpbot** 4\n\n**gh0st** 4\n\n**FakeRising** 2\n\n**AresRemote** 1\n\n**shellcode** 1\n\n**XRAT** 1\n\n**FakeWinupdate** 1\n\n**26 / 78**\n\n\n-----\n\n### 2) RAT 13 个版本分析\n\n#### A. Poison Ivy\n\n\n图 28 RAT 相关版本分类\n\n\nPoison Ivy 木马本质上一款远程控制木马程序（RAT）。其中 FireEye 对 Poison Ivy 专门进\n行了一次研究分析[7]。\n\n本次报告中出现的 Poison Ivy 木马对应的生成器版本均为 2.3.2，Poison Ivy 木马生成器\n从 1.0.0 版本开始总共 10 个版本，最新版本为 2.3.2。Poison Ivy 木马生成器可以生成 EXE 和\nshellcode 两种版本，在本次行动中生成的木马均为 shellcode 形态。进一步相关互斥体绝大\n部分均为默认：“)!VoqA.I4”。\n\n7 “POISON IVY:Assessing Damage and Extracting Intelligence”，\nhttps://www.fireeye.com/resources/pdfs/fireeye-poison-ivy-report.pdf\n\n**27 / 78**\n\n\n-----\n\n图 29 Posion Ivy 生成器相关配置界面截图\n\n依次异或\nkey1和key2\n\nPoison Ivy\n（shellcode）\n\n图 30 外层和内层 PI 关系\n另外 Poison Ivy 木马均由外层母体依次异或 key1 和 key2 来得到 shellcode。\n\n图 31 Poison Ivy 木马（三个）相关异或解密对比图\n\n**28 / 78**\n\n|Col1|Poison Ivy （shellcode）|\n|---|---|\n|异或 和key2||\n|||\n\n\n-----\n\n下表是相关 Poison Ivy 木马配置信息（ID 和对应密码）列表。\n\n**MD5** **ID** 密码\n**d61c583eba31f2670ae688af070c87fc** 14 926\n\n**26d7f7aa3135e99581119f40986a8ac3** 14 8613\n\n**5ee2958b130f9cda8f5f3fc1dc5249cf** 4 #My43@92\n\n**7639ed0f0c0f5ac48ec9a548a82e2f50** 1013 @1234@\n\n**250c9ec3e77d1c6d999ce782c69fc21b** avex admin\n\n**f3ed0632cadd2d6beffb9d33db4188ed** w6U900 admin\n\n**9b925250786571058dae5a7cbea71d28** zhan ftp1234\n\n**ae004a5d4f1829594d830956c55d6ae4** zhan2 ftp1234\n\n**fccb13c00df25d074a78f1eeeb04a0e7** zhan2 ftp1234\n**a73d3f749e42e2b614f89c4b3ce97fe1** 009-4 ftp443\n\n**785b24a55dd41c94060efe8b39dc6d4c** 120707 hook32wins\n**36c23c569205d6586984a2f6f8c3a39e** 90518 kkbox55\n**81e1332d15b29e8a19d0e97459d0a1de** 90518 kkbox55\n**7c498b7ad4c12c38b1f4eb12044a9def** motices ps135790\n\n**ca663597299b1cecaf57c14c6579b23b** 010-4 ps1478\n\n**76782ecf9684595dbf86e5e37ba95cc8** 13099 updatewin\n**c31549489bf0478ab4c367c563916ada** 0314--Good updatewin\n\n#### B. ZxShell\n\nZxShell 从 2007 年 12 月开始一直到 2014 年 10 月一直被毒云藤组织持续使用。由于相\n关版本差别较大，区分为内部公开版和源码公开版，第一个版指从 2007 年开始到 2012 年\n之前出现过的该组织使用的 ZxShell 木马，第二个版指从 2012 年开始到 2014 年出现过的该\n组织使用的相关 ZxShell 木马，相关木马是基于源码公开版进行开发，即我们称之为二次开\n发版。\n\n内部公开版和源码公开版均为 3.0 版本，前者无大范围公开，其中功能较丰富，后者相\n关源码传播较为广泛，其中功能较之前版本剔除部分。\n\n关于 ZxShell 的研究可以参看思科的 Threat Spotlight: Group 72, Opening the ZxShell 报告[8]。\n\n内部公开版 源码公开版 二次开发版\n\n**CleanEvent** √ √ √\n\n**End** √ √ √\n\n**Execute** √ √ √\n\n**Help / ?** √ √ √\n\n**LoadDll** √ √ √\n\n**Ps** √ √ √\n\n**SC** √ √ √\n\n[8 Threat Spotlight: Group 72, Opening the ZxShell，http://blogs.cisco.com/security/talos/opening-zxshell](http://blogs.cisco.com/security/talos/opening-zxshell)\n\n**29 / 78**\n\n\n-----\n\n**ShareShell** √ √ √\n\n**SysInfo** √ √ √\n\n**TermSvc** √ √ √\n\n**TransFile** √ √ √\n\n**ZXNC** √ √ √\n\n**zxplug** √ √ √\n\n**CA** √ √ ×\n\n**CloseFW** √ √ ×\n\n**FileTime** √ √ ×\n\n**PortScan** √ √ ×\n\n**RunAs** √ √ ×\n\n**Shutdown** √ √ ×\n\n**Uninstall** √ √ ×\n\n**User** √ √ ×\n\n**ZXHttpProxy** √ √ ×\n\n**ZXHttpServer** √ √ ×\n\n**ZXSockProxy** √ √ ×\n\n**capsrv** √ × ×\n\n**Exit / Quit** √ × ×\n\n**FileMG** √ × ×\n\n**FindDialPass** √ × ×\n\n**FindPass** √ × ×\n\n**GetCMD** √ × ×\n\n**KeyLog** √ × ×\n\n**rPortMap** √ × ×\n\n**SYNFlood** √ × ×\n\n**winvnc** √ × ×\n\n**ZXARPS** √ × ×\n\n总共指令数量 35 24 13\n\n从上表可以看出基于相关版本的木马，对应版本自带指令数量不断减少，也就是毒云藤\n组织剔除了较多已有的功能，在二次开发版中只保留了 13 个指令，进一步增量了其他指令\n和功能。二次开发版中相关新增功能如下表所示：\n\n二次开发版与源码公开版对比\n\n剔除功能 保留功能 新增功能\n\n\n克隆系统账号\n暂时关闭 windows 自带防火\n墙\n克隆一个文件的时间信息\n端口扫描\n以其他进程或用户的身份运\n\n\n清除系统日记\n结束本程序\n运行一个程序\n显示本信息\n加载一个 DLL 或插入到指定\n的进程\n\n**30 / 78**\n\n\nIEPass 获取 IE 密码\n搜索敏感信息加密写入文件：\n指定时间范围内；指定文件扩\n展名；指定关键字范围内\n搜集信息回传到服务器\n期间相关版本改动：修改监控\n\n\n-----\n\n行程序\n注销 || 重启 || 关闭系统\n卸装\n系统帐户管理\n代理服务器\nHTTP 服务器\nSocks 4 & 5 代理\n\n\n进程管理\n服务管理\n共享一个 Shell 给别人.\n查看系统详细信息\n配置终端服务\n从指定网址下载文件或上传\n文件到指定 FTP 服务器\nNC\n\n插件功能, 可添加自定义命\n令\n\n\n日志文件加密写到日志\n_adovbs.mof；添加配置字符的_\n监控；增加了 _Profiles.log 记_\n录系统信息和文件信息\n\n\n我们捕获到的样本是基于 ZxShell 源码修改，保留原有结构，ZxShell 本身指令比较多，\n有二十多种。我们捕获的样本除了保留部分指令外，剔除了大量指令，如：安装启动，克隆\n系统账户，关闭防火墙，端口扫描，代理服务器等功能。另外增加“IEPass”指令。\n\n图 32 包含 IEPass 指令相关代码截图\n\n相关子版本迭代更新（二次开发版）\n\n1、 对比上一个版本,变化主要是搜集信息的部分,搜集文档的创建时间时间从半年前变成 4\n\n年前，增加对“.wps”扩展名的文件搜集，改变原来的“.doc”为“.doc*”；\n2、 窃取的文档的创建时间又重新变成半年，文件打包部分修改，去除文件版本信息；\n3、 比较大的改动，修改监控日志文件加密写到日志 adovbs.mof，添加配置字符的监控，增\n\n加，增加了 Profiles.log 记录系统信息和文件信息；\n4、 代码功能较上个版本更新较少，相关函数位置发生了变化，是对抗杀毒软件进行了相关\n\n调整。\n\n**31 / 78**\n\n\n-----\n\n图 33 包含相关关键字代码截图\n\n**ZxShell 相关配置列表**\n\n上线密码 标记 关键字\n\nadmin fish1111 “201”,“报”，“项”\n\nps1357 ps1234 “军事”，“对台”，“工作”\n\nftp533 ftp1234 “军”，“项”\n\n8613 spring “军”，“航”，“报告”\n\n661566 大 661566 大 “极地”，“军”，“雪”\n\n987 zxcvasdf “对台”，“国际”，“军”\n\n95279527 asusgo “航”，“无人”，“军”\n\nqwer1234 kano918 “航”，“军”，“部”\n\n#### C. 酷盘版\n\n相关样本伪装文件夹图标，执行后释放“svch0st.exe”的木马文件和用作迷惑用户的正\n常文件夹和“.doc”文档文件。\n\n“svch0st.exe”是一个采用 ssl 加密协议传输的一个木马程序，它会每过一个小时，执\n行一遍所有的木马流程，木马流程把包括获取电脑上的所有信息（相关信息包括：文件目录、\n系统版本，网卡信息、进程列表信息、打包指定文件、网络信息和磁盘信息），还有如果发\n现文件有相关关键字（如：“台”、“军”、“战”）的文件，打包，通过 ssl 协议的方式上传到\n攻击者事先注册的酷盘。\n\nC&C 地址是酷盘地址[9]，通过酷盘提供的 API 进行文件上传。\n\n\nAPI 上传接口：\nhttps://api-upload.kanbox.com/0/upload/%s/%s?bearer_token=%s\nhttps://auth.kanbox.com/0/token\n\n\n9https://kanbox.com/\n\n\n**32 / 78**\n\n\n-----\n\n图 34 包含酷盘 API 地址的代码截图\n\n图 35 酷盘官网首页截图\n\n\n酷盘版 **A 相关功能描述**\n（不释放 **Shellcode 后门）**\n\n\n酷盘版 **B 相关功能描述**\n（释放 **shellcode 后门）**\n\n\n1、 释放窃密木马子体\n2、 获取系统信息\n\n\n1、 释放窃密木马子体\n2、 获取系统信息\n\n**33 / 78**\n\n\n-----\n\n3、 搜索敏感文件\n4、 打包加密上传敏感文件\n\n酷盘版相关配置信息列表\n\n\n3、 搜索敏感文件\n4、 打包加密上传敏感文件\n5、 释放 Shellcode 后门子体（增加）\n6、 连接远程 CC 服务器（增加）\n7、 执行远程命令（增加）\n\n\n样本编译时间戳 监控字符 特征串\n\n**2/11/2015 20:48:26** “2014\",\"军\"，“兵” A-plus\n\n**2/11/2015 20:48:26** “台”，“军”，“战” Aboutdoublewu\n\n**2/11/2015 20:48:26** “201”，“报”，“研” book\n\n**2/11/2015 20:48:26** “国际”，“合作”，“军事” wind\n\n**2/11/2015 20:48:26** “部队”，“机场”，“部队” rankco\n\n**3/1/2015 22:08:18** “2014\",\"军\"，“兵” A-plus\n\n**3/2/2015 8:21:01** “军”，“机”，“站” ineedyou\n\n**3/2/2015 23:17:57** “十”，“国”，“中” ineedyou\n\n**3/2/2015 23:17:57** “军”，“机”，“站” ineedyou\n\n**3/2/2015 23:17:57** “十三”，“运输”，“铁路” AJ\n\n**5/4/2015 16:48:12** “部队”，“台湾”，“基地” rancor\n\n**5/4/2015 16:48:12** “军”，“科技”，“国” furyman\n\n**5/4/2015 16:48:12** “201”，“密”，“内部” king\n\n**5/4/2015 16:48:12** “2015 年”，“工作”，“报告” comein\n\n**5/4/2015 16:48:12** “201”，“报”，“研” book\n\n#### D. 未知 RAT\n\n未知 RAT 从外层 dropper 区分为文件夹和捆绑两个版本，其中的 RAT 分为 4 个版本，这\n4 种 RAT 均为未知远控。\n**a)** 文件夹版\n\n图 36 未知 RAT 文件版执行后相关变化\n\n**b)** 捆绑版\n\n\n67d5f04fb0e00addc4085457f40900a2\n└─Atnewyrr.exe~tmp.zip\n\n\n**34 / 78**\n\n\n-----\n\n│ newyrr.exe\n│\n└─doll.exe\naaa.vbs\nb.bat\nserver.exe\n\n\n图 37 未知 RAT 中利用到的数字签名\n\n#### E. 其他\n\n毒云藤组织在相关行动中使用的后门程序，进一步还包括 gh0st、XRAT、HttpBot 这三种\nRAT。\n\n**35 / 78**\n\n\n-----\n\n### 3) 脚本加载的攻击载荷分析\n\n2018 年初，360 威胁情报中心发现了毒云藤组织使用的一个用于控制和分发攻击载荷的\n控制域名 http://updateinfo.servegame.org，并对外披露了相关攻击技术和关联分析(详见\nhttps://ti.360.net/blog/articles/analysis-of-apt-c-01/)。\n在该攻击活动中，该组织结合 CVE-2017-8759 漏洞文档，下载恶意的 HTA 文件，执行相\n关脚本命令来下载执行后续的攻击载荷模块。\n\n### A. Dropper 分析\n\nDropper 程序由鱼叉邮件附带的漏洞文档触发下载执行。\n\n**36 / 78**\n\n\n-----\n\n并且进一步下载恶意的 HTA 文件，其执行 PowerShell 指令下载 Loader 程序，保存为\nofficeupdate.exe 并执行。\n\n### B. Loader 分析\n\n根据 Loader 程序中包含的字符串信息，制作者将其命名为 SCLoaderByWeb，版本信息\n为 1.0 版，从字面意思为从 Web 获取的 Shellcode Loader 程序。其用来下载执行 shellcode 代\n码。\n\nLoader 程序首先会尝试连接某常用网址，以判断网络联通性，如果没有联网，会每隔 5\n秒尝试连接一次，直至能联网。\n然后从 hxxp://updateinfo.servegame.org/tiny1detvghrt.tmp 下载 payload，如图：\n\n**37 / 78**\n\n\n-----\n\n接着判断文件是否下载成功，如果没有下载成功会休眠 1 秒后，然后再次尝试下载\npayload：\n\n下载成功后，把下载的文件内容按每个字节分别和 0xac，0x5c，0xdd 异或解密(本质上\n就是直接每个字节异或 0x2d)，如图：\n\n**38 / 78**\n\n\n-----\n\n之后把解密完的 shellcode 在新创建的线程中执行，如图：\n\n**39 / 78**\n\n\n-----\n\n### C. Shellcode 分析\n\n分发域名地址托管的.tmp 文件均为逐字节异或的 shellcode，如下图为从分发域名下载\n的 tinyq1detvghrt.tmp 文件，该文件是和 0x2d 异或加密的数据。\n\n解密后发现是 Poison Ivy 生成的 shellcode，标志如下：\n\n通过分析测试 Poison Ivy 木马生成的 shellcode 格式与该攻击载荷中使用的 shellcode 格\n式比较，得到每个配置字段在 shellcode 中的位置和含义。\n\n**40 / 78**\n\n\n-----\n\n其 shellcode 配置字段的格式详细如下：\n\n**41 / 78**\n\n\n-----\n\n在分析 Poison Ivy 中获取 kernel32 基址的代码逻辑时，发现其不兼容 Windows 7 版本系\n统，因为在 Windows 7 下 InitializationOrderModule 的第 2 个模块是 KernelBase.dll，所以其获\n取的实际是 KernelBase 的基址。\n\n由于 Poison Ivy 已经停止更新，所以攻击团伙为了使 shellcode 能够执行在后续版本的\nWindows 系统，其采用了代码 Patch 对获取 kernel32 基址的代码做了改进。\n其改进方法如下：\n1. 在原有获取 kernel32 基址代码前增加跳转指令跳转到 shellcode 尾部，其 patch 代码增\n加在尾部；\n2. patch 代码首先获取 InitializationOrderModule 的第 2 个模块的基址 (WinXP 下为\nkernel32.dll,WIN7 为 kernelbase.dll)；\n3. 然后获取 InitializationOrderModule 的第二个模块的 LoadLibraryExA 的地址(WinXP 下的\nkernel32.dll 和 WIN7 下的 kernelbase.dll 都有这个导出函数)\n4. 最后通过调用 LoadLibraryExA 函数获取 kernel32 的基址。\n\n**42 / 78**\n\n\n-----\n\n攻击者针对 shellcode 的 patch，使得其可以在不同的 Windows 系统版本通用。\n该 shellcode 的功能主要是远控木马的控制模块，和 C2 通信并实现远程控制。这里我们\n在 Win7 系统下模拟该木马的上线过程。\n\n**43 / 78**\n\n\n-----\n\n对控制域名上托管的其他 shellcode 文件进行解密，获得样本的上线信息统计如下：\n\n行动 ID 上线域名 端口 上线密码 互斥体\n\n2017 office.go.dyndns.org 5566 !@#3432!@#@! )!VoqA.I4\n\nbing zxcv201789.dynssl.com 8088 zxc5566 )!VoqA.I4\n\nding1 microsoftword.serveuser.com 53 1wd3wa$RFGHY^%$ )!VoqA.I4\n\nding2 uswebmail163.sendsmtp.com 53 1wd3wa$RFGHY^%$ )!VoqA.I4\n\ngeiwoaaa geiwoaaa.qpoe.com 443 wyaaa8 )!VoqA.I4\n\njin_1 hy-zhqopin.mynumber.org 80 HK#mq6!Z+. )!VoqA.I4\n\njin_2 bearingonly.rebatesrule.net 53 ~@FA<9p2c* )!VoqA.I4\n\njustdied www.service.justdied.com 80 ppt.168@ )!VoqA.I4\n\npouhui pouhui.diskstation.org 53 index#help )!VoqA.I4\n\ntina_1 fevupdate.ocry.com 80 168168 )!VoqA.I4\n\ntina_2 wmiaprp.ezua.com 53 116688 )!VoqA.I4\n\ntony_1 winsysupdate.dynamic-dns.net 80 0A@2q60#21 )!VoqA.I4\n\ntony_2 officepatch.dnset.com 53 aZ!@2q6U0# )!VoqA.I4\n\n### 4) 最新控制木马分析\n\n在 2018 年 5 月，我们在该组织针对境内相关海事机构和单位的攻击活动中，发现了其\n使用的新的木马程序，其主要利用鱼叉邮件投递 RAR 自解压程序附件，当受害目标人员双\n击后执行。\n该远控模块的入口处，通过触发异常代码，在 catch 里执行恶意代码，如图：\n\n**44 / 78**\n\n|行动ID 上线域名 端口 上线密码 互斥体|Col2|Col3|Col4|Col5|\n|---|---|---|---|---|\n|2017|office.go.dyndns.org|5566|!@#3432!@#@!|)!VoqA.I4|\n|bing|zxcv201789.dynssl.com|8088|zxc5566|)!VoqA.I4|\n|ding1|microsoftword.serveuser.com|53|1wd3wa$RFGHY^%$|)!VoqA.I4|\n|ding2|uswebmail163.sendsmtp.com|53|1wd3wa$RFGHY^%$|)!VoqA.I4|\n|geiwoaaa|geiwoaaa.qpoe.com|443|wyaaa8|)!VoqA.I4|\n|jin_1|hy-zhqopin.mynumber.org|80|HK#mq6!Z+.|)!VoqA.I4|\n|jin_2|bearingonly.rebatesrule.net|53|~@FA<9p2c*|)!VoqA.I4|\n|justdied|www.service.justdied.com|80|ppt.168@|)!VoqA.I4|\n|pouhui|pouhui.diskstation.org|53|index#help|)!VoqA.I4|\n|tina_1|fevupdate.ocry.com|80|168168|)!VoqA.I4|\n|tina_2|wmiaprp.ezua.com|53|116688|)!VoqA.I4|\n|tony_1|winsysupdate.dynamic-dns.net|80|0A@2q60#21|)!VoqA.I4|\n|tony_2|officepatch.dnset.com|53|aZ!@2q6U0#|)!VoqA.I4|\n\n\n-----\n\n然后再用同样的方法触发异常代码，进入第二层的代码:\n\n**45 / 78**\n\n\n-----\n\n进入初始化套接字，并和 C2 建立连接的地方：\n\n**46 / 78**\n\n\n-----\n\n连接 zxcv201789.dynssl.com 的 8080 端口，创建 C&C 通道：\n\n**47 / 78**\n\n\n-----\n\n其中向控制服务器发送上线包的地方有上线密码:asd88，如图：\n\n**48 / 78**\n\n\n-----\n\n最后进入远控的功能循环部分：\n\n\n**49 / 78**\n\n\n-----\n\n图如下：\n\n|功能包括：|Col2|\n|---|---|\n|Token|功能|\n|0x04|关闭连接|\n|0x41|远程shell|\n|0x42|进程枚举|\n|0x43|结束指定进程|\n|0x51|枚举驱动器|\n|0x52|列指定目录|\n|0x53|上传文件到受害者|\n\n\n**50 / 78**\n\n\n-----\n\n|0x54|下载受害者的文件|\n|---|---|\n|0x55|删除文件|\n|0x56|远程执行|\n\n\n该木马程序中的字符串用的都是反转的字符串，通过 C 语言的 strrev 把字符串反转回来，\n这种方式，在该组织 2015 年的木马中也用到过。如图：\n\n## 4. C&C 分析\n\n### 1) 动态域名\n\n图 38 动态域名服务商（ChangeIP）\n\n**51 / 78**\n\n\n-----\n\n图 39 动态域名服务商相关比例图\n\n动态域名服务商 域名数量\n\n**ChangeIP** 30\n\n**No-IP** 9\n\n**DynDNS** 2\n\n**Afraid（FreeDNS）** 1\n\n**dnsExit** 1\n\n非动态域名 6\n\n### 2) 域名涵义\n\n以下是取动态域名子域名（攻击组织注册的名称），进行相关映射涵义的研究分析。\n\n**C&C** 名称 网站名称 网站地址\n\n**chinamil.lflink.com** chinamil 中国军网 www.chinamil.com.cn[10]\n\n红色战略网 www.chinamil.com\n\n\n中国国防域名\n注册网\n\n\nwww.chinamil.cn\n\n\n**soagov.sytes.net**\n**soagov.zapto.org**\n**soasoa.sytes.net**\n\n\nsoagov，soasoa 国家海洋局 www.soa.gov.cn\n\n\n**xinhua.redirectme.net** xinhua 新华网 www.xinhuanet.com\n\n类别 名称\n\n邮箱类 126mailserver、mail.sends、mail163、mailsends\n\n杀软类 kav2011，safe360，cluster.safe360，rising\n\n网络类 javainfo、webupdate、updates、netlink\n\n10 该网站目前会重定向到 [www.81.cn](http://www.81.cn/) 中国军网新的域名。\n\n**52 / 78**\n\n\n-----\n\n姓名类 Sandy、jerry、jason\n\n### 3) 云盘\n\n酷盘相关样本目前两个 Token：\n\n**client_id** **client_secret** **refresh_token**\n\n\n**Token1** 3edfe684ded31a7cca637\n8c0226f5629\n\n**Token2** 7a5691b81bf4322fd88f5f\na99407fbbc\n\n\nbfa89eebf29032076e9cffb\n75549fee5\n\nd44cfa7dd3c852b69c59efa\ncf766cc23\n\n\n75cdc35b1cdaee24047f3af\nb23a5ccce\n\n14b6685330bf32a2268891\n0e765b5dce\n\n\n我们通过对酷盘 API 的分析，得到攻击组织所使用的云盘帐号的信息，主要是包含一个\n中国移动的手机号码，该号码被用来注册云盘帐号。\n\n{\"status\":\"ok\",\"email\":\"\",\"phone\":\"15811848796\",\"spaceQuota\":1700807049216,\"spaceUsed\":5\n08800279,\"emailIsActive\":0,\"phoneIsActive\":1}\n\n以下是我们通过该手机号进行的一些关联分析结果：\n\n图 40 谷歌搜索相关结果\n\n图 41 威风堂机车网该用户信息 1\n\n**53 / 78**\n\n\n-----\n\n图 42 威风堂机车网该用户信息 2\n\n图 43 手机号机主相关支付宝和微信信息\n\n**54 / 78**\n\n\n-----\n\n### 4) 第三方博客\n\n图 44 某第三方博客部分截图\n\n上图为毒云藤组织依托某第三方博客进行恶意代码传播。博客的域名通常在防火墙和各\n种安全软件的白名单里，使用这种方法将恶意代码存在博客中，可以躲避查杀和拦截。\n\n**55 / 78**\n\n\n-----\n\n### 5) C&C 的 IP（ASN）\n\n 6) 其他\n\n\n图 45 C&C IP 关联分析\n\n\n非动态域名中 gaewaaa.upgrinfo.com 这个域名有相关 whois 信息，具体如下图。\n\n**56 / 78**\n\n\n-----\n\n图 46 域名注册信息\n另外一个非动态域名 moneyaaa.beijingdasihei.com\n\n## 5. 关联分析\n\n### 1) 整体关联\n\n从原始攻击邮件、漏洞文件、3 种不同 RAT（ZxShell，Poison Ivy 和酷盘版）、以及相关\n域名、上线密码、文件扩展名、压缩包密码和关键字不同资源之间进行关联。\n\n**57 / 78**\n\n\n-----\n\n图 47 不同资源之间整体关联\n\n### 2) RAT 迭代升级（对抗手法）\n\nA B C D E F G\n\n\n开发环境 加密方\n\n法\n\n\n自定义窃密函\n\n数\n\n**58 / 78**\n\n\nShellco\n\nde\n\n\n免杀对抗\n静\n\n\n免杀对抗\n动\n\n\n伪装文档\n\n等\n\n\n-----\n\nhttpbot C++ × √ × √ √ √\n\nKbox C++ √ √ √ √ √ √\n\nPoison Ivy C++ √ × √ √ √ ×\n\n\npuppet Borland\n\nC++\n\n\n√ × × √ × √\n\n\nXRAT Delphi √ × √ √ √ ×\n\n\ngh0st Borland\n\nC++\n\nFakeRising Borland\n\nC++\n\n\n√ × × √ × √\n\n× × × × × ×\n\n\nAresRemote C++ √ × × √ × √\n\nshellcode C++ √ × √ √ √\n\n\nFakeWinupda\n\nte\n\n\nC++ √ × × √ × ×\n\n\nSBolg2014 C++ √ √ √ √ × √\n\nSBolg2015 C++ √ × √ √ × ×\n\nzxshell C++ √ √ √ √ √\n\n同源样本的典型手法：\n\n#### A. 开发环境\n\n除了 XRAT 后门之外，其他的版本从 2007 年至 2015 年都是用了 C++开发语言。\n\n#### B. 加密方法\n\n2011、memcache 版、Voice64 版、HTTPBOTS 版、kanbox 版、PI、XRAT 都使用了连续 2\n次异的解密方式，然后执行恶意代码。另外云盘版木马在上传文件也会对文件进行相关加密\n方法。\n\n图 48 未知 RAT2011 版（左），酷盘版（右）\n\n**59 / 78**\n\n\n-----\n\n#### C. 窃密函数\n\nZXShell 版后门使用的自定义窃取函数和 2015 网盘版子体使用的窃取函数非常相似。同\n样都排除了 A 盘的搜索（通常为软盘驱动器盘符）；同样都预先遍历磁盘，将盘符列表保存\n在内存中，通过指针加 5 的方式读取内存中的盘符列表。\n\n图 49 ZxShell（左），酷盘版（右）\n\n#### D. Shellcode 后门\n\n对比 2011 版（Poison Ivy）注入到系统的 Shellcode 和 2015 云盘版子体，可以看出使用\n了高度相似的 Shellcode 后门，上线地址尾部同样采用 0x30 填充。\n\n图 50 未知 RAT2011 版（左），酷盘版（右）\n相关 shellcode 木马文件检出结果（0 检出）：\n[https://www.virustotal.com/en/file/8cee670d7419d1fd0f8f0ac6a2bd981593c2c96ca0f6b801931](https://www.virustotal.com/en/file/8cee670d7419d1fd0f8f0ac6a2bd981593c2c96ca0f6b8019317cf556337cfa8/analysis/)\n[7cf556337cfa8/analysis/](https://www.virustotal.com/en/file/8cee670d7419d1fd0f8f0ac6a2bd981593c2c96ca0f6b8019317cf556337cfa8/analysis/)\n\n**60 / 78**\n\n\n-----\n\n#### E. 子体文件名（外层）\n\n通过对比 2009 版代码和和 2011 版代码，可以看出病毒释放的子体文件名都为~work.tmp、\n格式化字符串都为“%s\\%s.bak”，并且代码相似度极高。\n\n使用~tmp.tmp、~tmp.zip、~mstmp.cpt 作为木马临时文件名（07~09）。\n\n图 51 未知 RAT2009 版（左），未知 RAT2011 版（右）\n\n#### F. 免杀对抗–API 字符串逆序对抗静态扫描：\n\nHttpBot、酷盘、XRAT、未知 RAT（07~11 版）木马，代码编写过程中使用了逆序 API 字\n符串。木马执行时，通过_strrev 函数将逆序字符串转换为正常 API 字符串，最后调用\nGetProcAddress 函数动态获得 API 地址。逆序 API 字符串增加了字符串检测难度，使得 API\n字符串不易被检测；除此之外，API 地址是在木马动态执行中获得，在 PE 静态信息中很难\n被检测到，增加了 API 检测难度。\n\n毒云藤组织已知最早从 2009 年开始使用此方法，并且持续到 2018 年仍在使用。\n\n**61 / 78**\n\n\n-----\n\n图 52 未知 RAT2009（上），酷盘（下）\n\n#### G. 免杀对抗–传递错误 API 参数对抗动态扫描：\n\n酷盘、Poison Ivy、XRAT、ZxShell、未知 RAT（07~11 版）木马，使用了 GetClientRect 函\n数对抗杀毒软件的动态扫描技术。\n\nGetClientRect 原型为：BOOL GetClientRect(HWND hWnd,LPRECT lpRect);。作用是获得窗\n口坐标区域。其中第 1 个参数为目标窗口句柄，第 2 个参数为返回的坐标结构。木马调用\nGetClientRect，故意在第一个参数传递参数为 0，这样使得 GetClientRect 函数在正常 Windows\n操作系统中永远执行失败，返回值为 0；\n\n目前很多杀毒软件使用了动态扫描技术（多用于启发式检测），在模拟执行 GetClientRect\n函数时并没有考虑错误参数的情况，使得 GetClientRect 函数永远被模拟执行成功，返回值\n非 0。这样一来，杀毒软件虚拟环境和用户真实系统就可以被木马区分，从而躲避杀毒软件\n检测。实测卡巴斯基虚拟机启发式扫描环境可以被木马检测到。\n\n毒云藤组织已知最早从 2011 年开始使用此方法，并且持续到 2018 年仍在使用。\n\n**62 / 78**\n\n\n-----\n\n图 53 未知 RAT2011（左上），zxshell（右上），酷盘（下）\n\n其中在酷盘使用了动态获取 API 的方式调用 GetClientRect 函数。\n\n#### H. 合法数字签名\n\n2011 之前早期版本\n\n**63 / 78**\n\n\n-----\n\n2015BLOG 版本\n在 2015 年 5 月开始使用签名（疑似被盗用）\n签名：We Build Toolbars LLC\n\n**64 / 78**\n\n\n-----\n\n# 第4章 幕后始作俑者\n\n## 1. 资源方法\n\n1、 漏洞文档：\n（1） 主要是释放的正常 DOC：繁体、或某特定地区相关字体字符等。DOC 代码页\n（2） 一些路径，如 PPSX 的 DANK？\n2、 PE：字符串繁体、或某特定地区相关字体字符（BIG5 等）等等。PE 文件版本信息。上\n线 ID\\密码\\互斥量等字符串\n3、 CC：\n（1） 非动态域名：韦氏拼音，注册信息\n（2） 动态域名：\n（3） 云盘\n4、 IP：或某特定地区、美国，主要区分 CC 的和邮件的\n5、 相关作息时间：PE 时间戳、文档时间等等，结论比如集中在周一上午攻击等等\n\n## 2. 相关关联信息\n\n### 1) 域名 whois 信息\n\n域名为 javainfo.upgrinfo.com，注册信息中的地址是某特定地区，相关人名使用的可能\n是韦氏拼音等。\n\n**65 / 78**\n\n\n-----\n\n### 2) 关注的关键字\n\n关键字：\n\n\n图 54 包含相关关键字代码截图\n\n\n“对台”，“台”，“台湾”\n\n\n漏洞文件或木马程序原始文件名（诱饵文件名）相关列表：\n\n\n2012 年度涉台法学研究课题材料.doc\n2012 年度涉台周边问题研究课题材料.doc\n2013 年度涉台周边问题研究课题材料.doc\n关于海峡两岸关系法学研究会 2012 年年会暨会员大会的通报.doc\n关于两岸关系研究学术座谈会的背景材料.doc\n海峡两岸关系研究会 2013 年度涉台周边问题研究征集选题.zip\n海峡论坛深层次推动两岸关系.exe\n两岸军事互信研究学术研讨会议邀请信.doc\n台盟中央参政议政工作通讯 2013 年第 2 期.doc\n\n\n### 3) PE 样本中繁体字体、BIG5 字符集\n\nZxshell 版本中帮助信息是乱码,实际是繁体中文。\n\n图 55 ZxShell 相关代码截图\n\n**66 / 78**\n\n\n-----\n\n图 56 未知 RAT2009\n\n### 4) 漏洞文档中繁体字体\n\n图 57 漏洞文档（CVE-2014-4114）属性详细信息截图\n\n图 58 漏洞文档（CVE-2014-4114）内 slide 文件内容\n\n**67 / 78**\n\n\n-----\n\n### 5) 释放的迷惑文档\n\n某特定地区默认字体：细明体\n\n图 59 后门释放的迷惑文档\n\n图 60 新华网相关新闻截图\n\nhttp://news.xinhuanet.com/world/2014-05/18/c_1110741502.htm\n\n**68 / 78**\n\n\n-----\n\n# 第5章 组织能力或特性分析\n\n子项 毒云藤\n\n政府人员、行业专家 政府人员、行业专家\n\n行业、领域 中国政府、科研院所、海事机构\n\n等 军事、两岸关系\n\n中国 中国，其他\n\n重点：北京、福建、广东、浙江、 重点：北京、天津\n\n上海\n\n攻击者个人信息\n\n简体中文、繁体中文 简体中文、越语\n\n威胁等级 高（5） 高（4）\n\n综合实力 高（5） 高（3）\n\n常用语言或语种 简体中文 简体中文\n\n攻击前导 邮件+PE 邮件+PE\n\n邮件+漏洞文档 网站+PE（MAC）\n\n发送邮件习惯 用WEB 邮箱\n\nPhpmail 工具\n\n0day 利用的情况 1 个 无\n\n漏洞利用种类 CVE-2014-4114、CVE-2012-0158 无\n\n攻击平台 windows Windows\\Mac\n\n横向移动\n\n常用RAT 类型 PI\\ZXSHELL 等 未知\n\n家族种类 6 个以上 4\n\n无 无\n\nCC 指令、遍历指定文件 CC 指令\n\n首次攻击时间 2007 2012\n\n最近攻击时间 2018 2018\n\n活跃度 非常活跃 非常活跃\n\nC&C 域名属性 大量采用动态域名，基于NO-IP\n\n等 护\n\nIP 属性 ADSL，大部分归属地为某特定地\n\n区，另外有美国、中国香港\n\n**69 / 78**\n\n|主项|子项|毒云藤|海莲花|\n|---|---|---|---|\n|攻击目标|人员|政府人员、行业专家|政府人员、行业专家|\n||行业、领域|中国政府、科研院所、海事机构 等 军事、两岸关系|中国政府、科研院所、海事机构等|\n||国家|中国|中国，其他|\n||地域|重点：北京、福建、广东、浙江、 上海|重点：北京、天津|\n|概况|攻击者个人信息|||\n||规模|||\n||母语|简体中文、繁体中文|简体中文、越语|\n||威胁等级|高（5）|高（4）|\n||综合实力|高（5）|高（3）|\n|涉及的行动 （组织特有）||||\n|涉及的组织 （行动特有）||||\n|攻击手法|常用语言或语种|简体中文|简体中文|\n||攻击前导|邮件+PE 邮件+漏洞文档|邮件+PE 网站+PE（MAC）|\n||发送邮件习惯|用WEB 邮箱 Phpmail 工具||\n||0day 利用的情况|1 个|无|\n||漏洞利用种类|CVE-2014-4114、CVE-2012-0158|无|\n||攻击平台|windows|Windows\\Mac|\n||横向移动|||\n||常用RAT 类型|PI\\ZXSHELL 等|未知|\n||家族种类|6 个以上|4|\n||……|||\n|攻击目的|破坏|无|无|\n||窃取|CC 指令、遍历指定文件|CC 指令|\n|行动持续时 间|首次攻击时间|2007|2012|\n||最近攻击时间|2018|2018|\n||活跃度|非常活跃|非常活跃|\n|其他|C&C 域名属性|大量采用动态域名，基于NO-IP 等|未使用动态域名，但有域名信息保 护|\n||IP 属性|ADSL，大部分归属地为某特定地 区，另外有美国、中国香港||\n\n\n-----\n\n# 附录 1：文件 MD5 列表\n\n\n03d762794a6fe96458d8228bb7561629\n0595f5005f237967dcfda517b26497d6\n07561810d818905851ce6ab2c1152871\n0e80fca91103fe46766dcb0763c6f6af\n1374e999e1cda9e406c19dfe99830ffc\n1396cafb08ca09fac5d4bd2f12c65059\n1ab54f5f0b847a1aaaf00237d3a9f0ba\n1aca8cd40d9b84cab225d333b09f9ba5\n1dc61f30feeb60995174692e8d864312\n250c9ec3e77d1c6d999ce782c69fc21b\n2579b715ea1b76a1979c415b139fdee7\n26d7f7aa3135e99581119f40986a8ac3\n27f683baed7b02927a591cdc0c850743\n28e4545e9944eb53897ee9acf67b1969\n2a96042e605146ead06b2ee4835baec3\n2c405d608b600655196a4aa13bdb3790\n30866adc2976704bca0f051b5474a1ee\n31c81459c10d3f001d2ccef830239c16\n3484302809ac3df6ceec857cb4f75fb1\n36c23c569205d6586984a2f6f8c3a39e\n382132e601d7a4ae39a4e7d89457597f\n3e12538b6eaf19ca163a47ea599cfa9b\n41c7e09170037fafe95bb691df021a20\n45e983ae2fca8dacfdebe1b1277102c9\n4e57987d0897878eb2241f9d52303713\n5696bbee662d75f9be0e8a9ed8672755\n5e4c2fbcd0308a0b9af92bf87383604f\n5ee2958b130f9cda8f5f3fc1dc5249cf\n5f1a1ff9f272539904e25d300f2bfbcc\n611cefaee48c5f096fb644073247621c\n67d5f04fb0e00addc4085457f40900a2\n6a37ce66d3003ebf04d249ab049acb22\n6ca3a598492152eb08e36819ee56ab83\n7639ed0f0c0f5ac48ec9a548a82e2f50\n76782ecf9684595dbf86e5e37ba95cc8\n785b24a55dd41c94060efe8b39dc6d4c\n7c498b7ad4c12c38b1f4eb12044a9def\n81232f4c5c7810939b3486fa78d666c2\n81e1332d15b29e8a19d0e97459d0a1de\n8abb22771fd3ca34d6def30ba5c5081c\n95f0b0e942081b4952e6daef2e373967\n\n\n**70 / 78**\n\n\n-----\n\n9b925250786571058dae5a7cbea71d28\n9bcb41da619c289fcfdf3131bbf2be21\n9f9a24b063018613f7f290cc057b8c40\na73d3f749e42e2b614f89c4b3ce97fe1\na807486cfe05b30a43c109fdb6a95993\na8417d19c5e5183d45a38a2abf48e43e\nacc598bf20fada204b5cfd4c3344f98a\naccb53eb0faebfca9f190815d143e04b\nadc3a4dfbdfe7640153ed0ea1c3cf125\nae004a5d4f1829594d830956c55d6ae4\nb0be3c5fe298fb2b894394e808d5ffaf\nb244cced7c7f728bcc4d363f8260090d\nb301cd0e42803b0373438e9d4ca01421\nbd2272535c655aff1f1566b24a70ee97\nbd4b579f889bbe681b9d3ab11768ca07\nbfb9d13daf5a4232e5e45875e7e905d7\nc31549489bf0478ab4c367c563916ada\nc8755d732be4dc13eecd8e4c49cfab94\nc8fd2748a82e336f934963a79313aaa1\nca663597299b1cecaf57c14c6579b23b\nd12099237026ae7475c24b3dfb5d18bc\nd61c583eba31f2670ae688af070c87fc\ndde2c03d6168089affdca3b5ec41f661\ne2e2cd911e099b005e0b2a80a34cfaac\ne9a9c0485ee3e32e7db79247fee8bba6\nec7e11cfca01af40f4d96cbbacb41fed\neff88ecf0c3e719f584371e9150061d2\nf0c29f89ffdb0f3f03e663ef415b9e4e\nf1b6ed2624583c913392dcd7e3ea6ae1\nf27a9cd7df897cf8d2e540b6530dceb3\nf29abd84d6cdec8bb5ce8d51e85ddafc\nf3ed0632cadd2d6beffb9d33db4188ed\nfbd0f2c62b14b576f087e92f60e7d132\nfccb13c00df25d074a78f1eeeb04a0e7\n0fb92524625fffda3425d08c94c014a1\n168365197031ffcdbe65ab13d71b64ec\n2b5ddabf1c6fd8670137cade8b60a034\n517c81b6d05bf285d095e0fd91cb6f03\n7deeb1b3cce6528add4f9489ce1ec5d6\naa57085e5544d923f576e9f86adf9dc0\ncda1961d63aaee991ff97845705e08b8\ne07ca9f773bd772a41a6698c6fd6e551\nfb427874a13f6ea5e0fd1a0aec6a095c\n\n\n**71 / 78**\n\n\n-----\n\n# 附录 2：C&C 列表\n\n\n126mailserver.serveftp.com\naccess.webplurk.com\naliago.dyndns.dk\nas1688.webhop.org\nbabana.wikaba.com\nbackaaa.beijingdasihei.com\nbt0116.servebbs.net\nceepitbj.servepics.com\ncheck.blogdns.com\nchina.serveblog.net\nchinamil.lflink.com\ncluster.safe360.dns05.com\ncnwww.m-music.net\nfff.dynamic-dns.net\ngaewaa.upgrinfo.com\ngivemea.ygto.com\ngivemeaaa.upgrinfo.com\ngoldlion.mefound.com\ngugupd.008.net\nguliu2008.9966.org\nhyssjc.securitytactics.com\njason.zyns.com\njavainfo.upgrinfo.com\njerry.jkub.com\nkav2011.mooo.com\nkouwel.zapto.org\nlaizaow.mefound.com\nlocalhosts.ddns.us\nmail.sends.sendsmtp.com\nmail163.mypop3.net\nmailsends.sendsmtp.com\nmediatvset.no-ip.org\nmoneyaaa.beijingdasihei.com\nmotices.ourhobby.com\nmp3.dnset.com\nnetlink.vizvaz.com\noperater.solaris.nu\npps.longmusic.com\nps1688.webhop.org\nrising.linkpc.net\nsafe360.dns05.com\n\n\n**72 / 78**\n\n\n-----\n\nsandy.ourhobby.com\nsoagov.sytes.net\nsoagov.zapto.org\nsoasoa.sytes.net\nssy.ikwb.com\nssy.mynumber.org\nsvcsrset.ezua.com\nteacat.https443.org\ntong.wikaba.com\nupdates.lflink.com\nusa08.serveftp.net\nwaterfall.mynumber.org\nwebupdate.dnsrd.com\nwww.safe360.dns05.com\nwww.ssy.ikwb.com\nwww.tong.wikaba.com\nwwwdo.tyur.acmetoy.com\nxinhua.redirectme.net\n131.213.66.10\n146.0.32.168\n165.227.220.223\n188.166.67.36\n199.101.133.169\n45.32.8.137\n45.76.125.176\n45.76.228.61\n45.76.9.206\n45.77.171.209\nbearingonly.rebatesrule.net\ncanberk.gecekodu.com\nemailser163.serveusers.com\nfevupdate.ocry.com\ngeiwoaaa.qpoe.com\nhy-zhqopin.mynumber.org\nl63service.serveuser.com\nmicrosoftword.serveuser.com\noffice.go.dyndns.org\nupdateinfo.servegame.org\nuswebmail163.sendsmtp.com\nwinsysupdate.dynamic-dns.net\nwmiaprp.ezua.com\nwww.service.justdied.com\nzxcv201789.dynssl.com\nofficepatch.dnset.com\n\n\n**73 / 78**\n\n\n-----\n\npouhui.diskstation.org\ncomehigh.mefound.com\nannie165.zyns.com\nhttp://annie165.zyns.com/zxcvb.hta\n\n\n**74 / 78**\n\n\n-----\n\n# 附录 3：360 追日团队（Helios Team）\n\n360 追日团队（Helios Team）是 360 公司高级威胁研究团队，从事 APT 攻击发现与追\n踪、互联网安全事件应急响应、黑客产业链挖掘和研究等工作。团队成立于 2014 年 12 月，\n通过整合 360 公司海量安全大数据，实现了威胁情报快速关联溯源，独家首次发现并追踪了\n三十余个 APT 组织及黑客团伙，大大拓宽了国内关于黑客产业的研究视野，填补了国内 APT\n研究的空白，并为大量企业和政府机构提供安全威胁评估及解决方案输出。\n\n联系方式\n\n[邮箱：360zhuiri@360.cn](mailto:360zhuiri@360.cn)\n\n微信公众号：360 追日团队\n\n扫描右侧二维码关微信公众号\n\n**75 / 78**\n\n\n-----\n\n# 附录 4：360 安全监测与响应中心\n\n360 安全监测与响应中心，是 360 为服务广大政企机构而建立的网络安全服务平台，旨\n在第一时间为政企机构提供突发网络安全事件的预警、通告，处置建议、技术分析和 360\n安全产品解决方案。突发网络安全事件包括但不限于：安全漏洞、木马病毒、信息泄露、黑\n客活动、攻击组织等。\n\n360 安全监测与响应中心兼具安全监测与响应能力：中心结合 360 安全大数据监测能力\n与海量威胁情报分析能力，能够全天候、全方位的监测和捕获各类突发网络安全事件；同时，\n基于 10 余年来为全国数万家大型政企机构提供安全服务和应急响应处置经验，中心能够在\n第一时间为政企机构应对突发网络安全事件提供有效的处置措施建议和应急响应方案。\n\n在 2017 年 5 月发生的永恒之蓝勒索蠕虫（WannaCry）攻击事件中，360 安全监测与响\n应中心在 72 小时内，连续发布 9 份安全预警通告，7 份安全修复指南和 6 个专业技术工具，\n帮助和指导全国十万余家政企机构应对危机。\n\nA-TEAM 是 360 安全监测与响应中心下属的一支专业技术研究团队，主要专注于 Web\n渗透与 APT 攻防技术研究，并持续展开前瞻性攻防工具预研，以提前探知更多的未知威胁、\n新兴威胁。A-TEAM 的技术研究从底层原理、协议实现入手，能够深度还原攻与防的技术本\n质。\n\n**76 / 78**\n\n\n-----\n\n# 附录 5：360 威胁情报中心\n\n360 威胁情报中心由全球最大的互联网安全公司奇虎 360 特别成立，是中国首个面向企\n业和机构的互联网威胁情报整合专业机构。该中心以业界领先的安全大数据资源为基础，基\n于 360 长期积累的核心安全技术，依托亚太地区顶级的安全人才团队，通过强大的大数据能\n力，实现全网威胁情报的即时、全面、深入的整合与分析，为企业和机构提供安全管理与防\n护的网络威胁预警与情报。\n\n360 威胁情报中心对外服务平台网址为 https://ti.360.net/。服务平台以海量多维度网络\n空间安全数据为基础，为安全分析人员及各类企业用户提供基础数据的查询，攻击线索拓展，\n事件背景研判，攻击组织解析，研究报告下载等多种维度的威胁情报数据与威胁情报服务。\n\n微信公众号：360 威胁情报中心\n\n关注二维码：\n\n**77 / 78**\n\n\n-----",
    "language": "ZH",
    "sources": [
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        },
        {
            "id": "99593a68-7f6e-400e-9a9f-a707f66d2e72",
            "created_at": "2022-11-23T11:07:14.353321Z",
            "updated_at": "2022-11-23T11:07:14.353321Z",
            "deleted_at": null,
            "name": "AGRO",
            "url": "https://apt.threattracking.com",
            "description": "APT Groups and Operations Spreadsheet",
            "reports": null
        }
    ],
    "references": [
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2018/2018.09.20.Poison_Trumpet_Vine_Operation/CN_APT-C-01.pdf",
        "https://ti.qianxin.com/uploads/2018/09/20/6f8ad451646c9eda1f75c5d31f39f668.pdf"
    ],
    "report_names": [
        "CN_APT-C-01",
        "6f8ad451646c9eda1f75c5d31f39f668.pdf"
    ],
    "threat_actors": [
        {
            "id": "cea5ceec-0f14-4e34-bd0e-4074bc1a707d",
            "created_at": "2022-10-25T15:50:23.629983Z",
            "updated_at": "2025-03-27T02:00:55.509459Z",
            "deleted_at": null,
            "main_name": "Axiom",
            "aliases": [
                "Group 72"
            ],
            "source_name": "MITRE:Axiom",
            "tools": [
                "ZxShell",
                "gh0st RAT",
                "Zox",
                "PlugX",
                "Hikit",
                "PoisonIvy",
                "Derusbi",
                "Hydraq"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "870f6f62-84f5-48ca-a18e-cf2902cd6924",
            "created_at": "2022-10-25T15:50:23.303818Z",
            "updated_at": "2025-03-27T02:00:55.435309Z",
            "deleted_at": null,
            "main_name": "APT32",
            "aliases": [
                "APT32",
                "SeaLotus",
                "OceanLotus",
                "APT-C-00",
                "Canvas Cyclone"
            ],
            "source_name": "MITRE:APT32",
            "tools": [
                "Mimikatz",
                "ipconfig",
                "Kerrdown",
                "Cobalt Strike",
                "SOUNDBITE",
                "OSX_OCEANLOTUS.D",
                "KOMPROGO",
                "netsh",
                "RotaJakiro",
                "PHOREAL",
                "Arp",
                "Denis",
                "Goopy"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "5c74936a-79d1-41b8-81eb-01d03c90a26b",
            "created_at": "2022-10-25T16:07:23.371052Z",
            "updated_at": "2025-03-27T02:02:09.766782Z",
            "deleted_at": null,
            "main_name": "Axiom",
            "aliases": [
                "Group 72",
                "Operation SMN"
            ],
            "source_name": "ETDA:Axiom",
            "tools": [
                "9002 RAT",
                "Agent.dhwf",
                "AngryRebel",
                "BlackCoffee",
                "BleDoor",
                "Chymine",
                "Darkmoon",
                "DeputyDog",
                "Derusbi",
                "Destroy RAT",
                "DestroyRAT",
                "Farfli",
                "Fexel",
                "Gen:Trojan.Heur.PT",
                "Gh0st RAT",
                "Ghost RAT",
                "Gresim",
                "HOMEUNIX",
                "HiKit",
                "HidraQ",
                "Homux",
                "Hydraq",
                "Kaba",
                "Korplug",
                "McRAT",
                "MdmBot",
                "Moudour",
                "Mydoor",
                "PCRat",
                "PNGRAT",
                "PlugX",
                "Poison Ivy",
                "RbDoor",
                "RedDelta",
                "RibDoor",
                "Roarur",
                "SPIVY",
                "Sensocode",
                "Sogu",
                "TIGERPLUG",
                "TVT",
                "Thoper",
                "Winnti",
                "Xamtrav",
                "ZXShell",
                "Zox",
                "ZoxPNG",
                "ZoxRPC",
                "gresim",
                "pivy",
                "poisonivy"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "416f8374-2b06-47e4-ba91-929b3f85d9bf",
            "created_at": "2022-10-25T16:07:24.093951Z",
            "updated_at": "2025-03-27T02:02:10.105752Z",
            "deleted_at": null,
            "main_name": "Rancor",
            "aliases": [
                "Rancor Group",
                "Rancor Taurus"
            ],
            "source_name": "ETDA:Rancor",
            "tools": [
                "8.t Dropper",
                "8.t RTF exploit builder",
                "8t_dropper",
                "Agentemis",
                "Cobalt Strike",
                "CobaltStrike",
                "DDKONG",
                "Derusbi",
                "Dudell",
                "ExDudell",
                "KHRAT",
                "PLAINTEE",
                "RoyalRoad",
                "certutil",
                "certutil.exe",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "af509bbb-8d18-4903-a9bd-9e94099c6b30",
            "created_at": "2023-01-06T13:46:38.585525Z",
            "updated_at": "2025-03-27T02:00:02.866727Z",
            "deleted_at": null,
            "main_name": "APT32",
            "aliases": [
                "TIN WOODLAWN",
                "OceanLotus Group",
                "OceanLotus",
                "Sea Lotus",
                "G0050",
                "Cobalt Kitty",
                "SeaLotus",
                "ATK17",
                "Ocean Lotus",
                "Ocean Buffalo",
                "POND LOACH",
                "Canvas Cyclone",
                "APT-C-00",
                "APT-32",
                "APT 32"
            ],
            "source_name": "MISPGALAXY:APT32",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "e8aee970-e31e-489f-81c2-c23cd52e255c",
            "created_at": "2023-01-06T13:46:38.763687Z",
            "updated_at": "2025-03-27T02:00:02.91243Z",
            "deleted_at": null,
            "main_name": "RANCOR",
            "aliases": [
                "Rancor",
                "Rancor Group",
                "G0075",
                "Rancor Taurus",
                "Rancor group"
            ],
            "source_name": "MISPGALAXY:RANCOR",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "f1518ac1-4710-4dd1-a422-e3801e4806cb",
            "created_at": "2024-05-01T02:03:08.147856Z",
            "updated_at": "2025-03-27T02:05:17.421275Z",
            "deleted_at": null,
            "main_name": "TIN WOODLAWN",
            "aliases": [
                "Cobalt Kitty",
                "OceanLotus",
                "WOODLAWN ",
                "APT32 "
            ],
            "source_name": "Secureworks:TIN WOODLAWN",
            "tools": [
                " Denis",
                " Goopy",
                " JEShell",
                " KerrDown",
                " Mimikatz",
                " Ratsnif",
                " Remy",
                " Rizzo",
                " RolandRAT",
                "Cobalt Strike"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "a7aefdda-98f1-4790-a32d-14cc99de2d60",
            "created_at": "2023-01-06T13:46:38.281844Z",
            "updated_at": "2025-03-27T02:00:02.792526Z",
            "deleted_at": null,
            "main_name": "APT17",
            "aliases": [
                "G0025",
                "AURORA PANDA",
                "Group 72",
                "G0001",
                "HELIUM",
                "Group 8",
                "Hidden Lynx",
                "Tailgater Team",
                "BRONZE KEYSTONE"
            ],
            "source_name": "MISPGALAXY:APT17",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "6d11e45c-4e31-4997-88f5-295b2564cfc6",
            "created_at": "2022-10-25T15:50:23.794721Z",
            "updated_at": "2025-03-27T02:00:55.548806Z",
            "deleted_at": null,
            "main_name": "Rancor",
            "aliases": [
                "Rancor"
            ],
            "source_name": "MITRE:Rancor",
            "tools": [
                "DDKONG",
                "PLAINTEE",
                "certutil"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "4c68ccd0-caba-4189-9ead-86ac4c2d9b70",
            "created_at": "2024-05-01T02:03:07.930196Z",
            "updated_at": "2025-03-27T02:05:17.251237Z",
            "deleted_at": null,
            "main_name": "BRONZE ATLAS",
            "aliases": [
                "Axiom",
                "BARIUM ",
                "Blackfly ",
                "CTG-2633",
                "GREF",
                "Group 72 ",
                "Red Kelpie ",
                "TG-2633 ",
                "Wicked Panda ",
                "Winnti",
                "APT41 "
            ],
            "source_name": "Secureworks:BRONZE ATLAS",
            "tools": [
                " CCleaner v5.33 backdoor",
                " ChinaChopper",
                " Cobalt Strike",
                " Dicey MSDN",
                " ForkPlayground",
                " HUC Proxy Malware (Htran)",
                " Mimikatz",
                " PipeMon",
                " PlugX",
                " PortReuse",
                " Powershell Empire",
                " RCMD",
                " RbDoor",
                " SPEEDBOAT",
                " ShadowPad",
                " Sidewalk",
                " Speculoos",
                " TeamViewer",
                " Winnkit",
                " Winnti",
                " reg save",
                " vssadmin",
                "Acehash"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "1edcac0b-efd9-47b1-9aca-33827d5bd085",
            "created_at": "2024-05-01T02:03:07.964773Z",
            "updated_at": "2025-03-27T02:05:17.273595Z",
            "deleted_at": null,
            "main_name": "BRONZE KEYSTONE",
            "aliases": [
                "Aurora Panda ",
                "DeputyDog ",
                "Group 72 ",
                "Hidden Lynx ",
                "Shell Crew",
                "TG-8153 ",
                "Tailgater Team",
                "APT17 "
            ],
            "source_name": "Secureworks:BRONZE KEYSTONE",
            "tools": [
                " BlackCoffee",
                " DeputyDog",
                " Derusbi",
                " Gh0stHTTPSDropper",
                " HiKit",
                " InternalCMD",
                " PlugX",
                " PoisonIvy",
                " ZxShell",
                "9002"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "2439ad53-39cc-4fff-8fdf-4028d65803c0",
            "created_at": "2022-10-25T16:07:23.353204Z",
            "updated_at": "2025-03-27T02:02:09.749502Z",
            "deleted_at": null,
            "main_name": "APT 32",
            "aliases": [
                "APT 32",
                "APT-C-00",
                "APT-LY-100",
                "ATK 17",
                "Lotus Bane",
                "Ocean Buffalo",
                "OceanLotus",
                "Operation Cobalt Kitty",
                "Operation PhantomLance",
                "Pond Loach",
                "SeaLotus",
                "SectorF01",
                "Tin Woodlawn"
            ],
            "source_name": "ETDA:APT 32",
            "tools": [
                "Agentemis",
                "Android.Backdoor.736.origin",
                "AtNow",
                "Backdoor.MacOS.OCEANLOTUS.F",
                "BadCake",
                "CACTUSTORCH",
                "CamCapture Plugin",
                "CinaRAT",
                "Cobalt Strike",
                "CobaltStrike",
                "Cuegoe",
                "DKMC",
                "Denis",
                "Goopy",
                "HiddenLotus",
                "KOMPROGO",
                "KerrDown",
                "METALJACK",
                "MSFvenom",
                "Mimikatz",
                "Nishang",
                "OSX_OCEANLOTUS.D",
                "OceanLotus",
                "PHOREAL",
                "PWNDROID1",
                "PhantomLance",
                "PowerSploit",
                "Quasar RAT",
                "QuasarRAT",
                "RatSnif",
                "Remy",
                "Remy RAT",
                "Rizzo",
                "Roland",
                "Roland RAT",
                "SOUNDBITE",
                "Salgorea",
                "Splinter RAT",
                "Terracotta VPN",
                "Yggdrasil",
                "cobeacon",
                "denesRAT",
                "fingerprintjs2"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1666716494,
    "ts_updated_at": 1743041788,
    "ts_creation_date": 1537476183,
    "ts_modification_date": 1537476183,
    "files": {
        "pdf": "https://archive.orkl.eu/667f1379170388a9984c24154da1507f02b5fd19.pdf",
        "text": "https://archive.orkl.eu/667f1379170388a9984c24154da1507f02b5fd19.txt",
        "img": "https://archive.orkl.eu/667f1379170388a9984c24154da1507f02b5fd19.jpg"
    }
}