{
    "id": "59100e64-14c1-49a1-8d20-13c8cb013dbd",
    "created_at": "2023-01-12T15:05:34.446146Z",
    "updated_at": "2025-03-27T02:09:18.002249Z",
    "deleted_at": null,
    "sha1_hash": "1795d0718344911c6f661d63f01515fd51ed282e",
    "title": "2022-05-08 - Tracking Cobalt Strike Servers Used in Cyberattacks on Ukraine",
    "authors": "",
    "file_creation_date": "2022-05-28T05:11:57Z",
    "file_modification_date": "2022-05-28T05:11:57Z",
    "file_size": 4188016,
    "plain_text": "# Tracking Cobalt Strike Servers Used in Cyberattacks on Ukraine\n\n**[ironnet.com/blog/tracking-cobalt-strike-servers-used-in-cyberattacks-on-ukraine](https://www.ironnet.com/blog/tracking-cobalt-strike-servers-used-in-cyberattacks-on-ukraine)**\n\n[Back to IronNet Blog](https://www.ironnet.com/blog)\n[Threat Research](https://www.ironnet.com/blog/tag/threat-research)\nBy IronNet Threat Research Team with lead contributions by Peter Rydzynski and Brent\nEskridge, Ph.D\n\n\n-----\n\nMay 8, 2022\n\n[On April 18, 2022, CERT-UA published alert #4490, which describes a malicious email](https://cert.gov.ua/article/39708)\ncampaign targeting Ukraine. The email attempts to deploy a Cobalt Strike beacon on the\nvictim's system through the use of a MS Office macro. In the alert, CERT-UA provides a list\nof indicators of compromise (IoCs), including a list of IP addresses and domains used in the\nattack that are known to be Cobalt Strike command and control (C2) servers.\n\nIronNet Threat Research regularly monitors the internet for malicious C2 servers, including\nCobalt Strike. As a result of this monitoring, we have a longitudinal dataset on the C2 servers\nhosted on the IP addresses and domains referenced in the alert starting in May 2021. This\nreport provides an analysis of this data in an attempt to inform the community on the\nobserved patterns of these IoCs and other indicators that may be related to those referenced\nin the alert.\n\n## Cobalt Strike: Malleable Profiles\n\nOne of the ways Cobalt Strike operators obfuscate communications between a beacon\nplanted on a victim system and the C2 server is through the use of a malleable profile. A\nmalleable profile allows the operator to configure the beacon communication to masquerade\nas benign network traffic. Some of the settings that can be modified are:\n\nthe sleep time between callbacks to the C2 server,\njitter in the callback sleep time,\nthe user agent used in the communication, and\nthe URI used in the HTTP request to the C2 server.\n\n\n-----\n\nWhile these malleable profiles are useful in obfuscating communications, they can also be\nused as an approximate fingerprint when analyzing a Cobalt Strike C2 server. While most\nactors use [open source malleable profiles or a](https://github.com/BC-SECURITY/Malleable-C2-Profiles) [malleable profile generator, which makes](https://github.com/FortyNorthSecurity/C2concealer)\nattribution or clustering challenging, a server's profile can be combined with other attributes\nto identify patterns. A full discussion of malleable profiles is beyond the scope of this report,\n[but there are numerous descriptions available elsewhere (link,](https://unit42.paloaltonetworks.com/cobalt-strike-malleable-c2-profile/) [link).](https://www.mandiant.com/resources/defining-cobalt-strike-components)\n\nTwo of the profiles that were seen in the campaign targeting Ukraine were a JQuery profile\nand a minimal defender bypass profile. JQuery is a popular choice of emulation amongst\nthreat actors; however, the minimal defender bypass profile is something that we’ve only\nnoticed in the past few months and only in this campaign.\n\n_Figure 1 - Malleable profile GET URI's observed in the IoCs since May 2021_\n\nOf the options available in malleable profiles, the request uniform resource indicator (URI) is\nthe most varied and the most useful for attempting to fingerprint, or at least categorize, C2\nservers using the malleable profile. In total, eight different URIs were observed in use by the\nC2 servers mentioned in the CERT-UA alert, indicating that there were at least eight different\nmalleable profiles used. Of particular interest are the two profiles observed in 2022, which\noverlap with Russia's invasion of Ukraine and the associated cyber attacks. The URIs\nassociated with these profiles are shown in Figure 1.\n\n\n-----\n\n_Figure 2 - A malleable profile found online that closely matches the one observed in use on_\n_numerous C2 servers described in the Ukrainian CERT alert_\n\nThe profile with the `/jquery-3.3.1.min.js URI is the more common of the two profiles,`\nboth in this particular set of IoCs and in IronNet's full data set of Cobalt Strike C2 servers\n[(see Figure 2). This particular malleable profile can be found on the internet and is listed as a](https://github.com/threatexpress/malleable-c2/blob/master/jquery-c2.3.11.profile)\nreference for designing Cobalt Strike malleable profiles. As such, use of this profile makes\nattribution difficult since it is used everywhere.\n\n_Figure 3 - A malleable profile found online that is intended to be hidden behind an Nginx_\n_redirector that matches observed C2 servers described in the Ukrainian CERT alert_\n\nThe second profile, which is referred to as the minimal defender bypass profile and has the\n```\n/apiv8/getStatus URI, can also be found on the internet, but its observed use is far more\n\n```\nrare than the previous one (see Figure 3). These servers were the first observations we have\n\n\n-----\n\nhad of this profile. At first, we thought this was due to the relative novelty of the profile.\nHowever, further inspection indicates the profile is intended to be used behind an Nginx\nredirector to hide the C2 server from fingerprinting.\n\nBoth of these profiles used in the most recent attacks are pre-made and provide a low effort\nconfiguration cost. We often see malleable profiles that are customized versions of profiles\nfound on the internet. For example, the domain `klycnmik[.]com, which uses the same`\n[jQuery URI, has been observed in use by Cobalt Strike servers associated with Emotet.](https://github.com/pan-unit42/tweets/blob/master/2022-03-01-IOCs-for-Emotet-epoch4-with-Cobalt-Strike.txt)\n\n## Cobalt Strike: Watermarks\n\n_Figure 4 - Cobalt Strike watermarks observed in the IoCs since May 2021_\n\nAnother means of categorizing and analyzing Cobalt Strike C2 servers is through the use of\nthe server's watermark. Each payload deployed by a server contains a watermark, which is a\nunique number associated with the Cobalt Strike license. But since stolen or cracked copies\nof Cobalt Strike are frequently used by threat actors, using a watermark as a fingerprint isn't\nfoolproof. For example, a watermark value of 0 indicates a cracked version. Unsurprisingly,\nthis is the most commonly found watermark in our data. Despite this, watermarks can still be\nused for analysis. The watermarks we observed being used by the IoCs described by CERTUA are shown in Figure 4. The watermark of particular interest here is `1580103824 . It is`\nshared by all the C2 servers using the `/apiv8/getStatus URI, which was specifically`\nnoted in the CERT-UA alert. While C2 servers with different profiles and configurations could\npotentially have this same watermark, we rarely observe this watermark, but have seen an\n\n\n-----\n\nincrease in recent weeks. Note that this watermark is very similar (one digit differs) from one\nassociated with a hacked version of Cobalt Strike that is frequently found on dark web\nforums.\n\nOf the five domains that share the rare URI and watermark, only four are mentioned in the\nCERT-UA alert. These are: `axikok[.]com,` `blopik[.]com,` `dezword[.]com, and`\n```\nverofes[.]com . The fifth observed domain, furfen[.]com, is not mentioned in the\n\n```\n[CERT-UA alert, but has, in addition to our own scans, been observed by other sources to be](https://threatfox.abuse.ch/browse/tag/Cobalt%20Strike/)\na Cobalt Strike C2 server. While a URI and watermark is insufficient to confirm that this\nserver is related to the others, further analysis detailed below lends more credence to the\nargument that they are related.\n\n## NGINX\n\nWe found the use of the minimal defender bypass profile to be of particular interest, not\nbecause it was used, but because they took the time to lock down the C2 communications,\nbut left the staging wide open. The profile is intended to be used with a redirector to prevent\n[the C2 server from being fingerprinted with conventional methods. This is a fairly common](https://ditrizna.medium.com/design-and-setup-of-c2-traffic-redirectors-ec3c11bd227d)\ntechnique that is not unique to Cobalt Strike and has been utilized by threat actors for quite\nsome time. Redirectors are positioned between the C2 server and the beacon to hide the\ntrue location of the C2 server. They are often configured to only redirect specific traffic from a\nbeacon to the C2 server and to direct the remaining traffic to a legitimate server, making the\ndetection of these servers challenging.\n\n## Cobalt Strike Infrastructure\n\n\n-----\n\n_Figure 5 - Observation dates of the IoCs mentioned in the Ukrainian CERT alert since May_\n_2021 (organized by unique domain or IP address)_\n\nApart from server configurations, there are a number of interesting relationships between the\ninfrastructure of the C2 servers mentioned in the alert. Over the course of the last 15 months,\nthere were three distinct clusters of activity for the IoCs described in the Ukrainian CERT\nalert. The distribution of observations for the cluster observed in 2022 is shown in Figure 5.\nIn this cluster, 35 different domains were observed, but, as discussed above, they share\nmany similarities such as profiles and watermarks.\n\nThe vast majority of the hosts listen on either port 80 (HTTP), 443 (HTTPS), or both, as\nwould be expected. One server, `axikok[.]com primarily listened on 8443 (HTTPS), but did`\nhave port 8080 (HTTP) opened intermittently.\n\nAccording to our data, the C2 servers in the alert are all hosted in one of four hosting\nproviders: HostKey, HostKey B.V., Endurance International, and UAB Nacionalinis\nTelekomunikaciju, with 33 of the 40 hosted by HostKey as far back as June 2021. As for the\ndomains themselves, all of the domains used in the most recent campaign were registered to\none of three registrars: Eranet, WEBCC, and NiceNIC, with 26 of the 30 domains registered\nat Eranet since January 10, 2022.\n\n## Next Steps\n\nIt’s clear that the ease of use and flexibility that Cobalt Strike provides is one of the main\nreasons that it remains so prevalent amongst threat actors. Reflecting on the analysis of our\ndataset matched with the indicators provided in the UA CERT alert, there are a few open\nquestions remaining. First, we see less sophisticated threat actors still deploy Cobalt Strike\nservers with little to no OPSEC, allowing even the most basic detections of C2 frameworks.\nThus, will threat actors continue to forgo OPSEC concerns as long as they continue to\ndominate victims with high success rates?\n\nSecond, we wonder whether the majority of threat actors will utilize open source malleable\nprofiles or a malleable profile generator like C2 Concealer that takes static attributes from a\nlist and combines them to a single profile? Furthermore, do threat actors take into\nconsideration the environment they are targeting when selecting a malleable profile, or are\nthey simply choosing a popular service they know will thwart most defenders? Answers to\nthese questions will be beneficial to detecting Cobalt Strike servers in the future.\n\n## Additional IOCs\n\nIronNet observed the following domains present in Cobalt Strike beacon payloads being\nserved up by the same Cobalt Strike servers mentioned in the Ukrainian CERT alert.\n\n```\nfurfen[.]com\n\n```\n\n-----\n\n```\nKlycnmik[.]com\n\n```\n\n## IronNet Threat Intel API\n\nInterested in these indicators? The IronNet Threat Research team regularly scans the\ninternet for malicious C2 frameworks. If you are interested in receiving these indicators as a\nthreat intelligence feed, contact our team by clicking the button below.\n\nAbout Ironnet\n\nFounded in 2014 by GEN (Ret.) Keith Alexander, IronNet, Inc. (NYSE: IRNT) is a global\ncybersecurity leader that is transforming how organizations secure their networks by\ndelivering the first-ever Collective Defense platform operating at scale. Employing a number\nof former NSA cybersecurity operators with offensive and defensive cyber experience,\nIronNet integrates deep tradecraft knowledge into its industry-leading products to solve the\nmost challenging cyber problems facing the world today.\n\n[Back to IronNet Blog](https://www.ironnet.com/blog)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-05-08 - Tracking Cobalt Strike Servers Used in Cyberattacks on Ukraine.pdf"
    ],
    "report_names": [
        "2022-05-08 - Tracking Cobalt Strike Servers Used in Cyberattacks on Ukraine.pdf"
    ],
    "threat_actors": [
        {
            "id": "d90307b6-14a9-4d0b-9156-89e453d6eb13",
            "created_at": "2022-10-25T16:07:23.773944Z",
            "updated_at": "2025-03-27T02:02:09.974695Z",
            "deleted_at": null,
            "main_name": "Lead",
            "aliases": [
                "Casper",
                "TG-3279"
            ],
            "source_name": "ETDA:Lead",
            "tools": [
                "Agentemis",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "RbDoor",
                "RibDoor",
                "Winnti",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "610a7295-3139-4f34-8cec-b3da40add480",
            "created_at": "2023-01-06T13:46:38.608142Z",
            "updated_at": "2025-03-27T02:00:02.87217Z",
            "deleted_at": null,
            "main_name": "Cobalt",
            "aliases": [
                "Cobalt Gang",
                "GOLD KINGSWOOD",
                "COBALT SPIDER",
                "G0080",
                "Mule Libra",
                "Cobalt Group"
            ],
            "source_name": "MISPGALAXY:Cobalt",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673535934,
    "ts_updated_at": 1743041358,
    "ts_creation_date": 1653714717,
    "ts_modification_date": 1653714717,
    "files": {
        "pdf": "https://archive.orkl.eu/1795d0718344911c6f661d63f01515fd51ed282e.pdf",
        "text": "https://archive.orkl.eu/1795d0718344911c6f661d63f01515fd51ed282e.txt",
        "img": "https://archive.orkl.eu/1795d0718344911c6f661d63f01515fd51ed282e.jpg"
    }
}