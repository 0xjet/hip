{
    "id": "4ee43a73-5ed3-498c-948d-f046249ba77c",
    "created_at": "2023-01-12T15:04:20.756893Z",
    "updated_at": "2025-03-27T02:05:59.472421Z",
    "deleted_at": null,
    "sha1_hash": "c79d979e8596b2402a07586d871210d852b6cfbc",
    "title": "2020-10-14 - Two New IoT Vulnerabilities Identified with Mirai Payloads",
    "authors": "",
    "file_creation_date": "2022-05-28T02:47:01Z",
    "file_modification_date": "2022-05-28T02:47:01Z",
    "file_size": 460752,
    "plain_text": "# Two New IoT Vulnerabilities Identified with Mirai Payloads\n\n**[unit42.paloaltonetworks.com/iot-vulnerabilities-mirai-payloads/](https://unit42.paloaltonetworks.com/iot-vulnerabilities-mirai-payloads/)**\n\nKen Hsu, Yue Guan, Vaibhav Singhal, Qi Deng October 14, 2020\n\nBy [Ken Hsu,](https://unit42.paloaltonetworks.com/author/ken-hsu/) [Yue Guan,](https://unit42.paloaltonetworks.com/author/yue-guan/) [Vaibhav Singhal and](https://unit42.paloaltonetworks.com/author/vaibhav-singhal/) [Qi Deng](https://unit42.paloaltonetworks.com/author/qi-deng/)\n\nOctober 14, 2020 at 12:00 PM\n\n[Category: Unit 42](https://unit42.paloaltonetworks.com/category/unit-42/)\n\nTags: [IoT,](https://unit42.paloaltonetworks.com/tag/iot/) [Mirai,](https://unit42.paloaltonetworks.com/tag/mirai/) [vulnerabilities](https://unit42.paloaltonetworks.com/tag/vulnerability/)\n\nThis post is also available in: 日本語 [(Japanese)](https://unit42.paloaltonetworks.jp/iot-vulnerabilities-mirai-payloads/)\n\n## Executive Summary\n\nPalo Alto Networks is proactively trying to safeguard its customers from attacks however\npossible. By leveraging its Next-Generation Firewall as sensors on the perimeter to detect\nmalicious payloads and attack patterns, Unit 42 researchers are able to hunt down the\nmenaces out there on the network, be they known or not.\n\nUnit 42 researchers have taken a closer look at four Mirai variants from two recently\ndiscovered campaigns leveraging command injection vulnerability exploits that reveal a\nfamiliar IoT attack pattern.\n\n\n-----\n\nWhile this generic approach allows researchers to observe the entire killchain and even\nacquire the malware binary from the attack, this post-exploitation heuristic does have its\ncaveat: the traffic fingerprinting. Similar services yield similar traffic patterns because of\nsimilar, if not identical, code bases and underlying implementation. Since a service can exist\nin multiple devices with different configurations and there are multiple brands for a specific\ndevice, it’s become exponentially hard, if not impossible, to identify the susceptible device(s)\nin real time.\n\nThis blog includes a brief analysis of the two IoT exploits observed in the wild and the four\nMirai variants delivered during the attack. Palo Alto Networks Next-Generation Firewall\ncustomers are protected against these attacks.\n\n## Exploit Payloads Include Mirai Variants\n\nA total of four Mirai variants were recently discovered. Two new vulnerabilities were\nleveraged as attack vectors to deliver Mirai. Upon successful exploitation, the wget utility is\ninvoked to download a shell script from the malware infrastructure. The shell script then\ndownloads several Mirai binaries compiled for different architectures and executes these\ndownloaded binaries one by one.\n\nThe first exploit, shown in Figure 1, targets a command injection vulnerability in a web\nservice with an NTP server setting feature. The service fails to sanitize the value of the HTTP\nparameter NTP_SERVER, which in turn leads to arbitrary command execution.\n\nFigure 1. Command injection exploit over the wire\nFollowing the leads acquired from the attack traffic, we have narrowed our scope to some\nIoT devices that are known to synchronize time through HTTP and found several vulnerable\nNTP-server-handling routines in firmware in some IoT devices, which is concerning since\nsome vendors no longer support the products running said firmware. Figure 2 shows one\nsuch vulnerable function found in a library module. While the firmware that we have analyzed\nhave such insecure functions, they are fortunately impervious to this specific attack because\nthe targeted uniform resource identifier (URI) is not present in these firmware. The\nidentification of the affected product is still in progress as we proceed to analyze other IoT\ndevices that are likely to do time synchronization through HTTP.\n\n\n-----\n\nFigure 2. Vulnerable code snippet in one of the firmware\nThe initial attack incident of the first exploit was observed on July 23, 2020, at 05:55:06 a.m.\nUTC. The attack (shown in Figure 1) lasted for a few weeks, with the last incident reported\non Sept. 23, 2020, at 15:21:23 p.m. UTC. There were 42 unique alerts at the time of this\nwriting.\n\nThe second exploit caught in the wild provides less context than the first exploit; the URL and\nthe HTTP request headers do not yield any useful insights. Evidently, there is a lack of\nparameter sanitization in the HTTP parameter pid that results in a command injection\nvulnerability, as shown in Figure 3. We speculate that the targeted service is some type of\nremote process management tool because of similar parameter patterns in the attack traffic,\nand that it’s possibly experimental and thus low in usage.\n\nFigure 3. Command injection exploit over the wire.\nA total of 48 unique attack incidents occurred in just 12 seconds. The attack started on Aug.\n16, 2020, at 09:04:39 a.m. UTC, and it ended on Aug. 16, 2020, at 09:04:51 a.m. UTC,\nindicating that this exploit is quick and short-lived.\n\nWe grouped the Mirai variants by numbers: one, two, three and four. The SHA256 for each\nof the Mirai variants are available in the Indicators of Compromise section below. Table 1\nshows the delivery method as well as the embedded decryption key for each variant.\n\n**Delivery Method** **Mirai Variant** **Decryption Key**\n\nExploit one Variant One 0xdeadbeef\n\nExploit one Variant Two 0xdedefbba\n\nExploit two Variant Three 0xdedefbaf\n\nExploit two Variant Four 0xdeadbeef\n\n_Table 1. Delivery methods and the decryption key._\n\nWhile these variants do not share the exact same origin and configuration, they all possess\nthe necessary functionality to launch DDoS attacks. Variant four also possesses an infection\ncapability that is not present in the other three variants, making it a more dangerous threat.\n\n\n-----\n\nTable 2 below summarizes the exploits that this particular Mirai variant uses for infecting\nother vulnerable hosts. Just like its predecessors, this variant inherits exploits that were also\nused in [the previous variants.](https://unit42.paloaltonetworks.com/unit42-finds-new-mirai-gafgyt-iotlinux-botnet-campaigns/)\n\n\nAndroid debug bridge\nshell\n\n\n[CVE-2019-14931](https://nvd.nist.gov/vuln/detail/CVE-2019-14931) [Fastweb Fastgate RCE](https://www.exploit-db.com/exploits/47654)\n\n\n[ASUS RT-AC66U RCE](https://www.ise.io/research/studies-and-papers/asus_rtn56u/) HomeMatic Zentrale CCU2\nRCE\n\n\n[EnGenius RCE](https://unit42.paloaltonetworks.com/unit42-multi-exploit-iotlinux-botnets-mirai-gafgyt-target-apache-struts-sonicwall/)\n\n\n[CVE-2013-2251](https://nvd.nist.gov/vuln/detail/CVE-2013-2251) [CVE-2015-1187](https://nvd.nist.gov/vuln/detail/CVE-2015-1187) [Netlink GPON Router RCE](https://www.exploit-db.com/exploits/48225)\n\n[ThinkPHP RCE](https://www.exploit-db.com/exploits/46150) [D-Link Router RCE](https://www.cloudcoffer.com/?p=577) [CVE-2020-5722](https://nvd.nist.gov/vuln/detail/CVE-2020-5722)\n\n[Vacron NVR RCE](https://unit42.paloaltonetworks.com/unit42-finds-new-mirai-gafgyt-iotlinux-botnet-campaigns/) [CVE-2019-16920](https://nvd.nist.gov/vuln/detail/CVE-2019-16920) [CVE-2019-10655](https://nvd.nist.gov/vuln/detail/CVE-2019-10655)\n\n[Netgear RCE](https://unit42.paloaltonetworks.com/unit42-finds-new-mirai-gafgyt-iotlinux-botnet-campaigns/) [CVE-2020-8515](https://nvd.nist.gov/vuln/detail/CVE-2020-8515) Unknown Exploit Two\n\n[CVE-2017-18377](https://nvd.nist.gov/vuln/detail/CVE-2017-18377) [Edimax EW-7438RPn RCE](https://www.exploit-db.com/exploits/48377) [CVE-2020-1956](https://nvd.nist.gov/vuln/detail/CVE-2020-1956)\n\n[CVE-2018-17173](https://nvd.nist.gov/vuln/detail/CVE-2018-17173) [CVE-2019-19356](https://nvd.nist.gov/vuln/detail/CVE-2019-19356) [3Com OfficeConnect RCE](https://www.exploit-db.com/exploits/9862)\n\n[CVE-2018–13023](https://blog.securityevaluators.com/show-mi-the-vulns-exploiting-command-injection-in-mi-router-3-55c6bcb48f09) [NUUO NVRmini RCE](https://www.exploit-db.com/exploits/45070) [CVE-2019-7276](https://nvd.nist.gov/vuln/detail/CVE-2019-7276)\n\n[CVE-2018-19276](https://nvd.nist.gov/vuln/detail/CVE-2018-19276) [Multiple IoT RCE](https://github.com/rapid7/metasploit-framework/issues/7076) [CVE-2011-3587](https://nvd.nist.gov/vuln/detail/CVE-2011-3587)\n\n[CVE-2016-6277](https://nvd.nist.gov/vuln/detail/CVE-2016-6277) [Sar2HTML RCE](https://www.nmmapper.com/st/exploitdetails/47204/41579/sar2html-321-remote-command-execution/) [CVE-2018-7841](https://nvd.nist.gov/vuln/detail/CVE-2018-7841)\n\n[CVE-2019-16057](https://nvd.nist.gov/vuln/detail/CVE-2019-16057) [CCTV-DVR RCE](https://www.exploit-db.com/exploits/39596)\n\n_Table 2. Variant four’s infection capability._\n\n## Conclusion\n\nSecurity for IoT devices is still concerning. One major challenge for IoT security is that IoT\ndevices that are no longer supported are still being deployed and used. Flaws in their\nfirmware unfortunately do not just go away with an end-of-life and end-of-support\nannouncement. The good news is that Palo Alto Networks offers the following products and\nservices to protect its customers from this kind of attacks, whether the threat is known or not:\n\n[Next-Generation Firewalls with Threat Prevention licenses can block the exploits and](https://www.paloaltonetworks.com/products/secure-the-network/subscriptions/threat-prevention)\nC2 traffic with best practice configuration.\n[For tracking and protection purposes, the relevant coverage threat IDs are 59194 and](https://threatvault.paloaltonetworks.com/)\n59083. Please update to the latest threat detection release.\n[WildFire can stop the malware with behavioral heuristics.](https://www.paloaltonetworks.com/products/secure-the-network/wildfire)\nAutoFocus customers can track this activity with the [Mirai tag.](https://autofocus.paloaltonetworks.com/#/tag/Unit42.Mirai)\nThe [IoT Security subscription for the Next-Generation Firewall helps discover and](https://www.paloaltonetworks.com/network-security/iot-security)\nidentify IoT devices on an organization’s network.\n\n\n-----\n\n## Indicators of Compromise\n\n**Mirai Variant One**\n\n1b45cf0e6663aa736a2296ff753d8261032b80effcf6b0c4da2f836c2df48f2b\n\n96f3b93b2b4560bbcfc0dbcbcc490d6914eb674d2f745197761ec73121b2f0d9\n\nbae705d860eb190edb7512bc4c9e240b79009ba15464134c0b09e01a4d9c7853\n\n05a5d6929031deed51f2c7ee8936d1e5b82db9126f746ed5e0be28a758675844\n\n7a1a49c077c0600cec0985456c8134196c7e6a09811576896eedd20c03fca9b9\n\n**Mirai Variant Two**\n\n3eadc091b2eafd3c6d6195f20a6755084fa35b72dba9255dbdd0421a5f89380d\n\n13a0c95b6c23a9da188533fa7bf9e438bf74096a97df8d187cecaf579f72478d\n\n94d2caf1b122583a9c3a17b24a0ed6efbc34491c79de231072989eaf938c3985\n\n99408a1a1c40a4db4cfde0f17a6791f16ca102c26ecda8f44501d03541d4b2b2\n\n**Mirai Variant Three**\n\n34fe9ec63e0861a40dd44468fd79d8fa97df0de2b3a70a42de3c26ebfdfea14c\n\n12a1a6f1368c60452e9b0732199521b3c786356bb2cb98289abe8b0c9772940e\n\nc7b846783d8704fa22ba06208066ef4cbde8cb48e07c24fea4cdefc9ba117b3c\n\n**Mirai Variant Four**\n\n6f2f274639439174687b6368b795a999896f20fea9b8c203e4e3af9eeba4d53a\n\n**Malware Hosting Site**\n\n80[.]82[.]78[.]85\n\n185[.]61[.]137[.]165\n\n78[.]142[.]18[.]20\n\n185[.]172[.]110[.]199\n\n**Mirai C2**\n\ndotheneedfull[.]xyz\n\n\n-----\n\nxyz[.]hxarasxg[.]xyz\n\nlol[.]thezone[.]vip\n\n**Get updates from**\n**Palo Alto**\n**Networks!**\n\nSign up to receive the latest news, cyber threat intelligence and research from us\n\n[By submitting this form, you agree to our Terms of Use and acknowledge our Privacy](https://www.paloaltonetworks.com/legal-notices/terms-of-use)\nStatement.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2020/2020-10-14 - Two New IoT Vulnerabilities Identified with Mirai Payloads.pdf"
    ],
    "report_names": [
        "2020-10-14 - Two New IoT Vulnerabilities Identified with Mirai Payloads.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673535860,
    "ts_updated_at": 1743041159,
    "ts_creation_date": 1653706021,
    "ts_modification_date": 1653706021,
    "files": {
        "pdf": "https://archive.orkl.eu/c79d979e8596b2402a07586d871210d852b6cfbc.pdf",
        "text": "https://archive.orkl.eu/c79d979e8596b2402a07586d871210d852b6cfbc.txt",
        "img": "https://archive.orkl.eu/c79d979e8596b2402a07586d871210d852b6cfbc.jpg"
    }
}