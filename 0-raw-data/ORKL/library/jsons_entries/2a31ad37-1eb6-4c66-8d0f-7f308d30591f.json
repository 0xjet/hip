{
    "id": "2a31ad37-1eb6-4c66-8d0f-7f308d30591f",
    "created_at": "2022-10-25T16:48:24.225975Z",
    "updated_at": "2025-03-27T02:16:34.874963Z",
    "deleted_at": null,
    "sha1_hash": "a16e7cba15ff41a224278d6cb7037e65d8cf6e8b",
    "title": "Observations from the StellarParticle Campaign",
    "authors": "crowdstrike",
    "file_creation_date": "2022-02-21T05:09:38Z",
    "file_modification_date": "2022-02-21T05:09:38Z",
    "file_size": 2831653,
    "plain_text": "# StellarParticle Campaign: Novel Tactics and Techniques\n\n**[crowdstrike.com/blog/observations-from-the-stellarparticle-campaign](https://www.crowdstrike.com/blog/observations-from-the-stellarparticle-campaign/)**\n\nCrowdStrike Services - CrowdStrike Intelligence January 27, 2022\n\nStellarParticle is a campaign tracked by CrowdStrike as related to the SUNSPOT implant\nfrom the SolarWinds intrusion in December 2020 and associated with COZY BEAR (aka\nAPT29, “The Dukes”).\nThe StellarParticle campaign has continued against multiple organizations, with COZY\nBEAR using novel tools and techniques to complete their objectives, as identified by\nCrowdStrike incident responders and the CrowdStrike Intelligence team.\nBrowser cookie theft and Microsoft Service Principal manipulation are two of the novel\ntechniques and tools leveraged in the StellarParticle campaign and are discussed in this\nblog.\nTwo sophisticated malware families were placed on victim systems in mid-2019: a Linux\nvariant of GoldMax and a new implant dubbed TrailBlazer.\n\nSupply chain compromises are an increasing threat that impacts a range of sectors, with threat\nactors leveraging access to support several motivations including financial gain (such as with\n[the Kaseya ransomware attack) and espionage. Throughout 2020, an operation attributed to](https://www.crowdstrike.com/cybersecurity-101/cyberattacks/cyber-espionage/)\nthe Foreign Intelligence Service of the Russian Federation (SVR) by the U.S. government was\nconducted to gain access to the update mechanism of the SolarWinds IT management software\n\n\n-----\n\nand use it to broaden their intelligence collection capabilities. This activity is tracked by\n[CrowdStrike as the StellarParticle campaign and is associated with the COZY BEAR adversary](https://adversary.crowdstrike.com/en-US/adversary/cozy-bear/)\ngroup.\n\nThis blog discusses the novel tactics and techniques leveraged in StellarParticle investigations\nconducted by CrowdStrike. These techniques include:\n\nCredential hopping for obscuring lateral movement\nOffice 365 (O365) Service Principal and Application hijacking, impersonation and\nmanipulation\nStealing browser cookies for bypassing multifactor authentication\nUse of the TrailBlazer implant and the Linux variant of GoldMax malware\nCredential theft using Get-ADReplAccount\n\n## Credential Hopping\n\nThe majority of StellarParticle-related investigations conducted by CrowdStrike have started\nwith the identification of adversary actions within a victim’s O365 environment. This has been\nadvantageous to CrowdStrike incident responders in that, through investigating victim O365\nenvironments, they could gain an accurate accounting of time, account and source IP address\nof adversary victimization of the O365 tenant. In multiple engagements, this led CrowdStrike\nincident responders to identify that the malicious authentications into victim O365 tenants\nhad originated from within the victim’s own network.\n\nArmed with this information, CrowdStrike investigators were able to identify from which\nsystems in these internal networks the threat actor was making authentications to O365. These\nauthentications would typically occur from servers in the environment, leading to natural\ninvestigative questions: Why would a user authenticate into O365 from a domain controller or\nother infrastructure server? What credentials were used as part of the session from which the\nO365 authentication occurred?\n\nThis led our responders to identify the occurrence of “credential hopping,” where the threat\nactor leveraged different credentials for each step while moving laterally through the victim’s\nnetwork. While this particular technique is not necessarily unique to the StellarParticle\ncampaign, it indicates a more advanced threat actor and may go unnoticed by a victim.\n\nBelow is an example of how a threat actor performs credential hopping:\n\nGain access to the victim’s network by logging into a public-facing system via Secure\nShell (SSH) using a local account <user sftp> acquired during previous credential theft\nactivities.\nUse port forwarding capabilities built into SSH on the public-facing system to establish a\nRemote Desktop Protocol (RDP) session to an internal server (Server 1) using a domain\nservice account.\n\n\n-----\n\nFrom Server 1, establish another RDP session to a different internal server (Server 2)\nusing a domain administrator’s account.\nLog in to O365 as a user with privileged access to cloud resources.\n\nFigure 1. Example of “credential hopping” technique\n\nThis technique could be hard to identify in environments where defenders have little visibility\ninto identity usage. In the example shown in Figure 1, the threat actor leveraged a service\ninteractively, which should generate detections for defenders to investigate. However, the\nthreat actor could have easily used a second domain administrator account or any other\ncombination of accounts that would not be easily detected. A solution such as CrowdStrike\nFalcon® Identity Threat Detection would help identify these anomalous logons — and\nespecially infrequent destinations for accounts. (Read how CrowdStrike incident responders\nleverage the module in investigations in this blog: Credentials, Authentications and Hygiene:\nSupercharging Incident Response with Falcon Identity Threat Detection.)\n\nBut how had the threat actor succeeded in authenticating into victim O365 tenants, when\nmultifactor authentication (MFA) had been enabled for every O365 user account at each victim\norganization investigated by CrowdStrike?\n\n## Cookie Theft to Bypass MFA\n\nEven though the victims required MFA to access cloud resources from all locations, including\non premises, the threat actor managed to bypass MFA through the theft of Chrome browser\ncookies. The threat actor accomplished this by using administrative accounts to connect via\nSMB to targeted users, and then copy their Chrome profile directories as well as data\nprotection API (DPAPI) data. In Windows, Chrome cookies and saved passwords are\nencrypted using DPAPI. The user-specific encryption keys for DPAPI are stored under\n```\nC:\\Users\\<user>\\AppData\\Roaming\\Microsoft\\Protect\\ . To leverage these encryption\n\n```\nkeys, the threat actor must first decrypt them, either by using the user account’s Windows\npassword, or, in Active Directory environments, by using a DPAPI domain backup key that is\nstored on domain controllers.\n\nOnce the threat actor had a Chrome cookies file from a user that had already passed an MFA\nchallenge recently (for example, a timeout was 24 hours), they decrypted the cookies file using\nthe user’s DPAPI key. The cookies were then added to a new session using a “Cookie Editor”\nChrome extension that the threat actor installed on victim systems and removed after using.\n\n## Shellbags, Falcon Telemetry and RDP Bitmap Cache\n\n\n-----\n\nFrom a forensic standpoint, the use of the Cookie Editor Chrome extension would have been\nchallenging to identify, due to the threat actor’s penchant for strict operational security. This\nactivity was identified via a `NewScriptWritten event within Falcon when a JavaScript file`\nwas written to disk by a threat actor-initiated Chrome process. This event captured the unique\nextension ID associated with the extension, thereby allowing CrowdStrike incident responders\nto validate via the Chrome Store that the JavaScript file was associated with the “Cookie\nEditor” plugin. This extension permitted bypassing MFA requirements, as the cookies,\nreplayed through the Cookie Editor extension, allowed the threat actor to hijack the already\nMFA-approved session of a targeted user.\n\nShellbags were also instrumental in identifying the cookie theft activity. This artifact very\nclearly showed the threat actor accessing targeted users’ machines in sequence and browsing\nto the Chrome and DPAPI directories one after another. Parsing Shellbags for an\nadministrative account leveraged by the threat actor resulted in entries similar to the below.\n\nFigure 2. Shellbag artifacts showing targeting of Chrome directories\n\nCrowdStrike identified forensic evidence that showed the entire attack path: browsing to a\ntarget user’s Chrome and DPAPI directories via administrative share, installing the Cookie\nEditor extension, and using Chrome to impersonate the targeted user in the victim’s cloud\ntenants. The decryption of the cookies is believed to have taken place offline after exfiltrating\nthe data via the clipboard in the threat actor’s RDP session.\n\nFigure 3 Representation of lateral movement to cookie theft to O365 authentication\n\n\n-----\n\nCrowdStrike identified a similar TTP where the threat actor connected via RDP to a user s\nworkstation with the workstation owner’s account (e.g., connecting via RDP to user1-pc using\nthe account user1). In cases where the user had only locked their screen and not signed out,\nthe threat actor was able to take over the user’s Windows session, as the RDP session would\nconnect to the existing session of the same user. By examining RDP Bitmap Cache files,\nCrowdStrike was able to demonstrate that the threat actor had opened Chrome and exported\nall of the user’s saved passwords as plaintext in a CSV file during these sessions.\n\nFigure 4. RDP Bitmap Cache reconstruction showing exportation of\n\nChrome passwords\n\nIn addition, the threat actor visited sensitive websites that the user had access to, which in one\ninstance allowed them to browse and download a victim’s customer list. After this, the threat\nactor navigated to the user’s Chrome history page and deleted the specific history items related\nto threat actor activity, leaving the rest of the user’s Chrome history intact.\n\n## O365 Delegated Administrator Abuse\n\nCrowdStrike also identified a connection between StellarParticle-related campaigns and the\nabuse of Microsoft Cloud Solution Partners’ O365 tenants. This threat actor abused access to\naccounts in the Cloud Solution Partner’s environment with legitimate delegated administrative\nprivileges to then gain access to several customers’ O365 environments.\n\nBy analyzing Azure AD sign-ins, CrowdStrike was able to use known indicators of compromise\n(IOCs) to identify several threat actor logins to customer environments. These cross-tenant\nsign-ins were identified by looking for values in the `resourceTenantId attribute that did not`\nmatch the Cloud Solution Partner’s own Azure tenant ID.\n\nCrowdStrike also identified a limitation within Microsoft’s Delegated Administration\ncapabilities for Microsoft Cloud Solution Partners. While a normal O365 administrator can be\nprovided dozens of specific administrative roles to limit the privileges granted, this same\n\n\n-----\n\ndegree of customization cannot be applied to Microsoft Cloud Solution Partners that use the\ndelegated administrator functionality in O365.\n\nFor Microsoft Cloud Solution Partners, there are only two substantial administrative options\ntoday when managing a customer’s environment, `Admin agent or` `Helpdesk agent . The2`\n\n```\nHelpdesk agent role provides very limited access that is equivalent to a password admin\n\n```\nrole, whereas the `Admin agent role provides broad access more equivalent to global`\nadministrator. This limitation is scheduled to be resolved in 2022 via Microsoft’s scheduled\nfeature, Granular Delegated Admin Privileges (GDAP).3\n\n## User Access Logging (UAL)\n\nThe Windows User Access Logging (UAL) database is an extremely powerful artifact that has\nplayed an instrumental role in the investigation of StellarParticle-linked cases. In particular,\nUAL has helped our responders identify earlier malicious account usage that ultimately led to\nthe identification of the aforementioned TrailBlazer implant and Linux version of the GoldMax\nvariant.\n\nThe UAL database is available by default on Server editions of Windows starting with Server\n2012. This database stores historical information on user access to various services (or in\nWindows parlance, Roles) on the server for up to three years (three years minus one day) by\ndefault. UAL contains information on the type of service accessed, the user that accessed the\nservice and the source IP address from which the access occurred. One of the most useful roles\nrecorded by UAL is the File Server role, which includes SMB access, though other role types\ncan also be very helpful. An overview of UAL, what information it contains and how it can be\n[leveraged in forensic investigations can be found here.](https://www.crowdstrike.com/blog/user-access-logging-ual-overview/)\n\nIn multiple StellarParticle-related cases, because the threat actor used the same set of accounts\nduring their operations in the environment, CrowdStrike was able to identify previous\nmalicious activity going back multiple years, based solely on UAL data. Even though it’s only\navailable on Server 2012 and up, UAL can still be used to trace evidence of threat actor activity\non legacy systems as long as the activity on the legacy system involves some (deliberate or\nunintentional) access to a 2012+ system. For example, in addition to tracking SMB activity,\nUAL databases on Domain Controllers track Active Directory access.\n\nThis allowed CrowdStrike to demonstrate that a given user account was also authenticating to\nActive Directory from a given source IP address two years prior. Because the user account was\nknown to have recently been abused by the threat actor, and the source IP of the system in\nquestion was not one that account would typically be active on, the investigation led to the\nsource system and ultimately resulted in the timeline of malicious activity being pushed back\nby years, with additional compromised systems even being discovered still running unique\nmalware from that time period.\n\n## TrailBlazer and GoldMax\n\n\n-----\n\nThroughout StellarParticle-related investigations, CrowdStrike has identified two\nsophisticated malware families that were placed on victim systems in the mid-2019 timeframe:\na Linux variant of GoldMax and a completely new family CrowdStrike refers to as TrailBlazer.\n\n### TrailBlazer\n\nAttempted to blend in with a file name that matched the system name it resided on\nConfigured for WMI persistence (generally uncommon in 2019)\nUsed likely compromised infrastructure for C2\nMasquerades its command-and-control (C2) traffic as legitimate Google Notifications\nHTTP requests\n\n_TrailBlazer is a sophisticated malware family that provides modular functionality and a very_\nlow prevalence. The malware shares high-level functionality with other malware families. In\nparticular, the use of random identifier strings for C2 operations and result codes, and\nattempts to hide C2 communications in seemingly legitimate web traffic, were previously\nobserved tactics, techniques and procedures (TTPs) in GoldMax and SUNBURST. TrailBlazer\npersists on a compromised host using WMI event subscriptions — a technique also used by4\n[SeaDuke — although this persistence mechanism is not exclusive to COZY BEAR.5](https://attack.mitre.org/software/S0053/)\n\n```\nWMI event filter SELECT * FROM __InstanceModificationEvent WITHIN 60\n              WHERE TargetInstance ISA\n              'Win32_PerfFormattedData_PerfOS_System' AND\n              TargetInstance.SystemUpTime >= 180 AND\n              TargetInstance.SystemUpTime < 480\n\n```\n```\nWMI Event consumer\n(CommandLineTemplate)\n\n```\n```\nC:\\Program Files (x86)\\Common Files\\Adobe\\\n<FILENAME>.exe\n\n```\n\nTable 1. TrailBlazer WMI Persistence\n\nIn the obfuscated example above, TrailBlazer ( <FILENAME> `.exe ) would be executed when`\nthe system’s uptime was between 180 and 480 seconds.\n\n### GoldMax (Linux variant)\n\nAttempted to blend in with a file name that matched the system name it resided on\nConfigured for persistence via a crontab entry with a `@reboot line`\nUsed likely compromised infrastructure for C2\n\n_GoldMax was first observed during post-exploitation activity in the campaign leveraging the_\nSolarWinds supply chain attacks. Previously identified samples of GoldMax were built for the\nWindows platform, with the earliest identified timestamp indicating a compilation in May\n2020, but a recent CrowdStrike investigation discovered a GoldMax variant built for the Linux\n\n\n-----\n\nplatform that the threat actor deployed in mid-2019. This variant extends the backdoor s\n**known history and shows that the threat actor has used the malware in post-**\n**exploitation activity targeting other platforms than Windows.**\n\nThe 2019 Linux variant of the GoldMax backdoor is almost identical in functionality and\nimplementation to the previously identified May 2020 Windows variant. The very few\nadditions to the backdoor between 2019 and 2020 likely reflect its maturity and longstanding\nevasion of detections. It is likely GoldMax has been used as a long-term persistence backdoor\nduring StellarParticle-related compromises, which would be consistent with the few changes\nmade to the malware to modify existing functions or support additional functionality.\n\nPersistence was established via a crontab entry for a non-root user. With the binary named to\nmasquerade as a legitimate file on the system and placed in a hidden directory, a crontab entry\nwas created with a `@reboot line so the GoldMax binary would execute again upon system`\nreboot. Additionally, the threat actor used the `nohup command to ignore any hangup signals,`\nand the process will continue to run even if the terminal session was terminated.\n\nFigure 5. Crontab entry for GoldMax persistence\n\n## Enumeration Tools/Unique Directory Structure\n\nThroughout our StellarParticle investigations, CrowdStrike identified what appeared to be a\nVBScript-based Active Directory enumeration toolkit. While the script’s contents have not\nbeen recovered to date, CrowdStrike has observed identical artifacts across multiple\nStellarParticle engagements that suggest the same or similar tool was used.\n\nIn each instance the tool was used, Shellbags data indicated that directories with random\nnames of a consistent length were navigated to by the same user that ran the tool. After two\nlevels of randomly named directories, Shellbags proved the existence of subdirectories named\nafter the FQDNs for the victims’ various domains. In addition, the randomly named directories\nare typically created in a previously existing directory that’s one level off of the root of the C\ndrive. The randomly named directories have a consistent length where the first directory is six\ncharacters and the next directory is three characters. To date, the names of the directories have\nalways been formed from lowercase alphanumeric characters. For example, Shellbags\nindicated that directories matching the naming patterns below were browsed to (where “XX” is\na previously existing directory on the system):\n\n\n-----\n\nIn each case, immediately prior to the creation of the directories referenced above, there was\nevidence of execution of a VBScript file by the same user that browsed to the directories. This\nevidence typically came from a UserAssist entry for wscript.exe, as well as RecentApps entries\nfor wscript.exe (that would also include the VBScript filename). In addition, the Jump List for\nwscript.exe contained evidence of the VBScript files. The name of the VBScript files varied\nacross engagements and was generally designed to look fairly innocuous and blend in. Two\nexamples are `env.vbs and` `WinNet.vbs . Due to the subdirectories that are named after the`\nFQDNs for victim domains, CrowdStrike assesses with moderate confidence that the scripts\nrepresent an AD enumeration tool used by the adversary.\n\n## Internal Wiki Access\n\nAcross multiple StellarParticle investigations, CrowdStrike identified unique reconnaissance\nactivities performed by the threat actor: access of victims’ internal knowledge repositories.6\nWikis are commonly used across industries to facilitate knowledge sharing and as a source of\nreference for a variety of topics. While operating in the victim’s internal network, the threat\nactor accessed sensitive information specific to the products and services that the victim\norganization provided. This information included items such as product/service architecture\nand design documents, vulnerabilities and step-by-step instructions to perform various tasks.\nAdditionally, the threat actor viewed pages related to internal business operations such as\ndevelopment schedules and points of contact. In some instances these points of contact were\nsubsequently targeted for further data collection.\n\nThe threat actor’s wiki access could be considered an extension of “Credential Hopping”\ndescribed earlier. The threat actor established RDP sessions to internal servers using\nprivileged accounts and then accessed the wiki using a different set of credentials. CrowdStrike\nobserved the threat actor accessing the wiki as users who would be considered “nonprivileged” from an Active Directory perspective but had access to sensitive data specific to the\nvictim’s products or services.\n\nAt this time, the malicious access of internal wikis is an information gathering technique that\nCrowdStrike has only observed in StellarParticle investigations. CrowdStrike was able to\nidentify the wiki access primarily through forensic analysis of the internal systems used by the\nthreat actor. Given the threat actor’s penchant for clearing browser data, organizations should\nnot rely upon the availability of these artifacts for future investigations. CrowdStrike\nrecommends the following best practices for internal information repositories:\n\nEnable detailed access logging\nEnsure logs are centralized and stored for at least 180 days\nCreate detections for anomalous activity such as access from an unusual location like a\nserver subnet\nEnable MFA on the repository site, or provide access via Single Sign On (SSO) behind\nMFA\n\n\n-----\n\n## O365 Built-in Service Principal Hijacking\n\nThe threat actor connected via Remote Desktop from a Domain Controller to a vCenter server\nand opened a PowerShell console, then used the PowerShell command `-ep bypass to`\ncircumvent the execution policy. Using the Windows Azure Active Directory PowerShell\nModule, the threat actor connected to the victim’s O365 tenant and began performing\nenumeration queries. These queries were recorded in text-based logs that existed under the\npath\n```\nC:\\Users\\<user>\\AppData\\Local\\Microsoft\\Office365\\Powershell\\ .\n\n```\nSimilar logs (for Azure AD instead of O365) can be found under the path:\n```\nC:\\Users\\<user>\\AppData\\Local\\Microsoft\\AzureAD\\Powershell\\ .\n\n```\nWhile the logs didn’t include what data was returned by the queries, they did provide some\ninsight such as the user account used to connect to the victim’s O365 tenant (which was not\nthe same as the user the threat actor used to RDP to the vCenter server). The logs contained\ncommands issued and the count of the results returned for a specific command. The\ncommands included enumeration queries such as:\n```\n   ListAccountSkus\n   ListPartnerContracts\n   ListServicePrincipals\n   ListServicePrincipalCredentials\n   ListRoles\n   ListRoleMembers\n   ListUsers\n   ListDomains\n   GetRoleMember\n   GetPartnerInformation\n   GetCompanyInformation\n\n```\nIn this case, however, the most significant and concerning log entry was one that indicated the\ncommand `AddServicePrincipalCredentials was executed. By taking the timestamp that`\nthe command was executed via the PowerShell logs on the local system, CrowdStrike analyzed\nthe configuration settings in the victim’s O365 tenant and discovered that a new secret had\nbeen added to a built-in Microsoft Azure AD Enterprise Application, `Microsoft StaffHub`\nService Principal, which had `Application level permissions. Further, the newly added`\nsecret was set to remain valid for more than a decade. This data was acquired by exporting the\nsecrets and certificates details for each Azure AD Enterprise Application.\n\nThe Service Principal (now renamed to `Microsoft Teams Shifts ) had the following`\npermissions at the time the configuration settings were collected:\n\n\n-----\n\n```\nMember.Read\n\n```\n\nCrowdStrike was unable to find Microsoft documentation, but based on open-source research,\nthis application likely had the following permissions around the time of registration:\n```\n   Mail.Read\n   Group.Read.All\n   Files.Read.All\n   Group.ReadWrite.All\n\n```\nThe most notable permissions above are the `Mail.Read,` `Files.Read and`\n```\nMember.ReadWrite  permissions. These permissions would allow the threat actor to use the\n\n```\n\n7\n\n```\nMicrosoft Staffhub service principal to read all mail and SharePoint/OneDrive files in the\n\n```\norganization, as well as create new accounts and assign administrator privileges to any account\nin the organization.\n\nBy running the commands from within the victim’s environment, MFA requirements were\nbypassed due to conditional access policies not covering Service Principal sign-ins at this point\nof time. However, as explained earlier, the threat actor managed to continue to access the8\nvictim’s cloud environment even when the victim enforced MFA for all connections regardless\nof source.\n\nWhile the bulk of the evidence for this activity came from the text-based O365 PowerShell logs,\nthe `NTUSER.DAT registry hive for the user that was running the PowerShell cmdlets also`\nincluded information on the accounts that were used to authenticate to the cloud. This\ninformation was stored under the registry path. Below is an example of the registry data:\n\n\n-----\n\nFigure 6. Example registry entry showing target O365 email accounts\n\nThe same WSMan connection string was also located in the user’s NTUSER.DAT registry hive\nunder the path:\n\nFigure 7. WSMan connection string registry location\n\nWhile not strictly related to the O365 PowerShell activity, the Windows Event Log\n```\nMicrosoft-Windows-WinRM%4Operational.evtx also included information on connection\n\n```\nattempts made to external O365 tenants. This information was logged under Event ID 6.\nBelow is an example of what the event included:\n\nFigure 8. Windows Event Log entry showing connection to O365 tenants\n\n## O365 Company Service Principal Manipulation\n\nThe threat actor also deployed several layers of persistence utilizing both pre-existing and\nthreat actor-created Service Principals with the ultimate goal of gaining global access to email.\n\n### Attacker-created Service Principal\n\nFirst, the threat actor used a compromised O365 administrator account to create a new Service\nPrincipal with a generic name. This Service Principal was granted `company administrator`\nprivileges. From there, the threat actor added a credential to this Service Principal so that they\ncould access the Service Principal directly, without use of an O365 user account.\n\nThese actions were recorded in Unified Audit Logs with the following three operation names:\n```\n   Add service principal\n   Add member to role\n   Add service principal credentials.\n   Update Service Principal\n\n### Company-Created Service Principal Hijacking\n\n```\nNext, the threat actor utilized the threat actor-created Service Principal to take control of a\nsecond Service Principal. This was done by adding credentials to this second Service Principal,\nwhich was legitimately created by the company. This now compromised company-created\nService Principal had `mail.read graph permissions consented on behalf of all users within`\nthe tenant.\n\n\n-----\n\nThis action was recorded by just one operation type in Unified Audit Logs. This operation type\nis named `Add service principal credentials .`\n\n### Mail.Read Service Principal Abuse\n\nFinally, the threat actor utilized the compromised Service Principal with the assigned\n```\nmail.read permissions to then read emails of several different users in the company’s\n\n```\nenvironment.\n\nCrowdStrike was able to use the Unified Audit Logs’ (UAL) `MailItemsAccessed operation`\nevents to see the exact emails the threat actor viewed, as the majority of the users in the tenant\nwere assigned O365 E5 licenses. When performing analysis on the UAL, CrowdStrike used the\n```\nClientAppId value within the MailItemsAccessed operation and cross-correlated with\n\n```\nthe Application ID of the compromised service principal to see what activities were performed\nby the threat actor.\n\n## O365 Application Impersonation\n\nAnother consistent TTP identified during StellarParticle investigations has been the abuse of\nthe `ApplicationImpersonation role. When this role was assigned to a particular user that9`\nwas controlled by the threat actor, it allowed the threat actor to impersonate any user within\nthe O365 environment. These impersonated events are not logged verbosely by the Unified\nAudit Logs and can be difficult to detect.\n\nWhile the assignment of these `ApplicationImpersonation roles were not logged in the`\nUnified Audit Logs, CrowdStrike was able to identify this persistence mechanism via the\nmanagement role configuration settings, which can be exported with the Exchange PowerShell\ncommand:\n```\nGet-ManagementRoleAssignment -Role ApplicationImpersonation .\n\n```\nCrowdStrike then analyzed the exported configuration settings and identified several users\n(not service accounts) that the threat actor likely gave direct `ApplicationImpersonation`\nroles during the known periods of compromise.\n\n## Remote Tasklist\n\nThe threat actor attempted to remotely list running processes on systems using\n```\ntasklist.exe . As tasklist uses WMI “under the hood,” this activity was captured by Falcon\n\n```\nas `SuspiciousWmiQuery events that included the query and the source system. Additionally,`\nthe failed (not successful) process listing resulted in a DCOM error that was logged in the\nSystem.evtx event log under Event ID 10028. A sample of the information included with this\nevent is below:\n\n\n-----\n\nFigure 9. Event ID 10028 showing failed execution of remote tasklist\n\nThis remote process listing was consistently used by the threat actor targeting the same or\nsimilar lists of remote systems, and the owners of the targeted systems also happened to be the\nindividuals with cloud access that the threat actor was interested in. While unproven, it’s\npossible the threat actor was running `tasklist remotely on these systems specifically to see`\nwhich of the target systems was running Google Chrome. This is because a current or recent\nChrome session to the victim’s cloud tenants would be potentially beneficial in the hijacking of\nsessions that the threat actor performed in order to access the victim’s cloud resources.\n\n## FTP Scanning/Identity Knowledge\n\nIn one instance, after being evicted from a victim environment, the threat actor began probing\nexternal services as a means to regain access, initially focusing on (S)FTP servers that were\ninternet-accessible. Logs on the servers indicated that the threat actor attempted to log in with\nmultiple valid accounts and in several cases was successful. There was little to no activity\nduring the (S)FTP sessions. This likely was an exercise in attempting to identify misconfigured\n(S)FTP accounts that also had shell access, similar to what’s described in the Credential\nHopping section earlier. Some of the accounts used were not in the victim’s Active Directory,\nas these were accounts for customers of the victim and stored in a separate LDAP database.\nHowever, the threat actor had knowledge of these accounts and used them on the correct\nsystems, which further confirmed that the threat actor had advanced knowledge of the victim’s\nenvironment.\n\nAfter confirming the FTP accounts did not provide shell access into the environment, the\nthreat actor began attempting to connect into the environment via VPN. The threat actor\nattempted to log in to the VPN using several user accounts but was prevented from connecting,\neither due to not having the correct password, or due to having the correct password but not\ngetting past the recently implemented MFA requirement. Eventually, the threat actor\nattempted an account that they had the correct password for but that had not been set up with\nMFA. This resulted in a prompt being displayed to the threat actor that included an MFA setup\nlink. The threat actor subsequently set up MFA for the account and successfully connected to\nthe victim’s network via VPN.\n\n## TA Masquerading of System Names\n\nDuring the attempted and successful VPN authentications described above, the threat actor\nensured the hostname of their system matched the naming convention of hostnames in the\nvictim’s environment. This again showed a strong knowledge of the victim’s internal\nenvironment on the part of the threat actor. Not only did the masqueraded hostnames follow\nthe correct naming convention from a broad perspective, they were also valid in terms of what\n\n\n-----\n\nwould be expected for the user account the threat actor leveraged (i.e., in terms of the site\nname and asset type indicated in the hostname). This masqueraded hostname technique has\nbeen observed at multiple StellarParticle-related investigations.\n\n## Credential Theft Using Get-ADReplAccount\n\nIn one example, the threat actor connected into the victim’s environment via a VPN endpoint\nthat did not have MFA enabled. Once connected to the VPN, the threat actor connected via\nRemote Desktop to a Domain Controller and copied the DSInternals PowerShell module to10\nthe system. The threat actor subsequently ran the DSInternals command `Get-`\n\n```\nADReplAccount targeting two of the victim’s domains. This command uses the Microsoft\n\n```\nDirectory Replication Service (MS-DRSR) protocol and specifically the\nIDL_DRSGetNCChanges method to return account information from Active Directory such as\nthe current NTLM password hashes and previous password hashes used for enforcing\npassword reuse restrictions. A common name for this particular technique is DCSync.11\n\nAn example output from Get-AdReplAccount is below:\n\n\n-----\n\n```\nDistinguishedName: CN TestUser,OU Admins,OU Users,DC demo,DC local\nSid: S-1-5-21-1432446722-301123485-1266542393-2012\nGuid: 12321930-7c05-4011-8a3e-e0b9b6e04567\nSamAccountName: TestUser\nSamAccountType: User\nUserPrincipalName: TestUser@demo.local\nPrimaryGroupId: 513\nSidHistory: \nEnabled: True\nUserAccountControl: NormalAccount\nAdminCount: True\nDeleted: False\nLastLogonDate: 12/2/2021 1:41:46 PM\nDisplayName: TestUser\nGivenName: Test\nSurname: User\nDescription: Admin Account\nServicePrincipalName: \nSecurityDescriptor: DiscretionaryAclPresent, SystemAclPresent,\nDiscretionaryAclAutoInherited, SystemAclAutoInherited, DiscretionaryAclProtected,\nSelfRelative\nOwner: S-1-5-21-1432446722-301123485-1266542393-512\nSecrets\n NTHash: 84a058676bb6d7de4237e18f09b91156\n LMHash: \n NTHashHistory: \n  Hash 01: 84a058676bb6d7de4237e18f09b91156\n  Hash 02: e047ebb3b7c463928c928fca95ac0ac8\n  Hash 03: 6dc3cdb3e559ef00d3521351ace7477e\n  Hash 04: a88355849f35fe7336de23a4ca3e6a9e\n  Hash 05: de9bde95677672295349aa6e1e857704\n LMHashHistory: \n  Hash 01: 12227358dd7013c7dbdbd8fdcc0c6668\n  Hash 02: 6a028636a6f52491424586bb88357f7c\n  Hash 03: c13ef7347853dc3be7e7259fdc8818a1\n  Hash 04: 6635151746869ce485246037747adae1\n  Hash 05: 85543f498b007e07a3da662c8a9d450b\n SupplementalCredentials:\n  ClearText: \n  NTLMStrongHash: de164e3465f163e846a5e1c22a5ac649\n  Kerberos:\n   Credentials:\n    DES_CBC_MD5\n     Key: 0013364f00003915\n    DES_CBC_CRC\n     Key: 0013364f00003915\n   OldCredentials:\n    DES_CBC_MD5\n     Key: 00002a46000004bc\n    DES_CBC_CRC\n     Key: 00002a46000004bc\n   Salt: demo.localTestUser\n   Flags: 0\n  KerberosNew:\n   Credentials:\n     AES256 CTS HMAC SHA1 96\n\n```\n\n-----\n\n```\n     Key: afd4d60e8d0920bc2f94d551f62f0ea2a17523bf2ff8ffb0fdade2a90389282f\n     Iterations: 4096\n    AES128_CTS_HMAC_SHA1_96\n     Key: f67c2bcbfcfa30fccb36f72dca22a817\n     Iterations: 4096\n    DES_CBC_MD5\n     Key: 00002f34000004ee\n     Iterations: 4096\n    DES_CBC_CRC\n     Key: 00002f34000004ee\n     Iterations: 4096\n   OldCredentials:\n    AES256_CTS_HMAC_SHA1_96\n     Key: b430783ab4c957cf6a03d3d348af27264c0d872932650ffca712d9ebcf778b9f\n     Iterations: 4096\n    AES128_CTS_HMAC_SHA1_96\n     Key: dc34bfd5e469edbeada77fac56aa35ae\n     Iterations: 4096\n    DES_CBC_MD5\n     Key: 0000345400000520\n     Iterations: 4096\n    DES_CBC_CRC\n     Key: 0000345400000520\n     Iterations: 4096\n   OlderCredentials:\n    AES256_CTS_HMAC_SHA1_96\n     Key: 26efd3593712e555f8366bb4b8aff097d09acd93c3a1b6d4ea03c578aad9e087\n     Iterations: 4096\n    AES128_CTS_HMAC_SHA1_96\n     Key: c38dfbd6c00b5f3b010a07f9e824fc38\n     Iterations: 4096\n    DES_CBC_MD5\n     Key: 000039a500000551\n     Iterations: 4096\n    DES_CBC_CRC\n     Key: 000039a500000551\n     Iterations: 4096\n   ServiceCredentials:\n   Salt: demo.localTestUser\n   DefaultIterationCount: 4096\n   Flags: 0\n  WDigest:\n   Hash 01: 83ed141ab0eaf1ff7694147ba97e1994\n   Hash 02: e73a8c05d4a7df53774bfa7ef8f0f574\n   Hash 03: 0c228c5816a79e561d999d489499a12a\n   Hash 04: 83ed141ab0eaf1ff7694147ba97e1994\n   Hash 05: e73a8c05d4a7df53774bfa7ef8f0f574\n   Hash 06: 4e7c5ec6ffb6100f0c7f0bc57749bc93\n   Hash 07: 83ed141ab0eaf1ff7694147ba97e1994\n   Hash 08: 10265b08a3bb710da516832eaf64368a\n   Hash 09: 10265b08a3bb710da516832eaf64368a\nKey Credentials:\nCredential Roaming\n Created: \n Modified: \n Credentials:\n\n```\n\n-----\n\nFigure 10. Get-ADReplAccount example output\n\nWhen executing the `Get-ADReplAccount command, the threat actor specified the AD`\ncontext to be targeted via the NamingContext parameter. This was necessary, as the threat\nactor was targeting multiple domains. The resulting output of each command was redirected\nto a text file and compressed as zip archives before exfiltration.\n\nThe fact that `Get-ADReplAccount command includes not only the current NTLM hashes but`\nalso the hash history (i.e., hashes of previous passwords used by a user account) meant that\nthe threat actor also had the ability to discover accounts that either reused the same passwords\nor used similar passwords when the account password was changed.\n\n## Credential Refresh\n\nOn some investigations, the dwell time of the threat actor spanned years. Given this extended\nperiod, it is logical to assume that some credentials obtained by the threat actor would be\nrotated during normal business operations. To combat this, the threat actor periodically\n“refreshed” their credential set by performing credential theft activities in an already\ncompromised environment. At one victim, CrowdStrike identified multiple instances of\ndomain credential theft months apart, each time with a different credential theft technique.\n\nOne of the credential theft techniques identified by CrowdStrike was the use of a PowerShell\nscript to execute Mimikatz in-memory. While in-memory Mimikatz is not particularly unique,\nthe script executed by the threat actor was heavily obfuscated and encrypted the output using\nAES256. CrowdStrike was able to reconstruct the PowerShell script from the PowerShell\nOperational event log as the script’s execution was logged automatically due to the use of\nspecific keywords. CrowdStrike recommends that organizations upgrade PowerShell on their\nsystems, as this functionality is only available with PowerShell version 5 and above.\n\nIn addition to refreshing the threat actor’s credentials, the threat actor would also refresh their\nunderstanding of the victim’s AD environment. Around the time when the threat actor\nexecuted `Get-ADReplAccount, the threat actor also executed a renamed version of AdFind to`\noutput domain reconnaissance information. In this instance, AdFind was renamed to\nmasquerade as a legitimate Windows binary. The usage of renamed AdFind is consistent with\nother industry reporting on this campaign.\n\nIn addition to using scripted commands, operators were repeatedly observed manually\nexecuting several standard PowerShell cmdlets to enumerate network information from AD,\nincluding `Get-ADUser and` `Get-ADGroupMember to query specific members in the`\ndirectory. This information provided the adversary with a list of accounts possessing particular\nprivileges — in this case, the ability to make VPN connections — that would be subject to later\ncredential stealing attempts and leveraged to access the victim at a later time.\n\n## Password Policies/Hygiene\n\n\n-----\n\nIn some cases, the threat actor was able to quickly return to the environment and essentially\npick up where they left off, even though the organization had performed an enterprise-wide\npassword reset, including a reset of all service accounts and the double-reset of the krbtgt\naccount. CrowdStrike determined that in these cases, administrative users had “reset” their\nown password to the same password they previously used, essentially nullifying the impact of\nthe enterprise-wide reset. This was possible even though the customer’s Active Directory was\nconfigured to require new passwords to be different from the previous five passwords for a\ngiven account. Unfortunately, this check only applies when a user is changing their password\nvia the “password change” method — but if a “password reset” is performed (changing the\npassword without knowing the previous password), this check is bypassed for an\nadministrative user or a Windows account that has the Reset Password permission on a user’s\naccount object. Since the 12 `Get-ADReplAccount cmdlet described above included the`\nNTHashHistory values (i.e., previous password hashes) for user accounts, CrowdStrike was\nable to verify that some administrative accounts indeed had the exact same password hash\nshowing up multiple times in the password history, as well as in the current NTHash value.\n\n## Close Out\n\nThe StellarParticle campaign, associated with the COZY BEAR adversary group, demonstrates\nthis threat actor’s extensive knowledge of Windows and Linux operating systems, Microsoft\nAzure, O365, and Active Directory, and their patience and covert skill set to stay undetected\nfor months — and in some cases, years.\n\nA special thank you to the CrowdStrike Incident Response and CrowdStrike Intelligence teams\nfor helping make this blog possible, especially Ryan McCombs, Ian Barton, Patrick Bennet,\nAlex Parsons, Christopher Romano, Jackson Roussin and Tom Goldsmith.\n\n## Endnotes\n\n MITRE ATT&CK Framework\n\n[The following table maps TTPs covered in this article to the MITRE ATT&CK® framework.](https://www.crowdstrike.com/cybersecurity-101/mitre-attack-framework/)\n\n**Tactic** **Technique** **Observable**\n\n\nCredential\nAccess\n\nCredential\nAccess\n\n\n**T1003.006 OS**\nCredential\nDumping:\nDCSync\n\n**T1003.001: OS**\nCredential\n[Dumping:](https://attack.mitre.org/techniques/T1003/001/)\nLSASS\nMemory\n\n\nThe threat actor obtained Active Directory credentials\nthrough domain replication protocols using the GetADReplAccount command from DSInternals\n\nThe threat actor used a heavily obfuscated PowerShell\nscript to execute the Mimikatz commands\n‘privilege::debug sekurlsa::logonpasswords\n“lsadump::lsa /patch”‘ in-memory and encrypt the\noutput\n\n\n-----\n\nInitial Access /\nPersistence\n\nInitial Access /\nPersistence\n\nCredential\nAccess\n\nCredential\nAccess\n\nLateral\nMovement\n\nInitial Access,\nPersistence\n\n\n**T1078.003:**\n[Valid Accounts:](https://attack.mitre.org/techniques/T1078/003/)\nLocal Accounts\n\n**T1133:**\nExternal\nRemote\nServices\n\n**T1555.003:**\nCredentials\nfrom Password\nStores:\nCredentials\nfrom Web\nBrowsers\n\n**T1539: Steal**\n[Web Session](https://attack.mitre.org/techniques/T1539/)\nCookie\n\n**T1021.001:**\nRemote\nServices:\nRemote\nDesktop\nProtocol\n\n**T1078.004:**\nValid Accounts:\nCloud\nAccounts\n\n\nA local account was used by the Threat Actor to\nestablish a SSH tunnel into the internal network\nenvironment\n\nThe threat actor used VPNs to gain access to systems\nand persist in the environment\n\nThe threat actor exported saved passwords from\nuser’s Chrome browser installations\n\nThe threat actor stole web session cookies from end\nuser workstations and used them to access cloud\nresources\n\nThe threat actor used both privileged and nonprivileged accounts for RDP throughout the\nenvironment, depending on the target system\n\nThe threat actor used accounts with Delegated\nAdministrator rights to access other O365 tenants. The\nThreat actor also used valid accounts to create\npersistence within the environment.\n\nTrailBlazer was configured to execute after a reboot\nvia a command-line event consumer\n\nThe threat actor renamed their utilities to masquerade\nas legitimate system binaries (AdFind as svchost.exe),\nmatch the system’s role (GoldMax), or appear\nlegitimate (TrailBlazer as an apparent Adobe utility).\nAdditionally, the threat actor renamed their systems\nprior to connecting to victim’s VPNs to match the\nvictim’s system naming convention\n\n\nPersistence **T1546.003:**\nEvent\nTriggered\nExecution:\n[Windows](https://attack.mitre.org/techniques/T1546/003/)\nManagement\nInstrumentation\nEvent\nSubscription\n\n\nDefense\nEvasion\n\n\n**T1036.005:**\nMasquerading:\nMatch\nLegitimate\nName or\nLocation\n\n\n-----\n\nDiscovery **T1087.002:**\nAccount\n[Discovery:](https://attack.mitre.org/techniques/T1087/002/)\nDomain\nAccount\n**T1482: Domain**\nTrust Discovery\n\n**T1069.002:**\nPermission\nGroups\nDiscovery:\nDomain\nGroups\n\n\nDefense\nEvasion /\nLateral\nMovement\n\n\n**T1550.001:**\nUse Alternate\nAuthentication\nMaterial:\nApplication\nAccess Token\n\n\nCollection **T1213.: Data**\nfrom\nInformation\nRepositories:\n\nPersistence **T1098.001:**\nAccount\nManipulation:\nAdditional\nCloud\nCredentials\n\nPersistence **T1078.004:**\nValid Accounts:\nCloud\nAccounts\n\nDiscovery **T1057:**\n[Process](https://attack.mitre.org/techniques/T1057/)\nDiscovery\n\nReconnaissance **T1595.001:**\nActive\n[Scanning:](https://attack.mitre.org/techniques/T1595/001/)\nScanning IP\nBlocks\n\n\nThe threat actor used AdFind, standard PowerShell\ncmdlets, and custom tooling to identify various pieces\nof information from Active Directory\n\nThe threat actor used compromised service principals\nto make changes to the Office 365 environment.\n\nThe threat actor accessed data from Information\nRepositories\n\nThe threat actor added credentials to O365 Service\nPrincipals\n\nThe threat actor created new O365 Service Principals\nto maintain access to victim’s environments\n\nThe threat actor regularly interrogated other systems\nusing tasklist.exe\n\nThe threat actor probed external services in an attempt\nto regain access to the environment\n\n\n## Indicators of Compromise (IOCs)\n\n\n-----\n\n**Indicator** **Details**\n\nhttp://satkas.waw[.]pl/rainloop/forecast TrailBlazer\nC2\n\n1326932d63485e299ba8e03bfcd23057f7897c3ae0d26ed1235c4fb108adb105 TrailBlazer\nSHA256\n\nvm-srv-1.gel.ulaval.ca GoldMax C2\n\n2a3b660e19b56dad92ba45dd164d300e9bd9c3b17736004878f45ee23a0177ac GoldMax\nSHA256\n\n156.96.46.116 TA\nInfrastructure\n\n188.34.185.85 TA\nInfrastructure\n\n212.103.61.74 TA\nInfrastructure\n\n192.154.224.126 TA\nInfrastructure\n\n23.29.115.180 TA\nInfrastructure\n\n104.237.218.74 TA\nInfrastructure\n\n23.82.128.144 TA\nInfrastructure\n\n**Additional Resources**\n\n_Read about the latest trends in threat hunting and more in the 2021 Threat Hunting_\n_[Report or simply download the report now.](https://www.crowdstrike.com/resources/reports/threat-hunting-report-2021/)_\n_[Learn more about Falcon OverWatch proactive managed threat hunting.](https://www.crowdstrike.com/endpoint-security-products/falcon-overwatch-threat-hunting/)_\n_[Watch this video to see how Falcon OverWatch proactively hunts for threats in your](https://www.crowdstrike.com/resources/videos/falcon-overwatch-proactively-hunts-threats-environment/)_\n_environment._\n_[Learn more about the CrowdStrike Falcon® platform by visiting the product webpage.](https://www.crowdstrike.com/endpoint-security-products/falcon-platform/)_\n_[Test CrowdStrike next-gen AV for yourself. Start your free trial of Falcon Prevent™](https://go.crowdstrike.com/try-falcon-prevent.html)_\n_today._\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "d63ae2b7-445f-460d-965d-2676dacdb6de",
            "created_at": "2022-10-25T15:59:19.552139Z",
            "updated_at": "2022-10-25T15:59:19.552139Z",
            "deleted_at": null,
            "name": "APTnotes",
            "url": "https://github.com/aptnotes/data",
            "description": "APTnotes data",
            "reports": null
        }
    ],
    "references": [
        "https://app.box.com/s/hbbt1tdp1nr2p7tesf1qqm9ehgn8bgfu"
    ],
    "report_names": [
        "Crowdstrike_StellarParticle-Campaign-Novel-Tactics-Techniques(01-27-2022)"
    ],
    "threat_actors": [
        {
            "id": "b43e5ea9-d8c8-4efa-b5bf-f1efb37174ba",
            "created_at": "2022-10-25T16:07:24.36191Z",
            "updated_at": "2025-03-27T02:02:10.1909Z",
            "deleted_at": null,
            "main_name": "UNC2452",
            "aliases": [
                "Dark Halo",
                "Nobelium",
                "SolarStorm",
                "StellarParticle",
                "UNC2452"
            ],
            "source_name": "ETDA:UNC2452",
            "tools": [],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "70872c3a-e788-4b55-a7d6-b2df52001ad0",
            "created_at": "2023-01-06T13:46:39.18401Z",
            "updated_at": "2025-03-27T02:00:03.01553Z",
            "deleted_at": null,
            "main_name": "UNC2452",
            "aliases": [
                "DarkHalo",
                "StellarParticle",
                "NOBELIUM",
                "Solar Phoenix",
                "Midnight Blizzard"
            ],
            "source_name": "MISPGALAXY:UNC2452",
            "tools": [
                "SNOWYAMBER",
                "HALFRIG",
                "QUARTERRIG"
            ],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "1d3f9dec-b033-48a5-8b1e-f67a29429e89",
            "created_at": "2022-10-25T15:50:23.739197Z",
            "updated_at": "2025-03-27T02:00:55.536417Z",
            "deleted_at": null,
            "main_name": "UNC2452",
            "aliases": [
                "UNC2452",
                "NOBELIUM",
                "StellarParticle",
                "Dark Halo"
            ],
            "source_name": "MITRE:UNC2452",
            "tools": [
                "Sibot",
                "Mimikatz",
                "Cobalt Strike",
                "AdFind",
                "GoldMax"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "5b748f86-ac32-4715-be9f-6cf25ae48a4e",
            "created_at": "2024-06-04T02:03:07.956135Z",
            "updated_at": "2025-03-27T02:05:17.407352Z",
            "deleted_at": null,
            "main_name": "IRON HEMLOCK",
            "aliases": [
                "ATK7 ",
                "Blue Kitsune ",
                "Cozy Bear ",
                "The Dukes",
                "UNC2452 ",
                "YTTRIUM ",
                "APT29 "
            ],
            "source_name": "Secureworks:IRON HEMLOCK",
            "tools": [
                " CozyCar",
                " CozyDuke",
                " DiefenDuke",
                " FatDuke",
                " HAMMERTOSS",
                " LiteDuke",
                " MiniDuke",
                " OnionDuke",
                " PolyglotDuke",
                " RegDuke",
                " RegDuke Loader",
                " SeaDuke",
                " Sliver",
                "CosmicDuke"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "a241a1ca-2bc9-450b-a07b-aae747ee2710",
            "created_at": "2024-06-19T02:03:08.150052Z",
            "updated_at": "2025-03-27T02:05:17.409596Z",
            "deleted_at": null,
            "main_name": "IRON RITUAL",
            "aliases": [
                "Blue Dev 5 ",
                "BlueBravo ",
                "Cloaked Ursa ",
                "CozyLarch ",
                "Dark Halo ",
                "Midnight Blizzard ",
                "NOBELIUM ",
                "StellarParticle ",
                "UNC2452 ",
                "APT29"
            ],
            "source_name": "Secureworks:IRON RITUAL",
            "tools": [
                " Cobalt Strike",
                " EnvyScout",
                " GoldFinder",
                " GoldMax",
                " NativeZone",
                " RAINDROP",
                " SUNBURST",
                " Sibot",
                " TEARDROP",
                " VaporRage",
                "Brute Ratel C4"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "20d3a08a-3b97-4b2f-90b8-92a89089a57a",
            "created_at": "2022-10-25T15:50:23.548494Z",
            "updated_at": "2025-03-27T02:00:55.49688Z",
            "deleted_at": null,
            "main_name": "APT29",
            "aliases": [
                "APT29",
                "IRON RITUAL",
                "IRON HEMLOCK",
                "NobleBaron",
                "Dark Halo",
                "NOBELIUM",
                "UNC2452",
                "YTTRIUM",
                "The Dukes",
                "Cozy Bear",
                "CozyDuke",
                "SolarStorm",
                "Blue Kitsune",
                "UNC3524",
                "Midnight Blizzard"
            ],
            "source_name": "MITRE:APT29",
            "tools": [
                "PinchDuke",
                "ROADTools",
                "WellMail",
                "CozyCar",
                "Mimikatz",
                "Tasklist",
                "OnionDuke",
                "FatDuke",
                "POSHSPY",
                "EnvyScout",
                "SoreFang",
                "GeminiDuke",
                "GoldMax",
                "FoggyWeb",
                "SDelete",
                "PolyglotDuke",
                "AADInternals",
                "MiniDuke",
                "SeaDuke",
                "Sibot",
                "RegDuke",
                "CloudDuke",
                "GoldFinder",
                "AdFind",
                "PsExec",
                "NativeZone",
                "Systeminfo",
                "ipconfig",
                "Impacket",
                "Cobalt Strike",
                "PowerDuke",
                "QUIETEXIT",
                "HAMMERTOSS",
                "BoomBox",
                "CosmicDuke",
                "WellMess",
                "VaporRage",
                "LiteDuke"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "46b3c0fc-fa0c-4d63-a38a-b33a524561fb",
            "created_at": "2023-01-06T13:46:38.393409Z",
            "updated_at": "2025-03-27T02:00:02.822155Z",
            "deleted_at": null,
            "main_name": "APT29",
            "aliases": [
                "The Dukes",
                "Minidionis",
                "Grizzly Steppe",
                "G0016",
                "Blue Kitsune",
                "BlueBravo",
                "SeaDuke",
                "Cloaked Ursa",
                "YTTRIUM",
                "ATK7",
                "Nobelium",
                "UAC-0029",
                "Group 100",
                "COZY BEAR",
                "IRON HEMLOCK",
                "TA421",
                "ITG11"
            ],
            "source_name": "MISPGALAXY:APT29",
            "tools": [
                "QUARTERRIG",
                "SNOWYAMBER",
                "HALFRIG"
            ],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "f27790ff-4ee0-40a5-9c84-2b523a9d3270",
            "created_at": "2022-10-25T16:07:23.341684Z",
            "updated_at": "2025-03-27T02:02:09.74554Z",
            "deleted_at": null,
            "main_name": "APT 29",
            "aliases": [
                "APT 29",
                "ATK 7",
                "Blue Dev 5",
                "BlueBravo",
                "Cloaked Ursa",
                "CloudLook",
                "Cozy Bear",
                "Dark Halo",
                "Earth Koshchei",
                "Grizzly Steppe",
                "Group 100",
                "ITG11",
                "Iron Hemlock",
                "Iron Ritual",
                "Midnight Blizzard",
                "Minidionis",
                "Nobelium",
                "NobleBaron",
                "Operation Ghost",
                "Operation Office monkeys",
                "Operation StellarParticle",
                "SilverFish",
                "Solar Phoenix",
                "SolarStorm",
                "StellarParticle",
                "TEMP.Monkeys",
                "The Dukes",
                "UNC2452",
                "UNC3524",
                "Yttrium"
            ],
            "source_name": "ETDA:APT 29",
            "tools": [
                "7-Zip",
                "ATI-Agent",
                "AdFind",
                "Agentemis",
                "AtNow",
                "BEATDROP",
                "BotgenStudios",
                "CEELOADER",
                "Cloud Duke",
                "CloudDuke",
                "CloudLook",
                "Cobalt Strike",
                "CobaltStrike",
                "CosmicDuke",
                "Cozer",
                "CozyBear",
                "CozyCar",
                "CozyDuke",
                "Danfuan",
                "EnvyScout",
                "EuroAPT",
                "FatDuke",
                "FoggyWeb",
                "GeminiDuke",
                "Geppei",
                "GoldFinder",
                "GoldMax",
                "GraphDrop",
                "GraphicalNeutrino",
                "GraphicalProton",
                "HAMMERTOSS",
                "HammerDuke",
                "LOLBAS",
                "LOLBins",
                "LiteDuke",
                "Living off the Land",
                "MagicWeb",
                "Mimikatz",
                "MiniDionis",
                "MiniDuke",
                "NemesisGemina",
                "NetDuke",
                "OnionDuke",
                "POSHSPY",
                "PinchDuke",
                "PolyglotDuke",
                "PowerDuke",
                "QUIETEXIT",
                "ROOTSAW",
                "RegDuke",
                "Rubeus",
                "SNOWYAMBER",
                "SPICYBEAT",
                "SUNSHUTTLE",
                "SeaDaddy",
                "SeaDask",
                "SeaDesk",
                "SeaDuke",
                "Sharp-SMBExec",
                "SharpView",
                "Sibot",
                "Solorigate",
                "SoreFang",
                "TinyBaron",
                "WINELOADER",
                "WellMail",
                "WellMess",
                "cobeacon",
                "elf.wellmess",
                "reGeorg",
                "tDiscoverer"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1666716504,
    "ts_updated_at": 1743041794,
    "ts_creation_date": 1645420178,
    "ts_modification_date": 1645420178,
    "files": {
        "pdf": "https://archive.orkl.eu/a16e7cba15ff41a224278d6cb7037e65d8cf6e8b.pdf",
        "text": "https://archive.orkl.eu/a16e7cba15ff41a224278d6cb7037e65d8cf6e8b.txt",
        "img": "https://archive.orkl.eu/a16e7cba15ff41a224278d6cb7037e65d8cf6e8b.jpg"
    }
}