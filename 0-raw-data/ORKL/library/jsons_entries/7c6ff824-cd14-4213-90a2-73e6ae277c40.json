{
    "id": "7c6ff824-cd14-4213-90a2-73e6ae277c40",
    "created_at": "2023-01-12T15:09:13.915036Z",
    "updated_at": "2025-03-27T02:06:11.192556Z",
    "deleted_at": null,
    "sha1_hash": "caa89cd9097be95227f1c0d6b79fae70f3ad69b0",
    "title": "2022-04-28 - Threat Thursday- BoratRAT",
    "authors": "",
    "file_creation_date": "2022-05-28T23:25:14Z",
    "file_modification_date": "2022-05-28T23:25:14Z",
    "file_size": 1036689,
    "plain_text": "# Threat Thursday: BoratRAT\n\n**[blogs.blackberry.com/en/2022/04/threat-thursday-boratrat](https://blogs.blackberry.com/en/2022/04/threat-thursday-boratrat)**\n\nThe BlackBerry Research & Intelligence Team\n\nWhile the name “BoratRAT” might bring a certain comedian to mind, this threat is nothing to\nlaugh at. BoratRAT is an all-in-one malware toolkit that is capable of a variety of destructive\nactivities, including acting as a ransomware, and performing credential theft.\n\nBoratRAT was [first analyzed by researchers at Cyble, which gave us our first deep dive into](https://blog.cyble.com/2022/03/31/deep-dive-analysis-borat-rat/)\nthis malware’s full range of features. In researching this threat further, we discovered some\nintriguing connections between BoratRAT, SantaRAT, and AsyncRAT.\n\n### Operating System\n\n Risk & Impact\n\n\n-----\n\n### Technical Analysis\n\n[BoratRAT’s name is taken from a satirical and fictional character (“Borat Sagdiyev”) played](https://en.wikipedia.org/wiki/Borat_Sagdiyev)\n[by comedian Sacha Baron Cohen. The malware author promotes this Trojan on the web as](https://en.wikipedia.org/wiki/Sacha_Baron_Cohen)\nthe “#1 Remote Administration Tool” and uses Cohen’s likeness in its icon.\n\nBoratRAT was first seen by researchers on March 31, 2022. This new remote access trojan\n(RAT) proudly promotes itself as having a large feature set including the following:\n\nDirect Denial of Service (DDoS) attacks\nRansomware capabilities\n\nKeylogging and data exfiltration\n\nPeripheral device manipulation (cameras, monitors, etc.)\n\nUser Account Control (UAC) Bypass and Windows Defender deactivation\n\nAudio and Webcam Recording\n\nBrowser credential and password theft\n\nDiscord Token theft\n\nFile system manipulation\n\nRemote Desktop capabilities\n\nIn the spirit of brevity, this post will analyze just two modules packaged with BoratRAT:\nkeylogger.exe and information.dll. We will examine the modules’ functionality and compare\nthem with a similar older threat, SantaRAT. There, we will aim to find a major set of\ncommonalities between the two RATs.\n\n### BoratRAT Breakdown\n\nBoratRAT is initially packaged as a zip file named Borat.zip (SHA256\nD2ce3aa530ba6b6680759b79aa691260244ca91f5031aa9670248924cc983fb0). Inside the\nzip file is the BoratRAT.exe executable, a config file for BoratRAT, a server certificate, and a\nbin directory. All the feature-supporting modules are stored in the bin directory of the zip.\nFor our purposes here, we will be focusing on the following three executables:\n\nBoratRAT.exe\n(b47c77d237243747a51dd02d836444ba067cf6cc4b8b3344e5cf791f5f41d20e)\n\nKeylogger.exe\n(16beb1ae2de2974ccc2371d9f619f492295e590abb65d3102e362c8ec27f2bbb)\n\n\n-----\n\nInformation.dll\n(a15d72d990686d06d89d7e11df2b16bcd5719a40298c19d046fa22c40d56af44)\n\nRunning the BoratRAT.exe starts the user interface for the malware operator. From here, a\nthreat actor can conduct all the malware’s capabilities on their target machine, as shown in\nFigure 1. The malware author packed BoratRAT.exe with Enigma Protector for obfuscation,\nto make it more difficult to analyze.\n\n_Figure 1 – BoratRAT UI snippet_\n\nThe keylogger.exe application module is called through BoratRAT’s user interface (UI).\nKeylogger.exe does exactly as the filename describes – it logs the victim’s keystrokes and\nsaves the input to a file. The keylogging application starts with a main function, which\npasses a low-level keyboard procedure to a function called SetHook. SetHook receives the\nreturn value from HookCallback as shown in Figure 2 below, which uses a combination of\nGetKeyState and a decision structure to get key status.\n\n\n-----\n\n_Figure 2 - HookCallBack function with keystroke decision tree_\n\nOnce the key state is recognized, a keystroke is then written to a string stream with\nStreamWriter. [StreamWriter is a library native to the C# programming language, which is](https://docs.microsoft.com/en-us/dotnet/api/system.io.streamwriter?view=net-6.0)\nused to write characters to a stream in UTF-8 encoding.\n\nAt this point in the malware’s execution, a check is made with an IF ELSE statement against\nthe GetActiveWindowTitle() function. Then the function makes a call to\nGetForegroundWindow() from winuser.h, to return a handle to the window that the victim is\ncurrently working in. This is done to properly label which active window the victim is in, as it\nwrites keystrokes to the file.\n\nThe output from this activity is then written to a file indicated by the program.loggerPath\nvariable. LoggerPath is a static string used by the program that concatenates the working\nenvironment of the program to the output file, to give it a full environment path. In this\ninstance, the file is named “\\\\Sa8X0fH1BudXLog.txt” and is written out to the environment\nfolder path specified by the malware, as shown in Figure 3.\n\n\n-----\n\n_Figure 3 – Text file Sa8XofH1BudXLog.txt location in Keylogger.exe_\n\nThe Information.dll module contains commands to exfiltrate system information to the\nattacker. The function execCMD starts a command prompt with the “cmd.exe” application,\nwhich is launched in CreateNoWindow mode with standard output, input and error\nredirected. This redirection is done to hide the execution of the command prompt from the\ndesktop.\n\nAt that point, the InformationList() function calls execCMD(). A command string is passed\nthat writes a long stream of system information out to the command line, as seen in Figure\n4. The information is then packeted and sent back to the threat actor. The string of echo\ncommands is a full dump of environment, OS version, hardware, hosts, user/administrator\ninformation, and network information.\n\n_Figure 4 – Information.dll “InformationList” and “execCMD” functions_\n\nIt is likely that the initial inspiration for BoratRAT was an earlier threat called AsyncRAT,\nwhich first appeared two years ago. Evidence supporting this origin was found by\n[BleepingComputer, which pointed out similarities between these two threats. This assertion](https://www.bleepingcomputer.com/news/security/new-borat-remote-access-malware-is-no-laughing-matter/)\n[has also been backed up through string analysis using the Intezer Analyze tool.](https://analyze.intezer.com/analyses/677be970-91fc-483b-9d47-a37ad3842edc)\n\nThis is not the only RAT that was inspired by this threat – SantaRAT was also built on\nAsyncRAT, and it could have been another starting point for BoratRAT’s development. In\nfact, on the main page of the GitHub repository for SantaRAT, the owner gives a personal\n“thank you” to the author of the AsyncRAT library.\n\n\n-----\n\nFrom the starting point of AsyncRAT s functionality, SantaRAT added modules like audio\nrecording and file system modifications. But SantaRAT’s last change was made five months\nago. BoratRAT began with a feature set that is closer to that of SantaRAT.\n\nThe two modules we will analyze in this section are just a fraction of this RAT’s capabilities,\n[to show a representative example of the links between the SantaRAT source code and](https://github.com/Grinchiest/SantaRat)\nBoratRAT’s module code.\n\nOn a high level, the similarities are quickly apparent. For instance, both threats are written\nin C#. They have a very similar feature set; they are both capable of ransoming a victim,\nstealing credentials, and obtaining remote access, to name but a few examples.\n\nWhen we get down to the modules, the similarities continue. Whenever source code files\n(legitimate or otherwise) are compiled, each module contains a directory path that\nreferences a program database file. Program database files are used to store debugging\ninformation about a compiled source code file.\n\nIn BoratRAT’s path, we see a reference to SantaRAT, which is shown in Figure 5. This\nshows that SantaRAT modules were downloaded, compiled, and were in use in the same\nenvironment. This pathway with “SantaRat-main” is seen in BoratRAT’s information.dll\nlibrary as well.\n\n_Figure 5 – SantaRAT-main library path string in BoratRAT’s packaged Keylogger.exe_\n\nBeyond that, the structured code and module names also nearly mirror each other. With the\nexclusion of a few modules in SantaRAT, the module packages are nearly identical when\ncompared side by side, as seen below in Figure 6. The missing directories are Chat,\nDecryptor, and messagepacklib. This could be due to the author refactoring some code\nfunctionality into similar libraries.\n\n\n-----\n\n_Figure 6 – BoratRAT bin and SantaRAT plugin_\n\nAlmost all the module code from both RATs is identical. Information.dll shares the exact\nsame code as packet.cs in the SantaRAT repository on GitHub. A snippet of the execCMD\ntaken from SantaRAT and BoratRAT, seen in Figure 7, shows almost a line-for-line copy\nbetween the two. This type of code reuse is found in the keylogger.exe application and\npackaged in BoratRAT and program.cs from SantaRAT’s repository as well.\n\n\n-----\n\n_Figure 7 – SantaRAT execCMD function (left) BoratRAT execCMD function (right)_\n\n### Conclusion\n\nIt’s clear from the supporting analysis that the malware author of BoratRAT used SantaRAT\nas a development reference. In every module we analyzed there is obvious code reuse.\nSome of the modules have been exact line-for-line copies.\n\nSo, what does this mean? We think that BoratRAT’s code reuse could indicate a\ncontinuation of development and rebranding of SantaRAT. It is entirely possible that a new\nauthor could take over the evolution of this malware, or it could be that BoratRAT is meant\nto be yet another short-lived development. Time will tell where this threat is headed.\n\nDespite BoratRAT’s comical name, the versatility of this RAT makes it a dangerous threat\nthat both private individuals and companies should be wary of. The impact of BoratRAT\nobtaining entry to a system (either an individual or an organization) could be catastrophic,\nand proper security practices should be observed to help mitigate threats such as this.\n\n### YARA Rules\n\nThe following YARA rule was authored by the BlackBerry Research & Intelligence team to\ncatch the threat described in this document:\n\nrule BoratRAT{\n\nmeta:\n\ndescription = \"Detects BoratRAT.exe\"\n\nauthor = \"BlackBerry Threat Research Team\"\n\ndate = \"2022-04-13\"\n\nlicense = \"This Yara rule is provided under the Apache License 2.0\n(https://www.apache.org/licenses/LICENSE-2.0) and open to any user or organization, as\nlong as you use it under this license and ensure originator credit in any derivative to The\nBlackBerry Research & Intelligence Team\"\n\n\n-----\n\nstrings:\n\n$s1 = \"enigma1\"\n\n$s2 = \"enigma2\"\n\n$s3 = \"Server.Forms.FormFileManager.resources\"\n\n$s4 = \"Server.Forms.FormFileSearcher.resources\"\n\n$s5 = \"Server.Forms.FormKeylogger.resources\"\n\n$s6 = \"Server.Forms.FormNetstat.resources\"\n\n$s7 = \"Server.Forms.FormFun.resources\"\n\n$s8 = \"Server.Forms.FormWebcam.resources\"\n\n$s9 = \"BoratRat\"\n\n$s10 = \"Keylogger.exe\"\n\ncondition:\n\nuint16(0) == 0x5a4d and all of them\n\n}\n\nrule BoratRATKeylogger{\n\nmeta:\n\ndescription = \"Detects BoratRAT Keylogger\"\n\nauthor = \"BlackBerry Threat Research Team\"\n\ndate = \"2022-04-13\"\n\nlicense = \"This Yara rule is provided under the Apache License 2.0\n(https://www.apache.org/licenses/LICENSE-2.0) and open to any user or organization, as\nlong as you use it under this license and ensure originator credit in any derivative to The\nBlackBerry Research & Intelligence Team\"\n\nstrings:\n\n$s1 = \"Sa8XOfH1BudXLog.txt\" wide\n\n$s2 = \"[CAPSLOCK: ON]\" wide\n\n$s3 = \"[CAPSLOCK: OFF]\" wide\n\n$s4 = \"[SPACE]\" wide\n\n$s5 = \"[ENTER]\" wide\n\n\n-----\n\n$sp = { 43 3A 5C 55 73 65 72 73 5C 41 64 6D 69 6E 69 73 74 72 61 74 6F 72 5C\n\n44 6F 77 6E 6C 6F 61 64 73 5C 53 61 6E 74 61 52 61 74 2D 6D 61 69 6E\n\n5C 42 69 6E 61 72 69 65 73 5C 52 65 6C 65 61 73 65 5C 50 6C 75 67 69\n\n6E 73 5C 4B 65 79 6C 6F 67 67 65 72 2E 70 64 62 }\n\ncondition:\n\nuint16(0) == 0x5a4d and all of them\n\n}\n\nrule BoratRATInformation{\n\nmeta:\n\ndescription = \"Detects BoratRAT Information Module\"\n\nauthor = \"BlackBerry Threat Research Team\"\n\ndate = \"2022-04-13\"\n\nlicense = \"This Yara rule is provided under the Apache License 2.0\n(https://www.apache.org/licenses/LICENSE-2.0) and open to any user or organization, as\nlong as you use it under this license and ensure originator credit in any derivative to The\nBlackBerry Research & Intelligence Team\"\n\nstrings:\n\n$s1 = \"set_UseShellExecute\"\n\n$s2 = \"execCMD\"\n\n$s3 = \"hostname\" wide\n\n$s4 = \"ipconfig\" wide\n\n$s5 = \"tasklist\" wide\n\n$s6 = \"arp -a\" wide\n\n$sp = {43 3A 5C 55 73 65 72 73 5C 41 64 6D 69 6E 69\n\n73 74 72 61 74 6F 72 5C 44 6F 77 6E 6C 6F 61\n\n64 73 5C 53 61 6E 74 61 52 61 74 2D 6D 61 69\n\n6E 5C 42 69 6E 61 72 69 65 73 5C 52 65 6C 65\n\n61 73 65 5C 50 6C 75 67 69 6E 73 5C 49 6E 66\n\n6F 72 6D 61 74 69 6F 6E 2E 70 64 62}\n\n\n-----\n\ncondition:\n\nuint16(0) == 0x5a4d and all of them\n\n}\n\n### Indicators of Compromise (IoCs)\n\nb47c77d237243747a51dd02d836444ba067cf6cc4b8b3344e5cf791f5f41d20e –\nBoratRAT.exe\n\n16beb1ae2de2974ccc2371d9f619f492295e590abb65d3102e362c8ec27f2bbb –\nKeylogger.exe\n\na15d72d990686d06d89d7e11df2b16bcd5719a40298c19d046fa22c40d56af44 –\nInformation.dll\n\nD2ce3aa530ba6b6680759b79aa691260244ca91f5031aa9670248924cc983fb0 –\nBorat.zip\n\n### BlackBerry Assistance\n\nIf you’re battling this malware or a similar threat, you’ve come to the right place, regardless\nof your existing BlackBerry relationship.\n\n[The BlackBerry Incident Response team is made up of world-class consultants dedicated to](https://www.blackberry.com/us/en/services/incident-response)\nhandling response and containment services for a wide range of incidents, including\nransomware and Advanced Persistent Threat (APT) cases.\n\nWe have a global consulting team standing by to assist you, providing around-the-clock\n[support where required, as well as local assistance. Please contact us here.](https://www.blackberry.com/us/en/forms/cylance/handraiser/emergency-incident-response-containment)\n\n\n-----\n\n## About The BlackBerry Research & Intelligence Team\n\nThe BlackBerry Research & Intelligence team examines emerging and persistent threats,\nproviding intelligence analysis for the benefit of defenders and the organizations they serve.\n\nBack\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-04-28 - Threat Thursday- BoratRAT.pdf"
    ],
    "report_names": [
        "2022-04-28 - Threat Thursday- BoratRAT.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673536153,
    "ts_updated_at": 1743041171,
    "ts_creation_date": 1653780314,
    "ts_modification_date": 1653780314,
    "files": {
        "pdf": "https://archive.orkl.eu/caa89cd9097be95227f1c0d6b79fae70f3ad69b0.pdf",
        "text": "https://archive.orkl.eu/caa89cd9097be95227f1c0d6b79fae70f3ad69b0.txt",
        "img": "https://archive.orkl.eu/caa89cd9097be95227f1c0d6b79fae70f3ad69b0.jpg"
    }
}