{
    "id": "46e5e759-8b83-4468-abf7-a73134a7f19a",
    "created_at": "2023-01-12T15:00:34.840125Z",
    "updated_at": "2025-03-27T02:17:25.724527Z",
    "deleted_at": null,
    "sha1_hash": "aa41ff074e651db4dbad434b900cecc51cc01256",
    "title": "2021-03-24 - A .NET rat targets Mongolia",
    "authors": "",
    "file_creation_date": "2022-05-28T19:13:56Z",
    "file_modification_date": "2022-05-28T19:13:56Z",
    "file_size": 69825,
    "plain_text": "# A .NET rat targets Mongolia\n\n**[sebdraven.medium.com/a-net-rat-target-mongolia-9c1439c39bc2](https://sebdraven.medium.com/a-net-rat-target-mongolia-9c1439c39bc2)**\n\nSebdraven March 24, 2021\n\nSe\nbdrav\n\n\n[Sebdraven](https://sebdraven.medium.com/?source=post_page-----9c1439c39bc2--------------------------------)\n\nMar 23, 2021\n\n\n4 min read\n\nA new document royal road v7 installs a backdoor in .NET. a first executable is dropped\n\\os03C2.tmp. This exe has many similarities with older campaigns using by Operation LagTime\nor Tonto Team.\n\n**Document**\n\nThe decoy document is a document about infection of covid19 in Russia send to the Mongolia\nAuthorities. The document is fake signed A. Amarsaikhan.\n\nThis technics was used by Operation LagTime and another APT Chinese.\n\n**Backdoor Analysis**\n\nThe backdoor is installed C:\\MSBuild\\WindowsUpdate\\S-1–2 and the name of file is csrss.exe\nlike the legit process of Windows\n\nThe configuration of the backdoor is stored in a ressource .NET.\n\n\n-----\n\nThe content of the XML file is encrypted with the AES algorithm. The key is hardcoded in the\nclass Main_Form in the private method Main_Form_Load.\n\n\n-----\n\nbyte[] crypt_key = new byte[]\n{\n230,\n23,\n63,\n211,\n96,\n49,\n120,\n48,\n182,\n11,\n49,\n173,\n233,\n114,\n123,\n61,\n230,\n23,\n63,\n211,\n96,\n49,\n120,\n48,\n182,\n11,\n49,\n173,\n233,\n114,\n123,\n61\n};\n\nThe xml file is decrypted :\n\n\n-----\n\nA session key is created and used for encrypting all data found by the backdoor and send to\nC2.\n\nA mutant is created with the information of the configuration:\n\n\n-----\n\nAnd the persistence is the run keys with a check of the privileges:\n\n\n-----\n\nA connection to the c2 is done in a thread with the method Post_Online_Message. The\nmessages are encrypted with the BasicKey hardcoded in the code:\n8A5AE1329F9CD824EE915FE14328D267\n\n\n-----\n\n-----\n\nThe first information are sent in the setting of the compromise computer with the method\nGet_ComputerInfo.\n\nThe disk are listed, the kind of operating system, the processor information, the memory ram.\nThese information are collecting by using WMI and the IP of the computer.\n\n\n-----\n\nAfter that, the backoor waits orders in another thread with the method Get_Server_Order.\n\n\n-----\n\nAll orders are decrypted with the same BasicKey\n\n\n-----\n\nAnd the method Order_Catcher launch the different orders:\n\nthe order is Getdir, $GetDisk, GetFileList, Checksum, DeleteFile, DeleteFolder, RenameFolder,\nRenameFile, RunHide, Upload, Download, ActiveDos, ExecuteCommand, Disconnect, Trans\n(to transfert data), Uninstall\n\nEach order has a method with the same name:\n\n\n-----\n\n## Threat Intelligence\n\nMany TTPs are similar to another groups like TA428 (Operation LagTime) or Tonto. So this\nbackdoor can be developped by APT Chinese Group.\n\nA new technic is to use .NET. There is different example with .Net plugx loader or tool to install\nthe different payload like RedDelta. Chinese State-Sponsored Group ‘RedDelta’ Targets the\nVatican and Catholic Organizations (recordedfuture.com)\n\nIn this case, there is not a side loading then many operations driven by APT chinese.\n\n## IOCs:\n\n\n-----\n\nc2 185.82.218.40\n\nRTF: 1120275dc25bc9a7b3e078138c7240fbf26c91890d829e51d9fa837fe90237ed\n\nDropped executable file\nC:\\Users\\admin\\AppData\\Local\\Temp\\os03C2.tmp\n2b038ad9bfb8c3f40e95e38b572bdf536d9fd2e7dd5cc0c66fbd0bdc1ed89fde\nC:\\MSBuild\\WindowsUpdate\\S-1–2\\cssrs.exe\n08be2c7239acb9557454088bba877a245c8ef9b0e9eb389c65a98e1c752c5709\n\nc2: 185.82.218.40\n\nYara rule:\n\nrule backdoor_net{\nmeta:\ndescription= “Backdoor targets Mongolia”\n[author= “@sebdraven”](http://twitter.com/sebdraven)\ndate = “2020–03–23”\ntlp = “white”\nstrings:\n$s1=”RunHide”\n$s2=”Token”\n$s3=”BasicKey”\n$s4=”SessionKey”\n$s5=”AdminKeyMD5\"\n$s6=”Aes256\"\n$s7=”Order_Catcher”\n$s8=”Get_ComputerInfo”\n$s9=”TransData”\ncondition:\nall of them\n}\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-03-24 - A .NET rat targets Mongolia.pdf"
    ],
    "report_names": [
        "2021-03-24 - A .NET rat targets Mongolia.pdf"
    ],
    "threat_actors": [
        {
            "id": "b5449533-0ff1-4048-999d-7d4bfd8e6da6",
            "created_at": "2022-10-25T16:07:24.114365Z",
            "updated_at": "2025-03-27T02:02:10.111256Z",
            "deleted_at": null,
            "main_name": "RedDelta",
            "aliases": [
                "Operation Dianxun",
                "TA416"
            ],
            "source_name": "ETDA:RedDelta",
            "tools": [
                "Agent.dhwf",
                "Agentemis",
                "Chymine",
                "Cobalt Strike",
                "CobaltStrike",
                "Darkmoon",
                "Destroy RAT",
                "DestroyRAT",
                "Gen:Trojan.Heur.PT",
                "Kaba",
                "Korplug",
                "PlugX",
                "Poison Ivy",
                "RedDelta",
                "SPIVY",
                "Sogu",
                "TIGERPLUG",
                "TVT",
                "Thoper",
                "Xamtrav",
                "cobeacon",
                "pivy",
                "poisonivy"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "a4aca3ca-9e04-42d1-b037-f7fb3fbab0b1",
            "created_at": "2023-01-06T13:46:39.042499Z",
            "updated_at": "2025-03-27T02:00:02.984002Z",
            "deleted_at": null,
            "main_name": "TA428",
            "aliases": [
                "Colourful Panda",
                "BRONZE DUDLEY"
            ],
            "source_name": "MISPGALAXY:TA428",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "aa90ad17-8852-4732-9dba-72ffb64db493",
            "created_at": "2023-07-11T02:00:10.067957Z",
            "updated_at": "2025-03-27T02:00:03.134199Z",
            "deleted_at": null,
            "main_name": "RedDelta",
            "aliases": [],
            "source_name": "MISPGALAXY:RedDelta",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "58db0213-4872-41fe-8a76-a7014d816c73",
            "created_at": "2023-01-06T13:46:38.61757Z",
            "updated_at": "2025-03-27T02:00:02.874484Z",
            "deleted_at": null,
            "main_name": "Tonto Team",
            "aliases": [
                "BRONZE HUNTLEY",
                "Red Beifang",
                "G0131",
                "PLA Unit 65017",
                "Earth Akhlut",
                "TAG-74",
                "CactusPete",
                "KARMA PANDA"
            ],
            "source_name": "MISPGALAXY:Tonto Team",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "2f07a03f-eb1f-47c8-a8e9-a1a00f2ec253",
            "created_at": "2022-10-25T16:07:24.277669Z",
            "updated_at": "2025-03-27T02:02:10.157972Z",
            "deleted_at": null,
            "main_name": "TA428",
            "aliases": [
                "Operation LagTime IT",
                "Operation StealthyTrident",
                "ThunderCats"
            ],
            "source_name": "ETDA:TA428",
            "tools": [
                "8.t Dropper",
                "8.t RTF exploit builder",
                "8t_dropper",
                "Agent.dhwf",
                "Albaniiutas",
                "BlueTraveller",
                "Chymine",
                "Cotx RAT",
                "CoughingDown",
                "Darkmoon",
                "Destroy RAT",
                "DestroyRAT",
                "Gen:Trojan.Heur.PT",
                "Kaba",
                "Korplug",
                "LuckyBack",
                "PhantomNet",
                "PlugX",
                "Poison Ivy",
                "RedDelta",
                "RoyalRoad",
                "SManager",
                "SPIVY",
                "Sogu",
                "TIGERPLUG",
                "TManger",
                "TVT",
                "Thoper",
                "Xamtrav",
                "pivy",
                "poisonivy"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "da483338-e479-4d74-a6dd-1fb09343fd07",
            "created_at": "2022-10-25T15:50:23.698197Z",
            "updated_at": "2025-03-27T02:00:55.526588Z",
            "deleted_at": null,
            "main_name": "Tonto Team",
            "aliases": [
                "Tonto Team",
                "Earth Akhlut",
                "BRONZE HUNTLEY",
                "CactusPete",
                "Karma Panda"
            ],
            "source_name": "MITRE:Tonto Team",
            "tools": [
                "Mimikatz",
                "Bisonal",
                "ShadowPad",
                "LaZagne",
                "NBTscan",
                "gsecdump"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "c416260c-7ff6-4a74-a5ba-a15f40d3543f",
            "created_at": "2024-05-01T02:03:07.939268Z",
            "updated_at": "2025-03-27T02:05:17.25652Z",
            "deleted_at": null,
            "main_name": "BRONZE DUDLEY",
            "aliases": [
                "Temp.Hex ",
                "Vicious Panda ",
                "TA428 "
            ],
            "source_name": "Secureworks:BRONZE DUDLEY",
            "tools": [
                "PoisonIvy"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "9baa7519-772a-4862-b412-6f0463691b89",
            "created_at": "2022-10-25T15:50:23.354429Z",
            "updated_at": "2025-03-27T02:00:55.45162Z",
            "deleted_at": null,
            "main_name": "Mustang Panda",
            "aliases": [
                "Mustang Panda",
                "TA416",
                "RedDelta",
                "BRONZE PRESIDENT"
            ],
            "source_name": "MITRE:Mustang Panda",
            "tools": [
                "Cobalt Strike",
                "RCSession",
                "NBTscan",
                "PoisonIvy",
                "PlugX"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "c39b0fe6-5642-4717-9a05-9e94265e3e3a",
            "created_at": "2022-10-25T16:07:24.332084Z",
            "updated_at": "2025-03-27T02:02:10.175452Z",
            "deleted_at": null,
            "main_name": "Tonto Team",
            "aliases": [
                "Bronze Huntley",
                "CactusPete",
                "Earth Akhlut",
                "HartBeat",
                "Karma Panda",
                "LoneRanger",
                "Operation Bitter Biscuit",
                "TAG-74",
                "Tonto Team"
            ],
            "source_name": "ETDA:Tonto Team",
            "tools": [
                "8.t Dropper",
                "8.t RTF exploit builder",
                "8t_dropper",
                "Bioazih",
                "Bisonal",
                "CONIME",
                "Dexbia",
                "Korlia",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "Mimikatz",
                "POISONPLUG.SHADOW",
                "RoyalRoad",
                "ShadowPad Winnti",
                "XShellGhost"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535634,
    "ts_updated_at": 1743041845,
    "ts_creation_date": 1653765236,
    "ts_modification_date": 1653765236,
    "files": {
        "pdf": "https://archive.orkl.eu/aa41ff074e651db4dbad434b900cecc51cc01256.pdf",
        "text": "https://archive.orkl.eu/aa41ff074e651db4dbad434b900cecc51cc01256.txt",
        "img": "https://archive.orkl.eu/aa41ff074e651db4dbad434b900cecc51cc01256.jpg"
    }
}