{
    "id": "bbaa2193-86f5-4e0d-b748-f7182e5a7d95",
    "created_at": "2023-01-12T15:00:02.638121Z",
    "updated_at": "2025-03-27T02:17:01.049581Z",
    "deleted_at": null,
    "sha1_hash": "7d997b911c8b4aff60f2523d8c366138c303f750",
    "title": "2020-08-17 - Team TNT – The First Crypto-Mining Worm to Steal AWS Credentials",
    "authors": "",
    "file_creation_date": "2022-05-27T23:22:45Z",
    "file_modification_date": "2022-05-27T23:22:45Z",
    "file_size": 1095535,
    "plain_text": "# Team TNT – The First Crypto-Mining Worm to Steal AWS Credentials\n\n**[cadosecurity.com/post/team-tnt-the-first-crypto-mining-worm-to-steal-aws-credentials](https://www.cadosecurity.com/post/team-tnt-the-first-crypto-mining-worm-to-steal-aws-credentials)**\n\nBlog\n\nAugust 16, 2020\n\n\nAugust 16, 2020\n\n\nOver the weekend we’ve seen a crypto-mining worm spread that steals AWS credentials. It’s the first worm we’ve seen that\ncontains such AWS specific functionality. The worm also steals local credentials, and scans the internet for misconfigured Docker\nplatforms. We have seen the attackers, who call themselves “TeamTNT”, compromise a number of Docker and Kubernetes\nsystems.\n\nThese attacks are indicative of a wider trend. As organisations migrate their computing resources to cloud and container\nenvironments, we are seeing attackers following them there.\n\n\n-----\n\n**Figure 1: The message the TeamTNT worm prints to the screen when first run.**\n**AWS Credential Theft**\n\n[The AWS CLI stores credentials in an unencrypted file at ~/.aws/credentials, and additional configuration details in a file at](https://docs.aws.amazon.com/cli/latest/userguide/cli-configure-files.html)\n~/.aws/config.\n\nThe code to steal AWS credentials is relatively straightforward – on execution it uploads the default AWS .credentials and .config\nfiles to the attackers server, sayhi.bplace[.]net:\n\n**Figure 2: Code to steal AWS credentials from compromised systems.**\nCurl is used to send the AWS credentials to TeamTNT’s server, which responds with the message “THX”:\n\n\n-----\n\n**Figure 3: The**\n\nnetwork traffic generated by stolen AWS credentials.\n[We sent credentials created by CanaryTokens.org to TeamTNT, however have not seen them in use yet. This indicates that](https://canarytokens.org/generate)\nTeamTNT either manually assess and use the credentials, or any automation they may have created isn’t currently functioning.\n\nProliferation\n\nMost crypto-mining worms are an amalgamation of previous worms as authors copy and paste their competitors code. TeamTNT’s\nworm contains code copied from another worm named Kinsing, which is designed to stop the Alibaba Cloud Security tools:\n\n**Figure 4: Repurposed code to stop the Alibaba Cloud Security tools.**\nIn turn, it is likely we will see other worms start to copy the ability to steal AWS Credentials files too.\n\n**Docker**\n\nThe worm also includes code to scan for open Docker API’s using [masscan, then spin up docker images and install itself:](https://github.com/robertdavidgraham/masscan)\n\n\n-----\n\n**Figure 5: Code to**\n\nscan for open Docker APIs, then install the worm in a new container.\n**Post Exploitation**\n\nThe worm deploys the XMRig mining tool to mine monero crypto-currency and generate cash for the attackers. One of the Mining\npools they use provides detailed information about the systems the worm has compromised:\n\n**Figure 6: The**\n\nstatistics for the Monero wallet (below) on the Monero Ocean mining pool.\nThis page lists 119 compromised systems, some of which can be identified as Kubernetes Clusters and Jenkins Build Servers.So\nfar we have seen two different Monero wallets associated with these latest attacks, which have earned TeamTNT about 3 XMR.\nThat equates to only about $300 USD, however this is only one of their many campaigns.The worm also deploys a number of\nopenly available malware and offensive security tools:\n\npunk.py – A SSH post-exploitation tool\nA log cleaning tool\nDiamorphine Rootkit\nTsunami IRC Backdoor\n\n**TeamTNT**\n\nThe worm contains numerous references to “TeamTNT” and the domain teamtnt[.]red. The domain hosts malware, and the\nhomepage titled “TeamTNT RedTeamPentesting” is an odd reference to public malware sandboxes:\n\n\n-----\n\n**Figure 7: The home**\n\npage for teamtnt[.]red.\n**Conclusion**\n\nWhilst these attacks aren’t particularly sophisticated, the numerous groups out there deploying crypto-jacking worms are\nsuccessful at infecting large amounts of business systems.\n\nBelow are some suggestions to help protect them:\n\nIdentify which systems are storing AWS credential files and delete them if they aren’t needed. It’s common to find\ndevelopment credentials have accidentally been left on production systems.\nUse firewall rules to limit any access to Docker APIs. We strongly recommend using a whitelisted approach for your firewall\nruleset.\nReview network traffic for any connections to mining pools, or using the Stratum mining protocol.\nReview any connections sending the AWS Credentials file over HTTP.\n\n**Previous Work**\n\nWe would like to credit the previous research on TeamTNT by [Trend Micro,](https://www.trendmicro.com/vinfo/hk-en/security/news/virtualization-and-cloud/coinminer-ddos-bot-attack-docker-daemon-ports) [Malware Hunter Team and](https://twitter.com/malwrhunterteam/status/1256664761997148161) [r3dbU7z.](https://www.virustotal.com/gui/user/r3dbU7z/comments)\n\n\n-----\n\n```\n  meta:\n   description = “Detects TeamTNT Worm”\n   author = “[email protected]”\n   date = “2020-08-16”\n   license = “Apache License 2.0”\n   hash1 = “3a377e5baf2c7095db1d7577339e4eb847ded2bfec1c176251e8b8b0b76d393f”\n   hash2 = “929c3017e6391b92b2fbce654cf7f8b0d3d222f96b5b20385059b584975a298b”\n   hash3 = “705a22f0266c382c846ee37b8cd544db1ff19980b8a627a4a4f01c1161a71cb0”\n  strings:\n   $a = “echo $LOCKFILE | base64 -d > $tmpxmrigfile” wide ascii\n   $b = “/root/.tmp/xmrig –config=/root/.tmp/” wide ascii\n   $c = “if [ -s /usr/bin/curl ]; then” wide ascii\n   $d = “echo ‘found: /root/.aws/credentials'” wide ascii\n   $e = “function KILLMININGSERVICES(){” wide ascii\n   $f = “[email protected]” wide ascii\n   $g = “touch /root/.ssh/authorized_keys 2>/dev/null 1>/dev/null” wide ascii\n   $h = “rm -rf /etc/init.d/agentwatch /usr/sbin/aliyun-service” wide ascii\n   $i = “[email protected]/root/.ssh/id_ed25519.pub” wide ascii\n  condition:\n   filesize < 100KB and 1 of them\n}\n\n```\n**Monero Wallets**\n\n88ZrgnVZ687Wg8ipWyapjCVRWL8yFMRaBDrxtiPSwAQrNz5ZJBRozBSJrCYffurn1Qg7Jn7WpRQSAA3C8aidaeadAn4xi4k\n85X7JcgPpwQdZXaK2TKJb8baQAXc3zBsnW7JuY7MLi9VYSamf4bFwa7SEAK9Hgp2P53npV19w1zuaK5bft5m2NN71CmNLoh\n\n**Domain Names**\n\n6z5yegpuwg2j4len.tor2web[.]su\ndockerupdate.anondns[.]net\nteamtntisback.anondns[.]net\nsayhi.bplaced[.]net\nteamtnt[.]red\nhealthymiami[.]com (Compromised)\nrhuancarlos.inforgeneses.inf[.]br (Compromised)\n\n**IP Addresses**\n\n129.211.98[.]236\n85.214.149[.]236\n203.195.214[.]104\n\n**File-Hashes**\n\n3a377e5baf2c7095db1d7577339e4eb847ded2bfec1c176251e8b8b0b76d393f\n929c3017e6391b92b2fbce654cf7f8b0d3d222f96b5b20385059b584975a298b\n705a22f0266c382c846ee37b8cd544db1ff19980b8a627a4a4f01c1161a71cb0\n\nAbout The Author\n\n\n-----\n\nChris Doman\n\n[Chris is well known for building the popular threat intelligence portal ThreatCrowd, which subsequently merged into the AlienVault](https://www.threatcrowd.org/)\nOpen Threat Exchange, later acquired by AT&T. Chris is an industry leading threat researcher and has published a number of\nwidely read articles and papers on targeted cyber attacks. His research on topics such as the North Korean government’s cryptocurrency theft schemes, and China’s attacks [against dissident websites, have been widely discussed in the media. He has also](https://www.forbes.com/sites/daveywinder/2019/12/05/china-fires-great-cannon-cyber-weapon-at-the-hong-kong-pro-democracy-movement/#624c11297c85)\n[given interviews to print, radio and TV such as CNN and BBC News.](https://www.youtube.com/watch?v=z_0oV_hsc08)\n\n**About Cado Security**\n\nCado Security provides the cloud investigation platform that empowers security teams to respond to threats at cloud speed. By\nautomating data capture and processing across cloud and container environments, Cado Response effortlessly delivers forensiclevel detail and unprecedented context to simplify cloud investigation and response. Backed by Blossom Capital and Ten Eleven\nVentures, Cado Security has offices in the United States and United Kingdom. For more information, please visit\n[https://www.cadosecurity.com/ or follow us on Twitter](https://www.cadosecurity.com/) [@cadosecurity.](https://twitter.com/CadoSecurity)\n\n[Prev Post](https://www.cadosecurity.com/the-your-site-has-been-hacked-scam/) [Next Post](https://www.cadosecurity.com/introducing-our-next-stage-cado-response/)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2020/2020-08-17 - Team TNT – The First Crypto-Mining Worm to Steal AWS Credentials.pdf"
    ],
    "report_names": [
        "2020-08-17 - Team TNT – The First Crypto-Mining Worm to Steal AWS Credentials.pdf"
    ],
    "threat_actors": [
        {
            "id": "f809bfcb-b200-4988-80a8-be78ef6a52ef",
            "created_at": "2023-01-06T13:46:39.186988Z",
            "updated_at": "2025-03-27T02:00:03.016358Z",
            "deleted_at": null,
            "main_name": "TeamTNT",
            "aliases": [
                "Adept Libra"
            ],
            "source_name": "MISPGALAXY:TeamTNT",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "c3ca592f-0669-49bd-ab5c-310007ab2fb4",
            "created_at": "2022-10-25T15:50:23.334495Z",
            "updated_at": "2025-03-27T02:00:55.445098Z",
            "deleted_at": null,
            "main_name": "TeamTNT",
            "aliases": [
                "TeamTNT"
            ],
            "source_name": "MITRE:TeamTNT",
            "tools": [
                "Peirates",
                "MimiPenguin",
                "LaZagne",
                "Hildegard"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "3fff98c9-ad02-401d-9d4b-f78b5b634f31",
            "created_at": "2023-01-06T13:46:38.376868Z",
            "updated_at": "2025-03-27T02:00:02.818071Z",
            "deleted_at": null,
            "main_name": "Cleaver",
            "aliases": [
                "Cobalt Gypsy",
                "G0003",
                "Operation Cleaver",
                "Op Cleaver",
                "Tarh Andishan",
                "Alibaba",
                "TG-2889"
            ],
            "source_name": "MISPGALAXY:Cleaver",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "a6c351ea-01f1-4c9b-af75-cfbb3b269ed3",
            "created_at": "2023-01-06T13:46:39.390649Z",
            "updated_at": "2025-03-27T02:00:03.072899Z",
            "deleted_at": null,
            "main_name": "Kinsing",
            "aliases": [
                "Money Libra"
            ],
            "source_name": "MISPGALAXY:Kinsing",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673535602,
    "ts_updated_at": 1743041821,
    "ts_creation_date": 1653693765,
    "ts_modification_date": 1653693765,
    "files": {
        "pdf": "https://archive.orkl.eu/7d997b911c8b4aff60f2523d8c366138c303f750.pdf",
        "text": "https://archive.orkl.eu/7d997b911c8b4aff60f2523d8c366138c303f750.txt",
        "img": "https://archive.orkl.eu/7d997b911c8b4aff60f2523d8c366138c303f750.jpg"
    }
}