{
    "id": "190ffa17-d27a-4afe-9432-15b959da3d56",
    "created_at": "2023-01-12T15:04:37.089609Z",
    "updated_at": "2025-03-27T02:10:04.943715Z",
    "deleted_at": null,
    "sha1_hash": "6670cb4d389074238020fc1c1264af191b2dd42e",
    "title": "2022-04-07 - MoqHao Part 2- Continued European Expansion",
    "authors": "",
    "file_creation_date": "2022-05-28T02:44:52Z",
    "file_modification_date": "2022-05-28T02:44:52Z",
    "file_size": 703171,
    "plain_text": "# MoqHao Part 2: Continued European Expansion\n\n**[team-cymru.com/blog/2022/04/07/moqhao-part-2-continued-european-expansion/](https://team-cymru.com/blog/2022/04/07/moqhao-part-2-continued-european-expansion/)**\n\nS2 Research Team View all posts by S2 Research Team April 7, 2022\n\n**This blog is a product of ongoing collaboration with** **[@ninoseki, a Tokyo-based](https://twitter.com/ninoseki)**\n**researcher who has tracked MoqHao for several years. His public** **[GitHub contains](https://github.com/ninoseki)**\n**numerous useful OSINT threat hunting tools.**\n\n## Introduction\n\nMoqHao (also referred to as Wroba and XLoader) is a malware family commonly associated\nwith the Roaming Mantis threat actor group. MoqHao is generally used to target Android\nusers, often via an initial attack vector of phishing SMS messages (smishing).\n\nRoaming Mantis are characterized as Chinese-speaking and financially motivated. The\ngroup has historically targeted countries in the Far East – in particular Japan, South Korea\nand Taiwan.\n\n[We have previously blogged on a MoqHao campaign targeting Japan during the Golden](https://team-cymru.com/blog/2021/08/11/moqhao-part-1-5-high-level-trends-of-recent-campaigns-targeting-japan/)\nWeek holiday period in April/May 2021.\n\nIn the recent past, several vendors (e.g., [Kaspersky) have noted an expansion in Roaming](https://securelist.com/roaming-mantis-reaches-europe/105596/)\nMantis’ operations to include several European countries.\n\n.\n\n\n-----\n\n**Figure 1: Tweet by** **[@ninoseki highlighting MoqHao campaigns targeting France and](https://twitter.com/ninoseki/status/1423598216575176707)**\n**Germany (August 2021)**\n\n**In this blog we will examine open-source hints attributable to the threat actors,**\n**coupled with Team Cymru’s insights, to provide an assessment of Roaming Mantis’**\n**current target base.**\n\n## Landing Pages\n\nWhen following a malicious link distributed in a Roaming Mantis smishing campaign, users\nare directed to a landing page. These pages are tailored specifically to a target country /\nlanguage; users from other regions are presented with an error page (404 – resource not\nfound).\n\n\n-----\n\nBased on the user-agent information for the connecting device, one of two outcomes will\noccur:\n.\n\nFor Android devices, a malicious APK (MoqHao) is downloaded.\n.\nFor Apple (iOS) devices, the user is presented with a phishing page where they are\nasked to enter credentials for a spoofed entity.\n\nLanding Page Characteristics\n\nTo determine common characteristics of the infrastructure utilized for the hosting of Roaming\nMantis landing pages, 43 IP addresses, which were observed hosting these pages since the\nbeginning 2022, were analyzed. The following findings were true across all the IPs:\n.\n\nThe re-use of the same X.509 certificate (SHA1:\n834024f91f67445a7fd1a98689cb3f49b4c3ade7), hosted on TCP/443. This certificate\nhas a common name value of localhost and an alt name value which contains (at the\ntime of reporting) 335 legitimate domains, summarized as follows:\n\nSouth Korean entities, such as Naver and Daum.\nccTLDs for .kr (South Korea) and .tw (Taiwan).\n.\nThe presence of [Merlin command and control (C2) infrastructure listening on TCP/443,](https://github.com/Ne0nd0g/merlin)\n[based on the detection of a JARM fingerprint for this service](https://github.com/salesforce/jarm)\n(29d21b20d29d29d21c41d21b21b41d494e0df9532e75299f15ba73156cee38).\n.\nOpen ports; TCP/5985, TCP/10081, TCP/47001.\n.\n\nPassive scanning of TCP/10081 on the landing page hosting IPs indicated an additional\nHTTP service listening on this port. The HTML title value for this service provides useful\ninsight into victim targeting, as summarized in Table 1 below.\n\n**Landing IP** **WHOIS** **HTML Title** **Translation**\n\n142.0.136.49 PEGTECHINC, US 美国下载 US Download\n\n142.0.136.50\n\n142.0.136.52\n\n142.4.97.105\n\n142.4.97.106\n\n\n-----\n\n**Landing IP** **WHOIS** **HTML Title** **Translation**\n\n142.4.97.107\n\n142.4.97.108\n\n142.4.97.109\n\n134.119.193.106 VELIANET-AS, DE 英国下载 UK Download\n\n134.119.193.108\n\n134.119.193.109\n\n134.119.193.110\n\n192.51.188.142 HDTIDC LIMITED, HK\n\n192.51.188.145\n\n192.51.188.146\n\n27.124.36.25 BGPNET Global ASN, SG 韩国下载 South Korea Download\n\n27.124.36.27\n\n27.124.36.32\n\n27.124.36.52\n\n27.124.39.241\n\n27.124.39.242\n\n27.124.39.243\n\n192.51.188.101 HDTIDC LIMITED, HK 日本下载 Japan Download\n\n192.51.188.103\n\n192.51.188.111\n\n192.51.188.14\n\n91.204.227.111\n\n91.204.227.15\n\n91.204.227.18\n\n91.204.227.20\n\n\n-----\n\n**Landing IP** **WHOIS** **HTML Title** **Translation**\n\n91.204.227.30\n\n91.204.227.32\n\n91.204.227.40\n\n146.0.74.157 HOSTKEY-AS, NL 德国下载 Germany Download\n\n146.0.74.197\n\n146.0.74.199\n\n146.0.74.202\n\n146.0.74.203\n\n146.0.74.205\n\n146.0.74.206\n\n146.0.74.228\n\n134.119.205.21 VELIANET-AS, DE 法国下载 France Download\n\n134.119.205.22\n\n**Table 1: Insight derived from TCP/10081 on the Landing Page hosting IPs**\n\n**As can be seen, in addition to campaigns targeting France, Germany, Japan, South**\n**Korea, and the United States, infrastructure was set up for the specific targeting of**\n**UK-based users. This finding would indicate a further expansion of Roaming Mantis’**\n**operations within Europe.**\n\n## MoqHao Command & Control\n\nIn this section we will examine network telemetry relating to the connections made once the\nmalicious APK (MoqHao) is installed on a victim Android device.\n\n_By examining this stage of the attack, it is possible to identify potential victims with a higher_\n_degree of certainty. This confidence is based on the chain of events leading to this point, i.e.,_\n_a user has interacted with a link contained within an SMS message, visited a landing page,_\n_and the malicious APK has successfully been deployed on the user’s device to the point_\n_where it has begun to beacon to the C2 server._\n\n\n-----\n\nThe starting point for this part of the analysis was a MoqHao sample (SHA1:\n74558f86e4b4513f7f52d6b99b7e06d978aec97b) uploaded to VirusTotal by a user in the\nUnited Kingdom on March 16, 2022.\n\nAnalysis of this sample identified a C2 server hosted on 103.249.28.207 (EHOSTICT, KR).\nNetwork telemetry for this IP revealed a small number of connections inbound on\nTCP/28866, sourced from IP addresses assigned to UK mobile providers.\n\nIn addition, 103.249.28.207 was observed as a C2 server in what appeared to be four further\ncampaigns:\n.\n\nTCP/28866 – Spain, Turkey\n.\nTCP/29869 – South Africa\n.\nTCP/28844 – Afghanistan, Bangladesh, India, Iran, and Pakistan (South Asia)\n.\n\n**Figure 2: Victim connections to 103.249.28.207**\n\n.\nPassive scanning of 103.249.28.207 identified open TCP/3389 (commonly associated with\nthe Remote Desktop Protocol (RDP)), with a machine name of WIN-MM79JTRSTL7.\n\n\n-----\n\nAs an aside, screen captures of RDP activity on 103.249.28.207, sourced from [Shodan,](https://www.shodan.io/)\nprovided another ‘Chinese’ flag for this activity.\n\nAs recently as January 05, 2022, a remote login page was captured (associated with\nmachine name WIN-MM79JTRSTL7), which indicated Chinese language settings – the\ncharacters 密码, meaning ‘password’ in Mandarin, were displayed.\n.\n\n**Figure 3: Remote login portal for 103.249.28.207 (January 2022)**\n\n.\nThis login page was visible dating back to the end of 2020, all the time associated with the\nsame machine name (WIN-MM79JTRSTL7). A screen capture from January 22, 2020,\nindicated Korean language settings – the characters 암호, meaning ‘password’ in Korean,\nwere displayed.\n.\n\n\n-----\n\n**Figure 4: Remote login portal for 103.249.28.207 (January 2020)**\n\n.\nGiven that 103.249.28.207 is assigned to a South Korean provider (Ehost IDC), the\ninformation from Shodan may be indicative of a Chinese-speaking user accessing / utilizing\nthe machine since late 2020.\n\nA pivot on the value WIN-MM79JTRSTL7 identified a further eight IP addresses, all assigned\nto EHOSTICT, KR, which were accessed by the same machine. Network telemetry data was\nobtained for these IPs for the beginning of 2022 onwards, where MoqHao campaigns were\nidentified, they are referenced in Table 2 below\n\n**IP Address** **C2 Port** **Target Countries**\n\n103.249.28.206 37689 China, Hong Kong, Japan, Singapore, Taiwan\n\n103.249.28.208 38866, 38876 Taiwan\n\n103.249.28.209 28856 United States\n\n103.249.28.210 N/A No active campaigns\n\n61.97.248.5 28836 Turkey\n\n\n-----\n\n**IP Address** **C2 Port** **Target Countries**\n\n61.97.248.6 N/A No active campaigns\n\n61.97.248.7 N/A No active campaigns\n\n61.97.248.8 N/A No active campaigns\n\n**Table 2: Summary of MoqHao C2 servers**\n\n.\nIn the case of 103.249.28.210, samples uploaded to VirusTotal in early 2021 provide an\nindication as to when it was an active MoqHao C2. For the remaining IPs it is not clear if they\nwere previously MoqHao C2s. One possibility may be that they are being configured for\nfuture use.\n\n**Although not an exhaustive study of MoqHao C2 infrastructure, it is clear from the**\n**findings of this analysis and other findings from the community, that Roaming Mantis**\n**continue to expand their operations. What was previously considered to be a regional**\n**threat now has a global footprint.**\n\n## Indicators of Compromise\n\nMoqHao C2 Servers\n\n103.249.28.206\n\n103.249.28.207\n\n103.249.28.208\n\n103.249.28.209\n\n61.97.248.5\n\n.\n\nMoqHao Sample\n\n74558f86e4b4513f7f52d6b99b7e06d978aec97b\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-04-07 - MoqHao Part 2- Continued European Expansion.pdf"
    ],
    "report_names": [
        "2022-04-07 - MoqHao Part 2- Continued European Expansion.pdf"
    ],
    "threat_actors": [
        {
            "id": "f9bc28d0-ce98-4991-84ae-5036e5f9d4e3",
            "created_at": "2022-10-25T16:07:24.546437Z",
            "updated_at": "2025-03-27T02:02:10.277573Z",
            "deleted_at": null,
            "main_name": "Roaming Mantis",
            "aliases": [
                "Roaming Mantis Group",
                "Shaoye"
            ],
            "source_name": "ETDA:Roaming Mantis",
            "tools": [
                "MoqHao",
                "Roaming Mantis",
                "SmsSpy",
                "Wroba",
                "XLoader"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "c94cb0e9-6fa9-47e9-a286-c9c9c9b23f4a",
            "created_at": "2023-01-06T13:46:38.823793Z",
            "updated_at": "2025-03-27T02:00:02.928254Z",
            "deleted_at": null,
            "main_name": "Roaming Mantis",
            "aliases": [
                "Roaming Mantis Group"
            ],
            "source_name": "MISPGALAXY:Roaming Mantis",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673535877,
    "ts_updated_at": 1743041404,
    "ts_creation_date": 1653705892,
    "ts_modification_date": 1653705892,
    "files": {
        "pdf": "https://archive.orkl.eu/6670cb4d389074238020fc1c1264af191b2dd42e.pdf",
        "text": "https://archive.orkl.eu/6670cb4d389074238020fc1c1264af191b2dd42e.txt",
        "img": "https://archive.orkl.eu/6670cb4d389074238020fc1c1264af191b2dd42e.jpg"
    }
}