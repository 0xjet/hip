{
    "id": "45caa9fa-30f4-4d71-b571-1313bf7f5463",
    "created_at": "2023-01-12T15:09:25.992128Z",
    "updated_at": "2025-03-27T02:16:11.492129Z",
    "deleted_at": null,
    "sha1_hash": "7d3445a190492bf299a57cc1b290584402276cf6",
    "title": "2022-09-07 - Profiling DEV-0270- PHOSPHORUS’ ransomware operations",
    "authors": "",
    "file_creation_date": "2022-10-02T12:02:42Z",
    "file_modification_date": "2022-10-02T12:02:42Z",
    "file_size": 1047445,
    "plain_text": "# Profiling DEV-0270: PHOSPHORUS’ ransomware operations\n\n**[microsoft.com/security/blog/2022/09/07/profiling-dev-0270-phosphorus-ransomware-operations/](https://www.microsoft.com/security/blog/2022/09/07/profiling-dev-0270-phosphorus-ransomware-operations/)**\n\nSeptember 7, 2022\n\nMicrosoft threat intelligence teams have been tracking multiple ransomware campaigns and\nhave tied these attacks to DEV-0270, also known as Nemesis Kitten, a sub-group of Iranian\nactor PHOSPHORUS. Microsoft assesses with moderate confidence that DEV-0270\nconducts malicious network operations, including widespread vulnerability scanning, on\nbehalf of the government of Iran. However, judging from their geographic and sectoral\ntargeting, which often lacked a strategic value for the regime, we assess with low confidence\nthat some of DEV-0270’s ransomware attacks are a form of moonlighting for personal or\ncompany-specific revenue generation. This blog profiles the tactics and techniques behind\nthe DEV-0270/PHOSPHORUS ransomware campaigns. We hope this analysis, which\nMicrosoft is using to protect customers from related attacks, further exposes and disrupts the\nexpansion of DEV-0270’s operations.\n\nDEV-0270 leverages exploits for high-severity vulnerabilities to gain access to devices and is\nknown for the early adoption of newly disclosed vulnerabilities. DEV-0270 also extensively\nuses living-off-the-land binaries (LOLBINs) throughout the attack chain for discovery and\n\n\n-----\n\ncredential access. This extends to its abuse of the built-in BitLocker tool to encrypt files on\ncompromised devices.\n\nIn some instances where encryption was successful, the time to ransom (TTR) between\ninitial access and the ransom note was around two days. The group has been observed\ndemanding USD 8,000 for decryption keys. In addition, the actor has been observed\npursuing other avenues to generate income through their operations. In one attack, a victim\norganization refused to pay the ransom, so the actor opted to post the stolen data from the\norganization for sale packaged in an SQL database dump.\n\nUsing these observations, this blog details the group’s tactics and techniques across its endto-end attack chain to help defenders identify, investigate, and mitigate attacks. We also\nprovide extensive hunting queries designed to surface stealthy attacks. This blog also\nincludes protection and hardening guidance to help organizations increase resilience against\nthese and similar attacks.\n\nFigure 1. Typical DEV-0270 attack chain\n\n## Who is DEV-0270?\n\nMicrosoft assesses that DEV-0270 is operated by a company that functions under two public\naliases: Secnerd (secnerd[.]ir) and Lifeweb (lifeweb[.]ir). We have observed numerous\ninfrastructure overlaps between DEV-0270 and Secnerd/Lifeweb. These organizations are\nalso linked to Najee Technology Hooshmand (ناجی تکنولوژی هوشمند), located in Karaj, Iran.\n\nThe group is typically opportunistic in its targeting: the actor scans the internet to find\nvulnerable servers and devices, making organizations with vulnerable and discoverable\nservers and devices susceptible to these attacks.\n\nAs with any observed nation state actor activity, Microsoft directly notifies customers that\nhave been targeted or compromised, providing them with the information they need to\nsecure their accounts. Microsoft uses DEV-#### designations as a temporary name given to\nan unknown, emerging, or a developing cluster of threat activity, allowing Microsoft Threat\n\n\n-----\n\nIntelligence Center (MSTIC) to track it as a unique set of information until we reach a high\nconfidence about the origin or identity of the actor behind the activity. Once it meets the\ncriteria, a DEV is converted to a named actor.\n\n## Observed actor activity\n\n### Initial access\n\nIn many of the observed DEV-0270 instances, the actor gained access by exploiting known\nvulnerabilities in Exchange or Fortinet (CVE-2018-13379). For Exchange, the most prevalent\nexploit has been ProxyLogon—this highlights the need to patch high-severity vulnerabilities\nin internet-facing devices, as the group has continued to successfully exploit these\nvulnerabilities even recently, well after updates supplied the fixes. While there have been\n[indications that DEV-0270 attempted to exploit Log4j 2 vulnerabilities, Microsoft has not](https://www.microsoft.com/security/blog/2021/12/11/guidance-for-preventing-detecting-and-hunting-for-cve-2021-44228-log4j-2-exploitation/)\nobserved this activity used against customers to deploy ransomware.\n\n### Discovery\n\nUpon gaining access to an organization, DEV-0270 performs a series of discovery\n[commands to learn more about the environment. The command wmic computersystem get](https://docs.microsoft.com/windows/win32/wmisdk/wmic)\n_domain obtains the target’s domain name. The whoami command displays user information_\nand net user command is used to add or modify user accounts. For more information on the\naccounts created and common password phrases DEV-0270 used, refer to the Advanced\nHunting section.\n\nwmic computersystem get domain\nwhoami\nnet user\n\nOn the compromised Exchange server, the actor used the following command to understand\nthe target environment.\n```\nGet-Recipient | Select Name -ExpandProperty EmailAddresses -first 1 | Select\nSmtpAddress | ft -hidetableheaders\n\n```\nFor discovery of domain controllers, the actor used the following PowerShell and WMI\ncommand.\n\n### Credential access\n\n\n-----\n\nDEV-0270 often opts for a particular method using a LOLBin to conduct their credential theft,\nas this removes the need to drop common credential theft tools more likely to be detected\nand blocked by antivirus and endpoint detection and response (EDR) solutions. This process\nstarts by enabling WDigest in the registry, which results in passwords stored in cleartext on\nthe device and saves the actor time by not having to crack a password hash.\n```\n\"reg\" add HKLM\\SYSTEM\\CurrentControlSet\\Control\\SecurityProviders\\WDigest /v\nUseLogonCredential /t REG_DWORD /d 1 /f\n\n```\nThe actor then uses rundll32.exe and comsvcs.dll with its built-in MiniDump function to dump\npasswords from LSASS into a dump file. The command to accomplish this often specifies the\noutput to save the passwords from LSASS. The file name is also reversed to evade\ndetections (ssasl.dmp):\n\n### Persistence\n\nTo maintain access in a compromised network, the DEV-0270 actor adds or creates a new\nuser account, frequently named DefaultAccount with a password of P@ssw0rd1234, to the\ndevice using the command net user /add. The DefaultAccount account is typically a preexisting account set up but not enabled on most Windows systems.\n\nThe attacker then modifies the registry to allow remote desktop (RDP) connections for the\ndevice, adds a rule in the firewall using netsh.exe to allow RDP connections, and adds the\nuser to the remote desktop users group:\n```\n\"reg\" add \"HKLM\\SYSTEM\\CurrentControlSet\\Control\\Terminal Server\" /v TSEnabled /t\nREG_DWORD /d 1 /f\n\"reg\" add \"HKLM\\SYSTEM\\CurrentControlSet\\Control\\Terminal Server\" /v\nfDenyTSConnections /t REG_DWORD /d 0\n\"reg\" add \"HKLM\\SYSTEM\\CurrentControlSet\\Control\\Terminal Server\\WinStations\\RDP-Tcp\"\n/v UserAuthentication /t REG_DWORD\n\"netsh\" advfirewall firewall add rule name=\"Terminal Server\" dir=in action=allow\nprotocol=TCP localport=3389\n\n```\nScheduled tasks are one of the recurrent methods used by DEV-0270 in their attacks to\nmaintain access to a device. Generally, the tasks load via an XML file and are configured to\nrun on boot with the least privilege to launch a .bat via the command prompt. The batch file\nresults in a download of a renamed dllhost.exe, a reverse proxy, for maintaining control of\nthe device even if the organization removes the file from the device\n\n\n-----\n\n-----\n\nFigure 2. Scheduled task used in DEV-0270 attacks\n\n### Privilege escalation\n\nDEV-0270 can usually obtain initial access with administrator or system-level privileges by\ninjecting their web shell into a privileged process on a vulnerable web server. When the\ngroup uses Impacket’s WMIExec to move to other systems on the network laterally, they are\ntypically already using a privileged account to run remote commands. DEV-0270 also\ncommonly dumps LSASS, as mentioned in the credential access section, to obtain local\nsystem credentials and masquerade as other local accounts which might have extended\nprivileges.\n\nAnother form of privilege escalation used by DEV-0270 involves the creation or activation of\na user account to provide it with administrator privileges. DEV-0270 uses powershell.exe and\n_net.exe commands to create or enable this account and add it to the administrators’ group_\nfor higher privileges.\n\n### Defense evasion\n\nDEV-0270 uses a handful of defensive evasion techniques to avoid detection. The threat\nactors typically turn off Microsoft Defender Antivirus real-time protection to prevent Microsoft\nDefender Antivirus from blocking the execution of their custom binaries. The threat group\ncreates or activates the DefaultAccount account to add it to the Administrators and Remote\nDesktop Users groups. The modification of the DefaultAccount provides the threat actor\ngroup with a legitimate pre-existing account with nonstandard, higher privileges. DEV-0270\nalso uses powershell.exe to load their custom root certificate to the local certificate database.\nThis custom certificate is spoofed to appear as a legitimate Microsoft-signed certificate.\nHowever, Windows flags the spoofed certificate as invalid due to the unverified certificate\nsigning chain. This certificate allows the group to encrypt their malicious communications to\nblend in with other legitimate traffic on the network.\n\nAdditionally, DEV-0270 heavily uses native LOLBins to effectively avoid detection. The threat\ngroup commonly uses native WMI, net, CMD, and PowerShell commands and registry\nconfigurations to maintain stealth and operational security. They also install and masquerade\ntheir custom binaries as legitimate processes to hide their presence. Some of the legitimate\nprocesses they masquerade their tools as include: dllhost.exe, task_update.exe, user.exe,\nand CacheTask. Using .bat files and powershell.exe, DEV-0270 might terminate existing\nlegitimate processes, run their binary with the same process name, and then configure\nscheduled tasks to ensure the persistence of their custom binaries.\n\n### Lateral movement\n\n\n-----\n\nDEV-0270 has been seen creating defaultaccount and adding that account to the Remote\nDesktop Users group. The group uses the RDP connection to move laterally, copy tools to\nthe target device, and perform encryption.\n\nAlong with RDP, [Impacket’s WMIExec is a known toolkit used by the group for lateral](https://github.com/SecureAuthCorp/impacket/)\nmovement. In multiple compromises, this was the main method observed for them to pivot to\nadditional devices in the organization, execute commands to find additional high-value\ntargets, and dump credentials for escalating privileges.\n\nAn example of a command using Impacket’s WMIExec from a remote device:\n```\ncmd.exe /Q /c quser 1> \\\\127.0.0.1\\ADMIN$\\__1657130354.2207212 2>&1\n\n### Impact\n\n```\nDEV-0270 has been seen using setup.bat commands to enable BitLocker encryption, which\nleads to the hosts becoming inoperable. For workstations, the group uses DiskCryptor, an\nopen-source full disk encryption system for Windows that allows for the encryption of a\ndevice’s entire hard drive. The group drops DiskCryptor from an RDP session and when it is\nlaunched, begins the encryption. This method does require a reboot to install and another\nreboot to lock out access to the workstation.\n\nThe following are DEV-0270’s PowerShell commands using BitLocker:\n\nMicrosoft will continue to monitor DEV-0270 and PHOSPHORUS activity and implement\nprotections for our customers. The current detections, advanced detections, and IOCs in\nplace across our security products are detailed below.\n\n\n-----\n\n## Recommended mitigation steps\n\nThe techniques used by DEV-0270 can be mitigated through the following actions:\n\n[Apply the corresponding security updates for Exchange Server, including applicable](https://msrc.microsoft.com/update-guide/releaseNote/2021-Mar)\nfixes for [CVE-2021-26855,](https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-26855) [CVE-2021-26858,](https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-26858) [CVE-2021-26857 and](https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-26857) [CVE-2021-27065.](https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-27065)\nWhile it is important to prioritize patching of internet-facing Exchange servers to\nmitigate risk in an ordered manner, unpatched internal Exchange Server instances\nshould also be addressed as soon as possible.\n\nFor Exchange Server instances in Mainstream Support, critical product updates\nare released for the most recently released Cumulative Updates (CU) and for the\nprevious CU. For Exchange Server instances in Extended Support, critical\nproduct updates are released for the most recently released CU only.\nIf you don’t have a supported CU, Microsoft is producing an additional series of\nsecurity updates (SUs) that can be applied to some older and unsupported CUs\nto help customers more quickly protect their environment. For information on\nthese updates, see March 2021 Exchange Server Security Updates for older\nCumulative Updates of Exchange Server.\nInstalling the updates is the only complete mitigation for these vulnerabilities and\nhas no impact on functionality. If the threat actor has exploited these\nvulnerabilities to install malware, installing the updates does not remove\nimplanted malware or evict the actor.\nUse [Microsoft Defender Firewall, intrusion prevention devices, and your network](https://support.microsoft.com/windows/turn-microsoft-defender-firewall-on-or-off-ec0844f7-aebd-0583-67fe-601ecf5d774f)\nfirewall to prevent RPC and SMB communication among devices whenever possible.\nThis limits lateral movement and other attack activities.\nCheck your perimeter firewall and proxy to restrict or prevent network appliances like\nFortinet SSL VPN devices from making arbitrary connections to the internet to browse\nor download files.\n[Enforce strong local administrator passwords. Use tools like LAPS.](https://docs.microsoft.com/previous-versions/mt227395(v=msdn.10)?redirectedfrom=MSDN)\nEnsure that [Microsoft Defender Antivirus is up to date and that real-time behavior](https://docs.microsoft.com/microsoft-365/security/defender-endpoint/microsoft-defender-antivirus-windows?view=o365-worldwide)\nmonitoring is enabled.\nKeep backups so you can recover data affected by destructive attacks. Use controlled\nfolder access to prevent unauthorized applications from modifying protected files.\n[Turn on the following attack surface reduction rules to block or audit activity associated](https://docs.microsoft.com/windows/security/threat-protection/microsoft-defender-atp/attack-surface-reduction)\nwith this threat:\n\nBlock credential stealing from the Windows local security authority subsystem\n(lsass.exe)\nBlock process creations originating from PsExec and WMI commands\nBlock persistence through WMI event subscription. Ensure that Microsoft\nDefender for Endpoint is up to date and that real-time behavior monitoring is\nenabled\n\n\n-----\n\n## Detection details\n\n### Microsoft Defender for Endpoint\n\nAlerts with the following titles in the security center can indicate threat activity on your\nnetwork:\n\nMalware associated with DEV-0270 activity group detected\n\nThe following additional alerts may also indicate activity associated with this threat. These\nalerts, however, can be triggered by unrelated threat activity and are not monitored in the\nstatus cards provided with this report.\n\n\nA script with suspicious content was\nobserved\n\n\nSuspicious file dropped by Exchange Server\nprocess\n\n\nA suspicious file was observed Suspicious Modify Registry\n\n\nAnomalous behavior by a common\nexecutable\n\n\nSuspicious Permission Groups Discovery\n\n\nLazagne post-exploitation tool Suspicious PowerShell command line\n\nLocal Emails Collected Suspicious PowerShell download or encoded\ncommand execution\n\nMimikatz credential theft tool Suspicious Process Discovery\n\n\n‘Mimilove’ high-severity malware was\nprevented\n\n\nSuspicious process executed PowerShell\ncommand\n\n\nNew group added suspiciously Suspicious process launched using dllhost.exe\n\n\nOngoing hands-on-keyboard attack via\nImpacket toolkit\n\nPossible Antimalware Scan Interface\n(AMSI) tampering\n\nPossible attempt to discover groups and\npermissions\n\nPossible exploitation of Exchange\nServer vulnerabilities\n\nPossible exploitation of ProxyShell\nvulnerabilities\n\n\nSuspicious ‘PShellCobStager’ behavior was\nblocked\n\nSuspicious Scheduled Task Process Launched\n\nSuspicious sequence of exploration activities\n\nSuspicious ‘SuspExchgSession’ behavior was\nblocked\n\nSuspicious System Network Configuration\nDiscovery\n\n\nPossible web shell installation Suspicious System Owner/User Discovery\n\n\n-----\n\nProcess memory dump Suspicious Task Scheduler activity\n\n\nSuspicious Account Discovery: Email\nAccount\n\nSuspicious behavior by cmd.exe was\nobserved\n\nSuspicious behavior by svchost.exe\nwas observed\n\nSuspicious behavior by Web server\nprocess\n\n\nSuspicious User Account Discovery\n\nSuspicious user password change\n\nSuspicious w3wp.exe activity in Exchange\n\nSystem file masquerade\n\nTampering with the Microsoft Defender for\nEndpoint sensor\n\n\nSuspicious Create Account Unusual sequence of failed logons\n\nSuspicious file dropped WDigest configuration change\n\n## Hunting queries\n\n### Microsoft Sentinel\n\nMicrosoft Sentinel customers can use the following queries to look for the related malicious\nactivity in their environments.\n\n**DEV-0270 registry IOC**\n\nThis query identifies modification of registry by DEV-0270 actor to disable security feature as\nwell as to add ransom notes:\n\nhttps://github.com/Azure/Azure[Sentinel/blob/master/Detections/MultipleDataSources/Dev-](https://github.com/Azure/Azure-Sentinel/blob/master/Detections/MultipleDataSources/Dev-0270RegistryIOCSep2022.yaml)\n0270RegistryIOCSep2022.yaml\n\n**DEV-0270 malicious PowerShell usage**\n\nDEV-0270 heavily uses PowerShell to achieve their objective at various stages of their\nattack. This query locates PowerShell activity tied to the actor:\n\nhttps://github.com/Azure/Azure[Sentinel/blob/master/Detections/MultipleDataSources/Dev-](https://github.com/Azure/Azure-Sentinel/blob/master/Detections/MultipleDataSources/Dev-0270PowershellSep2022.yaml)\n0270PowershellSep2022.yaml\n\n**DEV-0270 WMIC discovery**\n\nThis query identifies dllhost.exe using WMIC to discover additional hosts and associated\ndomains in the environment:\n\n\n-----\n\nhttps://github.com/Azure/Azure[Sentinel/blob/master/Detections/MultipleDataSources/Dev-](https://github.com/Azure/Azure-Sentinel/blob/master/Detections/MultipleDataSources/Dev-0270WMICDiscoverySep2022.yaml)\n0270WMICDiscoverySep2022.yaml\n\n**DEV-0270 new user creation**\n\nThis query tries to detect creation of a new user using a known DEV-0270\nusername/password schema:\n\nhttps://github.com/Azure/Azure[Sentinel/blob/master/Detections/MultipleDataSources/Dev-](https://github.com/Azure/Azure-Sentinel/blob/master/Detections/MultipleDataSources/Dev-0270NewUserSep2022.yaml)\n0270NewUserSep2022.yaml\n\n### Microsoft 365 Defender\n\nTo locate possible actor activity, run the following queries.\n\n**Disable services via registry**\n\n[Search for processes modifying the registry to disable security features. GitHub link](https://github.com/Azure/Azure-Sentinel/blob/master/Hunting%20Queries/Microsoft%20365%20Defender/Ransomware/DEV-0270/Disabling%20Services%20via%20Registry.yaml)\n```\nDeviceProcessEvents\n\n| where InitiatingProcessCommandLine has_all(@’”reg”’, ‘add’,\n@’”HKLM\\SOFTWARE\\Policies\\’, ‘/v’,’/t’, ‘REG_DWORD’, ‘/d’, ‘/f’)\n\n  and InitiatingProcessCommandLine has_any(‘DisableRealtimeMonitoring’,\n‘UseTPMKey’, ‘UseTPMKeyPIN’, ‘UseAdvancedStartup’, ‘EnableBDEWithNoTPM’,\n‘RecoveryKeyMessageSource’)\n\n```\n**Modifying the registry to add a ransom message notification**\n\nIdentify registry modifications that are indicative of a ransom note tied to DEV-0270. GitHub\nlink\n```\nDeviceProcessEvents\n\n| where InitiatingProcessCommandLine has_all(‘”reg”’, ‘add’,\n@’”HKLM\\SOFTWARE\\Policies\\’, ‘/v’,’/t’, ‘REG_DWORD’, ‘/d’, ‘/f’,\n‘RecoveryKeyMessage’, ‘Your drives are Encrypted!’, ‘@’)\n\n```\n**DLLHost.exe file creation via PowerShell**\n\n[Identify masqueraded DLLHost.exe file created by PowerShell. GitHub link](https://github.com/Azure/Azure-Sentinel/blob/master/Hunting%20Queries/Microsoft%20365%20Defender/Ransomware/DEV-0270/DLLHost.exe%20file%20creation%20via%20PowerShell.yaml)\n```\nDeviceProcessEvents\n\n| where InitiatingProcessFileName =~ ‘powershell.exe’\n\n| where InitiatingProcessCommandLine has_all(‘$file=’, ‘dllhost.exe’, ‘InvokeWebRequest’, ‘-OutFile’)\n\n```\n**Add malicious user to Admins and RDP users group via PowerShell**\n\n[Look for adding a user to Administrators in remote desktop users via PowerShell. GitHub link](https://github.com/Azure/Azure-Sentinel/blob/master/Hunting%20Queries/Microsoft%20365%20Defender/Ransomware/DEV-0270/Add%20malicious%20user%20to%20Admins%20and%20RDP%20users%20group%20via%20PowerShell.yaml)\n\n\n-----\n\n```\nDeviceProcessEvents\n\n| where InitiatingProcessFileName =~ 'powershell.exe'\n\n| where InitiatingProcessCommandLine has_all('$admins=',\n'System.Security.Principal.SecurityIdentifier', 'Translate', '-split', 'localgroup',\n'/add', '$rdp=')\n\n```\n**Email data exfiltration via PowerShell**\n\n[Identify email exfiltration conducted by PowerShell. GitHub link](https://github.com/Azure/Azure-Sentinel/blob/master/Hunting%20Queries/Microsoft%20365%20Defender/Ransomware/DEV-0270/Email%20data%20exfiltration%20via%20PowerShell.yaml)\n```\nDeviceProcessEvents\n\n| where FileName =~ 'powershell.exe'\n\n| where ProcessCommandLine has_all('Add-PSSnapin', 'Get-Recipient', 'ExpandProperty', 'EmailAddresses', 'SmtpAddress', '-hidetableheaders')\n\n```\n**Create new user with known DEV-0270 username/password**\n\nSearch for the creation of a new user using a known DEV-0270 username/password\nschema. [GitHub link](https://github.com/Azure/Azure-Sentinel/blob/master/Hunting%20Queries/Microsoft%20365%20Defender/Ransomware/DEV-0270/Create%20new%20user%20with%20known%20DEV-0270%20username%20and%20password.yaml)\n```\nDeviceProcessEvents\n\n| where InitiatingProcessCommandLine has_all('net user', '/add')\n\n| parse InitiatingProcessCommandLine with * \"user \" username \" \"*\n\n| extend password = extract(@\"\\buser\\s+[^\\s]+\\s+([^\\s]+)\", 1,\nInitiatingProcessCommandLine)\n\n| where username in('DefaultAccount') or password in('P@ssw0rd1234', '_AS_@1394')\n\n```\n**PowerShell adding exclusion path for Microsoft Defender of ProgramData**\n\nIdentify PowerShell creating an exclusion path of ProgramData directory for Microsoft\nDefender to not monitor. [GitHub link](https://github.com/Azure/Azure-Sentinel/blob/master/Hunting%20Queries/Microsoft%20365%20Defender/Ransomware/DEV-0270/PowerShell%20adding%20exclusion%20path%20for%20Microsoft%20Defender%20of%20ProgramData.yaml)\n```\nDeviceProcessEvents\n\n| where FileName =~ \"powershell.exe\" and ProcessCommandLine has_all(\"try\", \"AddMpPreference\", \"-ExclusionPath\", \"ProgramData\", \"catch\")\n\n\n```\n**DLLHost.exe WMIC domain discovery**\n\nIdentify dllhost.exe using WMIC to discover additional hosts and associated domain. GitHub\nlink\n```\nDeviceProcessEvents\n\n| where InitiatingProcessFileName =~ \"dllhost.exe\" and InitiatingProcessCommandLine\n== \"dllhost.exe\"\n\n| where ProcessCommandLine has \"wmic computersystem get domain\"\n\n```\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-09-07 - Profiling DEV-0270- PHOSPHORUS’ ransomware operations.pdf"
    ],
    "report_names": [
        "2022-09-07 - Profiling DEV-0270- PHOSPHORUS’ ransomware operations.pdf"
    ],
    "threat_actors": [
        {
            "id": "6b4a82e8-21f1-4bc7-84cf-e27334998b48",
            "created_at": "2022-10-25T16:07:23.84296Z",
            "updated_at": "2025-03-27T02:02:09.997164Z",
            "deleted_at": null,
            "main_name": "DEV-0270",
            "aliases": [
                "DEV-0270",
                "DireFate",
                "Lord Nemesis",
                "Nemesis Kitten",
                "Yellow Dev 23",
                "Yellow Dev 24"
            ],
            "source_name": "ETDA:DEV-0270",
            "tools": [
                "Impacket",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "WmiExec"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "eaef3218-1f8c-4767-b1ff-da7a6662acc0",
            "created_at": "2023-03-04T02:01:54.110909Z",
            "updated_at": "2025-03-27T02:00:03.124083Z",
            "deleted_at": null,
            "main_name": "DEV-0270",
            "aliases": [
                "Nemesis Kitten",
                "Storm-0270"
            ],
            "source_name": "MISPGALAXY:DEV-0270",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "d8af157e-741b-4933-bb4a-b78490951d97",
            "created_at": "2023-01-06T13:46:38.748929Z",
            "updated_at": "2025-03-27T02:00:02.908256Z",
            "deleted_at": null,
            "main_name": "APT35",
            "aliases": [
                "Newscaster Team",
                "Magic Hound",
                "G0059",
                "Phosphorus",
                "Mint Sandstorm",
                "TunnelVision",
                "COBALT MIRAGE"
            ],
            "source_name": "MISPGALAXY:APT35",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "04888f75-158b-47f9-8ad9-4ff83f618ece",
            "created_at": "2024-05-01T02:03:08.03763Z",
            "updated_at": "2025-03-27T02:05:17.319276Z",
            "deleted_at": null,
            "main_name": "COBALT MIRAGE",
            "aliases": [
                "Nemesis Kitten ",
                "PHOSPHORUS ",
                "TunnelVision ",
                "UNC2448 ",
                "DEV-0270 "
            ],
            "source_name": "Secureworks:COBALT MIRAGE",
            "tools": [
                " Custom powershell scripts",
                " DiskCryptor",
                " Drokbk",
                " FRPC",
                " Fast Reverse Proxy (FRP)",
                " Impacket wmiexec",
                " Ngrok",
                " Plink",
                " PowerLessCLR",
                " TunnelFish",
                "BitLocker"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "e3676dfe-3d40-4b3a-bfbd-4fc1f8c896f4",
            "created_at": "2022-10-25T15:50:23.808974Z",
            "updated_at": "2025-03-27T02:00:55.550912Z",
            "deleted_at": null,
            "main_name": "Magic Hound",
            "aliases": [
                "Magic Hound",
                "TA453",
                "COBALT ILLUSION",
                "Charming Kitten",
                "ITG18",
                "Phosphorus",
                "APT35",
                "Mint Sandstorm"
            ],
            "source_name": "MITRE:Magic Hound",
            "tools": [
                "Impacket",
                "CharmPower",
                "FRP",
                "Mimikatz",
                "Systeminfo",
                "ipconfig",
                "netsh",
                "PowerLess",
                "Pupy",
                "DownPaper",
                "PsExec",
                "Havij",
                "sqlmap"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "1699fb41-b83f-42ff-a6ec-984ae4a1031f",
            "created_at": "2022-10-25T16:07:23.83826Z",
            "updated_at": "2025-03-27T02:02:09.995863Z",
            "deleted_at": null,
            "main_name": "Magic Hound",
            "aliases": [
                "APT 35",
                "Ballistic Bobcat",
                "Charming Kitten",
                "CharmingCypress",
                "Cobalt Illusion",
                "Cobalt Mirage",
                "Educated Manticore",
                "Magic Hound",
                "Mint Sandstorm",
                "Operation BadBlood",
                "Operation Sponsoring Access",
                "Operation SpoofedScholars",
                "Operation Thamar Reservoir",
                "Phosphorus",
                "TA453",
                "TEMP.Beanie",
                "Tarh Andishan",
                "Timberworm",
                "TunnelVision",
                "UNC788",
                "Yellow Garuda"
            ],
            "source_name": "ETDA:Magic Hound",
            "tools": [
                "7-Zip",
                "AnvilEcho",
                "BASICSTAR",
                "CORRUPT KITTEN",
                "CWoolger",
                "CharmPower",
                "ChromeHistoryView",
                "CommandCam",
                "DistTrack",
                "DownPaper",
                "FRP",
                "Fast Reverse Proxy",
                "FireMalv",
                "Ghambar",
                "GoProxy",
                "GorjolEcho",
                "HYPERSCRAPE",
                "Havij",
                "MPK",
                "MPKBot",
                "Matryoshka",
                "Matryoshka RAT",
                "MediaPl",
                "Mimikatz",
                "MischiefTut",
                "NETWoolger",
                "NOKNOK",
                "PINEFLOWER",
                "POWERSTAR",
                "PowerLess Backdoor",
                "PsList",
                "Pupy",
                "PupyRAT",
                "SNAILPROXY",
                "Shamoon",
                "TDTESS",
                "WinRAR",
                "WoolenLogger",
                "Woolger",
                "pupy",
                "sqlmap"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673536165,
    "ts_updated_at": 1743041771,
    "ts_creation_date": 1664712162,
    "ts_modification_date": 1664712162,
    "files": {
        "pdf": "https://archive.orkl.eu/7d3445a190492bf299a57cc1b290584402276cf6.pdf",
        "text": "https://archive.orkl.eu/7d3445a190492bf299a57cc1b290584402276cf6.txt",
        "img": "https://archive.orkl.eu/7d3445a190492bf299a57cc1b290584402276cf6.jpg"
    }
}