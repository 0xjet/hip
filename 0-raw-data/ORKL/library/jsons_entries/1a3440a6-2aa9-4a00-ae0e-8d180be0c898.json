{
    "id": "1a3440a6-2aa9-4a00-ae0e-8d180be0c898",
    "created_at": "2023-01-12T15:07:01.582024Z",
    "updated_at": "2025-03-27T02:16:25.859743Z",
    "deleted_at": null,
    "sha1_hash": "2790454a890d09550b6b329e25c8ba9adc1fc85b",
    "title": "2021-12-03 - Mobile banking fraud- BRATA strikes again",
    "authors": "",
    "file_creation_date": "2022-05-27T22:51:54Z",
    "file_modification_date": "2022-05-27T22:51:54Z",
    "file_size": 3347451,
    "plain_text": "# Mobile banking fraud: BRATA strikes again\n\n**[cleafy.com/cleafy-labs/mobile-banking-fraud-brata-strikes-again](https://www.cleafy.com/cleafy-labs/mobile-banking-fraud-brata-strikes-again)**\n\nFederica Abbinante, Francesco Iubatti\n\n## Download your PDF guide to TeaBot \n\nGet your free copy to your inbox now\n\nDownload PDF Version\n\n## Executive Summary\n\nIn the past year, we observed in the Cleafy platform a spike of Android RAT infections\ncaused by the increase of Android Banking Trojan used to perform fraudulent activities,\nusually combined with smishing and social engineering attack patterns. Simultaneously, we\nnoticed a decrease in SIM swap attacks, possibly related to the fact that they are less\nscalable than the widely used malware as a service (MaaS) pattern.\n\nWhat makes Android RAT so interesting for attackers is its capability to operate directly on\nthe victim devices instead of using a new device. By doing so, Threat Actors (TAs) can\ndrastically reduce the possibility of being flagged \"as suspicious\", since the device's\nfingerprinting is already known to the bank.\n\nIn this report, we analyze the attack chain and the modus operandi used by Threat Actors,\nfrom the sending of the malicious SMS to the fraudulent transaction carried out through an\napp installed in the infected device.\n\n\n-----\n\nMoreover, we highlight the main indicators to explain the attack chain used by these TAs:\n\nThe malware campaign targets mainly one of the biggest Italian retail banks as well as\nother minor banks. However, we don't exclude that other local TAs might be using the\nsame attack vector (BRATA) to carry over other malicious activities in other countries.\nSmishing and phishing attacks are used to distribute malicious apps and credentials\nharvesting.\nA new version of the BRATA malware is used to infect the device of the victims.\nA combination of both social engineering techniques and the complete control of the\ninfected device is used by TAs to perform fraudulent transactions.\n\nFigure 1 - BRATA distribution and modus operandi\n\n## Introduction\n\nAt the end of June 2021, the Cleafy Threat Intelligence and Incident Response team\nintercepted for the first time a new aggressive smishing campaign that was delivering\nmultiple fake applications called “Sicurezza Dispositivo'' (or “AntiSPAM”'). The campaign\ntargeted the customers of one of the biggest Italian retail banks.\n\n\n-----\n\nFigure 2 - Some BRATA samples and related occurrences\n\nAfter the first wave, lasted from June to mid-September, the attack stopped for about a\nmonth. In mid-October, our TIR team discovered that new samples called “Sicurezza\n**Avanzata” were again in action and were targeting mainly the customers of three Italian**\nbanks. This time the malware was almost undetectable by antivirus solutions (as shown in\nFigure 3).\n\n\n-----\n\nFigure 3 - Difference between two BRATA samples detected by antivirus solutions\n\n## How the BRATA malware works\n\nIn June 2021, for the first time we detected on Cleafy’s dashboards a new variant of BRATA\nmalware. After a couple of weeks, a customer reported to us some incidents related to the\nsame campaign.\n\nFigure 4 - Example of BRATA malware intercepted and blacklisted in Cleafy console\nThanks to an in-depth technical analysis of the Indicators of Compromise intercepted, we\nwere able to reconstruct the detailed chain of events and the methodologies used by these\nThreat Actors to conduct bank frauds.\n\n\n-----\n\nThe attack chain usually starts with a fake SMS containing a link to a website. The SMS\nseems to come from the bank (the so-called spoofing scam), and it tries to convince the\nvictim to download an anti-spam app, with the promise to be contacted soon by a bank\noperator.\n\nFigure 5 - Example of one of the SMS received from the victim\nIn some cases, the link redirects the victim to a phishing page that looks like the bank’s, and\nit is used to steal credentials and other relevant information (e.g. fiscal code and security\nquestions).\n\nFigure 6 - Phishing kit used by TAs to deliver BRATA and for credential harvesting\n\n\n-----\n\nFigure 7 - Example of information stolen by BRATA group\nAfter the victim visits the website (only visible via mobile[1]) and downloads the malicious\napp, a fraud operator calls the victim and uses social engineering techniques to persuade the\nuser to install the malicious app.\n\n\n-----\n\nFigure 8 - Example of website used to spread BRATA malware in Italy\nDuring the installation phases of the malware (Figure 9), multiple permissions are required to\nallow the attackers to perform fraudulent activities.\n\n\n-----\n\nOnce the malicious app is installed, the fraud operators can take control of the victim infected\ndevices thanks to the abuse of the Accessibility services, the SMS permission, and the\nrecording/casting module of the malware.\n\nFigure 9 - Installation phase of BRATA malware on Android device\nThrough the malware installed on the victim device, Threat Actors can receive on their server\nthe 2FA code sent by the bank and perform fraudulent transactions. Therefore, as we\nobserved also in other scenarios, with the abuse of Accessibility Service and the screen\nrecording, TAs can perform actions on the infected device with the help of social engineering\nused to persuade the victim.\n\n\n-----\n\nFigure 10 - Example of fraud transactions performed by TAs inside the infected device\nAs shown in Figure 11, we also intercepted multiple attempts of pin/otp validations stolen by\nTAs through the malicious app (or phishing website). This specific pattern was observed also\nin other past campaigns of mobile and workstation malware.\n\nFigure 11 - Attempt to use stolen credentials intercepted in Cleafy Console\nThe mule accounts used by the BRATA malware campaign mainly come from Italy, as well\nas from Lithuania and the Netherlands, as shown in Figure 12. From this information, we\nassume that the TAs behind these campaigns could come from European countries unlike\nthe previous BRATA malware campaign observed in Brazil in 2019.\n\n\n-----\n\nFigure 12 - Distribution of mule used by BRATA campaign\n\n[1] TAs used a legitimate open source project (https://github.com/serbanghita/Mobile-Detect)\nto detect if the website is opened with a mobile phone or a PC.\n\n## BRATA main functionalities and capabilities\n\nBy analyzing the code of the malicious apps, it was possible to trace back the threat to the\nBRATA malware, a Brazilian malware discovered in 2019. However, these new samples\npresent multiple differences compared to the previous one.\n\nSeveral Portuguese/Brazilian logs embedded in the malicious app are shown to the victim in\nItalian. Our assumption is that, perhaps, the group responsible for maintaining the BRATA\ncodebase, probably located in the LATAM area, is reselling this malware to other local\ngroups. As a result, this threat is gradually expanding in several European countries.\n\n\n-----\n\nFigure 13 - Some BRATA logs (on the left) and a screen with Italian text (on the right)\n[Like other Android bankers previously appeared online (e.g., Teabot[2], Alien, Oscorp[3],](https://www.cleafy.com/cleafy-labs/teabot)\netc.), this version of BRATA has RAT capabilities. The main difference resides in the\n[implementation used to develop the malware: TAs used the b4a framework[4], already used](https://www.b4x.com/b4a.html)\nby another Brazilian banker in 2019, called BasBanker. One of the reasons behind this\nchoice is the possibility to import modules already designed by other developers. This\ncharacteristic may allow the TAs to speed up the implementation of new features or the\nmalware itself.\n\nFigure 14 - List of commands used by BRATA malware\nThe main functionalities of this new version of BRATA are not very different from other\n“famous” banking trojan:\n\nIntercept SMS messages and forward them to a C2 server. This feature is used to get\n2FA sent by the bank via SMS during the login phase or to confirm money transactions.\nScreen recording and casting capabilities that allow the malware to capture any\nsensitive information displayed on the screen. This includes audio, passwords,\npayment information, photo, and messages (as shown in Figure 15). Through the\nAccessibility Service, the malware clicks the “start now” button (of the popup)\nautomatically, so the victim is not able to deny the recording/casting of the owned\ndevice.\nRemove itself from the compromised device to reduce detection.\nUninstall specific applications (e.g., antivirus).\nHide its own icon app to be less traceable by not advanced users.\nDisable Google Play Protect to avoid being flagged by Google as suspicious app.\nModify the device settings to get more privileges.\n\n\n-----\n\nUnlock the device if it is locked with a secret pin or pattern.\nShow phishing page.\nAbuse the accessibility service to read everything that is shown on the screen of the\ninfected device or to simulate click on the screen. This information is then sent to the\nC2 server of the attackers.\n\n[2] [https://www.cleafy.com/cleafy-labs/teabot](https://www.cleafy.com/cleafy-labs/teabot)\n\n[[3] https://www.cleafy.com/cleafy-labs/ubel-oscorp-evolution](https://www.cleafy.com/cleafy-labs/ubel-oscorp-evolution)\n\n[4] [https://www.b4x.com/b4a.html](https://www.b4x.com/b4a.html)\n\n## Conclusion\n\nThe Android Banking Trojan BRATA is already classified and blacklisted in our Threat\nIntelligence data with the following tags:\n\n**ASK_BANKER_ANDROID_BRATA_V1**\n**ASK_BANKER_ANDROID_BRATA_V2**\n\nAppendix 1: IOCs\n\nFirst campaign (June-mid September)\n\n**MD5** **App Name** **Package Name**\n\n\ned63a9c22b2a6d39f11dfcee8925d306 Sicurezza\nDispositivo\n\n\nb4a.example\n\n\n3cd6c14061a891c4a1525ac1a4609137 AntiSpam com.dasjn023.dmindnasiod\n\nSecond campaign (October)\n\n**MD5** **App Name** **Package Name**\n\n8a10f6600be239a246e93cca0e7a69b0 Sicurezza Avanzata com.voip.ffnenne\n\n**URL** **Description**\n\n23.254.228.221:17178 BRATA C2\n\nhttps[:]//bpweb-passadore[.]com URL used to distribute the malicious app\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-12-03 - Mobile banking fraud- BRATA strikes again.pdf"
    ],
    "report_names": [
        "2021-12-03 - Mobile banking fraud- BRATA strikes again.pdf"
    ],
    "threat_actors": [
        {
            "id": "75108fc1-7f6a-450e-b024-10284f3f62bb",
            "created_at": "2024-11-01T02:00:52.756877Z",
            "updated_at": "2025-03-27T02:00:55.544216Z",
            "deleted_at": null,
            "main_name": "Play",
            "aliases": null,
            "source_name": "MITRE:Play",
            "tools": [
                "Nltest",
                "AdFind",
                "PsExec",
                "Wevtutil",
                "Cobalt Strike",
                "Playcrypt",
                "Mimikatz"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1673536021,
    "ts_updated_at": 1743041785,
    "ts_creation_date": 1653691914,
    "ts_modification_date": 1653691914,
    "files": {
        "pdf": "https://archive.orkl.eu/2790454a890d09550b6b329e25c8ba9adc1fc85b.pdf",
        "text": "https://archive.orkl.eu/2790454a890d09550b6b329e25c8ba9adc1fc85b.txt",
        "img": "https://archive.orkl.eu/2790454a890d09550b6b329e25c8ba9adc1fc85b.jpg"
    }
}