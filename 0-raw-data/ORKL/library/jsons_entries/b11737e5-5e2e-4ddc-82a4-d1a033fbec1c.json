{
    "id": "b11737e5-5e2e-4ddc-82a4-d1a033fbec1c",
    "created_at": "2022-10-25T16:48:13.548921Z",
    "updated_at": "2025-03-27T02:05:57.757041Z",
    "deleted_at": null,
    "sha1_hash": "15afc5b86b1fb4ebd5bc99d0bf1d96ef773bdd4c",
    "title": "",
    "authors": "",
    "file_creation_date": "2019-08-08T14:55:43Z",
    "file_modification_date": "2019-08-08T14:56:00Z",
    "file_size": 5226024,
    "plain_text": "# Gift Cardsharks: The Massive Threat Campaigns Circling Beneath the Surface\n\nAuthors: Yonathan Klijnsma & Steve Ginty\n\n\n-----\n\n## Table of Contents\n\n**Foreword.....................................................................................................................3**\n\n**Executive Summary................................................................................................... 4**\n\n**Timeline.......................................................................................................................6**\n\n**Targets.........................................................................................................................8**\n\nFinancial Transactions Processing, Reserve, and Clearinghouse Activities...... 8\n\nInformation Technology............................................................................................................. 9\n\nRetail, Restaurants, & Travel .................................................................................................... 9\n\nEmployee Rewards and Corporate Loyalty.....................................................................10\n\nDigital Marketing & Communications.................................................................................10\n\nUnknown...........................................................................................................................................10\n\nTargeting Hypotheses................................................................................................................. 11\n\n**Methods of Operation.............................................................................................. 12**\n\nPhishing Pages...............................................................................................................................12\n\nConnections to the Lucy Phishing Platform...................................................................13\n\nLucy Headers..................................................................................................................................15\n\nLucy Phishing Templates..........................................................................................................15\n\nDigital Marketing for Phishing Delivery, Tracking, & Analytics...............................18\n\nImplants & Tools.......................................................................................................................... 20\n\nLegitimate Tools................................................................................................................... 20\nPowerShell.................................................................................................................................21\n\nBabySharkPro....................................................................................................................21\nEmpire: Get-Keystores.................................................................................................22\nStaging of payloads...................................................................................................................23\n\n**Infrastructure........................................................................................................... 24**\n\nHosting Providers........................................................................................................................24\n\nSSL Certificate Usage and Overlap....................................................................................25\n\nDomain Registrants....................................................................................................................27\n\nJacob Rummel.......................................................................................................................27\nIvan Wilshea.............................................................................................................................28\n\n**Conclusion................................................................................................................ 30**\n\n**Indicators of Compromise (IOCs).......................................................................... 31**\n\n\n-----\n\n## Foreword\n\nOver the past several weeks, various elements of a more substantial breach of\n\nIT supplier Wipro has become public.\n\n[Investigative journalist Brian Krebs first reported the attack on his website](https://krebsonsecurity.com/2019/04/experts-breach-at-it-outsourcing-giant-wipro/)\n“Krebs on Security,” which explained how Wipro’s IT systems were\ncompromised and used to attack the company's customers. After contacting\nWipro, Krebs followed up on his article by publishing updates on the\nbreach. While Wipro was generally close-lipped on the incident, some of the\nvictims breached through Wipro spoke with him and provided Indicators of\nCompromise (IOCs) they uncovered. Krebs proceeded to publish this small set\n\nof IOCs on his website.\n\nHowever, Wipro was far from the first company to be compromised by this\ncampaign and was only one of a long list of targets dating back to 2016. While\na spotlight was shone on this attack due to the high visibility of Wipro, we’ve\nwritten this report to shed light on the far more critical story around this\nattacker:\n\n  - This campaign goes far beyond Wipro\n\n  - The sophisticated, highly targeted nature of their attacks\n\n  - The sheer breadth of their targets\n\n  - The widely available tools they used to execute their attacks and feign\n\nlegitimacy\n\n  - Their unique monetization techniques leveraging gift card infrastructure\n\n\n-----\n\n## Executive Summary\n\n_Using our vast collection grid and unique external view of threat_\n_actor operations, RiskIQ can piece together a more complete_\n_picture of this actor group and their attack campaigns, tools, and_\n_possible motives. This report is by no means a comprehensive_\n_analysis but builds a detailed narrative of widely-reported events._\n\n_The actors in this attack have been operating since mid-2016,_\n_and analysis of their targets, based on companies included in_\n_their phishing domains, indicates that the actors were primarily_\n_targeting major gift card retailers, distributors, and card_\n\n_processors. As a result, we believe gaining access to gift card_\n_infrastructure was part of a unique monetization process and_\n_indicates that their motives may be financial._\n\n_These attacks followed a roughly consistent kill chain. To create_\n_effective email phishing campaigns and appear legitimate_\n_to targets' network security, they leveraged widely used_\n_email marketing and analytics tools. These phishing emails_\n_targeted retailers, employee reward programs, and many_\n_other organizations dealing in gift cards. With access to this_\n_gift card infrastructure, the attackers went on to use money_\n_transfer services, clearinghouses, and other payment processing_\n_institutions to monetize._\n\n_The actors appear to utilize commercially available and open-_\n_source software, including, ironically, platforms meant to train_\n_employees in phishing prevention, along with PowerShell to steal_\n_credentials and certificates to use toward broader reach. One_\n_of these PowerShell scripts, BabySharkPro (to which we allude_\n_in the title of this report), is often associated with North Korean_\n_threat activity, but this may have been a false flag put in place by_\n_the actors to mislead researchers._\n\n\n-----\n\n_We believe subsequent attacks on IT infrastructure organizations_\n_like Wipro and several others represented broader targeting by_\n_the threat group in an attempt to widen its reach._\n\n_Infrastructure overlap in PDNS, WHOIS, and SSL certificate_\n_data sets allowed RiskIQ to build out a more comprehensive_\n_understanding of actor-owned infrastructure, possible targets,_\n_and a timeline of the attack campaigns. This report is an analysis_\n_of these campaigns, their operators, and their targets._\n\n\n-----\n\n## Timeline\n\nRiskIQ has identified at least five distinct attack campaigns based off analysis\n\nof the actor-owned infrastructure. We built this timeline with both Passive DNS\nand SSL Certificate data collected by RiskIQ technology. In most instances,\nthe attackers targeted an organization for only a short period, allowing their\nphishing pages to be up for just one or two days after they sent out their\nmalicious emails. After this time, the server stopped responding for the\nphishing hostnames, and we no longer observed DNS resolutions for them.\n\nThe first campaign appears to have started in May of 2016 and continued\nthrough August of 2016. During this initial attack campaign, the actors’ targets\n\nare as follows:\n\nEight companies across the below industries over four months:\n\n  - Retail Organizations\n\n  - Digital Marketing / Marketing Automation\n\n  - Employee Rewards Providers\n\n  - Customer Loyalty & Recognition\n\n  - Gift Card providers\n\n  - Information Technology\n\nThe second campaign was active from February 2017 - March of 2017 and\nretargeted four of the same companies initially targeted during the 2016\ncampaign:\n\n  - Gift Card Providers\n\n  - Employee Rewards Providers\n\n  - Customer Loyalty & Recognition\n\nActors launched a third campaign on November 2017 targeting four new\norganization (one a subsidiary of a previous target) across the following\nindustries:\n\n  - Payment Transfer Services\n\n  - Point of Sale, Prepaid Services, Money Transfer\n\n  - Information Technology (online fax service)\n\n\n-----\n\nThe actors' fourth attack campaign started in February of 2018 and continued\n\nthrough May of 2018. Actors targeted 23 companies overall, including seven\n\norganizations they had previously targeted.\n\nThe following industries were targeted:\n\n  - Retail\n\n  - Digital Marketing / Marketing Automation\n\n  - Loyalty Rewards\n\n  - Gift Card providers\n\n  - Information Technology\n\n  - Payment Transfer Services\n\n  - Point of Sale, Prepaid Services, Money Transfer\n\n  - Payment Services\n\n  - Travel Platforms\n\nThe actors 5th campaign took place between January 2019 - May 2019. This\ncampaign is the most well known and the one associated with the Wipro\nbreach. This campaign significantly expanded the groups targeting list and\nincluded a larger focus on IT outsourcers, consultants, and managed service\nproviders.\n\nActors targeted 24 organizations\n\n  - 7 previous targets\n\n  - 17 New organizations\n\nThe following industries were targeted:\n\n  - Retail\n\n  - Digital Marketing / Marketing Automation\n\n  - Loyalty Rewards Companies\n\n  - Gift Card providers\n\n  - Information Technology\n\n  - Payment Transfer Service\n\n  - Point of Sale, Prepaid Services, Money Transfer\n\n  - Payment Services\n\n  - Travel Platforms\n\n\n-----\n\n## Targets\n\nOur target analysis is based on the fact that the actors used fully qualified\n\ndomain names (FQDNs) with the target organization name or domain. While\nwe can determine organizations of interest to this actor group based on\ninfrastructure, a target does not imply a victim or that the actor group was\nsuccessful in breaching the organization.\n\nOur analysis of the infrastructure used in the attack campaigns led us to\ndetermine that this actor group is targeting the following industries/verticals:\n\n### Financial Transactions Processing, Reserve, and Clearinghouse Activities\n\n|Activities|Col2|Col3|\n|---|---|---|\n|Company|Website|Headquartered|\n|Greendot Corporation|https://www.greendot.com/|United States|\n|Wolfe|https://www.wolfe.com/|United States|\n|Blackhawk Networks|http://www.blackhawknetwork.com/|United States|\n|CashStar (Blackhawk Networks)|https://www.cashstar.com/|United States|\n|Paysafe Group|https://www.paysafe.com/na-en/|Isle of Man|\n|Incomm|https://www.incomm.com/|United States|\n|Euronet Worldwide|https://www.euronetworldwide.com/|United States|\n|MoneyGram|https://secure.moneygram.com/ mgo/us/en/|United States|\n|UAE Exchange|https://www.uaeexchange.com/|United Arab Emirates|\n|Western Union|https://www.westernunion.com/us/ en/home.html|United States|\n|WorldRemit|http://www.worldremit.com/|United Kingdom|\n|Sigue|https://sigue.com/|United States|\n|First Data|https://www.firstdata.com/en_us/ home.html|United States|\n|Comdata|http://www.comdata.com/|United States|\n|Stored Value (Comdata)|http://www.storedvalue.com/en-US/ home|United States|\n|Fleetcor|http://www.fleetcor.com/|United States|\n|Elavon|https://www.elavon.com/|United States|\n\n\n-----\n\n### Information Technology\n\nCompany\n\nRackspace\n\nServiceNow\n\nAvande (Accenture)\n\nPCM\n\nCognizant\n\nCapgemini\n\nInfosys\n\nWipro\n\nSlalom\n\nGFI Software\n\n### Retail, Restaurants, & Travel\n\n|Information Technology|Col2|Col3|\n|---|---|---|\n|Company|Website|Headquartered|\n|Rackspace|https://www.rackspace.com/|United States|\n|ServiceNow|https://www.servicenow.com/|United States|\n|Avande (Accenture)|https://www.avanade.com/en- us|United States|\n|PCM|http://www.pcm.com/|United States|\n|Cognizant|https://www.cognizant.com/|United States|\n|Capgemini|http://www.capgemini.com/|France|\n|Infosys|http://www.infosys.com/|India|\n|Wipro|https://www.wipro.com/en-US/|India|\n|Slalom|https://www.slalom.com/|United States|\n|GFI Software|https://www.gfi.com/|Malta|\n\n|Company|Website|Headquartered|\n|---|---|---|\n|Best Buy|https://www.bestbuy.com/|United States|\n|Sears Holdings|https://searsholdings.com/|United States|\n|Staples|https://www.staples.com/|United States|\n|Costco|https://www.costco.com/|United States|\n|Gamestop|https://www.gamestop.com/|United States|\n|Darden Restaurants|https://www.darden.com/|United States|\n|Card Cash|https://cardcash.com/|United States|\n|eGifter|https://www.egifter.com/|United States|\n|Outerwall / Coinstar|https://www.coinstar.com/|United States|\n|Expedia Group|http://www.expediagroup.com/|United States|\n|Booking Holdings|https://www.bookingholdings.com/|United States|\n|Agoda (Booking Holdings)|http://www.agoda.com/|Singapore|\n\n\n-----\n\n### Employee Rewards and Corporate Loyalty\n\nCompany Website Headquartered\n\nAffinion Group http://www.affinion.com/ United States\n\nO.C. Tanner https://www.octanner.com/ United States\n\nBridge2 Solutions http://www.bridge2solutions.com United States\n\nAchievers (Blackhawk Networks) https://www.achievers.com/ United States\n\nGloboforce / Workhuman https://www.globoforce.com/ United States\ncompany/\n\nVirgin Pulse https://www.virginpulse.com/ United Kingdom\n\nITA Group https://www.itagroup.com/ United States\n\n### Digital Marketing & Communications\n\nCompany Website Headquartered\n\nSmartFocus https://www.smartfocus.com/en United States\n\nInsideView http://www.insideview.com/ United States\n\nDotdigital https://dotdigital.com/ United Kingdom\n\nSendGrid https://sendgrid.com/ United States\n\nAct-On https://www.act-on.com/ United States\n\nMessageLab https://www.messagelab.com/ United States\n\nEpiserver https://episerver.com United States\n\nInfogroup http://www.infogroup.com/ United States\n\nZoomInfo http://www.zoominfo.com/ United States\n\n### Unknown\n\nThere is also a large pool of unknown targets and victims. Unlike most of the\nphishing attacks in this campaign, the infrastructure used to target these\nunknown targets did not include the organization's name so we could not\nidentify them.\n\n|Company|Website|Headquartered|\n|---|---|---|\n|Affinion Group|http://www.affinion.com/|United States|\n|O.C. Tanner|https://www.octanner.com/|United States|\n|Bridge2 Solutions|http://www.bridge2solutions.com|United States|\n|Achievers (Blackhawk Networks)|https://www.achievers.com/|United States|\n|Globoforce / Workhuman|https://www.globoforce.com/ company/|United States|\n|Virgin Pulse|https://www.virginpulse.com/|United Kingdom|\n|ITA Group|https://www.itagroup.com/|United States|\n\n|Company|Website|Headquartered|\n|---|---|---|\n|SmartFocus|https://www.smartfocus.com/en|United States|\n|InsideView|http://www.insideview.com/|United States|\n|Dotdigital|https://dotdigital.com/|United Kingdom|\n|SendGrid|https://sendgrid.com/|United States|\n|Act-On|https://www.act-on.com/|United States|\n|MessageLab|https://www.messagelab.com/|United States|\n|Episerver|https://episerver.com|United States|\n|Infogroup|http://www.infogroup.com/|United States|\n|ZoomInfo|http://www.zoominfo.com/|United States|\n\n\n-----\n\n### Targeting Hypotheses\n\nAnalysis of the targeted organizations across all attack campaigns highlights a\n\nfew common threads:\n\n  - Traditional retail organizations are significant targets\n\n   - Example targets: Best Buy, Sears, Darden Foods, Costco,\n\n   - A possible theory for targeting could be that gift cards provide access\n\nto liquid assets outside of the traditional western financial system\n\n  - Company and employee rewards programs\n\n   - Example targets: Affinion Group, O.C. Tanner, Achievers\n\n   - Possible targeting theory: Most of these rewards programs offer\n\nbroad access to gift card based rewards\n\n  - Gift card providers and processors\n\n   - Example targets: Incomm, Greendot, BlackHawk Networks, Wolfe\n\n   - Possible targeting theory: Actors need a way to convert gift cards\n\ninto currency and effectively transfer funds to more traditional\ninstitutions\n\n  - Digital marketing and marketing automation firms\n\n   - Example targets: SmartFocus, Insideview, SendGrid, Socialab\n\n   - Possible targeting theory: Actors can leverage these platforms and\n\nservices for distribution of their phishing emails\n\n   - RiskIQ has observed some of the above services being used in\n\nconjunction with the actors' attacks\n\n  - Information Technology\n\n   - Example targets: Rackspace, Wipro, Infosys, PCM\n\n   - A possible theory for targeting is that Rackspace is a major cloud\n\nprovider for Financial services and organizations. Actors could be\nlooking to target the third-party provider to compromise multiple\norganizations.\n\nAdditional targeting highlights:\n\n   - The actors focused on traditional Retail targets in their initial 2016\n\nattack campaign.\n\n\n-----\n\n   - They expanded targeting in their 2017 attack campaigns to include\n\norganizations’ employee rewards and corporate loyalty programs\n\nwhich may indicate they needed a broader collection of targets\n\n   - Travel platforms such as Agoda and Expedia are added to their\n\nexpanded targeting list in 2018\n\n   - Outside of initial targeting of Rackspace, the threat actors do not\n\nexpand targeting to include additional information technology\norganizations until their now infamous 2019 campaign against Wipro.\n\n## Methods of Operation\n\nTo create effective email phishing campaigns and appear legitimate to targets'\nnetwork security and anti-phishing tools, the attackers leveraged widely\nused email marketing and analytics tools. These phishing emails targeted\norganizations dealing in gift cards such as retailers and human resources\nplatforms, using relatively generic templates and switching out the logo and\nbranding to reflect the target organization.\n\n### Phishing Pages\n\nThe attackers used phishing pages to attack their targets. These pages have\nreasonably generic login forms, and would all be similar except for the names\nof the targeted organizations. The attackers did not create these phishing\npage designs or the system that serves them themselves—they made use of a\nphishing software package called Lucy, which allowed them to automate much\n\nof the work.\n\nWhen RiskIQ crawlers visit websites, they record all resources and add them\nto an index of every resource we’ve ever seen and where we've seen it. We\ndiscovered the attackers' usage of Lucy when we compared the phishing\npages used in the different campaigns and noticed a lot of shared resources.\nWhen we compared hosts returning the same resources, many were using\nLucy, adding Lucy as a new web component on which to search for more of\nthis phishing infrastructure.\n\n\n-----\n\n### Connections to the Lucy Phishing Platform\n\nAnalyzing one of the javascript files (detect.js) associated with the actors’\n\nfishing campaign, led RiskIQ analysts to uncover three additional URLs related\nto the same file. One of the hosts login[.]microsoftonlineportal[.]net - was\nof particular interest as it appeared similar to the actors' domain registration\nstructure.\n\nhttps://community.riskiq.com/search/login.microsoftonlineportal.net\n\nInvestigating the domain’s resolution history unveiled IP addresses with\nsignificant typosquatting domains registered that appeared to be targeting\nEuropean corporations. Additional analysis of RiskIQ’s component data set\nrevealed a unique server association for the domains in question: Lucy.\n\n\n-----\n\nA query of our RiskIQ’s component database as of May 9th shows 500 hosts\n\nand 183 IP addresses with that server component present:\n\nhttps://community.riskiq.com/search/components/Lucy\n\nRunning a Google search for the phrase “Lucy Server” revealed a possible\nconnection to a security company based in Zug Switzerland that offers a\nSaaS phishing platform for organizations to conduct security and phishing\nawareness training:\n\n\n-----\n\n### Lucy Headers\n\nRiskIQ crawlers identified a server installation called Lucy, which shows in the\n\nserver header of certain Lucy installations. One interesting thing to note is\nthat whether or not you see this header depends on how you install Lucy. In\ngeneral, it comes down to these installation methods:\n\n   - Preconfigured Virtual Machine: Shows Lucy server header\n\n   - Manual installation through a script: Does not show Lucy server\n\nheader\nThe attackers performed manual installations of their Lucy servers every time,\n\nwhich means only the Apache headers show most of the time, with Nginx\nshowing some of the time.\n\n### Lucy Phishing Templates\n\nLucy comes with a variety of default phishing templates, and one of these\ntemplates was used during most of the phishing campaigns—including the now\nnotorious Wipro case:\n\nLucy Template: https://wiki.lucysecurity.com/lib/exe/fetch.php?cache=&media=prev2.png\n\nLucy OEM Edition: http://lucysecurity.com/wp-content/uploads/2019/03/OEM-edition.pdf\n\n\n-----\n\nAdditional analysis of this infrastructure associated with the actor groups 2017\n\ncampaign and phishing URL surfaced from Hybrid Analysis also show the use\n\nof a second Lucy 60 Second Survey template:\n\n[Lucy 60 Second Survey Template](https://www.hybrid-analysis.com/sample/3f1f3f440f61f9c812429e480c3b9501deb93b16c4102b197c0ea091d96ee474?environmentId=100 )\n\nThe Lucy platform survey template was used in conjunction with infrastructure\nhrsurveyservice[.]com and found on a typo squatting host associated with\nAchievers corp, an employee recognition and rewards platform acquired by\nBlackHawk Networks.\n\n\n-----\n\n[https://community.riskiq.com/search/achievers.hrsurveyservice.com](https://community.riskiq.com/search/achievers.hrsurveyservice.com)\n\nAnalysis of the hybrid analysis match, shows a SendGrid URL scanned using\nthe platform, which redirects to phishing domain achievers[.]hrsurveyservice[.]\ncom, which is using the Lucy 60 second survey template.\n\n[https://www.hybrid-analysis.com/sample/](https://www.hybrid-analysis.com/sample/3f1f3f440f61f9c812429e480c3b9501deb93b16c4102b197c0ea091d96ee474?environmentId=100)\n[3f1f3f440f61f9c812429e480c3b9501deb93b16c4102b197c0ea091d96ee474?environmentId=100](https://www.hybrid-analysis.com/sample/3f1f3f440f61f9c812429e480c3b9501deb93b16c4102b197c0ea091d96ee474?environmentId=100)\n\n\n-----\n\nWith all its automation, Lucy also lets a user easily generate an SSL certificate\n\nfor its attack campaigns using certificate provider Let’s Encrypt, which the\n\nattackers did:\n\nLucy SSL Configuration: https://wiki.lucysecurity.com/doku.php?id=ssl_configuration\n\n### Digital Marketing for Phishing Delivery, Tracking, & Analytics\n\nRiskIQ has observed the use of digital marketing solutions such as Socialab,\nSendGrid, and Campaign Monitor for phishing email link-tracking. Analysis of\nknown actor-owned phishing domains shows possible victims submitting the\ntracking URLs to sites such as VirusTotal, Hybrid Analysis, and urlscan.io to\ndetermine if the URLs in question are malicious.\n\n[https://www.virustotal.com/#/url/](https://www.virustotal.com/#/url/bbd1d2adc42a3101ace36f8034a9c22d0963ee29612bf0959260957a908d01d9/details)\n[bbd1d2adc42a3101ace36f8034a9c22d0963ee29612bf0959260957a908d01d9/details](https://www.virustotal.com/#/url/bbd1d2adc42a3101ace36f8034a9c22d0963ee29612bf0959260957a908d01d9/details)\n\n\n-----\n\nThe use of these analytics and marketing services also aid actors in masking\n\nthe actual malicious link, allowing them to bypass an organization’s security\n\ncontrols, which catch or filter these messages at an email gateway and trick\n\neven vigilant users into thinking the link is legitimate.\n\nAdditionally, the Lucy platform supports API integrations with external\nmail servers, highlighting in its documentation how easy it is to integrate\nwith SendGrid. The documentation calls out, “in Lucy, you can use a\nprepaid, external mail server with an excellent reputation as your default\ncommunications method […]. There are a few advantages to this model\nespecially if all other mail methods of mail delivery fail due to SPAM filtering.”\n\nhttps://wiki.lucysecurity.com/doku.php?id=mail_delivery_methods_in_lucy\n\n\n-----\n\n### Implants & Tools\n\nThe attackers make use of several different tools once they have gained an\n\ninitial foothold via stolen credentials. In general, they employ a combination of\nlegitimate tools for monitoring, remote access, and lateral movement, as well as\na combination of Powershell scripts with Mimikatz to elevate privileges or aid in\nmonitoring and lateral movement.\n\n#### Legitimate Tools\n\nAs mentioned, the attackers make use of legitimate tools as part of the\n\ninfiltration into internal networks of corporations. Because these tools are legal,\nit makes them harder to spot, particularly if the targeted organizations also use\nthem. However, if they don’t, these tools could become excellent indicators of\ncompromise.\n\nBecause these tools are legitimate we won’t be providing extensive file IOCs\nas it depends on the used build for a target, all we can denote is that these\nlegitimate tools are part of the attacker’s arsenal.\n\nWe are aware of the attacker using the following tools during their internal\nfoothold:\n\n  - ScreenConnect: This tool gives them remote control over a machine in\n\nthe form of visual (or command-line based) access.\n\n  - EMCO Remote Installer: This tool gives them capabilities to deploy any\n\ntool they want across the network. This tool does require a certain level\nof access to the network which one of the later discussed PowerShell\nimplants provides them, by using Mimikatz.\n\nOur visibility on these attackers is strictly external, which means we do not\nhave 100% coverage on the aspects of the threat actors' internal movements.\nThe above list includes the only two tools we are aware they use; the odds are\nthat there are more of these tools.\n\nWe'd love to collaborate with those who encountered this adversary during\nincident response to see if we can broaden our knowledge and profile(s).\n\n\n-----\n\nThe attackers also used small PowerShell scripts to rename the ScreenConnect\n\nproduct name on compromised machines:\n\nThese Powershell scripts were staged from remote servers, one example is: serveresults.com/\ncss/indiapro.ps1.11 (MD5: dd5986339aaf23f2baf8c245923a0f69).\n\n#### PowerShell\n\nThe attackers combined their use of legitimate tools with PowerShell scripts\ntaken from public repositories.\n\n_BabySharkPro_\n\nOne of the tools used by the attackers is for the most part a very large\nPowerShell script which they use to steal credentials and locally stored\ncertificates. We found multiple different builds of the same tool, they contain\nthe same code:\n\n - 28c806cb8c91ab66987ac1ec88344296\n\n - e2e88d6ea5d5d2a4c7b8039988644043\n\n  - f6ea268c7e184f580029aec42f2a98f8\n\n - d6472dcebce348d693e68b90099d9ede\n\nThe script contains a lot of PowerShell script, which we discuss below, which\nthe attackers encapsulated in one large function scope called BabySharkPro:\n\n\n-----\n\nWhat is more important about this PowerShell script is what it contains: a\n\ncustom Mimikatz build. The PowerShell script maps a custom build of Mimikatz\n\nin memory and runs the following commands to pull down data:\n```\n  • sekurlsa::logonpasswords exit\n\n```\nThis command dumps the current and recently logged in users, including\npassword information and some general account information.\n\n`•` crypto::cng crypto::capi \"crypto::certificates /export\"\n\n\"crypto::certificates /export /systemstore:CERT_SYSTEM_STORE_\nLOCAL_MACHINE\" exit\nExports the locally stored certificates to disk\n\nThe unique thing about these commands is the custom-compiled Mimikatz\nbuild on which the attacker used them. The fact that it was custom-compiled\nmakes it an interesting sample—it does not ever hit the filesystem, as it is\nexecuted in memory only.\n\nThis custom build of Mimikatz was compiled on Saturday, August 4th, 2018, at\n00:05:41, which matches the timelines we have on the attacker's activities. The\nMD5 for this custom build is: 8aea2ae91cc084731a08aa231e79a430.\n\nThe code used in the tool seems to be stitched-together modules taken from\n[the PowerSploit module framework: https://github.com/PowerShellMafia/](https://github.com/PowerShellMafia/PowerSploit.)\n[PowerSploit.](https://github.com/PowerShellMafia/PowerSploit.)\n\n_Empire: Get-Keystores_\n\nAnother module we found, which shows the attackers sticking with their\npreference of PowerShell scripts, is a stripped copy of the PowerShell Empire\nGet-Keystrokes.ps1 module. The attackers removed the comments and author\n[information from the original file from the Empire project GitHub: https://](https://github.com/EmpireProject/Empire/blob/master/data/module_source/collection/Get-Keystrokes.ps1)\n[github.com/EmpireProject/Empire/blob/master/data/module_source/](https://github.com/EmpireProject/Empire/blob/master/data/module_source/collection/Get-Keystrokes.ps1)\n[collection/Get-Keystrokes.ps1](https://github.com/EmpireProject/Empire/blob/master/data/module_source/collection/Get-Keystrokes.ps1)\n\nMD5 for the modified keylogger is: 502fbbdacada9215ed0d026c70f983e1\n\n\n-----\n\n### Staging of payloads\n\nThe attackers made use of both the /js/ and /CSS/ subfolders on the server,\n\nbut this wasn’t the only staging method the attackers used. They also made\nuse of GitHub repositories. An account named \"onsmooth\" maintained\nrepositories which contained PowerShell scripts similar to the one seen on the\nserveresults.com server.\n\nOne example of the used GitHub raw URLs to stage the PowerShell script:\n\nhttps://raw.githubusercontent.com/onsmooth/kors/master/bsansi.ps1\n\n\n-----\n\nThe onsmooth username is also interesting as it mimics a pattern for a domain\n\nname used to registered other infrastructure back in their 2016 campaign:\n\n[Source: https://community.riskiq.com/search/whois/email/craig@smooth-on.com](https://community.riskiq.com/search/whois/email/craig@smooth-on.com)\n\n## Infrastructure\n\nThe infrastructure associated with these attack campaigns highlight how all\nactors develop patterns and can overlap infrastructure-based operational\nsecurity failures. This group consistently leverages the same hosting providers,\noverlaps SSL certificates on common IP addresses, and uses similar WHOIS\ndata which ties infrastructure together.\n\n### Hosting Providers\n\nAnalysis of the IP addresses used by this actor group show consistent use of\nthe following hosting providers\n\n  - Sunnyvision\n\n  - Solar Communications\n\n  - King Servers\n\n\n-----\n\nAnalysis of the attack infrastructure shows that the actors initially leveraged\n\nSunvision and Solar Communications, two small hosting service providers, to\n\ninitially host their phishing domains in May and June of 2016 before switching\n\nover to King Servers infrastructure in July of 2016.\n\n### SSL Certificate Usage and Overlap\n\nAnalysis of SSL Certificate data associated with the actors early 2016 IP\naddresses shows the presence of default Lucy phish platform certificates:\n\nhttps://community.riskiq.com/search/95.183.52.99\n\nhttps://community.riskiq.com/search/124.248.205.18\n\n\n-----\n\nThe presence of these default install certificates from the Lucy platform\n\nstrengthen the connection to the actors' use of the SaaS security platform as\n\ntheir tool for conducting their phishing attacks against victim targets.\n\nBesides the presence of these default certificates, we were also able to identify\ncommon attack infrastructure based on overlaps in self-signed certificates\ngenerated and used for the management of the Lucy platform and other\ninfrastructure associated with the actor groups infrastructure, as can be seen in\nthe screenshot below.\n\n[https://community.riskiq.com/search/certificate/](https://community.riskiq.com/search/certificate/sha1/51d4b4cd19ef174a257840f3d1a419f839014f6d)\n[sha1/51d4b4cd19ef174a257840f3d1a419f839014f6d](https://community.riskiq.com/search/certificate/sha1/51d4b4cd19ef174a257840f3d1a419f839014f6d)\n\nThis certificate overlap and other similar occurrences among this actor group\nallowed us to surface a significant amount of this actor group's infrastructure\nacross multiple campaigns.\n\n\n-----\n\n### Domain Registrants\n\nWhile most of the actor-owned domains for this campaign were registered\n\nusing privacy protection services, RiskIQ analysts were able to identify unique\nregistrant data in historical WHOIS records that assisted us in understanding\nthe broader scope of this attack.\n\n#### Jacob Rummel\n\nDigging through infrastructure from early 2016’s campaign, we were able\nto surface some early domains registered without privacy protection. As\n\nseen in the screen capture below, the domain bhnetwork.online, possibly\ntyposquatting Blackhawk networks, one of our actor groups know targets.\n\nhttps://community.riskiq.com/search/ns1.bhnetwork.online\n\n\n-----\n\nPivoting off of this unique WHOIS data we were able to surface 19 additional\n\ndomains registered using the exact same information inside of RiskIQ’s\n\nhistorical WHOIS database:\n\nhttps://community.riskiq.com/search/whois/email/deutsch@onlinebingo.eu\n\n#### Ivan Wilshea\n\nRiskIQ analysts were also able to identify domains associated with the actors’\n2017 attack campaigns with unmasked WHOIS records. One interesting\nnote this time was that the domains in question appear to have initially been\nregistered using a privacy protection service during active usage in the 2017\ncampaign. However, it seems the protection service lapsed, and the registrar\nexposed the real WHOIS data in May of this year.\n\n\n-----\n\nhttps://community.riskiq.com/search/imail-ssl.com\n\nA search of the above Name, Organization, and Email address across RiskIQ’s\nhistorical WHOIS database shows seven domains registered using the same\ninformation. Analysis of these domains identified FQDNs used in attack\ncampaigns or as name servers for attack infrastructure.\n\n\n-----\n\nhttps://community.riskiq.com/search/whois/email/yaqhxrcr@emltmp.com\n\n## Conclusion\n\nThis analysis highlights how organizations can build off of a small set of\nnetwork-based IOCs to better derive context about an adversary and their\nattack campaigns, the scope of their activity, and the overarching impact of the\nadversary’s overall operations. Using a multitude of data sets and pivot points,\nanalysts can gain a broader knowledge of adversary infrastructure\n\nThis actor group operated over a sustained period—since at least 2016,\ntargeting specific organization across multiple coordinated campaigns. The use\nof open-source tooling allowed them to scale their operations while limiting\nanalysts ability to easily attribute activity to a known actor group based on\ntool reuse. Their operational tempo increased to ramp up targeting and scope\nover time, which indicates that they achieved at least some success throughout\ntheir campaigns\n\n\n-----\n\n## Indicators of Compromise (IOCs)\n\nDue to the size of the infrastructure, the amount of IOCs is much more than\n\nwhat we would put in our report document. We decided to provide appendix\ndocuments containing the full set of infrastructure and meta-data around the\ninfrastructure with this report. Please refer to this appendix for the full details\nregarding the infrastructure.\n\n[The appendix document details are also made available as flat files with this](https://www.riskiq.com/gift-cardsharks-iocs/)\nreport for quick ingestion.\n\n\nRiskIQ provides comprehensive discovery, intelligence, and mitigation\nof threats associated with an organization’s attack surface. RiskIQ’s\nplatform delivers unified insight and control over external web, social,\nand mobile exposures. Thousands of security analysts use RiskIQ to\nexpedite investigations, monitor their attack surface, assess risk, and\nremediate threats.\n\n**Learn how the RiskIQ could help protect your attack surface by**\n\n\n22 Battery Street, 10th Floor\nSan Francisco, CA. 94111\n\n sales@riskiq.net  RiskIQ.com\n\n 1 888.415.4447  @RiskIQ\n\nCopyright © 2019 RiskIQ, Inc. RiskIQ, the RiskIQ logo\nand RiskIQ family of marks are registered trademarks\nor trademarks of RiskIQ, Inc. in the United States and\nother countries. Other trademarks mentioned herein\nmay be trademarks of RiskIQ or other companies.\n06_19\n\nThe only warranties for RiskIQ products and services\nare set forth in the express warranty statements\naccompanying such products and services. Nothing\nherein should be construed as constituting an\nadditional warranty. RiskIQ shall not be liable for\ntechnical or editorial errors or omissions contained\nh i\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "5910e58f-4bc9-4e4e-9dbb-887804094a01",
            "created_at": "2022-10-25T16:32:58.457399Z",
            "updated_at": "2022-10-25T16:32:58.457399Z",
            "deleted_at": null,
            "name": "OTX",
            "url": "https://otx.alienvault.com",
            "description": "Alienvault Open Threat Exchange (OTX)",
            "reports": null
        }
    ],
    "references": [
        "https://cdn.riskiq.com/wp-content/uploads/2019/06/Gift-Cardsharks-Intelligence-Report-2019-RiskIQ.pdf"
    ],
    "report_names": [
        "Gift-Cardsharks-Intelligence-Report-2019-RiskIQ.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1666716493,
    "ts_updated_at": 1743041157,
    "ts_creation_date": 1565276143,
    "ts_modification_date": 1565276160,
    "files": {
        "pdf": "https://archive.orkl.eu/15afc5b86b1fb4ebd5bc99d0bf1d96ef773bdd4c.pdf",
        "text": "https://archive.orkl.eu/15afc5b86b1fb4ebd5bc99d0bf1d96ef773bdd4c.txt",
        "img": "https://archive.orkl.eu/15afc5b86b1fb4ebd5bc99d0bf1d96ef773bdd4c.jpg"
    }
}