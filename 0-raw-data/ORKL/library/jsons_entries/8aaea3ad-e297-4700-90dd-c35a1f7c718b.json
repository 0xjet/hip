{
    "id": "8aaea3ad-e297-4700-90dd-c35a1f7c718b",
    "created_at": "2023-02-02T02:08:25.371726Z",
    "updated_at": "2025-03-27T02:16:11.591263Z",
    "deleted_at": null,
    "sha1_hash": "4a960fb9a2d688bcde07f882e04851800782ca5b",
    "title": "2022-12-09 - Drokbk Malware Uses GitHub as Dead Drop Resolver",
    "authors": "",
    "file_creation_date": "2023-02-01T07:40:24Z",
    "file_modification_date": "2023-02-01T07:40:24Z",
    "file_size": 610584,
    "plain_text": "# Drokbk Malware Uses GitHub as Dead Drop Resolver\n\n**[secureworks.com/blog/drokbk-malware-uses-github-as-dead-drop-resolver](https://www.secureworks.com/blog/drokbk-malware-uses-github-as-dead-drop-resolver)**\n\nCounter Threat Unit Research Team\n\n_A subgroup of the Iranian COBALT MIRAGE threat group leverages Drokbk for persistence._\nFriday, December 9, 2022\nBy: Counter Threat Unit Research Team\nSecureworks® Counter Threat Unit™ (CTU) researchers are investigating the Drokbk\nmalware, which is operated by a subgroup of the Iranian government-sponsored COBALT\nMIRAGE threat group. This subgroup is known as Cluster B. Drokbk is written in .NET and is\nmade up of a dropper and a payload. The malware has limited built-in functionality and\n\n\n-----\n\nprimarily executes additional commands or code from the command and control (C2) server.\nEarly signs of its use in the wild appeared in a February 2022 intrusion at a U.S. local\ngovernment network. A Drokbk malware sample was not available from that incident for\nanalysis, but CTU™ researchers later discovered samples uploaded to the VirusTotal\nanalysis service.\n\nDrokbk is deployed post-intrusion alongside other access mechanisms as an additional form\nof persistence within the victim's environment. COBALT MIRAGE's preferred form of remote\n[access uses the Fast Reverse Proxy (FRPC) tool. While COBALT MIRAGE Cluster A uses a](https://github.com/fatedier/frp)\n[modified version of this tool known as TunnelFish, Cluster B favors the unaltered version.](https://www.secureworks.com/blog/opsec-mistakes-reveal-cobalt-mirage-threat-actors)\n[The only public mention of Drokbk.exe is in a March third-party report describing activity that](https://www.esentire.com/blog/exploitation-of-vmware-horizon-servers-by-tunnelvision-threat-actor)\nexhibits signs of a Cluster B intrusion. In that instance, the malware used the C2 domain\nactivate-microsoft . cf, which is known to be associated with Cluster B.\n\nThe February intrusion that Secureworks incident responders investigated began with a\n[compromise of a VMware Horizon server using two Log4j vulnerabilities (CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)\n[and CVE-2021-45046). Forensic artifacts indicated Drokbk.exe was extracted from a](https://nvd.nist.gov/vuln/detail/CVE-2021-45046)\ncompressed archive (Drokbk.zip) hosted on the legitimate transfer . sh online service. The\nthreat actors extracted the file to C:\\Users\\DomainAdmin\\Desktop\\ and then executed it.\n\nThe Drokbk dropper checks for the existence of the c:\\programdata\\SoftwareDistribution\ndirectory and creates the directory if it does not exist. The dropper then writes all bytes from\nan internal resource to c:\\users\\public\\pla. This is a temporary step; the extracted file (pla) is\nthen copied to c:\\programdata\\SoftwareDistribution\\SessionService.exe. Using this newly\ncreated file, the dropper adds the SessionManagerService service for persistence. Finally,\nthe dropper deletes c:\\users\\public\\pla. Figure 1 illustrates the installation process. CTU\nresearchers have observed that the Cluster B operators favor c:\\users\\public\\ as a directory\nused across multiple malware tools.\n\n_Figure 1. Process tree for Drokbk installation. (Source: Secureworks)_\n\nSessionService.exe is the main malware payload, and it begins by finding its C2 domain. A\nC2 domain is often preconfigured in malware. However, Drokbk uses the [dead drop resolver](https://attack.mitre.org/techniques/T1102/001/)\ntechnique to determine its C2 server by connecting to a legitimate service on the internet\n(e.g., GitHub). The C2 server information is stored on a cloud service in an account that is\neither preconfigured in the malware or that can be deterministically located by the malware.\n\n\n-----\n\nFigure 2 shows decompiled .NET code from SessionService.exe. The binary uses the\nGitHub API to search for the 'mainrepositorytogeta' repository.\n\n_Figure 2._ _[DnSpy-decompiled .NET code from SessionService.exe. (Source: Secureworks)](https://github.com/dnSpyEx/dnSpy)_\n\nThis code identifies the specific GitHub account and the request used to locate the malware's\nC2 server. The response is stored within the README.md file hosted on the GitHub account\n(see Figure 3). In this campaign, the threat actor used a GitHub account with the username\nShinault23.\n\n_Figure 3. Code used to locate the C2 server within a GitHub account. (Source: Secureworks)_\n\nThis approach gives the threat actors a degree of resiliency against shuttering of their GitHub\naccount, as they can create a new account with a matching repository name. It also allows\nthe malware to dynamically update its C2 server by repeating this process.\n\nThe first commit to the README.md file occurred on June 9, 2022, suggesting this campaign\nbegan around this date. Between June 9 and July 13, the threat actors changed the C2\nserver multiple times. GitHub maintains a commit history for the file, listing each change (see\nFigure 4).\n\n_Figure 4. Example of the commit history for the Shinault23 account. (Source: Secureworks)_\n\n\n-----\n\nFigure 5 lists the C2 servers configured between June 9 and July 13. These domain names\nand URL structures align with infrastructure patterns observed in other Cluster B activity,\nproviding additional evidence supporting technical attribution.\n\n_Figure 5. List of Drokbk C2 servers from the README.md file. (Source: Secureworks)_\n\nUsing the information from README.md, SessionService.exe sends an initial request to the\nC2 server. The request contains the hostname and current time (see Figure 6).\n\n_Figure 6. Sandbox output showing initial Drokbk beacon. (Source: Secureworks)_\n\nDuring execution, CTU researchers observed Drokbk creating the following files. No\npayloads or commands were received from the C2 during analysis.\n\nC:\\Windows\\Temp\\v2ggla\nC:\\Windows\\Temp\\vdoma434\nC:\\programdata\\Interop Services\n\nTo mitigate exposure to this malware, CTU researchers recommend that organizations use\navailable controls to review and restrict access using the indicators listed in Table 1. Note\nthat IP addresses can be reallocated. The domains, IP addresses, and URL may contain\nmalicious content, so consider the risks before opening them in a browser.\n\n**Indicator** **Type** **Context**\n\n\n372b1946907ab9897737799f3bc8c131\n\n00519705\n\n\nSHA1\nhash\n\n\nDrokbk.exe malware\n\nDrokbk.exe malware\n\n\ne26a66bfe0da89405e25a66baad95b05 MD5\nhash\n\n\n-----\n\n**Indicator** **Type** **Context**\n\n\n4eb5c832ce940739d6c0eb1b4fc7a78d\n\nef1dd15e\n\n64f39b858c1d784df1ca8eb895ac7eaf\n\n47bf39acf008ed4ae27a796ac90f841b\n\n\nSHA1\nhash\n\nSHA256\nhash\n\n\n8c8e184c280db126e6fcfcc507aea925 MD5\nhash\n\n\naefab35127292cbe0e1d8a1a2fa7c39c\n\n9d72f2ea\n\n29dc4cae5f08c215d57893483b5b42cb\n\n00a2d0e7d8361cda9feeaf515f8b5d9e\n\n\nSHA1\nhash\n\nSHA256\nhash\n\n\n14a0e5665a95714ff4951bd35eb73606 MD5\nhash\n\n\n0426f65ea5bcff9e0dc48e236bbec293\n\n380ccc43\n\na8e18a84898f46cd88813838f5e69f05\n\n240c4853af2aee5917dcee3a3e2a5d5a\n\n\nSHA1\nhash\n\nSHA256\nhash\n\n\nb90f05b5e705e0b0cb47f51b985f84db MD5\nhash\n\n\n5bd0690247dc1e446916800af169270f\n\n100d089b\n\n28332bdbfaeb8333dad5ada3c10819a1\n\na015db9106d5e8a74beaaf03797511aa\n\n\nSHA1\nhash\n\nSHA256\nhash\n\n\nDrokbk.exe malware\n\nDrokbk.exe malware\n\nDrokbk.exe malware\n\nDrokbk.exe malware\n\nDrokbk.exe malware\n\nDrokbk malware payload\n(SessionService.exe)\n\nDrokbk malware payload\n(SessionService.exe)\n\nDrokbk malware payload\n(SessionService.exe)\n\nFast Reverse Proxy used by\nCOBALT MIRAGE Cluster B\n\nFast Reverse Proxy used by\nCOBALT MIRAGE Cluster B\n\nFast Reverse Proxy used by\nCOBALT MIRAGE Cluster B\n\nDrokbk C2 server\n\nDrokbk C2 server\n\nDrokbk C2 server\n\nHosts COBALT MIRAGE domain\n(oracle-java.cf)\n\nDrokbk C2 server\n\n\nactivate-microsoft.cf Domain\nname\n\ndns-iprecords.tk Domain\nname\n\noracle-java.cf Domain\nname\n\n51.89.135.154 IP\naddress\n\n142.44.149.199 IP\naddress\n\n\n142.44.149.199/gsdi546gsja URL Drokbk C2 server\n\n\n-----\n\n**Indicator** **Type** **Context**\n\n\nuniversityofmhealth.biz Domain\nname\n\n142.44.198.202 IP\naddress\n\n_Table 1. Indicators for this threat._\n\n\nDrokbk C2 server\n\nDrokbk C2 server\n\n\n[Read more about Iranian threats in the 2022 State of the Threat report. If you need urgent](https://www.secureworks.com/resources/rp-state-of-the-threat-2022)\n[assistance with an incident, contact the Secureworks Incident Response team.](https://www.secureworks.com/contact/emergency-response)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-12-09 - Drokbk Malware Uses GitHub as Dead Drop Resolver.pdf"
    ],
    "report_names": [
        "2022-12-09 - Drokbk Malware Uses GitHub as Dead Drop Resolver.pdf"
    ],
    "threat_actors": [
        {
            "id": "610a7295-3139-4f34-8cec-b3da40add480",
            "created_at": "2023-01-06T13:46:38.608142Z",
            "updated_at": "2025-03-27T02:00:02.87217Z",
            "deleted_at": null,
            "main_name": "Cobalt",
            "aliases": [
                "Cobalt Gang",
                "GOLD KINGSWOOD",
                "COBALT SPIDER",
                "G0080",
                "Mule Libra",
                "Cobalt Group"
            ],
            "source_name": "MISPGALAXY:Cobalt",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "d8af157e-741b-4933-bb4a-b78490951d97",
            "created_at": "2023-01-06T13:46:38.748929Z",
            "updated_at": "2025-03-27T02:00:02.908256Z",
            "deleted_at": null,
            "main_name": "APT35",
            "aliases": [
                "Newscaster Team",
                "Magic Hound",
                "G0059",
                "Phosphorus",
                "Mint Sandstorm",
                "TunnelVision",
                "COBALT MIRAGE"
            ],
            "source_name": "MISPGALAXY:APT35",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "04888f75-158b-47f9-8ad9-4ff83f618ece",
            "created_at": "2024-05-01T02:03:08.03763Z",
            "updated_at": "2025-03-27T02:05:17.319276Z",
            "deleted_at": null,
            "main_name": "COBALT MIRAGE",
            "aliases": [
                "Nemesis Kitten ",
                "PHOSPHORUS ",
                "TunnelVision ",
                "UNC2448 ",
                "DEV-0270 "
            ],
            "source_name": "Secureworks:COBALT MIRAGE",
            "tools": [
                " Custom powershell scripts",
                " DiskCryptor",
                " Drokbk",
                " FRPC",
                " Fast Reverse Proxy (FRP)",
                " Impacket wmiexec",
                " Ngrok",
                " Plink",
                " PowerLessCLR",
                " TunnelFish",
                "BitLocker"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "1699fb41-b83f-42ff-a6ec-984ae4a1031f",
            "created_at": "2022-10-25T16:07:23.83826Z",
            "updated_at": "2025-03-27T02:02:09.995863Z",
            "deleted_at": null,
            "main_name": "Magic Hound",
            "aliases": [
                "APT 35",
                "Ballistic Bobcat",
                "Charming Kitten",
                "CharmingCypress",
                "Cobalt Illusion",
                "Cobalt Mirage",
                "Educated Manticore",
                "Magic Hound",
                "Mint Sandstorm",
                "Operation BadBlood",
                "Operation Sponsoring Access",
                "Operation SpoofedScholars",
                "Operation Thamar Reservoir",
                "Phosphorus",
                "TA453",
                "TEMP.Beanie",
                "Tarh Andishan",
                "Timberworm",
                "TunnelVision",
                "UNC788",
                "Yellow Garuda"
            ],
            "source_name": "ETDA:Magic Hound",
            "tools": [
                "7-Zip",
                "AnvilEcho",
                "BASICSTAR",
                "CORRUPT KITTEN",
                "CWoolger",
                "CharmPower",
                "ChromeHistoryView",
                "CommandCam",
                "DistTrack",
                "DownPaper",
                "FRP",
                "Fast Reverse Proxy",
                "FireMalv",
                "Ghambar",
                "GoProxy",
                "GorjolEcho",
                "HYPERSCRAPE",
                "Havij",
                "MPK",
                "MPKBot",
                "Matryoshka",
                "Matryoshka RAT",
                "MediaPl",
                "Mimikatz",
                "MischiefTut",
                "NETWoolger",
                "NOKNOK",
                "PINEFLOWER",
                "POWERSTAR",
                "PowerLess Backdoor",
                "PsList",
                "Pupy",
                "PupyRAT",
                "SNAILPROXY",
                "Shamoon",
                "TDTESS",
                "WinRAR",
                "WoolenLogger",
                "Woolger",
                "pupy",
                "sqlmap"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1675303705,
    "ts_updated_at": 1743041771,
    "ts_creation_date": 1675237224,
    "ts_modification_date": 1675237224,
    "files": {
        "pdf": "https://archive.orkl.eu/4a960fb9a2d688bcde07f882e04851800782ca5b.pdf",
        "text": "https://archive.orkl.eu/4a960fb9a2d688bcde07f882e04851800782ca5b.txt",
        "img": "https://archive.orkl.eu/4a960fb9a2d688bcde07f882e04851800782ca5b.jpg"
    }
}