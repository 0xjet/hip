{
    "id": "e2b7922e-2d0f-4e56-8e0b-5493de6889a0",
    "created_at": "2023-01-12T15:10:33.251096Z",
    "updated_at": "2025-03-27T02:16:55.58738Z",
    "deleted_at": null,
    "sha1_hash": "8f623edd2d45dd3ed00559047026523f17bbb1dd",
    "title": "2022-03-21 - BitRAT Disguised as Windows Product Key Verification Tool Being Distributed",
    "authors": "",
    "file_creation_date": "2022-05-28T23:23:38Z",
    "file_modification_date": "2022-05-28T23:23:38Z",
    "file_size": 4272069,
    "plain_text": "# BitRAT Disguised as Windows Product Key Verification Tool Being Distributed\n\n**asec.ahnlab.com/en/32781/**\n\nMarch 21, 2022\n\nThe ASEC analysis team has recently discovered BitRAT which is being distributed via\nwebhards. Because the attacker disguised the malware as Windows 10 license verification\ntool from the development stage, users who download illegal crack tools from webhard and\ninstall it to verify Windows license are at risk of having BitRAT installed into their PC.\n\nThe following shows a post that was uploaded to webhard, one that harbors the malware.\nThe title is [New][Quick Install]Windows License Verification[One-click].\n\n**Figure 1. Post disguised as download of Windows license verification tool – 1**\n\n\n-----\n\n**Figure 2. Post disguised as download of Windows license verification tool – 2**\nA compressed file named ‘Program.zip’ is downloaded, and it is compressed and locked with\na password ‘1234’. It contains a Windows 10 license verification tool named\n‘W10DigitalActivation.exe’.\n\n\n-----\n\n**Figure 3. Files included in compressed file**\n‘W10DigitalActivation.exe’ is a 7z SFX file that carries an actual verification tool called\n‘W10DigitalActivation.msi’ and the malware named W10DigitalActivation_Temp.msi. When\nthe user double-clicks the file, it installs both files concurrently. As both the malware and the\nverification tool are run at the same time, the user is tricked into thinking that the tool is\nrunning properly as shown below.\n\n**Figure 4. Malware inside 7z SFX file**\nUnlike its name, ‘W10DigitalActivation_Temp.msi’ is a downloader with exe extension that\ndownloads additional malware. When run, it connects to following C&C servers it harbors\ninternally, exchanging encrypted strings. Afterward, it decrypts the strings to ultimately\nacquire a download URL for the additional payload.\n\n\n-----\n\n**Figure 5. C&C URL of downloader malware**\nThe downloader installs the malware into the Windows startup program folder and deletes\nitself. Normally, the first file that is installed is a downloader of the same kind, and the\ndownloader run this way ultimately installs BitRAT into the path %TEMP% as\n‘Software_Reporter_Tool.exe’.\n\n**Figure 6. Downloading downloader and BitRAT**\nNote that this downloader is equipped with additional features and is not a simple program\nby any means. As shown in the figure below, one of its features uses a powershell command\nto add the Windows startup program folder—where the downloader will be installed—as an\nexclusion path for Windows Defender, and adding the BitRAT process name\n‘Software_Reporter_Tool.exe’ as an exclusion process for Windows Defender.\n\n\n-----\n\n**Figure 7. Adding as Windows Defender exclusion path**\nSeeing how this malware uses webhard which is considered as the most-used file-sharing\nplatform in Korea and includes Korean characters in its code as shown in the figure below, it\nappears that the attacker is a Korean speaker.\n\n**Figure 8. Code that contains Korean characters**\nThe malware that is ultimately installed is a RAT (Remote Access Trojan) malware called\nBitRAT. BitRAT has been in sale via a hacking forum since 2020 and is being continuously\nused by attackers.\n\n\n-----\n\n**Figure 9. Image of BitRAT introduction – 1**\n\n\n-----\n\n**Figure 10. Image of BitRAT introduction – 2**\nBecause BitRAT is a RAT malware, its attacker can gain control of the system infected with\nit. BitRAT not only provides basic control features such as running process tasks, service\ntasks, file tasks, and remote commands, but also provides extra options such as various infostealing features, HVNC, remote desktop, coin mining, and proxies.\n\n\n-----\n\n**Figure 11. BitRAT C&C panel**\nThe following is the list of the features that BitRAT provides.\n\n**1. Network Communication Method**\n\n– Encrypted communication using TLS 1.2\n\n– Communication using Tor\n\n**2. Basic Control**\n\n– Process manager\n\n– Service manager\n\n– File manager\n\n– Windows manager\n\n– Software manager\n\n**3. Information Theft**\n\n– Keylogging\n\n– Clipboard logging\n\n– Webcam logging\n\n– Audio logging\n\n– Application (e.g. Web browsers) account credential theft\n\n**4. Remote Control**\n\n– Remote desktop\n\n– hVNC (Hidden Desktop)\n\n**5. Proxy**\n\n– SOCKS5 Proxy: port forwarding feature using UPnP\n\n– Reverse Proxy: SOCKS4 Proxy\n\n\n-----\n\n**6. Coin Mining**\n– XMRig CoinMiner\n\n**7. etc.**\n– DDoS attack\n– UAC Bypass\n– Windows Defender deactivation\n\nNote that BitRAT uses the revealed TinyNuke’s code, just like AveMaria. The following is a\ncomparison of TinyNuke’s hVNC (routine related to Hidden Desktop) and BitRAT’s code.\n\n**Figure 12. TinyNuke and BitRAT’s hVNC routine**\nTinyNuke verifies and uses a signature string called ‘AVE_MARIA’ in Reverse SOCKS4\nProxy and Hidden Desktop feature. AveMaria adopted Reverse SOCKS4 Proxy feature from\nTinyNuke, and the name was given based on the string. BitRAT, on the other hand, used\nHidden Desktop feature, and the signature string is the same.\n\nNote that TinyNuke was used by the Kimsuky group in the past. Among myriad of features,\nonly the Hidden Desktop feature was adopted and used.\n\n**[[ASEC Blog] VNC Malware (TinyNuke, TightVNC) Used by Kimsuky Group](https://asec.ahnlab.com/en/27346/)**\n\n**[[ASEC Blog] AveMaria malware being distributed as spam mail](https://asec.ahnlab.com/en/17692/)**\n\n\n-----\n\nAs shown in the examples above, the malware is being distributed actively via file-sharing\nwebsites such as Korean webhards. As such, caution is advised when running executables\ndownloaded from a file-sharing website. It is recommended for the users to download\nproducts from the official websites of developers.\n\nAhnLab’s anti-malware software, V3, detects and blocks the malware above using the\naliases below.\n\n**[File Detection]**\n– Trojan/Win.MalPacked.C5007707 (2022.03.12.04)\n– Dropper/Win.BitRAT.C5012624 (2022.03.16.02)\n– Downloader/Win.Generic.C5012582 (2022.03.16.01)\n– Downloader/Win.Generic.C5012594 (2022.03.16.01)\n– Backdoor/Win.BitRAT.C5012593 (2022.03.16.01)\n– Backdoor/Win.BitRAT.C5012748 (2022.03.16.02)\n\n**[Behavior Detection]**\n– Malware/MDP.AutoRun.M1288\n\n**[IOC]**\n**Dropper MD5**\n6befd2bd3005a0390153f643ba248e25\n\n**Downloader malware MD5**\n60ee7740c4b7542701180928ef6f0d53\nc4740d6a8fb6e17e8d2b21822c45863b\n\n**BitRAT MD5**\nb8c39c252aeb7c264607a053f368f6eb\ne03a79366acb221fd5206ab4987406f2\nea1b987a7fdfc2996d5f314a20fd4d99\n54ef1804c22f6b24a930552cd51a4ae2\n\n**Downloader malware’s C&C Server**\n– hxxp://cothdesigns[.]com:443/1480313\n– hxxp://cothdesigns[.]com:443/4411259\n– hxxp://jmuquwk.duckdns[.]org:443/1480313\n– hxxp://nnmmdlc.duckdns[.]org:443/1480313\n\n**Additional Payload Download URL – Downloader**\n– hxxp://kx3nz98.duckdns[.]org:443/v/V_1267705.exe\n– hxxp://108.61.207[.]100:443/v/V_5248849.exe\n\n\n-----\n\n**Additional Payload Download URL – BitRAT**\n– hxxp://kx3nz98.duckdns[.]org:443/v/A_1992262.exe\n– hxxp://108.61.207[.]100:443/result/A_1146246.exe\n\n**BitRAT C&C**\n– z59okz.duckdns[.]org:5223\n– cothdesigns[.]com:80\n\n**Subscribe to AhnLab’s next-generation threat intelligence platform ‘AhnLab TIP’ to**\n**check related IOC and detailed analysis information.**\n\n[Categories:Malware Information](https://asec.ahnlab.com/en/category/malware-information/)\n\n[Tagged as:BitRAT,](https://asec.ahnlab.com/tag/bitrat/) [rat,](https://asec.ahnlab.com/en/tag/rat-en/) [TinyNuke,](https://asec.ahnlab.com/tag/tinynuke/) [webhard](https://asec.ahnlab.com/en/tag/webhard-en/)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-03-21 - BitRAT Disguised as Windows Product Key Verification Tool Being Distributed.pdf"
    ],
    "report_names": [
        "2022-03-21 - BitRAT Disguised as Windows Product Key Verification Tool Being Distributed.pdf"
    ],
    "threat_actors": [
        {
            "id": "dc78f675-b309-431d-8160-b8dcff037d4f",
            "created_at": "2024-05-01T02:03:08.142224Z",
            "updated_at": "2025-03-27T02:05:17.417972Z",
            "deleted_at": null,
            "main_name": "NICKEL KIMBALL",
            "aliases": [
                "Black Banshee ",
                "Crooked Pisces ",
                "Emerald Sleet ",
                "Kimsuky ",
                "Opal Sleet ",
                "SharpTongue ",
                "TA427 ",
                "THALLIUM ",
                "Velvet Chollima ",
                "APT43 "
            ],
            "source_name": "Secureworks:NICKEL KIMBALL",
            "tools": [
                " KONNI",
                " KimJongRAT",
                " Kimsuky",
                "BabyShark"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "760f2827-1718-4eed-8234-4027c1346145",
            "created_at": "2023-01-06T13:46:38.670947Z",
            "updated_at": "2025-03-27T02:00:02.888195Z",
            "deleted_at": null,
            "main_name": "Kimsuky",
            "aliases": [
                "Thallium",
                "G0086",
                "APT43",
                "Springtail",
                "Sparkling Pisces",
                "Velvet Chollima",
                "Black Banshee",
                "Operation Stolen Pencil",
                "Emerald Sleet",
                "THALLIUM"
            ],
            "source_name": "MISPGALAXY:Kimsuky",
            "tools": [
                "RevClient",
                "xrat",
                "QUASARRAT",
                "RDP Wrapper",
                "TightVNC",
                "BabyShark"
            ],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "191d7f9a-8c3c-442a-9f13-debe259d4cc2",
            "created_at": "2022-10-25T15:50:23.280374Z",
            "updated_at": "2025-03-27T02:00:55.423485Z",
            "deleted_at": null,
            "main_name": "Kimsuky",
            "aliases": [
                "Kimsuky",
                "Black Banshee",
                "Velvet Chollima",
                "Emerald Sleet",
                "THALLIUM",
                "APT43",
                "TA427"
            ],
            "source_name": "MITRE:Kimsuky",
            "tools": [
                "schtasks",
                "Amadey",
                "Brave Prince",
                "CSPY Downloader",
                "gh0st RAT",
                "AppleSeed",
                "NOKKI",
                "QuasarRAT",
                "Gold Dragon",
                "PsExec",
                "KGH_SPY",
                "Mimikatz",
                "BabyShark"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "71a1e16c-3ba6-4193-be62-be53527817bc",
            "created_at": "2022-10-25T16:07:23.753455Z",
            "updated_at": "2025-03-27T02:02:09.963016Z",
            "deleted_at": null,
            "main_name": "Kimsuky",
            "aliases": [
                "APT 43",
                "Black Banshee",
                "Emerald Sleet",
                "ITG16",
                "KTA082",
                "Kimsuky",
                "Larva-24005",
                "Operation Baby Coin",
                "Operation Covert Stalker",
                "Operation DEEP#DRIVE",
                "Operation DEEP#GOSU",
                "Operation Kabar Cobra",
                "Operation Mystery Baby",
                "Operation Red Salt",
                "Operation Smoke Screen",
                "Operation Stealth Power",
                "Operation Stolen Pencil",
                "SharpTongue",
                "Sparkling Pisces",
                "Springtail",
                "TA406",
                "TA427",
                "Thallium",
                "UAT-5394",
                "Velvet Chollima"
            ],
            "source_name": "ETDA:Kimsuky",
            "tools": [
                "AngryRebel",
                "AppleSeed",
                "BITTERSWEET",
                "BabyShark",
                "BoBoStealer",
                "CSPY Downloader",
                "Farfli",
                "FlowerPower",
                "Gh0st RAT",
                "Ghost RAT",
                "Gold Dragon",
                "GoldDragon",
                "GoldStamp",
                "JamBog",
                "KGH Spyware Suite",
                "KGH_SPY",
                "KPortScan",
                "KimJongRAT",
                "Kimsuky",
                "LATEOP",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "Lovexxx",
                "MailPassView",
                "Mechanical",
                "Mimikatz",
                "MoonPeak",
                "Moudour",
                "MyDogs",
                "Mydoor",
                "Network Password Recovery",
                "PCRat",
                "ProcDump",
                "PsExec",
                "ReconShark",
                "Remote Desktop PassView",
                "SHARPEXT",
                "SWEETDROP",
                "SmallTiger",
                "SniffPass",
                "TODDLERSHARK",
                "TRANSLATEXT",
                "Troll Stealer",
                "TrollAgent",
                "VENOMBITE",
                "WebBrowserPassView",
                "xRAT"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673536233,
    "ts_updated_at": 1743041815,
    "ts_creation_date": 1653780218,
    "ts_modification_date": 1653780218,
    "files": {
        "pdf": "https://archive.orkl.eu/8f623edd2d45dd3ed00559047026523f17bbb1dd.pdf",
        "text": "https://archive.orkl.eu/8f623edd2d45dd3ed00559047026523f17bbb1dd.txt",
        "img": "https://archive.orkl.eu/8f623edd2d45dd3ed00559047026523f17bbb1dd.jpg"
    }
}