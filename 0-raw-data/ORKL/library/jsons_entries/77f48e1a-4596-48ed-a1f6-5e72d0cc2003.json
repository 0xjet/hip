{
    "id": "77f48e1a-4596-48ed-a1f6-5e72d0cc2003",
    "created_at": "2023-01-12T15:00:41.756011Z",
    "updated_at": "2025-03-27T02:05:42.744319Z",
    "deleted_at": null,
    "sha1_hash": "7e2f54bcbc2955b5d9a2672fbc0ea58d2de09946",
    "title": "2017-06-27 - Neutrino modification for POS-terminals",
    "authors": "",
    "file_creation_date": "2022-05-29T10:35:00Z",
    "file_modification_date": "2022-05-29T10:35:00Z",
    "file_size": 460623,
    "plain_text": "# Neutrino modification for POS-terminals\n\n**[securelist.com/neutrino-modification-for-pos-terminals/78839/](https://securelist.com/neutrino-modification-for-pos-terminals/78839/)**\n\nAuthors\n\n[Sergey Yunakovsky](https://securelist.com/author/sergeyyunakovsky/)\n\nFrom time to time authors of effective and long-lived Trojans and viruses create new\nmodifications and forks of them, like any other software authors. One of the brightest\nexamples amongst them is Zeus (Trojan-Spy.Win32.Zbot, based on classification of\n“Kaspersky Lab”), which continues to spawn new modifications of itself each year. In a\nstrange way this malware becomes similar to his prototype from Greek mythology. We can\nalso attribute such malware familes as Mirai, NJRat, Andromeda and so on to this “prolific”\ngroup. Malware named “Neutrino” takes an important place in this row of well-known trojans,\nproviding various types of infection, spreading and a useful payload.\n\nIn this article we analyze a very special species – a variant which could collect credit card\ninformation from POS.\n\nProducts of “Kaspersky Lab” detect it as Trojan-Banker.Win32.NeutrinoPOS\n\nMD5 of descripted file: 0CF70BCCFFD1D2B2C9D000DE496D34A1\n\n\n-----\n\n## First stage\n\nThe Trojan takes a long “sleep” before it starts. It seems that such code was added to fool\nsome AV sandboxes. To determine the period of delay, the Trojan uses a pseudorandom\nnumber generator.\n\n**C&C Communication**\n\nAt the next stage, the Trojan extracts a C&C-address list from its body. The list is encoded at\nBase64. After decoding, the Trojan tries to find a working C&C, using the following algorithm:\n\nSends POST-request to server, passing through its body encoding in base64 string\n“enter” (ZW50ZXI=). All encoded strings contains prefix “_wv=”\n\nWorking server responds with 404 page, which contains at the end of it encoded string\n**c3VjY2Vzcw== (success). In case of “success”, the rTojan marks the address of the**\nused servers as working.\n\n\n-----\n\nWe should also notice that in the header of each POST-request there is auth field, which\nstays the same for each sample from family NeutrinoPOS.\n\nRestored code of C&C-server check\n\nThe C&C address stored at registry branch HKCR\\Sofrware\\alFSVWJBis the same as other\nvariables and data usedby NeutrinoPOS sample. Branch name differs from the one\ndescribed here, but after full comparison of both samples, we can claim that both samples\nare the same modification of Neutrino.\n\n## C&C Commands\n\nThe described variant contains listed functions:\n\nDownload and start file;\nMake screenshot;\nSearch process by name;\nChange register branches;\nSearch file by name on infected host and send it to C&C;\nProxy\n\nThe server sends commands in plain view, like “PROXY”, “screenshot” and so on, encoded\nin base64. Following analysis we can claim that in the current versions of Neutrino there is\nno functions for DDOS attacks.\n\n\n-----\n\nImplementation of command control sum calculating\n\nExamples of few commands (marked with red line on screenshot above):\n\nRolxor(“PROXY”) = 0xA53EC5C\nRolxor(“screenshot”) = 0xD9FA0E3\n\n\n-----\n\nNeutrinoPOS command handler\n\n## Stealing of credit cards\n\nThe algorithm for stealing credit card information is implemented in the Trojan in quite a\nsimple way and described as follows:\n\n\n-----\n\n1. The Trojans start to work through currently running processes, using\n\n**CreateToolhelp32Snapshot\\ Process32FirstW\\Process32NextW.**\n\n2. Using OpenProcess\\VirtualQuery\\ReadProcessMemory, the Trojan gets information\n\nabout the memory pages of the process.\n\n\n-----\n\n3. The Trojan scans the memory pages for string Track1, which marks fields of the first\n\ntrack of the magnetic card. All described fields going one by one:\n\nSequence of symbols in range from ‘0’ to ‘9’ with length equal to 15, 16 or 19.\nSequence checking with Luhn algorithm.\n\nCheck presence of separation symbol ‘^’ in next and previous fields.\nExtract card holder name, with max length, basing on ISO/IEC 7813, equal to 26\nsymbols:\n\n\n-----\n\nRest data (CVC32, expiration date, CVV) extracts as whole block, with check of\nlength and content :\n\n4. Collected data sends to server with mark “Track1”.\n\n\n-----\n\n5. After that, the Trojan starts to extracts next fields with mark Track2 at the beginning:\n\nAt firsts, it extracts PAN with the same checks as on the previous stage.\n\nAs separation symbol using ” ‘ ” or ‘D’\nTrack2 doesn’t contains card holder name — rest data extracts as whole block\n\n6. Collected data sent to server with mark “Track2”\n\n## Distribution Statistics\n\nThe largest areas of infection are Russia and Kazakhstan. Nearly 10% of infected computers\nbelong to small business corporate customers.\n\n\n-----\n\n## Conclusion\n\nAs we can see from the described Trojan Neutrino, despite belonging to an old, well-known\nand researched family, it continues to bring various surprises to malware analysts and\nresearchers in the form of atypical functionality or application. We can see the same situation\nwith Mirai forks, for example, which generate an enormous count across all platforms and in\ndifferent species\n\nGenerally speaking, all publications of malware source code with good architecture and\nvarious functionality will cause interest and attention from malware authors, who will try to\nuse it for nearly all possible ways of illegal money gain. We can assume that right now there\nmay already be new modifications of Neutrino with functionality for crypto-currency mining.\n\n## MD5\n\nCECBED938B10A6EEEA21EAF390C149C1\n\n66DFBA01AE6E3AFE914F649E908E9457\n\n4DB70AE71452647E87380786E065F31E\n\n9D70C5CDEDA945CE0F21E76363FE13C5\n\nB682DA77708EE148B914AAEC6F5868E1\n\n5AA0ADBD3D2B98700B51FAFA6DBB43FD\n\nA03BA88F5D70092BE64C8787E7BC47DE\n\n\n-----\n\nD18ACF99F965D6955E2236645B32C491\n\n3B6211E898B753805581BB41FB483C48\n\n7D28D392BED02F17094929F8EE84234A\n\nC2814C3A0ACB1D87321F9ECFCC54E18C\n\n74404316D9BAB5FF2D3E87CA97DB5F0C\n\n7C6FF28E0C882286FBBC40F27B6AD248\n\n729C89CB125DF6B13FA2666296D11B5A\n\n855D3324F26BE1E3E3F791C29FB06085\n\n2344098C7FA4F859BE1426CE2AD7AE8E\n\nC330C636DE75832B4EC78068BCF0B126\n\nCCBDB9F4561F9565F049E43BEF3E422F\n\n53C557A8BAC43F47F0DEE30FFFE88673\n\n## C&C\n\nhxxp://pranavida.cl/director/tasks.php\n\nhxxps://5.101.4.41/panel/tasks.php\n\nhxxps://5.101.4.41/updatepanel/tasks.php\n\nhxxp://jkentnew.5gbfree.com/p/tasks.php\n\nhxxp://124.217.247.72/tasks.php\n\nhxxp://combee84.com/js/css/tasks.php\n\nhxxp://nut29.xsayeszhaifa.bit/newfiz29/logout.php\n\nhxxp://nut29.nsbacknutdoms11war.com/newfiz29/logout.php\n\nhxxp://jbbrother.com/jbb/meaca/obc/pn/tasks.php\n\nhxxp://ns1.posnxqmp.ru/PANEL/tasks.php\n\nhxxp://nut25.nsbacknutdoms11war.com/newfiz25/logout.php\n\nhxxp://propertiesofseyshellseden com/newfiz21/logout php\n\n\n-----\n\nhxxp://n31.propertiesofseyshellseden.com/newfiz31/logout.php\n\nhxxp://propertiesofseyshellseden.com/newfiz21/logout.php\n\nhxxp://n31.propertiesofseyshellseden.com/newfiz31/logout.php\n\n[POS malware](https://securelist.com/tag/pos-malware/)\n[Trojan Banker](https://securelist.com/tag/trojan-banker/)\n[ZeuS](https://securelist.com/tag/zeus/)\n\nAuthors\n\n[Sergey Yunakovsky](https://securelist.com/author/sergeyyunakovsky/)\n\nNeutrino modification for POS-terminals\n\nYour email address will not be published. Required fields are marked *\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2017/2017-06-27 - Neutrino modification for POS-terminals.pdf"
    ],
    "report_names": [
        "2017-06-27 - Neutrino modification for POS-terminals.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673535641,
    "ts_updated_at": 1743041142,
    "ts_creation_date": 1653820500,
    "ts_modification_date": 1653820500,
    "files": {
        "pdf": "https://archive.orkl.eu/7e2f54bcbc2955b5d9a2672fbc0ea58d2de09946.pdf",
        "text": "https://archive.orkl.eu/7e2f54bcbc2955b5d9a2672fbc0ea58d2de09946.txt",
        "img": "https://archive.orkl.eu/7e2f54bcbc2955b5d9a2672fbc0ea58d2de09946.jpg"
    }
}