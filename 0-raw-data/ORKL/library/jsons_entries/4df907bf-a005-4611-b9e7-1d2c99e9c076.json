{
    "id": "4df907bf-a005-4611-b9e7-1d2c99e9c076",
    "created_at": "2024-11-01T02:05:55.966067Z",
    "updated_at": "2025-03-27T02:08:40.233373Z",
    "deleted_at": null,
    "sha1_hash": "9b56b518564c50e9bdca93c13e988670589e33c7",
    "title": "",
    "authors": "",
    "file_creation_date": "2024-06-18T00:51:35Z",
    "file_modification_date": "2024-06-18T00:55:28Z",
    "file_size": 3329736,
    "plain_text": "-----\n\n```\n  T D R 4 3 2\n\n### New tactics and techniques for proactive threat detection\n\n###### Ben Fletcher Steve de Vera\n\n (he/him) (he/him) AWS EMEA CIRT LEAD AWS CIRT Manager Amazon Web Services Amazon Web Services\n\n```\n\n-----\n\n###### • About AWS CIRT\n\n • Statistics\n\n • Current threat actor tactics\n\n • New threat actor tactics\n\n • Security best practices\n\n\n-----\n\n##### THIS SESSION IS INTERACTIVE!\n\n Feel free to ask questions, make comments, participate\n\n\n-----\n\n### About AWS CIRT\n\n\n-----\n\n###### A specialized team that assists and advises customers during suspected active security events, on the customer’s side of the AWS Shared Responsibility Model\n\n Respond Recover Learn Educate\n\n Global team 24/7, follow- Assist and advise customers Assist in root cause Provide advice to the-sun model with active triage and analysis of a customer’s customers for long-term\n recovery from their security AWS service logs for their recovery from their event on AWS active security event active security event\n\n\n-----\n\n### Statistics\n\n\n-----\n\n#### most often?\n\n###### Cross-account Vulnerable\n Brute force\n permissions web apps\n\n #1 #2\n #3\n\n Lost/leaked access\n Open S3 buckets DDoS\n keys/credentials\n\n #4 #5 #6\n\n\n-----\n\n#### most often?\n\n###### Lost/leaked access\n keys/credentials\n\n #4\n\n\n-----\n\n#### most often?\n\n# 66%\n###### valid IAM credentials\n Lost/leaked access\n keys/credentials\n\n #4\n\n\n-----\n\n#### most often?\n\n# 66%\n###### valid IAM credentials\n Lost/leaked access\n keys/credentials\n\n #4\n\n# 1/3\n###### of those are root credentials\n\n [20% of all initial access method use]\n\n\n-----\n\n#### most often?\n\n# 66%\n###### valid IAM credentials\n Lost/leaked access\n keys/credentials\n\n #4\n\n# 1/3\n###### of those are root credentials\n\n [20% of all initial access method use]\n\n# 13%\n\n\n-----\n\n###### Opportunistic\n Resource hijack Ransom events destruction\n\n A zero trust strategy\n\n\n-----\n\n###### Technique: Valid cloud credentials\n\n\n-----\n\n#### are used?\n\n###### ~Two weeks ~One week 24 hours\n\n #1 #2 #3\n\n Minutes, if not\n 4 hours\n seconds\n\n #4 #5\n\n\n-----\n\n###### Technique: Valid cloud credentials\n\n Minutes, if not\n seconds\n\n #5\n\n\n-----\n\n### Current threat actor tactics\n\n\n-----\n\n##### DISCLAIMER:\n\n Tactics and techniques presented\n do not constitute vulnerabilities\n within AWS\n\n\n-----\n\n###### Tactic: Impact Technique: Resource hijacking\n\n1)\n\n2)\n\n3)\n\n                                                                                                                    -\n\n                                                                                                                    -\n\n                                                                                                                    -\n\n4)\n\n\n-----\n\n###### Tactic: Impact Technique: Resource hijacking\n\n 1) Threat actor obtains access to AWS\n account or hosted resource\n\n2)\n\n3)\n\n                                                                                                                    -\n\n                                                                                                                    -\n\n                                                                                                                    -\n\n4)\n\n\n-----\n\n###### Tactic: Impact Technique: Resource hijacking\n\n 1) Threat actor obtains access to AWS\n account or hosted resource\n\n 2) Threat actor will mine cryptocurrency\n from the resource\n\n3)\n\n                                                                                                                    -\n\n                                                                                                                    -\n\n                                                                                                                    -\n\n4)\n\n\n-----\n\n###### Tactic: Impact Technique: Resource hijacking\n\n 1) Threat actor obtains access to AWS\n account or hosted resource\n\n 2) Threat actor will mine cryptocurrency\n from the resource\n\n 3) Resources created in AWS account:\n\n • RunInstances\n • CreateStack\n • CreateCluster\n\n4)\n\n\n-----\n\n###### Tactic: Impact Technique: Resource hijacking\n\n 1) Threat actor obtains access to AWS\n account or hosted resource\n\n 2) Threat actor will mine cryptocurrency\n from the resource\n\n 3) Resources created in AWS account:\n\n • RunInstances\n • CreateStack\n • CreateCluster 4) Resources created in unused\n AWS Regions\n\n\n-----\n\n###### Tactic: Impact Technique: Resource hijacking\n\n • Use SCPs to prevent resource creation – especially in unused Regions\n\n • Apply principle of least privilege to assigned permissions\n\n\n-----\n\n###### Tactic: Impact Technique: Defacement\n\n1)\n\n2)\n\n3)\n\n\n-----\n\n###### Tactic: Impact Technique: Defacement\n\n 1) Customer has CNAME pointing to a resource (S3 bucket, EC2\n instance, Elastic IP)\n\n2)\n\n3)\n\n\n-----\n\n###### Tactic: Impact Technique: Defacement\n\n 1) Customer has CNAME pointing to a resource (S3 bucket, EC2\n instance, Elastic IP)\n\n 2) The resource is deleted, but the CNAME still exists\n\n3)\n\n\n-----\n\n###### Tactic: Impact Technique: Defacement\n\n 1) Customer has CNAME pointing to a resource (S3 bucket, EC2\n instance, Elastic IP)\n\n 2) The resource is deleted, but the CNAME still exists\n\n 3) Threat actor creates a resource that the CNAME still points to\n\n\n-----\n\n-----\n\n###### Customer\n\n\n-----\n\n###### S3 bucket\n\n Customer s3-newco-random\n\n\n-----\n\n###### S3 bucket S3 bucket configured as static website\n\n Customer s3-newco-random http://s3-newco-random\n .s3-website-us-east-1.amazonaws.com\n\n\n-----\n\n###### S3 bucket S3 bucket configured as static website CNAME pointing to S3 bucket\n configured as static website\n\n Customer s3-newco-random http://s3-newco-random CNAME: app1.newco.com\n .s3-website-us-east-1.amazonaws.com\n points to: http://s3-newco-random .s3-website-us-east-1.amazonaws.com\n\n\n-----\n\n###### S3 bucket S3 bucket configured as static website CNAME pointing to S3 bucket\n configured as static website\n\n## X X\n###### Customer s3-newco-random http://s3-newco-random CNAME: app1.newco.com\n .s3-website-us-east-1.amazonaws.com\n points to: http://s3-newco-random .s3-website-us-east-1.amazonaws.com\n\n\n-----\n\n###### S3 bucket S3 bucket configured as static website CNAME pointing to S3 bucket\n configured as static website\n\n## X X\n\n###### Customer s3-newco-random http://s3-newco-random CNAME: app1.newco.com\n .s3-website-us-east-1.amazonaws.com\n points to: http://s3-newco-random .s3-website-us-east-1.amazonaws.com\n\n Threat\n actor\n\n\n-----\n\n###### S3 bucket S3 bucket configured as static website CNAME pointing to S3 bucket\n configured as static website\n\n## X X\n\n###### Customer s3-newco-random http://s3-newco-random CNAME: app1.newco.com\n .s3-website-us-east-1.amazonaws.com\n points to: http://s3-newco-random .s3-website-us-east-1.amazonaws.com\n S3 bucket\n recreated\n\n Threat\n s3-newco-random\n actor\n\n\n-----\n\n###### S3 bucket S3 bucket configured as static website CNAME pointing to S3 bucket\n configured as static website\n\n## X X\n\n###### Customer s3-newco-random http://s3-newco-random CNAME: app1.newco.com\n .s3-website-us-east-1.amazonaws.com\n points to: http://s3-newco-random .s3-website-us-east-1.amazonaws.com\n S3 bucket S3 bucket configured as static website\n recreated with malicious content\n\n Threat\n s3-newco-random http://s3-newco-random\n actor\n .s3-website-us-east-1.amazonaws.com\n\n\n-----\n\n###### S3 bucket S3 bucket configured as static website CNAME pointing to S3 bucket\n configured as static website\n\n## X X\n\n###### Customer s3-newco-random http://s3-newco-random CNAME: app1.newco.com\n .s3-website-us-east-1.amazonaws.com\n points to: http://s3-newco-random .s3-website-us-east-1.amazonaws.com\n S3 bucket S3 bucket configured as static website\n recreated with malicious content\n\n Threat\n s3-newco-random http://s3-newco-random\n actor\n .s3-website-us-east-1.amazonaws.com\n\n\n-----\n\n###### • Review hosted zones and delete unused CNAMEs\n\n • When de-provisioning, remove CNAMEs first\n\n\n-----\n\n###### Tactic: Impact Technique: Data destruction\n\n1)\n\n2)\n\n3)\n\n                                                                                                                    -\n\n                                                                                                                    -\n\n                                                                                                                    -\n\n                                                                                                                    -\n\n                                                                                                                    -\n\n                                                                                                                    -\n\n\n-----\n\n###### Tactic: Impact Technique: Data destruction\n\n 1) Threat actor obtains access to AWS account or resource (Amazon S3\n or Amazon RDS)\n\n2)\n\n3)\n\n                                                                                                                    -\n\n                                                                                                                    -\n\n                                                                                                                    -\n\n                                                                                                                    -\n\n                                                                                                                    -\n\n                                                                                                                    -\n\n\n-----\n\n###### Tactic: Impact Technique: Data destruction\n\n 1) Threat actor obtains access to AWS account or resource (Amazon S3\n or Amazon RDS)\n\n 2) Threat actor will attempt to delete resources or data\n\n3)\n\n                                                                                                                    -\n\n                                                                                                                    -\n\n                                                                                                                    -\n\n                                                                                                                    -\n\n                                                                                                                    -\n\n                                                                                                                    -\n\n\n-----\n\n###### Tactic: Impact Technique: Data destruction\n\n 1) Threat actor obtains access to AWS account or resource (Amazon S3\n or Amazon RDS)\n\n 2) Threat actor will attempt to delete resources or data\n\n 3) Resources deleted in AWS account:\n\n • DeleteBucket\n • DeleteObject\n • DeleteDBInstance\n • DeleteDBCluser\n • DeleteDBSnapshot\n • AuthorizeSecurityGroupIngress\n\n\n-----\n\n###### Tactic: Impact Technique: Data destruction\n\n • Apply and review policies (resource policies and lifecycle policies), S3 Object Lock\n\n • Principle of least privilege\n\n • Use and test backup methodologies\n\n\n-----\n\n###### Tactic: Credential access Technique: Unsecured credentials\n\n1)\n\n2)\n\n\n-----\n\n###### Tactic: Credential access Technique: Unsecured credentials\n\n 1) Threat actor obtains ability to obtain IMDSv1 credentials\n from resource\n\n2)\n\n\n-----\n\n###### Tactic: Credential access Technique: Unsecured credentials\n\n 1) Threat actor obtains ability to obtain IMDSv1 credentials\n from resource\n\n 2) Threat actor exports and uses credentials\n\n\n-----\n\n###### AWS account\n\n Virtual private cloud (VPC)\n\n Public subnet\n\n Web application Attached\n Threat on EC2 role (webdev)\n actor\n\n\n-----\n\n###### AWS account\n\n Virtual private cloud (VPC)\n\n Public subnet\n\n Use SSRF to exploit web application\n vulnerability Web application Attached\n Threat on EC2 role (webdev)\n actor\n\n\n-----\n\n###### AWS account\n\n Virtual private cloud (VPC)\n\n Public subnet\n\n Use SSRF to exploit web application\n vulnerability Web application Attached\n Threat on EC2 role (webdev)\n actor\n Obtain credentials using IMDSv1 API\n\n\n-----\n\n###### AWS account\n\n Virtual private cloud (VPC)\n\n Public subnet\n\n Use SSRF to exploit web application\n vulnerability Web application Attached\n Threat on EC2 role (webdev)\n actor\n Obtain credentials using IMDSv1 API\n\n Use credentials to access AWS account\n\n\n-----\n\n-----\n\n-----\n\n-----\n\n-----\n\n-----\n\n-----\n\n-----\n\n-----\n\n###### Tactic: Credential access\n#### Mitigations Technique: Unsecured credentials\n\n                          -\n\n                          -\n\n                          -\n\n\n-----\n\n###### Tactic: Credential access\n#### Mitigations Technique: Unsecured credentials\n\n###### • Use require IMDSv2\n\n                          -\n\n                          -\n\n\n-----\n\n###### Tactic: Credential access\n#### Mitigations Technique: Unsecured credentials\n\n###### • Use require IMDSv2\n\n • Use principle of least privilege on EC2\n instance profile\n\n                          -\n\n\n-----\n\n###### Tactic: Credential access\n#### Mitigations Technique: Unsecured credentials\n\n###### • Use require IMDSv2\n\n • Use principle of least privilege on EC2\n instance profile\n\n • Use the\n```\n aws:EC2InstanceSourceVPC\n\n or\n aws:EC2InstanceSourcePrivate\n IPv4 global condition keys in Service\n Control Policies\n\n```\n\n-----\n\n###### Technique: Additional cloud credentials\n\n 1) Credentials exported\n\n\n-----\n\n###### 2) Federation token generated\n\n\n-----\n\n###### 3) Threat actor exports and assumes federation token credentials\n\n\n-----\n\n###### 4) Use exported\n credentials from federation token\n\n\n-----\n\n###### • The session name or ‘user\n name’ can be changed\n\n • Still need to review actions\n by ‘masked’ user\n\n\n-----\n\n###### • GetSessionToken also used\n\n • Generally considered unauthorized if observed\n\n • With both GetFederationToken and\n```\n  GetSessionToken, you can delete the originating\n\n access key and the session will persist\n\n • Can delete/recreate the user\n\n```\n\n-----\n\n###### • Apply inline policy to IAM user (deny based on\n```\n  aws:TokenIssueTime)\n\n```\n\n-----\n\n### Novel threat actor tactics\n\n\n-----\n\n###### Technique: Unused/unsupported cloud regions\n\n 1) Threat actor creates an account\n in an AWS organization\n\n2)\n\n\n-----\n\n###### Technique: Unused/unsupported cloud regions\n\n 1) Threat actor creates an account\n in an AWS organization\n\n 2) Created account is used for\n defense evasion, resource hijacking\n\n\n-----\n\n###### Technique: Unused/unsupported cloud regions\n\n 1) Threat actor creates a standalone\n account with a stolen credit card\n\n2)\n\n\n-----\n\n###### Technique: Unused/unsupported cloud regions\n\n 1) Threat actor creates a standalone\n account with a stolen credit card\n\n 2) Invites account to compromised\n AWS organization\n\n\n-----\n\n###### Technique: Unused/unsupported cloud regions\n 1) Threat actor can remove\n OrganizationAccountAccessRole\n\n2)\n\n3)\n\n\n-----\n\n###### Technique: Unused/unsupported cloud regions\n 1) Threat actor can remove\n OrganizationAccountAccessRole\n\n 2) Victim can apply SCPs, but\n this prevents new actions (existing threat actor resources not affected)\n\n3)\n\n\n-----\n\n###### Technique: Unused/unsupported cloud regions\n 1) Threat actor can remove\n OrganizationAccountAccessRole\n\n 2) Victim can apply SCPs, but\n this prevents new actions (existing threat actor resources not affected)\n\n 3) May need support case to\n remove account\n\n\n-----\n\n###### Technique: Unused/unsupported cloud regions\n 1) Threat actor can remove\n OrganizationAccountAccessRole\n\n 2) Victim can apply SCPs, but\n this prevents new actions (existing threat actor resources not affected)\n\n 3) May need support case to\n remove account\n\n\n-----\n\n###### Technique: Unused/unsupported cloud regions\n\n • Create custom groups or roles\n\n • Use principle of least privilege to restrict\n account creation\n\n • Amazon CloudWatch alarm/SCP for\n```\n InviteAccountToOrganization API call\n\n```\n\n-----\n\n###### Tactic: Impact Technique: Data destruction\n\n 1) Threat actor uses S3 lifecycle\n policies to set parameters to delete objects within 1 day\n\n2)\n\n3)\n\n\n-----\n\n###### Tactic: Impact Technique: Data destruction\n\n 1) Threat actor uses S3 lifecycle\n policies to set parameters to delete objects within 1 day\n\n2)\n\n3)\n\n\n-----\n\n###### Tactic: Impact Technique: Data destruction\n\n 1) Threat actor uses S3 lifecycle\n policies to set parameters to delete objects within 1 day\n\n 2) Form of data destruction\n\n3)\n\n\n-----\n\n###### Tactic: Impact Technique: Data destruction\n\n 1) Threat actor uses S3 lifecycle\n policies to set parameters to delete objects within 1 day\n\n 2) Form of data destruction\n\n 3) Bypasses permissions and\n detections against\n```\n  DeleteObject\n\n```\n\n-----\n\n###### Tactic: Impact Technique: Data destruction\n\n • Apply SCPs to prevent use of PutBucketLifecycle\n\n • Use principle of least privilege\n\n • AWS Config rule for s3-lifecycle-policy-check\n\n\n-----\n\n###### Tactic: Impact Technique: Resource hijacking\n\n 1) Threat actor obtains block of high rate SMS phone numbers from\n telecom provider\n\n 2) Threat actor identifies service that sends SMS text messages\n\n 3) Service used to send numerous text messages\n\n\n-----\n\n###### Tactic: Impact Technique: Resource hijacking\n\n 4) Amazon Cognito used\n\n5)\n\n\n-----\n\n###### Tactic: Impact Technique: Resource hijacking\n\n 4) Amazon Cognito used\n\n 5) APIs observed are SignUp or\n```\n   ResendConfirmationCode\n\n```\n\n-----\n\n###### Tactic: Impact Technique: Resource hijacking\n\n • Change attribute verification and user account confirmation\n\n • Apply AWS WAF to present CAPTCHA\n\n • Apply web ACL rule to inspect request body and match the\n SMS area code\n\n • Amazon Fraud Detector (may require rearchitected solution)\n\n\n-----\n\n###### Tactic: Defense evasion Technique: Indicator removal\n\n 1) Threat actor attempts to leave\n an AWS organization\n\n2)\n\n3)\n\n\n-----\n\n###### Tactic: Defense evasion Technique: Indicator removal\n\n 1) Threat actor attempts to leave\n an AWS organization\n\n2)\n\n3)\n\n\n-----\n\n###### Tactic: Defense evasion Technique: Indicator removal\n\n 1) Threat actor attempts to leave\n an AWS organization\n\n 2) Prevents SCPs from being\n applied, used for resource hijacking\n\n3)\n\n\n-----\n\n###### Tactic: Defense evasion Technique: Indicator removal\n\n 1) Threat actor attempts to leave\n an AWS organization\n\n 2) Prevents SCPs from being\n applied, used for resource hijacking\n\n 3) Form of defense evasion,\n AWS billing reports migrate\n\n\n-----\n\n###### Tactic: Defense evasion Technique: Indicator removal\n\n • Apply SCPs to prevent LeaveOrganization API\n call in member account\n\n • Use principle of least privilege to limit use of\n```\n RemoveAccountFromOrganization in\n\n management account\n\n```\n\n-----\n\n###### Tactic: Persistence\n\n#### Premise Technique: Create account\n\n###### 1) Threat actor gains access to an\n AWS organization\n\n2)\n\n3)\n\n\n-----\n\n###### Tactic: Persistence\n\n#### Premise Technique: Create account\n\n###### 1) Threat actor gains access to an\n AWS organization\n\n 2) AWS IAM Identity Center\n enabled to provision access to accounts\n\n3)\n\n\n-----\n\n###### Tactic: Persistence\n\n#### Premise Technique: Create account\n\n###### 1) Threat actor gains access to an\n AWS organization\n\n 2) AWS IAM Identity Center\n enabled to provision access to accounts\n\n 3) Adds extra steps to containment\n\n\n-----\n\n###### Tactic: Persistence\n\n#### Alternative Technique: Create account\n\n###### 3) Access to a specific account/s\n within an AWS organization\n\n4)\n\n5)\n\n\n-----\n\n###### Tactic: Persistence\n\n#### Alternative Technique: Create account\n\n###### 3) Access to a specific account/s\n within an AWS organization\n\n 4) IAM used to add a SAML or\n OpenIDC provider\n\n5)\n\n\n-----\n\n###### Tactic: Persistence\n\n#### Alternative Technique: Create account\n\n###### 3) Access to a specific account/s\n within an AWS organization\n\n 4) IAM used to add a SAML or\n OpenIDC provider\n\n 5) Look for CreateSAMLProvider\n or CreateOIDCProvider events in AWS CloudTrail\n\n\n-----\n\n###### Tactic: Persistence\n\n#### Mitigations Technique: Create account\n\n###### • Remove identity provider from IAM Identity Center or IAM\n\n                                              -\n\n\n-----\n\n###### Tactic: Persistence\n\n#### Mitigations Technique: Create account\n\n###### • Remove identity provider from IAM Identity Center or IAM\n\n • Use Amazon EventBridge to watch for StartSSO,\n```\n   CreateSAMLProvider or\n   CreateOIDCProvider events\n in CloudTrail\n\n```\n\n-----\n\n###### Technique: Exploit public-facing application\n\n#### Premise\n\n1)\n\n                                                                                                                                  -\n\n                                                                                                                                  -\n\n2)\n\n3)\n\n\n-----\n\n###### Technique: Exploit public-facing application\n\n#### Premise\n\n###### 1) Threat actor identifies vulnerable\n version of Laravel\n\n • CVE-2021-3129\n • Debug mode\n\n2)\n\n3)\n\n\n-----\n\n###### Technique: Exploit public-facing application\n\n#### Premise\n\n###### 1) Threat actor identifies vulnerable\n version of Laravel\n\n • CVE-2021-3129\n • Debug mode\n\n 2) Debug mode allows access to .env file\n\n3)\n\n\n-----\n\n###### Technique: Exploit public-facing application\n\n#### Premise\n\n###### 1) Threat actor identifies vulnerable\n version of Laravel\n\n • CVE-2021-3129\n • Debug mode\n\n 2) Debug mode allows access to .env file\n\n 3) .env configured with AWS credentials\n\n\n-----\n\n###### Technique: Exploit public-facing application\n\n#### Premise\n\n###### 3) For server in debug mode, specific\n data sent generates a debug file\n\n4)\n\n\n-----\n\n###### Technique: Exploit public-facing application\n\n#### Premise\n\n###### 3) For server in debug mode, specific\n data sent generates a debug file\n\n 4) File contains .env variables including\n AWS credentials\n\n\n-----\n\n###### Technique: Exploit public-facing application\n\n#### Mitigations\n\n###### • Confirm Laravel is up-to-date and fully patched\n\n • Disable debug mode in production – set APP_DEBUG = FALSE\n\n • Use principle of least privilege for credentials in Laravel .env\n\n • AWS Secrets Manager for hardcoded secrets\n\n\n-----\n\n###### Tactic: Defense evasion\n\n#### Premise Technique: Impair defenses\n\n###### 1) Threat actor gains access to\n AWS account\n\n2)\n\n3)\n\n\n-----\n\n###### Tactic: Defense evasion\n\n#### Premise Technique: Impair defenses\n\n###### 1) Threat actor gains access to\n AWS account\n\n 2) Modifies CloudTrail using\n```\n  PutEventSelectors\n\n```\n3)\n\n\n-----\n\n###### Tactic: Defense evasion\n\n#### Premise Technique: Impair defenses\n\n###### 1) Threat actor gains access to\n AWS account\n\n 2) Modifies CloudTrail using\n```\n  PutEventSelectors\n\n 3) Prevents logging of\n mutating events\n\n```\n\n-----\n\n###### Tactic: Defense evasion\n\n#### Alternative Technique: Impair defenses\n\n###### 1) Threat actor gains access to\n AWS account\n\n 2) Modifies CloudTrail using\n```\n  PutEventSelectors\n\n```\n3)\n\n\n-----\n\n###### Tactic: Defense evasion\n\n#### Alternative Technique: Impair defenses\n\n###### 1) Threat actor gains access to\n AWS account\n\n 2) Modifies CloudTrail using\n```\n  PutEventSelectors\n\n 3) Prevents logging of\n management events\n\n```\n\n-----\n\n###### Tactic: Defense evasion\n\n#### Alternative Technique: Impair defenses\n\n###### 1) Threat actor gains access to\n AWS account\n\n 2) Modifies CloudTrail using\n```\n  PutEventSelectors\n\n 3) Prevents logging of\n management events\n\n```\n\n-----\n\n###### Tactic: Defense evasion\n\n#### Mitigations Technique: Impair defenses\n\n###### • Use SCPs to restrict CloudTrail modification including\n use of PutEventSelectors API\n\n • Consider AWS Config remediation rules for CloudTrail\n\n\n-----\n\n###### Tactic: Impact Technique: Resource hijacking\n 1) Threat actor obtains access to AWS account\n\n2)\n\n3)\n\n                                                                                                                           -\n\n                                                                                                                           -\n\n4)\n\n\n-----\n\n###### Tactic: Impact Technique: Resource hijacking\n 1) Threat actor obtains access to AWS account\n\n 2) Threat actor enables access to LLMs\n through Amazon Bedrock\n\n3)\n\n                                                                                                                           -\n\n                                                                                                                           -\n\n4)\n\n\n-----\n\n###### Tactic: Impact Technique: Resource hijacking\n 1) Threat actor obtains access to AWS account\n\n 2) Threat actor enables access to LLMs\n through Amazon Bedrock\n\n3)\n\n                                                                                                                           -\n\n                                                                                                                           -\n\n4)\n\n\n-----\n\n###### Tactic: Impact Technique: Resource hijacking\n 1) Threat actor obtains access to AWS account\n\n 2) Threat actor enables access to LLMs\n through Amazon Bedrock\n\n 3) Models used and prompts sent:\n\n • InvokeModel\n • InvokeModelWithResponseStream\n\n4)\n\n\n-----\n\n###### Tactic: Impact Technique: Resource hijacking\n 1) Threat actor obtains access to AWS account\n\n 2) Threat actor enables access to LLMs\n through Amazon Bedrock\n\n 3) Models used and prompts sent:\n\n • InvokeModel\n • InvokeModelWithResponseStream\n\n 4) Can be performed in unused\n AWS Regions\n\n\n-----\n\n###### Tactic: Impact\n\n#### Mitigations Technique: Resource hijacking\n\n###### Use SCPs to limit access to Amazon Bedrock using\n\n • Specific principals\n • Specific Regions\n\n\n-----\n\n### Security best practices\n\n\n-----\n\n###### A failure cannot be traced back to a\n single root cause; accidents are often the result of a\n combination of factors\n\n\n-----\n\n###### Inaccurate AWS account Unintended disclosure of contact information credentials and secrets\n\n Ineffective response to Lack of continuous detective controls vulnerability management\n\n Insecure AWS resource configuration\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "99fdc3ef-333d-48f5-a4a1-becd788c7b80",
            "created_at": "2022-10-25T15:28:29.802983Z",
            "updated_at": "2022-10-25T15:28:29.802983Z",
            "deleted_at": null,
            "name": "MITRE",
            "url": "https://github.com/mitre-attack/attack-stix-data",
            "description": "MITRE ATT&CK STIX Data",
            "reports": null
        }
    ],
    "references": [
        "https://reinforce.awsevents.com/content/dam/reinforce/2024/slides/TDR432_New-tactics-and-techniques-for-proactive-threat-detection.pdf"
    ],
    "report_names": [
        "TDR432_New-tactics-and-techniques-for-proactive-threat-detection.pdf"
    ],
    "threat_actors": [
        {
            "id": "d90307b6-14a9-4d0b-9156-89e453d6eb13",
            "created_at": "2022-10-25T16:07:23.773944Z",
            "updated_at": "2025-03-27T02:02:09.974695Z",
            "deleted_at": null,
            "main_name": "Lead",
            "aliases": [
                "Casper",
                "TG-3279"
            ],
            "source_name": "ETDA:Lead",
            "tools": [
                "Agentemis",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "RbDoor",
                "RibDoor",
                "Winnti",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1730426755,
    "ts_updated_at": 1743041320,
    "ts_creation_date": 1718671895,
    "ts_modification_date": 1718672128,
    "files": {
        "pdf": "https://archive.orkl.eu/9b56b518564c50e9bdca93c13e988670589e33c7.pdf",
        "text": "https://archive.orkl.eu/9b56b518564c50e9bdca93c13e988670589e33c7.txt",
        "img": "https://archive.orkl.eu/9b56b518564c50e9bdca93c13e988670589e33c7.jpg"
    }
}