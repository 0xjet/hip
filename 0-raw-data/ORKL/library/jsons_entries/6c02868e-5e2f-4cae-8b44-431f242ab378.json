{
    "id": "6c02868e-5e2f-4cae-8b44-431f242ab378",
    "created_at": "2023-01-12T15:06:14.668807Z",
    "updated_at": "2025-03-27T02:15:35.442907Z",
    "deleted_at": null,
    "sha1_hash": "d16ecb9c92b9330dd71c04e9873a3e5dc0ebb9f7",
    "title": "2017-02-22 - Bella- A pure python, post-exploitation, data mining tool and remote administration tool for macOS.",
    "authors": "",
    "file_creation_date": "2022-05-28T03:41:11Z",
    "file_modification_date": "2022-05-28T03:41:11Z",
    "file_size": 301712,
    "plain_text": "# kai5263499/Bella: A pure python, post-exploitation, data mining tool and remote administration tool for macOS. ðŸŽðŸ’»\n\n**github.com/kai5263499/Bella**\n\nkai5263499\n\nmaster\n\nThis branch is 27 commits ahead of Trietptm-on-Security/Bella:master.\n\nContribute\n\n## README.md\n\n#Bella Bella is a pure python post-exploitation data mining tool & remote\nadministration tool for macOS. ðŸŽðŸ’»\n\n##What is it? Bella is a robust, `pure python, post-exploitation and`\nremote administration tool for macOS.\n```\n     Bella a.k.a. the server is an SSL/TLS encrypted reverse shell that\n\n```\ncan be dropped on any system running macOS >= 10.6. `Bella offers the`\nfollowing features:\n\n\n-----\n\n1. `Pseudo-TTY that emulates an SSH instance [CTRL-C support`\n\nfor most functions, streaming output, full support for inline bash\nscripting, tab completion, command history, blocking command\nhandling, etc].\n\n2. `Auto installer! Just execute the binary, and Bella takes care of`\n\nthe rest - a persistent reverse shell in a hidden location on the hard\ndrive, undetectable by anti-viruses.\n\n3. `Upload / Download any file[s]`\n\n4. `Reverse VNC Connection.`\n\n5. `Stream and save the computer's microphone input.`\n\n6. `Login / keychain password phishing through system`\n\n```\nprompt.\n\n```\n\n7. `Apple ID password phishing through iTunes prompt.`\n\n8. `iCloud Token Extraction.`\n\n9. `Accessing all iCloud services of the user through`\n\n```\nextracted tokens or passwords.\n\n```\n```\n  This includes: iCloud Contacts, Find my iPhone, Find my\n  Friends, iOS Backups.\n\n```\n10. `Google Chrome Password Extraction.`\n\n11. `Chrome and Safari History Extraction.`\n\n12. `Auto Keychain decryption upon discovery of kc password.`\n\n13. `macOS Chat History.`\n\n14. `iTunes iOS Backup enumeration.`\n\n15. `Extensive logging of all Bella activity and downloaded`\n\n```\nfiles.\n\n```\n\n16. `VERY comprehensive data storage. All information that Bella`\n\ndiscovers [tokens, passwords, etc] is stored in an encrypted SQL\ndatabase on the computer running Bella. This information is used for\nfaster function execution, and a \"smarter\" reverse shell.\n\n17. `Complete remote removal of Bella`\n\n\n-----\n\n18. `An interactive shell for commands such as nano, ftp,`\n\n```\ntelnet, etc.\n\n```\n\n19. `A lot of other great features! Mess around with it to see it`\n\nin action.\n\nThese are some of the features available when we are in the userland.\nThis shell is accessible at any time when the user has an internet\nconnection, which occurs when they are logged in and the computer is not\nasleep.\n\nIf we get `root, Bella's capabilities greatly expand.`\n\nSimilar to the `getsystem function on a meterpreter shell, Bella has a`\n```\nget_root function that will attempt to gain root access through a variety\n\n```\nof means, including through a phished user password and/or local privilege\nescalation exploits if the system is vulnerable.\n\nUpon gaining root access, Bella will migrate over to a hidden directory in\n/Library, and will load itself as a LaunchDaemon. This now provides remote\naccess to the Bella instance at all times, as long as the computer has a\nnetwork connection. Once we get root, we can do the following:\n\n1. `MULTI-USER SUPPORT! Bella will keep track of all information from`\n\nany active users on the computer in a comprehensive database, and\nwill automatically switch to the active computer user. All of the\naforementioned data extraction techniques are now available for\nevery user on the machine.\n\n2. `Decrypt ALL TLS/SSL traffic and redirect it through the`\n```\n   control center! [a nice, active, MITM attack]\n\n```\n3. `Disable/Enable the Keyboard and/or Mouse.`\n\n4. `Load an Insomnia KEXT to keep a connection open if the`\n\n```\nuser closes their laptop.\n\n```\n\n5. `Automatic dumping of iCloud Tokens and Chrome passwords`\n\n[leverages keychaindump and chainbreaker if SIP is disabled]\n\n6. `A lot of behind the scenes automation.`\n\n##HOW TO USE\n\n\n-----\n\n**Bella s** `power lies in its high level of automation of most of the`\npainstaking tasks that one faces in a post-exploitation scenario. It is\nincredibly easy to setup and use, requires no pre-configuration on the\ntarget, and very little configuration on the Control Center. It leverages the\n_incredible behind the scenes power of macOS and Python for a fluid post-_\nexploitation experience.\n\n1. Download / clone this repository onto a macOS or Linux system.\n\n2. Run ./BUILDER and enter the appropriate information. It should look\n\nsomething like this:\n\n3. That's it! Bella is all ready to go. Just upload and execute `Bella on`\n\nyour macOS target.\n\n4. Now run `Control Center.py on your macOS or Linux control`\n\ncenter. It requires no-dependencies [except for mitmproxy if you want\nto MITM]. It will do some auto-configuration, and you will see\nsomething like this after a few seconds. ![](Screenshots/Found\nClients.png) The Control Center will constantly update this selection,\nfor up to 128 separate computers.\n\n5. Press `Ctrl-C to choose from the selection, and then type in the`\n\nnumber of the computer that you want. You will then be presented\nwith a screen like this. ![](Screenshots/Command entry.png)\n\n6. Start running commands! `bella_info is a great one. Run`\n```\n   manual to get a full manual of all of the commands. Also, you can\n\n```\nhit tab twice to see a list of available commands. ![]\n(Screenshots/Bella Info.png)\n\n**VERY IMPORTANT DISCLAIMER: USE BELLA RESPONSIBLY. BY**\n**USING BELLA YOU AGREE TO THE MIT LICENSE CONTAINED IN**\n**THIS REPOSITORY. READ THE LICENSE BEFORE USING BELLA.**\n\n**Little note: Bella works across the internet, if you do some configuration.**\nConfigure your firewall to forward Bella's port to your Control Center. Other\nimportant ports to forward: 1) VNC - 5500. 2) Microphone - 2897. 3) MITM\n\n\n-----\n\n- 8081. 4.) Interactive Shell - 3818\n\nAlso, VNC relies on the RealVNC application for macOS, as it is one of the\nfew clients that supports a reverse VNC connection. It is free to download\nand use.\n\nVNC and Microphone streaming are not yet supported for Linux control\ncenters.\n\n##Other Information This project is being actively maintained. Please\nsubmit any and all bug reports, questions, feature requests, or related\ninformation.\n\nBella leverages keychaindump, VNC, microphone streaming, etc, by\nsending base64 encoded C binaries over to the Bella server / target. I\nhave included pre-compiled and encoded files in the Payloads/payloads.txt\nfile. If you wish to compile your own version of these payloads, here is\nwhat to do after you compile them:\n\n1. Encode them in base64 and put them in the payloads.txt in the\n\nfollowing order, each one separated by a new line.\n2. vnc, keychaindump, microphone, rootshell, insomnia, lock_icon,\n\nchainbreaker.\n\npayload_generator in the Payloads directory should help with this.\n\nPlease let me know if you have any issues.\n\n###HUGE thanks `https://github.com/juuso/keychaindump`\n\n```\nhttps://github.com/n0fate/chainbreaker\n\n```\n```\nhttps://github.com/richardkiss/speakerpipe-osx\n\n```\n```\nhttps://github.com/semaja2/InsomniaX\n\n```\n```\nhttps://github.com/stweil/OSXvnc\n\n```\n```\nhttps://bugs.chromium.org/p/project-zero/issues/detail?\nid=676&redir=1\n\n```\n###TODO\n\n1. `Reverse SOCKS proxy to tunnel our traffic through the`\n\n```\nserver.\n\n```\n\n2. `Firefox password decryption / extraction`\n\n\n-----\n\n3. `Keystroke logging with legible output [80% done]`\n\n4. `VNC and Microphone functionality for a Linux Control`\n\n```\nCenter\n\n```\n\n####Some design points\n\n1. As previously stated, Bella is a pseudo-TTY. By this, the base socket\n\nand remote code execution handling of Bella is a fairly abstracted\nversion of a very simple request-response socket. Bella receives a\ncommand from the server. If the command matches a preprogrammed function (i.e chrome history dump), then it will perform\nthat function, and send the response back to the client. The client will\nthen handle the response in the same way. After processing the\nresponse, it will prompt the client for another command to send.\n\n2. Issues with a low-level socket are numerous, and not limited to: 3.\n\nProgram execution that blocks and hangs the pipe, waiting for output\nthat never comes (sudo, nano, ftp) 4. Not knowing how much data to\nexpect in the socket.recv() call. 5. Not being able to send ctrl-C, ctrl-Z\nand similar commands. 6. No command history 7. A program that\ncrashes can kill a shell. 8. One-to-one response and request.\n\n3. Bella address the above by: 4. recv() and send() functions that\n\nserialize the length of the message, and loop through\nresponse/requests accordingly. 5. Readline integration to give a more\n'tty' like feel, including ctrl-C support, command history, and tab\ncompletion. 6. Detecting programs that block, and killing them. 7.\nAllowing multiple messages to be sent at once without the client\nprompting for more input (great for commands like ping, tree, and\nother commands with live updates).\n\nFor full information on the pre-programmed functions, run the `manual`\ncommand when connected to the server.\n\n-\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2017/2017-02-22 - Bella- A pure python, post-exploitation, data mining tool and remote administration tool for macOS..pdf"
    ],
    "report_names": [
        "2017-02-22 - Bella- A pure python, post-exploitation, data mining tool and remote administration tool for macOS..pdf"
    ],
    "threat_actors": [
        {
            "id": "9f101d9c-05ea-48b9-b6f1-168cd6d06d12",
            "created_at": "2023-01-06T13:46:39.396409Z",
            "updated_at": "2025-03-27T02:00:03.074969Z",
            "deleted_at": null,
            "main_name": "Earth Lusca",
            "aliases": [
                "CHROMIUM",
                "ControlX",
                "Red Dev 10",
                "RedHotel",
                "Red Scylla",
                "TAG-22",
                "BRONZE UNIVERSITY",
                "AQUATIC PANDA",
                "Charcoal Typhoon",
                "BountyGlad"
            ],
            "source_name": "MISPGALAXY:Earth Lusca",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "6abcc917-035c-4e9b-a53f-eaee636749c3",
            "created_at": "2022-10-25T16:07:23.565337Z",
            "updated_at": "2025-03-27T02:02:09.868522Z",
            "deleted_at": null,
            "main_name": "Earth Lusca",
            "aliases": [
                "Bronze University",
                "Charcoal Typhoon",
                "Chromium",
                "Red Dev 10",
                "Red Scylla"
            ],
            "source_name": "ETDA:Earth Lusca",
            "tools": [
                "Agentemis",
                "AntSword",
                "BIOPASS",
                "BIOPASS RAT",
                "BadPotato",
                "Behinder",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "Doraemon",
                "FRP",
                "Fast Reverse Proxy",
                "FunnySwitch",
                "HUC Port Banner Scanner",
                "KTLVdoor",
                "Mimikatz",
                "NBTscan",
                "POISONPLUG.SHADOW",
                "PipeMon",
                "RbDoor",
                "RibDoor",
                "RouterGod",
                "SAMRID",
                "ShadowPad Winnti",
                "SprySOCKS",
                "WinRAR",
                "Winnti",
                "XShellGhost",
                "cobeacon",
                "fscan",
                "lcx",
                "nbtscan"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "d53593c3-2819-4af3-bf16-0c39edc64920",
            "created_at": "2022-10-27T08:27:13.212301Z",
            "updated_at": "2025-03-27T02:00:55.529662Z",
            "deleted_at": null,
            "main_name": "Earth Lusca",
            "aliases": [
                "Earth Lusca",
                "TAG-22",
                "Charcoal Typhoon",
                "CHROMIUM",
                "ControlX"
            ],
            "source_name": "MITRE:Earth Lusca",
            "tools": [
                "Mimikatz",
                "PowerSploit",
                "Tasklist",
                "certutil",
                "Cobalt Strike",
                "Winnti for Linux",
                "Nltest",
                "NBTscan",
                "ShadowPad"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1673535974,
    "ts_updated_at": 1743041735,
    "ts_creation_date": 1653709271,
    "ts_modification_date": 1653709271,
    "files": {
        "pdf": "https://archive.orkl.eu/d16ecb9c92b9330dd71c04e9873a3e5dc0ebb9f7.pdf",
        "text": "https://archive.orkl.eu/d16ecb9c92b9330dd71c04e9873a3e5dc0ebb9f7.txt",
        "img": "https://archive.orkl.eu/d16ecb9c92b9330dd71c04e9873a3e5dc0ebb9f7.jpg"
    }
}