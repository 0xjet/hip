{
    "id": "6a8c47d0-fbaf-4ec8-9939-d9674ab0478c",
    "created_at": "2023-01-12T15:10:28.296506Z",
    "updated_at": "2025-03-27T02:08:41.209317Z",
    "deleted_at": null,
    "sha1_hash": "7e5373980c7497b977762e6d91f996c1dfa32f9b",
    "title": "2020-07-18 - Firefox Send sends Ursnif malware",
    "authors": "",
    "file_creation_date": "2022-05-28T04:51:51Z",
    "file_modification_date": "2022-05-28T04:51:51Z",
    "file_size": 262529,
    "plain_text": "# Firefox Send sends Ursnif malware\n\n**[hornetsecurity.com/en/security-information/firefox-send-sends-ursnif-malware/](https://www.hornetsecurity.com/en/security-information/firefox-send-sends-ursnif-malware/)**\n\nSecurity Lab July 18, 2020\n\n## Summary\n\nOn 2020-07-07 Mozilla temporarily disabled their Firefox Send service due to abuse by\nmalware. Hornetsecurity’s Security Lab explains how malware was abusing the Firefox Send\nservice. To this end, a malspam campaign distributing a variant of the Ursnif malware is\nanalyzed. The campaign used the Firefox Send service to host its malicious downloader and\nsend victims these malicious Firefox Send links. Such abuse prompted Mozilla to disabled\nthe Firefox Send service, because the service is currently lacking a feature to report abuse.\nMeaning even if researchers found these malicious links they could not be reported to\nMozilla for takedown. However, our analysis further reveals that malware already abuses\nother services, hence, disabling Firefox Send – even though it was the right decision – has\nno impact on malware campaigns.\n\n## Background\n\nOn 2020-07-07 Mozilla temporarily disabled their Firefox Send service due to abuse by\nmalware. This was mainly done because the service does not offer a method to report\nabuse. Mozilla will likely enable the service again once they finish “work on product\nimprovements” as stated on the message currently displayed when trying to reach the\nFirefox Send service’s webpage:\n\n\n-----\n\nTo explain why Mozilla temporarily disabled their Firefox Send service, Hornetsecurity’s\nSecurity Lab will analyze one malspam campaign distributing an Ursnif malware variant.\n\n## Analysis\n\nThe campaign uses a mixture of link and attachment malspam distributing a VBScript file that\ndownloads the Ursnif malware. The campaign leverages email conversation thread hijacking,\ni.e., the actors behind the attack will send their malware as a reply to their victims’ existing\nemail conversations. One example email using the Firefox Send service to host the malicious\npayload looks as follows:\n\n\n-----\n\nThe redacted parts contain a stolen email conversation thread that the campaign is replying\nto with its malicious link and a short message. The messages typically will state that a\ndocument has been updated and can be downloaded from the Firefox Send link. How good\nthe malicious message fits into the hijacked email conversation thread seems to depend on\nchance, i.e., the message will refer to updated documents regardless what the conversation\nthread was really about.\n\nThe Firefox Send link will lead to a VBScript file. The VBScript file downloads an Ursnif\nvariant most likely developed from another Ursnif variant called ISFB for which the source\ncode is available publicly.\n\nThen on 2020-07-07 Mozilla decided to temporarily disable Firefox Send, because the\nservice does not feature a mechanism to report abuse. That means the download links can\nnot be reported to Mozilla by security researchers. An abuse report feature is important to\nhave for an online service, especially since the privacy focused nature of Firefox Send\nprovides many opportunities for abuse. For example, the links can be password protected.\nThe number of downloads, as well as, how long the download will be available, can be\nrestricted:\n\n\n-----\n\nThis means an attacker can limit the amount of downloads to one for his victims. In case of a\nsuccessful compromise an incident response team can not download the original malware\npayload anymore to reconstruct the infection. If the malware deletes its files after infection it\nwill be hard to trace such an attack.\n\nAnother problem arises for legitimate use of the service and security software scanning such\none-time download links. If security software downloads the file in order to scan it, the real\nrecipient can not download the file anymore as the security software has already used the\none available download.\n\nFor these reasons the Firefox Send service will highly likely continue to be abused once it\nreturns. The abuse report feature will mainly be useful to report links that allow for multiple\ndownloads and are used over a longer period of time. Reporting one-time download links\ncould aid Mozilla in curbing abuse by detecting patterns in the way the actors behind the\nabuse interact with their service and then blocking them.\n\nBut even if the Firefox Send service should implement better protections against abuse the\ndiscussed malspam campaign does not depend on the Firefox Send service at all. The\ncampaign used the Firefox Send service starting from 2020-06-01 (transitioning from using\nGoogle Drive links) to the day it was disabled:\n\n\n-----\n\nHowever, the campaign has used Google Drive and Dropbox links before using Firefox Send\nlinks. It also used encrypted ZIP attachments instead of download links and as soon as the\nFirefox Send service was disabled it switched to such an encrypted ZIP attachment scheme:\n\n\n-----\n\nBoth Google Drive and Dropbox allow abuse reports, however, they are still abused by\nmalware. This means when Firefox Send returns it will also get abused again.\n\n## Conclusion and Countermeasure\n\nWhile we applaud Mozilla for temporarily disabling the Firefox Send service until an abuse\nreport feature is implemented, the analysis of the discussed malspam campaign indicates\nthat the Firefox Send service is only on of many services abused for malware distribution and\nadding the abuse report feature will not stop such abuse.\n\nTo protect against such attacks, especially the outlined email conversation thread hijacking,\nusers should be cautious when they receive an out-of-order reply from a conversation\npartner, that tries to entice them to open links or other documents, either attached directly to\nthe email or via a file hosting service, especially when such documents do not fit into the\nconversation and/or are delivered via an unusual mechanism, e.g., if documents are usually\nshared via a company internal file sharing solution, users should be especially cautious\nopening files shared via external services.\n\nHornetsecurity’s [Spam Filtering and Malware Protection, with the highest detection rates on](https://www.hornetsecurity.com/en/services/spam-filter/)\nthe market, already detects and blocks all variations of the outlined emails currently\ndistributing the Ursnif malware variant. Here it is also important that users do not let\nthemselves be fooled by the outlined email conversation thread hijacking. Hornetsecurity’s\n[Advanced Threat Protection extends this protection by also detecting yet unknown threats.](https://www.hornetsecurity.com/en/services/advanced-threat-protection/)\nWhen using Hornetsecurity’s [encryption service a third-party service such as Firefox Send to](https://www.hornetsecurity.com/en/services/email-encryption/)\n\n\n-----\n\nencrypt sent documents is not necessary. Outgoing emails are automatically encrypted with\none of the common encryption technologies (PGP, S/MIME or TLS), depending on the set\npolicy and availability of the corresponding certificates, without any further user intervention.\n\n## References\n\n[1] [https://send.firefox.com/](https://send.firefox.com/)\n\n[2] https://www.zdnet.com/article/mozilla-suspends-firefox-send-service-while-itaddresses-malware-abuse/\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2020/2020-07-18 - Firefox Send sends Ursnif malware.pdf"
    ],
    "report_names": [
        "2020-07-18 - Firefox Send sends Ursnif malware.pdf"
    ],
    "threat_actors": [
        {
            "id": "d90307b6-14a9-4d0b-9156-89e453d6eb13",
            "created_at": "2022-10-25T16:07:23.773944Z",
            "updated_at": "2025-03-27T02:02:09.974695Z",
            "deleted_at": null,
            "main_name": "Lead",
            "aliases": [
                "Casper",
                "TG-3279"
            ],
            "source_name": "ETDA:Lead",
            "tools": [
                "Agentemis",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "RbDoor",
                "RibDoor",
                "Winnti",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673536228,
    "ts_updated_at": 1743041321,
    "ts_creation_date": 1653713511,
    "ts_modification_date": 1653713511,
    "files": {
        "pdf": "https://archive.orkl.eu/7e5373980c7497b977762e6d91f996c1dfa32f9b.pdf",
        "text": "https://archive.orkl.eu/7e5373980c7497b977762e6d91f996c1dfa32f9b.txt",
        "img": "https://archive.orkl.eu/7e5373980c7497b977762e6d91f996c1dfa32f9b.jpg"
    }
}