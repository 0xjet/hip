{
    "id": "fe572e6d-7f37-422c-9ec3-970121a58e5e",
    "created_at": "2023-01-12T14:58:51.33878Z",
    "updated_at": "2025-03-27T02:11:39.903532Z",
    "deleted_at": null,
    "sha1_hash": "f2c9e4edbd57c5303a00a5cdb62dc5baa9d551ce",
    "title": "2016-06-21 - The Curious Case of an Unknown Trojan Targeting German-Speaking Users",
    "authors": "",
    "file_creation_date": "0001-01-01T00:00:00Z",
    "file_modification_date": "0001-01-01T00:00:00Z",
    "file_size": 1031288,
    "plain_text": "NETRESEC > Blog\n\nMonday, 27 October 2014 11:11:00 (UTC/GMT)\n\n# Full Disclosure of Havex Trojans\n\nI did a talk on \"SCADA Network Forensics\" at the 4SICS conference last week, where I\ndisclosed the results from my analysis of the Havex RAT/backdoor.\n\nThe Havex backdoor is developed and used by a hacker group called Dragonfly, who\nare also known as \"Energetic Bear\" and \"Crouching Yeti\". Dragonfly is an APT hacker\ngroup, who have been reported to specifically target organizations in the energy\nsector as well as companies in other ICS sectors such as industrial/machinery,\nmanufacturing and pharmaceutical.\n\nIn my 4SICS talk I disclosed a previously unpublished comprehensive view of ICS\nsoftware that has been trojanized with the Havex backdoor, complete with\nscreenshots, version numbers and checksums.\n\nDale Petersen, founder of Digital Bond, expressed the following request regarding the\nlack of public information about the software trojanized with Havex:\n\n\n## Recent Blog Posts\n\n» Observing the Havex RAT\n\n» Full Disclosure of Havex\nTrojans\n\n» Chinese MITM Attack on iCloud\n\n» Verifying Chinese MITM of\nYahoo\n\n» Analysis of Chinese MITM on\nGoogle\n\n» Running NetworkMiner on Mac\nOS X\n\n» NetworkMiner 1.6 Released\n\n» PCAP or it didn't happen\n\n## Blog Archive\n\n» 2014 November\n» 2014 October\n» 2014 September\n» 2014 June\n» 2014 May\n» 2014 April\n» 2014 March\n» 2014 February\n» 2013 October\n» 2013 September\n» 2013 August\n» 2013 April\n» 2013 February\n» 2013 January\n» 2012 December\n» 2012 November\n» 2012 September\n» 2012 August\n» 2012 July\n» 2012 June\n» 2012 April\n» 2012 January\n» 2011 December\n» 2011 November\n» 2011 October\n» 2011 September\n» 2011 August\n» 2011 July\n» 2011 June\n» 2011 May\n» 2011 April\n» 2011 March\n» 2011 February\n» 2011 January\n\nList all blog posts\n\nGrab our FeedBurner or RSS feed\n\n\nIf the names of the vendors that unwittingly spread Havex were made public,\nthe wide coverage would likely reach most of the affected asset owners.\n\n\nFollowing Dale's request we decided to publish the information presented at 4SICS\nalso in this blog post, in order to reach as many affected asset owners as possible.\nThe information published here is based on our own sandbox executions of Havex\nmalware samples, which we have obtained via CodeAndSec and malwr.com. In\naddition to what I presented at 4SICS, this blog post also includes new findings\npublished by Joel \"scadahacker\" Langill in version 2.0 of his Dragonfly white paper,\nwhich was released just a couple of hours after my talk.\n\nIn Symantec's blog post about Havex they write:\n\n\nThree different ICS equipment providers were targeted and malware was\ninserted into the software bundles\n\n\n**Trojanized MESA Imaging driver**\n\nThe first vendor known to have their software trojanized by the Dragonfly group was\nthe Swiss company MESA Imaging, who manufacture industrial grade cameras for\nrange measurements.\n\n\n-----\n\n_Image: Screenshot of trojanized MESA Imaging driver installer from our sandbox_\n_execution_\n\n**Company:** MESA Imaging\n\n**Product:** Swiss Ranger version 1.0.14.706 (libMesaSR)\n\n**Filename:** SwissrangerSetup1.0.14.706.exe\n\n**Exposure:** Six weeks in June and July 2013 (source: Symantec)\n\n**Backdoor:** Sysmain RAT\n\n**MD5:** e027d4395d9ac9cc980d6a91122d2d83\n\n**SHA256:** 398a69b8be2ea2b4a6ed23a55459e0469f657e6c7703871f63da63fb04cefe90\n\n**eWON / Talk2M**\n\nThe second vendor to have their software trojanized was the Belgian company eWON,\nwho provide a remote maintenance service for industrial control systems called\n“Talk2M”.\n\neWon published an incident report in January 2014 and then a follow-up report in July\n2014 saying:\n\n\n## NETRESEC on Twitter\n\nFollow @netresec on twitter:\n» twitter.com/netresec\n\n## Recommended Books\n\n» The Practice of Network\nSecurity Monitoring, Richard\nBejtlich (2013)\n\n» Applied Network Security\nMonitoring, Chris Sanders and\nJason Smith (2013)\n\n» Network Forensics, Sherri\nDavidoff and Jonathan Ham\n(2012)\n\n» The Tao of Network Security\nMonitoring, Richard Bejtlich\n(2004)\n\n» Practical Packet Analysis, Chris\nSanders (2011)\n\n» Windows Forensic Analysis,\nHarlan Carvey (2009)\n\n» TCP/IP Illustrated, Volume 1,\nKevin Fall and Richard Stevens\n(2011)\n\n» Industrial Network Security, Eric\nD. Knapp and Joel Langill (2014)\n\n\nBack in January 2014, the eWON commercial web site www.ewon.biz had been\ncompromised. A corrupted eCatcherSetup.exe file had been uploaded into the\nCMS (Content Management System) of www.ewon.biz web site. eCatcher\ndownload hyperlinks were rerouted to this corrupted file. The corrupted\neCatcherSetup.exe contained a malware which could, under restricted\nconditions, compromise the Talk2M login of the infected user.\n\n\n-----\n\n_Image: Screenshot of trojanized Talk2M eCatcher installer from our sandbox execution_\n\n**Company:** eWON\n\n**Product:** Talk2M eCatcher version 4.0.0.13073\n\n**Filename:** eCatcherSetup.exe\n\n**Exposure:** Ten days in January 2014, 250 copies downloaded (source: Symantec)\n\n**Backdoor:** Havex 038\n\n**MD5:** eb0dacdc8b346f44c8c370408bad4306\n\n**SHA256:** 70103c1078d6eb28b665a89ad0b3d11c1cbca61a05a18f87f6a16c79b501dfa9\n\nPrior to version 2.0 of Joel's Dragonfly report, eCatcher was the only product from\neWON known to be infected with the Havex backdoor. However, Joel's report also\nlisted a product called “eGrabit”, which we managed to obtain a malware sample for\nvia malwr.com.\n\n\n-----\n\n_Image: Screenshot of trojanized eGrabIt installer from our sandbox execution_\n\n**Company:** eWON\n\n**Product:** eGrabIt 3.0.0.82 (version 3.0 Build 82)\n\n**Filename:** egrabitsetup.exe\n\n**Exposure:** unknown\n\n**Backdoor:** Havex RAT 038\n\n**MD5:** 1080e27b83c37dfeaa0daaa619bdf478\n\n**SHA256:** 0007ccdddb12491e14c64317f314c15e0628c666b619b10aed199eefcfe09705\n\n**MB Connect Line**\n\nThe most recent company known to have their software infected with the Havex\nbackdoor was the German company MB Connect Line GmbH, who are known for their\nindustrial router mbNET and VPN service mbCONNECT24.\n\nMB Connect Line published a report about the Dragonfly intrusion in September 2014,\nwhere they write:\n\n\nOn 16th of April 2014 our website www.mbconnectline.com has been attacked\nby hackers. The files mbCHECK (Europe), VCOM_LAN2 and mbCONFTOOL have\nbeen replaced with infected files. These files were available from 16th of April\n2014 to 23th of April 2014 for download from our website. All of these files\nwere infected with the known Trojan Virus Havex Rat.\n\n\n-----\n\n_Image: Screenshot of trojanized mbCONFTOOL installer from our sandbox execution_\n\n**Company:** MB Connect Line GmbH\n\n**Product:** mbCONFTOOL V 1.0.1\n\n**Filename:** setup_1.0.1.exe\n\n**Exposure:** April 16 to April 23, 2014 (source: MB Connect Line)\n\n**Backdoor:** Havex RAT 043\n\n**MD5:** 0a9ae7fdcd9a9fe0d8c5c106e8940701\n\n**SHA256:** c32277fba70c82b237a86e9b542eb11b2b49e4995817b7c2da3ef67f6a971d4a\n\n\n-----\n\n**Company:** MB Connect Line GmbH\n\n**Product:** mbCHECK (EUROPE) V 1.1.1\n\n**Filename:** mbCHECK.exe\n\n**Exposure:** April 16 to April 23, 2014 (source: MB Connect Line)\n\n**Backdoor:** Havex RAT 043\n\n**MD5:** 1d6b11f85debdda27e873662e721289e\n\n**SHA256:** 0b74282d9c03affb25bbecf28d5155c582e246f0ce21be27b75504f1779707f5\n\nNotice how only mbCHECK for users in Europe was trojanized, there has been no\nreport of the USA/CAN version of mbCHECK being infected with Havex.\n\nWe have not been able to get hold of a malware sample for the trojanized version of\nVCOM_LAN2. The screenshot below is therefore from a clean version of this software.\n\n_Image: Screenshot VCOM_LAN2 installer_\n\n**Company:** MB Connect Line GmbH\n\n**Product:** VCOM_LAN2\n\n**Filename:** setupvcom_lan2.exe\n\n**Exposure:** April 16 to April 23, 2014 (source: MB Connect Line)\n\n**Backdoor:** unknown\n\n**MD5:** unknown\n\n**SHA256:** unknown\n\n**Conclusions on Havex Trojans**\n\nThe vendors who have gotten their software trojanized by Dragonfly are all European\nICS companies (Switzerland, Belgium and Germany). Additionally, only the mbCHECK\nversion for users in Europe was infected with Havex, but not the one for US / Canada.\n\n\n-----\n\n**Next: Detecting Havex with NSM**\n\nRead our follow-up blog post Observing the Havex RAT, which shows how to detect\nand analyze network traffic from ICS networks infected with Havex.\n\n\nShare |\n\n\nShort URL: http://netresec.com/?b=14ABDA4\n\n\nPosted by Erik Hjelmvik on Monday, 27 October 2014 11:11:00 (UTC/GMT)\n\n© 2010-2013 NETRESEC AB | [Contact Us](http://www.netresec.com/?page=AboutNetresec) | [Privacy](http://www.netresec.com/?page=Privacy) | [RSS](http://www.netresec.com/rss.ashx)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/ICS SCADA/Havex/Full Disclosure of Havex Trojans.pdf"
    ],
    "report_names": [
        "Full Disclosure of Havex Trojans.pdf"
    ],
    "threat_actors": [
        {
            "id": "5cbf6c32-482d-4cd2-9d11-0d9311acdc28",
            "created_at": "2023-01-06T13:46:38.39927Z",
            "updated_at": "2025-03-27T02:00:02.823829Z",
            "deleted_at": null,
            "main_name": "ENERGETIC BEAR",
            "aliases": [
                "DYMALLOY",
                "TG-4192",
                "Crouching Yeti",
                "Group 24",
                "Havex",
                "IRON LIBERTY",
                "Blue Kraken",
                "ALLANITE",
                "Koala Team",
                "G0035",
                "ATK6",
                "ITG15",
                "Ghost Blizzard",
                "BERSERK BEAR"
            ],
            "source_name": "MISPGALAXY:ENERGETIC BEAR",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "649b5b3e-b16e-44db-91bc-ae80b825050e",
            "created_at": "2022-10-25T15:50:23.290412Z",
            "updated_at": "2025-03-27T02:00:55.431037Z",
            "deleted_at": null,
            "main_name": "Dragonfly",
            "aliases": [
                "TEMP.Isotope",
                "DYMALLOY",
                "Berserk Bear",
                "TG-4192",
                "Crouching Yeti",
                "IRON LIBERTY",
                "Energetic Bear",
                "Ghost Blizzard"
            ],
            "source_name": "MITRE:Dragonfly",
            "tools": [
                "MCMD",
                "Impacket",
                "CrackMapExec",
                "Backdoor.Oldrea",
                "Mimikatz",
                "PsExec",
                "Trojan.Karagany",
                "netsh"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "1a76ed30-4daf-4817-98ae-87c667364464",
            "created_at": "2022-10-25T16:47:55.891029Z",
            "updated_at": "2025-03-27T02:05:17.408867Z",
            "deleted_at": null,
            "main_name": "IRON LIBERTY",
            "aliases": [
                "ATK6 ",
                "BROMINE ",
                "CASTLE ",
                "Crouching Yeti ",
                "DYMALLOY ",
                "Dragonfly ",
                "Energetic Bear / Berserk Bear ",
                "Ghost Blizzard ",
                "TEMP.Isotope ",
                "TG-4192 ",
                "ALLANITE "
            ],
            "source_name": "Secureworks:IRON LIBERTY",
            "tools": [
                " Ddex Loader",
                " Havex",
                " Karagany",
                " Loek",
                " MCMD",
                " Sysmain",
                " xfrost",
                "ClientX"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "3a0be4ff-9074-4efd-98e4-47c6a62b14ad",
            "created_at": "2022-10-25T16:07:23.590051Z",
            "updated_at": "2025-03-27T02:02:09.878211Z",
            "deleted_at": null,
            "main_name": "Energetic Bear",
            "aliases": [
                "ATK 6",
                "Blue Kraken",
                "Crouching Yeti",
                "Dragonfly",
                "Electrum",
                "Energetic Bear",
                "Ghost Blizzard",
                "Group 24",
                "ITG15",
                "Iron Liberty",
                "Koala Team",
                "TG-4192"
            ],
            "source_name": "ETDA:Energetic Bear",
            "tools": [
                "Backdoor.Oldrea",
                "CRASHOVERRIDE",
                "Commix",
                "CrackMapExec",
                "CrashOverride",
                "Dirsearch",
                "Dorshel",
                "Fertger",
                "Fuerboos",
                "Goodor",
                "Havex",
                "Havex RAT",
                "Hello EK",
                "Heriplor",
                "Impacket",
                "Industroyer",
                "Karagany",
                "Karagny",
                "LightsOut 2.0",
                "LightsOut EK",
                "Listrix",
                "Oldrea",
                "PEACEPIPE",
                "PHPMailer",
                "PsExec",
                "SMBTrap",
                "Subbrute",
                "Sublist3r",
                "Sysmain",
                "Trojan.Karagany",
                "WSO",
                "Webshell by Orb",
                "Win32/Industroyer",
                "Wpscan",
                "nmap",
                "sqlmap",
                "xFrost"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535531,
    "ts_updated_at": 1743041499,
    "ts_creation_date": 0,
    "ts_modification_date": 0,
    "files": {
        "pdf": "https://archive.orkl.eu/f2c9e4edbd57c5303a00a5cdb62dc5baa9d551ce.pdf",
        "text": "https://archive.orkl.eu/f2c9e4edbd57c5303a00a5cdb62dc5baa9d551ce.txt",
        "img": "https://archive.orkl.eu/f2c9e4edbd57c5303a00a5cdb62dc5baa9d551ce.jpg"
    }
}