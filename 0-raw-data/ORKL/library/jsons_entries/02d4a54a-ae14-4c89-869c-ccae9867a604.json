{
    "id": "02d4a54a-ae14-4c89-869c-ccae9867a604",
    "created_at": "2022-10-25T16:48:12.012168Z",
    "updated_at": "2025-03-27T02:15:45.235327Z",
    "deleted_at": null,
    "sha1_hash": "22d4bacae3cb4eda41d3b3ddf44843e8c5902db8",
    "title": "",
    "authors": "",
    "file_creation_date": "2020-12-18T05:55:12Z",
    "file_modification_date": "2020-12-18T05:55:12Z",
    "file_size": 586834,
    "plain_text": "# Operation SignSight: Supply-chain attack against a certification authority in Southeast Asia\n\n**welivesecurity.com/2020/12/17/operation-signsight-supply-chain-attack-southeast-asia**\n\nDecember 17, 2020\n\n[Just a few weeks after the supply-chain attack on the Able Desktop software, another similar attack occurred on the website of the Vietnam Government Certification Authority (VGCA): ca.gov.vn. The](https://www.welivesecurity.com/2020/12/10/luckymouse-ta428-compromise-able-desktop/)\nattackers modified two of the software installers available for download on this website and added a backdoor in order to compromise users of the legitimate application.\n\nESET researchers uncovered this new supply-chain attack in early December 2020 and notified the compromised organization and the VNCERT. We believe that the website has not been delivering\ncompromised software installers as of the end of August 2020 and ESET telemetry data does not indicate the compromised installers being distributed anywhere else. The Vietnam Government\nCertification Authority confirmed that they were aware of the attack before our notification and that they notified the users who downloaded the trojanized software.\n\n## Supply-chain attack in Vietnam\n\n[In Vietnam, digital signatures are very common, as digitally-signed documents have the same level of enforceability as “wet” signatures. According to Decree No. 130/2018, the cryptographic certificates](https://helpx.adobe.com/sign/using/legality-vietnam.html)\nused to sign documents must be granted by one of the authorized certificate providers that include the VGCA, which is part of the Government Cipher Committee. That committee, in turn, depends on\nthe Ministry of Information and Communication.\n\nIn addition to issuing certificates, the VGCA develops and distributes a digital signature toolkit. It is used by the Vietnamese government, and probably by private companies, to sign digital documents.\nThe compromise of a certification authority website is a good opportunity for APT groups, since visitors are likely to have a high level of trust in a state organization responsible for digital signatures.\n\nAs shown in Figure 1, it seems that these programs are deployed in the Party and State agencies.\n\n\n-----\n\nFigure 1. Screenshot of ca.gov.vn\n\nAccording to ESET telemetry, ca.gov.vn was compromised from at least the 23 of July to the 16 of August 2020. Two of the installers available for download, gca01-client-v2-x32-8.3.msi and gca01-rd th\n[client-v2-x64-8.3.msi, were modified to include a piece of malware known as PhantomNet or SManager and recently analyzed by NTT Security. We were able to confirm that those installers were](https://insight-jp.nttsecurity.com/post/102glv5/pandas-new-arsenal-part-3-smanager)\ndownloaded from ca.gov.vn over the HTTPS protocol, so we believe it is unlikely to be a man-in-the-middle attack. The URLs pointing to malicious installers were:\n\nhttps://ca.gov[.]vn/documents/20182/6768590/gca01-client-v2-x64-8.3.msi\nhttps://ca.gov[.]vn/documents/20182/6768590/gca01-client-v2-x32-8.3.msi\n\nThis is also confirmed by data from VirusTotal as shown in Figure 2.\n\n\n-----\n\nFigure 2. Screenshot of VirusTotal. It shows the URL where the trojanized installer was downloaded from.\n\nThe trojanized installers are not properly signed but, we noticed that clean GCA installers are also incorrectly signed (The digital signature of the object did not verify). Both the official and trojanized\nMSIs use a certificate assigned to the Safenet company.\n\nFigure 3 is a summary of the supply-chain attack. To be compromised, a user would have to manually download and execute the compromised software hosted on the official website.\n\nFigure 3. Simplified scheme of the supply-chain attack.\n\n\n-----\n\nOnce downloaded and executed, the installer starts the genuine GCA program and the malicious file. The malicious file is written to C:\\Program Files\\VGCA\\Authentication\\SAC\\x32\\eToken.exe. By\nalso installing the legitimate program, the attackers make sure that this compromise won’t be easily noticed by the end-users.\n\nThis malicious file is a simple dropper that extracts a Windows cabinet file (.cab) named 7z.cab and that contains the backdoor.\n\nIf the dropper runs as an admin, the backdoor is written to C:\\Windows\\apppatch\\netapi32.dll and for the persistence, the dropper registers the malicious DLL as a service.\n\nIf run as a regular user, the backdoor is written to %TEMP%\\Wmedia\\<GetTickCount>.tmp and for the persistence, the dropper creates a scheduled task that calls the export Entery of the malicious\n[DLL. It’s interesting to note that the Entery export was also seen in versions of TManger used by TA428, as detailed by NTT Security.](https://insight-jp.nttsecurity.com/post/102gi9b/pandas-new-arsenal-part-1-tmanger)\n\n## PhantomNet\n\nThe backdoor was named Smanager_ssl.DLL by its developers but we use PhantomNet, as that was the project name used in an older version of this backdoor. This most recent version was compiled on\nthe 26 of April 2020, almost two months before the supply-chain attack. In addition to Vietnam, we have seen victims in the Philippines, but unfortunately we did not uncover the delivery mechanismth\nin those cases.\n\nThis backdoor is quite simple and most of the malicious capabilities are likely deployed through additional plugins. It can retrieve the victim’s proxy configuration and use it to reach out to the\ncommand and control (C&C) server. This shows that the targets are likely to be working in a corporate network.\n\nPhantomNet uses the HTTPS protocol to communicate with its hardcoded C&C servers: vgca.homeunix[.]org and office365.blogdns[.]com. In order to prevent a man-in-the-middle attack, PhantomNet\n[implements certificate pinning, using functions from the SSPI library. The certificate is downloaded during the first connection with the C&C server and then stored in the Windows certificate store.](https://docs.microsoft.com/en-us/windows/win32/rpc/security-support-provider-interface-sspi-)\n\nIn addition to the use of dynamic DNS providers, it is interesting to note that the name of the first subdomain, vgca, was chosen in order to mimic the name of the Vietnam Government Certification\nAuthority.\n\nThe implant can be controlled by the attackers using these five commands:\n\n**Command**\n**ID** **Description**\n\n0x00110020 Get victim information (computer name, hostname, username, OS version, user privileges (admin or not), and the public IP address by querying ipinfo.io ).\n\n0x00110030 Call the export DeletePluginObject of all installed plugins.\n\n0x00110040 Plugin management (install, remove, update). The plugins have the following exports (including the typo in the first one): GetPluginInfomation, GetRegisterCode, GetPluginObject,\nDeletePluginObject .\n\n0x00110070 Set a value of a given field in the main structure of the backdoor.\n\n0x547CBA78 Generate and set a password using the SSPI functions. The final purpose is unknown.\n\nOn VirusTotal, we found one plugin that matches the exports above. It is a debug build and is named SnowballS according to its PDB path and other debug paths:\n\nE:\\WorkCode\\AD_Attacker\\Server\\EXE_DEBUG\\SnowballS.pdb\ne:\\workcode\\ad_attacker\\server\\plugins\\plugins\\snowballs\\cdomainquery.cpp\n\n[An initial, cursory analysis suggests that this tool might be used for lateral movement, as it embeds Invoke-Mimikatz. It can also collect information about the victim machine and user accounts. This](https://github.com/clymb3r/PowerShell/blob/master/Invoke-Mimikatz/Invoke-Mimikatz.ps1)\nshows that PhantomNet can receive additional and complex plugins that are probably only deployed on machines of particular interest to the malware operators.\n\nIn the case of the attack in Vietnam we were not able to recover data about post-compromise activity and thus we don’t have visibility into the end goal of the attackers\n\n\n-----\n\n## Conclusion\n\n[With the compromise of Able Desktop, the attack on WIZVERA VeraPort by Lazarus and the recent supply-chain attack on SolarWinds Orion, we see that supply-chain attacks are a quite common](https://www.welivesecurity.com/2020/12/10/luckymouse-ta428-compromise-able-desktop/)\ncompromise vector for cyberespionage groups. In this specific case, they compromised the website of a Vietnamese certificate authority, in which users are likely to have a high level of trust.\n\nSupply-chain attacks are typically hard to find, as the malicious code is generally hidden among a lot of legitimate code, making its discovery significantly more difficult.\n\n_[For any inquiries, contact us as threatintel@eset.com. Indicators of Compromise can also be found in our GitHub repository.](mailto:threatintel@eset.com)_\n\n## IoCs\n\n**Files**\n\n**SHA-1** **ESET detection name** **Description**\n\n5C77A18880CF58DF9FBA102DD8267C3F369DF449 Win32/TrojanDropper.Agent.SJQ Trojanized installer ( gca01-client-v2-x64-8.3.msi )\n\nB0E4E9BB6EF8AA7A9FCB9C9E571D8162B1B2443A Win32/TrojanDropper.Agent.SJQ Trojanized installer ( gca01-client-v2-x32-8.3.msi )\n\n9522F369AC109B03E6C16511D49D1C5B42E12A44 Win32/TrojanDropper.Agent.SJQ PhantomNet dropper\n\n989334094EC5BA8E0E8F2238CDF34D5C57C283F2 Win32/PhantomNet.B PhantomNet\n\n5DFC07BB6034B4FDA217D96441FB86F5D43B6C62 Win32/PhantomNet.A PhantomNet plugin\n\n**C&C servers**\n\noffice365.blogdns[.]com\n\nvgca.homeunix[.]org\n\n## MITRE ATT&CK\n\n_[Note: This table was built using version 8 of the MITRE ATT&CK framework.](https://attack.mitre.org/versions/v8/)_\n\n**Tactic** **ID** **Name** **Description**\n\n\nInitial Access T1195.002 Supply Chain Compromise: Compromise Software\nSupply Chain\n\n\nAttackers modified the installer of the GCA01 software that is hosted on ca.gov.vn and added a backdoor\nto the MSI installer.\n\n\nExecution T1204.002 User Execution: Malicious File The victim needs to manually execute the trojanized installer.\n\nPersistence T1053.005 Scheduled Task/Job: Scheduled Task If the user doesn’t have admin privileges, PhantomNet persists via a scheduled task.\n\nT1543.003 Create or Modify System Process: Windows Service If the user has admin privileges, PhantomNet persists via a Windows service.\n\nDiscovery T1033 System Owner/User Discovery PhantomNet implements a function to retrieve the username.\n\nT1082 System Information Discovery PhantomNet implements a function to retrieve the OS version.\n\n\nCommand and\nControl\n\n\nT1090.001 Proxy: Internal Proxy PhantomNet can retrieve the proxy configuration of the default browser and use it to connect to the C&C\nserver.\n\n\n-----\n\n**Tactic** **ID** **Name** **Description**\n\nT1071.001 Application Layer Protocol: Web Protocols PhantomNet uses HTTPS.\n\nT1573.002 Encrypted Channel: Asymmetric Cryptography PhantomNet can add a certificate to the Windows store and use it for certificate pinning for its HTTPS\ncommunications.\n\n17 Dec 2020 - 11:30AM\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        }
    ],
    "references": [
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2020/2020.12.17.Operation_SignSight/Operation%20SignSight_%20Supply%E2%80%91chain%20attack%20against%20a%20certification%20authority%20in%20Southeast%20Asia%20_%20WeLiveSecurity.pdf"
    ],
    "report_names": [
        "Operation SignSight_ Supply‑chain attack against a certification authority in Southeast Asia _ WeLiveSecurity"
    ],
    "threat_actors": [
        {
            "id": "bbdb2d7d-4bf4-4100-a108-f4742cfd69ff",
            "created_at": "2022-10-25T16:07:24.01101Z",
            "updated_at": "2025-03-27T02:02:10.074776Z",
            "deleted_at": null,
            "main_name": "Operation SignSight",
            "aliases": [],
            "source_name": "ETDA:Operation SignSight",
            "tools": [
                "Mimikatz",
                "PhantomNet",
                "SManager"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "a4aca3ca-9e04-42d1-b037-f7fb3fbab0b1",
            "created_at": "2023-01-06T13:46:39.042499Z",
            "updated_at": "2025-03-27T02:00:02.984002Z",
            "deleted_at": null,
            "main_name": "TA428",
            "aliases": [
                "Colourful Panda",
                "BRONZE DUDLEY"
            ],
            "source_name": "MISPGALAXY:TA428",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "f8dddd06-da24-4184-9e24-4c22bdd1cbbf",
            "created_at": "2023-01-06T13:46:38.626906Z",
            "updated_at": "2025-03-27T02:00:02.877001Z",
            "deleted_at": null,
            "main_name": "Tick",
            "aliases": [
                "Stalker Taurus",
                "PLA Unit 61419",
                "Nian",
                "BRONZE BUTLER",
                "REDBALDKNIGHT",
                "STALKER PANDA",
                "G0060"
            ],
            "source_name": "MISPGALAXY:Tick",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "2f07a03f-eb1f-47c8-a8e9-a1a00f2ec253",
            "created_at": "2022-10-25T16:07:24.277669Z",
            "updated_at": "2025-03-27T02:02:10.157972Z",
            "deleted_at": null,
            "main_name": "TA428",
            "aliases": [
                "Operation LagTime IT",
                "Operation StealthyTrident",
                "ThunderCats"
            ],
            "source_name": "ETDA:TA428",
            "tools": [
                "8.t Dropper",
                "8.t RTF exploit builder",
                "8t_dropper",
                "Agent.dhwf",
                "Albaniiutas",
                "BlueTraveller",
                "Chymine",
                "Cotx RAT",
                "CoughingDown",
                "Darkmoon",
                "Destroy RAT",
                "DestroyRAT",
                "Gen:Trojan.Heur.PT",
                "Kaba",
                "Korplug",
                "LuckyBack",
                "PhantomNet",
                "PlugX",
                "Poison Ivy",
                "RedDelta",
                "RoyalRoad",
                "SManager",
                "SPIVY",
                "Sogu",
                "TIGERPLUG",
                "TManger",
                "TVT",
                "Thoper",
                "Xamtrav",
                "pivy",
                "poisonivy"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "e3492534-85a6-4c87-a754-5ae4a56d7c8c",
            "created_at": "2022-10-25T15:50:23.819113Z",
            "updated_at": "2025-03-27T02:00:55.552554Z",
            "deleted_at": null,
            "main_name": "Threat Group-3390",
            "aliases": [
                "Threat Group-3390",
                "Earth Smilodon",
                "TG-3390",
                "Emissary Panda",
                "BRONZE UNION",
                "APT27",
                "Iron Tiger",
                "LuckyMouse"
            ],
            "source_name": "MITRE:Threat Group-3390",
            "tools": [
                "Systeminfo",
                "gsecdump",
                "PlugX",
                "ASPXSpy",
                "Cobalt Strike",
                "Mimikatz",
                "Impacket",
                "gh0st RAT",
                "certutil",
                "China Chopper",
                "HTTPBrowser",
                "Tasklist",
                "netstat",
                "SysUpdate",
                "HyperBro",
                "ZxShell",
                "RCSession",
                "ipconfig",
                "Clambling",
                "pwdump",
                "NBTscan",
                "Pandora",
                "Windows Credential Editor"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "c416260c-7ff6-4a74-a5ba-a15f40d3543f",
            "created_at": "2024-05-01T02:03:07.939268Z",
            "updated_at": "2025-03-27T02:05:17.25652Z",
            "deleted_at": null,
            "main_name": "BRONZE DUDLEY",
            "aliases": [
                "Temp.Hex ",
                "Vicious Panda ",
                "TA428 "
            ],
            "source_name": "Secureworks:BRONZE DUDLEY",
            "tools": [
                "PoisonIvy"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "d4e7cd9a-2290-4f89-a645-85b9a46d004b",
            "created_at": "2022-10-25T16:07:23.419513Z",
            "updated_at": "2025-03-27T02:02:09.790389Z",
            "deleted_at": null,
            "main_name": "Bronze Butler",
            "aliases": [
                "Bronze Butler",
                "CTG-2006",
                "Operation ENDTRADE",
                "RedBaldNight",
                "Stalker Panda",
                "Stalker Taurus",
                "TEMP.Tick",
                "Tick"
            ],
            "source_name": "ETDA:Bronze Butler",
            "tools": [
                "8.t Dropper",
                "8.t RTF exploit builder",
                "8t_dropper",
                "9002 RAT",
                "AngryRebel",
                "Blogspot",
                "Daserf",
                "Datper",
                "Elirks",
                "Farfli",
                "Gh0st RAT",
                "Ghost RAT",
                "HOMEUNIX",
                "HidraQ",
                "HomamDownloader",
                "Homux",
                "Hydraq",
                "Lilith",
                "Lilith RAT",
                "McRAT",
                "MdmBot",
                "Mimikatz",
                "Minzen",
                "Moudour",
                "Muirim",
                "Mydoor",
                "Nioupale",
                "PCRat",
                "POISONPLUG.SHADOW",
                "Roarur",
                "RoyalRoad",
                "ShadowPad Winnti",
                "ShadowWali",
                "ShadowWalker",
                "SymonLoader",
                "WCE",
                "Wali",
                "Windows Credential Editor",
                "Windows Credentials Editor",
                "XShellGhost",
                "XXMM",
                "gsecdump",
                "rarstar"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "5c13338b-eaed-429a-9437-f5015aa98276",
            "created_at": "2022-10-25T16:07:23.582715Z",
            "updated_at": "2025-03-27T02:02:09.875151Z",
            "deleted_at": null,
            "main_name": "Emissary Panda",
            "aliases": [
                "APT 27",
                "ATK 15",
                "Bronze Union",
                "Budworm",
                "Earth Smilodon",
                "Emissary Panda",
                "Group 35",
                "Iron Taurus",
                "Iron Tiger",
                "LuckyMouse",
                "Operation DRBControl",
                "Operation Iron Tiger",
                "Operation PZChao",
                "Operation SpoiledLegacy",
                "Operation StealthyTrident",
                "Red Phoenix",
                "TEMP.Hippo",
                "TG-3390",
                "ZipToken"
            ],
            "source_name": "ETDA:Emissary Panda",
            "tools": [
                "ASPXSpy",
                "ASPXTool",
                "Agent.dhwf",
                "AngryRebel",
                "Antak",
                "CHINACHOPPER",
                "China Chopper",
                "Destroy RAT",
                "DestroyRAT",
                "FOCUSFJORD",
                "Farfli",
                "Gh0st RAT",
                "Ghost RAT",
                "HTTPBrowser",
                "HTran",
                "HUC Packet Transmit Tool",
                "HighShell",
                "HttpBrowser RAT",
                "HttpDump",
                "HyperBro",
                "HyperSSL",
                "HyperShell",
                "Kaba",
                "Korplug",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "Mimikatz",
                "Moudour",
                "Mydoor",
                "Nishang",
                "OwaAuth",
                "PCRat",
                "PlugX",
                "ProcDump",
                "PsExec",
                "RedDelta",
                "SEASHARPEE",
                "Sensocode",
                "SinoChopper",
                "Sogu",
                "SysUpdate",
                "TIGERPLUG",
                "TVT",
                "Thoper",
                "Token Control",
                "TokenControl",
                "TwoFace",
                "WCE",
                "Windows Credential Editor",
                "Windows Credentials Editor",
                "Xamtrav",
                "ZXShell",
                "gsecdump",
                "luckyowa"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "bf0489c5-1c07-41e6-91c9-855ad96ccc6a",
            "created_at": "2022-10-25T16:47:55.541639Z",
            "updated_at": "2025-03-27T02:05:17.253496Z",
            "deleted_at": null,
            "main_name": "BRONZE BUTLER",
            "aliases": [
                "Daserf",
                "Stalker Panda ",
                "Tick ",
                "CTG-2006 "
            ],
            "source_name": "Secureworks:BRONZE BUTLER",
            "tools": [
                " DGet",
                " Daserf",
                " Datper",
                " Gofarer",
                " MSGet",
                " Mimikatz",
                " RarStar",
                " Screen Capture Tool",
                " ShadowPad",
                " T-SMB",
                " WinRAR",
                " Windows Credential Editor",
                " gsecdump",
                " xmm downloader",
                " xxmm",
                "ABK"
            ],
            "source_id": "Secureworks",
            "reports": null
        }
    ],
    "ts_created_at": 1666716492,
    "ts_updated_at": 1743041745,
    "ts_creation_date": 1608270912,
    "ts_modification_date": 1608270912,
    "files": {
        "pdf": "https://archive.orkl.eu/22d4bacae3cb4eda41d3b3ddf44843e8c5902db8.pdf",
        "text": "https://archive.orkl.eu/22d4bacae3cb4eda41d3b3ddf44843e8c5902db8.txt",
        "img": "https://archive.orkl.eu/22d4bacae3cb4eda41d3b3ddf44843e8c5902db8.jpg"
    }
}