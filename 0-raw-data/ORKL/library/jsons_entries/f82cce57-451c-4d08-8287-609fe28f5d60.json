{
    "id": "f82cce57-451c-4d08-8287-609fe28f5d60",
    "created_at": "2022-12-15T02:05:03.572383Z",
    "updated_at": "2025-03-27T02:16:37.061672Z",
    "deleted_at": null,
    "sha1_hash": "4d042f2898173264f3791050861eb0b4313213fe",
    "title": "",
    "authors": "",
    "file_creation_date": "2022-12-14T03:17:40Z",
    "file_modification_date": "2022-12-14T03:17:40Z",
    "file_size": 355043,
    "plain_text": "# Internet Explorer 0-day exploited by North Korean actor APT37\n\n**[blog.google/threat-analysis-group/internet-explorer-0-day-exploited-by-north-korean-actor-apt37](https://blog.google/threat-analysis-group/internet-explorer-0-day-exploited-by-north-korean-actor-apt37/)**\n\nDecember 7, 2022\n\n[To protect our users, Google’s Threat Analysis Group (TAG) routinely hunts for 0-day](https://blog.google/threat-analysis-group/protecting-android-users-from-0-day-attacks/)\nvulnerabilities exploited in-the-wild. This blog will describe a 0-day vulnerability,\ndiscovered by TAG in late October 2022, embedded in malicious documents and used to\ntarget users in South Korea. We attribute this activity to a group of North Korean\ngovernment-backed actors known as APT37. These malicious documents exploited an\n[Internet Explorer 0-day vulnerability in the JScript engine, CVE-2022-41128. Our policy](https://msrc.microsoft.com/update-guide/en-US/vulnerability/CVE-2022-41128)\nis to quickly report vulnerabilities to vendors, and within a few hours of discovering this\n[0-day, we reported it to Microsoft and patches were released to protect users from these](https://msrc.microsoft.com/update-guide/en-US/vulnerability/CVE-2022-41128)\nattacks.\n\n[This is not the first time APT37 has used Internet Explorer 0-day exploits to target users.](https://www.volexity.com/blog/2021/08/17/north-korean-apt-inkysquid-infects-victims-using-browser-exploits/)\nThe group has historically focused their targeting on South Korean users, North Korean\ndefectors, policy makers, journalists and human rights activists.\n\n## Microsoft Office document using tragic news as a lure\n\nOn October 31, 2022, multiple submitters from South Korea reported new malware to us\n[by uploading a Microsoft Office document to VirusTotal. The document, titled “221031](https://www.virustotal.com/gui/file/926a947ea2b59d3e9a5a6875b4de2bd071b15260370f4da5e2a60ece3517a32f/)\nSeoul Yongsan Itaewon accident response situation (06:00).docx”, references the tragic\nincident in the neighborhood of Itaewon, in Seoul, South Korea during Halloween\n[celebrations on October 29, 2022. This incident was widely reported on, and the lure](https://www.bbc.com/news/world-asia-63526479)\ntakes advantage of widespread public interest in the accident.\n\n\n-----\n\nThe document downloaded a rich text file (RTF) remote template, which in turn fetched\nremote HTML content. Because Office renders this HTML content using Internet\nExplorer (IE), this technique has been widely used to distribute IE exploits via Office files\n[since 2017 (e.g. CVE-2017-0199). Delivering IE exploits via this vector has the advantage](https://msrc.microsoft.com/update-guide/vulnerability/CVE-2017-0199)\nof not requiring the target to use Internet Explorer as its default browser, nor to chain the\nexploit with an EPM sandbox escape.\n\nUpon investigation, TAG observed the attackers abused an 0-day vulnerability in the\nJScript engine of Internet Explorer.\n\n## TAG identified Internet Explorer 0-day\n\nThe vulnerability resides within “jscript9.dll”, the JavaScript engine of Internet Explorer,\nand can be exploited to execute arbitrary code when rendering an attacker-controlled\nwebsite. The bug itself is an incorrect JIT optimization issue leading to a type confusion\n[and is very similar to CVE-2021-34480, which was identified by Project Zero and patched](https://bugs.chromium.org/p/project-zero/issues/detail?id=2188&q=jscript9&can=1)\nin 2021. TAG reported the vulnerability to Microsoft on October 31, 2022, and the label\n[CVE-2022-41128 was assigned on November 3, 2022. The vulnerability was patched on](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-41128)\nNovember 8, 2022.\n\n\n-----\n\n## Analysis of the exploit\n\nIn a typical delivery scenario, the initial document would have the Mark-of-the-Web\napplied. This means the user has to disable protected view before the remote RTF\ntemplate is fetched.\n\nWhen delivering the remote RTF, the web server sets a unique cookie in the response,\nwhich is sent again when the remote HTML content is requested. This likely detects direct\nHTML exploit code fetches which are not part of a real infection.\n\nThe exploit JavaScript also verifies that the cookie is set before launching the exploit.\nAdditionally it reports twice to the C2 server: before launching the exploit and after the\nexploit succeeds.\n\nTAG also identified other documents likely exploiting the same vulnerability and with\nsimilar targeting, which may be part of the same campaign. Further details on those\ndocuments can be found in the “Indicators” section below.\n\nThe delivered shellcode uses a custom hashing algorithm to resolve Windows APIs. The\nshellcode erases all traces of exploitation by clearing the Internet Explorer cache and\nhistory before downloading the next stage. The next stage is downloaded using the same\ncookie that was set when the server delivered the remote RTF.\n\nAlthough we did not recover a final payload for this campaign, we’ve previously observed\n[the same group deliver a variety of implants like ROKRAT, BLUELIGHT, and DOLPHIN.](https://blog.talosintelligence.com/rokrat-reloaded/)\nAPT37 implants typically abuse legitimate cloud services as a C2 channel and offer\ncapabilities typical of most backdoors.\n\nAdditional technical information on the vulnerability, the exploit and the patch, is\n[available in the Root Cause Analysis.](https://googleprojectzero.github.io/0days-in-the-wild/0day-RCAs/2022/CVE-2022-41128.html)\n\n## Conclusions\n\nTAG is committed to sharing research to raise awareness on bad actors like APT37 within\nthe security community, and for companies and individuals that may be targeted. By\nimproving understanding of the tactics and techniques of these types of actors, we hope to\nstrengthen protections across the ecosystem. We will also continuously apply these\nfindings to improve the safety and security of our products and continue to effectively\ncombat threats and protect users who rely on our services.\n\nWe’d be remiss if we did not acknowledge the quick response and patching of this\nvulnerability by the Microsoft team.\n\n**Indicators of compromise (IOCs)**\n\n\n-----\n\nInitial documents:\n\n56ca24b57c4559f834c190d50b0fe89dd4a4040a078ca1f267d0bbc7849e9ed7\naf5fb99d3ff18bc625fb63f792ed7cd955171ab509c2f8e7c7ee44515e09cebf\n926a947ea2b59d3e9a5a6875b4de2bd071b15260370f4da5e2a60ece3517a32f\n3bff571823421c013e79cc10793f238f4252f7d7ac91f9ef41435af0a8c09a39\nc49b4d370ad0dcd1e28ee8f525ac8e3c12a34cfcf62ebb733ec74cca59b29f82\n\nRemote RTF template:\n\n08f93351d0d3905bee5b0c2b9215d448abb0d3cf49c0f8b666c46df4fcc007cb\n\nC2:\n\nword-template[.]net\nopenxmlformat[.]org\nms-office[.]services\nms-offices[.]com\ntemplate-openxml[.]com\n\nPOSTED IN:\n\n[Threat Analysis Group](https://blog.google/threat-analysis-group/)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        },
        {
            "id": "4e039bf8-7239-4999-8ec0-eb202d1465af",
            "created_at": "2022-12-04T11:19:36.52593Z",
            "updated_at": "2022-12-04T11:19:36.52593Z",
            "deleted_at": null,
            "name": "ORKL",
            "url": "https://github.com/ORKL/library",
            "description": "ORKL Community Contributed Content",
            "reports": null
        }
    ],
    "references": [
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2022/2022.12.07.APT37_0Day/Internet%20Explorer%200-day%20exploited%20by%20North%20Korean%20actor%20APT37.pdf"
    ],
    "report_names": [
        "Internet Explorer 0-day exploited by North Korean actor APT37"
    ],
    "threat_actors": [
        {
            "id": "9f101d9c-05ea-48b9-b6f1-168cd6d06d12",
            "created_at": "2023-01-06T13:46:39.396409Z",
            "updated_at": "2025-03-27T02:00:03.074969Z",
            "deleted_at": null,
            "main_name": "Earth Lusca",
            "aliases": [
                "CHROMIUM",
                "ControlX",
                "Red Dev 10",
                "RedHotel",
                "Red Scylla",
                "TAG-22",
                "BRONZE UNIVERSITY",
                "AQUATIC PANDA",
                "Charcoal Typhoon",
                "BountyGlad"
            ],
            "source_name": "MISPGALAXY:Earth Lusca",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "bbe36874-34b7-4bfb-b38b-84a00b07042e",
            "created_at": "2022-10-25T15:50:23.375277Z",
            "updated_at": "2025-03-27T02:00:55.457787Z",
            "deleted_at": null,
            "main_name": "APT37",
            "aliases": [
                "APT37",
                "InkySquid",
                "ScarCruft",
                "Group123",
                "TEMP.Reaper",
                "Ricochet Chollima"
            ],
            "source_name": "MITRE:APT37",
            "tools": [
                "BLUELIGHT",
                "CORALDECK",
                "KARAE",
                "SLOWDRIFT",
                "ROKRAT",
                "SHUTTERSPEED",
                "POORAIM",
                "HAPPYWORK",
                "Final1stspy",
                "Cobalt Strike",
                "NavRAT",
                "DOGCALL",
                "WINERACK"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "552ff939-52c3-421b-b6c9-749cbc21a794",
            "created_at": "2023-01-06T13:46:38.742547Z",
            "updated_at": "2025-03-27T02:00:02.906537Z",
            "deleted_at": null,
            "main_name": "APT37",
            "aliases": [
                "ScarCruft",
                "Venus 121",
                "Moldy Pisces",
                "Group 123",
                "APT 37",
                "Group123",
                "Operation Daybreak",
                "Operation Erebus",
                "Red Eyes",
                "TA-RedAnt",
                "InkySquid",
                "Reaper Group",
                "Ricochet Chollima",
                "ATK4",
                "G0067"
            ],
            "source_name": "MISPGALAXY:APT37",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "6abcc917-035c-4e9b-a53f-eaee636749c3",
            "created_at": "2022-10-25T16:07:23.565337Z",
            "updated_at": "2025-03-27T02:02:09.868522Z",
            "deleted_at": null,
            "main_name": "Earth Lusca",
            "aliases": [
                "Bronze University",
                "Charcoal Typhoon",
                "Chromium",
                "Red Dev 10",
                "Red Scylla"
            ],
            "source_name": "ETDA:Earth Lusca",
            "tools": [
                "Agentemis",
                "AntSword",
                "BIOPASS",
                "BIOPASS RAT",
                "BadPotato",
                "Behinder",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "Doraemon",
                "FRP",
                "Fast Reverse Proxy",
                "FunnySwitch",
                "HUC Port Banner Scanner",
                "KTLVdoor",
                "Mimikatz",
                "NBTscan",
                "POISONPLUG.SHADOW",
                "PipeMon",
                "RbDoor",
                "RibDoor",
                "RouterGod",
                "SAMRID",
                "ShadowPad Winnti",
                "SprySOCKS",
                "WinRAR",
                "Winnti",
                "XShellGhost",
                "cobeacon",
                "fscan",
                "lcx",
                "nbtscan"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "f0bccc3d-ad77-49c4-8dfd-8a8a8d6fba26",
            "created_at": "2024-05-01T02:03:08.134022Z",
            "updated_at": "2025-03-27T02:05:17.415028Z",
            "deleted_at": null,
            "main_name": "NICKEL FOXCROFT",
            "aliases": [
                "Group 123 ",
                "Moldy Pisces ",
                "RICOCHET CHOLLIMA ",
                "Reaper ",
                "ScarCruft ",
                "APT37 "
            ],
            "source_name": "Secureworks:NICKEL FOXCROFT",
            "tools": [
                "ROKRAT"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "d53593c3-2819-4af3-bf16-0c39edc64920",
            "created_at": "2022-10-27T08:27:13.212301Z",
            "updated_at": "2025-03-27T02:00:55.529662Z",
            "deleted_at": null,
            "main_name": "Earth Lusca",
            "aliases": [
                "Earth Lusca",
                "TAG-22",
                "Charcoal Typhoon",
                "CHROMIUM",
                "ControlX"
            ],
            "source_name": "MITRE:Earth Lusca",
            "tools": [
                "Mimikatz",
                "PowerSploit",
                "Tasklist",
                "certutil",
                "Cobalt Strike",
                "Winnti for Linux",
                "Nltest",
                "NBTscan",
                "ShadowPad"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "9b02c527-5077-489e-9a80-5d88947fddab",
            "created_at": "2022-10-25T16:07:24.103499Z",
            "updated_at": "2025-03-27T02:02:10.108504Z",
            "deleted_at": null,
            "main_name": "Reaper",
            "aliases": [
                "APT 37",
                "ATK 4",
                "Cerium",
                "Crooked Pisces",
                "Geumseong121",
                "Group 123",
                "ITG10",
                "InkySquid",
                "Moldy Pisces",
                "Opal Sleet",
                "Operation Are You Happy?",
                "Operation Battle Cruiser",
                "Operation Black Banner",
                "Operation Daybreak",
                "Operation Dragon messenger",
                "Operation Erebus",
                "Operation Evil New Year",
                "Operation Evil New Year 2018",
                "Operation Fractured Block",
                "Operation Fractured Statue",
                "Operation FreeMilk",
                "Operation Golden Bird",
                "Operation Golden Time",
                "Operation High Expert",
                "Operation Holiday Wiper",
                "Operation Korean Sword",
                "Operation North Korean Human Right",
                "Operation Onezero",
                "Operation Rocket Man",
                "Operation SHROUDED#SLEEP",
                "Operation STARK#MULE",
                "Operation STIFF#BIZON",
                "Operation Spy Cloud",
                "Operation Star Cruiser",
                "Osmium",
                "Red Eyes",
                "Ricochet Chollima",
                "Ruby Sleet",
                "ScarCruft",
                "TA-RedAnt",
                "TEMP.Reaper",
                "Venus 121"
            ],
            "source_name": "ETDA:Reaper",
            "tools": [
                "Agentemis",
                "BLUELIGHT",
                "Backdoor.APT.POORAIM",
                "CARROTBALL",
                "CARROTBAT",
                "CORALDECK",
                "Cobalt Strike",
                "CobaltStrike",
                "DOGCALL",
                "Erebus",
                "Exploit.APT.RICECURRY",
                "Final1stSpy",
                "Freenki Loader",
                "GELCAPSULE",
                "GOLDBACKDOOR",
                "GreezeBackdoor",
                "HAPPYWORK",
                "JinhoSpy",
                "KARAE",
                "KevDroid",
                "Konni",
                "MILKDROP",
                "N1stAgent",
                "NavRAT",
                "Nokki",
                "Oceansalt",
                "POORAIM",
                "PoohMilk",
                "PoohMilk Loader",
                "RICECURRY",
                "RUHAPPY",
                "RokRAT",
                "SHUTTERSPEED",
                "SLOWDRIFT",
                "SOUNDWAVE",
                "SYSCON",
                "Sanny",
                "ScarCruft",
                "StarCruft",
                "Syscon",
                "VeilShell",
                "WINERACK",
                "ZUMKONG",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1671069903,
    "ts_updated_at": 1743041797,
    "ts_creation_date": 1670987860,
    "ts_modification_date": 1670987860,
    "files": {
        "pdf": "https://archive.orkl.eu/4d042f2898173264f3791050861eb0b4313213fe.pdf",
        "text": "https://archive.orkl.eu/4d042f2898173264f3791050861eb0b4313213fe.txt",
        "img": "https://archive.orkl.eu/4d042f2898173264f3791050861eb0b4313213fe.jpg"
    }
}