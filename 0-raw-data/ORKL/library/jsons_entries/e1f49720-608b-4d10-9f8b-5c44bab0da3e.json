{
    "id": "e1f49720-608b-4d10-9f8b-5c44bab0da3e",
    "created_at": "2023-01-12T15:03:56.588604Z",
    "updated_at": "2025-03-27T02:09:30.112935Z",
    "deleted_at": null,
    "sha1_hash": "e9e751fd5ea6ebf819ad17fbc7ad6247ca6c4ac0",
    "title": "2022-04-12 - Threat Profile- LockBit",
    "authors": "",
    "file_creation_date": "2022-05-27T23:01:03Z",
    "file_modification_date": "2022-05-27T23:01:03Z",
    "file_size": 121396,
    "plain_text": "# Threat Report\n\n**connectwise.com/resources/lockbit-profile**\n\nIn the [2022 MSP Threat Report, the CRU identified the top 5 ransomware threats targeting MSPs in](https://www.connectwise.com/resources/ebook-2022-msp-threat-report)\n2021 and provided a brief description of each. This page includes supplemental material with a\nmore detailed breakdown of the TTPs and suggested mitigation techniques.\n\n## LockBit\n\nRansomware-as-a-service provider that first appeared in September 2019, originally dubbed\n\"ABCD\"\nKnown for their fast encryption, they claim to have the fastest encryption of any ransomware\nUses the double extortion method of encrypting files and threatening to leak stolen data\n\n## MITRE ATT&CK mapping®\n\n\n**Initial**\n\n**Access**\n\n\n**Defense**\n\n**Evasion**\n\n\n**Lateral**\n\n**Movement**\n\n\n**Credential**\n\n**Access**\n\n\n**Reconnaissance**\n\n\n**Resource**\n\n**Development**\n\n\n**Execution**\n\n\n**Impact**\n\n\n**Persistence**\n\n\n**Privilege**\n\n**Escalation**\n\n\n**Exfiltration**\n\n|Active Scanning|Col2|\n|---|---|\n||Scanning IP Blocks|\n\n|Compromise Infrastructure|Col2|\n|---|---|\n||Domains|\n\n|Credentials from Password Stores|Col2|\n|---|---|\n|OS Credential Dumping||\n||Cached Domain Credentials|\n\n|Exfiltration Over C2 Channel|Col2|\n|---|---|\n|Exfiltration Over Web Service||\n||Exfiltration to Cloud Storage|\n\n|Command and Scripting Interpreter|Col2|\n|---|---|\n||PowerShell|\n||Windows Command Shell|\n|Windows Management Instrumentation||\n\n|Lateral Tool Transfer|Col2|\n|---|---|\n|Remote Services||\n||Remote Desktop Protocol|\n|Taint Shared Content||\n\n|Domain Policy Modification|Col2|\n|---|---|\n||Group Policy Modification|\n|Obfuscated Files or Information||\n||Software Packing|\n|Valid Accounts||\n\n|Boot or Logon Autostart Execution|Col2|\n|---|---|\n||Registry Run Keys / Startup Folder|\n|External Remote Services||\n|Hijack Execution Flow||\n||DLL Search Order Hijacking|\n|Valid Accounts||\n\n|Abuse Elevation Control Mechanism|Col2|\n|---|---|\n||Bypass User Account Control|\n|Access Token Manipulation||\n|Domain Policy Modification||\n||Group Policy Modification|\n|Valid Accounts||\n\n\n## LockBit TTPs and Mitigations\n\n**ATT&CK Tactic** **ATT&CK Technique** **Mitigations**\n\n\n-----\n\nReconnaissance [T1595.001 – Active](https://attack.mitre.org/techniques/T1595/001/)\nScanning – Scanning\nIP Blocks:\n\nAdversaries may scan\nvictim IP blocks to\ngather information\nthat can be used\nduring targeting.\nPublic IP addresses\nmay be allocated to\norganizations by\nblock, or a range of\nsequential addresses.\n\nResource Development [T1584.001 –](https://attack.mitre.org/techniques/T1584/001/)\nCompromise\nInfrastructure –\nDomains:\n\nAdversaries may\nhijack domains and/or\nsubdomains that can\nbe used during\ntargeting. Domain\nregistration hijacking\nis the act of changing\nthe registration of a\ndomain name without\nthe permission of the\noriginal registrant.\n\nInitial Access [T1190 – Exploit](https://attack.mitre.org/techniques/T1190/)\nPublic-Facing\nApplication:\n\nAdversaries may\nattempt to take\nadvantage of a\nweakness in an\nInternet-facing\ncomputer or program\nusing software, data,\nor commands in order\nto cause unintended\nor unanticipated\nbehavior. The\nweakness in the\nsystem can be a bug,\na glitch, or a design\nvulnerability.\n\n\n[M1056 – Pre-](https://attack.mitre.org/mitigations/M1056/)\ncompromise:\n\nThis technique cannot\nbe easily mitigated\nwith preventive\ncontrols since it is\nbased on behaviors\nperformed outside of\nthe scope of\nenterprise defenses\nand controls. Efforts\nshould focus on\nminimizing the\namount and sensitivity\nof data available to\nexternal parties.\n\n[M1056 – Pre-](https://attack.mitre.org/mitigations/M1056/)\ncompromise:\n\nThis technique cannot\nbe easily mitigated\nwith preventive\ncontrols since it is\nbased on behaviors\nperformed outside of\nthe scope of\nenterprise defenses\nand controls. Efforts\nshould focus on\nminimizing the\namount and sensitivity\nof data available to\nexternal parties.\n\n[M1048 - Application](https://attack.mitre.org/mitigations/M1048/)\nIsolation and\nSandboxing:\n\nApplication isolation\nwill limit what other\nprocesses and\nsystem features the\nexploited target can\naccess.\n\n\n-----\n\n[M1050 - Exploit Protection:](https://attack.mitre.org/mitigations/M1050/)\n\nWeb Application Firewalls may be used to limit\nexposure of applications to prevent exploit traffic\nfrom reaching the application.\n\n[M1030 - Network Segmentation:](https://attack.mitre.org/mitigations/M1030/)\n\nSegment externally facing servers and services\nfrom the rest of the network with a DMZ or on\nseparate hosting infrastructure.\n\n[M1026 - Privileged Account Management:](https://attack.mitre.org/mitigations/M1026/)\n\nUse least privilege for service accounts will limit\nwhat permissions the exploited process gets on the\nrest of the system.\n\n[M1051 – Update Software:](https://attack.mitre.org/mitigations/M1051/)\n\nUpdate software regularly by employing patch\nmanagement for externally exposed applications.\n\n[M1016 – Vulnerability Scanning:](https://attack.mitre.org/mitigations/M1016/)\n\nRegularly scan externally facing systems for\nvulnerabilities and establish procedures to rapidly\npatch systems when critical vulnerabilities are\ndiscovered through scanning and through public\ndisclosure.\n\n[T1133 – External Remote Services:](https://attack.mitre.org/techniques/T1133/)\n\nAdversaries may leverage external-facing remote\nservices to initially access and/or persist within a\nnetwork.\n\n[M1035 - Limit Access to Resource Over Network:](https://attack.mitre.org/mitigations/M1035)\n\nLimit access to remote services through centrally\nmanaged concentrators such as VPNs and other\nmanaged remote access systems.\n\n\n[M1042 - Disable or](https://attack.mitre.org/mitigations/M1042)\nRemove Feature or\nProgram:\n\nDisable or block\nremotely available\nservices that may be\nunnecessary.\n\n\n-----\n\n[M1032 - Multi-factor Authentication:](https://attack.mitre.org/mitigations/M1032)\n\nUse strong two-factor or multi-factor authentication\nfor remote service accounts to mitigate an\nadversary's ability to leverage stolen credentials,\nbut be aware of Two-Factor Authentication\nInterception techniques for some two-factor\nauthentication implementations.\n\n[M1030 - Network Segmentation:](https://attack.mitre.org/mitigations/M1030)\n\nDeny direct remote access to internal systems\nthrough the use of network proxies, gateways, and\nfirewalls.\n\n[T1566 – Phishing:](https://attack.mitre.org/techniques/T1566/)\n\nAdversaries may send phishing messages to gain\naccess to victim systems. All forms of phishing are\nelectronically delivered social engineering.\n\n[M1031 - Network Intrusion Prevention:](https://attack.mitre.org/mitigations/M1031)\n\nNetwork intrusion prevention systems and systems\ndesigned to scan and remove malicious email\nattachments or links can be used to block activity.\n\n[M1021 - Restrict Web-Based Content:](https://attack.mitre.org/mitigations/M1021)\n\nDetermine if certain websites or attachment types\n(ex: .scr, .exe, .pif, .cpl, etc.) that can be used for\nphishing are necessary for business operations and\nconsider blocking access if activity cannot be\nmonitored well or if it poses a significant risk.\n\n[M1054 - Software Configuration:](https://attack.mitre.org/mitigations/M1054)\n\nUse anti-spoofing and email authentication\nmechanisms to filter messages based on validity\nchecks of the sender domain (using SPF) and\nintegrity of messages (using DKIM). Enabling these\nmechanisms within an organization (through\npolicies such as DMARC) may enable recipients\n(intra-org and cross domain) to perform similar\nmessage filtering and validation.[3][4]\n\n\n[M1049 -](https://attack.mitre.org/mitigations/M1049)\nAntivirus/Antimalware:\n\nAnti-virus can\nautomatically\nquarantine suspicious\nfiles.\n\n\n-----\n\n[M1017 - User Training:](https://attack.mitre.org/mitigations/M1017)\n\nUsers can be trained to identify social engineering\ntechniques and phishing emails.\n\n[T1078 – Valid Accounts:](https://attack.mitre.org/techniques/T1078/)\n\nAdversaries may obtain and abuse credentials of\nexisting accounts as a means of gaining Initial\nAccess, Persistence, Privilege Escalation, or\nDefense Evasion.\n\n[M1027 - Password Policies:](https://attack.mitre.org/mitigations/M1027)\n\nApplications and appliances that utilize default\nusername and password should be changed\nimmediately after the installation, and before\ndeployment to a production environment. When\npossible, applications that use SSH keys should be\nupdated periodically and properly secured.\n\n[M1026 - Privileged Account Management:](https://attack.mitre.org/mitigations/M1026)\n\nAudit domain and local accounts as well as their\npermission levels routinely to look for situations that\ncould allow an adversary to gain wide access by\nobtaining credentials of a privileged account. These\naudits should also include if default accounts have\nbeen enabled, or if new local accounts are created\nthat have not be authorized. Follow best practices\nfor design and administration of an enterprise\nnetwork to limit privileged account use across\nadministrative tiers.\n\n[M1017 - User Training:](https://attack.mitre.org/mitigations/M1017)\n\nApplications may send push notifications to verify a\nlogin as a form of multi-factor authentication (MFA).\nTrain users to only accept valid push notifications\nand to report suspicious push notifications.\n\n\n[M1013 - Application](https://attack.mitre.org/mitigations/M1013)\nDeveloper Guidance:\n\nEnsure that\napplications do not\nstore sensitive data or\ncredentials insecurely.\n(e.g. plaintext\ncredentials in code,\npublished credentials\nin repositories, or\ncredentials in public\ncloud storage).\n\n\n-----\n\nExecution [T1059.001 –](https://attack.mitre.org/techniques/T1059/001/)\nCommand and\nScripting Interpreter –\nPowerShell:\n\nAdversaries may\nabuse PowerShell\ncommands and\nscripts for execution.\nPowerShell is a\npowerful interactive\ncommand-line\ninterface and scripting\nenvironment included\nin the Windows\noperating system.\n\n[M1045 - Code Signing:](https://attack.mitre.org/mitigations/M1045)\n\nSet PowerShell execution policy to execute only\nsigned scripts.\n\n[M1042 - Disable or Remove Feature or Program:](https://attack.mitre.org/mitigations/M1042)\n\nIt may be possible to remove PowerShell from\nsystems when not needed, but a review should be\nperformed to assess the impact to an environment,\nsince it could be in use for many legitimate\npurposes and administrative functions.\n\nDisable/restrict the WinRM Service to help prevent\nuses of PowerShell for remote execution.\n\n[M1038 - Execution Prevention:](https://attack.mitre.org/mitigations/M1038)\n\nUse application control where appropriate.\n\n[M1026 - Privileged Account Management:](https://attack.mitre.org/mitigations/M1026)\n\nWhen PowerShell is necessary, restrict PowerShell\nexecution policy to administrators. Be aware that\nthere are methods of bypassing the PowerShell\nexecution policy, depending on environment\nconfiguration.\n\n\n[M1049 -](https://attack.mitre.org/mitigations/M1049)\nAntivirus/Antimalware:\n\nAnti-virus can be used\nto automatically\nquarantine suspicious\nfiles.\n\n\n[T1059.003 – Windows Command Shell:](https://attack.mitre.org/techniques/T1059/003/)\n\nAdversaries may abuse the Windows command\nshell for execution. The Windows command shell\n(cmd) is the primary command prompt on Windows\nsystems.\n\n\n[M1038 - Execution](https://attack.mitre.org/mitigations/M1038)\nPrevention:\n\nUse application\ncontrol where\nappropriate.\n\n\n-----\n\n[T1047 – Windows Management Instrumentation:](https://attack.mitre.org/techniques/T1047/)\n\nAdversaries may abuse Windows Management\nInstrumentation (WMI) to execute malicious\ncommands and payloads. WMI is an administration\nfeature that provides a uniform environment to\naccess Windows system components.\n\n[M1038 - Execution Prevention:](https://attack.mitre.org/mitigations/M1038)\n\nUse application control configured to block\nexecution of wmic.exe if it is not required for a\ngiven system or network to prevent potential\nmisuse by adversaries. For example, in Windows\n10 and Windows Server 2016 and above, Windows\nDefender Application Control (WDAC) policy rules\nmay be applied to block the wmic.exe application\nand to prevent abuse.\n\n[M1026 - Privileged Account Management:](https://attack.mitre.org/mitigations/M1026)\n\nPrevent credential overlap across systems of\nadministrator and privileged accounts.\n\n[M1018 - User Account Management:](https://attack.mitre.org/mitigations/M1018)\n\nBy default, only administrators are allowed to\nconnect remotely using WMI. Restrict other users\nwho are allowed to connect, or disallow all users to\nconnect remotely to WMI.\n\n\n[M1040 - Behavior](https://attack.mitre.org/mitigations/M1040)\nPrevention on\nEndpoint:\n\nOn Windows 10,\nenable Attack Surface\nReduction (ASR)\nrules to block\nprocesses created by\nWMI commands from\nrunning. Note: many\nlegitimate tools and\napplications utilize\nWMI for command\nexecution.\n\n\n-----\n\nPersistence [T1547.001 – Boot or](https://attack.mitre.org/techniques/T1547/001/)\nLogon Autostart\nExecution: Registry\nRun Keys / Startup\nFolder:\n\nAdversaries may\nachieve persistence\nby adding a program\nto a startup folder or\nreferencing it with a\nRegistry run key.\nAdding an entry to the\n\"run keys\" in the\nRegistry or startup\nfolder will cause the\nprogram referenced to\nbe executed when a\nuser logs in.\n\n\nThis type of attack\ntechnique cannot be\neasily mitigated with\npreventive controls\nsince it is based on\nthe abuse of system\nfeatures.\n\n\n[T1574.001 – Hijack Execution Flow: DLL Search](https://attack.mitre.org/techniques/T1574/001/)\nOrder Hijacking:\n\nAdversaries may execute their own malicious\npayloads by hijacking the search order used to load\nDLLs. Windows systems use a common method to\nlook for required DLLs to load into a program.\nHijacking DLL loads may be for the purpose of\nestablishing persistence as well as elevating\nprivileges and/or evading restrictions on file\nexecution.\n\n[M1038 - Execution Prevention:](https://attack.mitre.org/mitigations/M1038)\n\nAdversaries may use new DLLs to execute this\ntechnique. Identify and block potentially malicious\nsoftware executed through search order hijacking\nby using application control solutions capable of\nblocking DLLs loaded by legitimate software.\n\n\n[M1047 – Audit:](https://attack.mitre.org/mitigations/M1047)\n\nUse auditing tools\ncapable of detecting\nDLL search order\nhijacking opportunities\non systems within an\nenterprise and correct\nthem. Toolkits like the\nPowerSploit\nframework contain\nPowerUp modules\nthat can be used to\nexplore systems for\nDLL hijacking\nweaknesses.\n\nUse the program\nsxstrace.exe that is\nincluded with\nWindows along with\nmanual inspection to\ncheck manifest files\nfor side-by-side\nproblems in software.\n\n\n-----\n\n[M1044 - Restrict Library Loading:](https://attack.mitre.org/mitigations/M1044)\n\nDisallow loading of remote DLLs. This is included\nby default in Windows Server 2012+ and is\navailable by patch for XP+ and Server 2003+.\n\nEnable Safe DLL Search Mode to force search for\nsystem DLLs in directories with greater restrictions\n(e.g. %SYSTEMROOT%)to be used before local\ndirectory DLLs (e.g. a user's home directory)\n\nThe Safe DLL Search Mode can be enabled via\nGroup Policy at Computer Configuration > [Policies]\n\n- Administrative Templates > MSS (Legacy): MSS:\n(SafeDllSearchMode) Enable Safe DLL search\nmode. The associated Windows Registry key for\nthis is located at\nHKLM\\SYSTEM\\CurrentControlSet\\Control\\Session\nManager\\SafeDLLSearchMode\n\n\n-----\n\nPrivilege Escalation [T1134 – Access](https://attack.mitre.org/techniques/T1134/)\nToken Manipulation:\n\nAdversaries may\nmodify access tokens\nto operate under a\ndifferent user or\nsystem security\ncontext to perform\nactions and bypass\naccess controls.\nWindows uses access\ntokens to determine\nthe ownership of a\nrunning process. A\nuser can manipulate\naccess tokens to\nmake a running\nprocess appear as\nthough it is the child\nof a different process\nor belongs to\nsomeone other than\nthe user that started\nthe process. When\nthis occurs, the\nprocess also takes on\nthe security context\nassociated with the\nnew token.\n\n[M1018 - User Account Management:](https://attack.mitre.org/mitigations/M1018)\n\nAn adversary must already have administrator level\naccess on the local system to make full use of this\ntechnique; be sure to restrict users and accounts to\nthe least privileges they require.\n\n\n[M1026 - Privileged](https://attack.mitre.org/mitigations/M1026)\nAccount\nManagement:\n\nLimit permissions so\nthat users and user\ngroups cannot create\ntokens. This setting\nshould be defined for\nthe local system\naccount only. GPO:\nComputer\nConfiguration >\n\n[Policies] > Windows\nSettings > Security\nSettings > Local\nPolicies > User Rights\nAssignment: Create a\ntoken object. Also\ndefine who can create\na process level token\nto only the local and\nnetwork service\nthrough GPO:\nComputer\nConfiguration >\n\n[Policies] > Windows\nSettings > Security\nSettings > Local\nPolicies > User Rights\nAssignment: Replace\na process level token.\n\nAdministrators should\nlog in as a standard\nuser but run their\ntools with\nadministrator\nprivileges using the\nbuilt-in access token\nmanipulation\ncommand runas.\n\n\n-----\n\n[T1484.001 – Domain Policy Modification: Group](https://attack.mitre.org/techniques/T1484/001/)\nPolicy Modification:\n\nAdversaries may modify Group Policy Objects\n(GPOs) to subvert the intended discretionary\naccess controls for a domain, usually with the\nintention of escalating privileges on the domain.\nGroup policy allows for centralized management of\nuser and computer settings in Active Directory\n(AD).\n\n[M1018 – User Account Management:](https://attack.mitre.org/mitigations/M1018)\n\nConsider implementing WMI and security filtering to\nfurther tailor which users and computers a GPO will\napply to.\n\n[T1548.002 - Abuse Elevation Control Mechanism:](https://attack.mitre.org/techniques/T1548/002/)\nBypass User Account Control:\n\nAdversaries may bypass UAC mechanisms to\nelevate process privileges on system. Windows\nUser Account Control (UAC) allows a program to\nelevate its privileges (tracked as integrity levels\nranging from low to high) to perform a task under\nadministrator-level permissions, possibly by\nprompting the user for confirmation.\n\n[M1026 - Privileged Account Management:](https://attack.mitre.org/mitigations/M1026)\n\nRemove users from the local administrator group\non systems.\n\n[M1051 – Update Software:](https://attack.mitre.org/mitigations/M1051)\n\nConsider updating Windows to the latest version\nand patch level to utilize the latest protective\nmeasures against UAC bypass.\n\n[M1052 - User Account Control:](https://attack.mitre.org/mitigations/M1052)\n\nAlthough UAC bypass techniques exist, it is still\nprudent to use the highest enforcement level for\nUAC when possible and mitigate bypass\nopportunities that exist with techniques such as\nDLL Search Order Hijacking.\n\n\n[M1047 – Audit:](https://attack.mitre.org/mitigations/M1047)\n\nIdentify and correct\nGPO permissions\nabuse opportunities\n(ex: GPO modification\nprivileges) using\nauditing tools such as\nBloodHound (version\n1.5.1 and later).\n\n[M1047 – Audit:](https://attack.mitre.org/mitigations/M1047)\n\nCheck for common\nUAC bypass\nweaknesses on\nWindows systems to\nbe aware of the risk\nposture and address\nissues where\nappropriate.\n\n\n-----\n\nDefense Evasion [T1484.001 – Domain](https://attack.mitre.org/techniques/T1484/001/)\nPolicy Modification:\nGroup Policy\nModification:\n\nAdversaries may\nmodify Group Policy\nObjects (GPOs) to\nsubvert the intended\ndiscretionary access\ncontrols for a domain,\nusually with the\nintention of escalating\nprivileges on the\ndomain. Group policy\nallows for centralized\nmanagement of user\nand computer settings\nin Active Directory\n(AD).\n\n[M1018 – User Account Management:](https://attack.mitre.org/mitigations/M1018)\n\nConsider implementing WMI and security filtering to\nfurther tailor which users and computers a GPO will\napply to.\n\n\n[M1047 – Audit:](https://attack.mitre.org/mitigations/M1047)\n\nIdentify and correct\nGPO permissions\nabuse opportunities\n(ex: GPO modification\nprivileges) using\nauditing tools such as\nBloodHound (version\n1.5.1 and later).\n\n\n[T1027.002 – Obfuscated Files or Information:](https://attack.mitre.org/techniques/T1027/002/)\nSoftware Packing:\n\nAdversaries may perform software packing or\nvirtual machine software protection to conceal their\ncode. Software packing is a method of\ncompressing or encrypting an executable. Packing\nan executable changes the file signature in an\nattempt to avoid signature-based detection. Most\ndecompression techniques decompress the\nexecutable code in memory.\n\n\n[M1049 -](https://attack.mitre.org/mitigations/M1049)\nAntivirus/Antimalware:\n\nEmploy heuristicbased malware\ndetection. Ensure\nupdated virus\ndefinitions and create\ncustom signatures for\nobserved malware.\n\n\n-----\n\n[T1550 – Use Alternate Authentication Material:](https://attack.mitre.org/techniques/T1550/)\n\nAdversaries may use alternate authentication\nmaterial, such as password hashes, Kerberos\ntickets, and application access tokens, in order to\nmove laterally within an environment and bypass\nnormal system access controls.\n\n[M1018 - User Account Management:](https://attack.mitre.org/mitigations/M1018)\n\nEnforce the principle of least-privilege. Do not allow\na domain user to be in the local administrator group\non multiple systems.\n\n\n[M1026 - Privileged](https://attack.mitre.org/mitigations/M1026)\nAccount\nManagement:\n\nLimit credential\noverlap across\nsystems to prevent\nthe damage of\ncredential\ncompromise and\nreduce the\nadversary's ability to\nperform Lateral\nMovement between\nsystems.\n\n\nCredential Access [T1555 – Credentials](https://attack.mitre.org/techniques/T1555/)\nfrom Password\nStores:\n\nAdversaries may\nsearch for common\npassword storage\nlocations to obtain\nuser credentials.\nPasswords are stored\nin several places on a\nsystem, depending on\nthe operating system\nor application holding\nthe credentials. There\nare also specific\napplications that store\npasswords to make it\neasier for users\nmanage and maintain.\nOnce credentials are\nobtained, they can be\nused to perform\nlateral movement and\naccess restricted\ninformation.\n\n\n[M1027 - Password](https://attack.mitre.org/mitigations/M1027)\nPolicies:\n\nThe password for the\nuser's login keychain\ncan be changed from\nthe user's login\npassword. This\nincreases the\ncomplexity for an\nadversary because\nthey need to know an\nadditional password.\n\nOrganizations may\nconsider weighing the\nrisk of storing\ncredentials in\npassword stores and\nweb browsers. If\nsystem, software, or\nweb browser\ncredential disclosure\nis a significant\nconcern, technical\ncontrols, policy, and\nuser training may be\nused to prevent\nstorage of credentials\nin improper locations.\n\n\n-----\n\n[T1003.005 – OS Credential Dumping: Cached](https://attack.mitre.org/techniques/T1003/005/)\nDomain Credentials:\n\nAdversaries may attempt to access cached domain\ncredentials used to allow authentication to occur in\nthe event a domain controller is unavailable.\n\n[M1028 - Operating System Configuration:](https://attack.mitre.org/mitigations/M1028)\n\nConsider limiting the number of cached credentials\n(HKLM\\SOFTWARE\\Microsoft\\Windows\nNT\\Current\nVersion\\Winlogon\\cachedlogonscountvalue)\n\n[M1027 - Password Policies:](https://attack.mitre.org/mitigations/M1027)\n\nEnsure that local administrator accounts have\ncomplex, unique passwords across all systems on\nthe network.\n\n[M1026 - Privileged Account Management:](https://attack.mitre.org/mitigations/M1026)\n\nDo not put user or admin domain accounts in the\nlocal administrator groups across systems unless\nthey are tightly controlled, as this is often\nequivalent to having a local administrator account\nwith the same password on all systems. Follow\nbest practices for design and administration of an\nenterprise network to limit privileged account use\nacross administrative tiers.\n\n[M1017 - User Training:](https://attack.mitre.org/mitigations/M1017)\n\nLimit credential overlap across accounts and\nsystems by training users and administrators not to\nuse the same password for multiple accounts.\n\n\n[M1015 - Active](https://attack.mitre.org/mitigations/M1015)\nDirectory\nConfiguration:\n\nConsider adding\nusers to the\n\"Protected Users\"\nActive Directory\nsecurity group. This\ncan help limit the\ncaching of users'\nplaintext credentials.\n\n\n-----\n\nLateral Movement [T1021.001 – Remote](https://attack.mitre.org/techniques/T1021/001/)\nServices – Remote\nDesktop Protocol:\n\nAdversaries may use\nValid Accounts to log\ninto a computer using\nthe Remote Desktop\nProtocol (RDP). The\nadversary may then\nperform actions as the\nlogged-on user.\n\n[M1042 - Disable or Remove Feature or Program:](https://attack.mitre.org/mitigations/M1042)\n\nDisable the RDP service if it is unnecessary.\n\n[M1035 - Limit Access to Resource Over Network:](https://attack.mitre.org/mitigations/M1035)\n\nUse remote desktop gateways.\n\n[M1032 - Multi-factor Authentication:](https://attack.mitre.org/mitigations/M1032)\n\nUse multi-factor authentication for remote logins.\n\n[M1030 - Network Segmentation:](https://attack.mitre.org/mitigations/M1030)\n\nDo not leave RDP accessible from the internet.\nEnable firewall rules to block RDP traffic between\nnetwork security zones within a network.\n\n[M1028 - Operating System Configuration:](https://attack.mitre.org/mitigations/M1028)\n\nChange GPOs to define shorter timeouts sessions\nand maximum amount of time any single session\ncan be active. Change GPOs to specify the\nmaximum amount of time that a disconnected\nsession stays active on the RD session host server.\n\n[M1026 - Privileged Account Management:](https://attack.mitre.org/mitigations/M1026)\n\nConsider removing the local Administrators group\nfrom the list of groups allowed to log in through\nRDP.\n\n[M1018 - User Account Management:](https://attack.mitre.org/mitigations/M1018)\n\nLimit remote user permissions if remote access is\nnecessary.\n\n\n[M1047 - Audit:](https://attack.mitre.org/mitigations/M1047)\n\nAudit the Remote\nDesktop Users group\nmembership regularly.\nRemove unnecessary\naccounts and groups\nfrom Remote Desktop\nUsers groups.\n\n\n-----\n\n[T1570 – Lateral Tool Transfer:](https://attack.mitre.org/techniques/T1570/)\n\nAdversaries may transfer tools or other files\nbetween systems in a compromised environment.\nFiles may be copied from one system to another to\nstage adversary tools or other files over the course\nof an operation.\n\n[M1031 - Network Intrusion Prevention:](https://attack.mitre.org/mitigations/M1031)\n\nNetwork intrusion detection and prevention\nsystems that use network signatures to identify\ntraffic for specific adversary malware or unusual\ndata transfer over known tools and protocols like\nFTP can be used to mitigate activity at the network\nlevel. Signatures are often for unique indicators\nwithin protocols and may be based on the specific\nobfuscation technique used by a particular\nadversary or tool, and will likely be different across\nvarious malware families and versions.\n\n[T1080 – Taint Shared Content:](https://attack.mitre.org/techniques/T1080/)\n\nAdversaries may deliver payloads to remote\nsystems by adding content to shared storage\nlocations, such as network drives or internal code\nrepositories. Content stored on network drives or in\nother shared locations may be tainted by adding\nmalicious programs, scripts, or exploit code to\notherwise valid files.\n\n[M1050 - Exploit Protection:](https://attack.mitre.org/mitigations/M1050)\n\nUse utilities that detect or mitigate common\nfeatures used in exploitation, such as the Microsoft\nEnhanced Mitigation Experience Toolkit (EMET).\n\n[M1022 - Restrict File and Directory Permissions:](https://attack.mitre.org/mitigations/M1022)\n\nProtect shared folders by minimizing users who\nhave write access.\n\n\n[M1037 - Filter](https://attack.mitre.org/mitigations/M1037)\nNetwork Traffic:\n\nConsider using the\nhost firewall to restrict\nfile sharing\ncommunications such\nas SMB.\n\n[M1038 - Execution](https://attack.mitre.org/mitigations/M1038)\nPrevention:\n\nIdentify potentially\nmalicious software\nthat may be used to\ntaint content or may\nresult from it and audit\nand/or block the\nunknown programs by\nusing application\ncontrol tools, like\nAppLocker, or\nSoftware Restriction\nPolicies where\nappropriate.\n\n\n-----\n\nExfiltration [T1041 – Exfiltration](https://attack.mitre.org/techniques/T1041/)\nOver C2 Channel:\n\nAdversaries may steal\ndata by exfiltrating it\nover an existing\ncommand and control\nchannel. Stolen data\nis encoded into the\nnormal\ncommunications\nchannel using the\nsame protocol as\ncommand and control\ncommunications.\n\n[M1031 - Network Intrusion Prevention:](https://attack.mitre.org/mitigations/M1031)\n\nNetwork intrusion detection and prevention\nsystems that use network signatures to identify\ntraffic for specific adversary malware can be used\nto mitigate activity at the network level. Signatures\nare often for unique indicators within protocols and\nmay be based on the specific obfuscation\ntechnique used by a particular adversary or tool,\nand will likely be different across various malware\nfamilies and versions. Adversaries will likely\nchange tool command and control signatures over\ntime or construct protocols in such a way to avoid\ndetection by common defensive tools.\n\n\n[M1057 - Data Loss](https://attack.mitre.org/mitigations/M1057)\nPrevention:\n\nData loss prevention\ncan detect and block\nsensitive data being\nsent over unencrypted\nprotocols.\n\n\n[T1567.002 – Exfiltration Over Web Service:](https://attack.mitre.org/techniques/T1567/002/)\nExfiltration to Cloud Storage:\n\nAdversaries may exfiltrate data to a cloud storage\nservice rather than over their primary command\nand control channel. Cloud storage services allow\nfor the storage, edit, and retrieval of data from a\nremote cloud storage server over the Internet.\n\n\n[M1021 - Restrict](https://attack.mitre.org/mitigations/M1021)\nWeb-Based Content:\n\nWeb proxies can be\nused to enforce an\nexternal network\ncommunication policy\nthat prevents use of\nunauthorized external\nservices.\n\n\n-----\n\nImpact [T1486 - Data](https://attack.mitre.org/techniques/T1486/)\nEncrypted for Impact:\n\nAdversaries may\nencrypt data on target\nsystems or on large\nnumbers of systems\nin a network to\ninterrupt availability to\nsystem and network\nresources. They can\nattempt to render\nstored data\ninaccessible by\nencrypting files or\ndata on local and\nremote drives and\nwithholding access to\na decryption key.\n\n[M1053 - Data Backup: Consider implementing IT](https://attack.mitre.org/mitigations/M1053)\ndisaster recovery plans that contain procedures for\nregularly taking and testing data backups that can\nbe used to restore organizational data. Ensure\nbackups are stored off system and is protected\nfrom common methods adversaries may use to\ngain access and destroy the backups to prevent\nrecovery. Consider enabling versioning in cloud\nenvironments to maintain backup copies of storage\nobjects.\n\n\n[M1040 - Behavior](https://attack.mitre.org/mitigations/M1040)\nPrevention on\nEndpoint: On\nWindows 10, enable\ncloud-delivered\nprotection and Attack\nSurface Reduction\n(ASR) rules to block\nthe execution of files\nthat resemble\nransomware.\n\n\n[T1490 - Inhabit System Recovery:](https://attack.mitre.org/techniques/T1490/)\n\nAdversaries may delete or remove built-in\noperating system data and turn off services\ndesigned to aid in the recovery of a corrupted\nsystem to prevent recovery. Operating systems\nmay contain features that can help fix corrupted\nsystems, such as a backup catalog, volume\nshadow copies, and automatic repair features.\nAdversaries may disable or delete system recovery\nfeatures to augment the effects of Data Destruction\nand Data Encrypted for Impact.\n\n\n[M1053 - Data](https://attack.mitre.org/mitigations/M1053)\nBackup: Consider\nimplementing IT\ndisaster recovery\nplans that contain\nprocedures for taking\nregular data backups\nthat can be used to\nrestore organizational\ndata. Ensure backups\nare stored off system\nand is protected from\ncommon methods\nadversaries may use\nto gain access and\ndestroy the backups\nto prevent recovery.\n\n\n-----\n\n[M1028 - Operating System Configuration: Consider](https://attack.mitre.org/mitigations/M1028)\ntechnical controls to prevent the disabling of\nservices or deletion of files involved in system\nrecovery.\n\n[T1489 - Service Stop:](https://attack.mitre.org/techniques/T1489/)\n\nAdversaries may stop or disable services on a\nsystem to render those services unavailable to\nlegitimate users. Stopping critical services or\nprocesses can inhibit or stop response to an\nincident or aid in the adversary's overall objectives\nto cause damage to the environment.\n\n[M1022 - Restrict File and Directory Permissions:](https://attack.mitre.org/mitigations/M1022)\nEnsure proper process and file permissions are in\nplace to inhibit adversaries from disabling or\ninterfering with critical services.\n\n[M1024 - Restrict Registry Permissions: Ensure](https://attack.mitre.org/mitigations/M1024)\nproper registry permissions are in place to inhibit\nadversaries from disabling or interfering with critical\nservices.\n\n[M1018 - User Account Management: Limit](https://attack.mitre.org/mitigations/M1018)\nprivileges of user accounts and groups so that only\nauthorized administrators can interact with service\nchanges and service configurations.\n\n\n[M1030 - Network](https://attack.mitre.org/mitigations/M1030)\nSegmentation:\nOperate intrusion\ndetection, analysis,\nand response\nsystems on a\nseparate network\nfrom the production\nenvironment to lessen\nthe chances that an\nadversary can see\nand interfere with\ncritical response\nfunctions.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-04-12 - Threat Profile- LockBit.pdf"
    ],
    "report_names": [
        "2022-04-12 - Threat Profile- LockBit.pdf"
    ],
    "threat_actors": [
        {
            "id": "aa73cd6a-868c-4ae4-a5b2-7cb2c5ad1e9d",
            "created_at": "2022-10-25T16:07:24.139848Z",
            "updated_at": "2025-03-27T02:02:10.120505Z",
            "deleted_at": null,
            "main_name": "Safe",
            "aliases": [],
            "source_name": "ETDA:Safe",
            "tools": [
                "DebugView",
                "LZ77",
                "OpenDoc",
                "SafeDisk",
                "TypeConfig",
                "UPXShell",
                "UsbDoc",
                "UsbExe"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535836,
    "ts_updated_at": 1743041370,
    "ts_creation_date": 1653692463,
    "ts_modification_date": 1653692463,
    "files": {
        "pdf": "https://archive.orkl.eu/e9e751fd5ea6ebf819ad17fbc7ad6247ca6c4ac0.pdf",
        "text": "https://archive.orkl.eu/e9e751fd5ea6ebf819ad17fbc7ad6247ca6c4ac0.txt",
        "img": "https://archive.orkl.eu/e9e751fd5ea6ebf819ad17fbc7ad6247ca6c4ac0.jpg"
    }
}