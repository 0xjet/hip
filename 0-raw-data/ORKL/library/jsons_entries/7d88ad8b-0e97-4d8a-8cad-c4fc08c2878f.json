{
    "id": "7d88ad8b-0e97-4d8a-8cad-c4fc08c2878f",
    "created_at": "2023-01-12T15:03:46.15128Z",
    "updated_at": "2025-03-27T02:13:08.20168Z",
    "deleted_at": null,
    "sha1_hash": "600c2945cae9822ef3b7806eae64ca02d15fb825",
    "title": "2021-09-13 - BazarLoader to Conti Ransomware in 32 Hours",
    "authors": "",
    "file_creation_date": "2022-05-28T18:04:19Z",
    "file_modification_date": "2022-05-28T18:04:19Z",
    "file_size": 1225431,
    "plain_text": "# BazarLoader to Conti Ransomware in 32 Hours\n\n**[thedfirreport.com/2021/09/13/bazarloader-to-conti-ransomware-in-32-hours/](https://thedfirreport.com/2021/09/13/bazarloader-to-conti-ransomware-in-32-hours/)**\n\n## Intro\n\n\nSeptember 13, 2021\n\n\nConti is a top player in the ransomware ecosystem, being listed as 2nd overall in the Q2 2021\n[Coveware ransomware report. The groups deploying this RaaS have only grown more prevalent.](https://twitter.com/AltShiftPrtScn/status/1431423623621918727?s=20)\nDespite the group having it’s affiliate guide leaked, which revealed many techniques already\n[covered in previous reports, the group’s using the ransomware are unlikely to let up any time soon.](https://thedfirreport.com/2021/08/01/bazarcall-to-conti-ransomware-via-trickbot-and-cobalt-strike/)\n\nIn July we witnessed a BazarLoader campaign that deployed Cobalt Strike and ended with domain\nwide encryption using Conti ransomware.\n\n## Case Summary\n\nBazarLoader has continued to be one of the preeminent initial access brokers for ransomware\nthreat actor access. For this intrusion we don’t know the initial campaign that deployed the malware\nbut based on previous information, we can assess with high confidence that the delivery vector was\n[a malicious email campaign. At the time of the intrusion, the group was favoring zip attachments](https://twitter.com/malware_traffic/status/1412470165179092992)\nwith malicious javascript files to download the BazarLoader malware. However BazarLoader has\n[also been used with Word and](https://twitter.com/James_inthe_box/status/1422191753218576392?s=20) [Excel documents as well.](https://thedfirreport.com/2021/03/08/bazar-drops-the-anchor/)\n\nIn this case we observed the initial activity beginning with a BazarLoader DLL. Upon initial\nexecution on the beachhead, the malware made an initial connection to command and control, and\nthen a few minutes later it performed discovery tasks on the host using Microsoft utilities like Net\n\n\n-----\n\nand Nltest to discover the domain and users of interest. like domain administrators. After this\nactivity, the host went quiet for about one hour before downloading and executing a Cobalt Strike\nbeacon DLL.\n\nThe threat actors used Cobalt Strike to run additional discovery tasks using Microsoft utilities like\nnet, ping, systeminfo, and taskmanager. The threat actors then began using pass the hash with\nvarious accounts which continued several times throughout the intrusion. To see what machines\nwere active in the environment, the threat actors scanned the network for SMB.\n\nAround two and a half hours into the intrusion the threat actors began lateral movement. Lateral\nmovement began by the threat actor transferring an executable to a remote system and then\nexecuting it using wmic. This was the primary lateral movement option favored by the threat actor,\nhowever PowerShell Cobalt Strike beacons, service executable Cobalt Strike beacons, and RDP\nwere all used, but less commonly. Once on remote systems the threat actor used Cobalt Strike to\ndump lsass memory for further credentials.\n\nAfter this phase completed, the threat actor’s activity faded but the Cobalt Strike continued to\nbeacon out to the C2 server. About 12 hours later the threat actors became active again. From the\ndomain controller the threat actors continued further lateral movement to more servers in the\nenvironment. They also continued further discovery activity running PowerShell scripts to discover\nthe disk utilization of hosts, review user last login time per host, assess the installed anti-virus\nsoftware, and track which hosts were online for the threat actors to target.\n\nWhen the threat actors identified the file server, their method for data exfiltration was\nstraightforward to a fault. They downloaded WinSCP from the project website, installed it on the file\nserver and proceeded to exfiltrate data from the server using SCP to a VPS host they controlled in\nRomania.\n\nAround 31 hours after initial access to the environment, the threat actors felt they were ready to\ncomplete their final objectives. RDP activity was seen from several hosts and an executable named\ntest.exe was transferred to several endpoints. This test file was the Conti ransomware executable,\nand the threat actors decided to test in a controlled manner before running the full domain\nransomware deployment. Like before, these “unit tests,” were performed using wmic to execute the\nfiles remotely on the endpoints.\n\nThe threat actors must have confirmed quickly that their tests were successful as within minutes\nthey dropped test.exe renamed to backup.exe on two servers in the environment and executed\nmanually via their RDP sessions. When executed in this manner the ransomware mounts all remote\nC$ drives in the local network and proceeds to encrypt the contents over the SMB connection. At\nthis point, the Time to Ransom (TTR) for the threat actors was just shy of 32 hours since initial\naccess.\n\n## Services\n\n[We offer multiple services including a Threat Feed service which tracks Command and Control](https://thedfirreport.com/services/)\nframeworks such as Cobalt Strike, Metasploit, Empire, PoshC2, BazarLoader, etc. More information\n[on this service and others can be found here. The Cobalt Strike server used in this intrusion was](https://thedfirreport.com/services/)\n\n\n-----\n\n[added to our Threat Feed on 07/01/2021.](https://thedfirreport.com/services/)\n\nWe also have artifacts and IOCs available from this case such as pcaps, memory captures, files,\nevent logs including Sysmon, Kape packages, and more, under our Security Researcher and\nOrganization services.\n\n## Timeline\n\n\n-----\n\n[Analysis and reporting completed by @ICSNick and](https://twitter.com/IcsNick) [@MetallicHack](https://twitter.com/MetallicHack)\n\n[Reviewed by @V3T0_ and](https://twitter.com/v3t0_) [@THIR_Sec](https://twitter.com/THIR_Sec)\n\n## MITRE ATT&CK\n\n\n-----\n\n## Initial Access\n\nIn this case we did not observe the initial delivery for the malware. BazarLoader however tends to\narrive in an environment via malicious email campaigns and in a few cases its been reported via\n[call centers social engineering users to load the malware. Seeing that this starts with a DLL file it is](https://unit42.paloaltonetworks.com/bazarloader-malware/)\n[more likely that this was related to an email campaign using malicious zipped Javascript files.](https://twitter.com/malware_traffic/status/1412470165179092992)\n\n## Execution\n\n[Initial execution occurred via the Bazarloader DLL being executed by rundll32.](https://bazaar.abuse.ch/sample/24f692b4ee982a145abf12c5c99079cfbc39e40bd64a3c07defaf36c7f75c7a9/)\n\nAbout an hour after the initial execution on the beachhead, a Cobalt Strike beacon was executed\nalso with rundll32.\n\n## Privilege Escalation\n\nThe threat actors made use of pass the hash techniques to try to escalate privileges during the\nintrusion. Various accounts were targeted including a Guest account initially.\n\n\n-----\n\n```\n An account was successfully logged on.\nSubject:\n Security ID:  S-1-5-21-********\n Account Name:  USER\n Account Domain:  DOMAIN\n Logon ID:  0x1296D94\nLogon Information:\n Logon Type:  9\n Restricted Admin Mode:  Virtual Account:  No\n Elevated Token:  No\nImpersonation Level:  Impersonation\nNew Logon:\n Security ID:  S-1-5-21-*******\n Account Name:  USER\n Account Domain:  DOMAIN\n Logon ID:  0x173D205\n Linked Logon ID:  0x0\n Network Account Name: Guest\n Network Account Domain: .\n Logon GUID:  {00000000-0000-0000-0000-000000000000}\nProcess Information:\n Process ID:  0x68c\n Process Name:  C:\\Windows\\System32\\svchost.exe\nNetwork Information:\n Workstation Name:  Source Network Address: ::1\n Source Port:  0\nDetailed Authentication Information:\n Logon Process:  seclogo\n Authentication Package: Negotiate\n Transited Services:  Package Name (NTLM only):  Key Length:  0\n\n```\nProcess injection was seen from the Cobalt Strike beacon into a svchost process running with\nSystem level privilege.\n\n\n-----\n\n```\n CreateRemoteThread detected:\nRuleName: technique_id=T1055,technique_name=Process Injection\nUtcTime: ***\nSourceProcessGuid: {1227cce3-2e6a-60de-f909-000000000700}\nSourceProcessId: 8924\nSourceImage: C:\\Windows\\System32\\rundll32.exe\nTargetProcessGuid: {1227cce3-2032-60de-5c08-000000000700}\nTargetProcessId: 6192\nTargetImage: C:\\Windows\\System32\\svchost.exe\nNewThreadId: 8916\nStartAddress: 0x00000243EFCA0002\nStartModule: StartFunction: -\"\n\n## Defense Evasion\n\n```\nWhile in the environment they injected Cobalt Strike beacons into many processes.\n\n**Processes with CS beacon injected or running**\n\n.Pid .ProcessName .CommandLine\n\n4076 svchost.exe C:\\Windows\\system32\\svchost.exe -k UnistackSvcGroup\n\n2428 taskhostw.exe taskhostw.exe {222A245B-E637-4AE9-A93F-A59CA119A75E}\n\n576 winlogon.exe winlogon.exe\n\n560 winlogon.exe winlogon.exe\n\n4024 taskhostw.exe taskhostw.exe {222A245B-E637-4AE9-A93F-A59CA119A75E}\n\n3408 explorer.exe C:\\Windows\\Explorer.EXE\n\n560 winlogon.exe winlogon.exe\n\n2340 explorer.exe C:\\Windows\\Explorer.EXE\n\n4156 dllhost.exe C:\\Windows\\syswow64\\dllhost.exe\n\n4240 cmd.exe C:\\Windows\\system32\\cmd.exe /C time\n\n4216 winlogon.exe winlogon.exe\n\n2516 taskhostw.exe taskhostw.exe {222A245B-E637-4AE9-A93F-A59CA119A75E}\n\n1828 explorer.exe C:\\Windows\\Explorer.EXE\n\n5128 dllhost.exe C:\\Windows\\syswow64\\dllhost.exe\n\n3208 taskhostw.exe taskhostw.exe {222A245B-E637-4AE9-A93F-A59CA119A75E}\n\n6192 svchost.exe C:\\Windows\\system32\\svchost.exe -k UnistackSvcGroup -s\nWpnUserService\n\n8400 explorer.exe C:\\Windows\\Explorer.EXE\n\n\n-----\n\n3796 SecurityHealthSystray.exe “C:\\Windows\\System32\\SecurityHealthSystray.exe”\n\n8924 rundll32.exe rundll32.exe\nC:\\Users\\USER\\AppData\\Local\\Temp\\7A86.dll,DllRegisterServer\n\n5284 dllhost.exe C:\\Windows\\system32\\dllhost.exe\n\n504 svchost.exe C:\\Windows\\system32\\svchost.exe -k UnistackSvcGroup\n\n3252 taskhostw.exe taskhostw.exe {222A245B-E637-4AE9-A93F-A59CA119A75E}\n\n656 winlogon.exe winlogon.exe\n\n5656 explorer.exe C:\\Windows\\Explorer.EXE\n\n5964 svchost.exe C:\\Windows\\system32\\svchost.exe -k ClipboardSvcGroup -p -s\ncbdhsvc\n\n## Credential Access\n\nThe threat actors were seen dumping credentials out of lsass memory across the domain.\n\n## Discovery\n\nThe BazarLoader malware on the beachhead began discovery actions around 20 minutes after the\ninitial execution. The discovery commands utilize the familiar built in Microsoft utilities.\n```\nnltest /domain_trusts /all_trusts\nnet localgroup \"administrator\"\nnet group \"domain admins\" /dom\nC:\\Windows\\system32\\net1 group \"domain admins\" /dom\n\n```\nThe Cobalt Strike beacon ran additional discovery tasks on the beachhead. Again built in Microsoft\nutilities were utilized.\n\n\n-----\n\n```\nC:\\Windows\\system32\\cmd.exe /C systeminfo\nC:\\Windows\\system32\\cmd.exe /C ping DOMAINCONTROLLER\nC:\\Windows\\system32\\cmd.exe /C ping ENDPOINT\nC:\\Windows\\system32\\cmd.exe /C net localgroup Administrators\nC:\\Windows\\System32\\Taskmgr.exe\n\n```\nThroughout the intrusion the threat actor checked the time of systems with:\n```\nC:\\Windows\\system32\\cmd.exe /C time\n\n```\nFrom an svchost process injected with a Cobalt Strike beacon, SMB scanning was performed\nacross the environment.\n\nFrom the domain controller the threat actor ran an encoded PowerShell command to review the\nsize and condition of hard drives across the environment.\n```\nC:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe\npowershell -nop -exec bypass -EncodedCommand\nSQBFAFgAIAAoAE4AZQB3AC0ATwBiAGoAZQBjAHQAIABOAGUAdAAuAFcAZQBiAGMAbABpAGUAbgB0ACkALgBEAG8AdwBu\n\n```\nDecoded:\n```\nIEX (New-Object Net.Webclient).DownloadString('http://127.0.0.1:33242/'); Get-WmiObject Class win32_logicalDisk -ComputerName SYSTEMNAME | Select-Object pscomputername, Name,\n@{n=\"Space\";e={[math]::Round($_.Size/1GB,2)}}, @{n=\"FreeSpace\";e=\n{[math]::Round($_.FreeSpace/1GB,2)}}, @{n=\"BUSY\";e=\n{[math]::Round(($_.Size-$_.FreeSpace)/1GB,2)}}\n\n```\nPowersploit modules like Get-NetComputer were seen used by the threat actor from the domain\ncontroller\n```\nIEX (New-Object Net.Webclient).DownloadString('http://127.0.0.1:36595/'); Get-NetComputer ping -operatingsystem *server*\n\n```\n[The script Get-DataInfo.ps1, which has been used in many intrusions this past year, was also](https://thedfirreport.com/?s=get-datainfo)\nemployed. This file was started by the use of start.bat, which has been seen paired with this script\nrepeatedly.\n```\nC:\\Windows\\system32\\cmd.exe /c \"C:\\\\Users\\\\info\\\\start.bat\"\n\n```\n\n-----\n\n```\npowershell.exe -executionpolicy remotesigned -File .\\Get-DataInfo.ps1 method\n\n```\nThe contents of Get-DataInfo.ps1 provide the threat actor with very specific details of the\nenvironment. This includes things like disk size, connectivity, antivirus software, and backup\nsoftware.\n\nThis script was first reported used by threat actors deploying the Ryuk ransomware strain.\n\nThe Microsoft Active Directory PowerShell module was also imported and used for discovery tasks.\n```\nGet-ADComputer -Filter {enabled -eq $true} -properties *|select Name, DNSHostName,\nOperatingSystem, LastLogonDate | Export-CSV C:\\Users\\AllWindows.csv -NoTypeInformation Encoding UTF8\n\n## Lateral Movement\n\n```\nFor lateral movement the threat actors relied heavily on copying executable files over SMB and\nthen executing them via remote WMIC calls\n```\nC:\\Windows\\system32\\cmd exe /C wmic /node:\"DOMAINCONTROLLER\" process call create \"C:\\3 exe\"\n\n```\n\n-----\n\nWhile executables and wmic were the preferred options for the threat actor, they did employ several\nother techniques.\n\nRemote Cobalt Strike beacons were started with services and PowerShell several times in the\nenvironment.\n\nDuring the final stages the threat actor used RDP to move between a few servers as part of their\nfinal actions.\n\nAt that time, a Cobalt Strike beacon executable was executed as a service on a remote host for\ntesting the final ransom deployment.\n\n## Command and Control\n\nBazarLoader:\n\n34.219.130.241:443\n```\nJA3: 72a589da586844d7f0818ce684948eea\nJA3s: e35df3e00ca4ef31d42b34bebaa2f86e\nCertificate: [ff:5f:80:d9:5b:9b:b1:d7:2e:49:c7:96:87:8e:7d:76:6e:67:e3:94 ]\nNot Before: 2021/06/28 07:41:39 UTC \nNot After 2022/06/28 07:41:39 UTC \nIssuer Org NN Fern \nSubject Common forenzik.kz \nSubject Org NN Fern \nPublic Algorithm rsaEncryption\n\n```\n13.56.161.214:443\n```\nJA3: 72a589da586844d7f0818ce684948eea\nJA3s: e35df3e00ca4ef31d42b34bebaa2f86e\nCertificate:[d9:80:5b:d4:7a:40:21:54:ec:10:49:d4:ee:38:57:e2:2b:b8:25:f2]\nNot Before: 2021/06/28 07:54:14 UTC \nNot After: 2022/06/28 07:54:14 UTC \nIssuer Org: NN Fern \nSubject Common: forenzik.kz \nSubject Org: NN Fern \nPublic Algorithm: rsaEncryption\n\n```\nCobalt Strike:\n\n\n-----\n\n[sammitng.com (162.244.83.216) – This Cobalt Strike server was added to our Threat Feed on](https://thedfirreport.com/services/)\n07/01/2021.\n\nThis server was seen communicating with multiple internal systems:\n```\nJA3: a0e9f5d64349fb13191bc781f81f42e1\nJA3s: ae4edc6faf64d08308082ad26be60767\n\n```\n\n-----\n\n```\nCertificate: [07:6f:84:54:eb:a9:26:a6:c8:4b:fd:e8:0e:95:e0:a6:62:b2:01:ae]\nNot Before: 2021/06/25 05:11:41 UTC \nNot After: 2021/09/23 05:11:40 UTC \nIssuer Org: Let's Encrypt \nSubject Common: sammitng.com [sammitng.com,www.sammitng.com ]\nPublic Algorithm: rsaEncryption\n\n```\n\n-----\n\n```\n{\n \"x86\": {\n  \"sha1\": \"6a31edc3e73957bb25e51abfd4efb4fd5eb51dbc\",\n  \"time\": 1625176656098.3,\n  \"md5\": \"29154f55df2171ccfe6316a77496d451\",\n  \"sha256\": \"c867fbc963c6975918f6744e196e0cc648777c7252ca740254e6eed9918c6fd1\",\n  \"config\": {\n   \"Spawn To x86\": \"%windir%\\\\syswow64\\\\dllhost.exe\",\n   \"Polling\": 5000,\n   \"Port\": 80,\n   \"Jitter\": 10,\n   \"HTTP Method Path 2\": \"/jquery-3.3.2.min.js\",\n   \"Method 2\": \"POST\",\n   \"C2 Server\": \"162.244.83.216,/jquery-3.3.1.min.js\",\n   \"Method 1\": \"GET\",\n   \"Beacon Type\": \"0 (HTTP)\",\n   \"Spawn To x64\": \"%windir%\\\\sysnative\\\\dllhost.exe\"\n  }\n },\n \"x64\": {\n  \"sha1\": \"856366815cac27775b944a236ad3a6f523a4136d\",\n  \"time\": 1625176667352.5,\n  \"md5\": \"b656845e2755920db24364b42ce2ea18\",\n  \"sha256\": \"5c649554d9ea77e98dbf0df0d4010255075c6c5324fc7526c667a180c06a050a\",\n  \"config\": {\n   \"Spawn To x86\": \"%windir%\\\\syswow64\\\\dllhost.exe\",\n   \"Polling\": 5000,\n   \"Port\": 80,\n   \"Jitter\": 10,\n   \"HTTP Method Path 2\": \"/jquery-3.3.2.min.js\",\n   \"Method 2\": \"POST\",\n   \"C2 Server\": \"162.244.83.216,/jquery-3.3.1.min.js\",\n   \"Method 1\": \"GET\",\n   \"Beacon Type\": \"0 (HTTP)\",\n   \"Spawn To x64\": \"%windir%\\\\sysnative\\\\dllhost.exe\"\n  }\n }\n}\n{\n \"x86\": {\n  \"sha1\": \"c07dbec39149a3bb20a54b9eeb2e453a7c5bdd2f\",\n  \"time\": 1625176651726.3,\n  \"md5\": \"a5daabadee5233ad9941b39e39f6ce7b\",\n  \"sha256\": \"bea4dcabc10ad8b7ef79579a1c511ec42cb98ddd1cf607a5a5ee369b28aa144b\",\n  \"config\": {\n   \"Spawn To x86\": \"%windir%\\\\syswow64\\\\dllhost.exe\",\n   \"Polling\": 5000,\n   \"Port\": 443,\n   \"Jitter\": 10,\n   \"HTTP Method Path 2\": \"/jquery-3.3.2.min.js\",\n   \"Method 2\": \"POST\",\n   \"C2 Server\": \"sammitng.com,/jquery-3.3.1.min.js\",\n   \"Method 1\": \"GET\",\n   \"Beacon Type\": \"8 (HTTPS)\",\n   \"Spawn To x64\": \"%windir%\\\\sysnative\\\\dllhost.exe\"\n  }\n },\n \"x64\": {\n  \"sha1\": \"7ed8d5a2e09d48ccb84d790abfa7a1556b9d4990\"\n\n```\n\n-----\n\n```\n  time : 1625176660366.2,\n  \"md5\": \"72296b01b37d6baefaecbc5bdecfadb6\",\n  \"sha256\": \"31f8ad3f818ef0635109cecfff8f2e03f5e47a9a62a2fe548bc10393e3318d4f\",\n  \"config\": {\n   \"Spawn To x86\": \"%windir%\\\\syswow64\\\\dllhost.exe\",\n   \"Polling\": 5000,\n   \"Port\": 443,\n   \"Jitter\": 10,\n   \"HTTP Method Path 2\": \"/jquery-3.3.2.min.js\",\n   \"Method 2\": \"POST\",\n   \"C2 Server\": \"sammitng.com,/jquery-3.3.1.min.js\",\n   \"Method 1\": \"GET\",\n   \"Beacon Type\": \"8 (HTTPS)\",\n   \"Spawn To x64\": \"%windir%\\\\sysnative\\\\dllhost.exe\"\n  }\n }\n}\n\n```\nIn addition to these command and control methods, one more network anomaly was observed. This\nwas not used for primary command and control and the amount of data sent was small so we do\nnot know the full intentions of the activity but several critical systems like domain controllers and file\nservers made connections to TOR nodes initiated by the threat actors.\n\n## Exfiltration\n\nThe threat actor on the second day of the intrusion downloaded WinSCP to the file server and\nproceeded to install the program there.\n```\nC:\\Users\\REDACTED\\AppData\\Local\\Temp\\1\\is-HCFKT.tmp\\WinSCP-5.19.1-Setup.tmp\"\n/SL5=\"$A02B0,10288106,864256,C:\\Users\\USER\\Desktop\\WinSCP-5.19.1-Setup.exe\"\n\n```\nThe threat actor then proceeded to connect over port 22 to a server in Romania.\n\nAs the traffic was encrypted we can’t conclusively determine what data was exfiltrated. However we\ncan infer that the choice to deploy on the file server was due to the data present and ease to move\nthe data.\n\nAnother data point is that following the exfiltration canary documents present in the shares reported\nin as being opened from an IP on a Virtual Private Host provider in New York, USA.\n\n## Impact\n\n\n-----\n\nDuring the overnight hours of the 2nd day the threat actors began moving on their final objectives.\nThis included testing their ransomware in the compromised environment before deploying across\nthe domain.\n\nThey initiated RDP connections and a Cobalt Strike beacon executable file to a endpoint not yet\ninteracted with by the threat actors. The threat actor then transferred a Conti executable file to\nseveral endpoints named test.exe.\n\nThese test ransom files were then called remotely using wmic as seen in the previous lateral\nmovement activity.\n```\nC:\\Windows\\system32\\cmd.exe /C wmic /node:\"ENDPOINT\" process call create \"C:\\test.exe\"\n\n```\nAfter testing on several endpoints, the threat actors dropped a renamed version of the file on\nseveral servers in the environment and executed by hand using their RDP session.\n\n\n-----\n\nWhen executed in this manner, the ransomware payload attempts to spread laterally over SMB.\n\nFrom there, the threat actors left the environment with this note and domain wide encryption\ncompleted about 32 hours after the initial beachhead BazarLoader was executed.\n\n## IOCs\n\n\n-----\n\nNetwork\n```\n34.219.130.241|443\n13.56.161.214|443\n31.14.40.160|22\nsammitng.com\n162.244.83.216|80 \n\n```\nFile\n```\n24f692b4ee982a145abf12c5c99079cfbc39e40bd64a3c07defaf36c7f75c7a9.exe\n215e0accdf538d48a8a7bf79009e8f9b\n4ff45fb8003ab1075bdbbc9d044b7c31374f3cdb\n24f692b4ee982a145abf12c5c99079cfbc39e40bd64a3c07defaf36c7f75c7a9\nbackup.exe\n4b566c684c1cfc980e14b968f15feb68\ne115f1be72f730bf3a7b7d9e2ec9e4b7b7a4b5e7\n7268dadee16e6ac6d618927c0061163505af6a591fae99fe207092f9d0e3cfd0\n7A86.dll\nabbbd0e30c4e66ad59518b9460dbcdfd\n981b2e54444d65e1104ab27d36d0ac9c6766478c\n9d63a34f83588e208cbd877ba4934d411d5273f64c98a43e56f8e7a45078275d\n162.244.83.216-cs.exe\n220007be6f16eb7300a99d0d84f83059\n38b0e925d7a3dae50585b2ee985904a7cdc0e47f\n82336da6be3130795a0f41a4f389b957e1d97633f8cb5e38ab40c8d62430b5a5\n3.exe\n0e2e8dfeec2168c2b3628ca2fb6c0736\nbf92ce7c065568c1b893c1ababa04eeffedadcca\n37b264e165e139c3071eb1d4f9594811f6b983d8f4b7ef1fe56ebf3d1f35ac89\nGet-DataInfo.ps1\n16cde93b441e4363700dfbf34c687b08\n092ac6f8d072c4cf045e35a839d5bb8f1360f1ae\na290ce75c6c6b37af077b72dc9c2c347a2eede4fafa6551387fa8469539409c7\nstart.bat\n0ab5c442d5a202c213f8a2fe2151fc3f\na780085d758aa47bddd1e088390b3bcc0a3efc2e\n63de40c7382bbfe7639f51262544a3a62d0270d259e3423e24415c370dd77a60\n\n## Detections\n\n```\nNetwork\n```\nET MALWARE Observed Malicious SSL Cert (Bazar Backdoor)\nET MALWARE Observed Malicious SSL Cert (Bazar CnC)\nET MALWARE Cobalt Strike Malleable C2 JQuery Custom Profile M2\nET MALWARE Cobalt Strike Malleable C2 JQuery Custom Profile Response\nET POLICY TLS possible TOR SSL traffic\nET TOR Known Tor Relay/Router (Not Exit) Node Traffic group 234\nET HUNTING Possible Powershell .ps1 Script Use Over SMB\nET POLICY Possible WMI .mof Managed Object File Use Over SMB\nET POLICY SMB2 NT Create AndX Request For a .bat File\nET POLICY SMB2 NT Create AndX Request For a DLL File - Possible Lateral Movement\nET POLICY SMB2 NT Create AndX Request For an Executable File\nET POLICY SMB2 NT Create AndX Request For a Powershell .ps1 File\nET SCAN Behavioral Unusual Port 135 traffic Potential Scan or Infection\n\n```\nSigma\n\n\n-----\n\n[CobaltStrike Service Installations](https://github.com/SigmaHQ/sigma/blob/1b480f2ee609e196fcaf6bfee11cf26133f64435/rules/windows/builtin/win_cobaltstrike_service_installs.yml)\n\n[Suspicious Remote Thread Created](https://github.com/SigmaHQ/sigma/blob/e7d9f1b4279a235406b61cc9c16fde9d7ab5e3ba/rules/windows/create_remote_thread/sysmon_suspicious_remote_thread.yml)\n\n[Domain Trust Discovery](https://github.com/SigmaHQ/sigma/blob/99b0d32cec5746c8f9a79ddbbeb53391cef326ba/rules/windows/process_creation/win_trust_discovery.yml) [Quick Execution of a Series of Suspicious Commands](https://github.com/SigmaHQ/sigma/blob/7f071d785157dfe185d845fad994aa6ec05ac678/rules/windows/process_creation/win_multiple_suspicious_cli.yml)\n\n[Pass the Hash Activity 2](https://github.com/SigmaHQ/sigma/blob/08ca62cc8860f4660e945805d0dd615ce75258c1/rules/windows/builtin/win_pass_the_hash_2.yml)\n\n[Suspicious WMI Execution](https://github.com/SigmaHQ/sigma/blob/5e701a2bcb353338854c8ab47de616fe7e0e56ff/rules/windows/process_creation/win_susp_wmi_execution.yml)\n\n[Successful Overpass the Hash Attempt](https://github.com/SigmaHQ/sigma/blob/08ca62cc8860f4660e945805d0dd615ce75258c1/rules/windows/builtin/win_overpass_the_hash.yml)\n\n[Encoded IEX](https://github.com/SigmaHQ/sigma/blob/08ca62cc8860f4660e945805d0dd615ce75258c1/rules/windows/process_creation/win_encoded_iex.yml)\n\nYara\n\n\n-----\n\n```\n/\nYARA Rule Set\nAuthor: The DFIR Report\nDate: 2021-09-01\nIdentifier: 5087\nReference: https://thedfirreport.com\n*/\n/* Rule Set ----------------------------------------------------------------- */\nrule case_5087_start_bat { \n  meta: \n   description = \"Files - file start.bat\" \n   author = \"The DFIR Report\" \n   reference = \"https://thedfirreport.com\" \n   date = \"2021-08-30\" \n   hash1 = \"63de40c7382bbfe7639f51262544a3a62d0270d259e3423e24415c370dd77a60\" \n  strings: \n   $x1 = \"powershell.exe Set-ExecutionPolicy -ExecutionPolicy Bypass -Scope Process Force\" fullword ascii \n   $x2 = \"powershell.exe -executionpolicy remotesigned -File .\\\\Get-DataInfo.ps1\n%method\" fullword ascii \n   $x3 = \"powershell.exe -executionpolicy remotesigned -File .\\\\Get-DataInfo.ps1 %1)\"\nfullword ascii \n   $s4 = \"set /p method=\\\"Press Enter for collect [all]: \\\"\" fullword ascii \n   $s5 = \"echo \\\"Please select a type of info collected:\\\"\" fullword ascii \n   $s6 = \"echo \\\"all ping disk soft noping nocompress\\\"\" fullword ascii \n  condition: \n   filesize < 1KB and all of them \n}\nrule case_5087_3 { \n  meta: \n   description = \"Files - file 3.exe\" \n   author = \"The DFIR Report\" \n   reference = \"https://thedfirreport.com\" \n   date = \"2021-08-30\" \n   hash1 = \"37b264e165e139c3071eb1d4f9594811f6b983d8f4b7ef1fe56ebf3d1f35ac89\" \n  strings: \n   $s1 = \"https://sectigo.com/CPS0\" fullword ascii \n   $s2 = \"?http://crl.usertrust.com/USERTrustRSACertificationAuthority.crl0v\" fullword\nascii \n   $s3 = \"2http://crl.comodoca.com/AAACertificateServices.crl04\" fullword ascii\n   $s4 = \"3http://crt.usertrust.com/USERTrustRSAAddTrustCA.crt0%\" fullword ascii \n   $s5 = \"    <requestedExecutionLevel level=\\\"asInvoker\\\"/>\" fullword ascii \n   $s6 = \"http://ocsp.sectigo.com0\" fullword ascii \n   $s7 = \"2http://crt.sectigo.com/SectigoRSACodeSigningCA.crt0#\" fullword ascii\n   $s8 = \"2http://crl.sectigo.com/SectigoRSACodeSigningCA.crl0s\" fullword ascii\n   $s9 = \"[email protected]\" fullword ascii \n   $s10 = \"bhfatmxx\" fullword ascii \n   $s11 = \"orzynoxl\" fullword ascii \n   $s12 = \" <trustInfo xmlns=\\\"urn:schemas-microsoft-com:asm.v3\\\">\" fullword ascii \n   $s13 = \"   <!--The ID below indicates application support for Windows 8.1 -->\"\nfullword ascii \n   $s14 = \"   <!--The ID below indicates application support for Windows 8 -->\"\nfullword ascii \n    $s15 = \"O:\\\\-e%\" fullword ascii\n\n```\n\n-----\n\n```\n   $s16    ! The ID below indicates application support for Windows 10\nfullword ascii \n   $s17 = \"   <!--The ID below indicates application support for Windows 7 -->\"\nfullword ascii \n   $s18 = \"   <!--The ID below indicates application support for Windows Vista -->\"\nfullword ascii \n   $s19 = \" <compatibility xmlns=\\\"urn:schemas-microsoft-com:compatibility.v1\\\">\"\nfullword ascii \n   $s20 = \" </compatibility>\" fullword ascii \n  condition: \n   uint16(0) == 0x5a4d and filesize < 1000KB and 8 of them \n}\nrule case_5087_7A86 { \n  meta: \n   description = \"Files - file 7A86.dll\" \n   author = \"The DFIR Report\" \n   reference = \"https://thedfirreport.com\" \n   date = \"2021-08-30\" \n   hash1 = \"9d63a34f83588e208cbd877ba4934d411d5273f64c98a43e56f8e7a45078275d\" \n  strings: \n   $s1 = \"ibrndbiclw.dll\" fullword ascii \n   $s2 = \"AppPolicyGetProcessTerminationMethod\" fullword ascii \n   $s3 = \"Type Descriptor'\" fullword ascii \n   $s4 = \"operator co_await\" fullword ascii \n  condition: \n   uint16(0) == 0x5a4d and filesize < 500KB and all of them \n}\n rule case_5087_24f692b4ee982a145abf12c5c99079cfbc39e40bd64a3c07defaf36c7f75c7a9 { \n  meta: \n   description = \"Files - file\n24f692b4ee982a145abf12c5c99079cfbc39e40bd64a3c07defaf36c7f75c7a9.exe\" \n   author = \"The DFIR Report\" \n   reference = \"https://thedfirreport.com\" \n   date = \"2021-08-30\" \n   hash1 = \"24f692b4ee982a145abf12c5c99079cfbc39e40bd64a3c07defaf36c7f75c7a9\" \n  strings: \n   $s1 = \"fbtwmjnrrovmd.dll\" fullword ascii \n   $s2 = \"AppPolicyGetProcessTerminationMethod\" fullword ascii \n   $s3 = \" Type Descriptor'\" fullword ascii \n   $s4 = \"operator co_await\" fullword ascii \n  condition: \n   uint16(0) == 0x5a4d and filesize < 900KB and all of them \n}\n\n```\n**MITRE**\n\n\n-----\n\nPass the Hash – T1550.002\nProcess Injection – T1055\n\nPowerShell – T1059.001\n\nRemote System Discovery – T1018\n\nService Execution – T1569.002\n\nWindows Command Shell – T1059.003\n\nAccount Discovery – T1087\n\nDomain Trust Discovery – T1482\n\nSystem Information Discovery – T1082\n\nRemote Services – T1021\n\nWindows Management Instrumentation – T1047\n\nExfiltration Over Alternative Protocol – T1048\n\nRemote Desktop Protocol – T1021.001\n\nSMB/Windows Admin Shares – T1021.002\n\nData Encrypted for Impact – T1486\n\nSecurity Software Discovery – T1518.001\n\nQuery Registry – T1012\n\n\n-----\n\nInternal case # 5087\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-09-13 - BazarLoader to Conti Ransomware in 32 Hours.pdf"
    ],
    "report_names": [
        "2021-09-13 - BazarLoader to Conti Ransomware in 32 Hours.pdf"
    ],
    "threat_actors": [
        {
            "id": "610a7295-3139-4f34-8cec-b3da40add480",
            "created_at": "2023-01-06T13:46:38.608142Z",
            "updated_at": "2025-03-27T02:00:02.87217Z",
            "deleted_at": null,
            "main_name": "Cobalt",
            "aliases": [
                "Cobalt Gang",
                "GOLD KINGSWOOD",
                "COBALT SPIDER",
                "G0080",
                "Mule Libra",
                "Cobalt Group"
            ],
            "source_name": "MISPGALAXY:Cobalt",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "d1f8bd4e-bcd4-4101-9158-6158f1806b38",
            "created_at": "2023-01-06T13:46:39.487358Z",
            "updated_at": "2025-03-27T02:00:03.107568Z",
            "deleted_at": null,
            "main_name": "BazarCall",
            "aliases": [
                "BazaCall",
                "BazzarCall"
            ],
            "source_name": "MISPGALAXY:BazarCall",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673535826,
    "ts_updated_at": 1743041588,
    "ts_creation_date": 1653761059,
    "ts_modification_date": 1653761059,
    "files": {
        "pdf": "https://archive.orkl.eu/600c2945cae9822ef3b7806eae64ca02d15fb825.pdf",
        "text": "https://archive.orkl.eu/600c2945cae9822ef3b7806eae64ca02d15fb825.txt",
        "img": "https://archive.orkl.eu/600c2945cae9822ef3b7806eae64ca02d15fb825.jpg"
    }
}