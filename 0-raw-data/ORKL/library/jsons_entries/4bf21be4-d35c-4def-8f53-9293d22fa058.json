{
    "id": "4bf21be4-d35c-4def-8f53-9293d22fa058",
    "created_at": "2023-01-12T15:04:34.377816Z",
    "updated_at": "2025-03-27T02:05:44.732751Z",
    "deleted_at": null,
    "sha1_hash": "0761ae6999b8cfbac64f047ad262ac9ec37e9d5d",
    "title": "2022-01-20 - Deep Dive Into Ragnar_locker Ransomware Gang",
    "authors": "",
    "file_creation_date": "2022-05-27T23:06:23Z",
    "file_modification_date": "2022-05-27T23:06:23Z",
    "file_size": 1883145,
    "plain_text": "# Deep dive into Ragnar_locker Ransomware Gang\n\n**[blog.cyble.com/2022/01/20/deep-dive-into-ragnar-locker-ransomware-gang/](https://blog.cyble.com/2022/01/20/deep-dive-into-ragnar-locker-ransomware-gang/)**\n\nJanuary 20, 2022\n\nOrganizations worldwide face a multi-pronged threat from Ransomware groups at a greater frequency than\nrecorded before. As the organizations’ primary danger remains losing access to their systems and data, the\nthreat of Ransomware groups leaking the data if their ransom requests are not met or the victim reaches out\nto law enforcement authorities has been raising more concern.\n\nCyble Research Labs has analyzed and published information about the most prominent and active\nransomware groups in the past and provided recommendations to prevent such incidents. This blog is a\ndeep dive into one of the most active Ransomware groups, Ragnar_Locker, how they operate, their\ncapabilities, and how to secure yourself/your organization from them.\n\nRagnar_locker ransomware was first observed in late 2019, targeting multiple high-profile targets on\nWindows platforms. Ragnar_locker also uses the double extortion technique for financial gain like most\nnotorious ransomware gangs.\n\nThis group targets several countries worldwide, as shown in the figure below.\n\n\n-----\n\nFigure 1 Ragnar_locker Ransomware Victim Details\n\n## Technical Analysis\n\nBased on static analysis, we found that the malicious file is a 32-bit Graphical User Interface (GUI) based\nbinary, as shown in Figure 2.\n\nFigure\n\n2 Static File Details of Ragnar_locker Ransomware\n\n\n-----\n\nAfter execution, Ragnar Ransomware initially searches for system details using GetLocalInfoW() API, which\nextracts the system’s default language. After identifying the system language, it compares this with a\nhardcoded list of languages present in the Ransomware binary, as shown in the figure below.\n\nFigure 3 Ragnar_locker Ransomware Language Check\nIf the identified system language is present in the hardcoded list, the Ransomware terminates its execution\nusing theTerminateProcess() API.\n\nThe languages hardcoded into the Ransomware are Belorussian, Azerbaijani, Ukrainian, and other\nlanguages commonly spoken in the former Soviet Union (USSR).\n\nRagar Ransomware then looks for other system information using APIs to retrieve the victim’s system name,\nusername, GUID, and product name.\n\nFigure 4 Ragnar_locker Ransomware Enumerating System Information\nThe Ransomware collects the above system information and calculates its size. This information and size\nare then fed to a custom logic to generate a unique hash to create an event in the system using\n_CreateEventW() API, as shown in Figure 5._\n\n\n-----\n\nFigure 5 Ragnar_locker\n\nRansomware Creating Event\nThis malware then enumerates all the physical drives in the system. Ragnar Ransomware uses\n_CreateFileW() API function to check which physical drives are accessible by the system. The malware then_\nexecutes a loop that runs sixteen times to get all the accessible physical drives.\n\nFigure 6 shows the enumeration of \\\\\\\\.\\\\PHYSICALDRIVE.\n\nFigure 6 Ragnar_locker Ransomware Checking for Physical Drives\nAfter checking the physical drives, the Ransomware extracts all the system volume names using\n_GetLogicalDrives() API, as shown in the figure below._\n\n\n-----\n\nFigure 7 Ragnar_locker Ransomware Enumerating Hard Drive Volumes\nAfter retrieving the volume names, the Ransomware then calls GetVolumeInformationA() API to get the\ndetails of the volume.\n\nFigure 8 Retrieves\n\nVolume Details\nThe malware now prepares the key required to encrypt the files in the latter part of its execution. The\nmalware uses cryptographic APIs such as CryptAcquireContextW(), CryptGenRandom() and\n_CryptReleaseContext() to generate random keys._\n\nThen, the malware uses a custom decryption logic which decrypts the strings that have information about the\nname of the services. After identifying the names of the services, the Ransomware checks for their presence\nand terminates them if the services are actively running on the victim’s machine. Some of these services\ninclude VSS, SQL, Memtas, etc.\n\nTo identify the services running in the machine, the Ransomware first calls OpenSCManagerA() API, which\nestablishes a connection to the service control manager that gives the TA access to the service control\nmanager database.\n\n\n-----\n\nUpon gaining access to this database, the following APIs() will be called:\n\n_OpenServiceA() – Opens the specified service._\n_QueryServiceStatusEx() – Gets the status of the service._\n_EnumDependentServiceA() – Retrieves the dependent services._\n_ControlService() – takes control of the service for stopping._\n\nIf OpenSCManagerA() API fails to get the handle to Service Control Manager (SCM), then the Ransomware\nskips calling the above service-related APIs.\n\nThe Ransomware then proceeds to execute CreateProcessW() API to call wmi/vssadmin to delete any\nshadow copies in the system. After this, the Ransomware decrypts the RSA public key, encrypting the\nrandomly generated key, as shown in Figure 9.\n\nFigure 9 RSA Public\n\nKey\nThe Ransomware decrypts the ransom notes in the memory, shown to the victims after file encryption on\ntheir system. Then, it gets the device name and creates a unique hash used to generate the ransom note\nname in the below format.\n\nRGNR_[Unique-hash].txt\n\nIt calls SHGetSpecialFolderPathW () API, gets the path of the Public folder (c:\\user\\public\\Documents), and\ncreates ransom notes in it. The ransom note content is then written using WriteFile() API.\n\nThe Ransomware then searches for files in the Windows directory for encryption using the FindFirstFileW()\nand FindNextFileW() APIs.\n\nBefore initiating encryption, the ransomware checks and excludes specific folders from encryption – such as\nWindows, Tor Browser, Google, Opera.\n\nThe Ransomware also excludes certain files from encryption such as RGNR_[unique_hash].txt, autorun.inf,\nboot.ini, amongst others.\n\nSpecific extensions are also exempted from encryption – such as .db, .sys, .dll.\n\n\n-----\n\nThe Ransomware specifically excludes these files, folders, and extensions to ensure that TAs are not\ndamaging any system-critical files. Victims will thus have access to the affected device to pay the ransom\nafter successful encryption.\n\n[Finally, the Ransomware encrypts the file using the salsa20 algorithm and displays a ransom note on the](https://en.wikipedia.org/wiki/Salsa20)\nvictims’ machine. As shown in the figure below, the encrypted files will have appended extension\nragnar_[unique_hash] in the victims’ device.\n\nFigure 10 Encrypted Files on the\n\nMachine\nIn their ransom note below, the TAs have instructed victims to contact them via qTox and have also given an\nEmail ID: cargowelcome@protonmail[.]com in case the victim cannot contact them through qTox to pay the\nransom of 25 Bitcoin (BTC) for the decryption key.\n\nFigure 11 Ransom note\n\n## Other Observations\n\nCyble Research Labs had found that the TAs leaked their victim’s details on their leak website when victims\ndid not pay the ransom. The following figure showcases the Ragnar_locker’s leak website with recent\nvictims.\n\n\n-----\n\nFigure 12 Victims Mentioned on Leak Site\nAs per their leak site, the Ragnar_locker ransomware group claims to be a team of cyber security\nenthusiasts working to make a profit.\n\nThe group alleges that their primary motivation to attack organizations is to help them improve their security\nmeasures. In addition, they want companies to take responsibility for securely storing the personal data of\ntheir clients and partners.\n\nIn one case, it was observed that the TAs had stolen the data of a victim’s machine and shared the same on\ntheir leak site. The stolen data claimed by the TAs include name, PAN Number, mobile numbers, GST\nnumbers, etc.\n\nThe victim’s data posted on the TAs leak site is shown in the figure below.\n\n\n-----\n\nFigure 13 Tax Invoice\n\n\n-----\n\nFigure 14\n\nAirways Bill\n\n## Conclusion\n\nThere are likely multiple variants of Ragnar_locker ransomware active in the wild. In addition, TAs keep\nimproving their code with new features to evolve their Ransomware-as-a-Service (RaaS) business model\nwith new Tactics, Techniques, and Procedures (TTPs) to target devices. Based on these observations, we\ncan safely assume that there may be further enhancements in upcoming variants of Ragnar_locker.\n\nWe continuously monitor Ragnar_locker’s extortion campaigns and update our readers with the latest\ninformation.\n\n## Our Recommendations\n\nWe have listed some essential cybersecurity best practices that create the first line of control against\nattackers. We recommend that our readers follow the best practices given below:\n\n## Safety measures needed to prevent ransomware attacks\n\nConduct regular backup practices and keep those backups offline or in a separate network\n\n\n-----\n\nTurn on the automatic software update feature on your computer, mobile, and other connected devices\nwherever possible and pragmatic.\nUse a reputed anti-virus and Internet security software package on your connected devices, including\nPC, laptop, and mobile.\nRefrain from opening untrusted links and email attachments without verifying their authenticity.\n\n## Users should take the following steps after the ransomware attack\n\nDetach infected devices on the same network.\nDisconnect external storage devices if connected.\nInspect system logs for suspicious events.\n\n## Impacts and cruciality Of Ragnar_locker Ransomware\n\nLoss of Valuable data.\nLoss of organization’s reliability or integrity.\nLoss of organization’s businesses information.\nDisruption in organization operation.\nEconomic loss.\n\n## MITRE ATT&CK® Techniques\n\n**Tactic** **Technique ID** **Technique Name**\n\n**Initial Access** [T1078](https://attack.mitre.org/techniques/T1078/) – Valid Accounts\n\n**Execution** [T1059](https://attack.mitre.org/techniques/T1059/) – Command and Scripting Interpreter\n\n\n**Privilege Escalation** [T1548](https://attack.mitre.org/techniques/T1548)\n\n[T1134](https://attack.mitre.org/techniques/T1134)\n\n**Defense Evasion** [T1112](https://attack.mitre.org/techniques/T1112)\n\n[T1027](https://attack.mitre.org/techniques/T1027)\n\n[T1562.001](https://attack.mitre.org/techniques/T1562/001/)\n\n**Discovery** [T1082](https://attack.mitre.org/techniques/T1082/)\n\n[T1083](https://attack.mitre.org/techniques/T1083)\n\n[T1135](https://attack.mitre.org/techniques/T1135)\n\n**Impact** [T1490](https://attack.mitre.org/techniques/T1490/)\n\n[T1489](https://attack.mitre.org/techniques/T1489/)\n\n[T1486](https://attack.mitre.org/techniques/T1486/)\n\n\n– Abuse Elevation Control Mechanism\n\n– Access Token Manipulation\n\n– Modify Registry\n\n– Obfuscated Files or Information\n\n– Impair Defenses: Disable or Modify Tools\n\n– System Information Discovery\n\n– File and Directory Discovery\n\n– Network Share Discovery\n\n– Inhibit System Recovery\n\n– Service Stop\n\n– Data Encrypted for Impact\n\n\n## Indicators of Compromise (IOCs)\n\n**Indicators** **Indicator**\n**type**\n\n\n**Description**\n\n\n**b6663af099538a396775273d79cb6fff99a18e2de2a8a2a106de8212cc44f3e2** SHA256 Ragnar_locker\nExecutable\n\n**ac16f3e23516cf6b22830c399b4aba9706d37adceb5eb8ea9960f71f1425df79** SHA256 Ragnar_locker\nExecutable\n\n\n-----\n\n**68eb2d2d7866775d6bf106a914281491d23769a9eda88fc078328150b8432bb3** SHA256 Ragnar_locker\nExecutable\n\n**b670441066ff868d06c682e5167b9dbc85b5323f3acfbbc044cabc0e5a594186** SHA256 Ragnar_locker\nExecutable\n\n**9bdd7f965d1c67396afb0a84c78b4d12118ff377db7efdca4a1340933120f376** SHA256 Ragnar_locker\nExecutable\n\n**dd5d4cf9422b6e4514d49a3ec542cffb682be8a24079010cda689afbb44ac0f4** SHA256 Ragnar_locker\nExecutable\n\n**63096f288f49b25d50f4aea52dc1fc00871b3927fa2a81fa0b0d752b261a3059** SHA256 Ragnar_locker\nExecutable\n\n**a8ee0fafbd7b84417c0fb31709b2d9c25b2b8a16381b36756ca94609e2a6fcf6** SHA256 Ragnar_locker\nExecutable\n\n**5fc6f4cfb0d11e99c439a13b6c247ec3202a9a343df63576ce9f31cffcdbaf76** SHA256 Ragnar_locker\nExecutable\n\n**1472f5f559f90988f886d515f6d6c52e5d30283141ee2f13f92f7e1f7e6b8e9e** SHA256 Ragnar_locker\nExecutable\n\n**ec35c76ad2c8192f09c02eca1f263b406163470ca8438d054db7adcf5bfc0597** SHA256 Ragnar_locker\nExecutable\n\n**68eb2d2d7866775d6bf106a914281491d23769a9eda88fc078328150b8432bb3** SHA256 Ragnar_locker\nExecutable\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-01-20 - Deep Dive Into Ragnar_locker Ransomware Gang.pdf"
    ],
    "report_names": [
        "2022-01-20 - Deep Dive Into Ragnar_locker Ransomware Gang.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673535874,
    "ts_updated_at": 1743041144,
    "ts_creation_date": 1653692783,
    "ts_modification_date": 1653692783,
    "files": {
        "pdf": "https://archive.orkl.eu/0761ae6999b8cfbac64f047ad262ac9ec37e9d5d.pdf",
        "text": "https://archive.orkl.eu/0761ae6999b8cfbac64f047ad262ac9ec37e9d5d.txt",
        "img": "https://archive.orkl.eu/0761ae6999b8cfbac64f047ad262ac9ec37e9d5d.jpg"
    }
}