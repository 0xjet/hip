{
    "id": "42d20383-ca6d-4b84-a277-c14da12ca1fc",
    "created_at": "2023-01-12T15:10:22.148763Z",
    "updated_at": "2025-03-27T02:16:34.797907Z",
    "deleted_at": null,
    "sha1_hash": "b25dec4a24fcfec5772847e6c9b79f470d9c336e",
    "title": "2021-09-28 - Zircolite vs Defense Evasion & Nobellium FoggyWeb",
    "authors": "",
    "file_creation_date": "2022-05-28T15:51:04Z",
    "file_modification_date": "2022-05-28T15:51:04Z",
    "file_size": 469833,
    "plain_text": "# Zircolite vs Defense Evasion & Nobellium FoggyWeb\n\n**holisticinfosec.io/post/2021-09-28-zircolite/**\n\nI’m pleased to be back sharing outstanding tools for security practitioners with you after an\n[extended time out to finish my Ph.D.](https://www.proquest.com/docview/2572528120/2A125088E37141D1PQ/1)\n\n[Here now, in our 145th installment of toolsmith, we discuss Zircolite, a standalone and fast](https://github.com/wagga40/Zircolite)\nSIGMA-based detection tool for EVTX or JSON, a fine tool brought to us courtesy of\n[@waggabat. Zircolite’s GitHub repo tells you absolutely everything you need to know, and](https://twitter.com/waggabat)\nthe [documentation is more than adequate, so I’ll repeat only this:](https://github.com/wagga40/Zircolite/tree/master/docs)\n\nZircolite is a standalone tool written in Python 3 allowing to use SIGMA rules on\nWindows event logs\nZircolite can be used directly on the investigated endpoint or in your favorite\nforensic/detection lab\nZircolite is fast and can parse large datasets in just seconds\nZircolite can handle EVTX files and JSON files as long as they are in\nJSONL/NDJSON format\nZircolite can be used directly in Python or you can use the binaries provided in\nreleases\n\nAs you install Zircolite via a git clone to your preferred path, install the additional\nrequirements via `pip install -r requirements.txt .`\n\nRunning Zircolite is as easy as the likes of `python zircolite.py --evtx logs --`\n```\n ruleset rules/rules_windows_generic.json .\n\n```\nThe rulesets provided are a set of SIGMA-based generic Windows rules and Sysmon rules.\n[We owe Florian Roth and other many thanks for](https://twitter.com/cyb3rops) [SIGMA, a true SOC work horse.](https://github.com/SigmaHQ/sigma)\n\nI’m particularly fond of actions we defenders can take to detect defense evasion. As such,\nour first test scenario is oriented accordingly. I created a logs directory in my Zircolite path\n[and copied 16 defense evasion-specific EVTX log samples from](https://github.com/sbousseaden/EVTX-ATTACK-SAMPLES/tree/master/Defense%20Evasion) [Samir’s killer Windows](https://twitter.com/sbousseaden)\nEVTX Samples [repo. Love this resource! Thereafter, a quick run of Zircolite using the](https://github.com/sbousseaden/EVTX-ATTACK-SAMPLES)\nSysmon rules provided immediate findings (two seconds) as seen in Figure 1.\n\n\n-----\n\n**Figure 1: Zircolite run with Sysmon rules**\n[Oh, wait. You’re not running Sysmon everywhere possible? Tsk, tsk. Download Sysmon,](https://docs.microsoft.com/en-us/sysinternals/downloads/sysmon)\nand use [SwiftOnSecurity’s rocking good config file template with default high-quality event](https://twitter.com/swiftonsecurity)\n[tracing. Thanks as always to Mark and](https://twitter.com/markrussinovich) [Thomas for the indispensable masterpiece that is](https://twitter.com/mxatone)\nSysmon. Zircolite findings are written out to detected_events.json in the Zircolite parent\ndirectory. In keeping with Figure 2 represents the first of 82 detections of code injection with\nPowerShell.\n\n**Figure 2: Zircolite detected event**\n\n\n-----\n\nSweet, right?\nHoning in on more specific adversarial actions per current events, first review the excellent\n[deep dive analysis from Ramin,](https://twitter.com/malwarere) FoggyWeb: Targeted NOBELIUM malware leads to\npersistent backdoor. Herein, we learn about the latest NOBELIUM malware, a postexploitation backdoor that Microsoft Threat Intelligence Center (MSTIC) refers to as\nFoggyWeb: “FoggyWeb is a passive and highly targeted backdoor capable of remotely\nexfiltrating sensitive information from a compromised AD FS server. It can also receive\nadditional malicious components from a command-and-control (C2) server and execute\nthem on the compromised server.” After compromising an AD FS server, NOBELIUM was\nobserved dropping the following two files on the system:\n\n_%WinDir%\\ADFS\\version.dll_\n_%WinDir%\\SystemResources\\Windows.Data.TimeZones\\pris\\Windows.Data.TimeZones.zh-_\n_PH.pri_\n\nThis initial file drop struck me and others as a simple rule construct, I crafted a simple rule\n[for use with Zircolite, resembling Florian’s, as a result.](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/image_load/sysmon_foggyweb_nobelium.yml)\n\nTo trigger the rule I simply created a small placeholder file with Textpad running with admin\nprivileges and saved it to C:\\windows\\ADFS. This is not an actual image load event in the\nsame sense as detected in Florian’s [rule, just detection of the file creation in that path as](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/image_load/sysmon_foggyweb_nobelium.yml)\ncaptured by a Sysmon Event 11.\n\nAs I did, you can stick this JSON file in your rules directory or simply add it to the\n_rules_windows_sysmon.json file. I left it standalone and ran_ `python zircolite.py --`\n```\nevtx logs --ruleset rules/rules_windows_nobellium_filedrop.json . We have a\n\n```\nhit, as seen in Figure 3.\n\n**Figure 3: Nobellium FoggyWeb file drop detected**\n\n\n-----\n\nAs you can see, Zircolite can be adapted to almost any Windows-centric detection scenario\nas long as the events are written to EVTX. With Sysmon running Zirocite is an absolute nobrainer.\n[But wait! You need a GUI? No problem. Unzip the contents of zircogui.zip found in the gui](https://github.com/wagga40/Zircolite/blob/master/docs/Advanced.md#mini-gui)\ndirectory. Revisting our Nobellium FoggyWeb scenario, I ran: `python zircolite.py --`\n```\nevtx logs/sysmon.evtx --ruleset rules/rules_windows_nobellium_filedrop.json\n--template templates/exportForZircoGui.tmpl --templateOutput gui/data.js\n\n```\nThe result, as seen in Figure 4, represents a convenient way to hunt about in numerous\n[events per a MITRE ATT&CK category or an alert level.](https://twitter.com/MITREattack)\n\n**Figure 4: Zircolite GUI**\nI’m quite glad to be back at the keyboard working useful cybersecurity tooling scenarios\nwith you. Zircolite represented a golden opportunity to do so and couldn’t have coincided\nmore nicely than with the recently released Nobellium FoggyWeb analysis. Great work from\n@waggabat, I hope they keep it up.\n\nCheers…until next time.\n\n[← Previous Post](https://holisticinfosec.io/post/2021-08-20-abstract/)\n[Next Post →](https://holisticinfosec.io/post/lotl/)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-09-28 - Zircolite vs Defense Evasion & Nobellium FoggyWeb.pdf"
    ],
    "report_names": [
        "2021-09-28 - Zircolite vs Defense Evasion & Nobellium FoggyWeb.pdf"
    ],
    "threat_actors": [
        {
            "id": "b43e5ea9-d8c8-4efa-b5bf-f1efb37174ba",
            "created_at": "2022-10-25T16:07:24.36191Z",
            "updated_at": "2025-03-27T02:02:10.1909Z",
            "deleted_at": null,
            "main_name": "UNC2452",
            "aliases": [
                "Dark Halo",
                "Nobelium",
                "SolarStorm",
                "StellarParticle",
                "UNC2452"
            ],
            "source_name": "ETDA:UNC2452",
            "tools": [],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "70872c3a-e788-4b55-a7d6-b2df52001ad0",
            "created_at": "2023-01-06T13:46:39.18401Z",
            "updated_at": "2025-03-27T02:00:03.01553Z",
            "deleted_at": null,
            "main_name": "UNC2452",
            "aliases": [
                "DarkHalo",
                "StellarParticle",
                "NOBELIUM",
                "Solar Phoenix",
                "Midnight Blizzard"
            ],
            "source_name": "MISPGALAXY:UNC2452",
            "tools": [
                "SNOWYAMBER",
                "HALFRIG",
                "QUARTERRIG"
            ],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "1d3f9dec-b033-48a5-8b1e-f67a29429e89",
            "created_at": "2022-10-25T15:50:23.739197Z",
            "updated_at": "2025-03-27T02:00:55.536417Z",
            "deleted_at": null,
            "main_name": "UNC2452",
            "aliases": [
                "UNC2452",
                "NOBELIUM",
                "StellarParticle",
                "Dark Halo"
            ],
            "source_name": "MITRE:UNC2452",
            "tools": [
                "Sibot",
                "Mimikatz",
                "Cobalt Strike",
                "AdFind",
                "GoldMax"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "a241a1ca-2bc9-450b-a07b-aae747ee2710",
            "created_at": "2024-06-19T02:03:08.150052Z",
            "updated_at": "2025-03-27T02:05:17.409596Z",
            "deleted_at": null,
            "main_name": "IRON RITUAL",
            "aliases": [
                "Blue Dev 5 ",
                "BlueBravo ",
                "Cloaked Ursa ",
                "CozyLarch ",
                "Dark Halo ",
                "Midnight Blizzard ",
                "NOBELIUM ",
                "StellarParticle ",
                "UNC2452 ",
                "APT29"
            ],
            "source_name": "Secureworks:IRON RITUAL",
            "tools": [
                " Cobalt Strike",
                " EnvyScout",
                " GoldFinder",
                " GoldMax",
                " NativeZone",
                " RAINDROP",
                " SUNBURST",
                " Sibot",
                " TEARDROP",
                " VaporRage",
                "Brute Ratel C4"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "20d3a08a-3b97-4b2f-90b8-92a89089a57a",
            "created_at": "2022-10-25T15:50:23.548494Z",
            "updated_at": "2025-03-27T02:00:55.49688Z",
            "deleted_at": null,
            "main_name": "APT29",
            "aliases": [
                "APT29",
                "IRON RITUAL",
                "IRON HEMLOCK",
                "NobleBaron",
                "Dark Halo",
                "NOBELIUM",
                "UNC2452",
                "YTTRIUM",
                "The Dukes",
                "Cozy Bear",
                "CozyDuke",
                "SolarStorm",
                "Blue Kitsune",
                "UNC3524",
                "Midnight Blizzard"
            ],
            "source_name": "MITRE:APT29",
            "tools": [
                "PinchDuke",
                "ROADTools",
                "WellMail",
                "CozyCar",
                "Mimikatz",
                "Tasklist",
                "OnionDuke",
                "FatDuke",
                "POSHSPY",
                "EnvyScout",
                "SoreFang",
                "GeminiDuke",
                "GoldMax",
                "FoggyWeb",
                "SDelete",
                "PolyglotDuke",
                "AADInternals",
                "MiniDuke",
                "SeaDuke",
                "Sibot",
                "RegDuke",
                "CloudDuke",
                "GoldFinder",
                "AdFind",
                "PsExec",
                "NativeZone",
                "Systeminfo",
                "ipconfig",
                "Impacket",
                "Cobalt Strike",
                "PowerDuke",
                "QUIETEXIT",
                "HAMMERTOSS",
                "BoomBox",
                "CosmicDuke",
                "WellMess",
                "VaporRage",
                "LiteDuke"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "46b3c0fc-fa0c-4d63-a38a-b33a524561fb",
            "created_at": "2023-01-06T13:46:38.393409Z",
            "updated_at": "2025-03-27T02:00:02.822155Z",
            "deleted_at": null,
            "main_name": "APT29",
            "aliases": [
                "The Dukes",
                "Minidionis",
                "Grizzly Steppe",
                "G0016",
                "Blue Kitsune",
                "BlueBravo",
                "SeaDuke",
                "Cloaked Ursa",
                "YTTRIUM",
                "ATK7",
                "Nobelium",
                "UAC-0029",
                "Group 100",
                "COZY BEAR",
                "IRON HEMLOCK",
                "TA421",
                "ITG11"
            ],
            "source_name": "MISPGALAXY:APT29",
            "tools": [
                "QUARTERRIG",
                "SNOWYAMBER",
                "HALFRIG"
            ],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "f27790ff-4ee0-40a5-9c84-2b523a9d3270",
            "created_at": "2022-10-25T16:07:23.341684Z",
            "updated_at": "2025-03-27T02:02:09.74554Z",
            "deleted_at": null,
            "main_name": "APT 29",
            "aliases": [
                "APT 29",
                "ATK 7",
                "Blue Dev 5",
                "BlueBravo",
                "Cloaked Ursa",
                "CloudLook",
                "Cozy Bear",
                "Dark Halo",
                "Earth Koshchei",
                "Grizzly Steppe",
                "Group 100",
                "ITG11",
                "Iron Hemlock",
                "Iron Ritual",
                "Midnight Blizzard",
                "Minidionis",
                "Nobelium",
                "NobleBaron",
                "Operation Ghost",
                "Operation Office monkeys",
                "Operation StellarParticle",
                "SilverFish",
                "Solar Phoenix",
                "SolarStorm",
                "StellarParticle",
                "TEMP.Monkeys",
                "The Dukes",
                "UNC2452",
                "UNC3524",
                "Yttrium"
            ],
            "source_name": "ETDA:APT 29",
            "tools": [
                "7-Zip",
                "ATI-Agent",
                "AdFind",
                "Agentemis",
                "AtNow",
                "BEATDROP",
                "BotgenStudios",
                "CEELOADER",
                "Cloud Duke",
                "CloudDuke",
                "CloudLook",
                "Cobalt Strike",
                "CobaltStrike",
                "CosmicDuke",
                "Cozer",
                "CozyBear",
                "CozyCar",
                "CozyDuke",
                "Danfuan",
                "EnvyScout",
                "EuroAPT",
                "FatDuke",
                "FoggyWeb",
                "GeminiDuke",
                "Geppei",
                "GoldFinder",
                "GoldMax",
                "GraphDrop",
                "GraphicalNeutrino",
                "GraphicalProton",
                "HAMMERTOSS",
                "HammerDuke",
                "LOLBAS",
                "LOLBins",
                "LiteDuke",
                "Living off the Land",
                "MagicWeb",
                "Mimikatz",
                "MiniDionis",
                "MiniDuke",
                "NemesisGemina",
                "NetDuke",
                "OnionDuke",
                "POSHSPY",
                "PinchDuke",
                "PolyglotDuke",
                "PowerDuke",
                "QUIETEXIT",
                "ROOTSAW",
                "RegDuke",
                "Rubeus",
                "SNOWYAMBER",
                "SPICYBEAT",
                "SUNSHUTTLE",
                "SeaDaddy",
                "SeaDask",
                "SeaDesk",
                "SeaDuke",
                "Sharp-SMBExec",
                "SharpView",
                "Sibot",
                "Solorigate",
                "SoreFang",
                "TinyBaron",
                "WINELOADER",
                "WellMail",
                "WellMess",
                "cobeacon",
                "elf.wellmess",
                "reGeorg",
                "tDiscoverer"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673536222,
    "ts_updated_at": 1743041794,
    "ts_creation_date": 1653753064,
    "ts_modification_date": 1653753064,
    "files": {
        "pdf": "https://archive.orkl.eu/b25dec4a24fcfec5772847e6c9b79f470d9c336e.pdf",
        "text": "https://archive.orkl.eu/b25dec4a24fcfec5772847e6c9b79f470d9c336e.txt",
        "img": "https://archive.orkl.eu/b25dec4a24fcfec5772847e6c9b79f470d9c336e.jpg"
    }
}