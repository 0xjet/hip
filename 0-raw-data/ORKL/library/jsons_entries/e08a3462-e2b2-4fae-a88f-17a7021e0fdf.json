{
    "id": "e08a3462-e2b2-4fae-a88f-17a7021e0fdf",
    "created_at": "2023-01-12T15:01:26.284698Z",
    "updated_at": "2025-03-27T02:06:15.426866Z",
    "deleted_at": null,
    "sha1_hash": "9ca2efbfe1104b775bed78c5127d3ab898f687cd",
    "title": "2017-10-10 - Malvertising Campaign Uses RIG EK to Drop Quant Loader which Downloads FormBook.",
    "authors": "",
    "file_creation_date": "2022-05-28T15:30:37Z",
    "file_modification_date": "2022-05-28T15:30:37Z",
    "file_size": 1010997,
    "plain_text": "# Malvertising Campaign Uses RIG EK to Drop Quant Loader which Downloads FormBook.\n\n**malwarebreakdown.com/2017/10/10/malvertising-campaign-uses-rig-ek-to-drop-quant-loader-which-downloads-**\nformbook/\n\nOctober 10, 2017\n\nA couple days ago I came across an unusual looking request for a RIG EK landing page.\nThe log showed the referer to be coming from a site called pay-scale[.]us:\n\nLooking through the logs surrounding the event I could see that the user visited a shady site\nusing the .ac ccTLD. Traffic estimates showed that this site received 500K visitors over the\nlast 30 days. When I was researching the site, I was redirected via malicious ad traffic to tech\nsupport scams. This leads me to believe the initial referer was from malvertising. The malvert\nlikely redirected the host to pay-scale[.]us via a 3XX status code.\n\nExamining the page source for pay-scale[.]us shows the website was mirrored\nfrom usmotors[.]com using HTTrack Website Copier:\n\n\n-----\n\nLooking a little farther down the page we can see how the user got redirected to RIG EK\nfrom pay-scale[.]us:\n\nThe domain in the hidden iframe, medical-help[.]top, resolves to 91.92.136.170.\n\nLooking at the Whois information shows these domains were registered using the name\n“Terry Kornfeld” and email address morganaanna7@gmail.com. Searching for all domains\nregistered using that name and/or email address returned the following:\n\n**Domain** **Registered**\n\ni-yourdoctor[.]top 10/8/2017\n\nhighqualitywebhelp[.]top 10/8/2017\n\nfilmsdays[.]top 10/4/2017\n\nphotosetty[.]us 10/2/2017\n\npay-scale[.]us 10/1/2017\n\nmadicalcareme[.]top 9/19/2017\n\nmymedicalcare[.]us 9/17/2017\n\nphoto24[.]top 9/9/2017\n\nmedical-help[.]top 9/9/2017\n\nThese sites should be considered malicious. Additionally, some of them are being used for\nC2 activities. More on that later.\nBelow is the GET request that was generated due to the hidden iframe on pay-scale[.]us:\n\nThe server returns a 302 Found with a location containing the RIG EK landing page URL.\n\n\n-----\n\nFurther examination of the infrastructure being used in this campaign show that the threat\nactor(s) are utilizing Keitaro TDS:\n\nBelow is an image of the HTTP traffic captured during this infection chain:\n\nRIG EK dropped two identical Quant Loader payloads in %TEMP%:\n\n\n-----\n\nWhen Quant Loader was executed it copied itself to %APPDATA%[uid]svchost.exe:\n\n[[uid] is the eight-digit unique ID generated for the infected host. Forcepoint shows how the](https://blogs.forcepoint.com/security-labs/locky-distributor-uses-newly-released-quant-loader-sold-russian-underground)\nunique ID is generated:\n\n1. Obtain the Windows GUID value\n\nfrom HKEY_LOCAL_MACHINESoftwareMicrosoftWindowsCryptography\n2. Extract only the number values, no letters or dashes\n3. Copy 8 of the numbers, beginning with the 5th number\n\nThe malware then re-launches itself under “svchost.exe” and creates file\n“C:Users[Username]AppDataLocalTempper”. The following processes and actions were\nrecorded:\n\n1. svchost.exe creates process regini.exe\n2. regini.exe reads data from file %TEMP%per\n3. svchost.exe deletes file %TEMP%per\n4. svchost.exe sets AutoStart registry key\n\n“HKCUSoftwareMicrosoftWindowsCurrentVersionRunQt”\n\n\n-----\n\nQuant Loader also modifies Windows Firewall to allow outbound communications using the\ncommand:\n```\nnetsh.exe advfirewall firewall add rule \"name=Quant\"\n\"program=c:usersappdata[uid]svchost.exe\" dir=Out action=allow\n\n```\nI found post-infection traffic to the C2 at filmsdays[.]top/q/, which was registered by “Terry\nKornfeld” using the email address morganaanna7@gmail.com:\n\nid = the unique ID of the infected host\nc = the current index of the server being used\nmk = string likely used as an affiliate of campaign ID\nil = Haven’t confirmed\nvr = Haven’t confirmed but could be version number\n\n\n-----\n\nbt = Haven t confirmed but could be x86 or x64\n\nBelow is an example of the Quant Loader C2 TCP connections captured during my infection:\n\nRemote Address: 85.217.170.186\nRemote Host Name: t.co\nRemote Port: 80\nProcess Name: svchost.exe\nProcess Path: C:UsersWin7 32bitappdataroaming[uid]svchost.exe\nRemote IP Country: Bulgaria\n\nRemote Address: 212.73.150.215\nRemote Host Name: v22597.vps.ag\nRemote Port: 80\nProcess Name: svchost.exe\nProcess Path: C:UsersWin7 32bitappdataroaming[uid]svchost.exe\nRemote IP Country: Bulgaria\n\nIn my infection the first server (c=1) responded with the location of follow-up malware located\nat motorsus[.]us/fb.exe.\n\nMotorsus[.]us appears to be under control of the same threat actor(s). The name and email\nused to register this domain is “Lee M Clark” and john.benjack@mailfence.com. Below is a\nlist of current domains using that registrant information.\n\nDomain Registered\n\nmotorsus.us 10/1/2017\n\nseechicagodance.us 10/1/2017\n\nThis payload is dropped in %TEMP% and executed.\n\nThe malware being downloaded by Quant Loader was identified as FormBook by my\n[friend @Antelox.](https://twitter.com/Antelox)\n\n\n-----\n\nFormBook, once executed, copied itself (it was hidden) to %USERPROFILE%:\n\nThe malware was renamed to mfcgn2pl.exe.\n\nAccording to [FireEye, it can also use the following prefixes for its name:](https://www.fireeye.com/blog/threat-research/2017/10/formbook-malware-distribution-campaigns.html)\n\nms\nmfc\nwin\ngdi\nvga\nigfx\nuser\nhelp\nconfig\nupdate\nregsvc\nchkdsk\nsystray\n\n\n-----\n\naudiodg\ncertmgr\nautochk\ntaskhost\ncolorcpl\nservices\nIconCache\nThumbCache\nCookies\n\nIt can also use the following file extensions:\n\n.exe\n.com\n.scr\n.pif\n.cmd\n.bat\n\nIf it is running with normal privileges it is copied to one the following directories:\n\n%USERPROFILE%\n%APPDATA%\n%TEMP%\n\nHere is another image showing another copy called Cookiescz7x.cmd being created in\n%APPDATA%:\n\nIf it is running with elevated privileges it copies itself to one of the following directories:\n\n\n-----\n\n%ProgramFiles%\n%CommonProgramFiles%\n\nIn my infection I found it configuring persistence to\nHKLMSOFTWAREMicrosoftWindowsCurrentVersionRun:\n\nHowever, depending on its privileges, it can also use the following locations for persistence:\n\nHKCUSOFTWAREMicrosoftWindowsCurrentVersionPoliciesExplorerRun\nHKLMSOFTWAREMicrosoftWindowsCurrentVersionPoliciesExplorerRun\nHKCUSOFTWAREMicrosoftWindowsCurrentVersionRun\n\nFormBook was beaconing to basefilm[.]top/tesla/shell123/config.php.\n\nBasefilm[.]top is registered to “Shirhall Shirhall” and is using the registrant email\naddress annacrown44@gmail.com.\n\nI captured the following GET requests:\n\nThe parameter “id” shown in the URL contains encoded information about the system.\n\nThe malware also uses HTTP POST requests to send data back to\nbasefilm[.]top/tesla/shell123/config.php:\n\nAccording to FireEye these messages to the C2 are RC4 encrypted and Base64 encoded\n\n\n-----\n\nFireEye also mentions that FormBook will use function hooks to log keystrokes, steal\nclipboard data, and extract authentication information from browser HTTP sessions.”\n\nFor keystrokes captured during a browsing session with Internet Explorer it created the\nfollowing file:\n\n%APPDATA%JQ18T541JQ1log.ini\n\nYou can see my HTTP sessions and keystrokes being captured in the .ini file:\n\nQuick note. My friend [@Antelox examined the FormBook sample and discovered that it](https://twitter.com/Antelox)\ndownloaded ZeuS Panda with web injects for PayPal, eBay, Amazon, and BoQ (Bank of\nQueensland). The ZeuS sample can be viewed below:\n\nhttps://www.virustotal.com/en/file/e4474970dd8d2f9e4a3d4a0fa06d82f8d6c2af49737d6cb2e\n5db6a388aa930ba/analysis/\n\nNetwork Based IOCs\n\n212.73.150.215 – pay-scale[.]us – Malicious dummy site\n91.92.136.170 – medical-help[.]top – Redirected to RIG EK\n176.57.217.78 – IP literal hostname used by RIG EK\n85.217.170.186 – filmsdays[.]top – GET /q/index.php – Quant Loader C2\n212.73.150.215 – motorsus[.]us – GET /fb.exe – GET for FormBook\n169.239.128.162 – basefilm[.]top – GET and POST /tesla/shell123/config.php –\nFormBook beacon and C2\n\n\n-----\n\nDNS queries for kinnomanna.top:\n\nHashes\n\n[SHA256: c10c659498c3bd5ed8454c0041739db7d324ddd09126c16ea229ab30e9232de4](https://www.virustotal.com/en/file/c10c659498c3bd5ed8454c0041739db7d324ddd09126c16ea229ab30e9232de4/analysis/)\nFile name: RigEK landing page.txt\n\n[SHA256: b5dc599319b6f0968db9318e3d5dbbd6939c4d7b879e45269210a5878b7551a4](https://www.virustotal.com/en/file/b5dc599319b6f0968db9318e3d5dbbd6939c4d7b879e45269210a5878b7551a4/analysis/1507627342/)\nFile name: RigEK Flash exploit.swf\n\n[SHA256: 22aba6be7e754e7163e8adb72f7235ad97ff411a29c98444ddacc24bd04cdc34](https://www.virustotal.com/en/file/22aba6be7e754e7163e8adb72f7235ad97ff411a29c98444ddacc24bd04cdc34/analysis/)\nFile name: o32.tmp\n\n[SHA256: 8e94bd154dbea3d020cce1e216f4a327d0ddf65737847ffed34113bf3fdb22dd](https://www.virustotal.com/en/file/8e94bd154dbea3d020cce1e216f4a327d0ddf65737847ffed34113bf3fdb22dd/analysis/)\nFile name: bilonebilo417.exe\n[Hybrid-Analysis Report](https://www.hybrid-analysis.com/sample/8e94bd154dbea3d020cce1e216f4a327d0ddf65737847ffed34113bf3fdb22dd?environmentId=100)\n\n[SHA256: 2f74f8518bd14a882a870f3794a76dba381b59c1e40247a2483468959b572d82](https://www.virustotal.com/en/file/2f74f8518bd14a882a870f3794a76dba381b59c1e40247a2483468959b572d82/analysis/)\nFile name: fb.exe\n[Hybrid-Analysis Report](https://www.hybrid-analysis.com/sample/2f74f8518bd14a882a870f3794a76dba381b59c1e40247a2483468959b572d82?environmentId=100)\n\n[SHA256: 0fa6898d426a6176ff7673d2d5336879d418f5be2714605eb32985626f508357](https://www.virustotal.com/en/file/0fa6898d426a6176ff7673d2d5336879d418f5be2714605eb32985626f508357/analysis/)\nFile name: 05110.exe\n[Hybrid-Analysis Report](https://www.hybrid-analysis.com/sample/0fa6898d426a6176ff7673d2d5336879d418f5be2714605eb32985626f508357?environmentId=100)\n\n[SHA256: 72a4b137b02b0ef45f5013b88228132081cff1ecfeccecae5e70069bf38c5ba0](https://www.virustotal.com/en/file/72a4b137b02b0ef45f5013b88228132081cff1ecfeccecae5e70069bf38c5ba0/analysis/)\nFile name: 15838.exe\n[Hybrid-Analysis Report](https://www.hybrid-analysis.com/sample/72a4b137b02b0ef45f5013b88228132081cff1ecfeccecae5e70069bf38c5ba0?environmentId=100)\n\nDownloads\n\n[Malicious Artifacts](https://malwarebreakdown.com/wp-content/uploads/2017/10/Malicious-Artifacts.zip)\n\n\n-----\n\nPassword is infected\n\nReferences:\n\n1. https://blogs.forcepoint.com/security-labs/locky-distributor-uses-newly-released-quant\nloader-sold-russian-underground\n2. https://www.fireeye.com/blog/threat-research/2017/10/formbook-malware-distribution\ncampaigns.html\n\n## Published by malwarebreakdown\n\nJust a normal person who spends their free time infecting systems with malware. View all\nposts by malwarebreakdown\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2017/2017-10-10 - Malvertising Campaign Uses RIG EK to Drop Quant Loader which Downloads FormBook..pdf"
    ],
    "report_names": [
        "2017-10-10 - Malvertising Campaign Uses RIG EK to Drop Quant Loader which Downloads FormBook..pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673535686,
    "ts_updated_at": 1743041175,
    "ts_creation_date": 1653751837,
    "ts_modification_date": 1653751837,
    "files": {
        "pdf": "https://archive.orkl.eu/9ca2efbfe1104b775bed78c5127d3ab898f687cd.pdf",
        "text": "https://archive.orkl.eu/9ca2efbfe1104b775bed78c5127d3ab898f687cd.txt",
        "img": "https://archive.orkl.eu/9ca2efbfe1104b775bed78c5127d3ab898f687cd.jpg"
    }
}