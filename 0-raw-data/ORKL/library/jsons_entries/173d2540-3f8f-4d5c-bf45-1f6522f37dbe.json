{
    "id": "173d2540-3f8f-4d5c-bf45-1f6522f37dbe",
    "created_at": "2022-10-25T16:48:17.663348Z",
    "updated_at": "2025-03-27T02:09:20.693648Z",
    "deleted_at": null,
    "sha1_hash": "ce6de200409d558d88c026c9ab087ed1c836db28",
    "title": "",
    "authors": "",
    "file_creation_date": "2019-09-02T05:01:10Z",
    "file_modification_date": "2019-09-02T05:01:10Z",
    "file_size": 9254592,
    "plain_text": "Branch: master [Find file](https://github.com/StrangerealIntel/CyberThreatIntel/find/master) Copy path\n\n#### CyberThreatIntel / offshore APT organization / Bitter / 27-08-19 / Malware analysis 31-08-19.md\n\n\n[StrangerealIntel Update Malware analysis 31-08-19.md](https://github.com/StrangerealIntel)\n\n[c652dc8 7 hours ago](https://github.com/StrangerealIntel/CyberThreatIntel/commit/c652dc87fa9eb05c5f4a2fd9c025c6fa7c18055e)\n\n1 contributor\n\n\n# Malware analysis on Bitter APT campaign (31-08-19)\n\n## Table of Contents\n\n#### Malware analysis\n\n Initial vector\n\n ArtraDownloader\n\n Cyber Threat Intel\n\n Indicators Of Compromise (IOC)\n\n References MITRE ATT&CK Matrix\n\n Links\n Original Tweet\n\n Link Anyrun\n\n Documents\n\n## Malware-analysis\n\n### Initial vector\n\nUse a document with a remote template injection as initial vector. This request http[:]//maq.com.pk/ for be redirected on the next URL.\n\nThis seconds URL (http[:]//maq.com.pk/wehsd) send an RTF exploit.\n\n\n-----\n\nThis exploit firstly executes a request by WebDAV and after by WebClient service for download the backdoor on the final address\n(http[:]//maq.com.pk/wehs) and execute it.\n\nHere we can see the redirection and the data sended on the victim.\n\n### ArtraDownloader\n\n\n-----\n\ncan note encoded string pushed on a function and the result is moved on another registry as storage for be used by the backdoor.\n\nIn observing this function we can resume by the following algorithm used for decode these strings : for each byte of the string -> value of\nthe byte -1 -> get Unicode value -> convert to char.\n\nWe can edit a script for decode the encoded string.\n\nNow we can see the actions did by the malware.\n\n\n-----\n\n-----\n\n-----\n\nWe can observe that the malware pushes the persistence by a Run key in the registry. We can note too that use DOS commands with an\nenvironment value (\"C:\\ProgramData\\Ntuser\\winlgn.exe\") for launch the backdoor.\n\n\n-----\n\n-----\n\n-----\n\nThis query the registry for getting, the version of the OS and proceeds for identifying the victim ºs machine GUID by the\nHKLM\\SOFTWARE\\Microsoft\\Cryptography\\MachineGuid registry key.\n\nThis use too, the EncodePointer function for encoding a specified pointer (encoded pointers can be used to provide another layer of\nprotection for pointer values).\n\n\n-----\n\nAfter performing the reconnaissance actions, this can send a query as pulse with the informations to the C2, the URL to send is decoded\nand an additional operation give the final URL.\n\n\n-----\n\n-----\n\n-----\n\nThe data are encoded by the algorithm too, with the script, we can decode the strings and see that the roles and data send to the C2.\n\n\n-----\n\n#### the Anyrun sandbox)\n\nWe can resume all the variables used and the type of the informations sent in the C2.\n\n#### Variable Description\n\n SNI Computer name\n\n UME OS Version\n\n OPQ Account name\n\n IVR [Computer name]##[Account name]@@[GUID]\n\n st downloaded file executed successfully ?\n\n### Cyber kill chain\n\nThis process graph represents the cyber kill chain of Bitter sample.\n\n## Cyber Threat Intel\n\nSince the last 2 weeks, the C2 domain have changed (.193 to .198) due to this are on the same subnet of the Verdina organization (Bulgaria\ncloud provider).\n\nWe can note on the WHOIS information that this registered in Ras al-khaimah location.\n\n|Variable|Description|\n|---|---|\n|SNI|Computer name|\n|UME|OS Version|\n|OPQ|Account name|\n|IVR|[Computer name]##[Account name]@@[GUID]|\n|st|downloaded file executed successfully ?|\n\n\n-----\n\nThe location is placed in the business place of the city.\n\n\n-----\n\nWe can note that two phone numbers with the country indicate (Indian and Iranian) have the same address for two companies.\n\nIn Ras al-Khaimah, there is no corporate tax, no profits, no customs duties, no inheritance tax, it is not excluding that the group Bitter\nchose this place as a tax haven for their operations.\n\n## References MITRE ATT&CK Matrix\n\nList of all the references with MITRE ATT&CK Matrix\n\n#### Enterprise tactics Technics used Ref URL\n\n Execution T1203 - Exploitation for Client Execution https://attack.mitre.org/techniques/T1203\n\n Persistence T1060 - Registry Run Keys / Startup Folder https://attack.mitre.org/techniques/T1060\n\n Discovery T1012 - Query Registry https://attack.mitre.org/techniques/T1012\n\n Lateral Movement T1105 - Remote File Copy https://attack.mitre.org/techniques/T1105\n\n C & C T1105 - Remote File Copy https://attack.mitre.org/techniques/T1105\n\n## Indicators Of Compromise (IOC)\n\n|Enterprise tactics|Technics used|Ref URL|\n|---|---|---|\n|Execution|T1203 - Exploitation for Client Execution|https://attack.mitre.org/techniques/T1203|\n|Persistence|T1060 - Registry Run Keys / Startup Folder|https://attack.mitre.org/techniques/T1060|\n|Discovery|T1012 - Query Registry|https://attack.mitre.org/techniques/T1012|\n|Lateral Movement|T1105 - Remote File Copy|https://attack.mitre.org/techniques/T1105|\n|C & C|T1105 - Remote File Copy|https://attack.mitre.org/techniques/T1105|\n\n\n-----\n\n#### Urgent Action.docx 34b53cd683f60800ac4057d25b24d8f083f759d024d22b4e5f2a464bc85de65\n\n smss.exe dcb8531b0879d46949dd63b1ac094f5588c26867805d0795e244f4f9b8077ed\n\n maq.com.pk Domain requested\n\n 203.124.43.227 IP requested\n\n http[:]//maq.com.pk/ HTTP/HTTPS requests\n\n http[:]//maq.com.pk/wehsd HTTP/HTTPS requests\n\n http[:]//maq.com.pk/wehs HTTP/HTTPS requests\n\n http[:]//onlinejohnline99.org/kvs06v.php HTTP/HTTPS requests\n\n onlinejohnline99.org Domain C2\n\n 93.123.73.193 IP C2\n\n 93.123.73.198 IP C2\n\n[This can be exported as JSON format Export in JSON](https://raw.githubusercontent.com/StrangerealIntel/CyberThreatIntel/master/offshore%20APT%20organization/Bitter/27-08-19/IOC_Bitter_31-08-19.json)\n\n## Links\n\n#### Original tweet: https://twitter.com/RedDrip7/status/1164855381052416002\n\n Anyrun Link:\n\n Urgent Action.docx\n\n Docs :\n\n Bitter Analysis by Unit42\n\n Tool for decoding the encoded strings of ArtraDownloader\n\n YARA Rule Bitter Variant1 (August 2019)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        }
    ],
    "references": [
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2019/2019.08.31.Bitter_APT_Malware_analysis/Bitter_APT_Malware_analysis.pdf"
    ],
    "report_names": [
        "Bitter_APT_Malware_analysis"
    ],
    "threat_actors": [
        {
            "id": "bf6cb670-bb69-473f-a220-97ac713fd081",
            "created_at": "2022-10-25T16:07:23.395205Z",
            "updated_at": "2025-03-27T02:02:09.777308Z",
            "deleted_at": null,
            "main_name": "Bitter",
            "aliases": [
                "T-APT-17",
                "TA397"
            ],
            "source_name": "ETDA:Bitter",
            "tools": [
                "Artra Downloader",
                "ArtraDownloader",
                "Bitter RAT",
                "BitterRAT",
                "Dracarys"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "655f7d0b-7ea6-4950-b272-969ab7c27a4b",
            "created_at": "2022-10-27T08:27:13.133291Z",
            "updated_at": "2025-03-27T02:00:55.490812Z",
            "deleted_at": null,
            "main_name": "BITTER",
            "aliases": [
                "T-APT-17"
            ],
            "source_name": "MITRE:BITTER",
            "tools": [
                "ZxxZ"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1666716497,
    "ts_updated_at": 1743041360,
    "ts_creation_date": 1567400470,
    "ts_modification_date": 1567400470,
    "files": {
        "pdf": "https://archive.orkl.eu/ce6de200409d558d88c026c9ab087ed1c836db28.pdf",
        "text": "https://archive.orkl.eu/ce6de200409d558d88c026c9ab087ed1c836db28.txt",
        "img": "https://archive.orkl.eu/ce6de200409d558d88c026c9ab087ed1c836db28.jpg"
    }
}