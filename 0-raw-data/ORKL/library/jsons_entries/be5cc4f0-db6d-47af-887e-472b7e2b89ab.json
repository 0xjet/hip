{
    "id": "be5cc4f0-db6d-47af-887e-472b7e2b89ab",
    "created_at": "2023-01-12T15:00:49.231274Z",
    "updated_at": "2025-03-27T02:09:29.883651Z",
    "deleted_at": null,
    "sha1_hash": "2a37e2c18300dfb6f599bd2fdfa233aa6cb48154",
    "title": "2020-09-01 - DLL Fixer leads to Cyrat Ransomware",
    "authors": "",
    "file_creation_date": "2022-05-28T02:21:50Z",
    "file_modification_date": "2022-05-28T02:21:50Z",
    "file_size": 450850,
    "plain_text": "# DLL Fixer leads to Cyrat Ransomware\n\n**gdatasoftware.com/blog/cyrat-ransomware**\n\nA new ransomware uses an unusual symmetric encryption method named \"Fernet\". It is Python based and appends .CYRAT to encrypted\nfiles.\n\n## Discovery & Initial Analysis\n\n\n-----\n\ne u t g o e a a e e o te use a a u es to d susp c ous sa p es O e o y ge e c a so a e u t u es ou d t s e\nransomware sample. At the time it had only 2 detections on Virustotal. The first submission date is 25. August 2020.\n\n[DiE and](http://ntinfo.biz/index.html) [PortexAnalyzer note that there is a zlib archive in the overlay of the file. Further inspection shows references to the python37.dll and](https://github.com/katjahahn/PortEx/tree/master/progs)\n[the archive's name PYZ-00.pyz which is typical for PyInstaller executables.](https://www.pyinstaller.org/)\n\nIt means Cyrat ransomware was compiled with Python 3.7 and converted to a Windows PE file using PyInstaller.\n\n[Unpacking and decompiling this file requires PyInstxtractor,](https://github.com/extremecoders-re/pyinstxtractor/blob/master/pyinstxtractor.py) [Python 3.7 and, e.g.,](https://www.python.org/downloads/release/python-370/) [uncompyle6. The Python version needs to be the same as](https://pypi.org/project/uncompyle6/)\nthe malware executable while extracting the .pyc files. Otherwise PyInstxtractor has issues properly constructing the files.\n\n## Disguise as DLL fixer\n\n[When I first tried to run the malware it crashed because of a missing fonts for pyfiglet. To see it in action, I had to install pyfiglet and replicate](http://www.figlet.org/)\nthe code that displays the ransomware's output.\n\nThe malware disguises as DLL fixer 2.5 (see image below). Upon execution it will display a randomly created number of corrupted DLLs it\npretends to have found on the system. After the system has been encrypted, a success message for fixing the DLLs is shown.\n\n## Encryption\n\nCyrat ransomware uses Fernet to encrypt files. This is a symmetric encryption method meant for small data files that fit into RAM. While Fernet\nis not unusual itself, it is not common for ransomware and in this case even problematic. This ransomware encrypts whole files regardless how\nbig they are, whereas Fernet is unsuitable for big files.\n\nA public RSA key is used to encrypt the Fernet key. This public key is downloaded from Mediafire instead of shipping it with the ransomware.\nThis adds another dependency. The encrypted Fernet key is saved in Desktop\\EMAIL_US.txt. A user with an infected system is required to\nsend this file to the criminals.\n\nCyrat appends .CYRAT to encrypted files. It has a list of folders that it checks for target files. Those folders are 'Desktop', 'Downloads',\n'Pictures', 'Music', 'Videos', and 'Documents'.\n\nIt targets files with the following extensions: 'doc', 'docx', 'xls', 'xlsx', 'ppt', 'pptx', 'boop', 'pst', 'ost', 'msg', 'eml', 'vsd', 'vsdx', 'txt', 'csv', 'rtf', '123',\n'wks', 'wk1', 'pdf', 'dwg', 'onetoc2', 'snt', 'jpeg', 'jpg', 'docb', 'docm', 'dot', 'dotm', 'dotx', 'xlsm', 'xlsb', 'xlw', 'xlt', 'xlm', 'xlc', 'xltx', 'xltm', 'pptm', 'pot',\n'pps', 'ppsm', 'ppsx', 'ppam', 'potx', 'potm', 'edb', 'hwp', '602', 'sxi', 'sti', 'sldx', 'sldm', 'sldm', 'vdi', 'vmdk', 'vmx', 'gpg', 'aes', 'PAQ', 'bz2', 'tbk', 'bak',\n'tar', 'tgz', 'gz', '7z', 'rar', 'zip', 'backup', 'iso', 'vcd', 'bmp', 'png', 'gif', 'raw', 'tif', 'tiff', 'nef', 'psd', 'ai', 'svg', 'djvu', 'm4u', 'm3u', 'mid', 'wma', 'flv', '3g2',\n'asf', 'mpeg', 'vob', 'mpg', 'swf', 'wav', 'mp3', 'sh', 'class', 'jar', 'java', 'rb', 'asp', 'php', 'jsp', 'brd', 'dch', 'dip', 'pl', 'vb', 'vbs', 'ps1', 'bat', 'cmd', 'asm',\n'h', 'pas', 'c', 'cs', 'suo', 'sln', 'ldf', 'mdf', 'ibd', 'myi', 'myd', 'frm', 'odb', 'dbf', 'db', 'mdb', 'accdb', 'sql', 'sqlitedb', 'sqlite3', 'lay6', 'lay', 'mml', 'sxm',\n'otg', 'odg', 'uop', 'std', 'sxd', 'otp', 'odp', 'wb2', 'slk', 'dif', 'stc', 'sxc', 'ots', 'ods', '3dm', 'max', '3ds', 'uot', 'stw', 'sxw', 'ott', 'odt', 'p12', 'csr', 'key', 'pfx',\n'der', 'deb', 'mpeg', 'WEBM', 'MPG', 'MP2', 'MPEG', 'MPE', 'MPV', 'OGG', '3gp', 'mp3', 'json', 'css', 'html', 'py', 'exe', 'MP2', 'MPEG', 'MPE', 'MPV',\n'OGG', '3gp', 'mp3'\n\n\n-----\n\ne a so a e sts a e o e e te s o s t a dot t e c s a bug C, cpp, cg, js, a, asc, c t, sc ese\nextensions will never be found by Cyrat because the file path is stripped from dots before it is compared with the target extension.\n\nA ransom note named RANSOME_NOTE.txt is placed in every target folder. Furthermore a ransomware stock photo is downloaded from\n**images.idgesg.net to Documents\\background_img.png and set as wallpaper. The wallpaper does not contain any ransom message. In this**\nstate the stock photo's only purpose is to draw attention to the user.\n\nCyrat sets this stock photo as wallpaper\n\nCyrat's ransom note (click to enlarge)\n\n## Registry Changes and Persistence\n\nThe ransomware deletes shadow volume copies and disables CMD, taskmanager, regstry tools via policy settings in the registry. It also\nremoves the RUN command from the start menu and task manager. It uses bcedit to set recoveryenabled to No and bootstatuspolicy to\n**ignoreallfailures**\n\nFor persistence Cyrat copies itself to the autostart folder \\AppData\\Roaming\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\n\nA reboot of the system, and thus re-run of the rasomware, will most likely encrypt the ransom notes. I did not find any safeguard in the code to\nprevent this from happening.\n\n## Target Platforms\n\n\n-----\n\ne ta get p at o s u doubted y do s because t e y sta e e ecutab e o y o s t e e e t oja ed e o y u e\nWindows users. Registry commands and persistence mechanisms are also Windows based.\n\nOddly, there are also checks for Linux and Darwin (core of many Apple operating systems) in the main body without any changes in the\nfollowing code which is still Windows targeted.\n\n## Contacting the Threat Actor(s)\n\n[After I posted the Cyrat sample on Twitter, another Twitter user, who wants to be referred to as alex27, contacted the ransomware crook(s). He](https://twitter.com/struppigel/status/1298592057087361030)\nasked them for decryption and shared their email exchange with me. This shows that the threat actor(s) are expecting help requests from\naffected users, and thus, actively distributing the malware.\n\nWe got your message, calm down your files are safe you will only get them back if you obey and follow the instruction. You know about\nbitcoin now? Did The page we put there to help you get bitcoin help? If no you can use google and find how to get bitcoin in your country\nand get $1,000 worth of bitcoin sent to this bitcoin address: <redacted> Your two days count start now, we have full access to your\ncomputer and we know you are reading this now. $500 will be added each day once the two days elapse and you didn't make payment\nfor the decryptor. Don't think we won't delete those files if we don't hear from you because we will.\n\nI redacted the bitcoin address because it is likely individually created for every case. It has currently no transactions. alex27 pointed out that\ntheir responses as well as the ransom note contain many grammar mistakes, making it unlikely that the author is a native English speaker.\n\n## Conclusion\n\nAs it is often the case with brand new malware discoveries, this sample is buggy and not yet ready to infect any system because it crashes in\nit's current state. However, the threat actor's reply shows they are active and might have already published versions that work. It's usually just\na matter of time until those flaws are fixed. The problematic choice of the Fernet encryption method may take its toll on systems while they try\nto encrypt gigabyte sized files in RAM all at once.\n\nSome parts of the code show an intention of also infecting Darwin and Linux systems, which may be added later on.\n\nUnfortunately, there is currently no known way to decrypt files without the key.\n\n## Indicators of Compromise\n\n**Description** **Filename** **Hash/URL**\n\n\nRansomware\nexecutable\n\n\nNA 4b76ad80e9ce4c503bde0e476a88447426fc38315d440d22926627295e1b0ec6\n\n\nRansomnote RANSOME_NOTE.txt generated per execution\n\n\nRSA public\nkey\n\nRaw/plain\nFernet key\nfile\n\nEncrypted\nFernet key\nfile\n\n\n\\Documents\\pub_key.pem hxxp://download1582.mediafire.com/c91ywpc4l7ag/xj26578psz6n9xo/public_key.pem\n\n\\Documents\\key.txt generated per execution\n\nEMAIL_US.txt generated per execution\n\n\nWallpaper \\Documents\\background_img.png hxxps://images.idgesg.net/images/article/2020/05/ransomware_attack_worried_businessman\n1199291222_cso_2400x1600-100840844-large.jpg\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2020/2020-09-01 - DLL Fixer leads to Cyrat Ransomware.pdf"
    ],
    "report_names": [
        "2020-09-01 - DLL Fixer leads to Cyrat Ransomware.pdf"
    ],
    "threat_actors": [
        {
            "id": "aa73cd6a-868c-4ae4-a5b2-7cb2c5ad1e9d",
            "created_at": "2022-10-25T16:07:24.139848Z",
            "updated_at": "2025-03-27T02:02:10.120505Z",
            "deleted_at": null,
            "main_name": "Safe",
            "aliases": [],
            "source_name": "ETDA:Safe",
            "tools": [
                "DebugView",
                "LZ77",
                "OpenDoc",
                "SafeDisk",
                "TypeConfig",
                "UPXShell",
                "UsbDoc",
                "UsbExe"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535649,
    "ts_updated_at": 1743041369,
    "ts_creation_date": 1653704510,
    "ts_modification_date": 1653704510,
    "files": {
        "pdf": "https://archive.orkl.eu/2a37e2c18300dfb6f599bd2fdfa233aa6cb48154.pdf",
        "text": "https://archive.orkl.eu/2a37e2c18300dfb6f599bd2fdfa233aa6cb48154.txt",
        "img": "https://archive.orkl.eu/2a37e2c18300dfb6f599bd2fdfa233aa6cb48154.jpg"
    }
}