{
    "id": "442f3878-a4ee-4ed2-8c0e-e9937dfc07fe",
    "created_at": "2023-01-12T15:05:19.637797Z",
    "updated_at": "2025-03-27T02:06:06.958042Z",
    "deleted_at": null,
    "sha1_hash": "dc64db4fab1bcf0e458880a4f27d51e0149dce91",
    "title": "2017-06-09 - Another Banker Enters the Matrix",
    "authors": "",
    "file_creation_date": "2022-05-28T19:10:26Z",
    "file_modification_date": "2022-05-28T19:10:26Z",
    "file_size": 442717,
    "plain_text": "# Another Banker Enters the Matrix\n\n**[arbornetworks.com/blog/asert/another-banker-enters-matrix/](https://www.arbornetworks.com/blog/asert/another-banker-enters-matrix/)**\n\n\n-----\n\nAnother Banker Enters the Matrix\n\n\nby [ASERT Team on June 9th, 2017](https://www.netscout.com/blog/asert/asert-team)\nThis post takes a look at a new banking malware that has, so far, been targeting financial\ninstitutions in Latin America—specifically, Mexico and Peru. Initially, we’ve called it “Matrix\nBanker” based on its command and control (C2) login panel, but it seems that “Matrix Admin”\n[is a template available for the Bootstrap web framework. Proofpoint calls it](https://www.proofpoint.com/us/daily-ruleset-update-summary-20161108)\n“Win32/RediModiUpd” based on a debugging string from an earlier sample.\n\nThe malware is under active development, but as with some of the other banking trojans\nwe’ve analyzed, it’s difficult to assess how far and wide this threat will go while it’s still so\n[new. Will it become a persistent threat like Panda Banker or have a fate more like Nuclear](http://asert.arbornetworks.com/let-pandas-zeus-zeus-zeus-zeus/)\nBot?\n\n## Samples\n\n[The sample analyzed for this post is available on VirusTotal. It was compiled on 2017-05-26](https://www.virustotal.com/en/file/997544ba1db9c28d8552801411a4ca29ef321347e6912c562d4bfb35f3dd4bb9/analysis/)\nand has the following PDB debugging string:\n```\nC:\\Users\\W7\\Downloads\\Project\\Bin\\Loader.pd\n\n```\n**The Matrix Loaded**\n\n\n-----\n\nAs suggested by the PDB string, the sample starts off as a loader. It performs the following\ntasks:\n\nCreates a “LoaderMutex” mutex\nSets up Registry Run persistence using “GITSecureService” as the value name.\nExtracts a 32-bit and 64-bit DLL named “main_32.dll / main_64.dll” from a resource\nnamed “BINARY”.\n[Using the “ReflectiveLoader” technique and code, injects the appropriate DLL into](http://www.securiteam.com/securityreviews/6P0050KN5U.html)\nchrome.exe, firefox.exe, iexplore.exe, or microsoftedgecp.exe.\n\nMain DLLOnce the main DLL is injected in a browser, it starts by hooking the appropriate\n[browser functions (e.g. PR_Read and PR_Write for Firefox) to setup a “man-in-the-browser”](https://en.wikipedia.org/wiki/Man-in-the-browser)\n(MitB).\n\nIt then phones home to its C2 server to get the webinject config. The request looks like this:\n\n\n-----\n\nThe URI path and file are hardcoded, but we’ve seen other paths in other samples. “uuid” is\nrandomly generated and “country” is currently left blank—though there is placeholder code\nfor it.\n\n[Responses from the C2 are hex encoded and encrypted using the Salsa20 crypto algorithm.](https://en.wikipedia.org/wiki/Salsa20)\nThis is the first malware family that we’ve seen that uses this algorithm. The following Python\nsnippet decrypts the response:\n\n\n-----\n\n```\nimport sys# https://pypi.python.org/pypi/salsa20/0.3.0\nimport salsa20\nfp = open(sys.argv[1], \"rb\")\ndata = fp.read()\nfp.close()\niv = \"K\\x84\\x8eH\\xf1]E\\xa5\"\nkey =\n\"\\xa1\\x9cA\\x89\\xb4\\x9d\\x15ae\\xf1a\\x8bLQj\\x16\\xf1l\\x18\\x1d\\x81\\xb8\\x18\\x18\\xe1\\x81e\\x1c\ndata_nohex = data.replace(\"\\n\", \"\").decode(\"hex\")\nplain = salsa20.Salsa20_xor(data_nohex, iv, key)\nprint plain\n\n```\nSo far the key and initialization vector (IV) have been the same for all the samples we’ve\nanalyzed. An example webinject config looks like this:\n\nWhile functional, the webinject format looks to be under construction. Earlier samples use a\ndifferent, simpler format and there is plenty of work to do to catch up with the industry\nstandard Zeus webinjects. Rules are “\\n” separated and there are two types: “rule1” and\n“rule2”. So far we’ve only seen “rule2”s. The targeted financial institution is specified in\n“targeturl”. The rest of the pieces, which are “&br&” delimited, are eventually concatenated\ntogether and injected into the page if the browser visits a targeted URL.\n\nIn this example the code that is injected is a HTML and JavaScript redirect that automatically\nredirects the browser to a phishing page hosted on “llinea[.]com” that looks exactly like the\ntargeted financial institution. Hoping the victim doesn’t notice the redirect, the threat actor will\nharvest the victim’s banking credentials.\n\n## Campaign\n\nPer VirusTotal, the analyzed sample was first seen in the wild on 2017-05-29 and being\ndistributed by the following sites:\n\nhxxp://neext[.]com[.]mx/Loader.exe\nhxxp://notaria94[.]com[.]mx/real.exe\n\nFurthermore we can link the second drop site to an instance of Beta Bot (available on\n[VirusTotal) and see it dropping Matrix Banker. The two malwares also share a common C2](https://www.virustotal.com/en/file/eb483d4f8c71a234f70b490bb38d841c72453ed5c9bb0049d9affd2afe41cf23/analysis/)\nserver, trtr44[.]cat.\n\n\n-----\n\n## Conclusion\n\nThis post has been a quick analysis of a new banking malware currently targeting countries\nin Latin America. It is too soon to assess how active and widespread this new family will\nbecome, but it is actively being developed and targeting financial institutions in the wild.\n\nPosted In\n\nAnalysis\nBotnets\nEncryption\nInteresting Research\nMalware\nReverse Engineering\nthreat analysis\n\n## Subscribe\n\n_Sign up now to receive the latest notifications and updates from NETSCOUT's ASERT._\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2017/2017-06-09 - Another Banker Enters the Matrix.pdf"
    ],
    "report_names": [
        "2017-06-09 - Another Banker Enters the Matrix.pdf"
    ],
    "threat_actors": [
        {
            "id": "e3767160-695d-4360-8b2e-d5274db3f7cd",
            "created_at": "2022-10-25T16:47:55.914348Z",
            "updated_at": "2025-03-27T02:05:17.411172Z",
            "deleted_at": null,
            "main_name": "IRON TWILIGHT",
            "aliases": [
                "ATK5 ",
                "Blue Athena ",
                "BlueDelta ",
                "FROZENLAKE ",
                "Fancy Bear ",
                "Fighting Ursa ",
                "Forest Blizzard ",
                "GRAPHITE ",
                "Group 74 ",
                "PawnStorm ",
                "STRONTIUM ",
                "Sednit ",
                "Snakemackerel ",
                "Sofacy ",
                "TG-4127 ",
                "Tsar Team ",
                "APT28 "
            ],
            "source_name": "Secureworks:IRON TWILIGHT",
            "tools": [
                " Downdelph",
                " Drovorub",
                " EVILTOSS",
                " HIDEDRV",
                " Headlace",
                " LoJack",
                " Powershell Empire",
                " SCONATO",
                " SEDUPLOADER",
                " SHARPFRONT",
                " Scaramouche",
                " Sedkit Exploit Kit",
                " Sofacy downloader",
                " X-Agent",
                " X-Tunnel",
                " Zebrocy",
                " reGeorg",
                "DEALERSCHOICE"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "ae320ed7-9a63-42ed-944b-44ada7313495",
            "created_at": "2022-10-25T15:50:23.671663Z",
            "updated_at": "2025-03-27T02:00:55.518748Z",
            "deleted_at": null,
            "main_name": "APT28",
            "aliases": [
                "APT28",
                "IRON TWILIGHT",
                "SNAKEMACKEREL",
                "Group 74",
                "Sednit",
                "Sofacy",
                "Pawn Storm",
                "Fancy Bear",
                "STRONTIUM",
                "Tsar Team",
                "Threat Group-4127",
                "TG-4127",
                "Forest Blizzard",
                "FROZENLAKE"
            ],
            "source_name": "MITRE:APT28",
            "tools": [
                "Wevtutil",
                "certutil",
                "Forfiles",
                "DealersChoice",
                "Mimikatz",
                "ADVSTORESHELL",
                "Komplex",
                "HIDEDRV",
                "JHUHUGIT",
                "Koadic",
                "Winexe",
                "XTunnel",
                "Drovorub",
                "CORESHELL",
                "OLDBAIT",
                "Downdelph",
                "XAgentOSX",
                "USBStealer",
                "Zebrocy",
                "Fysbis",
                "LoJax"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "d2516b8e-e74f-490d-8a15-43ad6763c7ab",
            "created_at": "2022-10-25T16:07:24.212584Z",
            "updated_at": "2025-03-27T02:02:10.141001Z",
            "deleted_at": null,
            "main_name": "Sofacy",
            "aliases": [
                "APT 28",
                "ATK 5",
                "Blue Athena",
                "BlueDelta",
                "FROZENLAKE",
                "Fancy Bear",
                "Fighting Ursa",
                "Forest Blizzard",
                "Grey-Cloud",
                "Grizzly Steppe",
                "Group 74",
                "GruesomeLarch",
                "ITG05",
                "Iron Twilight",
                "Operation DealersChoice",
                "Operation Dear Joohn",
                "Operation Komplex",
                "Operation Pawn Storm",
                "Operation Russian Doll",
                "Operation Steal-It",
                "Pawn Storm",
                "SIG40",
                "Sednit",
                "Snakemackerel",
                "Sofacy",
                "Strontium",
                "T-APT-12",
                "TA422",
                "TAG-0700",
                "TAG-110",
                "TG-4127",
                "Tsar Team",
                "UAC-0028",
                "UAC-0063"
            ],
            "source_name": "ETDA:Sofacy",
            "tools": [
                "ADVSTORESHELL",
                "AZZY",
                "Backdoor.SofacyX",
                "CHERRYSPY",
                "CORESHELL",
                "Carberp",
                "Computrace",
                "DealersChoice",
                "Delphacy",
                "Downdelph",
                "Downrage",
                "Drovorub",
                "EVILTOSS",
                "Foozer",
                "GAMEFISH",
                "GooseEgg",
                "Graphite",
                "HATVIBE",
                "HIDEDRV",
                "Headlace",
                "Impacket",
                "JHUHUGIT",
                "JKEYSKW",
                "Koadic",
                "Komplex",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "LoJack",
                "LoJax",
                "MASEPIE",
                "Mimikatz",
                "NETUI",
                "Nimcy",
                "OCEANMAP",
                "OLDBAIT",
                "PocoDown",
                "PocoDownloader",
                "Popr-d30",
                "ProcDump",
                "PythocyDbg",
                "SMBExec",
                "SOURFACE",
                "SPLM",
                "STEELHOOK",
                "Sasfis",
                "Sedkit",
                "Sednit",
                "Sedreco",
                "Seduploader",
                "Shunnael",
                "SkinnyBoy",
                "Sofacy",
                "SofacyCarberp",
                "SpiderLabs Responder",
                "Trojan.Shunnael",
                "Trojan.Sofacy",
                "USB Stealer",
                "USBStealer",
                "VPNFilter",
                "Win32/USBStealer",
                "WinIDS",
                "Winexe",
                "X-Agent",
                "X-Tunnel",
                "XAPS",
                "XTunnel",
                "Xagent",
                "Zebrocy",
                "Zekapab",
                "carberplike",
                "certutil",
                "certutil.exe",
                "fysbis",
                "webhp"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535919,
    "ts_updated_at": 1743041166,
    "ts_creation_date": 1653765026,
    "ts_modification_date": 1653765026,
    "files": {
        "pdf": "https://archive.orkl.eu/dc64db4fab1bcf0e458880a4f27d51e0149dce91.pdf",
        "text": "https://archive.orkl.eu/dc64db4fab1bcf0e458880a4f27d51e0149dce91.txt",
        "img": "https://archive.orkl.eu/dc64db4fab1bcf0e458880a4f27d51e0149dce91.jpg"
    }
}