{
    "id": "27ba0248-35ba-40b8-82b4-2062a74f1cde",
    "created_at": "2023-01-12T14:58:53.748657Z",
    "updated_at": "2025-03-27T02:17:02.268222Z",
    "deleted_at": null,
    "sha1_hash": "c9efe05ca355596e16b465b89f171bfe5e2715c6",
    "title": "2019-02-19 - 攻撃グループTickによる日本の組織をターゲットにした攻撃活動",
    "authors": "",
    "file_creation_date": "2022-05-28T23:44:22Z",
    "file_modification_date": "2022-05-28T23:44:22Z",
    "file_size": 3572107,
    "plain_text": "# 攻撃グループTickによる日本の組織をターゲットにした攻 撃活動 - JPCERT/CC Eyes | JPCERTコーディネーションセ ンター公式ブログ\n\n**blogs.jpcert.or.jp/ja/2019/02/tick-activity.html**\n\n朝長 [秀誠 (Shusei Tomonaga)](https://blogs.jpcert.or.jp/ja/shu_tom/)\n\n2019/02/19\n\n## 攻撃グループTickによる日本の組織をターゲットにした攻撃活動\n\n[Datper](https://blogs.jpcert.or.jp/ja/tags/datper/)\n\n[メール](http://10.10.0.46/mailto:?subject=%E6%94%BB%E6%92%83%E3%82%B0%E3%83%AB%E3%83%BC%E3%83%97Tick%E3%81%AB%E3%82%88%E3%82%8B%E6%97%A5%E6%9C%AC%E3%81%AE%E7%B5%84%E7%B9%94%E3%82%92%E3%82%BF%E3%83%BC%E3%82%B2%E3%83%83%E3%83%88%E3%81%AB%E3%81%97%E3%81%9F%E6%94%BB%E6%92%83%E6%B4%BB%E5%8B%95&body=https%3A%2F%2Fblogs.jpcert.or.jp%2Fja%2F2019%2F02%2Ftick-activity.html)\n\n[以前のJPCERT/CC Eyesで攻撃グループTick[1] (BRONZE BUTLER[2]とも呼ばれる) が使用](https://blogs.jpcert.or.jp/ja/2017/08/datper.html)\nしていると考えられるマルウエアDatperについて紹介しましたが、この攻撃グループに関連\nすると考えられる攻撃は現在も継続しています。2018年以降、JPCERT/CCにて確認してい\nる攻撃は以下の2つです。\n\n標的型攻撃メールによるDatperの感染\n資産管理ソフトウエアの脆弱性を悪用する攻撃\n\n今回は、上記2つの攻撃から確認した新たな特徴について紹介します。\n\n### 標的型攻撃メールによるDatperの感染\n\n2017年頃までは、ドライブバイダウンロード攻撃でDatperに感染する事例を多く確認して\nいました。2018年以降は感染経路が変化し、標的型攻撃メールに添付されたPPTファイルな\nどの不正なドキュメントファイルから感染する事例を複数確認しています。\n\n最近のDatperは以前のものと比べて通信方式が変更されています。以下に通信内容の例を示\nします。\n\n\n-----\n\n```\nGET /hp.php?\nhmlrqmvm=kl818612rn3298l844d1538jca5hx8sz6k342z41c82k0t3zr6tbvp6c3st3b4mz7ben\nHTTP/1.1\nAccept: */*\nContent-Type: application/x-www-form-urlencoded\nUser-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; rv:11.0) like Gecko\nHost: 211.233.81.242\nCache-Control: no-cache\n\n```\nURLパラメータの値として暗号化したデータを送信することは変わっていませんが、通信の\n暗号化方式にRSA暗号を使用するように変更されています。表1は2018年3月以前と最近の\n検体の通信方式の比較です。\n\n表 1: Datperの通信圧縮方式と暗号方式の一覧\n\n時期 圧縮方式 暗号化方式 エンコード方式\n\n2018/2以前 LZRW1/KH XOR + RC4 Base64(変則table)\n\n2018/3以降 LZRW1/KH XOR + RC4 + RSA Base64(変則table)\n\n以前のDatperでは、固定のRC4キーを使っていたため、マルウエアを分析しRC4キーを特定\nすれば通信データを復号することができました。対して、最近のDatperは実行毎に作成する\nランダムなRC4キーを使って通信を暗号化しています。作成されたランダムなRC4キーはサ\nーバとの最初の通信でRSA暗号化した上で送信されます。そのため、RSAの秘密鍵がなけれ\nばRC4キーを知ることができず、通信を復号することができません。\n\nなお、RSAに使用するExponentとModulusは検体の設定情報に含まれています。(設定情報\nについては、Appendix Aをご覧ください。)以下は、設定情報に含まれているModulusと\nExponentの例です。\n```\naiaA$csh0h5882A+wNmRsyknDQsi7La6IT=YD8gRDJf8ZXhcvPb66TW54vucxYRfDbdnidbgs1fCLMS1\npU8ZPMtHSutpqw8dPbG=LJR9rQ9ezkBxQ0fv4GGTesBPb1kty01rhhHDMQj5K4I369LUF8Xmdqq2nmJi\n69KfTQFLy135=+3Te4v1vyEyl9Afbu8AOAit19qj5R46jQ5Y9TwEcmfw7=3G4KSxmkwei=5=OHqPgqA\nqpgvcwlTcAgnGhvJLrQyzpPUiC2KSNL4F6lT7GZQ8jo2JR\n\n```\n“$”を挟んで、前半(赤文字)がExponentで後半(青文字)がModulusの値をそれぞれBase64(変\n則table)でエンコードしています。\n\n### 資産管理ソフトウエアの脆弱性を悪用する攻撃\n\n2017年6月にSecureWorks社から公開された資産管理ソフトウエアの脆弱性を悪用する攻撃\n\n[2]は、現在も継続しています。図1は、本脆弱性を悪用しようとするスキャン通信をインタ\nーネット定点観測システム(TSUBAME)で観測した状況を示しています。2017年10月頃から\n一時的に攻撃は収まっていましたが、2018年3月15日から攻撃が再開しています。なお、悪\n\n\n-----\n\n用される脆弱性に変化はありません。また、このスキャン活動は日本のセンサーのみで観測\nされており、攻撃者は日本のIPアドレスレンジを中心に攻撃をしようとしていると考えられ\nます。\n\n図 1：資産管理ソフトウエアの脆弱性を悪用しようとするスキャン観測状況(TSUBAMEの観\n測データ: 2017年1月1日～2019年2月7日)\n\n2018年3月以前、攻撃者はこの脆弱性を悪用してxxmmやDatperの感染を行っていました\nが、現在は別のマルウエアの感染を試みています。 新たなマルウエアはJavaScriptで作成さ\nれており、Node.jsを使って動作します。以下はこの攻撃によってマルウエア感染が行われ\nた際に作成されるファイルの一覧です。\n\n表 2: 感染時に作成されるファイル\n\nファイルおよびフォルダ名 説明\n\napp.js マルウエア本体\n\nnode.exe Node.js\n\nflash.vbs app.jsを実行するスクリプト\n\nconfig\\.regeditKey.rc レジストリエントリ登録情報\n\nconfig\\app.json 通信先情報\n\nconfig\\auto.json 設定情報一次保存ファイル\n\ntools\\getProxy.exe Proxy情報取得ツール\n\ntools\\uninstaller.exe アンインストール用\n\n\n-----\n\n※ すべてのファイルおよびフォルダは%APPDATA%\\Adobe\\flash\\[ランダムな4文字の英数\n字]\\bin配下に作成されます。\n\nマルウエア本体となるapp.jsは、node.exe (Node.js)に読み込まれることで実行されます。こ\nのマルウエアはC&Cサーバとの通信をWebSocketで行います。以下はマルウエアが行う最\n初の通信の例です。\n```\nGET / HTTP/1.1\nSec-WebSocket-Version: 13\nSec-WebSocket-Key: R0bGJIMgRhG6p5Tj8bKBRQ==\nConnection: Upgrade\nUpgrade: websocket\nHost: www.rakutenline.com:443\n\n```\nマルウエアがリモートから命令を受信すると、以下の命令を実行する可能性があります。\n\n任意のコマンドの実行\nファイルのアップロード・ダウンロード\n感染したホストの情報送信\n\nなお、このapp.jsはNode.jsがインストールされている環境であれば、動作することが可能な\nマルチプラットフォーム対応型のマルウエアです。攻撃者は、Windows OSだけではなく\nmacOSなども攻撃のターゲットにしていると考えられます。図2は、実行環境に合わせて実\n行するコマンドを変えているソースコードの例です。\n\n図 2：app.jsのソースコード\n\n### おわりに\n\n\n-----\n\n攻撃者は引き続き、日本の組織に対して攻撃を続けています。今後もこのような攻撃は続く\nと考えられるため、注意が必要です。該当の資産管理ソフトウエアを使用している場合はア\nップデートすることを推奨します。[3]\n\n今回解説した検体のハッシュ値に関しては、Appendix Bに記載しています。また、\nJPCERT/CCで確認している本件に関係する通信先の一部はAppendix Cに記載していますの\nで、このような通信先にアクセスしている端末がないかご確認ください。\n\n参考情報\n\n[1] Symantec: 日本を狙い始めたサイバースパイグループ「Tick」\n\n[https://www.symantec.com/connect/ja/blogs/tick](https://www.symantec.com/connect/ja/blogs/tick)\n\n[2] SecureWorks: 日本企業を狙う高度なサイバー攻撃の全貌 – BRONZE BUTLER\n\n[https://www.secureworks.jp/resources/rp-bronze-butler](https://www.secureworks.jp/resources/rp-bronze-butler)\n\n[3]JPCERT/CC: SKYSEA Client View の脆弱性 (CVE-2016-7836) に関する注意喚起\n\n[https://www.jpcert.or.jp/at/2016/at160051.html](https://www.jpcert.or.jp/at/2016/at160051.html)\n\n**Appendix A: Datperの設定情報**\n\n表 3: Datperの設定情報一覧\n\nIDX 内容\n\n1 ID\n\n2 URL\n\n3 Sleep Time (s)\n\n4 Mutex\n\n5 Proxy Server\n\n6 Proxy Port\n\n7 Proxy User Name\n\n8 Proxy Password\n\n9 Start Time (h)\n\n10 End Time (h)\n\n11 Unknown\n\n12 User Agent\n\n13 RSA Modulus / Exponent\n\n\n-----\n\n**Appendix B: 検体のSHA-256ハッシュ値**\n\napp.js\n\nf36db81d384e3c821b496c8faf35a61446635f38a57d04bde0b3dfd19b674587\nf71a3a772f4316ab3c940f94aab3d52eabe7ee9da311b112a12eacfcadddb85e\n\ngetProxy.exe\n\nc6cf0ad6d1e687b185407ee450a5b8e9a8ab60461f5c051251badb245df6245f\n\nuninstaller.exe\n\nd1617e7ec278484920c05476eabf783d399d6c03e8d8ab69e2f1fcb6a76417b4\n\nDatper\n\n6530f94ac6d5b7b1da6b881aeb5df078fcc3ebffd3e2ba37585a37b881cde7d3\ne38d3a7a86a72517b6ebea89cfd312db0f433385a33d87f2ec8bf83a62396bb3\nd91894e366bb1a8362f62c243b8d6e4055a465a7f59327089fa041fe8e65ce30\na7adfd0258e40d4df8cbc2ad7a660fd1c73f8dc2b9a4becc585a712cb5cfa9f1\n569ceec6ff588ef343d6cb667acf0379b8bc2d510eda11416a9d3589ff184189\n517b2695bbf7164bfb9cab0a133bb0b1aeb387cbb7f30aa01bf5d6f89cca4214\nc2e87e5c0ed40806949628ab7d66caaf4be06cab997b78a46f096e53a6f49ffc\n4d4ad53fd47c2cc7338fab0de5bbba7cf45ee3d1d947a1942a93045317ed7b49\n4dc63bc7bd8bcc758a75f48d573bcea62444db41f6d3bce7c1202265340ab577\n\n**Appendix C: 通信先一覧**\n\nwww.rakutenline.com\nmenu.rakutenline.com\nwww.sa-guard.com\nmenu.sa-guard.com\nwww.han-game.com\nmenu.han-game.com\n211.233.81.242\nwww.aromatictree.co.kr\nrp.thumbbay.com\n110.45.203.133\nwww.amamihanahana.com\n61.106.60.47\nwww.kdcnet.co.kr\n\n[メール](http://10.10.0.46/mailto:?subject=%E6%94%BB%E6%92%83%E3%82%B0%E3%83%AB%E3%83%BC%E3%83%97Tick%E3%81%AB%E3%82%88%E3%82%8B%E6%97%A5%E6%9C%AC%E3%81%AE%E7%B5%84%E7%B9%94%E3%82%92%E3%82%BF%E3%83%BC%E3%82%B2%E3%83%83%E3%83%88%E3%81%AB%E3%81%97%E3%81%9F%E6%94%BB%E6%92%83%E6%B4%BB%E5%8B%95&body=https%3A%2F%2Fblogs.jpcert.or.jp%2Fja%2F2019%2F02%2Ftick-activity.html)\n\nこの記事の筆者\n\n\n-----\n\n朝長 [秀誠 (Shusei Tomonaga)](https://blogs.jpcert.or.jp/ja/shu_tom/)\n\n外資系ITベンダーでのセキュリティ監視・分析業務を経て、2012年12月から現職。現在\nは、マルウェア分析・フォレンジック調査に従事。主に、標的型攻撃に関するインシデント\n分析を行っている。CODE BLUE、BsidesLV、BlackHat USA Arsenal、Botconf、PacSec、\nFIRSTなどで講演。JSACオーガナイザー。\n\nこのページは役に立ちましたか？\n\n0人が「このページが役に立った」と言っています。\n\nその他、ご意見・ご感想などございましたら、ご記入ください。\n\nこちらはご意見・ご感想用のフォームです。各社製品については、各社へお問い合わせくだ\nさい。\n\njavascriptを有効にすると、ご回答いただけます。 ありがとうございました。\n\n## 関連記事\n\nHUI Loaderの分析\n\nAnti-UPX Unpackingテクニック\n\n\n-----\n\nモバイル端末を狙うマルウェアへの対応FAQ\n\n攻撃グループLuoYuが使用するマルウェアWinDealer\n\n攻撃グループBlackTechが使用するマルウェアGh0stTimes\n\n≪ [前へ](https://blogs.jpcert.or.jp/ja/2019/02/cert-vncert-ais22.html)\n[トップに戻る](https://blogs.jpcert.or.jp/ja/)\n[次へ](https://blogs.jpcert.or.jp/ja/2019/04/csirt-1.html) ≫\n\n## ライター\n\n\n-----\n\n-----\n\n-----",
    "language": "JA",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2019/2019-02-19 - 攻撃グループTickによる日本の組織をターゲットにした攻撃活動.pdf"
    ],
    "report_names": [
        "2019-02-19 - 攻撃グループTickによる日本の組織をターゲットにした攻撃活動.pdf"
    ],
    "threat_actors": [
        {
            "id": "2646f776-792a-4498-967b-ec0d3498fdf1",
            "created_at": "2022-10-25T15:50:23.475784Z",
            "updated_at": "2025-03-27T02:00:55.479958Z",
            "deleted_at": null,
            "main_name": "BlackTech",
            "aliases": [
                "BlackTech",
                "Palmerworm"
            ],
            "source_name": "MITRE:BlackTech",
            "tools": [
                "Kivars",
                "PsExec",
                "TSCookie",
                "Flagpro",
                "Waterbear"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "d3a7123c-f519-49a0-a234-de24a1ef052a",
            "created_at": "2022-10-25T16:47:55.545211Z",
            "updated_at": "2025-03-27T02:05:17.254744Z",
            "deleted_at": null,
            "main_name": "BRONZE CANAL",
            "aliases": [
                "CTG-6177 ",
                "Circuit Panda ",
                "Palmerworm ",
                "Shrouded Crossbow ",
                "BlackTech"
            ],
            "source_name": "Secureworks:BRONZE CANAL",
            "tools": [
                " DRIGO",
                " Flagpro",
                " Gh0stTimes",
                " PLEAD",
                " Spiderpig",
                " Waterbear",
                "Bifrose"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "75024aad-424b-449a-b286-352fe9226bcb",
            "created_at": "2023-01-06T13:46:38.962724Z",
            "updated_at": "2025-03-27T02:00:02.964002Z",
            "deleted_at": null,
            "main_name": "BlackTech",
            "aliases": [
                "CIRCUIT PANDA",
                "Temp.Overboard",
                "G0098",
                "Red Djinn",
                "HUAPI",
                "Palmerworm",
                "T-APT-03",
                "Manga Taurus",
                "Earth Hundun"
            ],
            "source_name": "MISPGALAXY:BlackTech",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "f8dddd06-da24-4184-9e24-4c22bdd1cbbf",
            "created_at": "2023-01-06T13:46:38.626906Z",
            "updated_at": "2025-03-27T02:00:02.877001Z",
            "deleted_at": null,
            "main_name": "Tick",
            "aliases": [
                "Stalker Taurus",
                "PLA Unit 61419",
                "Nian",
                "BRONZE BUTLER",
                "REDBALDKNIGHT",
                "STALKER PANDA",
                "G0060"
            ],
            "source_name": "MISPGALAXY:Tick",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "bbefc37d-475c-4d4d-b80b-7a55f896de82",
            "created_at": "2022-10-25T15:50:23.571783Z",
            "updated_at": "2025-03-27T02:00:55.502112Z",
            "deleted_at": null,
            "main_name": "BRONZE BUTLER",
            "aliases": [
                "BRONZE BUTLER",
                "REDBALDKNIGHT"
            ],
            "source_name": "MITRE:BRONZE BUTLER",
            "tools": [
                "Mimikatz",
                "build_downer",
                "cmd",
                "ABK",
                "at",
                "BBK",
                "schtasks",
                "down_new",
                "Daserf",
                "ShadowPad",
                "Windows Credential Editor",
                "gsecdump"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "efa7c047-b61c-4598-96d5-e00d01dec96b",
            "created_at": "2022-10-25T16:07:23.404442Z",
            "updated_at": "2025-03-27T02:02:09.781478Z",
            "deleted_at": null,
            "main_name": "BlackTech",
            "aliases": [
                "BlackTech",
                "Circuit Panda",
                "Earth Hundun",
                "Manga Taurus",
                "Operation PLEAD",
                "Operation Shrouded Crossbow",
                "Operation Waterbear",
                "Palmerworm",
                "Radio Panda",
                "Red Djinn",
                "T-APT-03",
                "TEMP.Overboard"
            ],
            "source_name": "ETDA:BlackTech",
            "tools": [
                "BIFROST",
                "BUSYICE",
                "BendyBear",
                "Bluether",
                "CAPGELD",
                "DRIGO",
                "Deuterbear",
                "Flagpro",
                "GOODTIMES",
                "Gh0stTimes",
                "IconDown",
                "KIVARS",
                "LOLBAS",
                "LOLBins",
                "Linopid",
                "Living off the Land",
                "TSCookie",
                "Waterbear",
                "XBOW",
                "elf.bifrose"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "d4e7cd9a-2290-4f89-a645-85b9a46d004b",
            "created_at": "2022-10-25T16:07:23.419513Z",
            "updated_at": "2025-03-27T02:02:09.790389Z",
            "deleted_at": null,
            "main_name": "Bronze Butler",
            "aliases": [
                "Bronze Butler",
                "CTG-2006",
                "Operation ENDTRADE",
                "RedBaldNight",
                "Stalker Panda",
                "Stalker Taurus",
                "TEMP.Tick",
                "Tick"
            ],
            "source_name": "ETDA:Bronze Butler",
            "tools": [
                "8.t Dropper",
                "8.t RTF exploit builder",
                "8t_dropper",
                "9002 RAT",
                "AngryRebel",
                "Blogspot",
                "Daserf",
                "Datper",
                "Elirks",
                "Farfli",
                "Gh0st RAT",
                "Ghost RAT",
                "HOMEUNIX",
                "HidraQ",
                "HomamDownloader",
                "Homux",
                "Hydraq",
                "Lilith",
                "Lilith RAT",
                "McRAT",
                "MdmBot",
                "Mimikatz",
                "Minzen",
                "Moudour",
                "Muirim",
                "Mydoor",
                "Nioupale",
                "PCRat",
                "POISONPLUG.SHADOW",
                "Roarur",
                "RoyalRoad",
                "ShadowPad Winnti",
                "ShadowWali",
                "ShadowWalker",
                "SymonLoader",
                "WCE",
                "Wali",
                "Windows Credential Editor",
                "Windows Credentials Editor",
                "XShellGhost",
                "XXMM",
                "gsecdump",
                "rarstar"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "bf0489c5-1c07-41e6-91c9-855ad96ccc6a",
            "created_at": "2022-10-25T16:47:55.541639Z",
            "updated_at": "2025-03-27T02:05:17.253496Z",
            "deleted_at": null,
            "main_name": "BRONZE BUTLER",
            "aliases": [
                "Daserf",
                "Stalker Panda ",
                "Tick ",
                "CTG-2006 "
            ],
            "source_name": "Secureworks:BRONZE BUTLER",
            "tools": [
                " DGet",
                " Daserf",
                " Datper",
                " Gofarer",
                " MSGet",
                " Mimikatz",
                " RarStar",
                " Screen Capture Tool",
                " ShadowPad",
                " T-SMB",
                " WinRAR",
                " Windows Credential Editor",
                " gsecdump",
                " xmm downloader",
                " xxmm",
                "ABK"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "b72c2616-cc7c-4c47-a83d-6b7866b94746",
            "created_at": "2023-01-06T13:46:39.425297Z",
            "updated_at": "2025-03-27T02:00:03.08718Z",
            "deleted_at": null,
            "main_name": "Red Nue",
            "aliases": [
                "LuoYu"
            ],
            "source_name": "MISPGALAXY:Red Nue",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673535533,
    "ts_updated_at": 1743041822,
    "ts_creation_date": 1653781462,
    "ts_modification_date": 1653781462,
    "files": {
        "pdf": "https://archive.orkl.eu/c9efe05ca355596e16b465b89f171bfe5e2715c6.pdf",
        "text": "https://archive.orkl.eu/c9efe05ca355596e16b465b89f171bfe5e2715c6.txt",
        "img": "https://archive.orkl.eu/c9efe05ca355596e16b465b89f171bfe5e2715c6.jpg"
    }
}