{
    "id": "db6593d6-07e3-497b-b6d9-dca406f34c58",
    "created_at": "2023-01-12T14:59:59.866774Z",
    "updated_at": "2025-03-27T02:05:58.422594Z",
    "deleted_at": null,
    "sha1_hash": "3e624b4b353d3e4d5690bb25ff3fe34f858be940",
    "title": "2022-08-10 - Indian Power Sector targeted with latest LockBit 3.0 variant",
    "authors": "",
    "file_creation_date": "2022-11-28T19:03:18Z",
    "file_modification_date": "2022-11-28T19:03:18Z",
    "file_size": 812842,
    "plain_text": "# Indian Power Sector targeted with latest LockBit 3.0 variant\n\n**[seqrite.com/blog/indian-power-sector-targeted-with-latest-lockbit-3-0-variant/](https://www.seqrite.com/blog/indian-power-sector-targeted-with-latest-lockbit-3-0-variant/)**\n\nSathwik Ram Prakki August 10, 2022\n\n10\nAugust\n2022\nWritten by [Sathwik Ram Prakki](https://www.seqrite.com/blog/author/sathwik/)\n\nEstimated reading time: 5 minutes\nAfter the infamous Conti ransomware group was disbanded, its former members started to\ntarget energy and power sectors with a new unknown ransomware payload. The intelligence\nderived by Quick Heal researchers had already identified the Energy and Power sector as a\nsegment prone to cyberattacks and had increased the vigil on the same. This proactive\nmonitoring proved fruitful soon after we identified one of the recent premium entities attacked\nin this segment. Our investigation and analysis determined that the new LockBit 3.0\nransomware variant caused the infection. The same has been claiming its dominance over\nother ransomware groups this year.\n\n\n-----\n\n**_Fig. 1 – Ransom Note_**\n\nThe entity that bore the brunt of this ransomware attack had endpoints at multiple locations,\nconnected with each other & the server in a mesh-topology spread across numerous\nlocations. From the logs of multiple systems and telemetry, we observed that Windows SysInternal tool PSEXEC was utilized from an unprotected system to execute the ransomware\npayload (Lock.exe) on all the systems laterally. The noteworthy observation was that only the\nshared drives were found to be encrypted.\n\nInitial access was obtained via brute forcing techniques where multiple user names were\nused for lateral movement. The encryption timestamp was in the early morning of 27-June2022. Anti-forensic activities were also observed, which cleared event logs, killed multiple\ntasks, and deleted services simultaneously.\n\n## Initial Analysis\n\nThe service PSEXESVC was first observed to be installed a week before the encryption, with\nsuccessful SMB connections surging just before the encryption. Malicious BAT files were\nexecuted by the same service only on one endpoint:\n\nC:\\Windows\\system32\\cmd.exe /c “”openrdp.bat” “\nC:\\Windows\\system32\\cmd.exe /c “”mimon.bat” “\nC:\\Windows\\system32\\cmd.exe /c “”auth.bat” “\nC:\\Windows\\system32\\cmd.exe /c “”turnoff.bat” “\n\nPSEXESVC executed the ransomware payload that must have a valid key passed along with\nthe command-line option ‘-pass’. The encrypted files were appended with .zbzdbs59d\nextension which suggests that random generation was done with each payload.\n\n\n-----\n\nEngine and ARW Telemetry show that the ransomware payload (Lock.exe) was detected at\nmultiple locations on the same day. This shows that the payload was dropped in all these\nsystems but was detected by AV.\n\n## Payload Analysis\n\nAll the sections on the payload are encrypted, which can only be decrypted bypassing the\ndecryption key as a command-line parameter ‘-pass’. The key obtained for this sample is:\n**60c14e91dc3375e4523be5067ed3b111**\n\nThe key is further processed to decrypt specific sections in memory that are obtained by\ntraversing the PEB and later calls the decrypted sections.\n\n**_Fig. 2 – Decrypting Sections_**\n\nBeing packed and having only a few imports, Win32 APIs are resolved by decrypting the\nobfuscated string with XOR using the key 0x3A013FD5.\n\n\n-----\n\n**_Fig. 3 – Resolving Win32 APIs_**\n\n**Privilege Escalation**\n\nWhen Admin privileges are not present during execution, it uses CMSTPLUA COM for UAC\nbypass to elevate the privileges with another instance of the ransomware payload,\nterminating the current process.\n\n**_Fig. 4 – UAC Bypass_**\n\n**Service Deletion and Process Termination**\n\nProcess terminated included SecurityHealthSystray.exe and the mutex created during\nexecution was 13fd9a89b0eede26272934728b390e06. Services were enumerated using a\npre-defined list and were deleted if found on the machine:\n\n1. Sense\n2. Sophos\n3. Sppsvc\n4. Vmicvss\n5. Vmvss\n6. Vss\n7. Veeam\n8. Wdnissvc\n9. Wscsvc\n10. EventLog\n\n**Anti-Debugging Technique**\n\nThreads used for file encryption were hidden from the debugger using\n**_NtSetInformationThread function with undocumented value (ThreadHideFromDebugger =_**\n0x11) for ThreadInformationClass parameter.\n\n\n-----\n\n**_Fig. 5 – NtSetInformationThread technique_**\n\n**File Encryption**\n\nBefore starting file encryption, the malware associated an icon to encrypted files by creating\nand writing it into an image file in the C:\\ProgramData directory as zbzdbs59d.ico. Files\nwere encrypted by creating multiple threads where each filename was replaced with a\nrandom string generated and appending the extension to them.\n\n**_Fig. 6 – Encrypted Filenames_**\n\n\n-----\n\nThe ransom note _zbzdbs59d.README.txt is created inside every directory except the_\n_Program Files and the Windows directory, which aren’t encrypted. It contains instructions to_\ninstall the TOR browser, links for a chat along with the personal ID and ends with the\nwarnings as usual. The victim machine’s wallpaper is modified with the name ‘LockBit Black’\nand mentions the instructions to be followed:\n\n**_Fig. 7 – Modified Wallpaper_**\n\n## Anti-Forensic Activity\n\nAs part of wiping out its traces, the ransomware disabled Windows Event Logs by setting\nmultiple registry subkeys to value 0.\n\n**HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\WINEVT\\Channels\\***\n\n**Tasks Killed**\n\nIBM* PrnHtml.exe* DriveLock.exe* MacriumService.exe*\n\nsql* PAGEANT.EXE* CodeMeter.exe* ReflectMonitor.exe*\n\nvee* firefox.exe* DPMClient.exe* Atenet.Service.exe*\n\nsage* ngctw32.exe* ftpdaemon.exe* account_server.exe*\n\nmysql* omtsreco.exe mysqld-nt.exe* policy_manager.exe*\n\nbes10* nvwmi64.exe* sqlwriter.exe* update_service.exe*\n\nblack* Tomcat9.exe* Launchpad.exe* BmsPonAlarmTL1.exe*\n\npostg* msmdsrv.exe* MsDtsSrvr.exe* check_mk_agent.exe*\n\n\n-----\n\n**Services Deleted**\n\nsc stop “Undelete”\nsc delete “LTService”\nsc delete “LTSvcMon”\nsc delete “WSearch”\nsc delete “MsMpEng”\nnet stop ShadowProtectSvc\nC:\\Windows\\system32\\net1 stop ShadowProtectSvc\n\n**Shadow Volume Copies Deleted**\n\nvssadmin.exe Delete Shadows /All /Quiet\n\n**Removal of all Active Network Connections**\n\nnet use * /delete /y\n\n**Exhaustive List of all the Logs**\n\n[Events Cleared](https://www.klgrth.io/paste/m3w3e)\n[Tasks Killed](https://www.klgrth.io/paste/t34rs)\n\n**Registry Activity**\n\nreg add\n“HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System”\n/v legalnoticecaption /t REG_SZ /d “ATTENTION to representatives!!!! Read before you log\non” /f\n\nreg add\n“HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System”\n/v legalnoticetext /t REG_SZ /d “Your system has been tested for security and unfortunately\nyour system was vulnerable. We specialize in file encryption and industrial (economic or\ncorporate) espionage. We don’t care about your files or what you do, nothing personal – it’s\njust business. We recommend contacting us as your confidential files have been stolen and\nwill be sold to interested parties unless you pay to remove them from our clouds and auction,\nor decrypt your files. Follow the instructions in your system” /f\n\nreg add “HKLM\\SYSTEM\\CurrentControlSet\\Control\\Terminal Server” /v\nfDenyTSConnections /t REG_DWORD /d 0 /f\n\nreg add HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\LSA /v RunAsPPL /t\nREG_DWORD /d 0 /f\n\nreg add HKLM\\SYSTEM\\CurrentControlSet\\Control\\SecurityProviders\\WDigest /v\nUseLogonCredential /t REG_DWORD /d 1 /f\n\n## Conclusion\n\n\n-----\n\nUnprotected systems in the network were brute-forced to run the PSEXEC tool for lateral\nmovement across the systems to execute the ransomware payload. With LockBit 3.0\nintroducing its bug bounty program and adopting new extortion tactics, it is mandatory to take\nprecautions like downloading applications only from trusted sources, using antivirus for\nenhanced protection, and avoiding clicking on any links received through email or social\nmedia platforms.\n\n## IOCs\n\n**MD5** **Detection**\n\n7E37F198C71A81AF5384C480520EE36E Ransom.Lockbit3.S28401281\nHEUR:Ransom.Win32.InP\n\n**IPs**\n\n3.220.57.224\n\n72.26.218.86\n\n71.6.232.6\n\n172.16.116.14\n\n78.153.199.241\n\n72.26.218.86\n\n5.233.194.222\n\n27.147.155.27\n\n192.168.10.54\n\n87.251.67.65\n\n71.6.232.\n\n64.62.197.182\n\n43.241.25.6\n\n31.43.185.9\n\n194.26.29.113\n\n\n-----\n\nJumpsecuritybusiness[.]com\n\n**Subject Matter Experts**\n\nTejaswini Sandapolla\n\nUmar Khan A\n\nParag Patil\n\nSathwik Ram Prakki\n\nSathwik Ram Prakki is working as a Security Researcher in Security Labs at Quick Heal. His\nfocus areas are Threat Intelligence, Threat Hunting, and writing about...\n\n[Articles by Sathwik Ram Prakki »](https://www.seqrite.com/blog/author/sathwik/)\n\n## Related Posts\n\n CVE-2022-26134: Actively Exploited Atlassian OGNL Injection Zero-Day Vulnerability\n\nJuly 5, 2022\n\n\n-----\n\n## CVE-2022-30190: Zero-day vulnerability “Follina” in MSDT exploited in the wild\n\nJune 10, 2022\n\n## Threat Advisory: CVE-2022-30190 ‘Follina’ – Severe Zero-day Vulnerability discovered in MSDT\n\nJune 3, 2022\n\n## No Comments\n\nLeave a Reply.Your email address will not be published.\n\nOur website uses cookies. Cookies enable us to provide the best experience possible and\nhelp us understand how visitors use our website.\n\n[By browsing this website, you agree to our cookie policy.](https://www.seqrite.com/blog/cookie-policy/)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-08-10 - Indian Power Sector targeted with latest LockBit 3.0 variant.pdf"
    ],
    "report_names": [
        "2022-08-10 - Indian Power Sector targeted with latest LockBit 3.0 variant.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673535599,
    "ts_updated_at": 1743041158,
    "ts_creation_date": 1669662198,
    "ts_modification_date": 1669662198,
    "files": {
        "pdf": "https://archive.orkl.eu/3e624b4b353d3e4d5690bb25ff3fe34f858be940.pdf",
        "text": "https://archive.orkl.eu/3e624b4b353d3e4d5690bb25ff3fe34f858be940.txt",
        "img": "https://archive.orkl.eu/3e624b4b353d3e4d5690bb25ff3fe34f858be940.jpg"
    }
}