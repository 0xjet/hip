{
    "id": "4f664334-4aea-4281-939b-4c7e199197b1",
    "created_at": "2023-02-02T02:08:55.280908Z",
    "updated_at": "2025-03-27T02:14:39.172196Z",
    "deleted_at": null,
    "sha1_hash": "b309717004b153ed39d7c0943f63742225366435",
    "title": "2023-01-12 - Rhadamanthys- New Stealer Spreading Through Google Ads",
    "authors": "",
    "file_creation_date": "2023-02-01T07:48:28Z",
    "file_modification_date": "2023-02-01T07:48:28Z",
    "file_size": 1189357,
    "plain_text": "# Rhadamanthys: New Stealer Spreading Through Google Ads\n\n**[blog.cyble.com/2023/01/12/rhadamanthys-new-stealer-spreading-through-google-ads/](https://blog.cyble.com/2023/01/12/rhadamanthys-new-stealer-spreading-through-google-ads/)**\n\nJanuary 12, 2023\n\n## Evasive Infostealer leveraging Phishing and Spam Campaigns for its Delivery\n\nThreat Actors (TAs) are increasingly using spam emails and phishing websites to trick users into\ndownloading malware such as Stealer and Remote Access Trojan (RAT) to infect users’ machines and\nsteal sensitive information.\n\nCyble Research & Intelligence Labs (CRIL) is actively monitoring various stealer malware and publishing\nblogs about them to inform and educate its readers.\n\nRecently, we came across a new [strain of malware called “Rhadamanthys Stealer.” This stealer variant is](https://twitter.com/1ZRR4H/status/1610590795278712832?s=20&t=AA9C4sZ_LFI8FWw3GnmNMw)\nactive, and the TA behind the malware stealer is selling this under the Malware as a Service (MaaS)\nmodel.\n\n[Rhadamanthys stealer spreads by using Google Ads that redirect the user to phishing websites that mimic](https://www.malware-traffic-analysis.net/2023/01/03/index.html)\npopular software such as Zoom, AnyDesk, Notepad++, Bluestacks, etc. It can also spread via spam email\ncontaining an attachment for delivering the malicious payload.\n\n## Spam Email\n\nThe Rhadamanthys stealer infection starts through spam emails containing a PDF attachment named\n“Statement.pdf” as shown in the figure below.\n\n\n-----\n\nFigure 1 – Spam Email with PDF Attachment\nWhen opening the attachment present in the spam email, it displays a message indicating it is an “Adobe\nAcrobat DC Updater” and includes a download link labelled “Download Update,” as shown below.\n\n\n-----\n\nFigure 2 – PDF document with a download link\nWhen a user clicks the “Download Update” link, it downloads a malware executable from an URL\n_“https[:]\\\\zolotayavitrina[.]com/Jan-statement[.]exe” into the Downloads folder._\n\nUpon execution of the “Jan-statement.exe” file, it runs the stealer and allows it to steal sensitive\ninformation from the victim’s machine. The figure below illustrates the process tree of the Rhadamanthys\nstealer that was delivered via a spam email.\n\nFigure 3 – Process tree of spam email downloads Stealer\n\n## Phishing Sites\n\nThe TAs behind this campaign also created a highly convincing phishing webpage impersonating\nlegitimate websites to trick users into downloading the stealer malware, which carries out malicious\nactivities. The link to these phishing websites spreads through Google ads. We have observed several\nphishing domains created to spread this malware. Some of the following:\n\n_bluestacks-install[.]com_\n_zoomus-install[.]com_\n\n\n-----\n\n_install-zoom[.]com_\n_install-anydesk[.]com_\n_install-anydeslk[.]com_\n_zoom-meetings-install[.]com_\n_zoom-meetings-download[.]com_\n_anydleslk-download[.]com_\n_zoomvideo-install[.]com_\n_zoom-video-install[.]com_\n_istaller-zoom[.]com_\n_noteepad.hasankahrimanoglu[.]com[.]tr_\n\nThe phishing websites further downloads an installer file disguised as a legitimate installer downloading\nthe respective applications. When installing the respective application, it also silently installs the stealer\nmalware without the user’s knowledge. The below figure shows the process tree of the malicious AnyDesk\ninstaller deploying Rhadamanthys stealer.\n\nFigure 4 – Process tree of malicious AnyDesk installing Stealer\n\n## Payload Analysis\n\nUpon execution of the installer file, it creates a folder named “ST” in the %temp% location and drops two\nhidden binary executable files.\n\n_Initialize 4.exe_\n_Runtime Broker.exe_\n\nThe loader “Runtime Broker.exe” is a 32-bit PyInstaller executable with SHA256:\n_db66fc58c07ba0ccbe1b9c2db770179d0d931e5bf73838da9c915581661d4c1a._\n\nThe additional information is shown in the figure below.\n\n\n-----\n\nFigure 5 – Static file details of “Runtime Broker.exe”\nUpon execution of “Runtime Broker.exe”, it drops multiple Python-supporting files in the %temp% folder.\n\nThese files include “.pyc”, “.pyd”, and “.dll” files, which were extracted from the PyInstaller executable as\nshown below.\n\nFigure 6 – Extracted files of PyInstaller executable\nThe “Binary_Stub_Replacer.pyc” is a python compiled file which contains obfuscated raw data that will be\nde-obfuscated using replace function and then converted into Binary and ASCII format for getting the\nsecond stage malicious python code as shown below.\n\nFigure 7 – Decompiled python content of Binary_Stub_Replacer.pyc\nThe decoded python code contains an embedded base64-encoded content which is a shellcode. When\nexecuted, this python code decodes the base64-encoded stub, creating a new Portable Executable (PE)\npayload file. The PE file is then injected into a new “Runtime Broker.exe” process using the CreateThread()\n\n\n-----\n\nAPI function, as shown in the image below.\n\nFigure 8 – Decoded payload from base64 stub\nThe below image shows the details of the shellcode, which is a 32-bit executable file compiled with\nMicrosoft visual C/C++ compiler, as shown below.\n\n\n-----\n\nFigure 9 – Payload file details\nUpon execution, the shellcode begins by creating a mutex object to ensure that only one copy of the\nmalware is running on the victim’s system at any given time. It then checks if it is running on a virtual\nmachine, such as VMware or VirtualBox, by searching for strings associated with virtual machine\nenvironments, as shown in the figure below.\n\n\n-----\n\nFigure 10 –\n\nAntiVM related strings\nThis check is designed to prevent the malware from being detected and analyzed in a virtual environment.\nIf the malware detects that it is running in a controlled environment, it will terminate its execution.\nOtherwise, it will continue and perform the stealer activity as intended.\n\nAfter the check, the shellcode further drops a DLL file named “nsis_unsibcfb0.dll” in the %temp% folder\nand launches it using the “rundll32.exe” with specific parameters shown in the figure below.\n\n\n-----\n\nFigure 11 – Dropped DLL file execution\nWhile investigating this malware, we observed that a steganography image was downloaded from the\nremote server. We suspect the shellcode decrypts the steganography image to get the actual\nRhadamanthys payload. The memory of rundll32.exe contains all the malicious code responsible for\nstealer activities.\n\nThe Rhadamanthys stealer now starts collecting system information by executing a series of Windows\nManagement Instrumentation (WMI) queries. The collected information includes the computer name,\nusername, OS version, RAM, CPU information, HWID, time zone, user and keyboard language, and\nothers.\n\nAfter gathering system details, the malware queries the directories of the installed browsers on the victim’s\nmachine and searches for browser-related files such as browsing history, bookmarks, cookies, auto-fills,\nlogin credentials, etc. It targets different browsers such as Brave, Edge, Chrome, Firefox, Opera Software,\nSleipnir5, Pale Moon, CocCoc, etc.\n\n## Crypto Wallets\n\nThis stealer malware is also designed to target various crypto wallets and collects information from them.\nWhile the malware can target a wide range of crypto wallets, the observed stealer samples were found to\nhave specific functionality to target the following crypto wallets:\n\n_Armory_\n_Binance_\n_Bitcoin_\n_Bytecoin_\n_Electron_\n_Qtum-Electrum_\n_Solar wallet_\n_WalletWasabi_\n_Zap_\n_Zecwallet Lite_\n_Zcash_\n\nAlso, the Rhadamanthys stealer steals data from the following crypto wallet browser extensions, which are\nhard coded in the stealer binary, as shown in the image below.\n\n\n-----\n\nFigure 12 – Targeted Crypto wallets with the extension ID\nThe stealer also targets various applications such as FTP clients (CoreFTP, WinSCP), email clients\n(Foxmail, Thunderbird, Outlook, TrulyMail, GmailNotifierPro), File managers (Total commanders),\npassword managers (RoboForm, KeePass), VPN services (NordVPN, ProtonVPN, Windscribe VPN,\nOpenVPN), messaging applications (Tox, Discord, Telegram) and others. Additionally, it captures\nscreenshots of the victim’s machine using the BitBlt() API function. Finally, it sends all the collected stolen\ninformation to the attacker’s C&C server.\n\n## C&C Panel\n\nThe below figure shows the Rhadamanthys stealer’s active C&C panel.\n\n\n-----\n\nFigure 13 – Rhadamanthys stealer C&C panel\n\n## Conclusion\n\nInformation stealers are malicious software used to gain unauthorized access to corporate networks, which\nhas become a serious concern. Threat Actors use various techniques to deploy their malicious payloads\ninto the victim’s system. In this case, we observed that the TAs used spam email and phishing websites to\ndeliver the Rhadamanthys Stealer, designed to steal sensitive information from the victim’s machine.\nAdditionally, it was also noticed that the malware spreads via Google Ads. It is crucial for users to exercise\ncaution when receiving spam emails or to visit phishing websites and to verify the source before\ndownloading any applications.\n\nCyble Research and Intelligence Labs will continue monitoring the new malware strains in the wild and\nupdate blogs with actionable intelligence to protect users from such notorious attacks.\n\n## Our Recommendations\n\nThe initial infection may happen via spam emails or phishing websites, so enterprises should use\nsecurity products to detect phishing emails and websites.\nAvoid downloading pirated software from Warez/Torrent websites. The “Hack Tool” present on sites\nsuch as YouTube, Torrent sites, etc., contains such malware.\nUse strong passwords and enforce multi-factor authentication wherever possible.\nTurn on the automatic software update feature on your computer, mobile, and other connected\ndevices.\nUse a reputed anti-virus and internet security software package on your connected devices, including\nPC, laptop, and mobile.\nRefrain from opening untrusted links and email attachments without first verifying their authenticity.\nEducate employees on protecting themselves from threats like phishing/untrusted URLs.\nBlock URLs that could be used to spread the malware, e.g., Torrent/Warez.\nMonitor the beacon on the network level to block data exfiltration by malware or TAs.\n\n## MITRE ATT&CK® Techniques\n\n\n-----\n\n**Tactic** **Technique ID** **Technique Name**\n\nInitial Access [T1598](https://attack.mitre.org/techniques/T1598/)\n\nSpearphishing Attachment\n\n\nExecution [T1204](https://attack.mitre.org/techniques/T1204/)\n\n[T1059](https://attack.mitre.org/techniques/T1059/)\n\n\nUser Execution\n\nCommand and Scripting Interpreter\n\n\nPrivilege Escalation [T1055](https://attack.mitre.org/techniques/T1055) Process Injection\n\n\nDefense Evasion [T1218](https://attack.mitre.org/techniques/T1218)\n\n[T1027](https://attack.mitre.org/techniques/T1027)\n\n[T1497](https://attack.mitre.org/techniques/T1497)\n\nCredential Access [T1003](https://attack.mitre.org/techniques/T1003/)\n\n[T1056](https://attack.mitre.org/techniques/T1056/)\n\n[T1552](https://attack.mitre.org/techniques/T1552)\n\nDiscovery [T1082](https://attack.mitre.org/techniques/T1082)\n\n[T1518](https://attack.mitre.org/techniques/T1518)\n\n[T1083](https://attack.mitre.org/techniques/T1083)\n\n[T1087](https://attack.mitre.org/techniques/T1087)\n\nCollection [T1005](https://attack.mitre.org/techniques/T1005/)\n\n[T1114](https://attack.mitre.org/techniques/T1114)\n\nCommand and Control [T1071](https://attack.mitre.org/techniques/T1071)\n\n[T1095](https://attack.mitre.org/techniques/T1095)\n\n[T1105](https://attack.mitre.org/techniques/T1105)\n\n\nRundll32\n\nObfuscated Files or Information\n\nVirtualization/Sandbox Evasion\n\nOS Credential Dumping\n\nInput Capture\n\nCredentials in Registry\n\nSystem Information Discovery\n\nSecurity Software\n\nDiscovery File and Directory\n\nDiscovery Account Discovery\n\nData from Local System\n\nEmail Collection\n\nApplication Layer Protocol\n\nNon-Application Layer Protocol\n\nIngress Tool Transfer\n\n\n## Indicators of Compromise (IOCs)\n\n**Indicators** Indicator\n\nType\n\n\nDescription\n\n\n046981c818bd26e7c28b12b998847038e6b64c44df6645438dae689d75fb0269 Sha256 Spam email\n\n4f4b5407d607ee32e00477a9f4294600ca86b67729ff4053b95744433117fccf Sha256 Spam email\n\n4a55c833abf08ecfe4fb3a7f40d34ae5aec5850bc2d79f977c8ee5e8a6f450d4 Sha256 PDF\nattachment\n(Statement.pdf)\n\n093a58f36c075644d1dc8856acdefad7fd22332444b6aa07fee2ad615d50b743 Sha256 AnyDesk.msi\n\ndb66fc58c07ba0ccbe1b9c2db770179d0d931e5bf73838da9c915581661d4c1a Sha256 Runtime\nBroker.exe\n\nfe99a49596fc6f841b7605021da6fce7f6c817d5247d880227f790388a7cabe4 Sha256 Shellcode exe\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2023/2023-01-12 - Rhadamanthys- New Stealer Spreading Through Google Ads.pdf"
    ],
    "report_names": [
        "2023-01-12 - Rhadamanthys- New Stealer Spreading Through Google Ads.pdf"
    ],
    "threat_actors": [
        {
            "id": "a66438a8-ebf6-4397-9ad5-ed07f93330aa",
            "created_at": "2022-10-25T16:47:55.919702Z",
            "updated_at": "2025-03-27T02:05:17.412024Z",
            "deleted_at": null,
            "main_name": "IRON VIKING",
            "aliases": [
                "ATK14 ",
                "BlackEnergy Group",
                "Blue Echidna ",
                "CTG-7263 ",
                "ELECTRUM ",
                "FROZENBARENTS ",
                "Hades/OlympicDestroyer ",
                "IRIDIUM ",
                "Qudedagh ",
                "Sandworm Team ",
                "Seashell Blizzard ",
                "TEMP.Noble ",
                "Telebots ",
                "Voodoo Bear ",
                "APT44 "
            ],
            "source_name": "Secureworks:IRON VIKING",
            "tools": [
                " BlackEnergy",
                " GCat",
                " GreyEnergy",
                " Industroyer",
                " KillDisk",
                " NotPetya",
                " PSCrypt",
                " TeleBot",
                " TeleDoor",
                " xData",
                "BadRabbit"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "b3e954e8-8bbb-46f3-84de-d6f12dc7e1a6",
            "created_at": "2022-10-25T15:50:23.339976Z",
            "updated_at": "2025-03-27T02:00:55.446795Z",
            "deleted_at": null,
            "main_name": "Sandworm Team",
            "aliases": [
                "Sandworm Team",
                "ELECTRUM",
                "Telebots",
                "IRON VIKING",
                "BlackEnergy (Group)",
                "Quedagh",
                "Voodoo Bear",
                "IRIDIUM",
                "Seashell Blizzard",
                "FROZENBARENTS",
                "APT44"
            ],
            "source_name": "MITRE:Sandworm Team",
            "tools": [
                "Bad Rabbit",
                "Mimikatz",
                "Exaramel for Linux",
                "Exaramel for Windows",
                "GreyEnergy",
                "PsExec",
                "Prestige",
                "P.A.S. Webshell",
                "VPNFilter",
                "Cyclops Blink",
                "SDelete",
                "AcidRain",
                "Industroyer",
                "Industroyer2",
                "BlackEnergy",
                "Cobalt Strike",
                "NotPetya",
                "KillDisk",
                "PoshC2",
                "Impacket",
                "Invoke-PSImage",
                "Olympic Destroyer"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "3a0be4ff-9074-4efd-98e4-47c6a62b14ad",
            "created_at": "2022-10-25T16:07:23.590051Z",
            "updated_at": "2025-03-27T02:02:09.878211Z",
            "deleted_at": null,
            "main_name": "Energetic Bear",
            "aliases": [
                "ATK 6",
                "Blue Kraken",
                "Crouching Yeti",
                "Dragonfly",
                "Electrum",
                "Energetic Bear",
                "Ghost Blizzard",
                "Group 24",
                "ITG15",
                "Iron Liberty",
                "Koala Team",
                "TG-4192"
            ],
            "source_name": "ETDA:Energetic Bear",
            "tools": [
                "Backdoor.Oldrea",
                "CRASHOVERRIDE",
                "Commix",
                "CrackMapExec",
                "CrashOverride",
                "Dirsearch",
                "Dorshel",
                "Fertger",
                "Fuerboos",
                "Goodor",
                "Havex",
                "Havex RAT",
                "Hello EK",
                "Heriplor",
                "Impacket",
                "Industroyer",
                "Karagany",
                "Karagny",
                "LightsOut 2.0",
                "LightsOut EK",
                "Listrix",
                "Oldrea",
                "PEACEPIPE",
                "PHPMailer",
                "PsExec",
                "SMBTrap",
                "Subbrute",
                "Sublist3r",
                "Sysmain",
                "Trojan.Karagany",
                "WSO",
                "Webshell by Orb",
                "Win32/Industroyer",
                "Wpscan",
                "nmap",
                "sqlmap",
                "xFrost"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "8941e146-3e7f-4b4e-9b66-c2da052ee6df",
            "created_at": "2023-01-06T13:46:38.402513Z",
            "updated_at": "2025-03-27T02:00:02.824555Z",
            "deleted_at": null,
            "main_name": "Sandworm",
            "aliases": [
                "G0034",
                "IRIDIUM",
                "Blue Echidna",
                "FROZENBARENTS",
                "Seashell Blizzard",
                "IRON VIKING",
                "ELECTRUM",
                "TeleBots",
                "UAC-0113",
                "UAC-0082",
                "APT44",
                "Quedagh",
                "VOODOO BEAR",
                "TEMP.Noble"
            ],
            "source_name": "MISPGALAXY:Sandworm",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1675303735,
    "ts_updated_at": 1743041679,
    "ts_creation_date": 1675237708,
    "ts_modification_date": 1675237708,
    "files": {
        "pdf": "https://archive.orkl.eu/b309717004b153ed39d7c0943f63742225366435.pdf",
        "text": "https://archive.orkl.eu/b309717004b153ed39d7c0943f63742225366435.txt",
        "img": "https://archive.orkl.eu/b309717004b153ed39d7c0943f63742225366435.jpg"
    }
}