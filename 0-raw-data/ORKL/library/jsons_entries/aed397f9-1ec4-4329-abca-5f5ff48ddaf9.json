{
    "id": "aed397f9-1ec4-4329-abca-5f5ff48ddaf9",
    "created_at": "2023-01-12T15:10:19.377089Z",
    "updated_at": "2025-03-27T02:13:47.885219Z",
    "deleted_at": null,
    "sha1_hash": "46ceedee9ca12eea6b5f5b36f3d97a7f6c64a522",
    "title": "2021-06-22 - Response When Minutes Matter- Falcon Complete Disrupts WIZARD SPIDER eCrime Operators",
    "authors": "",
    "file_creation_date": "2022-05-28T23:12:22Z",
    "file_modification_date": "2022-05-28T23:12:22Z",
    "file_size": 3622480,
    "plain_text": "# How Falcon Complete Disrupts eCrime Operators (WIZARD SPIDER)\n\n**[crowdstrike.com/blog/how-falcon-complete-disrupts-ecrime-operators-wizard-spider/](https://www.crowdstrike.com/blog/how-falcon-complete-disrupts-ecrime-operators-wizard-spider/)**\n\nFalcon Complete Team June 22, 2021\n\nIn this blog, we describe a string of recent incidents in which the CrowdStrike Falcon\nComplete™ team observed a financially motivated eCrime operator (likely WIZARD\nSPIDER) use compromised external remote services (Microsoft Remote Desktop Protocol,\nor RDP) along with Cobalt Strike in an unsuccessful attempt to deploy ransomware. This\nactivity indicates a notable increase in the adversary’s tactics to include RDP brute forcing\nalong with their more traditional modus operandi for initial access via phishing or leveraging\ntheir partner networks of access brokers.\n\nWe will provide a brief overview of the observed tactics, techniques and procedures (TTPs)\nin these cases along with an outline of the Falcon Complete team’s approach to quickly\ndetect and contain the interactive attacker before the threat actor was able to complete\nactions on objective.\n\n## Campaign TTPs Overview\n\n\n-----\n\nIn recent weeks, the Falcon Complete team has conducted several response operations to\nincidents involving compromised RDP credentials as an initial infection vector. This was\nfollowed by execution of reconnaissance commands, installation of Cobalt Strike and\nadditional tooling.\n\nCrowdStrike Intelligence assesses that the threat actor responsible for this activity is likely\n[WIZARD SPIDER due to the following overlapping TTPs with WIZARD SPIDER activity](https://www.crowdstrike.com/blog/wizard-spider-adds-new-feature-to-ryuk-ransomware/)\nclusters:\n\n_Cobalt Strike stager DLLs executed from the victim’s Music directory_\nNetwork indicators identified via hunting for related samples and infrastructure\nexhibiting attributes of WIZARD SPIDER infrastructure\nUsing nltest and net Windows utilities to conduct reconnaissance activity\n\nThis assessment carries low confidence.\n\nFigure 1. Activity cluster patterns mapped to MITRE ATT&CK (Click to enlarge)®\n\nWIZARD SPIDER is a criminal group behind the core development and distribution of a\nsophisticated arsenal of criminal tools, including the Trickbot, BazarLoader, Conti and Ryuk\n[malware variants. This adversary has used big game hunting (BGH) tactics to great effect](https://www.crowdstrike.com/blog/big-game-hunting-with-ryuk-another-lucrative-targeted-ransomware/)\nagainst a diverse set of targets across multiple sectors and geographies.\n\nThe typical activity patterns observed by the Falcon Complete team in recent intrusions\ninclude an initial attack vector via compromised external remote services — commonly,\nexposed RDP. This suggests a notable increase in this tactic. It is unclear whether the\n[increased focus on external remote services is a shift away from phishing and using access](https://www.crowdstrike.com/cybersecurity-101/phishing/)\nbrokers, or whether this is simply an addition to the adversary’s overall modus operandi.\n[Adversaries often obtain credentials in multiple ways, whether by brute forcing an externally](https://www.crowdstrike.com/cybersecurity-101/brute-force-attacks/)\nexposed service, purchasing them on underground markets or conducting credential\nharvesting operations.\n\nOnce the actor has established a foothold within an environment, they will proceed with\nreconnaissance activities to enumerate accounts and systems that may represent high-value\ntargets. Multiple reconnaissance commands were observed — in particular, nltest appears to\nbe a hallmark of this activity. Shown in Figure 2, the adversary first enumerated the trusted\ndomains in the environment, and then a list of domain controllers. Their goal was likely to\nmove laterally to one of these systems.\n\n\n-----\n\nFigure 2. Example reconnaissance commands\n\nThe threat actor then installed additional tooling for post-exploitation activities. This typically\nincluded Cobalt Strike for command and control, where the stager DLLs were written to the\nuser’s `Music directory. BloodHound or Adfind were pulled down from an external resource`\nfor additional account enumeration in preparation for lateral movement. This secondary\nreconnaissance is handled by a BAT file written to the same `Music directory.`\n\nFigure 3. Process tree graph (Click to enlarge)\n\nFigure 3 presents many of the common patterns related to the observed activity cluster as\nseen in the Falcon console. This process tree graph view indicates the initial process\ninjection under the `explorer.exe  process via` `rundll32.exe, along with the initial`\nreconnaissance commands such as `nltest under the` `conhost.exe process.`\n\n## Falcon Complete Detection and Response\n\n### Initial Detection and Triage\n\nThe Falcon Complete team has observed multiple related incidents over the past several\nweeks that share common TTPs, as noted above. Below, we present a case study of these\ncontextual indicators observed during a specific incident.\n\n\n-----\n\nThe response process began when the Falcon Complete team received a high-severity\nmachine learning (ML) detection for a suspicious process injection via `rundll32.exe .`\nFurther investigation indicated that this process injection was related to the threat actor\nabusing Microsoft Office Visual Basic for Applications (VBA) macros in an uncommon way.\n\nFigure 4. Process tree with Microsoft Excel copy/paste (Click to enlarge)\n\nThis shellcode was a typical stager that functioned as a downloader to fetch a Cobalt Strike\npayload from the attacker-controlled command and control (C2). These resources were\nwritten to the `C:\\Users\\Public\\Music` directory.\n\nFigure 5. Detection showing Cobalt Strike stage location (Click to enlarge)\n\nAdversaries utilizing Microsoft Office documents weaponized with VBA macros is nothing\nnew, but the activity described above differs significantly from phishing campaigns leveraging\nmacro documents to achieve initial access. Instead, the document was being used to\n\n\n-----\n\nexecute code after initial access had been achieved on a system via a compromised\naccount.\n\nWe have observed multiple instances of files written that were named either “New Microsoft\nWord Document.docx” or “New Microsoft Excel Worksheet.xlsx,” which are the default\nnaming schemes for new document templates in Windows. Next, a macro executes a\nshellcode payload via the `rundll32.exe process, which is a Cobalt Strike stager, but the`\nmacro’s shellcode is never written to disk.\n\nThis is likely an evasion technique attempting to bypass host-based security controls to\nexecute shellcode. What appears to be happening is the threat actors are copying and\npasting the malicious macro directly into a blank document template over the RDP session.\nThe advantage of this approach is that the macros are not written to disk and are only\nexecuted in memory. This activity was then followed by similar reconnaissance commands\nobserved in Figure 2 above.\n\n### Containment and Investigation\n\nAt this point, we were confident that an adversary was interactive and had compromised the\nvictim host. We observed them attempting to perform reconnaissance in preparation for\nprivilege escalation and lateral movement. The next steps were to contain and identify the\nfull scope of the incident.\n\nOur analysts have the capability to network-contain a host to prevent the lateral spread of the\nadversary within the environment. This immediately denies the adversary remote access by\nonly allowing the host to communicate with the CrowdStrike Security Cloud.\n\nFigure 6. Containment (Click to enlarge)\n\nThe next objective of the investigation was to properly scope the intrusion by identifying the\naffected systems/user accounts and host/network indicators of compromise. We can pivot\ninto our endpoint activity monitoring (EAM) application, which provides endpoint telemetry so\nwe can gain further context and determine the origin of the intrusion.\n\n\n-----\n\nFigure 7. EAM query for type 10 logons (RDP) (Click to enlarge)\n\nThe goal here was determining the user account that the threat actor compromised and\nleveraged for remote access. In Figure 7, a simple query for `type 10 logons can determine`\nthis account. This query also gives us the `Remote IP, which is the source host of the RDP`\nlogon. This information could also be gleaned from a Falcon Real Time Response (RTR)\nsession on the host to query the security event logs via PowerShell, such as the following\nsnippet:\n\nFigure 8. Alternative method for event logs\n\nThe EAM application can also be used to search for residual host artifacts that the adversary\nmay have left behind on the system. From the initial detection triage, we can then pivot from\ndata points such as the injected process, directory locations and specific file types of interest.\nA basic query is shown in Figure 9 to identify the artifacts of interest that remain on disk.\n\nFigure 9. EAM query for host artifacts (Click to enlarge)\n\nBased on observations from previous intrusions, we knew that a batch file may be present in\nthe same directory as the Cobalt Strike stager. As noted before, this batch file is responsible\nfor conducting further reconnaissance with Adfind to explore the Active Directory\n\n\n-----\n\nenvironment. As shown in Figure 9, the EAM query also captured the command\n```\nrundll32.exe test.dll, Lemon . This command is responsible and is used for process\n\n```\ninjection via `rundll32.exe . Previously, the Falcon Complete team has observed similar`\npatterns regarding one-word export functions such as “Lemon“ in this case, and “Lime“ in\nsimilar instances. These one-word export functions likely suggest a possible common\nnaming convention for exports, related to Cobalt Strike DLLs across the intrusions observed.\nInvestigators can use this indicator to pivot or enrich related data sets of potentially linked\nactivity clusters.\n\nNext, the team performed dynamic malware analysis on the Cobalt Strike stager sample. We\ndiscovered that the binary’s code was configured to reach out to the domain\n\n`serviapd[.]com` for C2. At this point in the investigation, we had determined both the\nsystem and user scopes, identified host artifacts and extracted network indicators of\ncompromise (IOCs) from the malware. Armed with this information, the Falcon Complete\nteam could now begin removing the actor’s malware from the affected systems.\n\n### Remediation\n\nThe Falcon Complete team directly performs many of the critical remediation actions for our\ncustomers via Falcon RTR.\n\nA typical remediation can be broken into three distinct steps:\n\n1. Killing the malicious processes (e.g., injected rundll, explorer, conhost)\n2. Locating and removing the persistence mechanism (e.g., compromised accounts,\n\nservices)\n3. Removing disk artifacts (e.g., binaries and directories)\n\nIn this case, we have rated this remediation as “Easy,” based on the velocity and total effort\nrequired for proper recovery. Due to the rapid response time to contain and evict the\nadversary, there was not an extensive list of clean-up actions to be taken.\n\n**STEP 1. Finding and Killing the Malicious Process**\n\nFalcon did a lot of the work for us here and had already terminated the injected processes.\nThe running process was reviewed to ensure no injected threads were still executing\nmalicious code. We have provided more details for finding injected process in previous\nblogs:\n\n\n-----\n\n[Automating Remote Remediation of TrickBot: Part 1](https://www.crowdstrike.com/blog/automating-remote-remediation-of-trickbot-part-1/)\n[Duck Hunting with Falcon Complete: Remediating a Fowl Banking Trojan, Part 3](https://www.crowdstrike.com/blog/duck-hunting-with-falcon-complete-qakbot-countermeasures/)\n\n**STEP 2. Removing Persistence**\n\nThe adversary did not have time (or didn’t bother) to establish persistence beyond the\ncompromised account credentials leveraged in the RDP session. We worked with the client\nto reset these accounts and harden remote services to avoid further exploitation. Our\nrecommendations for best practices include:\n\nUsing multifactor authentication (MFA) for remote access services\nDisabling RDP or any services that are not required\nUsing non-standard ports if required\nDeploying technical controls such as Web Application Firewall (WAF) in front of remote\nservices\n\n**STEP 3. Removing Remaining Artifacts**\n\nUsing Falcon RTR, we removed all adversary tooling and file system residue present in the\n\n`C:\\Users\\Public\\Music` directory.\n\nThe steps outlined above are the general process for successfully remediating a host for the\nartifacts of this intrusion set.\n\n## The Efficiency of Falcon Complete\n\nThe Falcon Complete team identified an interactive adversary that had compromised an\nexternal remote service and gained illicit access to a managed host in our client’s\nenvironment. This threat actor attempted to download and execute additional tooling in a\nlikely attempt to stage ransomware. The team quickly contained, scoped and remediated this\nthreat with the Falcon RTR capability without requiring any reboots, reimages or other\ndisruption to the client’s business operations. The following figure highlights the significant\nmilestones during our detection and response efforts.\n\n\n-----\n\nThis activity was attributed to the financially motivated adversary tracked as WIZARD\nSPIDER.\n\nThe Falcon Complete team has observed multiple similar TTPs in several recent intrusions\nthat indicate a general tactical increase or preference for compromising external remote\nservices (such as RDP) as an initial infection vector. It is unclear but possible that this activity\nis simply in addition to this actor’s “normal” email phishing operations. We also noted an\ninteresting usage of a technique leveraging Microsoft Office macros following initial access. It\nis likely that eCrime actors will continue to use this technique going forward. The Falcon\nComplete team will continue to track this threat and monitor our clients’ environments for any\nnotable developments.\n\n**Additional Resources**\n\n_Read more blogs from the Falcon Complete team: Falcon Complete Disrupts_\n_Malvertising Campaign Targeting AnyDesk,_ _Response When Minutes Matter: Rising Up_\n_Against Ransomware and_ _Falcon Complete Stops Microsoft Exchange Server Zero-_\n_Day Exploits._\n_[Learn more by visiting the Falcon Complete product webpage.](https://www.crowdstrike.com/endpoint-security-products/falcon-complete/)_\n_Read a white paper: CrowdStrike Falcon Complete: Instant Cybersecurity Maturity for_\n_Organizations of All Sizes._\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-06-22 - Response When Minutes Matter- Falcon Complete Disrupts WIZARD SPIDER eCrime Operators.pdf"
    ],
    "report_names": [
        "2021-06-22 - Response When Minutes Matter- Falcon Complete Disrupts WIZARD SPIDER eCrime Operators.pdf"
    ],
    "threat_actors": [
        {
            "id": "610a7295-3139-4f34-8cec-b3da40add480",
            "created_at": "2023-01-06T13:46:38.608142Z",
            "updated_at": "2025-03-27T02:00:02.87217Z",
            "deleted_at": null,
            "main_name": "Cobalt",
            "aliases": [
                "Cobalt Gang",
                "GOLD KINGSWOOD",
                "COBALT SPIDER",
                "G0080",
                "Mule Libra",
                "Cobalt Group"
            ],
            "source_name": "MISPGALAXY:Cobalt",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "63061658-5810-4f01-9620-7eada7e9ae2e",
            "created_at": "2022-10-25T15:50:23.752974Z",
            "updated_at": "2025-03-27T02:00:55.538582Z",
            "deleted_at": null,
            "main_name": "Wizard Spider",
            "aliases": [
                "Wizard Spider",
                "UNC1878",
                "TEMP.MixMaster",
                "Grim Spider",
                "FIN12",
                "GOLD BLACKBURN",
                "ITG23",
                "Periwinkle Tempest",
                "DEV-0193"
            ],
            "source_name": "MITRE:Wizard Spider",
            "tools": [
                "TrickBot",
                "AdFind",
                "BITSAdmin",
                "Bazar",
                "LaZagne",
                "Nltest",
                "GrimAgent",
                "Dyre",
                "Ryuk",
                "Conti",
                "Emotet",
                "Rubeus",
                "Mimikatz",
                "Diavol",
                "PsExec",
                "Cobalt Strike"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "f6f91e1c-9202-4497-bf22-9cd5ef477600",
            "created_at": "2023-01-06T13:46:38.86765Z",
            "updated_at": "2025-03-27T02:00:02.938998Z",
            "deleted_at": null,
            "main_name": "WIZARD SPIDER",
            "aliases": [
                "FIN12",
                "UNC2053",
                "Pistachio Tempest",
                "TEMP.MixMaster",
                "GOLD BLACKBURN",
                "Periwinkle Tempest",
                "DEV-0193",
                "Storm-0193",
                "Trickbot LLC",
                "DEV-0237"
            ],
            "source_name": "MISPGALAXY:WIZARD SPIDER",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "e6a21528-2999-4e2e-aaf4-8b6af14e17f3",
            "created_at": "2022-10-25T16:07:24.422115Z",
            "updated_at": "2025-03-27T02:02:10.216817Z",
            "deleted_at": null,
            "main_name": "Wizard Spider",
            "aliases": [
                "DEV-0193",
                "Gold Blackburn",
                "Gold Ulrick",
                "Grim Spider",
                "ITG23",
                "Operation BazaFlix",
                "Periwinkle Tempest",
                "TEMP.MixMaster",
                "Wizard Spider"
            ],
            "source_name": "ETDA:Wizard Spider",
            "tools": [
                "AdFind",
                "Agentemis",
                "Anchor_DNS",
                "BEERBOT",
                "BazarBackdoor",
                "BazarCall",
                "BazarLoader",
                "Cobalt Strike",
                "CobaltStrike",
                "Conti",
                "Diavol",
                "Dyranges",
                "Dyre",
                "Dyreza",
                "Dyzap",
                "Gophe",
                "Invoke-SMBAutoBrute",
                "KEGTAP",
                "LaZagne",
                "LightBot",
                "PowerSploit",
                "PowerTrick",
                "PsExec",
                "Ryuk",
                "SessionGopher",
                "TSPY_TRICKLOAD",
                "Team9Backdoor",
                "The Trick",
                "TheTrick",
                "Totbrick",
                "TrickBot",
                "TrickLoader",
                "TrickMo",
                "Upatre",
                "bazaloader",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "08c8f238-1df5-4e75-b4d8-276ebead502d",
            "created_at": "2023-01-06T13:46:39.344081Z",
            "updated_at": "2025-03-27T02:00:03.056208Z",
            "deleted_at": null,
            "main_name": "Copy-Paste",
            "aliases": [],
            "source_name": "MISPGALAXY:Copy-Paste",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "bc119938-a79c-4e5f-9d4d-dc96835dfe2e",
            "created_at": "2024-06-04T02:03:07.799286Z",
            "updated_at": "2025-03-27T02:05:17.337094Z",
            "deleted_at": null,
            "main_name": "GOLD BLACKBURN",
            "aliases": [
                "Periwinkle Tempest ",
                "Wizard Spider ",
                "ITG23 "
            ],
            "source_name": "Secureworks:GOLD BLACKBURN",
            "tools": [
                " Buer Loader",
                " Dyre",
                " Team9",
                " TrickBot",
                "BazarLoader"
            ],
            "source_id": "Secureworks",
            "reports": null
        }
    ],
    "ts_created_at": 1673536219,
    "ts_updated_at": 1743041627,
    "ts_creation_date": 1653779542,
    "ts_modification_date": 1653779542,
    "files": {
        "pdf": "https://archive.orkl.eu/46ceedee9ca12eea6b5f5b36f3d97a7f6c64a522.pdf",
        "text": "https://archive.orkl.eu/46ceedee9ca12eea6b5f5b36f3d97a7f6c64a522.txt",
        "img": "https://archive.orkl.eu/46ceedee9ca12eea6b5f5b36f3d97a7f6c64a522.jpg"
    }
}