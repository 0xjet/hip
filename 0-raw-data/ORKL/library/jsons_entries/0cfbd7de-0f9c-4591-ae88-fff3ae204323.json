{
    "id": "0cfbd7de-0f9c-4591-ae88-fff3ae204323",
    "created_at": "2023-01-12T15:07:48.121818Z",
    "updated_at": "2025-03-27T02:05:36.891625Z",
    "deleted_at": null,
    "sha1_hash": "b9b9987e9f5f9697deea94fab32ca20ca33c1c51",
    "title": "2021-09-01 - STRRAT- a Java-based RAT that doesn't care if you have Java",
    "authors": "",
    "file_creation_date": "2022-05-28T00:22:42Z",
    "file_modification_date": "2022-05-28T00:22:42Z",
    "file_size": 3988976,
    "plain_text": "# SANS ISC: InfoSec Handlers Diary Blog - SANS Internet Storm Center SANS Site Network Current Site SANS Internet Storm Center Other SANS Sites Help Graduate Degree Programs Security Training Security Certification Security Awareness Training Penetration Testing Industrial Control Systems Cyber Defense Foundations DFIR Software Security Government OnSite Training InfoSec Handlers Diary Blog\n\n**isc.sans.edu/diary/rss/27798**\n\n## STRRAT: a Java-based RAT that doesn't care if you have Java\n\n**Published: 2021-09-01**\n\n**Last Updated: 2021-09-01 00:15:49 UTC**\n\n**by** [Brad Duncan (Version: 1)](https://isc.sans.edu/handler_list.html#brad-duncan)\n\n[0 comment(s)](https://isc.sans.edu/forums/diary/STRRAT+a+Javabased+RAT+that+doesnt+care+if+you+have+Java/27798/#comments)\n**_Introduction_**\n\n[STRRAT was discovered earlier this year as a Java-based Remote Access Tool (RAT) that](https://malpedia.caad.fkie.fraunhofer.de/details/jar.strrat)\n[does not require a preinstalled Java Runtime Environment (JRE). It has been distributed](https://www.gdatasoftware.com/blog/strrat-crimson)\nthrough malicious spam (malspam) during 2021. Today's diary reviews an infection\n[generated using an Excel spreadsheet discovered on Monday, 2021-08-30.](https://bazaar.abuse.ch/sample/f148e9a2089039a66fa624e1ffff5ddc5ac5190ee9fdef35a0e973725b60fbc9/)\n\nDuring this infection, STRRAT was installed with its own JRE environment. It was part of a\nzip archive that contained JRE version 8 update 261, a .jar file for STRRAT, and a command\nscript to run STRRAT using JRE from the zip archive.\n\n_Shown above: Chain of events for the STRRAT infection on Monday 2021-08-30._\n\n\n-----\n\n**_The Excel spreadsheet_**\n\n[This Excel spreadsheet was submitted to bazaar.abuse.ch on Monday 2021-08-30. It likely](https://bazaar.abuse.ch/sample/f148e9a2089039a66fa624e1ffff5ddc5ac5190ee9fdef35a0e973725b60fbc9/)\n[was distributed through email, since previously-documented examples like this one were](https://twitter.com/ankit_anubhav/status/1425359221579608067)\ndistributed through email.\n\n_Shown above: Screenshot of the spreadsheet used for the STRRAT infection._\n\n**_Initial infection activity_**\n\nIf a victim opens the spreadsheet and enables macros on a vulnerable Windows host, the\nmacro code generates unencrypted HTTP traffic to 54.202.26[.]55. Testing the spreadsheet\nin a lab environment, we saw an HTTP GET request that returned approximately 18.7 kB of\nASCII symbols with no letters or numbers.\n\n\n-----\n\n_Shown above: First HTTP GET request and response caused by the Excel macro._\n\nThe second HTTP request to the same IP address returned a zip archive that was\napproximately 72.1 MB.\n\n\n-----\n\n_Shown above: The second HTTP GET request to 54.202.26[.]55 returned a 72.1 MB zip_\n_archive._\n\nThe zip was saved under a newly-created at C:\\User (very close in spelling to C:\\Users),\nthen the contents were extracted, and the saved zip archive was deleted.\n\n\n-----\n\n_Shown above: Location the zip archive was saved to on the infected host._\n\n_Shown above: Extracted contents of the zip archive include JRE, a .jar file for STRRAT, and_\n_a script to run STRRAT._\n\n\n-----\n\n_Shown above: Version file shows JRE version 8 update 261), and sys.cmd contains script to_\n_run the STRRAT .jar file._\n\n**_Infection traffic_**\n\nRAT-based post-infection traffic is often easy to spot, since many RATs use non-web-based\nTCP ports. Furthermore, traffic for the initial zip archive was over unencrypted HTTP.\nFinally, we saw HTTPS traffic to legitimate domains from Github and maven.org that\nappeared to be caused by the infection process.\n\n_Shown above: Traffic from the infection filtered in Wireshark._\n\n\n-----\n\n_Shown above: TCP stream of post-infection traffic generated by STRRAT._\n\n**_Indicators of Compromise (IOCs)_**\n\nThe following malware was retrieved from an infected Windows host:\n\n[SHA256 hash: f148e9a2089039a66fa624e1ffff5ddc5ac5190ee9fdef35a0e973725b60fbc9](https://www.virustotal.com/gui/file/f148e9a2089039a66fa624e1ffff5ddc5ac5190ee9fdef35a0e973725b60fbc9/detection)\n\nFile size: 71,350 bytes\nFile name: purchase order-419617892#..xlsb\nFile description: Excel spreadsheet with macro for STRRAT\n\nSHA256 hash:\n[cd6f28682f90302520ca88ce639c42671a73dc3e6656738e20d2558260c02533](https://www.virustotal.com/gui/file/cd6f28682f90302520ca88ce639c42671a73dc3e6656738e20d2558260c02533/detection)\n\nFile size: 72,050,185 bytes\nFile location: hxxp://54.202.26[.]55/esfsdghfrzeqsdffgfrtsfd.zip\nFile location: C:\\User\\xxrrffftttb55bb.zip\nFile description: zip archive retrieved by macro from Excel spreadsheet\n\n\n-----\n\nNote: This package contains Java Runtime Environment (JRE) verion 8 update 261\nand a .jar file for STRRAT\n\nSHA256 hash:\n[685549196c77e82e6273752a6fe522ee18da8076f0029ad8232c6e0d36853675](https://www.virustotal.com/gui/file/685549196c77e82e6273752a6fe522ee18da8076f0029ad8232c6e0d36853675/detection)\n\nFile size: 222,711 bytes\nFile location: C:\\User\\x.jar\nFile description: STRRAT .jar file from the above zip archive\nRun method: CMD.EXE /C C:\\User\\bin\\java.exe -jar C:\\User\\x.jar\n\nThe following traffic occured on an infected Windows host:\n\n54.202.26[.]55 port 80 - 54.202.26[.]55 - GET /oo\n54.202.26[.]55 port 80 - 54.202.26[.]55 - GET /esfsdghfrzeqsdffgfrtsfd.zip\nport 443 - repo1.maven.org - HTTPS traffic (not inherently malicious)\nport 443 - github.com - HTTPS traffic (not inherently malicious)\nport 443 - github-releases.githubusercontent.com - HTTPS traffic (not inherently\n_malicious)_\nDNS query for str-master[.]pw - response: No such name\n105.109.211[.]84 port 1990 - idgerowner.duckdns[.]org - TCP traffic generated by\nSTRRAT\nport 80 - ip-api.com - GET /json/ (not inherently malicious)\n\n**_Final words_**\n\nThis specific STRRAT infection was notable because it included JRE version 8 update 261\nas part of the infection package. Including JRE allows this Java-based RAT to run on\nvulnerable Windows hosts whether or not they have Java installed.\n\nThe host I used for testing had a more recent version of Java, but this sample didn't care. It\nsent its own version of JRE anyway.\n\nFortunately, default security settings in Windows 10 and Microsoft Office should prevent this\nparticular STRRAT infection chain.\n\nMass-distribution methods like malspam remain cheap and profitable for cyber criminals, so\nwe expect to see STRRAT and other types of commonly-distributed malware in the coming\nmonths.\n\n[A pcap of the infection traffic and malware from the infected host can be found here.](https://www.malware-traffic-analysis.net/2021/08/30/index2.html)\n\n--\nBrad Duncan\nbrad [at] malware-traffic-analysis.net\n\n\n-----\n\n[Keywords: excel](https://isc.sans.edu/tag.html?tag=excel) [macros](https://isc.sans.edu/tag.html?tag=macros) [malware](https://isc.sans.edu/tag.html?tag=malware) [rat](https://isc.sans.edu/tag.html?tag=rat) [strrat](https://isc.sans.edu/tag.html?tag=strrat)\n[0 comment(s)](https://isc.sans.edu/forums/diary/STRRAT+a+Javabased+RAT+that+doesnt+care+if+you+have+Java/27798/)\n\nJoin us at SANS! Attend [with Brad Duncan in starting](https://isc.sans.edu/diary/rss/27798)\n\nTop of page\n√ó\n\n[Diary Archives](https://isc.sans.edu/diaryarchive.html)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-09-01 - STRRAT- a Java-based RAT that doesn't care if you have Java.pdf"
    ],
    "report_names": [
        "2021-09-01 - STRRAT- a Java-based RAT that doesn't care if you have Java.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673536068,
    "ts_updated_at": 1743041136,
    "ts_creation_date": 1653697362,
    "ts_modification_date": 1653697362,
    "files": {
        "pdf": "https://archive.orkl.eu/b9b9987e9f5f9697deea94fab32ca20ca33c1c51.pdf",
        "text": "https://archive.orkl.eu/b9b9987e9f5f9697deea94fab32ca20ca33c1c51.txt",
        "img": "https://archive.orkl.eu/b9b9987e9f5f9697deea94fab32ca20ca33c1c51.jpg"
    }
}