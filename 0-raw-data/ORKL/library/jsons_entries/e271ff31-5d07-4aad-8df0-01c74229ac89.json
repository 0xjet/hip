{
    "id": "e271ff31-5d07-4aad-8df0-01c74229ac89",
    "created_at": "2023-01-12T15:03:07.629864Z",
    "updated_at": "2025-03-27T02:09:18.691359Z",
    "deleted_at": null,
    "sha1_hash": "4c4d311d15b22c8b43266c2310aa68157df9d210",
    "title": "2021-05-07 - Stats from Hunting Cobalt Strike Beacons",
    "authors": "",
    "file_creation_date": "2022-05-28T21:40:13Z",
    "file_modification_date": "2022-05-28T21:40:13Z",
    "file_size": 99366,
    "plain_text": "# Stats from Hunting Cobalt Strike Beacons\n\n**[svch0st.medium.com/stats-from-hunting-cobalt-strike-beacons-c17e56255f9b](https://svch0st.medium.com/stats-from-hunting-cobalt-strike-beacons-c17e56255f9b)**\n\nsvch0st May 6, 2021\n\nsvc\nh0st\n\n\n[svch0st](https://svch0st.medium.com/?source=post_page-----c17e56255f9b--------------------------------)\n\nMay 6, 2021\n\n\n4 min read\n\n## Some Statistics on Cobalt Strike Configs in April and May 2021\n\nCollected from over 1000 configurations, here are some high-level statistics that demonstrate\nsome of the common trends among one of the most popular tools in an adversary’s arsenal.\nThese configs were collected from live servers around early May 2021.\n\nIf you are interested in how the data was collected, scroll to the bottom of the article.\n\nIf you want to read more about how the configurations are structured in Cobalt Strike payloads\nhis article is a good start:\n\n## Cobalt Strike Staging and Extracting Configuration Information\n\n### By default Cobalt Strike exposes its stager shellcode via a valid checksum8 request (the same request format used in…\n\nblog.securehat.co.uk\n\n**Most common watermark**\n\n\n-----\n\nUnsurprisingly most common watermark was 0. The watermark of 0 is indicative of cracked\nversions for Cobalt Strike which are commonly used by threat actors in their campaigns. More\ninterestingly is 305419896, 1359593325, and 1580103814, all had configuration counts above\n100.\n\nThe watermark 305419896 has been associated with the Maze ransomware:\n\n## Enter the Maze: Demystifying an Affiliate Involved in Maze (SNOW) - SentinelLabs\n\n### By Jason Reaves and Joshua Platt Maze continues to be one of the most dangerous and actively developed ransomware…\n\nlabs.sentinelone.com\n\n**User Agents**\n\nBesides the standard user agents imitating web browsers, several configurations had the user\nagent of “Shockwave Flash”\n\n**Interesting URI**\n\nThe more standard URIs of /submit.php and /jquery-3.3.2.min.js were the most common but this\none stood out to me:\n\n/r/webdev/comments/95lyr/slow_loading_of_google\n\n**Most common process spawn targets**\n\nThe default values of rundll32.exe were the most common.\n\n\n-----\n\nLooking at the information, I was most interested in some of the more custom values such as:\n\n%windir%\\syswow64\\eventvwr.exe\n%windir%\\syswow64\\backgroundtaskhost.exe\n%windir%\\system32\\mobsync.exe\n%windir%\\sysnative\\adobe64.exe\n\n## How I collected the Data\n\nI used 2 main queries to get as many C2 IPs as quickly as possible.\n\nRiskIQ prebuild component to search for (requires a free account) (~8k IPs)\nA search on JARM hashes that I had found in a recent case (~10k IPs):\n```\nJARMFuzzy: 07d14d16d21d21d07c42d41d00041d\n\n```\nIf you want to learn more about JARM, which is developed by the Salesforce team, this is a\ngreat article:\n\n## Easily Identify Malicious Servers on the Internet with JARM\n\n### JARM is an active Transport Layer Security server fingerprinting tool that provides the ability to identify and group…\n\nengineering.salesforce.com\n\n\n-----\n\nThis data contained many IPs that were burnt by the time of analysis; however, it still provided a\ndecent enough dataset to get some results.\n\n## Retreiving the Configs\n\nI had two ideas for harvesting configs; one would be downloading the binary payload from\nsources like Virustotal and MalwareBazaar and parsing them.\n\n**But if we know the IPs already, let's just ask the servers for the config?**\n\nThere are a bunch of awesome tools that exist for extracting and parsing Cobalt beacon\nconfigs, but the one I used for this was a Nmap NSE script by Wade Hickey.\n\n## whickey-r7/grab_beacon_config\n\n### Permalink Failed to load latest commit information. No description, website, or topics provided. You can't perform that…\n\ngithub.com\n\nI had added some error exception handling and most importantly an extra line to pull out the\nbeacon Watermark (or license number) which is very helpful for threat intelligence.\n\n\n-----\n\nSee my fork here:\n\n## svch0stz/grab_beacon_config\n\n### Contribute to svch0stz/grab_beacon_config development by creating an account on GitHub.\n\ngithub.com\n\nI then used the IP lists I had as input and ran the Nmap script.\n```\nnmap --script=grab_beacon_config.nse -p 80,443,8080 -iL jarmfuzzy.txt -oA jarmfuzzy -T4\n\n```\n\n-----\n\nThe output of the script will look something like this:\n```\n|_grab_beacon_config: {\"x86\": {\"uri_queried\": \"\\/DxRN\", \"md5\":\n\"7118007ad133a9dcd59419beef0896a5\", \"config\": {\"Jitter\": 0, \"Spawn To x64\":\n\"%windir%\\\\system32\\\\mobsync.exe\", \"Max DNS\": 255, \"C2 Server\":\n\"thefaithfulamerican.com,\\/s\\/ref=nb_sb_noss\", \"DNS Sleep\": 0, \"HTTP Method Path 2\":\n\"\\/gp\\/product\\/sessionCacheUpdateHandler.html\", \"Method 2\": \"POST\", \"Pipe Name\": \"\",\n\"Polling\": 5000, \"Spawn To x86\": \"%windir%\\\\syswow64\\\\nslookup.exe\", \"Method 1\": \"GET\",\n\"Port\": 443, \"Beacon Type\": \"8 (HTTPS)\", \"DNS Idle\": \"0.0.0.0\", \"C2 Host Header\": \"\",\n\"User Agent\": \"5.0 (Windows NT 10.0) AppleWebKit\\/537.36 (KHTML, like Gecko)\nChrome\\/99.0.7113.93 Safari\\/537.36\", \"Header 2\": \"\", \"Watermark\": 1, \"Header 1\": \"\"},\n\"sha1\": \"590d700e79f71222c959cc2be46070725c5f76a1\", \"time\": 1619933006124.8, \"sha256\":\n\"f89869fd338c4ef527f31f836308f9906a3991ac45d6f56d4004eea8f91e6ca3\"}, \"x64\":\n{\"uri_queried\": \"\\/1aZq\", \"md5\": \"bf1ca95090d0870729c72b216b7964b5\", \"config\":\n{\"Jitter\": 0, \"Spawn To x64\": \"%windir%\\\\system32\\\\mobsync.exe\", \"Max DNS\": 255, \"C2\nServer\": \"thefaithfulamerican.com,\\/s\\/ref=nb_sb_noss\", \"DNS Sleep\": 0, \"HTTP Method\nPath 2\": \"\\/gp\\/product\\/sessionCacheUpdateHandler.html\", \"Method 2\": \"POST\", \"Pipe\nName\": \"\", \"Polling\": 5000, \"Spawn To x86\": \"%windir%\\\\syswow64\\\\nslookup.exe\", \"Method\n1\": \"GET\", \"Port\": 443, \"Beacon Type\": \"8 (HTTPS)\", \"DNS Idle\": \"0.0.0.0\", \"C2 Host\nHeader\": \"\", \"User Agent\": \"5.0 (Windows NT 10.0) AppleWebKit\\/537.36 (KHTML, like\nGecko) Chrome\\/99.0.7113.93 Safari\\/537.36\", \"Header 2\": \"\", \"Watermark\": 1, \"Header 1\":\n\"\"}, \"sha1\": \"f4cf79e7735053836fe7e435d7b0c0a511aa2ea6\", \"time\": 1619933013556.5,\n\"sha256\": \"bf4ee9664fba51a1bbbdad13a598688914a48465fac3993c096c6d2cc0c2c021\"}}\n\n```\nFrom there, it was an exercise of cleaning up the data into something useable and using Excelfu to get some ugly pie graphs :)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-05-07 - Stats from Hunting Cobalt Strike Beacons.pdf"
    ],
    "report_names": [
        "2021-05-07 - Stats from Hunting Cobalt Strike Beacons.pdf"
    ],
    "threat_actors": [
        {
            "id": "610a7295-3139-4f34-8cec-b3da40add480",
            "created_at": "2023-01-06T13:46:38.608142Z",
            "updated_at": "2025-03-27T02:00:02.87217Z",
            "deleted_at": null,
            "main_name": "Cobalt",
            "aliases": [
                "Cobalt Gang",
                "GOLD KINGSWOOD",
                "COBALT SPIDER",
                "G0080",
                "Mule Libra",
                "Cobalt Group"
            ],
            "source_name": "MISPGALAXY:Cobalt",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "70872c3a-e788-4b55-a7d6-b2df52001ad0",
            "created_at": "2023-01-06T13:46:39.18401Z",
            "updated_at": "2025-03-27T02:00:03.01553Z",
            "deleted_at": null,
            "main_name": "UNC2452",
            "aliases": [
                "DarkHalo",
                "StellarParticle",
                "NOBELIUM",
                "Solar Phoenix",
                "Midnight Blizzard"
            ],
            "source_name": "MISPGALAXY:UNC2452",
            "tools": [
                "SNOWYAMBER",
                "HALFRIG",
                "QUARTERRIG"
            ],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673535787,
    "ts_updated_at": 1743041358,
    "ts_creation_date": 1653774013,
    "ts_modification_date": 1653774013,
    "files": {
        "pdf": "https://archive.orkl.eu/4c4d311d15b22c8b43266c2310aa68157df9d210.pdf",
        "text": "https://archive.orkl.eu/4c4d311d15b22c8b43266c2310aa68157df9d210.txt",
        "img": "https://archive.orkl.eu/4c4d311d15b22c8b43266c2310aa68157df9d210.jpg"
    }
}