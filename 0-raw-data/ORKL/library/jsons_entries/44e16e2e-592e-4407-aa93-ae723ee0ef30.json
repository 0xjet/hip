{
    "id": "44e16e2e-592e-4407-aa93-ae723ee0ef30",
    "created_at": "2023-01-12T15:07:09.018178Z",
    "updated_at": "2025-03-27T02:16:26.257708Z",
    "deleted_at": null,
    "sha1_hash": "64786c6fd8087e41b933c2fb1130c1103962f41d",
    "title": "2021-05-11 - Android overlay attacks on Belgian financial applications",
    "authors": "",
    "file_creation_date": "2022-05-27T21:27:15Z",
    "file_modification_date": "2022-05-27T21:27:15Z",
    "file_size": 2128857,
    "plain_text": "# New mobile malware family now also targets Belgian financial apps\n\n**[blog.nviso.eu/2021/05/11/android-overlay-attacks-on-belgian-financial-applications/](https://blog.nviso.eu/2021/05/11/android-overlay-attacks-on-belgian-financial-applications/)**\n\nMay 11, 2021\n\nWhile banking trojans have been around for a very long time now, we have never seen a\nmobile malware family attack the applications of Belgian financial institutions. Until today…\n\nEarlier this week, the Italy-based Cleafy published an article about a new android malware\nfamily which they dubbed TeaBot. The sample we will take a look at doesn’t use a lot of\nobfuscation and only has a limited set of features. What is interesting though, is that TeaBot\nactually does attack the mobile applications of Belgian financial institutions.\n\nThis is quite surprising since Banking trojans typically use a phishing attack to acquire the\ncredentials of unsuspecting victims. Those credentials would be fairly useless against\nBelgian financial applications as they all have secure device enrollment and authentication\nflows which are resilient against a phishing attack.\n\nSo let’s take a closer look at how these banking trojans work, how they are actually trying to\nattack Belgian banking apps and what can be done to protect these apps.\n\n### TL;DR\n\nTypical banking malware uses a combination of Android accessibility services and\noverlay windows to construct an elaborate phishing attack\nBelgian apps are being targeted with basic phishing attacks and keyloggers which\nshould not result in an account takeover\n\n## Android Overlay Attacks\n\n\n-----\n\nThere have been numerous articles written on Android Overlay attacks, including a very\n[recent one from F-Secure labs: “How are we doing with Android’s overlay attacks in 2020?”](https://labs.f-secure.com/blog/how-are-we-doing-with-androids-overlay-attacks-in-2020/)\nFor those who have never heard of it before, let’s start with a small overview.\n\n## Drawing on top of other apps through overlays (SYSTEM_ALERT_WINDOW)\n\nThe Android OS allows apps to draw on top of other apps after they have obtained the\n```\nSYSTEM_ALERT_WINDOW permission. There are valid use cases for this, with Facebook\n\n```\nMessenger’s chat heads being the typical example. These chat bubbles stay on top of any\nother application to allow the user to quickly access their conversations without having to go\nto the Messenger app.\n\nOverlays have two interesting properties: whether or not they are transparent, and whether\nor not they are interactive. If an overlay is transparent you will be able to see whatever is\nunderneath the overlay (either another app or the home screen), and if an overlay is\ninteractive it will register any screen touches, while the app underneath will not. Below you\ncan see two examples of this. On the left, there’s Facebook’s Messenger app, which has\nmay interactive views, but also some transparent parts at the top, while on the right you see\nTwilight, which is a blue light filter that covers the entire screen in a semi-transparent way\nwithout any interactive elements in the overlay. The controls that you do see with Twilight is\nthe actual Twilight app that’s opened underneath the red overlay.\n\n\n-----\n\nUntil very recently, if the app was installed through the Google Play store (instead of through\nsideloading or third party app stores), the application automatically received this\npermission, without even a confirmation dialog for the user! After much abuse by Banking\nmalware that was installed through the Play store, Google has now added an additional\nmanual verification step in the approval process for apps on the Google Play store. If the app\nwants to have the permission without requesting it from the user, the app will need to request\nspecial permission from Google. But of course, an app can still manually request this\npermission from the user, and Android’s information for this permission looks rather innocent:\n“This may interfere with your use of other apps”.\n\n\n-----\n\nThe permission is fairly benign in the hands of the Facebook Messenger app or Twilight, but\nfor mobile malware, the ability to draw on top of other apps is extremely interesting. There\nare a few ways in which you can use this to attack the user:\n\n1. Create a fake UI on top of a real app that tricks the user into touching specific locations\n\non the screen. Those locations will not be interactive, and will thus propagate the touch\nto the underlying application. As a result, the user performs actions in the underlying\napp without realizing it. This is often called Tapjacking.\n\n\n-----\n\n2. Create interactive fields on top of key fields of the app in order to harvest information\n\nsuch as usernames and passwords. This would require the overlay to track what is\nbeing shown in the app, so that it can correctly align its own buttons text fields. All in all\nquite some work and not often used to attack the user.\n3. Instead of only overlaying specific buttons, the overlay covers the entire app and\n\npretends to be the app. A fully functional app (usually a webview) is shown on top of\nthe targeted app and asks the user for their credentials. This is a full overlay attack.\n\nThese are just three possibilities, but there are many more. Researchers from Georgia Tech\nand the UC Santa Barbara have documented different attacks in their paper which also\nintroduces the Cloak and Dagger attacks explained below.\n\nBefore we get into Cloak and Dagger, let’s take a look at a few other dangerous Android\npermissions first.\n\n## Accessibility services\n\nApplications on Android can request the accessibility services permission, which allows them\nto simulate button presses or interact with UI elements outside of their own application.\nThese apps are very useful to people with disabilities who need a bit of extra help to navigate\ntheir smartphone. For example, the Google TalkBack application will read out any UI element\nthat is touched on the screen, and requires a double click to actually register as a button\npress. An alternative application is the Voice Access app which tags every UI element with a\nnumber and allows you to select them by using voice commands.\n\n\n-----\n\n-----\n\n-----\n\n-----\n\n-----\n\n-----\n\nLeft: Giving permission to the TalkBack service. Android clearly indicates the dangers of\ngiving this permission\nMiddle: TalkBack uses text-to-speech to read the description that the user taps\nRight: Voice Access adds a button to each UI control and allows you to click them through\nvoice commands\nBoth of these applications can read UI elements and perform touches on the user’s behalf.\nJust like overlay windows, this can be a very nice feature, or very dangerous if abused.\nMalware could use accessibility services to create a keylogger which collects the input of a\ntext field any time data is entered, or it could press buttons on your behalf to purchase\npremium features or subscriptions, or even just click advertisements.\n\nSo let’s take a quick look at what kind of information becomes available by installing the\n[Screen Logger app. The Screen Logger app is a legitimate application that uses accessibility](https://play.google.com/store/apps/details?id=com.wultra.app.screenlogger)\nfeatures to monitor your actions. At the time of writing, the application doesn’t even request\n```\nINTERNET permission, so it shouldn’t be stealing your data in any way. However, it’s always\n\n```\nbest to do these tests on a device without sensitive data which you can factory-reset. The\napplication is very basic:\n\nInstall the accessibility service\nClick the record button\nPerform some actions and enter some text\nClick the stop recording button\n\nThe app will then show all the information it has collected. Below are some examples of the\ninformation it collected from a test app:\n\n\n-----\n\n-----\n\n-----\n\n-----\n\n-----\n\n-----\n\nThe Screen logger application shows the data that was collected through an accessibility\nservice\nWhen enabling accessibility services, users are actually warned about the dangers of\nenabling accessibility. This makes it a bit harder to trick the user into granting this\npermission. More difficult, but definitely not impossible. Applications actually have a lot of\ncontrol over the information that is shown to the user. Take for example the four screens\nbelow, which belong to a malware sample. All of the text indicated with red is under control of\nthe attacker. The first screen shows a popup window asking the user to enable the Google\nservice (which is, of course, the name of the malware’s service), and the next three screens\nare what the user sees while enabling the accessibility permission.\n\nTricking users into installing an accessibility service\nEven if malware can’t convince the user to give the accessibility permission, there’s still a\nway to trick them using overlay windows. This approach is exactly what Cloak and Dagger\ndoes.\n\n## Cloak and Dagger\n\nCloak and Dagger is best explained through their own video, where they show a combination\nof overlay attacks and accessibility to install an application that has all permissions enabled.\nIn the video shown below, anything that is red is non-transparent and interactive, while\neverything that is green or transparent is non-interactive and will let touches go through to\nthe app underneath.\n\n\n-----\n\nWatch Video At:\n\nhttps://youtu.be/RYQ1i03OVpI\n\nNow, over the past few years, Android has made efforts to hinder these kinds of attacks. For\nexample, on newer versions of Android, it’s not possible to configure accessibility settings in\ncase an overlay is active, or Android automatically disables any overlays when going into the\nAccessibility settings page. Unfortunately this only prevents a malware sample from giving\nitself accessibility permissions through overlays; it still allows malware to use social\nengineering tactics to trick users into installing them.\n\n## Read SMS permission\n\nFinally, another interesting permission for malware is the `RECEIVE_SMS permission, which`\nallows an application to read received SMS messages. While this can definitely be used to\ninvade the user’s privacy, the main reason for malware to acquire this permission is to\nintercept 2FA tokens which are unfortunately often still sent through SMS. Next to SIMswapping attacks and [attacks against the SS7 infrastructure, this is another way in which](https://www.theverge.com/2017/9/18/16328172/sms-two-factor-authentication-hack-password-bitcoin)\nthose tokens can be stolen.\n\nThis permission is pretty self-explanatory and a typical user will probably not grant the\npermission to a game that they just installed. However, by using phishing, overlays or\naccessibility attacks, malware can make sure the user accepts the permission.\n\n## Does this mean your device is fully compromised? Yes, and no.\n\nGiven the very intrusive nature of the attacks described above, it’s not a stretch to say that\nyour device is fully compromised. If malware can access what you see, monitor what you do\nand perform actions on your behalf, they’re basically using your device just like you would.\n\n\n-----\n\nHowever, the malware is still (ab)using legitimate functionality provided by the OS, and that\ndoes come with restrictions.\n\nFor example, even applications with full accessibility permissions aren’t able to access data\nthat is stored inside the application container of another app. This means that private\ninformation stored within an app is safe, unless you of course access the data through the\napp and the accessibility service actively collects everything on the screen.\n\nBy combining accessibility and overlay windows, it is actually much easier to social engineer\nthe victim and get their credentials or card information. And this is exactly what Banking\nTrojans often do. Instead of attacking an application and trying to steal their authentication\ntokens or modify their behavior, they simply ask the user for all the information that’s required\nto either authenticate to a financial website or enroll a new device with the user’s credentials.\n\n## How to protect your app\n\n Protecting against overlays\n\nProtecting your application against a full overlay is, well, impossible. Some research has\n[already been performed on this and one of the suggestions is to add a visual indicator on the](https://sites.cs.ucsb.edu/~chris/research/doc/oakland15_uideception.pdf)\ndevice itself that can inform the user about an overlay attack tacking place. Another study\n[took a look at detecting suspicious patterns during app-review to identify overlay malware.](https://ennanzhai.github.io/pub/yan19overlay.pdf)\nWhile the research is definitely interesting, it doesn’t really help you when developing an\napplication.\n\nAnd even if you could detect an overlay on top of your application. What could your\napplication do? There are a few options, but none of them really work:\n\nClose the application > Doesn’t matter, the attack just continues, since there’s a full\noverlay\nShow something to the user to warn them > Difficult, since you’re not the top-level view\nInform the backend and block the account > Possible, though many false negatives.\nImagine customer accounts being blocked because they have Facebook messenger\ninstalled…\n\nWhat remains is trying to detect an attack and informing your backend. Instead of directly\nblocking an account, the information could be taken into account when performing risk\nanalysis on a new sign-up or transaction. There are a few ways to collect this information,\nbut all of them can have many false positives:\n\nYou can detect if a screen has been obfuscated by listening for\nonFilterTouchEventForSecurity events. There are however various edge cases where it\ndoesn’t work as expected and will lead to many false negatives and false positives.\n\n\n-----\n\nYou can scan for installed applications and check if a suspicious application is installed.\nThis would require you to actively track mobile malware campaigns and update your\nblacklist accordingly. Given the fact that malware samples often have random package\nnames, this will be very difficult. Additionally, starting with [Android 11 (Q), it actually](https://medium.com/androiddevelopers/package-visibility-in-android-11-cc857f221cd9)\nbecomes impossible to scan for applications which you don’t define in your Android\nManifest.\nYou can use accessibility services yourself to monitor which views are created by the\nAndroid OS and trigger an error if specific scenarios occur. While this could technically\nwork, it would give people the idea that financial applications do actually require\naccessibility services, which would play into the hands of malware developers.\n\nThe only real feasible implementation is detection through the\n```\nonFilterTouchEventForSecurity handler, and, given the many false positives, it can\n\n```\nonly be used in conjunction with other information during a risk assessment.\n\n## Protecting against accessibility attacks\n\nUnfortunately it’s not much better than the section. There are many different settings you can\nset on views, components and text fields, but all of them are designed to help you improve\nthe accessibility of your application. Removing all accessibility data from your application\ncould help a bit, but this will of course also stop legitimate accessibility software from\nanalyzing your application.\n\nBut let’s for a moment assume that we don’t care about legitimate accessibility. How can we\nmake the app as secure as possible to prevent malware from logging our activities? Let’s\nsee…\n\n[We could set the android:importantForAccessibility attribute of a view component to](https://developer.android.com/reference/android/view/View#attr_android:importantForAccessibility)\n‘no’ or ‘noHideDescendants’. This won’t work however, since the accessibility service\ncan just ignore this property and still read everything inside the view component.\n[We could set all the android:contentDescription attributes to “@null”. This will](https://developer.android.com/reference/android/view/View#attr_android:contentDescription)\neffectively remove all the meta information from the application and will make it much\nmore difficult to track a user. However, any text that’s on screen can still be captured,\nso the label of a button will still give information about its purpose, even if there is no\ncontent description. For input text, the content of the text field will still be available to\nthe malware.\nWe could change every input text to a password field. Password fields are masked and\ntheir content isn’t accessible in clear-text format. Depending on the user’s settings, this\nwon’t work either (see next section).\n[Enable FLAG_SECURE on the view. This will prevent screenshots of the view, but it](https://developer.android.com/reference/android/view/Display#FLAG_SECURE)\ndoesn’t impact accessibility services.\n\n### About passwords\n\n\n-----\n\nBy default, Android shows the last entered character in a password field. This is useful for\nthe user as they are able to see if they mistyped something. However, whenever this preview\nis shown, the value is also accessible to the accessibility services. As a result, we can still\nsteal passwords, as shown in the second and third image below:\n\n\n-----\n\n-----\n\n-----\n\n-----\n\n-----\n\n-----\n\nLeft: A password being entered in ProxyDroid\nMiddle / Right: The entered password can be reconstructed based on the character previews\nIt is possible for users to disable this feature by going to Settings > Privacy > Show\n**Passwords, but this setting cannot be manipulated from inside an application.**\n\n### Detecting accessibility services\n\nIf we can’t protect our own application, can we maybe detect an attack? Here is where\nthere’s finally some good news. It is possible to retrieve all the accessibility services running\non the device, including their capabilities. This can be done through the\n[AccessibilityManager.getEnabledAccessibilityServiceList.](https://developer.android.com/reference/android/view/accessibility/AccessibilityManager.html#getEnabledAccessibilityServiceList(int))\n\nThis information could be used to identify suspicious services running on the device. This\nwould require building an dataset of known-good services to compare against. Given that\nGoogle is really hammering down on applications requiring accessibility services in the\nGoogle Play store, this could be a valid approach.\n\nThe obvious downside is that there will still be false positives. Additionally, there may be\nsome privacy related issues as well, since it might not be desirable to identify disabilities in\nusers.\n\n## Can’t Google fix this?\n\nFor a large part, dealing with these overlay attacks is Google’s responsibility, and over the\nlast few versions, they have made multiple changes to make it more difficult to use the\n```\nSYSTEM_ALERT_WINDOW (SAW) overlay permission:\n\n```\nAndroid Q (Go Edition) doesn’t support the SAW.\nSideloaded apps on Android P loose the SAW permission upon reboot.\nAndroid O has marked the SAW permission deprecated, though Android 11 has\nremoved the deprecated status.\nPlay Store apps on Android Q loose the permission on reboot.\nAndroid O shows a notification for apps that are performing overlays, but also allows\nyou to disable the notifications through settings (and thus through accessibility as well).\nAndroid Q introduced the Bubbles API, which deals with some of the use cases for\nSAW, but not all of them.\n\nAlmost all of these updates are mitigations and don’t fix the actual problem. Only the removal\nof SAW in Android Q (Go Edition) is a real way to stop overlay attacks, and it may hopefully\none day make it into the standard Android version as well.\n\n\n-----\n\n**Android 12 Preview**\n\nThe latest version of the Android 12 preview actually contains a new permission called\n[‘HIDE_OVERLAY_WINDOWS‘. After acquiring this permission, an app can call](https://developer.android.google.cn/about/versions/12/features#hide-application-overlay-windows)\n‘setHideOverlayWindows()’ to disable overlays. This is another step in the right direction, but\nit’s still far from great. Instead of targeting the application when the user opens it, the\nmalware could still create fake notifications that link directly to the overlay without the\ntargeted application even being opened.\n\nIt’s clear that it’s not an easy problem to fix. Developers were given the option to use SAW\nsince Android 1, and many apps rely on the permission to provide their core functionality.\nRemoving it would affect many apps, and would thus get a lot of backlash. Finally, any new\nupdate that Google makes will take many years to reach a high percentage of Android users,\ndue to Android’s slow update process and unwillingness for mobile device manufacturers to\nprovide major OS updates to users.\n\nNow that we understand the permissions involved, let’s go back to the TeaBot malware.\n\n## TeaBot – Attacking Belgian apps\n\nWhat was surprising about Cleafy’s original report is the targeting of Belgian applications\nwhich so far had been spared of similar attacks. This is also a bit surprising since Belgian\nfinancial apps all make use of strong authentication (card readers, ItsMe, etc) and are thus\npretty hard to successfully phish. Let’s take a look at how exactly the TeaBot family attacks\nthese applications.\n\nOnce the TeaBot malware is installed, it shows a small animation to the user how to enable\naccessibility options. It doesn’t provide a specific explanation for the accessibility service,\nand it doesn’t pretend to be a Google or System service. However, if you wait too long to\nactivate the accessibility service, the device will regularly start vibrating, which is extremely\nannoying and will surely convince many victims to enable the services.\n\n\n-----\n\nMain\n\n\n-----\n\nview when opening the app\n\n\n-----\n\n-----\n\nAutomatically opens the Accessibility Settings\n\n\n-----\n\nNo\n\n\n-----\n\ndescription of the service\n\n\n-----\n\nThe\n\n\n-----\n\nservice requests full control\n\n\n-----\n\nIf you\n\n\n-----\n\nwait too long, you get annoying popups and vibration\n\n\n-----\n\nAfter\n\n\n-----\n\nenabling the service, the application quits and shows an error message\n\nThis specific sample pretends to be bpost, but TeaBot also pretends to be the VLC Media\nPlayer, the Spanish postal app Correos, a video streaming app called Mobdro, and UPS as\nwell.\n\nThe malware sample has the following functionality related to attacking financial applications:\n\nTake a screenshot;\nPerform overlay attacks on specific apps;\nEnable keyloggers for specific apps.\n\nJust like the [FluBot sample from our last blogpost, the application collects all of the installed](https://blog.nviso.eu/2021/04/19/how-to-analyze-mobile-malware-a-cabassous-flubot-case-study/)\napplications and then sends them to the C2 which returns a list of the applications that\nshould be attacked:\n```\nPOST /api/getbotinjects HTTP/1.1\nAccept-Charset: UTF-8\nContent-Type: application/xml\nUser-Agent: Dalvik/2.1.0 (Linux; U; Android 10; Nexus 5 Build/QQ3A.200805.001)\nConnection: close\nAccept-Encoding: gzip, deflate\nContent-Length: 776\n{\"installed_apps\":[{\"package\":\"org.proxydroid\"},\n{\"package\":\"com.android.documentsui\"}, ...<snip>...,\n{\"package\":\"com.android.messaging\"}]}\nHTTP/1.1 200 OK\nConnection: close\nContent-Type: application/json\nServer: Rocket\nContent-Length: 2\nDate: Mon, 10 May 2021 19:20:51 GMT\n[]\n\n```\nIn order to identify the applications that are attacked, we can supply a list of banking\napplications which will return more interesting data:\n\n\n-----\n\n```\nHTTP/1.1 200 OK\nConnection: close\nContent-Type: application/json\nServer: Rocket\nContent-Length: 2031830\nDate: Mon, 10 May 2021 18:28:01 GMT\n[\n     {\n          \"application\":\"com.kutxabank.android\",\n          \"html\":\"<!DOCTYPE html><html lang=\\\"en\\\"><head> ...SNIP...</html>\",\n          \"inj_type\":\"bank\"\n     },\n     {\n          \"application\":\"com.bbva.bbvacontigo\",\n          \"html\":\"<!DOCTYPE html><html lang=\\\"en\\\"><head> ...SNIP...</html>\"\n     }\n]\n\n```\nBy brute-forcing against different C2 servers, overlays for the following apps were returned:\n```\napp.wizink.es\nbe.belfius.directmobile.android\ncom.abanca.bancaempresas\ncom.abnamro.nl.mobile.payments\ncom.bancomer.mbanking\ncom.bankia.wallet\ncom.bankinter.launcher\ncom.bbva.bbvacontigo\ncom.bbva.netcash\ncom.cajasur.android\ncom.db.pwcc.dbmobile\ncom.facebook.katana\ncom.google.android.gm\ncom.grupocajamar.wefferent\ncom.ing.mobile\ncom.kutxabank.android\ncom.latuabancaperandroid\ncom.rsi\ncom.starfinanz.smob.android.sfinanzstatus\ncom.tecnocom.cajalaboral\ncom.unicredit\nde.comdirect.android\nde.commerzbanking.mobil\nes.bancosantander.apps\nes.cm.android\nes.ibercaja.ibercajaapp\nes.lacaixa.mobile.android.newwapicon\nes.liberbank.cajasturapp\nes.openbank.mobile\nes.univia.unicajamovil\nkeyloggers.json\nwww.ingdirect.nativeframe\n\n```\n\n-----\n\nOnly one Belgian financial application ( be.belfius.directmobile.android ) returned an\noverlay. The interesting part is that the overlay only phishes for credit card information and\nnot for anything related to account onboarding:\n\nThe overlay requests the debit card number, but nothing else.\n\nThis overlay will be shown when TeaBot detects that the Belfius app has been opened. This\nway the user will expect a Belfius prompt to appear, which gives more credibility to the\nmalicious view that was opened.\n\nThe original report by Cleafy specified at least 5 applications under attack, so we need to dig\na bit deeper. Another endpoint called by the samples is /getkeyloggers. Fortunately, this one\ndoes simply return a list of targeted applications without us having to guess.\n```\nGET /api/getkeyloggers HTTP/1.1\nAccept-Charset: UTF-8\nUser-Agent: Dalvik/2.1.0 (Linux; U; Android 10; Nexus 5 Build/QQ3A.200805.001)\nHost: 185.215.113.31\nConnection: close\nAccept-Encoding: gzip, deflate\nHTTP/1.1 200 OK\nConnection: close\nContent-Type: application/json\nServer: Rocket\nContent-Length: 1205\nDate: Tue, 11 May 2021 12:45:30 GMT\n[{\"application\":\"com.ing.banking\"},{\"application\":\"com.binance.dev\"},\n{\"application\":\"com.bankinter.launcher\"},{\"application\":\"com.unicredit\"},\n{\"application\":\"com.lynxspa.bancopopolare\"}, ... ]\n\n```\nScattered over multiple C2 servers, we could identify the following targeted applications:\n\n\n-----\n\n```\napp.wizink.es\nbe.argenta.bankieren\nbe.axa.mobilebanking\nbe.belfius.directmobile.android\nbe.bmid.itsme\nbe.keytradebank.phone\nbvm.bvmapp\ncom.abnamro.nl.mobile.payments\ncom.bancomer.mbanking\ncom.bankaustria.android.olb\ncom.bankia.wallet\ncom.bankinter.launcher\ncom.bbva.bbvacontigo\ncom.bbva.netcash\ncom.beobank_prod.bad\ncom.binance.dev\ncom.bnpp.easybanking\ncom.bnpp.easybanking.fintro\ncom.bpb.mobilebanking.smartphone.prd\ncom.cajasur.android\ncom.coinbase.android\ncom.db.pbc.miabanca\ncom.db.pbc.mibanco\ncom.db.pbc.mybankbelgium\ncom.db.pwcc.dbmobile\ncom.grupocajamar.wefferent\ncom.ing.banking\ncom.ing.mobile\ncom.kbc.mobile.android.phone.kbc\ncom.kbc.mobile.android.phone.kbcbrussels\ncom.kutxabank.android\ncom.latuabancaperandroid\ncom.lynxspa.bancopopolare\ncom.mobileloft.alpha.droid\ncom.starfinanz.smob.android.bwmobilbanking\ncom.starfinanz.smob.android.sfinanzstatus\ncom.triodos.bankingnl\ncom.unicredit\nde.comdirect.android\nde.commerzbanking.mobil\nde.dkb.portalapp\nde.fiducia.smartphone.android.banking.vr\nde.ingdiba.bankingapp\nde.postbank.finanzassistent\nde.santander.presentation\nde.sdvrz.ihb.mobile.secureapp.sparda.produktion\nde.traktorpool\nes.bancosantander.apps\nes.cm.android\nes.evobanco.bancamovil\nes.ibercaja.ibercajaapp\nes.lacaixa.mobile.android.newwapicon\nes.liberbank.cajasturapp\nes.openbank.mobile\nes.univia.unicajamovil\n\n```\n\n-----\n\n```\neu.unicreditgroup.hvbapptan\nit.bnl.apps.banking\nit.gruppobper.ams.android.bper\nit.nogood.container\nit.popso.SCRIGNOapp\nnet.inverline.bancosabadell.officelocator.android\nnl.asnbank.asnbankieren\nnl.rabomobiel\nnl.regiobank.regiobankieren\npiuk.blockchain.android\nposteitaliane.posteapp.appbpol\nvivid.money\nwww.ingdirect.nativeframe\n\n```\nBased on this list, 14 Belgian applications are being attacked through the keylogger\nmodule. Since all these applications have a strong device onboarding and authentication\nflow, the impact of the collected information should be limited.\n\nHowever, if the applications don’t detect the active keylogger, the malware could still collect\nany information entered by the user into the app. In this regard, the impact is the same as\nwhen someone installs a malicious keyboard that logs all the entered information.\n\n**Google Play Protect will protect you**\n\nThe TeaBot sample is currently not known to spread in the Google Play store. That means\nvictims will need to install it by downloading and installing the app manually. Most devices will\nhave Google Play protect installed, which will automatically block the currently identified\nTeaBot samples.\n\nOf course, this is a typical cat & mouse game between Google and malware developers, and\nwho knows how many samples may go undetected …\n\n## Conclusion\n\nIt’s very interesting to see how TeaBot attacks the Belgian financial applications. While they\ndon’t attempt to social engineer a user into a full device onboarding, the malware developers\nare finally identifying Belgium as an interesting target.\n\nIt will be very interesting to see how these attacks will evolve. Eventually all financial\napplications will have very strong authentication and then malware developers will either\nhave to be satisfied with only stealing credit-card information, or they will have to invest into\nmore advanced tactics with live challenge/responses and active social engineering.\n\nFrom a development point of view, there’s not much we can do. The Android OS provides\nthe functionality that is abused and it’s difficult to take that functionality away again.\nCollecting as much information about the device as possible can help in making correct\nassessments on the risk of certain transactions, but there’s no silver bullet.\n\n\n-----\n\nJeroen Beckers\nJeroen Beckers is a mobile security expert working in the NVISO Software and Security\nassessment team. He is a SANS instructor and SANS lead author of the SEC575 course.\nJeroen is also a co-author of OWASP Mobile Security Testing Guide (MSTG) and the\nOWASP Mobile Application Security Verification Standard (MASVS). He loves to both\nprogram and reverse engineer stuff.\n\n[LinkedIn](https://www.linkedin.com/in/beckersjeroen/)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-05-11 - Android overlay attacks on Belgian financial applications.pdf"
    ],
    "report_names": [
        "2021-05-11 - Android overlay attacks on Belgian financial applications.pdf"
    ],
    "threat_actors": [
        {
            "id": "aa73cd6a-868c-4ae4-a5b2-7cb2c5ad1e9d",
            "created_at": "2022-10-25T16:07:24.139848Z",
            "updated_at": "2025-03-27T02:02:10.120505Z",
            "deleted_at": null,
            "main_name": "Safe",
            "aliases": [],
            "source_name": "ETDA:Safe",
            "tools": [
                "DebugView",
                "LZ77",
                "OpenDoc",
                "SafeDisk",
                "TypeConfig",
                "UPXShell",
                "UsbDoc",
                "UsbExe"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "75108fc1-7f6a-450e-b024-10284f3f62bb",
            "created_at": "2024-11-01T02:00:52.756877Z",
            "updated_at": "2025-03-27T02:00:55.544216Z",
            "deleted_at": null,
            "main_name": "Play",
            "aliases": null,
            "source_name": "MITRE:Play",
            "tools": [
                "Nltest",
                "AdFind",
                "PsExec",
                "Wevtutil",
                "Cobalt Strike",
                "Playcrypt",
                "Mimikatz"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1673536029,
    "ts_updated_at": 1743041786,
    "ts_creation_date": 1653686835,
    "ts_modification_date": 1653686835,
    "files": {
        "pdf": "https://archive.orkl.eu/64786c6fd8087e41b933c2fb1130c1103962f41d.pdf",
        "text": "https://archive.orkl.eu/64786c6fd8087e41b933c2fb1130c1103962f41d.txt",
        "img": "https://archive.orkl.eu/64786c6fd8087e41b933c2fb1130c1103962f41d.jpg"
    }
}