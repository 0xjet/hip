{
    "id": "98f430a9-1846-4d30-9014-ea2c1f6a5a6d",
    "created_at": "2023-01-12T15:02:30.888694Z",
    "updated_at": "2025-03-27T02:16:16.874363Z",
    "deleted_at": null,
    "sha1_hash": "38c4be3e551d4798b0fa22654f959da2f58c9585",
    "title": "2010-05-03 - Heloag has rather no friends, just a master",
    "authors": "",
    "file_creation_date": "2022-05-29T01:29:36Z",
    "file_modification_date": "2022-05-29T01:29:36Z",
    "file_size": 896367,
    "plain_text": "# Heloag has rather no friends, just a master\n\n**[securelist.com/heloag-has-rather-no-friends-just-a-master/29693/](https://securelist.com/heloag-has-rather-no-friends-just-a-master/29693/)**\n\n[Incidents](https://securelist.com/category/incidents/)\n\n[Incidents](https://securelist.com/category/incidents/)\n\n03 May 2010\n\nminute read\n\n\n-----\n\nAuthors\n\n[Georg Wicherski](https://securelist.com/author/georgwicherski/)\n\n[Jose Nazario of Arbor Networks recently posted an analysis of Trojan.Heloag on their blog,](http://asert.arbornetworks.com/2010/04/trojan-heloag-downloader-analysis/)\n[mentioning that some observed behaviour might be related to Peer-to-Peer C&C](http://en.wikipedia.org/wiki/Botnet)\nfunctionality. However, Jose’s analysis was dynamic only and thus he was not certain about\nthis when I contacted him (also thanks to Alex Cox for sharing network traces of his\nhoneypot). Being interested in Peer-to-Peer botnets (e.g. Stormfucker: Owning the Storm\nBotnet [MP4 Video]), I had to take a deeper look.\n\nThe Heloag binaries I’ve looked at (6ede527bb5aa65eae8049ac955b1018d dropped by\n_d9b14a7bc0334458d99e666e553f0ee0) did not contain any Peer-to-Peer C&C_\n**functionality! Instead, the bot rather speaks a very simple protocol over TCP with the**\nfollowing command types supported (encoded as the first byte of the packet):\n\n1. DDoS another host using different techniques:\n\nTCP DDoS, connect(..) based (does not send data)\nUDP DDoS, sendto(..) based (sends some random data)\nHTTP DDoS requesting / with User-Agent “helloAgent”, InternetOpenUrlA based\nHTTP DDoS crawling links from / with User-Agent “Google page”\n2. Download and execute an URL of up to 0xA4 bytes, zero-padded URL\n3. Send the current computer name\n4. Stop with the currently executing DDoS command\n5. Disconnect from current server and connect to new C&C server\n\n\n-----\n\n_Disassembly for function 4_\n\nThis means that even though during dynamic analysis, multiple C&C servers were observed,\nit is just some kind of hand-over to another C&C server which can be used for load-balancing\nor renting out bots. Since there is always only one server, the bot is connected to at a time,\nthis does not add a lot to take-down resilience (phew!).\n\nStill, this is an intersting specimen regarding malware authorship. What strikes immediately\ninto the eye is that while for most of the commands, there is exactly one control byte, DDoS\ncommands are all encoded in the same byte. The additional payload of this commands then\ncontrols what DDoS is carried out to where. Instead of using one type byte like for control\nbytes, this code uses different boolean bytes in the payload for controling DDoS types.\nAdditionally, the DDoS related code makes heavy usage of C++ std::string’s while the rest of\nthe main code uses wsprintf for string handling. It looks like this project was implemented by\ntwo different individuals collaborating or at least one buying some source from the other.\n\nThis malware is pretty certainly from China. First, the usage of wsprintf underlines nonwestern character aware path names, which you rarely see in malware with western origins.\nAdditionally, there is one Chinese IP hardcoded in the binary, which cannot be attacked by\n\n\n-----\n\nDDoS, no matter what command is given to the bot (and this is checked after DNS\nresolution).\n\n[Botnets](https://securelist.com/tag/botnets/)\n[DDoS-attacks](https://securelist.com/tag/dos-attacks/)\n[Malware Creators](https://securelist.com/tag/malware-creators/)\n\nAuthors\n\n[Georg Wicherski](https://securelist.com/author/georgwicherski/)\n\nHeloag has rather no friends, just a master\n\nYour email address will not be published. Required fields are marked *\n\nGReAT webinars\n\n13 May 2021, 1:00pm\n\n## GReAT Ideas. Balalaika Edition\n\n26 Feb 2021, 12:00pm\n17 Jun 2020, 1:00pm\n26 Aug 2020, 2:00pm\n22 Jul 2020, 2:00pm\nFrom the same authors\n\n\n-----\n\n## Live Twitter XSS\n\n Different x86 Bytecode Interpretations\n\n\n-----\n\n## Is there really a Storm out there?\n\n The Dangers of Social Networking\n\n\n-----\n\n## The msvidctl Internet Explorer 0day\n\nSubscribe to our weekly e-mails\n\nThe hottest research right in your inbox\n\n\n-----\n\nReports\n\n## APT trends report Q1 2022\n\nThis is our latest summary of advanced persistent threat (APT) activity, focusing on events\nthat we observed during Q1 2022.\n\n## Lazarus Trojanized DeFi app for delivering malware\n\nWe recently discovered a Trojanized DeFi application that was compiled in November 2021.\nThis application contains a legitimate program called DeFi Wallet that saves and manages a\ncryptocurrency wallet, but also implants a full-featured backdoor.\n\n## MoonBounce: the dark side of UEFI firmware\n\nAt the end of 2021, we inspected UEFI firmware that was tampered with to embed a\nmalicious code we dub MoonBounce. In this report we describe how the MoonBounce\nimplant works and how it is connected to APT41.\n\n## The BlueNoroff cryptocurrency hunt is still on\n\n\n-----\n\nIt appears that BlueNoroff shifted focus from hitting banks and SWIFT-connected servers to\nsolely cryptocurrency businesses as the main source of the group’s illegal income.\n\nSubscribe to our weekly e-mails\n\nThe hottest research right in your inbox\n\n\n-----\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2010/2010-05-03 - Heloag has rather no friends, just a master.pdf"
    ],
    "report_names": [
        "2010-05-03 - Heloag has rather no friends, just a master.pdf"
    ],
    "threat_actors": [
        {
            "id": "1bdb91cf-f1a6-4bed-8cfa-c7ea1b635ebd",
            "created_at": "2022-10-25T16:07:23.766784Z",
            "updated_at": "2025-03-27T02:02:09.971636Z",
            "deleted_at": null,
            "main_name": "Bluenoroff",
            "aliases": [
                "APT 38",
                "ATK 117",
                "Alluring Pisces",
                "Black Alicanto",
                "Bluenoroff",
                "CTG-6459",
                "Copernicium",
                "Nickel Gladstone",
                "Sapphire Sleet",
                "Selective Pisces",
                "Stardust Chollima",
                "T-APT-15",
                "TA444",
                "TAG-71",
                "TEMP.Hermit"
            ],
            "source_name": "ETDA:Bluenoroff",
            "tools": [],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "f426f0a0-faef-4c0e-bcf8-88974116c9d0",
            "created_at": "2022-10-25T15:50:23.240383Z",
            "updated_at": "2025-03-27T02:00:55.404232Z",
            "deleted_at": null,
            "main_name": "APT38",
            "aliases": [
                "APT38",
                "NICKEL GLADSTONE",
                "BeagleBoyz",
                "Bluenoroff",
                "Stardust Chollima",
                "Sapphire Sleet",
                "COPERNICIUM"
            ],
            "source_name": "MITRE:APT38",
            "tools": [
                "ECCENTRICBANDWAGON",
                "HOPLIGHT",
                "Mimikatz",
                "KillDisk",
                "DarkComet"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "8bc1a044-a23b-4904-903c-13f463605cb3",
            "created_at": "2024-05-01T02:03:08.136237Z",
            "updated_at": "2025-03-27T02:05:17.415795Z",
            "deleted_at": null,
            "main_name": "NICKEL GLADSTONE",
            "aliases": [
                "Bluenoroff ",
                "CTG-6459 ",
                "Citrine Sleet ",
                "HIDDEN COBRA ",
                "Lazarus Group",
                "Sapphire Sleet ",
                "Stardust Chollima ",
                "APT38 "
            ],
            "source_name": "Secureworks:NICKEL GLADSTONE",
            "tools": [
                " Bankshot",
                " CATCH22",
                " CCGC_Proxy",
                " Cur1Agent",
                " Ratankba",
                " Server_TrafficForwarder",
                " Wcry",
                "AlphaNC"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "4c68ccd0-caba-4189-9ead-86ac4c2d9b70",
            "created_at": "2024-05-01T02:03:07.930196Z",
            "updated_at": "2025-03-27T02:05:17.251237Z",
            "deleted_at": null,
            "main_name": "BRONZE ATLAS",
            "aliases": [
                "Axiom",
                "BARIUM ",
                "Blackfly ",
                "CTG-2633",
                "GREF",
                "Group 72 ",
                "Red Kelpie ",
                "TG-2633 ",
                "Wicked Panda ",
                "Winnti",
                "APT41 "
            ],
            "source_name": "Secureworks:BRONZE ATLAS",
            "tools": [
                " CCleaner v5.33 backdoor",
                " ChinaChopper",
                " Cobalt Strike",
                " Dicey MSDN",
                " ForkPlayground",
                " HUC Proxy Malware (Htran)",
                " Mimikatz",
                " PipeMon",
                " PlugX",
                " PortReuse",
                " Powershell Empire",
                " RCMD",
                " RbDoor",
                " SPEEDBOAT",
                " ShadowPad",
                " Sidewalk",
                " Speculoos",
                " TeamViewer",
                " Winnkit",
                " Winnti",
                " reg save",
                " vssadmin",
                "Acehash"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "a2b92056-9378-4749-926b-7e10c4500dac",
            "created_at": "2023-01-06T13:46:38.430595Z",
            "updated_at": "2025-03-27T02:00:02.831633Z",
            "deleted_at": null,
            "main_name": "Lazarus Group",
            "aliases": [
                "Operation DarkSeoul",
                "APT38",
                "ATK117",
                "DEV-1222",
                "G0032",
                "APT 38",
                "Stardust Chollima",
                "APT-C-26",
                "ATK3",
                "Diamond Sleet",
                "Hidden Cobra",
                "Unit 121",
                "Subgroup: Bluenoroff",
                "NICKEL GLADSTONE",
                "DEV-0139",
                "Andariel",
                "Operation Troy",
                "COVELLITE",
                "TA404",
                "Lazarus group",
                "Dark Seoul",
                "G0082",
                "NewRomanic Cyber Army Team",
                "Bluenoroff",
                "Appleworm",
                "Nickel Academy",
                "COPERNICIUM",
                "Hastati Group",
                "Bureau 121",
                "Operation AppleJeus",
                "Whois Hacking Team",
                "Citrine Sleet",
                "Sapphire Sleet",
                "Group 77",
                "Labyrinth Chollima",
                "Operation GhostSecret",
                "BeagleBoyz"
            ],
            "source_name": "MISPGALAXY:Lazarus Group",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "4d5f939b-aea9-4a0e-8bff-003079a261ea",
            "created_at": "2023-01-06T13:46:39.04841Z",
            "updated_at": "2025-03-27T02:00:02.985296Z",
            "deleted_at": null,
            "main_name": "APT41",
            "aliases": [
                "G0096",
                "Grayfly",
                "BARIUM",
                "BRONZE ATLAS",
                "BRONZE EXPORT",
                "Red Kelpie",
                "HOODOO",
                "Brass Typhoon",
                "TA415",
                "WICKED SPIDER",
                "WICKED PANDA",
                "G0044",
                "Earth Baku"
            ],
            "source_name": "MISPGALAXY:APT41",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "e698860d-57e8-4780-b7c3-41e5a8314ec0",
            "created_at": "2022-10-25T15:50:23.287929Z",
            "updated_at": "2025-03-27T02:00:55.43005Z",
            "deleted_at": null,
            "main_name": "APT41",
            "aliases": [
                "APT41",
                "Wicked Panda",
                "Brass Typhoon",
                "BARIUM"
            ],
            "source_name": "MITRE:APT41",
            "tools": [
                "ASPXSpy",
                "BITSAdmin",
                "PlugX",
                "Impacket",
                "gh0st RAT",
                "netstat",
                "PowerSploit",
                "ZxShell",
                "KEYPLUG",
                "ipconfig",
                "sqlmap",
                "China Chopper",
                "ShadowPad",
                "MESSAGETAP",
                "Mimikatz",
                "certutil",
                "njRAT",
                "Cobalt Strike",
                "pwdump",
                "BLACKCOFFEE",
                "ROCKBOOT",
                "dsquery",
                "Winnti for Linux",
                "DUSTTRAP",
                "Derusbi",
                "ftp"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1673535750,
    "ts_updated_at": 1743041776,
    "ts_creation_date": 1653787776,
    "ts_modification_date": 1653787776,
    "files": {
        "pdf": "https://archive.orkl.eu/38c4be3e551d4798b0fa22654f959da2f58c9585.pdf",
        "text": "https://archive.orkl.eu/38c4be3e551d4798b0fa22654f959da2f58c9585.txt",
        "img": "https://archive.orkl.eu/38c4be3e551d4798b0fa22654f959da2f58c9585.jpg"
    }
}