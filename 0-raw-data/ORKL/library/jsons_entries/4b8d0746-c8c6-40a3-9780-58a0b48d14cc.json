{
    "id": "4b8d0746-c8c6-40a3-9780-58a0b48d14cc",
    "created_at": "2022-10-25T16:48:22.275043Z",
    "updated_at": "2025-03-27T02:05:31.770686Z",
    "deleted_at": null,
    "sha1_hash": "a850834f5ff8253d70a709a3d18b3cbfc05ce27c",
    "title": "",
    "authors": "",
    "file_creation_date": "0001-01-01T00:00:00Z",
    "file_modification_date": "0001-01-01T00:00:00Z",
    "file_size": 1216420,
    "plain_text": "[in Analysis](http://www.cyintanalysis.com/category/analysis/)\n\n# Threat Analysis: Poison Ivy and Links to an Extended PlugX Campaign\n\n#### Key Points & Assessment:\n\n Japan CERT identified a new Poison Ivy RAT variant (SHA1 44073031790e5ba419374dc55f6ac1cba688b06c) with updated C2 functionality. The malware was created in September 2014 and uploaded to Virus Total in January 2015. It uses the dynamic DNS-provided C2 getstrings[.]jumpingcrab[.]com. This domain has resolved to at least 3 IP addresses: 210.121.164.186, 27.255.71.200, and 27.255.94.224. I identified several decoy documents (see Maltego graph) that deliver the PlugX malware and call-out to one of two IP addresses mentioned above. These documents were reportedly used in a campaign identified by SOPHOS that spanned from September 2014 to February 2015. India was one target of the campaign. Given the infrastructure and timing overlaps, the Poison Ivy sample discussed in this post was likely just one payload involved in a broader campaign targeting India, the Tibetan community, and others, that spanned from approximately September 2014 to February 2015. The Poison Ivy sample in this case thus appears to be tied to\n\n\n-----\n\n#### Chinese interests.\n\n## Poison Ivy: New C2 Proxy Functionality\n\n#### Poison Ivy (PIVY) is a well-known, fully-featured remote access tool (RAT) that has existed since about 2005. It offers a user-friendly GUI, a variety of plugins to enhance functionality, and can be found online by any prospective attacker.\n\n And, although anyone can acquire the tool, PIVY is often associated with actors who have a nexus to China.\n\n\n-----\n\n#### The malware has been extensively documented–including its use in espionage-motivated intrusions–and continues to show signs of active development [1]. A recent blog post from Japan CERT (JPCERT) details new Poison Ivy communications functionality. According to JPCERT, the malware now uses HTTP POST requests (earlier variants use a custom HTTP CONNECT request method) and supports proxy authentication to command-and-control (C2) servers.\n\n Because JPCERT has already tackled this variant’s communications functionality, I will examine other aspects of the malware.\n\n## File & Execution Details\n\n#### Unfortunately, we do not know the delivery vector or target. The intended target may have been one or more Japanese organizations, given that JPCERT was the first to dissect this PIVY sample. Alternatively, it is just as likely that JPCERT simply observed attacks against other victims.\n\n\nFile Name: vscrtapp.exe\n\nFile size 67.0 KB (68608 bytes)\n\nMD5 1 09 5 fb37539 86 86dd3b 72f\n\n\n-----\n\nSHA256 d1aa00b6b11fbefd2dda3b458d9fb5e975865b564bf1c289a6f464b14ad748cc\n\nimphash 6fcb46b0cf3f3baf36d97eba47832406\n\nCompilation timestamp 2014-09-14 01:30:49\n\nFirst submission 2015-01-19 11:03:27 UTC ( 6 months, 1 week ago )\n\n\n#### The sample will write the file vscrta0ps.log to C:\\Documents and Settings\\All Users\\AppData\\. There appear to be no legitimate applications that would write this file to disk.\n\n\nC:\\Documents and Settings\\All Users\\AppData\\vscrta0ps.log\n\n\n#### It will also run the below command:\n\n\nschtasks /create /sc minute /mo 1 /tn Update Assist\" /tr \"\\\"C:\\Do\ncuments and Settings\\All Users\\AppData\\vscrtapp.exe\\\"\" /ru \"system\n\"\"\n\n\n#### This command will create a scheduled task named “Update Assist.” I assume this is a non-English speaker’s attempt to create an “Update Assistant” task name. This task will run the malware every minute on the victim’s machine as vscrtapp.exe in the %AppData% directory. The task therefore serves as a basic method of persistence, ensuring that the malware runs regularly. I found no indications that the malware creates any registry keys; the scheduled task appears to be the malware’s only means of persistence.\n\n It is not clear what, if any, legitimate EXE vscrtapp.exe is attempting to mimic. One possibility may be NetApp’s Virtual Storage Console (VSC) for VMWare (note that the below image is not the query I ran; I simply wanted to show the similarity between the names). Although developers of PIVY could easily change the name, the presence of the vscrtapp.exe filename could serve as a simple host-based method of detection.\n\n\n-----\n\n#### The malware will set a mutex (it imports the function CreateMutexA), although I was unable to determine the value.\n\n## PIVY Infrastructure\n\n#### C2 communications will be made to getstrings[.]jumpingcrab[.]com using HTTP POST requests. It is important to note that the domain jumpingcrab[.]com is a dynamic DNS (DDNS) service. While not inherently malicious, DDNS providers are often abused by threat actors so they do not have to rely on static infrastructure; IP resolution for a host could change at any time.\n\n Analysis of an attacker’s infrastructure is thus made more difficult. The use of DDNS also means that the relevancy and reliability of any infrastructure pivots must be carefully considered.\n\n Taking the use of DDNS into consideration, here are current and historical resolutions for getstrings[.]jumpingcrab[.]com (courtesy of PassiveTotal):\n\n\nResolve Location Network First Last\n27 255 94 224 KR 27 255 94 0/24 2015 07 24 00:00:00 2015 08 02 15:\n\n\n-----\n\n27.255.71.200 KR 27.255.71.0/24 2015-03-31 20:29:15 2015-03-31 20:\n29:15\n210.121.164.186 KR 210.121.128.0/17 2015-01-19 23:16:35 2015-01-20\n04:36:15\n\n\n#### The timing of the earliest known resolution–210.121.164.186– directly correlates with the first submission time of the sample. The Passive Total heat map (shown below) tells us there were almost no active resolutions for this host from February until late July suggesting that the adversary may have observed the submission and deactivated DNS for the host on or around January 19. (Unfortunately, the 12 day gap between January 19 and the beginning of February is an unknown.)\n\n The host briefly resolved to 27.255.71.200 for one day in March and, as of publication, points to 27.255.94.224 where we see eight additional hosts (which also use DDNS domains):\n\n\nwww.yahoo.4pu.com\nwww.google.zzux.com\nwww.winupdate.ddns.ms\nfreemoney.ignorelist.com\nwww.micrsoft.ddns.ms\noffice.onmypc.org\nwww.office.onmypc.org\nabcdollar.mooo.com\n\n\n#### Both winupdate[.]ddns[.]ms and www[.]micrsoft[.]ddns[.]ms are undoubtedly attempting to resemble legitimate Windows and\n\n\n-----\n\n#### getstrings[.]jumpingcrab[.]com.\n\n## Related Threat Activity\n\n#### There are several documents that appear to target victims interested in Chinese affairs, attempt to install the PlugX malware (aka Korplug, SOGU), and communicate to two of the above identified IP addresses (210.121.164.186 or 27.255.71.200). PlugX is another ubiquitous RAT commonly linked to Chinese threat actors.\n\n Below are the documents and their relevant metadata (some details were not available).\n\n\nCHINA NEWS BRIEF 09 of 2015.doc\n\nMD5 9d0388251cbaf3648aba463f66a8fee8\n\nSHA1 a4602a357360b0ed8e9b0814b1322146156fb7f6\n\nSHA256 89ab2d9643bdefd6d46618b2f11fb1357bb555a0e33d5d8fc8bb33eba3fe7cc3\n\nCreate Time/Date: Wed Sep 3 02:25:00 2014\n\nFirst submission 2015-01-30 04:44:34 UTC ( 6 months, 1 week ago )\n\nC2:freemoney.ignorelist.com (210.121.164.186)\n\n################################\n\nDraft contract CMS Trg System.doc\n\nMD5 5bb6be7fcddcd1cc51957ebc17ed872a\n\nSHA1 03b2a660d68004444a5189173e3b8001f4a7cd0b\n\nSHA256 add84116acee953f6606a2240059a05fb4658cfacdee6dd75be752e183c5cab7\n\nCreate Time/Date: Fri Jan 30 02:41:00 2015\n\nFirst submission 2015-02-01 09:49:08 UTC ( 6 months, 1 week ago )\n\nC2:freemoney.ignorelist.com (210.121.164.186)\n\n################################\n\n(Appears to have multiple filenames)\n\nMD5 29a3b53eb1008af2fccbf34df3b68aca\n\nSHA1 c9f72a2d9f97951a1e73f8bb58d9846877757269\n\nC2:dnshost.dns05.com (27.255.71.200)\n\n################################\n\ncontact list.doc\n\nTitle: Suggested Invitees for Ambassador\n\n\n-----\n\nSHA256 58c6e1bbb1c70568476aeec1471ddba74f1fbd31beb1fff471434d3042ee315d\n\nCreate Time/Date: Mon Jul 19 07:59:00 2010\n\nC2:dnshost.dns05.com (27.255.71.200)\n\n\n#### Two of the above RTF files (CHINA NEWS BRIEF 09 of 2015.doc and Draft contract CMS Trg System.doc) exploit CVE-2012-0158 to install PlugX (aka Korplug/SOGU), which then calls to 210.121.164.186, the IP that getstrings[.]jumpingcrab[.]com pointed to in January. The “China News Brief” document is shown below.\n\n I have not yet concluded what the contents of SHA1 c9f72a2d9f97951a1e73f8bb58d9846877757269 are. The document contact list.doc (shown below) also installs PlugX (SHA1 7d71593a7d159c754055e16c26b844112e7b4132, MD5: 5730866b34ef589bd398c9a9b6d7e307). This PlugX sample is identified in a June 2105 Citizen Lab post about attacks on the Tibetan diaspora in Hong Kong. (I hope to explore this connection in greater details in a follow-on post.)\n\n\n-----\n\n#### Interestingly, both CHINA NEWS BRIEF 09 of 2015.doc and Draft contract CMS Trg System.doc are mentioned in a February 2015 SOPHOS report. The report discusses PlugX attacks on a variety of targets including those on India. The attacks reportedly took place between September 2014 and February 2015. Our PIVY sample was compiled on September 14, 2014 and submitted to Virus Total on January 19, 2015.\n\n In addition to the infrastructure overlap, this correlation in timing also suggests that the Poison Ivy sample was just one payload involved in a much broader, 5-6 month campaign targeting India, the Tibetan community, and likely others of interest to China.\n\n According to the SOPHOS report:\n\n Not surprisingly, just like with several other campaigns, in this case it was observed that different malware families were distributed using similar carrier documents; only the encrypted payload was replaced at the end of the file. The shellcode used in the carrier was very convenient for this purpose: the length and location of the final payload was stored at the end of the file. It was possible to swap the payload without needing to modify the exploit condition and the shellcode itself.\n\n\n-----\n\n#### attacks by one or more adversaries acting on behalf of Chinese interests.\n\n [1] For example, by FireEye, Conix Security, and Trend Micro.\n\n###  [Tell me what you think!]\n\n**RELATED CONTENT BY TAG** **[ANALYSIS](http://www.cyintanalysis.com/tag/analysis/)** **[CHINA](http://www.cyintanalysis.com/tag/china/)** **[MALWARE](http://www.cyintanalysis.com/tag/malware/)** **[PLUGX](http://www.cyintanalysis.com/tag/plugx/)** **[POISONIVY](http://www.cyintanalysis.com/tag/poisonivy/)**\n\n[Independent Publisher empowered by WordPress](http://independentpublisher.me/)\n\n\n###  [Tell me what you think!]\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        }
    ],
    "references": [
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2015/2015.08.08.Poison_Ivy_and_Links_to_an_Extended_PlugX_Campaign/Threat%20Analysis_%20Poison%20Ivy%20and%20Links%20to%20an%20Extended%20PlugX%20Campaign%20%E2%80%93%20CYINT%20Analysis.pdf"
    ],
    "report_names": [
        "Threat Analysis_ Poison Ivy and Links to an Extended PlugX Campaign – CYINT Analysis"
    ],
    "threat_actors": [],
    "ts_created_at": 1666716502,
    "ts_updated_at": 1743041131,
    "ts_creation_date": 0,
    "ts_modification_date": 0,
    "files": {
        "pdf": "https://archive.orkl.eu/a850834f5ff8253d70a709a3d18b3cbfc05ce27c.pdf",
        "text": "https://archive.orkl.eu/a850834f5ff8253d70a709a3d18b3cbfc05ce27c.txt",
        "img": "https://archive.orkl.eu/a850834f5ff8253d70a709a3d18b3cbfc05ce27c.jpg"
    }
}