{
    "id": "d3734218-f6cd-4fa8-ae28-e4d4b0d6ce21",
    "created_at": "2022-10-25T16:48:14.313411Z",
    "updated_at": "2025-03-27T02:14:02.705124Z",
    "deleted_at": null,
    "sha1_hash": "ad4f0b93e90f4b08ed4fd3087fcee922b799caf9",
    "title": "",
    "authors": "",
    "file_creation_date": "2019-03-12T03:58:58Z",
    "file_modification_date": "0001-01-01T00:00:00Z",
    "file_size": 682610,
    "plain_text": "|Col1|welivesecurity.com/2019/03/11/gaming-industry-scope-attackers-asia|\n|---|---|\n\n\nMarch 11, 2019\n\nThis is not the first time the gaming industry has been targeted by attackers who compromise game\ndevelopers, insert backdoors into a game’s build environment, and then have their malware\n[distributed as legitimate software. In April 2013, Kaspersky Lab reported that a popular game was](https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2018/03/20134508/winnti-more-than-just-a-game-130410.pdf)\naltered to include a backdoor in 2011. That attack was attributed to perpetrators Kaspersky called\nthe Winnti Group.\n\nYet again, new supply-chain attacks recently caught the attention of ESET Researchers. This time,\ntwo games and one gaming platform application were compromised to include a backdoor. Given\nthat these attacks were mostly targeted against Asia and the gaming industry, it shouldn’t be\nsurprising they are the work of the group described in Kaspersky’s “Winnti – More than just a game”.\n\n# Three Cases, Same Backdoor\n\nAlthough the malware uses different configurations in each case, the three affected software\nproducts included the same backdoor code and were launched using the same mechanism. While\ntwo of the compromised products no longer include the backdoor, one of the affected developers is\nstill distributing the trojanized version: ironically, the game is named Infestation, and is produced by\nThai developer Electronics Extreme. We have tried informing them several times, through various\nchannels, since early February, but without apparent success.\n\nLet’s look at how the malicious payload is embedded and then look into the details of the backdoor\nitself.\n\n# Embedding the payload\n\nThe payload code is started very early during the execution of the backdoored executable file. Right\nafter the PE entry point, the standard call to the C Runtime initialization (__scrt_common_main_seh\nin Figure 1) is hooked to launch the malicious payload before everything else (Figure 2). This may\nsuggest that the malefactor changed a build configuration rather than the source code itself.\n\nFigure 1 Clean executable file entry point\n\n\n-----\n\nnormal execution of the C Runtime initialization code and all the subsequent code of the host\napplication. The embedded payload data has a specific structure, seen in Figure 3, that is parsed by\nthe added unpacking code.\n\nFigure 3 Embedded payload structure\n\nIt includes an RC4 key (which is XORed with 0x37) that is used to decrypt a filename and the\nembedded DLL file.\n\n# The malicious payload\n\nThe actual malicious payload is quite small and only contains about 17 KB of code and data.\n\n# Configuration\n\nIllustrated in Figure 4, the configuration data is simply a whitespace-separated list of strings.\n\nFigure 4 Payload configuration data\n\nThe configuration consists of four fields:\n\n1. C&C server URL.\n2. Variable (t) used to determine the time to sleep in milliseconds before continuing the\n\nexecution. Wait time is chosen randomly in the range 2/3 t to 5/3 t.\n3. A string identifying a campaign.\n4. A semicolon-separated list of executable filenames. If any of them are running, the backdoor\n\nstops its execution.\n\nESET researchers have identified five versions of the payload:\n\n\n**Truncated**\n\n**SHA-1**\n\n\n**PE Compile time**\n\n**(UTC)** **C&C server URL**\n\n\na045939f 2018-07-11\n15:45:57\n\na260dcf1 2018-07-11\n15:45:57\n\ndde82093 2018-07-11\n15:45:57\n\n\nhttps://bugcheck.xigncodeservice[.]com/Common/Lib/Common_bsod.php\n\nhttps://bugcheck.xigncodeservice[.]com/Common/Lib/Common_Include.php\n\nhttps://bugcheck.xigncodeservice[.]com/Common/Lib/common.php\n\n\n-----\n\n**SHA-1** **(UTC)** **C&C server URL**\n\n\n44260a1d 2018-08-15\n10:59:09\n\n8272c1f4 2018-11-01\n13:16:24\n\n\nhttps://dump.gxxservice[.]com/common/up/up_base.php\n\nhttps://nw.infestexe[.]com/version/last.php\n\n\nIn the first three variants, the code was not recompiled, but the configuration data was edited in the\nDLL file itself. The rest of the content is a byte for byte copy.\n\n# C&C infrastructure\n\nDomain names were carefully chosen to look like they are related to the game or application\npublisher. The apex domain was set to redirect to a relevant legitimate site using the Namecheap\nredirection service, while the subdomain points to the malicious C&C server.\n\n**Domain name** **Registration date** **Redirection target**\n\n\nxigncodeservice.com 2018-07-10\n09:18:17\n\ngxxservice.com 2018-08-14\n13:53:41\n\ninfestexe.com 2018-11-07\n08:46:44\n\n\nhttps://namu.wiki/[w]/XIGNCODE\n\nNone or unknown\n\nhttps://www.facebook.com/infest.[in].[th]\n\n\n**Subdomain name** **IP addresses** **Provider**\n\nbugcheck.xigncodeservice.com 167.99.106[.]49, 178.128.180[.]206 DigitalOcean\n\ndump.gxxservice.com 142.93.204[.]230 DigitalOcean\n\nnw.infestexe.com 138.68.14[.]195 DigitalOcean\n\nAt the time of writing, none of the domains resolve and the C&C servers are not responding.\n\n# Reconnaissance report\n\nA bot identifier is generated from the machine’s MAC address. The backdoor reports information\nabout the machine such as the user name, computer name, Windows version and system language\nto the C&C server and awaits commands. The data is XOR encrypted with the key\n“*&b0i0rong2Y7un1” and base64-encoded. The data received from the C&C server is encrypted\nusing the same key.\n\n# Commands\n\nThis simple backdoor has only four commands that can be used by the attacker:\n\nDownUrlFile\nDownRunUrlFile\nRunUrlBinInMem\nUnInstall\n\nThe commands are pretty much self-explanatory. They allow the attacker to run additional\nexecutables from a given URL.\n\n\n-----\n\nsystem. After all, it is embedded inside a legitimate executable that still needs to run. Rather than\nremoving anything, it disables the malicious code by setting the following registry value to 1:\n\nHKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\ImageFlag\n\nWhen the payload is started, the registry value is queried and execution is aborted if set. Perhaps\nthe attackers are trying to reduce the load from their C&C servers by avoiding callbacks from\nuninteresting victims.\n\n# Second stage\n\nBased on ESET telemetry, one of the second stage payload delivered to victims is Win64/Winnti.BN.\nAs far as we can tell, its dropper was downloaded over HTTPS from api.goallbandungtravel[.]com.\nWe have seen it installed as a Windows service and as a DLL in C:\\Windows\\System32 using the\nfollowing file names:\n\ncscsrv.dll\ndwmsvc.dll\niassrv.dll\nmprsvc.dll\nnlasrv.dll\npowfsvc.dll\nracsvc.dll\nslcsvc.dll\nsnmpsvc.dll\nsspisvc.dll\n\nThe samples we have analyzed were actually quite large, each of them about 60 MB. This is,\nhowever, only for appearance because the real size or the PE file is between 63 KB and 72 KB,\ndepending on the version. The malware files simply have lots of clean files appended to them. This is\nprobably done by the component that drops and installs this malicious service.\n\nOnce the service runs, it appends the extension .mui to its DLL path, reads that file and decrypts it\nusing RC5. The decrypted MUI file contains position-independent code at offset 0. The RC5 key is\nderived from the hard drive serial number and the string “f@Ukd!rCto R$.” — we were not able to\nobtain any MUI files nor the code that installs them in the first place. Thus, we do not know the\nexact purpose of this malicious service.\n\nRecent versions of the malware include an “auto-update” mechanism, using C&C server\nhttp://checkin.travelsanignacio[.]com. That C&C server served the latest version of the MUI files\nencrypted with a static RC5 key. The C&C server was not responding during our analysis.\n\n# Targets\n\nLet’s start with who is not targeted. Early in the payload, the malware checks to see if the system\nlanguage is Russian or Chinese (Figure 5). In either case, the malware stops running. There is no way\naround this: the attackers are simply not interested in computers configured with those languages.\n\n\n-----\n\nFigure 5 Language checks before running the payload\n\n# Distribution statistics\n\nESET telemetry shows victims are mostly located in Asia, with Thailand having the largest part of the\npie. Given the popularity of the compromised application that is still being distributed by its\ndeveloper, it wouldn’t be surprising if the number of victims is in the tens or hundreds of thousands.\n\n# Conclusion\n\nSupply-chain attacks are hard to detect from the consumer perspective. It is impossible to start\nanalyzing every piece of software we run, especially with all the regular updates we are encouraged\nor required to install. So, we put our trust in software vendors that the files they distribute don’t\ninclude malware. Perhaps that’s the reason multiple groups target software developers:\ncompromising the vendor results in a botnet as popular as the software that is hacked. However,\nthere is a downside of using such a technique: once the scheme is uncovered, the attacker loses\ncontrol and computers can be cleaned through regular updates.\n\nWe do not know the motives of the attackers at this point. Is it simply financial gain? Are there any\nreasons why the three affected products are from Asian developers and for the Asian market? Do\nthese attackers use a botnet as part of a larger espionage operation?\n\n\n-----\n\npayload as Win32/Winnti.AG, and the second stage as Win64/Winnti.BN.\n\n# Indicators of Compromise (IoCs)\n\n## Compromised file samples (Win32/HackedApp.Winnti.A and B)\n\n**SHA-1** **Compile Time (UTC)** **RC4 key**\n\n\n**Payload SHA-**\n\n**1**\n\n\n7cf41b1acfb05064518a2ad9e4c16fde9185cd4b Tue Nov 13 10:12:58 2018 1729131071 8272c1f4\n\n\n7f73def251fcc34cbd6f5ac61822913479124a2a Wed Nov 14 03:50:18\n2018\n\n\n19317120 44260a1d\n\n\ndac0bd8972f23c9b5f7f8f06c5d629eac7926269 Tue Nov 27 03:05:16 2018 1729131071 8272c1f4\n\nSome hashes were redacted per request from one of the vendor. If for a particular reason you need\nthem, reach out to us at threatintel@eset.com.\n\n## Payload Samples (Win32/Winnti.AG)\n\n**SHA-1** **C&C server URL**\n\na045939f53c5ad2c0f7368b082aa7b0bd7b116da https://bugcheck.xigncodeservice[.]com/Common/Lib/Common_bsod.php\n\na260dcf193e747cee49ae83568eea6c04bf93cb3 https://bugcheck.xigncodeservice[.]com/Common/Lib/Common_Include.php\n\ndde82093decde6371eb852a5e9a1aa4acf3b56ba https://bugcheck.xigncodeservice[.]com/Common/Lib/common.php\n\n8272c1f41f7c223316c0d78bd3bd5744e25c2e9f https://nw.infestexe[.]com/version/last.php\n\n44260a1dfd92922a621124640015160e621f32d5 https://dump.gxxservice[.]com/common/up/up_base.php\n\n## Second stage samples (Win64/Winnti.BN)\n\nDropper delivered by api.goallbandungtravel[.]com.\n\n**Compile Time**\n\n\n**SHA-1**\n\n\n**(UTC)** **C&C server URL prefix**\n\n\n4256fa6f6a39add6a1fa10ef1497a74088f12be0 2018-07-25 10:13:41 None\n\nbb4ab0d8d05a3404f1f53f152ebd79f4ba4d4d81 2018-10-10 09:57:31 http://checkin.travelsanignacio[.]com\n\n## MITRE ATT&CK matrix\n\n**ID** **Description**\n\nT1195 Supply Chain Compromise\n\nT1050 New Service\n\nT1022 Data Encrypted\n\nT1079 Multilayer Encryption\n\nT1032 Standard Cryptographic Protocol (RC4,\nRC5)\n\n\n-----\n\nT1043 Commonly Used Port (80,443)\n\nT1009 Binary Padding\n\n[Marc-Etienne M.Léveillé 11 Mar 2019 - 11:27AM](https://www.welivesecurity.com/author/marc-etienne/)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        }
    ],
    "references": [
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2019/2019.03.11.Gaming-Industry.Asia/Gaming-Industry.Asia.pdf"
    ],
    "report_names": [
        "Gaming-Industry.Asia"
    ],
    "threat_actors": [
        {
            "id": "5bbced13-72f7-40dc-8c41-dcce75bf885e",
            "created_at": "2022-10-25T15:50:23.695735Z",
            "updated_at": "2025-03-27T02:00:55.525839Z",
            "deleted_at": null,
            "main_name": "Winnti Group",
            "aliases": [
                "Winnti Group"
            ],
            "source_name": "MITRE:Winnti Group",
            "tools": [
                "PipeMon",
                "Winnti for Windows",
                "PlugX"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "945a572f-ebe3-4e2f-a288-512fe751cfa8",
            "created_at": "2022-10-25T16:07:24.413971Z",
            "updated_at": "2025-03-27T02:02:10.212853Z",
            "deleted_at": null,
            "main_name": "Winnti Group",
            "aliases": [
                "Wicked Panda",
                "Winnti Group"
            ],
            "source_name": "ETDA:Winnti Group",
            "tools": [
                "Agentemis",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "FunnySwitch",
                "RbDoor",
                "RibDoor",
                "RouterGod",
                "Winnti",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "4c68ccd0-caba-4189-9ead-86ac4c2d9b70",
            "created_at": "2024-05-01T02:03:07.930196Z",
            "updated_at": "2025-03-27T02:05:17.251237Z",
            "deleted_at": null,
            "main_name": "BRONZE ATLAS",
            "aliases": [
                "Axiom",
                "BARIUM ",
                "Blackfly ",
                "CTG-2633",
                "GREF",
                "Group 72 ",
                "Red Kelpie ",
                "TG-2633 ",
                "Wicked Panda ",
                "Winnti",
                "APT41 "
            ],
            "source_name": "Secureworks:BRONZE ATLAS",
            "tools": [
                " CCleaner v5.33 backdoor",
                " ChinaChopper",
                " Cobalt Strike",
                " Dicey MSDN",
                " ForkPlayground",
                " HUC Proxy Malware (Htran)",
                " Mimikatz",
                " PipeMon",
                " PlugX",
                " PortReuse",
                " Powershell Empire",
                " RCMD",
                " RbDoor",
                " SPEEDBOAT",
                " ShadowPad",
                " Sidewalk",
                " Speculoos",
                " TeamViewer",
                " Winnkit",
                " Winnti",
                " reg save",
                " vssadmin",
                "Acehash"
            ],
            "source_id": "Secureworks",
            "reports": null
        }
    ],
    "ts_created_at": 1666716494,
    "ts_updated_at": 1743041642,
    "ts_creation_date": 1552363138,
    "ts_modification_date": 0,
    "files": {
        "pdf": "https://archive.orkl.eu/ad4f0b93e90f4b08ed4fd3087fcee922b799caf9.pdf",
        "text": "https://archive.orkl.eu/ad4f0b93e90f4b08ed4fd3087fcee922b799caf9.txt",
        "img": "https://archive.orkl.eu/ad4f0b93e90f4b08ed4fd3087fcee922b799caf9.jpg"
    }
}