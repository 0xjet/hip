{
    "id": "c06cde83-eb3a-47ed-b4d7-bdf28cc40555",
    "created_at": "2022-10-25T16:48:15.247183Z",
    "updated_at": "2025-03-27T02:10:17.891007Z",
    "deleted_at": null,
    "sha1_hash": "d5cf4e80ac62b5e17eaf837484b6e99c5a7e1c34",
    "title": "",
    "authors": "",
    "file_creation_date": "2021-01-12T09:37:37Z",
    "file_modification_date": "2021-01-12T09:37:37Z",
    "file_size": 525441,
    "plain_text": "# Abusing cloud services to fly under the radar\n\n**[research.nccgroup.com/2021/01/12/abusing-cloud-services-to-fly-under-the-radar](https://research.nccgroup.com/2021/01/12/abusing-cloud-services-to-fly-under-the-radar/)**\n\n## tl;dr\n\n\nJanuary 12, 2021\n\n\nNCC Group and Fox-IT have been tracking a threat group with a wide set of interests, from\nintellectual property (IP) from victims in the semiconductors industry through to passenger data from\nthe airline industry.\n\nIn their intrusions they regularly abuse cloud services from Google and Microsoft to achieve their\ngoals. NCC Group and Fox-IT observed this threat actor during various incident response\nengagements performed between October 2019 until April 2020. Our threat intelligence analysts\nnoticed clear overlap between the various cases in infrastructure and capabilities, and as a result we\nassess with moderate confidence that one group was carrying out the intrusions across multiple\nvictims operating in Chinese interests.\n\nIn open source this actor is referred to as Chimera by CyCraft.\n\nNCC Group and Fox-IT have seen this actor remain undetected, their dwell time, for up to three years.\nAs such, if you were a victim, they might still be active in your network looking for your most recent\ncrown jewels.\n\nWe contained and eradicated the threat from our client’s networks during incident response whilst\nour Managed Detection and Response (MDR) clients automatically received detection logic.\n\nWith this publication, NCC Group and Fox-IT aim to provide the wider community with information\nand intelligence that can be used to hunt for this threat in historic data and improve detections for\nintrusions by this intrusion set.\n\nThroughout we use terminology to describe the various phases, tactics, and techniques of the\nintrusions standardized by MITRE with their ATT&CK framework . Near the end of this article all the\ntactics and techniques used by the adversary are listed with links to the MITRE website with more\ninformation.\n\n## From initial access to defense evasion: how it is done\n\nIn all the intrusions we have observed they are performed in similar ways by the adversary: from\ninitial access all the way to actions on objectives. The objective in these cases appear to be stealing\nsensitive data from the victim’s networks.\n\n## Credential theft and password spraying to Cobalt Strike\n\nThis adversary starts with obtaining usernames and passwords of their victim from previous breaches.\nThese credentials are used in a credential stuffing or password spraying attack against the victim’s\nremote services, such as webmail or other internet reachable mail services. After obtaining a valid\naccount, they use this account to access the victim’s VPN, Citrix or another remote service that allows\naccess to the network of the victim. Information regarding these remotes services is taken from the\nmailbox, cloud drive, or other cloud resources accessible by the compromised account. As soon as they\nhave a foothold on a system (also known as patient zero or index case), they check the permissions of\nthe account on that system, and attempt to obtain a list of accounts with administrator privileges.\nWith this list of administrator-accounts, the adversary performs another password spraying attack\n\n\n-----\n\nuntil a valid admin account is compromised. With this valid admin account, a Cobalt Strike beacon is\nloaded into memory of patient zero. From here on the adversary stops using the victim’s remote\nservice to access the victim’s network, and starts using the Cobalt Strike beacon for remote access and\ncommand and control.\n\n## Network discovery and lateral movement\n\nThe adversary continues their discovery of the victim’s network from patient zero. Various scans and\nqueries are used to find proxy settings, domain controllers, remote desktop services, Citrix services,\nand network shares. If the obtained valid account is already member of the domain admins group, the\nfirst lateral move in the network is usually to a domain controller where the adversary also deploys a\nCobalt Strike beacon. Otherwise, a jump host or other system likely used by domain admins is found\nand equipped with a Cobalt Strike beacon. After this the adversary dumps the domain admin\ncredentials from the memory of this machine, continues lateral moving through the network, and\nplaces Cobalt Strike beacons on servers for increased persistent access into the victim’s network. If the\nvictim’s network contains other Windows domains or different network security zones, the adversary\nscans and finds the trust relationships and jump hosts, attempting to move into the other domains\nand security zones. The adversary is typically able to perform all the steps described above within one\nday.\n\nDuring this process, the adversary identifies data of interest from the network of the victim. This can\nbe anything from file and directory-listings, configuration files, manuals, email stores in the guise of\nOST- and PST-files, file shares with intellectual property (IP), and personally identifiable information\n(PII) scraped from memory. If the data is small enough, it is exfiltrated through the command and\ncontrol channel of the Cobalt Strike beacons. However, usually the data is compressed with WinRAR,\nstaged on another system of the victim, and from there copied to a OneDrive-account controlled by\nthe adversary.\n\nAfter the adversary completes their initial exfiltration, they return every few weeks to check for new\ndata of interest and user accounts. At times they have been observed attempting to perform a degree\nof anti-forensic activities including clearing event logs, time stomping files, and removing scheduled\ntasks created for some objectives. But this isn’t done consistently across their engagements.\n\n## Framing the adversary’s work in the MITRE ATT&CK framework\n\n Credential access (TA0006)\n\nThe earliest and longest lasting intrusion by this threat we observed, was at a company in the\nsemiconductors industry in Europe and started early Q4 2017. The more recent intrusions took place\nin 2019 at companies in the aviation industry. The techniques used to achieve access at the companies\nin the aviation industry closely resembles techniques used at victims in the semiconductors industry.\n\nThe threat used valid accounts against remote services: Cloud-based applications utilizing federated\nauthentication protocols. Our incident responders analysed the credentials used by the adversary and\nthe traces of the intrusion in log files. They uncovered an obvious overlap in the credentials used by\nthis threat and the presence of those same accounts in previously breached databases. Besides that,\nthe traces in log files showed more than usual login attempts with a username formatted as email\naddress, e.g.<username>@<email domain>. While usernames for legitimate logins at the victim’s\nnetwork were generally formatted like <domain>\\<username>. And attempted logins came from a\nrelative small set of IP-addresses.\n\n\n-----\n\nFor the investigators at NCC Group and Fox-IT these pieces of evidence supported the hypothesis of\nthe adversary achieving credentials access by brute force, and more specifically by credential stuffing\nor password spraying.\n\n## Initial access (TA0001)\n\nIn some of the intrusions the adversary used the valid account to directly login to a Citrix environment\nand continued their work from there.\n\nIn one specific case, the adversary now armed with the valid account, was able to access a document\nstored in SharePoint Online, part of Microsoft Office 365. This specific document described how to\naccess the internet facing company portal and the web-based VPN client into the company network.\nWithin an hour after grabbing this document, the adversary accessed the company portal with the\nvalid account.\n\nFrom this portal it was possible to launch the web-based VPN. The VPN was protected by two-factor\nauthentication (2FA) by sending an SMS with a one-time password (OTP) to the user account’s\nprimary or alternate phone number. It was possible to configure an alternate phone number for the\nlogged in user account at the company portal. The adversary used this opportunity to configure an\nalternate phone number controlled by the adversary.\n\nBy performing two-factor authentication interception by receiving the OTP on their own telephone\nnumber, they gained access to the company network via the VPN. However, they also made a mistake\nduring this process within one incident. Our hypothesis is that they tested the 2FA-system first or\nselected the primary phone number to send a SMS to. However the European owner of the account\nreceived a text message with Simplified Chinese characters on the primary phone number in the\nmiddle of the night Eastern European Time (EET). NCC Group and Fox-IT identified that the\nlanguage in the text-message for 2FA is based on the web browser’s language settings used during the\nauthentication flow. Thus the 2FA code was sent with supporting Chinese text.\n\n## Account discovery (T1087)\n\nWith access into the network of the victim, the adversary finds a way to install a Cobalt Strike beacon\non a system of the victim (see Execution). But before doing so, we observed the adversary checking the\ncurrent permissions of the obtained user account with the following commands:\n```\nnet user\nnet user Administrator\nnet user <username> /domain\nnet localgroup administrators\n\n```\nIf the user account doesn’t have local administrative or domain administrative permissions, the\nadversary attempts to discover which local or domain admin accounts exist, and exfiltrates the\nadmin’s usernames. To identify if privileged users are active on remote servers, the adversary makes\nuse of PsLogList from Microsoft Sysinternals to retrieve the Security event logs. The built-in Windows\nquser-command to show logged on users is also heavily used by them. If such a privileged user was\nrecently active on a server the adversary executes Cobalt Strike’s built-in Mimikatz to dump its\npassword hashes.\n\n## Privilege escalation (TA0004)\n\nThe adversary started a password spraying attack against those domain admin accounts, and\nsuccessfully got a valid domain admin account this way. In other cases, the adversary moved laterally\nto another system with a domain admin logged in. We observed the use of Mimikatz on this system\n\n\n-----\n\nand saw the hashes of the logged in domain admin account going through the command and control\nchannel of the adversary. The adversary used a tool called NtdsAudit to dump the password hashes of\ndomain users as well as we observed the following command:\n```\nmsadcs.exe \"NTDS.dit\" -s \"SYSTEM\" -p RecordedTV_pdmp.txt --users-csv RecordedTV_users.csv\n\n```\nNote: the adversary renamed ntdsaudit.exe to msadcs.exe.\n\nBut we also observed the adversary using the tool ntdsutil to create a copy of the Active Directory\ndatabase NTDS.dit followed by a repair action with esentutl to fix a possible corrupt NTDS.dit:\n```\nntdsutil \"ac i ntds\" \"ifm\" \"create full C:\\Windows\\Temp\\tmp\" q q\nesentutl /p /o ntds.dit\n\n```\nBoth ntdsutil and esentutl are by default installed on a domain controller.\n\nA tool used by the adversary which wasn’t installed on the servers by default, was DSInternals.\nDSInternals is a PowerShell module that makes use of internal Active Directory features. The files and\ndirectories found on various systems of a victim match with DSInternals version 2.16.1. We have\nfound traces that indicate DSInternals was executed and at which time, which match with the rest of\nthe traces of the intrusion. We haven’t recovered traces of how the adversary used DSInternals, but\nconsidering the phase of the intrusion the adversary used the tool, it is likely they used it for either\naccount discovery or privilege escalation, or both.\n\n## Execution (TA0002)\n\nThe adversary installs a hackers best friend during the intrusion: Cobalt Strike. Cobalt Strike is a\nframework designed for adversary simulation intended for penetration testers and red teams. It has\nbeen widely adopted by malicious threats as well.\n\nThe Cobalt Strike beacon is installed in memory by using a PowerShell one-liner. At least the following\nthree versions of Cobalt Strike have been in use by the adversary:\n\nCobalt Strike v3.8, observed Q2 2017\nCobalt Strike v3.12, observed Q3 2018\nCobalt Strike v3.14, observed Q2 2019\n\nFox-IT has been collecting information about Cobalt Strike team servers since January 2015. This\nresearch project covers the fingerprinting of Cobalt Strike servers and is described in Fox-IT blog\n[“Identifying Cobalt Strike team servers in the wild”. The collected information allows Fox-IT to](https://blog.fox-it.com/2019/02/26/identifying-cobalt-strike-team-servers-in-the-wild/)\ncorrelate Cobalt Strike team servers, based on various configuration settings. Because of this, historic\ninformation was available during this investigation. Whenever a Cobalt Strike C2 channel was\nidentified, Fox-IT performed lookups into the collection database. If a match was found, the\nconfiguration of the Cobalt Strike team server was analysed. This configuration was then compared\nagainst the other Cobalt Strike team servers to check for similarities in for example domain names,\nversion number, URL, and various other settings.\n\nThe adversary heavily relies on scheduled tasks for executing a batch-file (.bat) to perform their tasks.\nAn example of the creation of such a scheduled task by the adversary:\n```\nschtasks /create /ru \"SYSTEM\" /tn \"update\" /tr \"cmd /c c:\\windows\\temp\\update.bat\" /sc once\n/f /st 06:59:00\n\n```\nThe batch-files appear to be used to load the Cobalt Strike beacon, but also to perform discovery\ncommands on the compromised system.\n\n\n-----\n\n## Persistence (TA0003)\n\nThe adversary loads the Cobalt Strike beacon in memory, without any persistence mechanisms on the\ncompromised system. Once the system is rebooted, the beacon is gone. The adversary is still able to\nhave persistent access by installing the beacon on systems with high uptimes, such as server. Besides\nusing the Cobalt Strike beacon, the adversary also searches for VPN and firewall configs, possibly to\nfunction as a backup access into the network. We haven’t seen the adversary use those access methods\nafter the first Cobalt Strike beacons were installed. Maybe because it was never necessary.\n\nAfter the first bulk of data is exfiltrated, the persistent access into the victim’s network is periodically\nused by the adversary to check if new data of interest is available. They also create a copy of the\nNTDS.dit and SYSTEM-registry hive file for new credentials to crack.\n\n## Discovery (TA0007)\n\nThe adversary applied a wide range of discovery tactics. In the list below we have highlighted a few\nspecific tools the adversary used for discovery purposes. You can find a summary of most of the\ncommands used by the adversary to perform discovery at the end of this article.\n\n**Account discovery tool: PsLogList**\n\nCommand used:\n```\npsloglist.exe -accepteula -x security -s -a <date>\n\n```\nThis command exports a text file with comma separated fields. The text files contain the contents of\nthe Security Event log after the specified date.\n\nPsloglist is part of the Sysinternals toolkit from Mark Russinovich (Microsoft). The tool was used by\nthe adversary on various systems to write events from the Windows Security Event Log to a text file. A\npossible intent of the adversary could be to identify if privileged users are active on the systems. If\nsuch a privileged user was recently active on a server the actor executes Cobalt Strike’s built-in\nMimikatz to dump its credentials or password hash.\n\n**Account discovery tool: NtdsAudit**\n\nCommand used:\n```\nmsadcs.exe \"NTDS.dit\" -s \"SYSTEM\" -p RecordedTV_pdmp.txt --users-csv RecordedTV_users.csv\n\n```\nIt imports the specified Active Directory database NTDS.dit and registry file SYSTEM and exports the\nfound password hashes into RecordedTV_pdump.txt and user details in RecordedTV_users.csv.\n\nThe NtdsAudit utility is an auditing tool for Active Directory databases. It allows the user to collect\nuseful statistics related to accounts and passwords. The utility was found on various systems of a\nvictim and matches the NtdsAudit.exe program file version v2.0.5 published on the GitHub project\npage.\n\n**Network service scanning**\n\nCommand used:\n```\nget -b <start ip> -e <end ip> -p\nget -b <start ip> -e <end ip>\n\n```\nGet.exe appears to be a custom tool used to scan IP-ranges for HTTP service information. NCC Group\nand Fox-IT decompiled the tool for analysis. This showed the tool was written in the Python scripting\nlanguage and packed into a Windows executable file. Though Fox-IT didn’t find any direct\noccurrences of the tool on the internet, the decompiled code showed strong similarities with the\n\n\n-----\n\nsource code of a tool named GetHttpsInfo. GetHttpsInfo scans the internal network for HTTP &\nHTTPS services. The reconnaissance tool getHttpsInfo is able to discover HTTP servers within the\nrange of a network.\n\nThe tool was shared on a Chinese forum around 2016.\n\nFigure 1: Example of a download location for GetHttpsInfo.exe\n\n## Lateral movement (TA0008)\n\nThe adversary used the built-in lateral movement possibilities in Cobalt Strike. Cobalt Strike has\nvarious methods for deploying its beacons at newly compromised systems. We have seen the\nadversary using SMB, named pipes, PsExec, and WinRM. The adversary attempts to move to a\ndomain controller as soon as possible after getting foothold into the victim’s network. They continue\nlateral movement and discovery in an attempt to identify the data of interest. This could be a\nwebserver to carve PII from memory, or a fileserver to copy IP, as we have both observed.\n\nAt one customer, the data of interest was stored in a separate security zone. The adversary was able to\nfind a dual homed system and compromise it. From there on they used it as a jump host into the\nhigher security zone and started collecting the intellectual property stored on a file server in that zone.\n\nIn one event we saw the adversary compromise a Linux-system through SSH. The user account was\npossibly compromised on the Linux server by using credential stuffing or password spraying: Logfiles\non the Linux-system show traces which can be attributed to a credential stuffing or password spraying\nattack.\n\n## Lateral tool transfer (T1570)\n\nThe adversary is applying living off the land techniques very well by incorporating default Windows\ntools in its arsenal. But not all tools used by the adversary are so called lolbins: As said before, they\nuse Cobalt Strike. But they also rely on a custom tool for network scanning (get.exe), carving data\nfrom memory, compression of data, and exfiltrating data.\n\nBut first: How did they get the tools on the victim’s systems? The adversary copied those tools over\nSMB from compromised system to compromised system wherever they needed these tools. A few\nexamples of commands we observed:\n\n\n-----\n\n```\ncopy get e e \\\\ p \\c$\\ do s\\te p\\\ncopy msadc* \\\\<hostname>\\c$\\Progra~1\\Common~1\\System\\msadc\\\ncopy update.exe \\\\<ip>\\c$\\windows\\temp\\\nmove ak002.bat \\\\<ip>\\c$\\windows\\temp\\update.bat\n\n## Collection (TA0009)\n\n```\nIn preparation of exfiltration of the data needed for their objective, the adversary collected the data\nfrom various sources within the victim’s network. As described before, the adversary collected data\nfrom an information repository, Microsoft SharePoint Online in this case. This document was\nexfiltrated and used to continue the intrusion via a company portal and VPN.\n\nIn all cases we’ve seen the adversary copying results of the discovery phase, like file- and directory\nlists from local systems, network shared drives, and file shares on remote systems. But email\ncollection is also important for this adversary: with every intrusion we saw the mailbox of some users\nbeing copied, from both local and remote systems:\n```\nwmic /node:<ip> process call create \"cmd /c copy c:\\Users\\<username>\\<path>\\backup.pst\nc:\\windows\\temp\\backup.pst\"\ncopy \"i:\\<path>\\<username>\\My Documents\\<filename>.pst\"\ncopy \\\\<hostname>\\c$\\Users\\<username>\\AppData\\Local\\Microsoft\\Outlook*.ost\n\n```\nFiles and folders of interest are collected as well and staged for exfiltration.\n\nThe goal of targeting some victims appears to be to obtain Passenger Name Records (PNR). How this\nPNR data is obtained likely differs per victim, but we observed the usage of several custom DLL files\nused to continuously retrieve PNR data from memory of systems where such data is typically\nprocessed, such as flight booking servers.\n\nThe DLL’s used were side-loaded in memory on compromised systems. After placing the DLL in the\nappropriate directory, the actor would change the date and time stamps on the DLL files to blend in\nwith the other legitimate files in the directory.\n\nAdversaries aiming to exfiltrate large amounts of data will often use one or more systems or storage\nlocations for intermittent storage of the collected data. This process is called staging and is one of the\nof the activities that NCC Group and Fox-IT has observed in the analysed C2 traffic.\n\nWe’ve seen the adversary staging data on a remote system or on the local system. Most of the times\nthe data is compressed and copied at the same time. Only a handful of times the adversary copies the\ndata first before compressing (archive collected data) and exfiltrating it. The adversary compresses\nand encrypts the data by using WinRAR from the command-line. The filename of the command-line\nexecutable for WinRAR is RAR.exe by default.\n\nThis activity group always uses a renamed version of rar.exe. We have observed the following\nfilenames overlapping all intrusions:\n\njucheck.exe\nRecordedTV.ms\nteredo.tmp\nupdate.exe\nmsadcs1.exe\n\nThe adversary typically places the executables in the following folders:\n\nC:\\Users\\Public\\Libraries\\\nC:\\Users\\Public\\Videos\\\n\n\n-----\n\nC:\\Windows\\Temp\\\n\nThe following four different variants of the use of rar.exe as update.exe we have observed:\n```\nupdate a -m5 -hp<password> <target_filename> <source>\nupdate a -m5 -r -hp<password> <target_filename> <source>\nupdate a -m5 -inul -hp<password> <target_filename> <source>\nupdate a -m5 -r -inul -hp<password> <target_filename> <source>\n\n```\nThe command lines parameters have the following effect:\n\na = add to archive.\nm5 = use compression level 5.\nr = recurse subfolders.\ninul = suppress error messages.\nhp<password> = encrypt both file data and headers with password.\n\nThe used password, file extensions for the staged data differ per intrusion. We’ve seen the use of .css,\n.rar, .log.txt, and no extension for staged pieces of data.\n\nAfter compromising a host with a Linux operating systems, data is also compressed. This time the\nadversary compresses the data as a gzipped tar-file: tar.gz. Sometimes no file extension is used, or the\nfile extension is .il. Most of the times the files names are prepended with adsDL_ or contain the word\n“list”. The files are staged in the home folder of the compromised user account: /home/<username>/\n\n## Command and control (TA0011)\n\nThe adversary uses Cobalt Strike as framework to manage their compromised systems. We observed\nthe use of Cobalt Strike’s C2 protocol encapsulated in DNS by the adversary in 2017 and 2018. They\nswitched to C2 encapsulated in HTTPS in Q3 2019. An interesting observation is they made use of a\ncracked/patched trial version of Cobalt Strike. This is important to note because the functionalities of\nCobalt Strike’s trial version are limited. More importantly: the trial version doesn’t support encryption\nof command and control traffic in cases where the protocol itself isn’t encrypted, such as DNS. In one\nintrusion we investigated, the victim had years of logging available of outgoing DNS-requests. The\nDNS-responses weren’t logged. This means that only the DNS C2 leaving the victim’s network was\nlogged. We developed a Python script that decoded and combined most of the logged C2\ncommunication into a human readable format. As the adversary used Cobalt Strike with DNS as\ncommand & control protocol, we were able to reconstruct more than two years of adversary activity.\nWith all this activity data, it was possible for us to create some insight into the ‘office’-hours of this\nadversary. The activity took place six days a week, rarely on Sundays. The activity started on average\nat 02:36 UTC and ended rarely after 13:00 UTC. We observed some periods where we expected\nactivity of the adversary, but almost none was observed. These periods match with the Chinese Golden\nWeek holiday.\n\n\n-----\n\nFigure 2: Heatmap of activity. Times on the X-axis are in UTC.\n\nThe adversary also changed their domains for command & control around the same time they\nswitched C2 protocols. They used a subdomain under a regular parent domain with a .com TLD in\n2017 and 2018, but they started using sub-domains under the parent domain appspot.com and\nazureedge.net in 2019. The parent domain appspot.com is a domain owned by Google, and part of\nGoogle’s App Engine platform as a service. Azureedge.net is a parent domain owned by Microsoft, and\npart of Microsoft’s Azure content delivery network.\n\n## Exfiltration (TA0010)\n\nThe adversary uses the command and control channel to exfiltrate small amounts of data. This is\nusually information containing account details. For large amounts of data, such as the mailboxes and\nnetwork shares with intellectual property, they use something else.\n\nOnce the larger chunks of data are compressed, encrypted, and staged, the data is exfiltrated using a\ncustom built tool. This tool exfiltrates specified files to cloud storage web services. The following cloud\nstorage web services are supported by the malware:\n\nDropbox\nGoogle Drive\nOneDrive\n\nThe actor specifies the following arguments when running the exfiltration tool:\n\nName of the web service to be used\nParameters used for the web service, such as a client ID and/or API key\nPath of the file to read and exfiltrate to the web service\n\nWe have observed the exfiltration tool in the following locations:\n\nC:\\Windows\\Temp\\msadcs.exe\nC:\\Windows\\Temp\\OneDrive.exe\n\nHashes of these files are listed at the end of this article.\n\n## Defense evasion (TA0005)\n\nThe adversary attempts to clean-up some of the traces from their intrusions. While we don’t know\nwhat was deleted and we were unable to recover, we did see some of their anti-forensics activity:\n\nWindows event logs clearing,\nFile deletion,\n\n\n-----\n\nTimestomping\n\nAn overview of the observed commands can be found in the appendix.\n\nFor indicator removal on host: Timestomp the adversary uses a Windows version of the Linux touch\n[command. This tool is included in the UnxUtils repository. This makes sure the used tools by the](https://sourceforge.net/projects/unxutils/)\nadversary blend in with the other files in the directory when shown in a timeline. Creating a timeline\nis a common thing to do for forensic analysts to get a chronological view of events on a system.\n\n## The same activity group?\n\nA number of our intrusions involved tips from an industry partner who was able to correlate some of\ntheir upstream activity.\n\nOur threat intelligence analysts observed clear overlap between the various cases that NCC Group and\nFox-IT worked in the threat’s infrastructure and capabilities, and as a result we assess with moderate\nconfidence one activity group was carrying out the intrusions across the different type of victims.\n\nSome overlap is very generic for a lot for a lot of groups, like the use of Cobalt Strike, or exfiltration to\nOneDrive. But the tool used for exfiltration to OneDrive is very specific for this adversary. The use of\nappspot and azureedge domains as well. The naming convention for their subdomains, tools and\nscripts overlap too. In summary:\n\nThe adversary: Working hours match with GMT+8.\n\nInfrastructure: appspot.com and azureedge.net for C2 with a strong overlap in naming convention for\nsubdomains and actual overlap in some subdomains between intrusions.\n\nCapability: Password spraying/credential stuffing. Cobalt Strike. Copy NTDS.dit. Use scheduled tasks\nand batch files for automation. The use of LOLBins. WinRAR. Cloud exfil tool and exfil to OneDrive.\nErasing Windows Event Logs, files and tasks. Overlap in filenames for tools, staged data, and folders.\n\nVictim: Semiconductors and aviation industry.\n\nWe considered labelling them as two activity groups, as of the difference in victims between various\nintrusions. But all the other overlap is strong enough for us to consider it as one group right now. This\ngroup might have gotten a new customer interested in different data which changed the intent and\nvictims of the adversary.\n\n[But most importantly: The largest overlap is in the top half of the pyramid of pain: domain names,](https://detect-respond.blogspot.com/2013/03/the-pyramid-of-pain.html)\nhost artifacts, tools, and TTPs. And these are the hardest for the adversary to change, and most\neffective for long-lasting detection!\n\n\n-----\n\nFigure 3: Pyramid of pain by David J Bianco\n\nFox-IT and NCC Group found some very strong overlap between what we’ve seen in our intrusion, and\n[what Cycraft describes in their APT Group Chimera report and Blackhat](https://www.cycraft.com/en-us/press/2020-04-15/apt-group-chimera-apt-operation-skeleton-key-targets-taiwan-semiconductor-vendors/) [presentation. The bulk of the](https://i.blackhat.com/USA-20/Thursday/us-20-Chen-Operation-Chimera-APT-Operation-Targets-Semiconductor-Vendors.pdf)\nvictims they describe are in different regions than we observed which is likely caused by field of view\n[bias. SentinelOne also describes an attack and shares IOC’s that show strong overlap with the](https://labs.sentinelone.com/the-anatomy-of-an-apt-attack-and-cobaltstrike-beacons-encoded-configuration/)\nintrusions we investigated.\n\n## Conclusion\n\nAt this moment we believe based on the evidence observed that the various intrusions were performed\nby the same group. We can only report what we observed: first they stole intellectual property in the\nhigh tech sector, later they stole passenger name records (PNR) from airlines, both across\ngeographical locations. Both types of stolen data are very useful for nation states.\n\nAnswering if this group has an advanced persistent threat (APT) technique, has some sort of state\naffiliation, or where they come from goes beyond the scope of this write-up. The threat intelligence\nand IOC’s we are sharing are intended to help discover and present intrusions by this and adversaries.\n\nA word of thanks goes out to all the forensic experts, incident responders, and threat intelligence\nanalysts who helped victims identifying and eradicating the adversary. And everybody from NCC\nGroup and Fox-IT (part of NCC Group) for all the contributions to this article.\n\n## IOC\n\n\n-----\n\nType Data Observed Note\n\n\nBinary\nMD5\n\nBinary\nMD5\n\nBinary\nMD5\n\nBinary\nMD5\n\nBinary\nMD5\n\nBinary\nMD5\n\nBinary\nMD5\n\nC2\ndomain\n\nC2\ndomain\n\nC2\ndomain\n\nC2\ndomain\n\nC2\ndomain\n\nC2\ndomain\n\nC2\ndomain\n\nC2\ndomain\n\nC2\ndomain\n\nC2\ndomain\n\n\n133a159e86ff48c59e79e67a3b740c1e – get.exe\n(GetHttpsInfo)\n\n328ba584bd06c3083e3a66cb47779eac – psloglist.exe\n\n65cf35ddcb42c6ff5dc56d6259cc05f3 – update.exe\n(WinRAR)\n\n4d5440282b69453f4eb6232a1689dd4a – msadcs.exe\n(Cloud exfil\ntool)\n\n90508ff4d2fc7bc968636c716d84e6b4 – msadcs.exe\n(Cloud exfil\ntool)\n\nc9b8cab697f23e6ee9b1096e312e8573 – jucheck.exe\n(WinRAR)\n\ndd138a8bc1d4254fed9638989da38ab1 – msadcs.exe\n(NTDSAudit)\n\n\nEuDbSyncUp[.]com Q4 2017\n– Q4\n0218\n\nUsMobileSos[.]com Q4 2017\n– Q4\n2018\n\nofficeeuupdate.appspot[.]com Q4 2017\n– Q4\n2018\n\nMsCupDb[.]com Q4 2017\n– Q4\n2018\n\nofficeeuropupd.appspot[.]com Q3 2019\n– Q1\n2020\n\nplatform-appses.appspot[.]com Q4 2019\n– Q1\n2020\n\nwatson-telemetry.azureedge[.]net Q4 2019\n– Q1\n2020\n\n\n–\n\n–\n\n–\n\n–\n\n–\n\n–\n\n–\n\n\neurope-s03213.appspot[.]com 2019 –\n\neustylejssync.appspot[.]com 2019 –\n\nfsdafdsfdsaflkjkxvzcuifsad.azureedge[.]net 2019 –\n\n\n-----\n\nC2\ndomain\n\nC2\ndomain\n\n\nictsyncserver.appspot[.]com 2019 –\n\nsowfksiw38f2aflwfif.azureedge[.]net 2019 –\n\n\nFilename fs_action*.bat – Task\nautomation\n\nFilename fs_action*.ps1 – Task\nautomation\n\nFilename update.bat – Task\nautomation\n\nFilename update*.bat – Task\nautomation\n\nFilename *dsinternals*.dll – Dsinternals lib\nfiles\n\nFilename get.exe – GetHttpsInfo\n\nFilename adsDL_<dir>.log – Staging data\n\nFilename group_membership.csv – SharpHound\noutput\n\nFilename local_admins.csv – SharpHound\noutput\n\nFilename msadcs.exe – Various tools\n\nFilename msadcs1.exe – WinRAR\n\nFilename OneDrive.exe – Cloud data\nexfil\n\nFilename sessions.csv – SharpHound\noutput\n\nFilename RecordedTV.ms – WinRAR\n\nFilename RecordedTV_*.csv – Staging data\n\nFilename RecordedTV_*.ms – Staging data\n\nFilename RecordedTV_*.rar – Staging data\n\nFilename RecordedTV_*.txt – Staging data\n\nFilename teredo.tmp – WinRAR\n\nFilename update.exe – WinRAR\n\nFilename hsperfdata.sqm – Archive with\ntools\n\nFilename update*.log – Staging data\n\nHostname DESKTOP-0FVJ37C – Origin of login\nto Exchange\n\n\n-----\n\nIPv4\naddress\n\nIPv4\naddress\n\nIPv4\naddress\n\nIPv4\naddress\n\nIPv4\naddress\n\nIPv4\naddress\n\nIPv4\naddress\n\nIPv4\naddress\n\nIPv4\naddress\n\nIPv4\naddress\n\nIPv4\naddress\n\nIPv4\naddress\n\nIPv4\naddress\n\nIPv4\naddress\n\nIPv4\naddress\n\nIPv4\naddress\n\nIPv4\naddress\n\nIPv4\naddress\n\nIPv4\naddress\n\nIPv4\naddress\n\nIPv4\naddress\n\n\n47.75.0[.]147 Q2 2019 Password\nspray\n\n59.47.4[.]27 Q2 2019 ADFS login\n\n45.9.248[.]74 Q2 2019 Citrix login\n\n172.111.210[.]53 Q2 2019 Citrix login\n\n103.51.145[.]123 2019 Initial access\n\n119.39.248[.]32 2019 Initial access\n\n120.227.35[.]98 2019 Initial access\n\n14.229.140[.]66 2019 Mount the\nfile-share\n\n172.111.210[.]53 2019 Initial access\n\n188.72.99[.]41 2019 Initial access\n\n45.9.248[.]74 2019 Initial access\n\n47.75.0[.]147 2019 Password\nspray\n\n5.254.112[.]226 2019 Initial access\n\n5.254.64[.]234 2019 Initial access\n\n59.47.4[.]27 2019 Initial access\n\n39.109.5[.]135 Q3 2017 VPN server\nlogin\n\n43.250.200[.]106 Q3 2017 VPN server\nlogin\n\n119.39.248[.]101 Q3 2017 VPN server\nlogin\n\n220.202.152[.]47 Q3 2017 VPN server\nlogin\n\n119.39.248[.]20 Q3 2017 VPN server\nlogin\n\n185.170.210[.]84 Q3 2017 VPN server\nlogin\n\n\n-----\n\nIPv4\naddress\n\nIPv4\naddress\n\n\n43.250.201[.]71 Q3 2017 VPN server\nlogin\n\n23.236.77[.]94 Q3 2017 ADFS login\n\n\nPath C:\\Code\\NtdsAudit\\src\\NtdsAudit\\obj\\Release\\ – NTDSAudit\nartifacts\n\nPath C:\\Users\\Public\\Appdata\\Local\\ – Staging and\ntools\n\nPath C:\\Users\\Public\\Appdata\\Local\\Microsoft\\Windows\\INetCache – Staging and\ntools\n\nPath C:\\Users\\Public\\Libraries\\ – Staging and\ntools\n\nPath C:\\Users\\Public\\Videos\\ – Staging and\ntools\n\nPath C:\\Windows\\Temp\\ – Staging and\ntools\n\nPath C:\\Windows\\Temp\\tmp – Staging and\ntools\n\n\nURI in CS\nbeacon\n\nURI in CS\nbeacon\n\nURI in CS\nbeacon\n\nUseragent\n\nUseragent\n\n\n/externalscripts/jquery/jquery-3.3.1.min.js Q3 2019\n– Q1\n2020\n\n/externalscripts/jquery/jquery-3.3.2.min.js Q2 2019\n– Q3\n2019\n\n\nMozilla/5.0 (Windows NT 6.3; Trident/7.0; rv:11.0) like Gecko – Cobalt Strike\nbeacon\n\n\n–\n\n–\n\n\n/jquery-3.3.2.slim.min.js Q1 2020 –\n\n\nMozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; rv:11.0)\nlike Gecko\n\n\n– Web VPN\nlogin\n\n\n## Observed discovery commands\n\n\n-----\n\nTechnique Command\n\nAccount discovery net user\n\nAccount discovery net user Administrator\n\nAccount discovery net user /domain\n\nAccount discovery dir \\\\<hostname>\\c$\\users\n\nAccount discovery dsquery user -limit 0 -s <hostname>\n\nAccount discovery psloglist.exe -accepteula -x security -s -a <current_date>\n\nAccount discovery msadcs.exe “NTDS.dit” -s “SYSTEM” -p RecordedTV_pdmp.txt –\nusers-csv RecordedTV_users.csv\n\n\nBrowser bookmark\ndiscovery\n\n\ntype \\\\<hostname>\\c$\\Users\\<username>\\Favorites\\Links\\Bookmarks\nbar\\Imported From IE\\*citrix*\n\n\nDomain trust discovery nltest /domain_trusts\n\n\nFile and directory\ndiscovery\n\nFile and directory\ndiscovery\n\nFile and directory\ndiscovery\n\nFile and directory\ndiscovery\n\n\ndir \\\\<hostname>\\c$\\\n\ndir /o:d /x /s c:\\\n\ndir /o:d /x \\\\<hostname>\\<fileshare>\n\ncacl <path to file>\n\n\nNetwork service scanning get -b <start ip> -e <end ip> -p\n\nNetwork service scanning get -b <start ip> -e <end ip>\n\nNetwork share discovery net share\n\nNetwork share discovery net view \\\\<hostname>\n\n\nPermission groups\ndiscovery\n\n\nnet localgroup administrators\n\n\nProcess discovery tasklist /v |findstr explorer\n\nProcess discovery tasklist /v |findstr taskhost\n\nProcess discovery tasklist /v |findstr 1716\n\nProcess discovery tasklist /v /s <hostname/ip>\n\nQuery registry reg query \\\\<host>\\HKU\\<SID>\\SOFTWARE\\Microsoft\\Terminal\nServer Client\\Servers\n\nQuery registry reg query \\\\<host>\\HKU\\\n<SID>\\Software\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\n\nRemote system discovery type \\\\<host>\\c$\\Users\\<username>\\Favorites\\Links\\Bookmarks\nbar\\Imported From IE\\*citrix*\n\nRemote system discovery type \\\\<host>\\<path>\\Cookies\\*ctx*\n\n\n-----\n\nRemote system discovery reg query \\\\<host>\\HKU\\<SID>\\SOFTWARE\\Microsoft\\Terminal\nServer Client\\Servers\n\nRemote system discovery dir /o:d /x \\\\<hostname>\\c$\\users\\<username>\\Favorites\n\nRemote system discovery net view \\\\hostname\n\nRemote system discovery dsquery server -limit 0\n\n\nSystem information\ndiscovery\n\nSystem information\ndiscovery\n\nSystem information\ndiscovery\n\nSystem network\nconfiguration discovery\n\nSystem network\nconfiguration discovery\n\nSystem network\nconfiguration discovery\n\nSystem network\nconfiguration discovery\n\nSystem network\nconfiguration discovery\n\nSystem network\nconfiguration discovery\n\nSystem network\nconnections discovery\n\nSystem Owner/User\nDiscovery\n\n\nfsutil fsinfo drives\n\nsysteminfo\n\nvssadmin list shadows\n\nipconfig\n\nipconfig /all\n\nping -n 1 -a <ip>\n\nping -n 1 <hostname>\n\ntracert <ip>\n\npathping <ip>\n\nnetstat -ano | findstr EST\n\nquser\n\n\nSystem service discovery net start\n\nSystem service discovery net use\n\nSystem time discovery time /t\n\nSystem time discovery net time \\\\<ip/hostname>\n\n## Observed Defense evasion commands\n\n**Indicator Removal on Host: Clear Windows Event Logs**\n```\nwevtutil cl \"Windows PowerShell\"\nwevtutil cl application\nwevtutil cl security\nwevtutil cl setup\nwevtutil cl system\n\n```\n**Indicator Removal on Host: File Deletion**\n\n\n-----\n\n```\nde / /q cs b\ndel /f/q *.exe\ndel /f/q *.exe *log.txt\ndel /f/q *.ost\ndel /f/q .rar update .txt\ndel /f/q \\\\c$\\windows\\temp*.txt\ndel /f/q \\\\c$\\Progra~1\\Common~1\\System\\msadc\\msadcs.dmp\ndel /f/q msadcs*\ndel /f/q psloglist.exe\ndel /f/q update*\ndel /f/q update* .txt del /f/q update.rar\ndel /f/q update*rar\ndel /f/q update12321312.rarschtasks /delete /s /tn \"update\" /f\nschtasks /delete /tn \"update\" /f\nshred -n 123 -z -u .tar.gz\n\n## MITRE ATT&CK references\n\n```\n\n-----\n\nName Type ID More info\n\n**Initial Access** **Tactic** **TA0001** **[https://attack.mitre.org/tactics/TA0001/](https://attack.mitre.org/tactics/TA0001/)**\n\n\nExternal Remote\nServices\n\n\nTechnique T1133 [https://attack.mitre.org/techniques/T1133/](https://attack.mitre.org/techniques/T1133/)\n\n\nValid Accounts Technique T1078 [https://attack.mitre.org/techniques/T1078/](https://attack.mitre.org/techniques/T1078/)\n\n**Execution** **Tactic** **TA0002** **[https://attack.mitre.org/tactics/TA0002/](https://attack.mitre.org/tactics/TA0002/)**\n\n\nCommand and Scripting\nInterpreter: PowerShell\n\nCommand and Scripting\nInterpreter: Windows\nCommand Shell\n\nScheduled Task/Job:\nScheduled Task\n\nSystem Services:\nService Execution\n\nWindows Management\nInstrumentation\n\n\nTechnique T1059.001 [https://attack.mitre.org/techniques/T1059/001/](https://attack.mitre.org/techniques/T1059/001/)\n\nTechnique T1059.003 [https://attack.mitre.org/techniques/T1059/003/](https://attack.mitre.org/techniques/T1059/003/)\n\nTechnique T1053.005 [https://attack.mitre.org/techniques/T1053/005/](https://attack.mitre.org/techniques/T1053/005/)\n\nTechnique T1569.002 [https://attack.mitre.org/techniques/T1569/002/](https://attack.mitre.org/techniques/T1569/002/)\n\nTechnique T1047 [https://attack.mitre.org/techniques/T1047/](https://attack.mitre.org/techniques/T1047/)\n\n\n**Persistence** **Tactic** **TA0003** **[https://attack.mitre.org/tactics/TA0003/](https://attack.mitre.org/tactics/TA0003/)**\n\n\nExternal Remote\nServices\n\nHijack Execution Flow:\nDLL Side-Loading\n\n\nTechnique T1133 [https://attack.mitre.org/techniques/T1133/](https://attack.mitre.org/techniques/T1133/)\n\nTechnique T1574.002 [https://attack.mitre.org/techniques/T1574/002/](https://attack.mitre.org/techniques/T1574/002/)\n\n\nValid Accounts Technique T1078 [https://attack.mitre.org/techniques/T1078/](https://attack.mitre.org/techniques/T1078/)\n\n**Privilege Escalation** **Tactic** **TA0004** **[https://attack.mitre.org/tactics/TA0004/](https://attack.mitre.org/tactics/TA0004/)**\n\nValid Accounts Technique T1078 [https://attack.mitre.org/techniques/T1078/](https://attack.mitre.org/techniques/T1078/)\n\n**Defense Evasion** **Tactic** **TA0005** **[https://attack.mitre.org/tactics/TA0005/](https://attack.mitre.org/tactics/TA0005/)**\n\n\nDeobfuscate/Decode\nFiles or Information\n\nIndicator Removal on\nHost: Clear Windows\nEvent Logs\n\nIndicator Removal on\nHost: File Deletion\n\nIndicator Removal on\nHost: Timestomp\n\nHijack Execution Flow:\nDLL Side-Loading\n\nMasquerading: Rename\nSystem Utilities\n\n\nTechnique T1140 [https://attack.mitre.org/techniques/T1140/](https://attack.mitre.org/techniques/T1140/)\n\nTechnique T1070.001 [https://attack.mitre.org/techniques/T1070/001/](https://attack.mitre.org/techniques/T1070/001/)\n\nTechnique T1070.004 [https://attack.mitre.org/techniques/T1070/004/](https://attack.mitre.org/techniques/T1070/004/)\n\nTechnique T1070.006 [https://attack.mitre.org/techniques/T1070/006/](https://attack.mitre.org/techniques/T1070/006/)\n\nTechnique T1574.002 [https://attack.mitre.org/techniques/T1574/002/](https://attack.mitre.org/techniques/T1574/002/)\n\nTechnique T1036.003 [https://attack.mitre.org/techniques/T1036/003/](https://attack.mitre.org/techniques/T1036/003/)\n\n\n-----\n\nMasquerading: Match\nLegitimate Name or\nLocation\n\nUse Alternate\nAuthentication Material:\nPass the Hash\n\n\nTechnique T1036.005 [https://attack.mitre.org/techniques/T1036/005/](https://attack.mitre.org/techniques/T1036/005/)\n\nTechnique T1550.002 [https://attack.mitre.org/techniques/T1550/002/](https://attack.mitre.org/techniques/T1550/002/)\n\n\nValid Accounts Technique T1078 [https://attack.mitre.org/techniques/T1078/](https://attack.mitre.org/techniques/T1078/)\n\n**Credential Access** **Tactic** **TA0006** **[https://attack.mitre.org/tactics/TA0006/](https://attack.mitre.org/tactics/TA0006/)**\n\n\nBrute Force: Password\nSpraying\n\nBrute Force: Credential\nStuffing\n\nOS Credential Dumping:\nLSASS Memory\n\nOS Credential Dumping:\nNTDS\n\nTwo-Factor\nAuthentication\nInterception\n\n\nTechnique T1110.003 [https://attack.mitre.org/techniques/T1110/003/](https://attack.mitre.org/techniques/T1110/003/)\n\nTechnique T1110.004 [https://attack.mitre.org/techniques/T1110/004/](https://attack.mitre.org/techniques/T1110/004/)\n\nTechnique T1003.001 [https://attack.mitre.org/techniques/T1003/001/](https://attack.mitre.org/techniques/T1003/001/)\n\nTechnique T1003.003 [https://attack.mitre.org/techniques/T1003/003/](https://attack.mitre.org/techniques/T1003/003/)\n\nTechnique T1111 [https://attack.mitre.org/techniques/T1111/](https://attack.mitre.org/techniques/T1111/)\n\n\n**Discovery** **Tactic** **TA0007** **[https://attack.mitre.org/tactics/TA0007/](https://attack.mitre.org/tactics/TA0007/)**\n\nAccount Discovery Technique T1087\n\n\nAccount Discovery: Local\nAccount\n\nAccount Discovery:\nDomain Account\n\nBrowser Bookmark\nDiscovery\n\n\nTechnique T1087.001 [https://attack.mitre.org/techniques/T1087/001/](https://attack.mitre.org/techniques/T1087/001/)\n\nTechnique T1087.002 [https://attack.mitre.org/techniques/T1087/002/](https://attack.mitre.org/techniques/T1087/002/)\n\nTechnique T1217 [https://attack.mitre.org/techniques/T1217/](https://attack.mitre.org/techniques/T1217/)\n\n\nDomain Trust Discovery Technique T1482 [https://attack.mitre.org/techniques/T1482/](https://attack.mitre.org/techniques/T1482/)\n\n\nFile and Directory\nDiscovery\n\nNetwork Service\nScanning\n\n\nTechnique T1083 [https://attack.mitre.org/techniques/T1083](https://attack.mitre.org/techniques/T1083)\n\nTechnique T1046 [https://attack.mitre.org/techniques/T1046](https://attack.mitre.org/techniques/T1046)\n\n\nNetwork Share Discovery Technique T1135 [https://attack.mitre.org/techniques/T1135](https://attack.mitre.org/techniques/T1135)\n\n\nPermission Groups\nDiscovery\n\n\nTechnique T1069 [https://attack.mitre.org/techniques/T1069](https://attack.mitre.org/techniques/T1069)\n\n\nProcess Discovery Technique T1057 [https://attack.mitre.org/techniques/T1057](https://attack.mitre.org/techniques/T1057)\n\nQuery Registry Technique T1012 [https://attack.mitre.org/techniques/T1012](https://attack.mitre.org/techniques/T1012)\n\n\nRemote System\nDiscovery\n\nSystem Information\nDiscovery\n\n\nTechnique T1018 [https://attack.mitre.org/techniques/T1018](https://attack.mitre.org/techniques/T1018)\n\nTechnique T1082 [https://attack.mitre.org/techniques/T1082](https://attack.mitre.org/techniques/T1082)\n\n\n-----\n\nSystem Network\nConfiguration Discovery\n\nSystem Network\nConnections Discovery\n\nSystem Owner/User\nDiscovery\n\nSystem Service\nDiscovery\n\n\nTechnique T1016 [https://attack.mitre.org/techniques/T1016](https://attack.mitre.org/techniques/T1016)\n\nTechnique T1049 [https://attack.mitre.org/techniques/T1049](https://attack.mitre.org/techniques/T1049)\n\nTechnique T1033 [https://attack.mitre.org/techniques/T1033](https://attack.mitre.org/techniques/T1033)\n\nTechnique T1007 [https://attack.mitre.org/techniques/T1007](https://attack.mitre.org/techniques/T1007)\n\n\nSystem Time Discovery Technique T1124 [https://attack.mitre.org/techniques/T1124](https://attack.mitre.org/techniques/T1124)\n\n**Lateral Movement** **Tactic** **TA0008** **[https://attack.mitre.org/tactics/TA0008/](https://attack.mitre.org/tactics/TA0008/)**\n\nLateral Tool Transfer Technique T1570 [https://attack.mitre.org/techniques/T1570/](https://attack.mitre.org/techniques/T1570/)\n\n\nRemote Services:\nSMB/Windows Admin\nShares\n\n\nTechnique T1021.002 [https://attack.mitre.org/techniques/T1021/002/](https://attack.mitre.org/techniques/T1021/002/)\n\n\nRemote Services: SSH Technique T1021.004 [https://attack.mitre.org/techniques/T1021/004/](https://attack.mitre.org/techniques/T1021/004/)\n\n\nRemote Services:\nWindows Remote\nManagement\n\nUse Alternate\nAuthentication Material:\nPass the Hash\n\n\nTechnique T1021.006 [https://attack.mitre.org/techniques/T1021/006/](https://attack.mitre.org/techniques/T1021/006/)\n\nTechnique T1550.002 [https://attack.mitre.org/techniques/T1550/002/](https://attack.mitre.org/techniques/T1550/002/)\n\n\n**Collection** **Tactic** **TA0009** **[https://attack.mitre.org/tactics/TA0009/](https://attack.mitre.org/tactics/TA0009/)**\n\n\nArchive Collected Data:\nArchive via Utility\n\n\nTechnique T1560.001 [https://attack.mitre.org/techniques/T1560/001/](https://attack.mitre.org/techniques/T1560/001/)\n\n\nAutomated Collection Technique T1119 [https://attack.mitre.org/techniques/T1119/](https://attack.mitre.org/techniques/T1119/)\n\n\nData from Information\nRepositories: SharePoint\n\n\nTechnique T1213.002 [https://attack.mitre.org/techniques/T1213/002/](https://attack.mitre.org/techniques/T1213/002/)\n\n\nData from Local System Technique T1005 [https://attack.mitre.org/techniques/T1005/](https://attack.mitre.org/techniques/T1005/)\n\n\nData from Network\nShared Drive\n\nData Staged: Local Data\nStaging\n\nData Staged: Remote\nData Staging\n\nEmail Collection: Local\nEmail Collection\n\n\nTechnique T1039 [https://attack.mitre.org/techniques/T1039/](https://attack.mitre.org/techniques/T1039/)\n\nTechnique T1074.001 [https://attack.mitre.org/techniques/T1074/001/](https://attack.mitre.org/techniques/T1074/001/)\n\nTechnique T1074.002 [https://attack.mitre.org/techniques/T1074/002/](https://attack.mitre.org/techniques/T1074/002/)\n\nTechnique T1114.001 [https://attack.mitre.org/techniques/T1114/001/](https://attack.mitre.org/techniques/T1114/001/)\n\n\n**Command and Control** **Tactic** **TA0011** **[https://attack.mitre.org/tactics/TA0011/](https://attack.mitre.org/tactics/TA0011/)**\n\n\nApplication Layer\nProtocol: Web Protocols\n\nApplication Layer\nProtocol: DNS\n\n\nTechnique T1071.001 [https://attack.mitre.org/techniques/T1071/001/](https://attack.mitre.org/techniques/T1071/001/)\n\nTechnique T1071.004 [https://attack.mitre.org/techniques/T1071/004/](https://attack.mitre.org/techniques/T1071/004/)\n\n\n-----\n\nEncrypted Channel:\nAsymmetric\nCryptography\n\n\nTechnique T1573.002 [https://attack.mitre.org/techniques/T1573/002/](https://attack.mitre.org/techniques/T1573/002/)\n\n\nProtocol Tunneling Technique T1572 [https://attack.mitre.org/techniques/T1572/](https://attack.mitre.org/techniques/T1572/)\n\n**Exfiltration** **Tactic** **TA0010** **[https://attack.mitre.org/tactics/TA0010/](https://attack.mitre.org/tactics/TA0010/)**\n\nAutomated Exfiltration Technique T1020 [https://attack.mitre.org/techniques/T1020/](https://attack.mitre.org/techniques/T1020/)\n\nData Transfer Size Limits Technique T1030 [https://attack.mitre.org/techniques/T1030/](https://attack.mitre.org/techniques/T1030/)\n\n\nExfiltration Over C2\nChannel\n\nExfiltration Over Web\nService: Exfiltration to\nCloud Storage\n\n\nTechnique T1041 [https://attack.mitre.org/techniques/T1041/](https://attack.mitre.org/techniques/T1041/)\n\nTechnique T1567.002 [https://attack.mitre.org/techniques/T1567/002/](https://attack.mitre.org/techniques/T1567/002/)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        }
    ],
    "references": [
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2021/2021.01.12.Abusing_cloud_services_Chimera/research.nccgroup.com-Abusing%20cloud%20services%20to%20fly%20under%20the%20radar.pdf"
    ],
    "report_names": [
        "research.nccgroup.com-Abusing cloud services to fly under the radar"
    ],
    "threat_actors": [
        {
            "id": "873a6c6f-a4d1-49b3-8142-4a147d4288ef",
            "created_at": "2022-10-25T16:07:23.455744Z",
            "updated_at": "2025-03-27T02:02:09.811933Z",
            "deleted_at": null,
            "main_name": "Chimera",
            "aliases": [
                "Operation Skeleton Key"
            ],
            "source_name": "ETDA:Chimera",
            "tools": [
                "Agentemis",
                "Cobalt Strike",
                "CobaltStrike",
                "SkeletonKeyInjector",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "610a7295-3139-4f34-8cec-b3da40add480",
            "created_at": "2023-01-06T13:46:38.608142Z",
            "updated_at": "2025-03-27T02:00:02.87217Z",
            "deleted_at": null,
            "main_name": "Cobalt",
            "aliases": [
                "Cobalt Gang",
                "GOLD KINGSWOOD",
                "COBALT SPIDER",
                "G0080",
                "Mule Libra",
                "Cobalt Group"
            ],
            "source_name": "MISPGALAXY:Cobalt",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "f88b16bc-df4b-48e7-ae35-f4117240ff24",
            "created_at": "2022-10-25T15:50:23.556699Z",
            "updated_at": "2025-03-27T02:00:55.499173Z",
            "deleted_at": null,
            "main_name": "Chimera",
            "aliases": [
                "Chimera"
            ],
            "source_name": "MITRE:Chimera",
            "tools": [
                "PsExec",
                "esentutl",
                "Mimikatz",
                "Cobalt Strike"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1666716495,
    "ts_updated_at": 1743041417,
    "ts_creation_date": 1610444257,
    "ts_modification_date": 1610444257,
    "files": {
        "pdf": "https://archive.orkl.eu/d5cf4e80ac62b5e17eaf837484b6e99c5a7e1c34.pdf",
        "text": "https://archive.orkl.eu/d5cf4e80ac62b5e17eaf837484b6e99c5a7e1c34.txt",
        "img": "https://archive.orkl.eu/d5cf4e80ac62b5e17eaf837484b6e99c5a7e1c34.jpg"
    }
}