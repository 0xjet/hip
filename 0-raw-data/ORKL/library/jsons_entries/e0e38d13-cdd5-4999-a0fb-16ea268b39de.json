{
    "id": "e0e38d13-cdd5-4999-a0fb-16ea268b39de",
    "created_at": "2022-10-25T16:48:15.928671Z",
    "updated_at": "2025-03-27T02:15:41.706306Z",
    "deleted_at": null,
    "sha1_hash": "f4c3883bdb12af3225b3b57f2d8352cb37586312",
    "title": "On the StrongPity Waterhole Attacks Targeting Italian and Belgian Encryption Users",
    "authors": "Kaspersky",
    "file_creation_date": "2016-10-19T14:51:35Z",
    "file_modification_date": "0001-01-01T00:00:00Z",
    "file_size": 561593,
    "plain_text": "# g y g g Belgian Encryption Users\n\n**[securelist.com /blog/research/76147/on-the-strongpity-waterhole-attacks-targeting-italian-and-belgian-](https://securelist.com/blog/research/76147/on-the-strongpity-waterhole-attacks-targeting-italian-and-belgian-encryption-users/)**\nencryption-users/\n\nBy Kurt Baumgartner\n\n[Kurt Baumgartner](https://securelist.com/author/kurtb/)\n\nPrincipal Security Researcher, GReAT\n\nThe StrongPity APT is a technically capable group operating under the radar for several years.\nThe group has quietly deployed zero-day in the past, effectively spearphished targets, and\nmaintains a modular toolset. What is most interesting about this group’s more recent activity\nhowever, is their focus on users of encryption tools, peaking this summer. In particular, the focus\nwas on Italian and Belgian users, but the StrongPity watering holes affected systems in far more locations than just\nthose two. Adding in their creative waterholing and poisoned installer tactics, we describe the StrongPity APT as not\nonly determined and well-resourced, but fairly reckless and innovative as well.\n\n## Encryption Tools\n\nClearly this APT is interested in encrypted data and communications. The tools targeted by this group enable\npractices for securing secrecy and integrity of data. For example, WinRAR packs and encrypts files with strong\nsuites like AES-256, and TrueCrypt encrypts full hard drives all in one swoop. Both WinRAR and TrueCrypt help\nprovide strong and reliable encryption. WinRAR enables a person to encrypt a file with AES-256 in CBC mode with\na strong PBKDF2 HMAC-SHA256 based key. And, TrueCrypt provides an effective open-source full disk encryption\nsolution for Windows, Apple, Linux, and Android systems. Using both of these tools together, a sort of one off, poor\nman’s end-to-end encryption can be maintained for free by putting these two solutions together with free file sharing\nservices.\n\nOther software applications help to support encrypted sessions and communications. Well known applications\nsupporting end-to-end encryption are used by hundreds of millions of folks, sometimes unknowingly, every day. IM\nclients like Microsoft’s Skype implement 256-bit AES encrypted communications, while Putty, Winscp and Windows\nRemote Desktop help provide private communications and sessions with fully encrypted communications as well.\nMost of these communications across the wire are currently unbreakable when intercepted, at least, when the\napplications are configured properly.\n\n## Summer 2016 Watering Hole Resources and Trickery – WinRAR and TrueCrypt\n\nThis actor set up a particularly clever site to deliver trojanized WinRAR installers in the summer of 2016, appears to\n[have compromised another, and this activity reminds us somewhat of the early 2014 Crouching Yeti activity. Much of](https://securelist.com/blog/research/65240/energetic-bear-more-like-a-crouching-yeti/)\nthe Crouching Yeti intrusions were enabled by trojanizing legitimate ICS-related IT software installers like SCADA\nenvironment vpn client installers and industrial camera software driver installers. Then, they would compromise the\nlegitimate company software distribution sites and replace the legitimate installers with the Crouching Yeti trojanized\nversions. The tactics effectively compromised ICS and SCADA related facilities and networks around the world.\nSimply put, even when visiting a legitimate company distribution site, IT staff was downloading and installing ICS\n\n-----\n\n(ralrab[.]com) mimicking the legitimate WinRAR distribution site (rarlab[.]com), and then placed links on a legitimate\n“certified distributor” site in Europe to redirect to their poisoned installers hosted on ralrab[.]com. In Belgium, the\nattackers placed a “recommended” link to their ralrab[.]com site in the middle of the localized WinRAR distribution\npage on winrar[.]be. The big blue recommended button (here in French) linked to the malicious installer, while all the\nother links on the page directed to legitimate software:\n\n_Winrar[.]be site with “recommended link” leading to malicious ralrab[.]com_\n\nThe winrar[.]be site evaluated what “recommended” package a visitor may need based on browser localization and\nprocessor capability, and accordingly offered up appropriate trojanized versions. Installer resources named for\nfrench and dutch versions, along with 32-bit versus 64-bit compiled executables were provided over the summer:\n\nhxxp://www.ralrab[.]com/rar/winrar-x64-531.exe\n\nhxxp://www.ralrab[.]com/rar/winrar-x64-531fr.exe\n\nhxxp://www.ralrab[.]com/rar/winrar-x64-531nl.exe\n\nhxxp://www.ralrab[.]com/rar/wrar531.exe\n\nhxxp://www.ralrab[.]com/rar/wrar531fr.exe\n\nhxxp://www.ralrab[.]com/rar/wrar531nl.exe\n\nhxxp://ralrab[.]com/rar/winrar-x64-531.exe\n\nhxxp://ralrab[.]com/rar/winrar-x64-531nl.exe\n\nhxxp://ralrab[.]com/rar/wrar531fr.exe\n\nhxxp://ralrab[.]com/rar/wrar531nl.exe\n\n\n-----\n\n_Directory listing, poisoned StrongPity installers, at rarlrab[.]com_\n\nThe first available visitor redirects from winrar[.]be to ralrab[.]com first appeared on May 28th, 2016, from the\ndutch speaking version of the winrar.be site. And around the same time, another “certified distributor” winrar[.]it\nserved trojanized installers as well. The major difference here is that we didn’t record redirections to ralrab[.]com,\nbut it appears the site directly served StrongPity trojanized installers:\n\nhxxps://www.winrar[.]it/prelievo/WinRAR-x64-531it.exe\n\nhxxps://www.winrar[.]it/prelievo/WRar531it.exe\n\nThe site started serving these executables a couple of days earlier on 5/24, where a large majority of Italian visitors\nwhere affected.\n\n\n-----\n\n_Download page, winrar[.]it_\n\nQuite simply, the download links on this site directed visitors to trojanized WinRAR installers hosted from the\nwinrar.it site itself. It’s interesting to note that both of the sites are “distributors”, where the sites are owned and\nmanaged not by rarlabs, but by local owners in individual countries.\n\nStrongPity also directed specific visitors from popular, localized software sharing sites directly to their trojanized\ninstallers. This activity continued into late September 2016. In particular, the group redirected visitors from software\naggregation and sharing site tamindir[.]com to their attacker-controlled site at true-crypt[.]com. The StrongPity\ncontrolled Truecrypt site is a complete rip of the legitimate site, now hosted by Sourceforge. Here is the Tamindir\ntruecrypt page, looks harmless enough.\n\n\n-----\n\n_TrueCrypt page, tamindir software sharing site_\n\nUnlike the newer poisoned WinRAR installers, StrongPity hosted several Much like the poisoned WinRAR\ninstallers, multiple filenames have been used to keep up with visitor interests. Visitors may have been directed to the\nsite by other means and downloaded directly from the ripped and persuasive site.\n\n\n-----\n\n_true-crypt[.]com malicious StrongPity distribution site_\n\nAt the very bottom of the page, there are a couple of links to the poisoned installers:\n\nhxxp://www.true-crypt[.]com/download/TrueCrypt-Setup-7.1a.exe\n\nhxxp://true-crypt[.]com/files/TrueCrypt-7.2.exe\n\nReferrers include these localized software aggregates and sharers:\n\ngezginler[.]net/indir/truecrypt.html\n\ntamindir[.]com/truecrypt/indir\n\nIt’s interesting that Ksn recorded appearance of the the file on two unique systems in December 2015, a third in\nJanuary 2016, all in Turkey, and then nothing until May 2016. Then, deployment of the installers continued mostly\nwithin Turkey in July and September 2016.\n\n## Summer 2016 Watering Hole Victim Geolocations – WinRAR and TrueCrypt\n\n\n-----\n\nEurope and Northern Africa/Middle East. Likely, many more infections actually occurred. Accordingly, the country\nwith the overwhelming number of detections was in Italy followed by Belgium and Algeria. The top countries with\nStrongPity malware from the winrar.it site from May 25th through the first few days of June are\nItaly, Belgium, Algeria, Cote D’Ivoire, Morroco, France, and Tunisia.\n\n_winrar[.]it StrongPity component geolocation distribution_\n\nIn a similar time-span, the over sixty visitors redirected from winrar.be to ralrab.com for malicious file download were\noverwhelmingly located in one country. The top countries directed to StrongPity malware from the winrar.be site\nfrom May 25th through the first few days of June are Belgium, Algeria, Morroco, Netherlands, Canada, Cote D’Ivoire,\nand Tunisia.\n\n\n-----\n\n_StrongPity_\n_component_\n_geolocation_\n_distribution_\n\nStrongPity\npreviously set\nup TrueCrypt\nthemed\nwatering holes\nin late 2015.\nBut their\noffensive\nactivity surged\nin late summer\n2016. The\ngroup set up a\nsite directly\npulled from the contents of the legitimate TrueCrypt website. From mid July to early September, dozens of visitors\nwere redirected from tamindir[.]com to true-crypt[.]com with unsurprisingly almost all of the focus on systems in\nTurkey, with victims in the Netherlands as well.\n\n_tamindir[.]com to true-_\n_crypt[.]com poisoned_\n_TrueCrypt installer_\n_redirects_\n\n## StrongPity Malware\n\nThe StrongPity droppers were often signed with unusual digital certificates, dropping multiple components that not\nonly provide complete control of the victim system, but effectively steal disk contents, and can download\ncomponents for further collection of various communications and contacts. Because we are talking about StrongPity\nwatering holes, let’s take a quick look at what is being delivered by the group from these sites.\n\nWhen we count all systems from 2016 infected with any one of the StrongPity components or a dropper, we see a\nmore expansive picture. This data includes over 1,000 systems infected with a StrongPity component. The top five\n\n\n-----\n\nof the\n\nwinrar[.]be/ralrab[.]com watering hole malware, each one of the six droppers that we observed created a similar set\nof dropped components on disk. And, in these cases, the attackers did not re-use their fake digital certificates. In\naddition to installing the legitimate version of WinRAR, the dropper installed the following StrongPity components:\n\n%temp%\\procexp.exe\n\n%temp%\\sega\\\n\nnvvscv.exe\n\nprst.cab\n\nprst.dll\n\nwndplyr.exe\n\nwrlck.cab\n\nwrlck.dll\n\nOf these files, two are configurable and encrypted with the same keyless cipher, “wrlck.cab” and “prst.cab”. While\none maintains several callback c2 for the backdoor to fetch more instructions and upload installed software and file\npaths, the other maintains something a bit more unusual. “prst.cab” maintains an encrypted list of programs that\nmaintain encrypted connections. This simple encoding takes the most significant nibble for each character, swaps\nthe nibbles of that byte, and xors the result against the original value. Its code looks something like this:\n\nx = s[i];\n\nj = ((x & 0xF0)>>4);\n\ny = x ^ j;\n\n\n-----\n\nputty.exe (a windows SSH client)\n\nfilezilla.exe (supports ftps uploads)\n\nwinscp.exe (a windows secure copy application, providing encrypted and secure file transfer)\n\nmstsc.exe (Windows Remote Desktop client, providing an encrypted connection to remote systems)\n\nmRemoteNG.exe (a remote connections manager supporting SSH, RDP, and other encrypted protocols)\n\nAlso included in StrongPity components are keyloggers and additional data stealers.\n\n## Conclusion\n\nWidely available, strong cryptography software tools help provide secure and private communications that are now\neasily obtained and usable. In the summer of 2016, multiple encryption-enabled software applications were targeted\nwith watering hole, social engineering tactics, and spyware by the StrongPity APT. While watering holes and\npoisoned installers are tactics that have been effectively used by other APT, we have never seen the same focus on\ncryptographic-enabled software. When visiting sites and downloading encryption-enabled software, it has become\nnecessary to verify the validity of the distribution site and the integrity of the downloaded file itself. Download sites\nnot using PGP or strong digital code signing certificates need to re-examine the necessity of doing so for their own\ncustomers. We have seen other APT such as Crouching Yeti and Darkhotel distribute poisoned installers and\npoisoned executable code, then redistribute them through similar tactics and over p2p networks. Hopefully, simpler\nverification systems than the current batch of PGP and SSL applications will arise to be adopted in larger numbers.\nUntil then, strong anti-malware and dynamic whitelisting solutions will be more necessary than ever.\n\n_More information about the StrongPity APT group is available to customers of_ _[Kaspersky Intelligent Services.](http://www.kaspersky.com/business-security/entrp/apt)_\n_[Contact: intelreports@kaspersky.com](mailto:intelreports@kaspersky.com)_\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "d63ae2b7-445f-460d-965d-2676dacdb6de",
            "created_at": "2022-10-25T15:59:19.552139Z",
            "updated_at": "2022-10-25T15:59:19.552139Z",
            "deleted_at": null,
            "name": "APTnotes",
            "url": "https://github.com/aptnotes/data",
            "description": "APTnotes data",
            "reports": null
        }
    ],
    "references": [
        "https://app.box.com/s/c9w0xp0mgndij268ku7ti5ee4lxu54bv"
    ],
    "report_names": [
        "Kaspersky_StrongPity-Waterhole-Targeting-Italian-Belgian-Encryption-Users(10-03-2016)"
    ],
    "threat_actors": [
        {
            "id": "1dadf04e-d725-426f-9f6c-08c5be7da159",
            "created_at": "2022-10-25T15:50:23.624538Z",
            "updated_at": "2025-03-27T02:00:55.508759Z",
            "deleted_at": null,
            "main_name": "Darkhotel",
            "aliases": [
                "Darkhotel",
                "DUBNIUM",
                "Zigzag Hail"
            ],
            "source_name": "MITRE:Darkhotel",
            "tools": null,
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "67fbc7d7-ba8e-4258-b53c-9a5d755e1960",
            "created_at": "2022-10-25T16:07:24.077859Z",
            "updated_at": "2025-03-27T02:02:10.101173Z",
            "deleted_at": null,
            "main_name": "Promethium",
            "aliases": [
                "APT-C-41",
                "Promethium",
                "StrongPity"
            ],
            "source_name": "ETDA:Promethium",
            "tools": [
                "StrongPity",
                "StrongPity2",
                "StrongPity3",
                "Truvasys"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "5cbf6c32-482d-4cd2-9d11-0d9311acdc28",
            "created_at": "2023-01-06T13:46:38.39927Z",
            "updated_at": "2025-03-27T02:00:02.823829Z",
            "deleted_at": null,
            "main_name": "ENERGETIC BEAR",
            "aliases": [
                "DYMALLOY",
                "TG-4192",
                "Crouching Yeti",
                "Group 24",
                "Havex",
                "IRON LIBERTY",
                "Blue Kraken",
                "ALLANITE",
                "Koala Team",
                "G0035",
                "ATK6",
                "ITG15",
                "Ghost Blizzard",
                "BERSERK BEAR"
            ],
            "source_name": "MISPGALAXY:ENERGETIC BEAR",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "cbede712-4cc3-47c6-bf78-92fd9f1beac6",
            "created_at": "2022-10-25T15:50:23.777222Z",
            "updated_at": "2025-03-27T02:00:55.544919Z",
            "deleted_at": null,
            "main_name": "PROMETHIUM",
            "aliases": [
                "PROMETHIUM",
                "StrongPity"
            ],
            "source_name": "MITRE:PROMETHIUM",
            "tools": [
                "Truvasys",
                "StrongPity"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "649b5b3e-b16e-44db-91bc-ae80b825050e",
            "created_at": "2022-10-25T15:50:23.290412Z",
            "updated_at": "2025-03-27T02:00:55.431037Z",
            "deleted_at": null,
            "main_name": "Dragonfly",
            "aliases": [
                "TEMP.Isotope",
                "DYMALLOY",
                "Berserk Bear",
                "TG-4192",
                "Crouching Yeti",
                "IRON LIBERTY",
                "Energetic Bear",
                "Ghost Blizzard"
            ],
            "source_name": "MITRE:Dragonfly",
            "tools": [
                "MCMD",
                "Impacket",
                "CrackMapExec",
                "Backdoor.Oldrea",
                "Mimikatz",
                "PsExec",
                "Trojan.Karagany",
                "netsh"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "1a76ed30-4daf-4817-98ae-87c667364464",
            "created_at": "2022-10-25T16:47:55.891029Z",
            "updated_at": "2025-03-27T02:05:17.408867Z",
            "deleted_at": null,
            "main_name": "IRON LIBERTY",
            "aliases": [
                "ATK6 ",
                "BROMINE ",
                "CASTLE ",
                "Crouching Yeti ",
                "DYMALLOY ",
                "Dragonfly ",
                "Energetic Bear / Berserk Bear ",
                "Ghost Blizzard ",
                "TEMP.Isotope ",
                "TG-4192 ",
                "ALLANITE "
            ],
            "source_name": "Secureworks:IRON LIBERTY",
            "tools": [
                " Ddex Loader",
                " Havex",
                " Karagany",
                " Loek",
                " MCMD",
                " Sysmain",
                " xfrost",
                "ClientX"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "3a0be4ff-9074-4efd-98e4-47c6a62b14ad",
            "created_at": "2022-10-25T16:07:23.590051Z",
            "updated_at": "2025-03-27T02:02:09.878211Z",
            "deleted_at": null,
            "main_name": "Energetic Bear",
            "aliases": [
                "ATK 6",
                "Blue Kraken",
                "Crouching Yeti",
                "Dragonfly",
                "Electrum",
                "Energetic Bear",
                "Ghost Blizzard",
                "Group 24",
                "ITG15",
                "Iron Liberty",
                "Koala Team",
                "TG-4192"
            ],
            "source_name": "ETDA:Energetic Bear",
            "tools": [
                "Backdoor.Oldrea",
                "CRASHOVERRIDE",
                "Commix",
                "CrackMapExec",
                "CrashOverride",
                "Dirsearch",
                "Dorshel",
                "Fertger",
                "Fuerboos",
                "Goodor",
                "Havex",
                "Havex RAT",
                "Hello EK",
                "Heriplor",
                "Impacket",
                "Industroyer",
                "Karagany",
                "Karagny",
                "LightsOut 2.0",
                "LightsOut EK",
                "Listrix",
                "Oldrea",
                "PEACEPIPE",
                "PHPMailer",
                "PsExec",
                "SMBTrap",
                "Subbrute",
                "Sublist3r",
                "Sysmain",
                "Trojan.Karagany",
                "WSO",
                "Webshell by Orb",
                "Win32/Industroyer",
                "Wpscan",
                "nmap",
                "sqlmap",
                "xFrost"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "b13c19d6-247d-47ba-86ba-15a94accc179",
            "created_at": "2024-05-01T02:03:08.149923Z",
            "updated_at": "2025-03-27T02:05:17.422065Z",
            "deleted_at": null,
            "main_name": "TUNGSTEN BRIDGE",
            "aliases": [
                "DUBNIUM ",
                "DarkHotel ",
                "CTG-1948 "
            ],
            "source_name": "Secureworks:TUNGSTEN BRIDGE",
            "tools": [
                "Nemim"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "2b4eec94-7672-4bee-acb2-b857d0d26d12",
            "created_at": "2023-01-06T13:46:38.272109Z",
            "updated_at": "2025-03-27T02:00:02.790029Z",
            "deleted_at": null,
            "main_name": "DarkHotel",
            "aliases": [
                "DUBNIUM",
                "Fallout Team",
                "Luder",
                "Tapaoux",
                "Shadow Crane",
                "APT-C-06",
                "SIG25",
                "Karba",
                "Nemim",
                "Nemin",
                "G0012",
                "ATK52",
                "T-APT-02",
                "TUNGSTEN BRIDGE",
                "Zigzag Hail"
            ],
            "source_name": "MISPGALAXY:DarkHotel",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "4660477f-333f-4a18-b49b-0b4d7c66d482",
            "created_at": "2023-01-06T13:46:38.511962Z",
            "updated_at": "2025-03-27T02:00:02.852307Z",
            "deleted_at": null,
            "main_name": "PROMETHIUM",
            "aliases": [
                "StrongPity",
                "G0056"
            ],
            "source_name": "MISPGALAXY:PROMETHIUM",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "c0cedde3-5a9b-430f-9b77-e6568307205e",
            "created_at": "2022-10-25T16:07:23.528994Z",
            "updated_at": "2025-03-27T02:02:09.847683Z",
            "deleted_at": null,
            "main_name": "DarkHotel",
            "aliases": [
                "APT-C-06",
                "ATK 52",
                "CTG-1948",
                "Dubnium",
                "Fallout Team",
                "Higaisa",
                "Luder",
                "Operation DarkHotel",
                "Operation Daybreak",
                "Operation Inexsmar",
                "Operation PowerFall",
                "Operation The Gh0st Remains the Same",
                "SIG25",
                "Shadow Crane",
                "T-APT-02",
                "Tungsten Bridge",
                "Zigzag Hail"
            ],
            "source_name": "ETDA:DarkHotel",
            "tools": [
                "Asruex",
                "DarkHotel",
                "DmaUp3.exe",
                "GreezeBackdoor",
                "Karba",
                "Nemain",
                "Nemim",
                "Ramsay",
                "Retro",
                "Tapaoux",
                "Trojan.Win32.Karba.e",
                "Virus.Win32.Pioneer.dx",
                "igfxext.exe",
                "msieckc.exe"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1666716495,
    "ts_updated_at": 1743041741,
    "ts_creation_date": 1476888695,
    "ts_modification_date": 0,
    "files": {
        "pdf": "https://archive.orkl.eu/f4c3883bdb12af3225b3b57f2d8352cb37586312.pdf",
        "text": "https://archive.orkl.eu/f4c3883bdb12af3225b3b57f2d8352cb37586312.txt",
        "img": "https://archive.orkl.eu/f4c3883bdb12af3225b3b57f2d8352cb37586312.jpg"
    }
}