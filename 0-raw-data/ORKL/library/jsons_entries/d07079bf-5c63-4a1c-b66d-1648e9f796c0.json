{
    "id": "d07079bf-5c63-4a1c-b66d-1648e9f796c0",
    "created_at": "2022-10-25T16:48:20.235638Z",
    "updated_at": "2025-03-27T02:16:57.901585Z",
    "deleted_at": null,
    "sha1_hash": "affec05c6ef39a107621021d925a417883609b70",
    "title": "",
    "authors": "",
    "file_creation_date": "2021-04-27T10:25:26Z",
    "file_modification_date": "2021-04-27T10:25:26Z",
    "file_size": 3490559,
    "plain_text": "```\nCyberSeChronicles\n\n```\n\n-----\n\n```\nContext\n\n```\n**CyberseChronicles aims at putting the spotlight on** **emerging**\n**groups/malwares that pose a serious threat to many organizations. For**\nthis reason, we share with the cybersecurity community a thorough\n**analysis gathered by combining efforts of our specialized teams of the**\nSogeti CERT ESEC (Threat Intelligence, Incident Response/SWAT, Purple\nand the Security Operation Center), and this, as frequently as possible upon\na year. The shared content (TLP:GREEN; Limited disclosure, restricted to\nthe cybersecurity community)[1] shall be deemed as proprietary and\nprivileged information and cannot be used as admissible proof before legal\nauthorities.\n\nThis New Year’s double extorsion ransomware evolution landscape\nstarted with a peculiar specimen dubbed Babuk. The latter was put in the\nspotlight as its operators hit several corporations in a relative short range\nof time amongst which, the prominent global government outsourcer Serco\nexhibiting a revenue of over £ bn in 2019 and being behind NHS Test and\nTrace.\n\nThe Sogeti CERT ESEC Threat Intelligence (CETI) team thought that\nBabuk would be a textbook case for our first chronicle that illustrates how\nquickly inexperienced threat actors can nowadays grasp from scratch the\nmeans of conducting single, double, and even towards triple extortion\nschemes. Even more striking is how fast Babuk’ operators adopted a\nRansomware-as-a-service model by recruiting affiliates from underground\nRussian-speaking forums.\n\n1 According to ENISA “sources may use TLP:GREEN when information is useful for the awareness of all\nparticipating organizations as well as with peers within the broader community or sector. Recipients may share\nTLP:GREEN information with peers and partner organizations within their sector or community, but not via\npublicly accessible channels. Information in this category can be circulated widely within a particular community.\nTLP:GREEN information may not be released outside of the community.”\n\n\n-----\n\n```\n Executive summary\n\n```\nIn contrast with previously observed ransomware threat actors,\nBabuk’ operators advertise in English on more visible hacking forums. This\nnew ransomware also **lacks « kill-switches »** that is a common feature\nusually tailored by the top-tier ransomware ecosystem when detecting\nlanguages of the Commonwealth of Independent States (CIS) set as default.\n\nAnother peculiar trait of Babuk’ operators was a message posted on\ntheir DLS (dedicated leak site) claiming that organisations or NGOs will not\nbe attacked except those who support LGBT or Black Lives Matter (BLM).\nSuch **conservative political statements are uncommon for ransomware**\noperators but could be consistent for a hacktivist group of Muslim faith as\nsubstantiated by several elements described in our analysis from ‘social\nmedia intelligence’-oriented research.\n\nBeyond already reported operational security measures errors in the\nBabuk codebase pinpointed by researchers, to which Babuk’ operators are\nvery attentive to, we also found misconfigurations of their first version of\nDLS. From the former observation and thanks to the support of our internal\nPurple Team, we could elaborate a vaccine in a credible simulated enterprise\nenvironment that demonstrated the prevention of files encryption operated\nby recent variants of Babuk ransomware.\n\n\n-----\n\n```\nSummary\n\n```\n**Babuk ransomware .................................................................................5**\n\nHistory .................................................................................................. 6\n\nBabuk Identity Card ................................................................................ 8\n\nActivity study ....................................................................................... 10\n\nBabuk’s name origin .............................................................................. 14\n\nInvestigation on “Biba99” avatar ............................................................. 16\n\nAttacker’s motivations ........................................................................... 22\n\nBabuk’s genealogy ................................................................................ 24\n\n**Babuk Analysis ..................................................................................... 26**\n\nProtection mechanisms .......................................................................... 27\n\nOPSEC errors from Babuk’s operators ...................................................... 28\n\nBabuk’s evolution .................................................................................. 30\n\nModus operandi .................................................................................... 41\n\n**SecEng .................................................................................................. 42**\n\nScope .................................................................................................. 43\n\nPreparation phase ................................................................................. 44\n\nExecution phase.................................................................................... 45\n\nHunting phase ...................................................................................... 46\n\nShadow volumes ................................................................................... 53\n\nSource code of our vaccine ..................................................................... 54\n\nGPO deployment ................................................................................... 56\n\nLimitations ........................................................................................... 57\n\nAcknowledgements ............................................................................... 58\n\n**Appendix .............................................................................................. 59**\n\n\n-----\n\n# 1\n\n### Babuk ransomware\n\n\n# 1\n\n### Babuk\n\n\n-----\n\n```\nHistory\n\n```\n\n###### Cyber Threat Intelligence\n\n```\n  1.1\n\n```\n\nhis year started with the appearance of a new ransomware dubbed\nBabuk, discovered by a cybersecurity researcher at McAfee Labs\n(known as @Glacius_ on Twitter). This family of ransomware joined\n\n###### T\n\nalready the recent trend of double extorsion[2] conducted by the top-tier1 of the\nransomware ecosystem and falls into the scope of big-game hunting (the process\nof cybercriminals focusing on high-value data or assets within businesses). The\nresearcher @Glacius_ also shared this discovery in his Twitter thread on January\n2, 2021 (see Figure 1)[3].\n\n\n###### Figure 1 Screenshot of the first Tweet post about Babuk and Vasa\n\n\n2 The strategy of threatening to expose stolen information\n3 https://twitter.com/Glacius_/status/1345376488506462209\n\n\n-----\n\n**@Arkbird_SOLG, another cybersecurity researcher posted a preliminary**\nreverse-engineering analysis on his Twitter thread the day after[4]. This discovery\nand first analysis was then deepened and relayed the same day on the personal\nblog[5] of a Georgia Tech student named Chuong Dong,[67] (currently a reverse\nengineering intern at FireEye).\n\nA strong similarity in the encryption process, the enumeration of files and in\nstopped processes was underlined 2 days later by **@Sebdraven on his twitter**\nthread (see Figure 1 on the right)[8] as compared with the source code of publicly\navailable Babuk’ samples. The name of this new ransomware was originally \"Vasa\"\n(and not \"Babuk\") and used a different technique to get ransoms via an end-toend encrypted email service to communicate with the victim (Protonmail).\n\n\n###### Figure 2 Screenshot of @Sebraven's tweet about Babuk and Vasa\n\n\n4 https://twitter.com/arkbird_solg/status/1345569395725242373?s=21\n5 http://chuongdong.com//reverse%20engineering/2021/01/03/BabukRansomware/\n6 https://www.linkedin.com/in/chuong-dong-1012/\n7 https://twitter.com/cPeterr\n8 https://twitter.com/Sebdraven/status/1346377590525845504\n\n\n-----\n\n```\nBabuk\nIdentity Card \n\n```\n```\n 1.2\n\n```\n\n###### Cyber Threat Intelligence\n\n\n**Babuk ransomware**\n\n\n**1st public report** January 2nd 2021[9]\n\n**Name** _Babuk (Locker)_\n\n**A.k.a** _Vasa Locker,[10] Babyk_\n\n**Threat type** Doxware (ransomware & exfiltration/doxing)\n\n**Motivations** Opportunistic actor, financial motivation\n\nRussian Speaking (probability medium-high / low\n**Origin**\nprobability)[11]\n\n\n**Affiliation**\n**probability**\n\n\n**Very low**\nIt should be noted that ‘state ransomware’ is quite marginal\nin the threat landscape (e.g., Pay2Key/APT33[12],\nVHD/APT38[13])\n\n\n**Impact** **High**\n\n**Attack vector** Unknown\n\n9 https://twitter.com/Glacius_/status/1345376488506462209\n10 https://twitter.com/Sebdraven/status/1346377590525845504\n11 The cybercriminal sphere operating the ransomware/doxware ecosystem is known to be tight to CIS nations.\nWe have found one word written with Cyrillic characters \"Загрузка\" when on the homepage of the Babuk\ndedicated leak site that indicates to the visitor that the page is loading.\n12 https://www.clearskysec.com/pay2kitten/\n13 https://securelist.com/lazarus-on-the-hunt-for-big-game/97757/\n\n\n-----\n\n**Points of contact**\n\n\n**Forum(s)** Raidforums (user : biba99)\n\n\n**Doxing site**\n\n\n\n- gtmx56k4hutn3ikv[.]onion\n\n- babukq4e2p4wu4iq[.]onion\n\n- wavbeudogz6byhnardd2lkp2jafims3j7tj6k6qnywchn2cs\nngvtffqd[.]onion\n\n\n**Email** babukrip@protonmail.ch (see PGP public key in appendix)\n\n\n**Contact**\n**negociation**\n\n\n\n- Chat from the onion site\n\n- By email babukrip@protonmail.ch for the Vasa Locker\n_strain_\n\n\n**Payment** - Bitcoin via their own chat on the doxing site\n\n\n**Executable’s data of interest**\n\n\n**Type** PE32 executable 32bits, not packed\n\n\n**Extension after**\n**encryption**\n\n\n. __NIST_K571__\n.babyk\n.babuk2\n\n\n**Stopped Services**\n\n\nmemtas, mepocs, sophos, veeam, backup, GxVss, GxBlr,\nGxFWD, GxCVD, GxCIMgr, DefWatch, ccEvtMgr, ccSetMgr,\nSavRoam, RTVscan, QBFCService, QBIDPService,\nIntuit.QuickBooks.FCS, QBCFMonitorService, YooBackup, YooIT,\nzhudongfangyu, sophos, stc_raw_agent, VSNAPVSS,\nVeeamTransportSvc, VeeamDeploymentService, VeeamNFSSvc,\nveeam, PDVFSService, BackupExecVSSProvider,\nBackupExecAgentAccelerator, BackupExecAgentBrowser,\nBackupExecDiveciMediaService, BackupExecJobEngine,\nBackupExecManagementService, BackupExecRPCService,\nAcrSch2Svc, AcronisAgent, CASAD2DWebSvc, CAARCUpdateSvc\n\n\n**Stopped Processes**\n\n\nsql.exe, oracle.exe, ocssd.exe, dbsnmp.exe, synctime.exe,\nagntsvc.exe, isqlplussvc.exe, xfssvccon.exe,\nmydesktopservice.exe, ocautoupds.exe, encsvc.exe, firefox.exe,\ntbirdconfig.exe, mydesktopqos.exe, ocomm.exe, dbeng50.exe,\nsqbcoreservice.exe, excel.exe, infopath.exe, msaccess.exe,\nmspub.exe, onenote.exe, outlook.exe, powerpnt.exe, steam.exe,\nthebat.exe, thunderbird.exe, visio.exe, winword.exe,\nwordpad.exe, notepad.exe\n\n\n-----\n\n```\nActivity\nstudy\n\n```\n```\n 1.3\n\n```\n\n###### Cyber Threat Intelligence\n\n\no the best of our knowledge the first appearance of a Babuk\nransomware sample to the public goes back to 12/01/2021. The latter\nwas shared onto the Malware exchange platform known as Malware\n\n###### T\n\nBazaar from Abuse.ch (see Figure 3Erreur ! Source du renvoi introuvable.).\n\n\n###### Figure 3  Malware sample table summarizing all shared samples related to ’Babuk’ made available from Abuse.ch’s Malware Bazaar platform (screenshot taken the 02/25/2021). Overall 10 unique samples were already shared where only one is also tagged with ‘Vasa’.\n\n\n###### Figure 3  Malware sample table summarizing all shared samples related to ’Babuk’ made available from Abuse.ch’s Malware Bazaar platform (screenshot taken the 02/25/2021). Overall 10 unique samples were already shared where only one is also tagged with ‘Vasa’.\n\n\n-----\n\nThis new ransomware/doxware comes without any code source obfuscation\nmechanisms. It uses nonetheless a robust encryption scheme being (almost)\nunbreakable. More precisely, it leverages a home-made SHA256 algorithm\nChacha8 for the encryption and protects the keys with ECDH, which can use\nbetween 160 and 512 bits long keys (256 here).\n\nBabuk can take additional command line parameters upon deployment. If\nno parameters are given, it will only encrypt local drives. In contrast, the impact\nfor the victims can be increased not only by additionally encrypting network drives\n(being connected and mounted) but also by using the Windows Restart Manager\nin order to close processes that are using files (thus improving the number of files\nencrypted).\n\n\nSince its first appearance in early January, Babuk already impacted several\ndifferent sectors:\n\n    - Health\n\n    - Bank/Financial/Asset Management\n\n    - Retail sales\n\n    - Transport\n\nAs reported by McAfee, the impact concerns the following countries (see\nFigure 3 for an estimation of the global prevalence):\n\n    - Israel\n\n    - USA\n\n    - India\n\n    - Luxembourg\n\n    - Italy\n\n    - Spain\n\n    - South Africa\n\n    - United Arabic Emirates\n\n    - UK\n\n    - China\n\n    - Germany\n\n\n-----\n\n###### Figure 4  Global prevalence of Babuk. Italy and Spain are the two countries mostly impacted as of today. But the threat being still recent, this data sample cannot lead to conclusions.\n\n\nEstablishing a sectorial\nvictimology is still too early as it’s not\nimpossible that, like Maze, Babuk’s\nvictims could be discriminated not by\ntheir activity sector but by their\nfinancial size (except the sectors\nexcluded as stated on their onion site,\nsee appendix).\n\nConcerning geographic victimology, it\nseems, at the moment, that they are\nnot targeting states belonging to the\n\n\nCommunity of Independent States\n(CIS), which is a common exception\nin the ransomware ecosystem.\nIndeed, several ransomware samples\nhave been spotted with « kill-switches\n» when they detect Russian as default\nlanguage on the system they are\nrunning on.\n\n**Importantly, we found no such**\n**feature in none of the Babuk’**\n**studied ransomwares.**\n\n\n-----\n\nWe think it is of relevance to confront that information to the initial English\nspoken language chosen by Babuk’ authors to communicate on underground\nforums that is rather uncommon; though the authors show they are not English\nnative writers as one can spot at several misspellings and non-native expressions.\n\nThe range of ransom spreads from $60.000 to $85.000 and at least one\nvictim agreed to pay the highest amount according to _Bleepingcomputer.[14] This_\namount of money remains however way below the ransom average estimated by\n_Coveware from the 3[rd] quarter of 2018 to the 3[rd] quarter of 2020 (approximatively_\n235k€ average and 120k€ median value). This could be explained due to the\namateurism showed by the operators that just joined the Big-game hunting area.\n\n\nEvery Babuk ransomware sample is specifically customized for each\ntargeted victim with a dedicated ransom note and a URL link pointing to the chat\nhosted on their onion service for the payment negotiations.\n\nOf note is that _Babuk operators quicky hopped into the double extorsion_\nscheme pioneered by Maze when they began to exfiltrate their victim’s data in\n2019.[15] As far as Babuk is concerned, the operators first leaked data samples on\n_RaidForums before setting up a dedicated leak site accessible through anonymized_\nnetworks at this address gtmx56k4hutn3ikv[.]onion.\n\nIf this new ransomware group in their targeted attacks continue at such a\nfast pace (5 since the beginning of the year), Babuk could become a serious threat\njust like Egregor who recently joined the Maze cartel. We should note, though that\nalong the month of February no additional attacks attributed to this strain was\nreported to the best of our knowledge.\n\n14 https://www.bleepingcomputer.com/news/security/babuk-locker-is-the-first-new-enterprise-ransomwareof-2021/\n15 https://research.checkpoint.com/2020/ransomware-evolved-double-extortion/\n\n\n-----\n\n```\nBabuk’s\nname origin\n\n```\n```\n 1.4\n\n```\n\n###### Cyber Threat Intelligence\n\n\nur searches on the origin and meaning of\nthe ransomware’s name “Babuk” began\nwith a Google Dork. A first result led us on\n\n###### O\n\na non-indexed Etsy page we got back from Google’s\ncache.[16]. On this page, a human-like figurine named\n“Babuk” is present, with animal features around the\n“paws” and the “face” (see Figure 5).\n\nSuch a morphology could refer to a deity or a\nmythological creature. Pivoting on this lead, we found the\nWikipedia webpage of “Bobak” (written in February\n2018), a mythological deimon from the East with features\nvarying depending on the locality. From some stories,\n“Bobak” can be a humanoid figure with the possibility to\nchange itself in a cat or a dog, which could fit the figurine\nin Figure 5.\n\n16 https://www.etsy.com/de/listing/811239443/hands-down-babuk\n\n\n###### Figure 5 A cached Etsy page shows a human-like figurine named “Babuk” was found. This Figurine could represent a Slavic demon, being a probable origin of the choice for the name of the ransomware.\n\n\n-----\n\nEven if “Bobak” and “Babuk” are not identical, the two occurrences are close,\nwhich is a common thing to find for mythological creatures under different names\nand variations, changing with the traditions, the stories and geographical areas.\nThe article’s author, who is bilingual in English and Polish, perhaps chose a name\nthat was more common in his area.\n\nWe then took a look at one of the source book referenced by the author\nPodgórscy, Barbara i Adam (2005).[17] Looking for “Bobak” and “Babuk”, we quickly\nfound an equivalence between the two names, see Figure 6.\n\n\n###### Figure 6  Google Books results for \"Babuk\" search\n\n\nA link is thus clearly established between “Bobak” and “Babuk”. This name,\nbeing the name of a Slavic demon, could be the origin of the ransomware’s name.\nMoreover, it is not without remembering the choice of the name “ReVil”, meaning\n“evil ransomware”,[18] or the malware “Valak”, a demon name as well.\n\nOf note is that Babuk changed its brand recently into Babyk as such that\nthe U was replaced by the Y letter). Mcafee reported that “in Russian, the Cyrillic\nletter Y sounds similar to the Latin letter U”. As highlighted by Mcafee, the authors\nwere then seen advertising their ‘product’ on Russian-speaking forums seeking for\naffiliates (posted the 8[th] of January).[19]\n\n17 _Wielka księga demonów polskich: leksykon i antologia demonologii ludowej.”, pages 53-54”_\n18 https://www.csoonline.com/article/3597298/revil-ransomware-explained-a-widespread-extortionoperation.html\n19 https://www.mcafee.com/enterprise/en-us/assets/reports/rp-babuk-ransomware.pdf\n\n\n-----\n\n```\nInvestigation\non “Biba99”\navatar\n\n```\n```\n 1.5\n\n```\n\n###### Cyber Threat Intelligence\n\n\neeking to establish the\nidentity and evaluating\nthe digital fingerprint of\n\n###### S\n\nthe attacker, we performed avatar\ninvestigations by pivoting on ‘biba99’\nusername (found on Raidforums as\naforementioned).\n\nA SOCMINT-oriented research\nfor the presence of this avatar\nprovided numerous results, which\nmakes the discrimination of the\nresults quite complex. Nevertheless,\nthe unique occurrence across\ntelegram channels of the avatar\n\"Biba99\" [20] drawn our attention.\n\nThe person behind this avatar\nhas a channel with a profile picture\n\n20 https://t.me/biba99\n\n\nand one could conjecture that it\nrepresents him or her. Considering\nthe following elements, we consider\nthat \"Biba99\" is male. Besides, no\nmetadata could be exploited as it is\noften the case for telegram channels.\n\nWe found that this person\njoined two groups where the main\nlanguage used is Turkish. One of the\ntwo channels, called “QALB\nGAVXARI”, is surrounded by two\nemoticons representing the building\nat the centre of Islam's most\nimportant mosque, the Masjid alHaram in Mecca, Saudi Arabia. This\ninformation could indicate that this\nperson could follow and practice Islam\nreligion.\n\n\n-----\n\n###### Figure 7 Presentation of the \"Biba99\"\n Telegram channel. The\n inscription in Cyrillic \"Бейбарыс Султан\" means\n \"Sultan Beybarys\"\n\n\n###### Figure 8 Profile picture of the \"Biba99\"\n Telegram channel\n\n\nThe inscription in Cyrillic \"Бейбарыс Султан\" means \"Sultan Beybarys\". The\nlatter refer to the Mamluk Sultan Al-Malik az-Zâhir Rukn ad-Dîn Baybars alBunduqdari known as Baybars who ruled over Egypt and Syria from 1260 to 1277.\n\nThe Mamluk Sultan is a descendant of the Turkic peoples and distinguished\nhimself by inflicting several major military defeats on King Louis IX of France\nduring the Seventh Crusade as well as on the Mongol Empire. As such, he is\nregularly taken up in the Turkish-speaking diaspora in the unified narrative of the\nTurkish people as a vehicle for mobilizing them around the \"memory\" of a\nsparkling, conquering and victorious Turkey.\n\n\n-----\n\nA search for avatars and individuals linked to \"Бейбарыс Султан\" was\nconducted to seek further elements beyond its picture on the identity of this\nindividual potential tight to Babuk. We found numerous avatars on social networks\nusing \"Бейбарыс Султан\" as their usernames, the vast majority of which being\nKazakh. This confirms the large popularity of this reference in Kazakh popular\nculture. Several occurrences refer to Kazakh individuals. One particular Instagram\naccount (@beibarys__sultan[21]) drew our attention.\n\n\n###### Figure 9 Homepage of @beibarys_sultan Instagram account\n\n\nThe individual appears several times in both police and military uniforms[22],\ndenoting a flagrant lack of awareness of the operational security measures\n(OPSEC) incumbent on the law enforcement on social networks (all the more since\nhis account is public).\n\n\n###### Figure 10 Picture shared on @beibarys_sultan's Instagram account showing the target in military uniform\n\n\n21 https://www.instagram.com/beibarys__sultan/\n22 https://www.instagram.com/p/BsAm85mHN4J/\n\n\n-----\n\nThe individual claims to be a member of the Military Police of Kazakhstan,\nwhich is highly probable given the similarity of the uniforms and insignia to open\nsource images[23] [24].\n\n###### Figure 11  (L) @beibarys_sultan in uniform (R) PMK delegation in OSCE\n\nThe Military Police of Kazakhstan (PMK) is a branch of the armed forces\nunder the hierarchical authority of the Ministry of Defense whose role is to exercise\npolice power within the armed forces. It oversees investigation cases involving\nmilitary personnel, but also the protection of sensitive sites, including information\nsystems, which may be of national security interest.\n\n23 https://www.osce.org/programme-office-in-astana/353931\n24 https://www.instagram.com/p/B7KfaYxnH4s/\n\n\n-----\n\nConcerning the resemblance between the avatar @beibarys_sultan and biba99 (as\nvisible below[25]), we qualify it as to be average.\n\n\n###### ?\n\n\n###### Figure 12 (L) Profile picture of @biba99 (R) Picture published on the @beibarys_sultan account\n\n\nThe points of similarity determined by the analyst are as follows:\n\n   - The density of the eyebrows and their outward gradation\n\n   - The shape of the hairstyle\n\n   - The size of the eyes (despite of the crease on the first photo, their\ndimensions seem coherent)\n\n    - The shape of the jaw, relatively square and hollowed out below the lip line.\n\n**NB:** _We have tried to take pictures taken or published during the same period_\n_(i.e., during the year 2018)._\n\n25 https://instagram.com/p/BXesE29FJRJ\n\n\n-----\n\n```\nTo conclude\n\n```\n\n**We would like to remind you that attribution attempts made by**\n**security companies must be taken with caution. Analysts must deal with**\n**a significant degree of uncertainty in each case. The hypotheses we**\n**formulate must be treated and understood as is and are not intended to**\n**incriminate one or more individuals.**\n\n**Finally, we remind you that all the information in this section has**\n**been obtained from open sources without any offensive or intrusive**\n**actions.**\n\n\nThere is too little relevant open-source information about the digital identity\nof Babuk's developer being available to go further in the attribution (at this stage\nand to the best of our knowledge). Though we assessed with a low to medium\nprobability the link between **@beibarys_sultan and** **biba99, too many**\ninconsistencies and differences between the two avatars remain to affirm that they\nare one and the same person.\n\nIn the same vein, there is no strong evidence that ‘biba99’ that claimed on\n_Raidforums being operating the ransomware Babuk that it is the same person that_\nowns the Telegram account @biba99\n\nFurther analysis of the avatar ecosystem identified upon our research such\nas analysing status or message updates may allow us to refine the current cluster\nof clues.\n\n\n-----\n\n```\nAttacker’s\nmotivations\n\n```\n```\n 1.6\n\n```\n\n###### Cyber Threat Intelligence\n\n\ns previously said, Babuk has\na low profile in the eCrime\nlandscape and its sectorial\n\n###### A\n\nvictimology is so far indiscriminate. In\ncontrast, its geographical victimology\nshows (at the moment of writing and\nconsidering the low number of\nvictims) that the attacker seems to\nspare the Federation of Russia and its\nforeign allies.\n\nA message posted on Babuk’s\ndoxing website claims that its creators\nwill not attack organisations or NGOs\nexcept those who support LGBT or\nBlack Lives Matter (BLM). It is a\ncommon practice for ransomware\noperators to express their motives on\ntheir leaking site, but it is less\ncommon to see such political\nstatements, which substantiates the\nlink aforementioned that @biba99 on\n\n\nTelegram this person could follow and\npractice Islam religion.\n\nFor the CERT Sogeti ESEC,\nBabuk’s developers are Russian\nspeaking and located in a Central Asia\ncountry, with a medium probability for\nKazakhstan. This region, even if\nmulticultural and heterogenous, is not\nthe most favourable in support of\nsexual and ethnical minorities.\nHowever, Kazakhstan is quite\nprogressive on this aspect relatively\nto its Russian neighbour. Even if\nhomosexuals don’t have the same\nfreedom as in the Western Europe,\nKazakhstan does not condemn\nrelations between persons of the\nsame sex, recognizes the concept of\ngender identity and refused in a\njudgment of the Constitutional Court\nin 2015 the penalisation of\nhomosexual « propaganda ».\n\n\n-----\n\nThus, if the hypothesis that\n**@beibarys_sultan is one of Babuk’s**\ndevelopers would appear to be true, it\nwouldn’t be contradictory with the\nmessage posted on their leaking site.\n**@beibarys_sultan evolving in a**\nmilitary institution (where\nhomosexual recruits are forbidden), it\nwould be in a social group[26] where a\nvirilism habitus is promoted and\nhomosexuality is taboo. These values,\nwhich are in fact internalized\nrepresentations by members of social\ngroups linked to the armed forces,\ntend to develop in individuals a\nmistrust, mockery and even hostility\ntowards civil society organizations\naccused of \"misrepresenting\" these\n\n26 It should be remembered that military culture is\nnot a homogenous whole; it moves according to\nsocio-cultural spaces but retains a base, a common\ncorpus based on a certain marked exaltation of\nmasculinity.\n\n\nideals and values in the same way\nthat defenders of homosexual rights\ncan be.\n\nConcerning the Black Lives\nMatter reference, this movement[27] is\nat the centre of a lot of criticism since\nits appearance in the public space. It\ngets criticized by different political\ngroups ranging from the left\nuniversalist anti-racism current to the\nalt-right. Even if it’s always complex\nnot to be ethnocentric, it seems\nBabuk’s developers might fall into the\nformer latter category since antiracism and LGBT civil rights are\nsensitive subjects for people with\nconservative mindsets.\n\n\nsensitive subjects for people with\n\ntowards civil society organizations\n\nconservative mindsets.\n\naccused of \"misrepresenting\" these\n\nIt should be remembered that military culture is 27 Again, it should be kept in mind that the BLM\n\nmovement is not uniform, has diverse demands\nand does not carry the same level of membership\ndepending on whether one is a supporter (or ally)\nor an activist.\n\n\n-----\n\n```\nBabuk’s\ngenealogy\n\n```\n```\n 1.7\n\n```\n\n###### Cyber Threat Intelligence\n\n\no the best of our knowledge\nand at the time of writing,\nthere is no clear link with any\n\n###### T\n\nother known threat actor. It is also far\nfrom being clear whether or not\nBabuk ransomware originates from a\nvariant of a known ransomware\nfamily, would have been built from\nscratch or was patchworked by\ncherry-picking within the top-tier\nbullet-proofed ransomwares. We\nthink the latter hypothesis is the most\nprobable.\n\nFor instance, we could first\nnotice that Babuk ransomware\npossess a feature recently used by\nseveral other ransomwares that is\nreferred to as “Restart Manager”. This\n\n28\n\nhttps://www.trendmicro.com/en_us/research/21/\nb/new-in-ransomware.html\n\n\ncomponent of Windows being present\nby design as an API can be leveraged\nto stop either databases and/or\napplications (also known as the\n‘service stop’ technique [[T1489]](https://attack.mitre.org/techniques/T1489/) in the\nCommon Knowledge framework\nMITRE).\n\nThis technique T1489 aims at\nquickly close processes that allows a\nransomware to encrypt a larger\nnumber of files and/or database to\nincrease its impact on a victim. This\ntechnique was already adopted by\nseveral top-tier ransomwares such as\nMaze/Egregor, Conti, REvil, Ruyk,\nNetwalker or even Ragnar Locker (this\nobservation was also reported by\nTrend micro[28]).\n\n\n-----\n\nBabuk also uses the same\nencryption algorithm that\nMaze/Egregor used (chacha), which\ncould have indicated a proximity\nbetween groups [[T1486]. However,](https://attack.mitre.org/techniques/T1486/)\nthe low technicality of Babuk\nransomware on some parts of the\ncode (such as the thread\nmanagement) seems to tip the\nhypothesis towards a new group, still\nin its early stages listening carefully to\nthe feedback from security\nresearchers in order to improve.\n\nA similarity in the ransom note\nbetween Darkside and Babuk was\npinpointed by Trendmicro.[29] In\naddition, Carbon SPIDER introduced a\nvariant of Darkside at the end of\nNovember 2020 that turns out to be\n‘Linux compatible’ seeking to damage\nvirtual machines on servers having\nspecific extensions;[30] Babuk also\nclaimed recently to embed such\n\n29\n\nhttps://www.trendmicro.com/en_us/research/21/\nb/new-in-ransomware.html\n30 https://socprime.com/blog/affiliates-vs-huntersfighting-the-darkside/\n\n\nfeature on Russian-speaking forums.\nBeyond Darkside, other ransomware\nstrains have also begun to target ESXi\nhypervisors such as RansomEXX.\n\nIt is interesting to note that\nCrowdStrike stated that Darkside\nbecame independent with its own\nRaaS model and DLS probably “to\navoid sharing profits from BGH\ncampaigns with PINCHY SPIDER, the\nREvil vendor”.[31]\n\nIn the same vein, Babuk\nauthors could be previous affiliates of\nDarkside (from which a decryptor was\npublished since the beginning of this\nyear[32]) that seeks to become\nindependent. Though, previous\ninformation and chronology on the life\ncycle of Darkside and Babuk, such\nconjecture remains rather speculative\nat the time of writing.\n\n31 https://www.crowdstrike.com/blog/carbonspider-sprite-spider-target-esxi-servers-withransomware/?utm_campaign=blog&utm_medium\n=soc&utm_source=twtr&utm_content=sprout\n32 https://labs.bitdefender.com/2021/01/darksideransomware-decryption-tool/\n\n\nNovember 2020 that turns out to be\n‘Linux compatible’ seeking to damage\nvirtual machines on servers having\nspecific extensions;[30] Babuk also\nclaimed recently to embed such\n\n\n-----\n\n# 2\n\n### Babuk Analysis\n\n\n# 2\n\n### Babuk Analysis\n\n\n-----\n\n```\nProtection\nmechanisms\n\n```\n```\n 2.1\n\n```\n\n###### Cyber Threat Intelligence\n\n\no protection or\nobfuscation techniques\nwere observed upon\n\n###### N\n\nreverse engineering analysis in the\ncodebase of Babuk. This could\ntranslate either intoa strategical\nchoice in order to learn from recent\ntechniques coming from researchers\npointing out errors or defects and/or\na lack of technical maturity to\nobfuscate their code (i.e., consistent\nfor ex skilled pentesting affiliates\ntrying to become independent while\nbeing deprived of ransomware coding\nskills). This hypothesis is based on the\nfollowing screenshot where the\n\n###### Figure 13\n\n\nBabuk’ operator expresses gratitude\nto the student Chuong Dong, on\nRaidForums and more recently on\ntheir blog. However, they might also\nrely on affiliates to obfuscate their\ncode because one strain has been\nspotted packed with custom code\nlooking several steps beyond their\ncoding skills comparing to their\nmultiple OPSEC errors.\n\nAnother possibility could be\nthat the operator's personal\nimperative to promptly gain ransoms\nthat could explain the lack of\nobfuscation upon the first attacks.\n\n\n###### Screenshot of a RaidForums’ post from one of Babuk’s operator(s) to the student who published an analysis showing some mistakes in their code.\n\n\n-----\n\n```\nOPSEC errors\nfrom Babuk’s\noperators\n\n```\n```\n 2.2\n\n```\n\n###### Cyber Threat Intelligence\n\n\ne noticed several OPSEC (Operations Security) errors. We first\nconfirmed those cited in Chuong Dong analysis[33] about thread\nmanagement and encryption errors. We then discovered several\n\n###### W\n\nmisconfigurations of their onion dedicated leak website.\n\nOne of them was related to a misconfiguration of the Apache web server\nexposing its information on the “server-status” page (see Figure 14). The latter is\nusually leveraged by an admin to monitor CPU load for each request by displaying\nthe latest requests processed by the server as well as the IP address of the clients\n(hereby this information is not available as the server is running on TOR).\n\nAs such, we decided to monitor during a few days the activity on this page\nto gain information about Babuk’s operators.\n\n\n###### Figure 14  \"server-status\" page where requests received by the server are displayed\n\n\n33 http://chuongdong.com/reverse%20engineering/2021/01/16/BabukRansomware-v3/\n\n\n-----\n\nThanks to the monitored requests, we\nwere able to spot at two pages hosted on\nthe same web server that drawn our\nattention. The first one is a login form,\nthat probably provides an access to an\nadmin dashboard. This portal is thus\nexposed to bruteforce attacks and to a\ndeep surveillance by CTI teams.\n\n\n###### Figure 15 login.php page\n\n\nThe other item discovered on the server is the presence of a PHPMyAdmin\nlogin form. The installed version is 4.6.6, which is not vulnerable at the time of\nwriting. As seen in the requests from the “server-status” page, the database\nbehind PHPMyAdmin seems to handle the blog posts as GET requests were\ncontaining parameters like « db=blog » and « table=articles ». It should be\nnoted that the access to the PHPMyAdmin is made via randomly generated URLs,\nwhich means Babuk’s operator are conscious that exposing this service is critical\nfor their business. However, the misconfiguration we spotted of their Apache\nserver unveiled such URL when they accessed it allowing us to reach the\nPhpmyadmin landpage (see Figure 16).\n\n\n###### Figure 16 PHPMyAdmin service exposed\n on Babuk’s doxing site\n\n\n-----\n\n```\nBabuk’s\nevolution\n\n```\n```\n 2.3\n\n```\n\n###### Cyber Threat Intelligence\n\n\nn analysis of Babuk\nransomware was made\npublic by IT student\n\n###### A\n\nChuong Dong early January. The code\nanalysis was made easier because of\nthe lack of any obfuscation and\npacking.\n\nOne specific point mentioned\nby the researcher draw our attention\nregarding the creation of a file called\n**« ecdh_pub_k.bin »** in the **«**\n**AppData »** folder of an infected\nsystem. This file is a local private key\nused to generate a shared secret that\nwill in turn be used to encrypt the\nfiles. But we noticed via reverse\nengineering analysis that the creation\nof this file is needed for the encrypting\nprocedure to start.\n\n\nThis first element as well as the\npotential rise in power of this\nransomware which could be very\nimpactful pushed us to develop and\ntest a vaccine based on the creation\nof this private key but also of mutexes\nto protect against the encryption of\ndocuments by the already observed\nvariants of the Babuk ransomware.\n\nWe now detail the two types of\nstrains we have analysed and the\nrespective vaccines we could produce\nwith two types of combination, for\nwhich we are providing proof of\nconcept.\n\n\n-----\n\n```\nBabuk v1\n\n```\nWe were able to confirm some of Chuong Dong’s findings in its\nanalysis[34]. The encryption process begins by generating a random seed for\neach host, thus generating a unique key for each infection. The randomized\nkey is achieved via the CryptGenRandom function.\n\n###### Figure 17 Call to CryptGenRandom to get a random seed per host\n\nRight before the call to CryptGenRandom(), a condition is checked that may\nredirect to another code branch calling SystemFunction036() instead. It is an old\nreference to RtlGenRandom() available for XP systems that may disappear in the\nfuture. It is only available through indirect call using _LoadLibrary()_ and\n_GetProcAddress(). The use of this function might just be for compatibility issues_\non old systems.\n\nhttp://chuongdong.com/reverse%20engineering/2021/01/16/BabukRansomware-v3/\n\n\n-----\n\n###### Figure 18 Call to SystemFunction036() to\n generate the seed even on old\n systems\n\n\nThe encryption procedure then uses several seeds that are modified at each\niteration of the encryption but remains the same for every file on the machine.\n\n\n###### Figure 19  Example of used seeds in the first versions of Babuk\n\n\nAnother call to sub_403090() adds some non-linearity to the algorithm.\n\n###### Figure 20 Non-linearity added by shifting and modifying the seeds during the encryption\n\n\n-----\n\nFrom what we observe from the encryption algorithm codebase, we conjecture\nthat the latter was built from scratch, which can induce severe errors as\ncryptography is a delicate subject. Even if it is an interesting approach to evade\nAVs and other detection mechanisms, there is the eventuality that an error in the\nencryption algorithm might induce a weakness allowing the development of a\ndecryption tool by defenders. But this hypothesis deserves a proper cryptographic\nexamination by an expert.\n\nWe also observed that the creation of the \"ecdh_pub_k.bin\" file impacts\nthe launching of the encryption processes (see screenshot of the source code\nbelow).\n\n\n###### Figure 21\n If the file\n can’t be accessed, execution is\n stopped.\n\n\nIf opening the file fails, then the condition leads directly to **deletion of**\n**[restore points and Shadow Copy [T1490]. The next function called at the very](https://attack.mitre.org/techniques/T1490/)**\nend of the code triggers the 'ExitProcess(0) ;' function, causing the process to stop\nwithout starting the threads involved in the encryption process.\n\nLuckily, the creation of the file takes place via the CreateFile function of the\nWindows API, with a parameter specifying that if the file exists the function should\nreturn an error. The prior creation of a file with the name \"ecdh_pub_k.bin\" in the\nAppData folder when launching the executable would therefore prevent data\nencryption.\n\n\n-----\n\n```\n !\n   Key point\nThis is the first part of\nthe vaccine against Babuk\n\n###### Figure 22 Conditional statement checking the existence of a mutex called \"babuk_v3\"\n\n```\n\n-----\n\n```\nBabuk v2/3\n\n```\n\nVariants of Babuk samples\nappeared with the peculiarity of\nconditioning the launching of\nencryption threads to the presence of\na mutex whose name was\npredictable: \"babuk_vX\" X being the\nversion number of Babuk.\n\nVersions 2 and 3 have been\nuploaded to abuse.ch. One of the\ndifferences between the versions is\nthat those using the mutex does not\nremove shadow volumes when they\nare stopped by the vaccine (see\nshadow volumes section).\n\nOther improvements are to be\nnoticed between these versions. It\nseems that the creators of Babuk are\nattentive to the analysis and OPSEC\nerrors that are being published by\nresearchers about their ransomware.\n```\nBabuk v4\n\n```\nAnother version uploaded on\nthe January 25[th], 2021 into the\nmalware bazaar platform now uses\nanother mutex labelled\n\"DoYouWantToHaveSexWithCoun\n**gDong\".**\n\n\nThe first version of Babuk\nransomware had some weaknesses,\nnotably in the implementation of file\nencryption concurrency[35]. A single\nthread had to encrypt an entire disk,\nwith Babuk creating as many as there\nwere disks to be encrypted. An\neffective competitive system should\ncreate one thread per processor and\nimplement a task management\nsystem.\n\nThis improvement was partly\nimplemented in subsequent versions\nof Babuk. However, some of the\nconcurrent threads were set equal to\ntwice the number of processors, which\nis still not optimized as threads will\nconflict in each processor to execute\ntheir instructions.\n\nIt is therefore to be expected\nthat the vaccine will no longer work\nfor the next strains of Babuk if the\ndevelopers of Babuk change the\nmutex in an unpredictable way. It is\nalso interesting to see to what extent\nthey 'play' the student who published\nthe first analyses on Babuk.\n\n\n35 _http://chuongdong.com/reverse%20engineering/2021/01/16/BabukRansomware-v3/#Multithreading_\n\n\n-----\n\n```\n Babuk v5\n Simple log management\n\n```\nThe strain used in the attack against Serco[36] was uploaded on January 28[th].[37]\nThe ransom note was once again tailored to target this enterprise.\n\n###### Figure 23  Ransom note addressed to Serco. One finds there the extraits evoked in the article of sky.com\n\nA new feature has also been added by the Babuk's developers. The\nransomware can now be launched with a parameter in its command line telling it\na file to write its error messages to. There are 8 types of errors that are logged in\nthis version:\n\n     - Process opening error\n\n     - Windows Restart Manager (WRM) initialization error\n\n     - Resource registration error in WRM\n\n     - Error in obtaining process list using a registered resource\n\n     - Error opening file\n\n     - Error in moving file\n\n     - Errors getting the next file in the folder\n\n36 https://news.sky.com/story/covid-19-nhs-test-and-trace-unaffected-by-cyber-attack-at-serco-firm-says12204747\n37\n\nhttps://bazaar.abuse.ch/sample/58ccba4fb2b3ed8b5f92adddd6ee331a6afdedfc755145e0432a7cb324c28053/\n\n\n-----\n\n###### Figure 24  Examples of errors being logged\n\n\nThe parameter allowing to trigger this behaviour is \" -debug=[file] \"\nindicating a filename in which to collect errors.\n\n###### Figure 25: Creation of the file if the \"debug\" parameter is present\n\nWith this improvement came a slight change in the way Babuk handles command\nline arguments. Here is the list of parameters managed by the last strains:\n\n    - lan=[before,after]\n\n    - debug=[filename]\n\n    - shares=[share1,share2,…]\n\n    - paths=[path1,path2,…]\n\nThe « lan » flag is here to tell Babuk to start network share encryption before or\nafter local disks. « shares » is used to give Babuk a list of network shares to try to\nconnect to and encrypt as well. The « paths » param can tell to Babuk to encrypt\nspecific local path on disk.\n\n\n-----\n\n```\nBabuk Packed\n\n```\nAs revealed the 8[th] of February 2021 by @Sebdraven, a new strain of Babuk\nwith a noticeable feature was uploaded on VirusTotal the 11[th] of February.[38] This\nnew version of Babuk now comes packed with a custom hand-made technique\nwhich holds some similarities with GandCrab technics.[39]\n\nAs the underlaying binary remains the same as the previous version, the\nBabuk’ author motivation is probably twofold:\n\ni/ to make it difficult for security researchers to analyse their samples.\n\nii/ packer-based malwares are modified in the runtime memory and create new\nsignatures for the same malware on the fly, simply by changing the\nencryption/packing method, which makes such feature more attractive to recruit\nnew affiliates.\n\nAs an objective, we tried to unravel how the malware leverages hidden\nmemory processes. We first observed that the unpacking routine uses several antiforensics analysis techniques such as importing DLLs by assessing the Process\nEnvironment Block (PEB).\n\n\n###### Figure 26 Accessing Process Environment Block (PEB) at fs[0x30] and then the PEB_LDR_DATA which holds a double linked list of the loaded DLL\n\n\nThe function sub_42DF00() allocates some memory using GlobalAlloc(), and then\ncopies a binary blob containing the encrypted payload :\n\n38\n\nhttps://www.virustotal.com/gui/file/bc4066c3b8d2bb4af593ced9905d1c9c78fff5b10ab8dbed7f45da913fb2d7\n48/details\n39 https://sebdraven.medium.com/babuk-is-distributed-packed-78e2f5dd2e62\n\n\n-----\n\n###### Figure 27 GlobalAlloc() call to copy\n the packed code into\n memory\n\nBabuk does this 2 times before executing the final code. The whole process\nconsists of several chained XOR operations:\n\n###### Figure 28 Unpacking procedure using XOR\n\n\n-----\n\nOnce it unpacks itself into memory, we can\nrecognize strings already observed in previous strains\n\n(see Figure 30Figure 30).\n\nNot only the same predictable mutex\n“DoYouWantToHaveSexWithCoungDong” is\nvisible, but also the same ransom note.\n\nThe complexity of the code related to the\nunpacking of the executable in memory does not\nseem to be compatible with the technical level of\nBabuk’s developer observed a few weeks ago\nwhile keeping a predictable mutex creation\nmechanism.\n\n**More probable is the building of a**\n**partnership with another threat actor or**\n**they simply accessed the packer as a paid**\n**service.**\n\n###### Figure 29 Part of the ransom note\n\n\n###### Figure 30  Pushing DLL names to the stack as hexadecimal values so they don’t appear as strings\n\n\n###### Figure 30 \n\n\n###### Figure 31 Mutex name taunting Chuong Dong. They did not change it for\n an unpredictable one, thus keeping our vaccine effective\n against this strain.\n\n\n-----\n\n```\nModus\noperandi\n\n```\n```\n 2.4\n\n```\n\n###### Cyber Threat Intelligence\n\n\n\n- The modus operandi observed during the attacks involving Babuk seems\ncompatible with an opportunistic actor motivated by a profit motive\n\n- Its operators adopted the same double extorsion method as other top-tier\nransomware families with a dedicated leak site\n\n- Several source code errors previously noted suggest that this ransomware may\nhave been developed hastily. The same is true for the doxing site, which\ncontains several configuration errors. We can state with a high degree of\nreliability that the Babuk operator is not driven by a nation state\n\n- The techniques, tactics and procedures (TTPs) are classic and have not shown\nthe use of particularly sophisticated attack techniques. Exception made\nconcerning the initial infection vector that remains (to our knowledge) unknown\n\n- The C++ coded ransom is based on public libraries and its specific code is very\nshort in length\n\n- The ideology displayed as anti-capitalist backed by a conservative societal\nideology (anti-LGBT) is compatible with a hacktivist group of Muslim faith\nechoing the mention of 'sultan'\n\n\n-----\n\n# 3\n\n## SecEng\n\n\n# 3\n\n\n-----\n\n```\nScope\n\n```\n```\n 3.1\n\n```\n\n###### Security Operation Center\n\n\ne will use our purple laboratory to run Babuk with the aim to create\ndetection rules tailored for this threat.\n\n###### W\n\nYour laboratory for this topic is virtualized and composed of:\n\n    - Windows Server 2016 (Version 1607)\n\n    - Windows 10 (Version 1909)\n\n    - ELK SIEM v7.10.2\n\n    - Squid 4.14\n\nThe Windows Server is the Domain controller.\n\nThe Windows 10 is attached to the domain and is freshly installed with default\nlogging policy and Sysmon with the default configuration. There is no security\nsoftware.\n\nAll logs are sent by the Winlogbeat agent with the default configuration.\n\nWe used the version 5 of the sample (See chapter above)\n\n\nWindows Server 2016\n\n\nWindows 10\n\n\n-----\n\n```\nPreparation\nphase\n\n```\n```\n 3.2\n\n```\n\n###### Security Operation Center\n\n\n, once running, stops a lot of services in charge of the backup. As\nsuch, we decided to create fake services.\n\n###### BThe two services created were named “veeam” and YooBackup” (see\n\n**Figure 32 below)**\n\nThe two services are correctly started and running:\n\n###### Figure 32  \"Veeam\" and \"YooBackup\" fake services up and running\n\n\n-----\n\n```\nExecution\nphase\nUser Execution\nMalicious File (T1204.002)\n\n```\n```\n 3.3\n\n```\n\n###### Security Operation Center\n\n\nT this moment, we simulate a scenario in which an analyst does not\nknow how the sample was delivered on the endpoint and if there is\nany check done before the execution. For this reason, we decide to\n\n###### A\n\nstart without any parameters.\n\n###### Figure 33 Execution of Babuk v5\n\n\n-----\n\n```\nHunting\nphase\n\n```\n```\n 3.4\n\n```\n\n###### Security Operation Center\n\n```\nShadow copy – Inhibit\nSystem Recovery (T1490)\n\n```\nabuk starts by launching two commands as displayed in the\ncommand line in order to delete the shadows volumes (so far what\nwe witness is an expected behavior).\n\n#### B\n\nThis operation is performed twice in less than 5 minutes.\n\n###### Figure 34  Shadow copy deletion by Babuk\n\n\n-----\n\nThe Sigma rule “Shadow Copies Deletion Using Operating Systems Utilities »\nshould detect this behavior (T1490)[40].\n\n###### Figure 35  Sigma rule “Shadow Copies Deletion Using Operating Systems Utilities »\n\nBe aware that this rule can also trigger false positives due to the nature of\nthe command (often used by IT technicians). To fine tune the Sigma detection rule\none should set a threshold of 5 minutes between two executions, in order to limit\nthe number of triggers.\n\n40\n\nhttps://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/win_shadow_copies_deleti\non.yml\n\n\n-----\n\n```\nService/Process stopped –\nService Stop (T1489)\n\n```\nAs expected, Babuk is shutting down specific services and processes related\nto backup purposes. One can see below that the two fakes services previously\ncreated were affected by this behavior.\n\n###### Figure 36 Services stopped by Babuk\n\nWe have created a specific Sigma rule for all services closed by Babuk. Bear\nin mind however that this rule will raise a lot of false positive in case of any reboot\nof an endpoint or server.\n```\ntitle: Babuk service stopped\n\n```\n```\nid: 015c11a6-7362-4497-85c8-558f4fae0185\n\n```\n```\nstatus: experimental\n\n```\n```\ndescription: Detects command-line argument to control how the ransomware should encrypt network shares.\nreferences:\n  - Internal research\ndate: 2021/03/08\ntags:\n  - attack.impact\n  - attack.t1489\n\n```\n\n-----\n\n```\nlogsource:\n  service: sysmon\n  product: windows\n        detection:\n          selection:\n            EventID: 5\n            timeframe: 60s\n            EventAction|contains: 'terminated'\n            Image|contains:\n              - vss\n              - sql\n              - svc$\n              - memtas\n              - mepocs\n              - sophos\n              - veeam\n              - backup\n              - GxVss\n              - GxBlr\n              - GxFWD\n              - GxCVD\n              - GxCIMgr\n              - DefWatch\n              - ccEvtMgr\n              - ccSetMgr\n              - SavRoam\n              - RTVscan\n              - QBFCService\n              - QBIDPService\n              - Intuit.QuickBooks.FCS\n              - QBCFMonitorService\n              - YooBackup\n              - YooIT\n              - zhudongfangyu\n              - sophos\n              - stc_raw_agent\n              - VSNAPVSS\n              - VeeamTransportSvc\n              - VeeamDeploymentService\n              - VeeamNFSSvc\n              - veeam\n              - PDVFSService\n              - BackupExecVSSProvider\n              - BackupExecAgentAccelerator\n              - BackupExecAgentBrowser\n              - BackupExecDiveciMediaService\n              - BackupExecJobEngine\n              - BackupExecManagementService\n              - BackupExecRPCService\n              - AcrSch2Svc\n              - AcronisAgent\n              - CASAD2DWebSvc\n              - CAARCUpdateSvc\n          condition: selection\n        falsepositives:\n          - Reboot\n            level: high\n\n```\n\n-----\n\n```\nFile creation\n\n```\nBabuk also creates the file “How To Restore Your Files.txt” and place it in every\nfolder.\n\nBelow an example of the 553 files created with the same name.\n\nThe file contains the instructions to pay the ransom.\n\n\n-----\n\nAnother file « ecdh_pub_k.bin” is also created in the folder AppData. This\nfile is a local private key used to generate a shared secret that will be used to\nencrypt the files.\n\n```\ntitle: Babuk files\n\n```\n```\nid: f7b573cb-5635-49d4-ae13-5b8a0beeda8f\n\n```\n```\nstatus: experimental\n\n```\n```\ndescription: Detects the ransom instructions file or the private key used by\nbabuk or the renamed files.\n\n```\n```\nreferences:\n\n```\n```\n  - Internal research\n\n```\n```\ndate: 2021/02/02\n\n```\n```\nlogsource:\n  category: file_event\n  product: windows\ndetection:\n  selection:\n    TargetFilename|contains:\n      - '\\How To Restore Your Files.txt'\n      - '.babyk'\n      - '.babuk2'\n      - '. __NIST_K571__'\n      - '\\AppData\\ecdh_pub_k.bin'\n  condition: selection\nfalsepositives:\n  - No\n\n```\n```\n             level: high\n\n```\n\n-----\n\n```\nFile modification\n\n```\nAll personal files are renamed with the extension “.babyk”.\n\n```\ntitle: Babuk files\n\n```\n```\nid: f7b573cb-5635-49d4-ae13-5b8a0beeda8f\n\n```\n```\nstatus: experimental\n\n```\n```\ndescription: Detects the ransom instructions file or the private key used by\nbabuk or the renamed files.\nreferences:\n  - Internal research\n\n```\n```\ndate: 2021/02/02\n\n```\n```\nlogsource:\n  category: file_event\n  product: windows\ndetection:\n  selection:\n    TargetFilename|contains:\n      - '\\How To Restore Your Files.txt'\n      - '.babyk'\n      - '.babuk2'\n      - '. __NIST_K571__'\n      - '\\AppData\\ecdh_pub_k.bin'\n  condition: selection\nfalsepositives:\n  - No\n   level: high\n\n```\n\n-----\n\n```\nShadow\nvolumes\n\n```\n```\n 3.5\n\n```\n\n###### Security Operation Center\n\n\nn open-source vaccine was recently developed by Florian Roth[41] (CTO\nof Nextron) and made available on GitHub. Named “Raccine”, this tool\ncan detect and stop any Windows process trying to delete the shadow\n\n###### A\n\nvolumes on a system.[42]\n\nThe use of “Raccine” tool, coupled with our custom vaccine against Babuk,\nprovides a full protection against this ransomware family targeting windows\nenvironment.\n\n41 https://github.com/Neo23x0/Raccine\n42 https://attack.mitre.org/techniques/T1490/\n\n\n-----\n\n```\nSource code of\nour vaccine\n\n```\n```\n 3.6\n\n```\n\n###### Security Operation Center\n\n\n###### H\n\n\nereby we share the source code of the python script we developed as a\nproof-of-concept to protect a host from Babuk’s robust encryption:\n\n```\n#TLP: AMBER (closed communities to trusted individuals only)\n#Name: Babuk Ransomware Vaccine\n#Author: CERT Sogeti ESEC Threat Intelligence Team\n#Description: This vaccine prevents the Babuk Ransomware execution through Mutex creation\n#Contact: sogetiesecctiteam.eur@capgemini.com\nimport win32event\nimport win32file\nimport win32con\nfrom threading import Thread\nimport time\nimport os\nfrom subprocess import Popen, PIPE\nclass MutexThread (Thread):\n  def __init__(self, mutexname):\n   Thread.__init__(self)\n   self.mutexname = mutexname\n  def run(self):\n   mutex = win32event.CreateMutex(None, True, self.mutexname)\n   while (True):\n     time.sleep(1)\nmutexNames = []\nthreads = []\n# We added the last strain’s mutex\nmutexNames.append(\"DoYouWantToHaveSexWithCoungDong\")\nthreads.append(MutexThread(mutexNames[0]))\nthreads[0].start()\nfor i in range(1, 11):\n  mutexNames.append(\"babuk_v\" + str(i))\n  threads.append(MutexThread(mutexNames[i]))\n  threads[i].start()\n# Then we create the file in AppData/Roaming\n# We also forbid other access with the shareMode, just in case\n\n```\n\n-----\n\n```\nfileName = os.getenv(\"APPDATA\") + \"\\ecdh_pub_k.bin\"\n# Impossible to access the file until the handle is closed\nshareMode = 0\nsecurityAttributes = 0\ncreationDisposition = win32con.CREATE_NEW     \nfileAttributes = win32con.FILE_ATTRIBUTE_NORMAL\ntemplateFile = 0\ndesiredAccess = win32con.GENERIC_READ\nfile = win32file.CreateFile(\n  fileName,\n  desiredAccess,\n  shareMode,\n  None,\n  creationDisposition,\n  fileAttributes,\n  None,\n)\nWhile(1):\n time.sleep(1)\nfile.Close()\n\n```\nThe code will create the mutexes for the potential versions by incrementing\nup to the number 10. It also creates the file containing the public key at the\nfollowing path:\n“C:\\Users\\[user]\\AppData\\Roaming\\ecdh_pub_k.bin”\n\nAs a result, the first versions of the ransomware are blocked (cf Babuk_v1\nversion). This vaccine has been tested and validated for all versions currently\navailable on abuse.ch. More specifically, this vaccine can be used to protect against\nthe following versions.\nThe script creates mutexes for several potential Babuk versions by creating\nmutexes from “babuk_v1” to “babuk_v10”. It then creates the file at the following\npath:\n\n**« C:\\Users\\[user]\\AppData\\Roaming\\ecdh_pub_k.bin »**\n\nIt renders the early strain ineffective. The vaccine was tested and validated\nfor the following versions of Babuk:\n\n- [https://bazaar.abuse.ch/sample/1b9412ca5e9deb29aeaa37be05ae8d0a8a636c12fdff](https://bazaar.abuse.ch/sample/1b9412ca5e9deb29aeaa37be05ae8d0a8a636c12fdff8c17032aa017f6075c02/)\n[8c17032aa017f6075c02/](https://bazaar.abuse.ch/sample/1b9412ca5e9deb29aeaa37be05ae8d0a8a636c12fdff8c17032aa017f6075c02/)\n\n- [https://bazaar.abuse.ch/sample/550771bbf8a3e5625d6ec76d70ed86f6e443f07ce80ff](https://bazaar.abuse.ch/sample/550771bbf8a3e5625d6ec76d70ed86f6e443f07ce80ff73e47f8249ddd72a8cf/)\n[73e47f8249ddd72a8cf/](https://bazaar.abuse.ch/sample/550771bbf8a3e5625d6ec76d70ed86f6e443f07ce80ff73e47f8249ddd72a8cf/)\n\n- [https://bazaar.abuse.ch/sample/704a0fa7de19564bc743fb68aa0652e38bf86e8ab694](https://bazaar.abuse.ch/sample/704a0fa7de19564bc743fb68aa0652e38bf86e8ab694bc079b15f945c85f4320/)\n[bc079b15f945c85f4320/](https://bazaar.abuse.ch/sample/704a0fa7de19564bc743fb68aa0652e38bf86e8ab694bc079b15f945c85f4320/)\n\n- [https://bazaar.abuse.ch/sample/30fcff7add11ea6685a233c8ce1fc30abe67044630524](https://bazaar.abuse.ch/sample/30fcff7add11ea6685a233c8ce1fc30abe67044630524a6eb363573a4a9f88b8/)\n[a6eb363573a4a9f88b8/](https://bazaar.abuse.ch/sample/30fcff7add11ea6685a233c8ce1fc30abe67044630524a6eb363573a4a9f88b8/)\n\n- [https://bazaar.abuse.ch/sample/8203c2f00ecd3ae960cb3247a7d7bfb35e55c3893960](https://bazaar.abuse.ch/sample/8203c2f00ecd3ae960cb3247a7d7bfb35e55c38939607c85dbdb5c92f0495fa9/)\n[7c85dbdb5c92f0495fa9/](https://bazaar.abuse.ch/sample/8203c2f00ecd3ae960cb3247a7d7bfb35e55c38939607c85dbdb5c92f0495fa9/)\n\n\n-----\n\n```\nGPO\ndeployment\n\n```\n```\n 3.7\n\n```\n\n###### Security Operation Center\n\n\no anticipate such a threat, the target cannot be known in advance, it\nwould obviously be necessary to prior deploy the vaccine against\nBabuk (but also against Shadow Volumes suppression) either on the\n\n###### T\n\nwhole perimeter or on a third party or several third parties deemed to be a priority.\nTo do so, it is possible to deploy such a vaccine by Group Strategy Objects (GPO).[43]\n\n43 https://github.com/Neo23x0/Raccine/tree/main/GPO\n\n\n-----\n\n```\nLimitations\n\n```\n\n###### Security Operation Center\n\n```\n 3.8\n\n```\n\nn the one hand, we do not guarantee the long-term effectiveness of\nthe vaccines as soon as the individuals behind Babuk, which\nmaintains the codebase of this ransomware, realizes this weakness\n\n###### O\n\nand/or the existence of such a ‘kill-switch’.\n\nOn the other hand, we must emphasize that this vaccine, with or without\ncomplementarity with 'Raccine', does not protect against the double extortion\n**already carried out by Babuk (and therefore a fortiori the triple extortion by**\nthreat of denial of service[44]).\n\nFinally, the 'Raccine' vaccine, which is intended to be generic for the vast\nmajority of ransomware (those that erase shadow volumes), **has some**\n**drawbacks. It will indeed kill any process using vssadmin.exe, which may have**\nan impact on some backup solutions that legitimately use the functionalities of this\ntool.\n\nIt also does not defend against ransomwares which would not have launched\nthemselves the deletion of shadow volumes, for example by passing through a\nscheduled task.\n\n44 [https://www.bleepingcomputer.com/news/security/ransomware-gangs-add-ddos-attacks-to-their-extortion-](https://www.bleepingcomputer.com/news/security/ransomware-gangs-add-ddos-attacks-to-their-extortion-arsenal/)\n[arsenal/](https://www.bleepingcomputer.com/news/security/ransomware-gangs-add-ddos-attacks-to-their-extortion-arsenal/)\n\n\n-----\n\n```\nAcknowledgements\n\n```\n\n###### Security Operation Center\n\n```\n 3.9\n\n```\n\nhe authors are very grateful to **Hugo BITARD (a former analyst of**\nthe CERT SOGETI ESEC) for contributions that enriched the reverse\nengineering analysis as well as active members of the National French\n\n###### T\n\nNetwork (InterCERT-FR) for helpful discussions.\n\nWe also thank Alexandre BOUILLON (being part of the Incident ResponseSWAT team of our CSIRT) for peer-reviewing this article.\n\n\nSWAT team of our CSIRT) for peer-reviewing this article.\n\n\n-----\n\n# 4\n\n### Appendix\n\n\n# 4\n\n\n-----\n\n```\nMitre ATT&CK Matrix\n\n```\n_Credits to Mitre Corporation[45]_\n\n**NB: Babuk’s Mitre ATT&CK matrix will be completed with the advancements of**\nCERT Sogeti ESEC’s analysts.\n\n45 https://attack.mitre.org/\n\n\n-----\n\n```\nRansom note\nStopped services[46]\n\n```\n\n\n- vss\n\n- sql\n\n- svc$\n\n- memtas\n\n- mepocs\n\n- sophos\n\n- veeam\n\n- backup\n\n- GxVss\n\n- GxBlr\n\n- GxFWD\n\n- GxCVD\n\n- GxCIMgr\n\n- DefWatch\n\n- ccEvtMgr\n\n- ccSetMgr\n\n- SavRoam\n\n- RTVscan\n\n- QBFCService\n\n- QBIDPService\n\n- Intuit.QuickBooks.FCS\n\n- QBCFMonitorService\n\n- YooBackup\n\n\n\n- YooIT\n\n- zhudongfangyu\n\n- sophos\n\n- stc_raw_agent\n\n- VSNAPVSS\n\n- VeeamTransportSvc\n\n- VeeamDeploymentService\n\n- VeeamNFSSvc\n\n- veeam\n\n- PDVFSService\n\n- BackupExecVSSProvider\n\n- BackupExecAgentAccelerator\n\n- BackupExecAgentBrowser\n\n- BackupExecDiveciMediaService\n\n- BackupExecJobEngine\n\n- BackupExecManagementService\n\n- BackupExecRPCService\n\n- AcrSch2Svc\n\n- AcronisAgent\n\n- CASAD2DWebSvc\n\n- CAARCUpdateSvc\n\n\n46 https://github.com/StrangerealIntel/DailyIOC/blob/master/2021-01-02/BabukLocker/Notes.txt\n\n\n-----\n\n```\nStopped processes\n\n```\n\n\n- sql.exe\n\n- oracle.exe\n\n- ocssd.exe\n\n- dbsnmp.exe\n\n- synctime.exe\n\n- agntsvc.exe\n\n- isqlplussvc.exe\n\n- xfssvccon.exe\n\n- mydesktopservice.exe\n\n- ocautoupds.exe\n\n- encsvc.exe\n\n- firefox.exe\n\n- tbirdconfig.exe\n\n- mydesktopqos.exe\n\n- ocomm.exe\n\n- dbeng50.exe\n```\nIOCs\n\n```\n\n\n- sqbcoreservice.exe\n\n- excel.exe\n\n- infopath.exe\n\n- msaccess.exe\n\n- mspub.exe\n\n- onenote.exe\n\n- outlook.exe\n\n- powerpnt.exe\n\n- steam.exe\n\n- thebat.exe\n\n- thunderbird.exe\n\n- visio.exe\n\n- winword.exe\n\n- wordpad.exe\n\n- notepad.exe\n\n\nIndicators of compromise below can be blocked and searched on an\ninformation system to prevent or detect a similar attack.\n```\nEmail\n\n```\nbabukrip@protonmail.com\n\n-----BEGIN PGP PUBLIC KEY BLOCK----Version: ProtonMail\nxsBNBF/CueIBCADGiGfswElTiT6vrfMN2PntCPC6EvrH82ZCocKTkX2xk40i\nh4iqKDOoIIK79ZFaqVYAkgbKPEfMz5c8dyRg5fnLx5xjWTK/gQofmcijLv/W\n5z4Tmj5W7YnnpIfooC6ON/atQZrxtumEDJByURzcXk9BejmY7LcUKPpEvU7n\nh54JIjt2QZcEd5xLSRibDoyra0xN0bAG7jJ5FjXKq2ojm7rQ8adYqKc1Hrr/\nmuPIYEfYvrnvA8kZ6/HTqYdMpRZQqbd3BgWMOvBnmrc3NV5iDX0zp99ba1UE\nnGS2qjjup24IhP7lcaNMy2ZfEKw+m0MKN0y9odH/Aue0X/mcDWt7hswRABEB\nAAHNL2JhYnVrcmlwQHByb3Rvbm1haWwuY2ggPGJhYnVrcmlwQHByb3Rvbm1h\naWwuY2g+wsCNBBABCAAgBQJfwrniBgsJBwgDAgQVCAoCBBYCAQACGQECGwMC\nHgEAIQkQzVvKKyWpmvgWIQSZZ83PrrLMt3Yz+mHNW8orJama+GVGCACbRgdz\nX0gTDYso0przWFdjqJIxbO9T8SxQFcZMM8L941NEIcT4zou9JUTMoBZjHU5i\nkmsvL/byaeQ4wOQ+6QxNZeR5/OEDdG0CEuWTCI6eD0w2sqcccqUXkZ0Wupth\nGu+YeQeYEAWwUXnztEQ6NrUI5f244UmQvBqJJ7pX9qSXmRISDW/PbWMI/0D3\nJIWK/esHqoEvjNRL8FuWliSDpwGvoFYfyslrzz5EzcGD2zaC5x0WZw1lB3f0\nvCbynidUabhTr0soOoNHdujITLzLN5h3SFA4GlXZEaw4A5hmk+IitkcKnxZa\nGFFb+nMboYqAsRKgavnBZ0YXmQTUIl4BjBZkzsBNBF/CueIBCACw8t7zv/Cm\npV2j925TwusGh3q/4srjf60bPpf4xpikG6Wci/AA3z57bP8iu593e45LH1Gv\n3b5zFvZxKMeiphoMEujEg+8vDzmcC4T7lw+PmXV5qjHuCHz2wt229x2BLiNb\nXgV1oCpQcsb5AbzNAlGF31dnHUkseU+VxhgM3N+vyYV+KarvkCiHIDEFHXfu\nL2ZQVE3N9ZyKR/N3ahOIaAKdck5fLEyYu2YjMTC+qr3A4uOHU3e0YwKGyU5X\nXY5NZ4V6I4Rl3Xe+BS/bwx/hqN5Ar4IMJTOoEdNCGjAh9MNqFW1mivl7djsa\nqZBTiv+6EzRF5S520HPxKn7xsOtuV+zdABEBAAHCwHYEGAEIAAkFAl/CueIC\nGwwAIQkQzVvKKyWpmvgWIQSZZ83PrrLMt3Yz+mHNW8orJama+FNhB/9dADjc\nGGVlx8qHfxsdqSHrNjE2AUrG2FFm57Jcwn//kzU6BFJmqmO67ru4w96SQjxI\nnKqwXe8J4kV3WZsuoGEPt+CiQBIV+pAilKqS1LhkU5U9LXCwjR/WqcNwRntb\n4mqk4swtiDXoVE2o+DeC5duxrojc0wqQroLb0h8wtYXuq7MJfSyCnXiAyb+0\nqdLxHAfgrm4dGBvIEvYAzrnqgiG+jM45Rq/Ctrs7emtafWUgN3t440cSozxu\npzE4XsmSa5gu7we3J8kmMOnQISoLR3R20ItkaNwJddUnvlpFVHsooouZWJDZ\n6MY7F8e30sgd8dlMkBoFj4+C5wzDcUjxqyFC\n=hqrC\n-----END PGP PUBLIC KEY BLOCK----\n\n-----\n\n```\nURLs\n\n```\n  - Siteweb: hxxp://babukq4e2p4wu4iq.onion/login.php?id=<ID_VICTIME>\n\n  - Dedicated leak Site (DLS): hxxp://gtmx56k4hutn3ikv.onion\n```\nHashs\n\n```\nSHA256\n\n  - afcf265a1dcd9eab5aab270d48aa561e4ddeb71c05e32c857d3b809bb64c0430\n\n  - 704a0fa7de19564bc743fb68aa0652e38bf86e8ab694bc079b15f945c85f4320\n\n  - 1b9412ca5e9deb29aeaa37be05ae8d0a8a636c12fdff8c17032aa017f6075c02\n\n  - 550771bbf8a3e5625d6ec76d70ed86f6e443f07ce80ff73e47f8249ddd72a8cf\n\n  - 30fcff7add11ea6685a233c8ce1fc30abe67044630524a6eb363573a4a9f88b8\n\n  - 8203c2f00ecd3ae960cb3247a7d7bfb35e55c38939607c85dbdb5c92f0495fa9\n\n  - 58ccba4fb2b3ed8b5f92adddd6ee331a6afdedfc755145e0432a7cb324c28053\n\n  - 3dda3ee9164d6815a18a2c23651a53c35d52e3a5ad375001ec824cf532c202e6\n\n  - ef326291febe84d6b39d2e5cea7e99a02407892729d688c27dcc444a2ae0b544\n\n  - 8140004ff3cf4923c928708505754497e48d26d822a95d63bd2ed54e14f19766\n\nSHA1\n\n  - b040f2bdee3999aad415396f9f79e43b2aa9452b\n\n  - 9d9c33493aa0e1a12efe472e7cfc74bebec9a270\n\n  - 21febfb36da69c8a611a9eaee5cc826cfd5684d7\n\n  - 499c21991aecc205fd9c64784909d94eb34a9a71\n\n  - ca205a28b8dbd74c60fdeaf522804d5a2a45dd0b\n\n  - 320d799beef673a98481757b2ff7e3463ce67916\n\n  - 72cad5a81ce546b42844b5b8fc2ab55e99f2b5d4\n\n  - 7925725cfb04d796f497e5142cba62860fbf87a9\n\nMD5\n\n  - be76ed428523b9aefe706aeaa72bb6b2\n\n  - 8b9a0b44b738c7884e6a14f4cb18afff\n\n  - e25e078255b56b47897ac96a7842de92\n\n  - 64f7ac45f930fe0ae05f6a6102ddb511\n\n  - dd7f88a68a76acc0be9eb0515d54a82a\n\n  - e10713a4a5f635767dcd54d609bed977\n\n  - 67e49cfcd12103b5ef2f9f331f092dbe\n\n  - 9478050023c7f8668df4fc39b0ddd79c\n\n\n-----\n\n|Vhash|0340466d15555068z3ahz2lz 0340566d1555155088z3dhz2lz 0240466d15555az33hz13z1fz|\n|---|---|\n|Fuzzyh ash|768:S4DnL4DGrUVvP917yo6Xee7amb26ZghLybmGJ87tHvg7jzTzt:SILd639NdCbXZxby tH6 768:73QN4DGrqBLP977YowZe478mR26fgjVyBm8Je7tFv/7iJFzMWe:7gdoT93DaRXf5B+ tFcJe 768:oD4vIOcdqNwbWSPHEV8X3QEJPtgyvZ+KgoS2:u478EkR2uUoS 192:+U0PXSFXQKapFmtHlOvvcQsfN2aFW/qiXSOGyvCcjjporSQ1Ba3DLUIkOkxVbE0z:+ UR4mSC4liOdvCk21UcNOSdCFh7Vd+ 768:C4iPMK4DGroOBLP9L7ooDee/7xm626AgkIyamlJT7tevG7FZFz:C4e3do8T9HzC6XA 3aatek 768:FWi7jIIQoMmP9079ob2eH7pmC26IgMwyim9Jr7tGvu7t9p:FWUyK9ueSCXIXiatG 768:xDkvIOcdqNwbWSPHEV8X3QEJPtgyYcKgoSr:lk78EkR28oS 384:n0qU/Gju0TUvqglfh5X8Y7we5LtS59tDvPrHC667YXdu9LLaq5SRgFvoR4+ YuS6s:Meyvq+sY7wLpvDHxq5ioH+8Q|\n|TLSH|CCE218116F555276F3E2813062BB92B7C83838218376C2D723C019E9FA756A8BD39F57 BEE219116F455276F3D2C135227BA2B7D83438208376C2D7238019E9FA696A8BE3DF57 E403B3122E5BD62CC2C1B2315221E5B5C53A5C6053F1729B63C015EB3E62EECE1BDF66 DDA229146FE5A534F2A2C97966B742B5CC393C30131780DBA7C01DC52AB54E5BA3DA17 D9E219216F455276F3E2813062BB92A7C83838208376C1D727C019E9FA656E8BD3DF57 T11AC2F9206F14D2B7F3D19171A27B95F7DA392C60537280D326C035EAF938294B639B 57 CD03A3122F5BD62CC2C1A2315221E5B5C52A5CA053F1729B63C015EB3E62EECE1BDF66 47E229676FB15430F1A6C4B426B59259E43AB430875643A7BFD006CA64E0 AE9EE3CF07 D0D2E8166B81D432F6A24C71663A12A7E63E29344733C3AB77807DF839F8 AD15535B0B|\n|Impha sh|a07d82bc384cbae972c1524ff6fb5cc1 0c89550c464c4d83cfa77b67633170e7 7f859628bfaa9e07b62f58214585994e 6c36a54c4339bbd0f14fcf7de525cbb6|\n|Poids|31 232 octets 31 744 octets 39 424 octets 22 528 octets 31 744 octets 31 668 octets 39 424 octets|\n|PE section counte r|4 ou 5 (v3, v4)|\n|PE entry point|35152|\n\n\n-----\n\n```\nFirst version of the\nBabuk’ Dedicated Leak\nSite\n\n```\n\n###### Figure 37 Home page (Wall of shame) of the Babuk’ Dedicated Leak Site.\n\n\n-----\n\n###### Figure 38 Payment Rules’\n section of the Babuk’ Dedicated\n Leak Site\n\n\n-----\n\n###### Figure 39  About Us section of the Babuk’ Dedicated Leak Site\n\n```\nSecond version of the\nBabuk’s Dedicated Leak\nSite \n\n###### Figure 40 Homepage of the rebranded version of the Babuk’ Dedicated\n Leak Site (taken the 4[th] of March, 2021).\n\n```\n\n-----\n\n```\nDetection rule: Yara\nrule[47]\n\n```\n**rule VasaLocker_1 : malware {**\nmeta:\ndescription = \"VasaLocker aka Babuk ransomware, january 2021.\"\nresearcher = \"Alexandre MATOUSEK\"\ndate = \"18-01-21\"\nsource = \"OCD\"\ncategory = \"ransom\"\nstrings:\n$ = \"BY VASA LOCKER\" ascii\n$ = \"babuk\" ascii\n$ = \"-lan\" ascii\n$ = \"RECOVER\" ascii\n$ = \"SystemFunction036\" ascii\n$ = \"DECR.txt\" wide nocase\n$ = \"vasa_dbg.txt\" wide\n$ = \"ecdh_pub_k.bin\" wide\ncondition:\nall of them\n**}**\n\n**rule BabukRansomware {**\nmeta:\ndescription = \"YARA rule for Babuk Ransomware\"\nreference = \"http://chuongdong.com/reverse%20engineering/2021/01/03/BabukRansomware/\"\nauthor = \"@cPeterr\"\ndate = \"2021-01-03\"\nrule_version = \"v1\"\nmalware_type = \"ransomware\"\ntlp = \"white\"\nstrings:\n$lanstr1 = \"-lanfirst\"\n$lanstr2 = \"-lansecond\"\n$lanstr3 = \"-nolan\"\n$str1 = \"BABUK LOCKER\"\n$str2 = \".__NIST_K571__\" wide\n$str3 = \"How To Restore Your Files.txt\" wide\n$str4 = \"ecdh_pub_k.bin\" wide\ncondition:\nall of ($str*) and all of ($lanstr*)\n}\n\nA Yara rule given by the researcher in cybersecurity who observed Babuk [48] for the\nfirst time:\n\n\nRule\nRan_BabukLockers_Jan_2021_1 {\n\n\nmeta:\ndescription = \"Detect the BabukLocker ransomware\"\nauthor = \"Arkbird_SOLG\"\nreference = \"Internal Research\"\ndate = \"2020-01-03\"\n\n47 https://chuongdong.com/reverse%20engineering/2021/01/03/BabukRansomware/\n48 https://github.com/StrangerealIntel/DailyIOC/blob/master/2021-0102/BabukLocker/Ran_BabukLockers_Jan_2021_1.yar\n\n\n-----\n\nhash1 =\n\"8203c2f00ecd3ae960cb3247a7d7bfb35e55c38939607c85dbdb5c92f0495fa9\"\n\n\nlevel = \"Experimental\"\nstrings:\n// sequence of the discovery process from imported DLL (TTPs)\n$seq1 = { 55 8b ec 83 ec 14 a1 b0 81 40 00 33 c5 89 45 fc c7 45 f8 ff ff ff ff c7\n45 f4 00 40 00 00 8d 45 f0 50 8b 4d 08 51 6a 13 6a 00 6a 02 e8 85 2b 00 00 85 c0\n0f 85 a3 00 00 00 8b 55 f4 52 e8 ae 06 00 00 83 c4 04 89 45 08 83 7d 08 00 0f 84\n81 00 00 00 8d 45 f4 50 8b 4d 08 51 8d 55 f8 52 8b 45 f0 50 e8 55 2b 00 00 85 c0\n75 5c c7 45 ec 00 00 00 00 eb 09 8b 4d ec 83 c1 01 89 4d ec 8b 55 ec 3b 55 f8 73\n40 8b 45 ec c1 e0 05 8b 4d 08 8b 54 01 0c 83 e2 02 74 14 8b 45 ec c1 e0 05 03 45\n}\n// sequence of the parsing arguments + shutdown process\n$seq2 = { 68 68 22 40 00 b8 04 00 00 00 c1 e0 00 8b 8d 9c fd ff ff 8b 14 01 52\nff 15 b8 90 40 00 85 c0 75 0c c7 85 b0 fd ff ff 01 00 00 00 eb 58 68 74 22 40 00 b8\n04 00 00 00 c1 e0 00 8b 8d 9c fd ff ff 8b 14 01 52 ff 15 b8 90 40 00 85 c0 75 0c c7\n85 b0 fd ff ff 00 00 00 00 eb 2b 68 80 22 40 00 b8 04 00 00 00 c1 e0 00 8b 8d 9c fd\nff ff 8b 14 01 52 ff 15 b8 90 40 00 85 c0 75 0a c7 85 b0 fd ff ff ff ff ff ff e9 55 ff ff ff\n6a 00 6a 00 ff 15 a8 90 40 00 e8 aa 04 00 00 e8 05 }\n// sequence of write op (key) in the disk\n$seq3 = { 83 c4 0c 68 f4 00 00 00 8d 85 f4 fd ff ff 50 68 88 22 40 00 ff 15 6c 90\n40 00 68 98 22 40 00 8d 8d f4 fd ff ff 51 ff 15 c4 90 40 00 c7 85 ec fd ff ff 00 00 00\n00 6a 00 68 80 00 00 00 6a 01 6a 00 6a 01 68 00 00 00 40 8d 95 f4 fd ff ff 52 ff 15\n70 90 40 00 89 85 98 fd ff ff 83 bd 98 fd ff ff ff 0f 84 2e 03 00 00 6a 00 8d 85 ec fd\nff ff 50 68 90 00 00 00 68 78 82 40 00 8b 8d 98 fd ff ff 51 ff 15 90 90 }\n$s1 = \"\\\\ecdh_pub_k.bin\" fullword wide\n$s2 = \"ntuser.dat.log\" fullword wide\n\n$s3 = \"cmd.exe\" fullword ascii\n$s4 = \"/c vssadmin.exe delete shadows /all /quiet\" fullword wide\n$s5 = { 5c 00 5c 00 3f 00 5c 00 00 00 00 00 3a 00 00 00 98 2f }\n\ncondition:\nuint16(0) == 0x5a4d and filesize > 15KB and 2 of ($seq*) and 3 of ($s*)\n}\n\nThe following one is a detection rule written by ReversingLabs[49]:\n\n\nrule\nWin32_Ransomware_Babuk :\ntc_detection malicious\n\n\n{\nmeta:\n\nauthor       = \"ReversingLabs\"\n\nsource       = \"ReversingLabs\"\n\nstatus       = \"RELEASED\"\nsharing       = \"TLP:WHITE\"\ncategory      = \"MALWARE\"\nmalware       = \"BABUK\"\ndescription     = \"Yara rule that detects Babuk ransomware.\"\n\ntc_detection_type  = \"Ransomware\"\ntc_detection_name  = \"Babuk\"\ntc_detection_factor = 5\n\nstrings:\n\n$find_files = {\n55 8B EC 81 EC ?? ?? ?? ?? A1 ?? ?? ?? ?? 33 C5 89 45 ?? 68 ?? ?? ?? ?? E8 ??\n?? ??\n?? 83 C4 ?? 89 85 ?? ?? ?? ?? 83 BD ?? ?? ?? ?? ?? 0F 84 ?? ?? ?? ?? 8B 45 ?? 50\n8B\n8D ?? ?? ?? ?? 51 FF 15 ?? ?? ?? ?? 68 ?? ?? ?? ?? 8B 95 ?? ?? ?? ?? 52 FF 15 ??\n??\n?? ?? 8D 85 ?? ?? ?? ?? 50 8B 8D ?? ?? ?? ?? 51 FF 15 ?? ?? ?? ?? 89 85 ?? ?? ??\n??\n\n49 https://github.com/reversinglabs/reversinglabs-yararules/blob/develop/yara/ransomware/Win32.Ransomware.Babuk.yara\n\n\n-----\n\n83 BD ?? ?? ?? ?? ?? 0F 84 ?? ?? ?? ?? C7 85 ?? ?? ?? ?? ?? ?? ?? ?? EB ?? 8B 95\n??\n\n?? ?? ?? 83 C2 ?? 89 95 ?? ?? ?? ?? 83 BD ?? ?? ?? ?? ?? 73 ?? 8B 85 ?? ?? ?? ??\n8B\n0C 85 ?? ?? ?? ?? 51 8D 95 ?? ?? ?? ?? 52 FF 15 ?? ?? ?? ?? 85 C0 75 ?? E9 ??\n?? ??\n?? E9 ?? ?? ?? ?? EB ?? 8B 45 ?? 50 8B 8D ?? ?? ?? ?? 51 FF 15 ?? ?? ?? ?? 68 ??\n??\n?? ?? 8B 95 ?? ?? ?? ?? 52 FF 15 ?? ?? ?? ?? 8D 85 ?? ?? ?? ?? 50 8B 8D ?? ?? ??\n??\n\n51 FF 15 ?? ?? ?? ?? 8B 95 ?? ?? ?? ?? 83 E2 ?? 74 ?? 83 7D ?? ?? 77 ?? 8B 45\n?? 83\nC0 ?? 50 8B 8D ?? ?? ?? ?? 51 E8 ?? ?? ?? ?? 83 C4 ?? E9 ?? ?? ?? ?? 68 ?? ?? ??\n??\n8D 95 ?? ?? ?? ?? 52 FF 15 ?? ?? ?? ?? 85 C0 74 ?? 8D 85 ?? ?? ?? ?? 50 FF 15\n?? ??\n\n?? ?? 89 85 ?? ?? ?? ?? EB ?? 8B 8D ?? ?? ?? ?? 83 E9 ?? 89 8D ?? ?? ?? ?? 83\nBD ??\n?? ?? ?? ?? 7C ?? 8B 95 ?? ?? ?? ?? 0F B7 84 55 ?? ?? ?? ?? 83 F8 ?? 75 ?? 68 ??\n??\n\n?? ?? 8B 8D ?? ?? ?? ?? 8D 94 4D ?? ?? ?? ?? 52 FF 15 ?? ?? ?? ?? 85 C0 75 ??\nEB ??\nEB ?? EB ?? EB ?? EB ?? 8B 85 ?? ?? ?? ?? 50 E8 ?? ?? ?? ?? 83 C4 ?? 8D 8D ??\n?? ??\n?? 51 8B 95 ?? ?? ?? ?? 52 FF 15 ?? ?? ?? ?? 85 C0 0F 85 ?? ?? ?? ?? 8B 85 ?? ??\n??\n?? 50 FF 15\n\n}\n\n$encrypt_files_p1 = {\n\n55 8B EC B8 ?? ?? ?? ?? E8 ?? ?? ?? ?? A1 ?? ?? ?? ?? 33 C5 89 45 ?? C7 85 ??\n?? ??\n?? ?? ?? ?? ?? 68 ?? ?? ?? ?? 8B 45 ?? 50 FF 15 ?? ?? ?? ?? 6A ?? 68 ?? ?? ?? ??\n6A\n?? 6A ?? 6A ?? 68 ?? ?? ?? ?? 8B 4D ?? 51 FF 15 ?? ?? ?? ?? 89 85 ?? ?? ?? ?? 83\nBD\n?? ?? ?? ?? ?? 0F 84 ?? ?? ?? ?? 8D 95 ?? ?? ?? ?? 52 8B 85 ?? ?? ?? ?? 50 FF 15\n??\n?? ?? ?? 6A ?? 6A ?? 6A ?? 6A ?? 6A ?? 8B 8D ?? ?? ?? ?? 51 FF 15 ?? ?? ?? ?? 89\n85\n?? ?? ?? ?? 83 BD ?? ?? ?? ?? ?? 0F 84 ?? ?? ?? ?? 83 BD ?? ?? ?? ?? ?? 0F 8C ??\n??\n?? ?? 7F ?? 81 BD ?? ?? ?? ?? ?? ?? ?? ?? 0F 86 ?? ?? ?? ?? 6A ?? 68 ?? ?? ?? ??\n8B\n\n95 ?? ?? ?? ?? 52 8B 85 ?? ?? ?? ?? 50 E8 ?? ?? ?? ?? 6A ?? 6A ?? 52 50 E8 ?? ??\n??\n?? 89 85 ?? ?? ?? ?? 89 95 ?? ?? ?? ?? 0F 57 C0 66 0F 13 85 ?? ?? ?? ? ? EB\n?? 8B 8D\n?? ?? ?? ?? 83 C1 ?? 8B 95 ?? ?? ?? ?? 83 D2 ?? 89 8D ?? ?? ?? ?? 89 95 ?? ?? ??\n??\n83 BD ?? ?? ?? ?? ?? 0F 8F ?? ?? ?? ?? 7C ?? 83 BD ?? ?? ?? ?? ?? 0F 83 ?? ?? ??\n??\n8B 85 ?? ?? ?? ?? 50 8B 8D ?? ?? ?? ?? 51 8B 95 ?? ?? ?? ?? 52 8B 85 ?? ?? ??\n?? 50\n}\n\n$encrypt_files_p2 = {\nE8 ?? ?? ?? ?? 6A ?? 68 ?? ?? ?? ?? 52 50 E8 ?? ?? ?? ?? 89 85 ?? ?? ?? ?? 89 95\n??\n?? ?? ?? 68 ?? ?? ?? ?? 8B 8D ?? ?? ?? ?? 51 8B 95 ?? ?? ?? ?? 52 68 ?? ?? ?? ??\n8B\n85 ?? ?? ?? ?? 50 FF 15 ?? ?? ?? ?? 89 85 ?? ?? ?? ?? 83 BD ?? ?? ?? ?? ?? 74 ??\n68\n?? ?? ?? ?? 8B 8D ?? ?? ?? ?? 51 8B 95 ?? ?? ?? ?? 52 68 ?? ?? ?? ?? 6A ?? 68 ??\n??\n?? ?? E8 ?? ?? ?? ?? 83 C4 ?? 68 ?? ?? ?? ?? 8B 85 ?? ?? ?? ?? 50 8B 8D ?? ?? ??\n??\n51 68 ?? ?? ?? ?? 6A ?? 68 ?? ?? ?? ?? E8 ?? ?? ?? ?? 83 C4 ?? 8B 95 ?? ?? ?? ??\n52\nFF 15 ?? ?? ?? ?? E9 ?? ?? ?? ?? E9 ?? ?? ?? ?? 83 BD ?? ?? ?? ?? ?? 0F 8C ?? ??\n??\n\n\n-----\n\n?? 7F ?? 83 BD ?? ?? ?? ?? ?? 0F 86 ?? ?? ?? ?? 8B 85 ?? ?? ?? ?? 50 6A ?? 6A ??\n68\n\n?? ?? ?? ?? 8B 8D ?? ?? ?? ?? 51 FF 15 ?? ?? ?? ?? 89 85 ?? ?? ?? ?? 83 BD ?? ??\n??\n?? ?? 74 ?? 8B 95 ?? ?? ?? ?? 52 8B 85 ?? ?? ?? ?? 50 8B 8D ?? ?? ?? ?? 51 68\n?? ??\n?? ?? 6A ?? 68 ?? ?? ?? ?? E8 ?? ?? ?? ?? 83 C4 ?? 8B 95 ?? ?? ?? ?? 52 8B 85 ??\n??\n?? ?? 50 8B 8D ?? ?? ?? ?? 51 68 ?? ?? ?? ?? 6A ?? 68 ?? ?? ?? ?? E8 ?? ?? ?? ??\n83\n}\n\n$encrypt_files_p3 = {\nC4 ?? 8B 95 ?? ?? ?? ?? 52 FF 15 ?? ?? ?? ?? 8B 85 ?? ?? ?? ?? 50 FF 15 ?? ?? ??\n??\n8B 8D ?? ?? ?? ?? 51 FF 15 ?? ?? ?? ?? 8B 95 ?? ?? ?? ?? 52 FF 15 ?? ?? ?? ?? 68\n??\n?? ?? ?? E8 ?? ?? ?? ?? 83 C4 ?? 89 85 ?? ?? ?? ?? 83 BD ?? ?? ?? ?? ?? 74 ?? 8B\n45\n\n?? 50 8B 8D ?? ?? ?? ?? 51 FF 15 ?? ?? ?? ?? 68 ?? ?? ?? ?? 8B 95 ?? ?? ?? ?? 52\nFF\n15 ?? ?? ?? ?? 6A ?? 8B 85 ?? ?? ?? ?? 50 8B 4D ?? 51 FF 15 ?? ?? ?? ?? 8B 95\n?? ??\n?? ?? 52 E8 ?? ?? ?? ?? 83 C4 ?? E9 ?? ?? ?? ?? 83 BD ?? ?? ?? ?? ?? 0F 84 ?? ??\n??\n?? 6A ?? 6A ?? 8D 45 ?? 50 E8 ?? ?? ?? ?? 83 C4 ?? 8D 4D ?? 51 6A ?? 8D 95 ??\n?? ??\n?? 52 E8 ?? ?? ?? ?? 85 C0 0F 85 ?? ?? ?? ?? 6A ?? 6A ?? 6A ?? 6A ?? 8D 45 ??\n50 6A\n?? 8B 8D ?? ?? ?? ?? 51 E8 ?? ?? ?? ?? 85 C0 0F 85 ?? ?? ?? ?? C7 85 ?? ?? ?? ??\n??\n?? ?? ?? 8D 95 ?? ?? ?? ?? 52 8D 85 ?? ?? ?? ?? 50 8D 8D ?? ?? ?? ?? 51 8D 95\n?? ??\n?? ?? 52 8B 85 ?? ?? ?? ?? 50 E8 ?? ?? ?? ?? 85 C0 0F 85 ?? ?? ?? ?? C7 85 ?? ??\n??\n\n?? ?? ?? ?? ?? EB ?? 8B 8D ?? ?? ?? ?? 83 C1 ?? 89 8D ?? ?? ?? ?? 8B 95 ?? ?? ??\n??\n3B 95 ?? ?? ?? ?? 0F 83 ?? ?? ?? ?? 69 85 ?? ?? ?? ?? ?? ?? ?? ?? 83 BC 05 ?? ??\n??\n?? ?? 0F 84 ?? ?? ?? ?? 69 8D ?? ?? ?? ?? ?? ?? ?? ?? 81 BC 0D ?? ?? ?? ?? ?? ??\n??\n?? 74 ?? FF 15 ?? ?? ?? ?? 69 95 ?? ?? ?? ?? ?? ?? ?? ?? 3B 84 15 ?? ?? ?? ?? 74\n??\n69 85 ?? ?? ?? ?? ?? ?? ?? ?? 8B 8C 05 ?? ?? ?? ?? 51 6A ?? 68 ?? ?? ?? ?? FF 15\n??\n?? ?? ?? 89 85 ?? ?? ?? ?? 83 BD ?? ?? ?? ?? ?? 74 ?? 6A ?? 8B 95 ?? ?? ?? ?? 52\nFF\n15 ?? ?? ?? ?? 68 ?? ?? ?? ?? 8B 85 ?? ?? ?? ?? 50 FF 15 ?? ?? ?? ?? 8B 8D ?? ??\n??\n?? 51 FF 15 ?? ?? ?? ?? E9 ?? ?? ?? ?? 8B 95 ?? ?? ?? ?? 52 E8 ?? ?? ?? ?? C7 85\n??\n?? ?? ?? ?? ?? ?? ?? E9 ?? ?? ?? ?? 8B 4D ?? 33 CD E8 ?? ?? ?? ?? 8B E5 5D C3\n}\n\n$enum_resources = {\n55 8B EC 83 EC ?? A1 ?? ?? ?? ?? 33 C5 89 45 ?? C7 45 ?? ?? ?? ?? ?? C7 45 ??\n?? ??\n?? ?? 8D 45 ?? 50 8B 4D ?? 51 6A ?? 6A ?? 6A ?? E8 ?? ?? ?? ?? 85 C0 0F 85 ??\n?? ??\n?? 8B 55 ?? 52 E8 ?? ?? ?? ?? 83 C4 ?? 89 45 ?? 83 7D ?? ?? 0F 84 ?? ?? ?? ??\n8D 45\n?? 50 8B 4D ?? 51 8D 55 ?? 52 8B 45 ?? 50 E8 ?? ?? ?? ?? 85 C0 75 ?? C7 45 ??\n?? ??\n?? ?? EB ?? 8B 4D ?? 83 C1 ?? 89 4D ?? 8B 55 ?? 3B 55 ?? 73 ?? 8B 45 ?? C1 E0\n?? 8B\n4D ?? 8B 54 01 ?? 83 E2 ?? 74 ?? 8B 45 ?? C1 E0 ?? 03 45 ?? 50 E8 ?? ?? ?? ??\n83 C4\n?? EB ?? 6A ?? 8B 4D ?? C1 E1 ?? 8B 55 ?? 8B 44 0A ?? 50 E8 ?? ?? ?? ?? 83 C4\n?? EB\n?? EB ?? 8B 4D ?? 51 E8 ?? ?? ?? ?? 83 C4 ?? 8B 55 ?? 52 E8 ?? ?? ?? ?? 8B 4D\n?? 33\n\n\n-----\n\nCD E8 ?? ?? ?? ?? 8B E5 5D C3\n}\n\ncondition:\nuint16(0) == 0x5A4D and\n(\n$find_files\n) and\n(\nall of ($encrypt_files_p*)\n) and\n\n(\n$enum_resources\n\n}\n\n\n**/***\n\n\n**YARA Rule Set[50]**\nAuthor: Oxthreatintel\nDate: 2021-04-17\nIdentifier: Babuk Ransom\nReference: Blog from Oxthreatintel: https://medium. com/@0xthreatintel/internals-of -babuk- ransomwarebb6aa9618857\n*/\n/* Rule Set */\nrule babuk_ransom {\nmeta:\ndescription = \"Babuk_Ransom - file babuk_ransom. exe\"\nauthor = \"Oxthreatintel\"\nreference = \"Blog from Oxthreatintel: https://medium. com/@0xthreatintel/internals-of-babukransomware-bb6aa96f8857\"\ndate = \"2021-04-17\"\nhash1 = \"18e299d4331ccff805275b21f33be0a3bd3d1d9ce72a79ba78d2f32dd657bfbb\"\nstrings:\n$s1 = \"mydesktopservice. exe\" fullword wide\n$s2 = \"tbirdconfig.exe\" fullword wide\n$s3 = \"ocomm. exe\" fullword wide\n$s4 = \"sqbcoreservice.exe\" fullword wide\n$s5 = \"oracle.exe\" fullword wide\n$s6 = \"ocssd .exe\" fullword wide\n$s7 = \"dbsnmp.exe\" fullword wide\n$s8 = \"synctime.exe\" fullword wid\n$s9 = \"agntsvc.exe\" fullword wide\n$s10 = \"isqlplussvc.exe\" fullword wide\n$s11 = \"xfssvccon.exe\" fullword wide\n$s12 = “encsvc.exe\" fullword wide\n$s13 = \"mydesktopqos.exe\" fullword wide\n$s14 = \"dbeng50.exe\" fullword wide\n$s15 = \"mspub.exe\" fullword wide\n$s16 = \"steam.exe\" fullword wide\n$s17 = \"visio.exe\" fullword wide\n$s18 = \"BackupExecManagementService\" fullword ascii\n$s19 = \"BackupExecDiveciMediaService\" fullword ascii\n$s20 = \"BackupExecRPCService\" fullword ascii\ncondition:\nuint16(0) == 0x5a4d and filesize < 200KB and\n8 of them\n}\n\n50 https://0xthreatintel.medium.com/internals-of-babuk-ransomware-bb6aa96f8857\n\n\n-----\n\n###### About Sogeti\n\nPart of the Capgemini Group, Sogeti operates in more than 100\nlocations globally. Working closely with clients and partners to take\nfull advantage of the opportunities of technology, Sogeti combines\nagility and speed of implementation to tailor innovative future-\nfocused solutions in Digital Assurance and Testing, Cloud and\nCybersecurity, all fueled by AI and automation. With its hands-on\n‘value in the making’ approach and passion for technology, Sogeti\nhelps organizations implement their digital journeys at speed.\n\nCapgemini is a global leader in partnering with companies to transform\nand manage their business by harnessing the power of technology. The\nGroup is guided everyday by its purpose of unleashing human energy\nthrough technology for an inclusive and sustainable future. It is a\nresponsible and diverse organization of 270,000 team members in\nnearly 50 countries. With its strong 50 year heritage and deep industry\nexpertise, Capgemini is trusted by its clients to address the entire\nbreadth of their business needs, from strategy and design to\noperations, fueled by the fast evolving and innovative world of cloud,\ndata, AI, connectivity, software, digital engineering and platforms. The\nGroup reported in 2020 global revenues of €16 billion. Get the Future\nYou Want.\n\nVisit us at www.sogeti.com\n\nThis document contains information that may be privileged or confidential\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "99fdc3ef-333d-48f5-a4a1-becd788c7b80",
            "created_at": "2022-10-25T15:28:29.802983Z",
            "updated_at": "2022-10-25T15:28:29.802983Z",
            "deleted_at": null,
            "name": "MITRE",
            "url": "https://github.com/mitre-attack/attack-stix-data",
            "description": "MITRE ATT&CK STIX Data",
            "reports": null
        },
        {
            "id": "bf5be533-fa31-4590-ae37-5761c97ffa34",
            "created_at": "2022-10-25T16:13:58.389257Z",
            "updated_at": "2022-10-25T16:13:58.389257Z",
            "deleted_at": null,
            "name": "Malpedia",
            "url": "https://malpedia.caad.fkie.fraunhofer.de",
            "description": "Malpedia is a free service offered by Fraunhofer FKIE",
            "reports": null
        }
    ],
    "references": [
        "https://www.sogeti.com/globalassets/reports/cybersecchronicles_-_babuk.pdf",
        "https://www.fr.sogeti.com/globalassets/france/avis-dexperts--livres-blancs/cybersecchronicles_-_babuk.pdf"
    ],
    "report_names": [
        "cybersecchronicles_-_babuk.pdf"
    ],
    "threat_actors": [
        {
            "id": "8e1bae2f-2a21-4ba8-a6f1-42155f96aec8",
            "created_at": "2022-10-25T16:07:23.645758Z",
            "updated_at": "2025-03-27T02:02:09.905135Z",
            "deleted_at": null,
            "main_name": "Flying Kitten",
            "aliases": [
                "Ajax Security Team",
                "Flying Kitten",
                "Group 26",
                "Operation Saffron Rose"
            ],
            "source_name": "ETDA:Flying Kitten",
            "tools": [
                "Stealer"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "d90307b6-14a9-4d0b-9156-89e453d6eb13",
            "created_at": "2022-10-25T16:07:23.773944Z",
            "updated_at": "2025-03-27T02:02:09.974695Z",
            "deleted_at": null,
            "main_name": "Lead",
            "aliases": [
                "Casper",
                "TG-3279"
            ],
            "source_name": "ETDA:Lead",
            "tools": [
                "Agentemis",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "RbDoor",
                "RibDoor",
                "Winnti",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "f4d7cba1-dbdd-42a9-88c5-4d0c81659ee0",
            "created_at": "2023-01-06T13:46:38.357581Z",
            "updated_at": "2025-03-27T02:00:02.813318Z",
            "deleted_at": null,
            "main_name": "Flying Kitten",
            "aliases": [
                "Saffron Rose",
                "AjaxSecurityTeam",
                "Ajax Security Team",
                "Group 26",
                "Sayad",
                "SaffronRose"
            ],
            "source_name": "MISPGALAXY:Flying Kitten",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "8610b0d9-a6af-4010-818f-28671efc5d5e",
            "created_at": "2023-01-06T13:46:38.897477Z",
            "updated_at": "2025-03-27T02:00:02.945669Z",
            "deleted_at": null,
            "main_name": "PINCHY SPIDER",
            "aliases": [],
            "source_name": "MISPGALAXY:PINCHY SPIDER",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "c84bbd2e-003d-4c43-8a46-d777455db2c7",
            "created_at": "2022-10-25T15:50:23.701006Z",
            "updated_at": "2025-03-27T02:00:55.527357Z",
            "deleted_at": null,
            "main_name": "GOLD SOUTHFIELD",
            "aliases": [
                "GOLD SOUTHFIELD",
                "Pinchy Spider"
            ],
            "source_name": "MITRE:GOLD SOUTHFIELD",
            "tools": [
                "ConnectWise",
                "REvil"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "7268a08d-d4d0-4ebc-bffe-3d35b3ead368",
            "created_at": "2022-10-25T16:07:24.225216Z",
            "updated_at": "2025-03-27T02:02:10.144446Z",
            "deleted_at": null,
            "main_name": "Sprite Spider",
            "aliases": [
                "Gold Dupont",
                "Sprite Spider"
            ],
            "source_name": "ETDA:Sprite Spider",
            "tools": [
                "Agentemis",
                "Cobalt Strike",
                "CobaltStrike",
                "Coroxy",
                "Defray 2018",
                "Defray777",
                "DroxiDat",
                "Glushkov",
                "LaZagne",
                "Metasploit",
                "PyXie",
                "PyXie RAT",
                "Ransom X",
                "RansomExx",
                "SharpHound",
                "Shifu",
                "SystemBC",
                "Target777",
                "Vatet",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "f426f0a0-faef-4c0e-bcf8-88974116c9d0",
            "created_at": "2022-10-25T15:50:23.240383Z",
            "updated_at": "2025-03-27T02:00:55.404232Z",
            "deleted_at": null,
            "main_name": "APT38",
            "aliases": [
                "APT38",
                "NICKEL GLADSTONE",
                "BeagleBoyz",
                "Bluenoroff",
                "Stardust Chollima",
                "Sapphire Sleet",
                "COPERNICIUM"
            ],
            "source_name": "MITRE:APT38",
            "tools": [
                "ECCENTRICBANDWAGON",
                "HOPLIGHT",
                "Mimikatz",
                "KillDisk",
                "DarkComet"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "bfded1cf-be73-44f9-a391-0751c9996f9a",
            "created_at": "2022-10-25T15:50:23.337107Z",
            "updated_at": "2025-03-27T02:00:55.445946Z",
            "deleted_at": null,
            "main_name": "FIN7",
            "aliases": [
                "FIN7",
                "GOLD NIAGARA",
                "ITG14",
                "Carbon Spider",
                "ELBRUS",
                "Sangria Tempest"
            ],
            "source_name": "MITRE:FIN7",
            "tools": [
                "Mimikatz",
                "AdFind",
                "JSS Loader",
                "HALFBAKED",
                "REvil",
                "PowerSploit",
                "CrackMapExec",
                "Carbanak",
                "Pillowmint",
                "Cobalt Strike",
                "POWERSOURCE",
                "RDFSNIFFER",
                "SQLRat",
                "Lizar",
                "TEXTMATE",
                "BOOSTWRITE"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "b23e717c-0b27-47e0-b3c8-4defe6dd857f",
            "created_at": "2023-01-06T13:46:38.367369Z",
            "updated_at": "2025-03-27T02:00:02.815758Z",
            "deleted_at": null,
            "main_name": "APT33",
            "aliases": [
                "ATK35",
                "Peach Sandstorm",
                "TA451",
                "APT 33",
                "Elfin",
                "Refined Kitten",
                "MAGNALLIUM",
                "HOLMIUM",
                "COBALT TRINITY",
                "G0064"
            ],
            "source_name": "MISPGALAXY:APT33",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "9fe49a5b-f3e6-4fbf-99a1-db15dad460c3",
            "created_at": "2024-05-01T02:03:08.045004Z",
            "updated_at": "2025-03-27T02:05:17.325038Z",
            "deleted_at": null,
            "main_name": "COBALT TRINITY",
            "aliases": [
                "Elfin ",
                "HOLMIUM ",
                "MAGNALIUM ",
                "Peach Sandstorm ",
                "Refined Kitten ",
                "TA451 ",
                "APT33 "
            ],
            "source_name": "Secureworks:COBALT TRINITY",
            "tools": [
                " Cadlotcorg",
                " Dello RAT",
                " Imminent Monitor",
                " KDALogger",
                " Koadic",
                " NanoCore",
                " NetWire",
                " POWERTON",
                " PoshC2",
                " Poylog",
                " PupyRAT",
                " Schoolbag",
                "AutoCore"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "8bc1a044-a23b-4904-903c-13f463605cb3",
            "created_at": "2024-05-01T02:03:08.136237Z",
            "updated_at": "2025-03-27T02:05:17.415795Z",
            "deleted_at": null,
            "main_name": "NICKEL GLADSTONE",
            "aliases": [
                "Bluenoroff ",
                "CTG-6459 ",
                "Citrine Sleet ",
                "HIDDEN COBRA ",
                "Lazarus Group",
                "Sapphire Sleet ",
                "Stardust Chollima ",
                "APT38 "
            ],
            "source_name": "Secureworks:NICKEL GLADSTONE",
            "tools": [
                " Bankshot",
                " CATCH22",
                " CCGC_Proxy",
                " Cur1Agent",
                " Ratankba",
                " Server_TrafficForwarder",
                " Wcry",
                "AlphaNC"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "27e51b73-410e-4a33-93a1-49cf8a743cf7",
            "created_at": "2023-01-06T13:46:39.210675Z",
            "updated_at": "2025-03-27T02:00:03.022315Z",
            "deleted_at": null,
            "main_name": "GOLD DUPONT",
            "aliases": [
                "SPRITE SPIDER"
            ],
            "source_name": "MISPGALAXY:GOLD DUPONT",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "f4f16213-7a22-4527-aecb-b964c64c2c46",
            "created_at": "2024-06-19T02:03:08.090932Z",
            "updated_at": "2025-03-27T02:05:17.387119Z",
            "deleted_at": null,
            "main_name": "GOLD NIAGARA",
            "aliases": [
                "Carbanak",
                "Carbon Spider ",
                "FIN7 ",
                "Navigator ",
                "Sangria Tempest ",
                "TelePort Crew ",
                "Calcium "
            ],
            "source_name": "Secureworks:GOLD NIAGARA",
            "tools": [
                " Carbanak",
                " Cobalt Strike",
                " DICELOADER",
                " DRIFTPIN",
                " GGLDR",
                " GRIFFON",
                " JSSLoader",
                " Meterpreter",
                " OFFTRACK",
                " PILLOWMINT",
                " POWERTRASH",
                " SUPERSOFT",
                " TAKEOUT",
                " TinyMet",
                "Bateleur"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "07775b09-acd9-498e-895f-f10063115629",
            "created_at": "2024-06-04T02:03:07.817613Z",
            "updated_at": "2025-03-27T02:05:17.351811Z",
            "deleted_at": null,
            "main_name": "GOLD DUPONT",
            "aliases": [
                "Sprite Spider "
            ],
            "source_name": "Secureworks:GOLD DUPONT",
            "tools": [
                " ArtifactExx",
                " Cobalt Strike",
                " Defray",
                " Metasploit",
                " PyXie",
                " Shifu",
                " SystemBC",
                " Vatet",
                "777"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "bb8702c5-52ac-4359-8409-998a7cc3eeaf",
            "created_at": "2023-01-06T13:46:38.405479Z",
            "updated_at": "2025-03-27T02:00:02.82533Z",
            "deleted_at": null,
            "main_name": "FIN7",
            "aliases": [
                "JokerStash",
                "ATK32",
                "G0046",
                "Coreid",
                "Carbanak",
                "Sangria Tempest",
                "CARBON SPIDER",
                "GOLD NIAGARA",
                "G0008",
                "ELBRUS",
                "Carbon Spider"
            ],
            "source_name": "MISPGALAXY:FIN7",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "a2b92056-9378-4749-926b-7e10c4500dac",
            "created_at": "2023-01-06T13:46:38.430595Z",
            "updated_at": "2025-03-27T02:00:02.831633Z",
            "deleted_at": null,
            "main_name": "Lazarus Group",
            "aliases": [
                "Operation DarkSeoul",
                "APT38",
                "ATK117",
                "DEV-1222",
                "G0032",
                "APT 38",
                "Stardust Chollima",
                "APT-C-26",
                "ATK3",
                "Diamond Sleet",
                "Hidden Cobra",
                "Unit 121",
                "Subgroup: Bluenoroff",
                "NICKEL GLADSTONE",
                "DEV-0139",
                "Andariel",
                "Operation Troy",
                "COVELLITE",
                "TA404",
                "Lazarus group",
                "Dark Seoul",
                "G0082",
                "NewRomanic Cyber Army Team",
                "Bluenoroff",
                "Appleworm",
                "Nickel Academy",
                "COPERNICIUM",
                "Hastati Group",
                "Bureau 121",
                "Operation AppleJeus",
                "Whois Hacking Team",
                "Citrine Sleet",
                "Sapphire Sleet",
                "Group 77",
                "Labyrinth Chollima",
                "Operation GhostSecret",
                "BeagleBoyz"
            ],
            "source_name": "MISPGALAXY:Lazarus Group",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "e5ff825b-0456-4013-b90a-971b93def74a",
            "created_at": "2022-10-25T15:50:23.824058Z",
            "updated_at": "2025-03-27T02:00:55.553346Z",
            "deleted_at": null,
            "main_name": "APT33",
            "aliases": [
                "APT33",
                "HOLMIUM",
                "Elfin",
                "Peach Sandstorm"
            ],
            "source_name": "MITRE:APT33",
            "tools": [
                "PowerSploit",
                "AutoIt backdoor",
                "PoshC2",
                "Mimikatz",
                "NanoCore",
                "DEADWOOD",
                "StoneDrill",
                "POWERTON",
                "LaZagne",
                "TURNEDUP",
                "NETWIRE",
                "Pupy",
                "ftp",
                "Shamoon"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "9df68733-9bcd-43b1-88f1-24b110fa3d56",
            "created_at": "2022-10-25T16:07:24.051993Z",
            "updated_at": "2025-03-27T02:02:10.091553Z",
            "deleted_at": null,
            "main_name": "Pinchy Spider",
            "aliases": [
                "Gold Garden",
                "Gold Southfield",
                "Pinchy Spider"
            ],
            "source_name": "ETDA:Pinchy Spider",
            "tools": [
                "Agentemis",
                "Cobalt Strike",
                "CobaltStrike",
                "GandCrab",
                "GrandCrab",
                "REvil",
                "Sodin",
                "Sodinokibi",
                "VIDAR",
                "Vidar Stealer",
                "certutil",
                "certutil.exe",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "ed3810b7-141a-4ed0-8a01-6a972b80458d",
            "created_at": "2022-10-25T16:07:23.443259Z",
            "updated_at": "2025-03-27T02:02:09.801771Z",
            "deleted_at": null,
            "main_name": "Carbanak",
            "aliases": [
                "Anunak",
                "Carbanak",
                "Carbon Spider",
                "ELBRUS",
                "Gold Waterfall",
                "Sangria Tempest"
            ],
            "source_name": "ETDA:Carbanak",
            "tools": [
                "AVE_MARIA",
                "Agentemis",
                "AmmyyRAT",
                "Antak",
                "Anunak",
                "Ave Maria",
                "AveMariaRAT",
                "BABYMETAL",
                "BIRDDOG",
                "Backdoor Batel",
                "Batel",
                "Bateleur",
                "BlackMatter",
                "Boostwrite",
                "Cain & Abel",
                "Carbanak",
                "Cl0p",
                "Cobalt Strike",
                "CobaltStrike",
                "DNSMessenger",
                "DNSRat",
                "DNSbot",
                "DRIFTPIN",
                "DarkSide",
                "FOXGRABBER",
                "FlawedAmmyy",
                "HALFBAKED",
                "JS Flash",
                "KLRD",
                "MBR Eraser",
                "Mimikatz",
                "Nadrac",
                "Odinaff",
                "POWERPIPE",
                "POWERSOURCE",
                "PsExec",
                "SQLRAT",
                "Sekur",
                "Sekur RAT",
                "SocksBot",
                "SoftPerfect Network Scanner",
                "Spy.Agent.ORM",
                "TEXTMATE",
                "TeamViewer",
                "TiniMet",
                "TinyMet",
                "Toshliph",
                "VB Flash",
                "WARPRISM",
                "avemaria",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1666716500,
    "ts_updated_at": 1743041817,
    "ts_creation_date": 1619519126,
    "ts_modification_date": 1619519126,
    "files": {
        "pdf": "https://archive.orkl.eu/affec05c6ef39a107621021d925a417883609b70.pdf",
        "text": "https://archive.orkl.eu/affec05c6ef39a107621021d925a417883609b70.txt",
        "img": "https://archive.orkl.eu/affec05c6ef39a107621021d925a417883609b70.jpg"
    }
}