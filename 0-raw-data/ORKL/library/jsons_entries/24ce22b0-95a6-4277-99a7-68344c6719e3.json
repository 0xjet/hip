{
    "id": "24ce22b0-95a6-4277-99a7-68344c6719e3",
    "created_at": "2023-01-12T15:01:54.052848Z",
    "updated_at": "2025-03-27T02:09:01.412739Z",
    "deleted_at": null,
    "sha1_hash": "7e1d5dad310ca2bc82259022332b4fb848c0f6fe",
    "title": "2020-03-15 - Has The Sun Set On The Necurs Botnet-",
    "authors": "",
    "file_creation_date": "2022-05-28T00:45:39Z",
    "file_modification_date": "2022-05-28T00:45:39Z",
    "file_size": 7208371,
    "plain_text": "# Has The Sun Set On The Necurs Botnet?\n\n**shadowserver.org/news/has-the-sun-set-on-the-necurs-botnet/**\n\nMarch 15, 2020\n\nOn March 10th 2020, while many people around the world were increasingly focused on the spreading COVID-19 pandemic,\n**Microsoft’s Digital Crime Unit (DCU)** [announced a disruption action against a long-lived and very damaging virtual threat –](https://blogs.microsoft.com/on-the-issues/2020/03/10/necurs-botnet-cyber-crime-disrupt/)\nthe Necurs botnet. Microsoft DCU described Necurs as “the world’s largest online criminal network” responsible for “infecting\n_over 9 million users globally since 2012”. The Necurs botnet has historically been used to deliver a torrent of other high profile_\n[cyber threats to the world, including the GameOver Zeus and](https://www.shadowserver.org/news/gameover-zeus-cryptolocker/) [Dridex banking trojans, Locky ransomware and, more recently,](https://www.shadowserver.org/news/dridex-update-the-wheels-of-international-law-enforcement-keep-on-turning/)\nthe banking trojan turned all purpose cybercrime-as-a-service, Trickbot. It has also been used to promote pump-and-dump\nstock scams, fake pharmaceutical spam emails and “Russian dating” scams.\n\n**[Shadowserver has previously collaborated with Microsoft DCU on successful botnet takedowns, such as the Waledec](https://www.pcworld.com/article/190234/article.html)**\n[spambot and the Andromeda malware dropper (part of Avalanche). It has also assisted with the take down of other historic](https://www.shadowserver.org/news/avalanche-year-two-this-time-with-andromeda/)\nspambots by collaborating with private partners (Grum) and with Law Enforcement, such as against various versions of\n[Kelihos with the FBI, DoJ and other private sector partners.](https://www.shadowserver.org/news/kelihos-e/) [Microsoft DCU and](https://blogs.microsoft.com/on-the-issues/2020/03/10/necurs-botnet-cyber-crime-disrupt/) [Bitsight had conducted a multi-year](https://www.bitsight.com/blog/joint-effort-with-microsoft-to-takedown-massive-criminal-botnet-necurs)\ninvestigation into Necurs, and Shadowserver was asked to support their disruption efforts once an action plan had been\nagreed.\n\nWe would usually provide in-depth details here about the technical functionality of the Necurs malware, reverse engineering\ninformation, the use of multiple layers of Domain Generation Algorithms (DGAs) – including .bit for blockchain based name to\nIP address resolution, the tiered command and control (C2) infrastructure, the structure of the multiple sub-botnets or the\n[disruption strategies employed, but we recommend you read Bitsight’s already published series of excellent Necurs articles.](https://www.bitsight.com/blog/joint-effort-with-microsoft-to-takedown-massive-criminal-botnet-necurs)\nWe will instead focus on some other interesting aspects of the Necurs disruption operation.\n\n## Registry Actions\n\nSome botnet takedowns are purely criminal cases, performed by Law Enforcement Agencies using criminal laws – although,\nnot every country has developed such legislation. In some countries, particularly the USA, LEAs can use civil legal orders in\nthe fight against cybercrime. This avenue is also open to private sector organizations; indeed, Microsoft has previously used\ncivil court orders to tackle large botnets. Where the name of a suspect behind the botnet is not known, but damages can be\ndemonstrated, it is still possible for a plaintiff (in this case Microsoft) to make an “ex parte” (meaning in the interests of one\nside, when the other side is not present) “John Doe” complaint through a civil court. If successful, a judge can issue a\nTemporary Restraining Order (TRO) that grants injunctive relief to the plaintiff. This is the legal approach that was adopted by\nMicrosoft in regards to Necurs. You can view the Eastern District of New York court documents [here and read the wording of its](https://noticeofpleadings.com/NECURS/)\n[TRO application here.](https://noticeofpleadings.com/NECURS/files/Application%20for%20TRO/Proposed%20Order.pdf)\n\n\n-----\n\nMicrosoft Necurs Ex Parte Temporary Restraining Order (TRO)\n\nShadowserver were on site with Bitsight and Microsoft at its Digital Crime Center in Redmond, WA, USA to support the Necurs\ndisruption effort. Our contribution to the operation was primarily in two areas:\n\n1. Coordinating with our extensive, international network of country-code, top-level, domain (ccTLD) Registry operators who\n\ntrust us to report malware to them that uses millions of unregistered DGA domains, as in previous large botnet takedown\n[operations such as Avalanche.](https://www.shadowserver.org/news/avalanche-123/)\n[2. Using Shadowserver’s proven victim remediation network, of](https://www.shadowserver.org/what-we-do/network-reporting/) [107 National CERTs/CSIRTs in 136 countries and over](https://www.shadowserver.org/news/celebrating-milestones-european-cert-csirt-report-coverage/)\n\n4,600 vetted network owners (covering 90% of the Internet by IP space/ASN/CIDR), to ensure that the collected sinkhole\n[data was quickly distributed to as many constituents as possible, in order to maximize world-wide victim remediation.](https://www.shadowserver.org/who-we-serve/)\nData is also available through Microsoft CTIP and Bitsight’s commercial services.\n\nOur special purpose The Registrar of Last Resort Foundation (RoLR), another Dutch Stichting non-profit, public-benefit\norganization, created specifically by Shadowserver to quarantine toxic domain names, provided crucial support to the Necurs\ndisruption activities. Voluntary action was successfully secured across 22 ccTLD registries, complementing Microsoft’s US\ncivil court orders, which had been executed on 5 US-based registries.\n\nThe Necurs botnet makes use of hardcoded domains and multiple layers of DGAs to attempt to guarantee reliable command\nand control (C2) capabilities. Since the Necurs DGAs and seed values had been reverse engineered by security researchers\nand reimplemented in code, 25 months of future domains could be forward calculated (a total of 6.1 million potential botnet C2\ndomains across 42 TLDs).\n\nUnder the wording of Microsoft’s [civil court ordered TRO, all existing Necurs botnet C2 domain names (except those](https://noticeofpleadings.com/NECURS/files/Application%20for%20TRO/Proposed%20Order.pdf)\ndetermined to belong to legitimate security researchers) within US-operated TLDs should be seized and sinkholed by the\nRegistry. Any unregistered DGA domain names would be blocked so that they could not be registered in the future – except by\n“Microsoft or its security industry partners Stichting The Registrar of Last Resort Foundation and The Shadowserver\n_Foundation for the purposes of analyzing the botnet”._\n\n\n-----\n\nMicrosoft Necurs Ex Parte Temporary Restraining Order (TRO) Wording\n\nShortly before the operation took place, a subset of the pre-calculated domains for all of the Necurs 5,7,9,11,13 and 15 sub**botnets was registered and pointed to Microsoft’s and Bitsight’s sinkhole servers, to ensure that all infected victims would**\nattempt to resolve at least one sinkholed botnet C2 domain and communicate with at least one sinkhole server every day;\nhopefully, without being able to communicate with the criminals operating the botnet. This approach allows the victim\npopulation to be identified and hopefully remediated, while minimizing the number of potential DGA C2 domains that actually\nhave to be registered (around a thousand C2 domains per year, rather than the potentially millions of C2 domains).\n\n**RoLR was used to register Necurs C2 domains for sinkholing purposes and to manage the ongoing maintenance and renewal**\nof the domains. The actions of breaking the DNS resolution of criminal controlled C2 domains, and instead delivering infected\nvictim computers to the Microsoft and Bitsight sinkhole servers, attempts to protect victims from further criminal abuse, and\nallows National CERTs/CSIRTs and responsible network owners to be notified to remediate those infections. The Necurs\ndisruption sinkhole data is available through Microsoft’s CTIP service, Bitsight’s commercial service and Shadowserver’s free\ndaily network reports. If you or your organization do not already subscribe to this free public benefit service, then please do\nsign up.\n\nThe TLDs used by the Necurs botnet for C2 communications were:\n\n**ccTLDs: .ac, .bz, .cc, .cm, .co, .cx, .de, .eu, .ga, .im, .in, .ir, .jp, .ki, .kz, .la, .me, .mn, .ms, .mu, .mx, .nf, .nu, .pw, .ru, .sc, .sh,**\n.so, .su, .sx, .to, .tv, .tw, .ug, .us, .tj\n\n**gTLDs / nTLDs: .biz, .com, .net, .org, .pro, .xxx**\n\n**Other: .bit**\n\nThe number of C2 domains per TLD over the calculated period were:\n\n**TLD** **Domains**\n\n**ac** **186,399**\n\n**bit** **85,887**\n\n**biz** **86,136**\n\n**bz** **164,375**\n\n**cc** **185,819**\n\n**cm** **186,274**\n\n**co** **165,067**\n\n**com** **85,993**\n\n**cx** **185,314**\n\n**de** **164,369**\n\n\n-----\n\n**eu** **164,837**\n\n**ga** **85,512**\n\n**im** **186,611**\n\n**in** **185,952**\n\n**ir** **85,767**\n\n**jp** **186,266**\n\n**ki** **185,968**\n\n**kz** **86,148**\n\n**la** **185,341**\n\n**me** **164,255**\n\n**mn** **185,988**\n\n**ms** **186,076**\n\n**mu** **186,152**\n\n**mx** **85,579**\n\n**net** **85,446**\n\n**nf** **185,738**\n\n**nu** **185,807**\n\n**org** **86,240**\n\n**pro** **85,292**\n\n**pw** **85,979**\n\n**ru** **164,611**\n\n**sc** **185,811**\n\n**sh** **186,049**\n\n**so** **186,200**\n\n**su** **85,734**\n\n**sx** **85,681**\n\n**tj** **186,089**\n\n**to** **85,665**\n\n**tv** **163,823**\n\n**tw** **186,388**\n\n**ug** **85,766**\n\n**us** **85,576**\n\n**xxx** **86,020**\n\nThis map showing the distribution of global and country TLDs helps to demonstrate the size and breadth of the effort that was\nrequired to gain legal and voluntary action for coverage in all the TLDs used by for Necurs DGA C2 domains:\n\n\n-----\n\nGlobal and Country level TLDs involved in Necurs botnet C2 communications\n\n## Sinkhole Data Analysis\n\nAlthough Necurs may have been eclipsed by Emotet as the main dropper of current top threats such as Trickbot and Dridex,\n[now that we have reported out the initial few days of sinkhole data, we can see that around 155,000 Necurs infected unique](https://www.shadowserver.org/what-we-do/network-reporting/)\n**IP addresses per day are being observed by the sinkholes. In operations where we have accurate bot IDs, we typically see**\nabout a one-to-one ratio of bots to IP addresses when taking into account DHCP lease churn and multiple bots behind a single\nNAT gateway. That number aligns well with Bitsight’s own published historical analysis, which shows a gradual decline in the\nnumber of detected unique Necurs victim IP address per day since the peak botnet populations that were observed in 2016\nand 2017.\n\nMicrosoft Necurs sinkhole event feed provided via Shadowserver reporting\n\n\n-----\n\nBitsight historical Necurs sinkhole events\n\n**The global IP-geolocations of the current daily Necurs victim infections globally is shown below:**\n\n2020-03-11 IP-geolocated Necurs sinkhole events – locations\n\n\n-----\n\n2020-03-11 IP-geolocated Necurs sinkhole events – victims per country\n\n\n-----\n\n2020-03-11 IP-geolocated Necurs sinkhole events – top countries\n\n## Analaysis\n\nWhen blogging about specific botnet takedowns, we try to provide analysis that is unique to our own perspective on that\noperation. Ideally, we also present that analysis in the context of the wider and historical threat ecosystem, using\nShadowserver’s own unique and extensive datasets.\n\nFor Necurs, we thought that it would be interesting to compare the IP-geolocated country level victim distributions of victims\nduring the peak 24 hours after sinkholing data collection began.\n\nSelected spam botnet subjects are:\n\n1. Grum (2012/2013)\n2. Pushdo/Cutwail (2013/2014), multiple datasets\n\n\n-----\n\n3. Kelihos.C spambot (2014/2015)\n4. Kelihos.E spambot (2017-2018)\n5. Necurs spambot (2020)\n6. Andromeda malware dropper, for comparison (2017 to 2020)\n\nWe will start by comparing relative victim population sizes (number of unique IP addresses observed at each sinkhole per day),\nto provide the historical activity timelines and demonstrate each botnet’s remediation decay curve (either due to reporting and\nvictim remediation, or through background bot atrophy/die off).\n\n**Grum (2012/2013) – peak of 153,186 on 2012-08-12, reduced to 73,910 by 2012-11-06, 50% remediation in about 3 months**\n\n**Pushdo (2013/2014) – peak of 375,898 on 2013-06-05, reduced to 180,242 on 2013-07-08, 50% remediation in about a month**\n\n**Cutwail (2014/2015) – peak of 36,662 on 2014-11-25, reduced to 16,591 on 2015-08-28, 50% remediation in about 9 months**\n(but had repeated rebuilds/takedowns)\n\n**Kelihos.C (2013) – peak of 43, 124 on 2013-02-27, reduced to 17,622 by 2013-02-28, 50% remediation in first 24 hours**\n\n\n-----\n\n**Kelihos.E (2017-2018) – peak of 58,318 on 2017-04-10, reduced to 27,836 on 2017-06-17, 50% remediation in about 2**\nmonths\n\n**Necurs (2020) – peak of 162,953 on 2020-03-11, just sinkholed, so initial days of remediation**\n\n**Andromeda (2017-2020) – peak of 1,443,705 on 2017-12-05, then 1,904,451 on 2018-09-12, then 3,584,470 on 2019-09-06,**\nwith long, slow cycles towards 50% remediation\n\nEach of these selected botnets was fairly prolific during their prime time. They have all been used to deliver much of the spam,\nphishing lures and malware that was received globally. Andromeda in particular continues to to resist large scale clean up.\n\nWe can use treemaps to easily visualize the relative ratios of sizes of botnet populations in different countries. Interestingly,\nwhen these treemaps are viewed side by side, there are some obvious observations that can be made about which countries\nthe bulk of the infected victim systems of each of these botnets are located:\n\n\n-----\n\n**Grum** 2012 08 02\n\n**Pushdo – 2013-06-05**\n\n**Cutwail – 2014-11-25**\n\n\n-----\n\n**Kelihos.C – 2013-02-27**\n\n**Kelihos.E – 2017-04-19**\n\n\n-----\n\n**Necurs – 2020-03-11**\n\n**Andromeda – 2017-12-05**\n\n\n-----\n\n**Andromeda – 2018-09-12**\n\n**Andromeda – 2019-08-06**\n\n\n-----\n\n**Andromeda – 2020-03-15**\n\nFrom our range of historical and current sinkhole datasets, if we take the peak 24 hours of each botnet’s observed victim\npopulation, there are a number of countries where the largest victim distributions are typically found. This pattern has repeated\nin many of the spamming botnet networks built up and then disrupted or taken down over the past decade. Similar distributions\noccur in the still very large Andromeda malware dropper victim pools, which have experienced very slow remediation rates\nover the past three years, despite significant attention being drawn to this at industry conferences, in blog posts, through\nevents in victim remediation feeds such as Shadowserver’s [free daily network reports, etc.](https://www.shadowserver.org/what-we-do/network-reporting/)\n\nBelow is a simple ordered count of which countries appear in the top 50% of victim populations for each of the above botnets:\n\n\n-----\n\nCountry Grum\n201208-02\n\n\nKelihos.C\n2013-0227\n\n\nPushdo\n201306-05\n\n\nCutwail\n201805-08\n\n\nKelihos.E\n2017-0419\n\n\nNecurs\n202003-14\n\n\nAndromeda\n2017-12-05\n\n\nAndromeda\n2018-09-12\n\n\nAndromeda\n2019-08-06\n\n\nTimes\nFeatures\nin Top\n50% of\nInfections\n\n\nIndia 1 1 1 1 1 1 1 1 8\n\nVietnam 1 1 1 1 1 1 1 1 8\n\nIndonesia 1 1 1 1 1 1 1 7\n\nIran 1 1 1 1 1 5\n\nTurkey 1 1 1 1 1 5\n\nMexico 1 1 1 1 4\n\nThailand 1 1 1 1 4\n\nSpain 1 1 1 3\n\nArgentina 1 1 2\n\nPhilipines 1 1 2\n\nUkraine 1 1 2\n\n\nUnited\nStates\n\nAllied Arab\nEmirates\n\n\n1 1 2\n\n1 1\n\n\nBelarus 1 1\n\n\nBosnia &\nHerzegovina\n\n\n1 1\n\n\nBrazil 1 1\n\nChile 1 1\n\nChina 1 1\n\nEgypt 1 1\n\nGermany 1 1\n\nItaly 1 1\n\nKazakhstan 1 1\n\nPeru 1 1\n\nRomania 1 1\n\nRussia 1 1\n\n\nSaudi\nArabia\n\n\n1 1\n\n\nSouth Korea 1 1\n\nTurkey 1 1\n\nVenezuela 1 1\n\n\n-----\n\nThe purpose of this comparison analysis is not to disparage any particular country, or to blame anyone for this situation (other\nthan the cyber criminals who have been victimizing these populations for years). We have deliberately chosen to focus at a\ncountry level, rather than the individual ASN or IP level (although we do have that data available). The Shadowserver\nFoundation is a public benefit non-profit organization which gives data away for free each day to any vetted network owner\nand National CERT/CSIRT, and we have strived to help remediate these victim populations for many years now. We merely\nwant to highlight the observed trends across a decade of spam and malware dropping botnets, to better assist defenders in\nprotecting all networks, in every country.\n\nFrom a global Internet security hygiene perspective, you might ask the question “After the next big takedown or disruption\n**of the next big spamming botnet (perhaps Emotet?) – where would the victim population likely be located?” Every**\nbotnet is obviously different, as are the owner’s goals and the circumstances on the Internet at that time. But 15 years of\nhistoric sinkhole data would suggest that it would likely be many of the same areas again.\n\nThese repeated botnet population patterns could be due to limited infosec budgets in certain countries, ignorance of the\navailable (free) remediation data sources (such as Shadowserver), a lack of public awareness and good security practice\nguidance, larger populations of older, more vulnerable operating systems and computer hardware, perhaps a higher chance of\nsoftware licensing compliance problems, or it could just be simple economic realities. Given that spamming botnets and\nmalware droppers have proven to be highly effective, are often long lived, and are one of the primary attack vectors against the\nentire online world, it seems likely that countries with fewer infections will continue to be bombarded with spam and malware\nfrom similar locations in the future.\n\nThis is a obviously a complex topic, requiring more than a single blog post to do the subject justice. At a time when the physical\nworld is dealing with the current COVID-19 pandemic and isolation is being considered, at both national and personal level, it is\nobviously difficult for many people to worry too much about malware and Internet-borne viruses. That is understandable, and\nprotecting human lives needs to come first. However, we should all also think about some of the difficult challenges in\nmaintaining good global internet hygiene, and how best the various members of the National CERT/CSIRT, network owner,\nLaw Enforcement Agency, private sector business and ordinary members of the public can work together to help minimize the\nrisk of another major spambot outbreak soon.\n\n## Conclusion\n\nIt has been good to work again with Microsoft and Bitsight on another major cybercrime disruption operation. We appreciate\nbeing offered the opportunity to support the final phase of their Necurs disruption effort, and to assist in what will hopefully be a\nrapid, effective, global remediation effort.\n\nThanks to the way Microsoft have managed this investigation and the civil court orders that they obtained, along with the use of\nRoLR for non-US TLDs, hundreds of thousands of unique daily victim IP addresses observed by the Necurs sinkholes will not\nonly be made available to Microsoft and Bitsight’s customers, but will also be available through Shadowserver’s free daily\nnetwork reports (in the Shadowserver drone feed, tagged as type=necurs). Some ISPs will also be blocking outbound\nconnections to the known C2 infrastructure to further protect their end users.\n\nThis is a truly laudable effort from two private sector companies collectively trying to clean up this persistent, highly effective\nand impactful botnet. Regardless of whether the Necurs botnet will eventually be rebuilt, notifying – and hopefully remediating\n– so many victims of cybercrime is always a positive result for the good guys, and hopefully a bad day for the criminals.\n\nIf you receive an infection notification from your ISP, network owner or National CERT/CSIRT, please use anti-virus software to\ndisinfect your computer and reduce the risk to yourself and others who might be impacted as a consequence of further\nmalware attacks launched from your infected system. At this time in particular, we should all be aware that not only do we need\nto look after our own health, but we also have to think about our social responsibility towards others.\n\n[Botnets](https://www.shadowserver.org/topics/botnets/)\n[Bots](https://www.shadowserver.org/topics/bots/)\n[Malware](https://www.shadowserver.org/topics/malware/)\n[Takedowns](https://www.shadowserver.org/topics/takedowns/)\n\n[« Back to News & Insights](https://www.shadowserver.org/news-insights/)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2020/2020-03-15 - Has The Sun Set On The Necurs Botnet-.pdf"
    ],
    "report_names": [
        "2020-03-15 - Has The Sun Set On The Necurs Botnet-.pdf"
    ],
    "threat_actors": [
        {
            "id": "bc289ba8-bc61-474c-8462-a3f7179d97bb",
            "created_at": "2022-10-25T16:07:24.450609Z",
            "updated_at": "2025-03-27T02:02:10.235933Z",
            "deleted_at": null,
            "main_name": "Avalanche",
            "aliases": [],
            "source_name": "ETDA:Avalanche",
            "tools": [],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535714,
    "ts_updated_at": 1743041341,
    "ts_creation_date": 1653698739,
    "ts_modification_date": 1653698739,
    "files": {
        "pdf": "https://archive.orkl.eu/7e1d5dad310ca2bc82259022332b4fb848c0f6fe.pdf",
        "text": "https://archive.orkl.eu/7e1d5dad310ca2bc82259022332b4fb848c0f6fe.txt",
        "img": "https://archive.orkl.eu/7e1d5dad310ca2bc82259022332b4fb848c0f6fe.jpg"
    }
}