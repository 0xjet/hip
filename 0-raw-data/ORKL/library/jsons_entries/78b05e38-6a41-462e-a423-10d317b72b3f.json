{
    "id": "78b05e38-6a41-462e-a423-10d317b72b3f",
    "created_at": "2023-01-12T15:01:18.552054Z",
    "updated_at": "2025-03-27T02:12:18.349049Z",
    "deleted_at": null,
    "sha1_hash": "fe525e2f19f42ab94bcd660e2e7b0e43a75df85d",
    "title": "2021-06-09 - Gelsemium- When threat actors go gardening",
    "authors": "",
    "file_creation_date": "2022-05-28T00:24:04Z",
    "file_modification_date": "2022-05-28T00:24:04Z",
    "file_size": 342898,
    "plain_text": "# Gelsemium: When threat actors go gardening\n\n**[welivesecurity.com/2021/06/09/gelsemium-when-threat-actors-go-gardening/](https://www.welivesecurity.com/2021/06/09/gelsemium-when-threat-actors-go-gardening/)**\n\nESET researchers shed light on new campaigns from the quiet Gelsemium group\n\n\nJune 9, 2021\n\n\nIn mid-2020, ESET researchers started to analyze multiple campaigns, later attributed to\nthe Gelsemium group, and tracked down the earliest version of the malware going back to\n2014. Victims of these campaigns are located in East Asia as well as the Middle East and\ninclude governments, religious organizations, electronics manufacturers and universities.\n\n**Key points in this report:**\n\nESET researchers believe that Gelsemium is behind the supply-chain attack against\n[BigNox that was previously reported as Operation NightScout](https://www.welivesecurity.com/2021/02/01/operation-nightscout-supply-chain-attack-online-gaming-asia/)\nESET researchers found a new version of Gelsemium, complex and modular\nmalware, later referred to as Gelsemine, Gelsenicine and Gelsevirine\nNew targets were discovered that include governments, universities, electronics\nmanufacturers and religious organizations in East Asia and the Middle East\nGelsemium is a cyberespionage group active since 2014\n\n[Gelsemium](https://www.welivesecurity.com/wp-content/uploads/2021/06/eset_gelsemium.pdf)\n\n\n-----\n\n[Download Research Paper](https://www.welivesecurity.com/wp-content/uploads/2021/06/eset_gelsemium.pdf)\n\nThe geographical distribution of Gelsemium’s targets can be seen in Figure 1.\n\n_Figure 1. Targets’ locations_\n\n## Gelsemium components\n\nGelsemium’s whole chain might appear simple at first sight, but the exhaustive\nconfigurations, implanted at each stage, modify on-the-fly settings for the final payload,\nmaking it harder to understand. Behaviors analyzed below are tied to the configuration; as a\nresult, filenames and paths may be different in other samples. Most of the campaigns we\nobserved follow what we describe here.\n\n\n-----\n\n_Figure 2. Overview of the three components’ workflow_\n\n### Gelsemine: The dropper\n\nGelsemium’s first stage is a large dropper written in C++ using the Microsoft Foundation\nClass library (MFC). This stage contains multiple further stages’ binaries. Dropper sizes\nrange from about 400 kB to 700 kB, which is unusual and would be even larger if the eight\n[embedded executables were not compressed. The developers use the zlib library, statically](https://zlib.net/)\nlinked, to greatly reduce the overall size. Behind this oversized executable is hidden a\ncomplex yet flexible mechanism that is able to drop different stages according to the\ncharacteristics of the victim computer, such as bitness (32-bit vs. 64-bit) or privilege\n(standard user vs. administrator). Almost all stages are compressed, located in the resource\nsection of the PE and mapped into the same component’s memory address space. Figure 3\nillustrates all stages in the Gelsemine component.\n\n\n-----\n\n_Figure 3. Gelsemine address space overview_\n\n### Gelsenicine: The loader\n\nGelsenicine is a loader that retrieves Gelsevirine and executes it. There are two different\nversions of the loader – both of them are DLLs; however, they differ in the context where\nGelsemine is executed.\n\n\n-----\n\nFor victims with administrator privileges, Gelsemine drops Gelsenicine at\n[C:\\Windows\\System32\\spool\\prtprocs\\x64\\winprint.dll (user-mode DLL for print processor)](https://docs.microsoft.com/en-us/windows-hardware/drivers/print/introduction-to-print-processors)\nthat is then automatically loaded by the spoolsv Windows service. To write a file under the\n%WINDIR%/system32 directory, administrator privileges are mandatory; hence the\nrequirement previously mentioned.\n\nUsers with standard privileges compromised by Gelsemine drop Gelsenicine under a\ndifferent directory that does not require administrator privileges. The DLL chrome_elf.dll is\ndropped under %CommonAppData%/Google/Chrome/Application/Library/.\n\n### Gelsevirine: The main plug-in\n\nGelsevirine is the last stage of the chain and it is called MainPlugin by its developers,\naccording to the DLL name and also PDB path found in old samples\n(Z:\\z_code\\Q1\\Client\\Win32\\Release\\MainPlugin.pdb). It’s also worth mentioning that if\ndefenders manage to obtain this last stage alone, it won’t run flawlessly since it requires its\narguments to have been set up by Gelsenicine.\n\nThe config used by Gelsenicine contains a field named controller_version that we believe is\nthe versioning used by the operators for this main plug-in. Figure 4 provides a timeline of\nthe different versions we have observed in the wild; the dates are approximate.\n\n_Figure 4. Gelsevirine version timeline_\n\n### Additional links/tools\n\nDuring our investigation we encountered some interesting malware described in the\nfollowing sections.\n\n**Operation NightScout (BigNox): In January 2021, another ESET researcher**\n[analyzed and wrote an article about Operation NightScout; a supply-chain attack](https://www.welivesecurity.com/2021/02/01/operation-nightscout-supply-chain-attack-online-gaming-asia/)\ncompromising the update mechanism of NoxPlayer, an Android emulator for PCs and\nMacs, and part of [BigNox’s product range with over 150 million users worldwide. The](https://www.bignox.com/)\ninvestigation uncovered some overlap between this supply-chain attack and the\nGelsemium group. Victims originally compromised by that supply-chain attack were\nlater being compromised by Gelsemine. Among the different variants examined,\n“variant 2” from that article shows similarities with Gelsemium malware.\n\n\n-----\n\n**OwlProxy: This module also comes in two variants – 32- and 64-bit versions – and as**\na result it contains a function to test the Windows version the same as in the\nGelsemium components.\n**Chrommme: Chrommme is a backdoor we found during our adventures in the**\nGelsemium ecosystem. Code similarities with Gelsemium components are almost\nnonexistent but small indicators were found during the analysis that lead us to believe\nthat it’s somehow related to the group. The same C&C server was found in both\nGelsevirine and Chrommme, both are using two C&C servers. Chrommme was found\non an organization’s machine also compromised by Gelsemium group.\n\n## Conclusion\n\nThe Gelsemium biome is very interesting: it shows few victims (according to our telemetry)\nwith a vast number of adaptable components. The plug-in system shows that its developers\nhave deep C++ knowledge. Small similarities with known malware tools shed light on\ninteresting, possible overlaps with other groups and past activities. We hope that this\nresearch will drive other researchers to publish about the group and reveal more roots\nrelated to this malware biosphere.\n\nA full and comprehensive list of Indicators of Compromise (IoCs) and samples can be found\n[in the full white paper and in our GitHub repository.](https://www.welivesecurity.com/wp-content/uploads/2021/06/eset_gelsemium.pdf)\n\n_For any inquiries, or to make sample submissions related to the subject, contact us at_\n_threatintel@eset.com._\n\n**_To learn more about how threat intelligence services can enhance the cybersecurity_**\n**_posture of your organization, visit the_** **_[ESET Threat Intelligence page.](https://www.eset.com/int/business/services/threat-intelligence/?utm_source=welivesecurity.com&utm_medium=referral&utm_campaign=wls-research&utm_content=gelsemium-when-threat-actors-go-gardening)_**\n\n9 Jun 2021 - 02:00PM\n\n### Sign up to receive an email update whenever a new article is published in our Ukraine Crisis – Digital Security Resource Center\n\n Newsletter\n\n Discussion\n\n\n-----\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-06-09 - Gelsemium- When threat actors go gardening.pdf"
    ],
    "report_names": [
        "2021-06-09 - Gelsemium- When threat actors go gardening.pdf"
    ],
    "threat_actors": [
        {
            "id": "77874718-7ad2-4d15-9831-10935ab9bcbe",
            "created_at": "2022-10-25T15:50:23.619911Z",
            "updated_at": "2025-03-27T02:00:55.50722Z",
            "deleted_at": null,
            "main_name": "Gelsemium",
            "aliases": [
                "Gelsemium"
            ],
            "source_name": "MITRE:Gelsemium",
            "tools": [
                "Gelsemium",
                "Mimikatz"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "d90307b6-14a9-4d0b-9156-89e453d6eb13",
            "created_at": "2022-10-25T16:07:23.773944Z",
            "updated_at": "2025-03-27T02:02:09.974695Z",
            "deleted_at": null,
            "main_name": "Lead",
            "aliases": [
                "Casper",
                "TG-3279"
            ],
            "source_name": "ETDA:Lead",
            "tools": [
                "Agentemis",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "RbDoor",
                "RibDoor",
                "Winnti",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "2d4d2356-8f9e-464d-afc6-2403ce8cf424",
            "created_at": "2023-01-06T13:46:39.290101Z",
            "updated_at": "2025-03-27T02:00:03.041564Z",
            "deleted_at": null,
            "main_name": "Gelsemium",
            "aliases": [
                "狼毒草"
            ],
            "source_name": "MISPGALAXY:Gelsemium",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "068b67c8-604c-4272-b808-350413fa9ee3",
            "created_at": "2022-10-25T16:07:23.975708Z",
            "updated_at": "2025-03-27T02:02:10.058689Z",
            "deleted_at": null,
            "main_name": "Operation NightScout",
            "aliases": [],
            "source_name": "ETDA:Operation NightScout",
            "tools": [],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "b5550c4e-943a-45ea-bf67-875b989ee4c4",
            "created_at": "2022-10-25T16:07:23.675771Z",
            "updated_at": "2025-03-27T02:02:09.918749Z",
            "deleted_at": null,
            "main_name": "Gelsemium",
            "aliases": [
                "Operation NightScout",
                "Operation TooHash"
            ],
            "source_name": "ETDA:Gelsemium",
            "tools": [
                "ASPXSpy",
                "ASPXTool",
                "Agentemis",
                "BadPotato",
                "CHINACHOPPER",
                "China Chopper",
                "Chrommme",
                "Cobalt Strike",
                "CobaltStrike",
                "FireWood",
                "Gelsemine",
                "Gelsenicine",
                "Gelsevirine",
                "JuicyPotato",
                "OwlProxy",
                "Owowa",
                "SAMRID",
                "SessionManager",
                "SinoChopper",
                "SpoolFool",
                "SweetPotato",
                "WolfsBane",
                "cobeacon",
                "reGeorg"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535678,
    "ts_updated_at": 1743041538,
    "ts_creation_date": 1653697444,
    "ts_modification_date": 1653697444,
    "files": {
        "pdf": "https://archive.orkl.eu/fe525e2f19f42ab94bcd660e2e7b0e43a75df85d.pdf",
        "text": "https://archive.orkl.eu/fe525e2f19f42ab94bcd660e2e7b0e43a75df85d.txt",
        "img": "https://archive.orkl.eu/fe525e2f19f42ab94bcd660e2e7b0e43a75df85d.jpg"
    }
}