{
    "id": "e44a0794-f74f-480e-8cbe-a27399d223a2",
    "created_at": "2023-04-05T02:09:41.085217Z",
    "updated_at": "2025-03-27T02:05:20.758145Z",
    "deleted_at": null,
    "sha1_hash": "98aeb53d74ac58172b3ef239192c7e33010147c7",
    "title": "2023-01-19 - Gigabud RAT- New Android RAT Masquerading as Government Agencies",
    "authors": "",
    "file_creation_date": "2023-04-03T08:53:56Z",
    "file_modification_date": "2023-04-03T08:53:56Z",
    "file_size": 1435571,
    "plain_text": "# Gigabud RAT: New Android RAT Masquerading as Government Agencies\n\n**[blog.cyble.com/2023/01/19/gigabud-rat-new-android-rat-masquerading-as-government-agencies/](https://blog.cyble.com/2023/01/19/gigabud-rat-new-android-rat-masquerading-as-government-agencies/)**\n\nJanuary 19, 2023\n\n## Sophisticated Android Malware Strikes Users in Thailand, Philippines, and Peru\n\nCyble Research & Intelligence Labs (CRIL) discovered a phishing website, hxxp://lionaiothai[.]com, that\nwas impersonating the genuine Thai Airline – Thai Lion Air, and tricking victims into downloading a\nmalicious application.\n\nThe downloaded malicious application is a Remote Access Trojan (RAT) which receives commands from\nthe Command and Control (C&C) server and performs various actions. The RAT has advanced features\nsuch as screen recording and abusing the Accessibility Service to steal banking credentials.\n\nDuring our investigation of the RAT, we discovered that the certificate used to sign this malicious\napplication was found in more than 50 similar malicious samples that use the same source code. These\nsamples posed as government agencies, shopping apps, and banking loan applications from Thailand,\nthe Philippines, and Peru.\n\n\n-----\n\n_Figure 1 –Certificate used to sign RAT present in over 50 malicious apps_\nSince the discovered RAT is a new and unknown variant, we will refer to it as “Gigabud” due to the\nconsistency of the certificate issuer name across all identified malicious applications.\n\nThe Gigabud RAT malware has been specifically targeting individuals in Thailand since July 2022, and its\nspread has been increasing each month to other countries. Despite the growing number of known\nsamples, no antivirus software detected this malware at the time of writing this blog, suggesting that the\nThreat Actor (TA) behind the RAT successfully stayed under the radar.\n\n_Figure 2 – Zero detection for all malicious samples on Virus Total_\n[Additionally, in July 2022, the Department of Special Investigation (DSI) Thailand issued a warning](https://www.dsi.go.th/th/Detail/3b1a88b9b174add5a1eb8c122f8e89fe)\nagainst the phishing site impersonating the DSI website and spreading the same Android RAT. Later in\nSeptember 2022, the Thailand Telecommunication Sector Cert (TTC-Cert) discovered the malware\n[“Revenue.apk” associated with the same campaign and issued a technical advisory on its behavior.](https://www.blognone.com/node/130546)\n\nAfter the discovery of the Gigabud RAT by TTC-Cert in September, we observed that the TA began\ndistributing the malware in various countries, such as Peru and the Philippines. The malware disguises\nitself using the icons of government agencies from these countries to trick victims into giving away\nsensitive information.\n\n\n-----\n\nThe below figure shows the different icons used by Gigabud RAT.\n\n_Figure 3 – Government agency and bank icons used by malware_\nThese malicious applications impersonate below entities:\n\n1. Banco de Comercio – A Peruvian Bank\n2. Advice – A IT company from Thailand\n3. Thai Lion Air – Thailand Airline\n4. Shopee Thailand\n5. SUNAT – An organization from Peru\n6. DSI – Department of Special Investigation Thailand\n7. BIR – Bureau of Internal Revenue Philippine\n8. Kasikornbank Thailand\n\nIn this analysis, we will look at the sample “BANCO DE COMERCIO.apk”\n(a940c9c54ff69dacc6771f1ffb3c91ea05f7f08e6aaf46e9802e42f948dfdb66) which is impersonating a\nmedium-scale Peruvian Bank and stealing sensitive information by offering the fake loan service. The indepth analysis of this malicious sample can be found in the technical analysis section.\n\n## Technical Analysis\n\n### APK Metadata Information\n\n**App Name: BANCO DE COMERCIO**\n**Package Name: com.cloud.loan**\n**SHA256 Hash: a940c9c54ff69dacc6771f1ffb3c91ea05f7f08e6aaf46e9802e42f948dfdb66**\n\nThe below figure shows the metadata information of the application.\n\n_Figure 4 – Malicious Application Metadata Information_\n\n\n-----\n\nOnce installed, the malware displays a login screen that prompts users to enter their mobile number and\npassword. The login screen is designed to mimic the user interface of a legitimate bank and uses an icon\nto deceive the victim into thinking the application is genuine.\n\n_Figure 5 – Malware loads the login page_\n\nThe malware sends the entered mobile number and password to the C&C server hxxp://bweri6[.]cc and\nreceives the response code 400 with an error message, as shown in the below figure.\n\n\n-----\n\n_Figure 6 – Malware sending the entered mobile number to the C&C server_\nTA behind the Gigabud has implemented a server-side verification process to ensure the mobile number\nentered during registration is legitimate and to limit malicious activity for invalid users. It could be the\nreason for the delayed detection of the malware.\n\n_Figure 7 – Malware has a server-side check to validate the mobile number_\nDuring registration, the malware prompts the victim to provide their name and ID number and also allows\nthem to select a bank name from a list received from the Command-and-Control server with the\ncardholder’s name and number.\n\n\n-----\n\n_Figure 8 – Malware prompting for card details during the registration process_\nOnce the victim successfully logs in or registers to the malicious app, Gigabud begins gathering\ninformation about the installed applications on the device and then runs a service called “OpenService,”\nwhich connects to the Command-and-Control server to receive commands, as illustrated in the figure\nbelow.\n\n_Figure 9 – Malware collecting installed application list_\nOnce the registration or login is complete, the malware displays a fake loan contract received from the\nserver and then prompts the victim to confirm their information.\n\nIt also shows a withdrawal activity, as depicted in the figure below.\n\n\n-----\n\n_Figure 10 – Fake loan approval process by malware_\nMalware does not show any malicious activity until the final stage, where it presents a “Real Name\nAuthentication” page and prompts the victim to press a “click to activate” button to apply for a loan. Once\nthe button is clicked, the malware requests the victim to grant accessibility permissions, including\npermission for screen recording and screen overlay.\n\n_Figure 11 – Malware displays the authentication page and prompts the victim to grant permissions_\n\n\n-----\n\nAfter the victim grants the accessibility permission, the malware starts exploiting it by automatically\nenabling the screen recording feature. Additionally, the malware requests permission to display over other\napps.\n\n_Figure 12 – Malware abusing Accessibility service to start screen recording feature_\nGigabud uses WebSocket connections to send the recorded screen content to a server\n_hxxp://8.219.85[.]91:8888/push-streaming?id=1234._\n\nThe malware sends the recorded content every second through the WebSocket connection, as shown in\nthe figure.\n\n_Figure 13 – Malware sending screen recording content using WebSocket connection_\nThe malware connects to the C&C server hxxp://bweri6[.]cc/x/command?\n_token=&width=1080&height=1920 to receive commands and executes various actions such as creating a_\nfloating window service, receiving targeted bank details, sending text messages from the infected device,\nopening targeted application and many other.\n\n\n-----\n\n_Figure 14 – Malware processing commands received from the C&C server_\nThe malware receives the “bankName”, “bankImg” and “bank_id” along with action code “15” from the\nC&C server. The “bankName” is the name of the targeted banking application whose credentials the\nmalware will steal. Upon receiving this command, the malware displays a fake dialog box using the\n“bankName” and “bankImg” received from the server on top of the targeted banking application and\nprompts the victim to enter their password.\n\n_Figure 15 – Malware receiving targeted bank name to steal credentials_\nThe entered password by the victim will be sent to the server using the retrofit object.\n\nThe below figure shows the endpoints and the stolen data sent to the server.\n\n\n-----\n\n_Figure 16 – POST & GET requests used by malware_\nThe malware receives the mobile number, the message text, and the action code “5” from the C&C server\nto send the text message from an infected device.\n\n_Figure 17 – Malware sending text messages from an infected device_\nThe malware also receives the server’s bank card number and action code “29” and sets it to the\nclipboard. We suspect that the bank card number could be the TA’s account or card number, which can be\nused to perform on-device fraud.\n\n\n-----\n\n_Figure 18 – Malware setting the bank card number to the clipboard_\n\n## Conclusion\n\nOur analysis indicates that the Threat Actor has been actively running the campaign since July 2022,\nmainly targeting victims in Thailand. Later, the campaign expanded to target victims in other countries like\nPeru and the Philippines. The malware specifically targets genuine victims and conceals its malicious\nactivity from invalid victims. The TA has employed a unique technique to evade detection and sustain the\ncampaign for an extended period.\n\nWe also noticed that the Gigabud RAT utilizes screen recording as a primary method for gathering\nsensitive information instead of using HTML overlay attacks. It also abuses the Accessibility service, like\nother banking trojans.\n\nThe Threat Actor behind the Gigabud is continuously developing new variants of the malware intending to\ntarget different countries. New malware variants will likely be discovered in the future, featuring new\ntargets and capabilities.\n\n## Our Recommendations\n\nWe have listed some essential cybersecurity best practices that create the first line of control against\nattackers. We recommend that our readers follow the best practices given below:\n\nDownload and install software only from official app stores like Google Play Store or the iOS App\nStore.\nUse a reputed antivirus and internet security software package on your connected devices, such as\nPCs, laptops, and mobile devices.\nNever share your Card Details, CVV number, Card PIN, and Net Banking Credentials with an\nuntrusted source.\nGovernment agencies or other legitimate organizations never ask for a Card PIN or password with\nother banking information, and avoid sharing such information on any suspicious application.\nUse strong passwords and enforce multi-factor authentication wherever possible.\nEnable biometric security features such as fingerprint or facial recognition for unlocking the mobile\ndevice where possible.\nBe wary of opening any links received via SMS or emails delivered to your phone.\nEnsure that Google Play Protect is enabled on Android devices.\n\n\n-----\n\nBe careful while enabling any permissions.\nKeep your devices, operating systems, and applications updated.\n\n## MITRE ATT&CK® Techniques\n\n**Tactic** **Technique ID** **Technique Name**\n\n**Initial Access** [T1476](https://attack.mitre.org/versions/v7/techniques/T1476/) Deliver Malicious App via Other Means.\n\n**Initial Access** [T1444](https://attack.mitre.org/versions/v10/techniques/T1444/) Masquerade as a Legitimate Application\n\n**Discovery** [T1418](https://attack.mitre.org/versions/v10/techniques/T1418/) Application discovery\n\n**Collection** [T1513](https://attack.mitre.org/versions/v10/techniques/T1513/) Screen Capture\n\n**Credential Access** [T1411](https://attack.mitre.org/versions/v10/techniques/T1411/) Input Prompt\n\n**Impact** [T1582](https://attack.mitre.org/versions/v10/techniques/T1582/) SMS Control\n\n**Impact** [T1510](https://attack.mitre.org/versions/v10/techniques/T1510/) Clipboard Modification\n\n**Command and Control** [T1436](https://attack.mitre.org/versions/v10/techniques/T1436/) Commonly Used Port\n\n**Exfiltration** [T1567](https://attack.mitre.org/techniques/T1567/) Exfiltration Over Web Service\n\n## Indicators of Compromise (IOCs)\n\n**Indicators** **Indicator**\n**Type**\n\nSHA256\n\n**a940c9c54ff69dacc6771f1ffb3c91ea05f7f08e6aaf46e9802e42f948dfdb66**\n\n\n**Description**\n\nHash of\nanalyzed\nmalicious\nAPK\n\n\n**1012a7627b6b82e3afb87380bbfda515764ce0a6** SHA1 Hash of\nanalyzed\nmalicious\nAPK\n\n**ca6aa6c5a7910281a899695e61423079** MD5 Hash of\nanalyzed\nmalicious\nAPK\n\n**hxxp://8.219.85[.]91:8888/push-streaming?id=1234** URL C&C server\nused to\nsend screen\nrecording\ncontent\n\n\n-----\n\n**hxxp://bweri6[.]cc/x/command?token=&width=1080&height=1920** URL C&C server\nused to\nreceive\ncommands\nand send\nstolen data\n\n\n**ec1e2ff5c72c233f2b5ad538d44059a06b81b5e5da5e2c82897be1ca4539d490** SHA256\n\n\nHash of\nmalicious\nLionAir APK\n\n\n**ea5359c8408cdb4ebb7480704fe06a8e3bfa37c3** SHA1 Hash of\nmalicious\nLionAir APK\n\n**b2429371b530d634b2b86c331515904f** MD5 Hash of\nmalicious\nLionAir APK\n\n**hxxp://lionaiothai[.]com** URL Malware\ndistribution\nsite\n\n**hxxp://cmnb9[.]cc** URL C&C server\nused to\nreceive\ncommands\nand send\nstolen data\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2023/2023-01-19 - Gigabud RAT- New Android RAT Masquerading as Government Agencies.pdf"
    ],
    "report_names": [
        "2023-01-19 - Gigabud RAT- New Android RAT Masquerading as Government Agencies.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1680660581,
    "ts_updated_at": 1743041120,
    "ts_creation_date": 1680512036,
    "ts_modification_date": 1680512036,
    "files": {
        "pdf": "https://archive.orkl.eu/98aeb53d74ac58172b3ef239192c7e33010147c7.pdf",
        "text": "https://archive.orkl.eu/98aeb53d74ac58172b3ef239192c7e33010147c7.txt",
        "img": "https://archive.orkl.eu/98aeb53d74ac58172b3ef239192c7e33010147c7.jpg"
    }
}