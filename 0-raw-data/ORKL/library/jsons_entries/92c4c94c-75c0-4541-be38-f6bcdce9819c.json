{
    "id": "92c4c94c-75c0-4541-be38-f6bcdce9819c",
    "created_at": "2023-01-12T15:00:14.87462Z",
    "updated_at": "2025-03-27T02:13:34.655169Z",
    "deleted_at": null,
    "sha1_hash": "4cf70a43407ee73d85327de6efb3ae322d4d3e0b",
    "title": "2020-11-26 - Cybereason vs. Egregor Ransomware",
    "authors": "",
    "file_creation_date": "2022-05-28T18:25:38Z",
    "file_modification_date": "2022-05-28T18:25:38Z",
    "file_size": 2361629,
    "plain_text": "# Cybereason vs. Egregor Ransomware\n\n**cybereason.com/blog/cybereason-vs-egregor-ransomware**\n\nWritten By\nCybereason Nocturnus\n\nNovember 26, 2020 | 5 minute read\n\n**Research by: Lior Rochberger**\n\n\n-----\n\nEgregor is a newly identified ransomware variant that was first discovered in September, 2020, and has\nrecently been identified in several sophisticated attacks on organizations worldwide, including the games\n[industry giants Crytek and Ubisoft.](https://www.zdnet.com/article/ubisoft-crytek-data-posted-on-ransomware-gangs-site/)\n\n[Similar to the Maze ransomware, Egregor’s operators run an extortion ransomware operation, where the](https://nest.cybereason.com/blog/threat-spotlight-analyzing-and-detecting-maze-ransomware-4)\ndata is stolen and stored on the attacker’s servers before it is encrypted on the users machine. Egregor is\nprobably the most aggressive ransomware family in terms of negotiation with the victims. Its operators give\nonly 72 hours to contact them. If the ransom is not paid, the data is released to the public via the attacker’s\nwebsite, “Egregor News.”\n\n_Cybereason Blocks Egregor Ransomware_\n\nThe ransomware payment is negotiated and agreed upon via a special chat function assigned to each victim.\nThe payment is received in bitcoin:\n\n_Egregor News website - published data_\n\nEgregor is believed to be a relative of another ransomware called Sekhmet that emerged in March, 2020,\nwhich shares a lot of similarities with Egregor and also some similarities with Maze.\n\nEgregor is still quite a mystery when it comes to how it is delivered in the attack and who is behind the\ncampaign. Not much is known at this point, but speculation includes theories that Egregor is the “heir to\n[Maze,” after that threat actor announced they were shutting down their operations in late October. This](https://www.bleepingcomputer.com/news/security/maze-ransomware-shuts-down-operations-denies-creating-cartel/)\nassumption is supported by the close similarities between the two - and of course the timing.\n\n## Key Findings\n\n**• Emerging Threat: In a short amount of time, Egregor ransomware caused a great damage and made**\nheadlines across the world.\n\n\n-----\n\n**• High Severity: The Cybereason Nocturnus Team assesses the threat level as HIGH given the destructive**\npotential of the attacks.\n\n**• Low-and-Slow: Prior to the deployment of the ransomware, the attackers attempt to infiltrate and move**\nlaterally throughout the organization, carrying out a fully-fledged hacking operation.\n\n**• Infection Vector via Commodity Malware: The infection seems to start with commodity malware. Based**\non a preliminary reconnaissance of data sent to the C2 servers, the operators can choose to escalate to an\ninteractive hacking operation, which ultimately causes a mass ransomware infection.\n\n**• Detected and Prevented:** [The Cybereason Defense Platform fully detects and prevents the Egregor](https://www.cybereason.com/platform)\nransomware.\n\n## Breaking Down the Attack\n\n\n-----\n\n_Egregor infection chain_\n\n## From Commodity Malware Infection to Ransomware\n\nSince Egregor is a relatively new player in the game, not many incidents involving it are covered and detailed\nhere, including information about the infection chain. The information available so far suggests that the initial\ninfection starts with a phishing email that contains a malicious macro embedded in an attached document.\n\n[The macro code downloads a commodity malware, either Qbot](https://malpedia.caad.fkie.fraunhofer.de/details/win.qakbot) [icedID or](https://malpedia.caad.fkie.fraunhofer.de/details/win.icedid) [Ursnif, which provides capabilities](https://malpedia.caad.fkie.fraunhofer.de/details/win.gozi)\nfor stealing sensitive information that will later be used for lateral movement. This technique, which involves\nusing a commodity malware as initial infection and to eventually deliver ransomware, was observed before\nwith [Ryuk ransomware and Maze.](https://www.cybereason.com/blog/triple-threat-emotet-deploys-trickbot-to-steal-data-spread-ryuk-ransomware)\n\n\n-----\n\nLater in the attack, a [CobaltStrike beacon is installed on the infected machine and the attack shifts to an](https://www.cobaltstrike.com/)\n[interactive hacking operation. The attacker uses tools for reconnaissance such as Adfind and](http://www.joeware.net/freetools/tools/adfind/) [Sharphound to](https://github.com/BloodHoundAD/SharpHound)\ngather information about users, groups, computers and so on. This information will assist in the lateral\nmovement phase and also in performing privilege escalation, as Egregor compromises Active Directory in\norder to become domain admin.\n\nIn this stage, after the malware settles on the victim’s machine, it starts communications to the C2 in order to\ndownload additional components including scripts, DLLs and other files that will be used eventually to\nexfiltrate data and encrypt files.\n\nAmong the dropped files observed:\n\n**A batch file that is used to run Bitsadmin and Rundll to download and execute the Egregor payload.**\n\n**[A Zip file contains a binary file that is an RClone client, renamed svchost, and RClone config files](https://rclone.org/)**\n(webdav, ftp and dropbox) used later for exfiltration.\n\n_VT screenshot of the RClone executable and configuration file_\n\nCobaltStrike creates a service that runs an encoded PowerShell command that executes shellcode that\ncreates connection to amajai-technologies[.]industries:\n\n\n-----\n\n_Decryption of the Shellcode_\n\nAfter dropping the files needed for the attack, the attackers “prepare the ground” and undertake a final\nprocedure meant to avoid detection and prevention. The attacker creates a Group Policy Object (GPO) to\ndisable Windows Defender and tries to take down any anti-virus products.\n\n## Egregor Execution\n\nAs described above, the operators of Egregor deploy the ransomware payload after collecting the sensitive\ninformation and setting the GPO to evade detection and prevention. To deploy the ransomware, they execute\nthe dropped batch file that, as mentioned, is used to download and execute the ransomware payload from a\nremote server:\n\n_The content of the batch file_\n\nThe Egregor payload can only be decrypted if the correct key is provided via command line argument to the\nRundll32 process, which means that the file cannot be analyzed, either manually or using a sandbox, if the\nexact same command line that the attackers used to run the ransomware isn’t provided.\n\nIn order to execute the ransomware and decrypt the blob of code inside of it, the operators provide the batch\nfile with the key “-passegregor10” which resolves in the ransomware running and encrypting files:\n\n\n-----\n\n_Batch file execution as shown in the Cybereason Defense Platform_\n\nThe encrypted file names are appended with a string of random characters as the new extension. For\nexample, it renames a file named “My_files.zip” to “My_files.zip.IAsnM”, “My_files2.zip” to\n“My_files2.zip.WZlF” and so on. Also, the threat actor creates the “RECOVER-FILES.txt” with ransom note in\nall folders that contain encrypted files, as shown in the figure below:\n\n_Encrypted files_\n\n\n-----\n\n_A message shown the the user_\n\n## Connection to Sekhmet and Maze\n\nEgregor shares code similarities with Sekhmet ransomware, as well as the notorious Maze ransomware.\nBesides code similarities, the tree ransomware has a lot in common, including behaviour and characteristics:\n\n**Maze** **Sekhmet** **Egregor**\n\n**First seen** May 2019 March 2020 July 2020\n\n**File type** DLL/EXE DLL DLL\n\n\n**Encrypted**\n**Files**\n**Extension**\n\n**Encryption**\n**Algorithm**\n\n\nFiles are appended with\nrandom extensions,\nconsisting of random\ncharacters\n\n\nFiles are appended with\nrandom extensions,\nconsisting of random\ncharacters\n\n\nFiles are appended with\nrandom extensions,\nconsisting of random\ncharacters\n\n\nChaCha & RSA ChaCha & RSA ChaCha & RSA\n\n\n-----\n\n**Ransom**\n**Demand**\n**Message file**\n**name**\n\n\nDECRYPT-FILES.txt RECOVER-FILES.txt RECOVER-FILES.txt\n\n\n**Damage** Encryption and extortion Encryption and extortion Encryption and extortion\n\n\n**Cyber**\n**Criminal**\n**Contact**\n\n**Website**\n**name**\n\n\nTor browser website Tor browser website Tor browser website\n\nMaze News Leaks, Leaks, Leaks. Egregor News\n\n\nAnother way to search for the connection between the three is to look at the infrastructure. The IP address\n[185.238.0[.]233 different binaries, Zip files and scripts:](https://www.virustotal.com/gui/ip-address/185.238.0.233/relations)\n\n- Maze ransomware binaries\n\n- Egregor ransomware binaries\n\n- Zip files contains the RClone binary and configuration files\n\nThe IP address is referred to by different scripts including the batch files that download the Egregor payload:\n\n_Chart describing the different samples found on 185.238.0[.]233_\n\n\n-----\n\nIt is also worth mentioning the similarities in the ransom notes of the three. They have a very similar\nstructure, and even some “copy-paste” parts:\n\n_Comparison between the three ransomware’s ransom notes_\n\nIn addition to the Maze and Egregor binaries found on this specific server, other samples were found on the\n[server, related to Prolock ransomware, as analyzed in this report.](https://www.intrinsec.com/egregor-prolock/)\n\n## Cybereason Detection and Prevention\n\n\n-----\n\nCybereason is able to both detect and prevent the execution of Egregor, Sekhmet and Maze using the NGAV\ncomponent. When the Anti-Ransomware feature is enabled, behavioral detection techniques in the platform\nare able to detect the attempt to encrypt files and raise a Malop for it:\n\n_Ransomware malop triggered due_\n\n_to the malicious activity_\n\nUsing the Anti-Malware feature with the right configuration (listed in the recommendations below),\nCybereason will also detect and prevent the execution of the ransomware and ensure that it cannot encrypt\ntargeted files:\n\n_Anti Malware alert - Disinfecting the b.dll (Egregor payload)_\n\n_User notification, Blocking the_\n\n_execution of the ransomware in the endpoint_\n\n## Indicators of Compromise\n\n**IOC** **Type** **Description**\n\n\n-----\n\nf7bf7cea89c6205d78fa42d735d81c1e5c183041\n\n5a346fb957abeba389424dc57636edcacc58b5ba\n\n901cee60fba225baf80c976b10dfa1684a73f5ee\n\na6259615ea10c30421e83d20f4a4b5f2c41b45b8\n\n03cdec4a0a63a016d0767650cdaf1d4d24669795\n\n4ea064f715c2a5f4ed68f57029befd8f406671dd\n\nac634854448eb8fcd3abf49c8f37cd21f4282dde\n\n7bc6c2d714e88659b26b6b8ed6681b1f91eef6af\n\n0579da0b8bfdfce7ca4a45baf9df7ec23989e28b\n\n3a33de9a84bbc76161895178e3d13bcd28f7d8fe\n\nf7bf7cea89c6205d78fa42d735d81c1e5c183041\n\n986f69a43e0bf174f73139785ec8f969acf5aa55\n\nf1603f1ddf52391b16ee9e73e68f5dd405ab06b0\n\n5a346fb957abeba389424dc57636edcacc58b5ba\n\n901cee60fba225baf80c976b10dfa1684a73f5ee\n\na6259615ea10c30421e83d20f4a4b5f2c41b45b8\n\n4ea064f715c2a5f4ed68f57029befd8f406671dd\n\nac6d919b313bbb18624d26745121fca3e4ae0fd3\n\n95aea6b24ed28c6ad13ec8d7a6f62652b039765e\n\na786f383dfb90191aa2ca86ade68ee3e7c088f82\n\n631924a3567390a081dbd82072a6fc3a185c5073\n\n1be22505a25f14fff1e116fafcaae9452be325b1\n\na2d5700def24c3ae4d41c679e83d93513259ae4a\n\n45.153.242.129\n\n185.238.0.233\n\n49.12.104.241\n\n\nSHA1 Egregor DLL\n\nSHA1 Egregor batch file\n\nIPs C2\n\n\n34a466a0e55a930d8d7ecd1d6e6c9c750082a5fe SHA1 Zip containing RClone\n\n2edaa3dd846b7b73f18fa638f3e1bc3a956affa4 SHA1 Encoded PowerShell\n\n## MITRE ATT&CK BREAKDOWN\n\n\n-----\n\n**Initial**\n**Access**\n\n\n**Privilege**\n**Escalation**\n\n\n**Defense**\n**Evasion**\n\n**Group Policy**\n**Modification**\n\n**Impair**\n**Defenses**\n\n**Impair**\n**Defenses:**\n**Disable or**\n**Modify Tools**\n\n\n**Command**\n**and**\n**Control**\n\n**Ingress**\n**[Tool](https://attack.mitre.org/techniques/T1105/)**\n**Transfer**\n\n\n**Discovery** **Lateral**\n**Movement**\n\n\n**Account**\n**Discovery**\n\n**Domain**\n**[Trust](https://attack.mitre.org/techniques/T1482/)**\n**Discovery**\n\n**Permission**\n**[Groups](https://attack.mitre.org/techniques/T1069/)**\n**Discovery**\n\n\n**Exfiltration** **Impact**\n\n\n**[Phishing](https://attack.mitre.org/techniques/T1566/)** **Valid**\n**Accounts**\n\nAbout the Author\n\n**Cybereason Nocturnus**\n\n\n**Remote**\n**Services**\n\n\n**Exfiltration**\n**[Over Web](https://attack.mitre.org/techniques/T1567/)**\n**Service**\n\n**Exfiltration**\n**[Over Web](https://attack.mitre.org/techniques/T1567/002/)**\n**Service**\n\n\n**Data**\n**[Encrypted](https://attack.mitre.org/techniques/T1486/)**\n**for Impact**\n\n\n**[Masquerading](https://attack.mitre.org/techniques/T1036/003/)** **Permission**\n**Groups**\n**[Discovery:](https://attack.mitre.org/techniques/T1069/001/)**\n**Local**\n**Groups**\n\n\nThe Cybereason Nocturnus Team has brought the world’s brightest minds from the military, government\nintelligence, and enterprise security to uncover emerging threats across the globe. They specialize in\nanalyzing new attack methodologies, reverse-engineering malware, and exposing unknown system\nvulnerabilities. The Cybereason Nocturnus Team was the first to release a vaccination for the 2017 NotPetya\nand Bad Rabbit cyberattacks.\n\n[All Posts by Cybereason Nocturnus](https://www.cybereason.com/blog/authors/cybereason-nocturnus)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2020/2020-11-26 - Cybereason vs. Egregor Ransomware.pdf"
    ],
    "report_names": [
        "2020-11-26 - Cybereason vs. Egregor Ransomware.pdf"
    ],
    "threat_actors": [
        {
            "id": "610a7295-3139-4f34-8cec-b3da40add480",
            "created_at": "2023-01-06T13:46:38.608142Z",
            "updated_at": "2025-03-27T02:00:02.87217Z",
            "deleted_at": null,
            "main_name": "Cobalt",
            "aliases": [
                "Cobalt Gang",
                "GOLD KINGSWOOD",
                "COBALT SPIDER",
                "G0080",
                "Mule Libra",
                "Cobalt Group"
            ],
            "source_name": "MISPGALAXY:Cobalt",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "08c8f238-1df5-4e75-b4d8-276ebead502d",
            "created_at": "2023-01-06T13:46:39.344081Z",
            "updated_at": "2025-03-27T02:00:03.056208Z",
            "deleted_at": null,
            "main_name": "Copy-Paste",
            "aliases": [],
            "source_name": "MISPGALAXY:Copy-Paste",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673535614,
    "ts_updated_at": 1743041614,
    "ts_creation_date": 1653762338,
    "ts_modification_date": 1653762338,
    "files": {
        "pdf": "https://archive.orkl.eu/4cf70a43407ee73d85327de6efb3ae322d4d3e0b.pdf",
        "text": "https://archive.orkl.eu/4cf70a43407ee73d85327de6efb3ae322d4d3e0b.txt",
        "img": "https://archive.orkl.eu/4cf70a43407ee73d85327de6efb3ae322d4d3e0b.jpg"
    }
}