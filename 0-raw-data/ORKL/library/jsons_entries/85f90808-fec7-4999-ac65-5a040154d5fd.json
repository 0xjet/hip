{
    "id": "85f90808-fec7-4999-ac65-5a040154d5fd",
    "created_at": "2023-01-12T15:00:18.926693Z",
    "updated_at": "2025-03-27T02:06:06.113478Z",
    "deleted_at": null,
    "sha1_hash": "a5b94746a13e24405a38bc272cfec8feb3ca6fbb",
    "title": "2016-10-24 - Evasive Malware Detects and Defeats Virtual Machine Analysis",
    "authors": "",
    "file_creation_date": "2022-05-28T21:53:13Z",
    "file_modification_date": "2022-05-28T21:53:13Z",
    "file_size": 183694,
    "plain_text": "# Evasive Malware Detects and Defeats Virtual Machine Analysis\n\n**[lastline.com/blog/evasive-malware-detects-and-defeats-virtual-machine-analysis/](https://www.lastline.com/blog/evasive-malware-detects-and-defeats-virtual-machine-analysis/)**\n\nOctober 24, 2016\n\nPosted by [Lastline ON OCT 24, 2016](https://www.lastline.com/author/jrivenbark/)\n\n_Advanced malware solutions (“sandboxes”) traditionally use virtual machines (VM) to_\n_analyze suspicious objects to find out if they are malicious. However, advanced malware is_\n_capable of detecting the presence of the virtual machine technology used by conventional_\n_sandboxes and leveraging this weakness to evade detection._\n\nSandbox technologies typically leverage VM environments like VMware, Xen, Parallels/Odin\nand VDI. This allows a user or an administrator to run one or more “guest” operating systems\non top of another “host”operating system. Each guest operating system executes within an\nemulated environment and allows managed access to both virtual and actual hardware. In\ntheory, the environment provided by the VM is self-contained, isolated, and indistinguishable\nfrom a “real” machine.\n\nVM technology has long been considered an effective approach for analyzing malware\nbecause it provides an isolated environment or sandbox where the malware can be triggered\nand monitored. However, today’s advanced malware is more sophisticated and is quite\ncapable of evaluating a VM environment and tailoring its actions to avoid detection.\n\n**_Advanced Malware Easily Detects VM Environments_**\n\nConventional sandbox analysis inserts artifacts into the guest operating system, which allows\nadvanced malware to determine if a system is running in a virtual environment. Here are\nsome of the techniques used by malware to recognize VM environments:\n\n\n-----\n\nExamining registry keys for values that are unique to virtual systems. In VMware, there\nare over 300 references in the registry to “VMware”.\nLooking to see if VM tools are installed. In a VMware Windows Workstation, there are\nover 50 references in the file system to “VMware” or “vmx”.\nChecking for certain process and services that are specific to VM environments such\nas VMwareService.exe, VMwareTray.exe, etc.\nIdentifying the BIOS serial number or MAC address of the virtual network adapter to\nreveal the vendor. For example, MAC addresses beginning with 00-05-69, 00-0c-29,\n00-1c-14 or 00-50-56 are associated with VMware.\nAnalyzing specific structures within system Memory, such as the Store Interrupt\nDescriptor Table (SIDT), Store Local Descriptor Table (SLDT) and Store Task Register\n(STR). These tables are located in different areas for VM environments compared with\nphysical machines.\nExamining specific hardware parameters that are unique to either VM or real physical\nenvironments. Advanced malware may query various attributes like serial numbers or\nother values belonging to the motherboard, processor, SCSI controller, etc.\n\nIt has become easier for malware to detect its target environment and take evasive action\nbecause many of the toolkits designed to perform VM analysis are readily available to those\nwho create malware. Not surprisingly, as malware becomes more sophisticated, enterprise\nsystems become more vulnerable to destructive cyber attacks.\n\n**_Advanced Malware Alters Its Behavior When a VM is Detected_**\n\nOnce modern malware detects a virtual machine, it can alter its behavior to avoid detection\nby using some of the following tactics:\n\nThe injection or modification of code within other applications will be suspended until\noperating outside of the VM.\nAdvancements to establish persistence and download additional code will be put on\nhold.\nMalicious code will remain encrypted or otherwise hidden.\nAttempts to move laterally within the network will be suspended until the malware is\noperating outside of the sandbox or VM.\nConnections to the malware’s command and control servers (CNC) will be avoided.\n\nBy modifying its behavior, malware can avoid detection by traditional or first-generation\nsecurity solutions running in virtualized environments.\n\nUnlike conventional sandboxing solutions, the next-generation Lastline products possess an\nentirely different architecture that does not produce artifacts, making it more difficult for\nmalware to determine its location. In fact, the Lastline solution is specifically designed to\ndetect advanced malware, even when it uses sophisticated evasion techniques.\n\n\n-----\n\n[Click here to learn more about the Lastline solution.](https://www.lastline.com/platform/security-breach-detection)\n\nAbout\nLatest Posts\n\n## Lastline\n\n**[Latest posts by Lastline (see all)](https://www.lastline.com/author/jrivenbark/)**\n\nLastline Boosts SOC Efficiency by 100%, Effectively Doubling Productivity of SOC\nTeams - May 21, 2020\n[Lastline Named as One of the Best Places to Work - February 20, 2020](https://www.lastline.com/press/lastline-named-best-places-to-work/)\n[Don’t Hate Your Legacy IDPS – Replace It - February 3, 2020](https://www.lastline.com/blog/dont-hate-your-legacy-idps-replace-it/)\n\nTags:\n\n[Advanced Malware Detection,](https://www.lastline.com/tag/advanced-malware-detection/) [Avoid Detection,](https://www.lastline.com/tag/avoid-detection/) [Cyberattack,](https://www.lastline.com/tag/cyberattack/) [Evasive Malware,](https://www.lastline.com/tag/evasive-malware/) [Sandboxing,](https://www.lastline.com/tag/sandboxing/)\n[VM](https://www.lastline.com/tag/vm/)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2016/2016-10-24 - Evasive Malware Detects and Defeats Virtual Machine Analysis.pdf"
    ],
    "report_names": [
        "2016-10-24 - Evasive Malware Detects and Defeats Virtual Machine Analysis.pdf"
    ],
    "threat_actors": [
        {
            "id": "fce5181c-7aab-400f-bd03-9db9e791da04",
            "created_at": "2022-10-25T15:50:23.759799Z",
            "updated_at": "2025-03-27T02:00:55.540135Z",
            "deleted_at": null,
            "main_name": "Transparent Tribe",
            "aliases": [
                "Transparent Tribe",
                "COPPER FIELDSTONE",
                "APT36",
                "Mythic Leopard",
                "ProjectM"
            ],
            "source_name": "MITRE:Transparent Tribe",
            "tools": [
                "DarkComet",
                "ObliqueRAT",
                "njRAT",
                "Peppy"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "c68fa27f-e8d9-4932-856b-467ccfe39997",
            "created_at": "2023-01-06T13:46:38.450585Z",
            "updated_at": "2025-03-27T02:00:02.836543Z",
            "deleted_at": null,
            "main_name": "Operation C-Major",
            "aliases": [
                "C-Major",
                "Transparent Tribe",
                "Mythic Leopard",
                "ProjectM",
                "APT 36",
                "TMP.Lapis",
                "Green Havildar",
                "COPPER FIELDSTONE",
                "APT36",
                "Earth Karkaddan",
                "Storm-0156"
            ],
            "source_name": "MISPGALAXY:Operation C-Major",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "abb24b7b-6baa-4070-9a2b-aa59091097d1",
            "created_at": "2022-10-25T16:07:24.339942Z",
            "updated_at": "2025-03-27T02:02:10.179404Z",
            "deleted_at": null,
            "main_name": "Transparent Tribe",
            "aliases": [
                "APT 36",
                "APT-C-56",
                "Copper Fieldstone",
                "Earth Karkaddan",
                "Green Havildar",
                "Mythic Leopard",
                "Operation C-Major",
                "Operation Honey Trap",
                "Operation Transparent Tribe",
                "ProjectM",
                "STEPPY-KAVACH",
                "Storm-0156",
                "TEMP.Lapis",
                "Transparent Tribe"
            ],
            "source_name": "ETDA:Transparent Tribe",
            "tools": [
                "Amphibeon",
                "Android RAT",
                "Bezigate",
                "Bladabindi",
                "Bozok",
                "Bozok RAT",
                "BreachRAT",
                "Breut",
                "CapraRAT",
                "CinaRAT",
                "Crimson RAT",
                "DarkComet",
                "DarkKomet",
                "ElizaRAT",
                "FYNLOS",
                "Fynloski",
                "Jorik",
                "Krademok",
                "Limepad",
                "Luminosity RAT",
                "LuminosityLink",
                "MSIL",
                "MSIL/Crimson",
                "Mobzsar",
                "MumbaiDown",
                "Oblique RAT",
                "ObliqueRAT",
                "Peppy RAT",
                "Peppy Trojan",
                "Quasar RAT",
                "QuasarRAT",
                "SEEDOOR",
                "Scarimson",
                "SilentCMD",
                "Stealth Mango",
                "UPDATESEE",
                "USBWorm",
                "Waizsar RAT",
                "Yggdrasil",
                "beendoor",
                "klovbot",
                "njRAT"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535618,
    "ts_updated_at": 1743041166,
    "ts_creation_date": 1653774793,
    "ts_modification_date": 1653774793,
    "files": {
        "pdf": "https://archive.orkl.eu/a5b94746a13e24405a38bc272cfec8feb3ca6fbb.pdf",
        "text": "https://archive.orkl.eu/a5b94746a13e24405a38bc272cfec8feb3ca6fbb.txt",
        "img": "https://archive.orkl.eu/a5b94746a13e24405a38bc272cfec8feb3ca6fbb.jpg"
    }
}