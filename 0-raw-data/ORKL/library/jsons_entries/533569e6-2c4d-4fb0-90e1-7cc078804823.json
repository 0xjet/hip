{
    "id": "533569e6-2c4d-4fb0-90e1-7cc078804823",
    "created_at": "2023-04-05T02:08:25.242466Z",
    "updated_at": "2025-03-27T02:11:06.323657Z",
    "deleted_at": null,
    "sha1_hash": "c619cfc6fc99d9616d795ab78d617c9db374070c",
    "title": "2023-03-13 - DEV-1101 enables high-volume AiTM campaigns with open-source phishing kit",
    "authors": "",
    "file_creation_date": "2023-04-03T08:31:31Z",
    "file_modification_date": "2023-04-03T08:31:31Z",
    "file_size": 1119066,
    "plain_text": "# DEV-1101 enables high-volume AiTM campaigns with open-source phishing kit\n\n**security-blog-prod-wp01.azurewebsites.net/en-us/security/blog/2023/03/13/dev-1101-enables-high-volume-aitm-**\ncampaigns-with-open-source-phishing-kit/\n\nMarch 13, 2023\n\n[Adversary-in-the-middle (AiTM) phishing kits are part of an increasing trend that is observed](https://www.microsoft.com/security/blog/2022/07/12/from-cookie-theft-to-bec-attackers-use-aitm-phishing-sites-as-entry-point-to-further-financial-fraud/)\nsupplanting many other less advanced forms of phishing. AiTM phishing is capable of\ncircumventing multifactor authentication (MFA) through reverse-proxy functionality. DEV-1101\nis an actor tracked by Microsoft responsible for the development, support, and advertising of\nseveral AiTM phishing kits, which other cybercriminals can buy or rent. The availability of\nsuch phishing kits for purchase by attackers is part of the industrialization of the\ncybercriminal economy and lowers the barrier of entry for cybercrime.\n\nDEV-1101 offers an open-source kit that automates setting up and launching phishing activity\nand provides support services to attackers. The threat actor group began offering their AiTM\nphishing kit in 2022, and since then has made several enhancements to their kit, such as the\ncapability to manage campaigns from mobile devices, as well as evasion features like\nCAPTCHA pages. These attributes make the kit attractive to many different actors who have\ncontinually put it to use since it became available in May 2022. Actors using this kit have\nvarying motivations and targeting and might target any industry or sector.\n\n[Microsoft 365 Defender detects suspicious activities related to AiTM phishing attacks and](https://www.microsoft.com/security/business/threat-protection/microsoft-365-defender)\nfollow-on activities, such as session cookie theft and attempts to use the stolen cookies to\nsign in.\n\nIn this blog post, we share information on DEV-1101, the tool they offer, and details on\nrelated AiTM campaigns. We also share best practices and detection details to further\nprotect organizations from AiTM phishing attacks.\n\n## AiTM tool promotion\n\nDEV-1101 began advertising their AiTM kit around May 2022 through a Telegram channel\nand an advertisement in exploit[.]in, a popular cybercrime forum. The advertisement\ndescribes the AiTM kit as a phishing application written in NodeJS with PHP reverse-proxy\ncapabilities, automated setup, detection evasion through an antibot database, management\nof phishing activity through Telegram bots, and a wide range of ready-made phishing pages\nmimicking services such as Microsoft Office or Outlook.\n\n\n-----\n\nOn June 12, 2022, DEV-1101 announced that the kit would be open source with a $100\nmonthly licensing fee. The actor also provided links to additional Telegram channels and a\nnow-defunct GitHub page.\n\nFigure 1. DEV-1101 announcement on their AiTM tool license\nIn September 2022, DEV-1101 added the ability to manage servers running their kit through\na Telegram bot rather than requiring the use of cPanel, further facilitating phishing activities\nand letting their customers manage campaigns from mobile devices.\n\nDEV-1101 was able to increase the price of their tool multiple times due to the rapid growth\nof their user base from July through December 2022. This allowed DEV-1101 to dedicate\nthemselves fully to the development and support of their tool. As of this writing, DEV-1101\noffers their tool for $300, with VIP licenses at $1,000. Legacy users were permitted to\ncontinue purchasing licenses at $200 prior to January 1, 2023.\n\n\n-----\n\nFigure 2. DEV-1101 increased their prices repeatedly due to rapid growth.\nMicrosoft observed several high-volume phishing campaigns from various actors using the\ntool offered by DEV-1101, comprising millions of phishing emails per day. DEV-0928, an\nactor Microsoft has tracked since September 2022, is one of DEV-1101’s more prominent\npatrons and was observed launching a phishing campaign involving over one million emails.\n\n## DEV-1101 phishing sequence\n\nDEV-1101’s many different patrons take different approaches to phishing attacks. The\nexample below is of an initial phishing message from a campaign launched by DEV-0928\nusing the DEV-1101 phishing kit. Clicking the Open button in the email leads to the next step\nin the sequence.\n\n\n-----\n\nFigure 3. Malicious link shared in a phishing message for an AiTM campaign.\nTwo different evasions might result from clicking the link in the phishing message. The DEV1101 kit’s antibot functionality might trigger an href redirection to a benign page. In this\nexample, the DEV-0928 domain o365987656898087[.]xyz redirects to example.com:\n\n\n-----\n\nFigure 4. DEV-1101 benign redirect response headers\nThe default redirection domain defined in the source code is example.com; however, any\nactor using the kit may define a different redirection domain.\n\nFigure 5. DEV-1101 benign redirect in\n\nsource-code\nThe kit also allows threat actors to use CAPTCHA to evade detection. Inserting a CAPTCHA\npage into the phishing sequence could make it more difficult for automated systems to reach\nthe final phishing page, while a human could easily click through to the next page.\n\n\n-----\n\nFigure 6. Evasion through CAPTCHA page\nWhile evasion through CAPTCHA was introduced in August 2022, the functionality then\nrequired active engagement from DEV-1101’s support to complete the setup for any\nrequesting users. DEV-1101 later added CAPTCHA as a core functionality.\n\nAfter the evasion pages, a phishing landing page is presented to the target from an actorcontrolled host through the phishing actor’s reverse proxy setup:\n\n\n-----\n\nFigure 7. Credential harvester mimicking a Microsoft sign-in portal.\nAt this point, the actor’s server captures credentials entered by the user. If the user has MFA\nenabled, the AiTM kit continues to function as a proxy between the user and the user’s signin service, meaning, as the user completes an MFA sign-in, the server captures the resulting\nsession cookie. The attacker can then bypass MFA with the session cookie and the user’s\nstolen credentials.\n\nThe following diagram illustrates the AiTM phishing attack chain:\n\n\n-----\n\nFigure 8. AiTM phishing attack diagram\nFor additional in-depth information on how AiTM phishing works, refer to the blog, From\n[cookie theft to BEC: Attackers use AiTM phishing sites as entry point to further financial](https://www.microsoft.com/security/blog/2022/07/12/from-cookie-theft-to-bec-attackers-use-aitm-phishing-sites-as-entry-point-to-further-financial-fraud/)\nfraud.\n\n## Mitigating AiTM phishing attacks\n\nWhile AiTM phishing attempts to circumvent MFA, MFA implementation remains an essential\npillar in identity security and highly effective at stopping a wide variety of threats. MFA is the\nreason that threat actors developed the AiTM session cookie theft technique in the first\nplace. Organizations are advised to work with their identity provider to ensure security\n[controls like MFA are in place. Microsoft customers can implement MFA in Azure AD through](https://www.microsoft.com/security/business/identity-access/azure-active-directory-mfa-multi-factor-authentication)\nvarious methods, such as using the Microsoft Authenticator, FIDO2 security keys, and\ncertificate-based authentication.\n\nDefenders can also complement MFA with the following solutions and best practices to\nfurther protect their organizations from such attacks:\n\n**[Use security defaults as a baseline set of policies to improve identity security posture.](https://learn.microsoft.com/azure/active-directory/fundamentals/concept-fundamentals-security-defaults)**\nFor more granular control, enable conditional access policies. [Conditional access](https://learn.microsoft.com/azure/active-directory/conditional-access/overview?ocid=magicti_ta_learndoc)\npolicies evaluate sign-in requests using additional identity-driven signals like user or\ngroup membership, IP location information, and device status, among others, and are\nenforced for suspicious sign-ins. Organizations can protect themselves from attacks\nthat leverage stolen credentials by enabling policies such as compliant devices or\ntrusted IP address requirements.\n**Implement** **[continuous access evaluation.](https://learn.microsoft.com/azure/active-directory/conditional-access/concept-continuous-access-evaluation?ocid=magicti_ta_learndoc)**\n\n\n-----\n\n**Invest in advanced anti-phishing solutions thatmonitor and scan incoming emails**\nand visited websites. For example, organizations can leverage web browsers that\n[automatically identify and block malicious websites, including those used in this](https://learn.microsoft.com/deployedge/microsoft-edge-security-smartscreen?ocid=magicti_ta_learndoc)\nphishing campaign, and solutions that detect and block malicious emails, links, and\nfiles.\n**Continuously monitor suspicious or anomalous activities. Hunt for sign-in**\nattempts with suspicious characteristics (for example, location, ISP, user agent, and\nuse of anonymizer services).\n\n## Detection details and hunting queries\n\n### Microsoft 365 Defender\n\nBecause AiTM phishing attacks are complex threats, they require solutions that leverage\n[signals from multiple sources. Microsoft 365 Defender uses its cross-domain visibility to](https://www.microsoft.com/security/business/threat-protection/microsoft-365-defender)\ndetect malicious activities related to AiTM, such as session cookie theft and attempts to use\nstolen cookies for signing in.\n\n[Using Microsoft Defender for Cloud Apps connectors, Microsoft 365 Defender raises AiTM-](https://learn.microsoft.com/defender-cloud-apps/enable-instant-visibility-protection-and-governance-actions-for-your-apps)\nrelated alerts in multiple scenarios. For Azure AD customers using Microsoft Edge, attempts\nby attackers to replay session cookies to access cloud applications are detected by Defender\n[for Cloud Apps connectors for Office 365 and](https://learn.microsoft.com/defender-cloud-apps/connect-office-365) [Azure. In such scenarios, Microsoft 365](https://learn.microsoft.com/defender-cloud-apps/connect-azure)\nDefender raises the following alert:\n\nStolen session cookie was used\n\nIn addition, signals from these Defender for Cloud Apps connectors, combined with data\nfrom the Defender for Endpoint network protection capabilities, also triggers the following\nMicrosoft 365 Defender alert on Azure AD environments:\n\nPossible AiTM phishing attempt\n\n[A specific Defender for Cloud Apps connector for Okta, together with Defender for Endpoint,](https://learn.microsoft.com/defender-cloud-apps/connect-okta)\nalso helps detect AiTM attacks on Okta accounts using the following alert:\n\nPossible AiTM phishing attempt in Okta\n\nIn addition, Microsoft 365 Defender has the following related alerts for activity related to the\nDEV-0928 threat actor, as well as high-risk Azure AD sign-in activity:\n\nDEV-0928 activity group\nSuspicious network connection to AiTM phishing site\nConnection to Adversary-in-the-Middle (AiTM) phishing site\n\n\n-----\n\n### Microsoft Sentinel\n\nMicrosoft Sentinel customers can use the following Microsoft Sentinel Analytics template to\nidentify potential AiTM phishing attempts:\n\n[Possible AiTM Phishing Attempt Against Azure AD](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/SecurityThreatEssentialSolution/Analytic%20Rules/PossibleAiTMPhishingAttemptAgainstAAD.yaml)\n\nThis detection uses signals from Azure AD Identity Protection, specifically it looks for\nsuccessful sign ins that have been flagged as high risk, and then combines this with data\nfrom Web Proxy services such as ZScaler to identify where users might have connected to\nthe source of those sign ins immediately prior. This can indicate a user interacting with a\nAiTM phishing site and having their session hijacked. This detection uses the Advanced\nSecurity Information Model (ASIM) Web Session schema. More details on the schema and\nits requirements can be found in the documentation:\n[https://learn.microsoft.com/azure/sentinel/normalization-schema-web](https://learn.microsoft.com/azure/sentinel/normalization-schema-web)\n\nIn addition, customers can use the following identity-focused Analytics and Hunting Queries\nto detect and investigate anomalous sign-in events that may be indicative of a compromised\nuser identity being accessed by a threat actor:\n\nMicrosoft Sentinel customers can also use the data provided by Microsoft Sentinel’s UEBA\nengine to hunt for anomalous login events such as where the ISP being logged in from is not\ncommonly seen in the tenant, or if the user agent is uncommon amongst the user’s peer\ngroup. More details on Microsoft Sentinel UEBA feature can be found here:\n[https://learn.microsoft.com/azure/sentinel/ueba-reference.](https://learn.microsoft.com/azure/sentinel/ueba-reference)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2023/2023-03-13 - DEV-1101 enables high-volume AiTM campaigns with open-source phishing kit.pdf"
    ],
    "report_names": [
        "2023-03-13 - DEV-1101 enables high-volume AiTM campaigns with open-source phishing kit.pdf"
    ],
    "threat_actors": [
        {
            "id": "81dde5cc-c29f-430d-8c6e-e5e92d5015e7",
            "created_at": "2022-10-25T16:07:23.704358Z",
            "updated_at": "2025-03-27T02:02:09.932453Z",
            "deleted_at": null,
            "main_name": "Harvester",
            "aliases": [],
            "source_name": "ETDA:Harvester",
            "tools": [
                "Agentemis",
                "Cobalt Strike",
                "CobaltStrike",
                "Graphon",
                "Metasploit",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "365bac8c-8533-4940-a1ef-acacb7d9d954",
            "created_at": "2023-11-21T02:00:07.343329Z",
            "updated_at": "2025-03-27T02:00:03.238974Z",
            "deleted_at": null,
            "main_name": "DEV-0928",
            "aliases": [],
            "source_name": "MISPGALAXY:DEV-0928",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "8016dbe8-de00-43c6-9a18-5cf04cc81920",
            "created_at": "2024-02-02T02:00:04.075851Z",
            "updated_at": "2025-03-27T02:00:03.308248Z",
            "deleted_at": null,
            "main_name": "Storm-1101",
            "aliases": [
                "DEV-1101"
            ],
            "source_name": "MISPGALAXY:Storm-1101",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1680660505,
    "ts_updated_at": 1743041466,
    "ts_creation_date": 1680510691,
    "ts_modification_date": 1680510691,
    "files": {
        "pdf": "https://archive.orkl.eu/c619cfc6fc99d9616d795ab78d617c9db374070c.pdf",
        "text": "https://archive.orkl.eu/c619cfc6fc99d9616d795ab78d617c9db374070c.txt",
        "img": "https://archive.orkl.eu/c619cfc6fc99d9616d795ab78d617c9db374070c.jpg"
    }
}