{
    "id": "f1e1a0f1-7584-43e6-a684-757df454c9e8",
    "created_at": "2023-01-12T15:04:11.790376Z",
    "updated_at": "2025-03-27T02:08:40.300737Z",
    "deleted_at": null,
    "sha1_hash": "907fa3ab2bcf415522c42cf5c8fab0d88a0dad97",
    "title": "2019-12-02 - God save the Queen [...] 'cause Ransom is money - SaveTheQueen Encryptor",
    "authors": "",
    "file_creation_date": "2022-05-28T01:28:14Z",
    "file_modification_date": "2022-05-28T01:28:14Z",
    "file_size": 765627,
    "plain_text": "# God save the Queen [...] 'cause Ransom is money - SaveTheQueen Encryptor\n\n**[dissectingmalwa.re/god-save-the-queen-cause-ransom-is-money-savethequeen-encryptor.html](https://dissectingmalwa.re/god-save-the-queen-cause-ransom-is-money-savethequeen-encryptor.html)**\n\nMon 02 December 2019 in [Ransomware](https://dissectingmalwa.re/category/ransomware.html)\n\nHonestly I couldn't decide between the title above and \"All crimes are paid\", but Sex Pistols\nfans will get it regardless Â¯\\(ãƒ„)/Â¯\n\nI found this sample while browsing the new public submissions on AnyRun on the 1st of\nDecember. It peaked my interest because there were just three samples of it on the platform\nat the time of writing this and they were all uploaded very recently.\n\n**_A general disclaimer as always: downloading and running the samples linked below_**\n**_will lead to the encryption of your personal data, so be f$cking careful. Also check_**\n**_with your local laws as owning malware binaries/ sources might be illegal depending_**\n**_on where you live._**\n\n[SaveTheQueen @ AnyRun |](https://app.any.run/tasks/2821049e-3bc8-4225-8ef7-ae9fde3d576b/) [VirusTotal |](https://www.virustotal.com/gui/file/3c9f777654a45eb6219f12c2ad10082043814389a4504c27e5aec752a8ee4ded/detection) [HybridAnalysis -->](https://www.hybrid-analysis.com/sample/3c9f777654a45eb6219f12c2ad10082043814389a4504c27e5aec752a8ee4ded/5ddc1e8586b8c95ec2571896) `sha256`\n```\n3c9f777654a45eb6219f12c2ad10082043814389a4504c27e5aec752a8ee4ded\n\n```\nAs always one of my go to tools is DetectItEasy. In this case it tells us that we are dealing\nwith a .NET Application and you know what that means: Let's whip out the .NET Analysis VM\nand take a look.\n\n\n-----\n\nThis looks pretty promising. Because .NET Code is not compiled to Machine Language\ndirectly but rather to the Common Intermediate Language (CIL) just in time we can inspect it\n[without the need for a disassembler with Telerik JustDecompile or](https://www.telerik.com/products/decompiler.aspx) [dnSpy.](https://github.com/0xd4d/dnSpy)\n\nLooking at the Output it looks like we have a Powershell Script in front of us that has been\n[run through PS2EXE, a kind of \"converter\" (a wrapper to be more precise) for ps1 scripts to](https://gallery.technet.microsoft.com/PS2EXE-Convert-PowerShell-9e4e07f1)\nPE executables.\n\n\n-----\n\nDecoding the Base64 string we got from the binary gets us two more blocks of what looks\nlike base64 strings and a few lines of PowerShell code between it.\n\nDecompressing one of the gzip blocks yields us a Portable Executable!\n\n\n-----\n\nThe dropped .SaveTheQueen.LOG was found in C:\\ProgramData\\. SaveTheQueen does\n**not leave a ransomnote or other information to contact the crooks.**\n```\nCLR: 2.0.50727.5420\nDrive: C:\\\n\n```\n[Because the Registry edits resemble something seen before in LockerGoga I'd like to make](https://www.trendmicro.com/vinfo/us/security/news/cyber-attacks/what-you-need-to-know-about-the-lockergoga-ransomware)\na short comparison between the two stains.\n\n**\"Feature\"** **SaveTheQueen** **LockerGoga**\n\n_Ransomnote_ none txt File in %Desktop%\n\n_Logging_ C:\\ProgramData\\SaveTheQueen.LOG C:\\.log\n\n_Registry_ Restartmanager\\Session00xx Restartmanager\\Session00xx\n\n_Binary_ .NET Visual C++\n\n### Update 19.12.2019:\n\nA new variant of the SaveTheQueen Ransomware was found the MalwareHunterTeam. I'll\nupdate this article asap.\n\nThe SaveTheQueen ransomware is ðŸ˜‚...\nThe ransomware sample -> ConfuserEx -> shellcode -> embed in C# injector dll\n(base64 encoded) -> PowerShell script (base64 + GZip) -> PS2EXE - and not even\n[sure if that's all...@demonslay335](https://twitter.com/demonslay335?ref_src=twsrc%5Etfw)\n\n[â€” MalwareHunterTeam (@malwrhunterteam) December 18, 2019](https://twitter.com/malwrhunterteam/status/1207378905386094593?ref_src=twsrc%5Etfw)\n\n\n-----\n\n## MITRE ATT&CK\n\n_T1035 --> Service Execution --> Execution_\n\n_T1215 --> Kernel Modules and Extensions --> Persistence_\n\n_T1179 --> Hooking --> Persistence_\n\n_T1055 --> Process Injection --> Privilege Escalation_\n\n_T1179 --> Hooking --> Privilege Escalation_\n\n_T1045 --> Software Packing --> Defense Evasion_\n\n_T1055 --> Process Injection --> Defense Evasion_\n\n_T1112 --> Modify Registry --> Defense Evasion_\n\n_T1179 --> Hooking --> Credential Access_\n\n_T1012 --> Query Registry --> Discovery_\n\n_T1046 --> Network Service Scanning --> Discovery_\n\n_T1120 --> Peripheral Device Discovery --> Discovery_\n\n_T1057 --> Process Discovery --> Discovery_\n\n## IOCs\n\n### SaveTheQueen\n```\nSaveTheQueen.exe --> SHA256:\n3c9f777654a45eb6219f12c2ad10082043814389a4504c27e5aec752a8ee4ded\n           SSDEEP:\n12288:a4Gvlgr3S/Jsftu5hU17WFKp4NpBvUssesKtIKy7vr4YT0PgZ304lGrDJo8YFfDY:ayw3ZwEaSAVX8Zy\n\n Registry Keys\n\n```\n\n-----\n\n```\nHKEY_CURRENT_USER\\Software\\Microsoft\\RestartManager\\Session00xx\nOwner --> 6C 0A 00 00 26 23 E1 EB AC A6 D5 01\nHKEY_CURRENT_USER\\Software\\Microsoft\\RestartManager\\Session00xx\nSessionHash --> 32 Byte Hex\nHKEY_CURRENT_USER\\Software\\Microsoft\\RestartManager\\Session00xx\nRegFiles0000 --> Files to be encrypted/stolen\nHKEY_CURRENT_USER\\Software\\Microsoft\\RestartManager\\Session00xx\nRegFilesHash --> 32 Byte Hex\n\n```\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2019/2019-12-02 - God save the Queen [...] 'cause Ransom is money - SaveTheQueen Encryptor.pdf"
    ],
    "report_names": [
        "2019-12-02 - God save the Queen [...] 'cause Ransom is money - SaveTheQueen Encryptor.pdf"
    ],
    "threat_actors": [
        {
            "id": "d90307b6-14a9-4d0b-9156-89e453d6eb13",
            "created_at": "2022-10-25T16:07:23.773944Z",
            "updated_at": "2025-03-27T02:02:09.974695Z",
            "deleted_at": null,
            "main_name": "Lead",
            "aliases": [
                "Casper",
                "TG-3279"
            ],
            "source_name": "ETDA:Lead",
            "tools": [
                "Agentemis",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "RbDoor",
                "RibDoor",
                "Winnti",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535851,
    "ts_updated_at": 1743041320,
    "ts_creation_date": 1653701294,
    "ts_modification_date": 1653701294,
    "files": {
        "pdf": "https://archive.orkl.eu/907fa3ab2bcf415522c42cf5c8fab0d88a0dad97.pdf",
        "text": "https://archive.orkl.eu/907fa3ab2bcf415522c42cf5c8fab0d88a0dad97.txt",
        "img": "https://archive.orkl.eu/907fa3ab2bcf415522c42cf5c8fab0d88a0dad97.jpg"
    }
}