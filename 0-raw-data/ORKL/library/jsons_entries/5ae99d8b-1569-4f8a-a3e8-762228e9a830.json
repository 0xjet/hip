{
    "id": "5ae99d8b-1569-4f8a-a3e8-762228e9a830",
    "created_at": "2022-10-25T16:48:13.24416Z",
    "updated_at": "2025-03-27T02:05:52.90589Z",
    "deleted_at": null,
    "sha1_hash": "1725e751dfd05d9890cf4175178b7659fa614c91",
    "title": "Matrix_Ransomware",
    "authors": "",
    "file_creation_date": "2018-11-16T13:35:34Z",
    "file_modification_date": "2018-11-16T13:35:34Z",
    "file_size": 3055003,
    "plain_text": "# Enter the Matrix\n (Ransomware)\n\n###### Luca Nagy\n Threat Researcher, Sophos Labs\n\n\n-----\n\n## Execution path\n\n\n## Execution path\n\n###### -n parameter\n\n Information collection, encryption\n\n Searching shared folders (NetShareEnum)\n\n „OurMainMutex999net”\n\n\n-----\n\n## Information collection\n\n###### V1 V2\n\n March 2018\n\n\n###### V1 V2 V2\n OS version check\n GetSidSub\n (minor, major)\n Authority\n\n 32 bit 64 bit\n\n Integrity level EqualSid check from SID\n Well-known\n SIDs\n\n March 2018\n\n\n-----\n\n## Resources\n\n\n## Resources\n\n###### CFG, CHAK, DSHC, DVCLAL, HTA, HX64, HX86, LLST MPUB, NDNF, PACKAGEINFO,\n\n PLATFORMTARGETS, PRL, RDM, TAKE, WALL, WVBS\n\n##### ChaCha20 stream cipher\n\n###### ChaCha matrix -\n initial state\n\n##### CHAK/KN\n\n###### Key, nonce\n\n Constant\n Key Nonce\n\n\n-----\n\n## ChaCha20 QuarterRound\n\n\n###### ARX operations\n\n cipher_text = plain_text XOR\n chacha_stream(key, nonce) plain_text = cipher_text XOR\n chacha_stream(key, nonce)\n\n Resource section decoder: https://github.com/lucanag/matrix_res_dec\n\n\n-----\n\n##### HX64, HX86 or HN\n\n\n##### HX64, HX86 or HN\n\n###### V2 V3\n\n#### „HN”\n\n###### Loading the HN\n resource UPX packed\n\n#### „HX86”\n\n###### Aug 2018\n\n#### „HX64”\n\n\n-----\n\n##### NDNF\n\n CFG\n\n LLST\n\n###### 2029: Azeri - Cyrill 1068: Azeri - Latin 1067: Armenian 1059: Belarusian 1088: Krygyz – Cyrillic\n\n\n##### U\n\n\n###### 2115: Uzbek – Cyrillic 1091: Uzbek – Latin 1049: Russian 1058: Ukrainian 1092: Tatar – Russia\n\n\n##### NDNF\n\n CFG\n PRL\n\n LLST\n\n###### 2029: Azeri - Cyrill 2115: Uzbek – Cyrillic 1068: Azeri - Latin 1091: Uzbek – Latin 1067: Armenian 1049: Russian 1059: Belarusian 1058: Ukrainian 1088: Krygyz – Cyrillic 1092: Tatar – Russia\n\n\n-----\n\n##### DSHC\n\n\n###### Handle Viewer\n\n\n##### DSHC\n\n###### HKLM\\SOFTWARE\\Microsoft\\Wind\n reg Thread\n ows\\CurrentVersion\\Run\n\nThread\n\n###### cmd Thread WMIC Shadowcopy delete /nointeractive\n\nThread\n\n###### vssadmin Thread Delete shadows /all /quiet\n\n##### TAKE - .cmd file\n WVBS - .vbs file\n\n###### Clears the file read-only,\n attrib archive or system-file HKCU\\Control Panel\\Desktop\\Wallpaper\n attributes\n calc\n Modifies the DACL\n\n##### WALL - .jpg file\n\nThread\n\n###### cmd\n\n takeown Recovers access to a file\n\n taskkill Kills handles\n\n\n-----\n\n## Encryption\n\n\n###### 40 byte random to\n 64 byte key\n ChaCha key and\n stream\n nonce\n CryptGenRandom() QuarterRound XOR\n\n + filesize, ChaCha key and Encrypting\n Embedded Generated Generated nonce encrypted by RSA-\n RSA-1536 RSA-1024 RSA-1024 1024 public key\n public private public\n + RSA-1024 private key encrypted by RSA-1536\n RSA-1536 public key\n private\n + filename encrypted by\n Known only by the\n ChaCha\n ransomware authors\n\n\n-----\n\n## Decryption\n\n\n## Decryption\n\n###### Generated RSA -\n 1024 private\n\n\n-----\n\n## Communication with C2\n\n\n## Communication with C2\n\n###### Aug 2018\n\n Amount of information sent\n May\n to C2\n 2018\n\n Apr 2018\n\n March\n 2018\n\n\n-----\n\n## Ransom payment method\n\n\n## Ransom payment method\n\n##### HTL - .htl file RDM - .rtf\n\n\n-----\n\n## Ransom payment method\n\n\n## Ransom payment method\n\n###### False statement\n\n\n-----\n\n10\n\n## Conclusion\n\n9\n8\n\n30\n\n7\n\n##### Submissions of Matrix Ransomware\n\n6\n\n###### [Yourencrypt@tutanota.com]\n\n5\n4\n\n25 3\n\n2\n1\n0\n\n###### [RestorFile@tutanota.com]\n\n20\n\n15\n\n###### [oken@tutanota.com]\n\n EMAN50\n FOX\n\n [Files4463@tuta.io]\n\n [Bitmine8@tutanota.com] KOK8\n\n10 FASTB\n\n###### [Vfemacry@mail-on.us]\n EMAN\n NEWRAR\n ANN CORE FASTBOB\n CORE\n\n [d3336666@tutanota.com] KOK08 MTXLOCK\n\n5 [RestoreFile@qq.com] THDA\n\n###### RAD\n\n0\n\n###### MARCH-18 APRIL-18 JULY-18 AUGUST-18 SEPTEMBER-18 MAY-18 JUNE-18\n\n\n-----\n\n### Thank you for your attention!\n\n###### Email:luca.nagy@sophos.com Twitter:@luca_nagy_\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "bf5be533-fa31-4590-ae37-5761c97ffa34",
            "created_at": "2022-10-25T16:13:58.389257Z",
            "updated_at": "2022-10-25T16:13:58.389257Z",
            "deleted_at": null,
            "name": "Malpedia",
            "url": "https://malpedia.caad.fkie.fraunhofer.de",
            "description": "Malpedia is a free service offered by Fraunhofer FKIE",
            "reports": null
        }
    ],
    "references": [
        "https://www.blackhoodie.re/assets/archive/Matrix_Ransomware_blackhoodie.pdf"
    ],
    "report_names": [
        "Matrix_Ransomware_blackhoodie.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1666716493,
    "ts_updated_at": 1743041152,
    "ts_creation_date": 1542375334,
    "ts_modification_date": 1542375334,
    "files": {
        "pdf": "https://archive.orkl.eu/1725e751dfd05d9890cf4175178b7659fa614c91.pdf",
        "text": "https://archive.orkl.eu/1725e751dfd05d9890cf4175178b7659fa614c91.txt",
        "img": "https://archive.orkl.eu/1725e751dfd05d9890cf4175178b7659fa614c91.jpg"
    }
}