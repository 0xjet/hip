{
    "id": "968477ff-1df7-48ae-912b-e0602c74d964",
    "created_at": "2023-01-12T15:07:54.398965Z",
    "updated_at": "2025-03-27T02:16:39.996346Z",
    "deleted_at": null,
    "sha1_hash": "5be4155f4dd0a3df4d272aab6d13df0cdcad235e",
    "title": "2022-01-15 - Malware Headliners- Qakbot",
    "authors": "",
    "file_creation_date": "2022-05-29T10:35:43Z",
    "file_modification_date": "2022-05-29T10:35:43Z",
    "file_size": 1243618,
    "plain_text": "# Malware Headliners: Qakbot\n\n**atomicmatryoshka.com/post/malware-headliners-qakbot**\n\nz3r0day_504 January 15, 2022\n\nQakbot is a banking trojan that has wreaked havoc for years across the world. Most recently\nit has been mostly delivered to vulnerable targets by TA542, also known as MUMMY\nSPIDER, as a third-party add-on to their own malicious campaigns.\n\nIf you're interested in the \"how-to\" of this process, check out my previous blog post [\"Malware Headliners: Dridex\"](https://www.atomicmatryoshka.com/post/malware-headliners-dridex)\n\n## INITIAL ANALYSIS\n\n_For analysis purposes, I have renamed the original file to phish1_\n\nTrID gives us the following percentage breakdown for what kind of file this is:\n\nExiftool shows us some additional metadata. Some of the values are written using Cyrillic\ncharacters, possibly indicating the geographical region of origin.\n\n\n-----\n\n## LOOKING UNDER THE HOOD\n\nMoving on to leveraging zipdump, we get the following initial output:\n\n\n-----\n\nI normally select the workbook stream first when conducting this type of analysis. In\nspreadsheets, the workbook is the \"root element for the main document part,\" according to\nMicrosoft. Below is the output when I select index 3:\n\n\n-----\n\nWhile we can derive a few items that provide context, the overall output is not very human\nreadable. The question mark icons indicate that this may be in Unicode format. If we pass\nthe right parameter to zipdump, it does the heavy lifting for us and clears things up:\n\nHere we see \"Tiposa,\" rIds, and \"Auto_Open.\" The latter means that the code will execute\nupon the document being opened.\n\nWe continue down the list of streams, and in index 4 we have the relationships table. This\nshows the relationship IDs for the workbook. Piping it to xmldump with the \"pretty\" parameter\ngives us the following output; this is information we could likely reference later in our\nanalysis.\n\n\n-----\n\nLooking at index 8, we get an output that seems to be in Unicode; piping it to strings with the\nencoding parameter gives us some useful information:\n\nWe now have a list of potential C2 IPs, along with evidence of the spreadsheet downloading\nand writing files (UrlDownloadToFileA).\n\n\n-----\n\nIndex 15 shows us that .ocx files are also involved. These files are ActiveX control files, and\ncan be leveraged for nefarious purposes such as observing a user's browsing habits,\nkeylogging, or downloading additional malware. We don't know what their exact purpose is in\nthis circumstance, but we know that they play a part in this malware's greater picture. We\nalso see \"regsvr32\" in fragments, which is used to register the ActiveX controls.\n\nIn Index 17, we see the following:\n\n.dat, or data files, are part of this ne'er-do-well mixture.\n\n## WHAT A PERFECT SIGHT\n\nThe following output may make you wonder why we even did all of the above. It's worth\nmentioning that it won't always pan out this way. In my previous analysis with Dridex, I didn't\nget this \"whole picture\" of an output, but I did get some data. XLMDeobfuscator knocked it\nout of the park here.\n\n\n-----\n\nNote: If you are trying to replicate this process and run into issues, make sure to update your\ninstance of XLMDeobfuscator to the latest version. I received an error prior to update and got\nzero data, but post data I got the following:\n\n## WHAT'S HAPPENING HERE?\n\nIn the XLMDeobfuscator screenshots, we see the code is reaching out to the IPs and pulling\ndown a .dat file. Upon download, it's naming it as a \"Dotr*.ocx\" where the wildcard can be\nreplaced with a number 1-6. From there, it uses regsvr32 to register the ActiveX controls for\nfollow-on activity.\n\n\n-----\n\n## IOCs FOR THIS ITERATION OF QAKBOT\n\n**File Hash:**\n\nSHA-256: 62bb4d89d905a988f154fcb9bd60a376cca42c1343e03b03a897d039eb8d4036\n\n**IPs:**\n\n46.105.81[.]76\n\n185.82.127[.]219\n\n101.99.90[.]108\n\n**Filenames:**\n\nPattern: 44575.516********.dat\n\n44575.51608796296.dat\n\n44575.51611111111.dat\n\n44575.51613425926.dat\n\n44575.51615740741.dat2\n\n44575.516180555554.dat2\n\n44575.5162037037.dat2\n\n**File Paths:**\n\nC:\\ProgramData\\Dotr1.ocx\n\nC:\\ProgramData\\Dotr2.ocx\n\nC:\\ProgramData\\Dotr3.ocx\n\nC:\\ProgramData\\Dotr4 ocx\n\n\n-----\n\nC:\\ProgramData\\Dotr5.ocx\n\nC:\\ProgramData\\Dotr6.ocx\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-01-15 - Malware Headliners- Qakbot.pdf"
    ],
    "report_names": [
        "2022-01-15 - Malware Headliners- Qakbot.pdf"
    ],
    "threat_actors": [
        {
            "id": "e8e18067-f64b-4e54-9493-6d450b7d40df",
            "created_at": "2022-10-25T16:07:24.515213Z",
            "updated_at": "2025-03-27T02:02:10.267637Z",
            "deleted_at": null,
            "main_name": "Mummy Spider",
            "aliases": [
                "ATK 104",
                "Gold Crestwood",
                "Mummy Spider",
                "TA542"
            ],
            "source_name": "ETDA:Mummy Spider",
            "tools": [
                "Emotet",
                "Geodo",
                "Heodo"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "2864e40a-f233-4618-ac61-b03760a41cbb",
            "created_at": "2023-12-01T02:02:34.272108Z",
            "updated_at": "2025-03-27T02:02:10.209072Z",
            "deleted_at": null,
            "main_name": "WildCard",
            "aliases": [],
            "source_name": "ETDA:WildCard",
            "tools": [
                "RustDown",
                "SysJoker"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "506404b2-82fb-4b7e-b40d-57c2e9b59f40",
            "created_at": "2023-01-06T13:46:38.870883Z",
            "updated_at": "2025-03-27T02:00:02.939775Z",
            "deleted_at": null,
            "main_name": "MUMMY SPIDER",
            "aliases": [
                "TA542",
                "GOLD CRESTWOOD"
            ],
            "source_name": "MISPGALAXY:MUMMY SPIDER",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "2ac83159-1d9d-4db4-a176-97be6b7b07c9",
            "created_at": "2024-06-19T02:03:08.024653Z",
            "updated_at": "2025-03-27T02:05:17.348806Z",
            "deleted_at": null,
            "main_name": "GOLD CRESTWOOD",
            "aliases": [
                "TA542 ",
                "Mummy Spider "
            ],
            "source_name": "Secureworks:GOLD CRESTWOOD",
            "tools": [
                "Emotet"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "75108fc1-7f6a-450e-b024-10284f3f62bb",
            "created_at": "2024-11-01T02:00:52.756877Z",
            "updated_at": "2025-03-27T02:00:55.544216Z",
            "deleted_at": null,
            "main_name": "Play",
            "aliases": null,
            "source_name": "MITRE:Play",
            "tools": [
                "Nltest",
                "AdFind",
                "PsExec",
                "Wevtutil",
                "Cobalt Strike",
                "Playcrypt",
                "Mimikatz"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "256a6a2d-e8a2-4497-b399-628a7fad4b3e",
            "created_at": "2023-11-30T02:00:07.299845Z",
            "updated_at": "2025-03-27T02:00:03.257794Z",
            "deleted_at": null,
            "main_name": "WildCard",
            "aliases": [],
            "source_name": "MISPGALAXY:WildCard",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673536074,
    "ts_updated_at": 1743041799,
    "ts_creation_date": 1653820543,
    "ts_modification_date": 1653820543,
    "files": {
        "pdf": "https://archive.orkl.eu/5be4155f4dd0a3df4d272aab6d13df0cdcad235e.pdf",
        "text": "https://archive.orkl.eu/5be4155f4dd0a3df4d272aab6d13df0cdcad235e.txt",
        "img": "https://archive.orkl.eu/5be4155f4dd0a3df4d272aab6d13df0cdcad235e.jpg"
    }
}