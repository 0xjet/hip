{
    "id": "f09ad446-43e0-4abf-99cc-fcd5b6df9c9e",
    "created_at": "2022-10-25T16:48:25.204008Z",
    "updated_at": "2025-03-27T02:16:58.138202Z",
    "deleted_at": null,
    "sha1_hash": "e915d142a54fdad173662822c32679d7e075857d",
    "title": "",
    "authors": "",
    "file_creation_date": "2016-02-05T12:11:42Z",
    "file_modification_date": "2016-02-05T12:11:42Z",
    "file_size": 1665715,
    "plain_text": "#### BOT-TREK CYBER INTELLIGENCE\n\n###### ci.group-ib.com\n\n# GROUP-IB REPORT:\n\n## ANALYSIS OF ATTACKS AGAINST TRADING AND BANK CARD SYSTEMS \n\n\n-----\n\n### Executive summary\n\nIn February 2015 the first major successful attack on a Russian trading system took place, when\nhackers gained unsanctioned access to trading system terminals using a Trojan resulting in trades\nof more than $400 million.\n\nThe criminals made purchases and sales of US dollars in the Dollar/Ruble exchange program on\nbehalf of a bank using malware. The attack itself lasted only 14 minutes, however, it managed to\ncause a high volatility in the exchange rate of between 55/62 (Buy/Sell) rubles per 1 dollar\ninstead of the 60-62 stable range.\n\n###### Losses to financial institution were estimated in the millions.\n\nTo conduct the attack criminals used the Corkow malware, also known as Metel, containing\nspecific modules designed to conduct thefts from trading systems, such as QUIK operated by\nARQA Technologies and TRANSAQ from ZAO “Screen market systems”. Corkow provided\nremote access to the ITS-Broker system terminal by «Platforma soft» Ltd., which enabled the\nfraud to be committed.\n\n###### This incident is believed to be a “test” to assess its ability to\n affect the market and earn money.\n\nIn August 2015 a new incident related to the Corkow (Metel) Trojan was detected. An attack on\na bank card systems, which included about 250 banks which used the bank card system to\nservice cash withdrawals from Visa and MasterCard cards under a special tariff. This attack\nresulted in the hundreds of millions of rubles being stolen via ATMs of the systems members.\n\nGroup-IB specialists use their unique Bot-Trek TDS threat detection system to identify Corkow and\nother threats to the corporate networks. According to our statistics, as of the beginning of 2015\nthis botnet encompassed over 250 000 infected devices worldwide including infecting more than\n100 financial institutions with 80% of them from the top 20 list. The botnet is growing daily.\n\nIt is worth noting that the majority of computers that are infected have popular antivirus software\n\n\n###### ci.group-ib.com\n\n\n-----\n\ninstalled and the companies’ internal networks are also highly protected.\n\n\n###### ci.group-ib.com\n\n\n-----\n\n###### ci.group-ib.com\n\n\nJudging by the method of infecting devices and corporate networks, Group-IB can conclude that\nall infections were conducted on a random “non-targeted” basis. However, as our previous\ninvestigations on Anunak group displayed, access to any computer on a corporate network\ngives access to even the most highly protected banking systems. The attacks against the trading\nsystem and bank card system were conducted under the same scenario and thus we can forecast\nsimilar attacks against financial institutions in Russia, EU, the Middle East, Asia and the USA in\nthe future.\n\nCorkow is the second known Trojan to be used to collect information about trading systems. The\n\ninterest among hackers in targeting trading systems is expected to grow.\n\nWe would like to express our gratitude to Fox-IT, ESET and AVG companies for their support in\nperforming this research.\n\n\n-----\n\n### Key findings\n\n###### In February 2015 the first successful attack on a trading system took\n place. The losses to this financial institution were estimated in the millions.\n\n    It was a test attack aimed at demonstrating the malwares capabilities.\n In fact, many traders were those who used the exchange volatility to\n make good money, while hackers purportedly received nothing.\n\n    The first targeted attack on a bank card system took place causing losses in the\n\n hundreds of millions of rubles.\n\n    Russian-speaking hackers are believed to be responsible for these\n attacks and used the Corkow Trojan. No secret services involvement has been detected.\n\n Various hacker groups demonstrate increased interest towards trading\n and brokerage systems and their clients, which is evidenced by the  specific modifications in malware they use. \n\n Hackers target primarily companies in Russia and CIS countries, \n\n though it is noticed that the amount of attacks targeting the USA has  increased 5 times since 2011.\n\n    Antiviruses are not capable of effectively preventing these threats. The\n majority of computers infected by this malware have antivirus installed and active. The Trojan can stay undetected in the system for more than 6 months.\n\n\n###### ci.group-ib.com\n\n\n-----\n\n### Background\n\nOne of the first botnets specializing in targeting the trading software called Quik was\n“Ranbyus”, created in 2012. Below are the examples of this botnet control panel interfaces.\nEach of them had separate sections designed to analyze computers with Quik installed.\n\n**Picture 1. Ranbyus control panel with a section for Quik users as of January 2013.**\n\n\n-----\n\n###### ci.group-ib.com\n\n\n**Picture 2. Ranbyus control panel with a section for Quik users as of May 2013.**\n\nIn 2014 Corkow had a QUIK v.1.0. module for collecting data from the Quik trading software\ndeveloped by ARQA Technologies. In 2015 Corkow’s developers updated the QUIK module\nto v.1.1. and released another module TRZQ v.1.0. to copy information from the trading\nsystem’s application TRQNSAQ developed by ZAO «Screen market systems».\n\nThe re-development of the old QUIK module and development of the new TRANSAQ module\nshow the Corkow group’s continued interest in targeting trading systems.\n\n\n-----\n\n###### ci.group-ib.com\n\n\n### Chronology of the Corkow attack against the trading system\n\nThe attack itself lasted only 14 minutes, during which all losses were sustained, however, the\npreparations for this intrusion took a much longer time.\n\nHackers gained access to a computer in the trading system in September 2014. From this time the\nTrojan was functional and constantly updated itself to avoid detection by antivirus software\ninstalled at the bank which was in functioning order. As of the Group-IB investigation of this\nmalware program in March 2015, Corkow v.7.118.1.1 had not been detected by a single\nantivirus program.\n\n**Picture 3. Chronology of the Corkow attack on the trading system**\n\nStarting in December 2014, the criminal group began running keyloggers in the infected system.\n\nOn the 27[th] of February, 2015 Corkow provided remote access to the trading system which\nenabled the hackers to launch programs and enter data at the same time as the system operator\ndid.\n\nAs a result of this unsanctioned access to the trading system terminal, the criminals made a total\nof seven purchases and sales of US dollars in the Dollar/Ruble exchange program. These\noperations were as follows:\n\n- “Market” orders which provide requests to buy or sell a specified amount of lots (for fixed\n\n\n-----\n\namount of foreign exchange) at the best prices offered in the trading system.\n\n- “Removal” orders which provide a request to purchase the largest amount of currency\npossible immediately after their registration in the trading system, and the remainder was\nremoved from the trading system.\n\n**Picture 4. Technical analysis of the trades**\n\nIn total 5 trades were made for the purchase of $437 million and two trades for the sale of $97\nmillion. However, only a small proportion of the trades were carried out in full, as a result $158\n536 000 was purchased and $93 925 000 was sold.\n\nIn the graph for trades on that day, you can see a sudden hike, showing the volatility of the\nexchange from 55 to 66 Rubles.\n\n14 minutes after the first trade request the hacker gave Corkow a command to delete itself from\nthe system along with any traces of its activity.\n\n\n-----\n\n###### ci.group-ib.com\n\n\n**Picture 5. Incident key facts**\n\n### Attack results\n\nThe hacker attack provoked abnormal volatility which lasted 6 minutes and enabled buying\ndollars for 59,0660 rubles per dollar and in 51 seconds selling dollars for 62,3490 rubles per\ndollar.\n\nTo commercialize the difference in exchange rates hackers should have had a huge amount of\nmoney. For example, even if they had had $22 million, the profit would have been only 1.3\n**million Rubles. This means the fraudsters likely conspired with some major brokerage clients to**\nhave that amount of money to buy/sell currency.\n\nThere was another potential opportunity to capitalize on the attack. With a limited amount of\nmoney at their disposal the hackers could have used the futures market where the multiplier for\nforeign exchange transactions could reach 1:20 to increase their profits 8 times. In this scheme,\nthe criminals would not have needed to illegally cooperate with trading system clients.\n\nIn fact, many ordinary traders were those who used the exchange volatility to make good\nmoney, while hackers purportedly received nothing. It is also worth noting that ordinary clients\nof the trading system attract more attention while deals on futures market could remain\nunnoticed.\n\nAs a result of the attack, the compromised bank which terminal was used for intrusion, suffered a\nhuge financial and reputational damage, since many players on the market didn’t trust the\nhacking theory of the incident and tended to believe that a simple mistake had occurred. Experts\n\n\n-----\n\nsay that many companies that were trading at the time of the attack and successfully made profit\nwhile the attackers are believed to have received no money from the operation. This evidence\nleads us to believe that these hacker actions could be a test of the ability to influence the market\nand capitalize on future attacks.\n\n\n###### ci.group-ib.com\n\n\n-----\n\n### Malware delivery method\n\nTo spread the Corkow malware criminals use a drive-by downloads method, when victims are\ninfected while visiting compromised legitimate websites. Hackers use the exploits “Nitris Exploit\nKit” (earlier known as CottonCastle), which is not available in open sources and sold only to\ntrusted users. The exploits are described in details in the Malware don’t need Coffee blog.\n\nGroup-IB specialists detected various sites used by criminals to spread the Trojan: mail tracking\nwebsites, news portals, electronic books, computer graphics resources, music portals, etc. The\nWide range of websites used during the campaign shows that criminals target their attacks\nfor maximum exposure, not limiting to corporate websites.\n\nGroup-IB Bot-trek TDS sensors are in place at a number of financial institutions and,\nunfortunately, we register that currently Corkow malware is present on 80% of protected\ncorporate systems.\n\nConsidering the Trojan delivery method and through our analysis of infections on banks’\nnetworks, we can confirm that all infections were conducted on a random basis. However, as\nour previous investigations into the Anunak group have displayed, gaining access to any\ncomputer on a corporate network gives access to even the most highly protected banking\nsystems.\n\nThe list of websites which were used to spread Corkow is presented below.\n\n\n-----\n\n###### ci.group-ib.com\n\n\n###### Total traffic on these websites exceeds 800 000 users per day.\n An average infection rate of Nuclear Exploit Kit is 11%, which\n\n means hackers could infect up to 90 computers per day,\n\n significantly increasing the size of their botnet.\n\n\n-----\n\n|Website|Category|Average traffic per day|\n|---|---|---|\n|post-tracker.ru|Mail|38 478|\n|zr.ru|Cars|112 271|\n|business-gazeta.ru|News|68 746|\n|proshkolu.ru|Education|47 249|\n|opengost.ru|State standards|8 545|\n|krokha.ru|Women's Portal|-|\n|eurolab.ua|Medicine|156 552|\n|newsdon.info|News|40 614|\n|dirt.ru|Sport|7 100|\n|anime-zone.ru|Cartoons|4 297|\n|rus.kg|News|936|\n|badger.ru|Shop|-|\n|fedpress.ru|News|25 804|\n|carsguru.net|Advertisement|52 157|\n|findfood.ru|Cookery|56 307|\n|beboss.ru|Advertisement|4 863|\n|vidal.ru|Medicine|25 678|\n|reghelp.ru|Advertisement|10 339|\n|rabotagrad.ru|Advertisement|5 581|\n|proshkolu.ru|Advertisement|-|\n|muztorg.ru|Shop|26 332|\n|mirf.ru|Magazine|5 226|\n|medgorodok.ru|Medicine|8 696|\n|dobrota.ru|Medicine|-|\n|cooksa.ru|Cooking|19 929|\n|consmed.ru|Medicine|32 712|\n|buro247.ru|Fashion|-|\n|3dmir.ru|Computer graphics|2 508|\n|novorus.info|News|40 614|\n|kidbe.ru|Women’s Portal|14 778|\n|eknigi.org|Electronic books|-|\n|2x2.su|Advertisement|-|\n\n\n**Table 1. List of websites used to spread Corkow**\n\n\n###### ci.group-ib.com\n\n\n-----\n\n### Area of attack\n\nAccording to statistics, Corkow primarily targets users in Russia and the CIS, but it is worth noting\nthat in 2014 the amount of attacks targeting the USA increased by 5 times, in comparison with\n2011. Moreover, the number of Corkow incidents detected in Q1 2015 in the United States\nexceeds the number of those in the CIS countries.\n\n**Country** **2011** **2012** **2013** **2014** **Q1 2015**\n\nRussia 61425 132327 19156 26493 4719\nUkraine 7076 9891 4558 6108 883\nBelarus 2748 1892 584 82 18\nKazakhstan 1132 1997 254 43 22\nTurkey 762 453 27 100 79\nSpain 457 164 30 160 26\nItaly 238 115 375 131 43\nMexico 209 362 33 82 44\nPeru 191 167 5 123 35\n\nPoland 181 86 28 94 33\nUnited States 164 102 49 534 159\nChile 114 192 52 36 11\nThailand 114 51 8 204 97\nArgentina 107 65 6 31 16\nGermany 107 23 30 82 26\nGreece 91 42 22 59 14\nBrazil 89 69 10 43 32\nFrance 81 65 10 79 44\n\n**Table 2. Incidents statistics per year by country**\n\n|Country|2011|2012|2013|2014|Q1 2015|\n|---|---|---|---|---|---|\n|Russia|61425|132327|19156|26493|4719|\n|Ukraine|7076|9891|4558|6108|883|\n|Belarus|2748|1892|584|82|18|\n|Kazakhstan|1132|1997|254|43|22|\n|Turkey|762|453|27|100|79|\n|Spain|457|164|30|160|26|\n|Italy|238|115|375|131|43|\n|Mexico|209|362|33|82|44|\n|Peru|191|167|5|123|35|\n|Poland|181|86|28|94|33|\n|United States|164|102|49|534|159|\n|Chile|114|192|52|36|11|\n|Thailand|114|51|8|204|97|\n|Argentina|107|65|6|31|16|\n|Germany|107|23|30|82|26|\n|Greece|91|42|22|59|14|\n|Brazil|89|69|10|43|32|\n|France|81|65|10|79|44|\n\n\n###### ci.group-ib.com\n\n\n-----\n\n###### ci.group-ib.com\n\n\n**Picture 6. Geographical distribution of Corkow infections in Q1 2015**\n\n\n-----\n\n### Attack tactics\n\nHackers first actively spread bots using the Niteris exploit, and then search for infected devices\nat banks amongst their bots by analyzing IP addresses, cracked passwords and results of the\nmodules performance.\n\nIf a bot was installed on a network that was of interest to the hacking group, this bot was then\nused to upload one of the remote access programs. In addition to the legitimate AmmyAdmin\ntool, the hackers used Visconti Backdoor developed based on legitimate RMS (remote\nmanipulator system) software. Visconti Backdoor is distributed on Russian-speaking hacker\nforums and delivers the following functionality:\n\n  - Secret installation on the targeted computers, retention in the system as legitimate\nsoftware;\n\n  - Grabbing user desktop activity; actively recording onscreen audio and video (also can\nbe performed according to established schedule);\n\n  - Keylogger;\n\n  - Remote access to the task manager, the system processes and services with applicationblocking functionality;\n\n  - Receive data on technical parameters and the operating system of the victim’s machine;\n\n  - Executing commands in CMD;\n\n  - Remote launch of files and applications on the victim’s machine;\n\n  - Collect files and buffer exchange from the victim’s machine;\n\n  - Secret remote access on behalf of the victim’s account RDP);\n\n  - Remote registry editor;\n\n  - Capability to control computer state (shutdown/restart), set sleep mode, switch monitor\noff;\n\n  - Disabling the UAC (User Account Control) system;\n\n  - Can run on any version of Windows (from XP to 10), both 32-bit and 64-bit versions;\n\n  - Can uninstall itself from the victim’s system.\n\nHackers used the remote access to detect servers of their interest in the internal network. To\nobtain logins and passwords they applied keyloggers built into Corkow, as well as a commonly\nused feature of Mimikatz, dumping clear text Windows credentials from LSA.\n\nAlso, the group used scanners aimed at searching for hosts with active VNC and Radmin\nservices in the corporate network.\n\nWhen they received access to a bank staff computer, Corkow malware was uploaded to their\ncomputer to spy on users through keylogging and transmission of screenshots.\n\n\n###### ci.group-ib.com\n\n\n-----\n\n### Malware description\n\nEach of Corkow’s modules is implemented as a library capable of downloading and\nexecuting files from a remote server, deleting files, rebooting and disrupting the system,\ncollecting data on the targeted PC and the victim’s activity (keylogging, screenshots) and\nsending this information to various addresses. Also, the malware provides a server for remote\naccess to the targeted PC.\n\nThe Corkow Trojan includes modules which are listed in table 3 below. The names of the\nmodules and their versions were received through analysis of DRAM archives in infected system.\n\n**Module** **Version** **Description**\n\nMON 1.9.0 Collects information about the computer, accounts, OS and monitors\nprocesses\nKLG 1.3.1 Keylogger\nHVNC 2.0 Provides remote access to the computer\nFG 2.0 Tracks websites visited by the user and collects authorization data\n\nQUIK 1.1 Copies data from the Quik trading system application\n\nIB2 1.3.1 Copies data from the «IBank2» application.\n\nSBRF 1.3.8 Copies data from the «Wclnt.exe» application\n\nAMY 1.4 Provides remote access to the computer using the Ammy Admin remote\niFOBS 1.6 Copies data from the «iFOBSClient.exe» application.\n\nTRZQ 1.0 Copies data from the TRANSAQ trading system\n\n**Table 3. Сorkow.dll modules**\n\n|Module MON|Version 1.9.0|Description Collects information about the computer, accounts, OS and monitors processes|\n|---|---|---|\n|KLG|1.3.1|Keylogger|\n|HVNC|2.0|Provides remote access to the computer|\n|FG|2.0|Tracks websites visited by the user and collects authorization data|\n|QUIK|1.1|Copies data from the Quik trading system application|\n|IB2|1.3.1|Copies data from the «IBank2» application.|\n|SBRF|1.3.8|Copies data from the «Wclnt.exe» application|\n|AMY|1.4|Provides remote access to the computer using the Ammy Admin remote|\n|iFOBS|1.6|Copies data from the «iFOBSClient.exe» application.|\n|TRZQ|1.0|Copies data from the TRANSAQ trading system|\n\n\n###### ci.group-ib.com\n\n\n-----\n\n### Basic functionality\n\nThe most important functions of the program are delivered in separate modules as described\nbelow:\n\nThe tool decrypts and uploads extra modules to third-party processes. The search for\nappropriate process for intrusion is launched in a separate flow, which continuously monitors\nrunning processes.\n\n  - The FG module can be injected into processes that have the following substrings inside\n\ntheir names: «firefox.exe»,\n«iexplore.exe», «chrome.exe», «opera.exe», «browser.exe», «iTunes.exe»;\n\n  - The QUIK module can be injected into processes that have the substring «info.exe» in\n\nthe name;\n\n  - The TRZQ module can be injected into processes that have the substring «transaq.exe»\n\nin the name;\n\n  - The SBRF module can be injected into processes that have the substrings «wclnt.exe»,\n\n«ip-client.exe» in the name;\n\n  - The iFOBS module can be injected into processes that have the «iFOBSClient.exe»\n\nsubstring in the name;\n\n  - The IB2 module can be injected into processes that have the substrings «java.exe»,\n\n«javaw.exe» in the name;\n\nThe MON module is unpacked inside the memory and launched as a separate flow; The\nHVNC module is also unpacked inside the memory and launched as a separate flow;\n\nThe FG module intercepts functions and collects information on keys pressed, websites\nvisited and credentials in the process. It encrypts information gathered and records it in the file\nspecified in the “File System Interaction” section;\n\nThe MON module collects information on running processes. It grabs file names, protection\nstatus (using the function “SfcIsFileProtected”), the username of the person who ran the process,\nthe process ID, launch arguments and the last user input (using the function “GetLastInputInfo”)\nand sends the information obtained to the remote server with the date stamp. It is also capable\nof taking screenshots;\n\nThe iFOBS module collects information on the application for iFOBS Internet banking. It can\ntake screenshots and copy key information;\n\n\n###### ci.group-ib.com\n\n\n-----\n\nThe SBRF module collects information on the application for Sberbank Online Internet\nbanking system;\n\nThe QUIK module can be injected into the process that has the substring «info.exe» in the\nname. This module is intended to collect data from the QUIK software, which interface provides\naccess to various electronic stock exchanges. It copies the following files to send them to the\nserver:\n\n\n###### ci.group-ib.com\n\n\n\n- «Login.dat\n\na»\n\n- «qrypto.cfg\n\n»\n\n- «ClientInfo.\n\ntxt»\n\n- «limits.dat»\n\n- «ip.cfg»\n\n- «info.ini»\n\n\n\n- «ka_pr.ini»\n\n- «qcrypto.ini»\n\n- «randseed.bin»\n\n- «quik.txk»\n\n- «Pubring.txk»\n\n- «Secring.txk»\n\n\n-----\n\nAlso it copies file keys from the folder «/Keys» of the application directory.\n\n##### • The HVNC module can provide remote access to a PC with the malicious program\ninstalled. It creates remote user session and extra desktop in OS Windows to provide remote\nmanagement service. Thus, the actions of this module will be hidden from the PC user. After the\nmodule is unpacked and launched, it sends the information on PC, user, OS and module\nversion to the C&C server.\n\n##### • The AMY module can launch Ammy Admin software with –service and –nogui\narguments and send the program configuration to the remote server. This data enables the\nhacker to connect to the PC and control it remotely.\n\n##### • To get information about hardware electronic keys the Trojan reviews all the connected USB\ndevices and searches for the following names among them:\n\nRutoken Magistra; USB Token Device; USB Token; USB_Token; USB-Token; Token; VPNKey;\n\nVPN Key; VPN-Key; VPN_Key; ICCD USB-Token; BIFIT ICCD; BIF IT-ICCD; BIFIT_ICCD;\n\nICCD_USB_Token; EZCCID; Smart Card Reader.\n\n##### • It downloads and then immediately removes files mentioned in Table 3. Purportedly it aims\n\nto disrupt the network analysis and hide requests to command servers.\n\n##### • The malware sends collected information by modules to the C&C server.\n\n • It can add a malicious file to the autostart through modifying the registry. You can find\ndetailed description in the section “Registry modification”.\n\n\nRutoken Magistra; USB Token Device; USB Token; USB_Token; USB-Token; Token; VPNKey;\n\nVPN Key; VPN-Key; VPN_Key; ICCD USB-Token; BIFIT ICCD; BIF IT-ICCD; BIFIT_ICCD;\n\nICCD_USB_Token; EZCCID; Smart Card Reader.\n\n\n-----\n\n### Network interactions\n\nCorkow sends information on its status to the remote C&C server via HTTP POST requests. The list\nof C&C servers is established in each sample code. The malware sends the following string to\nC&C server:\n\n<Machine GUID>.<Date of OS installation>.<disk serial\nnumber%SYSTEMDRIVE%><|><corkow.dll version><|><digit capacity of\nOS><|>1<|><OS version>\n\ns=<current time>\ntzb=<time zone>\ncdi=<the difference between two API calls of time\nfunction> rsi=<the difference between two API calls of\ntime function> on=<the difference between two API\ncalls of time function>\nlng=<OS langauge, returned by GetSystemDefaultUILanguage\nAPI> plds=<the list of modules and their versions>\nhp=<the name of executed\nprocesses> un=<user account\nname>\nclr=<.NET version>\nsvi=<disk serial number\n%SystemDrive %> mst=<time>\nbst=<time>\nhpid=<PID-process number>\nhpst=<process creation tame, received by\nGetProcessTimes API> bts=<digit capacity>\ndbgi=<setings with DebugInfo>\nlbr=<settings with LastBadReply>\n\nThe server will then respond with one of the supported commands enlisted below.\n\n\n###### ci.group-ib.com\n\n\n-----\n\nf h fil dd i d k\nStaticKey The key used to decrypt downloaded files.\nChangeURLs CommandUrls Replacing addresses of C&C servers.\nSendURLs Replacing the addresses of the servers receiving data.\n\n**Table 4. Commands from C&C server.**\n\n|Command|Arguments|Action|\n|---|---|---|\n|NOP|-|No operation|\n|Reboot|-|Forced restart of the user’s PC|\n|Wipe|-|Wiping files beyond recovery|\n||Path|Path to the file to be deleted|\n||Mask|File mask to determine files to be deleted|\n|SelfRemove|-|Removal of the Corkow program|\n||DestroySystem|This flag means disrupting the PC ability to operate after the Corkow program is removed. If active, the malware will try to remove files mentioned in the Table 1 and corrupt MBR|\n|CfgWrite|-|Change to the configuration of the investigated program|\n||PayloadID|Library identification|\n||Section|Configuration section|\n||Param|Parameter name|\n||Value|Parameter value|\n|Update|-|Update of the Corkow program|\n||Url|Network address of the update module to be downloaded|\n||Version|The version of the update module to be downloaded. If this version is older than the installed malware, the update process will be canceled|\n||LoadImmidiatly|This flag cancels the delay for update after the module is downloaded|\n|DownloadAn dEx ecuteEXE или DAMPDLL|-|Downloads file from the remote server and launches it. In case of «DAMPDLL», it also downloads dynamically linked library in PE format to the process memory space to run the Corkow|\n||Url|Network address of the file to be downloaded|\n||CommandLine|The arguments to be provided to the file, when executed.|\n||CryptMode|The value can be «Static» or «Dynamic». Encryption of the downloaded file uses the same algorithm as for sending data. In the first case the key is provided with argument «StaticKey» (see below). In the second case, the domain|\n||StaticKey|f h fil dd i d k The key used to decrypt downloaded files.|\n|ChangeURLs|CommandUrls|Replacing addresses of C&C servers.|\n||SendURLs|Replacing the addresses of the servers receiving data.|\n\n\n###### ci.group-ib.com\n\n\n-----\n\n###### ci.group-ib.com\n\n\n### Appendix – Compromised signatures\n\n**C&C Servers**\n\n|CORE VERSION|PE time stamp|\n|---|---|\n|1.17.6.4||\n|1.19.9.0||\n|2.1.4.0||\n|2.5.7.0 2.6.4.0||\n|2.5.8.0 2.6.2.0||\n|3.0.6.0 3.3.0.0 3.6.0.0 3.6.2.0 3.7.8.0 3.8.9.0||\n|3.8.9.6 3.9.9.0 4.1.0.0 4.1.0.1 4.1.7.0 4.3.1.2 4.3.9.1 4.3.9.5|Dec 13 02:07:37 2011 Dec 23 00:02:04 2011 Jan 11 09:25:12 2012 Jan 11 09:35:46 2012 Feb 09 08:17:08 2012 Mar 01 04:36:57 2012|\n|4.3.9.8||\n|4.4.7.0 4.4.7.1 4.4.7.2 4.4.7.7 4.7.5.0|Apr 12 04:39:33 2012|\n\n\n-----\n\n|4.8.1.0|Col2|\n|---|---|\n|4.8.7.0 4.9.3.0 5.5.1.0 5.5.1.2 5.7.6.0 5.7.9.1 5.9.3.1|Jul 12 13:43:51 2013|\n|5.7.6.0 5.7.9.1 5.9.3.0 6.0.3.0||\n|6.0.6.0||\n|6.0.8.1 6.0.8.2 6.2.0.0 6.2.0.1 7.5.0.0 7.6.13.1 7.6.13.2 7.6.13.4 7.6.13.5 7.6.13.6 7.6.13.7 7.6.13.8 7.6.13.9|Sep 26 20:42:10 2013 Jan 16 17:49:55 2014 Jan 16 18:01:42 2014 Feb 19 21:17:36 2014|\n|6.0.8.2 6.2.0.1 6.4.1.3 7.5.0.1 7.7.6.1|Sep 26 20:44:01 2013 Nov 18 19:07:10 2013 Dec 26 06:32:38 2013|\n|6.0.8.4 6.2.0.1|Sep 27 12:06:51 2013 Oct 08 14:23:06 2013|\n|7.9.0.1 7.9.0.5 7.9.1.1 7 10 0 1|May 28 18:08:09 2014 May 28 18:23:42 2014 Jun 11 21:14:26 2014|\n|7.16.0.1 7.20.0.11|Jul 01 23:03:16 2014 Jul 21 22:02:08 2014|\n\n\n-----\n\n|7.16.1.0 7.45.1.1 7.47.1.1 7.56.1.1 7.70.1.1 7.74.1.1|Jul 01 23:27:25 2014 Aug 07 05:40:04 2014 Sep 18 16:16:43 2014|\n|---|---|\n|7.78.1.1||\n|7.34.0.1 7.34.0.2 7.45.0.2 7.46.0.1 7.56.0.1 7.70.0.2 7.70.0.3 7.74.1.1|Aug 05 09:29:09 2014 Aug 05 09:30:00 2014 Aug 07 05:32:04 2014 Aug 13 10:34:35 2014 Aug 20 16:32:14 2014 Sep 09 19:01:42 2014|\n|7.85.0.1 7.92.0.1 7.92.1.2|Nov 06 09:14:46 2014|\n|7.85.1.1 7.92.1.2|Oct 20 21:37:36 2014 Nov 07 01:07:58 2014|\n|7.102.0.1||\n|7.107.0.1 7.107.1.1|Dec 10 22:03:23 2014|\n|7.107.1.1|Dec 10 22:03:23 2014|\n|7.118.1.1||\n|7.120.0.11 7.120.0.32||\n\n\n-----\n\n**Mutexes**\n\nThe mutex values are set up by the malicious program.\n\n\n###### ci.group-ib.com\n\n\n**Mutex path**\n\n\n«Session\\< id of desktop session for the injection process >\\HighMemoryEvent_<id of\nGlobal\\TermSrvReadyEvent\n\n**Installation Paths**\n\nCorkow installs and runs in the following paths:\n\n\n**Possible Working Paths**\n\n\n«%Temp%\\tmpXXXX.tmp\n«%TEMP%\n\n**Yara rule**\n\nrule CorkowDLL\n{\n\nmeta:\n\ndescription = «Rule to detect the Corkow DLL\nfiles» strings:\n\n$mz = { 4d 5a }\n$binary1 = {60 [0-8] 9C [0-8] BB ?? ?? ?? ?? [0-8] 81 EB ?? ?? ?? ?? [0-8] E8 ?? 00 00 00 [08] 58 [0-8] 2B C3}\n\n$binary2 = {(FF 75 ?? | 53) FF 75 10 FF 75 0C FF 75 08 E8 ?? ?? ?? ?? [3-9] C9 C2 0C 00}\n$export1 = «Control_RunDLL»\n$export2 = «ServiceMain»\n$export3 = «DllGetClassObject»\n\ncondition:\n\n($mz at 0) and ($binary1 and $binary2) and any of ($export*)\n###### }\n\n\n-----\n\n### About Group-IB\n\nGroup-IB is one of the leading international companies specializing in high-tech cybercrimes,\nfraud prevention and investigation.\n\nSince 2013, the company has offered a range of services in computer forensics, consulting and\nauditing of information security systems to prevent financial and reputational damages of the\nlargest companies in Russia and worldwide.\n\nGroup-IB’s extensive experience has resulted in the innovative Bot-Trek information security\necosystem – an array of highly sophisticated software and hardware solutions based on up-todate cyber intelligence data and deep analysis of real hacker attacks to monitor, identify and\nprevent cyber threats.\n\nThe company’s clients include over 60 financial institutions, light and heavy industry enterprises,\nenergy and oil companies, software companies, telecommunications operators in Russia,\nArgentina, Australia, Brazil, Ecuador, UK, the EU, Canada and USA.\n\nGroup-IB team has uniquely qualified experts with solid practical experience. They are\ninternationally certified by CISSP, CISA, CISM, CEH, CWSP, GCFA, SSCP and also have\ninformation security state certificates. The company’s representatives are members of important\nadvisory councils and speakers at major international information security conferences.\n\nGroup-IB’s mission is to protect our clients in cyberspace by creating and using innovative\nproducts, solutions and services.\n\n\n###### ci.group-ib.com\n\n\n-----\n\n###### ci.group-ib.com\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "6fc23d14-23a6-4870-8fad-b291b182596f",
            "created_at": "2022-10-25T16:07:18.480113Z",
            "updated_at": "2022-10-25T16:07:18.480113Z",
            "deleted_at": null,
            "name": "ETDA",
            "url": "https://apt.etda.or.th",
            "description": "Threat Group Cards: A Threat Actor Encyclopedia",
            "reports": null
        },
        {
            "id": "bf5be533-fa31-4590-ae37-5761c97ffa34",
            "created_at": "2022-10-25T16:13:58.389257Z",
            "updated_at": "2022-10-25T16:13:58.389257Z",
            "deleted_at": null,
            "name": "Malpedia",
            "url": "https://malpedia.caad.fkie.fraunhofer.de",
            "description": "Malpedia is a free service offered by Fraunhofer FKIE",
            "reports": null
        }
    ],
    "references": [
        "https://www.group-ib.ru/brochures/Group-IB-Corkow-Report-EN.pdf"
    ],
    "report_names": [
        "Group-IB-Corkow-Report-EN.pdf"
    ],
    "threat_actors": [
        {
            "id": "c9617bb6-45c8-495e-9759-2177e61a8e91",
            "created_at": "2022-10-25T15:50:23.405039Z",
            "updated_at": "2025-03-27T02:00:55.462193Z",
            "deleted_at": null,
            "main_name": "Carbanak",
            "aliases": [
                "Carbanak",
                "Anunak"
            ],
            "source_name": "MITRE:Carbanak",
            "tools": [
                "Carbanak",
                "Mimikatz",
                "PsExec",
                "netsh"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "67bf0462-41a3-4da5-b876-187e9ef7c375",
            "created_at": "2022-10-25T16:07:23.44832Z",
            "updated_at": "2025-03-27T02:02:09.806007Z",
            "deleted_at": null,
            "main_name": "Careto",
            "aliases": [
                "Careto",
                "The Mask",
                "Ugly Face"
            ],
            "source_name": "ETDA:Careto",
            "tools": [
                "Careto"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "a58aedbc-e89f-4e0c-8147-c6406a616cfa",
            "created_at": "2022-10-25T16:07:23.494355Z",
            "updated_at": "2025-03-27T02:02:09.831373Z",
            "deleted_at": null,
            "main_name": "Corkow",
            "aliases": [
                "Corkow",
                "Metel"
            ],
            "source_name": "ETDA:Corkow",
            "tools": [
                "Corkow",
                "Metel"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "1a76ed30-4daf-4817-98ae-87c667364464",
            "created_at": "2022-10-25T16:47:55.891029Z",
            "updated_at": "2025-03-27T02:05:17.408867Z",
            "deleted_at": null,
            "main_name": "IRON LIBERTY",
            "aliases": [
                "ATK6 ",
                "BROMINE ",
                "CASTLE ",
                "Crouching Yeti ",
                "DYMALLOY ",
                "Dragonfly ",
                "Energetic Bear / Berserk Bear ",
                "Ghost Blizzard ",
                "TEMP.Isotope ",
                "TG-4192 ",
                "ALLANITE "
            ],
            "source_name": "Secureworks:IRON LIBERTY",
            "tools": [
                " Ddex Loader",
                " Havex",
                " Karagany",
                " Loek",
                " MCMD",
                " Sysmain",
                " xfrost",
                "ClientX"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "ed3810b7-141a-4ed0-8a01-6a972b80458d",
            "created_at": "2022-10-25T16:07:23.443259Z",
            "updated_at": "2025-03-27T02:02:09.801771Z",
            "deleted_at": null,
            "main_name": "Carbanak",
            "aliases": [
                "Anunak",
                "Carbanak",
                "Carbon Spider",
                "ELBRUS",
                "Gold Waterfall",
                "Sangria Tempest"
            ],
            "source_name": "ETDA:Carbanak",
            "tools": [
                "AVE_MARIA",
                "Agentemis",
                "AmmyyRAT",
                "Antak",
                "Anunak",
                "Ave Maria",
                "AveMariaRAT",
                "BABYMETAL",
                "BIRDDOG",
                "Backdoor Batel",
                "Batel",
                "Bateleur",
                "BlackMatter",
                "Boostwrite",
                "Cain & Abel",
                "Carbanak",
                "Cl0p",
                "Cobalt Strike",
                "CobaltStrike",
                "DNSMessenger",
                "DNSRat",
                "DNSbot",
                "DRIFTPIN",
                "DarkSide",
                "FOXGRABBER",
                "FlawedAmmyy",
                "HALFBAKED",
                "JS Flash",
                "KLRD",
                "MBR Eraser",
                "Mimikatz",
                "Nadrac",
                "Odinaff",
                "POWERPIPE",
                "POWERSOURCE",
                "PsExec",
                "SQLRAT",
                "Sekur",
                "Sekur RAT",
                "SocksBot",
                "SoftPerfect Network Scanner",
                "Spy.Agent.ORM",
                "TEXTMATE",
                "TeamViewer",
                "TiniMet",
                "TinyMet",
                "Toshliph",
                "VB Flash",
                "WARPRISM",
                "avemaria",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1666716505,
    "ts_updated_at": 1743041818,
    "ts_creation_date": 1454674302,
    "ts_modification_date": 1454674302,
    "files": {
        "pdf": "https://archive.orkl.eu/e915d142a54fdad173662822c32679d7e075857d.pdf",
        "text": "https://archive.orkl.eu/e915d142a54fdad173662822c32679d7e075857d.txt",
        "img": "https://archive.orkl.eu/e915d142a54fdad173662822c32679d7e075857d.jpg"
    }
}