{
    "id": "854b24f4-71de-45bd-84e9-9a54b02b2f45",
    "created_at": "2023-01-12T15:10:17.216724Z",
    "updated_at": "2025-03-27T02:16:08.499799Z",
    "deleted_at": null,
    "sha1_hash": "dcb0c68b4dc34494478e491a74728f71a9c3cd6f",
    "title": "2019-11-12 - PureLocker- New Ransomware-as-a-Service Being Used in Targeted Attacks Against Servers",
    "authors": "",
    "file_creation_date": "2022-05-28T03:41:15Z",
    "file_modification_date": "2022-05-28T03:41:15Z",
    "file_size": 1566184,
    "plain_text": "# PureLocker: New Ransomware-as-a-Service Being Used in Targeted Attacks Against Servers\n\n**[intezer.com/blog-purelocker-ransomware-being-used-in-targeted-attacks-against-servers/](https://www.intezer.com/blog-purelocker-ransomware-being-used-in-targeted-attacks-against-servers/)**\n\nNovember 12, 2019\n\nWritten by Michael Kajiloti - 12 November 2019\n\n### Get Free Account\n\nJoin Now\n\n**_Analysis by Intezer and IBM X-Force points its origins to a Malware-as-a-Service_**\n**_(MaaS) provider utilized by the Cobalt Gang and FIN6 attack groups_**\n\n**_This is a mutual research between Intezer and IBM’s X-Force IRIS team_**\n\nWe have found a new and undetected ransomware threat that is being used for targeted\nattacks against production servers of enterprises. Using code reuse analysis, we\ndiscovered this threat is closely related to the “more_eggs” backdoor malware, which is\n[sold on the dark web by a veteran MaaS provider and has been used by the Cobalt Gang,](https://medium.com/@quoscient/golden-chickens-uncovering-a-malware-as-a-service-maas-provider-and-two-new-threat-actors-using-61cf0cb87648)\nFIN6, and other threat groups.\n\n\n-----\n\nWhile the samples we analyzed are for the Windows platform, we have noticed that the\ngroup operating this ransomware is also employing a Linux variant in order to attack the\nLinux infrastructure of its targets.\n\nWe have named this ransomware PureLocker because it’s written in the\nPureBasic programming language. As part of our analysis, we have identified the evasion\nmethods and design features that have allowed this ransomware to remain under the radar\nfor several months. Below we present our findings through a technical analysis of the\nmalware samples.\n\n## Initial Analysis\n\nThe Windows sample we analyzed is a 32-bit DLL, masquerading as a C++ cryptography\n[library called Crypto++:](https://www.cryptopp.com/)\n\nIn viewing the exports section we quickly noticed that something was unusual, as the library\nsupposedly contains functions related to music playback.\n\nWhen looking at anti-virus vendor scan results in VirusTotal, we observed that the file has\nbeen essentially undetected for more than three weeks now, which is quite rare for a\nmalicious file:\n\n\n-----\n\nAdditionally, when we executed this file in several sandbox environments it didn’t exhibit\nany malicious or suspicious behaviors.\n\nHowever, after genetically analyzing the file in Intezer Analyze we made three key\nobservations:\n\n1. There is no Crypto++ code connection here, meaning the sample is not a Crypto++\nlibrary.\n\n2. The file contains reused code from several malware families, mainly from Cobalt Gang\nbinaries. This means the file is malicious and may have relations to Cobalt Gang.\n\n3. The majority of the relevant code in this file is unique, indicating that it’s likely a new or\nhighly modified malware.\n\n## A Closer Look\n\nA closer look reveals this file is a ransomware written in the PureBasic programming\nlanguage, a rather uncommon programming language. This unusual choice poses\nadvantages for the attacker. AV vendors have trouble generating reliable detection\nsignatures for PureBasic binaries. In addition, PureBasic code is portable between\nWindows, Linux, and OS-X, making targeting different platforms easier.\n\n\n-----\n\nThe malware is designed to be executed as a COM server DLL by regsrv32.exe, which will\ninvoke the DllRegisterServer export, where the malware’s code resides. All of the other,\nmusic related, exports have no functionality and are included in the ransomware for\ndeception only.\n\nThe malware’s strings are encoded and stored as Unicode hex strings. Each string is\ndecoded on demand by calling a string decoding function.\n\nThe malware’s code begins by checking if it was executed as intended by the attackers,\nand that it’s not being analyzed or debugged. If any of these checks fail, the malware will\nexit immediately, without deleting itself, likely as an anti-analysis method not to raise\nsuspicion. The main function flow graph is presented below:\n\n\n-----\n\nIn case the malware s payload is executed, the malware will delete itself immediately\nafterwards.\n\n### Part of a Targeted Attack Chain\n\nThere are several hints suggesting that this component is part of a targeted and multi-stage\nattack. The malware begins by checking whether it was executed with the “/s /i”\narguments, which instructs regsrv32.exe to install the DLL component without raising any\ndialogues (silent):\n\nLater on the malware verifies that it’s indeed executed by “regsrv32.exe”, and that its file\nextension is either “.dll” or “.ocx”. It also verifies that the current year on the machine is\n2019, and that it has administrator rights. As mentioned, if any of these checks fail, the\nmalware will exit without performing any malicious activity, likely in an attempt to conceal its\nfunctionality.\n\nThis type of behavior is not common in ransomware, which typically prefer to infect as many\nvictims as possible in the hopes of gaining as much profit as possible. Additionally, being a\nDLL file designed to be executed in a very specific manner reveals this ransomware is a\nlater-stage component of a multi-stage attack.\n\n### Evasion and Anti-Analysis Techniques\n\nUncharacteristically for a ransomware, the malware uses an anti-hooking technique by\nmanually loading another copy of “ntdll.dll” and resolving API addresses manually from\nthere. This is an attempt by the malware to evade user-mode hooking of ntdll functions.\nWhile it’s a known trick, it’s rarely used in ransomware.\n\nThe imports themselves are stored as 32bit hash values, and the ransomware uses the\nfamiliar resolve-by-hash method to obtain the function addresses.\n\n\n-----\n\n[It’s also worth noting that the malware uses low level Windows API functions in ntdll.dll for](https://www.intezer.com/blog/research/acbackdoor-analysis-of-a-new-multiplatform-backdoor/)\nmost of its functionality—with some exceptions from kernel32.dll and advapi32.dll—notably\nfor file manipulation. The malware also does not use the Windows Crypto API functions,\ninstead relying on the compiled-in purebasic crypto library for its encryption needs, with the\n[exception of utilizing SystemFunction036 from advapi32.dll (RtlGenRandom) for pseudo-](https://docs.microsoft.com/en-us/windows/win32/api/ntsecapi/nf-ntsecapi-rtlgenrandom)\nrandom number generation.\n\n### Encryption and Ransom Note\n\nIn the event that all anti-analysis and integrity tests performed by the malware are satisfied,\nit proceeds to encrypt the files on the victim’s machine with the standard AES+RSA\ncombination, using a hard-coded RSA key. The ransomware adds the “.CR1” extension for\neach encrypted file. It encrypts mostly data files, skipping encryption for executable files\n\n\n-----\n\naccording to the particular file s extension. The ransomware then secure-deletes the original\nfiles in order to prevent recovery. Once the malware has completed the encryption it leaves\na ransom note file on the user’s desktop named YOUR_FILES.txt.\n\nIt’s worth noting that the ransom note does not ask for the payment type or for the monetary\namount inside of the note itself, instead instructing the victim to contact the attacker via\n[email. The attackers use the anonymous and encrypted Proton email service. Each sample](https://protonmail.com/)\nwe analyzed contained a different email address, which might be how the attackers can link\nbetween different victims and their respective decryption keys (each email corresponds to a\nspecific RSA key pair). This is further evidence that this threat is different from typical forms\nof ransomware.\n\nAnother element to note is the “CR1” string, which appears in the attacker email addresses,\nthe encrypted file extension, and ransom note. Since this is a RaaS, we believe this string is\nmost likely the identifier of the group that is operating these specific samples.\n\n## Code Connections and Origin\n\nA deeper examination of the genetic analysis results reveals that the code reuse\nconnections to Cobalt Gang are related to a specific component used by the group in its\nattack chain, [described here by Morphisec as the Stage 3 Dropper DLL. More specifically,](http://blog.morphisec.com/cobalt-gang-2.0)\nthis component is the loader part of the “more_eggs” JScript backdoor, also known as\n“SpicyOmelette”.\n\nLast year, [QuoScient uncovered that Cobalt Gang had been buying its malware kits from a](https://medium.com/@quoscient/golden-chickens-uncovering-a-malware-as-a-service-maas-provider-and-two-new-threat-actors-using-61cf0cb87648)\nmalware-as-a-service (MaaS) provider on underground cybercrime forums. QuoScient also\nobserved two additional threat groups using the same MaaS kits in their operations,\nincluding the “more_eggs” backdoor.\n\nMost recently, IBM X-Force has [uncovered several campaigns by FIN6 (also known as](https://securityintelligence.com/posts/more_eggs-anyone-threat-actor-itg08-strikes-again/)\nITG08) where they observed heavy usage of the “more eggs” malware kit\n\n\n-----\n\nA comparison between the PureLocker ransomware samples and recent more_eggs loader\nsamples reveals it’s extremely likely that they were created by the same author. The lines of\nsimilarity are evident:\n\nCOM Server DLL components written in PureBasic\nNearly identical pre-payload stage in both functionality and code, with identical\nevasion and anti-analysis methods\nIdentical string encoding and decoding methods\n\nThese findings strongly suggest that the MaaS provider of “more_eggs” has added a new\nmalware kit to its offerings, by modifying the “more_eggs” loader’s payload from a JScript\nbackdoor to a ransomware.\n\nWhile we have a good sense regarding the malware’s origin, it’s unclear at this time\nwhether the “CR1” group that’s using this ransomware for targeted attacks is a previous\ncustomer of the MaaS provider, such as Cobalt Gang and FIN6, or a new one.\n\n## Conclusion\n\nPureLocker is a rather unorthodox ransomware. Instead of trying to infect as many victims\nas possible, it was designed to conceal its intentions and functionalities unless executed in\nthe intended manner. This approach has worked well for the attackers who have managed\nto successfully use it for targeted attacks, while remaining undetected for several months.\n\n\n-----\n\nIt s interesting to note that the code of the evasion and anti-analysis functionalities\ndescribed in this blog is directly copied from the “more_eggs” backdoor loader. Some of\nthese duplicated features have allowed the ransomware to stay undetected by evading\nautomated analysis systems. This provides an example of the importance of code reuse\nanalysis for malware detection and classification. It twists the usage of any previously used\ncode, even code for effective evasion and anti-analysis, into a reliable indicator for\ndetection.\n\nThe PureLocker ransomware is now indexed in Intezer’s code genome database and the\n[genetic analysis of its samples can be viewed in Intezer Analyze.](https://analyze.intezer.com/#/files/c592c52381d43a6604b3fc657c5dc6bee61aa288bfa37e8fc54140841267338d)\n\n_Intezer would like to thank IBM’s X-Force IRIS team for its collaboration on this mutual_\n_research. For more information, check out IBM’s X-Force exchange collection related to this_\n_threat._\n\n**IOCs**\n1fd15c358e2df47f5dde9ca2102c30d5e26d202642169d3b2491b89c9acc0788\nc592c52381d43a6604b3fc657c5dc6bee61aa288bfa37e8fc54140841267338d\n\n**Michael Kajiloti**\nMichael is a security researcher turned product manager, who previously led the Intezer\nAnalyze product lifecycle. He has presented his malware research at conferences such as\nREcon and the Chaos Communications Congress (CCC).\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2019/2019-11-12 - PureLocker- New Ransomware-as-a-Service Being Used in Targeted Attacks Against Servers.pdf"
    ],
    "report_names": [
        "2019-11-12 - PureLocker- New Ransomware-as-a-Service Being Used in Targeted Attacks Against Servers.pdf"
    ],
    "threat_actors": [
        {
            "id": "610a7295-3139-4f34-8cec-b3da40add480",
            "created_at": "2023-01-06T13:46:38.608142Z",
            "updated_at": "2025-03-27T02:00:02.87217Z",
            "deleted_at": null,
            "main_name": "Cobalt",
            "aliases": [
                "Cobalt Gang",
                "GOLD KINGSWOOD",
                "COBALT SPIDER",
                "G0080",
                "Mule Libra",
                "Cobalt Group"
            ],
            "source_name": "MISPGALAXY:Cobalt",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "7a257844-df90-4bd4-b0f1-77d00ff82802",
            "created_at": "2022-10-25T16:07:24.376356Z",
            "updated_at": "2025-03-27T02:02:10.199451Z",
            "deleted_at": null,
            "main_name": "Venom Spider",
            "aliases": [
                "Golden Chickens",
                "Venom Spider"
            ],
            "source_name": "ETDA:Venom Spider",
            "tools": [
                "More_eggs",
                "PureLocker",
                "SONE",
                "SpicyOmelette",
                "StealerOne",
                "Taurus Builder",
                "Taurus Builder Kit",
                "Taurus Loader",
                "Taurus Loader Reconnaissance Module",
                "Taurus Loader Stealer Module",
                "Taurus Loader TeamViewer Module",
                "Terra Loader",
                "TerraCrypt",
                "TerraPreter",
                "TerraRecon",
                "TerraStealer",
                "TerraTV",
                "TerraWiper",
                "ThreatKit",
                "VenomKit",
                "VenomLNK",
                "lite_more_eggs"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "220e1e99-97ab-440a-8027-b672c5c5df44",
            "created_at": "2022-10-25T16:47:55.773407Z",
            "updated_at": "2025-03-27T02:05:17.379427Z",
            "deleted_at": null,
            "main_name": "GOLD KINGSWOOD",
            "aliases": [
                "Cobalt Spider ",
                "Cobalt Gang "
            ],
            "source_name": "Secureworks:GOLD KINGSWOOD",
            "tools": [
                " Buhtrap",
                " Carbanak",
                " Cobalt Strike",
                " CobtInt",
                " Cyst",
                " Metasploit",
                " Meterpreter",
                " Mimikatz",
                " SpicyOmelette",
                "ATMSpitter"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "88802a4b-5b3d-42ee-99e6-8a4f5fd231f6",
            "created_at": "2023-01-06T13:46:38.851345Z",
            "updated_at": "2025-03-27T02:00:02.935087Z",
            "deleted_at": null,
            "main_name": "GC01",
            "aliases": [
                "Golden Chickens",
                "Golden Chickens01",
                "Golden Chickens 01"
            ],
            "source_name": "MISPGALAXY:GC01",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "2dfaa730-7079-494c-b2f0-3ff8f3598a51",
            "created_at": "2022-10-25T16:07:23.474746Z",
            "updated_at": "2025-03-27T02:02:09.822683Z",
            "deleted_at": null,
            "main_name": "Cobalt Group",
            "aliases": [
                "ATK 67",
                "Cobalt Gang",
                "Cobalt Spider",
                "Gold Kingswood",
                "Mule Libra",
                "TAG-CR3"
            ],
            "source_name": "ETDA:Cobalt Group",
            "tools": [
                "ATMRipper",
                "ATMSpitter",
                "Agentemis",
                "AmmyyRAT",
                "AtNow",
                "COOLPANTS",
                "CobInt",
                "Cobalt Strike",
                "CobaltStrike",
                "Cyst Downloader",
                "Fareit",
                "FlawedAmmyy",
                "Formbook",
                "Little Pig",
                "Metasploit Stager",
                "Mimikatz",
                "More_eggs",
                "NSIS",
                "Nullsoft Scriptable Install System",
                "Pony Loader",
                "Ripper ATM",
                "SDelete",
                "Siplog",
                "SoftPerfect Network Scanner",
                "SpicyOmelette",
                "Taurus Builder",
                "Taurus Builder Kit",
                "Taurus Loader",
                "Terra Loader",
                "ThreatKit",
                "VenomKit",
                "cobeacon",
                "win.xloader"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "ee3363a4-e807-4f95-97d8-b603c31b9de1",
            "created_at": "2023-01-06T13:46:38.485884Z",
            "updated_at": "2025-03-27T02:00:02.845851Z",
            "deleted_at": null,
            "main_name": "FIN6",
            "aliases": [
                "Camouflage Tempest",
                "MageCart Group 6",
                "G0037",
                "TA4557",
                "SKELETON SPIDER",
                "ITG08",
                "White Giant",
                "GOLD FRANKLIN",
                "ATK88"
            ],
            "source_name": "MISPGALAXY:FIN6",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "f5c90ccc-0f18-4e07-a246-b62101ab2f6f",
            "created_at": "2023-01-06T13:46:38.854407Z",
            "updated_at": "2025-03-27T02:00:02.935908Z",
            "deleted_at": null,
            "main_name": "GC02",
            "aliases": [
                "Golden Chickens",
                "Golden Chickens02",
                "Golden Chickens 02"
            ],
            "source_name": "MISPGALAXY:GC02",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "12517c87-040a-4627-a3df-86ca95e5c13f",
            "created_at": "2022-10-25T16:07:23.61665Z",
            "updated_at": "2025-03-27T02:02:09.889471Z",
            "deleted_at": null,
            "main_name": "FIN6",
            "aliases": [
                "ATK 88",
                "Camouflage Tempest",
                "FIN6",
                "Gold Franklin",
                "ITG08",
                "Skeleton Spider",
                "TAAL",
                "TAG-CR2",
                "White Giant"
            ],
            "source_name": "ETDA:FIN6",
            "tools": [
                "AbaddonPOS",
                "Agentemis",
                "AmmyyRAT",
                "Anchor_DNS",
                "BlackPOS",
                "CmdSQL",
                "Cobalt Strike",
                "CobaltStrike",
                "FlawedAmmyy",
                "FrameworkPOS",
                "Grateful POS",
                "JSPSPY",
                "Kaptoxa",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "LockerGoga",
                "MMon",
                "Magecart",
                "Meterpreter",
                "Mimikatz",
                "More_eggs",
                "NeverQuest",
                "POSWDS",
                "Reedum",
                "Ryuk",
                "SCRAPMINT",
                "SONE",
                "SpicyOmelette",
                "StealerOne",
                "Taurus Loader Stealer Module",
                "Terra Loader",
                "TerraStealer",
                "Vawtrak",
                "WCE",
                "Windows Credential Editor",
                "Windows Credentials Editor",
                "cobeacon",
                "grabnew"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "b3acfb48-b04d-4d3d-88a8-836d7376fa2e",
            "created_at": "2024-06-19T02:03:08.052814Z",
            "updated_at": "2025-03-27T02:05:17.368029Z",
            "deleted_at": null,
            "main_name": "GOLD FRANKLIN",
            "aliases": [
                "ITG08 ",
                "MageCart Group 6 ",
                "Skeleton Spider ",
                "White Giant ",
                "FIN6 "
            ],
            "source_name": "Secureworks:GOLD FRANKLIN",
            "tools": [
                " Metasploit",
                " Meterpreter",
                " Mimikatz",
                " PowerSploit",
                " PowerUpSQL",
                " RemCom",
                "FrameWorkPOS"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "ea7bfe06-7c23-481d-b8ba-eafa6cda3bc9",
            "created_at": "2022-10-25T15:50:23.317961Z",
            "updated_at": "2025-03-27T02:00:55.440858Z",
            "deleted_at": null,
            "main_name": "FIN6",
            "aliases": [
                "FIN6",
                "Magecart Group 6",
                "ITG08",
                "Skeleton Spider",
                "TAAL",
                "Camouflage Tempest"
            ],
            "source_name": "MITRE:FIN6",
            "tools": [
                "FlawedAmmyy",
                "GrimAgent",
                "FrameworkPOS",
                "More_eggs",
                "Cobalt Strike",
                "Windows Credential Editor",
                "AdFind",
                "PsExec",
                "LockerGoga",
                "Ryuk",
                "Mimikatz"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "c11abba0-f5e8-4017-a4ee-acb1a7c8c242",
            "created_at": "2022-10-25T15:50:23.744036Z",
            "updated_at": "2025-03-27T02:00:55.537114Z",
            "deleted_at": null,
            "main_name": "Cobalt Group",
            "aliases": [
                "Cobalt Group",
                "GOLD KINGSWOOD",
                "Cobalt Gang",
                "Cobalt Spider"
            ],
            "source_name": "MITRE:Cobalt Group",
            "tools": [
                "Mimikatz",
                "More_eggs",
                "SpicyOmelette",
                "SDelete",
                "Cobalt Strike",
                "PsExec"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1673536217,
    "ts_updated_at": 1743041768,
    "ts_creation_date": 1653709275,
    "ts_modification_date": 1653709275,
    "files": {
        "pdf": "https://archive.orkl.eu/dcb0c68b4dc34494478e491a74728f71a9c3cd6f.pdf",
        "text": "https://archive.orkl.eu/dcb0c68b4dc34494478e491a74728f71a9c3cd6f.txt",
        "img": "https://archive.orkl.eu/dcb0c68b4dc34494478e491a74728f71a9c3cd6f.jpg"
    }
}