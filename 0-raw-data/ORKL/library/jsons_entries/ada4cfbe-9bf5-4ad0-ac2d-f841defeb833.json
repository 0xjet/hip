{
    "id": "ada4cfbe-9bf5-4ad0-ac2d-f841defeb833",
    "created_at": "2023-01-12T15:00:20.149513Z",
    "updated_at": "2025-03-27T02:05:40.060724Z",
    "deleted_at": null,
    "sha1_hash": "b064f831447b5a90f9f56864b81d2409952214e3",
    "title": "2020-01-31 - RATs in the Library- Remote Access Trojans Hide in Plain -Public- Site",
    "authors": "",
    "file_creation_date": "2022-05-28T19:32:37Z",
    "file_modification_date": "2022-05-28T19:32:37Z",
    "file_size": 4141588,
    "plain_text": "# RATs in the Library\n\n**blog.reversinglabs.com/blog/rats-in-the-library**\n\n[Threat Research | January 31, 2020](https://blog.reversinglabs.com/blog/tag/threat-research)\n\n\n-----\n\nBlog Author\nRobert Simmons, Independent malware researcher and threat researcher at\n[ReversingLabs. Read More...](https://blog.reversinglabs.com/blog/author/robert-simmons)\n\n\n-----\n\nOn November 20, 2019, Twitter user @_re_fox reported that a malicious file was being1 2\nhosted on archive.org in an encoded format called Base64. The sample was identified as\nnjRAT . This is a known technique used by adversaries to hide payloads on public sites .3 4\nThis technique lets adversaries hide payloads due to the output from the encoding process\nbeing plain text. This makes detection more difficult for websites that host data for download\nand storage. However, this technique also requires an initial delivery phase malware file\nwhich then downloads and decodes the base64 payload. By examining known delivery\nphase malware samples that call out to achive.org, a large set of hosted payloads has been\nidentified. A total of 18 personas and approximately 70 hosted malware samples are\nenumerated. These samples span a number of known remote access trojans (RAT) including\nnjRAT, QuasarRAT, LimeRAT, Cybergate, RevengeRAT, and Vjw0rm . In addition to the5 6 7 8\nRATs, a smaller number of malicious Windows executables were also found. One of the\nadversary personas, “@robacopony147”, uploaded a large set of PowerShell, VB Script, and\nWindows PE downloaders. Each chain of downloader is a delivery mechanism for either\nRevengeRAT or QuasarRAT. What follows is a deeper examination of each of the adversary\npersonas and the malware they are hosting on archive.org. A graph showing all the hosted\nfiles, adversaries, and malware families is shown in Figure 1.\n\n\n-----\n\n**Figure 1: Malware Families on Archive.org (Green: Handles, Blue: Samples)**\n\n## njRAT\n\nMost of the samples of njRAT are one of two versions, 0.7d or 0.6.4. The campaign IDs from\nthe RATs’ configuration are primarily “HacKed”, “New_Zombie”, or “lol”. Other one-off\ncampaign IDs are “WELFI DOFUS” and “nulled”. These files are encoded as Base64, and\nthen stored as either data or text. Fortunately, archive.org stores an XML metadata file along\nwith all uploads. This metadata includes the email address associated with the account used\nto upload the file. One example of this XML file is shown in Figure 2. A full list of adversary\nemail addresses is provided at the end of the blog.\n\n\n-----\n\n**Figure 2: Adversary Email Address in Upload Metadata**\n\nEach of the njRATs found call back to dynamic DNS hostnames. The primary domains used\nare ddns[.]net, hopto[.]org, servehttp[.]com, ddnsking[.]com, and myq-see[.]com. This is a\ncommon adversary technique that allows the IP address of the command and control\ninfrastructure to change as IPs are taken down without the malware being completely\ndisabled by a single IP being taken offline. A full list of command and control infrastructure\nfor this and other RATs is provided at the end of the blog.\n\n## LimeRAT\n\nThe LimeRAT samples leverage both archive.org for payload hosting as well as\npastebin.com for C2 configuration. The payload RAT is downloaded and installed from\narchive.org. The RAT then reaches out to pastebin.com and downloads a text file that\ncontains the C2 IP or hostname along with the port. Two users’ uploads to pastebin.com are\nbeing used for storing this configuration: “frankie4lyf” and “hayder101”. Most of these\nuploads occurred in 2018, but one was uploaded on January 21, 2019. Screenshots of these\ntwo pastebin.com accounts is shown in Figures 3 and 4.\n\n\n-----\n\n**Figure 3: Pastebin.com Uploads from frankie4lyf**\n\n**Figure 4: Pastebin.com Uploads from hayder101**\n\nOne of the LimeRAT operators, “@xjnchng”, has an associated email address found in the\nupload XML metadata, “pierreross1864@gmail[.]com”. This email address is found in the\nregistrant email address for an expired domain, akanchato[.]com . This domain expired9\nJanuary 20, 2019 and predates all the uploaded RATs found on [archive.org. A second](http://archive.org/)\ndomain versatileglobalfinance[.]com was registered using this same email address on\nSeptember 12, 2016. In addition to these domains, this same email address is found in a\nposting on a carder forum, carder[.]tv10. A screenshot of this post is shown in Figure 5.\n\n\n-----\n\n**Figure 5: Posting on carder[.]tv Mentioning Adversary Email Address**\n\nAnalysis of the email addresses associated with the adversary personas operating njRAT\nfinds that four of the addresses appear in publicly known credential breaches according to\nhaveibeenpwned.com .11\n\n\nThe email address abodeezahraa@gmail[.]com associated with the user @killershenegami\nappears in both the “Collection 1”12 credential dump as well as the dump from Canva13, a\ngraphic design tool website. This email’s presence in these two dumps does not show\nanything conclusive about the adversary using another individual’s address for their\npurposes, but it is possible. The address maged.mega77@gmail[.]com, however, also\nappears in multiple credential dumps according to haveibeenpwned.com. It appears in\ndumps from two known hacking forums, cracked[.]to and void[.]to. This indicates that this is\nan adversary operated email address. Finally, peterpop673@gmail[.]com and\nfunnyegyptian30@gmail[.]com both appear in credential dumps: ai[.]type and GameSalad\nrespectively. Presence or absence in a credential dump does not conclusively indicate that\nthe adversary has compromised that particular address. However, presence in dumps from\nknown hacker forums does confirm the maliciousness of that particular address.\n\n## QuasarRAT\n\nThe adversary persona “@youyoudr” is operating a set of QuasarRAT malware, all of which\ncall back to command and control infrastructure hosted on the dynamic DNS hostname\n“7562664419.ddns[.]net”. The email address associated with this persona is not found\nanywhere else in the open source, but this user is quite prolific with 12 different payloads\nhosted on archive.org. Other than the QuasarRAT files, there are also two LimeRAT\n\n\n-----\n\nsamples. These samples do not call back to the same dynamic DNS hostname as the\nQuasarRAT samples. One of the two14 uses 141.255.146[.]196 which is hosted on AS29075\n(Ielo-liazo Services SAS).\n\n## RevengeRAT\n\nThe persona “@robacopony147” hosts a wide variety of interconnected payloads. Each of\nthese chains of downloaders eventually delivers either RevengeRAT or QuasarRAT. These\ndelivery phase sample chains include downloaders in the form of .NET executables, VB\nscripts, and PowerShell scripts. The .NET downloaders reach out to archive.org for the next\nstage payload. The .NET executable which delivers the final RAT payload contains the\npayload in various encoded and obfuscated formats and are embedded in the binary. One\nmethod is encoding the RAT binary as a hexadecimal string with character replacements15.\nThis method can be seen in Figure 6.\n\n**Figure 6: RevengeRAT Embedded in .NET Dropper with PE Magic Highlighted “4D5A”**\n\n\nAn alternative method used in another .NET dropper sample is to reverse the order of the\ncharacters in a Base64 string and then replace the character “A” with “^”16. This method is\nobserved also using the character “!” as the replacement for “A”. Figure 7 shows the\nreplacement and string reversal using the character “^”.\n\n\n-----\n\n**Figure 7: RevengeRAT Embedded in .NET Dropper as Reversed String**\n\nFinally, a third method observed is simply embedding a Base64 string in the .NET\nexecutable. This method is shown in Figure 8.\n\n**Figure 8: Base64 Payload Embedded in .NET Binary**\n\nOne PE DLL17 uploaded by this adversary is encoded by converting the executable to\nhexadecimal string with bytes interspersed with whitespace and other characters.\nScreenshots of these two encoding formats is shown in Figures 6 and 7. In hexadecimal, the\n“magic” number at the start of Windows PE executables “MZ” is encoded to “4D5A”. This\nmagic number is highlighted in both screenshots.\n\n\n-----\n\n**Figure 9: Encoded DLL with Windows PE “4D5A”**\n\n**Figure 10: Encoded DLL with Windows PE “4D5A”**\n\nThis encoding is similar in motivation to encoding PE payloads using Base64. It hinders the\nexecutables from being detected. None of the VB script, Javascript, or PowerShell payloads\nare encoded. However, because they are just text, they are less likely to be detected.\n\nMany of the binaries contain a program database path string (PDB). Some of these PDB\nstrings include a username in the path. One of the initial stage .NET samples18 has a PDB\nstring containing the username “Capony”19. In this same payload delivery chain, the last\ndropper that delivers the RevengeRAT binary contains the username “Ahmed Sakr” in the\nPDB string. These PDB strings are easily viewed using the Titanium Platform and appear in\nthe CodeViews section of the analysis report. Each of the RevengeRAT .NET droppers\ncontains this same PDB string. An example of this PDB string is shown in Figure 11. A full list\nof PDB strings found in all samples is provided at the end of the blog.\n\n\n-----\n\n**Figure 11: PDB String Containing Username “Ahmed Sakr”**\n\n## Vjw0rm\n\nFour samples of Vjw0rm were also found being hosted in the same “@robacopony147”\npersona’s uploads. This is a javascript remote access trojan. It calls back to a C2 for\nconfiguration and instructions for various functions to be executed. The RAT makes an HTTP\nconnection to the C2 at the path location “Vre”. It then checks for various commands such as\n“Cl”, “Sc”, “Ex”, “Rn”, “Up”, “Un”, and “RF”. The Cl command causes the RAT to exit and the\nSc command creates a file and executes it using the run method from the script's shell\ncommand. The Ex command alternatively evaluates additional Javascript code downloaded\nfrom the C2. These three functionalities are seen in Figure 12.\n\n\n-----\n\n**Figure 12: Vjw0rm Commands**\n\nEach of the Vjw0rm samples checks for a previous infection by looking for the registry key\n“HKCU\\vjw0rm”. This and other registry keys used by the RAT can be seen in Figure 13.\n\n**Figure 13: Vjw0rm Registry Keys with “HKCU\\vjw0rm” Highlighted**\n\nThe C2 URL is contacted via HTTP POST. The URL is hardcoded into the RAT as seen in\nFigure 14. Two of the Vjw0rm samples which execute call back to the same C2 hostname as\nthe RevengeRAT samples: googleq.myq-see[.]com, one calls back to a different C2\nhostname: googletest.linkpc[.]net, and one fails to execute. The C2 URL was not recoverable\nfrom the sample which did not execute.\n\n**Figure 14: Vjw0rm C2 URL**\n\nIn addition to the variety of payloads described above, a single sample identified as\n“ClipBanker” is also found among this user’s uploads20. This sample contains a PDB string\nwith the name “Bitcoin Grabber”21. It has a Bitcoin address hard coded in the sample22. At\nthe time of writing, this wallet has received 0.00820733 BTC or approximately $60.\n\n\nThe email address associated with this persona, “cristiano_cr7_2007@outlook[.]com” is\nfound in two locations in the open source. First, the username portion of the email address\nmatches exactly to an Instagram user “cristiano_cr7_2007”23. It is unclear from this user’s\nposts whether or not this account is related or is a name collision. However, a post24 found\non a hacker forum with this email address in a discussion about a PHP backdoor does\nindicate that this adversary is active on hacker forums as recently as November 2018. A\nscreenshot of the forum post is found in Figure 8.\n\n\n-----\n\n**Figure 15: Forum Post with Adversary Email Address**\n\n## Finding the Rest of the Iceberg\n\nPivoting on Infrastructure in the Titanium Platform\n\nAdversaries don’t dwell on one single location for hosting payloads. Therefore, the samples\nfound via the process seen above are only the tip of the iceberg. When a sample is analyzed\nusing the Titanium Platform, network indicators are indexed for search using the “uri” search\nquery keyword. Starting with the dynamic DNS hostname used by a set of njRAT samples\nhosted on archive.org, hino.ddnsking[.]com, search results find a large set of related samples\nof njRAT and other malware families. The results of this search is seen in Figure 9.\n\n\n-----\n\n**Figure 16: Search Results for Samples Related to hino.ddnsking[.]com**\n\n## Conclusion\n\nPublic hosting sites present a challenge for network defenders. These sites are typically\nfound on whitelists. This creates a situation that can be exploited by adversaries by\nconcealing payloads on public sites using various encoding techniques. In addition to the\nobvious types of supply chain attacks, this type of attack loosely fits in the category of data\nsupply chain. Any files and data downloaded from this type of site should be analyzed\ncarefully for concealed malicious payloads.\n\n## References\n\n1. 1. [https://twitter.com/_re_fox](https://twitter.com/_re_fox)\n2. 2. b4897d4d2001e60c57b0ce705831f09ef0619bb2c7b5f912e6edf82d4a175376\n[3. 3. https://malpedia.caad.fkie.fraunhofer.de/details/win.njrat](https://malpedia.caad.fkie.fraunhofer.de/details/win.njrat)\n4. 4.\n\nhttps://isc.sans.edu/forums/diary/Many+Malware+Samples+Found+on+Pastebin/22036\n/\n[5. 5. https://malpedia.caad.fkie.fraunhofer.de/details/win.limerat](https://malpedia.caad.fkie.fraunhofer.de/details/win.limerat)\n\n\n-----\n\n6. 6. [https://malpedia.caad.fkie.fraunhofer.de/details/win.cybergate](https://malpedia.caad.fkie.fraunhofer.de/details/win.cybergate)\n7. 7. [https://malpedia.caad.fkie.fraunhofer.de/details/win.revenge_rat](https://malpedia.caad.fkie.fraunhofer.de/details/win.revenge_rat)\n8. 8. [https://cofense.com/vjw0rm-malware-heres-watch/](https://cofense.com/vjw0rm-malware-heres-watch/)\n9. 9. [https://urlscan.io/result/a129bde6-9569-42c3-911c-327e326271fa](https://urlscan.io/result/a129bde6-9569-42c3-911c-327e326271fa)\n10. 10. [https://urlscan.io/result/f1ab7e8b-e7fe-47aa-93be-5648020605da](https://urlscan.io/result/f1ab7e8b-e7fe-47aa-93be-5648020605da)\n\n11. 11. [https://haveibeenpwned.com/](https://haveibeenpwned.com/)\n12. 12. [https://www.troyhunt.com/the-773-million-record-collection-1-data-reach/](https://www.troyhunt.com/the-773-million-record-collection-1-data-reach/)\n13. 13. [https://support.canva.com/contact/customer-support/may-24-security-incident-faqs/](https://support.canva.com/contact/customer-support/may-24-security-incident-faqs/)\n14. 14. 46ca0f4c618cb7c38f8330af244a98ab91c7de26c8ff970bf7e2c9980ccb380b\n15. 15. 88a7f7257dd76b0b2107ed8949305e9be98442bd79cb4660e2e0f36a37e4af0d\n16. 16. ff33ef83ef9f1c9b8e2bd26cad2dc82ba17a81ed3218e872b9308c1e53425037\n17. 17. fe6c45d1edc6f208872513935fa9581db7addaea52f951673ff3c7025fd27e6e\n18. 18. 31a5610e447b545973567d6a03249355a6fd2ef0508c2d7961bda3d04de40f7b\n19. 19. C:\\Users\\Capony\\source\\repos\\ConsoleApp2\\ConsoleApp2\\obj\\Debug\\Windows\n\nRegistery.pdb\n20. 20. decc3145884184a4f9de5c72c6ac11a79454f96c9ecd872ef33313041e73fccd\n21. 21. G:\\Hacking\\PC\\Bitcoin-Grabber-master\\Bitcoin-Grabber\\obj\\Debug\\taskhostm.pdb\n22. 22. 1JMBrDmrBbpk9gbaZxZQDz5qKAwiADGkZw\n23. 23. [https://www.instagram.com/cristiano_cr7_2007/](https://www.instagram.com/cristiano_cr7_2007/)\n24. 24. [https://urlscan.io/result/c682e718-c427-40bc-8eef-fc7a7c4662be](https://urlscan.io/result/c682e718-c427-40bc-8eef-fc7a7c4662be)\n\n## Supporting Data\n\n Archive.org User Accounts (Benign URLs)\n\n[https://archive.org/details/@hacked_garga](https://archive.org/details/@hacked_garga)\n\n[https://archive.org/details/@killershenegami](https://archive.org/details/@killershenegami)\n\n[https://archive.org/details/@xjnchng](https://archive.org/details/@xjnchng)\n\n[https://archive.org/details/@youyoudr](https://archive.org/details/@youyoudr)\n\n[https://archive.org/details/@sadsdsdads](https://archive.org/details/@sadsdsdads)\n\n[https://archive.org/details/@heliose10](https://archive.org/details/@heliose10)\n\n[https://archive.org/details/@hamza629](https://archive.org/details/@hamza629)\n\n[https://archive.org/details/@hamzawi524](https://archive.org/details/@hamzawi524)\n\n[https://archive.org/details/@anaiix](https://archive.org/details/@anaiix)\n\n[https://archive.org/details/@helloworldex](https://archive.org/details/@helloworldex)\n\n\n-----\n\n[https://archive.org/details/@elkingahme2](https://archive.org/details/@elkingahme2)\n\n[https://archive.org/details/@mehdi0202](https://archive.org/details/@mehdi0202)\n\n[https://archive.org/details/@petter_maffia](https://archive.org/details/@petter_maffia)\n\n[https://archive.org/details/@url90](https://archive.org/details/@url90)\n\n[https://archive.org/details/@abdooalg](https://archive.org/details/@abdooalg)\n\n[https://archive.org/details/@e7b043d98e](https://archive.org/details/@e7b043d98e)\n\n[https://archive.org/details/@zikoaaa](https://archive.org/details/@zikoaaa)\n\n[https://archive.org/details/@robacopony147](https://archive.org/details/@robacopony147)\n\n[Download the File Set](https://cdn2.hubspot.net/hubfs/3375217/Blog/RAT-iocs.csv)\n\nNote: As of Jan 31, 2020, Archive.org responded to our notification and removed subject files\nfrom their repository.\n\nRead our other RAT blog: [When Malware RATs on their Owners](https://blog.reversinglabs.com/blog/when-malware-rats-on-their-owners)\n\n### MORE BLOG ARTICLES\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2020/2020-01-31 - RATs in the Library- Remote Access Trojans Hide in Plain -Public- Site.pdf"
    ],
    "report_names": [
        "2020-01-31 - RATs in the Library- Remote Access Trojans Hide in Plain -Public- Site.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673535620,
    "ts_updated_at": 1743041140,
    "ts_creation_date": 1653766357,
    "ts_modification_date": 1653766357,
    "files": {
        "pdf": "https://archive.orkl.eu/b064f831447b5a90f9f56864b81d2409952214e3.pdf",
        "text": "https://archive.orkl.eu/b064f831447b5a90f9f56864b81d2409952214e3.txt",
        "img": "https://archive.orkl.eu/b064f831447b5a90f9f56864b81d2409952214e3.jpg"
    }
}