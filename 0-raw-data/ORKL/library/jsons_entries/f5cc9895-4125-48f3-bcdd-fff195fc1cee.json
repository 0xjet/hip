{
    "id": "f5cc9895-4125-48f3-bcdd-fff195fc1cee",
    "created_at": "2022-10-25T16:48:24.871681Z",
    "updated_at": "2025-03-27T02:12:33.141887Z",
    "deleted_at": null,
    "sha1_hash": "2998cd09a78c8243fbeea94dc6735e8fef7a81f4",
    "title": "",
    "authors": "",
    "file_creation_date": "2019-04-11T23:15:15Z",
    "file_modification_date": "2019-04-11T23:15:15Z",
    "file_size": 1593909,
    "plain_text": "# 360威胁情报中心\n\n**[ti.360.net/blog/articles/donot-group-is-targeting-pakistani-businessman-working-in-china-en](https://ti.360.net/blog/articles/donot-group-is-targeting-pakistani-businessman-working-in-china-en/)**\n\n## Background\n\nRecently, 360 Threat Intelligence Center is investigating one email phishing attack which is targeting one\nPakistani businessman who is working in China. First attack of this campaign took place in May 2018.\nAttackers have taken over of target machines over months. TTP of this targeting attack will be introduced,\nas well as remediation advice.\n\nWe identified this APT group coded as ‘APT-C-35’ in 2017, who is mainly targeting Pakistan and other\nSouth Asian countries for cyber espionage[1]. Arbor also published APT research on this group, and\nnamed it ‘Donot’[2]. The group attacked government agencies, aiming for classified intelligence. At least 4\nattack campaigns against Pakistan have been observed by us since 2017. Spear phishing emails with\nvulnerable Office documents or malicious macros are sent to victims. Two unique malware frameworks,\nEHDevel and yty, are developed by attackers. In the latest attack, Donot group is targeting Pakistani\nbusinessman working in China.\n\n## Fishing Attack\n\nThe process of attacking target is as following:\n\n## Malware Analysis\n\n\n-----\n\n### Dropper - Excel Macros\n\nAttackers lure victim to open decoy Excel file with malicious macro which is sent as attachment in a\nphishing email. While macro code is running, office_update.exe is dropped at C:\\micro and run. The decoy\nExcel document pretends to be pricing list of one BMW car, which is easy to have trust of the victim:\n\n### Downloader - office_update. exe\n\nfilename office_update.exe\n\nMD5 2320ca79f627232979314c974e602d3a\n\nOffice_updata.exe is a downloader, which is able to download a BAT file by\nhttp://bigdata.akamaihub.stream/pushBatch:\n\nThe BAT file is mainly to modify registry for persistence, and create a directory with hidden property, etc. It\ncan also download wlidsvcc.exe from http://bigdata.akamaihub.stream/pushAgent, then save it in\n%USERPROFILE%\\BackConfig\\BackUp directory:\n\nAfter that, Office_updata.exe will remove itself from system.\n\n### Plugin - Downloader - wlidsvcc.exe\n\nFilename wlidsvcc.exe\n\nMD5 68e8c2314c2b1c43709269acd7c8726c\n\n\n-----\n\nWlidsvcc.exe is also a downloader. It downloads 3 plugins from C2 server, naming wuaupdt.exe, kylgr.exe,\nand svchots.exe. Mutex \"wlidsvcc\" is created to ensure that only one instance runs in system:\n\nThen, it determines if the current process path is %USERPROFILE%BackConfig\\BackUp\\wlidsvcc.exe:\n\nIf the path meets condition, wlidsvcc.exe communicates with C2 (bigdata.akamaihub.stream) by POST,\nwhich is to retrieve remote commands\n\nIf C2 sends ‘no’ command, wlidsvcc.exe will retry to contact C2 after sleeping for 90 seconds:\n\nIf ‘cmdline’ command is received, wlidsvcc.exe runs plug-in\n%USERPROFILE%\\BackConfig\\BackUp\\wuaupdt.exe, and then listens for follow-up commands:\n\n\n-----\n\nIf commands are neither ‘no’ nor ‘cmdline’, wlidsvcc.exe downloads\nhttp://bigdata.akamaihub.stream/orderMe to C:\\Users\\%s\\BackConfig\\BigData, then puts itself into waiting\nmode:\n\n### Plugin executor - wuaupdt.exe\n\nFilename Wuaupdt.exe\n\nMD5 35ec92dbd07f1ca38ec2ed4c4893f7ed\n\nwuaupdt.exe is a CMD backdoor, which can receive and execute CMD commands sent from C2. It can also\nexecute other plugins if commands are issued by attackers. The analysis of all backdoor plugins is shown\nin the following section.\n\nExecute C2 commands:\n\n### Backdoor - Plugins\n\nwuaupdt.exe will execute corresponding plug-ins according to the commands issued by attackers. All\nplugins’ details are as following.\n\n#### Keylogger - Kylgr.exe\n\nFilename Kylgr.exe\n\nMD5 88f244356fdaddd5087475968d9ac9bf\n\nPDB path c:\\users\\user\\documents\\visualstudio2010\\Projects\\newkeylogger\\Release\\new keylogger.pdb\n\n\n-----\n\nThis plugin is a keylogger. It firstly creates a file inc3++.txt in current directory and check whether a\nkeylogging file exists in %USERPROFILE%\\Printers\\Neighbourhood directory. If yes, it saves log file name\nand its last modification time to inc3++.txt:\n\nIf keylogging file is found in %USERPROFILE%\\Printers\\Neighbourhood, the log file is moved to directory\n%USERPROFILE%\\Printers\\Neighbourhood\\Spools:\n\nA new keylogging file is created in %USERPROFILE%\\Printers\\Neighbourhood, with filename\n‘username_year_month_day(hour_minute_second)’. Then, it monitors activities of mouse and keyboard\nconstantly.\n\n\n-----\n\nIf window name is obtained, the name and pressed keys are logged:\n\n#### File - listing - svchots.exe\n\nFilename svchots.exe\n\nMD5 14eda0837105510da8beba4430615bce\n\nThis plugin traverses disk C, D, E, F, G and H to collect filenames:\n\n\n-----\n\nFollowing directories are excluded:\n\nThe, files with following extensions are collected:\n\n\n-----\n\nIf files matching above criteria are found, file names and last modification date of them are written into\ntest.txt file in the current directory, and they are copied to %USERPROFILE%\\Printers\\Spools directory,\nwith appending ‘txt’ as new extension name:\n\n#### Systeminfo – spsvc.exe\n\nFilename Spsvc.exe\n\nMD5 2565215d2bd8b76b4bff00cd52ca81be\n\nThis plugin, packed by UPX and written by Go Language, aims to collect various system information. It\ncreates several CMD processes for information collection. Information is saved to a file located in directory\n%USERPROFILE%\\Printers\\Spools:\n\n\n-----\n\n#### Uploader – lssm.exe\n\nFilename Lssm.exe\n\nMd5 23386af8fd04c25dcc4fdbbeed68f8d4\n\nThe purpose of this plugin is to upload collected information and files, stored in\n%USERPROFILE%Printers\\Spools directory, to C2 bigdata.akamaihub.stream\n\n\n-----\n\n#### Uploader – lssmp.exe\n\nFilename lssmp.exe\n\nMD5 b47386657563c4be9cec0c2f2c5f2f55\n\nDigital signature COMODO CA Limited\n\nSimilar to lssm.exe, lssmp.exe uploads collected info and files to C2. It has a digital signature:\n\nThe plugin searches for explorer.exe in process list:\n\n\n-----\n\nThen, it extracted out a PE file from its resource section:\n\nThe PE file is injected into explorer.exe process for running:\n\n\n-----\n\nThe injected PE file has similar functionalities as lssm.exe, since it uploads keystroke log to C2 server:\n\n\n-----\n\n## Pivoting\n\nSome other decoy documents and plugins are found to have connections with the files in this attack.\n\n### CSD_Promotion_Scheme_2018. XLS\n\nFilename CSD_Promotion_Scheme_2018. XLS\n\nMD5 82a5b24fddc40006396f5e1e453dc256\n\nThe decoy document is an Excel file with malicious macros. When it is opened, a window of Excel security\ndisclamation pop up, warning user that this file has risky macros:\n\n\n-----\n\nThe main function of malicious macro code is to drop skypet.exe in the directory %APPDATA%, and to drop\nskype.bat in the directory C:\\Skype. skypet.bat is executed after that:\n\nSame pricing list of a BMW car is content of the Excel file:\n\n\n-----\n\n### Skyep.bat\n\nSkyep.bat creates 3 directories %USERPROFILE%Printers\\Spools,\n%USERPROFILE%BackConfig\\BackUp and %USERPROFILE%BackConfig\\BigData, and then sets these\nfolder properties to hidden:\n\nThe BAT file also gets the computer name, and save it into\n%USERPROFILE%\\BackConfig\\Backup\\pcap.txt:\n\nAnd it creates multiple registry entries for persistence. Then, it starts skyep.exe and deletes itself:\n\n### Skyep.exe\n\n\nFile‐\nname\n\n\nSkyep.exe\n\n\nMD5 f67595d5176de241538c03be83d8d9a1\n\nPDB C:\\Users\\spartan\\Documents\\Visual Studio 2010\\Projects\\downloader new 22 jun\nuse\\downloader\\Release\\downloader.pdb\n\nSkyep.exe, disguising as a voice software Skype, downloads csrsses.exe from\nhttp://databig.akamaihub.stream/pushBatch (it is still alive) to the \\BackConfig\\BackUp\\ for running:\n\n\n-----\n\n### Csrsses.exe\n\nThe file name Csrsses.exe.\n\nMD5 e0c0148ca11f988f292f527733e54fca\n\nThis file, similar to wlidsvcc.exe, is to execute commands from C2 server. Firstly, it reads computer name\nfrom \\\\BackConfig\\\\BackUp\\\\pcap.txt\n\nThe computer name is then processed to a string: \"orderme/computer name - random number\". It contacts\nC2 databig.akamaihub.stream for commands:\n\n\n-----\n\nIt check value of Content-Type to determine next operation. If the value is application, it downloads file\nfrom C2 to \\\\BackConfig\\\\BigData\\\\ directory:\n\nIf the value is \"cmdline\", \\\\BackConfig\\\\BigData\\\\wuaupdt.exe is executed:\n\nIf command is\"batcmd\", \\\\BackConfig\\\\BigData\\\\test.bat is started:\n\n## Attribution -- Donot (APT-C-35)\n\n\n-----\n\nBy analyzing the macro code, plugins, domain name /IP correlation in the attack, we confirm that Donot\nAPT Group (APT-C-35) is behind the attack.\n\n### Similarity of Macro Code\n\nASERT disclosed one macro sample linking to DONOT APT Group in March 2018[2]. That macro sample is\nvery similar to the sample in this attack: a decoy picture is pop up after macro runs.\n\n### Similarity of Plug-ins\n\nSimilar to previous Donot samples, new sample downloads plugins from C2. It is also packed by UPX and\nis written in Go language. Furthermore, it has similar code logic as previous ones\n\nwuaupdt.exe in this attack appears in previous Donot attack[1], and C2 addresses are same to previous\nones.\n\n## Conclusion\n\n\n-----\n\nFrom the attack activity captured this time, it is obvious that Donot APT group is still keen on Pakistan as\nprimary target of attack, and even expands scope of attack to include Pakistani staffs and institutions in\nChina. There is a sign that the Donot group has never stopped its attacks and another cyber espionage\nattack could be launched soon.\n\n360 Threat Intelligence Center suggests enterprises to improve employees' security awareness by provide\nthem sufficient security training, especially anti-phishing training. Situational awareness, asset\nmanagement, and threat intelligence can prevent such attacks significantly.\n\nFor 360 ESG customers, detection to Donot group and related IOCs are supported by products integrated\nwith threat intelligence, including 360 Threat Intelligence Platform, SkyEye Advance Threat Detection\nSystem, 360 NGSOC.\n\n## IOC\n\n**MD5**\n\n82a5b24fddc40006396f5e1e453dc256\n\nf67595d5176de241538c03be83d8d9a1\n\ne0c0148ca11f988f292f527733e54fca\n\n2320ca79f627232979314c974e602d3a\n\n68e8c2314c2b1c43709269acd7c8726c\n\n35ec92dbd07f1ca38ec2ed4c4893f7ed\n\n88f244356fdaddd5087475968d9ac9bf\n\n14eda0837105510da8beba4430615bce\n\n2565215d2bd8b76b4bff00cd52ca81be\n\n23386af8fd04c25dcc4fdbbeed68f8d4\n\nb47386657563c4be9cec0c2f2c5f2f55\n\n**C&C**\n\ndatabig.akamaihub.stream\n\nbigdata.akamaihub.stream\n\n185.236.203.236\n\nunique.fontsupdate.com\n\n**PDB path**\n\nC:\\Users\\spartan\\Documents\\Visual Studio 2010\\Projects\\downloader new 22 jun\nuse\\downloader\\Release\\downloader.pdb\n\nC:\\users\\user\\documents\\visualstudio2010\\Projects\\newkeylogger\\Release\\new keylogger.pdb\n\n## Reference\n\n1. https://ti.360.net/blog/articles/latest-activity-of-APT-C-35/\n\n\n-----\n\n2. https://asert.arbornetworks.com/donot-team-leverages-new-modular-malware-framework-south-asia/\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        }
    ],
    "references": [
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2018/2018.12.12.Donot_Group/Donot_Group.pdf"
    ],
    "report_names": [
        "Donot_Group"
    ],
    "threat_actors": [
        {
            "id": "2ac63ef4-a7b8-4a30-96ad-b30ccb2073fc",
            "created_at": "2022-10-25T16:07:23.546262Z",
            "updated_at": "2025-03-27T02:02:09.856624Z",
            "deleted_at": null,
            "main_name": "Donot Team",
            "aliases": [
                "APT-C-35",
                "SectorE02"
            ],
            "source_name": "ETDA:Donot Team",
            "tools": [
                "BackConfig",
                "EHDevel",
                "Jaca",
                "yty"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "cfdd350b-de30-4d29-bbee-28159f26c8c2",
            "created_at": "2023-01-06T13:46:38.433736Z",
            "updated_at": "2025-03-27T02:00:02.832565Z",
            "deleted_at": null,
            "main_name": "VICEROY TIGER",
            "aliases": [
                "OPERATION HANGOVER",
                "Donot Team",
                "APT-C-35",
                "SectorE02",
                "Orange Kala"
            ],
            "source_name": "MISPGALAXY:VICEROY TIGER",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "9c884c88-2c9f-49c5-856a-2383ad1d8ef8",
            "created_at": "2024-05-01T02:03:08.152Z",
            "updated_at": "2025-03-27T02:05:17.422887Z",
            "deleted_at": null,
            "main_name": "ZINC EMERSON",
            "aliases": [
                "Dropping Elephant ",
                "EHDevel ",
                "Manul ",
                "Monsoon ",
                "Operation Hangover ",
                "Patchwork ",
                "TG-4410 ",
                "Viceroy Tiger ",
                "Confucius "
            ],
            "source_name": "Secureworks:ZINC EMERSON",
            "tools": [
                " Hanove",
                " Mac OS X KitM Spyware",
                " Proyecto2",
                " YTY Backdoor",
                "Enlighten Infostealer"
            ],
            "source_id": "Secureworks",
            "reports": null
        }
    ],
    "ts_created_at": 1666716504,
    "ts_updated_at": 1743041553,
    "ts_creation_date": 1555024515,
    "ts_modification_date": 1555024515,
    "files": {
        "pdf": "https://archive.orkl.eu/2998cd09a78c8243fbeea94dc6735e8fef7a81f4.pdf",
        "text": "https://archive.orkl.eu/2998cd09a78c8243fbeea94dc6735e8fef7a81f4.txt",
        "img": "https://archive.orkl.eu/2998cd09a78c8243fbeea94dc6735e8fef7a81f4.jpg"
    }
}