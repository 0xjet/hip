{
    "id": "5c15db22-8357-4135-828a-d9cb3b71caef",
    "created_at": "2023-01-12T15:01:17.396037Z",
    "updated_at": "2025-03-27T02:11:00.272187Z",
    "deleted_at": null,
    "sha1_hash": "a2951c9c8b429b695cc453dcbdc76d42cbfe4370",
    "title": "2012-01-12 - Blackhole Ramnit - samples and analysis",
    "authors": "",
    "file_creation_date": "2022-05-28T17:27:07Z",
    "file_modification_date": "2022-05-28T17:27:07Z",
    "file_size": 846006,
    "plain_text": "# Blackhole Ramnit - samples and analysis\n\n**[contagiodump.blogspot.com/2012/01/blackhole-ramnit-samples-and-analysis.html](http://contagiodump.blogspot.com/2012/01/blackhole-ramnit-samples-and-analysis.html)**\n\nRamnit - a Zeus-like trojan/worm/file infector with rootkit capabilities has been in the wild for\na long time but recently made news because Seculert reported about a financial variant of\nthis malware aimed at stealing Facebook credentials.\n\nWhile I did not see any Facebook related activity in my samples, I am posting them anyway\nfor your research as their functionality is the same.\n\nThe samples I have are being spread not via Facebook but via Blackhole exploit kit, which is\na very effective method. Blackhole exploit kit was associated with the spread of ZeuS,\nSpyeye, and it is not surprising that Ramnit is being spread in the same manner by the same\ngroups. The group of command and control servers that I researched is associated with\npharma spam and \"Canadian\" online pharmacies.\n\n## General File Information\n\nFile: 607B2219FBCFBFE8E6AC9D7F3FB8D50E\n\nMD5: 607B2219FBCFBFE8E6AC9D7F3FB8D50E\n\n\n-----\n\nFile: c33e7ed929760020820e8808289c240e\nMD5: C33E7ED929760020820E8808289C240E\n\nFile: 76991eefea6cb01e1d7435ae973858e6  - not analysed\nMD5: 76991EEFEA6CB01E1D7435AE973858E6\n\nFile: 2ff2c8ada4fc6291846f0d66ae57ca37 -not analysed\nMD5: 2FF2C8ADA4FC6291846F0D66AE57CA37\n\n## Download\n\nDownload all the binaries and dropped files as a password protected archive (email me\n\nif you need the password)\n\n## Distribution\n\nThe files analysed were / are being distributed via Blackhole exploit pack. It starts with the\nusual large letter message \"Please wait page is loading\" -then Java exploit launches and\ncompromise takes place if the machine is vulnerable. . Here you can see the Blackhole\ndomains spreading Ramnit in the Malwaredomainlist . Amberfreda.com domain belongs to\na legitimate company and is registered in Arizona, while a subdomain best.amberfreda.com\nis registered by some Ukranian guy. Not sure how they managed that.\n\n**amberfreda.com**\n\n173.201.97.1\n\np3nlhg49c090.shr.prod.phx3.secureserver.net\n\nDomains By Proxy, LLC\n\nDomainsByProxy.com\n\n15111 N. Hayden Rd., Ste 160, PMB 353\n\nScottsdale, Arizona 85260\n\nUnited States\n\n**best.amberfreda.com**\n\n178.162.145.184\n\n178-162-145-184.local\n\n\n-----\n\nHost unreachable\n178.162.145.128 - 178.162.145.255\nVPS services\nUkraine\nVladimir Gubarenko\np/o box 8967\n61106, Kharkov\nUkraine\nphone: +7 4956637354\nfax: +7 4956637354\nadmin@imhoster.net\n\nhttp://www.malwaredomainlist.com/mdl.php?\nsearch=amberfreda.com&colsearch=All&quantity=50\n\n## Brief Analysis\n\n**607B2219FBCFBFE8E6AC9D7F3FB8D50E**\n\n[Hendrik Adrian from Japan posted his analysis of the same sample ( 0day.JP - Ramnit)](http://translate.google.com/translate?sl=ja&tl=en&js=n&prev=_t&hl=en&ie=UTF-8&layout=2&eotf=1&u=http%3A%2F%2Funixfreaxjp.blogspot.com%2F2012%2F01%2Framnit.html&act=url)\nwhere he described the files created by the malware and the spam sending capabilities of\nthe bot .\n\nThe bot deletes registry settings for the safe\n\nboot, which causes BSOD and prevents one from removing the malicious files in the safe\n\n\n-----\n\nmode.\n\n2. Adds a Windows service\n**Micorsoft Windows Service - note the spelling**\n\n3. Adds the following files (names vary)\n\n**\\Application Data\\nvamibiv\\vcryserj.exe - copy of the original**\nhttp://www.virustotal.com/file-scan/report.html?\n[id=f52bfac9637aea189ec918d05113c36f5bcf580f3c0de8a934fe3438107d3f0c-](http://www.virustotal.com/file-scan/report.html?id=f52bfac9637aea189ec918d05113c36f5bcf580f3c0de8a934fe3438107d3f0c-1326310185)\n1326310185\n\nFile: vcryserj.exe\nSize: 135680\nMD5: 607B2219FBCFBFE8E6AC9D7F3FB8D50E\n\n\\Application Data\\wduqtdai.log - number of logs varies, contain encrypted data\n\\Application Data\\xtyepaef.log number of logs varies, contain encrypted data\n**\\Temp\\nhptugtstukgwpyi.exe - copy of the original**\n\nFile: nhptugtstukgwpyi.exe\nSize: 135680\nMD5: 607B2219FBCFBFE8E6AC9D7F3FB8D50E\n\n**\\Start Menu\\Programs\\Startup\\vcryserj.exe - copy of the original**\n\nFile: vcryserj.exe\nSize: 1356\nMD5: 607B2219FBCFBFE8E6AC9D7F3FB8D50E\n\n**\\Local Settings\\Temp\\dnsgvbny.sys the rootkit** http://www.virustotal.com/filescan/report.html?\nid=c1293f8dd8a243391d087742fc22c99b8263f70c6937f784c15e9e20252b38ae1326346542\n\nFile: dnsgvbny.sys\nSize: 15360\nMD5: A6D351093F75D16C574DB31CDF736153\n\n\n-----\n\nRamnit injects itself into two svchost.exe processes and you can see them if you sort all\nprocesses by PID, the last two will those created by Ramnit.\n\nIt generates spam that it sends out on port 25, Hendrik already described this behavior in his\npost.\n\n**C33E7ED929760020820E8808289C240E**\n\nThe second file has file infector features I did not observe in\n**607B2219FBCFBFE8E6AC9D7F3FB8D50E.**\nAs you see in the log below, malicious svchost.exe modifies or tries to modify every binary\nand HTML file by appending malicious code to each file or a vbs script to HTML files  - like\n[described in this post by ESET Win32/Ramnit.A. and here in the post by Avira -](http://www.eset.eu/encyclopaedia/win32-ramnit-a-backdoor-ircnite-bwy-w32?lng=en) Closer look\nat W32/Ramnit.C\n\nThis does not break the infected binaries, all files continue to work as designed, except they\ninfect or reinfect the computer they are running on. Webmasters may upload infected html\nfiles and visitors of their sites may get infected as well. For an average user, it is impossible\nto clean a system compromised with Ramnit file injector and use it confidence. The only way\nis say good bye to all the HTM(L), DLL and EXE files and build a new system without trying\nto copy any hrml files, bookmark or applications.\n\nThsi is what happens with VirustotalUpload2.exe (and most other Programs including Adobe,\nMS Office and Windows files)\n\nhttp://www.virustotal.com/file-scan/report.html?\nid=a40aacca731c142148733786cae64d45df2e740e3fb744ffc513d251ec121cf7-1326169765\n\nVirusTotalUpload2.exe\n\nSubmission date:\n\n2012-01-10 04:29:25 (UTC)\n\nResult:37 /43 (86.0%)\n\nPrint results\n\nAntivirus   Version   Last Update   Result\n\n\n-----\n\nAhnLab-V3   2012.01.09.00   2012.01.09   Win32/Ramnit.O\nAntiVir   7.11.20.218   2012.01.10   W32/Ramnit.E\nAvast   6.0.1289.0   2012.01.09   Win32:Ramnit-H\nAVG   10.0.0.1190   2012.01.10   Win32/Zbot.G\nBitDefender   7.2   2012.01.10   Win32.Ramnit.N\nByteHero   1.0.0.1   2011.12.31   Trojan.Win32.Heur.Gen\nCAT-QuickHeal   12.00   2012.01.09   W32.Ramnit.C\nClamAV   0.97.3.0   2012.01.10   Trojan.Patched-168\nCommtouch   5.3.2.6   2012.01.10   W32/Ramnit.E\nComodo   11229   2012.01.10   TrojWare.Win32.Patched.SM\nDrWeb   5.0.2.03300   2012.01.09   Win32.Rmnet.8\nEmsisoft   5.1.0.11   2012.01.10   Virus.Win32.Zbot!IK\neTrust-Vet   37.0.9672   2012.01.09   Win32/Ramnit.AJ\nF-Prot   4.6.5.141   2012.01.09   W32/Ramnit.E\nF-Secure   9.0.16440.0   2012.01.09   Win32.Ramnit.N\nFortinet   4.3.388.0   2012.01.10   W32/Ramnit.B\nGData   22   2012.01.09   Win32.Ramnit.N\nIkarus   T3.1.1.109.0   2012.01.10   Virus.Win32.Zbot\nJiangmin   13.0.900   2012.01.09   Win32/PatchFile.gg\nK7AntiVirus   9.124.5897   2012.01.09   Trojan\nKaspersky   9.0.0.837   2012.01.10   Trojan.Win32.Patched.md\nMcAfee   5.400.0.1158   2012.01.10   W32/Ramnit.b\nMcAfee-GW-Edition   2010.1E   2012.01.09   W32/Ramnit.b\nMicrosoft   1.7903   2012.01.09   Virus:Win32/Ramnit.AF\nNOD32   6780   2012.01.10   Win32/Ramnit.H\nNorman   6.07.13   2012.01.09   W32/Ramnit.AB\nnProtect   2012-01-09.01   2012.01.10   Win32.Ramnit.N\nPanda   10.0.3.5   2012.01.09   W32/Cosmu.L\nPCTools   8.0.0.5   2012.01.10   Malware.Ramnit\nRising   23.92.01.01   2012.01.10   Win32.Ramnit.c\nSymantec   20111.2.0.82   2012.01.10   W32.Ramnit.B!inf\nTrendMicro   9.500.0.1008   2012.01.10   PE_RAMNIT.KC\nTrendMicro-HouseCall   9.500.0.1008   2012.01.10   PE_RAMNIT.KC\nViRobot   2012.1.10.4872   2012.01.10   Win32.Ramnit.A\nVirusBuster   14.1.158.1   2012.01.09   Win32.Ramnit.Gen.3\nAdditional information\nMD5  : 25f6ee42d37e3f2f7dbe795e836d52e2\n\n## Traffic\n\n**607B2219FBCFBFE8E6AC9D7F3FB8D50E - C&C is**\n**sinkholedC33E7ED929760020820E8808289C240E - C&C is active**\n\n\n-----\n\nDespite the fact that the C&C for 607B2219FBCFBFE8E6AC9D7F3FB8D50E is sinkholed, it\nis still interesting to see the malware behavior when it tries to establish a connection with the\nserver.\n\nRamnit samples used by the same group of attackers have overlapping set of C&C servers the list is not the same but I found that my samples that are supposedly later version that\nRamnit.AK have approximately 80% overlap in C&C list used by this RamnitAK binary\n[described by Sophos . I have combined the two lists and ran WHOIS queries to establish](http://www.sophos.com/en-us/threat-center/threat-analyses/viruses-and-spyware/Troj~Ramnit-AK.aspx)\nactive C&C and their location and registration.\n\nThe communications with the sinkholed server below show that once the bot receives SYN\ncommand from the C&C, it sends 6 bytes of data. Exact same behavior is described in this\nanalysis of the binaries from Summer 2011 - with the only difference that the second packet\nsent by the bot was not 75 bytes but 149 bytes Bot of the Day: Ramnit/NinmulMonday, July\n18th, 2011. If connection with the server is established, the traffic continues on on port 443, it\nis encoded but it is not SSL, it is some sort of custom protocol.\n\nThe bot is going through the list of domains trying to find those that are active. Most of the\ndomains are not registered yet but the two currently active domains were registered on\n**January 5 and 6, 2011. It appears that the attackers register new domains as soon as the**\nlose any due to sinkholing and domain cancellations. Since all the domains have the most\nrandom names, they are not likely to be registered by someone else before they are needed.\nHaving each binary to check a long list of domains makes the bot very noisy (consider\nmaking IDS signatures based on UDP port 53 thresholds) but it prevents the death of the\nbotnet in case of the C&C loss. I have complied a list of approximately 400 domains with only\n21 of them registered.  If you created DNS blocks or sinkhole domains, consider blocking or\nsinkholing all of them, not only active.\n\n\n-----\n\nDomain name: rjordulltl.com\n89.149.242.185 - Leaseweb Germany GmbH (previously netdirekt e. K.)\nGermany\nRegistrar: Regtime Ltd.\nCreation date: 2012-01-05\nExpiration date: 2013-01-05\n\nDomain Name: goopndlgvy.com\nRegistrant:\nPrivacyProtect.org\nDomain Admin    (contact@privacyprotect.org)\nID#10760, PO Box 16\nNote - All Postal Mails Rejected, visit Privacyprotect.org\nNobby Beach\nnull,QLD 4218\nAU\nTel. +45.36946676\n89.149.242.185 - Leaseweb Germany GmbH (previously netdirekt e. K.)\nGermany\nCreation Date: 06-Jan-2012\nExpiration Date: 06-Jan-2013\n\n**Communications with a sinkholed C&C and search for a new active server:**\n\n\n-----\n\nBot <-> C&C communications on port 443\n\n\n-----\n\nList of domains used by Ramnit binaries - feel free to pre-emptively sinkhole them. Part of\nthem are from this [Sophos analysis and part is from running these two binaries](http://www.sophos.com/en-us/threat-center/threat-analyses/viruses-and-spyware/Troj~Ramnit-AK.aspx)\n\nRegistered domains. See the text version below. The yellow/red entries show active C&C. All\nothers are sinkholed or NXD'd.\n\nAs you notice, many domains are registered by \"Aleksandr Bragilevskij\"\nRegistrar: Regtime Ltd\n\n\n-----\n\nCreation date: 2011-12-03\nExpiration date: 2012-12-03\n\nRegistrant:\nAleksandr Bragilevskij\nEmail: pfizer.corp@yahoo.com\nOrganization: Aleksandr Bragilevskij\nAddress: 333 E 79th St # 1T,\nCity: New York City\nState: NY\nZIP: 10001\nCountry: UM\nPhone: +1.2127332323\nFax: +1.2127332323\n\nGoogle Search for pfizer.corp@yahoo.com reveals that the same address was used to\nregister fake Canadian pharmacy sites, which makes sense, considering the Viagra spam.\n\ntrustpharmacy.us\n\n188.72.200.84\nMarkus Faizer\nPfizer International\n333 E 79th St # 1T,\nNew York City\nNY\n10001\nUnited States\nPhone: +1.2127332323\nFax: +1.2127332323\nE-mail: pfizer.corp@yahoo.com\n\n\n-----\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2012/2012-01-12 - Blackhole Ramnit - samples and analysis.pdf"
    ],
    "report_names": [
        "2012-01-12 - Blackhole Ramnit - samples and analysis.pdf"
    ],
    "threat_actors": [
        {
            "id": "aa73cd6a-868c-4ae4-a5b2-7cb2c5ad1e9d",
            "created_at": "2022-10-25T16:07:24.139848Z",
            "updated_at": "2025-03-27T02:02:10.120505Z",
            "deleted_at": null,
            "main_name": "Safe",
            "aliases": [],
            "source_name": "ETDA:Safe",
            "tools": [
                "DebugView",
                "LZ77",
                "OpenDoc",
                "SafeDisk",
                "TypeConfig",
                "UPXShell",
                "UsbDoc",
                "UsbExe"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "3fad11c6-4336-4b28-a606-f510eca5452e",
            "created_at": "2022-10-25T16:07:24.346573Z",
            "updated_at": "2025-03-27T02:02:10.183211Z",
            "deleted_at": null,
            "main_name": "Turbine Panda",
            "aliases": [
                "APT 26",
                "Black Vine",
                "Bronze Express",
                "Group 13",
                "JerseyMikes",
                "KungFu Kittens",
                "PinkPanther",
                "Shell Crew",
                "Turbine Panda",
                "WebMasters"
            ],
            "source_name": "ETDA:Turbine Panda",
            "tools": [
                "Agent.dhwf",
                "Agentemis",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "Derusbi",
                "Destroy RAT",
                "DestroyRAT",
                "FF-RAT",
                "FormerFirstRAT",
                "Hurix",
                "Kaba",
                "Korplug",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "Mivast",
                "PlugX",
                "RbDoor",
                "RedDelta",
                "RibDoor",
                "Sakula",
                "Sakula RAT",
                "Sakurel",
                "Sogu",
                "StreamEx",
                "TIGERPLUG",
                "TVT",
                "Thoper",
                "Winnti",
                "Xamtrav",
                "cobeacon",
                "ffrat"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535677,
    "ts_updated_at": 1743041460,
    "ts_creation_date": 1653758827,
    "ts_modification_date": 1653758827,
    "files": {
        "pdf": "https://archive.orkl.eu/a2951c9c8b429b695cc453dcbdc76d42cbfe4370.pdf",
        "text": "https://archive.orkl.eu/a2951c9c8b429b695cc453dcbdc76d42cbfe4370.txt",
        "img": "https://archive.orkl.eu/a2951c9c8b429b695cc453dcbdc76d42cbfe4370.jpg"
    }
}