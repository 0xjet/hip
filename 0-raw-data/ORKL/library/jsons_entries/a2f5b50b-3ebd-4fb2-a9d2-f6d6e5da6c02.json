{
    "id": "a2f5b50b-3ebd-4fb2-a9d2-f6d6e5da6c02",
    "created_at": "2023-01-12T15:04:19.340175Z",
    "updated_at": "2025-03-27T02:17:16.735958Z",
    "deleted_at": null,
    "sha1_hash": "10aefb5a1860b6de2213353bc01db651b9e87e98",
    "title": "2020-03-10 - APT40 goes from Template Injections to OLE-Linkings for payload delivery",
    "authors": "",
    "file_creation_date": "2022-05-27T19:01:41Z",
    "file_modification_date": "2022-05-27T19:01:41Z",
    "file_size": 342259,
    "plain_text": "# APT40 goes from Template Injections to OLE-Linkings for payload delivery\n\n**[medium.com/insomniacs/apt40-goes-from-template-injections-to-ole-linkings-for-payload-delivery-99eb43170a97](https://medium.com/insomniacs/apt40-goes-from-template-injections-to-ole-linkings-for-payload-delivery-99eb43170a97)**\n\nasuna amawaka March 15, 2020\n\n[asuna amawaka](https://medium.com/@asuna.amawaka?source=post_page-----99eb43170a97--------------------------------)\n\nMar 10, 2020\n\n\n3 min read\n\nI came across a maldoc on VirusTotal that is named to phish and the timing when this\nmaldoc appeared was also pretty “coincidental” with the recent political situation in Malaysia.\nI’m curious enough to look into this maldoc further.\n\n\n-----\n\nAccording to MyCERT’s post[1] in Feb 2020, a set of malware had been found to be\ntargeting Malaysian Government officials, and these were attributed to APT40. Extensive\nanalysis of these files had been done by various researchers and we know the malware\nfamilies involved are DADJOKE[2] and DADSTACHE[3]. On 27 Feb 2020, this new maldoc\nsurfaced on VirusTotal delivered a variant of DADSTACHE. This new maldoc is interesting,\nbecause it employed a different technique of fetching the final payload.\n\nI’ve compiled the following information regarding the different malicious documents used by\nAPT40 against Malaysia:\n\n\n-----\n\n-----\n\nIn the latest document (below, MD5 571EFE3A29ED1F6C1F98576CB57DB8A5), it\nemployed a very different method in fetching the final payload. It goes through 3 “fetching\nlayers” of OLE-linkings to finally arrive at DADSTACHE execution. At the last layer, the RTF\n\n\n-----\n\ndocument makes use of CVE-2017–0199 to execute the VBScript within a HTA file. The\nactual target of this maldoc is unknown, though the file was uploaded to VirusTotal by a user\nin Malaysia.\n\nI think one reason for incorporating so many “fetching layers” is to allow layers to change\ndynamically — at any point in time, “Report.docx”, “out.rtf”, “M.png” and “dbgeng.dll” can be\naltered at the attackers’ side to fetch different files or to connect to different URLs. Previously\nthe payloads are already embedded into the malicious document and thus difficult to change\nafter deployment.\n\nDADSTACHE is first observed to be delivered through the maldoc (MD5:\nA827D521181462A45A7077AE3C20C9B5). Also notice how this maldoc’s embedded\nobjects’ names look different from the ones in the previous maldocs in the list.\n\nI’ll do an analysis walkthrough of the DADSTACHE payload in the next post ;)\n\nReferences:\n\n[1] [https://www.mycert.org.my/portal/advisory?id=MA-770.022020](https://www.mycert.org.my/portal/advisory?id=MA-770.022020)\n\n[2] [https://malpedia.caad.fkie.fraunhofer.de/details/win.dadjoke](https://malpedia.caad.fkie.fraunhofer.de/details/win.dadjoke)\n\n\n-----\n\n[3] [https://malpedia.caad.fkie.fraunhofer.de/details/win.dadstache](https://malpedia.caad.fkie.fraunhofer.de/details/win.dadstache)\n\n~~\n\n## Asuna\n\n### The latest Tweets from Asuna (@AsunaAmawaka). [Malware Analyst]. Binary World\n\ntwitter.com\n\nDrop me a DM if you would like to share findings or samples ;)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2020/2020-03-10 - APT40 goes from Template Injections to OLE-Linkings for payload delivery.pdf"
    ],
    "report_names": [
        "2020-03-10 - APT40 goes from Template Injections to OLE-Linkings for payload delivery.pdf"
    ],
    "threat_actors": [
        {
            "id": "649b5b3e-b16e-44db-91bc-ae80b825050e",
            "created_at": "2022-10-25T15:50:23.290412Z",
            "updated_at": "2025-03-27T02:00:55.431037Z",
            "deleted_at": null,
            "main_name": "Dragonfly",
            "aliases": [
                "TEMP.Isotope",
                "DYMALLOY",
                "Berserk Bear",
                "TG-4192",
                "Crouching Yeti",
                "IRON LIBERTY",
                "Energetic Bear",
                "Ghost Blizzard"
            ],
            "source_name": "MITRE:Dragonfly",
            "tools": [
                "MCMD",
                "Impacket",
                "CrackMapExec",
                "Backdoor.Oldrea",
                "Mimikatz",
                "PsExec",
                "Trojan.Karagany",
                "netsh"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "1a76ed30-4daf-4817-98ae-87c667364464",
            "created_at": "2022-10-25T16:47:55.891029Z",
            "updated_at": "2025-03-27T02:05:17.408867Z",
            "deleted_at": null,
            "main_name": "IRON LIBERTY",
            "aliases": [
                "ATK6 ",
                "BROMINE ",
                "CASTLE ",
                "Crouching Yeti ",
                "DYMALLOY ",
                "Dragonfly ",
                "Energetic Bear / Berserk Bear ",
                "Ghost Blizzard ",
                "TEMP.Isotope ",
                "TG-4192 ",
                "ALLANITE "
            ],
            "source_name": "Secureworks:IRON LIBERTY",
            "tools": [
                " Ddex Loader",
                " Havex",
                " Karagany",
                " Loek",
                " MCMD",
                " Sysmain",
                " xfrost",
                "ClientX"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "16f2436b-5f84-44e3-a306-f1f9e92f7bea",
            "created_at": "2023-01-06T13:46:38.745572Z",
            "updated_at": "2025-03-27T02:00:02.907444Z",
            "deleted_at": null,
            "main_name": "APT40",
            "aliases": [
                "ISLANDDREAMS",
                "TEMP.Jumper",
                "BRONZE MOHAWK",
                "GADOLINIUM",
                "KRYPTONITE PANDA",
                "TA423",
                "MUDCARP",
                "Gingham Typhoon",
                "TEMP.Periscope",
                "G0065",
                "ATK29",
                "Red Ladon",
                "ITG09"
            ],
            "source_name": "MISPGALAXY:APT40",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "59be3740-c8c7-47aa-84c8-e80d0cb7ea3a",
            "created_at": "2022-10-25T15:50:23.481057Z",
            "updated_at": "2025-03-27T02:00:55.480695Z",
            "deleted_at": null,
            "main_name": "Leviathan",
            "aliases": [
                "MUDCARP",
                "Kryptonite Panda",
                "Gadolinium",
                "BRONZE MOHAWK",
                "TEMP.Jumper",
                "APT40",
                "TEMP.Periscope",
                "Gingham Typhoon"
            ],
            "source_name": "MITRE:Leviathan",
            "tools": [
                "Windows Credential Editor",
                "BITSAdmin",
                "HOMEFRY",
                "Derusbi",
                "at",
                "BLACKCOFFEE",
                "BADFLICK",
                "gh0st RAT",
                "PowerSploit",
                "MURKYTOP",
                "NanHaiShu",
                "Orz",
                "Cobalt Strike",
                "China Chopper"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "83025f5e-302e-46b0-baf6-650a4d313dfc",
            "created_at": "2024-05-01T02:03:07.971863Z",
            "updated_at": "2025-03-27T02:05:17.278721Z",
            "deleted_at": null,
            "main_name": "BRONZE MOHAWK",
            "aliases": [
                "Flaccid Rose ",
                "GADOLINIUM ",
                "Kryptonite Panda ",
                "Leviathan ",
                "Nanhaishu ",
                "Pickleworm ",
                "Temp.Jumper ",
                "Temp.Periscope ",
                "APT40 "
            ],
            "source_name": "Secureworks:BRONZE MOHAWK",
            "tools": [
                " BlackCoffee",
                " China Chopper",
                " Cobalt Strike",
                " Derusbi",
                " Derusbi Trojan",
                " FUSIONBLAZE",
                " GreenCrash",
                " HOMEFRY",
                " MURKYTOP",
                " Metasploit",
                " Metasploit / Meterpreter",
                " Nanhaishu",
                " Orz",
                " ScanBox",
                " SeDll",
                "AIRBREAK"
            ],
            "source_id": "Secureworks",
            "reports": null
        }
    ],
    "ts_created_at": 1673535859,
    "ts_updated_at": 1743041836,
    "ts_creation_date": 1653678101,
    "ts_modification_date": 1653678101,
    "files": {
        "pdf": "https://archive.orkl.eu/10aefb5a1860b6de2213353bc01db651b9e87e98.pdf",
        "text": "https://archive.orkl.eu/10aefb5a1860b6de2213353bc01db651b9e87e98.txt",
        "img": "https://archive.orkl.eu/10aefb5a1860b6de2213353bc01db651b9e87e98.jpg"
    }
}