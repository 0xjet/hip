{
    "id": "883f7620-a667-451d-abce-24916d08b2f7",
    "created_at": "2022-10-25T16:48:18.740894Z",
    "updated_at": "2025-03-27T02:16:49.017018Z",
    "deleted_at": null,
    "sha1_hash": "31bdd3f34c5583dc156b99986f5695368d103daa",
    "title": "Evidence Aurora Operation Still Active: Supply Chain Attack Through CCleaner",
    "authors": "Intezer",
    "file_creation_date": "2017-10-08T17:04:46Z",
    "file_modification_date": "0001-01-01T00:00:00Z",
    "file_size": 882832,
    "plain_text": "# p pp y Through CCleaner\n\n**[intezer.com /evidence-aurora-operation-still-active-supply-chain-attack-through-ccleaner/](http://www.intezer.com/evidence-aurora-operation-still-active-supply-chain-attack-through-ccleaner/)**\n\n9/20/2017\n\n[Recently, there have been a few attacks with a supply chain infection, such as Shadowpad being implanted in many](https://securelist.com/shadowpad-in-corporate-networks/81432/)\nof Netsarang’s products, affecting millions of people. You may have the most up to date cyber security software, but\nwhen the software you are trusting to keep you protected gets infected there is a problem. A backdoor, inserted into\nlegitimate code by a third party with malicious intent, leads to millions of people being hacked and their information\nstolen.\n\nAvast’s CCleaner software had a backdoor encoded into it by someone who had access to the supply chain.\nThrough somewhere that had access to the source code of CCleaner, the main executable in v5.33.6162 had been\n[modified to include a backdoor. The official statement from Avast can be found here](https://blog.avast.com/update-to-the-ccleaner-5.33.6162-security-incident)\n\n## The Big Connection:\n\nCostin Raiu, director of Global Research and Analysis Team at Kaspersky Lab, was the first to find a code\nconnection between APT17 and the backdoor in the infected CCleaner:\n\n_[The malware injected into #CCleaner has shared code with several tools used by one of the APT](https://twitter.com/hashtag/CCleaner?src=hash&ref_src=twsrc%5Etfw)_\n_[groups from the #Axiom APT 'umbrella'.](https://twitter.com/hashtag/Axiom?src=hash&ref_src=twsrc%5Etfw)_\n\n_[— Costin Raiu (@craiu) September 19, 2017](https://twitter.com/craiu/status/910059453948579840?ref_src=twsrc%5Etfw)_\n\n\n-----\n\n[earlier APT17 samples. The photo below is the result of uploading the CCBkdr module to Intezer Analyze™](http://www.intezer.com/intezer-analyze/), where\nthe results show there is an overlap in code. With our technology, we can compare code to a huge database of\nmalicious and trusted software — that’s how we can prove that this code has never been seen before in any other\nsoftware.\n\nA deeper analysis leads us to the functions shown below. The code in question is a unique implementation of\nbase64 only previously seen in APT17 and not in any public repository, which makes a strong case about attribution\nto the same threat actor.\n\n\n-----\n\nThis code connection is huge news. APT17, also known as Operation Aurora, is one of the most sophisticated cyber\nattacks ever conducted and they specialize in supply chain attacks. In this case, they probably were able to hack\nCCleaner’s build server in order to plant this malware. Operation Aurora started in 2009 and to see the same threat\nactor still active in 2017 could possibly mean there are many other supply chain attacks by the same group that we\nare not aware of. The previous attacks are attributed to a Chinese group called PLA Unit 61398.\n\n## Technical Analysis:\n\nThe infected CCleaner file that begins the analysis is from\n6f7840c77f99049d788155c1351e1560b62b8ad18ad0e9adda8218b9f432f0a9\n\nA technical analysis was posted by Talos here ( http://blog.talosintelligence.com/2017/09/avast-distributesmalware.html).\n\nThe flow-graph of the malicious CCleaner is as follows (taken from the Talos report):\n\n\n-----\n\nInfected function:\n\n\n-----\n\nAfter the embedded code is decrypted and executed, the next step is a PE (portable executable) file loader. A PE file\n\n\n-----\n\nThe PE loader first begins by resolving the addresses of imports commonly used by loaders and calling them.\nGetProcAddress to get the addresses of external necessary functions, LoadLibraryA to load necessary modules into\nmemory and get the address of the location of the module in memory, VirtualAlloc to create memory for somewhere\nto copy the memory, and in some cases, when not implemented, and memcpy to copy the buffer to the newly\nallocated memory region.\n\nAfter the module is copied to memory, to load it properly, the proper loading procedure is executed. The relocation\ntable is read to adjust the module to the base address of the allocated memory region the import table is read the\n\n\n-----\n\nrealizing this module is malicious, and after the malicious code begins execution.\n\nThe main module does the following:\n\n1. Tries an anti-debug technique using time and IcmpSendEcho to wait\n\n2. Collect data about the computer (Operating system, computer name, DNS domain, running processes, e tc)\n\n3. Allocates memory for payload to retrieve from C&C server\n\n4. Contacts C&C server at IP address 216.126.225.148\n\na. If this IP address is unreachable, uses a domain generation algorithm and uses a different domain depending\non the month and year\n\n5. Executes code sent by C&C\n\nBy the time of the analysis, we were unable to get our hands on the code sent by the C&Cs.\n\nIf you would like to analyze the malware yourself, you may refer to my tweet.\n\n_[#ccleaner malware DLL w/ IAT fix](https://twitter.com/hashtag/ccleaner?src=hash&ref_src=twsrc%5Etfw)_ _[https://t.co/FprmtmkV64](https://t.co/FprmtmkV64)_ _[https://t.co/dgWiQVd31k](https://t.co/dgWiQVd31k)_ _[@TalosSecurity](https://twitter.com/TalosSecurity?ref_src=twsrc%5Etfw)_\n_[@malwrhunterteam](https://twitter.com/malwrhunterteam?ref_src=twsrc%5Etfw)_ _[pic.twitter.com/TxsbveFoHJ](https://t.co/TxsbveFoHJ)_\n\n_[— Jay Rosenberg (@jaytezer) September 18, 2017](https://twitter.com/jaytezer/status/909807005266825216?ref_src=twsrc%5Etfw)_\n\nBy Jay Rosenberg\n\nJay Rosenberg is a self-taught reverse engineer from a very young age (12 years old), specializing in\nReverse Engineering and Malware Analysis. Currently working as a Senior Security Researcher in\nIntezer.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "d63ae2b7-445f-460d-965d-2676dacdb6de",
            "created_at": "2022-10-25T15:59:19.552139Z",
            "updated_at": "2022-10-25T15:59:19.552139Z",
            "deleted_at": null,
            "name": "APTnotes",
            "url": "https://github.com/aptnotes/data",
            "description": "APTnotes data",
            "reports": null
        }
    ],
    "references": [
        "https://app.box.com/s/o8rait7di3od2z60v8mj77x4a5jb2xun"
    ],
    "report_names": [
        "Intezer_Evidence-Aurora-Supply-Chain-Attack-CCleaner-Part1(09-20-2017)"
    ],
    "threat_actors": [
        {
            "id": "cea5ceec-0f14-4e34-bd0e-4074bc1a707d",
            "created_at": "2022-10-25T15:50:23.629983Z",
            "updated_at": "2025-03-27T02:00:55.509459Z",
            "deleted_at": null,
            "main_name": "Axiom",
            "aliases": [
                "Group 72"
            ],
            "source_name": "MITRE:Axiom",
            "tools": [
                "ZxShell",
                "gh0st RAT",
                "Zox",
                "PlugX",
                "Hikit",
                "PoisonIvy",
                "Derusbi",
                "Hydraq"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "2150d1ac-edf0-46d4-a78a-a8899e45b2b5",
            "created_at": "2022-10-25T15:50:23.269339Z",
            "updated_at": "2025-03-27T02:00:55.416524Z",
            "deleted_at": null,
            "main_name": "APT17",
            "aliases": [
                "APT17",
                "Deputy Dog"
            ],
            "source_name": "MITRE:APT17",
            "tools": [
                "BLACKCOFFEE"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "5c74936a-79d1-41b8-81eb-01d03c90a26b",
            "created_at": "2022-10-25T16:07:23.371052Z",
            "updated_at": "2025-03-27T02:02:09.766782Z",
            "deleted_at": null,
            "main_name": "Axiom",
            "aliases": [
                "Group 72",
                "Operation SMN"
            ],
            "source_name": "ETDA:Axiom",
            "tools": [
                "9002 RAT",
                "Agent.dhwf",
                "AngryRebel",
                "BlackCoffee",
                "BleDoor",
                "Chymine",
                "Darkmoon",
                "DeputyDog",
                "Derusbi",
                "Destroy RAT",
                "DestroyRAT",
                "Farfli",
                "Fexel",
                "Gen:Trojan.Heur.PT",
                "Gh0st RAT",
                "Ghost RAT",
                "Gresim",
                "HOMEUNIX",
                "HiKit",
                "HidraQ",
                "Homux",
                "Hydraq",
                "Kaba",
                "Korplug",
                "McRAT",
                "MdmBot",
                "Moudour",
                "Mydoor",
                "PCRat",
                "PNGRAT",
                "PlugX",
                "Poison Ivy",
                "RbDoor",
                "RedDelta",
                "RibDoor",
                "Roarur",
                "SPIVY",
                "Sensocode",
                "Sogu",
                "TIGERPLUG",
                "TVT",
                "Thoper",
                "Winnti",
                "Xamtrav",
                "ZXShell",
                "Zox",
                "ZoxPNG",
                "ZoxRPC",
                "gresim",
                "pivy",
                "poisonivy"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "cf7fc640-acfe-41c4-9f3d-5515d53a3ffb",
            "created_at": "2023-01-06T13:46:38.228042Z",
            "updated_at": "2025-03-27T02:00:02.775905Z",
            "deleted_at": null,
            "main_name": "APT1",
            "aliases": [
                "GIF89a",
                "G0006",
                "PLA Unit 61398",
                "Group 3",
                "TG-8223",
                "Comment Group",
                "ShadyRAT",
                "COMMENT PANDA",
                "Comment Crew",
                "Byzantine Candor",
                "Brown Fox"
            ],
            "source_name": "MISPGALAXY:APT1",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "a7aefdda-98f1-4790-a32d-14cc99de2d60",
            "created_at": "2023-01-06T13:46:38.281844Z",
            "updated_at": "2025-03-27T02:00:02.792526Z",
            "deleted_at": null,
            "main_name": "APT17",
            "aliases": [
                "G0025",
                "AURORA PANDA",
                "Group 72",
                "G0001",
                "HELIUM",
                "Group 8",
                "Hidden Lynx",
                "Tailgater Team",
                "BRONZE KEYSTONE"
            ],
            "source_name": "MISPGALAXY:APT17",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "4c68ccd0-caba-4189-9ead-86ac4c2d9b70",
            "created_at": "2024-05-01T02:03:07.930196Z",
            "updated_at": "2025-03-27T02:05:17.251237Z",
            "deleted_at": null,
            "main_name": "BRONZE ATLAS",
            "aliases": [
                "Axiom",
                "BARIUM ",
                "Blackfly ",
                "CTG-2633",
                "GREF",
                "Group 72 ",
                "Red Kelpie ",
                "TG-2633 ",
                "Wicked Panda ",
                "Winnti",
                "APT41 "
            ],
            "source_name": "Secureworks:BRONZE ATLAS",
            "tools": [
                " CCleaner v5.33 backdoor",
                " ChinaChopper",
                " Cobalt Strike",
                " Dicey MSDN",
                " ForkPlayground",
                " HUC Proxy Malware (Htran)",
                " Mimikatz",
                " PipeMon",
                " PlugX",
                " PortReuse",
                " Powershell Empire",
                " RCMD",
                " RbDoor",
                " SPEEDBOAT",
                " ShadowPad",
                " Sidewalk",
                " Speculoos",
                " TeamViewer",
                " Winnkit",
                " Winnti",
                " reg save",
                " vssadmin",
                "Acehash"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "1edcac0b-efd9-47b1-9aca-33827d5bd085",
            "created_at": "2024-05-01T02:03:07.964773Z",
            "updated_at": "2025-03-27T02:05:17.273595Z",
            "deleted_at": null,
            "main_name": "BRONZE KEYSTONE",
            "aliases": [
                "Aurora Panda ",
                "DeputyDog ",
                "Group 72 ",
                "Hidden Lynx ",
                "Shell Crew",
                "TG-8153 ",
                "Tailgater Team",
                "APT17 "
            ],
            "source_name": "Secureworks:BRONZE KEYSTONE",
            "tools": [
                " BlackCoffee",
                " DeputyDog",
                " Derusbi",
                " Gh0stHTTPSDropper",
                " HiKit",
                " InternalCMD",
                " PlugX",
                " PoisonIvy",
                " ZxShell",
                "9002"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "86fd71d3-06dc-4b73-b038-cedea7b83bac",
            "created_at": "2022-10-25T16:07:23.330793Z",
            "updated_at": "2025-03-27T02:02:09.740703Z",
            "deleted_at": null,
            "main_name": "APT 17",
            "aliases": [
                "APT 17",
                "ATK 2",
                "Beijing Group",
                "Bronze Keystone",
                "Deputy Dog",
                "Elderwood",
                "Elderwood Gang",
                "Operation Aurora",
                "Operation DeputyDog",
                "Operation Ephemeral Hydra",
                "Operation RAT Cook",
                "SIG22",
                "Sneaky Panda",
                "TEMP.Avengers",
                "TG-8153",
                "Tailgater Team"
            ],
            "source_name": "ETDA:APT 17",
            "tools": [
                "9002 RAT",
                "AGENT.ABQMR",
                "AGENT.AQUP.DROPPER",
                "AGENT.BMZA",
                "AGENT.GUNZ",
                "Agent.dhwf",
                "AngryRebel",
                "BlackCoffee",
                "Briba",
                "Chymine",
                "Comfoo",
                "Comfoo RAT",
                "Darkmoon",
                "DeputyDog",
                "Destroy RAT",
                "DestroyRAT",
                "Farfli",
                "Fexel",
                "Gen:Trojan.Heur.PT",
                "Gh0st RAT",
                "Ghost RAT",
                "Gresim",
                "HOMEUNIX",
                "HiKit",
                "HidraQ",
                "Homux",
                "Hydraq",
                "Jumpall",
                "Kaba",
                "Korplug",
                "Linfo",
                "MCRAT.A",
                "McRAT",
                "MdmBot",
                "Mdmbot.E",
                "Moudour",
                "Mydoor",
                "Naid",
                "Nerex",
                "PCRat",
                "PNGRAT",
                "Pasam",
                "PlugX",
                "Poison Ivy",
                "RedDelta",
                "Roarur",
                "SPIVY",
                "Sogu",
                "TIGERPLUG",
                "TVT",
                "Thoper",
                "Trojan.Naid",
                "Vasport",
                "Wiarp",
                "Xamtrav",
                "Zox",
                "ZoxPNG",
                "ZoxRPC",
                "gresim",
                "pivy",
                "poisonivy"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1666716498,
    "ts_updated_at": 1743041809,
    "ts_creation_date": 1507482286,
    "ts_modification_date": 0,
    "files": {
        "pdf": "https://archive.orkl.eu/31bdd3f34c5583dc156b99986f5695368d103daa.pdf",
        "text": "https://archive.orkl.eu/31bdd3f34c5583dc156b99986f5695368d103daa.txt",
        "img": "https://archive.orkl.eu/31bdd3f34c5583dc156b99986f5695368d103daa.jpg"
    }
}